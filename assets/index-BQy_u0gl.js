const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/dagre-OKDRZEBW-D1My2Aup.js","assets/graph-DOiRdBvg.js","assets/_baseUniq-Cl_CPOkM.js","assets/layout-QcM2oZO5.js","assets/_basePickBy-DQpLiNsQ.js","assets/clone-CvUfXyKf.js","assets/c4Diagram-VJAJSXHY-CJp36gal.js","assets/chunk-D6G4REZN-aNIla4nM.js","assets/flowDiagram-4HSFHLVR-dLjRI7TS.js","assets/chunk-RZ5BOZE2-D_EVfevH.js","assets/channel-DbWpMFzB.js","assets/erDiagram-Q7BY3M3F-r1PlCGr9.js","assets/gitGraphDiagram-7IBYFJ6S-CYx-3I0a.js","assets/chunk-4BMEZGHF-DYue-blK.js","assets/chunk-XZIHB7SX-CB_6F5Kz.js","assets/radar-MK3ICKWK-C4Rb9SSk.js","assets/ganttDiagram-APWFNJXF-DfECq3RF.js","assets/linear-M9IPTfdT.js","assets/init-Gi6I4Gst.js","assets/infoDiagram-PH2N3AL5-C12INeM9.js","assets/pieDiagram-IB7DONF6-DUVre1JV.js","assets/arc-BRX2QwCl.js","assets/ordinal-Cboi1Yqb.js","assets/quadrantDiagram-7GDLP6J5-Bs3I977R.js","assets/xychartDiagram-VJFVF3MP-DGOmMVCs.js","assets/requirementDiagram-KVF5MWMF-DGOU7iYq.js","assets/sequenceDiagram-X6HHIX6F-BgC9UtfA.js","assets/classDiagram-GIVACNV2-DeNZmcv7.js","assets/chunk-A2AXSNBT-DISU_isV.js","assets/classDiagram-v2-COTLJTTW-DeNZmcv7.js","assets/stateDiagram-DGXRK772-CSuiU3oR.js","assets/chunk-AEK57VVT-Bv8gW3JM.js","assets/stateDiagram-v2-YXO3MK2T-BLDFo6Dx.js","assets/journeyDiagram-U35MCT3I-DO428gRt.js","assets/timeline-definition-BDJGKUSR-5PNCS8va.js","assets/mindmap-definition-ALO5MXBD-B5NydZAu.js","assets/cytoscape.esm-cqWLu9nZ.js","assets/sankeyDiagram-QLVOVGJD-DLGD-uQD.js","assets/diagram-VNBRO52H-CfsbngXl.js","assets/diagram-SSKATNLV-B7I0IRWi.js","assets/blockDiagram-JOT3LUYC-D6w7gP5a.js","assets/architectureDiagram-IEHRJDOE-13jt_nqz.js"])))=>i.map(i=>d[i]);
var she=Object.defineProperty;var ihe=(e,t,n)=>t in e?she(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var de=(e,t,n)=>ihe(e,typeof t!="symbol"?t+"":t,n);function ahe(e,t){for(var n=0;n<t.length;n++){const r=t[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in e)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(e,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var tm=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ua(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var dN={exports:{}},Mv={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aB;function ohe(){if(aB)return Mv;aB=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function n(r,s,i){var a=null;if(i!==void 0&&(a=""+i),s.key!==void 0&&(a=""+s.key),"key"in s){i={};for(var o in s)o!=="key"&&(i[o]=s[o])}else i=s;return s=i.ref,{$$typeof:e,type:r,key:a,ref:s!==void 0?s:null,props:i}}return Mv.Fragment=t,Mv.jsx=n,Mv.jsxs=n,Mv}var oB;function lhe(){return oB||(oB=1,dN.exports=ohe()),dN.exports}var f=lhe(),fN={exports:{}};function che(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var ZW={exports:{}},wi=ZW.exports={},fu,hu;function W3(){throw new Error("setTimeout has not been defined")}function H3(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?fu=setTimeout:fu=W3}catch{fu=W3}try{typeof clearTimeout=="function"?hu=clearTimeout:hu=H3}catch{hu=H3}})();function XW(e){if(fu===setTimeout)return setTimeout(e,0);if((fu===W3||!fu)&&setTimeout)return fu=setTimeout,setTimeout(e,0);try{return fu(e,0)}catch{try{return fu.call(null,e,0)}catch{return fu.call(this,e,0)}}}function uhe(e){if(hu===clearTimeout)return clearTimeout(e);if((hu===H3||!hu)&&clearTimeout)return hu=clearTimeout,clearTimeout(e);try{return hu(e)}catch{try{return hu.call(null,e)}catch{return hu.call(this,e)}}}var Rd=[],M0=!1,nm,T2=-1;function dhe(){!M0||!nm||(M0=!1,nm.length?Rd=nm.concat(Rd):T2=-1,Rd.length&&JW())}function JW(){if(!M0){var e=XW(dhe);M0=!0;for(var t=Rd.length;t;){for(nm=Rd,Rd=[];++T2<t;)nm&&nm[T2].run();T2=-1,t=Rd.length}nm=null,M0=!1,uhe(e)}}wi.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];Rd.push(new QW(e,t)),Rd.length===1&&!M0&&XW(JW)};function QW(e,t){this.fun=e,this.array=t}QW.prototype.run=function(){this.fun.apply(null,this.array)};wi.title="browser";wi.browser=!0;wi.env={};wi.argv=[];wi.version="";wi.versions={};function nf(){}wi.on=nf;wi.addListener=nf;wi.once=nf;wi.off=nf;wi.removeListener=nf;wi.removeAllListeners=nf;wi.emit=nf;wi.prependListener=nf;wi.prependOnceListener=nf;wi.listeners=function(e){return[]};wi.binding=function(e){throw new Error("process.binding is not supported")};wi.cwd=function(){return"/"};wi.chdir=function(e){throw new Error("process.chdir is not supported")};wi.umask=function(){return 0};var fhe=ZW.exports;const Mi=che(fhe);var Tr={},lB;function hhe(){if(lB)return Tr;lB=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),i=Symbol.for("react.consumer"),a=Symbol.for("react.context"),o=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),c=Symbol.for("react.memo"),u=Symbol.for("react.lazy"),d=Symbol.iterator;function h(V){return V===null||typeof V!="object"?null:(V=d&&V[d]||V["@@iterator"],typeof V=="function"?V:null)}var m={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y=Object.assign,b={};function v(V,Q,ee){this.props=V,this.context=Q,this.refs=b,this.updater=ee||m}v.prototype.isReactComponent={},v.prototype.setState=function(V,Q){if(typeof V!="object"&&typeof V!="function"&&V!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,V,Q,"setState")},v.prototype.forceUpdate=function(V){this.updater.enqueueForceUpdate(this,V,"forceUpdate")};function x(){}x.prototype=v.prototype;function w(V,Q,ee){this.props=V,this.context=Q,this.refs=b,this.updater=ee||m}var S=w.prototype=new x;S.constructor=w,y(S,v.prototype),S.isPureReactComponent=!0;var k=Array.isArray,C={H:null,A:null,T:null,S:null,V:null},T=Object.prototype.hasOwnProperty;function R(V,Q,ee,se,pe,ue){return ee=ue.ref,{$$typeof:e,type:V,key:Q,ref:ee!==void 0?ee:null,props:ue}}function N(V,Q){return R(V.type,Q,void 0,void 0,void 0,V.props)}function I(V){return typeof V=="object"&&V!==null&&V.$$typeof===e}function P(V){var Q={"=":"=0",":":"=2"};return"$"+V.replace(/[=:]/g,function(ee){return Q[ee]})}var B=/\/+/g;function D(V,Q){return typeof V=="object"&&V!==null&&V.key!=null?P(""+V.key):Q.toString(36)}function W(){}function O(V){switch(V.status){case"fulfilled":return V.value;case"rejected":throw V.reason;default:switch(typeof V.status=="string"?V.then(W,W):(V.status="pending",V.then(function(Q){V.status==="pending"&&(V.status="fulfilled",V.value=Q)},function(Q){V.status==="pending"&&(V.status="rejected",V.reason=Q)})),V.status){case"fulfilled":return V.value;case"rejected":throw V.reason}}throw V}function Z(V,Q,ee,se,pe){var ue=typeof V;(ue==="undefined"||ue==="boolean")&&(V=null);var Oe=!1;if(V===null)Oe=!0;else switch(ue){case"bigint":case"string":case"number":Oe=!0;break;case"object":switch(V.$$typeof){case e:case t:Oe=!0;break;case u:return Oe=V._init,Z(Oe(V._payload),Q,ee,se,pe)}}if(Oe)return pe=pe(V),Oe=se===""?"."+D(V,0):se,k(pe)?(ee="",Oe!=null&&(ee=Oe.replace(B,"$&/")+"/"),Z(pe,Q,ee,"",function(Ce){return Ce})):pe!=null&&(I(pe)&&(pe=N(pe,ee+(pe.key==null||V&&V.key===pe.key?"":(""+pe.key).replace(B,"$&/")+"/")+Oe)),Q.push(pe)),1;Oe=0;var Fe=se===""?".":se+":";if(k(V))for(var Se=0;Se<V.length;Se++)se=V[Se],ue=Fe+D(se,Se),Oe+=Z(se,Q,ee,ue,pe);else if(Se=h(V),typeof Se=="function")for(V=Se.call(V),Se=0;!(se=V.next()).done;)se=se.value,ue=Fe+D(se,Se++),Oe+=Z(se,Q,ee,ue,pe);else if(ue==="object"){if(typeof V.then=="function")return Z(O(V),Q,ee,se,pe);throw Q=String(V),Error("Objects are not valid as a React child (found: "+(Q==="[object Object]"?"object with keys {"+Object.keys(V).join(", ")+"}":Q)+"). If you meant to render a collection of children, use an array instead.")}return Oe}function U(V,Q,ee){if(V==null)return V;var se=[],pe=0;return Z(V,se,"","",function(ue){return Q.call(ee,ue,pe++)}),se}function H(V){if(V._status===-1){var Q=V._result;Q=Q(),Q.then(function(ee){(V._status===0||V._status===-1)&&(V._status=1,V._result=ee)},function(ee){(V._status===0||V._status===-1)&&(V._status=2,V._result=ee)}),V._status===-1&&(V._status=0,V._result=Q)}if(V._status===1)return V._result.default;throw V._result}var L=typeof reportError=="function"?reportError:function(V){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var Q=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof V=="object"&&V!==null&&typeof V.message=="string"?String(V.message):String(V),error:V});if(!window.dispatchEvent(Q))return}else if(typeof Mi=="object"&&typeof Mi.emit=="function"){Mi.emit("uncaughtException",V);return}console.error(V)};function te(){}return Tr.Children={map:U,forEach:function(V,Q,ee){U(V,function(){Q.apply(this,arguments)},ee)},count:function(V){var Q=0;return U(V,function(){Q++}),Q},toArray:function(V){return U(V,function(Q){return Q})||[]},only:function(V){if(!I(V))throw Error("React.Children.only expected to receive a single React element child.");return V}},Tr.Component=v,Tr.Fragment=n,Tr.Profiler=s,Tr.PureComponent=w,Tr.StrictMode=r,Tr.Suspense=l,Tr.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=C,Tr.__COMPILER_RUNTIME={__proto__:null,c:function(V){return C.H.useMemoCache(V)}},Tr.cache=function(V){return function(){return V.apply(null,arguments)}},Tr.cloneElement=function(V,Q,ee){if(V==null)throw Error("The argument must be a React element, but you passed "+V+".");var se=y({},V.props),pe=V.key,ue=void 0;if(Q!=null)for(Oe in Q.ref!==void 0&&(ue=void 0),Q.key!==void 0&&(pe=""+Q.key),Q)!T.call(Q,Oe)||Oe==="key"||Oe==="__self"||Oe==="__source"||Oe==="ref"&&Q.ref===void 0||(se[Oe]=Q[Oe]);var Oe=arguments.length-2;if(Oe===1)se.children=ee;else if(1<Oe){for(var Fe=Array(Oe),Se=0;Se<Oe;Se++)Fe[Se]=arguments[Se+2];se.children=Fe}return R(V.type,pe,void 0,void 0,ue,se)},Tr.createContext=function(V){return V={$$typeof:a,_currentValue:V,_currentValue2:V,_threadCount:0,Provider:null,Consumer:null},V.Provider=V,V.Consumer={$$typeof:i,_context:V},V},Tr.createElement=function(V,Q,ee){var se,pe={},ue=null;if(Q!=null)for(se in Q.key!==void 0&&(ue=""+Q.key),Q)T.call(Q,se)&&se!=="key"&&se!=="__self"&&se!=="__source"&&(pe[se]=Q[se]);var Oe=arguments.length-2;if(Oe===1)pe.children=ee;else if(1<Oe){for(var Fe=Array(Oe),Se=0;Se<Oe;Se++)Fe[Se]=arguments[Se+2];pe.children=Fe}if(V&&V.defaultProps)for(se in Oe=V.defaultProps,Oe)pe[se]===void 0&&(pe[se]=Oe[se]);return R(V,ue,void 0,void 0,null,pe)},Tr.createRef=function(){return{current:null}},Tr.forwardRef=function(V){return{$$typeof:o,render:V}},Tr.isValidElement=I,Tr.lazy=function(V){return{$$typeof:u,_payload:{_status:-1,_result:V},_init:H}},Tr.memo=function(V,Q){return{$$typeof:c,type:V,compare:Q===void 0?null:Q}},Tr.startTransition=function(V){var Q=C.T,ee={};C.T=ee;try{var se=V(),pe=C.S;pe!==null&&pe(ee,se),typeof se=="object"&&se!==null&&typeof se.then=="function"&&se.then(te,L)}catch(ue){L(ue)}finally{C.T=Q}},Tr.unstable_useCacheRefresh=function(){return C.H.useCacheRefresh()},Tr.use=function(V){return C.H.use(V)},Tr.useActionState=function(V,Q,ee){return C.H.useActionState(V,Q,ee)},Tr.useCallback=function(V,Q){return C.H.useCallback(V,Q)},Tr.useContext=function(V){return C.H.useContext(V)},Tr.useDebugValue=function(){},Tr.useDeferredValue=function(V,Q){return C.H.useDeferredValue(V,Q)},Tr.useEffect=function(V,Q,ee){var se=C.H;if(typeof ee=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return se.useEffect(V,Q)},Tr.useId=function(){return C.H.useId()},Tr.useImperativeHandle=function(V,Q,ee){return C.H.useImperativeHandle(V,Q,ee)},Tr.useInsertionEffect=function(V,Q){return C.H.useInsertionEffect(V,Q)},Tr.useLayoutEffect=function(V,Q){return C.H.useLayoutEffect(V,Q)},Tr.useMemo=function(V,Q){return C.H.useMemo(V,Q)},Tr.useOptimistic=function(V,Q){return C.H.useOptimistic(V,Q)},Tr.useReducer=function(V,Q,ee){return C.H.useReducer(V,Q,ee)},Tr.useRef=function(V){return C.H.useRef(V)},Tr.useState=function(V){return C.H.useState(V)},Tr.useSyncExternalStore=function(V,Q,ee){return C.H.useSyncExternalStore(V,Q,ee)},Tr.useTransition=function(){return C.H.useTransition()},Tr.version="19.1.0",Tr}var cB;function By(){return cB||(cB=1,fN.exports=hhe()),fN.exports}var E=By();const Ve=ua(E),eH=ahe({__proto__:null,default:Ve},[E]);var hN={exports:{}},Iv={},pN={exports:{}},mN={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var uB;function phe(){return uB||(uB=1,function(e){function t(U,H){var L=U.length;U.push(H);e:for(;0<L;){var te=L-1>>>1,V=U[te];if(0<s(V,H))U[te]=H,U[L]=V,L=te;else break e}}function n(U){return U.length===0?null:U[0]}function r(U){if(U.length===0)return null;var H=U[0],L=U.pop();if(L!==H){U[0]=L;e:for(var te=0,V=U.length,Q=V>>>1;te<Q;){var ee=2*(te+1)-1,se=U[ee],pe=ee+1,ue=U[pe];if(0>s(se,L))pe<V&&0>s(ue,se)?(U[te]=ue,U[pe]=L,te=pe):(U[te]=se,U[ee]=L,te=ee);else if(pe<V&&0>s(ue,L))U[te]=ue,U[pe]=L,te=pe;else break e}}return H}function s(U,H){var L=U.sortIndex-H.sortIndex;return L!==0?L:U.id-H.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var a=Date,o=a.now();e.unstable_now=function(){return a.now()-o}}var l=[],c=[],u=1,d=null,h=3,m=!1,y=!1,b=!1,v=!1,x=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,S=typeof setImmediate<"u"?setImmediate:null;function k(U){for(var H=n(c);H!==null;){if(H.callback===null)r(c);else if(H.startTime<=U)r(c),H.sortIndex=H.expirationTime,t(l,H);else break;H=n(c)}}function C(U){if(b=!1,k(U),!y)if(n(l)!==null)y=!0,T||(T=!0,D());else{var H=n(c);H!==null&&Z(C,H.startTime-U)}}var T=!1,R=-1,N=5,I=-1;function P(){return v?!0:!(e.unstable_now()-I<N)}function B(){if(v=!1,T){var U=e.unstable_now();I=U;var H=!0;try{e:{y=!1,b&&(b=!1,w(R),R=-1),m=!0;var L=h;try{t:{for(k(U),d=n(l);d!==null&&!(d.expirationTime>U&&P());){var te=d.callback;if(typeof te=="function"){d.callback=null,h=d.priorityLevel;var V=te(d.expirationTime<=U);if(U=e.unstable_now(),typeof V=="function"){d.callback=V,k(U),H=!0;break t}d===n(l)&&r(l),k(U)}else r(l);d=n(l)}if(d!==null)H=!0;else{var Q=n(c);Q!==null&&Z(C,Q.startTime-U),H=!1}}break e}finally{d=null,h=L,m=!1}H=void 0}}finally{H?D():T=!1}}}var D;if(typeof S=="function")D=function(){S(B)};else if(typeof MessageChannel<"u"){var W=new MessageChannel,O=W.port2;W.port1.onmessage=B,D=function(){O.postMessage(null)}}else D=function(){x(B,0)};function Z(U,H){R=x(function(){U(e.unstable_now())},H)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(U){U.callback=null},e.unstable_forceFrameRate=function(U){0>U||125<U?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):N=0<U?Math.floor(1e3/U):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_next=function(U){switch(h){case 1:case 2:case 3:var H=3;break;default:H=h}var L=h;h=H;try{return U()}finally{h=L}},e.unstable_requestPaint=function(){v=!0},e.unstable_runWithPriority=function(U,H){switch(U){case 1:case 2:case 3:case 4:case 5:break;default:U=3}var L=h;h=U;try{return H()}finally{h=L}},e.unstable_scheduleCallback=function(U,H,L){var te=e.unstable_now();switch(typeof L=="object"&&L!==null?(L=L.delay,L=typeof L=="number"&&0<L?te+L:te):L=te,U){case 1:var V=-1;break;case 2:V=250;break;case 5:V=1073741823;break;case 4:V=1e4;break;default:V=5e3}return V=L+V,U={id:u++,callback:H,priorityLevel:U,startTime:L,expirationTime:V,sortIndex:-1},L>te?(U.sortIndex=L,t(c,U),n(l)===null&&U===n(c)&&(b?(w(R),R=-1):b=!0,Z(C,L-te))):(U.sortIndex=V,t(l,U),y||m||(y=!0,T||(T=!0,D()))),U},e.unstable_shouldYield=P,e.unstable_wrapCallback=function(U){var H=h;return function(){var L=h;h=H;try{return U.apply(this,arguments)}finally{h=L}}}}(mN)),mN}var dB;function mhe(){return dB||(dB=1,pN.exports=phe()),pN.exports}var gN={exports:{}},Na={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fB;function ghe(){if(fB)return Na;fB=1;var e=By();function t(l){var c="https://react.dev/errors/"+l;if(1<arguments.length){c+="?args[]="+encodeURIComponent(arguments[1]);for(var u=2;u<arguments.length;u++)c+="&args[]="+encodeURIComponent(arguments[u])}return"Minified React error #"+l+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var r={d:{f:n,r:function(){throw Error(t(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},s=Symbol.for("react.portal");function i(l,c,u){var d=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:d==null?null:""+d,children:l,containerInfo:c,implementation:u}}var a=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function o(l,c){if(l==="font")return"";if(typeof c=="string")return c==="use-credentials"?c:""}return Na.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,Na.createPortal=function(l,c){var u=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!c||c.nodeType!==1&&c.nodeType!==9&&c.nodeType!==11)throw Error(t(299));return i(l,c,null,u)},Na.flushSync=function(l){var c=a.T,u=r.p;try{if(a.T=null,r.p=2,l)return l()}finally{a.T=c,r.p=u,r.d.f()}},Na.preconnect=function(l,c){typeof l=="string"&&(c?(c=c.crossOrigin,c=typeof c=="string"?c==="use-credentials"?c:"":void 0):c=null,r.d.C(l,c))},Na.prefetchDNS=function(l){typeof l=="string"&&r.d.D(l)},Na.preinit=function(l,c){if(typeof l=="string"&&c&&typeof c.as=="string"){var u=c.as,d=o(u,c.crossOrigin),h=typeof c.integrity=="string"?c.integrity:void 0,m=typeof c.fetchPriority=="string"?c.fetchPriority:void 0;u==="style"?r.d.S(l,typeof c.precedence=="string"?c.precedence:void 0,{crossOrigin:d,integrity:h,fetchPriority:m}):u==="script"&&r.d.X(l,{crossOrigin:d,integrity:h,fetchPriority:m,nonce:typeof c.nonce=="string"?c.nonce:void 0})}},Na.preinitModule=function(l,c){if(typeof l=="string")if(typeof c=="object"&&c!==null){if(c.as==null||c.as==="script"){var u=o(c.as,c.crossOrigin);r.d.M(l,{crossOrigin:u,integrity:typeof c.integrity=="string"?c.integrity:void 0,nonce:typeof c.nonce=="string"?c.nonce:void 0})}}else c==null&&r.d.M(l)},Na.preload=function(l,c){if(typeof l=="string"&&typeof c=="object"&&c!==null&&typeof c.as=="string"){var u=c.as,d=o(u,c.crossOrigin);r.d.L(l,u,{crossOrigin:d,integrity:typeof c.integrity=="string"?c.integrity:void 0,nonce:typeof c.nonce=="string"?c.nonce:void 0,type:typeof c.type=="string"?c.type:void 0,fetchPriority:typeof c.fetchPriority=="string"?c.fetchPriority:void 0,referrerPolicy:typeof c.referrerPolicy=="string"?c.referrerPolicy:void 0,imageSrcSet:typeof c.imageSrcSet=="string"?c.imageSrcSet:void 0,imageSizes:typeof c.imageSizes=="string"?c.imageSizes:void 0,media:typeof c.media=="string"?c.media:void 0})}},Na.preloadModule=function(l,c){if(typeof l=="string")if(c){var u=o(c.as,c.crossOrigin);r.d.m(l,{as:typeof c.as=="string"&&c.as!=="script"?c.as:void 0,crossOrigin:u,integrity:typeof c.integrity=="string"?c.integrity:void 0})}else r.d.m(l)},Na.requestFormReset=function(l){r.d.r(l)},Na.unstable_batchedUpdates=function(l,c){return l(c)},Na.useFormState=function(l,c,u){return a.H.useFormState(l,c,u)},Na.useFormStatus=function(){return a.H.useHostTransitionStatus()},Na.version="19.1.0",Na}var hB;function tH(){if(hB)return gN.exports;hB=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),gN.exports=ghe(),gN.exports}var pB;function yhe(){if(pB)return Iv;pB=1;var e=mhe(),t=By(),n=tH();function r(p){var g="https://react.dev/errors/"+p;if(1<arguments.length){g+="?args[]="+encodeURIComponent(arguments[1]);for(var _=2;_<arguments.length;_++)g+="&args[]="+encodeURIComponent(arguments[_])}return"Minified React error #"+p+"; visit "+g+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(p){return!(!p||p.nodeType!==1&&p.nodeType!==9&&p.nodeType!==11)}function i(p){var g=p,_=p;if(p.alternate)for(;g.return;)g=g.return;else{p=g;do g=p,(g.flags&4098)!==0&&(_=g.return),p=g.return;while(p)}return g.tag===3?_:null}function a(p){if(p.tag===13){var g=p.memoizedState;if(g===null&&(p=p.alternate,p!==null&&(g=p.memoizedState)),g!==null)return g.dehydrated}return null}function o(p){if(i(p)!==p)throw Error(r(188))}function l(p){var g=p.alternate;if(!g){if(g=i(p),g===null)throw Error(r(188));return g!==p?null:p}for(var _=p,A=g;;){var j=_.return;if(j===null)break;var q=j.alternate;if(q===null){if(A=j.return,A!==null){_=A;continue}break}if(j.child===q.child){for(q=j.child;q;){if(q===_)return o(j),p;if(q===A)return o(j),g;q=q.sibling}throw Error(r(188))}if(_.return!==A.return)_=j,A=q;else{for(var he=!1,je=j.child;je;){if(je===_){he=!0,_=j,A=q;break}if(je===A){he=!0,A=j,_=q;break}je=je.sibling}if(!he){for(je=q.child;je;){if(je===_){he=!0,_=q,A=j;break}if(je===A){he=!0,A=q,_=j;break}je=je.sibling}if(!he)throw Error(r(189))}}if(_.alternate!==A)throw Error(r(190))}if(_.tag!==3)throw Error(r(188));return _.stateNode.current===_?p:g}function c(p){var g=p.tag;if(g===5||g===26||g===27||g===6)return p;for(p=p.child;p!==null;){if(g=c(p),g!==null)return g;p=p.sibling}return null}var u=Object.assign,d=Symbol.for("react.element"),h=Symbol.for("react.transitional.element"),m=Symbol.for("react.portal"),y=Symbol.for("react.fragment"),b=Symbol.for("react.strict_mode"),v=Symbol.for("react.profiler"),x=Symbol.for("react.provider"),w=Symbol.for("react.consumer"),S=Symbol.for("react.context"),k=Symbol.for("react.forward_ref"),C=Symbol.for("react.suspense"),T=Symbol.for("react.suspense_list"),R=Symbol.for("react.memo"),N=Symbol.for("react.lazy"),I=Symbol.for("react.activity"),P=Symbol.for("react.memo_cache_sentinel"),B=Symbol.iterator;function D(p){return p===null||typeof p!="object"?null:(p=B&&p[B]||p["@@iterator"],typeof p=="function"?p:null)}var W=Symbol.for("react.client.reference");function O(p){if(p==null)return null;if(typeof p=="function")return p.$$typeof===W?null:p.displayName||p.name||null;if(typeof p=="string")return p;switch(p){case y:return"Fragment";case v:return"Profiler";case b:return"StrictMode";case C:return"Suspense";case T:return"SuspenseList";case I:return"Activity"}if(typeof p=="object")switch(p.$$typeof){case m:return"Portal";case S:return(p.displayName||"Context")+".Provider";case w:return(p._context.displayName||"Context")+".Consumer";case k:var g=p.render;return p=p.displayName,p||(p=g.displayName||g.name||"",p=p!==""?"ForwardRef("+p+")":"ForwardRef"),p;case R:return g=p.displayName||null,g!==null?g:O(p.type)||"Memo";case N:g=p._payload,p=p._init;try{return O(p(g))}catch{}}return null}var Z=Array.isArray,U=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,H=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,L={pending:!1,data:null,method:null,action:null},te=[],V=-1;function Q(p){return{current:p}}function ee(p){0>V||(p.current=te[V],te[V]=null,V--)}function se(p,g){V++,te[V]=p.current,p.current=g}var pe=Q(null),ue=Q(null),Oe=Q(null),Fe=Q(null);function Se(p,g){switch(se(Oe,g),se(ue,p),se(pe,null),g.nodeType){case 9:case 11:p=(p=g.documentElement)&&(p=p.namespaceURI)?OL(p):0;break;default:if(p=g.tagName,g=g.namespaceURI)g=OL(g),p=PL(g,p);else switch(p){case"svg":p=1;break;case"math":p=2;break;default:p=0}}ee(pe),se(pe,p)}function Ce(){ee(pe),ee(ue),ee(Oe)}function qe(p){p.memoizedState!==null&&se(Fe,p);var g=pe.current,_=PL(g,p.type);g!==_&&(se(ue,p),se(pe,_))}function Qe(p){ue.current===p&&(ee(pe),ee(ue)),Fe.current===p&&(ee(Fe),Ev._currentValue=L)}var We=Object.prototype.hasOwnProperty,Ie=e.unstable_scheduleCallback,K=e.unstable_cancelCallback,ye=e.unstable_shouldYield,Ne=e.unstable_requestPaint,ce=e.unstable_now,oe=e.unstable_getCurrentPriorityLevel,re=e.unstable_ImmediatePriority,Re=e.unstable_UserBlockingPriority,Be=e.unstable_NormalPriority,Te=e.unstable_LowPriority,lt=e.unstable_IdlePriority,Tt=e.log,ut=e.unstable_setDisableYieldValue,jt=null,qt=null;function Ft(p){if(typeof Tt=="function"&&ut(p),qt&&typeof qt.setStrictMode=="function")try{qt.setStrictMode(jt,p)}catch{}}var Ht=Math.clz32?Math.clz32:X,we=Math.log,F=Math.LN2;function X(p){return p>>>=0,p===0?32:31-(we(p)/F|0)|0}var be=256,ke=4194304;function ge(p){var g=p&42;if(g!==0)return g;switch(p&-p){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return p&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return p&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return p}}function Ee(p,g,_){var A=p.pendingLanes;if(A===0)return 0;var j=0,q=p.suspendedLanes,he=p.pingedLanes;p=p.warmLanes;var je=A&134217727;return je!==0?(A=je&~q,A!==0?j=ge(A):(he&=je,he!==0?j=ge(he):_||(_=je&~p,_!==0&&(j=ge(_))))):(je=A&~q,je!==0?j=ge(je):he!==0?j=ge(he):_||(_=A&~p,_!==0&&(j=ge(_)))),j===0?0:g!==0&&g!==j&&(g&q)===0&&(q=j&-j,_=g&-g,q>=_||q===32&&(_&4194048)!==0)?g:j}function le(p,g){return(p.pendingLanes&~(p.suspendedLanes&~p.pingedLanes)&g)===0}function dt(p,g){switch(p){case 1:case 2:case 4:case 8:case 64:return g+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return g+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function et(){var p=be;return be<<=1,(be&4194048)===0&&(be=256),p}function $(){var p=ke;return ke<<=1,(ke&62914560)===0&&(ke=4194304),p}function Ue(p){for(var g=[],_=0;31>_;_++)g.push(p);return g}function tt(p,g){p.pendingLanes|=g,g!==268435456&&(p.suspendedLanes=0,p.pingedLanes=0,p.warmLanes=0)}function ve(p,g,_,A,j,q){var he=p.pendingLanes;p.pendingLanes=_,p.suspendedLanes=0,p.pingedLanes=0,p.warmLanes=0,p.expiredLanes&=_,p.entangledLanes&=_,p.errorRecoveryDisabledLanes&=_,p.shellSuspendCounter=0;var je=p.entanglements,Ye=p.expirationTimes,St=p.hiddenUpdates;for(_=he&~_;0<_;){var Dt=31-Ht(_),Bt=1<<Dt;je[Dt]=0,Ye[Dt]=-1;var Et=St[Dt];if(Et!==null)for(St[Dt]=null,Dt=0;Dt<Et.length;Dt++){var Rt=Et[Dt];Rt!==null&&(Rt.lane&=-536870913)}_&=~Bt}A!==0&&_e(p,A,0),q!==0&&j===0&&p.tag!==0&&(p.suspendedLanes|=q&~(he&~g))}function _e(p,g,_){p.pendingLanes|=g,p.suspendedLanes&=~g;var A=31-Ht(g);p.entangledLanes|=g,p.entanglements[A]=p.entanglements[A]|1073741824|_&4194090}function $e(p,g){var _=p.entangledLanes|=g;for(p=p.entanglements;_;){var A=31-Ht(_),j=1<<A;j&g|p[A]&g&&(p[A]|=g),_&=~j}}function Ct(p){switch(p){case 2:p=1;break;case 8:p=4;break;case 32:p=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:p=128;break;case 268435456:p=134217728;break;default:p=0}return p}function fe(p){return p&=-p,2<p?8<p?(p&134217727)!==0?32:268435456:8:2}function Y(){var p=H.p;return p!==0?p:(p=window.event,p===void 0?32:eB(p.type))}function G(p,g){var _=H.p;try{return H.p=p,g()}finally{H.p=_}}var J=Math.random().toString(36).slice(2),xe="__reactFiber$"+J,De="__reactProps$"+J,He="__reactContainer$"+J,xt="__reactEvents$"+J,Qt="__reactListeners$"+J,On="__reactHandles$"+J,Zt="__reactResources$"+J,nn="__reactMarker$"+J;function un(p){delete p[xe],delete p[De],delete p[xt],delete p[Qt],delete p[On]}function gr(p){var g=p[xe];if(g)return g;for(var _=p.parentNode;_;){if(g=_[He]||_[xe]){if(_=g.alternate,g.child!==null||_!==null&&_.child!==null)for(p=BL(p);p!==null;){if(_=p[xe])return _;p=BL(p)}return g}p=_,_=p.parentNode}return null}function Nr(p){if(p=p[xe]||p[He]){var g=p.tag;if(g===5||g===6||g===13||g===26||g===27||g===3)return p}return null}function ns(p){var g=p.tag;if(g===5||g===26||g===27||g===6)return p.stateNode;throw Error(r(33))}function rs(p){var g=p[Zt];return g||(g=p[Zt]={hoistableStyles:new Map,hoistableScripts:new Map}),g}function kr(p){p[nn]=!0}var hn=new Set,nt={};function Vt(p,g){pn(p,g),pn(p+"Capture",g)}function pn(p,g){for(nt[p]=g,p=0;p<g.length;p++)hn.add(g[p])}var sr=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Rs={},es={};function Di(p){return We.call(es,p)?!0:We.call(Rs,p)?!1:sr.test(p)?es[p]=!0:(Rs[p]=!0,!1)}function di(p,g,_){if(Di(g))if(_===null)p.removeAttribute(g);else{switch(typeof _){case"undefined":case"function":case"symbol":p.removeAttribute(g);return;case"boolean":var A=g.toLowerCase().slice(0,5);if(A!=="data-"&&A!=="aria-"){p.removeAttribute(g);return}}p.setAttribute(g,""+_)}}function Wa(p,g,_){if(_===null)p.removeAttribute(g);else{switch(typeof _){case"undefined":case"function":case"symbol":case"boolean":p.removeAttribute(g);return}p.setAttribute(g,""+_)}}function ha(p,g,_,A){if(A===null)p.removeAttribute(_);else{switch(typeof A){case"undefined":case"function":case"symbol":case"boolean":p.removeAttribute(_);return}p.setAttributeNS(g,_,""+A)}}var Hs,Go;function wl(p){if(Hs===void 0)try{throw Error()}catch(_){var g=_.stack.trim().match(/\n( *(at )?)/);Hs=g&&g[1]||"",Go=-1<_.stack.indexOf(`
    at`)?" (<anonymous>)":-1<_.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Hs+p+Go}var pf=!1;function lg(p,g){if(!p||pf)return"";pf=!0;var _=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var A={DetermineComponentFrameRoot:function(){try{if(g){var Bt=function(){throw Error()};if(Object.defineProperty(Bt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Bt,[])}catch(Rt){var Et=Rt}Reflect.construct(p,[],Bt)}else{try{Bt.call()}catch(Rt){Et=Rt}p.call(Bt.prototype)}}else{try{throw Error()}catch(Rt){Et=Rt}(Bt=p())&&typeof Bt.catch=="function"&&Bt.catch(function(){})}}catch(Rt){if(Rt&&Et&&typeof Rt.stack=="string")return[Rt.stack,Et.stack]}return[null,null]}};A.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var j=Object.getOwnPropertyDescriptor(A.DetermineComponentFrameRoot,"name");j&&j.configurable&&Object.defineProperty(A.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var q=A.DetermineComponentFrameRoot(),he=q[0],je=q[1];if(he&&je){var Ye=he.split(`
`),St=je.split(`
`);for(j=A=0;A<Ye.length&&!Ye[A].includes("DetermineComponentFrameRoot");)A++;for(;j<St.length&&!St[j].includes("DetermineComponentFrameRoot");)j++;if(A===Ye.length||j===St.length)for(A=Ye.length-1,j=St.length-1;1<=A&&0<=j&&Ye[A]!==St[j];)j--;for(;1<=A&&0<=j;A--,j--)if(Ye[A]!==St[j]){if(A!==1||j!==1)do if(A--,j--,0>j||Ye[A]!==St[j]){var Dt=`
`+Ye[A].replace(" at new "," at ");return p.displayName&&Dt.includes("<anonymous>")&&(Dt=Dt.replace("<anonymous>",p.displayName)),Dt}while(1<=A&&0<=j);break}}}finally{pf=!1,Error.prepareStackTrace=_}return(_=p?p.displayName||p.name:"")?wl(_):""}function Dr(p){switch(p.tag){case 26:case 27:case 5:return wl(p.type);case 16:return wl("Lazy");case 13:return wl("Suspense");case 19:return wl("SuspenseList");case 0:case 15:return lg(p.type,!1);case 11:return lg(p.type.render,!1);case 1:return lg(p.type,!0);case 31:return wl("Activity");default:return""}}function Ab(p){try{var g="";do g+=Dr(p),p=p.return;while(p);return g}catch(_){return`
Error generating stack: `+_.message+`
`+_.stack}}function Ha(p){switch(typeof p){case"bigint":case"boolean":case"number":case"string":case"undefined":return p;case"object":return p;default:return""}}function Rb(p){var g=p.type;return(p=p.nodeName)&&p.toLowerCase()==="input"&&(g==="checkbox"||g==="radio")}function Ns(p){var g=Rb(p)?"checked":"value",_=Object.getOwnPropertyDescriptor(p.constructor.prototype,g),A=""+p[g];if(!p.hasOwnProperty(g)&&typeof _<"u"&&typeof _.get=="function"&&typeof _.set=="function"){var j=_.get,q=_.set;return Object.defineProperty(p,g,{configurable:!0,get:function(){return j.call(this)},set:function(he){A=""+he,q.call(this,he)}}),Object.defineProperty(p,g,{enumerable:_.enumerable}),{getValue:function(){return A},setValue:function(he){A=""+he},stopTracking:function(){p._valueTracker=null,delete p[g]}}}}function Gc(p){p._valueTracker||(p._valueTracker=Ns(p))}function mf(p){if(!p)return!1;var g=p._valueTracker;if(!g)return!0;var _=g.getValue(),A="";return p&&(A=Rb(p)?p.checked?"true":"false":p.value),p=A,p!==_?(g.setValue(p),!0):!1}function lc(p){if(p=p||(typeof document<"u"?document:void 0),typeof p>"u")return null;try{return p.activeElement||p.body}catch{return p.body}}var Nb=/[\n"\\]/g;function Ea(p){return p.replace(Nb,function(g){return"\\"+g.charCodeAt(0).toString(16)+" "})}function gf(p,g,_,A,j,q,he,je){p.name="",he!=null&&typeof he!="function"&&typeof he!="symbol"&&typeof he!="boolean"?p.type=he:p.removeAttribute("type"),g!=null?he==="number"?(g===0&&p.value===""||p.value!=g)&&(p.value=""+Ha(g)):p.value!==""+Ha(g)&&(p.value=""+Ha(g)):he!=="submit"&&he!=="reset"||p.removeAttribute("value"),g!=null?yf(p,he,Ha(g)):_!=null?yf(p,he,Ha(_)):A!=null&&p.removeAttribute("value"),j==null&&q!=null&&(p.defaultChecked=!!q),j!=null&&(p.checked=j&&typeof j!="function"&&typeof j!="symbol"),je!=null&&typeof je!="function"&&typeof je!="symbol"&&typeof je!="boolean"?p.name=""+Ha(je):p.removeAttribute("name")}function Mb(p,g,_,A,j,q,he,je){if(q!=null&&typeof q!="function"&&typeof q!="symbol"&&typeof q!="boolean"&&(p.type=q),g!=null||_!=null){if(!(q!=="submit"&&q!=="reset"||g!=null))return;_=_!=null?""+Ha(_):"",g=g!=null?""+Ha(g):_,je||g===p.value||(p.value=g),p.defaultValue=g}A=A??j,A=typeof A!="function"&&typeof A!="symbol"&&!!A,p.checked=je?p.checked:!!A,p.defaultChecked=!!A,he!=null&&typeof he!="function"&&typeof he!="symbol"&&typeof he!="boolean"&&(p.name=he)}function yf(p,g,_){g==="number"&&lc(p.ownerDocument)===p||p.defaultValue===""+_||(p.defaultValue=""+_)}function Ku(p,g,_,A){if(p=p.options,g){g={};for(var j=0;j<_.length;j++)g["$"+_[j]]=!0;for(_=0;_<p.length;_++)j=g.hasOwnProperty("$"+p[_].value),p[_].selected!==j&&(p[_].selected=j),j&&A&&(p[_].defaultSelected=!0)}else{for(_=""+Ha(_),g=null,j=0;j<p.length;j++){if(p[j].value===_){p[j].selected=!0,A&&(p[j].defaultSelected=!0);return}g!==null||p[j].disabled||(g=p[j])}g!==null&&(g.selected=!0)}}function bf(p,g,_){if(g!=null&&(g=""+Ha(g),g!==p.value&&(p.value=g),_==null)){p.defaultValue!==g&&(p.defaultValue=g);return}p.defaultValue=_!=null?""+Ha(_):""}function Ib(p,g,_,A){if(g==null){if(A!=null){if(_!=null)throw Error(r(92));if(Z(A)){if(1<A.length)throw Error(r(93));A=A[0]}_=A}_==null&&(_=""),g=_}_=Ha(g),p.defaultValue=_,A=p.textContent,A===_&&A!==""&&A!==null&&(p.value=A)}function vf(p,g){if(g){var _=p.firstChild;if(_&&_===p.lastChild&&_.nodeType===3){_.nodeValue=g;return}}p.textContent=g}var Hr=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function cg(p,g,_){var A=g.indexOf("--")===0;_==null||typeof _=="boolean"||_===""?A?p.setProperty(g,""):g==="float"?p.cssFloat="":p[g]="":A?p.setProperty(g,_):typeof _!="number"||_===0||Hr.has(g)?g==="float"?p.cssFloat=_:p[g]=(""+_).trim():p[g]=_+"px"}function v_(p,g,_){if(g!=null&&typeof g!="object")throw Error(r(62));if(p=p.style,_!=null){for(var A in _)!_.hasOwnProperty(A)||g!=null&&g.hasOwnProperty(A)||(A.indexOf("--")===0?p.setProperty(A,""):A==="float"?p.cssFloat="":p[A]="");for(var j in g)A=g[j],g.hasOwnProperty(j)&&_[j]!==A&&cg(p,j,A)}else for(var q in g)g.hasOwnProperty(q)&&cg(p,q,g[q])}function jb(p){if(p.indexOf("-")===-1)return!1;switch(p){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ga=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),xf=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Yu(p){return xf.test(""+p)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":p}var _l=null;function ug(p){return p=p.target||p.srcElement||window,p.correspondingUseElement&&(p=p.correspondingUseElement),p.nodeType===3?p.parentNode:p}var Zu=null,Ls=null;function Ko(p){var g=Nr(p);if(g&&(p=g.stateNode)){var _=p[De]||null;e:switch(p=g.stateNode,g.type){case"input":if(gf(p,_.value,_.defaultValue,_.defaultValue,_.checked,_.defaultChecked,_.type,_.name),g=_.name,_.type==="radio"&&g!=null){for(_=p;_.parentNode;)_=_.parentNode;for(_=_.querySelectorAll('input[name="'+Ea(""+g)+'"][type="radio"]'),g=0;g<_.length;g++){var A=_[g];if(A!==p&&A.form===p.form){var j=A[De]||null;if(!j)throw Error(r(90));gf(A,j.value,j.defaultValue,j.defaultValue,j.checked,j.defaultChecked,j.type,j.name)}}for(g=0;g<_.length;g++)A=_[g],A.form===p.form&&mf(A)}break e;case"textarea":bf(p,_.value,_.defaultValue);break e;case"select":g=_.value,g!=null&&Ku(p,!!_.multiple,g,!1)}}}var Xu=!1;function wf(p,g,_){if(Xu)return p(g,_);Xu=!0;try{var A=p(g);return A}finally{if(Xu=!1,(Zu!==null||Ls!==null)&&(oS(),Zu&&(g=Zu,p=Ls,Ls=Zu=null,Ko(g),p)))for(g=0;g<p.length;g++)Ko(p[g])}}function Ju(p,g){var _=p.stateNode;if(_===null)return null;var A=_[De]||null;if(A===null)return null;_=A[g];e:switch(g){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(A=!A.disabled)||(p=p.type,A=!(p==="button"||p==="input"||p==="select"||p==="textarea")),p=!A;break e;default:p=!1}if(p)return null;if(_&&typeof _!="function")throw Error(r(231,g,typeof _));return _}var Yi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ob=!1;if(Yi)try{var Ta={};Object.defineProperty(Ta,"passive",{get:function(){Ob=!0}}),window.addEventListener("test",Ta,Ta),window.removeEventListener("test",Ta,Ta)}catch{Ob=!1}var Sl=null,dg=null,_f=null;function Sf(){if(_f)return _f;var p,g=dg,_=g.length,A,j="value"in Sl?Sl.value:Sl.textContent,q=j.length;for(p=0;p<_&&g[p]===j[p];p++);var he=_-p;for(A=1;A<=he&&g[_-A]===j[q-A];A++);return _f=j.slice(p,1<A?1-A:void 0)}function Cf(p){var g=p.keyCode;return"charCode"in p?(p=p.charCode,p===0&&g===13&&(p=13)):p=g,p===10&&(p=13),32<=p||p===13?p:0}function pp(){return!0}function x_(){return!1}function Si(p){function g(_,A,j,q,he){this._reactName=_,this._targetInst=j,this.type=A,this.nativeEvent=q,this.target=he,this.currentTarget=null;for(var je in p)p.hasOwnProperty(je)&&(_=p[je],this[je]=_?_(q):q[je]);return this.isDefaultPrevented=(q.defaultPrevented!=null?q.defaultPrevented:q.returnValue===!1)?pp:x_,this.isPropagationStopped=x_,this}return u(g.prototype,{preventDefault:function(){this.defaultPrevented=!0;var _=this.nativeEvent;_&&(_.preventDefault?_.preventDefault():typeof _.returnValue!="unknown"&&(_.returnValue=!1),this.isDefaultPrevented=pp)},stopPropagation:function(){var _=this.nativeEvent;_&&(_.stopPropagation?_.stopPropagation():typeof _.cancelBubble!="unknown"&&(_.cancelBubble=!0),this.isPropagationStopped=pp)},persist:function(){},isPersistent:pp}),g}var Qu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(p){return p.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},fg=Si(Qu),Kc=u({},Qu,{view:0,detail:0}),hg=Si(Kc),mp,Pb,gp,pg=u({},Kc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ed,button:0,buttons:0,relatedTarget:function(p){return p.relatedTarget===void 0?p.fromElement===p.srcElement?p.toElement:p.fromElement:p.relatedTarget},movementX:function(p){return"movementX"in p?p.movementX:(p!==gp&&(gp&&p.type==="mousemove"?(mp=p.screenX-gp.screenX,Pb=p.screenY-gp.screenY):Pb=mp=0,gp=p),mp)},movementY:function(p){return"movementY"in p?p.movementY:Pb}}),mg=Si(pg),Db=u({},pg,{dataTransfer:0}),w_=Si(Db),gg=u({},Kc,{relatedTarget:0}),kf=Si(gg),yg=u({},Qu,{animationName:0,elapsedTime:0,pseudoElement:0}),__=Si(yg),kA=u({},Qu,{clipboardData:function(p){return"clipboardData"in p?p.clipboardData:window.clipboardData}}),bg=Si(kA),Fb=u({},Qu,{data:0}),vg=Si(Fb),Lb={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Bb={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Zi={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function yp(p){var g=this.nativeEvent;return g.getModifierState?g.getModifierState(p):(p=Zi[p])?!!g[p]:!1}function ed(){return yp}var S_=u({},Kc,{key:function(p){if(p.key){var g=Lb[p.key]||p.key;if(g!=="Unidentified")return g}return p.type==="keypress"?(p=Cf(p),p===13?"Enter":String.fromCharCode(p)):p.type==="keydown"||p.type==="keyup"?Bb[p.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ed,charCode:function(p){return p.type==="keypress"?Cf(p):0},keyCode:function(p){return p.type==="keydown"||p.type==="keyup"?p.keyCode:0},which:function(p){return p.type==="keypress"?Cf(p):p.type==="keydown"||p.type==="keyup"?p.keyCode:0}}),xg=Si(S_),C_=u({},pg,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),$b=Si(C_),wg=u({},Kc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ed}),zb=Si(wg),td=u({},Qu,{propertyName:0,elapsedTime:0,pseudoElement:0}),Ub=Si(td),qb=u({},pg,{deltaX:function(p){return"deltaX"in p?p.deltaX:"wheelDeltaX"in p?-p.wheelDeltaX:0},deltaY:function(p){return"deltaY"in p?p.deltaY:"wheelDeltaY"in p?-p.wheelDeltaY:"wheelDelta"in p?-p.wheelDelta:0},deltaZ:0,deltaMode:0}),_g=Si(qb),Vb=u({},Qu,{newState:0,oldState:0}),k_=Si(Vb),EA=[9,13,27,32],bp=Yi&&"CompositionEvent"in window,Yc=null;Yi&&"documentMode"in document&&(Yc=document.documentMode);var TA=Yi&&"TextEvent"in window&&!Yc,Sg=Yi&&(!bp||Yc&&8<Yc&&11>=Yc),Cg=" ",E_=!1;function Wb(p,g){switch(p){case"keyup":return EA.indexOf(g.keyCode)!==-1;case"keydown":return g.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function T_(p){return p=p.detail,typeof p=="object"&&"data"in p?p.data:null}var nd=!1;function A_(p,g){switch(p){case"compositionend":return T_(g);case"keypress":return g.which!==32?null:(E_=!0,Cg);case"textInput":return p=g.data,p===Cg&&E_?null:p;default:return null}}function AA(p,g){if(nd)return p==="compositionend"||!bp&&Wb(p,g)?(p=Sf(),_f=dg=Sl=null,nd=!1,p):null;switch(p){case"paste":return null;case"keypress":if(!(g.ctrlKey||g.altKey||g.metaKey)||g.ctrlKey&&g.altKey){if(g.char&&1<g.char.length)return g.char;if(g.which)return String.fromCharCode(g.which)}return null;case"compositionend":return Sg&&g.locale!=="ko"?null:g.data;default:return null}}var R_={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function kg(p){var g=p&&p.nodeName&&p.nodeName.toLowerCase();return g==="input"?!!R_[p.type]:g==="textarea"}function Hb(p,g,_,A){Zu?Ls?Ls.push(A):Ls=[A]:Zu=A,g=hS(g,"onChange"),0<g.length&&(_=new fg("onChange","change",null,_,A),p.push({event:_,listeners:g}))}var Ef=null,vp=null;function RA(p){RL(p,0)}function Eg(p){var g=ns(p);if(mf(g))return p}function xp(p,g){if(p==="change")return g}var Cl=!1;if(Yi){var Bs;if(Yi){var Tf="oninput"in document;if(!Tf){var Ka=document.createElement("div");Ka.setAttribute("oninput","return;"),Tf=typeof Ka.oninput=="function"}Bs=Tf}else Bs=!1;Cl=Bs&&(!document.documentMode||9<document.documentMode)}function N_(){Ef&&(Ef.detachEvent("onpropertychange",Tg),vp=Ef=null)}function Tg(p){if(p.propertyName==="value"&&Eg(vp)){var g=[];Hb(g,vp,p,ug(p)),wf(RA,g)}}function M_(p,g,_){p==="focusin"?(N_(),Ef=g,vp=_,Ef.attachEvent("onpropertychange",Tg)):p==="focusout"&&N_()}function rd(p){if(p==="selectionchange"||p==="keyup"||p==="keydown")return Eg(vp)}function Gb(p,g){if(p==="click")return Eg(g)}function Af(p,g){if(p==="input"||p==="change")return Eg(g)}function Zc(p,g){return p===g&&(p!==0||1/p===1/g)||p!==p&&g!==g}var Aa=typeof Object.is=="function"?Object.is:Zc;function M(p,g){if(Aa(p,g))return!0;if(typeof p!="object"||p===null||typeof g!="object"||g===null)return!1;var _=Object.keys(p),A=Object.keys(g);if(_.length!==A.length)return!1;for(A=0;A<_.length;A++){var j=_[A];if(!We.call(g,j)||!Aa(p[j],g[j]))return!1}return!0}function z(p){for(;p&&p.firstChild;)p=p.firstChild;return p}function ne(p,g){var _=z(p);p=0;for(var A;_;){if(_.nodeType===3){if(A=p+_.textContent.length,p<=g&&A>=g)return{node:_,offset:g-p};p=A}e:{for(;_;){if(_.nextSibling){_=_.nextSibling;break e}_=_.parentNode}_=void 0}_=z(_)}}function ae(p,g){return p&&g?p===g?!0:p&&p.nodeType===3?!1:g&&g.nodeType===3?ae(p,g.parentNode):"contains"in p?p.contains(g):p.compareDocumentPosition?!!(p.compareDocumentPosition(g)&16):!1:!1}function me(p){p=p!=null&&p.ownerDocument!=null&&p.ownerDocument.defaultView!=null?p.ownerDocument.defaultView:window;for(var g=lc(p.document);g instanceof p.HTMLIFrameElement;){try{var _=typeof g.contentWindow.location.href=="string"}catch{_=!1}if(_)p=g.contentWindow;else break;g=lc(p.document)}return g}function Ae(p){var g=p&&p.nodeName&&p.nodeName.toLowerCase();return g&&(g==="input"&&(p.type==="text"||p.type==="search"||p.type==="tel"||p.type==="url"||p.type==="password")||g==="textarea"||p.contentEditable==="true")}var Le=Yi&&"documentMode"in document&&11>=document.documentMode,Ge=null,st=null,at=null,ht=!1;function Je(p,g,_){var A=_.window===_?_.document:_.nodeType===9?_:_.ownerDocument;ht||Ge==null||Ge!==lc(A)||(A=Ge,"selectionStart"in A&&Ae(A)?A={start:A.selectionStart,end:A.selectionEnd}:(A=(A.ownerDocument&&A.ownerDocument.defaultView||window).getSelection(),A={anchorNode:A.anchorNode,anchorOffset:A.anchorOffset,focusNode:A.focusNode,focusOffset:A.focusOffset}),at&&M(at,A)||(at=A,A=hS(st,"onSelect"),0<A.length&&(g=new fg("onSelect","select",null,g,_),p.push({event:g,listeners:A}),g.target=Ge)))}function gt(p,g){var _={};return _[p.toLowerCase()]=g.toLowerCase(),_["Webkit"+p]="webkit"+g,_["Moz"+p]="moz"+g,_}var rt={animationend:gt("Animation","AnimationEnd"),animationiteration:gt("Animation","AnimationIteration"),animationstart:gt("Animation","AnimationStart"),transitionrun:gt("Transition","TransitionRun"),transitionstart:gt("Transition","TransitionStart"),transitioncancel:gt("Transition","TransitionCancel"),transitionend:gt("Transition","TransitionEnd")},ft={},yt={};Yi&&(yt=document.createElement("div").style,"AnimationEvent"in window||(delete rt.animationend.animation,delete rt.animationiteration.animation,delete rt.animationstart.animation),"TransitionEvent"in window||delete rt.transitionend.transition);function ot(p){if(ft[p])return ft[p];if(!rt[p])return p;var g=rt[p],_;for(_ in g)if(g.hasOwnProperty(_)&&_ in yt)return ft[p]=g[_];return p}var kt=ot("animationend"),Nt=ot("animationiteration"),Mt=ot("animationstart"),Pt=ot("transitionrun"),Xt=ot("transitionstart"),rn=ot("transitioncancel"),Gt=ot("transitionend"),en=new Map,an="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");an.push("scrollEnd");function Kt(p,g){en.set(p,g),Vt(g,[p])}var mn=new WeakMap;function $n(p,g){if(typeof p=="object"&&p!==null){var _=mn.get(p);return _!==void 0?_:(g={value:p,source:g,stack:Ab(g)},mn.set(p,g),g)}return{value:p,source:g,stack:Ab(g)}}var Vn=[],hr=0,pa=0;function ir(){for(var p=hr,g=pa=hr=0;g<p;){var _=Vn[g];Vn[g++]=null;var A=Vn[g];Vn[g++]=null;var j=Vn[g];Vn[g++]=null;var q=Vn[g];if(Vn[g++]=null,A!==null&&j!==null){var he=A.pending;he===null?j.next=j:(j.next=he.next,he.next=j),A.pending=j}q!==0&&Xi(_,j,q)}}function fi(p,g,_,A){Vn[hr++]=p,Vn[hr++]=g,Vn[hr++]=_,Vn[hr++]=A,pa|=A,p.lanes|=A,p=p.alternate,p!==null&&(p.lanes|=A)}function Ci(p,g,_,A){return fi(p,g,_,A),kl(p)}function cc(p,g){return fi(p,null,null,g),kl(p)}function Xi(p,g,_){p.lanes|=_;var A=p.alternate;A!==null&&(A.lanes|=_);for(var j=!1,q=p.return;q!==null;)q.childLanes|=_,A=q.alternate,A!==null&&(A.childLanes|=_),q.tag===22&&(p=q.stateNode,p===null||p._visibility&1||(j=!0)),p=q,q=q.return;return p.tag===3?(q=p.stateNode,j&&g!==null&&(j=31-Ht(_),p=q.hiddenUpdates,A=p[j],A===null?p[j]=[g]:A.push(g),g.lane=_|536870912),q):null}function kl(p){if(50<bv)throw bv=0,PR=null,Error(r(185));for(var g=p.return;g!==null;)p=g,g=p.return;return p.tag===3?p.stateNode:null}var Xc={};function qde(p,g,_,A){this.tag=p,this.key=_,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=g,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=A,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Yo(p,g,_,A){return new qde(p,g,_,A)}function NA(p){return p=p.prototype,!(!p||!p.isReactComponent)}function sd(p,g){var _=p.alternate;return _===null?(_=Yo(p.tag,g,p.key,p.mode),_.elementType=p.elementType,_.type=p.type,_.stateNode=p.stateNode,_.alternate=p,p.alternate=_):(_.pendingProps=g,_.type=p.type,_.flags=0,_.subtreeFlags=0,_.deletions=null),_.flags=p.flags&65011712,_.childLanes=p.childLanes,_.lanes=p.lanes,_.child=p.child,_.memoizedProps=p.memoizedProps,_.memoizedState=p.memoizedState,_.updateQueue=p.updateQueue,g=p.dependencies,_.dependencies=g===null?null:{lanes:g.lanes,firstContext:g.firstContext},_.sibling=p.sibling,_.index=p.index,_.ref=p.ref,_.refCleanup=p.refCleanup,_}function p5(p,g){p.flags&=65011714;var _=p.alternate;return _===null?(p.childLanes=0,p.lanes=g,p.child=null,p.subtreeFlags=0,p.memoizedProps=null,p.memoizedState=null,p.updateQueue=null,p.dependencies=null,p.stateNode=null):(p.childLanes=_.childLanes,p.lanes=_.lanes,p.child=_.child,p.subtreeFlags=0,p.deletions=null,p.memoizedProps=_.memoizedProps,p.memoizedState=_.memoizedState,p.updateQueue=_.updateQueue,p.type=_.type,g=_.dependencies,p.dependencies=g===null?null:{lanes:g.lanes,firstContext:g.firstContext}),p}function I_(p,g,_,A,j,q){var he=0;if(A=p,typeof p=="function")NA(p)&&(he=1);else if(typeof p=="string")he=Wfe(p,_,pe.current)?26:p==="html"||p==="head"||p==="body"?27:5;else e:switch(p){case I:return p=Yo(31,_,g,j),p.elementType=I,p.lanes=q,p;case y:return wp(_.children,j,q,g);case b:he=8,j|=24;break;case v:return p=Yo(12,_,g,j|2),p.elementType=v,p.lanes=q,p;case C:return p=Yo(13,_,g,j),p.elementType=C,p.lanes=q,p;case T:return p=Yo(19,_,g,j),p.elementType=T,p.lanes=q,p;default:if(typeof p=="object"&&p!==null)switch(p.$$typeof){case x:case S:he=10;break e;case w:he=9;break e;case k:he=11;break e;case R:he=14;break e;case N:he=16,A=null;break e}he=29,_=Error(r(130,p===null?"null":typeof p,"")),A=null}return g=Yo(he,_,g,j),g.elementType=p,g.type=A,g.lanes=q,g}function wp(p,g,_,A){return p=Yo(7,p,A,g),p.lanes=_,p}function MA(p,g,_){return p=Yo(6,p,null,g),p.lanes=_,p}function IA(p,g,_){return g=Yo(4,p.children!==null?p.children:[],p.key,g),g.lanes=_,g.stateNode={containerInfo:p.containerInfo,pendingChildren:null,implementation:p.implementation},g}var Ag=[],Rg=0,j_=null,O_=0,El=[],Tl=0,_p=null,id=1,ad="";function Sp(p,g){Ag[Rg++]=O_,Ag[Rg++]=j_,j_=p,O_=g}function m5(p,g,_){El[Tl++]=id,El[Tl++]=ad,El[Tl++]=_p,_p=p;var A=id;p=ad;var j=32-Ht(A)-1;A&=~(1<<j),_+=1;var q=32-Ht(g)+j;if(30<q){var he=j-j%5;q=(A&(1<<he)-1).toString(32),A>>=he,j-=he,id=1<<32-Ht(g)+j|_<<j|A,ad=q+p}else id=1<<q|_<<j|A,ad=p}function jA(p){p.return!==null&&(Sp(p,1),m5(p,1,0))}function OA(p){for(;p===j_;)j_=Ag[--Rg],Ag[Rg]=null,O_=Ag[--Rg],Ag[Rg]=null;for(;p===_p;)_p=El[--Tl],El[Tl]=null,ad=El[--Tl],El[Tl]=null,id=El[--Tl],El[Tl]=null}var Ya=null,ai=null,ss=!1,Cp=null,Jc=!1,PA=Error(r(519));function kp(p){var g=Error(r(418,""));throw Zb($n(g,p)),PA}function g5(p){var g=p.stateNode,_=p.type,A=p.memoizedProps;switch(g[xe]=p,g[De]=A,_){case"dialog":Lr("cancel",g),Lr("close",g);break;case"iframe":case"object":case"embed":Lr("load",g);break;case"video":case"audio":for(_=0;_<xv.length;_++)Lr(xv[_],g);break;case"source":Lr("error",g);break;case"img":case"image":case"link":Lr("error",g),Lr("load",g);break;case"details":Lr("toggle",g);break;case"input":Lr("invalid",g),Mb(g,A.value,A.defaultValue,A.checked,A.defaultChecked,A.type,A.name,!0),Gc(g);break;case"select":Lr("invalid",g);break;case"textarea":Lr("invalid",g),Ib(g,A.value,A.defaultValue,A.children),Gc(g)}_=A.children,typeof _!="string"&&typeof _!="number"&&typeof _!="bigint"||g.textContent===""+_||A.suppressHydrationWarning===!0||jL(g.textContent,_)?(A.popover!=null&&(Lr("beforetoggle",g),Lr("toggle",g)),A.onScroll!=null&&Lr("scroll",g),A.onScrollEnd!=null&&Lr("scrollend",g),A.onClick!=null&&(g.onclick=pS),g=!0):g=!1,g||kp(p)}function y5(p){for(Ya=p.return;Ya;)switch(Ya.tag){case 5:case 13:Jc=!1;return;case 27:case 3:Jc=!0;return;default:Ya=Ya.return}}function Kb(p){if(p!==Ya)return!1;if(!ss)return y5(p),ss=!0,!1;var g=p.tag,_;if((_=g!==3&&g!==27)&&((_=g===5)&&(_=p.type,_=!(_!=="form"&&_!=="button")||XR(p.type,p.memoizedProps)),_=!_),_&&ai&&kp(p),y5(p),g===13){if(p=p.memoizedState,p=p!==null?p.dehydrated:null,!p)throw Error(r(317));e:{for(p=p.nextSibling,g=0;p;){if(p.nodeType===8)if(_=p.data,_==="/$"){if(g===0){ai=dc(p.nextSibling);break e}g--}else _!=="$"&&_!=="$!"&&_!=="$?"||g++;p=p.nextSibling}ai=null}}else g===27?(g=ai,Vf(p.type)?(p=tN,tN=null,ai=p):ai=g):ai=Ya?dc(p.stateNode.nextSibling):null;return!0}function Yb(){ai=Ya=null,ss=!1}function b5(){var p=Cp;return p!==null&&(bo===null?bo=p:bo.push.apply(bo,p),Cp=null),p}function Zb(p){Cp===null?Cp=[p]:Cp.push(p)}var DA=Q(null),Ep=null,od=null;function Rf(p,g,_){se(DA,g._currentValue),g._currentValue=_}function ld(p){p._currentValue=DA.current,ee(DA)}function FA(p,g,_){for(;p!==null;){var A=p.alternate;if((p.childLanes&g)!==g?(p.childLanes|=g,A!==null&&(A.childLanes|=g)):A!==null&&(A.childLanes&g)!==g&&(A.childLanes|=g),p===_)break;p=p.return}}function LA(p,g,_,A){var j=p.child;for(j!==null&&(j.return=p);j!==null;){var q=j.dependencies;if(q!==null){var he=j.child;q=q.firstContext;e:for(;q!==null;){var je=q;q=j;for(var Ye=0;Ye<g.length;Ye++)if(je.context===g[Ye]){q.lanes|=_,je=q.alternate,je!==null&&(je.lanes|=_),FA(q.return,_,p),A||(he=null);break e}q=je.next}}else if(j.tag===18){if(he=j.return,he===null)throw Error(r(341));he.lanes|=_,q=he.alternate,q!==null&&(q.lanes|=_),FA(he,_,p),he=null}else he=j.child;if(he!==null)he.return=j;else for(he=j;he!==null;){if(he===p){he=null;break}if(j=he.sibling,j!==null){j.return=he.return,he=j;break}he=he.return}j=he}}function Xb(p,g,_,A){p=null;for(var j=g,q=!1;j!==null;){if(!q){if((j.flags&524288)!==0)q=!0;else if((j.flags&262144)!==0)break}if(j.tag===10){var he=j.alternate;if(he===null)throw Error(r(387));if(he=he.memoizedProps,he!==null){var je=j.type;Aa(j.pendingProps.value,he.value)||(p!==null?p.push(je):p=[je])}}else if(j===Fe.current){if(he=j.alternate,he===null)throw Error(r(387));he.memoizedState.memoizedState!==j.memoizedState.memoizedState&&(p!==null?p.push(Ev):p=[Ev])}j=j.return}p!==null&&LA(g,p,_,A),g.flags|=262144}function P_(p){for(p=p.firstContext;p!==null;){if(!Aa(p.context._currentValue,p.memoizedValue))return!0;p=p.next}return!1}function Tp(p){Ep=p,od=null,p=p.dependencies,p!==null&&(p.firstContext=null)}function Ra(p){return v5(Ep,p)}function D_(p,g){return Ep===null&&Tp(p),v5(p,g)}function v5(p,g){var _=g._currentValue;if(g={context:g,memoizedValue:_,next:null},od===null){if(p===null)throw Error(r(308));od=g,p.dependencies={lanes:0,firstContext:g},p.flags|=524288}else od=od.next=g;return _}var Vde=typeof AbortController<"u"?AbortController:function(){var p=[],g=this.signal={aborted:!1,addEventListener:function(_,A){p.push(A)}};this.abort=function(){g.aborted=!0,p.forEach(function(_){return _()})}},Wde=e.unstable_scheduleCallback,Hde=e.unstable_NormalPriority,Fi={$$typeof:S,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function BA(){return{controller:new Vde,data:new Map,refCount:0}}function Jb(p){p.refCount--,p.refCount===0&&Wde(Hde,function(){p.controller.abort()})}var Qb=null,$A=0,Ng=0,Mg=null;function Gde(p,g){if(Qb===null){var _=Qb=[];$A=0,Ng=UR(),Mg={status:"pending",value:void 0,then:function(A){_.push(A)}}}return $A++,g.then(x5,x5),g}function x5(){if(--$A===0&&Qb!==null){Mg!==null&&(Mg.status="fulfilled");var p=Qb;Qb=null,Ng=0,Mg=null;for(var g=0;g<p.length;g++)(0,p[g])()}}function Kde(p,g){var _=[],A={status:"pending",value:null,reason:null,then:function(j){_.push(j)}};return p.then(function(){A.status="fulfilled",A.value=g;for(var j=0;j<_.length;j++)(0,_[j])(g)},function(j){for(A.status="rejected",A.reason=j,j=0;j<_.length;j++)(0,_[j])(void 0)}),A}var w5=U.S;U.S=function(p,g){typeof g=="object"&&g!==null&&typeof g.then=="function"&&Gde(p,g),w5!==null&&w5(p,g)};var Ap=Q(null);function zA(){var p=Ap.current;return p!==null?p:Ps.pooledCache}function F_(p,g){g===null?se(Ap,Ap.current):se(Ap,g.pool)}function _5(){var p=zA();return p===null?null:{parent:Fi._currentValue,pool:p}}var ev=Error(r(460)),S5=Error(r(474)),L_=Error(r(542)),UA={then:function(){}};function C5(p){return p=p.status,p==="fulfilled"||p==="rejected"}function B_(){}function k5(p,g,_){switch(_=p[_],_===void 0?p.push(g):_!==g&&(g.then(B_,B_),g=_),g.status){case"fulfilled":return g.value;case"rejected":throw p=g.reason,T5(p),p;default:if(typeof g.status=="string")g.then(B_,B_);else{if(p=Ps,p!==null&&100<p.shellSuspendCounter)throw Error(r(482));p=g,p.status="pending",p.then(function(A){if(g.status==="pending"){var j=g;j.status="fulfilled",j.value=A}},function(A){if(g.status==="pending"){var j=g;j.status="rejected",j.reason=A}})}switch(g.status){case"fulfilled":return g.value;case"rejected":throw p=g.reason,T5(p),p}throw tv=g,ev}}var tv=null;function E5(){if(tv===null)throw Error(r(459));var p=tv;return tv=null,p}function T5(p){if(p===ev||p===L_)throw Error(r(483))}var Nf=!1;function qA(p){p.updateQueue={baseState:p.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function VA(p,g){p=p.updateQueue,g.updateQueue===p&&(g.updateQueue={baseState:p.baseState,firstBaseUpdate:p.firstBaseUpdate,lastBaseUpdate:p.lastBaseUpdate,shared:p.shared,callbacks:null})}function Mf(p){return{lane:p,tag:0,payload:null,callback:null,next:null}}function If(p,g,_){var A=p.updateQueue;if(A===null)return null;if(A=A.shared,(ys&2)!==0){var j=A.pending;return j===null?g.next=g:(g.next=j.next,j.next=g),A.pending=g,g=kl(p),Xi(p,null,_),g}return fi(p,A,g,_),kl(p)}function nv(p,g,_){if(g=g.updateQueue,g!==null&&(g=g.shared,(_&4194048)!==0)){var A=g.lanes;A&=p.pendingLanes,_|=A,g.lanes=_,$e(p,_)}}function WA(p,g){var _=p.updateQueue,A=p.alternate;if(A!==null&&(A=A.updateQueue,_===A)){var j=null,q=null;if(_=_.firstBaseUpdate,_!==null){do{var he={lane:_.lane,tag:_.tag,payload:_.payload,callback:null,next:null};q===null?j=q=he:q=q.next=he,_=_.next}while(_!==null);q===null?j=q=g:q=q.next=g}else j=q=g;_={baseState:A.baseState,firstBaseUpdate:j,lastBaseUpdate:q,shared:A.shared,callbacks:A.callbacks},p.updateQueue=_;return}p=_.lastBaseUpdate,p===null?_.firstBaseUpdate=g:p.next=g,_.lastBaseUpdate=g}var HA=!1;function rv(){if(HA){var p=Mg;if(p!==null)throw p}}function sv(p,g,_,A){HA=!1;var j=p.updateQueue;Nf=!1;var q=j.firstBaseUpdate,he=j.lastBaseUpdate,je=j.shared.pending;if(je!==null){j.shared.pending=null;var Ye=je,St=Ye.next;Ye.next=null,he===null?q=St:he.next=St,he=Ye;var Dt=p.alternate;Dt!==null&&(Dt=Dt.updateQueue,je=Dt.lastBaseUpdate,je!==he&&(je===null?Dt.firstBaseUpdate=St:je.next=St,Dt.lastBaseUpdate=Ye))}if(q!==null){var Bt=j.baseState;he=0,Dt=St=Ye=null,je=q;do{var Et=je.lane&-536870913,Rt=Et!==je.lane;if(Rt?(Gr&Et)===Et:(A&Et)===Et){Et!==0&&Et===Ng&&(HA=!0),Dt!==null&&(Dt=Dt.next={lane:0,tag:je.tag,payload:je.payload,callback:null,next:null});e:{var ar=p,Wn=je;Et=g;var Cs=_;switch(Wn.tag){case 1:if(ar=Wn.payload,typeof ar=="function"){Bt=ar.call(Cs,Bt,Et);break e}Bt=ar;break e;case 3:ar.flags=ar.flags&-65537|128;case 0:if(ar=Wn.payload,Et=typeof ar=="function"?ar.call(Cs,Bt,Et):ar,Et==null)break e;Bt=u({},Bt,Et);break e;case 2:Nf=!0}}Et=je.callback,Et!==null&&(p.flags|=64,Rt&&(p.flags|=8192),Rt=j.callbacks,Rt===null?j.callbacks=[Et]:Rt.push(Et))}else Rt={lane:Et,tag:je.tag,payload:je.payload,callback:je.callback,next:null},Dt===null?(St=Dt=Rt,Ye=Bt):Dt=Dt.next=Rt,he|=Et;if(je=je.next,je===null){if(je=j.shared.pending,je===null)break;Rt=je,je=Rt.next,Rt.next=null,j.lastBaseUpdate=Rt,j.shared.pending=null}}while(!0);Dt===null&&(Ye=Bt),j.baseState=Ye,j.firstBaseUpdate=St,j.lastBaseUpdate=Dt,q===null&&(j.shared.lanes=0),$f|=he,p.lanes=he,p.memoizedState=Bt}}function A5(p,g){if(typeof p!="function")throw Error(r(191,p));p.call(g)}function R5(p,g){var _=p.callbacks;if(_!==null)for(p.callbacks=null,p=0;p<_.length;p++)A5(_[p],g)}var Ig=Q(null),$_=Q(0);function N5(p,g){p=md,se($_,p),se(Ig,g),md=p|g.baseLanes}function GA(){se($_,md),se(Ig,Ig.current)}function KA(){md=$_.current,ee(Ig),ee($_)}var jf=0,Ir=null,_s=null,ki=null,z_=!1,jg=!1,Rp=!1,U_=0,iv=0,Og=null,Yde=0;function hi(){throw Error(r(321))}function YA(p,g){if(g===null)return!1;for(var _=0;_<g.length&&_<p.length;_++)if(!Aa(p[_],g[_]))return!1;return!0}function ZA(p,g,_,A,j,q){return jf=q,Ir=g,g.memoizedState=null,g.updateQueue=null,g.lanes=0,U.H=p===null||p.memoizedState===null?h8:p8,Rp=!1,q=_(A,j),Rp=!1,jg&&(q=I5(g,_,A,j)),M5(p),q}function M5(p){U.H=K_;var g=_s!==null&&_s.next!==null;if(jf=0,ki=_s=Ir=null,z_=!1,iv=0,Og=null,g)throw Error(r(300));p===null||Ji||(p=p.dependencies,p!==null&&P_(p)&&(Ji=!0))}function I5(p,g,_,A){Ir=p;var j=0;do{if(jg&&(Og=null),iv=0,jg=!1,25<=j)throw Error(r(301));if(j+=1,ki=_s=null,p.updateQueue!=null){var q=p.updateQueue;q.lastEffect=null,q.events=null,q.stores=null,q.memoCache!=null&&(q.memoCache.index=0)}U.H=nfe,q=g(_,A)}while(jg);return q}function Zde(){var p=U.H,g=p.useState()[0];return g=typeof g.then=="function"?av(g):g,p=p.useState()[0],(_s!==null?_s.memoizedState:null)!==p&&(Ir.flags|=1024),g}function XA(){var p=U_!==0;return U_=0,p}function JA(p,g,_){g.updateQueue=p.updateQueue,g.flags&=-2053,p.lanes&=~_}function QA(p){if(z_){for(p=p.memoizedState;p!==null;){var g=p.queue;g!==null&&(g.pending=null),p=p.next}z_=!1}jf=0,ki=_s=Ir=null,jg=!1,iv=U_=0,Og=null}function go(){var p={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ki===null?Ir.memoizedState=ki=p:ki=ki.next=p,ki}function Ei(){if(_s===null){var p=Ir.alternate;p=p!==null?p.memoizedState:null}else p=_s.next;var g=ki===null?Ir.memoizedState:ki.next;if(g!==null)ki=g,_s=p;else{if(p===null)throw Ir.alternate===null?Error(r(467)):Error(r(310));_s=p,p={memoizedState:_s.memoizedState,baseState:_s.baseState,baseQueue:_s.baseQueue,queue:_s.queue,next:null},ki===null?Ir.memoizedState=ki=p:ki=ki.next=p}return ki}function eR(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function av(p){var g=iv;return iv+=1,Og===null&&(Og=[]),p=k5(Og,p,g),g=Ir,(ki===null?g.memoizedState:ki.next)===null&&(g=g.alternate,U.H=g===null||g.memoizedState===null?h8:p8),p}function q_(p){if(p!==null&&typeof p=="object"){if(typeof p.then=="function")return av(p);if(p.$$typeof===S)return Ra(p)}throw Error(r(438,String(p)))}function tR(p){var g=null,_=Ir.updateQueue;if(_!==null&&(g=_.memoCache),g==null){var A=Ir.alternate;A!==null&&(A=A.updateQueue,A!==null&&(A=A.memoCache,A!=null&&(g={data:A.data.map(function(j){return j.slice()}),index:0})))}if(g==null&&(g={data:[],index:0}),_===null&&(_=eR(),Ir.updateQueue=_),_.memoCache=g,_=g.data[g.index],_===void 0)for(_=g.data[g.index]=Array(p),A=0;A<p;A++)_[A]=P;return g.index++,_}function cd(p,g){return typeof g=="function"?g(p):g}function V_(p){var g=Ei();return nR(g,_s,p)}function nR(p,g,_){var A=p.queue;if(A===null)throw Error(r(311));A.lastRenderedReducer=_;var j=p.baseQueue,q=A.pending;if(q!==null){if(j!==null){var he=j.next;j.next=q.next,q.next=he}g.baseQueue=j=q,A.pending=null}if(q=p.baseState,j===null)p.memoizedState=q;else{g=j.next;var je=he=null,Ye=null,St=g,Dt=!1;do{var Bt=St.lane&-536870913;if(Bt!==St.lane?(Gr&Bt)===Bt:(jf&Bt)===Bt){var Et=St.revertLane;if(Et===0)Ye!==null&&(Ye=Ye.next={lane:0,revertLane:0,action:St.action,hasEagerState:St.hasEagerState,eagerState:St.eagerState,next:null}),Bt===Ng&&(Dt=!0);else if((jf&Et)===Et){St=St.next,Et===Ng&&(Dt=!0);continue}else Bt={lane:0,revertLane:St.revertLane,action:St.action,hasEagerState:St.hasEagerState,eagerState:St.eagerState,next:null},Ye===null?(je=Ye=Bt,he=q):Ye=Ye.next=Bt,Ir.lanes|=Et,$f|=Et;Bt=St.action,Rp&&_(q,Bt),q=St.hasEagerState?St.eagerState:_(q,Bt)}else Et={lane:Bt,revertLane:St.revertLane,action:St.action,hasEagerState:St.hasEagerState,eagerState:St.eagerState,next:null},Ye===null?(je=Ye=Et,he=q):Ye=Ye.next=Et,Ir.lanes|=Bt,$f|=Bt;St=St.next}while(St!==null&&St!==g);if(Ye===null?he=q:Ye.next=je,!Aa(q,p.memoizedState)&&(Ji=!0,Dt&&(_=Mg,_!==null)))throw _;p.memoizedState=q,p.baseState=he,p.baseQueue=Ye,A.lastRenderedState=q}return j===null&&(A.lanes=0),[p.memoizedState,A.dispatch]}function rR(p){var g=Ei(),_=g.queue;if(_===null)throw Error(r(311));_.lastRenderedReducer=p;var A=_.dispatch,j=_.pending,q=g.memoizedState;if(j!==null){_.pending=null;var he=j=j.next;do q=p(q,he.action),he=he.next;while(he!==j);Aa(q,g.memoizedState)||(Ji=!0),g.memoizedState=q,g.baseQueue===null&&(g.baseState=q),_.lastRenderedState=q}return[q,A]}function j5(p,g,_){var A=Ir,j=Ei(),q=ss;if(q){if(_===void 0)throw Error(r(407));_=_()}else _=g();var he=!Aa((_s||j).memoizedState,_);he&&(j.memoizedState=_,Ji=!0),j=j.queue;var je=D5.bind(null,A,j,p);if(ov(2048,8,je,[p]),j.getSnapshot!==g||he||ki!==null&&ki.memoizedState.tag&1){if(A.flags|=2048,Pg(9,W_(),P5.bind(null,A,j,_,g),null),Ps===null)throw Error(r(349));q||(jf&124)!==0||O5(A,g,_)}return _}function O5(p,g,_){p.flags|=16384,p={getSnapshot:g,value:_},g=Ir.updateQueue,g===null?(g=eR(),Ir.updateQueue=g,g.stores=[p]):(_=g.stores,_===null?g.stores=[p]:_.push(p))}function P5(p,g,_,A){g.value=_,g.getSnapshot=A,F5(g)&&L5(p)}function D5(p,g,_){return _(function(){F5(g)&&L5(p)})}function F5(p){var g=p.getSnapshot;p=p.value;try{var _=g();return!Aa(p,_)}catch{return!0}}function L5(p){var g=cc(p,2);g!==null&&el(g,p,2)}function sR(p){var g=go();if(typeof p=="function"){var _=p;if(p=_(),Rp){Ft(!0);try{_()}finally{Ft(!1)}}}return g.memoizedState=g.baseState=p,g.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:cd,lastRenderedState:p},g}function B5(p,g,_,A){return p.baseState=_,nR(p,_s,typeof A=="function"?A:cd)}function Xde(p,g,_,A,j){if(G_(p))throw Error(r(485));if(p=g.action,p!==null){var q={payload:j,action:p,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(he){q.listeners.push(he)}};U.T!==null?_(!0):q.isTransition=!1,A(q),_=g.pending,_===null?(q.next=g.pending=q,$5(g,q)):(q.next=_.next,g.pending=_.next=q)}}function $5(p,g){var _=g.action,A=g.payload,j=p.state;if(g.isTransition){var q=U.T,he={};U.T=he;try{var je=_(j,A),Ye=U.S;Ye!==null&&Ye(he,je),z5(p,g,je)}catch(St){iR(p,g,St)}finally{U.T=q}}else try{q=_(j,A),z5(p,g,q)}catch(St){iR(p,g,St)}}function z5(p,g,_){_!==null&&typeof _=="object"&&typeof _.then=="function"?_.then(function(A){U5(p,g,A)},function(A){return iR(p,g,A)}):U5(p,g,_)}function U5(p,g,_){g.status="fulfilled",g.value=_,q5(g),p.state=_,g=p.pending,g!==null&&(_=g.next,_===g?p.pending=null:(_=_.next,g.next=_,$5(p,_)))}function iR(p,g,_){var A=p.pending;if(p.pending=null,A!==null){A=A.next;do g.status="rejected",g.reason=_,q5(g),g=g.next;while(g!==A)}p.action=null}function q5(p){p=p.listeners;for(var g=0;g<p.length;g++)(0,p[g])()}function V5(p,g){return g}function W5(p,g){if(ss){var _=Ps.formState;if(_!==null){e:{var A=Ir;if(ss){if(ai){t:{for(var j=ai,q=Jc;j.nodeType!==8;){if(!q){j=null;break t}if(j=dc(j.nextSibling),j===null){j=null;break t}}q=j.data,j=q==="F!"||q==="F"?j:null}if(j){ai=dc(j.nextSibling),A=j.data==="F!";break e}}kp(A)}A=!1}A&&(g=_[0])}}return _=go(),_.memoizedState=_.baseState=g,A={pending:null,lanes:0,dispatch:null,lastRenderedReducer:V5,lastRenderedState:g},_.queue=A,_=u8.bind(null,Ir,A),A.dispatch=_,A=sR(!1),q=uR.bind(null,Ir,!1,A.queue),A=go(),j={state:g,dispatch:null,action:p,pending:null},A.queue=j,_=Xde.bind(null,Ir,j,q,_),j.dispatch=_,A.memoizedState=p,[g,_,!1]}function H5(p){var g=Ei();return G5(g,_s,p)}function G5(p,g,_){if(g=nR(p,g,V5)[0],p=V_(cd)[0],typeof g=="object"&&g!==null&&typeof g.then=="function")try{var A=av(g)}catch(he){throw he===ev?L_:he}else A=g;g=Ei();var j=g.queue,q=j.dispatch;return _!==g.memoizedState&&(Ir.flags|=2048,Pg(9,W_(),Jde.bind(null,j,_),null)),[A,q,p]}function Jde(p,g){p.action=g}function K5(p){var g=Ei(),_=_s;if(_!==null)return G5(g,_,p);Ei(),g=g.memoizedState,_=Ei();var A=_.queue.dispatch;return _.memoizedState=p,[g,A,!1]}function Pg(p,g,_,A){return p={tag:p,create:_,deps:A,inst:g,next:null},g=Ir.updateQueue,g===null&&(g=eR(),Ir.updateQueue=g),_=g.lastEffect,_===null?g.lastEffect=p.next=p:(A=_.next,_.next=p,p.next=A,g.lastEffect=p),p}function W_(){return{destroy:void 0,resource:void 0}}function Y5(){return Ei().memoizedState}function H_(p,g,_,A){var j=go();A=A===void 0?null:A,Ir.flags|=p,j.memoizedState=Pg(1|g,W_(),_,A)}function ov(p,g,_,A){var j=Ei();A=A===void 0?null:A;var q=j.memoizedState.inst;_s!==null&&A!==null&&YA(A,_s.memoizedState.deps)?j.memoizedState=Pg(g,q,_,A):(Ir.flags|=p,j.memoizedState=Pg(1|g,q,_,A))}function Z5(p,g){H_(8390656,8,p,g)}function X5(p,g){ov(2048,8,p,g)}function J5(p,g){return ov(4,2,p,g)}function Q5(p,g){return ov(4,4,p,g)}function e8(p,g){if(typeof g=="function"){p=p();var _=g(p);return function(){typeof _=="function"?_():g(null)}}if(g!=null)return p=p(),g.current=p,function(){g.current=null}}function t8(p,g,_){_=_!=null?_.concat([p]):null,ov(4,4,e8.bind(null,g,p),_)}function aR(){}function n8(p,g){var _=Ei();g=g===void 0?null:g;var A=_.memoizedState;return g!==null&&YA(g,A[1])?A[0]:(_.memoizedState=[p,g],p)}function r8(p,g){var _=Ei();g=g===void 0?null:g;var A=_.memoizedState;if(g!==null&&YA(g,A[1]))return A[0];if(A=p(),Rp){Ft(!0);try{p()}finally{Ft(!1)}}return _.memoizedState=[A,g],A}function oR(p,g,_){return _===void 0||(jf&1073741824)!==0?p.memoizedState=g:(p.memoizedState=_,p=aL(),Ir.lanes|=p,$f|=p,_)}function s8(p,g,_,A){return Aa(_,g)?_:Ig.current!==null?(p=oR(p,_,A),Aa(p,g)||(Ji=!0),p):(jf&42)===0?(Ji=!0,p.memoizedState=_):(p=aL(),Ir.lanes|=p,$f|=p,g)}function i8(p,g,_,A,j){var q=H.p;H.p=q!==0&&8>q?q:8;var he=U.T,je={};U.T=je,uR(p,!1,g,_);try{var Ye=j(),St=U.S;if(St!==null&&St(je,Ye),Ye!==null&&typeof Ye=="object"&&typeof Ye.then=="function"){var Dt=Kde(Ye,A);lv(p,g,Dt,Qo(p))}else lv(p,g,A,Qo(p))}catch(Bt){lv(p,g,{then:function(){},status:"rejected",reason:Bt},Qo())}finally{H.p=q,U.T=he}}function Qde(){}function lR(p,g,_,A){if(p.tag!==5)throw Error(r(476));var j=a8(p).queue;i8(p,j,g,L,_===null?Qde:function(){return o8(p),_(A)})}function a8(p){var g=p.memoizedState;if(g!==null)return g;g={memoizedState:L,baseState:L,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:cd,lastRenderedState:L},next:null};var _={};return g.next={memoizedState:_,baseState:_,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:cd,lastRenderedState:_},next:null},p.memoizedState=g,p=p.alternate,p!==null&&(p.memoizedState=g),g}function o8(p){var g=a8(p).next.queue;lv(p,g,{},Qo())}function cR(){return Ra(Ev)}function l8(){return Ei().memoizedState}function c8(){return Ei().memoizedState}function efe(p){for(var g=p.return;g!==null;){switch(g.tag){case 24:case 3:var _=Qo();p=Mf(_);var A=If(g,p,_);A!==null&&(el(A,g,_),nv(A,g,_)),g={cache:BA()},p.payload=g;return}g=g.return}}function tfe(p,g,_){var A=Qo();_={lane:A,revertLane:0,action:_,hasEagerState:!1,eagerState:null,next:null},G_(p)?d8(g,_):(_=Ci(p,g,_,A),_!==null&&(el(_,p,A),f8(_,g,A)))}function u8(p,g,_){var A=Qo();lv(p,g,_,A)}function lv(p,g,_,A){var j={lane:A,revertLane:0,action:_,hasEagerState:!1,eagerState:null,next:null};if(G_(p))d8(g,j);else{var q=p.alternate;if(p.lanes===0&&(q===null||q.lanes===0)&&(q=g.lastRenderedReducer,q!==null))try{var he=g.lastRenderedState,je=q(he,_);if(j.hasEagerState=!0,j.eagerState=je,Aa(je,he))return fi(p,g,j,0),Ps===null&&ir(),!1}catch{}finally{}if(_=Ci(p,g,j,A),_!==null)return el(_,p,A),f8(_,g,A),!0}return!1}function uR(p,g,_,A){if(A={lane:2,revertLane:UR(),action:A,hasEagerState:!1,eagerState:null,next:null},G_(p)){if(g)throw Error(r(479))}else g=Ci(p,_,A,2),g!==null&&el(g,p,2)}function G_(p){var g=p.alternate;return p===Ir||g!==null&&g===Ir}function d8(p,g){jg=z_=!0;var _=p.pending;_===null?g.next=g:(g.next=_.next,_.next=g),p.pending=g}function f8(p,g,_){if((_&4194048)!==0){var A=g.lanes;A&=p.pendingLanes,_|=A,g.lanes=_,$e(p,_)}}var K_={readContext:Ra,use:q_,useCallback:hi,useContext:hi,useEffect:hi,useImperativeHandle:hi,useLayoutEffect:hi,useInsertionEffect:hi,useMemo:hi,useReducer:hi,useRef:hi,useState:hi,useDebugValue:hi,useDeferredValue:hi,useTransition:hi,useSyncExternalStore:hi,useId:hi,useHostTransitionStatus:hi,useFormState:hi,useActionState:hi,useOptimistic:hi,useMemoCache:hi,useCacheRefresh:hi},h8={readContext:Ra,use:q_,useCallback:function(p,g){return go().memoizedState=[p,g===void 0?null:g],p},useContext:Ra,useEffect:Z5,useImperativeHandle:function(p,g,_){_=_!=null?_.concat([p]):null,H_(4194308,4,e8.bind(null,g,p),_)},useLayoutEffect:function(p,g){return H_(4194308,4,p,g)},useInsertionEffect:function(p,g){H_(4,2,p,g)},useMemo:function(p,g){var _=go();g=g===void 0?null:g;var A=p();if(Rp){Ft(!0);try{p()}finally{Ft(!1)}}return _.memoizedState=[A,g],A},useReducer:function(p,g,_){var A=go();if(_!==void 0){var j=_(g);if(Rp){Ft(!0);try{_(g)}finally{Ft(!1)}}}else j=g;return A.memoizedState=A.baseState=j,p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:p,lastRenderedState:j},A.queue=p,p=p.dispatch=tfe.bind(null,Ir,p),[A.memoizedState,p]},useRef:function(p){var g=go();return p={current:p},g.memoizedState=p},useState:function(p){p=sR(p);var g=p.queue,_=u8.bind(null,Ir,g);return g.dispatch=_,[p.memoizedState,_]},useDebugValue:aR,useDeferredValue:function(p,g){var _=go();return oR(_,p,g)},useTransition:function(){var p=sR(!1);return p=i8.bind(null,Ir,p.queue,!0,!1),go().memoizedState=p,[!1,p]},useSyncExternalStore:function(p,g,_){var A=Ir,j=go();if(ss){if(_===void 0)throw Error(r(407));_=_()}else{if(_=g(),Ps===null)throw Error(r(349));(Gr&124)!==0||O5(A,g,_)}j.memoizedState=_;var q={value:_,getSnapshot:g};return j.queue=q,Z5(D5.bind(null,A,q,p),[p]),A.flags|=2048,Pg(9,W_(),P5.bind(null,A,q,_,g),null),_},useId:function(){var p=go(),g=Ps.identifierPrefix;if(ss){var _=ad,A=id;_=(A&~(1<<32-Ht(A)-1)).toString(32)+_,g=""+g+"R"+_,_=U_++,0<_&&(g+="H"+_.toString(32)),g+=""}else _=Yde++,g=""+g+"r"+_.toString(32)+"";return p.memoizedState=g},useHostTransitionStatus:cR,useFormState:W5,useActionState:W5,useOptimistic:function(p){var g=go();g.memoizedState=g.baseState=p;var _={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return g.queue=_,g=uR.bind(null,Ir,!0,_),_.dispatch=g,[p,g]},useMemoCache:tR,useCacheRefresh:function(){return go().memoizedState=efe.bind(null,Ir)}},p8={readContext:Ra,use:q_,useCallback:n8,useContext:Ra,useEffect:X5,useImperativeHandle:t8,useInsertionEffect:J5,useLayoutEffect:Q5,useMemo:r8,useReducer:V_,useRef:Y5,useState:function(){return V_(cd)},useDebugValue:aR,useDeferredValue:function(p,g){var _=Ei();return s8(_,_s.memoizedState,p,g)},useTransition:function(){var p=V_(cd)[0],g=Ei().memoizedState;return[typeof p=="boolean"?p:av(p),g]},useSyncExternalStore:j5,useId:l8,useHostTransitionStatus:cR,useFormState:H5,useActionState:H5,useOptimistic:function(p,g){var _=Ei();return B5(_,_s,p,g)},useMemoCache:tR,useCacheRefresh:c8},nfe={readContext:Ra,use:q_,useCallback:n8,useContext:Ra,useEffect:X5,useImperativeHandle:t8,useInsertionEffect:J5,useLayoutEffect:Q5,useMemo:r8,useReducer:rR,useRef:Y5,useState:function(){return rR(cd)},useDebugValue:aR,useDeferredValue:function(p,g){var _=Ei();return _s===null?oR(_,p,g):s8(_,_s.memoizedState,p,g)},useTransition:function(){var p=rR(cd)[0],g=Ei().memoizedState;return[typeof p=="boolean"?p:av(p),g]},useSyncExternalStore:j5,useId:l8,useHostTransitionStatus:cR,useFormState:K5,useActionState:K5,useOptimistic:function(p,g){var _=Ei();return _s!==null?B5(_,_s,p,g):(_.baseState=p,[p,_.queue.dispatch])},useMemoCache:tR,useCacheRefresh:c8},Dg=null,cv=0;function Y_(p){var g=cv;return cv+=1,Dg===null&&(Dg=[]),k5(Dg,p,g)}function uv(p,g){g=g.props.ref,p.ref=g!==void 0?g:null}function Z_(p,g){throw g.$$typeof===d?Error(r(525)):(p=Object.prototype.toString.call(g),Error(r(31,p==="[object Object]"?"object with keys {"+Object.keys(g).join(", ")+"}":p)))}function m8(p){var g=p._init;return g(p._payload)}function g8(p){function g(pt,it){if(p){var wt=pt.deletions;wt===null?(pt.deletions=[it],pt.flags|=16):wt.push(it)}}function _(pt,it){if(!p)return null;for(;it!==null;)g(pt,it),it=it.sibling;return null}function A(pt){for(var it=new Map;pt!==null;)pt.key!==null?it.set(pt.key,pt):it.set(pt.index,pt),pt=pt.sibling;return it}function j(pt,it){return pt=sd(pt,it),pt.index=0,pt.sibling=null,pt}function q(pt,it,wt){return pt.index=wt,p?(wt=pt.alternate,wt!==null?(wt=wt.index,wt<it?(pt.flags|=67108866,it):wt):(pt.flags|=67108866,it)):(pt.flags|=1048576,it)}function he(pt){return p&&pt.alternate===null&&(pt.flags|=67108866),pt}function je(pt,it,wt,Lt){return it===null||it.tag!==6?(it=MA(wt,pt.mode,Lt),it.return=pt,it):(it=j(it,wt),it.return=pt,it)}function Ye(pt,it,wt,Lt){var xn=wt.type;return xn===y?Dt(pt,it,wt.props.children,Lt,wt.key):it!==null&&(it.elementType===xn||typeof xn=="object"&&xn!==null&&xn.$$typeof===N&&m8(xn)===it.type)?(it=j(it,wt.props),uv(it,wt),it.return=pt,it):(it=I_(wt.type,wt.key,wt.props,null,pt.mode,Lt),uv(it,wt),it.return=pt,it)}function St(pt,it,wt,Lt){return it===null||it.tag!==4||it.stateNode.containerInfo!==wt.containerInfo||it.stateNode.implementation!==wt.implementation?(it=IA(wt,pt.mode,Lt),it.return=pt,it):(it=j(it,wt.children||[]),it.return=pt,it)}function Dt(pt,it,wt,Lt,xn){return it===null||it.tag!==7?(it=wp(wt,pt.mode,Lt,xn),it.return=pt,it):(it=j(it,wt),it.return=pt,it)}function Bt(pt,it,wt){if(typeof it=="string"&&it!==""||typeof it=="number"||typeof it=="bigint")return it=MA(""+it,pt.mode,wt),it.return=pt,it;if(typeof it=="object"&&it!==null){switch(it.$$typeof){case h:return wt=I_(it.type,it.key,it.props,null,pt.mode,wt),uv(wt,it),wt.return=pt,wt;case m:return it=IA(it,pt.mode,wt),it.return=pt,it;case N:var Lt=it._init;return it=Lt(it._payload),Bt(pt,it,wt)}if(Z(it)||D(it))return it=wp(it,pt.mode,wt,null),it.return=pt,it;if(typeof it.then=="function")return Bt(pt,Y_(it),wt);if(it.$$typeof===S)return Bt(pt,D_(pt,it),wt);Z_(pt,it)}return null}function Et(pt,it,wt,Lt){var xn=it!==null?it.key:null;if(typeof wt=="string"&&wt!==""||typeof wt=="number"||typeof wt=="bigint")return xn!==null?null:je(pt,it,""+wt,Lt);if(typeof wt=="object"&&wt!==null){switch(wt.$$typeof){case h:return wt.key===xn?Ye(pt,it,wt,Lt):null;case m:return wt.key===xn?St(pt,it,wt,Lt):null;case N:return xn=wt._init,wt=xn(wt._payload),Et(pt,it,wt,Lt)}if(Z(wt)||D(wt))return xn!==null?null:Dt(pt,it,wt,Lt,null);if(typeof wt.then=="function")return Et(pt,it,Y_(wt),Lt);if(wt.$$typeof===S)return Et(pt,it,D_(pt,wt),Lt);Z_(pt,wt)}return null}function Rt(pt,it,wt,Lt,xn){if(typeof Lt=="string"&&Lt!==""||typeof Lt=="number"||typeof Lt=="bigint")return pt=pt.get(wt)||null,je(it,pt,""+Lt,xn);if(typeof Lt=="object"&&Lt!==null){switch(Lt.$$typeof){case h:return pt=pt.get(Lt.key===null?wt:Lt.key)||null,Ye(it,pt,Lt,xn);case m:return pt=pt.get(Lt.key===null?wt:Lt.key)||null,St(it,pt,Lt,xn);case N:var Pr=Lt._init;return Lt=Pr(Lt._payload),Rt(pt,it,wt,Lt,xn)}if(Z(Lt)||D(Lt))return pt=pt.get(wt)||null,Dt(it,pt,Lt,xn,null);if(typeof Lt.then=="function")return Rt(pt,it,wt,Y_(Lt),xn);if(Lt.$$typeof===S)return Rt(pt,it,wt,D_(it,Lt),xn);Z_(it,Lt)}return null}function ar(pt,it,wt,Lt){for(var xn=null,Pr=null,Pn=it,Yn=it=0,ea=null;Pn!==null&&Yn<wt.length;Yn++){Pn.index>Yn?(ea=Pn,Pn=null):ea=Pn.sibling;var ts=Et(pt,Pn,wt[Yn],Lt);if(ts===null){Pn===null&&(Pn=ea);break}p&&Pn&&ts.alternate===null&&g(pt,Pn),it=q(ts,it,Yn),Pr===null?xn=ts:Pr.sibling=ts,Pr=ts,Pn=ea}if(Yn===wt.length)return _(pt,Pn),ss&&Sp(pt,Yn),xn;if(Pn===null){for(;Yn<wt.length;Yn++)Pn=Bt(pt,wt[Yn],Lt),Pn!==null&&(it=q(Pn,it,Yn),Pr===null?xn=Pn:Pr.sibling=Pn,Pr=Pn);return ss&&Sp(pt,Yn),xn}for(Pn=A(Pn);Yn<wt.length;Yn++)ea=Rt(Pn,pt,Yn,wt[Yn],Lt),ea!==null&&(p&&ea.alternate!==null&&Pn.delete(ea.key===null?Yn:ea.key),it=q(ea,it,Yn),Pr===null?xn=ea:Pr.sibling=ea,Pr=ea);return p&&Pn.forEach(function(Yf){return g(pt,Yf)}),ss&&Sp(pt,Yn),xn}function Wn(pt,it,wt,Lt){if(wt==null)throw Error(r(151));for(var xn=null,Pr=null,Pn=it,Yn=it=0,ea=null,ts=wt.next();Pn!==null&&!ts.done;Yn++,ts=wt.next()){Pn.index>Yn?(ea=Pn,Pn=null):ea=Pn.sibling;var Yf=Et(pt,Pn,ts.value,Lt);if(Yf===null){Pn===null&&(Pn=ea);break}p&&Pn&&Yf.alternate===null&&g(pt,Pn),it=q(Yf,it,Yn),Pr===null?xn=Yf:Pr.sibling=Yf,Pr=Yf,Pn=ea}if(ts.done)return _(pt,Pn),ss&&Sp(pt,Yn),xn;if(Pn===null){for(;!ts.done;Yn++,ts=wt.next())ts=Bt(pt,ts.value,Lt),ts!==null&&(it=q(ts,it,Yn),Pr===null?xn=ts:Pr.sibling=ts,Pr=ts);return ss&&Sp(pt,Yn),xn}for(Pn=A(Pn);!ts.done;Yn++,ts=wt.next())ts=Rt(Pn,pt,Yn,ts.value,Lt),ts!==null&&(p&&ts.alternate!==null&&Pn.delete(ts.key===null?Yn:ts.key),it=q(ts,it,Yn),Pr===null?xn=ts:Pr.sibling=ts,Pr=ts);return p&&Pn.forEach(function(rhe){return g(pt,rhe)}),ss&&Sp(pt,Yn),xn}function Cs(pt,it,wt,Lt){if(typeof wt=="object"&&wt!==null&&wt.type===y&&wt.key===null&&(wt=wt.props.children),typeof wt=="object"&&wt!==null){switch(wt.$$typeof){case h:e:{for(var xn=wt.key;it!==null;){if(it.key===xn){if(xn=wt.type,xn===y){if(it.tag===7){_(pt,it.sibling),Lt=j(it,wt.props.children),Lt.return=pt,pt=Lt;break e}}else if(it.elementType===xn||typeof xn=="object"&&xn!==null&&xn.$$typeof===N&&m8(xn)===it.type){_(pt,it.sibling),Lt=j(it,wt.props),uv(Lt,wt),Lt.return=pt,pt=Lt;break e}_(pt,it);break}else g(pt,it);it=it.sibling}wt.type===y?(Lt=wp(wt.props.children,pt.mode,Lt,wt.key),Lt.return=pt,pt=Lt):(Lt=I_(wt.type,wt.key,wt.props,null,pt.mode,Lt),uv(Lt,wt),Lt.return=pt,pt=Lt)}return he(pt);case m:e:{for(xn=wt.key;it!==null;){if(it.key===xn)if(it.tag===4&&it.stateNode.containerInfo===wt.containerInfo&&it.stateNode.implementation===wt.implementation){_(pt,it.sibling),Lt=j(it,wt.children||[]),Lt.return=pt,pt=Lt;break e}else{_(pt,it);break}else g(pt,it);it=it.sibling}Lt=IA(wt,pt.mode,Lt),Lt.return=pt,pt=Lt}return he(pt);case N:return xn=wt._init,wt=xn(wt._payload),Cs(pt,it,wt,Lt)}if(Z(wt))return ar(pt,it,wt,Lt);if(D(wt)){if(xn=D(wt),typeof xn!="function")throw Error(r(150));return wt=xn.call(wt),Wn(pt,it,wt,Lt)}if(typeof wt.then=="function")return Cs(pt,it,Y_(wt),Lt);if(wt.$$typeof===S)return Cs(pt,it,D_(pt,wt),Lt);Z_(pt,wt)}return typeof wt=="string"&&wt!==""||typeof wt=="number"||typeof wt=="bigint"?(wt=""+wt,it!==null&&it.tag===6?(_(pt,it.sibling),Lt=j(it,wt),Lt.return=pt,pt=Lt):(_(pt,it),Lt=MA(wt,pt.mode,Lt),Lt.return=pt,pt=Lt),he(pt)):_(pt,it)}return function(pt,it,wt,Lt){try{cv=0;var xn=Cs(pt,it,wt,Lt);return Dg=null,xn}catch(Pn){if(Pn===ev||Pn===L_)throw Pn;var Pr=Yo(29,Pn,null,pt.mode);return Pr.lanes=Lt,Pr.return=pt,Pr}finally{}}}var Fg=g8(!0),y8=g8(!1),Al=Q(null),Qc=null;function Of(p){var g=p.alternate;se(Li,Li.current&1),se(Al,p),Qc===null&&(g===null||Ig.current!==null||g.memoizedState!==null)&&(Qc=p)}function b8(p){if(p.tag===22){if(se(Li,Li.current),se(Al,p),Qc===null){var g=p.alternate;g!==null&&g.memoizedState!==null&&(Qc=p)}}else Pf()}function Pf(){se(Li,Li.current),se(Al,Al.current)}function ud(p){ee(Al),Qc===p&&(Qc=null),ee(Li)}var Li=Q(0);function X_(p){for(var g=p;g!==null;){if(g.tag===13){var _=g.memoizedState;if(_!==null&&(_=_.dehydrated,_===null||_.data==="$?"||eN(_)))return g}else if(g.tag===19&&g.memoizedProps.revealOrder!==void 0){if((g.flags&128)!==0)return g}else if(g.child!==null){g.child.return=g,g=g.child;continue}if(g===p)break;for(;g.sibling===null;){if(g.return===null||g.return===p)return null;g=g.return}g.sibling.return=g.return,g=g.sibling}return null}function dR(p,g,_,A){g=p.memoizedState,_=_(A,g),_=_==null?g:u({},g,_),p.memoizedState=_,p.lanes===0&&(p.updateQueue.baseState=_)}var fR={enqueueSetState:function(p,g,_){p=p._reactInternals;var A=Qo(),j=Mf(A);j.payload=g,_!=null&&(j.callback=_),g=If(p,j,A),g!==null&&(el(g,p,A),nv(g,p,A))},enqueueReplaceState:function(p,g,_){p=p._reactInternals;var A=Qo(),j=Mf(A);j.tag=1,j.payload=g,_!=null&&(j.callback=_),g=If(p,j,A),g!==null&&(el(g,p,A),nv(g,p,A))},enqueueForceUpdate:function(p,g){p=p._reactInternals;var _=Qo(),A=Mf(_);A.tag=2,g!=null&&(A.callback=g),g=If(p,A,_),g!==null&&(el(g,p,_),nv(g,p,_))}};function v8(p,g,_,A,j,q,he){return p=p.stateNode,typeof p.shouldComponentUpdate=="function"?p.shouldComponentUpdate(A,q,he):g.prototype&&g.prototype.isPureReactComponent?!M(_,A)||!M(j,q):!0}function x8(p,g,_,A){p=g.state,typeof g.componentWillReceiveProps=="function"&&g.componentWillReceiveProps(_,A),typeof g.UNSAFE_componentWillReceiveProps=="function"&&g.UNSAFE_componentWillReceiveProps(_,A),g.state!==p&&fR.enqueueReplaceState(g,g.state,null)}function Np(p,g){var _=g;if("ref"in g){_={};for(var A in g)A!=="ref"&&(_[A]=g[A])}if(p=p.defaultProps){_===g&&(_=u({},_));for(var j in p)_[j]===void 0&&(_[j]=p[j])}return _}var J_=typeof reportError=="function"?reportError:function(p){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var g=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof p=="object"&&p!==null&&typeof p.message=="string"?String(p.message):String(p),error:p});if(!window.dispatchEvent(g))return}else if(typeof Mi=="object"&&typeof Mi.emit=="function"){Mi.emit("uncaughtException",p);return}console.error(p)};function w8(p){J_(p)}function _8(p){console.error(p)}function S8(p){J_(p)}function Q_(p,g){try{var _=p.onUncaughtError;_(g.value,{componentStack:g.stack})}catch(A){setTimeout(function(){throw A})}}function C8(p,g,_){try{var A=p.onCaughtError;A(_.value,{componentStack:_.stack,errorBoundary:g.tag===1?g.stateNode:null})}catch(j){setTimeout(function(){throw j})}}function hR(p,g,_){return _=Mf(_),_.tag=3,_.payload={element:null},_.callback=function(){Q_(p,g)},_}function k8(p){return p=Mf(p),p.tag=3,p}function E8(p,g,_,A){var j=_.type.getDerivedStateFromError;if(typeof j=="function"){var q=A.value;p.payload=function(){return j(q)},p.callback=function(){C8(g,_,A)}}var he=_.stateNode;he!==null&&typeof he.componentDidCatch=="function"&&(p.callback=function(){C8(g,_,A),typeof j!="function"&&(zf===null?zf=new Set([this]):zf.add(this));var je=A.stack;this.componentDidCatch(A.value,{componentStack:je!==null?je:""})})}function rfe(p,g,_,A,j){if(_.flags|=32768,A!==null&&typeof A=="object"&&typeof A.then=="function"){if(g=_.alternate,g!==null&&Xb(g,_,j,!0),_=Al.current,_!==null){switch(_.tag){case 13:return Qc===null?FR():_.alternate===null&&oi===0&&(oi=3),_.flags&=-257,_.flags|=65536,_.lanes=j,A===UA?_.flags|=16384:(g=_.updateQueue,g===null?_.updateQueue=new Set([A]):g.add(A),BR(p,A,j)),!1;case 22:return _.flags|=65536,A===UA?_.flags|=16384:(g=_.updateQueue,g===null?(g={transitions:null,markerInstances:null,retryQueue:new Set([A])},_.updateQueue=g):(_=g.retryQueue,_===null?g.retryQueue=new Set([A]):_.add(A)),BR(p,A,j)),!1}throw Error(r(435,_.tag))}return BR(p,A,j),FR(),!1}if(ss)return g=Al.current,g!==null?((g.flags&65536)===0&&(g.flags|=256),g.flags|=65536,g.lanes=j,A!==PA&&(p=Error(r(422),{cause:A}),Zb($n(p,_)))):(A!==PA&&(g=Error(r(423),{cause:A}),Zb($n(g,_))),p=p.current.alternate,p.flags|=65536,j&=-j,p.lanes|=j,A=$n(A,_),j=hR(p.stateNode,A,j),WA(p,j),oi!==4&&(oi=2)),!1;var q=Error(r(520),{cause:A});if(q=$n(q,_),yv===null?yv=[q]:yv.push(q),oi!==4&&(oi=2),g===null)return!0;A=$n(A,_),_=g;do{switch(_.tag){case 3:return _.flags|=65536,p=j&-j,_.lanes|=p,p=hR(_.stateNode,A,p),WA(_,p),!1;case 1:if(g=_.type,q=_.stateNode,(_.flags&128)===0&&(typeof g.getDerivedStateFromError=="function"||q!==null&&typeof q.componentDidCatch=="function"&&(zf===null||!zf.has(q))))return _.flags|=65536,j&=-j,_.lanes|=j,j=k8(j),E8(j,p,_,A),WA(_,j),!1}_=_.return}while(_!==null);return!1}var T8=Error(r(461)),Ji=!1;function ma(p,g,_,A){g.child=p===null?y8(g,null,_,A):Fg(g,p.child,_,A)}function A8(p,g,_,A,j){_=_.render;var q=g.ref;if("ref"in A){var he={};for(var je in A)je!=="ref"&&(he[je]=A[je])}else he=A;return Tp(g),A=ZA(p,g,_,he,q,j),je=XA(),p!==null&&!Ji?(JA(p,g,j),dd(p,g,j)):(ss&&je&&jA(g),g.flags|=1,ma(p,g,A,j),g.child)}function R8(p,g,_,A,j){if(p===null){var q=_.type;return typeof q=="function"&&!NA(q)&&q.defaultProps===void 0&&_.compare===null?(g.tag=15,g.type=q,N8(p,g,q,A,j)):(p=I_(_.type,null,A,g,g.mode,j),p.ref=g.ref,p.return=g,g.child=p)}if(q=p.child,!wR(p,j)){var he=q.memoizedProps;if(_=_.compare,_=_!==null?_:M,_(he,A)&&p.ref===g.ref)return dd(p,g,j)}return g.flags|=1,p=sd(q,A),p.ref=g.ref,p.return=g,g.child=p}function N8(p,g,_,A,j){if(p!==null){var q=p.memoizedProps;if(M(q,A)&&p.ref===g.ref)if(Ji=!1,g.pendingProps=A=q,wR(p,j))(p.flags&131072)!==0&&(Ji=!0);else return g.lanes=p.lanes,dd(p,g,j)}return pR(p,g,_,A,j)}function M8(p,g,_){var A=g.pendingProps,j=A.children,q=p!==null?p.memoizedState:null;if(A.mode==="hidden"){if((g.flags&128)!==0){if(A=q!==null?q.baseLanes|_:_,p!==null){for(j=g.child=p.child,q=0;j!==null;)q=q|j.lanes|j.childLanes,j=j.sibling;g.childLanes=q&~A}else g.childLanes=0,g.child=null;return I8(p,g,A,_)}if((_&536870912)!==0)g.memoizedState={baseLanes:0,cachePool:null},p!==null&&F_(g,q!==null?q.cachePool:null),q!==null?N5(g,q):GA(),b8(g);else return g.lanes=g.childLanes=536870912,I8(p,g,q!==null?q.baseLanes|_:_,_)}else q!==null?(F_(g,q.cachePool),N5(g,q),Pf(),g.memoizedState=null):(p!==null&&F_(g,null),GA(),Pf());return ma(p,g,j,_),g.child}function I8(p,g,_,A){var j=zA();return j=j===null?null:{parent:Fi._currentValue,pool:j},g.memoizedState={baseLanes:_,cachePool:j},p!==null&&F_(g,null),GA(),b8(g),p!==null&&Xb(p,g,A,!0),null}function eS(p,g){var _=g.ref;if(_===null)p!==null&&p.ref!==null&&(g.flags|=4194816);else{if(typeof _!="function"&&typeof _!="object")throw Error(r(284));(p===null||p.ref!==_)&&(g.flags|=4194816)}}function pR(p,g,_,A,j){return Tp(g),_=ZA(p,g,_,A,void 0,j),A=XA(),p!==null&&!Ji?(JA(p,g,j),dd(p,g,j)):(ss&&A&&jA(g),g.flags|=1,ma(p,g,_,j),g.child)}function j8(p,g,_,A,j,q){return Tp(g),g.updateQueue=null,_=I5(g,A,_,j),M5(p),A=XA(),p!==null&&!Ji?(JA(p,g,q),dd(p,g,q)):(ss&&A&&jA(g),g.flags|=1,ma(p,g,_,q),g.child)}function O8(p,g,_,A,j){if(Tp(g),g.stateNode===null){var q=Xc,he=_.contextType;typeof he=="object"&&he!==null&&(q=Ra(he)),q=new _(A,q),g.memoizedState=q.state!==null&&q.state!==void 0?q.state:null,q.updater=fR,g.stateNode=q,q._reactInternals=g,q=g.stateNode,q.props=A,q.state=g.memoizedState,q.refs={},qA(g),he=_.contextType,q.context=typeof he=="object"&&he!==null?Ra(he):Xc,q.state=g.memoizedState,he=_.getDerivedStateFromProps,typeof he=="function"&&(dR(g,_,he,A),q.state=g.memoizedState),typeof _.getDerivedStateFromProps=="function"||typeof q.getSnapshotBeforeUpdate=="function"||typeof q.UNSAFE_componentWillMount!="function"&&typeof q.componentWillMount!="function"||(he=q.state,typeof q.componentWillMount=="function"&&q.componentWillMount(),typeof q.UNSAFE_componentWillMount=="function"&&q.UNSAFE_componentWillMount(),he!==q.state&&fR.enqueueReplaceState(q,q.state,null),sv(g,A,q,j),rv(),q.state=g.memoizedState),typeof q.componentDidMount=="function"&&(g.flags|=4194308),A=!0}else if(p===null){q=g.stateNode;var je=g.memoizedProps,Ye=Np(_,je);q.props=Ye;var St=q.context,Dt=_.contextType;he=Xc,typeof Dt=="object"&&Dt!==null&&(he=Ra(Dt));var Bt=_.getDerivedStateFromProps;Dt=typeof Bt=="function"||typeof q.getSnapshotBeforeUpdate=="function",je=g.pendingProps!==je,Dt||typeof q.UNSAFE_componentWillReceiveProps!="function"&&typeof q.componentWillReceiveProps!="function"||(je||St!==he)&&x8(g,q,A,he),Nf=!1;var Et=g.memoizedState;q.state=Et,sv(g,A,q,j),rv(),St=g.memoizedState,je||Et!==St||Nf?(typeof Bt=="function"&&(dR(g,_,Bt,A),St=g.memoizedState),(Ye=Nf||v8(g,_,Ye,A,Et,St,he))?(Dt||typeof q.UNSAFE_componentWillMount!="function"&&typeof q.componentWillMount!="function"||(typeof q.componentWillMount=="function"&&q.componentWillMount(),typeof q.UNSAFE_componentWillMount=="function"&&q.UNSAFE_componentWillMount()),typeof q.componentDidMount=="function"&&(g.flags|=4194308)):(typeof q.componentDidMount=="function"&&(g.flags|=4194308),g.memoizedProps=A,g.memoizedState=St),q.props=A,q.state=St,q.context=he,A=Ye):(typeof q.componentDidMount=="function"&&(g.flags|=4194308),A=!1)}else{q=g.stateNode,VA(p,g),he=g.memoizedProps,Dt=Np(_,he),q.props=Dt,Bt=g.pendingProps,Et=q.context,St=_.contextType,Ye=Xc,typeof St=="object"&&St!==null&&(Ye=Ra(St)),je=_.getDerivedStateFromProps,(St=typeof je=="function"||typeof q.getSnapshotBeforeUpdate=="function")||typeof q.UNSAFE_componentWillReceiveProps!="function"&&typeof q.componentWillReceiveProps!="function"||(he!==Bt||Et!==Ye)&&x8(g,q,A,Ye),Nf=!1,Et=g.memoizedState,q.state=Et,sv(g,A,q,j),rv();var Rt=g.memoizedState;he!==Bt||Et!==Rt||Nf||p!==null&&p.dependencies!==null&&P_(p.dependencies)?(typeof je=="function"&&(dR(g,_,je,A),Rt=g.memoizedState),(Dt=Nf||v8(g,_,Dt,A,Et,Rt,Ye)||p!==null&&p.dependencies!==null&&P_(p.dependencies))?(St||typeof q.UNSAFE_componentWillUpdate!="function"&&typeof q.componentWillUpdate!="function"||(typeof q.componentWillUpdate=="function"&&q.componentWillUpdate(A,Rt,Ye),typeof q.UNSAFE_componentWillUpdate=="function"&&q.UNSAFE_componentWillUpdate(A,Rt,Ye)),typeof q.componentDidUpdate=="function"&&(g.flags|=4),typeof q.getSnapshotBeforeUpdate=="function"&&(g.flags|=1024)):(typeof q.componentDidUpdate!="function"||he===p.memoizedProps&&Et===p.memoizedState||(g.flags|=4),typeof q.getSnapshotBeforeUpdate!="function"||he===p.memoizedProps&&Et===p.memoizedState||(g.flags|=1024),g.memoizedProps=A,g.memoizedState=Rt),q.props=A,q.state=Rt,q.context=Ye,A=Dt):(typeof q.componentDidUpdate!="function"||he===p.memoizedProps&&Et===p.memoizedState||(g.flags|=4),typeof q.getSnapshotBeforeUpdate!="function"||he===p.memoizedProps&&Et===p.memoizedState||(g.flags|=1024),A=!1)}return q=A,eS(p,g),A=(g.flags&128)!==0,q||A?(q=g.stateNode,_=A&&typeof _.getDerivedStateFromError!="function"?null:q.render(),g.flags|=1,p!==null&&A?(g.child=Fg(g,p.child,null,j),g.child=Fg(g,null,_,j)):ma(p,g,_,j),g.memoizedState=q.state,p=g.child):p=dd(p,g,j),p}function P8(p,g,_,A){return Yb(),g.flags|=256,ma(p,g,_,A),g.child}var mR={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function gR(p){return{baseLanes:p,cachePool:_5()}}function yR(p,g,_){return p=p!==null?p.childLanes&~_:0,g&&(p|=Rl),p}function D8(p,g,_){var A=g.pendingProps,j=!1,q=(g.flags&128)!==0,he;if((he=q)||(he=p!==null&&p.memoizedState===null?!1:(Li.current&2)!==0),he&&(j=!0,g.flags&=-129),he=(g.flags&32)!==0,g.flags&=-33,p===null){if(ss){if(j?Of(g):Pf(),ss){var je=ai,Ye;if(Ye=je){e:{for(Ye=je,je=Jc;Ye.nodeType!==8;){if(!je){je=null;break e}if(Ye=dc(Ye.nextSibling),Ye===null){je=null;break e}}je=Ye}je!==null?(g.memoizedState={dehydrated:je,treeContext:_p!==null?{id,overflow:ad}:null,retryLane:536870912,hydrationErrors:null},Ye=Yo(18,null,null,0),Ye.stateNode=je,Ye.return=g,g.child=Ye,Ya=g,ai=null,Ye=!0):Ye=!1}Ye||kp(g)}if(je=g.memoizedState,je!==null&&(je=je.dehydrated,je!==null))return eN(je)?g.lanes=32:g.lanes=536870912,null;ud(g)}return je=A.children,A=A.fallback,j?(Pf(),j=g.mode,je=tS({mode:"hidden",children:je},j),A=wp(A,j,_,null),je.return=g,A.return=g,je.sibling=A,g.child=je,j=g.child,j.memoizedState=gR(_),j.childLanes=yR(p,he,_),g.memoizedState=mR,A):(Of(g),bR(g,je))}if(Ye=p.memoizedState,Ye!==null&&(je=Ye.dehydrated,je!==null)){if(q)g.flags&256?(Of(g),g.flags&=-257,g=vR(p,g,_)):g.memoizedState!==null?(Pf(),g.child=p.child,g.flags|=128,g=null):(Pf(),j=A.fallback,je=g.mode,A=tS({mode:"visible",children:A.children},je),j=wp(j,je,_,null),j.flags|=2,A.return=g,j.return=g,A.sibling=j,g.child=A,Fg(g,p.child,null,_),A=g.child,A.memoizedState=gR(_),A.childLanes=yR(p,he,_),g.memoizedState=mR,g=j);else if(Of(g),eN(je)){if(he=je.nextSibling&&je.nextSibling.dataset,he)var St=he.dgst;he=St,A=Error(r(419)),A.stack="",A.digest=he,Zb({value:A,source:null,stack:null}),g=vR(p,g,_)}else if(Ji||Xb(p,g,_,!1),he=(_&p.childLanes)!==0,Ji||he){if(he=Ps,he!==null&&(A=_&-_,A=(A&42)!==0?1:Ct(A),A=(A&(he.suspendedLanes|_))!==0?0:A,A!==0&&A!==Ye.retryLane))throw Ye.retryLane=A,cc(p,A),el(he,p,A),T8;je.data==="$?"||FR(),g=vR(p,g,_)}else je.data==="$?"?(g.flags|=192,g.child=p.child,g=null):(p=Ye.treeContext,ai=dc(je.nextSibling),Ya=g,ss=!0,Cp=null,Jc=!1,p!==null&&(El[Tl++]=id,El[Tl++]=ad,El[Tl++]=_p,id=p.id,ad=p.overflow,_p=g),g=bR(g,A.children),g.flags|=4096);return g}return j?(Pf(),j=A.fallback,je=g.mode,Ye=p.child,St=Ye.sibling,A=sd(Ye,{mode:"hidden",children:A.children}),A.subtreeFlags=Ye.subtreeFlags&65011712,St!==null?j=sd(St,j):(j=wp(j,je,_,null),j.flags|=2),j.return=g,A.return=g,A.sibling=j,g.child=A,A=j,j=g.child,je=p.child.memoizedState,je===null?je=gR(_):(Ye=je.cachePool,Ye!==null?(St=Fi._currentValue,Ye=Ye.parent!==St?{parent:St,pool:St}:Ye):Ye=_5(),je={baseLanes:je.baseLanes|_,cachePool:Ye}),j.memoizedState=je,j.childLanes=yR(p,he,_),g.memoizedState=mR,A):(Of(g),_=p.child,p=_.sibling,_=sd(_,{mode:"visible",children:A.children}),_.return=g,_.sibling=null,p!==null&&(he=g.deletions,he===null?(g.deletions=[p],g.flags|=16):he.push(p)),g.child=_,g.memoizedState=null,_)}function bR(p,g){return g=tS({mode:"visible",children:g},p.mode),g.return=p,p.child=g}function tS(p,g){return p=Yo(22,p,null,g),p.lanes=0,p.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},p}function vR(p,g,_){return Fg(g,p.child,null,_),p=bR(g,g.pendingProps.children),p.flags|=2,g.memoizedState=null,p}function F8(p,g,_){p.lanes|=g;var A=p.alternate;A!==null&&(A.lanes|=g),FA(p.return,g,_)}function xR(p,g,_,A,j){var q=p.memoizedState;q===null?p.memoizedState={isBackwards:g,rendering:null,renderingStartTime:0,last:A,tail:_,tailMode:j}:(q.isBackwards=g,q.rendering=null,q.renderingStartTime=0,q.last=A,q.tail=_,q.tailMode=j)}function L8(p,g,_){var A=g.pendingProps,j=A.revealOrder,q=A.tail;if(ma(p,g,A.children,_),A=Li.current,(A&2)!==0)A=A&1|2,g.flags|=128;else{if(p!==null&&(p.flags&128)!==0)e:for(p=g.child;p!==null;){if(p.tag===13)p.memoizedState!==null&&F8(p,_,g);else if(p.tag===19)F8(p,_,g);else if(p.child!==null){p.child.return=p,p=p.child;continue}if(p===g)break e;for(;p.sibling===null;){if(p.return===null||p.return===g)break e;p=p.return}p.sibling.return=p.return,p=p.sibling}A&=1}switch(se(Li,A),j){case"forwards":for(_=g.child,j=null;_!==null;)p=_.alternate,p!==null&&X_(p)===null&&(j=_),_=_.sibling;_=j,_===null?(j=g.child,g.child=null):(j=_.sibling,_.sibling=null),xR(g,!1,j,_,q);break;case"backwards":for(_=null,j=g.child,g.child=null;j!==null;){if(p=j.alternate,p!==null&&X_(p)===null){g.child=j;break}p=j.sibling,j.sibling=_,_=j,j=p}xR(g,!0,_,null,q);break;case"together":xR(g,!1,null,null,void 0);break;default:g.memoizedState=null}return g.child}function dd(p,g,_){if(p!==null&&(g.dependencies=p.dependencies),$f|=g.lanes,(_&g.childLanes)===0)if(p!==null){if(Xb(p,g,_,!1),(_&g.childLanes)===0)return null}else return null;if(p!==null&&g.child!==p.child)throw Error(r(153));if(g.child!==null){for(p=g.child,_=sd(p,p.pendingProps),g.child=_,_.return=g;p.sibling!==null;)p=p.sibling,_=_.sibling=sd(p,p.pendingProps),_.return=g;_.sibling=null}return g.child}function wR(p,g){return(p.lanes&g)!==0?!0:(p=p.dependencies,!!(p!==null&&P_(p)))}function sfe(p,g,_){switch(g.tag){case 3:Se(g,g.stateNode.containerInfo),Rf(g,Fi,p.memoizedState.cache),Yb();break;case 27:case 5:qe(g);break;case 4:Se(g,g.stateNode.containerInfo);break;case 10:Rf(g,g.type,g.memoizedProps.value);break;case 13:var A=g.memoizedState;if(A!==null)return A.dehydrated!==null?(Of(g),g.flags|=128,null):(_&g.child.childLanes)!==0?D8(p,g,_):(Of(g),p=dd(p,g,_),p!==null?p.sibling:null);Of(g);break;case 19:var j=(p.flags&128)!==0;if(A=(_&g.childLanes)!==0,A||(Xb(p,g,_,!1),A=(_&g.childLanes)!==0),j){if(A)return L8(p,g,_);g.flags|=128}if(j=g.memoizedState,j!==null&&(j.rendering=null,j.tail=null,j.lastEffect=null),se(Li,Li.current),A)break;return null;case 22:case 23:return g.lanes=0,M8(p,g,_);case 24:Rf(g,Fi,p.memoizedState.cache)}return dd(p,g,_)}function B8(p,g,_){if(p!==null)if(p.memoizedProps!==g.pendingProps)Ji=!0;else{if(!wR(p,_)&&(g.flags&128)===0)return Ji=!1,sfe(p,g,_);Ji=(p.flags&131072)!==0}else Ji=!1,ss&&(g.flags&1048576)!==0&&m5(g,O_,g.index);switch(g.lanes=0,g.tag){case 16:e:{p=g.pendingProps;var A=g.elementType,j=A._init;if(A=j(A._payload),g.type=A,typeof A=="function")NA(A)?(p=Np(A,p),g.tag=1,g=O8(null,g,A,p,_)):(g.tag=0,g=pR(null,g,A,p,_));else{if(A!=null){if(j=A.$$typeof,j===k){g.tag=11,g=A8(null,g,A,p,_);break e}else if(j===R){g.tag=14,g=R8(null,g,A,p,_);break e}}throw g=O(A)||A,Error(r(306,g,""))}}return g;case 0:return pR(p,g,g.type,g.pendingProps,_);case 1:return A=g.type,j=Np(A,g.pendingProps),O8(p,g,A,j,_);case 3:e:{if(Se(g,g.stateNode.containerInfo),p===null)throw Error(r(387));A=g.pendingProps;var q=g.memoizedState;j=q.element,VA(p,g),sv(g,A,null,_);var he=g.memoizedState;if(A=he.cache,Rf(g,Fi,A),A!==q.cache&&LA(g,[Fi],_,!0),rv(),A=he.element,q.isDehydrated)if(q={element:A,isDehydrated:!1,cache:he.cache},g.updateQueue.baseState=q,g.memoizedState=q,g.flags&256){g=P8(p,g,A,_);break e}else if(A!==j){j=$n(Error(r(424)),g),Zb(j),g=P8(p,g,A,_);break e}else{switch(p=g.stateNode.containerInfo,p.nodeType){case 9:p=p.body;break;default:p=p.nodeName==="HTML"?p.ownerDocument.body:p}for(ai=dc(p.firstChild),Ya=g,ss=!0,Cp=null,Jc=!0,_=y8(g,null,A,_),g.child=_;_;)_.flags=_.flags&-3|4096,_=_.sibling}else{if(Yb(),A===j){g=dd(p,g,_);break e}ma(p,g,A,_)}g=g.child}return g;case 26:return eS(p,g),p===null?(_=qL(g.type,null,g.pendingProps,null))?g.memoizedState=_:ss||(_=g.type,p=g.pendingProps,A=mS(Oe.current).createElement(_),A[xe]=g,A[De]=p,ya(A,_,p),kr(A),g.stateNode=A):g.memoizedState=qL(g.type,p.memoizedProps,g.pendingProps,p.memoizedState),null;case 27:return qe(g),p===null&&ss&&(A=g.stateNode=$L(g.type,g.pendingProps,Oe.current),Ya=g,Jc=!0,j=ai,Vf(g.type)?(tN=j,ai=dc(A.firstChild)):ai=j),ma(p,g,g.pendingProps.children,_),eS(p,g),p===null&&(g.flags|=4194304),g.child;case 5:return p===null&&ss&&((j=A=ai)&&(A=Ife(A,g.type,g.pendingProps,Jc),A!==null?(g.stateNode=A,Ya=g,ai=dc(A.firstChild),Jc=!1,j=!0):j=!1),j||kp(g)),qe(g),j=g.type,q=g.pendingProps,he=p!==null?p.memoizedProps:null,A=q.children,XR(j,q)?A=null:he!==null&&XR(j,he)&&(g.flags|=32),g.memoizedState!==null&&(j=ZA(p,g,Zde,null,null,_),Ev._currentValue=j),eS(p,g),ma(p,g,A,_),g.child;case 6:return p===null&&ss&&((p=_=ai)&&(_=jfe(_,g.pendingProps,Jc),_!==null?(g.stateNode=_,Ya=g,ai=null,p=!0):p=!1),p||kp(g)),null;case 13:return D8(p,g,_);case 4:return Se(g,g.stateNode.containerInfo),A=g.pendingProps,p===null?g.child=Fg(g,null,A,_):ma(p,g,A,_),g.child;case 11:return A8(p,g,g.type,g.pendingProps,_);case 7:return ma(p,g,g.pendingProps,_),g.child;case 8:return ma(p,g,g.pendingProps.children,_),g.child;case 12:return ma(p,g,g.pendingProps.children,_),g.child;case 10:return A=g.pendingProps,Rf(g,g.type,A.value),ma(p,g,A.children,_),g.child;case 9:return j=g.type._context,A=g.pendingProps.children,Tp(g),j=Ra(j),A=A(j),g.flags|=1,ma(p,g,A,_),g.child;case 14:return R8(p,g,g.type,g.pendingProps,_);case 15:return N8(p,g,g.type,g.pendingProps,_);case 19:return L8(p,g,_);case 31:return A=g.pendingProps,_=g.mode,A={mode:A.mode,children:A.children},p===null?(_=tS(A,_),_.ref=g.ref,g.child=_,_.return=g,g=_):(_=sd(p.child,A),_.ref=g.ref,g.child=_,_.return=g,g=_),g;case 22:return M8(p,g,_);case 24:return Tp(g),A=Ra(Fi),p===null?(j=zA(),j===null&&(j=Ps,q=BA(),j.pooledCache=q,q.refCount++,q!==null&&(j.pooledCacheLanes|=_),j=q),g.memoizedState={parent:A,cache:j},qA(g),Rf(g,Fi,j)):((p.lanes&_)!==0&&(VA(p,g),sv(g,null,null,_),rv()),j=p.memoizedState,q=g.memoizedState,j.parent!==A?(j={parent:A,cache:A},g.memoizedState=j,g.lanes===0&&(g.memoizedState=g.updateQueue.baseState=j),Rf(g,Fi,A)):(A=q.cache,Rf(g,Fi,A),A!==j.cache&&LA(g,[Fi],_,!0))),ma(p,g,g.pendingProps.children,_),g.child;case 29:throw g.pendingProps}throw Error(r(156,g.tag))}function fd(p){p.flags|=4}function $8(p,g){if(g.type!=="stylesheet"||(g.state.loading&4)!==0)p.flags&=-16777217;else if(p.flags|=16777216,!KL(g)){if(g=Al.current,g!==null&&((Gr&4194048)===Gr?Qc!==null:(Gr&62914560)!==Gr&&(Gr&536870912)===0||g!==Qc))throw tv=UA,S5;p.flags|=8192}}function nS(p,g){g!==null&&(p.flags|=4),p.flags&16384&&(g=p.tag!==22?$():536870912,p.lanes|=g,zg|=g)}function dv(p,g){if(!ss)switch(p.tailMode){case"hidden":g=p.tail;for(var _=null;g!==null;)g.alternate!==null&&(_=g),g=g.sibling;_===null?p.tail=null:_.sibling=null;break;case"collapsed":_=p.tail;for(var A=null;_!==null;)_.alternate!==null&&(A=_),_=_.sibling;A===null?g||p.tail===null?p.tail=null:p.tail.sibling=null:A.sibling=null}}function Js(p){var g=p.alternate!==null&&p.alternate.child===p.child,_=0,A=0;if(g)for(var j=p.child;j!==null;)_|=j.lanes|j.childLanes,A|=j.subtreeFlags&65011712,A|=j.flags&65011712,j.return=p,j=j.sibling;else for(j=p.child;j!==null;)_|=j.lanes|j.childLanes,A|=j.subtreeFlags,A|=j.flags,j.return=p,j=j.sibling;return p.subtreeFlags|=A,p.childLanes=_,g}function ife(p,g,_){var A=g.pendingProps;switch(OA(g),g.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Js(g),null;case 1:return Js(g),null;case 3:return _=g.stateNode,A=null,p!==null&&(A=p.memoizedState.cache),g.memoizedState.cache!==A&&(g.flags|=2048),ld(Fi),Ce(),_.pendingContext&&(_.context=_.pendingContext,_.pendingContext=null),(p===null||p.child===null)&&(Kb(g)?fd(g):p===null||p.memoizedState.isDehydrated&&(g.flags&256)===0||(g.flags|=1024,b5())),Js(g),null;case 26:return _=g.memoizedState,p===null?(fd(g),_!==null?(Js(g),$8(g,_)):(Js(g),g.flags&=-16777217)):_?_!==p.memoizedState?(fd(g),Js(g),$8(g,_)):(Js(g),g.flags&=-16777217):(p.memoizedProps!==A&&fd(g),Js(g),g.flags&=-16777217),null;case 27:Qe(g),_=Oe.current;var j=g.type;if(p!==null&&g.stateNode!=null)p.memoizedProps!==A&&fd(g);else{if(!A){if(g.stateNode===null)throw Error(r(166));return Js(g),null}p=pe.current,Kb(g)?g5(g):(p=$L(j,A,_),g.stateNode=p,fd(g))}return Js(g),null;case 5:if(Qe(g),_=g.type,p!==null&&g.stateNode!=null)p.memoizedProps!==A&&fd(g);else{if(!A){if(g.stateNode===null)throw Error(r(166));return Js(g),null}if(p=pe.current,Kb(g))g5(g);else{switch(j=mS(Oe.current),p){case 1:p=j.createElementNS("http://www.w3.org/2000/svg",_);break;case 2:p=j.createElementNS("http://www.w3.org/1998/Math/MathML",_);break;default:switch(_){case"svg":p=j.createElementNS("http://www.w3.org/2000/svg",_);break;case"math":p=j.createElementNS("http://www.w3.org/1998/Math/MathML",_);break;case"script":p=j.createElement("div"),p.innerHTML="<script><\/script>",p=p.removeChild(p.firstChild);break;case"select":p=typeof A.is=="string"?j.createElement("select",{is:A.is}):j.createElement("select"),A.multiple?p.multiple=!0:A.size&&(p.size=A.size);break;default:p=typeof A.is=="string"?j.createElement(_,{is:A.is}):j.createElement(_)}}p[xe]=g,p[De]=A;e:for(j=g.child;j!==null;){if(j.tag===5||j.tag===6)p.appendChild(j.stateNode);else if(j.tag!==4&&j.tag!==27&&j.child!==null){j.child.return=j,j=j.child;continue}if(j===g)break e;for(;j.sibling===null;){if(j.return===null||j.return===g)break e;j=j.return}j.sibling.return=j.return,j=j.sibling}g.stateNode=p;e:switch(ya(p,_,A),_){case"button":case"input":case"select":case"textarea":p=!!A.autoFocus;break e;case"img":p=!0;break e;default:p=!1}p&&fd(g)}}return Js(g),g.flags&=-16777217,null;case 6:if(p&&g.stateNode!=null)p.memoizedProps!==A&&fd(g);else{if(typeof A!="string"&&g.stateNode===null)throw Error(r(166));if(p=Oe.current,Kb(g)){if(p=g.stateNode,_=g.memoizedProps,A=null,j=Ya,j!==null)switch(j.tag){case 27:case 5:A=j.memoizedProps}p[xe]=g,p=!!(p.nodeValue===_||A!==null&&A.suppressHydrationWarning===!0||jL(p.nodeValue,_)),p||kp(g)}else p=mS(p).createTextNode(A),p[xe]=g,g.stateNode=p}return Js(g),null;case 13:if(A=g.memoizedState,p===null||p.memoizedState!==null&&p.memoizedState.dehydrated!==null){if(j=Kb(g),A!==null&&A.dehydrated!==null){if(p===null){if(!j)throw Error(r(318));if(j=g.memoizedState,j=j!==null?j.dehydrated:null,!j)throw Error(r(317));j[xe]=g}else Yb(),(g.flags&128)===0&&(g.memoizedState=null),g.flags|=4;Js(g),j=!1}else j=b5(),p!==null&&p.memoizedState!==null&&(p.memoizedState.hydrationErrors=j),j=!0;if(!j)return g.flags&256?(ud(g),g):(ud(g),null)}if(ud(g),(g.flags&128)!==0)return g.lanes=_,g;if(_=A!==null,p=p!==null&&p.memoizedState!==null,_){A=g.child,j=null,A.alternate!==null&&A.alternate.memoizedState!==null&&A.alternate.memoizedState.cachePool!==null&&(j=A.alternate.memoizedState.cachePool.pool);var q=null;A.memoizedState!==null&&A.memoizedState.cachePool!==null&&(q=A.memoizedState.cachePool.pool),q!==j&&(A.flags|=2048)}return _!==p&&_&&(g.child.flags|=8192),nS(g,g.updateQueue),Js(g),null;case 4:return Ce(),p===null&&HR(g.stateNode.containerInfo),Js(g),null;case 10:return ld(g.type),Js(g),null;case 19:if(ee(Li),j=g.memoizedState,j===null)return Js(g),null;if(A=(g.flags&128)!==0,q=j.rendering,q===null)if(A)dv(j,!1);else{if(oi!==0||p!==null&&(p.flags&128)!==0)for(p=g.child;p!==null;){if(q=X_(p),q!==null){for(g.flags|=128,dv(j,!1),p=q.updateQueue,g.updateQueue=p,nS(g,p),g.subtreeFlags=0,p=_,_=g.child;_!==null;)p5(_,p),_=_.sibling;return se(Li,Li.current&1|2),g.child}p=p.sibling}j.tail!==null&&ce()>iS&&(g.flags|=128,A=!0,dv(j,!1),g.lanes=4194304)}else{if(!A)if(p=X_(q),p!==null){if(g.flags|=128,A=!0,p=p.updateQueue,g.updateQueue=p,nS(g,p),dv(j,!0),j.tail===null&&j.tailMode==="hidden"&&!q.alternate&&!ss)return Js(g),null}else 2*ce()-j.renderingStartTime>iS&&_!==536870912&&(g.flags|=128,A=!0,dv(j,!1),g.lanes=4194304);j.isBackwards?(q.sibling=g.child,g.child=q):(p=j.last,p!==null?p.sibling=q:g.child=q,j.last=q)}return j.tail!==null?(g=j.tail,j.rendering=g,j.tail=g.sibling,j.renderingStartTime=ce(),g.sibling=null,p=Li.current,se(Li,A?p&1|2:p&1),g):(Js(g),null);case 22:case 23:return ud(g),KA(),A=g.memoizedState!==null,p!==null?p.memoizedState!==null!==A&&(g.flags|=8192):A&&(g.flags|=8192),A?(_&536870912)!==0&&(g.flags&128)===0&&(Js(g),g.subtreeFlags&6&&(g.flags|=8192)):Js(g),_=g.updateQueue,_!==null&&nS(g,_.retryQueue),_=null,p!==null&&p.memoizedState!==null&&p.memoizedState.cachePool!==null&&(_=p.memoizedState.cachePool.pool),A=null,g.memoizedState!==null&&g.memoizedState.cachePool!==null&&(A=g.memoizedState.cachePool.pool),A!==_&&(g.flags|=2048),p!==null&&ee(Ap),null;case 24:return _=null,p!==null&&(_=p.memoizedState.cache),g.memoizedState.cache!==_&&(g.flags|=2048),ld(Fi),Js(g),null;case 25:return null;case 30:return null}throw Error(r(156,g.tag))}function afe(p,g){switch(OA(g),g.tag){case 1:return p=g.flags,p&65536?(g.flags=p&-65537|128,g):null;case 3:return ld(Fi),Ce(),p=g.flags,(p&65536)!==0&&(p&128)===0?(g.flags=p&-65537|128,g):null;case 26:case 27:case 5:return Qe(g),null;case 13:if(ud(g),p=g.memoizedState,p!==null&&p.dehydrated!==null){if(g.alternate===null)throw Error(r(340));Yb()}return p=g.flags,p&65536?(g.flags=p&-65537|128,g):null;case 19:return ee(Li),null;case 4:return Ce(),null;case 10:return ld(g.type),null;case 22:case 23:return ud(g),KA(),p!==null&&ee(Ap),p=g.flags,p&65536?(g.flags=p&-65537|128,g):null;case 24:return ld(Fi),null;case 25:return null;default:return null}}function z8(p,g){switch(OA(g),g.tag){case 3:ld(Fi),Ce();break;case 26:case 27:case 5:Qe(g);break;case 4:Ce();break;case 13:ud(g);break;case 19:ee(Li);break;case 10:ld(g.type);break;case 22:case 23:ud(g),KA(),p!==null&&ee(Ap);break;case 24:ld(Fi)}}function fv(p,g){try{var _=g.updateQueue,A=_!==null?_.lastEffect:null;if(A!==null){var j=A.next;_=j;do{if((_.tag&p)===p){A=void 0;var q=_.create,he=_.inst;A=q(),he.destroy=A}_=_.next}while(_!==j)}}catch(je){Ms(g,g.return,je)}}function Df(p,g,_){try{var A=g.updateQueue,j=A!==null?A.lastEffect:null;if(j!==null){var q=j.next;A=q;do{if((A.tag&p)===p){var he=A.inst,je=he.destroy;if(je!==void 0){he.destroy=void 0,j=g;var Ye=_,St=je;try{St()}catch(Dt){Ms(j,Ye,Dt)}}}A=A.next}while(A!==q)}}catch(Dt){Ms(g,g.return,Dt)}}function U8(p){var g=p.updateQueue;if(g!==null){var _=p.stateNode;try{R5(g,_)}catch(A){Ms(p,p.return,A)}}}function q8(p,g,_){_.props=Np(p.type,p.memoizedProps),_.state=p.memoizedState;try{_.componentWillUnmount()}catch(A){Ms(p,g,A)}}function hv(p,g){try{var _=p.ref;if(_!==null){switch(p.tag){case 26:case 27:case 5:var A=p.stateNode;break;case 30:A=p.stateNode;break;default:A=p.stateNode}typeof _=="function"?p.refCleanup=_(A):_.current=A}}catch(j){Ms(p,g,j)}}function eu(p,g){var _=p.ref,A=p.refCleanup;if(_!==null)if(typeof A=="function")try{A()}catch(j){Ms(p,g,j)}finally{p.refCleanup=null,p=p.alternate,p!=null&&(p.refCleanup=null)}else if(typeof _=="function")try{_(null)}catch(j){Ms(p,g,j)}else _.current=null}function V8(p){var g=p.type,_=p.memoizedProps,A=p.stateNode;try{e:switch(g){case"button":case"input":case"select":case"textarea":_.autoFocus&&A.focus();break e;case"img":_.src?A.src=_.src:_.srcSet&&(A.srcset=_.srcSet)}}catch(j){Ms(p,p.return,j)}}function _R(p,g,_){try{var A=p.stateNode;Tfe(A,p.type,_,g),A[De]=g}catch(j){Ms(p,p.return,j)}}function W8(p){return p.tag===5||p.tag===3||p.tag===26||p.tag===27&&Vf(p.type)||p.tag===4}function SR(p){e:for(;;){for(;p.sibling===null;){if(p.return===null||W8(p.return))return null;p=p.return}for(p.sibling.return=p.return,p=p.sibling;p.tag!==5&&p.tag!==6&&p.tag!==18;){if(p.tag===27&&Vf(p.type)||p.flags&2||p.child===null||p.tag===4)continue e;p.child.return=p,p=p.child}if(!(p.flags&2))return p.stateNode}}function CR(p,g,_){var A=p.tag;if(A===5||A===6)p=p.stateNode,g?(_.nodeType===9?_.body:_.nodeName==="HTML"?_.ownerDocument.body:_).insertBefore(p,g):(g=_.nodeType===9?_.body:_.nodeName==="HTML"?_.ownerDocument.body:_,g.appendChild(p),_=_._reactRootContainer,_!=null||g.onclick!==null||(g.onclick=pS));else if(A!==4&&(A===27&&Vf(p.type)&&(_=p.stateNode,g=null),p=p.child,p!==null))for(CR(p,g,_),p=p.sibling;p!==null;)CR(p,g,_),p=p.sibling}function rS(p,g,_){var A=p.tag;if(A===5||A===6)p=p.stateNode,g?_.insertBefore(p,g):_.appendChild(p);else if(A!==4&&(A===27&&Vf(p.type)&&(_=p.stateNode),p=p.child,p!==null))for(rS(p,g,_),p=p.sibling;p!==null;)rS(p,g,_),p=p.sibling}function H8(p){var g=p.stateNode,_=p.memoizedProps;try{for(var A=p.type,j=g.attributes;j.length;)g.removeAttributeNode(j[0]);ya(g,A,_),g[xe]=p,g[De]=_}catch(q){Ms(p,p.return,q)}}var hd=!1,pi=!1,kR=!1,G8=typeof WeakSet=="function"?WeakSet:Set,Qi=null;function ofe(p,g){if(p=p.containerInfo,YR=wS,p=me(p),Ae(p)){if("selectionStart"in p)var _={start:p.selectionStart,end:p.selectionEnd};else e:{_=(_=p.ownerDocument)&&_.defaultView||window;var A=_.getSelection&&_.getSelection();if(A&&A.rangeCount!==0){_=A.anchorNode;var j=A.anchorOffset,q=A.focusNode;A=A.focusOffset;try{_.nodeType,q.nodeType}catch{_=null;break e}var he=0,je=-1,Ye=-1,St=0,Dt=0,Bt=p,Et=null;t:for(;;){for(var Rt;Bt!==_||j!==0&&Bt.nodeType!==3||(je=he+j),Bt!==q||A!==0&&Bt.nodeType!==3||(Ye=he+A),Bt.nodeType===3&&(he+=Bt.nodeValue.length),(Rt=Bt.firstChild)!==null;)Et=Bt,Bt=Rt;for(;;){if(Bt===p)break t;if(Et===_&&++St===j&&(je=he),Et===q&&++Dt===A&&(Ye=he),(Rt=Bt.nextSibling)!==null)break;Bt=Et,Et=Bt.parentNode}Bt=Rt}_=je===-1||Ye===-1?null:{start:je,end:Ye}}else _=null}_=_||{start:0,end:0}}else _=null;for(ZR={focusedElem:p,selectionRange:_},wS=!1,Qi=g;Qi!==null;)if(g=Qi,p=g.child,(g.subtreeFlags&1024)!==0&&p!==null)p.return=g,Qi=p;else for(;Qi!==null;){switch(g=Qi,q=g.alternate,p=g.flags,g.tag){case 0:break;case 11:case 15:break;case 1:if((p&1024)!==0&&q!==null){p=void 0,_=g,j=q.memoizedProps,q=q.memoizedState,A=_.stateNode;try{var ar=Np(_.type,j,_.elementType===_.type);p=A.getSnapshotBeforeUpdate(ar,q),A.__reactInternalSnapshotBeforeUpdate=p}catch(Wn){Ms(_,_.return,Wn)}}break;case 3:if((p&1024)!==0){if(p=g.stateNode.containerInfo,_=p.nodeType,_===9)QR(p);else if(_===1)switch(p.nodeName){case"HEAD":case"HTML":case"BODY":QR(p);break;default:p.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((p&1024)!==0)throw Error(r(163))}if(p=g.sibling,p!==null){p.return=g.return,Qi=p;break}Qi=g.return}}function K8(p,g,_){var A=_.flags;switch(_.tag){case 0:case 11:case 15:Ff(p,_),A&4&&fv(5,_);break;case 1:if(Ff(p,_),A&4)if(p=_.stateNode,g===null)try{p.componentDidMount()}catch(he){Ms(_,_.return,he)}else{var j=Np(_.type,g.memoizedProps);g=g.memoizedState;try{p.componentDidUpdate(j,g,p.__reactInternalSnapshotBeforeUpdate)}catch(he){Ms(_,_.return,he)}}A&64&&U8(_),A&512&&hv(_,_.return);break;case 3:if(Ff(p,_),A&64&&(p=_.updateQueue,p!==null)){if(g=null,_.child!==null)switch(_.child.tag){case 27:case 5:g=_.child.stateNode;break;case 1:g=_.child.stateNode}try{R5(p,g)}catch(he){Ms(_,_.return,he)}}break;case 27:g===null&&A&4&&H8(_);case 26:case 5:Ff(p,_),g===null&&A&4&&V8(_),A&512&&hv(_,_.return);break;case 12:Ff(p,_);break;case 13:Ff(p,_),A&4&&X8(p,_),A&64&&(p=_.memoizedState,p!==null&&(p=p.dehydrated,p!==null&&(_=gfe.bind(null,_),Ofe(p,_))));break;case 22:if(A=_.memoizedState!==null||hd,!A){g=g!==null&&g.memoizedState!==null||pi,j=hd;var q=pi;hd=A,(pi=g)&&!q?Lf(p,_,(_.subtreeFlags&8772)!==0):Ff(p,_),hd=j,pi=q}break;case 30:break;default:Ff(p,_)}}function Y8(p){var g=p.alternate;g!==null&&(p.alternate=null,Y8(g)),p.child=null,p.deletions=null,p.sibling=null,p.tag===5&&(g=p.stateNode,g!==null&&un(g)),p.stateNode=null,p.return=null,p.dependencies=null,p.memoizedProps=null,p.memoizedState=null,p.pendingProps=null,p.stateNode=null,p.updateQueue=null}var Gs=null,yo=!1;function pd(p,g,_){for(_=_.child;_!==null;)Z8(p,g,_),_=_.sibling}function Z8(p,g,_){if(qt&&typeof qt.onCommitFiberUnmount=="function")try{qt.onCommitFiberUnmount(jt,_)}catch{}switch(_.tag){case 26:pi||eu(_,g),pd(p,g,_),_.memoizedState?_.memoizedState.count--:_.stateNode&&(_=_.stateNode,_.parentNode.removeChild(_));break;case 27:pi||eu(_,g);var A=Gs,j=yo;Vf(_.type)&&(Gs=_.stateNode,yo=!1),pd(p,g,_),_v(_.stateNode),Gs=A,yo=j;break;case 5:pi||eu(_,g);case 6:if(A=Gs,j=yo,Gs=null,pd(p,g,_),Gs=A,yo=j,Gs!==null)if(yo)try{(Gs.nodeType===9?Gs.body:Gs.nodeName==="HTML"?Gs.ownerDocument.body:Gs).removeChild(_.stateNode)}catch(q){Ms(_,g,q)}else try{Gs.removeChild(_.stateNode)}catch(q){Ms(_,g,q)}break;case 18:Gs!==null&&(yo?(p=Gs,LL(p.nodeType===9?p.body:p.nodeName==="HTML"?p.ownerDocument.body:p,_.stateNode),Nv(p)):LL(Gs,_.stateNode));break;case 4:A=Gs,j=yo,Gs=_.stateNode.containerInfo,yo=!0,pd(p,g,_),Gs=A,yo=j;break;case 0:case 11:case 14:case 15:pi||Df(2,_,g),pi||Df(4,_,g),pd(p,g,_);break;case 1:pi||(eu(_,g),A=_.stateNode,typeof A.componentWillUnmount=="function"&&q8(_,g,A)),pd(p,g,_);break;case 21:pd(p,g,_);break;case 22:pi=(A=pi)||_.memoizedState!==null,pd(p,g,_),pi=A;break;default:pd(p,g,_)}}function X8(p,g){if(g.memoizedState===null&&(p=g.alternate,p!==null&&(p=p.memoizedState,p!==null&&(p=p.dehydrated,p!==null))))try{Nv(p)}catch(_){Ms(g,g.return,_)}}function lfe(p){switch(p.tag){case 13:case 19:var g=p.stateNode;return g===null&&(g=p.stateNode=new G8),g;case 22:return p=p.stateNode,g=p._retryCache,g===null&&(g=p._retryCache=new G8),g;default:throw Error(r(435,p.tag))}}function ER(p,g){var _=lfe(p);g.forEach(function(A){var j=yfe.bind(null,p,A);_.has(A)||(_.add(A),A.then(j,j))})}function Zo(p,g){var _=g.deletions;if(_!==null)for(var A=0;A<_.length;A++){var j=_[A],q=p,he=g,je=he;e:for(;je!==null;){switch(je.tag){case 27:if(Vf(je.type)){Gs=je.stateNode,yo=!1;break e}break;case 5:Gs=je.stateNode,yo=!1;break e;case 3:case 4:Gs=je.stateNode.containerInfo,yo=!0;break e}je=je.return}if(Gs===null)throw Error(r(160));Z8(q,he,j),Gs=null,yo=!1,q=j.alternate,q!==null&&(q.return=null),j.return=null}if(g.subtreeFlags&13878)for(g=g.child;g!==null;)J8(g,p),g=g.sibling}var uc=null;function J8(p,g){var _=p.alternate,A=p.flags;switch(p.tag){case 0:case 11:case 14:case 15:Zo(g,p),Xo(p),A&4&&(Df(3,p,p.return),fv(3,p),Df(5,p,p.return));break;case 1:Zo(g,p),Xo(p),A&512&&(pi||_===null||eu(_,_.return)),A&64&&hd&&(p=p.updateQueue,p!==null&&(A=p.callbacks,A!==null&&(_=p.shared.hiddenCallbacks,p.shared.hiddenCallbacks=_===null?A:_.concat(A))));break;case 26:var j=uc;if(Zo(g,p),Xo(p),A&512&&(pi||_===null||eu(_,_.return)),A&4){var q=_!==null?_.memoizedState:null;if(A=p.memoizedState,_===null)if(A===null)if(p.stateNode===null){e:{A=p.type,_=p.memoizedProps,j=j.ownerDocument||j;t:switch(A){case"title":q=j.getElementsByTagName("title")[0],(!q||q[nn]||q[xe]||q.namespaceURI==="http://www.w3.org/2000/svg"||q.hasAttribute("itemprop"))&&(q=j.createElement(A),j.head.insertBefore(q,j.querySelector("head > title"))),ya(q,A,_),q[xe]=p,kr(q),A=q;break e;case"link":var he=HL("link","href",j).get(A+(_.href||""));if(he){for(var je=0;je<he.length;je++)if(q=he[je],q.getAttribute("href")===(_.href==null||_.href===""?null:_.href)&&q.getAttribute("rel")===(_.rel==null?null:_.rel)&&q.getAttribute("title")===(_.title==null?null:_.title)&&q.getAttribute("crossorigin")===(_.crossOrigin==null?null:_.crossOrigin)){he.splice(je,1);break t}}q=j.createElement(A),ya(q,A,_),j.head.appendChild(q);break;case"meta":if(he=HL("meta","content",j).get(A+(_.content||""))){for(je=0;je<he.length;je++)if(q=he[je],q.getAttribute("content")===(_.content==null?null:""+_.content)&&q.getAttribute("name")===(_.name==null?null:_.name)&&q.getAttribute("property")===(_.property==null?null:_.property)&&q.getAttribute("http-equiv")===(_.httpEquiv==null?null:_.httpEquiv)&&q.getAttribute("charset")===(_.charSet==null?null:_.charSet)){he.splice(je,1);break t}}q=j.createElement(A),ya(q,A,_),j.head.appendChild(q);break;default:throw Error(r(468,A))}q[xe]=p,kr(q),A=q}p.stateNode=A}else GL(j,p.type,p.stateNode);else p.stateNode=WL(j,A,p.memoizedProps);else q!==A?(q===null?_.stateNode!==null&&(_=_.stateNode,_.parentNode.removeChild(_)):q.count--,A===null?GL(j,p.type,p.stateNode):WL(j,A,p.memoizedProps)):A===null&&p.stateNode!==null&&_R(p,p.memoizedProps,_.memoizedProps)}break;case 27:Zo(g,p),Xo(p),A&512&&(pi||_===null||eu(_,_.return)),_!==null&&A&4&&_R(p,p.memoizedProps,_.memoizedProps);break;case 5:if(Zo(g,p),Xo(p),A&512&&(pi||_===null||eu(_,_.return)),p.flags&32){j=p.stateNode;try{vf(j,"")}catch(Rt){Ms(p,p.return,Rt)}}A&4&&p.stateNode!=null&&(j=p.memoizedProps,_R(p,j,_!==null?_.memoizedProps:j)),A&1024&&(kR=!0);break;case 6:if(Zo(g,p),Xo(p),A&4){if(p.stateNode===null)throw Error(r(162));A=p.memoizedProps,_=p.stateNode;try{_.nodeValue=A}catch(Rt){Ms(p,p.return,Rt)}}break;case 3:if(bS=null,j=uc,uc=gS(g.containerInfo),Zo(g,p),uc=j,Xo(p),A&4&&_!==null&&_.memoizedState.isDehydrated)try{Nv(g.containerInfo)}catch(Rt){Ms(p,p.return,Rt)}kR&&(kR=!1,Q8(p));break;case 4:A=uc,uc=gS(p.stateNode.containerInfo),Zo(g,p),Xo(p),uc=A;break;case 12:Zo(g,p),Xo(p);break;case 13:Zo(g,p),Xo(p),p.child.flags&8192&&p.memoizedState!==null!=(_!==null&&_.memoizedState!==null)&&(IR=ce()),A&4&&(A=p.updateQueue,A!==null&&(p.updateQueue=null,ER(p,A)));break;case 22:j=p.memoizedState!==null;var Ye=_!==null&&_.memoizedState!==null,St=hd,Dt=pi;if(hd=St||j,pi=Dt||Ye,Zo(g,p),pi=Dt,hd=St,Xo(p),A&8192)e:for(g=p.stateNode,g._visibility=j?g._visibility&-2:g._visibility|1,j&&(_===null||Ye||hd||pi||Mp(p)),_=null,g=p;;){if(g.tag===5||g.tag===26){if(_===null){Ye=_=g;try{if(q=Ye.stateNode,j)he=q.style,typeof he.setProperty=="function"?he.setProperty("display","none","important"):he.display="none";else{je=Ye.stateNode;var Bt=Ye.memoizedProps.style,Et=Bt!=null&&Bt.hasOwnProperty("display")?Bt.display:null;je.style.display=Et==null||typeof Et=="boolean"?"":(""+Et).trim()}}catch(Rt){Ms(Ye,Ye.return,Rt)}}}else if(g.tag===6){if(_===null){Ye=g;try{Ye.stateNode.nodeValue=j?"":Ye.memoizedProps}catch(Rt){Ms(Ye,Ye.return,Rt)}}}else if((g.tag!==22&&g.tag!==23||g.memoizedState===null||g===p)&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===p)break e;for(;g.sibling===null;){if(g.return===null||g.return===p)break e;_===g&&(_=null),g=g.return}_===g&&(_=null),g.sibling.return=g.return,g=g.sibling}A&4&&(A=p.updateQueue,A!==null&&(_=A.retryQueue,_!==null&&(A.retryQueue=null,ER(p,_))));break;case 19:Zo(g,p),Xo(p),A&4&&(A=p.updateQueue,A!==null&&(p.updateQueue=null,ER(p,A)));break;case 30:break;case 21:break;default:Zo(g,p),Xo(p)}}function Xo(p){var g=p.flags;if(g&2){try{for(var _,A=p.return;A!==null;){if(W8(A)){_=A;break}A=A.return}if(_==null)throw Error(r(160));switch(_.tag){case 27:var j=_.stateNode,q=SR(p);rS(p,q,j);break;case 5:var he=_.stateNode;_.flags&32&&(vf(he,""),_.flags&=-33);var je=SR(p);rS(p,je,he);break;case 3:case 4:var Ye=_.stateNode.containerInfo,St=SR(p);CR(p,St,Ye);break;default:throw Error(r(161))}}catch(Dt){Ms(p,p.return,Dt)}p.flags&=-3}g&4096&&(p.flags&=-4097)}function Q8(p){if(p.subtreeFlags&1024)for(p=p.child;p!==null;){var g=p;Q8(g),g.tag===5&&g.flags&1024&&g.stateNode.reset(),p=p.sibling}}function Ff(p,g){if(g.subtreeFlags&8772)for(g=g.child;g!==null;)K8(p,g.alternate,g),g=g.sibling}function Mp(p){for(p=p.child;p!==null;){var g=p;switch(g.tag){case 0:case 11:case 14:case 15:Df(4,g,g.return),Mp(g);break;case 1:eu(g,g.return);var _=g.stateNode;typeof _.componentWillUnmount=="function"&&q8(g,g.return,_),Mp(g);break;case 27:_v(g.stateNode);case 26:case 5:eu(g,g.return),Mp(g);break;case 22:g.memoizedState===null&&Mp(g);break;case 30:Mp(g);break;default:Mp(g)}p=p.sibling}}function Lf(p,g,_){for(_=_&&(g.subtreeFlags&8772)!==0,g=g.child;g!==null;){var A=g.alternate,j=p,q=g,he=q.flags;switch(q.tag){case 0:case 11:case 15:Lf(j,q,_),fv(4,q);break;case 1:if(Lf(j,q,_),A=q,j=A.stateNode,typeof j.componentDidMount=="function")try{j.componentDidMount()}catch(St){Ms(A,A.return,St)}if(A=q,j=A.updateQueue,j!==null){var je=A.stateNode;try{var Ye=j.shared.hiddenCallbacks;if(Ye!==null)for(j.shared.hiddenCallbacks=null,j=0;j<Ye.length;j++)A5(Ye[j],je)}catch(St){Ms(A,A.return,St)}}_&&he&64&&U8(q),hv(q,q.return);break;case 27:H8(q);case 26:case 5:Lf(j,q,_),_&&A===null&&he&4&&V8(q),hv(q,q.return);break;case 12:Lf(j,q,_);break;case 13:Lf(j,q,_),_&&he&4&&X8(j,q);break;case 22:q.memoizedState===null&&Lf(j,q,_),hv(q,q.return);break;case 30:break;default:Lf(j,q,_)}g=g.sibling}}function TR(p,g){var _=null;p!==null&&p.memoizedState!==null&&p.memoizedState.cachePool!==null&&(_=p.memoizedState.cachePool.pool),p=null,g.memoizedState!==null&&g.memoizedState.cachePool!==null&&(p=g.memoizedState.cachePool.pool),p!==_&&(p!=null&&p.refCount++,_!=null&&Jb(_))}function AR(p,g){p=null,g.alternate!==null&&(p=g.alternate.memoizedState.cache),g=g.memoizedState.cache,g!==p&&(g.refCount++,p!=null&&Jb(p))}function tu(p,g,_,A){if(g.subtreeFlags&10256)for(g=g.child;g!==null;)eL(p,g,_,A),g=g.sibling}function eL(p,g,_,A){var j=g.flags;switch(g.tag){case 0:case 11:case 15:tu(p,g,_,A),j&2048&&fv(9,g);break;case 1:tu(p,g,_,A);break;case 3:tu(p,g,_,A),j&2048&&(p=null,g.alternate!==null&&(p=g.alternate.memoizedState.cache),g=g.memoizedState.cache,g!==p&&(g.refCount++,p!=null&&Jb(p)));break;case 12:if(j&2048){tu(p,g,_,A),p=g.stateNode;try{var q=g.memoizedProps,he=q.id,je=q.onPostCommit;typeof je=="function"&&je(he,g.alternate===null?"mount":"update",p.passiveEffectDuration,-0)}catch(Ye){Ms(g,g.return,Ye)}}else tu(p,g,_,A);break;case 13:tu(p,g,_,A);break;case 23:break;case 22:q=g.stateNode,he=g.alternate,g.memoizedState!==null?q._visibility&2?tu(p,g,_,A):pv(p,g):q._visibility&2?tu(p,g,_,A):(q._visibility|=2,Lg(p,g,_,A,(g.subtreeFlags&10256)!==0)),j&2048&&TR(he,g);break;case 24:tu(p,g,_,A),j&2048&&AR(g.alternate,g);break;default:tu(p,g,_,A)}}function Lg(p,g,_,A,j){for(j=j&&(g.subtreeFlags&10256)!==0,g=g.child;g!==null;){var q=p,he=g,je=_,Ye=A,St=he.flags;switch(he.tag){case 0:case 11:case 15:Lg(q,he,je,Ye,j),fv(8,he);break;case 23:break;case 22:var Dt=he.stateNode;he.memoizedState!==null?Dt._visibility&2?Lg(q,he,je,Ye,j):pv(q,he):(Dt._visibility|=2,Lg(q,he,je,Ye,j)),j&&St&2048&&TR(he.alternate,he);break;case 24:Lg(q,he,je,Ye,j),j&&St&2048&&AR(he.alternate,he);break;default:Lg(q,he,je,Ye,j)}g=g.sibling}}function pv(p,g){if(g.subtreeFlags&10256)for(g=g.child;g!==null;){var _=p,A=g,j=A.flags;switch(A.tag){case 22:pv(_,A),j&2048&&TR(A.alternate,A);break;case 24:pv(_,A),j&2048&&AR(A.alternate,A);break;default:pv(_,A)}g=g.sibling}}var mv=8192;function Bg(p){if(p.subtreeFlags&mv)for(p=p.child;p!==null;)tL(p),p=p.sibling}function tL(p){switch(p.tag){case 26:Bg(p),p.flags&mv&&p.memoizedState!==null&&Gfe(uc,p.memoizedState,p.memoizedProps);break;case 5:Bg(p);break;case 3:case 4:var g=uc;uc=gS(p.stateNode.containerInfo),Bg(p),uc=g;break;case 22:p.memoizedState===null&&(g=p.alternate,g!==null&&g.memoizedState!==null?(g=mv,mv=16777216,Bg(p),mv=g):Bg(p));break;default:Bg(p)}}function nL(p){var g=p.alternate;if(g!==null&&(p=g.child,p!==null)){g.child=null;do g=p.sibling,p.sibling=null,p=g;while(p!==null)}}function gv(p){var g=p.deletions;if((p.flags&16)!==0){if(g!==null)for(var _=0;_<g.length;_++){var A=g[_];Qi=A,sL(A,p)}nL(p)}if(p.subtreeFlags&10256)for(p=p.child;p!==null;)rL(p),p=p.sibling}function rL(p){switch(p.tag){case 0:case 11:case 15:gv(p),p.flags&2048&&Df(9,p,p.return);break;case 3:gv(p);break;case 12:gv(p);break;case 22:var g=p.stateNode;p.memoizedState!==null&&g._visibility&2&&(p.return===null||p.return.tag!==13)?(g._visibility&=-3,sS(p)):gv(p);break;default:gv(p)}}function sS(p){var g=p.deletions;if((p.flags&16)!==0){if(g!==null)for(var _=0;_<g.length;_++){var A=g[_];Qi=A,sL(A,p)}nL(p)}for(p=p.child;p!==null;){switch(g=p,g.tag){case 0:case 11:case 15:Df(8,g,g.return),sS(g);break;case 22:_=g.stateNode,_._visibility&2&&(_._visibility&=-3,sS(g));break;default:sS(g)}p=p.sibling}}function sL(p,g){for(;Qi!==null;){var _=Qi;switch(_.tag){case 0:case 11:case 15:Df(8,_,g);break;case 23:case 22:if(_.memoizedState!==null&&_.memoizedState.cachePool!==null){var A=_.memoizedState.cachePool.pool;A!=null&&A.refCount++}break;case 24:Jb(_.memoizedState.cache)}if(A=_.child,A!==null)A.return=_,Qi=A;else e:for(_=p;Qi!==null;){A=Qi;var j=A.sibling,q=A.return;if(Y8(A),A===_){Qi=null;break e}if(j!==null){j.return=q,Qi=j;break e}Qi=q}}}var cfe={getCacheForType:function(p){var g=Ra(Fi),_=g.data.get(p);return _===void 0&&(_=p(),g.data.set(p,_)),_}},ufe=typeof WeakMap=="function"?WeakMap:Map,ys=0,Ps=null,Fr=null,Gr=0,bs=0,Jo=null,Bf=!1,$g=!1,RR=!1,md=0,oi=0,$f=0,Ip=0,NR=0,Rl=0,zg=0,yv=null,bo=null,MR=!1,IR=0,iS=1/0,aS=null,zf=null,ga=0,Uf=null,Ug=null,qg=0,jR=0,OR=null,iL=null,bv=0,PR=null;function Qo(){if((ys&2)!==0&&Gr!==0)return Gr&-Gr;if(U.T!==null){var p=Ng;return p!==0?p:UR()}return Y()}function aL(){Rl===0&&(Rl=(Gr&536870912)===0||ss?et():536870912);var p=Al.current;return p!==null&&(p.flags|=32),Rl}function el(p,g,_){(p===Ps&&(bs===2||bs===9)||p.cancelPendingCommit!==null)&&(Vg(p,0),qf(p,Gr,Rl,!1)),tt(p,_),((ys&2)===0||p!==Ps)&&(p===Ps&&((ys&2)===0&&(Ip|=_),oi===4&&qf(p,Gr,Rl,!1)),nu(p))}function oL(p,g,_){if((ys&6)!==0)throw Error(r(327));var A=!_&&(g&124)===0&&(g&p.expiredLanes)===0||le(p,g),j=A?hfe(p,g):LR(p,g,!0),q=A;do{if(j===0){$g&&!A&&qf(p,g,0,!1);break}else{if(_=p.current.alternate,q&&!dfe(_)){j=LR(p,g,!1),q=!1;continue}if(j===2){if(q=g,p.errorRecoveryDisabledLanes&q)var he=0;else he=p.pendingLanes&-536870913,he=he!==0?he:he&536870912?536870912:0;if(he!==0){g=he;e:{var je=p;j=yv;var Ye=je.current.memoizedState.isDehydrated;if(Ye&&(Vg(je,he).flags|=256),he=LR(je,he,!1),he!==2){if(RR&&!Ye){je.errorRecoveryDisabledLanes|=q,Ip|=q,j=4;break e}q=bo,bo=j,q!==null&&(bo===null?bo=q:bo.push.apply(bo,q))}j=he}if(q=!1,j!==2)continue}}if(j===1){Vg(p,0),qf(p,g,0,!0);break}e:{switch(A=p,q=j,q){case 0:case 1:throw Error(r(345));case 4:if((g&4194048)!==g)break;case 6:qf(A,g,Rl,!Bf);break e;case 2:bo=null;break;case 3:case 5:break;default:throw Error(r(329))}if((g&62914560)===g&&(j=IR+300-ce(),10<j)){if(qf(A,g,Rl,!Bf),Ee(A,0,!0)!==0)break e;A.timeoutHandle=DL(lL.bind(null,A,_,bo,aS,MR,g,Rl,Ip,zg,Bf,q,2,-0,0),j);break e}lL(A,_,bo,aS,MR,g,Rl,Ip,zg,Bf,q,0,-0,0)}}break}while(!0);nu(p)}function lL(p,g,_,A,j,q,he,je,Ye,St,Dt,Bt,Et,Rt){if(p.timeoutHandle=-1,Bt=g.subtreeFlags,(Bt&8192||(Bt&16785408)===16785408)&&(kv={stylesheets:null,count:0,unsuspend:Hfe},tL(g),Bt=Kfe(),Bt!==null)){p.cancelPendingCommit=Bt(mL.bind(null,p,g,q,_,A,j,he,je,Ye,Dt,1,Et,Rt)),qf(p,q,he,!St);return}mL(p,g,q,_,A,j,he,je,Ye)}function dfe(p){for(var g=p;;){var _=g.tag;if((_===0||_===11||_===15)&&g.flags&16384&&(_=g.updateQueue,_!==null&&(_=_.stores,_!==null)))for(var A=0;A<_.length;A++){var j=_[A],q=j.getSnapshot;j=j.value;try{if(!Aa(q(),j))return!1}catch{return!1}}if(_=g.child,g.subtreeFlags&16384&&_!==null)_.return=g,g=_;else{if(g===p)break;for(;g.sibling===null;){if(g.return===null||g.return===p)return!0;g=g.return}g.sibling.return=g.return,g=g.sibling}}return!0}function qf(p,g,_,A){g&=~NR,g&=~Ip,p.suspendedLanes|=g,p.pingedLanes&=~g,A&&(p.warmLanes|=g),A=p.expirationTimes;for(var j=g;0<j;){var q=31-Ht(j),he=1<<q;A[q]=-1,j&=~he}_!==0&&_e(p,_,g)}function oS(){return(ys&6)===0?(vv(0),!1):!0}function DR(){if(Fr!==null){if(bs===0)var p=Fr.return;else p=Fr,od=Ep=null,QA(p),Dg=null,cv=0,p=Fr;for(;p!==null;)z8(p.alternate,p),p=p.return;Fr=null}}function Vg(p,g){var _=p.timeoutHandle;_!==-1&&(p.timeoutHandle=-1,Rfe(_)),_=p.cancelPendingCommit,_!==null&&(p.cancelPendingCommit=null,_()),DR(),Ps=p,Fr=_=sd(p.current,null),Gr=g,bs=0,Jo=null,Bf=!1,$g=le(p,g),RR=!1,zg=Rl=NR=Ip=$f=oi=0,bo=yv=null,MR=!1,(g&8)!==0&&(g|=g&32);var A=p.entangledLanes;if(A!==0)for(p=p.entanglements,A&=g;0<A;){var j=31-Ht(A),q=1<<j;g|=p[j],A&=~q}return md=g,ir(),_}function cL(p,g){Ir=null,U.H=K_,g===ev||g===L_?(g=E5(),bs=3):g===S5?(g=E5(),bs=4):bs=g===T8?8:g!==null&&typeof g=="object"&&typeof g.then=="function"?6:1,Jo=g,Fr===null&&(oi=1,Q_(p,$n(g,p.current)))}function uL(){var p=U.H;return U.H=K_,p===null?K_:p}function dL(){var p=U.A;return U.A=cfe,p}function FR(){oi=4,Bf||(Gr&4194048)!==Gr&&Al.current!==null||($g=!0),($f&134217727)===0&&(Ip&134217727)===0||Ps===null||qf(Ps,Gr,Rl,!1)}function LR(p,g,_){var A=ys;ys|=2;var j=uL(),q=dL();(Ps!==p||Gr!==g)&&(aS=null,Vg(p,g)),g=!1;var he=oi;e:do try{if(bs!==0&&Fr!==null){var je=Fr,Ye=Jo;switch(bs){case 8:DR(),he=6;break e;case 3:case 2:case 9:case 6:Al.current===null&&(g=!0);var St=bs;if(bs=0,Jo=null,Wg(p,je,Ye,St),_&&$g){he=0;break e}break;default:St=bs,bs=0,Jo=null,Wg(p,je,Ye,St)}}ffe(),he=oi;break}catch(Dt){cL(p,Dt)}while(!0);return g&&p.shellSuspendCounter++,od=Ep=null,ys=A,U.H=j,U.A=q,Fr===null&&(Ps=null,Gr=0,ir()),he}function ffe(){for(;Fr!==null;)fL(Fr)}function hfe(p,g){var _=ys;ys|=2;var A=uL(),j=dL();Ps!==p||Gr!==g?(aS=null,iS=ce()+500,Vg(p,g)):$g=le(p,g);e:do try{if(bs!==0&&Fr!==null){g=Fr;var q=Jo;t:switch(bs){case 1:bs=0,Jo=null,Wg(p,g,q,1);break;case 2:case 9:if(C5(q)){bs=0,Jo=null,hL(g);break}g=function(){bs!==2&&bs!==9||Ps!==p||(bs=7),nu(p)},q.then(g,g);break e;case 3:bs=7;break e;case 4:bs=5;break e;case 7:C5(q)?(bs=0,Jo=null,hL(g)):(bs=0,Jo=null,Wg(p,g,q,7));break;case 5:var he=null;switch(Fr.tag){case 26:he=Fr.memoizedState;case 5:case 27:var je=Fr;if(!he||KL(he)){bs=0,Jo=null;var Ye=je.sibling;if(Ye!==null)Fr=Ye;else{var St=je.return;St!==null?(Fr=St,lS(St)):Fr=null}break t}}bs=0,Jo=null,Wg(p,g,q,5);break;case 6:bs=0,Jo=null,Wg(p,g,q,6);break;case 8:DR(),oi=6;break e;default:throw Error(r(462))}}pfe();break}catch(Dt){cL(p,Dt)}while(!0);return od=Ep=null,U.H=A,U.A=j,ys=_,Fr!==null?0:(Ps=null,Gr=0,ir(),oi)}function pfe(){for(;Fr!==null&&!ye();)fL(Fr)}function fL(p){var g=B8(p.alternate,p,md);p.memoizedProps=p.pendingProps,g===null?lS(p):Fr=g}function hL(p){var g=p,_=g.alternate;switch(g.tag){case 15:case 0:g=j8(_,g,g.pendingProps,g.type,void 0,Gr);break;case 11:g=j8(_,g,g.pendingProps,g.type.render,g.ref,Gr);break;case 5:QA(g);default:z8(_,g),g=Fr=p5(g,md),g=B8(_,g,md)}p.memoizedProps=p.pendingProps,g===null?lS(p):Fr=g}function Wg(p,g,_,A){od=Ep=null,QA(g),Dg=null,cv=0;var j=g.return;try{if(rfe(p,j,g,_,Gr)){oi=1,Q_(p,$n(_,p.current)),Fr=null;return}}catch(q){if(j!==null)throw Fr=j,q;oi=1,Q_(p,$n(_,p.current)),Fr=null;return}g.flags&32768?(ss||A===1?p=!0:$g||(Gr&536870912)!==0?p=!1:(Bf=p=!0,(A===2||A===9||A===3||A===6)&&(A=Al.current,A!==null&&A.tag===13&&(A.flags|=16384))),pL(g,p)):lS(g)}function lS(p){var g=p;do{if((g.flags&32768)!==0){pL(g,Bf);return}p=g.return;var _=ife(g.alternate,g,md);if(_!==null){Fr=_;return}if(g=g.sibling,g!==null){Fr=g;return}Fr=g=p}while(g!==null);oi===0&&(oi=5)}function pL(p,g){do{var _=afe(p.alternate,p);if(_!==null){_.flags&=32767,Fr=_;return}if(_=p.return,_!==null&&(_.flags|=32768,_.subtreeFlags=0,_.deletions=null),!g&&(p=p.sibling,p!==null)){Fr=p;return}Fr=p=_}while(p!==null);oi=6,Fr=null}function mL(p,g,_,A,j,q,he,je,Ye){p.cancelPendingCommit=null;do cS();while(ga!==0);if((ys&6)!==0)throw Error(r(327));if(g!==null){if(g===p.current)throw Error(r(177));if(q=g.lanes|g.childLanes,q|=pa,ve(p,_,q,he,je,Ye),p===Ps&&(Fr=Ps=null,Gr=0),Ug=g,Uf=p,qg=_,jR=q,OR=j,iL=A,(g.subtreeFlags&10256)!==0||(g.flags&10256)!==0?(p.callbackNode=null,p.callbackPriority=0,bfe(Be,function(){return xL(),null})):(p.callbackNode=null,p.callbackPriority=0),A=(g.flags&13878)!==0,(g.subtreeFlags&13878)!==0||A){A=U.T,U.T=null,j=H.p,H.p=2,he=ys,ys|=4;try{ofe(p,g,_)}finally{ys=he,H.p=j,U.T=A}}ga=1,gL(),yL(),bL()}}function gL(){if(ga===1){ga=0;var p=Uf,g=Ug,_=(g.flags&13878)!==0;if((g.subtreeFlags&13878)!==0||_){_=U.T,U.T=null;var A=H.p;H.p=2;var j=ys;ys|=4;try{J8(g,p);var q=ZR,he=me(p.containerInfo),je=q.focusedElem,Ye=q.selectionRange;if(he!==je&&je&&je.ownerDocument&&ae(je.ownerDocument.documentElement,je)){if(Ye!==null&&Ae(je)){var St=Ye.start,Dt=Ye.end;if(Dt===void 0&&(Dt=St),"selectionStart"in je)je.selectionStart=St,je.selectionEnd=Math.min(Dt,je.value.length);else{var Bt=je.ownerDocument||document,Et=Bt&&Bt.defaultView||window;if(Et.getSelection){var Rt=Et.getSelection(),ar=je.textContent.length,Wn=Math.min(Ye.start,ar),Cs=Ye.end===void 0?Wn:Math.min(Ye.end,ar);!Rt.extend&&Wn>Cs&&(he=Cs,Cs=Wn,Wn=he);var pt=ne(je,Wn),it=ne(je,Cs);if(pt&&it&&(Rt.rangeCount!==1||Rt.anchorNode!==pt.node||Rt.anchorOffset!==pt.offset||Rt.focusNode!==it.node||Rt.focusOffset!==it.offset)){var wt=Bt.createRange();wt.setStart(pt.node,pt.offset),Rt.removeAllRanges(),Wn>Cs?(Rt.addRange(wt),Rt.extend(it.node,it.offset)):(wt.setEnd(it.node,it.offset),Rt.addRange(wt))}}}}for(Bt=[],Rt=je;Rt=Rt.parentNode;)Rt.nodeType===1&&Bt.push({element:Rt,left:Rt.scrollLeft,top:Rt.scrollTop});for(typeof je.focus=="function"&&je.focus(),je=0;je<Bt.length;je++){var Lt=Bt[je];Lt.element.scrollLeft=Lt.left,Lt.element.scrollTop=Lt.top}}wS=!!YR,ZR=YR=null}finally{ys=j,H.p=A,U.T=_}}p.current=g,ga=2}}function yL(){if(ga===2){ga=0;var p=Uf,g=Ug,_=(g.flags&8772)!==0;if((g.subtreeFlags&8772)!==0||_){_=U.T,U.T=null;var A=H.p;H.p=2;var j=ys;ys|=4;try{K8(p,g.alternate,g)}finally{ys=j,H.p=A,U.T=_}}ga=3}}function bL(){if(ga===4||ga===3){ga=0,Ne();var p=Uf,g=Ug,_=qg,A=iL;(g.subtreeFlags&10256)!==0||(g.flags&10256)!==0?ga=5:(ga=0,Ug=Uf=null,vL(p,p.pendingLanes));var j=p.pendingLanes;if(j===0&&(zf=null),fe(_),g=g.stateNode,qt&&typeof qt.onCommitFiberRoot=="function")try{qt.onCommitFiberRoot(jt,g,void 0,(g.current.flags&128)===128)}catch{}if(A!==null){g=U.T,j=H.p,H.p=2,U.T=null;try{for(var q=p.onRecoverableError,he=0;he<A.length;he++){var je=A[he];q(je.value,{componentStack:je.stack})}}finally{U.T=g,H.p=j}}(qg&3)!==0&&cS(),nu(p),j=p.pendingLanes,(_&4194090)!==0&&(j&42)!==0?p===PR?bv++:(bv=0,PR=p):bv=0,vv(0)}}function vL(p,g){(p.pooledCacheLanes&=g)===0&&(g=p.pooledCache,g!=null&&(p.pooledCache=null,Jb(g)))}function cS(p){return gL(),yL(),bL(),xL()}function xL(){if(ga!==5)return!1;var p=Uf,g=jR;jR=0;var _=fe(qg),A=U.T,j=H.p;try{H.p=32>_?32:_,U.T=null,_=OR,OR=null;var q=Uf,he=qg;if(ga=0,Ug=Uf=null,qg=0,(ys&6)!==0)throw Error(r(331));var je=ys;if(ys|=4,rL(q.current),eL(q,q.current,he,_),ys=je,vv(0,!1),qt&&typeof qt.onPostCommitFiberRoot=="function")try{qt.onPostCommitFiberRoot(jt,q)}catch{}return!0}finally{H.p=j,U.T=A,vL(p,g)}}function wL(p,g,_){g=$n(_,g),g=hR(p.stateNode,g,2),p=If(p,g,2),p!==null&&(tt(p,2),nu(p))}function Ms(p,g,_){if(p.tag===3)wL(p,p,_);else for(;g!==null;){if(g.tag===3){wL(g,p,_);break}else if(g.tag===1){var A=g.stateNode;if(typeof g.type.getDerivedStateFromError=="function"||typeof A.componentDidCatch=="function"&&(zf===null||!zf.has(A))){p=$n(_,p),_=k8(2),A=If(g,_,2),A!==null&&(E8(_,A,g,p),tt(A,2),nu(A));break}}g=g.return}}function BR(p,g,_){var A=p.pingCache;if(A===null){A=p.pingCache=new ufe;var j=new Set;A.set(g,j)}else j=A.get(g),j===void 0&&(j=new Set,A.set(g,j));j.has(_)||(RR=!0,j.add(_),p=mfe.bind(null,p,g,_),g.then(p,p))}function mfe(p,g,_){var A=p.pingCache;A!==null&&A.delete(g),p.pingedLanes|=p.suspendedLanes&_,p.warmLanes&=~_,Ps===p&&(Gr&_)===_&&(oi===4||oi===3&&(Gr&62914560)===Gr&&300>ce()-IR?(ys&2)===0&&Vg(p,0):NR|=_,zg===Gr&&(zg=0)),nu(p)}function _L(p,g){g===0&&(g=$()),p=cc(p,g),p!==null&&(tt(p,g),nu(p))}function gfe(p){var g=p.memoizedState,_=0;g!==null&&(_=g.retryLane),_L(p,_)}function yfe(p,g){var _=0;switch(p.tag){case 13:var A=p.stateNode,j=p.memoizedState;j!==null&&(_=j.retryLane);break;case 19:A=p.stateNode;break;case 22:A=p.stateNode._retryCache;break;default:throw Error(r(314))}A!==null&&A.delete(g),_L(p,_)}function bfe(p,g){return Ie(p,g)}var uS=null,Hg=null,$R=!1,dS=!1,zR=!1,jp=0;function nu(p){p!==Hg&&p.next===null&&(Hg===null?uS=Hg=p:Hg=Hg.next=p),dS=!0,$R||($R=!0,xfe())}function vv(p,g){if(!zR&&dS){zR=!0;do for(var _=!1,A=uS;A!==null;){if(p!==0){var j=A.pendingLanes;if(j===0)var q=0;else{var he=A.suspendedLanes,je=A.pingedLanes;q=(1<<31-Ht(42|p)+1)-1,q&=j&~(he&~je),q=q&201326741?q&201326741|1:q?q|2:0}q!==0&&(_=!0,EL(A,q))}else q=Gr,q=Ee(A,A===Ps?q:0,A.cancelPendingCommit!==null||A.timeoutHandle!==-1),(q&3)===0||le(A,q)||(_=!0,EL(A,q));A=A.next}while(_);zR=!1}}function vfe(){SL()}function SL(){dS=$R=!1;var p=0;jp!==0&&(Afe()&&(p=jp),jp=0);for(var g=ce(),_=null,A=uS;A!==null;){var j=A.next,q=CL(A,g);q===0?(A.next=null,_===null?uS=j:_.next=j,j===null&&(Hg=_)):(_=A,(p!==0||(q&3)!==0)&&(dS=!0)),A=j}vv(p)}function CL(p,g){for(var _=p.suspendedLanes,A=p.pingedLanes,j=p.expirationTimes,q=p.pendingLanes&-62914561;0<q;){var he=31-Ht(q),je=1<<he,Ye=j[he];Ye===-1?((je&_)===0||(je&A)!==0)&&(j[he]=dt(je,g)):Ye<=g&&(p.expiredLanes|=je),q&=~je}if(g=Ps,_=Gr,_=Ee(p,p===g?_:0,p.cancelPendingCommit!==null||p.timeoutHandle!==-1),A=p.callbackNode,_===0||p===g&&(bs===2||bs===9)||p.cancelPendingCommit!==null)return A!==null&&A!==null&&K(A),p.callbackNode=null,p.callbackPriority=0;if((_&3)===0||le(p,_)){if(g=_&-_,g===p.callbackPriority)return g;switch(A!==null&&K(A),fe(_)){case 2:case 8:_=Re;break;case 32:_=Be;break;case 268435456:_=lt;break;default:_=Be}return A=kL.bind(null,p),_=Ie(_,A),p.callbackPriority=g,p.callbackNode=_,g}return A!==null&&A!==null&&K(A),p.callbackPriority=2,p.callbackNode=null,2}function kL(p,g){if(ga!==0&&ga!==5)return p.callbackNode=null,p.callbackPriority=0,null;var _=p.callbackNode;if(cS()&&p.callbackNode!==_)return null;var A=Gr;return A=Ee(p,p===Ps?A:0,p.cancelPendingCommit!==null||p.timeoutHandle!==-1),A===0?null:(oL(p,A,g),CL(p,ce()),p.callbackNode!=null&&p.callbackNode===_?kL.bind(null,p):null)}function EL(p,g){if(cS())return null;oL(p,g,!0)}function xfe(){Nfe(function(){(ys&6)!==0?Ie(re,vfe):SL()})}function UR(){return jp===0&&(jp=et()),jp}function TL(p){return p==null||typeof p=="symbol"||typeof p=="boolean"?null:typeof p=="function"?p:Yu(""+p)}function AL(p,g){var _=g.ownerDocument.createElement("input");return _.name=g.name,_.value=g.value,p.id&&_.setAttribute("form",p.id),g.parentNode.insertBefore(_,g),p=new FormData(p),_.parentNode.removeChild(_),p}function wfe(p,g,_,A,j){if(g==="submit"&&_&&_.stateNode===j){var q=TL((j[De]||null).action),he=A.submitter;he&&(g=(g=he[De]||null)?TL(g.formAction):he.getAttribute("formAction"),g!==null&&(q=g,he=null));var je=new fg("action","action",null,A,j);p.push({event:je,listeners:[{instance:null,listener:function(){if(A.defaultPrevented){if(jp!==0){var Ye=he?AL(j,he):new FormData(j);lR(_,{pending:!0,data:Ye,method:j.method,action:q},null,Ye)}}else typeof q=="function"&&(je.preventDefault(),Ye=he?AL(j,he):new FormData(j),lR(_,{pending:!0,data:Ye,method:j.method,action:q},q,Ye))},currentTarget:j}]})}}for(var qR=0;qR<an.length;qR++){var VR=an[qR],_fe=VR.toLowerCase(),Sfe=VR[0].toUpperCase()+VR.slice(1);Kt(_fe,"on"+Sfe)}Kt(kt,"onAnimationEnd"),Kt(Nt,"onAnimationIteration"),Kt(Mt,"onAnimationStart"),Kt("dblclick","onDoubleClick"),Kt("focusin","onFocus"),Kt("focusout","onBlur"),Kt(Pt,"onTransitionRun"),Kt(Xt,"onTransitionStart"),Kt(rn,"onTransitionCancel"),Kt(Gt,"onTransitionEnd"),pn("onMouseEnter",["mouseout","mouseover"]),pn("onMouseLeave",["mouseout","mouseover"]),pn("onPointerEnter",["pointerout","pointerover"]),pn("onPointerLeave",["pointerout","pointerover"]),Vt("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Vt("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Vt("onBeforeInput",["compositionend","keypress","textInput","paste"]),Vt("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Vt("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Vt("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var xv="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Cfe=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(xv));function RL(p,g){g=(g&4)!==0;for(var _=0;_<p.length;_++){var A=p[_],j=A.event;A=A.listeners;e:{var q=void 0;if(g)for(var he=A.length-1;0<=he;he--){var je=A[he],Ye=je.instance,St=je.currentTarget;if(je=je.listener,Ye!==q&&j.isPropagationStopped())break e;q=je,j.currentTarget=St;try{q(j)}catch(Dt){J_(Dt)}j.currentTarget=null,q=Ye}else for(he=0;he<A.length;he++){if(je=A[he],Ye=je.instance,St=je.currentTarget,je=je.listener,Ye!==q&&j.isPropagationStopped())break e;q=je,j.currentTarget=St;try{q(j)}catch(Dt){J_(Dt)}j.currentTarget=null,q=Ye}}}}function Lr(p,g){var _=g[xt];_===void 0&&(_=g[xt]=new Set);var A=p+"__bubble";_.has(A)||(NL(g,p,2,!1),_.add(A))}function WR(p,g,_){var A=0;g&&(A|=4),NL(_,p,A,g)}var fS="_reactListening"+Math.random().toString(36).slice(2);function HR(p){if(!p[fS]){p[fS]=!0,hn.forEach(function(_){_!=="selectionchange"&&(Cfe.has(_)||WR(_,!1,p),WR(_,!0,p))});var g=p.nodeType===9?p:p.ownerDocument;g===null||g[fS]||(g[fS]=!0,WR("selectionchange",!1,g))}}function NL(p,g,_,A){switch(eB(g)){case 2:var j=Xfe;break;case 8:j=Jfe;break;default:j=aN}_=j.bind(null,g,_,p),j=void 0,!Ob||g!=="touchstart"&&g!=="touchmove"&&g!=="wheel"||(j=!0),A?j!==void 0?p.addEventListener(g,_,{capture:!0,passive:j}):p.addEventListener(g,_,!0):j!==void 0?p.addEventListener(g,_,{passive:j}):p.addEventListener(g,_,!1)}function GR(p,g,_,A,j){var q=A;if((g&1)===0&&(g&2)===0&&A!==null)e:for(;;){if(A===null)return;var he=A.tag;if(he===3||he===4){var je=A.stateNode.containerInfo;if(je===j)break;if(he===4)for(he=A.return;he!==null;){var Ye=he.tag;if((Ye===3||Ye===4)&&he.stateNode.containerInfo===j)return;he=he.return}for(;je!==null;){if(he=gr(je),he===null)return;if(Ye=he.tag,Ye===5||Ye===6||Ye===26||Ye===27){A=q=he;continue e}je=je.parentNode}}A=A.return}wf(function(){var St=q,Dt=ug(_),Bt=[];e:{var Et=en.get(p);if(Et!==void 0){var Rt=fg,ar=p;switch(p){case"keypress":if(Cf(_)===0)break e;case"keydown":case"keyup":Rt=xg;break;case"focusin":ar="focus",Rt=kf;break;case"focusout":ar="blur",Rt=kf;break;case"beforeblur":case"afterblur":Rt=kf;break;case"click":if(_.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Rt=mg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Rt=w_;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Rt=zb;break;case kt:case Nt:case Mt:Rt=__;break;case Gt:Rt=Ub;break;case"scroll":case"scrollend":Rt=hg;break;case"wheel":Rt=_g;break;case"copy":case"cut":case"paste":Rt=bg;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Rt=$b;break;case"toggle":case"beforetoggle":Rt=k_}var Wn=(g&4)!==0,Cs=!Wn&&(p==="scroll"||p==="scrollend"),pt=Wn?Et!==null?Et+"Capture":null:Et;Wn=[];for(var it=St,wt;it!==null;){var Lt=it;if(wt=Lt.stateNode,Lt=Lt.tag,Lt!==5&&Lt!==26&&Lt!==27||wt===null||pt===null||(Lt=Ju(it,pt),Lt!=null&&Wn.push(wv(it,Lt,wt))),Cs)break;it=it.return}0<Wn.length&&(Et=new Rt(Et,ar,null,_,Dt),Bt.push({event:Et,listeners:Wn}))}}if((g&7)===0){e:{if(Et=p==="mouseover"||p==="pointerover",Rt=p==="mouseout"||p==="pointerout",Et&&_!==_l&&(ar=_.relatedTarget||_.fromElement)&&(gr(ar)||ar[He]))break e;if((Rt||Et)&&(Et=Dt.window===Dt?Dt:(Et=Dt.ownerDocument)?Et.defaultView||Et.parentWindow:window,Rt?(ar=_.relatedTarget||_.toElement,Rt=St,ar=ar?gr(ar):null,ar!==null&&(Cs=i(ar),Wn=ar.tag,ar!==Cs||Wn!==5&&Wn!==27&&Wn!==6)&&(ar=null)):(Rt=null,ar=St),Rt!==ar)){if(Wn=mg,Lt="onMouseLeave",pt="onMouseEnter",it="mouse",(p==="pointerout"||p==="pointerover")&&(Wn=$b,Lt="onPointerLeave",pt="onPointerEnter",it="pointer"),Cs=Rt==null?Et:ns(Rt),wt=ar==null?Et:ns(ar),Et=new Wn(Lt,it+"leave",Rt,_,Dt),Et.target=Cs,Et.relatedTarget=wt,Lt=null,gr(Dt)===St&&(Wn=new Wn(pt,it+"enter",ar,_,Dt),Wn.target=wt,Wn.relatedTarget=Cs,Lt=Wn),Cs=Lt,Rt&&ar)t:{for(Wn=Rt,pt=ar,it=0,wt=Wn;wt;wt=Gg(wt))it++;for(wt=0,Lt=pt;Lt;Lt=Gg(Lt))wt++;for(;0<it-wt;)Wn=Gg(Wn),it--;for(;0<wt-it;)pt=Gg(pt),wt--;for(;it--;){if(Wn===pt||pt!==null&&Wn===pt.alternate)break t;Wn=Gg(Wn),pt=Gg(pt)}Wn=null}else Wn=null;Rt!==null&&ML(Bt,Et,Rt,Wn,!1),ar!==null&&Cs!==null&&ML(Bt,Cs,ar,Wn,!0)}}e:{if(Et=St?ns(St):window,Rt=Et.nodeName&&Et.nodeName.toLowerCase(),Rt==="select"||Rt==="input"&&Et.type==="file")var xn=xp;else if(kg(Et))if(Cl)xn=Af;else{xn=rd;var Pr=M_}else Rt=Et.nodeName,!Rt||Rt.toLowerCase()!=="input"||Et.type!=="checkbox"&&Et.type!=="radio"?St&&jb(St.elementType)&&(xn=xp):xn=Gb;if(xn&&(xn=xn(p,St))){Hb(Bt,xn,_,Dt);break e}Pr&&Pr(p,Et,St),p==="focusout"&&St&&Et.type==="number"&&St.memoizedProps.value!=null&&yf(Et,"number",Et.value)}switch(Pr=St?ns(St):window,p){case"focusin":(kg(Pr)||Pr.contentEditable==="true")&&(Ge=Pr,st=St,at=null);break;case"focusout":at=st=Ge=null;break;case"mousedown":ht=!0;break;case"contextmenu":case"mouseup":case"dragend":ht=!1,Je(Bt,_,Dt);break;case"selectionchange":if(Le)break;case"keydown":case"keyup":Je(Bt,_,Dt)}var Pn;if(bp)e:{switch(p){case"compositionstart":var Yn="onCompositionStart";break e;case"compositionend":Yn="onCompositionEnd";break e;case"compositionupdate":Yn="onCompositionUpdate";break e}Yn=void 0}else nd?Wb(p,_)&&(Yn="onCompositionEnd"):p==="keydown"&&_.keyCode===229&&(Yn="onCompositionStart");Yn&&(Sg&&_.locale!=="ko"&&(nd||Yn!=="onCompositionStart"?Yn==="onCompositionEnd"&&nd&&(Pn=Sf()):(Sl=Dt,dg="value"in Sl?Sl.value:Sl.textContent,nd=!0)),Pr=hS(St,Yn),0<Pr.length&&(Yn=new vg(Yn,p,null,_,Dt),Bt.push({event:Yn,listeners:Pr}),Pn?Yn.data=Pn:(Pn=T_(_),Pn!==null&&(Yn.data=Pn)))),(Pn=TA?A_(p,_):AA(p,_))&&(Yn=hS(St,"onBeforeInput"),0<Yn.length&&(Pr=new vg("onBeforeInput","beforeinput",null,_,Dt),Bt.push({event:Pr,listeners:Yn}),Pr.data=Pn)),wfe(Bt,p,St,_,Dt)}RL(Bt,g)})}function wv(p,g,_){return{instance:p,listener:g,currentTarget:_}}function hS(p,g){for(var _=g+"Capture",A=[];p!==null;){var j=p,q=j.stateNode;if(j=j.tag,j!==5&&j!==26&&j!==27||q===null||(j=Ju(p,_),j!=null&&A.unshift(wv(p,j,q)),j=Ju(p,g),j!=null&&A.push(wv(p,j,q))),p.tag===3)return A;p=p.return}return[]}function Gg(p){if(p===null)return null;do p=p.return;while(p&&p.tag!==5&&p.tag!==27);return p||null}function ML(p,g,_,A,j){for(var q=g._reactName,he=[];_!==null&&_!==A;){var je=_,Ye=je.alternate,St=je.stateNode;if(je=je.tag,Ye!==null&&Ye===A)break;je!==5&&je!==26&&je!==27||St===null||(Ye=St,j?(St=Ju(_,q),St!=null&&he.unshift(wv(_,St,Ye))):j||(St=Ju(_,q),St!=null&&he.push(wv(_,St,Ye)))),_=_.return}he.length!==0&&p.push({event:g,listeners:he})}var kfe=/\r\n?/g,Efe=/\u0000|\uFFFD/g;function IL(p){return(typeof p=="string"?p:""+p).replace(kfe,`
`).replace(Efe,"")}function jL(p,g){return g=IL(g),IL(p)===g}function pS(){}function Ss(p,g,_,A,j,q){switch(_){case"children":typeof A=="string"?g==="body"||g==="textarea"&&A===""||vf(p,A):(typeof A=="number"||typeof A=="bigint")&&g!=="body"&&vf(p,""+A);break;case"className":Wa(p,"class",A);break;case"tabIndex":Wa(p,"tabindex",A);break;case"dir":case"role":case"viewBox":case"width":case"height":Wa(p,_,A);break;case"style":v_(p,A,q);break;case"data":if(g!=="object"){Wa(p,"data",A);break}case"src":case"href":if(A===""&&(g!=="a"||_!=="href")){p.removeAttribute(_);break}if(A==null||typeof A=="function"||typeof A=="symbol"||typeof A=="boolean"){p.removeAttribute(_);break}A=Yu(""+A),p.setAttribute(_,A);break;case"action":case"formAction":if(typeof A=="function"){p.setAttribute(_,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof q=="function"&&(_==="formAction"?(g!=="input"&&Ss(p,g,"name",j.name,j,null),Ss(p,g,"formEncType",j.formEncType,j,null),Ss(p,g,"formMethod",j.formMethod,j,null),Ss(p,g,"formTarget",j.formTarget,j,null)):(Ss(p,g,"encType",j.encType,j,null),Ss(p,g,"method",j.method,j,null),Ss(p,g,"target",j.target,j,null)));if(A==null||typeof A=="symbol"||typeof A=="boolean"){p.removeAttribute(_);break}A=Yu(""+A),p.setAttribute(_,A);break;case"onClick":A!=null&&(p.onclick=pS);break;case"onScroll":A!=null&&Lr("scroll",p);break;case"onScrollEnd":A!=null&&Lr("scrollend",p);break;case"dangerouslySetInnerHTML":if(A!=null){if(typeof A!="object"||!("__html"in A))throw Error(r(61));if(_=A.__html,_!=null){if(j.children!=null)throw Error(r(60));p.innerHTML=_}}break;case"multiple":p.multiple=A&&typeof A!="function"&&typeof A!="symbol";break;case"muted":p.muted=A&&typeof A!="function"&&typeof A!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(A==null||typeof A=="function"||typeof A=="boolean"||typeof A=="symbol"){p.removeAttribute("xlink:href");break}_=Yu(""+A),p.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",_);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":A!=null&&typeof A!="function"&&typeof A!="symbol"?p.setAttribute(_,""+A):p.removeAttribute(_);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":A&&typeof A!="function"&&typeof A!="symbol"?p.setAttribute(_,""):p.removeAttribute(_);break;case"capture":case"download":A===!0?p.setAttribute(_,""):A!==!1&&A!=null&&typeof A!="function"&&typeof A!="symbol"?p.setAttribute(_,A):p.removeAttribute(_);break;case"cols":case"rows":case"size":case"span":A!=null&&typeof A!="function"&&typeof A!="symbol"&&!isNaN(A)&&1<=A?p.setAttribute(_,A):p.removeAttribute(_);break;case"rowSpan":case"start":A==null||typeof A=="function"||typeof A=="symbol"||isNaN(A)?p.removeAttribute(_):p.setAttribute(_,A);break;case"popover":Lr("beforetoggle",p),Lr("toggle",p),di(p,"popover",A);break;case"xlinkActuate":ha(p,"http://www.w3.org/1999/xlink","xlink:actuate",A);break;case"xlinkArcrole":ha(p,"http://www.w3.org/1999/xlink","xlink:arcrole",A);break;case"xlinkRole":ha(p,"http://www.w3.org/1999/xlink","xlink:role",A);break;case"xlinkShow":ha(p,"http://www.w3.org/1999/xlink","xlink:show",A);break;case"xlinkTitle":ha(p,"http://www.w3.org/1999/xlink","xlink:title",A);break;case"xlinkType":ha(p,"http://www.w3.org/1999/xlink","xlink:type",A);break;case"xmlBase":ha(p,"http://www.w3.org/XML/1998/namespace","xml:base",A);break;case"xmlLang":ha(p,"http://www.w3.org/XML/1998/namespace","xml:lang",A);break;case"xmlSpace":ha(p,"http://www.w3.org/XML/1998/namespace","xml:space",A);break;case"is":di(p,"is",A);break;case"innerText":case"textContent":break;default:(!(2<_.length)||_[0]!=="o"&&_[0]!=="O"||_[1]!=="n"&&_[1]!=="N")&&(_=Ga.get(_)||_,di(p,_,A))}}function KR(p,g,_,A,j,q){switch(_){case"style":v_(p,A,q);break;case"dangerouslySetInnerHTML":if(A!=null){if(typeof A!="object"||!("__html"in A))throw Error(r(61));if(_=A.__html,_!=null){if(j.children!=null)throw Error(r(60));p.innerHTML=_}}break;case"children":typeof A=="string"?vf(p,A):(typeof A=="number"||typeof A=="bigint")&&vf(p,""+A);break;case"onScroll":A!=null&&Lr("scroll",p);break;case"onScrollEnd":A!=null&&Lr("scrollend",p);break;case"onClick":A!=null&&(p.onclick=pS);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!nt.hasOwnProperty(_))e:{if(_[0]==="o"&&_[1]==="n"&&(j=_.endsWith("Capture"),g=_.slice(2,j?_.length-7:void 0),q=p[De]||null,q=q!=null?q[_]:null,typeof q=="function"&&p.removeEventListener(g,q,j),typeof A=="function")){typeof q!="function"&&q!==null&&(_ in p?p[_]=null:p.hasAttribute(_)&&p.removeAttribute(_)),p.addEventListener(g,A,j);break e}_ in p?p[_]=A:A===!0?p.setAttribute(_,""):di(p,_,A)}}}function ya(p,g,_){switch(g){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Lr("error",p),Lr("load",p);var A=!1,j=!1,q;for(q in _)if(_.hasOwnProperty(q)){var he=_[q];if(he!=null)switch(q){case"src":A=!0;break;case"srcSet":j=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,g));default:Ss(p,g,q,he,_,null)}}j&&Ss(p,g,"srcSet",_.srcSet,_,null),A&&Ss(p,g,"src",_.src,_,null);return;case"input":Lr("invalid",p);var je=q=he=j=null,Ye=null,St=null;for(A in _)if(_.hasOwnProperty(A)){var Dt=_[A];if(Dt!=null)switch(A){case"name":j=Dt;break;case"type":he=Dt;break;case"checked":Ye=Dt;break;case"defaultChecked":St=Dt;break;case"value":q=Dt;break;case"defaultValue":je=Dt;break;case"children":case"dangerouslySetInnerHTML":if(Dt!=null)throw Error(r(137,g));break;default:Ss(p,g,A,Dt,_,null)}}Mb(p,q,je,Ye,St,he,j,!1),Gc(p);return;case"select":Lr("invalid",p),A=he=q=null;for(j in _)if(_.hasOwnProperty(j)&&(je=_[j],je!=null))switch(j){case"value":q=je;break;case"defaultValue":he=je;break;case"multiple":A=je;default:Ss(p,g,j,je,_,null)}g=q,_=he,p.multiple=!!A,g!=null?Ku(p,!!A,g,!1):_!=null&&Ku(p,!!A,_,!0);return;case"textarea":Lr("invalid",p),q=j=A=null;for(he in _)if(_.hasOwnProperty(he)&&(je=_[he],je!=null))switch(he){case"value":A=je;break;case"defaultValue":j=je;break;case"children":q=je;break;case"dangerouslySetInnerHTML":if(je!=null)throw Error(r(91));break;default:Ss(p,g,he,je,_,null)}Ib(p,A,j,q),Gc(p);return;case"option":for(Ye in _)if(_.hasOwnProperty(Ye)&&(A=_[Ye],A!=null))switch(Ye){case"selected":p.selected=A&&typeof A!="function"&&typeof A!="symbol";break;default:Ss(p,g,Ye,A,_,null)}return;case"dialog":Lr("beforetoggle",p),Lr("toggle",p),Lr("cancel",p),Lr("close",p);break;case"iframe":case"object":Lr("load",p);break;case"video":case"audio":for(A=0;A<xv.length;A++)Lr(xv[A],p);break;case"image":Lr("error",p),Lr("load",p);break;case"details":Lr("toggle",p);break;case"embed":case"source":case"link":Lr("error",p),Lr("load",p);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(St in _)if(_.hasOwnProperty(St)&&(A=_[St],A!=null))switch(St){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,g));default:Ss(p,g,St,A,_,null)}return;default:if(jb(g)){for(Dt in _)_.hasOwnProperty(Dt)&&(A=_[Dt],A!==void 0&&KR(p,g,Dt,A,_,void 0));return}}for(je in _)_.hasOwnProperty(je)&&(A=_[je],A!=null&&Ss(p,g,je,A,_,null))}function Tfe(p,g,_,A){switch(g){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var j=null,q=null,he=null,je=null,Ye=null,St=null,Dt=null;for(Rt in _){var Bt=_[Rt];if(_.hasOwnProperty(Rt)&&Bt!=null)switch(Rt){case"checked":break;case"value":break;case"defaultValue":Ye=Bt;default:A.hasOwnProperty(Rt)||Ss(p,g,Rt,null,A,Bt)}}for(var Et in A){var Rt=A[Et];if(Bt=_[Et],A.hasOwnProperty(Et)&&(Rt!=null||Bt!=null))switch(Et){case"type":q=Rt;break;case"name":j=Rt;break;case"checked":St=Rt;break;case"defaultChecked":Dt=Rt;break;case"value":he=Rt;break;case"defaultValue":je=Rt;break;case"children":case"dangerouslySetInnerHTML":if(Rt!=null)throw Error(r(137,g));break;default:Rt!==Bt&&Ss(p,g,Et,Rt,A,Bt)}}gf(p,he,je,Ye,St,Dt,q,j);return;case"select":Rt=he=je=Et=null;for(q in _)if(Ye=_[q],_.hasOwnProperty(q)&&Ye!=null)switch(q){case"value":break;case"multiple":Rt=Ye;default:A.hasOwnProperty(q)||Ss(p,g,q,null,A,Ye)}for(j in A)if(q=A[j],Ye=_[j],A.hasOwnProperty(j)&&(q!=null||Ye!=null))switch(j){case"value":Et=q;break;case"defaultValue":je=q;break;case"multiple":he=q;default:q!==Ye&&Ss(p,g,j,q,A,Ye)}g=je,_=he,A=Rt,Et!=null?Ku(p,!!_,Et,!1):!!A!=!!_&&(g!=null?Ku(p,!!_,g,!0):Ku(p,!!_,_?[]:"",!1));return;case"textarea":Rt=Et=null;for(je in _)if(j=_[je],_.hasOwnProperty(je)&&j!=null&&!A.hasOwnProperty(je))switch(je){case"value":break;case"children":break;default:Ss(p,g,je,null,A,j)}for(he in A)if(j=A[he],q=_[he],A.hasOwnProperty(he)&&(j!=null||q!=null))switch(he){case"value":Et=j;break;case"defaultValue":Rt=j;break;case"children":break;case"dangerouslySetInnerHTML":if(j!=null)throw Error(r(91));break;default:j!==q&&Ss(p,g,he,j,A,q)}bf(p,Et,Rt);return;case"option":for(var ar in _)if(Et=_[ar],_.hasOwnProperty(ar)&&Et!=null&&!A.hasOwnProperty(ar))switch(ar){case"selected":p.selected=!1;break;default:Ss(p,g,ar,null,A,Et)}for(Ye in A)if(Et=A[Ye],Rt=_[Ye],A.hasOwnProperty(Ye)&&Et!==Rt&&(Et!=null||Rt!=null))switch(Ye){case"selected":p.selected=Et&&typeof Et!="function"&&typeof Et!="symbol";break;default:Ss(p,g,Ye,Et,A,Rt)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Wn in _)Et=_[Wn],_.hasOwnProperty(Wn)&&Et!=null&&!A.hasOwnProperty(Wn)&&Ss(p,g,Wn,null,A,Et);for(St in A)if(Et=A[St],Rt=_[St],A.hasOwnProperty(St)&&Et!==Rt&&(Et!=null||Rt!=null))switch(St){case"children":case"dangerouslySetInnerHTML":if(Et!=null)throw Error(r(137,g));break;default:Ss(p,g,St,Et,A,Rt)}return;default:if(jb(g)){for(var Cs in _)Et=_[Cs],_.hasOwnProperty(Cs)&&Et!==void 0&&!A.hasOwnProperty(Cs)&&KR(p,g,Cs,void 0,A,Et);for(Dt in A)Et=A[Dt],Rt=_[Dt],!A.hasOwnProperty(Dt)||Et===Rt||Et===void 0&&Rt===void 0||KR(p,g,Dt,Et,A,Rt);return}}for(var pt in _)Et=_[pt],_.hasOwnProperty(pt)&&Et!=null&&!A.hasOwnProperty(pt)&&Ss(p,g,pt,null,A,Et);for(Bt in A)Et=A[Bt],Rt=_[Bt],!A.hasOwnProperty(Bt)||Et===Rt||Et==null&&Rt==null||Ss(p,g,Bt,Et,A,Rt)}var YR=null,ZR=null;function mS(p){return p.nodeType===9?p:p.ownerDocument}function OL(p){switch(p){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function PL(p,g){if(p===0)switch(g){case"svg":return 1;case"math":return 2;default:return 0}return p===1&&g==="foreignObject"?0:p}function XR(p,g){return p==="textarea"||p==="noscript"||typeof g.children=="string"||typeof g.children=="number"||typeof g.children=="bigint"||typeof g.dangerouslySetInnerHTML=="object"&&g.dangerouslySetInnerHTML!==null&&g.dangerouslySetInnerHTML.__html!=null}var JR=null;function Afe(){var p=window.event;return p&&p.type==="popstate"?p===JR?!1:(JR=p,!0):(JR=null,!1)}var DL=typeof setTimeout=="function"?setTimeout:void 0,Rfe=typeof clearTimeout=="function"?clearTimeout:void 0,FL=typeof Promise=="function"?Promise:void 0,Nfe=typeof queueMicrotask=="function"?queueMicrotask:typeof FL<"u"?function(p){return FL.resolve(null).then(p).catch(Mfe)}:DL;function Mfe(p){setTimeout(function(){throw p})}function Vf(p){return p==="head"}function LL(p,g){var _=g,A=0,j=0;do{var q=_.nextSibling;if(p.removeChild(_),q&&q.nodeType===8)if(_=q.data,_==="/$"){if(0<A&&8>A){_=A;var he=p.ownerDocument;if(_&1&&_v(he.documentElement),_&2&&_v(he.body),_&4)for(_=he.head,_v(_),he=_.firstChild;he;){var je=he.nextSibling,Ye=he.nodeName;he[nn]||Ye==="SCRIPT"||Ye==="STYLE"||Ye==="LINK"&&he.rel.toLowerCase()==="stylesheet"||_.removeChild(he),he=je}}if(j===0){p.removeChild(q),Nv(g);return}j--}else _==="$"||_==="$?"||_==="$!"?j++:A=_.charCodeAt(0)-48;else A=0;_=q}while(_);Nv(g)}function QR(p){var g=p.firstChild;for(g&&g.nodeType===10&&(g=g.nextSibling);g;){var _=g;switch(g=g.nextSibling,_.nodeName){case"HTML":case"HEAD":case"BODY":QR(_),un(_);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(_.rel.toLowerCase()==="stylesheet")continue}p.removeChild(_)}}function Ife(p,g,_,A){for(;p.nodeType===1;){var j=_;if(p.nodeName.toLowerCase()!==g.toLowerCase()){if(!A&&(p.nodeName!=="INPUT"||p.type!=="hidden"))break}else if(A){if(!p[nn])switch(g){case"meta":if(!p.hasAttribute("itemprop"))break;return p;case"link":if(q=p.getAttribute("rel"),q==="stylesheet"&&p.hasAttribute("data-precedence"))break;if(q!==j.rel||p.getAttribute("href")!==(j.href==null||j.href===""?null:j.href)||p.getAttribute("crossorigin")!==(j.crossOrigin==null?null:j.crossOrigin)||p.getAttribute("title")!==(j.title==null?null:j.title))break;return p;case"style":if(p.hasAttribute("data-precedence"))break;return p;case"script":if(q=p.getAttribute("src"),(q!==(j.src==null?null:j.src)||p.getAttribute("type")!==(j.type==null?null:j.type)||p.getAttribute("crossorigin")!==(j.crossOrigin==null?null:j.crossOrigin))&&q&&p.hasAttribute("async")&&!p.hasAttribute("itemprop"))break;return p;default:return p}}else if(g==="input"&&p.type==="hidden"){var q=j.name==null?null:""+j.name;if(j.type==="hidden"&&p.getAttribute("name")===q)return p}else return p;if(p=dc(p.nextSibling),p===null)break}return null}function jfe(p,g,_){if(g==="")return null;for(;p.nodeType!==3;)if((p.nodeType!==1||p.nodeName!=="INPUT"||p.type!=="hidden")&&!_||(p=dc(p.nextSibling),p===null))return null;return p}function eN(p){return p.data==="$!"||p.data==="$?"&&p.ownerDocument.readyState==="complete"}function Ofe(p,g){var _=p.ownerDocument;if(p.data!=="$?"||_.readyState==="complete")g();else{var A=function(){g(),_.removeEventListener("DOMContentLoaded",A)};_.addEventListener("DOMContentLoaded",A),p._reactRetry=A}}function dc(p){for(;p!=null;p=p.nextSibling){var g=p.nodeType;if(g===1||g===3)break;if(g===8){if(g=p.data,g==="$"||g==="$!"||g==="$?"||g==="F!"||g==="F")break;if(g==="/$")return null}}return p}var tN=null;function BL(p){p=p.previousSibling;for(var g=0;p;){if(p.nodeType===8){var _=p.data;if(_==="$"||_==="$!"||_==="$?"){if(g===0)return p;g--}else _==="/$"&&g++}p=p.previousSibling}return null}function $L(p,g,_){switch(g=mS(_),p){case"html":if(p=g.documentElement,!p)throw Error(r(452));return p;case"head":if(p=g.head,!p)throw Error(r(453));return p;case"body":if(p=g.body,!p)throw Error(r(454));return p;default:throw Error(r(451))}}function _v(p){for(var g=p.attributes;g.length;)p.removeAttributeNode(g[0]);un(p)}var Nl=new Map,zL=new Set;function gS(p){return typeof p.getRootNode=="function"?p.getRootNode():p.nodeType===9?p:p.ownerDocument}var gd=H.d;H.d={f:Pfe,r:Dfe,D:Ffe,C:Lfe,L:Bfe,m:$fe,X:Ufe,S:zfe,M:qfe};function Pfe(){var p=gd.f(),g=oS();return p||g}function Dfe(p){var g=Nr(p);g!==null&&g.tag===5&&g.type==="form"?o8(g):gd.r(p)}var Kg=typeof document>"u"?null:document;function UL(p,g,_){var A=Kg;if(A&&typeof g=="string"&&g){var j=Ea(g);j='link[rel="'+p+'"][href="'+j+'"]',typeof _=="string"&&(j+='[crossorigin="'+_+'"]'),zL.has(j)||(zL.add(j),p={rel:p,crossOrigin:_,href:g},A.querySelector(j)===null&&(g=A.createElement("link"),ya(g,"link",p),kr(g),A.head.appendChild(g)))}}function Ffe(p){gd.D(p),UL("dns-prefetch",p,null)}function Lfe(p,g){gd.C(p,g),UL("preconnect",p,g)}function Bfe(p,g,_){gd.L(p,g,_);var A=Kg;if(A&&p&&g){var j='link[rel="preload"][as="'+Ea(g)+'"]';g==="image"&&_&&_.imageSrcSet?(j+='[imagesrcset="'+Ea(_.imageSrcSet)+'"]',typeof _.imageSizes=="string"&&(j+='[imagesizes="'+Ea(_.imageSizes)+'"]')):j+='[href="'+Ea(p)+'"]';var q=j;switch(g){case"style":q=Yg(p);break;case"script":q=Zg(p)}Nl.has(q)||(p=u({rel:"preload",href:g==="image"&&_&&_.imageSrcSet?void 0:p,as:g},_),Nl.set(q,p),A.querySelector(j)!==null||g==="style"&&A.querySelector(Sv(q))||g==="script"&&A.querySelector(Cv(q))||(g=A.createElement("link"),ya(g,"link",p),kr(g),A.head.appendChild(g)))}}function $fe(p,g){gd.m(p,g);var _=Kg;if(_&&p){var A=g&&typeof g.as=="string"?g.as:"script",j='link[rel="modulepreload"][as="'+Ea(A)+'"][href="'+Ea(p)+'"]',q=j;switch(A){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":q=Zg(p)}if(!Nl.has(q)&&(p=u({rel:"modulepreload",href:p},g),Nl.set(q,p),_.querySelector(j)===null)){switch(A){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(_.querySelector(Cv(q)))return}A=_.createElement("link"),ya(A,"link",p),kr(A),_.head.appendChild(A)}}}function zfe(p,g,_){gd.S(p,g,_);var A=Kg;if(A&&p){var j=rs(A).hoistableStyles,q=Yg(p);g=g||"default";var he=j.get(q);if(!he){var je={loading:0,preload:null};if(he=A.querySelector(Sv(q)))je.loading=5;else{p=u({rel:"stylesheet",href:p,"data-precedence":g},_),(_=Nl.get(q))&&nN(p,_);var Ye=he=A.createElement("link");kr(Ye),ya(Ye,"link",p),Ye._p=new Promise(function(St,Dt){Ye.onload=St,Ye.onerror=Dt}),Ye.addEventListener("load",function(){je.loading|=1}),Ye.addEventListener("error",function(){je.loading|=2}),je.loading|=4,yS(he,g,A)}he={type:"stylesheet",instance:he,count:1,state:je},j.set(q,he)}}}function Ufe(p,g){gd.X(p,g);var _=Kg;if(_&&p){var A=rs(_).hoistableScripts,j=Zg(p),q=A.get(j);q||(q=_.querySelector(Cv(j)),q||(p=u({src:p,async:!0},g),(g=Nl.get(j))&&rN(p,g),q=_.createElement("script"),kr(q),ya(q,"link",p),_.head.appendChild(q)),q={type:"script",instance:q,count:1,state:null},A.set(j,q))}}function qfe(p,g){gd.M(p,g);var _=Kg;if(_&&p){var A=rs(_).hoistableScripts,j=Zg(p),q=A.get(j);q||(q=_.querySelector(Cv(j)),q||(p=u({src:p,async:!0,type:"module"},g),(g=Nl.get(j))&&rN(p,g),q=_.createElement("script"),kr(q),ya(q,"link",p),_.head.appendChild(q)),q={type:"script",instance:q,count:1,state:null},A.set(j,q))}}function qL(p,g,_,A){var j=(j=Oe.current)?gS(j):null;if(!j)throw Error(r(446));switch(p){case"meta":case"title":return null;case"style":return typeof _.precedence=="string"&&typeof _.href=="string"?(g=Yg(_.href),_=rs(j).hoistableStyles,A=_.get(g),A||(A={type:"style",instance:null,count:0,state:null},_.set(g,A)),A):{type:"void",instance:null,count:0,state:null};case"link":if(_.rel==="stylesheet"&&typeof _.href=="string"&&typeof _.precedence=="string"){p=Yg(_.href);var q=rs(j).hoistableStyles,he=q.get(p);if(he||(j=j.ownerDocument||j,he={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},q.set(p,he),(q=j.querySelector(Sv(p)))&&!q._p&&(he.instance=q,he.state.loading=5),Nl.has(p)||(_={rel:"preload",as:"style",href:_.href,crossOrigin:_.crossOrigin,integrity:_.integrity,media:_.media,hrefLang:_.hrefLang,referrerPolicy:_.referrerPolicy},Nl.set(p,_),q||Vfe(j,p,_,he.state))),g&&A===null)throw Error(r(528,""));return he}if(g&&A!==null)throw Error(r(529,""));return null;case"script":return g=_.async,_=_.src,typeof _=="string"&&g&&typeof g!="function"&&typeof g!="symbol"?(g=Zg(_),_=rs(j).hoistableScripts,A=_.get(g),A||(A={type:"script",instance:null,count:0,state:null},_.set(g,A)),A):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,p))}}function Yg(p){return'href="'+Ea(p)+'"'}function Sv(p){return'link[rel="stylesheet"]['+p+"]"}function VL(p){return u({},p,{"data-precedence":p.precedence,precedence:null})}function Vfe(p,g,_,A){p.querySelector('link[rel="preload"][as="style"]['+g+"]")?A.loading=1:(g=p.createElement("link"),A.preload=g,g.addEventListener("load",function(){return A.loading|=1}),g.addEventListener("error",function(){return A.loading|=2}),ya(g,"link",_),kr(g),p.head.appendChild(g))}function Zg(p){return'[src="'+Ea(p)+'"]'}function Cv(p){return"script[async]"+p}function WL(p,g,_){if(g.count++,g.instance===null)switch(g.type){case"style":var A=p.querySelector('style[data-href~="'+Ea(_.href)+'"]');if(A)return g.instance=A,kr(A),A;var j=u({},_,{"data-href":_.href,"data-precedence":_.precedence,href:null,precedence:null});return A=(p.ownerDocument||p).createElement("style"),kr(A),ya(A,"style",j),yS(A,_.precedence,p),g.instance=A;case"stylesheet":j=Yg(_.href);var q=p.querySelector(Sv(j));if(q)return g.state.loading|=4,g.instance=q,kr(q),q;A=VL(_),(j=Nl.get(j))&&nN(A,j),q=(p.ownerDocument||p).createElement("link"),kr(q);var he=q;return he._p=new Promise(function(je,Ye){he.onload=je,he.onerror=Ye}),ya(q,"link",A),g.state.loading|=4,yS(q,_.precedence,p),g.instance=q;case"script":return q=Zg(_.src),(j=p.querySelector(Cv(q)))?(g.instance=j,kr(j),j):(A=_,(j=Nl.get(q))&&(A=u({},_),rN(A,j)),p=p.ownerDocument||p,j=p.createElement("script"),kr(j),ya(j,"link",A),p.head.appendChild(j),g.instance=j);case"void":return null;default:throw Error(r(443,g.type))}else g.type==="stylesheet"&&(g.state.loading&4)===0&&(A=g.instance,g.state.loading|=4,yS(A,_.precedence,p));return g.instance}function yS(p,g,_){for(var A=_.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),j=A.length?A[A.length-1]:null,q=j,he=0;he<A.length;he++){var je=A[he];if(je.dataset.precedence===g)q=je;else if(q!==j)break}q?q.parentNode.insertBefore(p,q.nextSibling):(g=_.nodeType===9?_.head:_,g.insertBefore(p,g.firstChild))}function nN(p,g){p.crossOrigin==null&&(p.crossOrigin=g.crossOrigin),p.referrerPolicy==null&&(p.referrerPolicy=g.referrerPolicy),p.title==null&&(p.title=g.title)}function rN(p,g){p.crossOrigin==null&&(p.crossOrigin=g.crossOrigin),p.referrerPolicy==null&&(p.referrerPolicy=g.referrerPolicy),p.integrity==null&&(p.integrity=g.integrity)}var bS=null;function HL(p,g,_){if(bS===null){var A=new Map,j=bS=new Map;j.set(_,A)}else j=bS,A=j.get(_),A||(A=new Map,j.set(_,A));if(A.has(p))return A;for(A.set(p,null),_=_.getElementsByTagName(p),j=0;j<_.length;j++){var q=_[j];if(!(q[nn]||q[xe]||p==="link"&&q.getAttribute("rel")==="stylesheet")&&q.namespaceURI!=="http://www.w3.org/2000/svg"){var he=q.getAttribute(g)||"";he=p+he;var je=A.get(he);je?je.push(q):A.set(he,[q])}}return A}function GL(p,g,_){p=p.ownerDocument||p,p.head.insertBefore(_,g==="title"?p.querySelector("head > title"):null)}function Wfe(p,g,_){if(_===1||g.itemProp!=null)return!1;switch(p){case"meta":case"title":return!0;case"style":if(typeof g.precedence!="string"||typeof g.href!="string"||g.href==="")break;return!0;case"link":if(typeof g.rel!="string"||typeof g.href!="string"||g.href===""||g.onLoad||g.onError)break;switch(g.rel){case"stylesheet":return p=g.disabled,typeof g.precedence=="string"&&p==null;default:return!0}case"script":if(g.async&&typeof g.async!="function"&&typeof g.async!="symbol"&&!g.onLoad&&!g.onError&&g.src&&typeof g.src=="string")return!0}return!1}function KL(p){return!(p.type==="stylesheet"&&(p.state.loading&3)===0)}var kv=null;function Hfe(){}function Gfe(p,g,_){if(kv===null)throw Error(r(475));var A=kv;if(g.type==="stylesheet"&&(typeof _.media!="string"||matchMedia(_.media).matches!==!1)&&(g.state.loading&4)===0){if(g.instance===null){var j=Yg(_.href),q=p.querySelector(Sv(j));if(q){p=q._p,p!==null&&typeof p=="object"&&typeof p.then=="function"&&(A.count++,A=vS.bind(A),p.then(A,A)),g.state.loading|=4,g.instance=q,kr(q);return}q=p.ownerDocument||p,_=VL(_),(j=Nl.get(j))&&nN(_,j),q=q.createElement("link"),kr(q);var he=q;he._p=new Promise(function(je,Ye){he.onload=je,he.onerror=Ye}),ya(q,"link",_),g.instance=q}A.stylesheets===null&&(A.stylesheets=new Map),A.stylesheets.set(g,p),(p=g.state.preload)&&(g.state.loading&3)===0&&(A.count++,g=vS.bind(A),p.addEventListener("load",g),p.addEventListener("error",g))}}function Kfe(){if(kv===null)throw Error(r(475));var p=kv;return p.stylesheets&&p.count===0&&sN(p,p.stylesheets),0<p.count?function(g){var _=setTimeout(function(){if(p.stylesheets&&sN(p,p.stylesheets),p.unsuspend){var A=p.unsuspend;p.unsuspend=null,A()}},6e4);return p.unsuspend=g,function(){p.unsuspend=null,clearTimeout(_)}}:null}function vS(){if(this.count--,this.count===0){if(this.stylesheets)sN(this,this.stylesheets);else if(this.unsuspend){var p=this.unsuspend;this.unsuspend=null,p()}}}var xS=null;function sN(p,g){p.stylesheets=null,p.unsuspend!==null&&(p.count++,xS=new Map,g.forEach(Yfe,p),xS=null,vS.call(p))}function Yfe(p,g){if(!(g.state.loading&4)){var _=xS.get(p);if(_)var A=_.get(null);else{_=new Map,xS.set(p,_);for(var j=p.querySelectorAll("link[data-precedence],style[data-precedence]"),q=0;q<j.length;q++){var he=j[q];(he.nodeName==="LINK"||he.getAttribute("media")!=="not all")&&(_.set(he.dataset.precedence,he),A=he)}A&&_.set(null,A)}j=g.instance,he=j.getAttribute("data-precedence"),q=_.get(he)||A,q===A&&_.set(null,j),_.set(he,j),this.count++,A=vS.bind(this),j.addEventListener("load",A),j.addEventListener("error",A),q?q.parentNode.insertBefore(j,q.nextSibling):(p=p.nodeType===9?p.head:p,p.insertBefore(j,p.firstChild)),g.state.loading|=4}}var Ev={$$typeof:S,Provider:null,Consumer:null,_currentValue:L,_currentValue2:L,_threadCount:0};function Zfe(p,g,_,A,j,q,he,je){this.tag=1,this.containerInfo=p,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ue(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ue(0),this.hiddenUpdates=Ue(null),this.identifierPrefix=A,this.onUncaughtError=j,this.onCaughtError=q,this.onRecoverableError=he,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=je,this.incompleteTransitions=new Map}function YL(p,g,_,A,j,q,he,je,Ye,St,Dt,Bt){return p=new Zfe(p,g,_,he,je,Ye,St,Bt),g=1,q===!0&&(g|=24),q=Yo(3,null,null,g),p.current=q,q.stateNode=p,g=BA(),g.refCount++,p.pooledCache=g,g.refCount++,q.memoizedState={element:A,isDehydrated:_,cache:g},qA(q),p}function ZL(p){return p?(p=Xc,p):Xc}function XL(p,g,_,A,j,q){j=ZL(j),A.context===null?A.context=j:A.pendingContext=j,A=Mf(g),A.payload={element:_},q=q===void 0?null:q,q!==null&&(A.callback=q),_=If(p,A,g),_!==null&&(el(_,p,g),nv(_,p,g))}function JL(p,g){if(p=p.memoizedState,p!==null&&p.dehydrated!==null){var _=p.retryLane;p.retryLane=_!==0&&_<g?_:g}}function iN(p,g){JL(p,g),(p=p.alternate)&&JL(p,g)}function QL(p){if(p.tag===13){var g=cc(p,67108864);g!==null&&el(g,p,67108864),iN(p,67108864)}}var wS=!0;function Xfe(p,g,_,A){var j=U.T;U.T=null;var q=H.p;try{H.p=2,aN(p,g,_,A)}finally{H.p=q,U.T=j}}function Jfe(p,g,_,A){var j=U.T;U.T=null;var q=H.p;try{H.p=8,aN(p,g,_,A)}finally{H.p=q,U.T=j}}function aN(p,g,_,A){if(wS){var j=oN(A);if(j===null)GR(p,g,A,_S,_),tB(p,A);else if(ehe(j,p,g,_,A))A.stopPropagation();else if(tB(p,A),g&4&&-1<Qfe.indexOf(p)){for(;j!==null;){var q=Nr(j);if(q!==null)switch(q.tag){case 3:if(q=q.stateNode,q.current.memoizedState.isDehydrated){var he=ge(q.pendingLanes);if(he!==0){var je=q;for(je.pendingLanes|=2,je.entangledLanes|=2;he;){var Ye=1<<31-Ht(he);je.entanglements[1]|=Ye,he&=~Ye}nu(q),(ys&6)===0&&(iS=ce()+500,vv(0))}}break;case 13:je=cc(q,2),je!==null&&el(je,q,2),oS(),iN(q,2)}if(q=oN(A),q===null&&GR(p,g,A,_S,_),q===j)break;j=q}j!==null&&A.stopPropagation()}else GR(p,g,A,null,_)}}function oN(p){return p=ug(p),lN(p)}var _S=null;function lN(p){if(_S=null,p=gr(p),p!==null){var g=i(p);if(g===null)p=null;else{var _=g.tag;if(_===13){if(p=a(g),p!==null)return p;p=null}else if(_===3){if(g.stateNode.current.memoizedState.isDehydrated)return g.tag===3?g.stateNode.containerInfo:null;p=null}else g!==p&&(p=null)}}return _S=p,null}function eB(p){switch(p){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(oe()){case re:return 2;case Re:return 8;case Be:case Te:return 32;case lt:return 268435456;default:return 32}default:return 32}}var cN=!1,Wf=null,Hf=null,Gf=null,Tv=new Map,Av=new Map,Kf=[],Qfe="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function tB(p,g){switch(p){case"focusin":case"focusout":Wf=null;break;case"dragenter":case"dragleave":Hf=null;break;case"mouseover":case"mouseout":Gf=null;break;case"pointerover":case"pointerout":Tv.delete(g.pointerId);break;case"gotpointercapture":case"lostpointercapture":Av.delete(g.pointerId)}}function Rv(p,g,_,A,j,q){return p===null||p.nativeEvent!==q?(p={blockedOn:g,domEventName:_,eventSystemFlags:A,nativeEvent:q,targetContainers:[j]},g!==null&&(g=Nr(g),g!==null&&QL(g)),p):(p.eventSystemFlags|=A,g=p.targetContainers,j!==null&&g.indexOf(j)===-1&&g.push(j),p)}function ehe(p,g,_,A,j){switch(g){case"focusin":return Wf=Rv(Wf,p,g,_,A,j),!0;case"dragenter":return Hf=Rv(Hf,p,g,_,A,j),!0;case"mouseover":return Gf=Rv(Gf,p,g,_,A,j),!0;case"pointerover":var q=j.pointerId;return Tv.set(q,Rv(Tv.get(q)||null,p,g,_,A,j)),!0;case"gotpointercapture":return q=j.pointerId,Av.set(q,Rv(Av.get(q)||null,p,g,_,A,j)),!0}return!1}function nB(p){var g=gr(p.target);if(g!==null){var _=i(g);if(_!==null){if(g=_.tag,g===13){if(g=a(_),g!==null){p.blockedOn=g,G(p.priority,function(){if(_.tag===13){var A=Qo();A=Ct(A);var j=cc(_,A);j!==null&&el(j,_,A),iN(_,A)}});return}}else if(g===3&&_.stateNode.current.memoizedState.isDehydrated){p.blockedOn=_.tag===3?_.stateNode.containerInfo:null;return}}}p.blockedOn=null}function SS(p){if(p.blockedOn!==null)return!1;for(var g=p.targetContainers;0<g.length;){var _=oN(p.nativeEvent);if(_===null){_=p.nativeEvent;var A=new _.constructor(_.type,_);_l=A,_.target.dispatchEvent(A),_l=null}else return g=Nr(_),g!==null&&QL(g),p.blockedOn=_,!1;g.shift()}return!0}function rB(p,g,_){SS(p)&&_.delete(g)}function the(){cN=!1,Wf!==null&&SS(Wf)&&(Wf=null),Hf!==null&&SS(Hf)&&(Hf=null),Gf!==null&&SS(Gf)&&(Gf=null),Tv.forEach(rB),Av.forEach(rB)}function CS(p,g){p.blockedOn===g&&(p.blockedOn=null,cN||(cN=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,the)))}var kS=null;function sB(p){kS!==p&&(kS=p,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){kS===p&&(kS=null);for(var g=0;g<p.length;g+=3){var _=p[g],A=p[g+1],j=p[g+2];if(typeof A!="function"){if(lN(A||_)===null)continue;break}var q=Nr(_);q!==null&&(p.splice(g,3),g-=3,lR(q,{pending:!0,data:j,method:_.method,action:A},A,j))}}))}function Nv(p){function g(Ye){return CS(Ye,p)}Wf!==null&&CS(Wf,p),Hf!==null&&CS(Hf,p),Gf!==null&&CS(Gf,p),Tv.forEach(g),Av.forEach(g);for(var _=0;_<Kf.length;_++){var A=Kf[_];A.blockedOn===p&&(A.blockedOn=null)}for(;0<Kf.length&&(_=Kf[0],_.blockedOn===null);)nB(_),_.blockedOn===null&&Kf.shift();if(_=(p.ownerDocument||p).$$reactFormReplay,_!=null)for(A=0;A<_.length;A+=3){var j=_[A],q=_[A+1],he=j[De]||null;if(typeof q=="function")he||sB(_);else if(he){var je=null;if(q&&q.hasAttribute("formAction")){if(j=q,he=q[De]||null)je=he.formAction;else if(lN(j)!==null)continue}else je=he.action;typeof je=="function"?_[A+1]=je:(_.splice(A,3),A-=3),sB(_)}}}function uN(p){this._internalRoot=p}ES.prototype.render=uN.prototype.render=function(p){var g=this._internalRoot;if(g===null)throw Error(r(409));var _=g.current,A=Qo();XL(_,A,p,g,null,null)},ES.prototype.unmount=uN.prototype.unmount=function(){var p=this._internalRoot;if(p!==null){this._internalRoot=null;var g=p.containerInfo;XL(p.current,2,null,p,null,null),oS(),g[He]=null}};function ES(p){this._internalRoot=p}ES.prototype.unstable_scheduleHydration=function(p){if(p){var g=Y();p={blockedOn:null,target:p,priority:g};for(var _=0;_<Kf.length&&g!==0&&g<Kf[_].priority;_++);Kf.splice(_,0,p),_===0&&nB(p)}};var iB=t.version;if(iB!=="19.1.0")throw Error(r(527,iB,"19.1.0"));H.findDOMNode=function(p){var g=p._reactInternals;if(g===void 0)throw typeof p.render=="function"?Error(r(188)):(p=Object.keys(p).join(","),Error(r(268,p)));return p=l(g),p=p!==null?c(p):null,p=p===null?null:p.stateNode,p};var nhe={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:U,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var TS=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!TS.isDisabled&&TS.supportsFiber)try{jt=TS.inject(nhe),qt=TS}catch{}}return Iv.createRoot=function(p,g){if(!s(p))throw Error(r(299));var _=!1,A="",j=w8,q=_8,he=S8,je=null;return g!=null&&(g.unstable_strictMode===!0&&(_=!0),g.identifierPrefix!==void 0&&(A=g.identifierPrefix),g.onUncaughtError!==void 0&&(j=g.onUncaughtError),g.onCaughtError!==void 0&&(q=g.onCaughtError),g.onRecoverableError!==void 0&&(he=g.onRecoverableError),g.unstable_transitionCallbacks!==void 0&&(je=g.unstable_transitionCallbacks)),g=YL(p,1,!1,null,null,_,A,j,q,he,je,null),p[He]=g.current,HR(p),new uN(g)},Iv.hydrateRoot=function(p,g,_){if(!s(p))throw Error(r(299));var A=!1,j="",q=w8,he=_8,je=S8,Ye=null,St=null;return _!=null&&(_.unstable_strictMode===!0&&(A=!0),_.identifierPrefix!==void 0&&(j=_.identifierPrefix),_.onUncaughtError!==void 0&&(q=_.onUncaughtError),_.onCaughtError!==void 0&&(he=_.onCaughtError),_.onRecoverableError!==void 0&&(je=_.onRecoverableError),_.unstable_transitionCallbacks!==void 0&&(Ye=_.unstable_transitionCallbacks),_.formState!==void 0&&(St=_.formState)),g=YL(p,1,!0,g,_??null,A,j,q,he,je,Ye,St),g.context=ZL(null),_=g.current,A=Qo(),A=Ct(A),j=Mf(A),j.callback=null,If(_,j,A),_=A,g.current.lanes=_,tt(g,_),nu(g),p[He]=g.current,HR(p),new ES(g)},Iv.version="19.1.0",Iv}var mB;function bhe(){if(mB)return hN.exports;mB=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),hN.exports=yhe(),hN.exports}var vhe=bhe();const xhe=ua(vhe);function gB(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function gl(...e){return t=>{let n=!1;const r=e.map(s=>{const i=gB(s,t);return!n&&typeof i=="function"&&(n=!0),i});if(n)return()=>{for(let s=0;s<r.length;s++){const i=r[s];typeof i=="function"?i():gB(e[s],null)}}}}function Mn(...e){return E.useCallback(gl(...e),e)}function Mu(e){const t=whe(e),n=E.forwardRef((r,s)=>{const{children:i,...a}=r,o=E.Children.toArray(i),l=o.find(She);if(l){const c=l.props.children,u=o.map(d=>d===l?E.Children.count(c)>1?E.Children.only(null):E.isValidElement(c)?c.props.children:null:d);return f.jsx(t,{...a,ref:s,children:E.isValidElement(c)?E.cloneElement(c,void 0,u):null})}return f.jsx(t,{...a,ref:s,children:i})});return n.displayName=`${e}.Slot`,n}var nH=Mu("Slot");function whe(e){const t=E.forwardRef((n,r)=>{const{children:s,...i}=n;if(E.isValidElement(s)){const a=khe(s),o=Che(i,s.props);return s.type!==E.Fragment&&(o.ref=r?gl(r,a):a),E.cloneElement(s,o)}return E.Children.count(s)>1?E.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var _he=Symbol("radix.slottable");function She(e){return E.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===_he}function Che(e,t){const n={...t};for(const r in t){const s=e[r],i=t[r];/^on[A-Z]/.test(r)?s&&i?n[r]=(...o)=>{const l=i(...o);return s(...o),l}:s&&(n[r]=s):r==="style"?n[r]={...s,...i}:r==="className"&&(n[r]=[s,i].filter(Boolean).join(" "))}return{...e,...n}}function khe(e){var r,s;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(s=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:s.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}function rH(e){var t,n,r="";if(typeof e=="string"||typeof e=="number")r+=e;else if(typeof e=="object")if(Array.isArray(e)){var s=e.length;for(t=0;t<s;t++)e[t]&&(n=rH(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}function sH(){for(var e,t,n=0,r="",s=arguments.length;n<s;n++)(e=arguments[n])&&(t=rH(e))&&(r&&(r+=" "),r+=t);return r}const yB=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,bB=sH,LO=(e,t)=>n=>{var r;if((t==null?void 0:t.variants)==null)return bB(e,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:s,defaultVariants:i}=t,a=Object.keys(s).map(c=>{const u=n==null?void 0:n[c],d=i==null?void 0:i[c];if(u===null)return null;const h=yB(u)||yB(d);return s[c][h]}),o=n&&Object.entries(n).reduce((c,u)=>{let[d,h]=u;return h===void 0||(c[d]=h),c},{}),l=t==null||(r=t.compoundVariants)===null||r===void 0?void 0:r.reduce((c,u)=>{let{class:d,className:h,...m}=u;return Object.entries(m).every(y=>{let[b,v]=y;return Array.isArray(v)?v.includes({...i,...o}[b]):{...i,...o}[b]===v})?[...c,d,h]:c},[]);return bB(e,a,l,n==null?void 0:n.class,n==null?void 0:n.className)},BO="-",Ehe=e=>{const t=Ahe(e),{conflictingClassGroups:n,conflictingClassGroupModifiers:r}=e;return{getClassGroupId:a=>{const o=a.split(BO);return o[0]===""&&o.length!==1&&o.shift(),iH(o,t)||The(a)},getConflictingClassGroupIds:(a,o)=>{const l=n[a]||[];return o&&r[a]?[...l,...r[a]]:l}}},iH=(e,t)=>{var a;if(e.length===0)return t.classGroupId;const n=e[0],r=t.nextPart.get(n),s=r?iH(e.slice(1),r):void 0;if(s)return s;if(t.validators.length===0)return;const i=e.join(BO);return(a=t.validators.find(({validator:o})=>o(i)))==null?void 0:a.classGroupId},vB=/^\[(.+)\]$/,The=e=>{if(vB.test(e)){const t=vB.exec(e)[1],n=t==null?void 0:t.substring(0,t.indexOf(":"));if(n)return"arbitrary.."+n}},Ahe=e=>{const{theme:t,classGroups:n}=e,r={nextPart:new Map,validators:[]};for(const s in n)G3(n[s],r,s,t);return r},G3=(e,t,n,r)=>{e.forEach(s=>{if(typeof s=="string"){const i=s===""?t:xB(t,s);i.classGroupId=n;return}if(typeof s=="function"){if(Rhe(s)){G3(s(r),t,n,r);return}t.validators.push({validator:s,classGroupId:n});return}Object.entries(s).forEach(([i,a])=>{G3(a,xB(t,i),n,r)})})},xB=(e,t)=>{let n=e;return t.split(BO).forEach(r=>{n.nextPart.has(r)||n.nextPart.set(r,{nextPart:new Map,validators:[]}),n=n.nextPart.get(r)}),n},Rhe=e=>e.isThemeGetter,Nhe=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,n=new Map,r=new Map;const s=(i,a)=>{n.set(i,a),t++,t>e&&(t=0,r=n,n=new Map)};return{get(i){let a=n.get(i);if(a!==void 0)return a;if((a=r.get(i))!==void 0)return s(i,a),a},set(i,a){n.has(i)?n.set(i,a):s(i,a)}}},K3="!",Y3=":",Mhe=Y3.length,Ihe=e=>{const{prefix:t,experimentalParseClassName:n}=e;let r=s=>{const i=[];let a=0,o=0,l=0,c;for(let y=0;y<s.length;y++){let b=s[y];if(a===0&&o===0){if(b===Y3){i.push(s.slice(l,y)),l=y+Mhe;continue}if(b==="/"){c=y;continue}}b==="["?a++:b==="]"?a--:b==="("?o++:b===")"&&o--}const u=i.length===0?s:s.substring(l),d=jhe(u),h=d!==u,m=c&&c>l?c-l:void 0;return{modifiers:i,hasImportantModifier:h,baseClassName:d,maybePostfixModifierPosition:m}};if(t){const s=t+Y3,i=r;r=a=>a.startsWith(s)?i(a.substring(s.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:a,maybePostfixModifierPosition:void 0}}if(n){const s=r;r=i=>n({className:i,parseClassName:s})}return r},jhe=e=>e.endsWith(K3)?e.substring(0,e.length-1):e.startsWith(K3)?e.substring(1):e,Ohe=e=>{const t=Object.fromEntries(e.orderSensitiveModifiers.map(r=>[r,!0]));return r=>{if(r.length<=1)return r;const s=[];let i=[];return r.forEach(a=>{a[0]==="["||t[a]?(s.push(...i.sort(),a),i=[]):i.push(a)}),s.push(...i.sort()),s}},Phe=e=>({cache:Nhe(e.cacheSize),parseClassName:Ihe(e),sortModifiers:Ohe(e),...Ehe(e)}),Dhe=/\s+/,Fhe=(e,t)=>{const{parseClassName:n,getClassGroupId:r,getConflictingClassGroupIds:s,sortModifiers:i}=t,a=[],o=e.trim().split(Dhe);let l="";for(let c=o.length-1;c>=0;c-=1){const u=o[c],{isExternal:d,modifiers:h,hasImportantModifier:m,baseClassName:y,maybePostfixModifierPosition:b}=n(u);if(d){l=u+(l.length>0?" "+l:l);continue}let v=!!b,x=r(v?y.substring(0,b):y);if(!x){if(!v){l=u+(l.length>0?" "+l:l);continue}if(x=r(y),!x){l=u+(l.length>0?" "+l:l);continue}v=!1}const w=i(h).join(":"),S=m?w+K3:w,k=S+x;if(a.includes(k))continue;a.push(k);const C=s(x,v);for(let T=0;T<C.length;++T){const R=C[T];a.push(S+R)}l=u+(l.length>0?" "+l:l)}return l};function Lhe(){let e=0,t,n,r="";for(;e<arguments.length;)(t=arguments[e++])&&(n=aH(t))&&(r&&(r+=" "),r+=n);return r}const aH=e=>{if(typeof e=="string")return e;let t,n="";for(let r=0;r<e.length;r++)e[r]&&(t=aH(e[r]))&&(n&&(n+=" "),n+=t);return n};function Bhe(e,...t){let n,r,s,i=a;function a(l){const c=t.reduce((u,d)=>d(u),e());return n=Phe(c),r=n.cache.get,s=n.cache.set,i=o,o(l)}function o(l){const c=r(l);if(c)return c;const u=Fhe(l,n);return s(l,u),u}return function(){return i(Lhe.apply(null,arguments))}}const Bi=e=>{const t=n=>n[e]||[];return t.isThemeGetter=!0,t},oH=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,lH=/^\((?:(\w[\w-]*):)?(.+)\)$/i,$he=/^\d+\/\d+$/,zhe=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,Uhe=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,qhe=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,Vhe=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,Whe=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Xg=e=>$he.test(e),jr=e=>!!e&&!Number.isNaN(Number(e)),Zf=e=>!!e&&Number.isInteger(Number(e)),yN=e=>e.endsWith("%")&&jr(e.slice(0,-1)),yd=e=>zhe.test(e),Hhe=()=>!0,Ghe=e=>Uhe.test(e)&&!qhe.test(e),cH=()=>!1,Khe=e=>Vhe.test(e),Yhe=e=>Whe.test(e),Zhe=e=>!wn(e)&&!_n(e),Xhe=e=>$y(e,fH,cH),wn=e=>oH.test(e),Op=e=>$y(e,hH,Ghe),bN=e=>$y(e,npe,jr),wB=e=>$y(e,uH,cH),Jhe=e=>$y(e,dH,Yhe),AS=e=>$y(e,pH,Khe),_n=e=>lH.test(e),jv=e=>zy(e,hH),Qhe=e=>zy(e,rpe),_B=e=>zy(e,uH),epe=e=>zy(e,fH),tpe=e=>zy(e,dH),RS=e=>zy(e,pH,!0),$y=(e,t,n)=>{const r=oH.exec(e);return r?r[1]?t(r[1]):n(r[2]):!1},zy=(e,t,n=!1)=>{const r=lH.exec(e);return r?r[1]?t(r[1]):n:!1},uH=e=>e==="position"||e==="percentage",dH=e=>e==="image"||e==="url",fH=e=>e==="length"||e==="size"||e==="bg-size",hH=e=>e==="length",npe=e=>e==="number",rpe=e=>e==="family-name",pH=e=>e==="shadow",spe=()=>{const e=Bi("color"),t=Bi("font"),n=Bi("text"),r=Bi("font-weight"),s=Bi("tracking"),i=Bi("leading"),a=Bi("breakpoint"),o=Bi("container"),l=Bi("spacing"),c=Bi("radius"),u=Bi("shadow"),d=Bi("inset-shadow"),h=Bi("text-shadow"),m=Bi("drop-shadow"),y=Bi("blur"),b=Bi("perspective"),v=Bi("aspect"),x=Bi("ease"),w=Bi("animate"),S=()=>["auto","avoid","all","avoid-page","page","left","right","column"],k=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],C=()=>[...k(),_n,wn],T=()=>["auto","hidden","clip","visible","scroll"],R=()=>["auto","contain","none"],N=()=>[_n,wn,l],I=()=>[Xg,"full","auto",...N()],P=()=>[Zf,"none","subgrid",_n,wn],B=()=>["auto",{span:["full",Zf,_n,wn]},Zf,_n,wn],D=()=>[Zf,"auto",_n,wn],W=()=>["auto","min","max","fr",_n,wn],O=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],Z=()=>["start","end","center","stretch","center-safe","end-safe"],U=()=>["auto",...N()],H=()=>[Xg,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...N()],L=()=>[e,_n,wn],te=()=>[...k(),_B,wB,{position:[_n,wn]}],V=()=>["no-repeat",{repeat:["","x","y","space","round"]}],Q=()=>["auto","cover","contain",epe,Xhe,{size:[_n,wn]}],ee=()=>[yN,jv,Op],se=()=>["","none","full",c,_n,wn],pe=()=>["",jr,jv,Op],ue=()=>["solid","dashed","dotted","double"],Oe=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],Fe=()=>[jr,yN,_B,wB],Se=()=>["","none",y,_n,wn],Ce=()=>["none",jr,_n,wn],qe=()=>["none",jr,_n,wn],Qe=()=>[jr,_n,wn],We=()=>[Xg,"full",...N()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[yd],breakpoint:[yd],color:[Hhe],container:[yd],"drop-shadow":[yd],ease:["in","out","in-out"],font:[Zhe],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[yd],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[yd],shadow:[yd],spacing:["px",jr],text:[yd],"text-shadow":[yd],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",Xg,wn,_n,v]}],container:["container"],columns:[{columns:[jr,wn,_n,o]}],"break-after":[{"break-after":S()}],"break-before":[{"break-before":S()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:C()}],overflow:[{overflow:T()}],"overflow-x":[{"overflow-x":T()}],"overflow-y":[{"overflow-y":T()}],overscroll:[{overscroll:R()}],"overscroll-x":[{"overscroll-x":R()}],"overscroll-y":[{"overscroll-y":R()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:I()}],"inset-x":[{"inset-x":I()}],"inset-y":[{"inset-y":I()}],start:[{start:I()}],end:[{end:I()}],top:[{top:I()}],right:[{right:I()}],bottom:[{bottom:I()}],left:[{left:I()}],visibility:["visible","invisible","collapse"],z:[{z:[Zf,"auto",_n,wn]}],basis:[{basis:[Xg,"full","auto",o,...N()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[jr,Xg,"auto","initial","none",wn]}],grow:[{grow:["",jr,_n,wn]}],shrink:[{shrink:["",jr,_n,wn]}],order:[{order:[Zf,"first","last","none",_n,wn]}],"grid-cols":[{"grid-cols":P()}],"col-start-end":[{col:B()}],"col-start":[{"col-start":D()}],"col-end":[{"col-end":D()}],"grid-rows":[{"grid-rows":P()}],"row-start-end":[{row:B()}],"row-start":[{"row-start":D()}],"row-end":[{"row-end":D()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":W()}],"auto-rows":[{"auto-rows":W()}],gap:[{gap:N()}],"gap-x":[{"gap-x":N()}],"gap-y":[{"gap-y":N()}],"justify-content":[{justify:[...O(),"normal"]}],"justify-items":[{"justify-items":[...Z(),"normal"]}],"justify-self":[{"justify-self":["auto",...Z()]}],"align-content":[{content:["normal",...O()]}],"align-items":[{items:[...Z(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...Z(),{baseline:["","last"]}]}],"place-content":[{"place-content":O()}],"place-items":[{"place-items":[...Z(),"baseline"]}],"place-self":[{"place-self":["auto",...Z()]}],p:[{p:N()}],px:[{px:N()}],py:[{py:N()}],ps:[{ps:N()}],pe:[{pe:N()}],pt:[{pt:N()}],pr:[{pr:N()}],pb:[{pb:N()}],pl:[{pl:N()}],m:[{m:U()}],mx:[{mx:U()}],my:[{my:U()}],ms:[{ms:U()}],me:[{me:U()}],mt:[{mt:U()}],mr:[{mr:U()}],mb:[{mb:U()}],ml:[{ml:U()}],"space-x":[{"space-x":N()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":N()}],"space-y-reverse":["space-y-reverse"],size:[{size:H()}],w:[{w:[o,"screen",...H()]}],"min-w":[{"min-w":[o,"screen","none",...H()]}],"max-w":[{"max-w":[o,"screen","none","prose",{screen:[a]},...H()]}],h:[{h:["screen",...H()]}],"min-h":[{"min-h":["screen","none",...H()]}],"max-h":[{"max-h":["screen",...H()]}],"font-size":[{text:["base",n,jv,Op]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[r,_n,bN]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",yN,wn]}],"font-family":[{font:[Qhe,wn,t]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[s,_n,wn]}],"line-clamp":[{"line-clamp":[jr,"none",_n,bN]}],leading:[{leading:[i,...N()]}],"list-image":[{"list-image":["none",_n,wn]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",_n,wn]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:L()}],"text-color":[{text:L()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...ue(),"wavy"]}],"text-decoration-thickness":[{decoration:[jr,"from-font","auto",_n,Op]}],"text-decoration-color":[{decoration:L()}],"underline-offset":[{"underline-offset":[jr,"auto",_n,wn]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:N()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",_n,wn]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",_n,wn]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:te()}],"bg-repeat":[{bg:V()}],"bg-size":[{bg:Q()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},Zf,_n,wn],radial:["",_n,wn],conic:[Zf,_n,wn]},tpe,Jhe]}],"bg-color":[{bg:L()}],"gradient-from-pos":[{from:ee()}],"gradient-via-pos":[{via:ee()}],"gradient-to-pos":[{to:ee()}],"gradient-from":[{from:L()}],"gradient-via":[{via:L()}],"gradient-to":[{to:L()}],rounded:[{rounded:se()}],"rounded-s":[{"rounded-s":se()}],"rounded-e":[{"rounded-e":se()}],"rounded-t":[{"rounded-t":se()}],"rounded-r":[{"rounded-r":se()}],"rounded-b":[{"rounded-b":se()}],"rounded-l":[{"rounded-l":se()}],"rounded-ss":[{"rounded-ss":se()}],"rounded-se":[{"rounded-se":se()}],"rounded-ee":[{"rounded-ee":se()}],"rounded-es":[{"rounded-es":se()}],"rounded-tl":[{"rounded-tl":se()}],"rounded-tr":[{"rounded-tr":se()}],"rounded-br":[{"rounded-br":se()}],"rounded-bl":[{"rounded-bl":se()}],"border-w":[{border:pe()}],"border-w-x":[{"border-x":pe()}],"border-w-y":[{"border-y":pe()}],"border-w-s":[{"border-s":pe()}],"border-w-e":[{"border-e":pe()}],"border-w-t":[{"border-t":pe()}],"border-w-r":[{"border-r":pe()}],"border-w-b":[{"border-b":pe()}],"border-w-l":[{"border-l":pe()}],"divide-x":[{"divide-x":pe()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":pe()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...ue(),"hidden","none"]}],"divide-style":[{divide:[...ue(),"hidden","none"]}],"border-color":[{border:L()}],"border-color-x":[{"border-x":L()}],"border-color-y":[{"border-y":L()}],"border-color-s":[{"border-s":L()}],"border-color-e":[{"border-e":L()}],"border-color-t":[{"border-t":L()}],"border-color-r":[{"border-r":L()}],"border-color-b":[{"border-b":L()}],"border-color-l":[{"border-l":L()}],"divide-color":[{divide:L()}],"outline-style":[{outline:[...ue(),"none","hidden"]}],"outline-offset":[{"outline-offset":[jr,_n,wn]}],"outline-w":[{outline:["",jr,jv,Op]}],"outline-color":[{outline:L()}],shadow:[{shadow:["","none",u,RS,AS]}],"shadow-color":[{shadow:L()}],"inset-shadow":[{"inset-shadow":["none",d,RS,AS]}],"inset-shadow-color":[{"inset-shadow":L()}],"ring-w":[{ring:pe()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:L()}],"ring-offset-w":[{"ring-offset":[jr,Op]}],"ring-offset-color":[{"ring-offset":L()}],"inset-ring-w":[{"inset-ring":pe()}],"inset-ring-color":[{"inset-ring":L()}],"text-shadow":[{"text-shadow":["none",h,RS,AS]}],"text-shadow-color":[{"text-shadow":L()}],opacity:[{opacity:[jr,_n,wn]}],"mix-blend":[{"mix-blend":[...Oe(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":Oe()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[jr]}],"mask-image-linear-from-pos":[{"mask-linear-from":Fe()}],"mask-image-linear-to-pos":[{"mask-linear-to":Fe()}],"mask-image-linear-from-color":[{"mask-linear-from":L()}],"mask-image-linear-to-color":[{"mask-linear-to":L()}],"mask-image-t-from-pos":[{"mask-t-from":Fe()}],"mask-image-t-to-pos":[{"mask-t-to":Fe()}],"mask-image-t-from-color":[{"mask-t-from":L()}],"mask-image-t-to-color":[{"mask-t-to":L()}],"mask-image-r-from-pos":[{"mask-r-from":Fe()}],"mask-image-r-to-pos":[{"mask-r-to":Fe()}],"mask-image-r-from-color":[{"mask-r-from":L()}],"mask-image-r-to-color":[{"mask-r-to":L()}],"mask-image-b-from-pos":[{"mask-b-from":Fe()}],"mask-image-b-to-pos":[{"mask-b-to":Fe()}],"mask-image-b-from-color":[{"mask-b-from":L()}],"mask-image-b-to-color":[{"mask-b-to":L()}],"mask-image-l-from-pos":[{"mask-l-from":Fe()}],"mask-image-l-to-pos":[{"mask-l-to":Fe()}],"mask-image-l-from-color":[{"mask-l-from":L()}],"mask-image-l-to-color":[{"mask-l-to":L()}],"mask-image-x-from-pos":[{"mask-x-from":Fe()}],"mask-image-x-to-pos":[{"mask-x-to":Fe()}],"mask-image-x-from-color":[{"mask-x-from":L()}],"mask-image-x-to-color":[{"mask-x-to":L()}],"mask-image-y-from-pos":[{"mask-y-from":Fe()}],"mask-image-y-to-pos":[{"mask-y-to":Fe()}],"mask-image-y-from-color":[{"mask-y-from":L()}],"mask-image-y-to-color":[{"mask-y-to":L()}],"mask-image-radial":[{"mask-radial":[_n,wn]}],"mask-image-radial-from-pos":[{"mask-radial-from":Fe()}],"mask-image-radial-to-pos":[{"mask-radial-to":Fe()}],"mask-image-radial-from-color":[{"mask-radial-from":L()}],"mask-image-radial-to-color":[{"mask-radial-to":L()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":k()}],"mask-image-conic-pos":[{"mask-conic":[jr]}],"mask-image-conic-from-pos":[{"mask-conic-from":Fe()}],"mask-image-conic-to-pos":[{"mask-conic-to":Fe()}],"mask-image-conic-from-color":[{"mask-conic-from":L()}],"mask-image-conic-to-color":[{"mask-conic-to":L()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:te()}],"mask-repeat":[{mask:V()}],"mask-size":[{mask:Q()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",_n,wn]}],filter:[{filter:["","none",_n,wn]}],blur:[{blur:Se()}],brightness:[{brightness:[jr,_n,wn]}],contrast:[{contrast:[jr,_n,wn]}],"drop-shadow":[{"drop-shadow":["","none",m,RS,AS]}],"drop-shadow-color":[{"drop-shadow":L()}],grayscale:[{grayscale:["",jr,_n,wn]}],"hue-rotate":[{"hue-rotate":[jr,_n,wn]}],invert:[{invert:["",jr,_n,wn]}],saturate:[{saturate:[jr,_n,wn]}],sepia:[{sepia:["",jr,_n,wn]}],"backdrop-filter":[{"backdrop-filter":["","none",_n,wn]}],"backdrop-blur":[{"backdrop-blur":Se()}],"backdrop-brightness":[{"backdrop-brightness":[jr,_n,wn]}],"backdrop-contrast":[{"backdrop-contrast":[jr,_n,wn]}],"backdrop-grayscale":[{"backdrop-grayscale":["",jr,_n,wn]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[jr,_n,wn]}],"backdrop-invert":[{"backdrop-invert":["",jr,_n,wn]}],"backdrop-opacity":[{"backdrop-opacity":[jr,_n,wn]}],"backdrop-saturate":[{"backdrop-saturate":[jr,_n,wn]}],"backdrop-sepia":[{"backdrop-sepia":["",jr,_n,wn]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":N()}],"border-spacing-x":[{"border-spacing-x":N()}],"border-spacing-y":[{"border-spacing-y":N()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",_n,wn]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[jr,"initial",_n,wn]}],ease:[{ease:["linear","initial",x,_n,wn]}],delay:[{delay:[jr,_n,wn]}],animate:[{animate:["none",w,_n,wn]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[b,_n,wn]}],"perspective-origin":[{"perspective-origin":C()}],rotate:[{rotate:Ce()}],"rotate-x":[{"rotate-x":Ce()}],"rotate-y":[{"rotate-y":Ce()}],"rotate-z":[{"rotate-z":Ce()}],scale:[{scale:qe()}],"scale-x":[{"scale-x":qe()}],"scale-y":[{"scale-y":qe()}],"scale-z":[{"scale-z":qe()}],"scale-3d":["scale-3d"],skew:[{skew:Qe()}],"skew-x":[{"skew-x":Qe()}],"skew-y":[{"skew-y":Qe()}],transform:[{transform:[_n,wn,"","none","gpu","cpu"]}],"transform-origin":[{origin:C()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:We()}],"translate-x":[{"translate-x":We()}],"translate-y":[{"translate-y":We()}],"translate-z":[{"translate-z":We()}],"translate-none":["translate-none"],accent:[{accent:L()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:L()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",_n,wn]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":N()}],"scroll-mx":[{"scroll-mx":N()}],"scroll-my":[{"scroll-my":N()}],"scroll-ms":[{"scroll-ms":N()}],"scroll-me":[{"scroll-me":N()}],"scroll-mt":[{"scroll-mt":N()}],"scroll-mr":[{"scroll-mr":N()}],"scroll-mb":[{"scroll-mb":N()}],"scroll-ml":[{"scroll-ml":N()}],"scroll-p":[{"scroll-p":N()}],"scroll-px":[{"scroll-px":N()}],"scroll-py":[{"scroll-py":N()}],"scroll-ps":[{"scroll-ps":N()}],"scroll-pe":[{"scroll-pe":N()}],"scroll-pt":[{"scroll-pt":N()}],"scroll-pr":[{"scroll-pr":N()}],"scroll-pb":[{"scroll-pb":N()}],"scroll-pl":[{"scroll-pl":N()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",_n,wn]}],fill:[{fill:["none",...L()]}],"stroke-w":[{stroke:[jr,jv,Op,bN]}],stroke:[{stroke:["none",...L()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},ipe=Bhe(spe);function Xe(...e){return ipe(sH(e))}const Z3=LO("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function mt({className:e,variant:t,size:n,asChild:r=!1,...s}){const i=r?nH:"button";return f.jsx(i,{"data-slot":"button",className:Xe(Z3({variant:t,size:n,className:e})),...s})}/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ape=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),ope=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,n,r)=>r?r.toUpperCase():n.toLowerCase()),SB=e=>{const t=ope(e);return t.charAt(0).toUpperCase()+t.slice(1)},mH=(...e)=>e.filter((t,n,r)=>!!t&&t.trim()!==""&&r.indexOf(t)===n).join(" ").trim();/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var lpe={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cpe=E.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:s="",children:i,iconNode:a,...o},l)=>E.createElement("svg",{ref:l,...lpe,width:t,height:t,stroke:e,strokeWidth:r?Number(n)*24/Number(t):n,className:mH("lucide",s),...o},[...a.map(([c,u])=>E.createElement(c,u)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ut=(e,t)=>{const n=E.forwardRef(({className:r,...s},i)=>E.createElement(cpe,{ref:i,iconNode:t,className:mH(`lucide-${ape(SB(e))}`,`lucide-${e}`,r),...s}));return n.displayName=SB(e),n};/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const upe=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],gH=Ut("archive",upe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dpe=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],yH=Ut("arrow-down",dpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fpe=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],hpe=Ut("arrow-left",fpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ppe=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],mpe=Ut("arrow-right",ppe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gpe=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],ype=Ut("arrow-up",gpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bpe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]],vpe=Ut("ban",bpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xpe=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M16 12h2",key:"7q9ll5"}],["path",{d:"M16 8h2",key:"msurwy"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}],["path",{d:"M6 12h2",key:"32wvfc"}],["path",{d:"M6 8h2",key:"30oboj"}]],wpe=Ut("book-open-text",xpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _pe=[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]],X0=Ut("bot",_pe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Spe=[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M9 13a4.5 4.5 0 0 0 3-4",key:"10igwf"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M12 13h4",key:"1ku699"}],["path",{d:"M12 18h6a2 2 0 0 1 2 2v1",key:"105ag5"}],["path",{d:"M12 8h8",key:"1lhi5i"}],["path",{d:"M16 8V5a2 2 0 0 1 2-2",key:"u6izg6"}],["circle",{cx:"16",cy:"13",r:".5",key:"ry7gng"}],["circle",{cx:"18",cy:"3",r:".5",key:"1aiba7"}],["circle",{cx:"20",cy:"21",r:".5",key:"yhc1fs"}],["circle",{cx:"20",cy:"8",r:".5",key:"1e43v0"}]],Uy=Ut("brain-circuit",Spe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cpe=[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]],CB=Ut("brain",Cpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kpe=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],Epe=Ut("calendar",kpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tpe=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],ao=Ut("check",Tpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ape=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Jl=Ut("chevron-down",Ape);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rpe=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],Npe=Ut("chevron-left",Rpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mpe=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],$O=Ut("chevron-right",Mpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ipe=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],Bh=Ut("chevron-up",Ipe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jpe=[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]],fE=Ut("chevrons-up-down",jpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ope=[["path",{d:"m17 11-5-5-5 5",key:"e8nh98"}],["path",{d:"m17 18-5-5-5 5",key:"2avn1x"}]],Ppe=Ut("chevrons-up",Ope);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dpe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Kl=Ut("circle-alert",Dpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fpe=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Lpe=Ut("circle-check-big",Fpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bpe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],hE=Ut("circle-check",Bpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $pe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["rect",{x:"9",y:"9",width:"6",height:"6",rx:"1",key:"1ssd4o"}]],zpe=Ut("circle-stop",$pe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Upe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],qpe=Ut("circle",Upe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vpe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],Wpe=Ut("circle-x",Vpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hpe=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]],pE=Ut("clipboard",Hpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gpe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]],Kpe=Ut("clock",Gpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ype=[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]],zO=Ut("cloud-upload",Ype);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zpe=[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]],mE=Ut("code",Zpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xpe=[["path",{d:"M12 20a8 8 0 1 0 0-16 8 8 0 0 0 0 16Z",key:"sobvz5"}],["path",{d:"M12 14a2 2 0 1 0 0-4 2 2 0 0 0 0 4Z",key:"11i496"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 22v-2",key:"1osdcq"}],["path",{d:"m17 20.66-1-1.73",key:"eq3orb"}],["path",{d:"M11 10.27 7 3.34",key:"16pf9h"}],["path",{d:"m20.66 17-1.73-1",key:"sg0v6f"}],["path",{d:"m3.34 7 1.73 1",key:"1ulond"}],["path",{d:"M14 12h8",key:"4f43i9"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"m20.66 7-1.73 1",key:"1ow05n"}],["path",{d:"m3.34 17 1.73-1",key:"nuk764"}],["path",{d:"m17 3.34-1 1.73",key:"2wel8s"}],["path",{d:"m11 13.73-4 6.93",key:"794ttg"}]],Jpe=Ut("cog",Xpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qpe=[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]],eme=Ut("coins",Qpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tme=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],nme=Ut("copy",tme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rme=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],sme=Ut("dollar-sign",rme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ime=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]],Ec=Ut("download",ime);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ame=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]],ome=Ut("ellipsis-vertical",ame);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lme=[["path",{d:"M10 12v-1",key:"v7bkov"}],["path",{d:"M10 18v-2",key:"1cjy8d"}],["path",{d:"M10 7V6",key:"dljcrl"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M15.5 22H18a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v16a2 2 0 0 0 .274 1.01",key:"gkbcor"}],["circle",{cx:"10",cy:"20",r:"2",key:"1xzdoj"}]],cme=Ut("file-archive",lme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ume=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]],dme=Ut("file-down",ume);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fme=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 12a1 1 0 0 0-1 1v1a1 1 0 0 1-1 1 1 1 0 0 1 1 1v1a1 1 0 0 0 1 1",key:"1oajmo"}],["path",{d:"M14 18a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1 1 1 0 0 1-1-1v-1a1 1 0 0 0-1-1",key:"mpwhp6"}]],hme=Ut("file-json",fme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pme=[["path",{d:"M12 17h.01",key:"p32p05"}],["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7z",key:"1mlx9k"}],["path",{d:"M9.1 9a3 3 0 0 1 5.82 1c0 2-3 3-3 3",key:"mhlwft"}]],mme=Ut("file-question",pme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gme=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],X3=Ut("file-text",gme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yme=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 12v6",key:"3ahymv"}],["path",{d:"m15 15-3-3-3 3",key:"15xj92"}]],bme=Ut("file-up",yme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vme=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]],bH=Ut("file",vme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xme=[["circle",{cx:"12",cy:"13",r:"2",key:"1c1ljs"}],["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}],["path",{d:"M14 13h3",key:"1dgedf"}],["path",{d:"M7 13h3",key:"1pygq7"}]],vH=Ut("folder-git",xme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wme=[["path",{d:"M12 10v6",key:"1bos4e"}],["path",{d:"M9 13h6",key:"1uhe8q"}],["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],xH=Ut("folder-plus",wme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _me=[["path",{d:"M20 10a1 1 0 0 0 1-1V6a1 1 0 0 0-1-1h-2.5a1 1 0 0 1-.8-.4l-.9-1.2A1 1 0 0 0 15 3h-2a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1Z",key:"hod4my"}],["path",{d:"M20 21a1 1 0 0 0 1-1v-3a1 1 0 0 0-1-1h-2.9a1 1 0 0 1-.88-.55l-.42-.85a1 1 0 0 0-.92-.6H13a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1Z",key:"w4yl2u"}],["path",{d:"M3 5a2 2 0 0 0 2 2h3",key:"f2jnh7"}],["path",{d:"M3 3v13a2 2 0 0 0 2 2h3",key:"k8epm1"}]],kB=Ut("folder-tree",_me);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sme=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}],["path",{d:"M12 10v6",key:"1bos4e"}],["path",{d:"m9 13 3-3 3 3",key:"1pxg3c"}]],Cme=Ut("folder-up",Sme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kme=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],yh=Ut("folder",kme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eme=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],Tme=Ut("funnel",Eme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ame=[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]],Ic=Ut("git-branch",Ame);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rme=[["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}],["line",{x1:"3",x2:"9",y1:"12",y2:"12",key:"1dyftd"}],["line",{x1:"15",x2:"21",y1:"12",y2:"12",key:"oup4p8"}]],wH=Ut("git-commit-horizontal",Rme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nme=[["circle",{cx:"12",cy:"18",r:"3",key:"1mpf1b"}],["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["path",{d:"M18 9v2c0 .6-.4 1-1 1H7c-.6 0-1-.4-1-1V9",key:"1uq4wg"}],["path",{d:"M12 12v3",key:"158kv8"}]],_H=Ut("git-fork",Nme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mme=[["circle",{cx:"18",cy:"18",r:"3",key:"1xkwt0"}],["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M6 21V9a9 9 0 0 0 9 9",key:"7kw0sc"}]],SH=Ut("git-merge",Mme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ime=[["circle",{cx:"18",cy:"18",r:"3",key:"1xkwt0"}],["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M13 6h3a2 2 0 0 1 2 2v7",key:"1yeb86"}],["line",{x1:"6",x2:"6",y1:"9",y2:"21",key:"rroup"}]],UO=Ut("git-pull-request",Ime);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jme=[["path",{d:"M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4",key:"tonef"}],["path",{d:"M9 18c-4.51 2-5-2-7-2",key:"9comsn"}]],Ome=Ut("github",jme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pme=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],EB=Ut("globe",Pme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dme=[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]],Fme=Ut("grip-vertical",Dme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lme=[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]],qO=Ut("hard-drive",Lme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bme=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],$me=Ut("history",Bme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zme=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]],Ume=Ut("house",zme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qme=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],J0=Ut("image",qme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vme=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],VO=Ut("info",Vme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wme=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],Hx=Ut("key",Wme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hme=[["path",{d:"m12 8 6-3-6-3v10",key:"mvpnpy"}],["path",{d:"m8 11.99-5.5 3.14a1 1 0 0 0 0 1.74l8.5 4.86a2 2 0 0 0 2 0l8.5-4.86a1 1 0 0 0 0-1.74L16 12",key:"ek95tt"}],["path",{d:"m6.49 12.85 11.02 6.3",key:"1kt42w"}],["path",{d:"M17.51 12.85 6.5 19.15",key:"v55bdg"}]],CH=Ut("land-plot",Hme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gme=[["path",{d:"M21 6H3",key:"1jwq7v"}],["path",{d:"M7 12H3",key:"13ou7f"}],["path",{d:"M7 18H3",key:"1sijw9"}],["path",{d:"M12 18a5 5 0 0 0 9-3 4.5 4.5 0 0 0-4.5-4.5c-1.33 0-2.54.54-3.41 1.41L11 14",key:"qth677"}],["path",{d:"M11 10v4h4",key:"172dkj"}]],Kme=Ut("list-restart",Gme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yme=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Xn=Ut("loader-circle",Yme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zme=[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]],Xme=Ut("menu",Zme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jme=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}],["path",{d:"M12 7v6",key:"lw1j43"}],["path",{d:"M9 10h6",key:"9gxzsh"}]],Qme=Ut("message-square-plus",Jme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ege=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}],["path",{d:"M13 8H7",key:"14i4kc"}],["path",{d:"M17 12H7",key:"16if0g"}]],TB=Ut("message-square-text",ege);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tge=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]],J3=Ut("message-square",tge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nge=[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]],rge=Ut("music",nge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sge=[["path",{d:"M13.4 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-7.4",key:"re6nr2"}],["path",{d:"M2 6h4",key:"aawbzj"}],["path",{d:"M2 10h4",key:"l0bgd4"}],["path",{d:"M2 14h4",key:"1gsvsf"}],["path",{d:"M2 18h4",key:"1bu2t1"}],["path",{d:"M21.378 5.626a1 1 0 1 0-3.004-3.004l-5.01 5.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z",key:"pqwjuv"}]],WO=Ut("notebook-pen",sge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ige=[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]],iC=Ut("palette",ige);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const age=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"m16 15-3-3 3-3",key:"14y99z"}]],oge=Ut("panel-left-close",age);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lge=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M15 3v18",key:"14nvp0"}],["path",{d:"m8 9 3 3-3 3",key:"12hl5m"}]],cge=Ut("panel-right-close",lge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uge=[["path",{d:"M13.234 20.252 21 12.3",key:"1cbrk9"}],["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 0 2.828 2 2 0 0 0 2.828 0l8.414-8.586a4 4 0 0 0 0-5.656 4 4 0 0 0-5.656 0l-8.415 8.585a6 6 0 1 0 8.486 8.486",key:"1pkts6"}]],gE=Ut("paperclip",uge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dge=[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]],fge=Ut("pause",dge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hge=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],p1=Ut("pen",hge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pge=[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]],mge=Ut("play",pge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gge=[["path",{d:"M12 22v-5",key:"1ega77"}],["path",{d:"M9 8V2",key:"14iosj"}],["path",{d:"M15 8V2",key:"18g5xt"}],["path",{d:"M18 8v5a4 4 0 0 1-4 4h-4a4 4 0 0 1-4-4V8Z",key:"osxo6l"}]],AB=Ut("plug",gge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yge=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],jc=Ut("plus",yge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bge=[["path",{d:"M15.39 4.39a1 1 0 0 0 1.68-.474 2.5 2.5 0 1 1 3.014 3.015 1 1 0 0 0-.474 1.68l1.683 1.682a2.414 2.414 0 0 1 0 3.414L19.61 15.39a1 1 0 0 1-1.68-.474 2.5 2.5 0 1 0-3.014 3.015 1 1 0 0 1 .474 1.68l-1.683 1.682a2.414 2.414 0 0 1-3.414 0L8.61 19.61a1 1 0 0 0-1.68.474 2.5 2.5 0 1 1-3.014-3.015 1 1 0 0 0 .474-1.68l-1.683-1.682a2.414 2.414 0 0 1 0-3.414L4.39 8.61a1 1 0 0 1 1.68.474 2.5 2.5 0 1 0 3.014-3.015 1 1 0 0 1-.474-1.68l1.683-1.682a2.414 2.414 0 0 1 3.414 0z",key:"w46dr5"}]],RB=Ut("puzzle",bge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vge=[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}],["path",{d:"M12 12h.01",key:"1mp3jc"}],["path",{d:"M17 12h.01",key:"1m0b6t"}],["path",{d:"M7 12h.01",key:"eqddd0"}]],xge=Ut("rectangle-ellipsis",vge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wge=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],vm=Ut("refresh-cw",wge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _ge=[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]],Sge=Ut("rocket",_ge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cge=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],yE=Ut("rotate-ccw",Cge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kge=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],$u=Ut("save",kge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ege=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]],Do=Ut("search",Ege);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tge=[["path",{d:"M3.714 3.048a.498.498 0 0 0-.683.627l2.843 7.627a2 2 0 0 1 0 1.396l-2.842 7.627a.498.498 0 0 0 .682.627l18-8.5a.5.5 0 0 0 0-.904z",key:"117uat"}],["path",{d:"M6 12h16",key:"s4cdu5"}]],Age=Ut("send-horizontal",Tge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rge=[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]],Q0=Ut("server",Rge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nge=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],aC=Ut("settings",Nge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mge=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]],NB=Ut("shield-alert",Mge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ige=[["line",{x1:"21",x2:"14",y1:"4",y2:"4",key:"obuewd"}],["line",{x1:"10",x2:"3",y1:"4",y2:"4",key:"1q6298"}],["line",{x1:"21",x2:"12",y1:"12",y2:"12",key:"1iu8h1"}],["line",{x1:"8",x2:"3",y1:"12",y2:"12",key:"ntss68"}],["line",{x1:"21",x2:"16",y1:"20",y2:"20",key:"14d8ph"}],["line",{x1:"12",x2:"3",y1:"20",y2:"20",key:"m0wm8r"}],["line",{x1:"14",x2:"14",y1:"2",y2:"6",key:"14e1ph"}],["line",{x1:"8",x2:"8",y1:"10",y2:"14",key:"1i6ji0"}],["line",{x1:"16",x2:"16",y1:"18",y2:"22",key:"1lctlv"}]],jge=Ut("sliders-horizontal",Ige);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oge=[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]],kH=Ut("sparkles",Oge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pge=[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}]],MB=Ut("sparkle",Pge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dge=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],ph=Ut("square-pen",Dge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fge=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],Lge=Ut("square",Fge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bge=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],IB=Ut("star",Bge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $ge=[["path",{d:"m15 5 6.3 6.3a2.4 2.4 0 0 1 0 3.4L17 19",key:"1cbfv1"}],["path",{d:"M9.586 5.586A2 2 0 0 0 8.172 5H3a1 1 0 0 0-1 1v5.172a2 2 0 0 0 .586 1.414L8.29 18.29a2.426 2.426 0 0 0 3.42 0l3.58-3.58a2.426 2.426 0 0 0 0-3.42z",key:"135mg7"}],["circle",{cx:"6.5",cy:"9.5",r:".5",fill:"currentColor",key:"5pm5xn"}]],Q3=Ut("tags",$ge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zge=[["path",{d:"M17 6.1H3",key:"wptmhv"}],["path",{d:"M21 12.1H3",key:"1j38uz"}],["path",{d:"M15.1 18H3",key:"1nb16a"}]],Uge=Ut("text",zge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qge=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],Mo=Ut("trash-2",qge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vge=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]],Wge=Ut("trash",Vge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hge=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],HO=Ut("triangle-alert",Hge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gge=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]],EH=Ut("upload",Gge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kge=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],Yge=Ut("user",Kge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zge=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]],jB=Ut("users",Zge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xge=[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]],Jge=Ut("video",Xge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qge=[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]],Gx=Ut("wrench",Qge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e0e=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Oi=Ut("x",e0e);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t0e=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],n0e=Ut("zap",t0e),OB=({controls:e,area:t,className:n})=>{const r=e.filter(s=>t==="trigger"?!!s.triggerRenderer:!!s.renderer);return r.length===0?null:f.jsx("div",{className:Xe(n),children:r.map(s=>{var a,o;const i=t==="trigger"?(a=s.triggerRenderer)==null?void 0:a.call(s):(o=s.renderer)==null?void 0:o.call(s);return i?f.jsx(Ve.Fragment,{children:i},s.id):null})})},PB=e=>{let t;const n=new Set,r=(c,u)=>{const d=typeof c=="function"?c(t):c;if(!Object.is(d,t)){const h=t;t=u??(typeof d!="object"||d===null)?d:Object.assign({},t,d),n.forEach(m=>m(t,h))}},s=()=>t,o={setState:r,getState:s,getInitialState:()=>l,subscribe:c=>(n.add(c),()=>n.delete(c))},l=t=e(r,s,o);return o},r0e=e=>e?PB(e):PB,s0e=e=>e;function i0e(e,t=s0e){const n=Ve.useSyncExternalStore(e.subscribe,()=>t(e.getState()),()=>t(e.getInitialState()));return Ve.useDebugValue(n),n}const DB=e=>{const t=r0e(e),n=r=>i0e(t,r);return Object.assign(n,t),n},qo=e=>e?DB(e):DB;var TH=Symbol.for("immer-nothing"),FB=Symbol.for("immer-draftable"),us=Symbol.for("immer-state");function ql(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var ey=Object.getPrototypeOf;function ty(e){return!!e&&!!e[us]}function Wd(e){var t;return e?AH(e)||Array.isArray(e)||!!e[FB]||!!((t=e.constructor)!=null&&t[FB])||vE(e)||xE(e):!1}var a0e=Object.prototype.constructor.toString();function AH(e){if(!e||typeof e!="object")return!1;const t=ey(e);if(t===null)return!0;const n=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return n===Object?!0:typeof n=="function"&&Function.toString.call(n)===a0e}function Kx(e,t){bE(e)===0?Reflect.ownKeys(e).forEach(n=>{t(n,e[n],e)}):e.forEach((n,r)=>t(r,n,e))}function bE(e){const t=e[us];return t?t.type_:Array.isArray(e)?1:vE(e)?2:xE(e)?3:0}function ej(e,t){return bE(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function RH(e,t,n){const r=bE(e);r===2?e.set(t,n):r===3?e.add(n):e[t]=n}function o0e(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function vE(e){return e instanceof Map}function xE(e){return e instanceof Set}function na(e){return e.copy_||e.base_}function tj(e,t){if(vE(e))return new Map(e);if(xE(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const n=AH(e);if(t===!0||t==="class_only"&&!n){const r=Object.getOwnPropertyDescriptors(e);delete r[us];let s=Reflect.ownKeys(r);for(let i=0;i<s.length;i++){const a=s[i],o=r[a];o.writable===!1&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(r[a]={configurable:!0,writable:!0,enumerable:o.enumerable,value:e[a]})}return Object.create(ey(e),r)}else{const r=ey(e);if(r!==null&&n)return{...e};const s=Object.create(r);return Object.assign(s,e)}}function GO(e,t=!1){return wE(e)||ty(e)||!Wd(e)||(bE(e)>1&&(e.set=e.add=e.clear=e.delete=l0e),Object.freeze(e),t&&Object.entries(e).forEach(([n,r])=>GO(r,!0))),e}function l0e(){ql(2)}function wE(e){return Object.isFrozen(e)}var nj={};function xm(e){const t=nj[e];return t||ql(0,e),t}function c0e(e,t){nj[e]||(nj[e]=t)}var Yx;function oC(){return Yx}function u0e(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function LB(e,t){t&&(xm("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function rj(e){sj(e),e.drafts_.forEach(d0e),e.drafts_=null}function sj(e){e===Yx&&(Yx=e.parent_)}function BB(e){return Yx=u0e(Yx,e)}function d0e(e){const t=e[us];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function $B(e,t){t.unfinalizedDrafts_=t.drafts_.length;const n=t.drafts_[0];return e!==void 0&&e!==n?(n[us].modified_&&(rj(t),ql(4)),Wd(e)&&(e=lC(t,e),t.parent_||cC(t,e)),t.patches_&&xm("Patches").generateReplacementPatches_(n[us].base_,e,t.patches_,t.inversePatches_)):e=lC(t,n,[]),rj(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==TH?e:void 0}function lC(e,t,n){if(wE(t))return t;const r=t[us];if(!r)return Kx(t,(s,i)=>zB(e,r,t,s,i,n)),t;if(r.scope_!==e)return t;if(!r.modified_)return cC(e,r.base_,!0),r.base_;if(!r.finalized_){r.finalized_=!0,r.scope_.unfinalizedDrafts_--;const s=r.copy_;let i=s,a=!1;r.type_===3&&(i=new Set(s),s.clear(),a=!0),Kx(i,(o,l)=>zB(e,r,s,o,l,n,a)),cC(e,s,!1),n&&e.patches_&&xm("Patches").generatePatches_(r,n,e.patches_,e.inversePatches_)}return r.copy_}function zB(e,t,n,r,s,i,a){if(ty(s)){const o=i&&t&&t.type_!==3&&!ej(t.assigned_,r)?i.concat(r):void 0,l=lC(e,s,o);if(RH(n,r,l),ty(l))e.canAutoFreeze_=!1;else return}else a&&n.add(s);if(Wd(s)&&!wE(s)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;lC(e,s),(!t||!t.scope_.parent_)&&typeof r!="symbol"&&Object.prototype.propertyIsEnumerable.call(n,r)&&cC(e,s)}}function cC(e,t,n=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&GO(t,n)}function f0e(e,t){const n=Array.isArray(e),r={type_:n?1:0,scope_:t?t.scope_:oC(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let s=r,i=KO;n&&(s=[r],i=Zx);const{revoke:a,proxy:o}=Proxy.revocable(s,i);return r.draft_=o,r.revoke_=a,o}var KO={get(e,t){if(t===us)return e;const n=na(e);if(!ej(n,t))return h0e(e,n,t);const r=n[t];return e.finalized_||!Wd(r)?r:r===vN(e.base_,t)?(xN(e),e.copy_[t]=Xx(r,e)):r},has(e,t){return t in na(e)},ownKeys(e){return Reflect.ownKeys(na(e))},set(e,t,n){const r=NH(na(e),t);if(r!=null&&r.set)return r.set.call(e.draft_,n),!0;if(!e.modified_){const s=vN(na(e),t),i=s==null?void 0:s[us];if(i&&i.base_===n)return e.copy_[t]=n,e.assigned_[t]=!1,!0;if(o0e(n,s)&&(n!==void 0||ej(e.base_,t)))return!0;xN(e),Ed(e)}return e.copy_[t]===n&&(n!==void 0||t in e.copy_)||Number.isNaN(n)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=n,e.assigned_[t]=!0),!0},deleteProperty(e,t){return vN(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,xN(e),Ed(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const n=na(e),r=Reflect.getOwnPropertyDescriptor(n,t);return r&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:r.enumerable,value:n[t]}},defineProperty(){ql(11)},getPrototypeOf(e){return ey(e.base_)},setPrototypeOf(){ql(12)}},Zx={};Kx(KO,(e,t)=>{Zx[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});Zx.deleteProperty=function(e,t){return Zx.set.call(this,e,t,void 0)};Zx.set=function(e,t,n){return KO.set.call(this,e[0],t,n,e[0])};function vN(e,t){const n=e[us];return(n?na(n):e)[t]}function h0e(e,t,n){var s;const r=NH(t,n);return r?"value"in r?r.value:(s=r.get)==null?void 0:s.call(e.draft_):void 0}function NH(e,t){if(!(t in e))return;let n=ey(e);for(;n;){const r=Object.getOwnPropertyDescriptor(n,t);if(r)return r;n=ey(n)}}function Ed(e){e.modified_||(e.modified_=!0,e.parent_&&Ed(e.parent_))}function xN(e){e.copy_||(e.copy_=tj(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var p0e=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(t,n,r)=>{if(typeof t=="function"&&typeof n!="function"){const i=n;n=t;const a=this;return function(l=i,...c){return a.produce(l,u=>n.call(this,u,...c))}}typeof n!="function"&&ql(6),r!==void 0&&typeof r!="function"&&ql(7);let s;if(Wd(t)){const i=BB(this),a=Xx(t,void 0);let o=!0;try{s=n(a),o=!1}finally{o?rj(i):sj(i)}return LB(i,r),$B(s,i)}else if(!t||typeof t!="object"){if(s=n(t),s===void 0&&(s=t),s===TH&&(s=void 0),this.autoFreeze_&&GO(s,!0),r){const i=[],a=[];xm("Patches").generateReplacementPatches_(t,s,i,a),r(i,a)}return s}else ql(1,t)},this.produceWithPatches=(t,n)=>{if(typeof t=="function")return(a,...o)=>this.produceWithPatches(a,l=>t(l,...o));let r,s;return[this.produce(t,n,(a,o)=>{r=a,s=o}),r,s]},typeof(e==null?void 0:e.autoFreeze)=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof(e==null?void 0:e.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){Wd(e)||ql(8),ty(e)&&(e=m0e(e));const t=BB(this),n=Xx(e,void 0);return n[us].isManual_=!0,sj(t),n}finishDraft(e,t){const n=e&&e[us];(!n||!n.isManual_)&&ql(9);const{scope_:r}=n;return LB(r,t),$B(void 0,r)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let n;for(n=t.length-1;n>=0;n--){const s=t[n];if(s.path.length===0&&s.op==="replace"){e=s.value;break}}n>-1&&(t=t.slice(n+1));const r=xm("Patches").applyPatches_;return ty(e)?r(e,t):this.produce(e,s=>r(s,t))}};function Xx(e,t){const n=vE(e)?xm("MapSet").proxyMap_(e,t):xE(e)?xm("MapSet").proxySet_(e,t):f0e(e,t);return(t?t.scope_:oC()).drafts_.push(n),n}function m0e(e){return ty(e)||ql(10,e),MH(e)}function MH(e){if(!Wd(e)||wE(e))return e;const t=e[us];let n;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,n=tj(e,t.scope_.immer_.useStrictShallowCopy_)}else n=tj(e,!0);return Kx(n,(r,s)=>{RH(n,r,MH(s))}),t&&(t.finalized_=!1),n}function g0e(){class e extends Map{constructor(l,c){super(),this[us]={type_:2,parent_:c,scope_:c?c.scope_:oC(),modified_:!1,finalized_:!1,copy_:void 0,assigned_:void 0,base_:l,draft_:this,isManual_:!1,revoked_:!1}}get size(){return na(this[us]).size}has(l){return na(this[us]).has(l)}set(l,c){const u=this[us];return a(u),(!na(u).has(l)||na(u).get(l)!==c)&&(n(u),Ed(u),u.assigned_.set(l,!0),u.copy_.set(l,c),u.assigned_.set(l,!0)),this}delete(l){if(!this.has(l))return!1;const c=this[us];return a(c),n(c),Ed(c),c.base_.has(l)?c.assigned_.set(l,!1):c.assigned_.delete(l),c.copy_.delete(l),!0}clear(){const l=this[us];a(l),na(l).size&&(n(l),Ed(l),l.assigned_=new Map,Kx(l.base_,c=>{l.assigned_.set(c,!1)}),l.copy_.clear())}forEach(l,c){const u=this[us];na(u).forEach((d,h,m)=>{l.call(c,this.get(h),h,this)})}get(l){const c=this[us];a(c);const u=na(c).get(l);if(c.finalized_||!Wd(u)||u!==c.base_.get(l))return u;const d=Xx(u,c);return n(c),c.copy_.set(l,d),d}keys(){return na(this[us]).keys()}values(){const l=this.keys();return{[Symbol.iterator]:()=>this.values(),next:()=>{const c=l.next();return c.done?c:{done:!1,value:this.get(c.value)}}}}entries(){const l=this.keys();return{[Symbol.iterator]:()=>this.entries(),next:()=>{const c=l.next();if(c.done)return c;const u=this.get(c.value);return{done:!1,value:[c.value,u]}}}}[Symbol.iterator](){return this.entries()}}function t(o,l){return new e(o,l)}function n(o){o.copy_||(o.assigned_=new Map,o.copy_=new Map(o.base_))}class r extends Set{constructor(l,c){super(),this[us]={type_:3,parent_:c,scope_:c?c.scope_:oC(),modified_:!1,finalized_:!1,copy_:void 0,base_:l,draft_:this,drafts_:new Map,revoked_:!1,isManual_:!1}}get size(){return na(this[us]).size}has(l){const c=this[us];return a(c),c.copy_?!!(c.copy_.has(l)||c.drafts_.has(l)&&c.copy_.has(c.drafts_.get(l))):c.base_.has(l)}add(l){const c=this[us];return a(c),this.has(l)||(i(c),Ed(c),c.copy_.add(l)),this}delete(l){if(!this.has(l))return!1;const c=this[us];return a(c),i(c),Ed(c),c.copy_.delete(l)||(c.drafts_.has(l)?c.copy_.delete(c.drafts_.get(l)):!1)}clear(){const l=this[us];a(l),na(l).size&&(i(l),Ed(l),l.copy_.clear())}values(){const l=this[us];return a(l),i(l),l.copy_.values()}entries(){const l=this[us];return a(l),i(l),l.copy_.entries()}keys(){return this.values()}[Symbol.iterator](){return this.values()}forEach(l,c){const u=this.values();let d=u.next();for(;!d.done;)l.call(c,d.value,d.value,this),d=u.next()}}function s(o,l){return new r(o,l)}function i(o){o.copy_||(o.copy_=new Set,o.base_.forEach(l=>{if(Wd(l)){const c=Xx(l,o);o.drafts_.set(l,c),o.copy_.add(c)}else o.copy_.add(l)}))}function a(o){o.revoked_&&ql(3,JSON.stringify(na(o)))}c0e("MapSet",{proxyMap_:t,proxySet_:s})}var yl=new p0e,y0e=yl.produce;yl.produceWithPatches.bind(yl);yl.setAutoFreeze.bind(yl);yl.setUseStrictShallowCopy.bind(yl);yl.applyPatches.bind(yl);yl.createDraft.bind(yl);yl.finishDraft.bind(yl);const b0e=e=>(t,n,r)=>(r.setState=(s,i,...a)=>{const o=typeof s=="function"?y0e(s):s;return t(o,i,...a)},e(r.setState,n,r)),Vo=b0e;function v0e(e){return{all:e=e||new Map,on:function(t,n){var r=e.get(t);r?r.push(n):e.set(t,[n])},off:function(t,n){var r=e.get(t);r&&(n?r.splice(r.indexOf(n)>>>0,1):e.set(t,[]))},emit:function(t,n){var r=e.get(t);r&&r.slice().map(function(s){s(n)}),(r=e.get("*"))&&r.slice().map(function(s){s(t,n)})}}}const Pe=v0e(),$r={promptControlsChanged:"control.registry.prompt.controls.changed",chatControlsChanged:"control.registry.chat.controls.changed",canvasControlsChanged:"control.registry.canvas.controls.changed",middlewareChanged:"control.registry.middleware.changed",toolsChanged:"control.registry.tools.changed",modalProvidersChanged:"control.registry.modal.providers.changed",registerPromptControlRequest:"control.registry.register.prompt.control.request",unregisterPromptControlRequest:"control.registry.unregister.prompt.control.request",registerChatControlRequest:"control.registry.register.chat.control.request",unregisterChatControlRequest:"control.registry.unregister.chat.control.request",registerCanvasControlRequest:"control.registry.register.canvas.control.request",unregisterCanvasControlRequest:"control.registry.unregister.canvas.control.request",registerMiddlewareRequest:"control.registry.register.middleware.request",unregisterMiddlewareRequest:"control.registry.unregister.middleware.request",registerToolRequest:"control.registry.register.tool.request",unregisterToolRequest:"control.registry.unregister.tool.request",registerModalProviderRequest:"control.registry.register.modal.provider.request",unregisterModalProviderRequest:"control.registry.unregister.modal.provider.request"},y0={blockRenderersChanged:"block.renderer.renderers.changed",registerBlockRendererRequest:"block.renderer.register.request",unregisterBlockRendererRequest:"block.renderer.unregister.request"},Vi=qo(Vo((e,t)=>({promptControls:{},chatControls:{},canvasControls:{},blockRenderers:{},middlewareRegistry:{},tools:{},modalProviders:{},registerPromptControl:n=>(e(r=>{r.promptControls[n.id]&&console.warn(`ControlRegistryStore: PromptControl with ID "${n.id}" already registered. Overwriting.`),r.promptControls[n.id]=n}),Pe.emit($r.promptControlsChanged,{controls:t().promptControls}),()=>t().unregisterPromptControl(n.id)),unregisterPromptControl:n=>{e(r=>{r.promptControls[n]?delete r.promptControls[n]:console.warn(`ControlRegistryStore: PromptControl with ID "${n}" not found for unregistration.`)}),Pe.emit($r.promptControlsChanged,{controls:t().promptControls})},registerChatControl:n=>(e(r=>{r.chatControls[n.id]&&console.warn(`ControlRegistryStore: ChatControl with ID "${n.id}" already registered. Overwriting.`),r.chatControls[n.id]=n}),Pe.emit($r.chatControlsChanged,{controls:t().chatControls}),()=>t().unregisterChatControl(n.id)),unregisterChatControl:n=>{e(r=>{r.chatControls[n]?delete r.chatControls[n]:console.warn(`ControlRegistryStore: ChatControl with ID "${n}" not found for unregistration.`)}),Pe.emit($r.chatControlsChanged,{controls:t().chatControls})},registerCanvasControl:n=>(e(r=>{r.canvasControls[n.id]&&console.warn(`ControlRegistryStore: CanvasControl with ID "${n.id}" already registered. Overwriting.`),r.canvasControls[n.id]=n}),Pe.emit($r.canvasControlsChanged,{controls:t().canvasControls}),()=>t().unregisterCanvasControl(n.id)),unregisterCanvasControl:n=>{e(r=>{r.canvasControls[n]?delete r.canvasControls[n]:console.warn(`ControlRegistryStore: CanvasControl with ID "${n}" not found for unregistration.`)}),Pe.emit($r.canvasControlsChanged,{controls:t().canvasControls})},registerBlockRenderer:n=>(e(r=>{r.blockRenderers[n.id]&&console.warn(`ControlRegistryStore: BlockRenderer with ID "${n.id}" already registered. Overwriting.`),r.blockRenderers[n.id]=n}),Pe.emit(y0.blockRenderersChanged,{renderers:t().blockRenderers}),()=>t().unregisterBlockRenderer(n.id)),unregisterBlockRenderer:n=>{e(r=>{r.blockRenderers[n]?delete r.blockRenderers[n]:console.warn(`ControlRegistryStore: BlockRenderer with ID "${n}" not found for unregistration.`)}),Pe.emit(y0.blockRenderersChanged,{renderers:t().blockRenderers})},registerMiddleware:(n,r,s,i=0)=>{const a={modId:r,callback:s,order:i};return e(o=>{o.middlewareRegistry[n]||(o.middlewareRegistry[n]=[]),o.middlewareRegistry[n].push(a),o.middlewareRegistry[n].sort((l,c)=>(l.order??0)-(c.order??0))}),Pe.emit($r.middlewareChanged,{middleware:t().middlewareRegistry}),()=>t().unregisterMiddleware(n,r,s)},unregisterMiddleware:(n,r,s)=>{e(i=>{var a;i.middlewareRegistry[n]?(i.middlewareRegistry[n]=i.middlewareRegistry[n].filter(o=>!(o.modId===r&&o.callback===s)),((a=i.middlewareRegistry[n])==null?void 0:a.length)===0&&delete i.middlewareRegistry[n]):console.warn(`ControlRegistryStore: Middleware hook "${n}" not found for unregistration.`)}),Pe.emit($r.middlewareChanged,{middleware:t().middlewareRegistry})},getMiddlewareForHook:n=>{const r=t().middlewareRegistry[n]??[];return Object.freeze([...r].sort((s,i)=>(s.order??0)-(i.order??0)))},registerTool:(n,r,s,i)=>(e(a=>{a.tools[r]&&console.warn(`ControlRegistryStore: Tool "${r}" already registered by mod "${a.tools[r].modId}". Overwriting with registration from mod "${n}".`),a.tools[r]={definition:s,implementation:i,modId:n}}),Pe.emit($r.toolsChanged,{tools:t().tools}),()=>t().unregisterTool(r)),unregisterTool:n=>{e(r=>{r.tools[n]?delete r.tools[n]:console.warn(`ControlRegistryStore: Tool "${n}" not found for unregistration.`)}),Pe.emit($r.toolsChanged,{tools:t().tools})},getRegisteredTools:()=>Object.freeze({...t().tools}),registerModalProvider:(n,r)=>(e(s=>{s.modalProviders[n]&&console.warn(`ControlRegistryStore: ModalProvider with ID "${n}" already registered. Overwriting.`),s.modalProviders[n]=r}),Pe.emit($r.modalProvidersChanged,{providers:t().modalProviders}),()=>t().unregisterModalProvider(n)),unregisterModalProvider:n=>{e(r=>{r.modalProviders[n]?delete r.modalProviders[n]:console.warn(`ControlRegistryStore: ModalProvider with ID "${n}" not found for unregistration.`)}),Pe.emit($r.modalProvidersChanged,{providers:t().modalProviders})},getRegisteredActionHandlers:()=>{const n="controlRegistryStore",r=t();return[{eventName:$r.registerPromptControlRequest,handler:s=>{r.registerPromptControl(s.control)},storeId:n},{eventName:$r.unregisterPromptControlRequest,handler:s=>{r.unregisterPromptControl(s.id)},storeId:n},{eventName:$r.registerChatControlRequest,handler:s=>{r.registerChatControl(s.control)},storeId:n},{eventName:$r.unregisterChatControlRequest,handler:s=>{r.unregisterChatControl(s.id)},storeId:n},{eventName:$r.registerCanvasControlRequest,handler:s=>{r.registerCanvasControl(s.control)},storeId:n},{eventName:$r.unregisterCanvasControlRequest,handler:s=>{r.unregisterCanvasControl(s.id)},storeId:n},{eventName:y0.registerBlockRendererRequest,handler:s=>{r.registerBlockRenderer(s.renderer)},storeId:n},{eventName:y0.unregisterBlockRendererRequest,handler:s=>{r.unregisterBlockRenderer(s.id)},storeId:n},{eventName:$r.registerMiddlewareRequest,handler:s=>{r.registerMiddleware(s.hookName,s.modId,s.callback,s.order)},storeId:n},{eventName:$r.unregisterMiddlewareRequest,handler:s=>{r.unregisterMiddleware(s.hookName,s.modId,s.callback)},storeId:n},{eventName:$r.registerToolRequest,handler:s=>{r.registerTool(s.modId,s.toolName,s.definition,s.implementation)},storeId:n},{eventName:$r.unregisterToolRequest,handler:s=>{r.unregisterTool(s.toolName)},storeId:n},{eventName:$r.registerModalProviderRequest,handler:s=>{r.registerModalProvider(s.modalId,s.provider)},storeId:n},{eventName:$r.unregisterModalProviderRequest,handler:s=>{r.unregisterModalProvider(s.modalId)},storeId:n}]}})));var A2={exports:{}},x0e=A2.exports,UB;function w0e(){return UB||(UB=1,function(e,t){(function(n,r){e.exports=r()})(x0e,function(){var n=function(M,z){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(ne,ae){ne.__proto__=ae}||function(ne,ae){for(var me in ae)Object.prototype.hasOwnProperty.call(ae,me)&&(ne[me]=ae[me])})(M,z)},r=function(){return(r=Object.assign||function(M){for(var z,ne=1,ae=arguments.length;ne<ae;ne++)for(var me in z=arguments[ne])Object.prototype.hasOwnProperty.call(z,me)&&(M[me]=z[me]);return M}).apply(this,arguments)};function s(M,z,ne){for(var ae,me=0,Ae=z.length;me<Ae;me++)!ae&&me in z||((ae=ae||Array.prototype.slice.call(z,0,me))[me]=z[me]);return M.concat(ae||Array.prototype.slice.call(z))}var i=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:tm,a=Object.keys,o=Array.isArray;function l(M,z){return typeof z!="object"||a(z).forEach(function(ne){M[ne]=z[ne]}),M}typeof Promise>"u"||i.Promise||(i.Promise=Promise);var c=Object.getPrototypeOf,u={}.hasOwnProperty;function d(M,z){return u.call(M,z)}function h(M,z){typeof z=="function"&&(z=z(c(M))),(typeof Reflect>"u"?a:Reflect.ownKeys)(z).forEach(function(ne){y(M,ne,z[ne])})}var m=Object.defineProperty;function y(M,z,ne,ae){m(M,z,l(ne&&d(ne,"get")&&typeof ne.get=="function"?{get:ne.get,set:ne.set,configurable:!0}:{value:ne,configurable:!0,writable:!0},ae))}function b(M){return{from:function(z){return M.prototype=Object.create(z.prototype),y(M.prototype,"constructor",M),{extend:h.bind(null,M.prototype)}}}}var v=Object.getOwnPropertyDescriptor,x=[].slice;function w(M,z,ne){return x.call(M,z,ne)}function S(M,z){return z(M)}function k(M){if(!M)throw new Error("Assertion Failed")}function C(M){i.setImmediate?setImmediate(M):setTimeout(M,0)}function T(M,z){if(typeof z=="string"&&d(M,z))return M[z];if(!z)return M;if(typeof z!="string"){for(var ne=[],ae=0,me=z.length;ae<me;++ae){var Ae=T(M,z[ae]);ne.push(Ae)}return ne}var Le=z.indexOf(".");if(Le!==-1){var Ge=M[z.substr(0,Le)];return Ge==null?void 0:T(Ge,z.substr(Le+1))}}function R(M,z,ne){if(M&&z!==void 0&&!("isFrozen"in Object&&Object.isFrozen(M)))if(typeof z!="string"&&"length"in z){k(typeof ne!="string"&&"length"in ne);for(var ae=0,me=z.length;ae<me;++ae)R(M,z[ae],ne[ae])}else{var Ae,Le,Ge=z.indexOf(".");Ge!==-1?(Ae=z.substr(0,Ge),(Le=z.substr(Ge+1))===""?ne===void 0?o(M)&&!isNaN(parseInt(Ae))?M.splice(Ae,1):delete M[Ae]:M[Ae]=ne:R(Ge=!(Ge=M[Ae])||!d(M,Ae)?M[Ae]={}:Ge,Le,ne)):ne===void 0?o(M)&&!isNaN(parseInt(z))?M.splice(z,1):delete M[z]:M[z]=ne}}function N(M){var z,ne={};for(z in M)d(M,z)&&(ne[z]=M[z]);return ne}var I=[].concat;function P(M){return I.apply([],M)}var jt="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(P([8,16,32,64].map(function(M){return["Int","Uint","Float"].map(function(z){return z+M+"Array"})}))).filter(function(M){return i[M]}),B=new Set(jt.map(function(M){return i[M]})),D=null;function W(M){return D=new WeakMap,M=function z(ne){if(!ne||typeof ne!="object")return ne;var ae=D.get(ne);if(ae)return ae;if(o(ne)){ae=[],D.set(ne,ae);for(var me=0,Ae=ne.length;me<Ae;++me)ae.push(z(ne[me]))}else if(B.has(ne.constructor))ae=ne;else{var Le,Ge=c(ne);for(Le in ae=Ge===Object.prototype?{}:Object.create(Ge),D.set(ne,ae),ne)d(ne,Le)&&(ae[Le]=z(ne[Le]))}return ae}(M),D=null,M}var O={}.toString;function Z(M){return O.call(M).slice(8,-1)}var U=typeof Symbol<"u"?Symbol.iterator:"@@iterator",H=typeof U=="symbol"?function(M){var z;return M!=null&&(z=M[U])&&z.apply(M)}:function(){return null};function L(M,z){return z=M.indexOf(z),0<=z&&M.splice(z,1),0<=z}var te={};function V(M){var z,ne,ae,me;if(arguments.length===1){if(o(M))return M.slice();if(this===te&&typeof M=="string")return[M];if(me=H(M)){for(ne=[];!(ae=me.next()).done;)ne.push(ae.value);return ne}if(M==null)return[M];if(typeof(z=M.length)!="number")return[M];for(ne=new Array(z);z--;)ne[z]=M[z];return ne}for(z=arguments.length,ne=new Array(z);z--;)ne[z]=arguments[z];return ne}var Q=typeof Symbol<"u"?function(M){return M[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},ut=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],Ka=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(ut),ee={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function se(M,z){this.name=M,this.message=z}function pe(M,z){return M+". Errors: "+Object.keys(z).map(function(ne){return z[ne].toString()}).filter(function(ne,ae,me){return me.indexOf(ne)===ae}).join(`
`)}function ue(M,z,ne,ae){this.failures=z,this.failedKeys=ae,this.successCount=ne,this.message=pe(M,z)}function Oe(M,z){this.name="BulkError",this.failures=Object.keys(z).map(function(ne){return z[ne]}),this.failuresByPos=z,this.message=pe(M,this.failures)}b(se).from(Error).extend({toString:function(){return this.name+": "+this.message}}),b(ue).from(se),b(Oe).from(se);var Fe=Ka.reduce(function(M,z){return M[z]=z+"Error",M},{}),Se=se,Ce=Ka.reduce(function(M,z){var ne=z+"Error";function ae(me,Ae){this.name=ne,me?typeof me=="string"?(this.message="".concat(me).concat(Ae?`
 `+Ae:""),this.inner=Ae||null):typeof me=="object"&&(this.message="".concat(me.name," ").concat(me.message),this.inner=me):(this.message=ee[z]||ne,this.inner=null)}return b(ae).from(Se),M[z]=ae,M},{});Ce.Syntax=SyntaxError,Ce.Type=TypeError,Ce.Range=RangeError;var qe=ut.reduce(function(M,z){return M[z+"Error"]=Ce[z],M},{}),Qe=Ka.reduce(function(M,z){return["Syntax","Type","Range"].indexOf(z)===-1&&(M[z+"Error"]=Ce[z]),M},{});function We(){}function Ie(M){return M}function K(M,z){return M==null||M===Ie?z:function(ne){return z(M(ne))}}function ye(M,z){return function(){M.apply(this,arguments),z.apply(this,arguments)}}function Ne(M,z){return M===We?z:function(){var ne=M.apply(this,arguments);ne!==void 0&&(arguments[0]=ne);var ae=this.onsuccess,me=this.onerror;this.onsuccess=null,this.onerror=null;var Ae=z.apply(this,arguments);return ae&&(this.onsuccess=this.onsuccess?ye(ae,this.onsuccess):ae),me&&(this.onerror=this.onerror?ye(me,this.onerror):me),Ae!==void 0?Ae:ne}}function ce(M,z){return M===We?z:function(){M.apply(this,arguments);var ne=this.onsuccess,ae=this.onerror;this.onsuccess=this.onerror=null,z.apply(this,arguments),ne&&(this.onsuccess=this.onsuccess?ye(ne,this.onsuccess):ne),ae&&(this.onerror=this.onerror?ye(ae,this.onerror):ae)}}function oe(M,z){return M===We?z:function(ne){var ae=M.apply(this,arguments);l(ne,ae);var me=this.onsuccess,Ae=this.onerror;return this.onsuccess=null,this.onerror=null,ne=z.apply(this,arguments),me&&(this.onsuccess=this.onsuccess?ye(me,this.onsuccess):me),Ae&&(this.onerror=this.onerror?ye(Ae,this.onerror):Ae),ae===void 0?ne===void 0?void 0:ne:l(ae,ne)}}function re(M,z){return M===We?z:function(){return z.apply(this,arguments)!==!1&&M.apply(this,arguments)}}function Re(M,z){return M===We?z:function(){var ne=M.apply(this,arguments);if(ne&&typeof ne.then=="function"){for(var ae=this,me=arguments.length,Ae=new Array(me);me--;)Ae[me]=arguments[me];return ne.then(function(){return z.apply(ae,Ae)})}return z.apply(this,arguments)}}Qe.ModifyError=ue,Qe.DexieError=se,Qe.BulkError=Oe;var Be=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function Te(M){Be=M}var lt={},Tt=100,jt=typeof Promise>"u"?[]:function(){var M=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[M,c(M),M];var z=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[z,c(z),M]}(),ut=jt[0],Ka=jt[1],jt=jt[2],Ka=Ka&&Ka.then,qt=ut&&ut.constructor,Ft=!!jt,Ht=function(M,z){le.push([M,z]),F&&(queueMicrotask(fe),F=!1)},we=!0,F=!0,X=[],be=[],ke=Ie,ge={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:We,pgp:!1,env:{},finalize:We},Ee=ge,le=[],dt=0,et=[];function $(M){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var z=this._PSD=Ee;if(typeof M!="function"){if(M!==lt)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&ve(this,this._value))}this._state=null,this._value=null,++z.ref,function ne(ae,me){try{me(function(Ae){if(ae._state===null){if(Ae===ae)throw new TypeError("A promise cannot be resolved with itself.");var Le=ae._lib&&Y();Ae&&typeof Ae.then=="function"?ne(ae,function(Ge,st){Ae instanceof $?Ae._then(Ge,st):Ae.then(Ge,st)}):(ae._state=!0,ae._value=Ae,_e(ae)),Le&&G()}},ve.bind(null,ae))}catch(Ae){ve(ae,Ae)}}(this,M)}var Ue={get:function(){var M=Ee,z=Zt;function ne(ae,me){var Ae=this,Le=!M.global&&(M!==Ee||z!==Zt),Ge=Le&&!Nr(),st=new $(function(at,ht){$e(Ae,new tt(Vt(ae,M,Le,Ge),Vt(me,M,Le,Ge),at,ht,M))});return this._consoleTask&&(st._consoleTask=this._consoleTask),st}return ne.prototype=lt,ne},set:function(M){y(this,"then",M&&M.prototype===lt?Ue:{get:function(){return M},set:Ue.set})}};function tt(M,z,ne,ae,me){this.onFulfilled=typeof M=="function"?M:null,this.onRejected=typeof z=="function"?z:null,this.resolve=ne,this.reject=ae,this.psd=me}function ve(M,z){var ne,ae;be.push(z),M._state===null&&(ne=M._lib&&Y(),z=ke(z),M._state=!1,M._value=z,ae=M,X.some(function(me){return me._value===ae._value})||X.push(ae),_e(M),ne&&G())}function _e(M){var z=M._listeners;M._listeners=[];for(var ne=0,ae=z.length;ne<ae;++ne)$e(M,z[ne]);var me=M._PSD;--me.ref||me.finalize(),dt===0&&(++dt,Ht(function(){--dt==0&&J()},[]))}function $e(M,z){if(M._state!==null){var ne=M._state?z.onFulfilled:z.onRejected;if(ne===null)return(M._state?z.resolve:z.reject)(M._value);++z.psd.ref,++dt,Ht(Ct,[ne,M,z])}else M._listeners.push(z)}function Ct(M,z,ne){try{var ae,me=z._value;!z._state&&be.length&&(be=[]),ae=Be&&z._consoleTask?z._consoleTask.run(function(){return M(me)}):M(me),z._state||be.indexOf(me)!==-1||function(Ae){for(var Le=X.length;Le;)if(X[--Le]._value===Ae._value)return X.splice(Le,1)}(z),ne.resolve(ae)}catch(Ae){ne.reject(Ae)}finally{--dt==0&&J(),--ne.psd.ref||ne.psd.finalize()}}function fe(){nt(ge,function(){Y()&&G()})}function Y(){var M=we;return F=we=!1,M}function G(){var M,z,ne;do for(;0<le.length;)for(M=le,le=[],ne=M.length,z=0;z<ne;++z){var ae=M[z];ae[0].apply(null,ae[1])}while(0<le.length);F=we=!0}function J(){var M=X;X=[],M.forEach(function(ae){ae._PSD.onunhandled.call(null,ae._value,ae)});for(var z=et.slice(0),ne=z.length;ne;)z[--ne]()}function xe(M){return new $(lt,!1,M)}function De(M,z){var ne=Ee;return function(){var ae=Y(),me=Ee;try{return kr(ne,!0),M.apply(this,arguments)}catch(Ae){z&&z(Ae)}finally{kr(me,!1),ae&&G()}}}h($.prototype,{then:Ue,_then:function(M,z){$e(this,new tt(null,null,M,z,Ee))},catch:function(M){if(arguments.length===1)return this.then(null,M);var z=M,ne=arguments[1];return typeof z=="function"?this.then(null,function(ae){return(ae instanceof z?ne:xe)(ae)}):this.then(null,function(ae){return(ae&&ae.name===z?ne:xe)(ae)})},finally:function(M){return this.then(function(z){return $.resolve(M()).then(function(){return z})},function(z){return $.resolve(M()).then(function(){return xe(z)})})},timeout:function(M,z){var ne=this;return M<1/0?new $(function(ae,me){var Ae=setTimeout(function(){return me(new Ce.Timeout(z))},M);ne.then(ae,me).finally(clearTimeout.bind(null,Ae))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&y($.prototype,Symbol.toStringTag,"Dexie.Promise"),ge.env=hn(),h($,{all:function(){var M=V.apply(null,arguments).map(ns);return new $(function(z,ne){M.length===0&&z([]);var ae=M.length;M.forEach(function(me,Ae){return $.resolve(me).then(function(Le){M[Ae]=Le,--ae||z(M)},ne)})})},resolve:function(M){return M instanceof $?M:M&&typeof M.then=="function"?new $(function(z,ne){M.then(z,ne)}):new $(lt,!0,M)},reject:xe,race:function(){var M=V.apply(null,arguments).map(ns);return new $(function(z,ne){M.map(function(ae){return $.resolve(ae).then(z,ne)})})},PSD:{get:function(){return Ee},set:function(M){return Ee=M}},totalEchoes:{get:function(){return Zt}},newPSD:un,usePSD:nt,scheduler:{get:function(){return Ht},set:function(M){Ht=M}},rejectionMapper:{get:function(){return ke},set:function(M){ke=M}},follow:function(M,z){return new $(function(ne,ae){return un(function(me,Ae){var Le=Ee;Le.unhandleds=[],Le.onunhandled=Ae,Le.finalize=ye(function(){var Ge,st=this;Ge=function(){st.unhandleds.length===0?me():Ae(st.unhandleds[0])},et.push(function at(){Ge(),et.splice(et.indexOf(at),1)}),++dt,Ht(function(){--dt==0&&J()},[])},Le.finalize),M()},z,ne,ae)})}}),qt&&(qt.allSettled&&y($,"allSettled",function(){var M=V.apply(null,arguments).map(ns);return new $(function(z){M.length===0&&z([]);var ne=M.length,ae=new Array(ne);M.forEach(function(me,Ae){return $.resolve(me).then(function(Le){return ae[Ae]={status:"fulfilled",value:Le}},function(Le){return ae[Ae]={status:"rejected",reason:Le}}).then(function(){return--ne||z(ae)})})})}),qt.any&&typeof AggregateError<"u"&&y($,"any",function(){var M=V.apply(null,arguments).map(ns);return new $(function(z,ne){M.length===0&&ne(new AggregateError([]));var ae=M.length,me=new Array(ae);M.forEach(function(Ae,Le){return $.resolve(Ae).then(function(Ge){return z(Ge)},function(Ge){me[Le]=Ge,--ae||ne(new AggregateError(me))})})})}),qt.withResolvers&&($.withResolvers=qt.withResolvers));var He={awaits:0,echoes:0,id:0},xt=0,Qt=[],On=0,Zt=0,nn=0;function un(M,z,ne,ae){var me=Ee,Ae=Object.create(me);return Ae.parent=me,Ae.ref=0,Ae.global=!1,Ae.id=++nn,ge.env,Ae.env=Ft?{Promise:$,PromiseProp:{value:$,configurable:!0,writable:!0},all:$.all,race:$.race,allSettled:$.allSettled,any:$.any,resolve:$.resolve,reject:$.reject}:{},z&&l(Ae,z),++me.ref,Ae.finalize=function(){--this.parent.ref||this.parent.finalize()},ae=nt(Ae,M,ne,ae),Ae.ref===0&&Ae.finalize(),ae}function gr(){return He.id||(He.id=++xt),++He.awaits,He.echoes+=Tt,He.id}function Nr(){return!!He.awaits&&(--He.awaits==0&&(He.id=0),He.echoes=He.awaits*Tt,!0)}function ns(M){return He.echoes&&M&&M.constructor===qt?(gr(),M.then(function(z){return Nr(),z},function(z){return Nr(),sr(z)})):M}function rs(){var M=Qt[Qt.length-1];Qt.pop(),kr(M,!1)}function kr(M,z){var ne,ae=Ee;(z?!He.echoes||On++&&M===Ee:!On||--On&&M===Ee)||queueMicrotask(z?(function(me){++Zt,He.echoes&&--He.echoes!=0||(He.echoes=He.awaits=He.id=0),Qt.push(Ee),kr(me,!0)}).bind(null,M):rs),M!==Ee&&(Ee=M,ae===ge&&(ge.env=hn()),Ft&&(ne=ge.env.Promise,z=M.env,(ae.global||M.global)&&(Object.defineProperty(i,"Promise",z.PromiseProp),ne.all=z.all,ne.race=z.race,ne.resolve=z.resolve,ne.reject=z.reject,z.allSettled&&(ne.allSettled=z.allSettled),z.any&&(ne.any=z.any))))}function hn(){var M=i.Promise;return Ft?{Promise:M,PromiseProp:Object.getOwnPropertyDescriptor(i,"Promise"),all:M.all,race:M.race,allSettled:M.allSettled,any:M.any,resolve:M.resolve,reject:M.reject}:{}}function nt(M,z,ne,ae,me){var Ae=Ee;try{return kr(M,!0),z(ne,ae,me)}finally{kr(Ae,!1)}}function Vt(M,z,ne,ae){return typeof M!="function"?M:function(){var me=Ee;ne&&gr(),kr(z,!0);try{return M.apply(this,arguments)}finally{kr(me,!1),ae&&queueMicrotask(Nr)}}}function pn(M){Promise===qt&&He.echoes===0?On===0?M():enqueueNativeMicroTask(M):setTimeout(M,0)}(""+Ka).indexOf("[native code]")===-1&&(gr=Nr=We);var sr=$.reject,Rs="",es="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Di="String expected.",di=[],Wa="__dbnames",ha="readonly",Hs="readwrite";function Go(M,z){return M?z?function(){return M.apply(this,arguments)&&z.apply(this,arguments)}:M:z}var wl={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function pf(M){return typeof M!="string"||/\./.test(M)?function(z){return z}:function(z){return z[M]===void 0&&M in z&&delete(z=W(z))[M],z}}function lg(){throw Ce.Type()}function Dr(M,z){try{var ne=Ab(M),ae=Ab(z);if(ne!==ae)return ne==="Array"?1:ae==="Array"?-1:ne==="binary"?1:ae==="binary"?-1:ne==="string"?1:ae==="string"?-1:ne==="Date"?1:ae!=="Date"?NaN:-1;switch(ne){case"number":case"Date":case"string":return z<M?1:M<z?-1:0;case"binary":return function(me,Ae){for(var Le=me.length,Ge=Ae.length,st=Le<Ge?Le:Ge,at=0;at<st;++at)if(me[at]!==Ae[at])return me[at]<Ae[at]?-1:1;return Le===Ge?0:Le<Ge?-1:1}(Ha(M),Ha(z));case"Array":return function(me,Ae){for(var Le=me.length,Ge=Ae.length,st=Le<Ge?Le:Ge,at=0;at<st;++at){var ht=Dr(me[at],Ae[at]);if(ht!==0)return ht}return Le===Ge?0:Le<Ge?-1:1}(M,z)}}catch{}return NaN}function Ab(M){var z=typeof M;return z!="object"?z:ArrayBuffer.isView(M)?"binary":(M=Z(M),M==="ArrayBuffer"?"binary":M)}function Ha(M){return M instanceof Uint8Array?M:ArrayBuffer.isView(M)?new Uint8Array(M.buffer,M.byteOffset,M.byteLength):new Uint8Array(M)}var Rb=(Ns.prototype._trans=function(M,z,ne){var ae=this._tx||Ee.trans,me=this.name,Ae=Be&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(M==="readonly"?"read":"write"," ").concat(this.name));function Le(at,ht,Je){if(!Je.schema[me])throw new Ce.NotFound("Table "+me+" not part of transaction");return z(Je.idbtrans,Je)}var Ge=Y();try{var st=ae&&ae.db._novip===this.db._novip?ae===Ee.trans?ae._promise(M,Le,ne):un(function(){return ae._promise(M,Le,ne)},{trans:ae,transless:Ee.transless||Ee}):function at(ht,Je,gt,rt){if(ht.idbdb&&(ht._state.openComplete||Ee.letThrough||ht._vip)){var ft=ht._createTransaction(Je,gt,ht._dbSchema);try{ft.create(),ht._state.PR1398_maxLoop=3}catch(yt){return yt.name===Fe.InvalidState&&ht.isOpen()&&0<--ht._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),ht.close({disableAutoOpen:!1}),ht.open().then(function(){return at(ht,Je,gt,rt)})):sr(yt)}return ft._promise(Je,function(yt,ot){return un(function(){return Ee.trans=ft,rt(yt,ot,ft)})}).then(function(yt){if(Je==="readwrite")try{ft.idbtrans.commit()}catch{}return Je==="readonly"?yt:ft._completion.then(function(){return yt})})}if(ht._state.openComplete)return sr(new Ce.DatabaseClosed(ht._state.dbOpenError));if(!ht._state.isBeingOpened){if(!ht._state.autoOpen)return sr(new Ce.DatabaseClosed);ht.open().catch(We)}return ht._state.dbReadyPromise.then(function(){return at(ht,Je,gt,rt)})}(this.db,M,[this.name],Le);return Ae&&(st._consoleTask=Ae,st=st.catch(function(at){return console.trace(at),sr(at)})),st}finally{Ge&&G()}},Ns.prototype.get=function(M,z){var ne=this;return M&&M.constructor===Object?this.where(M).first(z):M==null?sr(new Ce.Type("Invalid argument to Table.get()")):this._trans("readonly",function(ae){return ne.core.get({trans:ae,key:M}).then(function(me){return ne.hook.reading.fire(me)})}).then(z)},Ns.prototype.where=function(M){if(typeof M=="string")return new this.db.WhereClause(this,M);if(o(M))return new this.db.WhereClause(this,"[".concat(M.join("+"),"]"));var z=a(M);if(z.length===1)return this.where(z[0]).equals(M[z[0]]);var ne=this.schema.indexes.concat(this.schema.primKey).filter(function(Ge){if(Ge.compound&&z.every(function(at){return 0<=Ge.keyPath.indexOf(at)})){for(var st=0;st<z.length;++st)if(z.indexOf(Ge.keyPath[st])===-1)return!1;return!0}return!1}).sort(function(Ge,st){return Ge.keyPath.length-st.keyPath.length})[0];if(ne&&this.db._maxKey!==Rs){var Ae=ne.keyPath.slice(0,z.length);return this.where(Ae).equals(Ae.map(function(st){return M[st]}))}!ne&&Be&&console.warn("The query ".concat(JSON.stringify(M)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(z.join("+"),"]"));var ae=this.schema.idxByName;function me(Ge,st){return Dr(Ge,st)===0}var Le=z.reduce(function(Je,st){var at=Je[0],ht=Je[1],Je=ae[st],gt=M[st];return[at||Je,at||!Je?Go(ht,Je&&Je.multi?function(rt){return rt=T(rt,st),o(rt)&&rt.some(function(ft){return me(gt,ft)})}:function(rt){return me(gt,T(rt,st))}):ht]},[null,null]),Ae=Le[0],Le=Le[1];return Ae?this.where(Ae.name).equals(M[Ae.keyPath]).filter(Le):ne?this.filter(Le):this.where(z).equals("")},Ns.prototype.filter=function(M){return this.toCollection().and(M)},Ns.prototype.count=function(M){return this.toCollection().count(M)},Ns.prototype.offset=function(M){return this.toCollection().offset(M)},Ns.prototype.limit=function(M){return this.toCollection().limit(M)},Ns.prototype.each=function(M){return this.toCollection().each(M)},Ns.prototype.toArray=function(M){return this.toCollection().toArray(M)},Ns.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},Ns.prototype.orderBy=function(M){return new this.db.Collection(new this.db.WhereClause(this,o(M)?"[".concat(M.join("+"),"]"):M))},Ns.prototype.reverse=function(){return this.toCollection().reverse()},Ns.prototype.mapToClass=function(M){var z,ne=this.db,ae=this.name;function me(){return z!==null&&z.apply(this,arguments)||this}(this.schema.mappedClass=M).prototype instanceof lg&&(function(st,at){if(typeof at!="function"&&at!==null)throw new TypeError("Class extends value "+String(at)+" is not a constructor or null");function ht(){this.constructor=st}n(st,at),st.prototype=at===null?Object.create(at):(ht.prototype=at.prototype,new ht)}(me,z=M),Object.defineProperty(me.prototype,"db",{get:function(){return ne},enumerable:!1,configurable:!0}),me.prototype.table=function(){return ae},M=me);for(var Ae=new Set,Le=M.prototype;Le;Le=c(Le))Object.getOwnPropertyNames(Le).forEach(function(st){return Ae.add(st)});function Ge(st){if(!st)return st;var at,ht=Object.create(M.prototype);for(at in st)if(!Ae.has(at))try{ht[at]=st[at]}catch{}return ht}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=Ge,this.hook("reading",Ge),M},Ns.prototype.defineClass=function(){return this.mapToClass(function(M){l(this,M)})},Ns.prototype.add=function(M,z){var ne=this,ae=this.schema.primKey,me=ae.auto,Ae=ae.keyPath,Le=M;return Ae&&me&&(Le=pf(Ae)(M)),this._trans("readwrite",function(Ge){return ne.core.mutate({trans:Ge,type:"add",keys:z!=null?[z]:null,values:[Le]})}).then(function(Ge){return Ge.numFailures?$.reject(Ge.failures[0]):Ge.lastResult}).then(function(Ge){if(Ae)try{R(M,Ae,Ge)}catch{}return Ge})},Ns.prototype.update=function(M,z){return typeof M!="object"||o(M)?this.where(":id").equals(M).modify(z):(M=T(M,this.schema.primKey.keyPath),M===void 0?sr(new Ce.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(M).modify(z))},Ns.prototype.put=function(M,z){var ne=this,ae=this.schema.primKey,me=ae.auto,Ae=ae.keyPath,Le=M;return Ae&&me&&(Le=pf(Ae)(M)),this._trans("readwrite",function(Ge){return ne.core.mutate({trans:Ge,type:"put",values:[Le],keys:z!=null?[z]:null})}).then(function(Ge){return Ge.numFailures?$.reject(Ge.failures[0]):Ge.lastResult}).then(function(Ge){if(Ae)try{R(M,Ae,Ge)}catch{}return Ge})},Ns.prototype.delete=function(M){var z=this;return this._trans("readwrite",function(ne){return z.core.mutate({trans:ne,type:"delete",keys:[M]})}).then(function(ne){return ne.numFailures?$.reject(ne.failures[0]):void 0})},Ns.prototype.clear=function(){var M=this;return this._trans("readwrite",function(z){return M.core.mutate({trans:z,type:"deleteRange",range:wl})}).then(function(z){return z.numFailures?$.reject(z.failures[0]):void 0})},Ns.prototype.bulkGet=function(M){var z=this;return this._trans("readonly",function(ne){return z.core.getMany({keys:M,trans:ne}).then(function(ae){return ae.map(function(me){return z.hook.reading.fire(me)})})})},Ns.prototype.bulkAdd=function(M,z,ne){var ae=this,me=Array.isArray(z)?z:void 0,Ae=(ne=ne||(me?void 0:z))?ne.allKeys:void 0;return this._trans("readwrite",function(Le){var at=ae.schema.primKey,Ge=at.auto,at=at.keyPath;if(at&&me)throw new Ce.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(me&&me.length!==M.length)throw new Ce.InvalidArgument("Arguments objects and keys must have the same length");var st=M.length,at=at&&Ge?M.map(pf(at)):M;return ae.core.mutate({trans:Le,type:"add",keys:me,values:at,wantResults:Ae}).then(function(ft){var Je=ft.numFailures,gt=ft.results,rt=ft.lastResult,ft=ft.failures;if(Je===0)return Ae?gt:rt;throw new Oe("".concat(ae.name,".bulkAdd(): ").concat(Je," of ").concat(st," operations failed"),ft)})})},Ns.prototype.bulkPut=function(M,z,ne){var ae=this,me=Array.isArray(z)?z:void 0,Ae=(ne=ne||(me?void 0:z))?ne.allKeys:void 0;return this._trans("readwrite",function(Le){var at=ae.schema.primKey,Ge=at.auto,at=at.keyPath;if(at&&me)throw new Ce.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(me&&me.length!==M.length)throw new Ce.InvalidArgument("Arguments objects and keys must have the same length");var st=M.length,at=at&&Ge?M.map(pf(at)):M;return ae.core.mutate({trans:Le,type:"put",keys:me,values:at,wantResults:Ae}).then(function(ft){var Je=ft.numFailures,gt=ft.results,rt=ft.lastResult,ft=ft.failures;if(Je===0)return Ae?gt:rt;throw new Oe("".concat(ae.name,".bulkPut(): ").concat(Je," of ").concat(st," operations failed"),ft)})})},Ns.prototype.bulkUpdate=function(M){var z=this,ne=this.core,ae=M.map(function(Le){return Le.key}),me=M.map(function(Le){return Le.changes}),Ae=[];return this._trans("readwrite",function(Le){return ne.getMany({trans:Le,keys:ae,cache:"clone"}).then(function(Ge){var st=[],at=[];M.forEach(function(Je,gt){var rt=Je.key,ft=Je.changes,yt=Ge[gt];if(yt){for(var ot=0,kt=Object.keys(ft);ot<kt.length;ot++){var Nt=kt[ot],Mt=ft[Nt];if(Nt===z.schema.primKey.keyPath){if(Dr(Mt,rt)!==0)throw new Ce.Constraint("Cannot update primary key in bulkUpdate()")}else R(yt,Nt,Mt)}Ae.push(gt),st.push(rt),at.push(yt)}});var ht=st.length;return ne.mutate({trans:Le,type:"put",keys:st,values:at,updates:{keys:ae,changeSpecs:me}}).then(function(Je){var gt=Je.numFailures,rt=Je.failures;if(gt===0)return ht;for(var ft=0,yt=Object.keys(rt);ft<yt.length;ft++){var ot,kt=yt[ft],Nt=Ae[Number(kt)];Nt!=null&&(ot=rt[kt],delete rt[kt],rt[Nt]=ot)}throw new Oe("".concat(z.name,".bulkUpdate(): ").concat(gt," of ").concat(ht," operations failed"),rt)})})})},Ns.prototype.bulkDelete=function(M){var z=this,ne=M.length;return this._trans("readwrite",function(ae){return z.core.mutate({trans:ae,type:"delete",keys:M})}).then(function(Le){var me=Le.numFailures,Ae=Le.lastResult,Le=Le.failures;if(me===0)return Ae;throw new Oe("".concat(z.name,".bulkDelete(): ").concat(me," of ").concat(ne," operations failed"),Le)})},Ns);function Ns(){}function Gc(M){function z(Le,Ge){if(Ge){for(var st=arguments.length,at=new Array(st-1);--st;)at[st-1]=arguments[st];return ne[Le].subscribe.apply(null,at),M}if(typeof Le=="string")return ne[Le]}var ne={};z.addEventType=Ae;for(var ae=1,me=arguments.length;ae<me;++ae)Ae(arguments[ae]);return z;function Ae(Le,Ge,st){if(typeof Le!="object"){var at;Ge=Ge||re;var ht={subscribers:[],fire:st=st||We,subscribe:function(Je){ht.subscribers.indexOf(Je)===-1&&(ht.subscribers.push(Je),ht.fire=Ge(ht.fire,Je))},unsubscribe:function(Je){ht.subscribers=ht.subscribers.filter(function(gt){return gt!==Je}),ht.fire=ht.subscribers.reduce(Ge,st)}};return ne[Le]=z[Le]=ht}a(at=Le).forEach(function(Je){var gt=at[Je];if(o(gt))Ae(Je,at[Je][0],at[Je][1]);else{if(gt!=="asap")throw new Ce.InvalidArgument("Invalid event config");var rt=Ae(Je,Ie,function(){for(var ft=arguments.length,yt=new Array(ft);ft--;)yt[ft]=arguments[ft];rt.subscribers.forEach(function(ot){C(function(){ot.apply(null,yt)})})})}})}}function mf(M,z){return b(z).from({prototype:M}),z}function lc(M,z){return!(M.filter||M.algorithm||M.or)&&(z?M.justLimit:!M.replayFilter)}function Nb(M,z){M.filter=Go(M.filter,z)}function Ea(M,z,ne){var ae=M.replayFilter;M.replayFilter=ae?function(){return Go(ae(),z())}:z,M.justLimit=ne&&!ae}function gf(M,z){if(M.isPrimKey)return z.primaryKey;var ne=z.getIndexByKeyPath(M.index);if(!ne)throw new Ce.Schema("KeyPath "+M.index+" on object store "+z.name+" is not indexed");return ne}function Mb(M,z,ne){var ae=gf(M,z.schema);return z.openCursor({trans:ne,values:!M.keysOnly,reverse:M.dir==="prev",unique:!!M.unique,query:{index:ae,range:M.range}})}function yf(M,z,ne,ae){var me=M.replayFilter?Go(M.filter,M.replayFilter()):M.filter;if(M.or){var Ae={},Le=function(Ge,st,at){var ht,Je;me&&!me(st,at,function(gt){return st.stop(gt)},function(gt){return st.fail(gt)})||((Je=""+(ht=st.primaryKey))=="[object ArrayBuffer]"&&(Je=""+new Uint8Array(ht)),d(Ae,Je)||(Ae[Je]=!0,z(Ge,st,at)))};return Promise.all([M.or._iterate(Le,ne),Ku(Mb(M,ae,ne),M.algorithm,Le,!M.keysOnly&&M.valueMapper)])}return Ku(Mb(M,ae,ne),Go(M.algorithm,me),z,!M.keysOnly&&M.valueMapper)}function Ku(M,z,ne,ae){var me=De(ae?function(Ae,Le,Ge){return ne(ae(Ae),Le,Ge)}:ne);return M.then(function(Ae){if(Ae)return Ae.start(function(){var Le=function(){return Ae.continue()};z&&!z(Ae,function(Ge){return Le=Ge},function(Ge){Ae.stop(Ge),Le=We},function(Ge){Ae.fail(Ge),Le=We})||me(Ae.value,Ae,function(Ge){return Le=Ge}),Le()})})}var bf=(Ib.prototype.execute=function(M){var z=this["@@propmod"];if(z.add!==void 0){var ne=z.add;if(o(ne))return s(s([],o(M)?M:[],!0),ne).sort();if(typeof ne=="number")return(Number(M)||0)+ne;if(typeof ne=="bigint")try{return BigInt(M)+ne}catch{return BigInt(0)+ne}throw new TypeError("Invalid term ".concat(ne))}if(z.remove!==void 0){var ae=z.remove;if(o(ae))return o(M)?M.filter(function(me){return!ae.includes(me)}).sort():[];if(typeof ae=="number")return Number(M)-ae;if(typeof ae=="bigint")try{return BigInt(M)-ae}catch{return BigInt(0)-ae}throw new TypeError("Invalid subtrahend ".concat(ae))}return ne=(ne=z.replacePrefix)===null||ne===void 0?void 0:ne[0],ne&&typeof M=="string"&&M.startsWith(ne)?z.replacePrefix[1]+M.substring(ne.length):M},Ib);function Ib(M){this["@@propmod"]=M}var vf=(Hr.prototype._read=function(M,z){var ne=this._ctx;return ne.error?ne.table._trans(null,sr.bind(null,ne.error)):ne.table._trans("readonly",M).then(z)},Hr.prototype._write=function(M){var z=this._ctx;return z.error?z.table._trans(null,sr.bind(null,z.error)):z.table._trans("readwrite",M,"locked")},Hr.prototype._addAlgorithm=function(M){var z=this._ctx;z.algorithm=Go(z.algorithm,M)},Hr.prototype._iterate=function(M,z){return yf(this._ctx,M,z,this._ctx.table.core)},Hr.prototype.clone=function(M){var z=Object.create(this.constructor.prototype),ne=Object.create(this._ctx);return M&&l(ne,M),z._ctx=ne,z},Hr.prototype.raw=function(){return this._ctx.valueMapper=null,this},Hr.prototype.each=function(M){var z=this._ctx;return this._read(function(ne){return yf(z,M,ne,z.table.core)})},Hr.prototype.count=function(M){var z=this;return this._read(function(ne){var ae=z._ctx,me=ae.table.core;if(lc(ae,!0))return me.count({trans:ne,query:{index:gf(ae,me.schema),range:ae.range}}).then(function(Le){return Math.min(Le,ae.limit)});var Ae=0;return yf(ae,function(){return++Ae,!1},ne,me).then(function(){return Ae})}).then(M)},Hr.prototype.sortBy=function(M,z){var ne=M.split(".").reverse(),ae=ne[0],me=ne.length-1;function Ae(st,at){return at?Ae(st[ne[at]],at-1):st[ae]}var Le=this._ctx.dir==="next"?1:-1;function Ge(st,at){return Dr(Ae(st,me),Ae(at,me))*Le}return this.toArray(function(st){return st.sort(Ge)}).then(z)},Hr.prototype.toArray=function(M){var z=this;return this._read(function(ne){var ae=z._ctx;if(ae.dir==="next"&&lc(ae,!0)&&0<ae.limit){var me=ae.valueMapper,Ae=gf(ae,ae.table.core.schema);return ae.table.core.query({trans:ne,limit:ae.limit,values:!0,query:{index:Ae,range:ae.range}}).then(function(Ge){return Ge=Ge.result,me?Ge.map(me):Ge})}var Le=[];return yf(ae,function(Ge){return Le.push(Ge)},ne,ae.table.core).then(function(){return Le})},M)},Hr.prototype.offset=function(M){var z=this._ctx;return M<=0||(z.offset+=M,lc(z)?Ea(z,function(){var ne=M;return function(ae,me){return ne===0||(ne===1?--ne:me(function(){ae.advance(ne),ne=0}),!1)}}):Ea(z,function(){var ne=M;return function(){return--ne<0}})),this},Hr.prototype.limit=function(M){return this._ctx.limit=Math.min(this._ctx.limit,M),Ea(this._ctx,function(){var z=M;return function(ne,ae,me){return--z<=0&&ae(me),0<=z}},!0),this},Hr.prototype.until=function(M,z){return Nb(this._ctx,function(ne,ae,me){return!M(ne.value)||(ae(me),z)}),this},Hr.prototype.first=function(M){return this.limit(1).toArray(function(z){return z[0]}).then(M)},Hr.prototype.last=function(M){return this.reverse().first(M)},Hr.prototype.filter=function(M){var z;return Nb(this._ctx,function(ne){return M(ne.value)}),(z=this._ctx).isMatch=Go(z.isMatch,M),this},Hr.prototype.and=function(M){return this.filter(M)},Hr.prototype.or=function(M){return new this.db.WhereClause(this._ctx.table,M,this)},Hr.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},Hr.prototype.desc=function(){return this.reverse()},Hr.prototype.eachKey=function(M){var z=this._ctx;return z.keysOnly=!z.isMatch,this.each(function(ne,ae){M(ae.key,ae)})},Hr.prototype.eachUniqueKey=function(M){return this._ctx.unique="unique",this.eachKey(M)},Hr.prototype.eachPrimaryKey=function(M){var z=this._ctx;return z.keysOnly=!z.isMatch,this.each(function(ne,ae){M(ae.primaryKey,ae)})},Hr.prototype.keys=function(M){var z=this._ctx;z.keysOnly=!z.isMatch;var ne=[];return this.each(function(ae,me){ne.push(me.key)}).then(function(){return ne}).then(M)},Hr.prototype.primaryKeys=function(M){var z=this._ctx;if(z.dir==="next"&&lc(z,!0)&&0<z.limit)return this._read(function(ae){var me=gf(z,z.table.core.schema);return z.table.core.query({trans:ae,values:!1,limit:z.limit,query:{index:me,range:z.range}})}).then(function(ae){return ae.result}).then(M);z.keysOnly=!z.isMatch;var ne=[];return this.each(function(ae,me){ne.push(me.primaryKey)}).then(function(){return ne}).then(M)},Hr.prototype.uniqueKeys=function(M){return this._ctx.unique="unique",this.keys(M)},Hr.prototype.firstKey=function(M){return this.limit(1).keys(function(z){return z[0]}).then(M)},Hr.prototype.lastKey=function(M){return this.reverse().firstKey(M)},Hr.prototype.distinct=function(){var M=this._ctx,M=M.index&&M.table.schema.idxByName[M.index];if(!M||!M.multi)return this;var z={};return Nb(this._ctx,function(me){var ae=me.primaryKey.toString(),me=d(z,ae);return z[ae]=!0,!me}),this},Hr.prototype.modify=function(M){var z=this,ne=this._ctx;return this._write(function(ae){var me,Ae,Le;Le=typeof M=="function"?M:(me=a(M),Ae=me.length,function(ot){for(var kt=!1,Nt=0;Nt<Ae;++Nt){var Mt=me[Nt],Pt=M[Mt],Xt=T(ot,Mt);Pt instanceof bf?(R(ot,Mt,Pt.execute(Xt)),kt=!0):Xt!==Pt&&(R(ot,Mt,Pt),kt=!0)}return kt});var Ge=ne.table.core,Je=Ge.schema.primaryKey,st=Je.outbound,at=Je.extractKey,ht=200,Je=z.db._options.modifyChunkSize;Je&&(ht=typeof Je=="object"?Je[Ge.name]||Je["*"]||200:Je);function gt(ot,Mt){var Nt=Mt.failures,Mt=Mt.numFailures;ft+=ot-Mt;for(var Pt=0,Xt=a(Nt);Pt<Xt.length;Pt++){var rn=Xt[Pt];rt.push(Nt[rn])}}var rt=[],ft=0,yt=[];return z.clone().primaryKeys().then(function(ot){function kt(Mt){var Pt=Math.min(ht,ot.length-Mt);return Ge.getMany({trans:ae,keys:ot.slice(Mt,Mt+Pt),cache:"immutable"}).then(function(Xt){for(var rn=[],Gt=[],en=st?[]:null,an=[],Kt=0;Kt<Pt;++Kt){var mn=Xt[Kt],$n={value:W(mn),primKey:ot[Mt+Kt]};Le.call($n,$n.value,$n)!==!1&&($n.value==null?an.push(ot[Mt+Kt]):st||Dr(at(mn),at($n.value))===0?(Gt.push($n.value),st&&en.push(ot[Mt+Kt])):(an.push(ot[Mt+Kt]),rn.push($n.value)))}return Promise.resolve(0<rn.length&&Ge.mutate({trans:ae,type:"add",values:rn}).then(function(Vn){for(var hr in Vn.failures)an.splice(parseInt(hr),1);gt(rn.length,Vn)})).then(function(){return(0<Gt.length||Nt&&typeof M=="object")&&Ge.mutate({trans:ae,type:"put",keys:en,values:Gt,criteria:Nt,changeSpec:typeof M!="function"&&M,isAdditionalChunk:0<Mt}).then(function(Vn){return gt(Gt.length,Vn)})}).then(function(){return(0<an.length||Nt&&M===cg)&&Ge.mutate({trans:ae,type:"delete",keys:an,criteria:Nt,isAdditionalChunk:0<Mt}).then(function(Vn){return gt(an.length,Vn)})}).then(function(){return ot.length>Mt+Pt&&kt(Mt+ht)})})}var Nt=lc(ne)&&ne.limit===1/0&&(typeof M!="function"||M===cg)&&{index:ne.index,range:ne.range};return kt(0).then(function(){if(0<rt.length)throw new ue("Error modifying one or more objects",rt,ft,yt);return ot.length})})})},Hr.prototype.delete=function(){var M=this._ctx,z=M.range;return lc(M)&&(M.isPrimKey||z.type===3)?this._write(function(ne){var ae=M.table.core.schema.primaryKey,me=z;return M.table.core.count({trans:ne,query:{index:ae,range:me}}).then(function(Ae){return M.table.core.mutate({trans:ne,type:"deleteRange",range:me}).then(function(Le){var Ge=Le.failures;if(Le.lastResult,Le.results,Le=Le.numFailures,Le)throw new ue("Could not delete some values",Object.keys(Ge).map(function(st){return Ge[st]}),Ae-Le);return Ae-Le})})}):this.modify(cg)},Hr);function Hr(){}var cg=function(M,z){return z.value=null};function v_(M,z){return M<z?-1:M===z?0:1}function jb(M,z){return z<M?-1:M===z?0:1}function Ga(M,z,ne){return M=M instanceof Zu?new M.Collection(M):M,M._ctx.error=new(ne||TypeError)(z),M}function xf(M){return new M.Collection(M,function(){return ug("")}).limit(0)}function Yu(M,z,ne,ae){var me,Ae,Le,Ge,st,at,ht,Je=ne.length;if(!ne.every(function(ft){return typeof ft=="string"}))return Ga(M,Di);function gt(ft){me=ft==="next"?function(ot){return ot.toUpperCase()}:function(ot){return ot.toLowerCase()},Ae=ft==="next"?function(ot){return ot.toLowerCase()}:function(ot){return ot.toUpperCase()},Le=ft==="next"?v_:jb;var yt=ne.map(function(ot){return{lower:Ae(ot),upper:me(ot)}}).sort(function(ot,kt){return Le(ot.lower,kt.lower)});Ge=yt.map(function(ot){return ot.upper}),st=yt.map(function(ot){return ot.lower}),ht=(at=ft)==="next"?"":ae}gt("next"),M=new M.Collection(M,function(){return _l(Ge[0],st[Je-1]+ae)}),M._ondirectionchange=function(ft){gt(ft)};var rt=0;return M._addAlgorithm(function(ft,yt,ot){var kt=ft.key;if(typeof kt!="string")return!1;var Nt=Ae(kt);if(z(Nt,st,rt))return!0;for(var Mt=null,Pt=rt;Pt<Je;++Pt){var Xt=function(rn,Gt,en,an,Kt,mn){for(var $n=Math.min(rn.length,an.length),Vn=-1,hr=0;hr<$n;++hr){var pa=Gt[hr];if(pa!==an[hr])return Kt(rn[hr],en[hr])<0?rn.substr(0,hr)+en[hr]+en.substr(hr+1):Kt(rn[hr],an[hr])<0?rn.substr(0,hr)+an[hr]+en.substr(hr+1):0<=Vn?rn.substr(0,Vn)+Gt[Vn]+en.substr(Vn+1):null;Kt(rn[hr],pa)<0&&(Vn=hr)}return $n<an.length&&mn==="next"?rn+en.substr(rn.length):$n<rn.length&&mn==="prev"?rn.substr(0,en.length):Vn<0?null:rn.substr(0,Vn)+an[Vn]+en.substr(Vn+1)}(kt,Nt,Ge[Pt],st[Pt],Le,at);Xt===null&&Mt===null?rt=Pt+1:(Mt===null||0<Le(Mt,Xt))&&(Mt=Xt)}return yt(Mt!==null?function(){ft.continue(Mt+ht)}:ot),!1}),M}function _l(M,z,ne,ae){return{type:2,lower:M,upper:z,lowerOpen:ne,upperOpen:ae}}function ug(M){return{type:1,lower:M,upper:M}}var Zu=(Object.defineProperty(Ls.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),Ls.prototype.between=function(M,z,ne,ae){ne=ne!==!1,ae=ae===!0;try{return 0<this._cmp(M,z)||this._cmp(M,z)===0&&(ne||ae)&&(!ne||!ae)?xf(this):new this.Collection(this,function(){return _l(M,z,!ne,!ae)})}catch{return Ga(this,es)}},Ls.prototype.equals=function(M){return M==null?Ga(this,es):new this.Collection(this,function(){return ug(M)})},Ls.prototype.above=function(M){return M==null?Ga(this,es):new this.Collection(this,function(){return _l(M,void 0,!0)})},Ls.prototype.aboveOrEqual=function(M){return M==null?Ga(this,es):new this.Collection(this,function(){return _l(M,void 0,!1)})},Ls.prototype.below=function(M){return M==null?Ga(this,es):new this.Collection(this,function(){return _l(void 0,M,!1,!0)})},Ls.prototype.belowOrEqual=function(M){return M==null?Ga(this,es):new this.Collection(this,function(){return _l(void 0,M)})},Ls.prototype.startsWith=function(M){return typeof M!="string"?Ga(this,Di):this.between(M,M+Rs,!0,!0)},Ls.prototype.startsWithIgnoreCase=function(M){return M===""?this.startsWith(M):Yu(this,function(z,ne){return z.indexOf(ne[0])===0},[M],Rs)},Ls.prototype.equalsIgnoreCase=function(M){return Yu(this,function(z,ne){return z===ne[0]},[M],"")},Ls.prototype.anyOfIgnoreCase=function(){var M=V.apply(te,arguments);return M.length===0?xf(this):Yu(this,function(z,ne){return ne.indexOf(z)!==-1},M,"")},Ls.prototype.startsWithAnyOfIgnoreCase=function(){var M=V.apply(te,arguments);return M.length===0?xf(this):Yu(this,function(z,ne){return ne.some(function(ae){return z.indexOf(ae)===0})},M,Rs)},Ls.prototype.anyOf=function(){var M=this,z=V.apply(te,arguments),ne=this._cmp;try{z.sort(ne)}catch{return Ga(this,es)}if(z.length===0)return xf(this);var ae=new this.Collection(this,function(){return _l(z[0],z[z.length-1])});ae._ondirectionchange=function(Ae){ne=Ae==="next"?M._ascending:M._descending,z.sort(ne)};var me=0;return ae._addAlgorithm(function(Ae,Le,Ge){for(var st=Ae.key;0<ne(st,z[me]);)if(++me===z.length)return Le(Ge),!1;return ne(st,z[me])===0||(Le(function(){Ae.continue(z[me])}),!1)}),ae},Ls.prototype.notEqual=function(M){return this.inAnyRange([[-1/0,M],[M,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},Ls.prototype.noneOf=function(){var M=V.apply(te,arguments);if(M.length===0)return new this.Collection(this);try{M.sort(this._ascending)}catch{return Ga(this,es)}var z=M.reduce(function(ne,ae){return ne?ne.concat([[ne[ne.length-1][1],ae]]):[[-1/0,ae]]},null);return z.push([M[M.length-1],this.db._maxKey]),this.inAnyRange(z,{includeLowers:!1,includeUppers:!1})},Ls.prototype.inAnyRange=function(kt,z){var ne=this,ae=this._cmp,me=this._ascending,Ae=this._descending,Le=this._min,Ge=this._max;if(kt.length===0)return xf(this);if(!kt.every(function(Nt){return Nt[0]!==void 0&&Nt[1]!==void 0&&me(Nt[0],Nt[1])<=0}))return Ga(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",Ce.InvalidArgument);var st=!z||z.includeLowers!==!1,at=z&&z.includeUppers===!0,ht,Je=me;function gt(Nt,Mt){return Je(Nt[0],Mt[0])}try{(ht=kt.reduce(function(Nt,Mt){for(var Pt=0,Xt=Nt.length;Pt<Xt;++Pt){var rn=Nt[Pt];if(ae(Mt[0],rn[1])<0&&0<ae(Mt[1],rn[0])){rn[0]=Le(rn[0],Mt[0]),rn[1]=Ge(rn[1],Mt[1]);break}}return Pt===Xt&&Nt.push(Mt),Nt},[])).sort(gt)}catch{return Ga(this,es)}var rt=0,ft=at?function(Nt){return 0<me(Nt,ht[rt][1])}:function(Nt){return 0<=me(Nt,ht[rt][1])},yt=st?function(Nt){return 0<Ae(Nt,ht[rt][0])}:function(Nt){return 0<=Ae(Nt,ht[rt][0])},ot=ft,kt=new this.Collection(this,function(){return _l(ht[0][0],ht[ht.length-1][1],!st,!at)});return kt._ondirectionchange=function(Nt){Je=Nt==="next"?(ot=ft,me):(ot=yt,Ae),ht.sort(gt)},kt._addAlgorithm(function(Nt,Mt,Pt){for(var Xt,rn=Nt.key;ot(rn);)if(++rt===ht.length)return Mt(Pt),!1;return!ft(Xt=rn)&&!yt(Xt)||(ne._cmp(rn,ht[rt][1])===0||ne._cmp(rn,ht[rt][0])===0||Mt(function(){Je===me?Nt.continue(ht[rt][0]):Nt.continue(ht[rt][1])}),!1)}),kt},Ls.prototype.startsWithAnyOf=function(){var M=V.apply(te,arguments);return M.every(function(z){return typeof z=="string"})?M.length===0?xf(this):this.inAnyRange(M.map(function(z){return[z,z+Rs]})):Ga(this,"startsWithAnyOf() only works with strings")},Ls);function Ls(){}function Ko(M){return De(function(z){return Xu(z),M(z.target.error),!1})}function Xu(M){M.stopPropagation&&M.stopPropagation(),M.preventDefault&&M.preventDefault()}var wf="storagemutated",Ju="x-storagemutated-1",Yi=Gc(null,wf),Ob=(Ta.prototype._lock=function(){return k(!Ee.global),++this._reculock,this._reculock!==1||Ee.global||(Ee.lockOwnerFor=this),this},Ta.prototype._unlock=function(){if(k(!Ee.global),--this._reculock==0)for(Ee.global||(Ee.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var M=this._blockedFuncs.shift();try{nt(M[1],M[0])}catch{}}return this},Ta.prototype._locked=function(){return this._reculock&&Ee.lockOwnerFor!==this},Ta.prototype.create=function(M){var z=this;if(!this.mode)return this;var ne=this.db.idbdb,ae=this.db._state.dbOpenError;if(k(!this.idbtrans),!M&&!ne)switch(ae&&ae.name){case"DatabaseClosedError":throw new Ce.DatabaseClosed(ae);case"MissingAPIError":throw new Ce.MissingAPI(ae.message,ae);default:throw new Ce.OpenFailed(ae)}if(!this.active)throw new Ce.TransactionInactive;return k(this._completion._state===null),(M=this.idbtrans=M||(this.db.core||ne).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=De(function(me){Xu(me),z._reject(M.error)}),M.onabort=De(function(me){Xu(me),z.active&&z._reject(new Ce.Abort(M.error)),z.active=!1,z.on("abort").fire(me)}),M.oncomplete=De(function(){z.active=!1,z._resolve(),"mutatedParts"in M&&Yi.storagemutated.fire(M.mutatedParts)}),this},Ta.prototype._promise=function(M,z,ne){var ae=this;if(M==="readwrite"&&this.mode!=="readwrite")return sr(new Ce.ReadOnly("Transaction is readonly"));if(!this.active)return sr(new Ce.TransactionInactive);if(this._locked())return new $(function(Ae,Le){ae._blockedFuncs.push([function(){ae._promise(M,z,ne).then(Ae,Le)},Ee])});if(ne)return un(function(){var Ae=new $(function(Le,Ge){ae._lock();var st=z(Le,Ge,ae);st&&st.then&&st.then(Le,Ge)});return Ae.finally(function(){return ae._unlock()}),Ae._lib=!0,Ae});var me=new $(function(Ae,Le){var Ge=z(Ae,Le,ae);Ge&&Ge.then&&Ge.then(Ae,Le)});return me._lib=!0,me},Ta.prototype._root=function(){return this.parent?this.parent._root():this},Ta.prototype.waitFor=function(M){var z,ne=this._root(),ae=$.resolve(M);ne._waitingFor?ne._waitingFor=ne._waitingFor.then(function(){return ae}):(ne._waitingFor=ae,ne._waitingQueue=[],z=ne.idbtrans.objectStore(ne.storeNames[0]),function Ae(){for(++ne._spinCount;ne._waitingQueue.length;)ne._waitingQueue.shift()();ne._waitingFor&&(z.get(-1/0).onsuccess=Ae)}());var me=ne._waitingFor;return new $(function(Ae,Le){ae.then(function(Ge){return ne._waitingQueue.push(De(Ae.bind(null,Ge)))},function(Ge){return ne._waitingQueue.push(De(Le.bind(null,Ge)))}).finally(function(){ne._waitingFor===me&&(ne._waitingFor=null)})})},Ta.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new Ce.Abort))},Ta.prototype.table=function(M){var z=this._memoizedTables||(this._memoizedTables={});if(d(z,M))return z[M];var ne=this.schema[M];if(!ne)throw new Ce.NotFound("Table "+M+" not part of transaction");return ne=new this.db.Table(M,ne,this),ne.core=this.db.core.table(M),z[M]=ne},Ta);function Ta(){}function Sl(M,z,ne,ae,me,Ae,Le){return{name:M,keyPath:z,unique:ne,multi:ae,auto:me,compound:Ae,src:(ne&&!Le?"&":"")+(ae?"*":"")+(me?"++":"")+dg(z)}}function dg(M){return typeof M=="string"?M:M?"["+[].join.call(M,"+")+"]":""}function _f(M,z,ne){return{name:M,primKey:z,indexes:ne,mappedClass:null,idxByName:(ae=function(me){return[me.name,me]},ne.reduce(function(me,Ae,Le){return Le=ae(Ae,Le),Le&&(me[Le[0]]=Le[1]),me},{}))};var ae}var Sf=function(M){try{return M.only([[]]),Sf=function(){return[[]]},[[]]}catch{return Sf=function(){return Rs},Rs}};function Cf(M){return M==null?function(){}:typeof M=="string"?(z=M).split(".").length===1?function(ne){return ne[z]}:function(ne){return T(ne,z)}:function(ne){return T(ne,M)};var z}function pp(M){return[].slice.call(M)}var x_=0;function Si(M){return M==null?":id":typeof M=="string"?M:"[".concat(M.join("+"),"]")}function Qu(M,z,st){function ae(ot){if(ot.type===3)return null;if(ot.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var rt=ot.lower,ft=ot.upper,yt=ot.lowerOpen,ot=ot.upperOpen;return rt===void 0?ft===void 0?null:z.upperBound(ft,!!ot):ft===void 0?z.lowerBound(rt,!!yt):z.bound(rt,ft,!!yt,!!ot)}function me(gt){var rt,ft=gt.name;return{name:ft,schema:gt,mutate:function(yt){var ot=yt.trans,kt=yt.type,Nt=yt.keys,Mt=yt.values,Pt=yt.range;return new Promise(function(Xt,rn){Xt=De(Xt);var Gt=ot.objectStore(ft),en=Gt.keyPath==null,an=kt==="put"||kt==="add";if(!an&&kt!=="delete"&&kt!=="deleteRange")throw new Error("Invalid operation type: "+kt);var Kt,mn=(Nt||Mt||{length:1}).length;if(Nt&&Mt&&Nt.length!==Mt.length)throw new Error("Given keys array must have same length as given values array.");if(mn===0)return Xt({numFailures:0,failures:{},results:[],lastResult:void 0});function $n(Xi){++pa,Xu(Xi)}var Vn=[],hr=[],pa=0;if(kt==="deleteRange"){if(Pt.type===4)return Xt({numFailures:pa,failures:hr,results:[],lastResult:void 0});Pt.type===3?Vn.push(Kt=Gt.clear()):Vn.push(Kt=Gt.delete(ae(Pt)))}else{var en=an?en?[Mt,Nt]:[Mt,null]:[Nt,null],ir=en[0],fi=en[1];if(an)for(var Ci=0;Ci<mn;++Ci)Vn.push(Kt=fi&&fi[Ci]!==void 0?Gt[kt](ir[Ci],fi[Ci]):Gt[kt](ir[Ci])),Kt.onerror=$n;else for(Ci=0;Ci<mn;++Ci)Vn.push(Kt=Gt[kt](ir[Ci])),Kt.onerror=$n}function cc(Xi){Xi=Xi.target.result,Vn.forEach(function(kl,Xc){return kl.error!=null&&(hr[Xc]=kl.error)}),Xt({numFailures:pa,failures:hr,results:kt==="delete"?Nt:Vn.map(function(kl){return kl.result}),lastResult:Xi})}Kt.onerror=function(Xi){$n(Xi),cc(Xi)},Kt.onsuccess=cc})},getMany:function(yt){var ot=yt.trans,kt=yt.keys;return new Promise(function(Nt,Mt){Nt=De(Nt);for(var Pt,Xt=ot.objectStore(ft),rn=kt.length,Gt=new Array(rn),en=0,an=0,Kt=function(Vn){Vn=Vn.target,Gt[Vn._pos]=Vn.result,++an===en&&Nt(Gt)},mn=Ko(Mt),$n=0;$n<rn;++$n)kt[$n]!=null&&((Pt=Xt.get(kt[$n]))._pos=$n,Pt.onsuccess=Kt,Pt.onerror=mn,++en);en===0&&Nt(Gt)})},get:function(yt){var ot=yt.trans,kt=yt.key;return new Promise(function(Nt,Mt){Nt=De(Nt);var Pt=ot.objectStore(ft).get(kt);Pt.onsuccess=function(Xt){return Nt(Xt.target.result)},Pt.onerror=Ko(Mt)})},query:(rt=at,function(yt){return new Promise(function(ot,kt){ot=De(ot);var Nt,Mt,Pt,en=yt.trans,Xt=yt.values,rn=yt.limit,Kt=yt.query,Gt=rn===1/0?void 0:rn,an=Kt.index,Kt=Kt.range,en=en.objectStore(ft),an=an.isPrimaryKey?en:en.index(an.name),Kt=ae(Kt);if(rn===0)return ot({result:[]});rt?((Gt=Xt?an.getAll(Kt,Gt):an.getAllKeys(Kt,Gt)).onsuccess=function(mn){return ot({result:mn.target.result})},Gt.onerror=Ko(kt)):(Nt=0,Mt=!Xt&&"openKeyCursor"in an?an.openKeyCursor(Kt):an.openCursor(Kt),Pt=[],Mt.onsuccess=function(mn){var $n=Mt.result;return $n?(Pt.push(Xt?$n.value:$n.primaryKey),++Nt===rn?ot({result:Pt}):void $n.continue()):ot({result:Pt})},Mt.onerror=Ko(kt))})}),openCursor:function(yt){var ot=yt.trans,kt=yt.values,Nt=yt.query,Mt=yt.reverse,Pt=yt.unique;return new Promise(function(Xt,rn){Xt=De(Xt);var an=Nt.index,Gt=Nt.range,en=ot.objectStore(ft),en=an.isPrimaryKey?en:en.index(an.name),an=Mt?Pt?"prevunique":"prev":Pt?"nextunique":"next",Kt=!kt&&"openKeyCursor"in en?en.openKeyCursor(ae(Gt),an):en.openCursor(ae(Gt),an);Kt.onerror=Ko(rn),Kt.onsuccess=De(function(mn){var $n,Vn,hr,pa,ir=Kt.result;ir?(ir.___id=++x_,ir.done=!1,$n=ir.continue.bind(ir),Vn=(Vn=ir.continuePrimaryKey)&&Vn.bind(ir),hr=ir.advance.bind(ir),pa=function(){throw new Error("Cursor not stopped")},ir.trans=ot,ir.stop=ir.continue=ir.continuePrimaryKey=ir.advance=function(){throw new Error("Cursor not started")},ir.fail=De(rn),ir.next=function(){var fi=this,Ci=1;return this.start(function(){return Ci--?fi.continue():fi.stop()}).then(function(){return fi})},ir.start=function(fi){function Ci(){if(Kt.result)try{fi()}catch(Xi){ir.fail(Xi)}else ir.done=!0,ir.start=function(){throw new Error("Cursor behind last entry")},ir.stop()}var cc=new Promise(function(Xi,kl){Xi=De(Xi),Kt.onerror=Ko(kl),ir.fail=kl,ir.stop=function(Xc){ir.stop=ir.continue=ir.continuePrimaryKey=ir.advance=pa,Xi(Xc)}});return Kt.onsuccess=De(function(Xi){Kt.onsuccess=Ci,Ci()}),ir.continue=$n,ir.continuePrimaryKey=Vn,ir.advance=hr,Ci(),cc},Xt(ir)):Xt(null)},rn)})},count:function(yt){var ot=yt.query,kt=yt.trans,Nt=ot.index,Mt=ot.range;return new Promise(function(Pt,Xt){var rn=kt.objectStore(ft),Gt=Nt.isPrimaryKey?rn:rn.index(Nt.name),rn=ae(Mt),Gt=rn?Gt.count(rn):Gt.count();Gt.onsuccess=De(function(en){return Pt(en.target.result)}),Gt.onerror=Ko(Xt)})}}}var Ae,Le,Ge,ht=(Le=st,Ge=pp((Ae=M).objectStoreNames),{schema:{name:Ae.name,tables:Ge.map(function(gt){return Le.objectStore(gt)}).map(function(gt){var rt=gt.keyPath,ot=gt.autoIncrement,ft=o(rt),yt={},ot={name:gt.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:rt==null,compound:ft,keyPath:rt,autoIncrement:ot,unique:!0,extractKey:Cf(rt)},indexes:pp(gt.indexNames).map(function(kt){return gt.index(kt)}).map(function(Pt){var Nt=Pt.name,Mt=Pt.unique,Xt=Pt.multiEntry,Pt=Pt.keyPath,Xt={name:Nt,compound:o(Pt),keyPath:Pt,unique:Mt,multiEntry:Xt,extractKey:Cf(Pt)};return yt[Si(Pt)]=Xt}),getIndexByKeyPath:function(kt){return yt[Si(kt)]}};return yt[":id"]=ot.primaryKey,rt!=null&&(yt[Si(rt)]=ot.primaryKey),ot})},hasGetAll:0<Ge.length&&"getAll"in Le.objectStore(Ge[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),st=ht.schema,at=ht.hasGetAll,ht=st.tables.map(me),Je={};return ht.forEach(function(gt){return Je[gt.name]=gt}),{stack:"dbcore",transaction:M.transaction.bind(M),table:function(gt){if(!Je[gt])throw new Error("Table '".concat(gt,"' not found"));return Je[gt]},MIN_KEY:-1/0,MAX_KEY:Sf(z),schema:st}}function fg(M,z,ne,ae){var me=ne.IDBKeyRange;return ne.indexedDB,{dbcore:(ae=Qu(z,me,ae),M.dbcore.reduce(function(Ae,Le){return Le=Le.create,r(r({},Ae),Le(Ae))},ae))}}function Kc(M,ae){var ne=ae.db,ae=fg(M._middlewares,ne,M._deps,ae);M.core=ae.dbcore,M.tables.forEach(function(me){var Ae=me.name;M.core.schema.tables.some(function(Le){return Le.name===Ae})&&(me.core=M.core.table(Ae),M[Ae]instanceof M.Table&&(M[Ae].core=me.core))})}function hg(M,z,ne,ae){ne.forEach(function(me){var Ae=ae[me];z.forEach(function(Le){var Ge=function st(at,ht){return v(at,ht)||(at=c(at))&&st(at,ht)}(Le,me);(!Ge||"value"in Ge&&Ge.value===void 0)&&(Le===M.Transaction.prototype||Le instanceof M.Transaction?y(Le,me,{get:function(){return this.table(me)},set:function(st){m(this,me,{value:st,writable:!0,configurable:!0,enumerable:!0})}}):Le[me]=new M.Table(me,Ae))})})}function mp(M,z){z.forEach(function(ne){for(var ae in ne)ne[ae]instanceof M.Table&&delete ne[ae]})}function Pb(M,z){return M._cfg.version-z._cfg.version}function gp(M,z,ne,ae){var me=M._dbSchema;ne.objectStoreNames.contains("$meta")&&!me.$meta&&(me.$meta=_f("$meta",__("")[0],[]),M._storeNames.push("$meta"));var Ae=M._createTransaction("readwrite",M._storeNames,me);Ae.create(ne),Ae._completion.catch(ae);var Le=Ae._reject.bind(Ae),Ge=Ee.transless||Ee;un(function(){return Ee.trans=Ae,Ee.transless=Ge,z!==0?(Kc(M,ne),at=z,((st=Ae).storeNames.includes("$meta")?st.table("$meta").get("version").then(function(ht){return ht??at}):$.resolve(at)).then(function(ht){return gt=ht,rt=Ae,ft=ne,yt=[],ht=(Je=M)._versions,ot=Je._dbSchema=kf(0,Je.idbdb,ft),(ht=ht.filter(function(kt){return kt._cfg.version>=gt})).length!==0?(ht.forEach(function(kt){yt.push(function(){var Nt=ot,Mt=kt._cfg.dbschema;yg(Je,Nt,ft),yg(Je,Mt,ft),ot=Je._dbSchema=Mt;var Pt=mg(Nt,Mt);Pt.add.forEach(function(an){Db(ft,an[0],an[1].primKey,an[1].indexes)}),Pt.change.forEach(function(an){if(an.recreate)throw new Ce.Upgrade("Not yet support for changing primary key");var Kt=ft.objectStore(an.name);an.add.forEach(function(mn){return gg(Kt,mn)}),an.change.forEach(function(mn){Kt.deleteIndex(mn.name),gg(Kt,mn)}),an.del.forEach(function(mn){return Kt.deleteIndex(mn)})});var Xt=kt._cfg.contentUpgrade;if(Xt&&kt._cfg.version>gt){Kc(Je,ft),rt._memoizedTables={};var rn=N(Mt);Pt.del.forEach(function(an){rn[an]=Nt[an]}),mp(Je,[Je.Transaction.prototype]),hg(Je,[Je.Transaction.prototype],a(rn),rn),rt.schema=rn;var Gt,en=Q(Xt);return en&&gr(),Pt=$.follow(function(){var an;(Gt=Xt(rt))&&en&&(an=Nr.bind(null,null),Gt.then(an,an))}),Gt&&typeof Gt.then=="function"?$.resolve(Gt):Pt.then(function(){return Gt})}}),yt.push(function(Nt){var Mt,Pt,Xt=kt._cfg.dbschema;Mt=Xt,Pt=Nt,[].slice.call(Pt.db.objectStoreNames).forEach(function(rn){return Mt[rn]==null&&Pt.db.deleteObjectStore(rn)}),mp(Je,[Je.Transaction.prototype]),hg(Je,[Je.Transaction.prototype],Je._storeNames,Je._dbSchema),rt.schema=Je._dbSchema}),yt.push(function(Nt){Je.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(Je.idbdb.version/10)===kt._cfg.version?(Je.idbdb.deleteObjectStore("$meta"),delete Je._dbSchema.$meta,Je._storeNames=Je._storeNames.filter(function(Mt){return Mt!=="$meta"})):Nt.objectStore("$meta").put(kt._cfg.version,"version"))})}),function kt(){return yt.length?$.resolve(yt.shift()(rt.idbtrans)).then(kt):$.resolve()}().then(function(){w_(ot,ft)})):$.resolve();var Je,gt,rt,ft,yt,ot}).catch(Le)):(a(me).forEach(function(ht){Db(ne,ht,me[ht].primKey,me[ht].indexes)}),Kc(M,ne),void $.follow(function(){return M.on.populate.fire(Ae)}).catch(Le));var st,at})}function pg(M,z){w_(M._dbSchema,z),z.db.version%10!=0||z.objectStoreNames.contains("$meta")||z.db.createObjectStore("$meta").add(Math.ceil(z.db.version/10-1),"version");var ne=kf(0,M.idbdb,z);yg(M,M._dbSchema,z);for(var ae=0,me=mg(ne,M._dbSchema).change;ae<me.length;ae++){var Ae=function(Le){if(Le.change.length||Le.recreate)return console.warn("Unable to patch indexes of table ".concat(Le.name," because it has changes on the type of index or primary key.")),{value:void 0};var Ge=z.objectStore(Le.name);Le.add.forEach(function(st){Be&&console.debug("Dexie upgrade patch: Creating missing index ".concat(Le.name,".").concat(st.src)),gg(Ge,st)})}(me[ae]);if(typeof Ae=="object")return Ae.value}}function mg(M,z){var ne,ae={del:[],add:[],change:[]};for(ne in M)z[ne]||ae.del.push(ne);for(ne in z){var me=M[ne],Ae=z[ne];if(me){var Le={name:ne,def:Ae,recreate:!1,del:[],add:[],change:[]};if(""+(me.primKey.keyPath||"")!=""+(Ae.primKey.keyPath||"")||me.primKey.auto!==Ae.primKey.auto)Le.recreate=!0,ae.change.push(Le);else{var Ge=me.idxByName,st=Ae.idxByName,at=void 0;for(at in Ge)st[at]||Le.del.push(at);for(at in st){var ht=Ge[at],Je=st[at];ht?ht.src!==Je.src&&Le.change.push(Je):Le.add.push(Je)}(0<Le.del.length||0<Le.add.length||0<Le.change.length)&&ae.change.push(Le)}}else ae.add.push([ne,Ae])}return ae}function Db(M,z,ne,ae){var me=M.db.createObjectStore(z,ne.keyPath?{keyPath:ne.keyPath,autoIncrement:ne.auto}:{autoIncrement:ne.auto});return ae.forEach(function(Ae){return gg(me,Ae)}),me}function w_(M,z){a(M).forEach(function(ne){z.db.objectStoreNames.contains(ne)||(Be&&console.debug("Dexie: Creating missing table",ne),Db(z,ne,M[ne].primKey,M[ne].indexes))})}function gg(M,z){M.createIndex(z.name,z.keyPath,{unique:z.unique,multiEntry:z.multi})}function kf(M,z,ne){var ae={};return w(z.objectStoreNames,0).forEach(function(me){for(var Ae=ne.objectStore(me),Le=Sl(dg(at=Ae.keyPath),at||"",!0,!1,!!Ae.autoIncrement,at&&typeof at!="string",!0),Ge=[],st=0;st<Ae.indexNames.length;++st){var ht=Ae.index(Ae.indexNames[st]),at=ht.keyPath,ht=Sl(ht.name,at,!!ht.unique,!!ht.multiEntry,!1,at&&typeof at!="string",!1);Ge.push(ht)}ae[me]=_f(me,Le,Ge)}),ae}function yg(M,z,ne){for(var ae=ne.db.objectStoreNames,me=0;me<ae.length;++me){var Ae=ae[me],Le=ne.objectStore(Ae);M._hasGetAll="getAll"in Le;for(var Ge=0;Ge<Le.indexNames.length;++Ge){var st=Le.indexNames[Ge],at=Le.index(st).keyPath,ht=typeof at=="string"?at:"["+w(at).join("+")+"]";!z[Ae]||(at=z[Ae].idxByName[ht])&&(at.name=st,delete z[Ae].idxByName[ht],z[Ae].idxByName[st]=at)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&i.WorkerGlobalScope&&i instanceof i.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(M._hasGetAll=!1)}function __(M){return M.split(",").map(function(z,ne){var ae=(z=z.trim()).replace(/([&*]|\+\+)/g,""),me=/^\[/.test(ae)?ae.match(/^\[(.*)\]$/)[1].split("+"):ae;return Sl(ae,me||null,/\&/.test(z),/\*/.test(z),/\+\+/.test(z),o(me),ne===0)})}var kA=(bg.prototype._parseStoresSpec=function(M,z){a(M).forEach(function(ne){if(M[ne]!==null){var ae=__(M[ne]),me=ae.shift();if(me.unique=!0,me.multi)throw new Ce.Schema("Primary key cannot be multi-valued");ae.forEach(function(Ae){if(Ae.auto)throw new Ce.Schema("Only primary key can be marked as autoIncrement (++)");if(!Ae.keyPath)throw new Ce.Schema("Index must have a name and cannot be an empty string")}),z[ne]=_f(ne,me,ae)}})},bg.prototype.stores=function(ne){var z=this.db;this._cfg.storesSource=this._cfg.storesSource?l(this._cfg.storesSource,ne):ne;var ne=z._versions,ae={},me={};return ne.forEach(function(Ae){l(ae,Ae._cfg.storesSource),me=Ae._cfg.dbschema={},Ae._parseStoresSpec(ae,me)}),z._dbSchema=me,mp(z,[z._allTables,z,z.Transaction.prototype]),hg(z,[z._allTables,z,z.Transaction.prototype,this._cfg.tables],a(me),me),z._storeNames=a(me),this},bg.prototype.upgrade=function(M){return this._cfg.contentUpgrade=Re(this._cfg.contentUpgrade||We,M),this},bg);function bg(){}function Fb(M,z){var ne=M._dbNamesDB;return ne||(ne=M._dbNamesDB=new Cl(Wa,{addons:[],indexedDB:M,IDBKeyRange:z})).version(1).stores({dbnames:"name"}),ne.table("dbnames")}function vg(M){return M&&typeof M.databases=="function"}function Lb(M){return un(function(){return Ee.letThrough=!0,M()})}function Bb(M){return!("from"in M)}var Zi=function(M,z){if(!this){var ne=new Zi;return M&&"d"in M&&l(ne,M),ne}l(this,arguments.length?{d:1,from:M,to:1<arguments.length?z:M}:{d:0})};function yp(M,z,ne){var ae=Dr(z,ne);if(!isNaN(ae)){if(0<ae)throw RangeError();if(Bb(M))return l(M,{from:z,to:ne,d:1});var me=M.l,ae=M.r;if(Dr(ne,M.from)<0)return me?yp(me,z,ne):M.l={from:z,to:ne,d:1,l:null,r:null},C_(M);if(0<Dr(z,M.to))return ae?yp(ae,z,ne):M.r={from:z,to:ne,d:1,l:null,r:null},C_(M);Dr(z,M.from)<0&&(M.from=z,M.l=null,M.d=ae?ae.d+1:1),0<Dr(ne,M.to)&&(M.to=ne,M.r=null,M.d=M.l?M.l.d+1:1),ne=!M.r,me&&!M.l&&ed(M,me),ae&&ne&&ed(M,ae)}}function ed(M,z){Bb(z)||function ne(ae,st){var Ae=st.from,Le=st.to,Ge=st.l,st=st.r;yp(ae,Ae,Le),Ge&&ne(ae,Ge),st&&ne(ae,st)}(M,z)}function S_(M,z){var ne=xg(z),ae=ne.next();if(ae.done)return!1;for(var me=ae.value,Ae=xg(M),Le=Ae.next(me.from),Ge=Le.value;!ae.done&&!Le.done;){if(Dr(Ge.from,me.to)<=0&&0<=Dr(Ge.to,me.from))return!0;Dr(me.from,Ge.from)<0?me=(ae=ne.next(Ge.from)).value:Ge=(Le=Ae.next(me.from)).value}return!1}function xg(M){var z=Bb(M)?null:{s:0,n:M};return{next:function(ne){for(var ae=0<arguments.length;z;)switch(z.s){case 0:if(z.s=1,ae)for(;z.n.l&&Dr(ne,z.n.from)<0;)z={up:z,n:z.n.l,s:1};else for(;z.n.l;)z={up:z,n:z.n.l,s:1};case 1:if(z.s=2,!ae||Dr(ne,z.n.to)<=0)return{value:z.n,done:!1};case 2:if(z.n.r){z.s=3,z={up:z,n:z.n.r,s:0};continue}case 3:z=z.up}return{done:!0}}}}function C_(M){var z,ne,ae=(((z=M.r)===null||z===void 0?void 0:z.d)||0)-(((ne=M.l)===null||ne===void 0?void 0:ne.d)||0),me=1<ae?"r":ae<-1?"l":"";me&&(z=me=="r"?"l":"r",ne=r({},M),ae=M[me],M.from=ae.from,M.to=ae.to,M[me]=ae[me],ne[me]=ae[z],(M[z]=ne).d=$b(ne)),M.d=$b(M)}function $b(ne){var z=ne.r,ne=ne.l;return(z?ne?Math.max(z.d,ne.d):z.d:ne?ne.d:0)+1}function wg(M,z){return a(z).forEach(function(ne){M[ne]?ed(M[ne],z[ne]):M[ne]=function ae(me){var Ae,Le,Ge={};for(Ae in me)d(me,Ae)&&(Le=me[Ae],Ge[Ae]=!Le||typeof Le!="object"||B.has(Le.constructor)?Le:ae(Le));return Ge}(z[ne])}),M}function zb(M,z){return M.all||z.all||Object.keys(M).some(function(ne){return z[ne]&&S_(z[ne],M[ne])})}h(Zi.prototype,((Ka={add:function(M){return ed(this,M),this},addKey:function(M){return yp(this,M,M),this},addKeys:function(M){var z=this;return M.forEach(function(ne){return yp(z,ne,ne)}),this},hasKey:function(M){var z=xg(this).next(M).value;return z&&Dr(z.from,M)<=0&&0<=Dr(z.to,M)}})[U]=function(){return xg(this)},Ka));var td={},Ub={},qb=!1;function _g(M){wg(Ub,M),qb||(qb=!0,setTimeout(function(){qb=!1,Vb(Ub,!(Ub={}))},0))}function Vb(M,z){z===void 0&&(z=!1);var ne=new Set;if(M.all)for(var ae=0,me=Object.values(td);ae<me.length;ae++)k_(Le=me[ae],M,ne,z);else for(var Ae in M){var Le,Ge=/^idb\:\/\/(.*)\/(.*)\//.exec(Ae);Ge&&(Ae=Ge[1],Ge=Ge[2],(Le=td["idb://".concat(Ae,"/").concat(Ge)])&&k_(Le,M,ne,z))}ne.forEach(function(st){return st()})}function k_(M,z,ne,ae){for(var me=[],Ae=0,Le=Object.entries(M.queries.query);Ae<Le.length;Ae++){for(var Ge=Le[Ae],st=Ge[0],at=[],ht=0,Je=Ge[1];ht<Je.length;ht++){var gt=Je[ht];zb(z,gt.obsSet)?gt.subscribers.forEach(function(ot){return ne.add(ot)}):ae&&at.push(gt)}ae&&me.push([st,at])}if(ae)for(var rt=0,ft=me;rt<ft.length;rt++){var yt=ft[rt],st=yt[0],at=yt[1];M.queries.query[st]=at}}function EA(M){var z=M._state,ne=M._deps.indexedDB;if(z.isBeingOpened||M.idbdb)return z.dbReadyPromise.then(function(){return z.dbOpenError?sr(z.dbOpenError):M});z.isBeingOpened=!0,z.dbOpenError=null,z.openComplete=!1;var ae=z.openCanceller,me=Math.round(10*M.verno),Ae=!1;function Le(){if(z.openCanceller!==ae)throw new Ce.DatabaseClosed("db.open() was cancelled")}function Ge(){return new $(function(gt,rt){if(Le(),!ne)throw new Ce.MissingAPI;var ft=M.name,yt=z.autoSchema||!me?ne.open(ft):ne.open(ft,me);if(!yt)throw new Ce.MissingAPI;yt.onerror=Ko(rt),yt.onblocked=De(M._fireOnBlocked),yt.onupgradeneeded=De(function(ot){var kt;ht=yt.transaction,z.autoSchema&&!M._options.allowEmptyDB?(yt.onerror=Xu,ht.abort(),yt.result.close(),(kt=ne.deleteDatabase(ft)).onsuccess=kt.onerror=De(function(){rt(new Ce.NoSuchDatabase("Database ".concat(ft," doesnt exist")))})):(ht.onerror=Ko(rt),ot=ot.oldVersion>Math.pow(2,62)?0:ot.oldVersion,Je=ot<1,M.idbdb=yt.result,Ae&&pg(M,ht),gp(M,ot/10,ht,rt))},rt),yt.onsuccess=De(function(){ht=null;var ot,kt,Nt,Mt,Pt,Xt=M.idbdb=yt.result,rn=w(Xt.objectStoreNames);if(0<rn.length)try{var Gt=Xt.transaction((Mt=rn).length===1?Mt[0]:Mt,"readonly");if(z.autoSchema)kt=Xt,Nt=Gt,(ot=M).verno=kt.version/10,Nt=ot._dbSchema=kf(0,kt,Nt),ot._storeNames=w(kt.objectStoreNames,0),hg(ot,[ot._allTables],a(Nt),Nt);else if(yg(M,M._dbSchema,Gt),((Pt=mg(kf(0,(Pt=M).idbdb,Gt),Pt._dbSchema)).add.length||Pt.change.some(function(en){return en.add.length||en.change.length}))&&!Ae)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),Xt.close(),me=Xt.version+1,Ae=!0,gt(Ge());Kc(M,Gt)}catch{}di.push(M),Xt.onversionchange=De(function(en){z.vcFired=!0,M.on("versionchange").fire(en)}),Xt.onclose=De(function(en){M.on("close").fire(en)}),Je&&(Pt=M._deps,Gt=ft,Xt=Pt.indexedDB,Pt=Pt.IDBKeyRange,vg(Xt)||Gt===Wa||Fb(Xt,Pt).put({name:Gt}).catch(We)),gt()},rt)}).catch(function(gt){switch(gt==null?void 0:gt.name){case"UnknownError":if(0<z.PR1398_maxLoop)return z.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),Ge();break;case"VersionError":if(0<me)return me=0,Ge()}return $.reject(gt)})}var st,at=z.dbReadyResolve,ht=null,Je=!1;return $.race([ae,(typeof navigator>"u"?$.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(gt){function rt(){return indexedDB.databases().finally(gt)}st=setInterval(rt,100),rt()}).finally(function(){return clearInterval(st)}):Promise.resolve()).then(Ge)]).then(function(){return Le(),z.onReadyBeingFired=[],$.resolve(Lb(function(){return M.on.ready.fire(M.vip)})).then(function gt(){if(0<z.onReadyBeingFired.length){var rt=z.onReadyBeingFired.reduce(Re,We);return z.onReadyBeingFired=[],$.resolve(Lb(function(){return rt(M.vip)})).then(gt)}})}).finally(function(){z.openCanceller===ae&&(z.onReadyBeingFired=null,z.isBeingOpened=!1)}).catch(function(gt){z.dbOpenError=gt;try{ht&&ht.abort()}catch{}return ae===z.openCanceller&&M._close(),sr(gt)}).finally(function(){z.openComplete=!0,at()}).then(function(){var gt;return Je&&(gt={},M.tables.forEach(function(rt){rt.schema.indexes.forEach(function(ft){ft.name&&(gt["idb://".concat(M.name,"/").concat(rt.name,"/").concat(ft.name)]=new Zi(-1/0,[[[]]]))}),gt["idb://".concat(M.name,"/").concat(rt.name,"/")]=gt["idb://".concat(M.name,"/").concat(rt.name,"/:dels")]=new Zi(-1/0,[[[]]])}),Yi(wf).fire(gt),Vb(gt,!0)),M})}function bp(M){function z(Ae){return M.next(Ae)}var ne=me(z),ae=me(function(Ae){return M.throw(Ae)});function me(Ae){return function(st){var Ge=Ae(st),st=Ge.value;return Ge.done?st:st&&typeof st.then=="function"?st.then(ne,ae):o(st)?Promise.all(st).then(ne,ae):ne(st)}}return me(z)()}function Yc(M,z,ne){for(var ae=o(M)?M.slice():[M],me=0;me<ne;++me)ae.push(z);return ae}var TA={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(M){return r(r({},M),{table:function(z){var ne=M.table(z),ae=ne.schema,me={},Ae=[];function Le(Je,gt,rt){var ft=Si(Je),yt=me[ft]=me[ft]||[],ot=Je==null?0:typeof Je=="string"?1:Je.length,kt=0<gt,kt=r(r({},rt),{name:kt?"".concat(ft,"(virtual-from:").concat(rt.name,")"):rt.name,lowLevelIndex:rt,isVirtual:kt,keyTail:gt,keyLength:ot,extractKey:Cf(Je),unique:!kt&&rt.unique});return yt.push(kt),kt.isPrimaryKey||Ae.push(kt),1<ot&&Le(ot===2?Je[0]:Je.slice(0,ot-1),gt+1,rt),yt.sort(function(Nt,Mt){return Nt.keyTail-Mt.keyTail}),kt}z=Le(ae.primaryKey.keyPath,0,ae.primaryKey),me[":id"]=[z];for(var Ge=0,st=ae.indexes;Ge<st.length;Ge++){var at=st[Ge];Le(at.keyPath,0,at)}function ht(Je){var gt,rt=Je.query.index;return rt.isVirtual?r(r({},Je),{query:{index:rt.lowLevelIndex,range:(gt=Je.query.range,rt=rt.keyTail,{type:gt.type===1?2:gt.type,lower:Yc(gt.lower,gt.lowerOpen?M.MAX_KEY:M.MIN_KEY,rt),lowerOpen:!0,upper:Yc(gt.upper,gt.upperOpen?M.MIN_KEY:M.MAX_KEY,rt),upperOpen:!0})}}):Je}return r(r({},ne),{schema:r(r({},ae),{primaryKey:z,indexes:Ae,getIndexByKeyPath:function(Je){return(Je=me[Si(Je)])&&Je[0]}}),count:function(Je){return ne.count(ht(Je))},query:function(Je){return ne.query(ht(Je))},openCursor:function(Je){var gt=Je.query.index,rt=gt.keyTail,ft=gt.isVirtual,yt=gt.keyLength;return ft?ne.openCursor(ht(Je)).then(function(kt){return kt&&ot(kt)}):ne.openCursor(Je);function ot(kt){return Object.create(kt,{continue:{value:function(Nt){Nt!=null?kt.continue(Yc(Nt,Je.reverse?M.MAX_KEY:M.MIN_KEY,rt)):Je.unique?kt.continue(kt.key.slice(0,yt).concat(Je.reverse?M.MIN_KEY:M.MAX_KEY,rt)):kt.continue()}},continuePrimaryKey:{value:function(Nt,Mt){kt.continuePrimaryKey(Yc(Nt,M.MAX_KEY,rt),Mt)}},primaryKey:{get:function(){return kt.primaryKey}},key:{get:function(){var Nt=kt.key;return yt===1?Nt[0]:Nt.slice(0,yt)}},value:{get:function(){return kt.value}}})}}})}})}};function Sg(M,z,ne,ae){return ne=ne||{},ae=ae||"",a(M).forEach(function(me){var Ae,Le,Ge;d(z,me)?(Ae=M[me],Le=z[me],typeof Ae=="object"&&typeof Le=="object"&&Ae&&Le?(Ge=Z(Ae))!==Z(Le)?ne[ae+me]=z[me]:Ge==="Object"?Sg(Ae,Le,ne,ae+me+"."):Ae!==Le&&(ne[ae+me]=z[me]):Ae!==Le&&(ne[ae+me]=z[me])):ne[ae+me]=void 0}),a(z).forEach(function(me){d(M,me)||(ne[ae+me]=z[me])}),ne}function Cg(M,z){return z.type==="delete"?z.keys:z.keys||z.values.map(M.extractKey)}var E_={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(M){return r(r({},M),{table:function(z){var ne=M.table(z),ae=ne.schema.primaryKey;return r(r({},ne),{mutate:function(me){var Ae=Ee.trans,Le=Ae.table(z).hook,Ge=Le.deleting,st=Le.creating,at=Le.updating;switch(me.type){case"add":if(st.fire===We)break;return Ae._promise("readwrite",function(){return ht(me)},!0);case"put":if(st.fire===We&&at.fire===We)break;return Ae._promise("readwrite",function(){return ht(me)},!0);case"delete":if(Ge.fire===We)break;return Ae._promise("readwrite",function(){return ht(me)},!0);case"deleteRange":if(Ge.fire===We)break;return Ae._promise("readwrite",function(){return function Je(gt,rt,ft){return ne.query({trans:gt,values:!1,query:{index:ae,range:rt},limit:ft}).then(function(yt){var ot=yt.result;return ht({type:"delete",keys:ot,trans:gt}).then(function(kt){return 0<kt.numFailures?Promise.reject(kt.failures[0]):ot.length<ft?{failures:[],numFailures:0,lastResult:void 0}:Je(gt,r(r({},rt),{lower:ot[ot.length-1],lowerOpen:!0}),ft)})})}(me.trans,me.range,1e4)},!0)}return ne.mutate(me);function ht(Je){var gt,rt,ft,yt=Ee.trans,ot=Je.keys||Cg(ae,Je);if(!ot)throw new Error("Keys missing");return(Je=Je.type==="add"||Je.type==="put"?r(r({},Je),{keys:ot}):r({},Je)).type!=="delete"&&(Je.values=s([],Je.values)),Je.keys&&(Je.keys=s([],Je.keys)),gt=ne,ft=ot,((rt=Je).type==="add"?Promise.resolve([]):gt.getMany({trans:rt.trans,keys:ft,cache:"immutable"})).then(function(kt){var Nt=ot.map(function(Mt,Pt){var Xt,rn,Gt,en=kt[Pt],an={onerror:null,onsuccess:null};return Je.type==="delete"?Ge.fire.call(an,Mt,en,yt):Je.type==="add"||en===void 0?(Xt=st.fire.call(an,Mt,Je.values[Pt],yt),Mt==null&&Xt!=null&&(Je.keys[Pt]=Mt=Xt,ae.outbound||R(Je.values[Pt],ae.keyPath,Mt))):(Xt=Sg(en,Je.values[Pt]),(rn=at.fire.call(an,Xt,Mt,en,yt))&&(Gt=Je.values[Pt],Object.keys(rn).forEach(function(Kt){d(Gt,Kt)?Gt[Kt]=rn[Kt]:R(Gt,Kt,rn[Kt])}))),an});return ne.mutate(Je).then(function(Mt){for(var Pt=Mt.failures,Xt=Mt.results,rn=Mt.numFailures,Mt=Mt.lastResult,Gt=0;Gt<ot.length;++Gt){var en=(Xt||ot)[Gt],an=Nt[Gt];en==null?an.onerror&&an.onerror(Pt[Gt]):an.onsuccess&&an.onsuccess(Je.type==="put"&&kt[Gt]?Je.values[Gt]:en)}return{failures:Pt,results:Xt,numFailures:rn,lastResult:Mt}}).catch(function(Mt){return Nt.forEach(function(Pt){return Pt.onerror&&Pt.onerror(Mt)}),Promise.reject(Mt)})})}}})}})}};function Wb(M,z,ne){try{if(!z||z.keys.length<M.length)return null;for(var ae=[],me=0,Ae=0;me<z.keys.length&&Ae<M.length;++me)Dr(z.keys[me],M[Ae])===0&&(ae.push(ne?W(z.values[me]):z.values[me]),++Ae);return ae.length===M.length?ae:null}catch{return null}}var T_={stack:"dbcore",level:-1,create:function(M){return{table:function(z){var ne=M.table(z);return r(r({},ne),{getMany:function(ae){if(!ae.cache)return ne.getMany(ae);var me=Wb(ae.keys,ae.trans._cache,ae.cache==="clone");return me?$.resolve(me):ne.getMany(ae).then(function(Ae){return ae.trans._cache={keys:ae.keys,values:ae.cache==="clone"?W(Ae):Ae},Ae})},mutate:function(ae){return ae.type!=="add"&&(ae.trans._cache=null),ne.mutate(ae)}})}}}};function nd(M,z){return M.trans.mode==="readonly"&&!!M.subscr&&!M.trans.explicit&&M.trans.db._options.cache!=="disabled"&&!z.schema.primaryKey.outbound}function A_(M,z){switch(M){case"query":return z.values&&!z.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var AA={stack:"dbcore",level:0,name:"Observability",create:function(M){var z=M.schema.name,ne=new Zi(M.MIN_KEY,M.MAX_KEY);return r(r({},M),{transaction:function(ae,me,Ae){if(Ee.subscr&&me!=="readonly")throw new Ce.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(Ee.querier));return M.transaction(ae,me,Ae)},table:function(ae){var me=M.table(ae),Ae=me.schema,Le=Ae.primaryKey,Je=Ae.indexes,Ge=Le.extractKey,st=Le.outbound,at=Le.autoIncrement&&Je.filter(function(rt){return rt.compound&&rt.keyPath.includes(Le.keyPath)}),ht=r(r({},me),{mutate:function(rt){function ft(Kt){return Kt="idb://".concat(z,"/").concat(ae,"/").concat(Kt),Mt[Kt]||(Mt[Kt]=new Zi)}var yt,ot,kt,Nt=rt.trans,Mt=rt.mutatedParts||(rt.mutatedParts={}),Pt=ft(""),Xt=ft(":dels"),rn=rt.type,an=rt.type==="deleteRange"?[rt.range]:rt.type==="delete"?[rt.keys]:rt.values.length<50?[Cg(Le,rt).filter(function(Kt){return Kt}),rt.values]:[],Gt=an[0],en=an[1],an=rt.trans._cache;return o(Gt)?(Pt.addKeys(Gt),(an=rn==="delete"||Gt.length===en.length?Wb(Gt,an):null)||Xt.addKeys(Gt),(an||en)&&(yt=ft,ot=an,kt=en,Ae.indexes.forEach(function(Kt){var mn=yt(Kt.name||"");function $n(hr){return hr!=null?Kt.extractKey(hr):null}function Vn(hr){return Kt.multiEntry&&o(hr)?hr.forEach(function(pa){return mn.addKey(pa)}):mn.addKey(hr)}(ot||kt).forEach(function(hr,fi){var ir=ot&&$n(ot[fi]),fi=kt&&$n(kt[fi]);Dr(ir,fi)!==0&&(ir!=null&&Vn(ir),fi!=null&&Vn(fi))})}))):Gt?(en={from:(en=Gt.lower)!==null&&en!==void 0?en:M.MIN_KEY,to:(en=Gt.upper)!==null&&en!==void 0?en:M.MAX_KEY},Xt.add(en),Pt.add(en)):(Pt.add(ne),Xt.add(ne),Ae.indexes.forEach(function(Kt){return ft(Kt.name).add(ne)})),me.mutate(rt).then(function(Kt){return!Gt||rt.type!=="add"&&rt.type!=="put"||(Pt.addKeys(Kt.results),at&&at.forEach(function(mn){for(var $n=rt.values.map(function(ir){return mn.extractKey(ir)}),Vn=mn.keyPath.findIndex(function(ir){return ir===Le.keyPath}),hr=0,pa=Kt.results.length;hr<pa;++hr)$n[hr][Vn]=Kt.results[hr];ft(mn.name).addKeys($n)})),Nt.mutatedParts=wg(Nt.mutatedParts||{},Mt),Kt})}}),Je=function(ft){var yt=ft.query,ft=yt.index,yt=yt.range;return[ft,new Zi((ft=yt.lower)!==null&&ft!==void 0?ft:M.MIN_KEY,(yt=yt.upper)!==null&&yt!==void 0?yt:M.MAX_KEY)]},gt={get:function(rt){return[Le,new Zi(rt.key)]},getMany:function(rt){return[Le,new Zi().addKeys(rt.keys)]},count:Je,query:Je,openCursor:Je};return a(gt).forEach(function(rt){ht[rt]=function(ft){var yt=Ee.subscr,ot=!!yt,kt=nd(Ee,me)&&A_(rt,ft)?ft.obsSet={}:yt;if(ot){var Nt=function(en){return en="idb://".concat(z,"/").concat(ae,"/").concat(en),kt[en]||(kt[en]=new Zi)},Mt=Nt(""),Pt=Nt(":dels"),yt=gt[rt](ft),ot=yt[0],yt=yt[1];if((rt==="query"&&ot.isPrimaryKey&&!ft.values?Pt:Nt(ot.name||"")).add(yt),!ot.isPrimaryKey){if(rt!=="count"){var Xt=rt==="query"&&st&&ft.values&&me.query(r(r({},ft),{values:!1}));return me[rt].apply(this,arguments).then(function(en){if(rt==="query"){if(st&&ft.values)return Xt.then(function($n){return $n=$n.result,Mt.addKeys($n),en});var an=ft.values?en.result.map(Ge):en.result;(ft.values?Mt:Pt).addKeys(an)}else if(rt==="openCursor"){var Kt=en,mn=ft.values;return Kt&&Object.create(Kt,{key:{get:function(){return Pt.addKey(Kt.primaryKey),Kt.key}},primaryKey:{get:function(){var $n=Kt.primaryKey;return Pt.addKey($n),$n}},value:{get:function(){return mn&&Mt.addKey(Kt.primaryKey),Kt.value}}})}return en})}Pt.add(ne)}}return me[rt].apply(this,arguments)}}),ht}})}};function R_(M,z,ne){if(ne.numFailures===0)return z;if(z.type==="deleteRange")return null;var ae=z.keys?z.keys.length:"values"in z&&z.values?z.values.length:1;return ne.numFailures===ae?null:(z=r({},z),o(z.keys)&&(z.keys=z.keys.filter(function(me,Ae){return!(Ae in ne.failures)})),"values"in z&&o(z.values)&&(z.values=z.values.filter(function(me,Ae){return!(Ae in ne.failures)})),z)}function kg(M,z){return ne=M,((ae=z).lower===void 0||(ae.lowerOpen?0<Dr(ne,ae.lower):0<=Dr(ne,ae.lower)))&&(M=M,(z=z).upper===void 0||(z.upperOpen?Dr(M,z.upper)<0:Dr(M,z.upper)<=0));var ne,ae}function Hb(M,z,gt,ae,me,Ae){if(!gt||gt.length===0)return M;var Le=z.query.index,Ge=Le.multiEntry,st=z.query.range,at=ae.schema.primaryKey.extractKey,ht=Le.extractKey,Je=(Le.lowLevelIndex||Le).extractKey,gt=gt.reduce(function(rt,ft){var yt=rt,ot=[];if(ft.type==="add"||ft.type==="put")for(var kt=new Zi,Nt=ft.values.length-1;0<=Nt;--Nt){var Mt,Pt=ft.values[Nt],Xt=at(Pt);kt.hasKey(Xt)||(Mt=ht(Pt),(Ge&&o(Mt)?Mt.some(function(Kt){return kg(Kt,st)}):kg(Mt,st))&&(kt.addKey(Xt),ot.push(Pt)))}switch(ft.type){case"add":var rn=new Zi().addKeys(z.values?rt.map(function(mn){return at(mn)}):rt),yt=rt.concat(z.values?ot.filter(function(mn){return mn=at(mn),!rn.hasKey(mn)&&(rn.addKey(mn),!0)}):ot.map(function(mn){return at(mn)}).filter(function(mn){return!rn.hasKey(mn)&&(rn.addKey(mn),!0)}));break;case"put":var Gt=new Zi().addKeys(ft.values.map(function(mn){return at(mn)}));yt=rt.filter(function(mn){return!Gt.hasKey(z.values?at(mn):mn)}).concat(z.values?ot:ot.map(function(mn){return at(mn)}));break;case"delete":var en=new Zi().addKeys(ft.keys);yt=rt.filter(function(mn){return!en.hasKey(z.values?at(mn):mn)});break;case"deleteRange":var an=ft.range;yt=rt.filter(function(mn){return!kg(at(mn),an)})}return yt},M);return gt===M?M:(gt.sort(function(rt,ft){return Dr(Je(rt),Je(ft))||Dr(at(rt),at(ft))}),z.limit&&z.limit<1/0&&(gt.length>z.limit?gt.length=z.limit:M.length===z.limit&&gt.length<z.limit&&(me.dirty=!0)),Ae?Object.freeze(gt):gt)}function Ef(M,z){return Dr(M.lower,z.lower)===0&&Dr(M.upper,z.upper)===0&&!!M.lowerOpen==!!z.lowerOpen&&!!M.upperOpen==!!z.upperOpen}function vp(M,z){return function(ne,ae,me,Ae){if(ne===void 0)return ae!==void 0?-1:0;if(ae===void 0)return 1;if((ae=Dr(ne,ae))===0){if(me&&Ae)return 0;if(me)return 1;if(Ae)return-1}return ae}(M.lower,z.lower,M.lowerOpen,z.lowerOpen)<=0&&0<=function(ne,ae,me,Ae){if(ne===void 0)return ae!==void 0?1:0;if(ae===void 0)return-1;if((ae=Dr(ne,ae))===0){if(me&&Ae)return 0;if(me)return-1;if(Ae)return 1}return ae}(M.upper,z.upper,M.upperOpen,z.upperOpen)}function RA(M,z,ne,ae){M.subscribers.add(ne),ae.addEventListener("abort",function(){var me,Ae;M.subscribers.delete(ne),M.subscribers.size===0&&(me=M,Ae=z,setTimeout(function(){me.subscribers.size===0&&L(Ae,me)},3e3))})}var Eg={stack:"dbcore",level:0,name:"Cache",create:function(M){var z=M.schema.name;return r(r({},M),{transaction:function(ne,ae,me){var Ae,Le,Ge=M.transaction(ne,ae,me);return ae==="readwrite"&&(Le=(Ae=new AbortController).signal,me=function(st){return function(){if(Ae.abort(),ae==="readwrite"){for(var at=new Set,ht=0,Je=ne;ht<Je.length;ht++){var gt=Je[ht],rt=td["idb://".concat(z,"/").concat(gt)];if(rt){var ft=M.table(gt),yt=rt.optimisticOps.filter(function(mn){return mn.trans===Ge});if(Ge._explicit&&st&&Ge.mutatedParts)for(var ot=0,kt=Object.values(rt.queries.query);ot<kt.length;ot++)for(var Nt=0,Mt=(rn=kt[ot]).slice();Nt<Mt.length;Nt++)zb((Gt=Mt[Nt]).obsSet,Ge.mutatedParts)&&(L(rn,Gt),Gt.subscribers.forEach(function(mn){return at.add(mn)}));else if(0<yt.length){rt.optimisticOps=rt.optimisticOps.filter(function(mn){return mn.trans!==Ge});for(var Pt=0,Xt=Object.values(rt.queries.query);Pt<Xt.length;Pt++)for(var rn,Gt,en,an=0,Kt=(rn=Xt[Pt]).slice();an<Kt.length;an++)(Gt=Kt[an]).res!=null&&Ge.mutatedParts&&(st&&!Gt.dirty?(en=Object.isFrozen(Gt.res),en=Hb(Gt.res,Gt.req,yt,ft,Gt,en),Gt.dirty?(L(rn,Gt),Gt.subscribers.forEach(function(mn){return at.add(mn)})):en!==Gt.res&&(Gt.res=en,Gt.promise=$.resolve({result:en}))):(Gt.dirty&&L(rn,Gt),Gt.subscribers.forEach(function(mn){return at.add(mn)})))}}}at.forEach(function(mn){return mn()})}}},Ge.addEventListener("abort",me(!1),{signal:Le}),Ge.addEventListener("error",me(!1),{signal:Le}),Ge.addEventListener("complete",me(!0),{signal:Le})),Ge},table:function(ne){var ae=M.table(ne),me=ae.schema.primaryKey;return r(r({},ae),{mutate:function(Ae){var Le=Ee.trans;if(me.outbound||Le.db._options.cache==="disabled"||Le.explicit||Le.idbtrans.mode!=="readwrite")return ae.mutate(Ae);var Ge=td["idb://".concat(z,"/").concat(ne)];return Ge?(Le=ae.mutate(Ae),Ae.type!=="add"&&Ae.type!=="put"||!(50<=Ae.values.length||Cg(me,Ae).some(function(st){return st==null}))?(Ge.optimisticOps.push(Ae),Ae.mutatedParts&&_g(Ae.mutatedParts),Le.then(function(st){0<st.numFailures&&(L(Ge.optimisticOps,Ae),(st=R_(0,Ae,st))&&Ge.optimisticOps.push(st),Ae.mutatedParts&&_g(Ae.mutatedParts))}),Le.catch(function(){L(Ge.optimisticOps,Ae),Ae.mutatedParts&&_g(Ae.mutatedParts)})):Le.then(function(st){var at=R_(0,r(r({},Ae),{values:Ae.values.map(function(ht,Je){var gt;return st.failures[Je]?ht:(ht=(gt=me.keyPath)!==null&&gt!==void 0&&gt.includes(".")?W(ht):r({},ht),R(ht,me.keyPath,st.results[Je]),ht)})}),st);Ge.optimisticOps.push(at),queueMicrotask(function(){return Ae.mutatedParts&&_g(Ae.mutatedParts)})}),Le):ae.mutate(Ae)},query:function(Ae){if(!nd(Ee,ae)||!A_("query",Ae))return ae.query(Ae);var Le=((at=Ee.trans)===null||at===void 0?void 0:at.db._options.cache)==="immutable",Je=Ee,Ge=Je.requery,st=Je.signal,at=function(ft,yt,ot,kt){var Nt=td["idb://".concat(ft,"/").concat(yt)];if(!Nt)return[];if(!(yt=Nt.queries[ot]))return[null,!1,Nt,null];var Mt=yt[(kt.query?kt.query.index.name:null)||""];if(!Mt)return[null,!1,Nt,null];switch(ot){case"query":var Pt=Mt.find(function(Xt){return Xt.req.limit===kt.limit&&Xt.req.values===kt.values&&Ef(Xt.req.query.range,kt.query.range)});return Pt?[Pt,!0,Nt,Mt]:[Mt.find(function(Xt){return("limit"in Xt.req?Xt.req.limit:1/0)>=kt.limit&&(!kt.values||Xt.req.values)&&vp(Xt.req.query.range,kt.query.range)}),!1,Nt,Mt];case"count":return Pt=Mt.find(function(Xt){return Ef(Xt.req.query.range,kt.query.range)}),[Pt,!!Pt,Nt,Mt]}}(z,ne,"query",Ae),ht=at[0],Je=at[1],gt=at[2],rt=at[3];return ht&&Je?ht.obsSet=Ae.obsSet:(Je=ae.query(Ae).then(function(ft){var yt=ft.result;if(ht&&(ht.res=yt),Le){for(var ot=0,kt=yt.length;ot<kt;++ot)Object.freeze(yt[ot]);Object.freeze(yt)}else ft.result=W(yt);return ft}).catch(function(ft){return rt&&ht&&L(rt,ht),Promise.reject(ft)}),ht={obsSet:Ae.obsSet,promise:Je,subscribers:new Set,type:"query",req:Ae,dirty:!1},rt?rt.push(ht):(rt=[ht],(gt=gt||(td["idb://".concat(z,"/").concat(ne)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[Ae.query.index.name||""]=rt)),RA(ht,rt,Ge,st),ht.promise.then(function(ft){return{result:Hb(ft.result,Ae,gt==null?void 0:gt.optimisticOps,ae,ht,Le)}})}})}})}};function xp(M,z){return new Proxy(M,{get:function(ne,ae,me){return ae==="db"?z:Reflect.get(ne,ae,me)}})}var Cl=(Bs.prototype.version=function(M){if(isNaN(M)||M<.1)throw new Ce.Type("Given version is not a positive number");if(M=Math.round(10*M)/10,this.idbdb||this._state.isBeingOpened)throw new Ce.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,M);var z=this._versions,ne=z.filter(function(ae){return ae._cfg.version===M})[0];return ne||(ne=new this.Version(M),z.push(ne),z.sort(Pb),ne.stores({}),this._state.autoSchema=!1,ne)},Bs.prototype._whenReady=function(M){var z=this;return this.idbdb&&(this._state.openComplete||Ee.letThrough||this._vip)?M():new $(function(ne,ae){if(z._state.openComplete)return ae(new Ce.DatabaseClosed(z._state.dbOpenError));if(!z._state.isBeingOpened){if(!z._state.autoOpen)return void ae(new Ce.DatabaseClosed);z.open().catch(We)}z._state.dbReadyPromise.then(ne,ae)}).then(M)},Bs.prototype.use=function(M){var z=M.stack,ne=M.create,ae=M.level,me=M.name;return me&&this.unuse({stack:z,name:me}),M=this._middlewares[z]||(this._middlewares[z]=[]),M.push({stack:z,create:ne,level:ae??10,name:me}),M.sort(function(Ae,Le){return Ae.level-Le.level}),this},Bs.prototype.unuse=function(M){var z=M.stack,ne=M.name,ae=M.create;return z&&this._middlewares[z]&&(this._middlewares[z]=this._middlewares[z].filter(function(me){return ae?me.create!==ae:!!ne&&me.name!==ne})),this},Bs.prototype.open=function(){var M=this;return nt(ge,function(){return EA(M)})},Bs.prototype._close=function(){var M=this._state,z=di.indexOf(this);if(0<=z&&di.splice(z,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}M.isBeingOpened||(M.dbReadyPromise=new $(function(ne){M.dbReadyResolve=ne}),M.openCanceller=new $(function(ne,ae){M.cancelOpen=ae}))},Bs.prototype.close=function(ne){var z=(ne===void 0?{disableAutoOpen:!0}:ne).disableAutoOpen,ne=this._state;z?(ne.isBeingOpened&&ne.cancelOpen(new Ce.DatabaseClosed),this._close(),ne.autoOpen=!1,ne.dbOpenError=new Ce.DatabaseClosed):(this._close(),ne.autoOpen=this._options.autoOpen||ne.isBeingOpened,ne.openComplete=!1,ne.dbOpenError=null)},Bs.prototype.delete=function(M){var z=this;M===void 0&&(M={disableAutoOpen:!0});var ne=0<arguments.length&&typeof arguments[0]!="object",ae=this._state;return new $(function(me,Ae){function Le(){z.close(M);var Ge=z._deps.indexedDB.deleteDatabase(z.name);Ge.onsuccess=De(function(){var st,at,ht;st=z._deps,at=z.name,ht=st.indexedDB,st=st.IDBKeyRange,vg(ht)||at===Wa||Fb(ht,st).delete(at).catch(We),me()}),Ge.onerror=Ko(Ae),Ge.onblocked=z._fireOnBlocked}if(ne)throw new Ce.InvalidArgument("Invalid closeOptions argument to db.delete()");ae.isBeingOpened?ae.dbReadyPromise.then(Le):Le()})},Bs.prototype.backendDB=function(){return this.idbdb},Bs.prototype.isOpen=function(){return this.idbdb!==null},Bs.prototype.hasBeenClosed=function(){var M=this._state.dbOpenError;return M&&M.name==="DatabaseClosed"},Bs.prototype.hasFailed=function(){return this._state.dbOpenError!==null},Bs.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(Bs.prototype,"tables",{get:function(){var M=this;return a(this._allTables).map(function(z){return M._allTables[z]})},enumerable:!1,configurable:!0}),Bs.prototype.transaction=function(){var M=(function(z,ne,ae){var me=arguments.length;if(me<2)throw new Ce.InvalidArgument("Too few arguments");for(var Ae=new Array(me-1);--me;)Ae[me-1]=arguments[me];return ae=Ae.pop(),[z,P(Ae),ae]}).apply(this,arguments);return this._transaction.apply(this,M)},Bs.prototype._transaction=function(M,z,ne){var ae=this,me=Ee.trans;me&&me.db===this&&M.indexOf("!")===-1||(me=null);var Ae,Le,Ge=M.indexOf("?")!==-1;M=M.replace("!","").replace("?","");try{if(Le=z.map(function(at){if(at=at instanceof ae.Table?at.name:at,typeof at!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return at}),M=="r"||M===ha)Ae=ha;else{if(M!="rw"&&M!=Hs)throw new Ce.InvalidArgument("Invalid transaction mode: "+M);Ae=Hs}if(me){if(me.mode===ha&&Ae===Hs){if(!Ge)throw new Ce.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");me=null}me&&Le.forEach(function(at){if(me&&me.storeNames.indexOf(at)===-1){if(!Ge)throw new Ce.SubTransaction("Table "+at+" not included in parent transaction.");me=null}}),Ge&&me&&!me.active&&(me=null)}}catch(at){return me?me._promise(null,function(ht,Je){Je(at)}):sr(at)}var st=(function at(ht,Je,gt,rt,ft){return $.resolve().then(function(){var yt=Ee.transless||Ee,ot=ht._createTransaction(Je,gt,ht._dbSchema,rt);if(ot.explicit=!0,yt={trans:ot,transless:yt},rt)ot.idbtrans=rt.idbtrans;else try{ot.create(),ot.idbtrans._explicit=!0,ht._state.PR1398_maxLoop=3}catch(Mt){return Mt.name===Fe.InvalidState&&ht.isOpen()&&0<--ht._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),ht.close({disableAutoOpen:!1}),ht.open().then(function(){return at(ht,Je,gt,null,ft)})):sr(Mt)}var kt,Nt=Q(ft);return Nt&&gr(),yt=$.follow(function(){var Mt;(kt=ft.call(ot,ot))&&(Nt?(Mt=Nr.bind(null,null),kt.then(Mt,Mt)):typeof kt.next=="function"&&typeof kt.throw=="function"&&(kt=bp(kt)))},yt),(kt&&typeof kt.then=="function"?$.resolve(kt).then(function(Mt){return ot.active?Mt:sr(new Ce.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):yt.then(function(){return kt})).then(function(Mt){return rt&&ot._resolve(),ot._completion.then(function(){return Mt})}).catch(function(Mt){return ot._reject(Mt),sr(Mt)})})}).bind(null,this,Ae,Le,me,ne);return me?me._promise(Ae,st,"lock"):Ee.trans?nt(Ee.transless,function(){return ae._whenReady(st)}):this._whenReady(st)},Bs.prototype.table=function(M){if(!d(this._allTables,M))throw new Ce.InvalidTable("Table ".concat(M," does not exist"));return this._allTables[M]},Bs);function Bs(M,z){var ne=this;this._middlewares={},this.verno=0;var ae=Bs.dependencies;this._options=z=r({addons:Bs.addons,autoOpen:!0,indexedDB:ae.indexedDB,IDBKeyRange:ae.IDBKeyRange,cache:"cloned"},z),this._deps={indexedDB:z.indexedDB,IDBKeyRange:z.IDBKeyRange},ae=z.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var me,Ae,Le,Ge,st,at={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:We,dbReadyPromise:null,cancelOpen:We,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:z.autoOpen};at.dbReadyPromise=new $(function(Je){at.dbReadyResolve=Je}),at.openCanceller=new $(function(Je,gt){at.cancelOpen=gt}),this._state=at,this.name=M,this.on=Gc(this,"populate","blocked","versionchange","close",{ready:[Re,We]}),this.on.ready.subscribe=S(this.on.ready.subscribe,function(Je){return function(gt,rt){Bs.vip(function(){var ft,yt=ne._state;yt.openComplete?(yt.dbOpenError||$.resolve().then(gt),rt&&Je(gt)):yt.onReadyBeingFired?(yt.onReadyBeingFired.push(gt),rt&&Je(gt)):(Je(gt),ft=ne,rt||Je(function ot(){ft.on.ready.unsubscribe(gt),ft.on.ready.unsubscribe(ot)}))})}}),this.Collection=(me=this,mf(vf.prototype,function(kt,ot){this.db=me;var rt=wl,ft=null;if(ot)try{rt=ot()}catch(Nt){ft=Nt}var yt=kt._ctx,ot=yt.table,kt=ot.hook.reading.fire;this._ctx={table:ot,index:yt.index,isPrimKey:!yt.index||ot.schema.primKey.keyPath&&yt.index===ot.schema.primKey.name,range:rt,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:ft,or:yt.or,valueMapper:kt!==Ie?kt:null}})),this.Table=(Ae=this,mf(Rb.prototype,function(Je,gt,rt){this.db=Ae,this._tx=rt,this.name=Je,this.schema=gt,this.hook=Ae._allTables[Je]?Ae._allTables[Je].hook:Gc(null,{creating:[Ne,We],reading:[K,Ie],updating:[oe,We],deleting:[ce,We]})})),this.Transaction=(Le=this,mf(Ob.prototype,function(Je,gt,rt,ft,yt){var ot=this;this.db=Le,this.mode=Je,this.storeNames=gt,this.schema=rt,this.chromeTransactionDurability=ft,this.idbtrans=null,this.on=Gc(this,"complete","error","abort"),this.parent=yt||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new $(function(kt,Nt){ot._resolve=kt,ot._reject=Nt}),this._completion.then(function(){ot.active=!1,ot.on.complete.fire()},function(kt){var Nt=ot.active;return ot.active=!1,ot.on.error.fire(kt),ot.parent?ot.parent._reject(kt):Nt&&ot.idbtrans&&ot.idbtrans.abort(),sr(kt)})})),this.Version=(Ge=this,mf(kA.prototype,function(Je){this.db=Ge,this._cfg={version:Je,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(st=this,mf(Zu.prototype,function(Je,gt,rt){if(this.db=st,this._ctx={table:Je,index:gt===":id"?null:gt,or:rt},this._cmp=this._ascending=Dr,this._descending=function(ft,yt){return Dr(yt,ft)},this._max=function(ft,yt){return 0<Dr(ft,yt)?ft:yt},this._min=function(ft,yt){return Dr(ft,yt)<0?ft:yt},this._IDBKeyRange=st._deps.IDBKeyRange,!this._IDBKeyRange)throw new Ce.MissingAPI})),this.on("versionchange",function(Je){0<Je.newVersion?console.warn("Another connection wants to upgrade database '".concat(ne.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(ne.name,"'. Closing db now to resume the delete request.")),ne.close({disableAutoOpen:!1})}),this.on("blocked",function(Je){!Je.newVersion||Je.newVersion<Je.oldVersion?console.warn("Dexie.delete('".concat(ne.name,"') was blocked")):console.warn("Upgrade '".concat(ne.name,"' blocked by other connection holding version ").concat(Je.oldVersion/10))}),this._maxKey=Sf(z.IDBKeyRange),this._createTransaction=function(Je,gt,rt,ft){return new ne.Transaction(Je,gt,rt,ne._options.chromeTransactionDurability,ft)},this._fireOnBlocked=function(Je){ne.on("blocked").fire(Je),di.filter(function(gt){return gt.name===ne.name&&gt!==ne&&!gt._state.vcFired}).map(function(gt){return gt.on("versionchange").fire(Je)})},this.use(T_),this.use(Eg),this.use(AA),this.use(TA),this.use(E_);var ht=new Proxy(this,{get:function(Je,gt,rt){if(gt==="_vip")return!0;if(gt==="table")return function(yt){return xp(ne.table(yt),ht)};var ft=Reflect.get(Je,gt,rt);return ft instanceof Rb?xp(ft,ht):gt==="tables"?ft.map(function(yt){return xp(yt,ht)}):gt==="_createTransaction"?function(){return xp(ft.apply(this,arguments),ht)}:ft}});this.vip=ht,ae.forEach(function(Je){return Je(ne)})}var Tf,Ka=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",N_=(Tg.prototype.subscribe=function(M,z,ne){return this._subscribe(M&&typeof M!="function"?M:{next:M,error:z,complete:ne})},Tg.prototype[Ka]=function(){return this},Tg);function Tg(M){this._subscribe=M}try{Tf={indexedDB:i.indexedDB||i.mozIndexedDB||i.webkitIndexedDB||i.msIndexedDB,IDBKeyRange:i.IDBKeyRange||i.webkitIDBKeyRange}}catch{Tf={indexedDB:null,IDBKeyRange:null}}function M_(M){var z,ne=!1,ae=new N_(function(me){var Ae=Q(M),Le,Ge=!1,st={},at={},ht={get closed(){return Ge},unsubscribe:function(){Ge||(Ge=!0,Le&&Le.abort(),Je&&Yi.storagemutated.unsubscribe(rt))}};me.start&&me.start(ht);var Je=!1,gt=function(){return pn(ft)},rt=function(yt){wg(st,yt),zb(at,st)&&gt()},ft=function(){var yt,ot,kt;!Ge&&Tf.indexedDB&&(st={},yt={},Le&&Le.abort(),Le=new AbortController,kt=function(Nt){var Mt=Y();try{Ae&&gr();var Pt=un(M,Nt);return Pt=Ae?Pt.finally(Nr):Pt}finally{Mt&&G()}}(ot={subscr:yt,signal:Le.signal,requery:gt,querier:M,trans:null}),Promise.resolve(kt).then(function(Nt){ne=!0,z=Nt,Ge||ot.signal.aborted||(st={},function(Mt){for(var Pt in Mt)if(d(Mt,Pt))return;return 1}(at=yt)||Je||(Yi(wf,rt),Je=!0),pn(function(){return!Ge&&me.next&&me.next(Nt)}))},function(Nt){ne=!1,["DatabaseClosedError","AbortError"].includes(Nt==null?void 0:Nt.name)||Ge||pn(function(){Ge||me.error&&me.error(Nt)})}))};return setTimeout(gt,0),ht});return ae.hasValue=function(){return ne},ae.getValue=function(){return z},ae}var rd=Cl;function Gb(M){var z=Zc;try{Zc=!0,Yi.storagemutated.fire(M),Vb(M,!0)}finally{Zc=z}}h(rd,r(r({},Qe),{delete:function(M){return new rd(M,{addons:[]}).delete()},exists:function(M){return new rd(M,{addons:[]}).open().then(function(z){return z.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(M){try{return z=rd.dependencies,ne=z.indexedDB,z=z.IDBKeyRange,(vg(ne)?Promise.resolve(ne.databases()).then(function(ae){return ae.map(function(me){return me.name}).filter(function(me){return me!==Wa})}):Fb(ne,z).toCollection().primaryKeys()).then(M)}catch{return sr(new Ce.MissingAPI)}var z,ne},defineClass:function(){return function(M){l(this,M)}},ignoreTransaction:function(M){return Ee.trans?nt(Ee.transless,M):M()},vip:Lb,async:function(M){return function(){try{var z=bp(M.apply(this,arguments));return z&&typeof z.then=="function"?z:$.resolve(z)}catch(ne){return sr(ne)}}},spawn:function(M,z,ne){try{var ae=bp(M.apply(ne,z||[]));return ae&&typeof ae.then=="function"?ae:$.resolve(ae)}catch(me){return sr(me)}},currentTransaction:{get:function(){return Ee.trans||null}},waitFor:function(M,z){return z=$.resolve(typeof M=="function"?rd.ignoreTransaction(M):M).timeout(z||6e4),Ee.trans?Ee.trans.waitFor(z):z},Promise:$,debug:{get:function(){return Be},set:function(M){Te(M)}},derive:b,extend:l,props:h,override:S,Events:Gc,on:Yi,liveQuery:M_,extendObservabilitySet:wg,getByKeyPath:T,setByKeyPath:R,delByKeyPath:function(M,z){typeof z=="string"?R(M,z,void 0):"length"in z&&[].map.call(z,function(ne){R(M,ne,void 0)})},shallowClone:N,deepClone:W,getObjectDiff:Sg,cmp:Dr,asap:C,minKey:-1/0,addons:[],connections:di,errnames:Fe,dependencies:Tf,cache:td,semVer:"4.0.11",version:"4.0.11".split(".").map(function(M){return parseInt(M)}).reduce(function(M,z,ne){return M+z/Math.pow(10,2*ne)})})),rd.maxKey=Sf(rd.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(Yi(wf,function(M){Zc||(M=new CustomEvent(Ju,{detail:M}),Zc=!0,dispatchEvent(M),Zc=!1)}),addEventListener(Ju,function(M){M=M.detail,Zc||Gb(M)}));var Af,Zc=!1,Aa=function(){};return typeof BroadcastChannel<"u"&&((Aa=function(){(Af=new BroadcastChannel(Ju)).onmessage=function(M){return M.data&&Gb(M.data)}})(),typeof Af.unref=="function"&&Af.unref(),Yi(wf,function(M){Zc||Af.postMessage(M)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(M){if(!Cl.disableBfCache&&M.persisted){Be&&console.debug("Dexie: handling persisted pagehide"),Af!=null&&Af.close();for(var z=0,ne=di;z<ne.length;z++)ne[z].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(M){!Cl.disableBfCache&&M.persisted&&(Be&&console.debug("Dexie: handling persisted pageshow"),Aa(),Gb({all:new Zi(-1/0,[[]])}))})),$.rejectionMapper=function(M,z){return!M||M instanceof se||M instanceof TypeError||M instanceof SyntaxError||!M.name||!qe[M.name]?M:(z=new qe[M.name](z||M.message,M),"stack"in M&&y(z,"stack",{get:function(){return this.inner.stack}}),z)},Te(Be),r(Cl,Object.freeze({__proto__:null,Dexie:Cl,liveQuery:M_,Entity:lg,cmp:Dr,PropModification:bf,replacePrefix:function(M,z){return new bf({replacePrefix:[M,z]})},add:function(M){return new bf({add:M})},remove:function(M){return new bf({remove:M})},default:Cl,RangeSet:Zi,mergeRanges:ed,rangesOverlap:S_}),{default:Cl}),Cl})}(A2)),A2.exports}var _0e=w0e();const ij=ua(_0e),qB=Symbol.for("Dexie"),uC=globalThis[qB]||(globalThis[qB]=ij);if(ij.semVer!==uC.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${ij.semVer} and ${uC.semVer}`);const{liveQuery:edt,mergeRanges:tdt,rangesOverlap:ndt,RangeSet:rdt,cmp:sdt,Entity:idt,PropModification:adt,replacePrefix:odt,add:ldt,remove:cdt}=uC;class S0e extends uC{constructor(){super("LiteChatDatabase_Rewrite_v1");de(this,"conversations");de(this,"interactions");de(this,"mods");de(this,"appState");de(this,"providerConfigs");de(this,"apiKeys");de(this,"syncRepos");de(this,"projects");de(this,"rules");de(this,"tags");de(this,"tagRuleLinks");de(this,"promptTemplates");this.version(9).stores({conversations:"++id, title, createdAt, updatedAt, syncRepoId, lastSyncedAt, projectId",interactions:"++id, conversationId, index, type, status, startedAt, parentId, rating",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name",syncRepos:"++id, &name, remoteUrl, username",projects:"++id, &path, parentId, createdAt, updatedAt, name",rules:"++id, &name, type, createdAt, updatedAt",tags:"++id, &name, createdAt, updatedAt",tagRuleLinks:"++id, tagId, ruleId, &[tagId+ruleId]",promptTemplates:"++id, &name, createdAt, updatedAt, isPublic"}),this.version(8).stores({conversations:"++id, title, createdAt, updatedAt, syncRepoId, lastSyncedAt, projectId",interactions:"++id, conversationId, index, type, status, startedAt, parentId, rating",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name",syncRepos:"++id, &name, remoteUrl, username",projects:"++id, &path, parentId, createdAt, updatedAt, name",rules:"++id, &name, type, createdAt, updatedAt",tags:"++id, &name, createdAt, updatedAt",tagRuleLinks:"++id, tagId, ruleId, &[tagId+ruleId]"}),this.version(7).stores({conversations:"++id, title, createdAt, updatedAt, syncRepoId, lastSyncedAt, projectId",interactions:"++id, conversationId, index, type, status, startedAt, parentId",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name",syncRepos:"++id, &name, remoteUrl, username",projects:"++id, &path, parentId, createdAt, updatedAt, name",rules:"++id, &name, type, createdAt, updatedAt",tags:"++id, &name, createdAt, updatedAt",tagRuleLinks:"++id, tagId, ruleId, &[tagId+ruleId]"}),this.version(6).stores({conversations:"++id, title, createdAt, updatedAt, syncRepoId, lastSyncedAt, projectId",interactions:"++id, conversationId, index, type, status, startedAt, parentId",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name",syncRepos:"++id, &name, remoteUrl, username",projects:"++id, &path, parentId, createdAt, updatedAt, name"}),this.version(5).stores({conversations:"++id, title, createdAt, updatedAt, syncRepoId, lastSyncedAt, projectId",interactions:"++id, conversationId, index, type, status, startedAt, parentId",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name",syncRepos:"++id, &name, remoteUrl",projects:"++id, &path, parentId, createdAt, updatedAt, name"}),this.version(4).stores({conversations:"++id, title, createdAt, updatedAt, syncRepoId, lastSyncedAt, projectId",interactions:"++id, conversationId, index, type, status, startedAt, parentId",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name",syncRepos:"++id, &name, remoteUrl",projects:"++id, name, parentId, createdAt, updatedAt"}),this.version(3).stores({conversations:"++id, title, createdAt, updatedAt, syncRepoId, lastSyncedAt, projectId",interactions:"++id, conversationId, index, type, status, startedAt, parentId",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name",syncRepos:"++id, &name, remoteUrl",projects:"++id, &name, parentId, createdAt, updatedAt"}),this.version(2).stores({conversations:"++id, title, createdAt, updatedAt, syncRepoId, lastSyncedAt",interactions:"++id, conversationId, index, type, status, startedAt, parentId",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name",syncRepos:"++id, &name, remoteUrl"}),this.version(1).stores({conversations:"++id, title, createdAt, updatedAt",interactions:"++id, conversationId, index, type, status, startedAt, parentId",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name"})}}const It=new S0e,C0e="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";let as=(e=21)=>{let t="",n=crypto.getRandomValues(new Uint8Array(e|=0));for(;e--;)t+=C0e[n[e]&63];return t};const mi=(e,t=[])=>{const n={...e};return e.createdAt&&!(e.createdAt instanceof Date)&&(n.createdAt=new Date(e.createdAt)),e.updatedAt&&!(e.updatedAt instanceof Date)&&(n.updatedAt=new Date(e.updatedAt)),Array.isArray(t)?t.forEach(r=>{e[r]&&!(e[r]instanceof Date)&&(n[r]=new Date(e[r]))}):console.warn("[ensureDateFields] Expected otherDateFields to be an array, but received:",t),n};class _t{static async loadConversations(){try{return(await It.conversations.orderBy("updatedAt").reverse().toArray()).map(n=>mi(n,["lastSyncedAt"]))}catch(t){throw console.error("PersistenceService: Error loading conversations:",t),t}}static async saveConversation(t){try{const n={...t,syncRepoId:t.syncRepoId??null,lastSyncedAt:t.lastSyncedAt??null,projectId:t.projectId??null};return await It.conversations.put(n)}catch(n){throw console.error("PersistenceService: Error saving conversation:",n),n}}static async deleteConversation(t){try{await It.conversations.delete(t)}catch(n){throw console.error("PersistenceService: Error deleting conversation:",n),n}}static async loadInteractionsForConversation(t){try{return(await It.interactions.where({conversationId:t}).sortBy("index")).map(r=>mi(r,["startedAt","endedAt"]))}catch(n){throw console.error("PersistenceService: Error loading interactions for conversation:",n),n}}static async saveInteraction(t){try{return await It.interactions.put(t)}catch(n){throw console.error("PersistenceService: Error saving interaction:",n),n}}static async deleteInteraction(t){try{await It.interactions.delete(t)}catch(n){throw console.error("PersistenceService: Error deleting interaction:",n),n}}static async deleteInteractionsForConversation(t){try{await It.interactions.where({conversationId:t}).delete()}catch(n){throw console.error("PersistenceService: Error deleting interactions for conversation:",n),n}}static async loadMods(){try{return(await It.mods.orderBy("loadOrder").toArray()).map(n=>mi(n,[]))}catch(t){throw console.error("PersistenceService: Error loading mods:",t),t}}static async saveMod(t){try{return await It.mods.put(t)}catch(n){throw console.error("PersistenceService: Error saving mod:",n),n}}static async deleteMod(t){try{await It.mods.delete(t)}catch(n){throw console.error("PersistenceService: Error deleting mod:",n),n}}static async saveSetting(t,n){try{return await It.appState.put({key:`settings:${t}`,value:n})}catch(r){throw console.error("PersistenceService: Error saving setting:",r),r}}static async loadSetting(t,n){try{const r=await It.appState.get(`settings:${t}`);return(r==null?void 0:r.value)!==void 0?r.value:n}catch(r){return console.error("PersistenceService: Error loading setting:",r),n}}static async loadProviderConfigs(){var t;try{return(await((t=It.providerConfigs)==null?void 0:t.toArray())??[]).map(r=>mi(r,["modelsLastFetchedAt"]))}catch(n){throw console.error("PersistenceService: Error loading provider configs:",n),n}}static async saveProviderConfig(t){try{return await It.providerConfigs.put(t)}catch(n){throw console.error("PersistenceService: Error saving provider config:",n),n}}static async deleteProviderConfig(t){try{await It.providerConfigs.delete(t)}catch(n){throw console.error("PersistenceService: Error deleting provider config:",n),n}}static async loadApiKeys(){var t;try{return(await((t=It.apiKeys)==null?void 0:t.toArray())??[]).map(r=>mi(r,[]))}catch(n){throw console.error("PersistenceService: Error loading API keys:",n),n}}static async saveApiKey(t){try{return await It.apiKeys.put(t)}catch(n){throw console.error("PersistenceService: Error saving API key:",n),n}}static async deleteApiKey(t){try{await It.transaction("rw",[It.apiKeys,It.providerConfigs],async()=>{const n=await It.providerConfigs.where("apiKeyId").equals(t).toArray();if(n.length>0){const r=n.map(s=>It.providerConfigs.update(s.id,{apiKeyId:null}));await Promise.all(r),console.log(`PersistenceService: Unlinked API key ${t} from ${n.length} provider configs.`)}await It.apiKeys.delete(t)})}catch(n){throw console.error("PersistenceService: Error deleting API key:",n),n}}static async loadSyncRepos(){try{return(await It.syncRepos.toArray()).map(n=>mi(n,["lastPulledAt","lastPushedAt"]))}catch(t){throw console.error("PersistenceService: Error loading sync repos:",t),t}}static async saveSyncRepo(t){try{return await It.syncRepos.put(t)}catch(n){throw console.error("PersistenceService: Error saving sync repo:",n),n}}static async deleteSyncRepo(t){try{await It.transaction("rw",[It.syncRepos,It.conversations],async()=>{const n=await It.conversations.where("syncRepoId").equals(t).toArray();if(n.length>0){const r=n.map(s=>It.conversations.update(s.id,{syncRepoId:null}));await Promise.all(r),console.log(`PersistenceService: Unlinked SyncRepo ${t} from ${n.length} conversations.`)}await It.syncRepos.delete(t)})}catch(n){throw console.error("PersistenceService: Error deleting sync repo:",n),n}}static async loadProjects(){try{return(await It.projects.orderBy("updatedAt").reverse().toArray()).map(n=>mi(n,[]))}catch(t){throw console.error("PersistenceService: Error loading projects:",t),t}}static async saveProject(t){try{const n={id:t.id,path:t.path,createdAt:t.createdAt,updatedAt:t.updatedAt,name:t.name,parentId:t.parentId??null,systemPrompt:t.systemPrompt??null,modelId:t.modelId??null,temperature:t.temperature??null,maxTokens:t.maxTokens??null,topP:t.topP??null,topK:t.topK??null,presencePenalty:t.presencePenalty??null,frequencyPenalty:t.frequencyPenalty??null,defaultTagIds:t.defaultTagIds??null,defaultRuleIds:t.defaultRuleIds??null,metadata:t.metadata?{...t.metadata}:{}};return await It.projects.put(n)}catch(n){throw console.error("PersistenceService: Error saving project:",n),n}}static async deleteProject(t){try{const n=async r=>{const s=await It.projects.where("parentId").equals(r).toArray();for(const i of s)await n(i.id);await It.projects.delete(r),console.log(`PersistenceService: Deleted Project ${r}`)};await It.transaction("rw",[It.projects],async()=>{await n(t)})}catch(n){throw console.error("PersistenceService: Error deleting project:",n),n}}static async loadRules(){try{return(await It.rules.orderBy("name").toArray()).map(n=>mi(n))}catch(t){throw console.error("PersistenceService: Error loading rules:",t),t}}static async saveRule(t){try{return await It.rules.put(t)}catch(n){throw console.error("PersistenceService: Error saving rule:",n),n}}static async deleteRule(t){try{await It.transaction("rw",[It.rules,It.tagRuleLinks],async()=>{await It.tagRuleLinks.where("ruleId").equals(t).delete(),await It.rules.delete(t)})}catch(n){throw console.error("PersistenceService: Error deleting rule:",n),n}}static async loadTags(){try{return(await It.tags.orderBy("name").toArray()).map(n=>mi(n))}catch(t){throw console.error("PersistenceService: Error loading tags:",t),t}}static async saveTag(t){try{return await It.tags.put(t)}catch(n){throw console.error("PersistenceService: Error saving tag:",n),n}}static async deleteTag(t){try{await It.transaction("rw",[It.tags,It.tagRuleLinks],async()=>{await It.tagRuleLinks.where("tagId").equals(t).delete(),await It.tags.delete(t)})}catch(n){throw console.error("PersistenceService: Error deleting tag:",n),n}}static async loadTagRuleLinks(){try{return await It.tagRuleLinks.toArray()}catch(t){throw console.error("PersistenceService: Error loading tag-rule links:",t),t}}static async saveTagRuleLink(t){try{return await It.tagRuleLinks.put(t)}catch(n){throw console.error("PersistenceService: Error saving tag-rule link:",n),n}}static async deleteTagRuleLink(t){try{await It.tagRuleLinks.delete(t)}catch(n){throw console.error("PersistenceService: Error deleting tag-rule link:",n),n}}static async getAllDataForExport(t){const n={version:1,exportedAt:new Date().toISOString()};if(t.importSettings){const r=await It.appState.toArray();n.settings={},r.forEach(s=>{s.key.startsWith("settings:")&&s.key!=="settings:mcpServers"&&(n.settings[s.key.substring(9)]=s.value)})}if(t.importApiKeys&&(n.apiKeys=await It.apiKeys.toArray()),t.importProviderConfigs&&(n.providerConfigs=await It.providerConfigs.toArray()),t.importProjects&&(n.projects=await It.projects.toArray()),t.importConversations&&(n.conversations=await It.conversations.toArray(),n.interactions=await It.interactions.toArray()),t.importRulesAndTags&&(n.rules=await It.rules.toArray(),n.tags=await It.tags.toArray(),n.tagRuleLinks=await It.tagRuleLinks.toArray()),t.importMods&&(n.mods=await It.mods.toArray()),t.importSyncRepos&&(n.syncRepos=await It.syncRepos.toArray()),t.importMcpServers){const s=(await It.appState.toArray()).find(i=>i.key==="settings:mcpServers");n.mcpServers=s?s.value:[]}if(t.importPromptTemplates){const r=await It.promptTemplates.toArray();n.promptTemplates=r.filter(s=>!s.type||s.type==="prompt")}if(t.importAgents){const r=await It.promptTemplates.toArray(),s=r.filter(o=>o.type==="agent"),i=s.map(o=>o.id),a=r.filter(o=>o.type==="task"&&i.includes(o.parentId));n.agents=[...s,...a]}return n}static async importAllData(t,n){if(t.version!==1)throw new Error(`Unsupported export version: ${t.version}. Expected version 1.`);await It.transaction("rw",[It.appState,It.apiKeys,It.providerConfigs,It.projects,It.conversations,It.interactions,It.rules,It.tags,It.tagRuleLinks,It.mods,It.syncRepos,It.promptTemplates],async()=>{if(n.importSettings&&await It.appState.clear(),n.importApiKeys&&await It.apiKeys.clear(),n.importProviderConfigs&&await It.providerConfigs.clear(),n.importProjects&&await It.projects.clear(),n.importConversations&&(await It.conversations.clear(),await It.interactions.clear()),n.importRulesAndTags&&(await It.rules.clear(),await It.tags.clear(),await It.tagRuleLinks.clear()),n.importMods&&await It.mods.clear(),n.importSyncRepos&&await It.syncRepos.clear(),n.importMcpServers&&await It.appState.where("key").equals("settings:mcpServers").delete(),n.importPromptTemplates){const i=(await It.promptTemplates.toArray()).filter(a=>!a.type||a.type==="prompt").map(a=>a.id||as());i.length>0&&await It.promptTemplates.where("id").anyOf(i).delete()}if(n.importAgents&&t.agents){const s=t.agents.filter(l=>l.type==="agent").map(l=>l.id||as()),a=t.agents.filter(l=>l.type==="task").map(l=>l.id||as()),o=[...s,...a];o.length>0&&await It.promptTemplates.where("id").anyOf(o).delete()}if(n.importSettings&&t.settings){const r=Object.entries(t.settings).map(([s,i])=>({key:`settings:${s}`,value:i}));await It.appState.bulkPut(r)}n.importApiKeys&&t.apiKeys&&await It.apiKeys.bulkPut(t.apiKeys.map(r=>mi(r))),n.importProviderConfigs&&t.providerConfigs&&await It.providerConfigs.bulkPut(t.providerConfigs.map(r=>mi(r,["modelsLastFetchedAt"]))),n.importProjects&&t.projects&&await It.projects.bulkPut(t.projects.map(r=>mi(r))),n.importConversations&&t.conversations&&(await It.conversations.bulkPut(t.conversations.map(r=>mi(r,["lastSyncedAt"]))),t.interactions&&await It.interactions.bulkPut(t.interactions.map(r=>mi(r,["startedAt","endedAt"])))),n.importRulesAndTags&&(t.rules&&await It.rules.bulkPut(t.rules.map(r=>mi(r))),t.tags&&await It.tags.bulkPut(t.tags.map(r=>mi(r))),t.tagRuleLinks&&await It.tagRuleLinks.bulkPut(t.tagRuleLinks)),n.importMods&&t.mods&&await It.mods.bulkPut(t.mods.map(r=>mi(r))),n.importSyncRepos&&t.syncRepos&&await It.syncRepos.bulkPut(t.syncRepos.map(r=>mi(r,["lastPulledAt","lastPushedAt"]))),n.importMcpServers&&t.mcpServers&&await It.appState.put({key:"settings:mcpServers",value:t.mcpServers}),n.importPromptTemplates&&t.promptTemplates&&await It.promptTemplates.bulkPut(t.promptTemplates.map(r=>mi({...r,id:r.id||as()},["createdAt","updatedAt"]))),n.importAgents&&t.agents&&await It.promptTemplates.bulkPut(t.agents.map(r=>mi({...r,id:r.id||as()},["createdAt","updatedAt"])))})}static async loadPromptTemplates(){try{return(await It.promptTemplates.orderBy("name").toArray()).map(n=>mi(n,["createdAt","updatedAt"]))}catch(t){throw console.error("PersistenceService: Error loading prompt templates:",t),t}}static async savePromptTemplate(t){try{return await It.promptTemplates.put(t)}catch(n){throw console.error("PersistenceService: Error saving prompt template:",n),n}}static async deletePromptTemplate(t){try{await It.promptTemplates.delete(t)}catch(n){throw console.error("PersistenceService: Error deleting prompt template:",n),n}}static async clearAllData(){try{await It.transaction("rw",[It.conversations,It.interactions,It.mods,It.appState,It.providerConfigs,It.apiKeys,It.syncRepos,It.projects,It.rules,It.tags,It.tagRuleLinks,It.promptTemplates],async()=>{await It.conversations.clear(),await It.interactions.clear(),await It.mods.clear(),await It.appState.clear(),await It.providerConfigs.clear(),await It.apiKeys.clear(),await It.syncRepos.clear(),await It.projects.clear(),await It.rules.clear(),await It.tags.clear(),await It.tagRuleLinks.clear(),await It.promptTemplates.clear()})}catch(t){throw console.error("PersistenceService: Error clearing all data:",t),t}}}const Zn={loaded:"interaction.loaded",currentConversationIdChanged:"interaction.current.conversation.id.changed",added:"interaction.added",updated:"interaction.updated",streamingIdsChanged:"interaction.streaming.ids.changed",activeStreamBuffersChanged:"interaction.active.stream.buffers.changed",activeReasoningBuffersChanged:"interaction.active.reasoning.buffers.changed",statusChanged:"interaction.status.changed",errorChanged:"interaction.error.changed",interactionRated:"interaction.rated",started:"interaction.sdk.started",streamChunk:"interaction.sdk.streamChunk",completed:"interaction.sdk.completed",loadInteractionsRequest:"interaction.load.interactions.request",rateInteractionRequest:"interaction.rate.interaction.request",setCurrentConversationIdRequest:"interaction.set.current.conversation.id.request",clearInteractionsRequest:"interaction.clear.interactions.request",setErrorRequest:"interaction.set.error.request",setStatusRequest:"interaction.set.status.request"};var cl=tH();const _E=ua(cl);function k0e(e){if(typeof document>"u")return;let t=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",t.appendChild(n),n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e))}const E0e=e=>{switch(e){case"success":return R0e;case"info":return M0e;case"warning":return N0e;case"error":return I0e;default:return null}},T0e=Array(12).fill(0),A0e=({visible:e,className:t})=>Ve.createElement("div",{className:["sonner-loading-wrapper",t].filter(Boolean).join(" "),"data-visible":e},Ve.createElement("div",{className:"sonner-spinner"},T0e.map((n,r)=>Ve.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${r}`})))),R0e=Ve.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Ve.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),N0e=Ve.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},Ve.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),M0e=Ve.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Ve.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),I0e=Ve.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Ve.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),j0e=Ve.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},Ve.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),Ve.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),O0e=()=>{const[e,t]=Ve.useState(document.hidden);return Ve.useEffect(()=>{const n=()=>{t(document.hidden)};return document.addEventListener("visibilitychange",n),()=>window.removeEventListener("visibilitychange",n)},[]),e};let aj=1;class P0e{constructor(){this.subscribe=t=>(this.subscribers.push(t),()=>{const n=this.subscribers.indexOf(t);this.subscribers.splice(n,1)}),this.publish=t=>{this.subscribers.forEach(n=>n(t))},this.addToast=t=>{this.publish(t),this.toasts=[...this.toasts,t]},this.create=t=>{var n;const{message:r,...s}=t,i=typeof(t==null?void 0:t.id)=="number"||((n=t.id)==null?void 0:n.length)>0?t.id:aj++,a=this.toasts.find(l=>l.id===i),o=t.dismissible===void 0?!0:t.dismissible;return this.dismissedToasts.has(i)&&this.dismissedToasts.delete(i),a?this.toasts=this.toasts.map(l=>l.id===i?(this.publish({...l,...t,id:i,title:r}),{...l,...t,id:i,dismissible:o,title:r}):l):this.addToast({title:r,...s,dismissible:o,id:i}),i},this.dismiss=t=>(t?(this.dismissedToasts.add(t),requestAnimationFrame(()=>this.subscribers.forEach(n=>n({id:t,dismiss:!0})))):this.toasts.forEach(n=>{this.subscribers.forEach(r=>r({id:n.id,dismiss:!0}))}),t),this.message=(t,n)=>this.create({...n,message:t}),this.error=(t,n)=>this.create({...n,message:t,type:"error"}),this.success=(t,n)=>this.create({...n,type:"success",message:t}),this.info=(t,n)=>this.create({...n,type:"info",message:t}),this.warning=(t,n)=>this.create({...n,type:"warning",message:t}),this.loading=(t,n)=>this.create({...n,type:"loading",message:t}),this.promise=(t,n)=>{if(!n)return;let r;n.loading!==void 0&&(r=this.create({...n,promise:t,type:"loading",message:n.loading,description:typeof n.description!="function"?n.description:void 0}));const s=Promise.resolve(t instanceof Function?t():t);let i=r!==void 0,a;const o=s.then(async c=>{if(a=["resolve",c],Ve.isValidElement(c))i=!1,this.create({id:r,type:"default",message:c});else if(F0e(c)&&!c.ok){i=!1;const d=typeof n.error=="function"?await n.error(`HTTP error! status: ${c.status}`):n.error,h=typeof n.description=="function"?await n.description(`HTTP error! status: ${c.status}`):n.description,y=typeof d=="object"&&!Ve.isValidElement(d)?d:{message:d};this.create({id:r,type:"error",description:h,...y})}else if(c instanceof Error){i=!1;const d=typeof n.error=="function"?await n.error(c):n.error,h=typeof n.description=="function"?await n.description(c):n.description,y=typeof d=="object"&&!Ve.isValidElement(d)?d:{message:d};this.create({id:r,type:"error",description:h,...y})}else if(n.success!==void 0){i=!1;const d=typeof n.success=="function"?await n.success(c):n.success,h=typeof n.description=="function"?await n.description(c):n.description,y=typeof d=="object"&&!Ve.isValidElement(d)?d:{message:d};this.create({id:r,type:"success",description:h,...y})}}).catch(async c=>{if(a=["reject",c],n.error!==void 0){i=!1;const u=typeof n.error=="function"?await n.error(c):n.error,d=typeof n.description=="function"?await n.description(c):n.description,m=typeof u=="object"&&!Ve.isValidElement(u)?u:{message:u};this.create({id:r,type:"error",description:d,...m})}}).finally(()=>{i&&(this.dismiss(r),r=void 0),n.finally==null||n.finally.call(n)}),l=()=>new Promise((c,u)=>o.then(()=>a[0]==="reject"?u(a[1]):c(a[1])).catch(u));return typeof r!="string"&&typeof r!="number"?{unwrap:l}:Object.assign(r,{unwrap:l})},this.custom=(t,n)=>{const r=(n==null?void 0:n.id)||aj++;return this.create({jsx:t(r),id:r,...n}),r},this.getActiveToasts=()=>this.toasts.filter(t=>!this.dismissedToasts.has(t.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}}const _o=new P0e,D0e=(e,t)=>{const n=(t==null?void 0:t.id)||aj++;return _o.addToast({title:e,...t,id:n}),n},F0e=e=>e&&typeof e=="object"&&"ok"in e&&typeof e.ok=="boolean"&&"status"in e&&typeof e.status=="number",L0e=D0e,B0e=()=>_o.toasts,$0e=()=>_o.getActiveToasts(),Me=Object.assign(L0e,{success:_o.success,info:_o.info,warning:_o.warning,error:_o.error,custom:_o.custom,message:_o.message,promise:_o.promise,dismiss:_o.dismiss,loading:_o.loading},{getHistory:B0e,getToasts:$0e});k0e("[data-sonner-toaster][dir=ltr],html[dir=ltr]{--toast-icon-margin-start:-3px;--toast-icon-margin-end:4px;--toast-svg-margin-start:-1px;--toast-svg-margin-end:0px;--toast-button-margin-start:auto;--toast-button-margin-end:0;--toast-close-button-start:0;--toast-close-button-end:unset;--toast-close-button-transform:translate(-35%, -35%)}[data-sonner-toaster][dir=rtl],html[dir=rtl]{--toast-icon-margin-start:4px;--toast-icon-margin-end:-3px;--toast-svg-margin-start:0px;--toast-svg-margin-end:-1px;--toast-button-margin-start:0;--toast-button-margin-end:auto;--toast-close-button-start:unset;--toast-close-button-end:0;--toast-close-button-transform:translate(35%, -35%)}[data-sonner-toaster]{position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1:hsl(0, 0%, 99%);--gray2:hsl(0, 0%, 97.3%);--gray3:hsl(0, 0%, 95.1%);--gray4:hsl(0, 0%, 93%);--gray5:hsl(0, 0%, 90.9%);--gray6:hsl(0, 0%, 88.7%);--gray7:hsl(0, 0%, 85.8%);--gray8:hsl(0, 0%, 78%);--gray9:hsl(0, 0%, 56.1%);--gray10:hsl(0, 0%, 52.3%);--gray11:hsl(0, 0%, 43.5%);--gray12:hsl(0, 0%, 9%);--border-radius:8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:0;z-index:999999999;transition:transform .4s ease}[data-sonner-toaster][data-lifted=true]{transform:translateY(-8px)}@media (hover:none) and (pointer:coarse){[data-sonner-toaster][data-lifted=true]{transform:none}}[data-sonner-toaster][data-x-position=right]{right:var(--offset-right)}[data-sonner-toaster][data-x-position=left]{left:var(--offset-left)}[data-sonner-toaster][data-x-position=center]{left:50%;transform:translateX(-50%)}[data-sonner-toaster][data-y-position=top]{top:var(--offset-top)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--offset-bottom)}[data-sonner-toast]{--y:translateY(100%);--lift-amount:calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:0;overflow-wrap:anywhere}[data-sonner-toast][data-styled=true]{padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px rgba(0,0,0,.1);width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}[data-sonner-toast]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-y-position=top]{top:0;--y:translateY(-100%);--lift:1;--lift-amount:calc(1 * var(--gap))}[data-sonner-toast][data-y-position=bottom]{bottom:0;--y:translateY(100%);--lift:-1;--lift-amount:calc(var(--lift) * var(--gap))}[data-sonner-toast][data-styled=true] [data-description]{font-weight:400;line-height:1.4;color:#3f3f3f}[data-rich-colors=true][data-sonner-toast][data-styled=true] [data-description]{color:inherit}[data-sonner-toaster][data-sonner-theme=dark] [data-description]{color:#e8e8e8}[data-sonner-toast][data-styled=true] [data-title]{font-weight:500;line-height:1.5;color:inherit}[data-sonner-toast][data-styled=true] [data-icon]{display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}[data-sonner-toast][data-promise=true] [data-icon]>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}[data-sonner-toast][data-styled=true] [data-icon]>*{flex-shrink:0}[data-sonner-toast][data-styled=true] [data-icon] svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}[data-sonner-toast][data-styled=true] [data-content]{display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;font-weight:500;cursor:pointer;outline:0;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}[data-sonner-toast][data-styled=true] [data-button]:focus-visible{box-shadow:0 0 0 2px rgba(0,0,0,.4)}[data-sonner-toast][data-styled=true] [data-button]:first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}[data-sonner-toast][data-styled=true] [data-cancel]{color:var(--normal-text);background:rgba(0,0,0,.08)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-styled=true] [data-cancel]{background:rgba(255,255,255,.3)}[data-sonner-toast][data-styled=true] [data-close-button]{position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);background:var(--normal-bg);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast][data-styled=true] [data-close-button]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-styled=true] [data-disabled=true]{cursor:not-allowed}[data-sonner-toast][data-styled=true]:hover [data-close-button]:hover{background:var(--gray2);border-color:var(--gray5)}[data-sonner-toast][data-swiping=true]::before{content:'';position:absolute;left:-100%;right:-100%;height:100%;z-index:-1}[data-sonner-toast][data-y-position=top][data-swiping=true]::before{bottom:50%;transform:scaleY(3) translateY(50%)}[data-sonner-toast][data-y-position=bottom][data-swiping=true]::before{top:50%;transform:scaleY(3) translateY(-50%)}[data-sonner-toast][data-swiping=false][data-removed=true]::before{content:'';position:absolute;inset:0;transform:scaleY(2)}[data-sonner-toast][data-expanded=true]::after{content:'';position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}[data-sonner-toast][data-mounted=true]{--y:translateY(0);opacity:1}[data-sonner-toast][data-expanded=false][data-front=false]{--scale:var(--toasts-before) * 0.05 + 1;--y:translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}[data-sonner-toast]>*{transition:opacity .4s}[data-sonner-toast][data-x-position=right]{right:0}[data-sonner-toast][data-x-position=left]{left:0}[data-sonner-toast][data-expanded=false][data-front=false][data-styled=true]>*{opacity:0}[data-sonner-toast][data-visible=false]{opacity:0;pointer-events:none}[data-sonner-toast][data-mounted=true][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}[data-sonner-toast][data-removed=true][data-front=true][data-swipe-out=false]{--y:translateY(calc(var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=false]{--y:translateY(40%);opacity:0;transition:transform .5s,opacity .2s}[data-sonner-toast][data-removed=true][data-front=false]::before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y,0)) translateX(var(--swipe-amount-x,0));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width:600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-sonner-theme=light]{--normal-bg:#fff;--normal-border:var(--gray4);--normal-text:var(--gray12);--success-bg:hsl(143, 85%, 96%);--success-border:hsl(145, 92%, 87%);--success-text:hsl(140, 100%, 27%);--info-bg:hsl(208, 100%, 97%);--info-border:hsl(221, 91%, 93%);--info-text:hsl(210, 92%, 45%);--warning-bg:hsl(49, 100%, 97%);--warning-border:hsl(49, 91%, 84%);--warning-text:hsl(31, 92%, 45%);--error-bg:hsl(359, 100%, 97%);--error-border:hsl(359, 100%, 94%);--error-text:hsl(360, 100%, 45%)}[data-sonner-toaster][data-sonner-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg:#000;--normal-border:hsl(0, 0%, 20%);--normal-text:var(--gray1)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg:#fff;--normal-border:var(--gray3);--normal-text:var(--gray12)}[data-sonner-toaster][data-sonner-theme=dark]{--normal-bg:#000;--normal-bg-hover:hsl(0, 0%, 12%);--normal-border:hsl(0, 0%, 20%);--normal-border-hover:hsl(0, 0%, 25%);--normal-text:var(--gray1);--success-bg:hsl(150, 100%, 6%);--success-border:hsl(147, 100%, 12%);--success-text:hsl(150, 86%, 65%);--info-bg:hsl(215, 100%, 6%);--info-border:hsl(223, 43%, 17%);--info-text:hsl(216, 87%, 65%);--warning-bg:hsl(64, 100%, 6%);--warning-border:hsl(60, 100%, 9%);--warning-text:hsl(46, 87%, 65%);--error-bg:hsl(358, 76%, 10%);--error-border:hsl(357, 89%, 16%);--error-text:hsl(358, 100%, 81%)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size:16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:first-child{animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}100%{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}100%{opacity:.15}}@media (prefers-reduced-motion){.sonner-loading-bar,[data-sonner-toast],[data-sonner-toast]>*{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}");function NS(e){return e.label!==void 0}const z0e=3,U0e="24px",q0e="16px",VB=4e3,V0e=356,W0e=14,H0e=45,G0e=200;function ru(...e){return e.filter(Boolean).join(" ")}function K0e(e){const[t,n]=e.split("-"),r=[];return t&&r.push(t),n&&r.push(n),r}const Y0e=e=>{var t,n,r,s,i,a,o,l,c;const{invert:u,toast:d,unstyled:h,interacting:m,setHeights:y,visibleToasts:b,heights:v,index:x,toasts:w,expanded:S,removeToast:k,defaultRichColors:C,closeButton:T,style:R,cancelButtonStyle:N,actionButtonStyle:I,className:P="",descriptionClassName:B="",duration:D,position:W,gap:O,expandByDefault:Z,classNames:U,icons:H,closeButtonAriaLabel:L="Close toast"}=e,[te,V]=Ve.useState(null),[Q,ee]=Ve.useState(null),[se,pe]=Ve.useState(!1),[ue,Oe]=Ve.useState(!1),[Fe,Se]=Ve.useState(!1),[Ce,qe]=Ve.useState(!1),[Qe,We]=Ve.useState(!1),[Ie,K]=Ve.useState(0),[ye,Ne]=Ve.useState(0),ce=Ve.useRef(d.duration||D||VB),oe=Ve.useRef(null),re=Ve.useRef(null),Re=x===0,Be=x+1<=b,Te=d.type,lt=d.dismissible!==!1,Tt=d.className||"",ut=d.descriptionClassName||"",jt=Ve.useMemo(()=>v.findIndex(_e=>_e.toastId===d.id)||0,[v,d.id]),qt=Ve.useMemo(()=>{var _e;return(_e=d.closeButton)!=null?_e:T},[d.closeButton,T]),Ft=Ve.useMemo(()=>d.duration||D||VB,[d.duration,D]),Ht=Ve.useRef(0),we=Ve.useRef(0),F=Ve.useRef(0),X=Ve.useRef(null),[be,ke]=W.split("-"),ge=Ve.useMemo(()=>v.reduce((_e,$e,Ct)=>Ct>=jt?_e:_e+$e.height,0),[v,jt]),Ee=O0e(),le=d.invert||u,dt=Te==="loading";we.current=Ve.useMemo(()=>jt*O+ge,[jt,ge]),Ve.useEffect(()=>{ce.current=Ft},[Ft]),Ve.useEffect(()=>{pe(!0)},[]),Ve.useEffect(()=>{const _e=re.current;if(_e){const $e=_e.getBoundingClientRect().height;return Ne($e),y(Ct=>[{toastId:d.id,height:$e,position:d.position},...Ct]),()=>y(Ct=>Ct.filter(fe=>fe.toastId!==d.id))}},[y,d.id]),Ve.useLayoutEffect(()=>{if(!se)return;const _e=re.current,$e=_e.style.height;_e.style.height="auto";const Ct=_e.getBoundingClientRect().height;_e.style.height=$e,Ne(Ct),y(fe=>fe.find(G=>G.toastId===d.id)?fe.map(G=>G.toastId===d.id?{...G,height:Ct}:G):[{toastId:d.id,height:Ct,position:d.position},...fe])},[se,d.title,d.description,y,d.id]);const et=Ve.useCallback(()=>{Oe(!0),K(we.current),y(_e=>_e.filter($e=>$e.toastId!==d.id)),setTimeout(()=>{k(d)},G0e)},[d,k,y,we]);Ve.useEffect(()=>{if(d.promise&&Te==="loading"||d.duration===1/0||d.type==="loading")return;let _e;return S||m||Ee?(()=>{if(F.current<Ht.current){const fe=new Date().getTime()-Ht.current;ce.current=ce.current-fe}F.current=new Date().getTime()})():(()=>{ce.current!==1/0&&(Ht.current=new Date().getTime(),_e=setTimeout(()=>{d.onAutoClose==null||d.onAutoClose.call(d,d),et()},ce.current))})(),()=>clearTimeout(_e)},[S,m,d,Te,Ee,et]),Ve.useEffect(()=>{d.delete&&et()},[et,d.delete]);function $(){var _e;if(H!=null&&H.loading){var $e;return Ve.createElement("div",{className:ru(U==null?void 0:U.loader,d==null||($e=d.classNames)==null?void 0:$e.loader,"sonner-loader"),"data-visible":Te==="loading"},H.loading)}return Ve.createElement(A0e,{className:ru(U==null?void 0:U.loader,d==null||(_e=d.classNames)==null?void 0:_e.loader),visible:Te==="loading"})}const Ue=d.icon||(H==null?void 0:H[Te])||E0e(Te);var tt,ve;return Ve.createElement("li",{tabIndex:0,ref:re,className:ru(P,Tt,U==null?void 0:U.toast,d==null||(t=d.classNames)==null?void 0:t.toast,U==null?void 0:U.default,U==null?void 0:U[Te],d==null||(n=d.classNames)==null?void 0:n[Te]),"data-sonner-toast":"","data-rich-colors":(tt=d.richColors)!=null?tt:C,"data-styled":!(d.jsx||d.unstyled||h),"data-mounted":se,"data-promise":!!d.promise,"data-swiped":Qe,"data-removed":ue,"data-visible":Be,"data-y-position":be,"data-x-position":ke,"data-index":x,"data-front":Re,"data-swiping":Fe,"data-dismissible":lt,"data-type":Te,"data-invert":le,"data-swipe-out":Ce,"data-swipe-direction":Q,"data-expanded":!!(S||Z&&se),style:{"--index":x,"--toasts-before":x,"--z-index":w.length-x,"--offset":`${ue?Ie:we.current}px`,"--initial-height":Z?"auto":`${ye}px`,...R,...d.style},onDragEnd:()=>{Se(!1),V(null),X.current=null},onPointerDown:_e=>{dt||!lt||(oe.current=new Date,K(we.current),_e.target.setPointerCapture(_e.pointerId),_e.target.tagName!=="BUTTON"&&(Se(!0),X.current={x:_e.clientX,y:_e.clientY}))},onPointerUp:()=>{var _e,$e,Ct;if(Ce||!lt)return;X.current=null;const fe=Number(((_e=re.current)==null?void 0:_e.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),Y=Number((($e=re.current)==null?void 0:$e.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),G=new Date().getTime()-((Ct=oe.current)==null?void 0:Ct.getTime()),J=te==="x"?fe:Y,xe=Math.abs(J)/G;if(Math.abs(J)>=H0e||xe>.11){K(we.current),d.onDismiss==null||d.onDismiss.call(d,d),ee(te==="x"?fe>0?"right":"left":Y>0?"down":"up"),et(),qe(!0);return}else{var De,He;(De=re.current)==null||De.style.setProperty("--swipe-amount-x","0px"),(He=re.current)==null||He.style.setProperty("--swipe-amount-y","0px")}We(!1),Se(!1),V(null)},onPointerMove:_e=>{var $e,Ct,fe;if(!X.current||!lt||(($e=window.getSelection())==null?void 0:$e.toString().length)>0)return;const G=_e.clientY-X.current.y,J=_e.clientX-X.current.x;var xe;const De=(xe=e.swipeDirections)!=null?xe:K0e(W);!te&&(Math.abs(J)>1||Math.abs(G)>1)&&V(Math.abs(J)>Math.abs(G)?"x":"y");let He={x:0,y:0};const xt=Qt=>1/(1.5+Math.abs(Qt)/20);if(te==="y"){if(De.includes("top")||De.includes("bottom"))if(De.includes("top")&&G<0||De.includes("bottom")&&G>0)He.y=G;else{const Qt=G*xt(G);He.y=Math.abs(Qt)<Math.abs(G)?Qt:G}}else if(te==="x"&&(De.includes("left")||De.includes("right")))if(De.includes("left")&&J<0||De.includes("right")&&J>0)He.x=J;else{const Qt=J*xt(J);He.x=Math.abs(Qt)<Math.abs(J)?Qt:J}(Math.abs(He.x)>0||Math.abs(He.y)>0)&&We(!0),(Ct=re.current)==null||Ct.style.setProperty("--swipe-amount-x",`${He.x}px`),(fe=re.current)==null||fe.style.setProperty("--swipe-amount-y",`${He.y}px`)}},qt&&!d.jsx&&Te!=="loading"?Ve.createElement("button",{"aria-label":L,"data-disabled":dt,"data-close-button":!0,onClick:dt||!lt?()=>{}:()=>{et(),d.onDismiss==null||d.onDismiss.call(d,d)},className:ru(U==null?void 0:U.closeButton,d==null||(r=d.classNames)==null?void 0:r.closeButton)},(ve=H==null?void 0:H.close)!=null?ve:j0e):null,(Te||d.icon||d.promise)&&d.icon!==null&&((H==null?void 0:H[Te])!==null||d.icon)?Ve.createElement("div",{"data-icon":"",className:ru(U==null?void 0:U.icon,d==null||(s=d.classNames)==null?void 0:s.icon)},d.promise||d.type==="loading"&&!d.icon?d.icon||$():null,d.type!=="loading"?Ue:null):null,Ve.createElement("div",{"data-content":"",className:ru(U==null?void 0:U.content,d==null||(i=d.classNames)==null?void 0:i.content)},Ve.createElement("div",{"data-title":"",className:ru(U==null?void 0:U.title,d==null||(a=d.classNames)==null?void 0:a.title)},d.jsx?d.jsx:typeof d.title=="function"?d.title():d.title),d.description?Ve.createElement("div",{"data-description":"",className:ru(B,ut,U==null?void 0:U.description,d==null||(o=d.classNames)==null?void 0:o.description)},typeof d.description=="function"?d.description():d.description):null),Ve.isValidElement(d.cancel)?d.cancel:d.cancel&&NS(d.cancel)?Ve.createElement("button",{"data-button":!0,"data-cancel":!0,style:d.cancelButtonStyle||N,onClick:_e=>{NS(d.cancel)&&lt&&(d.cancel.onClick==null||d.cancel.onClick.call(d.cancel,_e),et())},className:ru(U==null?void 0:U.cancelButton,d==null||(l=d.classNames)==null?void 0:l.cancelButton)},d.cancel.label):null,Ve.isValidElement(d.action)?d.action:d.action&&NS(d.action)?Ve.createElement("button",{"data-button":!0,"data-action":!0,style:d.actionButtonStyle||I,onClick:_e=>{NS(d.action)&&(d.action.onClick==null||d.action.onClick.call(d.action,_e),!_e.defaultPrevented&&et())},className:ru(U==null?void 0:U.actionButton,d==null||(c=d.classNames)==null?void 0:c.actionButton)},d.action.label):null)};function WB(){if(typeof window>"u"||typeof document>"u")return"ltr";const e=document.documentElement.getAttribute("dir");return e==="auto"||!e?window.getComputedStyle(document.documentElement).direction:e}function Z0e(e,t){const n={};return[e,t].forEach((r,s)=>{const i=s===1,a=i?"--mobile-offset":"--offset",o=i?q0e:U0e;function l(c){["top","right","bottom","left"].forEach(u=>{n[`${a}-${u}`]=typeof c=="number"?`${c}px`:c})}typeof r=="number"||typeof r=="string"?l(r):typeof r=="object"?["top","right","bottom","left"].forEach(c=>{r[c]===void 0?n[`${a}-${c}`]=o:n[`${a}-${c}`]=typeof r[c]=="number"?`${r[c]}px`:r[c]}):l(o)}),n}const X0e=Ve.forwardRef(function(t,n){const{invert:r,position:s="bottom-right",hotkey:i=["altKey","KeyT"],expand:a,closeButton:o,className:l,offset:c,mobileOffset:u,theme:d="light",richColors:h,duration:m,style:y,visibleToasts:b=z0e,toastOptions:v,dir:x=WB(),gap:w=W0e,icons:S,containerAriaLabel:k="Notifications"}=t,[C,T]=Ve.useState([]),R=Ve.useMemo(()=>Array.from(new Set([s].concat(C.filter(Q=>Q.position).map(Q=>Q.position)))),[C,s]),[N,I]=Ve.useState([]),[P,B]=Ve.useState(!1),[D,W]=Ve.useState(!1),[O,Z]=Ve.useState(d!=="system"?d:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),U=Ve.useRef(null),H=i.join("+").replace(/Key/g,"").replace(/Digit/g,""),L=Ve.useRef(null),te=Ve.useRef(!1),V=Ve.useCallback(Q=>{T(ee=>{var se;return(se=ee.find(pe=>pe.id===Q.id))!=null&&se.delete||_o.dismiss(Q.id),ee.filter(({id:pe})=>pe!==Q.id)})},[]);return Ve.useEffect(()=>_o.subscribe(Q=>{if(Q.dismiss){requestAnimationFrame(()=>{T(ee=>ee.map(se=>se.id===Q.id?{...se,delete:!0}:se))});return}setTimeout(()=>{_E.flushSync(()=>{T(ee=>{const se=ee.findIndex(pe=>pe.id===Q.id);return se!==-1?[...ee.slice(0,se),{...ee[se],...Q},...ee.slice(se+1)]:[Q,...ee]})})})}),[C]),Ve.useEffect(()=>{if(d!=="system"){Z(d);return}if(d==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?Z("dark"):Z("light")),typeof window>"u")return;const Q=window.matchMedia("(prefers-color-scheme: dark)");try{Q.addEventListener("change",({matches:ee})=>{Z(ee?"dark":"light")})}catch{Q.addListener(({matches:se})=>{try{Z(se?"dark":"light")}catch(pe){console.error(pe)}})}},[d]),Ve.useEffect(()=>{C.length<=1&&B(!1)},[C]),Ve.useEffect(()=>{const Q=ee=>{var se;if(i.every(Oe=>ee[Oe]||ee.code===Oe)){var ue;B(!0),(ue=U.current)==null||ue.focus()}ee.code==="Escape"&&(document.activeElement===U.current||(se=U.current)!=null&&se.contains(document.activeElement))&&B(!1)};return document.addEventListener("keydown",Q),()=>document.removeEventListener("keydown",Q)},[i]),Ve.useEffect(()=>{if(U.current)return()=>{L.current&&(L.current.focus({preventScroll:!0}),L.current=null,te.current=!1)}},[U.current]),Ve.createElement("section",{ref:n,"aria-label":`${k} ${H}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},R.map((Q,ee)=>{var se;const[pe,ue]=Q.split("-");return C.length?Ve.createElement("ol",{key:Q,dir:x==="auto"?WB():x,tabIndex:-1,ref:U,className:l,"data-sonner-toaster":!0,"data-sonner-theme":O,"data-y-position":pe,"data-lifted":P&&C.length>1&&!a,"data-x-position":ue,style:{"--front-toast-height":`${((se=N[0])==null?void 0:se.height)||0}px`,"--width":`${V0e}px`,"--gap":`${w}px`,...y,...Z0e(c,u)},onBlur:Oe=>{te.current&&!Oe.currentTarget.contains(Oe.relatedTarget)&&(te.current=!1,L.current&&(L.current.focus({preventScroll:!0}),L.current=null))},onFocus:Oe=>{Oe.target instanceof HTMLElement&&Oe.target.dataset.dismissible==="false"||te.current||(te.current=!0,L.current=Oe.relatedTarget)},onMouseEnter:()=>B(!0),onMouseMove:()=>B(!0),onMouseLeave:()=>{D||B(!1)},onDragEnd:()=>B(!1),onPointerDown:Oe=>{Oe.target instanceof HTMLElement&&Oe.target.dataset.dismissible==="false"||W(!0)},onPointerUp:()=>W(!1)},C.filter(Oe=>!Oe.position&&ee===0||Oe.position===Q).map((Oe,Fe)=>{var Se,Ce;return Ve.createElement(Y0e,{key:Oe.id,icons:S,index:Fe,toast:Oe,defaultRichColors:h,duration:(Se=v==null?void 0:v.duration)!=null?Se:m,className:v==null?void 0:v.className,descriptionClassName:v==null?void 0:v.descriptionClassName,invert:r,visibleToasts:b,closeButton:(Ce=v==null?void 0:v.closeButton)!=null?Ce:o,interacting:D,position:Q,style:v==null?void 0:v.style,unstyled:v==null?void 0:v.unstyled,classNames:v==null?void 0:v.classNames,cancelButtonStyle:v==null?void 0:v.cancelButtonStyle,actionButtonStyle:v==null?void 0:v.actionButtonStyle,closeButtonAriaLabel:v==null?void 0:v.closeButtonAriaLabel,removeToast:V,toasts:C.filter(qe=>qe.position==Oe.position),heights:N.filter(qe=>qe.position==Oe.position),setHeights:I,expandByDefault:a,gap:w,expanded:P,swipeDirections:t.swipeDirections})})):null}))}),vn=qo(Vo((e,t)=>({interactions:[],currentConversationId:null,streamingInteractionIds:[],activeStreamBuffers:{},activeReasoningBuffers:{},error:null,status:"idle",loadInteractions:async n=>{if(t().currentConversationId!==n){console.warn(`InteractionStore: loadInteractions called for ${n}, but current is ${t().currentConversationId}. Aborting load.`);return}const r=t().status;e({status:"loading",error:null,interactions:[],streamingInteractionIds:[],activeStreamBuffers:{},activeReasoningBuffers:{}}),r!=="loading"&&Pe.emit(Zn.statusChanged,{status:"loading"});try{const s=await _t.loadInteractionsForConversation(n);s.sort((l,c)=>l.index-c.index);const i=t().interactions.filter(l=>l.conversationId===n),a=new Set(s.map(l=>l.id)),o=[...s,...i.filter(l=>!a.has(l.id))];o.sort((l,c)=>l.index-c.index),t().currentConversationId===n?(e({interactions:o,status:"idle"}),Pe.emit(Zn.loaded,{conversationId:n,interactions:o}),Pe.emit(Zn.statusChanged,{status:"idle"})):console.warn(`InteractionStore: loadInteractions for ${n} completed, but currentConversationId changed during fetch to ${t().currentConversationId}. Discarding.`)}catch(s){console.error(`InteractionStore: Error loading interactions for ${n}`,s),t().currentConversationId===n&&(e({error:"Failed load interactions",status:"error"}),Pe.emit(Zn.statusChanged,{status:"error"}),Pe.emit(Zn.errorChanged,{error:"Failed load interactions"}))}},_addInteractionToState:n=>{e(r=>{if(r.currentConversationId!==n.conversationId){console.warn(`InteractionStore: Attempted to add interaction for ${n.conversationId} but current is ${r.currentConversationId}. Skipping.`);return}if(!r.interactions.some(s=>s.id===n.id))r.interactions.push(n),r.interactions.sort((s,i)=>s.index-i.index);else{const s=r.interactions.findIndex(i=>i.id===n.id);s!==-1&&(r.interactions[s]={...r.interactions[s],...n})}}),Pe.emit(Zn.added,{interaction:n})},_updateInteractionInState:(n,r)=>{e(s=>{const i=s.interactions.findIndex(a=>a.id===n);if(i!==-1){if(s.currentConversationId!==s.interactions[i].conversationId){console.warn(`InteractionStore: Attempted to update interaction ${n} which is not in the current conversation ${s.currentConversationId}. Skipping.`);return}const a=s.interactions[i];let o={...a.metadata||{}};r.metadata&&(o={...o,...r.metadata},r.metadata.toolCalls!==void 0&&Array.isArray(r.metadata.toolCalls)&&(o.toolCalls=[...r.metadata.toolCalls]),r.metadata.toolResults!==void 0&&Array.isArray(r.metadata.toolResults)&&(o.toolResults=[...r.metadata.toolResults]),r.metadata.reasoning!==void 0&&(o.reasoning=r.metadata.reasoning));const l={...a,...r,metadata:o};"response"in r&&(l.response=r.response),"rating"in r&&(l.rating=r.rating),s.interactions[i]=l}}),Pe.emit(Zn.updated,{interactionId:n,updates:r})},appendInteractionResponseChunk:(n,r)=>{e(s=>{var i;s.streamingInteractionIds.includes(n)&&s.currentConversationId===((i=s.interactions.find(a=>a.id===n))==null?void 0:i.conversationId)&&(s.activeStreamBuffers[n]=(s.activeStreamBuffers[n]||"")+r)}),Pe.emit(Zn.activeStreamBuffersChanged,{buffers:t().activeStreamBuffers})},appendReasoningChunk:(n,r)=>{e(s=>{var i;s.streamingInteractionIds.includes(n)&&s.currentConversationId===((i=s.interactions.find(a=>a.id===n))==null?void 0:i.conversationId)&&(s.activeReasoningBuffers[n]=(s.activeReasoningBuffers[n]||"")+r)}),Pe.emit(Zn.activeReasoningBuffersChanged,{buffers:t().activeReasoningBuffers})},_removeInteractionFromState:n=>{e(r=>{r.interactions=r.interactions.filter(s=>s.id!==n)})},rateInteraction:async(n,r)=>{const s=t().interactions.find(i=>i.id===n);if(s&&t().currentConversationId===s.conversationId){t()._updateInteractionInState(n,{rating:r});try{await _t.saveInteraction({...s,rating:r}),Pe.emit(Zn.interactionRated,{interactionId:n,rating:r})}catch{t()._updateInteractionInState(n,{rating:s.rating}),Me.error("Failed to save rating.")}}},setCurrentConversationId:async n=>{const r=t().currentConversationId;if(r===n){n&&t().interactions.length===0&&t().status!=="loading"?(console.warn(`InteractionStore: Current ID ${n} matches, but no interactions. Forcing reload.`),await t().loadInteractions(n)):console.log(`InteractionStore: setCurrentConversationId called with the same ID (${n}). No change needed or already handled.`);return}console.log(`InteractionStore: Setting current conversation ID from ${r} to ${n}`),e({currentConversationId:n}),Pe.emit(Zn.currentConversationIdChanged,{conversationId:n}),n?await t().loadInteractions(n):t().clearInteractions()},clearInteractions:()=>{const n=t().status;e({interactions:[],streamingInteractionIds:[],activeStreamBuffers:{},activeReasoningBuffers:{},status:"idle",error:null,currentConversationId:null}),n!=="idle"&&Pe.emit(Zn.statusChanged,{status:"idle"}),Pe.emit(Zn.currentConversationIdChanged,{conversationId:null})},setError:n=>{const r=t().status;let s="idle";e(i=>{i.error=n,n?(s="error",i.status="error"):i.status==="error"?(s=i.streamingInteractionIds.length>0?"streaming":"idle",i.status=s):s=i.status}),r!==s&&Pe.emit(Zn.statusChanged,{status:s}),Pe.emit(Zn.errorChanged,{error:n})},setStatus:n=>{t().status!==n&&(e({status:n}),Pe.emit(Zn.statusChanged,{status:n}))},_addStreamingId:n=>{let r=!1;e(s=>{s.streamingInteractionIds.includes(n)||(s.streamingInteractionIds.push(n),s.activeStreamBuffers[n]="",s.activeReasoningBuffers[n]="",s.streamingInteractionIds.length===1&&(s.status="streaming",r=!0),s.error=null)}),r&&Pe.emit(Zn.statusChanged,{status:"streaming"}),Pe.emit(Zn.streamingIdsChanged,{streamingIds:t().streamingInteractionIds})},_removeStreamingId:n=>{let r=!1;e(s=>{const i=s.streamingInteractionIds.indexOf(n);i!==-1&&(s.streamingInteractionIds.splice(i,1),delete s.activeStreamBuffers[n],delete s.activeReasoningBuffers[n],s.streamingInteractionIds.length===0&&s.status==="streaming"&&(s.status=s.error?"error":"idle",r=!0))}),r&&Pe.emit(Zn.statusChanged,{status:t().status}),Pe.emit(Zn.streamingIdsChanged,{streamingIds:t().streamingInteractionIds})},getRegisteredActionHandlers:()=>{const n="interactionStore",r=t();return[{eventName:Zn.loadInteractionsRequest,handler:s=>r.loadInteractions(s.conversationId),storeId:n},{eventName:Zn.rateInteractionRequest,handler:s=>r.rateInteraction(s.interactionId,s.rating),storeId:n},{eventName:Zn.setCurrentConversationIdRequest,handler:s=>r.setCurrentConversationId(s.id),storeId:n},{eventName:Zn.clearInteractionsRequest,handler:()=>r.clearInteractions(),storeId:n},{eventName:Zn.setErrorRequest,handler:s=>r.setError(s.error),storeId:n},{eventName:Zn.setStatusRequest,handler:s=>r.setStatus(s.status),storeId:n}]}}))),Ul={attachedFilesChanged:"input.attached.files.changed",addAttachedFileRequest:"input.add.attached.file.request",removeAttachedFileRequest:"input.remove.attached.file.request",clearAttachedFilesRequest:"input.clear.attached.files.request"},bh=qo(Vo((e,t)=>({attachedFilesMetadata:[],addAttachedFile:n=>{let r=!1;e(s=>{if(s.attachedFilesMetadata.some(a=>a.source==="direct"&&n.source==="direct"?a.name===n.name&&a.size===n.size:a.source==="vfs"&&n.source==="vfs"?a.path===n.path:!1))console.warn(`InputStore: File "${n.name}" (source: ${n.source}) already attached. Skipping.`);else{const a={id:as(),...n};s.attachedFilesMetadata.push(a),r=!0}}),r&&Pe.emit(Ul.attachedFilesChanged,{files:t().attachedFilesMetadata})},removeAttachedFile:n=>{let r=!1;e(s=>{const i=s.attachedFilesMetadata.length;s.attachedFilesMetadata=s.attachedFilesMetadata.filter(a=>a.id!==n),r=s.attachedFilesMetadata.length<i}),r&&Pe.emit(Ul.attachedFilesChanged,{files:t().attachedFilesMetadata})},clearAttachedFiles:()=>{const n=t().attachedFilesMetadata.length>0;e({attachedFilesMetadata:[]}),n&&Pe.emit(Ul.attachedFilesChanged,{files:[]})},getRegisteredActionHandlers:()=>{const n="inputStore",r=t();return[{eventName:Ul.addAttachedFileRequest,handler:s=>r.addAttachedFile(s),storeId:n},{eventName:Ul.removeAttachedFileRequest,handler:s=>r.removeAttachedFile(s.attachmentId),storeId:n},{eventName:Ul.clearAttachedFilesRequest,handler:()=>r.clearAttachedFiles(),storeId:n}]}}))),IH=new Set([".txt",".md",".markdown",".json",".js",".ts",".jsx",".tsx",".html",".htm",".css",".scss",".less",".py",".pyw",".java",".c",".cpp",".h",".hpp",".cs",".go",".php",".rb",".swift",".kt",".kts",".rs",".toml",".yaml",".yml",".xml",".sh",".bash",".zsh",".bat",".cmd",".ps1",".gitignore",".gitattributes",".env",".log",".csv",".tsv",".ini",".cfg",".conf",".sql",".dockerfile","dockerfile",".mod",".sum",".csproj",".vbproj",".fsproj",".sln",".props",".targets",".gradle",".kts",".pom",".rst",".tex",".bib",".r",".rmd",".pl",".pm",".lua",".dart",".diff",".patch",".applescript",".properties",".http",".rest",".tf",".tfvars",".hcl",".rego",".liquid",".erb",".jinja",".j2",".mustache",".hbs",".pug",".haml",".slim",".svelte",".vue",".astro",".svg",".webmanifest",".vtt",".srt",".sbv",".ass",".ssa",".config",".mdx",".nfo",".diz"]);Object.freeze(IH);const Jx=(e,t)=>{if(!e)return!1;const n=e.toLowerCase();if(t!=null&&t.startsWith("text/")||t==="application/json"||t==="application/xml"||t==="application/javascript"||t==="application/typescript"||t==="application/yaml"||t==="application/toml"||t==="application/sql"||t==="application/x-sh"||t==="application/x-httpd-php"||t==="application/x-python"||t==="application/x-ruby"||t==="image/svg+xml"||n.split(".").length<2)return!0;const s="."+n.split(".").pop();return IH.has(s)};var jH="vercel.ai.error",J0e=Symbol.for(jH),OH,Q0e=class PH extends Error{constructor({name:t,message:n,cause:r}){super(n),this[OH]=!0,this.name=t,this.cause=r}static isInstance(t){return PH.hasMarker(t,jH)}static hasMarker(t,n){const r=Symbol.for(n);return t!=null&&typeof t=="object"&&r in t&&typeof t[r]=="boolean"&&t[r]===!0}};OH=J0e;var nr=Q0e,DH="AI_APICallError",FH=`vercel.ai.error.${DH}`,eye=Symbol.for(FH),LH,Vl=class extends nr{constructor({message:e,url:t,requestBodyValues:n,statusCode:r,responseHeaders:s,responseBody:i,cause:a,isRetryable:o=r!=null&&(r===408||r===409||r===429||r>=500),data:l}){super({name:DH,message:e,cause:a}),this[LH]=!0,this.url=t,this.requestBodyValues=n,this.statusCode=r,this.responseHeaders=s,this.responseBody=i,this.isRetryable=o,this.data=l}static isInstance(e){return nr.hasMarker(e,FH)}};LH=eye;var BH="AI_EmptyResponseBodyError",$H=`vercel.ai.error.${BH}`,tye=Symbol.for($H),zH,UH=class extends nr{constructor({message:e="Empty response body"}={}){super({name:BH,message:e}),this[zH]=!0}static isInstance(e){return nr.hasMarker(e,$H)}};zH=tye;function m1(e){return e==null?"unknown error":typeof e=="string"?e:e instanceof Error?e.message:JSON.stringify(e)}var qH="AI_InvalidArgumentError",VH=`vercel.ai.error.${qH}`,nye=Symbol.for(VH),WH,HH=class extends nr{constructor({message:t,cause:n,argument:r}){super({name:qH,message:t,cause:n}),this[WH]=!0,this.argument=r}static isInstance(t){return nr.hasMarker(t,VH)}};WH=nye;var GH="AI_InvalidPromptError",KH=`vercel.ai.error.${GH}`,rye=Symbol.for(KH),YH,xc=class extends nr{constructor({prompt:e,message:t,cause:n}){super({name:GH,message:`Invalid prompt: ${t}`,cause:n}),this[YH]=!0,this.prompt=e}static isInstance(e){return nr.hasMarker(e,KH)}};YH=rye;var ZH="AI_InvalidResponseDataError",XH=`vercel.ai.error.${ZH}`,sye=Symbol.for(XH),JH,Dd=class extends nr{constructor({data:e,message:t=`Invalid response data: ${JSON.stringify(e)}.`}){super({name:ZH,message:t}),this[JH]=!0,this.data=e}static isInstance(e){return nr.hasMarker(e,XH)}};JH=sye;var QH="AI_JSONParseError",eG=`vercel.ai.error.${QH}`,iye=Symbol.for(eG),tG,dC=class extends nr{constructor({text:e,cause:t}){super({name:QH,message:`JSON parsing failed: Text: ${e}.
Error message: ${m1(t)}`,cause:t}),this[tG]=!0,this.text=e}static isInstance(e){return nr.hasMarker(e,eG)}};tG=iye;var nG="AI_LoadAPIKeyError",rG=`vercel.ai.error.${nG}`,aye=Symbol.for(rG),sG,MS=class extends nr{constructor({message:e}){super({name:nG,message:e}),this[sG]=!0}static isInstance(e){return nr.hasMarker(e,rG)}};sG=aye;var iG="AI_TooManyEmbeddingValuesForCallError",aG=`vercel.ai.error.${iG}`,oye=Symbol.for(aG),oG,SE=class extends nr{constructor(e){super({name:iG,message:`Too many values for a single embedding call. The ${e.provider} model "${e.modelId}" can only embed up to ${e.maxEmbeddingsPerCall} values per call, but ${e.values.length} values were provided.`}),this[oG]=!0,this.provider=e.provider,this.modelId=e.modelId,this.maxEmbeddingsPerCall=e.maxEmbeddingsPerCall,this.values=e.values}static isInstance(e){return nr.hasMarker(e,aG)}};oG=oye;var lG="AI_TypeValidationError",cG=`vercel.ai.error.${lG}`,lye=Symbol.for(cG),uG,cye=class oj extends nr{constructor({value:t,cause:n}){super({name:lG,message:`Type validation failed: Value: ${JSON.stringify(t)}.
Error message: ${m1(n)}`,cause:n}),this[uG]=!0,this.value=t}static isInstance(t){return nr.hasMarker(t,cG)}static wrap({value:t,cause:n}){return oj.isInstance(n)&&n.value===t?n:new oj({value:t,cause:n})}};uG=lye;var fC=cye,dG="AI_UnsupportedFunctionalityError",fG=`vercel.ai.error.${dG}`,uye=Symbol.for(fG),hG,pr=class extends nr{constructor({functionality:e,message:t=`'${e}' functionality not supported.`}){super({name:dG,message:t}),this[hG]=!0,this.functionality=e}static isInstance(e){return nr.hasMarker(e,fG)}};hG=uye;let dye=(e,t=21)=>(n=t)=>{let r="",s=n|0;for(;s--;)r+=e[Math.random()*e.length|0];return r};var YO={},CE={};CE.byteLength=pye;CE.toByteArray=gye;CE.fromByteArray=vye;var gu=[],Bl=[],fye=typeof Uint8Array<"u"?Uint8Array:Array,wN="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var Jg=0,hye=wN.length;Jg<hye;++Jg)gu[Jg]=wN[Jg],Bl[wN.charCodeAt(Jg)]=Jg;Bl[45]=62;Bl[95]=63;function pG(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");n===-1&&(n=t);var r=n===t?0:4-n%4;return[n,r]}function pye(e){var t=pG(e),n=t[0],r=t[1];return(n+r)*3/4-r}function mye(e,t,n){return(t+n)*3/4-n}function gye(e){var t,n=pG(e),r=n[0],s=n[1],i=new fye(mye(e,r,s)),a=0,o=s>0?r-4:r,l;for(l=0;l<o;l+=4)t=Bl[e.charCodeAt(l)]<<18|Bl[e.charCodeAt(l+1)]<<12|Bl[e.charCodeAt(l+2)]<<6|Bl[e.charCodeAt(l+3)],i[a++]=t>>16&255,i[a++]=t>>8&255,i[a++]=t&255;return s===2&&(t=Bl[e.charCodeAt(l)]<<2|Bl[e.charCodeAt(l+1)]>>4,i[a++]=t&255),s===1&&(t=Bl[e.charCodeAt(l)]<<10|Bl[e.charCodeAt(l+1)]<<4|Bl[e.charCodeAt(l+2)]>>2,i[a++]=t>>8&255,i[a++]=t&255),i}function yye(e){return gu[e>>18&63]+gu[e>>12&63]+gu[e>>6&63]+gu[e&63]}function bye(e,t,n){for(var r,s=[],i=t;i<n;i+=3)r=(e[i]<<16&16711680)+(e[i+1]<<8&65280)+(e[i+2]&255),s.push(yye(r));return s.join("")}function vye(e){for(var t,n=e.length,r=n%3,s=[],i=16383,a=0,o=n-r;a<o;a+=i)s.push(bye(e,a,a+i>o?o:a+i));return r===1?(t=e[n-1],s.push(gu[t>>2]+gu[t<<4&63]+"==")):r===2&&(t=(e[n-2]<<8)+e[n-1],s.push(gu[t>>10]+gu[t>>4&63]+gu[t<<2&63]+"=")),s.join("")}var ZO={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */ZO.read=function(e,t,n,r,s){var i,a,o=s*8-r-1,l=(1<<o)-1,c=l>>1,u=-7,d=n?s-1:0,h=n?-1:1,m=e[t+d];for(d+=h,i=m&(1<<-u)-1,m>>=-u,u+=o;u>0;i=i*256+e[t+d],d+=h,u-=8);for(a=i&(1<<-u)-1,i>>=-u,u+=r;u>0;a=a*256+e[t+d],d+=h,u-=8);if(i===0)i=1-c;else{if(i===l)return a?NaN:(m?-1:1)*(1/0);a=a+Math.pow(2,r),i=i-c}return(m?-1:1)*a*Math.pow(2,i-r)};ZO.write=function(e,t,n,r,s,i){var a,o,l,c=i*8-s-1,u=(1<<c)-1,d=u>>1,h=s===23?Math.pow(2,-24)-Math.pow(2,-77):0,m=r?0:i-1,y=r?1:-1,b=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(o=isNaN(t)?1:0,a=u):(a=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-a))<1&&(a--,l*=2),a+d>=1?t+=h/l:t+=h*Math.pow(2,1-d),t*l>=2&&(a++,l/=2),a+d>=u?(o=0,a=u):a+d>=1?(o=(t*l-1)*Math.pow(2,s),a=a+d):(o=t*Math.pow(2,d-1)*Math.pow(2,s),a=0));s>=8;e[n+m]=o&255,m+=y,o/=256,s-=8);for(a=a<<s|o,c+=s;c>0;e[n+m]=a&255,m+=y,a/=256,c-=8);e[n+m-y]|=b*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(e){const t=CE,n=ZO,r=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=u,e.SlowBuffer=C,e.INSPECT_MAX_BYTES=50;const s=2147483647;e.kMaxLength=s;const{Uint8Array:i,ArrayBuffer:a,SharedArrayBuffer:o}=globalThis;u.TYPED_ARRAY_SUPPORT=l(),!u.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function l(){try{const we=new i(1),F={foo:function(){return 42}};return Object.setPrototypeOf(F,i.prototype),Object.setPrototypeOf(we,F),we.foo()===42}catch{return!1}}Object.defineProperty(u.prototype,"parent",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.buffer}}),Object.defineProperty(u.prototype,"offset",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.byteOffset}});function c(we){if(we>s)throw new RangeError('The value "'+we+'" is invalid for option "size"');const F=new i(we);return Object.setPrototypeOf(F,u.prototype),F}function u(we,F,X){if(typeof we=="number"){if(typeof F=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return y(we)}return d(we,F,X)}u.poolSize=8192;function d(we,F,X){if(typeof we=="string")return b(we,F);if(a.isView(we))return x(we);if(we==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof we);if(ut(we,a)||we&&ut(we.buffer,a)||typeof o<"u"&&(ut(we,o)||we&&ut(we.buffer,o)))return w(we,F,X);if(typeof we=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const be=we.valueOf&&we.valueOf();if(be!=null&&be!==we)return u.from(be,F,X);const ke=S(we);if(ke)return ke;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof we[Symbol.toPrimitive]=="function")return u.from(we[Symbol.toPrimitive]("string"),F,X);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof we)}u.from=function(we,F,X){return d(we,F,X)},Object.setPrototypeOf(u.prototype,i.prototype),Object.setPrototypeOf(u,i);function h(we){if(typeof we!="number")throw new TypeError('"size" argument must be of type number');if(we<0)throw new RangeError('The value "'+we+'" is invalid for option "size"')}function m(we,F,X){return h(we),we<=0?c(we):F!==void 0?typeof X=="string"?c(we).fill(F,X):c(we).fill(F):c(we)}u.alloc=function(we,F,X){return m(we,F,X)};function y(we){return h(we),c(we<0?0:k(we)|0)}u.allocUnsafe=function(we){return y(we)},u.allocUnsafeSlow=function(we){return y(we)};function b(we,F){if((typeof F!="string"||F==="")&&(F="utf8"),!u.isEncoding(F))throw new TypeError("Unknown encoding: "+F);const X=T(we,F)|0;let be=c(X);const ke=be.write(we,F);return ke!==X&&(be=be.slice(0,ke)),be}function v(we){const F=we.length<0?0:k(we.length)|0,X=c(F);for(let be=0;be<F;be+=1)X[be]=we[be]&255;return X}function x(we){if(ut(we,i)){const F=new i(we);return w(F.buffer,F.byteOffset,F.byteLength)}return v(we)}function w(we,F,X){if(F<0||we.byteLength<F)throw new RangeError('"offset" is outside of buffer bounds');if(we.byteLength<F+(X||0))throw new RangeError('"length" is outside of buffer bounds');let be;return F===void 0&&X===void 0?be=new i(we):X===void 0?be=new i(we,F):be=new i(we,F,X),Object.setPrototypeOf(be,u.prototype),be}function S(we){if(u.isBuffer(we)){const F=k(we.length)|0,X=c(F);return X.length===0||we.copy(X,0,0,F),X}if(we.length!==void 0)return typeof we.length!="number"||jt(we.length)?c(0):v(we);if(we.type==="Buffer"&&Array.isArray(we.data))return v(we.data)}function k(we){if(we>=s)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s.toString(16)+" bytes");return we|0}function C(we){return+we!=we&&(we=0),u.alloc(+we)}u.isBuffer=function(F){return F!=null&&F._isBuffer===!0&&F!==u.prototype},u.compare=function(F,X){if(ut(F,i)&&(F=u.from(F,F.offset,F.byteLength)),ut(X,i)&&(X=u.from(X,X.offset,X.byteLength)),!u.isBuffer(F)||!u.isBuffer(X))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(F===X)return 0;let be=F.length,ke=X.length;for(let ge=0,Ee=Math.min(be,ke);ge<Ee;++ge)if(F[ge]!==X[ge]){be=F[ge],ke=X[ge];break}return be<ke?-1:ke<be?1:0},u.isEncoding=function(F){switch(String(F).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(F,X){if(!Array.isArray(F))throw new TypeError('"list" argument must be an Array of Buffers');if(F.length===0)return u.alloc(0);let be;if(X===void 0)for(X=0,be=0;be<F.length;++be)X+=F[be].length;const ke=u.allocUnsafe(X);let ge=0;for(be=0;be<F.length;++be){let Ee=F[be];if(ut(Ee,i))ge+Ee.length>ke.length?(u.isBuffer(Ee)||(Ee=u.from(Ee)),Ee.copy(ke,ge)):i.prototype.set.call(ke,Ee,ge);else if(u.isBuffer(Ee))Ee.copy(ke,ge);else throw new TypeError('"list" argument must be an Array of Buffers');ge+=Ee.length}return ke};function T(we,F){if(u.isBuffer(we))return we.length;if(a.isView(we)||ut(we,a))return we.byteLength;if(typeof we!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof we);const X=we.length,be=arguments.length>2&&arguments[2]===!0;if(!be&&X===0)return 0;let ke=!1;for(;;)switch(F){case"ascii":case"latin1":case"binary":return X;case"utf8":case"utf-8":return Re(we).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return X*2;case"hex":return X>>>1;case"base64":return lt(we).length;default:if(ke)return be?-1:Re(we).length;F=(""+F).toLowerCase(),ke=!0}}u.byteLength=T;function R(we,F,X){let be=!1;if((F===void 0||F<0)&&(F=0),F>this.length||((X===void 0||X>this.length)&&(X=this.length),X<=0)||(X>>>=0,F>>>=0,X<=F))return"";for(we||(we="utf8");;)switch(we){case"hex":return ee(this,F,X);case"utf8":case"utf-8":return H(this,F,X);case"ascii":return V(this,F,X);case"latin1":case"binary":return Q(this,F,X);case"base64":return U(this,F,X);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return se(this,F,X);default:if(be)throw new TypeError("Unknown encoding: "+we);we=(we+"").toLowerCase(),be=!0}}u.prototype._isBuffer=!0;function N(we,F,X){const be=we[F];we[F]=we[X],we[X]=be}u.prototype.swap16=function(){const F=this.length;if(F%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let X=0;X<F;X+=2)N(this,X,X+1);return this},u.prototype.swap32=function(){const F=this.length;if(F%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let X=0;X<F;X+=4)N(this,X,X+3),N(this,X+1,X+2);return this},u.prototype.swap64=function(){const F=this.length;if(F%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let X=0;X<F;X+=8)N(this,X,X+7),N(this,X+1,X+6),N(this,X+2,X+5),N(this,X+3,X+4);return this},u.prototype.toString=function(){const F=this.length;return F===0?"":arguments.length===0?H(this,0,F):R.apply(this,arguments)},u.prototype.toLocaleString=u.prototype.toString,u.prototype.equals=function(F){if(!u.isBuffer(F))throw new TypeError("Argument must be a Buffer");return this===F?!0:u.compare(this,F)===0},u.prototype.inspect=function(){let F="";const X=e.INSPECT_MAX_BYTES;return F=this.toString("hex",0,X).replace(/(.{2})/g,"$1 ").trim(),this.length>X&&(F+=" ... "),"<Buffer "+F+">"},r&&(u.prototype[r]=u.prototype.inspect),u.prototype.compare=function(F,X,be,ke,ge){if(ut(F,i)&&(F=u.from(F,F.offset,F.byteLength)),!u.isBuffer(F))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof F);if(X===void 0&&(X=0),be===void 0&&(be=F?F.length:0),ke===void 0&&(ke=0),ge===void 0&&(ge=this.length),X<0||be>F.length||ke<0||ge>this.length)throw new RangeError("out of range index");if(ke>=ge&&X>=be)return 0;if(ke>=ge)return-1;if(X>=be)return 1;if(X>>>=0,be>>>=0,ke>>>=0,ge>>>=0,this===F)return 0;let Ee=ge-ke,le=be-X;const dt=Math.min(Ee,le),et=this.slice(ke,ge),$=F.slice(X,be);for(let Ue=0;Ue<dt;++Ue)if(et[Ue]!==$[Ue]){Ee=et[Ue],le=$[Ue];break}return Ee<le?-1:le<Ee?1:0};function I(we,F,X,be,ke){if(we.length===0)return-1;if(typeof X=="string"?(be=X,X=0):X>2147483647?X=2147483647:X<-2147483648&&(X=-2147483648),X=+X,jt(X)&&(X=ke?0:we.length-1),X<0&&(X=we.length+X),X>=we.length){if(ke)return-1;X=we.length-1}else if(X<0)if(ke)X=0;else return-1;if(typeof F=="string"&&(F=u.from(F,be)),u.isBuffer(F))return F.length===0?-1:P(we,F,X,be,ke);if(typeof F=="number")return F=F&255,typeof i.prototype.indexOf=="function"?ke?i.prototype.indexOf.call(we,F,X):i.prototype.lastIndexOf.call(we,F,X):P(we,[F],X,be,ke);throw new TypeError("val must be string, number or Buffer")}function P(we,F,X,be,ke){let ge=1,Ee=we.length,le=F.length;if(be!==void 0&&(be=String(be).toLowerCase(),be==="ucs2"||be==="ucs-2"||be==="utf16le"||be==="utf-16le")){if(we.length<2||F.length<2)return-1;ge=2,Ee/=2,le/=2,X/=2}function dt($,Ue){return ge===1?$[Ue]:$.readUInt16BE(Ue*ge)}let et;if(ke){let $=-1;for(et=X;et<Ee;et++)if(dt(we,et)===dt(F,$===-1?0:et-$)){if($===-1&&($=et),et-$+1===le)return $*ge}else $!==-1&&(et-=et-$),$=-1}else for(X+le>Ee&&(X=Ee-le),et=X;et>=0;et--){let $=!0;for(let Ue=0;Ue<le;Ue++)if(dt(we,et+Ue)!==dt(F,Ue)){$=!1;break}if($)return et}return-1}u.prototype.includes=function(F,X,be){return this.indexOf(F,X,be)!==-1},u.prototype.indexOf=function(F,X,be){return I(this,F,X,be,!0)},u.prototype.lastIndexOf=function(F,X,be){return I(this,F,X,be,!1)};function B(we,F,X,be){X=Number(X)||0;const ke=we.length-X;be?(be=Number(be),be>ke&&(be=ke)):be=ke;const ge=F.length;be>ge/2&&(be=ge/2);let Ee;for(Ee=0;Ee<be;++Ee){const le=parseInt(F.substr(Ee*2,2),16);if(jt(le))return Ee;we[X+Ee]=le}return Ee}function D(we,F,X,be){return Tt(Re(F,we.length-X),we,X,be)}function W(we,F,X,be){return Tt(Be(F),we,X,be)}function O(we,F,X,be){return Tt(lt(F),we,X,be)}function Z(we,F,X,be){return Tt(Te(F,we.length-X),we,X,be)}u.prototype.write=function(F,X,be,ke){if(X===void 0)ke="utf8",be=this.length,X=0;else if(be===void 0&&typeof X=="string")ke=X,be=this.length,X=0;else if(isFinite(X))X=X>>>0,isFinite(be)?(be=be>>>0,ke===void 0&&(ke="utf8")):(ke=be,be=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const ge=this.length-X;if((be===void 0||be>ge)&&(be=ge),F.length>0&&(be<0||X<0)||X>this.length)throw new RangeError("Attempt to write outside buffer bounds");ke||(ke="utf8");let Ee=!1;for(;;)switch(ke){case"hex":return B(this,F,X,be);case"utf8":case"utf-8":return D(this,F,X,be);case"ascii":case"latin1":case"binary":return W(this,F,X,be);case"base64":return O(this,F,X,be);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Z(this,F,X,be);default:if(Ee)throw new TypeError("Unknown encoding: "+ke);ke=(""+ke).toLowerCase(),Ee=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function U(we,F,X){return F===0&&X===we.length?t.fromByteArray(we):t.fromByteArray(we.slice(F,X))}function H(we,F,X){X=Math.min(we.length,X);const be=[];let ke=F;for(;ke<X;){const ge=we[ke];let Ee=null,le=ge>239?4:ge>223?3:ge>191?2:1;if(ke+le<=X){let dt,et,$,Ue;switch(le){case 1:ge<128&&(Ee=ge);break;case 2:dt=we[ke+1],(dt&192)===128&&(Ue=(ge&31)<<6|dt&63,Ue>127&&(Ee=Ue));break;case 3:dt=we[ke+1],et=we[ke+2],(dt&192)===128&&(et&192)===128&&(Ue=(ge&15)<<12|(dt&63)<<6|et&63,Ue>2047&&(Ue<55296||Ue>57343)&&(Ee=Ue));break;case 4:dt=we[ke+1],et=we[ke+2],$=we[ke+3],(dt&192)===128&&(et&192)===128&&($&192)===128&&(Ue=(ge&15)<<18|(dt&63)<<12|(et&63)<<6|$&63,Ue>65535&&Ue<1114112&&(Ee=Ue))}}Ee===null?(Ee=65533,le=1):Ee>65535&&(Ee-=65536,be.push(Ee>>>10&1023|55296),Ee=56320|Ee&1023),be.push(Ee),ke+=le}return te(be)}const L=4096;function te(we){const F=we.length;if(F<=L)return String.fromCharCode.apply(String,we);let X="",be=0;for(;be<F;)X+=String.fromCharCode.apply(String,we.slice(be,be+=L));return X}function V(we,F,X){let be="";X=Math.min(we.length,X);for(let ke=F;ke<X;++ke)be+=String.fromCharCode(we[ke]&127);return be}function Q(we,F,X){let be="";X=Math.min(we.length,X);for(let ke=F;ke<X;++ke)be+=String.fromCharCode(we[ke]);return be}function ee(we,F,X){const be=we.length;(!F||F<0)&&(F=0),(!X||X<0||X>be)&&(X=be);let ke="";for(let ge=F;ge<X;++ge)ke+=qt[we[ge]];return ke}function se(we,F,X){const be=we.slice(F,X);let ke="";for(let ge=0;ge<be.length-1;ge+=2)ke+=String.fromCharCode(be[ge]+be[ge+1]*256);return ke}u.prototype.slice=function(F,X){const be=this.length;F=~~F,X=X===void 0?be:~~X,F<0?(F+=be,F<0&&(F=0)):F>be&&(F=be),X<0?(X+=be,X<0&&(X=0)):X>be&&(X=be),X<F&&(X=F);const ke=this.subarray(F,X);return Object.setPrototypeOf(ke,u.prototype),ke};function pe(we,F,X){if(we%1!==0||we<0)throw new RangeError("offset is not uint");if(we+F>X)throw new RangeError("Trying to access beyond buffer length")}u.prototype.readUintLE=u.prototype.readUIntLE=function(F,X,be){F=F>>>0,X=X>>>0,be||pe(F,X,this.length);let ke=this[F],ge=1,Ee=0;for(;++Ee<X&&(ge*=256);)ke+=this[F+Ee]*ge;return ke},u.prototype.readUintBE=u.prototype.readUIntBE=function(F,X,be){F=F>>>0,X=X>>>0,be||pe(F,X,this.length);let ke=this[F+--X],ge=1;for(;X>0&&(ge*=256);)ke+=this[F+--X]*ge;return ke},u.prototype.readUint8=u.prototype.readUInt8=function(F,X){return F=F>>>0,X||pe(F,1,this.length),this[F]},u.prototype.readUint16LE=u.prototype.readUInt16LE=function(F,X){return F=F>>>0,X||pe(F,2,this.length),this[F]|this[F+1]<<8},u.prototype.readUint16BE=u.prototype.readUInt16BE=function(F,X){return F=F>>>0,X||pe(F,2,this.length),this[F]<<8|this[F+1]},u.prototype.readUint32LE=u.prototype.readUInt32LE=function(F,X){return F=F>>>0,X||pe(F,4,this.length),(this[F]|this[F+1]<<8|this[F+2]<<16)+this[F+3]*16777216},u.prototype.readUint32BE=u.prototype.readUInt32BE=function(F,X){return F=F>>>0,X||pe(F,4,this.length),this[F]*16777216+(this[F+1]<<16|this[F+2]<<8|this[F+3])},u.prototype.readBigUInt64LE=Ft(function(F){F=F>>>0,Ne(F,"offset");const X=this[F],be=this[F+7];(X===void 0||be===void 0)&&ce(F,this.length-8);const ke=X+this[++F]*2**8+this[++F]*2**16+this[++F]*2**24,ge=this[++F]+this[++F]*2**8+this[++F]*2**16+be*2**24;return BigInt(ke)+(BigInt(ge)<<BigInt(32))}),u.prototype.readBigUInt64BE=Ft(function(F){F=F>>>0,Ne(F,"offset");const X=this[F],be=this[F+7];(X===void 0||be===void 0)&&ce(F,this.length-8);const ke=X*2**24+this[++F]*2**16+this[++F]*2**8+this[++F],ge=this[++F]*2**24+this[++F]*2**16+this[++F]*2**8+be;return(BigInt(ke)<<BigInt(32))+BigInt(ge)}),u.prototype.readIntLE=function(F,X,be){F=F>>>0,X=X>>>0,be||pe(F,X,this.length);let ke=this[F],ge=1,Ee=0;for(;++Ee<X&&(ge*=256);)ke+=this[F+Ee]*ge;return ge*=128,ke>=ge&&(ke-=Math.pow(2,8*X)),ke},u.prototype.readIntBE=function(F,X,be){F=F>>>0,X=X>>>0,be||pe(F,X,this.length);let ke=X,ge=1,Ee=this[F+--ke];for(;ke>0&&(ge*=256);)Ee+=this[F+--ke]*ge;return ge*=128,Ee>=ge&&(Ee-=Math.pow(2,8*X)),Ee},u.prototype.readInt8=function(F,X){return F=F>>>0,X||pe(F,1,this.length),this[F]&128?(255-this[F]+1)*-1:this[F]},u.prototype.readInt16LE=function(F,X){F=F>>>0,X||pe(F,2,this.length);const be=this[F]|this[F+1]<<8;return be&32768?be|4294901760:be},u.prototype.readInt16BE=function(F,X){F=F>>>0,X||pe(F,2,this.length);const be=this[F+1]|this[F]<<8;return be&32768?be|4294901760:be},u.prototype.readInt32LE=function(F,X){return F=F>>>0,X||pe(F,4,this.length),this[F]|this[F+1]<<8|this[F+2]<<16|this[F+3]<<24},u.prototype.readInt32BE=function(F,X){return F=F>>>0,X||pe(F,4,this.length),this[F]<<24|this[F+1]<<16|this[F+2]<<8|this[F+3]},u.prototype.readBigInt64LE=Ft(function(F){F=F>>>0,Ne(F,"offset");const X=this[F],be=this[F+7];(X===void 0||be===void 0)&&ce(F,this.length-8);const ke=this[F+4]+this[F+5]*2**8+this[F+6]*2**16+(be<<24);return(BigInt(ke)<<BigInt(32))+BigInt(X+this[++F]*2**8+this[++F]*2**16+this[++F]*2**24)}),u.prototype.readBigInt64BE=Ft(function(F){F=F>>>0,Ne(F,"offset");const X=this[F],be=this[F+7];(X===void 0||be===void 0)&&ce(F,this.length-8);const ke=(X<<24)+this[++F]*2**16+this[++F]*2**8+this[++F];return(BigInt(ke)<<BigInt(32))+BigInt(this[++F]*2**24+this[++F]*2**16+this[++F]*2**8+be)}),u.prototype.readFloatLE=function(F,X){return F=F>>>0,X||pe(F,4,this.length),n.read(this,F,!0,23,4)},u.prototype.readFloatBE=function(F,X){return F=F>>>0,X||pe(F,4,this.length),n.read(this,F,!1,23,4)},u.prototype.readDoubleLE=function(F,X){return F=F>>>0,X||pe(F,8,this.length),n.read(this,F,!0,52,8)},u.prototype.readDoubleBE=function(F,X){return F=F>>>0,X||pe(F,8,this.length),n.read(this,F,!1,52,8)};function ue(we,F,X,be,ke,ge){if(!u.isBuffer(we))throw new TypeError('"buffer" argument must be a Buffer instance');if(F>ke||F<ge)throw new RangeError('"value" argument is out of bounds');if(X+be>we.length)throw new RangeError("Index out of range")}u.prototype.writeUintLE=u.prototype.writeUIntLE=function(F,X,be,ke){if(F=+F,X=X>>>0,be=be>>>0,!ke){const le=Math.pow(2,8*be)-1;ue(this,F,X,be,le,0)}let ge=1,Ee=0;for(this[X]=F&255;++Ee<be&&(ge*=256);)this[X+Ee]=F/ge&255;return X+be},u.prototype.writeUintBE=u.prototype.writeUIntBE=function(F,X,be,ke){if(F=+F,X=X>>>0,be=be>>>0,!ke){const le=Math.pow(2,8*be)-1;ue(this,F,X,be,le,0)}let ge=be-1,Ee=1;for(this[X+ge]=F&255;--ge>=0&&(Ee*=256);)this[X+ge]=F/Ee&255;return X+be},u.prototype.writeUint8=u.prototype.writeUInt8=function(F,X,be){return F=+F,X=X>>>0,be||ue(this,F,X,1,255,0),this[X]=F&255,X+1},u.prototype.writeUint16LE=u.prototype.writeUInt16LE=function(F,X,be){return F=+F,X=X>>>0,be||ue(this,F,X,2,65535,0),this[X]=F&255,this[X+1]=F>>>8,X+2},u.prototype.writeUint16BE=u.prototype.writeUInt16BE=function(F,X,be){return F=+F,X=X>>>0,be||ue(this,F,X,2,65535,0),this[X]=F>>>8,this[X+1]=F&255,X+2},u.prototype.writeUint32LE=u.prototype.writeUInt32LE=function(F,X,be){return F=+F,X=X>>>0,be||ue(this,F,X,4,4294967295,0),this[X+3]=F>>>24,this[X+2]=F>>>16,this[X+1]=F>>>8,this[X]=F&255,X+4},u.prototype.writeUint32BE=u.prototype.writeUInt32BE=function(F,X,be){return F=+F,X=X>>>0,be||ue(this,F,X,4,4294967295,0),this[X]=F>>>24,this[X+1]=F>>>16,this[X+2]=F>>>8,this[X+3]=F&255,X+4};function Oe(we,F,X,be,ke){ye(F,be,ke,we,X,7);let ge=Number(F&BigInt(4294967295));we[X++]=ge,ge=ge>>8,we[X++]=ge,ge=ge>>8,we[X++]=ge,ge=ge>>8,we[X++]=ge;let Ee=Number(F>>BigInt(32)&BigInt(4294967295));return we[X++]=Ee,Ee=Ee>>8,we[X++]=Ee,Ee=Ee>>8,we[X++]=Ee,Ee=Ee>>8,we[X++]=Ee,X}function Fe(we,F,X,be,ke){ye(F,be,ke,we,X,7);let ge=Number(F&BigInt(4294967295));we[X+7]=ge,ge=ge>>8,we[X+6]=ge,ge=ge>>8,we[X+5]=ge,ge=ge>>8,we[X+4]=ge;let Ee=Number(F>>BigInt(32)&BigInt(4294967295));return we[X+3]=Ee,Ee=Ee>>8,we[X+2]=Ee,Ee=Ee>>8,we[X+1]=Ee,Ee=Ee>>8,we[X]=Ee,X+8}u.prototype.writeBigUInt64LE=Ft(function(F,X=0){return Oe(this,F,X,BigInt(0),BigInt("0xffffffffffffffff"))}),u.prototype.writeBigUInt64BE=Ft(function(F,X=0){return Fe(this,F,X,BigInt(0),BigInt("0xffffffffffffffff"))}),u.prototype.writeIntLE=function(F,X,be,ke){if(F=+F,X=X>>>0,!ke){const dt=Math.pow(2,8*be-1);ue(this,F,X,be,dt-1,-dt)}let ge=0,Ee=1,le=0;for(this[X]=F&255;++ge<be&&(Ee*=256);)F<0&&le===0&&this[X+ge-1]!==0&&(le=1),this[X+ge]=(F/Ee>>0)-le&255;return X+be},u.prototype.writeIntBE=function(F,X,be,ke){if(F=+F,X=X>>>0,!ke){const dt=Math.pow(2,8*be-1);ue(this,F,X,be,dt-1,-dt)}let ge=be-1,Ee=1,le=0;for(this[X+ge]=F&255;--ge>=0&&(Ee*=256);)F<0&&le===0&&this[X+ge+1]!==0&&(le=1),this[X+ge]=(F/Ee>>0)-le&255;return X+be},u.prototype.writeInt8=function(F,X,be){return F=+F,X=X>>>0,be||ue(this,F,X,1,127,-128),F<0&&(F=255+F+1),this[X]=F&255,X+1},u.prototype.writeInt16LE=function(F,X,be){return F=+F,X=X>>>0,be||ue(this,F,X,2,32767,-32768),this[X]=F&255,this[X+1]=F>>>8,X+2},u.prototype.writeInt16BE=function(F,X,be){return F=+F,X=X>>>0,be||ue(this,F,X,2,32767,-32768),this[X]=F>>>8,this[X+1]=F&255,X+2},u.prototype.writeInt32LE=function(F,X,be){return F=+F,X=X>>>0,be||ue(this,F,X,4,2147483647,-2147483648),this[X]=F&255,this[X+1]=F>>>8,this[X+2]=F>>>16,this[X+3]=F>>>24,X+4},u.prototype.writeInt32BE=function(F,X,be){return F=+F,X=X>>>0,be||ue(this,F,X,4,2147483647,-2147483648),F<0&&(F=4294967295+F+1),this[X]=F>>>24,this[X+1]=F>>>16,this[X+2]=F>>>8,this[X+3]=F&255,X+4},u.prototype.writeBigInt64LE=Ft(function(F,X=0){return Oe(this,F,X,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),u.prototype.writeBigInt64BE=Ft(function(F,X=0){return Fe(this,F,X,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function Se(we,F,X,be,ke,ge){if(X+be>we.length)throw new RangeError("Index out of range");if(X<0)throw new RangeError("Index out of range")}function Ce(we,F,X,be,ke){return F=+F,X=X>>>0,ke||Se(we,F,X,4),n.write(we,F,X,be,23,4),X+4}u.prototype.writeFloatLE=function(F,X,be){return Ce(this,F,X,!0,be)},u.prototype.writeFloatBE=function(F,X,be){return Ce(this,F,X,!1,be)};function qe(we,F,X,be,ke){return F=+F,X=X>>>0,ke||Se(we,F,X,8),n.write(we,F,X,be,52,8),X+8}u.prototype.writeDoubleLE=function(F,X,be){return qe(this,F,X,!0,be)},u.prototype.writeDoubleBE=function(F,X,be){return qe(this,F,X,!1,be)},u.prototype.copy=function(F,X,be,ke){if(!u.isBuffer(F))throw new TypeError("argument should be a Buffer");if(be||(be=0),!ke&&ke!==0&&(ke=this.length),X>=F.length&&(X=F.length),X||(X=0),ke>0&&ke<be&&(ke=be),ke===be||F.length===0||this.length===0)return 0;if(X<0)throw new RangeError("targetStart out of bounds");if(be<0||be>=this.length)throw new RangeError("Index out of range");if(ke<0)throw new RangeError("sourceEnd out of bounds");ke>this.length&&(ke=this.length),F.length-X<ke-be&&(ke=F.length-X+be);const ge=ke-be;return this===F&&typeof i.prototype.copyWithin=="function"?this.copyWithin(X,be,ke):i.prototype.set.call(F,this.subarray(be,ke),X),ge},u.prototype.fill=function(F,X,be,ke){if(typeof F=="string"){if(typeof X=="string"?(ke=X,X=0,be=this.length):typeof be=="string"&&(ke=be,be=this.length),ke!==void 0&&typeof ke!="string")throw new TypeError("encoding must be a string");if(typeof ke=="string"&&!u.isEncoding(ke))throw new TypeError("Unknown encoding: "+ke);if(F.length===1){const Ee=F.charCodeAt(0);(ke==="utf8"&&Ee<128||ke==="latin1")&&(F=Ee)}}else typeof F=="number"?F=F&255:typeof F=="boolean"&&(F=Number(F));if(X<0||this.length<X||this.length<be)throw new RangeError("Out of range index");if(be<=X)return this;X=X>>>0,be=be===void 0?this.length:be>>>0,F||(F=0);let ge;if(typeof F=="number")for(ge=X;ge<be;++ge)this[ge]=F;else{const Ee=u.isBuffer(F)?F:u.from(F,ke),le=Ee.length;if(le===0)throw new TypeError('The value "'+F+'" is invalid for argument "value"');for(ge=0;ge<be-X;++ge)this[ge+X]=Ee[ge%le]}return this};const Qe={};function We(we,F,X){Qe[we]=class extends X{constructor(){super(),Object.defineProperty(this,"message",{value:F.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${we}]`,this.stack,delete this.name}get code(){return we}set code(ke){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:ke,writable:!0})}toString(){return`${this.name} [${we}]: ${this.message}`}}}We("ERR_BUFFER_OUT_OF_BOUNDS",function(we){return we?`${we} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),We("ERR_INVALID_ARG_TYPE",function(we,F){return`The "${we}" argument must be of type number. Received type ${typeof F}`},TypeError),We("ERR_OUT_OF_RANGE",function(we,F,X){let be=`The value of "${we}" is out of range.`,ke=X;return Number.isInteger(X)&&Math.abs(X)>2**32?ke=Ie(String(X)):typeof X=="bigint"&&(ke=String(X),(X>BigInt(2)**BigInt(32)||X<-(BigInt(2)**BigInt(32)))&&(ke=Ie(ke)),ke+="n"),be+=` It must be ${F}. Received ${ke}`,be},RangeError);function Ie(we){let F="",X=we.length;const be=we[0]==="-"?1:0;for(;X>=be+4;X-=3)F=`_${we.slice(X-3,X)}${F}`;return`${we.slice(0,X)}${F}`}function K(we,F,X){Ne(F,"offset"),(we[F]===void 0||we[F+X]===void 0)&&ce(F,we.length-(X+1))}function ye(we,F,X,be,ke,ge){if(we>X||we<F){const Ee=typeof F=="bigint"?"n":"";let le;throw F===0||F===BigInt(0)?le=`>= 0${Ee} and < 2${Ee} ** ${(ge+1)*8}${Ee}`:le=`>= -(2${Ee} ** ${(ge+1)*8-1}${Ee}) and < 2 ** ${(ge+1)*8-1}${Ee}`,new Qe.ERR_OUT_OF_RANGE("value",le,we)}K(be,ke,ge)}function Ne(we,F){if(typeof we!="number")throw new Qe.ERR_INVALID_ARG_TYPE(F,"number",we)}function ce(we,F,X){throw Math.floor(we)!==we?(Ne(we,X),new Qe.ERR_OUT_OF_RANGE("offset","an integer",we)):F<0?new Qe.ERR_BUFFER_OUT_OF_BOUNDS:new Qe.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${F}`,we)}const oe=/[^+/0-9A-Za-z-_]/g;function re(we){if(we=we.split("=")[0],we=we.trim().replace(oe,""),we.length<2)return"";for(;we.length%4!==0;)we=we+"=";return we}function Re(we,F){F=F||1/0;let X;const be=we.length;let ke=null;const ge=[];for(let Ee=0;Ee<be;++Ee){if(X=we.charCodeAt(Ee),X>55295&&X<57344){if(!ke){if(X>56319){(F-=3)>-1&&ge.push(239,191,189);continue}else if(Ee+1===be){(F-=3)>-1&&ge.push(239,191,189);continue}ke=X;continue}if(X<56320){(F-=3)>-1&&ge.push(239,191,189),ke=X;continue}X=(ke-55296<<10|X-56320)+65536}else ke&&(F-=3)>-1&&ge.push(239,191,189);if(ke=null,X<128){if((F-=1)<0)break;ge.push(X)}else if(X<2048){if((F-=2)<0)break;ge.push(X>>6|192,X&63|128)}else if(X<65536){if((F-=3)<0)break;ge.push(X>>12|224,X>>6&63|128,X&63|128)}else if(X<1114112){if((F-=4)<0)break;ge.push(X>>18|240,X>>12&63|128,X>>6&63|128,X&63|128)}else throw new Error("Invalid code point")}return ge}function Be(we){const F=[];for(let X=0;X<we.length;++X)F.push(we.charCodeAt(X)&255);return F}function Te(we,F){let X,be,ke;const ge=[];for(let Ee=0;Ee<we.length&&!((F-=2)<0);++Ee)X=we.charCodeAt(Ee),be=X>>8,ke=X%256,ge.push(ke),ge.push(be);return ge}function lt(we){return t.toByteArray(re(we))}function Tt(we,F,X,be){let ke;for(ke=0;ke<be&&!(ke+X>=F.length||ke>=we.length);++ke)F[ke+X]=we[ke];return ke}function ut(we,F){return we instanceof F||we!=null&&we.constructor!=null&&we.constructor.name!=null&&we.constructor.name===F.name}function jt(we){return we!==we}const qt=function(){const we="0123456789abcdef",F=new Array(256);for(let X=0;X<16;++X){const be=X*16;for(let ke=0;ke<16;++ke)F[be+ke]=we[X]+we[ke]}return F}();function Ft(we){return typeof BigInt>"u"?Ht:we}function Ht(){throw new Error("BigInt not supported")}})(YO);const ln=YO.Buffer,Ds=YO.Buffer;var Pp={exports:{}},HB;function xye(){if(HB)return Pp.exports;HB=1;const e=typeof ln<"u",t=/"(?:_|\\u005[Ff])(?:_|\\u005[Ff])(?:p|\\u0070)(?:r|\\u0072)(?:o|\\u006[Ff])(?:t|\\u0074)(?:o|\\u006[Ff])(?:_|\\u005[Ff])(?:_|\\u005[Ff])"\s*:/,n=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/;function r(o,l,c){c==null&&l!==null&&typeof l=="object"&&(c=l,l=void 0),e&&ln.isBuffer(o)&&(o=o.toString()),o&&o.charCodeAt(0)===65279&&(o=o.slice(1));const u=JSON.parse(o,l);if(u===null||typeof u!="object")return u;const d=c&&c.protoAction||"error",h=c&&c.constructorAction||"error";if(d==="ignore"&&h==="ignore")return u;if(d!=="ignore"&&h!=="ignore"){if(t.test(o)===!1&&n.test(o)===!1)return u}else if(d!=="ignore"&&h==="ignore"){if(t.test(o)===!1)return u}else if(n.test(o)===!1)return u;return s(u,{protoAction:d,constructorAction:h,safe:c&&c.safe})}function s(o,{protoAction:l="error",constructorAction:c="error",safe:u}={}){let d=[o];for(;d.length;){const h=d;d=[];for(const m of h){if(l!=="ignore"&&Object.prototype.hasOwnProperty.call(m,"__proto__")){if(u===!0)return null;if(l==="error")throw new SyntaxError("Object contains forbidden prototype property");delete m.__proto__}if(c!=="ignore"&&Object.prototype.hasOwnProperty.call(m,"constructor")&&Object.prototype.hasOwnProperty.call(m.constructor,"prototype")){if(u===!0)return null;if(c==="error")throw new SyntaxError("Object contains forbidden prototype property");delete m.constructor}for(const y in m){const b=m[y];b&&typeof b=="object"&&d.push(b)}}}return o}function i(o,l,c){const u=Error.stackTraceLimit;Error.stackTraceLimit=0;try{return r(o,l,c)}finally{Error.stackTraceLimit=u}}function a(o,l){const c=Error.stackTraceLimit;Error.stackTraceLimit=0;try{return r(o,l,{safe:!0})}catch{return null}finally{Error.stackTraceLimit=c}}return Pp.exports=i,Pp.exports.default=i,Pp.exports.parse=i,Pp.exports.safeParse=a,Pp.exports.scan=s,Pp.exports}var wye=xye();const XO=ua(wye);var _ye={};function Vs(...e){return e.reduce((t,n)=>({...t,...n??{}}),{})}function Sye(e){return new ReadableStream({async pull(t){try{const{value:n,done:r}=await e.next();r?t.close():t.enqueue(n)}catch(n){t.error(n)}},cancel(){}})}async function Cye(e){return e==null?Promise.resolve():new Promise(t=>setTimeout(t,e))}function mG(){let e="",t,n=[],r,s;function i(l,c){if(l===""){a(c);return}if(l.startsWith(":"))return;const u=l.indexOf(":");if(u===-1){o(l,"");return}const d=l.slice(0,u),h=u+1,m=h<l.length&&l[h]===" "?l.slice(h+1):l.slice(h);o(d,m)}function a(l){n.length>0&&(l.enqueue({event:t,data:n.join(`
`),id:r,retry:s}),n=[],t=void 0,s=void 0)}function o(l,c){switch(l){case"event":t=c;break;case"data":n.push(c);break;case"id":r=c;break;case"retry":const u=parseInt(c,10);isNaN(u)||(s=u);break}}return new TransformStream({transform(l,c){const{lines:u,incompleteLine:d}=kye(e,l);e=d;for(let h=0;h<u.length;h++)i(u[h],c)},flush(l){i(e,l),a(l)}})}function kye(e,t){const n=[];let r=e;for(let s=0;s<t.length;){const i=t[s++];i===`
`?(n.push(r),r=""):i==="\r"?(n.push(r),r="",t[s]===`
`&&s++):r+=i}return{lines:n,incompleteLine:r}}function qy(e){const t={};return e.headers.forEach((n,r)=>{t[r]=n}),t}var zm=({prefix:e,size:t=16,alphabet:n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",separator:r="-"}={})=>{const s=dye(n,t);if(e==null)return s;if(n.includes(r))throw new HH({argument:"separator",message:`The separator "${r}" must not be part of the alphabet "${n}".`});return i=>`${e}${r}${s(i)}`},aa=zm();function Eye(e){return e==null?"unknown error":typeof e=="string"?e:e instanceof Error?e.message:JSON.stringify(e)}function Tye(e){return Object.fromEntries(Object.entries(e).filter(([t,n])=>n!=null))}function R2(e){return e instanceof Error&&(e.name==="AbortError"||e.name==="TimeoutError")}function JO({apiKey:e,environmentVariableName:t,apiKeyParameterName:n="apiKey",description:r}){if(typeof e=="string")return e;if(e!=null)throw new MS({message:`${r} API key must be a string.`});if(typeof Mi>"u")throw new MS({message:`${r} API key is missing. Pass it using the '${n}' parameter. Environment variables is not supported in this environment.`});if(e=_ye[t],e==null)throw new MS({message:`${r} API key is missing. Pass it using the '${n}' parameter or the ${t} environment variable.`});if(typeof e!="string")throw new MS({message:`${r} API key must be a string. The value of the ${t} environment variable is not a string.`});return e}var hC=Symbol.for("vercel.ai.validator");function Aye(e){return{[hC]:!0,validate:e}}function Rye(e){return typeof e=="object"&&e!==null&&hC in e&&e[hC]===!0&&"validate"in e}function Nye(e){return Rye(e)?e:Mye(e)}function Mye(e){return Aye(t=>{const n=e.safeParse(t);return n.success?{success:!0,value:n.data}:{success:!1,error:n.error}})}function Iye({value:e,schema:t}){const n=Vy({value:e,schema:t});if(!n.success)throw fC.wrap({value:e,cause:n.error});return n.value}function Vy({value:e,schema:t}){const n=Nye(t);try{if(n.validate==null)return{success:!0,value:e};const r=n.validate(e);return r.success?r:{success:!1,error:fC.wrap({value:e,cause:r.error})}}catch(r){return{success:!1,error:fC.wrap({value:e,cause:r})}}}function jye({text:e,schema:t}){try{const n=XO.parse(e);return t==null?n:Iye({value:n,schema:t})}catch(n){throw dC.isInstance(n)||fC.isInstance(n)?n:new dC({text:e,cause:n})}}function wm({text:e,schema:t}){try{const n=XO.parse(e);if(t==null)return{success:!0,value:n,rawValue:n};const r=Vy({value:n,schema:t});return r.success?{...r,rawValue:n}:r}catch(n){return{success:!1,error:dC.isInstance(n)?n:new dC({text:e,cause:n})}}}function fm(e){try{return XO.parse(e),!0}catch{return!1}}function kE({provider:e,providerOptions:t,schema:n}){if((t==null?void 0:t[e])==null)return;const r=Vy({value:t[e],schema:n});if(!r.success)throw new HH({argument:"providerOptions",message:`invalid ${e} provider options`,cause:r.error});return r.value}var Oye=()=>globalThis.fetch,Ws=async({url:e,headers:t,body:n,failedResponseHandler:r,successfulResponseHandler:s,abortSignal:i,fetch:a})=>gG({url:e,headers:{"Content-Type":"application/json",...t},body:{content:JSON.stringify(n),values:n},failedResponseHandler:r,successfulResponseHandler:s,abortSignal:i,fetch:a}),Pye=async({url:e,headers:t,formData:n,failedResponseHandler:r,successfulResponseHandler:s,abortSignal:i,fetch:a})=>gG({url:e,headers:t,body:{content:n,values:Object.fromEntries(n.entries())},failedResponseHandler:r,successfulResponseHandler:s,abortSignal:i,fetch:a}),gG=async({url:e,headers:t={},body:n,successfulResponseHandler:r,failedResponseHandler:s,abortSignal:i,fetch:a=Oye()})=>{try{const o=await a(e,{method:"POST",headers:Tye(t),body:n.content,signal:i}),l=qy(o);if(!o.ok){let c;try{c=await s({response:o,url:e,requestBodyValues:n.values})}catch(u){throw R2(u)||Vl.isInstance(u)?u:new Vl({message:"Failed to process error response",cause:u,statusCode:o.status,url:e,responseHeaders:l,requestBodyValues:n.values})}throw c.value}try{return await r({response:o,url:e,requestBodyValues:n.values})}catch(c){throw c instanceof Error&&(R2(c)||Vl.isInstance(c))?c:new Vl({message:"Failed to process successful response",cause:c,statusCode:o.status,url:e,responseHeaders:l,requestBodyValues:n.values})}}catch(o){if(R2(o))throw o;if(o instanceof TypeError&&o.message==="fetch failed"){const l=o.cause;if(l!=null)throw new Vl({message:`Cannot connect to API: ${l.message}`,cause:l,url:e,requestBodyValues:n.values,isRetryable:!0})}throw o}};async function lj(e){return typeof e=="function"&&(e=e()),Promise.resolve(e)}var $h=({errorSchema:e,errorToMessage:t,isRetryable:n})=>async({response:r,url:s,requestBodyValues:i})=>{const a=await r.text(),o=qy(r);if(a.trim()==="")return{responseHeaders:o,value:new Vl({message:r.statusText,url:s,requestBodyValues:i,statusCode:r.status,responseHeaders:o,responseBody:a,isRetryable:n==null?void 0:n(r)})};try{const l=jye({text:a,schema:e});return{responseHeaders:o,value:new Vl({message:t(l),url:s,requestBodyValues:i,statusCode:r.status,responseHeaders:o,responseBody:a,data:l,isRetryable:n==null?void 0:n(r,l)})}}catch{return{responseHeaders:o,value:new Vl({message:r.statusText,url:s,requestBodyValues:i,statusCode:r.status,responseHeaders:o,responseBody:a,isRetryable:n==null?void 0:n(r)})}}},zh=e=>async({response:t})=>{const n=qy(t);if(t.body==null)throw new UH({});return{responseHeaders:n,value:t.body.pipeThrough(new TextDecoderStream).pipeThrough(mG()).pipeThrough(new TransformStream({transform({data:r},s){r!=="[DONE]"&&s.enqueue(wm({text:r,schema:e}))}}))}},Ua=e=>async({response:t,url:n,requestBodyValues:r})=>{const s=await t.text(),i=wm({text:s,schema:e}),a=qy(t);if(!i.success)throw new Vl({message:"Invalid JSON response",cause:i.error,statusCode:t.status,responseHeaders:a,responseBody:s,url:n,requestBodyValues:r});return{responseHeaders:a,value:i.value,rawValue:i.rawValue}},Dye=()=>async({response:e,url:t,requestBodyValues:n})=>{const r=qy(e);if(!e.body)throw new Vl({message:"Response body is empty",url:t,requestBodyValues:n,statusCode:e.status,responseHeaders:r,responseBody:void 0});try{const s=await e.arrayBuffer();return{responseHeaders:r,value:new Uint8Array(s)}}catch(s){throw new Vl({message:"Failed to read response as array buffer",url:t,requestBodyValues:n,statusCode:e.status,responseHeaders:r,responseBody:void 0,cause:s})}},{btoa:Fye,atob:Lye}=globalThis;function EE(e){const t=e.replace(/-/g,"+").replace(/_/g,"/"),n=Lye(t);return Uint8Array.from(n,r=>r.codePointAt(0))}function Iu(e){let t="";for(let n=0;n<e.length;n++)t+=String.fromCodePoint(e[n]);return Fye(t)}function g1(e){return e==null?void 0:e.replace(/\/$/,"")}var Qr;(function(e){e.assertEqual=s=>{};function t(s){}e.assertIs=t;function n(s){throw new Error}e.assertNever=n,e.arrayToEnum=s=>{const i={};for(const a of s)i[a]=a;return i},e.getValidEnumValues=s=>{const i=e.objectKeys(s).filter(o=>typeof s[s[o]]!="number"),a={};for(const o of i)a[o]=s[o];return e.objectValues(a)},e.objectValues=s=>e.objectKeys(s).map(function(i){return s[i]}),e.objectKeys=typeof Object.keys=="function"?s=>Object.keys(s):s=>{const i=[];for(const a in s)Object.prototype.hasOwnProperty.call(s,a)&&i.push(a);return i},e.find=(s,i)=>{for(const a of s)if(i(a))return a},e.isInteger=typeof Number.isInteger=="function"?s=>Number.isInteger(s):s=>typeof s=="number"&&Number.isFinite(s)&&Math.floor(s)===s;function r(s,i=" | "){return s.map(a=>typeof a=="string"?`'${a}'`:a).join(i)}e.joinValues=r,e.jsonStringifyReplacer=(s,i)=>typeof i=="bigint"?i.toString():i})(Qr||(Qr={}));var GB;(function(e){e.mergeShapes=(t,n)=>({...t,...n})})(GB||(GB={}));const bn=Qr.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),ih=e=>{switch(typeof e){case"undefined":return bn.undefined;case"string":return bn.string;case"number":return Number.isNaN(e)?bn.nan:bn.number;case"boolean":return bn.boolean;case"function":return bn.function;case"bigint":return bn.bigint;case"symbol":return bn.symbol;case"object":return Array.isArray(e)?bn.array:e===null?bn.null:e.then&&typeof e.then=="function"&&e.catch&&typeof e.catch=="function"?bn.promise:typeof Map<"u"&&e instanceof Map?bn.map:typeof Set<"u"&&e instanceof Set?bn.set:typeof Date<"u"&&e instanceof Date?bn.date:bn.object;default:return bn.unknown}},Jt=Qr.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class Oc extends Error{get errors(){return this.issues}constructor(t){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=t}format(t){const n=t||function(i){return i.message},r={_errors:[]},s=i=>{for(const a of i.issues)if(a.code==="invalid_union")a.unionErrors.map(s);else if(a.code==="invalid_return_type")s(a.returnTypeError);else if(a.code==="invalid_arguments")s(a.argumentsError);else if(a.path.length===0)r._errors.push(n(a));else{let o=r,l=0;for(;l<a.path.length;){const c=a.path[l];l===a.path.length-1?(o[c]=o[c]||{_errors:[]},o[c]._errors.push(n(a))):o[c]=o[c]||{_errors:[]},o=o[c],l++}}};return s(this),r}static assert(t){if(!(t instanceof Oc))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Qr.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(t=n=>n.message){const n={},r=[];for(const s of this.issues)s.path.length>0?(n[s.path[0]]=n[s.path[0]]||[],n[s.path[0]].push(t(s))):r.push(t(s));return{formErrors:r,fieldErrors:n}}get formErrors(){return this.flatten()}}Oc.create=e=>new Oc(e);const cj=(e,t)=>{let n;switch(e.code){case Jt.invalid_type:e.received===bn.undefined?n="Required":n=`Expected ${e.expected}, received ${e.received}`;break;case Jt.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(e.expected,Qr.jsonStringifyReplacer)}`;break;case Jt.unrecognized_keys:n=`Unrecognized key(s) in object: ${Qr.joinValues(e.keys,", ")}`;break;case Jt.invalid_union:n="Invalid input";break;case Jt.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${Qr.joinValues(e.options)}`;break;case Jt.invalid_enum_value:n=`Invalid enum value. Expected ${Qr.joinValues(e.options)}, received '${e.received}'`;break;case Jt.invalid_arguments:n="Invalid function arguments";break;case Jt.invalid_return_type:n="Invalid function return type";break;case Jt.invalid_date:n="Invalid date";break;case Jt.invalid_string:typeof e.validation=="object"?"includes"in e.validation?(n=`Invalid input: must include "${e.validation.includes}"`,typeof e.validation.position=="number"&&(n=`${n} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?n=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?n=`Invalid input: must end with "${e.validation.endsWith}"`:Qr.assertNever(e.validation):e.validation!=="regex"?n=`Invalid ${e.validation}`:n="Invalid";break;case Jt.too_small:e.type==="array"?n=`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:e.type==="string"?n=`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:e.type==="number"?n=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="date"?n=`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:n="Invalid input";break;case Jt.too_big:e.type==="array"?n=`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:e.type==="string"?n=`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:e.type==="number"?n=`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="bigint"?n=`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="date"?n=`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:n="Invalid input";break;case Jt.custom:n="Invalid input";break;case Jt.invalid_intersection_types:n="Intersection results could not be merged";break;case Jt.not_multiple_of:n=`Number must be a multiple of ${e.multipleOf}`;break;case Jt.not_finite:n="Number must be finite";break;default:n=t.defaultError,Qr.assertNever(e)}return{message:n}};let Bye=cj;function $ye(){return Bye}const zye=e=>{const{data:t,path:n,errorMaps:r,issueData:s}=e,i=[...n,...s.path||[]],a={...s,path:i};if(s.message!==void 0)return{...s,path:i,message:s.message};let o="";const l=r.filter(c=>!!c).slice().reverse();for(const c of l)o=c(a,{data:t,defaultError:o}).message;return{...s,path:i,message:o}};function fn(e,t){const n=$ye(),r=zye({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,n,n===cj?void 0:cj].filter(s=>!!s)});e.common.issues.push(r)}class oo{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(t,n){const r=[];for(const s of n){if(s.status==="aborted")return dr;s.status==="dirty"&&t.dirty(),r.push(s.value)}return{status:t.value,value:r}}static async mergeObjectAsync(t,n){const r=[];for(const s of n){const i=await s.key,a=await s.value;r.push({key:i,value:a})}return oo.mergeObjectSync(t,r)}static mergeObjectSync(t,n){const r={};for(const s of n){const{key:i,value:a}=s;if(i.status==="aborted"||a.status==="aborted")return dr;i.status==="dirty"&&t.dirty(),a.status==="dirty"&&t.dirty(),i.value!=="__proto__"&&(typeof a.value<"u"||s.alwaysSet)&&(r[i.value]=a.value)}return{status:t.value,value:r}}}const dr=Object.freeze({status:"aborted"}),sx=e=>({status:"dirty",value:e}),Ql=e=>({status:"valid",value:e}),KB=e=>e.status==="aborted",YB=e=>e.status==="dirty",ny=e=>e.status==="valid",pC=e=>typeof Promise<"u"&&e instanceof Promise;var An;(function(e){e.errToObj=t=>typeof t=="string"?{message:t}:t||{},e.toString=t=>typeof t=="string"?t:t==null?void 0:t.message})(An||(An={}));class ju{constructor(t,n,r,s){this._cachedPath=[],this.parent=t,this.data=n,this._path=r,this._key=s}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const ZB=(e,t)=>{if(ny(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const n=new Oc(e.common.issues);return this._error=n,this._error}}};function Rr(e){if(!e)return{};const{errorMap:t,invalid_type_error:n,required_error:r,description:s}=e;if(t&&(n||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return t?{errorMap:t,description:s}:{errorMap:(a,o)=>{const{message:l}=e;return a.code==="invalid_enum_value"?{message:l??o.defaultError}:typeof o.data>"u"?{message:l??r??o.defaultError}:a.code!=="invalid_type"?{message:o.defaultError}:{message:l??n??o.defaultError}},description:s}}class Ur{get description(){return this._def.description}_getType(t){return ih(t.data)}_getOrReturnCtx(t,n){return n||{common:t.parent.common,data:t.data,parsedType:ih(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}_processInputParams(t){return{status:new oo,ctx:{common:t.parent.common,data:t.data,parsedType:ih(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}}_parseSync(t){const n=this._parse(t);if(pC(n))throw new Error("Synchronous parse encountered promise.");return n}_parseAsync(t){const n=this._parse(t);return Promise.resolve(n)}parse(t,n){const r=this.safeParse(t,n);if(r.success)return r.data;throw r.error}safeParse(t,n){const r={common:{issues:[],async:(n==null?void 0:n.async)??!1,contextualErrorMap:n==null?void 0:n.errorMap},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:ih(t)},s=this._parseSync({data:t,path:r.path,parent:r});return ZB(r,s)}"~validate"(t){var r,s;const n={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:ih(t)};if(!this["~standard"].async)try{const i=this._parseSync({data:t,path:[],parent:n});return ny(i)?{value:i.value}:{issues:n.common.issues}}catch(i){(s=(r=i==null?void 0:i.message)==null?void 0:r.toLowerCase())!=null&&s.includes("encountered")&&(this["~standard"].async=!0),n.common={issues:[],async:!0}}return this._parseAsync({data:t,path:[],parent:n}).then(i=>ny(i)?{value:i.value}:{issues:n.common.issues})}async parseAsync(t,n){const r=await this.safeParseAsync(t,n);if(r.success)return r.data;throw r.error}async safeParseAsync(t,n){const r={common:{issues:[],contextualErrorMap:n==null?void 0:n.errorMap,async:!0},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:ih(t)},s=this._parse({data:t,path:r.path,parent:r}),i=await(pC(s)?s:Promise.resolve(s));return ZB(r,i)}refine(t,n){const r=s=>typeof n=="string"||typeof n>"u"?{message:n}:typeof n=="function"?n(s):n;return this._refinement((s,i)=>{const a=t(s),o=()=>i.addIssue({code:Jt.custom,...r(s)});return typeof Promise<"u"&&a instanceof Promise?a.then(l=>l?!0:(o(),!1)):a?!0:(o(),!1)})}refinement(t,n){return this._refinement((r,s)=>t(r)?!0:(s.addIssue(typeof n=="function"?n(r,s):n),!1))}_refinement(t){return new Cm({schema:this,typeName:tn.ZodEffects,effect:{type:"refinement",refinement:t}})}superRefine(t){return this._refinement(t)}constructor(t){this.spa=this.safeParseAsync,this._def=t,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:n=>this["~validate"](n)}}optional(){return ku.create(this,this._def)}nullable(){return km.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Cu.create(this)}promise(){return wC.create(this,this._def)}or(t){return gC.create([this,t],this._def)}and(t){return yC.create(this,t,this._def)}transform(t){return new Cm({...Rr(this._def),schema:this,typeName:tn.ZodEffects,effect:{type:"transform",transform:t}})}default(t){const n=typeof t=="function"?t:()=>t;return new _C({...Rr(this._def),innerType:this,defaultValue:n,typeName:tn.ZodDefault})}brand(){return new xG({typeName:tn.ZodBranded,type:this,...Rr(this._def)})}catch(t){const n=typeof t=="function"?t:()=>t;return new SC({...Rr(this._def),innerType:this,catchValue:n,typeName:tn.ZodCatch})}describe(t){const n=this.constructor;return new n({...this._def,description:t})}pipe(t){return eP.create(this,t)}readonly(){return CC.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const Uye=/^c[^\s-]{8,}$/i,qye=/^[0-9a-z]+$/,Vye=/^[0-9A-HJKMNP-TV-Z]{26}$/i,Wye=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,Hye=/^[a-z0-9_-]{21}$/i,Gye=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,Kye=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,Yye=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,Zye="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let _N;const Xye=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Jye=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,Qye=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,ebe=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,tbe=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,nbe=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,yG="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",rbe=new RegExp(`^${yG}$`);function bG(e){let t="[0-5]\\d";e.precision?t=`${t}\\.\\d{${e.precision}}`:e.precision==null&&(t=`${t}(\\.\\d+)?`);const n=e.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${t})${n}`}function sbe(e){return new RegExp(`^${bG(e)}$`)}function ibe(e){let t=`${yG}T${bG(e)}`;const n=[];return n.push(e.local?"Z?":"Z"),e.offset&&n.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${n.join("|")})`,new RegExp(`^${t}$`)}function abe(e,t){return!!((t==="v4"||!t)&&Xye.test(e)||(t==="v6"||!t)&&Qye.test(e))}function obe(e,t){if(!Gye.test(e))return!1;try{const[n]=e.split("."),r=n.replace(/-/g,"+").replace(/_/g,"/").padEnd(n.length+(4-n.length%4)%4,"="),s=JSON.parse(atob(r));return!(typeof s!="object"||s===null||"typ"in s&&(s==null?void 0:s.typ)!=="JWT"||!s.alg||t&&s.alg!==t)}catch{return!1}}function lbe(e,t){return!!((t==="v4"||!t)&&Jye.test(e)||(t==="v6"||!t)&&ebe.test(e))}class Nd extends Ur{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==bn.string){const i=this._getOrReturnCtx(t);return fn(i,{code:Jt.invalid_type,expected:bn.string,received:i.parsedType}),dr}const r=new oo;let s;for(const i of this._def.checks)if(i.kind==="min")t.data.length<i.value&&(s=this._getOrReturnCtx(t,s),fn(s,{code:Jt.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="max")t.data.length>i.value&&(s=this._getOrReturnCtx(t,s),fn(s,{code:Jt.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="length"){const a=t.data.length>i.value,o=t.data.length<i.value;(a||o)&&(s=this._getOrReturnCtx(t,s),a?fn(s,{code:Jt.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):o&&fn(s,{code:Jt.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),r.dirty())}else if(i.kind==="email")Yye.test(t.data)||(s=this._getOrReturnCtx(t,s),fn(s,{validation:"email",code:Jt.invalid_string,message:i.message}),r.dirty());else if(i.kind==="emoji")_N||(_N=new RegExp(Zye,"u")),_N.test(t.data)||(s=this._getOrReturnCtx(t,s),fn(s,{validation:"emoji",code:Jt.invalid_string,message:i.message}),r.dirty());else if(i.kind==="uuid")Wye.test(t.data)||(s=this._getOrReturnCtx(t,s),fn(s,{validation:"uuid",code:Jt.invalid_string,message:i.message}),r.dirty());else if(i.kind==="nanoid")Hye.test(t.data)||(s=this._getOrReturnCtx(t,s),fn(s,{validation:"nanoid",code:Jt.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid")Uye.test(t.data)||(s=this._getOrReturnCtx(t,s),fn(s,{validation:"cuid",code:Jt.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid2")qye.test(t.data)||(s=this._getOrReturnCtx(t,s),fn(s,{validation:"cuid2",code:Jt.invalid_string,message:i.message}),r.dirty());else if(i.kind==="ulid")Vye.test(t.data)||(s=this._getOrReturnCtx(t,s),fn(s,{validation:"ulid",code:Jt.invalid_string,message:i.message}),r.dirty());else if(i.kind==="url")try{new URL(t.data)}catch{s=this._getOrReturnCtx(t,s),fn(s,{validation:"url",code:Jt.invalid_string,message:i.message}),r.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(t.data)||(s=this._getOrReturnCtx(t,s),fn(s,{validation:"regex",code:Jt.invalid_string,message:i.message}),r.dirty())):i.kind==="trim"?t.data=t.data.trim():i.kind==="includes"?t.data.includes(i.value,i.position)||(s=this._getOrReturnCtx(t,s),fn(s,{code:Jt.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),r.dirty()):i.kind==="toLowerCase"?t.data=t.data.toLowerCase():i.kind==="toUpperCase"?t.data=t.data.toUpperCase():i.kind==="startsWith"?t.data.startsWith(i.value)||(s=this._getOrReturnCtx(t,s),fn(s,{code:Jt.invalid_string,validation:{startsWith:i.value},message:i.message}),r.dirty()):i.kind==="endsWith"?t.data.endsWith(i.value)||(s=this._getOrReturnCtx(t,s),fn(s,{code:Jt.invalid_string,validation:{endsWith:i.value},message:i.message}),r.dirty()):i.kind==="datetime"?ibe(i).test(t.data)||(s=this._getOrReturnCtx(t,s),fn(s,{code:Jt.invalid_string,validation:"datetime",message:i.message}),r.dirty()):i.kind==="date"?rbe.test(t.data)||(s=this._getOrReturnCtx(t,s),fn(s,{code:Jt.invalid_string,validation:"date",message:i.message}),r.dirty()):i.kind==="time"?sbe(i).test(t.data)||(s=this._getOrReturnCtx(t,s),fn(s,{code:Jt.invalid_string,validation:"time",message:i.message}),r.dirty()):i.kind==="duration"?Kye.test(t.data)||(s=this._getOrReturnCtx(t,s),fn(s,{validation:"duration",code:Jt.invalid_string,message:i.message}),r.dirty()):i.kind==="ip"?abe(t.data,i.version)||(s=this._getOrReturnCtx(t,s),fn(s,{validation:"ip",code:Jt.invalid_string,message:i.message}),r.dirty()):i.kind==="jwt"?obe(t.data,i.alg)||(s=this._getOrReturnCtx(t,s),fn(s,{validation:"jwt",code:Jt.invalid_string,message:i.message}),r.dirty()):i.kind==="cidr"?lbe(t.data,i.version)||(s=this._getOrReturnCtx(t,s),fn(s,{validation:"cidr",code:Jt.invalid_string,message:i.message}),r.dirty()):i.kind==="base64"?tbe.test(t.data)||(s=this._getOrReturnCtx(t,s),fn(s,{validation:"base64",code:Jt.invalid_string,message:i.message}),r.dirty()):i.kind==="base64url"?nbe.test(t.data)||(s=this._getOrReturnCtx(t,s),fn(s,{validation:"base64url",code:Jt.invalid_string,message:i.message}),r.dirty()):Qr.assertNever(i);return{status:r.value,value:t.data}}_regex(t,n,r){return this.refinement(s=>t.test(s),{validation:n,code:Jt.invalid_string,...An.errToObj(r)})}_addCheck(t){return new Nd({...this._def,checks:[...this._def.checks,t]})}email(t){return this._addCheck({kind:"email",...An.errToObj(t)})}url(t){return this._addCheck({kind:"url",...An.errToObj(t)})}emoji(t){return this._addCheck({kind:"emoji",...An.errToObj(t)})}uuid(t){return this._addCheck({kind:"uuid",...An.errToObj(t)})}nanoid(t){return this._addCheck({kind:"nanoid",...An.errToObj(t)})}cuid(t){return this._addCheck({kind:"cuid",...An.errToObj(t)})}cuid2(t){return this._addCheck({kind:"cuid2",...An.errToObj(t)})}ulid(t){return this._addCheck({kind:"ulid",...An.errToObj(t)})}base64(t){return this._addCheck({kind:"base64",...An.errToObj(t)})}base64url(t){return this._addCheck({kind:"base64url",...An.errToObj(t)})}jwt(t){return this._addCheck({kind:"jwt",...An.errToObj(t)})}ip(t){return this._addCheck({kind:"ip",...An.errToObj(t)})}cidr(t){return this._addCheck({kind:"cidr",...An.errToObj(t)})}datetime(t){return typeof t=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:t}):this._addCheck({kind:"datetime",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,offset:(t==null?void 0:t.offset)??!1,local:(t==null?void 0:t.local)??!1,...An.errToObj(t==null?void 0:t.message)})}date(t){return this._addCheck({kind:"date",message:t})}time(t){return typeof t=="string"?this._addCheck({kind:"time",precision:null,message:t}):this._addCheck({kind:"time",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,...An.errToObj(t==null?void 0:t.message)})}duration(t){return this._addCheck({kind:"duration",...An.errToObj(t)})}regex(t,n){return this._addCheck({kind:"regex",regex:t,...An.errToObj(n)})}includes(t,n){return this._addCheck({kind:"includes",value:t,position:n==null?void 0:n.position,...An.errToObj(n==null?void 0:n.message)})}startsWith(t,n){return this._addCheck({kind:"startsWith",value:t,...An.errToObj(n)})}endsWith(t,n){return this._addCheck({kind:"endsWith",value:t,...An.errToObj(n)})}min(t,n){return this._addCheck({kind:"min",value:t,...An.errToObj(n)})}max(t,n){return this._addCheck({kind:"max",value:t,...An.errToObj(n)})}length(t,n){return this._addCheck({kind:"length",value:t,...An.errToObj(n)})}nonempty(t){return this.min(1,An.errToObj(t))}trim(){return new Nd({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Nd({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Nd({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(t=>t.kind==="datetime")}get isDate(){return!!this._def.checks.find(t=>t.kind==="date")}get isTime(){return!!this._def.checks.find(t=>t.kind==="time")}get isDuration(){return!!this._def.checks.find(t=>t.kind==="duration")}get isEmail(){return!!this._def.checks.find(t=>t.kind==="email")}get isURL(){return!!this._def.checks.find(t=>t.kind==="url")}get isEmoji(){return!!this._def.checks.find(t=>t.kind==="emoji")}get isUUID(){return!!this._def.checks.find(t=>t.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(t=>t.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(t=>t.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(t=>t.kind==="cuid2")}get isULID(){return!!this._def.checks.find(t=>t.kind==="ulid")}get isIP(){return!!this._def.checks.find(t=>t.kind==="ip")}get isCIDR(){return!!this._def.checks.find(t=>t.kind==="cidr")}get isBase64(){return!!this._def.checks.find(t=>t.kind==="base64")}get isBase64url(){return!!this._def.checks.find(t=>t.kind==="base64url")}get minLength(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxLength(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}}Nd.create=e=>new Nd({checks:[],typeName:tn.ZodString,coerce:(e==null?void 0:e.coerce)??!1,...Rr(e)});function cbe(e,t){const n=(e.toString().split(".")[1]||"").length,r=(t.toString().split(".")[1]||"").length,s=n>r?n:r,i=Number.parseInt(e.toFixed(s).replace(".","")),a=Number.parseInt(t.toFixed(s).replace(".",""));return i%a/10**s}class ry extends Ur{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==bn.number){const i=this._getOrReturnCtx(t);return fn(i,{code:Jt.invalid_type,expected:bn.number,received:i.parsedType}),dr}let r;const s=new oo;for(const i of this._def.checks)i.kind==="int"?Qr.isInteger(t.data)||(r=this._getOrReturnCtx(t,r),fn(r,{code:Jt.invalid_type,expected:"integer",received:"float",message:i.message}),s.dirty()):i.kind==="min"?(i.inclusive?t.data<i.value:t.data<=i.value)&&(r=this._getOrReturnCtx(t,r),fn(r,{code:Jt.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?t.data>i.value:t.data>=i.value)&&(r=this._getOrReturnCtx(t,r),fn(r,{code:Jt.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="multipleOf"?cbe(t.data,i.value)!==0&&(r=this._getOrReturnCtx(t,r),fn(r,{code:Jt.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):i.kind==="finite"?Number.isFinite(t.data)||(r=this._getOrReturnCtx(t,r),fn(r,{code:Jt.not_finite,message:i.message}),s.dirty()):Qr.assertNever(i);return{status:s.value,value:t.data}}gte(t,n){return this.setLimit("min",t,!0,An.toString(n))}gt(t,n){return this.setLimit("min",t,!1,An.toString(n))}lte(t,n){return this.setLimit("max",t,!0,An.toString(n))}lt(t,n){return this.setLimit("max",t,!1,An.toString(n))}setLimit(t,n,r,s){return new ry({...this._def,checks:[...this._def.checks,{kind:t,value:n,inclusive:r,message:An.toString(s)}]})}_addCheck(t){return new ry({...this._def,checks:[...this._def.checks,t]})}int(t){return this._addCheck({kind:"int",message:An.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:!1,message:An.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:!1,message:An.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:!0,message:An.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:!0,message:An.toString(t)})}multipleOf(t,n){return this._addCheck({kind:"multipleOf",value:t,message:An.toString(n)})}finite(t){return this._addCheck({kind:"finite",message:An.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:An.toString(t)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:An.toString(t)})}get minValue(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxValue(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}get isInt(){return!!this._def.checks.find(t=>t.kind==="int"||t.kind==="multipleOf"&&Qr.isInteger(t.value))}get isFinite(){let t=null,n=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(n===null||r.value>n)&&(n=r.value):r.kind==="max"&&(t===null||r.value<t)&&(t=r.value)}return Number.isFinite(n)&&Number.isFinite(t)}}ry.create=e=>new ry({checks:[],typeName:tn.ZodNumber,coerce:(e==null?void 0:e.coerce)||!1,...Rr(e)});class Qx extends Ur{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(t){if(this._def.coerce)try{t.data=BigInt(t.data)}catch{return this._getInvalidInput(t)}if(this._getType(t)!==bn.bigint)return this._getInvalidInput(t);let r;const s=new oo;for(const i of this._def.checks)i.kind==="min"?(i.inclusive?t.data<i.value:t.data<=i.value)&&(r=this._getOrReturnCtx(t,r),fn(r,{code:Jt.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?t.data>i.value:t.data>=i.value)&&(r=this._getOrReturnCtx(t,r),fn(r,{code:Jt.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="multipleOf"?t.data%i.value!==BigInt(0)&&(r=this._getOrReturnCtx(t,r),fn(r,{code:Jt.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):Qr.assertNever(i);return{status:s.value,value:t.data}}_getInvalidInput(t){const n=this._getOrReturnCtx(t);return fn(n,{code:Jt.invalid_type,expected:bn.bigint,received:n.parsedType}),dr}gte(t,n){return this.setLimit("min",t,!0,An.toString(n))}gt(t,n){return this.setLimit("min",t,!1,An.toString(n))}lte(t,n){return this.setLimit("max",t,!0,An.toString(n))}lt(t,n){return this.setLimit("max",t,!1,An.toString(n))}setLimit(t,n,r,s){return new Qx({...this._def,checks:[...this._def.checks,{kind:t,value:n,inclusive:r,message:An.toString(s)}]})}_addCheck(t){return new Qx({...this._def,checks:[...this._def.checks,t]})}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:An.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:An.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:An.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:An.toString(t)})}multipleOf(t,n){return this._addCheck({kind:"multipleOf",value:t,message:An.toString(n)})}get minValue(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxValue(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}}Qx.create=e=>new Qx({checks:[],typeName:tn.ZodBigInt,coerce:(e==null?void 0:e.coerce)??!1,...Rr(e)});class uj extends Ur{_parse(t){if(this._def.coerce&&(t.data=!!t.data),this._getType(t)!==bn.boolean){const r=this._getOrReturnCtx(t);return fn(r,{code:Jt.invalid_type,expected:bn.boolean,received:r.parsedType}),dr}return Ql(t.data)}}uj.create=e=>new uj({typeName:tn.ZodBoolean,coerce:(e==null?void 0:e.coerce)||!1,...Rr(e)});class ew extends Ur{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==bn.date){const i=this._getOrReturnCtx(t);return fn(i,{code:Jt.invalid_type,expected:bn.date,received:i.parsedType}),dr}if(Number.isNaN(t.data.getTime())){const i=this._getOrReturnCtx(t);return fn(i,{code:Jt.invalid_date}),dr}const r=new oo;let s;for(const i of this._def.checks)i.kind==="min"?t.data.getTime()<i.value&&(s=this._getOrReturnCtx(t,s),fn(s,{code:Jt.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),r.dirty()):i.kind==="max"?t.data.getTime()>i.value&&(s=this._getOrReturnCtx(t,s),fn(s,{code:Jt.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),r.dirty()):Qr.assertNever(i);return{status:r.value,value:new Date(t.data.getTime())}}_addCheck(t){return new ew({...this._def,checks:[...this._def.checks,t]})}min(t,n){return this._addCheck({kind:"min",value:t.getTime(),message:An.toString(n)})}max(t,n){return this._addCheck({kind:"max",value:t.getTime(),message:An.toString(n)})}get minDate(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t!=null?new Date(t):null}get maxDate(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t!=null?new Date(t):null}}ew.create=e=>new ew({checks:[],coerce:(e==null?void 0:e.coerce)||!1,typeName:tn.ZodDate,...Rr(e)});class XB extends Ur{_parse(t){if(this._getType(t)!==bn.symbol){const r=this._getOrReturnCtx(t);return fn(r,{code:Jt.invalid_type,expected:bn.symbol,received:r.parsedType}),dr}return Ql(t.data)}}XB.create=e=>new XB({typeName:tn.ZodSymbol,...Rr(e)});class dj extends Ur{_parse(t){if(this._getType(t)!==bn.undefined){const r=this._getOrReturnCtx(t);return fn(r,{code:Jt.invalid_type,expected:bn.undefined,received:r.parsedType}),dr}return Ql(t.data)}}dj.create=e=>new dj({typeName:tn.ZodUndefined,...Rr(e)});class mC extends Ur{_parse(t){if(this._getType(t)!==bn.null){const r=this._getOrReturnCtx(t);return fn(r,{code:Jt.invalid_type,expected:bn.null,received:r.parsedType}),dr}return Ql(t.data)}}mC.create=e=>new mC({typeName:tn.ZodNull,...Rr(e)});class tw extends Ur{constructor(){super(...arguments),this._any=!0}_parse(t){return Ql(t.data)}}tw.create=e=>new tw({typeName:tn.ZodAny,...Rr(e)});class fj extends Ur{constructor(){super(...arguments),this._unknown=!0}_parse(t){return Ql(t.data)}}fj.create=e=>new fj({typeName:tn.ZodUnknown,...Rr(e)});class vh extends Ur{_parse(t){const n=this._getOrReturnCtx(t);return fn(n,{code:Jt.invalid_type,expected:bn.never,received:n.parsedType}),dr}}vh.create=e=>new vh({typeName:tn.ZodNever,...Rr(e)});class JB extends Ur{_parse(t){if(this._getType(t)!==bn.undefined){const r=this._getOrReturnCtx(t);return fn(r,{code:Jt.invalid_type,expected:bn.void,received:r.parsedType}),dr}return Ql(t.data)}}JB.create=e=>new JB({typeName:tn.ZodVoid,...Rr(e)});class Cu extends Ur{_parse(t){const{ctx:n,status:r}=this._processInputParams(t),s=this._def;if(n.parsedType!==bn.array)return fn(n,{code:Jt.invalid_type,expected:bn.array,received:n.parsedType}),dr;if(s.exactLength!==null){const a=n.data.length>s.exactLength.value,o=n.data.length<s.exactLength.value;(a||o)&&(fn(n,{code:a?Jt.too_big:Jt.too_small,minimum:o?s.exactLength.value:void 0,maximum:a?s.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:s.exactLength.message}),r.dirty())}if(s.minLength!==null&&n.data.length<s.minLength.value&&(fn(n,{code:Jt.too_small,minimum:s.minLength.value,type:"array",inclusive:!0,exact:!1,message:s.minLength.message}),r.dirty()),s.maxLength!==null&&n.data.length>s.maxLength.value&&(fn(n,{code:Jt.too_big,maximum:s.maxLength.value,type:"array",inclusive:!0,exact:!1,message:s.maxLength.message}),r.dirty()),n.common.async)return Promise.all([...n.data].map((a,o)=>s.type._parseAsync(new ju(n,a,n.path,o)))).then(a=>oo.mergeArray(r,a));const i=[...n.data].map((a,o)=>s.type._parseSync(new ju(n,a,n.path,o)));return oo.mergeArray(r,i)}get element(){return this._def.type}min(t,n){return new Cu({...this._def,minLength:{value:t,message:An.toString(n)}})}max(t,n){return new Cu({...this._def,maxLength:{value:t,message:An.toString(n)}})}length(t,n){return new Cu({...this._def,exactLength:{value:t,message:An.toString(n)}})}nonempty(t){return this.min(1,t)}}Cu.create=(e,t)=>new Cu({type:e,minLength:null,maxLength:null,exactLength:null,typeName:tn.ZodArray,...Rr(t)});function d0(e){if(e instanceof Ri){const t={};for(const n in e.shape){const r=e.shape[n];t[n]=ku.create(d0(r))}return new Ri({...e._def,shape:()=>t})}else return e instanceof Cu?new Cu({...e._def,type:d0(e.element)}):e instanceof ku?ku.create(d0(e.unwrap())):e instanceof km?km.create(d0(e.unwrap())):e instanceof _m?_m.create(e.items.map(t=>d0(t))):e}class Ri extends Ur{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const t=this._def.shape(),n=Qr.objectKeys(t);return this._cached={shape:t,keys:n},this._cached}_parse(t){if(this._getType(t)!==bn.object){const c=this._getOrReturnCtx(t);return fn(c,{code:Jt.invalid_type,expected:bn.object,received:c.parsedType}),dr}const{status:r,ctx:s}=this._processInputParams(t),{shape:i,keys:a}=this._getCached(),o=[];if(!(this._def.catchall instanceof vh&&this._def.unknownKeys==="strip"))for(const c in s.data)a.includes(c)||o.push(c);const l=[];for(const c of a){const u=i[c],d=s.data[c];l.push({key:{status:"valid",value:c},value:u._parse(new ju(s,d,s.path,c)),alwaysSet:c in s.data})}if(this._def.catchall instanceof vh){const c=this._def.unknownKeys;if(c==="passthrough")for(const u of o)l.push({key:{status:"valid",value:u},value:{status:"valid",value:s.data[u]}});else if(c==="strict")o.length>0&&(fn(s,{code:Jt.unrecognized_keys,keys:o}),r.dirty());else if(c!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const c=this._def.catchall;for(const u of o){const d=s.data[u];l.push({key:{status:"valid",value:u},value:c._parse(new ju(s,d,s.path,u)),alwaysSet:u in s.data})}}return s.common.async?Promise.resolve().then(async()=>{const c=[];for(const u of l){const d=await u.key,h=await u.value;c.push({key:d,value:h,alwaysSet:u.alwaysSet})}return c}).then(c=>oo.mergeObjectSync(r,c)):oo.mergeObjectSync(r,l)}get shape(){return this._def.shape()}strict(t){return An.errToObj,new Ri({...this._def,unknownKeys:"strict",...t!==void 0?{errorMap:(n,r)=>{var i,a;const s=((a=(i=this._def).errorMap)==null?void 0:a.call(i,n,r).message)??r.defaultError;return n.code==="unrecognized_keys"?{message:An.errToObj(t).message??s}:{message:s}}}:{}})}strip(){return new Ri({...this._def,unknownKeys:"strip"})}passthrough(){return new Ri({...this._def,unknownKeys:"passthrough"})}extend(t){return new Ri({...this._def,shape:()=>({...this._def.shape(),...t})})}merge(t){return new Ri({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>({...this._def.shape(),...t._def.shape()}),typeName:tn.ZodObject})}setKey(t,n){return this.augment({[t]:n})}catchall(t){return new Ri({...this._def,catchall:t})}pick(t){const n={};for(const r of Qr.objectKeys(t))t[r]&&this.shape[r]&&(n[r]=this.shape[r]);return new Ri({...this._def,shape:()=>n})}omit(t){const n={};for(const r of Qr.objectKeys(this.shape))t[r]||(n[r]=this.shape[r]);return new Ri({...this._def,shape:()=>n})}deepPartial(){return d0(this)}partial(t){const n={};for(const r of Qr.objectKeys(this.shape)){const s=this.shape[r];t&&!t[r]?n[r]=s:n[r]=s.optional()}return new Ri({...this._def,shape:()=>n})}required(t){const n={};for(const r of Qr.objectKeys(this.shape))if(t&&!t[r])n[r]=this.shape[r];else{let i=this.shape[r];for(;i instanceof ku;)i=i._def.innerType;n[r]=i}return new Ri({...this._def,shape:()=>n})}keyof(){return vG(Qr.objectKeys(this.shape))}}Ri.create=(e,t)=>new Ri({shape:()=>e,unknownKeys:"strip",catchall:vh.create(),typeName:tn.ZodObject,...Rr(t)});Ri.strictCreate=(e,t)=>new Ri({shape:()=>e,unknownKeys:"strict",catchall:vh.create(),typeName:tn.ZodObject,...Rr(t)});Ri.lazycreate=(e,t)=>new Ri({shape:e,unknownKeys:"strip",catchall:vh.create(),typeName:tn.ZodObject,...Rr(t)});class gC extends Ur{_parse(t){const{ctx:n}=this._processInputParams(t),r=this._def.options;function s(i){for(const o of i)if(o.result.status==="valid")return o.result;for(const o of i)if(o.result.status==="dirty")return n.common.issues.push(...o.ctx.common.issues),o.result;const a=i.map(o=>new Oc(o.ctx.common.issues));return fn(n,{code:Jt.invalid_union,unionErrors:a}),dr}if(n.common.async)return Promise.all(r.map(async i=>{const a={...n,common:{...n.common,issues:[]},parent:null};return{result:await i._parseAsync({data:n.data,path:n.path,parent:a}),ctx:a}})).then(s);{let i;const a=[];for(const l of r){const c={...n,common:{...n.common,issues:[]},parent:null},u=l._parseSync({data:n.data,path:n.path,parent:c});if(u.status==="valid")return u;u.status==="dirty"&&!i&&(i={result:u,ctx:c}),c.common.issues.length&&a.push(c.common.issues)}if(i)return n.common.issues.push(...i.ctx.common.issues),i.result;const o=a.map(l=>new Oc(l));return fn(n,{code:Jt.invalid_union,unionErrors:o}),dr}}get options(){return this._def.options}}gC.create=(e,t)=>new gC({options:e,typeName:tn.ZodUnion,...Rr(t)});const _d=e=>e instanceof vC?_d(e.schema):e instanceof Cm?_d(e.innerType()):e instanceof xC?[e.value]:e instanceof Sm?e.options:e instanceof pj?Qr.objectValues(e.enum):e instanceof _C?_d(e._def.innerType):e instanceof dj?[void 0]:e instanceof mC?[null]:e instanceof ku?[void 0,..._d(e.unwrap())]:e instanceof km?[null,..._d(e.unwrap())]:e instanceof xG||e instanceof CC?_d(e.unwrap()):e instanceof SC?_d(e._def.innerType):[];class QO extends Ur{_parse(t){const{ctx:n}=this._processInputParams(t);if(n.parsedType!==bn.object)return fn(n,{code:Jt.invalid_type,expected:bn.object,received:n.parsedType}),dr;const r=this.discriminator,s=n.data[r],i=this.optionsMap.get(s);return i?n.common.async?i._parseAsync({data:n.data,path:n.path,parent:n}):i._parseSync({data:n.data,path:n.path,parent:n}):(fn(n,{code:Jt.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),dr)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(t,n,r){const s=new Map;for(const i of n){const a=_d(i.shape[t]);if(!a.length)throw new Error(`A discriminator value for key \`${t}\` could not be extracted from all schema options`);for(const o of a){if(s.has(o))throw new Error(`Discriminator property ${String(t)} has duplicate value ${String(o)}`);s.set(o,i)}}return new QO({typeName:tn.ZodDiscriminatedUnion,discriminator:t,options:n,optionsMap:s,...Rr(r)})}}function hj(e,t){const n=ih(e),r=ih(t);if(e===t)return{valid:!0,data:e};if(n===bn.object&&r===bn.object){const s=Qr.objectKeys(t),i=Qr.objectKeys(e).filter(o=>s.indexOf(o)!==-1),a={...e,...t};for(const o of i){const l=hj(e[o],t[o]);if(!l.valid)return{valid:!1};a[o]=l.data}return{valid:!0,data:a}}else if(n===bn.array&&r===bn.array){if(e.length!==t.length)return{valid:!1};const s=[];for(let i=0;i<e.length;i++){const a=e[i],o=t[i],l=hj(a,o);if(!l.valid)return{valid:!1};s.push(l.data)}return{valid:!0,data:s}}else return n===bn.date&&r===bn.date&&+e==+t?{valid:!0,data:e}:{valid:!1}}class yC extends Ur{_parse(t){const{status:n,ctx:r}=this._processInputParams(t),s=(i,a)=>{if(KB(i)||KB(a))return dr;const o=hj(i.value,a.value);return o.valid?((YB(i)||YB(a))&&n.dirty(),{status:n.value,value:o.data}):(fn(r,{code:Jt.invalid_intersection_types}),dr)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([i,a])=>s(i,a)):s(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}yC.create=(e,t,n)=>new yC({left:e,right:t,typeName:tn.ZodIntersection,...Rr(n)});class _m extends Ur{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==bn.array)return fn(r,{code:Jt.invalid_type,expected:bn.array,received:r.parsedType}),dr;if(r.data.length<this._def.items.length)return fn(r,{code:Jt.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),dr;!this._def.rest&&r.data.length>this._def.items.length&&(fn(r,{code:Jt.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),n.dirty());const i=[...r.data].map((a,o)=>{const l=this._def.items[o]||this._def.rest;return l?l._parse(new ju(r,a,r.path,o)):null}).filter(a=>!!a);return r.common.async?Promise.all(i).then(a=>oo.mergeArray(n,a)):oo.mergeArray(n,i)}get items(){return this._def.items}rest(t){return new _m({...this._def,rest:t})}}_m.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new _m({items:e,typeName:tn.ZodTuple,rest:null,...Rr(t)})};class bC extends Ur{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==bn.object)return fn(r,{code:Jt.invalid_type,expected:bn.object,received:r.parsedType}),dr;const s=[],i=this._def.keyType,a=this._def.valueType;for(const o in r.data)s.push({key:i._parse(new ju(r,o,r.path,o)),value:a._parse(new ju(r,r.data[o],r.path,o)),alwaysSet:o in r.data});return r.common.async?oo.mergeObjectAsync(n,s):oo.mergeObjectSync(n,s)}get element(){return this._def.valueType}static create(t,n,r){return n instanceof Ur?new bC({keyType:t,valueType:n,typeName:tn.ZodRecord,...Rr(r)}):new bC({keyType:Nd.create(),valueType:t,typeName:tn.ZodRecord,...Rr(n)})}}class QB extends Ur{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==bn.map)return fn(r,{code:Jt.invalid_type,expected:bn.map,received:r.parsedType}),dr;const s=this._def.keyType,i=this._def.valueType,a=[...r.data.entries()].map(([o,l],c)=>({key:s._parse(new ju(r,o,r.path,[c,"key"])),value:i._parse(new ju(r,l,r.path,[c,"value"]))}));if(r.common.async){const o=new Map;return Promise.resolve().then(async()=>{for(const l of a){const c=await l.key,u=await l.value;if(c.status==="aborted"||u.status==="aborted")return dr;(c.status==="dirty"||u.status==="dirty")&&n.dirty(),o.set(c.value,u.value)}return{status:n.value,value:o}})}else{const o=new Map;for(const l of a){const c=l.key,u=l.value;if(c.status==="aborted"||u.status==="aborted")return dr;(c.status==="dirty"||u.status==="dirty")&&n.dirty(),o.set(c.value,u.value)}return{status:n.value,value:o}}}}QB.create=(e,t,n)=>new QB({valueType:t,keyType:e,typeName:tn.ZodMap,...Rr(n)});class nw extends Ur{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==bn.set)return fn(r,{code:Jt.invalid_type,expected:bn.set,received:r.parsedType}),dr;const s=this._def;s.minSize!==null&&r.data.size<s.minSize.value&&(fn(r,{code:Jt.too_small,minimum:s.minSize.value,type:"set",inclusive:!0,exact:!1,message:s.minSize.message}),n.dirty()),s.maxSize!==null&&r.data.size>s.maxSize.value&&(fn(r,{code:Jt.too_big,maximum:s.maxSize.value,type:"set",inclusive:!0,exact:!1,message:s.maxSize.message}),n.dirty());const i=this._def.valueType;function a(l){const c=new Set;for(const u of l){if(u.status==="aborted")return dr;u.status==="dirty"&&n.dirty(),c.add(u.value)}return{status:n.value,value:c}}const o=[...r.data.values()].map((l,c)=>i._parse(new ju(r,l,r.path,c)));return r.common.async?Promise.all(o).then(l=>a(l)):a(o)}min(t,n){return new nw({...this._def,minSize:{value:t,message:An.toString(n)}})}max(t,n){return new nw({...this._def,maxSize:{value:t,message:An.toString(n)}})}size(t,n){return this.min(t,n).max(t,n)}nonempty(t){return this.min(1,t)}}nw.create=(e,t)=>new nw({valueType:e,minSize:null,maxSize:null,typeName:tn.ZodSet,...Rr(t)});class vC extends Ur{get schema(){return this._def.getter()}_parse(t){const{ctx:n}=this._processInputParams(t);return this._def.getter()._parse({data:n.data,path:n.path,parent:n})}}vC.create=(e,t)=>new vC({getter:e,typeName:tn.ZodLazy,...Rr(t)});class xC extends Ur{_parse(t){if(t.data!==this._def.value){const n=this._getOrReturnCtx(t);return fn(n,{received:n.data,code:Jt.invalid_literal,expected:this._def.value}),dr}return{status:"valid",value:t.data}}get value(){return this._def.value}}xC.create=(e,t)=>new xC({value:e,typeName:tn.ZodLiteral,...Rr(t)});function vG(e,t){return new Sm({values:e,typeName:tn.ZodEnum,...Rr(t)})}class Sm extends Ur{_parse(t){if(typeof t.data!="string"){const n=this._getOrReturnCtx(t),r=this._def.values;return fn(n,{expected:Qr.joinValues(r),received:n.parsedType,code:Jt.invalid_type}),dr}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(t.data)){const n=this._getOrReturnCtx(t),r=this._def.values;return fn(n,{received:n.data,code:Jt.invalid_enum_value,options:r}),dr}return Ql(t.data)}get options(){return this._def.values}get enum(){const t={};for(const n of this._def.values)t[n]=n;return t}get Values(){const t={};for(const n of this._def.values)t[n]=n;return t}get Enum(){const t={};for(const n of this._def.values)t[n]=n;return t}extract(t,n=this._def){return Sm.create(t,{...this._def,...n})}exclude(t,n=this._def){return Sm.create(this.options.filter(r=>!t.includes(r)),{...this._def,...n})}}Sm.create=vG;class pj extends Ur{_parse(t){const n=Qr.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(t);if(r.parsedType!==bn.string&&r.parsedType!==bn.number){const s=Qr.objectValues(n);return fn(r,{expected:Qr.joinValues(s),received:r.parsedType,code:Jt.invalid_type}),dr}if(this._cache||(this._cache=new Set(Qr.getValidEnumValues(this._def.values))),!this._cache.has(t.data)){const s=Qr.objectValues(n);return fn(r,{received:r.data,code:Jt.invalid_enum_value,options:s}),dr}return Ql(t.data)}get enum(){return this._def.values}}pj.create=(e,t)=>new pj({values:e,typeName:tn.ZodNativeEnum,...Rr(t)});class wC extends Ur{unwrap(){return this._def.type}_parse(t){const{ctx:n}=this._processInputParams(t);if(n.parsedType!==bn.promise&&n.common.async===!1)return fn(n,{code:Jt.invalid_type,expected:bn.promise,received:n.parsedType}),dr;const r=n.parsedType===bn.promise?n.data:Promise.resolve(n.data);return Ql(r.then(s=>this._def.type.parseAsync(s,{path:n.path,errorMap:n.common.contextualErrorMap})))}}wC.create=(e,t)=>new wC({type:e,typeName:tn.ZodPromise,...Rr(t)});class Cm extends Ur{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===tn.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(t){const{status:n,ctx:r}=this._processInputParams(t),s=this._def.effect||null,i={addIssue:a=>{fn(r,a),a.fatal?n.abort():n.dirty()},get path(){return r.path}};if(i.addIssue=i.addIssue.bind(i),s.type==="preprocess"){const a=s.transform(r.data,i);if(r.common.async)return Promise.resolve(a).then(async o=>{if(n.value==="aborted")return dr;const l=await this._def.schema._parseAsync({data:o,path:r.path,parent:r});return l.status==="aborted"?dr:l.status==="dirty"||n.value==="dirty"?sx(l.value):l});{if(n.value==="aborted")return dr;const o=this._def.schema._parseSync({data:a,path:r.path,parent:r});return o.status==="aborted"?dr:o.status==="dirty"||n.value==="dirty"?sx(o.value):o}}if(s.type==="refinement"){const a=o=>{const l=s.refinement(o,i);if(r.common.async)return Promise.resolve(l);if(l instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return o};if(r.common.async===!1){const o=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return o.status==="aborted"?dr:(o.status==="dirty"&&n.dirty(),a(o.value),{status:n.value,value:o.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(o=>o.status==="aborted"?dr:(o.status==="dirty"&&n.dirty(),a(o.value).then(()=>({status:n.value,value:o.value}))))}if(s.type==="transform")if(r.common.async===!1){const a=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!ny(a))return dr;const o=s.transform(a.value,i);if(o instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:n.value,value:o}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(a=>ny(a)?Promise.resolve(s.transform(a.value,i)).then(o=>({status:n.value,value:o})):dr);Qr.assertNever(s)}}Cm.create=(e,t,n)=>new Cm({schema:e,typeName:tn.ZodEffects,effect:t,...Rr(n)});Cm.createWithPreprocess=(e,t,n)=>new Cm({schema:t,effect:{type:"preprocess",transform:e},typeName:tn.ZodEffects,...Rr(n)});class ku extends Ur{_parse(t){return this._getType(t)===bn.undefined?Ql(void 0):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}ku.create=(e,t)=>new ku({innerType:e,typeName:tn.ZodOptional,...Rr(t)});class km extends Ur{_parse(t){return this._getType(t)===bn.null?Ql(null):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}km.create=(e,t)=>new km({innerType:e,typeName:tn.ZodNullable,...Rr(t)});class _C extends Ur{_parse(t){const{ctx:n}=this._processInputParams(t);let r=n.data;return n.parsedType===bn.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:n.path,parent:n})}removeDefault(){return this._def.innerType}}_C.create=(e,t)=>new _C({innerType:e,typeName:tn.ZodDefault,defaultValue:typeof t.default=="function"?t.default:()=>t.default,...Rr(t)});class SC extends Ur{_parse(t){const{ctx:n}=this._processInputParams(t),r={...n,common:{...n.common,issues:[]}},s=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return pC(s)?s.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new Oc(r.common.issues)},input:r.data})})):{status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new Oc(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}SC.create=(e,t)=>new SC({innerType:e,typeName:tn.ZodCatch,catchValue:typeof t.catch=="function"?t.catch:()=>t.catch,...Rr(t)});class e$ extends Ur{_parse(t){if(this._getType(t)!==bn.nan){const r=this._getOrReturnCtx(t);return fn(r,{code:Jt.invalid_type,expected:bn.nan,received:r.parsedType}),dr}return{status:"valid",value:t.data}}}e$.create=e=>new e$({typeName:tn.ZodNaN,...Rr(e)});class xG extends Ur{_parse(t){const{ctx:n}=this._processInputParams(t),r=n.data;return this._def.type._parse({data:r,path:n.path,parent:n})}unwrap(){return this._def.type}}class eP extends Ur{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.common.async)return(async()=>{const i=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return i.status==="aborted"?dr:i.status==="dirty"?(n.dirty(),sx(i.value)):this._def.out._parseAsync({data:i.value,path:r.path,parent:r})})();{const s=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return s.status==="aborted"?dr:s.status==="dirty"?(n.dirty(),{status:"dirty",value:s.value}):this._def.out._parseSync({data:s.value,path:r.path,parent:r})}}static create(t,n){return new eP({in:t,out:n,typeName:tn.ZodPipeline})}}class CC extends Ur{_parse(t){const n=this._def.innerType._parse(t),r=s=>(ny(s)&&(s.value=Object.freeze(s.value)),s);return pC(n)?n.then(s=>r(s)):r(n)}unwrap(){return this._def.innerType}}CC.create=(e,t)=>new CC({innerType:e,typeName:tn.ZodReadonly,...Rr(t)});function t$(e,t){const n=typeof e=="function"?e(t):typeof e=="string"?{message:e}:e;return typeof n=="string"?{message:n}:n}function wG(e,t={},n){return e?tw.create().superRefine((r,s)=>{const i=e(r);if(i instanceof Promise)return i.then(a=>{if(!a){const o=t$(t,r),l=o.fatal??n??!0;s.addIssue({code:"custom",...o,fatal:l})}});if(!i){const a=t$(t,r),o=a.fatal??n??!0;s.addIssue({code:"custom",...a,fatal:o})}}):tw.create()}var tn;(function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"})(tn||(tn={}));const kC=(e,t={message:`Input not instance of ${e.name}`})=>wG(n=>n instanceof e,t),ze=Nd.create,At=ry.create,Kn=uj.create,ube=ew.create,dbe=mC.create,Hd=tw.create,Wy=fj.create;vh.create;const on=Cu.create,Ke=Ri.create,ms=gC.create,TE=QO.create;yC.create;_m.create;const xh=bC.create,fbe=vC.create,Nn=xC.create,xl=Sm.create;wC.create;const sa=ku.create;km.create;function hbe({prompt:e,useLegacyFunctionCalling:t=!1,systemMessageMode:n="system"}){const r=[],s=[];for(const{role:i,content:a}of e)switch(i){case"system":{switch(n){case"system":{r.push({role:"system",content:a});break}case"developer":{r.push({role:"developer",content:a});break}case"remove":{s.push({type:"other",message:"system messages are removed for this model"});break}default:{const o=n;throw new Error(`Unsupported system message mode: ${o}`)}}break}case"user":{if(a.length===1&&a[0].type==="text"){r.push({role:"user",content:a[0].text});break}r.push({role:"user",content:a.map((o,l)=>{var c,u,d,h;switch(o.type){case"text":return{type:"text",text:o.text};case"image":return{type:"image_url",image_url:{url:o.image instanceof URL?o.image.toString():`data:${(c=o.mimeType)!=null?c:"image/jpeg"};base64,${Iu(o.image)}`,detail:(d=(u=o.providerMetadata)==null?void 0:u.openai)==null?void 0:d.imageDetail}};case"file":{if(o.data instanceof URL)throw new pr({functionality:"'File content parts with URL data' functionality not supported."});switch(o.mimeType){case"audio/wav":return{type:"input_audio",input_audio:{data:o.data,format:"wav"}};case"audio/mp3":case"audio/mpeg":return{type:"input_audio",input_audio:{data:o.data,format:"mp3"}};case"application/pdf":return{type:"file",file:{filename:(h=o.filename)!=null?h:`part-${l}.pdf`,file_data:`data:application/pdf;base64,${o.data}`}};default:throw new pr({functionality:`File content part type ${o.mimeType} in user messages`})}}}})});break}case"assistant":{let o="";const l=[];for(const c of a)switch(c.type){case"text":{o+=c.text;break}case"tool-call":{l.push({id:c.toolCallId,type:"function",function:{name:c.toolName,arguments:JSON.stringify(c.args)}});break}}if(t){if(l.length>1)throw new pr({functionality:"useLegacyFunctionCalling with multiple tool calls in one message"});r.push({role:"assistant",content:o,function_call:l.length>0?l[0].function:void 0})}else r.push({role:"assistant",content:o,tool_calls:l.length>0?l:void 0});break}case"tool":{for(const o of a)t?r.push({role:"function",name:o.toolName,content:JSON.stringify(o.result)}):r.push({role:"tool",tool_call_id:o.toolCallId,content:JSON.stringify(o.result)});break}default:{const o=i;throw new Error(`Unsupported role: ${o}`)}}return{messages:r,warnings:s}}function n$(e){var t,n;return(n=(t=e==null?void 0:e.content)==null?void 0:t.map(({token:r,logprob:s,top_logprobs:i})=>({token:r,logprob:s,topLogprobs:i?i.map(({token:a,logprob:o})=>({token:a,logprob:o})):[]})))!=null?n:void 0}function EC(e){switch(e){case"stop":return"stop";case"length":return"length";case"content_filter":return"content-filter";case"function_call":case"tool_calls":return"tool-calls";default:return"unknown"}}var tP=Ke({error:Ke({message:ze(),type:ze().nullish(),param:Hd().nullish(),code:ms([ze(),At()]).nullish()})}),Ou=$h({errorSchema:tP,errorToMessage:e=>e.error.message});function TC({id:e,model:t,created:n}){return{id:e??void 0,modelId:t??void 0,timestamp:n!=null?new Date(n*1e3):void 0}}function pbe({mode:e,useLegacyFunctionCalling:t=!1,structuredOutputs:n}){var r;const s=(r=e.tools)!=null&&r.length?e.tools:void 0,i=[];if(s==null)return{tools:void 0,tool_choice:void 0,toolWarnings:i};const a=e.toolChoice;if(t){const c=[];for(const d of s)d.type==="provider-defined"?i.push({type:"unsupported-tool",tool:d}):c.push({name:d.name,description:d.description,parameters:d.parameters});if(a==null)return{functions:c,function_call:void 0,toolWarnings:i};switch(a.type){case"auto":case"none":case void 0:return{functions:c,function_call:void 0,toolWarnings:i};case"required":throw new pr({functionality:"useLegacyFunctionCalling and toolChoice: required"});default:return{functions:c,function_call:{name:a.toolName},toolWarnings:i}}}const o=[];for(const c of s)c.type==="provider-defined"?i.push({type:"unsupported-tool",tool:c}):o.push({type:"function",function:{name:c.name,description:c.description,parameters:c.parameters,strict:n?!0:void 0}});if(a==null)return{tools:o,tool_choice:void 0,toolWarnings:i};const l=a.type;switch(l){case"auto":case"none":case"required":return{tools:o,tool_choice:l,toolWarnings:i};case"tool":return{tools:o,tool_choice:{type:"function",function:{name:a.toolName}},toolWarnings:i};default:{const c=l;throw new pr({functionality:`Unsupported tool choice type: ${c}`})}}}var mbe=class{constructor(e,t,n){this.specificationVersion="v1",this.modelId=e,this.settings=t,this.config=n}get supportsStructuredOutputs(){var e;return(e=this.settings.structuredOutputs)!=null?e:mj(this.modelId)}get defaultObjectGenerationMode(){return bbe(this.modelId)?"tool":this.supportsStructuredOutputs?"json":"tool"}get provider(){return this.config.provider}get supportsImageUrls(){return!this.settings.downloadImages}getArgs({mode:e,prompt:t,maxTokens:n,temperature:r,topP:s,topK:i,frequencyPenalty:a,presencePenalty:o,stopSequences:l,responseFormat:c,seed:u,providerMetadata:d}){var h,m,y,b,v,x,w,S;const k=e.type,C=[];i!=null&&C.push({type:"unsupported-setting",setting:"topK"}),(c==null?void 0:c.type)==="json"&&c.schema!=null&&!this.supportsStructuredOutputs&&C.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format schema is only supported with structuredOutputs"});const T=this.settings.useLegacyFunctionCalling;if(T&&this.settings.parallelToolCalls===!0)throw new pr({functionality:"useLegacyFunctionCalling with parallelToolCalls"});if(T&&this.supportsStructuredOutputs)throw new pr({functionality:"structuredOutputs with useLegacyFunctionCalling"});const{messages:R,warnings:N}=hbe({prompt:t,useLegacyFunctionCalling:T,systemMessageMode:vbe(this.modelId)});C.push(...N);const I={model:this.modelId,logit_bias:this.settings.logitBias,logprobs:this.settings.logprobs===!0||typeof this.settings.logprobs=="number"?!0:void 0,top_logprobs:typeof this.settings.logprobs=="number"?this.settings.logprobs:typeof this.settings.logprobs=="boolean"&&this.settings.logprobs?0:void 0,user:this.settings.user,parallel_tool_calls:this.settings.parallelToolCalls,max_tokens:n,temperature:r,top_p:s,frequency_penalty:a,presence_penalty:o,response_format:(c==null?void 0:c.type)==="json"?this.supportsStructuredOutputs&&c.schema!=null?{type:"json_schema",json_schema:{schema:c.schema,strict:!0,name:(h=c.name)!=null?h:"response",description:c.description}}:{type:"json_object"}:void 0,stop:l,seed:u,max_completion_tokens:(m=d==null?void 0:d.openai)==null?void 0:m.maxCompletionTokens,store:(y=d==null?void 0:d.openai)==null?void 0:y.store,metadata:(b=d==null?void 0:d.openai)==null?void 0:b.metadata,prediction:(v=d==null?void 0:d.openai)==null?void 0:v.prediction,reasoning_effort:(w=(x=d==null?void 0:d.openai)==null?void 0:x.reasoningEffort)!=null?w:this.settings.reasoningEffort,messages:R};switch(mj(this.modelId)?(I.temperature!=null&&(I.temperature=void 0,C.push({type:"unsupported-setting",setting:"temperature",details:"temperature is not supported for reasoning models"})),I.top_p!=null&&(I.top_p=void 0,C.push({type:"unsupported-setting",setting:"topP",details:"topP is not supported for reasoning models"})),I.frequency_penalty!=null&&(I.frequency_penalty=void 0,C.push({type:"unsupported-setting",setting:"frequencyPenalty",details:"frequencyPenalty is not supported for reasoning models"})),I.presence_penalty!=null&&(I.presence_penalty=void 0,C.push({type:"unsupported-setting",setting:"presencePenalty",details:"presencePenalty is not supported for reasoning models"})),I.logit_bias!=null&&(I.logit_bias=void 0,C.push({type:"other",message:"logitBias is not supported for reasoning models"})),I.logprobs!=null&&(I.logprobs=void 0,C.push({type:"other",message:"logprobs is not supported for reasoning models"})),I.top_logprobs!=null&&(I.top_logprobs=void 0,C.push({type:"other",message:"topLogprobs is not supported for reasoning models"})),I.max_tokens!=null&&(I.max_completion_tokens==null&&(I.max_completion_tokens=I.max_tokens),I.max_tokens=void 0)):(this.modelId.startsWith("gpt-4o-search-preview")||this.modelId.startsWith("gpt-4o-mini-search-preview"))&&I.temperature!=null&&(I.temperature=void 0,C.push({type:"unsupported-setting",setting:"temperature",details:"temperature is not supported for the search preview models and has been removed."})),k){case"regular":{const{tools:P,tool_choice:B,functions:D,function_call:W,toolWarnings:O}=pbe({mode:e,useLegacyFunctionCalling:T,structuredOutputs:this.supportsStructuredOutputs});return{args:{...I,tools:P,tool_choice:B,functions:D,function_call:W},warnings:[...C,...O]}}case"object-json":return{args:{...I,response_format:this.supportsStructuredOutputs&&e.schema!=null?{type:"json_schema",json_schema:{schema:e.schema,strict:!0,name:(S=e.name)!=null?S:"response",description:e.description}}:{type:"json_object"}},warnings:C};case"object-tool":return{args:T?{...I,function_call:{name:e.tool.name},functions:[{name:e.tool.name,description:e.tool.description,parameters:e.tool.parameters}]}:{...I,tool_choice:{type:"function",function:{name:e.tool.name}},tools:[{type:"function",function:{name:e.tool.name,description:e.tool.description,parameters:e.tool.parameters,strict:this.supportsStructuredOutputs?!0:void 0}}]},warnings:C};default:{const P=k;throw new Error(`Unsupported type: ${P}`)}}}async doGenerate(e){var t,n,r,s,i,a,o,l;const{args:c,warnings:u}=this.getArgs(e),{responseHeaders:d,value:h,rawValue:m}=await Ws({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:Vs(this.config.headers(),e.headers),body:c,failedResponseHandler:Ou,successfulResponseHandler:Ua(gbe),abortSignal:e.abortSignal,fetch:this.config.fetch}),{messages:y,...b}=c,v=h.choices[0],x=(t=h.usage)==null?void 0:t.completion_tokens_details,w=(n=h.usage)==null?void 0:n.prompt_tokens_details,S={openai:{}};return(x==null?void 0:x.reasoning_tokens)!=null&&(S.openai.reasoningTokens=x==null?void 0:x.reasoning_tokens),(x==null?void 0:x.accepted_prediction_tokens)!=null&&(S.openai.acceptedPredictionTokens=x==null?void 0:x.accepted_prediction_tokens),(x==null?void 0:x.rejected_prediction_tokens)!=null&&(S.openai.rejectedPredictionTokens=x==null?void 0:x.rejected_prediction_tokens),(w==null?void 0:w.cached_tokens)!=null&&(S.openai.cachedPromptTokens=w==null?void 0:w.cached_tokens),{text:(r=v.message.content)!=null?r:void 0,toolCalls:this.settings.useLegacyFunctionCalling&&v.message.function_call?[{toolCallType:"function",toolCallId:aa(),toolName:v.message.function_call.name,args:v.message.function_call.arguments}]:(s=v.message.tool_calls)==null?void 0:s.map(k=>{var C;return{toolCallType:"function",toolCallId:(C=k.id)!=null?C:aa(),toolName:k.function.name,args:k.function.arguments}}),finishReason:EC(v.finish_reason),usage:{promptTokens:(a=(i=h.usage)==null?void 0:i.prompt_tokens)!=null?a:NaN,completionTokens:(l=(o=h.usage)==null?void 0:o.completion_tokens)!=null?l:NaN},rawCall:{rawPrompt:y,rawSettings:b},rawResponse:{headers:d,body:m},request:{body:JSON.stringify(c)},response:TC(h),warnings:u,logprobs:n$(v.logprobs),providerMetadata:S}}async doStream(e){if(this.settings.simulateStreaming){const b=await this.doGenerate(e);return{stream:new ReadableStream({start(x){if(x.enqueue({type:"response-metadata",...b.response}),b.text&&x.enqueue({type:"text-delta",textDelta:b.text}),b.toolCalls)for(const w of b.toolCalls)x.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:w.toolCallId,toolName:w.toolName,argsTextDelta:w.args}),x.enqueue({type:"tool-call",...w});x.enqueue({type:"finish",finishReason:b.finishReason,usage:b.usage,logprobs:b.logprobs,providerMetadata:b.providerMetadata}),x.close()}}),rawCall:b.rawCall,rawResponse:b.rawResponse,warnings:b.warnings}}const{args:t,warnings:n}=this.getArgs(e),r={...t,stream:!0,stream_options:this.config.compatibility==="strict"?{include_usage:!0}:void 0},{responseHeaders:s,value:i}=await Ws({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:Vs(this.config.headers(),e.headers),body:r,failedResponseHandler:Ou,successfulResponseHandler:zh(ybe),abortSignal:e.abortSignal,fetch:this.config.fetch}),{messages:a,...o}=t,l=[];let c="unknown",u={promptTokens:void 0,completionTokens:void 0},d,h=!0;const{useLegacyFunctionCalling:m}=this.settings,y={openai:{}};return{stream:i.pipeThrough(new TransformStream({transform(b,v){var x,w,S,k,C,T,R,N,I,P,B,D;if(!b.success){c="error",v.enqueue({type:"error",error:b.error});return}const W=b.value;if("error"in W){c="error",v.enqueue({type:"error",error:W.error});return}if(h&&(h=!1,v.enqueue({type:"response-metadata",...TC(W)})),W.usage!=null){const{prompt_tokens:L,completion_tokens:te,prompt_tokens_details:V,completion_tokens_details:Q}=W.usage;u={promptTokens:L??void 0,completionTokens:te??void 0},(Q==null?void 0:Q.reasoning_tokens)!=null&&(y.openai.reasoningTokens=Q==null?void 0:Q.reasoning_tokens),(Q==null?void 0:Q.accepted_prediction_tokens)!=null&&(y.openai.acceptedPredictionTokens=Q==null?void 0:Q.accepted_prediction_tokens),(Q==null?void 0:Q.rejected_prediction_tokens)!=null&&(y.openai.rejectedPredictionTokens=Q==null?void 0:Q.rejected_prediction_tokens),(V==null?void 0:V.cached_tokens)!=null&&(y.openai.cachedPromptTokens=V==null?void 0:V.cached_tokens)}const O=W.choices[0];if((O==null?void 0:O.finish_reason)!=null&&(c=EC(O.finish_reason)),(O==null?void 0:O.delta)==null)return;const Z=O.delta;Z.content!=null&&v.enqueue({type:"text-delta",textDelta:Z.content});const U=n$(O==null?void 0:O.logprobs);U!=null&&U.length&&(d===void 0&&(d=[]),d.push(...U));const H=m&&Z.function_call!=null?[{type:"function",id:aa(),function:Z.function_call,index:0}]:Z.tool_calls;if(H!=null)for(const L of H){const te=L.index;if(l[te]==null){if(L.type!=="function")throw new Dd({data:L,message:"Expected 'function' type."});if(L.id==null)throw new Dd({data:L,message:"Expected 'id' to be a string."});if(((x=L.function)==null?void 0:x.name)==null)throw new Dd({data:L,message:"Expected 'function.name' to be a string."});l[te]={id:L.id,type:"function",function:{name:L.function.name,arguments:(w=L.function.arguments)!=null?w:""},hasFinished:!1};const Q=l[te];((S=Q.function)==null?void 0:S.name)!=null&&((k=Q.function)==null?void 0:k.arguments)!=null&&(Q.function.arguments.length>0&&v.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:Q.id,toolName:Q.function.name,argsTextDelta:Q.function.arguments}),fm(Q.function.arguments)&&(v.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(C=Q.id)!=null?C:aa(),toolName:Q.function.name,args:Q.function.arguments}),Q.hasFinished=!0));continue}const V=l[te];V.hasFinished||(((T=L.function)==null?void 0:T.arguments)!=null&&(V.function.arguments+=(N=(R=L.function)==null?void 0:R.arguments)!=null?N:""),v.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:V.id,toolName:V.function.name,argsTextDelta:(I=L.function.arguments)!=null?I:""}),((P=V.function)==null?void 0:P.name)!=null&&((B=V.function)==null?void 0:B.arguments)!=null&&fm(V.function.arguments)&&(v.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(D=V.id)!=null?D:aa(),toolName:V.function.name,args:V.function.arguments}),V.hasFinished=!0))}},flush(b){var v,x;b.enqueue({type:"finish",finishReason:c,logprobs:d,usage:{promptTokens:(v=u.promptTokens)!=null?v:NaN,completionTokens:(x=u.completionTokens)!=null?x:NaN},...y!=null?{providerMetadata:y}:{}})}})),rawCall:{rawPrompt:a,rawSettings:o},rawResponse:{headers:s},request:{body:JSON.stringify(r)},warnings:n}}},_G=Ke({prompt_tokens:At().nullish(),completion_tokens:At().nullish(),prompt_tokens_details:Ke({cached_tokens:At().nullish()}).nullish(),completion_tokens_details:Ke({reasoning_tokens:At().nullish(),accepted_prediction_tokens:At().nullish(),rejected_prediction_tokens:At().nullish()}).nullish()}).nullish(),gbe=Ke({id:ze().nullish(),created:At().nullish(),model:ze().nullish(),choices:on(Ke({message:Ke({role:Nn("assistant").nullish(),content:ze().nullish(),function_call:Ke({arguments:ze(),name:ze()}).nullish(),tool_calls:on(Ke({id:ze().nullish(),type:Nn("function"),function:Ke({name:ze(),arguments:ze()})})).nullish()}),index:At(),logprobs:Ke({content:on(Ke({token:ze(),logprob:At(),top_logprobs:on(Ke({token:ze(),logprob:At()}))})).nullable()}).nullish(),finish_reason:ze().nullish()})),usage:_G}),ybe=ms([Ke({id:ze().nullish(),created:At().nullish(),model:ze().nullish(),choices:on(Ke({delta:Ke({role:xl(["assistant"]).nullish(),content:ze().nullish(),function_call:Ke({name:ze().optional(),arguments:ze().optional()}).nullish(),tool_calls:on(Ke({index:At(),id:ze().nullish(),type:Nn("function").nullish(),function:Ke({name:ze().nullish(),arguments:ze().nullish()})})).nullish()}).nullish(),logprobs:Ke({content:on(Ke({token:ze(),logprob:At(),top_logprobs:on(Ke({token:ze(),logprob:At()}))})).nullable()}).nullish(),finish_reason:ze().nullish(),index:At()})),usage:_G}),tP]);function mj(e){return e.startsWith("o")}function bbe(e){return e.startsWith("gpt-4o-audio-preview")}function vbe(e){var t,n;return mj(e)?(n=(t=xbe[e])==null?void 0:t.systemMessageMode)!=null?n:"developer":"system"}var xbe={"o1-mini":{systemMessageMode:"remove"},"o1-mini-2024-09-12":{systemMessageMode:"remove"},"o1-preview":{systemMessageMode:"remove"},"o1-preview-2024-09-12":{systemMessageMode:"remove"},o3:{systemMessageMode:"developer"},"o3-2025-04-16":{systemMessageMode:"developer"},"o3-mini":{systemMessageMode:"developer"},"o3-mini-2025-01-31":{systemMessageMode:"developer"},"o4-mini":{systemMessageMode:"developer"},"o4-mini-2025-04-16":{systemMessageMode:"developer"}};function wbe({prompt:e,inputFormat:t,user:n="user",assistant:r="assistant"}){if(t==="prompt"&&e.length===1&&e[0].role==="user"&&e[0].content.length===1&&e[0].content[0].type==="text")return{prompt:e[0].content[0].text};let s="";e[0].role==="system"&&(s+=`${e[0].content}

`,e=e.slice(1));for(const{role:i,content:a}of e)switch(i){case"system":throw new xc({message:"Unexpected system message in prompt: ${content}",prompt:e});case"user":{const o=a.map(l=>{switch(l.type){case"text":return l.text;case"image":throw new pr({functionality:"images"})}}).join("");s+=`${n}:
${o}

`;break}case"assistant":{const o=a.map(l=>{switch(l.type){case"text":return l.text;case"tool-call":throw new pr({functionality:"tool-call messages"})}}).join("");s+=`${r}:
${o}

`;break}case"tool":throw new pr({functionality:"tool messages"});default:{const o=i;throw new Error(`Unsupported role: ${o}`)}}return s+=`${r}:
`,{prompt:s,stopSequences:[`
${n}:`]}}function r$(e){return e==null?void 0:e.tokens.map((t,n)=>({token:t,logprob:e.token_logprobs[n],topLogprobs:e.top_logprobs?Object.entries(e.top_logprobs[n]).map(([r,s])=>({token:r,logprob:s})):[]}))}var _be=class{constructor(e,t,n){this.specificationVersion="v1",this.defaultObjectGenerationMode=void 0,this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}getArgs({mode:e,inputFormat:t,prompt:n,maxTokens:r,temperature:s,topP:i,topK:a,frequencyPenalty:o,presencePenalty:l,stopSequences:c,responseFormat:u,seed:d}){var h;const m=e.type,y=[];a!=null&&y.push({type:"unsupported-setting",setting:"topK"}),u!=null&&u.type!=="text"&&y.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format is not supported."});const{prompt:b,stopSequences:v}=wbe({prompt:n,inputFormat:t}),x=[...v??[],...c??[]],w={model:this.modelId,echo:this.settings.echo,logit_bias:this.settings.logitBias,logprobs:typeof this.settings.logprobs=="number"?this.settings.logprobs:typeof this.settings.logprobs=="boolean"&&this.settings.logprobs?0:void 0,suffix:this.settings.suffix,user:this.settings.user,max_tokens:r,temperature:s,top_p:i,frequency_penalty:o,presence_penalty:l,seed:d,prompt:b,stop:x.length>0?x:void 0};switch(m){case"regular":{if((h=e.tools)!=null&&h.length)throw new pr({functionality:"tools"});if(e.toolChoice)throw new pr({functionality:"toolChoice"});return{args:w,warnings:y}}case"object-json":throw new pr({functionality:"object-json mode"});case"object-tool":throw new pr({functionality:"object-tool mode"});default:{const S=m;throw new Error(`Unsupported type: ${S}`)}}}async doGenerate(e){const{args:t,warnings:n}=this.getArgs(e),{responseHeaders:r,value:s,rawValue:i}=await Ws({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:Vs(this.config.headers(),e.headers),body:t,failedResponseHandler:Ou,successfulResponseHandler:Ua(Sbe),abortSignal:e.abortSignal,fetch:this.config.fetch}),{prompt:a,...o}=t,l=s.choices[0];return{text:l.text,usage:{promptTokens:s.usage.prompt_tokens,completionTokens:s.usage.completion_tokens},finishReason:EC(l.finish_reason),logprobs:r$(l.logprobs),rawCall:{rawPrompt:a,rawSettings:o},rawResponse:{headers:r,body:i},response:TC(s),warnings:n,request:{body:JSON.stringify(t)}}}async doStream(e){const{args:t,warnings:n}=this.getArgs(e),r={...t,stream:!0,stream_options:this.config.compatibility==="strict"?{include_usage:!0}:void 0},{responseHeaders:s,value:i}=await Ws({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:Vs(this.config.headers(),e.headers),body:r,failedResponseHandler:Ou,successfulResponseHandler:zh(Cbe),abortSignal:e.abortSignal,fetch:this.config.fetch}),{prompt:a,...o}=t;let l="unknown",c={promptTokens:Number.NaN,completionTokens:Number.NaN},u,d=!0;return{stream:i.pipeThrough(new TransformStream({transform(h,m){if(!h.success){l="error",m.enqueue({type:"error",error:h.error});return}const y=h.value;if("error"in y){l="error",m.enqueue({type:"error",error:y.error});return}d&&(d=!1,m.enqueue({type:"response-metadata",...TC(y)})),y.usage!=null&&(c={promptTokens:y.usage.prompt_tokens,completionTokens:y.usage.completion_tokens});const b=y.choices[0];(b==null?void 0:b.finish_reason)!=null&&(l=EC(b.finish_reason)),(b==null?void 0:b.text)!=null&&m.enqueue({type:"text-delta",textDelta:b.text});const v=r$(b==null?void 0:b.logprobs);v!=null&&v.length&&(u===void 0&&(u=[]),u.push(...v))},flush(h){h.enqueue({type:"finish",finishReason:l,logprobs:u,usage:c})}})),rawCall:{rawPrompt:a,rawSettings:o},rawResponse:{headers:s},warnings:n,request:{body:JSON.stringify(r)}}}},Sbe=Ke({id:ze().nullish(),created:At().nullish(),model:ze().nullish(),choices:on(Ke({text:ze(),finish_reason:ze(),logprobs:Ke({tokens:on(ze()),token_logprobs:on(At()),top_logprobs:on(xh(ze(),At())).nullable()}).nullish()})),usage:Ke({prompt_tokens:At(),completion_tokens:At()})}),Cbe=ms([Ke({id:ze().nullish(),created:At().nullish(),model:ze().nullish(),choices:on(Ke({text:ze(),finish_reason:ze().nullish(),index:At(),logprobs:Ke({tokens:on(ze()),token_logprobs:on(At()),top_logprobs:on(xh(ze(),At())).nullable()}).nullish()})),usage:Ke({prompt_tokens:At(),completion_tokens:At()}).nullish()}),tP]),kbe=class{constructor(e,t,n){this.specificationVersion="v1",this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}get maxEmbeddingsPerCall(){var e;return(e=this.settings.maxEmbeddingsPerCall)!=null?e:2048}get supportsParallelCalls(){var e;return(e=this.settings.supportsParallelCalls)!=null?e:!0}async doEmbed({values:e,headers:t,abortSignal:n}){if(e.length>this.maxEmbeddingsPerCall)throw new SE({provider:this.provider,modelId:this.modelId,maxEmbeddingsPerCall:this.maxEmbeddingsPerCall,values:e});const{responseHeaders:r,value:s}=await Ws({url:this.config.url({path:"/embeddings",modelId:this.modelId}),headers:Vs(this.config.headers(),t),body:{model:this.modelId,input:e,encoding_format:"float",dimensions:this.settings.dimensions,user:this.settings.user},failedResponseHandler:Ou,successfulResponseHandler:Ua(Ebe),abortSignal:n,fetch:this.config.fetch});return{embeddings:s.data.map(i=>i.embedding),usage:s.usage?{tokens:s.usage.prompt_tokens}:void 0,rawResponse:{headers:r}}}},Ebe=Ke({data:on(Ke({embedding:on(At())})),usage:Ke({prompt_tokens:At()}).nullish()}),Tbe={"dall-e-3":1,"dall-e-2":10,"gpt-image-1":10},Abe=new Set(["gpt-image-1"]),Rbe=class{constructor(e,t,n){this.modelId=e,this.settings=t,this.config=n,this.specificationVersion="v1"}get maxImagesPerCall(){var e,t;return(t=(e=this.settings.maxImagesPerCall)!=null?e:Tbe[this.modelId])!=null?t:1}get provider(){return this.config.provider}async doGenerate({prompt:e,n:t,size:n,aspectRatio:r,seed:s,providerOptions:i,headers:a,abortSignal:o}){var l,c,u,d;const h=[];r!=null&&h.push({type:"unsupported-setting",setting:"aspectRatio",details:"This model does not support aspect ratio. Use `size` instead."}),s!=null&&h.push({type:"unsupported-setting",setting:"seed"});const m=(u=(c=(l=this.config._internal)==null?void 0:l.currentDate)==null?void 0:c.call(l))!=null?u:new Date,{value:y,responseHeaders:b}=await Ws({url:this.config.url({path:"/images/generations",modelId:this.modelId}),headers:Vs(this.config.headers(),a),body:{model:this.modelId,prompt:e,n:t,size:n,...(d=i.openai)!=null?d:{},...Abe.has(this.modelId)?{}:{response_format:"b64_json"}},failedResponseHandler:Ou,successfulResponseHandler:Ua(Nbe),abortSignal:o,fetch:this.config.fetch});return{images:y.data.map(v=>v.b64_json),warnings:h,response:{timestamp:m,modelId:this.modelId,headers:b}}}},Nbe=Ke({data:on(Ke({b64_json:ze()}))}),Mbe=Ke({include:on(ze()).nullish(),language:ze().nullish(),prompt:ze().nullish(),temperature:At().min(0).max(1).nullish().default(0),timestampGranularities:on(xl(["word","segment"])).nullish().default(["segment"])}),s$={afrikaans:"af",arabic:"ar",armenian:"hy",azerbaijani:"az",belarusian:"be",bosnian:"bs",bulgarian:"bg",catalan:"ca",chinese:"zh",croatian:"hr",czech:"cs",danish:"da",dutch:"nl",english:"en",estonian:"et",finnish:"fi",french:"fr",galician:"gl",german:"de",greek:"el",hebrew:"he",hindi:"hi",hungarian:"hu",icelandic:"is",indonesian:"id",italian:"it",japanese:"ja",kannada:"kn",kazakh:"kk",korean:"ko",latvian:"lv",lithuanian:"lt",macedonian:"mk",malay:"ms",marathi:"mr",maori:"mi",nepali:"ne",norwegian:"no",persian:"fa",polish:"pl",portuguese:"pt",romanian:"ro",russian:"ru",serbian:"sr",slovak:"sk",slovenian:"sl",spanish:"es",swahili:"sw",swedish:"sv",tagalog:"tl",tamil:"ta",thai:"th",turkish:"tr",ukrainian:"uk",urdu:"ur",vietnamese:"vi",welsh:"cy"},Ibe=class{constructor(e,t){this.modelId=e,this.config=t,this.specificationVersion="v1"}get provider(){return this.config.provider}getArgs({audio:e,mediaType:t,providerOptions:n}){var r,s,i,a,o;const l=[],c=kE({provider:"openai",providerOptions:n,schema:Mbe}),u=new FormData,d=e instanceof Uint8Array?new Blob([e]):new Blob([EE(e)]);if(u.append("model",this.modelId),u.append("file",new File([d],"audio",{type:t})),c){const h={include:(r=c.include)!=null?r:void 0,language:(s=c.language)!=null?s:void 0,prompt:(i=c.prompt)!=null?i:void 0,temperature:(a=c.temperature)!=null?a:void 0,timestamp_granularities:(o=c.timestampGranularities)!=null?o:void 0};for(const m in h){const y=h[m];y!==void 0&&u.append(m,String(y))}}return{formData:u,warnings:l}}async doGenerate(e){var t,n,r,s,i,a;const o=(r=(n=(t=this.config._internal)==null?void 0:t.currentDate)==null?void 0:n.call(t))!=null?r:new Date,{formData:l,warnings:c}=this.getArgs(e),{value:u,responseHeaders:d,rawValue:h}=await Pye({url:this.config.url({path:"/audio/transcriptions",modelId:this.modelId}),headers:Vs(this.config.headers(),e.headers),formData:l,failedResponseHandler:Ou,successfulResponseHandler:Ua(jbe),abortSignal:e.abortSignal,fetch:this.config.fetch}),m=u.language!=null&&u.language in s$?s$[u.language]:void 0;return{text:u.text,segments:(i=(s=u.words)==null?void 0:s.map(y=>({text:y.word,startSecond:y.start,endSecond:y.end})))!=null?i:[],language:m,durationInSeconds:(a=u.duration)!=null?a:void 0,warnings:c,response:{timestamp:o,modelId:this.modelId,headers:d,body:h}}}},jbe=Ke({text:ze(),language:ze().nullish(),duration:At().nullish(),words:on(Ke({word:ze(),start:At(),end:At()})).nullish()});function Obe({prompt:e,systemMessageMode:t}){const n=[],r=[];for(const{role:s,content:i}of e)switch(s){case"system":{switch(t){case"system":{n.push({role:"system",content:i});break}case"developer":{n.push({role:"developer",content:i});break}case"remove":{r.push({type:"other",message:"system messages are removed for this model"});break}default:{const a=t;throw new Error(`Unsupported system message mode: ${a}`)}}break}case"user":{n.push({role:"user",content:i.map((a,o)=>{var l,c,u,d;switch(a.type){case"text":return{type:"input_text",text:a.text};case"image":return{type:"input_image",image_url:a.image instanceof URL?a.image.toString():`data:${(l=a.mimeType)!=null?l:"image/jpeg"};base64,${Iu(a.image)}`,detail:(u=(c=a.providerMetadata)==null?void 0:c.openai)==null?void 0:u.imageDetail};case"file":{if(a.data instanceof URL)throw new pr({functionality:"File URLs in user messages"});switch(a.mimeType){case"application/pdf":return{type:"input_file",filename:(d=a.filename)!=null?d:`part-${o}.pdf`,file_data:`data:application/pdf;base64,${a.data}`};default:throw new pr({functionality:"Only PDF files are supported in user messages"})}}}})});break}case"assistant":{for(const a of i)switch(a.type){case"text":{n.push({role:"assistant",content:[{type:"output_text",text:a.text}]});break}case"tool-call":{n.push({type:"function_call",call_id:a.toolCallId,name:a.toolName,arguments:JSON.stringify(a.args)});break}}break}case"tool":{for(const a of i)n.push({type:"function_call_output",call_id:a.toolCallId,output:JSON.stringify(a.result)});break}default:{const a=s;throw new Error(`Unsupported role: ${a}`)}}return{messages:n,warnings:r}}function i$({finishReason:e,hasToolCalls:t}){switch(e){case void 0:case null:return t?"tool-calls":"stop";case"max_output_tokens":return"length";case"content_filter":return"content-filter";default:return t?"tool-calls":"unknown"}}function Pbe({mode:e,strict:t}){var n;const r=(n=e.tools)!=null&&n.length?e.tools:void 0,s=[];if(r==null)return{tools:void 0,tool_choice:void 0,toolWarnings:s};const i=e.toolChoice,a=[];for(const l of r)switch(l.type){case"function":a.push({type:"function",name:l.name,description:l.description,parameters:l.parameters,strict:t?!0:void 0});break;case"provider-defined":switch(l.id){case"openai.web_search_preview":a.push({type:"web_search_preview",search_context_size:l.args.searchContextSize,user_location:l.args.userLocation});break;default:s.push({type:"unsupported-tool",tool:l});break}break;default:s.push({type:"unsupported-tool",tool:l});break}if(i==null)return{tools:a,tool_choice:void 0,toolWarnings:s};const o=i.type;switch(o){case"auto":case"none":case"required":return{tools:a,tool_choice:o,toolWarnings:s};case"tool":return i.toolName==="web_search_preview"?{tools:a,tool_choice:{type:"web_search_preview"},toolWarnings:s}:{tools:a,tool_choice:{type:"function",name:i.toolName},toolWarnings:s};default:{const l=o;throw new pr({functionality:`Unsupported tool choice type: ${l}`})}}}var Dbe=class{constructor(e,t){this.specificationVersion="v1",this.defaultObjectGenerationMode="json",this.supportsStructuredOutputs=!0,this.modelId=e,this.config=t}get provider(){return this.config.provider}getArgs({mode:e,maxTokens:t,temperature:n,stopSequences:r,topP:s,topK:i,presencePenalty:a,frequencyPenalty:o,seed:l,prompt:c,providerMetadata:u,responseFormat:d}){var h,m,y;const b=[],v=eve(this.modelId),x=e.type;i!=null&&b.push({type:"unsupported-setting",setting:"topK"}),l!=null&&b.push({type:"unsupported-setting",setting:"seed"}),a!=null&&b.push({type:"unsupported-setting",setting:"presencePenalty"}),o!=null&&b.push({type:"unsupported-setting",setting:"frequencyPenalty"}),r!=null&&b.push({type:"unsupported-setting",setting:"stopSequences"});const{messages:w,warnings:S}=Obe({prompt:c,systemMessageMode:v.systemMessageMode});b.push(...S);const k=kE({provider:"openai",providerOptions:u,schema:tve}),C=(h=k==null?void 0:k.strictSchemas)!=null?h:!0,T={model:this.modelId,input:w,temperature:n,top_p:s,max_output_tokens:t,...(d==null?void 0:d.type)==="json"&&{text:{format:d.schema!=null?{type:"json_schema",strict:C,name:(m=d.name)!=null?m:"response",description:d.description,schema:d.schema}:{type:"json_object"}}},metadata:k==null?void 0:k.metadata,parallel_tool_calls:k==null?void 0:k.parallelToolCalls,previous_response_id:k==null?void 0:k.previousResponseId,store:k==null?void 0:k.store,user:k==null?void 0:k.user,instructions:k==null?void 0:k.instructions,...v.isReasoningModel&&((k==null?void 0:k.reasoningEffort)!=null||(k==null?void 0:k.reasoningSummary)!=null)&&{reasoning:{...(k==null?void 0:k.reasoningEffort)!=null&&{effort:k.reasoningEffort},...(k==null?void 0:k.reasoningSummary)!=null&&{summary:k.reasoningSummary}}},...v.requiredAutoTruncation&&{truncation:"auto"}};switch(v.isReasoningModel&&(T.temperature!=null&&(T.temperature=void 0,b.push({type:"unsupported-setting",setting:"temperature",details:"temperature is not supported for reasoning models"})),T.top_p!=null&&(T.top_p=void 0,b.push({type:"unsupported-setting",setting:"topP",details:"topP is not supported for reasoning models"}))),x){case"regular":{const{tools:R,tool_choice:N,toolWarnings:I}=Pbe({mode:e,strict:C});return{args:{...T,tools:R,tool_choice:N},warnings:[...b,...I]}}case"object-json":return{args:{...T,text:{format:e.schema!=null?{type:"json_schema",strict:C,name:(y=e.name)!=null?y:"response",description:e.description,schema:e.schema}:{type:"json_object"}}},warnings:b};case"object-tool":return{args:{...T,tool_choice:{type:"function",name:e.tool.name},tools:[{type:"function",name:e.tool.name,description:e.tool.description,parameters:e.tool.parameters,strict:C}]},warnings:b};default:{const R=x;throw new Error(`Unsupported type: ${R}`)}}}async doGenerate(e){var t,n,r,s,i,a,o;const{args:l,warnings:c}=this.getArgs(e),{responseHeaders:u,value:d,rawValue:h}=await Ws({url:this.config.url({path:"/responses",modelId:this.modelId}),headers:Vs(this.config.headers(),e.headers),body:l,failedResponseHandler:Ou,successfulResponseHandler:Ua(Ke({id:ze(),created_at:At(),model:ze(),output:on(TE("type",[Ke({type:Nn("message"),role:Nn("assistant"),content:on(Ke({type:Nn("output_text"),text:ze(),annotations:on(Ke({type:Nn("url_citation"),start_index:At(),end_index:At(),url:ze(),title:ze()}))}))}),Ke({type:Nn("function_call"),call_id:ze(),name:ze(),arguments:ze()}),Ke({type:Nn("web_search_call")}),Ke({type:Nn("computer_call")}),Ke({type:Nn("reasoning"),summary:on(Ke({type:Nn("summary_text"),text:ze()}))})])),incomplete_details:Ke({reason:ze()}).nullable(),usage:SG})),abortSignal:e.abortSignal,fetch:this.config.fetch}),m=d.output.filter(v=>v.type==="message").flatMap(v=>v.content).filter(v=>v.type==="output_text"),y=d.output.filter(v=>v.type==="function_call").map(v=>({toolCallType:"function",toolCallId:v.call_id,toolName:v.name,args:v.arguments})),b=(n=(t=d.output.find(v=>v.type==="reasoning"))==null?void 0:t.summary)!=null?n:null;return{text:m.map(v=>v.text).join(`
`),sources:m.flatMap(v=>v.annotations.map(x=>{var w,S,k;return{sourceType:"url",id:(k=(S=(w=this.config).generateId)==null?void 0:S.call(w))!=null?k:aa(),url:x.url,title:x.title}})),finishReason:i$({finishReason:(r=d.incomplete_details)==null?void 0:r.reason,hasToolCalls:y.length>0}),toolCalls:y.length>0?y:void 0,reasoning:b?b.map(v=>({type:"text",text:v.text})):void 0,usage:{promptTokens:d.usage.input_tokens,completionTokens:d.usage.output_tokens},rawCall:{rawPrompt:void 0,rawSettings:{}},rawResponse:{headers:u,body:h},request:{body:JSON.stringify(l)},response:{id:d.id,timestamp:new Date(d.created_at*1e3),modelId:d.model},providerMetadata:{openai:{responseId:d.id,cachedPromptTokens:(i=(s=d.usage.input_tokens_details)==null?void 0:s.cached_tokens)!=null?i:null,reasoningTokens:(o=(a=d.usage.output_tokens_details)==null?void 0:a.reasoning_tokens)!=null?o:null}},warnings:c}}async doStream(e){const{args:t,warnings:n}=this.getArgs(e),{responseHeaders:r,value:s}=await Ws({url:this.config.url({path:"/responses",modelId:this.modelId}),headers:Vs(this.config.headers(),e.headers),body:{...t,stream:!0},failedResponseHandler:Ou,successfulResponseHandler:zh(Wbe),abortSignal:e.abortSignal,fetch:this.config.fetch}),i=this;let a="unknown",o=NaN,l=NaN,c=null,u=null,d=null;const h={};let m=!1;return{stream:s.pipeThrough(new TransformStream({transform(y,b){var v,x,w,S,k,C,T,R;if(!y.success){a="error",b.enqueue({type:"error",error:y.error});return}const N=y.value;if(Xbe(N))N.item.type==="function_call"&&(h[N.output_index]={toolName:N.item.name,toolCallId:N.item.call_id},b.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:N.item.call_id,toolName:N.item.name,argsTextDelta:N.item.arguments}));else if(Zbe(N)){const I=h[N.output_index];I!=null&&b.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:I.toolCallId,toolName:I.toolName,argsTextDelta:N.delta})}else Ybe(N)?(d=N.response.id,b.enqueue({type:"response-metadata",id:N.response.id,timestamp:new Date(N.response.created_at*1e3),modelId:N.response.model})):Hbe(N)?b.enqueue({type:"text-delta",textDelta:N.delta}):Qbe(N)?b.enqueue({type:"reasoning",textDelta:N.delta}):Gbe(N)&&N.item.type==="function_call"?(h[N.output_index]=void 0,m=!0,b.enqueue({type:"tool-call",toolCallType:"function",toolCallId:N.item.call_id,toolName:N.item.name,args:N.item.arguments})):Kbe(N)?(a=i$({finishReason:(v=N.response.incomplete_details)==null?void 0:v.reason,hasToolCalls:m}),o=N.response.usage.input_tokens,l=N.response.usage.output_tokens,c=(w=(x=N.response.usage.input_tokens_details)==null?void 0:x.cached_tokens)!=null?w:c,u=(k=(S=N.response.usage.output_tokens_details)==null?void 0:S.reasoning_tokens)!=null?k:u):Jbe(N)&&b.enqueue({type:"source",source:{sourceType:"url",id:(R=(T=(C=i.config).generateId)==null?void 0:T.call(C))!=null?R:aa(),url:N.annotation.url,title:N.annotation.title}})},flush(y){y.enqueue({type:"finish",finishReason:a,usage:{promptTokens:o,completionTokens:l},...(c!=null||u!=null)&&{providerMetadata:{openai:{responseId:d,cachedPromptTokens:c,reasoningTokens:u}}}})}})),rawCall:{rawPrompt:void 0,rawSettings:{}},rawResponse:{headers:r},request:{body:JSON.stringify(t)},warnings:n}}},SG=Ke({input_tokens:At(),input_tokens_details:Ke({cached_tokens:At().nullish()}).nullish(),output_tokens:At(),output_tokens_details:Ke({reasoning_tokens:At().nullish()}).nullish()}),Fbe=Ke({type:Nn("response.output_text.delta"),delta:ze()}),Lbe=Ke({type:xl(["response.completed","response.incomplete"]),response:Ke({incomplete_details:Ke({reason:ze()}).nullish(),usage:SG})}),Bbe=Ke({type:Nn("response.created"),response:Ke({id:ze(),created_at:At(),model:ze()})}),$be=Ke({type:Nn("response.output_item.done"),output_index:At(),item:TE("type",[Ke({type:Nn("message")}),Ke({type:Nn("function_call"),id:ze(),call_id:ze(),name:ze(),arguments:ze(),status:Nn("completed")})])}),zbe=Ke({type:Nn("response.function_call_arguments.delta"),item_id:ze(),output_index:At(),delta:ze()}),Ube=Ke({type:Nn("response.output_item.added"),output_index:At(),item:TE("type",[Ke({type:Nn("message")}),Ke({type:Nn("function_call"),id:ze(),call_id:ze(),name:ze(),arguments:ze()})])}),qbe=Ke({type:Nn("response.output_text.annotation.added"),annotation:Ke({type:Nn("url_citation"),url:ze(),title:ze()})}),Vbe=Ke({type:Nn("response.reasoning_summary_text.delta"),item_id:ze(),output_index:At(),summary_index:At(),delta:ze()}),Wbe=ms([Fbe,Lbe,Bbe,$be,zbe,Ube,qbe,Vbe,Ke({type:ze()}).passthrough()]);function Hbe(e){return e.type==="response.output_text.delta"}function Gbe(e){return e.type==="response.output_item.done"}function Kbe(e){return e.type==="response.completed"||e.type==="response.incomplete"}function Ybe(e){return e.type==="response.created"}function Zbe(e){return e.type==="response.function_call_arguments.delta"}function Xbe(e){return e.type==="response.output_item.added"}function Jbe(e){return e.type==="response.output_text.annotation.added"}function Qbe(e){return e.type==="response.reasoning_summary_text.delta"}function eve(e){return e.startsWith("o")?e.startsWith("o1-mini")||e.startsWith("o1-preview")?{isReasoningModel:!0,systemMessageMode:"remove",requiredAutoTruncation:!1}:{isReasoningModel:!0,systemMessageMode:"developer",requiredAutoTruncation:!1}:{isReasoningModel:!1,systemMessageMode:"system",requiredAutoTruncation:!1}}var tve=Ke({metadata:Hd().nullish(),parallelToolCalls:Kn().nullish(),previousResponseId:ze().nullish(),store:Kn().nullish(),user:ze().nullish(),reasoningEffort:ze().nullish(),strictSchemas:Kn().nullish(),instructions:ze().nullish(),reasoningSummary:ze().nullish()}),nve=Ke({});function rve({searchContextSize:e,userLocation:t}={}){return{type:"provider-defined",id:"openai.web_search_preview",args:{searchContextSize:e,userLocation:t},parameters:nve}}var sve={webSearchPreview:rve},ive=Ke({instructions:ze().nullish(),speed:At().min(.25).max(4).default(1).nullish()}),ave=class{constructor(e,t){this.modelId=e,this.config=t,this.specificationVersion="v1"}get provider(){return this.config.provider}getArgs({text:e,voice:t="alloy",outputFormat:n="mp3",speed:r,instructions:s,providerOptions:i}){const a=[],o=kE({provider:"openai",providerOptions:i,schema:ive}),l={model:this.modelId,input:e,voice:t,response_format:"mp3",speed:r,instructions:s};if(n&&(["mp3","opus","aac","flac","wav","pcm"].includes(n)?l.response_format=n:a.push({type:"unsupported-setting",setting:"outputFormat",details:`Unsupported output format: ${n}. Using mp3 instead.`})),o){const c={};for(const u in c){const d=c[u];d!==void 0&&(l[u]=d)}}return{requestBody:l,warnings:a}}async doGenerate(e){var t,n,r;const s=(r=(n=(t=this.config._internal)==null?void 0:t.currentDate)==null?void 0:n.call(t))!=null?r:new Date,{requestBody:i,warnings:a}=this.getArgs(e),{value:o,responseHeaders:l,rawValue:c}=await Ws({url:this.config.url({path:"/audio/speech",modelId:this.modelId}),headers:Vs(this.config.headers(),e.headers),body:i,failedResponseHandler:Ou,successfulResponseHandler:Dye(),abortSignal:e.abortSignal,fetch:this.config.fetch});return{audio:o,warnings:a,request:{body:JSON.stringify(i)},response:{timestamp:s,modelId:this.modelId,headers:l,body:c}}}};function CG(e={}){var t,n,r;const s=(t=g1(e.baseURL))!=null?t:"https://api.openai.com/v1",i=(n=e.compatibility)!=null?n:"compatible",a=(r=e.name)!=null?r:"openai",o=()=>({Authorization:`Bearer ${JO({apiKey:e.apiKey,environmentVariableName:"OPENAI_API_KEY",description:"OpenAI"})}`,"OpenAI-Organization":e.organization,"OpenAI-Project":e.project,...e.headers}),l=(x,w={})=>new mbe(x,w,{provider:`${a}.chat`,url:({path:S})=>`${s}${S}`,headers:o,compatibility:i,fetch:e.fetch}),c=(x,w={})=>new _be(x,w,{provider:`${a}.completion`,url:({path:S})=>`${s}${S}`,headers:o,compatibility:i,fetch:e.fetch}),u=(x,w={})=>new kbe(x,w,{provider:`${a}.embedding`,url:({path:S})=>`${s}${S}`,headers:o,fetch:e.fetch}),d=(x,w={})=>new Rbe(x,w,{provider:`${a}.image`,url:({path:S})=>`${s}${S}`,headers:o,fetch:e.fetch}),h=x=>new Ibe(x,{provider:`${a}.transcription`,url:({path:w})=>`${s}${w}`,headers:o,fetch:e.fetch}),m=x=>new ave(x,{provider:`${a}.speech`,url:({path:w})=>`${s}${w}`,headers:o,fetch:e.fetch}),y=(x,w)=>{if(new.target)throw new Error("The OpenAI model function cannot be called with the new keyword.");return x==="gpt-3.5-turbo-instruct"?c(x,w):l(x,w)},b=x=>new Dbe(x,{provider:`${a}.responses`,url:({path:w})=>`${s}${w}`,headers:o,fetch:e.fetch}),v=function(x,w){return y(x,w)};return v.languageModel=y,v.chat=l,v.completion=c,v.responses=b,v.embedding=u,v.textEmbedding=u,v.textEmbeddingModel=u,v.image=d,v.imageModel=d,v.transcription=h,v.transcriptionModel=h,v.speech=m,v.speechModel=m,v.tools=sve,v}CG({compatibility:"strict"});function $l(e){if(ove(e))return;if(typeof e=="boolean")return{type:"boolean",properties:{}};const{type:t,description:n,required:r,properties:s,items:i,allOf:a,anyOf:o,oneOf:l,format:c,const:u,minLength:d,enum:h}=e,m={};if(n&&(m.description=n),r&&(m.required=r),c&&(m.format=c),u!==void 0&&(m.enum=[u]),t&&(Array.isArray(t)?t.includes("null")?(m.type=t.filter(y=>y!=="null")[0],m.nullable=!0):m.type=t:t==="null"?m.type="null":m.type=t),h!==void 0&&(m.enum=h),s!=null&&(m.properties=Object.entries(s).reduce((y,[b,v])=>(y[b]=$l(v),y),{})),i&&(m.items=Array.isArray(i)?i.map($l):$l(i)),a&&(m.allOf=a.map($l)),o)if(o.some(y=>typeof y=="object"&&(y==null?void 0:y.type)==="null")){const y=o.filter(b=>!(typeof b=="object"&&(b==null?void 0:b.type)==="null"));if(y.length===1){const b=$l(y[0]);typeof b=="object"&&(m.nullable=!0,Object.assign(m,b))}else m.anyOf=y.map($l),m.nullable=!0}else m.anyOf=o.map($l);return l&&(m.oneOf=l.map($l)),d!==void 0&&(m.minLength=d),m}function ove(e){return e!=null&&typeof e=="object"&&e.type==="object"&&(e.properties==null||Object.keys(e.properties).length===0)}function lve(e){var t,n;const r=[],s=[];let i=!0;for(const{role:a,content:o}of e)switch(a){case"system":{if(!i)throw new pr({functionality:"system messages are only supported at the beginning of the conversation"});r.push({text:o});break}case"user":{i=!1;const l=[];for(const c of o)switch(c.type){case"text":{l.push({text:c.text});break}case"image":{l.push(c.image instanceof URL?{fileData:{mimeType:(t=c.mimeType)!=null?t:"image/jpeg",fileUri:c.image.toString()}}:{inlineData:{mimeType:(n=c.mimeType)!=null?n:"image/jpeg",data:Iu(c.image)}});break}case"file":{l.push(c.data instanceof URL?{fileData:{mimeType:c.mimeType,fileUri:c.data.toString()}}:{inlineData:{mimeType:c.mimeType,data:c.data}});break}}s.push({role:"user",parts:l});break}case"assistant":{i=!1,s.push({role:"model",parts:o.map(l=>{switch(l.type){case"text":return l.text.length===0?void 0:{text:l.text};case"file":{if(l.mimeType!=="image/png")throw new pr({functionality:"Only PNG images are supported in assistant messages"});if(l.data instanceof URL)throw new pr({functionality:"File data URLs in assistant messages are not supported"});return{inlineData:{mimeType:l.mimeType,data:l.data}}}case"tool-call":return{functionCall:{name:l.toolName,args:l.args}}}}).filter(l=>l!==void 0)});break}case"tool":{i=!1,s.push({role:"user",parts:o.map(l=>({functionResponse:{name:l.toolName,response:{name:l.toolName,content:l.result}}}))});break}}return{systemInstruction:r.length>0?{parts:r}:void 0,contents:s}}function a$(e){return e.includes("/")?e:`models/${e}`}var cve=Ke({error:Ke({code:At().nullable(),message:ze(),status:ze()})}),gj=$h({errorSchema:cve,errorToMessage:e=>e.error.message});function uve(e,t,n,r){var s,i;const a=(s=e.tools)!=null&&s.length?e.tools:void 0,o=[],l=r.includes("gemini-2"),c=r.includes("gemini-1.5-flash")&&!r.includes("-8b");if(t)return{tools:l?{googleSearch:{}}:{googleSearchRetrieval:!c||!n?{}:{dynamicRetrievalConfig:n}},toolConfig:void 0,toolWarnings:o};if(a==null)return{tools:void 0,toolConfig:void 0,toolWarnings:o};const u=[];for(const m of a)m.type==="provider-defined"?o.push({type:"unsupported-tool",tool:m}):u.push({name:m.name,description:(i=m.description)!=null?i:"",parameters:$l(m.parameters)});const d=e.toolChoice;if(d==null)return{tools:{functionDeclarations:u},toolConfig:void 0,toolWarnings:o};const h=d.type;switch(h){case"auto":return{tools:{functionDeclarations:u},toolConfig:{functionCallingConfig:{mode:"AUTO"}},toolWarnings:o};case"none":return{tools:{functionDeclarations:u},toolConfig:{functionCallingConfig:{mode:"NONE"}},toolWarnings:o};case"required":return{tools:{functionDeclarations:u},toolConfig:{functionCallingConfig:{mode:"ANY"}},toolWarnings:o};case"tool":return{tools:{functionDeclarations:u},toolConfig:{functionCallingConfig:{mode:"ANY",allowedFunctionNames:[d.toolName]}},toolWarnings:o};default:{const m=h;throw new pr({functionality:`Unsupported tool choice type: ${m}`})}}}function o$({finishReason:e,hasToolCalls:t}){switch(e){case"STOP":return t?"tool-calls":"stop";case"MAX_TOKENS":return"length";case"IMAGE_SAFETY":case"RECITATION":case"SAFETY":case"BLOCKLIST":case"PROHIBITED_CONTENT":case"SPII":return"content-filter";case"FINISH_REASON_UNSPECIFIED":case"OTHER":return"other";case"MALFORMED_FUNCTION_CALL":return"error";default:return"unknown"}}var dve=class{constructor(e,t,n){this.specificationVersion="v1",this.defaultObjectGenerationMode="json",this.supportsImageUrls=!1,this.modelId=e,this.settings=t,this.config=n}get supportsStructuredOutputs(){var e;return(e=this.settings.structuredOutputs)!=null?e:!0}get provider(){return this.config.provider}async getArgs({mode:e,prompt:t,maxTokens:n,temperature:r,topP:s,topK:i,frequencyPenalty:a,presencePenalty:o,stopSequences:l,responseFormat:c,seed:u,providerMetadata:d}){var h,m,y;const b=e.type,v=[],x=kE({provider:"google",providerOptions:d,schema:mve});((h=x==null?void 0:x.thinkingConfig)==null?void 0:h.includeThoughts)===!0&&!this.config.provider.startsWith("google.vertex.")&&v.push({type:"other",message:`The 'includeThoughts' option is only supported with the Google Vertex provider and might not be supported or could behave unexpectedly with the current Google provider (${this.config.provider}).`});const w={maxOutputTokens:n,temperature:r,topK:i,topP:s,frequencyPenalty:a,presencePenalty:o,stopSequences:l,seed:u,responseMimeType:(c==null?void 0:c.type)==="json"?"application/json":void 0,responseSchema:(c==null?void 0:c.type)==="json"&&c.schema!=null&&this.supportsStructuredOutputs?$l(c.schema):void 0,...this.settings.audioTimestamp&&{audioTimestamp:this.settings.audioTimestamp},responseModalities:x==null?void 0:x.responseModalities,thinkingConfig:x==null?void 0:x.thinkingConfig},{contents:S,systemInstruction:k}=lve(t);switch(b){case"regular":{const{tools:C,toolConfig:T,toolWarnings:R}=uve(e,(m=this.settings.useSearchGrounding)!=null?m:!1,this.settings.dynamicRetrievalConfig,this.modelId);return{args:{generationConfig:w,contents:S,systemInstruction:k,safetySettings:this.settings.safetySettings,tools:C,toolConfig:T,cachedContent:this.settings.cachedContent},warnings:[...v,...R]}}case"object-json":return{args:{generationConfig:{...w,responseMimeType:"application/json",responseSchema:e.schema!=null&&this.supportsStructuredOutputs?$l(e.schema):void 0},contents:S,systemInstruction:k,safetySettings:this.settings.safetySettings,cachedContent:this.settings.cachedContent},warnings:v};case"object-tool":return{args:{generationConfig:w,contents:S,tools:{functionDeclarations:[{name:e.tool.name,description:(y=e.tool.description)!=null?y:"",parameters:$l(e.tool.parameters)}]},toolConfig:{functionCallingConfig:{mode:"ANY"}},safetySettings:this.settings.safetySettings,cachedContent:this.settings.cachedContent},warnings:v};default:{const C=b;throw new Error(`Unsupported type: ${C}`)}}}supportsUrl(e){return this.config.isSupportedUrl(e)}async doGenerate(e){var t,n,r,s,i;const{args:a,warnings:o}=await this.getArgs(e),l=JSON.stringify(a),c=Vs(await lj(this.config.headers),e.headers),{responseHeaders:u,value:d,rawValue:h}=await Ws({url:`${this.config.baseURL}/${a$(this.modelId)}:generateContent`,headers:c,body:a,failedResponseHandler:gj,successfulResponseHandler:Ua(hve),abortSignal:e.abortSignal,fetch:this.config.fetch}),{contents:m,...y}=a,b=d.candidates[0],v=b.content==null||typeof b.content!="object"||!("parts"in b.content)?[]:b.content.parts,x=l$({parts:v,generateId:this.config.generateId}),w=d.usageMetadata;return{text:c$(v),reasoning:u$(v),files:(t=d$(v))==null?void 0:t.map(S=>({data:S.inlineData.data,mimeType:S.inlineData.mimeType})),toolCalls:x,finishReason:o$({finishReason:b.finishReason,hasToolCalls:x!=null&&x.length>0}),usage:{promptTokens:(n=w==null?void 0:w.promptTokenCount)!=null?n:NaN,completionTokens:(r=w==null?void 0:w.candidatesTokenCount)!=null?r:NaN},rawCall:{rawPrompt:m,rawSettings:y},rawResponse:{headers:u,body:h},warnings:o,providerMetadata:{google:{groundingMetadata:(s=b.groundingMetadata)!=null?s:null,safetyRatings:(i=b.safetyRatings)!=null?i:null}},sources:f$({groundingMetadata:b.groundingMetadata,generateId:this.config.generateId}),request:{body:l}}}async doStream(e){const{args:t,warnings:n}=await this.getArgs(e),r=JSON.stringify(t),s=Vs(await lj(this.config.headers),e.headers),{responseHeaders:i,value:a}=await Ws({url:`${this.config.baseURL}/${a$(this.modelId)}:streamGenerateContent?alt=sse`,headers:s,body:t,failedResponseHandler:gj,successfulResponseHandler:zh(pve),abortSignal:e.abortSignal,fetch:this.config.fetch}),{contents:o,...l}=t;let c="unknown",u={promptTokens:Number.NaN,completionTokens:Number.NaN},d;const h=this.config.generateId;let m=!1;return{stream:a.pipeThrough(new TransformStream({transform(y,b){var v,x,w,S,k,C;if(!y.success){b.enqueue({type:"error",error:y.error});return}const T=y.value,R=T.usageMetadata;R!=null&&(u={promptTokens:(v=R.promptTokenCount)!=null?v:NaN,completionTokens:(x=R.candidatesTokenCount)!=null?x:NaN});const N=(w=T.candidates)==null?void 0:w[0];if(N==null)return;const I=N.content;if(I!=null){const P=c$(I.parts);P!=null&&b.enqueue({type:"text-delta",textDelta:P});const B=u$(I.parts);if(B!=null)for(const O of B)b.enqueue({type:"reasoning",textDelta:O.text});const D=d$(I.parts);if(D!=null)for(const O of D)b.enqueue({type:"file",mimeType:O.inlineData.mimeType,data:O.inlineData.data});const W=l$({parts:I.parts,generateId:h});if(W!=null)for(const O of W)b.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:O.toolCallId,toolName:O.toolName,argsTextDelta:O.args}),b.enqueue({type:"tool-call",toolCallType:"function",toolCallId:O.toolCallId,toolName:O.toolName,args:O.args}),m=!0}if(N.finishReason!=null){c=o$({finishReason:N.finishReason,hasToolCalls:m});const P=(S=f$({groundingMetadata:N.groundingMetadata,generateId:h}))!=null?S:[];for(const B of P)b.enqueue({type:"source",source:B});d={google:{groundingMetadata:(k=N.groundingMetadata)!=null?k:null,safetyRatings:(C=N.safetyRatings)!=null?C:null}}}},flush(y){y.enqueue({type:"finish",finishReason:c,usage:u,providerMetadata:d})}})),rawCall:{rawPrompt:o,rawSettings:l},rawResponse:{headers:i},warnings:n,request:{body:r}}}};function l$({parts:e,generateId:t}){const n=e==null?void 0:e.filter(r=>"functionCall"in r);return n==null||n.length===0?void 0:n.map(r=>({toolCallType:"function",toolCallId:t(),toolName:r.functionCall.name,args:JSON.stringify(r.functionCall.args)}))}function c$(e){const t=e==null?void 0:e.filter(n=>"text"in n&&n.thought!==!0);return t==null||t.length===0?void 0:t.map(n=>n.text).join("")}function u$(e){const t=e==null?void 0:e.filter(n=>"text"in n&&n.thought===!0&&n.text!=null);return t==null||t.length===0?void 0:t.map(n=>({type:"text",text:n.text}))}function d$(e){return e==null?void 0:e.filter(t=>"inlineData"in t)}function f$({groundingMetadata:e,generateId:t}){var n;return(n=e==null?void 0:e.groundingChunks)==null?void 0:n.filter(r=>r.web!=null).map(r=>({sourceType:"url",id:t(),url:r.web.uri,title:r.web.title}))}var kG=Ke({parts:on(ms([Ke({functionCall:Ke({name:ze(),args:Wy()})}),Ke({inlineData:Ke({mimeType:ze(),data:ze()})}),Ke({text:ze().nullish(),thought:Kn().nullish()})])).nullish()}),fve=Ke({web:Ke({uri:ze(),title:ze()}).nullish(),retrievedContext:Ke({uri:ze(),title:ze()}).nullish()}),EG=Ke({webSearchQueries:on(ze()).nullish(),retrievalQueries:on(ze()).nullish(),searchEntryPoint:Ke({renderedContent:ze()}).nullish(),groundingChunks:on(fve).nullish(),groundingSupports:on(Ke({segment:Ke({startIndex:At().nullish(),endIndex:At().nullish(),text:ze().nullish()}),segment_text:ze().nullish(),groundingChunkIndices:on(At()).nullish(),supportChunkIndices:on(At()).nullish(),confidenceScores:on(At()).nullish(),confidenceScore:on(At()).nullish()})).nullish(),retrievalMetadata:ms([Ke({webDynamicRetrievalScore:At()}),Ke({})]).nullish()}),TG=Ke({category:ze().nullish(),probability:ze().nullish(),probabilityScore:At().nullish(),severity:ze().nullish(),severityScore:At().nullish(),blocked:Kn().nullish()}),hve=Ke({candidates:on(Ke({content:kG.nullish().or(Ke({}).strict()),finishReason:ze().nullish(),safetyRatings:on(TG).nullish(),groundingMetadata:EG.nullish()})),usageMetadata:Ke({promptTokenCount:At().nullish(),candidatesTokenCount:At().nullish(),totalTokenCount:At().nullish()}).nullish()}),pve=Ke({candidates:on(Ke({content:kG.nullish(),finishReason:ze().nullish(),safetyRatings:on(TG).nullish(),groundingMetadata:EG.nullish()})).nullish(),usageMetadata:Ke({promptTokenCount:At().nullish(),candidatesTokenCount:At().nullish(),totalTokenCount:At().nullish()}).nullish()}),mve=Ke({responseModalities:on(xl(["TEXT","IMAGE"])).nullish(),thinkingConfig:Ke({thinkingBudget:At().nullish(),includeThoughts:Kn().nullish()}).nullish()}),gve=class{constructor(e,t,n){this.specificationVersion="v1",this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}get maxEmbeddingsPerCall(){return 2048}get supportsParallelCalls(){return!0}async doEmbed({values:e,headers:t,abortSignal:n}){if(e.length>this.maxEmbeddingsPerCall)throw new SE({provider:this.provider,modelId:this.modelId,maxEmbeddingsPerCall:this.maxEmbeddingsPerCall,values:e});const r=Vs(await lj(this.config.headers),t),{responseHeaders:s,value:i}=await Ws({url:`${this.config.baseURL}/models/${this.modelId}:batchEmbedContents`,headers:r,body:{requests:e.map(a=>({model:`models/${this.modelId}`,content:{role:"user",parts:[{text:a}]},outputDimensionality:this.settings.outputDimensionality,taskType:this.settings.taskType}))},failedResponseHandler:gj,successfulResponseHandler:Ua(yve),abortSignal:n,fetch:this.config.fetch});return{embeddings:i.embeddings.map(a=>a.values),usage:void 0,rawResponse:{headers:s}}}},yve=Ke({embeddings:on(Ke({values:on(At())}))});function bve(e){return e.toString().startsWith("https://generativelanguage.googleapis.com/v1beta/files/")}function AG(e={}){var t;const n=(t=g1(e.baseURL))!=null?t:"https://generativelanguage.googleapis.com/v1beta",r=()=>({"x-goog-api-key":JO({apiKey:e.apiKey,environmentVariableName:"GOOGLE_GENERATIVE_AI_API_KEY",description:"Google Generative AI"}),...e.headers}),s=(o,l={})=>{var c;return new dve(o,l,{provider:"google.generative-ai",baseURL:n,headers:r,generateId:(c=e.generateId)!=null?c:aa,isSupportedUrl:bve,fetch:e.fetch})},i=(o,l={})=>new gve(o,l,{provider:"google.generative-ai",baseURL:n,headers:r,fetch:e.fetch}),a=function(o,l){if(new.target)throw new Error("The Google Generative AI model function cannot be called with the new keyword.");return s(o,l)};return a.languageModel=s,a.chat=s,a.generativeAI=s,a.embedding=i,a.textEmbedding=i,a.textEmbeddingModel=i,a}AG();var vve=Object.defineProperty,xve=Object.defineProperties,wve=Object.getOwnPropertyDescriptors,AC=Object.getOwnPropertySymbols,RG=Object.prototype.hasOwnProperty,NG=Object.prototype.propertyIsEnumerable,h$=(e,t,n)=>t in e?vve(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,ja=(e,t)=>{for(var n in t||(t={}))RG.call(t,n)&&h$(e,n,t[n]);if(AC)for(var n of AC(t))NG.call(t,n)&&h$(e,n,t[n]);return e},N2=(e,t)=>xve(e,wve(t)),RC=(e,t)=>{var n={};for(var r in e)RG.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&AC)for(var r of AC(e))t.indexOf(r)<0&&NG.call(e,r)&&(n[r]=e[r]);return n},_ve=Ke({type:Nn("reasoning.summary"),summary:ze()}),Sve=Ke({type:Nn("reasoning.encrypted"),data:ze()}),Cve=Ke({type:Nn("reasoning.text"),text:ze().nullish(),signature:ze().nullish()}),kve=ms([_ve,Sve,Cve]),Eve=ms([kve,Wy().transform(()=>null)]),nP=on(Eve).transform(e=>e.filter(t=>!!t));function Xf(e){var t,n,r;const s=e==null?void 0:e.anthropic,i=e==null?void 0:e.openrouter;return(r=(n=(t=i==null?void 0:i.cacheControl)!=null?t:i==null?void 0:i.cache_control)!=null?n:s==null?void 0:s.cacheControl)!=null?r:s==null?void 0:s.cache_control}function Tve(e){var t,n,r;const s=[];for(const{role:i,content:a,providerMetadata:o}of e)switch(i){case"system":{s.push({role:"system",content:a,cache_control:Xf(o)});break}case"user":{if(a.length===1&&((t=a[0])==null?void 0:t.type)==="text"){s.push({role:"user",content:a[0].text,cache_control:(n=Xf(o))!=null?n:Xf(a[0].providerMetadata)});break}const l=Xf(o),c=a.map(u=>{var d,h,m,y;const b=(d=Xf(u.providerMetadata))!=null?d:l;switch(u.type){case"text":return{type:"text",text:u.text,cache_control:b};case"image":return{type:"image_url",image_url:{url:u.image instanceof URL?u.image.toString():`data:${(h=u.mimeType)!=null?h:"image/jpeg"};base64,${Iu(u.image)}`},cache_control:b};case"file":return{type:"file",file:{filename:String((y=(m=u.providerMetadata)==null?void 0:m.openrouter)==null?void 0:y.filename),file_data:u.data instanceof Uint8Array?`data:${u.mimeType};base64,${Iu(u.data)}`:`data:${u.mimeType};base64,${u.data}`},cache_control:b};default:{const v=u;throw new Error(`Unsupported content part type: ${v}`)}}});s.push({role:"user",content:c});break}case"assistant":{let l="",c="";const u=[],d=[];for(const h of a)switch(h.type){case"text":{l+=h.text;break}case"tool-call":{d.push({id:h.toolCallId,type:"function",function:{name:h.toolName,arguments:JSON.stringify(h.args)}});break}case"reasoning":{c+=h.text,u.push({type:"reasoning.text",text:h.text,signature:h.signature});break}case"redacted-reasoning":{u.push({type:"reasoning.encrypted",data:h.data});break}case"file":break;default:{const m=h;throw new Error(`Unsupported part: ${m}`)}}s.push({role:"assistant",content:l,tool_calls:d.length>0?d:void 0,reasoning:c||void 0,reasoning_details:u.length>0?u:void 0,cache_control:Xf(o)});break}case"tool":{for(const l of a)s.push({role:"tool",tool_call_id:l.toolCallId,content:JSON.stringify(l.result),cache_control:(r=Xf(o))!=null?r:Xf(l.providerMetadata)});break}default:{const l=i;throw new Error(`Unsupported role: ${l}`)}}return s}function p$(e){var t,n;return(n=(t=e==null?void 0:e.content)==null?void 0:t.map(({token:r,logprob:s,top_logprobs:i})=>({token:r,logprob:s,topLogprobs:i?i.map(({token:a,logprob:o})=>({token:a,logprob:o})):[]})))!=null?n:void 0}function NC(e){switch(e){case"stop":return"stop";case"length":return"length";case"content_filter":return"content-filter";case"function_call":case"tool_calls":return"tool-calls";default:return"unknown"}}var rP=Ke({error:Ke({code:ms([ze(),At()]).nullable(),message:ze(),type:ze().nullable(),param:Hd().nullable()})}),MC=$h({errorSchema:rP,errorToMessage:e=>e.error.message});function Ave(e){return"parameters"in e}var Rve=class{constructor(e,t,n){this.specificationVersion="v1",this.defaultObjectGenerationMode="tool",this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}getArgs({mode:e,prompt:t,maxTokens:n,temperature:r,topP:s,frequencyPenalty:i,presencePenalty:a,seed:o,stopSequences:l,responseFormat:c,topK:u,providerMetadata:d}){var h;const m=e.type,y=(h=d==null?void 0:d.openrouter)!=null?h:{},b=ja(ja(ja({model:this.modelId,models:this.settings.models,logit_bias:this.settings.logitBias,logprobs:this.settings.logprobs===!0||typeof this.settings.logprobs=="number"?!0:void 0,top_logprobs:typeof this.settings.logprobs=="number"?this.settings.logprobs:typeof this.settings.logprobs=="boolean"&&this.settings.logprobs?0:void 0,user:this.settings.user,parallel_tool_calls:this.settings.parallelToolCalls,max_tokens:n,temperature:r,top_p:s,frequency_penalty:i,presence_penalty:a,seed:o,stop:l,response_format:c,top_k:u,messages:Tve(t),include_reasoning:this.settings.includeReasoning,reasoning:this.settings.reasoning,usage:this.settings.usage},this.config.extraBody),this.settings.extraBody),y);switch(m){case"regular":return ja(ja({},b),Ive(e));case"object-json":return N2(ja({},b),{response_format:{type:"json_object"}});case"object-tool":return N2(ja({},b),{tool_choice:{type:"function",function:{name:e.tool.name}},tools:[{type:"function",function:{name:e.tool.name,description:e.tool.description,parameters:e.tool.parameters}}]});default:{const v=m;throw new pr({functionality:`${v} mode`})}}}async doGenerate(e){var t,n,r,s,i,a,o,l,c;const u=this.getArgs(e),{responseHeaders:d,value:h}=await Ws({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:Vs(this.config.headers(),e.headers),body:u,failedResponseHandler:MC,successfulResponseHandler:Ua(Nve),abortSignal:e.abortSignal,fetch:this.config.fetch}),m=u,{messages:y}=m,b=RC(m,["messages"]),v=h.choices[0];if(!v)throw new Error("No choice in response");const x=h.usage?{promptTokens:(t=h.usage.prompt_tokens)!=null?t:0,completionTokens:(n=h.usage.completion_tokens)!=null?n:0}:{promptTokens:0,completionTokens:0},w={};h.usage&&((r=this.settings.usage)!=null&&r.include)&&(w.openrouter={usage:{promptTokens:h.usage.prompt_tokens,promptTokensDetails:h.usage.prompt_tokens_details?{cachedTokens:(s=h.usage.prompt_tokens_details.cached_tokens)!=null?s:0}:void 0,completionTokens:h.usage.completion_tokens,completionTokensDetails:h.usage.completion_tokens_details?{reasoningTokens:(i=h.usage.completion_tokens_details.reasoning_tokens)!=null?i:0}:void 0,cost:h.usage.cost,totalTokens:(a=h.usage.total_tokens)!=null?a:0}});const S=Object.keys(w).length>0,k=(o=v.message.reasoning_details)!=null?o:[],C=k.length>0?k.map(T=>{var R;switch(T.type){case"reasoning.text":{if(T.text)return{type:"text",text:T.text,signature:(R=T.signature)!=null?R:void 0};break}case"reasoning.summary":{if(T.summary)return{type:"text",text:T.summary};break}case"reasoning.encrypted":{if(T.data)return{type:"redacted",data:T.data};break}}return null}).filter(T=>T!==null):v.message.reasoning?[{type:"text",text:v.message.reasoning}]:[];return ja({response:{id:h.id,modelId:h.model},text:(l=v.message.content)!=null?l:void 0,reasoning:C,toolCalls:(c=v.message.tool_calls)==null?void 0:c.map(T=>{var R;return{toolCallType:"function",toolCallId:(R=T.id)!=null?R:aa(),toolName:T.function.name,args:T.function.arguments}}),finishReason:NC(v.finish_reason),usage:x,rawCall:{rawPrompt:y,rawSettings:b},rawResponse:{headers:d},warnings:[],logprobs:p$(v.logprobs)},S?{providerMetadata:w}:{})}async doStream(e){var t,n;const r=this.getArgs(e),{responseHeaders:s,value:i}=await Ws({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:Vs(this.config.headers(),e.headers),body:N2(ja({},r),{stream:!0,stream_options:this.config.compatibility==="strict"?ja({include_usage:!0},(t=this.settings.usage)!=null&&t.include?{include_usage:!0}:{}):void 0}),failedResponseHandler:MC,successfulResponseHandler:zh(Mve),abortSignal:e.abortSignal,fetch:this.config.fetch}),a=r,{messages:o}=a,l=RC(a,["messages"]),c=[];let u="other",d={promptTokens:Number.NaN,completionTokens:Number.NaN},h;const m={},y=!!((n=this.settings.usage)!=null&&n.include);return{stream:i.pipeThrough(new TransformStream({transform(b,v){var x,w,S,k,C,T,R,N,I,P,B,D,W,O;if(!b.success){u="error",v.enqueue({type:"error",error:b.error});return}const Z=b.value;if("error"in Z){u="error",v.enqueue({type:"error",error:Z.error});return}Z.id&&v.enqueue({type:"response-metadata",id:Z.id}),Z.model&&v.enqueue({type:"response-metadata",modelId:Z.model}),Z.usage!=null&&(d={promptTokens:Z.usage.prompt_tokens,completionTokens:Z.usage.completion_tokens},m.promptTokens=Z.usage.prompt_tokens,Z.usage.prompt_tokens_details&&(m.promptTokensDetails={cachedTokens:(x=Z.usage.prompt_tokens_details.cached_tokens)!=null?x:0}),m.completionTokens=Z.usage.completion_tokens,Z.usage.completion_tokens_details&&(m.completionTokensDetails={reasoningTokens:(w=Z.usage.completion_tokens_details.reasoning_tokens)!=null?w:0}),m.cost=Z.usage.cost,m.totalTokens=Z.usage.total_tokens);const U=Z.choices[0];if((U==null?void 0:U.finish_reason)!=null&&(u=NC(U.finish_reason)),(U==null?void 0:U.delta)==null)return;const H=U.delta;if(H.content!=null&&v.enqueue({type:"text-delta",textDelta:H.content}),H.reasoning!=null&&v.enqueue({type:"reasoning",textDelta:H.reasoning}),H.reasoning_details&&H.reasoning_details.length>0)for(const te of H.reasoning_details)switch(te.type){case"reasoning.text":{te.text&&v.enqueue({type:"reasoning",textDelta:te.text}),te.signature&&v.enqueue({type:"reasoning-signature",signature:te.signature});break}case"reasoning.encrypted":{te.data&&v.enqueue({type:"redacted-reasoning",data:te.data});break}case"reasoning.summary":{te.summary&&v.enqueue({type:"reasoning",textDelta:te.summary});break}}const L=p$(U==null?void 0:U.logprobs);if(L!=null&&L.length&&(h===void 0&&(h=[]),h.push(...L)),H.tool_calls!=null)for(const te of H.tool_calls){const V=te.index;if(c[V]==null){if(te.type!=="function")throw new Dd({data:te,message:"Expected 'function' type."});if(te.id==null)throw new Dd({data:te,message:"Expected 'id' to be a string."});if(((S=te.function)==null?void 0:S.name)==null)throw new Dd({data:te,message:"Expected 'function.name' to be a string."});c[V]={id:te.id,type:"function",function:{name:te.function.name,arguments:(k=te.function.arguments)!=null?k:""},sent:!1};const ee=c[V];if(ee==null)throw new Error("Tool call is missing");((C=ee.function)==null?void 0:C.name)!=null&&((T=ee.function)==null?void 0:T.arguments)!=null&&fm(ee.function.arguments)&&(v.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:ee.id,toolName:ee.function.name,argsTextDelta:ee.function.arguments}),v.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(R=ee.id)!=null?R:aa(),toolName:ee.function.name,args:ee.function.arguments}),ee.sent=!0);continue}const Q=c[V];if(Q==null)throw new Error("Tool call is missing");((N=te.function)==null?void 0:N.arguments)!=null&&(Q.function.arguments+=(P=(I=te.function)==null?void 0:I.arguments)!=null?P:""),v.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:Q.id,toolName:Q.function.name,argsTextDelta:(B=te.function.arguments)!=null?B:""}),((D=Q.function)==null?void 0:D.name)!=null&&((W=Q.function)==null?void 0:W.arguments)!=null&&fm(Q.function.arguments)&&(v.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(O=Q.id)!=null?O:aa(),toolName:Q.function.name,args:Q.function.arguments}),Q.sent=!0)}},flush(b){var v;if(u==="tool-calls")for(const S of c)S.sent||(b.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(v=S.id)!=null?v:aa(),toolName:S.function.name,args:fm(S.function.arguments)?S.function.arguments:"{}"}),S.sent=!0);const x={};y&&(m.totalTokens!==void 0||m.cost!==void 0||m.promptTokensDetails!==void 0||m.completionTokensDetails!==void 0)&&(x.openrouter={usage:m});const w=Object.keys(x).length>0&&y;b.enqueue(ja({type:"finish",finishReason:u,logprobs:h,usage:d},w?{providerMetadata:x}:{}))}})),rawCall:{rawPrompt:o,rawSettings:l},rawResponse:{headers:s},warnings:[]}}},MG=Ke({id:ze().optional(),model:ze().optional(),usage:Ke({prompt_tokens:At(),prompt_tokens_details:Ke({cached_tokens:At()}).nullish(),completion_tokens:At(),completion_tokens_details:Ke({reasoning_tokens:At()}).nullish(),total_tokens:At(),cost:At().optional()}).nullish()}),Nve=MG.extend({choices:on(Ke({message:Ke({role:Nn("assistant"),content:ze().nullable().optional(),reasoning:ze().nullable().optional(),reasoning_details:nP.nullish(),tool_calls:on(Ke({id:ze().optional().nullable(),type:Nn("function"),function:Ke({name:ze(),arguments:ze()})})).optional()}),index:At(),logprobs:Ke({content:on(Ke({token:ze(),logprob:At(),top_logprobs:on(Ke({token:ze(),logprob:At()}))})).nullable()}).nullable().optional(),finish_reason:ze().optional().nullable()}))}),Mve=ms([MG.extend({choices:on(Ke({delta:Ke({role:xl(["assistant"]).optional(),content:ze().nullish(),reasoning:ze().nullish().optional(),reasoning_details:nP.nullish(),tool_calls:on(Ke({index:At(),id:ze().nullish(),type:Nn("function").optional(),function:Ke({name:ze().nullish(),arguments:ze().nullish()})})).nullish()}).nullish(),logprobs:Ke({content:on(Ke({token:ze(),logprob:At(),top_logprobs:on(Ke({token:ze(),logprob:At()}))})).nullable()}).nullish(),finish_reason:ze().nullable().optional(),index:At()}))}),rP]);function Ive(e){var t;const n=(t=e.tools)!=null&&t.length?e.tools:void 0;if(n==null)return{tools:void 0,tool_choice:void 0};const r=n.map(a=>Ave(a)?{type:"function",function:{name:a.name,description:a.description,parameters:a.parameters}}:{type:"function",function:{name:a.name}}),s=e.toolChoice;if(s==null)return{tools:r,tool_choice:void 0};const i=s.type;switch(i){case"auto":case"none":case"required":return{tools:r,tool_choice:i};case"tool":return{tools:r,tool_choice:{type:"function",function:{name:s.toolName}}};default:{const a=i;throw new Error(`Unsupported tool choice type: ${a}`)}}}function jve({prompt:e,inputFormat:t,user:n="user",assistant:r="assistant"}){if(t==="prompt"&&e.length===1&&e[0]&&e[0].role==="user"&&e[0].content.length===1&&e[0].content[0]&&e[0].content[0].type==="text")return{prompt:e[0].content[0].text};let s="";e[0]&&e[0].role==="system"&&(s+=`${e[0].content}

`,e=e.slice(1));for(const{role:i,content:a}of e)switch(i){case"system":throw new xc({message:"Unexpected system message in prompt: ${content}",prompt:e});case"user":{const o=a.map(l=>{switch(l.type){case"text":return l.text;case"image":throw new pr({functionality:"images"});case"file":throw new pr({functionality:"file attachments"});default:{const c=l;throw new Error(`Unsupported content type: ${c}`)}}}).join("");s+=`${n}:
${o}

`;break}case"assistant":{const o=a.map(l=>{switch(l.type){case"text":return l.text;case"tool-call":throw new pr({functionality:"tool-call messages"});case"reasoning":throw new pr({functionality:"reasoning messages"});case"redacted-reasoning":throw new pr({functionality:"redacted reasoning messages"});case"file":throw new pr({functionality:"file attachments"});default:{const c=l;throw new Error(`Unsupported content type: ${c}`)}}}).join("");s+=`${r}:
${o}

`;break}case"tool":throw new pr({functionality:"tool messages"});default:{const o=i;throw new Error(`Unsupported role: ${o}`)}}return s+=`${r}:
`,{prompt:s}}function m$(e){return e==null?void 0:e.tokens.map((t,n)=>{var r,s;return{token:t,logprob:(r=e.token_logprobs[n])!=null?r:0,topLogprobs:e.top_logprobs?Object.entries((s=e.top_logprobs[n])!=null?s:{}).map(([i,a])=>({token:i,logprob:a})):[]}})}var Ove=class{constructor(e,t,n){this.specificationVersion="v1",this.defaultObjectGenerationMode=void 0,this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}getArgs({mode:e,inputFormat:t,prompt:n,maxTokens:r,temperature:s,topP:i,frequencyPenalty:a,presencePenalty:o,seed:l,responseFormat:c,topK:u,stopSequences:d,providerMetadata:h}){var m,y;const b=e.type,v=(m=h==null?void 0:h.openrouter)!=null?m:{},{prompt:x}=jve({prompt:n,inputFormat:t}),w=ja(ja(ja({model:this.modelId,models:this.settings.models,logit_bias:this.settings.logitBias,logprobs:typeof this.settings.logprobs=="number"?this.settings.logprobs:typeof this.settings.logprobs=="boolean"&&this.settings.logprobs?0:void 0,suffix:this.settings.suffix,user:this.settings.user,max_tokens:r,temperature:s,top_p:i,frequency_penalty:a,presence_penalty:o,seed:l,stop:d,response_format:c,top_k:u,prompt:x,include_reasoning:this.settings.includeReasoning,reasoning:this.settings.reasoning},this.config.extraBody),this.settings.extraBody),v);switch(b){case"regular":{if((y=e.tools)!=null&&y.length)throw new pr({functionality:"tools"});if(e.toolChoice)throw new pr({functionality:"toolChoice"});return w}case"object-json":throw new pr({functionality:"object-json mode"});case"object-tool":throw new pr({functionality:"object-tool mode"});default:{const S=b;throw new pr({functionality:`${S} mode`})}}}async doGenerate(e){var t,n,r,s,i;const a=this.getArgs(e),{responseHeaders:o,value:l}=await Ws({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:Vs(this.config.headers(),e.headers),body:a,failedResponseHandler:MC,successfulResponseHandler:Ua(g$),abortSignal:e.abortSignal,fetch:this.config.fetch}),c=a,{prompt:u}=c,d=RC(c,["prompt"]);if("error"in l)throw new Error(`${l.error.message}`);const h=l.choices[0];if(!h)throw new Error("No choice in OpenRouter completion response");return{response:{id:l.id,modelId:l.model},text:(t=h.text)!=null?t:"",reasoning:h.reasoning||void 0,usage:{promptTokens:(r=(n=l.usage)==null?void 0:n.prompt_tokens)!=null?r:0,completionTokens:(i=(s=l.usage)==null?void 0:s.completion_tokens)!=null?i:0},finishReason:NC(h.finish_reason),logprobs:m$(h.logprobs),rawCall:{rawPrompt:u,rawSettings:d},rawResponse:{headers:o},warnings:[]}}async doStream(e){const t=this.getArgs(e),{responseHeaders:n,value:r}=await Ws({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:Vs(this.config.headers(),e.headers),body:N2(ja({},this.getArgs(e)),{stream:!0,stream_options:this.config.compatibility==="strict"?{include_usage:!0}:void 0}),failedResponseHandler:MC,successfulResponseHandler:zh(g$),abortSignal:e.abortSignal,fetch:this.config.fetch}),s=t,{prompt:i}=s,a=RC(s,["prompt"]);let o="other",l={promptTokens:Number.NaN,completionTokens:Number.NaN},c;return{stream:r.pipeThrough(new TransformStream({transform(u,d){if(!u.success){o="error",d.enqueue({type:"error",error:u.error});return}const h=u.value;if("error"in h){o="error",d.enqueue({type:"error",error:h.error});return}h.usage!=null&&(l={promptTokens:h.usage.prompt_tokens,completionTokens:h.usage.completion_tokens});const m=h.choices[0];(m==null?void 0:m.finish_reason)!=null&&(o=NC(m.finish_reason)),(m==null?void 0:m.text)!=null&&d.enqueue({type:"text-delta",textDelta:m.text});const y=m$(m==null?void 0:m.logprobs);y!=null&&y.length&&(c===void 0&&(c=[]),c.push(...y))},flush(u){u.enqueue({type:"finish",finishReason:o,logprobs:c,usage:l})}})),rawCall:{rawPrompt:i,rawSettings:a},rawResponse:{headers:n},warnings:[]}}},g$=ms([Ke({id:ze().optional(),model:ze().optional(),choices:on(Ke({text:ze(),reasoning:ze().nullish().optional(),reasoning_details:nP.nullish(),finish_reason:ze().nullish(),index:At(),logprobs:Ke({tokens:on(ze()),token_logprobs:on(At()),top_logprobs:on(xh(ze(),At())).nullable()}).nullable().optional()})),usage:Ke({prompt_tokens:At(),completion_tokens:At()}).optional().nullable()}),rP]);function IG(e={}){var t,n,r;const s=(n=g1((t=e.baseURL)!=null?t:e.baseUrl))!=null?n:"https://openrouter.ai/api/v1",i=(r=e.compatibility)!=null?r:"compatible",a=()=>ja({Authorization:`Bearer ${JO({apiKey:e.apiKey,environmentVariableName:"OPENROUTER_API_KEY",description:"OpenRouter"})}`},e.headers),o=(d,h={})=>new Rve(d,h,{provider:"openrouter.chat",url:({path:m})=>`${s}${m}`,headers:a,compatibility:i,fetch:e.fetch,extraBody:e.extraBody}),l=(d,h={})=>new Ove(d,h,{provider:"openrouter.completion",url:({path:m})=>`${s}${m}`,headers:a,compatibility:i,fetch:e.fetch,extraBody:e.extraBody}),c=(d,h)=>{if(new.target)throw new Error("The OpenRouter model function cannot be called with the new keyword.");return d==="openai/gpt-3.5-turbo-instruct"?l(d,h):o(d,h)},u=(d,h)=>c(d,h);return u.languageModel=c,u.chat=o,u.completion=l,u}IG({compatibility:"strict"});var Dp={},SN={},y$;function b$(){return y$||(y$=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Allow=e.ALL=e.COLLECTION=e.ATOM=e.SPECIAL=e.INF=e._INFINITY=e.INFINITY=e.NAN=e.BOOL=e.NULL=e.OBJ=e.ARR=e.NUM=e.STR=void 0,e.STR=1,e.NUM=2,e.ARR=4,e.OBJ=8,e.NULL=16,e.BOOL=32,e.NAN=64,e.INFINITY=128,e._INFINITY=256,e.INF=e.INFINITY|e._INFINITY,e.SPECIAL=e.NULL|e.BOOL|e.INF|e.NAN,e.ATOM=e.STR|e.NUM|e.SPECIAL,e.COLLECTION=e.ARR|e.OBJ,e.ALL=e.ATOM|e.COLLECTION,e.Allow={STR:e.STR,NUM:e.NUM,ARR:e.ARR,OBJ:e.OBJ,NULL:e.NULL,BOOL:e.BOOL,NAN:e.NAN,INFINITY:e.INFINITY,_INFINITY:e._INFINITY,INF:e.INF,SPECIAL:e.SPECIAL,ATOM:e.ATOM,COLLECTION:e.COLLECTION,ALL:e.ALL},e.default=e.Allow}(SN)),SN}var v$;function Pve(){return v$||(v$=1,function(e){var t=Dp&&Dp.__createBinding||(Object.create?function(c,u,d,h){h===void 0&&(h=d);var m=Object.getOwnPropertyDescriptor(u,d);(!m||("get"in m?!u.__esModule:m.writable||m.configurable))&&(m={enumerable:!0,get:function(){return u[d]}}),Object.defineProperty(c,h,m)}:function(c,u,d,h){h===void 0&&(h=d),c[h]=u[d]}),n=Dp&&Dp.__exportStar||function(c,u){for(var d in c)d!=="default"&&!Object.prototype.hasOwnProperty.call(u,d)&&t(u,c,d)};Object.defineProperty(e,"__esModule",{value:!0}),e.Allow=e.MalformedJSON=e.PartialJSON=e.parseJSON=e.parse=void 0;const r=b$();Object.defineProperty(e,"Allow",{enumerable:!0,get:function(){return r.Allow}}),n(b$(),e);class s extends Error{}e.PartialJSON=s;class i extends Error{}e.MalformedJSON=i;function a(c,u=r.Allow.ALL){if(typeof c!="string")throw new TypeError(`expecting str, got ${typeof c}`);if(!c.trim())throw new Error(`${c} is empty`);return o(c.trim(),u)}e.parseJSON=a;const o=(c,u)=>{const d=c.length;let h=0;const m=C=>{throw new s(`${C} at position ${h}`)},y=C=>{throw new i(`${C} at position ${h}`)},b=()=>(k(),h>=d&&m("Unexpected end of input"),c[h]==='"'?v():c[h]==="{"?x():c[h]==="["?w():c.substring(h,h+4)==="null"||r.Allow.NULL&u&&d-h<4&&"null".startsWith(c.substring(h))?(h+=4,null):c.substring(h,h+4)==="true"||r.Allow.BOOL&u&&d-h<4&&"true".startsWith(c.substring(h))?(h+=4,!0):c.substring(h,h+5)==="false"||r.Allow.BOOL&u&&d-h<5&&"false".startsWith(c.substring(h))?(h+=5,!1):c.substring(h,h+8)==="Infinity"||r.Allow.INFINITY&u&&d-h<8&&"Infinity".startsWith(c.substring(h))?(h+=8,1/0):c.substring(h,h+9)==="-Infinity"||r.Allow._INFINITY&u&&1<d-h&&d-h<9&&"-Infinity".startsWith(c.substring(h))?(h+=9,-1/0):c.substring(h,h+3)==="NaN"||r.Allow.NAN&u&&d-h<3&&"NaN".startsWith(c.substring(h))?(h+=3,NaN):S()),v=()=>{const C=h;let T=!1;for(h++;h<d&&(c[h]!=='"'||T&&c[h-1]==="\\");)T=c[h]==="\\"?!T:!1,h++;if(c.charAt(h)=='"')try{return JSON.parse(c.substring(C,++h-Number(T)))}catch(R){y(String(R))}else if(r.Allow.STR&u)try{return JSON.parse(c.substring(C,h-Number(T))+'"')}catch{return JSON.parse(c.substring(C,c.lastIndexOf("\\"))+'"')}m("Unterminated string literal")},x=()=>{h++,k();const C={};try{for(;c[h]!=="}";){if(k(),h>=d&&r.Allow.OBJ&u)return C;const T=v();k(),h++;try{const R=b();C[T]=R}catch(R){if(r.Allow.OBJ&u)return C;throw R}k(),c[h]===","&&h++}}catch{if(r.Allow.OBJ&u)return C;m("Expected '}' at end of object")}return h++,C},w=()=>{h++;const C=[];try{for(;c[h]!=="]";)C.push(b()),k(),c[h]===","&&h++}catch{if(r.Allow.ARR&u)return C;m("Expected ']' at end of array")}return h++,C},S=()=>{if(h===0){c==="-"&&y("Not sure what '-' is");try{return JSON.parse(c)}catch(T){if(r.Allow.NUM&u)try{return JSON.parse(c.substring(0,c.lastIndexOf("e")))}catch{}y(String(T))}}const C=h;for(c[h]==="-"&&h++;c[h]&&",]}".indexOf(c[h])===-1;)h++;h==d&&!(r.Allow.NUM&u)&&m("Unterminated number literal");try{return JSON.parse(c.substring(C,h))}catch{c.substring(C,h)==="-"&&m("Not sure what '-' is");try{return JSON.parse(c.substring(C,c.lastIndexOf("e")))}catch(R){y(String(R))}}},k=()=>{for(;h<d&&` 
\r	`.includes(c[h]);)h++};return b()},l=a;e.parse=l}(Dp)),Dp}var Dve=Pve();function CN(e){const t=[];for(const{content:n,role:r}of e)switch(r){case"system":{t.push({content:n,role:"system"});break}case"user":{t.push({...n.reduce((s,i)=>{if(i.type==="text")s.content+=i.text;else{if(i.type==="image"&&i.image instanceof URL)throw new pr({functionality:"Image URLs in user messages"});i.type==="image"&&i.image instanceof Uint8Array&&(s.images=s.images||[],s.images.push(Iu(i.image)))}return s},{content:""}),role:"user"});break}case"assistant":{const s=[],i=[];for(const a of n)switch(a.type){case"text":{s.push(a.text);break}case"tool-call":{i.push({function:{arguments:a.args,name:a.toolName},id:a.toolCallId,type:"function"});break}default:{const o=a;throw new Error(`Unsupported part: ${o}`)}}t.push({content:s.join(","),role:"assistant",tool_calls:i.length>0?i:void 0});break}case"tool":{t.push(...n.map(s=>({content:typeof s.result=="object"?JSON.stringify(s.result):`${s.result}`,role:"tool",tool_call_id:s.toolCallId})));break}default:{const s=r;throw new Error(`Unsupported role: ${s}`)}}return t}var Fve=class{constructor({tools:e,type:t}){this._firstMessage=!0,this._tools=e,this._toolPartial="",this._toolCalls=[],this._type=t,this._detectedToolCall=!1}get toolCalls(){return this._toolCalls}get detectedToolCall(){return this._detectedToolCall}parse({controller:e,delta:t}){var n;if(this.detectToolCall(t),!this._detectedToolCall)return!1;this._toolPartial+=t;let r=Dve.parse(this._toolPartial);Array.isArray(r)||(r=[r]);for(const[s,i]of r.entries()){const a=(n=JSON.stringify(i==null?void 0:i.parameters))!=null?n:"";if(a==="")continue;this._toolCalls[s]||(this._toolCalls[s]={function:{arguments:"",name:i.name},id:aa(),type:"function"});const o=this._toolCalls[s];o.function.arguments=a,e.enqueue({argsTextDelta:t,toolCallId:o.id,toolCallType:"function",toolName:o.function.name,type:"tool-call-delta"})}return!0}finish({controller:e}){for(const t of this.toolCalls)e.enqueue({args:t.function.arguments,toolCallId:t.id,toolCallType:"function",toolName:t.function.name,type:"tool-call"});return this.finishReason()}detectToolCall(e){!this._tools||this._tools.length===0||this._firstMessage&&(this._type==="object-tool"?this._detectedToolCall=!0:this._type==="regular"&&(e.trim().startsWith("{")||e.trim().startsWith("["))&&(this._detectedToolCall=!0),this._firstMessage=!1)}finishReason(){return this.detectedToolCall?this._type==="object-tool"?"stop":"tool-calls":"stop"}};function Lve({finishReason:e,hasToolCalls:t}){switch(e){case"stop":return t?"tool-calls":"stop";default:return"other"}}var Bve=Ke({error:Ke({code:ze().nullable(),message:ze(),param:Hd().nullable(),type:ze()})}),yj=$h({errorSchema:Bve,errorToMessage:e=>e.error.message});function $ve({mode:e}){var t;const n=(t=e.tools)!=null&&t.length?e.tools:void 0,r=[],s=e.toolChoice;if(n===void 0)return{tools:void 0,toolWarnings:r};const i=[];for(const o of n)o.type==="provider-defined"?r.push({tool:o,type:"unsupported-tool"}):i.push({function:{description:o.description,name:o.name,parameters:o.parameters},type:"function"});if(s===void 0)return{tools:i,toolWarnings:r};const a=s.type;switch(a){case"auto":return{tools:i,toolWarnings:r};case"none":return{tools:void 0,toolWarnings:r};default:{const o=a;throw new pr({functionality:`Unsupported tool choice type: ${o}`})}}}function zve(e){return Object.fromEntries(Object.entries(e).filter(([,t])=>t!==void 0))}var Uve=class extends TransformStream{constructor(){super({flush:e=>{this.buffer.length!==0&&e.enqueue(this.buffer)},transform:(e,t)=>{for(e=this.buffer+e;;){const n=e.indexOf(`
`);if(n===-1)break;t.enqueue(e.slice(0,n)),e=e.slice(n+1)}this.buffer=e}}),this.buffer=""}},qve=e=>async({response:t})=>{const n=qy(t);if(t.body===null)throw new UH({});return{responseHeaders:n,value:t.body.pipeThrough(new TextDecoderStream).pipeThrough(new Uve).pipeThrough(new TransformStream({transform(r,s){s.enqueue(wm({schema:e,text:r}))}}))}},Vve=class{constructor(e,t,n){this.modelId=e,this.settings=t,this.config=n,this.specificationVersion="v1",this.defaultObjectGenerationMode="json",this.supportsImageUrls=!1}get supportsStructuredOutputs(){var e;return(e=this.settings.structuredOutputs)!=null?e:!1}get provider(){return this.config.provider}getArguments({frequencyPenalty:e,maxTokens:t,mode:n,presencePenalty:r,prompt:s,responseFormat:i,seed:a,stopSequences:o,temperature:l,topK:c,topP:u}){const d=n.type,h=[];i!==void 0&&i.type==="json"&&i.schema!==void 0&&!this.supportsStructuredOutputs&&h.push({details:"JSON response format schema is only supported with structuredOutputs",setting:"responseFormat",type:"unsupported-setting"});const m={format:i==null?void 0:i.type,model:this.modelId,options:zve({f16_kv:this.settings.f16Kv,frequency_penalty:e,low_vram:this.settings.lowVram,main_gpu:this.settings.mainGpu,min_p:this.settings.minP,mirostat:this.settings.mirostat,mirostat_eta:this.settings.mirostatEta,mirostat_tau:this.settings.mirostatTau,num_batch:this.settings.numBatch,num_ctx:this.settings.numCtx,num_gpu:this.settings.numGpu,num_keep:this.settings.numKeep,num_predict:t,num_thread:this.settings.numThread,numa:this.settings.numa,penalize_newline:this.settings.penalizeNewline,presence_penalty:r,repeat_last_n:this.settings.repeatLastN,repeat_penalty:this.settings.repeatPenalty,seed:a,stop:o,temperature:l,tfs_z:this.settings.tfsZ,top_k:c,top_p:u,typical_p:this.settings.typicalP,use_mlock:this.settings.useMlock,use_mmap:this.settings.useMmap,vocab_only:this.settings.vocabOnly})};switch(d){case"regular":{const{tools:y,toolWarnings:b}=$ve({mode:n});return{args:{...m,messages:CN(s),tools:y},type:d,warnings:[...h,...b]}}case"object-json":return{args:{...m,format:this.supportsStructuredOutputs&&n.schema!==void 0?n.schema:"json",messages:CN(s)},type:d,warnings:h};case"object-tool":return{args:{...m,messages:CN(s),tool_choice:{function:{name:n.tool.name},type:"function"},tools:[{function:{description:n.tool.description,name:n.tool.name,parameters:n.tool.parameters},type:"function"}]},type:d,warnings:h};default:{const y=d;throw new Error(`Unsupported type: ${y}`)}}}async doGenerate(e){var t,n;const{args:r,warnings:s}=this.getArguments(e),i={...r,stream:!1},{responseHeaders:a,value:o}=await Ws({abortSignal:e.abortSignal,body:i,failedResponseHandler:yj,fetch:this.config.fetch,headers:Vs(this.config.headers(),e.headers),successfulResponseHandler:Ua(Wve),url:`${this.config.baseURL}/chat`}),{messages:l,...c}=i,u=(t=o.message.tool_calls)==null?void 0:t.map(d=>{var h;return{args:JSON.stringify(d.function.arguments),toolCallId:(h=d.id)!=null?h:aa(),toolCallType:"function",toolName:d.function.name}});return{finishReason:Lve({finishReason:o.done_reason,hasToolCalls:u!==void 0&&u.length>0}),rawCall:{rawPrompt:l,rawSettings:c},rawResponse:{headers:a},request:{body:JSON.stringify(i)},text:(n=o.message.content)!=null?n:void 0,toolCalls:u,usage:{completionTokens:o.eval_count||0,promptTokens:o.prompt_eval_count||0},warnings:s}}async doStream(e){if(this.settings.simulateStreaming){const m=await this.doGenerate(e),y=new ReadableStream({start(b){if(b.enqueue({type:"response-metadata",...m.response}),m.text&&b.enqueue({textDelta:m.text,type:"text-delta"}),m.toolCalls)for(const v of m.toolCalls)b.enqueue({argsTextDelta:v.args,toolCallId:v.toolCallId,toolCallType:"function",toolName:v.toolName,type:"tool-call-delta"}),b.enqueue({type:"tool-call",...v});b.enqueue({finishReason:m.finishReason,logprobs:m.logprobs,providerMetadata:m.providerMetadata,type:"finish",usage:m.usage}),b.close()}});return{rawCall:m.rawCall,rawResponse:m.rawResponse,stream:y,warnings:m.warnings}}const{args:t,type:n,warnings:r}=this.getArguments(e),{responseHeaders:s,value:i}=await Ws({abortSignal:e.abortSignal,body:t,failedResponseHandler:yj,fetch:this.config.fetch,headers:Vs(this.config.headers(),e.headers),successfulResponseHandler:qve(Hve),url:`${this.config.baseURL}/chat`}),{messages:a,...o}=t,l=e.mode.type==="regular"?e.mode.tools:e.mode.type==="object-tool"?[e.mode.tool]:void 0,c=new Fve({tools:l,type:n});let u="other",d={completionTokens:Number.NaN,promptTokens:Number.NaN};const{experimentalStreamTools:h=!0}=this.settings;return{rawCall:{rawPrompt:a,rawSettings:o},rawResponse:{headers:s},request:{body:JSON.stringify(t)},stream:i.pipeThrough(new TransformStream({async flush(m){m.enqueue({finishReason:u,type:"finish",usage:d})},async transform(m,y){if(!m.success){y.enqueue({error:m.error,type:"error"});return}const b=m.value;if(b.done){u=c.finish({controller:y}),d={completionTokens:b.eval_count,promptTokens:b.prompt_eval_count||0};return}h&&c.parse({controller:y,delta:b.message.content})||b.message.content!==null&&y.enqueue({textDelta:b.message.content,type:"text-delta"})}})),warnings:r}}},Wve=Ke({created_at:ze(),done:Nn(!0),done_reason:ze().optional().nullable(),eval_count:At(),eval_duration:At(),load_duration:At().optional(),message:Ke({content:ze(),role:ze(),tool_calls:on(Ke({function:Ke({arguments:xh(Hd()),name:ze()}),id:ze().optional()})).optional().nullable()}),model:ze(),prompt_eval_count:At().optional(),prompt_eval_duration:At().optional(),total_duration:At()}),Hve=TE("done",[Ke({created_at:ze(),done:Nn(!1),message:Ke({content:ze(),role:ze()}),model:ze()}),Ke({created_at:ze(),done:Nn(!0),eval_count:At(),eval_duration:At(),load_duration:At().optional(),model:ze(),prompt_eval_count:At().optional(),prompt_eval_duration:At().optional(),total_duration:At()})]),Gve=class{constructor(e,t,n){this.specificationVersion="v1",this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}get maxEmbeddingsPerCall(){var e;return(e=this.settings.maxEmbeddingsPerCall)!=null?e:2048}get supportsParallelCalls(){return!1}async doEmbed({abortSignal:e,values:t}){if(t.length>this.maxEmbeddingsPerCall)throw new SE({maxEmbeddingsPerCall:this.maxEmbeddingsPerCall,modelId:this.modelId,provider:this.provider,values:t});const{responseHeaders:n,value:r}=await Ws({abortSignal:e,body:{input:t,model:this.modelId},failedResponseHandler:yj,fetch:this.config.fetch,headers:this.config.headers(),successfulResponseHandler:Ua(Kve),url:`${this.config.baseURL}/embed`});return{embeddings:r.embeddings,rawResponse:{headers:n},usage:r.prompt_eval_count?{tokens:r.prompt_eval_count}:void 0}}},Kve=Ke({embeddings:on(on(At())),prompt_eval_count:At().nullable()});function jG(e={}){var t;const n=(t=g1(e.baseURL))!=null?t:"http://127.0.0.1:11434/api",r=()=>({...e.headers}),s=(o,l={})=>new Vve(o,l,{baseURL:n,fetch:e.fetch,headers:r,provider:"ollama.chat"}),i=(o,l={})=>new Gve(o,l,{baseURL:n,fetch:e.fetch,headers:r,provider:"ollama.embedding"}),a=function(o,l){if(new.target)throw new Error("The Ollama model function cannot be called with the new keyword.");return s(o,l)};return a.chat=s,a.embedding=i,a.languageModel=s,a.textEmbedding=i,a.textEmbeddingModel=i,a}jG();function Ov(e){var t,n;return(n=(t=e==null?void 0:e.providerMetadata)==null?void 0:t.openaiCompatible)!=null?n:{}}function Yve(e){const t=[];for(const{role:n,content:r,...s}of e){const i=Ov({...s});switch(n){case"system":{t.push({role:"system",content:r,...i});break}case"user":{if(r.length===1&&r[0].type==="text"){t.push({role:"user",content:r[0].text,...Ov(r[0])});break}t.push({role:"user",content:r.map(a=>{var o;const l=Ov(a);switch(a.type){case"text":return{type:"text",text:a.text,...l};case"image":return{type:"image_url",image_url:{url:a.image instanceof URL?a.image.toString():`data:${(o=a.mimeType)!=null?o:"image/jpeg"};base64,${Iu(a.image)}`},...l};case"file":throw new pr({functionality:"File content parts in user messages"})}}),...i});break}case"assistant":{let a="";const o=[];for(const l of r){const c=Ov(l);switch(l.type){case"text":{a+=l.text;break}case"tool-call":{o.push({id:l.toolCallId,type:"function",function:{name:l.toolName,arguments:JSON.stringify(l.args)},...c});break}}}t.push({role:"assistant",content:a,tool_calls:o.length>0?o:void 0,...i});break}case"tool":{for(const a of r){const o=Ov(a);t.push({role:"tool",tool_call_id:a.toolCallId,content:JSON.stringify(a.result),...o})}break}default:{const a=n;throw new Error(`Unsupported role: ${a}`)}}}return t}function IC({id:e,model:t,created:n}){return{id:e??void 0,modelId:t??void 0,timestamp:n!=null?new Date(n*1e3):void 0}}function jC(e){switch(e){case"stop":return"stop";case"length":return"length";case"content_filter":return"content-filter";case"function_call":case"tool_calls":return"tool-calls";default:return"unknown"}}var Zve=Ke({error:Ke({message:ze(),type:ze().nullish(),param:Hd().nullish(),code:ms([ze(),At()]).nullish()})}),AE={errorSchema:Zve,errorToMessage:e=>e.error.message};function Xve({mode:e,structuredOutputs:t}){var n;const r=(n=e.tools)!=null&&n.length?e.tools:void 0,s=[];if(r==null)return{tools:void 0,tool_choice:void 0,toolWarnings:s};const i=e.toolChoice,a=[];for(const l of r)l.type==="provider-defined"?s.push({type:"unsupported-tool",tool:l}):a.push({type:"function",function:{name:l.name,description:l.description,parameters:l.parameters}});if(i==null)return{tools:a,tool_choice:void 0,toolWarnings:s};const o=i.type;switch(o){case"auto":case"none":case"required":return{tools:a,tool_choice:o,toolWarnings:s};case"tool":return{tools:a,tool_choice:{type:"function",function:{name:i.toolName}},toolWarnings:s};default:{const l=o;throw new pr({functionality:`Unsupported tool choice type: ${l}`})}}}var Jve=class{constructor(e,t,n){this.specificationVersion="v1";var r,s;this.modelId=e,this.settings=t,this.config=n;const i=(r=n.errorStructure)!=null?r:AE;this.chunkSchema=exe(i.errorSchema),this.failedResponseHandler=$h(i),this.supportsStructuredOutputs=(s=n.supportsStructuredOutputs)!=null?s:!1}get defaultObjectGenerationMode(){return this.config.defaultObjectGenerationMode}get provider(){return this.config.provider}get providerOptionsName(){return this.config.provider.split(".")[0].trim()}getArgs({mode:e,prompt:t,maxTokens:n,temperature:r,topP:s,topK:i,frequencyPenalty:a,presencePenalty:o,providerMetadata:l,stopSequences:c,responseFormat:u,seed:d}){var h,m,y,b,v;const x=e.type,w=[];i!=null&&w.push({type:"unsupported-setting",setting:"topK"}),(u==null?void 0:u.type)==="json"&&u.schema!=null&&!this.supportsStructuredOutputs&&w.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format schema is only supported with structuredOutputs"});const S={model:this.modelId,user:this.settings.user,max_tokens:n,temperature:r,top_p:s,frequency_penalty:a,presence_penalty:o,response_format:(u==null?void 0:u.type)==="json"?this.supportsStructuredOutputs===!0&&u.schema!=null?{type:"json_schema",json_schema:{schema:u.schema,name:(h=u.name)!=null?h:"response",description:u.description}}:{type:"json_object"}:void 0,stop:c,seed:d,...l==null?void 0:l[this.providerOptionsName],reasoning_effort:(b=(m=l==null?void 0:l[this.providerOptionsName])==null?void 0:m.reasoningEffort)!=null?b:(y=l==null?void 0:l["openai-compatible"])==null?void 0:y.reasoningEffort,messages:Yve(t)};switch(x){case"regular":{const{tools:k,tool_choice:C,toolWarnings:T}=Xve({mode:e,structuredOutputs:this.supportsStructuredOutputs});return{args:{...S,tools:k,tool_choice:C},warnings:[...w,...T]}}case"object-json":return{args:{...S,response_format:this.supportsStructuredOutputs===!0&&e.schema!=null?{type:"json_schema",json_schema:{schema:e.schema,name:(v=e.name)!=null?v:"response",description:e.description}}:{type:"json_object"}},warnings:w};case"object-tool":return{args:{...S,tool_choice:{type:"function",function:{name:e.tool.name}},tools:[{type:"function",function:{name:e.tool.name,description:e.tool.description,parameters:e.tool.parameters}}]},warnings:w};default:{const k=x;throw new Error(`Unsupported type: ${k}`)}}}async doGenerate(e){var t,n,r,s,i,a,o,l,c,u,d;const{args:h,warnings:m}=this.getArgs({...e}),y=JSON.stringify(h),{responseHeaders:b,value:v,rawValue:x}=await Ws({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:Vs(this.config.headers(),e.headers),body:h,failedResponseHandler:this.failedResponseHandler,successfulResponseHandler:Ua(Qve),abortSignal:e.abortSignal,fetch:this.config.fetch}),{messages:w,...S}=h,k=v.choices[0],C={[this.providerOptionsName]:{},...(n=(t=this.config.metadataExtractor)==null?void 0:t.extractMetadata)==null?void 0:n.call(t,{parsedBody:x})},T=(r=v.usage)==null?void 0:r.completion_tokens_details,R=(s=v.usage)==null?void 0:s.prompt_tokens_details;return(T==null?void 0:T.reasoning_tokens)!=null&&(C[this.providerOptionsName].reasoningTokens=T==null?void 0:T.reasoning_tokens),(T==null?void 0:T.accepted_prediction_tokens)!=null&&(C[this.providerOptionsName].acceptedPredictionTokens=T==null?void 0:T.accepted_prediction_tokens),(T==null?void 0:T.rejected_prediction_tokens)!=null&&(C[this.providerOptionsName].rejectedPredictionTokens=T==null?void 0:T.rejected_prediction_tokens),(R==null?void 0:R.cached_tokens)!=null&&(C[this.providerOptionsName].cachedPromptTokens=R==null?void 0:R.cached_tokens),{text:(i=k.message.content)!=null?i:void 0,reasoning:(a=k.message.reasoning_content)!=null?a:void 0,toolCalls:(o=k.message.tool_calls)==null?void 0:o.map(N=>{var I;return{toolCallType:"function",toolCallId:(I=N.id)!=null?I:aa(),toolName:N.function.name,args:N.function.arguments}}),finishReason:jC(k.finish_reason),usage:{promptTokens:(c=(l=v.usage)==null?void 0:l.prompt_tokens)!=null?c:NaN,completionTokens:(d=(u=v.usage)==null?void 0:u.completion_tokens)!=null?d:NaN},providerMetadata:C,rawCall:{rawPrompt:w,rawSettings:S},rawResponse:{headers:b,body:x},response:IC(v),warnings:m,request:{body:y}}}async doStream(e){var t;if(this.settings.simulateStreaming){const b=await this.doGenerate(e);return{stream:new ReadableStream({start(x){if(x.enqueue({type:"response-metadata",...b.response}),b.reasoning)if(Array.isArray(b.reasoning))for(const w of b.reasoning)w.type==="text"&&x.enqueue({type:"reasoning",textDelta:w.text});else x.enqueue({type:"reasoning",textDelta:b.reasoning});if(b.text&&x.enqueue({type:"text-delta",textDelta:b.text}),b.toolCalls)for(const w of b.toolCalls)x.enqueue({type:"tool-call",...w});x.enqueue({type:"finish",finishReason:b.finishReason,usage:b.usage,logprobs:b.logprobs,providerMetadata:b.providerMetadata}),x.close()}}),rawCall:b.rawCall,rawResponse:b.rawResponse,warnings:b.warnings}}const{args:n,warnings:r}=this.getArgs({...e}),s={...n,stream:!0,stream_options:this.config.includeUsage?{include_usage:!0}:void 0},i=(t=this.config.metadataExtractor)==null?void 0:t.createStreamExtractor(),{responseHeaders:a,value:o}=await Ws({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:Vs(this.config.headers(),e.headers),body:s,failedResponseHandler:this.failedResponseHandler,successfulResponseHandler:zh(this.chunkSchema),abortSignal:e.abortSignal,fetch:this.config.fetch}),{messages:l,...c}=n,u=[];let d="unknown",h={completionTokens:void 0,completionTokensDetails:{reasoningTokens:void 0,acceptedPredictionTokens:void 0,rejectedPredictionTokens:void 0},promptTokens:void 0,promptTokensDetails:{cachedTokens:void 0}},m=!0,y=this.providerOptionsName;return{stream:o.pipeThrough(new TransformStream({transform(b,v){var x,w,S,k,C,T,R,N,I,P,B,D;if(!b.success){d="error",v.enqueue({type:"error",error:b.error});return}const W=b.value;if(i==null||i.processChunk(b.rawValue),"error"in W){d="error",v.enqueue({type:"error",error:W.error.message});return}if(m&&(m=!1,v.enqueue({type:"response-metadata",...IC(W)})),W.usage!=null){const{prompt_tokens:U,completion_tokens:H,prompt_tokens_details:L,completion_tokens_details:te}=W.usage;h.promptTokens=U??void 0,h.completionTokens=H??void 0,(te==null?void 0:te.reasoning_tokens)!=null&&(h.completionTokensDetails.reasoningTokens=te==null?void 0:te.reasoning_tokens),(te==null?void 0:te.accepted_prediction_tokens)!=null&&(h.completionTokensDetails.acceptedPredictionTokens=te==null?void 0:te.accepted_prediction_tokens),(te==null?void 0:te.rejected_prediction_tokens)!=null&&(h.completionTokensDetails.rejectedPredictionTokens=te==null?void 0:te.rejected_prediction_tokens),(L==null?void 0:L.cached_tokens)!=null&&(h.promptTokensDetails.cachedTokens=L==null?void 0:L.cached_tokens)}const O=W.choices[0];if((O==null?void 0:O.finish_reason)!=null&&(d=jC(O.finish_reason)),(O==null?void 0:O.delta)==null)return;const Z=O.delta;if(Z.reasoning_content!=null&&v.enqueue({type:"reasoning",textDelta:Z.reasoning_content}),Z.content!=null&&v.enqueue({type:"text-delta",textDelta:Z.content}),Z.tool_calls!=null)for(const U of Z.tool_calls){const H=U.index;if(u[H]==null){if(U.type!=="function")throw new Dd({data:U,message:"Expected 'function' type."});if(U.id==null)throw new Dd({data:U,message:"Expected 'id' to be a string."});if(((x=U.function)==null?void 0:x.name)==null)throw new Dd({data:U,message:"Expected 'function.name' to be a string."});u[H]={id:U.id,type:"function",function:{name:U.function.name,arguments:(w=U.function.arguments)!=null?w:""},hasFinished:!1};const te=u[H];((S=te.function)==null?void 0:S.name)!=null&&((k=te.function)==null?void 0:k.arguments)!=null&&(te.function.arguments.length>0&&v.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:te.id,toolName:te.function.name,argsTextDelta:te.function.arguments}),fm(te.function.arguments)&&(v.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(C=te.id)!=null?C:aa(),toolName:te.function.name,args:te.function.arguments}),te.hasFinished=!0));continue}const L=u[H];L.hasFinished||(((T=U.function)==null?void 0:T.arguments)!=null&&(L.function.arguments+=(N=(R=U.function)==null?void 0:R.arguments)!=null?N:""),v.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:L.id,toolName:L.function.name,argsTextDelta:(I=U.function.arguments)!=null?I:""}),((P=L.function)==null?void 0:P.name)!=null&&((B=L.function)==null?void 0:B.arguments)!=null&&fm(L.function.arguments)&&(v.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(D=L.id)!=null?D:aa(),toolName:L.function.name,args:L.function.arguments}),L.hasFinished=!0))}},flush(b){var v,x;const w={[y]:{},...i==null?void 0:i.buildMetadata()};h.completionTokensDetails.reasoningTokens!=null&&(w[y].reasoningTokens=h.completionTokensDetails.reasoningTokens),h.completionTokensDetails.acceptedPredictionTokens!=null&&(w[y].acceptedPredictionTokens=h.completionTokensDetails.acceptedPredictionTokens),h.completionTokensDetails.rejectedPredictionTokens!=null&&(w[y].rejectedPredictionTokens=h.completionTokensDetails.rejectedPredictionTokens),h.promptTokensDetails.cachedTokens!=null&&(w[y].cachedPromptTokens=h.promptTokensDetails.cachedTokens),b.enqueue({type:"finish",finishReason:d,usage:{promptTokens:(v=h.promptTokens)!=null?v:NaN,completionTokens:(x=h.completionTokens)!=null?x:NaN},providerMetadata:w})}})),rawCall:{rawPrompt:l,rawSettings:c},rawResponse:{headers:a},warnings:r,request:{body:JSON.stringify(s)}}}},OG=Ke({prompt_tokens:At().nullish(),completion_tokens:At().nullish(),prompt_tokens_details:Ke({cached_tokens:At().nullish()}).nullish(),completion_tokens_details:Ke({reasoning_tokens:At().nullish(),accepted_prediction_tokens:At().nullish(),rejected_prediction_tokens:At().nullish()}).nullish()}).nullish(),Qve=Ke({id:ze().nullish(),created:At().nullish(),model:ze().nullish(),choices:on(Ke({message:Ke({role:Nn("assistant").nullish(),content:ze().nullish(),reasoning_content:ze().nullish(),tool_calls:on(Ke({id:ze().nullish(),type:Nn("function"),function:Ke({name:ze(),arguments:ze()})})).nullish()}),finish_reason:ze().nullish()})),usage:OG}),exe=e=>ms([Ke({id:ze().nullish(),created:At().nullish(),model:ze().nullish(),choices:on(Ke({delta:Ke({role:xl(["assistant"]).nullish(),content:ze().nullish(),reasoning_content:ze().nullish(),tool_calls:on(Ke({index:At(),id:ze().nullish(),type:Nn("function").nullish(),function:Ke({name:ze().nullish(),arguments:ze().nullish()})})).nullish()}).nullish(),finish_reason:ze().nullish()})),usage:OG}),e]);function txe({prompt:e,inputFormat:t,user:n="user",assistant:r="assistant"}){if(t==="prompt"&&e.length===1&&e[0].role==="user"&&e[0].content.length===1&&e[0].content[0].type==="text")return{prompt:e[0].content[0].text};let s="";e[0].role==="system"&&(s+=`${e[0].content}

`,e=e.slice(1));for(const{role:i,content:a}of e)switch(i){case"system":throw new xc({message:"Unexpected system message in prompt: ${content}",prompt:e});case"user":{const o=a.map(l=>{switch(l.type){case"text":return l.text;case"image":throw new pr({functionality:"images"})}}).join("");s+=`${n}:
${o}

`;break}case"assistant":{const o=a.map(l=>{switch(l.type){case"text":return l.text;case"tool-call":throw new pr({functionality:"tool-call messages"})}}).join("");s+=`${r}:
${o}

`;break}case"tool":throw new pr({functionality:"tool messages"});default:{const o=i;throw new Error(`Unsupported role: ${o}`)}}return s+=`${r}:
`,{prompt:s,stopSequences:[`
${n}:`]}}var nxe=class{constructor(e,t,n){this.specificationVersion="v1",this.defaultObjectGenerationMode=void 0;var r;this.modelId=e,this.settings=t,this.config=n;const s=(r=n.errorStructure)!=null?r:AE;this.chunkSchema=sxe(s.errorSchema),this.failedResponseHandler=$h(s)}get provider(){return this.config.provider}get providerOptionsName(){return this.config.provider.split(".")[0].trim()}getArgs({mode:e,inputFormat:t,prompt:n,maxTokens:r,temperature:s,topP:i,topK:a,frequencyPenalty:o,presencePenalty:l,stopSequences:c,responseFormat:u,seed:d,providerMetadata:h}){var m;const y=e.type,b=[];a!=null&&b.push({type:"unsupported-setting",setting:"topK"}),u!=null&&u.type!=="text"&&b.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format is not supported."});const{prompt:v,stopSequences:x}=txe({prompt:n,inputFormat:t}),w=[...x??[],...c??[]],S={model:this.modelId,echo:this.settings.echo,logit_bias:this.settings.logitBias,suffix:this.settings.suffix,user:this.settings.user,max_tokens:r,temperature:s,top_p:i,frequency_penalty:o,presence_penalty:l,seed:d,...h==null?void 0:h[this.providerOptionsName],prompt:v,stop:w.length>0?w:void 0};switch(y){case"regular":{if((m=e.tools)!=null&&m.length)throw new pr({functionality:"tools"});if(e.toolChoice)throw new pr({functionality:"toolChoice"});return{args:S,warnings:b}}case"object-json":throw new pr({functionality:"object-json mode"});case"object-tool":throw new pr({functionality:"object-tool mode"});default:{const k=y;throw new Error(`Unsupported type: ${k}`)}}}async doGenerate(e){var t,n,r,s;const{args:i,warnings:a}=this.getArgs(e),{responseHeaders:o,value:l,rawValue:c}=await Ws({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:Vs(this.config.headers(),e.headers),body:i,failedResponseHandler:this.failedResponseHandler,successfulResponseHandler:Ua(rxe),abortSignal:e.abortSignal,fetch:this.config.fetch}),{prompt:u,...d}=i,h=l.choices[0];return{text:h.text,usage:{promptTokens:(n=(t=l.usage)==null?void 0:t.prompt_tokens)!=null?n:NaN,completionTokens:(s=(r=l.usage)==null?void 0:r.completion_tokens)!=null?s:NaN},finishReason:jC(h.finish_reason),rawCall:{rawPrompt:u,rawSettings:d},rawResponse:{headers:o,body:c},response:IC(l),warnings:a,request:{body:JSON.stringify(i)}}}async doStream(e){const{args:t,warnings:n}=this.getArgs(e),r={...t,stream:!0,stream_options:this.config.includeUsage?{include_usage:!0}:void 0},{responseHeaders:s,value:i}=await Ws({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:Vs(this.config.headers(),e.headers),body:r,failedResponseHandler:this.failedResponseHandler,successfulResponseHandler:zh(this.chunkSchema),abortSignal:e.abortSignal,fetch:this.config.fetch}),{prompt:a,...o}=t;let l="unknown",c={promptTokens:Number.NaN,completionTokens:Number.NaN},u=!0;return{stream:i.pipeThrough(new TransformStream({transform(d,h){if(!d.success){l="error",h.enqueue({type:"error",error:d.error});return}const m=d.value;if("error"in m){l="error",h.enqueue({type:"error",error:m.error});return}u&&(u=!1,h.enqueue({type:"response-metadata",...IC(m)})),m.usage!=null&&(c={promptTokens:m.usage.prompt_tokens,completionTokens:m.usage.completion_tokens});const y=m.choices[0];(y==null?void 0:y.finish_reason)!=null&&(l=jC(y.finish_reason)),(y==null?void 0:y.text)!=null&&h.enqueue({type:"text-delta",textDelta:y.text})},flush(d){d.enqueue({type:"finish",finishReason:l,usage:c})}})),rawCall:{rawPrompt:a,rawSettings:o},rawResponse:{headers:s},warnings:n,request:{body:JSON.stringify(r)}}}},rxe=Ke({id:ze().nullish(),created:At().nullish(),model:ze().nullish(),choices:on(Ke({text:ze(),finish_reason:ze()})),usage:Ke({prompt_tokens:At(),completion_tokens:At()}).nullish()}),sxe=e=>ms([Ke({id:ze().nullish(),created:At().nullish(),model:ze().nullish(),choices:on(Ke({text:ze(),finish_reason:ze().nullish(),index:At()})),usage:Ke({prompt_tokens:At(),completion_tokens:At()}).nullish()}),e]),ixe=class{constructor(e,t,n){this.specificationVersion="v1",this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}get maxEmbeddingsPerCall(){var e;return(e=this.config.maxEmbeddingsPerCall)!=null?e:2048}get supportsParallelCalls(){var e;return(e=this.config.supportsParallelCalls)!=null?e:!0}async doEmbed({values:e,headers:t,abortSignal:n}){var r;if(e.length>this.maxEmbeddingsPerCall)throw new SE({provider:this.provider,modelId:this.modelId,maxEmbeddingsPerCall:this.maxEmbeddingsPerCall,values:e});const{responseHeaders:s,value:i}=await Ws({url:this.config.url({path:"/embeddings",modelId:this.modelId}),headers:Vs(this.config.headers(),t),body:{model:this.modelId,input:e,encoding_format:"float",dimensions:this.settings.dimensions,user:this.settings.user},failedResponseHandler:$h((r=this.config.errorStructure)!=null?r:AE),successfulResponseHandler:Ua(axe),abortSignal:n,fetch:this.config.fetch});return{embeddings:i.data.map(a=>a.embedding),usage:i.usage?{tokens:i.usage.prompt_tokens}:void 0,rawResponse:{headers:s}}}},axe=Ke({data:on(Ke({embedding:on(At())})),usage:Ke({prompt_tokens:At()}).nullish()}),oxe=class{constructor(e,t,n){this.modelId=e,this.settings=t,this.config=n,this.specificationVersion="v1"}get maxImagesPerCall(){var e;return(e=this.settings.maxImagesPerCall)!=null?e:10}get provider(){return this.config.provider}async doGenerate({prompt:e,n:t,size:n,aspectRatio:r,seed:s,providerOptions:i,headers:a,abortSignal:o}){var l,c,u,d,h;const m=[];r!=null&&m.push({type:"unsupported-setting",setting:"aspectRatio",details:"This model does not support aspect ratio. Use `size` instead."}),s!=null&&m.push({type:"unsupported-setting",setting:"seed"});const y=(u=(c=(l=this.config._internal)==null?void 0:l.currentDate)==null?void 0:c.call(l))!=null?u:new Date,{value:b,responseHeaders:v}=await Ws({url:this.config.url({path:"/images/generations",modelId:this.modelId}),headers:Vs(this.config.headers(),a),body:{model:this.modelId,prompt:e,n:t,size:n,...(d=i.openai)!=null?d:{},response_format:"b64_json",...this.settings.user?{user:this.settings.user}:{}},failedResponseHandler:$h((h=this.config.errorStructure)!=null?h:AE),successfulResponseHandler:Ua(lxe),abortSignal:o,fetch:this.config.fetch});return{images:b.data.map(x=>x.b64_json),warnings:m,response:{timestamp:y,modelId:this.modelId,headers:v}}}},lxe=Ke({data:on(Ke({b64_json:ze()}))});function cxe(e){const t=g1(e.baseURL),n=e.name,r=()=>({...e.apiKey&&{Authorization:`Bearer ${e.apiKey}`},...e.headers}),s=d=>({provider:`${n}.${d}`,url:({path:h})=>{const m=new URL(`${t}${h}`);return e.queryParams&&(m.search=new URLSearchParams(e.queryParams).toString()),m.toString()},headers:r,fetch:e.fetch}),i=(d,h={})=>a(d,h),a=(d,h={})=>new Jve(d,h,{...s("chat"),defaultObjectGenerationMode:"tool"}),o=(d,h={})=>new nxe(d,h,s("completion")),l=(d,h={})=>new ixe(d,h,s("embedding")),c=(d,h={})=>new oxe(d,h,s("image")),u=(d,h)=>i(d,h);return u.languageModel=i,u.chatModel=a,u.completionModel=o,u.textEmbeddingModel=l,u.imageModel=c,u}const kx=(e,t)=>`${e}:${t}`,Tc=e=>{if(!e||!e.includes(":"))return{providerId:null,modelId:null};const t=e.split(":"),n=t[0],r=t.slice(1).join(":");return{providerId:n,modelId:r}},sy=e=>e==="openai"||e==="openrouter"||e==="google",OC=e=>e==="ollama"||e==="openai-compatible",hm=e=>e==="openai"||e==="openrouter"||e==="ollama"||e==="openai-compatible",Co=[{value:"openrouter",label:"OpenRouter"},{value:"openai",label:"OpenAI"},{value:"ollama",label:"Ollama"},{value:"openai-compatible",label:"OpenAI-Compatible (LMStudio, etc.)"},{value:"google",label:"Google Gemini"}],uxe={openai:[{id:"gpt-4o",name:"GPT-4o"},{id:"dall-e-3",name:"DALL-E 3"},{id:"dall-e-2",name:"DALL-E 2"},{id:"o3-mini",name:"o3-mini"},{id:"o4-mini",name:"o4-mini"},{id:"o4-mini-high",name:"o4-mini-high"},{id:"o3-mini-high",name:"o3-mini-high"},{id:"o3",name:"o3"},{id:"4.1",name:"4.1"},{id:"4.1-mini",name:"4.1-mini"},{id:"4.1-nano",name:"4.1-nano"},{id:"o3-pro",name:"o3-pro"},{id:"codex-mini",name:"codex-mini"}],google:[{id:"gemini-2.5-pro-preview",name:"Gemini 2.5 Pro Preview"},{id:"gemini-2.5-flash-preview-05-20:thinking",name:"Gemini 2.5 Flash Preview (Thinking)"},{id:"gemini-2.5-flash-preview",name:"Gemini 2.5 Flash Preview"},{id:"gemini-2.0-flash-001",name:"Gemini 2.0 Flash"}],openrouter:[],ollama:[{id:"llama3",name:"Llama 3 (Ollama)"}],"openai-compatible":[]},PG=e=>{try{const t=e.replace(/\/+$/,"");return/\/(v\d+(\.\d+)*)$/.test(t)?t:t+"/v1"}catch(t){return console.error("Error processing base URL:",e,t),e.replace(/\/+$/,"")}};function sP(e,t,n){try{switch(e.type){case"openai":return CG({apiKey:n})(t);case"google":return AG({apiKey:n})(t);case"openrouter":const s=IG({apiKey:n,extraBody:{include_reasoning:!0}})(t),i=s.doStream.bind(s);return s.doStream=async function(a){const o=await i(a),l=o.stream.getReader(),c=new ReadableStream({async start(u){try{for(;;){const{done:d,value:h}=await l.read();if(d)break;u.enqueue(h)}}catch(d){d&&typeof d=="object"&&"message"in d&&typeof d.message=="string"&&d.message.includes("reading 'sent'")?console.warn("[OpenRouter Provider Bug] Caught toolCall.sent error, attempting graceful recovery"):u.error(d)}finally{u.close()}}});return{...o,stream:c}},s;case"ollama":return jG({baseURL:e.baseURL??void 0})(t);case"openai-compatible":if(!e.baseURL)throw new Error("Base URL required");return cxe({baseURL:PG(e.baseURL),apiKey:n,name:e.name||"Custom API"})(t);default:return console.warn(`Unsupported provider type: ${e.type}`),null}}catch(r){return console.error(`Failed instantiate model ${t} for ${e.name}:`,r),null}}function DG(e,t,n){const s=Cr.getState().getAllAvailableModelDefsForProvider(e.id).find(a=>a.id===t);if(!s){console.warn(`Model definition not found for ${t} in provider ${e.name}`);return}const i=sP(e,t,n);if(!i){console.warn(`Failed to instantiate AI SDK instance for ${t} from provider ${e.name}`);return}return{id:kx(e.id,t),name:s.name,providerId:e.id,providerName:e.name,instance:i,metadata:s}}const FG={openai:["max_tokens","temperature","top_p","stop","presence_penalty","frequency_penalty","seed","logit_bias","response_format","tools","tool_choice","logprobs","top_logprobs"],google:["max_tokens","temperature","top_p","top_k","stop","tools","tool_choice"],ollama:["max_tokens","temperature","top_p","top_k","stop","presence_penalty","frequency_penalty","seed","repetition_penalty","response_format"],"openai-compatible":["max_tokens","temperature","top_p","stop","presence_penalty","frequency_penalty","seed","logit_bias","response_format","tools","tool_choice","logprobs","top_logprobs","repetition_penalty","min_p","top_k"],openrouter:[]},Pv=new Map,dxe=5*60*1e3,fxe=(e,t)=>{var i,a,o,l,c,u,d,h,m,y,b,v,x,w;const n=e.id||e.name,r=e.name||n,s={id:n,name:r,created:e.created??null,description:e.description??null,context_length:e.context_length??null,architecture:{modality:((i=e.architecture)==null?void 0:i.modality)??"text->text",input_modalities:((a=e.architecture)==null?void 0:a.input_modalities)??["text"],output_modalities:((o=e.architecture)==null?void 0:o.output_modalities)??["text"],tokenizer:((l=e.architecture)==null?void 0:l.tokenizer)??"Unknown",instruct_type:((c=e.architecture)==null?void 0:c.instruct_type)??null},pricing:{prompt:((u=e.pricing)==null?void 0:u.prompt)??"0",completion:((d=e.pricing)==null?void 0:d.completion)??"0",request:((h=e.pricing)==null?void 0:h.request)??"0",image:((m=e.pricing)==null?void 0:m.image)??"0",web_search:((y=e.pricing)==null?void 0:y.web_search)??"0",internal_reasoning:((b=e.pricing)==null?void 0:b.internal_reasoning)??"0"},top_provider:{context_length:((v=e.top_provider)==null?void 0:v.context_length)??e.context_length??null,max_completion_tokens:((x=e.top_provider)==null?void 0:x.max_completion_tokens)??null,is_moderated:((w=e.top_provider)==null?void 0:w.is_moderated)??!1},per_request_limits:e.per_request_limits??null,supported_parameters:e.supported_parameters??FG[t]??[]};return t==="ollama"?(s.context_length=s.context_length??4096,s.top_provider&&(s.top_provider.context_length=s.context_length),s.architecture&&(s.architecture.tokenizer="Ollama")):t==="openai"?(n.includes("gpt-4")&&(s.context_length=8192),n.includes("gpt-4-32k")&&(s.context_length=32768),n.includes("gpt-4-turbo")&&(s.context_length=128e3),n.includes("gpt-4o")&&(s.context_length=128e3),n.includes("gpt-3.5-turbo")&&(s.context_length=16385),s.top_provider&&(s.top_provider.context_length=s.context_length),s.architecture&&(s.architecture.tokenizer="OpenAI")):t==="google"?(n.includes("gemini-1.5")?s.context_length=1048576:n.includes("gemini")&&(s.context_length=32768),s.top_provider&&(s.top_provider.context_length=s.context_length),s.architecture&&(s.architecture.tokenizer="Google")):t==="openai-compatible"&&(s.context_length=s.context_length??4096,s.top_provider&&(s.top_provider.context_length=s.context_length),s.architecture&&(s.architecture.tokenizer="Compatible")),s};async function hxe(e,t){const n=`${e.id}-${e.baseURL||""}`,r=Pv.get(n);if(r)return console.log(`[ModelFetcher] Using cache for provider ${e.name} (ID: ${e.id})`),r;const s=(async()=>{var o,l,c;let i;const a={Accept:"application/json"};t&&(a.Authorization=`Bearer ${t}`);try{switch(e.type){case"openai":if(!t)throw new Error("API Key required for OpenAI");i="https://api.openai.com/v1/models";break;case"openrouter":if(!t)throw new Error("API Key required for OpenRouter");i="https://openrouter.ai/api/v1/models",a["HTTP-Referer"]=((o=globalThis.location)==null?void 0:o.origin)||"http://localhost:3000",a["X-Title"]="LiteChat";break;case"ollama":const u=((l=e.baseURL)==null?void 0:l.replace(/\/$/,""))||"http://localhost:11434";i=new URL("/api/tags",u).toString(),delete a.Authorization;break;case"openai-compatible":if(!e.baseURL)throw new Error("Base URL required for OpenAI-Compatible");const d=PG(e.baseURL);i=new URL("models",d.endsWith("/")?d:d+"/").toString();break;case"google":default:return console.log(`[ModelFetcher] Model fetching not supported via API for type: ${e.type}. Returning empty list.`),[]}}catch(u){return console.error(`[ModelFetcher] Error constructing URL for ${e.name}:`,u),Me.error(`Invalid Base URL for ${e.name}: ${u instanceof Error?u.message:String(u)}`),[]}console.log(`[ModelFetcher] Fetching models for ${e.name} (Type: ${e.type}) from ${i}`);try{const u=await fetch(i,{headers:a});if(!u.ok){let y=`(${u.status} ${u.statusText})`;try{const b=await u.text();y=b||y;try{const v=JSON.parse(b);y=((c=v==null?void 0:v.error)==null?void 0:c.message)||(v==null?void 0:v.message)||y}catch{}}catch(b){console.warn("[ModelFetcher] Failed to read error response body:",b)}throw new Error(`API Error: ${y}`)}const d=await u.json();let h=[];if(e.type==="ollama"?h=d.models||[]:h=d.data||d||[],!Array.isArray(h))return console.warn(`[ModelFetcher] Unexpected non-array response for ${e.name}:`,d),[];const m=h.map(y=>fxe(y,e.type));return m.sort((y,b)=>(y.name||y.id).localeCompare(b.name||b.id)),console.log(`[ModelFetcher] Fetched and mapped ${m.length} models for ${e.name}`),m}catch(u){const d=u instanceof Error?u.message:String(u);return console.error(`[ModelFetcher] Error fetching models for ${e.name}:`,d),Me.error(`Failed to fetch models for ${e.name}: ${d}`),Pv.delete(n),[]}})();return Pv.set(n,s),setTimeout(()=>{Pv.get(n)===s&&(Pv.delete(n),console.log(`[ModelFetcher] Cache expired for provider ${e.name} (ID: ${e.id})`))},dxe),s}const Qn={initialDataLoaded:"provider.initial.data.loaded",configsChanged:"provider.configs.changed",apiKeysChanged:"provider.api.keys.changed",selectedModelChanged:"provider.selected.model.changed",globalModelSortOrderChanged:"provider.global.model.sort.order.changed",fetchStatusChanged:"provider.fetch.status.changed",globallyEnabledModelsUpdated:"provider.globally.enabled.models.updated",selectedModelForDetailsChanged:"provider.selected.model.for.details.changed",enableApiKeyManagementChanged:"provider.enable.api.key.management.changed",loadInitialDataRequest:"provider.load.initial.data.request",selectModelRequest:"provider.select.model.request",addApiKeyRequest:"provider.add.api.key.request",deleteApiKeyRequest:"provider.delete.api.key.request",addProviderConfigRequest:"provider.add.config.request",updateProviderConfigRequest:"provider.update.config.request",deleteProviderConfigRequest:"provider.delete.config.request",fetchModelsRequest:"provider.fetch.models.request",setGlobalModelSortOrderRequest:"provider.set.global.model.sort.order.request",setEnableApiKeyManagementRequest:"provider.set.enable.api.key.management.request",setSelectedModelForDetailsRequest:"provider.set.selected.model.for.details.request"},kN="provider:lastModelSelection",x$="provider:globalModelSortOrder",Cr=qo(Vo((e,t)=>({dbProviderConfigs:[],dbApiKeys:[],selectedModelId:null,globalModelSortOrder:[],providerFetchStatus:{},isLoading:!0,error:null,enableApiKeyManagement:!0,_selectedModelForDetails:null,globallyEnabledModelDefinitions:[],_updateGloballyEnabledModelDefinitions:()=>{const{dbProviderConfigs:n,globalModelSortOrder:r}=t(),s=t().getAvailableModelListItems(),i=new Map(s.map(u=>[u.id,u])),a=new Set;n.forEach(u=>{u.isEnabled&&u.enabledModels&&u.enabledModels.forEach(d=>{a.add(kx(u.id,d))})});const o=[],l=new Set;r.forEach(u=>{if(a.has(u)){const d=i.get(u);d&&!l.has(u)&&(o.push(d),l.add(u))}});const c=s.filter(u=>a.has(u.id)&&!l.has(u.id)).sort((u,d)=>u.name.localeCompare(d.name));o.push(...c),e({globallyEnabledModelDefinitions:o}),Pe.emit(Qn.globallyEnabledModelsUpdated,{models:o})},getGloballyEnabledModelDefinitions:()=>t().globallyEnabledModelDefinitions,createAiModelConfig:(n,r,s)=>{const a=t().getAllAvailableModelDefsForProvider(n.id).find(l=>l.id===r);if(!a){console.warn(`Model definition not found for ${r} in provider ${n.name}`);return}const o=sP(n,r,s);if(!o){console.warn(`Failed to instantiate AI SDK instance for ${r} from provider ${n.name}`);return}return{id:kx(n.id,r),name:a.name,providerId:n.id,providerName:n.name,instance:o,metadata:a}},setEnableApiKeyManagement:n=>{e({enableApiKeyManagement:n}),_t.saveSetting("enableApiKeyManagement",n),Pe.emit(Qn.enableApiKeyManagementChanged,{enabled:n})},loadInitialData:async()=>{e({isLoading:!0,error:null});try{const n=await _t.loadSetting("enableApiKeyManagement",!0),[r,s,i,a]=await Promise.all([_t.loadProviderConfigs(),_t.loadApiKeys(),_t.loadSetting(x$,[]),_t.loadSetting(kN,null)]);e({dbProviderConfigs:r,dbApiKeys:s,enableApiKeyManagement:n,globalModelSortOrder:i}),t()._updateGloballyEnabledModelDefinitions();const o=t().globallyEnabledModelDefinitions.map(d=>d.id),l=new Set(o);let c=a;c&&l.has(c)||(c=o[0]??null),e({selectedModelId:c,isLoading:!1}),await _t.saveSetting(kN,c),Pe.emit(Qn.initialDataLoaded,{configs:r,apiKeys:s,selectedModelId:c,globalSortOrder:t().globalModelSortOrder}),t().selectedModelId!==c?t().selectModel(c):Pe.emit(Qn.selectedModelChanged,{modelId:c})}catch(n){console.error("ProviderStore: Error loading initial data",n),e({isLoading:!1,error:"Failed to load provider data"}),Me.error("Failed to load provider data")}},selectModel:n=>{t().selectedModelId!==n&&(e({selectedModelId:n}),_t.saveSetting(kN,n),Pe.emit(Qn.selectedModelChanged,{modelId:n}))},addApiKey:async(n,r,s)=>{const i=as(),a=new Date,o={id:i,name:n,value:s,providerId:r,createdAt:a,updatedAt:a};try{return await _t.saveApiKey(o),e(l=>{l.dbApiKeys.push(o)}),Me.success(`API Key "${n}" added.`),Pe.emit(Qn.apiKeysChanged,{apiKeys:t().dbApiKeys}),i}catch(l){throw console.error("ProviderStore: Error adding API key",l),Me.error(`Failed to add API Key: ${l instanceof Error?l.message:String(l)}`),l}},deleteApiKey:async n=>{var s;const r=((s=t().dbApiKeys.find(i=>i.id===n))==null?void 0:s.name)??"Unknown Key";try{await _t.deleteApiKey(n),e(i=>{i.dbApiKeys=i.dbApiKeys.filter(a=>a.id!==n),i.dbProviderConfigs=i.dbProviderConfigs.map(a=>a.apiKeyId===n?{...a,apiKeyId:null}:a)}),Me.success(`API Key "${r}" deleted.`),Pe.emit(Qn.apiKeysChanged,{apiKeys:t().dbApiKeys}),Pe.emit(Qn.configsChanged,{providerConfigs:t().dbProviderConfigs})}catch(i){throw console.error("ProviderStore: Error deleting API key",i),Me.error(`Failed to delete API Key: ${i instanceof Error?i.message:String(i)}`),i}},addProviderConfig:async n=>{const r=as(),s=new Date,i={id:r,createdAt:s,updatedAt:s,name:n.name,type:n.type,isEnabled:n.isEnabled??!0,apiKeyId:n.apiKeyId??null,baseURL:n.baseURL??null,enabledModels:n.enabledModels??null,autoFetchModels:n.autoFetchModels??!0,fetchedModels:n.fetchedModels??null,modelsLastFetchedAt:n.modelsLastFetchedAt??null};try{return await _t.saveProviderConfig(i),e(a=>{a.dbProviderConfigs.push(i)}),t()._updateGloballyEnabledModelDefinitions(),Me.success(`Provider "${n.name}" added.`),Pe.emit(Qn.configsChanged,{providerConfigs:t().dbProviderConfigs}),t().fetchModels(r).catch(a=>{console.warn(`[ProviderStore] Initial model fetch failed for new provider ${r}:`,a)}),r}catch(a){throw console.error("ProviderStore: Error adding provider config",a),Me.error(`Failed to add Provider: ${a instanceof Error?a.message:String(a)}`),a}},updateProviderConfig:async(n,r)=>{const s=t().dbProviderConfigs.find(a=>a.id===n);if(!s)return;const i={...s,...r,fetchedModels:r.fetchedModels!==void 0?r.fetchedModels:s.fetchedModels,modelsLastFetchedAt:r.modelsLastFetchedAt!==void 0?r.modelsLastFetchedAt:s.modelsLastFetchedAt,updatedAt:new Date};try{await _t.saveProviderConfig(i),e(a=>{const o=a.dbProviderConfigs.findIndex(l=>l.id===n);o!==-1&&(a.dbProviderConfigs[o]=i)}),t()._updateGloballyEnabledModelDefinitions(),Pe.emit(Qn.configsChanged,{providerConfigs:t().dbProviderConfigs})}catch(a){throw console.error("ProviderStore: Error updating provider config",a),Me.error(`Failed to update Provider: ${a instanceof Error?a.message:String(a)}`),a}},deleteProviderConfig:async n=>{const r=t().dbProviderConfigs.find(i=>i.id===n);if(!r)return;const s=r.name;try{await _t.deleteProviderConfig(n),e(i=>{i.dbProviderConfigs=i.dbProviderConfigs.filter(a=>a.id!==n),delete i.providerFetchStatus[n]}),t()._updateGloballyEnabledModelDefinitions(),Pe.emit(Qn.configsChanged,{providerConfigs:t().dbProviderConfigs}),Me.success(`Provider "${s}" deleted.`)}catch(i){throw console.error("ProviderStore: Error deleting provider config",i),Me.error(`Failed to delete Provider: ${i instanceof Error?i.message:String(i)}`),i}},fetchModels:async n=>{var s;const r=t().dbProviderConfigs.find(i=>i.id===n);if(!r){Me.error("Provider configuration not found for fetching models.");return}if(t().providerFetchStatus[n]!=="fetching"){t()._setProviderFetchStatus(n,"fetching");try{const i=r.apiKeyId,a=(s=t().dbApiKeys.find(l=>l.id===i))==null?void 0:s.value,o=await hxe(r,a);await t().updateProviderConfig(n,{fetchedModels:o,modelsLastFetchedAt:new Date}),t()._setProviderFetchStatus(n,"success"),Me.success(`Models fetched successfully for ${r.name}`)}catch(i){console.error(`Error fetching models for ${r.name}:`,i),t()._setProviderFetchStatus(n,"error")}}},setGlobalModelSortOrder:async n=>{const r=Array.from(new Set(n));e({globalModelSortOrder:r}),await _t.saveSetting(x$,r),t()._updateGloballyEnabledModelDefinitions(),Pe.emit(Qn.globalModelSortOrderChanged,{ids:r});const s=t().selectedModelId,i=t().globallyEnabledModelDefinitions.map(o=>o.id),a=new Set(i);if(!s||!a.has(s)){const o=i[0]??null;o!==s&&t().selectModel(o)}},_setProviderFetchStatus:(n,r)=>{e(s=>{s.providerFetchStatus[n]=r}),Pe.emit(Qn.fetchStatusChanged,{providerId:n,status:r})},setSelectedModelForDetails:n=>{e({_selectedModelForDetails:n}),Pe.emit(Qn.selectedModelForDetailsChanged,{modelId:n})},getSelectedModel:()=>{const{selectedModelId:n}=t();if(!n)return;const{providerId:r,modelId:s}=Tc(n);if(!r||!s)return;const i=t().dbProviderConfigs.find(o=>o.id===r);if(!i)return;const a=t().dbApiKeys.find(o=>o.id===i.apiKeyId);return t().createAiModelConfig(i,s,a==null?void 0:a.value)},getApiKeyForProvider:n=>{var s;const r=t().dbProviderConfigs.find(i=>i.id===n);return(s=t().dbApiKeys.find(i=>i.id===(r==null?void 0:r.apiKeyId)))==null?void 0:s.value},getActiveProviders:()=>t().dbProviderConfigs.filter(n=>n.isEnabled).map(n=>{const r=t().getAllAvailableModelDefsForProvider(n.id);return{id:n.id,name:n.name,type:n.type,allAvailableModels:r}}),getAllAvailableModelDefsForProvider:n=>{const r=t().dbProviderConfigs.find(a=>a.id===n);if(!r)return[];if(r.fetchedModels&&r.fetchedModels.length>0)return[...r.fetchedModels];const s=r.type;return(uxe[s]||[]).map(a=>{let o="text->text",l=["text"],c=["text"];return(a.id.includes("dall-e")||a.id.includes("imagen")||a.id.includes("flux")||a.id.includes("stable-diffusion"))&&(o="text->image",l=["text"],c=["image"]),{id:a.id,name:a.name,context_length:4096,architecture:{modality:o,input_modalities:l,output_modalities:c},pricing:{prompt:"0",completion:"0"},top_provider:{context_length:4096},supported_parameters:FG[r.type]??[]}})},getAvailableModelListItems:()=>{const{dbProviderConfigs:n}=t(),r=[];return n.forEach(s=>{t().getAllAvailableModelDefsForProvider(s.id).forEach(a=>{var o,l,c;r.push({id:kx(s.id,a.id),name:a.name,providerId:s.id,providerName:s.name,metadataSummary:{context_length:((o=a.top_provider)==null?void 0:o.context_length)??a.context_length,supported_parameters:a.supported_parameters,input_modalities:(l=a.architecture)==null?void 0:l.input_modalities,output_modalities:(c=a.architecture)==null?void 0:c.output_modalities,pricing:a.pricing,description:a.description}})})}),r},getRegisteredActionHandlers:()=>{const n="providerStore",r=t();return[{eventName:Qn.loadInitialDataRequest,handler:r.loadInitialData,storeId:n},{eventName:Qn.selectModelRequest,handler:s=>r.selectModel(s.modelId),storeId:n},{eventName:Qn.addApiKeyRequest,handler:s=>r.addApiKey(s.name,s.providerId,s.value).then(()=>{}),storeId:n},{eventName:Qn.deleteApiKeyRequest,handler:s=>r.deleteApiKey(s.id),storeId:n},{eventName:Qn.addProviderConfigRequest,handler:s=>r.addProviderConfig(s).then(()=>{}),storeId:n},{eventName:Qn.updateProviderConfigRequest,handler:s=>r.updateProviderConfig(s.id,s.changes),storeId:n},{eventName:Qn.deleteProviderConfigRequest,handler:s=>r.deleteProviderConfig(s.id),storeId:n},{eventName:Qn.fetchModelsRequest,handler:s=>r.fetchModels(s.providerConfigId),storeId:n},{eventName:Qn.setGlobalModelSortOrderRequest,handler:s=>r.setGlobalModelSortOrder(s.ids),storeId:n},{eventName:Qn.setEnableApiKeyManagementRequest,handler:s=>r.setEnableApiKeyManagement(s.enabled),storeId:n},{eventName:Qn.setSelectedModelForDetailsRequest,handler:s=>r.setSelectedModelForDetails(s.modelId),storeId:n}]}}))),sn={loaded:"settings.loaded",themeChanged:"settings.theme.changed",globalSystemPromptChanged:"settings.global.system.prompt.changed",temperatureChanged:"settings.temperature.changed",maxTokensChanged:"settings.max.tokens.changed",topPChanged:"settings.top.p.changed",topKChanged:"settings.top.k.changed",presencePenaltyChanged:"settings.presence.penalty.changed",frequencyPenaltyChanged:"settings.frequency.penalty.changed",enableAdvancedSettingsChanged:"settings.enable.advanced.settings.changed",enableStreamingMarkdownChanged:"settings.enable.streaming.markdown.changed",enableStreamingCodeBlockParsingChanged:"settings.enable.streaming.code.block.parsing.changed",foldStreamingCodeBlocksChanged:"settings.fold.streaming.code.blocks.changed",foldUserMessagesOnCompletionChanged:"settings.fold.user.messages.on.completion.changed",streamingRenderFpsChanged:"settings.streaming.render.fps.changed",gitUserNameChanged:"settings.git.user.name.changed",gitUserEmailChanged:"settings.git.user.email.changed",toolMaxStepsChanged:"settings.tool.max.steps.changed",prismThemeUrlChanged:"settings.prism.theme.url.changed",autoTitleEnabledChanged:"settings.auto.title.enabled.changed",autoTitleModelIdChanged:"settings.auto.title.model.id.changed",autoTitlePromptMaxLengthChanged:"settings.auto.title.prompt.max.length.changed",autoTitleIncludeFilesChanged:"settings.auto.title.include.files.changed",autoTitleIncludeRulesChanged:"settings.auto.title.include.rules.changed",customFontFamilyChanged:"settings.custom.font.family.changed",customFontSizeChanged:"settings.custom.font.size.changed",chatMaxWidthChanged:"settings.chat.max.width.changed",customThemeColorsChanged:"settings.custom.theme.colors.changed",autoScrollIntervalChanged:"settings.auto.scroll.interval.changed",enableAutoScrollOnStreamChanged:"settings.enable.auto.scroll.on.stream.changed",autoSyncOnStreamCompleteChanged:"settings.auto.sync.on.stream.complete.changed",autoInitializeReposOnStartupChanged:"settings.auto.initialize.repos.on.startup.changed",setThemeRequest:"settings.set.theme.request",setGlobalSystemPromptRequest:"settings.set.global.system.prompt.request",setTemperatureRequest:"settings.set.temperature.request",setMaxTokensRequest:"settings.set.max.tokens.request",setTopPRequest:"settings.set.top.p.request",setTopKRequest:"settings.set.top.k.request",setPresencePenaltyRequest:"settings.set.presence.penalty.request",setFrequencyPenaltyRequest:"settings.set.frequency.penalty.request",setEnableAdvancedSettingsRequest:"settings.set.enable.advanced.settings.request",setEnableStreamingMarkdownRequest:"settings.set.enable.streaming.markdown.request",setEnableStreamingCodeBlockParsingRequest:"settings.set.enable.streaming.code.block.parsing.request",setFoldStreamingCodeBlocksRequest:"settings.set.fold.streaming.code.blocks.request",setFoldUserMessagesOnCompletionRequest:"settings.set.fold.user.messages.on.completion.request",setStreamingRenderFpsRequest:"settings.set.streaming.render.fps.request",setGitUserNameRequest:"settings.set.git.user.name.request",setGitUserEmailRequest:"settings.set.git.user.email.request",setToolMaxStepsRequest:"settings.set.tool.max.steps.request",setPrismThemeUrlRequest:"settings.set.prism.theme.url.request",setAutoTitleEnabledRequest:"settings.set.auto.title.enabled.request",setAutoTitleModelIdRequest:"settings.set.auto.title.model.id.request",setAutoTitlePromptMaxLengthRequest:"settings.set.auto.title.prompt.max.length.request",setAutoTitleIncludeFilesRequest:"settings.set.auto.title.include.files.request",setAutoTitleIncludeRulesRequest:"settings.set.auto.title.include.rules.request",setCustomFontFamilyRequest:"settings.set.custom.font.family.request",setCustomFontSizeRequest:"settings.set.custom.font.size.request",setChatMaxWidthRequest:"settings.set.chat.max.width.request",setCustomThemeColorsRequest:"settings.set.custom.theme.colors.request",setCustomThemeColorRequest:"settings.set.custom.theme.color.request",setAutoScrollIntervalRequest:"settings.set.auto.scroll.interval.request",setEnableAutoScrollOnStreamRequest:"settings.set.enable.auto.scroll.on.stream.request",setAutoSyncOnStreamCompleteRequest:"settings.set.auto.sync.on.stream.complete.request",setAutoInitializeReposOnStartupRequest:"settings.set.auto.initialize.repos.on.startup.request",loadSettingsRequest:"settings.load.settings.request",resetGeneralSettingsRequest:"settings.reset.general.settings.request",resetAssistantSettingsRequest:"settings.reset.assistant.settings.request",resetThemeSettingsRequest:"settings.reset.theme.settings.request"},pxe=`You are a helpful AI assistant used in LiteChat.

You are knowledgeable, friendly, and always strive to provide accurate and useful information. When you don't know something, you admit it honestly. You communicate clearly and concisely, adapting your tone to be appropriate for the context.

##Key principles
- Be helpful and respectful
- Provide accurate information
- Ask clarifying questions when needed
- Explain complex concepts clearly
- Acknowledge limitations honestly 


##Litechat codeblock support

### downloadable codeblocks

If you create gated blocks and you can infer a filepath or a name for it, you should create it as follow : 

\`\`\`language:relative/path/to/file.ext
The file content would be completely normal
\`\`\`

examples : 
\`\`\`jsx:src/components/button.jsx
export const Button = ({ children, onClick }) => {
  return <button onClick={onClick}>{children}</button>;
};
\`\`\`

\`\`\`markdown:readme.md
---
title: My Project
description: This is a project description
---

# My Project

This is a project description
\`\`\`

### MermaidJS diagrams

Litechat support MermaidJS diagrams. only valid uncommented diagrams are supported.
For example, if a user asks you a simple explanation on http request, you should use a sequence diagram like so : 
\`\`\`mermaid
sequenceDiagram
    participant Client as "Web Browser"
    participant Server as "Web Server"

    Note over Client,Server: User initiates HTTP request
    Client->>Server: HTTP Request (GET /index.html)
    Server->>Server: Process request
    Server->>Client: HTTP Response (200 OK, HTML content)
    Note over Client,Server: User receives response
\`\`\`

### Formedible codeblocks

For guided deterministic interaction with the user through a form, you can use the \`formedible\` codeblock.

**Functionality:**
- The \`formedible\` block interprets a JavaScript object literal that defines a form structure.
- It supports multi-page forms, various input field types (text, number, select, checkbox, etc.), progress indicators, and labels.
- For security reasons, the rendered forms are **read-only** and **cannot execute any custom code or callback functions** (like \`onSubmit\`). Their primary purpose is for previewing and understanding form layouts and data structures.

**Usage:**
To generate a formedible block, enclose your form definition within a markdown code block with the language identifier \`formedible\`.

**Expected Content Format:**
The content inside the \`formedible\` block must be a single JavaScript object literal containing the form's configuration. This object can include the following top-level keys:
- \`schema\`: A \`z.object()\` definition (e.g., \`z.object({ fieldName: z.string().min(1) })\`). You can use basic Zod types. Complex Zod methods or custom functions are not supported and will be ignored or cause parsing errors.
- \`fields\`: An array of field objects. Each field object requires \`name\` (string) and \`type\` (string). Supported types are: \`text\`, \`email\`, \`password\`, \`url\`, \`tel\`, \`textarea\`, \`select\`, \`checkbox\`, \`switch\`, \`number\`, \`date\`, \`slider\`, \`file\`. Additional properties like \`label\`, \`placeholder\`, \`description\`, \`options\`, \`min\`, \`max\`, \`step\`, \`accept\`, \`multiple\`, and \`page\` can be included.
- \`pages\`: (Optional) An array of page objects for multi-page forms. Each page object requires \`page\` (number). \`title\` and \`description\` are optional.
- \`progress\`: (Optional) An object to configure the progress bar, e.g., \`{ showSteps: true, showPercentage: true }\`.
- \`submitLabel\`, \`nextLabel\`, \`previousLabel\`: (Optional) Strings for navigation button labels.
- \`formClassName\`, \`fieldClassName\`: (Optional) Strings for CSS classes.
- \`formOptions\`: (Optional) An object for basic form options. Only \`defaultValues\`, \`asyncDebounceMs\`, and \`canSubmitWhenInvalid\` are supported. Any \`onSubmit\` or other callback functions will be ignored and replaced with a disabled toast message.

**Examples:**

simple: 
\`\`\`formedible
{
  schema: z.object({
    taskName: z.string().min(3, "Task name is required"),
    priority: z.enum(["low", "medium", "high"]),
    dueDate: z.string().optional(),
    isCompleted: z.boolean(),
  }),
  fields: [
    { name: "taskName", type: "text", label: "Task Name", placeholder: "e.g., Finish report" },
    { name: "priority", type: "select", label: "Priority", options: ["low", "medium", "high"] },
    { name: "dueDate", type: "date", label: "Due Date" },
    { name: "isCompleted", type: "checkbox", label: "Mark as Completed" },
  ],
  submitLabel: "Save Task",
  formOptions: {
    defaultValues: {
      taskName: "",
      priority: "medium",
      isCompleted: false,
    }
  }
}
\`\`\`
with pages :
\`\`\`formedible
{
  schema: z.object({
    firstName: z.string().min(1, "First name is required"),
    lastName: z.string().min(1, "Last name is required"),
    email: z.string().email("Invalid email"),
    age: z.number().min(18, "Must be 18 or older"),
    bio: z.string().min(10, "Bio must be at least 10 characters"),
    notifications: z.boolean(),
  }),
  fields: [
    { name: "firstName", type: "text", label: "First Name", page: 1 },
    { name: "lastName", type: "text", label: "Last Name", page: 1 },
    { name: "email", type: "email", label: "Email", page: 2 },
    { name: "age", type: "number", label: "Age", min: 18, max: 120, page: 2 },
    { name: "bio", type: "textarea", label: "Bio", page: 3 },
    { name: "notifications", type: "switch", label: "Enable notifications", page: 3 },
  ],
  pages: [
    { page: 1, title: "Personal Info", description: "Tell us about yourself" },
    { page: 2, title: "Contact Details", description: "How can we reach you?" },
    { page: 3, title: "Preferences", description: "Customize your experience" },
  ],
  progress: { showSteps: true, showPercentage: true },
  nextLabel: "Continue ",
  previousLabel: " Back",
  submitLabel: "Complete Registration",
  formOptions: {
    defaultValues: {
      firstName: "",
      lastName: "",
      email: "",
      age: 18,
      bio: "",
      notifications: true,
    },
  },
}
\`\`\``,EN="system",TN=pxe,AN=.7,RN=null,NN=null,MN=null,IN=0,jN=0,w$=!0,ON=!0,PN=!0,DN=!1,FN=!1,LN=15,_$=null,S$=null,BN=5,$N=null,zN=!0,UN=null,qN=768,VN=!1,WN=!1,HN=null,GN=16,KN="max-w-7xl",YN=null,ZN=1e3,XN=!0,C$=!1,k$=!1,br=qo(Vo((e,t)=>({theme:EN,globalSystemPrompt:TN,temperature:AN,maxTokens:RN,topP:NN,topK:MN,presencePenalty:IN,frequencyPenalty:jN,enableAdvancedSettings:w$,enableStreamingMarkdown:ON,enableStreamingCodeBlockParsing:PN,foldStreamingCodeBlocks:DN,foldUserMessagesOnCompletion:FN,streamingRenderFPS:LN,gitUserName:_$,gitUserEmail:S$,toolMaxSteps:BN,prismThemeUrl:$N,autoTitleEnabled:zN,autoTitleModelId:UN,autoTitlePromptMaxLength:qN,autoTitleIncludeFiles:VN,autoTitleIncludeRules:WN,customFontFamily:HN,customFontSize:GN,chatMaxWidth:KN,customThemeColors:YN,autoScrollInterval:ZN,enableAutoScrollOnStream:XN,autoSyncOnStreamComplete:C$,autoInitializeReposOnStartup:k$,setTheme:n=>{e({theme:n}),_t.saveSetting("theme",n),Pe.emit(sn.themeChanged,{theme:n})},setGlobalSystemPrompt:n=>{e({globalSystemPrompt:n}),_t.saveSetting("globalSystemPrompt",n),Pe.emit(sn.globalSystemPromptChanged,{prompt:n})},setTemperature:n=>{e({temperature:n}),_t.saveSetting("temperature",n),Pe.emit(sn.temperatureChanged,{value:n})},setMaxTokens:n=>{e({maxTokens:n}),_t.saveSetting("maxTokens",n),Pe.emit(sn.maxTokensChanged,{value:n})},setTopP:n=>{e({topP:n}),_t.saveSetting("topP",n),Pe.emit(sn.topPChanged,{value:n})},setTopK:n=>{e({topK:n}),_t.saveSetting("topK",n),Pe.emit(sn.topKChanged,{value:n})},setPresencePenalty:n=>{e({presencePenalty:n}),_t.saveSetting("presencePenalty",n),Pe.emit(sn.presencePenaltyChanged,{value:n})},setFrequencyPenalty:n=>{e({frequencyPenalty:n}),_t.saveSetting("frequencyPenalty",n),Pe.emit(sn.frequencyPenaltyChanged,{value:n})},setEnableAdvancedSettings:n=>{e({enableAdvancedSettings:n}),_t.saveSetting("enableAdvancedSettings",n),Pe.emit(sn.enableAdvancedSettingsChanged,{enabled:n})},setEnableStreamingMarkdown:n=>{e({enableStreamingMarkdown:n}),_t.saveSetting("enableStreamingMarkdown",n),Pe.emit(sn.enableStreamingMarkdownChanged,{enabled:n})},setEnableStreamingCodeBlockParsing:n=>{e({enableStreamingCodeBlockParsing:n}),_t.saveSetting("enableStreamingCodeBlockParsing",n),Pe.emit(sn.enableStreamingCodeBlockParsingChanged,{enabled:n})},setFoldStreamingCodeBlocks:n=>{e({foldStreamingCodeBlocks:n}),_t.saveSetting("foldStreamingCodeBlocks",n),Pe.emit(sn.foldStreamingCodeBlocksChanged,{fold:n})},setFoldUserMessagesOnCompletion:n=>{e({foldUserMessagesOnCompletion:n}),_t.saveSetting("foldUserMessagesOnCompletion",n),Pe.emit(sn.foldUserMessagesOnCompletionChanged,{fold:n})},setStreamingRenderFPS:n=>{const r=Math.max(3,Math.min(60,n));e({streamingRenderFPS:r}),_t.saveSetting("streamingRenderFPS",r),Pe.emit(sn.streamingRenderFpsChanged,{fps:r})},setGitUserName:n=>{const r=(n==null?void 0:n.trim())||null;e({gitUserName:r}),_t.saveSetting("gitUserName",r),Pe.emit(sn.gitUserNameChanged,{name:r})},setGitUserEmail:n=>{const r=(n==null?void 0:n.trim())||null;e({gitUserEmail:r}),_t.saveSetting("gitUserEmail",r),Pe.emit(sn.gitUserEmailChanged,{email:r})},setToolMaxSteps:n=>{const r=Math.max(1,Math.min(20,n));e({toolMaxSteps:r}),_t.saveSetting("toolMaxSteps",r),Pe.emit(sn.toolMaxStepsChanged,{steps:r})},setPrismThemeUrl:n=>{const r=(n==null?void 0:n.trim())||null;e({prismThemeUrl:r}),_t.saveSetting("prismThemeUrl",r),Pe.emit(sn.prismThemeUrlChanged,{url:r})},setAutoTitleEnabled:n=>{e({autoTitleEnabled:n}),_t.saveSetting("autoTitleEnabled",n),Pe.emit(sn.autoTitleEnabledChanged,{enabled:n})},setAutoTitleModelId:n=>{e({autoTitleModelId:n}),_t.saveSetting("autoTitleModelId",n),Pe.emit(sn.autoTitleModelIdChanged,{modelId:n})},setAutoTitlePromptMaxLength:n=>{const r=Math.max(100,Math.min(4e3,n));e({autoTitlePromptMaxLength:r}),_t.saveSetting("autoTitlePromptMaxLength",r),Pe.emit(sn.autoTitlePromptMaxLengthChanged,{length:r})},setAutoTitleIncludeFiles:n=>{e({autoTitleIncludeFiles:n}),_t.saveSetting("autoTitleIncludeFiles",n),Pe.emit(sn.autoTitleIncludeFilesChanged,{include:n})},setAutoTitleIncludeRules:n=>{e({autoTitleIncludeRules:n}),_t.saveSetting("autoTitleIncludeRules",n),Pe.emit(sn.autoTitleIncludeRulesChanged,{include:n})},setCustomFontFamily:n=>{const r=(n==null?void 0:n.trim())||null;e({customFontFamily:r}),_t.saveSetting("customFontFamily",r),Pe.emit(sn.customFontFamilyChanged,{fontFamily:r})},setCustomFontSize:n=>{const r=n===null?null:Math.max(10,Math.min(24,n));e({customFontSize:r}),_t.saveSetting("customFontSize",r),Pe.emit(sn.customFontSizeChanged,{fontSize:r})},setChatMaxWidth:n=>{e({chatMaxWidth:n}),_t.saveSetting("chatMaxWidth",n),Pe.emit(sn.chatMaxWidthChanged,{maxWidth:n})},setCustomThemeColors:n=>{e({customThemeColors:n}),_t.saveSetting("customThemeColors",n),Pe.emit(sn.customThemeColorsChanged,{colors:n})},setCustomThemeColor:(n,r)=>{e(i=>{const o={...i.customThemeColors??{}};r===null||r.trim()===""?delete o[n]:o[n]=r.trim(),i.customThemeColors=Object.keys(o).length>0?o:null});const s=t().customThemeColors;_t.saveSetting("customThemeColors",s),Pe.emit(sn.customThemeColorsChanged,{colors:s})},setAutoScrollInterval:n=>{const r=Math.max(50,n);e({autoScrollInterval:r}),_t.saveSetting("autoScrollInterval",r),Pe.emit(sn.autoScrollIntervalChanged,{interval:r})},setEnableAutoScrollOnStream:n=>{e({enableAutoScrollOnStream:n}),_t.saveSetting("enableAutoScrollOnStream",n),Pe.emit(sn.enableAutoScrollOnStreamChanged,{enabled:n})},setAutoSyncOnStreamComplete:n=>{e({autoSyncOnStreamComplete:n}),_t.saveSetting("autoSyncOnStreamComplete",n),Pe.emit(sn.autoSyncOnStreamCompleteChanged,{enabled:n})},setAutoInitializeReposOnStartup:n=>{e({autoInitializeReposOnStartup:n}),_t.saveSetting("autoInitializeReposOnStartup",n),Pe.emit(sn.autoInitializeReposOnStartupChanged,{enabled:n})},loadSettings:async()=>{try{const[n,r,s,i,a,o,l,c,u,d,h,m,y,b,v,x,w,S,k,C,T,R,N,I,P,B,D,W,O,Z,U]=await Promise.all([_t.loadSetting("theme",EN),_t.loadSetting("temperature",AN),_t.loadSetting("maxTokens",RN),_t.loadSetting("topP",NN),_t.loadSetting("topK",MN),_t.loadSetting("presencePenalty",IN),_t.loadSetting("frequencyPenalty",jN),_t.loadSetting("globalSystemPrompt",TN),_t.loadSetting("enableAdvancedSettings",w$),_t.loadSetting("enableStreamingMarkdown",ON),_t.loadSetting("enableStreamingCodeBlockParsing",PN),_t.loadSetting("foldStreamingCodeBlocks",DN),_t.loadSetting("foldUserMessagesOnCompletion",FN),_t.loadSetting("streamingRenderFPS",LN),_t.loadSetting("gitUserName",_$),_t.loadSetting("gitUserEmail",S$),_t.loadSetting("toolMaxSteps",BN),_t.loadSetting("prismThemeUrl",$N),_t.loadSetting("autoTitleEnabled",zN),_t.loadSetting("autoTitleModelId",UN),_t.loadSetting("autoTitlePromptMaxLength",qN),_t.loadSetting("autoTitleIncludeFiles",VN),_t.loadSetting("autoTitleIncludeRules",WN),_t.loadSetting("customFontFamily",HN),_t.loadSetting("customFontSize",GN),_t.loadSetting("chatMaxWidth",KN),_t.loadSetting("customThemeColors",YN),_t.loadSetting("autoScrollInterval",ZN),_t.loadSetting("enableAutoScrollOnStream",XN),_t.loadSetting("autoSyncOnStreamComplete",C$),_t.loadSetting("autoInitializeReposOnStartup",k$)]),H={theme:n,temperature:r,maxTokens:s,topP:i,topK:a,presencePenalty:o,frequencyPenalty:l,globalSystemPrompt:c,enableAdvancedSettings:u,enableStreamingMarkdown:d,enableStreamingCodeBlockParsing:h,foldStreamingCodeBlocks:m,foldUserMessagesOnCompletion:y,streamingRenderFPS:b,gitUserName:v,gitUserEmail:x,toolMaxSteps:w,prismThemeUrl:S,autoTitleEnabled:k,autoTitleModelId:C,autoTitlePromptMaxLength:T,autoTitleIncludeFiles:R,autoTitleIncludeRules:N,customFontFamily:I,customFontSize:P,chatMaxWidth:B,customThemeColors:D,autoScrollInterval:W,enableAutoScrollOnStream:O,autoSyncOnStreamComplete:Z,autoInitializeReposOnStartup:U};e(H),Pe.emit(sn.loaded,{settings:H})}catch(n){console.error("SettingsStore: Error loading settings",n),Pe.emit(sn.loaded,{settings:t()})}},resetGeneralSettings:async()=>{try{t().setEnableStreamingMarkdown(ON),t().setEnableStreamingCodeBlockParsing(PN),t().setFoldStreamingCodeBlocks(DN),t().setFoldUserMessagesOnCompletion(FN),t().setStreamingRenderFPS(LN),t().setAutoScrollInterval(ZN),t().setEnableAutoScrollOnStream(XN),Me.success("Streaming & Display settings reset to defaults.")}catch(n){console.error("SettingsStore: Error resetting general settings",n),Me.error("Failed to reset general settings.")}},resetAssistantSettings:async()=>{try{t().setGlobalSystemPrompt(TN),t().setTemperature(AN),t().setMaxTokens(RN),t().setTopP(NN),t().setTopK(MN),t().setPresencePenalty(IN),t().setFrequencyPenalty(jN),t().setToolMaxSteps(BN),t().setAutoTitleEnabled(zN),t().setAutoTitleModelId(UN),t().setAutoTitlePromptMaxLength(qN),t().setAutoTitleIncludeFiles(VN),t().setAutoTitleIncludeRules(WN),Me.success("Assistant settings reset to defaults.")}catch(n){console.error("SettingsStore: Error resetting assistant settings",n),Me.error("Failed to reset assistant settings.")}},resetThemeSettings:async()=>{try{t().setTheme(EN),t().setPrismThemeUrl($N),t().setCustomFontFamily(HN),t().setCustomFontSize(GN),t().setChatMaxWidth(KN),t().setCustomThemeColors(YN),Me.success("Theme settings reset to defaults.")}catch(n){console.error("SettingsStore: Error resetting theme settings",n),Me.error("Failed to reset theme settings.")}},getRegisteredActionHandlers:()=>{const n="settingsStore",r=t();return[{eventName:sn.setThemeRequest,handler:s=>r.setTheme(s.theme),storeId:n},{eventName:sn.setGlobalSystemPromptRequest,handler:s=>r.setGlobalSystemPrompt(s.prompt),storeId:n},{eventName:sn.setTemperatureRequest,handler:s=>r.setTemperature(s.value),storeId:n},{eventName:sn.setMaxTokensRequest,handler:s=>r.setMaxTokens(s.value),storeId:n},{eventName:sn.setTopPRequest,handler:s=>r.setTopP(s.value),storeId:n},{eventName:sn.setTopKRequest,handler:s=>r.setTopK(s.value),storeId:n},{eventName:sn.setPresencePenaltyRequest,handler:s=>r.setPresencePenalty(s.value),storeId:n},{eventName:sn.setFrequencyPenaltyRequest,handler:s=>r.setFrequencyPenalty(s.value),storeId:n},{eventName:sn.setEnableAdvancedSettingsRequest,handler:s=>r.setEnableAdvancedSettings(s.enabled),storeId:n},{eventName:sn.setEnableStreamingMarkdownRequest,handler:s=>r.setEnableStreamingMarkdown(s.enabled),storeId:n},{eventName:sn.setEnableStreamingCodeBlockParsingRequest,handler:s=>r.setEnableStreamingCodeBlockParsing(s.enabled),storeId:n},{eventName:sn.setFoldStreamingCodeBlocksRequest,handler:s=>r.setFoldStreamingCodeBlocks(s.fold),storeId:n},{eventName:sn.setFoldUserMessagesOnCompletionRequest,handler:s=>r.setFoldUserMessagesOnCompletion(s.fold),storeId:n},{eventName:sn.setStreamingRenderFpsRequest,handler:s=>r.setStreamingRenderFPS(s.fps),storeId:n},{eventName:sn.setGitUserNameRequest,handler:s=>r.setGitUserName(s.name),storeId:n},{eventName:sn.setGitUserEmailRequest,handler:s=>r.setGitUserEmail(s.email),storeId:n},{eventName:sn.setToolMaxStepsRequest,handler:s=>r.setToolMaxSteps(s.steps),storeId:n},{eventName:sn.setPrismThemeUrlRequest,handler:s=>r.setPrismThemeUrl(s.url),storeId:n},{eventName:sn.setAutoTitleEnabledRequest,handler:s=>r.setAutoTitleEnabled(s.enabled),storeId:n},{eventName:sn.setAutoTitleModelIdRequest,handler:s=>r.setAutoTitleModelId(s.modelId),storeId:n},{eventName:sn.setAutoTitlePromptMaxLengthRequest,handler:s=>r.setAutoTitlePromptMaxLength(s.length),storeId:n},{eventName:sn.setAutoTitleIncludeFilesRequest,handler:s=>r.setAutoTitleIncludeFiles(s.include),storeId:n},{eventName:sn.setAutoTitleIncludeRulesRequest,handler:s=>r.setAutoTitleIncludeRules(s.include),storeId:n},{eventName:sn.setCustomFontFamilyRequest,handler:s=>r.setCustomFontFamily(s.fontFamily),storeId:n},{eventName:sn.setCustomFontSizeRequest,handler:s=>r.setCustomFontSize(s.fontSize),storeId:n},{eventName:sn.setChatMaxWidthRequest,handler:s=>r.setChatMaxWidth(s.maxWidth),storeId:n},{eventName:sn.setCustomThemeColorsRequest,handler:s=>r.setCustomThemeColors(s.colors),storeId:n},{eventName:sn.setCustomThemeColorRequest,handler:s=>r.setCustomThemeColor(s.colorKey,s.value),storeId:n},{eventName:sn.setAutoScrollIntervalRequest,handler:s=>r.setAutoScrollInterval(s.interval),storeId:n},{eventName:sn.setEnableAutoScrollOnStreamRequest,handler:s=>r.setEnableAutoScrollOnStream(s.enabled),storeId:n},{eventName:sn.setAutoSyncOnStreamCompleteRequest,handler:s=>r.setAutoSyncOnStreamComplete(s.enabled),storeId:n},{eventName:sn.setAutoInitializeReposOnStartupRequest,handler:s=>r.setAutoInitializeReposOnStartup(s.enabled),storeId:n},{eventName:sn.loadSettingsRequest,handler:()=>r.loadSettings(),storeId:n},{eventName:sn.resetGeneralSettingsRequest,handler:()=>r.resetGeneralSettings(),storeId:n},{eventName:sn.resetAssistantSettingsRequest,handler:()=>r.resetAssistantSettings(),storeId:n},{eventName:sn.resetThemeSettingsRequest,handler:()=>r.resetThemeSettings(),storeId:n}]}})));async function PC(e,t){const n=Vi.getState().getMiddlewareForHook,r=n(e);let s=t;for(const i of r)try{const a=await i.callback(s);if(a===!1)return console.log(`Middleware ${i.modId} cancelled action for hook ${e}`),!1;a&&typeof a=="object"&&(s=a)}catch(a){return console.error(`Middleware error in mod ${i.modId} for hook ${e}:`,a),!1}return s}function E$(){const e=vn.getState(),t=Cr.getState(),n=br.getState(),{providerId:r}=Tc(t.selectedModelId),s={selectedConversationId:e.currentConversationId,interactions:e.interactions,isStreaming:e.status==="streaming",selectedProviderId:r,selectedModelId:t.selectedModelId,activeSystemPrompt:n.globalSystemPrompt,temperature:n.temperature,maxTokens:n.maxTokens,theme:n.theme,gitUserName:n.gitUserName,gitUserEmail:n.gitUserEmail};return Object.freeze(s)}function mxe(e){try{const t=atob(e),n=t.length,r=new Uint8Array(n);for(let s=0;s<n;s++)r[s]=t.charCodeAt(s);return r}catch(t){throw console.error("Error decoding base64 string:",t),new Error("Invalid base64 string for file content.")}}function T$(e){try{const t=e.type||"application/octet-stream",n=Jx(e.name,t),r=t.startsWith("image/");if(e.contentBytes!==void 0)return n?{type:"text",text:new TextDecoder().decode(e.contentBytes)}:r?{type:"image",image:e.contentBytes,mimeType:t}:(console.warn(`AIService: Unsupported VFS file type "${t}" for direct inclusion. Sending note.`),{type:"text",text:`[Attached VFS file: ${e.name} (${t})]`});if(e.contentText!==void 0&&n)return{type:"text",text:e.contentText};if(e.contentBase64!==void 0&&r)return{type:"image",image:mxe(e.contentBase64),mimeType:t};if(e.contentBase64!==void 0&&!n&&!r)return console.warn(`AIService: Unsupported direct upload type "${t}" for direct inclusion. Sending note.`),{type:"text",text:`[Attached file: ${e.name} (${t})]`};throw n&&e.contentText===void 0?new Error(`Missing text content for likely text file: ${e.name}`):r&&e.contentBase64===void 0?new Error(`Missing base64 content for image file: ${e.name}`):new Error(`Missing or unusable content for file: ${e.name}`)}catch(t){return console.error(`AIService: Failed to process content for ${e.name}:`,t),Me.error(`Failed to process file "${e.name}": ${t instanceof Error?t.message:String(t)}`),{type:"text",text:`[Error processing file: ${e.name}]`}}}function bj(e){return e.flatMap(t=>{var s,i,a;const n=[],r=t.prompt;if(r){const o=[];r.content&&o.push({type:"text",text:r.content}),(s=r.metadata)!=null&&s.attachedFiles&&r.metadata.attachedFiles.length>0&&r.metadata.attachedFiles.forEach(l=>{o.push({type:"text",text:`[User attached file: ${l.name}]`})}),o.length>0&&n.push({role:"user",content:o})}if(t.response&&typeof t.response=="string"&&n.push({role:"assistant",content:t.response}),(i=t.metadata)!=null&&i.toolCalls&&Array.isArray(t.metadata.toolCalls)){const o=[];t.metadata.toolCalls.forEach(l=>{try{const c=JSON.parse(l);c&&c.type==="tool-call"&&c.toolCallId&&c.toolName&&c.args!==void 0?o.push(c):console.warn("[AIService] buildHistory: Invalid tool call structure after parsing:",l)}catch(c){console.error("[AIService] buildHistory: Failed to parse tool call string:",l,c)}}),o.length>0&&n.push({role:"assistant",content:o})}if((a=t.metadata)!=null&&a.toolResults&&Array.isArray(t.metadata.toolResults)){const o=[];t.metadata.toolResults.forEach(l=>{try{const c=JSON.parse(l);c&&c.type==="tool-result"&&c.toolCallId&&c.toolName&&c.result!==void 0?o.push(c):console.warn("[AIService] buildHistory: Invalid tool result structure after parsing:",l)}catch(c){console.error("[AIService] buildHistory: Failed to parse tool result string:",l,c)}}),o.length>0&&n.push({role:"tool",content:o})}return n})}const A$=e=>Symbol.iterator in e,R$=e=>"entries"in e,N$=(e,t)=>{const n=e instanceof Map?e:new Map(e.entries()),r=t instanceof Map?t:new Map(t.entries());if(n.size!==r.size)return!1;for(const[s,i]of n)if(!Object.is(i,r.get(s)))return!1;return!0},gxe=(e,t)=>{const n=e[Symbol.iterator](),r=t[Symbol.iterator]();let s=n.next(),i=r.next();for(;!s.done&&!i.done;){if(!Object.is(s.value,i.value))return!1;s=n.next(),i=r.next()}return!!s.done&&!!i.done};function yxe(e,t){return Object.is(e,t)?!0:typeof e!="object"||e===null||typeof t!="object"||t===null?!1:!A$(e)||!A$(t)?N$({entries:()=>Object.entries(e)},{entries:()=>Object.entries(t)}):R$(e)&&R$(t)?N$(e,t):gxe(e,t)}function yn(e){const t=Ve.useRef(void 0);return n=>{const r=e(n);return yxe(t.current,r)?t.current:t.current=r}}var iy=(e=>(e.PROMPT_TURN_FINALIZE="middleware.prompt.turnFinalize",e.INTERACTION_BEFORE_START="middleware.interaction.beforeStart",e.INTERACTION_PROCESS_CHUNK="middleware.interaction.processChunk",e))(iy||{});const gn={initialized:"prompt.state.initialized",parameterChanged:"prompt.state.parameter.changed",transientParametersReset:"prompt.state.transient.parameters.reset",inputTextStateChanged:"prompt.state.input.text.changed",submitted:"prompt.state.submitted",setModelIdRequest:"prompt.state.set.model.id.request",setTemperatureRequest:"prompt.state.set.temperature.request",setMaxTokensRequest:"prompt.state.set.max.tokens.request",setTopPRequest:"prompt.state.set.top.p.request",setTopKRequest:"prompt.state.set.top.k.request",setPresencePenaltyRequest:"prompt.state.set.presence.penalty.request",setFrequencyPenaltyRequest:"prompt.state.set.frequency.penalty.request",setReasoningEnabledRequest:"prompt.state.set.reasoning.enabled.request",setWebSearchEnabledRequest:"prompt.state.set.web.search.enabled.request",setImageGenerationEnabledRequest:"prompt.state.set.image.generation.enabled.request",setStructuredOutputJsonRequest:"prompt.state.set.structured.output.json.request",initializePromptStateRequest:"prompt.state.initialize.prompt.state.request",resetTransientParametersRequest:"prompt.state.reset.transient.parameters.request",setInputTextRequest:"prompt.input.set.text.request",focusInputRequest:"prompt.input.focus.request",submitPromptRequest:"prompt.submit.request",inputChanged:"prompt.inputChanged"},fc=(e,t)=>{Pe.emit(gn.parameterChanged,{params:{[e]:t}})},Fo=qo(Vo((e,t)=>({modelId:null,temperature:null,maxTokens:null,topP:null,topK:null,presencePenalty:null,frequencyPenalty:null,reasoningEnabled:null,webSearchEnabled:null,imageGenerationEnabled:null,structuredOutputJson:null,setModelId:n=>{t().modelId!==n&&(e({modelId:n}),fc("modelId",n))},setTemperature:n=>{t().temperature!==n&&(e({temperature:n}),fc("temperature",n))},setMaxTokens:n=>{t().maxTokens!==n&&(e({maxTokens:n}),fc("maxTokens",n))},setTopP:n=>{t().topP!==n&&(e({topP:n}),fc("topP",n))},setTopK:n=>{t().topK!==n&&(e({topK:n}),fc("topK",n))},setPresencePenalty:n=>{t().presencePenalty!==n&&(e({presencePenalty:n}),fc("presencePenalty",n))},setFrequencyPenalty:n=>{t().frequencyPenalty!==n&&(e({frequencyPenalty:n}),fc("frequencyPenalty",n))},setReasoningEnabled:n=>{t().reasoningEnabled!==n&&(e({reasoningEnabled:n}),fc("reasoningEnabled",n))},setWebSearchEnabled:n=>{t().webSearchEnabled!==n&&(e({webSearchEnabled:n}),fc("webSearchEnabled",n))},setImageGenerationEnabled:n=>{t().imageGenerationEnabled!==n&&(e({imageGenerationEnabled:n}),fc("imageGenerationEnabled",n))},setStructuredOutputJson:n=>{t().structuredOutputJson!==n&&(e({structuredOutputJson:n}),fc("structuredOutputJson",n))},initializePromptState:n=>{console.log("[PromptStateStore] Initializing with:",n);const r=t(),s={};let i=!1;r.modelId!==n.modelId&&(s.modelId=n.modelId,i=!0),r.temperature!==n.temperature&&(s.temperature=n.temperature,i=!0),r.maxTokens!==n.maxTokens&&(s.maxTokens=n.maxTokens,i=!0),r.topP!==n.topP&&(s.topP=n.topP,i=!0),r.topK!==n.topK&&(s.topK=n.topK,i=!0),r.presencePenalty!==n.presencePenalty&&(s.presencePenalty=n.presencePenalty,i=!0),r.frequencyPenalty!==n.frequencyPenalty&&(s.frequencyPenalty=n.frequencyPenalty,i=!0),i&&(e(s),Pe.emit(gn.parameterChanged,{params:s})),Pe.emit(gn.initialized,{state:{...t()}})},resetTransientParameters:()=>{console.log("[PromptStateStore] Resetting transient parameters.");const n=t(),r={};let s=!1;n.temperature!==null&&(r.temperature=null,s=!0),n.maxTokens!==null&&(r.maxTokens=null,s=!0),n.topP!==null&&(r.topP=null,s=!0),n.topK!==null&&(r.topK=null,s=!0),n.presencePenalty!==null&&(r.presencePenalty=null,s=!0),n.frequencyPenalty!==null&&(r.frequencyPenalty=null,s=!0),n.reasoningEnabled!==null&&(r.reasoningEnabled=null,s=!0),n.webSearchEnabled!==null&&(r.webSearchEnabled=null,s=!0),n.imageGenerationEnabled!==null&&(r.imageGenerationEnabled=null,s=!0),n.structuredOutputJson!==null&&(r.structuredOutputJson=null,s=!0),s&&(e(r),Pe.emit(gn.parameterChanged,{params:r})),Pe.emit(gn.transientParametersReset,void 0)},getRegisteredActionHandlers:()=>{const n="promptStateStore",r=t();return[{eventName:gn.setModelIdRequest,handler:s=>r.setModelId(s.id),storeId:n},{eventName:gn.setTemperatureRequest,handler:s=>r.setTemperature(s.value),storeId:n},{eventName:gn.setMaxTokensRequest,handler:s=>r.setMaxTokens(s.value),storeId:n},{eventName:gn.setTopPRequest,handler:s=>r.setTopP(s.value),storeId:n},{eventName:gn.setTopKRequest,handler:s=>r.setTopK(s.value),storeId:n},{eventName:gn.setPresencePenaltyRequest,handler:s=>r.setPresencePenalty(s.value),storeId:n},{eventName:gn.setFrequencyPenaltyRequest,handler:s=>r.setFrequencyPenalty(s.value),storeId:n},{eventName:gn.setReasoningEnabledRequest,handler:s=>r.setReasoningEnabled(s.enabled),storeId:n},{eventName:gn.setWebSearchEnabledRequest,handler:s=>r.setWebSearchEnabled(s.enabled),storeId:n},{eventName:gn.setImageGenerationEnabledRequest,handler:s=>r.setImageGenerationEnabled(s.enabled),storeId:n},{eventName:gn.setStructuredOutputJsonRequest,handler:s=>r.setStructuredOutputJson(s.json),storeId:n},{eventName:gn.initializePromptStateRequest,handler:s=>r.initializePromptState(s.effectiveSettings),storeId:n},{eventName:gn.resetTransientParametersRequest,handler:()=>r.resetTransientParameters(),storeId:n}]}}))),bxe=({InputAreaRenderer:e,onSubmit:t,className:n,placeholder:r="Send a message...",inputAreaRef:s,selectedItemId:i,selectedItemType:a})=>{const[o,l]=E.useState(!1),[c,u]=E.useState(!1),d=Vi(yn(C=>C.promptControls)),h=vn(yn(C=>C.status==="streaming")),{attachedFilesMetadata:m,clearAttachedFiles:y}=bh(yn(C=>({attachedFilesMetadata:C.attachedFilesMetadata,clearAttachedFiles:C.clearAttachedFiles}))),b=Fo(C=>C.modelId),v=E.useMemo(()=>Object.values(d),[d]),x=E.useMemo(()=>v.filter(C=>C.renderer),[v]),w=E.useMemo(()=>v.filter(C=>C.triggerRenderer),[v]),S=E.useCallback(async C=>{var I,P;const T=((I=s==null?void 0:s.current)==null?void 0:I.getValue())??"",R=C!==void 0?C.trim():T.trim(),N=bh.getState().attachedFilesMetadata;if(!(!R&&N.length===0)&&!(h||o)){l(!0);try{let B={},D={};for(const H of v){if(H.getParameters){const L=await H.getParameters();L&&(B={...B,...L})}if(H.getMetadata){const L=await H.getMetadata();L&&(D={...D,...L})}}N.length>0&&(D.attachedFiles=[...N]),!D.modelId&&b&&(D.modelId=b);const W=v.find(H=>H.id==="core-rules-tags");if(W&&D.activeRuleIds&&D.activeTagIds){const H=[],L=new Set(D.activeRuleIds);D.activeTagIds.forEach(te=>{W.getRulesForTag(te).forEach(V=>L.add(V.id))}),L.forEach(te=>{const V=W.getRuleById(te);V&&H.push({type:V.type,content:V.content,sourceRuleId:V.id})}),D.effectiveRulesContent=H}let O={id:as(),content:R,parameters:B,metadata:D};Pe.emit(gn.submitted,{turnData:O});const Z=await PC(iy.PROMPT_TURN_FINALIZE,{turnData:O});if(Z===!1){console.log("Prompt submission cancelled by middleware."),l(!1);return}const U=Z&&typeof Z=="object"?Z.turnData:O;await t(U),y(),v.forEach(H=>{H.clearOnSubmit&&H.clearOnSubmit()}),(P=s.current)==null||P.clearValue(),u(!1)}catch(B){console.error("Error during prompt submission:",B),Me.error(`Failed to send message: ${B instanceof Error?B.message:String(B)}`)}finally{l(!1)}}},[s,h,o,v,t,y,b]);E.useEffect(()=>{a==="conversation"&&i&&requestAnimationFrame(()=>{var C;(C=s.current)==null||C.focus()})},[i,a,s]),E.useEffect(()=>{const C=()=>{requestAnimationFrame(()=>{var N;(N=s.current)==null||N.focus()})},T=N=>{s.current&&(s.current.setValue(N.text),u(N.text.trim().length>0))},R=async N=>{vn.getState().status==="streaming"||o||await S(N.turnData.content)};return Pe.on(gn.focusInputRequest,C),Pe.on(gn.setInputTextRequest,T),Pe.on(gn.submitPromptRequest,R),()=>{Pe.off(gn.focusInputRequest,C),Pe.off(gn.setInputTextRequest,T),Pe.off(gn.submitPromptRequest,R)}},[s,S,o]);const k=E.useCallback(C=>{u(C.trim().length>0)},[]);return f.jsxs("div",{className:Xe("p-2 md:p-4 space-y-2 md:space-y-3",n),children:[x.length>0&&f.jsx(OB,{controls:x,area:"panel",className:"flex flex-wrap gap-1 md:gap-2 items-start mb-1 md:mb-2"}),f.jsxs("div",{className:"flex items-end gap-2",children:[f.jsx(e,{ref:s,onSubmit:S,disabled:h||o,placeholder:r,onValueChange:k,className:"flex-grow"}),f.jsx(mt,{type:"button",size:"icon",onClick:()=>S(void 0),disabled:h||o||!c&&m.length===0,className:"h-9 w-9 flex-shrink-0","aria-label":"Send message",children:o?f.jsx(Xn,{className:"h-4 w-4 animate-spin"}):f.jsx(Age,{className:"h-4 w-4"})})]})," ",f.jsx(OB,{controls:w,area:"trigger",className:"flex items-center gap-1 flex-wrap flex-shrink-0 mt-1 md:mt-2"})]})};function Wt(e,t,{checkForDefaultPrevented:n=!0}={}){return function(s){if(e==null||e(s),n===!1||!s.defaultPrevented)return t==null?void 0:t(s)}}function vxe(e,t){const n=E.createContext(t),r=i=>{const{children:a,...o}=i,l=E.useMemo(()=>o,Object.values(o));return f.jsx(n.Provider,{value:l,children:a})};r.displayName=e+"Provider";function s(i){const a=E.useContext(n);if(a)return a;if(t!==void 0)return t;throw new Error(`\`${i}\` must be used within \`${e}\``)}return[r,s]}function Ki(e,t=[]){let n=[];function r(i,a){const o=E.createContext(a),l=n.length;n=[...n,a];const c=d=>{var x;const{scope:h,children:m,...y}=d,b=((x=h==null?void 0:h[e])==null?void 0:x[l])||o,v=E.useMemo(()=>y,Object.values(y));return f.jsx(b.Provider,{value:v,children:m})};c.displayName=i+"Provider";function u(d,h){var b;const m=((b=h==null?void 0:h[e])==null?void 0:b[l])||o,y=E.useContext(m);if(y)return y;if(a!==void 0)return a;throw new Error(`\`${d}\` must be used within \`${i}\``)}return[c,u]}const s=()=>{const i=n.map(a=>E.createContext(a));return function(o){const l=(o==null?void 0:o[e])||i;return E.useMemo(()=>({[`__scope${e}`]:{...o,[e]:l}}),[o,l])}};return s.scopeName=e,[r,xxe(s,...t)]}function xxe(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const r=e.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(i){const a=r.reduce((o,{useScope:l,scopeName:c})=>{const d=l(i)[`__scope${c}`];return{...o,...d}},{});return E.useMemo(()=>({[`__scope${t.scopeName}`]:a}),[a])}};return n.scopeName=t.scopeName,n}function wxe(e){const t=_xe(e),n=E.forwardRef((r,s)=>{const{children:i,...a}=r,o=E.Children.toArray(i),l=o.find(Cxe);if(l){const c=l.props.children,u=o.map(d=>d===l?E.Children.count(c)>1?E.Children.only(null):E.isValidElement(c)?c.props.children:null:d);return f.jsx(t,{...a,ref:s,children:E.isValidElement(c)?E.cloneElement(c,void 0,u):null})}return f.jsx(t,{...a,ref:s,children:i})});return n.displayName=`${e}.Slot`,n}function _xe(e){const t=E.forwardRef((n,r)=>{const{children:s,...i}=n;if(E.isValidElement(s)){const a=Exe(s),o=kxe(i,s.props);return s.type!==E.Fragment&&(o.ref=r?gl(r,a):a),E.cloneElement(s,o)}return E.Children.count(s)>1?E.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var Sxe=Symbol("radix.slottable");function Cxe(e){return E.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===Sxe}function kxe(e,t){const n={...t};for(const r in t){const s=e[r],i=t[r];/^on[A-Z]/.test(r)?s&&i?n[r]=(...o)=>{i(...o),s(...o)}:s&&(n[r]=s):r==="style"?n[r]={...s,...i}:r==="className"&&(n[r]=[s,i].filter(Boolean).join(" "))}return{...e,...n}}function Exe(e){var r,s;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(s=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:s.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var Txe=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],lr=Txe.reduce((e,t)=>{const n=wxe(`Primitive.${t}`),r=E.forwardRef((s,i)=>{const{asChild:a,...o}=s,l=a?n:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),f.jsx(l,{...o,ref:i})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{});function LG(e,t){e&&cl.flushSync(()=>e.dispatchEvent(t))}function Es(e){const t=E.useRef(e);return E.useEffect(()=>{t.current=e}),E.useMemo(()=>(...n)=>{var r;return(r=t.current)==null?void 0:r.call(t,...n)},[])}function iP(e,t=globalThis==null?void 0:globalThis.document){const n=Es(e);E.useEffect(()=>{const r=s=>{s.key==="Escape"&&n(s)};return t.addEventListener("keydown",r,{capture:!0}),()=>t.removeEventListener("keydown",r,{capture:!0})},[n,t])}var Axe="DismissableLayer",vj="dismissableLayer.update",Rxe="dismissableLayer.pointerDownOutside",Nxe="dismissableLayer.focusOutside",M$,BG=E.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),RE=E.forwardRef((e,t)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:s,onFocusOutside:i,onInteractOutside:a,onDismiss:o,...l}=e,c=E.useContext(BG),[u,d]=E.useState(null),h=(u==null?void 0:u.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,m]=E.useState({}),y=Mn(t,R=>d(R)),b=Array.from(c.layers),[v]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),x=b.indexOf(v),w=u?b.indexOf(u):-1,S=c.layersWithOutsidePointerEventsDisabled.size>0,k=w>=x,C=jxe(R=>{const N=R.target,I=[...c.branches].some(P=>P.contains(N));!k||I||(s==null||s(R),a==null||a(R),R.defaultPrevented||o==null||o())},h),T=Oxe(R=>{const N=R.target;[...c.branches].some(P=>P.contains(N))||(i==null||i(R),a==null||a(R),R.defaultPrevented||o==null||o())},h);return iP(R=>{w===c.layers.size-1&&(r==null||r(R),!R.defaultPrevented&&o&&(R.preventDefault(),o()))},h),E.useEffect(()=>{if(u)return n&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(M$=h.body.style.pointerEvents,h.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(u)),c.layers.add(u),I$(),()=>{n&&c.layersWithOutsidePointerEventsDisabled.size===1&&(h.body.style.pointerEvents=M$)}},[u,h,n,c]),E.useEffect(()=>()=>{u&&(c.layers.delete(u),c.layersWithOutsidePointerEventsDisabled.delete(u),I$())},[u,c]),E.useEffect(()=>{const R=()=>m({});return document.addEventListener(vj,R),()=>document.removeEventListener(vj,R)},[]),f.jsx(lr.div,{...l,ref:y,style:{pointerEvents:S?k?"auto":"none":void 0,...e.style},onFocusCapture:Wt(e.onFocusCapture,T.onFocusCapture),onBlurCapture:Wt(e.onBlurCapture,T.onBlurCapture),onPointerDownCapture:Wt(e.onPointerDownCapture,C.onPointerDownCapture)})});RE.displayName=Axe;var Mxe="DismissableLayerBranch",Ixe=E.forwardRef((e,t)=>{const n=E.useContext(BG),r=E.useRef(null),s=Mn(t,r);return E.useEffect(()=>{const i=r.current;if(i)return n.branches.add(i),()=>{n.branches.delete(i)}},[n.branches]),f.jsx(lr.div,{...e,ref:s})});Ixe.displayName=Mxe;function jxe(e,t=globalThis==null?void 0:globalThis.document){const n=Es(e),r=E.useRef(!1),s=E.useRef(()=>{});return E.useEffect(()=>{const i=o=>{if(o.target&&!r.current){let l=function(){$G(Rxe,n,c,{discrete:!0})};const c={originalEvent:o};o.pointerType==="touch"?(t.removeEventListener("click",s.current),s.current=l,t.addEventListener("click",s.current,{once:!0})):l()}else t.removeEventListener("click",s.current);r.current=!1},a=window.setTimeout(()=>{t.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(a),t.removeEventListener("pointerdown",i),t.removeEventListener("click",s.current)}},[t,n]),{onPointerDownCapture:()=>r.current=!0}}function Oxe(e,t=globalThis==null?void 0:globalThis.document){const n=Es(e),r=E.useRef(!1);return E.useEffect(()=>{const s=i=>{i.target&&!r.current&&$G(Nxe,n,{originalEvent:i},{discrete:!1})};return t.addEventListener("focusin",s),()=>t.removeEventListener("focusin",s)},[t,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function I$(){const e=new CustomEvent(vj);document.dispatchEvent(e)}function $G(e,t,n,{discrete:r}){const s=n.originalEvent.target,i=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&s.addEventListener(e,t,{once:!0}),r?LG(s,i):s.dispatchEvent(i)}var si=globalThis!=null&&globalThis.document?E.useLayoutEffect:()=>{},Pxe=eH[" useId ".trim().toString()]||(()=>{}),Dxe=0;function la(e){const[t,n]=E.useState(Pxe());return si(()=>{n(r=>r??String(Dxe++))},[e]),t?`radix-${t}`:""}const Fxe=["top","right","bottom","left"],wh=Math.min,ll=Math.max,DC=Math.round,IS=Math.floor,Eu=e=>({x:e,y:e}),Lxe={left:"right",right:"left",bottom:"top",top:"bottom"},Bxe={start:"end",end:"start"};function xj(e,t,n){return ll(e,wh(t,n))}function Gd(e,t){return typeof e=="function"?e(t):e}function Kd(e){return e.split("-")[0]}function Hy(e){return e.split("-")[1]}function aP(e){return e==="x"?"y":"x"}function oP(e){return e==="y"?"height":"width"}function _h(e){return["top","bottom"].includes(Kd(e))?"y":"x"}function lP(e){return aP(_h(e))}function $xe(e,t,n){n===void 0&&(n=!1);const r=Hy(e),s=lP(e),i=oP(s);let a=s==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return t.reference[i]>t.floating[i]&&(a=FC(a)),[a,FC(a)]}function zxe(e){const t=FC(e);return[wj(e),t,wj(t)]}function wj(e){return e.replace(/start|end/g,t=>Bxe[t])}function Uxe(e,t,n){const r=["left","right"],s=["right","left"],i=["top","bottom"],a=["bottom","top"];switch(e){case"top":case"bottom":return n?t?s:r:t?r:s;case"left":case"right":return t?i:a;default:return[]}}function qxe(e,t,n,r){const s=Hy(e);let i=Uxe(Kd(e),n==="start",r);return s&&(i=i.map(a=>a+"-"+s),t&&(i=i.concat(i.map(wj)))),i}function FC(e){return e.replace(/left|right|bottom|top/g,t=>Lxe[t])}function Vxe(e){return{top:0,right:0,bottom:0,left:0,...e}}function zG(e){return typeof e!="number"?Vxe(e):{top:e,right:e,bottom:e,left:e}}function LC(e){const{x:t,y:n,width:r,height:s}=e;return{width:r,height:s,top:n,left:t,right:t+r,bottom:n+s,x:t,y:n}}function j$(e,t,n){let{reference:r,floating:s}=e;const i=_h(t),a=lP(t),o=oP(a),l=Kd(t),c=i==="y",u=r.x+r.width/2-s.width/2,d=r.y+r.height/2-s.height/2,h=r[o]/2-s[o]/2;let m;switch(l){case"top":m={x:u,y:r.y-s.height};break;case"bottom":m={x:u,y:r.y+r.height};break;case"right":m={x:r.x+r.width,y:d};break;case"left":m={x:r.x-s.width,y:d};break;default:m={x:r.x,y:r.y}}switch(Hy(t)){case"start":m[a]-=h*(n&&c?-1:1);break;case"end":m[a]+=h*(n&&c?-1:1);break}return m}const Wxe=async(e,t,n)=>{const{placement:r="bottom",strategy:s="absolute",middleware:i=[],platform:a}=n,o=i.filter(Boolean),l=await(a.isRTL==null?void 0:a.isRTL(t));let c=await a.getElementRects({reference:e,floating:t,strategy:s}),{x:u,y:d}=j$(c,r,l),h=r,m={},y=0;for(let b=0;b<o.length;b++){const{name:v,fn:x}=o[b],{x:w,y:S,data:k,reset:C}=await x({x:u,y:d,initialPlacement:r,placement:h,strategy:s,middlewareData:m,rects:c,platform:a,elements:{reference:e,floating:t}});u=w??u,d=S??d,m={...m,[v]:{...m[v],...k}},C&&y<=50&&(y++,typeof C=="object"&&(C.placement&&(h=C.placement),C.rects&&(c=C.rects===!0?await a.getElementRects({reference:e,floating:t,strategy:s}):C.rects),{x:u,y:d}=j$(c,h,l)),b=-1)}return{x:u,y:d,placement:h,strategy:s,middlewareData:m}};async function rw(e,t){var n;t===void 0&&(t={});const{x:r,y:s,platform:i,rects:a,elements:o,strategy:l}=e,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:h=!1,padding:m=0}=Gd(t,e),y=zG(m),v=o[h?d==="floating"?"reference":"floating":d],x=LC(await i.getClippingRect({element:(n=await(i.isElement==null?void 0:i.isElement(v)))==null||n?v:v.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(o.floating)),boundary:c,rootBoundary:u,strategy:l})),w=d==="floating"?{x:r,y:s,width:a.floating.width,height:a.floating.height}:a.reference,S=await(i.getOffsetParent==null?void 0:i.getOffsetParent(o.floating)),k=await(i.isElement==null?void 0:i.isElement(S))?await(i.getScale==null?void 0:i.getScale(S))||{x:1,y:1}:{x:1,y:1},C=LC(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:o,rect:w,offsetParent:S,strategy:l}):w);return{top:(x.top-C.top+y.top)/k.y,bottom:(C.bottom-x.bottom+y.bottom)/k.y,left:(x.left-C.left+y.left)/k.x,right:(C.right-x.right+y.right)/k.x}}const Hxe=e=>({name:"arrow",options:e,async fn(t){const{x:n,y:r,placement:s,rects:i,platform:a,elements:o,middlewareData:l}=t,{element:c,padding:u=0}=Gd(e,t)||{};if(c==null)return{};const d=zG(u),h={x:n,y:r},m=lP(s),y=oP(m),b=await a.getDimensions(c),v=m==="y",x=v?"top":"left",w=v?"bottom":"right",S=v?"clientHeight":"clientWidth",k=i.reference[y]+i.reference[m]-h[m]-i.floating[y],C=h[m]-i.reference[m],T=await(a.getOffsetParent==null?void 0:a.getOffsetParent(c));let R=T?T[S]:0;(!R||!await(a.isElement==null?void 0:a.isElement(T)))&&(R=o.floating[S]||i.floating[y]);const N=k/2-C/2,I=R/2-b[y]/2-1,P=wh(d[x],I),B=wh(d[w],I),D=P,W=R-b[y]-B,O=R/2-b[y]/2+N,Z=xj(D,O,W),U=!l.arrow&&Hy(s)!=null&&O!==Z&&i.reference[y]/2-(O<D?P:B)-b[y]/2<0,H=U?O<D?O-D:O-W:0;return{[m]:h[m]+H,data:{[m]:Z,centerOffset:O-Z-H,...U&&{alignmentOffset:H}},reset:U}}}),Gxe=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var n,r;const{placement:s,middlewareData:i,rects:a,initialPlacement:o,platform:l,elements:c}=t,{mainAxis:u=!0,crossAxis:d=!0,fallbackPlacements:h,fallbackStrategy:m="bestFit",fallbackAxisSideDirection:y="none",flipAlignment:b=!0,...v}=Gd(e,t);if((n=i.arrow)!=null&&n.alignmentOffset)return{};const x=Kd(s),w=_h(o),S=Kd(o)===o,k=await(l.isRTL==null?void 0:l.isRTL(c.floating)),C=h||(S||!b?[FC(o)]:zxe(o)),T=y!=="none";!h&&T&&C.push(...qxe(o,b,y,k));const R=[o,...C],N=await rw(t,v),I=[];let P=((r=i.flip)==null?void 0:r.overflows)||[];if(u&&I.push(N[x]),d){const O=$xe(s,a,k);I.push(N[O[0]],N[O[1]])}if(P=[...P,{placement:s,overflows:I}],!I.every(O=>O<=0)){var B,D;const O=(((B=i.flip)==null?void 0:B.index)||0)+1,Z=R[O];if(Z)return{data:{index:O,overflows:P},reset:{placement:Z}};let U=(D=P.filter(H=>H.overflows[0]<=0).sort((H,L)=>H.overflows[1]-L.overflows[1])[0])==null?void 0:D.placement;if(!U)switch(m){case"bestFit":{var W;const H=(W=P.filter(L=>{if(T){const te=_h(L.placement);return te===w||te==="y"}return!0}).map(L=>[L.placement,L.overflows.filter(te=>te>0).reduce((te,V)=>te+V,0)]).sort((L,te)=>L[1]-te[1])[0])==null?void 0:W[0];H&&(U=H);break}case"initialPlacement":U=o;break}if(s!==U)return{reset:{placement:U}}}return{}}}};function O$(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function P$(e){return Fxe.some(t=>e[t]>=0)}const Kxe=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:n}=t,{strategy:r="referenceHidden",...s}=Gd(e,t);switch(r){case"referenceHidden":{const i=await rw(t,{...s,elementContext:"reference"}),a=O$(i,n.reference);return{data:{referenceHiddenOffsets:a,referenceHidden:P$(a)}}}case"escaped":{const i=await rw(t,{...s,altBoundary:!0}),a=O$(i,n.floating);return{data:{escapedOffsets:a,escaped:P$(a)}}}default:return{}}}}};async function Yxe(e,t){const{placement:n,platform:r,elements:s}=e,i=await(r.isRTL==null?void 0:r.isRTL(s.floating)),a=Kd(n),o=Hy(n),l=_h(n)==="y",c=["left","top"].includes(a)?-1:1,u=i&&l?-1:1,d=Gd(t,e);let{mainAxis:h,crossAxis:m,alignmentAxis:y}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:d.mainAxis||0,crossAxis:d.crossAxis||0,alignmentAxis:d.alignmentAxis};return o&&typeof y=="number"&&(m=o==="end"?y*-1:y),l?{x:m*u,y:h*c}:{x:h*c,y:m*u}}const Zxe=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var n,r;const{x:s,y:i,placement:a,middlewareData:o}=t,l=await Yxe(t,e);return a===((n=o.offset)==null?void 0:n.placement)&&(r=o.arrow)!=null&&r.alignmentOffset?{}:{x:s+l.x,y:i+l.y,data:{...l,placement:a}}}}},Xxe=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:n,y:r,placement:s}=t,{mainAxis:i=!0,crossAxis:a=!1,limiter:o={fn:v=>{let{x,y:w}=v;return{x,y:w}}},...l}=Gd(e,t),c={x:n,y:r},u=await rw(t,l),d=_h(Kd(s)),h=aP(d);let m=c[h],y=c[d];if(i){const v=h==="y"?"top":"left",x=h==="y"?"bottom":"right",w=m+u[v],S=m-u[x];m=xj(w,m,S)}if(a){const v=d==="y"?"top":"left",x=d==="y"?"bottom":"right",w=y+u[v],S=y-u[x];y=xj(w,y,S)}const b=o.fn({...t,[h]:m,[d]:y});return{...b,data:{x:b.x-n,y:b.y-r,enabled:{[h]:i,[d]:a}}}}}},Jxe=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:n,y:r,placement:s,rects:i,middlewareData:a}=t,{offset:o=0,mainAxis:l=!0,crossAxis:c=!0}=Gd(e,t),u={x:n,y:r},d=_h(s),h=aP(d);let m=u[h],y=u[d];const b=Gd(o,t),v=typeof b=="number"?{mainAxis:b,crossAxis:0}:{mainAxis:0,crossAxis:0,...b};if(l){const S=h==="y"?"height":"width",k=i.reference[h]-i.floating[S]+v.mainAxis,C=i.reference[h]+i.reference[S]-v.mainAxis;m<k?m=k:m>C&&(m=C)}if(c){var x,w;const S=h==="y"?"width":"height",k=["top","left"].includes(Kd(s)),C=i.reference[d]-i.floating[S]+(k&&((x=a.offset)==null?void 0:x[d])||0)+(k?0:v.crossAxis),T=i.reference[d]+i.reference[S]+(k?0:((w=a.offset)==null?void 0:w[d])||0)-(k?v.crossAxis:0);y<C?y=C:y>T&&(y=T)}return{[h]:m,[d]:y}}}},Qxe=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){var n,r;const{placement:s,rects:i,platform:a,elements:o}=t,{apply:l=()=>{},...c}=Gd(e,t),u=await rw(t,c),d=Kd(s),h=Hy(s),m=_h(s)==="y",{width:y,height:b}=i.floating;let v,x;d==="top"||d==="bottom"?(v=d,x=h===(await(a.isRTL==null?void 0:a.isRTL(o.floating))?"start":"end")?"left":"right"):(x=d,v=h==="end"?"top":"bottom");const w=b-u.top-u.bottom,S=y-u.left-u.right,k=wh(b-u[v],w),C=wh(y-u[x],S),T=!t.middlewareData.shift;let R=k,N=C;if((n=t.middlewareData.shift)!=null&&n.enabled.x&&(N=S),(r=t.middlewareData.shift)!=null&&r.enabled.y&&(R=w),T&&!h){const P=ll(u.left,0),B=ll(u.right,0),D=ll(u.top,0),W=ll(u.bottom,0);m?N=y-2*(P!==0||B!==0?P+B:ll(u.left,u.right)):R=b-2*(D!==0||W!==0?D+W:ll(u.top,u.bottom))}await l({...t,availableWidth:N,availableHeight:R});const I=await a.getDimensions(o.floating);return y!==I.width||b!==I.height?{reset:{rects:!0}}:{}}}};function NE(){return typeof window<"u"}function Gy(e){return UG(e)?(e.nodeName||"").toLowerCase():"#document"}function ul(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function zu(e){var t;return(t=(UG(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function UG(e){return NE()?e instanceof Node||e instanceof ul(e).Node:!1}function Pc(e){return NE()?e instanceof Element||e instanceof ul(e).Element:!1}function Pu(e){return NE()?e instanceof HTMLElement||e instanceof ul(e).HTMLElement:!1}function D$(e){return!NE()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof ul(e).ShadowRoot}function y1(e){const{overflow:t,overflowX:n,overflowY:r,display:s}=Dc(e);return/auto|scroll|overlay|hidden|clip/.test(t+r+n)&&!["inline","contents"].includes(s)}function ewe(e){return["table","td","th"].includes(Gy(e))}function ME(e){return[":popover-open",":modal"].some(t=>{try{return e.matches(t)}catch{return!1}})}function cP(e){const t=uP(),n=Pc(e)?Dc(e):e;return["transform","translate","scale","rotate","perspective"].some(r=>n[r]?n[r]!=="none":!1)||(n.containerType?n.containerType!=="normal":!1)||!t&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!t&&(n.filter?n.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(r=>(n.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(n.contain||"").includes(r))}function twe(e){let t=Sh(e);for(;Pu(t)&&!ay(t);){if(cP(t))return t;if(ME(t))return null;t=Sh(t)}return null}function uP(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function ay(e){return["html","body","#document"].includes(Gy(e))}function Dc(e){return ul(e).getComputedStyle(e)}function IE(e){return Pc(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function Sh(e){if(Gy(e)==="html")return e;const t=e.assignedSlot||e.parentNode||D$(e)&&e.host||zu(e);return D$(t)?t.host:t}function qG(e){const t=Sh(e);return ay(t)?e.ownerDocument?e.ownerDocument.body:e.body:Pu(t)&&y1(t)?t:qG(t)}function sw(e,t,n){var r;t===void 0&&(t=[]),n===void 0&&(n=!0);const s=qG(e),i=s===((r=e.ownerDocument)==null?void 0:r.body),a=ul(s);if(i){const o=_j(a);return t.concat(a,a.visualViewport||[],y1(s)?s:[],o&&n?sw(o):[])}return t.concat(s,sw(s,[],n))}function _j(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function VG(e){const t=Dc(e);let n=parseFloat(t.width)||0,r=parseFloat(t.height)||0;const s=Pu(e),i=s?e.offsetWidth:n,a=s?e.offsetHeight:r,o=DC(n)!==i||DC(r)!==a;return o&&(n=i,r=a),{width:n,height:r,$:o}}function dP(e){return Pc(e)?e:e.contextElement}function I0(e){const t=dP(e);if(!Pu(t))return Eu(1);const n=t.getBoundingClientRect(),{width:r,height:s,$:i}=VG(t);let a=(i?DC(n.width):n.width)/r,o=(i?DC(n.height):n.height)/s;return(!a||!Number.isFinite(a))&&(a=1),(!o||!Number.isFinite(o))&&(o=1),{x:a,y:o}}const nwe=Eu(0);function WG(e){const t=ul(e);return!uP()||!t.visualViewport?nwe:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function rwe(e,t,n){return t===void 0&&(t=!1),!n||t&&n!==ul(e)?!1:t}function Em(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=!1);const s=e.getBoundingClientRect(),i=dP(e);let a=Eu(1);t&&(r?Pc(r)&&(a=I0(r)):a=I0(e));const o=rwe(i,n,r)?WG(i):Eu(0);let l=(s.left+o.x)/a.x,c=(s.top+o.y)/a.y,u=s.width/a.x,d=s.height/a.y;if(i){const h=ul(i),m=r&&Pc(r)?ul(r):r;let y=h,b=_j(y);for(;b&&r&&m!==y;){const v=I0(b),x=b.getBoundingClientRect(),w=Dc(b),S=x.left+(b.clientLeft+parseFloat(w.paddingLeft))*v.x,k=x.top+(b.clientTop+parseFloat(w.paddingTop))*v.y;l*=v.x,c*=v.y,u*=v.x,d*=v.y,l+=S,c+=k,y=ul(b),b=_j(y)}}return LC({width:u,height:d,x:l,y:c})}function fP(e,t){const n=IE(e).scrollLeft;return t?t.left+n:Em(zu(e)).left+n}function HG(e,t,n){n===void 0&&(n=!1);const r=e.getBoundingClientRect(),s=r.left+t.scrollLeft-(n?0:fP(e,r)),i=r.top+t.scrollTop;return{x:s,y:i}}function swe(e){let{elements:t,rect:n,offsetParent:r,strategy:s}=e;const i=s==="fixed",a=zu(r),o=t?ME(t.floating):!1;if(r===a||o&&i)return n;let l={scrollLeft:0,scrollTop:0},c=Eu(1);const u=Eu(0),d=Pu(r);if((d||!d&&!i)&&((Gy(r)!=="body"||y1(a))&&(l=IE(r)),Pu(r))){const m=Em(r);c=I0(r),u.x=m.x+r.clientLeft,u.y=m.y+r.clientTop}const h=a&&!d&&!i?HG(a,l,!0):Eu(0);return{width:n.width*c.x,height:n.height*c.y,x:n.x*c.x-l.scrollLeft*c.x+u.x+h.x,y:n.y*c.y-l.scrollTop*c.y+u.y+h.y}}function iwe(e){return Array.from(e.getClientRects())}function awe(e){const t=zu(e),n=IE(e),r=e.ownerDocument.body,s=ll(t.scrollWidth,t.clientWidth,r.scrollWidth,r.clientWidth),i=ll(t.scrollHeight,t.clientHeight,r.scrollHeight,r.clientHeight);let a=-n.scrollLeft+fP(e);const o=-n.scrollTop;return Dc(r).direction==="rtl"&&(a+=ll(t.clientWidth,r.clientWidth)-s),{width:s,height:i,x:a,y:o}}function owe(e,t){const n=ul(e),r=zu(e),s=n.visualViewport;let i=r.clientWidth,a=r.clientHeight,o=0,l=0;if(s){i=s.width,a=s.height;const c=uP();(!c||c&&t==="fixed")&&(o=s.offsetLeft,l=s.offsetTop)}return{width:i,height:a,x:o,y:l}}function lwe(e,t){const n=Em(e,!0,t==="fixed"),r=n.top+e.clientTop,s=n.left+e.clientLeft,i=Pu(e)?I0(e):Eu(1),a=e.clientWidth*i.x,o=e.clientHeight*i.y,l=s*i.x,c=r*i.y;return{width:a,height:o,x:l,y:c}}function F$(e,t,n){let r;if(t==="viewport")r=owe(e,n);else if(t==="document")r=awe(zu(e));else if(Pc(t))r=lwe(t,n);else{const s=WG(e);r={x:t.x-s.x,y:t.y-s.y,width:t.width,height:t.height}}return LC(r)}function GG(e,t){const n=Sh(e);return n===t||!Pc(n)||ay(n)?!1:Dc(n).position==="fixed"||GG(n,t)}function cwe(e,t){const n=t.get(e);if(n)return n;let r=sw(e,[],!1).filter(o=>Pc(o)&&Gy(o)!=="body"),s=null;const i=Dc(e).position==="fixed";let a=i?Sh(e):e;for(;Pc(a)&&!ay(a);){const o=Dc(a),l=cP(a);!l&&o.position==="fixed"&&(s=null),(i?!l&&!s:!l&&o.position==="static"&&!!s&&["absolute","fixed"].includes(s.position)||y1(a)&&!l&&GG(e,a))?r=r.filter(u=>u!==a):s=o,a=Sh(a)}return t.set(e,r),r}function uwe(e){let{element:t,boundary:n,rootBoundary:r,strategy:s}=e;const a=[...n==="clippingAncestors"?ME(t)?[]:cwe(t,this._c):[].concat(n),r],o=a[0],l=a.reduce((c,u)=>{const d=F$(t,u,s);return c.top=ll(d.top,c.top),c.right=wh(d.right,c.right),c.bottom=wh(d.bottom,c.bottom),c.left=ll(d.left,c.left),c},F$(t,o,s));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function dwe(e){const{width:t,height:n}=VG(e);return{width:t,height:n}}function fwe(e,t,n){const r=Pu(t),s=zu(t),i=n==="fixed",a=Em(e,!0,i,t);let o={scrollLeft:0,scrollTop:0};const l=Eu(0);if(r||!r&&!i)if((Gy(t)!=="body"||y1(s))&&(o=IE(t)),r){const h=Em(t,!0,i,t);l.x=h.x+t.clientLeft,l.y=h.y+t.clientTop}else s&&(l.x=fP(s));const c=s&&!r&&!i?HG(s,o):Eu(0),u=a.left+o.scrollLeft-l.x-c.x,d=a.top+o.scrollTop-l.y-c.y;return{x:u,y:d,width:a.width,height:a.height}}function JN(e){return Dc(e).position==="static"}function L$(e,t){if(!Pu(e)||Dc(e).position==="fixed")return null;if(t)return t(e);let n=e.offsetParent;return zu(e)===n&&(n=n.ownerDocument.body),n}function KG(e,t){const n=ul(e);if(ME(e))return n;if(!Pu(e)){let s=Sh(e);for(;s&&!ay(s);){if(Pc(s)&&!JN(s))return s;s=Sh(s)}return n}let r=L$(e,t);for(;r&&ewe(r)&&JN(r);)r=L$(r,t);return r&&ay(r)&&JN(r)&&!cP(r)?n:r||twe(e)||n}const hwe=async function(e){const t=this.getOffsetParent||KG,n=this.getDimensions,r=await n(e.floating);return{reference:fwe(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function pwe(e){return Dc(e).direction==="rtl"}const mwe={convertOffsetParentRelativeRectToViewportRelativeRect:swe,getDocumentElement:zu,getClippingRect:uwe,getOffsetParent:KG,getElementRects:hwe,getClientRects:iwe,getDimensions:dwe,getScale:I0,isElement:Pc,isRTL:pwe};function YG(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function gwe(e,t){let n=null,r;const s=zu(e);function i(){var o;clearTimeout(r),(o=n)==null||o.disconnect(),n=null}function a(o,l){o===void 0&&(o=!1),l===void 0&&(l=1),i();const c=e.getBoundingClientRect(),{left:u,top:d,width:h,height:m}=c;if(o||t(),!h||!m)return;const y=IS(d),b=IS(s.clientWidth-(u+h)),v=IS(s.clientHeight-(d+m)),x=IS(u),S={rootMargin:-y+"px "+-b+"px "+-v+"px "+-x+"px",threshold:ll(0,wh(1,l))||1};let k=!0;function C(T){const R=T[0].intersectionRatio;if(R!==l){if(!k)return a();R?a(!1,R):r=setTimeout(()=>{a(!1,1e-7)},1e3)}R===1&&!YG(c,e.getBoundingClientRect())&&a(),k=!1}try{n=new IntersectionObserver(C,{...S,root:s.ownerDocument})}catch{n=new IntersectionObserver(C,S)}n.observe(e)}return a(!0),i}function hP(e,t,n,r){r===void 0&&(r={});const{ancestorScroll:s=!0,ancestorResize:i=!0,elementResize:a=typeof ResizeObserver=="function",layoutShift:o=typeof IntersectionObserver=="function",animationFrame:l=!1}=r,c=dP(e),u=s||i?[...c?sw(c):[],...sw(t)]:[];u.forEach(x=>{s&&x.addEventListener("scroll",n,{passive:!0}),i&&x.addEventListener("resize",n)});const d=c&&o?gwe(c,n):null;let h=-1,m=null;a&&(m=new ResizeObserver(x=>{let[w]=x;w&&w.target===c&&m&&(m.unobserve(t),cancelAnimationFrame(h),h=requestAnimationFrame(()=>{var S;(S=m)==null||S.observe(t)})),n()}),c&&!l&&m.observe(c),m.observe(t));let y,b=l?Em(e):null;l&&v();function v(){const x=Em(e);b&&!YG(b,x)&&n(),b=x,y=requestAnimationFrame(v)}return n(),()=>{var x;u.forEach(w=>{s&&w.removeEventListener("scroll",n),i&&w.removeEventListener("resize",n)}),d==null||d(),(x=m)==null||x.disconnect(),m=null,l&&cancelAnimationFrame(y)}}const ywe=Zxe,bwe=Xxe,vwe=Gxe,xwe=Qxe,wwe=Kxe,B$=Hxe,_we=Jxe,Swe=(e,t,n)=>{const r=new Map,s={platform:mwe,...n},i={...s.platform,_c:r};return Wxe(e,t,{...s,platform:i})};var M2=typeof document<"u"?E.useLayoutEffect:E.useEffect;function BC(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let n,r,s;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(n=e.length,n!==t.length)return!1;for(r=n;r--!==0;)if(!BC(e[r],t[r]))return!1;return!0}if(s=Object.keys(e),n=s.length,n!==Object.keys(t).length)return!1;for(r=n;r--!==0;)if(!{}.hasOwnProperty.call(t,s[r]))return!1;for(r=n;r--!==0;){const i=s[r];if(!(i==="_owner"&&e.$$typeof)&&!BC(e[i],t[i]))return!1}return!0}return e!==e&&t!==t}function ZG(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function $$(e,t){const n=ZG(e);return Math.round(t*n)/n}function QN(e){const t=E.useRef(e);return M2(()=>{t.current=e}),t}function pP(e){e===void 0&&(e={});const{placement:t="bottom",strategy:n="absolute",middleware:r=[],platform:s,elements:{reference:i,floating:a}={},transform:o=!0,whileElementsMounted:l,open:c}=e,[u,d]=E.useState({x:0,y:0,strategy:n,placement:t,middlewareData:{},isPositioned:!1}),[h,m]=E.useState(r);BC(h,r)||m(r);const[y,b]=E.useState(null),[v,x]=E.useState(null),w=E.useCallback(L=>{L!==T.current&&(T.current=L,b(L))},[]),S=E.useCallback(L=>{L!==R.current&&(R.current=L,x(L))},[]),k=i||y,C=a||v,T=E.useRef(null),R=E.useRef(null),N=E.useRef(u),I=l!=null,P=QN(l),B=QN(s),D=QN(c),W=E.useCallback(()=>{if(!T.current||!R.current)return;const L={placement:t,strategy:n,middleware:h};B.current&&(L.platform=B.current),Swe(T.current,R.current,L).then(te=>{const V={...te,isPositioned:D.current!==!1};O.current&&!BC(N.current,V)&&(N.current=V,cl.flushSync(()=>{d(V)}))})},[h,t,n,B,D]);M2(()=>{c===!1&&N.current.isPositioned&&(N.current.isPositioned=!1,d(L=>({...L,isPositioned:!1})))},[c]);const O=E.useRef(!1);M2(()=>(O.current=!0,()=>{O.current=!1}),[]),M2(()=>{if(k&&(T.current=k),C&&(R.current=C),k&&C){if(P.current)return P.current(k,C,W);W()}},[k,C,W,P,I]);const Z=E.useMemo(()=>({reference:T,floating:R,setReference:w,setFloating:S}),[w,S]),U=E.useMemo(()=>({reference:k,floating:C}),[k,C]),H=E.useMemo(()=>{const L={position:n,left:0,top:0};if(!U.floating)return L;const te=$$(U.floating,u.x),V=$$(U.floating,u.y);return o?{...L,transform:"translate("+te+"px, "+V+"px)",...ZG(U.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:te,top:V}},[n,o,U.floating,u.x,u.y]);return E.useMemo(()=>({...u,update:W,refs:Z,elements:U,floatingStyles:H}),[u,W,Z,U,H])}const Cwe=e=>{function t(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:e,fn(n){const{element:r,padding:s}=typeof e=="function"?e(n):e;return r&&t(r)?r.current!=null?B$({element:r.current,padding:s}).fn(n):{}:r?B$({element:r,padding:s}).fn(n):{}}}},mP=(e,t)=>({...ywe(e),options:[e,t]}),gP=(e,t)=>({...bwe(e),options:[e,t]}),yP=(e,t)=>({..._we(e),options:[e,t]}),bP=(e,t)=>({...vwe(e),options:[e,t]}),vP=(e,t)=>({...xwe(e),options:[e,t]}),xP=(e,t)=>({...wwe(e),options:[e,t]}),wP=(e,t)=>({...Cwe(e),options:[e,t]});var kwe="Arrow",XG=E.forwardRef((e,t)=>{const{children:n,width:r=10,height:s=5,...i}=e;return f.jsx(lr.svg,{...i,ref:t,width:r,height:s,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?n:f.jsx("polygon",{points:"0,0 30,0 15,10"})})});XG.displayName=kwe;var Ewe=XG;function Ky(e){const[t,n]=E.useState(void 0);return si(()=>{if(e){n({width:e.offsetWidth,height:e.offsetHeight});const r=new ResizeObserver(s=>{if(!Array.isArray(s)||!s.length)return;const i=s[0];let a,o;if("borderBoxSize"in i){const l=i.borderBoxSize,c=Array.isArray(l)?l[0]:l;a=c.inlineSize,o=c.blockSize}else a=e.offsetWidth,o=e.offsetHeight;n({width:a,height:o})});return r.observe(e,{box:"border-box"}),()=>r.unobserve(e)}else n(void 0)},[e]),t}var _P="Popper",[JG,jE]=Ki(_P),[Twe,QG]=JG(_P),eK=e=>{const{__scopePopper:t,children:n}=e,[r,s]=E.useState(null);return f.jsx(Twe,{scope:t,anchor:r,onAnchorChange:s,children:n})};eK.displayName=_P;var tK="PopperAnchor",nK=E.forwardRef((e,t)=>{const{__scopePopper:n,virtualRef:r,...s}=e,i=QG(tK,n),a=E.useRef(null),o=Mn(t,a);return E.useEffect(()=>{i.onAnchorChange((r==null?void 0:r.current)||a.current)}),r?null:f.jsx(lr.div,{...s,ref:o})});nK.displayName=tK;var SP="PopperContent",[Awe,Rwe]=JG(SP),rK=E.forwardRef((e,t)=>{var Fe,Se,Ce,qe,Qe,We;const{__scopePopper:n,side:r="bottom",sideOffset:s=0,align:i="center",alignOffset:a=0,arrowPadding:o=0,avoidCollisions:l=!0,collisionBoundary:c=[],collisionPadding:u=0,sticky:d="partial",hideWhenDetached:h=!1,updatePositionStrategy:m="optimized",onPlaced:y,...b}=e,v=QG(SP,n),[x,w]=E.useState(null),S=Mn(t,Ie=>w(Ie)),[k,C]=E.useState(null),T=Ky(k),R=(T==null?void 0:T.width)??0,N=(T==null?void 0:T.height)??0,I=r+(i!=="center"?"-"+i:""),P=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},B=Array.isArray(c)?c:[c],D=B.length>0,W={padding:P,boundary:B.filter(Mwe),altBoundary:D},{refs:O,floatingStyles:Z,placement:U,isPositioned:H,middlewareData:L}=pP({strategy:"fixed",placement:I,whileElementsMounted:(...Ie)=>hP(...Ie,{animationFrame:m==="always"}),elements:{reference:v.anchor},middleware:[mP({mainAxis:s+N,alignmentAxis:a}),l&&gP({mainAxis:!0,crossAxis:!1,limiter:d==="partial"?yP():void 0,...W}),l&&bP({...W}),vP({...W,apply:({elements:Ie,rects:K,availableWidth:ye,availableHeight:Ne})=>{const{width:ce,height:oe}=K.reference,re=Ie.floating.style;re.setProperty("--radix-popper-available-width",`${ye}px`),re.setProperty("--radix-popper-available-height",`${Ne}px`),re.setProperty("--radix-popper-anchor-width",`${ce}px`),re.setProperty("--radix-popper-anchor-height",`${oe}px`)}}),k&&wP({element:k,padding:o}),Iwe({arrowWidth:R,arrowHeight:N}),h&&xP({strategy:"referenceHidden",...W})]}),[te,V]=aK(U),Q=Es(y);si(()=>{H&&(Q==null||Q())},[H,Q]);const ee=(Fe=L.arrow)==null?void 0:Fe.x,se=(Se=L.arrow)==null?void 0:Se.y,pe=((Ce=L.arrow)==null?void 0:Ce.centerOffset)!==0,[ue,Oe]=E.useState();return si(()=>{x&&Oe(window.getComputedStyle(x).zIndex)},[x]),f.jsx("div",{ref:O.setFloating,"data-radix-popper-content-wrapper":"",style:{...Z,transform:H?Z.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:ue,"--radix-popper-transform-origin":[(qe=L.transformOrigin)==null?void 0:qe.x,(Qe=L.transformOrigin)==null?void 0:Qe.y].join(" "),...((We=L.hide)==null?void 0:We.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:f.jsx(Awe,{scope:n,placedSide:te,onArrowChange:C,arrowX:ee,arrowY:se,shouldHideArrow:pe,children:f.jsx(lr.div,{"data-side":te,"data-align":V,...b,ref:S,style:{...b.style,animation:H?void 0:"none"}})})})});rK.displayName=SP;var sK="PopperArrow",Nwe={top:"bottom",right:"left",bottom:"top",left:"right"},iK=E.forwardRef(function(t,n){const{__scopePopper:r,...s}=t,i=Rwe(sK,r),a=Nwe[i.placedSide];return f.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[a]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:f.jsx(Ewe,{...s,ref:n,style:{...s.style,display:"block"}})})});iK.displayName=sK;function Mwe(e){return e!==null}var Iwe=e=>({name:"transformOrigin",options:e,fn(t){var v,x,w;const{placement:n,rects:r,middlewareData:s}=t,a=((v=s.arrow)==null?void 0:v.centerOffset)!==0,o=a?0:e.arrowWidth,l=a?0:e.arrowHeight,[c,u]=aK(n),d={start:"0%",center:"50%",end:"100%"}[u],h=(((x=s.arrow)==null?void 0:x.x)??0)+o/2,m=(((w=s.arrow)==null?void 0:w.y)??0)+l/2;let y="",b="";return c==="bottom"?(y=a?d:`${h}px`,b=`${-l}px`):c==="top"?(y=a?d:`${h}px`,b=`${r.floating.height+l}px`):c==="right"?(y=`${-l}px`,b=a?d:`${m}px`):c==="left"&&(y=`${r.floating.width+l}px`,b=a?d:`${m}px`),{data:{x:y,y:b}}}});function aK(e){const[t,n="center"]=e.split("-");return[t,n]}var oK=eK,lK=nK,cK=rK,uK=iK,jwe="Portal",OE=E.forwardRef((e,t)=>{var o;const{container:n,...r}=e,[s,i]=E.useState(!1);si(()=>i(!0),[]);const a=n||s&&((o=globalThis==null?void 0:globalThis.document)==null?void 0:o.body);return a?_E.createPortal(f.jsx(lr.div,{...r,ref:t}),a):null});OE.displayName=jwe;function Owe(e,t){return E.useReducer((n,r)=>t[n][r]??n,e)}var da=e=>{const{present:t,children:n}=e,r=Pwe(t),s=typeof n=="function"?n({present:r.isPresent}):E.Children.only(n),i=Mn(r.ref,Dwe(s));return typeof n=="function"||r.isPresent?E.cloneElement(s,{ref:i}):null};da.displayName="Presence";function Pwe(e){const[t,n]=E.useState(),r=E.useRef(null),s=E.useRef(e),i=E.useRef("none"),a=e?"mounted":"unmounted",[o,l]=Owe(a,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return E.useEffect(()=>{const c=jS(r.current);i.current=o==="mounted"?c:"none"},[o]),si(()=>{const c=r.current,u=s.current;if(u!==e){const h=i.current,m=jS(c);e?l("MOUNT"):m==="none"||(c==null?void 0:c.display)==="none"?l("UNMOUNT"):l(u&&h!==m?"ANIMATION_OUT":"UNMOUNT"),s.current=e}},[e,l]),si(()=>{if(t){let c;const u=t.ownerDocument.defaultView??window,d=m=>{const b=jS(r.current).includes(m.animationName);if(m.target===t&&b&&(l("ANIMATION_END"),!s.current)){const v=t.style.animationFillMode;t.style.animationFillMode="forwards",c=u.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=v)})}},h=m=>{m.target===t&&(i.current=jS(r.current))};return t.addEventListener("animationstart",h),t.addEventListener("animationcancel",d),t.addEventListener("animationend",d),()=>{u.clearTimeout(c),t.removeEventListener("animationstart",h),t.removeEventListener("animationcancel",d),t.removeEventListener("animationend",d)}}else l("ANIMATION_END")},[t,l]),{isPresent:["mounted","unmountSuspended"].includes(o),ref:E.useCallback(c=>{r.current=c?getComputedStyle(c):null,n(c)},[])}}function jS(e){return(e==null?void 0:e.animationName)||"none"}function Dwe(e){var r,s;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(s=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:s.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var Fwe=Symbol("radix.slottable");function Lwe(e){const t=({children:n})=>f.jsx(f.Fragment,{children:n});return t.displayName=`${e}.Slottable`,t.__radixId=Fwe,t}var Bwe=eH[" useInsertionEffect ".trim().toString()]||si;function Fc({prop:e,defaultProp:t,onChange:n=()=>{},caller:r}){const[s,i,a]=$we({defaultProp:t,onChange:n}),o=e!==void 0,l=o?e:s;{const u=E.useRef(e!==void 0);E.useEffect(()=>{const d=u.current;d!==o&&console.warn(`${r} is changing from ${d?"controlled":"uncontrolled"} to ${o?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),u.current=o},[o,r])}const c=E.useCallback(u=>{var d;if(o){const h=zwe(u)?u(e):u;h!==e&&((d=a.current)==null||d.call(a,h))}else i(u)},[o,e,i,a]);return[l,c]}function $we({defaultProp:e,onChange:t}){const[n,r]=E.useState(e),s=E.useRef(n),i=E.useRef(t);return Bwe(()=>{i.current=t},[t]),E.useEffect(()=>{var a;s.current!==n&&((a=i.current)==null||a.call(i,n),s.current=n)},[n,s]),[n,r,i]}function zwe(e){return typeof e=="function"}var Uwe=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),qwe="VisuallyHidden",dK=E.forwardRef((e,t)=>f.jsx(lr.span,{...e,ref:t,style:{...Uwe,...e.style}}));dK.displayName=qwe;var Vwe=dK,[PE,fdt]=Ki("Tooltip",[jE]),DE=jE(),fK="TooltipProvider",Wwe=700,Sj="tooltip.open",[Hwe,CP]=PE(fK),hK=e=>{const{__scopeTooltip:t,delayDuration:n=Wwe,skipDelayDuration:r=300,disableHoverableContent:s=!1,children:i}=e,a=E.useRef(!0),o=E.useRef(!1),l=E.useRef(0);return E.useEffect(()=>{const c=l.current;return()=>window.clearTimeout(c)},[]),f.jsx(Hwe,{scope:t,isOpenDelayedRef:a,delayDuration:n,onOpen:E.useCallback(()=>{window.clearTimeout(l.current),a.current=!1},[]),onClose:E.useCallback(()=>{window.clearTimeout(l.current),l.current=window.setTimeout(()=>a.current=!0,r)},[r]),isPointerInTransitRef:o,onPointerInTransitChange:E.useCallback(c=>{o.current=c},[]),disableHoverableContent:s,children:i})};hK.displayName=fK;var iw="Tooltip",[Gwe,b1]=PE(iw),pK=e=>{const{__scopeTooltip:t,children:n,open:r,defaultOpen:s,onOpenChange:i,disableHoverableContent:a,delayDuration:o}=e,l=CP(iw,e.__scopeTooltip),c=DE(t),[u,d]=E.useState(null),h=la(),m=E.useRef(0),y=a??l.disableHoverableContent,b=o??l.delayDuration,v=E.useRef(!1),[x,w]=Fc({prop:r,defaultProp:s??!1,onChange:R=>{R?(l.onOpen(),document.dispatchEvent(new CustomEvent(Sj))):l.onClose(),i==null||i(R)},caller:iw}),S=E.useMemo(()=>x?v.current?"delayed-open":"instant-open":"closed",[x]),k=E.useCallback(()=>{window.clearTimeout(m.current),m.current=0,v.current=!1,w(!0)},[w]),C=E.useCallback(()=>{window.clearTimeout(m.current),m.current=0,w(!1)},[w]),T=E.useCallback(()=>{window.clearTimeout(m.current),m.current=window.setTimeout(()=>{v.current=!0,w(!0),m.current=0},b)},[b,w]);return E.useEffect(()=>()=>{m.current&&(window.clearTimeout(m.current),m.current=0)},[]),f.jsx(oK,{...c,children:f.jsx(Gwe,{scope:t,contentId:h,open:x,stateAttribute:S,trigger:u,onTriggerChange:d,onTriggerEnter:E.useCallback(()=>{l.isOpenDelayedRef.current?T():k()},[l.isOpenDelayedRef,T,k]),onTriggerLeave:E.useCallback(()=>{y?C():(window.clearTimeout(m.current),m.current=0)},[C,y]),onOpen:k,onClose:C,disableHoverableContent:y,children:n})})};pK.displayName=iw;var Cj="TooltipTrigger",mK=E.forwardRef((e,t)=>{const{__scopeTooltip:n,...r}=e,s=b1(Cj,n),i=CP(Cj,n),a=DE(n),o=E.useRef(null),l=Mn(t,o,s.onTriggerChange),c=E.useRef(!1),u=E.useRef(!1),d=E.useCallback(()=>c.current=!1,[]);return E.useEffect(()=>()=>document.removeEventListener("pointerup",d),[d]),f.jsx(lK,{asChild:!0,...a,children:f.jsx(lr.button,{"aria-describedby":s.open?s.contentId:void 0,"data-state":s.stateAttribute,...r,ref:l,onPointerMove:Wt(e.onPointerMove,h=>{h.pointerType!=="touch"&&!u.current&&!i.isPointerInTransitRef.current&&(s.onTriggerEnter(),u.current=!0)}),onPointerLeave:Wt(e.onPointerLeave,()=>{s.onTriggerLeave(),u.current=!1}),onPointerDown:Wt(e.onPointerDown,()=>{s.open&&s.onClose(),c.current=!0,document.addEventListener("pointerup",d,{once:!0})}),onFocus:Wt(e.onFocus,()=>{c.current||s.onOpen()}),onBlur:Wt(e.onBlur,s.onClose),onClick:Wt(e.onClick,s.onClose)})})});mK.displayName=Cj;var kP="TooltipPortal",[Kwe,Ywe]=PE(kP,{forceMount:void 0}),gK=e=>{const{__scopeTooltip:t,forceMount:n,children:r,container:s}=e,i=b1(kP,t);return f.jsx(Kwe,{scope:t,forceMount:n,children:f.jsx(da,{present:n||i.open,children:f.jsx(OE,{asChild:!0,container:s,children:r})})})};gK.displayName=kP;var oy="TooltipContent",yK=E.forwardRef((e,t)=>{const n=Ywe(oy,e.__scopeTooltip),{forceMount:r=n.forceMount,side:s="top",...i}=e,a=b1(oy,e.__scopeTooltip);return f.jsx(da,{present:r||a.open,children:a.disableHoverableContent?f.jsx(bK,{side:s,...i,ref:t}):f.jsx(Zwe,{side:s,...i,ref:t})})}),Zwe=E.forwardRef((e,t)=>{const n=b1(oy,e.__scopeTooltip),r=CP(oy,e.__scopeTooltip),s=E.useRef(null),i=Mn(t,s),[a,o]=E.useState(null),{trigger:l,onClose:c}=n,u=s.current,{onPointerInTransitChange:d}=r,h=E.useCallback(()=>{o(null),d(!1)},[d]),m=E.useCallback((y,b)=>{const v=y.currentTarget,x={x:y.clientX,y:y.clientY},w=e1e(x,v.getBoundingClientRect()),S=t1e(x,w),k=n1e(b.getBoundingClientRect()),C=s1e([...S,...k]);o(C),d(!0)},[d]);return E.useEffect(()=>()=>h(),[h]),E.useEffect(()=>{if(l&&u){const y=v=>m(v,u),b=v=>m(v,l);return l.addEventListener("pointerleave",y),u.addEventListener("pointerleave",b),()=>{l.removeEventListener("pointerleave",y),u.removeEventListener("pointerleave",b)}}},[l,u,m,h]),E.useEffect(()=>{if(a){const y=b=>{const v=b.target,x={x:b.clientX,y:b.clientY},w=(l==null?void 0:l.contains(v))||(u==null?void 0:u.contains(v)),S=!r1e(x,a);w?h():S&&(h(),c())};return document.addEventListener("pointermove",y),()=>document.removeEventListener("pointermove",y)}},[l,u,a,c,h]),f.jsx(bK,{...e,ref:i})}),[Xwe,Jwe]=PE(iw,{isInside:!1}),Qwe=Lwe("TooltipContent"),bK=E.forwardRef((e,t)=>{const{__scopeTooltip:n,children:r,"aria-label":s,onEscapeKeyDown:i,onPointerDownOutside:a,...o}=e,l=b1(oy,n),c=DE(n),{onClose:u}=l;return E.useEffect(()=>(document.addEventListener(Sj,u),()=>document.removeEventListener(Sj,u)),[u]),E.useEffect(()=>{if(l.trigger){const d=h=>{const m=h.target;m!=null&&m.contains(l.trigger)&&u()};return window.addEventListener("scroll",d,{capture:!0}),()=>window.removeEventListener("scroll",d,{capture:!0})}},[l.trigger,u]),f.jsx(RE,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:i,onPointerDownOutside:a,onFocusOutside:d=>d.preventDefault(),onDismiss:u,children:f.jsxs(cK,{"data-state":l.stateAttribute,...c,...o,ref:t,style:{...o.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[f.jsx(Qwe,{children:r}),f.jsx(Xwe,{scope:n,isInside:!0,children:f.jsx(Vwe,{id:l.contentId,role:"tooltip",children:s||r})})]})})});yK.displayName=oy;var vK="TooltipArrow",xK=E.forwardRef((e,t)=>{const{__scopeTooltip:n,...r}=e,s=DE(n);return Jwe(vK,n).isInside?null:f.jsx(uK,{...s,...r,ref:t})});xK.displayName=vK;function e1e(e,t){const n=Math.abs(t.top-e.y),r=Math.abs(t.bottom-e.y),s=Math.abs(t.right-e.x),i=Math.abs(t.left-e.x);switch(Math.min(n,r,s,i)){case i:return"left";case s:return"right";case n:return"top";case r:return"bottom";default:throw new Error("unreachable")}}function t1e(e,t,n=5){const r=[];switch(t){case"top":r.push({x:e.x-n,y:e.y+n},{x:e.x+n,y:e.y+n});break;case"bottom":r.push({x:e.x-n,y:e.y-n},{x:e.x+n,y:e.y-n});break;case"left":r.push({x:e.x+n,y:e.y-n},{x:e.x+n,y:e.y+n});break;case"right":r.push({x:e.x-n,y:e.y-n},{x:e.x-n,y:e.y+n});break}return r}function n1e(e){const{top:t,right:n,bottom:r,left:s}=e;return[{x:s,y:t},{x:n,y:t},{x:n,y:r},{x:s,y:r}]}function r1e(e,t){const{x:n,y:r}=e;let s=!1;for(let i=0,a=t.length-1;i<t.length;a=i++){const o=t[i],l=t[a],c=o.x,u=o.y,d=l.x,h=l.y;u>r!=h>r&&n<(d-c)*(r-u)/(h-u)+c&&(s=!s)}return s}function s1e(e){const t=e.slice();return t.sort((n,r)=>n.x<r.x?-1:n.x>r.x?1:n.y<r.y?-1:n.y>r.y?1:0),i1e(t)}function i1e(e){if(e.length<=1)return e.slice();const t=[];for(let r=0;r<e.length;r++){const s=e[r];for(;t.length>=2;){const i=t[t.length-1],a=t[t.length-2];if((i.x-a.x)*(s.y-a.y)>=(i.y-a.y)*(s.x-a.x))t.pop();else break}t.push(s)}t.pop();const n=[];for(let r=e.length-1;r>=0;r--){const s=e[r];for(;n.length>=2;){const i=n[n.length-1],a=n[n.length-2];if((i.x-a.x)*(s.y-a.y)>=(i.y-a.y)*(s.x-a.x))n.pop();else break}n.push(s)}return n.pop(),t.length===1&&n.length===1&&t[0].x===n[0].x&&t[0].y===n[0].y?t:t.concat(n)}var a1e=hK,o1e=pK,l1e=mK,c1e=gK,u1e=yK,d1e=xK;function xr({delayDuration:e=0,...t}){return f.jsx(a1e,{"data-slot":"tooltip-provider",delayDuration:e,...t})}function wr({...e}){return f.jsx(xr,{children:f.jsx(o1e,{"data-slot":"tooltip",...e})})}function _r({...e}){return f.jsx(l1e,{"data-slot":"tooltip-trigger",...e})}function Sr({className:e,sideOffset:t=0,children:n,...r}){return f.jsx(c1e,{children:f.jsxs(u1e,{"data-slot":"tooltip-content",sideOffset:t,className:Xe("bg-primary text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-fit origin-(--radix-tooltip-content-transform-origin) rounded-md px-3 py-1.5 text-xs text-balance",e),...r,children:[n,f.jsx(d1e,{className:"bg-primary fill-primary z-50 size-2.5 translate-y-[calc(-50%_-_2px)] rotate-45 rounded-[2px]"})]})})}class f1e{static findRendererForLanguage(t,n){const r=Object.values(n);if(r.length===0)return null;const s=r.filter(o=>{var l;return(l=o.supportedLanguages)==null?void 0:l.includes(t||"")}),i=r.filter(o=>!o.supportedLanguages||o.supportedLanguages.length===0);return[...s,...i].sort((o,l)=>(l.priority||0)-(o.priority||0))[0]||null}static renderBlock(t){const n=Vi.getState().blockRenderers,r=this.findRendererForLanguage(t.lang,n);if(!r)return null;try{return r.renderer(t)}catch(s){return console.error(`[BlockRendererService] Error rendering block with renderer ${r.id}:`,s),null}}static getRegisteredRenderers(){return Vi.getState().blockRenderers}static hasRendererForLanguage(t){const n=Vi.getState().blockRenderers;return this.findRendererForLanguage(t,n)!==null}}const Yy=({lang:e,code:t,filepath:n,isStreaming:r=!1,interactionId:s})=>{const i=Vi(yn(l=>l.blockRenderers)),a=E.useMemo(()=>as(),[]),o=E.useMemo(()=>{const l={lang:e,code:t,filepath:n,isStreaming:r,blockId:a,interactionId:s},c=f1e.findRendererForLanguage(e,i);if(!c){const u=e?`language-${e}`:"language-plaintext";return f.jsxs("div",{className:"code-block-container my-4 max-w-full",children:[f.jsx("div",{className:"code-block-header flex items-center justify-between px-3 py-2 border border-b-0 border-border bg-muted/50 rounded-t-lg",children:f.jsx("div",{className:"text-sm font-medium",children:e?e.toUpperCase():"CODE"})}),f.jsx("pre",{className:"overflow-x-auto w-full relative overflow-wrap-anywhere border border-border rounded-b-lg bg-muted/20",children:f.jsx("code",{className:`${u} block p-4 font-mono text-sm leading-relaxed`,children:t})})]})}try{return c.renderer(l)}catch(u){return console.error(`[UniversalBlockRenderer] Error rendering block with renderer ${c.id}:`,u),f.jsxs("div",{className:"code-block-container my-4 max-w-full",children:[f.jsx("div",{className:"code-block-header flex items-center justify-between px-3 py-2 border border-b-0 border-border bg-muted/50 rounded-t-lg",children:f.jsxs("div",{className:"text-sm font-medium text-destructive",children:[e?e.toUpperCase():"CODE"," (Render Error)"]})}),f.jsx("pre",{className:"overflow-x-auto w-full relative overflow-wrap-anywhere border border-border rounded-b-lg bg-muted/20",children:f.jsx("code",{className:"block p-4 font-mono text-sm leading-relaxed",children:t})})]})}},[e,t,n,r,a,i]);return f.jsx(f.Fragment,{children:o})};var bt;(function(e){e[e.EPERM=1]="EPERM",e[e.ENOENT=2]="ENOENT",e[e.EINTR=4]="EINTR",e[e.EIO=5]="EIO",e[e.ENXIO=6]="ENXIO",e[e.EBADF=9]="EBADF",e[e.EAGAIN=11]="EAGAIN",e[e.ENOMEM=12]="ENOMEM",e[e.EACCES=13]="EACCES",e[e.EFAULT=14]="EFAULT",e[e.ENOTBLK=15]="ENOTBLK",e[e.EBUSY=16]="EBUSY",e[e.EEXIST=17]="EEXIST",e[e.EXDEV=18]="EXDEV",e[e.ENODEV=19]="ENODEV",e[e.ENOTDIR=20]="ENOTDIR",e[e.EISDIR=21]="EISDIR",e[e.EINVAL=22]="EINVAL",e[e.ENFILE=23]="ENFILE",e[e.EMFILE=24]="EMFILE",e[e.ETXTBSY=26]="ETXTBSY",e[e.EFBIG=27]="EFBIG",e[e.ENOSPC=28]="ENOSPC",e[e.ESPIPE=29]="ESPIPE",e[e.EROFS=30]="EROFS",e[e.EMLINK=31]="EMLINK",e[e.EPIPE=32]="EPIPE",e[e.EDOM=33]="EDOM",e[e.ERANGE=34]="ERANGE",e[e.EDEADLK=35]="EDEADLK",e[e.ENAMETOOLONG=36]="ENAMETOOLONG",e[e.ENOLCK=37]="ENOLCK",e[e.ENOSYS=38]="ENOSYS",e[e.ENOTEMPTY=39]="ENOTEMPTY",e[e.ELOOP=40]="ELOOP",e[e.ENOMSG=42]="ENOMSG",e[e.EBADE=52]="EBADE",e[e.EBADR=53]="EBADR",e[e.EXFULL=54]="EXFULL",e[e.ENOANO=55]="ENOANO",e[e.EBADRQC=56]="EBADRQC",e[e.ENOSTR=60]="ENOSTR",e[e.ENODATA=61]="ENODATA",e[e.ETIME=62]="ETIME",e[e.ENOSR=63]="ENOSR",e[e.ENONET=64]="ENONET",e[e.EREMOTE=66]="EREMOTE",e[e.ENOLINK=67]="ENOLINK",e[e.ECOMM=70]="ECOMM",e[e.EPROTO=71]="EPROTO",e[e.EBADMSG=74]="EBADMSG",e[e.EOVERFLOW=75]="EOVERFLOW",e[e.EBADFD=77]="EBADFD",e[e.ESTRPIPE=86]="ESTRPIPE",e[e.ENOTSOCK=88]="ENOTSOCK",e[e.EDESTADDRREQ=89]="EDESTADDRREQ",e[e.EMSGSIZE=90]="EMSGSIZE",e[e.EPROTOTYPE=91]="EPROTOTYPE",e[e.ENOPROTOOPT=92]="ENOPROTOOPT",e[e.EPROTONOSUPPORT=93]="EPROTONOSUPPORT",e[e.ESOCKTNOSUPPORT=94]="ESOCKTNOSUPPORT",e[e.ENOTSUP=95]="ENOTSUP",e[e.ENETDOWN=100]="ENETDOWN",e[e.ENETUNREACH=101]="ENETUNREACH",e[e.ENETRESET=102]="ENETRESET",e[e.ETIMEDOUT=110]="ETIMEDOUT",e[e.ECONNREFUSED=111]="ECONNREFUSED",e[e.EHOSTDOWN=112]="EHOSTDOWN",e[e.EHOSTUNREACH=113]="EHOSTUNREACH",e[e.EALREADY=114]="EALREADY",e[e.EINPROGRESS=115]="EINPROGRESS",e[e.ESTALE=116]="ESTALE",e[e.EREMOTEIO=121]="EREMOTEIO",e[e.EDQUOT=122]="EDQUOT"})(bt||(bt={}));const z$={[bt.EPERM]:"Operation not permitted",[bt.ENOENT]:"No such file or directory",[bt.EINTR]:"Interrupted system call",[bt.EIO]:"Input/output error",[bt.ENXIO]:"No such device or address",[bt.EBADF]:"Bad file descriptor",[bt.EAGAIN]:"Resource temporarily unavailable",[bt.ENOMEM]:"Cannot allocate memory",[bt.EACCES]:"Permission denied",[bt.EFAULT]:"Bad address",[bt.ENOTBLK]:"Block device required",[bt.EBUSY]:"Resource busy or locked",[bt.EEXIST]:"File exists",[bt.EXDEV]:"Invalid cross-device link",[bt.ENODEV]:"No such device",[bt.ENOTDIR]:"File is not a directory",[bt.EISDIR]:"File is a directory",[bt.EINVAL]:"Invalid argument",[bt.ENFILE]:"Too many open files in system",[bt.EMFILE]:"Too many open files",[bt.ETXTBSY]:"Text file busy",[bt.EFBIG]:"File is too big",[bt.ENOSPC]:"No space left on disk",[bt.ESPIPE]:"Illegal seek",[bt.EROFS]:"Cannot modify a read-only file system",[bt.EMLINK]:"Too many links",[bt.EPIPE]:"Broken pipe",[bt.EDOM]:"Numerical argument out of domain",[bt.ERANGE]:"Numerical result out of range",[bt.EDEADLK]:"Resource deadlock would occur",[bt.ENAMETOOLONG]:"File name too long",[bt.ENOLCK]:"No locks available",[bt.ENOSYS]:"Function not implemented",[bt.ENOTEMPTY]:"Directory is not empty",[bt.ELOOP]:"Too many levels of symbolic links",[bt.ENOMSG]:"No message of desired type",[bt.EBADE]:"Invalid exchange",[bt.EBADR]:"Invalid request descriptor",[bt.EXFULL]:"Exchange full",[bt.ENOANO]:"No anode",[bt.EBADRQC]:"Invalid request code",[bt.ENOSTR]:"Device not a stream",[bt.ENODATA]:"No data available",[bt.ETIME]:"Timer expired",[bt.ENOSR]:"Out of streams resources",[bt.ENONET]:"Machine is not on the network",[bt.EREMOTE]:"Object is remote",[bt.ENOLINK]:"Link has been severed",[bt.ECOMM]:"Communication error on send",[bt.EPROTO]:"Protocol error",[bt.EBADMSG]:"Bad message",[bt.EOVERFLOW]:"Value too large for defined data type",[bt.EBADFD]:"File descriptor in bad state",[bt.ESTRPIPE]:"Streams pipe error",[bt.ENOTSOCK]:"Socket operation on non-socket",[bt.EDESTADDRREQ]:"Destination address required",[bt.EMSGSIZE]:"Message too long",[bt.EPROTOTYPE]:"Protocol wrong type for socket",[bt.ENOPROTOOPT]:"Protocol not available",[bt.EPROTONOSUPPORT]:"Protocol not supported",[bt.ESOCKTNOSUPPORT]:"Socket type not supported",[bt.ENOTSUP]:"Operation is not supported",[bt.ENETDOWN]:"Network is down",[bt.ENETUNREACH]:"Network is unreachable",[bt.ENETRESET]:"Network dropped connection on reset",[bt.ETIMEDOUT]:"Connection timed out",[bt.ECONNREFUSED]:"Connection refused",[bt.EHOSTDOWN]:"Host is down",[bt.EHOSTUNREACH]:"No route to host",[bt.EALREADY]:"Operation already in progress",[bt.EINPROGRESS]:"Operation now in progress",[bt.ESTALE]:"Stale file handle",[bt.EREMOTEIO]:"Remote I/O error",[bt.EDQUOT]:"Disk quota exceeded"};class Ze extends Error{static fromJSON(t){const n=new Ze(t.errno,t.message,t.path,t.syscall);return n.code=t.code,n.stack=t.stack,n}static With(t,n,r){return new Ze(bt[t],z$[bt[t]],n,r)}constructor(t,n=z$[t],r,s=""){super(n),this.errno=t,this.message=n,this.path=r,this.syscall=s,this.code=bt[t]}toString(){return this.code+": "+this.message+(this.path?`, '${this.path}'`:"")}toJSON(){return{errno:this.errno,code:this.code,path:this.path,stack:this.stack,message:this.message,syscall:this.syscall}}bufferSize(){return 4+JSON.stringify(this.toJSON()).length}}var eM={exports:{}},U$;function h1e(){return U$||(U$=1,function(e){var t=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function s(l,c,u){this.fn=l,this.context=c,this.once=u||!1}function i(l,c,u,d,h){if(typeof u!="function")throw new TypeError("The listener must be a function");var m=new s(u,d||l,h),y=n?n+c:c;return l._events[y]?l._events[y].fn?l._events[y]=[l._events[y],m]:l._events[y].push(m):(l._events[y]=m,l._eventsCount++),l}function a(l,c){--l._eventsCount===0?l._events=new r:delete l._events[c]}function o(){this._events=new r,this._eventsCount=0}o.prototype.eventNames=function(){var c=[],u,d;if(this._eventsCount===0)return c;for(d in u=this._events)t.call(u,d)&&c.push(n?d.slice(1):d);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(u)):c},o.prototype.listeners=function(c){var u=n?n+c:c,d=this._events[u];if(!d)return[];if(d.fn)return[d.fn];for(var h=0,m=d.length,y=new Array(m);h<m;h++)y[h]=d[h].fn;return y},o.prototype.listenerCount=function(c){var u=n?n+c:c,d=this._events[u];return d?d.fn?1:d.length:0},o.prototype.emit=function(c,u,d,h,m,y){var b=n?n+c:c;if(!this._events[b])return!1;var v=this._events[b],x=arguments.length,w,S;if(v.fn){switch(v.once&&this.removeListener(c,v.fn,void 0,!0),x){case 1:return v.fn.call(v.context),!0;case 2:return v.fn.call(v.context,u),!0;case 3:return v.fn.call(v.context,u,d),!0;case 4:return v.fn.call(v.context,u,d,h),!0;case 5:return v.fn.call(v.context,u,d,h,m),!0;case 6:return v.fn.call(v.context,u,d,h,m,y),!0}for(S=1,w=new Array(x-1);S<x;S++)w[S-1]=arguments[S];v.fn.apply(v.context,w)}else{var k=v.length,C;for(S=0;S<k;S++)switch(v[S].once&&this.removeListener(c,v[S].fn,void 0,!0),x){case 1:v[S].fn.call(v[S].context);break;case 2:v[S].fn.call(v[S].context,u);break;case 3:v[S].fn.call(v[S].context,u,d);break;case 4:v[S].fn.call(v[S].context,u,d,h);break;default:if(!w)for(C=1,w=new Array(x-1);C<x;C++)w[C-1]=arguments[C];v[S].fn.apply(v[S].context,w)}}return!0},o.prototype.on=function(c,u,d){return i(this,c,u,d,!1)},o.prototype.once=function(c,u,d){return i(this,c,u,d,!0)},o.prototype.removeListener=function(c,u,d,h){var m=n?n+c:c;if(!this._events[m])return this;if(!u)return a(this,m),this;var y=this._events[m];if(y.fn)y.fn===u&&(!h||y.once)&&(!d||y.context===d)&&a(this,m);else{for(var b=0,v=[],x=y.length;b<x;b++)(y[b].fn!==u||h&&!y[b].once||d&&y[b].context!==d)&&v.push(y[b]);v.length?this._events[m]=v.length===1?v[0]:v:a(this,m)}return this},o.prototype.removeAllListeners=function(c){var u;return c?(u=n?n+c:c,this._events[u]&&a(this,u)):(this._events=new r,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=n,o.EventEmitter=o,e.exports=o}(eM)),eM.exports}var p1e=h1e();const EP=ua(p1e);var YW;let m1e=class extends EP{constructor(n){super();de(this,YW,"List");de(this,"data",new Set);n&&this.push(...n)}toSet(){return new Set(this.data)}toArray(){return Array.from(this.data)}toJSON(){return JSON.stringify(Array.from(this.data))}toString(){return this.join(",")}_set(n,r,s=!1){if(Math.abs(n)>this.data.size)throw new ReferenceError("Can not set an element outside the bounds of the list");const i=Array.from(this.data);i.splice(n,+s,r),this.data=new Set(i),this.emit("update")}set(n,r){this._set(n,r,!0)}deleteAt(n){if(Math.abs(n)>this.data.size)throw new ReferenceError("Can not delete an element outside the bounds of the list");this.delete(Array.from(this.data).at(n))}insert(n,r=this.data.size){this._set(r,n,!1)}at(n){if(Math.abs(n)>this.data.size)throw new ReferenceError("Can not access an element outside the bounds of the list");return Array.from(this.data).at(n)}pop(){const n=Array.from(this.data).pop();return n!==void 0&&this.delete(n),n}push(...n){for(const r of n)this.add(r);return this.data.size}join(n){return Array.from(this.data).join(n)}splice(n,r,...s){if(Math.abs(n)>this.data.size)throw new ReferenceError("Can not splice elements outside the bounds of the list");const i=Array.from(this.data),a=i.splice(n,r,...s);return this.data=new Set(i),this.emit("update"),a}add(n){return this.data.add(n),this.emit("update"),this.emit("add",n),this}clear(){this.data.clear(),this.emit("update")}delete(n){const r=this.data.delete(n);return this.emit("update"),r}has(n){return this.data.has(n)}get size(){return this.data.size}entries(){return this.toArray().entries()}keys(){return this.toArray().keys()}values(){return this.data.values()}[(YW=Symbol.toStringTag,Symbol.iterator)](){return this.data[Symbol.iterator]()}};function q$(e=new Error){const t=setTimeout(()=>{throw e},5e3);return()=>clearTimeout(t)}function vs(e){throw e}const V$=Intl.NumberFormat("en",{notation:"compact"});V$.format.bind(V$);function Um(e,...t){const n={};for(const r of t.flat())n[r]=e[r];return n}function g1e(e){try{return JSON.parse(e),!0}catch{return!1}}function kj(e=0,t=1){return Math.round(Math.random()*(t-e)+e)}function TP(e){return e.at(0).toUpperCase()+e.slice(1)}const y1e=new TextEncoder;function Xp(e){return y1e.encode(e)}const W$=new TextDecoder;function AP(e){if(!e)return"";if(e.buffer instanceof ArrayBuffer&&!e.buffer.resizable)return W$.decode(e);const t=new Uint8Array(e.byteLength);return t.set(e),W$.decode(t)}function aw(e,t){if(e.byteLength>=t)return e;if(ArrayBuffer.isView(e)){const r=aw(e.buffer,t);return new e.constructor(r,e.byteOffset,t)}const n=typeof SharedArrayBuffer<"u"&&e instanceof SharedArrayBuffer;if(e.maxByteLength>t)return n?e.grow(t):e.resize(t),e;if(n){const r=new SharedArrayBuffer(t);return new Uint8Array(r).set(new Uint8Array(e)),r}try{return e.transfer(t)}catch{const r=new ArrayBuffer(t);return new Uint8Array(r).set(new Uint8Array(e)),r}}function b1e(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}var v1e={};let x1e="process"in globalThis&&"env"in globalThis.process&&v1e.U_DEBUG=="true";function ow(...e){x1e&&console.debug("[U]",...e)}const H$=["int8","uint8","int16","uint16","int32","uint32","int64","uint64","int128","uint128","float32","float64","float128"],w1e=[...H$,...H$.map(e=>TP(e)),"char"],RP=/^(u?int|float)(8|16|32|64|128)$/i;function wK(e){return e=="char"?"uint8":e.toLowerCase()}function NP(e){return RP.test(e.toString())}function Ej(e){return e=="char"||RP.test(e.toString().toLowerCase())}function _1e(e){if(!Ej(e))throw new TypeError("Not a valid primitive type: "+e)}const G$=BigInt("0xffffffffffffffff");Symbol.metadata??(Symbol.metadata=Symbol.for("Symbol.metadata"));Object.assign(Symbol,{size:Symbol("uSize"),serialize:Symbol("uSerialize"),deserialize:Symbol("uDeserialize")});function _K(e){return e.metadata??(e.metadata={}),e.metadata.structInit=[...e.metadata.structInit??[]],e.metadata.structInit}function S1e(e){return e!=null&&typeof e=="object"&&"struct"in e}function FE(e){Symbol.metadata in e||Object.defineProperty(e,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:Object.create(null)})}function Ac(e){return typeof e=="function"&&Symbol.metadata in e&&S1e(e[Symbol.metadata])}function v1(e){return e!=null&&typeof e=="object"&&Ac(e.constructor)}function SK(e){if(!v1(e))throw new TypeError((typeof e=="function"?e.name:typeof e=="object"&&e?e.constructor.name:e)+" is not a struct instance")}function MP(e){return v1(e)||Ac(e)}function CK(e){if(!MP(e))throw new TypeError((typeof e=="function"?e.name:typeof e=="object"&&e?e.constructor.name:e)+" is not a struct")}function IP(e){return typeof e=="object"&&e!=null&&Symbol.size in e}function qs(e){if(e==null)return 0;if(Array.isArray(e)){let s=0;for(let i=0;i<e.length;i++)s+=qs(e[i]);return s}if(typeof e=="string")return _1e(e),+wK(e).match(RP)[2]/8;if(IP(e))return e[Symbol.size];CK(e);const t=Ac(e)?e:e.constructor;FE(t);const{struct:n}=t[Symbol.metadata];let r=n.staticSize;if(Ac(e))return r;for(const s of n.members.values()){const i=e[s.name];if(v1(i)&&i.constructor[Symbol.metadata].struct.isDynamic){n.isUnion?r=Math.max(r,qs(i)):r+=qs(i);continue}if(typeof s.length!="string")continue;let a=0;for(let o=0;o<e[s.length];o++)a+=qs(MP(i[o])?i[o]:s.type);n.isUnion?r=Math.max(r,a):r+=a}return r}function C1e(e,t){var i;CK(e);const n=Ac(e)?e:e.constructor;FE(n);const{struct:r}=n[Symbol.metadata];if(Ac(e)||!r.isDynamic)return((i=r.members.get(t))==null?void 0:i.staticOffset)??vs(new Error("Struct does not have member: "+t));let s=0;for(const a of r.members.values()){if(a.name==t)return s;const o=e[a.name];s+=qs(MP(o)?o:a.type)}throw new Error("Struct does not have member: "+t)}function k1e(e,t){return Math.ceil(e/t)*t}function qm(e={}){return function(n,r){const s=new Map;let i=0,a=!1;for(const{name:o,type:l,length:c}of _K(r)){if(!Ej(l)&&!Ac(l))throw new TypeError("Not a valid type: "+l);if(typeof c=="string"){const h=s.get(c);if(!h)throw new Error(`"${c}" is undefined or declared after "${o}"`);if(!NP(h.type))throw new Error(`"${c}" is not a number and cannot be used to count "${o}"`)}let u=`${typeof l=="string"?l:l.name} ${o}`;c!==void 0&&(u+=`[${c}]`),s.set(o,{name:o,staticOffset:e.isUnion?0:i,type:Ej(l)?wK(l):l,length:c,decl:u});const d=typeof c=="string"||Ac(l)&&l[Symbol.metadata].struct.isDynamic?0:qs(l)*(c||1);a||(a=Ac(l)?l[Symbol.metadata].struct.isDynamic:typeof c=="string"),i=e.isUnion?Math.max(i,d):i+d,i=k1e(i,e.align||1),ow("define",n.name+"."+o)}return r.metadata.struct={options:e,members:s,staticSize:i,isDynamic:a,isUnion:e.isUnion??!1},n}}function lw(e,t){return function(n,r){let s=r.name;if(typeof s=="symbol"&&(console.warn("Symbol used for struct member name will be coerced to string: "+s.toString()),s=s.toString()),!s)throw new ReferenceError("Invalid name for struct member");return _K(r).push({name:s,type:e,length:t}),n}}function kK(e,t){return t.length===void 0?-1:typeof t.length=="string"?e[t.length]:Number.isSafeInteger(t.length)&&t.length>=0?t.length:vs(new Error("Array lengths must be natural numbers"))}function va(e){if(IP(e)&&typeof e[Symbol.serialize]=="function")return e[Symbol.serialize]();SK(e),FE(e.constructor);const{options:t,members:n}=e.constructor[Symbol.metadata].struct,r=qs(e),s=new Uint8Array(r),i=new DataView(s.buffer);ow("serialize",e.constructor.name);let a=0,o=0;for(const l of n.values()){const c=kK(e,l);ow("	",l.decl);for(let u=0;u<Math.abs(c);u++){let d=c!=-1?e[l.name][u]:e[l.name];if(typeof d=="string"&&(d=d.charCodeAt(0)),a=o,o+=v1(d)?qs(d):qs(l.type),!NP(l.type)){s.set(d?va(d):new Uint8Array(qs(l.type)),a);continue}const h=`set${TP(l.type)}`;if(h=="setInt64"){i.setBigInt64(a,BigInt(d),!t.bigEndian);continue}if(h=="setUint64"){i.setBigUint64(a,BigInt(d),!t.bigEndian);continue}if(h=="setInt128"){i.setBigUint64(a+(t.bigEndian?8:0),d&G$,!t.bigEndian),i.setBigInt64(a+(t.bigEndian?0:8),d>>BigInt(64),!t.bigEndian);continue}if(h=="setUint128"){i.setBigUint64(a+(t.bigEndian?8:0),d&G$,!t.bigEndian),i.setBigUint64(a+(t.bigEndian?0:8),d>>BigInt(64),!t.bigEndian);continue}if(h=="setFloat128"){i.setFloat64(a+(t.bigEndian?8:0),Number(d),!t.bigEndian),i.setBigUint64(a+(t.bigEndian?0:8),BigInt(0),!t.bigEndian);continue}i[h](a,Number(d),!t.bigEndian)}}return s}function LE(e,t){const n=b1e(t);if(IP(e)&&typeof e[Symbol.deserialize]=="function")return e[Symbol.deserialize](n);SK(e),FE(e.constructor);const{options:r,members:s}=e.constructor[Symbol.metadata].struct,i=new DataView(n.buffer,n.byteOffset,n.byteLength);ow("deserialize",e.constructor.name);let a=0,o=0;for(const l of s.values()){const c=kK(e,l);ow("	",l.decl);for(let u=0;u<Math.abs(c);u++){let d=c!=-1?e[l.name]:e;const h=c!=-1?u:l.name,m=d[h]===null||d[h]===void 0,y=m&&Ac(l.type)&&l.type[Symbol.metadata].struct.isDynamic;if(a=o,!v1(d[h])&&!y&&(o+=qs(l.type)),typeof e[l.name]=="string"){e[l.name]=e[l.name].slice(0,u)+String.fromCharCode(i.getUint8(a))+e[l.name].slice(u+1);continue}if(!NP(l.type)){if(y&&Ac(l.type))d[h]??(d[h]=new l.type);else if(m)continue;LE(d[h],new Uint8Array(n.subarray(a))),o+=qs(d[h]);continue}c&&c!=-1&&(d||(d=[]));const b=`get${TP(l.type)}`;if(b=="getInt64"){d[h]=i.getBigInt64(a,!r.bigEndian);continue}if(b=="getUint64"){d[h]=i.getBigUint64(a,!r.bigEndian);continue}if(b=="getInt128"){d[h]=i.getBigInt64(a+(r.bigEndian?0:8),!r.bigEndian)<<BigInt(64)|i.getBigUint64(a+(r.bigEndian?8:0),!r.bigEndian);continue}if(b=="getUint128"){d[h]=i.getBigUint64(a+(r.bigEndian?0:8),!r.bigEndian)<<BigInt(64)|i.getBigUint64(a+(r.bigEndian?8:0),!r.bigEndian);continue}if(b=="getFloat128"){d[h]=i.getFloat64(a+(r.bigEndian?8:0),!r.bigEndian);continue}d[h]=i[b](a,!r.bigEndian)}}}function E1e(e){function t(n,r){return typeof n=="number"||typeof n=="string"?lw(e,n):lw(e)(n,r)}return t}const er=Object.fromEntries(w1e.map(e=>[e,E1e(e)]));function T1e(e){return{suid:e.uid,sgid:e.gid,euid:e.uid,egid:e.gid,groups:[],...e}}const Uc={root:"/",pwd:"/",credentials:T1e({uid:0,gid:0}),descriptors:new Map};function EK(e,t){let n="",r=0,s=-1,i=0,a="\0";for(let o=0;o<=e.length;++o){if(o<e.length)a=e[o];else{if(a=="/")break;a="/"}if(a=="/"){if(!(s===o-1||i===1))if(i===2){if(n.length<2||r!==2||n.at(-1)!=="."||n.at(-2)!=="."){if(n.length>2){const l=n.lastIndexOf("/");l===-1?(n="",r=0):(n=n.slice(0,l),r=n.length-1-n.lastIndexOf("/")),s=o,i=0;continue}else if(n.length!==0){n="",r=0,s=o,i=0;continue}}t&&(n+=n.length>0?"/..":"..",r=2)}else n.length>0?n+="/"+e.slice(s+1,o):n=e.slice(s+1,o),r=o-s-1;s=o,i=0}else a==="."&&i!==-1?++i:i=-1}return n}function Yd(...e){var t;let n="";for(const s of[...e.reverse(),(t=this===null||this===void 0?void 0:this.pwd)!==null&&t!==void 0?t:Uc.pwd])if(s!=null&&s.length&&(n=`${s}/${n}`,s.startsWith("/")))break;const r=n.startsWith("/");return n=EK(n,!r),r?`/${n}`:n.length?n:"/"}function A1e(e){if(!e.length)return".";const t=e.startsWith("/"),n=e.endsWith("/");return e=EK(e,!t),e.length?(n&&(e+="/"),t?`/${e}`:e):t?"/":n?"./":"."}function os(...e){if(!e.length)return".";const t=e.join("/");return t!=null&&t.length?A1e(t):"."}function TK(e,t){if(e===t||(e=Yd.call(this,e),t=Yd.call(this,t),e===t))return"";const n=1,r=e.length,s=r-n,i=1,a=t.length-i,o=s<a?s:a;let l=-1,c=0;for(;c<o;c++){const d=e[n+c];if(d!==t[i+c])break;d==="/"&&(l=c)}if(c===o)if(a>o){if(t[i+c]==="/")return t.slice(i+c+1);if(c===0)return t.slice(i+c)}else s>o&&(e[n+c]==="/"?l=c:c===0&&(l=0));let u="";for(c=n+l+1;c<=r;++c)(c===r||e[c]==="/")&&(u+=u.length===0?"..":"/..");return`${u}${t.slice(i+l)}`}function Yr(e){if(e.length===0)return".";const t=e[0]==="/";let n=-1,r=!0;for(let s=e.length-1;s>=1;--s)if(e[s]==="/"){if(!r){n=s;break}}else r=!1;return n===-1?t?"/":".":t&&n===1?"//":e.slice(0,n)}function ly(e,t){let n=0,r=-1,s=!0;for(let i=e.length-1;i>=0;--i)if(e[i]==="/"){if(!s){n=i+1;break}}else r===-1&&(s=!1,r=i+1);return r===-1?"":e.slice(n,r)}function uu(e){const t=e.startsWith("/"),n={root:t?"/":"",dir:"",base:"",ext:"",name:""};if(e.length===0)return n;const r=t?1:0;let s=-1,i=0,a=-1,o=!0,l=e.length-1,c=0;for(;l>=r;--l){if(e[l]==="/"){if(!o){i=l+1;break}continue}a===-1&&(o=!1,a=l+1),e[l]==="."?s===-1?s=l:c!==1&&(c=1):s!==-1&&(c=-1)}if(a!==-1){const u=i===0&&t?1:i;s===-1||c===0||c===1&&s===a-1&&s===i+1?n.base=n.name=e.slice(u,a):(n.name=e.slice(u,s),n.base=e.slice(u,a),n.ext=e.slice(s,a))}return i>0?n.dir=e.slice(0,i-1):t&&(n.dir="/"),n}var Gn;(function(e){e[e.EMERG=0]="EMERG",e[e.ALERT=1]="ALERT",e[e.CRIT=2]="CRIT",e[e.ERR=3]="ERR",e[e.WARN=4]="WARN",e[e.NOTICE=5]="NOTICE",e[e.INFO=6]="INFO",e[e.DEBUG=7]="DEBUG"})(Gn||(Gn={}));Gn.EMERG+"",Gn.ALERT+"",Gn.CRIT+"",Gn.ERR+"",Gn.WARN+"",Gn.NOTICE+"",Gn.INFO+"",Gn.DEBUG+"";const R1e=new m1e;function N1e(e,t){const n={level:e,message:t,timestamp:new Date,elapsedMs:performance.now()};R1e.add(n),L1e(n)}function M1e(e,t){var n,r;if(!(e instanceof Ze))return e.toString();const s=e.code+": "+e.message;if(!e.path)return s;const i=typeof t.fs=="string"?t.fs:(r=(n=t.fs)===null||n===void 0?void 0:n._mountPoint)!==null&&r!==void 0?r:"<unknown>";return s+": "+os(i,e.path)}function Uh(e){return function(t,n={}){return N1e(e,M1e(t,n)),t}}Uh(Gn.EMERG);const I1e=Uh(Gn.ALERT),BE=Uh(Gn.CRIT),ko=Uh(Gn.ERR),Fa=Uh(Gn.WARN),jP=Uh(Gn.NOTICE),AK=Uh(Gn.INFO),Ex=Uh(Gn.DEBUG);function j1e(e,t){return`\x1B[${t}m${e}\x1B[0m`}function O1e(e,t){const n="["+(e.elapsedMs/1e3).toFixed(3).padStart(10)+"] ";switch(t){case"ansi":return[j1e(n,"2;37")];case"css":return["%c"+n,"opacity: 0.8; color: white;"];default:return[n]}}Gn.EMERG+"",Gn.ALERT+"",Gn.CRIT+"",Gn.ERR+"",Gn.WARN+"",Gn.NOTICE+"",Gn.INFO+"",Gn.DEBUG+"",Gn.EMERG+"",Gn.ALERT+"",Gn.CRIT+"",Gn.ERR+"",Gn.WARN+"",Gn.NOTICE+"",Gn.INFO+"",Gn.DEBUG+"";Gn.EMERG+"",Gn.ALERT+"",Gn.CRIT+"",Gn.ERR+"",Gn.WARN+"",Gn.NOTICE+"",Gn.INFO+"",Gn.DEBUG+"",Gn.EMERG+"",Gn.ALERT+"",Gn.CRIT+"",Gn.ERR+"",Gn.WARN+"",Gn.NOTICE+"",Gn.INFO+"",Gn.DEBUG+"";let P1e=e=>[...O1e(e),e.message];function D1e(e){const t=P1e(e);return typeof t=="string"?[t]:Array.from(t)}let F1e=console.error;function L1e(e){e.level>B1e||F1e(...D1e(e))}let B1e=Gn.ALERT;function OP(e){return e!=null&&typeof e=="object"&&"create"in e&&typeof e.create=="function"}function $1e(e,t){return Object.defineProperty(t,"prototype",{value:void 0}),Object.defineProperty(t,"name",{value:e}),t}function z1e(e,t){if(typeof t!="object"||t===null)throw ko(new Ze(bt.EINVAL,"Invalid options"));for(const[n,r]of Object.entries(e.options)){const s=t==null?void 0:t[n];if(s==null){if(!r.required){Ex("Using default for option: "+n);continue}throw ko(new Ze(bt.EINVAL,"Missing required option: "+n))}const i=(c,u=s)=>{var d;return typeof c=="function"?Symbol.hasInstance in c&&c.prototype?s instanceof c:c(s):typeof s===c||((d=s==null?void 0:s.constructor)===null||d===void 0?void 0:d.name)===c};if(Array.isArray(r.type)?r.type.some(c=>i(c)):i(r.type))continue;const a=typeof s=="object"&&"constructor"in s?s.constructor.name:typeof s,o=c=>typeof c=="function"?c.name!="type"?c.name:c.toString():c,l=Array.isArray(r.type)?`one of ${r.type.map(o).join(", ")}`:o(r.type);throw ko(new Ze(bt.EINVAL,`Incorrect type for "${n}": ${a} (expected ${l})`))}}function RK(e){return e!=null&&typeof e=="object"&&"backend"in e&&OP(e.backend)}const PP=0,Wi=4,ci=2,I2=1,DP=1,U1e=2,q1e=4,NK=0,Da=1,Fd=2,$E=64,zE=128,V1e=256,UE=512,Tm=1024,W1e=65536,H1e=262144,G1e=131072,qE=1052672,K1e=4096,Y1e=32768,Z1e=16384,X1e=2048,ks=61440,Vm=49152,rf=40960,Rc=32768,Wm=24576,Ni=16384,Hm=8192,Gm=4096,x1=2048,w1=1024,J1e=512,Q1e=448,MK=256,IK=128,jK=64,e_e=56,OK=32,PK=16,DK=8,t_e=7,FK=4,LK=2,BK=1,n_e=0,lo=4294967295,$K=Object.freeze(Object.defineProperty({__proto__:null,COPYFILE_EXCL:DP,COPYFILE_FICLONE:U1e,COPYFILE_FICLONE_FORCE:q1e,F_OK:PP,O_APPEND:Tm,O_CREAT:$E,O_DIRECT:Z1e,O_DIRECTORY:W1e,O_DSYNC:K1e,O_EXCL:zE,O_NOATIME:H1e,O_NOCTTY:V1e,O_NOFOLLOW:G1e,O_NONBLOCK:X1e,O_RDONLY:NK,O_RDWR:Fd,O_SYMLINK:Y1e,O_SYNC:qE,O_TRUNC:UE,O_WRONLY:Da,R_OK:Wi,S_IFBLK:Wm,S_IFCHR:Hm,S_IFDIR:Ni,S_IFIFO:Gm,S_IFLNK:rf,S_IFMT:ks,S_IFREG:Rc,S_IFSOCK:Vm,S_IRGRP:OK,S_IROTH:FK,S_IRUSR:MK,S_IRWXG:e_e,S_IRWXO:t_e,S_IRWXU:Q1e,S_ISGID:w1,S_ISUID:x1,S_ISVTX:J1e,S_IWGRP:PK,S_IWOTH:LK,S_IWUSR:IK,S_IXGRP:DK,S_IXOTH:BK,S_IXUSR:jK,UV_FS_O_FILEMAP:n_e,W_OK:ci,X_OK:I2,size_max:lo},Symbol.toStringTag,{value:"Module"})),OS=BigInt(1e3);class zK{_convert(t){return this._isBigint?BigInt(t):Number(t)}get blocks(){return this._convert(Math.ceil(Number(this.size)/512))}set blocks(t){}get atime(){return new Date(Number(this.atimeMs))}set atime(t){this.atimeMs=this._convert(t.getTime())}get mtime(){return new Date(Number(this.mtimeMs))}set mtime(t){this.mtimeMs=this._convert(t.getTime())}get ctime(){return new Date(Number(this.ctimeMs))}set ctime(t){this.ctimeMs=this._convert(t.getTime())}get birthtime(){return new Date(Number(this.birthtimeMs))}set birthtime(t){this.birthtimeMs=this._convert(t.getTime())}constructor({atimeMs:t,mtimeMs:n,ctimeMs:r,birthtimeMs:s,uid:i,gid:a,size:o,mode:l,ino:c,...u}={}){this.dev=this._convert(0),this.ino=this._convert(0),this.rdev=this._convert(0),this.nlink=this._convert(1),this.blksize=this._convert(4096),this.uid=this._convert(0),this.gid=this._convert(0);const d=Date.now();this.atimeMs=this._convert(t??d),this.mtimeMs=this._convert(n??d),this.ctimeMs=this._convert(r??d),this.birthtimeMs=this._convert(s??d),this.uid=this._convert(i??0),this.gid=this._convert(a??0),this.size=this._convert(o??0),this.ino=this._convert(c??0),this.mode=this._convert(l??420&Rc),(this.mode&ks)==0&&(this.mode=this.mode|this._convert(Rc)),Object.assign(this,u)}isFile(){return(this.mode&ks)===Rc}isDirectory(){return(this.mode&ks)===Ni}isSymbolicLink(){return(this.mode&ks)===rf}isSocket(){return(this.mode&ks)===Vm}isBlockDevice(){return(this.mode&ks)===Wm}isCharacterDevice(){return(this.mode&ks)===Hm}isFIFO(){return(this.mode&ks)===Gm}toJSON(){return Um(this,Tj)}hasAccess(t,n){return hs(n,this._isBigint?new sf(this):this,t)}get atimeNs(){return BigInt(this.atimeMs)*OS}get mtimeNs(){return BigInt(this.mtimeMs)*OS}get ctimeNs(){return BigInt(this.ctimeMs)*OS}get birthtimeNs(){return BigInt(this.birthtimeMs)*OS}}function UK(e,t,n){let r=!0;return!isNaN(t)&&t>=0&&t<lo?e.uid=t:r=!1,!isNaN(n)&&n>=0&&n<lo?e.gid=n:r=!1,r}class sf extends zK{constructor(){super(...arguments),this._isBigint=!1}}class Km extends zK{constructor(){super(...arguments),this._isBigint=!0}}function r_e(e,t){return e.size==t.size&&+e.atime==+t.atime&&+e.mtime==+t.mtime&&+e.ctime==+t.ctime&&e.mode==t.mode}class s_e{constructor(){this.type=525687744115,this.bsize=4096,this.blocks=0,this.bfree=0,this.bavail=0,this.files=lo,this.ffree=lo}}class i_e{constructor(){this.type=BigInt("0x7a656e6673"),this.bsize=BigInt(4096),this.blocks=BigInt(0),this.bfree=BigInt(0),this.bavail=BigInt(0),this.files=BigInt(lo),this.ffree=BigInt(lo)}}var Os=function(e,t,n,r,s,i){function a(x){if(x!==void 0&&typeof x!="function")throw new TypeError("Function expected");return x}for(var o=r.kind,l=o==="getter"?"get":o==="setter"?"set":"value",c=!t&&e?r.static?e:e.prototype:null,u=t||(c?Object.getOwnPropertyDescriptor(c,r.name):{}),d,h=!1,m=n.length-1;m>=0;m--){var y={};for(var b in r)y[b]=b==="access"?{}:r[b];for(var b in r.access)y.access[b]=r.access[b];y.addInitializer=function(x){if(h)throw new TypeError("Cannot add initializers after decoration has completed");i.push(a(x||null))};var v=(0,n[m])(o==="accessor"?{get:u.get,set:u.set}:u[l],y);if(o==="accessor"){if(v===void 0)continue;if(v===null||typeof v!="object")throw new TypeError("Object expected");(d=a(v.get))&&(u.get=d),(d=a(v.set))&&(u.set=d),(d=a(v.init))&&s.unshift(d)}else(d=a(v))&&(o==="field"?s.unshift(d):u[l]=d)}c&&Object.defineProperty(c,r.name,u),h=!0},Hn=function(e,t,n){for(var r=arguments.length>2,s=0;s<t.length;s++)n=r?t[s].call(e,n):t[s].call(e);return r?n:void 0},FP=function(e,t,n){return typeof t=="symbol"&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:n?"".concat(n," ",t):t})};const tl=0,a_e=1024;let K$=(()=>{var e,t;let n=[qm()],r,s=[],i,a,o=[],l=[],c,u=[],d=[],h,m=[],y=[],b,v=[],x=[];return i=class{get key(){return this._key}set key(w){this._key=w,this.keySize=w.length}get value(){return this._value.subarray(0,this.valueSize)}set value(w){this._value=w,this.valueSize=w.length}constructor(w,S){this.keySize=Hn(this,o,0),this.valueSize=(Hn(this,l),Hn(this,u,0)),this._key=(Hn(this,d),Hn(this,m,"")),this._value=(Hn(this,y),Hn(this,v,new Uint8Array(a_e))),Hn(this,x),w&&(this.key=w),S&&(this.value=S)}},FP(i,"Attribute"),(()=>{const w=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;a=[(e=er).uint32.bind(e)],c=[(t=er).uint32.bind(t)],h=[er.char("keySize")],b=[er.uint8("valueSize")],Os(null,null,a,{kind:"field",name:"keySize",static:!1,private:!1,access:{has:S=>"keySize"in S,get:S=>S.keySize,set:(S,k)=>{S.keySize=k}},metadata:w},o,l),Os(null,null,c,{kind:"field",name:"valueSize",static:!1,private:!1,access:{has:S=>"valueSize"in S,get:S=>S.valueSize,set:(S,k)=>{S.valueSize=k}},metadata:w},u,d),Os(null,null,h,{kind:"field",name:"_key",static:!1,private:!1,access:{has:S=>"_key"in S,get:S=>S._key,set:(S,k)=>{S._key=k}},metadata:w},m,y),Os(null,null,b,{kind:"field",name:"_value",static:!1,private:!1,access:{has:S=>"_value"in S,get:S=>S._value,set:(S,k)=>{S._value=k}},metadata:w},v,x),Os(null,r={value:i},n,{kind:"class",name:i.name,metadata:w},null,s),i=r.value,w&&Object.defineProperty(i,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:w}),Hn(i,s)})(),i})(),Ch=(()=>{var e;let t=[qm()],n,r=[],s,i,a=[],o=[],l,c=[],u=[];return s=class{has(d){return this.data.some(h=>h.key==d)}get(d){return this.data.find(h=>h.key==d)}set(d,h){const m=this.get(d);if(m){m.value=h;return}this.data.push(new K$(d,h)),this.size++}remove(d){const h=this.data.findIndex(m=>m.key==d);return h===-1?!1:(this.data.splice(h,1),this.size--,!0)}keys(){return this.data.map(d=>d.key)}values(){return this.data.map(d=>d.value)}entries(){return this.data.map(d=>[d.key,d.value])}constructor(){this.size=Hn(this,a,0),this.data=(Hn(this,o),Hn(this,c,[])),Hn(this,u)}},FP(s,"Attributes"),(()=>{const d=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;i=[(e=er).uint32.bind(e)],l=[lw(K$,"size")],Os(null,null,i,{kind:"field",name:"size",static:!1,private:!1,access:{has:h=>"size"in h,get:h=>h.size,set:(h,m)=>{h.size=m}},metadata:d},a,o),Os(null,null,l,{kind:"field",name:"data",static:!1,private:!1,access:{has:h=>"data"in h,get:h=>h.data,set:(h,m)=>{h.data=m}},metadata:d},c,u),Os(null,n={value:s},t,{kind:"class",name:s.name,metadata:d},null,r),s=n.value,d&&Object.defineProperty(s,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:d}),Hn(s,r)})(),s})();const Tj=["ino","data","size","mode","flags","nlink","uid","gid","atimeMs","birthtimeMs","mtimeMs","ctimeMs","version"],o_e=4;var Eo;(function(e){e[e.SecureRm=1]="SecureRm",e[e.Undelete=2]="Undelete",e[e.Compress=4]="Compress",e[e.Sync=8]="Sync",e[e.Immutable=16]="Immutable",e[e.Append=32]="Append",e[e.NoDump=64]="NoDump",e[e.NoAtime=128]="NoAtime",e[e.Dirty=256]="Dirty",e[e.CompressBlk=512]="CompressBlk",e[e.NoCompress=1024]="NoCompress",e[e.Encrypt=2048]="Encrypt",e[e.Btree=4096]="Btree",e[e.Index=4096]="Index",e[e.IMagic=8192]="IMagic",e[e.JournalData=16384]="JournalData",e[e.NoTail=32768]="NoTail",e[e.DirSync=65536]="DirSync",e[e.TopDir=131072]="TopDir",e[e.HugeFile=262144]="HugeFile",e[e.Extent=524288]="Extent",e[e.Verity=1048576]="Verity",e[e.EaInode=2097152]="EaInode",e[e.EofBlocks=4194304]="EofBlocks",e[e.NoCow=8388608]="NoCow",e[e.Dax=33554432]="Dax",e[e.InlineData=268435456]="InlineData",e[e.ProjInherit=536870912]="ProjInherit",e[e.CaseFold=1073741824]="CaseFold",e[e.Reserved=2147483648]="Reserved"})(Eo||(Eo={}));let Ti=(()=>{var e,t,n,r,s,i,a,o,l,c,u,d,h,m,y,b;let v=[qm()],x,w=[],S,k,C=[],T=[],R,N=[],I=[],P,B=[],D=[],W,O=[],Z=[],U,H=[],L=[],te,V=[],Q=[],ee,se=[],pe=[],ue,Oe=[],Fe=[],Se,Ce=[],qe=[],Qe,We=[],Ie=[],K,ye=[],Ne=[],ce,oe=[],re=[],Re,Be=[],Te=[],lt,Tt=[],ut=[],jt,qt=[],Ft=[],Ht,we=[],F=[],X,be=[],ke=[],ge,Ee=[],le=[];var dt=S=class{constructor(et){if(this.data=Hn(this,C,kj(0,lo)),this.__data_old=(Hn(this,T),Hn(this,N,0)),this.size=(Hn(this,I),Hn(this,B,0)),this.mode=(Hn(this,D),Hn(this,O,0)),this.nlink=(Hn(this,Z),Hn(this,H,1)),this.uid=(Hn(this,L),Hn(this,V,0)),this.gid=(Hn(this,Q),Hn(this,se,0)),this.atimeMs=(Hn(this,pe),Hn(this,Oe,Date.now())),this.birthtimeMs=(Hn(this,Fe),Hn(this,Ce,Date.now())),this.mtimeMs=(Hn(this,qe),Hn(this,We,Date.now())),this.ctimeMs=(Hn(this,Ie),Hn(this,ye,Date.now())),this.ino=(Hn(this,Ne),Hn(this,oe,kj(0,lo))),this.__ino_old=(Hn(this,re),Hn(this,Be,0)),this.flags=(Hn(this,Te),Hn(this,Tt,0)),this.__after_flags=(Hn(this,ut),Hn(this,qt,0)),this.version=(Hn(this,Ft),Hn(this,we,0)),this.__padding=(Hn(this,F),Hn(this,be,[])),this.attributes=(Hn(this,ke),Hn(this,Ee,new Ch)),Hn(this,le),!!et){if(!("byteLength"in et)){Object.assign(this,et);return}if(et.byteLength<qs(dt))throw BE(new Ze(bt.EIO,"Buffer is too small to create an inode"));LE(this,et)}}toString(){return`<Inode ${this.ino}>`}toJSON(){return{...Um(this,Tj),attributes:this.attributes}}toStats(){return new sf(this)}update(et){if(!et)return!1;let $=!1;for(const Ue of Tj)et[Ue]!==void 0&&(Ue=="ino"||Ue=="data"||this[Ue]!==et[Ue]&&(Ue=="atimeMs"&&this.flags&Eo.NoAtime||(this[Ue]=et[Ue],$=!0)));return et.attributes&&(this.attributes=et.attributes,$=!0),$&&(this.ctimeMs=Date.now()),$}};return FP(S,"Inode"),(()=>{const et=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;k=[(e=er).uint32.bind(e)],R=[(t=er).uint32.bind(t)],P=[(n=er).uint32.bind(n)],W=[(r=er).uint16.bind(r)],U=[(s=er).uint32.bind(s)],te=[(i=er).uint32.bind(i)],ee=[(a=er).uint32.bind(a)],ue=[(o=er).float64.bind(o)],Se=[(l=er).float64.bind(l)],Qe=[(c=er).float64.bind(c)],K=[(u=er).float64.bind(u)],ce=[(d=er).uint32.bind(d)],Re=[(h=er).uint32.bind(h)],lt=[(m=er).uint32.bind(m)],jt=[(y=er).uint16.bind(y)],Ht=[(b=er).uint32.bind(b)],X=[er.uint8(48)],ge=[lw(Ch)],Os(null,null,k,{kind:"field",name:"data",static:!1,private:!1,access:{has:$=>"data"in $,get:$=>$.data,set:($,Ue)=>{$.data=Ue}},metadata:et},C,T),Os(null,null,R,{kind:"field",name:"__data_old",static:!1,private:!1,access:{has:$=>"__data_old"in $,get:$=>$.__data_old,set:($,Ue)=>{$.__data_old=Ue}},metadata:et},N,I),Os(null,null,P,{kind:"field",name:"size",static:!1,private:!1,access:{has:$=>"size"in $,get:$=>$.size,set:($,Ue)=>{$.size=Ue}},metadata:et},B,D),Os(null,null,W,{kind:"field",name:"mode",static:!1,private:!1,access:{has:$=>"mode"in $,get:$=>$.mode,set:($,Ue)=>{$.mode=Ue}},metadata:et},O,Z),Os(null,null,U,{kind:"field",name:"nlink",static:!1,private:!1,access:{has:$=>"nlink"in $,get:$=>$.nlink,set:($,Ue)=>{$.nlink=Ue}},metadata:et},H,L),Os(null,null,te,{kind:"field",name:"uid",static:!1,private:!1,access:{has:$=>"uid"in $,get:$=>$.uid,set:($,Ue)=>{$.uid=Ue}},metadata:et},V,Q),Os(null,null,ee,{kind:"field",name:"gid",static:!1,private:!1,access:{has:$=>"gid"in $,get:$=>$.gid,set:($,Ue)=>{$.gid=Ue}},metadata:et},se,pe),Os(null,null,ue,{kind:"field",name:"atimeMs",static:!1,private:!1,access:{has:$=>"atimeMs"in $,get:$=>$.atimeMs,set:($,Ue)=>{$.atimeMs=Ue}},metadata:et},Oe,Fe),Os(null,null,Se,{kind:"field",name:"birthtimeMs",static:!1,private:!1,access:{has:$=>"birthtimeMs"in $,get:$=>$.birthtimeMs,set:($,Ue)=>{$.birthtimeMs=Ue}},metadata:et},Ce,qe),Os(null,null,Qe,{kind:"field",name:"mtimeMs",static:!1,private:!1,access:{has:$=>"mtimeMs"in $,get:$=>$.mtimeMs,set:($,Ue)=>{$.mtimeMs=Ue}},metadata:et},We,Ie),Os(null,null,K,{kind:"field",name:"ctimeMs",static:!1,private:!1,access:{has:$=>"ctimeMs"in $,get:$=>$.ctimeMs,set:($,Ue)=>{$.ctimeMs=Ue}},metadata:et},ye,Ne),Os(null,null,ce,{kind:"field",name:"ino",static:!1,private:!1,access:{has:$=>"ino"in $,get:$=>$.ino,set:($,Ue)=>{$.ino=Ue}},metadata:et},oe,re),Os(null,null,Re,{kind:"field",name:"__ino_old",static:!1,private:!1,access:{has:$=>"__ino_old"in $,get:$=>$.__ino_old,set:($,Ue)=>{$.__ino_old=Ue}},metadata:et},Be,Te),Os(null,null,lt,{kind:"field",name:"flags",static:!1,private:!1,access:{has:$=>"flags"in $,get:$=>$.flags,set:($,Ue)=>{$.flags=Ue}},metadata:et},Tt,ut),Os(null,null,jt,{kind:"field",name:"__after_flags",static:!1,private:!1,access:{has:$=>"__after_flags"in $,get:$=>$.__after_flags,set:($,Ue)=>{$.__after_flags=Ue}},metadata:et},qt,Ft),Os(null,null,Ht,{kind:"field",name:"version",static:!1,private:!1,access:{has:$=>"version"in $,get:$=>$.version,set:($,Ue)=>{$.version=Ue}},metadata:et},we,F),Os(null,null,X,{kind:"field",name:"__padding",static:!1,private:!1,access:{has:$=>"__padding"in $,get:$=>$.__padding,set:($,Ue)=>{$.__padding=Ue}},metadata:et},be,ke),Os(null,null,ge,{kind:"field",name:"attributes",static:!1,private:!1,access:{has:$=>"attributes"in $,get:$=>$.attributes,set:($,Ue)=>{$.attributes=Ue}},metadata:et},Ee,le),Os(null,x={value:S},v,{kind:"class",name:S.name,metadata:et},null,w),dt=S=x.value,et&&Object.defineProperty(S,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:et}),Hn(S,w)})(),dt=S})();function l_e(e){return(e.mode&ks)===Rc}function Lc(e){return(e.mode&ks)===Ni}function cy(e){return(e.mode&ks)===rf}function c_e(e){return(e.mode&ks)===Vm}function cw(e){return(e.mode&ks)===Wm}function uw(e){return(e.mode&ks)===Hm}function u_e(e){return(e.mode&ks)===Gm}function hs(e,t,n){const r=(e==null?void 0:e.credentials)||Uc.credentials;if(cy(t)||r.euid===0||r.egid===0)return!0;let s=0;return r.uid===t.uid&&(t.mode&MK&&(s|=Wi),t.mode&IK&&(s|=ci),t.mode&jK&&(s|=I2)),(r.gid===t.gid||r.groups.includes(Number(t.gid)))&&(t.mode&OK&&(s|=Wi),t.mode&PK&&(s|=ci),t.mode&DK&&(s|=I2)),t.mode&FK&&(s|=Wi),t.mode&LK&&(s|=ci),t.mode&BK&&(s|=I2),(s&n)===n}const Y$=1;class $C extends Map{constructor(){super(...arguments),this.maxSize=lo}toJSON(){return{version:Y$,maxSize:this.maxSize,entries:Object.fromEntries([...this].map(([t,n])=>[t,n.toJSON()]))}}toString(){return JSON.stringify(this.toJSON())}get byteSize(){let t=this.size*qs(Ti);for(const n of this.values())t+=n.size;return t}usage(){return{totalSpace:this.maxSize,freeSpace:this.maxSize-this.byteSize}}pathOf(t){for(const[n,r]of this)if(r.ino==t||r.data==t)return n}getByID(t){var n;return(n=this.entryByID(t))===null||n===void 0?void 0:n.inode}entryByID(t){for(const[n,r]of this)if(r.ino==t||r.data==t)return{path:n,inode:r}}directoryEntries(t){const n=this.get(t);if(!n)throw Ze.With("ENOENT",t);if((n.mode&ks)!=Ni)throw Ze.With("ENOTDIR",t);const r={};for(const s of this.keys())Yr(s)==t&&s!=t&&(r[ly(s)]=this.get(s).ino);return r}_alloc(){return Math.max(...[...this.values()].flatMap(t=>[t.ino,t.data]))+1}directories(){const t=new Map;for(const[n,r]of this){if((r.mode&ks)!=Ni)continue;const s={};for(const i of this.keys())Yr(i)==n&&i!=n&&(s[ly(i)]=this.get(i).ino);t.set(n,s)}return t}fromJSON(t){var n;if(t.version!=Y$)throw new Ze(bt.EINVAL,"Index version mismatch");this.clear();for(const[r,s]of Object.entries(t.entries))(n=s.data)!==null&&n!==void 0||(s.data=kj(1,lo)),r=="/"&&(s.ino=0),this.set(r,new Ti(s));return this}static parse(t){if(!g1e(t))throw new Ze(bt.EINVAL,"Invalid JSON");const n=JSON.parse(t),r=new $C;return r.fromJSON(n),r}}const tM=4096;let LP=class Aj{get uuid(){return this._uuid}constructor(t,n){this.type=t,this.name=n,this._uuid=crypto.randomUUID(),this.attributes=new Map,this.streamRead===Aj.prototype.streamRead&&this.attributes.set("default_stream_read"),this.streamWrite===Aj.prototype.streamWrite&&this.attributes.set("default_stream_write")}toString(){var t;return`${this.name} ${(t=this.label)!==null&&t!==void 0?t:""} (${this._mountPoint?"mounted on "+this._mountPoint:"unmounted"})`}usage(){return{totalSpace:0,freeSpace:0}}async ready(){}async exists(t){try{return await this.stat(t),!0}catch(n){return n.code!="ENOENT"}}existsSync(t){try{return this.statSync(t),!0}catch(n){return n.code!="ENOENT"}}streamRead(t,n){return new ReadableStream({start:async r=>{const{size:s}=await this.stat(t),{start:i=0,end:a=s}=n;for(let o=i;o<a;o+=tM){const l=o+tM>a?a-o:tM,c=new Uint8Array(l);await this.read(t,c,o,o+l).catch(r.error.bind(r)),r.enqueue(c)}r.close()},type:"bytes"})}streamWrite(t,n){var r;let s=(r=n.start)!==null&&r!==void 0?r:0;return new WritableStream({write:async(i,a)=>{let o=!1;const l=u=>{o=!0,a.error(u)},{size:c}=await this.stat(t);await this.write(t,i,s).catch(l),!o&&(s+=i.byteLength,await this.touch(t,{mtimeMs:Date.now(),size:Math.max(c,s)}).catch(l))}})}};function Za(e){return JSON.parse(AP(e),(t,n)=>t==""?n:typeof n=="string"?BigInt(n).toString(16).slice(0,Math.min(n.length,8)):n)}function Ml(e){return Xp(JSON.stringify(e))}function qh(e,t){if(typeof e=="number")return e;if(typeof e=="string"){const n=parseInt(e,8);if(!isNaN(n))return n}if(typeof t=="number")return t;throw new Ze(bt.EINVAL,"Invalid mode: "+(e==null?void 0:e.toString()))}function zC(e){if(e instanceof Date)return e.getTime();try{return Number(e)}catch{throw new Ze(bt.EINVAL,"Invalid time.")}}function Ln(e,t=!1){if(e instanceof URL){if(e.protocol!="file:")throw new Ze(bt.EINVAL,"URLs must use the file: protocol");e=e.pathname}if(e=e.toString(),e.startsWith("file://")&&(e=e.slice(7)),e.includes("\0"))throw new Ze(bt.EINVAL,"Path can not contain null character");if(e.length==0)throw new Ze(bt.EINVAL,"Path can not be empty");return e=e.replaceAll(/[/\\]+/g,"/"),t?e:Yd(e)}function Ld(e,t="utf8",n,r=0){return typeof e!="object"||e===null?{encoding:typeof e=="string"?e:t??null,flag:n,mode:r}:{encoding:typeof(e==null?void 0:e.encoding)=="string"?e.encoding:t??null,flag:typeof(e==null?void 0:e.flag)=="string"?e.flag:n,mode:qh("mode"in e?e==null?void 0:e.mode:null,r)}}class d_e{constructor(t,n,r,s){de(this,"id");de(this,"_size");de(this,"options");de(this,"regions",[]);this.id=t,this._size=n,this.options=r,r.sparse??(r.sparse=!0),r.sparse||this.regions.push({offset:0,data:new Uint8Array(n),ranges:[]}),s==null||s.set(t,this)}get size(){return this._size}set size(t){if(t>=this._size){this._size=t;return}this._size=t;for(let n=this.regions.length-1;n>=0;n--){const r=this.regions[n];if(r.offset>=t){this.regions.splice(n,1);continue}const s=t-r.offset;r.data.byteLength>s&&(r.data=r.data.subarray(0,s)),r.ranges=r.ranges.filter(i=>i.start<t).map(i=>i.end>t?{start:i.start,end:t}:i)}}collect(){if(!this.options.sparse)return;const{regionGapThreshold:t=4095}=this.options;for(let n=0;n<this.regions.length-1;){const r=this.regions[n],s=this.regions[n+1];if(s.offset-(r.offset+r.data.byteLength)>t){n++;continue}r.ranges.push(...s.ranges),r.ranges.sort((i,a)=>i.start-a.start),r.ranges=r.ranges.reduce((i,a)=>(!i.length||i.at(-1).end<a.start?i.push(a):i.at(-1).end=Math.max(i.at(-1).end,a.end),i),[]),r.data=aw(r.data,s.offset+s.data.byteLength),r.data.set(s.data,s.offset-r.offset),this.regions.splice(n+1,1)}}missing(t,n){const r=[];for(const s of this.regions){if(s.offset>=n)break;for(const i of s.ranges)if(!(i.end<=t)&&(i.start>=n||(i.start>t&&r.push({start:t,end:Math.min(i.start,n)}),i.end>t&&(t=Math.max(t,i.end)),t>=n)))break;if(t>=n)break}return t<n&&r.push({start:t,end:n}),r}cached(t,n){const r=[];for(const i of this.regions){if(i.offset>=n)break;for(const a of i.ranges)if(!(a.end<=t)){if(a.start>=n)break;r.push({start:Math.max(t,a.start),end:Math.min(n,a.end)})}}r.sort((i,a)=>i.start-a.start);const s=[];for(const i of r){const a=s.at(-1);a&&i.start<=a.end?a.end=Math.max(a.end,i.end):s.push(i)}return s}regionAt(t){if(this.regions.length)for(const n of this.regions){if(n.offset>t)break;if(t>=n.offset&&t<n.offset+n.data.byteLength)return n}}add(t,n){const r=n+t.byteLength,s=this.regionAt(n);if(s)return s.data=aw(s.data,r),s.data.set(t,n),s.ranges.push({start:n,end:r}),s.ranges.sort((o,l)=>o.start-l.start),this.collect(),this;const i={data:t,offset:n,ranges:[{start:n,end:r}]},a=this.regions.findIndex(o=>o.offset>n);return a==-1?this.regions.push(i):this.regions.splice(a,0,i),this.collect(),this}}var nM,rM,sM;(nM=Promise.withResolvers)!==null&&nM!==void 0||(Promise.withResolvers=(Fa("Using a polyfill of Promise.withResolvers"),function(){let e,t;return{promise:new Promise((r,s)=>{e=r,t=s}),resolve:e,reject:t}}));(rM=Symbol.dispose)!==null&&rM!==void 0||(Symbol.dispose=(Fa("Using a polyfill of Symbol.dispose"),Symbol("Symbol.dispose")));(sM=Symbol.asyncDispose)!==null&&sM!==void 0||(Symbol.asyncDispose=(Fa("Using a polyfill of Symbol.asyncDispose"),Symbol("Symbol.asyncDispose")));class qK{constructor(t){this.store=t}}class f_e extends qK{async get(t,n,r){return this.getSync(t,n,r)}async set(t,n,r){return this.setSync(t,n,r)}async remove(t){return this.removeSync(t)}}class Rj extends qK{constructor(){super(...arguments),this.asyncDone=Promise.resolve()}async(t){this.asyncDone=this.asyncDone.then(()=>t)}_cached(t,n){var r,s;(r=(s=this.store).cache)!==null&&r!==void 0||(s.cache=new Map);const i=this.store.cache.get(t);return i?(n&&(i.size=n.size),i):n?new d_e(t,n.size,{},this.store.cache):void 0}getSync(t,n,r){var s;const i=this._cached(t);if(!i)return;r??(r=i.size);const a=i.missing(n,r);for(const{start:l,end:c}of a)this.async(this.get(t,l,c));if(a.length)throw ko(Ze.With("EAGAIN",(s=this.store._fs)===null||s===void 0?void 0:s._path(t)));const o=i.regionAt(n);if(!o){Fa("Missing cache region for "+t);return}return o.data.subarray(n-o.offset,r-o.offset)}setSync(t,n,r){this.async(this.set(t,n,r))}removeSync(t){var n;this.async(this.remove(t)),(n=this.store.cache)===null||n===void 0||n.delete(t)}}class h_e{flag(t){var n,r;return(r=(n=this.raw.store.flags)===null||n===void 0?void 0:n.includes(t))!==null&&r!==void 0?r:!1}constructor(t,n){this.raw=t,this.fs=n,this.done=!1,this.originalData=new Map,this.modifiedKeys=new Set}keys(){return this.raw.keys()}async get(t,n=0,r){const s=await this.raw.get(t,n,r);return this.stash(t),s}getSync(t,n=0,r){const s=this.raw.getSync(t,n,r);return this.stash(t),s}async set(t,n,r=0){await this.markModified(t,r,n.byteLength),await this.raw.set(t,n,r)}setSync(t,n,r=0){this.markModifiedSync(t,r,n.byteLength),this.raw.setSync(t,n,r)}async remove(t){await this.markModified(t,0,void 0),await this.raw.remove(t)}removeSync(t){this.markModifiedSync(t,0,void 0),this.raw.removeSync(t)}commit(){return this.done=!0,Promise.resolve()}commitSync(){this.done=!0}async abort(){if(!this.done){for(const[t,n]of this.originalData)if(this.modifiedKeys.has(t)){if(n.some(r=>!r.data)){await this.raw.remove(t),this.fs._remove(t);continue}for(const r of n.reverse())await this.raw.set(t,r.data,r.offset)}this.done=!0}}abortSync(){if(!this.done){for(const[t,n]of this.originalData)if(this.modifiedKeys.has(t)){if(n.some(r=>!r.data)){this.raw.removeSync(t),this.fs._remove(t);continue}for(const r of n.reverse())this.raw.setSync(t,r.data,r.offset)}this.done=!0}}async[Symbol.asyncDispose](){this.done||await this.abort()}[Symbol.dispose](){this.done||this.abortSync()}stash(t,n,r=0){this.originalData.has(t)||this.originalData.set(t,[]),this.originalData.get(t).push({data:n,offset:r})}async markModified(t,n,r){this.modifiedKeys.add(t);const s=r?n+r:void 0;try{this.stash(t,await this.raw.get(t,n,s),n)}catch(i){if(!(this.raw instanceof Rj))throw i;const o=this.raw._cached(t);if(!o)throw i;for(const l of o.cached(n,s??n))this.stash(t,await this.raw.get(t,l.start,l.end),l.start)}}markModifiedSync(t,n,r){this.modifiedKeys.add(t);const s=r?n+r:void 0;try{this.stash(t,this.raw.getSync(t,n,s),n)}catch(i){if(!(this.raw instanceof Rj))throw i;const o=this.raw._cached(t);if(!o)throw i;for(const l of o.cached(n,s??n))this.stash(t,this.raw.getSync(t,l.start,l.end),l.start)}}}var Is=function(e,t,n){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var r,s;if(n){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=t[Symbol.asyncDispose]}if(r===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=t[Symbol.dispose],n&&(s=r)}if(typeof r!="function")throw new TypeError("Object not disposable.");s&&(r=function(){try{s.call(this)}catch(i){return Promise.reject(i)}}),e.stack.push({value:t,dispose:r,async:n})}else n&&e.stack.push({async:!0});return t},js=function(e){return function(t){function n(a){t.error=t.hasError?new e(a,t.error,"An error was suppressed during disposal."):a,t.hasError=!0}var r,s=0;function i(){for(;r=t.stack.pop();)try{if(!r.async&&s===1)return s=0,t.stack.push(r),Promise.resolve().then(i);if(r.dispose){var a=r.dispose.call(r.value);if(r.async)return s|=2,Promise.resolve(a).then(i,function(o){return n(o),i()})}else s|=1}catch(o){n(o)}if(s===1)return t.hasError?Promise.reject(t.error):Promise.resolve();if(t.hasError)throw t.error}return i()}}(typeof SuppressedError=="function"?SuppressedError:function(e,t,n){var r=new Error(n);return r.name="SuppressedError",r.error=e,r.suppressed=t,r});class VK extends LP{_path(t){var n;const[r]=(n=this._paths.get(t))!==null&&n!==void 0?n:[];return r}_add(t,n){this._paths.has(t)||this._paths.set(t,new Set),this._paths.get(t).add(n),this._ids.set(n,t)}_remove(t){var n;for(const r of(n=this._paths.get(t))!==null&&n!==void 0?n:[])this._ids.delete(r);this._paths.delete(t)}_move(t,n){const r=[];for(const[s,i]of this._ids){const a=TK(t,s);if(a.startsWith(".."))continue;let o=os(n,a);o.endsWith("/")&&(o=o.slice(0,-1)),r.push({oldKey:s,newKey:o,ino:i})}for(const{oldKey:s,newKey:i,ino:a}of r){this._ids.delete(s),this._ids.set(i,a);const o=this._paths.get(a);if(!o){Fa("Missing paths in table for ino "+a);continue}o.delete(s),o.add(i)}}async ready(){this._initialized||(this.checkRootSync(),await this.checkRoot(),await this._populate(),this._initialized=!0)}constructor(t){var n,r,s;super((n=t.type)!==null&&n!==void 0?n:1802921587,t.name),this.store=t,this._ids=new Map([["/",0]]),this._paths=new Map([[0,new Set("/")]]),this._initialized=!1,t._fs=this,this._uuid=(r=t.uuid)!==null&&r!==void 0?r:this.uuid,Ex(this.name+": supports features: "+((s=this.store.flags)===null||s===void 0?void 0:s.join(", ")))}usage(){var t,n;return((n=(t=this.store).usage)===null||n===void 0?void 0:n.call(t))||{totalSpace:0,freeSpace:0}}async loadIndex(t){const n={stack:[],error:void 0,hasError:!1};try{const r=Is(n,this.transaction(),!0),s=t.directories();for(const[i,a]of t)this._add(a.ino,i),await r.set(a.ino,va(a)),s.has(i)&&await r.set(a.data,Ml(s.get(i)));await r.commit()}catch(r){n.error=r,n.hasError=!0}finally{const r=js(n);r&&await r}}loadIndexSync(t){const n={stack:[],error:void 0,hasError:!1};try{const r=Is(n,this.transaction(),!1),s=t.directories();for(const[i,a]of t)this._add(a.ino,i),r.setSync(a.ino,va(a)),s.has(i)&&r.setSync(a.data,Ml(s.get(i)));r.commitSync()}catch(r){n.error=r,n.hasError=!0}finally{js(n)}}async createIndex(){var t;const n={stack:[],error:void 0,hasError:!1};try{const r=new $C,s=Is(n,this.transaction(),!0),i=[["/",0]],a=q$(Ze.With("EDEADLK"));for(;i.length;){const[o,l]=i.shift(),c=new Ti(await s.get(l));if(r.set(o,c),c.mode&Ni){const u=Za((t=await s.get(c.data))!==null&&t!==void 0?t:vs(Ze.With("ENODATA",o)));for(const[d,h]of Object.entries(u))i.push([os(o,d),h])}}return a(),r}catch(r){n.error=r,n.hasError=!0}finally{const r=js(n);r&&await r}}createIndexSync(){var t;const n={stack:[],error:void 0,hasError:!1};try{const r=new $C,s=Is(n,this.transaction(),!1),i=[["/",0]],a=q$(Ze.With("EDEADLK"));for(;i.length;){const[o,l]=i.shift(),c=new Ti(s.getSync(l));if(r.set(o,c),c.mode&Ni){const u=Za((t=s.getSync(c.data))!==null&&t!==void 0?t:vs(Ze.With("ENODATA",o)));for(const[d,h]of Object.entries(u))i.push([os(o,d),h])}}return a(),r}catch(r){n.error=r,n.hasError=!0}finally{js(n)}}async rename(t,n){var r,s,i;const a={stack:[],error:void 0,hasError:!1};try{const o=Is(a,this.transaction(),!0),l=uu(t),c=uu(n),u=await this.findInode(o,l.dir,"rename"),d=Za((r=await o.get(u.data))!==null&&r!==void 0?r:vs(Ze.With("ENODATA",l.dir,"rename")));if(!d[l.base])throw Ze.With("ENOENT",t,"rename");const h=d[l.base];if(h!=this._ids.get(t)&&ko(`Ino mismatch while renaming ${t} to ${n}`),delete d[l.base],(c.dir+"/").startsWith(t+"/"))throw new Ze(bt.EBUSY,l.dir);const m=c.dir==l.dir,y=m?u:await this.findInode(o,c.dir,"rename"),b=m?d:Za((s=await o.get(y.data))!==null&&s!==void 0?s:vs(Ze.With("ENODATA",c.dir,"rename")));if(b[c.base]){const v=new Ti((i=await o.get(b[c.base]))!==null&&i!==void 0?i:vs(Ze.With("ENOENT",n,"rename")));if(!v.toStats().isFile())throw Ze.With("EPERM",n,"rename");await o.remove(v.data),await o.remove(b[c.base])}b[c.base]=h,await o.set(u.data,Ml(d)),await o.set(y.data,Ml(b)),await o.commit(),this._move(t,n)}catch(o){a.error=o,a.hasError=!0}finally{const o=js(a);o&&await o}}renameSync(t,n){var r,s,i;const a={stack:[],error:void 0,hasError:!1};try{const o=Is(a,this.transaction(),!1),l=uu(t),c=uu(n),u=this.findInodeSync(o,l.dir,"rename"),d=Za((r=o.getSync(u.data))!==null&&r!==void 0?r:vs(Ze.With("ENODATA",l.dir,"rename")));if(!d[l.base])throw Ze.With("ENOENT",t,"rename");const h=d[l.base];if(h!=this._ids.get(t)&&ko(`Ino mismatch while renaming ${t} to ${n}`),delete d[l.base],(c.dir+"/").startsWith(t+"/"))throw new Ze(bt.EBUSY,l.dir);const m=c.dir===l.dir,y=m?u:this.findInodeSync(o,c.dir,"rename"),b=m?d:Za((s=o.getSync(y.data))!==null&&s!==void 0?s:vs(Ze.With("ENODATA",c.dir,"rename")));if(b[c.base]){const v=new Ti((i=o.getSync(b[c.base]))!==null&&i!==void 0?i:vs(Ze.With("ENOENT",n,"rename")));if(!v.toStats().isFile())throw Ze.With("EPERM",n,"rename");o.removeSync(v.data),o.removeSync(b[c.base])}b[c.base]=h,o.setSync(u.data,Ml(d)),o.setSync(y.data,Ml(b)),o.commitSync(),this._move(t,n)}catch(o){a.error=o,a.hasError=!0}finally{js(a)}}async stat(t){const n={stack:[],error:void 0,hasError:!1};try{const r=Is(n,this.transaction(),!0);return await this.findInode(r,t,"stat")}catch(r){n.error=r,n.hasError=!0}finally{const r=js(n);r&&await r}}statSync(t){const n={stack:[],error:void 0,hasError:!1};try{const r=Is(n,this.transaction(),!1);return this.findInodeSync(r,t,"stat")}catch(r){n.error=r,n.hasError=!0}finally{js(n)}}async touch(t,n){const r={stack:[],error:void 0,hasError:!1};try{const s=Is(r,this.transaction(),!0),i=await this.findInode(s,t,"touch");i.update(n)&&(this._add(i.ino,t),s.setSync(i.ino,va(i))),await s.commit()}catch(s){r.error=s,r.hasError=!0}finally{const s=js(r);s&&await s}}touchSync(t,n){const r={stack:[],error:void 0,hasError:!1};try{const s=Is(r,this.transaction(),!1),i=this.findInodeSync(s,t,"touch");i.update(n)&&(this._add(i.ino,t),s.setSync(i.ino,va(i))),s.commitSync()}catch(s){r.error=s,r.hasError=!0}finally{js(r)}}async createFile(t,n){return n.mode|=Rc,await this.commitNew(t,n,new Uint8Array,"createFile")}createFileSync(t,n){return n.mode|=Rc,this.commitNewSync(t,n,new Uint8Array,"createFile")}async unlink(t){return this.remove(t,!1)}unlinkSync(t){this.removeSync(t,!1)}async rmdir(t){if((await this.readdir(t)).length)throw Ze.With("ENOTEMPTY",t,"rmdir");await this.remove(t,!0)}rmdirSync(t){if(this.readdirSync(t).length)throw Ze.With("ENOTEMPTY",t,"rmdir");this.removeSync(t,!0)}async mkdir(t,n){return n.mode|=Ni,await this.commitNew(t,n,Xp("{}"),"mkdir")}mkdirSync(t,n){return n.mode|=Ni,this.commitNewSync(t,n,Xp("{}"),"mkdir")}async readdir(t){var n;const r={stack:[],error:void 0,hasError:!1};try{const s=Is(r,this.transaction(),!0),i=await this.findInode(s,t,"readdir");return Object.keys(Za((n=await s.get(i.data))!==null&&n!==void 0?n:vs(Ze.With("ENOENT",t,"readdir"))))}catch(s){r.error=s,r.hasError=!0}finally{const s=js(r);s&&await s}}readdirSync(t){var n;const r={stack:[],error:void 0,hasError:!1};try{const s=Is(r,this.transaction(),!1),i=this.findInodeSync(s,t,"readdir");return Object.keys(Za((n=s.getSync(i.data))!==null&&n!==void 0?n:vs(Ze.With("ENOENT",t,"readdir"))))}catch(s){r.error=s,r.hasError=!0}finally{js(r)}}async sync(t,n,r){const s={stack:[],error:void 0,hasError:!1};try{const i=Is(s,this.transaction(),!0),a=await this.findInode(i,t,"sync");n&&await i.set(a.data,n),a.update(r)&&(this._add(a.ino,t),await i.set(a.ino,va(a))),await i.commit()}catch(i){s.error=i,s.hasError=!0}finally{const i=js(s);i&&await i}}syncSync(t,n,r){const s={stack:[],error:void 0,hasError:!1};try{const i=Is(s,this.transaction(),!1),a=this.findInodeSync(i,t,"sync");n&&i.setSync(a.data,n),a.update(r)&&(this._add(a.ino,t),i.setSync(a.ino,va(a))),i.commitSync()}catch(i){s.error=i,s.hasError=!0}finally{js(s)}}async link(t,n){var r;const s={stack:[],error:void 0,hasError:!1};try{const i=Is(s,this.transaction(),!0),a=Yr(n),o=await this.findInode(i,a,"link"),l=Za((r=await i.get(o.data))!==null&&r!==void 0?r:vs(Ze.With("ENOENT",a,"link"))),c=await this.findInode(i,t,"link");c.nlink++,l[ly(n)]=c.ino,this._add(c.ino,n),await i.set(c.ino,va(c)),await i.set(o.data,Ml(l)),await i.commit()}catch(i){s.error=i,s.hasError=!0}finally{const i=js(s);i&&await i}}linkSync(t,n){var r;const s={stack:[],error:void 0,hasError:!1};try{const i=Is(s,this.transaction(),!1),a=Yr(n),o=this.findInodeSync(i,a,"link"),l=Za((r=i.getSync(o.data))!==null&&r!==void 0?r:vs(Ze.With("ENOENT",a,"link"))),c=this.findInodeSync(i,t,"link");c.nlink++,l[ly(n)]=c.ino,this._add(c.ino,n),i.setSync(c.ino,va(c)),i.setSync(o.data,Ml(l)),i.commitSync()}catch(i){s.error=i,s.hasError=!0}finally{js(s)}}async read(t,n,r,s){var i;const a={stack:[],error:void 0,hasError:!1};try{const o=Is(a,this.transaction(),!0),l=await this.findInode(o,t,"read");if(l.size==0)return;const c=(i=await o.get(l.data,r,s))!==null&&i!==void 0?i:vs(Ze.With("ENODATA",t,"read")),u=o.flag("partial")?c:c.subarray(r,s);u.byteLength>n.byteLength&&ko(`Trying to place ${u.byteLength} bytes into a ${n.byteLength} byte buffer on read`),n.set(u)}catch(o){a.error=o,a.hasError=!0}finally{const o=js(a);o&&await o}}readSync(t,n,r,s){var i;const a={stack:[],error:void 0,hasError:!1};try{const o=Is(a,this.transaction(),!1),l=this.findInodeSync(o,t,"read");if(l.size==0)return;const c=(i=o.getSync(l.data,r,s))!==null&&i!==void 0?i:vs(Ze.With("ENODATA",t,"read")),u=o.flag("partial")?c:c.subarray(r,s);u.byteLength>n.byteLength&&ko(`Trying to place ${u.byteLength} bytes into a ${n.byteLength} byte buffer on read`),n.set(u)}catch(o){a.error=o,a.hasError=!0}finally{js(a)}}async write(t,n,r){var s;const i={stack:[],error:void 0,hasError:!1};try{const a=Is(i,this.transaction(),!0),o=await this.findInode(a,t,"write");let l=n;a.flag("partial")||(l=aw((s=await a.get(o.data))!==null&&s!==void 0?s:new Uint8Array,r+n.byteLength),l.set(n,r),r=0),await a.set(o.data,l,r),this._add(o.ino,t),await a.commit()}catch(a){i.error=a,i.hasError=!0}finally{const a=js(i);a&&await a}}writeSync(t,n,r){var s;const i={stack:[],error:void 0,hasError:!1};try{const a=Is(i,this.transaction(),!1),o=this.findInodeSync(a,t,"write");let l=n;a.flag("partial")||(l=aw((s=a.getSync(o.data))!==null&&s!==void 0?s:new Uint8Array,r+n.byteLength),l.set(n,r),r=0),a.setSync(o.data,l,r),this._add(o.ino,t),a.commitSync()}catch(a){i.error=a,i.hasError=!0}finally{js(i)}}transaction(){return new h_e(this.store.transaction(),this)}async checkRoot(){const t={stack:[],error:void 0,hasError:!1};try{const n=Is(t,this.transaction(),!0);if(await n.get(tl))return;const r=new Ti({ino:tl,data:1,mode:511|Ni});await n.set(r.data,Xp("{}")),this._add(tl,"/"),await n.set(tl,va(r)),await n.commit()}catch(n){t.error=n,t.hasError=!0}finally{const n=js(t);n&&await n}}checkRootSync(){const t={stack:[],error:void 0,hasError:!1};try{const n=Is(t,this.transaction(),!1);if(n.getSync(tl))return;const r=new Ti({ino:tl,data:1,mode:511|Ni});n.setSync(r.data,Xp("{}")),this._add(tl,"/"),n.setSync(tl,va(r)),n.commitSync()}catch(n){t.error=n,t.hasError=!0}finally{js(t)}}async _populate(){const t={stack:[],error:void 0,hasError:!1};try{if(this._initialized){Fa("Attempted to populate tables after initialization");return}Ex("Populating tables with existing store metadata");const n=Is(t,this.transaction(),!0),r=await n.get(tl);if(!r){jP("Store does not have a root inode");const o=new Ti({ino:tl,data:1,mode:511|Ni});await n.set(o.data,Xp("{}")),this._add(tl,"/"),await n.set(tl,va(o)),await n.commit();return}if(r.length<qs(Ti)){BE("Store contains an invalid root inode. Refusing to populate tables");return}const s=new Set;let i=0;const a=[["/",tl]];for(;a.length>0;){i++;const[o,l]=a.shift();this._add(l,o);const c=await n.get(l);if(!c){Fa("Store is missing data for inode: "+l);continue}if(c.length<qs(Ti)){Fa(`Invalid inode size for ino ${l}: ${c.length}`);continue}const u=new Ti(c);if((u.mode&Ni)!=Ni||s.has(l))continue;s.add(l);const d=await n.get(u.data);if(!d){Fa("Store is missing directory data: "+u.data);continue}const h=Za(d);for(const[m,y]of Object.entries(h))a.push([os(o,m),y])}Ex(`Added ${i} existing inode(s) from store`)}catch(n){t.error=n,t.hasError=!0}finally{const n=js(t);n&&await n}}async findInode(t,n,r){var s;const i=this._ids.get(n);if(i===void 0)throw Ze.With("ENOENT",n,r);return new Ti((s=await t.get(i))!==null&&s!==void 0?s:vs(Ze.With("ENOENT",n,r)))}findInodeSync(t,n,r){var s;const i=this._ids.get(n);if(i===void 0)throw Ze.With("ENOENT",n,r);return new Ti((s=t.getSync(i))!==null&&s!==void 0?s:vs(Ze.With("ENOENT",n,r)))}allocNew(t,n){var r;(r=this._lastID)!==null&&r!==void 0||(this._lastID=Math.max(...this._paths.keys())),this._lastID+=2;const s=this._lastID;if(s>lo)throw ko(new Ze(bt.ENOSPC,"No IDs available",t,n),{fs:this});return this._add(s,t),s}async commitNew(t,n,r,s){var i;const a={stack:[],error:void 0,hasError:!1};try{if(t=="/")throw Ze.With("EEXIST",t,s);const o=Is(a,this.transaction(),!0),{dir:l,base:c}=uu(t),u=await this.findInode(o,l,s),d=Za((i=await o.get(u.data))!==null&&i!==void 0?i:vs(Ze.With("ENOENT",l,s)));if(d[c])throw Ze.With("EEXIST",t,s);const h=this.allocNew(t,s),m=new Ti({...n,ino:h,data:h+1,size:r.byteLength});return await o.set(m.ino,va(m)),await o.set(m.data,r),d[c]=m.ino,await o.set(u.data,Ml(d)),await o.commit(),m}catch(o){a.error=o,a.hasError=!0}finally{const o=js(a);o&&await o}}commitNewSync(t,n,r,s){var i;const a={stack:[],error:void 0,hasError:!1};try{if(t=="/")throw Ze.With("EEXIST",t,s);const o=Is(a,this.transaction(),!1),{dir:l,base:c}=uu(t),u=this.findInodeSync(o,l,s),d=Za((i=o.getSync(u.data))!==null&&i!==void 0?i:vs(Ze.With("ENOENT",l,s)));if(d[c])throw Ze.With("EEXIST",t,s);const h=this.allocNew(t,s),m=new Ti({...n,ino:h,data:h+1,size:r.byteLength});return o.setSync(m.ino,va(m)),o.setSync(m.data,r),d[c]=m.ino,o.setSync(u.data,Ml(d)),o.commitSync(),m}catch(o){a.error=o,a.hasError=!0}finally{js(a)}}async remove(t,n){var r,s;const i={stack:[],error:void 0,hasError:!1};try{const a=n?"rmdir":"unlink",o=Is(i,this.transaction(),!0),{dir:l,base:c}=uu(t),u=await this.findInode(o,l,a),d=Za((r=await o.get(u.data))!==null&&r!==void 0?r:vs(Ze.With("ENOENT",l,a)));if(!d[c])throw Ze.With("ENOENT",t,a);const h=d[c],m=new Ti((s=await o.get(h))!==null&&s!==void 0?s:vs(Ze.With("ENOENT",t,a)));if(delete d[c],!n&&Lc(m))throw Ze.With("EISDIR",t,a);await o.set(u.data,Ml(d)),m.nlink>1?(m.update({nlink:m.nlink-1}),await o.set(m.ino,va(m))):(await o.remove(m.data),await o.remove(h),this._remove(h)),await o.commit()}catch(a){i.error=a,i.hasError=!0}finally{const a=js(i);a&&await a}}removeSync(t,n){var r,s;const i={stack:[],error:void 0,hasError:!1};try{const a=n?"rmdir":"unlink",o=Is(i,this.transaction(),!1),{dir:l,base:c}=uu(t),u=this.findInodeSync(o,l,a),d=Za((r=o.getSync(u.data))!==null&&r!==void 0?r:vs(Ze.With("ENOENT",l,a))),h=d[c];if(!h)throw Ze.With("ENOENT",t,a);const m=new Ti((s=o.getSync(h))!==null&&s!==void 0?s:vs(Ze.With("ENOENT",t,a)));if(delete d[c],!n&&Lc(m))throw Ze.With("EISDIR",t,a);o.setSync(u.data,Ml(d)),m.nlink>1?(m.update({nlink:m.nlink-1}),o.setSync(m.ino,va(m))):(o.removeSync(m.data),o.removeSync(h),this._remove(h)),o.commitSync()}catch(a){i.error=a,i.hasError=!0}finally{js(i)}}}class p_e extends f_e{async keys(){return this.store.keys()}async get(t){var n,r,s;return await((s=(r=(n=this.store).getAsync)===null||r===void 0?void 0:r.call(n,t))!==null&&s!==void 0?s:this.store.get(t))}getSync(t){return this.store.get(t)}setSync(t,n){this.store.set(t,n)}removeSync(t){this.store.delete(t)}}class m_e extends Map{constructor(t=lo,n){super(),this.maxSize=t,this.label=n,this.flags=[],this.name="tmpfs"}async sync(){}transaction(){return new p_e(this)}get bytes(){let t=this.size*4;for(const n of this.values())t+=n.byteLength;return t}usage(){return{totalSpace:this.maxSize,freeSpace:this.maxSize-this.bytes}}}const g_e={name:"InMemory",options:{maxSize:{type:"number",required:!1},label:{type:"string",required:!1}},create({maxSize:e,label:t}){const n=new VK(new m_e(e,t));return n.checkRootSync(),n}},y_e=g_e;let Hi=!0;class Z$ extends EP{get cursor(){return this._cursor}constructor(t,n,r,s=!1){super(),this.input=t,this.output=n,this.terminal=s,this.line="",this._cursor=0,this._buffer="",this._closed=!1,this._paused=!1,this._prompt="",this._history=[],this._historyIndex=-1,this._currentLine="",this._onData=i=>{if(!(this._paused||this._closed)){this._buffer+=typeof i=="string"?i:i.toString("utf8");for(let a=this._buffer.indexOf(`
`);a>=0;a=this._buffer.indexOf(`
`)){let o=this._buffer.substring(0,a);o.endsWith("\r")&&(o=o.substring(0,o.length-1)),this._buffer=this._buffer.substring(a+1),this.line=o,o.trim()&&!o.trim().match(/^\s*$/)&&this._history.at(-1)!=o&&(this._history.push(o),this._historyIndex=this._history.length,this.emit("history",this._history)),this.emit("line",o)}}},this.input.on("data",this._onData),this.input.on("end",this.close.bind(this)),this.input.on("close",this.close.bind(this))}close(){var t,n;if(!this._closed){if(this._closed=!0,(n=(t=this.input)===null||t===void 0?void 0:t.removeAllListeners)===null||n===void 0||n.call(t),this._buffer.length){const r=this._buffer;this._buffer="",this.line=r,this.emit("line",r)}this.emit("history",this._history),this.emit("close"),this.removeAllListeners()}}pause(){return this._paused?this:(this._paused=!0,"pause"in this.input&&this.input.pause(),this.emit("pause"),this)}resume(){return this._paused?(this._paused=!1,"resume"in this.input&&this.input.resume(),this.emit("resume"),this):this}setPrompt(t){this._prompt=t}getPrompt(){return this._prompt}prompt(t){if(!this.output)return;if(!t){this.output.write(this._prompt);return}const{cols:n}=this.getCursorPos();this.output.write(this._prompt),this._cursor=n}write(t,n){if(!this._closed){if(t){const r=typeof t=="string"?t:t.toString("utf8");this._onData(r)}if(!(!n||!this.terminal))switch((n.ctrl?"^":"")+n.name){case"^c":this.emit("SIGINT");break;case"^z":this.emit("SIGTSTP");break;case"^q":this.emit("SIGCONT");break;case"home":case"^a":if(!this.output)return;Il(this.output,-this._cursor,0),this._cursor=0,this._cursor=0;break;case"^e":case"end":{if(!this.output)return;const r=this.line.length-this._cursor;if(!r)return;Il(this.output,r,0),this._cursor=this.line.length,this._cursor=this.line.length;break}case"^k":{if(!this.output||this._cursor>=this.line.length)return;const r=this.line.slice(0,this._cursor);PS(this.output,1),this.line=r;break}case"^u":{if(!this.output||!this._cursor)return;const r=this.line.slice(this._cursor);PS(this.output,0),Il(this.output,0,0),this.output.write(this._prompt+r),this.line=r,this._cursor=0,this._cursor=0;break}case"^w":{if(!this.output||!this._cursor)return;let r=this._cursor-1;for(;r>=0&&this.line[r]===" ";)r--;for(;r>=0&&this.line[r]!==" ";)r--;const s=this.line.slice(0,r+1)+this.line.slice(this._cursor),i=r+1;this._renderLine(s),this._cursor=i,this._cursor=i,Il(this.output,-s.length,0),Il(this.output,i,0);break}case"^return":case"^enter":this._onData(`
`);break;case"return":case"enter":this._onData((t?typeof t=="string"?t:t.toString("utf8"):"")+`
`);break;case"up":case"down":{if(!this.output||!this._history.length)return;if(this._historyIndex===this._history.length&&(this._currentLine=this.line||""),n.name=="up"&&this._historyIndex>0)this._historyIndex--;else if(n.name=="down"&&this._historyIndex<this._history.length-1)this._historyIndex++;else if(n.name=="down"&&this._historyIndex==this._history.length-1){this._historyIndex=this._history.length,this._renderLine(this._currentLine);return}else return;const r=this._history[this._historyIndex];this._renderLine(r);break}case"left":case"right":{const r=n.name=="left"?-1:1;if(!this.output)return;const s=Math.max(0,Math.min(this.line.length,this._cursor+r));if(s==this._cursor)return;Il(this.output,r,0),this._cursor=s,this._cursor=s;break}case"backspace":{if(!this.output||!this._cursor)return;const r=this.line.slice(0,this._cursor-1)+this.line.slice(this._cursor);this._renderLine(r),this._cursor=--this._cursor,this._cursor>0&&(Il(this.output,-this._cursor,0),Il(this.output,this._cursor,0));break}case"delete":{if(!this.output||this._cursor>=this.line.length)return;const r=this.line.slice(0,this._cursor)+this.line.slice(this._cursor+1);PS(this.output,0),Il(this.output,0,0),this.output.write(this._prompt+r),this.line=r,Il(this.output,-r.length,0),Il(this.output,this._cursor,0);break}}}}_renderLine(t){this.output&&(PS(this.output,0),Il(this.output,0,0),this.output.write(this._prompt+t),this.line=t,this._cursor=t.length,this._cursor=t.length)}question(t,n,r){const s=typeof n=="function"?n:r;if(this._closed||!this.output){s("");return}this.output.write(t),this.once("line",s)}getCursorPos(){return{rows:0,cols:this.cursor}}prependListener(t,n){const r=this.listeners(t);return this.removeAllListeners(t),this.on(t,n),r.forEach(this.on.bind(this,t)),this}prependOnceListener(t,n){const r=this.listeners(t);return this.removeAllListeners(t),this.once(t,n),r.forEach(this.on.bind(this,t)),this}setMaxListeners(){return Fa("Interface.prototype.setMaxListeners is not supported"),this}getMaxListeners(){return Fa("Interface.prototype.getMaxListeners is not supported"),10}[Symbol.asyncIterator](){let t=!1;return{next:async()=>{if(t)return{done:t,value:void 0};const{resolve:n,promise:r}=Promise.withResolvers();return this.once("line",s=>n({value:s,done:!1})),this.once("close",()=>{t=!0,n({value:void 0,done:t})}),r},return:async n=>t?{done:t,value:n}:(t=!0,this.close(),{done:t,value:n}),throw:async n=>{throw t||(t=!0,this.close()),n},[Symbol.asyncIterator](){return this},[Symbol.asyncDispose]:async()=>{t||(t=!0,this.close())}}}async[Symbol.asyncDispose](){if(this._closed)return;const{resolve:t,promise:n}=Promise.withResolvers();this.once("close",()=>t()),this.close(),await n}rawListeners(t){return this.listeners(t)}}function b_e(e,t,n,r){return"input"in e?new Z$(e.input,e.output,e.completer,e.terminal):new Z$(e,t,n,r)}function PS(e,t){return e.write(t>=0?"\r\x1B[K":"\x1B[K"),!0}function Il(e,t,n){if(!e.write)return!1;let r="";return t<0?r+=`\x1B[${-t}D`:t>0&&(r+=`\x1B[${t}C`),n<0?r+=`\x1B[${-n}A`:n>0&&(r+=`\x1B[${n}B`),r&&e.write(r),!0}class UC{get position(){return this.flag&Tm?this.inode.size:this._position}set position(t){this._position=t}constructor(t,n,r,s,i,a){this.context=t,this.path=n,this.fs=r,this.internalPath=s,this.flag=i,this.inode=a,this._position=0,this.dirty=!1,this.closed=!1}[Symbol.dispose](){this.close()}get _isSync(){return!!(this.flag&qE||this.inode.flags&Eo.Sync)}sync(){if(this.closed)throw Ze.With("EBADF",this.path,"sync");this.dirty&&(this.fs.attributes.has("no_write")||this.fs.touchSync(this.internalPath,this.inode),this.dirty=!1)}datasync(){return this.sync()}close(){if(this.closed)throw Ze.With("EBADF",this.path,"close");this.sync(),this.dispose()}dispose(t){if(this.closed)throw Ze.With("EBADF",this.path,"dispose");if(this.dirty&&!t)throw Ze.With("EBUSY",this.path,"dispose");this.closed=!0}stat(){if(this.closed)throw Ze.With("EBADF",this.path,"stat");return this.inode}truncate(t){if(this.closed)throw Ze.With("EBADF",this.path,"truncate");if(this.dirty=!0,!(this.flag&Da||this.flag&Fd))throw new Ze(bt.EPERM,"File not opened with a writeable mode",this.path,"truncate");this.inode.mtimeMs=Date.now(),this.inode.size=t,this.inode.ctimeMs=Date.now(),this._isSync&&this.sync()}write(t,n=0,r=t.byteLength-n,s=this.position){if(this.closed)throw Ze.With("EBADF",this.path,"write");if(!(this.flag&Da||this.flag&Fd))throw new Ze(bt.EPERM,"File not opened with a writeable mode");if(this.inode.flags&Eo.Immutable)throw new Ze(bt.EPERM,"File is immutable",this.path,"write");this.dirty=!0;const i=s+r,a=t.subarray(n,n+r);return!uw(this.inode)&&!cw(this.inode)&&i>this.inode.size&&(this.inode.size=i),this.inode.mtimeMs=Date.now(),this.inode.ctimeMs=Date.now(),this._position=s+a.byteLength,this.fs.writeSync(this.internalPath,a,s),this._isSync&&this.sync(),a.byteLength}read(t,n=0,r=t.byteLength-n,s=this.position){if(this.closed)throw Ze.With("EBADF",this.path,"read");if(this.flag&Da)throw new Ze(bt.EPERM,"File not opened with a readable mode");this.inode.flags&Eo.NoAtime||(this.dirty=!0,this.inode.atimeMs=Date.now());let i=s+r;!uw(this.inode)&&!cw(this.inode)&&i>this.inode.size&&(i=s+Math.max(this.inode.size-s,0)),this._position=i;const a=new Uint8Array(t.buffer,t.byteOffset,t.byteLength);return this.fs.readSync(this.internalPath,a.subarray(n,n+r),s,i),this._isSync&&this.sync(),i-s}chmod(t){if(this.closed)throw Ze.With("EBADF",this.path,"chmod");this.dirty=!0,this.inode.mode=this.inode.mode&(t>ks?-61441:ks)|t,(this._isSync||t>ks)&&this.sync()}chown(t,n){if(this.closed)throw Ze.With("EBADF",this.path,"chown");this.dirty=!0,UK(this.inode,t,n),this._isSync&&this.sync()}utimes(t,n){if(this.closed)throw Ze.With("EBADF",this.path,"utimes");this.dirty=!0,this.inode.atimeMs=t,this.inode.mtimeMs=n,this._isSync&&this.sync()}streamRead(t){if(this.closed)throw Ze.With("EBADF",this.path,"streamRead");return this.fs.streamRead(this.internalPath,t)}streamWrite(t){if(this.closed)throw Ze.With("EBADF",this.path,"streamWrite");if(this.inode.flags&Eo.Immutable)throw new Ze(bt.EPERM,"File is immutable",this.path,"streamWrite");return this.fs.streamWrite(this.internalPath,t)}}function qC(e){var t,n;const r=(n=(t=e.context)===null||t===void 0?void 0:t.descriptors)!==null&&n!==void 0?n:Uc.descriptors,s=Math.max(r.size?Math.max(...r.keys())+1:0,4);return r.set(s,e),s}function qa(e,t){var n;const s=((n=e==null?void 0:e.descriptors)!==null&&n!==void 0?n:Uc.descriptors).get(t);if(!s)throw new Ze(bt.EBADF);return s}function WK(e,t){var n;return((n=e==null?void 0:e.descriptors)!==null&&n!==void 0?n:Uc.descriptors).delete(t)}const v_e=/[rwasx]{1,2}\+?/;function Bd(e){if(typeof e=="number")return e;if(!v_e.test(e))throw new Ze(bt.EINVAL,"Invalid flag string: "+e);return x_e(e)}function x_e(e){if(!e.includes("r")&&!e.includes("w")&&!e.includes("a"))throw new Ze(bt.EINVAL,"Invalid flag string: "+e);let t=e.includes("r")?NK:$E;return e.includes("w")&&(t|=UE),e.includes("a")&&(t|=Tm),e.includes("+")?t|=Fd:e.includes("r")||(t|=Da),e.includes("s")&&(t|=qE),e.includes("x")&&(t|=zE),t}function HK(e){let t=0;return e&Da||(t|=Wi),(e&Da||e&Fd)&&(t|=ci),t}const dw=new Map;BP("/",y_e.create({label:"root"}));function BP(e,t){if(e[0]!="/"&&(e="/"+e),e=Yd.call(this,e),dw.has(e))throw ko(new Ze(bt.EINVAL,"Mount point is already in use: "+e));t._mountPoint=e,dw.set(e,t),AK(`Mounted ${t.name} on ${e}`),Ex(`${t.name} attributes: ${[...t.attributes].map(([n,r])=>r!=null?n+"="+r:n).join(", ")}`)}function GK(e){if(e[0]!="/"&&(e="/"+e),e=Yd.call(this,e),!dw.has(e)){Fa(e+" is already unmounted");return}dw.delete(e),jP("Unmounted "+e)}function Mr(e,t){const n=(t==null?void 0:t.root)||Uc.root;e=Ln(os(n,e));const r=[...dw].sort((s,i)=>s[0].length>i[0].length?-1:1);for(const[s,i]of r)if(__e(s,e))return e=e.slice(s.length>1?s.length:0),e===""&&(e=n),{fs:i,path:e,mountPoint:s,root:n};throw I1e(new Ze(bt.EIO,"No file system",e))}function iM(e,t){for(const[n,r]of Object.entries(t))e=e==null?void 0:e.replaceAll(n,r);return e}function ps(e,t){typeof e.stack=="string"&&(e.stack=iM(e.stack,t));try{e.message=iM(e.message,t)}catch{}return e.path&&(e.path=iM(e.path,t)),e}function KK(e,t){const n=e.usage(),r=n.blockSize||4096;return{type:(t?BigInt:Number)(e.type),bsize:(t?BigInt:Number)(r),ffree:(t?BigInt:Number)(n.freeNodes||lo),files:(t?BigInt:Number)(n.totalNodes||lo),bavail:(t?BigInt:Number)(n.freeSpace/r),bfree:(t?BigInt:Number)(n.freeSpace/r),blocks:(t?BigInt:Number)(n.totalSpace/r)}}function w_e(e){var t,n,r,s,i,a,o;const l=this!==null&&this!==void 0?this:Uc;if(((t=l.credentials)===null||t===void 0?void 0:t.uid)!==0&&((n=l.credentials)===null||n===void 0?void 0:n.gid)!==0&&((r=l.credentials)===null||r===void 0?void 0:r.euid)!==0&&((s=l.credentials)===null||s===void 0?void 0:s.egid)!==0)throw new Ze(bt.EPERM,"Can not chroot() as non-root user");(i=l.root)!==null&&i!==void 0||(l.root="/");const c=os(l.root,e);for(const u of(o=(a=l.descriptors)===null||a===void 0?void 0:a.values())!==null&&o!==void 0?o:[]){if(!u.path.startsWith(l.root))throw Ze.With("EBUSY",u.path,"chroot");u.path=u.path.slice(l.root.length)}if(c.length>l.root.length)throw new Ze(bt.EPERM,"Can not chroot() outside of current root");l.root=c}function __e(e,t){return e==="/"||e===t?!0:(e.endsWith("/")||(e+="/"),t.startsWith(e))}class YK extends EP{off(t,n,r,s){return super.off(t,n,r,s)}removeListener(t,n,r,s){return super.removeListener(t,n,r,s)}constructor(t,n){super(),this._context=t,this.path=n}setMaxListeners(){throw Ze.With("ENOSYS",this.path,"Watcher.setMaxListeners")}getMaxListeners(){throw Ze.With("ENOSYS",this.path,"Watcher.getMaxListeners")}prependListener(){throw Ze.With("ENOSYS",this.path,"Watcher.prependListener")}prependOnceListener(){throw Ze.With("ENOSYS",this.path,"Watcher.prependOnceListener")}rawListeners(){throw Ze.With("ENOSYS",this.path,"Watcher.rawListeners")}ref(){return this}unref(){return this}}class ZK extends YK{constructor(t,n,r){super(t,n),this.options=r,this.realpath=t!=null&&t.root?os(t.root,n):n,C_e(this.realpath,this)}close(){super.emit("close"),k_e(this.realpath,this)}[Symbol.dispose](){this.close()}}class S_e extends YK{constructor(t,n,r){super(t,n),this.options=r,this.start()}onInterval(){try{const t=kh(this.path);r_e(this.previous,t)||(this.emit("change",t,this.previous),this.previous=t)}catch(t){this.emit("error",t)}}start(){const t=this.options.interval||5e3;try{this.previous=kh(this.path)}catch(n){this.emit("error",n);return}this.intervalId=setInterval(this.onInterval.bind(this),t),!this.options.persistent&&typeof this.intervalId=="object"&&this.intervalId.unref()}stop(){this.intervalId&&(clearInterval(this.intervalId),this.intervalId=void 0),this.removeAllListeners()}}const uh=new Map;function C_e(e,t){const n=Ln(e);uh.has(n)||uh.set(n,new Set),uh.get(n).add(t)}function k_e(e,t){const n=Ln(e);uh.has(n)&&(uh.get(n).delete(t),uh.get(n).size===0&&uh.delete(n))}function ka(e,t,n){var r;e&&(n=os((r=e.root)!==null&&r!==void 0?r:"/",n)),n=Ln(n);for(let s=n;s!="/";s=Yr(s)){const i=uh.get(s);if(i)for(const a of i)a.emit("change",t,TK.call(a._context,s,n)||ly(n))}}var _1=function(e,t,n){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var r,s;if(n){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=t[Symbol.asyncDispose]}if(r===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=t[Symbol.dispose],n&&(s=r)}if(typeof r!="function")throw new TypeError("Object not disposable.");s&&(r=function(){try{s.call(this)}catch(i){return Promise.reject(i)}}),e.stack.push({value:t,dispose:r,async:n})}else n&&e.stack.push({async:!0});return t},S1=function(e){return function(t){function n(a){t.error=t.hasError?new e(a,t.error,"An error was suppressed during disposal."):a,t.hasError=!0}var r,s=0;function i(){for(;r=t.stack.pop();)try{if(!r.async&&s===1)return s=0,t.stack.push(r),Promise.resolve().then(i);if(r.dispose){var a=r.dispose.call(r.value);if(r.async)return s|=2,Promise.resolve(a).then(i,function(o){return n(o),i()})}else s|=1}catch(o){n(o)}if(s===1)return t.hasError?Promise.reject(t.error):Promise.resolve();if(t.hasError)throw t.error}return i()}}(typeof SuppressedError=="function"?SuppressedError:function(e,t,n){var r=new Error(n);return r.name="SuppressedError",r.error=e,r.suppressed=t,r});function E_e(e,t){e=Ln(e),t=Ln(t);const n=Mr(e,this),r=Mr(t,this);if(!kh.call(this,Yr(e)).hasAccess(ci,this))throw Ze.With("EACCES",e,"rename");try{if(n===r){n.fs.renameSync(n.path,r.path),ka(this,"rename",e.toString()),ka(this,"change",t.toString());return}VP.call(this,t,qP(e)),UP.call(this,e),ka(this,"rename",e.toString())}catch(s){throw ps(s,{[n.path]:e,[r.path]:t})}}function $P(e){e=Ln(e);try{const{fs:t,path:n}=Mr(Vh.call(this,e),this);return t.existsSync(n)}catch(t){if(t.errno==bt.ENOENT)return!1;throw t}}function kh(e,t){e=Ln(e);const{fs:n,path:r}=Mr(Vh.call(this,e),this);try{const s=n.statSync(r);if(Hi&&!hs(this,s,Wi))throw Ze.With("EACCES",r,"stat");return t!=null&&t.bigint?new Km(s):new sf(s)}catch(s){throw ps(s,{[r]:e})}}function zP(e,t){e=Ln(e);const{fs:n,path:r}=Mr(e,this);try{const s=n.statSync(r);if(Hi&&!hs(this,s,Wi))throw Ze.With("EACCES",r,"lstat");return t!=null&&t.bigint?new Km(s):new sf(s)}catch(s){throw ps(s,{[r]:e})}}function T_e(e,t=0){const n={stack:[],error:void 0,hasError:!1};try{const r=_1(n,Ym.call(this,e,{flag:"r+"}),!1);if(t||(t=0),t<0)throw new Ze(bt.EINVAL);r.truncate(t)}catch(r){n.error=r,n.hasError=!0}finally{S1(n)}}function UP(e){e=Ln(e);const{fs:t,path:n}=Mr(e,this);try{if(Hi&&!hs(this,t.statSync(n),ci))throw Ze.With("EACCES",n,"unlink");t.unlinkSync(n),ka(this,"rename",e.toString())}catch(r){throw ps(r,{[n]:e})}}function Ym(e,t){var n;e=Ln(e);const r=qh(t.mode,420),s=Bd(t.flag);e=t.preserveSymlinks?e:Vh.call(this,e);const{fs:i,path:a}=Mr(e,this);let o;try{o=i.statSync(a)}catch{}if(!o){if(!(s&$E))throw Ze.With("ENOENT",e,"_open");const c=i.statSync(Yr(a));if(!hs(this,c,ci))throw Ze.With("EACCES",Yr(e),"_open");if(!Lc(c))throw Ze.With("ENOTDIR",Yr(e),"_open");if(!t.allowDirectory&&r&Ni)throw Ze.With("EISDIR",e,"_open");if(!hs(this,c,ci))throw Ze.With("EACCES",Yr(a),"_open");const{euid:u,egid:d}=(n=this===null||this===void 0?void 0:this.credentials)!==null&&n!==void 0?n:Uc.credentials,h=i.createFileSync(a,{mode:r,uid:c.mode&x1?c.uid:u,gid:c.mode&w1?c.gid:d});return new UC(this,e,i,a,s,h)}if(!hs(this,o,r)||!hs(this,o,HK(s)))throw Ze.With("EACCES",e,"_open");if(s&zE)throw Ze.With("EEXIST",e,"_open");const l=new UC(this,e,i,a,s,o);if(s&UE&&l.truncate(0),!t.allowDirectory&&o.mode&Ni)throw Ze.With("EISDIR",e,"_open");return l}function VE(e,t,n=PP){return qC(Ym.call(this,e,{flag:t,mode:n}))}function WE(e,t,n){return qC(Ym.call(this,e,{flag:t,mode:n,preserveSymlinks:!0}))}function XK(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{const s=_1(r,typeof e=="number"?qa(this,e):Ym.call(this,e.toString(),{flag:t,mode:420,preserveSymlinks:n}),!1),{size:i}=s.stat(),a=new Uint8Array(i);return s.read(a,0,i,0),a}catch(s){r.error=s,r.hasError=!0}finally{S1(r)}}function qP(e,t={}){const n=Ld(t,null,"r",420);if(Bd(n.flag)&Da)throw new Ze(bt.EINVAL,"Flag passed to readFile must allow for reading");const s=Ds.from(XK.call(this,e,n.flag,!1));return n.encoding?s.toString(n.encoding):s}function VP(e,t,n={}){const r={stack:[],error:void 0,hasError:!1};try{const s=Ld(n,"utf8","w+",420),i=Bd(s.flag);if(!(i&Da||i&Fd))throw new Ze(bt.EINVAL,"Flag passed to writeFile must allow for writing");if(typeof t!="string"&&!s.encoding)throw new Ze(bt.EINVAL,"Encoding not specified");const a=typeof t=="string"?Ds.from(t,s.encoding):new Uint8Array(t.buffer,t.byteOffset,t.byteLength);if(!a)throw new Ze(bt.EINVAL,"Data not specified");_1(r,typeof e=="number"?qa(this,e):Ym.call(this,e.toString(),{flag:i,mode:s.mode,preserveSymlinks:!0}),!1).write(a,0,a.byteLength,0),ka(this,"change",e.toString())}catch(s){r.error=s,r.hasError=!0}finally{S1(r)}}function A_e(e,t,n={}){const r={stack:[],error:void 0,hasError:!1};try{const s=Ld(n,"utf8","a+",420),i=Bd(s.flag);if(!(i&Tm))throw new Ze(bt.EINVAL,"Flag passed to appendFile must allow for appending");if(typeof t!="string"&&!s.encoding)throw new Ze(bt.EINVAL,"Encoding not specified");const a=typeof t=="string"?Ds.from(t,s.encoding):new Uint8Array(t.buffer,t.byteOffset,t.byteLength);_1(r,Ym.call(this,typeof e=="number"?qa(this,e).path:e.toString(),{flag:i,mode:s.mode,preserveSymlinks:!0}),!1).write(a,0,a.byteLength)}catch(s){r.error=s,r.hasError=!0}finally{S1(r)}}function R_e(e,t){const n=qa(this,e).stat();return t!=null&&t.bigint?new Km(n):new sf(n)}function Zm(e){qa(this,e).close(),WK(this,e)}function N_e(e,t=0){if(t||(t=0),t<0)throw new Ze(bt.EINVAL);qa(this,e).truncate(t)}function M_e(e){qa(this,e).sync()}function I_e(e){qa(this,e).datasync()}function j_e(e,t,n,r,s){let i,a,o,l;if(typeof t=="string"){l=typeof n=="number"?n:null;const d=typeof r=="string"?r:"utf8";a=0,i=Ds.from(t,d),o=i.byteLength}else i=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),a=n,o=r,l=typeof s=="number"?s:null;const c=qa(this,e);l??(l=c.position);const u=c.write(i,a,o,l);return ka(this,"change",c.path),u}function O_e(e,t,n,r,s){const i=qa(this,e),a=typeof n=="object"?n.offset:n;return typeof n=="object"&&(r=n.length,s=n.position),s=Number(s),isNaN(s)&&(s=i.position),i.read(t,a,r,s)}function WP(e,t,n){qa(this,e).chown(t,n)}function HP(e,t){const n=qh(t,-1);if(n<0)throw new Ze(bt.EINVAL,"Invalid mode.");qa(this,e).chmod(n)}function GP(e,t,n){qa(this,e).utimes(zC(t),zC(n))}function JK(e){e=Ln(e);const{fs:t,path:n}=Mr(Vh.call(this,e),this);try{const r=t.statSync(n);if(!Lc(r))throw Ze.With("ENOTDIR",n,"rmdir");if(Hi&&!hs(this,r,ci))throw Ze.With("EACCES",n,"rmdir");t.rmdirSync(n),ka(this,"rename",e.toString())}catch(r){throw ps(r,{[n]:e})}}function KP(e,t){var n,r;const{euid:s,egid:i}=(n=this===null||this===void 0?void 0:this.credentials)!==null&&n!==void 0?n:Uc.credentials;t=typeof t=="object"?t:{mode:t};const a=qh(t==null?void 0:t.mode,511);e=Vh.call(this,e);const{fs:o,path:l,root:c}=Mr(e,this),u={[l]:e},d=(h,m)=>{if(!hs(this,m,ci))throw Ze.With("EACCES",Yr(h),"mkdir");const y=o.mkdirSync(h,{mode:a,uid:m.mode&x1?m.uid:s,gid:m.mode&w1?m.gid:i});return ka(this,"rename",h),y};try{if(!(t!=null&&t.recursive)){d(l,o.statSync(Yr(l)));return}const h=[];for(let y=l,b=e;!o.existsSync(y);y=Yr(y),b=Yr(b))h.unshift(y),u[y]=b;if(!h.length)return;const m=[o.statSync(Yr(h[0]))];for(const[y,b]of h.entries())m.push(d(b,m[y]));return c.length==1?h[0]:(r=h[0])===null||r===void 0?void 0:r.slice(c.length)}catch(h){throw ps(h,u)}}function Zy(e,t){t=typeof t=="object"?t:{encoding:t},e=Ln(e);const{fs:n,path:r}=Mr(Vh.call(this,e),this);let s;try{const a=n.statSync(r);if(Hi&&!hs(this,a,Wi))throw Ze.With("EACCES",r,"readdir");if(!Lc(a))throw Ze.With("ENOTDIR",r,"readdir");s=n.readdirSync(r)}catch(a){throw ps(a,{[r]:e})}const i=[];for(const a of s){let o;try{o=n.statSync(os(r,a))}catch{continue}if(t!=null&&t.withFileTypes?i.push(new fw(a,o)):(t==null?void 0:t.encoding)=="buffer"?i.push(Ds.from(a)):i.push(a),!(!Lc(o)||!(t!=null&&t.recursive)))for(const l of Zy.call(this,os(e,a),t))l instanceof fw?(l.path=os(a,l.path),i.push(l)):Ds.isBuffer(l)?i.push(Ds.from(os(a,AP(l)))):i.push(os(a,l))}return i}function P_e(e,t){if(e=Ln(e),!kh(Yr(e)).hasAccess(Wi,this))throw Ze.With("EACCES",Yr(e),"link");if(t=Ln(t),!kh(Yr(t)).hasAccess(ci,this))throw Ze.With("EACCES",Yr(t),"link");const{fs:n,path:r}=Mr(e,this),s=Mr(t,this);if(n!=s.fs)throw Ze.With("EXDEV",t,"link");try{if(Hi&&!hs(this,n.statSync(r),Wi))throw Ze.With("EACCES",r,"link");return n.linkSync(r,s.path)}catch(i){throw ps(i,{[r]:e,[s.path]:t})}}function D_e(e,t,n="file"){const r={stack:[],error:void 0,hasError:!1};try{if(!["file","dir","junction"].includes(n))throw new Ze(bt.EINVAL,"Invalid type: "+n);t=Ln(t);const s=_1(r,Ym.call(this,t,{flag:"wx",mode:420}),!1);s.write(Xp(Ln(e,!0))),s.chmod(rf)}catch(s){r.error=s,r.hasError=!0}finally{S1(r)}}function Nj(e,t){const n=Ds.from(XK.call(this,e,"r",!0)),r=typeof t=="object"?t==null?void 0:t.encoding:t;return r=="buffer"?n:n.toString(r??"utf-8")}function F_e(e,t,n){const r=VE.call(this,e,"r+");WP.call(this,r,t,n),Zm.call(this,r)}function L_e(e,t,n){const r=WE.call(this,e,"r+");WP.call(this,r,t,n),Zm.call(this,r)}function B_e(e,t){const n=VE.call(this,e,"r+");HP.call(this,n,t),Zm.call(this,n)}function $_e(e,t){const n=WE.call(this,e,"r+");HP.call(this,n,t),Zm.call(this,n)}function QK(e,t,n){const r=VE.call(this,e,"r+");GP.call(this,r,t,n),Zm.call(this,r)}function z_e(e,t,n){const r=WE.call(this,e,"r+");GP.call(this,r,t,n),Zm.call(this,r)}function Mj(e,t,n){try{const l=Mr(t,e),c=l.fs.statSync(l.path);if(!cy(c))return{...l,fullPath:t,stats:c};const u=Yd.call(e,Yr(t),Nj.call(e,t).toString());return Mj(e,u)}catch{}const{base:r,dir:s}=uu(t),i=s=="/"?"/":Vh.call(e,s),a=os(i,r),o=Mr(a,e);try{const l=o.fs.statSync(o.path);if(!cy(l))return{...o,fullPath:a,stats:l};const c=Yd.call(e,i,Nj.call(e,a).toString());return Mj(e,c)}catch(l){if(l.code=="ENOENT")return{...o,fullPath:t};throw ps(l,{[o.path]:a})}}function Vh(e,t){var n;const r=typeof t=="string"?t:(n=t==null?void 0:t.encoding)!==null&&n!==void 0?n:"utf8";e=Ln(e);const{fullPath:s}=Mj(this,e);if(r=="utf8"||r=="utf-8")return s;const i=Ds.from(s,"utf-8");return r=="buffer"?i:i.toString(r)}function U_e(e,t=384){if(!hs(this,kh.call(this,e),t))throw new Ze(bt.EACCES)}function eY(e,t){e=Ln(e);let n;try{n=zP.bind(this)(e)}catch(r){if(r.code!="ENOENT"||!(t!=null&&t.force))throw r}if(n)switch(n.mode&ks){case Ni:if(t!=null&&t.recursive)for(const r of Zy.call(this,e))eY.call(this,os(e,r),t);JK.call(this,e);break;case Rc:case rf:case Wm:case Hm:UP.call(this,e);break;case Gm:case Vm:default:throw new Ze(bt.EPERM,"File type not supported",e,"rm")}}function q_e(e,t){const n=typeof t=="object"?t==null?void 0:t.encoding:t||"utf8",s="/tmp/"+`${e}${Date.now()}-${Math.random().toString(36).slice(2)}`;return KP.call(this,s),n=="buffer"?Ds.from(s):s}function tY(e,t,n){if(e=Ln(e),t=Ln(t),n&&n&DP&&$P(t))throw new Ze(bt.EEXIST,"Destination file already exists",t,"copyFile");VP.call(this,t,qP(e)),ka(this,"rename",t.toString())}function V_e(e,t,n){const r=qa(this,e);let s=0;for(const i of t)s+=r.read(i,0,i.byteLength,n+s);return s}function W_e(e,t,n){const r=qa(this,e);let s=0;for(const i of t)s+=r.write(new Uint8Array(i.buffer),0,i.byteLength,n+s);return s}function H_e(e,t){return e=Ln(e),new YP(e,this)}function nY(e,t,n){e=Ln(e),t=Ln(t);const r=zP.call(this,e);if(n!=null&&n.errorOnExist&&$P.call(this,t))throw new Ze(bt.EEXIST,"Destination file or directory already exists",t,"cp");switch(r.mode&ks){case Ni:if(!(n!=null&&n.recursive))throw new Ze(bt.EISDIR,e+" is a directory (not copied)",e,"cp");KP.call(this,t,{recursive:!0});for(const s of Zy.call(this,e,{withFileTypes:!0}))n.filter&&!n.filter(os(e,s.name),os(t,s.name))||nY.call(this,os(e,s.name),os(t,s.name),n);break;case Rc:case rf:tY.call(this,e,t);break;case Wm:case Hm:case Gm:case Vm:default:throw new Ze(bt.EPERM,"File type not supported",e,"rm")}n!=null&&n.preserveTimestamps&&QK.call(this,t,r.atime,r.mtime)}function G_e(e,t){e=Ln(e);const{fs:n}=Mr(e,this);return KK(n,t==null?void 0:t.bigint)}function K_e(e,t={}){e=Array.isArray(e)?e:[e];const{cwd:n="/",withFileTypes:r=!1,exclude:s=()=>!1}=t,i=e.map(l=>(l=l.replace(/([.?+^$(){}|[\]/])/g,"\\$1").replace(/\*\*/g,".*").replace(/\*/g,"[^/]*").replace(/\?/g,"."),new RegExp(`^${l}$`))),a=[];function o(l){const c=Zy(l,{withFileTypes:r,encoding:"utf8"});for(const u of c){const d=r?u.path:l+"/"+u;s(r?u:d)||(kh(d).isDirectory()&&i.some(h=>h.source.includes(".*"))&&o(d),i.some(h=>h.test(d.replace(/^\/+/g,"")))&&a.push(r?u.path:d.replace(/^\/+/g,"")))}}return o(n),a}class fw{get name(){return ly(this.path)}constructor(t,n){this.path=t,this.stats=n}get parentPath(){return this.path}isFile(){return l_e(this.stats)}isDirectory(){return Lc(this.stats)}isBlockDevice(){return cw(this.stats)}isCharacterDevice(){return uw(this.stats)}isSymbolicLink(){return cy(this.stats)}isFIFO(){return u_e(this.stats)}isSocket(){return c_e(this.stats)}}class YP{checkClosed(){if(this.closed)throw new Ze(bt.EBADF,"Can not use closed Dir")}constructor(t,n){this.path=t,this.context=n,this.closed=!1}close(t){if(this.closed=!0,!t)return Promise.resolve();t()}closeSync(){this.closed=!0}async _read(){var t,n;return this.checkClosed(),(t=this._entries)!==null&&t!==void 0||(this._entries=await Jm.call(this.context,this.path,{withFileTypes:!0})),this._entries.length&&(n=this._entries.shift())!==null&&n!==void 0?n:null}read(t){if(!t)return this._read();this._read().then(n=>t(void 0,n))}readSync(){var t,n;return this.checkClosed(),(t=this._entries)!==null&&t!==void 0||(this._entries=Zy.call(this.context,this.path,{withFileTypes:!0})),this._entries.length&&(n=this._entries.shift())!==null&&n!==void 0?n:null}async next(){const t=await this._read();return t?{done:!1,value:t}:(await this.close(),{done:!0,value:void 0})}[Symbol.asyncIterator](){return this}[Symbol.asyncDispose](){return Promise.resolve()}}var aM={exports:{}},oM={exports:{}},lM={},X$;function Wh(){return X$||(X$=1,function(e){Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});var t={},n={};n.byteLength=u,n.toByteArray=h,n.fromByteArray=b;for(var r=[],s=[],i=typeof Uint8Array<"u"?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,l=a.length;o<l;++o)r[o]=a[o],s[a.charCodeAt(o)]=o;s[45]=62,s[95]=63;function c(w){var S=w.length;if(S%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var k=w.indexOf("=");k===-1&&(k=S);var C=k===S?0:4-k%4;return[k,C]}function u(w){var S=c(w),k=S[0],C=S[1];return(k+C)*3/4-C}function d(w,S,k){return(S+k)*3/4-k}function h(w){var S,k=c(w),C=k[0],T=k[1],R=new i(d(w,C,T)),N=0,I=T>0?C-4:C,P;for(P=0;P<I;P+=4)S=s[w.charCodeAt(P)]<<18|s[w.charCodeAt(P+1)]<<12|s[w.charCodeAt(P+2)]<<6|s[w.charCodeAt(P+3)],R[N++]=S>>16&255,R[N++]=S>>8&255,R[N++]=S&255;return T===2&&(S=s[w.charCodeAt(P)]<<2|s[w.charCodeAt(P+1)]>>4,R[N++]=S&255),T===1&&(S=s[w.charCodeAt(P)]<<10|s[w.charCodeAt(P+1)]<<4|s[w.charCodeAt(P+2)]>>2,R[N++]=S>>8&255,R[N++]=S&255),R}function m(w){return r[w>>18&63]+r[w>>12&63]+r[w>>6&63]+r[w&63]}function y(w,S,k){for(var C,T=[],R=S;R<k;R+=3)C=(w[R]<<16&16711680)+(w[R+1]<<8&65280)+(w[R+2]&255),T.push(m(C));return T.join("")}function b(w){for(var S,k=w.length,C=k%3,T=[],R=16383,N=0,I=k-C;N<I;N+=R)T.push(y(w,N,N+R>I?I:N+R));return C===1?(S=w[k-1],T.push(r[S>>2]+r[S<<4&63]+"==")):C===2&&(S=(w[k-2]<<8)+w[k-1],T.push(r[S>>10]+r[S>>4&63]+r[S<<2&63]+"=")),T.join("")}var v={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */v.read=function(w,S,k,C,T){var R,N,I=T*8-C-1,P=(1<<I)-1,B=P>>1,D=-7,W=k?T-1:0,O=k?-1:1,Z=w[S+W];for(W+=O,R=Z&(1<<-D)-1,Z>>=-D,D+=I;D>0;R=R*256+w[S+W],W+=O,D-=8);for(N=R&(1<<-D)-1,R>>=-D,D+=C;D>0;N=N*256+w[S+W],W+=O,D-=8);if(R===0)R=1-B;else{if(R===P)return N?NaN:(Z?-1:1)*(1/0);N=N+Math.pow(2,C),R=R-B}return(Z?-1:1)*N*Math.pow(2,R-C)},v.write=function(w,S,k,C,T,R){var N,I,P,B=R*8-T-1,D=(1<<B)-1,W=D>>1,O=T===23?Math.pow(2,-24)-Math.pow(2,-77):0,Z=C?0:R-1,U=C?1:-1,H=S<0||S===0&&1/S<0?1:0;for(S=Math.abs(S),isNaN(S)||S===1/0?(I=isNaN(S)?1:0,N=D):(N=Math.floor(Math.log(S)/Math.LN2),S*(P=Math.pow(2,-N))<1&&(N--,P*=2),N+W>=1?S+=O/P:S+=O*Math.pow(2,1-W),S*P>=2&&(N++,P/=2),N+W>=D?(I=0,N=D):N+W>=1?(I=(S*P-1)*Math.pow(2,T),N=N+W):(I=S*Math.pow(2,W-1)*Math.pow(2,T),N=0));T>=8;w[k+Z]=I&255,Z+=U,I/=256,T-=8);for(N=N<<T|I,B+=T;B>0;w[k+Z]=N&255,Z+=U,N/=256,B-=8);w[k+Z-U]|=H*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(w){const S=n,k=v,C=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;w.Buffer=D,w.SlowBuffer=se,w.INSPECT_MAX_BYTES=50;const T=2147483647;w.kMaxLength=T;const{Uint8Array:R,ArrayBuffer:N,SharedArrayBuffer:I}=globalThis;D.TYPED_ARRAY_SUPPORT=P(),!D.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function P(){try{const Y=new R(1),G={foo:function(){return 42}};return Object.setPrototypeOf(G,R.prototype),Object.setPrototypeOf(Y,G),Y.foo()===42}catch{return!1}}Object.defineProperty(D.prototype,"parent",{enumerable:!0,get:function(){if(D.isBuffer(this))return this.buffer}}),Object.defineProperty(D.prototype,"offset",{enumerable:!0,get:function(){if(D.isBuffer(this))return this.byteOffset}});function B(Y){if(Y>T)throw new RangeError('The value "'+Y+'" is invalid for option "size"');const G=new R(Y);return Object.setPrototypeOf(G,D.prototype),G}function D(Y,G,J){if(typeof Y=="number"){if(typeof G=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return U(Y)}return W(Y,G,J)}D.poolSize=8192;function W(Y,G,J){if(typeof Y=="string")return H(Y,G);if(N.isView(Y))return te(Y);if(Y==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof Y);if(ve(Y,N)||Y&&ve(Y.buffer,N)||typeof I<"u"&&(ve(Y,I)||Y&&ve(Y.buffer,I)))return V(Y,G,J);if(typeof Y=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const xe=Y.valueOf&&Y.valueOf();if(xe!=null&&xe!==Y)return D.from(xe,G,J);const De=Q(Y);if(De)return De;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof Y[Symbol.toPrimitive]=="function")return D.from(Y[Symbol.toPrimitive]("string"),G,J);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof Y)}D.from=function(Y,G,J){return W(Y,G,J)},Object.setPrototypeOf(D.prototype,R.prototype),Object.setPrototypeOf(D,R);function O(Y){if(typeof Y!="number")throw new TypeError('"size" argument must be of type number');if(Y<0)throw new RangeError('The value "'+Y+'" is invalid for option "size"')}function Z(Y,G,J){return O(Y),Y<=0?B(Y):G!==void 0?typeof J=="string"?B(Y).fill(G,J):B(Y).fill(G):B(Y)}D.alloc=function(Y,G,J){return Z(Y,G,J)};function U(Y){return O(Y),B(Y<0?0:ee(Y)|0)}D.allocUnsafe=function(Y){return U(Y)},D.allocUnsafeSlow=function(Y){return U(Y)};function H(Y,G){if((typeof G!="string"||G==="")&&(G="utf8"),!D.isEncoding(G))throw new TypeError("Unknown encoding: "+G);const J=pe(Y,G)|0;let xe=B(J);const De=xe.write(Y,G);return De!==J&&(xe=xe.slice(0,De)),xe}function L(Y){const G=Y.length<0?0:ee(Y.length)|0,J=B(G);for(let xe=0;xe<G;xe+=1)J[xe]=Y[xe]&255;return J}function te(Y){if(ve(Y,R)){const G=new R(Y);return V(G.buffer,G.byteOffset,G.byteLength)}return L(Y)}function V(Y,G,J){if(G<0||Y.byteLength<G)throw new RangeError('"offset" is outside of buffer bounds');if(Y.byteLength<G+(J||0))throw new RangeError('"length" is outside of buffer bounds');let xe;return G===void 0&&J===void 0?xe=new R(Y):J===void 0?xe=new R(Y,G):xe=new R(Y,G,J),Object.setPrototypeOf(xe,D.prototype),xe}function Q(Y){if(D.isBuffer(Y)){const G=ee(Y.length)|0,J=B(G);return J.length===0||Y.copy(J,0,0,G),J}if(Y.length!==void 0)return typeof Y.length!="number"||_e(Y.length)?B(0):L(Y);if(Y.type==="Buffer"&&Array.isArray(Y.data))return L(Y.data)}function ee(Y){if(Y>=T)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+T.toString(16)+" bytes");return Y|0}function se(Y){return+Y!=Y&&(Y=0),D.alloc(+Y)}D.isBuffer=function(G){return G!=null&&G._isBuffer===!0&&G!==D.prototype},D.compare=function(G,J){if(ve(G,R)&&(G=D.from(G,G.offset,G.byteLength)),ve(J,R)&&(J=D.from(J,J.offset,J.byteLength)),!D.isBuffer(G)||!D.isBuffer(J))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(G===J)return 0;let xe=G.length,De=J.length;for(let He=0,xt=Math.min(xe,De);He<xt;++He)if(G[He]!==J[He]){xe=G[He],De=J[He];break}return xe<De?-1:De<xe?1:0},D.isEncoding=function(G){switch(String(G).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},D.concat=function(G,J){if(!Array.isArray(G))throw new TypeError('"list" argument must be an Array of Buffers');if(G.length===0)return D.alloc(0);let xe;if(J===void 0)for(J=0,xe=0;xe<G.length;++xe)J+=G[xe].length;const De=D.allocUnsafe(J);let He=0;for(xe=0;xe<G.length;++xe){let xt=G[xe];if(ve(xt,R))He+xt.length>De.length?(D.isBuffer(xt)||(xt=D.from(xt)),xt.copy(De,He)):R.prototype.set.call(De,xt,He);else if(D.isBuffer(xt))xt.copy(De,He);else throw new TypeError('"list" argument must be an Array of Buffers');He+=xt.length}return De};function pe(Y,G){if(D.isBuffer(Y))return Y.length;if(N.isView(Y)||ve(Y,N))return Y.byteLength;if(typeof Y!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof Y);const J=Y.length,xe=arguments.length>2&&arguments[2]===!0;if(!xe&&J===0)return 0;let De=!1;for(;;)switch(G){case"ascii":case"latin1":case"binary":return J;case"utf8":case"utf-8":return dt(Y).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return J*2;case"hex":return J>>>1;case"base64":return Ue(Y).length;default:if(De)return xe?-1:dt(Y).length;G=(""+G).toLowerCase(),De=!0}}D.byteLength=pe;function ue(Y,G,J){let xe=!1;if((G===void 0||G<0)&&(G=0),G>this.length||((J===void 0||J>this.length)&&(J=this.length),J<=0)||(J>>>=0,G>>>=0,J<=G))return"";for(Y||(Y="utf8");;)switch(Y){case"hex":return Re(this,G,J);case"utf8":case"utf-8":return ye(this,G,J);case"ascii":return oe(this,G,J);case"latin1":case"binary":return re(this,G,J);case"base64":return K(this,G,J);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Be(this,G,J);default:if(xe)throw new TypeError("Unknown encoding: "+Y);Y=(Y+"").toLowerCase(),xe=!0}}D.prototype._isBuffer=!0;function Oe(Y,G,J){const xe=Y[G];Y[G]=Y[J],Y[J]=xe}D.prototype.swap16=function(){const G=this.length;if(G%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let J=0;J<G;J+=2)Oe(this,J,J+1);return this},D.prototype.swap32=function(){const G=this.length;if(G%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let J=0;J<G;J+=4)Oe(this,J,J+3),Oe(this,J+1,J+2);return this},D.prototype.swap64=function(){const G=this.length;if(G%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let J=0;J<G;J+=8)Oe(this,J,J+7),Oe(this,J+1,J+6),Oe(this,J+2,J+5),Oe(this,J+3,J+4);return this},D.prototype.toString=function(){const G=this.length;return G===0?"":arguments.length===0?ye(this,0,G):ue.apply(this,arguments)},D.prototype.toLocaleString=D.prototype.toString,D.prototype.equals=function(G){if(!D.isBuffer(G))throw new TypeError("Argument must be a Buffer");return this===G?!0:D.compare(this,G)===0},D.prototype.inspect=function(){let G="";const J=w.INSPECT_MAX_BYTES;return G=this.toString("hex",0,J).replace(/(.{2})/g,"$1 ").trim(),this.length>J&&(G+=" ... "),"<Buffer "+G+">"},C&&(D.prototype[C]=D.prototype.inspect),D.prototype.compare=function(G,J,xe,De,He){if(ve(G,R)&&(G=D.from(G,G.offset,G.byteLength)),!D.isBuffer(G))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof G);if(J===void 0&&(J=0),xe===void 0&&(xe=G?G.length:0),De===void 0&&(De=0),He===void 0&&(He=this.length),J<0||xe>G.length||De<0||He>this.length)throw new RangeError("out of range index");if(De>=He&&J>=xe)return 0;if(De>=He)return-1;if(J>=xe)return 1;if(J>>>=0,xe>>>=0,De>>>=0,He>>>=0,this===G)return 0;let xt=He-De,Qt=xe-J;const On=Math.min(xt,Qt),Zt=this.slice(De,He),nn=G.slice(J,xe);for(let un=0;un<On;++un)if(Zt[un]!==nn[un]){xt=Zt[un],Qt=nn[un];break}return xt<Qt?-1:Qt<xt?1:0};function Fe(Y,G,J,xe,De){if(Y.length===0)return-1;if(typeof J=="string"?(xe=J,J=0):J>2147483647?J=2147483647:J<-2147483648&&(J=-2147483648),J=+J,_e(J)&&(J=De?0:Y.length-1),J<0&&(J=Y.length+J),J>=Y.length){if(De)return-1;J=Y.length-1}else if(J<0)if(De)J=0;else return-1;if(typeof G=="string"&&(G=D.from(G,xe)),D.isBuffer(G))return G.length===0?-1:Se(Y,G,J,xe,De);if(typeof G=="number")return G=G&255,typeof R.prototype.indexOf=="function"?De?R.prototype.indexOf.call(Y,G,J):R.prototype.lastIndexOf.call(Y,G,J):Se(Y,[G],J,xe,De);throw new TypeError("val must be string, number or Buffer")}function Se(Y,G,J,xe,De){let He=1,xt=Y.length,Qt=G.length;if(xe!==void 0&&(xe=String(xe).toLowerCase(),xe==="ucs2"||xe==="ucs-2"||xe==="utf16le"||xe==="utf-16le")){if(Y.length<2||G.length<2)return-1;He=2,xt/=2,Qt/=2,J/=2}function On(nn,un){return He===1?nn[un]:nn.readUInt16BE(un*He)}let Zt;if(De){let nn=-1;for(Zt=J;Zt<xt;Zt++)if(On(Y,Zt)===On(G,nn===-1?0:Zt-nn)){if(nn===-1&&(nn=Zt),Zt-nn+1===Qt)return nn*He}else nn!==-1&&(Zt-=Zt-nn),nn=-1}else for(J+Qt>xt&&(J=xt-Qt),Zt=J;Zt>=0;Zt--){let nn=!0;for(let un=0;un<Qt;un++)if(On(Y,Zt+un)!==On(G,un)){nn=!1;break}if(nn)return Zt}return-1}D.prototype.includes=function(G,J,xe){return this.indexOf(G,J,xe)!==-1},D.prototype.indexOf=function(G,J,xe){return Fe(this,G,J,xe,!0)},D.prototype.lastIndexOf=function(G,J,xe){return Fe(this,G,J,xe,!1)};function Ce(Y,G,J,xe){J=Number(J)||0;const De=Y.length-J;xe?(xe=Number(xe),xe>De&&(xe=De)):xe=De;const He=G.length;xe>He/2&&(xe=He/2);let xt;for(xt=0;xt<xe;++xt){const Qt=parseInt(G.substr(xt*2,2),16);if(_e(Qt))return xt;Y[J+xt]=Qt}return xt}function qe(Y,G,J,xe){return tt(dt(G,Y.length-J),Y,J,xe)}function Qe(Y,G,J,xe){return tt(et(G),Y,J,xe)}function We(Y,G,J,xe){return tt(Ue(G),Y,J,xe)}function Ie(Y,G,J,xe){return tt($(G,Y.length-J),Y,J,xe)}D.prototype.write=function(G,J,xe,De){if(J===void 0)De="utf8",xe=this.length,J=0;else if(xe===void 0&&typeof J=="string")De=J,xe=this.length,J=0;else if(isFinite(J))J=J>>>0,isFinite(xe)?(xe=xe>>>0,De===void 0&&(De="utf8")):(De=xe,xe=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const He=this.length-J;if((xe===void 0||xe>He)&&(xe=He),G.length>0&&(xe<0||J<0)||J>this.length)throw new RangeError("Attempt to write outside buffer bounds");De||(De="utf8");let xt=!1;for(;;)switch(De){case"hex":return Ce(this,G,J,xe);case"utf8":case"utf-8":return qe(this,G,J,xe);case"ascii":case"latin1":case"binary":return Qe(this,G,J,xe);case"base64":return We(this,G,J,xe);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Ie(this,G,J,xe);default:if(xt)throw new TypeError("Unknown encoding: "+De);De=(""+De).toLowerCase(),xt=!0}},D.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function K(Y,G,J){return G===0&&J===Y.length?S.fromByteArray(Y):S.fromByteArray(Y.slice(G,J))}function ye(Y,G,J){J=Math.min(Y.length,J);const xe=[];let De=G;for(;De<J;){const He=Y[De];let xt=null,Qt=He>239?4:He>223?3:He>191?2:1;if(De+Qt<=J){let On,Zt,nn,un;switch(Qt){case 1:He<128&&(xt=He);break;case 2:On=Y[De+1],(On&192)===128&&(un=(He&31)<<6|On&63,un>127&&(xt=un));break;case 3:On=Y[De+1],Zt=Y[De+2],(On&192)===128&&(Zt&192)===128&&(un=(He&15)<<12|(On&63)<<6|Zt&63,un>2047&&(un<55296||un>57343)&&(xt=un));break;case 4:On=Y[De+1],Zt=Y[De+2],nn=Y[De+3],(On&192)===128&&(Zt&192)===128&&(nn&192)===128&&(un=(He&15)<<18|(On&63)<<12|(Zt&63)<<6|nn&63,un>65535&&un<1114112&&(xt=un))}}xt===null?(xt=65533,Qt=1):xt>65535&&(xt-=65536,xe.push(xt>>>10&1023|55296),xt=56320|xt&1023),xe.push(xt),De+=Qt}return ce(xe)}const Ne=4096;function ce(Y){const G=Y.length;if(G<=Ne)return String.fromCharCode.apply(String,Y);let J="",xe=0;for(;xe<G;)J+=String.fromCharCode.apply(String,Y.slice(xe,xe+=Ne));return J}function oe(Y,G,J){let xe="";J=Math.min(Y.length,J);for(let De=G;De<J;++De)xe+=String.fromCharCode(Y[De]&127);return xe}function re(Y,G,J){let xe="";J=Math.min(Y.length,J);for(let De=G;De<J;++De)xe+=String.fromCharCode(Y[De]);return xe}function Re(Y,G,J){const xe=Y.length;(!G||G<0)&&(G=0),(!J||J<0||J>xe)&&(J=xe);let De="";for(let He=G;He<J;++He)De+=$e[Y[He]];return De}function Be(Y,G,J){const xe=Y.slice(G,J);let De="";for(let He=0;He<xe.length-1;He+=2)De+=String.fromCharCode(xe[He]+xe[He+1]*256);return De}D.prototype.slice=function(G,J){const xe=this.length;G=~~G,J=J===void 0?xe:~~J,G<0?(G+=xe,G<0&&(G=0)):G>xe&&(G=xe),J<0?(J+=xe,J<0&&(J=0)):J>xe&&(J=xe),J<G&&(J=G);const De=this.subarray(G,J);return Object.setPrototypeOf(De,D.prototype),De};function Te(Y,G,J){if(Y%1!==0||Y<0)throw new RangeError("offset is not uint");if(Y+G>J)throw new RangeError("Trying to access beyond buffer length")}D.prototype.readUintLE=D.prototype.readUIntLE=function(G,J,xe){G=G>>>0,J=J>>>0,xe||Te(G,J,this.length);let De=this[G],He=1,xt=0;for(;++xt<J&&(He*=256);)De+=this[G+xt]*He;return De},D.prototype.readUintBE=D.prototype.readUIntBE=function(G,J,xe){G=G>>>0,J=J>>>0,xe||Te(G,J,this.length);let De=this[G+--J],He=1;for(;J>0&&(He*=256);)De+=this[G+--J]*He;return De},D.prototype.readUint8=D.prototype.readUInt8=function(G,J){return G=G>>>0,J||Te(G,1,this.length),this[G]},D.prototype.readUint16LE=D.prototype.readUInt16LE=function(G,J){return G=G>>>0,J||Te(G,2,this.length),this[G]|this[G+1]<<8},D.prototype.readUint16BE=D.prototype.readUInt16BE=function(G,J){return G=G>>>0,J||Te(G,2,this.length),this[G]<<8|this[G+1]},D.prototype.readUint32LE=D.prototype.readUInt32LE=function(G,J){return G=G>>>0,J||Te(G,4,this.length),(this[G]|this[G+1]<<8|this[G+2]<<16)+this[G+3]*16777216},D.prototype.readUint32BE=D.prototype.readUInt32BE=function(G,J){return G=G>>>0,J||Te(G,4,this.length),this[G]*16777216+(this[G+1]<<16|this[G+2]<<8|this[G+3])},D.prototype.readBigUInt64LE=Ct(function(G){G=G>>>0,ke(G,"offset");const J=this[G],xe=this[G+7];(J===void 0||xe===void 0)&&ge(G,this.length-8);const De=J+this[++G]*2**8+this[++G]*2**16+this[++G]*2**24,He=this[++G]+this[++G]*2**8+this[++G]*2**16+xe*2**24;return BigInt(De)+(BigInt(He)<<BigInt(32))}),D.prototype.readBigUInt64BE=Ct(function(G){G=G>>>0,ke(G,"offset");const J=this[G],xe=this[G+7];(J===void 0||xe===void 0)&&ge(G,this.length-8);const De=J*2**24+this[++G]*2**16+this[++G]*2**8+this[++G],He=this[++G]*2**24+this[++G]*2**16+this[++G]*2**8+xe;return(BigInt(De)<<BigInt(32))+BigInt(He)}),D.prototype.readIntLE=function(G,J,xe){G=G>>>0,J=J>>>0,xe||Te(G,J,this.length);let De=this[G],He=1,xt=0;for(;++xt<J&&(He*=256);)De+=this[G+xt]*He;return He*=128,De>=He&&(De-=Math.pow(2,8*J)),De},D.prototype.readIntBE=function(G,J,xe){G=G>>>0,J=J>>>0,xe||Te(G,J,this.length);let De=J,He=1,xt=this[G+--De];for(;De>0&&(He*=256);)xt+=this[G+--De]*He;return He*=128,xt>=He&&(xt-=Math.pow(2,8*J)),xt},D.prototype.readInt8=function(G,J){return G=G>>>0,J||Te(G,1,this.length),this[G]&128?(255-this[G]+1)*-1:this[G]},D.prototype.readInt16LE=function(G,J){G=G>>>0,J||Te(G,2,this.length);const xe=this[G]|this[G+1]<<8;return xe&32768?xe|4294901760:xe},D.prototype.readInt16BE=function(G,J){G=G>>>0,J||Te(G,2,this.length);const xe=this[G+1]|this[G]<<8;return xe&32768?xe|4294901760:xe},D.prototype.readInt32LE=function(G,J){return G=G>>>0,J||Te(G,4,this.length),this[G]|this[G+1]<<8|this[G+2]<<16|this[G+3]<<24},D.prototype.readInt32BE=function(G,J){return G=G>>>0,J||Te(G,4,this.length),this[G]<<24|this[G+1]<<16|this[G+2]<<8|this[G+3]},D.prototype.readBigInt64LE=Ct(function(G){G=G>>>0,ke(G,"offset");const J=this[G],xe=this[G+7];(J===void 0||xe===void 0)&&ge(G,this.length-8);const De=this[G+4]+this[G+5]*2**8+this[G+6]*2**16+(xe<<24);return(BigInt(De)<<BigInt(32))+BigInt(J+this[++G]*2**8+this[++G]*2**16+this[++G]*2**24)}),D.prototype.readBigInt64BE=Ct(function(G){G=G>>>0,ke(G,"offset");const J=this[G],xe=this[G+7];(J===void 0||xe===void 0)&&ge(G,this.length-8);const De=(J<<24)+this[++G]*2**16+this[++G]*2**8+this[++G];return(BigInt(De)<<BigInt(32))+BigInt(this[++G]*2**24+this[++G]*2**16+this[++G]*2**8+xe)}),D.prototype.readFloatLE=function(G,J){return G=G>>>0,J||Te(G,4,this.length),k.read(this,G,!0,23,4)},D.prototype.readFloatBE=function(G,J){return G=G>>>0,J||Te(G,4,this.length),k.read(this,G,!1,23,4)},D.prototype.readDoubleLE=function(G,J){return G=G>>>0,J||Te(G,8,this.length),k.read(this,G,!0,52,8)},D.prototype.readDoubleBE=function(G,J){return G=G>>>0,J||Te(G,8,this.length),k.read(this,G,!1,52,8)};function lt(Y,G,J,xe,De,He){if(!D.isBuffer(Y))throw new TypeError('"buffer" argument must be a Buffer instance');if(G>De||G<He)throw new RangeError('"value" argument is out of bounds');if(J+xe>Y.length)throw new RangeError("Index out of range")}D.prototype.writeUintLE=D.prototype.writeUIntLE=function(G,J,xe,De){if(G=+G,J=J>>>0,xe=xe>>>0,!De){const Qt=Math.pow(2,8*xe)-1;lt(this,G,J,xe,Qt,0)}let He=1,xt=0;for(this[J]=G&255;++xt<xe&&(He*=256);)this[J+xt]=G/He&255;return J+xe},D.prototype.writeUintBE=D.prototype.writeUIntBE=function(G,J,xe,De){if(G=+G,J=J>>>0,xe=xe>>>0,!De){const Qt=Math.pow(2,8*xe)-1;lt(this,G,J,xe,Qt,0)}let He=xe-1,xt=1;for(this[J+He]=G&255;--He>=0&&(xt*=256);)this[J+He]=G/xt&255;return J+xe},D.prototype.writeUint8=D.prototype.writeUInt8=function(G,J,xe){return G=+G,J=J>>>0,xe||lt(this,G,J,1,255,0),this[J]=G&255,J+1},D.prototype.writeUint16LE=D.prototype.writeUInt16LE=function(G,J,xe){return G=+G,J=J>>>0,xe||lt(this,G,J,2,65535,0),this[J]=G&255,this[J+1]=G>>>8,J+2},D.prototype.writeUint16BE=D.prototype.writeUInt16BE=function(G,J,xe){return G=+G,J=J>>>0,xe||lt(this,G,J,2,65535,0),this[J]=G>>>8,this[J+1]=G&255,J+2},D.prototype.writeUint32LE=D.prototype.writeUInt32LE=function(G,J,xe){return G=+G,J=J>>>0,xe||lt(this,G,J,4,4294967295,0),this[J+3]=G>>>24,this[J+2]=G>>>16,this[J+1]=G>>>8,this[J]=G&255,J+4},D.prototype.writeUint32BE=D.prototype.writeUInt32BE=function(G,J,xe){return G=+G,J=J>>>0,xe||lt(this,G,J,4,4294967295,0),this[J]=G>>>24,this[J+1]=G>>>16,this[J+2]=G>>>8,this[J+3]=G&255,J+4};function Tt(Y,G,J,xe,De){be(G,xe,De,Y,J,7);let He=Number(G&BigInt(4294967295));Y[J++]=He,He=He>>8,Y[J++]=He,He=He>>8,Y[J++]=He,He=He>>8,Y[J++]=He;let xt=Number(G>>BigInt(32)&BigInt(4294967295));return Y[J++]=xt,xt=xt>>8,Y[J++]=xt,xt=xt>>8,Y[J++]=xt,xt=xt>>8,Y[J++]=xt,J}function ut(Y,G,J,xe,De){be(G,xe,De,Y,J,7);let He=Number(G&BigInt(4294967295));Y[J+7]=He,He=He>>8,Y[J+6]=He,He=He>>8,Y[J+5]=He,He=He>>8,Y[J+4]=He;let xt=Number(G>>BigInt(32)&BigInt(4294967295));return Y[J+3]=xt,xt=xt>>8,Y[J+2]=xt,xt=xt>>8,Y[J+1]=xt,xt=xt>>8,Y[J]=xt,J+8}D.prototype.writeBigUInt64LE=Ct(function(G,J=0){return Tt(this,G,J,BigInt(0),BigInt("0xffffffffffffffff"))}),D.prototype.writeBigUInt64BE=Ct(function(G,J=0){return ut(this,G,J,BigInt(0),BigInt("0xffffffffffffffff"))}),D.prototype.writeIntLE=function(G,J,xe,De){if(G=+G,J=J>>>0,!De){const On=Math.pow(2,8*xe-1);lt(this,G,J,xe,On-1,-On)}let He=0,xt=1,Qt=0;for(this[J]=G&255;++He<xe&&(xt*=256);)G<0&&Qt===0&&this[J+He-1]!==0&&(Qt=1),this[J+He]=(G/xt>>0)-Qt&255;return J+xe},D.prototype.writeIntBE=function(G,J,xe,De){if(G=+G,J=J>>>0,!De){const On=Math.pow(2,8*xe-1);lt(this,G,J,xe,On-1,-On)}let He=xe-1,xt=1,Qt=0;for(this[J+He]=G&255;--He>=0&&(xt*=256);)G<0&&Qt===0&&this[J+He+1]!==0&&(Qt=1),this[J+He]=(G/xt>>0)-Qt&255;return J+xe},D.prototype.writeInt8=function(G,J,xe){return G=+G,J=J>>>0,xe||lt(this,G,J,1,127,-128),G<0&&(G=255+G+1),this[J]=G&255,J+1},D.prototype.writeInt16LE=function(G,J,xe){return G=+G,J=J>>>0,xe||lt(this,G,J,2,32767,-32768),this[J]=G&255,this[J+1]=G>>>8,J+2},D.prototype.writeInt16BE=function(G,J,xe){return G=+G,J=J>>>0,xe||lt(this,G,J,2,32767,-32768),this[J]=G>>>8,this[J+1]=G&255,J+2},D.prototype.writeInt32LE=function(G,J,xe){return G=+G,J=J>>>0,xe||lt(this,G,J,4,2147483647,-2147483648),this[J]=G&255,this[J+1]=G>>>8,this[J+2]=G>>>16,this[J+3]=G>>>24,J+4},D.prototype.writeInt32BE=function(G,J,xe){return G=+G,J=J>>>0,xe||lt(this,G,J,4,2147483647,-2147483648),G<0&&(G=4294967295+G+1),this[J]=G>>>24,this[J+1]=G>>>16,this[J+2]=G>>>8,this[J+3]=G&255,J+4},D.prototype.writeBigInt64LE=Ct(function(G,J=0){return Tt(this,G,J,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),D.prototype.writeBigInt64BE=Ct(function(G,J=0){return ut(this,G,J,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function jt(Y,G,J,xe,De,He){if(J+xe>Y.length)throw new RangeError("Index out of range");if(J<0)throw new RangeError("Index out of range")}function qt(Y,G,J,xe,De){return G=+G,J=J>>>0,De||jt(Y,G,J,4),k.write(Y,G,J,xe,23,4),J+4}D.prototype.writeFloatLE=function(G,J,xe){return qt(this,G,J,!0,xe)},D.prototype.writeFloatBE=function(G,J,xe){return qt(this,G,J,!1,xe)};function Ft(Y,G,J,xe,De){return G=+G,J=J>>>0,De||jt(Y,G,J,8),k.write(Y,G,J,xe,52,8),J+8}D.prototype.writeDoubleLE=function(G,J,xe){return Ft(this,G,J,!0,xe)},D.prototype.writeDoubleBE=function(G,J,xe){return Ft(this,G,J,!1,xe)},D.prototype.copy=function(G,J,xe,De){if(!D.isBuffer(G))throw new TypeError("argument should be a Buffer");if(xe||(xe=0),!De&&De!==0&&(De=this.length),J>=G.length&&(J=G.length),J||(J=0),De>0&&De<xe&&(De=xe),De===xe||G.length===0||this.length===0)return 0;if(J<0)throw new RangeError("targetStart out of bounds");if(xe<0||xe>=this.length)throw new RangeError("Index out of range");if(De<0)throw new RangeError("sourceEnd out of bounds");De>this.length&&(De=this.length),G.length-J<De-xe&&(De=G.length-J+xe);const He=De-xe;return this===G&&typeof R.prototype.copyWithin=="function"?this.copyWithin(J,xe,De):R.prototype.set.call(G,this.subarray(xe,De),J),He},D.prototype.fill=function(G,J,xe,De){if(typeof G=="string"){if(typeof J=="string"?(De=J,J=0,xe=this.length):typeof xe=="string"&&(De=xe,xe=this.length),De!==void 0&&typeof De!="string")throw new TypeError("encoding must be a string");if(typeof De=="string"&&!D.isEncoding(De))throw new TypeError("Unknown encoding: "+De);if(G.length===1){const xt=G.charCodeAt(0);(De==="utf8"&&xt<128||De==="latin1")&&(G=xt)}}else typeof G=="number"?G=G&255:typeof G=="boolean"&&(G=Number(G));if(J<0||this.length<J||this.length<xe)throw new RangeError("Out of range index");if(xe<=J)return this;J=J>>>0,xe=xe===void 0?this.length:xe>>>0,G||(G=0);let He;if(typeof G=="number")for(He=J;He<xe;++He)this[He]=G;else{const xt=D.isBuffer(G)?G:D.from(G,De),Qt=xt.length;if(Qt===0)throw new TypeError('The value "'+G+'" is invalid for argument "value"');for(He=0;He<xe-J;++He)this[He+J]=xt[He%Qt]}return this};const Ht={};function we(Y,G,J){Ht[Y]=class extends J{constructor(){super(),Object.defineProperty(this,"message",{value:G.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${Y}]`,this.stack,delete this.name}get code(){return Y}set code(De){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:De,writable:!0})}toString(){return`${this.name} [${Y}]: ${this.message}`}}}we("ERR_BUFFER_OUT_OF_BOUNDS",function(Y){return Y?`${Y} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),we("ERR_INVALID_ARG_TYPE",function(Y,G){return`The "${Y}" argument must be of type number. Received type ${typeof G}`},TypeError),we("ERR_OUT_OF_RANGE",function(Y,G,J){let xe=`The value of "${Y}" is out of range.`,De=J;return Number.isInteger(J)&&Math.abs(J)>2**32?De=F(String(J)):typeof J=="bigint"&&(De=String(J),(J>BigInt(2)**BigInt(32)||J<-(BigInt(2)**BigInt(32)))&&(De=F(De)),De+="n"),xe+=` It must be ${G}. Received ${De}`,xe},RangeError);function F(Y){let G="",J=Y.length;const xe=Y[0]==="-"?1:0;for(;J>=xe+4;J-=3)G=`_${Y.slice(J-3,J)}${G}`;return`${Y.slice(0,J)}${G}`}function X(Y,G,J){ke(G,"offset"),(Y[G]===void 0||Y[G+J]===void 0)&&ge(G,Y.length-(J+1))}function be(Y,G,J,xe,De,He){if(Y>J||Y<G){const xt=typeof G=="bigint"?"n":"";let Qt;throw G===0||G===BigInt(0)?Qt=`>= 0${xt} and < 2${xt} ** ${(He+1)*8}${xt}`:Qt=`>= -(2${xt} ** ${(He+1)*8-1}${xt}) and < 2 ** ${(He+1)*8-1}${xt}`,new Ht.ERR_OUT_OF_RANGE("value",Qt,Y)}X(xe,De,He)}function ke(Y,G){if(typeof Y!="number")throw new Ht.ERR_INVALID_ARG_TYPE(G,"number",Y)}function ge(Y,G,J){throw Math.floor(Y)!==Y?(ke(Y,J),new Ht.ERR_OUT_OF_RANGE("offset","an integer",Y)):G<0?new Ht.ERR_BUFFER_OUT_OF_BOUNDS:new Ht.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${G}`,Y)}const Ee=/[^+/0-9A-Za-z-_]/g;function le(Y){if(Y=Y.split("=")[0],Y=Y.trim().replace(Ee,""),Y.length<2)return"";for(;Y.length%4!==0;)Y=Y+"=";return Y}function dt(Y,G){G=G||1/0;let J;const xe=Y.length;let De=null;const He=[];for(let xt=0;xt<xe;++xt){if(J=Y.charCodeAt(xt),J>55295&&J<57344){if(!De){if(J>56319){(G-=3)>-1&&He.push(239,191,189);continue}else if(xt+1===xe){(G-=3)>-1&&He.push(239,191,189);continue}De=J;continue}if(J<56320){(G-=3)>-1&&He.push(239,191,189),De=J;continue}J=(De-55296<<10|J-56320)+65536}else De&&(G-=3)>-1&&He.push(239,191,189);if(De=null,J<128){if((G-=1)<0)break;He.push(J)}else if(J<2048){if((G-=2)<0)break;He.push(J>>6|192,J&63|128)}else if(J<65536){if((G-=3)<0)break;He.push(J>>12|224,J>>6&63|128,J&63|128)}else if(J<1114112){if((G-=4)<0)break;He.push(J>>18|240,J>>12&63|128,J>>6&63|128,J&63|128)}else throw new Error("Invalid code point")}return He}function et(Y){const G=[];for(let J=0;J<Y.length;++J)G.push(Y.charCodeAt(J)&255);return G}function $(Y,G){let J,xe,De;const He=[];for(let xt=0;xt<Y.length&&!((G-=2)<0);++xt)J=Y.charCodeAt(xt),xe=J>>8,De=J%256,He.push(De),He.push(xe);return He}function Ue(Y){return S.toByteArray(le(Y))}function tt(Y,G,J,xe){let De;for(De=0;De<xe&&!(De+J>=G.length||De>=Y.length);++De)G[De+J]=Y[De];return De}function ve(Y,G){return Y instanceof G||Y!=null&&Y.constructor!=null&&Y.constructor.name!=null&&Y.constructor.name===G.name}function _e(Y){return Y!==Y}const $e=function(){const Y="0123456789abcdef",G=new Array(256);for(let J=0;J<16;++J){const xe=J*16;for(let De=0;De<16;++De)G[xe+De]=Y[J]+Y[De]}return G}();function Ct(Y){return typeof BigInt>"u"?fe:Y}function fe(){throw new Error("BigInt not supported")}})(t);const x=t.Buffer;e.Blob=t.Blob,e.BlobOptions=t.BlobOptions,e.Buffer=t.Buffer,e.File=t.File,e.FileOptions=t.FileOptions,e.INSPECT_MAX_BYTES=t.INSPECT_MAX_BYTES,e.SlowBuffer=t.SlowBuffer,e.TranscodeEncoding=t.TranscodeEncoding,e.atob=t.atob,e.btoa=t.btoa,e.constants=t.constants,e.default=x,e.isAscii=t.isAscii,e.isUtf8=t.isUtf8,e.kMaxLength=t.kMaxLength,e.kStringMaxLength=t.kStringMaxLength,e.resolveObjectURL=t.resolveObjectURL,e.transcode=t.transcode}(lM)),lM}var cM,J$;function ni(){if(J$)return cM;J$=1;class e extends Error{constructor(n){if(!Array.isArray(n))throw new TypeError(`Expected input to be an Array, got ${typeof n}`);let r="";for(let s=0;s<n.length;s++)r+=`    ${n[s].stack}
`;super(r),this.name="AggregateError",this.errors=n}}return cM={AggregateError:e,ArrayIsArray(t){return Array.isArray(t)},ArrayPrototypeIncludes(t,n){return t.includes(n)},ArrayPrototypeIndexOf(t,n){return t.indexOf(n)},ArrayPrototypeJoin(t,n){return t.join(n)},ArrayPrototypeMap(t,n){return t.map(n)},ArrayPrototypePop(t,n){return t.pop(n)},ArrayPrototypePush(t,n){return t.push(n)},ArrayPrototypeSlice(t,n,r){return t.slice(n,r)},Error,FunctionPrototypeCall(t,n,...r){return t.call(n,...r)},FunctionPrototypeSymbolHasInstance(t,n){return Function.prototype[Symbol.hasInstance].call(t,n)},MathFloor:Math.floor,Number,NumberIsInteger:Number.isInteger,NumberIsNaN:Number.isNaN,NumberMAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER,NumberMIN_SAFE_INTEGER:Number.MIN_SAFE_INTEGER,NumberParseInt:Number.parseInt,ObjectDefineProperties(t,n){return Object.defineProperties(t,n)},ObjectDefineProperty(t,n,r){return Object.defineProperty(t,n,r)},ObjectGetOwnPropertyDescriptor(t,n){return Object.getOwnPropertyDescriptor(t,n)},ObjectKeys(t){return Object.keys(t)},ObjectSetPrototypeOf(t,n){return Object.setPrototypeOf(t,n)},Promise,PromisePrototypeCatch(t,n){return t.catch(n)},PromisePrototypeThen(t,n,r){return t.then(n,r)},PromiseReject(t){return Promise.reject(t)},PromiseResolve(t){return Promise.resolve(t)},ReflectApply:Reflect.apply,RegExpPrototypeTest(t,n){return t.test(n)},SafeSet:Set,String,StringPrototypeSlice(t,n,r){return t.slice(n,r)},StringPrototypeToLowerCase(t){return t.toLowerCase()},StringPrototypeToUpperCase(t){return t.toUpperCase()},StringPrototypeTrim(t){return t.trim()},Symbol,SymbolFor:Symbol.for,SymbolAsyncIterator:Symbol.asyncIterator,SymbolHasInstance:Symbol.hasInstance,SymbolIterator:Symbol.iterator,SymbolDispose:Symbol.dispose||Symbol("Symbol.dispose"),SymbolAsyncDispose:Symbol.asyncDispose||Symbol("Symbol.asyncDispose"),TypedArrayPrototypeSet(t,n,r){return t.set(n,r)},Boolean,Uint8Array},cM}var uM={exports:{}},dM,Q$;function rY(){return Q$||(Q$=1,dM={format(e,...t){return e.replace(/%([sdifj])/g,function(...[n,r]){const s=t.shift();return r==="f"?s.toFixed(6):r==="j"?JSON.stringify(s):r==="s"&&typeof s=="object"?`${s.constructor!==Object?s.constructor.name:""} {}`.trim():s.toString()})},inspect(e){switch(typeof e){case"string":if(e.includes("'"))if(e.includes('"')){if(!e.includes("`")&&!e.includes("${"))return`\`${e}\``}else return`"${e}"`;return`'${e}'`;case"number":return isNaN(e)?"NaN":Object.is(e,-0)?String(e):e;case"bigint":return`${String(e)}n`;case"boolean":case"undefined":return String(e);case"object":return"{}"}}}),dM}var fM,e9;function fo(){if(e9)return fM;e9=1;const{format:e,inspect:t}=rY(),{AggregateError:n}=ni(),r=globalThis.AggregateError||n,s=Symbol("kIsNodeError"),i=["string","function","number","object","Function","Object","boolean","bigint","symbol"],a=/^([A-Z][a-z0-9]*)+$/,o="__node_internal_",l={};function c(v,x){if(!v)throw new l.ERR_INTERNAL_ASSERTION(x)}function u(v){let x="",w=v.length;const S=v[0]==="-"?1:0;for(;w>=S+4;w-=3)x=`_${v.slice(w-3,w)}${x}`;return`${v.slice(0,w)}${x}`}function d(v,x,w){if(typeof x=="function")return c(x.length<=w.length,`Code: ${v}; The provided arguments length (${w.length}) does not match the required ones (${x.length}).`),x(...w);const S=(x.match(/%[dfijoOs]/g)||[]).length;return c(S===w.length,`Code: ${v}; The provided arguments length (${w.length}) does not match the required ones (${S}).`),w.length===0?x:e(x,...w)}function h(v,x,w){w||(w=Error);class S extends w{constructor(...C){super(d(v,x,C))}toString(){return`${this.name} [${v}]: ${this.message}`}}Object.defineProperties(S.prototype,{name:{value:w.name,writable:!0,enumerable:!1,configurable:!0},toString:{value(){return`${this.name} [${v}]: ${this.message}`},writable:!0,enumerable:!1,configurable:!0}}),S.prototype.code=v,S.prototype[s]=!0,l[v]=S}function m(v){const x=o+v.name;return Object.defineProperty(v,"name",{value:x}),v}function y(v,x){if(v&&x&&v!==x){if(Array.isArray(x.errors))return x.errors.push(v),x;const w=new r([x,v],x.message);return w.code=x.code,w}return v||x}class b extends Error{constructor(x="The operation was aborted",w=void 0){if(w!==void 0&&typeof w!="object")throw new l.ERR_INVALID_ARG_TYPE("options","Object",w);super(x,w),this.code="ABORT_ERR",this.name="AbortError"}}return h("ERR_ASSERTION","%s",Error),h("ERR_INVALID_ARG_TYPE",(v,x,w)=>{c(typeof v=="string","'name' must be a string"),Array.isArray(x)||(x=[x]);let S="The ";v.endsWith(" argument")?S+=`${v} `:S+=`"${v}" ${v.includes(".")?"property":"argument"} `,S+="must be ";const k=[],C=[],T=[];for(const N of x)c(typeof N=="string","All expected entries have to be of type string"),i.includes(N)?k.push(N.toLowerCase()):a.test(N)?C.push(N):(c(N!=="object",'The value "object" should be written as "Object"'),T.push(N));if(C.length>0){const N=k.indexOf("object");N!==-1&&(k.splice(k,N,1),C.push("Object"))}if(k.length>0){switch(k.length){case 1:S+=`of type ${k[0]}`;break;case 2:S+=`one of type ${k[0]} or ${k[1]}`;break;default:{const N=k.pop();S+=`one of type ${k.join(", ")}, or ${N}`}}(C.length>0||T.length>0)&&(S+=" or ")}if(C.length>0){switch(C.length){case 1:S+=`an instance of ${C[0]}`;break;case 2:S+=`an instance of ${C[0]} or ${C[1]}`;break;default:{const N=C.pop();S+=`an instance of ${C.join(", ")}, or ${N}`}}T.length>0&&(S+=" or ")}switch(T.length){case 0:break;case 1:T[0].toLowerCase()!==T[0]&&(S+="an "),S+=`${T[0]}`;break;case 2:S+=`one of ${T[0]} or ${T[1]}`;break;default:{const N=T.pop();S+=`one of ${T.join(", ")}, or ${N}`}}if(w==null)S+=`. Received ${w}`;else if(typeof w=="function"&&w.name)S+=`. Received function ${w.name}`;else if(typeof w=="object"){var R;if((R=w.constructor)!==null&&R!==void 0&&R.name)S+=`. Received an instance of ${w.constructor.name}`;else{const N=t(w,{depth:-1});S+=`. Received ${N}`}}else{let N=t(w,{colors:!1});N.length>25&&(N=`${N.slice(0,25)}...`),S+=`. Received type ${typeof w} (${N})`}return S},TypeError),h("ERR_INVALID_ARG_VALUE",(v,x,w="is invalid")=>{let S=t(x);return S.length>128&&(S=S.slice(0,128)+"..."),`The ${v.includes(".")?"property":"argument"} '${v}' ${w}. Received ${S}`},TypeError),h("ERR_INVALID_RETURN_VALUE",(v,x,w)=>{var S;const k=w!=null&&(S=w.constructor)!==null&&S!==void 0&&S.name?`instance of ${w.constructor.name}`:`type ${typeof w}`;return`Expected ${v} to be returned from the "${x}" function but got ${k}.`},TypeError),h("ERR_MISSING_ARGS",(...v)=>{c(v.length>0,"At least one arg needs to be specified");let x;const w=v.length;switch(v=(Array.isArray(v)?v:[v]).map(S=>`"${S}"`).join(" or "),w){case 1:x+=`The ${v[0]} argument`;break;case 2:x+=`The ${v[0]} and ${v[1]} arguments`;break;default:{const S=v.pop();x+=`The ${v.join(", ")}, and ${S} arguments`}break}return`${x} must be specified`},TypeError),h("ERR_OUT_OF_RANGE",(v,x,w)=>{c(x,'Missing "range" argument');let S;if(Number.isInteger(w)&&Math.abs(w)>2**32)S=u(String(w));else if(typeof w=="bigint"){S=String(w);const k=BigInt(2)**BigInt(32);(w>k||w<-k)&&(S=u(S)),S+="n"}else S=t(w);return`The value of "${v}" is out of range. It must be ${x}. Received ${S}`},RangeError),h("ERR_MULTIPLE_CALLBACK","Callback called multiple times",Error),h("ERR_METHOD_NOT_IMPLEMENTED","The %s method is not implemented",Error),h("ERR_STREAM_ALREADY_FINISHED","Cannot call %s after a stream was finished",Error),h("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable",Error),h("ERR_STREAM_DESTROYED","Cannot call %s after a stream was destroyed",Error),h("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),h("ERR_STREAM_PREMATURE_CLOSE","Premature close",Error),h("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF",Error),h("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event",Error),h("ERR_STREAM_WRITE_AFTER_END","write after end",Error),h("ERR_UNKNOWN_ENCODING","Unknown encoding: %s",TypeError),fM={AbortError:b,aggregateTwoErrors:m(y),hideStackFrames:m,codes:l},fM}var Dv={exports:{}},t9;function hw(){if(t9)return Dv.exports;t9=1;const{AbortController:e,AbortSignal:t}=typeof self<"u"?self:typeof window<"u"?window:void 0;return Dv.exports=e,Dv.exports.AbortSignal=t,Dv.exports.default=e,Dv.exports}var DS={exports:{}},n9;function HE(){if(n9)return DS.exports;n9=1;var e=typeof Reflect=="object"?Reflect:null,t=e&&typeof e.apply=="function"?e.apply:function(C,T,R){return Function.prototype.apply.call(C,T,R)},n;e&&typeof e.ownKeys=="function"?n=e.ownKeys:Object.getOwnPropertySymbols?n=function(C){return Object.getOwnPropertyNames(C).concat(Object.getOwnPropertySymbols(C))}:n=function(C){return Object.getOwnPropertyNames(C)};function r(k){console&&console.warn&&console.warn(k)}var s=Number.isNaN||function(C){return C!==C};function i(){i.init.call(this)}DS.exports=i,DS.exports.once=x,i.EventEmitter=i,i.prototype._events=void 0,i.prototype._eventsCount=0,i.prototype._maxListeners=void 0;var a=10;function o(k){if(typeof k!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof k)}Object.defineProperty(i,"defaultMaxListeners",{enumerable:!0,get:function(){return a},set:function(k){if(typeof k!="number"||k<0||s(k))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+k+".");a=k}}),i.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},i.prototype.setMaxListeners=function(C){if(typeof C!="number"||C<0||s(C))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+C+".");return this._maxListeners=C,this};function l(k){return k._maxListeners===void 0?i.defaultMaxListeners:k._maxListeners}i.prototype.getMaxListeners=function(){return l(this)},i.prototype.emit=function(C){for(var T=[],R=1;R<arguments.length;R++)T.push(arguments[R]);var N=C==="error",I=this._events;if(I!==void 0)N=N&&I.error===void 0;else if(!N)return!1;if(N){var P;if(T.length>0&&(P=T[0]),P instanceof Error)throw P;var B=new Error("Unhandled error."+(P?" ("+P.message+")":""));throw B.context=P,B}var D=I[C];if(D===void 0)return!1;if(typeof D=="function")t(D,this,T);else for(var W=D.length,O=y(D,W),R=0;R<W;++R)t(O[R],this,T);return!0};function c(k,C,T,R){var N,I,P;if(o(T),I=k._events,I===void 0?(I=k._events=Object.create(null),k._eventsCount=0):(I.newListener!==void 0&&(k.emit("newListener",C,T.listener?T.listener:T),I=k._events),P=I[C]),P===void 0)P=I[C]=T,++k._eventsCount;else if(typeof P=="function"?P=I[C]=R?[T,P]:[P,T]:R?P.unshift(T):P.push(T),N=l(k),N>0&&P.length>N&&!P.warned){P.warned=!0;var B=new Error("Possible EventEmitter memory leak detected. "+P.length+" "+String(C)+" listeners added. Use emitter.setMaxListeners() to increase limit");B.name="MaxListenersExceededWarning",B.emitter=k,B.type=C,B.count=P.length,r(B)}return k}i.prototype.addListener=function(C,T){return c(this,C,T,!1)},i.prototype.on=i.prototype.addListener,i.prototype.prependListener=function(C,T){return c(this,C,T,!0)};function u(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function d(k,C,T){var R={fired:!1,wrapFn:void 0,target:k,type:C,listener:T},N=u.bind(R);return N.listener=T,R.wrapFn=N,N}i.prototype.once=function(C,T){return o(T),this.on(C,d(this,C,T)),this},i.prototype.prependOnceListener=function(C,T){return o(T),this.prependListener(C,d(this,C,T)),this},i.prototype.removeListener=function(C,T){var R,N,I,P,B;if(o(T),N=this._events,N===void 0)return this;if(R=N[C],R===void 0)return this;if(R===T||R.listener===T)--this._eventsCount===0?this._events=Object.create(null):(delete N[C],N.removeListener&&this.emit("removeListener",C,R.listener||T));else if(typeof R!="function"){for(I=-1,P=R.length-1;P>=0;P--)if(R[P]===T||R[P].listener===T){B=R[P].listener,I=P;break}if(I<0)return this;I===0?R.shift():b(R,I),R.length===1&&(N[C]=R[0]),N.removeListener!==void 0&&this.emit("removeListener",C,B||T)}return this},i.prototype.off=i.prototype.removeListener,i.prototype.removeAllListeners=function(C){var T,R,N;if(R=this._events,R===void 0)return this;if(R.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):R[C]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete R[C]),this;if(arguments.length===0){var I=Object.keys(R),P;for(N=0;N<I.length;++N)P=I[N],P!=="removeListener"&&this.removeAllListeners(P);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(T=R[C],typeof T=="function")this.removeListener(C,T);else if(T!==void 0)for(N=T.length-1;N>=0;N--)this.removeListener(C,T[N]);return this};function h(k,C,T){var R=k._events;if(R===void 0)return[];var N=R[C];return N===void 0?[]:typeof N=="function"?T?[N.listener||N]:[N]:T?v(N):y(N,N.length)}i.prototype.listeners=function(C){return h(this,C,!0)},i.prototype.rawListeners=function(C){return h(this,C,!1)},i.listenerCount=function(k,C){return typeof k.listenerCount=="function"?k.listenerCount(C):m.call(k,C)},i.prototype.listenerCount=m;function m(k){var C=this._events;if(C!==void 0){var T=C[k];if(typeof T=="function")return 1;if(T!==void 0)return T.length}return 0}i.prototype.eventNames=function(){return this._eventsCount>0?n(this._events):[]};function y(k,C){for(var T=new Array(C),R=0;R<C;++R)T[R]=k[R];return T}function b(k,C){for(;C+1<k.length;C++)k[C]=k[C+1];k.pop()}function v(k){for(var C=new Array(k.length),T=0;T<C.length;++T)C[T]=k[T].listener||k[T];return C}function x(k,C){return new Promise(function(T,R){function N(P){k.removeListener(C,I),R(P)}function I(){typeof k.removeListener=="function"&&k.removeListener("error",N),T([].slice.call(arguments))}S(k,C,I,{once:!0}),C!=="error"&&w(k,N,{once:!0})})}function w(k,C,T){typeof k.on=="function"&&S(k,"error",C,T)}function S(k,C,T,R){if(typeof k.on=="function")R.once?k.once(C,T):k.on(C,T);else if(typeof k.addEventListener=="function")k.addEventListener(C,function N(I){R.once&&k.removeEventListener(C,N),T(I)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof k)}return DS.exports}var r9;function Io(){return r9||(r9=1,function(e){const t=Wh(),{format:n,inspect:r}=rY(),{codes:{ERR_INVALID_ARG_TYPE:s}}=fo(),{kResistStopPropagation:i,AggregateError:a,SymbolDispose:o}=ni(),l=globalThis.AbortSignal||hw().AbortSignal,c=globalThis.AbortController||hw().AbortController,u=Object.getPrototypeOf(async function(){}).constructor,d=globalThis.Blob||t.Blob,h=typeof d<"u"?function(v){return v instanceof d}:function(v){return!1},m=(b,v)=>{if(b!==void 0&&(b===null||typeof b!="object"||!("aborted"in b)))throw new s(v,"AbortSignal",b)},y=(b,v)=>{if(typeof b!="function")throw new s(v,"Function",b)};e.exports={AggregateError:a,kEmptyObject:Object.freeze({}),once(b){let v=!1;return function(...x){v||(v=!0,b.apply(this,x))}},createDeferredPromise:function(){let b,v;return{promise:new Promise((w,S)=>{b=w,v=S}),resolve:b,reject:v}},promisify(b){return new Promise((v,x)=>{b((w,...S)=>w?x(w):v(...S))})},debuglog(){return function(){}},format:n,inspect:r,types:{isAsyncFunction(b){return b instanceof u},isArrayBufferView(b){return ArrayBuffer.isView(b)}},isBlob:h,deprecate(b,v){return b},addAbortListener:HE().addAbortListener||function(v,x){if(v===void 0)throw new s("signal","AbortSignal",v);m(v,"signal"),y(x,"listener");let w;return v.aborted?queueMicrotask(()=>x()):(v.addEventListener("abort",x,{__proto__:null,once:!0,[i]:!0}),w=()=>{v.removeEventListener("abort",x)}),{__proto__:null,[o](){var S;(S=w)===null||S===void 0||S()}}},AbortSignalAny:l.any||function(v){if(v.length===1)return v[0];const x=new c,w=()=>x.abort();return v.forEach(S=>{m(S,"signals"),S.addEventListener("abort",w,{once:!0})}),x.signal.addEventListener("abort",()=>{v.forEach(S=>S.removeEventListener("abort",w))},{once:!0}),x.signal}},e.exports.promisify.custom=Symbol.for("nodejs.util.promisify.custom")}(uM)),uM.exports}var FS={},hM,s9;function C1(){if(s9)return hM;s9=1;const{ArrayIsArray:e,ArrayPrototypeIncludes:t,ArrayPrototypeJoin:n,ArrayPrototypeMap:r,NumberIsInteger:s,NumberIsNaN:i,NumberMAX_SAFE_INTEGER:a,NumberMIN_SAFE_INTEGER:o,NumberParseInt:l,ObjectPrototypeHasOwnProperty:c,RegExpPrototypeExec:u,String:d,StringPrototypeToUpperCase:h,StringPrototypeTrim:m}=ni(),{hideStackFrames:y,codes:{ERR_SOCKET_BAD_PORT:b,ERR_INVALID_ARG_TYPE:v,ERR_INVALID_ARG_VALUE:x,ERR_OUT_OF_RANGE:w,ERR_UNKNOWN_SIGNAL:S}}=fo(),{normalizeEncoding:k}=Io(),{isAsyncFunction:C,isArrayBufferView:T}=Io().types,R={};function N(re){return re===(re|0)}function I(re){return re===re>>>0}const P=/^[0-7]+$/,B="must be a 32-bit unsigned integer or an octal string";function D(re,Re,Be){if(typeof re>"u"&&(re=Be),typeof re=="string"){if(u(P,re)===null)throw new x(Re,re,B);re=l(re,8)}return Z(re,Re),re}const W=y((re,Re,Be=o,Te=a)=>{if(typeof re!="number")throw new v(Re,"number",re);if(!s(re))throw new w(Re,"an integer",re);if(re<Be||re>Te)throw new w(Re,`>= ${Be} && <= ${Te}`,re)}),O=y((re,Re,Be=-2147483648,Te=2147483647)=>{if(typeof re!="number")throw new v(Re,"number",re);if(!s(re))throw new w(Re,"an integer",re);if(re<Be||re>Te)throw new w(Re,`>= ${Be} && <= ${Te}`,re)}),Z=y((re,Re,Be=!1)=>{if(typeof re!="number")throw new v(Re,"number",re);if(!s(re))throw new w(Re,"an integer",re);const Te=Be?1:0,lt=4294967295;if(re<Te||re>lt)throw new w(Re,`>= ${Te} && <= ${lt}`,re)});function U(re,Re){if(typeof re!="string")throw new v(Re,"string",re)}function H(re,Re,Be=void 0,Te){if(typeof re!="number")throw new v(Re,"number",re);if(Be!=null&&re<Be||Te!=null&&re>Te||(Be!=null||Te!=null)&&i(re))throw new w(Re,`${Be!=null?`>= ${Be}`:""}${Be!=null&&Te!=null?" && ":""}${Te!=null?`<= ${Te}`:""}`,re)}const L=y((re,Re,Be)=>{if(!t(Be,re)){const lt="must be one of: "+n(r(Be,Tt=>typeof Tt=="string"?`'${Tt}'`:d(Tt)),", ");throw new x(Re,re,lt)}});function te(re,Re){if(typeof re!="boolean")throw new v(Re,"boolean",re)}function V(re,Re,Be){return re==null||!c(re,Re)?Be:re[Re]}const Q=y((re,Re,Be=null)=>{const Te=V(Be,"allowArray",!1),lt=V(Be,"allowFunction",!1);if(!V(Be,"nullable",!1)&&re===null||!Te&&e(re)||typeof re!="object"&&(!lt||typeof re!="function"))throw new v(Re,"Object",re)}),ee=y((re,Re)=>{if(re!=null&&typeof re!="object"&&typeof re!="function")throw new v(Re,"a dictionary",re)}),se=y((re,Re,Be=0)=>{if(!e(re))throw new v(Re,"Array",re);if(re.length<Be){const Te=`must be longer than ${Be}`;throw new x(Re,re,Te)}});function pe(re,Re){se(re,Re);for(let Be=0;Be<re.length;Be++)U(re[Be],`${Re}[${Be}]`)}function ue(re,Re){se(re,Re);for(let Be=0;Be<re.length;Be++)te(re[Be],`${Re}[${Be}]`)}function Oe(re,Re){se(re,Re);for(let Be=0;Be<re.length;Be++){const Te=re[Be],lt=`${Re}[${Be}]`;if(Te==null)throw new v(lt,"AbortSignal",Te);Qe(Te,lt)}}function Fe(re,Re="signal"){if(U(re,Re),R[re]===void 0)throw R[h(re)]!==void 0?new S(re+" (signals must use all capital letters)"):new S(re)}const Se=y((re,Re="buffer")=>{if(!T(re))throw new v(Re,["Buffer","TypedArray","DataView"],re)});function Ce(re,Re){const Be=k(Re),Te=re.length;if(Be==="hex"&&Te%2!==0)throw new x("encoding",Re,`is invalid for data of length ${Te}`)}function qe(re,Re="Port",Be=!0){if(typeof re!="number"&&typeof re!="string"||typeof re=="string"&&m(re).length===0||+re!==+re>>>0||re>65535||re===0&&!Be)throw new b(Re,re,Be);return re|0}const Qe=y((re,Re)=>{if(re!==void 0&&(re===null||typeof re!="object"||!("aborted"in re)))throw new v(Re,"AbortSignal",re)}),We=y((re,Re)=>{if(typeof re!="function")throw new v(Re,"Function",re)}),Ie=y((re,Re)=>{if(typeof re!="function"||C(re))throw new v(Re,"Function",re)}),K=y((re,Re)=>{if(re!==void 0)throw new v(Re,"undefined",re)});function ye(re,Re,Be){if(!t(Be,re))throw new v(Re,`('${n(Be,"|")}')`,re)}const Ne=/^(?:<[^>]*>)(?:\s*;\s*[^;"\s]+(?:=(")?[^;"\s]*\1)?)*$/;function ce(re,Re){if(typeof re>"u"||!u(Ne,re))throw new x(Re,re,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}function oe(re){if(typeof re=="string")return ce(re,"hints"),re;if(e(re)){const Re=re.length;let Be="";if(Re===0)return Be;for(let Te=0;Te<Re;Te++){const lt=re[Te];ce(lt,"hints"),Be+=lt,Te!==Re-1&&(Be+=", ")}return Be}throw new x("hints",re,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}return hM={isInt32:N,isUint32:I,parseFileMode:D,validateArray:se,validateStringArray:pe,validateBooleanArray:ue,validateAbortSignalArray:Oe,validateBoolean:te,validateBuffer:Se,validateDictionary:ee,validateEncoding:Ce,validateFunction:We,validateInt32:O,validateInteger:W,validateNumber:H,validateObject:Q,validateOneOf:L,validatePlainFunction:Ie,validatePort:qe,validateSignalName:Fe,validateString:U,validateUint32:Z,validateUndefined:K,validateUnion:ye,validateAbortSignal:Qe,validateLinkHeaderValue:oe},hM}var LS={exports:{}},pM={},i9;function Xm(){return i9||(i9=1,function(e){Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});function t(k){return k&&k.__esModule&&Object.prototype.hasOwnProperty.call(k,"default")?k.default:k}var n={exports:{}},r=n.exports={},s,i;function a(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?s=setTimeout:s=a}catch{s=a}try{typeof clearTimeout=="function"?i=clearTimeout:i=o}catch{i=o}})();function l(k){if(s===setTimeout)return setTimeout(k,0);if((s===a||!s)&&setTimeout)return s=setTimeout,setTimeout(k,0);try{return s(k,0)}catch{try{return s.call(null,k,0)}catch{return s.call(this,k,0)}}}function c(k){if(i===clearTimeout)return clearTimeout(k);if((i===o||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(k);try{return i(k)}catch{try{return i.call(null,k)}catch{return i.call(this,k)}}}var u=[],d=!1,h,m=-1;function y(){!d||!h||(d=!1,h.length?u=h.concat(u):m=-1,u.length&&b())}function b(){if(!d){var k=l(y);d=!0;for(var C=u.length;C;){for(h=u,u=[];++m<C;)h&&h[m].run();m=-1,C=u.length}h=null,d=!1,c(k)}}r.nextTick=function(k){var C=new Array(arguments.length-1);if(arguments.length>1)for(var T=1;T<arguments.length;T++)C[T-1]=arguments[T];u.push(new v(k,C)),u.length===1&&!d&&l(b)};function v(k,C){this.fun=k,this.array=C}v.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={};function x(){}r.on=x,r.addListener=x,r.once=x,r.off=x,r.removeListener=x,r.removeAllListeners=x,r.emit=x,r.prependListener=x,r.prependOnceListener=x,r.listeners=function(k){return[]},r.binding=function(k){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(k){throw new Error("process.chdir is not supported")},r.umask=function(){return 0};var w=n.exports;const S=t(w);e.default=S,e.process=S}(pM)),pM}var mM,a9;function af(){if(a9)return mM;a9=1;const{SymbolAsyncIterator:e,SymbolIterator:t,SymbolFor:n}=ni(),r=n("nodejs.stream.destroyed"),s=n("nodejs.stream.errored"),i=n("nodejs.stream.readable"),a=n("nodejs.stream.writable"),o=n("nodejs.stream.disturbed"),l=n("nodejs.webstream.isClosedPromise"),c=n("nodejs.webstream.controllerErrorFunction");function u(V,Q=!1){var ee;return!!(V&&typeof V.pipe=="function"&&typeof V.on=="function"&&(!Q||typeof V.pause=="function"&&typeof V.resume=="function")&&(!V._writableState||((ee=V._readableState)===null||ee===void 0?void 0:ee.readable)!==!1)&&(!V._writableState||V._readableState))}function d(V){var Q;return!!(V&&typeof V.write=="function"&&typeof V.on=="function"&&(!V._readableState||((Q=V._writableState)===null||Q===void 0?void 0:Q.writable)!==!1))}function h(V){return!!(V&&typeof V.pipe=="function"&&V._readableState&&typeof V.on=="function"&&typeof V.write=="function")}function m(V){return V&&(V._readableState||V._writableState||typeof V.write=="function"&&typeof V.on=="function"||typeof V.pipe=="function"&&typeof V.on=="function")}function y(V){return!!(V&&!m(V)&&typeof V.pipeThrough=="function"&&typeof V.getReader=="function"&&typeof V.cancel=="function")}function b(V){return!!(V&&!m(V)&&typeof V.getWriter=="function"&&typeof V.abort=="function")}function v(V){return!!(V&&!m(V)&&typeof V.readable=="object"&&typeof V.writable=="object")}function x(V){return y(V)||b(V)||v(V)}function w(V,Q){return V==null?!1:Q===!0?typeof V[e]=="function":Q===!1?typeof V[t]=="function":typeof V[e]=="function"||typeof V[t]=="function"}function S(V){if(!m(V))return null;const Q=V._writableState,ee=V._readableState,se=Q||ee;return!!(V.destroyed||V[r]||se!=null&&se.destroyed)}function k(V){if(!d(V))return null;if(V.writableEnded===!0)return!0;const Q=V._writableState;return Q!=null&&Q.errored?!1:typeof(Q==null?void 0:Q.ended)!="boolean"?null:Q.ended}function C(V,Q){if(!d(V))return null;if(V.writableFinished===!0)return!0;const ee=V._writableState;return ee!=null&&ee.errored?!1:typeof(ee==null?void 0:ee.finished)!="boolean"?null:!!(ee.finished||Q===!1&&ee.ended===!0&&ee.length===0)}function T(V){if(!u(V))return null;if(V.readableEnded===!0)return!0;const Q=V._readableState;return!Q||Q.errored?!1:typeof(Q==null?void 0:Q.ended)!="boolean"?null:Q.ended}function R(V,Q){if(!u(V))return null;const ee=V._readableState;return ee!=null&&ee.errored?!1:typeof(ee==null?void 0:ee.endEmitted)!="boolean"?null:!!(ee.endEmitted||Q===!1&&ee.ended===!0&&ee.length===0)}function N(V){return V&&V[i]!=null?V[i]:typeof(V==null?void 0:V.readable)!="boolean"?null:S(V)?!1:u(V)&&V.readable&&!R(V)}function I(V){return V&&V[a]!=null?V[a]:typeof(V==null?void 0:V.writable)!="boolean"?null:S(V)?!1:d(V)&&V.writable&&!k(V)}function P(V,Q){return m(V)?S(V)?!0:!((Q==null?void 0:Q.readable)!==!1&&N(V)||(Q==null?void 0:Q.writable)!==!1&&I(V)):null}function B(V){var Q,ee;return m(V)?V.writableErrored?V.writableErrored:(Q=(ee=V._writableState)===null||ee===void 0?void 0:ee.errored)!==null&&Q!==void 0?Q:null:null}function D(V){var Q,ee;return m(V)?V.readableErrored?V.readableErrored:(Q=(ee=V._readableState)===null||ee===void 0?void 0:ee.errored)!==null&&Q!==void 0?Q:null:null}function W(V){if(!m(V))return null;if(typeof V.closed=="boolean")return V.closed;const Q=V._writableState,ee=V._readableState;return typeof(Q==null?void 0:Q.closed)=="boolean"||typeof(ee==null?void 0:ee.closed)=="boolean"?(Q==null?void 0:Q.closed)||(ee==null?void 0:ee.closed):typeof V._closed=="boolean"&&O(V)?V._closed:null}function O(V){return typeof V._closed=="boolean"&&typeof V._defaultKeepAlive=="boolean"&&typeof V._removedConnection=="boolean"&&typeof V._removedContLen=="boolean"}function Z(V){return typeof V._sent100=="boolean"&&O(V)}function U(V){var Q;return typeof V._consuming=="boolean"&&typeof V._dumped=="boolean"&&((Q=V.req)===null||Q===void 0?void 0:Q.upgradeOrConnect)===void 0}function H(V){if(!m(V))return null;const Q=V._writableState,ee=V._readableState,se=Q||ee;return!se&&Z(V)||!!(se&&se.autoDestroy&&se.emitClose&&se.closed===!1)}function L(V){var Q;return!!(V&&((Q=V[o])!==null&&Q!==void 0?Q:V.readableDidRead||V.readableAborted))}function te(V){var Q,ee,se,pe,ue,Oe,Fe,Se,Ce,qe;return!!(V&&((Q=(ee=(se=(pe=(ue=(Oe=V[s])!==null&&Oe!==void 0?Oe:V.readableErrored)!==null&&ue!==void 0?ue:V.writableErrored)!==null&&pe!==void 0?pe:(Fe=V._readableState)===null||Fe===void 0?void 0:Fe.errorEmitted)!==null&&se!==void 0?se:(Se=V._writableState)===null||Se===void 0?void 0:Se.errorEmitted)!==null&&ee!==void 0?ee:(Ce=V._readableState)===null||Ce===void 0?void 0:Ce.errored)!==null&&Q!==void 0?Q:!((qe=V._writableState)===null||qe===void 0)&&qe.errored))}return mM={isDestroyed:S,kIsDestroyed:r,isDisturbed:L,kIsDisturbed:o,isErrored:te,kIsErrored:s,isReadable:N,kIsReadable:i,kIsClosedPromise:l,kControllerErrorFunction:c,kIsWritable:a,isClosed:W,isDuplexNodeStream:h,isFinished:P,isIterable:w,isReadableNodeStream:u,isReadableStream:y,isReadableEnded:T,isReadableFinished:R,isReadableErrored:D,isNodeStream:m,isWebStream:x,isWritable:I,isWritableNodeStream:d,isWritableStream:b,isWritableEnded:k,isWritableFinished:C,isWritableErrored:B,isServerRequest:U,isServerResponse:Z,willEmitClose:H,isTransformStream:v},mM}var o9;function Hh(){if(o9)return LS.exports;o9=1;const e=Xm(),{AbortError:t,codes:n}=fo(),{ERR_INVALID_ARG_TYPE:r,ERR_STREAM_PREMATURE_CLOSE:s}=n,{kEmptyObject:i,once:a}=Io(),{validateAbortSignal:o,validateFunction:l,validateObject:c,validateBoolean:u}=C1(),{Promise:d,PromisePrototypeThen:h,SymbolDispose:m}=ni(),{isClosed:y,isReadable:b,isReadableNodeStream:v,isReadableStream:x,isReadableFinished:w,isReadableErrored:S,isWritable:k,isWritableNodeStream:C,isWritableStream:T,isWritableFinished:R,isWritableErrored:N,isNodeStream:I,willEmitClose:P,kIsClosedPromise:B}=af();let D;function W(L){return L.setHeader&&typeof L.abort=="function"}const O=()=>{};function Z(L,te,V){var Q,ee;if(arguments.length===2?(V=te,te=i):te==null?te=i:c(te,"options"),l(V,"callback"),o(te.signal,"options.signal"),V=a(V),x(L)||T(L))return U(L,te,V);if(!I(L))throw new r("stream",["ReadableStream","WritableStream","Stream"],L);const se=(Q=te.readable)!==null&&Q!==void 0?Q:v(L),pe=(ee=te.writable)!==null&&ee!==void 0?ee:C(L),ue=L._writableState,Oe=L._readableState,Fe=()=>{L.writable||qe()};let Se=P(L)&&v(L)===se&&C(L)===pe,Ce=R(L,!1);const qe=()=>{Ce=!0,L.destroyed&&(Se=!1),!(Se&&(!L.readable||se))&&(!se||Qe)&&V.call(L)};let Qe=w(L,!1);const We=()=>{Qe=!0,L.destroyed&&(Se=!1),!(Se&&(!L.writable||pe))&&(!pe||Ce)&&V.call(L)},Ie=re=>{V.call(L,re)};let K=y(L);const ye=()=>{K=!0;const re=N(L)||S(L);if(re&&typeof re!="boolean")return V.call(L,re);if(se&&!Qe&&v(L,!0)&&!w(L,!1))return V.call(L,new s);if(pe&&!Ce&&!R(L,!1))return V.call(L,new s);V.call(L)},Ne=()=>{K=!0;const re=N(L)||S(L);if(re&&typeof re!="boolean")return V.call(L,re);V.call(L)},ce=()=>{L.req.on("finish",qe)};W(L)?(L.on("complete",qe),Se||L.on("abort",ye),L.req?ce():L.on("request",ce)):pe&&!ue&&(L.on("end",Fe),L.on("close",Fe)),!Se&&typeof L.aborted=="boolean"&&L.on("aborted",ye),L.on("end",We),L.on("finish",qe),te.error!==!1&&L.on("error",Ie),L.on("close",ye),K?e.nextTick(ye):ue!=null&&ue.errorEmitted||Oe!=null&&Oe.errorEmitted?Se||e.nextTick(Ne):(!se&&(!Se||b(L))&&(Ce||k(L)===!1)||!pe&&(!Se||k(L))&&(Qe||b(L)===!1)||Oe&&L.req&&L.aborted)&&e.nextTick(Ne);const oe=()=>{V=O,L.removeListener("aborted",ye),L.removeListener("complete",qe),L.removeListener("abort",ye),L.removeListener("request",ce),L.req&&L.req.removeListener("finish",qe),L.removeListener("end",Fe),L.removeListener("close",Fe),L.removeListener("finish",qe),L.removeListener("end",We),L.removeListener("error",Ie),L.removeListener("close",ye)};if(te.signal&&!K){const re=()=>{const Re=V;oe(),Re.call(L,new t(void 0,{cause:te.signal.reason}))};if(te.signal.aborted)e.nextTick(re);else{D=D||Io().addAbortListener;const Re=D(te.signal,re),Be=V;V=a((...Te)=>{Re[m](),Be.apply(L,Te)})}}return oe}function U(L,te,V){let Q=!1,ee=O;if(te.signal)if(ee=()=>{Q=!0,V.call(L,new t(void 0,{cause:te.signal.reason}))},te.signal.aborted)e.nextTick(ee);else{D=D||Io().addAbortListener;const pe=D(te.signal,ee),ue=V;V=a((...Oe)=>{pe[m](),ue.apply(L,Oe)})}const se=(...pe)=>{Q||e.nextTick(()=>V.apply(L,pe))};return h(L[B].promise,se,se),O}function H(L,te){var V;let Q=!1;return te===null&&(te=i),(V=te)!==null&&V!==void 0&&V.cleanup&&(u(te.cleanup,"cleanup"),Q=te.cleanup),new d((ee,se)=>{const pe=Z(L,te,ue=>{Q&&pe(),ue?se(ue):ee()})})}return LS.exports=Z,LS.exports.finished=H,LS.exports}var gM,l9;function Xy(){if(l9)return gM;l9=1;const e=Xm(),{aggregateTwoErrors:t,codes:{ERR_MULTIPLE_CALLBACK:n},AbortError:r}=fo(),{Symbol:s}=ni(),{kIsDestroyed:i,isDestroyed:a,isFinished:o,isServerRequest:l}=af(),c=s("kDestroy"),u=s("kConstruct");function d(P,B,D){P&&(P.stack,B&&!B.errored&&(B.errored=P),D&&!D.errored&&(D.errored=P))}function h(P,B){const D=this._readableState,W=this._writableState,O=W||D;return W!=null&&W.destroyed||D!=null&&D.destroyed?(typeof B=="function"&&B(),this):(d(P,W,D),W&&(W.destroyed=!0),D&&(D.destroyed=!0),O.constructed?m(this,P,B):this.once(c,function(Z){m(this,t(Z,P),B)}),this)}function m(P,B,D){let W=!1;function O(Z){if(W)return;W=!0;const U=P._readableState,H=P._writableState;d(Z,H,U),H&&(H.closed=!0),U&&(U.closed=!0),typeof D=="function"&&D(Z),Z?e.nextTick(y,P,Z):e.nextTick(b,P)}try{P._destroy(B||null,O)}catch(Z){O(Z)}}function y(P,B){v(P,B),b(P)}function b(P){const B=P._readableState,D=P._writableState;D&&(D.closeEmitted=!0),B&&(B.closeEmitted=!0),(D!=null&&D.emitClose||B!=null&&B.emitClose)&&P.emit("close")}function v(P,B){const D=P._readableState,W=P._writableState;W!=null&&W.errorEmitted||D!=null&&D.errorEmitted||(W&&(W.errorEmitted=!0),D&&(D.errorEmitted=!0),P.emit("error",B))}function x(){const P=this._readableState,B=this._writableState;P&&(P.constructed=!0,P.closed=!1,P.closeEmitted=!1,P.destroyed=!1,P.errored=null,P.errorEmitted=!1,P.reading=!1,P.ended=P.readable===!1,P.endEmitted=P.readable===!1),B&&(B.constructed=!0,B.destroyed=!1,B.closed=!1,B.closeEmitted=!1,B.errored=null,B.errorEmitted=!1,B.finalCalled=!1,B.prefinished=!1,B.ended=B.writable===!1,B.ending=B.writable===!1,B.finished=B.writable===!1)}function w(P,B,D){const W=P._readableState,O=P._writableState;if(O!=null&&O.destroyed||W!=null&&W.destroyed)return this;W!=null&&W.autoDestroy||O!=null&&O.autoDestroy?P.destroy(B):B&&(B.stack,O&&!O.errored&&(O.errored=B),W&&!W.errored&&(W.errored=B),D?e.nextTick(v,P,B):v(P,B))}function S(P,B){if(typeof P._construct!="function")return;const D=P._readableState,W=P._writableState;D&&(D.constructed=!1),W&&(W.constructed=!1),P.once(u,B),!(P.listenerCount(u)>1)&&e.nextTick(k,P)}function k(P){let B=!1;function D(W){if(B){w(P,W??new n);return}B=!0;const O=P._readableState,Z=P._writableState,U=Z||O;O&&(O.constructed=!0),Z&&(Z.constructed=!0),U.destroyed?P.emit(c,W):W?w(P,W,!0):e.nextTick(C,P)}try{P._construct(W=>{e.nextTick(D,W)})}catch(W){e.nextTick(D,W)}}function C(P){P.emit(u)}function T(P){return(P==null?void 0:P.setHeader)&&typeof P.abort=="function"}function R(P){P.emit("close")}function N(P,B){P.emit("error",B),e.nextTick(R,P)}function I(P,B){!P||a(P)||(!B&&!o(P)&&(B=new r),l(P)?(P.socket=null,P.destroy(B)):T(P)?P.abort():T(P.req)?P.req.abort():typeof P.destroy=="function"?P.destroy(B):typeof P.close=="function"?P.close():B?e.nextTick(N,P,B):e.nextTick(R,P),P.destroyed||(P[i]=!0))}return gM={construct:S,destroyer:I,destroy:h,undestroy:x,errorOrDestroy:w},gM}var yM,c9;function ZP(){if(c9)return yM;c9=1;const{ArrayIsArray:e,ObjectSetPrototypeOf:t}=ni(),{EventEmitter:n}=HE();function r(i){n.call(this,i)}t(r.prototype,n.prototype),t(r,n),r.prototype.pipe=function(i,a){const o=this;function l(b){i.writable&&i.write(b)===!1&&o.pause&&o.pause()}o.on("data",l);function c(){o.readable&&o.resume&&o.resume()}i.on("drain",c),!i._isStdio&&(!a||a.end!==!1)&&(o.on("end",d),o.on("close",h));let u=!1;function d(){u||(u=!0,i.end())}function h(){u||(u=!0,typeof i.destroy=="function"&&i.destroy())}function m(b){y(),n.listenerCount(this,"error")===0&&this.emit("error",b)}s(o,"error",m),s(i,"error",m);function y(){o.removeListener("data",l),i.removeListener("drain",c),o.removeListener("end",d),o.removeListener("close",h),o.removeListener("error",m),i.removeListener("error",m),o.removeListener("end",y),o.removeListener("close",y),i.removeListener("close",y)}return o.on("end",y),o.on("close",y),i.on("close",y),i.emit("pipe",o),i};function s(i,a,o){if(typeof i.prependListener=="function")return i.prependListener(a,o);!i._events||!i._events[a]?i.on(a,o):e(i._events[a])?i._events[a].unshift(o):i._events[a]=[o,i._events[a]]}return yM={Stream:r,prependListener:s},yM}var bM={exports:{}},u9;function GE(){return u9||(u9=1,function(e){const{SymbolDispose:t}=ni(),{AbortError:n,codes:r}=fo(),{isNodeStream:s,isWebStream:i,kControllerErrorFunction:a}=af(),o=Hh(),{ERR_INVALID_ARG_TYPE:l}=r;let c;const u=(d,h)=>{if(typeof d!="object"||!("aborted"in d))throw new l(h,"AbortSignal",d)};e.exports.addAbortSignal=function(h,m){if(u(h,"signal"),!s(m)&&!i(m))throw new l("stream",["ReadableStream","WritableStream","Stream"],m);return e.exports.addAbortSignalNoValidate(h,m)},e.exports.addAbortSignalNoValidate=function(d,h){if(typeof d!="object"||!("aborted"in d))return h;const m=s(h)?()=>{h.destroy(new n(void 0,{cause:d.reason}))}:()=>{h[a](new n(void 0,{cause:d.reason}))};if(d.aborted)m();else{c=c||Io().addAbortListener;const y=c(d,m);o(h,y[t])}return h}}(bM)),bM.exports}var vM,d9;function Y_e(){if(d9)return vM;d9=1;const{StringPrototypeSlice:e,SymbolIterator:t,TypedArrayPrototypeSet:n,Uint8Array:r}=ni(),{Buffer:s}=Wh(),{inspect:i}=Io();return vM=class{constructor(){this.head=null,this.tail=null,this.length=0}push(o){const l={data:o,next:null};this.length>0?this.tail.next=l:this.head=l,this.tail=l,++this.length}unshift(o){const l={data:o,next:this.head};this.length===0&&(this.tail=l),this.head=l,++this.length}shift(){if(this.length===0)return;const o=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,o}clear(){this.head=this.tail=null,this.length=0}join(o){if(this.length===0)return"";let l=this.head,c=""+l.data;for(;(l=l.next)!==null;)c+=o+l.data;return c}concat(o){if(this.length===0)return s.alloc(0);const l=s.allocUnsafe(o>>>0);let c=this.head,u=0;for(;c;)n(l,c.data,u),u+=c.data.length,c=c.next;return l}consume(o,l){const c=this.head.data;if(o<c.length){const u=c.slice(0,o);return this.head.data=c.slice(o),u}return o===c.length?this.shift():l?this._getString(o):this._getBuffer(o)}first(){return this.head.data}*[t](){for(let o=this.head;o;o=o.next)yield o.data}_getString(o){let l="",c=this.head,u=0;do{const d=c.data;if(o>d.length)l+=d,o-=d.length;else{o===d.length?(l+=d,++u,c.next?this.head=c.next:this.head=this.tail=null):(l+=e(d,0,o),this.head=c,c.data=e(d,o));break}++u}while((c=c.next)!==null);return this.length-=u,l}_getBuffer(o){const l=s.allocUnsafe(o),c=o;let u=this.head,d=0;do{const h=u.data;if(o>h.length)n(l,h,c-o),o-=h.length;else{o===h.length?(n(l,h,c-o),++d,u.next?this.head=u.next:this.head=this.tail=null):(n(l,new r(h.buffer,h.byteOffset,o),c-o),this.head=u,u.data=h.slice(o));break}++d}while((u=u.next)!==null);return this.length-=d,l}[Symbol.for("nodejs.util.inspect.custom")](o,l){return i(this,{...l,depth:0,customInspect:!1})}},vM}var xM,f9;function KE(){if(f9)return xM;f9=1;const{MathFloor:e,NumberIsInteger:t}=ni(),{validateInteger:n}=C1(),{ERR_INVALID_ARG_VALUE:r}=fo().codes;let s=16*1024,i=16;function a(u,d,h){return u.highWaterMark!=null?u.highWaterMark:d?u[h]:null}function o(u){return u?i:s}function l(u,d){n(d,"value",0),u?i=d:s=d}function c(u,d,h,m){const y=a(d,m,h);if(y!=null){if(!t(y)||y<0){const b=m?`options.${h}`:"options.highWaterMark";throw new r(b,y)}return e(y)}return o(u.objectMode)}return xM={getHighWaterMark:c,getDefaultHighWaterMark:o,setDefaultHighWaterMark:l},xM}var wM={},BS={exports:{}},h9;function XP(){return h9||(h9=1,function(e,t){var n=Wh(),r=n.Buffer;function s(a,o){for(var l in a)o[l]=a[l]}r.from&&r.alloc&&r.allocUnsafe&&r.allocUnsafeSlow?e.exports=n:(s(n,t),t.Buffer=i);function i(a,o,l){return r(a,o,l)}s(r,i),i.from=function(a,o,l){if(typeof a=="number")throw new TypeError("Argument must not be a number");return r(a,o,l)},i.alloc=function(a,o,l){if(typeof a!="number")throw new TypeError("Argument must be a number");var c=r(a);return o!==void 0?typeof l=="string"?c.fill(o,l):c.fill(o):c.fill(0),c},i.allocUnsafe=function(a){if(typeof a!="number")throw new TypeError("Argument must be a number");return r(a)},i.allocUnsafeSlow=function(a){if(typeof a!="number")throw new TypeError("Argument must be a number");return n.SlowBuffer(a)}}(BS,BS.exports)),BS.exports}var p9;function Z_e(){if(p9)return wM;p9=1;var e=XP().Buffer,t=e.isEncoding||function(x){switch(x=""+x,x&&x.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function n(x){if(!x)return"utf8";for(var w;;)switch(x){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return x;default:if(w)return;x=(""+x).toLowerCase(),w=!0}}function r(x){var w=n(x);if(typeof w!="string"&&(e.isEncoding===t||!t(x)))throw new Error("Unknown encoding: "+x);return w||x}wM.StringDecoder=s;function s(x){this.encoding=r(x);var w;switch(this.encoding){case"utf16le":this.text=d,this.end=h,w=4;break;case"utf8":this.fillLast=l,w=4;break;case"base64":this.text=m,this.end=y,w=3;break;default:this.write=b,this.end=v;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=e.allocUnsafe(w)}s.prototype.write=function(x){if(x.length===0)return"";var w,S;if(this.lastNeed){if(w=this.fillLast(x),w===void 0)return"";S=this.lastNeed,this.lastNeed=0}else S=0;return S<x.length?w?w+this.text(x,S):this.text(x,S):w||""},s.prototype.end=u,s.prototype.text=c,s.prototype.fillLast=function(x){if(this.lastNeed<=x.length)return x.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);x.copy(this.lastChar,this.lastTotal-this.lastNeed,0,x.length),this.lastNeed-=x.length};function i(x){return x<=127?0:x>>5===6?2:x>>4===14?3:x>>3===30?4:x>>6===2?-1:-2}function a(x,w,S){var k=w.length-1;if(k<S)return 0;var C=i(w[k]);return C>=0?(C>0&&(x.lastNeed=C-1),C):--k<S||C===-2?0:(C=i(w[k]),C>=0?(C>0&&(x.lastNeed=C-2),C):--k<S||C===-2?0:(C=i(w[k]),C>=0?(C>0&&(C===2?C=0:x.lastNeed=C-3),C):0))}function o(x,w,S){if((w[0]&192)!==128)return x.lastNeed=0,"";if(x.lastNeed>1&&w.length>1){if((w[1]&192)!==128)return x.lastNeed=1,"";if(x.lastNeed>2&&w.length>2&&(w[2]&192)!==128)return x.lastNeed=2,""}}function l(x){var w=this.lastTotal-this.lastNeed,S=o(this,x);if(S!==void 0)return S;if(this.lastNeed<=x.length)return x.copy(this.lastChar,w,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);x.copy(this.lastChar,w,0,x.length),this.lastNeed-=x.length}function c(x,w){var S=a(this,x,w);if(!this.lastNeed)return x.toString("utf8",w);this.lastTotal=S;var k=x.length-(S-this.lastNeed);return x.copy(this.lastChar,0,k),x.toString("utf8",w,k)}function u(x){var w=x&&x.length?this.write(x):"";return this.lastNeed?w+"":w}function d(x,w){if((x.length-w)%2===0){var S=x.toString("utf16le",w);if(S){var k=S.charCodeAt(S.length-1);if(k>=55296&&k<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=x[x.length-2],this.lastChar[1]=x[x.length-1],S.slice(0,-1)}return S}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=x[x.length-1],x.toString("utf16le",w,x.length-1)}function h(x){var w=x&&x.length?this.write(x):"";if(this.lastNeed){var S=this.lastTotal-this.lastNeed;return w+this.lastChar.toString("utf16le",0,S)}return w}function m(x,w){var S=(x.length-w)%3;return S===0?x.toString("base64",w):(this.lastNeed=3-S,this.lastTotal=3,S===1?this.lastChar[0]=x[x.length-1]:(this.lastChar[0]=x[x.length-2],this.lastChar[1]=x[x.length-1]),x.toString("base64",w,x.length-S))}function y(x){var w=x&&x.length?this.write(x):"";return this.lastNeed?w+this.lastChar.toString("base64",0,3-this.lastNeed):w}function b(x){return x.toString(this.encoding)}function v(x){return x&&x.length?this.write(x):""}return wM}var _M,m9;function sY(){if(m9)return _M;m9=1;const e=Xm(),{PromisePrototypeThen:t,SymbolAsyncIterator:n,SymbolIterator:r}=ni(),{Buffer:s}=Wh(),{ERR_INVALID_ARG_TYPE:i,ERR_STREAM_NULL_VALUES:a}=fo().codes;function o(l,c,u){let d;if(typeof c=="string"||c instanceof s)return new l({objectMode:!0,...u,read(){this.push(c),this.push(null)}});let h;if(c&&c[n])h=!0,d=c[n]();else if(c&&c[r])h=!1,d=c[r]();else throw new i("iterable",["Iterable"],c);const m=new l({objectMode:!0,highWaterMark:1,...u});let y=!1;m._read=function(){y||(y=!0,v())},m._destroy=function(x,w){t(b(x),()=>e.nextTick(w,x),S=>e.nextTick(w,S||x))};async function b(x){const w=x!=null,S=typeof d.throw=="function";if(w&&S){const{value:k,done:C}=await d.throw(x);if(await k,C)return}if(typeof d.return=="function"){const{value:k}=await d.return();await k}}async function v(){for(;;){try{const{value:x,done:w}=h?await d.next():d.next();if(w)m.push(null);else{const S=x&&typeof x.then=="function"?await x:x;if(S===null)throw y=!1,new a;if(m.push(S))continue;y=!1}}catch(x){m.destroy(x)}break}}return m}return _M=o,_M}var SM,g9;function YE(){if(g9)return SM;g9=1;const e=Xm(),{ArrayPrototypeIndexOf:t,NumberIsInteger:n,NumberIsNaN:r,NumberParseInt:s,ObjectDefineProperties:i,ObjectKeys:a,ObjectSetPrototypeOf:o,Promise:l,SafeSet:c,SymbolAsyncDispose:u,SymbolAsyncIterator:d,Symbol:h}=ni();SM=Te,Te.ReadableState=Be;const{EventEmitter:m}=HE(),{Stream:y,prependListener:b}=ZP(),{Buffer:v}=Wh(),{addAbortSignal:x}=GE(),w=Hh();let S=Io().debuglog("stream",fe=>{S=fe});const k=Y_e(),C=Xy(),{getHighWaterMark:T,getDefaultHighWaterMark:R}=KE(),{aggregateTwoErrors:N,codes:{ERR_INVALID_ARG_TYPE:I,ERR_METHOD_NOT_IMPLEMENTED:P,ERR_OUT_OF_RANGE:B,ERR_STREAM_PUSH_AFTER_EOF:D,ERR_STREAM_UNSHIFT_AFTER_END_EVENT:W},AbortError:O}=fo(),{validateObject:Z}=C1(),U=h("kPaused"),{StringDecoder:H}=Z_e(),L=sY();o(Te.prototype,y.prototype),o(Te,y);const te=()=>{},{errorOrDestroy:V}=C,Q=1,ee=2,se=4,pe=8,ue=16,Oe=32,Fe=64,Se=128,Ce=256,qe=512,Qe=1024,We=2048,Ie=4096,K=8192,ye=16384,Ne=32768,ce=65536,oe=1<<17,re=1<<18;function Re(fe){return{enumerable:!1,get(){return(this.state&fe)!==0},set(Y){Y?this.state|=fe:this.state&=~fe}}}i(Be.prototype,{objectMode:Re(Q),ended:Re(ee),endEmitted:Re(se),reading:Re(pe),constructed:Re(ue),sync:Re(Oe),needReadable:Re(Fe),emittedReadable:Re(Se),readableListening:Re(Ce),resumeScheduled:Re(qe),errorEmitted:Re(Qe),emitClose:Re(We),autoDestroy:Re(Ie),destroyed:Re(K),closed:Re(ye),closeEmitted:Re(Ne),multiAwaitDrain:Re(ce),readingMore:Re(oe),dataEmitted:Re(re)});function Be(fe,Y,G){typeof G!="boolean"&&(G=Y instanceof Zd()),this.state=We|Ie|ue|Oe,fe&&fe.objectMode&&(this.state|=Q),G&&fe&&fe.readableObjectMode&&(this.state|=Q),this.highWaterMark=fe?T(this,fe,"readableHighWaterMark",G):R(!1),this.buffer=new k,this.length=0,this.pipes=[],this.flowing=null,this[U]=null,fe&&fe.emitClose===!1&&(this.state&=-2049),fe&&fe.autoDestroy===!1&&(this.state&=-4097),this.errored=null,this.defaultEncoding=fe&&fe.defaultEncoding||"utf8",this.awaitDrainWriters=null,this.decoder=null,this.encoding=null,fe&&fe.encoding&&(this.decoder=new H(fe.encoding),this.encoding=fe.encoding)}function Te(fe){if(!(this instanceof Te))return new Te(fe);const Y=this instanceof Zd();this._readableState=new Be(fe,this,Y),fe&&(typeof fe.read=="function"&&(this._read=fe.read),typeof fe.destroy=="function"&&(this._destroy=fe.destroy),typeof fe.construct=="function"&&(this._construct=fe.construct),fe.signal&&!Y&&x(fe.signal,this)),y.call(this,fe),C.construct(this,()=>{this._readableState.needReadable&&F(this,this._readableState)})}Te.prototype.destroy=C.destroy,Te.prototype._undestroy=C.undestroy,Te.prototype._destroy=function(fe,Y){Y(fe)},Te.prototype[m.captureRejectionSymbol]=function(fe){this.destroy(fe)},Te.prototype[u]=function(){let fe;return this.destroyed||(fe=this.readableEnded?null:new O,this.destroy(fe)),new l((Y,G)=>w(this,J=>J&&J!==fe?G(J):Y(null)))},Te.prototype.push=function(fe,Y){return lt(this,fe,Y,!1)},Te.prototype.unshift=function(fe,Y){return lt(this,fe,Y,!0)};function lt(fe,Y,G,J){S("readableAddChunk",Y);const xe=fe._readableState;let De;if((xe.state&Q)===0&&(typeof Y=="string"?(G=G||xe.defaultEncoding,xe.encoding!==G&&(J&&xe.encoding?Y=v.from(Y,G).toString(xe.encoding):(Y=v.from(Y,G),G=""))):Y instanceof v?G="":y._isUint8Array(Y)?(Y=y._uint8ArrayToBuffer(Y),G=""):Y!=null&&(De=new I("chunk",["string","Buffer","Uint8Array"],Y))),De)V(fe,De);else if(Y===null)xe.state&=-9,Ft(fe,xe);else if((xe.state&Q)!==0||Y&&Y.length>0)if(J)if((xe.state&se)!==0)V(fe,new W);else{if(xe.destroyed||xe.errored)return!1;Tt(fe,xe,Y,!0)}else if(xe.ended)V(fe,new D);else{if(xe.destroyed||xe.errored)return!1;xe.state&=-9,xe.decoder&&!G?(Y=xe.decoder.write(Y),xe.objectMode||Y.length!==0?Tt(fe,xe,Y,!1):F(fe,xe)):Tt(fe,xe,Y,!1)}else J||(xe.state&=-9,F(fe,xe));return!xe.ended&&(xe.length<xe.highWaterMark||xe.length===0)}function Tt(fe,Y,G,J){Y.flowing&&Y.length===0&&!Y.sync&&fe.listenerCount("data")>0?((Y.state&ce)!==0?Y.awaitDrainWriters.clear():Y.awaitDrainWriters=null,Y.dataEmitted=!0,fe.emit("data",G)):(Y.length+=Y.objectMode?1:G.length,J?Y.buffer.unshift(G):Y.buffer.push(G),(Y.state&Fe)!==0&&Ht(fe)),F(fe,Y)}Te.prototype.isPaused=function(){const fe=this._readableState;return fe[U]===!0||fe.flowing===!1},Te.prototype.setEncoding=function(fe){const Y=new H(fe);this._readableState.decoder=Y,this._readableState.encoding=this._readableState.decoder.encoding;const G=this._readableState.buffer;let J="";for(const xe of G)J+=Y.write(xe);return G.clear(),J!==""&&G.push(J),this._readableState.length=J.length,this};const ut=1073741824;function jt(fe){if(fe>ut)throw new B("size","<= 1GiB",fe);return fe--,fe|=fe>>>1,fe|=fe>>>2,fe|=fe>>>4,fe|=fe>>>8,fe|=fe>>>16,fe++,fe}function qt(fe,Y){return fe<=0||Y.length===0&&Y.ended?0:(Y.state&Q)!==0?1:r(fe)?Y.flowing&&Y.length?Y.buffer.first().length:Y.length:fe<=Y.length?fe:Y.ended?Y.length:0}Te.prototype.read=function(fe){S("read",fe),fe===void 0?fe=NaN:n(fe)||(fe=s(fe,10));const Y=this._readableState,G=fe;if(fe>Y.highWaterMark&&(Y.highWaterMark=jt(fe)),fe!==0&&(Y.state&=-129),fe===0&&Y.needReadable&&((Y.highWaterMark!==0?Y.length>=Y.highWaterMark:Y.length>0)||Y.ended))return S("read: emitReadable",Y.length,Y.ended),Y.length===0&&Y.ended?tt(this):Ht(this),null;if(fe=qt(fe,Y),fe===0&&Y.ended)return Y.length===0&&tt(this),null;let J=(Y.state&Fe)!==0;if(S("need readable",J),(Y.length===0||Y.length-fe<Y.highWaterMark)&&(J=!0,S("length less than watermark",J)),Y.ended||Y.reading||Y.destroyed||Y.errored||!Y.constructed)J=!1,S("reading, ended or constructing",J);else if(J){S("do read"),Y.state|=pe|Oe,Y.length===0&&(Y.state|=Fe);try{this._read(Y.highWaterMark)}catch(De){V(this,De)}Y.state&=-33,Y.reading||(fe=qt(G,Y))}let xe;return fe>0?xe=Ue(fe,Y):xe=null,xe===null?(Y.needReadable=Y.length<=Y.highWaterMark,fe=0):(Y.length-=fe,Y.multiAwaitDrain?Y.awaitDrainWriters.clear():Y.awaitDrainWriters=null),Y.length===0&&(Y.ended||(Y.needReadable=!0),G!==fe&&Y.ended&&tt(this)),xe!==null&&!Y.errorEmitted&&!Y.closeEmitted&&(Y.dataEmitted=!0,this.emit("data",xe)),xe};function Ft(fe,Y){if(S("onEofChunk"),!Y.ended){if(Y.decoder){const G=Y.decoder.end();G&&G.length&&(Y.buffer.push(G),Y.length+=Y.objectMode?1:G.length)}Y.ended=!0,Y.sync?Ht(fe):(Y.needReadable=!1,Y.emittedReadable=!0,we(fe))}}function Ht(fe){const Y=fe._readableState;S("emitReadable",Y.needReadable,Y.emittedReadable),Y.needReadable=!1,Y.emittedReadable||(S("emitReadable",Y.flowing),Y.emittedReadable=!0,e.nextTick(we,fe))}function we(fe){const Y=fe._readableState;S("emitReadable_",Y.destroyed,Y.length,Y.ended),!Y.destroyed&&!Y.errored&&(Y.length||Y.ended)&&(fe.emit("readable"),Y.emittedReadable=!1),Y.needReadable=!Y.flowing&&!Y.ended&&Y.length<=Y.highWaterMark,dt(fe)}function F(fe,Y){!Y.readingMore&&Y.constructed&&(Y.readingMore=!0,e.nextTick(X,fe,Y))}function X(fe,Y){for(;!Y.reading&&!Y.ended&&(Y.length<Y.highWaterMark||Y.flowing&&Y.length===0);){const G=Y.length;if(S("maybeReadMore read 0"),fe.read(0),G===Y.length)break}Y.readingMore=!1}Te.prototype._read=function(fe){throw new P("_read()")},Te.prototype.pipe=function(fe,Y){const G=this,J=this._readableState;J.pipes.length===1&&(J.multiAwaitDrain||(J.multiAwaitDrain=!0,J.awaitDrainWriters=new c(J.awaitDrainWriters?[J.awaitDrainWriters]:[]))),J.pipes.push(fe),S("pipe count=%d opts=%j",J.pipes.length,Y);const De=(!Y||Y.end!==!1)&&fe!==e.stdout&&fe!==e.stderr?xt:rs;J.endEmitted?e.nextTick(De):G.once("end",De),fe.on("unpipe",He);function He(kr,hn){S("onunpipe"),kr===G&&hn&&hn.hasUnpiped===!1&&(hn.hasUnpiped=!0,Zt())}function xt(){S("onend"),fe.end()}let Qt,On=!1;function Zt(){S("cleanup"),fe.removeListener("close",Nr),fe.removeListener("finish",ns),Qt&&fe.removeListener("drain",Qt),fe.removeListener("error",gr),fe.removeListener("unpipe",He),G.removeListener("end",xt),G.removeListener("end",rs),G.removeListener("data",un),On=!0,Qt&&J.awaitDrainWriters&&(!fe._writableState||fe._writableState.needDrain)&&Qt()}function nn(){On||(J.pipes.length===1&&J.pipes[0]===fe?(S("false write response, pause",0),J.awaitDrainWriters=fe,J.multiAwaitDrain=!1):J.pipes.length>1&&J.pipes.includes(fe)&&(S("false write response, pause",J.awaitDrainWriters.size),J.awaitDrainWriters.add(fe)),G.pause()),Qt||(Qt=be(G,fe),fe.on("drain",Qt))}G.on("data",un);function un(kr){S("ondata");const hn=fe.write(kr);S("dest.write",hn),hn===!1&&nn()}function gr(kr){if(S("onerror",kr),rs(),fe.removeListener("error",gr),fe.listenerCount("error")===0){const hn=fe._writableState||fe._readableState;hn&&!hn.errorEmitted?V(fe,kr):fe.emit("error",kr)}}b(fe,"error",gr);function Nr(){fe.removeListener("finish",ns),rs()}fe.once("close",Nr);function ns(){S("onfinish"),fe.removeListener("close",Nr),rs()}fe.once("finish",ns);function rs(){S("unpipe"),G.unpipe(fe)}return fe.emit("pipe",G),fe.writableNeedDrain===!0?nn():J.flowing||(S("pipe resume"),G.resume()),fe};function be(fe,Y){return function(){const J=fe._readableState;J.awaitDrainWriters===Y?(S("pipeOnDrain",1),J.awaitDrainWriters=null):J.multiAwaitDrain&&(S("pipeOnDrain",J.awaitDrainWriters.size),J.awaitDrainWriters.delete(Y)),(!J.awaitDrainWriters||J.awaitDrainWriters.size===0)&&fe.listenerCount("data")&&fe.resume()}}Te.prototype.unpipe=function(fe){const Y=this._readableState,G={hasUnpiped:!1};if(Y.pipes.length===0)return this;if(!fe){const xe=Y.pipes;Y.pipes=[],this.pause();for(let De=0;De<xe.length;De++)xe[De].emit("unpipe",this,{hasUnpiped:!1});return this}const J=t(Y.pipes,fe);return J===-1?this:(Y.pipes.splice(J,1),Y.pipes.length===0&&this.pause(),fe.emit("unpipe",this,G),this)},Te.prototype.on=function(fe,Y){const G=y.prototype.on.call(this,fe,Y),J=this._readableState;return fe==="data"?(J.readableListening=this.listenerCount("readable")>0,J.flowing!==!1&&this.resume()):fe==="readable"&&!J.endEmitted&&!J.readableListening&&(J.readableListening=J.needReadable=!0,J.flowing=!1,J.emittedReadable=!1,S("on readable",J.length,J.reading),J.length?Ht(this):J.reading||e.nextTick(ge,this)),G},Te.prototype.addListener=Te.prototype.on,Te.prototype.removeListener=function(fe,Y){const G=y.prototype.removeListener.call(this,fe,Y);return fe==="readable"&&e.nextTick(ke,this),G},Te.prototype.off=Te.prototype.removeListener,Te.prototype.removeAllListeners=function(fe){const Y=y.prototype.removeAllListeners.apply(this,arguments);return(fe==="readable"||fe===void 0)&&e.nextTick(ke,this),Y};function ke(fe){const Y=fe._readableState;Y.readableListening=fe.listenerCount("readable")>0,Y.resumeScheduled&&Y[U]===!1?Y.flowing=!0:fe.listenerCount("data")>0?fe.resume():Y.readableListening||(Y.flowing=null)}function ge(fe){S("readable nexttick read 0"),fe.read(0)}Te.prototype.resume=function(){const fe=this._readableState;return fe.flowing||(S("resume"),fe.flowing=!fe.readableListening,Ee(this,fe)),fe[U]=!1,this};function Ee(fe,Y){Y.resumeScheduled||(Y.resumeScheduled=!0,e.nextTick(le,fe,Y))}function le(fe,Y){S("resume",Y.reading),Y.reading||fe.read(0),Y.resumeScheduled=!1,fe.emit("resume"),dt(fe),Y.flowing&&!Y.reading&&fe.read(0)}Te.prototype.pause=function(){return S("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(S("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState[U]=!0,this};function dt(fe){const Y=fe._readableState;for(S("flow",Y.flowing);Y.flowing&&fe.read()!==null;);}Te.prototype.wrap=function(fe){let Y=!1;fe.on("data",J=>{!this.push(J)&&fe.pause&&(Y=!0,fe.pause())}),fe.on("end",()=>{this.push(null)}),fe.on("error",J=>{V(this,J)}),fe.on("close",()=>{this.destroy()}),fe.on("destroy",()=>{this.destroy()}),this._read=()=>{Y&&fe.resume&&(Y=!1,fe.resume())};const G=a(fe);for(let J=1;J<G.length;J++){const xe=G[J];this[xe]===void 0&&typeof fe[xe]=="function"&&(this[xe]=fe[xe].bind(fe))}return this},Te.prototype[d]=function(){return et(this)},Te.prototype.iterator=function(fe){return fe!==void 0&&Z(fe,"options"),et(this,fe)};function et(fe,Y){typeof fe.read!="function"&&(fe=Te.wrap(fe,{objectMode:!0}));const G=$(fe,Y);return G.stream=fe,G}async function*$(fe,Y){let G=te;function J(He){this===fe?(G(),G=te):G=He}fe.on("readable",J);let xe;const De=w(fe,{writable:!1},He=>{xe=He?N(xe,He):null,G(),G=te});try{for(;;){const He=fe.destroyed?null:fe.read();if(He!==null)yield He;else{if(xe)throw xe;if(xe===null)return;await new l(J)}}}catch(He){throw xe=N(xe,He),xe}finally{(xe||(Y==null?void 0:Y.destroyOnReturn)!==!1)&&(xe===void 0||fe._readableState.autoDestroy)?C.destroyer(fe,null):(fe.off("readable",J),De())}}i(Te.prototype,{readable:{__proto__:null,get(){const fe=this._readableState;return!!fe&&fe.readable!==!1&&!fe.destroyed&&!fe.errorEmitted&&!fe.endEmitted},set(fe){this._readableState&&(this._readableState.readable=!!fe)}},readableDidRead:{__proto__:null,enumerable:!1,get:function(){return this._readableState.dataEmitted}},readableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(this._readableState.readable!==!1&&(this._readableState.destroyed||this._readableState.errored)&&!this._readableState.endEmitted)}},readableHighWaterMark:{__proto__:null,enumerable:!1,get:function(){return this._readableState.highWaterMark}},readableBuffer:{__proto__:null,enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}},readableFlowing:{__proto__:null,enumerable:!1,get:function(){return this._readableState.flowing},set:function(fe){this._readableState&&(this._readableState.flowing=fe)}},readableLength:{__proto__:null,enumerable:!1,get(){return this._readableState.length}},readableObjectMode:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.objectMode:!1}},readableEncoding:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.encoding:null}},errored:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.errored:null}},closed:{__proto__:null,get(){return this._readableState?this._readableState.closed:!1}},destroyed:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.destroyed:!1},set(fe){this._readableState&&(this._readableState.destroyed=fe)}},readableEnded:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.endEmitted:!1}}}),i(Be.prototype,{pipesCount:{__proto__:null,get(){return this.pipes.length}},paused:{__proto__:null,get(){return this[U]!==!1},set(fe){this[U]=!!fe}}}),Te._fromList=Ue;function Ue(fe,Y){if(Y.length===0)return null;let G;return Y.objectMode?G=Y.buffer.shift():!fe||fe>=Y.length?(Y.decoder?G=Y.buffer.join(""):Y.buffer.length===1?G=Y.buffer.first():G=Y.buffer.concat(Y.length),Y.buffer.clear()):G=Y.buffer.consume(fe,Y.decoder),G}function tt(fe){const Y=fe._readableState;S("endReadable",Y.endEmitted),Y.endEmitted||(Y.ended=!0,e.nextTick(ve,Y,fe))}function ve(fe,Y){if(S("endReadableNT",fe.endEmitted,fe.length),!fe.errored&&!fe.closeEmitted&&!fe.endEmitted&&fe.length===0){if(fe.endEmitted=!0,Y.emit("end"),Y.writable&&Y.allowHalfOpen===!1)e.nextTick(_e,Y);else if(fe.autoDestroy){const G=Y._writableState;(!G||G.autoDestroy&&(G.finished||G.writable===!1))&&Y.destroy()}}}function _e(fe){fe.writable&&!fe.writableEnded&&!fe.destroyed&&fe.end()}Te.from=function(fe,Y){return L(Te,fe,Y)};let $e;function Ct(){return $e===void 0&&($e={}),$e}return Te.fromWeb=function(fe,Y){return Ct().newStreamReadableFromReadableStream(fe,Y)},Te.toWeb=function(fe,Y){return Ct().newReadableStreamFromStreamReadable(fe,Y)},Te.wrap=function(fe,Y){var G,J;return new Te({objectMode:(G=(J=fe.readableObjectMode)!==null&&J!==void 0?J:fe.objectMode)!==null&&G!==void 0?G:!0,...Y,destroy(xe,De){C.destroyer(fe,xe),De(xe)}}).wrap(fe)},SM}var CM,y9;function JP(){if(y9)return CM;y9=1;const e=Xm(),{ArrayPrototypeSlice:t,Error:n,FunctionPrototypeSymbolHasInstance:r,ObjectDefineProperty:s,ObjectDefineProperties:i,ObjectSetPrototypeOf:a,StringPrototypeToLowerCase:o,Symbol:l,SymbolHasInstance:c}=ni();CM=Z,Z.WritableState=W;const{EventEmitter:u}=HE(),d=ZP().Stream,{Buffer:h}=Wh(),m=Xy(),{addAbortSignal:y}=GE(),{getHighWaterMark:b,getDefaultHighWaterMark:v}=KE(),{ERR_INVALID_ARG_TYPE:x,ERR_METHOD_NOT_IMPLEMENTED:w,ERR_MULTIPLE_CALLBACK:S,ERR_STREAM_CANNOT_PIPE:k,ERR_STREAM_DESTROYED:C,ERR_STREAM_ALREADY_FINISHED:T,ERR_STREAM_NULL_VALUES:R,ERR_STREAM_WRITE_AFTER_END:N,ERR_UNKNOWN_ENCODING:I}=fo().codes,{errorOrDestroy:P}=m;a(Z.prototype,d.prototype),a(Z,d);function B(){}const D=l("kOnFinished");function W(Ie,K,ye){typeof ye!="boolean"&&(ye=K instanceof Zd()),this.objectMode=!!(Ie&&Ie.objectMode),ye&&(this.objectMode=this.objectMode||!!(Ie&&Ie.writableObjectMode)),this.highWaterMark=Ie?b(this,Ie,"writableHighWaterMark",ye):v(!1),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;const Ne=!!(Ie&&Ie.decodeStrings===!1);this.decodeStrings=!Ne,this.defaultEncoding=Ie&&Ie.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=V.bind(void 0,K),this.writecb=null,this.writelen=0,this.afterWriteTickInfo=null,O(this),this.pendingcb=0,this.constructed=!0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!Ie||Ie.emitClose!==!1,this.autoDestroy=!Ie||Ie.autoDestroy!==!1,this.errored=null,this.closed=!1,this.closeEmitted=!1,this[D]=[]}function O(Ie){Ie.buffered=[],Ie.bufferedIndex=0,Ie.allBuffers=!0,Ie.allNoop=!0}W.prototype.getBuffer=function(){return t(this.buffered,this.bufferedIndex)},s(W.prototype,"bufferedRequestCount",{__proto__:null,get(){return this.buffered.length-this.bufferedIndex}});function Z(Ie){const K=this instanceof Zd();if(!K&&!r(Z,this))return new Z(Ie);this._writableState=new W(Ie,this,K),Ie&&(typeof Ie.write=="function"&&(this._write=Ie.write),typeof Ie.writev=="function"&&(this._writev=Ie.writev),typeof Ie.destroy=="function"&&(this._destroy=Ie.destroy),typeof Ie.final=="function"&&(this._final=Ie.final),typeof Ie.construct=="function"&&(this._construct=Ie.construct),Ie.signal&&y(Ie.signal,this)),d.call(this,Ie),m.construct(this,()=>{const ye=this._writableState;ye.writing||pe(this,ye),Se(this,ye)})}s(Z,c,{__proto__:null,value:function(Ie){return r(this,Ie)?!0:this!==Z?!1:Ie&&Ie._writableState instanceof W}}),Z.prototype.pipe=function(){P(this,new k)};function U(Ie,K,ye,Ne){const ce=Ie._writableState;if(typeof ye=="function")Ne=ye,ye=ce.defaultEncoding;else{if(!ye)ye=ce.defaultEncoding;else if(ye!=="buffer"&&!h.isEncoding(ye))throw new I(ye);typeof Ne!="function"&&(Ne=B)}if(K===null)throw new R;if(!ce.objectMode)if(typeof K=="string")ce.decodeStrings!==!1&&(K=h.from(K,ye),ye="buffer");else if(K instanceof h)ye="buffer";else if(d._isUint8Array(K))K=d._uint8ArrayToBuffer(K),ye="buffer";else throw new x("chunk",["string","Buffer","Uint8Array"],K);let oe;return ce.ending?oe=new N:ce.destroyed&&(oe=new C("write")),oe?(e.nextTick(Ne,oe),P(Ie,oe,!0),oe):(ce.pendingcb++,H(Ie,ce,K,ye,Ne))}Z.prototype.write=function(Ie,K,ye){return U(this,Ie,K,ye)===!0},Z.prototype.cork=function(){this._writableState.corked++},Z.prototype.uncork=function(){const Ie=this._writableState;Ie.corked&&(Ie.corked--,Ie.writing||pe(this,Ie))},Z.prototype.setDefaultEncoding=function(K){if(typeof K=="string"&&(K=o(K)),!h.isEncoding(K))throw new I(K);return this._writableState.defaultEncoding=K,this};function H(Ie,K,ye,Ne,ce){const oe=K.objectMode?1:ye.length;K.length+=oe;const re=K.length<K.highWaterMark;return re||(K.needDrain=!0),K.writing||K.corked||K.errored||!K.constructed?(K.buffered.push({chunk:ye,encoding:Ne,callback:ce}),K.allBuffers&&Ne!=="buffer"&&(K.allBuffers=!1),K.allNoop&&ce!==B&&(K.allNoop=!1)):(K.writelen=oe,K.writecb=ce,K.writing=!0,K.sync=!0,Ie._write(ye,Ne,K.onwrite),K.sync=!1),re&&!K.errored&&!K.destroyed}function L(Ie,K,ye,Ne,ce,oe,re){K.writelen=Ne,K.writecb=re,K.writing=!0,K.sync=!0,K.destroyed?K.onwrite(new C("write")):ye?Ie._writev(ce,K.onwrite):Ie._write(ce,oe,K.onwrite),K.sync=!1}function te(Ie,K,ye,Ne){--K.pendingcb,Ne(ye),se(K),P(Ie,ye)}function V(Ie,K){const ye=Ie._writableState,Ne=ye.sync,ce=ye.writecb;if(typeof ce!="function"){P(Ie,new S);return}ye.writing=!1,ye.writecb=null,ye.length-=ye.writelen,ye.writelen=0,K?(K.stack,ye.errored||(ye.errored=K),Ie._readableState&&!Ie._readableState.errored&&(Ie._readableState.errored=K),Ne?e.nextTick(te,Ie,ye,K,ce):te(Ie,ye,K,ce)):(ye.buffered.length>ye.bufferedIndex&&pe(Ie,ye),Ne?ye.afterWriteTickInfo!==null&&ye.afterWriteTickInfo.cb===ce?ye.afterWriteTickInfo.count++:(ye.afterWriteTickInfo={count:1,cb:ce,stream:Ie,state:ye},e.nextTick(Q,ye.afterWriteTickInfo)):ee(Ie,ye,1,ce))}function Q({stream:Ie,state:K,count:ye,cb:Ne}){return K.afterWriteTickInfo=null,ee(Ie,K,ye,Ne)}function ee(Ie,K,ye,Ne){for(!K.ending&&!Ie.destroyed&&K.length===0&&K.needDrain&&(K.needDrain=!1,Ie.emit("drain"));ye-- >0;)K.pendingcb--,Ne();K.destroyed&&se(K),Se(Ie,K)}function se(Ie){if(Ie.writing)return;for(let ce=Ie.bufferedIndex;ce<Ie.buffered.length;++ce){var K;const{chunk:oe,callback:re}=Ie.buffered[ce],Re=Ie.objectMode?1:oe.length;Ie.length-=Re,re((K=Ie.errored)!==null&&K!==void 0?K:new C("write"))}const ye=Ie[D].splice(0);for(let ce=0;ce<ye.length;ce++){var Ne;ye[ce]((Ne=Ie.errored)!==null&&Ne!==void 0?Ne:new C("end"))}O(Ie)}function pe(Ie,K){if(K.corked||K.bufferProcessing||K.destroyed||!K.constructed)return;const{buffered:ye,bufferedIndex:Ne,objectMode:ce}=K,oe=ye.length-Ne;if(!oe)return;let re=Ne;if(K.bufferProcessing=!0,oe>1&&Ie._writev){K.pendingcb-=oe-1;const Re=K.allNoop?B:Te=>{for(let lt=re;lt<ye.length;++lt)ye[lt].callback(Te)},Be=K.allNoop&&re===0?ye:t(ye,re);Be.allBuffers=K.allBuffers,L(Ie,K,!0,K.length,Be,"",Re),O(K)}else{do{const{chunk:Re,encoding:Be,callback:Te}=ye[re];ye[re++]=null;const lt=ce?1:Re.length;L(Ie,K,!1,lt,Re,Be,Te)}while(re<ye.length&&!K.writing);re===ye.length?O(K):re>256?(ye.splice(0,re),K.bufferedIndex=0):K.bufferedIndex=re}K.bufferProcessing=!1}Z.prototype._write=function(Ie,K,ye){if(this._writev)this._writev([{chunk:Ie,encoding:K}],ye);else throw new w("_write()")},Z.prototype._writev=null,Z.prototype.end=function(Ie,K,ye){const Ne=this._writableState;typeof Ie=="function"?(ye=Ie,Ie=null,K=null):typeof K=="function"&&(ye=K,K=null);let ce;if(Ie!=null){const oe=U(this,Ie,K);oe instanceof n&&(ce=oe)}return Ne.corked&&(Ne.corked=1,this.uncork()),ce||(!Ne.errored&&!Ne.ending?(Ne.ending=!0,Se(this,Ne,!0),Ne.ended=!0):Ne.finished?ce=new T("end"):Ne.destroyed&&(ce=new C("end"))),typeof ye=="function"&&(ce||Ne.finished?e.nextTick(ye,ce):Ne[D].push(ye)),this};function ue(Ie){return Ie.ending&&!Ie.destroyed&&Ie.constructed&&Ie.length===0&&!Ie.errored&&Ie.buffered.length===0&&!Ie.finished&&!Ie.writing&&!Ie.errorEmitted&&!Ie.closeEmitted}function Oe(Ie,K){let ye=!1;function Ne(ce){if(ye){P(Ie,ce??S());return}if(ye=!0,K.pendingcb--,ce){const oe=K[D].splice(0);for(let re=0;re<oe.length;re++)oe[re](ce);P(Ie,ce,K.sync)}else ue(K)&&(K.prefinished=!0,Ie.emit("prefinish"),K.pendingcb++,e.nextTick(Ce,Ie,K))}K.sync=!0,K.pendingcb++;try{Ie._final(Ne)}catch(ce){Ne(ce)}K.sync=!1}function Fe(Ie,K){!K.prefinished&&!K.finalCalled&&(typeof Ie._final=="function"&&!K.destroyed?(K.finalCalled=!0,Oe(Ie,K)):(K.prefinished=!0,Ie.emit("prefinish")))}function Se(Ie,K,ye){ue(K)&&(Fe(Ie,K),K.pendingcb===0&&(ye?(K.pendingcb++,e.nextTick((Ne,ce)=>{ue(ce)?Ce(Ne,ce):ce.pendingcb--},Ie,K)):ue(K)&&(K.pendingcb++,Ce(Ie,K))))}function Ce(Ie,K){K.pendingcb--,K.finished=!0;const ye=K[D].splice(0);for(let Ne=0;Ne<ye.length;Ne++)ye[Ne]();if(Ie.emit("finish"),K.autoDestroy){const Ne=Ie._readableState;(!Ne||Ne.autoDestroy&&(Ne.endEmitted||Ne.readable===!1))&&Ie.destroy()}}i(Z.prototype,{closed:{__proto__:null,get(){return this._writableState?this._writableState.closed:!1}},destroyed:{__proto__:null,get(){return this._writableState?this._writableState.destroyed:!1},set(Ie){this._writableState&&(this._writableState.destroyed=Ie)}},writable:{__proto__:null,get(){const Ie=this._writableState;return!!Ie&&Ie.writable!==!1&&!Ie.destroyed&&!Ie.errored&&!Ie.ending&&!Ie.ended},set(Ie){this._writableState&&(this._writableState.writable=!!Ie)}},writableFinished:{__proto__:null,get(){return this._writableState?this._writableState.finished:!1}},writableObjectMode:{__proto__:null,get(){return this._writableState?this._writableState.objectMode:!1}},writableBuffer:{__proto__:null,get(){return this._writableState&&this._writableState.getBuffer()}},writableEnded:{__proto__:null,get(){return this._writableState?this._writableState.ending:!1}},writableNeedDrain:{__proto__:null,get(){const Ie=this._writableState;return Ie?!Ie.destroyed&&!Ie.ending&&Ie.needDrain:!1}},writableHighWaterMark:{__proto__:null,get(){return this._writableState&&this._writableState.highWaterMark}},writableCorked:{__proto__:null,get(){return this._writableState?this._writableState.corked:0}},writableLength:{__proto__:null,get(){return this._writableState&&this._writableState.length}},errored:{__proto__:null,enumerable:!1,get(){return this._writableState?this._writableState.errored:null}},writableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(this._writableState.writable!==!1&&(this._writableState.destroyed||this._writableState.errored)&&!this._writableState.finished)}}});const qe=m.destroy;Z.prototype.destroy=function(Ie,K){const ye=this._writableState;return!ye.destroyed&&(ye.bufferedIndex<ye.buffered.length||ye[D].length)&&e.nextTick(se,ye),qe.call(this,Ie,K),this},Z.prototype._undestroy=m.undestroy,Z.prototype._destroy=function(Ie,K){K(Ie)},Z.prototype[u.captureRejectionSymbol]=function(Ie){this.destroy(Ie)};let Qe;function We(){return Qe===void 0&&(Qe={}),Qe}return Z.fromWeb=function(Ie,K){return We().newStreamWritableFromWritableStream(Ie,K)},Z.toWeb=function(Ie){return We().newWritableStreamFromStreamWritable(Ie)},CM}var kM,b9;function X_e(){if(b9)return kM;b9=1;const e=Xm(),t=Wh(),{isReadable:n,isWritable:r,isIterable:s,isNodeStream:i,isReadableNodeStream:a,isWritableNodeStream:o,isDuplexNodeStream:l,isReadableStream:c,isWritableStream:u}=af(),d=Hh(),{AbortError:h,codes:{ERR_INVALID_ARG_TYPE:m,ERR_INVALID_RETURN_VALUE:y}}=fo(),{destroyer:b}=Xy(),v=Zd(),x=YE(),w=JP(),{createDeferredPromise:S}=Io(),k=sY(),C=globalThis.Blob||t.Blob,T=typeof C<"u"?function(W){return W instanceof C}:function(W){return!1},R=globalThis.AbortController||hw().AbortController,{FunctionPrototypeCall:N}=ni();class I extends v{constructor(W){super(W),(W==null?void 0:W.readable)===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),(W==null?void 0:W.writable)===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)}}kM=function D(W,O){if(l(W))return W;if(a(W))return B({readable:W});if(o(W))return B({writable:W});if(i(W))return B({writable:!1,readable:!1});if(c(W))return B({readable:x.fromWeb(W)});if(u(W))return B({writable:w.fromWeb(W)});if(typeof W=="function"){const{value:U,write:H,final:L,destroy:te}=P(W);if(s(U))return k(I,U,{objectMode:!0,write:H,final:L,destroy:te});const V=U==null?void 0:U.then;if(typeof V=="function"){let Q;const ee=N(V,U,se=>{if(se!=null)throw new y("nully","body",se)},se=>{b(Q,se)});return Q=new I({objectMode:!0,readable:!1,write:H,final(se){L(async()=>{try{await ee,e.nextTick(se,null)}catch(pe){e.nextTick(se,pe)}})},destroy:te})}throw new y("Iterable, AsyncIterable or AsyncFunction",O,U)}if(T(W))return D(W.arrayBuffer());if(s(W))return k(I,W,{objectMode:!0,writable:!1});if(c(W==null?void 0:W.readable)&&u(W==null?void 0:W.writable))return I.fromWeb(W);if(typeof(W==null?void 0:W.writable)=="object"||typeof(W==null?void 0:W.readable)=="object"){const U=W!=null&&W.readable?a(W==null?void 0:W.readable)?W==null?void 0:W.readable:D(W.readable):void 0,H=W!=null&&W.writable?o(W==null?void 0:W.writable)?W==null?void 0:W.writable:D(W.writable):void 0;return B({readable:U,writable:H})}const Z=W==null?void 0:W.then;if(typeof Z=="function"){let U;return N(Z,W,H=>{H!=null&&U.push(H),U.push(null)},H=>{b(U,H)}),U=new I({objectMode:!0,writable:!1,read(){}})}throw new m(O,["Blob","ReadableStream","WritableStream","Stream","Iterable","AsyncIterable","Function","{ readable, writable } pair","Promise"],W)};function P(D){let{promise:W,resolve:O}=S();const Z=new R,U=Z.signal;return{value:D(async function*(){for(;;){const L=W;W=null;const{chunk:te,done:V,cb:Q}=await L;if(e.nextTick(Q),V)return;if(U.aborted)throw new h(void 0,{cause:U.reason});({promise:W,resolve:O}=S()),yield te}}(),{signal:U}),write(L,te,V){const Q=O;O=null,Q({chunk:L,done:!1,cb:V})},final(L){const te=O;O=null,te({done:!0,cb:L})},destroy(L,te){Z.abort(),te(L)}}}function B(D){const W=D.readable&&typeof D.readable.read!="function"?x.wrap(D.readable):D.readable,O=D.writable;let Z=!!n(W),U=!!r(O),H,L,te,V,Q;function ee(se){const pe=V;V=null,pe?pe(se):se&&Q.destroy(se)}return Q=new I({readableObjectMode:!!(W!=null&&W.readableObjectMode),writableObjectMode:!!(O!=null&&O.writableObjectMode),readable:Z,writable:U}),U&&(d(O,se=>{U=!1,se&&b(W,se),ee(se)}),Q._write=function(se,pe,ue){O.write(se,pe)?ue():H=ue},Q._final=function(se){O.end(),L=se},O.on("drain",function(){if(H){const se=H;H=null,se()}}),O.on("finish",function(){if(L){const se=L;L=null,se()}})),Z&&(d(W,se=>{Z=!1,se&&b(W,se),ee(se)}),W.on("readable",function(){if(te){const se=te;te=null,se()}}),W.on("end",function(){Q.push(null)}),Q._read=function(){for(;;){const se=W.read();if(se===null){te=Q._read;return}if(!Q.push(se))return}}),Q._destroy=function(se,pe){!se&&V!==null&&(se=new h),te=null,H=null,L=null,V===null?pe(se):(V=pe,b(O,se),b(W,se))},Q}return kM}var EM,v9;function Zd(){if(v9)return EM;v9=1;const{ObjectDefineProperties:e,ObjectGetOwnPropertyDescriptor:t,ObjectKeys:n,ObjectSetPrototypeOf:r}=ni();EM=a;const s=YE(),i=JP();r(a.prototype,s.prototype),r(a,s);{const u=n(i.prototype);for(let d=0;d<u.length;d++){const h=u[d];a.prototype[h]||(a.prototype[h]=i.prototype[h])}}function a(u){if(!(this instanceof a))return new a(u);s.call(this,u),i.call(this,u),u?(this.allowHalfOpen=u.allowHalfOpen!==!1,u.readable===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),u.writable===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)):this.allowHalfOpen=!0}e(a.prototype,{writable:{__proto__:null,...t(i.prototype,"writable")},writableHighWaterMark:{__proto__:null,...t(i.prototype,"writableHighWaterMark")},writableObjectMode:{__proto__:null,...t(i.prototype,"writableObjectMode")},writableBuffer:{__proto__:null,...t(i.prototype,"writableBuffer")},writableLength:{__proto__:null,...t(i.prototype,"writableLength")},writableFinished:{__proto__:null,...t(i.prototype,"writableFinished")},writableCorked:{__proto__:null,...t(i.prototype,"writableCorked")},writableEnded:{__proto__:null,...t(i.prototype,"writableEnded")},writableNeedDrain:{__proto__:null,...t(i.prototype,"writableNeedDrain")},destroyed:{__proto__:null,get(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set(u){this._readableState&&this._writableState&&(this._readableState.destroyed=u,this._writableState.destroyed=u)}}});let o;function l(){return o===void 0&&(o={}),o}a.fromWeb=function(u,d){return l().newStreamDuplexFromReadableWritablePair(u,d)},a.toWeb=function(u){return l().newReadableWritablePairFromDuplex(u)};let c;return a.from=function(u){return c||(c=X_e()),c(u,"body")},EM}var TM,x9;function iY(){if(x9)return TM;x9=1;const{ObjectSetPrototypeOf:e,Symbol:t}=ni();TM=a;const{ERR_METHOD_NOT_IMPLEMENTED:n}=fo().codes,r=Zd(),{getHighWaterMark:s}=KE();e(a.prototype,r.prototype),e(a,r);const i=t("kCallback");function a(c){if(!(this instanceof a))return new a(c);const u=c?s(this,c,"readableHighWaterMark",!0):null;u===0&&(c={...c,highWaterMark:null,readableHighWaterMark:u,writableHighWaterMark:c.writableHighWaterMark||0}),r.call(this,c),this._readableState.sync=!1,this[i]=null,c&&(typeof c.transform=="function"&&(this._transform=c.transform),typeof c.flush=="function"&&(this._flush=c.flush)),this.on("prefinish",l)}function o(c){typeof this._flush=="function"&&!this.destroyed?this._flush((u,d)=>{if(u){c?c(u):this.destroy(u);return}d!=null&&this.push(d),this.push(null),c&&c()}):(this.push(null),c&&c())}function l(){this._final!==o&&o.call(this)}return a.prototype._final=o,a.prototype._transform=function(c,u,d){throw new n("_transform()")},a.prototype._write=function(c,u,d){const h=this._readableState,m=this._writableState,y=h.length;this._transform(c,u,(b,v)=>{if(b){d(b);return}v!=null&&this.push(v),m.ended||y===h.length||h.length<h.highWaterMark?d():this[i]=d})},a.prototype._read=function(){if(this[i]){const c=this[i];this[i]=null,c()}},TM}var AM,w9;function aY(){if(w9)return AM;w9=1;const{ObjectSetPrototypeOf:e}=ni();AM=n;const t=iY();e(n.prototype,t.prototype),e(n,t);function n(r){if(!(this instanceof n))return new n(r);t.call(this,r)}return n.prototype._transform=function(r,s,i){i(null,r)},AM}var RM,_9;function QP(){if(_9)return RM;_9=1;const e=Xm(),{ArrayIsArray:t,Promise:n,SymbolAsyncIterator:r,SymbolDispose:s}=ni(),i=Hh(),{once:a}=Io(),o=Xy(),l=Zd(),{aggregateTwoErrors:c,codes:{ERR_INVALID_ARG_TYPE:u,ERR_INVALID_RETURN_VALUE:d,ERR_MISSING_ARGS:h,ERR_STREAM_DESTROYED:m,ERR_STREAM_PREMATURE_CLOSE:y},AbortError:b}=fo(),{validateFunction:v,validateAbortSignal:x}=C1(),{isIterable:w,isReadable:S,isReadableNodeStream:k,isNodeStream:C,isTransformStream:T,isWebStream:R,isReadableStream:N,isReadableFinished:I}=af(),P=globalThis.AbortController||hw().AbortController;let B,D,W;function O(se,pe,ue){let Oe=!1;se.on("close",()=>{Oe=!0});const Fe=i(se,{readable:pe,writable:ue},Se=>{Oe=!Se});return{destroy:Se=>{Oe||(Oe=!0,o.destroyer(se,Se||new m("pipe")))},cleanup:Fe}}function Z(se){return v(se[se.length-1],"streams[stream.length - 1]"),se.pop()}function U(se){if(w(se))return se;if(k(se))return H(se);throw new u("val",["Readable","Iterable","AsyncIterable"],se)}async function*H(se){D||(D=YE()),yield*D.prototype[r].call(se)}async function L(se,pe,ue,{end:Oe}){let Fe,Se=null;const Ce=We=>{if(We&&(Fe=We),Se){const Ie=Se;Se=null,Ie()}},qe=()=>new n((We,Ie)=>{Fe?Ie(Fe):Se=()=>{Fe?Ie(Fe):We()}});pe.on("drain",Ce);const Qe=i(pe,{readable:!1},Ce);try{pe.writableNeedDrain&&await qe();for await(const We of se)pe.write(We)||await qe();Oe&&(pe.end(),await qe()),ue()}catch(We){ue(Fe!==We?c(Fe,We):We)}finally{Qe(),pe.off("drain",Ce)}}async function te(se,pe,ue,{end:Oe}){T(pe)&&(pe=pe.writable);const Fe=pe.getWriter();try{for await(const Se of se)await Fe.ready,Fe.write(Se).catch(()=>{});await Fe.ready,Oe&&await Fe.close(),ue()}catch(Se){try{await Fe.abort(Se),ue(Se)}catch(Ce){ue(Ce)}}}function V(...se){return Q(se,a(Z(se)))}function Q(se,pe,ue){if(se.length===1&&t(se[0])&&(se=se[0]),se.length<2)throw new h("streams");const Oe=new P,Fe=Oe.signal,Se=ue==null?void 0:ue.signal,Ce=[];x(Se,"options.signal");function qe(){ce(new b)}W=W||Io().addAbortListener;let Qe;Se&&(Qe=W(Se,qe));let We,Ie;const K=[];let ye=0;function Ne(Be){ce(Be,--ye===0)}function ce(Be,Te){var lt;if(Be&&(!We||We.code==="ERR_STREAM_PREMATURE_CLOSE")&&(We=Be),!(!We&&!Te)){for(;K.length;)K.shift()(We);(lt=Qe)===null||lt===void 0||lt[s](),Oe.abort(),Te&&(We||Ce.forEach(Tt=>Tt()),e.nextTick(pe,We,Ie))}}let oe;for(let Be=0;Be<se.length;Be++){const Te=se[Be],lt=Be<se.length-1,Tt=Be>0,ut=lt||(ue==null?void 0:ue.end)!==!1,jt=Be===se.length-1;if(C(Te)){let qt=function(Ft){Ft&&Ft.name!=="AbortError"&&Ft.code!=="ERR_STREAM_PREMATURE_CLOSE"&&Ne(Ft)};if(ut){const{destroy:Ft,cleanup:Ht}=O(Te,lt,Tt);K.push(Ft),S(Te)&&jt&&Ce.push(Ht)}Te.on("error",qt),S(Te)&&jt&&Ce.push(()=>{Te.removeListener("error",qt)})}if(Be===0)if(typeof Te=="function"){if(oe=Te({signal:Fe}),!w(oe))throw new d("Iterable, AsyncIterable or Stream","source",oe)}else w(Te)||k(Te)||T(Te)?oe=Te:oe=l.from(Te);else if(typeof Te=="function"){if(T(oe)){var re;oe=U((re=oe)===null||re===void 0?void 0:re.readable)}else oe=U(oe);if(oe=Te(oe,{signal:Fe}),lt){if(!w(oe,!0))throw new d("AsyncIterable",`transform[${Be-1}]`,oe)}else{var Re;B||(B=aY());const qt=new B({objectMode:!0}),Ft=(Re=oe)===null||Re===void 0?void 0:Re.then;if(typeof Ft=="function")ye++,Ft.call(oe,F=>{Ie=F,F!=null&&qt.write(F),ut&&qt.end(),e.nextTick(Ne)},F=>{qt.destroy(F),e.nextTick(Ne,F)});else if(w(oe,!0))ye++,L(oe,qt,Ne,{end:ut});else if(N(oe)||T(oe)){const F=oe.readable||oe;ye++,L(F,qt,Ne,{end:ut})}else throw new d("AsyncIterable or Promise","destination",oe);oe=qt;const{destroy:Ht,cleanup:we}=O(oe,!1,!0);K.push(Ht),jt&&Ce.push(we)}}else if(C(Te)){if(k(oe)){ye+=2;const qt=ee(oe,Te,Ne,{end:ut});S(Te)&&jt&&Ce.push(qt)}else if(T(oe)||N(oe)){const qt=oe.readable||oe;ye++,L(qt,Te,Ne,{end:ut})}else if(w(oe))ye++,L(oe,Te,Ne,{end:ut});else throw new u("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],oe);oe=Te}else if(R(Te)){if(k(oe))ye++,te(U(oe),Te,Ne,{end:ut});else if(N(oe)||w(oe))ye++,te(oe,Te,Ne,{end:ut});else if(T(oe))ye++,te(oe.readable,Te,Ne,{end:ut});else throw new u("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],oe);oe=Te}else oe=l.from(Te)}return(Fe!=null&&Fe.aborted||Se!=null&&Se.aborted)&&e.nextTick(qe),oe}function ee(se,pe,ue,{end:Oe}){let Fe=!1;if(pe.on("close",()=>{Fe||ue(new y)}),se.pipe(pe,{end:!1}),Oe){let Se=function(){Fe=!0,pe.end()};I(se)?e.nextTick(Se):se.once("end",Se)}else ue();return i(se,{readable:!0,writable:!1},Se=>{const Ce=se._readableState;Se&&Se.code==="ERR_STREAM_PREMATURE_CLOSE"&&Ce&&Ce.ended&&!Ce.errored&&!Ce.errorEmitted?se.once("end",ue).once("error",ue):ue(Se)}),i(pe,{readable:!1,writable:!0},ue)}return RM={pipelineImpl:Q,pipeline:V},RM}var NM,S9;function oY(){if(S9)return NM;S9=1;const{pipeline:e}=QP(),t=Zd(),{destroyer:n}=Xy(),{isNodeStream:r,isReadable:s,isWritable:i,isWebStream:a,isTransformStream:o,isWritableStream:l,isReadableStream:c}=af(),{AbortError:u,codes:{ERR_INVALID_ARG_VALUE:d,ERR_MISSING_ARGS:h}}=fo(),m=Hh();return NM=function(...b){if(b.length===0)throw new h("streams");if(b.length===1)return t.from(b[0]);const v=[...b];if(typeof b[0]=="function"&&(b[0]=t.from(b[0])),typeof b[b.length-1]=="function"){const B=b.length-1;b[B]=t.from(b[B])}for(let B=0;B<b.length;++B)if(!(!r(b[B])&&!a(b[B]))){if(B<b.length-1&&!(s(b[B])||c(b[B])||o(b[B])))throw new d(`streams[${B}]`,v[B],"must be readable");if(B>0&&!(i(b[B])||l(b[B])||o(b[B])))throw new d(`streams[${B}]`,v[B],"must be writable")}let x,w,S,k,C;function T(B){const D=k;k=null,D?D(B):B?C.destroy(B):!P&&!I&&C.destroy()}const R=b[0],N=e(b,T),I=!!(i(R)||l(R)||o(R)),P=!!(s(N)||c(N)||o(N));if(C=new t({writableObjectMode:!!(R!=null&&R.writableObjectMode),readableObjectMode:!!(N!=null&&N.readableObjectMode),writable:I,readable:P}),I){if(r(R))C._write=function(D,W,O){R.write(D,W)?O():x=O},C._final=function(D){R.end(),w=D},R.on("drain",function(){if(x){const D=x;x=null,D()}});else if(a(R)){const W=(o(R)?R.writable:R).getWriter();C._write=async function(O,Z,U){try{await W.ready,W.write(O).catch(()=>{}),U()}catch(H){U(H)}},C._final=async function(O){try{await W.ready,W.close().catch(()=>{}),w=O}catch(Z){O(Z)}}}const B=o(N)?N.readable:N;m(B,()=>{if(w){const D=w;w=null,D()}})}if(P){if(r(N))N.on("readable",function(){if(S){const B=S;S=null,B()}}),N.on("end",function(){C.push(null)}),C._read=function(){for(;;){const B=N.read();if(B===null){S=C._read;return}if(!C.push(B))return}};else if(a(N)){const D=(o(N)?N.readable:N).getReader();C._read=async function(){for(;;)try{const{value:W,done:O}=await D.read();if(!C.push(W))return;if(O){C.push(null);return}}catch{return}}}}return C._destroy=function(B,D){!B&&k!==null&&(B=new u),S=null,x=null,w=null,k===null?D(B):(k=D,r(N)&&n(N,B))},C},NM}var C9;function J_e(){if(C9)return FS;C9=1;const e=globalThis.AbortController||hw().AbortController,{codes:{ERR_INVALID_ARG_VALUE:t,ERR_INVALID_ARG_TYPE:n,ERR_MISSING_ARGS:r,ERR_OUT_OF_RANGE:s},AbortError:i}=fo(),{validateAbortSignal:a,validateInteger:o,validateObject:l}=C1(),c=ni().Symbol("kWeak"),u=ni().Symbol("kResistStopPropagation"),{finished:d}=Hh(),h=oY(),{addAbortSignalNoValidate:m}=GE(),{isWritable:y,isNodeStream:b}=af(),{deprecate:v}=Io(),{ArrayPrototypePush:x,Boolean:w,MathFloor:S,Number:k,NumberIsNaN:C,Promise:T,PromiseReject:R,PromiseResolve:N,PromisePrototypeThen:I,Symbol:P}=ni(),B=P("kEmpty"),D=P("kEof");function W(Se,Ce){if(Ce!=null&&l(Ce,"options"),(Ce==null?void 0:Ce.signal)!=null&&a(Ce.signal,"options.signal"),b(Se)&&!y(Se))throw new t("stream",Se,"must be writable");const qe=h(this,Se);return Ce!=null&&Ce.signal&&m(Ce.signal,qe),qe}function O(Se,Ce){if(typeof Se!="function")throw new n("fn",["Function","AsyncFunction"],Se);Ce!=null&&l(Ce,"options"),(Ce==null?void 0:Ce.signal)!=null&&a(Ce.signal,"options.signal");let qe=1;(Ce==null?void 0:Ce.concurrency)!=null&&(qe=S(Ce.concurrency));let Qe=qe-1;return(Ce==null?void 0:Ce.highWaterMark)!=null&&(Qe=S(Ce.highWaterMark)),o(qe,"options.concurrency",1),o(Qe,"options.highWaterMark",0),Qe+=qe,(async function*(){const Ie=Io().AbortSignalAny([Ce==null?void 0:Ce.signal].filter(w)),K=this,ye=[],Ne={signal:Ie};let ce,oe,re=!1,Re=0;function Be(){re=!0,Te()}function Te(){Re-=1,lt()}function lt(){oe&&!re&&Re<qe&&ye.length<Qe&&(oe(),oe=null)}async function Tt(){try{for await(let ut of K){if(re)return;if(Ie.aborted)throw new i;try{if(ut=Se(ut,Ne),ut===B)continue;ut=N(ut)}catch(jt){ut=R(jt)}Re+=1,I(ut,Te,Be),ye.push(ut),ce&&(ce(),ce=null),!re&&(ye.length>=Qe||Re>=qe)&&await new T(jt=>{oe=jt})}ye.push(D)}catch(ut){const jt=R(ut);I(jt,Te,Be),ye.push(jt)}finally{re=!0,ce&&(ce(),ce=null)}}Tt();try{for(;;){for(;ye.length>0;){const ut=await ye[0];if(ut===D)return;if(Ie.aborted)throw new i;ut!==B&&(yield ut),ye.shift(),lt()}await new T(ut=>{ce=ut})}}finally{re=!0,oe&&(oe(),oe=null)}}).call(this)}function Z(Se=void 0){return Se!=null&&l(Se,"options"),(Se==null?void 0:Se.signal)!=null&&a(Se.signal,"options.signal"),(async function*(){let qe=0;for await(const We of this){var Qe;if(Se!=null&&(Qe=Se.signal)!==null&&Qe!==void 0&&Qe.aborted)throw new i({cause:Se.signal.reason});yield[qe++,We]}}).call(this)}async function U(Se,Ce=void 0){for await(const qe of V.call(this,Se,Ce))return!0;return!1}async function H(Se,Ce=void 0){if(typeof Se!="function")throw new n("fn",["Function","AsyncFunction"],Se);return!await U.call(this,async(...qe)=>!await Se(...qe),Ce)}async function L(Se,Ce){for await(const qe of V.call(this,Se,Ce))return qe}async function te(Se,Ce){if(typeof Se!="function")throw new n("fn",["Function","AsyncFunction"],Se);async function qe(Qe,We){return await Se(Qe,We),B}for await(const Qe of O.call(this,qe,Ce));}function V(Se,Ce){if(typeof Se!="function")throw new n("fn",["Function","AsyncFunction"],Se);async function qe(Qe,We){return await Se(Qe,We)?Qe:B}return O.call(this,qe,Ce)}class Q extends r{constructor(){super("reduce"),this.message="Reduce of an empty stream requires an initial value"}}async function ee(Se,Ce,qe){var Qe;if(typeof Se!="function")throw new n("reducer",["Function","AsyncFunction"],Se);qe!=null&&l(qe,"options"),(qe==null?void 0:qe.signal)!=null&&a(qe.signal,"options.signal");let We=arguments.length>1;if(qe!=null&&(Qe=qe.signal)!==null&&Qe!==void 0&&Qe.aborted){const ce=new i(void 0,{cause:qe.signal.reason});throw this.once("error",()=>{}),await d(this.destroy(ce)),ce}const Ie=new e,K=Ie.signal;if(qe!=null&&qe.signal){const ce={once:!0,[c]:this,[u]:!0};qe.signal.addEventListener("abort",()=>Ie.abort(),ce)}let ye=!1;try{for await(const ce of this){var Ne;if(ye=!0,qe!=null&&(Ne=qe.signal)!==null&&Ne!==void 0&&Ne.aborted)throw new i;We?Ce=await Se(Ce,ce,{signal:K}):(Ce=ce,We=!0)}if(!ye&&!We)throw new Q}finally{Ie.abort()}return Ce}async function se(Se){Se!=null&&l(Se,"options"),(Se==null?void 0:Se.signal)!=null&&a(Se.signal,"options.signal");const Ce=[];for await(const Qe of this){var qe;if(Se!=null&&(qe=Se.signal)!==null&&qe!==void 0&&qe.aborted)throw new i(void 0,{cause:Se.signal.reason});x(Ce,Qe)}return Ce}function pe(Se,Ce){const qe=O.call(this,Se,Ce);return(async function*(){for await(const We of qe)yield*We}).call(this)}function ue(Se){if(Se=k(Se),C(Se))return 0;if(Se<0)throw new s("number",">= 0",Se);return Se}function Oe(Se,Ce=void 0){return Ce!=null&&l(Ce,"options"),(Ce==null?void 0:Ce.signal)!=null&&a(Ce.signal,"options.signal"),Se=ue(Se),(async function*(){var Qe;if(Ce!=null&&(Qe=Ce.signal)!==null&&Qe!==void 0&&Qe.aborted)throw new i;for await(const Ie of this){var We;if(Ce!=null&&(We=Ce.signal)!==null&&We!==void 0&&We.aborted)throw new i;Se--<=0&&(yield Ie)}}).call(this)}function Fe(Se,Ce=void 0){return Ce!=null&&l(Ce,"options"),(Ce==null?void 0:Ce.signal)!=null&&a(Ce.signal,"options.signal"),Se=ue(Se),(async function*(){var Qe;if(Ce!=null&&(Qe=Ce.signal)!==null&&Qe!==void 0&&Qe.aborted)throw new i;for await(const Ie of this){var We;if(Ce!=null&&(We=Ce.signal)!==null&&We!==void 0&&We.aborted)throw new i;if(Se-- >0&&(yield Ie),Se<=0)return}}).call(this)}return FS.streamReturningOperators={asIndexedPairs:v(Z,"readable.asIndexedPairs will be removed in a future version."),drop:Oe,filter:V,flatMap:pe,map:O,take:Fe,compose:W},FS.promiseReturningOperators={every:H,forEach:te,reduce:ee,toArray:se,some:U,find:L},FS}var MM,k9;function lY(){if(k9)return MM;k9=1;const{ArrayPrototypePop:e,Promise:t}=ni(),{isIterable:n,isNodeStream:r,isWebStream:s}=af(),{pipelineImpl:i}=QP(),{finished:a}=Hh();cY();function o(...l){return new t((c,u)=>{let d,h;const m=l[l.length-1];if(m&&typeof m=="object"&&!r(m)&&!n(m)&&!s(m)){const y=e(l);d=y.signal,h=y.end}i(l,(y,b)=>{y?u(y):c(b)},{signal:d,end:h})})}return MM={finished:a,pipeline:o},MM}var E9;function cY(){if(E9)return oM.exports;E9=1;const{Buffer:e}=Wh(),{ObjectDefineProperty:t,ObjectKeys:n,ReflectApply:r}=ni(),{promisify:{custom:s}}=Io(),{streamReturningOperators:i,promiseReturningOperators:a}=J_e(),{codes:{ERR_ILLEGAL_CONSTRUCTOR:o}}=fo(),l=oY(),{setDefaultHighWaterMark:c,getDefaultHighWaterMark:u}=KE(),{pipeline:d}=QP(),{destroyer:h}=Xy(),m=Hh(),y=lY(),b=af(),v=oM.exports=ZP().Stream;v.isDestroyed=b.isDestroyed,v.isDisturbed=b.isDisturbed,v.isErrored=b.isErrored,v.isReadable=b.isReadable,v.isWritable=b.isWritable,v.Readable=YE();for(const w of n(i)){let k=function(...C){if(new.target)throw o();return v.Readable.from(r(S,this,C))};const S=i[w];t(k,"name",{__proto__:null,value:S.name}),t(k,"length",{__proto__:null,value:S.length}),t(v.Readable.prototype,w,{__proto__:null,value:k,enumerable:!1,configurable:!0,writable:!0})}for(const w of n(a)){let k=function(...C){if(new.target)throw o();return r(S,this,C)};const S=a[w];t(k,"name",{__proto__:null,value:S.name}),t(k,"length",{__proto__:null,value:S.length}),t(v.Readable.prototype,w,{__proto__:null,value:k,enumerable:!1,configurable:!0,writable:!0})}v.Writable=JP(),v.Duplex=Zd(),v.Transform=iY(),v.PassThrough=aY(),v.pipeline=d;const{addAbortSignal:x}=GE();return v.addAbortSignal=x,v.finished=m,v.destroy=h,v.compose=l,v.setDefaultHighWaterMark=c,v.getDefaultHighWaterMark=u,t(v,"promises",{__proto__:null,configurable:!0,enumerable:!0,get(){return y}}),t(d,s,{__proto__:null,enumerable:!0,get(){return y.pipeline}}),t(m,s,{__proto__:null,enumerable:!0,get(){return y.finished}}),v.Stream=v,v._isUint8Array=function(S){return S instanceof Uint8Array},v._uint8ArrayToBuffer=function(S){return e.from(S.buffer,S.byteOffset,S.byteLength)},oM.exports}var T9;function Q_e(){return T9||(T9=1,function(e){const t=cY(),n=lY(),r=t.Readable.destroy;e.exports=t.Readable,e.exports._uint8ArrayToBuffer=t._uint8ArrayToBuffer,e.exports._isUint8Array=t._isUint8Array,e.exports.isDisturbed=t.isDisturbed,e.exports.isErrored=t.isErrored,e.exports.isReadable=t.isReadable,e.exports.Readable=t.Readable,e.exports.Writable=t.Writable,e.exports.Duplex=t.Duplex,e.exports.Transform=t.Transform,e.exports.PassThrough=t.PassThrough,e.exports.addAbortSignal=t.addAbortSignal,e.exports.finished=t.finished,e.exports.destroy=t.destroy,e.exports.destroy=r,e.exports.pipeline=t.pipeline,e.exports.compose=t.compose,Object.defineProperty(t,"promises",{configurable:!0,enumerable:!0,get(){return n}}),e.exports.Stream=t.Stream,e.exports.default=e.exports}(aM)),aM.exports}var uY=Q_e();class eD extends uY.Readable{constructor(t={},n){var r;super({...t,encoding:(r=t.encoding)!==null&&r!==void 0?r:void 0}),this.pending=!0,this._path="<unknown>",this._bytesRead=0,this.ready=Promise.resolve(n).then(s=>{this._path=s.path;const i=s.readableWebStream({start:t.start,end:t.end});this.reader=i.getReader(),this.pending=!1}).catch(s=>{this.destroy(s)})}async _read(){try{if(await this.ready,!this.reader)return;const{done:t,value:n}=await this.reader.read();if(t){this.push(null);return}this._bytesRead+=n.byteLength,this.push(n)}catch(t){this.destroy(new Ze(bt.EIO,t.toString()))}}close(t=()=>null){try{this.destroy(),this.emit("close"),t(null)}catch(n){t(new Ze(bt.EIO,n.toString()))}}get path(){return this._path}get bytesRead(){return this._bytesRead}wrap(t){return super.wrap(t),this}}class tD extends uY.Writable{constructor(t={},n){super(t),this.pending=!0,this._path="<unknown>",this._bytesWritten=0,this.ready=Promise.resolve(n).then(r=>{this._path=r.path;const s=r.writableWebStream({start:t.start});this.writer=s.getWriter(),this.pending=!1}).catch(r=>this.destroy(r))}async _write(t,n,r){if(await this.ready,!this.writer)return r(Fa(new Ze(bt.EAGAIN,"Underlying writable stream not ready",this._path)));if(n!="buffer")return r(Fa(new Ze(bt.ENOTSUP,"Unsupported encoding for stream",this._path)));const s=new Uint8Array(t.buffer,t.byteOffset,t.byteLength);try{await this.writer.write(s),this._bytesWritten+=t.byteLength,r()}catch(i){r(new Ze(bt.EIO,i.toString()))}}async _final(t){if(await this.ready,!this.writer)return t();try{await this.writer.close(),t()}catch(n){t(new Ze(bt.EIO,n.toString()))}}close(t=()=>null){try{this.destroy(),this.emit("close"),t(null)}catch(n){t(new Ze(bt.EIO,n.toString()))}}get path(){return this._path}get bytesWritten(){return this._bytesWritten}}var ec=function(e,t,n){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var r,s;if(n){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=t[Symbol.asyncDispose]}if(r===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=t[Symbol.dispose],n&&(s=r)}if(typeof r!="function")throw new TypeError("Object not disposable.");s&&(r=function(){try{s.call(this)}catch(i){return Promise.reject(i)}}),e.stack.push({value:t,dispose:r,async:n})}else n&&e.stack.push({async:!0});return t},tc=function(e){return function(t){function n(a){t.error=t.hasError?new e(a,t.error,"An error was suppressed during disposal."):a,t.hasError=!0}var r,s=0;function i(){for(;r=t.stack.pop();)try{if(!r.async&&s===1)return s=0,t.stack.push(r),Promise.resolve().then(i);if(r.dispose){var a=r.dispose.call(r.value);if(r.async)return s|=2,Promise.resolve(a).then(i,function(o){return n(o),i()})}else s|=1}catch(o){n(o)}if(s===1)return t.hasError?Promise.reject(t.error):Promise.resolve();if(t.hasError)throw t.error}return i()}}(typeof SuppressedError=="function"?SuppressedError:function(e,t,n){var r=new Error(n);return r.name="SuppressedError",r.error=e,r.suppressed=t,r});class $a{get position(){return this.flag&Tm?this.inode.size:this._position}set position(t){this._position=t}constructor(t,n){this.context=t,this.fd=n,this._position=0,this.dirty=!1,this.closed=!1;const r=qa(t,n);Object.assign(this,Um(r,"path","fs","internalPath","flag","inode"))}get _isSync(){return!!(this.flag&qE||this.inode.flags&Eo.Sync)}_emitChange(){ka(this.context,"change",this.path)}async chown(t,n){if(this.closed)throw Ze.With("EBADF",this.path,"chown");this.dirty=!0,UK(this.inode,t,n),this._isSync&&await this.sync(),this._emitChange()}async chmod(t){const n=qh(t,-1);if(n<0)throw new Ze(bt.EINVAL,"Invalid mode");if(this.closed)throw Ze.With("EBADF",this.path,"chmod");this.dirty=!0,this.inode.mode=this.inode.mode&(n>ks?-61441:ks)|n,(this._isSync||n>ks)&&await this.sync(),this._emitChange()}datasync(){return this.sync()}async sync(){if(this.closed)throw Ze.With("EBADF",this.path,"sync");this.dirty&&(this.fs.attributes.has("no_write")||await this.fs.touch(this.internalPath,this.inode),this.dirty=!1)}async truncate(t=0){if(this.closed)throw Ze.With("EBADF",this.path,"truncate");if(t<0)throw new Ze(bt.EINVAL);if(this.dirty=!0,!(this.flag&Da||this.flag&Fd))throw new Ze(bt.EPERM,"File not opened with a writeable mode",this.path,"truncate");this.inode.mtimeMs=Date.now(),this.inode.size=t,this._isSync&&await this.sync(),this._emitChange()}async utimes(t,n){if(this.closed)throw Ze.With("EBADF",this.path,"utimes");this.dirty=!0,this.inode.atimeMs=zC(t),this.inode.mtimeMs=zC(n),this._isSync&&await this.sync(),this._emitChange()}async appendFile(t,n={}){const r=Ld(n,"utf8","a",420);if(!(Bd(r.flag)&Tm))throw new Ze(bt.EINVAL,"Flag passed to appendFile must allow for appending");if(typeof t!="string"&&!r.encoding)throw new Ze(bt.EINVAL,"Encoding not specified");const i=typeof t=="string"?Ds.from(t,r.encoding):t;await this._write(i,0,i.length),this._emitChange()}async _read(t,n=0,r=t.byteLength-n,s=this.position){if(this.closed)throw Ze.With("EBADF",this.path,"read");if(this.flag&Da)throw new Ze(bt.EPERM,"File not opened with a readable mode");this.inode.flags&Eo.NoAtime||(this.dirty=!0,this.inode.atimeMs=Date.now());let i=s+r;!uw(this.inode)&&!cw(this.inode)&&i>this.inode.size&&(i=s+Math.max(this.inode.size-s,0)),this._position=i;const a=new Uint8Array(t.buffer,t.byteOffset,t.byteLength);return await this.fs.read(this.internalPath,a.subarray(n,n+r),s,i),this._isSync&&await this.sync(),{bytesRead:i-s,buffer:t}}async read(t,n,r,s){typeof n=="object"&&n!=null&&(s=n.position,r=n.length,n=n.offset),!ArrayBuffer.isView(t)&&typeof t=="object"&&(s=t.position,r=t.length,n=t.offset,t=t.buffer);const i=Number.isSafeInteger(s)?s:this.position;return t||(t=new Uint8Array(this.inode.size)),n??(n=0),this._read(t,n,r??t.byteLength-n,i)}async readFile(t){const n=Ld(t,null,"r",292);if(Bd(n.flag)&Da)throw new Ze(bt.EINVAL,"Flag passed must allow for reading",this.path,"readFile");const{size:s}=await this.stat(),{buffer:i}=await this._read(new Uint8Array(s),0,s,0),a=Ds.from(i);return n.encoding?a.toString(n.encoding):a}readableWebStream(t={}){if(this.closed)throw Ze.With("EBADF",this.path,"readableWebStream");return this.fs.streamRead(this.internalPath,t)}writableWebStream(t={}){if(this.closed)throw Ze.With("EBADF",this.path,"writableWebStream");if(this.inode.flags&Eo.Immutable)throw new Ze(bt.EPERM,"File is immutable",this.path,"writableWebStream");return this.fs.streamWrite(this.internalPath,t)}readLines(t){if(this.closed||this.flag&Da)throw Ze.With("EBADF",this.path,"readLines");return b_e({input:this.createReadStream(t),crlfDelay:1/0})}[Symbol.asyncDispose](){return this.close()}async stat(t){if(this.closed)throw Ze.With("EBADF",this.path,"stat");if(!hs(this.context,this.inode,Wi))throw Ze.With("EACCES",this.path,"stat");return t!=null&&t.bigint?new Km(this.inode):new sf(this.inode)}async _write(t,n=0,r=t.byteLength-n,s=this.position){if(this.closed)throw Ze.With("EBADF",this.path,"write");if(this.inode.flags&Eo.Immutable)throw new Ze(bt.EPERM,"File is immutable",this.path,"write");if(!(this.flag&Da||this.flag&Fd))throw new Ze(bt.EPERM,"File not opened with a writeable mode",this.path,"write");this.dirty=!0;const i=s+r,a=t.subarray(n,n+r);return!uw(this.inode)&&!cw(this.inode)&&i>this.inode.size&&(this.inode.size=i),this.inode.mtimeMs=Date.now(),this.inode.ctimeMs=Date.now(),this._position=s+a.byteLength,await this.fs.write(this.internalPath,a,s),this._isSync&&await this.sync(),a.byteLength}async write(t,n,r,s){let i,a,o;typeof n=="object"&&n!=null&&(r=n.length,s=n.position,n=n.offset),typeof t=="string"?(s=typeof n=="number"?n:null,a=0,i=Ds.from(t,typeof r=="string"?r:"utf8"),o=i.length):(i=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),a=n??0,o=typeof r=="number"?r:i.byteLength,s=typeof s=="number"?s:null),s??(s=this.position);const l=await this._write(i,a,o,s);return this._emitChange(),{buffer:t,bytesWritten:l}}async writeFile(t,n={}){const r=Ld(n,"utf8","w",420),s=Bd(r.flag);if(!(s&Da||s&Fd))throw new Ze(bt.EINVAL,"Flag passed must allow for writing",this.path,"writeFile");if(typeof t!="string"&&!r.encoding)throw new Ze(bt.EINVAL,"Encoding not specified");const i=typeof t=="string"?Ds.from(t,r.encoding):t;await this._write(i,0,i.length,0),this._emitChange()}async close(){if(this.closed)throw Ze.With("EBADF",this.path,"close");await this.sync(),this.dispose(),WK(this.context,this.fd)}dispose(t){if(this.closed)throw Ze.With("EBADF",this.path,"dispose");if(this.dirty&&!t)throw Ze.With("EBUSY",this.path,"dispose");this.closed=!0}async writev(t,n){typeof n=="number"&&(this.position=n);let r=0;for(const s of t)r+=(await this.write(s)).bytesWritten;return{bytesWritten:r,buffers:t}}async readv(t,n){typeof n=="number"&&(this.position=n);let r=0;for(const s of t)r+=(await this.read(s)).bytesRead;return{bytesRead:r,buffers:t}}createReadStream(t={}){if(this.closed||this.flag&Da)throw Ze.With("EBADF",this.path,"createReadStream");return new eD(t,this)}createWriteStream(t={}){if(this.closed)throw Ze.With("EBADF",this.path,"createWriteStream");if(this.inode.flags&Eo.Immutable)throw new Ze(bt.EPERM,"File is immutable",this.path,"createWriteStream");return new tD(t,this)}}async function dY(e,t){e=Ln(e),t=Ln(t);const n=Mr(e,this),r=Mr(t,this);if(!(await Jy.call(this,Yr(e))).hasAccess(ci,this))throw Ze.With("EACCES",e,"rename");try{if(n.mountPoint==r.mountPoint){await n.fs.rename(n.path,r.path),ka(this,"rename",e.toString()),ka(this,"change",t.toString());return}await QE.call(this,t,await JE(e)),await XE.call(this,e),ka(this,"rename",e.toString())}catch(s){throw ps(s,{[n.path]:e,[r.path]:t})}}async function k1(e){try{const{fs:t,path:n}=Mr(await Gh.call(this,e),this);return await t.exists(n)}catch(t){if(t instanceof Ze&&t.code=="ENOENT")return!1;throw t}}async function Jy(e,t){e=Ln(e);const{fs:n,path:r}=Mr(await Gh.call(this,e),this);try{const s=await n.stat(r);if(Hi&&!hs(this,s,Wi))throw Ze.With("EACCES",r,"stat");return t!=null&&t.bigint?new Km(s):new sf(s)}catch(s){throw ps(s,{[r]:e})}}async function ZE(e,t){e=Ln(e);const{fs:n,path:r}=Mr(e,this);try{const s=await n.stat(r);if(Hi&&!hs(this,s,Wi))throw Ze.With("EACCES",r,"lstat");return t!=null&&t.bigint?new Km(s):new sf(s)}catch(s){throw ps(s,{[r]:e})}}async function fY(e,t=0){const n={stack:[],error:void 0,hasError:!1};try{await ec(n,await nc.call(this,e,"r+"),!0).truncate(t)}catch(r){n.error=r,n.hasError=!0}finally{const r=tc(n);r&&await r}}async function XE(e){e=Ln(e);const{fs:t,path:n}=Mr(e,this);try{if(Hi&&!hs(this,await t.stat(n),ci))throw Ze.With("EACCES",n,"unlink");await t.unlink(n),ka(this,"rename",e.toString())}catch(r){throw ps(r,{[n]:e})}}async function Qy(e,t,n){var r;t=Ln(t);const s=qh(n.mode,420),i=Bd(n.flag),{fullPath:a,fs:o,path:l,stats:c}=await WC(e,t.toString(),n.preserveSymlinks);if(!c){if(!(i&$E))throw Ze.With("ENOENT",a,"_open");const d=await o.stat(Yr(l));if(!hs(e,d,ci))throw Ze.With("EACCES",Yr(a),"_open");if(!Lc(d))throw Ze.With("ENOTDIR",Yr(a),"_open");const{euid:h,egid:m}=(r=e==null?void 0:e.credentials)!==null&&r!==void 0?r:Uc.credentials,y=await o.createFile(l,{mode:s,uid:d.mode&x1?d.uid:h,gid:d.mode&w1?d.gid:m});return new $a(e,qC(new UC(e,t,o,l,i,y)))}if(!hs(e,c,HK(i)))throw Ze.With("EACCES",a,"_open");if(i&zE)throw Ze.With("EEXIST",a,"_open");const u=new $a(e,qC(new UC(e,t,o,l,i,c)));return i&UE&&await u.truncate(0),u}async function nc(e,t="r",n=420){return await Qy(this,e,{flag:t,mode:n})}async function JE(e,t){const n={stack:[],error:void 0,hasError:!1};try{const r=Ld(t,null,"r",292);return await ec(n,typeof e=="object"&&"fd"in e?e:await nc.call(this,e,r.flag,r.mode),!0).readFile(r)}catch(r){n.error=r,n.hasError=!0}finally{const r=tc(n);r&&await r}}async function QE(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{const s=Ld(n,"utf8","w+",420),i=ec(r,e instanceof $a?e:await nc.call(this,e.toString(),s.flag,s.mode),!0),a=typeof t=="string"?t:t instanceof DataView?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t;if(typeof a!="string"&&!(a instanceof Uint8Array))throw new Ze(bt.EINVAL,'The "data" argument must be of type string or an instance of Buffer, TypedArray, or DataView. Received '+typeof t,i.path,"writeFile");await i.writeFile(a,s)}catch(s){r.error=s,r.hasError=!0}finally{const s=tc(r);s&&await s}}async function hY(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{const s=Ld(n,"utf8","a",420);if(!(Bd(s.flag)&Tm))throw new Ze(bt.EINVAL,"Flag passed to appendFile must allow for appending");if(typeof t!="string"&&!s.encoding)throw new Ze(bt.EINVAL,"Encoding not specified");const a=typeof t=="string"?Ds.from(t,s.encoding):new Uint8Array(t.buffer,t.byteOffset,t.byteLength);await ec(r,typeof e=="object"&&"fd"in e?e:await nc.call(this,e,s.flag,s.mode),!0).appendFile(a,s)}catch(s){r.error=s,r.hasError=!0}finally{const s=tc(r);s&&await s}}async function nD(e){e=await Gh.call(this,e);const{fs:t,path:n}=Mr(e,this);try{const r=await t.stat(n);if(!r)throw Ze.With("ENOENT",e,"rmdir");if(!Lc(r))throw Ze.With("ENOTDIR",n,"rmdir");if(Hi&&!hs(this,r,ci))throw Ze.With("EACCES",n,"rmdir");await t.rmdir(n),ka(this,"rename",e.toString())}catch(r){throw ps(r,{[n]:e})}}async function eT(e,t){var n,r;const{euid:s,egid:i}=(n=this===null||this===void 0?void 0:this.credentials)!==null&&n!==void 0?n:Uc.credentials;t=typeof t=="object"?t:{mode:t};const a=qh(t==null?void 0:t.mode,511);e=await Gh.call(this,e);const{fs:o,path:l,root:c}=Mr(e,this),u={[l]:e},d=async(h,m)=>{if(!hs(this,m,ci))throw Ze.With("EACCES",Yr(h),"mkdir");const y=await o.mkdir(h,{mode:a,uid:m.mode&x1?m.uid:s,gid:m.mode&w1?m.gid:i});return ka(this,"rename",h),y};try{if(!(t!=null&&t.recursive)){await d(l,await o.stat(Yr(l)));return}const h=[];for(let y=l,b=e;!await o.exists(y);y=Yr(y),b=Yr(b))h.unshift(y),u[y]=b;if(!h.length)return;const m=[await o.stat(Yr(h[0]))];for(const[y,b]of h.entries())m.push(await d(b,m[y]));return c.length==1?h[0]:(r=h[0])===null||r===void 0?void 0:r.slice(c.length)}catch(h){throw ps(h,u)}}async function Jm(e,t){t=typeof t=="object"?t:{encoding:t},e=await Gh.call(this,e);const{fs:n,path:r}=Mr(e,this),s=await n.stat(r).catch(l=>vs(ps(l,{[r]:e})));if(!s)throw Ze.With("ENOENT",e,"readdir");if(!hs(this,s,Wi))throw Ze.With("EACCES",e,"readdir");if(!Lc(s))throw Ze.With("ENOTDIR",e,"readdir");const i=await n.readdir(r).catch(l=>vs(ps(l,{[r]:e}))),a=[],o=async l=>{let c;if(!((t!=null&&t.recursive||t!=null&&t.withFileTypes)&&(c=await n.stat(os(r,l)).catch(u=>{if(u.code!="ENOENT")throw ps(u,{[r]:e})}),!c))&&(t!=null&&t.withFileTypes?a.push(new fw(l,c)):(t==null?void 0:t.encoding)=="buffer"?a.push(Ds.from(l)):a.push(l),!(!(t!=null&&t.recursive)||!Lc(c))))for(const u of await Jm.call(this,os(e,l),t))u instanceof fw?(u.path=os(l,u.path),a.push(u)):Ds.isBuffer(u)?a.push(Ds.from(os(l,AP(u)))):a.push(os(l,u))};return await Promise.all(i.map(o)),a}async function pY(e,t){e=Ln(e),t=Ln(t);const{fs:n,path:r}=Mr(e,this),s=Mr(t,this);if(n!=s.fs)throw Ze.With("EXDEV",t,"link");try{if(Hi&&!hs(this,await n.stat(Yr(r)),Wi))throw Ze.With("EACCES",Yr(r),"link");if(Hi&&!(await Jy.call(this,Yr(t))).hasAccess(ci,this))throw Ze.With("EACCES",Yr(t),"link");if(Hi&&!hs(this,await n.stat(r),Wi))throw Ze.With("EACCES",r,"link");return await n.link(r,s.path)}catch(i){throw ps(i,{[s.path]:t,[r]:e})}}async function mY(e,t,n="file"){const r={stack:[],error:void 0,hasError:!1};try{if(!["file","dir","junction"].includes(n))throw new Ze(bt.EINVAL,"Invalid symlink type: "+n);if(t=Ln(t),await k1.call(this,t))throw Ze.With("EEXIST",t,"symlink");const s=ec(r,await Qy(this,t,{flag:"w+",mode:420,preserveSymlinks:!0}),!0);await s.writeFile(Ln(e,!0)),await s.chmod(rf)}catch(s){r.error=s,r.hasError=!0}finally{const s=tc(r);s&&await s}}async function VC(e,t){const n={stack:[],error:void 0,hasError:!1};try{const s=await ec(n,await Qy(this,Ln(e),{flag:"r",mode:420,preserveSymlinks:!0}),!0).readFile(),i=typeof t=="object"?t==null?void 0:t.encoding:t;return i=="buffer"?s:s.toString(i??"utf-8")}catch(r){n.error=r,n.hasError=!0}finally{const r=tc(n);r&&await r}}async function gY(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{await ec(r,await nc.call(this,e,"r+"),!0).chown(t,n)}catch(s){r.error=s,r.hasError=!0}finally{const s=tc(r);s&&await s}}async function yY(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{await ec(r,await Qy(this,e,{flag:"r+",mode:420,preserveSymlinks:!0,allowDirectory:!0}),!0).chown(t,n)}catch(s){r.error=s,r.hasError=!0}finally{const s=tc(r);s&&await s}}async function bY(e,t){const n={stack:[],error:void 0,hasError:!1};try{await ec(n,await nc.call(this,e,"r+"),!0).chmod(t)}catch(r){n.error=r,n.hasError=!0}finally{const r=tc(n);r&&await r}}async function vY(e,t){const n={stack:[],error:void 0,hasError:!1};try{await ec(n,await Qy(this,e,{flag:"r+",mode:420,preserveSymlinks:!0,allowDirectory:!0}),!0).chmod(t)}catch(r){n.error=r,n.hasError=!0}finally{const r=tc(n);r&&await r}}async function rD(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{await ec(r,await nc.call(this,e,"r+"),!0).utimes(t,n)}catch(s){r.error=s,r.hasError=!0}finally{const s=tc(r);s&&await s}}async function xY(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{await ec(r,await Qy(this,e,{flag:"r+",mode:420,preserveSymlinks:!0,allowDirectory:!0}),!0).utimes(new Date(t),new Date(n))}catch(s){r.error=s,r.hasError=!0}finally{const s=tc(r);s&&await s}}async function WC(e,t,n){if(n){const l=Mr(t,e),c=await l.fs.stat(l.path).catch(()=>{});return{...l,fullPath:t,stats:c}}try{const l=Mr(t,e),c=await l.fs.stat(l.path);if(!cy(c))return{...l,fullPath:t,stats:c};const u=Yd.call(e,Yr(t),(await VC.call(e,t)).toString());return await WC(e,u)}catch{}const{base:r,dir:s}=uu(t),i=s=="/"?"/":await Gh.call(e,s),a=os(i,r),o=Mr(a,e);try{const l=await o.fs.stat(o.path);if(!cy(l))return{...o,fullPath:a,stats:l};const c=Yd.call(e,i,(await VC.call(e,a)).toString());return await WC(e,c)}catch(l){if(l.code=="ENOENT")return{...o,fullPath:t};throw ps(l,{[o.path]:a})}}async function Gh(e,t){var n;const r=typeof t=="string"?t:(n=t==null?void 0:t.encoding)!==null&&n!==void 0?n:"utf8";e=Ln(e);const{fullPath:s}=await WC(this,e);if(r=="utf8"||r=="utf-8")return s;const i=Ds.from(s,"utf-8");return r=="buffer"?i:i.toString(r)}function eSe(e,t={}){const n=new ZK(this,e.toString(),typeof t!="string"?t:{encoding:t}),r=[];let s=!1;n.on("change",(a,o)=>{var l;(l=r.shift())===null||l===void 0||l({value:{eventType:a,filename:o},done:!1})});function i(){s=!0,n.close();for(const a of r)a({value:null,done:s});return r.length=0,Promise.resolve({value:null,done:!0})}return{async next(){if(s)return Promise.resolve({value:null,done:s});const{promise:a,resolve:o}=Promise.withResolvers();return r.push(o),a},return:i,throw:i,async[Symbol.asyncDispose](){await i()},[Symbol.asyncIterator](){return this}}}async function wY(e,t=PP){if(!(await Jy.call(this,e)).hasAccess(t,this))throw new Ze(bt.EACCES)}async function sD(e,t){e=Ln(e);const n=await ZE.call(this,e).catch(r=>{if(!(r.code=="ENOENT"&&(t!=null&&t.force)))throw r});if(n)switch(n.mode&ks){case Ni:if(t!=null&&t.recursive)for(const r of await Jm.call(this,e))await sD.call(this,os(e,r),t);await nD.call(this,e);break;case Rc:case rf:case Wm:case Hm:await XE.call(this,e);break;case Gm:case Vm:default:throw new Ze(bt.EPERM,"File type not supported",e,"rm")}}async function _Y(e,t){const n=typeof t=="object"?t==null?void 0:t.encoding:t||"utf8",s="/tmp/"+`${e}${Date.now()}-${Math.random().toString(36).slice(2)}`;return await eT.call(this,s),n=="buffer"?Ds.from(s):s}async function iD(e,t,n){if(e=Ln(e),t=Ln(t),n&&n&DP&&await k1.call(this,t))throw new Ze(bt.EEXIST,"Destination file already exists",t,"copyFile");await QE.call(this,t,await JE.call(this,e)),ka(this,"rename",t.toString())}function SY(e,t){return e=Ln(e),Promise.resolve(new YP(e,this))}async function aD(e,t,n){e=Ln(e),t=Ln(t);const r=await ZE.call(this,e);if(n!=null&&n.errorOnExist&&await k1.call(this,t))throw new Ze(bt.EEXIST,"Destination file or directory already exists",t,"cp");switch(r.mode&ks){case Ni:{if(!(n!=null&&n.recursive))throw new Ze(bt.EISDIR,e+" is a directory (not copied)",e,"cp");const[s]=await Promise.all([Jm.call(this,e,{withFileTypes:!0}),eT.call(this,t,{recursive:!0})]),i=async a=>{n.filter&&!n.filter(os(e,a.name),os(t,a.name))||await aD.call(this,os(e,a.name),os(t,a.name),n)};await Promise.all(s.map(i));break}case Rc:case rf:await iD.call(this,e,t);break;case Wm:case Hm:case Gm:case Vm:default:throw new Ze(bt.EPERM,"File type not supported",e,"rm")}n!=null&&n.preserveTimestamps&&await rD.call(this,t,r.atime,r.mtime)}async function CY(e,t){e=Ln(e);const{fs:n}=Mr(e,this);return Promise.resolve(KK(n,t==null?void 0:t.bigint))}function kY(e,t){e=Array.isArray(e)?e:[e];const{cwd:n="/",withFileTypes:r=!1,exclude:s=()=>!1}=t||{},i=e.map(o=>(o=o.replace(/([.?+^$(){}|[\]/])/g,"$1").replace(/\*\*/g,".*").replace(/\*/g,"[^/]*").replace(/\?/g,"."),new RegExp(`^${o}$`)));async function*a(o){const l=await Jm(o,{withFileTypes:r,encoding:"utf8"});for(const c of l){const u=r?c.path:o+"/"+c;s(r?c:u)||((await Jy(u)).isDirectory()&&i.some(d=>d.source.includes(".*"))&&(yield*a(u)),i.some(d=>d.test(u.replace(/^\/+/g,"")))&&(yield r?c:u.replace(/^\/+/g,"")))}}return a(n)}const tSe=Object.freeze(Object.defineProperty({__proto__:null,FileHandle:$a,access:wY,appendFile:hY,chmod:bY,chown:gY,constants:$K,copyFile:iD,cp:aD,exists:k1,glob:kY,lchmod:vY,lchown:yY,link:pY,lstat:ZE,lutimes:xY,mkdir:eT,mkdtemp:_Y,open:nc,opendir:SY,readFile:JE,readdir:Jm,readlink:VC,realpath:Gh,rename:dY,rm:sD,rmdir:nD,stat:Jy,statfs:CY,symlink:mY,truncate:fY,unlink:XE,utimes:rD,watch:eSe,writeFile:QE},Symbol.toStringTag,{value:"Module"})),mr=()=>{};async function nSe(e){const t=[];for await(const n of e)t.push(n);return t}function rSe(e,t,n=mr){dY.call(this,e,t).then(()=>n()).catch(n)}function sSe(e,t=mr){k1.call(this,e).then(t).catch(()=>t(!1))}function iSe(e,t,n=mr){n=typeof t=="function"?t:n,Jy.call(this,e,typeof t!="function"?t:{}).then(r=>n(void 0,r)).catch(n)}function aSe(e,t,n=mr){n=typeof t=="function"?t:n,ZE.call(this,e,typeof t!="function"?t:{}).then(r=>n(void 0,r)).catch(n)}function oSe(e,t=0,n=mr){n=typeof t=="function"?t:n;const r=typeof t=="number"?t:0;fY.call(this,e,r).then(()=>n()).catch(n)}function lSe(e,t=mr){XE.call(this,e).then(()=>t()).catch(t)}function cSe(e,t,n,r=mr){const s=qh(n,420);r=typeof n=="function"?n:r,nc.call(this,e,t,s).then(i=>r(void 0,i.fd)).catch(r)}function uSe(e,t,n=mr){n=typeof t=="function"?t:n,JE.call(this,e,typeof t=="function"?null:t).then(r=>n(void 0,r)).catch(n)}function dSe(e,t,n,r=mr){r=typeof n=="function"?n:r,QE.call(this,e,t,typeof n!="function"?n:null).then(()=>r(void 0)).catch(r)}function fSe(e,t,n,r=mr){const s=typeof n!="function"?n:void 0;r=typeof n=="function"?n:r,hY.call(this,e,t,s).then(()=>r()).catch(r)}function hSe(e,t,n=mr){n=typeof t=="function"?t:n,new $a(this,e).stat().then(r=>n(void 0,typeof t=="object"&&(t!=null&&t.bigint)?new Km(r):r)).catch(n)}function pSe(e,t=mr){new $a(this,e).close().then(()=>t()).catch(t)}function mSe(e,t,n=mr){const r=typeof t=="number"?t:0;n=typeof t=="function"?t:n;const s=new $a(this,e);if(r<0)throw new Ze(bt.EINVAL);s.truncate(r).then(()=>n()).catch(n)}function gSe(e,t=mr){new $a(this,e).sync().then(()=>t()).catch(t)}function ySe(e,t=mr){new $a(this,e).datasync().then(()=>t()).catch(t)}function bSe(e,t,n,r,s,i=mr){let a,o,l,c,u;const d=new $a(this,e);if(typeof t=="string"){switch(u="utf8",typeof n){case"function":i=n;break;case"number":c=n,u=typeof r=="string"?r:"utf8",i=typeof s=="function"?s:i;break;default:i=typeof r=="function"?r:typeof s=="function"?s:i,i(new Ze(bt.EINVAL,"Invalid arguments"));return}a=Ds.from(t),o=0,l=a.length;const h=i;d.write(a,o,l,c).then(({bytesWritten:m})=>h(void 0,m,a.toString(u))).catch(h)}else{a=Ds.from(t.buffer),o=n,l=r,c=typeof s=="number"?s:null;const h=typeof s=="function"?s:i;d.write(a,o,l,c).then(({bytesWritten:m})=>h(void 0,m,a)).catch(h)}}function vSe(e,t,n,r,s,i=mr){new $a(this,e).read(t,n,r,s).then(({bytesRead:a,buffer:o})=>i(void 0,a,o)).catch(i)}function xSe(e,t,n,r=mr){new $a(this,e).chown(t,n).then(()=>r()).catch(r)}function wSe(e,t,n){new $a(this,e).chmod(t).then(()=>n()).catch(n)}function _Se(e,t,n,r=mr){new $a(this,e).utimes(t,n).then(()=>r()).catch(r)}function SSe(e,t=mr){nD.call(this,e).then(()=>t()).catch(t)}function CSe(e,t,n=mr){eT.call(this,e,t).then(()=>n()).catch(n)}function kSe(e,t,n=mr){n=typeof t=="function"?t:n;const r=typeof t!="function"?t:{};Jm.call(this,e,r).then(s=>n(void 0,s)).catch(n)}function ESe(e,t,n=mr){pY.call(this,e,t).then(()=>n()).catch(n)}function TSe(e,t,n,r=mr){const s=typeof n=="string"?n:"file";r=typeof n=="function"?n:r,mY.call(this,e,t,s).then(()=>r()).catch(r)}function ASe(e,t,n=mr){n=typeof t=="function"?t:n,VC.call(this,e).then(r=>n(void 0,r)).catch(n)}function RSe(e,t,n,r=mr){gY.call(this,e,t,n).then(()=>r()).catch(r)}function NSe(e,t,n,r=mr){yY.call(this,e,t,n).then(()=>r()).catch(r)}function MSe(e,t,n=mr){bY.call(this,e,t).then(()=>n()).catch(n)}function ISe(e,t,n=mr){vY.call(this,e,t).then(()=>n()).catch(n)}function jSe(e,t,n,r=mr){rD.call(this,e,t,n).then(()=>r()).catch(r)}function OSe(e,t,n,r=mr){xY.call(this,e,t,n).then(()=>r()).catch(r)}function PSe(e,t,n=mr){n=typeof t=="function"?t:n,Gh.call(this,e,typeof t=="function"?null:t).then(r=>n(void 0,r)).catch(n)}function DSe(e,t,n=mr){const r=typeof t=="number"?t:Wi;n=typeof t=="function"?t:n,wY.call(this,e,r).then(()=>n()).catch(n)}const b0=new Map;function FSe(e,t,n){const r=Ln(e),s=typeof t!="function"?t:{};if(typeof t=="function"&&(n=t),!n)throw new Ze(bt.EINVAL,"No listener specified",e.toString(),"watchFile");if(b0.has(r)){const a=b0.get(r);a&&a.listeners.add(n);return}const i=new S_e(this,r,s);i.on("change",(a,o)=>{const l=b0.get(r);if(l)for(const c of l.listeners)c(a,o)}),b0.set(r,{watcher:i,listeners:new Set})}function LSe(e,t=mr){const n=Ln(e),r=b0.get(n);r&&(t&&t!==mr?r.listeners.delete(t):r.listeners.clear(),r.listeners.size===0&&(r.watcher.stop(),b0.delete(n)))}function BSe(e,t,n){const r=new ZK(this,Ln(e),typeof t=="object"?t:{});return n=typeof t=="function"?t:n,r.on("change",n||mr),r}function $Se(e,t){t=typeof t=="object"?t:{encoding:t};const n=nc.call(this,e,"r",t==null?void 0:t.mode);return new eD({...t,autoClose:!0},n)}function zSe(e,t){t=typeof t=="object"?t:{encoding:t};const n=nc.call(this,e,"w",t==null?void 0:t.mode);return new tD(t,n)}function USe(e,t,n=mr){n=typeof t=="function"?t:n,sD.call(this,e,typeof t=="function"?void 0:t).then(()=>n(void 0)).catch(n)}function qSe(e,t,n=mr){n=typeof t=="function"?t:n,_Y.call(this,e,typeof t!="function"?t:null).then(r=>n(void 0,r)).catch(n)}function VSe(e,t,n,r=mr){r=typeof n=="function"?n:r,iD.call(this,e,t,typeof n=="function"?void 0:n).then(()=>r(void 0)).catch(r)}function WSe(e,t,n,r=mr){r=typeof n=="function"?n:r,new $a(this,e).readv(t,typeof n=="function"?void 0:n).then(({buffers:s,bytesRead:i})=>r(void 0,i,s)).catch(r)}function HSe(e,t,n,r=mr){r=typeof n=="function"?n:r,new $a(this,e).writev(t,typeof n=="function"?void 0:n).then(({buffers:s,bytesWritten:i})=>r(void 0,i,s)).catch(r)}function GSe(e,t,n=mr){n=typeof t=="function"?t:n,SY.call(this,e,typeof t=="function"?void 0:t).then(r=>n(void 0,r)).catch(n)}function KSe(e,t,n,r=mr){r=typeof n=="function"?n:r,aD.call(this,e,t,typeof n=="function"?void 0:n).then(()=>r(void 0)).catch(r)}function YSe(e,t,n=mr){n=typeof t=="function"?t:n,CY.call(this,e,typeof t=="function"?void 0:t).then(r=>n(void 0,r)).catch(n)}async function ZSe(e,t){const n=await nc.call(this,e.toString(),"r"),r=await n.readFile();return await n.close(),new Blob([r],t)}function XSe(e,t,n=mr){n=typeof t=="function"?t:n;const r=kY.call(this,e,typeof t=="function"?void 0:t);nSe(r).then(s=>{var i;return n(null,(i=s)!==null&&i!==void 0?i:[])}).catch(s=>n(s))}var Fp=function(e,t,n,r,s,i){function a(x){if(x!==void 0&&typeof x!="function")throw new TypeError("Function expected");return x}for(var o=r.kind,l=o==="getter"?"get":o==="setter"?"set":"value",c=!t&&e?r.static?e:e.prototype:null,u=t||(c?Object.getOwnPropertyDescriptor(c,r.name):{}),d,h=!1,m=n.length-1;m>=0;m--){var y={};for(var b in r)y[b]=b==="access"?{}:r[b];for(var b in r.access)y.access[b]=r.access[b];y.addInitializer=function(x){if(h)throw new TypeError("Cannot add initializers after decoration has completed");i.push(a(x||null))};var v=(0,n[m])(o==="accessor"?{get:u.get,set:u.set}:u[l],y);if(o==="accessor"){if(v===void 0)continue;if(v===null||typeof v!="object")throw new TypeError("Object expected");(d=a(v.get))&&(u.get=d),(d=a(v.set))&&(u.set=d),(d=a(v.init))&&s.unshift(d)}else(d=a(v))&&(o==="field"?s.unshift(d):u[l]=d)}c&&Object.defineProperty(c,r.name,u),h=!0},nl=function(e,t,n){for(var r=arguments.length>2,s=0;s<t.length;s++)n=r?t[s].call(e,n):t[s].call(e);return r?n:void 0},JSe=function(e,t,n){return typeof t=="symbol"&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:n?"".concat(n," ",t):t})},HC;(function(e){e[e.RealTime=1]="RealTime",e[e.PreAlloc=2]="PreAlloc",e[e.Immutable=8]="Immutable",e[e.Append=16]="Append",e[e.Sync=32]="Sync",e[e.NoAtime=64]="NoAtime",e[e.NoDump=128]="NoDump",e[e.RtInherit=256]="RtInherit",e[e.ProjInherit=512]="ProjInherit",e[e.NoSymlinks=1024]="NoSymlinks",e[e.ExtSize=2048]="ExtSize",e[e.ExtSzInherit=4096]="ExtSzInherit",e[e.NoDefrag=8192]="NoDefrag",e[e.FileStream=16384]="FileStream",e[e.Dax=32768]="Dax",e[e.CowExtSize=65536]="CowExtSize",e[e.HasAttr=2147483648]="HasAttr"})(HC||(HC={}));let EY=(()=>{var e,t,n,r,s;let i=[qm()],a,o=[],l,c,u=[],d=[],h,m=[],y=[],b,v=[],x=[],w,S=[],k=[],C,T=[],R=[],N,I=[],P=[];return l=class{constructor(B=vs(new Ze(bt.EINVAL,"fsxattr must be initialized with an inode"))){this.xflags=nl(this,u,0),this.extsize=(nl(this,d),nl(this,m,0)),this.nextents=(nl(this,y),nl(this,v,0)),this.projid=(nl(this,x),nl(this,S,0)),this.cowextsize=(nl(this,k),nl(this,T,0)),this.pad=(nl(this,R),nl(this,I,[])),nl(this,P),this.extsize=B.size,this.nextents=1,this.projid=B.uid,this.cowextsize=B.size;for(const D of Object.keys(Eo))B.flags&Eo[D]&&D in HC&&(this.xflags|=HC[D])}},JSe(l,"fsxattr"),(()=>{const B=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;c=[(e=er).uint32.bind(e)],h=[(t=er).uint32.bind(t)],b=[(n=er).uint32.bind(n)],w=[(r=er).uint32.bind(r)],C=[(s=er).uint32.bind(s)],N=[er.char(8)],Fp(null,null,c,{kind:"field",name:"xflags",static:!1,private:!1,access:{has:D=>"xflags"in D,get:D=>D.xflags,set:(D,W)=>{D.xflags=W}},metadata:B},u,d),Fp(null,null,h,{kind:"field",name:"extsize",static:!1,private:!1,access:{has:D=>"extsize"in D,get:D=>D.extsize,set:(D,W)=>{D.extsize=W}},metadata:B},m,y),Fp(null,null,b,{kind:"field",name:"nextents",static:!1,private:!1,access:{has:D=>"nextents"in D,get:D=>D.nextents,set:(D,W)=>{D.nextents=W}},metadata:B},v,x),Fp(null,null,w,{kind:"field",name:"projid",static:!1,private:!1,access:{has:D=>"projid"in D,get:D=>D.projid,set:(D,W)=>{D.projid=W}},metadata:B},S,k),Fp(null,null,C,{kind:"field",name:"cowextsize",static:!1,private:!1,access:{has:D=>"cowextsize"in D,get:D=>D.cowextsize,set:(D,W)=>{D.cowextsize=W}},metadata:B},T,R),Fp(null,null,N,{kind:"field",name:"pad",static:!1,private:!1,access:{has:D=>"pad"in D,get:D=>D.pad,set:(D,W)=>{D.pad=W}},metadata:B},I,P),Fp(null,a={value:l},i,{kind:"class",name:l.name,metadata:B},null,o),l=a.value,B&&Object.defineProperty(l,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:B}),nl(l,o)})(),l})();var Us;(function(e){e[e.GetFlags=2148034049]="GetFlags",e[e.SetFlags=1074292226]="SetFlags",e[e.GetVersion=2148038145]="GetVersion",e[e.SetVersion=1074296322]="SetVersion",e[e.Fiemap=3223348747]="Fiemap",e[e.GetXattr=2149341215]="GetXattr",e[e.SetXattr=1075599392]="SetXattr",e[e.GetLabel=2164298801]="GetLabel",e[e.SetLabel=1090556978]="SetLabel",e[e.GetUUID=2148603136]="GetUUID",e[e.GetSysfsPath=2155943169]="GetSysfsPath"})(Us||(Us={}));var _c;(function(e){e[e.GetFlags=2147771905]="GetFlags",e[e.SetFlags=1074030082]="SetFlags",e[e.GetVersion=2147776001]="GetVersion",e[e.SetVersion=1074034178]="SetVersion"})(_c||(_c={}));async function QSe(e,t,...n){e=Ln(e);const{fs:r,path:s}=Mr(e,this);try{const i=new Ti(await r.stat(s));switch(t){case Us.GetFlags:case _c.GetFlags:return i.flags;case Us.SetFlags:case _c.SetFlags:i.flags=n[0],await r.touch(s,i);return;case Us.GetVersion:case _c.GetVersion:return i.version;case Us.SetVersion:case _c.SetVersion:i.version=n[0],await r.touch(s,i);return;case Us.Fiemap:break;case Us.GetXattr:return new EY(i);case Us.SetXattr:break;case Us.GetLabel:return r.label;case Us.SetLabel:r.label=n[0];return;case Us.GetUUID:return r.uuid;case Us.GetSysfsPath:return`/sys/fs/${r.name}/${r.uuid}`}}catch(i){throw ps(i,{[s]:e})}throw new Ze(bt.ENOTSUP,"Unsupported command: "+t,e,"ioctl")}function e2e(e,t,...n){e=Ln(e);const{fs:r,path:s}=Mr(e,this);try{const i=new Ti(r.statSync(s));switch(t){case Us.GetFlags:case _c.GetFlags:return i.flags;case Us.SetFlags:case _c.SetFlags:i.flags=n[0],r.touchSync(s,i);return;case Us.GetVersion:case _c.GetVersion:return i.version;case Us.SetVersion:case _c.SetVersion:i.version=n[0],r.touchSync(s,i);return;case Us.Fiemap:break;case Us.GetXattr:return new EY(i);case Us.SetXattr:break;case Us.GetLabel:return r.label;case Us.SetLabel:r.label=n[0];return;case Us.GetUUID:return r.uuid;case Us.GetSysfsPath:return`/sys/fs/${r.name}/${r.uuid}`}}catch(i){throw ps(i,{[s]:e})}throw new Ze(bt.ENOTSUP,"Unsupported command: "+t,e,"ioctl")}const t2e=[];function eb(e,t,n,r){if(!t.startsWith("user.")&&!t2e.includes(t))throw new Ze(bt.EPERM,"Only attributes in the user namespace are supported",n,r)}async function n2e(e,t,n={}){var r;e=Ln(e);const{fs:s,path:i}=Mr(e,this);eb(this,t,e,"xattr.get");try{const a=await s.stat(i);if(Hi&&!hs(this,a,Wi))throw Ze.With("EACCES",i,"xattr.get");(r=a.attributes)!==null&&r!==void 0||(a.attributes=new Ch);const o=a.attributes.get(t);if(!o)throw Ze.With("ENODATA",i,"xattr.get");const l=Ds.from(o.value);return n.encoding=="buffer"||!n.encoding?l:l.toString(n.encoding)}catch(a){throw ps(a,{[i]:e})}}function r2e(e,t,n={}){var r;e=Ln(e),eb(this,t,e,"xattr.get");const{fs:s,path:i}=Mr(e,this);try{const a=s.statSync(i);if(Hi&&!hs(this,a,Wi))throw Ze.With("EACCES",i,"xattr.get");(r=a.attributes)!==null&&r!==void 0||(a.attributes=new Ch);const o=a.attributes.get(t);if(!o)throw Ze.With("ENODATA",i,"xattr.get");const l=Ds.from(o.value);return n.encoding=="buffer"||!n.encoding?l:l.toString(n.encoding)}catch(a){throw ps(a,{[i]:e})}}async function s2e(e,t,n,r={}){var s;e=Ln(e);const{fs:i,path:a}=Mr(e,this);eb(this,t,e,"xattr.set");try{const o=await i.stat(a);if(Hi&&!hs(this,o,ci))throw Ze.With("EACCES",a,"xattr.set");(s=o.attributes)!==null&&s!==void 0||(o.attributes=new Ch);const l=o.attributes.get(t);if(r.create&&l)throw Ze.With("EEXIST",a,"xattr.set");if(r.replace&&!l)throw Ze.With("ENODATA",a,"xattr.set");o.attributes.set(t,Ds.from(n)),await i.touch(a,Um(o,"attributes"))}catch(o){throw ps(o,{[a]:e})}}function i2e(e,t,n,r={}){var s;e=Ln(e);const{fs:i,path:a}=Mr(e,this);eb(this,t,e,"xattr.set");try{const o=i.statSync(a);if(Hi&&!hs(this,o,ci))throw Ze.With("EACCES",a,"xattr.set");(s=o.attributes)!==null&&s!==void 0||(o.attributes=new Ch);const l=o.attributes.get(t);if(r.create&&l)throw Ze.With("EEXIST",a,"xattr.set");if(r.replace&&!l)throw Ze.With("ENODATA",a,"xattr.set");o.attributes.set(t,Ds.from(n)),i.touchSync(a,Um(o,"attributes"))}catch(o){throw ps(o,{[a]:e})}}async function a2e(e,t){var n;e=Ln(e);const{fs:r,path:s}=Mr(e,this);eb(this,t,e,"xattr.remove");try{const i=await r.stat(s);if(Hi&&!hs(this,i,ci))throw Ze.With("EACCES",s,"xattr.remove");if((n=i.attributes)!==null&&n!==void 0||(i.attributes=new Ch),!i.attributes.get(t))throw Ze.With("ENODATA",s,"xattr.remove");i.attributes.remove(t),await r.touch(s,Um(i,"attributes"))}catch(i){throw ps(i,{[s]:e})}}function o2e(e,t){var n;e=Ln(e);const{fs:r,path:s}=Mr(e,this);eb(this,t,e,"xattr.remove");try{const i=r.statSync(s);if(Hi&&!hs(this,i,ci))throw Ze.With("EACCES",s,"xattr.remove");if((n=i.attributes)!==null&&n!==void 0||(i.attributes=new Ch),!i.attributes.get(t))throw Ze.With("ENODATA",s,"xattr.remove");i.attributes.remove(t),r.touchSync(s,Um(i,"attributes"))}catch(i){throw ps(i,{[s]:e})}}async function l2e(e){e=Ln(e);const{fs:t,path:n}=Mr(e,this);try{const r=await t.stat(n);return r.attributes?r.attributes.keys():[]}catch(r){throw ps(r,{[n]:e})}}function c2e(e){e=Ln(e);const{fs:t,path:n}=Mr(e,this);try{const r=t.statSync(n);return r.attributes?r.attributes.keys():[]}catch(r){throw ps(r,{[n]:e})}}const u2e=Object.freeze(Object.defineProperty({__proto__:null,get:n2e,getSync:r2e,list:l2e,listSync:c2e,remove:a2e,removeSync:o2e,set:s2e,setSync:i2e},Symbol.toStringTag,{value:"Module"})),fa=Object.freeze(Object.defineProperty({__proto__:null,BigIntStatsFs:i_e,Dir:YP,Dirent:fw,get IOC(){return Us},get IOC32(){return _c},ReadStream:eD,Stats:sf,StatsFs:s_e,WriteStream:tD,access:DSe,accessSync:U_e,appendFile:fSe,appendFileSync:A_e,chmod:MSe,chmodSync:B_e,chown:RSe,chownSync:F_e,chroot:w_e,close:pSe,closeSync:Zm,constants:$K,copyFile:VSe,copyFileSync:tY,cp:KSe,cpSync:nY,createReadStream:$Se,createWriteStream:zSe,exists:sSe,existsSync:$P,fchmod:wSe,fchmodSync:HP,fchown:xSe,fchownSync:WP,fdatasync:ySe,fdatasyncSync:I_e,fstat:hSe,fstatSync:R_e,fsync:gSe,fsyncSync:M_e,ftruncate:mSe,ftruncateSync:N_e,futimes:_Se,futimesSync:GP,glob:XSe,globSync:K_e,ioctl:QSe,ioctlSync:e2e,lchmod:ISe,lchmodSync:$_e,lchown:NSe,lchownSync:L_e,link:ESe,linkSync:P_e,lopenSync:WE,lstat:aSe,lstatSync:zP,lutimes:OSe,lutimesSync:z_e,mkdir:CSe,mkdirSync:KP,mkdtemp:qSe,mkdtempSync:q_e,mount:BP,open:cSe,openAsBlob:ZSe,openSync:VE,opendir:GSe,opendirSync:H_e,promises:tSe,read:vSe,readFile:uSe,readFileSync:qP,readSync:O_e,readdir:kSe,readdirSync:Zy,readlink:ASe,readlinkSync:Nj,readv:WSe,readvSync:V_e,realpath:PSe,realpathSync:Vh,rename:rSe,renameSync:E_e,rm:USe,rmSync:eY,rmdir:SSe,rmdirSync:JK,stat:iSe,statSync:kh,statfs:YSe,statfsSync:G_e,symlink:TSe,symlinkSync:D_e,truncate:oSe,truncateSync:T_e,umount:GK,unlink:lSe,unlinkSync:UP,unwatchFile:LSe,utimes:jSe,utimesSync:QK,watch:BSe,watchFile:FSe,write:bSe,writeFile:dSe,writeFileSync:VP,writeSync:j_e,writev:HSe,writevSync:W_e,xattr:u2e},Symbol.toStringTag,{value:"Module"}));function A9(e){return RK(e)||OP(e)||e instanceof LP}async function TY(e,t=0){if(typeof e!="object"||e==null)throw ko(new Ze(bt.EINVAL,"Invalid options on mount configuration"));if(!A9(e))throw ko(new Ze(bt.EINVAL,"Invalid mount configuration"));if(e instanceof LP)return await e.ready(),e;OP(e)&&(e={backend:e});for(const[s,i]of Object.entries(e))if(s!="backend"&&A9(i)){if(AK("Resolving nested mount configuration: "+s),t>10)throw ko(new Ze(bt.EINVAL,"Invalid configuration, too deep and possibly infinite"));e[s]=await TY(i,++t)}const{backend:n}=e;if(typeof n.isAvailable=="function"&&!await n.isAvailable(e))throw ko(new Ze(bt.EPERM,"Backend not available: "+n.name));z1e(n,e);const r=await n.create(e);return e.disableAsyncCache&&r.attributes.set("no_async"),await r.ready(),r}async function d2e(e){if(!RK(e))throw new TypeError("Invalid single mount point configuration");const t=await TY(e);GK("/"),BP("/",t)}const f2e=["delete"];Math.max(...f2e.map(e=>e.length));$1e("RPCPort",e=>typeof(e==null?void 0:e.postMessage)=="function");const AY=new Uint32Array(256);for(let e=0;e<256;e++){let t=e;for(let n=0;n<8;n++)t=t&1?2197175160^t>>>1:t>>>1;AY[e]=t}function h2e(e){let t=4294967295;for(let n=0;n<e.length;n++)t=t>>>8^AY[(t^e[n])&255];return(t^4294967295)>>>0}var zs=function(e,t,n,r,s,i){function a(x){if(x!==void 0&&typeof x!="function")throw new TypeError("Function expected");return x}for(var o=r.kind,l=o==="getter"?"get":o==="setter"?"set":"value",c=!t&&e?r.static?e:e.prototype:null,u=t||(c?Object.getOwnPropertyDescriptor(c,r.name):{}),d,h=!1,m=n.length-1;m>=0;m--){var y={};for(var b in r)y[b]=b==="access"?{}:r[b];for(var b in r.access)y.access[b]=r.access[b];y.addInitializer=function(x){if(h)throw new TypeError("Cannot add initializers after decoration has completed");i.push(a(x||null))};var v=(0,n[m])(o==="accessor"?{get:u.get,set:u.set}:u[l],y);if(o==="accessor"){if(v===void 0)continue;if(v===null||typeof v!="object")throw new TypeError("Object expected");(d=a(v.get))&&(u.get=d),(d=a(v.set))&&(u.set=d),(d=a(v.init))&&s.unshift(d)}else(d=a(v))&&(o==="field"?s.unshift(d):u[l]=d)}c&&Object.defineProperty(c,r.name,u),h=!0},cr=function(e,t,n){for(var r=arguments.length>2,s=0;s<t.length;s++)n=r?t[s].call(e,n):t[s].call(e);return r?n:void 0},oD=function(e,t,n){return typeof t=="symbol"&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:n?"".concat(n," ",t):t})};let R9=(()=>{var e,t,n,r;let s=[qm()],i,a=[],o,l,c=[],u=[],d,h=[],m=[],y,b=[],v=[],x,w=[],S=[];return o=class{constructor(){this.id=cr(this,c,0),this.offset_=(cr(this,u),cr(this,h,0)),this.offset=(cr(this,m),cr(this,b,0)),this.size=(cr(this,v),cr(this,w,0)),cr(this,S)}},oD(o,"MetadataEntry"),(()=>{const k=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;l=[(e=er).uint32.bind(e)],d=[(t=er).uint32.bind(t)],y=[(n=er).uint32.bind(n)],x=[(r=er).uint32.bind(r)],zs(null,null,l,{kind:"field",name:"id",static:!1,private:!1,access:{has:C=>"id"in C,get:C=>C.id,set:(C,T)=>{C.id=T}},metadata:k},c,u),zs(null,null,d,{kind:"field",name:"offset_",static:!1,private:!1,access:{has:C=>"offset_"in C,get:C=>C.offset_,set:(C,T)=>{C.offset_=T}},metadata:k},h,m),zs(null,null,y,{kind:"field",name:"offset",static:!1,private:!1,access:{has:C=>"offset"in C,get:C=>C.offset,set:(C,T)=>{C.offset=T}},metadata:k},b,v),zs(null,null,x,{kind:"field",name:"size",static:!1,private:!1,access:{has:C=>"size"in C,get:C=>C.size,set:(C,T)=>{C.size=T}},metadata:k},w,S),zs(null,i={value:o},s,{kind:"class",name:o.name,metadata:k},null,a),o=i.value,k&&Object.defineProperty(o,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:k}),cr(o,a)})(),o})();const N9=255;let Lp=(()=>{var e,t,n,r;let s=[qm()],i,a=[],o,l,c=[],u=[],d,h=[],m=[],y,b=[],v=[],x,w=[],S=[],k,C=[],T=[];var R=o=class{constructor(N=vs(new Ze(bt.EINVAL,"Metadata block must be initialized with a superblock")),I=0){if(this.superblock=N,this.offset=I,this.checksum=cr(this,c,0),this.timestamp=(cr(this,u),cr(this,h,Date.now())),this.previous_offset_=(cr(this,m),cr(this,b,0)),this.previous_offset=(cr(this,v),cr(this,w,0)),this._previous=cr(this,S),this.entries=cr(this,C,Array.from({length:N9},()=>new R9)),cr(this,T),this.superblock=N,this.offset=I,!!I&&(LE(this,N.store._buffer.subarray(I,I+qs(R))),!RY(this)))throw BE(new Ze(bt.EIO,"SingleBuffer: Checksum mismatch for metadata block at 0x"+I.toString(16)))}get previous(){var N;if(this.previous_offset)return(N=this._previous)!==null&&N!==void 0||(this._previous=new R(this.superblock,this.previous_offset)),this._previous}};return oD(o,"MetadataBlock"),(()=>{const N=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;l=[(e=er).uint32.bind(e)],d=[(t=er).uint32.bind(t)],y=[(n=er).uint32.bind(n)],x=[(r=er).uint32.bind(r)],k=[lw(R9,N9)],zs(null,null,l,{kind:"field",name:"checksum",static:!1,private:!1,access:{has:I=>"checksum"in I,get:I=>I.checksum,set:(I,P)=>{I.checksum=P}},metadata:N},c,u),zs(null,null,d,{kind:"field",name:"timestamp",static:!1,private:!1,access:{has:I=>"timestamp"in I,get:I=>I.timestamp,set:(I,P)=>{I.timestamp=P}},metadata:N},h,m),zs(null,null,y,{kind:"field",name:"previous_offset_",static:!1,private:!1,access:{has:I=>"previous_offset_"in I,get:I=>I.previous_offset_,set:(I,P)=>{I.previous_offset_=P}},metadata:N},b,v),zs(null,null,x,{kind:"field",name:"previous_offset",static:!1,private:!1,access:{has:I=>"previous_offset"in I,get:I=>I.previous_offset,set:(I,P)=>{I.previous_offset=P}},metadata:N},w,S),zs(null,null,k,{kind:"field",name:"entries",static:!1,private:!1,access:{has:I=>"entries"in I,get:I=>I.entries,set:(I,P)=>{I.entries=P}},metadata:N},C,T),zs(null,i={value:o},s,{kind:"class",name:o.name,metadata:N},null,a),R=o=i.value,N&&Object.defineProperty(o,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:N}),cr(o,a)})(),R=o})();const M9=2049864546;(()=>{var e,t,n,r,s,i,a,o,l,c,u;let d=[qm()],h,m=[],y,b,v=[],x=[],w,S=[],k=[],C,T=[],R=[],N,I=[],P=[],B,D=[],W=[],O,Z=[],U=[],H,L=[],te=[],V,Q=[],ee=[],se,pe=[],ue=[],Oe,Fe=[],Se=[],Ce,qe=[],Qe=[],We,Ie=[],K=[],ye,Ne=[],ce=[];var oe=y=class{constructor(re=vs(new Ze(bt.EINVAL,"Super block must be initialized with a store"))){if(this.store=re,this.checksum=cr(this,v,0),this.magic=(cr(this,x),cr(this,S,M9)),this.version=(cr(this,k),cr(this,T,1)),this.inode_format=(cr(this,R),cr(this,I,o_e)),this.flags=(cr(this,P),cr(this,D,0)),this.used_bytes=(cr(this,W),cr(this,Z,BigInt(0))),this.total_bytes=(cr(this,U),cr(this,L,BigInt(0))),this.uuid=(cr(this,te),cr(this,Q,BigInt(0))),this.metadata_block_size=(cr(this,ee),cr(this,pe,qs(Lp))),this.metadata_offset_=(cr(this,ue),cr(this,Fe,0)),this.metadata_offset=(cr(this,Se),cr(this,qe,0)),this.metadata=cr(this,Qe),this.label=cr(this,Ie,""),this._padding=(cr(this,K),cr(this,Ne,new Array(132).fill(0))),cr(this,ce),this.store=re,re._view.getUint32(C1e(oe,"magic"),!0)!=M9){Fa("SingleBuffer: Invalid magic value, assuming this is a fresh super block"),this.metadata=new Lp(this),this.metadata.offset=qs(oe),this.metadata_offset=this.metadata.offset,this.used_bytes=BigInt(qs(oe)+qs(Lp)),this.total_bytes=BigInt(re._buffer.byteLength),re._write(this),re._write(this.metadata);return}if(LE(this,re._buffer.subarray(0,qs(oe))),!RY(this))throw BE(new Ze(bt.EIO,"SingleBuffer: Checksum mismatch for super block!"));this.metadata=new Lp(this,this.metadata_offset)}rotateMetadata(){const re=new Lp(this);return re.offset=Number(this.used_bytes),re.previous_offset=this.metadata_offset,this.metadata=re,this.metadata_offset=re.offset,this.store._write(re),this.used_bytes+=BigInt(qs(Lp)),this.store._write(this),re}isUnused(re,Re){if(!Re)return!0;if(re+Re>this.total_bytes||re<qs(oe))return!1;for(let Be=this.metadata;Be;Be=Be.previous){if(re<Be.offset+qs(Lp)&&re+Re>Be.offset)return!1;for(const Te of Be.entries)if(Te.offset&&(re>=Te.offset&&re<Te.offset+Te.size||re+Re>Te.offset&&re+Re<=Te.offset+Te.size||re<=Te.offset&&re+Re>=Te.offset+Te.size))return!1}return!0}};return oD(y,"SuperBlock"),(()=>{const re=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;b=[(e=er).uint32.bind(e)],w=[(t=er).uint32.bind(t)],C=[(n=er).uint16.bind(n)],N=[(r=er).uint16.bind(r)],B=[(s=er).uint32.bind(s)],O=[(i=er).uint64.bind(i)],H=[(a=er).uint64.bind(a)],V=[(o=er).uint128.bind(o)],se=[(l=er).uint32.bind(l)],Oe=[(c=er).uint32.bind(c)],Ce=[(u=er).uint32.bind(u)],We=[er.char(64)],ye=[er.char(132)],zs(null,null,b,{kind:"field",name:"checksum",static:!1,private:!1,access:{has:Re=>"checksum"in Re,get:Re=>Re.checksum,set:(Re,Be)=>{Re.checksum=Be}},metadata:re},v,x),zs(null,null,w,{kind:"field",name:"magic",static:!1,private:!1,access:{has:Re=>"magic"in Re,get:Re=>Re.magic,set:(Re,Be)=>{Re.magic=Be}},metadata:re},S,k),zs(null,null,C,{kind:"field",name:"version",static:!1,private:!1,access:{has:Re=>"version"in Re,get:Re=>Re.version,set:(Re,Be)=>{Re.version=Be}},metadata:re},T,R),zs(null,null,N,{kind:"field",name:"inode_format",static:!1,private:!1,access:{has:Re=>"inode_format"in Re,get:Re=>Re.inode_format,set:(Re,Be)=>{Re.inode_format=Be}},metadata:re},I,P),zs(null,null,B,{kind:"field",name:"flags",static:!1,private:!1,access:{has:Re=>"flags"in Re,get:Re=>Re.flags,set:(Re,Be)=>{Re.flags=Be}},metadata:re},D,W),zs(null,null,O,{kind:"field",name:"used_bytes",static:!1,private:!1,access:{has:Re=>"used_bytes"in Re,get:Re=>Re.used_bytes,set:(Re,Be)=>{Re.used_bytes=Be}},metadata:re},Z,U),zs(null,null,H,{kind:"field",name:"total_bytes",static:!1,private:!1,access:{has:Re=>"total_bytes"in Re,get:Re=>Re.total_bytes,set:(Re,Be)=>{Re.total_bytes=Be}},metadata:re},L,te),zs(null,null,V,{kind:"field",name:"uuid",static:!1,private:!1,access:{has:Re=>"uuid"in Re,get:Re=>Re.uuid,set:(Re,Be)=>{Re.uuid=Be}},metadata:re},Q,ee),zs(null,null,se,{kind:"field",name:"metadata_block_size",static:!1,private:!1,access:{has:Re=>"metadata_block_size"in Re,get:Re=>Re.metadata_block_size,set:(Re,Be)=>{Re.metadata_block_size=Be}},metadata:re},pe,ue),zs(null,null,Oe,{kind:"field",name:"metadata_offset_",static:!1,private:!1,access:{has:Re=>"metadata_offset_"in Re,get:Re=>Re.metadata_offset_,set:(Re,Be)=>{Re.metadata_offset_=Be}},metadata:re},Fe,Se),zs(null,null,Ce,{kind:"field",name:"metadata_offset",static:!1,private:!1,access:{has:Re=>"metadata_offset"in Re,get:Re=>Re.metadata_offset,set:(Re,Be)=>{Re.metadata_offset=Be}},metadata:re},qe,Qe),zs(null,null,We,{kind:"field",name:"label",static:!1,private:!1,access:{has:Re=>"label"in Re,get:Re=>Re.label,set:(Re,Be)=>{Re.label=Be}},metadata:re},Ie,K),zs(null,null,ye,{kind:"field",name:"_padding",static:!1,private:!1,access:{has:Re=>"_padding"in Re,get:Re=>Re._padding,set:(Re,Be)=>{Re._padding=Be}},metadata:re},Ne,ce),zs(null,h={value:y},d,{kind:"class",name:y.name,metadata:re},null,m),oe=y=h.value,re&&Object.defineProperty(y,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:re}),cr(y,m)})(),oe=y})();function RY(e){const t=va(e),n=h2e(t.subarray(4));return e.checksum===n}globalThis.__zenfs__=fa;function p2e(e){switch(e.name){case"TypeMismatchError":return"EPERM";case"IndexSizeError":case"HierarchyRequestError":case"InvalidCharacterError":case"InvalidStateError":case"SyntaxError":case"NamespaceError":case"ConstraintError":case"VersionError":case"URLMismatchError":case"InvalidNodeTypeError":return"EINVAL";case"WrongDocumentError":return"EXDEV";case"NoModificationAllowedError":case"InvalidModificationError":case"InvalidAccessError":case"SecurityError":case"NotAllowedError":return"EACCES";case"NotFoundError":return"ENOENT";case"NotSupportedError":return"ENOTSUP";case"InUseAttributeError":return"EBUSY";case"NetworkError":return"ENETDOWN";case"AbortError":return"EINTR";case"QuotaExceededError":return"ENOSPC";case"TimeoutError":return"ETIMEDOUT";case"ReadOnlyError":return"EROFS";case"DataCloneError":case"EncodingError":case"NotReadableError":case"DataError":case"TransactionInactiveError":case"OperationError":case"UnknownError":default:return"EIO"}}function Ij(e,t,n){if(e instanceof Ze)return e;const r=e instanceof DOMException?bt[p2e(e)]:bt.EIO,s=new Ze(r,e.message,t,n);return s.stack=e.stack,s.cause=e.cause,s}function v0(e){return new Promise((t,n)=>{e.onsuccess=()=>t(e.result),e.onerror=r=>{r.preventDefault(),n(Ij(e.error))}})}class m2e extends Rj{constructor(t,n){super(n),this.tx=t,this.store=n,this._idb=t.objectStore(n.name)}async keys(){return(await v0(this._idb.getAllKeys())).filter(t=>typeof t=="string").map(t=>Number(t))}async get(t){const n=await v0(this._idb.get(t.toString()));return n&&this._cached(t,{size:n.byteLength}).add(n,0),n}async set(t,n){this._cached(t,{size:n.byteLength}).add(n,0),await v0(this._idb.put(n,t.toString()))}remove(t){return this.store.cache.delete(t),v0(this._idb.delete(t.toString()))}async commit(){const{promise:t,resolve:n,reject:r}=Promise.withResolvers();return this.tx.oncomplete=()=>n(),this.tx.onerror=()=>r(Ij(this.tx.error)),this.tx.commit(),t}async abort(){const{promise:t,resolve:n,reject:r}=Promise.withResolvers();return this.tx.onabort=()=>n(),this.tx.onerror=()=>r(Ij(this.tx.error)),this.tx.abort(),t}}async function g2e(e,t=globalThis.indexedDB){const n=t.open(e);return n.onupgradeneeded=()=>{const r=n.result;r.objectStoreNames.contains(e)&&(Fa("Found unexpected object store: "+e),r.deleteObjectStore(e)),r.createObjectStore(e)},await v0(n)}class y2e{constructor(t){this.db=t,this.cache=new Map}sync(){return Promise.resolve()}get name(){return this.db.name}transaction(){const t=this.db.transaction(this.name,"readwrite");return new m2e(t,this)}}const b2e={name:"IndexedDB",options:{storeName:{type:"string",required:!1},idbFactory:{type:"object",required:!1}},async isAvailable({idbFactory:e=globalThis.indexedDB}){try{if(!(e instanceof IDBFactory))return!1;const t=e.open("__zenfs_test");return await v0(t),!0}catch{return!1}finally{e==null||e.deleteDatabase("__zenfs_test")}},async create(e){const t=await g2e(e.storeName||"zenfs",e.idbFactory),n=new y2e(t),r=new VK(n);if(e!=null&&e.disableAsyncCache)return jP("Async preloading disabled for IndexedDB"),r;const s=n.transaction();for(const i of await s.keys())await s.get(i);return r}},v2e=b2e,dn={vfsKeyChanged:"vfs.key.changed",nodesUpdated:"vfs.nodes.updated",selectionChanged:"vfs.selection.changed",loadingStateChanged:"vfs.loading.state.changed",fsInstanceChanged:"vfs.instance.changed",vfsEnabledChanged:"vfs.enabled.changed",fileWritten:"vfs.sdk.fileWritten",fileRead:"vfs.sdk.fileRead",fileDeleted:"vfs.sdk.fileDeleted",setVfsKeyRequest:"vfs.set.vfs.key.request",initializeVFSRequest:"vfs.initialize.vfs.request",fetchNodesRequest:"vfs.fetch.nodes.request",setCurrentPathRequest:"vfs.set.current.path.request",createDirectoryRequest:"vfs.create.directory.request",uploadFilesRequest:"vfs.upload.files.request",deleteNodesRequest:"vfs.delete.nodes.request",renameNodeRequest:"vfs.rename.node.request",downloadFileRequest:"vfs.download.file.request",selectFileRequest:"vfs.select.file.request",deselectFileRequest:"vfs.deselect.file.request",clearSelectionRequest:"vfs.clear.selection.request",setEnableVfsRequest:"vfs.set.enable.vfs.request"};function $S(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var IM={exports:{}},I9;function x2e(){return I9||(I9=1,function(e,t){(function(n){e.exports=n()})(function(){return function n(r,s,i){function a(c,u){if(!s[c]){if(!r[c]){var d=typeof $S=="function"&&$S;if(!u&&d)return d(c,!0);if(o)return o(c,!0);var h=new Error("Cannot find module '"+c+"'");throw h.code="MODULE_NOT_FOUND",h}var m=s[c]={exports:{}};r[c][0].call(m.exports,function(y){var b=r[c][1][y];return a(b||y)},m,m.exports,n,r,s,i)}return s[c].exports}for(var o=typeof $S=="function"&&$S,l=0;l<i.length;l++)a(i[l]);return a}({1:[function(n,r,s){var i=n("./utils"),a=n("./support"),o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";s.encode=function(l){for(var c,u,d,h,m,y,b,v=[],x=0,w=l.length,S=w,k=i.getTypeOf(l)!=="string";x<l.length;)S=w-x,d=k?(c=l[x++],u=x<w?l[x++]:0,x<w?l[x++]:0):(c=l.charCodeAt(x++),u=x<w?l.charCodeAt(x++):0,x<w?l.charCodeAt(x++):0),h=c>>2,m=(3&c)<<4|u>>4,y=1<S?(15&u)<<2|d>>6:64,b=2<S?63&d:64,v.push(o.charAt(h)+o.charAt(m)+o.charAt(y)+o.charAt(b));return v.join("")},s.decode=function(l){var c,u,d,h,m,y,b=0,v=0,x="data:";if(l.substr(0,x.length)===x)throw new Error("Invalid base64 input, it looks like a data url.");var w,S=3*(l=l.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(l.charAt(l.length-1)===o.charAt(64)&&S--,l.charAt(l.length-2)===o.charAt(64)&&S--,S%1!=0)throw new Error("Invalid base64 input, bad content length.");for(w=a.uint8array?new Uint8Array(0|S):new Array(0|S);b<l.length;)c=o.indexOf(l.charAt(b++))<<2|(h=o.indexOf(l.charAt(b++)))>>4,u=(15&h)<<4|(m=o.indexOf(l.charAt(b++)))>>2,d=(3&m)<<6|(y=o.indexOf(l.charAt(b++))),w[v++]=c,m!==64&&(w[v++]=u),y!==64&&(w[v++]=d);return w}},{"./support":30,"./utils":32}],2:[function(n,r,s){var i=n("./external"),a=n("./stream/DataWorker"),o=n("./stream/Crc32Probe"),l=n("./stream/DataLengthProbe");function c(u,d,h,m,y){this.compressedSize=u,this.uncompressedSize=d,this.crc32=h,this.compression=m,this.compressedContent=y}c.prototype={getContentWorker:function(){var u=new a(i.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new l("data_length")),d=this;return u.on("end",function(){if(this.streamInfo.data_length!==d.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),u},getCompressedWorker:function(){return new a(i.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},c.createWorkerFrom=function(u,d,h){return u.pipe(new o).pipe(new l("uncompressedSize")).pipe(d.compressWorker(h)).pipe(new l("compressedSize")).withStreamInfo("compression",d)},r.exports=c},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(n,r,s){var i=n("./stream/GenericWorker");s.STORE={magic:"\0\0",compressWorker:function(){return new i("STORE compression")},uncompressWorker:function(){return new i("STORE decompression")}},s.DEFLATE=n("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(n,r,s){var i=n("./utils"),a=function(){for(var o,l=[],c=0;c<256;c++){o=c;for(var u=0;u<8;u++)o=1&o?3988292384^o>>>1:o>>>1;l[c]=o}return l}();r.exports=function(o,l){return o!==void 0&&o.length?i.getTypeOf(o)!=="string"?function(c,u,d,h){var m=a,y=h+d;c^=-1;for(var b=h;b<y;b++)c=c>>>8^m[255&(c^u[b])];return-1^c}(0|l,o,o.length,0):function(c,u,d,h){var m=a,y=h+d;c^=-1;for(var b=h;b<y;b++)c=c>>>8^m[255&(c^u.charCodeAt(b))];return-1^c}(0|l,o,o.length,0):0}},{"./utils":32}],5:[function(n,r,s){s.base64=!1,s.binary=!1,s.dir=!1,s.createFolders=!0,s.date=null,s.compression=null,s.compressionOptions=null,s.comment=null,s.unixPermissions=null,s.dosPermissions=null},{}],6:[function(n,r,s){var i=null;i=typeof Promise<"u"?Promise:n("lie"),r.exports={Promise:i}},{lie:37}],7:[function(n,r,s){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",a=n("pako"),o=n("./utils"),l=n("./stream/GenericWorker"),c=i?"uint8array":"array";function u(d,h){l.call(this,"FlateWorker/"+d),this._pako=null,this._pakoAction=d,this._pakoOptions=h,this.meta={}}s.magic="\b\0",o.inherits(u,l),u.prototype.processChunk=function(d){this.meta=d.meta,this._pako===null&&this._createPako(),this._pako.push(o.transformTo(c,d.data),!1)},u.prototype.flush=function(){l.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},u.prototype.cleanUp=function(){l.prototype.cleanUp.call(this),this._pako=null},u.prototype._createPako=function(){this._pako=new a[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var d=this;this._pako.onData=function(h){d.push({data:h,meta:d.meta})}},s.compressWorker=function(d){return new u("Deflate",d)},s.uncompressWorker=function(){return new u("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(n,r,s){function i(m,y){var b,v="";for(b=0;b<y;b++)v+=String.fromCharCode(255&m),m>>>=8;return v}function a(m,y,b,v,x,w){var S,k,C=m.file,T=m.compression,R=w!==c.utf8encode,N=o.transformTo("string",w(C.name)),I=o.transformTo("string",c.utf8encode(C.name)),P=C.comment,B=o.transformTo("string",w(P)),D=o.transformTo("string",c.utf8encode(P)),W=I.length!==C.name.length,O=D.length!==P.length,Z="",U="",H="",L=C.dir,te=C.date,V={crc32:0,compressedSize:0,uncompressedSize:0};y&&!b||(V.crc32=m.crc32,V.compressedSize=m.compressedSize,V.uncompressedSize=m.uncompressedSize);var Q=0;y&&(Q|=8),R||!W&&!O||(Q|=2048);var ee=0,se=0;L&&(ee|=16),x==="UNIX"?(se=798,ee|=function(ue,Oe){var Fe=ue;return ue||(Fe=Oe?16893:33204),(65535&Fe)<<16}(C.unixPermissions,L)):(se=20,ee|=function(ue){return 63&(ue||0)}(C.dosPermissions)),S=te.getUTCHours(),S<<=6,S|=te.getUTCMinutes(),S<<=5,S|=te.getUTCSeconds()/2,k=te.getUTCFullYear()-1980,k<<=4,k|=te.getUTCMonth()+1,k<<=5,k|=te.getUTCDate(),W&&(U=i(1,1)+i(u(N),4)+I,Z+="up"+i(U.length,2)+U),O&&(H=i(1,1)+i(u(B),4)+D,Z+="uc"+i(H.length,2)+H);var pe="";return pe+=`
\0`,pe+=i(Q,2),pe+=T.magic,pe+=i(S,2),pe+=i(k,2),pe+=i(V.crc32,4),pe+=i(V.compressedSize,4),pe+=i(V.uncompressedSize,4),pe+=i(N.length,2),pe+=i(Z.length,2),{fileRecord:d.LOCAL_FILE_HEADER+pe+N+Z,dirRecord:d.CENTRAL_FILE_HEADER+i(se,2)+pe+i(B.length,2)+"\0\0\0\0"+i(ee,4)+i(v,4)+N+Z+B}}var o=n("../utils"),l=n("../stream/GenericWorker"),c=n("../utf8"),u=n("../crc32"),d=n("../signature");function h(m,y,b,v){l.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=y,this.zipPlatform=b,this.encodeFileName=v,this.streamFiles=m,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}o.inherits(h,l),h.prototype.push=function(m){var y=m.meta.percent||0,b=this.entriesCount,v=this._sources.length;this.accumulate?this.contentBuffer.push(m):(this.bytesWritten+=m.data.length,l.prototype.push.call(this,{data:m.data,meta:{currentFile:this.currentFile,percent:b?(y+100*(b-v-1))/b:100}}))},h.prototype.openedSource=function(m){this.currentSourceOffset=this.bytesWritten,this.currentFile=m.file.name;var y=this.streamFiles&&!m.file.dir;if(y){var b=a(m,y,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:b.fileRecord,meta:{percent:0}})}else this.accumulate=!0},h.prototype.closedSource=function(m){this.accumulate=!1;var y=this.streamFiles&&!m.file.dir,b=a(m,y,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(b.dirRecord),y)this.push({data:function(v){return d.DATA_DESCRIPTOR+i(v.crc32,4)+i(v.compressedSize,4)+i(v.uncompressedSize,4)}(m),meta:{percent:100}});else for(this.push({data:b.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},h.prototype.flush=function(){for(var m=this.bytesWritten,y=0;y<this.dirRecords.length;y++)this.push({data:this.dirRecords[y],meta:{percent:100}});var b=this.bytesWritten-m,v=function(x,w,S,k,C){var T=o.transformTo("string",C(k));return d.CENTRAL_DIRECTORY_END+"\0\0\0\0"+i(x,2)+i(x,2)+i(w,4)+i(S,4)+i(T.length,2)+T}(this.dirRecords.length,b,m,this.zipComment,this.encodeFileName);this.push({data:v,meta:{percent:100}})},h.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},h.prototype.registerPrevious=function(m){this._sources.push(m);var y=this;return m.on("data",function(b){y.processChunk(b)}),m.on("end",function(){y.closedSource(y.previous.streamInfo),y._sources.length?y.prepareNextSource():y.end()}),m.on("error",function(b){y.error(b)}),this},h.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},h.prototype.error=function(m){var y=this._sources;if(!l.prototype.error.call(this,m))return!1;for(var b=0;b<y.length;b++)try{y[b].error(m)}catch{}return!0},h.prototype.lock=function(){l.prototype.lock.call(this);for(var m=this._sources,y=0;y<m.length;y++)m[y].lock()},r.exports=h},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(n,r,s){var i=n("../compressions"),a=n("./ZipFileWorker");s.generateWorker=function(o,l,c){var u=new a(l.streamFiles,c,l.platform,l.encodeFileName),d=0;try{o.forEach(function(h,m){d++;var y=function(w,S){var k=w||S,C=i[k];if(!C)throw new Error(k+" is not a valid compression method !");return C}(m.options.compression,l.compression),b=m.options.compressionOptions||l.compressionOptions||{},v=m.dir,x=m.date;m._compressWorker(y,b).withStreamInfo("file",{name:h,dir:v,date:x,comment:m.comment||"",unixPermissions:m.unixPermissions,dosPermissions:m.dosPermissions}).pipe(u)}),u.entriesCount=d}catch(h){u.error(h)}return u}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(n,r,s){function i(){if(!(this instanceof i))return new i;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var a=new i;for(var o in this)typeof this[o]!="function"&&(a[o]=this[o]);return a}}(i.prototype=n("./object")).loadAsync=n("./load"),i.support=n("./support"),i.defaults=n("./defaults"),i.version="3.10.1",i.loadAsync=function(a,o){return new i().loadAsync(a,o)},i.external=n("./external"),r.exports=i},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(n,r,s){var i=n("./utils"),a=n("./external"),o=n("./utf8"),l=n("./zipEntries"),c=n("./stream/Crc32Probe"),u=n("./nodejsUtils");function d(h){return new a.Promise(function(m,y){var b=h.decompressed.getContentWorker().pipe(new c);b.on("error",function(v){y(v)}).on("end",function(){b.streamInfo.crc32!==h.decompressed.crc32?y(new Error("Corrupted zip : CRC32 mismatch")):m()}).resume()})}r.exports=function(h,m){var y=this;return m=i.extend(m||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:o.utf8decode}),u.isNode&&u.isStream(h)?a.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):i.prepareContent("the loaded zip file",h,!0,m.optimizedBinaryString,m.base64).then(function(b){var v=new l(m);return v.load(b),v}).then(function(b){var v=[a.Promise.resolve(b)],x=b.files;if(m.checkCRC32)for(var w=0;w<x.length;w++)v.push(d(x[w]));return a.Promise.all(v)}).then(function(b){for(var v=b.shift(),x=v.files,w=0;w<x.length;w++){var S=x[w],k=S.fileNameStr,C=i.resolve(S.fileNameStr);y.file(C,S.decompressed,{binary:!0,optimizedBinaryString:!0,date:S.date,dir:S.dir,comment:S.fileCommentStr.length?S.fileCommentStr:null,unixPermissions:S.unixPermissions,dosPermissions:S.dosPermissions,createFolders:m.createFolders}),S.dir||(y.file(C).unsafeOriginalName=k)}return v.zipComment.length&&(y.comment=v.zipComment),y})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(n,r,s){var i=n("../utils"),a=n("../stream/GenericWorker");function o(l,c){a.call(this,"Nodejs stream input adapter for "+l),this._upstreamEnded=!1,this._bindStream(c)}i.inherits(o,a),o.prototype._bindStream=function(l){var c=this;(this._stream=l).pause(),l.on("data",function(u){c.push({data:u,meta:{percent:0}})}).on("error",function(u){c.isPaused?this.generatedError=u:c.error(u)}).on("end",function(){c.isPaused?c._upstreamEnded=!0:c.end()})},o.prototype.pause=function(){return!!a.prototype.pause.call(this)&&(this._stream.pause(),!0)},o.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},r.exports=o},{"../stream/GenericWorker":28,"../utils":32}],13:[function(n,r,s){var i=n("readable-stream").Readable;function a(o,l,c){i.call(this,l),this._helper=o;var u=this;o.on("data",function(d,h){u.push(d)||u._helper.pause(),c&&c(h)}).on("error",function(d){u.emit("error",d)}).on("end",function(){u.push(null)})}n("../utils").inherits(a,i),a.prototype._read=function(){this._helper.resume()},r.exports=a},{"../utils":32,"readable-stream":16}],14:[function(n,r,s){r.exports={isNode:typeof ln<"u",newBufferFrom:function(i,a){if(ln.from&&ln.from!==Uint8Array.from)return ln.from(i,a);if(typeof i=="number")throw new Error('The "data" argument must not be a number');return new ln(i,a)},allocBuffer:function(i){if(ln.alloc)return ln.alloc(i);var a=new ln(i);return a.fill(0),a},isBuffer:function(i){return ln.isBuffer(i)},isStream:function(i){return i&&typeof i.on=="function"&&typeof i.pause=="function"&&typeof i.resume=="function"}}},{}],15:[function(n,r,s){function i(C,T,R){var N,I=o.getTypeOf(T),P=o.extend(R||{},u);P.date=P.date||new Date,P.compression!==null&&(P.compression=P.compression.toUpperCase()),typeof P.unixPermissions=="string"&&(P.unixPermissions=parseInt(P.unixPermissions,8)),P.unixPermissions&&16384&P.unixPermissions&&(P.dir=!0),P.dosPermissions&&16&P.dosPermissions&&(P.dir=!0),P.dir&&(C=x(C)),P.createFolders&&(N=v(C))&&w.call(this,N,!0);var B=I==="string"&&P.binary===!1&&P.base64===!1;R&&R.binary!==void 0||(P.binary=!B),(T instanceof d&&T.uncompressedSize===0||P.dir||!T||T.length===0)&&(P.base64=!1,P.binary=!0,T="",P.compression="STORE",I="string");var D=null;D=T instanceof d||T instanceof l?T:y.isNode&&y.isStream(T)?new b(C,T):o.prepareContent(C,T,P.binary,P.optimizedBinaryString,P.base64);var W=new h(C,D,P);this.files[C]=W}var a=n("./utf8"),o=n("./utils"),l=n("./stream/GenericWorker"),c=n("./stream/StreamHelper"),u=n("./defaults"),d=n("./compressedObject"),h=n("./zipObject"),m=n("./generate"),y=n("./nodejsUtils"),b=n("./nodejs/NodejsStreamInputAdapter"),v=function(C){C.slice(-1)==="/"&&(C=C.substring(0,C.length-1));var T=C.lastIndexOf("/");return 0<T?C.substring(0,T):""},x=function(C){return C.slice(-1)!=="/"&&(C+="/"),C},w=function(C,T){return T=T!==void 0?T:u.createFolders,C=x(C),this.files[C]||i.call(this,C,null,{dir:!0,createFolders:T}),this.files[C]};function S(C){return Object.prototype.toString.call(C)==="[object RegExp]"}var k={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(C){var T,R,N;for(T in this.files)N=this.files[T],(R=T.slice(this.root.length,T.length))&&T.slice(0,this.root.length)===this.root&&C(R,N)},filter:function(C){var T=[];return this.forEach(function(R,N){C(R,N)&&T.push(N)}),T},file:function(C,T,R){if(arguments.length!==1)return C=this.root+C,i.call(this,C,T,R),this;if(S(C)){var N=C;return this.filter(function(P,B){return!B.dir&&N.test(P)})}var I=this.files[this.root+C];return I&&!I.dir?I:null},folder:function(C){if(!C)return this;if(S(C))return this.filter(function(I,P){return P.dir&&C.test(I)});var T=this.root+C,R=w.call(this,T),N=this.clone();return N.root=R.name,N},remove:function(C){C=this.root+C;var T=this.files[C];if(T||(C.slice(-1)!=="/"&&(C+="/"),T=this.files[C]),T&&!T.dir)delete this.files[C];else for(var R=this.filter(function(I,P){return P.name.slice(0,C.length)===C}),N=0;N<R.length;N++)delete this.files[R[N].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(C){var T,R={};try{if((R=o.extend(C||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:a.utf8encode})).type=R.type.toLowerCase(),R.compression=R.compression.toUpperCase(),R.type==="binarystring"&&(R.type="string"),!R.type)throw new Error("No output type specified.");o.checkSupport(R.type),R.platform!=="darwin"&&R.platform!=="freebsd"&&R.platform!=="linux"&&R.platform!=="sunos"||(R.platform="UNIX"),R.platform==="win32"&&(R.platform="DOS");var N=R.comment||this.comment||"";T=m.generateWorker(this,R,N)}catch(I){(T=new l("error")).error(I)}return new c(T,R.type||"string",R.mimeType)},generateAsync:function(C,T){return this.generateInternalStream(C).accumulate(T)},generateNodeStream:function(C,T){return(C=C||{}).type||(C.type="nodebuffer"),this.generateInternalStream(C).toNodejsStream(T)}};r.exports=k},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(n,r,s){r.exports=n("stream")},{stream:void 0}],17:[function(n,r,s){var i=n("./DataReader");function a(o){i.call(this,o);for(var l=0;l<this.data.length;l++)o[l]=255&o[l]}n("../utils").inherits(a,i),a.prototype.byteAt=function(o){return this.data[this.zero+o]},a.prototype.lastIndexOfSignature=function(o){for(var l=o.charCodeAt(0),c=o.charCodeAt(1),u=o.charCodeAt(2),d=o.charCodeAt(3),h=this.length-4;0<=h;--h)if(this.data[h]===l&&this.data[h+1]===c&&this.data[h+2]===u&&this.data[h+3]===d)return h-this.zero;return-1},a.prototype.readAndCheckSignature=function(o){var l=o.charCodeAt(0),c=o.charCodeAt(1),u=o.charCodeAt(2),d=o.charCodeAt(3),h=this.readData(4);return l===h[0]&&c===h[1]&&u===h[2]&&d===h[3]},a.prototype.readData=function(o){if(this.checkOffset(o),o===0)return[];var l=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},r.exports=a},{"../utils":32,"./DataReader":18}],18:[function(n,r,s){var i=n("../utils");function a(o){this.data=o,this.length=o.length,this.index=0,this.zero=0}a.prototype={checkOffset:function(o){this.checkIndex(this.index+o)},checkIndex:function(o){if(this.length<this.zero+o||o<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+o+"). Corrupted zip ?")},setIndex:function(o){this.checkIndex(o),this.index=o},skip:function(o){this.setIndex(this.index+o)},byteAt:function(){},readInt:function(o){var l,c=0;for(this.checkOffset(o),l=this.index+o-1;l>=this.index;l--)c=(c<<8)+this.byteAt(l);return this.index+=o,c},readString:function(o){return i.transformTo("string",this.readData(o))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var o=this.readInt(4);return new Date(Date.UTC(1980+(o>>25&127),(o>>21&15)-1,o>>16&31,o>>11&31,o>>5&63,(31&o)<<1))}},r.exports=a},{"../utils":32}],19:[function(n,r,s){var i=n("./Uint8ArrayReader");function a(o){i.call(this,o)}n("../utils").inherits(a,i),a.prototype.readData=function(o){this.checkOffset(o);var l=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},r.exports=a},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(n,r,s){var i=n("./DataReader");function a(o){i.call(this,o)}n("../utils").inherits(a,i),a.prototype.byteAt=function(o){return this.data.charCodeAt(this.zero+o)},a.prototype.lastIndexOfSignature=function(o){return this.data.lastIndexOf(o)-this.zero},a.prototype.readAndCheckSignature=function(o){return o===this.readData(4)},a.prototype.readData=function(o){this.checkOffset(o);var l=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},r.exports=a},{"../utils":32,"./DataReader":18}],21:[function(n,r,s){var i=n("./ArrayReader");function a(o){i.call(this,o)}n("../utils").inherits(a,i),a.prototype.readData=function(o){if(this.checkOffset(o),o===0)return new Uint8Array(0);var l=this.data.subarray(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},r.exports=a},{"../utils":32,"./ArrayReader":17}],22:[function(n,r,s){var i=n("../utils"),a=n("../support"),o=n("./ArrayReader"),l=n("./StringReader"),c=n("./NodeBufferReader"),u=n("./Uint8ArrayReader");r.exports=function(d){var h=i.getTypeOf(d);return i.checkSupport(h),h!=="string"||a.uint8array?h==="nodebuffer"?new c(d):a.uint8array?new u(i.transformTo("uint8array",d)):new o(i.transformTo("array",d)):new l(d)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(n,r,s){s.LOCAL_FILE_HEADER="PK",s.CENTRAL_FILE_HEADER="PK",s.CENTRAL_DIRECTORY_END="PK",s.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",s.ZIP64_CENTRAL_DIRECTORY_END="PK",s.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(n,r,s){var i=n("./GenericWorker"),a=n("../utils");function o(l){i.call(this,"ConvertWorker to "+l),this.destType=l}a.inherits(o,i),o.prototype.processChunk=function(l){this.push({data:a.transformTo(this.destType,l.data),meta:l.meta})},r.exports=o},{"../utils":32,"./GenericWorker":28}],25:[function(n,r,s){var i=n("./GenericWorker"),a=n("../crc32");function o(){i.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}n("../utils").inherits(o,i),o.prototype.processChunk=function(l){this.streamInfo.crc32=a(l.data,this.streamInfo.crc32||0),this.push(l)},r.exports=o},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(n,r,s){var i=n("../utils"),a=n("./GenericWorker");function o(l){a.call(this,"DataLengthProbe for "+l),this.propName=l,this.withStreamInfo(l,0)}i.inherits(o,a),o.prototype.processChunk=function(l){if(l){var c=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=c+l.data.length}a.prototype.processChunk.call(this,l)},r.exports=o},{"../utils":32,"./GenericWorker":28}],27:[function(n,r,s){var i=n("../utils"),a=n("./GenericWorker");function o(l){a.call(this,"DataWorker");var c=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,l.then(function(u){c.dataIsReady=!0,c.data=u,c.max=u&&u.length||0,c.type=i.getTypeOf(u),c.isPaused||c._tickAndRepeat()},function(u){c.error(u)})}i.inherits(o,a),o.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this.data=null},o.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,i.delay(this._tickAndRepeat,[],this)),!0)},o.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(i.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},o.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var l=null,c=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":l=this.data.substring(this.index,c);break;case"uint8array":l=this.data.subarray(this.index,c);break;case"array":case"nodebuffer":l=this.data.slice(this.index,c)}return this.index=c,this.push({data:l,meta:{percent:this.max?this.index/this.max*100:0}})},r.exports=o},{"../utils":32,"./GenericWorker":28}],28:[function(n,r,s){function i(a){this.name=a||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}i.prototype={push:function(a){this.emit("data",a)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(a){this.emit("error",a)}return!0},error:function(a){return!this.isFinished&&(this.isPaused?this.generatedError=a:(this.isFinished=!0,this.emit("error",a),this.previous&&this.previous.error(a),this.cleanUp()),!0)},on:function(a,o){return this._listeners[a].push(o),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(a,o){if(this._listeners[a])for(var l=0;l<this._listeners[a].length;l++)this._listeners[a][l].call(this,o)},pipe:function(a){return a.registerPrevious(this)},registerPrevious:function(a){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=a.streamInfo,this.mergeStreamInfo(),this.previous=a;var o=this;return a.on("data",function(l){o.processChunk(l)}),a.on("end",function(){o.end()}),a.on("error",function(l){o.error(l)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var a=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),a=!0),this.previous&&this.previous.resume(),!a},flush:function(){},processChunk:function(a){this.push(a)},withStreamInfo:function(a,o){return this.extraStreamInfo[a]=o,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var a in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,a)&&(this.streamInfo[a]=this.extraStreamInfo[a])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var a="Worker "+this.name;return this.previous?this.previous+" -> "+a:a}},r.exports=i},{}],29:[function(n,r,s){var i=n("../utils"),a=n("./ConvertWorker"),o=n("./GenericWorker"),l=n("../base64"),c=n("../support"),u=n("../external"),d=null;if(c.nodestream)try{d=n("../nodejs/NodejsStreamOutputAdapter")}catch{}function h(y,b){return new u.Promise(function(v,x){var w=[],S=y._internalType,k=y._outputType,C=y._mimeType;y.on("data",function(T,R){w.push(T),b&&b(R)}).on("error",function(T){w=[],x(T)}).on("end",function(){try{var T=function(R,N,I){switch(R){case"blob":return i.newBlob(i.transformTo("arraybuffer",N),I);case"base64":return l.encode(N);default:return i.transformTo(R,N)}}(k,function(R,N){var I,P=0,B=null,D=0;for(I=0;I<N.length;I++)D+=N[I].length;switch(R){case"string":return N.join("");case"array":return Array.prototype.concat.apply([],N);case"uint8array":for(B=new Uint8Array(D),I=0;I<N.length;I++)B.set(N[I],P),P+=N[I].length;return B;case"nodebuffer":return ln.concat(N);default:throw new Error("concat : unsupported type '"+R+"'")}}(S,w),C);v(T)}catch(R){x(R)}w=[]}).resume()})}function m(y,b,v){var x=b;switch(b){case"blob":case"arraybuffer":x="uint8array";break;case"base64":x="string"}try{this._internalType=x,this._outputType=b,this._mimeType=v,i.checkSupport(x),this._worker=y.pipe(new a(x)),y.lock()}catch(w){this._worker=new o("error"),this._worker.error(w)}}m.prototype={accumulate:function(y){return h(this,y)},on:function(y,b){var v=this;return y==="data"?this._worker.on(y,function(x){b.call(v,x.data,x.meta)}):this._worker.on(y,function(){i.delay(b,arguments,v)}),this},resume:function(){return i.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(y){if(i.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new d(this,{objectMode:this._outputType!=="nodebuffer"},y)}},r.exports=m},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(n,r,s){if(s.base64=!0,s.array=!0,s.string=!0,s.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",s.nodebuffer=typeof ln<"u",s.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")s.blob=!1;else{var i=new ArrayBuffer(0);try{s.blob=new Blob([i],{type:"application/zip"}).size===0}catch{try{var a=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);a.append(i),s.blob=a.getBlob("application/zip").size===0}catch{s.blob=!1}}}try{s.nodestream=!!n("readable-stream").Readable}catch{s.nodestream=!1}},{"readable-stream":16}],31:[function(n,r,s){for(var i=n("./utils"),a=n("./support"),o=n("./nodejsUtils"),l=n("./stream/GenericWorker"),c=new Array(256),u=0;u<256;u++)c[u]=252<=u?6:248<=u?5:240<=u?4:224<=u?3:192<=u?2:1;c[254]=c[254]=1;function d(){l.call(this,"utf-8 decode"),this.leftOver=null}function h(){l.call(this,"utf-8 encode")}s.utf8encode=function(m){return a.nodebuffer?o.newBufferFrom(m,"utf-8"):function(y){var b,v,x,w,S,k=y.length,C=0;for(w=0;w<k;w++)(64512&(v=y.charCodeAt(w)))==55296&&w+1<k&&(64512&(x=y.charCodeAt(w+1)))==56320&&(v=65536+(v-55296<<10)+(x-56320),w++),C+=v<128?1:v<2048?2:v<65536?3:4;for(b=a.uint8array?new Uint8Array(C):new Array(C),w=S=0;S<C;w++)(64512&(v=y.charCodeAt(w)))==55296&&w+1<k&&(64512&(x=y.charCodeAt(w+1)))==56320&&(v=65536+(v-55296<<10)+(x-56320),w++),v<128?b[S++]=v:(v<2048?b[S++]=192|v>>>6:(v<65536?b[S++]=224|v>>>12:(b[S++]=240|v>>>18,b[S++]=128|v>>>12&63),b[S++]=128|v>>>6&63),b[S++]=128|63&v);return b}(m)},s.utf8decode=function(m){return a.nodebuffer?i.transformTo("nodebuffer",m).toString("utf-8"):function(y){var b,v,x,w,S=y.length,k=new Array(2*S);for(b=v=0;b<S;)if((x=y[b++])<128)k[v++]=x;else if(4<(w=c[x]))k[v++]=65533,b+=w-1;else{for(x&=w===2?31:w===3?15:7;1<w&&b<S;)x=x<<6|63&y[b++],w--;1<w?k[v++]=65533:x<65536?k[v++]=x:(x-=65536,k[v++]=55296|x>>10&1023,k[v++]=56320|1023&x)}return k.length!==v&&(k.subarray?k=k.subarray(0,v):k.length=v),i.applyFromCharCode(k)}(m=i.transformTo(a.uint8array?"uint8array":"array",m))},i.inherits(d,l),d.prototype.processChunk=function(m){var y=i.transformTo(a.uint8array?"uint8array":"array",m.data);if(this.leftOver&&this.leftOver.length){if(a.uint8array){var b=y;(y=new Uint8Array(b.length+this.leftOver.length)).set(this.leftOver,0),y.set(b,this.leftOver.length)}else y=this.leftOver.concat(y);this.leftOver=null}var v=function(w,S){var k;for((S=S||w.length)>w.length&&(S=w.length),k=S-1;0<=k&&(192&w[k])==128;)k--;return k<0||k===0?S:k+c[w[k]]>S?k:S}(y),x=y;v!==y.length&&(a.uint8array?(x=y.subarray(0,v),this.leftOver=y.subarray(v,y.length)):(x=y.slice(0,v),this.leftOver=y.slice(v,y.length))),this.push({data:s.utf8decode(x),meta:m.meta})},d.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:s.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},s.Utf8DecodeWorker=d,i.inherits(h,l),h.prototype.processChunk=function(m){this.push({data:s.utf8encode(m.data),meta:m.meta})},s.Utf8EncodeWorker=h},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(n,r,s){var i=n("./support"),a=n("./base64"),o=n("./nodejsUtils"),l=n("./external");function c(b){return b}function u(b,v){for(var x=0;x<b.length;++x)v[x]=255&b.charCodeAt(x);return v}n("setimmediate"),s.newBlob=function(b,v){s.checkSupport("blob");try{return new Blob([b],{type:v})}catch{try{var x=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return x.append(b),x.getBlob(v)}catch{throw new Error("Bug : can't construct the Blob.")}}};var d={stringifyByChunk:function(b,v,x){var w=[],S=0,k=b.length;if(k<=x)return String.fromCharCode.apply(null,b);for(;S<k;)v==="array"||v==="nodebuffer"?w.push(String.fromCharCode.apply(null,b.slice(S,Math.min(S+x,k)))):w.push(String.fromCharCode.apply(null,b.subarray(S,Math.min(S+x,k)))),S+=x;return w.join("")},stringifyByChar:function(b){for(var v="",x=0;x<b.length;x++)v+=String.fromCharCode(b[x]);return v},applyCanBeUsed:{uint8array:function(){try{return i.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return i.nodebuffer&&String.fromCharCode.apply(null,o.allocBuffer(1)).length===1}catch{return!1}}()}};function h(b){var v=65536,x=s.getTypeOf(b),w=!0;if(x==="uint8array"?w=d.applyCanBeUsed.uint8array:x==="nodebuffer"&&(w=d.applyCanBeUsed.nodebuffer),w)for(;1<v;)try{return d.stringifyByChunk(b,x,v)}catch{v=Math.floor(v/2)}return d.stringifyByChar(b)}function m(b,v){for(var x=0;x<b.length;x++)v[x]=b[x];return v}s.applyFromCharCode=h;var y={};y.string={string:c,array:function(b){return u(b,new Array(b.length))},arraybuffer:function(b){return y.string.uint8array(b).buffer},uint8array:function(b){return u(b,new Uint8Array(b.length))},nodebuffer:function(b){return u(b,o.allocBuffer(b.length))}},y.array={string:h,array:c,arraybuffer:function(b){return new Uint8Array(b).buffer},uint8array:function(b){return new Uint8Array(b)},nodebuffer:function(b){return o.newBufferFrom(b)}},y.arraybuffer={string:function(b){return h(new Uint8Array(b))},array:function(b){return m(new Uint8Array(b),new Array(b.byteLength))},arraybuffer:c,uint8array:function(b){return new Uint8Array(b)},nodebuffer:function(b){return o.newBufferFrom(new Uint8Array(b))}},y.uint8array={string:h,array:function(b){return m(b,new Array(b.length))},arraybuffer:function(b){return b.buffer},uint8array:c,nodebuffer:function(b){return o.newBufferFrom(b)}},y.nodebuffer={string:h,array:function(b){return m(b,new Array(b.length))},arraybuffer:function(b){return y.nodebuffer.uint8array(b).buffer},uint8array:function(b){return m(b,new Uint8Array(b.length))},nodebuffer:c},s.transformTo=function(b,v){if(v=v||"",!b)return v;s.checkSupport(b);var x=s.getTypeOf(v);return y[x][b](v)},s.resolve=function(b){for(var v=b.split("/"),x=[],w=0;w<v.length;w++){var S=v[w];S==="."||S===""&&w!==0&&w!==v.length-1||(S===".."?x.pop():x.push(S))}return x.join("/")},s.getTypeOf=function(b){return typeof b=="string"?"string":Object.prototype.toString.call(b)==="[object Array]"?"array":i.nodebuffer&&o.isBuffer(b)?"nodebuffer":i.uint8array&&b instanceof Uint8Array?"uint8array":i.arraybuffer&&b instanceof ArrayBuffer?"arraybuffer":void 0},s.checkSupport=function(b){if(!i[b.toLowerCase()])throw new Error(b+" is not supported by this platform")},s.MAX_VALUE_16BITS=65535,s.MAX_VALUE_32BITS=-1,s.pretty=function(b){var v,x,w="";for(x=0;x<(b||"").length;x++)w+="\\x"+((v=b.charCodeAt(x))<16?"0":"")+v.toString(16).toUpperCase();return w},s.delay=function(b,v,x){setImmediate(function(){b.apply(x||null,v||[])})},s.inherits=function(b,v){function x(){}x.prototype=v.prototype,b.prototype=new x},s.extend=function(){var b,v,x={};for(b=0;b<arguments.length;b++)for(v in arguments[b])Object.prototype.hasOwnProperty.call(arguments[b],v)&&x[v]===void 0&&(x[v]=arguments[b][v]);return x},s.prepareContent=function(b,v,x,w,S){return l.Promise.resolve(v).then(function(k){return i.blob&&(k instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(k))!==-1)&&typeof FileReader<"u"?new l.Promise(function(C,T){var R=new FileReader;R.onload=function(N){C(N.target.result)},R.onerror=function(N){T(N.target.error)},R.readAsArrayBuffer(k)}):k}).then(function(k){var C=s.getTypeOf(k);return C?(C==="arraybuffer"?k=s.transformTo("uint8array",k):C==="string"&&(S?k=a.decode(k):x&&w!==!0&&(k=function(T){return u(T,i.uint8array?new Uint8Array(T.length):new Array(T.length))}(k))),k):l.Promise.reject(new Error("Can't read the data of '"+b+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(n,r,s){var i=n("./reader/readerFor"),a=n("./utils"),o=n("./signature"),l=n("./zipEntry"),c=n("./support");function u(d){this.files=[],this.loadOptions=d}u.prototype={checkSignature:function(d){if(!this.reader.readAndCheckSignature(d)){this.reader.index-=4;var h=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+a.pretty(h)+", expected "+a.pretty(d)+")")}},isSignature:function(d,h){var m=this.reader.index;this.reader.setIndex(d);var y=this.reader.readString(4)===h;return this.reader.setIndex(m),y},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var d=this.reader.readData(this.zipCommentLength),h=c.uint8array?"uint8array":"array",m=a.transformTo(h,d);this.zipComment=this.loadOptions.decodeFileName(m)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var d,h,m,y=this.zip64EndOfCentralSize-44;0<y;)d=this.reader.readInt(2),h=this.reader.readInt(4),m=this.reader.readData(h),this.zip64ExtensibleData[d]={id:d,length:h,value:m}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var d,h;for(d=0;d<this.files.length;d++)h=this.files[d],this.reader.setIndex(h.localHeaderOffset),this.checkSignature(o.LOCAL_FILE_HEADER),h.readLocalPart(this.reader),h.handleUTF8(),h.processAttributes()},readCentralDir:function(){var d;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(o.CENTRAL_FILE_HEADER);)(d=new l({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(d);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var d=this.reader.lastIndexOfSignature(o.CENTRAL_DIRECTORY_END);if(d<0)throw this.isSignature(0,o.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(d);var h=d;if(this.checkSignature(o.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===a.MAX_VALUE_16BITS||this.diskWithCentralDirStart===a.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===a.MAX_VALUE_16BITS||this.centralDirRecords===a.MAX_VALUE_16BITS||this.centralDirSize===a.MAX_VALUE_32BITS||this.centralDirOffset===a.MAX_VALUE_32BITS){if(this.zip64=!0,(d=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(d),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,o.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var m=this.centralDirOffset+this.centralDirSize;this.zip64&&(m+=20,m+=12+this.zip64EndOfCentralSize);var y=h-m;if(0<y)this.isSignature(h,o.CENTRAL_FILE_HEADER)||(this.reader.zero=y);else if(y<0)throw new Error("Corrupted zip: missing "+Math.abs(y)+" bytes.")},prepareReader:function(d){this.reader=i(d)},load:function(d){this.prepareReader(d),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},r.exports=u},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(n,r,s){var i=n("./reader/readerFor"),a=n("./utils"),o=n("./compressedObject"),l=n("./crc32"),c=n("./utf8"),u=n("./compressions"),d=n("./support");function h(m,y){this.options=m,this.loadOptions=y}h.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(m){var y,b;if(m.skip(22),this.fileNameLength=m.readInt(2),b=m.readInt(2),this.fileName=m.readData(this.fileNameLength),m.skip(b),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((y=function(v){for(var x in u)if(Object.prototype.hasOwnProperty.call(u,x)&&u[x].magic===v)return u[x];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+a.pretty(this.compressionMethod)+" unknown (inner file : "+a.transformTo("string",this.fileName)+")");this.decompressed=new o(this.compressedSize,this.uncompressedSize,this.crc32,y,m.readData(this.compressedSize))},readCentralPart:function(m){this.versionMadeBy=m.readInt(2),m.skip(2),this.bitFlag=m.readInt(2),this.compressionMethod=m.readString(2),this.date=m.readDate(),this.crc32=m.readInt(4),this.compressedSize=m.readInt(4),this.uncompressedSize=m.readInt(4);var y=m.readInt(2);if(this.extraFieldsLength=m.readInt(2),this.fileCommentLength=m.readInt(2),this.diskNumberStart=m.readInt(2),this.internalFileAttributes=m.readInt(2),this.externalFileAttributes=m.readInt(4),this.localHeaderOffset=m.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");m.skip(y),this.readExtraFields(m),this.parseZIP64ExtraField(m),this.fileComment=m.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var m=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),m==0&&(this.dosPermissions=63&this.externalFileAttributes),m==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var m=i(this.extraFields[1].value);this.uncompressedSize===a.MAX_VALUE_32BITS&&(this.uncompressedSize=m.readInt(8)),this.compressedSize===a.MAX_VALUE_32BITS&&(this.compressedSize=m.readInt(8)),this.localHeaderOffset===a.MAX_VALUE_32BITS&&(this.localHeaderOffset=m.readInt(8)),this.diskNumberStart===a.MAX_VALUE_32BITS&&(this.diskNumberStart=m.readInt(4))}},readExtraFields:function(m){var y,b,v,x=m.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});m.index+4<x;)y=m.readInt(2),b=m.readInt(2),v=m.readData(b),this.extraFields[y]={id:y,length:b,value:v};m.setIndex(x)},handleUTF8:function(){var m=d.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=c.utf8decode(this.fileName),this.fileCommentStr=c.utf8decode(this.fileComment);else{var y=this.findExtraFieldUnicodePath();if(y!==null)this.fileNameStr=y;else{var b=a.transformTo(m,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(b)}var v=this.findExtraFieldUnicodeComment();if(v!==null)this.fileCommentStr=v;else{var x=a.transformTo(m,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(x)}}},findExtraFieldUnicodePath:function(){var m=this.extraFields[28789];if(m){var y=i(m.value);return y.readInt(1)!==1||l(this.fileName)!==y.readInt(4)?null:c.utf8decode(y.readData(m.length-5))}return null},findExtraFieldUnicodeComment:function(){var m=this.extraFields[25461];if(m){var y=i(m.value);return y.readInt(1)!==1||l(this.fileComment)!==y.readInt(4)?null:c.utf8decode(y.readData(m.length-5))}return null}},r.exports=h},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(n,r,s){function i(y,b,v){this.name=y,this.dir=v.dir,this.date=v.date,this.comment=v.comment,this.unixPermissions=v.unixPermissions,this.dosPermissions=v.dosPermissions,this._data=b,this._dataBinary=v.binary,this.options={compression:v.compression,compressionOptions:v.compressionOptions}}var a=n("./stream/StreamHelper"),o=n("./stream/DataWorker"),l=n("./utf8"),c=n("./compressedObject"),u=n("./stream/GenericWorker");i.prototype={internalStream:function(y){var b=null,v="string";try{if(!y)throw new Error("No output type specified.");var x=(v=y.toLowerCase())==="string"||v==="text";v!=="binarystring"&&v!=="text"||(v="string"),b=this._decompressWorker();var w=!this._dataBinary;w&&!x&&(b=b.pipe(new l.Utf8EncodeWorker)),!w&&x&&(b=b.pipe(new l.Utf8DecodeWorker))}catch(S){(b=new u("error")).error(S)}return new a(b,v,"")},async:function(y,b){return this.internalStream(y).accumulate(b)},nodeStream:function(y,b){return this.internalStream(y||"nodebuffer").toNodejsStream(b)},_compressWorker:function(y,b){if(this._data instanceof c&&this._data.compression.magic===y.magic)return this._data.getCompressedWorker();var v=this._decompressWorker();return this._dataBinary||(v=v.pipe(new l.Utf8EncodeWorker)),c.createWorkerFrom(v,y,b)},_decompressWorker:function(){return this._data instanceof c?this._data.getContentWorker():this._data instanceof u?this._data:new o(this._data)}};for(var d=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],h=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},m=0;m<d.length;m++)i.prototype[d[m]]=h;r.exports=i},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(n,r,s){(function(i){var a,o,l=i.MutationObserver||i.WebKitMutationObserver;if(l){var c=0,u=new l(y),d=i.document.createTextNode("");u.observe(d,{characterData:!0}),a=function(){d.data=c=++c%2}}else if(i.setImmediate||i.MessageChannel===void 0)a="document"in i&&"onreadystatechange"in i.document.createElement("script")?function(){var b=i.document.createElement("script");b.onreadystatechange=function(){y(),b.onreadystatechange=null,b.parentNode.removeChild(b),b=null},i.document.documentElement.appendChild(b)}:function(){setTimeout(y,0)};else{var h=new i.MessageChannel;h.port1.onmessage=y,a=function(){h.port2.postMessage(0)}}var m=[];function y(){var b,v;o=!0;for(var x=m.length;x;){for(v=m,m=[],b=-1;++b<x;)v[b]();x=m.length}o=!1}r.exports=function(b){m.push(b)!==1||o||a()}}).call(this,typeof tm<"u"?tm:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(n,r,s){var i=n("immediate");function a(){}var o={},l=["REJECTED"],c=["FULFILLED"],u=["PENDING"];function d(x){if(typeof x!="function")throw new TypeError("resolver must be a function");this.state=u,this.queue=[],this.outcome=void 0,x!==a&&b(this,x)}function h(x,w,S){this.promise=x,typeof w=="function"&&(this.onFulfilled=w,this.callFulfilled=this.otherCallFulfilled),typeof S=="function"&&(this.onRejected=S,this.callRejected=this.otherCallRejected)}function m(x,w,S){i(function(){var k;try{k=w(S)}catch(C){return o.reject(x,C)}k===x?o.reject(x,new TypeError("Cannot resolve promise with itself")):o.resolve(x,k)})}function y(x){var w=x&&x.then;if(x&&(typeof x=="object"||typeof x=="function")&&typeof w=="function")return function(){w.apply(x,arguments)}}function b(x,w){var S=!1;function k(R){S||(S=!0,o.reject(x,R))}function C(R){S||(S=!0,o.resolve(x,R))}var T=v(function(){w(C,k)});T.status==="error"&&k(T.value)}function v(x,w){var S={};try{S.value=x(w),S.status="success"}catch(k){S.status="error",S.value=k}return S}(r.exports=d).prototype.finally=function(x){if(typeof x!="function")return this;var w=this.constructor;return this.then(function(S){return w.resolve(x()).then(function(){return S})},function(S){return w.resolve(x()).then(function(){throw S})})},d.prototype.catch=function(x){return this.then(null,x)},d.prototype.then=function(x,w){if(typeof x!="function"&&this.state===c||typeof w!="function"&&this.state===l)return this;var S=new this.constructor(a);return this.state!==u?m(S,this.state===c?x:w,this.outcome):this.queue.push(new h(S,x,w)),S},h.prototype.callFulfilled=function(x){o.resolve(this.promise,x)},h.prototype.otherCallFulfilled=function(x){m(this.promise,this.onFulfilled,x)},h.prototype.callRejected=function(x){o.reject(this.promise,x)},h.prototype.otherCallRejected=function(x){m(this.promise,this.onRejected,x)},o.resolve=function(x,w){var S=v(y,w);if(S.status==="error")return o.reject(x,S.value);var k=S.value;if(k)b(x,k);else{x.state=c,x.outcome=w;for(var C=-1,T=x.queue.length;++C<T;)x.queue[C].callFulfilled(w)}return x},o.reject=function(x,w){x.state=l,x.outcome=w;for(var S=-1,k=x.queue.length;++S<k;)x.queue[S].callRejected(w);return x},d.resolve=function(x){return x instanceof this?x:o.resolve(new this(a),x)},d.reject=function(x){var w=new this(a);return o.reject(w,x)},d.all=function(x){var w=this;if(Object.prototype.toString.call(x)!=="[object Array]")return this.reject(new TypeError("must be an array"));var S=x.length,k=!1;if(!S)return this.resolve([]);for(var C=new Array(S),T=0,R=-1,N=new this(a);++R<S;)I(x[R],R);return N;function I(P,B){w.resolve(P).then(function(D){C[B]=D,++T!==S||k||(k=!0,o.resolve(N,C))},function(D){k||(k=!0,o.reject(N,D))})}},d.race=function(x){var w=this;if(Object.prototype.toString.call(x)!=="[object Array]")return this.reject(new TypeError("must be an array"));var S=x.length,k=!1;if(!S)return this.resolve([]);for(var C=-1,T=new this(a);++C<S;)R=x[C],w.resolve(R).then(function(N){k||(k=!0,o.resolve(T,N))},function(N){k||(k=!0,o.reject(T,N))});var R;return T}},{immediate:36}],38:[function(n,r,s){var i={};(0,n("./lib/utils/common").assign)(i,n("./lib/deflate"),n("./lib/inflate"),n("./lib/zlib/constants")),r.exports=i},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(n,r,s){var i=n("./zlib/deflate"),a=n("./utils/common"),o=n("./utils/strings"),l=n("./zlib/messages"),c=n("./zlib/zstream"),u=Object.prototype.toString,d=0,h=-1,m=0,y=8;function b(x){if(!(this instanceof b))return new b(x);this.options=a.assign({level:h,method:y,chunkSize:16384,windowBits:15,memLevel:8,strategy:m,to:""},x||{});var w=this.options;w.raw&&0<w.windowBits?w.windowBits=-w.windowBits:w.gzip&&0<w.windowBits&&w.windowBits<16&&(w.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new c,this.strm.avail_out=0;var S=i.deflateInit2(this.strm,w.level,w.method,w.windowBits,w.memLevel,w.strategy);if(S!==d)throw new Error(l[S]);if(w.header&&i.deflateSetHeader(this.strm,w.header),w.dictionary){var k;if(k=typeof w.dictionary=="string"?o.string2buf(w.dictionary):u.call(w.dictionary)==="[object ArrayBuffer]"?new Uint8Array(w.dictionary):w.dictionary,(S=i.deflateSetDictionary(this.strm,k))!==d)throw new Error(l[S]);this._dict_set=!0}}function v(x,w){var S=new b(w);if(S.push(x,!0),S.err)throw S.msg||l[S.err];return S.result}b.prototype.push=function(x,w){var S,k,C=this.strm,T=this.options.chunkSize;if(this.ended)return!1;k=w===~~w?w:w===!0?4:0,typeof x=="string"?C.input=o.string2buf(x):u.call(x)==="[object ArrayBuffer]"?C.input=new Uint8Array(x):C.input=x,C.next_in=0,C.avail_in=C.input.length;do{if(C.avail_out===0&&(C.output=new a.Buf8(T),C.next_out=0,C.avail_out=T),(S=i.deflate(C,k))!==1&&S!==d)return this.onEnd(S),!(this.ended=!0);C.avail_out!==0&&(C.avail_in!==0||k!==4&&k!==2)||(this.options.to==="string"?this.onData(o.buf2binstring(a.shrinkBuf(C.output,C.next_out))):this.onData(a.shrinkBuf(C.output,C.next_out)))}while((0<C.avail_in||C.avail_out===0)&&S!==1);return k===4?(S=i.deflateEnd(this.strm),this.onEnd(S),this.ended=!0,S===d):k!==2||(this.onEnd(d),!(C.avail_out=0))},b.prototype.onData=function(x){this.chunks.push(x)},b.prototype.onEnd=function(x){x===d&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=x,this.msg=this.strm.msg},s.Deflate=b,s.deflate=v,s.deflateRaw=function(x,w){return(w=w||{}).raw=!0,v(x,w)},s.gzip=function(x,w){return(w=w||{}).gzip=!0,v(x,w)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(n,r,s){var i=n("./zlib/inflate"),a=n("./utils/common"),o=n("./utils/strings"),l=n("./zlib/constants"),c=n("./zlib/messages"),u=n("./zlib/zstream"),d=n("./zlib/gzheader"),h=Object.prototype.toString;function m(b){if(!(this instanceof m))return new m(b);this.options=a.assign({chunkSize:16384,windowBits:0,to:""},b||{});var v=this.options;v.raw&&0<=v.windowBits&&v.windowBits<16&&(v.windowBits=-v.windowBits,v.windowBits===0&&(v.windowBits=-15)),!(0<=v.windowBits&&v.windowBits<16)||b&&b.windowBits||(v.windowBits+=32),15<v.windowBits&&v.windowBits<48&&(15&v.windowBits)==0&&(v.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new u,this.strm.avail_out=0;var x=i.inflateInit2(this.strm,v.windowBits);if(x!==l.Z_OK)throw new Error(c[x]);this.header=new d,i.inflateGetHeader(this.strm,this.header)}function y(b,v){var x=new m(v);if(x.push(b,!0),x.err)throw x.msg||c[x.err];return x.result}m.prototype.push=function(b,v){var x,w,S,k,C,T,R=this.strm,N=this.options.chunkSize,I=this.options.dictionary,P=!1;if(this.ended)return!1;w=v===~~v?v:v===!0?l.Z_FINISH:l.Z_NO_FLUSH,typeof b=="string"?R.input=o.binstring2buf(b):h.call(b)==="[object ArrayBuffer]"?R.input=new Uint8Array(b):R.input=b,R.next_in=0,R.avail_in=R.input.length;do{if(R.avail_out===0&&(R.output=new a.Buf8(N),R.next_out=0,R.avail_out=N),(x=i.inflate(R,l.Z_NO_FLUSH))===l.Z_NEED_DICT&&I&&(T=typeof I=="string"?o.string2buf(I):h.call(I)==="[object ArrayBuffer]"?new Uint8Array(I):I,x=i.inflateSetDictionary(this.strm,T)),x===l.Z_BUF_ERROR&&P===!0&&(x=l.Z_OK,P=!1),x!==l.Z_STREAM_END&&x!==l.Z_OK)return this.onEnd(x),!(this.ended=!0);R.next_out&&(R.avail_out!==0&&x!==l.Z_STREAM_END&&(R.avail_in!==0||w!==l.Z_FINISH&&w!==l.Z_SYNC_FLUSH)||(this.options.to==="string"?(S=o.utf8border(R.output,R.next_out),k=R.next_out-S,C=o.buf2string(R.output,S),R.next_out=k,R.avail_out=N-k,k&&a.arraySet(R.output,R.output,S,k,0),this.onData(C)):this.onData(a.shrinkBuf(R.output,R.next_out)))),R.avail_in===0&&R.avail_out===0&&(P=!0)}while((0<R.avail_in||R.avail_out===0)&&x!==l.Z_STREAM_END);return x===l.Z_STREAM_END&&(w=l.Z_FINISH),w===l.Z_FINISH?(x=i.inflateEnd(this.strm),this.onEnd(x),this.ended=!0,x===l.Z_OK):w!==l.Z_SYNC_FLUSH||(this.onEnd(l.Z_OK),!(R.avail_out=0))},m.prototype.onData=function(b){this.chunks.push(b)},m.prototype.onEnd=function(b){b===l.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=b,this.msg=this.strm.msg},s.Inflate=m,s.inflate=y,s.inflateRaw=function(b,v){return(v=v||{}).raw=!0,y(b,v)},s.ungzip=y},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(n,r,s){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";s.assign=function(l){for(var c=Array.prototype.slice.call(arguments,1);c.length;){var u=c.shift();if(u){if(typeof u!="object")throw new TypeError(u+"must be non-object");for(var d in u)u.hasOwnProperty(d)&&(l[d]=u[d])}}return l},s.shrinkBuf=function(l,c){return l.length===c?l:l.subarray?l.subarray(0,c):(l.length=c,l)};var a={arraySet:function(l,c,u,d,h){if(c.subarray&&l.subarray)l.set(c.subarray(u,u+d),h);else for(var m=0;m<d;m++)l[h+m]=c[u+m]},flattenChunks:function(l){var c,u,d,h,m,y;for(c=d=0,u=l.length;c<u;c++)d+=l[c].length;for(y=new Uint8Array(d),c=h=0,u=l.length;c<u;c++)m=l[c],y.set(m,h),h+=m.length;return y}},o={arraySet:function(l,c,u,d,h){for(var m=0;m<d;m++)l[h+m]=c[u+m]},flattenChunks:function(l){return[].concat.apply([],l)}};s.setTyped=function(l){l?(s.Buf8=Uint8Array,s.Buf16=Uint16Array,s.Buf32=Int32Array,s.assign(s,a)):(s.Buf8=Array,s.Buf16=Array,s.Buf32=Array,s.assign(s,o))},s.setTyped(i)},{}],42:[function(n,r,s){var i=n("./common"),a=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch{a=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{o=!1}for(var l=new i.Buf8(256),c=0;c<256;c++)l[c]=252<=c?6:248<=c?5:240<=c?4:224<=c?3:192<=c?2:1;function u(d,h){if(h<65537&&(d.subarray&&o||!d.subarray&&a))return String.fromCharCode.apply(null,i.shrinkBuf(d,h));for(var m="",y=0;y<h;y++)m+=String.fromCharCode(d[y]);return m}l[254]=l[254]=1,s.string2buf=function(d){var h,m,y,b,v,x=d.length,w=0;for(b=0;b<x;b++)(64512&(m=d.charCodeAt(b)))==55296&&b+1<x&&(64512&(y=d.charCodeAt(b+1)))==56320&&(m=65536+(m-55296<<10)+(y-56320),b++),w+=m<128?1:m<2048?2:m<65536?3:4;for(h=new i.Buf8(w),b=v=0;v<w;b++)(64512&(m=d.charCodeAt(b)))==55296&&b+1<x&&(64512&(y=d.charCodeAt(b+1)))==56320&&(m=65536+(m-55296<<10)+(y-56320),b++),m<128?h[v++]=m:(m<2048?h[v++]=192|m>>>6:(m<65536?h[v++]=224|m>>>12:(h[v++]=240|m>>>18,h[v++]=128|m>>>12&63),h[v++]=128|m>>>6&63),h[v++]=128|63&m);return h},s.buf2binstring=function(d){return u(d,d.length)},s.binstring2buf=function(d){for(var h=new i.Buf8(d.length),m=0,y=h.length;m<y;m++)h[m]=d.charCodeAt(m);return h},s.buf2string=function(d,h){var m,y,b,v,x=h||d.length,w=new Array(2*x);for(m=y=0;m<x;)if((b=d[m++])<128)w[y++]=b;else if(4<(v=l[b]))w[y++]=65533,m+=v-1;else{for(b&=v===2?31:v===3?15:7;1<v&&m<x;)b=b<<6|63&d[m++],v--;1<v?w[y++]=65533:b<65536?w[y++]=b:(b-=65536,w[y++]=55296|b>>10&1023,w[y++]=56320|1023&b)}return u(w,y)},s.utf8border=function(d,h){var m;for((h=h||d.length)>d.length&&(h=d.length),m=h-1;0<=m&&(192&d[m])==128;)m--;return m<0||m===0?h:m+l[d[m]]>h?m:h}},{"./common":41}],43:[function(n,r,s){r.exports=function(i,a,o,l){for(var c=65535&i|0,u=i>>>16&65535|0,d=0;o!==0;){for(o-=d=2e3<o?2e3:o;u=u+(c=c+a[l++]|0)|0,--d;);c%=65521,u%=65521}return c|u<<16|0}},{}],44:[function(n,r,s){r.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(n,r,s){var i=function(){for(var a,o=[],l=0;l<256;l++){a=l;for(var c=0;c<8;c++)a=1&a?3988292384^a>>>1:a>>>1;o[l]=a}return o}();r.exports=function(a,o,l,c){var u=i,d=c+l;a^=-1;for(var h=c;h<d;h++)a=a>>>8^u[255&(a^o[h])];return-1^a}},{}],46:[function(n,r,s){var i,a=n("../utils/common"),o=n("./trees"),l=n("./adler32"),c=n("./crc32"),u=n("./messages"),d=0,h=4,m=0,y=-2,b=-1,v=4,x=2,w=8,S=9,k=286,C=30,T=19,R=2*k+1,N=15,I=3,P=258,B=P+I+1,D=42,W=113,O=1,Z=2,U=3,H=4;function L(K,ye){return K.msg=u[ye],ye}function te(K){return(K<<1)-(4<K?9:0)}function V(K){for(var ye=K.length;0<=--ye;)K[ye]=0}function Q(K){var ye=K.state,Ne=ye.pending;Ne>K.avail_out&&(Ne=K.avail_out),Ne!==0&&(a.arraySet(K.output,ye.pending_buf,ye.pending_out,Ne,K.next_out),K.next_out+=Ne,ye.pending_out+=Ne,K.total_out+=Ne,K.avail_out-=Ne,ye.pending-=Ne,ye.pending===0&&(ye.pending_out=0))}function ee(K,ye){o._tr_flush_block(K,0<=K.block_start?K.block_start:-1,K.strstart-K.block_start,ye),K.block_start=K.strstart,Q(K.strm)}function se(K,ye){K.pending_buf[K.pending++]=ye}function pe(K,ye){K.pending_buf[K.pending++]=ye>>>8&255,K.pending_buf[K.pending++]=255&ye}function ue(K,ye){var Ne,ce,oe=K.max_chain_length,re=K.strstart,Re=K.prev_length,Be=K.nice_match,Te=K.strstart>K.w_size-B?K.strstart-(K.w_size-B):0,lt=K.window,Tt=K.w_mask,ut=K.prev,jt=K.strstart+P,qt=lt[re+Re-1],Ft=lt[re+Re];K.prev_length>=K.good_match&&(oe>>=2),Be>K.lookahead&&(Be=K.lookahead);do if(lt[(Ne=ye)+Re]===Ft&&lt[Ne+Re-1]===qt&&lt[Ne]===lt[re]&&lt[++Ne]===lt[re+1]){re+=2,Ne++;do;while(lt[++re]===lt[++Ne]&&lt[++re]===lt[++Ne]&&lt[++re]===lt[++Ne]&&lt[++re]===lt[++Ne]&&lt[++re]===lt[++Ne]&&lt[++re]===lt[++Ne]&&lt[++re]===lt[++Ne]&&lt[++re]===lt[++Ne]&&re<jt);if(ce=P-(jt-re),re=jt-P,Re<ce){if(K.match_start=ye,Be<=(Re=ce))break;qt=lt[re+Re-1],Ft=lt[re+Re]}}while((ye=ut[ye&Tt])>Te&&--oe!=0);return Re<=K.lookahead?Re:K.lookahead}function Oe(K){var ye,Ne,ce,oe,re,Re,Be,Te,lt,Tt,ut=K.w_size;do{if(oe=K.window_size-K.lookahead-K.strstart,K.strstart>=ut+(ut-B)){for(a.arraySet(K.window,K.window,ut,ut,0),K.match_start-=ut,K.strstart-=ut,K.block_start-=ut,ye=Ne=K.hash_size;ce=K.head[--ye],K.head[ye]=ut<=ce?ce-ut:0,--Ne;);for(ye=Ne=ut;ce=K.prev[--ye],K.prev[ye]=ut<=ce?ce-ut:0,--Ne;);oe+=ut}if(K.strm.avail_in===0)break;if(Re=K.strm,Be=K.window,Te=K.strstart+K.lookahead,lt=oe,Tt=void 0,Tt=Re.avail_in,lt<Tt&&(Tt=lt),Ne=Tt===0?0:(Re.avail_in-=Tt,a.arraySet(Be,Re.input,Re.next_in,Tt,Te),Re.state.wrap===1?Re.adler=l(Re.adler,Be,Tt,Te):Re.state.wrap===2&&(Re.adler=c(Re.adler,Be,Tt,Te)),Re.next_in+=Tt,Re.total_in+=Tt,Tt),K.lookahead+=Ne,K.lookahead+K.insert>=I)for(re=K.strstart-K.insert,K.ins_h=K.window[re],K.ins_h=(K.ins_h<<K.hash_shift^K.window[re+1])&K.hash_mask;K.insert&&(K.ins_h=(K.ins_h<<K.hash_shift^K.window[re+I-1])&K.hash_mask,K.prev[re&K.w_mask]=K.head[K.ins_h],K.head[K.ins_h]=re,re++,K.insert--,!(K.lookahead+K.insert<I)););}while(K.lookahead<B&&K.strm.avail_in!==0)}function Fe(K,ye){for(var Ne,ce;;){if(K.lookahead<B){if(Oe(K),K.lookahead<B&&ye===d)return O;if(K.lookahead===0)break}if(Ne=0,K.lookahead>=I&&(K.ins_h=(K.ins_h<<K.hash_shift^K.window[K.strstart+I-1])&K.hash_mask,Ne=K.prev[K.strstart&K.w_mask]=K.head[K.ins_h],K.head[K.ins_h]=K.strstart),Ne!==0&&K.strstart-Ne<=K.w_size-B&&(K.match_length=ue(K,Ne)),K.match_length>=I)if(ce=o._tr_tally(K,K.strstart-K.match_start,K.match_length-I),K.lookahead-=K.match_length,K.match_length<=K.max_lazy_match&&K.lookahead>=I){for(K.match_length--;K.strstart++,K.ins_h=(K.ins_h<<K.hash_shift^K.window[K.strstart+I-1])&K.hash_mask,Ne=K.prev[K.strstart&K.w_mask]=K.head[K.ins_h],K.head[K.ins_h]=K.strstart,--K.match_length!=0;);K.strstart++}else K.strstart+=K.match_length,K.match_length=0,K.ins_h=K.window[K.strstart],K.ins_h=(K.ins_h<<K.hash_shift^K.window[K.strstart+1])&K.hash_mask;else ce=o._tr_tally(K,0,K.window[K.strstart]),K.lookahead--,K.strstart++;if(ce&&(ee(K,!1),K.strm.avail_out===0))return O}return K.insert=K.strstart<I-1?K.strstart:I-1,ye===h?(ee(K,!0),K.strm.avail_out===0?U:H):K.last_lit&&(ee(K,!1),K.strm.avail_out===0)?O:Z}function Se(K,ye){for(var Ne,ce,oe;;){if(K.lookahead<B){if(Oe(K),K.lookahead<B&&ye===d)return O;if(K.lookahead===0)break}if(Ne=0,K.lookahead>=I&&(K.ins_h=(K.ins_h<<K.hash_shift^K.window[K.strstart+I-1])&K.hash_mask,Ne=K.prev[K.strstart&K.w_mask]=K.head[K.ins_h],K.head[K.ins_h]=K.strstart),K.prev_length=K.match_length,K.prev_match=K.match_start,K.match_length=I-1,Ne!==0&&K.prev_length<K.max_lazy_match&&K.strstart-Ne<=K.w_size-B&&(K.match_length=ue(K,Ne),K.match_length<=5&&(K.strategy===1||K.match_length===I&&4096<K.strstart-K.match_start)&&(K.match_length=I-1)),K.prev_length>=I&&K.match_length<=K.prev_length){for(oe=K.strstart+K.lookahead-I,ce=o._tr_tally(K,K.strstart-1-K.prev_match,K.prev_length-I),K.lookahead-=K.prev_length-1,K.prev_length-=2;++K.strstart<=oe&&(K.ins_h=(K.ins_h<<K.hash_shift^K.window[K.strstart+I-1])&K.hash_mask,Ne=K.prev[K.strstart&K.w_mask]=K.head[K.ins_h],K.head[K.ins_h]=K.strstart),--K.prev_length!=0;);if(K.match_available=0,K.match_length=I-1,K.strstart++,ce&&(ee(K,!1),K.strm.avail_out===0))return O}else if(K.match_available){if((ce=o._tr_tally(K,0,K.window[K.strstart-1]))&&ee(K,!1),K.strstart++,K.lookahead--,K.strm.avail_out===0)return O}else K.match_available=1,K.strstart++,K.lookahead--}return K.match_available&&(ce=o._tr_tally(K,0,K.window[K.strstart-1]),K.match_available=0),K.insert=K.strstart<I-1?K.strstart:I-1,ye===h?(ee(K,!0),K.strm.avail_out===0?U:H):K.last_lit&&(ee(K,!1),K.strm.avail_out===0)?O:Z}function Ce(K,ye,Ne,ce,oe){this.good_length=K,this.max_lazy=ye,this.nice_length=Ne,this.max_chain=ce,this.func=oe}function qe(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=w,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new a.Buf16(2*R),this.dyn_dtree=new a.Buf16(2*(2*C+1)),this.bl_tree=new a.Buf16(2*(2*T+1)),V(this.dyn_ltree),V(this.dyn_dtree),V(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new a.Buf16(N+1),this.heap=new a.Buf16(2*k+1),V(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new a.Buf16(2*k+1),V(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Qe(K){var ye;return K&&K.state?(K.total_in=K.total_out=0,K.data_type=x,(ye=K.state).pending=0,ye.pending_out=0,ye.wrap<0&&(ye.wrap=-ye.wrap),ye.status=ye.wrap?D:W,K.adler=ye.wrap===2?0:1,ye.last_flush=d,o._tr_init(ye),m):L(K,y)}function We(K){var ye=Qe(K);return ye===m&&function(Ne){Ne.window_size=2*Ne.w_size,V(Ne.head),Ne.max_lazy_match=i[Ne.level].max_lazy,Ne.good_match=i[Ne.level].good_length,Ne.nice_match=i[Ne.level].nice_length,Ne.max_chain_length=i[Ne.level].max_chain,Ne.strstart=0,Ne.block_start=0,Ne.lookahead=0,Ne.insert=0,Ne.match_length=Ne.prev_length=I-1,Ne.match_available=0,Ne.ins_h=0}(K.state),ye}function Ie(K,ye,Ne,ce,oe,re){if(!K)return y;var Re=1;if(ye===b&&(ye=6),ce<0?(Re=0,ce=-ce):15<ce&&(Re=2,ce-=16),oe<1||S<oe||Ne!==w||ce<8||15<ce||ye<0||9<ye||re<0||v<re)return L(K,y);ce===8&&(ce=9);var Be=new qe;return(K.state=Be).strm=K,Be.wrap=Re,Be.gzhead=null,Be.w_bits=ce,Be.w_size=1<<Be.w_bits,Be.w_mask=Be.w_size-1,Be.hash_bits=oe+7,Be.hash_size=1<<Be.hash_bits,Be.hash_mask=Be.hash_size-1,Be.hash_shift=~~((Be.hash_bits+I-1)/I),Be.window=new a.Buf8(2*Be.w_size),Be.head=new a.Buf16(Be.hash_size),Be.prev=new a.Buf16(Be.w_size),Be.lit_bufsize=1<<oe+6,Be.pending_buf_size=4*Be.lit_bufsize,Be.pending_buf=new a.Buf8(Be.pending_buf_size),Be.d_buf=1*Be.lit_bufsize,Be.l_buf=3*Be.lit_bufsize,Be.level=ye,Be.strategy=re,Be.method=Ne,We(K)}i=[new Ce(0,0,0,0,function(K,ye){var Ne=65535;for(Ne>K.pending_buf_size-5&&(Ne=K.pending_buf_size-5);;){if(K.lookahead<=1){if(Oe(K),K.lookahead===0&&ye===d)return O;if(K.lookahead===0)break}K.strstart+=K.lookahead,K.lookahead=0;var ce=K.block_start+Ne;if((K.strstart===0||K.strstart>=ce)&&(K.lookahead=K.strstart-ce,K.strstart=ce,ee(K,!1),K.strm.avail_out===0)||K.strstart-K.block_start>=K.w_size-B&&(ee(K,!1),K.strm.avail_out===0))return O}return K.insert=0,ye===h?(ee(K,!0),K.strm.avail_out===0?U:H):(K.strstart>K.block_start&&(ee(K,!1),K.strm.avail_out),O)}),new Ce(4,4,8,4,Fe),new Ce(4,5,16,8,Fe),new Ce(4,6,32,32,Fe),new Ce(4,4,16,16,Se),new Ce(8,16,32,32,Se),new Ce(8,16,128,128,Se),new Ce(8,32,128,256,Se),new Ce(32,128,258,1024,Se),new Ce(32,258,258,4096,Se)],s.deflateInit=function(K,ye){return Ie(K,ye,w,15,8,0)},s.deflateInit2=Ie,s.deflateReset=We,s.deflateResetKeep=Qe,s.deflateSetHeader=function(K,ye){return K&&K.state?K.state.wrap!==2?y:(K.state.gzhead=ye,m):y},s.deflate=function(K,ye){var Ne,ce,oe,re;if(!K||!K.state||5<ye||ye<0)return K?L(K,y):y;if(ce=K.state,!K.output||!K.input&&K.avail_in!==0||ce.status===666&&ye!==h)return L(K,K.avail_out===0?-5:y);if(ce.strm=K,Ne=ce.last_flush,ce.last_flush=ye,ce.status===D)if(ce.wrap===2)K.adler=0,se(ce,31),se(ce,139),se(ce,8),ce.gzhead?(se(ce,(ce.gzhead.text?1:0)+(ce.gzhead.hcrc?2:0)+(ce.gzhead.extra?4:0)+(ce.gzhead.name?8:0)+(ce.gzhead.comment?16:0)),se(ce,255&ce.gzhead.time),se(ce,ce.gzhead.time>>8&255),se(ce,ce.gzhead.time>>16&255),se(ce,ce.gzhead.time>>24&255),se(ce,ce.level===9?2:2<=ce.strategy||ce.level<2?4:0),se(ce,255&ce.gzhead.os),ce.gzhead.extra&&ce.gzhead.extra.length&&(se(ce,255&ce.gzhead.extra.length),se(ce,ce.gzhead.extra.length>>8&255)),ce.gzhead.hcrc&&(K.adler=c(K.adler,ce.pending_buf,ce.pending,0)),ce.gzindex=0,ce.status=69):(se(ce,0),se(ce,0),se(ce,0),se(ce,0),se(ce,0),se(ce,ce.level===9?2:2<=ce.strategy||ce.level<2?4:0),se(ce,3),ce.status=W);else{var Re=w+(ce.w_bits-8<<4)<<8;Re|=(2<=ce.strategy||ce.level<2?0:ce.level<6?1:ce.level===6?2:3)<<6,ce.strstart!==0&&(Re|=32),Re+=31-Re%31,ce.status=W,pe(ce,Re),ce.strstart!==0&&(pe(ce,K.adler>>>16),pe(ce,65535&K.adler)),K.adler=1}if(ce.status===69)if(ce.gzhead.extra){for(oe=ce.pending;ce.gzindex<(65535&ce.gzhead.extra.length)&&(ce.pending!==ce.pending_buf_size||(ce.gzhead.hcrc&&ce.pending>oe&&(K.adler=c(K.adler,ce.pending_buf,ce.pending-oe,oe)),Q(K),oe=ce.pending,ce.pending!==ce.pending_buf_size));)se(ce,255&ce.gzhead.extra[ce.gzindex]),ce.gzindex++;ce.gzhead.hcrc&&ce.pending>oe&&(K.adler=c(K.adler,ce.pending_buf,ce.pending-oe,oe)),ce.gzindex===ce.gzhead.extra.length&&(ce.gzindex=0,ce.status=73)}else ce.status=73;if(ce.status===73)if(ce.gzhead.name){oe=ce.pending;do{if(ce.pending===ce.pending_buf_size&&(ce.gzhead.hcrc&&ce.pending>oe&&(K.adler=c(K.adler,ce.pending_buf,ce.pending-oe,oe)),Q(K),oe=ce.pending,ce.pending===ce.pending_buf_size)){re=1;break}re=ce.gzindex<ce.gzhead.name.length?255&ce.gzhead.name.charCodeAt(ce.gzindex++):0,se(ce,re)}while(re!==0);ce.gzhead.hcrc&&ce.pending>oe&&(K.adler=c(K.adler,ce.pending_buf,ce.pending-oe,oe)),re===0&&(ce.gzindex=0,ce.status=91)}else ce.status=91;if(ce.status===91)if(ce.gzhead.comment){oe=ce.pending;do{if(ce.pending===ce.pending_buf_size&&(ce.gzhead.hcrc&&ce.pending>oe&&(K.adler=c(K.adler,ce.pending_buf,ce.pending-oe,oe)),Q(K),oe=ce.pending,ce.pending===ce.pending_buf_size)){re=1;break}re=ce.gzindex<ce.gzhead.comment.length?255&ce.gzhead.comment.charCodeAt(ce.gzindex++):0,se(ce,re)}while(re!==0);ce.gzhead.hcrc&&ce.pending>oe&&(K.adler=c(K.adler,ce.pending_buf,ce.pending-oe,oe)),re===0&&(ce.status=103)}else ce.status=103;if(ce.status===103&&(ce.gzhead.hcrc?(ce.pending+2>ce.pending_buf_size&&Q(K),ce.pending+2<=ce.pending_buf_size&&(se(ce,255&K.adler),se(ce,K.adler>>8&255),K.adler=0,ce.status=W)):ce.status=W),ce.pending!==0){if(Q(K),K.avail_out===0)return ce.last_flush=-1,m}else if(K.avail_in===0&&te(ye)<=te(Ne)&&ye!==h)return L(K,-5);if(ce.status===666&&K.avail_in!==0)return L(K,-5);if(K.avail_in!==0||ce.lookahead!==0||ye!==d&&ce.status!==666){var Be=ce.strategy===2?function(Te,lt){for(var Tt;;){if(Te.lookahead===0&&(Oe(Te),Te.lookahead===0)){if(lt===d)return O;break}if(Te.match_length=0,Tt=o._tr_tally(Te,0,Te.window[Te.strstart]),Te.lookahead--,Te.strstart++,Tt&&(ee(Te,!1),Te.strm.avail_out===0))return O}return Te.insert=0,lt===h?(ee(Te,!0),Te.strm.avail_out===0?U:H):Te.last_lit&&(ee(Te,!1),Te.strm.avail_out===0)?O:Z}(ce,ye):ce.strategy===3?function(Te,lt){for(var Tt,ut,jt,qt,Ft=Te.window;;){if(Te.lookahead<=P){if(Oe(Te),Te.lookahead<=P&&lt===d)return O;if(Te.lookahead===0)break}if(Te.match_length=0,Te.lookahead>=I&&0<Te.strstart&&(ut=Ft[jt=Te.strstart-1])===Ft[++jt]&&ut===Ft[++jt]&&ut===Ft[++jt]){qt=Te.strstart+P;do;while(ut===Ft[++jt]&&ut===Ft[++jt]&&ut===Ft[++jt]&&ut===Ft[++jt]&&ut===Ft[++jt]&&ut===Ft[++jt]&&ut===Ft[++jt]&&ut===Ft[++jt]&&jt<qt);Te.match_length=P-(qt-jt),Te.match_length>Te.lookahead&&(Te.match_length=Te.lookahead)}if(Te.match_length>=I?(Tt=o._tr_tally(Te,1,Te.match_length-I),Te.lookahead-=Te.match_length,Te.strstart+=Te.match_length,Te.match_length=0):(Tt=o._tr_tally(Te,0,Te.window[Te.strstart]),Te.lookahead--,Te.strstart++),Tt&&(ee(Te,!1),Te.strm.avail_out===0))return O}return Te.insert=0,lt===h?(ee(Te,!0),Te.strm.avail_out===0?U:H):Te.last_lit&&(ee(Te,!1),Te.strm.avail_out===0)?O:Z}(ce,ye):i[ce.level].func(ce,ye);if(Be!==U&&Be!==H||(ce.status=666),Be===O||Be===U)return K.avail_out===0&&(ce.last_flush=-1),m;if(Be===Z&&(ye===1?o._tr_align(ce):ye!==5&&(o._tr_stored_block(ce,0,0,!1),ye===3&&(V(ce.head),ce.lookahead===0&&(ce.strstart=0,ce.block_start=0,ce.insert=0))),Q(K),K.avail_out===0))return ce.last_flush=-1,m}return ye!==h?m:ce.wrap<=0?1:(ce.wrap===2?(se(ce,255&K.adler),se(ce,K.adler>>8&255),se(ce,K.adler>>16&255),se(ce,K.adler>>24&255),se(ce,255&K.total_in),se(ce,K.total_in>>8&255),se(ce,K.total_in>>16&255),se(ce,K.total_in>>24&255)):(pe(ce,K.adler>>>16),pe(ce,65535&K.adler)),Q(K),0<ce.wrap&&(ce.wrap=-ce.wrap),ce.pending!==0?m:1)},s.deflateEnd=function(K){var ye;return K&&K.state?(ye=K.state.status)!==D&&ye!==69&&ye!==73&&ye!==91&&ye!==103&&ye!==W&&ye!==666?L(K,y):(K.state=null,ye===W?L(K,-3):m):y},s.deflateSetDictionary=function(K,ye){var Ne,ce,oe,re,Re,Be,Te,lt,Tt=ye.length;if(!K||!K.state||(re=(Ne=K.state).wrap)===2||re===1&&Ne.status!==D||Ne.lookahead)return y;for(re===1&&(K.adler=l(K.adler,ye,Tt,0)),Ne.wrap=0,Tt>=Ne.w_size&&(re===0&&(V(Ne.head),Ne.strstart=0,Ne.block_start=0,Ne.insert=0),lt=new a.Buf8(Ne.w_size),a.arraySet(lt,ye,Tt-Ne.w_size,Ne.w_size,0),ye=lt,Tt=Ne.w_size),Re=K.avail_in,Be=K.next_in,Te=K.input,K.avail_in=Tt,K.next_in=0,K.input=ye,Oe(Ne);Ne.lookahead>=I;){for(ce=Ne.strstart,oe=Ne.lookahead-(I-1);Ne.ins_h=(Ne.ins_h<<Ne.hash_shift^Ne.window[ce+I-1])&Ne.hash_mask,Ne.prev[ce&Ne.w_mask]=Ne.head[Ne.ins_h],Ne.head[Ne.ins_h]=ce,ce++,--oe;);Ne.strstart=ce,Ne.lookahead=I-1,Oe(Ne)}return Ne.strstart+=Ne.lookahead,Ne.block_start=Ne.strstart,Ne.insert=Ne.lookahead,Ne.lookahead=0,Ne.match_length=Ne.prev_length=I-1,Ne.match_available=0,K.next_in=Be,K.input=Te,K.avail_in=Re,Ne.wrap=re,m},s.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(n,r,s){r.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(n,r,s){r.exports=function(i,a){var o,l,c,u,d,h,m,y,b,v,x,w,S,k,C,T,R,N,I,P,B,D,W,O,Z;o=i.state,l=i.next_in,O=i.input,c=l+(i.avail_in-5),u=i.next_out,Z=i.output,d=u-(a-i.avail_out),h=u+(i.avail_out-257),m=o.dmax,y=o.wsize,b=o.whave,v=o.wnext,x=o.window,w=o.hold,S=o.bits,k=o.lencode,C=o.distcode,T=(1<<o.lenbits)-1,R=(1<<o.distbits)-1;e:do{S<15&&(w+=O[l++]<<S,S+=8,w+=O[l++]<<S,S+=8),N=k[w&T];t:for(;;){if(w>>>=I=N>>>24,S-=I,(I=N>>>16&255)===0)Z[u++]=65535&N;else{if(!(16&I)){if((64&I)==0){N=k[(65535&N)+(w&(1<<I)-1)];continue t}if(32&I){o.mode=12;break e}i.msg="invalid literal/length code",o.mode=30;break e}P=65535&N,(I&=15)&&(S<I&&(w+=O[l++]<<S,S+=8),P+=w&(1<<I)-1,w>>>=I,S-=I),S<15&&(w+=O[l++]<<S,S+=8,w+=O[l++]<<S,S+=8),N=C[w&R];n:for(;;){if(w>>>=I=N>>>24,S-=I,!(16&(I=N>>>16&255))){if((64&I)==0){N=C[(65535&N)+(w&(1<<I)-1)];continue n}i.msg="invalid distance code",o.mode=30;break e}if(B=65535&N,S<(I&=15)&&(w+=O[l++]<<S,(S+=8)<I&&(w+=O[l++]<<S,S+=8)),m<(B+=w&(1<<I)-1)){i.msg="invalid distance too far back",o.mode=30;break e}if(w>>>=I,S-=I,(I=u-d)<B){if(b<(I=B-I)&&o.sane){i.msg="invalid distance too far back",o.mode=30;break e}if(W=x,(D=0)===v){if(D+=y-I,I<P){for(P-=I;Z[u++]=x[D++],--I;);D=u-B,W=Z}}else if(v<I){if(D+=y+v-I,(I-=v)<P){for(P-=I;Z[u++]=x[D++],--I;);if(D=0,v<P){for(P-=I=v;Z[u++]=x[D++],--I;);D=u-B,W=Z}}}else if(D+=v-I,I<P){for(P-=I;Z[u++]=x[D++],--I;);D=u-B,W=Z}for(;2<P;)Z[u++]=W[D++],Z[u++]=W[D++],Z[u++]=W[D++],P-=3;P&&(Z[u++]=W[D++],1<P&&(Z[u++]=W[D++]))}else{for(D=u-B;Z[u++]=Z[D++],Z[u++]=Z[D++],Z[u++]=Z[D++],2<(P-=3););P&&(Z[u++]=Z[D++],1<P&&(Z[u++]=Z[D++]))}break}}break}}while(l<c&&u<h);l-=P=S>>3,w&=(1<<(S-=P<<3))-1,i.next_in=l,i.next_out=u,i.avail_in=l<c?c-l+5:5-(l-c),i.avail_out=u<h?h-u+257:257-(u-h),o.hold=w,o.bits=S}},{}],49:[function(n,r,s){var i=n("../utils/common"),a=n("./adler32"),o=n("./crc32"),l=n("./inffast"),c=n("./inftrees"),u=1,d=2,h=0,m=-2,y=1,b=852,v=592;function x(D){return(D>>>24&255)+(D>>>8&65280)+((65280&D)<<8)+((255&D)<<24)}function w(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new i.Buf16(320),this.work=new i.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function S(D){var W;return D&&D.state?(W=D.state,D.total_in=D.total_out=W.total=0,D.msg="",W.wrap&&(D.adler=1&W.wrap),W.mode=y,W.last=0,W.havedict=0,W.dmax=32768,W.head=null,W.hold=0,W.bits=0,W.lencode=W.lendyn=new i.Buf32(b),W.distcode=W.distdyn=new i.Buf32(v),W.sane=1,W.back=-1,h):m}function k(D){var W;return D&&D.state?((W=D.state).wsize=0,W.whave=0,W.wnext=0,S(D)):m}function C(D,W){var O,Z;return D&&D.state?(Z=D.state,W<0?(O=0,W=-W):(O=1+(W>>4),W<48&&(W&=15)),W&&(W<8||15<W)?m:(Z.window!==null&&Z.wbits!==W&&(Z.window=null),Z.wrap=O,Z.wbits=W,k(D))):m}function T(D,W){var O,Z;return D?(Z=new w,(D.state=Z).window=null,(O=C(D,W))!==h&&(D.state=null),O):m}var R,N,I=!0;function P(D){if(I){var W;for(R=new i.Buf32(512),N=new i.Buf32(32),W=0;W<144;)D.lens[W++]=8;for(;W<256;)D.lens[W++]=9;for(;W<280;)D.lens[W++]=7;for(;W<288;)D.lens[W++]=8;for(c(u,D.lens,0,288,R,0,D.work,{bits:9}),W=0;W<32;)D.lens[W++]=5;c(d,D.lens,0,32,N,0,D.work,{bits:5}),I=!1}D.lencode=R,D.lenbits=9,D.distcode=N,D.distbits=5}function B(D,W,O,Z){var U,H=D.state;return H.window===null&&(H.wsize=1<<H.wbits,H.wnext=0,H.whave=0,H.window=new i.Buf8(H.wsize)),Z>=H.wsize?(i.arraySet(H.window,W,O-H.wsize,H.wsize,0),H.wnext=0,H.whave=H.wsize):(Z<(U=H.wsize-H.wnext)&&(U=Z),i.arraySet(H.window,W,O-Z,U,H.wnext),(Z-=U)?(i.arraySet(H.window,W,O-Z,Z,0),H.wnext=Z,H.whave=H.wsize):(H.wnext+=U,H.wnext===H.wsize&&(H.wnext=0),H.whave<H.wsize&&(H.whave+=U))),0}s.inflateReset=k,s.inflateReset2=C,s.inflateResetKeep=S,s.inflateInit=function(D){return T(D,15)},s.inflateInit2=T,s.inflate=function(D,W){var O,Z,U,H,L,te,V,Q,ee,se,pe,ue,Oe,Fe,Se,Ce,qe,Qe,We,Ie,K,ye,Ne,ce,oe=0,re=new i.Buf8(4),Re=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!D||!D.state||!D.output||!D.input&&D.avail_in!==0)return m;(O=D.state).mode===12&&(O.mode=13),L=D.next_out,U=D.output,V=D.avail_out,H=D.next_in,Z=D.input,te=D.avail_in,Q=O.hold,ee=O.bits,se=te,pe=V,ye=h;e:for(;;)switch(O.mode){case y:if(O.wrap===0){O.mode=13;break}for(;ee<16;){if(te===0)break e;te--,Q+=Z[H++]<<ee,ee+=8}if(2&O.wrap&&Q===35615){re[O.check=0]=255&Q,re[1]=Q>>>8&255,O.check=o(O.check,re,2,0),ee=Q=0,O.mode=2;break}if(O.flags=0,O.head&&(O.head.done=!1),!(1&O.wrap)||(((255&Q)<<8)+(Q>>8))%31){D.msg="incorrect header check",O.mode=30;break}if((15&Q)!=8){D.msg="unknown compression method",O.mode=30;break}if(ee-=4,K=8+(15&(Q>>>=4)),O.wbits===0)O.wbits=K;else if(K>O.wbits){D.msg="invalid window size",O.mode=30;break}O.dmax=1<<K,D.adler=O.check=1,O.mode=512&Q?10:12,ee=Q=0;break;case 2:for(;ee<16;){if(te===0)break e;te--,Q+=Z[H++]<<ee,ee+=8}if(O.flags=Q,(255&O.flags)!=8){D.msg="unknown compression method",O.mode=30;break}if(57344&O.flags){D.msg="unknown header flags set",O.mode=30;break}O.head&&(O.head.text=Q>>8&1),512&O.flags&&(re[0]=255&Q,re[1]=Q>>>8&255,O.check=o(O.check,re,2,0)),ee=Q=0,O.mode=3;case 3:for(;ee<32;){if(te===0)break e;te--,Q+=Z[H++]<<ee,ee+=8}O.head&&(O.head.time=Q),512&O.flags&&(re[0]=255&Q,re[1]=Q>>>8&255,re[2]=Q>>>16&255,re[3]=Q>>>24&255,O.check=o(O.check,re,4,0)),ee=Q=0,O.mode=4;case 4:for(;ee<16;){if(te===0)break e;te--,Q+=Z[H++]<<ee,ee+=8}O.head&&(O.head.xflags=255&Q,O.head.os=Q>>8),512&O.flags&&(re[0]=255&Q,re[1]=Q>>>8&255,O.check=o(O.check,re,2,0)),ee=Q=0,O.mode=5;case 5:if(1024&O.flags){for(;ee<16;){if(te===0)break e;te--,Q+=Z[H++]<<ee,ee+=8}O.length=Q,O.head&&(O.head.extra_len=Q),512&O.flags&&(re[0]=255&Q,re[1]=Q>>>8&255,O.check=o(O.check,re,2,0)),ee=Q=0}else O.head&&(O.head.extra=null);O.mode=6;case 6:if(1024&O.flags&&(te<(ue=O.length)&&(ue=te),ue&&(O.head&&(K=O.head.extra_len-O.length,O.head.extra||(O.head.extra=new Array(O.head.extra_len)),i.arraySet(O.head.extra,Z,H,ue,K)),512&O.flags&&(O.check=o(O.check,Z,ue,H)),te-=ue,H+=ue,O.length-=ue),O.length))break e;O.length=0,O.mode=7;case 7:if(2048&O.flags){if(te===0)break e;for(ue=0;K=Z[H+ue++],O.head&&K&&O.length<65536&&(O.head.name+=String.fromCharCode(K)),K&&ue<te;);if(512&O.flags&&(O.check=o(O.check,Z,ue,H)),te-=ue,H+=ue,K)break e}else O.head&&(O.head.name=null);O.length=0,O.mode=8;case 8:if(4096&O.flags){if(te===0)break e;for(ue=0;K=Z[H+ue++],O.head&&K&&O.length<65536&&(O.head.comment+=String.fromCharCode(K)),K&&ue<te;);if(512&O.flags&&(O.check=o(O.check,Z,ue,H)),te-=ue,H+=ue,K)break e}else O.head&&(O.head.comment=null);O.mode=9;case 9:if(512&O.flags){for(;ee<16;){if(te===0)break e;te--,Q+=Z[H++]<<ee,ee+=8}if(Q!==(65535&O.check)){D.msg="header crc mismatch",O.mode=30;break}ee=Q=0}O.head&&(O.head.hcrc=O.flags>>9&1,O.head.done=!0),D.adler=O.check=0,O.mode=12;break;case 10:for(;ee<32;){if(te===0)break e;te--,Q+=Z[H++]<<ee,ee+=8}D.adler=O.check=x(Q),ee=Q=0,O.mode=11;case 11:if(O.havedict===0)return D.next_out=L,D.avail_out=V,D.next_in=H,D.avail_in=te,O.hold=Q,O.bits=ee,2;D.adler=O.check=1,O.mode=12;case 12:if(W===5||W===6)break e;case 13:if(O.last){Q>>>=7&ee,ee-=7&ee,O.mode=27;break}for(;ee<3;){if(te===0)break e;te--,Q+=Z[H++]<<ee,ee+=8}switch(O.last=1&Q,ee-=1,3&(Q>>>=1)){case 0:O.mode=14;break;case 1:if(P(O),O.mode=20,W!==6)break;Q>>>=2,ee-=2;break e;case 2:O.mode=17;break;case 3:D.msg="invalid block type",O.mode=30}Q>>>=2,ee-=2;break;case 14:for(Q>>>=7&ee,ee-=7&ee;ee<32;){if(te===0)break e;te--,Q+=Z[H++]<<ee,ee+=8}if((65535&Q)!=(Q>>>16^65535)){D.msg="invalid stored block lengths",O.mode=30;break}if(O.length=65535&Q,ee=Q=0,O.mode=15,W===6)break e;case 15:O.mode=16;case 16:if(ue=O.length){if(te<ue&&(ue=te),V<ue&&(ue=V),ue===0)break e;i.arraySet(U,Z,H,ue,L),te-=ue,H+=ue,V-=ue,L+=ue,O.length-=ue;break}O.mode=12;break;case 17:for(;ee<14;){if(te===0)break e;te--,Q+=Z[H++]<<ee,ee+=8}if(O.nlen=257+(31&Q),Q>>>=5,ee-=5,O.ndist=1+(31&Q),Q>>>=5,ee-=5,O.ncode=4+(15&Q),Q>>>=4,ee-=4,286<O.nlen||30<O.ndist){D.msg="too many length or distance symbols",O.mode=30;break}O.have=0,O.mode=18;case 18:for(;O.have<O.ncode;){for(;ee<3;){if(te===0)break e;te--,Q+=Z[H++]<<ee,ee+=8}O.lens[Re[O.have++]]=7&Q,Q>>>=3,ee-=3}for(;O.have<19;)O.lens[Re[O.have++]]=0;if(O.lencode=O.lendyn,O.lenbits=7,Ne={bits:O.lenbits},ye=c(0,O.lens,0,19,O.lencode,0,O.work,Ne),O.lenbits=Ne.bits,ye){D.msg="invalid code lengths set",O.mode=30;break}O.have=0,O.mode=19;case 19:for(;O.have<O.nlen+O.ndist;){for(;Ce=(oe=O.lencode[Q&(1<<O.lenbits)-1])>>>16&255,qe=65535&oe,!((Se=oe>>>24)<=ee);){if(te===0)break e;te--,Q+=Z[H++]<<ee,ee+=8}if(qe<16)Q>>>=Se,ee-=Se,O.lens[O.have++]=qe;else{if(qe===16){for(ce=Se+2;ee<ce;){if(te===0)break e;te--,Q+=Z[H++]<<ee,ee+=8}if(Q>>>=Se,ee-=Se,O.have===0){D.msg="invalid bit length repeat",O.mode=30;break}K=O.lens[O.have-1],ue=3+(3&Q),Q>>>=2,ee-=2}else if(qe===17){for(ce=Se+3;ee<ce;){if(te===0)break e;te--,Q+=Z[H++]<<ee,ee+=8}ee-=Se,K=0,ue=3+(7&(Q>>>=Se)),Q>>>=3,ee-=3}else{for(ce=Se+7;ee<ce;){if(te===0)break e;te--,Q+=Z[H++]<<ee,ee+=8}ee-=Se,K=0,ue=11+(127&(Q>>>=Se)),Q>>>=7,ee-=7}if(O.have+ue>O.nlen+O.ndist){D.msg="invalid bit length repeat",O.mode=30;break}for(;ue--;)O.lens[O.have++]=K}}if(O.mode===30)break;if(O.lens[256]===0){D.msg="invalid code -- missing end-of-block",O.mode=30;break}if(O.lenbits=9,Ne={bits:O.lenbits},ye=c(u,O.lens,0,O.nlen,O.lencode,0,O.work,Ne),O.lenbits=Ne.bits,ye){D.msg="invalid literal/lengths set",O.mode=30;break}if(O.distbits=6,O.distcode=O.distdyn,Ne={bits:O.distbits},ye=c(d,O.lens,O.nlen,O.ndist,O.distcode,0,O.work,Ne),O.distbits=Ne.bits,ye){D.msg="invalid distances set",O.mode=30;break}if(O.mode=20,W===6)break e;case 20:O.mode=21;case 21:if(6<=te&&258<=V){D.next_out=L,D.avail_out=V,D.next_in=H,D.avail_in=te,O.hold=Q,O.bits=ee,l(D,pe),L=D.next_out,U=D.output,V=D.avail_out,H=D.next_in,Z=D.input,te=D.avail_in,Q=O.hold,ee=O.bits,O.mode===12&&(O.back=-1);break}for(O.back=0;Ce=(oe=O.lencode[Q&(1<<O.lenbits)-1])>>>16&255,qe=65535&oe,!((Se=oe>>>24)<=ee);){if(te===0)break e;te--,Q+=Z[H++]<<ee,ee+=8}if(Ce&&(240&Ce)==0){for(Qe=Se,We=Ce,Ie=qe;Ce=(oe=O.lencode[Ie+((Q&(1<<Qe+We)-1)>>Qe)])>>>16&255,qe=65535&oe,!(Qe+(Se=oe>>>24)<=ee);){if(te===0)break e;te--,Q+=Z[H++]<<ee,ee+=8}Q>>>=Qe,ee-=Qe,O.back+=Qe}if(Q>>>=Se,ee-=Se,O.back+=Se,O.length=qe,Ce===0){O.mode=26;break}if(32&Ce){O.back=-1,O.mode=12;break}if(64&Ce){D.msg="invalid literal/length code",O.mode=30;break}O.extra=15&Ce,O.mode=22;case 22:if(O.extra){for(ce=O.extra;ee<ce;){if(te===0)break e;te--,Q+=Z[H++]<<ee,ee+=8}O.length+=Q&(1<<O.extra)-1,Q>>>=O.extra,ee-=O.extra,O.back+=O.extra}O.was=O.length,O.mode=23;case 23:for(;Ce=(oe=O.distcode[Q&(1<<O.distbits)-1])>>>16&255,qe=65535&oe,!((Se=oe>>>24)<=ee);){if(te===0)break e;te--,Q+=Z[H++]<<ee,ee+=8}if((240&Ce)==0){for(Qe=Se,We=Ce,Ie=qe;Ce=(oe=O.distcode[Ie+((Q&(1<<Qe+We)-1)>>Qe)])>>>16&255,qe=65535&oe,!(Qe+(Se=oe>>>24)<=ee);){if(te===0)break e;te--,Q+=Z[H++]<<ee,ee+=8}Q>>>=Qe,ee-=Qe,O.back+=Qe}if(Q>>>=Se,ee-=Se,O.back+=Se,64&Ce){D.msg="invalid distance code",O.mode=30;break}O.offset=qe,O.extra=15&Ce,O.mode=24;case 24:if(O.extra){for(ce=O.extra;ee<ce;){if(te===0)break e;te--,Q+=Z[H++]<<ee,ee+=8}O.offset+=Q&(1<<O.extra)-1,Q>>>=O.extra,ee-=O.extra,O.back+=O.extra}if(O.offset>O.dmax){D.msg="invalid distance too far back",O.mode=30;break}O.mode=25;case 25:if(V===0)break e;if(ue=pe-V,O.offset>ue){if((ue=O.offset-ue)>O.whave&&O.sane){D.msg="invalid distance too far back",O.mode=30;break}Oe=ue>O.wnext?(ue-=O.wnext,O.wsize-ue):O.wnext-ue,ue>O.length&&(ue=O.length),Fe=O.window}else Fe=U,Oe=L-O.offset,ue=O.length;for(V<ue&&(ue=V),V-=ue,O.length-=ue;U[L++]=Fe[Oe++],--ue;);O.length===0&&(O.mode=21);break;case 26:if(V===0)break e;U[L++]=O.length,V--,O.mode=21;break;case 27:if(O.wrap){for(;ee<32;){if(te===0)break e;te--,Q|=Z[H++]<<ee,ee+=8}if(pe-=V,D.total_out+=pe,O.total+=pe,pe&&(D.adler=O.check=O.flags?o(O.check,U,pe,L-pe):a(O.check,U,pe,L-pe)),pe=V,(O.flags?Q:x(Q))!==O.check){D.msg="incorrect data check",O.mode=30;break}ee=Q=0}O.mode=28;case 28:if(O.wrap&&O.flags){for(;ee<32;){if(te===0)break e;te--,Q+=Z[H++]<<ee,ee+=8}if(Q!==(4294967295&O.total)){D.msg="incorrect length check",O.mode=30;break}ee=Q=0}O.mode=29;case 29:ye=1;break e;case 30:ye=-3;break e;case 31:return-4;case 32:default:return m}return D.next_out=L,D.avail_out=V,D.next_in=H,D.avail_in=te,O.hold=Q,O.bits=ee,(O.wsize||pe!==D.avail_out&&O.mode<30&&(O.mode<27||W!==4))&&B(D,D.output,D.next_out,pe-D.avail_out)?(O.mode=31,-4):(se-=D.avail_in,pe-=D.avail_out,D.total_in+=se,D.total_out+=pe,O.total+=pe,O.wrap&&pe&&(D.adler=O.check=O.flags?o(O.check,U,pe,D.next_out-pe):a(O.check,U,pe,D.next_out-pe)),D.data_type=O.bits+(O.last?64:0)+(O.mode===12?128:0)+(O.mode===20||O.mode===15?256:0),(se==0&&pe===0||W===4)&&ye===h&&(ye=-5),ye)},s.inflateEnd=function(D){if(!D||!D.state)return m;var W=D.state;return W.window&&(W.window=null),D.state=null,h},s.inflateGetHeader=function(D,W){var O;return D&&D.state?(2&(O=D.state).wrap)==0?m:((O.head=W).done=!1,h):m},s.inflateSetDictionary=function(D,W){var O,Z=W.length;return D&&D.state?(O=D.state).wrap!==0&&O.mode!==11?m:O.mode===11&&a(1,W,Z,0)!==O.check?-3:B(D,W,Z,Z)?(O.mode=31,-4):(O.havedict=1,h):m},s.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(n,r,s){var i=n("../utils/common"),a=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],o=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],l=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],c=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];r.exports=function(u,d,h,m,y,b,v,x){var w,S,k,C,T,R,N,I,P,B=x.bits,D=0,W=0,O=0,Z=0,U=0,H=0,L=0,te=0,V=0,Q=0,ee=null,se=0,pe=new i.Buf16(16),ue=new i.Buf16(16),Oe=null,Fe=0;for(D=0;D<=15;D++)pe[D]=0;for(W=0;W<m;W++)pe[d[h+W]]++;for(U=B,Z=15;1<=Z&&pe[Z]===0;Z--);if(Z<U&&(U=Z),Z===0)return y[b++]=20971520,y[b++]=20971520,x.bits=1,0;for(O=1;O<Z&&pe[O]===0;O++);for(U<O&&(U=O),D=te=1;D<=15;D++)if(te<<=1,(te-=pe[D])<0)return-1;if(0<te&&(u===0||Z!==1))return-1;for(ue[1]=0,D=1;D<15;D++)ue[D+1]=ue[D]+pe[D];for(W=0;W<m;W++)d[h+W]!==0&&(v[ue[d[h+W]]++]=W);if(R=u===0?(ee=Oe=v,19):u===1?(ee=a,se-=257,Oe=o,Fe-=257,256):(ee=l,Oe=c,-1),D=O,T=b,L=W=Q=0,k=-1,C=(V=1<<(H=U))-1,u===1&&852<V||u===2&&592<V)return 1;for(;;){for(N=D-L,P=v[W]<R?(I=0,v[W]):v[W]>R?(I=Oe[Fe+v[W]],ee[se+v[W]]):(I=96,0),w=1<<D-L,O=S=1<<H;y[T+(Q>>L)+(S-=w)]=N<<24|I<<16|P|0,S!==0;);for(w=1<<D-1;Q&w;)w>>=1;if(w!==0?(Q&=w-1,Q+=w):Q=0,W++,--pe[D]==0){if(D===Z)break;D=d[h+v[W]]}if(U<D&&(Q&C)!==k){for(L===0&&(L=U),T+=O,te=1<<(H=D-L);H+L<Z&&!((te-=pe[H+L])<=0);)H++,te<<=1;if(V+=1<<H,u===1&&852<V||u===2&&592<V)return 1;y[k=Q&C]=U<<24|H<<16|T-b|0}}return Q!==0&&(y[T+Q]=D-L<<24|64<<16|0),x.bits=U,0}},{"../utils/common":41}],51:[function(n,r,s){r.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(n,r,s){var i=n("../utils/common"),a=0,o=1;function l(oe){for(var re=oe.length;0<=--re;)oe[re]=0}var c=0,u=29,d=256,h=d+1+u,m=30,y=19,b=2*h+1,v=15,x=16,w=7,S=256,k=16,C=17,T=18,R=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],N=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],I=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],P=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],B=new Array(2*(h+2));l(B);var D=new Array(2*m);l(D);var W=new Array(512);l(W);var O=new Array(256);l(O);var Z=new Array(u);l(Z);var U,H,L,te=new Array(m);function V(oe,re,Re,Be,Te){this.static_tree=oe,this.extra_bits=re,this.extra_base=Re,this.elems=Be,this.max_length=Te,this.has_stree=oe&&oe.length}function Q(oe,re){this.dyn_tree=oe,this.max_code=0,this.stat_desc=re}function ee(oe){return oe<256?W[oe]:W[256+(oe>>>7)]}function se(oe,re){oe.pending_buf[oe.pending++]=255&re,oe.pending_buf[oe.pending++]=re>>>8&255}function pe(oe,re,Re){oe.bi_valid>x-Re?(oe.bi_buf|=re<<oe.bi_valid&65535,se(oe,oe.bi_buf),oe.bi_buf=re>>x-oe.bi_valid,oe.bi_valid+=Re-x):(oe.bi_buf|=re<<oe.bi_valid&65535,oe.bi_valid+=Re)}function ue(oe,re,Re){pe(oe,Re[2*re],Re[2*re+1])}function Oe(oe,re){for(var Re=0;Re|=1&oe,oe>>>=1,Re<<=1,0<--re;);return Re>>>1}function Fe(oe,re,Re){var Be,Te,lt=new Array(v+1),Tt=0;for(Be=1;Be<=v;Be++)lt[Be]=Tt=Tt+Re[Be-1]<<1;for(Te=0;Te<=re;Te++){var ut=oe[2*Te+1];ut!==0&&(oe[2*Te]=Oe(lt[ut]++,ut))}}function Se(oe){var re;for(re=0;re<h;re++)oe.dyn_ltree[2*re]=0;for(re=0;re<m;re++)oe.dyn_dtree[2*re]=0;for(re=0;re<y;re++)oe.bl_tree[2*re]=0;oe.dyn_ltree[2*S]=1,oe.opt_len=oe.static_len=0,oe.last_lit=oe.matches=0}function Ce(oe){8<oe.bi_valid?se(oe,oe.bi_buf):0<oe.bi_valid&&(oe.pending_buf[oe.pending++]=oe.bi_buf),oe.bi_buf=0,oe.bi_valid=0}function qe(oe,re,Re,Be){var Te=2*re,lt=2*Re;return oe[Te]<oe[lt]||oe[Te]===oe[lt]&&Be[re]<=Be[Re]}function Qe(oe,re,Re){for(var Be=oe.heap[Re],Te=Re<<1;Te<=oe.heap_len&&(Te<oe.heap_len&&qe(re,oe.heap[Te+1],oe.heap[Te],oe.depth)&&Te++,!qe(re,Be,oe.heap[Te],oe.depth));)oe.heap[Re]=oe.heap[Te],Re=Te,Te<<=1;oe.heap[Re]=Be}function We(oe,re,Re){var Be,Te,lt,Tt,ut=0;if(oe.last_lit!==0)for(;Be=oe.pending_buf[oe.d_buf+2*ut]<<8|oe.pending_buf[oe.d_buf+2*ut+1],Te=oe.pending_buf[oe.l_buf+ut],ut++,Be===0?ue(oe,Te,re):(ue(oe,(lt=O[Te])+d+1,re),(Tt=R[lt])!==0&&pe(oe,Te-=Z[lt],Tt),ue(oe,lt=ee(--Be),Re),(Tt=N[lt])!==0&&pe(oe,Be-=te[lt],Tt)),ut<oe.last_lit;);ue(oe,S,re)}function Ie(oe,re){var Re,Be,Te,lt=re.dyn_tree,Tt=re.stat_desc.static_tree,ut=re.stat_desc.has_stree,jt=re.stat_desc.elems,qt=-1;for(oe.heap_len=0,oe.heap_max=b,Re=0;Re<jt;Re++)lt[2*Re]!==0?(oe.heap[++oe.heap_len]=qt=Re,oe.depth[Re]=0):lt[2*Re+1]=0;for(;oe.heap_len<2;)lt[2*(Te=oe.heap[++oe.heap_len]=qt<2?++qt:0)]=1,oe.depth[Te]=0,oe.opt_len--,ut&&(oe.static_len-=Tt[2*Te+1]);for(re.max_code=qt,Re=oe.heap_len>>1;1<=Re;Re--)Qe(oe,lt,Re);for(Te=jt;Re=oe.heap[1],oe.heap[1]=oe.heap[oe.heap_len--],Qe(oe,lt,1),Be=oe.heap[1],oe.heap[--oe.heap_max]=Re,oe.heap[--oe.heap_max]=Be,lt[2*Te]=lt[2*Re]+lt[2*Be],oe.depth[Te]=(oe.depth[Re]>=oe.depth[Be]?oe.depth[Re]:oe.depth[Be])+1,lt[2*Re+1]=lt[2*Be+1]=Te,oe.heap[1]=Te++,Qe(oe,lt,1),2<=oe.heap_len;);oe.heap[--oe.heap_max]=oe.heap[1],function(Ft,Ht){var we,F,X,be,ke,ge,Ee=Ht.dyn_tree,le=Ht.max_code,dt=Ht.stat_desc.static_tree,et=Ht.stat_desc.has_stree,$=Ht.stat_desc.extra_bits,Ue=Ht.stat_desc.extra_base,tt=Ht.stat_desc.max_length,ve=0;for(be=0;be<=v;be++)Ft.bl_count[be]=0;for(Ee[2*Ft.heap[Ft.heap_max]+1]=0,we=Ft.heap_max+1;we<b;we++)tt<(be=Ee[2*Ee[2*(F=Ft.heap[we])+1]+1]+1)&&(be=tt,ve++),Ee[2*F+1]=be,le<F||(Ft.bl_count[be]++,ke=0,Ue<=F&&(ke=$[F-Ue]),ge=Ee[2*F],Ft.opt_len+=ge*(be+ke),et&&(Ft.static_len+=ge*(dt[2*F+1]+ke)));if(ve!==0){do{for(be=tt-1;Ft.bl_count[be]===0;)be--;Ft.bl_count[be]--,Ft.bl_count[be+1]+=2,Ft.bl_count[tt]--,ve-=2}while(0<ve);for(be=tt;be!==0;be--)for(F=Ft.bl_count[be];F!==0;)le<(X=Ft.heap[--we])||(Ee[2*X+1]!==be&&(Ft.opt_len+=(be-Ee[2*X+1])*Ee[2*X],Ee[2*X+1]=be),F--)}}(oe,re),Fe(lt,qt,oe.bl_count)}function K(oe,re,Re){var Be,Te,lt=-1,Tt=re[1],ut=0,jt=7,qt=4;for(Tt===0&&(jt=138,qt=3),re[2*(Re+1)+1]=65535,Be=0;Be<=Re;Be++)Te=Tt,Tt=re[2*(Be+1)+1],++ut<jt&&Te===Tt||(ut<qt?oe.bl_tree[2*Te]+=ut:Te!==0?(Te!==lt&&oe.bl_tree[2*Te]++,oe.bl_tree[2*k]++):ut<=10?oe.bl_tree[2*C]++:oe.bl_tree[2*T]++,lt=Te,qt=(ut=0)===Tt?(jt=138,3):Te===Tt?(jt=6,3):(jt=7,4))}function ye(oe,re,Re){var Be,Te,lt=-1,Tt=re[1],ut=0,jt=7,qt=4;for(Tt===0&&(jt=138,qt=3),Be=0;Be<=Re;Be++)if(Te=Tt,Tt=re[2*(Be+1)+1],!(++ut<jt&&Te===Tt)){if(ut<qt)for(;ue(oe,Te,oe.bl_tree),--ut!=0;);else Te!==0?(Te!==lt&&(ue(oe,Te,oe.bl_tree),ut--),ue(oe,k,oe.bl_tree),pe(oe,ut-3,2)):ut<=10?(ue(oe,C,oe.bl_tree),pe(oe,ut-3,3)):(ue(oe,T,oe.bl_tree),pe(oe,ut-11,7));lt=Te,qt=(ut=0)===Tt?(jt=138,3):Te===Tt?(jt=6,3):(jt=7,4)}}l(te);var Ne=!1;function ce(oe,re,Re,Be){pe(oe,(c<<1)+(Be?1:0),3),function(Te,lt,Tt,ut){Ce(Te),se(Te,Tt),se(Te,~Tt),i.arraySet(Te.pending_buf,Te.window,lt,Tt,Te.pending),Te.pending+=Tt}(oe,re,Re)}s._tr_init=function(oe){Ne||(function(){var re,Re,Be,Te,lt,Tt=new Array(v+1);for(Te=Be=0;Te<u-1;Te++)for(Z[Te]=Be,re=0;re<1<<R[Te];re++)O[Be++]=Te;for(O[Be-1]=Te,Te=lt=0;Te<16;Te++)for(te[Te]=lt,re=0;re<1<<N[Te];re++)W[lt++]=Te;for(lt>>=7;Te<m;Te++)for(te[Te]=lt<<7,re=0;re<1<<N[Te]-7;re++)W[256+lt++]=Te;for(Re=0;Re<=v;Re++)Tt[Re]=0;for(re=0;re<=143;)B[2*re+1]=8,re++,Tt[8]++;for(;re<=255;)B[2*re+1]=9,re++,Tt[9]++;for(;re<=279;)B[2*re+1]=7,re++,Tt[7]++;for(;re<=287;)B[2*re+1]=8,re++,Tt[8]++;for(Fe(B,h+1,Tt),re=0;re<m;re++)D[2*re+1]=5,D[2*re]=Oe(re,5);U=new V(B,R,d+1,h,v),H=new V(D,N,0,m,v),L=new V(new Array(0),I,0,y,w)}(),Ne=!0),oe.l_desc=new Q(oe.dyn_ltree,U),oe.d_desc=new Q(oe.dyn_dtree,H),oe.bl_desc=new Q(oe.bl_tree,L),oe.bi_buf=0,oe.bi_valid=0,Se(oe)},s._tr_stored_block=ce,s._tr_flush_block=function(oe,re,Re,Be){var Te,lt,Tt=0;0<oe.level?(oe.strm.data_type===2&&(oe.strm.data_type=function(ut){var jt,qt=4093624447;for(jt=0;jt<=31;jt++,qt>>>=1)if(1&qt&&ut.dyn_ltree[2*jt]!==0)return a;if(ut.dyn_ltree[18]!==0||ut.dyn_ltree[20]!==0||ut.dyn_ltree[26]!==0)return o;for(jt=32;jt<d;jt++)if(ut.dyn_ltree[2*jt]!==0)return o;return a}(oe)),Ie(oe,oe.l_desc),Ie(oe,oe.d_desc),Tt=function(ut){var jt;for(K(ut,ut.dyn_ltree,ut.l_desc.max_code),K(ut,ut.dyn_dtree,ut.d_desc.max_code),Ie(ut,ut.bl_desc),jt=y-1;3<=jt&&ut.bl_tree[2*P[jt]+1]===0;jt--);return ut.opt_len+=3*(jt+1)+5+5+4,jt}(oe),Te=oe.opt_len+3+7>>>3,(lt=oe.static_len+3+7>>>3)<=Te&&(Te=lt)):Te=lt=Re+5,Re+4<=Te&&re!==-1?ce(oe,re,Re,Be):oe.strategy===4||lt===Te?(pe(oe,2+(Be?1:0),3),We(oe,B,D)):(pe(oe,4+(Be?1:0),3),function(ut,jt,qt,Ft){var Ht;for(pe(ut,jt-257,5),pe(ut,qt-1,5),pe(ut,Ft-4,4),Ht=0;Ht<Ft;Ht++)pe(ut,ut.bl_tree[2*P[Ht]+1],3);ye(ut,ut.dyn_ltree,jt-1),ye(ut,ut.dyn_dtree,qt-1)}(oe,oe.l_desc.max_code+1,oe.d_desc.max_code+1,Tt+1),We(oe,oe.dyn_ltree,oe.dyn_dtree)),Se(oe),Be&&Ce(oe)},s._tr_tally=function(oe,re,Re){return oe.pending_buf[oe.d_buf+2*oe.last_lit]=re>>>8&255,oe.pending_buf[oe.d_buf+2*oe.last_lit+1]=255&re,oe.pending_buf[oe.l_buf+oe.last_lit]=255&Re,oe.last_lit++,re===0?oe.dyn_ltree[2*Re]++:(oe.matches++,re--,oe.dyn_ltree[2*(O[Re]+d+1)]++,oe.dyn_dtree[2*ee(re)]++),oe.last_lit===oe.lit_bufsize-1},s._tr_align=function(oe){pe(oe,2,3),ue(oe,S,B),function(re){re.bi_valid===16?(se(re,re.bi_buf),re.bi_buf=0,re.bi_valid=0):8<=re.bi_valid&&(re.pending_buf[re.pending++]=255&re.bi_buf,re.bi_buf>>=8,re.bi_valid-=8)}(oe)}},{"../utils/common":41}],53:[function(n,r,s){r.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(n,r,s){(function(i){(function(a,o){if(!a.setImmediate){var l,c,u,d,h=1,m={},y=!1,b=a.document,v=Object.getPrototypeOf&&Object.getPrototypeOf(a);v=v&&v.setTimeout?v:a,l={}.toString.call(a.process)==="[object process]"?function(k){Mi.nextTick(function(){w(k)})}:function(){if(a.postMessage&&!a.importScripts){var k=!0,C=a.onmessage;return a.onmessage=function(){k=!1},a.postMessage("","*"),a.onmessage=C,k}}()?(d="setImmediate$"+Math.random()+"$",a.addEventListener?a.addEventListener("message",S,!1):a.attachEvent("onmessage",S),function(k){a.postMessage(d+k,"*")}):a.MessageChannel?((u=new MessageChannel).port1.onmessage=function(k){w(k.data)},function(k){u.port2.postMessage(k)}):b&&"onreadystatechange"in b.createElement("script")?(c=b.documentElement,function(k){var C=b.createElement("script");C.onreadystatechange=function(){w(k),C.onreadystatechange=null,c.removeChild(C),C=null},c.appendChild(C)}):function(k){setTimeout(w,0,k)},v.setImmediate=function(k){typeof k!="function"&&(k=new Function(""+k));for(var C=new Array(arguments.length-1),T=0;T<C.length;T++)C[T]=arguments[T+1];var R={callback:k,args:C};return m[h]=R,l(h),h++},v.clearImmediate=x}function x(k){delete m[k]}function w(k){if(y)setTimeout(w,0,k);else{var C=m[k];if(C){y=!0;try{(function(T){var R=T.callback,N=T.args;switch(N.length){case 0:R();break;case 1:R(N[0]);break;case 2:R(N[0],N[1]);break;case 3:R(N[0],N[1],N[2]);break;default:R.apply(o,N)}})(C)}finally{x(k),y=!1}}}}function S(k){k.source===a&&typeof k.data=="string"&&k.data.indexOf(d)===0&&w(+k.data.slice(d.length))}})(typeof self>"u"?i===void 0?this:i:self)}).call(this,typeof tm<"u"?tm:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})}(IM)),IM.exports}var w2e=x2e();const lD=ua(w2e),pw=(e,t=2)=>{if(e===0)return"0 Bytes";const n=1024,r=t<0?0:t,s=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],i=Math.floor(Math.log(e)/Math.log(n));return parseFloat((e/Math.pow(n,i)).toFixed(r))+" "+s[i]},zr=e=>{let t=e.replace(/\/+/g,"/");return t.startsWith("/")||(t="/"+t),t!=="/"&&t.endsWith("/")&&(t=t.slice(0,-1)),t},Du=(...e)=>zr(e.map(t=>t.trim()).filter(Boolean).join("/")),tT=e=>{const t=zr(e);if(t==="/")return"/";const n=t.lastIndexOf("/");return n===-1||n===0?"/":t.substring(0,n)},vi=e=>{const t=zr(e);return t==="/"?"":t.substring(t.lastIndexOf("/")+1)},jj=(e,t)=>zr(e==="/"?`/${t}`:`${e}/${t}`);var jM,j9;function _2e(){if(j9)return jM;j9=1;var e=function(t){if(t=t||{},this.Promise=t.Promise||Promise,this.queues=Object.create(null),this.domainReentrant=t.domainReentrant||!1,this.domainReentrant){if(typeof Mi>"u"||typeof Mi.domain>"u")throw new Error("Domain-reentrant locks require `process.domain` to exist. Please flip `opts.domainReentrant = false`, use a NodeJS version that still implements Domain, or install a browser polyfill.");this.domains=Object.create(null)}this.timeout=t.timeout||e.DEFAULT_TIMEOUT,this.maxOccupationTime=t.maxOccupationTime||e.DEFAULT_MAX_OCCUPATION_TIME,this.maxExecutionTime=t.maxExecutionTime||e.DEFAULT_MAX_EXECUTION_TIME,t.maxPending===1/0||Number.isInteger(t.maxPending)&&t.maxPending>=0?this.maxPending=t.maxPending:this.maxPending=e.DEFAULT_MAX_PENDING};return e.DEFAULT_TIMEOUT=0,e.DEFAULT_MAX_OCCUPATION_TIME=0,e.DEFAULT_MAX_EXECUTION_TIME=0,e.DEFAULT_MAX_PENDING=1e3,e.prototype.acquire=function(t,n,r,s){if(Array.isArray(t))return this._acquireBatch(t,n,r,s);if(typeof n!="function")throw new Error("You must pass a function to execute");var i=null,a=null,o=null;typeof r!="function"&&(s=r,r=null,o=new this.Promise(function(S,k){i=S,a=k})),s=s||{};var l=!1,c=null,u=null,d=null,h=this,m=function(S,k,C){u&&(clearTimeout(u),u=null),d&&(clearTimeout(d),d=null),S&&(h.queues[t]&&h.queues[t].length===0&&delete h.queues[t],h.domainReentrant&&delete h.domains[t]),l||(o?k?a(k):i(C):typeof r=="function"&&r(k,C),l=!0),S&&h.queues[t]&&h.queues[t].length>0&&h.queues[t].shift()()},y=function(S){if(l)return m(S);c&&(clearTimeout(c),c=null),h.domainReentrant&&S&&(h.domains[t]=Mi.domain);var k=s.maxExecutionTime||h.maxExecutionTime;if(k&&(d=setTimeout(function(){h.queues[t]&&m(S,new Error("Maximum execution time is exceeded "+t))},k)),n.length===1){var C=!1;try{n(function(T,R){C||(C=!0,m(S,T,R))})}catch(T){C||(C=!0,m(S,T))}}else h._promiseTry(function(){return n()}).then(function(T){m(S,void 0,T)},function(T){m(S,T)})};h.domainReentrant&&Mi.domain&&(y=Mi.domain.bind(y));var b=s.maxPending||h.maxPending;if(!h.queues[t])h.queues[t]=[],y(!0);else if(h.domainReentrant&&Mi.domain&&Mi.domain===h.domains[t])y(!1);else if(h.queues[t].length>=b)m(!1,new Error("Too many pending tasks in queue "+t));else{var v=function(){y(!0)};s.skipQueue?h.queues[t].unshift(v):h.queues[t].push(v);var x=s.timeout||h.timeout;x&&(c=setTimeout(function(){c=null,m(!1,new Error("async-lock timed out in queue "+t))},x))}var w=s.maxOccupationTime||h.maxOccupationTime;if(w&&(u=setTimeout(function(){h.queues[t]&&m(!1,new Error("Maximum occupation time is exceeded in queue "+t))},w)),o)return o},e.prototype._acquireBatch=function(t,n,r,s){typeof r!="function"&&(s=r,r=null);var i=this,a=function(l,c){return function(u){i.acquire(l,c,u,s)}},o=t.reduceRight(function(l,c){return a(c,l)},n);if(typeof r=="function")o(r);else return new this.Promise(function(l,c){o.length===1?o(function(u,d){u?c(u):l(d)}):l(o())})},e.prototype.isBusy=function(t){return t?!!this.queues[t]:Object.keys(this.queues).length>0},e.prototype._promiseTry=function(t){try{return this.Promise.resolve(t())}catch(n){return this.Promise.reject(n)}},jM=e,jM}var OM,O9;function S2e(){return O9||(O9=1,OM=_2e()),OM}var C2e=S2e();const mw=ua(C2e);var zS={exports:{}},P9;function k2e(){return P9||(P9=1,typeof Object.create=="function"?zS.exports=function(t,n){n&&(t.super_=n,t.prototype=Object.create(n.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:zS.exports=function(t,n){if(n){t.super_=n;var r=function(){};r.prototype=n.prototype,t.prototype=new r,t.prototype.constructor=t}}),zS.exports}var PM,D9;function E2e(){if(D9)return PM;D9=1;var e=XP().Buffer;function t(n,r){this._block=e.alloc(n),this._finalSize=r,this._blockSize=n,this._len=0}return t.prototype.update=function(n,r){typeof n=="string"&&(r=r||"utf8",n=e.from(n,r));for(var s=this._block,i=this._blockSize,a=n.length,o=this._len,l=0;l<a;){for(var c=o%i,u=Math.min(a-l,i-c),d=0;d<u;d++)s[c+d]=n[l+d];o+=u,l+=u,o%i===0&&this._update(s)}return this._len+=a,this},t.prototype.digest=function(n){var r=this._len%this._blockSize;this._block[r]=128,this._block.fill(0,r+1),r>=this._finalSize&&(this._update(this._block),this._block.fill(0));var s=this._len*8;if(s<=4294967295)this._block.writeUInt32BE(s,this._blockSize-4);else{var i=(s&4294967295)>>>0,a=(s-i)/4294967296;this._block.writeUInt32BE(a,this._blockSize-8),this._block.writeUInt32BE(i,this._blockSize-4)}this._update(this._block);var o=this._hash();return n?o.toString(n):o},t.prototype._update=function(){throw new Error("_update must be implemented by subclass")},PM=t,PM}var DM,F9;function T2e(){if(F9)return DM;F9=1;var e=k2e(),t=E2e(),n=XP().Buffer,r=[1518500249,1859775393,-1894007588,-899497514],s=new Array(80);function i(){this.init(),this._w=s,t.call(this,64,56)}e(i,t),i.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this};function a(u){return u<<1|u>>>31}function o(u){return u<<5|u>>>27}function l(u){return u<<30|u>>>2}function c(u,d,h,m){return u===0?d&h|~d&m:u===2?d&h|d&m|h&m:d^h^m}return i.prototype._update=function(u){for(var d=this._w,h=this._a|0,m=this._b|0,y=this._c|0,b=this._d|0,v=this._e|0,x=0;x<16;++x)d[x]=u.readInt32BE(x*4);for(;x<80;++x)d[x]=a(d[x-3]^d[x-8]^d[x-14]^d[x-16]);for(var w=0;w<80;++w){var S=~~(w/20),k=o(h)+c(S,m,y,b)+v+d[w]+r[S]|0;v=b,b=y,y=l(m),m=h,h=k}this._a=h+this._a|0,this._b=m+this._b|0,this._c=y+this._c|0,this._d=b+this._d|0,this._e=v+this._e|0},i.prototype._hash=function(){var u=n.allocUnsafe(20);return u.writeInt32BE(this._a|0,0),u.writeInt32BE(this._b|0,4),u.writeInt32BE(this._c|0,8),u.writeInt32BE(this._d|0,12),u.writeInt32BE(this._e|0,16),u},DM=i,DM}var A2e=T2e();const NY=ua(A2e);var FM,L9;function R2e(){if(L9)return FM;L9=1;function e(s){if(typeof s!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(s))}function t(s,i){for(var a="",o=0,l=-1,c=0,u,d=0;d<=s.length;++d){if(d<s.length)u=s.charCodeAt(d);else{if(u===47)break;u=47}if(u===47){if(!(l===d-1||c===1))if(l!==d-1&&c===2){if(a.length<2||o!==2||a.charCodeAt(a.length-1)!==46||a.charCodeAt(a.length-2)!==46){if(a.length>2){var h=a.lastIndexOf("/");if(h!==a.length-1){h===-1?(a="",o=0):(a=a.slice(0,h),o=a.length-1-a.lastIndexOf("/")),l=d,c=0;continue}}else if(a.length===2||a.length===1){a="",o=0,l=d,c=0;continue}}i&&(a.length>0?a+="/..":a="..",o=2)}else a.length>0?a+="/"+s.slice(l+1,d):a=s.slice(l+1,d),o=d-l-1;l=d,c=0}else u===46&&c!==-1?++c:c=-1}return a}function n(s,i){var a=i.dir||i.root,o=i.base||(i.name||"")+(i.ext||"");return a?a===i.root?a+o:a+s+o:o}var r={resolve:function(){for(var i="",a=!1,o,l=arguments.length-1;l>=-1&&!a;l--){var c;l>=0?c=arguments[l]:(o===void 0&&(o=Mi.cwd()),c=o),e(c),c.length!==0&&(i=c+"/"+i,a=c.charCodeAt(0)===47)}return i=t(i,!a),a?i.length>0?"/"+i:"/":i.length>0?i:"."},normalize:function(i){if(e(i),i.length===0)return".";var a=i.charCodeAt(0)===47,o=i.charCodeAt(i.length-1)===47;return i=t(i,!a),i.length===0&&!a&&(i="."),i.length>0&&o&&(i+="/"),a?"/"+i:i},isAbsolute:function(i){return e(i),i.length>0&&i.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var i,a=0;a<arguments.length;++a){var o=arguments[a];e(o),o.length>0&&(i===void 0?i=o:i+="/"+o)}return i===void 0?".":r.normalize(i)},relative:function(i,a){if(e(i),e(a),i===a||(i=r.resolve(i),a=r.resolve(a),i===a))return"";for(var o=1;o<i.length&&i.charCodeAt(o)===47;++o);for(var l=i.length,c=l-o,u=1;u<a.length&&a.charCodeAt(u)===47;++u);for(var d=a.length,h=d-u,m=c<h?c:h,y=-1,b=0;b<=m;++b){if(b===m){if(h>m){if(a.charCodeAt(u+b)===47)return a.slice(u+b+1);if(b===0)return a.slice(u+b)}else c>m&&(i.charCodeAt(o+b)===47?y=b:b===0&&(y=0));break}var v=i.charCodeAt(o+b),x=a.charCodeAt(u+b);if(v!==x)break;v===47&&(y=b)}var w="";for(b=o+y+1;b<=l;++b)(b===l||i.charCodeAt(b)===47)&&(w.length===0?w+="..":w+="/..");return w.length>0?w+a.slice(u+y):(u+=y,a.charCodeAt(u)===47&&++u,a.slice(u))},_makeLong:function(i){return i},dirname:function(i){if(e(i),i.length===0)return".";for(var a=i.charCodeAt(0),o=a===47,l=-1,c=!0,u=i.length-1;u>=1;--u)if(a=i.charCodeAt(u),a===47){if(!c){l=u;break}}else c=!1;return l===-1?o?"/":".":o&&l===1?"//":i.slice(0,l)},basename:function(i,a){if(a!==void 0&&typeof a!="string")throw new TypeError('"ext" argument must be a string');e(i);var o=0,l=-1,c=!0,u;if(a!==void 0&&a.length>0&&a.length<=i.length){if(a.length===i.length&&a===i)return"";var d=a.length-1,h=-1;for(u=i.length-1;u>=0;--u){var m=i.charCodeAt(u);if(m===47){if(!c){o=u+1;break}}else h===-1&&(c=!1,h=u+1),d>=0&&(m===a.charCodeAt(d)?--d===-1&&(l=u):(d=-1,l=h))}return o===l?l=h:l===-1&&(l=i.length),i.slice(o,l)}else{for(u=i.length-1;u>=0;--u)if(i.charCodeAt(u)===47){if(!c){o=u+1;break}}else l===-1&&(c=!1,l=u+1);return l===-1?"":i.slice(o,l)}},extname:function(i){e(i);for(var a=-1,o=0,l=-1,c=!0,u=0,d=i.length-1;d>=0;--d){var h=i.charCodeAt(d);if(h===47){if(!c){o=d+1;break}continue}l===-1&&(c=!1,l=d+1),h===46?a===-1?a=d:u!==1&&(u=1):a!==-1&&(u=-1)}return a===-1||l===-1||u===0||u===1&&a===l-1&&a===o+1?"":i.slice(a,l)},format:function(i){if(i===null||typeof i!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof i);return n("/",i)},parse:function(i){e(i);var a={root:"",dir:"",base:"",ext:"",name:""};if(i.length===0)return a;var o=i.charCodeAt(0),l=o===47,c;l?(a.root="/",c=1):c=0;for(var u=-1,d=0,h=-1,m=!0,y=i.length-1,b=0;y>=c;--y){if(o=i.charCodeAt(y),o===47){if(!m){d=y+1;break}continue}h===-1&&(m=!1,h=y+1),o===46?u===-1?u=y:b!==1&&(b=1):u!==-1&&(b=-1)}return u===-1||h===-1||b===0||b===1&&u===h-1&&u===d+1?h!==-1&&(d===0&&l?a.base=a.name=i.slice(1,h):a.base=a.name=i.slice(d,h)):(d===0&&l?(a.name=i.slice(1,u),a.base=i.slice(1,h)):(a.name=i.slice(d,u),a.base=i.slice(d,h)),a.ext=i.slice(u,h)),d>0?a.dir=i.slice(0,d-1):l&&(a.dir="/"),a},sep:"/",delimiter:":",win32:null,posix:null};return r.posix=r,FM=r,FM}var $t=R2e(),LM={};/*! crc32.js (C) 2014-present SheetJS -- http://sheetjs.com */var B9;function N2e(){return B9||(B9=1,function(e){(function(t){t(typeof DO_NOT_EXPORT_CRC>"u"?e:{})})(function(t){t.version="1.2.2";function n(){for(var N=0,I=new Array(256),P=0;P!=256;++P)N=P,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,I[P]=N;return typeof Int32Array<"u"?new Int32Array(I):I}var r=n();function s(N){var I=0,P=0,B=0,D=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(B=0;B!=256;++B)D[B]=N[B];for(B=0;B!=256;++B)for(P=N[B],I=256+B;I<4096;I+=256)P=D[I]=P>>>8^N[P&255];var W=[];for(B=1;B!=16;++B)W[B-1]=typeof Int32Array<"u"?D.subarray(B*256,B*256+256):D.slice(B*256,B*256+256);return W}var i=s(r),a=i[0],o=i[1],l=i[2],c=i[3],u=i[4],d=i[5],h=i[6],m=i[7],y=i[8],b=i[9],v=i[10],x=i[11],w=i[12],S=i[13],k=i[14];function C(N,I){for(var P=I^-1,B=0,D=N.length;B<D;)P=P>>>8^r[(P^N.charCodeAt(B++))&255];return~P}function T(N,I){for(var P=I^-1,B=N.length-15,D=0;D<B;)P=k[N[D++]^P&255]^S[N[D++]^P>>8&255]^w[N[D++]^P>>16&255]^x[N[D++]^P>>>24]^v[N[D++]]^b[N[D++]]^y[N[D++]]^m[N[D++]]^h[N[D++]]^d[N[D++]]^u[N[D++]]^c[N[D++]]^l[N[D++]]^o[N[D++]]^a[N[D++]]^r[N[D++]];for(B+=15;D<B;)P=P>>>8^r[(P^N[D++])&255];return~P}function R(N,I){for(var P=I^-1,B=0,D=N.length,W=0,O=0;B<D;)W=N.charCodeAt(B++),W<128?P=P>>>8^r[(P^W)&255]:W<2048?(P=P>>>8^r[(P^(192|W>>6&31))&255],P=P>>>8^r[(P^(128|W&63))&255]):W>=55296&&W<57344?(W=(W&1023)+64,O=N.charCodeAt(B++)&1023,P=P>>>8^r[(P^(240|W>>8&7))&255],P=P>>>8^r[(P^(128|W>>2&63))&255],P=P>>>8^r[(P^(128|O>>6&15|(W&3)<<4))&255],P=P>>>8^r[(P^(128|O&63))&255]):(P=P>>>8^r[(P^(224|W>>12&15))&255],P=P>>>8^r[(P^(128|W>>6&63))&255],P=P>>>8^r[(P^(128|W&63))&255]);return~P}t.table=r,t.bstr=C,t.buf=T,t.str=R})}(LM)),LM}var M2e=N2e();const I2e=ua(M2e);var BM={},$9;function Kh(){return $9||($9=1,function(e){var t=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";function n(i,a){return Object.prototype.hasOwnProperty.call(i,a)}e.assign=function(i){for(var a=Array.prototype.slice.call(arguments,1);a.length;){var o=a.shift();if(o){if(typeof o!="object")throw new TypeError(o+"must be non-object");for(var l in o)n(o,l)&&(i[l]=o[l])}}return i},e.shrinkBuf=function(i,a){return i.length===a?i:i.subarray?i.subarray(0,a):(i.length=a,i)};var r={arraySet:function(i,a,o,l,c){if(a.subarray&&i.subarray){i.set(a.subarray(o,o+l),c);return}for(var u=0;u<l;u++)i[c+u]=a[o+u]},flattenChunks:function(i){var a,o,l,c,u,d;for(l=0,a=0,o=i.length;a<o;a++)l+=i[a].length;for(d=new Uint8Array(l),c=0,a=0,o=i.length;a<o;a++)u=i[a],d.set(u,c),c+=u.length;return d}},s={arraySet:function(i,a,o,l,c){for(var u=0;u<l;u++)i[c+u]=a[o+u]},flattenChunks:function(i){return[].concat.apply([],i)}};e.setTyped=function(i){i?(e.Buf8=Uint8Array,e.Buf16=Uint16Array,e.Buf32=Int32Array,e.assign(e,r)):(e.Buf8=Array,e.Buf16=Array,e.Buf32=Array,e.assign(e,s))},e.setTyped(t)}(BM)),BM}var Qg={},hc={},Bp={},z9;function j2e(){if(z9)return Bp;z9=1;var e=Kh(),t=4,n=0,r=1,s=2;function i(F){for(var X=F.length;--X>=0;)F[X]=0}var a=0,o=1,l=2,c=3,u=258,d=29,h=256,m=h+1+d,y=30,b=19,v=2*m+1,x=15,w=16,S=7,k=256,C=16,T=17,R=18,N=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],I=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],P=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],B=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],D=512,W=new Array((m+2)*2);i(W);var O=new Array(y*2);i(O);var Z=new Array(D);i(Z);var U=new Array(u-c+1);i(U);var H=new Array(d);i(H);var L=new Array(y);i(L);function te(F,X,be,ke,ge){this.static_tree=F,this.extra_bits=X,this.extra_base=be,this.elems=ke,this.max_length=ge,this.has_stree=F&&F.length}var V,Q,ee;function se(F,X){this.dyn_tree=F,this.max_code=0,this.stat_desc=X}function pe(F){return F<256?Z[F]:Z[256+(F>>>7)]}function ue(F,X){F.pending_buf[F.pending++]=X&255,F.pending_buf[F.pending++]=X>>>8&255}function Oe(F,X,be){F.bi_valid>w-be?(F.bi_buf|=X<<F.bi_valid&65535,ue(F,F.bi_buf),F.bi_buf=X>>w-F.bi_valid,F.bi_valid+=be-w):(F.bi_buf|=X<<F.bi_valid&65535,F.bi_valid+=be)}function Fe(F,X,be){Oe(F,be[X*2],be[X*2+1])}function Se(F,X){var be=0;do be|=F&1,F>>>=1,be<<=1;while(--X>0);return be>>>1}function Ce(F){F.bi_valid===16?(ue(F,F.bi_buf),F.bi_buf=0,F.bi_valid=0):F.bi_valid>=8&&(F.pending_buf[F.pending++]=F.bi_buf&255,F.bi_buf>>=8,F.bi_valid-=8)}function qe(F,X){var be=X.dyn_tree,ke=X.max_code,ge=X.stat_desc.static_tree,Ee=X.stat_desc.has_stree,le=X.stat_desc.extra_bits,dt=X.stat_desc.extra_base,et=X.stat_desc.max_length,$,Ue,tt,ve,_e,$e,Ct=0;for(ve=0;ve<=x;ve++)F.bl_count[ve]=0;for(be[F.heap[F.heap_max]*2+1]=0,$=F.heap_max+1;$<v;$++)Ue=F.heap[$],ve=be[be[Ue*2+1]*2+1]+1,ve>et&&(ve=et,Ct++),be[Ue*2+1]=ve,!(Ue>ke)&&(F.bl_count[ve]++,_e=0,Ue>=dt&&(_e=le[Ue-dt]),$e=be[Ue*2],F.opt_len+=$e*(ve+_e),Ee&&(F.static_len+=$e*(ge[Ue*2+1]+_e)));if(Ct!==0){do{for(ve=et-1;F.bl_count[ve]===0;)ve--;F.bl_count[ve]--,F.bl_count[ve+1]+=2,F.bl_count[et]--,Ct-=2}while(Ct>0);for(ve=et;ve!==0;ve--)for(Ue=F.bl_count[ve];Ue!==0;)tt=F.heap[--$],!(tt>ke)&&(be[tt*2+1]!==ve&&(F.opt_len+=(ve-be[tt*2+1])*be[tt*2],be[tt*2+1]=ve),Ue--)}}function Qe(F,X,be){var ke=new Array(x+1),ge=0,Ee,le;for(Ee=1;Ee<=x;Ee++)ke[Ee]=ge=ge+be[Ee-1]<<1;for(le=0;le<=X;le++){var dt=F[le*2+1];dt!==0&&(F[le*2]=Se(ke[dt]++,dt))}}function We(){var F,X,be,ke,ge,Ee=new Array(x+1);for(be=0,ke=0;ke<d-1;ke++)for(H[ke]=be,F=0;F<1<<N[ke];F++)U[be++]=ke;for(U[be-1]=ke,ge=0,ke=0;ke<16;ke++)for(L[ke]=ge,F=0;F<1<<I[ke];F++)Z[ge++]=ke;for(ge>>=7;ke<y;ke++)for(L[ke]=ge<<7,F=0;F<1<<I[ke]-7;F++)Z[256+ge++]=ke;for(X=0;X<=x;X++)Ee[X]=0;for(F=0;F<=143;)W[F*2+1]=8,F++,Ee[8]++;for(;F<=255;)W[F*2+1]=9,F++,Ee[9]++;for(;F<=279;)W[F*2+1]=7,F++,Ee[7]++;for(;F<=287;)W[F*2+1]=8,F++,Ee[8]++;for(Qe(W,m+1,Ee),F=0;F<y;F++)O[F*2+1]=5,O[F*2]=Se(F,5);V=new te(W,N,h+1,m,x),Q=new te(O,I,0,y,x),ee=new te(new Array(0),P,0,b,S)}function Ie(F){var X;for(X=0;X<m;X++)F.dyn_ltree[X*2]=0;for(X=0;X<y;X++)F.dyn_dtree[X*2]=0;for(X=0;X<b;X++)F.bl_tree[X*2]=0;F.dyn_ltree[k*2]=1,F.opt_len=F.static_len=0,F.last_lit=F.matches=0}function K(F){F.bi_valid>8?ue(F,F.bi_buf):F.bi_valid>0&&(F.pending_buf[F.pending++]=F.bi_buf),F.bi_buf=0,F.bi_valid=0}function ye(F,X,be,ke){K(F),ue(F,be),ue(F,~be),e.arraySet(F.pending_buf,F.window,X,be,F.pending),F.pending+=be}function Ne(F,X,be,ke){var ge=X*2,Ee=be*2;return F[ge]<F[Ee]||F[ge]===F[Ee]&&ke[X]<=ke[be]}function ce(F,X,be){for(var ke=F.heap[be],ge=be<<1;ge<=F.heap_len&&(ge<F.heap_len&&Ne(X,F.heap[ge+1],F.heap[ge],F.depth)&&ge++,!Ne(X,ke,F.heap[ge],F.depth));)F.heap[be]=F.heap[ge],be=ge,ge<<=1;F.heap[be]=ke}function oe(F,X,be){var ke,ge,Ee=0,le,dt;if(F.last_lit!==0)do ke=F.pending_buf[F.d_buf+Ee*2]<<8|F.pending_buf[F.d_buf+Ee*2+1],ge=F.pending_buf[F.l_buf+Ee],Ee++,ke===0?Fe(F,ge,X):(le=U[ge],Fe(F,le+h+1,X),dt=N[le],dt!==0&&(ge-=H[le],Oe(F,ge,dt)),ke--,le=pe(ke),Fe(F,le,be),dt=I[le],dt!==0&&(ke-=L[le],Oe(F,ke,dt)));while(Ee<F.last_lit);Fe(F,k,X)}function re(F,X){var be=X.dyn_tree,ke=X.stat_desc.static_tree,ge=X.stat_desc.has_stree,Ee=X.stat_desc.elems,le,dt,et=-1,$;for(F.heap_len=0,F.heap_max=v,le=0;le<Ee;le++)be[le*2]!==0?(F.heap[++F.heap_len]=et=le,F.depth[le]=0):be[le*2+1]=0;for(;F.heap_len<2;)$=F.heap[++F.heap_len]=et<2?++et:0,be[$*2]=1,F.depth[$]=0,F.opt_len--,ge&&(F.static_len-=ke[$*2+1]);for(X.max_code=et,le=F.heap_len>>1;le>=1;le--)ce(F,be,le);$=Ee;do le=F.heap[1],F.heap[1]=F.heap[F.heap_len--],ce(F,be,1),dt=F.heap[1],F.heap[--F.heap_max]=le,F.heap[--F.heap_max]=dt,be[$*2]=be[le*2]+be[dt*2],F.depth[$]=(F.depth[le]>=F.depth[dt]?F.depth[le]:F.depth[dt])+1,be[le*2+1]=be[dt*2+1]=$,F.heap[1]=$++,ce(F,be,1);while(F.heap_len>=2);F.heap[--F.heap_max]=F.heap[1],qe(F,X),Qe(be,et,F.bl_count)}function Re(F,X,be){var ke,ge=-1,Ee,le=X[0*2+1],dt=0,et=7,$=4;for(le===0&&(et=138,$=3),X[(be+1)*2+1]=65535,ke=0;ke<=be;ke++)Ee=le,le=X[(ke+1)*2+1],!(++dt<et&&Ee===le)&&(dt<$?F.bl_tree[Ee*2]+=dt:Ee!==0?(Ee!==ge&&F.bl_tree[Ee*2]++,F.bl_tree[C*2]++):dt<=10?F.bl_tree[T*2]++:F.bl_tree[R*2]++,dt=0,ge=Ee,le===0?(et=138,$=3):Ee===le?(et=6,$=3):(et=7,$=4))}function Be(F,X,be){var ke,ge=-1,Ee,le=X[0*2+1],dt=0,et=7,$=4;for(le===0&&(et=138,$=3),ke=0;ke<=be;ke++)if(Ee=le,le=X[(ke+1)*2+1],!(++dt<et&&Ee===le)){if(dt<$)do Fe(F,Ee,F.bl_tree);while(--dt!==0);else Ee!==0?(Ee!==ge&&(Fe(F,Ee,F.bl_tree),dt--),Fe(F,C,F.bl_tree),Oe(F,dt-3,2)):dt<=10?(Fe(F,T,F.bl_tree),Oe(F,dt-3,3)):(Fe(F,R,F.bl_tree),Oe(F,dt-11,7));dt=0,ge=Ee,le===0?(et=138,$=3):Ee===le?(et=6,$=3):(et=7,$=4)}}function Te(F){var X;for(Re(F,F.dyn_ltree,F.l_desc.max_code),Re(F,F.dyn_dtree,F.d_desc.max_code),re(F,F.bl_desc),X=b-1;X>=3&&F.bl_tree[B[X]*2+1]===0;X--);return F.opt_len+=3*(X+1)+5+5+4,X}function lt(F,X,be,ke){var ge;for(Oe(F,X-257,5),Oe(F,be-1,5),Oe(F,ke-4,4),ge=0;ge<ke;ge++)Oe(F,F.bl_tree[B[ge]*2+1],3);Be(F,F.dyn_ltree,X-1),Be(F,F.dyn_dtree,be-1)}function Tt(F){var X=4093624447,be;for(be=0;be<=31;be++,X>>>=1)if(X&1&&F.dyn_ltree[be*2]!==0)return n;if(F.dyn_ltree[9*2]!==0||F.dyn_ltree[10*2]!==0||F.dyn_ltree[13*2]!==0)return r;for(be=32;be<h;be++)if(F.dyn_ltree[be*2]!==0)return r;return n}var ut=!1;function jt(F){ut||(We(),ut=!0),F.l_desc=new se(F.dyn_ltree,V),F.d_desc=new se(F.dyn_dtree,Q),F.bl_desc=new se(F.bl_tree,ee),F.bi_buf=0,F.bi_valid=0,Ie(F)}function qt(F,X,be,ke){Oe(F,(a<<1)+(ke?1:0),3),ye(F,X,be)}function Ft(F){Oe(F,o<<1,3),Fe(F,k,W),Ce(F)}function Ht(F,X,be,ke){var ge,Ee,le=0;F.level>0?(F.strm.data_type===s&&(F.strm.data_type=Tt(F)),re(F,F.l_desc),re(F,F.d_desc),le=Te(F),ge=F.opt_len+3+7>>>3,Ee=F.static_len+3+7>>>3,Ee<=ge&&(ge=Ee)):ge=Ee=be+5,be+4<=ge&&X!==-1?qt(F,X,be,ke):F.strategy===t||Ee===ge?(Oe(F,(o<<1)+(ke?1:0),3),oe(F,W,O)):(Oe(F,(l<<1)+(ke?1:0),3),lt(F,F.l_desc.max_code+1,F.d_desc.max_code+1,le+1),oe(F,F.dyn_ltree,F.dyn_dtree)),Ie(F),ke&&K(F)}function we(F,X,be){return F.pending_buf[F.d_buf+F.last_lit*2]=X>>>8&255,F.pending_buf[F.d_buf+F.last_lit*2+1]=X&255,F.pending_buf[F.l_buf+F.last_lit]=be&255,F.last_lit++,X===0?F.dyn_ltree[be*2]++:(F.matches++,X--,F.dyn_ltree[(U[be]+h+1)*2]++,F.dyn_dtree[pe(X)*2]++),F.last_lit===F.lit_bufsize-1}return Bp._tr_init=jt,Bp._tr_stored_block=qt,Bp._tr_flush_block=Ht,Bp._tr_tally=we,Bp._tr_align=Ft,Bp}var $M,U9;function MY(){if(U9)return $M;U9=1;function e(t,n,r,s){for(var i=t&65535|0,a=t>>>16&65535|0,o=0;r!==0;){o=r>2e3?2e3:r,r-=o;do i=i+n[s++]|0,a=a+i|0;while(--o);i%=65521,a%=65521}return i|a<<16|0}return $M=e,$M}var zM,q9;function IY(){if(q9)return zM;q9=1;function e(){for(var r,s=[],i=0;i<256;i++){r=i;for(var a=0;a<8;a++)r=r&1?3988292384^r>>>1:r>>>1;s[i]=r}return s}var t=e();function n(r,s,i,a){var o=t,l=a+i;r^=-1;for(var c=a;c<l;c++)r=r>>>8^o[(r^s[c])&255];return r^-1}return zM=n,zM}var UM,V9;function cD(){return V9||(V9=1,UM={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}),UM}var W9;function O2e(){if(W9)return hc;W9=1;var e=Kh(),t=j2e(),n=MY(),r=IY(),s=cD(),i=0,a=1,o=3,l=4,c=5,u=0,d=1,h=-2,m=-3,y=-5,b=-1,v=1,x=2,w=3,S=4,k=0,C=2,T=8,R=9,N=15,I=8,P=29,B=256,D=B+1+P,W=30,O=19,Z=2*D+1,U=15,H=3,L=258,te=L+H+1,V=32,Q=42,ee=69,se=73,pe=91,ue=103,Oe=113,Fe=666,Se=1,Ce=2,qe=3,Qe=4,We=3;function Ie($,Ue){return $.msg=s[Ue],Ue}function K($){return($<<1)-($>4?9:0)}function ye($){for(var Ue=$.length;--Ue>=0;)$[Ue]=0}function Ne($){var Ue=$.state,tt=Ue.pending;tt>$.avail_out&&(tt=$.avail_out),tt!==0&&(e.arraySet($.output,Ue.pending_buf,Ue.pending_out,tt,$.next_out),$.next_out+=tt,Ue.pending_out+=tt,$.total_out+=tt,$.avail_out-=tt,Ue.pending-=tt,Ue.pending===0&&(Ue.pending_out=0))}function ce($,Ue){t._tr_flush_block($,$.block_start>=0?$.block_start:-1,$.strstart-$.block_start,Ue),$.block_start=$.strstart,Ne($.strm)}function oe($,Ue){$.pending_buf[$.pending++]=Ue}function re($,Ue){$.pending_buf[$.pending++]=Ue>>>8&255,$.pending_buf[$.pending++]=Ue&255}function Re($,Ue,tt,ve){var _e=$.avail_in;return _e>ve&&(_e=ve),_e===0?0:($.avail_in-=_e,e.arraySet(Ue,$.input,$.next_in,_e,tt),$.state.wrap===1?$.adler=n($.adler,Ue,_e,tt):$.state.wrap===2&&($.adler=r($.adler,Ue,_e,tt)),$.next_in+=_e,$.total_in+=_e,_e)}function Be($,Ue){var tt=$.max_chain_length,ve=$.strstart,_e,$e,Ct=$.prev_length,fe=$.nice_match,Y=$.strstart>$.w_size-te?$.strstart-($.w_size-te):0,G=$.window,J=$.w_mask,xe=$.prev,De=$.strstart+L,He=G[ve+Ct-1],xt=G[ve+Ct];$.prev_length>=$.good_match&&(tt>>=2),fe>$.lookahead&&(fe=$.lookahead);do if(_e=Ue,!(G[_e+Ct]!==xt||G[_e+Ct-1]!==He||G[_e]!==G[ve]||G[++_e]!==G[ve+1])){ve+=2,_e++;do;while(G[++ve]===G[++_e]&&G[++ve]===G[++_e]&&G[++ve]===G[++_e]&&G[++ve]===G[++_e]&&G[++ve]===G[++_e]&&G[++ve]===G[++_e]&&G[++ve]===G[++_e]&&G[++ve]===G[++_e]&&ve<De);if($e=L-(De-ve),ve=De-L,$e>Ct){if($.match_start=Ue,Ct=$e,$e>=fe)break;He=G[ve+Ct-1],xt=G[ve+Ct]}}while((Ue=xe[Ue&J])>Y&&--tt!==0);return Ct<=$.lookahead?Ct:$.lookahead}function Te($){var Ue=$.w_size,tt,ve,_e,$e,Ct;do{if($e=$.window_size-$.lookahead-$.strstart,$.strstart>=Ue+(Ue-te)){e.arraySet($.window,$.window,Ue,Ue,0),$.match_start-=Ue,$.strstart-=Ue,$.block_start-=Ue,ve=$.hash_size,tt=ve;do _e=$.head[--tt],$.head[tt]=_e>=Ue?_e-Ue:0;while(--ve);ve=Ue,tt=ve;do _e=$.prev[--tt],$.prev[tt]=_e>=Ue?_e-Ue:0;while(--ve);$e+=Ue}if($.strm.avail_in===0)break;if(ve=Re($.strm,$.window,$.strstart+$.lookahead,$e),$.lookahead+=ve,$.lookahead+$.insert>=H)for(Ct=$.strstart-$.insert,$.ins_h=$.window[Ct],$.ins_h=($.ins_h<<$.hash_shift^$.window[Ct+1])&$.hash_mask;$.insert&&($.ins_h=($.ins_h<<$.hash_shift^$.window[Ct+H-1])&$.hash_mask,$.prev[Ct&$.w_mask]=$.head[$.ins_h],$.head[$.ins_h]=Ct,Ct++,$.insert--,!($.lookahead+$.insert<H)););}while($.lookahead<te&&$.strm.avail_in!==0)}function lt($,Ue){var tt=65535;for(tt>$.pending_buf_size-5&&(tt=$.pending_buf_size-5);;){if($.lookahead<=1){if(Te($),$.lookahead===0&&Ue===i)return Se;if($.lookahead===0)break}$.strstart+=$.lookahead,$.lookahead=0;var ve=$.block_start+tt;if(($.strstart===0||$.strstart>=ve)&&($.lookahead=$.strstart-ve,$.strstart=ve,ce($,!1),$.strm.avail_out===0)||$.strstart-$.block_start>=$.w_size-te&&(ce($,!1),$.strm.avail_out===0))return Se}return $.insert=0,Ue===l?(ce($,!0),$.strm.avail_out===0?qe:Qe):($.strstart>$.block_start&&(ce($,!1),$.strm.avail_out===0),Se)}function Tt($,Ue){for(var tt,ve;;){if($.lookahead<te){if(Te($),$.lookahead<te&&Ue===i)return Se;if($.lookahead===0)break}if(tt=0,$.lookahead>=H&&($.ins_h=($.ins_h<<$.hash_shift^$.window[$.strstart+H-1])&$.hash_mask,tt=$.prev[$.strstart&$.w_mask]=$.head[$.ins_h],$.head[$.ins_h]=$.strstart),tt!==0&&$.strstart-tt<=$.w_size-te&&($.match_length=Be($,tt)),$.match_length>=H)if(ve=t._tr_tally($,$.strstart-$.match_start,$.match_length-H),$.lookahead-=$.match_length,$.match_length<=$.max_lazy_match&&$.lookahead>=H){$.match_length--;do $.strstart++,$.ins_h=($.ins_h<<$.hash_shift^$.window[$.strstart+H-1])&$.hash_mask,tt=$.prev[$.strstart&$.w_mask]=$.head[$.ins_h],$.head[$.ins_h]=$.strstart;while(--$.match_length!==0);$.strstart++}else $.strstart+=$.match_length,$.match_length=0,$.ins_h=$.window[$.strstart],$.ins_h=($.ins_h<<$.hash_shift^$.window[$.strstart+1])&$.hash_mask;else ve=t._tr_tally($,0,$.window[$.strstart]),$.lookahead--,$.strstart++;if(ve&&(ce($,!1),$.strm.avail_out===0))return Se}return $.insert=$.strstart<H-1?$.strstart:H-1,Ue===l?(ce($,!0),$.strm.avail_out===0?qe:Qe):$.last_lit&&(ce($,!1),$.strm.avail_out===0)?Se:Ce}function ut($,Ue){for(var tt,ve,_e;;){if($.lookahead<te){if(Te($),$.lookahead<te&&Ue===i)return Se;if($.lookahead===0)break}if(tt=0,$.lookahead>=H&&($.ins_h=($.ins_h<<$.hash_shift^$.window[$.strstart+H-1])&$.hash_mask,tt=$.prev[$.strstart&$.w_mask]=$.head[$.ins_h],$.head[$.ins_h]=$.strstart),$.prev_length=$.match_length,$.prev_match=$.match_start,$.match_length=H-1,tt!==0&&$.prev_length<$.max_lazy_match&&$.strstart-tt<=$.w_size-te&&($.match_length=Be($,tt),$.match_length<=5&&($.strategy===v||$.match_length===H&&$.strstart-$.match_start>4096)&&($.match_length=H-1)),$.prev_length>=H&&$.match_length<=$.prev_length){_e=$.strstart+$.lookahead-H,ve=t._tr_tally($,$.strstart-1-$.prev_match,$.prev_length-H),$.lookahead-=$.prev_length-1,$.prev_length-=2;do++$.strstart<=_e&&($.ins_h=($.ins_h<<$.hash_shift^$.window[$.strstart+H-1])&$.hash_mask,tt=$.prev[$.strstart&$.w_mask]=$.head[$.ins_h],$.head[$.ins_h]=$.strstart);while(--$.prev_length!==0);if($.match_available=0,$.match_length=H-1,$.strstart++,ve&&(ce($,!1),$.strm.avail_out===0))return Se}else if($.match_available){if(ve=t._tr_tally($,0,$.window[$.strstart-1]),ve&&ce($,!1),$.strstart++,$.lookahead--,$.strm.avail_out===0)return Se}else $.match_available=1,$.strstart++,$.lookahead--}return $.match_available&&(ve=t._tr_tally($,0,$.window[$.strstart-1]),$.match_available=0),$.insert=$.strstart<H-1?$.strstart:H-1,Ue===l?(ce($,!0),$.strm.avail_out===0?qe:Qe):$.last_lit&&(ce($,!1),$.strm.avail_out===0)?Se:Ce}function jt($,Ue){for(var tt,ve,_e,$e,Ct=$.window;;){if($.lookahead<=L){if(Te($),$.lookahead<=L&&Ue===i)return Se;if($.lookahead===0)break}if($.match_length=0,$.lookahead>=H&&$.strstart>0&&(_e=$.strstart-1,ve=Ct[_e],ve===Ct[++_e]&&ve===Ct[++_e]&&ve===Ct[++_e])){$e=$.strstart+L;do;while(ve===Ct[++_e]&&ve===Ct[++_e]&&ve===Ct[++_e]&&ve===Ct[++_e]&&ve===Ct[++_e]&&ve===Ct[++_e]&&ve===Ct[++_e]&&ve===Ct[++_e]&&_e<$e);$.match_length=L-($e-_e),$.match_length>$.lookahead&&($.match_length=$.lookahead)}if($.match_length>=H?(tt=t._tr_tally($,1,$.match_length-H),$.lookahead-=$.match_length,$.strstart+=$.match_length,$.match_length=0):(tt=t._tr_tally($,0,$.window[$.strstart]),$.lookahead--,$.strstart++),tt&&(ce($,!1),$.strm.avail_out===0))return Se}return $.insert=0,Ue===l?(ce($,!0),$.strm.avail_out===0?qe:Qe):$.last_lit&&(ce($,!1),$.strm.avail_out===0)?Se:Ce}function qt($,Ue){for(var tt;;){if($.lookahead===0&&(Te($),$.lookahead===0)){if(Ue===i)return Se;break}if($.match_length=0,tt=t._tr_tally($,0,$.window[$.strstart]),$.lookahead--,$.strstart++,tt&&(ce($,!1),$.strm.avail_out===0))return Se}return $.insert=0,Ue===l?(ce($,!0),$.strm.avail_out===0?qe:Qe):$.last_lit&&(ce($,!1),$.strm.avail_out===0)?Se:Ce}function Ft($,Ue,tt,ve,_e){this.good_length=$,this.max_lazy=Ue,this.nice_length=tt,this.max_chain=ve,this.func=_e}var Ht;Ht=[new Ft(0,0,0,0,lt),new Ft(4,4,8,4,Tt),new Ft(4,5,16,8,Tt),new Ft(4,6,32,32,Tt),new Ft(4,4,16,16,ut),new Ft(8,16,32,32,ut),new Ft(8,16,128,128,ut),new Ft(8,32,128,256,ut),new Ft(32,128,258,1024,ut),new Ft(32,258,258,4096,ut)];function we($){$.window_size=2*$.w_size,ye($.head),$.max_lazy_match=Ht[$.level].max_lazy,$.good_match=Ht[$.level].good_length,$.nice_match=Ht[$.level].nice_length,$.max_chain_length=Ht[$.level].max_chain,$.strstart=0,$.block_start=0,$.lookahead=0,$.insert=0,$.match_length=$.prev_length=H-1,$.match_available=0,$.ins_h=0}function F(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=T,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new e.Buf16(Z*2),this.dyn_dtree=new e.Buf16((2*W+1)*2),this.bl_tree=new e.Buf16((2*O+1)*2),ye(this.dyn_ltree),ye(this.dyn_dtree),ye(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new e.Buf16(U+1),this.heap=new e.Buf16(2*D+1),ye(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new e.Buf16(2*D+1),ye(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function X($){var Ue;return!$||!$.state?Ie($,h):($.total_in=$.total_out=0,$.data_type=C,Ue=$.state,Ue.pending=0,Ue.pending_out=0,Ue.wrap<0&&(Ue.wrap=-Ue.wrap),Ue.status=Ue.wrap?Q:Oe,$.adler=Ue.wrap===2?0:1,Ue.last_flush=i,t._tr_init(Ue),u)}function be($){var Ue=X($);return Ue===u&&we($.state),Ue}function ke($,Ue){return!$||!$.state||$.state.wrap!==2?h:($.state.gzhead=Ue,u)}function ge($,Ue,tt,ve,_e,$e){if(!$)return h;var Ct=1;if(Ue===b&&(Ue=6),ve<0?(Ct=0,ve=-ve):ve>15&&(Ct=2,ve-=16),_e<1||_e>R||tt!==T||ve<8||ve>15||Ue<0||Ue>9||$e<0||$e>S)return Ie($,h);ve===8&&(ve=9);var fe=new F;return $.state=fe,fe.strm=$,fe.wrap=Ct,fe.gzhead=null,fe.w_bits=ve,fe.w_size=1<<fe.w_bits,fe.w_mask=fe.w_size-1,fe.hash_bits=_e+7,fe.hash_size=1<<fe.hash_bits,fe.hash_mask=fe.hash_size-1,fe.hash_shift=~~((fe.hash_bits+H-1)/H),fe.window=new e.Buf8(fe.w_size*2),fe.head=new e.Buf16(fe.hash_size),fe.prev=new e.Buf16(fe.w_size),fe.lit_bufsize=1<<_e+6,fe.pending_buf_size=fe.lit_bufsize*4,fe.pending_buf=new e.Buf8(fe.pending_buf_size),fe.d_buf=1*fe.lit_bufsize,fe.l_buf=3*fe.lit_bufsize,fe.level=Ue,fe.strategy=$e,fe.method=tt,be($)}function Ee($,Ue){return ge($,Ue,T,N,I,k)}function le($,Ue){var tt,ve,_e,$e;if(!$||!$.state||Ue>c||Ue<0)return $?Ie($,h):h;if(ve=$.state,!$.output||!$.input&&$.avail_in!==0||ve.status===Fe&&Ue!==l)return Ie($,$.avail_out===0?y:h);if(ve.strm=$,tt=ve.last_flush,ve.last_flush=Ue,ve.status===Q)if(ve.wrap===2)$.adler=0,oe(ve,31),oe(ve,139),oe(ve,8),ve.gzhead?(oe(ve,(ve.gzhead.text?1:0)+(ve.gzhead.hcrc?2:0)+(ve.gzhead.extra?4:0)+(ve.gzhead.name?8:0)+(ve.gzhead.comment?16:0)),oe(ve,ve.gzhead.time&255),oe(ve,ve.gzhead.time>>8&255),oe(ve,ve.gzhead.time>>16&255),oe(ve,ve.gzhead.time>>24&255),oe(ve,ve.level===9?2:ve.strategy>=x||ve.level<2?4:0),oe(ve,ve.gzhead.os&255),ve.gzhead.extra&&ve.gzhead.extra.length&&(oe(ve,ve.gzhead.extra.length&255),oe(ve,ve.gzhead.extra.length>>8&255)),ve.gzhead.hcrc&&($.adler=r($.adler,ve.pending_buf,ve.pending,0)),ve.gzindex=0,ve.status=ee):(oe(ve,0),oe(ve,0),oe(ve,0),oe(ve,0),oe(ve,0),oe(ve,ve.level===9?2:ve.strategy>=x||ve.level<2?4:0),oe(ve,We),ve.status=Oe);else{var Ct=T+(ve.w_bits-8<<4)<<8,fe=-1;ve.strategy>=x||ve.level<2?fe=0:ve.level<6?fe=1:ve.level===6?fe=2:fe=3,Ct|=fe<<6,ve.strstart!==0&&(Ct|=V),Ct+=31-Ct%31,ve.status=Oe,re(ve,Ct),ve.strstart!==0&&(re(ve,$.adler>>>16),re(ve,$.adler&65535)),$.adler=1}if(ve.status===ee)if(ve.gzhead.extra){for(_e=ve.pending;ve.gzindex<(ve.gzhead.extra.length&65535)&&!(ve.pending===ve.pending_buf_size&&(ve.gzhead.hcrc&&ve.pending>_e&&($.adler=r($.adler,ve.pending_buf,ve.pending-_e,_e)),Ne($),_e=ve.pending,ve.pending===ve.pending_buf_size));)oe(ve,ve.gzhead.extra[ve.gzindex]&255),ve.gzindex++;ve.gzhead.hcrc&&ve.pending>_e&&($.adler=r($.adler,ve.pending_buf,ve.pending-_e,_e)),ve.gzindex===ve.gzhead.extra.length&&(ve.gzindex=0,ve.status=se)}else ve.status=se;if(ve.status===se)if(ve.gzhead.name){_e=ve.pending;do{if(ve.pending===ve.pending_buf_size&&(ve.gzhead.hcrc&&ve.pending>_e&&($.adler=r($.adler,ve.pending_buf,ve.pending-_e,_e)),Ne($),_e=ve.pending,ve.pending===ve.pending_buf_size)){$e=1;break}ve.gzindex<ve.gzhead.name.length?$e=ve.gzhead.name.charCodeAt(ve.gzindex++)&255:$e=0,oe(ve,$e)}while($e!==0);ve.gzhead.hcrc&&ve.pending>_e&&($.adler=r($.adler,ve.pending_buf,ve.pending-_e,_e)),$e===0&&(ve.gzindex=0,ve.status=pe)}else ve.status=pe;if(ve.status===pe)if(ve.gzhead.comment){_e=ve.pending;do{if(ve.pending===ve.pending_buf_size&&(ve.gzhead.hcrc&&ve.pending>_e&&($.adler=r($.adler,ve.pending_buf,ve.pending-_e,_e)),Ne($),_e=ve.pending,ve.pending===ve.pending_buf_size)){$e=1;break}ve.gzindex<ve.gzhead.comment.length?$e=ve.gzhead.comment.charCodeAt(ve.gzindex++)&255:$e=0,oe(ve,$e)}while($e!==0);ve.gzhead.hcrc&&ve.pending>_e&&($.adler=r($.adler,ve.pending_buf,ve.pending-_e,_e)),$e===0&&(ve.status=ue)}else ve.status=ue;if(ve.status===ue&&(ve.gzhead.hcrc?(ve.pending+2>ve.pending_buf_size&&Ne($),ve.pending+2<=ve.pending_buf_size&&(oe(ve,$.adler&255),oe(ve,$.adler>>8&255),$.adler=0,ve.status=Oe)):ve.status=Oe),ve.pending!==0){if(Ne($),$.avail_out===0)return ve.last_flush=-1,u}else if($.avail_in===0&&K(Ue)<=K(tt)&&Ue!==l)return Ie($,y);if(ve.status===Fe&&$.avail_in!==0)return Ie($,y);if($.avail_in!==0||ve.lookahead!==0||Ue!==i&&ve.status!==Fe){var Y=ve.strategy===x?qt(ve,Ue):ve.strategy===w?jt(ve,Ue):Ht[ve.level].func(ve,Ue);if((Y===qe||Y===Qe)&&(ve.status=Fe),Y===Se||Y===qe)return $.avail_out===0&&(ve.last_flush=-1),u;if(Y===Ce&&(Ue===a?t._tr_align(ve):Ue!==c&&(t._tr_stored_block(ve,0,0,!1),Ue===o&&(ye(ve.head),ve.lookahead===0&&(ve.strstart=0,ve.block_start=0,ve.insert=0))),Ne($),$.avail_out===0))return ve.last_flush=-1,u}return Ue!==l?u:ve.wrap<=0?d:(ve.wrap===2?(oe(ve,$.adler&255),oe(ve,$.adler>>8&255),oe(ve,$.adler>>16&255),oe(ve,$.adler>>24&255),oe(ve,$.total_in&255),oe(ve,$.total_in>>8&255),oe(ve,$.total_in>>16&255),oe(ve,$.total_in>>24&255)):(re(ve,$.adler>>>16),re(ve,$.adler&65535)),Ne($),ve.wrap>0&&(ve.wrap=-ve.wrap),ve.pending!==0?u:d)}function dt($){var Ue;return!$||!$.state?h:(Ue=$.state.status,Ue!==Q&&Ue!==ee&&Ue!==se&&Ue!==pe&&Ue!==ue&&Ue!==Oe&&Ue!==Fe?Ie($,h):($.state=null,Ue===Oe?Ie($,m):u))}function et($,Ue){var tt=Ue.length,ve,_e,$e,Ct,fe,Y,G,J;if(!$||!$.state||(ve=$.state,Ct=ve.wrap,Ct===2||Ct===1&&ve.status!==Q||ve.lookahead))return h;for(Ct===1&&($.adler=n($.adler,Ue,tt,0)),ve.wrap=0,tt>=ve.w_size&&(Ct===0&&(ye(ve.head),ve.strstart=0,ve.block_start=0,ve.insert=0),J=new e.Buf8(ve.w_size),e.arraySet(J,Ue,tt-ve.w_size,ve.w_size,0),Ue=J,tt=ve.w_size),fe=$.avail_in,Y=$.next_in,G=$.input,$.avail_in=tt,$.next_in=0,$.input=Ue,Te(ve);ve.lookahead>=H;){_e=ve.strstart,$e=ve.lookahead-(H-1);do ve.ins_h=(ve.ins_h<<ve.hash_shift^ve.window[_e+H-1])&ve.hash_mask,ve.prev[_e&ve.w_mask]=ve.head[ve.ins_h],ve.head[ve.ins_h]=_e,_e++;while(--$e);ve.strstart=_e,ve.lookahead=H-1,Te(ve)}return ve.strstart+=ve.lookahead,ve.block_start=ve.strstart,ve.insert=ve.lookahead,ve.lookahead=0,ve.match_length=ve.prev_length=H-1,ve.match_available=0,$.next_in=Y,$.input=G,$.avail_in=fe,ve.wrap=Ct,u}return hc.deflateInit=Ee,hc.deflateInit2=ge,hc.deflateReset=be,hc.deflateResetKeep=X,hc.deflateSetHeader=ke,hc.deflate=le,hc.deflateEnd=dt,hc.deflateSetDictionary=et,hc.deflateInfo="pako deflate (from Nodeca project)",hc}var $p={},H9;function jY(){if(H9)return $p;H9=1;var e=Kh(),t=!0,n=!0;try{String.fromCharCode.apply(null,[0])}catch{t=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{n=!1}for(var r=new e.Buf8(256),s=0;s<256;s++)r[s]=s>=252?6:s>=248?5:s>=240?4:s>=224?3:s>=192?2:1;r[254]=r[254]=1,$p.string2buf=function(a){var o,l,c,u,d,h=a.length,m=0;for(u=0;u<h;u++)l=a.charCodeAt(u),(l&64512)===55296&&u+1<h&&(c=a.charCodeAt(u+1),(c&64512)===56320&&(l=65536+(l-55296<<10)+(c-56320),u++)),m+=l<128?1:l<2048?2:l<65536?3:4;for(o=new e.Buf8(m),d=0,u=0;d<m;u++)l=a.charCodeAt(u),(l&64512)===55296&&u+1<h&&(c=a.charCodeAt(u+1),(c&64512)===56320&&(l=65536+(l-55296<<10)+(c-56320),u++)),l<128?o[d++]=l:l<2048?(o[d++]=192|l>>>6,o[d++]=128|l&63):l<65536?(o[d++]=224|l>>>12,o[d++]=128|l>>>6&63,o[d++]=128|l&63):(o[d++]=240|l>>>18,o[d++]=128|l>>>12&63,o[d++]=128|l>>>6&63,o[d++]=128|l&63);return o};function i(a,o){if(o<65534&&(a.subarray&&n||!a.subarray&&t))return String.fromCharCode.apply(null,e.shrinkBuf(a,o));for(var l="",c=0;c<o;c++)l+=String.fromCharCode(a[c]);return l}return $p.buf2binstring=function(a){return i(a,a.length)},$p.binstring2buf=function(a){for(var o=new e.Buf8(a.length),l=0,c=o.length;l<c;l++)o[l]=a.charCodeAt(l);return o},$p.buf2string=function(a,o){var l,c,u,d,h=o||a.length,m=new Array(h*2);for(c=0,l=0;l<h;){if(u=a[l++],u<128){m[c++]=u;continue}if(d=r[u],d>4){m[c++]=65533,l+=d-1;continue}for(u&=d===2?31:d===3?15:7;d>1&&l<h;)u=u<<6|a[l++]&63,d--;if(d>1){m[c++]=65533;continue}u<65536?m[c++]=u:(u-=65536,m[c++]=55296|u>>10&1023,m[c++]=56320|u&1023)}return i(m,c)},$p.utf8border=function(a,o){var l;for(o=o||a.length,o>a.length&&(o=a.length),l=o-1;l>=0&&(a[l]&192)===128;)l--;return l<0||l===0?o:l+r[a[l]]>o?l:o},$p}var qM,G9;function OY(){if(G9)return qM;G9=1;function e(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}return qM=e,qM}var K9;function P2e(){if(K9)return Qg;K9=1;var e=O2e(),t=Kh(),n=jY(),r=cD(),s=OY(),i=Object.prototype.toString,a=0,o=4,l=0,c=1,u=2,d=-1,h=0,m=8;function y(w){if(!(this instanceof y))return new y(w);this.options=t.assign({level:d,method:m,chunkSize:16384,windowBits:15,memLevel:8,strategy:h,to:""},w||{});var S=this.options;S.raw&&S.windowBits>0?S.windowBits=-S.windowBits:S.gzip&&S.windowBits>0&&S.windowBits<16&&(S.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new s,this.strm.avail_out=0;var k=e.deflateInit2(this.strm,S.level,S.method,S.windowBits,S.memLevel,S.strategy);if(k!==l)throw new Error(r[k]);if(S.header&&e.deflateSetHeader(this.strm,S.header),S.dictionary){var C;if(typeof S.dictionary=="string"?C=n.string2buf(S.dictionary):i.call(S.dictionary)==="[object ArrayBuffer]"?C=new Uint8Array(S.dictionary):C=S.dictionary,k=e.deflateSetDictionary(this.strm,C),k!==l)throw new Error(r[k]);this._dict_set=!0}}y.prototype.push=function(w,S){var k=this.strm,C=this.options.chunkSize,T,R;if(this.ended)return!1;R=S===~~S?S:S===!0?o:a,typeof w=="string"?k.input=n.string2buf(w):i.call(w)==="[object ArrayBuffer]"?k.input=new Uint8Array(w):k.input=w,k.next_in=0,k.avail_in=k.input.length;do{if(k.avail_out===0&&(k.output=new t.Buf8(C),k.next_out=0,k.avail_out=C),T=e.deflate(k,R),T!==c&&T!==l)return this.onEnd(T),this.ended=!0,!1;(k.avail_out===0||k.avail_in===0&&(R===o||R===u))&&(this.options.to==="string"?this.onData(n.buf2binstring(t.shrinkBuf(k.output,k.next_out))):this.onData(t.shrinkBuf(k.output,k.next_out)))}while((k.avail_in>0||k.avail_out===0)&&T!==c);return R===o?(T=e.deflateEnd(this.strm),this.onEnd(T),this.ended=!0,T===l):(R===u&&(this.onEnd(l),k.avail_out=0),!0)},y.prototype.onData=function(w){this.chunks.push(w)},y.prototype.onEnd=function(w){w===l&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=t.flattenChunks(this.chunks)),this.chunks=[],this.err=w,this.msg=this.strm.msg};function b(w,S){var k=new y(S);if(k.push(w,!0),k.err)throw k.msg||r[k.err];return k.result}function v(w,S){return S=S||{},S.raw=!0,b(w,S)}function x(w,S){return S=S||{},S.gzip=!0,b(w,S)}return Qg.Deflate=y,Qg.deflate=b,Qg.deflateRaw=v,Qg.gzip=x,Qg}var e0={},jl={},VM,Y9;function D2e(){if(Y9)return VM;Y9=1;var e=30,t=12;return VM=function(r,s){var i,a,o,l,c,u,d,h,m,y,b,v,x,w,S,k,C,T,R,N,I,P,B,D,W;i=r.state,a=r.next_in,D=r.input,o=a+(r.avail_in-5),l=r.next_out,W=r.output,c=l-(s-r.avail_out),u=l+(r.avail_out-257),d=i.dmax,h=i.wsize,m=i.whave,y=i.wnext,b=i.window,v=i.hold,x=i.bits,w=i.lencode,S=i.distcode,k=(1<<i.lenbits)-1,C=(1<<i.distbits)-1;e:do{x<15&&(v+=D[a++]<<x,x+=8,v+=D[a++]<<x,x+=8),T=w[v&k];t:for(;;){if(R=T>>>24,v>>>=R,x-=R,R=T>>>16&255,R===0)W[l++]=T&65535;else if(R&16){N=T&65535,R&=15,R&&(x<R&&(v+=D[a++]<<x,x+=8),N+=v&(1<<R)-1,v>>>=R,x-=R),x<15&&(v+=D[a++]<<x,x+=8,v+=D[a++]<<x,x+=8),T=S[v&C];n:for(;;){if(R=T>>>24,v>>>=R,x-=R,R=T>>>16&255,R&16){if(I=T&65535,R&=15,x<R&&(v+=D[a++]<<x,x+=8,x<R&&(v+=D[a++]<<x,x+=8)),I+=v&(1<<R)-1,I>d){r.msg="invalid distance too far back",i.mode=e;break e}if(v>>>=R,x-=R,R=l-c,I>R){if(R=I-R,R>m&&i.sane){r.msg="invalid distance too far back",i.mode=e;break e}if(P=0,B=b,y===0){if(P+=h-R,R<N){N-=R;do W[l++]=b[P++];while(--R);P=l-I,B=W}}else if(y<R){if(P+=h+y-R,R-=y,R<N){N-=R;do W[l++]=b[P++];while(--R);if(P=0,y<N){R=y,N-=R;do W[l++]=b[P++];while(--R);P=l-I,B=W}}}else if(P+=y-R,R<N){N-=R;do W[l++]=b[P++];while(--R);P=l-I,B=W}for(;N>2;)W[l++]=B[P++],W[l++]=B[P++],W[l++]=B[P++],N-=3;N&&(W[l++]=B[P++],N>1&&(W[l++]=B[P++]))}else{P=l-I;do W[l++]=W[P++],W[l++]=W[P++],W[l++]=W[P++],N-=3;while(N>2);N&&(W[l++]=W[P++],N>1&&(W[l++]=W[P++]))}}else if((R&64)===0){T=S[(T&65535)+(v&(1<<R)-1)];continue n}else{r.msg="invalid distance code",i.mode=e;break e}break}}else if((R&64)===0){T=w[(T&65535)+(v&(1<<R)-1)];continue t}else if(R&32){i.mode=t;break e}else{r.msg="invalid literal/length code",i.mode=e;break e}break}}while(a<o&&l<u);N=x>>3,a-=N,x-=N<<3,v&=(1<<x)-1,r.next_in=a,r.next_out=l,r.avail_in=a<o?5+(o-a):5-(a-o),r.avail_out=l<u?257+(u-l):257-(l-u),i.hold=v,i.bits=x},VM}var WM,Z9;function F2e(){if(Z9)return WM;Z9=1;var e=Kh(),t=15,n=852,r=592,s=0,i=1,a=2,o=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],l=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],c=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],u=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];return WM=function(h,m,y,b,v,x,w,S){var k=S.bits,C=0,T=0,R=0,N=0,I=0,P=0,B=0,D=0,W=0,O=0,Z,U,H,L,te,V=null,Q=0,ee,se=new e.Buf16(t+1),pe=new e.Buf16(t+1),ue=null,Oe=0,Fe,Se,Ce;for(C=0;C<=t;C++)se[C]=0;for(T=0;T<b;T++)se[m[y+T]]++;for(I=k,N=t;N>=1&&se[N]===0;N--);if(I>N&&(I=N),N===0)return v[x++]=1<<24|64<<16|0,v[x++]=1<<24|64<<16|0,S.bits=1,0;for(R=1;R<N&&se[R]===0;R++);for(I<R&&(I=R),D=1,C=1;C<=t;C++)if(D<<=1,D-=se[C],D<0)return-1;if(D>0&&(h===s||N!==1))return-1;for(pe[1]=0,C=1;C<t;C++)pe[C+1]=pe[C]+se[C];for(T=0;T<b;T++)m[y+T]!==0&&(w[pe[m[y+T]]++]=T);if(h===s?(V=ue=w,ee=19):h===i?(V=o,Q-=257,ue=l,Oe-=257,ee=256):(V=c,ue=u,ee=-1),O=0,T=0,C=R,te=x,P=I,B=0,H=-1,W=1<<I,L=W-1,h===i&&W>n||h===a&&W>r)return 1;for(;;){Fe=C-B,w[T]<ee?(Se=0,Ce=w[T]):w[T]>ee?(Se=ue[Oe+w[T]],Ce=V[Q+w[T]]):(Se=96,Ce=0),Z=1<<C-B,U=1<<P,R=U;do U-=Z,v[te+(O>>B)+U]=Fe<<24|Se<<16|Ce|0;while(U!==0);for(Z=1<<C-1;O&Z;)Z>>=1;if(Z!==0?(O&=Z-1,O+=Z):O=0,T++,--se[C]===0){if(C===N)break;C=m[y+w[T]]}if(C>I&&(O&L)!==H){for(B===0&&(B=I),te+=R,P=C-B,D=1<<P;P+B<N&&(D-=se[P+B],!(D<=0));)P++,D<<=1;if(W+=1<<P,h===i&&W>n||h===a&&W>r)return 1;H=O&L,v[H]=I<<24|P<<16|te-x|0}}return O!==0&&(v[te+O]=C-B<<24|64<<16|0),S.bits=I,0},WM}var X9;function L2e(){if(X9)return jl;X9=1;var e=Kh(),t=MY(),n=IY(),r=D2e(),s=F2e(),i=0,a=1,o=2,l=4,c=5,u=6,d=0,h=1,m=2,y=-2,b=-3,v=-4,x=-5,w=8,S=1,k=2,C=3,T=4,R=5,N=6,I=7,P=8,B=9,D=10,W=11,O=12,Z=13,U=14,H=15,L=16,te=17,V=18,Q=19,ee=20,se=21,pe=22,ue=23,Oe=24,Fe=25,Se=26,Ce=27,qe=28,Qe=29,We=30,Ie=31,K=32,ye=852,Ne=592,ce=15,oe=ce;function re(ge){return(ge>>>24&255)+(ge>>>8&65280)+((ge&65280)<<8)+((ge&255)<<24)}function Re(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new e.Buf16(320),this.work=new e.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function Be(ge){var Ee;return!ge||!ge.state?y:(Ee=ge.state,ge.total_in=ge.total_out=Ee.total=0,ge.msg="",Ee.wrap&&(ge.adler=Ee.wrap&1),Ee.mode=S,Ee.last=0,Ee.havedict=0,Ee.dmax=32768,Ee.head=null,Ee.hold=0,Ee.bits=0,Ee.lencode=Ee.lendyn=new e.Buf32(ye),Ee.distcode=Ee.distdyn=new e.Buf32(Ne),Ee.sane=1,Ee.back=-1,d)}function Te(ge){var Ee;return!ge||!ge.state?y:(Ee=ge.state,Ee.wsize=0,Ee.whave=0,Ee.wnext=0,Be(ge))}function lt(ge,Ee){var le,dt;return!ge||!ge.state||(dt=ge.state,Ee<0?(le=0,Ee=-Ee):(le=(Ee>>4)+1,Ee<48&&(Ee&=15)),Ee&&(Ee<8||Ee>15))?y:(dt.window!==null&&dt.wbits!==Ee&&(dt.window=null),dt.wrap=le,dt.wbits=Ee,Te(ge))}function Tt(ge,Ee){var le,dt;return ge?(dt=new Re,ge.state=dt,dt.window=null,le=lt(ge,Ee),le!==d&&(ge.state=null),le):y}function ut(ge){return Tt(ge,oe)}var jt=!0,qt,Ft;function Ht(ge){if(jt){var Ee;for(qt=new e.Buf32(512),Ft=new e.Buf32(32),Ee=0;Ee<144;)ge.lens[Ee++]=8;for(;Ee<256;)ge.lens[Ee++]=9;for(;Ee<280;)ge.lens[Ee++]=7;for(;Ee<288;)ge.lens[Ee++]=8;for(s(a,ge.lens,0,288,qt,0,ge.work,{bits:9}),Ee=0;Ee<32;)ge.lens[Ee++]=5;s(o,ge.lens,0,32,Ft,0,ge.work,{bits:5}),jt=!1}ge.lencode=qt,ge.lenbits=9,ge.distcode=Ft,ge.distbits=5}function we(ge,Ee,le,dt){var et,$=ge.state;return $.window===null&&($.wsize=1<<$.wbits,$.wnext=0,$.whave=0,$.window=new e.Buf8($.wsize)),dt>=$.wsize?(e.arraySet($.window,Ee,le-$.wsize,$.wsize,0),$.wnext=0,$.whave=$.wsize):(et=$.wsize-$.wnext,et>dt&&(et=dt),e.arraySet($.window,Ee,le-dt,et,$.wnext),dt-=et,dt?(e.arraySet($.window,Ee,le-dt,dt,0),$.wnext=dt,$.whave=$.wsize):($.wnext+=et,$.wnext===$.wsize&&($.wnext=0),$.whave<$.wsize&&($.whave+=et))),0}function F(ge,Ee){var le,dt,et,$,Ue,tt,ve,_e,$e,Ct,fe,Y,G,J,xe=0,De,He,xt,Qt,On,Zt,nn,un,gr=new e.Buf8(4),Nr,ns,rs=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!ge||!ge.state||!ge.output||!ge.input&&ge.avail_in!==0)return y;le=ge.state,le.mode===O&&(le.mode=Z),Ue=ge.next_out,et=ge.output,ve=ge.avail_out,$=ge.next_in,dt=ge.input,tt=ge.avail_in,_e=le.hold,$e=le.bits,Ct=tt,fe=ve,un=d;e:for(;;)switch(le.mode){case S:if(le.wrap===0){le.mode=Z;break}for(;$e<16;){if(tt===0)break e;tt--,_e+=dt[$++]<<$e,$e+=8}if(le.wrap&2&&_e===35615){le.check=0,gr[0]=_e&255,gr[1]=_e>>>8&255,le.check=n(le.check,gr,2,0),_e=0,$e=0,le.mode=k;break}if(le.flags=0,le.head&&(le.head.done=!1),!(le.wrap&1)||(((_e&255)<<8)+(_e>>8))%31){ge.msg="incorrect header check",le.mode=We;break}if((_e&15)!==w){ge.msg="unknown compression method",le.mode=We;break}if(_e>>>=4,$e-=4,nn=(_e&15)+8,le.wbits===0)le.wbits=nn;else if(nn>le.wbits){ge.msg="invalid window size",le.mode=We;break}le.dmax=1<<nn,ge.adler=le.check=1,le.mode=_e&512?D:O,_e=0,$e=0;break;case k:for(;$e<16;){if(tt===0)break e;tt--,_e+=dt[$++]<<$e,$e+=8}if(le.flags=_e,(le.flags&255)!==w){ge.msg="unknown compression method",le.mode=We;break}if(le.flags&57344){ge.msg="unknown header flags set",le.mode=We;break}le.head&&(le.head.text=_e>>8&1),le.flags&512&&(gr[0]=_e&255,gr[1]=_e>>>8&255,le.check=n(le.check,gr,2,0)),_e=0,$e=0,le.mode=C;case C:for(;$e<32;){if(tt===0)break e;tt--,_e+=dt[$++]<<$e,$e+=8}le.head&&(le.head.time=_e),le.flags&512&&(gr[0]=_e&255,gr[1]=_e>>>8&255,gr[2]=_e>>>16&255,gr[3]=_e>>>24&255,le.check=n(le.check,gr,4,0)),_e=0,$e=0,le.mode=T;case T:for(;$e<16;){if(tt===0)break e;tt--,_e+=dt[$++]<<$e,$e+=8}le.head&&(le.head.xflags=_e&255,le.head.os=_e>>8),le.flags&512&&(gr[0]=_e&255,gr[1]=_e>>>8&255,le.check=n(le.check,gr,2,0)),_e=0,$e=0,le.mode=R;case R:if(le.flags&1024){for(;$e<16;){if(tt===0)break e;tt--,_e+=dt[$++]<<$e,$e+=8}le.length=_e,le.head&&(le.head.extra_len=_e),le.flags&512&&(gr[0]=_e&255,gr[1]=_e>>>8&255,le.check=n(le.check,gr,2,0)),_e=0,$e=0}else le.head&&(le.head.extra=null);le.mode=N;case N:if(le.flags&1024&&(Y=le.length,Y>tt&&(Y=tt),Y&&(le.head&&(nn=le.head.extra_len-le.length,le.head.extra||(le.head.extra=new Array(le.head.extra_len)),e.arraySet(le.head.extra,dt,$,Y,nn)),le.flags&512&&(le.check=n(le.check,dt,Y,$)),tt-=Y,$+=Y,le.length-=Y),le.length))break e;le.length=0,le.mode=I;case I:if(le.flags&2048){if(tt===0)break e;Y=0;do nn=dt[$+Y++],le.head&&nn&&le.length<65536&&(le.head.name+=String.fromCharCode(nn));while(nn&&Y<tt);if(le.flags&512&&(le.check=n(le.check,dt,Y,$)),tt-=Y,$+=Y,nn)break e}else le.head&&(le.head.name=null);le.length=0,le.mode=P;case P:if(le.flags&4096){if(tt===0)break e;Y=0;do nn=dt[$+Y++],le.head&&nn&&le.length<65536&&(le.head.comment+=String.fromCharCode(nn));while(nn&&Y<tt);if(le.flags&512&&(le.check=n(le.check,dt,Y,$)),tt-=Y,$+=Y,nn)break e}else le.head&&(le.head.comment=null);le.mode=B;case B:if(le.flags&512){for(;$e<16;){if(tt===0)break e;tt--,_e+=dt[$++]<<$e,$e+=8}if(_e!==(le.check&65535)){ge.msg="header crc mismatch",le.mode=We;break}_e=0,$e=0}le.head&&(le.head.hcrc=le.flags>>9&1,le.head.done=!0),ge.adler=le.check=0,le.mode=O;break;case D:for(;$e<32;){if(tt===0)break e;tt--,_e+=dt[$++]<<$e,$e+=8}ge.adler=le.check=re(_e),_e=0,$e=0,le.mode=W;case W:if(le.havedict===0)return ge.next_out=Ue,ge.avail_out=ve,ge.next_in=$,ge.avail_in=tt,le.hold=_e,le.bits=$e,m;ge.adler=le.check=1,le.mode=O;case O:if(Ee===c||Ee===u)break e;case Z:if(le.last){_e>>>=$e&7,$e-=$e&7,le.mode=Ce;break}for(;$e<3;){if(tt===0)break e;tt--,_e+=dt[$++]<<$e,$e+=8}switch(le.last=_e&1,_e>>>=1,$e-=1,_e&3){case 0:le.mode=U;break;case 1:if(Ht(le),le.mode=ee,Ee===u){_e>>>=2,$e-=2;break e}break;case 2:le.mode=te;break;case 3:ge.msg="invalid block type",le.mode=We}_e>>>=2,$e-=2;break;case U:for(_e>>>=$e&7,$e-=$e&7;$e<32;){if(tt===0)break e;tt--,_e+=dt[$++]<<$e,$e+=8}if((_e&65535)!==(_e>>>16^65535)){ge.msg="invalid stored block lengths",le.mode=We;break}if(le.length=_e&65535,_e=0,$e=0,le.mode=H,Ee===u)break e;case H:le.mode=L;case L:if(Y=le.length,Y){if(Y>tt&&(Y=tt),Y>ve&&(Y=ve),Y===0)break e;e.arraySet(et,dt,$,Y,Ue),tt-=Y,$+=Y,ve-=Y,Ue+=Y,le.length-=Y;break}le.mode=O;break;case te:for(;$e<14;){if(tt===0)break e;tt--,_e+=dt[$++]<<$e,$e+=8}if(le.nlen=(_e&31)+257,_e>>>=5,$e-=5,le.ndist=(_e&31)+1,_e>>>=5,$e-=5,le.ncode=(_e&15)+4,_e>>>=4,$e-=4,le.nlen>286||le.ndist>30){ge.msg="too many length or distance symbols",le.mode=We;break}le.have=0,le.mode=V;case V:for(;le.have<le.ncode;){for(;$e<3;){if(tt===0)break e;tt--,_e+=dt[$++]<<$e,$e+=8}le.lens[rs[le.have++]]=_e&7,_e>>>=3,$e-=3}for(;le.have<19;)le.lens[rs[le.have++]]=0;if(le.lencode=le.lendyn,le.lenbits=7,Nr={bits:le.lenbits},un=s(i,le.lens,0,19,le.lencode,0,le.work,Nr),le.lenbits=Nr.bits,un){ge.msg="invalid code lengths set",le.mode=We;break}le.have=0,le.mode=Q;case Q:for(;le.have<le.nlen+le.ndist;){for(;xe=le.lencode[_e&(1<<le.lenbits)-1],De=xe>>>24,He=xe>>>16&255,xt=xe&65535,!(De<=$e);){if(tt===0)break e;tt--,_e+=dt[$++]<<$e,$e+=8}if(xt<16)_e>>>=De,$e-=De,le.lens[le.have++]=xt;else{if(xt===16){for(ns=De+2;$e<ns;){if(tt===0)break e;tt--,_e+=dt[$++]<<$e,$e+=8}if(_e>>>=De,$e-=De,le.have===0){ge.msg="invalid bit length repeat",le.mode=We;break}nn=le.lens[le.have-1],Y=3+(_e&3),_e>>>=2,$e-=2}else if(xt===17){for(ns=De+3;$e<ns;){if(tt===0)break e;tt--,_e+=dt[$++]<<$e,$e+=8}_e>>>=De,$e-=De,nn=0,Y=3+(_e&7),_e>>>=3,$e-=3}else{for(ns=De+7;$e<ns;){if(tt===0)break e;tt--,_e+=dt[$++]<<$e,$e+=8}_e>>>=De,$e-=De,nn=0,Y=11+(_e&127),_e>>>=7,$e-=7}if(le.have+Y>le.nlen+le.ndist){ge.msg="invalid bit length repeat",le.mode=We;break}for(;Y--;)le.lens[le.have++]=nn}}if(le.mode===We)break;if(le.lens[256]===0){ge.msg="invalid code -- missing end-of-block",le.mode=We;break}if(le.lenbits=9,Nr={bits:le.lenbits},un=s(a,le.lens,0,le.nlen,le.lencode,0,le.work,Nr),le.lenbits=Nr.bits,un){ge.msg="invalid literal/lengths set",le.mode=We;break}if(le.distbits=6,le.distcode=le.distdyn,Nr={bits:le.distbits},un=s(o,le.lens,le.nlen,le.ndist,le.distcode,0,le.work,Nr),le.distbits=Nr.bits,un){ge.msg="invalid distances set",le.mode=We;break}if(le.mode=ee,Ee===u)break e;case ee:le.mode=se;case se:if(tt>=6&&ve>=258){ge.next_out=Ue,ge.avail_out=ve,ge.next_in=$,ge.avail_in=tt,le.hold=_e,le.bits=$e,r(ge,fe),Ue=ge.next_out,et=ge.output,ve=ge.avail_out,$=ge.next_in,dt=ge.input,tt=ge.avail_in,_e=le.hold,$e=le.bits,le.mode===O&&(le.back=-1);break}for(le.back=0;xe=le.lencode[_e&(1<<le.lenbits)-1],De=xe>>>24,He=xe>>>16&255,xt=xe&65535,!(De<=$e);){if(tt===0)break e;tt--,_e+=dt[$++]<<$e,$e+=8}if(He&&(He&240)===0){for(Qt=De,On=He,Zt=xt;xe=le.lencode[Zt+((_e&(1<<Qt+On)-1)>>Qt)],De=xe>>>24,He=xe>>>16&255,xt=xe&65535,!(Qt+De<=$e);){if(tt===0)break e;tt--,_e+=dt[$++]<<$e,$e+=8}_e>>>=Qt,$e-=Qt,le.back+=Qt}if(_e>>>=De,$e-=De,le.back+=De,le.length=xt,He===0){le.mode=Se;break}if(He&32){le.back=-1,le.mode=O;break}if(He&64){ge.msg="invalid literal/length code",le.mode=We;break}le.extra=He&15,le.mode=pe;case pe:if(le.extra){for(ns=le.extra;$e<ns;){if(tt===0)break e;tt--,_e+=dt[$++]<<$e,$e+=8}le.length+=_e&(1<<le.extra)-1,_e>>>=le.extra,$e-=le.extra,le.back+=le.extra}le.was=le.length,le.mode=ue;case ue:for(;xe=le.distcode[_e&(1<<le.distbits)-1],De=xe>>>24,He=xe>>>16&255,xt=xe&65535,!(De<=$e);){if(tt===0)break e;tt--,_e+=dt[$++]<<$e,$e+=8}if((He&240)===0){for(Qt=De,On=He,Zt=xt;xe=le.distcode[Zt+((_e&(1<<Qt+On)-1)>>Qt)],De=xe>>>24,He=xe>>>16&255,xt=xe&65535,!(Qt+De<=$e);){if(tt===0)break e;tt--,_e+=dt[$++]<<$e,$e+=8}_e>>>=Qt,$e-=Qt,le.back+=Qt}if(_e>>>=De,$e-=De,le.back+=De,He&64){ge.msg="invalid distance code",le.mode=We;break}le.offset=xt,le.extra=He&15,le.mode=Oe;case Oe:if(le.extra){for(ns=le.extra;$e<ns;){if(tt===0)break e;tt--,_e+=dt[$++]<<$e,$e+=8}le.offset+=_e&(1<<le.extra)-1,_e>>>=le.extra,$e-=le.extra,le.back+=le.extra}if(le.offset>le.dmax){ge.msg="invalid distance too far back",le.mode=We;break}le.mode=Fe;case Fe:if(ve===0)break e;if(Y=fe-ve,le.offset>Y){if(Y=le.offset-Y,Y>le.whave&&le.sane){ge.msg="invalid distance too far back",le.mode=We;break}Y>le.wnext?(Y-=le.wnext,G=le.wsize-Y):G=le.wnext-Y,Y>le.length&&(Y=le.length),J=le.window}else J=et,G=Ue-le.offset,Y=le.length;Y>ve&&(Y=ve),ve-=Y,le.length-=Y;do et[Ue++]=J[G++];while(--Y);le.length===0&&(le.mode=se);break;case Se:if(ve===0)break e;et[Ue++]=le.length,ve--,le.mode=se;break;case Ce:if(le.wrap){for(;$e<32;){if(tt===0)break e;tt--,_e|=dt[$++]<<$e,$e+=8}if(fe-=ve,ge.total_out+=fe,le.total+=fe,fe&&(ge.adler=le.check=le.flags?n(le.check,et,fe,Ue-fe):t(le.check,et,fe,Ue-fe)),fe=ve,(le.flags?_e:re(_e))!==le.check){ge.msg="incorrect data check",le.mode=We;break}_e=0,$e=0}le.mode=qe;case qe:if(le.wrap&&le.flags){for(;$e<32;){if(tt===0)break e;tt--,_e+=dt[$++]<<$e,$e+=8}if(_e!==(le.total&4294967295)){ge.msg="incorrect length check",le.mode=We;break}_e=0,$e=0}le.mode=Qe;case Qe:un=h;break e;case We:un=b;break e;case Ie:return v;case K:default:return y}return ge.next_out=Ue,ge.avail_out=ve,ge.next_in=$,ge.avail_in=tt,le.hold=_e,le.bits=$e,(le.wsize||fe!==ge.avail_out&&le.mode<We&&(le.mode<Ce||Ee!==l))&&we(ge,ge.output,ge.next_out,fe-ge.avail_out),Ct-=ge.avail_in,fe-=ge.avail_out,ge.total_in+=Ct,ge.total_out+=fe,le.total+=fe,le.wrap&&fe&&(ge.adler=le.check=le.flags?n(le.check,et,fe,ge.next_out-fe):t(le.check,et,fe,ge.next_out-fe)),ge.data_type=le.bits+(le.last?64:0)+(le.mode===O?128:0)+(le.mode===ee||le.mode===H?256:0),(Ct===0&&fe===0||Ee===l)&&un===d&&(un=x),un}function X(ge){if(!ge||!ge.state)return y;var Ee=ge.state;return Ee.window&&(Ee.window=null),ge.state=null,d}function be(ge,Ee){var le;return!ge||!ge.state||(le=ge.state,(le.wrap&2)===0)?y:(le.head=Ee,Ee.done=!1,d)}function ke(ge,Ee){var le=Ee.length,dt,et,$;return!ge||!ge.state||(dt=ge.state,dt.wrap!==0&&dt.mode!==W)?y:dt.mode===W&&(et=1,et=t(et,Ee,le,0),et!==dt.check)?b:($=we(ge,Ee,le,le),$?(dt.mode=Ie,v):(dt.havedict=1,d))}return jl.inflateReset=Te,jl.inflateReset2=lt,jl.inflateResetKeep=Be,jl.inflateInit=ut,jl.inflateInit2=Tt,jl.inflate=F,jl.inflateEnd=X,jl.inflateGetHeader=be,jl.inflateSetDictionary=ke,jl.inflateInfo="pako inflate (from Nodeca project)",jl}var HM,J9;function PY(){return J9||(J9=1,HM={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}),HM}var GM,Q9;function B2e(){if(Q9)return GM;Q9=1;function e(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}return GM=e,GM}var ez;function $2e(){if(ez)return e0;ez=1;var e=L2e(),t=Kh(),n=jY(),r=PY(),s=cD(),i=OY(),a=B2e(),o=Object.prototype.toString;function l(d){if(!(this instanceof l))return new l(d);this.options=t.assign({chunkSize:16384,windowBits:0,to:""},d||{});var h=this.options;h.raw&&h.windowBits>=0&&h.windowBits<16&&(h.windowBits=-h.windowBits,h.windowBits===0&&(h.windowBits=-15)),h.windowBits>=0&&h.windowBits<16&&!(d&&d.windowBits)&&(h.windowBits+=32),h.windowBits>15&&h.windowBits<48&&(h.windowBits&15)===0&&(h.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new i,this.strm.avail_out=0;var m=e.inflateInit2(this.strm,h.windowBits);if(m!==r.Z_OK)throw new Error(s[m]);if(this.header=new a,e.inflateGetHeader(this.strm,this.header),h.dictionary&&(typeof h.dictionary=="string"?h.dictionary=n.string2buf(h.dictionary):o.call(h.dictionary)==="[object ArrayBuffer]"&&(h.dictionary=new Uint8Array(h.dictionary)),h.raw&&(m=e.inflateSetDictionary(this.strm,h.dictionary),m!==r.Z_OK)))throw new Error(s[m])}l.prototype.push=function(d,h){var m=this.strm,y=this.options.chunkSize,b=this.options.dictionary,v,x,w,S,k,C=!1;if(this.ended)return!1;x=h===~~h?h:h===!0?r.Z_FINISH:r.Z_NO_FLUSH,typeof d=="string"?m.input=n.binstring2buf(d):o.call(d)==="[object ArrayBuffer]"?m.input=new Uint8Array(d):m.input=d,m.next_in=0,m.avail_in=m.input.length;do{if(m.avail_out===0&&(m.output=new t.Buf8(y),m.next_out=0,m.avail_out=y),v=e.inflate(m,r.Z_NO_FLUSH),v===r.Z_NEED_DICT&&b&&(v=e.inflateSetDictionary(this.strm,b)),v===r.Z_BUF_ERROR&&C===!0&&(v=r.Z_OK,C=!1),v!==r.Z_STREAM_END&&v!==r.Z_OK)return this.onEnd(v),this.ended=!0,!1;m.next_out&&(m.avail_out===0||v===r.Z_STREAM_END||m.avail_in===0&&(x===r.Z_FINISH||x===r.Z_SYNC_FLUSH))&&(this.options.to==="string"?(w=n.utf8border(m.output,m.next_out),S=m.next_out-w,k=n.buf2string(m.output,w),m.next_out=S,m.avail_out=y-S,S&&t.arraySet(m.output,m.output,w,S,0),this.onData(k)):this.onData(t.shrinkBuf(m.output,m.next_out))),m.avail_in===0&&m.avail_out===0&&(C=!0)}while((m.avail_in>0||m.avail_out===0)&&v!==r.Z_STREAM_END);return v===r.Z_STREAM_END&&(x=r.Z_FINISH),x===r.Z_FINISH?(v=e.inflateEnd(this.strm),this.onEnd(v),this.ended=!0,v===r.Z_OK):(x===r.Z_SYNC_FLUSH&&(this.onEnd(r.Z_OK),m.avail_out=0),!0)},l.prototype.onData=function(d){this.chunks.push(d)},l.prototype.onEnd=function(d){d===r.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=t.flattenChunks(this.chunks)),this.chunks=[],this.err=d,this.msg=this.strm.msg};function c(d,h){var m=new l(h);if(m.push(d,!0),m.err)throw m.msg||s[m.err];return m.result}function u(d,h){return h=h||{},h.raw=!0,c(d,h)}return e0.Inflate=l,e0.inflate=c,e0.inflateRaw=u,e0.ungzip=c,e0}var KM,tz;function z2e(){if(tz)return KM;tz=1;var e=Kh().assign,t=P2e(),n=$2e(),r=PY(),s={};return e(s,t,n,r),KM=s,KM}var U2e=z2e();const uD=ua(U2e);var YM,nz;function q2e(){if(nz)return YM;nz=1;const e=(t,n)=>function(...r){const s=n.promiseModule;return new s((i,a)=>{n.multiArgs?r.push((...o)=>{n.errorFirst?o[0]?a(o):(o.shift(),i(o)):i(o)}):n.errorFirst?r.push((o,l)=>{o?a(o):i(l)}):r.push(i),t.apply(this,r)})};return YM=(t,n)=>{n=Object.assign({exclude:[/.+(Sync|Stream)$/],errorFirst:!0,promiseModule:Promise},n);const r=typeof t;if(!(t!==null&&(r==="object"||r==="function")))throw new TypeError(`Expected \`input\` to be a \`Function\` or \`Object\`, got \`${t===null?"null":r}\``);const s=a=>{const o=l=>typeof l=="string"?a===l:l.test(a);return n.include?n.include.some(o):!n.exclude.some(o)};let i;r==="function"?i=function(...a){return n.excludeMain?t(...a):e(t,n).apply(this,a)}:i=Object.create(Object.getPrototypeOf(t));for(const a in t){const o=t[a];i[a]=typeof o=="function"&&s(a)?e(o,n):o}return i},YM}var V2e=q2e();const ZM=ua(V2e);var XM,rz;function W2e(){if(rz)return XM;rz=1;var e={};function t(H){return Array.isArray(H)?H:[H]}const n="",r=" ",s="\\",i=/^\s+$/,a=/(?:[^\\]|^)\\$/,o=/^\\!/,l=/^\\#/,c=/\r?\n/g,u=/^\.*\/|^\.+$/,d="/";let h="node-ignore";typeof Symbol<"u"&&(h=Symbol.for("node-ignore"));const m=h,y=(H,L,te)=>Object.defineProperty(H,L,{value:te}),b=/([0-z])-([0-z])/g,v=()=>!1,x=H=>H.replace(b,(L,te,V)=>te.charCodeAt(0)<=V.charCodeAt(0)?L:n),w=H=>{const{length:L}=H;return H.slice(0,L-L%2)},S=[[/^\uFEFF/,()=>n],[/((?:\\\\)*?)(\\?\s+)$/,(H,L,te)=>L+(te.indexOf("\\")===0?r:n)],[/(\\+?)\s/g,(H,L)=>{const{length:te}=L;return L.slice(0,te-te%2)+r}],[/[\\$.|*+(){^]/g,H=>`\\${H}`],[/(?!\\)\?/g,()=>"[^/]"],[/^\//,()=>"^"],[/\//g,()=>"\\/"],[/^\^*\\\*\\\*\\\//,()=>"^(?:.*\\/)?"],[/^(?=[^^])/,function(){return/\/(?!$)/.test(this)?"^":"(?:^|\\/)"}],[/\\\/\\\*\\\*(?=\\\/|$)/g,(H,L,te)=>L+6<te.length?"(?:\\/[^\\/]+)*":"\\/.+"],[/(^|[^\\]+)(\\\*)+(?=.+)/g,(H,L,te)=>{const V=te.replace(/\\\*/g,"[^\\/]*");return L+V}],[/\\\\\\(?=[$.|*+(){^])/g,()=>s],[/\\\\/g,()=>s],[/(\\)?\[([^\]/]*?)(\\*)($|\])/g,(H,L,te,V,Q)=>L===s?`\\[${te}${w(V)}${Q}`:Q==="]"&&V.length%2===0?`[${x(te)}${V}]`:"[]"],[/(?:[^*])$/,H=>/\/$/.test(H)?`${H}$`:`${H}(?=$|\\/$)`],[/(\^|\\\/)?\\\*$/,(H,L)=>`${L?`${L}[^/]+`:"[^/]*"}(?=$|\\/$)`]],k=Object.create(null),C=(H,L)=>{let te=k[H];return te||(te=S.reduce((V,[Q,ee])=>V.replace(Q,ee.bind(H)),H),k[H]=te),L?new RegExp(te,"i"):new RegExp(te)},T=H=>typeof H=="string",R=H=>H&&T(H)&&!i.test(H)&&!a.test(H)&&H.indexOf("#")!==0,N=H=>H.split(c);class I{constructor(L,te,V,Q){this.origin=L,this.pattern=te,this.negative=V,this.regex=Q}}const P=(H,L)=>{const te=H;let V=!1;H.indexOf("!")===0&&(V=!0,H=H.substr(1)),H=H.replace(o,"!").replace(l,"#");const Q=C(H,L);return new I(te,H,V,Q)},B=(H,L)=>{throw new L(H)},D=(H,L,te)=>T(H)?H?D.isNotRelative(H)?te(`path should be a \`path.relative()\`d string, but got "${L}"`,RangeError):!0:te("path must not be empty",TypeError):te(`path must be a string, but got \`${L}\``,TypeError),W=H=>u.test(H);D.isNotRelative=W,D.convert=H=>H;class O{constructor({ignorecase:L=!0,ignoreCase:te=L,allowRelativePaths:V=!1}={}){y(this,m,!0),this._rules=[],this._ignoreCase=te,this._allowRelativePaths=V,this._initCache()}_initCache(){this._ignoreCache=Object.create(null),this._testCache=Object.create(null)}_addPattern(L){if(L&&L[m]){this._rules=this._rules.concat(L._rules),this._added=!0;return}if(R(L)){const te=P(L,this._ignoreCase);this._added=!0,this._rules.push(te)}}add(L){return this._added=!1,t(T(L)?N(L):L).forEach(this._addPattern,this),this._added&&this._initCache(),this}addPattern(L){return this.add(L)}_testOne(L,te){let V=!1,Q=!1;return this._rules.forEach(ee=>{const{negative:se}=ee;if(Q===se&&V!==Q||se&&!V&&!Q&&!te)return;ee.regex.test(L)&&(V=!se,Q=se)}),{ignored:V,unignored:Q}}_test(L,te,V,Q){const ee=L&&D.convert(L);return D(ee,L,this._allowRelativePaths?v:B),this._t(ee,te,V,Q)}_t(L,te,V,Q){if(L in te)return te[L];if(Q||(Q=L.split(d)),Q.pop(),!Q.length)return te[L]=this._testOne(L,V);const ee=this._t(Q.join(d)+d,te,V,Q);return te[L]=ee.ignored?ee:this._testOne(L,V)}ignores(L){return this._test(L,this._ignoreCache,!1).ignored}createFilter(){return L=>!this.ignores(L)}filter(L){return t(L).filter(this.createFilter())}test(L){return this._test(L,this._testCache,!0)}}const Z=H=>new O(H),U=H=>D(H&&D.convert(H),H,v);if(Z.isPathValid=U,Z.default=Z,XM=Z,typeof Mi<"u"&&(e&&e.IGNORE_TEST_WIN32||Mi.platform==="win32")){const H=te=>/^\\\\\?\\/.test(te)||/["<>|\u0000-\u001F]+/u.test(te)?te:te.replace(/\\/g,"/");D.convert=H;const L=/^[a-z]:\//i;D.isNotRelative=te=>L.test(te)||W(te)}return XM}var H2e=W2e();const G2e=ua(H2e);var JM,sz;function K2e(){if(sz)return JM;sz=1;function e(r){return r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function t(r,s,i){return s=s instanceof RegExp?s:new RegExp(e(s),"g"),r.replace(s,i)}var n={clean:function(s){if(typeof s!="string")throw new Error("Expected a string, received: "+s);return s=t(s,"./","/"),s=t(s,"..","."),s=t(s," ","-"),s=t(s,/^[~^:?*\\\-]/g,""),s=t(s,/[~^:?*\\]/g,"-"),s=t(s,/[~^:?*\\\-]$/g,""),s=t(s,"@{","-"),s=t(s,/\.$/g,""),s=t(s,/\/$/g,""),s=t(s,/\.lock$/g,""),s}};return JM=n,JM}var Y2e=K2e();const xu=ua(Y2e);var QM,iz;function Z2e(){return iz||(iz=1,QM=function(e,t){var n=e,r=t,s=n.length,i=r.length,a=!1,o=null,l=s+1,c=[],u=[],d=[],h="",m=-1,y=0,b=1,v,x,w=function(){s>=i&&(v=n,x=s,n=r,r=v,s=i,i=x,a=!0,l=s+1)},S=function(R,N,I){return{x:R,y:N,k:I}},k=function(R,N){return{elem:R,t:N}},C=function(R,N,I){var P,B,D;for(N>I?P=c[R-1+l]:P=c[R+1+l],D=Math.max(N,I),B=D-R;B<s&&D<i&&n[B]===r[D];)++B,++D;return c[R+l]=u.length,u[u.length]=new S(B,D,P),D},T=function(R){var N,I,P;for(N=I=0,P=R.length-1;P>=0;--P)for(;N<R[P].x||I<R[P].y;)R[P].y-R[P].x>I-N?(a?d[d.length]=new k(r[I],m):d[d.length]=new k(r[I],b),++I):R[P].y-R[P].x<I-N?(a?d[d.length]=new k(n[N],b):d[d.length]=new k(n[N],m),++N):(d[d.length]=new k(n[N],y),h+=n[N],++N,++I)};return w(),{SES_DELETE:-1,SES_COMMON:0,SES_ADD:1,editdistance:function(){return o},getlcs:function(){return h},getses:function(){return d},compose:function(){var R,N,I,P,B,D,W,O;for(R=i-s,N=s+i+3,I={},W=0;W<N;++W)I[W]=-1,c[W]=-1;P=-1;do{for(++P,O=-P;O<=R-1;++O)I[O+l]=C(O,I[O-1+l]+1,I[O+1+l]);for(O=R+P;O>=R+1;--O)I[O+l]=C(O,I[O-1+l]+1,I[O+1+l]);I[R+l]=C(R,I[R-1+l]+1,I[R+1+l])}while(I[R+l]!==i);for(o=R+2*P,B=c[R+l],D=[];B!==-1;)D[D.length]=new S(u[B].x,u[B].y,null),B=u[B].k;T(D)}}}),QM}var eI,az;function X2e(){if(az)return eI;az=1;var e=Z2e();function t(i,a){var o=new e(i,a);o.compose();for(var l=o.getses(),c,u,d=i.length-1,h=a.length-1,m=l.length-1;m>=0;--m)l[m].t===o.SES_COMMON?(u?(u.chain={file1index:d,file2index:h,chain:null},u=u.chain):(c={file1index:d,file2index:h,chain:null},u=c),d--,h--):l[m].t===o.SES_DELETE?d--:l[m].t===o.SES_ADD&&h--;var y={file1index:-1,file2index:-1,chain:null};return u?(u.chain=y,c):y}function n(i,a){for(var o=[],l=i.length,c=a.length,u=t(i,a);u!==null;u=u.chain){var d=l-u.file1index-1,h=c-u.file2index-1;l=u.file1index,c=u.file2index,(d||h)&&o.push({file1:[l+1,d],file2:[c+1,h]})}return o.reverse(),o}function r(i,a,o){var l,c=n(a,i),u=n(a,o),d=[];function h(L,te){d.push([L.file1[0],te,L.file1[1],L.file2[0],L.file2[1]])}for(l=0;l<c.length;l++)h(c[l],0);for(l=0;l<u.length;l++)h(u[l],2);d.sort(function(L,te){return L[0]-te[0]});var m=[],y=0;function b(L){L>y&&(m.push([1,y,L-y]),y=L)}for(var v=0;v<d.length;v++){for(var x=v,w=d[v],S=w[0],k=S+w[2];v<d.length-1;){var C=d[v+1],T=C[0];if(T>k)break;k=Math.max(k,T+C[2]),v++}if(b(S),x==v)w[4]>0&&m.push([w[1],w[3],w[4]]);else{var R={0:[i.length,-1,a.length,-1],2:[o.length,-1,a.length,-1]};for(l=x;l<=v;l++){w=d[l];var N=w[1],I=R[N],P=w[0],B=P+w[2],D=w[3],W=D+w[4];I[0]=Math.min(D,I[0]),I[1]=Math.max(W,I[1]),I[2]=Math.min(P,I[2]),I[3]=Math.max(B,I[3])}var O=R[0][0]+(S-R[0][2]),Z=R[0][1]+(k-R[0][3]),U=R[2][0]+(S-R[2][2]),H=R[2][1]+(k-R[2][3]);m.push([-1,O,Z-O,S,k-S,U,H-U])}y=k}return b(a.length),m}function s(i,a,o){var l=[],c=[i,a,o],u=r(i,a,o),d=[];function h(){d.length&&l.push({ok:d}),d=[]}function m(w){for(var S=0;S<w.length;S++)d.push(w[S])}function y(w){if(w[2]!=w[6])return!0;for(var S=w[1],k=w[5],C=0;C<w[2];C++)if(i[C+S]!=o[C+k])return!0;return!1}for(var b=0;b<u.length;b++){var v=u[b],x=v[0];x==-1?y(v)?(h(),l.push({conflict:{a:i.slice(v[1],v[1]+v[2]),aIndex:v[1],o:a.slice(v[3],v[3]+v[4]),oIndex:v[3],b:o.slice(v[5],v[5]+v[6]),bIndex:v[5]}})):m(c[0].slice(v[1],v[1]+v[2])):m(c[x].slice(v[1],v[1]+v[2]))}return h(),l}return eI=s,eI}var J2e=X2e();const Q2e=ua(J2e);class Jr extends Error{constructor(t){super(t),this.caller=""}toJSON(){return{code:this.code,data:this.data,caller:this.caller,message:this.message,stack:this.stack}}fromJSON(t){const n=new Jr(t.message);return n.code=t.code,n.data=t.data,n.caller=t.caller,n.stack=t.stack,n}get isIsomorphicGitError(){return!0}}class E1 extends Jr{constructor(t){super(`Modifying the index is not possible because you have unmerged files: ${t.toString}. Fix them up in the work tree, and then use 'git add/rm as appropriate to mark resolution and make a commit.`),this.code=this.name=E1.code,this.data={filepaths:t}}}E1.code="UnmergedPathsError";class vr extends Jr{constructor(t){super(`An internal error caused this command to fail. Please file a bug report at https://github.com/isomorphic-git/isomorphic-git/issues with this error message: ${t}`),this.code=this.name=vr.code,this.data={message:t}}}vr.code="InternalError";class tb extends Jr{constructor(t){super(`The filepath "${t}" contains unsafe character sequences`),this.code=this.name=tb.code,this.data={filepath:t}}}tb.code="UnsafeFilepathError";class yu{constructor(t){this.buffer=t,this._start=0}eof(){return this._start>=this.buffer.length}tell(){return this._start}seek(t){this._start=t}slice(t){const n=this.buffer.slice(this._start,this._start+t);return this._start+=t,n}toString(t,n){const r=this.buffer.toString(t,this._start,this._start+n);return this._start+=n,r}write(t,n,r){const s=this.buffer.write(t,this._start,n,r);return this._start+=n,s}copy(t,n,r){const s=t.copy(this.buffer,this._start,n,r);return this._start+=s,s}readUInt8(){const t=this.buffer.readUInt8(this._start);return this._start+=1,t}writeUInt8(t){const n=this.buffer.writeUInt8(t,this._start);return this._start+=1,n}readUInt16BE(){const t=this.buffer.readUInt16BE(this._start);return this._start+=2,t}writeUInt16BE(t){const n=this.buffer.writeUInt16BE(t,this._start);return this._start+=2,n}readUInt32BE(){const t=this.buffer.readUInt32BE(this._start);return this._start+=4,t}writeUInt32BE(t){const n=this.buffer.writeUInt32BE(t,this._start);return this._start+=4,n}}function nT(e,t){return-(e<t)||+(e>t)}function DY(e,t){return nT(e.path,t.path)}function FY(e){let t=e>0?e>>12:0;t!==4&&t!==8&&t!==10&&t!==14&&(t=8);let n=e&511;return n&73?n=493:n=420,t!==8&&(n=0),(t<<12)+n}const su=2**32;function oz(e,t,n,r){if(e!==void 0&&t!==void 0)return[e,t];n===void 0&&(n=r.valueOf());const s=Math.floor(n/1e3),i=(n-s*1e3)*1e6;return[s,i]}function uy(e){const[t,n]=oz(e.ctimeSeconds,e.ctimeNanoseconds,e.ctimeMs,e.ctime),[r,s]=oz(e.mtimeSeconds,e.mtimeNanoseconds,e.mtimeMs,e.mtime);return{ctimeSeconds:t%su,ctimeNanoseconds:n%su,mtimeSeconds:r%su,mtimeNanoseconds:s%su,dev:e.dev%su,ino:e.ino%su,mode:FY(e.mode%su),uid:e.uid%su,gid:e.gid%su,size:e.size>-1?e.size%su:0}}function eCe(e){let t="";for(const n of new Uint8Array(e))n<16&&(t+="0"),t+=n.toString(16);return t}let tI=null;async function Xd(e){return tI===null&&(tI=await nCe()),tI?LY(e):tCe(e)}function tCe(e){return new NY().update(e).digest("hex")}async function LY(e){const t=await crypto.subtle.digest("SHA-1",e);return eCe(t)}async function nCe(){try{if(await LY(new Uint8Array([]))==="da39a3ee5e6b4b0d3255bfef95601890afd80709")return!0}catch{}return!1}function rCe(e){return{assumeValid:!!(e&32768),extended:!!(e&16384),stage:(e&12288)>>12,nameLength:e&4095}}function sCe(e){const t=e.flags;return t.extended=!1,t.nameLength=Math.min(ln.from(e.path).length,4095),(t.assumeValid?32768:0)+(t.extended?16384:0)+((t.stage&3)<<12)+(t.nameLength&4095)}class Jp{constructor(t,n){this._dirty=!1,this._unmergedPaths=n||new Set,this._entries=t||new Map}_addEntry(t){if(t.flags.stage===0)t.stages=[t],this._entries.set(t.path,t),this._unmergedPaths.delete(t.path);else{let n=this._entries.get(t.path);n||(this._entries.set(t.path,t),n=t),n.stages[t.flags.stage]=t,this._unmergedPaths.add(t.path)}}static async from(t){if(ln.isBuffer(t))return Jp.fromBuffer(t);if(t===null)return new Jp(null);throw new vr("invalid type passed to GitIndex.from")}static async fromBuffer(t){if(t.length===0)throw new vr("Index file is empty (.git/index)");const n=new Jp,r=new yu(t),s=r.toString("utf8",4);if(s!=="DIRC")throw new vr(`Invalid dircache magic file number: ${s}`);const i=await Xd(t.slice(0,-20)),a=t.slice(-20).toString("hex");if(a!==i)throw new vr(`Invalid checksum in GitIndex buffer: expected ${a} but saw ${i}`);const o=r.readUInt32BE();if(o!==2)throw new vr(`Unsupported dircache version: ${o}`);const l=r.readUInt32BE();let c=0;for(;!r.eof()&&c<l;){const u={};u.ctimeSeconds=r.readUInt32BE(),u.ctimeNanoseconds=r.readUInt32BE(),u.mtimeSeconds=r.readUInt32BE(),u.mtimeNanoseconds=r.readUInt32BE(),u.dev=r.readUInt32BE(),u.ino=r.readUInt32BE(),u.mode=r.readUInt32BE(),u.uid=r.readUInt32BE(),u.gid=r.readUInt32BE(),u.size=r.readUInt32BE(),u.oid=r.slice(20).toString("hex");const d=r.readUInt16BE();u.flags=rCe(d);const h=t.indexOf(0,r.tell()+1)-r.tell();if(h<1)throw new vr(`Got a path length of: ${h}`);if(u.path=r.toString("utf8",h),u.path.includes("..\\")||u.path.includes("../"))throw new tb(u.path);let m=8-(r.tell()-12)%8;for(m===0&&(m=8);m--;){const y=r.readUInt8();if(y!==0)throw new vr(`Expected 1-8 null characters but got '${y}' after ${u.path}`);if(r.eof())throw new vr("Unexpected end of file")}u.stages=[],n._addEntry(u),c++}return n}get unmergedPaths(){return[...this._unmergedPaths]}get entries(){return[...this._entries.values()].sort(DY)}get entriesMap(){return this._entries}get entriesFlat(){return[...this.entries].flatMap(t=>t.stages.length>1?t.stages.filter(n=>n):t)}*[Symbol.iterator](){for(const t of this.entries)yield t}insert({filepath:t,stats:n,oid:r,stage:s=0}){n||(n={ctimeSeconds:0,ctimeNanoseconds:0,mtimeSeconds:0,mtimeNanoseconds:0,dev:0,ino:0,mode:0,uid:0,gid:0,size:0}),n=uy(n);const i=ln.from(t),a={ctimeSeconds:n.ctimeSeconds,ctimeNanoseconds:n.ctimeNanoseconds,mtimeSeconds:n.mtimeSeconds,mtimeNanoseconds:n.mtimeNanoseconds,dev:n.dev,ino:n.ino,mode:n.mode||33188,uid:n.uid,gid:n.gid,size:n.size,path:t,oid:r,flags:{assumeValid:!1,extended:!1,stage:s,nameLength:i.length<4095?i.length:4095},stages:[]};this._addEntry(a),this._dirty=!0}delete({filepath:t}){if(this._entries.has(t))this._entries.delete(t);else for(const n of this._entries.keys())n.startsWith(t+"/")&&this._entries.delete(n);this._unmergedPaths.has(t)&&this._unmergedPaths.delete(t),this._dirty=!0}clear(){this._entries.clear(),this._dirty=!0}has({filepath:t}){return this._entries.has(t)}render(){return this.entries.map(t=>`${t.mode.toString(8)} ${t.oid}    ${t.path}`).join(`
`)}static async _entryToBuffer(t){const n=ln.from(t.path),r=Math.ceil((62+n.length+1)/8)*8,s=ln.alloc(r),i=new yu(s),a=uy(t);return i.writeUInt32BE(a.ctimeSeconds),i.writeUInt32BE(a.ctimeNanoseconds),i.writeUInt32BE(a.mtimeSeconds),i.writeUInt32BE(a.mtimeNanoseconds),i.writeUInt32BE(a.dev),i.writeUInt32BE(a.ino),i.writeUInt32BE(a.mode),i.writeUInt32BE(a.uid),i.writeUInt32BE(a.gid),i.writeUInt32BE(a.size),i.write(t.oid,20,"hex"),i.writeUInt16BE(sCe(t)),i.write(t.path,n.length,"utf8"),s}async toObject(){const t=ln.alloc(12),n=new yu(t);n.write("DIRC",4,"utf8"),n.writeUInt32BE(2),n.writeUInt32BE(this.entriesFlat.length);let r=[];for(const o of this.entries)if(r.push(Jp._entryToBuffer(o)),o.stages.length>1)for(const l of o.stages)l&&l!==o&&r.push(Jp._entryToBuffer(l));r=await Promise.all(r);const s=ln.concat(r),i=ln.concat([t,s]),a=await Xd(i);return ln.concat([i,ln.from(a,"hex")])}}function GC(e,t,n=!0,r=!0){const s=uy(e),i=uy(t);return n&&s.mode!==i.mode||s.mtimeSeconds!==i.mtimeSeconds||s.ctimeSeconds!==i.ctimeSeconds||s.uid!==i.uid||s.gid!==i.gid||r&&s.ino!==i.ino||s.size!==i.size}let nI=null;const rI=Symbol("IndexCache");function iCe(){return{map:new Map,stats:new Map}}async function aCe(e,t,n){const[r,s]=await Promise.all([e.lstat(t),e.read(t)]),i=await Jp.from(s);n.map.set(t,i),n.stats.set(t,r)}async function oCe(e,t,n){const r=n.stats.get(t);if(r===void 0)return!0;if(r===null)return!1;const s=await e.lstat(t);return s===null?!1:GC(r,s)}class ca{static async acquire({fs:t,gitdir:n,cache:r,allowUnmerged:s=!0},i){r[rI]||(r[rI]=iCe());const a=`${n}/index`;nI===null&&(nI=new mw({maxPending:1/0}));let o,l=[];return await nI.acquire(a,async()=>{const c=r[rI];await oCe(t,a,c)&&await aCe(t,a,c);const u=c.map.get(a);if(l=u.unmergedPaths,l.length&&!s)throw new E1(l);if(o=await i(u),u._dirty){const d=await u.toObject();await t.write(a,d),c.stats.set(a,await t.lstat(a)),u._dirty=!1}}),o}}function KC(e){const t=Math.max(e.lastIndexOf("/"),e.lastIndexOf("\\"));return t>-1&&(e=e.slice(t+1)),e}function dy(e){const t=Math.max(e.lastIndexOf("/"),e.lastIndexOf("\\"));return t===-1?".":t===0?"/":e.slice(0,t)}function BY(e){const t=new Map,n=function(s){if(!t.has(s)){const i={type:"tree",fullpath:s,basename:KC(s),metadata:{},children:[]};t.set(s,i),i.parent=n(dy(s)),i.parent&&i.parent!==i&&i.parent.children.push(i)}return t.get(s)},r=function(s,i){if(!t.has(s)){const a={type:"blob",fullpath:s,basename:KC(s),metadata:i,parent:n(dy(s)),children:[]};a.parent&&a.parent.children.push(a),t.set(s,a)}return t.get(s)};n(".");for(const s of e)r(s.path,s);return t}function lCe(e){switch(e){case 16384:return"tree";case 33188:return"blob";case 33261:return"blob";case 40960:return"blob";case 57344:return"commit"}throw new vr(`Unexpected GitTree entry mode: ${e.toString(8)}`)}class cCe{constructor({fs:t,gitdir:n,cache:r}){this.treePromise=ca.acquire({fs:t,gitdir:n,cache:r},async function(i){return BY(i.entries)});const s=this;this.ConstructEntry=class{constructor(a){this._fullpath=a,this._type=!1,this._mode=!1,this._stat=!1,this._oid=!1}async type(){return s.type(this)}async mode(){return s.mode(this)}async stat(){return s.stat(this)}async content(){return s.content(this)}async oid(){return s.oid(this)}}}async readdir(t){const n=t._fullpath,s=(await this.treePromise).get(n);if(!s||s.type==="blob")return null;if(s.type!=="tree")throw new Error(`ENOTDIR: not a directory, scandir '${n}'`);const i=s.children.map(a=>a.fullpath);return i.sort(nT),i}async type(t){return t._type===!1&&await t.stat(),t._type}async mode(t){return t._mode===!1&&await t.stat(),t._mode}async stat(t){if(t._stat===!1){const r=(await this.treePromise).get(t._fullpath);if(!r)throw new Error(`ENOENT: no such file or directory, lstat '${t._fullpath}'`);const s=r.type==="tree"?{}:uy(r.metadata);t._type=r.type==="tree"?"tree":lCe(s.mode),t._mode=s.mode,r.type==="tree"?t._stat=void 0:t._stat=s}return t._stat}async content(t){}async oid(t){if(t._oid===!1){const r=(await this.treePromise).get(t._fullpath);t._oid=r.metadata.oid}return t._oid}}const rT=Symbol("GitWalkSymbol");function nb(){const e=Object.create(null);return Object.defineProperty(e,rT,{value:function({fs:t,gitdir:n,cache:r}){return new cCe({fs:t,gitdir:n,cache:r})}}),Object.freeze(e),e}class As extends Jr{constructor(t){super(`Could not find ${t}.`),this.code=this.name=As.code,this.data={what:t}}}As.code="NotFoundError";class ho extends Jr{constructor(t,n,r,s){super(`Object ${t} ${s?`at ${s}`:""}was anticipated to be a ${r} but it is a ${n}.`),this.code=this.name=ho.code,this.data={oid:t,actual:n,expected:r,filepath:s}}}ho.code="ObjectTypeError";class Eh extends Jr{constructor(t){super(`Expected a 40-char hex object id but saw "${t}".`),this.code=this.name=Eh.code,this.data={value:t}}}Eh.code="InvalidOidError";class T1 extends Jr{constructor(t){super(`Could not find a fetch refspec for remote "${t}". Make sure the config file has an entry like the following:
[remote "${t}"]
	fetch = +refs/heads/*:refs/remotes/origin/*
`),this.code=this.name=T1.code,this.data={remote:t}}}T1.code="NoRefspecError";class YC{constructor(t){if(this.refs=new Map,this.parsedConfig=[],t){let n=null;this.parsedConfig=t.trim().split(`
`).map(r=>{if(/^\s*#/.test(r))return{line:r,comment:!0};const s=r.indexOf(" ");if(r.startsWith("^")){const i=r.slice(1);return this.refs.set(n+"^{}",i),{line:r,ref:n,peeled:i}}else{const i=r.slice(0,s);return n=r.slice(s+1),this.refs.set(n,i),{line:r,ref:n,oid:i}}})}return this}static from(t){return new YC(t)}delete(t){this.parsedConfig=this.parsedConfig.filter(n=>n.ref!==t),this.refs.delete(t)}toString(){return this.parsedConfig.map(({line:t})=>t).join(`
`)+`
`}}class ZC{constructor({remotePath:t,localPath:n,force:r,matchPrefix:s}){Object.assign(this,{remotePath:t,localPath:n,force:r,matchPrefix:s})}static from(t){const[n,r,s,i,a]=t.match(/^(\+?)(.*?)(\*?):(.*?)(\*?)$/).slice(1),o=n==="+",l=s==="*";if(l!==(a==="*"))throw new vr("Invalid refspec");return new ZC({remotePath:r,localPath:i,force:o,matchPrefix:l})}translate(t){if(this.matchPrefix){if(t.startsWith(this.remotePath))return this.localPath+t.replace(this.remotePath,"")}else if(t===this.remotePath)return this.localPath;return null}reverseTranslate(t){if(this.matchPrefix){if(t.startsWith(this.localPath))return this.remotePath+t.replace(this.localPath,"")}else if(t===this.localPath)return this.remotePath;return null}}class dD{constructor(t=[]){this.rules=t}static from(t){const n=[];for(const r of t)n.push(ZC.from(r));return new dD(n)}add(t){const n=ZC.from(t);this.rules.push(n)}translate(t){const n=[];for(const r of this.rules)for(const s of t){const i=r.translate(s);i&&n.push([s,i])}return n}translateOne(t){let n=null;for(const r of this.rules){const s=r.translate(t);s&&(n=s)}return n}localNamespaces(){return this.rules.filter(t=>t.matchPrefix).map(t=>t.localPath.replace(/\/$/,""))}}function uCe(e,t){const n=e.replace(/\^\{\}$/,""),r=t.replace(/\^\{\}$/,""),s=-(n<r)||+(n>r);return s===0?e.endsWith("^{}")?1:-1:s}const dCe=e=>{if(typeof e=="number")return e;e=e.toLowerCase();let t=parseInt(e);return e.endsWith("k")&&(t*=1024),e.endsWith("m")&&(t*=1024*1024),e.endsWith("g")&&(t*=1024*1024*1024),t},Fv=e=>{if(typeof e=="boolean")return e;if(e=e.trim().toLowerCase(),e==="true"||e==="yes"||e==="on")return!0;if(e==="false"||e==="no"||e==="off")return!1;throw Error(`Expected 'true', 'false', 'yes', 'no', 'on', or 'off', but got ${e}`)},lz={core:{filemode:Fv,bare:Fv,logallrefupdates:Fv,symlinks:Fv,ignorecase:Fv,bigFileThreshold:dCe}},fCe=/^\[([A-Za-z0-9-.]+)(?: "(.*)")?\]$/,hCe=/^[A-Za-z0-9-.]+$/,pCe=/^([A-Za-z][A-Za-z-]*)(?: *= *(.*))?$/,mCe=/^[A-Za-z][A-Za-z-]*$/,gCe=/^(.*?)( *[#;].*)$/,yCe=e=>{const t=fCe.exec(e);if(t!=null){const[n,r]=t.slice(1);return[n,r]}return null},bCe=e=>{const t=pCe.exec(e);if(t!=null){const[n,r="true"]=t.slice(1),s=vCe(r),i=xCe(s);return[n,i]}return null},vCe=e=>{const t=gCe.exec(e);if(t==null)return e;const[n,r]=t.slice(1);return cz(n)&&cz(r)?`${n}${r}`:n},cz=e=>(e.match(/(?:^|[^\\])"/g)||[]).length%2!==0,xCe=e=>e.split("").reduce((t,n,r,s)=>{const i=n==='"'&&s[r-1]!=="\\",a=n==="\\"&&s[r+1]==='"';return i||a?t:t+n},""),uz=e=>e!=null?e.toLowerCase():null,Oj=(e,t,n)=>[uz(e),t,uz(n)].filter(r=>r!=null).join("."),dz=e=>{const t=e.split("."),n=t.shift(),r=t.pop(),s=t.length?t.join("."):void 0;return{section:n,subsection:s,name:r,path:Oj(n,s,r),sectionPath:Oj(n,s,null),isSection:!!n}},wCe=(e,t)=>e.reduce((n,r,s)=>t(r)?s:n,-1);class fD{constructor(t){let n=null,r=null;this.parsedConfig=t?t.split(`
`).map(s=>{let i=null,a=null;const o=s.trim(),l=yCe(o),c=l!=null;if(c)[n,r]=l;else{const d=bCe(o);d!=null&&([i,a]=d)}const u=Oj(n,r,i);return{line:s,isSection:c,section:n,subsection:r,name:i,value:a,path:u}}):[]}static from(t){return new fD(t)}async get(t,n=!1){const r=dz(t).path,s=this.parsedConfig.filter(i=>i.path===r).map(({section:i,name:a,value:o})=>{const l=lz[i]&&lz[i][a];return l?l(o):o});return n?s:s.pop()}async getall(t){return this.get(t,!0)}async getSubsections(t){return this.parsedConfig.filter(n=>n.isSection&&n.section===t).map(n=>n.subsection)}async deleteSection(t,n){this.parsedConfig=this.parsedConfig.filter(r=>!(r.section===t&&r.subsection===n))}async append(t,n){return this.set(t,n,!0)}async set(t,n,r=!1){const{section:s,subsection:i,name:a,path:o,sectionPath:l,isSection:c}=dz(t),u=wCe(this.parsedConfig,d=>d.path===o);if(n==null)u!==-1&&this.parsedConfig.splice(u,1);else if(u!==-1){const d=this.parsedConfig[u],h=Object.assign({},d,{name:a,value:n,modified:!0});r?this.parsedConfig.splice(u+1,0,h):this.parsedConfig[u]=h}else{const d=this.parsedConfig.findIndex(m=>m.path===l),h={section:s,subsection:i,name:a,value:n,modified:!0,path:o};if(hCe.test(s)&&mCe.test(a))if(d>=0)this.parsedConfig.splice(d+1,0,h);else{const m={isSection:c,section:s,subsection:i,modified:!0,path:l};this.parsedConfig.push(m,h)}}}toString(){return this.parsedConfig.map(({line:t,section:n,subsection:r,name:s,value:i,modified:a=!1})=>a?s!=null&&i!=null?typeof i=="string"&&/[#;]/.test(i)?`	${s} = "${i}"`:`	${s} = ${i}`:r!=null?`[${n} "${r}"]`:`[${n}]`:t).join(`
`)}}class Pi{static async get({fs:t,gitdir:n}){const r=await t.read(`${n}/config`,{encoding:"utf8"});return fD.from(r)}static async save({fs:t,gitdir:n,config:r}){await t.write(`${n}/config`,r.toString(),{encoding:"utf8"})}}const US=e=>[`${e}`,`refs/${e}`,`refs/tags/${e}`,`refs/heads/${e}`,`refs/remotes/${e}`,`refs/remotes/${e}/HEAD`],_Ce=["config","description","index","shallow","commondir"];let sI;async function Jf(e,t){return sI===void 0&&(sI=new mw),sI.acquire(e,t)}class Yt{static async updateRemoteRefs({fs:t,gitdir:n,remote:r,refs:s,symrefs:i,tags:a,refspecs:o=void 0,prune:l=!1,pruneTags:c=!1}){for(const v of s.values())if(!v.match(/[0-9a-f]{40}/))throw new Eh(v);const u=await Pi.get({fs:t,gitdir:n});if(!o){if(o=await u.getall(`remote.${r}.fetch`),o.length===0)throw new T1(r);o.unshift(`+HEAD:refs/remotes/${r}/HEAD`)}const d=dD.from(o),h=new Map;if(c){const v=await Yt.listRefs({fs:t,gitdir:n,filepath:"refs/tags"});await Yt.deleteRefs({fs:t,gitdir:n,refs:v.map(x=>`refs/tags/${x}`)})}if(a){for(const v of s.keys())if(v.startsWith("refs/tags")&&!v.endsWith("^{}")&&!await Yt.exists({fs:t,gitdir:n,ref:v})){const x=s.get(v);h.set(v,x)}}const m=d.translate([...s.keys()]);for(const[v,x]of m){const w=s.get(v);h.set(x,w)}const y=d.translate([...i.keys()]);for(const[v,x]of y){const w=i.get(v),S=d.translateOne(w);S&&h.set(x,`ref: ${S}`)}const b=[];if(l){for(const v of d.localNamespaces()){const x=(await Yt.listRefs({fs:t,gitdir:n,filepath:v})).map(w=>`${v}/${w}`);for(const w of x)h.has(w)||b.push(w)}b.length>0&&await Yt.deleteRefs({fs:t,gitdir:n,refs:b})}for(const[v,x]of h)await Jf(v,async()=>t.write($t.join(n,v),`${x.trim()}
`,"utf8"));return{pruned:b}}static async writeRef({fs:t,gitdir:n,ref:r,value:s}){if(!s.match(/[0-9a-f]{40}/))throw new Eh(s);await Jf(r,async()=>t.write($t.join(n,r),`${s.trim()}
`,"utf8"))}static async writeSymbolicRef({fs:t,gitdir:n,ref:r,value:s}){await Jf(r,async()=>t.write($t.join(n,r),`ref: ${s.trim()}
`,"utf8"))}static async deleteRef({fs:t,gitdir:n,ref:r}){return Yt.deleteRefs({fs:t,gitdir:n,refs:[r]})}static async deleteRefs({fs:t,gitdir:n,refs:r}){await Promise.all(r.map(o=>t.rm($t.join(n,o))));let s=await Jf("packed-refs",async()=>t.read(`${n}/packed-refs`,{encoding:"utf8"}));const i=YC.from(s),a=i.refs.size;for(const o of r)i.refs.has(o)&&i.delete(o);i.refs.size<a&&(s=i.toString(),await Jf("packed-refs",async()=>t.write(`${n}/packed-refs`,s,{encoding:"utf8"})))}static async resolve({fs:t,gitdir:n,ref:r,depth:s=void 0}){if(s!==void 0&&(s--,s===-1))return r;if(r.startsWith("ref: "))return r=r.slice(5),Yt.resolve({fs:t,gitdir:n,ref:r,depth:s});if(r.length===40&&/[0-9a-f]{40}/.test(r))return r;const i=await Yt.packedRefs({fs:t,gitdir:n}),a=US(r).filter(o=>!_Ce.includes(o));for(const o of a){const l=await Jf(o,async()=>await t.read(`${n}/${o}`,{encoding:"utf8"})||i.get(o));if(l)return Yt.resolve({fs:t,gitdir:n,ref:l.trim(),depth:s})}throw new As(r)}static async exists({fs:t,gitdir:n,ref:r}){try{return await Yt.expand({fs:t,gitdir:n,ref:r}),!0}catch{return!1}}static async expand({fs:t,gitdir:n,ref:r}){if(r.length===40&&/[0-9a-f]{40}/.test(r))return r;const s=await Yt.packedRefs({fs:t,gitdir:n}),i=US(r);for(const a of i)if(await Jf(a,async()=>t.exists(`${n}/${a}`))||s.has(a))return a;throw new As(r)}static async expandAgainstMap({ref:t,map:n}){const r=US(t);for(const s of r)if(await n.has(s))return s;throw new As(t)}static resolveAgainstMap({ref:t,fullref:n=t,depth:r=void 0,map:s}){if(r!==void 0&&(r--,r===-1))return{fullref:n,oid:t};if(t.startsWith("ref: "))return t=t.slice(5),Yt.resolveAgainstMap({ref:t,fullref:n,depth:r,map:s});if(t.length===40&&/[0-9a-f]{40}/.test(t))return{fullref:n,oid:t};const i=US(t);for(const a of i){const o=s.get(a);if(o)return Yt.resolveAgainstMap({ref:o.trim(),fullref:a,depth:r,map:s})}throw new As(t)}static async packedRefs({fs:t,gitdir:n}){const r=await Jf("packed-refs",async()=>t.read(`${n}/packed-refs`,{encoding:"utf8"}));return YC.from(r).refs}static async listRefs({fs:t,gitdir:n,filepath:r}){const s=Yt.packedRefs({fs:t,gitdir:n});let i=null;try{i=await t.readdirDeep(`${n}/${r}`),i=i.map(a=>a.replace(`${n}/${r}/`,""))}catch{i=[]}for(let a of(await s).keys())a.startsWith(r)&&(a=a.replace(r+"/",""),i.includes(a)||i.push(a));return i.sort(uCe),i}static async listBranches({fs:t,gitdir:n,remote:r}){return r?Yt.listRefs({fs:t,gitdir:n,filepath:`refs/remotes/${r}`}):Yt.listRefs({fs:t,gitdir:n,filepath:"refs/heads"})}static async listTags({fs:t,gitdir:n}){return(await Yt.listRefs({fs:t,gitdir:n,filepath:"refs/tags"})).filter(s=>!s.endsWith("^{}"))}}function SCe(e,t){return nT(fz(e),fz(t))}function fz(e){return e.mode==="040000"?e.path+"/":e.path}function $Y(e){switch(e){case"040000":return"tree";case"100644":return"blob";case"100755":return"blob";case"120000":return"blob";case"160000":return"commit"}throw new vr(`Unexpected GitTree entry mode: ${e}`)}function CCe(e){const t=[];let n=0;for(;n<e.length;){const r=e.indexOf(32,n);if(r===-1)throw new vr(`GitTree: Error parsing buffer at byte location ${n}: Could not find the next space character.`);const s=e.indexOf(0,n);if(s===-1)throw new vr(`GitTree: Error parsing buffer at byte location ${n}: Could not find the next null character.`);let i=e.slice(n,r).toString("utf8");i==="40000"&&(i="040000");const a=$Y(i),o=e.slice(r+1,s).toString("utf8");if(o.includes("\\")||o.includes("/"))throw new tb(o);const l=e.slice(s+1,s+21).toString("hex");n=s+21,t.push({mode:i,path:o,oid:l,type:a})}return t}function kCe(e){if(typeof e=="number"&&(e=e.toString(8)),e.match(/^0?4.*/))return"040000";if(e.match(/^1006.*/))return"100644";if(e.match(/^1007.*/))return"100755";if(e.match(/^120.*/))return"120000";if(e.match(/^160.*/))return"160000";throw new vr(`Could not understand file mode: ${e}`)}function ECe(e){return!e.oid&&e.sha&&(e.oid=e.sha),e.mode=kCe(e.mode),e.type||(e.type=$Y(e.mode)),e}class Lo{constructor(t){if(ln.isBuffer(t))this._entries=CCe(t);else if(Array.isArray(t))this._entries=t.map(ECe);else throw new vr("invalid type passed to GitTree constructor");this._entries.sort(DY)}static from(t){return new Lo(t)}render(){return this._entries.map(t=>`${t.mode} ${t.type} ${t.oid}    ${t.path}`).join(`
`)}toObject(){const t=[...this._entries];return t.sort(SCe),ln.concat(t.map(n=>{const r=ln.from(n.mode.replace(/^0/,"")),s=ln.from(" "),i=ln.from(n.path,"utf8"),a=ln.from([0]),o=ln.from(n.oid,"hex");return ln.concat([r,s,i,a,o])}))}entries(){return this._entries}*[Symbol.iterator](){for(const t of this._entries)yield t}}class rb{static wrap({type:t,object:n}){return ln.concat([ln.from(`${t} ${n.byteLength.toString()}\0`),ln.from(n)])}static unwrap(t){const n=t.indexOf(32),r=t.indexOf(0),s=t.slice(0,n).toString("utf8"),i=t.slice(n+1,r).toString("utf8"),a=t.length-(r+1);if(parseInt(i)!==a)throw new vr(`Length mismatch: expected ${i} bytes but got ${a} instead.`);return{type:s,object:ln.from(t.slice(r+1))}}}async function zY({fs:e,gitdir:t,oid:n}){const r=`objects/${n.slice(0,2)}/${n.slice(2)}`,s=await e.read(`${t}/${r}`);return s?{object:s,format:"deflated",source:r}:null}function TCe(e,t){const n=new yu(e),r=hz(n);if(r!==t.byteLength)throw new vr(`applyDelta expected source buffer to be ${r} bytes but the provided buffer was ${t.length} bytes`);const s=hz(n);let i;const a=mz(n,t);if(a.byteLength===s)i=a;else{i=ln.alloc(s);const o=new yu(i);for(o.copy(a);!n.eof();)o.copy(mz(n,t));const l=o.tell();if(s!==l)throw new vr(`applyDelta expected target buffer to be ${s} bytes but the resulting buffer was ${l} bytes`)}return i}function hz(e){let t=0,n=0,r=null;do r=e.readUInt8(),t|=(r&127)<<n,n+=7;while(r&128);return t}function pz(e,t,n){let r=0,s=0;for(;n--;)t&1&&(r|=e.readUInt8()<<s),t>>=1,s+=8;return r}function mz(e,t){const n=e.readUInt8(),r=128,s=15,i=112;if(n&r){const a=pz(e,n&s,4);let o=pz(e,(n&i)>>4,3);return o===0&&(o=65536),t.slice(a,a+o)}else return e.slice(n)}function ACe(e){let t=[e];return{next(){return Promise.resolve({done:t.length===0,value:t.pop()})},return(){return t=[],{}},[Symbol.asyncIterator](){return this}}}function UY(e){return e[Symbol.asyncIterator]?e[Symbol.asyncIterator]():e[Symbol.iterator]?e[Symbol.iterator]():e.next?e:ACe(e)}class qY{constructor(t){if(typeof ln>"u")throw new Error("Missing Buffer dependency");this.stream=UY(t),this.buffer=null,this.cursor=0,this.undoCursor=0,this.started=!1,this._ended=!1,this._discardedBytes=0}eof(){return this._ended&&this.cursor===this.buffer.length}tell(){return this._discardedBytes+this.cursor}async byte(){if(!this.eof()&&(this.started||await this._init(),!(this.cursor===this.buffer.length&&(await this._loadnext(),this._ended))))return this._moveCursor(1),this.buffer[this.undoCursor]}async chunk(){if(!this.eof()&&(this.started||await this._init(),!(this.cursor===this.buffer.length&&(await this._loadnext(),this._ended))))return this._moveCursor(this.buffer.length),this.buffer.slice(this.undoCursor,this.cursor)}async read(t){if(!this.eof())return this.started||await this._init(),this.cursor+t>this.buffer.length&&(this._trim(),await this._accumulate(t)),this._moveCursor(t),this.buffer.slice(this.undoCursor,this.cursor)}async skip(t){this.eof()||(this.started||await this._init(),this.cursor+t>this.buffer.length&&(this._trim(),await this._accumulate(t)),this._moveCursor(t))}async undo(){this.cursor=this.undoCursor}async _next(){this.started=!0;let{done:t,value:n}=await this.stream.next();return t&&(this._ended=!0,!n)?ln.alloc(0):(n&&(n=ln.from(n)),n)}_trim(){this.buffer=this.buffer.slice(this.undoCursor),this.cursor-=this.undoCursor,this._discardedBytes+=this.undoCursor,this.undoCursor=0}_moveCursor(t){this.undoCursor=this.cursor,this.cursor+=t,this.cursor>this.buffer.length&&(this.cursor=this.buffer.length)}async _accumulate(t){if(this._ended)return;const n=[this.buffer];for(;this.cursor+t>RCe(n);){const r=await this._next();if(this._ended)break;n.push(r)}this.buffer=ln.concat(n)}async _loadnext(){this._discardedBytes+=this.buffer.length,this.undoCursor=0,this.cursor=0,this.buffer=await this._next()}async _init(){this.buffer=await this._next()}}function RCe(e){return e.reduce((t,n)=>t+n.length,0)}async function NCe(e,t){const n=new qY(e);let r=await n.read(4);if(r=r.toString("utf8"),r!=="PACK")throw new vr(`Invalid PACK header '${r}'`);let s=await n.read(4);if(s=s.readUInt32BE(0),s!==2)throw new vr(`Invalid packfile version: ${s}`);let i=await n.read(4);if(i=i.readUInt32BE(0),!(i<1))for(;!n.eof()&&i--;){const a=n.tell(),{type:o,length:l,ofs:c,reference:u}=await MCe(n),d=new uD.Inflate;for(;!d.result;){const h=await n.chunk();if(!h)break;if(d.push(h,!1),d.err)throw new vr(`Pako error: ${d.msg}`);if(d.result){if(d.result.length!==l)throw new vr("Inflated object size is different from that stated in packfile.");await n.undo(),await n.read(h.length-d.strm.avail_in);const m=n.tell();await t({data:d.result,type:o,num:i,offset:a,end:m,reference:u,ofs:c})}}}}async function MCe(e){let t=await e.byte();const n=t>>4&7;let r=t&15;if(t&128){let a=4;do t=await e.byte(),r|=(t&127)<<a,a+=7;while(t&128)}let s,i;if(n===6){let a=0;s=0;const o=[];do t=await e.byte(),s|=(t&127)<<a,a+=7,o.push(t);while(t&128);i=ln.from(o)}return n===7&&(i=await e.read(20)),{type:n,length:r,ofs:s,reference:i}}async function VY(e){return uD.inflate(e)}function ICe(e){const t=[];let n=0,r=0;do{n=e.readUInt8();const s=n&127;t.push(s),r=n&128}while(r);return t.reduce((s,i)=>s+1<<7|i,-1)}function jCe(e,t){let n=t,r=4,s=null;do s=e.readUInt8(),n|=(s&127)<<r,r+=7;while(s&128);return n}class fy{constructor(t){Object.assign(this,t),this.offsetCache={}}static async fromIdx({idx:t,getExternalRefDelta:n}){const r=new yu(t);if(r.slice(4).toString("hex")!=="ff744f63")return;const i=r.readUInt32BE();if(i!==2)throw new vr(`Unable to read version ${i} packfile IDX. (Only version 2 supported)`);if(t.byteLength>2048*1024*1024)throw new vr("To keep implementation simple, I haven't implemented the layer 5 feature needed to support packfiles > 2GB in size.");r.seek(r.tell()+4*255);const a=r.readUInt32BE(),o=[];for(let u=0;u<a;u++){const d=r.slice(20).toString("hex");o[u]=d}r.seek(r.tell()+4*a);const l=new Map;for(let u=0;u<a;u++)l.set(o[u],r.readUInt32BE());const c=r.slice(20).toString("hex");return new fy({hashes:o,crcs:{},offsets:l,packfileSha:c,getExternalRefDelta:n})}static async fromPack({pack:t,getExternalRefDelta:n,onProgress:r}){const s={1:"commit",2:"tree",3:"blob",4:"tag",6:"ofs-delta",7:"ref-delta"},i={},a=t.slice(-20).toString("hex"),o=[],l={},c=new Map;let u=null,d=null;await NCe([t],async({data:v,type:x,reference:w,offset:S,num:k})=>{u===null&&(u=k);const C=Math.floor((u-k)*100/u);C!==d&&r&&await r({phase:"Receiving objects",loaded:u-k,total:u}),d=C,x=s[x],["commit","tree","blob","tag"].includes(x)?i[S]={type:x,offset:S}:x==="ofs-delta"?i[S]={type:x,offset:S}:x==="ref-delta"&&(i[S]={type:x,offset:S})});const h=Object.keys(i).map(Number);for(const[v,x]of h.entries()){const w=v+1===h.length?t.byteLength-20:h[v+1],S=i[x],k=I2e.buf(t.slice(x,w))>>>0;S.end=w,S.crc=k}const m=new fy({pack:Promise.resolve(t),packfileSha:a,crcs:l,hashes:o,offsets:c,getExternalRefDelta:n});d=null;let y=0;const b=[0,0,0,0,0,0,0,0,0,0,0,0];for(let v in i){v=Number(v);const x=Math.floor(y*100/u);x!==d&&r&&await r({phase:"Resolving deltas",loaded:y,total:u}),y++,d=x;const w=i[v];if(!w.oid)try{m.readDepth=0,m.externalReadDepth=0;const{type:S,object:k}=await m.readSlice({start:v});b[m.readDepth]+=1;const C=await Xd(rb.wrap({type:S,object:k}));w.oid=C,o.push(C),c.set(C,v),l[C]=w.crc}catch{continue}}return o.sort(),m}async toBuffer(){const t=[],n=(c,u)=>{t.push(ln.from(c,u))};n("ff744f63","hex"),n("00000002","hex");const r=new yu(ln.alloc(256*4));for(let c=0;c<256;c++){let u=0;for(const d of this.hashes)parseInt(d.slice(0,2),16)<=c&&u++;r.writeUInt32BE(u)}t.push(r.buffer);for(const c of this.hashes)n(c,"hex");const s=new yu(ln.alloc(this.hashes.length*4));for(const c of this.hashes)s.writeUInt32BE(this.crcs[c]);t.push(s.buffer);const i=new yu(ln.alloc(this.hashes.length*4));for(const c of this.hashes)i.writeUInt32BE(this.offsets.get(c));t.push(i.buffer),n(this.packfileSha,"hex");const a=ln.concat(t),o=await Xd(a),l=ln.alloc(20);return l.write(o,"hex"),ln.concat([a,l])}async load({pack:t}){this.pack=t}async unload(){this.pack=null}async read({oid:t}){if(!this.offsets.get(t)){if(this.getExternalRefDelta)return this.externalReadDepth++,this.getExternalRefDelta(t);throw new vr(`Could not read object ${t} from packfile`)}const n=this.offsets.get(t);return this.readSlice({start:n})}async readSlice({start:t}){if(this.offsetCache[t])return Object.assign({},this.offsetCache[t]);this.readDepth++;const n={16:"commit",32:"tree",48:"blob",64:"tag",96:"ofs_delta",112:"ref_delta"};if(!this.pack)throw new vr("Tried to read from a GitPackIndex with no packfile loaded into memory");const r=(await this.pack).slice(t),s=new yu(r),i=s.readUInt8(),a=i&112;let o=n[a];if(o===void 0)throw new vr("Unrecognized type: 0b"+a.toString(2));const l=i&15;let c=l;i&128&&(c=jCe(s,l));let d=null,h=null;if(o==="ofs_delta"){const y=ICe(s),b=t-y;({object:d,type:o}=await this.readSlice({start:b}))}if(o==="ref_delta"){const y=s.slice(20).toString("hex");({object:d,type:o}=await this.read({oid:y}))}const m=r.slice(s.tell());if(h=ln.from(await VY(m)),h.byteLength!==c)throw new vr(`Packfile told us object would have length ${c} but it had length ${h.byteLength}`);return d&&(h=ln.from(TCe(h,d))),this.readDepth>3&&(this.offsetCache[t]={type:o,object:h}),{type:o,format:"content",object:h}}}const qS=Symbol("PackfileCache");async function OCe({fs:e,filename:t,getExternalRefDelta:n,emitter:r,emitterPrefix:s}){const i=await e.read(t);return fy.fromIdx({idx:i,getExternalRefDelta:n})}function hD({fs:e,cache:t,filename:n,getExternalRefDelta:r,emitter:s,emitterPrefix:i}){t[qS]||(t[qS]=new Map);let a=t[qS].get(n);return a||(a=OCe({fs:e,filename:n,getExternalRefDelta:r,emitter:s,emitterPrefix:i}),t[qS].set(n,a)),a}async function PCe({fs:e,cache:t,gitdir:n,oid:r,format:s="content",getExternalRefDelta:i}){let a=await e.readdir($t.join(n,"objects/pack"));a=a.filter(o=>o.endsWith(".idx"));for(const o of a){const l=`${n}/objects/pack/${o}`,c=await hD({fs:e,cache:t,filename:l,getExternalRefDelta:i});if(c.error)throw new vr(c.error);if(c.offsets.has(r)){if(!c.pack){const d=l.replace(/idx$/,"pack");c.pack=e.read(d)}const u=await c.read({oid:r,getExternalRefDelta:i});return u.format="content",u.source=`objects/pack/${o.replace(/idx$/,"pack")}`,u}}return null}async function Xs({fs:e,cache:t,gitdir:n,oid:r,format:s="content"}){const i=u=>Xs({fs:e,cache:t,gitdir:n,oid:u});let a;if(r==="4b825dc642cb6eb9a060e54bf8d69288fbee4904"&&(a={format:"wrapped",object:ln.from("tree 0\0")}),a||(a=await zY({fs:e,gitdir:n,oid:r})),!a){if(a=await PCe({fs:e,cache:t,gitdir:n,oid:r,getExternalRefDelta:i}),!a)throw new As(r);return a}if(s==="deflated"||(a.format==="deflated"&&(a.object=ln.from(await VY(a.object)),a.format="wrapped"),s==="wrapped"))return a;const o=await Xd(a.object);if(o!==r)throw new vr(`SHA check failed! Expected ${r}, computed ${o}`);const{object:l,type:c}=rb.unwrap(a.object);if(a.type=c,a.object=l,a.format="content",s==="content")return a;throw new vr(`invalid requested format "${s}"`)}class qc extends Jr{constructor(t,n,r=!0){super(`Failed to create ${t} at ${n} because it already exists.${r?` (Hint: use 'force: true' parameter to overwrite existing ${t}.)`:""}`),this.code=this.name=qc.code,this.data={noun:t,where:n,canForce:r}}}qc.code="AlreadyExistsError";class A1 extends Jr{constructor(t,n,r){super(`Found multiple ${t} matching "${n}" (${r.join(", ")}). Use a longer abbreviation length to disambiguate them.`),this.code=this.name=A1.code,this.data={nouns:t,short:n,matches:r}}}A1.code="AmbiguousError";class R1 extends Jr{constructor(t){super(`Your local changes to the following files would be overwritten by checkout: ${t.join(", ")}`),this.code=this.name=R1.code,this.data={filepaths:t}}}R1.code="CheckoutConflictError";class N1 extends Jr{constructor(t,n){super(`Failed to checkout "${t}" because commit ${n} is not available locally. Do a git fetch to make the branch available locally.`),this.code=this.name=N1.code,this.data={ref:t,oid:n}}}N1.code="CommitNotFetchedError";class M1 extends Jr{constructor(){super("Empty response from git server."),this.code=this.name=M1.code,this.data={}}}M1.code="EmptyServerResponseError";class I1 extends Jr{constructor(){super("A simple fast-forward merge was not possible."),this.code=this.name=I1.code,this.data={}}}I1.code="FastForwardError";class j1 extends Jr{constructor(t,n){super(`One or more branches were not updated: ${t}`),this.code=this.name=j1.code,this.data={prettyDetails:t,result:n}}}j1.code="GitPushError";class hy extends Jr{constructor(t,n,r){super(`HTTP Error: ${t} ${n}`),this.code=this.name=hy.code,this.data={statusCode:t,statusMessage:n,response:r}}}hy.code="HttpError";class Th extends Jr{constructor(t){let n="invalid filepath";t==="leading-slash"||t==="trailing-slash"?n='"filepath" parameter should not include leading or trailing directory separators because these can cause problems on some platforms.':t==="directory"&&(n='"filepath" should not be a directory.'),super(n),this.code=this.name=Th.code,this.data={reason:t}}}Th.code="InvalidFilepathError";class Bc extends Jr{constructor(t,n){super(`"${t}" would be an invalid git reference. (Hint: a valid alternative would be "${n}".)`),this.code=this.name=Bc.code,this.data={ref:t,suggestion:n}}}Bc.code="InvalidRefNameError";class O1 extends Jr{constructor(t){super(`Maximum search depth of ${t} exceeded.`),this.code=this.name=O1.code,this.data={depth:t}}}O1.code="MaxDepthError";class sb extends Jr{constructor(){super("Merges with conflicts are not supported yet."),this.code=this.name=sb.code,this.data={}}}sb.code="MergeNotSupportedError";class ib extends Jr{constructor(t,n,r,s){super(`Automatic merge failed with one or more merge conflicts in the following files: ${t.toString()}. Fix conflicts then commit the result.`),this.code=this.name=ib.code,this.data={filepaths:t,bothModified:n,deleteByUs:r,deleteByTheirs:s}}}ib.code="MergeConflictError";class za extends Jr{constructor(t){super(`No name was provided for ${t} in the argument or in the .git/config file.`),this.code=this.name=za.code,this.data={role:t}}}za.code="MissingNameError";class jo extends Jr{constructor(t){super(`The function requires a "${t}" parameter but none was provided.`),this.code=this.name=jo.code,this.data={parameter:t}}}jo.code="MissingParameterError";class P1 extends Jr{constructor(t){super('There are multiple errors that were thrown by the method. Please refer to the "errors" property to see more'),this.code=this.name=P1.code,this.data={errors:t},this.errors=t}}P1.code="MultipleGitError";class Qm extends Jr{constructor(t,n){super(`Expected "${t}" but received "${n}".`),this.code=this.name=Qm.code,this.data={expected:t,actual:n}}}Qm.code="ParseError";class py extends Jr{constructor(t){let n="";t==="not-fast-forward"?n=" because it was not a simple fast-forward":t==="tag-exists"&&(n=" because tag already exists"),super(`Push rejected${n}. Use "force: true" to override.`),this.code=this.name=py.code,this.data={reason:t}}}py.code="PushRejectedError";class dh extends Jr{constructor(t,n){super(`Remote does not support the "${t}" so the "${n}" parameter cannot be used.`),this.code=this.name=dh.code,this.data={capability:t,parameter:n}}}dh.code="RemoteCapabilityError";class D1 extends Jr{constructor(t,n){super(`Remote did not reply using the "smart" HTTP protocol. Expected "001e# service=git-upload-pack" but received: ${t}`),this.code=this.name=D1.code,this.data={preview:t,response:n}}}D1.code="SmartHttpError";class F1 extends Jr{constructor(t,n,r){super(`Git remote "${t}" uses an unrecognized transport protocol: "${n}"`),this.code=this.name=F1.code,this.data={url:t,transport:n,suggestion:r}}}F1.code="UnknownTransportError";class L1 extends Jr{constructor(t){super(`Cannot parse remote URL: "${t}"`),this.code=this.name=L1.code,this.data={url:t}}}L1.code="UrlParseError";class ab extends Jr{constructor(){super("The operation was canceled."),this.code=this.name=ab.code,this.data={}}}ab.code="UserCanceledError";class B1 extends Jr{constructor(t){super(`Could not merge index: Entry for '${t}' is not up to date. Either reset the index entry to HEAD, or stage your unstaged changes.`),this.code=this.name=B1.code,this.data={filepath:t}}}B1.code="IndexResetError";class $1 extends Jr{constructor(t){super(`"${t}" does not point to any commit. You're maybe working on a repository with no commits yet. `),this.code=this.name=$1.code,this.data={ref:t}}}$1.code="NoCommitError";var DCe=Object.freeze({__proto__:null,AlreadyExistsError:qc,AmbiguousError:A1,CheckoutConflictError:R1,CommitNotFetchedError:N1,EmptyServerResponseError:M1,FastForwardError:I1,GitPushError:j1,HttpError:hy,InternalError:vr,InvalidFilepathError:Th,InvalidOidError:Eh,InvalidRefNameError:Bc,MaxDepthError:O1,MergeNotSupportedError:sb,MergeConflictError:ib,MissingNameError:za,MissingParameterError:jo,MultipleGitError:P1,NoRefspecError:T1,NotFoundError:As,ObjectTypeError:ho,ParseError:Qm,PushRejectedError:py,RemoteCapabilityError:dh,SmartHttpError:D1,UnknownTransportError:F1,UnsafeFilepathError:tb,UrlParseError:L1,UserCanceledError:ab,UnmergedPathsError:E1,IndexResetError:B1,NoCommitError:$1});function Pj({name:e,email:t,timestamp:n,timezoneOffset:r}){return r=FCe(r),`${e} <${t}> ${n} ${r}`}function FCe(e){const t=LCe(BCe(e));e=Math.abs(e);const n=Math.floor(e/60);e-=n*60;let r=String(n),s=String(e);return r.length<2&&(r="0"+r),s.length<2&&(s="0"+s),(t===-1?"-":"+")+r+s}function LCe(e){return Math.sign(e)||(Object.is(e,-0)?-1:1)}function BCe(e){return e===0?e:-e}function Td(e){return e=e.replace(/\r/g,""),e=e.replace(/^\n+/,""),e=e.replace(/\n+$/,"")+`
`,e}function XC(e){const[,t,n,r,s]=e.match(/^(.*) <(.*)> (.*) (.*)$/);return{name:t,email:n,timestamp:Number(r),timezoneOffset:$Ce(s)}}function $Ce(e){let[,t,n,r]=e.match(/(\+|-)(\d\d)(\d\d)/);return r=(t==="+"?1:-1)*(Number(n)*60+Number(r)),zCe(r)}function zCe(e){return e===0?e:-e}class so{constructor(t){if(typeof t=="string")this._tag=t;else if(ln.isBuffer(t))this._tag=t.toString("utf8");else if(typeof t=="object")this._tag=so.render(t);else throw new vr("invalid type passed to GitAnnotatedTag constructor")}static from(t){return new so(t)}static render(t){return`object ${t.object}
type ${t.type}
tag ${t.tag}
tagger ${Pj(t.tagger)}

${t.message}
${t.gpgsig?t.gpgsig:""}`}justHeaders(){return this._tag.slice(0,this._tag.indexOf(`

`))}message(){const t=this.withoutSignature();return t.slice(t.indexOf(`

`)+2)}parse(){return Object.assign(this.headers(),{message:this.message(),gpgsig:this.gpgsig()})}render(){return this._tag}headers(){const t=this.justHeaders().split(`
`),n=[];for(const s of t)s[0]===" "?n[n.length-1]+=`
`+s.slice(1):n.push(s);const r={};for(const s of n){const i=s.slice(0,s.indexOf(" ")),a=s.slice(s.indexOf(" ")+1);Array.isArray(r[i])?r[i].push(a):r[i]=a}return r.tagger&&(r.tagger=XC(r.tagger)),r.committer&&(r.committer=XC(r.committer)),r}withoutSignature(){const t=Td(this._tag);return t.indexOf(`
-----BEGIN PGP SIGNATURE-----`)===-1?t:t.slice(0,t.lastIndexOf(`
-----BEGIN PGP SIGNATURE-----`))}gpgsig(){if(this._tag.indexOf(`
-----BEGIN PGP SIGNATURE-----`)===-1)return;const t=this._tag.slice(this._tag.indexOf("-----BEGIN PGP SIGNATURE-----"),this._tag.indexOf("-----END PGP SIGNATURE-----")+27);return Td(t)}payload(){return this.withoutSignature()+`
`}toObject(){return ln.from(this._tag,"utf8")}static async sign(t,n,r){const s=t.payload();let{signature:i}=await n({payload:s,secretKey:r});i=Td(i);const a=s+i;return so.from(a)}}function iI(e){return e.trim().split(`
`).map(t=>" "+t).join(`
`)+`
`}function UCe(e){return e.split(`
`).map(t=>t.replace(/^ /,"")).join(`
`)}class Zs{constructor(t){if(typeof t=="string")this._commit=t;else if(ln.isBuffer(t))this._commit=t.toString("utf8");else if(typeof t=="object")this._commit=Zs.render(t);else throw new vr("invalid type passed to GitCommit constructor")}static fromPayloadSignature({payload:t,signature:n}){const r=Zs.justHeaders(t),s=Zs.justMessage(t),i=Td(r+`
gpgsig`+iI(n)+`
`+s);return new Zs(i)}static from(t){return new Zs(t)}toObject(){return ln.from(this._commit,"utf8")}headers(){return this.parseHeaders()}message(){return Zs.justMessage(this._commit)}parse(){return Object.assign({message:this.message()},this.headers())}static justMessage(t){return Td(t.slice(t.indexOf(`

`)+2))}static justHeaders(t){return t.slice(0,t.indexOf(`

`))}parseHeaders(){const t=Zs.justHeaders(this._commit).split(`
`),n=[];for(const s of t)s[0]===" "?n[n.length-1]+=`
`+s.slice(1):n.push(s);const r={parent:[]};for(const s of n){const i=s.slice(0,s.indexOf(" ")),a=s.slice(s.indexOf(" ")+1);Array.isArray(r[i])?r[i].push(a):r[i]=a}return r.author&&(r.author=XC(r.author)),r.committer&&(r.committer=XC(r.committer)),r}static renderHeaders(t){let n="";if(t.tree?n+=`tree ${t.tree}
`:n+=`tree 4b825dc642cb6eb9a060e54bf8d69288fbee4904
`,t.parent){if(t.parent.length===void 0)throw new vr("commit 'parent' property should be an array");for(const i of t.parent)n+=`parent ${i}
`}const r=t.author;n+=`author ${Pj(r)}
`;const s=t.committer||t.author;return n+=`committer ${Pj(s)}
`,t.gpgsig&&(n+="gpgsig"+iI(t.gpgsig)),n}static render(t){return Zs.renderHeaders(t)+`
`+Td(t.message)}render(){return this._commit}withoutSignature(){const t=Td(this._commit);if(t.indexOf(`
gpgsig`)===-1)return t;const n=t.slice(0,t.indexOf(`
gpgsig`)),r=t.slice(t.indexOf(`-----END PGP SIGNATURE-----
`)+28);return Td(n+`
`+r)}isolateSignature(){const t=this._commit.slice(this._commit.indexOf("-----BEGIN PGP SIGNATURE-----"),this._commit.indexOf("-----END PGP SIGNATURE-----")+27);return UCe(t)}static async sign(t,n,r){const s=t.withoutSignature(),i=Zs.justMessage(t._commit);let{signature:a}=await n({payload:s,secretKey:r});a=Td(a);const l=Zs.justHeaders(t._commit)+`
gpgsig`+iI(a)+`
`+i;return Zs.from(l)}}async function my({fs:e,cache:t,gitdir:n,oid:r}){if(r==="4b825dc642cb6eb9a060e54bf8d69288fbee4904")return{tree:Lo.from([]),oid:r};const{type:s,object:i}=await Xs({fs:e,cache:t,gitdir:n,oid:r});if(s==="tag")return r=so.from(i).parse().object,my({fs:e,cache:t,gitdir:n,oid:r});if(s==="commit")return r=Zs.from(i).parse().tree,my({fs:e,cache:t,gitdir:n,oid:r});if(s!=="tree")throw new ho(r,s,"tree");return{tree:Lo.from(i),oid:r}}class qCe{constructor({fs:t,gitdir:n,ref:r,cache:s}){this.fs=t,this.cache=s,this.gitdir=n,this.mapPromise=(async()=>{const a=new Map;let o;try{o=await Yt.resolve({fs:t,gitdir:n,ref:r})}catch(c){c instanceof As&&(o="4b825dc642cb6eb9a060e54bf8d69288fbee4904")}const l=await my({fs:t,cache:this.cache,gitdir:n,oid:o});return l.type="tree",l.mode="40000",a.set(".",l),a})();const i=this;this.ConstructEntry=class{constructor(o){this._fullpath=o,this._type=!1,this._mode=!1,this._stat=!1,this._content=!1,this._oid=!1}async type(){return i.type(this)}async mode(){return i.mode(this)}async stat(){return i.stat(this)}async content(){return i.content(this)}async oid(){return i.oid(this)}}}async readdir(t){const n=t._fullpath,{fs:r,cache:s,gitdir:i}=this,a=await this.mapPromise,o=a.get(n);if(!o)throw new Error(`No obj for ${n}`);const l=o.oid;if(!l)throw new Error(`No oid for obj ${JSON.stringify(o)}`);if(o.type!=="tree")return null;const{type:c,object:u}=await Xs({fs:r,cache:s,gitdir:i,oid:l});if(c!==o.type)throw new ho(l,c,o.type);const d=Lo.from(u);for(const h of d)a.set($t.join(n,h.path),h);return d.entries().map(h=>$t.join(n,h.path))}async type(t){if(t._type===!1){const n=await this.mapPromise,{type:r}=n.get(t._fullpath);t._type=r}return t._type}async mode(t){if(t._mode===!1){const n=await this.mapPromise,{mode:r}=n.get(t._fullpath);t._mode=FY(parseInt(r,8))}return t._mode}async stat(t){}async content(t){if(t._content===!1){const n=await this.mapPromise,{fs:r,cache:s,gitdir:i}=this,o=n.get(t._fullpath).oid,{type:l,object:c}=await Xs({fs:r,cache:s,gitdir:i,oid:o});l!=="blob"?t._content=void 0:t._content=new Uint8Array(c)}return t._content}async oid(t){if(t._oid===!1){const r=(await this.mapPromise).get(t._fullpath);t._oid=r.oid}return t._oid}}function Wl({ref:e="HEAD"}={}){const t=Object.create(null);return Object.defineProperty(t,rT,{value:function({fs:n,gitdir:r,cache:s}){return new qCe({fs:n,gitdir:r,ref:e,cache:s})}}),Object.freeze(t),t}class VCe{constructor({fs:t,dir:n,gitdir:r,cache:s}){this.fs=t,this.cache=s,this.dir=n,this.gitdir=r,this.config=null;const i=this;this.ConstructEntry=class{constructor(o){this._fullpath=o,this._type=!1,this._mode=!1,this._stat=!1,this._content=!1,this._oid=!1}async type(){return i.type(this)}async mode(){return i.mode(this)}async stat(){return i.stat(this)}async content(){return i.content(this)}async oid(){return i.oid(this)}}}async readdir(t){const n=t._fullpath,{fs:r,dir:s}=this,i=await r.readdir($t.join(s,n));return i===null?null:i.map(a=>$t.join(n,a))}async type(t){return t._type===!1&&await t.stat(),t._type}async mode(t){return t._mode===!1&&await t.stat(),t._mode}async stat(t){if(t._stat===!1){const{fs:n,dir:r}=this;let s=await n.lstat(`${r}/${t._fullpath}`);if(!s)throw new Error(`ENOENT: no such file or directory, lstat '${t._fullpath}'`);let i=s.isDirectory()?"tree":"blob";i==="blob"&&!s.isFile()&&!s.isSymbolicLink()&&(i="special"),t._type=i,s=uy(s),t._mode=s.mode,s.size===-1&&t._actualSize&&(s.size=t._actualSize),t._stat=s}return t._stat}async content(t){if(t._content===!1){const{fs:n,dir:r,gitdir:s}=this;if(await t.type()==="tree")t._content=void 0;else{const a=await(await this._getGitConfig(n,s)).get("core.autocrlf"),o=await n.read(`${r}/${t._fullpath}`,{autocrlf:a});t._actualSize=o.length,t._stat&&t._stat.size===-1&&(t._stat.size=t._actualSize),t._content=new Uint8Array(o)}}return t._content}async oid(t){if(t._oid===!1){const n=this,{fs:r,gitdir:s,cache:i}=this;let a;await ca.acquire({fs:r,gitdir:s,cache:i},async function(o){const l=o.entriesMap.get(t._fullpath),c=await t.stat(),d=await(await n._getGitConfig(r,s)).get("core.filemode"),h=typeof Mi<"u"?Mi.platform!=="win32":!0;if(!l||GC(c,l,d,h)){const m=await t.content();m===void 0?a=void 0:(a=await Xd(rb.wrap({type:"blob",object:m})),l&&a===l.oid&&(!d||c.mode===l.mode)&&GC(c,l,d,h)&&o.insert({filepath:t._fullpath,stats:c,oid:a}))}else a=l.oid}),t._oid=a}return t._oid}async _getGitConfig(t,n){return this.config?this.config:(this.config=await Pi.get({fs:t,gitdir:n}),this.config)}}function z1(){const e=Object.create(null);return Object.defineProperty(e,rT,{value:function({fs:t,dir:n,gitdir:r,cache:s}){return new VCe({fs:t,dir:n,gitdir:r,cache:s})}}),Object.freeze(e),e}function WCe(e,t){const n=t-e;return Array.from({length:n},(r,s)=>e+s)}const WY=typeof Array.prototype.flat>"u"?e=>e.reduce((t,n)=>t.concat(n),[]):e=>e.flat();class HCe{constructor(){this.value=null}consider(t){t!=null&&(this.value===null?this.value=t:t<this.value&&(this.value=t))}reset(){this.value=null}}function*GCe(e){const t=new HCe;let n;const r=[],s=e.length;for(let i=0;i<s;i++)r[i]=e[i].next().value,r[i]!==void 0&&t.consider(r[i]);if(t.value!==null)for(;;){const i=[];n=t.value,t.reset();for(let a=0;a<s;a++)r[a]!==void 0&&r[a]===n?(i[a]=r[a],r[a]=e[a].next().value):i[a]=null,r[a]!==void 0&&t.consider(r[a]);if(yield i,t.value===null)return}}async function Ah({fs:e,cache:t,dir:n,gitdir:r,trees:s,map:i=async(l,c)=>c,reduce:a=async(l,c)=>{const u=WY(c);return l!==void 0&&u.unshift(l),u},iterate:o=(l,c)=>Promise.all([...c].map(l))}){const l=s.map(m=>m[rT]({fs:e,dir:n,gitdir:r,cache:t})),c=new Array(l.length).fill("."),u=WCe(0,l.length),d=async m=>{u.map(v=>{const x=m[v];m[v]=x&&new l[v].ConstructEntry(x)});const b=(await Promise.all(u.map(v=>{const x=m[v];return x?l[v].readdir(x):[]}))).map(v=>(v===null?[]:v)[Symbol.iterator]());return{entries:m,children:GCe(b)}},h=async m=>{const{entries:y,children:b}=await d(m),v=y.find(w=>w&&w._fullpath)._fullpath,x=await i(v,y);if(x!==null){let w=await o(h,b);return w=w.filter(S=>S!==void 0),a(x,w)}};return h(c)}async function Dj(e,t){const n=await e.readdir(t);n==null?await e.rm(t):n.length?await Promise.all(n.map(r=>{const s=$t.join(t,r);return e.lstat(s).then(i=>{if(i)return i.isDirectory()?Dj(e,s):e.rm(s)})})).then(()=>e.rmdir(t)):await e.rmdir(t)}function KCe(e){return YCe(e)&&gz(e.then)&&gz(e.catch)}function YCe(e){return e&&typeof e=="object"}function gz(e){return typeof e=="function"}function yz(e){return KCe((n=>{try{return n.readFile().catch(r=>r)}catch(r){return r}})(e))}const bz=["readFile","writeFile","mkdir","rmdir","unlink","stat","lstat","readdir","readlink","symlink"];function vz(e,t){if(yz(t))for(const n of bz)e[`_${n}`]=t[n].bind(t);else for(const n of bz)e[`_${n}`]=ZM(t[n].bind(t));yz(t)?t.rm?e._rm=t.rm.bind(t):t.rmdir.length>1?e._rm=t.rmdir.bind(t):e._rm=Dj.bind(null,e):t.rm?e._rm=ZM(t.rm.bind(t)):t.rmdir.length>2?e._rm=ZM(t.rmdir.bind(t)):e._rm=Dj.bind(null,e)}class En{constructor(t){if(typeof t._original_unwrapped_fs<"u")return t;const n=Object.getOwnPropertyDescriptor(t,"promises");n&&n.enumerable?vz(this,t.promises):vz(this,t),this._original_unwrapped_fs=t}async exists(t,n={}){try{return await this._stat(t),!0}catch(r){if(r.code==="ENOENT"||r.code==="ENOTDIR"||(r.code||"").includes("ENS"))return!1;throw console.log('Unhandled error in "FileSystem.exists()" function',r),r}}async read(t,n={}){try{let r=await this._readFile(t,n);if(n.autocrlf==="true")try{r=new TextDecoder("utf8",{fatal:!0}).decode(r),r=r.replace(/\r\n/g,`
`),r=new TextEncoder().encode(r)}catch{}return typeof r!="string"&&(r=ln.from(r)),r}catch{return null}}async write(t,n,r={}){try{await this._writeFile(t,n,r);return}catch{await this.mkdir(dy(t)),await this._writeFile(t,n,r)}}async mkdir(t,n=!1){try{await this._mkdir(t);return}catch(r){if(r===null||r.code==="EEXIST")return;if(n)throw r;if(r.code==="ENOENT"){const s=dy(t);if(s==="."||s==="/"||s===t)throw r;await this.mkdir(s),await this.mkdir(t,!0)}}}async rm(t){try{await this._unlink(t)}catch(n){if(n.code!=="ENOENT")throw n}}async rmdir(t,n){try{n&&n.recursive?await this._rm(t,n):await this._rmdir(t)}catch(r){if(r.code!=="ENOENT")throw r}}async readdir(t){try{const n=await this._readdir(t);return n.sort(nT),n}catch(n){return n.code==="ENOTDIR"?null:[]}}async readdirDeep(t){const n=await this._readdir(t);return(await Promise.all(n.map(async s=>{const i=t+"/"+s;return(await this._stat(i)).isDirectory()?this.readdirDeep(i):i}))).reduce((s,i)=>s.concat(i),[])}async lstat(t){try{return await this._lstat(t)}catch(n){if(n.code==="ENOENT"||(n.code||"").includes("ENS"))return null;throw n}}async readlink(t,n={encoding:"buffer"}){try{const r=await this._readlink(t,n);return ln.isBuffer(r)?r:ln.from(r)}catch(r){if(r.code==="ENOENT"||(r.code||"").includes("ENS"))return null;throw r}}async writelink(t,n){return this._symlink(n.toString("utf8"),t)}}function ct(e,t){if(t===void 0)throw new jo(e)}async function JC(e,t){return!e&&!t?!1:e&&!t||!e&&t?!0:!(await e.type()==="tree"&&await t.type()==="tree"||await e.type()===await t.type()&&await e.mode()===await t.mode()&&await e.oid()===await t.oid())}async function ZCe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),commit:r="HEAD",cache:s={}}){try{ct("fs",e),ct("dir",t),ct("gitdir",n);const i=new En(e),a=[Wl({ref:r}),z1(),nb()];let o=[];await ca.acquire({fs:i,gitdir:n,cache:s},async function(c){o=c.unmergedPaths});const l=await Ah({fs:i,cache:s,dir:t,gitdir:n,trees:a,map:async function(c,[u,d,h]){const m=!await JC(d,h),y=o.includes(c),b=!await JC(h,u);if(m||y)return u?{path:c,mode:await u.mode(),oid:await u.oid(),type:await u.type(),content:await u.content()}:void 0;if(b)return!1;throw new B1(c)}});await ca.acquire({fs:i,gitdir:n,cache:s},async function(c){for(const u of l)if(u!==!1){if(!u){await i.rmdir(`${t}/${u.path}`,{recursive:!0}),c.delete({filepath:u.path});continue}if(u.type==="blob"){const d=new TextDecoder().decode(u.content);await i.write(`${t}/${u.path}`,d,{mode:u.mode}),c.insert({filepath:u.path,oid:u.oid,stage:0})}}})}catch(i){throw i.caller="git.abortMerge",i}}class ob{static async isIgnored({fs:t,dir:n,gitdir:r=$t.join(n,".git"),filepath:s}){if(KC(s)===".git")return!0;if(s===".")return!1;let i="";const a=$t.join(r,"info","exclude");await t.exists(a)&&(i=await t.read(a,"utf8"));const o=[{gitignore:$t.join(n,".gitignore"),filepath:s}],l=s.split("/").filter(Boolean);for(let u=1;u<l.length;u++){const d=l.slice(0,u).join("/"),h=l.slice(u).join("/");o.push({gitignore:$t.join(n,d,".gitignore"),filepath:h})}let c=!1;for(const u of o){let d;try{d=await t.read(u.gitignore,"utf8")}catch(y){if(y.code==="NOENT")continue}const h=G2e().add(i);h.add(d);const m=dy(u.filepath);if(m!=="."&&h.ignores(m))return!0;c?c=!h.test(u.filepath).unignored:c=h.test(u.filepath).ignored}return c}}async function XCe({fs:e,gitdir:t,object:n,format:r,oid:s}){const i=`objects/${s.slice(0,2)}/${s.slice(2)}`,a=`${t}/${i}`;await e.exists(a)||await e.write(a,n)}let aI=null;async function HY(e){return aI===null&&(aI=QCe()),aI?JCe(e):uD.deflate(e)}async function JCe(e){const t=new CompressionStream("deflate"),n=new Blob([e]).stream().pipeThrough(t);return new Uint8Array(await new Response(n).arrayBuffer())}function QCe(){try{return new CompressionStream("deflate").writable.close(),new Blob([]).stream().cancel(),!0}catch{return!1}}async function Wo({fs:e,gitdir:t,type:n,object:r,format:s="content",oid:i=void 0,dryRun:a=!1}){return s!=="deflated"&&(s!=="wrapped"&&(r=rb.wrap({type:n,object:r})),i=await Xd(r),r=ln.from(await HY(r))),a||await XCe({fs:e,gitdir:t,object:r,format:"deflated",oid:i}),i}function GY(e){let t;for(;~(t=e.indexOf(92));)e[t]=47;return e}async function eke({fs:e,dir:t,gitdir:n=$t.join(t,".git"),filepath:r,cache:s={},force:i=!1,parallel:a=!0}){try{ct("fs",e),ct("dir",t),ct("gitdir",n),ct("filepath",r);const o=new En(e);await ca.acquire({fs:o,gitdir:n,cache:s},async l=>{const u=await(await Pi.get({fs:o,gitdir:n})).get("core.autocrlf");return Fj({dir:t,gitdir:n,fs:o,filepath:r,index:l,force:i,parallel:a,autocrlf:u})})}catch(o){throw o.caller="git.add",o}}async function Fj({dir:e,gitdir:t,fs:n,filepath:r,index:s,force:i,parallel:a,autocrlf:o}){r=Array.isArray(r)?r:[r];const l=r.map(async h=>{if(!i&&await ob.isIgnored({fs:n,dir:e,gitdir:t,filepath:h}))return;const m=await n.lstat($t.join(e,h));if(!m)throw new As(h);if(m.isDirectory()){const y=await n.readdir($t.join(e,h));if(a){const b=y.map(v=>Fj({dir:e,gitdir:t,fs:n,filepath:[$t.join(h,v)],index:s,force:i,parallel:a,autocrlf:o}));await Promise.all(b)}else for(const b of y)await Fj({dir:e,gitdir:t,fs:n,filepath:[$t.join(h,b)],index:s,force:i,parallel:a,autocrlf:o})}else{const y=m.isSymbolicLink()?await n.readlink($t.join(e,h)).then(GY):await n.read($t.join(e,h),{autocrlf:o});if(y===null)throw new As(h);const b=await Wo({fs:n,gitdir:t,type:"blob",object:y});s.insert({filepath:h,stats:m,oid:b})}}),c=await Promise.allSettled(l),u=c.filter(h=>h.status==="rejected").map(h=>h.reason);if(u.length>1)throw new P1(u);if(u.length===1)throw u[0];return c.filter(h=>h.status==="fulfilled"&&h.value).map(h=>h.value)}async function gw({fs:e,gitdir:t,path:n}){return(await Pi.get({fs:e,gitdir:t})).get(n)}function KY(e,...t){for(const n of t)if(n)for(const r of Object.keys(n)){const s=n[r];s!==void 0&&(e[r]=s)}return e}async function Rh({fs:e,gitdir:t,author:n,commit:r}){const s=Math.floor(Date.now()/1e3),i={name:await gw({fs:e,gitdir:t,path:"user.name"}),email:await gw({fs:e,gitdir:t,path:"user.email"})||"",timestamp:s,timezoneOffset:new Date(s*1e3).getTimezoneOffset()},a=KY({},i,r?r.author:void 0,n);if(a.name!==void 0)return a}async function gy({fs:e,gitdir:t,author:n,committer:r,commit:s}){const i=Math.floor(Date.now()/1e3),a={name:await gw({fs:e,gitdir:t,path:"user.name"}),email:await gw({fs:e,gitdir:t,path:"user.email"})||"",timestamp:i,timezoneOffset:new Date(i*1e3).getTimezoneOffset()},o=KY({},a,s?s.committer:void 0,n,r);if(o.name!==void 0)return o}async function YY({fs:e,cache:t,gitdir:n,oid:r}){const{type:s,object:i}=await Xs({fs:e,cache:t,gitdir:n,oid:r});if(s==="tag")return r=so.from(i).parse().object,YY({fs:e,cache:t,gitdir:n,oid:r});if(s!=="commit")throw new ho(r,s,"commit");return{commit:Zs.from(i),oid:r}}async function yy({fs:e,cache:t,gitdir:n,oid:r}){const{commit:s,oid:i}=await YY({fs:e,cache:t,gitdir:n,oid:r});return{oid:i,commit:s.parse(),payload:s.withoutSignature()}}async function sT({fs:e,cache:t,onSign:n,gitdir:r,message:s,author:i,committer:a,signingKey:o,amend:l=!1,dryRun:c=!1,noUpdateBranch:u=!1,ref:d,parent:h,tree:m}){let y=!1;d||(d=await Yt.resolve({fs:e,gitdir:r,ref:"HEAD",depth:2}));let b,v;try{b=await Yt.resolve({fs:e,gitdir:r,ref:d}),v=await yy({fs:e,gitdir:r,oid:b,cache:{}})}catch{y=!0}if(l&&y)throw new $1(d);const x=l?await Rh({fs:e,gitdir:r,author:i,commit:v.commit}):await Rh({fs:e,gitdir:r,author:i});if(!x)throw new za("author");const w=l?await gy({fs:e,gitdir:r,author:x,committer:a,commit:v.commit}):await gy({fs:e,gitdir:r,author:x,committer:a});if(!w)throw new za("committer");return ca.acquire({fs:e,gitdir:r,cache:t,allowUnmerged:!1},async function(S){const C=BY(S.entries).get(".");if(m||(m=await ZY({fs:e,gitdir:r,inode:C,dryRun:c})),h?h=await Promise.all(h.map(N=>Yt.resolve({fs:e,gitdir:r,ref:N}))):l?h=v.commit.parent:h=b?[b]:[],!s)if(l)s=v.commit.message;else throw new jo("message");let T=Zs.from({tree:m,parent:h,author:x,committer:w,message:s});o&&(T=await Zs.sign(T,n,o));const R=await Wo({fs:e,gitdir:r,type:"commit",object:T.toObject(),dryRun:c});return!u&&!c&&await Yt.writeRef({fs:e,gitdir:r,ref:d,value:R}),R})}async function ZY({fs:e,gitdir:t,inode:n,dryRun:r}){const s=n.children;for(const l of s)l.type==="tree"&&(l.metadata.mode="040000",l.metadata.oid=await ZY({fs:e,gitdir:t,inode:l,dryRun:r}));const i=s.map(l=>({mode:l.metadata.mode,path:l.basename,oid:l.metadata.oid,type:l.type})),a=Lo.from(i);return await Wo({fs:e,gitdir:t,type:"tree",object:a.toObject(),dryRun:r})}async function U1({fs:e,cache:t,gitdir:n,oid:r,filepath:s}){if(s.startsWith("/"))throw new Th("leading-slash");if(s.endsWith("/"))throw new Th("trailing-slash");const i=r,a=await my({fs:e,cache:t,gitdir:n,oid:r}),o=a.tree;if(s==="")r=a.oid;else{const l=s.split("/");r=await XY({fs:e,cache:t,gitdir:n,tree:o,pathArray:l,oid:i,filepath:s})}return r}async function XY({fs:e,cache:t,gitdir:n,tree:r,pathArray:s,oid:i,filepath:a}){const o=s.shift();for(const l of r)if(l.path===o){if(s.length===0)return l.oid;{const{type:c,object:u}=await Xs({fs:e,cache:t,gitdir:n,oid:l.oid});if(c!=="tree")throw new ho(i,c,"tree",a);return r=Lo.from(u),XY({fs:e,cache:t,gitdir:n,tree:r,pathArray:s,oid:i,filepath:a})}}throw new As(`file or directory found at "${i}:${a}"`)}async function lb({fs:e,cache:t,gitdir:n,oid:r,filepath:s=void 0}){s!==void 0&&(r=await U1({fs:e,cache:t,gitdir:n,oid:r,filepath:s}));const{tree:i,oid:a}=await my({fs:e,cache:t,gitdir:n,oid:r});return{oid:a,tree:i.entries()}}async function q1({fs:e,gitdir:t,tree:n}){const r=Lo.from(n).toObject();return await Wo({fs:e,gitdir:t,type:"tree",object:r,format:"content"})}async function tke({fs:e,cache:t,onSign:n,gitdir:r,ref:s,oid:i,note:a,force:o,author:l,committer:c,signingKey:u}){let d;try{d=await Yt.resolve({gitdir:r,fs:e,ref:s})}catch(x){if(!(x instanceof As))throw x}let m=(await lb({fs:e,cache:t,gitdir:r,oid:d||"4b825dc642cb6eb9a060e54bf8d69288fbee4904"})).tree;if(o)m=m.filter(x=>x.path!==i);else for(const x of m)if(x.path===i)throw new qc("note",i);typeof a=="string"&&(a=ln.from(a,"utf8"));const y=await Wo({fs:e,gitdir:r,type:"blob",object:a,format:"content"});m.push({mode:"100644",path:i,oid:y,type:"blob"});const b=await q1({fs:e,gitdir:r,tree:m});return await sT({fs:e,cache:t,onSign:n,gitdir:r,ref:s,tree:b,parent:d&&[d],message:`Note added by 'isomorphic-git addNote'
`,author:l,committer:c,signingKey:u})}async function nke({fs:e,onSign:t,dir:n,gitdir:r=$t.join(n,".git"),ref:s="refs/notes/commits",oid:i,note:a,force:o,author:l,committer:c,signingKey:u,cache:d={}}){try{ct("fs",e),ct("gitdir",r),ct("oid",i),ct("note",a),u&&ct("onSign",t);const h=new En(e),m=await Rh({fs:h,gitdir:r,author:l});if(!m)throw new za("author");const y=await gy({fs:h,gitdir:r,author:m,committer:c});if(!y)throw new za("committer");return await tke({fs:new En(h),cache:d,onSign:t,gitdir:r,ref:s,oid:i,note:a,force:o,author:m,committer:y,signingKey:u})}catch(h){throw h.caller="git.addNote",h}}async function JY({fs:e,gitdir:t,remote:n,url:r,force:s}){if(n!==xu.clean(n))throw new Bc(n,xu.clean(n));const i=await Pi.get({fs:e,gitdir:t});if(!s&&(await i.getSubsections("remote")).includes(n)&&r!==await i.get(`remote.${n}.url`))throw new qc("remote",n);await i.set(`remote.${n}.url`,r),await i.set(`remote.${n}.fetch`,`+refs/heads/*:refs/remotes/${n}/*`),await Pi.save({fs:e,gitdir:t,config:i})}async function rke({fs:e,dir:t,gitdir:n=$t.join(t,".git"),remote:r,url:s,force:i=!1}){try{return ct("fs",e),ct("gitdir",n),ct("remote",r),ct("url",s),await JY({fs:new En(e),gitdir:n,remote:r,url:s,force:i})}catch(a){throw a.caller="git.addRemote",a}}async function ske({fs:e,cache:t,onSign:n,gitdir:r,ref:s,tagger:i,message:a=s,gpgsig:o,object:l,signingKey:c,force:u=!1}){if(s=s.startsWith("refs/tags/")?s:`refs/tags/${s}`,!u&&await Yt.exists({fs:e,gitdir:r,ref:s}))throw new qc("tag",s);const d=await Yt.resolve({fs:e,gitdir:r,ref:l||"HEAD"}),{type:h}=await Xs({fs:e,cache:t,gitdir:r,oid:d});let m=so.from({object:d,type:h,tag:s.replace("refs/tags/",""),tagger:i,message:a,gpgsig:o});c&&(m=await so.sign(m,n,c));const y=await Wo({fs:e,gitdir:r,type:"tag",object:m.toObject()});await Yt.writeRef({fs:e,gitdir:r,ref:s,value:y})}async function ike({fs:e,onSign:t,dir:n,gitdir:r=$t.join(n,".git"),ref:s,tagger:i,message:a=s,gpgsig:o,object:l,signingKey:c,force:u=!1,cache:d={}}){try{ct("fs",e),ct("gitdir",r),ct("ref",s),c&&ct("onSign",t);const h=new En(e),m=await Rh({fs:h,gitdir:r,author:i});if(!m)throw new za("tagger");return await ske({fs:h,cache:d,onSign:t,gitdir:r,ref:s,tagger:m,message:a,gpgsig:o,object:l,signingKey:c,force:u})}catch(h){throw h.caller="git.annotatedTag",h}}async function ake({fs:e,gitdir:t,ref:n,object:r,checkout:s=!1,force:i=!1}){if(n!==xu.clean(n))throw new Bc(n,xu.clean(n));const a=`refs/heads/${n}`;if(!i&&await Yt.exists({fs:e,gitdir:t,ref:a}))throw new qc("branch",n,!1);let o;try{o=await Yt.resolve({fs:e,gitdir:t,ref:r||"HEAD"})}catch{}o&&await Yt.writeRef({fs:e,gitdir:t,ref:a,value:o}),s&&await Yt.writeSymbolicRef({fs:e,gitdir:t,ref:"HEAD",value:a})}async function oke({fs:e,dir:t,gitdir:n=$t.join(t,".git"),ref:r,object:s,checkout:i=!1,force:a=!1}){try{return ct("fs",e),ct("gitdir",n),ct("ref",r),await ake({fs:new En(e),gitdir:n,ref:r,object:s,checkout:i,force:a})}catch(o){throw o.caller="git.branch",o}}const QY=(e,t)=>e==="."||t==null||t.length===0||t==="."?!0:t.length>=e.length?t.startsWith(e):e.startsWith(t);async function pD({fs:e,cache:t,onProgress:n,onPostCheckout:r,dir:s,gitdir:i,remote:a,ref:o,filepaths:l,noCheckout:c,noUpdateHead:u,dryRun:d,force:h,track:m=!0}){let y;if(r)try{y=await Yt.resolve({fs:e,gitdir:i,ref:"HEAD"})}catch{y="0000000000000000000000000000000000000000"}let b;try{b=await Yt.resolve({fs:e,gitdir:i,ref:o})}catch(v){if(o==="HEAD")throw v;const x=`${a}/${o}`;if(b=await Yt.resolve({fs:e,gitdir:i,ref:x}),m){const w=await Pi.get({fs:e,gitdir:i});await w.set(`branch.${o}.remote`,a),await w.set(`branch.${o}.merge`,`refs/heads/${o}`),await Pi.save({fs:e,gitdir:i,config:w})}await Yt.writeRef({fs:e,gitdir:i,ref:`refs/heads/${o}`,value:b})}if(!c){let v;try{v=await lke({fs:e,cache:t,onProgress:n,dir:s,gitdir:i,ref:o,force:h,filepaths:l})}catch(C){throw C instanceof As&&C.data.what===b?new N1(o,b):C}const x=v.filter(([C])=>C==="conflict").map(([C,T])=>T);if(x.length>0)throw new R1(x);const w=v.filter(([C])=>C==="error").map(([C,T])=>T);if(w.length>0)throw new vr(w.join(", "));if(d){r&&await r({previousHead:y,newHead:b,type:l!=null&&l.length>0?"file":"branch"});return}let S=0;const k=v.length;await ca.acquire({fs:e,gitdir:i,cache:t},async function(C){await Promise.all(v.filter(([T])=>T==="delete"||T==="delete-index").map(async function([T,R]){const N=`${s}/${R}`;T==="delete"&&await e.rm(N),C.delete({filepath:R}),n&&await n({phase:"Updating workdir",loaded:++S,total:k})}))}),await ca.acquire({fs:e,gitdir:i,cache:t},async function(C){for(const[T,R]of v)if(T==="rmdir"||T==="rmdir-index"){const N=`${s}/${R}`;try{T==="rmdir-index"&&C.delete({filepath:R}),await e.rmdir(N),n&&await n({phase:"Updating workdir",loaded:++S,total:k})}catch(I){if(I.code==="ENOTEMPTY")console.log(`Did not delete ${R} because directory is not empty`);else throw I}}}),await Promise.all(v.filter(([C])=>C==="mkdir"||C==="mkdir-index").map(async function([C,T]){const R=`${s}/${T}`;await e.mkdir(R),n&&await n({phase:"Updating workdir",loaded:++S,total:k})})),await ca.acquire({fs:e,gitdir:i,cache:t},async function(C){await Promise.all(v.filter(([T])=>T==="create"||T==="create-index"||T==="update"||T==="mkdir-index").map(async function([T,R,N,I,P]){const B=`${s}/${R}`;try{if(T!=="create-index"&&T!=="mkdir-index"){const{object:W}=await Xs({fs:e,cache:t,gitdir:i,oid:N});if(P&&await e.rm(B),I===33188)await e.write(B,W);else if(I===33261)await e.write(B,W,{mode:511});else if(I===40960)await e.writelink(B,W);else throw new vr(`Invalid mode 0o${I.toString(8)} detected in blob ${N}`)}const D=await e.lstat(B);I===33261&&(D.mode=493),T==="mkdir-index"&&(D.mode=57344),C.insert({filepath:R,stats:D,oid:N}),n&&await n({phase:"Updating workdir",loaded:++S,total:k})}catch(D){console.log(D)}}))}),r&&await r({previousHead:y,newHead:b,type:l!=null&&l.length>0?"file":"branch"})}if(!u){const v=await Yt.expand({fs:e,gitdir:i,ref:o});v.startsWith("refs/heads")?await Yt.writeSymbolicRef({fs:e,gitdir:i,ref:"HEAD",value:v}):await Yt.writeRef({fs:e,gitdir:i,ref:"HEAD",value:b})}}async function lke({fs:e,cache:t,onProgress:n,dir:r,gitdir:s,ref:i,force:a,filepaths:o}){let l=0;return Ah({fs:e,cache:t,dir:r,gitdir:s,trees:[Wl({ref:i}),z1(),nb()],map:async function(c,[u,d,h]){if(c===".")return;if(o&&!o.some(y=>QY(c,y)))return null;switch(n&&await n({phase:"Analyzing workdir",loaded:++l}),[!!h,!!u,!!d].map(Number).join("")){case"000":return;case"001":return a&&o&&o.includes(c)?["delete",c]:void 0;case"010":switch(await u.type()){case"tree":return["mkdir",c];case"blob":return["create",c,await u.oid(),await u.mode()];case"commit":return["mkdir-index",c,await u.oid(),await u.mode()];default:return["error",`new entry Unhandled type ${await u.type()}`]}case"011":switch(`${await u.type()}-${await d.type()}`){case"tree-tree":return;case"tree-blob":case"blob-tree":return["conflict",c];case"blob-blob":return await u.oid()!==await d.oid()?a?["update",c,await u.oid(),await u.mode(),await u.mode()!==await d.mode()]:["conflict",c]:await u.mode()!==await d.mode()?a?["update",c,await u.oid(),await u.mode(),!0]:["conflict",c]:["create-index",c,await u.oid(),await u.mode()];case"commit-tree":return;case"commit-blob":return["conflict",c];default:return["error",`new entry Unhandled type ${u.type}`]}case"100":return["delete-index",c];case"101":switch(await h.type()){case"tree":return["rmdir",c];case"blob":return await h.oid()!==await d.oid()?a?["delete",c]:["conflict",c]:["delete",c];case"commit":return["rmdir-index",c];default:return["error",`delete entry Unhandled type ${await h.type()}`]}case"110":case"111":switch(`${await h.type()}-${await u.type()}`){case"tree-tree":return;case"blob-blob":{if(await h.oid()===await u.oid()&&await h.mode()===await u.mode()&&!a)return;if(d){if(await d.oid()!==await h.oid()&&await d.oid()!==await u.oid())return a?["update",c,await u.oid(),await u.mode(),await u.mode()!==await d.mode()]:["conflict",c]}else if(a)return["update",c,await u.oid(),await u.mode(),await u.mode()!==await h.mode()];return await u.mode()!==await h.mode()?["update",c,await u.oid(),await u.mode(),!0]:await u.oid()!==await h.oid()?["update",c,await u.oid(),await u.mode(),!1]:void 0}case"tree-blob":return["update-dir-to-blob",c,await u.oid()];case"blob-tree":return["update-blob-to-tree",c];case"commit-commit":return["mkdir-index",c,await u.oid(),await u.mode()];default:return["error",`update entry Unhandled type ${await h.type()}-${await u.type()}`]}}},reduce:async function(c,u){return u=WY(u),c?c&&c[0]==="rmdir"?(u.push(c),u):(u.unshift(c),u):u}})}async function eZ({fs:e,onProgress:t,onPostCheckout:n,dir:r,gitdir:s=$t.join(r,".git"),remote:i="origin",ref:a,filepaths:o,noCheckout:l=!1,noUpdateHead:c=a===void 0,dryRun:u=!1,force:d=!1,track:h=!0,cache:m={}}){try{ct("fs",e),ct("dir",r),ct("gitdir",s);const y=a||"HEAD";return await pD({fs:new En(e),cache:m,onProgress:t,onPostCheckout:n,dir:r,gitdir:s,remote:i,ref:y,filepaths:o,noCheckout:l,noUpdateHead:c,dryRun:u,force:d,track:h})}catch(y){throw y.caller="git.checkout",y}}const cke=new RegExp("^refs/(heads/|tags/|remotes/)?(.*)");function rm(e){const t=cke.exec(e);return t?t[1]==="remotes/"&&e.endsWith("/HEAD")?t[2].slice(0,-5):t[2]:e}async function Yh({fs:e,gitdir:t,fullname:n=!1,test:r=!1}){const s=await Yt.resolve({fs:e,gitdir:t,ref:"HEAD",depth:2});if(r)try{await Yt.resolve({fs:e,gitdir:t,ref:s})}catch{return}if(s.startsWith("refs/"))return n?s:rm(s)}function uke(e){return e=e.replace(/^git@([^:]+):/,"https://$1/"),e=e.replace(/^ssh:\/\//,"https://"),e}function tZ({username:e="",password:t=""}){return`Basic ${ln.from(`${e}:${t}`).toString("base64")}`}async function V1(e,t){const n=UY(e);for(;;){const{value:r,done:s}=await n.next();if(r&&await t(r),s)break}n.return&&n.return()}async function QC(e){let t=0;const n=[];await V1(e,i=>{n.push(i),t+=i.byteLength});const r=new Uint8Array(t);let s=0;for(const i of n)r.set(i,s),s+=i.byteLength;return r}function xz(e){let t=e.match(/^https?:\/\/([^/]+)@/);if(t==null)return{url:e,auth:{}};t=t[1];const[n,r]=t.split(":");return e=e.replace(`${t}@`,""),{url:e,auth:{username:n,password:r}}}function Lj(e,t){const n=t.toString(16);return"0".repeat(e-n.length)+n}class yi{static flush(){return ln.from("0000","utf8")}static delim(){return ln.from("0001","utf8")}static encode(t){typeof t=="string"&&(t=ln.from(t));const n=t.length+4,r=Lj(4,n);return ln.concat([ln.from(r,"utf8"),t])}static streamReader(t){const n=new qY(t);return async function(){try{let s=await n.read(4);if(s==null)return!0;if(s=parseInt(s.toString("utf8"),16),s===0||s===1)return null;const i=await n.read(s-4);return i??!0}catch(s){return t.error=s,!0}}}}async function wz(e){const t={};let n;for(;n=await e(),n!==!0;){if(n===null)continue;n=n.toString("utf8").replace(/\n$/,"");const r=n.indexOf("=");if(r>-1){const s=n.slice(0,r),i=n.slice(r+1);t[s]=i}else t[n]=!0}return{protocolVersion:2,capabilities2:t}}async function _z(e,{service:t}){const n=new Set,r=new Map,s=new Map,i=yi.streamReader(e);let a=await i();for(;a===null;)a=await i();if(a===!0)throw new M1;if(a.includes("version 2"))return wz(i);if(a.toString("utf8").replace(/\n$/,"")!==`# service=${t}`)throw new Qm(`# service=${t}\\n`,a.toString("utf8"));let o=await i();for(;o===null;)o=await i();if(o===!0)return{capabilities:n,refs:r,symrefs:s};if(o=o.toString("utf8"),o.includes("version 2"))return wz(i);const[l,c]=oI(o,"\0","\\x00");if(c.split(" ").map(u=>n.add(u)),l!=="0000000000000000000000000000000000000000 capabilities^{}"){const[u,d]=oI(l," "," ");for(r.set(d,u);;){const h=await i();if(h===!0)break;if(h!==null){const[m,y]=oI(h.toString("utf8")," "," ");r.set(y,m)}}}for(const u of n)if(u.startsWith("symref=")){const d=u.match(/symref=([^:]+):(.*)/);d.length===3&&s.set(d[1],d[2])}return{protocolVersion:1,capabilities:n,refs:r,symrefs:s}}function oI(e,t,n){const r=e.trim().split(t);if(r.length!==2)throw new Qm(`Two strings separated by '${n}'`,e.toString("utf8"));return r}const Sz=(e,t)=>e.endsWith("?")?`${e}${t}`:`${e}/${t.replace(/^https?:\/\//,"")}`,Cz=(e,t)=>{(t.username||t.password)&&(e.Authorization=tZ(t)),t.headers&&Object.assign(e,t.headers)},lI=async e=>{try{const t=ln.from(await QC(e.body)),n=t.toString("utf8");return{preview:n.length<256?n:n.slice(0,256)+"...",response:n,data:t}}catch{return{}}};class ek{static async capabilities(){return["discover","connect"]}static async discover({http:t,onProgress:n,onAuth:r,onAuthSuccess:s,onAuthFailure:i,corsProxy:a,service:o,url:l,headers:c,protocolVersion:u}){let{url:d,auth:h}=xz(l);const m=a?Sz(a,d):d;(h.username||h.password)&&(c.Authorization=tZ(h)),u===2&&(c["Git-Protocol"]="version=2");let y,b,v=!1;do if(y=await t.request({onProgress:n,method:"GET",url:`${m}/info/refs?service=${o}`,headers:c}),b=!1,y.statusCode===401||y.statusCode===203){const x=v?i:r;if(x){if(h=await x(d,{...h,headers:{...c}}),h&&h.cancel)throw new ab;h&&(Cz(c,h),v=!0,b=!0)}}else y.statusCode===200&&v&&s&&await s(d,h);while(b);if(y.statusCode!==200){const{response:x}=await lI(y);throw new hy(y.statusCode,y.statusMessage,x)}if(y.headers["content-type"]===`application/x-${o}-advertisement`){const x=await _z(y.body,{service:o});return x.auth=h,x}else{const{preview:x,response:w,data:S}=await lI(y);try{const k=await _z([S],{service:o});return k.auth=h,k}catch{throw new D1(x,w)}}}static async connect({http:t,onProgress:n,corsProxy:r,service:s,url:i,auth:a,body:o,headers:l}){const c=xz(i);c&&(i=c.url),r&&(i=Sz(r,i)),l["content-type"]=`application/x-${s}-request`,l.accept=`application/x-${s}-result`,Cz(l,a);const u=await t.request({onProgress:n,method:"POST",url:`${i}/${s}`,body:o,headers:l});if(u.statusCode!==200){const{response:d}=lI(u);throw new hy(u.statusCode,u.statusMessage,d)}return u}}function dke({url:e}){if(e.startsWith("git@"))return{transport:"ssh",address:e};const t=e.match(/(\w+)(:\/\/|::)(.*)/);if(t!==null){if(t[2]==="://")return{transport:t[1],address:t[0]};if(t[2]==="::")return{transport:t[1],address:t[3]}}}class iT{static getRemoteHelperFor({url:t}){const n=new Map;n.set("http",ek),n.set("https",ek);const r=dke({url:t});if(!r)throw new L1(t);if(n.has(r.transport))return n.get(r.transport);throw new F1(t,r.transport,r.transport==="ssh"?uke(t):void 0)}}let zp=null;class yw{static async read({fs:t,gitdir:n}){zp===null&&(zp=new mw);const r=$t.join(n,"shallow"),s=new Set;return await zp.acquire(r,async function(){const i=await t.read(r,{encoding:"utf8"});if(i===null||i.trim()==="")return s;i.trim().split(`
`).map(a=>s.add(a))}),s}static async write({fs:t,gitdir:n,oids:r}){zp===null&&(zp=new mw);const s=$t.join(n,"shallow");if(r.size>0){const i=[...r].join(`
`)+`
`;await zp.acquire(s,async function(){await t.write(s,i,{encoding:"utf8"})})}else await zp.acquire(s,async function(){await t.rm(s)})}}async function fke({fs:e,gitdir:t,oid:n}){const r=`objects/${n.slice(0,2)}/${n.slice(2)}`;return e.exists(`${t}/${r}`)}async function hke({fs:e,cache:t,gitdir:n,oid:r,getExternalRefDelta:s}){let i=await e.readdir($t.join(n,"objects/pack"));i=i.filter(a=>a.endsWith(".idx"));for(const a of i){const o=`${n}/objects/pack/${a}`,l=await hD({fs:e,cache:t,filename:o,getExternalRefDelta:s});if(l.error)throw new vr(l.error);if(l.offsets.has(r))return!0}return!1}async function kz({fs:e,cache:t,gitdir:n,oid:r,format:s="content"}){const i=o=>Xs({fs:e,cache:t,gitdir:n,oid:o});let a=await fke({fs:e,gitdir:n,oid:r});return a||(a=await hke({fs:e,cache:t,gitdir:n,oid:r,getExternalRefDelta:i})),a}function pke(e){const s="5041434b"+"00000002"+"00000000";return e.slice(0,12).toString("hex")===s}function nZ(e,t){const n=e.map(r=>r.split("=",1)[0]);return t.filter(r=>{const s=r.split("=",1)[0];return n.includes(s)})}const aT={name:"isomorphic-git",version:"1.30.1",agent:"git/isomorphic-git@1.30.1"};class j2{constructor(){this._queue=[]}write(t){if(this._ended)throw Error("You cannot write to a FIFO that has already been ended!");if(this._waiting){const n=this._waiting;this._waiting=null,n({value:t})}else this._queue.push(t)}end(){if(this._ended=!0,this._waiting){const t=this._waiting;this._waiting=null,t({done:!0})}}destroy(t){this.error=t,this.end()}async next(){if(this._queue.length>0)return{value:this._queue.shift()};if(this._ended)return{done:!0};if(this._waiting)throw Error("You cannot call read until the previous call to read has returned!");return new Promise(t=>{this._waiting=t})}}function mke(e){const t=e.indexOf("\r"),n=e.indexOf(`
`);return t===-1&&n===-1?-1:t===-1?n+1:n===-1?t+1:n===t+1?n+1:Math.min(t,n)+1}function rZ(e){const t=new j2;let n="";return(async()=>(await V1(e,r=>{for(r=r.toString("utf8"),n+=r;;){const s=mke(n);if(s===-1)break;t.write(n.slice(0,s)),n=n.slice(s)}}),n.length>0&&t.write(n),t.end()))(),t}class sZ{static demux(t){const n=yi.streamReader(t),r=new j2,s=new j2,i=new j2,a=async function(){const o=await n();if(o===null)return a();if(o===!0){r.end(),i.end(),t.error?s.destroy(t.error):s.end();return}switch(o[0]){case 1:{s.write(o.slice(1));break}case 2:{i.write(o.slice(1));break}case 3:{const l=o.slice(1);i.write(l),r.end(),i.end(),s.destroy(new Error(l.toString("utf8")));return}default:r.write(o)}a()};return a(),{packetlines:r,packfile:s,progress:i}}}async function gke(e){const{packetlines:t,packfile:n,progress:r}=sZ.demux(e),s=[],i=[],a=[];let o=!1,l=!1;return new Promise((c,u)=>{V1(t,d=>{const h=d.toString("utf8").trim();if(h.startsWith("shallow")){const m=h.slice(-41).trim();m.length!==40&&u(new Eh(m)),s.push(m)}else if(h.startsWith("unshallow")){const m=h.slice(-41).trim();m.length!==40&&u(new Eh(m)),i.push(m)}else if(h.startsWith("ACK")){const[,m,y]=h.split(" ");a.push({oid:m,status:y}),y||(l=!0)}else h.startsWith("NAK")?(o=!0,l=!0):(l=!0,o=!0);l&&(e.error?u(e.error):c({shallows:s,unshallows:i,acks:a,nak:o,packfile:n,progress:r}))}).finally(()=>{l||(e.error?u(e.error):c({shallows:s,unshallows:i,acks:a,nak:o,packfile:n,progress:r}))})})}function yke({capabilities:e=[],wants:t=[],haves:n=[],shallows:r=[],depth:s=null,since:i=null,exclude:a=[]}){const o=[];t=[...new Set(t)];let l=` ${e.join(" ")}`;for(const c of t)o.push(yi.encode(`want ${c}${l}
`)),l="";for(const c of r)o.push(yi.encode(`shallow ${c}
`));s!==null&&o.push(yi.encode(`deepen ${s}
`)),i!==null&&o.push(yi.encode(`deepen-since ${Math.floor(i.valueOf()/1e3)}
`));for(const c of a)o.push(yi.encode(`deepen-not ${c}
`));o.push(yi.flush());for(const c of n)o.push(yi.encode(`have ${c}
`));return o.push(yi.encode(`done
`)),o}async function mD({fs:e,cache:t,http:n,onProgress:r,onMessage:s,onAuth:i,onAuthSuccess:a,onAuthFailure:o,gitdir:l,ref:c,remoteRef:u,remote:d,url:h,corsProxy:m,depth:y=null,since:b=null,exclude:v=[],relative:x=!1,tags:w=!1,singleBranch:S=!1,headers:k={},prune:C=!1,pruneTags:T=!1}){const R=c||await Yh({fs:e,gitdir:l,test:!0}),N=await Pi.get({fs:e,gitdir:l}),I=d||R&&await N.get(`branch.${R}.remote`)||"origin",P=h||await N.get(`remote.${I}.url`);if(typeof P>"u")throw new jo("remote OR url");const B=u||R&&await N.get(`branch.${R}.merge`)||c||"HEAD";m===void 0&&(m=await N.get("http.corsProxy"));const D=iT.getRemoteHelperFor({url:P}),W=await D.discover({http:n,onAuth:i,onAuthSuccess:a,onAuthFailure:o,corsProxy:m,service:"git-upload-pack",url:P,headers:k,protocolVersion:1}),O=W.auth,Z=W.refs;if(Z.size===0)return{defaultBranch:null,fetchHead:null,fetchHeadDescription:null};if(y!==null&&!W.capabilities.has("shallow"))throw new dh("shallow","depth");if(b!==null&&!W.capabilities.has("deepen-since"))throw new dh("deepen-since","since");if(v.length>0&&!W.capabilities.has("deepen-not"))throw new dh("deepen-not","exclude");if(x===!0&&!W.capabilities.has("deepen-relative"))throw new dh("deepen-relative","relative");const{oid:U,fullref:H}=Yt.resolveAgainstMap({ref:B,map:Z});for(const We of Z.keys())We===H||We==="HEAD"||We.startsWith("refs/heads/")||w&&We.startsWith("refs/tags/")||Z.delete(We);const L=nZ([...W.capabilities],["multi_ack_detailed","no-done","side-band-64k","ofs-delta",`agent=${aT.agent}`]);x&&L.push("deepen-relative");const te=S?[U]:Z.values(),V=S?[R]:await Yt.listRefs({fs:e,gitdir:l,filepath:"refs"});let Q=[];for(let We of V)try{We=await Yt.expand({fs:e,gitdir:l,ref:We});const Ie=await Yt.resolve({fs:e,gitdir:l,ref:We});await kz({fs:e,cache:t,gitdir:l,oid:Ie})&&Q.push(Ie)}catch{}Q=[...new Set(Q)];const ee=await yw.read({fs:e,gitdir:l}),se=W.capabilities.has("shallow")?[...ee]:[],pe=yke({capabilities:L,wants:te,haves:Q,shallows:se,depth:y,since:b,exclude:v}),ue=ln.from(await QC(pe)),Oe=await D.connect({http:n,onProgress:r,corsProxy:m,service:"git-upload-pack",url:P,auth:O,body:[ue],headers:k}),Fe=await gke(Oe.body);Oe.headers&&(Fe.headers=Oe.headers);for(const We of Fe.shallows)if(!ee.has(We))try{const{object:Ie}=await Xs({fs:e,cache:t,gitdir:l,oid:We}),K=new Zs(Ie),ye=await Promise.all(K.headers().parent.map(ce=>kz({fs:e,cache:t,gitdir:l,oid:ce})));ye.length===0||ye.every(ce=>ce)||ee.add(We)}catch{ee.add(We)}for(const We of Fe.unshallows)ee.delete(We);if(await yw.write({fs:e,gitdir:l,oids:ee}),S){const We=new Map([[H,U]]),Ie=new Map;let K=10,ye=H;for(;K--;){const oe=W.symrefs.get(ye);if(oe===void 0)break;Ie.set(ye,oe),ye=oe}const Ne=Z.get(ye);Ne&&We.set(ye,Ne);const{pruned:ce}=await Yt.updateRemoteRefs({fs:e,gitdir:l,remote:I,refs:We,symrefs:Ie,tags:w,prune:C});C&&(Fe.pruned=ce)}else{const{pruned:We}=await Yt.updateRemoteRefs({fs:e,gitdir:l,remote:I,refs:Z,symrefs:W.symrefs,tags:w,prune:C,pruneTags:T});C&&(Fe.pruned=We)}if(Fe.HEAD=W.symrefs.get("HEAD"),Fe.HEAD===void 0){const{oid:We}=Yt.resolveAgainstMap({ref:"HEAD",map:Z});for(const[Ie,K]of Z.entries())if(Ie!=="HEAD"&&K===We){Fe.HEAD=Ie;break}}const Se=H.startsWith("refs/tags")?"tag":"branch";if(Fe.FETCH_HEAD={oid:U,description:`${Se} '${rm(H)}' of ${P}`},r||s){const We=rZ(Fe.progress);V1(We,async Ie=>{if(s&&await s(Ie),r){const K=Ie.match(/([^:]*).*\((\d+?)\/(\d+?)\)/);K&&await r({phase:K[1].trim(),loaded:parseInt(K[2],10),total:parseInt(K[3],10)})}})}const Ce=ln.from(await QC(Fe.packfile));if(Oe.body.error)throw Oe.body.error;const qe=Ce.slice(-20).toString("hex"),Qe={defaultBranch:Fe.HEAD,fetchHead:Fe.FETCH_HEAD.oid,fetchHeadDescription:Fe.FETCH_HEAD.description};if(Fe.headers&&(Qe.headers=Fe.headers),C&&(Qe.pruned=Fe.pruned),qe!==""&&!pke(Ce)){Qe.packfile=`objects/pack/pack-${qe}.pack`;const We=$t.join(l,Qe.packfile);await e.write(We,Ce);const Ie=ye=>Xs({fs:e,cache:t,gitdir:l,oid:ye}),K=await fy.fromPack({pack:Ce,getExternalRefDelta:Ie,onProgress:r});await e.write(We.replace(/\.pack$/,".idx"),await K.toBuffer())}return Qe}async function iZ({fs:e,bare:t=!1,dir:n,gitdir:r=t?n:$t.join(n,".git"),defaultBranch:s="master"}){if(await e.exists(r+"/config"))return;let i=["hooks","info","objects/info","objects/pack","refs/heads","refs/tags"];i=i.map(a=>r+"/"+a);for(const a of i)await e.mkdir(a);await e.write(r+"/config",`[core]
	repositoryformatversion = 0
	filemode = false
	bare = ${t}
`+(t?"":`	logallrefupdates = true
`)+`	symlinks = false
	ignorecase = true
`),await e.write(r+"/HEAD",`ref: refs/heads/${s}
`)}async function bke({fs:e,cache:t,http:n,onProgress:r,onMessage:s,onAuth:i,onAuthSuccess:a,onAuthFailure:o,onPostCheckout:l,dir:c,gitdir:u,url:d,corsProxy:h,ref:m,remote:y,depth:b,since:v,exclude:x,relative:w,singleBranch:S,noCheckout:k,noTags:C,headers:T}){try{if(await iZ({fs:e,gitdir:u}),await JY({fs:e,gitdir:u,remote:y,url:d,force:!1}),h){const I=await Pi.get({fs:e,gitdir:u});await I.set("http.corsProxy",h),await Pi.save({fs:e,gitdir:u,config:I})}const{defaultBranch:R,fetchHead:N}=await mD({fs:e,cache:t,http:n,onProgress:r,onMessage:s,onAuth:i,onAuthSuccess:a,onAuthFailure:o,gitdir:u,ref:m,remote:y,corsProxy:h,depth:b,since:v,exclude:x,relative:w,singleBranch:S,headers:T,tags:!C});if(N===null)return;m=m||R,m=m.replace("refs/heads/",""),await pD({fs:e,cache:t,onProgress:r,onPostCheckout:l,dir:c,gitdir:u,ref:m,remote:y,noCheckout:k})}catch(R){throw await e.rmdir(u,{recursive:!0,maxRetries:10}).catch(()=>{}),R}}async function vke({fs:e,http:t,onProgress:n,onMessage:r,onAuth:s,onAuthSuccess:i,onAuthFailure:a,onPostCheckout:o,dir:l,gitdir:c=$t.join(l,".git"),url:u,corsProxy:d=void 0,ref:h=void 0,remote:m="origin",depth:y=void 0,since:b=void 0,exclude:v=[],relative:x=!1,singleBranch:w=!1,noCheckout:S=!1,noTags:k=!1,headers:C={},cache:T={}}){try{return ct("fs",e),ct("http",t),ct("gitdir",c),S||ct("dir",l),ct("url",u),await bke({fs:new En(e),cache:T,http:t,onProgress:n,onMessage:r,onAuth:s,onAuthSuccess:i,onAuthFailure:a,onPostCheckout:o,dir:l,gitdir:c,url:u,corsProxy:d,ref:h,remote:m,depth:y,since:b,exclude:v,relative:x,singleBranch:w,noCheckout:S,noTags:k,headers:C})}catch(R){throw R.caller="git.clone",R}}async function xke({fs:e,onSign:t,dir:n,gitdir:r=$t.join(n,".git"),message:s,author:i,committer:a,signingKey:o,amend:l=!1,dryRun:c=!1,noUpdateBranch:u=!1,ref:d,parent:h,tree:m,cache:y={}}){try{ct("fs",e),l||ct("message",s),o&&ct("onSign",t);const b=new En(e);return await sT({fs:b,cache:y,onSign:t,gitdir:r,message:s,author:i,committer:a,signingKey:o,amend:l,dryRun:c,noUpdateBranch:u,ref:d,parent:h,tree:m})}catch(b){throw b.caller="git.commit",b}}async function wke({fs:e,dir:t,gitdir:n=$t.join(t,".git"),fullname:r=!1,test:s=!1}){try{return ct("fs",e),ct("gitdir",n),await Yh({fs:new En(e),gitdir:n,fullname:r,test:s})}catch(i){throw i.caller="git.currentBranch",i}}async function _ke({fs:e,gitdir:t,ref:n}){if(n=n.startsWith("refs/heads/")?n:`refs/heads/${n}`,!await Yt.exists({fs:e,gitdir:t,ref:n}))throw new As(n);const s=await Yt.expand({fs:e,gitdir:t,ref:n}),i=await Yh({fs:e,gitdir:t,fullname:!0});if(s===i){const l=await Yt.resolve({fs:e,gitdir:t,ref:s});await Yt.writeRef({fs:e,gitdir:t,ref:"HEAD",value:l})}await Yt.deleteRef({fs:e,gitdir:t,ref:s});const a=rm(n),o=await Pi.get({fs:e,gitdir:t});await o.deleteSection("branch",a),await Pi.save({fs:e,gitdir:t,config:o})}async function Ske({fs:e,dir:t,gitdir:n=$t.join(t,".git"),ref:r}){try{return ct("fs",e),ct("ref",r),await _ke({fs:new En(e),gitdir:n,ref:r})}catch(s){throw s.caller="git.deleteBranch",s}}async function Cke({fs:e,dir:t,gitdir:n=$t.join(t,".git"),ref:r}){try{ct("fs",e),ct("ref",r),await Yt.deleteRef({fs:new En(e),gitdir:n,ref:r})}catch(s){throw s.caller="git.deleteRef",s}}async function kke({fs:e,gitdir:t,remote:n}){const r=await Pi.get({fs:e,gitdir:t});await r.deleteSection("remote",n),await Pi.save({fs:e,gitdir:t,config:r})}async function Eke({fs:e,dir:t,gitdir:n=$t.join(t,".git"),remote:r}){try{return ct("fs",e),ct("remote",r),await kke({fs:new En(e),gitdir:n,remote:r})}catch(s){throw s.caller="git.deleteRemote",s}}async function Tke({fs:e,gitdir:t,ref:n}){n=n.startsWith("refs/tags/")?n:`refs/tags/${n}`,await Yt.deleteRef({fs:e,gitdir:t,ref:n})}async function Ake({fs:e,dir:t,gitdir:n=$t.join(t,".git"),ref:r}){try{return ct("fs",e),ct("ref",r),await Tke({fs:new En(e),gitdir:n,ref:r})}catch(s){throw s.caller="git.deleteTag",s}}async function Rke({fs:e,gitdir:t,oid:n}){const r=n.slice(0,2);return(await e.readdir(`${t}/objects/${r}`)).map(i=>`${r}${i}`).filter(i=>i.startsWith(n))}async function Nke({fs:e,cache:t,gitdir:n,oid:r,getExternalRefDelta:s}){const i=[];let a=await e.readdir($t.join(n,"objects/pack"));a=a.filter(o=>o.endsWith(".idx"));for(const o of a){const l=`${n}/objects/pack/${o}`,c=await hD({fs:e,cache:t,filename:l,getExternalRefDelta:s});if(c.error)throw new vr(c.error);for(const u of c.offsets.keys())u.startsWith(r)&&i.push(u)}return i}async function Mke({fs:e,cache:t,gitdir:n,oid:r}){const s=o=>Xs({fs:e,cache:t,gitdir:n,oid:o}),i=await Rke({fs:e,gitdir:n,oid:r}),a=await Nke({fs:e,cache:t,gitdir:n,oid:r,getExternalRefDelta:s});for(const o of a)i.indexOf(o)===-1&&i.push(o);if(i.length===1)return i[0];throw i.length>1?new A1("oids",r,i):new As(`an object matching "${r}"`)}async function Ike({fs:e,dir:t,gitdir:n=$t.join(t,".git"),oid:r,cache:s={}}){try{return ct("fs",e),ct("gitdir",n),ct("oid",r),await Mke({fs:new En(e),cache:s,gitdir:n,oid:r})}catch(i){throw i.caller="git.expandOid",i}}async function jke({fs:e,dir:t,gitdir:n=$t.join(t,".git"),ref:r}){try{return ct("fs",e),ct("gitdir",n),ct("ref",r),await Yt.expand({fs:new En(e),gitdir:n,ref:r})}catch(s){throw s.caller="git.expandRef",s}}async function gD({fs:e,cache:t,gitdir:n,oids:r}){const s={},i=r.length;let a=r.map((o,l)=>({index:l,oid:o}));for(;a.length;){const o=new Set;for(const{oid:c,index:u}of a)s[c]||(s[c]=new Set),s[c].add(u),s[c].size===i&&o.add(c);if(o.size>0)return[...o];const l=new Map;for(const{oid:c,index:u}of a)try{const{object:d}=await Xs({fs:e,cache:t,gitdir:n,oid:c}),h=Zs.from(d),{parent:m}=h.parseHeaders();for(const y of m)(!s[y]||!s[y].has(u))&&l.set(y+":"+u,{oid:y,index:u})}catch{}a=Array.from(l.values())}return[]}const cI=/^.*(\r?\n|$)/gm;function Oke({branches:e,contents:t}){const n=e[1],r=e[2],s=t[0],i=t[1],a=t[2],o=i.match(cI),l=s.match(cI),c=a.match(cI),u=Q2e(o,l,c),d=7;let h="",m=!0;for(const y of u)y.ok&&(h+=y.ok.join("")),y.conflict&&(m=!1,h+=`${"<".repeat(d)} ${n}
`,h+=y.conflict.a.join(""),h+=`${"=".repeat(d)}
`,h+=y.conflict.b.join(""),h+=`${">".repeat(d)} ${r}
`);return{cleanMerge:m,mergedText:h}}async function Pke({fs:e,cache:t,dir:n,gitdir:r=$t.join(n,".git"),index:s,ourOid:i,baseOid:a,theirOid:o,ourName:l="ours",baseName:c="base",theirName:u="theirs",dryRun:d=!1,abortOnConflict:h=!0,mergeDriver:m}){const y=Wl({ref:i}),b=Wl({ref:a}),v=Wl({ref:o}),x=[],w=[],S=[],k=[],C=await Ah({fs:e,cache:t,dir:n,gitdir:r,trees:[y,b,v],map:async function(T,[R,N,I]){const P=KC(T),B=await JC(R,N),D=await JC(I,N);switch(`${B}-${D}`){case"false-false":return{mode:await N.mode(),path:P,oid:await N.oid(),type:await N.type()};case"false-true":return I?{mode:await I.mode(),path:P,oid:await I.oid(),type:await I.type()}:void 0;case"true-false":return R?{mode:await R.mode(),path:P,oid:await R.oid(),type:await R.type()}:void 0;case"true-true":{if(R&&N&&I&&await R.type()==="blob"&&await N.type()==="blob"&&await I.type()==="blob")return Dke({fs:e,gitdir:r,path:P,ours:R,base:N,theirs:I,ourName:l,baseName:c,theirName:u,mergeDriver:m}).then(async W=>{if(W.cleanMerge)h||s.insert({filepath:T,oid:W.mergeResult.oid,stage:0});else if(x.push(T),w.push(T),!h){const O=await N.oid(),Z=await R.oid(),U=await I.oid();s.delete({filepath:T}),s.insert({filepath:T,oid:O,stage:1}),s.insert({filepath:T,oid:Z,stage:2}),s.insert({filepath:T,oid:U,stage:3})}return W.mergeResult});if(N&&!R&&I&&await N.type()==="blob"&&await I.type()==="blob"){if(x.push(T),S.push(T),!h){const W=await N.oid(),O=await I.oid();s.delete({filepath:T}),s.insert({filepath:T,oid:W,stage:1}),s.insert({filepath:T,oid:O,stage:3})}return{mode:await I.mode(),oid:await I.oid(),type:"blob",path:P}}if(N&&R&&!I&&await N.type()==="blob"&&await R.type()==="blob"){if(x.push(T),k.push(T),!h){const W=await N.oid(),O=await R.oid();s.delete({filepath:T}),s.insert({filepath:T,oid:W,stage:1}),s.insert({filepath:T,oid:O,stage:2})}return{mode:await R.mode(),oid:await R.oid(),type:"blob",path:P}}if(N&&!R&&!I&&await N.type()==="blob")return;throw new sb}}},reduce:x.length!==0&&(!n||h)?void 0:async(T,R)=>{const N=R.filter(Boolean);if(T&&!(T&&T.type==="tree"&&N.length===0)){if(N.length>0){const P=new Lo(N).toObject(),B=await Wo({fs:e,gitdir:r,type:"tree",object:P,dryRun:d});T.oid=B}return T}}});return x.length!==0?(n&&!h&&await Ah({fs:e,cache:t,dir:n,gitdir:r,trees:[Wl({ref:C.oid})],map:async function(T,[R]){const N=`${n}/${T}`;if(await R.type()==="blob"){const I=await R.mode(),P=new TextDecoder().decode(await R.content());await e.write(N,P,{mode:I})}return!0}}),new ib(x,w,S,k)):C.oid}async function Dke({fs:e,gitdir:t,path:n,ours:r,base:s,theirs:i,ourName:a,theirName:o,baseName:l,dryRun:c,mergeDriver:u=Oke}){const d="blob",h=await s.mode()===await r.mode()?await i.mode():await r.mode();if(await r.oid()===await i.oid())return{cleanMerge:!0,mergeResult:{mode:h,path:n,oid:await r.oid(),type:d}};if(await r.oid()===await s.oid())return{cleanMerge:!0,mergeResult:{mode:h,path:n,oid:await i.oid(),type:d}};if(await i.oid()===await s.oid())return{cleanMerge:!0,mergeResult:{mode:h,path:n,oid:await r.oid(),type:d}};const m=ln.from(await r.content()).toString("utf8"),y=ln.from(await s.content()).toString("utf8"),b=ln.from(await i.content()).toString("utf8"),{mergedText:v,cleanMerge:x}=await u({branches:[l,a,o],contents:[y,m,b],path:n}),w=await Wo({fs:e,gitdir:t,type:"blob",object:ln.from(v,"utf8"),dryRun:c});return{cleanMerge:x,mergeResult:{mode:h,path:n,oid:w,type:d}}}async function aZ({fs:e,cache:t,dir:n,gitdir:r,ours:s,theirs:i,fastForward:a=!0,fastForwardOnly:o=!1,dryRun:l=!1,noUpdateBranch:c=!1,abortOnConflict:u=!0,message:d,author:h,committer:m,signingKey:y,onSign:b,mergeDriver:v}){s===void 0&&(s=await Yh({fs:e,gitdir:r,fullname:!0})),s=await Yt.expand({fs:e,gitdir:r,ref:s}),i=await Yt.expand({fs:e,gitdir:r,ref:i});const x=await Yt.resolve({fs:e,gitdir:r,ref:s}),w=await Yt.resolve({fs:e,gitdir:r,ref:i}),S=await gD({fs:e,cache:t,gitdir:r,oids:[x,w]});if(S.length!==1)throw new sb;const k=S[0];if(k===w)return{oid:x,alreadyMerged:!0};if(a&&k===x)return!l&&!c&&await Yt.writeRef({fs:e,gitdir:r,ref:s,value:w}),{oid:w,fastForward:!0};{if(o)throw new I1;const C=await ca.acquire({fs:e,gitdir:r,cache:t,allowUnmerged:!1},async R=>Pke({fs:e,cache:t,dir:n,gitdir:r,index:R,ourOid:x,theirOid:w,baseOid:k,ourName:rm(s),baseName:"base",theirName:rm(i),dryRun:l,abortOnConflict:u,mergeDriver:v}));if(C instanceof ib)throw C;return d||(d=`Merge branch '${rm(i)}' into ${rm(s)}`),{oid:await sT({fs:e,cache:t,gitdir:r,message:d,ref:s,tree:C,parent:[x,w],author:h,committer:m,signingKey:y,onSign:b,dryRun:l,noUpdateBranch:c}),tree:C,mergeCommit:!0}}}async function oZ({fs:e,cache:t,http:n,onProgress:r,onMessage:s,onAuth:i,onAuthSuccess:a,onAuthFailure:o,dir:l,gitdir:c,ref:u,url:d,remote:h,remoteRef:m,prune:y,pruneTags:b,fastForward:v,fastForwardOnly:x,corsProxy:w,singleBranch:S,headers:k,author:C,committer:T,signingKey:R}){try{if(!u){const P=await Yh({fs:e,gitdir:c});if(!P)throw new jo("ref");u=P}const{fetchHead:N,fetchHeadDescription:I}=await mD({fs:e,cache:t,http:n,onProgress:r,onMessage:s,onAuth:i,onAuthSuccess:a,onAuthFailure:o,gitdir:c,corsProxy:w,ref:u,url:d,remote:h,remoteRef:m,singleBranch:S,headers:k,prune:y,pruneTags:b});await aZ({fs:e,cache:t,gitdir:c,ours:u,theirs:N,fastForward:v,fastForwardOnly:x,message:`Merge ${I}`,author:C,committer:T,signingKey:R,dryRun:!1,noUpdateBranch:!1}),await pD({fs:e,cache:t,onProgress:r,dir:l,gitdir:c,ref:u,remote:h,noCheckout:!1})}catch(N){throw N.caller="git.pull",N}}async function Fke({fs:e,http:t,onProgress:n,onMessage:r,onAuth:s,onAuthSuccess:i,onAuthFailure:a,dir:o,gitdir:l=$t.join(o,".git"),ref:c,url:u,remote:d,remoteRef:h,corsProxy:m,singleBranch:y,headers:b={},cache:v={}}){try{ct("fs",e),ct("http",t),ct("gitdir",l);const x={name:"",email:"",timestamp:Date.now(),timezoneOffset:0};return await oZ({fs:new En(e),cache:v,http:t,onProgress:n,onMessage:r,onAuth:s,onAuthSuccess:i,onAuthFailure:a,dir:o,gitdir:l,ref:c,url:u,remote:d,remoteRef:h,fastForwardOnly:!0,corsProxy:m,singleBranch:y,headers:b,author:x,committer:x})}catch(x){throw x.caller="git.fastForward",x}}async function Lke({fs:e,http:t,onProgress:n,onMessage:r,onAuth:s,onAuthSuccess:i,onAuthFailure:a,dir:o,gitdir:l=$t.join(o,".git"),ref:c,remote:u,remoteRef:d,url:h,corsProxy:m,depth:y=null,since:b=null,exclude:v=[],relative:x=!1,tags:w=!1,singleBranch:S=!1,headers:k={},prune:C=!1,pruneTags:T=!1,cache:R={}}){try{return ct("fs",e),ct("http",t),ct("gitdir",l),await mD({fs:new En(e),cache:R,http:t,onProgress:n,onMessage:r,onAuth:s,onAuthSuccess:i,onAuthFailure:a,gitdir:l,ref:c,remote:u,remoteRef:d,url:h,corsProxy:m,depth:y,since:b,exclude:v,relative:x,tags:w,singleBranch:S,headers:k,prune:C,pruneTags:T})}catch(N){throw N.caller="git.fetch",N}}async function Bke({fs:e,dir:t,gitdir:n=$t.join(t,".git"),oids:r,cache:s={}}){try{return ct("fs",e),ct("gitdir",n),ct("oids",r),await gD({fs:new En(e),cache:s,gitdir:n,oids:r})}catch(i){throw i.caller="git.findMergeBase",i}}async function lZ({fs:e,filepath:t}){if(await e.exists($t.join(t,".git")))return t;{const n=dy(t);if(n===t)throw new As(`git root for ${t}`);return lZ({fs:e,filepath:n})}}async function $ke({fs:e,filepath:t}){try{return ct("fs",e),ct("filepath",t),await lZ({fs:new En(e),filepath:t})}catch(n){throw n.caller="git.findRoot",n}}async function zke({fs:e,dir:t,gitdir:n=$t.join(t,".git"),path:r}){try{return ct("fs",e),ct("gitdir",n),ct("path",r),await gw({fs:new En(e),gitdir:n,path:r})}catch(s){throw s.caller="git.getConfig",s}}async function Uke({fs:e,gitdir:t,path:n}){return(await Pi.get({fs:e,gitdir:t})).getall(n)}async function qke({fs:e,dir:t,gitdir:n=$t.join(t,".git"),path:r}){try{return ct("fs",e),ct("gitdir",n),ct("path",r),await Uke({fs:new En(e),gitdir:n,path:r})}catch(s){throw s.caller="git.getConfigAll",s}}async function Vke({http:e,onAuth:t,onAuthSuccess:n,onAuthFailure:r,corsProxy:s,url:i,headers:a={},forPush:o=!1}){try{ct("http",e),ct("url",i);const c=await iT.getRemoteHelperFor({url:i}).discover({http:e,onAuth:t,onAuthSuccess:n,onAuthFailure:r,corsProxy:s,service:o?"git-receive-pack":"git-upload-pack",url:i,headers:a,protocolVersion:1}),u={capabilities:[...c.capabilities]};for(const[d,h]of c.refs){const m=d.split("/"),y=m.pop();let b=u;for(const v of m)b[v]=b[v]||{},b=b[v];b[y]=h}for(const[d,h]of c.symrefs){const m=d.split("/"),y=m.pop();let b=u;for(const v of m)b[v]=b[v]||{},b=b[v];b[y]=h}return u}catch(l){throw l.caller="git.getRemoteInfo",l}}function cZ(e,t,n,r){const s=[];for(const[i,a]of e.refs){if(t&&!i.startsWith(t))continue;if(i.endsWith("^{}")){if(r){const l=i.replace("^{}",""),c=s[s.length-1],u=c.ref===l?c:s.find(d=>d.ref===l);if(u===void 0)throw new Error("I did not expect this to happen");u.peeled=a}continue}const o={ref:i,oid:a};n&&e.symrefs.has(i)&&(o.target=e.symrefs.get(i)),s.push(o)}return s}async function Wke({http:e,onAuth:t,onAuthSuccess:n,onAuthFailure:r,corsProxy:s,url:i,headers:a={},forPush:o=!1,protocolVersion:l=2}){try{ct("http",e),ct("url",i);const u=await iT.getRemoteHelperFor({url:i}).discover({http:e,onAuth:t,onAuthSuccess:n,onAuthFailure:r,corsProxy:s,service:o?"git-receive-pack":"git-upload-pack",url:i,headers:a,protocolVersion:l});if(u.protocolVersion===2)return{protocolVersion:u.protocolVersion,capabilities:u.capabilities2};const d={};for(const h of u.capabilities){const[m,y]=h.split("=");y?d[m]=y:d[m]=!0}return{protocolVersion:1,capabilities:d,refs:cZ(u,void 0,!0,!0)}}catch(c){throw c.caller="git.getRemoteInfo2",c}}async function Hke({type:e,object:t,format:n="content",oid:r=void 0}){return n!=="deflated"&&(n!=="wrapped"&&(t=rb.wrap({type:e,object:t})),r=await Xd(t)),{oid:r,object:t}}async function Gke({object:e}){try{ct("object",e),typeof e=="string"?e=ln.from(e,"utf8"):e=ln.from(e);const t="blob",{oid:n,object:r}=await Hke({type:"blob",format:"content",object:e});return{oid:n,type:t,object:new Uint8Array(r),format:"wrapped"}}catch(t){throw t.caller="git.hashBlob",t}}async function Kke({fs:e,cache:t,onProgress:n,dir:r,gitdir:s,filepath:i}){try{i=$t.join(r,i);const a=await e.read(i),o=c=>Xs({fs:e,cache:t,gitdir:s,oid:c}),l=await fy.fromPack({pack:a,getExternalRefDelta:o,onProgress:n});return await e.write(i.replace(/\.pack$/,".idx"),await l.toBuffer()),{oids:[...l.hashes]}}catch(a){throw a.caller="git.indexPack",a}}async function Yke({fs:e,onProgress:t,dir:n,gitdir:r=$t.join(n,".git"),filepath:s,cache:i={}}){try{return ct("fs",e),ct("dir",n),ct("gitdir",n),ct("filepath",s),await Kke({fs:new En(e),cache:i,onProgress:t,dir:n,gitdir:r,filepath:s})}catch(a){throw a.caller="git.indexPack",a}}async function Zke({fs:e,bare:t=!1,dir:n,gitdir:r=t?n:$t.join(n,".git"),defaultBranch:s="master"}){try{return ct("fs",e),ct("gitdir",r),t||ct("dir",n),await iZ({fs:new En(e),bare:t,dir:n,gitdir:r,defaultBranch:s})}catch(i){throw i.caller="git.init",i}}async function uZ({fs:e,cache:t,gitdir:n,oid:r,ancestor:s,depth:i}){const a=await yw.read({fs:e,gitdir:n});if(!r)throw new jo("oid");if(!s)throw new jo("ancestor");if(r===s)return!1;const o=[r],l=new Set;let c=0;for(;o.length;){if(c++===i)throw new O1(i);const u=o.shift(),{type:d,object:h}=await Xs({fs:e,cache:t,gitdir:n,oid:u});if(d!=="commit")throw new ho(u,d,"commit");const m=Zs.from(h).parse();for(const y of m.parent)if(y===s)return!0;if(!a.has(u))for(const y of m.parent)l.has(y)||(o.push(y),l.add(y))}return!1}async function Xke({fs:e,dir:t,gitdir:n=$t.join(t,".git"),oid:r,ancestor:s,depth:i=-1,cache:a={}}){try{return ct("fs",e),ct("gitdir",n),ct("oid",r),ct("ancestor",s),await uZ({fs:new En(e),cache:a,gitdir:n,oid:r,ancestor:s,depth:i})}catch(o){throw o.caller="git.isDescendent",o}}async function Jke({fs:e,dir:t,gitdir:n=$t.join(t,".git"),filepath:r}){try{return ct("fs",e),ct("dir",t),ct("gitdir",n),ct("filepath",r),ob.isIgnored({fs:new En(e),dir:t,gitdir:n,filepath:r})}catch(s){throw s.caller="git.isIgnored",s}}async function Qke({fs:e,dir:t,gitdir:n=$t.join(t,".git"),remote:r}){try{return ct("fs",e),ct("gitdir",n),Yt.listBranches({fs:new En(e),gitdir:n,remote:r})}catch(s){throw s.caller="git.listBranches",s}}async function eEe({fs:e,gitdir:t,ref:n,cache:r}){if(n){const s=await Yt.resolve({gitdir:t,fs:e,ref:n}),i=[];return await dZ({fs:e,cache:r,gitdir:t,oid:s,filenames:i,prefix:""}),i}else return ca.acquire({fs:e,gitdir:t,cache:r},async function(s){return s.entries.map(i=>i.path)})}async function dZ({fs:e,cache:t,gitdir:n,oid:r,filenames:s,prefix:i}){const{tree:a}=await lb({fs:e,cache:t,gitdir:n,oid:r});for(const o of a)o.type==="tree"?await dZ({fs:e,cache:t,gitdir:n,oid:o.oid,filenames:s,prefix:$t.join(i,o.path)}):s.push($t.join(i,o.path))}async function tEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),ref:r,cache:s={}}){try{return ct("fs",e),ct("gitdir",n),await eEe({fs:new En(e),cache:s,gitdir:n,ref:r})}catch(i){throw i.caller="git.listFiles",i}}async function nEe({fs:e,cache:t,gitdir:n,ref:r}){let s;try{s=await Yt.resolve({gitdir:n,fs:e,ref:r})}catch(o){if(o instanceof As)return[]}return(await lb({fs:e,cache:t,gitdir:n,oid:s})).tree.map(o=>({target:o.path,note:o.oid}))}async function rEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),ref:r="refs/notes/commits",cache:s={}}){try{return ct("fs",e),ct("gitdir",n),ct("ref",r),await nEe({fs:new En(e),cache:s,gitdir:n,ref:r})}catch(i){throw i.caller="git.listNotes",i}}async function sEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),filepath:r}){try{return ct("fs",e),ct("gitdir",n),Yt.listRefs({fs:new En(e),gitdir:n,filepath:r})}catch(s){throw s.caller="git.listRefs",s}}async function iEe({fs:e,gitdir:t}){const n=await Pi.get({fs:e,gitdir:t}),r=await n.getSubsections("remote");return Promise.all(r.map(async i=>{const a=await n.get(`remote.${i}.url`);return{remote:i,url:a}}))}async function aEe({fs:e,dir:t,gitdir:n=$t.join(t,".git")}){try{return ct("fs",e),ct("gitdir",n),await iEe({fs:new En(e),gitdir:n})}catch(r){throw r.caller="git.listRemotes",r}}async function oEe(e){const t=yi.streamReader(e),n=[];let r;for(;r=await t(),r!==!0;){if(r===null)continue;r=r.toString("utf8").replace(/\n$/,"");const[s,i,...a]=r.split(" "),o={ref:i,oid:s};for(const l of a){const[c,u]=l.split(":");c==="symref-target"?o.target=u:c==="peeled"&&(o.peeled=u)}n.push(o)}return n}async function lEe({prefix:e,symrefs:t,peelTags:n}){const r=[];return r.push(yi.encode(`command=ls-refs
`)),r.push(yi.encode(`agent=${aT.agent}
`)),(n||t||e)&&r.push(yi.delim()),n&&r.push(yi.encode("peel")),t&&r.push(yi.encode("symrefs")),e&&r.push(yi.encode(`ref-prefix ${e}`)),r.push(yi.flush()),r}async function cEe({http:e,onAuth:t,onAuthSuccess:n,onAuthFailure:r,corsProxy:s,url:i,headers:a={},forPush:o=!1,protocolVersion:l=2,prefix:c,symrefs:u,peelTags:d}){try{ct("http",e),ct("url",i);const h=await ek.discover({http:e,onAuth:t,onAuthSuccess:n,onAuthFailure:r,corsProxy:s,service:o?"git-receive-pack":"git-upload-pack",url:i,headers:a,protocolVersion:l});if(h.protocolVersion===1)return cZ(h,c,u,d);const m=await lEe({prefix:c,symrefs:u,peelTags:d}),y=await ek.connect({http:e,auth:h.auth,headers:a,corsProxy:s,service:o?"git-receive-pack":"git-upload-pack",url:i,body:m});return oEe(y.body)}catch(h){throw h.caller="git.listServerRefs",h}}async function uEe({fs:e,dir:t,gitdir:n=$t.join(t,".git")}){try{return ct("fs",e),ct("gitdir",n),Yt.listTags({fs:new En(e),gitdir:n})}catch(r){throw r.caller="git.listTags",r}}function dEe(e,t){return e.committer.timestamp-t.committer.timestamp}const fEe="e69de29bb2d1d6434b8b29ae775ad8c2e48c5391";async function Ez({fs:e,cache:t,gitdir:n,oid:r,fileId:s}){if(s===fEe)return;const i=r;let a;const o=await my({fs:e,cache:t,gitdir:n,oid:r}),l=o.tree;return s===o.oid?a=o.path:(a=await fZ({fs:e,cache:t,gitdir:n,tree:l,fileId:s,oid:i}),Array.isArray(a)&&(a.length===0?a=void 0:a.length===1&&(a=a[0]))),a}async function fZ({fs:e,cache:t,gitdir:n,tree:r,fileId:s,oid:i,filepaths:a=[],parentPath:o=""}){const l=r.entries().map(function(c){let u;return c.oid===s?(u=$t.join(o,c.path),a.push(u)):c.type==="tree"&&(u=Xs({fs:e,cache:t,gitdir:n,oid:c.oid}).then(function({object:d}){return fZ({fs:e,cache:t,gitdir:n,tree:Lo.from(d),fileId:s,oid:i,filepaths:a,parentPath:$t.join(o,c.path)})})),u});return await Promise.all(l),a}async function hEe({fs:e,cache:t,gitdir:n,filepath:r,ref:s,depth:i,since:a,force:o,follow:l}){const c=typeof a>"u"?void 0:Math.floor(a.valueOf()/1e3),u=[],d=await yw.read({fs:e,gitdir:n}),h=await Yt.resolve({fs:e,gitdir:n,ref:s}),m=[await yy({fs:e,cache:t,gitdir:n,oid:h})];let y,b,v;function x(w){v&&r&&u.push(w)}for(;m.length>0;){const w=m.pop();if(c!==void 0&&w.commit.committer.timestamp<=c)break;if(r){let S;try{S=await U1({fs:e,cache:t,gitdir:n,oid:w.commit.tree,filepath:r}),b&&y!==S&&u.push(b),y=S,b=w,v=!0}catch(k){if(k instanceof As){let C=l&&y;if(C&&(C=await Ez({fs:e,cache:t,gitdir:n,oid:w.commit.tree,fileId:y}),C))if(Array.isArray(C)){if(b){const T=await Ez({fs:e,cache:t,gitdir:n,oid:b.commit.tree,fileId:y});if(Array.isArray(T))if(C=C.filter(R=>T.indexOf(R)===-1),C.length===1)C=C[0],r=C,b&&u.push(b);else{C=!1,b&&u.push(b);break}}}else r=C,b&&u.push(b);if(!C){if(v&&y&&(u.push(b),!o))break;if(!o&&!l)throw k}b=w,v=!1}else throw k}}else u.push(w);if(i!==void 0&&u.length===i){x(w);break}if(!d.has(w.oid))for(const S of w.commit.parent){const k=await yy({fs:e,cache:t,gitdir:n,oid:S});m.map(C=>C.oid).includes(k.oid)||m.push(k)}m.length===0&&x(w),m.sort((S,k)=>dEe(S.commit,k.commit))}return u}async function pEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),filepath:r,ref:s="HEAD",depth:i,since:a,force:o,follow:l,cache:c={}}){try{return ct("fs",e),ct("gitdir",n),ct("ref",s),await hEe({fs:new En(e),cache:c,gitdir:n,filepath:r,ref:s,depth:i,since:a,force:o,follow:l})}catch(u){throw u.caller="git.log",u}}async function mEe({fs:e,onSign:t,dir:n,gitdir:r=$t.join(n,".git"),ours:s,theirs:i,fastForward:a=!0,fastForwardOnly:o=!1,dryRun:l=!1,noUpdateBranch:c=!1,abortOnConflict:u=!0,message:d,author:h,committer:m,signingKey:y,cache:b={},mergeDriver:v}){try{ct("fs",e),y&&ct("onSign",t);const x=new En(e),w=await Rh({fs:x,gitdir:r,author:h});if(!w&&(!o||!a))throw new za("author");const S=await gy({fs:x,gitdir:r,author:w,committer:m});if(!S&&(!o||!a))throw new za("committer");return await aZ({fs:x,cache:b,dir:n,gitdir:r,ours:s,theirs:i,fastForward:a,fastForwardOnly:o,dryRun:l,noUpdateBranch:c,abortOnConflict:u,message:d,author:w,committer:S,signingKey:y,onSign:t,mergeDriver:v})}catch(x){throw x.caller="git.merge",x}}const gEe={commit:16,tree:32,blob:48,tag:64,ofs_delta:96,ref_delta:112};async function hZ({fs:e,cache:t,dir:n,gitdir:r=$t.join(n,".git"),oids:s}){const i=new NY,a=[];function o(u,d){const h=ln.from(u,d);a.push(h),i.update(h)}async function l({stype:u,object:d}){const h=gEe[u];let m=d.length,y=m>15?128:0;const b=m&15;m=m>>>4;let v=(y|h|b).toString(16);for(o(v,"hex");y;)y=m>127?128:0,v=y|m&127,o(Lj(2,v),"hex"),m=m>>>7;o(ln.from(await HY(d)))}o("PACK"),o("00000002","hex"),o(Lj(8,s.length),"hex");for(const u of s){const{type:d,object:h}=await Xs({fs:e,cache:t,gitdir:r,oid:u});await l({object:h,stype:d})}const c=i.digest();return a.push(c),a}async function yEe({fs:e,cache:t,gitdir:n,oids:r,write:s}){const i=await hZ({fs:e,cache:t,gitdir:n,oids:r}),a=ln.from(await QC(i)),l=`pack-${a.slice(-20).toString("hex")}.pack`;return s?(await e.write($t.join(n,`objects/pack/${l}`),a),{filename:l}):{filename:l,packfile:new Uint8Array(a)}}async function bEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),oids:r,write:s=!1,cache:i={}}){try{return ct("fs",e),ct("gitdir",n),ct("oids",r),await yEe({fs:new En(e),cache:i,gitdir:n,oids:r,write:s})}catch(a){throw a.caller="git.packObjects",a}}async function vEe({fs:e,http:t,onProgress:n,onMessage:r,onAuth:s,onAuthSuccess:i,onAuthFailure:a,dir:o,gitdir:l=$t.join(o,".git"),ref:c,url:u,remote:d,remoteRef:h,prune:m=!1,pruneTags:y=!1,fastForward:b=!0,fastForwardOnly:v=!1,corsProxy:x,singleBranch:w,headers:S={},author:k,committer:C,signingKey:T,cache:R={}}){try{ct("fs",e),ct("gitdir",l);const N=new En(e),I=await Rh({fs:N,gitdir:l,author:k});if(!I)throw new za("author");const P=await gy({fs:N,gitdir:l,author:I,committer:C});if(!P)throw new za("committer");return await oZ({fs:N,cache:R,http:t,onProgress:n,onMessage:r,onAuth:s,onAuthSuccess:i,onAuthFailure:a,dir:o,gitdir:l,ref:c,url:u,remote:d,remoteRef:h,fastForward:b,fastForwardOnly:v,corsProxy:x,singleBranch:w,headers:S,author:I,committer:P,signingKey:T,prune:m,pruneTags:y})}catch(N){throw N.caller="git.pull",N}}async function xEe({fs:e,cache:t,dir:n,gitdir:r=$t.join(n,".git"),start:s,finish:i}){const a=await yw.read({fs:e,gitdir:r}),o=new Set,l=new Set;for(const d of s)o.add(await Yt.resolve({fs:e,gitdir:r,ref:d}));for(const d of i)try{const h=await Yt.resolve({fs:e,gitdir:r,ref:d});l.add(h)}catch{}const c=new Set;async function u(d){c.add(d);const{type:h,object:m}=await Xs({fs:e,cache:t,gitdir:r,oid:d});if(h==="tag"){const b=so.from(m).headers().object;return u(b)}if(h!=="commit")throw new ho(d,h,"commit");if(!a.has(d)){const b=Zs.from(m).headers().parent;for(d of b)!l.has(d)&&!c.has(d)&&await u(d)}}for(const d of o)await u(d);return c}async function uI({fs:e,cache:t,dir:n,gitdir:r=$t.join(n,".git"),oids:s}){const i=new Set;async function a(o){if(i.has(o))return;i.add(o);const{type:l,object:c}=await Xs({fs:e,cache:t,gitdir:r,oid:o});if(l==="tag"){const d=so.from(c).headers().object;await a(d)}else if(l==="commit"){const d=Zs.from(c).headers().tree;await a(d)}else if(l==="tree"){const u=Lo.from(c);for(const d of u)d.type==="blob"&&i.add(d.oid),d.type==="tree"&&await a(d.oid)}}for(const o of s)await a(o);return i}async function wEe(e){const t={};let n="";const r=yi.streamReader(e);let s=await r();for(;s!==!0;)s!==null&&(n+=s.toString("utf8")+`
`),s=await r();const i=n.toString("utf8").split(`
`);if(s=i.shift(),!s.startsWith("unpack "))throw new Qm('unpack ok" or "unpack [error message]',s);t.ok=s==="unpack ok",t.ok||(t.error=s.slice(7)),t.refs={};for(const a of i){if(a.trim()==="")continue;const o=a.slice(0,2),l=a.slice(3);let c=l.indexOf(" ");c===-1&&(c=l.length);const u=l.slice(0,c),d=l.slice(c+1);t.refs[u]={ok:o==="ok",error:d}}return t}async function _Ee({capabilities:e=[],triplets:t=[]}){const n=[];let r=`\0 ${e.join(" ")}`;for(const s of t)n.push(yi.encode(`${s.oldoid} ${s.oid} ${s.fullRef}${r}
`)),r="";return n.push(yi.flush()),n}async function SEe({fs:e,cache:t,http:n,onProgress:r,onMessage:s,onAuth:i,onAuthSuccess:a,onAuthFailure:o,onPrePush:l,gitdir:c,ref:u,remoteRef:d,remote:h,url:m,force:y=!1,delete:b=!1,corsProxy:v,headers:x={}}){const w=u||await Yh({fs:e,gitdir:c});if(typeof w>"u")throw new jo("ref");const S=await Pi.get({fs:e,gitdir:c});h=h||await S.get(`branch.${w}.pushRemote`)||await S.get("remote.pushDefault")||await S.get(`branch.${w}.remote`)||"origin";const k=m||await S.get(`remote.${h}.pushurl`)||await S.get(`remote.${h}.url`);if(typeof k>"u")throw new jo("remote OR url");const C=d||await S.get(`branch.${w}.merge`);if(typeof k>"u")throw new jo("remoteRef");v===void 0&&(v=await S.get("http.corsProxy"));const T=await Yt.expand({fs:e,gitdir:c,ref:w}),R=b?"0000000000000000000000000000000000000000":await Yt.resolve({fs:e,gitdir:c,ref:T}),N=iT.getRemoteHelperFor({url:k}),I=await N.discover({http:n,onAuth:i,onAuthSuccess:a,onAuthFailure:o,corsProxy:v,service:"git-receive-pack",url:k,headers:x,protocolVersion:1}),P=I.auth;let B;if(!C)B=T;else try{B=await Yt.expandAgainstMap({ref:C,map:I.refs})}catch(ee){if(ee instanceof As)B=C.startsWith("refs/")?C:`refs/heads/${C}`;else throw ee}const D=I.refs.get(B)||"0000000000000000000000000000000000000000";if(l&&!await l({remote:h,url:k,localRef:{ref:b?"(delete)":T,oid:R},remoteRef:{ref:B,oid:D}}))throw new ab;const W=!I.capabilities.has("no-thin");let O=new Set;if(!b){const ee=[...I.refs.values()];let se=new Set;if(D!=="0000000000000000000000000000000000000000"){const pe=await gD({fs:e,cache:t,gitdir:c,oids:[R,D]});for(const ue of pe)ee.push(ue);W&&(se=await uI({fs:e,cache:t,gitdir:c,oids:pe}))}if(!ee.includes(R)){const pe=await xEe({fs:e,cache:t,gitdir:c,start:[R],finish:ee});O=await uI({fs:e,cache:t,gitdir:c,oids:pe})}if(W){try{const pe=await Yt.resolve({fs:e,gitdir:c,ref:`refs/remotes/${h}/HEAD`,depth:2}),{oid:ue}=await Yt.resolveAgainstMap({ref:pe.replace(`refs/remotes/${h}/`,""),fullref:pe,map:I.refs}),Oe=[ue];for(const Fe of await uI({fs:e,cache:t,gitdir:c,oids:Oe}))se.add(Fe)}catch{}for(const pe of se)O.delete(pe)}if(R===D&&(y=!0),!y){if(T.startsWith("refs/tags")&&D!=="0000000000000000000000000000000000000000")throw new py("tag-exists");if(R!=="0000000000000000000000000000000000000000"&&D!=="0000000000000000000000000000000000000000"&&!await uZ({fs:e,cache:t,gitdir:c,oid:R,ancestor:D,depth:-1}))throw new py("not-fast-forward")}}const Z=nZ([...I.capabilities],["report-status","side-band-64k",`agent=${aT.agent}`]),U=await _Ee({capabilities:Z,triplets:[{oldoid:D,oid:R,fullRef:B}]}),H=b?[]:await hZ({fs:e,cache:t,gitdir:c,oids:[...O]}),L=await N.connect({http:n,onProgress:r,corsProxy:v,service:"git-receive-pack",url:k,auth:P,headers:x,body:[...U,...H]}),{packfile:te,progress:V}=await sZ.demux(L.body);if(s){const ee=rZ(V);V1(ee,async se=>{await s(se)})}const Q=await wEe(te);if(L.headers&&(Q.headers=L.headers),h&&Q.ok&&Q.refs[B].ok&&!T.startsWith("refs/tags")){const ee=`refs/remotes/${h}/${B.replace("refs/heads","")}`;b?await Yt.deleteRef({fs:e,gitdir:c,ref:ee}):await Yt.writeRef({fs:e,gitdir:c,ref:ee,value:R})}if(Q.ok&&Object.values(Q.refs).every(ee=>ee.ok))return Q;{const ee=Object.entries(Q.refs).filter(([se,pe])=>!pe.ok).map(([se,pe])=>`
  - ${se}: ${pe.error}`).join("");throw new j1(ee,Q)}}async function CEe({fs:e,http:t,onProgress:n,onMessage:r,onAuth:s,onAuthSuccess:i,onAuthFailure:a,onPrePush:o,dir:l,gitdir:c=$t.join(l,".git"),ref:u,remoteRef:d,remote:h="origin",url:m,force:y=!1,delete:b=!1,corsProxy:v,headers:x={},cache:w={}}){try{return ct("fs",e),ct("http",t),ct("gitdir",c),await SEe({fs:new En(e),cache:w,http:t,onProgress:n,onMessage:r,onAuth:s,onAuthSuccess:i,onAuthFailure:a,onPrePush:o,gitdir:c,ref:u,remoteRef:d,remote:h,url:m,force:y,delete:b,corsProxy:v,headers:x})}catch(S){throw S.caller="git.push",S}}async function pZ({fs:e,cache:t,gitdir:n,oid:r}){const{type:s,object:i}=await Xs({fs:e,cache:t,gitdir:n,oid:r});if(s==="tag")return r=so.from(i).parse().object,pZ({fs:e,cache:t,gitdir:n,oid:r});if(s!=="blob")throw new ho(r,s,"blob");return{oid:r,blob:new Uint8Array(i)}}async function mZ({fs:e,cache:t,gitdir:n,oid:r,filepath:s=void 0}){return s!==void 0&&(r=await U1({fs:e,cache:t,gitdir:n,oid:r,filepath:s})),await pZ({fs:e,cache:t,gitdir:n,oid:r})}async function kEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),oid:r,filepath:s,cache:i={}}){try{return ct("fs",e),ct("gitdir",n),ct("oid",r),await mZ({fs:new En(e),cache:i,gitdir:n,oid:r,filepath:s})}catch(a){throw a.caller="git.readBlob",a}}async function gZ({fs:e,dir:t,gitdir:n=$t.join(t,".git"),oid:r,cache:s={}}){try{return ct("fs",e),ct("gitdir",n),ct("oid",r),await yy({fs:new En(e),cache:s,gitdir:n,oid:r})}catch(i){throw i.caller="git.readCommit",i}}async function EEe({fs:e,cache:t,gitdir:n,ref:r="refs/notes/commits",oid:s}){const i=await Yt.resolve({gitdir:n,fs:e,ref:r}),{blob:a}=await mZ({fs:e,cache:t,gitdir:n,oid:i,filepath:s});return a}async function TEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),ref:r="refs/notes/commits",oid:s,cache:i={}}){try{return ct("fs",e),ct("gitdir",n),ct("ref",r),ct("oid",s),await EEe({fs:new En(e),cache:i,gitdir:n,ref:r,oid:s})}catch(a){throw a.caller="git.readNote",a}}async function AEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),oid:r,format:s="parsed",filepath:i=void 0,encoding:a=void 0,cache:o={}}){try{ct("fs",e),ct("gitdir",n),ct("oid",r);const l=new En(e);i!==void 0&&(r=await U1({fs:l,cache:o,gitdir:n,oid:r,filepath:i}));const u=await Xs({fs:l,cache:o,gitdir:n,oid:r,format:s==="parsed"?"content":s});if(u.oid=r,s==="parsed")switch(u.format="parsed",u.type){case"commit":u.object=Zs.from(u.object).parse();break;case"tree":u.object=Lo.from(u.object).entries();break;case"blob":a?u.object=u.object.toString(a):(u.object=new Uint8Array(u.object),u.format="content");break;case"tag":u.object=so.from(u.object).parse();break;default:throw new ho(u.oid,u.type,"blob|commit|tag|tree")}else(u.format==="deflated"||u.format==="wrapped")&&(u.type=u.format);return u}catch(l){throw l.caller="git.readObject",l}}async function REe({fs:e,cache:t,gitdir:n,oid:r}){const{type:s,object:i}=await Xs({fs:e,cache:t,gitdir:n,oid:r,format:"content"});if(s!=="tag")throw new ho(r,s,"tag");const a=so.from(i);return{oid:r,tag:a.parse(),payload:a.payload()}}async function NEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),oid:r,cache:s={}}){try{return ct("fs",e),ct("gitdir",n),ct("oid",r),await REe({fs:new En(e),cache:s,gitdir:n,oid:r})}catch(i){throw i.caller="git.readTag",i}}async function MEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),oid:r,filepath:s=void 0,cache:i={}}){try{return ct("fs",e),ct("gitdir",n),ct("oid",r),await lb({fs:new En(e),cache:i,gitdir:n,oid:r,filepath:s})}catch(a){throw a.caller="git.readTree",a}}async function IEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),filepath:r,cache:s={}}){try{ct("fs",e),ct("gitdir",n),ct("filepath",r),await ca.acquire({fs:new En(e),gitdir:n,cache:s},async function(i){i.delete({filepath:r})})}catch(i){throw i.caller="git.remove",i}}async function jEe({fs:e,cache:t,onSign:n,gitdir:r,ref:s="refs/notes/commits",oid:i,author:a,committer:o,signingKey:l}){let c;try{c=await Yt.resolve({gitdir:r,fs:e,ref:s})}catch(y){if(!(y instanceof As))throw y}let d=(await lb({fs:e,gitdir:r,oid:c||"4b825dc642cb6eb9a060e54bf8d69288fbee4904"})).tree;d=d.filter(y=>y.path!==i);const h=await q1({fs:e,gitdir:r,tree:d});return await sT({fs:e,cache:t,onSign:n,gitdir:r,ref:s,tree:h,parent:c&&[c],message:`Note removed by 'isomorphic-git removeNote'
`,author:a,committer:o,signingKey:l})}async function OEe({fs:e,onSign:t,dir:n,gitdir:r=$t.join(n,".git"),ref:s="refs/notes/commits",oid:i,author:a,committer:o,signingKey:l,cache:c={}}){try{ct("fs",e),ct("gitdir",r),ct("oid",i);const u=new En(e),d=await Rh({fs:u,gitdir:r,author:a});if(!d)throw new za("author");const h=await gy({fs:u,gitdir:r,author:d,committer:o});if(!h)throw new za("committer");return await jEe({fs:u,cache:c,onSign:t,gitdir:r,ref:s,oid:i,author:d,committer:h,signingKey:l})}catch(u){throw u.caller="git.removeNote",u}}async function PEe({fs:e,gitdir:t,oldref:n,ref:r,checkout:s=!1}){if(r!==xu.clean(r))throw new Bc(r,xu.clean(r));if(n!==xu.clean(n))throw new Bc(n,xu.clean(n));const i=`refs/heads/${n}`,a=`refs/heads/${r}`;if(await Yt.exists({fs:e,gitdir:t,ref:a}))throw new qc("branch",r,!1);const l=await Yt.resolve({fs:e,gitdir:t,ref:i,depth:1});await Yt.writeRef({fs:e,gitdir:t,ref:a,value:l}),await Yt.deleteRef({fs:e,gitdir:t,ref:i});const u=await Yh({fs:e,gitdir:t,fullname:!0})===i;(s||u)&&await Yt.writeSymbolicRef({fs:e,gitdir:t,ref:"HEAD",value:a})}async function DEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),ref:r,oldref:s,checkout:i=!1}){try{return ct("fs",e),ct("gitdir",n),ct("ref",r),ct("oldref",s),await PEe({fs:new En(e),gitdir:n,ref:r,oldref:s,checkout:i})}catch(a){throw a.caller="git.renameBranch",a}}async function yZ({gitdir:e,type:t,object:n}){return Xd(rb.wrap({type:t,object:n}))}async function FEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),filepath:r,ref:s,cache:i={}}){try{ct("fs",e),ct("gitdir",n),ct("filepath",r);const a=new En(e);let o,l;try{o=await Yt.resolve({fs:a,gitdir:n,ref:s||"HEAD"})}catch(d){if(s)throw d}if(o)try{o=await U1({fs:a,cache:i,gitdir:n,oid:o,filepath:r})}catch{o=null}let c={ctime:new Date(0),mtime:new Date(0),dev:0,ino:0,mode:0,uid:0,gid:0,size:0};const u=t&&await a.read($t.join(t,r));u&&(l=await yZ({gitdir:n,type:"blob",object:u}),o===l&&(c=await a.lstat($t.join(t,r)))),await ca.acquire({fs:a,gitdir:n,cache:i},async function(d){d.delete({filepath:r}),o&&d.insert({filepath:r,stats:c,oid:o})})}catch(a){throw a.caller="git.reset",a}}async function LEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),ref:r,depth:s}){try{return ct("fs",e),ct("gitdir",n),ct("ref",r),await Yt.resolve({fs:new En(e),gitdir:n,ref:r,depth:s})}catch(i){throw i.caller="git.resolveRef",i}}async function BEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),path:r,value:s,append:i=!1}){try{ct("fs",e),ct("gitdir",n),ct("path",r);const a=new En(e),o=await Pi.get({fs:a,gitdir:n});i?await o.append(r,s):await o.set(r,s),await Pi.save({fs:a,gitdir:n,config:o})}catch(a){throw a.caller="git.setConfig",a}}async function bZ({fs:e,gitdir:t,commit:n}){const r=Zs.from(n).toObject();return await Wo({fs:e,gitdir:t,type:"commit",object:r,format:"content"})}class tk{static get timezoneOffsetForRefLogEntry(){const t=new Date().getTimezoneOffset(),n=Math.abs(Math.floor(t/60)),r=Math.abs(t%60).toString().padStart(2,"0");return`${t>0?"-":"+"}${n.toString().padStart(2,"0")}${r}`}static createStashReflogEntry(t,n,r){const s=t.name.replace(/\s/g,""),i="0000000000000000000000000000000000000000",a=Math.floor(Date.now()/1e3),o=tk.timezoneOffsetForRefLogEntry;return`${i} ${n} ${s} ${t.email} ${a} ${o}	${r}
`}static getStashReflogEntry(t,n=!1){return t.split(`
`).filter(i=>i).reverse().map((i,a)=>n?`stash@{${a}}: ${i.split("	")[1]}`:i)}}const $Ee={stage:nb,workdir:z1};let dI;async function by(e,t){return dI===void 0&&(dI=new mw),dI.acquire(e,t)}async function zEe(e,t,n,r,s=null){const i=$t.join(n,r),a=await e.lstat(i);if(!a)throw new As(i);if(a.isDirectory())throw new vr(`${i}: file expected, but found directory`);const o=s?await zY({fs:e,gitdir:t,oid:s}):void 0;let l=o?s:void 0;return o||await by({fs:e,gitdir:t,currentFilepath:i},async()=>{const c=a.isSymbolicLink()?await e.readlink(i).then(GY):await e.read(i);if(c===null)throw new As(i);l=await Wo({fs:e,gitdir:t,type:"blob",object:c})}),l}async function UEe({fs:e,dir:t,gitdir:n,entries:r}){async function s(i){if(i.type==="tree"){if(!i.oid){const a=await Promise.all(i.children.map(s));i.oid=await q1({fs:e,gitdir:n,tree:a}),i.mode=16384}}else i.type==="blob"&&(i.oid=await zEe(e,n,t,i.path,i.oid),i.mode=33188);return i.path=i.path.split("/").pop(),i}return Promise.all(r.map(s))}async function Tz({fs:e,dir:t,gitdir:n,treePair:r}){const s=r[1]==="stage",i=r.map(m=>typeof m=="string"?$Ee[m]():m),a=[],u=await Ah({fs:e,cache:{},dir:t,gitdir:n,trees:i,map:async(m,[y,b])=>{if(!(m==="."||await ob.isIgnored({fs:e,dir:t,gitdir:n,filepath:m}))&&b)return(!y||await y.oid()!==await b.oid()&&await b.oid()!==void 0)&&a.push([y,b]),{mode:await b.mode(),path:m,oid:await b.oid(),type:await b.type()}},reduce:async(m,y)=>(y=y.filter(Boolean),m?(m.children=y,m):y.length>0?y:void 0),iterate:async(m,y)=>{const b=[];for(const v of y){const[x,w]=v;s?w&&(await e.exists(`${t}/${w.toString()}`)?b.push(v):a.push([null,w])):x&&(w?b.push(v):a.push([x,null]))}return b.length?Promise.all(b.map(m)):[]}});if(a.length===0||u.length===0)return null;const h=(await UEe({fs:e,dir:t,gitdir:n,entries:u})).filter(Boolean).map(m=>({mode:m.mode,path:m.path,oid:m.oid,type:m.type}));return q1({fs:e,gitdir:n,tree:h})}async function qEe({fs:e,dir:t,gitdir:n,stashCommit:r,parentCommit:s,wasStaged:i}){const a=[],o=[],l=await Ah({fs:e,cache:{},dir:t,gitdir:n,trees:[Wl({ref:s}),Wl({ref:r})],map:async(c,[u,d])=>{if(c==="."||await ob.isIgnored({fs:e,dir:t,gitdir:n,filepath:c}))return;const h=d?await d.type():await u.type();if(h!=="tree"&&h!=="blob")return;if(!d&&u){const y=h==="tree"?"rmdir":"rm";return h==="tree"&&a.push(c),h==="blob"&&i&&o.push({filepath:c,oid:await u.oid()}),{method:y,filepath:c}}const m=await d.oid();if(!u||await u.oid()!==m)return h==="tree"?{method:"mkdir",filepath:c}:(i&&o.push({filepath:c,oid:m,stats:await e.lstat($t.join(t,c))}),{method:"write",filepath:c,oid:m})}});await by({fs:e,gitdir:n,dirRemoved:a,ops:l},async()=>{for(const c of l){const u=$t.join(t,c.filepath);switch(c.method){case"rmdir":await e.rmdir(u);break;case"mkdir":await e.mkdir(u);break;case"rm":await e.rm(u);break;case"write":if(!a.some(d=>u.startsWith(d))){const{object:d}=await Xs({fs:e,cache:{},gitdir:n,oid:c.oid});await e.exists(u)&&await e.rm(u),await e.write(u,d)}break}}}),await ca.acquire({fs:e,gitdir:n,cache:{}},async c=>{o.forEach(({filepath:u,stats:d,oid:h})=>{c.insert({filepath:u,stats:d,oid:h})})})}class $d{constructor({fs:t,dir:n,gitdir:r=$t.join(n,".git")}){Object.assign(this,{fs:t,dir:n,gitdir:r,_author:null})}static get refStash(){return"refs/stash"}static get refLogsStash(){return"logs/refs/stash"}get refStashPath(){return $t.join(this.gitdir,$d.refStash)}get refLogsStashPath(){return $t.join(this.gitdir,$d.refLogsStash)}async getAuthor(){if(!this._author&&(this._author=await Rh({fs:this.fs,gitdir:this.gitdir,author:{}}),!this._author))throw new za("author");return this._author}async getStashSHA(t,n){return await this.fs.exists(this.refStashPath)?(n||await this.readStashReflogs({parsed:!1}))[t].split(" ")[1]:null}async writeStashCommit({message:t,tree:n,parent:r}){return bZ({fs:this.fs,gitdir:this.gitdir,commit:{message:t,tree:n,parent:r,author:await this.getAuthor(),committer:await this.getAuthor()}})}async readStashCommit(t){const n=await this.readStashReflogs({parsed:!1});if(t!==0&&(t<0||t>n.length-1))throw new Bc(`stash@${t}`,"number that is in range of [0, num of stash pushed]");const r=await this.getStashSHA(t,n);return r?yy({fs:this.fs,cache:{},gitdir:this.gitdir,oid:r}):{}}async writeStashRef(t){return Yt.writeRef({fs:this.fs,gitdir:this.gitdir,ref:$d.refStash,value:t})}async writeStashReflogEntry({stashCommit:t,message:n}){const r=await this.getAuthor(),s=tk.createStashReflogEntry(r,t,n),i=this.refLogsStashPath;await by({filepath:i,entry:s},async()=>{const a=await this.fs.exists(i)?await this.fs.read(i,"utf8"):"";await this.fs.write(i,a+s,"utf8")})}async readStashReflogs({parsed:t=!1}){if(!await this.fs.exists(this.refLogsStashPath))return[];const r=(await this.fs.read(this.refLogsStashPath)).toString();return tk.getStashReflogEntry(r,t)}}async function VEe({fs:e,dir:t,gitdir:n,message:r=""}){const s=new $d({fs:e,dir:t,gitdir:n});await s.getAuthor();const i=await Yh({fs:e,gitdir:n,fullname:!1}),a=await Yt.resolve({fs:e,gitdir:n,ref:"HEAD"}),l=(await gZ({fs:e,dir:t,gitdir:n,oid:a})).commit.message,c=[a];let u=null,d=Wl({ref:"HEAD"});const h=await Tz({fs:e,dir:t,gitdir:n,treePair:[Wl({ref:"HEAD"}),"stage"]});if(h){const v=await s.writeStashCommit({message:`stash-Index: WIP on ${i} - ${new Date().toISOString()}`,tree:h,parent:c});c.push(v),u=h,d=nb()}const m=await Tz({fs:e,dir:t,gitdir:n,treePair:[d,"workdir"]});if(m){const v=await s.writeStashCommit({message:`stash-WorkDir: WIP on ${i} - ${new Date().toISOString()}`,tree:m,parent:[c[c.length-1]]});c.push(v),u=m}if(!u||!h&&!m)throw new As("changes, nothing to stash");const y=(r.trim()||`WIP on ${i}`)+`: ${a.substring(0,7)} ${l}`,b=await s.writeStashCommit({message:y,tree:u,parent:c});return await s.writeStashRef(b),await s.writeStashReflogEntry({stashCommit:b,message:y}),await eZ({fs:e,dir:t,gitdir:n,ref:i,track:!1,force:!0}),b}async function vZ({fs:e,dir:t,gitdir:n,refIdx:r=0}){const i=await new $d({fs:e,dir:t,gitdir:n}).readStashCommit(r),{parent:a=null}=i.commit?i.commit:{};if(!(!a||!Array.isArray(a)))for(let o=0;o<a.length-1;o++){const c=(await yy({fs:e,cache:{},gitdir:n,oid:a[o+1]})).commit.message.startsWith("stash-Index");await qEe({fs:e,dir:t,gitdir:n,stashCommit:a[o+1],parentCommit:a[o],wasStaged:c})}}async function xZ({fs:e,dir:t,gitdir:n,refIdx:r=0}){const s=new $d({fs:e,dir:t,gitdir:n});if(!(await s.readStashCommit(r)).commit)return;const a=s.refStashPath;await by(a,async()=>{await e.exists(a)&&await e.rm(a)});const o=await s.readStashReflogs({parsed:!1});if(!o.length)return;o.splice(r,1);const l=s.refLogsStashPath;await by({reflogEntries:o,stashReflogPath:l,stashMgr:s},async()=>{if(o.length){await e.write(l,o.join(`
`),"utf8");const c=o[o.length-1].split(" ")[1];await s.writeStashRef(c)}else await e.rm(l)})}async function WEe({fs:e,dir:t,gitdir:n}){return new $d({fs:e,dir:t,gitdir:n}).readStashReflogs({parsed:!0})}async function HEe({fs:e,dir:t,gitdir:n}){const r=new $d({fs:e,dir:t,gitdir:n}),s=[r.refStashPath,r.refLogsStashPath];await by(s,async()=>{await Promise.all(s.map(async i=>{if(await e.exists(i))return e.rm(i)}))})}async function GEe({fs:e,dir:t,gitdir:n,refIdx:r=0}){await vZ({fs:e,dir:t,gitdir:n,refIdx:r}),await xZ({fs:e,dir:t,gitdir:n,refIdx:r})}async function KEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),op:r="push",message:s="",refIdx:i=0}){ct("fs",e),ct("dir",t),ct("gitdir",n),ct("op",r);const a={push:VEe,apply:vZ,drop:xZ,list:WEe,clear:HEe,pop:GEe},o=["apply","drop","pop"];try{const l=new En(e);["refs","logs","logs/refs"].map(d=>$t.join(n,d)).forEach(async d=>{await l.exists(d)||await l.mkdir(d)});const u=a[r];if(u){if(o.includes(r)&&i<0)throw new Bc(`stash@${i}`,"number that is in range of [0, num of stash pushed]");return await u({fs:l,dir:t,gitdir:n,message:s,refIdx:i})}throw new Error(`To be implemented: ${r}`)}catch(l){throw l.caller="git.stash",l}}async function YEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),filepath:r,cache:s={}}){try{ct("fs",e),ct("gitdir",n),ct("filepath",r);const i=new En(e);if(await ob.isIgnored({fs:i,gitdir:n,dir:t,filepath:r}))return"ignored";const o=await ZEe({fs:i,cache:s,gitdir:n}),l=await wZ({fs:i,cache:s,gitdir:n,tree:o,path:r}),c=await ca.acquire({fs:i,gitdir:n,cache:s},async function(b){for(const v of b)if(v.path===r)return v;return null}),u=await i.lstat($t.join(t,r)),d=l!==null,h=c!==null,m=u!==null,y=async()=>{if(h&&!GC(c,u))return c.oid;{const b=await i.read($t.join(t,r)),v=await yZ({gitdir:n,type:"blob",object:b});return h&&c.oid===v&&u.size!==-1&&ca.acquire({fs:i,gitdir:n,cache:s},async function(x){x.insert({filepath:r,stats:u,oid:v})}),v}};if(!d&&!m&&!h)return"absent";if(!d&&!m&&h)return"*absent";if(!d&&m&&!h)return"*added";if(!d&&m&&h)return await y()===c.oid?"added":"*added";if(d&&!m&&!h)return"deleted";if(d&&!m&&h)return l===c.oid,"*deleted";if(d&&m&&!h)return await y()===l?"*undeleted":"*undeletemodified";if(d&&m&&h){const b=await y();return b===l?b===c.oid?"unmodified":"*unmodified":b===c.oid?"modified":"*modified"}}catch(i){throw i.caller="git.status",i}}async function wZ({fs:e,cache:t,gitdir:n,tree:r,path:s}){typeof s=="string"&&(s=s.split("/"));const i=s.shift();for(const a of r)if(a.path===i){if(s.length===0)return a.oid;const{type:o,object:l}=await Xs({fs:e,cache:t,gitdir:n,oid:a.oid});if(o==="tree"){const c=Lo.from(l);return wZ({fs:e,cache:t,gitdir:n,tree:c,path:s})}if(o==="blob")throw new ho(a.oid,o,"blob",s.join("/"))}return null}async function ZEe({fs:e,cache:t,gitdir:n}){let r;try{r=await Yt.resolve({fs:e,gitdir:n,ref:"HEAD"})}catch(i){if(i instanceof As)return[]}const{tree:s}=await lb({fs:e,cache:t,gitdir:n,oid:r});return s}async function XEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),ref:r="HEAD",filepaths:s=["."],filter:i,cache:a={},ignored:o=!1}){try{ct("fs",e),ct("gitdir",n),ct("ref",r);const l=new En(e);return await Ah({fs:l,cache:a,dir:t,gitdir:n,trees:[Wl({ref:r}),z1(),nb()],map:async function(c,[u,d,h]){if(!u&&!h&&d&&!o&&await ob.isIgnored({fs:l,dir:t,filepath:c})||!s.some(T=>QY(c,T)))return null;if(i&&!i(c))return;const[m,y,b]=await Promise.all([u&&u.type(),d&&d.type(),h&&h.type()]),v=[m,y,b].includes("blob");if((m==="tree"||m==="special")&&!v)return;if(m==="commit")return null;if((y==="tree"||y==="special")&&!v)return;if(b==="commit")return null;if((b==="tree"||b==="special")&&!v)return;const x=m==="blob"?await u.oid():void 0,w=b==="blob"?await h.oid():void 0;let S;m!=="blob"&&y==="blob"&&b!=="blob"?S="42":y==="blob"&&(S=await d.oid());const k=[void 0,x,S,w],C=k.map(T=>k.indexOf(T));return C.shift(),[c,...C]}})}catch(l){throw l.caller="git.statusMatrix",l}}async function JEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),ref:r,object:s,force:i=!1}){try{ct("fs",e),ct("gitdir",n),ct("ref",r);const a=new En(e);if(r===void 0)throw new jo("ref");r=r.startsWith("refs/tags/")?r:`refs/tags/${r}`;const o=await Yt.resolve({fs:a,gitdir:n,ref:s||"HEAD"});if(!i&&await Yt.exists({fs:a,gitdir:n,ref:r}))throw new qc("tag",r);await Yt.writeRef({fs:a,gitdir:n,ref:r,value:o})}catch(a){throw a.caller="git.tag",a}}async function QEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),cache:r={},filepath:s,oid:i,mode:a,add:o,remove:l,force:c}){try{ct("fs",e),ct("gitdir",n),ct("filepath",s);const u=new En(e);if(l)return await ca.acquire({fs:u,gitdir:n,cache:r},async function(h){if(!c){const m=await u.lstat($t.join(t,s));if(m){if(m.isDirectory())throw new Th("directory");return}}h.has({filepath:s})&&h.delete({filepath:s})});let d;if(!i){if(d=await u.lstat($t.join(t,s)),!d)throw new As(`file at "${s}" on disk and "remove" not set`);if(d.isDirectory())throw new Th("directory")}return await ca.acquire({fs:u,gitdir:n,cache:r},async function(h){if(!o&&!h.has({filepath:s}))throw new As(`file at "${s}" in index and "add" not set`);let m;if(i)m={ctime:new Date(0),mtime:new Date(0),dev:0,ino:0,mode:a,uid:0,gid:0,size:0};else{m=d;const y=m.isSymbolicLink()?await u.readlink($t.join(t,s)):await u.read($t.join(t,s));i=await Wo({fs:u,gitdir:n,type:"blob",format:"content",object:y})}return h.insert({filepath:s,oid:i,stats:m}),i})}catch(u){throw u.caller="git.updateIndex",u}}function eTe(){try{return aT.version}catch(e){throw e.caller="git.version",e}}async function tTe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),trees:r,map:s,reduce:i,iterate:a,cache:o={}}){try{return ct("fs",e),ct("gitdir",n),ct("trees",r),await Ah({fs:new En(e),cache:o,dir:t,gitdir:n,trees:r,map:s,reduce:i,iterate:a})}catch(l){throw l.caller="git.walk",l}}async function nTe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),blob:r}){try{return ct("fs",e),ct("gitdir",n),ct("blob",r),await Wo({fs:new En(e),gitdir:n,type:"blob",object:r,format:"content"})}catch(s){throw s.caller="git.writeBlob",s}}async function rTe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),commit:r}){try{return ct("fs",e),ct("gitdir",n),ct("commit",r),await bZ({fs:new En(e),gitdir:n,commit:r})}catch(s){throw s.caller="git.writeCommit",s}}async function sTe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),type:r,object:s,format:i="parsed",oid:a,encoding:o=void 0}){try{const l=new En(e);if(i==="parsed"){switch(r){case"commit":s=Zs.from(s).toObject();break;case"tree":s=Lo.from(s).toObject();break;case"blob":s=ln.from(s,o);break;case"tag":s=so.from(s).toObject();break;default:throw new ho(a||"",r,"blob|commit|tag|tree")}i="content"}return a=await Wo({fs:l,gitdir:n,type:r,object:s,oid:a,format:i}),a}catch(l){throw l.caller="git.writeObject",l}}async function iTe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),ref:r,value:s,force:i=!1,symbolic:a=!1}){try{ct("fs",e),ct("gitdir",n),ct("ref",r),ct("value",s);const o=new En(e);if(r!==xu.clean(r))throw new Bc(r,xu.clean(r));if(!i&&await Yt.exists({fs:o,gitdir:n,ref:r}))throw new qc("ref",r);a?await Yt.writeSymbolicRef({fs:o,gitdir:n,ref:r,value:s}):(s=await Yt.resolve({fs:o,gitdir:n,ref:s}),await Yt.writeRef({fs:o,gitdir:n,ref:r,value:s}))}catch(o){throw o.caller="git.writeRef",o}}async function aTe({fs:e,gitdir:t,tag:n}){const r=so.from(n).toObject();return await Wo({fs:e,gitdir:t,type:"tag",object:r,format:"content"})}async function oTe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),tag:r}){try{return ct("fs",e),ct("gitdir",n),ct("tag",r),await aTe({fs:new En(e),gitdir:n,tag:r})}catch(s){throw s.caller="git.writeTag",s}}async function lTe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),tree:r}){try{return ct("fs",e),ct("gitdir",n),ct("tree",r),await q1({fs:new En(e),gitdir:n,tree:r})}catch(s){throw s.caller="git.writeTree",s}}var Ui={Errors:DCe,STAGE:nb,TREE:Wl,WORKDIR:z1,add:eke,abortMerge:ZCe,addNote:nke,addRemote:rke,annotatedTag:ike,branch:oke,checkout:eZ,clone:vke,commit:xke,getConfig:zke,getConfigAll:qke,setConfig:BEe,currentBranch:wke,deleteBranch:Ske,deleteRef:Cke,deleteRemote:Eke,deleteTag:Ake,expandOid:Ike,expandRef:jke,fastForward:Fke,fetch:Lke,findMergeBase:Bke,findRoot:$ke,getRemoteInfo:Vke,getRemoteInfo2:Wke,hashBlob:Gke,indexPack:Yke,init:Zke,isDescendent:Xke,isIgnored:Jke,listBranches:Qke,listFiles:tEe,listNotes:rEe,listRefs:sEe,listRemotes:aEe,listServerRefs:cEe,listTags:uEe,log:pEe,merge:mEe,packObjects:bEe,pull:vEe,push:CEe,readBlob:kEe,readCommit:gZ,readNote:TEe,readObject:AEe,readTag:NEe,readTree:MEe,remove:IEe,removeNote:OEe,renameBranch:DEe,resetIndex:FEe,updateIndex:QEe,resolveRef:LEe,status:YEe,statusMatrix:XEe,tag:JEe,version:eTe,walk:tTe,writeBlob:nTe,writeCommit:rTe,writeObject:sTe,writeRef:iTe,writeTag:oTe,writeTree:lTe,stash:KEe};function cTe(e){let t=[e];return{next(){return Promise.resolve({done:t.length===0,value:t.pop()})},return(){return t=[],{}},[Symbol.asyncIterator](){return this}}}function uTe(e){return e[Symbol.asyncIterator]?e[Symbol.asyncIterator]():e[Symbol.iterator]?e[Symbol.iterator]():e.next?e:cTe(e)}async function dTe(e,t){const n=uTe(e);for(;;){const{value:r,done:s}=await n.next();if(r&&await t(r),s)break}n.return&&n.return()}async function fTe(e){let t=0;const n=[];await dTe(e,i=>{n.push(i),t+=i.byteLength});const r=new Uint8Array(t);let s=0;for(const i of n)r.set(i,s),s+=i.byteLength;return r}function hTe(e){if(e[Symbol.asyncIterator])return e;const t=e.getReader();return{next(){return t.read()},return(){return t.releaseLock(),{}},[Symbol.asyncIterator](){return this}}}async function pTe({onProgress:e,url:t,method:n="GET",headers:r={},body:s}){s&&(s=await fTe(s));const i=await fetch(t,{method:n,headers:r,body:s}),a=i.body&&i.body.getReader?hTe(i.body):[new Uint8Array(await i.arrayBuffer())];r={};for(const[o,l]of i.headers.entries())r[o]=l;return{url:i.url,method:i.method,statusCode:i.status,statusMessage:i.statusText,body:a,headers:r}}var bw={request:pTe};const vw="https://cors.isomorphic-git.org",vy=new Map,_Z=async(e,t)=>{const{gitUserName:n,gitUserEmail:r}=br.getState();if(!n||!r)return Me.error("Git user name and email must be configured in Settings before committing."),!1;try{const s=await Ui.getConfig({fs:t,dir:e,path:"user.name"}).catch(()=>null),i=await Ui.getConfig({fs:t,dir:e,path:"user.email"}).catch(()=>null);return s!==n&&await Ui.setConfig({fs:t,dir:e,path:"user.name",value:n}),i!==r&&await Ui.setConfig({fs:t,dir:e,path:"user.email",value:r}),!0}catch(s){return console.error("[VFS Git Op] Error checking/setting Git config:",s),Me.error(`Failed to configure Git user: ${s instanceof Error?s.message:String(s)}`),!1}},xw=async(e,t)=>{const n=new URL(e).origin;if(console.log(`[VFS Git Op] Auth requested for ${e}`),t!=null&&t.username&&(t!=null&&t.password))return console.log(`[VFS Git Op] Using stored credentials for ${e}`),{username:t.username,password:t.password,authScheme:"Basic"};const r=vy.get(n);if(r!=null&&r.username&&(r!=null&&r.password))return console.log(`[VFS Git Op] Using session credentials for ${e}`),{username:r.username,password:r.password,authScheme:"Basic"};console.log(`[VFS Git Op] No stored or session credentials found for ${e}. Prompting user.`);const s=window.prompt(`Enter username for ${e}`);if(!s)return Me.error("Authentication cancelled: Username not provided."),null;const i=window.prompt(`Enter password or token for ${s}@${e}`);return i?(vy.set(n,{username:s,password:i}),console.log(`[VFS Git Op] Stored prompted credentials in session for ${n}`),{username:s,password:i,authScheme:"Basic"}):(Me.error("Authentication cancelled: Password/token not provided."),null)},ww=(e,t)=>{const n=new URL(e).origin;return console.error(`[VFS Git Op] Auth FAILED for ${e}`,t),vy.has(n)&&(console.log(`[VFS Git Op] Clearing failed session credentials for ${n}`),vy.delete(n)),null},_w=(e,t)=>{console.log(`[VFS Git Op] Auth SUCCESS for ${e}`,t);const n=new URL(e).origin;!vy.has(n)&&t.username&&t.password&&(vy.set(n,{username:t.username,password:t.password}),console.log(`[VFS Git Op] Stored successful prompted credentials in session for ${n}`))},j0=e=>{if(e.name==="HttpError"&&e.data){const{statusCode:t,statusMessage:n,body:r}=e.data;let s="";if(r)try{const i=JSON.parse(r);s=i.message||i.error||JSON.stringify(i)}catch{s=r}return`HTTP ${t} ${n}${s?`: ${s}`:""}`}return e.name==="NotFoundError"?`Not Found: ${e.message}`:e.code==="CheckoutConflictError"?"Checkout conflict: Local changes would be overwritten.":e.code==="MergeConflictError"?"Merge conflict: Resolve conflicts manually.":e instanceof Error?e.message:String(e)},mTe=async(e,t)=>{const n=fa,r=zr(e),s=Du(r,".git");try{return(await n.promises.stat(s)).isDirectory()}catch(i){return i instanceof Error&&i.code==="ENOENT"||console.error(`[VFS Git Op] Error checking for .git in ${r}:`,i),!1}},SZ=async(e,t,n,r,s)=>{var o;const i=(s==null?void 0:s.fsInstance)??fa,a=zr(e);console.log(`[VFS Git Op] Attempting to clone ${t} into ${a}`);try{let l=!1;try{await i.promises.stat(Du(a,".git")),l=!0}catch(h){if(h.code!=="ENOENT")throw h}if(l)throw console.warn(`[VFS Git Op] Clone target ${a} already contains a .git directory.`),new Error(`Repository already cloned at ${a}.`);const c=tT(a);if(c!=="/")try{await i.promises.mkdir(c,{recursive:!0})}catch(h){if(h.code!=="EEXIST")throw h}let u=n;if(!u)try{if(u=(o=(await Ui.getRemoteInfo({http:bw,url:t,corsProxy:vw,onAuth:m=>xw(m,r),onAuthFailure:ww,onAuthSuccess:_w})).HEAD)==null?void 0:o.replace("refs/heads/",""),!u)throw new Error("Could not determine default branch from remote.");console.log(`[VFS Git Op] No branch specified, using remote default: ${u}`)}catch(h){throw console.error("[VFS Git Op] Failed to get remote info to determine default branch:",h),new Error(`Failed to determine default branch: ${j0(h)}`)}await Ui.clone({fs:i,http:bw,dir:a,corsProxy:vw,url:t,ref:u,singleBranch:!0,depth:10,onAuth:h=>xw(h,r),onAuthFailure:ww,onAuthSuccess:_w,onProgress:h=>{h.phase==="counting objects"&&h.total?console.log(`Clone progress: ${h.phase} ${h.loaded}/${h.total}`):h.phase==="receiving objects"&&h.total?console.log(`Clone progress: ${h.phase} ${h.loaded}/${h.total}`):console.log(`Clone progress: ${h.phase}`)}}),await i.promises.stat(Du(a,".git"));const d=await Ui.currentBranch({fs:i,dir:a,fullname:!1}).catch(()=>null);d!==u&&(console.warn(`[VFS Git Op] Cloned repo HEAD is at ${d}, expected ${u}. Checking out...`),await Ui.checkout({fs:i,dir:a,ref:u})),Me.success(`Repository cloned successfully into ${a} (branch: ${u}).`),console.log(`[VFS Git Op] Clone successful for ${t}`)}catch(l){console.error(`[VFS Git Op] Git clone failed for ${t}:`,l);const c=j0(l);if(l instanceof Error&&l.message.includes("already cloned")||Me.error(`Git clone failed: ${c}`),!(l instanceof Error&&l.message.includes("already cloned")))try{console.log(`[VFS Git Op] Attempting cleanup of failed clone: ${a}`),await i.promises.rm(a,{recursive:!0,force:!0})}catch(u){console.warn("[VFS Git Op] Failed cleanup after clone error:",u)}throw l}},CZ=async(e,t)=>{const n=(t==null?void 0:t.fsInstance)??fa,r=zr(e);try{await Ui.init({fs:n,dir:r}),Me.success(`Initialized empty Git repository in "${vi(r)}"`)}catch(s){throw console.error(`[VFS Git Op] Git init failed for ${r}:`,s),Me.error(`Git init failed: ${s instanceof Error?s.message:String(s)}`),s}},yD=async(e,t,n)=>{const r=(n==null?void 0:n.fsInstance)??fa,s=zr(e);try{if(!await _Z(s,r))throw new Error("Git user configuration is missing or invalid.");if(await Ui.add({fs:r,dir:s,filepath:"."}),!(await Ui.statusMatrix({fs:r,dir:s})).some(([,,c])=>c!==0)){Me.info("No changes detected to commit.");return}const l=await Ui.commit({fs:r,dir:s,message:t,author:{name:br.getState().gitUserName,email:br.getState().gitUserEmail}});Me.success(`Changes committed: ${l.substring(0,7)}`)}catch(i){throw console.error(`[VFS Git Op] Git commit failed for ${s}:`,i),Me.error(`Git commit failed: ${i instanceof Error?i.message:String(i)}`),i}},oT=async(e,t,n,r)=>{const s=(r==null?void 0:r.fsInstance)??fa,i=zr(e);try{if(!await _Z(i,s))throw new Error("Git user configuration is missing or invalid.");if(!t)throw new Error("Branch name must be provided for pull operation.");console.log(`[VFS Git Op] Pulling branch ${t} for ${i}`);const o=await Ui.currentBranch({fs:s,dir:i,fullname:!1}).catch(()=>null);if(o!==t){console.log(`[VFS Git Op] Current branch is ${o}, switching to ${t} before pull...`);try{await Ui.checkout({fs:s,dir:i,ref:t})}catch(l){if(l.code==="NotFoundError"){console.log(`[VFS Git Op] Local branch ${t} not found. Attempting to fetch and create...`);try{await Ui.fetch({fs:s,http:bw,dir:i,corsProxy:vw,remote:"origin",ref:t,depth:1,singleBranch:!0,tags:!1,onAuth:c=>xw(c,n),onAuthFailure:ww,onAuthSuccess:_w}),await Ui.branch({fs:s,dir:i,ref:t,checkout:!0}),console.log(`[VFS Git Op] Successfully created and checked out local branch ${t}.`)}catch(c){throw console.error(`[VFS Git Op] Failed to create local branch ${t} from remote:`,c),new Error(`Failed to switch to or create local branch "${t}": ${j0(c)}`)}}else throw console.error(`[VFS Git Op] Failed to checkout branch ${t}:`,l),new Error(`Failed to checkout branch "${t}": ${j0(l)}`)}}await Ui.pull({fs:s,http:bw,dir:i,ref:t,singleBranch:!0,author:{name:br.getState().gitUserName,email:br.getState().gitUserEmail},corsProxy:vw,onAuth:l=>xw(l,n),onAuthFailure:ww,onAuthSuccess:_w}),Me.success(`Pulled changes successfully for "${vi(i)}"`),console.log(`[VFS Git Op] Pull successful for ${i}`)}catch(a){if(console.error(`[VFS Git Op] Git pull failed for ${i}:`,a),a instanceof Error&&a.message.toLowerCase().includes("already up-to-date")?Me.info(`Branch "${t}" is already up-to-date.`):Me.error(`Git pull failed: ${j0(a)}`),!(a instanceof Error&&a.message.toLowerCase().includes("already up-to-date")))throw a}},bD=async(e,t,n,r)=>{var a,o;const s=(r==null?void 0:r.fsInstance)??fa,i=zr(e);try{if(!t)throw new Error("Branch name must be provided for push operation.");console.log(`[VFS Git Op] Pushing local branch ${t} for ${i}`);const l=await Ui.push({fs:s,http:bw,dir:i,corsProxy:vw,ref:t,remote:"origin",remoteRef:`refs/heads/${t}`,force:!1,onAuth:c=>xw(c,n),onAuthFailure:ww,onAuthSuccess:_w});if(l!=null&&l.ok)Me.success(`Pushed changes successfully for "${vi(i)}"`);else if((a=l==null?void 0:l.error)!=null&&a.includes("up-to-date"))Me.info(`Branch "${t}" already up-to-date on remote.`);else throw(o=l==null?void 0:l.error)!=null&&o.includes("rejected")?(Me.error(`Push rejected for "${vi(i)}". Pull changes first.`),new Error(l.error)):new Error((l==null?void 0:l.error)||"Push rejected by remote")}catch(l){throw console.error(`[VFS Git Op] Git push failed for ${i}:`,l),l instanceof Error&&l.message.includes("rejected")||Me.error(`Git push failed: ${j0(l)}`),l}},kZ=async(e,t)=>{const n=(t==null?void 0:t.fsInstance)??fa,r=zr(e);console.log(`[VFS Git Op] Git Status on ${r}`);try{const s=await Ui.statusMatrix({fs:n,dir:r});console.log("Git Status Matrix:",s);const i=s.map(([a,o,l,c])=>{let u="";return c===2&&(u+="INDEX_Modified "),c===3&&(u+="INDEX_Added "),o===0&&l===2?u+="WT_New":o===1&&l===2?u+="WT_Modified":o===1&&l===0?u+="WT_Deleted":o===1&&l===1&&c===0&&(u="Unmodified"),(!u||u==="INDEX_Unmodified ")&&(u=`h:${o} w:${l} s:${c}`),`${a}: ${u.trim()}`}).filter(a=>!a.endsWith("Unmodified")).join(`
`);Me.info(`Git Status for "${vi(r)}":
${i||"No changes"}`,{duration:15e3})}catch(s){throw console.error(`[VFS Git Op] Git status failed for ${r}:`,s),Me.error(`Git status failed: ${s instanceof Error?s.message:String(s)}`),s}},Am=async(e,t)=>{const n=(t==null?void 0:t.fsInstance)??fa,r=zr(e);if(r!=="/")try{await n.promises.mkdir(r,{recursive:!0})}catch(s){if(s instanceof Error&&s.code==="EEXIST"){console.warn(`[VFS Op] Directory already exists or created concurrently: ${r}`);return}throw console.error(`[VFS Op] Failed to create directory ${r}:`,s),Me.error(`Error creating directory "${vi(r)}": ${s instanceof Error?s.message:String(s)}`),s}},gTe=async e=>{try{const t={backend:v2e,name:`litechat_vfs_${e}`};return await d2e(t),fa}catch(t){return console.error(`[VFS Op] Failed to initialize VFS for key "${e}":`,t),Me.error(`Failed to initialize filesystem "${e}": ${t instanceof Error?t.message:String(t)}`),null}},vD=async(e,t)=>{const n=(t==null?void 0:t.fsInstance)??fa,r=zr(e);try{try{await n.promises.stat(r)}catch(l){if(l.code==="ENOENT")return console.warn(`[VFS Op] Directory not found for listing, attempting creation: ${r}`),await Am(r,{fsInstance:n}),[];throw l}const i=(await n.promises.readdir(r)).map(async l=>{const c=Du(r,l);try{const u=await n.promises.stat(c);return{name:l,path:c,isDirectory:u.isDirectory(),size:u.size,lastModified:u.mtime}}catch(u){return console.error(`[VFS Op] Failed to stat ${c}:`,u),null}});return(await Promise.all(i)).filter(l=>l!==null)}catch(s){throw console.error(`[VFS Op] Failed to list directory ${r}:`,s),Me.error(`Error listing files: ${s instanceof Error?s.message:String(s)}`),s}},Zh=async(e,t)=>{const n=(t==null?void 0:t.fsInstance)??fa,r=zr(e);try{const s=await n.promises.readFile(r);return Pe.emit(dn.fileRead,{path:r}),s}catch(s){throw console.error(`[VFS Op] Failed to read file ${r}:`,s),Me.error(`Error reading file "${vi(r)}": ${s instanceof Error?s.message:String(s)}`),s}},lT=async(e,t,n)=>{const r=(n==null?void 0:n.fsInstance)??fa,s=zr(e),i=tT(s);try{i!=="/"&&await Am(i,{fsInstance:r}),await r.promises.writeFile(s,t),Pe.emit(dn.fileWritten,{path:s})}catch(a){throw a instanceof Error&&a.message.includes("Error creating directory")||(console.error(`[VFS Op] Failed to write file ${s}:`,a),Me.error(`Error writing file "${vi(s)}": ${a instanceof Error?a.message:String(a)}`)),a}},xD=async(e,t=!1,n)=>{const r=(n==null?void 0:n.fsInstance)??fa,s=zr(e);if(s==="/")throw Me.error("Cannot delete the root directory."),new Error("Cannot delete the root directory.");try{(await r.promises.stat(s)).isDirectory()?(await r.promises.rm(s,{recursive:t}),Pe.emit(dn.fileDeleted,{path:s})):(await r.promises.unlink(s),Pe.emit(dn.fileDeleted,{path:s})),Me.success(`"${vi(s)}" deleted.`)}catch(i){if(i instanceof Error&&i.code==="ENOENT"){console.warn(`[VFS Op] Item not found for deletion: ${s}`);return}throw console.error(`[VFS Op] Failed to delete ${s}:`,i),Me.error(`Error deleting "${vi(s)}": ${i instanceof Error?i.message:String(i)}`),i}},EZ=async(e,t)=>{await Am(e,t)},yTe=async(e,t,n)=>{try{const r=await Zh(e,n),s=new Blob([r]),i=URL.createObjectURL(s),a=document.createElement("a");a.href=i;const o=zr(e);a.download=t||vi(o),document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(i)}catch(r){console.error(`[VFS Op] Failed to initiate download for ${e}:`,r),r instanceof Error&&r.message.includes("Error reading file")||Me.error(`Download failed: ${r instanceof Error?r.message:String(r)}`)}},TZ=async(e,t,n)=>{const r=(n==null?void 0:n.fsInstance)??fa,s=zr(t);let i=0,a=0;const o=Array.from(e);try{await Am(s,{fsInstance:r});for(const l of o){const c=Du(s,l.name);try{const u=await l.arrayBuffer();await lT(c,new Uint8Array(u),{fsInstance:r}),i++}catch(u){a++,console.error(`[VFS Op] Failed to upload ${l.name}:`,u)}}}catch(l){a=o.length,console.error(`[VFS Op] Failed to prepare target directory ${s} for upload:`,l)}finally{a>0&&i>0?Me.warning(`Upload complete with issues. ${i} succeeded, ${a} failed.`):a===0&&i>0&&Me.success(`Successfully uploaded ${i} file(s) to ${s==="/"?"root":vi(s)}.`)}},bTe=async(e,t,n)=>{const r=fa;if(!e.name.toLowerCase().endsWith(".zip")){Me.error("Please select a valid ZIP file.");return}const s=zr(t);let i;try{await Am(s,{fsInstance:r}),i=await lD.loadAsync(e);const a=Object.values(i.files),o=await Promise.allSettled(a.map(async d=>{const h=Du(s,d.name);if(d.dir)await Am(h,{fsInstance:r});else{const m=await d.async("uint8array");await lT(h,m,{fsInstance:r})}return{name:d.name,isDir:d.dir}}));let l=0,c=0,u=0;o.forEach(d=>{d.status==="fulfilled"&&d.value?d.value.isDir?c++:l++:d.status==="rejected"&&(u++,console.error("[VFS Op] ZIP Extraction item failed:",d.reason))}),u>0?Me.warning(`Finished extracting "${e.name}". ${l+c} items succeeded, ${u} failed.`):Me.success(`Successfully extracted ${l} files and ${c} folders from "${e.name}" to ${s==="/"?"root":vi(s)}.`)}catch(a){a instanceof Error&&a.message.includes("Error creating directory")||(console.error(`[VFS Op] Failed to extract zip ${e.name}:`,a),Me.error(`ZIP extraction failed: ${a instanceof Error?a.message:String(a)}`))}},Az=async(e,t="/",n)=>{const r=fa,s=new lD,i=zr(t),a=vi(i)||"root";try{try{if(!(await r.promises.stat(i)).isDirectory()){Me.error(`Cannot export: "${a}" is not a directory.`);return}}catch(h){h instanceof Error&&h.code==="ENOENT"?Me.error(`Cannot export: Path "${a}" not found.`):Me.error(`Cannot export: Error accessing path "${a}". ${h instanceof Error?h.message:String(h)}`);return}const o=async(h,m)=>{const y=await vD(h,{fsInstance:r});for(const b of y)if(b.isDirectory){if(b.name===".git")continue;const v=m.folder(b.name);if(v)await o(b.path,v);else throw new Error(`Failed to create subfolder ${b.name} in zip.`)}else{const v=await Zh(b.path,{fsInstance:r});m.file(b.name,v)}};await o(i,s);const l=await s.generateAsync({type:"blob"}),c=URL.createObjectURL(l),u=document.createElement("a");u.href=c;const d=`vfs_${a}_export.zip`;u.download=e||d,document.body.appendChild(u),u.click(),document.body.removeChild(u),URL.revokeObjectURL(c),Me.success(`"${a}" exported as ${u.download}.`)}catch(o){console.error("[VFS Op] Failed to download all as zip:",o),o instanceof Error&&(o.message.includes("Error listing files")||o.message.includes("Error reading file")||o.message.includes("Cannot export"))||Me.error(`ZIP export failed: ${o instanceof Error?o.message:String(o)}`)}},AZ=async(e,t,n)=>{const r=(n==null?void 0:n.fsInstance)??fa,s=zr(e),i=zr(t);if(s==="/"||i==="/")throw Me.error("Cannot rename the root directory."),new Error("Cannot rename the root directory.");if(s!==i)try{const a=tT(i);a!=="/"&&await Am(a,{fsInstance:r}),await r.promises.rename(s,i),Me.success(`Renamed "${vi(s)}" to "${vi(i)}"`)}catch(a){throw a instanceof Error&&a.code==="ENOENT"?a.message.includes("Error creating directory")||Me.error(`Rename failed: Original item "${vi(s)}" not found.`):a instanceof Error&&a.code==="EEXIST"?Me.error(`Rename failed: An item named "${vi(i)}" already exists.`):a instanceof Error&&a.message.includes("Error creating directory")||Me.error(`Rename failed: ${a instanceof Error?a.message:String(a)}`),console.error(`[VFS Op] Failed to rename ${s} to ${i}:`,a),a}},vTe=1024*5,xTe=(e,t)=>{try{const n=atob(e),r=new Array(n.length);for(let a=0;a<n.length;a++)r[a]=n.charCodeAt(a);const s=new Uint8Array(r),i=new Blob([s],{type:t});return URL.createObjectURL(i)}catch(n){return console.error("Error creating blob URL from base64:",n),null}},Rz=e=>{let t=null;if(e.contentText!==void 0)t=new Blob([e.contentText],{type:e.type});else if(e.contentBase64!==void 0)try{const n=atob(e.contentBase64),r=new Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);const s=new Uint8Array(r);t=new Blob([s],{type:e.type})}catch(n){return console.error("Failed to reconstruct file from base64:",n),null}return t?new File([t],e.name,{type:e.type}):(console.error(`Failed to reconstruct file "${e.name}": No content found in metadata.`),null)},RZ=({fileMeta:e,onRemove:t,isReadOnly:n=!1})=>{const[r,s]=E.useState(null),[i,a]=E.useState(null),[o,l]=E.useState(!1),[c,u]=E.useState(!1),[d,h]=E.useState(!0),m=e.type||"application/octet-stream",y=Jx(e.name,m),b=m.startsWith("image/"),v=m.startsWith("audio/"),x=m.startsWith("video/"),w=e.source==="vfs";E.useEffect(()=>{let I=null;return a(null),e.source==="direct"&&!y&&e.contentBase64?(I=xTe(e.contentBase64,m),I||a("Failed to decode file content for preview."),s(I)):s(null),e.source==="direct"&&y&&e.contentText&&e.contentText.length>vTe?a(`Text file too large for preview (${(e.size/1024).toFixed(1)} KB).`):e.source==="direct"&&y&&e.contentText===void 0&&a("Text content missing from metadata."),()=>{I&&(URL.revokeObjectURL(I),s(null))}},[e.id,e.size,e.source,e.contentBase64,e.contentText,m,y]);const S=async()=>{if(e.source==="vfs"){Me.info("File is already in VFS.");return}const I=Rz(e);if(!I){Me.error("Cannot add to VFS: Failed to reconstruct file data.");return}l(!0);try{await TZ([I],"/"),Me.success(`"${e.name}" added to VFS root.`)}catch(P){console.error("Failed to add file to VFS:",P),Me.error(`Failed to add "${e.name}" to VFS.`)}finally{l(!1)}},k=async()=>{u(!0);try{let I;if(e.source==="vfs"&&e.path){const D=await Zh(e.path);I=new Blob([D],{type:m})}else{const D=Rz(e);if(!D)throw new Error("Could not reconstruct file data.");I=D}const P=URL.createObjectURL(I),B=document.createElement("a");B.href=P,B.download=e.name,document.body.appendChild(B),B.click(),document.body.removeChild(B),URL.revokeObjectURL(P)}catch(I){console.error("Failed to download file:",I),Me.error(`Download failed: ${I instanceof Error?I.message:String(I)}`)}finally{u(!1)}},C=()=>h(I=>!I),T=()=>w?f.jsx(qO,{className:"h-5 w-5 text-cyan-500"}):y?f.jsx(X3,{className:"h-5 w-5 text-blue-500"}):b?f.jsx(J0,{className:"h-5 w-5 text-purple-500"}):v?f.jsx(rge,{className:"h-5 w-5 text-green-500"}):x?f.jsx(Jge,{className:"h-5 w-5 text-orange-500"}):f.jsx(mme,{className:"h-5 w-5 text-muted-foreground"}),R=()=>w?f.jsx("p",{className:"p-2 text-xs text-muted-foreground italic",children:"VFS file attached. Content will be loaded when sent."}):i?f.jsxs("div",{className:"p-2 text-xs text-destructive flex items-center gap-1",children:[f.jsx(Kl,{className:"h-4 w-4"}),f.jsx("span",{children:i})]}):y&&e.contentText!==void 0?f.jsx(Yy,{lang:m==="text/markdown"?"markdown":"text",code:e.contentText,filepath:e.name}):b&&r?f.jsx("img",{src:r,alt:e.name,className:"max-w-full max-h-64 object-contain rounded"}):v&&r?f.jsx("audio",{controls:!0,src:r,className:"w-full",children:"Your browser does not support the audio element."}):x&&r?f.jsx("video",{controls:!0,src:r,className:"max-w-full max-h-64 rounded",children:"Your browser does not support the video tag."}):f.jsx("p",{className:"p-2 text-xs text-muted-foreground italic",children:"Preview not available for this file type or content missing."}),N=E.useMemo(()=>{let I="File";return w?I="VFS File":y?I="Text":b?I="Image":v?I="Audio":x&&(I="Video"),`${I} (${pw(e.size)})`},[w,y,b,v,x,e.size]);return f.jsxs("div",{className:"border rounded-md overflow-hidden bg-card shadow-sm my-1",children:[f.jsxs("div",{className:"flex items-center justify-between p-2 border-b bg-muted/30",children:[f.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[T(),f.jsx("span",{className:"text-sm font-medium truncate",title:e.name,children:e.name}),f.jsxs("span",{className:"text-xs text-muted-foreground flex-shrink-0",children:["(",pw(e.size),")"]}),w&&e.path&&f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsxs("span",{className:"text-xs text-cyan-400 truncate max-w-[100px]",children:["(VFS: ",e.path,")"]})}),f.jsx(Sr,{children:f.jsxs("p",{children:["From VFS: ",e.path]})})]})})]}),f.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(mt,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:k,disabled:c,"aria-label":"Download file",children:c?f.jsx(Xn,{className:"h-3.5 w-3.5 animate-spin"}):f.jsx(Ec,{className:"h-3.5 w-3.5"})})}),f.jsx(Sr,{children:"Download File"})]})}),f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(mt,{variant:"ghost",size:"icon",className:"h-6 w-6 text-muted-foreground hover:text-foreground",onClick:C,"aria-label":d?"Unfold preview":"Fold preview",children:f.jsx(fE,{className:"h-3.5 w-3.5"})})}),f.jsx(Sr,{side:"top",children:d?"Unfold":"Fold"})]})}),!n&&t&&f.jsxs(f.Fragment,{children:[e.source==="direct"&&f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(mt,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:S,disabled:o,"aria-label":"Add to VFS",children:o?f.jsx(Xn,{className:"h-3.5 w-3.5 animate-spin"}):f.jsx(zO,{className:"h-3.5 w-3.5"})})}),f.jsx(Sr,{children:"Add to VFS"})]})}),f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(mt,{variant:"ghost",size:"icon",className:"h-6 w-6 text-destructive hover:text-destructive/80",onClick:()=>t(e.id),"aria-label":"Remove file",children:f.jsx(Oi,{className:"h-3.5 w-3.5"})})}),f.jsx(Sr,{children:"Remove from Prompt"})]})})]})]})]}),d?f.jsx("div",{className:"p-2 text-xs text-muted-foreground italic cursor-pointer hover:bg-muted/20",onClick:C,children:N}):f.jsx("div",{className:Xe("p-2 max-h-80 overflow-y-auto"),children:R()})]})},NZ=6048e5,wTe=864e5,MZ=6e4,IZ=36e5,VS=43200,Nz=1440,Mz=Symbol.for("constructDateFrom");function xi(e,t){return typeof e=="function"?e(t):e&&typeof e=="object"&&Mz in e?e[Mz](t):e instanceof Date?new e.constructor(t):new Date(t)}function qr(e,t){return xi(t||e,e)}function jZ(e,t,n){const r=qr(e,n==null?void 0:n.in);return isNaN(t)?xi(e,NaN):(t&&r.setDate(r.getDate()+t),r)}function OZ(e,t,n){const r=qr(e,n==null?void 0:n.in);if(isNaN(t))return xi(e,NaN);if(!t)return r;const s=r.getDate(),i=xi(e,r.getTime());i.setMonth(r.getMonth()+t+1,0);const a=i.getDate();return s>=a?i:(r.setFullYear(i.getFullYear(),i.getMonth(),s),r)}let _Te={};function cb(){return _Te}function xy(e,t){var o,l,c,u;const n=cb(),r=(t==null?void 0:t.weekStartsOn)??((l=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:l.weekStartsOn)??n.weekStartsOn??((u=(c=n.locale)==null?void 0:c.options)==null?void 0:u.weekStartsOn)??0,s=qr(e,t==null?void 0:t.in),i=s.getDay(),a=(i<r?7:0)+i-r;return s.setDate(s.getDate()-a),s.setHours(0,0,0,0),s}function Sw(e,t){return xy(e,{...t,weekStartsOn:1})}function PZ(e,t){const n=qr(e,t==null?void 0:t.in),r=n.getFullYear(),s=xi(n,0);s.setFullYear(r+1,0,4),s.setHours(0,0,0,0);const i=Sw(s),a=xi(n,0);a.setFullYear(r,0,4),a.setHours(0,0,0,0);const o=Sw(a);return n.getTime()>=i.getTime()?r+1:n.getTime()>=o.getTime()?r:r-1}function nk(e){const t=qr(e),n=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return n.setUTCFullYear(t.getFullYear()),+e-+n}function Xh(e,...t){const n=xi.bind(null,e||t.find(r=>typeof r=="object"));return t.map(n)}function Cw(e,t){const n=qr(e,t==null?void 0:t.in);return n.setHours(0,0,0,0),n}function DZ(e,t,n){const[r,s]=Xh(n==null?void 0:n.in,e,t),i=Cw(r),a=Cw(s),o=+i-nk(i),l=+a-nk(a);return Math.round((o-l)/wTe)}function STe(e,t){const n=PZ(e,t),r=xi(e,0);return r.setFullYear(n,0,4),r.setHours(0,0,0,0),Sw(r)}function CTe(e,t,n){return jZ(e,t*7,n)}function kTe(e,t,n){return OZ(e,t*12,n)}function ETe(e,t){let n,r=t==null?void 0:t.in;return e.forEach(s=>{!r&&typeof s=="object"&&(r=xi.bind(null,s));const i=qr(s,r);(!n||n<i||isNaN(+i))&&(n=i)}),xi(r,n||NaN)}function TTe(e,t){let n,r=t==null?void 0:t.in;return e.forEach(s=>{!r&&typeof s=="object"&&(r=xi.bind(null,s));const i=qr(s,r);(!n||n>i||isNaN(+i))&&(n=i)}),xi(r,n||NaN)}function O2(e,t){const n=+qr(e)-+qr(t);return n<0?-1:n>0?1:n}function ATe(e){return xi(e,Date.now())}function RTe(e,t,n){const[r,s]=Xh(n==null?void 0:n.in,e,t);return+Cw(r)==+Cw(s)}function FZ(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function NTe(e){return!(!FZ(e)&&typeof e!="number"||isNaN(+qr(e)))}function LZ(e,t,n){const[r,s]=Xh(n==null?void 0:n.in,e,t),i=r.getFullYear()-s.getFullYear(),a=r.getMonth()-s.getMonth();return i*12+a}function MTe(e){return t=>{const r=(e?Math[e]:Math.trunc)(t);return r===0?0:r}}function ITe(e,t){return+qr(e)-+qr(t)}function jTe(e,t){const n=qr(e,t==null?void 0:t.in);return n.setHours(23,59,59,999),n}function BZ(e,t){const n=qr(e,t==null?void 0:t.in),r=n.getMonth();return n.setFullYear(n.getFullYear(),r+1,0),n.setHours(23,59,59,999),n}function OTe(e,t){const n=qr(e,t==null?void 0:t.in);return+jTe(n,t)==+BZ(n,t)}function PTe(e,t,n){const[r,s,i]=Xh(n==null?void 0:n.in,e,e,t),a=O2(s,i),o=Math.abs(LZ(s,i));if(o<1)return 0;s.getMonth()===1&&s.getDate()>27&&s.setDate(30),s.setMonth(s.getMonth()-a*o);let l=O2(s,i)===-a;OTe(r)&&o===1&&O2(r,i)===1&&(l=!1);const c=a*(o-+l);return c===0?0:c}function DTe(e,t,n){const r=ITe(e,t)/1e3;return MTe(n==null?void 0:n.roundingMethod)(r)}function FTe(e,t){const[n,r]=Xh(e,t.start,t.end);return{start:n,end:r}}function LTe(e,t){const{start:n,end:r}=FTe(t==null?void 0:t.in,e);let s=+n>+r;const i=s?+n:+r,a=s?r:n;a.setHours(0,0,0,0),a.setDate(1);let o=1;const l=[];for(;+a<=i;)l.push(xi(n,a)),a.setMonth(a.getMonth()+o);return s?l.reverse():l}function BTe(e,t){const n=qr(e,t==null?void 0:t.in);return n.setDate(1),n.setHours(0,0,0,0),n}function $Te(e,t){const n=qr(e,t==null?void 0:t.in),r=n.getFullYear();return n.setFullYear(r+1,0,0),n.setHours(23,59,59,999),n}function $Z(e,t){const n=qr(e,t==null?void 0:t.in);return n.setFullYear(n.getFullYear(),0,1),n.setHours(0,0,0,0),n}function zZ(e,t){var o,l,c,u;const n=cb(),r=(t==null?void 0:t.weekStartsOn)??((l=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:l.weekStartsOn)??n.weekStartsOn??((u=(c=n.locale)==null?void 0:c.options)==null?void 0:u.weekStartsOn)??0,s=qr(e,t==null?void 0:t.in),i=s.getDay(),a=(i<r?-7:0)+6-(i-r);return s.setDate(s.getDate()+a),s.setHours(23,59,59,999),s}function zTe(e,t){return zZ(e,{...t,weekStartsOn:1})}const UTe={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},qTe=(e,t,n)=>{let r;const s=UTe[e];return typeof s=="string"?r=s:t===1?r=s.one:r=s.other.replace("{{count}}",t.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+r:r+" ago":r};function fI(e){return(t={})=>{const n=t.width?String(t.width):e.defaultWidth;return e.formats[n]||e.formats[e.defaultWidth]}}const VTe={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},WTe={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},HTe={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},GTe={date:fI({formats:VTe,defaultWidth:"full"}),time:fI({formats:WTe,defaultWidth:"full"}),dateTime:fI({formats:HTe,defaultWidth:"full"})},KTe={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},YTe=(e,t,n,r)=>KTe[e];function Lv(e){return(t,n)=>{const r=n!=null&&n.context?String(n.context):"standalone";let s;if(r==="formatting"&&e.formattingValues){const a=e.defaultFormattingWidth||e.defaultWidth,o=n!=null&&n.width?String(n.width):a;s=e.formattingValues[o]||e.formattingValues[a]}else{const a=e.defaultWidth,o=n!=null&&n.width?String(n.width):e.defaultWidth;s=e.values[o]||e.values[a]}const i=e.argumentCallback?e.argumentCallback(t):t;return s[i]}}const ZTe={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},XTe={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},JTe={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},QTe={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},eAe={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},tAe={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},nAe=(e,t)=>{const n=Number(e),r=n%100;if(r>20||r<10)switch(r%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},rAe={ordinalNumber:nAe,era:Lv({values:ZTe,defaultWidth:"wide"}),quarter:Lv({values:XTe,defaultWidth:"wide",argumentCallback:e=>e-1}),month:Lv({values:JTe,defaultWidth:"wide"}),day:Lv({values:QTe,defaultWidth:"wide"}),dayPeriod:Lv({values:eAe,defaultWidth:"wide",formattingValues:tAe,defaultFormattingWidth:"wide"})};function Bv(e){return(t,n={})=>{const r=n.width,s=r&&e.matchPatterns[r]||e.matchPatterns[e.defaultMatchWidth],i=t.match(s);if(!i)return null;const a=i[0],o=r&&e.parsePatterns[r]||e.parsePatterns[e.defaultParseWidth],l=Array.isArray(o)?iAe(o,d=>d.test(a)):sAe(o,d=>d.test(a));let c;c=e.valueCallback?e.valueCallback(l):l,c=n.valueCallback?n.valueCallback(c):c;const u=t.slice(a.length);return{value:c,rest:u}}}function sAe(e,t){for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&t(e[n]))return n}function iAe(e,t){for(let n=0;n<e.length;n++)if(t(e[n]))return n}function aAe(e){return(t,n={})=>{const r=t.match(e.matchPattern);if(!r)return null;const s=r[0],i=t.match(e.parsePattern);if(!i)return null;let a=e.valueCallback?e.valueCallback(i[0]):i[0];a=n.valueCallback?n.valueCallback(a):a;const o=t.slice(s.length);return{value:a,rest:o}}}const oAe=/^(\d+)(th|st|nd|rd)?/i,lAe=/\d+/i,cAe={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},uAe={any:[/^b/i,/^(a|c)/i]},dAe={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},fAe={any:[/1/i,/2/i,/3/i,/4/i]},hAe={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},pAe={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},mAe={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},gAe={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},yAe={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},bAe={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},vAe={ordinalNumber:aAe({matchPattern:oAe,parsePattern:lAe,valueCallback:e=>parseInt(e,10)}),era:Bv({matchPatterns:cAe,defaultMatchWidth:"wide",parsePatterns:uAe,defaultParseWidth:"any"}),quarter:Bv({matchPatterns:dAe,defaultMatchWidth:"wide",parsePatterns:fAe,defaultParseWidth:"any",valueCallback:e=>e+1}),month:Bv({matchPatterns:hAe,defaultMatchWidth:"wide",parsePatterns:pAe,defaultParseWidth:"any"}),day:Bv({matchPatterns:mAe,defaultMatchWidth:"wide",parsePatterns:gAe,defaultParseWidth:"any"}),dayPeriod:Bv({matchPatterns:yAe,defaultMatchWidth:"any",parsePatterns:bAe,defaultParseWidth:"any"})},cT={code:"en-US",formatDistance:qTe,formatLong:GTe,formatRelative:YTe,localize:rAe,match:vAe,options:{weekStartsOn:0,firstWeekContainsDate:1}};function xAe(e,t){const n=qr(e,t==null?void 0:t.in);return DZ(n,$Z(n))+1}function UZ(e,t){const n=qr(e,t==null?void 0:t.in),r=+Sw(n)-+STe(n);return Math.round(r/NZ)+1}function qZ(e,t){var u,d,h,m;const n=qr(e,t==null?void 0:t.in),r=n.getFullYear(),s=cb(),i=(t==null?void 0:t.firstWeekContainsDate)??((d=(u=t==null?void 0:t.locale)==null?void 0:u.options)==null?void 0:d.firstWeekContainsDate)??s.firstWeekContainsDate??((m=(h=s.locale)==null?void 0:h.options)==null?void 0:m.firstWeekContainsDate)??1,a=xi((t==null?void 0:t.in)||e,0);a.setFullYear(r+1,0,i),a.setHours(0,0,0,0);const o=xy(a,t),l=xi((t==null?void 0:t.in)||e,0);l.setFullYear(r,0,i),l.setHours(0,0,0,0);const c=xy(l,t);return+n>=+o?r+1:+n>=+c?r:r-1}function wAe(e,t){var o,l,c,u;const n=cb(),r=(t==null?void 0:t.firstWeekContainsDate)??((l=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:l.firstWeekContainsDate)??n.firstWeekContainsDate??((u=(c=n.locale)==null?void 0:c.options)==null?void 0:u.firstWeekContainsDate)??1,s=qZ(e,t),i=xi((t==null?void 0:t.in)||e,0);return i.setFullYear(s,0,r),i.setHours(0,0,0,0),xy(i,t)}function VZ(e,t){const n=qr(e,t==null?void 0:t.in),r=+xy(n,t)-+wAe(n,t);return Math.round(r/NZ)+1}function xs(e,t){const n=e<0?"-":"",r=Math.abs(e).toString().padStart(t,"0");return n+r}const Qf={y(e,t){const n=e.getFullYear(),r=n>0?n:1-n;return xs(t==="yy"?r%100:r,t.length)},M(e,t){const n=e.getMonth();return t==="M"?String(n+1):xs(n+1,2)},d(e,t){return xs(e.getDate(),t.length)},a(e,t){const n=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];case"aaaa":default:return n==="am"?"a.m.":"p.m."}},h(e,t){return xs(e.getHours()%12||12,t.length)},H(e,t){return xs(e.getHours(),t.length)},m(e,t){return xs(e.getMinutes(),t.length)},s(e,t){return xs(e.getSeconds(),t.length)},S(e,t){const n=t.length,r=e.getMilliseconds(),s=Math.trunc(r*Math.pow(10,n-3));return xs(s,t.length)}},t0={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Iz={G:function(e,t,n){const r=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return n.era(r,{width:"abbreviated"});case"GGGGG":return n.era(r,{width:"narrow"});case"GGGG":default:return n.era(r,{width:"wide"})}},y:function(e,t,n){if(t==="yo"){const r=e.getFullYear(),s=r>0?r:1-r;return n.ordinalNumber(s,{unit:"year"})}return Qf.y(e,t)},Y:function(e,t,n,r){const s=qZ(e,r),i=s>0?s:1-s;if(t==="YY"){const a=i%100;return xs(a,2)}return t==="Yo"?n.ordinalNumber(i,{unit:"year"}):xs(i,t.length)},R:function(e,t){const n=PZ(e);return xs(n,t.length)},u:function(e,t){const n=e.getFullYear();return xs(n,t.length)},Q:function(e,t,n){const r=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(r);case"QQ":return xs(r,2);case"Qo":return n.ordinalNumber(r,{unit:"quarter"});case"QQQ":return n.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(r,{width:"wide",context:"formatting"})}},q:function(e,t,n){const r=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(r);case"qq":return xs(r,2);case"qo":return n.ordinalNumber(r,{unit:"quarter"});case"qqq":return n.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(r,{width:"wide",context:"standalone"})}},M:function(e,t,n){const r=e.getMonth();switch(t){case"M":case"MM":return Qf.M(e,t);case"Mo":return n.ordinalNumber(r+1,{unit:"month"});case"MMM":return n.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(r,{width:"wide",context:"formatting"})}},L:function(e,t,n){const r=e.getMonth();switch(t){case"L":return String(r+1);case"LL":return xs(r+1,2);case"Lo":return n.ordinalNumber(r+1,{unit:"month"});case"LLL":return n.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(r,{width:"wide",context:"standalone"})}},w:function(e,t,n,r){const s=VZ(e,r);return t==="wo"?n.ordinalNumber(s,{unit:"week"}):xs(s,t.length)},I:function(e,t,n){const r=UZ(e);return t==="Io"?n.ordinalNumber(r,{unit:"week"}):xs(r,t.length)},d:function(e,t,n){return t==="do"?n.ordinalNumber(e.getDate(),{unit:"date"}):Qf.d(e,t)},D:function(e,t,n){const r=xAe(e);return t==="Do"?n.ordinalNumber(r,{unit:"dayOfYear"}):xs(r,t.length)},E:function(e,t,n){const r=e.getDay();switch(t){case"E":case"EE":case"EEE":return n.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(r,{width:"short",context:"formatting"});case"EEEE":default:return n.day(r,{width:"wide",context:"formatting"})}},e:function(e,t,n,r){const s=e.getDay(),i=(s-r.weekStartsOn+8)%7||7;switch(t){case"e":return String(i);case"ee":return xs(i,2);case"eo":return n.ordinalNumber(i,{unit:"day"});case"eee":return n.day(s,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(s,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(s,{width:"short",context:"formatting"});case"eeee":default:return n.day(s,{width:"wide",context:"formatting"})}},c:function(e,t,n,r){const s=e.getDay(),i=(s-r.weekStartsOn+8)%7||7;switch(t){case"c":return String(i);case"cc":return xs(i,t.length);case"co":return n.ordinalNumber(i,{unit:"day"});case"ccc":return n.day(s,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(s,{width:"narrow",context:"standalone"});case"cccccc":return n.day(s,{width:"short",context:"standalone"});case"cccc":default:return n.day(s,{width:"wide",context:"standalone"})}},i:function(e,t,n){const r=e.getDay(),s=r===0?7:r;switch(t){case"i":return String(s);case"ii":return xs(s,t.length);case"io":return n.ordinalNumber(s,{unit:"day"});case"iii":return n.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(r,{width:"short",context:"formatting"});case"iiii":default:return n.day(r,{width:"wide",context:"formatting"})}},a:function(e,t,n){const s=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(s,{width:"wide",context:"formatting"})}},b:function(e,t,n){const r=e.getHours();let s;switch(r===12?s=t0.noon:r===0?s=t0.midnight:s=r/12>=1?"pm":"am",t){case"b":case"bb":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(s,{width:"wide",context:"formatting"})}},B:function(e,t,n){const r=e.getHours();let s;switch(r>=17?s=t0.evening:r>=12?s=t0.afternoon:r>=4?s=t0.morning:s=t0.night,t){case"B":case"BB":case"BBB":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(s,{width:"wide",context:"formatting"})}},h:function(e,t,n){if(t==="ho"){let r=e.getHours()%12;return r===0&&(r=12),n.ordinalNumber(r,{unit:"hour"})}return Qf.h(e,t)},H:function(e,t,n){return t==="Ho"?n.ordinalNumber(e.getHours(),{unit:"hour"}):Qf.H(e,t)},K:function(e,t,n){const r=e.getHours()%12;return t==="Ko"?n.ordinalNumber(r,{unit:"hour"}):xs(r,t.length)},k:function(e,t,n){let r=e.getHours();return r===0&&(r=24),t==="ko"?n.ordinalNumber(r,{unit:"hour"}):xs(r,t.length)},m:function(e,t,n){return t==="mo"?n.ordinalNumber(e.getMinutes(),{unit:"minute"}):Qf.m(e,t)},s:function(e,t,n){return t==="so"?n.ordinalNumber(e.getSeconds(),{unit:"second"}):Qf.s(e,t)},S:function(e,t){return Qf.S(e,t)},X:function(e,t,n){const r=e.getTimezoneOffset();if(r===0)return"Z";switch(t){case"X":return Oz(r);case"XXXX":case"XX":return Wp(r);case"XXXXX":case"XXX":default:return Wp(r,":")}},x:function(e,t,n){const r=e.getTimezoneOffset();switch(t){case"x":return Oz(r);case"xxxx":case"xx":return Wp(r);case"xxxxx":case"xxx":default:return Wp(r,":")}},O:function(e,t,n){const r=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+jz(r,":");case"OOOO":default:return"GMT"+Wp(r,":")}},z:function(e,t,n){const r=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+jz(r,":");case"zzzz":default:return"GMT"+Wp(r,":")}},t:function(e,t,n){const r=Math.trunc(+e/1e3);return xs(r,t.length)},T:function(e,t,n){return xs(+e,t.length)}};function jz(e,t=""){const n=e>0?"-":"+",r=Math.abs(e),s=Math.trunc(r/60),i=r%60;return i===0?n+String(s):n+String(s)+t+xs(i,2)}function Oz(e,t){return e%60===0?(e>0?"-":"+")+xs(Math.abs(e)/60,2):Wp(e,t)}function Wp(e,t=""){const n=e>0?"-":"+",r=Math.abs(e),s=xs(Math.trunc(r/60),2),i=xs(r%60,2);return n+s+t+i}const Pz=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},WZ=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},_Ae=(e,t)=>{const n=e.match(/(P+)(p+)?/)||[],r=n[1],s=n[2];if(!s)return Pz(e,t);let i;switch(r){case"P":i=t.dateTime({width:"short"});break;case"PP":i=t.dateTime({width:"medium"});break;case"PPP":i=t.dateTime({width:"long"});break;case"PPPP":default:i=t.dateTime({width:"full"});break}return i.replace("{{date}}",Pz(r,t)).replace("{{time}}",WZ(s,t))},SAe={p:WZ,P:_Ae},CAe=/^D+$/,kAe=/^Y+$/,EAe=["D","DD","YY","YYYY"];function TAe(e){return CAe.test(e)}function AAe(e){return kAe.test(e)}function RAe(e,t,n){const r=NAe(e,t,n);if(console.warn(r),EAe.includes(e))throw new RangeError(r)}function NAe(e,t,n){const r=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${r} to the input \`${n}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const MAe=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,IAe=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,jAe=/^'([^]*?)'?$/,OAe=/''/g,PAe=/[a-zA-Z]/;function Md(e,t,n){var u,d,h,m,y,b,v,x;const r=cb(),s=(n==null?void 0:n.locale)??r.locale??cT,i=(n==null?void 0:n.firstWeekContainsDate)??((d=(u=n==null?void 0:n.locale)==null?void 0:u.options)==null?void 0:d.firstWeekContainsDate)??r.firstWeekContainsDate??((m=(h=r.locale)==null?void 0:h.options)==null?void 0:m.firstWeekContainsDate)??1,a=(n==null?void 0:n.weekStartsOn)??((b=(y=n==null?void 0:n.locale)==null?void 0:y.options)==null?void 0:b.weekStartsOn)??r.weekStartsOn??((x=(v=r.locale)==null?void 0:v.options)==null?void 0:x.weekStartsOn)??0,o=qr(e,n==null?void 0:n.in);if(!NTe(o))throw new RangeError("Invalid time value");let l=t.match(IAe).map(w=>{const S=w[0];if(S==="p"||S==="P"){const k=SAe[S];return k(w,s.formatLong)}return w}).join("").match(MAe).map(w=>{if(w==="''")return{isToken:!1,value:"'"};const S=w[0];if(S==="'")return{isToken:!1,value:DAe(w)};if(Iz[S])return{isToken:!0,value:w};if(S.match(PAe))throw new RangeError("Format string contains an unescaped latin alphabet character `"+S+"`");return{isToken:!1,value:w}});s.localize.preprocessor&&(l=s.localize.preprocessor(o,l));const c={firstWeekContainsDate:i,weekStartsOn:a,locale:s};return l.map(w=>{if(!w.isToken)return w.value;const S=w.value;(!(n!=null&&n.useAdditionalWeekYearTokens)&&AAe(S)||!(n!=null&&n.useAdditionalDayOfYearTokens)&&TAe(S))&&RAe(S,t,String(e));const k=Iz[S[0]];return k(o,S,s.localize,c)}).join("")}function DAe(e){const t=e.match(jAe);return t?t[1].replace(OAe,"'"):e}function FAe(e,t,n){const r=cb(),s=(n==null?void 0:n.locale)??r.locale??cT,i=2520,a=O2(e,t);if(isNaN(a))throw new RangeError("Invalid time value");const o=Object.assign({},n,{addSuffix:n==null?void 0:n.addSuffix,comparison:a}),[l,c]=Xh(n==null?void 0:n.in,...a>0?[t,e]:[e,t]),u=DTe(c,l),d=(nk(c)-nk(l))/1e3,h=Math.round((u-d)/60);let m;if(h<2)return n!=null&&n.includeSeconds?u<5?s.formatDistance("lessThanXSeconds",5,o):u<10?s.formatDistance("lessThanXSeconds",10,o):u<20?s.formatDistance("lessThanXSeconds",20,o):u<40?s.formatDistance("halfAMinute",0,o):u<60?s.formatDistance("lessThanXMinutes",1,o):s.formatDistance("xMinutes",1,o):h===0?s.formatDistance("lessThanXMinutes",1,o):s.formatDistance("xMinutes",h,o);if(h<45)return s.formatDistance("xMinutes",h,o);if(h<90)return s.formatDistance("aboutXHours",1,o);if(h<Nz){const y=Math.round(h/60);return s.formatDistance("aboutXHours",y,o)}else{if(h<i)return s.formatDistance("xDays",1,o);if(h<VS){const y=Math.round(h/Nz);return s.formatDistance("xDays",y,o)}else if(h<VS*2)return m=Math.round(h/VS),s.formatDistance("aboutXMonths",m,o)}if(m=PTe(c,l),m<12){const y=Math.round(h/VS);return s.formatDistance("xMonths",y,o)}else{const y=m%12,b=Math.trunc(m/12);return y<3?s.formatDistance("aboutXYears",b,o):y<9?s.formatDistance("overXYears",b,o):s.formatDistance("almostXYears",b+1,o)}}function HZ(e,t){return FAe(e,ATe(e),t)}function LAe(e,t){const n=qr(e,t==null?void 0:t.in),r=n.getFullYear(),s=n.getMonth(),i=xi(n,0);return i.setFullYear(r,s+1,0),i.setHours(0,0,0,0),i.getDate()}function BAe(e,t){return qr(e,t==null?void 0:t.in).getMonth()}function $Ae(e,t){return qr(e,t==null?void 0:t.in).getFullYear()}function zAe(e,t){return+qr(e)>+qr(t)}function UAe(e,t){return+qr(e)<+qr(t)}function qAe(e,t,n){const[r,s]=Xh(n==null?void 0:n.in,e,t);return r.getFullYear()===s.getFullYear()&&r.getMonth()===s.getMonth()}function VAe(e,t,n){const[r,s]=Xh(n==null?void 0:n.in,e,t);return r.getFullYear()===s.getFullYear()}function WAe(e,t){const n=()=>xi(t==null?void 0:t.in,NaN),s=YAe(e);let i;if(s.date){const c=ZAe(s.date,2);i=XAe(c.restDateString,c.year)}if(!i||isNaN(+i))return n();const a=+i;let o=0,l;if(s.time&&(o=JAe(s.time),isNaN(o)))return n();if(s.timezone){if(l=QAe(s.timezone),isNaN(l))return n()}else{const c=new Date(a+o),u=qr(0,t==null?void 0:t.in);return u.setFullYear(c.getUTCFullYear(),c.getUTCMonth(),c.getUTCDate()),u.setHours(c.getUTCHours(),c.getUTCMinutes(),c.getUTCSeconds(),c.getUTCMilliseconds()),u}return qr(a+o+l,t==null?void 0:t.in)}const WS={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},HAe=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,GAe=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,KAe=/^([+-])(\d{2})(?::?(\d{2}))?$/;function YAe(e){const t={},n=e.split(WS.dateTimeDelimiter);let r;if(n.length>2)return t;if(/:/.test(n[0])?r=n[0]:(t.date=n[0],r=n[1],WS.timeZoneDelimiter.test(t.date)&&(t.date=e.split(WS.timeZoneDelimiter)[0],r=e.substr(t.date.length,e.length))),r){const s=WS.timezone.exec(r);s?(t.time=r.replace(s[1],""),t.timezone=s[1]):t.time=r}return t}function ZAe(e,t){const n=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),r=e.match(n);if(!r)return{year:NaN,restDateString:""};const s=r[1]?parseInt(r[1]):null,i=r[2]?parseInt(r[2]):null;return{year:i===null?s:i*100,restDateString:e.slice((r[1]||r[2]).length)}}function XAe(e,t){if(t===null)return new Date(NaN);const n=e.match(HAe);if(!n)return new Date(NaN);const r=!!n[4],s=$v(n[1]),i=$v(n[2])-1,a=$v(n[3]),o=$v(n[4]),l=$v(n[5])-1;if(r)return sRe(t,o,l)?eRe(t,o,l):new Date(NaN);{const c=new Date(0);return!nRe(t,i,a)||!rRe(t,s)?new Date(NaN):(c.setUTCFullYear(t,i,Math.max(s,a)),c)}}function $v(e){return e?parseInt(e):1}function JAe(e){const t=e.match(GAe);if(!t)return NaN;const n=hI(t[1]),r=hI(t[2]),s=hI(t[3]);return iRe(n,r,s)?n*IZ+r*MZ+s*1e3:NaN}function hI(e){return e&&parseFloat(e.replace(",","."))||0}function QAe(e){if(e==="Z")return 0;const t=e.match(KAe);if(!t)return 0;const n=t[1]==="+"?-1:1,r=parseInt(t[2]),s=t[3]&&parseInt(t[3])||0;return aRe(r,s)?n*(r*IZ+s*MZ):NaN}function eRe(e,t,n){const r=new Date(0);r.setUTCFullYear(e,0,4);const s=r.getUTCDay()||7,i=(t-1)*7+n+1-s;return r.setUTCDate(r.getUTCDate()+i),r}const tRe=[31,null,31,30,31,30,31,31,30,31,30,31];function GZ(e){return e%400===0||e%4===0&&e%100!==0}function nRe(e,t,n){return t>=0&&t<=11&&n>=1&&n<=(tRe[t]||(GZ(e)?29:28))}function rRe(e,t){return t>=1&&t<=(GZ(e)?366:365)}function sRe(e,t,n){return t>=1&&t<=53&&n>=0&&n<=6}function iRe(e,t,n){return e===24?t===0&&n===0:n>=0&&n<60&&t>=0&&t<60&&e>=0&&e<25}function aRe(e,t){return t>=0&&t<=59}function oRe(e,t,n){const r=qr(e,n==null?void 0:n.in),s=r.getFullYear(),i=r.getDate(),a=xi(e,0);a.setFullYear(s,t,15),a.setHours(0,0,0,0);const o=LAe(a);return r.setMonth(t,Math.min(i,o)),r}function lRe(e,t,n){const r=qr(e,n==null?void 0:n.in);return isNaN(+r)?xi(e,NaN):(r.setFullYear(t),r)}const Un=({tooltipText:e,icon:t,iconClassName:n,tooltipSide:r="top",onClick:s,disabled:i,variant:a="ghost",size:o="icon",className:l,"aria-label":c,...u})=>{const d=typeof t=="function";return f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(mt,{variant:a,size:o,onClick:s,disabled:i,className:Xe("h-6 w-6",l),"aria-label":c??e,...u,children:d?f.jsx(t,{className:Xe("h-3.5 w-3.5",n)}):t})}),f.jsx(Sr,{side:r,children:f.jsx("p",{children:e})})]})})},Dz={};function cRe(e){let t=Dz[e];if(t)return t;t=Dz[e]=[];for(let n=0;n<128;n++){const r=String.fromCharCode(n);t.push(r)}for(let n=0;n<e.length;n++){const r=e.charCodeAt(n);t[r]="%"+("0"+r.toString(16).toUpperCase()).slice(-2)}return t}function wy(e,t){typeof t!="string"&&(t=wy.defaultChars);const n=cRe(t);return e.replace(/(%[a-f0-9]{2})+/gi,function(r){let s="";for(let i=0,a=r.length;i<a;i+=3){const o=parseInt(r.slice(i+1,i+3),16);if(o<128){s+=n[o];continue}if((o&224)===192&&i+3<a){const l=parseInt(r.slice(i+4,i+6),16);if((l&192)===128){const c=o<<6&1984|l&63;c<128?s+="":s+=String.fromCharCode(c),i+=3;continue}}if((o&240)===224&&i+6<a){const l=parseInt(r.slice(i+4,i+6),16),c=parseInt(r.slice(i+7,i+9),16);if((l&192)===128&&(c&192)===128){const u=o<<12&61440|l<<6&4032|c&63;u<2048||u>=55296&&u<=57343?s+="":s+=String.fromCharCode(u),i+=6;continue}}if((o&248)===240&&i+9<a){const l=parseInt(r.slice(i+4,i+6),16),c=parseInt(r.slice(i+7,i+9),16),u=parseInt(r.slice(i+10,i+12),16);if((l&192)===128&&(c&192)===128&&(u&192)===128){let d=o<<18&1835008|l<<12&258048|c<<6&4032|u&63;d<65536||d>1114111?s+="":(d-=65536,s+=String.fromCharCode(55296+(d>>10),56320+(d&1023))),i+=9;continue}}s+=""}return s})}wy.defaultChars=";/?:@&=+$,#";wy.componentChars="";const Fz={};function uRe(e){let t=Fz[e];if(t)return t;t=Fz[e]=[];for(let n=0;n<128;n++){const r=String.fromCharCode(n);/^[0-9a-z]$/i.test(r)?t.push(r):t.push("%"+("0"+n.toString(16).toUpperCase()).slice(-2))}for(let n=0;n<e.length;n++)t[e.charCodeAt(n)]=e[n];return t}function W1(e,t,n){typeof t!="string"&&(n=t,t=W1.defaultChars),typeof n>"u"&&(n=!0);const r=uRe(t);let s="";for(let i=0,a=e.length;i<a;i++){const o=e.charCodeAt(i);if(n&&o===37&&i+2<a&&/^[0-9a-f]{2}$/i.test(e.slice(i+1,i+3))){s+=e.slice(i,i+3),i+=2;continue}if(o<128){s+=r[o];continue}if(o>=55296&&o<=57343){if(o>=55296&&o<=56319&&i+1<a){const l=e.charCodeAt(i+1);if(l>=56320&&l<=57343){s+=encodeURIComponent(e[i]+e[i+1]),i++;continue}}s+="%EF%BF%BD";continue}s+=encodeURIComponent(e[i])}return s}W1.defaultChars=";/?:@&=+$,-_.!~*'()#";W1.componentChars="-_.!~*'()";function wD(e){let t="";return t+=e.protocol||"",t+=e.slashes?"//":"",t+=e.auth?e.auth+"@":"",e.hostname&&e.hostname.indexOf(":")!==-1?t+="["+e.hostname+"]":t+=e.hostname||"",t+=e.port?":"+e.port:"",t+=e.pathname||"",t+=e.search||"",t+=e.hash||"",t}function rk(){this.protocol=null,this.slashes=null,this.auth=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.pathname=null}const dRe=/^([a-z0-9.+-]+:)/i,fRe=/:[0-9]*$/,hRe=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,pRe=["<",">",'"',"`"," ","\r",`
`,"	"],mRe=["{","}","|","\\","^","`"].concat(pRe),gRe=["'"].concat(mRe),Lz=["%","/","?",";","#"].concat(gRe),Bz=["/","?","#"],yRe=255,$z=/^[+a-z0-9A-Z_-]{0,63}$/,bRe=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,zz={javascript:!0,"javascript:":!0},Uz={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0};function _D(e,t){if(e&&e instanceof rk)return e;const n=new rk;return n.parse(e,t),n}rk.prototype.parse=function(e,t){let n,r,s,i=e;if(i=i.trim(),!t&&e.split("#").length===1){const c=hRe.exec(i);if(c)return this.pathname=c[1],c[2]&&(this.search=c[2]),this}let a=dRe.exec(i);if(a&&(a=a[0],n=a.toLowerCase(),this.protocol=a,i=i.substr(a.length)),(t||a||i.match(/^\/\/[^@\/]+@[^@\/]+/))&&(s=i.substr(0,2)==="//",s&&!(a&&zz[a])&&(i=i.substr(2),this.slashes=!0)),!zz[a]&&(s||a&&!Uz[a])){let c=-1;for(let y=0;y<Bz.length;y++)r=i.indexOf(Bz[y]),r!==-1&&(c===-1||r<c)&&(c=r);let u,d;c===-1?d=i.lastIndexOf("@"):d=i.lastIndexOf("@",c),d!==-1&&(u=i.slice(0,d),i=i.slice(d+1),this.auth=u),c=-1;for(let y=0;y<Lz.length;y++)r=i.indexOf(Lz[y]),r!==-1&&(c===-1||r<c)&&(c=r);c===-1&&(c=i.length),i[c-1]===":"&&c--;const h=i.slice(0,c);i=i.slice(c),this.parseHost(h),this.hostname=this.hostname||"";const m=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!m){const y=this.hostname.split(/\./);for(let b=0,v=y.length;b<v;b++){const x=y[b];if(x&&!x.match($z)){let w="";for(let S=0,k=x.length;S<k;S++)x.charCodeAt(S)>127?w+="x":w+=x[S];if(!w.match($z)){const S=y.slice(0,b),k=y.slice(b+1),C=x.match(bRe);C&&(S.push(C[1]),k.unshift(C[2])),k.length&&(i=k.join(".")+i),this.hostname=S.join(".");break}}}}this.hostname.length>yRe&&(this.hostname=""),m&&(this.hostname=this.hostname.substr(1,this.hostname.length-2))}const o=i.indexOf("#");o!==-1&&(this.hash=i.substr(o),i=i.slice(0,o));const l=i.indexOf("?");return l!==-1&&(this.search=i.substr(l),i=i.slice(0,l)),i&&(this.pathname=i),Uz[n]&&this.hostname&&!this.pathname&&(this.pathname=""),this};rk.prototype.parseHost=function(e){let t=fRe.exec(e);t&&(t=t[0],t!==":"&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)};const vRe=Object.freeze(Object.defineProperty({__proto__:null,decode:wy,encode:W1,format:wD,parse:_D},Symbol.toStringTag,{value:"Module"})),KZ=/[\0-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,YZ=/[\0-\x1F\x7F-\x9F]/,xRe=/[\xAD\u0600-\u0605\u061C\u06DD\u070F\u0890\u0891\u08E2\u180E\u200B-\u200F\u202A-\u202E\u2060-\u2064\u2066-\u206F\uFEFF\uFFF9-\uFFFB]|\uD804[\uDCBD\uDCCD]|\uD80D[\uDC30-\uDC3F]|\uD82F[\uDCA0-\uDCA3]|\uD834[\uDD73-\uDD7A]|\uDB40[\uDC01\uDC20-\uDC7F]/,SD=/[!-#%-\*,-\/:;\?@\[-\]_\{\}\xA1\xA7\xAB\xB6\xB7\xBB\xBF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061D-\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C77\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1B7D\u1B7E\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4F\u2E52-\u2E5D\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]|\uD800[\uDD00-\uDD02\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD803[\uDEAD\uDF55-\uDF59\uDF86-\uDF89]|\uD804[\uDC47-\uDC4D\uDCBB\uDCBC\uDCBE-\uDCC1\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC8\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9]|\uD805[\uDC4B-\uDC4F\uDC5A\uDC5B\uDC5D\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDE60-\uDE6C\uDEB9\uDF3C-\uDF3E]|\uD806[\uDC3B\uDD44-\uDD46\uDDE2\uDE3F-\uDE46\uDE9A-\uDE9C\uDE9E-\uDEA2\uDF00-\uDF09]|\uD807[\uDC41-\uDC45\uDC70\uDC71\uDEF7\uDEF8\uDF43-\uDF4F\uDFFF]|\uD809[\uDC70-\uDC74]|\uD80B[\uDFF1\uDFF2]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3B\uDF44]|\uD81B[\uDE97-\uDE9A\uDFE2]|\uD82F\uDC9F|\uD836[\uDE87-\uDE8B]|\uD83A[\uDD5E\uDD5F]/,ZZ=/[\$\+<->\^`\|~\xA2-\xA6\xA8\xA9\xAC\xAE-\xB1\xB4\xB8\xD7\xF7\u02C2-\u02C5\u02D2-\u02DF\u02E5-\u02EB\u02ED\u02EF-\u02FF\u0375\u0384\u0385\u03F6\u0482\u058D-\u058F\u0606-\u0608\u060B\u060E\u060F\u06DE\u06E9\u06FD\u06FE\u07F6\u07FE\u07FF\u0888\u09F2\u09F3\u09FA\u09FB\u0AF1\u0B70\u0BF3-\u0BFA\u0C7F\u0D4F\u0D79\u0E3F\u0F01-\u0F03\u0F13\u0F15-\u0F17\u0F1A-\u0F1F\u0F34\u0F36\u0F38\u0FBE-\u0FC5\u0FC7-\u0FCC\u0FCE\u0FCF\u0FD5-\u0FD8\u109E\u109F\u1390-\u1399\u166D\u17DB\u1940\u19DE-\u19FF\u1B61-\u1B6A\u1B74-\u1B7C\u1FBD\u1FBF-\u1FC1\u1FCD-\u1FCF\u1FDD-\u1FDF\u1FED-\u1FEF\u1FFD\u1FFE\u2044\u2052\u207A-\u207C\u208A-\u208C\u20A0-\u20C0\u2100\u2101\u2103-\u2106\u2108\u2109\u2114\u2116-\u2118\u211E-\u2123\u2125\u2127\u2129\u212E\u213A\u213B\u2140-\u2144\u214A-\u214D\u214F\u218A\u218B\u2190-\u2307\u230C-\u2328\u232B-\u2426\u2440-\u244A\u249C-\u24E9\u2500-\u2767\u2794-\u27C4\u27C7-\u27E5\u27F0-\u2982\u2999-\u29D7\u29DC-\u29FB\u29FE-\u2B73\u2B76-\u2B95\u2B97-\u2BFF\u2CE5-\u2CEA\u2E50\u2E51\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u2FFF\u3004\u3012\u3013\u3020\u3036\u3037\u303E\u303F\u309B\u309C\u3190\u3191\u3196-\u319F\u31C0-\u31E3\u31EF\u3200-\u321E\u322A-\u3247\u3250\u3260-\u327F\u328A-\u32B0\u32C0-\u33FF\u4DC0-\u4DFF\uA490-\uA4C6\uA700-\uA716\uA720\uA721\uA789\uA78A\uA828-\uA82B\uA836-\uA839\uAA77-\uAA79\uAB5B\uAB6A\uAB6B\uFB29\uFBB2-\uFBC2\uFD40-\uFD4F\uFDCF\uFDFC-\uFDFF\uFE62\uFE64-\uFE66\uFE69\uFF04\uFF0B\uFF1C-\uFF1E\uFF3E\uFF40\uFF5C\uFF5E\uFFE0-\uFFE6\uFFE8-\uFFEE\uFFFC\uFFFD]|\uD800[\uDD37-\uDD3F\uDD79-\uDD89\uDD8C-\uDD8E\uDD90-\uDD9C\uDDA0\uDDD0-\uDDFC]|\uD802[\uDC77\uDC78\uDEC8]|\uD805\uDF3F|\uD807[\uDFD5-\uDFF1]|\uD81A[\uDF3C-\uDF3F\uDF45]|\uD82F\uDC9C|\uD833[\uDF50-\uDFC3]|\uD834[\uDC00-\uDCF5\uDD00-\uDD26\uDD29-\uDD64\uDD6A-\uDD6C\uDD83\uDD84\uDD8C-\uDDA9\uDDAE-\uDDEA\uDE00-\uDE41\uDE45\uDF00-\uDF56]|\uD835[\uDEC1\uDEDB\uDEFB\uDF15\uDF35\uDF4F\uDF6F\uDF89\uDFA9\uDFC3]|\uD836[\uDC00-\uDDFF\uDE37-\uDE3A\uDE6D-\uDE74\uDE76-\uDE83\uDE85\uDE86]|\uD838[\uDD4F\uDEFF]|\uD83B[\uDCAC\uDCB0\uDD2E\uDEF0\uDEF1]|\uD83C[\uDC00-\uDC2B\uDC30-\uDC93\uDCA0-\uDCAE\uDCB1-\uDCBF\uDCC1-\uDCCF\uDCD1-\uDCF5\uDD0D-\uDDAD\uDDE6-\uDE02\uDE10-\uDE3B\uDE40-\uDE48\uDE50\uDE51\uDE60-\uDE65\uDF00-\uDFFF]|\uD83D[\uDC00-\uDED7\uDEDC-\uDEEC\uDEF0-\uDEFC\uDF00-\uDF76\uDF7B-\uDFD9\uDFE0-\uDFEB\uDFF0]|\uD83E[\uDC00-\uDC0B\uDC10-\uDC47\uDC50-\uDC59\uDC60-\uDC87\uDC90-\uDCAD\uDCB0\uDCB1\uDD00-\uDE53\uDE60-\uDE6D\uDE70-\uDE7C\uDE80-\uDE88\uDE90-\uDEBD\uDEBF-\uDEC5\uDECE-\uDEDB\uDEE0-\uDEE8\uDEF0-\uDEF8\uDF00-\uDF92\uDF94-\uDFCA]/,XZ=/[ \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000]/,wRe=Object.freeze(Object.defineProperty({__proto__:null,Any:KZ,Cc:YZ,Cf:xRe,P:SD,S:ZZ,Z:XZ},Symbol.toStringTag,{value:"Module"})),_Re=new Uint16Array('<\0\0\0\0\0\0EMabcfglmnoprstu\\bfmsligP&cutereve;iyx}rc;r;ravepha;acr;d;gpon;f;plyFunction;ingcsr;ign;ildemlaceforsucrkslash;;ed;y;crtause;noullis;a;r;pf;eve;cmpeq;HOacdefhilorsucy;PYcpyute;;italDifferentialD;leys;aeioron;dilrc;nint;ot;dnilla;terDot;i;rcleDMPTot;inus;lus;imes;ocskwiseContourIntegral;eCurlyDQoubleQuote;uote;lnpuon;e;gitruent;nt;ourIntegral;fr;oduct;nterClockwiseContourIntegral;oss;cr;p;Cap;DJSZacefios;otrahd;cy;cy;cy;grsger;r;hv;ayron;;l;ta;r;afcmriticalADGTcute;o;bleAcute;rave;ilde;ond;ferentialD;\0\0\0\0f;;DEot;qual;bleCDLRUVontourIntegrao\0\0nArrow;eoftARTrrow;ightArrow;engLReftARrrow;ightArrow;ightArrow;ightATrrow;ee;p\0\0rrow;ownArrow;erticalBar;nABLRTarrow;BUar;pArrow;reve;eft\0\0ightVector;eeVector;ector;Bar;ight\0eeVector;ector;Bar;ee;Arrow;ctr;rok;NTacdfglmopqstuxG;Hcuteaiyron;rc;ot;r;raveement;apcr;ty\0\0mallSquare;erySmallSquare;gpon;f;silon;uail;Tilde;librium;cir;m;a;mlipsts;onentialE;cfiosy;r;lled\0\0mallSquare;erySmallSquare;\0\0\0f;All;riertrf;cJTabcdfgorstcy;>mma;d;reve;eiydil;rc;;ot;r;;pf;eaterEFGLSTqual;Less;ullEqual;reater;ess;lantEqual;ilde;cr;;AacfiosuRDcy;ctek;;irc;r;lbertSpace;\0f;izontalLine;ctrok;mpownHumqual;EJOacdfgmnostucy;lig;cy;cuteiyrc;ot;r;rave;apcgr;inaryI;lie\0;egrral;section;isibleCTomma;imes;gpton;f;a;cr;ilde;\0cy;lcfosuiyrc;;r;pf;\0r;rcy;kcy;HJacfoscy;cy;ppa;eydil;;r;pf;cr;JTaceflmostcy;<cmnprute;bda;g;lacetrf;r;aeyron;dil;;fstACDFRTUVarnrgleBracket;row;BRar;ightArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ightAVrrow;ector;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;ightsEFGLSTqualGreater;ullEqual;reater;ess;lantEqual;ilde;r;;eftarrow;idot;npwgLRlreftARrrow;ightArrow;ightArrow;eftarightightf;erLReftArrow;ightArrow;cht;rok;;acefiosup;y;dliumSpace;lintrf;r;nusPlus;pf;c;Jacefostucy;cute;aeyron;dil;;gswativeMTVediumSpace;hicneryThitedGLreaterGreateessLesLine;r;Bnptreak;BreakingSpace;f;;CDEGHLNPRSTVoungruent;pCap;oubleVerticalBar;lqxement;ual;Tilde;ists;reater;EFGLSTqual;ullEqual;reater;ess;lantEqual;ilde;umpownHump;qual;efstTriangle;BEar;qual;s;EGLSTqual;reater;ess;lantEqual;ilde;estedGLreaterGreater;essLess;recedes;ESqual;lantEqual;eiverseElement;ghtTriangle;BEar;qual;quuareSubpset;Equal;erset;Equal;bcpset;Equal;ceeds;ESTqual;lantEqual;ilde;erset;Equal;ilde;EFTqual;ullEqual;ilde;erticalBar;cr;ilde;Eacdfgmoprstuvlig;cuteiyrc;blac;r;raveaeicr;ga;cron;pf;enCurlyDQoubleQuote;uote;;clr;ashidees;mlerBParr;acek;et;arenthesis;acfhilorsrtialD;y;r;i;;usMinus;ipncareplanf;;eiocedes;ESTqual;lantEqual;ilde;me;dpuct;ortion;al;cir;;UfosOT"r;pf;cr;BEacefhiorsuarr;Gcnrute;g;r;tl;aeyron;dil;;;verseEUlqement;uilibrium;pEquilibrium;ro;ghtACDFTUVanrgleBracket;row;BLar;eftArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;puf;ndImplies;ightarrow;chr;;leDelayed;HOacfhimoqstuCcHcy;y;FTcy;cute;;aeiyron;dil;rc;;r;ortDLRUownArroweftArrowightArrowpArrow;gma;allCircle;pf;\0\0t;are;ISUntersection;ubpset;Equal;erset;Equal;nion;cr;ar;bcmp;set;Equal;cheeds;ESTqual;lantEqual;ilde;Th;;esrset;Equal;etHRSacfhiorsORNADE;Hccy;y;bu;;aeyron;dil;;r;ei\0efore;a;cnkSpace;Space;lde;EFTqual;ullEqual;ilde;pf;ipleDot;ctr;rok;\0\0\0\0\0\0\0cruter;ocir;r\0y;ve;iyrc;blac;r;raveacr;dierBParr;acek;et;arenthesis;on;Plus;gpon;f;ADETadpsrrow;BDar;ownArrow;ownArrow;quilibrium;ee;Arrow;ownerLReftArrow;ightArrow;i;lon;ing;cr;ilde;mlDbcdefosvash;ar;y;ash;l;er;btyar;;icalBLSTar;ine;eparator;ilde;ThinSpace;r;pf;cr;dash;cefosirc;dge;r;pf;cr;fiosr;;pf;cr;AIUacfosucy;cy;cy;cuteiyrc;;r;pf;cr;ml;Hacdefoscy;cute;ayron;;ot;\0oWidta;r;pf;cr;\0\0\0\0\0\0\0cutereve;;Ediuy;;rcte;lig;r;raveepfpsym;ha;apcclr;g;\0\0;adsvnd;;lope;;;elmrsz;esd;a;;;;;;;;t;vb;d;pth;arr;gpon;f;;Eaeiop;cir;;d;s;rox;eingctyr;;mp;eildemlcioninnt;Nabcdefiklnoprsuot;crkcepsong;psilon;rime;im;eq;ee;ed;gerk;tbrk;oy;quo;cmprtaus;eptyv;snoahw;;een;r;gcostuvwaiurc;pdptot;lus;imes;\0\0cup;ar;riangleduown;p;plus;earow;akocnklstozenge;riangle;dlrown;eft;ight;k;\0\0;;4;ck;eo;q=uiv;t;ptwxf;;tomtie;DHUVbdhmptuvLRlr;;;;;DUdu;;;;LRlr;;;;;HLRhlr;;;;;;ox;LRlr;;;;;DUdu;;;;inus;lus;imes;LRlr;;;;;HLRhlr;;;;;;evbarceior;mi;m;el;bh;sub;l;etp;Ee;;q\0\0\0\0\0\0\0\0\0\0cprute;;abcdsnd;rcup;aup;p;ot;;eot;aeiu\0s;on;dilrc;ps;sm;ot;dmnilptyv;t;err;ceiy;ck;mark;r;Ecefms;;elq;e\0\0rrowlreft;ight;RSacd;st;irc;ash;nint;id;cir;ubs;uit\0on;e;q\0\0a;t;;flemxente\0;dot;nfry;o;sr;aorr;ss;cur;bp;e;;e;dot;delprvwarrlr;;\0\0r;c;arr;p;;bcdosrcap;aup;p;ot;r;;alrvrr;m;yevwq\0\0reuee;edge;enearrowlreftightecioninnt;lcty;AHabcdefhijlorstuwzrar;glrsger;eth;h;varow;aayron;;;aogrr;tseq;glmta;ptyv;irsht;;arlraegsvm;osnd;suit;amma;in;;iode;ontimes;ncy;c\0\0rn;op;lptuwlar;f;;empsq;dot;inus;lus;quare;blebarwedgnadhownarrowarpoonlrefighkaro\0\0rn;op;cotry;;l;rok;drot;i;fahraangle;ciy;grarr;DacdefglmnopqrstuxDoocsuteter;aioyron;r;clon;;ot;Drot;;;rsave;dot;;ilsnters;;;dot;apscr;ty;svetp1;;;gs;p;gpon;f;alsr;sl;us;i;lvon;csuviorc\0\0antgltressaeils;st;v;DD;parsl;Daot;rr;cdir;oah;mrlo;cipl;seoctationential\0\0\0\0\0\0\0llingdotsey;male;ilrlig;\0\0g;ig;;lig;lig;fjaltt;ig;ns;of;\0f;ak;v;artint;aocs\0\0;;;;\0;;\0\0;;5;\0;;8;l;wn;cr;Eabcdefgijlnorstv;l;cmpute;ma;d;reve;iyrc;;ot;;lqs;qslan;cdlc;ot;o;l;;es;r;;gmel;cy;;Eaj;;;Eaes;p;prox;q;qim;pf;cir;m;el;;>;cdlqrci;r;ot;Par;uest;adels\0pror;qlqlesienrtneqq;Aabcefkosyrilmrrsfildrcy;;cwir;;ar;irc;alrrts;uitlip;con;r;sewarow;arow;amoprrr;tht;klreftarrow;ightarrow;f;bar;cltr;asrok;bpull;hen\0\0\0\0\0\0cute;iyrc;cxy;clfr;rave;inoinnt;t;fin;ta;lig;aopcgtr;elpinarh;f;ed;;cfotare;in;tie;do;celpal;grerarhk;rod;cgpty;on;f;a;uestcir;n;Edsv;ot;;v;;ilde;\0cy;lcfmosuiyrc;;r;ath;pf;\0r;rcy;kcy;acfghjosppa;v;eydil;;r;reen;cy;cy;pf;cr;ABEHabcdefghjlmnoprstuvartrail;arr;;g;ar;\0\0\0\0\0\0\0\0\0ute;mptyv;rabda;g;dl;;uor;bfhlpst;fs;s;p;l;im;l;;aeil;;s;abrrr;rk;akcek;;es;ldu;;aeuyron;diil;;cqrsa;uo;rduhar;shar;h;;fgqstahlrtrrow;taarpoonduownpeftarrows;ightahsrrow;sarpoonquigarrohreetimes;;qslan;cdgsc;ot;o;r;;es;adegspproot;qgqgtiilrsht;;;E;rdu;l;lk;cy;;achtrorneard;ri;iodot;ust;acheEaes;p;prox;q;qim;abnoptwznrg;r;rglmreftarightapsto;ightparrowlrefight;aflr;;us;imes;st;;efngear;lt;achmtrornear;d;;ri;achiqtquo;r;m;eg;;buo;r;rok;<;cdhilqrci;r;remes;arr;uest;Piar;;efrdushar;har;enrtneqq;DacdefhilnopsuDot;clprret;;ese;sto;dluowefker;oymma;;ash;asuredangler;o;cdnro;acdsir;otus;bd;u;p;dpels;f;ctr;pos;lmtimap;GLRVabcdefghijlmoprstuvwgt;;veltftarrrow;ightarrow;;;vightarrow;Ddash;ash;bcnptlaute;g;;Eiop;d;s;rour;al;s\0pmp;eaeouy\0;on;dil;ng;dot;p;;ash;;Aadqsxrr;rhrk;;oot;uieiar;ist;sr;Eest;qs;qslani;rAaprrr;ar;;sv;d;cy;AEadestr;rr;r;;fqstarrroightarro;qslan;si;ri;eiptf;;inn;Edv;ot;;;i;v;;aorr;astllel;;lint;;ceu;c;eAaitrrr;cw;;ghtarrowri;echimpqu;ceru;ort\0\0arm;e;qsubpbcp;Ees;et;eq;qc;e;Ees;et;eq;qgilrldeianglelreft;eight;e;m;esro;p;DHadgilrsash;arr;p;ash;et;;>nfin;Aetrr;;;r<ie;Atrr;rie;im;Aanrr;rhrk;;oear;\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0csuteiyr;c;abioslac;v;old;lig;crir;;\0\0\0n;ave;bmar;acitrirr;oss;n;aeicr;ga;cdnron;;pf;aelr;rp;;adiosvr;efmr;ofgof;r;lope;;cloashl;idees;as;mlbar;\0\0\0\0\0\0\0\0\0r;ast;lle\0\0m;;y;rcimptnt;od;il;enk;r;imo;v;mane;;tvchfork;aunckk;h;s;abcdemstcir;ir;ou;;nim;wo;ipuntint;f;nd;Eaceinosu;p;u;c;acenspprourlyeaespprox;qq;im;ime;sEasdfpalslar;ine;urf;;trel;cir;;ncsp;fiopsur;pf;rime;cr;aeoteirnionnt;st;eABHabcdefhilmnoprstuxartrail;arar;cdenqrteu;te;imptyv;g;del;;uor;abcfhlpstwp;;fs;;s;l;im;l;;aiil;o;nalabrrrk;akcek;;es;ldu;;aeuyron;diil;;clqsa;dhar;uo;rh;acgl;ipsnart;ilrsht;;aordu;l;;v;gnshtahlrstrrow;taarpoonduowpeftahrrowarpoonightarrows;quigarrohreetimes;g;ingdotseahmra;oust;achemid;abptnrg;r;raflr;;us;imes;apr;gt;olint;arachqquo;r;buo;rhirremes;i;efltri;luhar;;\0\0\0\0\0\0\0cute;qu;Eaceinpsy;\0;on;u;dil;rc;Eas;p;im;olint;i;ot;be;Aacmstxrr;rhr;oti;war;minnut;r;oacoyrp;hycy;;rt\0\0iaragmma;fv;;deglnprot;;q;E;;E;e;lus;arr;araeitlslsetmhp;parsl;dle;;e;s;flptcy;;b;ar;f;adres;uitcsuaup;s;p;s;ubp;eset;e;eset;e;afrarcemtr;tmiararr;fanighteppsilohsbcmnp;Edemnprs;ot;;dot;ult;Ee;;lus;arr;eiut;enq;qeq;qm;bp;;c;acenspprourlyeaespproqg;123;Edehlmnps;ost;ub;;dot;soul;b;arr;ult;Ee;;lus;eiut;enq;qeq;qm;bp;;Aanrr;rhr;owar;lig\0\0\0\0\0\0\0\0\0\0\0\0get;;raeyron;dil;;lrec;r;eiko\0e4fa;svym;cnkaspproimsasrnes;bd;ar;;eps;bcfot;ir;;ork;rime;aipdadempstngle;dlqrowneft;e;ight;eot;inus;lus;b;ime;ezium;chtry;;cy;rok;ioxheadlreftarroightarrowAHabcdfghlmoprstuwrar;cruter\0y;ve;iyrc;abhrlac;airsht;;raverlrlk;ct\0\0rn;erop;ri;alcr;gpon;f;adhlsuownarpoonlrefighi;hlonparrows;cit\0\0rn;erop;ng;ri;cr;dirot;lde;i;famrlangle;ABDacdeflnoprszrar;v;asnrgrt;eknprstappothinhirop;hiugmbpsetneq;q;setneq;q;hretianglelreftighty;ashelr;bear;q;lip;btar;trsubppf;rotrcur;bpnEenEeigzag;cefoprsirc;dibgar;e;q;erp;r;pf;;eatcr;\0\0\0\0\0\0\0trr;Aarr;Aarrais;dptfl;imAarrcqr;ptracefiosucuyte;iyrc;;nr;cy;pf;cr;cmy;lacdefhioswcute;ayron;;ot;ettra;r;cy;grarr;pf;cr;jn;j;'.split("").map(e=>e.charCodeAt(0))),SRe=new Uint16Array("aglq	\x1B\0\0p;os;t;t;uot;".split("").map(e=>e.charCodeAt(0)));var pI;const CRe=new Map([[0,65533],[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]),kRe=(pI=String.fromCodePoint)!==null&&pI!==void 0?pI:function(e){let t="";return e>65535&&(e-=65536,t+=String.fromCharCode(e>>>10&1023|55296),e=56320|e&1023),t+=String.fromCharCode(e),t};function ERe(e){var t;return e>=55296&&e<=57343||e>1114111?65533:(t=CRe.get(e))!==null&&t!==void 0?t:e}var oa;(function(e){e[e.NUM=35]="NUM",e[e.SEMI=59]="SEMI",e[e.EQUALS=61]="EQUALS",e[e.ZERO=48]="ZERO",e[e.NINE=57]="NINE",e[e.LOWER_A=97]="LOWER_A",e[e.LOWER_F=102]="LOWER_F",e[e.LOWER_X=120]="LOWER_X",e[e.LOWER_Z=122]="LOWER_Z",e[e.UPPER_A=65]="UPPER_A",e[e.UPPER_F=70]="UPPER_F",e[e.UPPER_Z=90]="UPPER_Z"})(oa||(oa={}));const TRe=32;var fh;(function(e){e[e.VALUE_LENGTH=49152]="VALUE_LENGTH",e[e.BRANCH_LENGTH=16256]="BRANCH_LENGTH",e[e.JUMP_TABLE=127]="JUMP_TABLE"})(fh||(fh={}));function Bj(e){return e>=oa.ZERO&&e<=oa.NINE}function ARe(e){return e>=oa.UPPER_A&&e<=oa.UPPER_F||e>=oa.LOWER_A&&e<=oa.LOWER_F}function RRe(e){return e>=oa.UPPER_A&&e<=oa.UPPER_Z||e>=oa.LOWER_A&&e<=oa.LOWER_Z||Bj(e)}function NRe(e){return e===oa.EQUALS||RRe(e)}var ta;(function(e){e[e.EntityStart=0]="EntityStart",e[e.NumericStart=1]="NumericStart",e[e.NumericDecimal=2]="NumericDecimal",e[e.NumericHex=3]="NumericHex",e[e.NamedEntity=4]="NamedEntity"})(ta||(ta={}));var ch;(function(e){e[e.Legacy=0]="Legacy",e[e.Strict=1]="Strict",e[e.Attribute=2]="Attribute"})(ch||(ch={}));class MRe{constructor(t,n,r){this.decodeTree=t,this.emitCodePoint=n,this.errors=r,this.state=ta.EntityStart,this.consumed=1,this.result=0,this.treeIndex=0,this.excess=1,this.decodeMode=ch.Strict}startEntity(t){this.decodeMode=t,this.state=ta.EntityStart,this.result=0,this.treeIndex=0,this.excess=1,this.consumed=1}write(t,n){switch(this.state){case ta.EntityStart:return t.charCodeAt(n)===oa.NUM?(this.state=ta.NumericStart,this.consumed+=1,this.stateNumericStart(t,n+1)):(this.state=ta.NamedEntity,this.stateNamedEntity(t,n));case ta.NumericStart:return this.stateNumericStart(t,n);case ta.NumericDecimal:return this.stateNumericDecimal(t,n);case ta.NumericHex:return this.stateNumericHex(t,n);case ta.NamedEntity:return this.stateNamedEntity(t,n)}}stateNumericStart(t,n){return n>=t.length?-1:(t.charCodeAt(n)|TRe)===oa.LOWER_X?(this.state=ta.NumericHex,this.consumed+=1,this.stateNumericHex(t,n+1)):(this.state=ta.NumericDecimal,this.stateNumericDecimal(t,n))}addToNumericResult(t,n,r,s){if(n!==r){const i=r-n;this.result=this.result*Math.pow(s,i)+parseInt(t.substr(n,i),s),this.consumed+=i}}stateNumericHex(t,n){const r=n;for(;n<t.length;){const s=t.charCodeAt(n);if(Bj(s)||ARe(s))n+=1;else return this.addToNumericResult(t,r,n,16),this.emitNumericEntity(s,3)}return this.addToNumericResult(t,r,n,16),-1}stateNumericDecimal(t,n){const r=n;for(;n<t.length;){const s=t.charCodeAt(n);if(Bj(s))n+=1;else return this.addToNumericResult(t,r,n,10),this.emitNumericEntity(s,2)}return this.addToNumericResult(t,r,n,10),-1}emitNumericEntity(t,n){var r;if(this.consumed<=n)return(r=this.errors)===null||r===void 0||r.absenceOfDigitsInNumericCharacterReference(this.consumed),0;if(t===oa.SEMI)this.consumed+=1;else if(this.decodeMode===ch.Strict)return 0;return this.emitCodePoint(ERe(this.result),this.consumed),this.errors&&(t!==oa.SEMI&&this.errors.missingSemicolonAfterCharacterReference(),this.errors.validateNumericCharacterReference(this.result)),this.consumed}stateNamedEntity(t,n){const{decodeTree:r}=this;let s=r[this.treeIndex],i=(s&fh.VALUE_LENGTH)>>14;for(;n<t.length;n++,this.excess++){const a=t.charCodeAt(n);if(this.treeIndex=IRe(r,s,this.treeIndex+Math.max(1,i),a),this.treeIndex<0)return this.result===0||this.decodeMode===ch.Attribute&&(i===0||NRe(a))?0:this.emitNotTerminatedNamedEntity();if(s=r[this.treeIndex],i=(s&fh.VALUE_LENGTH)>>14,i!==0){if(a===oa.SEMI)return this.emitNamedEntityData(this.treeIndex,i,this.consumed+this.excess);this.decodeMode!==ch.Strict&&(this.result=this.treeIndex,this.consumed+=this.excess,this.excess=0)}}return-1}emitNotTerminatedNamedEntity(){var t;const{result:n,decodeTree:r}=this,s=(r[n]&fh.VALUE_LENGTH)>>14;return this.emitNamedEntityData(n,s,this.consumed),(t=this.errors)===null||t===void 0||t.missingSemicolonAfterCharacterReference(),this.consumed}emitNamedEntityData(t,n,r){const{decodeTree:s}=this;return this.emitCodePoint(n===1?s[t]&~fh.VALUE_LENGTH:s[t+1],r),n===3&&this.emitCodePoint(s[t+2],r),r}end(){var t;switch(this.state){case ta.NamedEntity:return this.result!==0&&(this.decodeMode!==ch.Attribute||this.result===this.treeIndex)?this.emitNotTerminatedNamedEntity():0;case ta.NumericDecimal:return this.emitNumericEntity(0,2);case ta.NumericHex:return this.emitNumericEntity(0,3);case ta.NumericStart:return(t=this.errors)===null||t===void 0||t.absenceOfDigitsInNumericCharacterReference(this.consumed),0;case ta.EntityStart:return 0}}}function JZ(e){let t="";const n=new MRe(e,r=>t+=kRe(r));return function(s,i){let a=0,o=0;for(;(o=s.indexOf("&",o))>=0;){t+=s.slice(a,o),n.startEntity(i);const c=n.write(s,o+1);if(c<0){a=o+n.end();break}a=o+c,o=c===0?a+1:a}const l=t+s.slice(a);return t="",l}}function IRe(e,t,n,r){const s=(t&fh.BRANCH_LENGTH)>>7,i=t&fh.JUMP_TABLE;if(s===0)return i!==0&&r===i?n:-1;if(i){const l=r-i;return l<0||l>=s?-1:e[n+l]-1}let a=n,o=a+s-1;for(;a<=o;){const l=a+o>>>1,c=e[l];if(c<r)a=l+1;else if(c>r)o=l-1;else return e[l+s]}return-1}const jRe=JZ(_Re);JZ(SRe);function QZ(e,t=ch.Legacy){return jRe(e,t)}function ORe(e){return Object.prototype.toString.call(e)}function CD(e){return ORe(e)==="[object String]"}const PRe=Object.prototype.hasOwnProperty;function DRe(e,t){return PRe.call(e,t)}function uT(e){return Array.prototype.slice.call(arguments,1).forEach(function(n){if(n){if(typeof n!="object")throw new TypeError(n+"must be object");Object.keys(n).forEach(function(r){e[r]=n[r]})}}),e}function eX(e,t,n){return[].concat(e.slice(0,t),n,e.slice(t+1))}function kD(e){return!(e>=55296&&e<=57343||e>=64976&&e<=65007||(e&65535)===65535||(e&65535)===65534||e>=0&&e<=8||e===11||e>=14&&e<=31||e>=127&&e<=159||e>1114111)}function sk(e){if(e>65535){e-=65536;const t=55296+(e>>10),n=56320+(e&1023);return String.fromCharCode(t,n)}return String.fromCharCode(e)}const tX=/\\([!"#$%&'()*+,\-./:;<=>?@[\\\]^_`{|}~])/g,FRe=/&([a-z#][a-z0-9]{1,31});/gi,LRe=new RegExp(tX.source+"|"+FRe.source,"gi"),BRe=/^#((?:x[a-f0-9]{1,8}|[0-9]{1,8}))$/i;function $Re(e,t){if(t.charCodeAt(0)===35&&BRe.test(t)){const r=t[1].toLowerCase()==="x"?parseInt(t.slice(2),16):parseInt(t.slice(1),10);return kD(r)?sk(r):e}const n=QZ(e);return n!==e?n:e}function zRe(e){return e.indexOf("\\")<0?e:e.replace(tX,"$1")}function _y(e){return e.indexOf("\\")<0&&e.indexOf("&")<0?e:e.replace(LRe,function(t,n,r){return n||$Re(t,r)})}const URe=/[&<>"]/,qRe=/[&<>"]/g,VRe={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"};function WRe(e){return VRe[e]}function Nh(e){return URe.test(e)?e.replace(qRe,WRe):e}const HRe=/[.?*+^$[\]\\(){}|-]/g;function GRe(e){return e.replace(HRe,"\\$&")}function Fs(e){switch(e){case 9:case 32:return!0}return!1}function kw(e){if(e>=8192&&e<=8202)return!0;switch(e){case 9:case 10:case 11:case 12:case 13:case 32:case 160:case 5760:case 8239:case 8287:case 12288:return!0}return!1}function Ew(e){return SD.test(e)||ZZ.test(e)}function Tw(e){switch(e){case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:case 41:case 42:case 43:case 44:case 45:case 46:case 47:case 58:case 59:case 60:case 61:case 62:case 63:case 64:case 91:case 92:case 93:case 94:case 95:case 96:case 123:case 124:case 125:case 126:return!0;default:return!1}}function dT(e){return e=e.trim().replace(/\s+/g," "),"".toLowerCase()===""&&(e=e.replace(//g,"")),e.toLowerCase().toUpperCase()}const KRe={mdurl:vRe,ucmicro:wRe},YRe=Object.freeze(Object.defineProperty({__proto__:null,arrayReplaceAt:eX,assign:uT,escapeHtml:Nh,escapeRE:GRe,fromCodePoint:sk,has:DRe,isMdAsciiPunct:Tw,isPunctChar:Ew,isSpace:Fs,isString:CD,isValidEntityCode:kD,isWhiteSpace:kw,lib:KRe,normalizeReference:dT,unescapeAll:_y,unescapeMd:zRe},Symbol.toStringTag,{value:"Module"}));function ZRe(e,t,n){let r,s,i,a;const o=e.posMax,l=e.pos;for(e.pos=t+1,r=1;e.pos<o;){if(i=e.src.charCodeAt(e.pos),i===93&&(r--,r===0)){s=!0;break}if(a=e.pos,e.md.inline.skipToken(e),i===91){if(a===e.pos-1)r++;else if(n)return e.pos=l,-1}}let c=-1;return s&&(c=e.pos),e.pos=l,c}function XRe(e,t,n){let r,s=t;const i={ok:!1,pos:0,str:""};if(e.charCodeAt(s)===60){for(s++;s<n;){if(r=e.charCodeAt(s),r===10||r===60)return i;if(r===62)return i.pos=s+1,i.str=_y(e.slice(t+1,s)),i.ok=!0,i;if(r===92&&s+1<n){s+=2;continue}s++}return i}let a=0;for(;s<n&&(r=e.charCodeAt(s),!(r===32||r<32||r===127));){if(r===92&&s+1<n){if(e.charCodeAt(s+1)===32)break;s+=2;continue}if(r===40&&(a++,a>32))return i;if(r===41){if(a===0)break;a--}s++}return t===s||a!==0||(i.str=_y(e.slice(t,s)),i.pos=s,i.ok=!0),i}function JRe(e,t,n,r){let s,i=t;const a={ok:!1,can_continue:!1,pos:0,str:"",marker:0};if(r)a.str=r.str,a.marker=r.marker;else{if(i>=n)return a;let o=e.charCodeAt(i);if(o!==34&&o!==39&&o!==40)return a;t++,i++,o===40&&(o=41),a.marker=o}for(;i<n;){if(s=e.charCodeAt(i),s===a.marker)return a.pos=i+1,a.str+=_y(e.slice(t,i)),a.ok=!0,a;if(s===40&&a.marker===41)return a;s===92&&i+1<n&&i++,i++}return a.can_continue=!0,a.str+=_y(e.slice(t,i)),a}const QRe=Object.freeze(Object.defineProperty({__proto__:null,parseLinkDestination:XRe,parseLinkLabel:ZRe,parseLinkTitle:JRe},Symbol.toStringTag,{value:"Module"})),Uu={};Uu.code_inline=function(e,t,n,r,s){const i=e[t];return"<code"+s.renderAttrs(i)+">"+Nh(i.content)+"</code>"};Uu.code_block=function(e,t,n,r,s){const i=e[t];return"<pre"+s.renderAttrs(i)+"><code>"+Nh(e[t].content)+`</code></pre>
`};Uu.fence=function(e,t,n,r,s){const i=e[t],a=i.info?_y(i.info).trim():"";let o="",l="";if(a){const u=a.split(/(\s+)/g);o=u[0],l=u.slice(2).join("")}let c;if(n.highlight?c=n.highlight(i.content,o,l)||Nh(i.content):c=Nh(i.content),c.indexOf("<pre")===0)return c+`
`;if(a){const u=i.attrIndex("class"),d=i.attrs?i.attrs.slice():[];u<0?d.push(["class",n.langPrefix+o]):(d[u]=d[u].slice(),d[u][1]+=" "+n.langPrefix+o);const h={attrs:d};return`<pre><code${s.renderAttrs(h)}>${c}</code></pre>
`}return`<pre><code${s.renderAttrs(i)}>${c}</code></pre>
`};Uu.image=function(e,t,n,r,s){const i=e[t];return i.attrs[i.attrIndex("alt")][1]=s.renderInlineAsText(i.children,n,r),s.renderToken(e,t,n)};Uu.hardbreak=function(e,t,n){return n.xhtmlOut?`<br />
`:`<br>
`};Uu.softbreak=function(e,t,n){return n.breaks?n.xhtmlOut?`<br />
`:`<br>
`:`
`};Uu.text=function(e,t){return Nh(e[t].content)};Uu.html_block=function(e,t){return e[t].content};Uu.html_inline=function(e,t){return e[t].content};function ub(){this.rules=uT({},Uu)}ub.prototype.renderAttrs=function(t){let n,r,s;if(!t.attrs)return"";for(s="",n=0,r=t.attrs.length;n<r;n++)s+=" "+Nh(t.attrs[n][0])+'="'+Nh(t.attrs[n][1])+'"';return s};ub.prototype.renderToken=function(t,n,r){const s=t[n];let i="";if(s.hidden)return"";s.block&&s.nesting!==-1&&n&&t[n-1].hidden&&(i+=`
`),i+=(s.nesting===-1?"</":"<")+s.tag,i+=this.renderAttrs(s),s.nesting===0&&r.xhtmlOut&&(i+=" /");let a=!1;if(s.block&&(a=!0,s.nesting===1&&n+1<t.length)){const o=t[n+1];(o.type==="inline"||o.hidden||o.nesting===-1&&o.tag===s.tag)&&(a=!1)}return i+=a?`>
`:">",i};ub.prototype.renderInline=function(e,t,n){let r="";const s=this.rules;for(let i=0,a=e.length;i<a;i++){const o=e[i].type;typeof s[o]<"u"?r+=s[o](e,i,t,n,this):r+=this.renderToken(e,i,t)}return r};ub.prototype.renderInlineAsText=function(e,t,n){let r="";for(let s=0,i=e.length;s<i;s++)switch(e[s].type){case"text":r+=e[s].content;break;case"image":r+=this.renderInlineAsText(e[s].children,t,n);break;case"html_inline":case"html_block":r+=e[s].content;break;case"softbreak":case"hardbreak":r+=`
`;break}return r};ub.prototype.render=function(e,t,n){let r="";const s=this.rules;for(let i=0,a=e.length;i<a;i++){const o=e[i].type;o==="inline"?r+=this.renderInline(e[i].children,t,n):typeof s[o]<"u"?r+=s[o](e,i,t,n,this):r+=this.renderToken(e,i,t,n)}return r};function Bo(){this.__rules__=[],this.__cache__=null}Bo.prototype.__find__=function(e){for(let t=0;t<this.__rules__.length;t++)if(this.__rules__[t].name===e)return t;return-1};Bo.prototype.__compile__=function(){const e=this,t=[""];e.__rules__.forEach(function(n){n.enabled&&n.alt.forEach(function(r){t.indexOf(r)<0&&t.push(r)})}),e.__cache__={},t.forEach(function(n){e.__cache__[n]=[],e.__rules__.forEach(function(r){r.enabled&&(n&&r.alt.indexOf(n)<0||e.__cache__[n].push(r.fn))})})};Bo.prototype.at=function(e,t,n){const r=this.__find__(e),s=n||{};if(r===-1)throw new Error("Parser rule not found: "+e);this.__rules__[r].fn=t,this.__rules__[r].alt=s.alt||[],this.__cache__=null};Bo.prototype.before=function(e,t,n,r){const s=this.__find__(e),i=r||{};if(s===-1)throw new Error("Parser rule not found: "+e);this.__rules__.splice(s,0,{name:t,enabled:!0,fn:n,alt:i.alt||[]}),this.__cache__=null};Bo.prototype.after=function(e,t,n,r){const s=this.__find__(e),i=r||{};if(s===-1)throw new Error("Parser rule not found: "+e);this.__rules__.splice(s+1,0,{name:t,enabled:!0,fn:n,alt:i.alt||[]}),this.__cache__=null};Bo.prototype.push=function(e,t,n){const r=n||{};this.__rules__.push({name:e,enabled:!0,fn:t,alt:r.alt||[]}),this.__cache__=null};Bo.prototype.enable=function(e,t){Array.isArray(e)||(e=[e]);const n=[];return e.forEach(function(r){const s=this.__find__(r);if(s<0){if(t)return;throw new Error("Rules manager: invalid rule name "+r)}this.__rules__[s].enabled=!0,n.push(r)},this),this.__cache__=null,n};Bo.prototype.enableOnly=function(e,t){Array.isArray(e)||(e=[e]),this.__rules__.forEach(function(n){n.enabled=!1}),this.enable(e,t)};Bo.prototype.disable=function(e,t){Array.isArray(e)||(e=[e]);const n=[];return e.forEach(function(r){const s=this.__find__(r);if(s<0){if(t)return;throw new Error("Rules manager: invalid rule name "+r)}this.__rules__[s].enabled=!1,n.push(r)},this),this.__cache__=null,n};Bo.prototype.getRules=function(e){return this.__cache__===null&&this.__compile__(),this.__cache__[e]||[]};function Vc(e,t,n){this.type=e,this.tag=t,this.attrs=null,this.map=null,this.nesting=n,this.level=0,this.children=null,this.content="",this.markup="",this.info="",this.meta=null,this.block=!1,this.hidden=!1}Vc.prototype.attrIndex=function(t){if(!this.attrs)return-1;const n=this.attrs;for(let r=0,s=n.length;r<s;r++)if(n[r][0]===t)return r;return-1};Vc.prototype.attrPush=function(t){this.attrs?this.attrs.push(t):this.attrs=[t]};Vc.prototype.attrSet=function(t,n){const r=this.attrIndex(t),s=[t,n];r<0?this.attrPush(s):this.attrs[r]=s};Vc.prototype.attrGet=function(t){const n=this.attrIndex(t);let r=null;return n>=0&&(r=this.attrs[n][1]),r};Vc.prototype.attrJoin=function(t,n){const r=this.attrIndex(t);r<0?this.attrPush([t,n]):this.attrs[r][1]=this.attrs[r][1]+" "+n};function nX(e,t,n){this.src=e,this.env=n,this.tokens=[],this.inlineMode=!1,this.md=t}nX.prototype.Token=Vc;const eNe=/\r\n?|\n/g,tNe=/\0/g;function nNe(e){let t;t=e.src.replace(eNe,`
`),t=t.replace(tNe,""),e.src=t}function rNe(e){let t;e.inlineMode?(t=new e.Token("inline","",0),t.content=e.src,t.map=[0,1],t.children=[],e.tokens.push(t)):e.md.block.parse(e.src,e.md,e.env,e.tokens)}function sNe(e){const t=e.tokens;for(let n=0,r=t.length;n<r;n++){const s=t[n];s.type==="inline"&&e.md.inline.parse(s.content,e.md,e.env,s.children)}}function iNe(e){return/^<a[>\s]/i.test(e)}function aNe(e){return/^<\/a\s*>/i.test(e)}function oNe(e){const t=e.tokens;if(e.md.options.linkify)for(let n=0,r=t.length;n<r;n++){if(t[n].type!=="inline"||!e.md.linkify.pretest(t[n].content))continue;let s=t[n].children,i=0;for(let a=s.length-1;a>=0;a--){const o=s[a];if(o.type==="link_close"){for(a--;s[a].level!==o.level&&s[a].type!=="link_open";)a--;continue}if(o.type==="html_inline"&&(iNe(o.content)&&i>0&&i--,aNe(o.content)&&i++),!(i>0)&&o.type==="text"&&e.md.linkify.test(o.content)){const l=o.content;let c=e.md.linkify.match(l);const u=[];let d=o.level,h=0;c.length>0&&c[0].index===0&&a>0&&s[a-1].type==="text_special"&&(c=c.slice(1));for(let m=0;m<c.length;m++){const y=c[m].url,b=e.md.normalizeLink(y);if(!e.md.validateLink(b))continue;let v=c[m].text;c[m].schema?c[m].schema==="mailto:"&&!/^mailto:/i.test(v)?v=e.md.normalizeLinkText("mailto:"+v).replace(/^mailto:/,""):v=e.md.normalizeLinkText(v):v=e.md.normalizeLinkText("http://"+v).replace(/^http:\/\//,"");const x=c[m].index;if(x>h){const C=new e.Token("text","",0);C.content=l.slice(h,x),C.level=d,u.push(C)}const w=new e.Token("link_open","a",1);w.attrs=[["href",b]],w.level=d++,w.markup="linkify",w.info="auto",u.push(w);const S=new e.Token("text","",0);S.content=v,S.level=d,u.push(S);const k=new e.Token("link_close","a",-1);k.level=--d,k.markup="linkify",k.info="auto",u.push(k),h=c[m].lastIndex}if(h<l.length){const m=new e.Token("text","",0);m.content=l.slice(h),m.level=d,u.push(m)}t[n].children=s=eX(s,a,u)}}}}const rX=/\+-|\.\.|\?\?\?\?|!!!!|,,|--/,lNe=/\((c|tm|r)\)/i,cNe=/\((c|tm|r)\)/ig,uNe={c:"",r:"",tm:""};function dNe(e,t){return uNe[t.toLowerCase()]}function fNe(e){let t=0;for(let n=e.length-1;n>=0;n--){const r=e[n];r.type==="text"&&!t&&(r.content=r.content.replace(cNe,dNe)),r.type==="link_open"&&r.info==="auto"&&t--,r.type==="link_close"&&r.info==="auto"&&t++}}function hNe(e){let t=0;for(let n=e.length-1;n>=0;n--){const r=e[n];r.type==="text"&&!t&&rX.test(r.content)&&(r.content=r.content.replace(/\+-/g,"").replace(/\.{2,}/g,"").replace(/([?!])/g,"$1..").replace(/([?!]){4,}/g,"$1$1$1").replace(/,{2,}/g,",").replace(/(^|[^-])---(?=[^-]|$)/mg,"$1").replace(/(^|\s)--(?=\s|$)/mg,"$1").replace(/(^|[^-\s])--(?=[^-\s]|$)/mg,"$1")),r.type==="link_open"&&r.info==="auto"&&t--,r.type==="link_close"&&r.info==="auto"&&t++}}function pNe(e){let t;if(e.md.options.typographer)for(t=e.tokens.length-1;t>=0;t--)e.tokens[t].type==="inline"&&(lNe.test(e.tokens[t].content)&&fNe(e.tokens[t].children),rX.test(e.tokens[t].content)&&hNe(e.tokens[t].children))}const mNe=/['"]/,qz=/['"]/g,Vz="";function HS(e,t,n){return e.slice(0,t)+n+e.slice(t+1)}function gNe(e,t){let n;const r=[];for(let s=0;s<e.length;s++){const i=e[s],a=e[s].level;for(n=r.length-1;n>=0&&!(r[n].level<=a);n--);if(r.length=n+1,i.type!=="text")continue;let o=i.content,l=0,c=o.length;e:for(;l<c;){qz.lastIndex=l;const u=qz.exec(o);if(!u)break;let d=!0,h=!0;l=u.index+1;const m=u[0]==="'";let y=32;if(u.index-1>=0)y=o.charCodeAt(u.index-1);else for(n=s-1;n>=0&&!(e[n].type==="softbreak"||e[n].type==="hardbreak");n--)if(e[n].content){y=e[n].content.charCodeAt(e[n].content.length-1);break}let b=32;if(l<c)b=o.charCodeAt(l);else for(n=s+1;n<e.length&&!(e[n].type==="softbreak"||e[n].type==="hardbreak");n++)if(e[n].content){b=e[n].content.charCodeAt(0);break}const v=Tw(y)||Ew(String.fromCharCode(y)),x=Tw(b)||Ew(String.fromCharCode(b)),w=kw(y),S=kw(b);if(S?d=!1:x&&(w||v||(d=!1)),w?h=!1:v&&(S||x||(h=!1)),b===34&&u[0]==='"'&&y>=48&&y<=57&&(h=d=!1),d&&h&&(d=v,h=x),!d&&!h){m&&(i.content=HS(i.content,u.index,Vz));continue}if(h)for(n=r.length-1;n>=0;n--){let k=r[n];if(r[n].level<a)break;if(k.single===m&&r[n].level===a){k=r[n];let C,T;m?(C=t.md.options.quotes[2],T=t.md.options.quotes[3]):(C=t.md.options.quotes[0],T=t.md.options.quotes[1]),i.content=HS(i.content,u.index,T),e[k.token].content=HS(e[k.token].content,k.pos,C),l+=T.length-1,k.token===s&&(l+=C.length-1),o=i.content,c=o.length,r.length=n;continue e}}d?r.push({token:s,pos:u.index,single:m,level:a}):h&&m&&(i.content=HS(i.content,u.index,Vz))}}}function yNe(e){if(e.md.options.typographer)for(let t=e.tokens.length-1;t>=0;t--)e.tokens[t].type!=="inline"||!mNe.test(e.tokens[t].content)||gNe(e.tokens[t].children,e)}function bNe(e){let t,n;const r=e.tokens,s=r.length;for(let i=0;i<s;i++){if(r[i].type!=="inline")continue;const a=r[i].children,o=a.length;for(t=0;t<o;t++)a[t].type==="text_special"&&(a[t].type="text");for(t=n=0;t<o;t++)a[t].type==="text"&&t+1<o&&a[t+1].type==="text"?a[t+1].content=a[t].content+a[t+1].content:(t!==n&&(a[n]=a[t]),n++);t!==n&&(a.length=n)}}const mI=[["normalize",nNe],["block",rNe],["inline",sNe],["linkify",oNe],["replacements",pNe],["smartquotes",yNe],["text_join",bNe]];function ED(){this.ruler=new Bo;for(let e=0;e<mI.length;e++)this.ruler.push(mI[e][0],mI[e][1])}ED.prototype.process=function(e){const t=this.ruler.getRules("");for(let n=0,r=t.length;n<r;n++)t[n](e)};ED.prototype.State=nX;function qu(e,t,n,r){this.src=e,this.md=t,this.env=n,this.tokens=r,this.bMarks=[],this.eMarks=[],this.tShift=[],this.sCount=[],this.bsCount=[],this.blkIndent=0,this.line=0,this.lineMax=0,this.tight=!1,this.ddIndent=-1,this.listIndent=-1,this.parentType="root",this.level=0;const s=this.src;for(let i=0,a=0,o=0,l=0,c=s.length,u=!1;a<c;a++){const d=s.charCodeAt(a);if(!u)if(Fs(d)){o++,d===9?l+=4-l%4:l++;continue}else u=!0;(d===10||a===c-1)&&(d!==10&&a++,this.bMarks.push(i),this.eMarks.push(a),this.tShift.push(o),this.sCount.push(l),this.bsCount.push(0),u=!1,o=0,l=0,i=a+1)}this.bMarks.push(s.length),this.eMarks.push(s.length),this.tShift.push(0),this.sCount.push(0),this.bsCount.push(0),this.lineMax=this.bMarks.length-1}qu.prototype.push=function(e,t,n){const r=new Vc(e,t,n);return r.block=!0,n<0&&this.level--,r.level=this.level,n>0&&this.level++,this.tokens.push(r),r};qu.prototype.isEmpty=function(t){return this.bMarks[t]+this.tShift[t]>=this.eMarks[t]};qu.prototype.skipEmptyLines=function(t){for(let n=this.lineMax;t<n&&!(this.bMarks[t]+this.tShift[t]<this.eMarks[t]);t++);return t};qu.prototype.skipSpaces=function(t){for(let n=this.src.length;t<n;t++){const r=this.src.charCodeAt(t);if(!Fs(r))break}return t};qu.prototype.skipSpacesBack=function(t,n){if(t<=n)return t;for(;t>n;)if(!Fs(this.src.charCodeAt(--t)))return t+1;return t};qu.prototype.skipChars=function(t,n){for(let r=this.src.length;t<r&&this.src.charCodeAt(t)===n;t++);return t};qu.prototype.skipCharsBack=function(t,n,r){if(t<=r)return t;for(;t>r;)if(n!==this.src.charCodeAt(--t))return t+1;return t};qu.prototype.getLines=function(t,n,r,s){if(t>=n)return"";const i=new Array(n-t);for(let a=0,o=t;o<n;o++,a++){let l=0;const c=this.bMarks[o];let u=c,d;for(o+1<n||s?d=this.eMarks[o]+1:d=this.eMarks[o];u<d&&l<r;){const h=this.src.charCodeAt(u);if(Fs(h))h===9?l+=4-(l+this.bsCount[o])%4:l++;else if(u-c<this.tShift[o])l++;else break;u++}l>r?i[a]=new Array(l-r+1).join(" ")+this.src.slice(u,d):i[a]=this.src.slice(u,d)}return i.join("")};qu.prototype.Token=Vc;const vNe=65536;function gI(e,t){const n=e.bMarks[t]+e.tShift[t],r=e.eMarks[t];return e.src.slice(n,r)}function Wz(e){const t=[],n=e.length;let r=0,s=e.charCodeAt(r),i=!1,a=0,o="";for(;r<n;)s===124&&(i?(o+=e.substring(a,r-1),a=r):(t.push(o+e.substring(a,r)),o="",a=r+1)),i=s===92,r++,s=e.charCodeAt(r);return t.push(o+e.substring(a)),t}function xNe(e,t,n,r){if(t+2>n)return!1;let s=t+1;if(e.sCount[s]<e.blkIndent||e.sCount[s]-e.blkIndent>=4)return!1;let i=e.bMarks[s]+e.tShift[s];if(i>=e.eMarks[s])return!1;const a=e.src.charCodeAt(i++);if(a!==124&&a!==45&&a!==58||i>=e.eMarks[s])return!1;const o=e.src.charCodeAt(i++);if(o!==124&&o!==45&&o!==58&&!Fs(o)||a===45&&Fs(o))return!1;for(;i<e.eMarks[s];){const k=e.src.charCodeAt(i);if(k!==124&&k!==45&&k!==58&&!Fs(k))return!1;i++}let l=gI(e,t+1),c=l.split("|");const u=[];for(let k=0;k<c.length;k++){const C=c[k].trim();if(!C){if(k===0||k===c.length-1)continue;return!1}if(!/^:?-+:?$/.test(C))return!1;C.charCodeAt(C.length-1)===58?u.push(C.charCodeAt(0)===58?"center":"right"):C.charCodeAt(0)===58?u.push("left"):u.push("")}if(l=gI(e,t).trim(),l.indexOf("|")===-1||e.sCount[t]-e.blkIndent>=4)return!1;c=Wz(l),c.length&&c[0]===""&&c.shift(),c.length&&c[c.length-1]===""&&c.pop();const d=c.length;if(d===0||d!==u.length)return!1;if(r)return!0;const h=e.parentType;e.parentType="table";const m=e.md.block.ruler.getRules("blockquote"),y=e.push("table_open","table",1),b=[t,0];y.map=b;const v=e.push("thead_open","thead",1);v.map=[t,t+1];const x=e.push("tr_open","tr",1);x.map=[t,t+1];for(let k=0;k<c.length;k++){const C=e.push("th_open","th",1);u[k]&&(C.attrs=[["style","text-align:"+u[k]]]);const T=e.push("inline","",0);T.content=c[k].trim(),T.children=[],e.push("th_close","th",-1)}e.push("tr_close","tr",-1),e.push("thead_close","thead",-1);let w,S=0;for(s=t+2;s<n&&!(e.sCount[s]<e.blkIndent);s++){let k=!1;for(let T=0,R=m.length;T<R;T++)if(m[T](e,s,n,!0)){k=!0;break}if(k||(l=gI(e,s).trim(),!l)||e.sCount[s]-e.blkIndent>=4||(c=Wz(l),c.length&&c[0]===""&&c.shift(),c.length&&c[c.length-1]===""&&c.pop(),S+=d-c.length,S>vNe))break;if(s===t+2){const T=e.push("tbody_open","tbody",1);T.map=w=[t+2,0]}const C=e.push("tr_open","tr",1);C.map=[s,s+1];for(let T=0;T<d;T++){const R=e.push("td_open","td",1);u[T]&&(R.attrs=[["style","text-align:"+u[T]]]);const N=e.push("inline","",0);N.content=c[T]?c[T].trim():"",N.children=[],e.push("td_close","td",-1)}e.push("tr_close","tr",-1)}return w&&(e.push("tbody_close","tbody",-1),w[1]=s),e.push("table_close","table",-1),b[1]=s,e.parentType=h,e.line=s,!0}function wNe(e,t,n){if(e.sCount[t]-e.blkIndent<4)return!1;let r=t+1,s=r;for(;r<n;){if(e.isEmpty(r)){r++;continue}if(e.sCount[r]-e.blkIndent>=4){r++,s=r;continue}break}e.line=s;const i=e.push("code_block","code",0);return i.content=e.getLines(t,s,4+e.blkIndent,!1)+`
`,i.map=[t,e.line],!0}function _Ne(e,t,n,r){let s=e.bMarks[t]+e.tShift[t],i=e.eMarks[t];if(e.sCount[t]-e.blkIndent>=4||s+3>i)return!1;const a=e.src.charCodeAt(s);if(a!==126&&a!==96)return!1;let o=s;s=e.skipChars(s,a);let l=s-o;if(l<3)return!1;const c=e.src.slice(o,s),u=e.src.slice(s,i);if(a===96&&u.indexOf(String.fromCharCode(a))>=0)return!1;if(r)return!0;let d=t,h=!1;for(;d++,!(d>=n||(s=o=e.bMarks[d]+e.tShift[d],i=e.eMarks[d],s<i&&e.sCount[d]<e.blkIndent));)if(e.src.charCodeAt(s)===a&&!(e.sCount[d]-e.blkIndent>=4)&&(s=e.skipChars(s,a),!(s-o<l)&&(s=e.skipSpaces(s),!(s<i)))){h=!0;break}l=e.sCount[t],e.line=d+(h?1:0);const m=e.push("fence","code",0);return m.info=u,m.content=e.getLines(t+1,d,l,!0),m.markup=c,m.map=[t,e.line],!0}function SNe(e,t,n,r){let s=e.bMarks[t]+e.tShift[t],i=e.eMarks[t];const a=e.lineMax;if(e.sCount[t]-e.blkIndent>=4||e.src.charCodeAt(s)!==62)return!1;if(r)return!0;const o=[],l=[],c=[],u=[],d=e.md.block.ruler.getRules("blockquote"),h=e.parentType;e.parentType="blockquote";let m=!1,y;for(y=t;y<n;y++){const S=e.sCount[y]<e.blkIndent;if(s=e.bMarks[y]+e.tShift[y],i=e.eMarks[y],s>=i)break;if(e.src.charCodeAt(s++)===62&&!S){let C=e.sCount[y]+1,T,R;e.src.charCodeAt(s)===32?(s++,C++,R=!1,T=!0):e.src.charCodeAt(s)===9?(T=!0,(e.bsCount[y]+C)%4===3?(s++,C++,R=!1):R=!0):T=!1;let N=C;for(o.push(e.bMarks[y]),e.bMarks[y]=s;s<i;){const I=e.src.charCodeAt(s);if(Fs(I))I===9?N+=4-(N+e.bsCount[y]+(R?1:0))%4:N++;else break;s++}m=s>=i,l.push(e.bsCount[y]),e.bsCount[y]=e.sCount[y]+1+(T?1:0),c.push(e.sCount[y]),e.sCount[y]=N-C,u.push(e.tShift[y]),e.tShift[y]=s-e.bMarks[y];continue}if(m)break;let k=!1;for(let C=0,T=d.length;C<T;C++)if(d[C](e,y,n,!0)){k=!0;break}if(k){e.lineMax=y,e.blkIndent!==0&&(o.push(e.bMarks[y]),l.push(e.bsCount[y]),u.push(e.tShift[y]),c.push(e.sCount[y]),e.sCount[y]-=e.blkIndent);break}o.push(e.bMarks[y]),l.push(e.bsCount[y]),u.push(e.tShift[y]),c.push(e.sCount[y]),e.sCount[y]=-1}const b=e.blkIndent;e.blkIndent=0;const v=e.push("blockquote_open","blockquote",1);v.markup=">";const x=[t,0];v.map=x,e.md.block.tokenize(e,t,y);const w=e.push("blockquote_close","blockquote",-1);w.markup=">",e.lineMax=a,e.parentType=h,x[1]=e.line;for(let S=0;S<u.length;S++)e.bMarks[S+t]=o[S],e.tShift[S+t]=u[S],e.sCount[S+t]=c[S],e.bsCount[S+t]=l[S];return e.blkIndent=b,!0}function CNe(e,t,n,r){const s=e.eMarks[t];if(e.sCount[t]-e.blkIndent>=4)return!1;let i=e.bMarks[t]+e.tShift[t];const a=e.src.charCodeAt(i++);if(a!==42&&a!==45&&a!==95)return!1;let o=1;for(;i<s;){const c=e.src.charCodeAt(i++);if(c!==a&&!Fs(c))return!1;c===a&&o++}if(o<3)return!1;if(r)return!0;e.line=t+1;const l=e.push("hr","hr",0);return l.map=[t,e.line],l.markup=Array(o+1).join(String.fromCharCode(a)),!0}function Hz(e,t){const n=e.eMarks[t];let r=e.bMarks[t]+e.tShift[t];const s=e.src.charCodeAt(r++);if(s!==42&&s!==45&&s!==43)return-1;if(r<n){const i=e.src.charCodeAt(r);if(!Fs(i))return-1}return r}function Gz(e,t){const n=e.bMarks[t]+e.tShift[t],r=e.eMarks[t];let s=n;if(s+1>=r)return-1;let i=e.src.charCodeAt(s++);if(i<48||i>57)return-1;for(;;){if(s>=r)return-1;if(i=e.src.charCodeAt(s++),i>=48&&i<=57){if(s-n>=10)return-1;continue}if(i===41||i===46)break;return-1}return s<r&&(i=e.src.charCodeAt(s),!Fs(i))?-1:s}function kNe(e,t){const n=e.level+2;for(let r=t+2,s=e.tokens.length-2;r<s;r++)e.tokens[r].level===n&&e.tokens[r].type==="paragraph_open"&&(e.tokens[r+2].hidden=!0,e.tokens[r].hidden=!0,r+=2)}function ENe(e,t,n,r){let s,i,a,o,l=t,c=!0;if(e.sCount[l]-e.blkIndent>=4||e.listIndent>=0&&e.sCount[l]-e.listIndent>=4&&e.sCount[l]<e.blkIndent)return!1;let u=!1;r&&e.parentType==="paragraph"&&e.sCount[l]>=e.blkIndent&&(u=!0);let d,h,m;if((m=Gz(e,l))>=0){if(d=!0,a=e.bMarks[l]+e.tShift[l],h=Number(e.src.slice(a,m-1)),u&&h!==1)return!1}else if((m=Hz(e,l))>=0)d=!1;else return!1;if(u&&e.skipSpaces(m)>=e.eMarks[l])return!1;if(r)return!0;const y=e.src.charCodeAt(m-1),b=e.tokens.length;d?(o=e.push("ordered_list_open","ol",1),h!==1&&(o.attrs=[["start",h]])):o=e.push("bullet_list_open","ul",1);const v=[l,0];o.map=v,o.markup=String.fromCharCode(y);let x=!1;const w=e.md.block.ruler.getRules("list"),S=e.parentType;for(e.parentType="list";l<n;){i=m,s=e.eMarks[l];const k=e.sCount[l]+m-(e.bMarks[l]+e.tShift[l]);let C=k;for(;i<s;){const Z=e.src.charCodeAt(i);if(Z===9)C+=4-(C+e.bsCount[l])%4;else if(Z===32)C++;else break;i++}const T=i;let R;T>=s?R=1:R=C-k,R>4&&(R=1);const N=k+R;o=e.push("list_item_open","li",1),o.markup=String.fromCharCode(y);const I=[l,0];o.map=I,d&&(o.info=e.src.slice(a,m-1));const P=e.tight,B=e.tShift[l],D=e.sCount[l],W=e.listIndent;if(e.listIndent=e.blkIndent,e.blkIndent=N,e.tight=!0,e.tShift[l]=T-e.bMarks[l],e.sCount[l]=C,T>=s&&e.isEmpty(l+1)?e.line=Math.min(e.line+2,n):e.md.block.tokenize(e,l,n,!0),(!e.tight||x)&&(c=!1),x=e.line-l>1&&e.isEmpty(e.line-1),e.blkIndent=e.listIndent,e.listIndent=W,e.tShift[l]=B,e.sCount[l]=D,e.tight=P,o=e.push("list_item_close","li",-1),o.markup=String.fromCharCode(y),l=e.line,I[1]=l,l>=n||e.sCount[l]<e.blkIndent||e.sCount[l]-e.blkIndent>=4)break;let O=!1;for(let Z=0,U=w.length;Z<U;Z++)if(w[Z](e,l,n,!0)){O=!0;break}if(O)break;if(d){if(m=Gz(e,l),m<0)break;a=e.bMarks[l]+e.tShift[l]}else if(m=Hz(e,l),m<0)break;if(y!==e.src.charCodeAt(m-1))break}return d?o=e.push("ordered_list_close","ol",-1):o=e.push("bullet_list_close","ul",-1),o.markup=String.fromCharCode(y),v[1]=l,e.line=l,e.parentType=S,c&&kNe(e,b),!0}function TNe(e,t,n,r){let s=e.bMarks[t]+e.tShift[t],i=e.eMarks[t],a=t+1;if(e.sCount[t]-e.blkIndent>=4||e.src.charCodeAt(s)!==91)return!1;function o(w){const S=e.lineMax;if(w>=S||e.isEmpty(w))return null;let k=!1;if(e.sCount[w]-e.blkIndent>3&&(k=!0),e.sCount[w]<0&&(k=!0),!k){const R=e.md.block.ruler.getRules("reference"),N=e.parentType;e.parentType="reference";let I=!1;for(let P=0,B=R.length;P<B;P++)if(R[P](e,w,S,!0)){I=!0;break}if(e.parentType=N,I)return null}const C=e.bMarks[w]+e.tShift[w],T=e.eMarks[w];return e.src.slice(C,T+1)}let l=e.src.slice(s,i+1);i=l.length;let c=-1;for(s=1;s<i;s++){const w=l.charCodeAt(s);if(w===91)return!1;if(w===93){c=s;break}else if(w===10){const S=o(a);S!==null&&(l+=S,i=l.length,a++)}else if(w===92&&(s++,s<i&&l.charCodeAt(s)===10)){const S=o(a);S!==null&&(l+=S,i=l.length,a++)}}if(c<0||l.charCodeAt(c+1)!==58)return!1;for(s=c+2;s<i;s++){const w=l.charCodeAt(s);if(w===10){const S=o(a);S!==null&&(l+=S,i=l.length,a++)}else if(!Fs(w))break}const u=e.md.helpers.parseLinkDestination(l,s,i);if(!u.ok)return!1;const d=e.md.normalizeLink(u.str);if(!e.md.validateLink(d))return!1;s=u.pos;const h=s,m=a,y=s;for(;s<i;s++){const w=l.charCodeAt(s);if(w===10){const S=o(a);S!==null&&(l+=S,i=l.length,a++)}else if(!Fs(w))break}let b=e.md.helpers.parseLinkTitle(l,s,i);for(;b.can_continue;){const w=o(a);if(w===null)break;l+=w,s=i,i=l.length,a++,b=e.md.helpers.parseLinkTitle(l,s,i,b)}let v;for(s<i&&y!==s&&b.ok?(v=b.str,s=b.pos):(v="",s=h,a=m);s<i;){const w=l.charCodeAt(s);if(!Fs(w))break;s++}if(s<i&&l.charCodeAt(s)!==10&&v)for(v="",s=h,a=m;s<i;){const w=l.charCodeAt(s);if(!Fs(w))break;s++}if(s<i&&l.charCodeAt(s)!==10)return!1;const x=dT(l.slice(1,c));return x?(r||(typeof e.env.references>"u"&&(e.env.references={}),typeof e.env.references[x]>"u"&&(e.env.references[x]={title:v,href:d}),e.line=a),!0):!1}const ANe=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],RNe="[a-zA-Z_:][a-zA-Z0-9:._-]*",NNe="[^\"'=<>`\\x00-\\x20]+",MNe="'[^']*'",INe='"[^"]*"',jNe="(?:"+NNe+"|"+MNe+"|"+INe+")",ONe="(?:\\s+"+RNe+"(?:\\s*=\\s*"+jNe+")?)",sX="<[A-Za-z][A-Za-z0-9\\-]*"+ONe+"*\\s*\\/?>",iX="<\\/[A-Za-z][A-Za-z0-9\\-]*\\s*>",PNe="<!---?>|<!--(?:[^-]|-[^-]|--[^>])*-->",DNe="<[?][\\s\\S]*?[?]>",FNe="<![A-Za-z][^>]*>",LNe="<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",BNe=new RegExp("^(?:"+sX+"|"+iX+"|"+PNe+"|"+DNe+"|"+FNe+"|"+LNe+")"),$Ne=new RegExp("^(?:"+sX+"|"+iX+")"),n0=[[/^<(script|pre|style|textarea)(?=(\s|>|$))/i,/<\/(script|pre|style|textarea)>/i,!0],[/^<!--/,/-->/,!0],[/^<\?/,/\?>/,!0],[/^<![A-Z]/,/>/,!0],[/^<!\[CDATA\[/,/\]\]>/,!0],[new RegExp("^</?("+ANe.join("|")+")(?=(\\s|/?>|$))","i"),/^$/,!0],[new RegExp($Ne.source+"\\s*$"),/^$/,!1]];function zNe(e,t,n,r){let s=e.bMarks[t]+e.tShift[t],i=e.eMarks[t];if(e.sCount[t]-e.blkIndent>=4||!e.md.options.html||e.src.charCodeAt(s)!==60)return!1;let a=e.src.slice(s,i),o=0;for(;o<n0.length&&!n0[o][0].test(a);o++);if(o===n0.length)return!1;if(r)return n0[o][2];let l=t+1;if(!n0[o][1].test(a)){for(;l<n&&!(e.sCount[l]<e.blkIndent);l++)if(s=e.bMarks[l]+e.tShift[l],i=e.eMarks[l],a=e.src.slice(s,i),n0[o][1].test(a)){a.length!==0&&l++;break}}e.line=l;const c=e.push("html_block","",0);return c.map=[t,l],c.content=e.getLines(t,l,e.blkIndent,!0),!0}function UNe(e,t,n,r){let s=e.bMarks[t]+e.tShift[t],i=e.eMarks[t];if(e.sCount[t]-e.blkIndent>=4)return!1;let a=e.src.charCodeAt(s);if(a!==35||s>=i)return!1;let o=1;for(a=e.src.charCodeAt(++s);a===35&&s<i&&o<=6;)o++,a=e.src.charCodeAt(++s);if(o>6||s<i&&!Fs(a))return!1;if(r)return!0;i=e.skipSpacesBack(i,s);const l=e.skipCharsBack(i,35,s);l>s&&Fs(e.src.charCodeAt(l-1))&&(i=l),e.line=t+1;const c=e.push("heading_open","h"+String(o),1);c.markup="########".slice(0,o),c.map=[t,e.line];const u=e.push("inline","",0);u.content=e.src.slice(s,i).trim(),u.map=[t,e.line],u.children=[];const d=e.push("heading_close","h"+String(o),-1);return d.markup="########".slice(0,o),!0}function qNe(e,t,n){const r=e.md.block.ruler.getRules("paragraph");if(e.sCount[t]-e.blkIndent>=4)return!1;const s=e.parentType;e.parentType="paragraph";let i=0,a,o=t+1;for(;o<n&&!e.isEmpty(o);o++){if(e.sCount[o]-e.blkIndent>3)continue;if(e.sCount[o]>=e.blkIndent){let m=e.bMarks[o]+e.tShift[o];const y=e.eMarks[o];if(m<y&&(a=e.src.charCodeAt(m),(a===45||a===61)&&(m=e.skipChars(m,a),m=e.skipSpaces(m),m>=y))){i=a===61?1:2;break}}if(e.sCount[o]<0)continue;let h=!1;for(let m=0,y=r.length;m<y;m++)if(r[m](e,o,n,!0)){h=!0;break}if(h)break}if(!i)return!1;const l=e.getLines(t,o,e.blkIndent,!1).trim();e.line=o+1;const c=e.push("heading_open","h"+String(i),1);c.markup=String.fromCharCode(a),c.map=[t,e.line];const u=e.push("inline","",0);u.content=l,u.map=[t,e.line-1],u.children=[];const d=e.push("heading_close","h"+String(i),-1);return d.markup=String.fromCharCode(a),e.parentType=s,!0}function VNe(e,t,n){const r=e.md.block.ruler.getRules("paragraph"),s=e.parentType;let i=t+1;for(e.parentType="paragraph";i<n&&!e.isEmpty(i);i++){if(e.sCount[i]-e.blkIndent>3||e.sCount[i]<0)continue;let c=!1;for(let u=0,d=r.length;u<d;u++)if(r[u](e,i,n,!0)){c=!0;break}if(c)break}const a=e.getLines(t,i,e.blkIndent,!1).trim();e.line=i;const o=e.push("paragraph_open","p",1);o.map=[t,e.line];const l=e.push("inline","",0);return l.content=a,l.map=[t,e.line],l.children=[],e.push("paragraph_close","p",-1),e.parentType=s,!0}const GS=[["table",xNe,["paragraph","reference"]],["code",wNe],["fence",_Ne,["paragraph","reference","blockquote","list"]],["blockquote",SNe,["paragraph","reference","blockquote","list"]],["hr",CNe,["paragraph","reference","blockquote","list"]],["list",ENe,["paragraph","reference","blockquote"]],["reference",TNe],["html_block",zNe,["paragraph","reference","blockquote"]],["heading",UNe,["paragraph","reference","blockquote"]],["lheading",qNe],["paragraph",VNe]];function fT(){this.ruler=new Bo;for(let e=0;e<GS.length;e++)this.ruler.push(GS[e][0],GS[e][1],{alt:(GS[e][2]||[]).slice()})}fT.prototype.tokenize=function(e,t,n){const r=this.ruler.getRules(""),s=r.length,i=e.md.options.maxNesting;let a=t,o=!1;for(;a<n&&(e.line=a=e.skipEmptyLines(a),!(a>=n||e.sCount[a]<e.blkIndent));){if(e.level>=i){e.line=n;break}const l=e.line;let c=!1;for(let u=0;u<s;u++)if(c=r[u](e,a,n,!1),c){if(l>=e.line)throw new Error("block rule didn't increment state.line");break}if(!c)throw new Error("none of the block rules matched");e.tight=!o,e.isEmpty(e.line-1)&&(o=!0),a=e.line,a<n&&e.isEmpty(a)&&(o=!0,a++,e.line=a)}};fT.prototype.parse=function(e,t,n,r){if(!e)return;const s=new this.State(e,t,n,r);this.tokenize(s,s.line,s.lineMax)};fT.prototype.State=qu;function H1(e,t,n,r){this.src=e,this.env=n,this.md=t,this.tokens=r,this.tokens_meta=Array(r.length),this.pos=0,this.posMax=this.src.length,this.level=0,this.pending="",this.pendingLevel=0,this.cache={},this.delimiters=[],this._prev_delimiters=[],this.backticks={},this.backticksScanned=!1,this.linkLevel=0}H1.prototype.pushPending=function(){const e=new Vc("text","",0);return e.content=this.pending,e.level=this.pendingLevel,this.tokens.push(e),this.pending="",e};H1.prototype.push=function(e,t,n){this.pending&&this.pushPending();const r=new Vc(e,t,n);let s=null;return n<0&&(this.level--,this.delimiters=this._prev_delimiters.pop()),r.level=this.level,n>0&&(this.level++,this._prev_delimiters.push(this.delimiters),this.delimiters=[],s={delimiters:this.delimiters}),this.pendingLevel=this.level,this.tokens.push(r),this.tokens_meta.push(s),r};H1.prototype.scanDelims=function(e,t){const n=this.posMax,r=this.src.charCodeAt(e),s=e>0?this.src.charCodeAt(e-1):32;let i=e;for(;i<n&&this.src.charCodeAt(i)===r;)i++;const a=i-e,o=i<n?this.src.charCodeAt(i):32,l=Tw(s)||Ew(String.fromCharCode(s)),c=Tw(o)||Ew(String.fromCharCode(o)),u=kw(s),d=kw(o),h=!d&&(!c||u||l),m=!u&&(!l||d||c);return{can_open:h&&(t||!m||l),can_close:m&&(t||!h||c),length:a}};H1.prototype.Token=Vc;function WNe(e){switch(e){case 10:case 33:case 35:case 36:case 37:case 38:case 42:case 43:case 45:case 58:case 60:case 61:case 62:case 64:case 91:case 92:case 93:case 94:case 95:case 96:case 123:case 125:case 126:return!0;default:return!1}}function HNe(e,t){let n=e.pos;for(;n<e.posMax&&!WNe(e.src.charCodeAt(n));)n++;return n===e.pos?!1:(t||(e.pending+=e.src.slice(e.pos,n)),e.pos=n,!0)}const GNe=/(?:^|[^a-z0-9.+-])([a-z][a-z0-9.+-]*)$/i;function KNe(e,t){if(!e.md.options.linkify||e.linkLevel>0)return!1;const n=e.pos,r=e.posMax;if(n+3>r||e.src.charCodeAt(n)!==58||e.src.charCodeAt(n+1)!==47||e.src.charCodeAt(n+2)!==47)return!1;const s=e.pending.match(GNe);if(!s)return!1;const i=s[1],a=e.md.linkify.matchAtStart(e.src.slice(n-i.length));if(!a)return!1;let o=a.url;if(o.length<=i.length)return!1;o=o.replace(/\*+$/,"");const l=e.md.normalizeLink(o);if(!e.md.validateLink(l))return!1;if(!t){e.pending=e.pending.slice(0,-i.length);const c=e.push("link_open","a",1);c.attrs=[["href",l]],c.markup="linkify",c.info="auto";const u=e.push("text","",0);u.content=e.md.normalizeLinkText(o);const d=e.push("link_close","a",-1);d.markup="linkify",d.info="auto"}return e.pos+=o.length-i.length,!0}function YNe(e,t){let n=e.pos;if(e.src.charCodeAt(n)!==10)return!1;const r=e.pending.length-1,s=e.posMax;if(!t)if(r>=0&&e.pending.charCodeAt(r)===32)if(r>=1&&e.pending.charCodeAt(r-1)===32){let i=r-1;for(;i>=1&&e.pending.charCodeAt(i-1)===32;)i--;e.pending=e.pending.slice(0,i),e.push("hardbreak","br",0)}else e.pending=e.pending.slice(0,-1),e.push("softbreak","br",0);else e.push("softbreak","br",0);for(n++;n<s&&Fs(e.src.charCodeAt(n));)n++;return e.pos=n,!0}const TD=[];for(let e=0;e<256;e++)TD.push(0);"\\!\"#$%&'()*+,./:;<=>?@[]^_`{|}~-".split("").forEach(function(e){TD[e.charCodeAt(0)]=1});function ZNe(e,t){let n=e.pos;const r=e.posMax;if(e.src.charCodeAt(n)!==92||(n++,n>=r))return!1;let s=e.src.charCodeAt(n);if(s===10){for(t||e.push("hardbreak","br",0),n++;n<r&&(s=e.src.charCodeAt(n),!!Fs(s));)n++;return e.pos=n,!0}let i=e.src[n];if(s>=55296&&s<=56319&&n+1<r){const o=e.src.charCodeAt(n+1);o>=56320&&o<=57343&&(i+=e.src[n+1],n++)}const a="\\"+i;if(!t){const o=e.push("text_special","",0);s<256&&TD[s]!==0?o.content=i:o.content=a,o.markup=a,o.info="escape"}return e.pos=n+1,!0}function XNe(e,t){let n=e.pos;if(e.src.charCodeAt(n)!==96)return!1;const s=n;n++;const i=e.posMax;for(;n<i&&e.src.charCodeAt(n)===96;)n++;const a=e.src.slice(s,n),o=a.length;if(e.backticksScanned&&(e.backticks[o]||0)<=s)return t||(e.pending+=a),e.pos+=o,!0;let l=n,c;for(;(c=e.src.indexOf("`",l))!==-1;){for(l=c+1;l<i&&e.src.charCodeAt(l)===96;)l++;const u=l-c;if(u===o){if(!t){const d=e.push("code_inline","code",0);d.markup=a,d.content=e.src.slice(n,c).replace(/\n/g," ").replace(/^ (.+) $/,"$1")}return e.pos=l,!0}e.backticks[u]=c}return e.backticksScanned=!0,t||(e.pending+=a),e.pos+=o,!0}function JNe(e,t){const n=e.pos,r=e.src.charCodeAt(n);if(t||r!==126)return!1;const s=e.scanDelims(e.pos,!0);let i=s.length;const a=String.fromCharCode(r);if(i<2)return!1;let o;i%2&&(o=e.push("text","",0),o.content=a,i--);for(let l=0;l<i;l+=2)o=e.push("text","",0),o.content=a+a,e.delimiters.push({marker:r,length:0,token:e.tokens.length-1,end:-1,open:s.can_open,close:s.can_close});return e.pos+=s.length,!0}function Kz(e,t){let n;const r=[],s=t.length;for(let i=0;i<s;i++){const a=t[i];if(a.marker!==126||a.end===-1)continue;const o=t[a.end];n=e.tokens[a.token],n.type="s_open",n.tag="s",n.nesting=1,n.markup="~~",n.content="",n=e.tokens[o.token],n.type="s_close",n.tag="s",n.nesting=-1,n.markup="~~",n.content="",e.tokens[o.token-1].type==="text"&&e.tokens[o.token-1].content==="~"&&r.push(o.token-1)}for(;r.length;){const i=r.pop();let a=i+1;for(;a<e.tokens.length&&e.tokens[a].type==="s_close";)a++;a--,i!==a&&(n=e.tokens[a],e.tokens[a]=e.tokens[i],e.tokens[i]=n)}}function QNe(e){const t=e.tokens_meta,n=e.tokens_meta.length;Kz(e,e.delimiters);for(let r=0;r<n;r++)t[r]&&t[r].delimiters&&Kz(e,t[r].delimiters)}const aX={tokenize:JNe,postProcess:QNe};function eMe(e,t){const n=e.pos,r=e.src.charCodeAt(n);if(t||r!==95&&r!==42)return!1;const s=e.scanDelims(e.pos,r===42);for(let i=0;i<s.length;i++){const a=e.push("text","",0);a.content=String.fromCharCode(r),e.delimiters.push({marker:r,length:s.length,token:e.tokens.length-1,end:-1,open:s.can_open,close:s.can_close})}return e.pos+=s.length,!0}function Yz(e,t){const n=t.length;for(let r=n-1;r>=0;r--){const s=t[r];if(s.marker!==95&&s.marker!==42||s.end===-1)continue;const i=t[s.end],a=r>0&&t[r-1].end===s.end+1&&t[r-1].marker===s.marker&&t[r-1].token===s.token-1&&t[s.end+1].token===i.token+1,o=String.fromCharCode(s.marker),l=e.tokens[s.token];l.type=a?"strong_open":"em_open",l.tag=a?"strong":"em",l.nesting=1,l.markup=a?o+o:o,l.content="";const c=e.tokens[i.token];c.type=a?"strong_close":"em_close",c.tag=a?"strong":"em",c.nesting=-1,c.markup=a?o+o:o,c.content="",a&&(e.tokens[t[r-1].token].content="",e.tokens[t[s.end+1].token].content="",r--)}}function tMe(e){const t=e.tokens_meta,n=e.tokens_meta.length;Yz(e,e.delimiters);for(let r=0;r<n;r++)t[r]&&t[r].delimiters&&Yz(e,t[r].delimiters)}const oX={tokenize:eMe,postProcess:tMe};function nMe(e,t){let n,r,s,i,a="",o="",l=e.pos,c=!0;if(e.src.charCodeAt(e.pos)!==91)return!1;const u=e.pos,d=e.posMax,h=e.pos+1,m=e.md.helpers.parseLinkLabel(e,e.pos,!0);if(m<0)return!1;let y=m+1;if(y<d&&e.src.charCodeAt(y)===40){for(c=!1,y++;y<d&&(n=e.src.charCodeAt(y),!(!Fs(n)&&n!==10));y++);if(y>=d)return!1;if(l=y,s=e.md.helpers.parseLinkDestination(e.src,y,e.posMax),s.ok){for(a=e.md.normalizeLink(s.str),e.md.validateLink(a)?y=s.pos:a="",l=y;y<d&&(n=e.src.charCodeAt(y),!(!Fs(n)&&n!==10));y++);if(s=e.md.helpers.parseLinkTitle(e.src,y,e.posMax),y<d&&l!==y&&s.ok)for(o=s.str,y=s.pos;y<d&&(n=e.src.charCodeAt(y),!(!Fs(n)&&n!==10));y++);}(y>=d||e.src.charCodeAt(y)!==41)&&(c=!0),y++}if(c){if(typeof e.env.references>"u")return!1;if(y<d&&e.src.charCodeAt(y)===91?(l=y+1,y=e.md.helpers.parseLinkLabel(e,y),y>=0?r=e.src.slice(l,y++):y=m+1):y=m+1,r||(r=e.src.slice(h,m)),i=e.env.references[dT(r)],!i)return e.pos=u,!1;a=i.href,o=i.title}if(!t){e.pos=h,e.posMax=m;const b=e.push("link_open","a",1),v=[["href",a]];b.attrs=v,o&&v.push(["title",o]),e.linkLevel++,e.md.inline.tokenize(e),e.linkLevel--,e.push("link_close","a",-1)}return e.pos=y,e.posMax=d,!0}function rMe(e,t){let n,r,s,i,a,o,l,c,u="";const d=e.pos,h=e.posMax;if(e.src.charCodeAt(e.pos)!==33||e.src.charCodeAt(e.pos+1)!==91)return!1;const m=e.pos+2,y=e.md.helpers.parseLinkLabel(e,e.pos+1,!1);if(y<0)return!1;if(i=y+1,i<h&&e.src.charCodeAt(i)===40){for(i++;i<h&&(n=e.src.charCodeAt(i),!(!Fs(n)&&n!==10));i++);if(i>=h)return!1;for(c=i,o=e.md.helpers.parseLinkDestination(e.src,i,e.posMax),o.ok&&(u=e.md.normalizeLink(o.str),e.md.validateLink(u)?i=o.pos:u=""),c=i;i<h&&(n=e.src.charCodeAt(i),!(!Fs(n)&&n!==10));i++);if(o=e.md.helpers.parseLinkTitle(e.src,i,e.posMax),i<h&&c!==i&&o.ok)for(l=o.str,i=o.pos;i<h&&(n=e.src.charCodeAt(i),!(!Fs(n)&&n!==10));i++);else l="";if(i>=h||e.src.charCodeAt(i)!==41)return e.pos=d,!1;i++}else{if(typeof e.env.references>"u")return!1;if(i<h&&e.src.charCodeAt(i)===91?(c=i+1,i=e.md.helpers.parseLinkLabel(e,i),i>=0?s=e.src.slice(c,i++):i=y+1):i=y+1,s||(s=e.src.slice(m,y)),a=e.env.references[dT(s)],!a)return e.pos=d,!1;u=a.href,l=a.title}if(!t){r=e.src.slice(m,y);const b=[];e.md.inline.parse(r,e.md,e.env,b);const v=e.push("image","img",0),x=[["src",u],["alt",""]];v.attrs=x,v.children=b,v.content=r,l&&x.push(["title",l])}return e.pos=i,e.posMax=h,!0}const sMe=/^([a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*)$/,iMe=/^([a-zA-Z][a-zA-Z0-9+.-]{1,31}):([^<>\x00-\x20]*)$/;function aMe(e,t){let n=e.pos;if(e.src.charCodeAt(n)!==60)return!1;const r=e.pos,s=e.posMax;for(;;){if(++n>=s)return!1;const a=e.src.charCodeAt(n);if(a===60)return!1;if(a===62)break}const i=e.src.slice(r+1,n);if(iMe.test(i)){const a=e.md.normalizeLink(i);if(!e.md.validateLink(a))return!1;if(!t){const o=e.push("link_open","a",1);o.attrs=[["href",a]],o.markup="autolink",o.info="auto";const l=e.push("text","",0);l.content=e.md.normalizeLinkText(i);const c=e.push("link_close","a",-1);c.markup="autolink",c.info="auto"}return e.pos+=i.length+2,!0}if(sMe.test(i)){const a=e.md.normalizeLink("mailto:"+i);if(!e.md.validateLink(a))return!1;if(!t){const o=e.push("link_open","a",1);o.attrs=[["href",a]],o.markup="autolink",o.info="auto";const l=e.push("text","",0);l.content=e.md.normalizeLinkText(i);const c=e.push("link_close","a",-1);c.markup="autolink",c.info="auto"}return e.pos+=i.length+2,!0}return!1}function oMe(e){return/^<a[>\s]/i.test(e)}function lMe(e){return/^<\/a\s*>/i.test(e)}function cMe(e){const t=e|32;return t>=97&&t<=122}function uMe(e,t){if(!e.md.options.html)return!1;const n=e.posMax,r=e.pos;if(e.src.charCodeAt(r)!==60||r+2>=n)return!1;const s=e.src.charCodeAt(r+1);if(s!==33&&s!==63&&s!==47&&!cMe(s))return!1;const i=e.src.slice(r).match(BNe);if(!i)return!1;if(!t){const a=e.push("html_inline","",0);a.content=i[0],oMe(a.content)&&e.linkLevel++,lMe(a.content)&&e.linkLevel--}return e.pos+=i[0].length,!0}const dMe=/^&#((?:x[a-f0-9]{1,6}|[0-9]{1,7}));/i,fMe=/^&([a-z][a-z0-9]{1,31});/i;function hMe(e,t){const n=e.pos,r=e.posMax;if(e.src.charCodeAt(n)!==38||n+1>=r)return!1;if(e.src.charCodeAt(n+1)===35){const i=e.src.slice(n).match(dMe);if(i){if(!t){const a=i[1][0].toLowerCase()==="x"?parseInt(i[1].slice(1),16):parseInt(i[1],10),o=e.push("text_special","",0);o.content=kD(a)?sk(a):sk(65533),o.markup=i[0],o.info="entity"}return e.pos+=i[0].length,!0}}else{const i=e.src.slice(n).match(fMe);if(i){const a=QZ(i[0]);if(a!==i[0]){if(!t){const o=e.push("text_special","",0);o.content=a,o.markup=i[0],o.info="entity"}return e.pos+=i[0].length,!0}}}return!1}function Zz(e){const t={},n=e.length;if(!n)return;let r=0,s=-2;const i=[];for(let a=0;a<n;a++){const o=e[a];if(i.push(0),(e[r].marker!==o.marker||s!==o.token-1)&&(r=a),s=o.token,o.length=o.length||0,!o.close)continue;t.hasOwnProperty(o.marker)||(t[o.marker]=[-1,-1,-1,-1,-1,-1]);const l=t[o.marker][(o.open?3:0)+o.length%3];let c=r-i[r]-1,u=c;for(;c>l;c-=i[c]+1){const d=e[c];if(d.marker===o.marker&&d.open&&d.end<0){let h=!1;if((d.close||o.open)&&(d.length+o.length)%3===0&&(d.length%3!==0||o.length%3!==0)&&(h=!0),!h){const m=c>0&&!e[c-1].open?i[c-1]+1:0;i[a]=a-c+m,i[c]=m,o.open=!1,d.end=a,d.close=!1,u=-1,s=-2;break}}}u!==-1&&(t[o.marker][(o.open?3:0)+(o.length||0)%3]=u)}}function pMe(e){const t=e.tokens_meta,n=e.tokens_meta.length;Zz(e.delimiters);for(let r=0;r<n;r++)t[r]&&t[r].delimiters&&Zz(t[r].delimiters)}function mMe(e){let t,n,r=0;const s=e.tokens,i=e.tokens.length;for(t=n=0;t<i;t++)s[t].nesting<0&&r--,s[t].level=r,s[t].nesting>0&&r++,s[t].type==="text"&&t+1<i&&s[t+1].type==="text"?s[t+1].content=s[t].content+s[t+1].content:(t!==n&&(s[n]=s[t]),n++);t!==n&&(s.length=n)}const yI=[["text",HNe],["linkify",KNe],["newline",YNe],["escape",ZNe],["backticks",XNe],["strikethrough",aX.tokenize],["emphasis",oX.tokenize],["link",nMe],["image",rMe],["autolink",aMe],["html_inline",uMe],["entity",hMe]],bI=[["balance_pairs",pMe],["strikethrough",aX.postProcess],["emphasis",oX.postProcess],["fragments_join",mMe]];function G1(){this.ruler=new Bo;for(let e=0;e<yI.length;e++)this.ruler.push(yI[e][0],yI[e][1]);this.ruler2=new Bo;for(let e=0;e<bI.length;e++)this.ruler2.push(bI[e][0],bI[e][1])}G1.prototype.skipToken=function(e){const t=e.pos,n=this.ruler.getRules(""),r=n.length,s=e.md.options.maxNesting,i=e.cache;if(typeof i[t]<"u"){e.pos=i[t];return}let a=!1;if(e.level<s){for(let o=0;o<r;o++)if(e.level++,a=n[o](e,!0),e.level--,a){if(t>=e.pos)throw new Error("inline rule didn't increment state.pos");break}}else e.pos=e.posMax;a||e.pos++,i[t]=e.pos};G1.prototype.tokenize=function(e){const t=this.ruler.getRules(""),n=t.length,r=e.posMax,s=e.md.options.maxNesting;for(;e.pos<r;){const i=e.pos;let a=!1;if(e.level<s){for(let o=0;o<n;o++)if(a=t[o](e,!1),a){if(i>=e.pos)throw new Error("inline rule didn't increment state.pos");break}}if(a){if(e.pos>=r)break;continue}e.pending+=e.src[e.pos++]}e.pending&&e.pushPending()};G1.prototype.parse=function(e,t,n,r){const s=new this.State(e,t,n,r);this.tokenize(s);const i=this.ruler2.getRules(""),a=i.length;for(let o=0;o<a;o++)i[o](s)};G1.prototype.State=H1;function gMe(e){const t={};e=e||{},t.src_Any=KZ.source,t.src_Cc=YZ.source,t.src_Z=XZ.source,t.src_P=SD.source,t.src_ZPCc=[t.src_Z,t.src_P,t.src_Cc].join("|"),t.src_ZCc=[t.src_Z,t.src_Cc].join("|");const n="[><]";return t.src_pseudo_letter="(?:(?!"+n+"|"+t.src_ZPCc+")"+t.src_Any+")",t.src_ip4="(?:(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)",t.src_auth="(?:(?:(?!"+t.src_ZCc+"|[@/\\[\\]()]).)+@)?",t.src_port="(?::(?:6(?:[0-4]\\d{3}|5(?:[0-4]\\d{2}|5(?:[0-2]\\d|3[0-5])))|[1-5]?\\d{1,4}))?",t.src_host_terminator="(?=$|"+n+"|"+t.src_ZPCc+")(?!"+(e["---"]?"-(?!--)|":"-|")+"_|:\\d|\\.-|\\.(?!$|"+t.src_ZPCc+"))",t.src_path="(?:[/?#](?:(?!"+t.src_ZCc+"|"+n+`|[()[\\]{}.,"'?!\\-;]).|\\[(?:(?!`+t.src_ZCc+"|\\]).)*\\]|\\((?:(?!"+t.src_ZCc+"|[)]).)*\\)|\\{(?:(?!"+t.src_ZCc+'|[}]).)*\\}|\\"(?:(?!'+t.src_ZCc+`|["]).)+\\"|\\'(?:(?!`+t.src_ZCc+"|[']).)+\\'|\\'(?="+t.src_pseudo_letter+"|[-])|\\.{2,}[a-zA-Z0-9%/&]|\\.(?!"+t.src_ZCc+"|[.]|$)|"+(e["---"]?"\\-(?!--(?:[^-]|$))(?:-*)|":"\\-+|")+",(?!"+t.src_ZCc+"|$)|;(?!"+t.src_ZCc+"|$)|\\!+(?!"+t.src_ZCc+"|[!]|$)|\\?(?!"+t.src_ZCc+"|[?]|$))+|\\/)?",t.src_email_name='[\\-;:&=\\+\\$,\\.a-zA-Z0-9_][\\-;:&=\\+\\$,\\"\\.a-zA-Z0-9_]*',t.src_xn="xn--[a-z0-9\\-]{1,59}",t.src_domain_root="(?:"+t.src_xn+"|"+t.src_pseudo_letter+"{1,63})",t.src_domain="(?:"+t.src_xn+"|(?:"+t.src_pseudo_letter+")|(?:"+t.src_pseudo_letter+"(?:-|"+t.src_pseudo_letter+"){0,61}"+t.src_pseudo_letter+"))",t.src_host="(?:(?:(?:(?:"+t.src_domain+")\\.)*"+t.src_domain+"))",t.tpl_host_fuzzy="(?:"+t.src_ip4+"|(?:(?:(?:"+t.src_domain+")\\.)+(?:%TLDS%)))",t.tpl_host_no_ip_fuzzy="(?:(?:(?:"+t.src_domain+")\\.)+(?:%TLDS%))",t.src_host_strict=t.src_host+t.src_host_terminator,t.tpl_host_fuzzy_strict=t.tpl_host_fuzzy+t.src_host_terminator,t.src_host_port_strict=t.src_host+t.src_port+t.src_host_terminator,t.tpl_host_port_fuzzy_strict=t.tpl_host_fuzzy+t.src_port+t.src_host_terminator,t.tpl_host_port_no_ip_fuzzy_strict=t.tpl_host_no_ip_fuzzy+t.src_port+t.src_host_terminator,t.tpl_host_fuzzy_test="localhost|www\\.|\\.\\d{1,3}\\.|(?:\\.(?:%TLDS%)(?:"+t.src_ZPCc+"|>|$))",t.tpl_email_fuzzy="(^|"+n+'|"|\\(|'+t.src_ZCc+")("+t.src_email_name+"@"+t.tpl_host_fuzzy_strict+")",t.tpl_link_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|]|"+t.src_ZPCc+"))((?![$+<=>^`|])"+t.tpl_host_port_fuzzy_strict+t.src_path+")",t.tpl_link_no_ip_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|]|"+t.src_ZPCc+"))((?![$+<=>^`|])"+t.tpl_host_port_no_ip_fuzzy_strict+t.src_path+")",t}function $j(e){return Array.prototype.slice.call(arguments,1).forEach(function(n){n&&Object.keys(n).forEach(function(r){e[r]=n[r]})}),e}function hT(e){return Object.prototype.toString.call(e)}function yMe(e){return hT(e)==="[object String]"}function bMe(e){return hT(e)==="[object Object]"}function vMe(e){return hT(e)==="[object RegExp]"}function Xz(e){return hT(e)==="[object Function]"}function xMe(e){return e.replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}const lX={fuzzyLink:!0,fuzzyEmail:!0,fuzzyIP:!1};function wMe(e){return Object.keys(e||{}).reduce(function(t,n){return t||lX.hasOwnProperty(n)},!1)}const _Me={"http:":{validate:function(e,t,n){const r=e.slice(t);return n.re.http||(n.re.http=new RegExp("^\\/\\/"+n.re.src_auth+n.re.src_host_port_strict+n.re.src_path,"i")),n.re.http.test(r)?r.match(n.re.http)[0].length:0}},"https:":"http:","ftp:":"http:","//":{validate:function(e,t,n){const r=e.slice(t);return n.re.no_http||(n.re.no_http=new RegExp("^"+n.re.src_auth+"(?:localhost|(?:(?:"+n.re.src_domain+")\\.)+"+n.re.src_domain_root+")"+n.re.src_port+n.re.src_host_terminator+n.re.src_path,"i")),n.re.no_http.test(r)?t>=3&&e[t-3]===":"||t>=3&&e[t-3]==="/"?0:r.match(n.re.no_http)[0].length:0}},"mailto:":{validate:function(e,t,n){const r=e.slice(t);return n.re.mailto||(n.re.mailto=new RegExp("^"+n.re.src_email_name+"@"+n.re.src_host_strict,"i")),n.re.mailto.test(r)?r.match(n.re.mailto)[0].length:0}}},SMe="a[cdefgilmnoqrstuwxz]|b[abdefghijmnorstvwyz]|c[acdfghiklmnoruvwxyz]|d[ejkmoz]|e[cegrstu]|f[ijkmor]|g[abdefghilmnpqrstuwy]|h[kmnrtu]|i[delmnoqrst]|j[emop]|k[eghimnprwyz]|l[abcikrstuvy]|m[acdeghklmnopqrstuvwxyz]|n[acefgilopruz]|om|p[aefghklmnrstwy]|qa|r[eosuw]|s[abcdeghijklmnortuvxyz]|t[cdfghjklmnortvwz]|u[agksyz]|v[aceginu]|w[fs]|y[et]|z[amw]",CMe="biz|com|edu|gov|net|org|pro|web|xxx|aero|asia|coop|info|museum|name|shop|".split("|");function kMe(e){e.__index__=-1,e.__text_cache__=""}function EMe(e){return function(t,n){const r=t.slice(n);return e.test(r)?r.match(e)[0].length:0}}function Jz(){return function(e,t){t.normalize(e)}}function ik(e){const t=e.re=gMe(e.__opts__),n=e.__tlds__.slice();e.onCompile(),e.__tlds_replaced__||n.push(SMe),n.push(t.src_xn),t.src_tlds=n.join("|");function r(o){return o.replace("%TLDS%",t.src_tlds)}t.email_fuzzy=RegExp(r(t.tpl_email_fuzzy),"i"),t.link_fuzzy=RegExp(r(t.tpl_link_fuzzy),"i"),t.link_no_ip_fuzzy=RegExp(r(t.tpl_link_no_ip_fuzzy),"i"),t.host_fuzzy_test=RegExp(r(t.tpl_host_fuzzy_test),"i");const s=[];e.__compiled__={};function i(o,l){throw new Error('(LinkifyIt) Invalid schema "'+o+'": '+l)}Object.keys(e.__schemas__).forEach(function(o){const l=e.__schemas__[o];if(l===null)return;const c={validate:null,link:null};if(e.__compiled__[o]=c,bMe(l)){vMe(l.validate)?c.validate=EMe(l.validate):Xz(l.validate)?c.validate=l.validate:i(o,l),Xz(l.normalize)?c.normalize=l.normalize:l.normalize?i(o,l):c.normalize=Jz();return}if(yMe(l)){s.push(o);return}i(o,l)}),s.forEach(function(o){e.__compiled__[e.__schemas__[o]]&&(e.__compiled__[o].validate=e.__compiled__[e.__schemas__[o]].validate,e.__compiled__[o].normalize=e.__compiled__[e.__schemas__[o]].normalize)}),e.__compiled__[""]={validate:null,normalize:Jz()};const a=Object.keys(e.__compiled__).filter(function(o){return o.length>0&&e.__compiled__[o]}).map(xMe).join("|");e.re.schema_test=RegExp("(^|(?!_)(?:[><]|"+t.src_ZPCc+"))("+a+")","i"),e.re.schema_search=RegExp("(^|(?!_)(?:[><]|"+t.src_ZPCc+"))("+a+")","ig"),e.re.schema_at_start=RegExp("^"+e.re.schema_search.source,"i"),e.re.pretest=RegExp("("+e.re.schema_test.source+")|("+e.re.host_fuzzy_test.source+")|@","i"),kMe(e)}function TMe(e,t){const n=e.__index__,r=e.__last_index__,s=e.__text_cache__.slice(n,r);this.schema=e.__schema__.toLowerCase(),this.index=n+t,this.lastIndex=r+t,this.raw=s,this.text=s,this.url=s}function zj(e,t){const n=new TMe(e,t);return e.__compiled__[n.schema].normalize(n,e),n}function bl(e,t){if(!(this instanceof bl))return new bl(e,t);t||wMe(e)&&(t=e,e={}),this.__opts__=$j({},lX,t),this.__index__=-1,this.__last_index__=-1,this.__schema__="",this.__text_cache__="",this.__schemas__=$j({},_Me,e),this.__compiled__={},this.__tlds__=CMe,this.__tlds_replaced__=!1,this.re={},ik(this)}bl.prototype.add=function(t,n){return this.__schemas__[t]=n,ik(this),this};bl.prototype.set=function(t){return this.__opts__=$j(this.__opts__,t),this};bl.prototype.test=function(t){if(this.__text_cache__=t,this.__index__=-1,!t.length)return!1;let n,r,s,i,a,o,l,c,u;if(this.re.schema_test.test(t)){for(l=this.re.schema_search,l.lastIndex=0;(n=l.exec(t))!==null;)if(i=this.testSchemaAt(t,n[2],l.lastIndex),i){this.__schema__=n[2],this.__index__=n.index+n[1].length,this.__last_index__=n.index+n[0].length+i;break}}return this.__opts__.fuzzyLink&&this.__compiled__["http:"]&&(c=t.search(this.re.host_fuzzy_test),c>=0&&(this.__index__<0||c<this.__index__)&&(r=t.match(this.__opts__.fuzzyIP?this.re.link_fuzzy:this.re.link_no_ip_fuzzy))!==null&&(a=r.index+r[1].length,(this.__index__<0||a<this.__index__)&&(this.__schema__="",this.__index__=a,this.__last_index__=r.index+r[0].length))),this.__opts__.fuzzyEmail&&this.__compiled__["mailto:"]&&(u=t.indexOf("@"),u>=0&&(s=t.match(this.re.email_fuzzy))!==null&&(a=s.index+s[1].length,o=s.index+s[0].length,(this.__index__<0||a<this.__index__||a===this.__index__&&o>this.__last_index__)&&(this.__schema__="mailto:",this.__index__=a,this.__last_index__=o))),this.__index__>=0};bl.prototype.pretest=function(t){return this.re.pretest.test(t)};bl.prototype.testSchemaAt=function(t,n,r){return this.__compiled__[n.toLowerCase()]?this.__compiled__[n.toLowerCase()].validate(t,r,this):0};bl.prototype.match=function(t){const n=[];let r=0;this.__index__>=0&&this.__text_cache__===t&&(n.push(zj(this,r)),r=this.__last_index__);let s=r?t.slice(r):t;for(;this.test(s);)n.push(zj(this,r)),s=s.slice(this.__last_index__),r+=this.__last_index__;return n.length?n:null};bl.prototype.matchAtStart=function(t){if(this.__text_cache__=t,this.__index__=-1,!t.length)return null;const n=this.re.schema_at_start.exec(t);if(!n)return null;const r=this.testSchemaAt(t,n[2],n[0].length);return r?(this.__schema__=n[2],this.__index__=n.index+n[1].length,this.__last_index__=n.index+n[0].length+r,zj(this,0)):null};bl.prototype.tlds=function(t,n){return t=Array.isArray(t)?t:[t],n?(this.__tlds__=this.__tlds__.concat(t).sort().filter(function(r,s,i){return r!==i[s-1]}).reverse(),ik(this),this):(this.__tlds__=t.slice(),this.__tlds_replaced__=!0,ik(this),this)};bl.prototype.normalize=function(t){t.schema||(t.url="http://"+t.url),t.schema==="mailto:"&&!/^mailto:/i.test(t.url)&&(t.url="mailto:"+t.url)};bl.prototype.onCompile=function(){};const O0=2147483647,wu=36,AD=1,Aw=26,AMe=38,RMe=700,cX=72,uX=128,dX="-",NMe=/^xn--/,MMe=/[^\0-\x7F]/,IMe=/[\x2E\u3002\uFF0E\uFF61]/g,jMe={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},vI=wu-AD,_u=Math.floor,xI=String.fromCharCode;function ah(e){throw new RangeError(jMe[e])}function OMe(e,t){const n=[];let r=e.length;for(;r--;)n[r]=t(e[r]);return n}function fX(e,t){const n=e.split("@");let r="";n.length>1&&(r=n[0]+"@",e=n[1]),e=e.replace(IMe,".");const s=e.split("."),i=OMe(s,t).join(".");return r+i}function hX(e){const t=[];let n=0;const r=e.length;for(;n<r;){const s=e.charCodeAt(n++);if(s>=55296&&s<=56319&&n<r){const i=e.charCodeAt(n++);(i&64512)==56320?t.push(((s&1023)<<10)+(i&1023)+65536):(t.push(s),n--)}else t.push(s)}return t}const PMe=e=>String.fromCodePoint(...e),DMe=function(e){return e>=48&&e<58?26+(e-48):e>=65&&e<91?e-65:e>=97&&e<123?e-97:wu},Qz=function(e,t){return e+22+75*(e<26)-((t!=0)<<5)},pX=function(e,t,n){let r=0;for(e=n?_u(e/RMe):e>>1,e+=_u(e/t);e>vI*Aw>>1;r+=wu)e=_u(e/vI);return _u(r+(vI+1)*e/(e+AMe))},mX=function(e){const t=[],n=e.length;let r=0,s=uX,i=cX,a=e.lastIndexOf(dX);a<0&&(a=0);for(let o=0;o<a;++o)e.charCodeAt(o)>=128&&ah("not-basic"),t.push(e.charCodeAt(o));for(let o=a>0?a+1:0;o<n;){const l=r;for(let u=1,d=wu;;d+=wu){o>=n&&ah("invalid-input");const h=DMe(e.charCodeAt(o++));h>=wu&&ah("invalid-input"),h>_u((O0-r)/u)&&ah("overflow"),r+=h*u;const m=d<=i?AD:d>=i+Aw?Aw:d-i;if(h<m)break;const y=wu-m;u>_u(O0/y)&&ah("overflow"),u*=y}const c=t.length+1;i=pX(r-l,c,l==0),_u(r/c)>O0-s&&ah("overflow"),s+=_u(r/c),r%=c,t.splice(r++,0,s)}return String.fromCodePoint(...t)},gX=function(e){const t=[];e=hX(e);const n=e.length;let r=uX,s=0,i=cX;for(const l of e)l<128&&t.push(xI(l));const a=t.length;let o=a;for(a&&t.push(dX);o<n;){let l=O0;for(const u of e)u>=r&&u<l&&(l=u);const c=o+1;l-r>_u((O0-s)/c)&&ah("overflow"),s+=(l-r)*c,r=l;for(const u of e)if(u<r&&++s>O0&&ah("overflow"),u===r){let d=s;for(let h=wu;;h+=wu){const m=h<=i?AD:h>=i+Aw?Aw:h-i;if(d<m)break;const y=d-m,b=wu-m;t.push(xI(Qz(m+y%b,0))),d=_u(y/b)}t.push(xI(Qz(d,0))),i=pX(s,c,o===a),s=0,++o}++s,++r}return t.join("")},FMe=function(e){return fX(e,function(t){return NMe.test(t)?mX(t.slice(4).toLowerCase()):t})},LMe=function(e){return fX(e,function(t){return MMe.test(t)?"xn--"+gX(t):t})},yX={version:"2.3.1",ucs2:{decode:hX,encode:PMe},decode:mX,encode:gX,toASCII:LMe,toUnicode:FMe},BMe={options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"",highlight:null,maxNesting:100},components:{core:{},block:{},inline:{}}},$Me={options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"",highlight:null,maxNesting:20},components:{core:{rules:["normalize","block","inline","text_join"]},block:{rules:["paragraph"]},inline:{rules:["text"],rules2:["balance_pairs","fragments_join"]}}},zMe={options:{html:!0,xhtmlOut:!0,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"",highlight:null,maxNesting:20},components:{core:{rules:["normalize","block","inline","text_join"]},block:{rules:["blockquote","code","fence","heading","hr","html_block","lheading","list","reference","paragraph"]},inline:{rules:["autolink","backticks","emphasis","entity","escape","html_inline","image","link","newline","text"],rules2:["balance_pairs","emphasis","fragments_join"]}}},UMe={default:BMe,zero:$Me,commonmark:zMe},qMe=/^(vbscript|javascript|file|data):/,VMe=/^data:image\/(gif|png|jpeg|webp);/;function WMe(e){const t=e.trim().toLowerCase();return qMe.test(t)?VMe.test(t):!0}const bX=["http:","https:","mailto:"];function HMe(e){const t=_D(e,!0);if(t.hostname&&(!t.protocol||bX.indexOf(t.protocol)>=0))try{t.hostname=yX.toASCII(t.hostname)}catch{}return W1(wD(t))}function GMe(e){const t=_D(e,!0);if(t.hostname&&(!t.protocol||bX.indexOf(t.protocol)>=0))try{t.hostname=yX.toUnicode(t.hostname)}catch{}return wy(wD(t),wy.defaultChars+"%")}function $o(e,t){if(!(this instanceof $o))return new $o(e,t);t||CD(e)||(t=e||{},e="default"),this.inline=new G1,this.block=new fT,this.core=new ED,this.renderer=new ub,this.linkify=new bl,this.validateLink=WMe,this.normalizeLink=HMe,this.normalizeLinkText=GMe,this.utils=YRe,this.helpers=uT({},QRe),this.options={},this.configure(e),t&&this.set(t)}$o.prototype.set=function(e){return uT(this.options,e),this};$o.prototype.configure=function(e){const t=this;if(CD(e)){const n=e;if(e=UMe[n],!e)throw new Error('Wrong `markdown-it` preset "'+n+'", check name')}if(!e)throw new Error("Wrong `markdown-it` preset, can't be empty");return e.options&&t.set(e.options),e.components&&Object.keys(e.components).forEach(function(n){e.components[n].rules&&t[n].ruler.enableOnly(e.components[n].rules),e.components[n].rules2&&t[n].ruler2.enableOnly(e.components[n].rules2)}),this};$o.prototype.enable=function(e,t){let n=[];Array.isArray(e)||(e=[e]),["core","block","inline"].forEach(function(s){n=n.concat(this[s].ruler.enable(e,!0))},this),n=n.concat(this.inline.ruler2.enable(e,!0));const r=e.filter(function(s){return n.indexOf(s)<0});if(r.length&&!t)throw new Error("MarkdownIt. Failed to enable unknown rule(s): "+r);return this};$o.prototype.disable=function(e,t){let n=[];Array.isArray(e)||(e=[e]),["core","block","inline"].forEach(function(s){n=n.concat(this[s].ruler.disable(e,!0))},this),n=n.concat(this.inline.ruler2.disable(e,!0));const r=e.filter(function(s){return n.indexOf(s)<0});if(r.length&&!t)throw new Error("MarkdownIt. Failed to disable unknown rule(s): "+r);return this};$o.prototype.use=function(e){const t=[this].concat(Array.prototype.slice.call(arguments,1));return e.apply(e,t),this};$o.prototype.parse=function(e,t){if(typeof e!="string")throw new Error("Input data should be a String");const n=new this.core.State(e,this,t);return this.core.process(n),n.tokens};$o.prototype.render=function(e,t){return t=t||{},this.renderer.render(this.parse(e,t),this.options,t)};$o.prototype.parseInline=function(e,t){const n=new this.core.State(e,this,t);return n.inlineMode=!0,this.core.process(n),n.tokens};$o.prototype.renderInline=function(e,t){return t=t||{},this.renderer.render(this.parseInline(e,t),this.options,t)};const wI=new $o({html:!1,linkify:!0,breaks:!0});function pT(e){return E.useMemo(()=>{var n;if(!e)return[];try{const r=wI.parse(e,{}),s=[];let i="",a=0;for(;a<r.length;){const o=r[a];if(o.type==="fence"){i&&(s.push(i),i="");const l=((n=o.info)==null?void 0:n.trim())||"";let c,u;if(l.includes(":")){const[d,...h]=l.split(":");c=d||void 0,u=h.join(":")||void 0}else c=l.split(" ")[0]||void 0;s.push({type:"block",lang:c,code:o.content,filepath:u}),a++}else{const l=[];for(;a<r.length&&r[a].type!=="fence";)l.push(r[a]),a++;l.length>0&&(i+=wI.renderer.render(l,wI.options,{}))}}return i&&s.push(i),s}catch(r){return console.error("Markdown parsing error:",r),[`<pre>${String(e??"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}</pre>`]}},[e])}const KMe=({markdownContent:e,interactionId:t})=>{const n=pT(e);return e!=null&&e.trim()?f.jsx("div",{className:"overflow-wrap-anywhere",children:n.map((r,s)=>typeof r=="string"?f.jsx("div",{className:"markdown-content",dangerouslySetInnerHTML:{__html:r}},`html-${s}`):r.type==="block"?f.jsx(Yy,{lang:r.lang,code:r.code,filepath:r.filepath,interactionId:t},`block-${s}`):null)}):null},mT=Ve.memo(({turnData:e,timestamp:t,className:n,isAssistantComplete:r=!0,interactionId:s})=>{var v,x;const i=br(w=>w.foldUserMessagesOnCompletion),[a,o]=E.useState(r&&i),[l,c]=E.useState(!1);E.useEffect(()=>{r&&i&&o(!0)},[r,i]);const u=t?HZ(new Date(t),{addSuffix:!0}):"Sending...",d=((v=e.metadata)==null?void 0:v.attachedFiles)&&e.metadata.attachedFiles.length>0,h=e.content&&e.content.trim().length>0,m=E.useCallback(()=>o(w=>!w),[]),y=E.useCallback(async()=>{if(e.content)try{await navigator.clipboard.writeText(e.content),c(!0),Me.success("User prompt copied!"),setTimeout(()=>c(!1),1500)}catch(w){Me.error("Failed to copy prompt."),console.error("Clipboard copy failed:",w)}},[e.content]),b=E.useMemo(()=>{var S;let w="";return h&&(w+=`"${e.content.substring(0,50)}${e.content.length>50?"...":""}"`),h&&d&&(w+=" + "),d&&(w+=`${(S=e.metadata.attachedFiles)==null?void 0:S.length} file(s)`),w||"[Empty Prompt]"},[h,d,e.content,e.metadata]);return f.jsxs("div",{className:Xe("user-prompt relative group/user overflow-wrap-anywhere",n),children:[f.jsxs("div",{className:Xe("flex flex-col sm:flex-row justify-between items-start mb-2 sticky top-0 bg-card/80 backdrop-blur-sm z-10 p-1 -m-1 rounded-t"),children:[f.jsxs("div",{className:"flex items-center gap-1 mb-1 sm:mb-0",children:[f.jsx(Yge,{className:"h-4 w-4 text-primary flex-shrink-0"}),f.jsx("span",{className:"text-xs font-semibold text-primary mr-1",children:"User"}),f.jsxs("div",{className:"flex items-center gap-0.5 opacity-0 group-hover/user:opacity-100 focus-within:opacity-100 transition-opacity",children:[h&&f.jsx(Un,{tooltipText:"Copy Prompt",onClick:y,"aria-label":"Copy user prompt",icon:l?f.jsx(ao,{className:"text-green-500"}):f.jsx(pE,{}),className:"h-5 w-5"}),(h||d)&&f.jsx(Un,{tooltipText:a?"Unfold":"Fold",onClick:m,"aria-label":a?"Unfold prompt":"Fold prompt",icon:a?f.jsx(Jl,{}):f.jsx(Bh,{}),iconClassName:"h-3.5 w-3.5",className:"h-5 w-5"})]})]}),f.jsx("div",{className:"flex items-center flex-shrink-0 self-end sm:self-start",children:f.jsx("span",{className:"text-xs text-muted-foreground",children:u})})]}),!a&&f.jsxs(f.Fragment,{children:[d&&f.jsx("div",{className:"mb-2 space-y-1",children:(x=e.metadata.attachedFiles)==null?void 0:x.map(w=>f.jsx(RZ,{fileMeta:w,isReadOnly:!0},w.id))}),f.jsx(KMe,{markdownContent:e.content,interactionId:s})]}),a&&f.jsx("div",{className:"text-xs text-muted-foreground italic cursor-pointer hover:bg-muted/20 p-1 rounded",onClick:m,children:b})]})});mT.displayName="UserPromptDisplay";const YMe=(e,t,n,r)=>typeof e=="string"?e.trim()?f.jsx("div",{className:"markdown-content",dangerouslySetInnerHTML:{__html:e}},`html-${t}`):null:e.type==="block"?f.jsx(Yy,{lang:e.lang,code:e.code,filepath:e.filepath,isStreaming:n,interactionId:r},`block-${t}`):null,ZMe=({interactionId:e,markdownContent:t,isStreaming:n=!1,className:r})=>{const{enableStreamingMarkdown:s}=br(yn(h=>({enableStreamingMarkdown:h.enableStreamingMarkdown}))),i=pT(s?t:null),a=Vi(yn(h=>Object.values(h.canvasControls))),o=E.useCallback((h,m)=>a.filter(y=>y.type==="tool-call-step"&&y.targetSlot===h&&y.renderer).map(y=>y.renderer?f.jsx(Ve.Fragment,{children:y.renderer(m)},y.id):null).filter(Boolean),[a]),{toolCallStrings:l,toolResultStrings:c}=vn(yn(h=>{var y,b;const m=h.interactions.find(v=>v.id===e);return{toolCallStrings:(y=m==null?void 0:m.metadata)==null?void 0:y.toolCalls,toolResultStrings:(b=m==null?void 0:m.metadata)==null?void 0:b.toolResults}})),u=E.useMemo(()=>{if(!l)return[];try{const h=l.map(y=>JSON.parse(y)),m=(c==null?void 0:c.map(y=>JSON.parse(y)))??[];return h.map(y=>{const b=m.find(v=>v.toolCallId===y.toolCallId);return{call:y,result:b}})}catch(h){return console.error("[StreamingContentView] Error parsing tool call/result strings:",h),[]}},[l,c]),d=E.useMemo(()=>s?i.map((h,m)=>YMe(h,m,n&&m===i.length-1,e)).filter(Boolean):[],[s,i,n,e]);return!s&&!t&&u.length===0?n?f.jsx("div",{className:Xe("text-muted-foreground italic",r),children:"Generating response..."}):null:f.jsxs("div",{className:Xe("streaming-content-view overflow-wrap-anywhere",r),children:[u.map(({call:h,result:m},y)=>{const b={interactionId:e,toolCall:h,toolResult:m,canvasContextType:"tool-call-step"};return f.jsx(Ve.Fragment,{children:o("tool-call-content",b)},`tool-step-${h.toolCallId||y}`)}),s?d:t?f.jsx("div",{className:"markdown-content",dangerouslySetInnerHTML:{__html:new $o().render(t)}}):null]})},XMe=({onStop:e,className:t,size:n="icon",variant:r="ghost","aria-label":s="Stop Generation"})=>f.jsx(Un,{tooltipText:"Stop",onClick:e,"aria-label":s,icon:f.jsx(Lge,{}),variant:r,size:n,className:t}),JMe=Symbol("Let zodToJsonSchema decide on which parser to use"),e7={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",allowedAdditionalProperties:!0,rejectedAdditionalProperties:!1,definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"},QMe=e=>typeof e=="string"?{...e7,name:e}:{...e7,...e},eIe=e=>{const t=QMe(e),n=t.name!==void 0?[...t.basePath,t.definitionPath,t.name]:t.basePath;return{...t,currentPath:n,propertyPath:void 0,seen:new Map(Object.entries(t.definitions).map(([r,s])=>[s._def,{def:s._def,path:[...t.basePath,t.definitionPath,r],jsonSchema:void 0}]))}};function vX(e,t,n,r){r!=null&&r.errorMessages&&n&&(e.errorMessage={...e.errorMessage,[t]:n})}function ws(e,t,n,r,s){e[t]=n,vX(e,t,r,s)}function tIe(){return{}}function nIe(e,t){var r,s,i;const n={type:"array"};return(r=e.type)!=null&&r._def&&((i=(s=e.type)==null?void 0:s._def)==null?void 0:i.typeName)!==tn.ZodAny&&(n.items=cs(e.type._def,{...t,currentPath:[...t.currentPath,"items"]})),e.minLength&&ws(n,"minItems",e.minLength.value,e.minLength.message,t),e.maxLength&&ws(n,"maxItems",e.maxLength.value,e.maxLength.message,t),e.exactLength&&(ws(n,"minItems",e.exactLength.value,e.exactLength.message,t),ws(n,"maxItems",e.exactLength.value,e.exactLength.message,t)),n}function rIe(e,t){const n={type:"integer",format:"int64"};if(!e.checks)return n;for(const r of e.checks)switch(r.kind){case"min":t.target==="jsonSchema7"?r.inclusive?ws(n,"minimum",r.value,r.message,t):ws(n,"exclusiveMinimum",r.value,r.message,t):(r.inclusive||(n.exclusiveMinimum=!0),ws(n,"minimum",r.value,r.message,t));break;case"max":t.target==="jsonSchema7"?r.inclusive?ws(n,"maximum",r.value,r.message,t):ws(n,"exclusiveMaximum",r.value,r.message,t):(r.inclusive||(n.exclusiveMaximum=!0),ws(n,"maximum",r.value,r.message,t));break;case"multipleOf":ws(n,"multipleOf",r.value,r.message,t);break}return n}function sIe(){return{type:"boolean"}}function xX(e,t){return cs(e.type._def,t)}const iIe=(e,t)=>cs(e.innerType._def,t);function wX(e,t,n){const r=n??t.dateStrategy;if(Array.isArray(r))return{anyOf:r.map((s,i)=>wX(e,t,s))};switch(r){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return aIe(e,t)}}const aIe=(e,t)=>{const n={type:"integer",format:"unix-time"};if(t.target==="openApi3")return n;for(const r of e.checks)switch(r.kind){case"min":ws(n,"minimum",r.value,r.message,t);break;case"max":ws(n,"maximum",r.value,r.message,t);break}return n};function oIe(e,t){return{...cs(e.innerType._def,t),default:e.defaultValue()}}function lIe(e,t){return t.effectStrategy==="input"?cs(e.schema._def,t):{}}function cIe(e){return{type:"string",enum:Array.from(e.values)}}const uIe=e=>"type"in e&&e.type==="string"?!1:"allOf"in e;function dIe(e,t){const n=[cs(e.left._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),cs(e.right._def,{...t,currentPath:[...t.currentPath,"allOf","1"]})].filter(i=>!!i);let r=t.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0;const s=[];return n.forEach(i=>{if(uIe(i))s.push(...i.allOf),i.unevaluatedProperties===void 0&&(r=void 0);else{let a=i;if("additionalProperties"in i&&i.additionalProperties===!1){const{additionalProperties:o,...l}=i;a=l}else r=void 0;s.push(a)}}),s.length?{allOf:s,...r}:void 0}function fIe(e,t){const n=typeof e.value;return n!=="bigint"&&n!=="number"&&n!=="boolean"&&n!=="string"?{type:Array.isArray(e.value)?"array":"object"}:t.target==="openApi3"?{type:n==="bigint"?"integer":n,enum:[e.value]}:{type:n==="bigint"?"integer":n,const:e.value}}let _I;const pc={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(_I===void 0&&(_I=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),_I),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv4Cidr:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,ipv6Cidr:/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,base64url:/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/,jwt:/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/};function _X(e,t){const n={type:"string"};if(e.checks)for(const r of e.checks)switch(r.kind){case"min":ws(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,r.value):r.value,r.message,t);break;case"max":ws(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,r.value):r.value,r.message,t);break;case"email":switch(t.emailStrategy){case"format:email":mc(n,"email",r.message,t);break;case"format:idn-email":mc(n,"idn-email",r.message,t);break;case"pattern:zod":Xa(n,pc.email,r.message,t);break}break;case"url":mc(n,"uri",r.message,t);break;case"uuid":mc(n,"uuid",r.message,t);break;case"regex":Xa(n,r.regex,r.message,t);break;case"cuid":Xa(n,pc.cuid,r.message,t);break;case"cuid2":Xa(n,pc.cuid2,r.message,t);break;case"startsWith":Xa(n,RegExp(`^${SI(r.value,t)}`),r.message,t);break;case"endsWith":Xa(n,RegExp(`${SI(r.value,t)}$`),r.message,t);break;case"datetime":mc(n,"date-time",r.message,t);break;case"date":mc(n,"date",r.message,t);break;case"time":mc(n,"time",r.message,t);break;case"duration":mc(n,"duration",r.message,t);break;case"length":ws(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,r.value):r.value,r.message,t),ws(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,r.value):r.value,r.message,t);break;case"includes":{Xa(n,RegExp(SI(r.value,t)),r.message,t);break}case"ip":{r.version!=="v6"&&mc(n,"ipv4",r.message,t),r.version!=="v4"&&mc(n,"ipv6",r.message,t);break}case"base64url":Xa(n,pc.base64url,r.message,t);break;case"jwt":Xa(n,pc.jwt,r.message,t);break;case"cidr":{r.version!=="v6"&&Xa(n,pc.ipv4Cidr,r.message,t),r.version!=="v4"&&Xa(n,pc.ipv6Cidr,r.message,t);break}case"emoji":Xa(n,pc.emoji(),r.message,t);break;case"ulid":{Xa(n,pc.ulid,r.message,t);break}case"base64":{switch(t.base64Strategy){case"format:binary":{mc(n,"binary",r.message,t);break}case"contentEncoding:base64":{ws(n,"contentEncoding","base64",r.message,t);break}case"pattern:zod":{Xa(n,pc.base64,r.message,t);break}}break}case"nanoid":Xa(n,pc.nanoid,r.message,t)}return n}function SI(e,t){return t.patternStrategy==="escape"?pIe(e):e}const hIe=new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function pIe(e){let t="";for(let n=0;n<e.length;n++)hIe.has(e[n])||(t+="\\"),t+=e[n];return t}function mc(e,t,n,r){var s;e.format||(s=e.anyOf)!=null&&s.some(i=>i.format)?(e.anyOf||(e.anyOf=[]),e.format&&(e.anyOf.push({format:e.format,...e.errorMessage&&r.errorMessages&&{errorMessage:{format:e.errorMessage.format}}}),delete e.format,e.errorMessage&&(delete e.errorMessage.format,Object.keys(e.errorMessage).length===0&&delete e.errorMessage)),e.anyOf.push({format:t,...n&&r.errorMessages&&{errorMessage:{format:n}}})):ws(e,"format",t,n,r)}function Xa(e,t,n,r){var s;e.pattern||(s=e.allOf)!=null&&s.some(i=>i.pattern)?(e.allOf||(e.allOf=[]),e.pattern&&(e.allOf.push({pattern:e.pattern,...e.errorMessage&&r.errorMessages&&{errorMessage:{pattern:e.errorMessage.pattern}}}),delete e.pattern,e.errorMessage&&(delete e.errorMessage.pattern,Object.keys(e.errorMessage).length===0&&delete e.errorMessage)),e.allOf.push({pattern:t7(t,r),...n&&r.errorMessages&&{errorMessage:{pattern:n}}})):ws(e,"pattern",t7(t,r),n,r)}function t7(e,t){var l;if(!t.applyRegexFlags||!e.flags)return e.source;const n={i:e.flags.includes("i"),m:e.flags.includes("m"),s:e.flags.includes("s")},r=n.i?e.source.toLowerCase():e.source;let s="",i=!1,a=!1,o=!1;for(let c=0;c<r.length;c++){if(i){s+=r[c],i=!1;continue}if(n.i){if(a){if(r[c].match(/[a-z]/)){o?(s+=r[c],s+=`${r[c-2]}-${r[c]}`.toUpperCase(),o=!1):r[c+1]==="-"&&((l=r[c+2])!=null&&l.match(/[a-z]/))?(s+=r[c],o=!0):s+=`${r[c]}${r[c].toUpperCase()}`;continue}}else if(r[c].match(/[a-z]/)){s+=`[${r[c]}${r[c].toUpperCase()}]`;continue}}if(n.m){if(r[c]==="^"){s+=`(^|(?<=[\r
]))`;continue}else if(r[c]==="$"){s+=`($|(?=[\r
]))`;continue}}if(n.s&&r[c]==="."){s+=a?`${r[c]}\r
`:`[${r[c]}\r
]`;continue}s+=r[c],r[c]==="\\"?i=!0:a&&r[c]==="]"?a=!1:!a&&r[c]==="["&&(a=!0)}try{new RegExp(s)}catch{return console.warn(`Could not convert regex pattern at ${t.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),e.source}return s}function SX(e,t){var r,s,i,a,o,l;if(t.target==="openAi"&&console.warn("Warning: OpenAI may not support records in schemas! Try an array of key-value pairs instead."),t.target==="openApi3"&&((r=e.keyType)==null?void 0:r._def.typeName)===tn.ZodEnum)return{type:"object",required:e.keyType._def.values,properties:e.keyType._def.values.reduce((c,u)=>({...c,[u]:cs(e.valueType._def,{...t,currentPath:[...t.currentPath,"properties",u]})??{}}),{}),additionalProperties:t.rejectedAdditionalProperties};const n={type:"object",additionalProperties:cs(e.valueType._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??t.allowedAdditionalProperties};if(t.target==="openApi3")return n;if(((s=e.keyType)==null?void 0:s._def.typeName)===tn.ZodString&&((i=e.keyType._def.checks)!=null&&i.length)){const{type:c,...u}=_X(e.keyType._def,t);return{...n,propertyNames:u}}else{if(((a=e.keyType)==null?void 0:a._def.typeName)===tn.ZodEnum)return{...n,propertyNames:{enum:e.keyType._def.values}};if(((o=e.keyType)==null?void 0:o._def.typeName)===tn.ZodBranded&&e.keyType._def.type._def.typeName===tn.ZodString&&((l=e.keyType._def.type._def.checks)!=null&&l.length)){const{type:c,...u}=xX(e.keyType._def,t);return{...n,propertyNames:u}}}return n}function mIe(e,t){if(t.mapStrategy==="record")return SX(e,t);const n=cs(e.keyType._def,{...t,currentPath:[...t.currentPath,"items","items","0"]})||{},r=cs(e.valueType._def,{...t,currentPath:[...t.currentPath,"items","items","1"]})||{};return{type:"array",maxItems:125,items:{type:"array",items:[n,r],minItems:2,maxItems:2}}}function gIe(e){const t=e.values,r=Object.keys(e.values).filter(i=>typeof t[t[i]]!="number").map(i=>t[i]),s=Array.from(new Set(r.map(i=>typeof i)));return{type:s.length===1?s[0]==="string"?"string":"number":["string","number"],enum:r}}function yIe(){return{not:{}}}function bIe(e){return e.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}const ak={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function vIe(e,t){if(t.target==="openApi3")return n7(e,t);const n=e.options instanceof Map?Array.from(e.options.values()):e.options;if(n.every(r=>r._def.typeName in ak&&(!r._def.checks||!r._def.checks.length))){const r=n.reduce((s,i)=>{const a=ak[i._def.typeName];return a&&!s.includes(a)?[...s,a]:s},[]);return{type:r.length>1?r:r[0]}}else if(n.every(r=>r._def.typeName==="ZodLiteral"&&!r.description)){const r=n.reduce((s,i)=>{const a=typeof i._def.value;switch(a){case"string":case"number":case"boolean":return[...s,a];case"bigint":return[...s,"integer"];case"object":if(i._def.value===null)return[...s,"null"];case"symbol":case"undefined":case"function":default:return s}},[]);if(r.length===n.length){const s=r.filter((i,a,o)=>o.indexOf(i)===a);return{type:s.length>1?s:s[0],enum:n.reduce((i,a)=>i.includes(a._def.value)?i:[...i,a._def.value],[])}}}else if(n.every(r=>r._def.typeName==="ZodEnum"))return{type:"string",enum:n.reduce((r,s)=>[...r,...s._def.values.filter(i=>!r.includes(i))],[])};return n7(e,t)}const n7=(e,t)=>{const n=(e.options instanceof Map?Array.from(e.options.values()):e.options).map((r,s)=>cs(r._def,{...t,currentPath:[...t.currentPath,"anyOf",`${s}`]})).filter(r=>!!r&&(!t.strictUnions||typeof r=="object"&&Object.keys(r).length>0));return n.length?{anyOf:n}:void 0};function xIe(e,t){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(e.innerType._def.typeName)&&(!e.innerType._def.checks||!e.innerType._def.checks.length))return t.target==="openApi3"?{type:ak[e.innerType._def.typeName],nullable:!0}:{type:[ak[e.innerType._def.typeName],"null"]};if(t.target==="openApi3"){const r=cs(e.innerType._def,{...t,currentPath:[...t.currentPath]});return r&&"$ref"in r?{allOf:[r],nullable:!0}:r&&{...r,nullable:!0}}const n=cs(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","0"]});return n&&{anyOf:[n,{type:"null"}]}}function wIe(e,t){const n={type:"number"};if(!e.checks)return n;for(const r of e.checks)switch(r.kind){case"int":n.type="integer",vX(n,"type",r.message,t);break;case"min":t.target==="jsonSchema7"?r.inclusive?ws(n,"minimum",r.value,r.message,t):ws(n,"exclusiveMinimum",r.value,r.message,t):(r.inclusive||(n.exclusiveMinimum=!0),ws(n,"minimum",r.value,r.message,t));break;case"max":t.target==="jsonSchema7"?r.inclusive?ws(n,"maximum",r.value,r.message,t):ws(n,"exclusiveMaximum",r.value,r.message,t):(r.inclusive||(n.exclusiveMaximum=!0),ws(n,"maximum",r.value,r.message,t));break;case"multipleOf":ws(n,"multipleOf",r.value,r.message,t);break}return n}function _Ie(e,t){const n=t.target==="openAi",r={type:"object",properties:{}},s=[],i=e.shape();for(const o in i){let l=i[o];if(l===void 0||l._def===void 0)continue;let c=CIe(l);c&&n&&(l instanceof ku&&(l=l._def.innerType),l.isNullable()||(l=l.nullable()),c=!1);const u=cs(l._def,{...t,currentPath:[...t.currentPath,"properties",o],propertyPath:[...t.currentPath,"properties",o]});u!==void 0&&(r.properties[o]=u,c||s.push(o))}s.length&&(r.required=s);const a=SIe(e,t);return a!==void 0&&(r.additionalProperties=a),r}function SIe(e,t){if(e.catchall._def.typeName!=="ZodNever")return cs(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]});switch(e.unknownKeys){case"passthrough":return t.allowedAdditionalProperties;case"strict":return t.rejectedAdditionalProperties;case"strip":return t.removeAdditionalStrategy==="strict"?t.allowedAdditionalProperties:t.rejectedAdditionalProperties}}function CIe(e){try{return e.isOptional()}catch{return!0}}const kIe=(e,t)=>{var r;if(t.currentPath.toString()===((r=t.propertyPath)==null?void 0:r.toString()))return cs(e.innerType._def,t);const n=cs(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","1"]});return n?{anyOf:[{not:{}},n]}:{}},EIe=(e,t)=>{if(t.pipeStrategy==="input")return cs(e.in._def,t);if(t.pipeStrategy==="output")return cs(e.out._def,t);const n=cs(e.in._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),r=cs(e.out._def,{...t,currentPath:[...t.currentPath,"allOf",n?"1":"0"]});return{allOf:[n,r].filter(s=>s!==void 0)}};function TIe(e,t){return cs(e.type._def,t)}function AIe(e,t){const r={type:"array",uniqueItems:!0,items:cs(e.valueType._def,{...t,currentPath:[...t.currentPath,"items"]})};return e.minSize&&ws(r,"minItems",e.minSize.value,e.minSize.message,t),e.maxSize&&ws(r,"maxItems",e.maxSize.value,e.maxSize.message,t),r}function RIe(e,t){return e.rest?{type:"array",minItems:e.items.length,items:e.items.map((n,r)=>cs(n._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[]),additionalItems:cs(e.rest._def,{...t,currentPath:[...t.currentPath,"additionalItems"]})}:{type:"array",minItems:e.items.length,maxItems:e.items.length,items:e.items.map((n,r)=>cs(n._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[])}}function NIe(){return{not:{}}}function MIe(){return{}}const IIe=(e,t)=>cs(e.innerType._def,t),jIe=(e,t,n)=>{switch(t){case tn.ZodString:return _X(e,n);case tn.ZodNumber:return wIe(e,n);case tn.ZodObject:return _Ie(e,n);case tn.ZodBigInt:return rIe(e,n);case tn.ZodBoolean:return sIe();case tn.ZodDate:return wX(e,n);case tn.ZodUndefined:return NIe();case tn.ZodNull:return bIe(n);case tn.ZodArray:return nIe(e,n);case tn.ZodUnion:case tn.ZodDiscriminatedUnion:return vIe(e,n);case tn.ZodIntersection:return dIe(e,n);case tn.ZodTuple:return RIe(e,n);case tn.ZodRecord:return SX(e,n);case tn.ZodLiteral:return fIe(e,n);case tn.ZodEnum:return cIe(e);case tn.ZodNativeEnum:return gIe(e);case tn.ZodNullable:return xIe(e,n);case tn.ZodOptional:return kIe(e,n);case tn.ZodMap:return mIe(e,n);case tn.ZodSet:return AIe(e,n);case tn.ZodLazy:return()=>e.getter()._def;case tn.ZodPromise:return TIe(e,n);case tn.ZodNaN:case tn.ZodNever:return yIe();case tn.ZodEffects:return lIe(e,n);case tn.ZodAny:return tIe();case tn.ZodUnknown:return MIe();case tn.ZodDefault:return oIe(e,n);case tn.ZodBranded:return xX(e,n);case tn.ZodReadonly:return IIe(e,n);case tn.ZodCatch:return iIe(e,n);case tn.ZodPipeline:return EIe(e,n);case tn.ZodFunction:case tn.ZodVoid:case tn.ZodSymbol:return;default:return(r=>{})()}};function cs(e,t,n=!1){var o;const r=t.seen.get(e);if(t.override){const l=(o=t.override)==null?void 0:o.call(t,e,t,r,n);if(l!==JMe)return l}if(r&&!n){const l=OIe(r,t);if(l!==void 0)return l}const s={def:e,path:t.currentPath,jsonSchema:void 0};t.seen.set(e,s);const i=jIe(e,e.typeName,t),a=typeof i=="function"?cs(i(),t):i;if(a&&DIe(e,t,a),t.postProcess){const l=t.postProcess(a,e,t);return s.jsonSchema=a,l}return s.jsonSchema=a,a}const OIe=(e,t)=>{switch(t.$refStrategy){case"root":return{$ref:e.path.join("/")};case"relative":return{$ref:PIe(t.currentPath,e.path)};case"none":case"seen":return e.path.length<t.currentPath.length&&e.path.every((n,r)=>t.currentPath[r]===n)?(console.warn(`Recursive reference detected at ${t.currentPath.join("/")}! Defaulting to any`),{}):t.$refStrategy==="seen"?{}:void 0}},PIe=(e,t)=>{let n=0;for(;n<e.length&&n<t.length&&e[n]===t[n];n++);return[(e.length-n).toString(),...t.slice(n)].join("/")},DIe=(e,t,n)=>(e.description&&(n.description=e.description,t.markdownDescription&&(n.markdownDescription=e.description)),n),FIe=(e,t)=>{const n=eIe(t),r=typeof t=="object"&&t.definitions?Object.entries(t.definitions).reduce((l,[c,u])=>({...l,[c]:cs(u._def,{...n,currentPath:[...n.basePath,n.definitionPath,c]},!0)??{}}),{}):void 0,s=typeof t=="string"?t:(t==null?void 0:t.nameStrategy)==="title"||t==null?void 0:t.name,i=cs(e._def,s===void 0?n:{...n,currentPath:[...n.basePath,n.definitionPath,s]},!1)??{},a=typeof t=="object"&&t.name!==void 0&&t.nameStrategy==="title"?t.name:void 0;a!==void 0&&(i.title=a);const o=s===void 0?r?{...i,[n.definitionPath]:r}:i:{$ref:[...n.$refStrategy==="relative"?[]:n.basePath,n.definitionPath,s].join("/"),[n.definitionPath]:{...r,[s]:i}};return n.target==="jsonSchema7"?o.$schema="http://json-schema.org/draft-07/schema#":(n.target==="jsonSchema2019-09"||n.target==="openAi")&&(o.$schema="https://json-schema.org/draft/2019-09/schema#"),n.target==="openAi"&&("anyOf"in o||"oneOf"in o||"allOf"in o||"type"in o&&Array.isArray(o.type))&&console.warn("Warning: OpenAI may not support schemas with unions as roots! Try wrapping it in an object property."),o};var Rw={code:"0",name:"text",parse:e=>{if(typeof e!="string")throw new Error('"text" parts expect a string value.');return{type:"text",value:e}}},Nw={code:"3",name:"error",parse:e=>{if(typeof e!="string")throw new Error('"error" parts expect a string value.');return{type:"error",value:e}}},Mw={code:"4",name:"assistant_message",parse:e=>{if(e==null||typeof e!="object"||!("id"in e)||!("role"in e)||!("content"in e)||typeof e.id!="string"||typeof e.role!="string"||e.role!=="assistant"||!Array.isArray(e.content)||!e.content.every(t=>t!=null&&typeof t=="object"&&"type"in t&&t.type==="text"&&"text"in t&&t.text!=null&&typeof t.text=="object"&&"value"in t.text&&typeof t.text.value=="string"))throw new Error('"assistant_message" parts expect an object with an "id", "role", and "content" property.');return{type:"assistant_message",value:e}}},Iw={code:"5",name:"assistant_control_data",parse:e=>{if(e==null||typeof e!="object"||!("threadId"in e)||!("messageId"in e)||typeof e.threadId!="string"||typeof e.messageId!="string")throw new Error('"assistant_control_data" parts expect an object with a "threadId" and "messageId" property.');return{type:"assistant_control_data",value:{threadId:e.threadId,messageId:e.messageId}}}},jw={code:"6",name:"data_message",parse:e=>{if(e==null||typeof e!="object"||!("role"in e)||!("data"in e)||typeof e.role!="string"||e.role!=="data")throw new Error('"data_message" parts expect an object with a "role" and "data" property.');return{type:"data_message",value:e}}},LIe=[Rw,Nw,Mw,Iw,jw];Rw.code+"",Nw.code+"",Mw.code+"",Iw.code+"",jw.code+"";Rw.name+"",Rw.code,Nw.name+"",Nw.code,Mw.name+"",Mw.code,Iw.name+"",Iw.code,jw.name+"",jw.code;LIe.map(e=>e.code);function BIe(e){const t=["ROOT"];let n=-1,r=null;function s(l,c,u){switch(l){case'"':{n=c,t.pop(),t.push(u),t.push("INSIDE_STRING");break}case"f":case"t":case"n":{n=c,r=c,t.pop(),t.push(u),t.push("INSIDE_LITERAL");break}case"-":{t.pop(),t.push(u),t.push("INSIDE_NUMBER");break}case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":{n=c,t.pop(),t.push(u),t.push("INSIDE_NUMBER");break}case"{":{n=c,t.pop(),t.push(u),t.push("INSIDE_OBJECT_START");break}case"[":{n=c,t.pop(),t.push(u),t.push("INSIDE_ARRAY_START");break}}}function i(l,c){switch(l){case",":{t.pop(),t.push("INSIDE_OBJECT_AFTER_COMMA");break}case"}":{n=c,t.pop();break}}}function a(l,c){switch(l){case",":{t.pop(),t.push("INSIDE_ARRAY_AFTER_COMMA");break}case"]":{n=c,t.pop();break}}}for(let l=0;l<e.length;l++){const c=e[l];switch(t[t.length-1]){case"ROOT":s(c,l,"FINISH");break;case"INSIDE_OBJECT_START":{switch(c){case'"':{t.pop(),t.push("INSIDE_OBJECT_KEY");break}case"}":{n=l,t.pop();break}}break}case"INSIDE_OBJECT_AFTER_COMMA":{switch(c){case'"':{t.pop(),t.push("INSIDE_OBJECT_KEY");break}}break}case"INSIDE_OBJECT_KEY":{switch(c){case'"':{t.pop(),t.push("INSIDE_OBJECT_AFTER_KEY");break}}break}case"INSIDE_OBJECT_AFTER_KEY":{switch(c){case":":{t.pop(),t.push("INSIDE_OBJECT_BEFORE_VALUE");break}}break}case"INSIDE_OBJECT_BEFORE_VALUE":{s(c,l,"INSIDE_OBJECT_AFTER_VALUE");break}case"INSIDE_OBJECT_AFTER_VALUE":{i(c,l);break}case"INSIDE_STRING":{switch(c){case'"':{t.pop(),n=l;break}case"\\":{t.push("INSIDE_STRING_ESCAPE");break}default:n=l}break}case"INSIDE_ARRAY_START":{switch(c){case"]":{n=l,t.pop();break}default:{n=l,s(c,l,"INSIDE_ARRAY_AFTER_VALUE");break}}break}case"INSIDE_ARRAY_AFTER_VALUE":{switch(c){case",":{t.pop(),t.push("INSIDE_ARRAY_AFTER_COMMA");break}case"]":{n=l,t.pop();break}default:{n=l;break}}break}case"INSIDE_ARRAY_AFTER_COMMA":{s(c,l,"INSIDE_ARRAY_AFTER_VALUE");break}case"INSIDE_STRING_ESCAPE":{t.pop(),n=l;break}case"INSIDE_NUMBER":{switch(c){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":{n=l;break}case"e":case"E":case"-":case".":break;case",":{t.pop(),t[t.length-1]==="INSIDE_ARRAY_AFTER_VALUE"&&a(c,l),t[t.length-1]==="INSIDE_OBJECT_AFTER_VALUE"&&i(c,l);break}case"}":{t.pop(),t[t.length-1]==="INSIDE_OBJECT_AFTER_VALUE"&&i(c,l);break}case"]":{t.pop(),t[t.length-1]==="INSIDE_ARRAY_AFTER_VALUE"&&a(c,l);break}default:{t.pop();break}}break}case"INSIDE_LITERAL":{const d=e.substring(r,l+1);!"false".startsWith(d)&&!"true".startsWith(d)&&!"null".startsWith(d)?(t.pop(),t[t.length-1]==="INSIDE_OBJECT_AFTER_VALUE"?i(c,l):t[t.length-1]==="INSIDE_ARRAY_AFTER_VALUE"&&a(c,l)):n=l;break}}}let o=e.slice(0,n+1);for(let l=t.length-1;l>=0;l--)switch(t[l]){case"INSIDE_STRING":{o+='"';break}case"INSIDE_OBJECT_KEY":case"INSIDE_OBJECT_AFTER_KEY":case"INSIDE_OBJECT_AFTER_COMMA":case"INSIDE_OBJECT_START":case"INSIDE_OBJECT_BEFORE_VALUE":case"INSIDE_OBJECT_AFTER_VALUE":{o+="}";break}case"INSIDE_ARRAY_START":case"INSIDE_ARRAY_AFTER_COMMA":case"INSIDE_ARRAY_AFTER_VALUE":{o+="]";break}case"INSIDE_LITERAL":{const u=e.substring(r,e.length);"true".startsWith(u)?o+="true".slice(u.length):"false".startsWith(u)?o+="false".slice(u.length):"null".startsWith(u)&&(o+="null".slice(u.length))}}return o}function $Ie(e){if(e===void 0)return{value:void 0,state:"undefined-input"};let t=wm({text:e});return t.success?{value:t.value,state:"successful-parse"}:(t=wm({text:BIe(e)}),t.success?{value:t.value,state:"repaired-parse"}:{value:void 0,state:"failed-parse"})}var zIe={code:"0",name:"text",parse:e=>{if(typeof e!="string")throw new Error('"text" parts expect a string value.');return{type:"text",value:e}}},UIe={code:"2",name:"data",parse:e=>{if(!Array.isArray(e))throw new Error('"data" parts expect an array value.');return{type:"data",value:e}}},qIe={code:"3",name:"error",parse:e=>{if(typeof e!="string")throw new Error('"error" parts expect a string value.');return{type:"error",value:e}}},VIe={code:"8",name:"message_annotations",parse:e=>{if(!Array.isArray(e))throw new Error('"message_annotations" parts expect an array value.');return{type:"message_annotations",value:e}}},WIe={code:"9",name:"tool_call",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("toolName"in e)||typeof e.toolName!="string"||!("args"in e)||typeof e.args!="object")throw new Error('"tool_call" parts expect an object with a "toolCallId", "toolName", and "args" property.');return{type:"tool_call",value:e}}},HIe={code:"a",name:"tool_result",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("result"in e))throw new Error('"tool_result" parts expect an object with a "toolCallId" and a "result" property.');return{type:"tool_result",value:e}}},GIe={code:"b",name:"tool_call_streaming_start",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("toolName"in e)||typeof e.toolName!="string")throw new Error('"tool_call_streaming_start" parts expect an object with a "toolCallId" and "toolName" property.');return{type:"tool_call_streaming_start",value:e}}},KIe={code:"c",name:"tool_call_delta",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("argsTextDelta"in e)||typeof e.argsTextDelta!="string")throw new Error('"tool_call_delta" parts expect an object with a "toolCallId" and "argsTextDelta" property.');return{type:"tool_call_delta",value:e}}},YIe={code:"d",name:"finish_message",parse:e=>{if(e==null||typeof e!="object"||!("finishReason"in e)||typeof e.finishReason!="string")throw new Error('"finish_message" parts expect an object with a "finishReason" property.');const t={finishReason:e.finishReason};return"usage"in e&&e.usage!=null&&typeof e.usage=="object"&&"promptTokens"in e.usage&&"completionTokens"in e.usage&&(t.usage={promptTokens:typeof e.usage.promptTokens=="number"?e.usage.promptTokens:Number.NaN,completionTokens:typeof e.usage.completionTokens=="number"?e.usage.completionTokens:Number.NaN}),{type:"finish_message",value:t}}},ZIe={code:"e",name:"finish_step",parse:e=>{if(e==null||typeof e!="object"||!("finishReason"in e)||typeof e.finishReason!="string")throw new Error('"finish_step" parts expect an object with a "finishReason" property.');const t={finishReason:e.finishReason,isContinued:!1};return"usage"in e&&e.usage!=null&&typeof e.usage=="object"&&"promptTokens"in e.usage&&"completionTokens"in e.usage&&(t.usage={promptTokens:typeof e.usage.promptTokens=="number"?e.usage.promptTokens:Number.NaN,completionTokens:typeof e.usage.completionTokens=="number"?e.usage.completionTokens:Number.NaN}),"isContinued"in e&&typeof e.isContinued=="boolean"&&(t.isContinued=e.isContinued),{type:"finish_step",value:t}}},XIe={code:"f",name:"start_step",parse:e=>{if(e==null||typeof e!="object"||!("messageId"in e)||typeof e.messageId!="string")throw new Error('"start_step" parts expect an object with an "id" property.');return{type:"start_step",value:{messageId:e.messageId}}}},JIe={code:"g",name:"reasoning",parse:e=>{if(typeof e!="string")throw new Error('"reasoning" parts expect a string value.');return{type:"reasoning",value:e}}},QIe={code:"h",name:"source",parse:e=>{if(e==null||typeof e!="object")throw new Error('"source" parts expect a Source object.');return{type:"source",value:e}}},e3e={code:"i",name:"redacted_reasoning",parse:e=>{if(e==null||typeof e!="object"||!("data"in e)||typeof e.data!="string")throw new Error('"redacted_reasoning" parts expect an object with a "data" property.');return{type:"redacted_reasoning",value:{data:e.data}}}},t3e={code:"j",name:"reasoning_signature",parse:e=>{if(e==null||typeof e!="object"||!("signature"in e)||typeof e.signature!="string")throw new Error('"reasoning_signature" parts expect an object with a "signature" property.');return{type:"reasoning_signature",value:{signature:e.signature}}}},n3e={code:"k",name:"file",parse:e=>{if(e==null||typeof e!="object"||!("data"in e)||typeof e.data!="string"||!("mimeType"in e)||typeof e.mimeType!="string")throw new Error('"file" parts expect an object with a "data" and "mimeType" property.');return{type:"file",value:e}}},gT=[zIe,UIe,qIe,VIe,WIe,HIe,GIe,KIe,YIe,ZIe,XIe,JIe,QIe,e3e,t3e,n3e];Object.fromEntries(gT.map(e=>[e.code,e]));Object.fromEntries(gT.map(e=>[e.name,e.code]));gT.map(e=>e.code);function Ma(e,t){const n=gT.find(r=>r.name===e);if(!n)throw new Error(`Invalid stream part type: ${e}`);return`${n.code}:${JSON.stringify(t)}
`}function r3e(e,t){var n;const r=(n=void 0)!=null?n:!1;return CX(FIe(e,{$refStrategy:r?"root":"none",target:"jsonSchema7"}),{validate:s=>{const i=e.safeParse(s);return i.success?{success:!0,value:i.data}:{success:!1,error:i.error}}})}var Uj=Symbol.for("vercel.ai.schema");function CX(e,{validate:t}={}){return{[Uj]:!0,_type:void 0,[hC]:!0,jsonSchema:e,validate:t}}function s3e(e){return typeof e=="object"&&e!==null&&Uj in e&&e[Uj]===!0&&"jsonSchema"in e&&"validate"in e}function yT(e){return s3e(e)?e:r3e(e)}const x0=globalThis||void 0||self;var i3e=typeof globalThis=="object"?globalThis:typeof self=="object"?self:typeof window=="object"?window:typeof x0=="object"?x0:{},sm="1.9.0",r7=/^(\d+)\.(\d+)\.(\d+)(-(.+))?$/;function a3e(e){var t=new Set([e]),n=new Set,r=e.match(r7);if(!r)return function(){return!1};var s={major:+r[1],minor:+r[2],patch:+r[3],prerelease:r[4]};if(s.prerelease!=null)return function(l){return l===e};function i(o){return n.add(o),!1}function a(o){return t.add(o),!0}return function(l){if(t.has(l))return!0;if(n.has(l))return!1;var c=l.match(r7);if(!c)return i(l);var u={major:+c[1],minor:+c[2],patch:+c[3],prerelease:c[4]};return u.prerelease!=null||s.major!==u.major?i(l):s.major===0?s.minor===u.minor&&s.patch<=u.patch?a(l):i(l):s.minor<=u.minor?a(l):i(l)}}var o3e=a3e(sm),l3e=sm.split(".")[0],Ow=Symbol.for("opentelemetry.js.api."+l3e),Pw=i3e;function RD(e,t,n,r){var s;r===void 0&&(r=!1);var i=Pw[Ow]=(s=Pw[Ow])!==null&&s!==void 0?s:{version:sm};if(!r&&i[e]){var a=new Error("@opentelemetry/api: Attempted duplicate registration of API: "+e);return n.error(a.stack||a.message),!1}if(i.version!==sm){var a=new Error("@opentelemetry/api: Registration of version v"+i.version+" for "+e+" does not match previously registered API v"+sm);return n.error(a.stack||a.message),!1}return i[e]=t,n.debug("@opentelemetry/api: Registered a global for "+e+" v"+sm+"."),!0}function Dw(e){var t,n,r=(t=Pw[Ow])===null||t===void 0?void 0:t.version;if(!(!r||!o3e(r)))return(n=Pw[Ow])===null||n===void 0?void 0:n[e]}function ND(e,t){t.debug("@opentelemetry/api: Unregistering a global for "+e+" v"+sm+".");var n=Pw[Ow];n&&delete n[e]}var c3e=function(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),s,i=[],a;try{for(;(t===void 0||t-- >0)&&!(s=r.next()).done;)i.push(s.value)}catch(o){a={error:o}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(a)throw a.error}}return i},u3e=function(e,t,n){if(n||arguments.length===2)for(var r=0,s=t.length,i;r<s;r++)(i||!(r in t))&&(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))},d3e=function(){function e(t){this._namespace=t.namespace||"DiagComponentLogger"}return e.prototype.debug=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return zv("debug",this._namespace,t)},e.prototype.error=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return zv("error",this._namespace,t)},e.prototype.info=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return zv("info",this._namespace,t)},e.prototype.warn=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return zv("warn",this._namespace,t)},e.prototype.verbose=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return zv("verbose",this._namespace,t)},e}();function zv(e,t,n){var r=Dw("diag");if(r)return n.unshift(t),r[e].apply(r,u3e([],c3e(n),!1))}var il;(function(e){e[e.NONE=0]="NONE",e[e.ERROR=30]="ERROR",e[e.WARN=50]="WARN",e[e.INFO=60]="INFO",e[e.DEBUG=70]="DEBUG",e[e.VERBOSE=80]="VERBOSE",e[e.ALL=9999]="ALL"})(il||(il={}));function f3e(e,t){e<il.NONE?e=il.NONE:e>il.ALL&&(e=il.ALL),t=t||{};function n(r,s){var i=t[r];return typeof i=="function"&&e>=s?i.bind(t):function(){}}return{error:n("error",il.ERROR),warn:n("warn",il.WARN),info:n("info",il.INFO),debug:n("debug",il.DEBUG),verbose:n("verbose",il.VERBOSE)}}var h3e=function(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),s,i=[],a;try{for(;(t===void 0||t-- >0)&&!(s=r.next()).done;)i.push(s.value)}catch(o){a={error:o}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(a)throw a.error}}return i},p3e=function(e,t,n){if(n||arguments.length===2)for(var r=0,s=t.length,i;r<s;r++)(i||!(r in t))&&(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))},m3e="diag",ok=function(){function e(){function t(s){return function(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];var o=Dw("diag");if(o)return o[s].apply(o,p3e([],h3e(i),!1))}}var n=this,r=function(s,i){var a,o,l;if(i===void 0&&(i={logLevel:il.INFO}),s===n){var c=new Error("Cannot use diag as the logger for itself. Please use a DiagLogger implementation like ConsoleDiagLogger or a custom implementation");return n.error((a=c.stack)!==null&&a!==void 0?a:c.message),!1}typeof i=="number"&&(i={logLevel:i});var u=Dw("diag"),d=f3e((o=i.logLevel)!==null&&o!==void 0?o:il.INFO,s);if(u&&!i.suppressOverrideMessage){var h=(l=new Error().stack)!==null&&l!==void 0?l:"<failed to generate stacktrace>";u.warn("Current logger will be overwritten from "+h),d.warn("Current logger will overwrite one already registered from "+h)}return RD("diag",d,n,!0)};n.setLogger=r,n.disable=function(){ND(m3e,n)},n.createComponentLogger=function(s){return new d3e(s)},n.verbose=t("verbose"),n.debug=t("debug"),n.info=t("info"),n.warn=t("warn"),n.error=t("error")}return e.instance=function(){return this._instance||(this._instance=new e),this._instance},e}();function g3e(e){return Symbol.for(e)}var y3e=function(){function e(t){var n=this;n._currentContext=t?new Map(t):new Map,n.getValue=function(r){return n._currentContext.get(r)},n.setValue=function(r,s){var i=new e(n._currentContext);return i._currentContext.set(r,s),i},n.deleteValue=function(r){var s=new e(n._currentContext);return s._currentContext.delete(r),s}}return e}(),b3e=new y3e,v3e=function(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),s,i=[],a;try{for(;(t===void 0||t-- >0)&&!(s=r.next()).done;)i.push(s.value)}catch(o){a={error:o}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(a)throw a.error}}return i},x3e=function(e,t,n){if(n||arguments.length===2)for(var r=0,s=t.length,i;r<s;r++)(i||!(r in t))&&(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))},w3e=function(){function e(){}return e.prototype.active=function(){return b3e},e.prototype.with=function(t,n,r){for(var s=[],i=3;i<arguments.length;i++)s[i-3]=arguments[i];return n.call.apply(n,x3e([r],v3e(s),!1))},e.prototype.bind=function(t,n){return n},e.prototype.enable=function(){return this},e.prototype.disable=function(){return this},e}(),_3e=function(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),s,i=[],a;try{for(;(t===void 0||t-- >0)&&!(s=r.next()).done;)i.push(s.value)}catch(o){a={error:o}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(a)throw a.error}}return i},S3e=function(e,t,n){if(n||arguments.length===2)for(var r=0,s=t.length,i;r<s;r++)(i||!(r in t))&&(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))},CI="context",C3e=new w3e,kX=function(){function e(){}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalContextManager=function(t){return RD(CI,t,ok.instance())},e.prototype.active=function(){return this._getContextManager().active()},e.prototype.with=function(t,n,r){for(var s,i=[],a=3;a<arguments.length;a++)i[a-3]=arguments[a];return(s=this._getContextManager()).with.apply(s,S3e([t,n,r],_3e(i),!1))},e.prototype.bind=function(t,n){return this._getContextManager().bind(t,n)},e.prototype._getContextManager=function(){return Dw(CI)||C3e},e.prototype.disable=function(){this._getContextManager().disable(),ND(CI,ok.instance())},e}(),qj;(function(e){e[e.NONE=0]="NONE",e[e.SAMPLED=1]="SAMPLED"})(qj||(qj={}));var EX="0000000000000000",TX="00000000000000000000000000000000",k3e={traceId:TX,spanId:EX,traceFlags:qj.NONE},Tx=function(){function e(t){t===void 0&&(t=k3e),this._spanContext=t}return e.prototype.spanContext=function(){return this._spanContext},e.prototype.setAttribute=function(t,n){return this},e.prototype.setAttributes=function(t){return this},e.prototype.addEvent=function(t,n){return this},e.prototype.addLink=function(t){return this},e.prototype.addLinks=function(t){return this},e.prototype.setStatus=function(t){return this},e.prototype.updateName=function(t){return this},e.prototype.end=function(t){},e.prototype.isRecording=function(){return!1},e.prototype.recordException=function(t,n){},e}(),MD=g3e("OpenTelemetry Context Key SPAN");function ID(e){return e.getValue(MD)||void 0}function E3e(){return ID(kX.getInstance().active())}function jD(e,t){return e.setValue(MD,t)}function T3e(e){return e.deleteValue(MD)}function A3e(e,t){return jD(e,new Tx(t))}function AX(e){var t;return(t=ID(e))===null||t===void 0?void 0:t.spanContext()}var R3e=/^([0-9a-f]{32})$/i,N3e=/^[0-9a-f]{16}$/i;function M3e(e){return R3e.test(e)&&e!==TX}function I3e(e){return N3e.test(e)&&e!==EX}function RX(e){return M3e(e.traceId)&&I3e(e.spanId)}function j3e(e){return new Tx(e)}var kI=kX.getInstance(),NX=function(){function e(){}return e.prototype.startSpan=function(t,n,r){r===void 0&&(r=kI.active());var s=!!(n!=null&&n.root);if(s)return new Tx;var i=r&&AX(r);return O3e(i)&&RX(i)?new Tx(i):new Tx},e.prototype.startActiveSpan=function(t,n,r,s){var i,a,o;if(!(arguments.length<2)){arguments.length===2?o=n:arguments.length===3?(i=n,o=r):(i=n,a=r,o=s);var l=a??kI.active(),c=this.startSpan(t,i,l),u=jD(l,c);return kI.with(u,o,void 0,c)}},e}();function O3e(e){return typeof e=="object"&&typeof e.spanId=="string"&&typeof e.traceId=="string"&&typeof e.traceFlags=="number"}var P3e=new NX,D3e=function(){function e(t,n,r,s){this._provider=t,this.name=n,this.version=r,this.options=s}return e.prototype.startSpan=function(t,n,r){return this._getTracer().startSpan(t,n,r)},e.prototype.startActiveSpan=function(t,n,r,s){var i=this._getTracer();return Reflect.apply(i.startActiveSpan,i,arguments)},e.prototype._getTracer=function(){if(this._delegate)return this._delegate;var t=this._provider.getDelegateTracer(this.name,this.version,this.options);return t?(this._delegate=t,this._delegate):P3e},e}(),F3e=function(){function e(){}return e.prototype.getTracer=function(t,n,r){return new NX},e}(),L3e=new F3e,s7=function(){function e(){}return e.prototype.getTracer=function(t,n,r){var s;return(s=this.getDelegateTracer(t,n,r))!==null&&s!==void 0?s:new D3e(this,t,n,r)},e.prototype.getDelegate=function(){var t;return(t=this._delegate)!==null&&t!==void 0?t:L3e},e.prototype.setDelegate=function(t){this._delegate=t},e.prototype.getDelegateTracer=function(t,n,r){var s;return(s=this._delegate)===null||s===void 0?void 0:s.getTracer(t,n,r)},e}(),lk;(function(e){e[e.UNSET=0]="UNSET",e[e.OK=1]="OK",e[e.ERROR=2]="ERROR"})(lk||(lk={}));var EI="trace",B3e=function(){function e(){this._proxyTracerProvider=new s7,this.wrapSpanContext=j3e,this.isSpanContextValid=RX,this.deleteSpan=T3e,this.getSpan=ID,this.getActiveSpan=E3e,this.getSpanContext=AX,this.setSpan=jD,this.setSpanContext=A3e}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalTracerProvider=function(t){var n=RD(EI,this._proxyTracerProvider,ok.instance());return n&&this._proxyTracerProvider.setDelegate(t),n},e.prototype.getTracerProvider=function(){return Dw(EI)||this._proxyTracerProvider},e.prototype.getTracer=function(t,n){return this.getTracerProvider().getTracer(t,n)},e.prototype.disable=function(){ND(EI,ok.instance()),this._proxyTracerProvider=new s7},e}(),$3e=B3e.getInstance(),z3e=Object.defineProperty,OD=(e,t)=>{for(var n in t)z3e(e,n,{get:t[n],enumerable:!0})};function ck(e,{contentType:t,dataStreamVersion:n}){const r=new Headers(e??{});return r.has("Content-Type")||r.set("Content-Type",t),n!==void 0&&r.set("X-Vercel-AI-Data-Stream",n),r}function i7(e,{contentType:t,dataStreamVersion:n}){const r={};if(e!=null)for(const[s,i]of Object.entries(e))r[s]=i;return r["Content-Type"]==null&&(r["Content-Type"]=t),n!==void 0&&(r["X-Vercel-AI-Data-Stream"]=n),r}function a7({response:e,status:t,statusText:n,headers:r,stream:s}){e.writeHead(t??200,n,r);const i=s.getReader();(async()=>{try{for(;;){const{done:o,value:l}=await i.read();if(o)break;e.write(l)}}catch(o){throw o}finally{e.end()}})()}var MX="AI_InvalidArgumentError",IX=`vercel.ai.error.${MX}`,U3e=Symbol.for(IX),jX,vc=class extends nr{constructor({parameter:e,value:t,message:n}){super({name:MX,message:`Invalid argument for parameter ${e}: ${n}`}),this[jX]=!0,this.parameter=e,this.value=t}static isInstance(e){return nr.hasMarker(e,IX)}};jX=U3e;var OX="AI_RetryError",PX=`vercel.ai.error.${OX}`,q3e=Symbol.for(PX),DX,o7=class extends nr{constructor({message:e,reason:t,errors:n}){super({name:OX,message:e}),this[DX]=!0,this.reason=t,this.errors=n,this.lastError=n[n.length-1]}static isInstance(e){return nr.hasMarker(e,PX)}};DX=q3e;var V3e=({maxRetries:e=2,initialDelayInMs:t=2e3,backoffFactor:n=2}={})=>async r=>FX(r,{maxRetries:e,delayInMs:t,backoffFactor:n});async function FX(e,{maxRetries:t,delayInMs:n,backoffFactor:r},s=[]){try{return await e()}catch(i){if(R2(i)||t===0)throw i;const a=Eye(i),o=[...s,i],l=o.length;if(l>t)throw new o7({message:`Failed after ${l} attempts. Last error: ${a}`,reason:"maxRetriesExceeded",errors:o});if(i instanceof Error&&Vl.isInstance(i)&&i.isRetryable===!0&&l<=t)return await Cye(n),FX(e,{maxRetries:t,delayInMs:r*n,backoffFactor:r},o);throw l===1?i:new o7({message:`Failed after ${l} attempts with non-retryable error: '${a}'`,reason:"errorNotRetryable",errors:o})}}function W3e({maxRetries:e}){if(e!=null){if(!Number.isInteger(e))throw new vc({parameter:"maxRetries",value:e,message:"maxRetries must be an integer"});if(e<0)throw new vc({parameter:"maxRetries",value:e,message:"maxRetries must be >= 0"})}const t=e??2;return{maxRetries:t,retry:V3e({maxRetries:t})}}function Vj({operationId:e,telemetry:t}){return{"operation.name":`${e}${(t==null?void 0:t.functionId)!=null?` ${t.functionId}`:""}`,"resource.name":t==null?void 0:t.functionId,"ai.operationId":e,"ai.telemetry.functionId":t==null?void 0:t.functionId}}function H3e({model:e,settings:t,telemetry:n,headers:r}){var s;return{"ai.model.provider":e.provider,"ai.model.id":e.modelId,...Object.entries(t).reduce((i,[a,o])=>(i[`ai.settings.${a}`]=o,i),{}),...Object.entries((s=n==null?void 0:n.metadata)!=null?s:{}).reduce((i,[a,o])=>(i[`ai.telemetry.metadata.${a}`]=o,i),{}),...Object.entries(r??{}).reduce((i,[a,o])=>(o!==void 0&&(i[`ai.request.headers.${a}`]=o),i),{})}}var G3e={startSpan(){return KS},startActiveSpan(e,t,n,r){if(typeof t=="function")return t(KS);if(typeof n=="function")return n(KS);if(typeof r=="function")return r(KS)}},KS={spanContext(){return K3e},setAttribute(){return this},setAttributes(){return this},addEvent(){return this},addLink(){return this},addLinks(){return this},setStatus(){return this},updateName(){return this},end(){return this},isRecording(){return!1},recordException(){return this}},K3e={traceId:"",spanId:"",traceFlags:0};function Y3e({isEnabled:e=!1,tracer:t}={}){return e?t||$3e.getTracer("ai"):G3e}function Wj({name:e,tracer:t,attributes:n,fn:r,endWhenDone:s=!0}){return t.startActiveSpan(e,{attributes:n},async i=>{try{const a=await r(i);return s&&i.end(),a}catch(a){try{a instanceof Error?(i.recordException({name:a.name,message:a.message,stack:a.stack}),i.setStatus({code:lk.ERROR,message:a.message})):i.setStatus({code:lk.ERROR})}finally{i.end()}throw a}})}function w0({telemetry:e,attributes:t}){return(e==null?void 0:e.isEnabled)!==!0?{}:Object.entries(t).reduce((n,[r,s])=>{if(s===void 0)return n;if(typeof s=="object"&&"input"in s&&typeof s.input=="function"){if((e==null?void 0:e.recordInputs)===!1)return n;const i=s.input();return i===void 0?n:{...n,[r]:i}}if(typeof s=="object"&&"output"in s&&typeof s.output=="function"){if((e==null?void 0:e.recordOutputs)===!1)return n;const i=s.output();return i===void 0?n:{...n,[r]:i}}return{...n,[r]:s}},{})}var Z3e=class{constructor({data:e,mimeType:t}){const n=e instanceof Uint8Array;this.base64Data=n?void 0:e,this.uint8ArrayData=n?e:void 0,this.mimeType=t}get base64(){return this.base64Data==null&&(this.base64Data=Iu(this.uint8ArrayData)),this.base64Data}get uint8Array(){return this.uint8ArrayData==null&&(this.uint8ArrayData=EE(this.base64Data)),this.uint8ArrayData}},X3e=class extends Z3e{constructor(e){super(e),this.type="file"}},J3e=[{mimeType:"image/gif",bytesPrefix:[71,73,70],base64Prefix:"R0lG"},{mimeType:"image/png",bytesPrefix:[137,80,78,71],base64Prefix:"iVBORw"},{mimeType:"image/jpeg",bytesPrefix:[255,216],base64Prefix:"/9j/"},{mimeType:"image/webp",bytesPrefix:[82,73,70,70],base64Prefix:"UklGRg"},{mimeType:"image/bmp",bytesPrefix:[66,77],base64Prefix:"Qk"},{mimeType:"image/tiff",bytesPrefix:[73,73,42,0],base64Prefix:"SUkqAA"},{mimeType:"image/tiff",bytesPrefix:[77,77,0,42],base64Prefix:"TU0AKg"},{mimeType:"image/avif",bytesPrefix:[0,0,0,32,102,116,121,112,97,118,105,102],base64Prefix:"AAAAIGZ0eXBhdmlm"},{mimeType:"image/heic",bytesPrefix:[0,0,0,32,102,116,121,112,104,101,105,99],base64Prefix:"AAAAIGZ0eXBoZWlj"}],Q3e=e=>{const t=typeof e=="string"?EE(e):e,n=(t[6]&127)<<21|(t[7]&127)<<14|(t[8]&127)<<7|t[9]&127;return t.slice(n+10)};function eje(e){return typeof e=="string"&&e.startsWith("SUQz")||typeof e!="string"&&e.length>10&&e[0]===73&&e[1]===68&&e[2]===51?Q3e(e):e}function tje({data:e,signatures:t}){const n=eje(e);for(const r of t)if(typeof n=="string"?n.startsWith(r.base64Prefix):n.length>=r.bytesPrefix.length&&r.bytesPrefix.every((s,i)=>n[i]===s))return r.mimeType}var LX="AI_NoObjectGeneratedError",BX=`vercel.ai.error.${LX}`,nje=Symbol.for(BX),$X,l7=class extends nr{constructor({message:e="No object generated.",cause:t,text:n,response:r,usage:s,finishReason:i}){super({name:LX,message:e,cause:t}),this[$X]=!0,this.text=n,this.response=r,this.usage=s,this.finishReason=i}static isInstance(e){return nr.hasMarker(e,BX)}};$X=nje;var zX="AI_DownloadError",UX=`vercel.ai.error.${zX}`,rje=Symbol.for(UX),qX,TI=class extends nr{constructor({url:e,statusCode:t,statusText:n,cause:r,message:s=r==null?`Failed to download ${e}: ${t} ${n}`:`Failed to download ${e}: ${r}`}){super({name:zX,message:s,cause:r}),this[qX]=!0,this.url=e,this.statusCode=t,this.statusText=n}static isInstance(e){return nr.hasMarker(e,UX)}};qX=rje;async function sje({url:e}){var t;const n=e.toString();try{const r=await fetch(n);if(!r.ok)throw new TI({url:n,statusCode:r.status,statusText:r.statusText});return{data:new Uint8Array(await r.arrayBuffer()),mimeType:(t=r.headers.get("content-type"))!=null?t:void 0}}catch(r){throw TI.isInstance(r)?r:new TI({url:n,cause:r})}}var VX="AI_InvalidDataContentError",WX=`vercel.ai.error.${VX}`,ije=Symbol.for(WX),HX,c7=class extends nr{constructor({content:e,cause:t,message:n=`Invalid data content. Expected a base64 string, Uint8Array, ArrayBuffer, or Buffer, but got ${typeof e}.`}){super({name:VX,message:n,cause:t}),this[HX]=!0,this.content=e}static isInstance(e){return nr.hasMarker(e,WX)}};HX=ije;var GX=ms([ze(),kC(Uint8Array),kC(ArrayBuffer),wG(e=>{var t,n;return(n=(t=globalThis.Buffer)==null?void 0:t.isBuffer(e))!=null?n:!1},{message:"Must be a Buffer"})]);function PD(e){return typeof e=="string"?e:e instanceof ArrayBuffer?Iu(new Uint8Array(e)):Iu(e)}function uk(e){if(e instanceof Uint8Array)return e;if(typeof e=="string")try{return EE(e)}catch(t){throw new c7({message:"Invalid data content. Content string is not a base64-encoded media.",content:e,cause:t})}if(e instanceof ArrayBuffer)return new Uint8Array(e);throw new c7({content:e})}function aje(e){try{return new TextDecoder().decode(e)}catch{throw new Error("Error decoding Uint8Array to text")}}var KX="AI_InvalidMessageRoleError",YX=`vercel.ai.error.${KX}`,oje=Symbol.for(YX),ZX,lje=class extends nr{constructor({role:e,message:t=`Invalid message role: '${e}'. Must be one of: "system", "user", "assistant", "tool".`}){super({name:KX,message:t}),this[ZX]=!0,this.role=e}static isInstance(e){return nr.hasMarker(e,YX)}};ZX=oje;function cje(e){try{const[t,n]=e.split(",");return{mimeType:t.split(";")[0].split(":")[1],base64Content:n}}catch{return{mimeType:void 0,base64Content:void 0}}}async function uje({prompt:e,modelSupportsImageUrls:t=!0,modelSupportsUrl:n=()=>!1,downloadImplementation:r=sje}){const s=await fje(e.messages,r,t,n);return[...e.system!=null?[{role:"system",content:e.system}]:[],...e.messages.map(i=>dje(i,s))]}function dje(e,t){var n,r,s,i,a,o;const l=e.role;switch(l){case"system":return{role:"system",content:e.content,providerMetadata:(n=e.providerOptions)!=null?n:e.experimental_providerMetadata};case"user":return typeof e.content=="string"?{role:"user",content:[{type:"text",text:e.content}],providerMetadata:(r=e.providerOptions)!=null?r:e.experimental_providerMetadata}:{role:"user",content:e.content.map(c=>hje(c,t)).filter(c=>c.type!=="text"||c.text!==""),providerMetadata:(s=e.providerOptions)!=null?s:e.experimental_providerMetadata};case"assistant":return typeof e.content=="string"?{role:"assistant",content:[{type:"text",text:e.content}],providerMetadata:(i=e.providerOptions)!=null?i:e.experimental_providerMetadata}:{role:"assistant",content:e.content.filter(c=>c.type!=="text"||c.text!=="").map(c=>{var u;const d=(u=c.providerOptions)!=null?u:c.experimental_providerMetadata;switch(c.type){case"file":return{type:"file",data:c.data instanceof URL?c.data:PD(c.data),filename:c.filename,mimeType:c.mimeType,providerMetadata:d};case"reasoning":return{type:"reasoning",text:c.text,signature:c.signature,providerMetadata:d};case"redacted-reasoning":return{type:"redacted-reasoning",data:c.data,providerMetadata:d};case"text":return{type:"text",text:c.text,providerMetadata:d};case"tool-call":return{type:"tool-call",toolCallId:c.toolCallId,toolName:c.toolName,args:c.args,providerMetadata:d}}}),providerMetadata:(a=e.providerOptions)!=null?a:e.experimental_providerMetadata};case"tool":return{role:"tool",content:e.content.map(c=>{var u;return{type:"tool-result",toolCallId:c.toolCallId,toolName:c.toolName,result:c.result,content:c.experimental_content,isError:c.isError,providerMetadata:(u=c.providerOptions)!=null?u:c.experimental_providerMetadata}}),providerMetadata:(o=e.providerOptions)!=null?o:e.experimental_providerMetadata};default:{const c=l;throw new lje({role:c})}}}async function fje(e,t,n,r){const s=e.filter(a=>a.role==="user").map(a=>a.content).filter(a=>Array.isArray(a)).flat().filter(a=>a.type==="image"||a.type==="file").filter(a=>!(a.type==="image"&&n===!0)).map(a=>a.type==="image"?a.image:a.data).map(a=>typeof a=="string"&&(a.startsWith("http:")||a.startsWith("https:"))?new URL(a):a).filter(a=>a instanceof URL).filter(a=>!r(a)),i=await Promise.all(s.map(async a=>({url:a,data:await t({url:a})})));return Object.fromEntries(i.map(({url:a,data:o})=>[a.toString(),o]))}function hje(e,t){var n,r,s,i;if(e.type==="text")return{type:"text",text:e.text,providerMetadata:(n=e.providerOptions)!=null?n:e.experimental_providerMetadata};let a=e.mimeType,o,l,c;const u=e.type;switch(u){case"image":o=e.image;break;case"file":o=e.data;break;default:throw new Error(`Unsupported part type: ${u}`)}try{l=typeof o=="string"?new URL(o):o}catch{l=o}if(l instanceof URL)if(l.protocol==="data:"){const{mimeType:d,base64Content:h}=cje(l.toString());if(d==null||h==null)throw new Error(`Invalid data URL format in part ${u}`);a=d,c=uk(h)}else{const d=t[l.toString()];d?(c=d.data,a??(a=d.mimeType)):c=l}else c=uk(l);switch(u){case"image":return c instanceof Uint8Array&&(a=(r=tje({data:c,signatures:J3e}))!=null?r:a),{type:"image",image:c,mimeType:a,providerMetadata:(s=e.providerOptions)!=null?s:e.experimental_providerMetadata};case"file":{if(a==null)throw new Error("Mime type is missing for file part");return{type:"file",data:c instanceof Uint8Array?PD(c):c,filename:e.filename,mimeType:a,providerMetadata:(i=e.providerOptions)!=null?i:e.experimental_providerMetadata}}}}function pje({maxTokens:e,temperature:t,topP:n,topK:r,presencePenalty:s,frequencyPenalty:i,stopSequences:a,seed:o}){if(e!=null){if(!Number.isInteger(e))throw new vc({parameter:"maxTokens",value:e,message:"maxTokens must be an integer"});if(e<1)throw new vc({parameter:"maxTokens",value:e,message:"maxTokens must be >= 1"})}if(t!=null&&typeof t!="number")throw new vc({parameter:"temperature",value:t,message:"temperature must be a number"});if(n!=null&&typeof n!="number")throw new vc({parameter:"topP",value:n,message:"topP must be a number"});if(r!=null&&typeof r!="number")throw new vc({parameter:"topK",value:r,message:"topK must be a number"});if(s!=null&&typeof s!="number")throw new vc({parameter:"presencePenalty",value:s,message:"presencePenalty must be a number"});if(i!=null&&typeof i!="number")throw new vc({parameter:"frequencyPenalty",value:i,message:"frequencyPenalty must be a number"});if(o!=null&&!Number.isInteger(o))throw new vc({parameter:"seed",value:o,message:"seed must be an integer"});return{maxTokens:e,temperature:t??0,topP:n,topK:r,presencePenalty:s,frequencyPenalty:i,stopSequences:a!=null&&a.length>0?a:void 0,seed:o}}function u7(e){var t,n,r;const s=[];for(const i of e){let a;try{a=new URL(i.url)}catch{throw new Error(`Invalid URL: ${i.url}`)}switch(a.protocol){case"http:":case"https:":{if((t=i.contentType)!=null&&t.startsWith("image/"))s.push({type:"image",image:a});else{if(!i.contentType)throw new Error("If the attachment is not an image, it must specify a content type");s.push({type:"file",data:a,mimeType:i.contentType})}break}case"data:":{let o,l,c;try{[o,l]=i.url.split(","),c=o.split(";")[0].split(":")[1]}catch{throw new Error(`Error processing data URL: ${i.url}`)}if(c==null||l==null)throw new Error(`Invalid data URL format: ${i.url}`);if((n=i.contentType)!=null&&n.startsWith("image/"))s.push({type:"image",image:uk(l)});else if((r=i.contentType)!=null&&r.startsWith("text/"))s.push({type:"text",text:aje(uk(l))});else{if(!i.contentType)throw new Error("If the attachment is not an image or text, it must specify a content type");s.push({type:"file",data:l,mimeType:i.contentType})}break}default:throw new Error(`Unsupported URL protocol: ${a.protocol}`)}}return s}var XX="AI_MessageConversionError",JX=`vercel.ai.error.${XX}`,mje=Symbol.for(JX),QX,AI=class extends nr{constructor({originalMessage:e,message:t}){super({name:XX,message:t}),this[QX]=!0,this.originalMessage=e}static isInstance(e){return nr.hasMarker(e,JX)}};QX=mje;function gje(e,t){var n,r;const s=(n=t==null?void 0:t.tools)!=null?n:{},i=[];for(let a=0;a<e.length;a++){const o=e[a],l=a===e.length-1,{role:c,content:u,experimental_attachments:d}=o;switch(c){case"system":{i.push({role:"system",content:u});break}case"user":{if(o.parts==null)i.push({role:"user",content:d?[{type:"text",text:u},...u7(d)]:u});else{const h=o.parts.filter(m=>m.type==="text").map(m=>({type:"text",text:m.text}));i.push({role:"user",content:d?[...h,...u7(d)]:h})}break}case"assistant":{if(o.parts!=null){let y=function(){const w=[];for(const k of x)switch(k.type){case"file":case"text":{w.push(k);break}case"reasoning":{for(const C of k.details)switch(C.type){case"text":w.push({type:"reasoning",text:C.text,signature:C.signature});break;case"redacted":w.push({type:"redacted-reasoning",data:C.data});break}break}case"tool-invocation":w.push({type:"tool-call",toolCallId:k.toolInvocation.toolCallId,toolName:k.toolInvocation.toolName,args:k.toolInvocation.args});break;default:{const C=k;throw new Error(`Unsupported part: ${C}`)}}i.push({role:"assistant",content:w});const S=x.filter(k=>k.type==="tool-invocation").map(k=>k.toolInvocation);S.length>0&&i.push({role:"tool",content:S.map(k=>{if(!("result"in k))throw new AI({originalMessage:o,message:"ToolInvocation must have a result: "+JSON.stringify(k)});const{toolCallId:C,toolName:T,result:R}=k,N=s[T];return(N==null?void 0:N.experimental_toToolResultContent)!=null?{type:"tool-result",toolCallId:C,toolName:T,result:N.experimental_toToolResultContent(R),experimental_content:N.experimental_toToolResultContent(R)}:{type:"tool-result",toolCallId:C,toolName:T,result:R}})}),x=[],v=!1,b++},b=0,v=!1,x=[];for(const w of o.parts)switch(w.type){case"text":{v&&y(),x.push(w);break}case"file":case"reasoning":{x.push(w);break}case"tool-invocation":{((r=w.toolInvocation.step)!=null?r:0)!==b&&y(),x.push(w),v=!0;break}}y();break}const h=o.toolInvocations;if(h==null||h.length===0){i.push({role:"assistant",content:u});break}const m=h.reduce((y,b)=>{var v;return Math.max(y,(v=b.step)!=null?v:0)},0);for(let y=0;y<=m;y++){const b=h.filter(v=>{var x;return((x=v.step)!=null?x:0)===y});b.length!==0&&(i.push({role:"assistant",content:[...l&&u&&y===0?[{type:"text",text:u}]:[],...b.map(({toolCallId:v,toolName:x,args:w})=>({type:"tool-call",toolCallId:v,toolName:x,args:w}))]}),i.push({role:"tool",content:b.map(v=>{if(!("result"in v))throw new AI({originalMessage:o,message:"ToolInvocation must have a result: "+JSON.stringify(v)});const{toolCallId:x,toolName:w,result:S}=v,k=s[w];return(k==null?void 0:k.experimental_toToolResultContent)!=null?{type:"tool-result",toolCallId:x,toolName:w,result:k.experimental_toToolResultContent(S),experimental_content:k.experimental_toToolResultContent(S)}:{type:"tool-result",toolCallId:x,toolName:w,result:S}})}))}u&&!l&&i.push({role:"assistant",content:u});break}case"data":break;default:{const h=c;throw new AI({originalMessage:o,message:`Unsupported role: ${h}`})}}}return i}var Hj=fbe(()=>ms([dbe(),ze(),At(),Kn(),xh(ze(),Hj),on(Hj)])),ui=xh(ze(),xh(ze(),Hj)),yje=on(ms([Ke({type:Nn("text"),text:ze()}),Ke({type:Nn("image"),data:ze(),mimeType:ze().optional()})])),eJ=Ke({type:Nn("text"),text:ze(),providerOptions:ui.optional(),experimental_providerMetadata:ui.optional()}),bje=Ke({type:Nn("image"),image:ms([GX,kC(URL)]),mimeType:ze().optional(),providerOptions:ui.optional(),experimental_providerMetadata:ui.optional()}),tJ=Ke({type:Nn("file"),data:ms([GX,kC(URL)]),filename:ze().optional(),mimeType:ze(),providerOptions:ui.optional(),experimental_providerMetadata:ui.optional()}),vje=Ke({type:Nn("reasoning"),text:ze(),providerOptions:ui.optional(),experimental_providerMetadata:ui.optional()}),xje=Ke({type:Nn("redacted-reasoning"),data:ze(),providerOptions:ui.optional(),experimental_providerMetadata:ui.optional()}),wje=Ke({type:Nn("tool-call"),toolCallId:ze(),toolName:ze(),args:Wy(),providerOptions:ui.optional(),experimental_providerMetadata:ui.optional()}),_je=Ke({type:Nn("tool-result"),toolCallId:ze(),toolName:ze(),result:Wy(),content:yje.optional(),isError:Kn().optional(),providerOptions:ui.optional(),experimental_providerMetadata:ui.optional()}),Sje=Ke({role:Nn("system"),content:ze(),providerOptions:ui.optional(),experimental_providerMetadata:ui.optional()}),Cje=Ke({role:Nn("user"),content:ms([ze(),on(ms([eJ,bje,tJ]))]),providerOptions:ui.optional(),experimental_providerMetadata:ui.optional()}),kje=Ke({role:Nn("assistant"),content:ms([ze(),on(ms([eJ,tJ,vje,xje,wje]))]),providerOptions:ui.optional(),experimental_providerMetadata:ui.optional()}),Eje=Ke({role:Nn("tool"),content:on(_je),providerOptions:ui.optional(),experimental_providerMetadata:ui.optional()}),Tje=ms([Sje,Cje,kje,Eje]);function Aje({prompt:e,tools:t}){if(e.prompt==null&&e.messages==null)throw new xc({prompt:e,message:"prompt or messages must be defined"});if(e.prompt!=null&&e.messages!=null)throw new xc({prompt:e,message:"prompt and messages cannot be defined at the same time"});if(e.system!=null&&typeof e.system!="string")throw new xc({prompt:e,message:"system must be a string"});if(e.prompt!=null){if(typeof e.prompt!="string")throw new xc({prompt:e,message:"prompt must be a string"});return{type:"prompt",system:e.system,messages:[{role:"user",content:e.prompt}]}}if(e.messages!=null){const r=Rje(e.messages)==="ui-messages"?gje(e.messages,{tools:t}):e.messages;if(r.length===0)throw new xc({prompt:e,message:"messages must not be empty"});const s=Vy({value:r,schema:on(Tje)});if(!s.success)throw new xc({prompt:e,message:["message must be a CoreMessage or a UI message",`Validation error: ${s.error.message}`].join(`
`),cause:s.error});return{type:"messages",messages:r,system:e.system}}throw new Error("unreachable")}function Rje(e){if(!Array.isArray(e))throw new xc({prompt:e,message:["messages must be an array of CoreMessage or UIMessage",`Received non-array value: ${JSON.stringify(e)}`].join(`
`),cause:e});if(e.length===0)return"messages";const t=e.map(Nje);if(t.some(r=>r==="has-ui-specific-parts"))return"ui-messages";const n=t.findIndex(r=>r!=="has-core-specific-parts"&&r!=="message");if(n===-1)return"messages";throw new xc({prompt:e,message:["messages must be an array of CoreMessage or UIMessage",`Received message of type: "${t[n]}" at index ${n}`,`messages[${n}]: ${JSON.stringify(e[n])}`].join(`
`),cause:e})}function Nje(e){return typeof e=="object"&&e!==null&&(e.role==="function"||e.role==="data"||"toolInvocations"in e||"parts"in e||"experimental_attachments"in e)?"has-ui-specific-parts":typeof e=="object"&&e!==null&&"content"in e&&(Array.isArray(e.content)||"experimental_providerMetadata"in e||"providerOptions"in e)?"has-core-specific-parts":typeof e=="object"&&e!==null&&"role"in e&&"content"in e&&typeof e.content=="string"&&["system","user","assistant","tool"].includes(e.role)?"message":"other"}function Mje({promptTokens:e,completionTokens:t}){return{promptTokens:e,completionTokens:t,totalTokens:e+t}}function Ije(e,t){return{promptTokens:e.promptTokens+t.promptTokens,completionTokens:e.completionTokens+t.completionTokens,totalTokens:e.totalTokens+t.totalTokens}}var jje="JSON schema:",Oje="You MUST answer with a JSON object that matches the JSON schema above.",Pje="You MUST answer with JSON.";function Dje({prompt:e,schema:t,schemaPrefix:n=t!=null?jje:void 0,schemaSuffix:r=t!=null?Oje:Pje}){return[e!=null&&e.length>0?e:void 0,e!=null&&e.length>0?"":void 0,n,t!=null?JSON.stringify(t):void 0,r].filter(s=>s!=null).join(`
`)}function RI(e){const t=e.pipeThrough(new TransformStream);return t[Symbol.asyncIterator]=()=>{const n=t.getReader();return{async next(){const{done:r,value:s}=await n.read();return r?{done:!0,value:void 0}:{done:!1,value:s}}}},t}function Fje(e){const t=e.map(n=>({...n,content:typeof n.content=="string"?n.content:n.content.map(Lje)}));return JSON.stringify(t)}function Lje(e){return e.type==="image"?{...e,image:e.image instanceof Uint8Array?PD(e.image):e.image}:e}zm({prefix:"aiobj",size:24});var vo=class{constructor(){this.status={type:"pending"},this._resolve=void 0,this._reject=void 0}get value(){return this.promise?this.promise:(this.promise=new Promise((e,t)=>{this.status.type==="resolved"?e(this.status.value):this.status.type==="rejected"&&t(this.status.error),this._resolve=e,this._reject=t}),this.promise)}resolve(e){var t;this.status={type:"resolved",value:e},this.promise&&((t=this._resolve)==null||t.call(this,e))}reject(e){var t;this.status={type:"rejected",error:e},this.promise&&((t=this._reject)==null||t.call(this,e))}};function d7(){let e,t;return{promise:new Promise((r,s)=>{e=r,t=s}),resolve:e,reject:t}}function Bje(){let e=[],t=null,n=!1,r=d7();const s=async()=>{if(n&&e.length===0){t==null||t.close();return}if(e.length===0)return r=d7(),await r.promise,s();try{const{value:i,done:a}=await e[0].read();a?(e.shift(),e.length>0?await s():n&&(t==null||t.close())):t==null||t.enqueue(i)}catch(i){t==null||t.error(i),e.shift(),n&&e.length===0&&(t==null||t.close())}};return{stream:new ReadableStream({start(i){t=i},pull:s,async cancel(){for(const i of e)await i.cancel();e=[],n=!0}}),addStream:i=>{if(n)throw new Error("Cannot add inner stream: outer stream is closed");e.push(i.getReader()),r.resolve()},close:()=>{n=!0,r.resolve(),e.length===0&&(t==null||t.close())},terminate:()=>{n=!0,r.resolve(),e.forEach(i=>i.cancel()),e=[],t==null||t.close()}}}function $je(){var e,t;return(t=(e=globalThis==null?void 0:globalThis.performance)==null?void 0:e.now())!=null?t:Date.now()}zm({prefix:"aiobj",size:24});var nJ="AI_NoOutputSpecifiedError",rJ=`vercel.ai.error.${nJ}`,zje=Symbol.for(rJ),sJ,Uje=class extends nr{constructor({message:e="No output specified."}={}){super({name:nJ,message:e}),this[sJ]=!0}static isInstance(e){return nr.hasMarker(e,rJ)}};sJ=zje;var iJ="AI_ToolExecutionError",aJ=`vercel.ai.error.${iJ}`,qje=Symbol.for(aJ),oJ,Vje=class extends nr{constructor({toolArgs:e,toolName:t,toolCallId:n,cause:r,message:s=`Error executing tool ${t}: ${m1(r)}`}){super({name:iJ,message:s,cause:r}),this[oJ]=!0,this.toolArgs=e,this.toolName=t,this.toolCallId=n}static isInstance(e){return nr.hasMarker(e,aJ)}};oJ=qje;function Wje(e){return e!=null&&Object.keys(e).length>0}function Hje({tools:e,toolChoice:t,activeTools:n}){return Wje(e)?{tools:(n!=null?Object.entries(e).filter(([s])=>n.includes(s)):Object.entries(e)).map(([s,i])=>{const a=i.type;switch(a){case void 0:case"function":return{type:"function",name:s,description:i.description,parameters:yT(i.parameters).jsonSchema};case"provider-defined":return{type:"provider-defined",name:s,id:i.id,args:i.args};default:{const o=a;throw new Error(`Unsupported tool type: ${o}`)}}}),toolChoice:t==null?{type:"auto"}:typeof t=="string"?{type:t}:{type:"tool",toolName:t.toolName}}:{tools:void 0,toolChoice:void 0}}var Gje=/^([\s\S]*?)(\s+)(\S*)$/;function Kje(e){const t=e.match(Gje);return t?{prefix:t[1],whitespace:t[2],suffix:t[3]}:void 0}var lJ="AI_InvalidToolArgumentsError",cJ=`vercel.ai.error.${lJ}`,Yje=Symbol.for(cJ),uJ,dJ=class extends nr{constructor({toolArgs:e,toolName:t,cause:n,message:r=`Invalid arguments for tool ${t}: ${m1(n)}`}){super({name:lJ,message:r,cause:n}),this[uJ]=!0,this.toolArgs=e,this.toolName=t}static isInstance(e){return nr.hasMarker(e,cJ)}};uJ=Yje;var fJ="AI_NoSuchToolError",hJ=`vercel.ai.error.${fJ}`,Zje=Symbol.for(hJ),pJ,Gj=class extends nr{constructor({toolName:e,availableTools:t=void 0,message:n=`Model tried to call unavailable tool '${e}'. ${t===void 0?"No tools are available.":`Available tools: ${t.join(", ")}.`}`}){super({name:fJ,message:n}),this[pJ]=!0,this.toolName=e,this.availableTools=t}static isInstance(e){return nr.hasMarker(e,hJ)}};pJ=Zje;var mJ="AI_ToolCallRepairError",gJ=`vercel.ai.error.${mJ}`,Xje=Symbol.for(gJ),yJ,Jje=class extends nr{constructor({cause:e,originalError:t,message:n=`Error repairing tool call: ${m1(e)}`}){super({name:mJ,message:n,cause:e}),this[yJ]=!0,this.originalError=t}static isInstance(e){return nr.hasMarker(e,gJ)}};yJ=Xje;async function Qje({toolCall:e,tools:t,repairToolCall:n,system:r,messages:s}){if(t==null)throw new Gj({toolName:e.toolName});try{return await f7({toolCall:e,tools:t})}catch(i){if(n==null||!(Gj.isInstance(i)||dJ.isInstance(i)))throw i;let a=null;try{a=await n({toolCall:e,tools:t,parameterSchema:({toolName:o})=>yT(t[o].parameters).jsonSchema,system:r,messages:s,error:i})}catch(o){throw new Jje({cause:o,originalError:i})}if(a==null)throw i;return await f7({toolCall:a,tools:t})}}async function f7({toolCall:e,tools:t}){const n=e.toolName,r=t[n];if(r==null)throw new Gj({toolName:e.toolName,availableTools:Object.keys(t)});const s=yT(r.parameters),i=e.args.trim()===""?Vy({value:{},schema:s}):wm({text:e.args,schema:s});if(i.success===!1)throw new dJ({toolName:n,toolArgs:e.args,cause:i.error});return{type:"tool-call",toolCallId:e.toolCallId,toolName:n,args:i.value}}function e4e(e){const t=e.filter(n=>n.type==="text").map(n=>n.text).join("");return t.length>0?t:void 0}function h7({text:e="",files:t,reasoning:n,tools:r,toolCalls:s,toolResults:i,messageId:a,generateMessageId:o}){const l=[],c=[];return n.length>0&&c.push(...n.map(u=>u.type==="text"?{...u,type:"reasoning"}:{...u,type:"redacted-reasoning"})),t.length>0&&c.push(...t.map(u=>({type:"file",data:u.base64,mimeType:u.mimeType}))),e.length>0&&c.push({type:"text",text:e}),s.length>0&&c.push(...s),c.length>0&&l.push({role:"assistant",content:c,id:a}),i.length>0&&l.push({role:"tool",id:o(),content:i.map(u=>{const d=r[u.toolName];return(d==null?void 0:d.experimental_toToolResultContent)!=null?{type:"tool-result",toolCallId:u.toolCallId,toolName:u.toolName,result:d.experimental_toToolResultContent(u.result),experimental_content:d.experimental_toToolResultContent(u.result)}:{type:"tool-result",toolCallId:u.toolCallId,toolName:u.toolName,result:u.result}})}),l}zm({prefix:"aitxt",size:24});zm({prefix:"msg",size:24});var t4e={};OD(t4e,{object:()=>o4e,text:()=>a4e});var bJ="AI_InvalidStreamPartError",vJ=`vercel.ai.error.${bJ}`,n4e=Symbol.for(vJ),xJ,r4e=class extends nr{constructor({chunk:e,message:t}){super({name:bJ,message:t}),this[xJ]=!0,this.chunk=e}static isInstance(e){return nr.hasMarker(e,vJ)}};xJ=n4e;var s4e="AI_MCPClientError",wJ=`vercel.ai.error.${s4e}`,i4e=Symbol.for(wJ),_J,ra=class extends nr{constructor({name:e="MCPClientError",message:t,cause:n}){super({name:e,message:t,cause:n}),this[_J]=!0}static isInstance(e){return nr.hasMarker(e,wJ)}};_J=i4e;var a4e=()=>({type:"text",responseFormat:()=>({type:"text"}),injectIntoSystemPrompt({system:e}){return e},parsePartial({text:e}){return{partial:e}},parseOutput({text:e}){return e}}),o4e=({schema:e})=>{const t=yT(e);return{type:"object",responseFormat:({model:n})=>({type:"json",schema:n.supportsStructuredOutputs?t.jsonSchema:void 0}),injectIntoSystemPrompt({system:n,model:r}){return r.supportsStructuredOutputs?n:Dje({prompt:n,schema:t.jsonSchema})},parsePartial({text:n}){const r=$Ie(n);switch(r.state){case"failed-parse":case"undefined-input":return;case"repaired-parse":case"successful-parse":return{partial:r.value};default:{const s=r.state;throw new Error(`Unsupported parse state: ${s}`)}}},parseOutput({text:n},r){const s=wm({text:n});if(!s.success)throw new l7({message:"No object generated: could not parse the response.",cause:s.error,text:n,response:r.response,usage:r.usage,finishReason:r.finishReason});const i=Vy({value:s.value,schema:t});if(!i.success)throw new l7({message:"No object generated: response did not match schema.",cause:i.error,text:n,response:r.response,usage:r.usage,finishReason:r.finishReason});return i.value}}};function l4e(e){return e===void 0?[]:Array.isArray(e)?e:[e]}async function c4e({stream:e,onError:t}){const n=e.getReader();try{for(;;){const{done:r}=await n.read();if(r)break}}catch(r){t==null||t(r)}finally{n.releaseLock()}}function DD(e,t){const n=e.getReader(),r=t.getReader();let s,i,a=!1,o=!1;async function l(u){try{s==null&&(s=n.read());const d=await s;s=void 0,d.done?u.close():u.enqueue(d.value)}catch(d){u.error(d)}}async function c(u){try{i==null&&(i=r.read());const d=await i;i=void 0,d.done?u.close():u.enqueue(d.value)}catch(d){u.error(d)}}return new ReadableStream({async pull(u){try{if(a){await c(u);return}if(o){await l(u);return}s==null&&(s=n.read()),i==null&&(i=r.read());const{result:d,reader:h}=await Promise.race([s.then(m=>({result:m,reader:n})),i.then(m=>({result:m,reader:r}))]);d.done||u.enqueue(d.value),h===n?(s=void 0,d.done&&(await c(u),a=!0)):(i=void 0,d.done&&(o=!0,await l(u)))}catch(d){u.error(d)}},cancel(){n.cancel(),r.cancel()}})}function u4e({tools:e,generatorStream:t,toolCallStreaming:n,tracer:r,telemetry:s,system:i,messages:a,abortSignal:o,repairToolCall:l}){let c=null;const u=new ReadableStream({start(x){c=x}}),d={},h=new Set;let m=!1,y;function b(){m&&h.size===0&&(y!=null&&c.enqueue(y),c.close())}const v=new TransformStream({async transform(x,w){const S=x.type;switch(S){case"text-delta":case"reasoning":case"reasoning-signature":case"redacted-reasoning":case"source":case"response-metadata":case"error":{w.enqueue(x);break}case"file":{w.enqueue(new X3e({data:x.data,mimeType:x.mimeType}));break}case"tool-call-delta":{n&&(d[x.toolCallId]||(w.enqueue({type:"tool-call-streaming-start",toolCallId:x.toolCallId,toolName:x.toolName}),d[x.toolCallId]=!0),w.enqueue({type:"tool-call-delta",toolCallId:x.toolCallId,toolName:x.toolName,argsTextDelta:x.argsTextDelta}));break}case"tool-call":{try{const k=await Qje({toolCall:x,tools:e,repairToolCall:l,system:i,messages:a});w.enqueue(k);const C=e[k.toolName];if(C.execute!=null){const T=aa();h.add(T),Wj({name:"ai.toolCall",attributes:w0({telemetry:s,attributes:{...Vj({operationId:"ai.toolCall",telemetry:s}),"ai.toolCall.name":k.toolName,"ai.toolCall.id":k.toolCallId,"ai.toolCall.args":{output:()=>JSON.stringify(k.args)}}}),tracer:r,fn:async R=>C.execute(k.args,{toolCallId:k.toolCallId,messages:a,abortSignal:o}).then(N=>{c.enqueue({...k,type:"tool-result",result:N}),h.delete(T),b();try{R.setAttributes(w0({telemetry:s,attributes:{"ai.toolCall.result":{output:()=>JSON.stringify(N)}}}))}catch{}},N=>{c.enqueue({type:"error",error:new Vje({toolCallId:k.toolCallId,toolName:k.toolName,toolArgs:k.args,cause:N})}),h.delete(T),b()})})}}catch(k){c.enqueue({type:"error",error:k})}break}case"finish":{y={type:"finish",finishReason:x.finishReason,logprobs:x.logprobs,usage:Mje(x.usage),experimental_providerMetadata:x.providerMetadata};break}default:{const k=S;throw new Error(`Unhandled chunk type: ${k}`)}}},flush(){m=!0,b()}});return new ReadableStream({async start(x){return Promise.all([t.pipeThrough(v).pipeTo(new WritableStream({write(w){x.enqueue(w)},close(){}})),u.pipeTo(new WritableStream({write(w){x.enqueue(w)},close(){x.close()}}))])}})}var d4e=zm({prefix:"aitxt",size:24}),f4e=zm({prefix:"msg",size:24});function h4e({model:e,tools:t,toolChoice:n,system:r,prompt:s,messages:i,maxRetries:a,abortSignal:o,headers:l,maxSteps:c=1,experimental_generateMessageId:u=f4e,experimental_output:d,experimental_continueSteps:h=!1,experimental_telemetry:m,experimental_providerMetadata:y,providerOptions:b=y,experimental_toolCallStreaming:v=!1,toolCallStreaming:x=v,experimental_activeTools:w,experimental_repairToolCall:S,experimental_transform:k,onChunk:C,onError:T,onFinish:R,onStepFinish:N,_internal:{now:I=$je,generateId:P=d4e,currentDate:B=()=>new Date}={},...D}){return new m4e({model:e,telemetry:m,headers:l,settings:D,maxRetries:a,abortSignal:o,system:r,prompt:s,messages:i,tools:t,toolChoice:n,toolCallStreaming:x,transforms:l4e(k),activeTools:w,repairToolCall:S,maxSteps:c,output:d,continueSteps:h,providerOptions:b,onChunk:C,onError:T,onFinish:R,onStepFinish:N,now:I,currentDate:B,generateId:P,generateMessageId:u})}function p4e(e){if(!e)return new TransformStream({transform(i,a){a.enqueue({part:i,partialOutput:void 0})}});let t="",n="",r="";function s({controller:i,partialOutput:a=void 0}){i.enqueue({part:{type:"text-delta",textDelta:n},partialOutput:a}),n=""}return new TransformStream({transform(i,a){if(i.type==="step-finish"&&s({controller:a}),i.type!=="text-delta"){a.enqueue({part:i,partialOutput:void 0});return}t+=i.textDelta,n+=i.textDelta;const o=e.parsePartial({text:t});if(o!=null){const l=JSON.stringify(o.partial);l!==r&&(s({controller:a,partialOutput:o.partial}),r=l)}},flush(i){n.length>0&&s({controller:i})}})}var m4e=class{constructor({model:e,telemetry:t,headers:n,settings:r,maxRetries:s,abortSignal:i,system:a,prompt:o,messages:l,tools:c,toolChoice:u,toolCallStreaming:d,transforms:h,activeTools:m,repairToolCall:y,maxSteps:b,output:v,continueSteps:x,providerOptions:w,now:S,currentDate:k,generateId:C,generateMessageId:T,onChunk:R,onError:N,onFinish:I,onStepFinish:P}){this.warningsPromise=new vo,this.usagePromise=new vo,this.finishReasonPromise=new vo,this.providerMetadataPromise=new vo,this.textPromise=new vo,this.reasoningPromise=new vo,this.reasoningDetailsPromise=new vo,this.sourcesPromise=new vo,this.filesPromise=new vo,this.toolCallsPromise=new vo,this.toolResultsPromise=new vo,this.requestPromise=new vo,this.responsePromise=new vo,this.stepsPromise=new vo;var B;if(b<1)throw new vc({parameter:"maxSteps",value:b,message:"maxSteps must be at least 1"});this.output=v;let D="",W="",O="",Z=[],U=[],H,L=[];const te=[],V={id:C(),timestamp:k(),modelId:e.modelId,messages:[]};let Q=[],ee=[],se,pe,ue="initial";const Oe=[];let Fe;const Se=new TransformStream({async transform(ce,oe){oe.enqueue(ce);const{part:re}=ce;if((re.type==="text-delta"||re.type==="reasoning"||re.type==="source"||re.type==="tool-call"||re.type==="tool-result"||re.type==="tool-call-streaming-start"||re.type==="tool-call-delta")&&await(R==null?void 0:R({chunk:re})),re.type==="error"&&await(N==null?void 0:N({error:re.error})),re.type==="text-delta"&&(D+=re.textDelta,W+=re.textDelta,O+=re.textDelta),re.type==="reasoning"&&(H==null?(H={type:"text",text:re.textDelta},Z.push(H)):H.text+=re.textDelta),re.type==="reasoning-signature"){if(H==null)throw new nr({name:"InvalidStreamPart",message:"reasoning-signature without reasoning"});H.signature=re.signature,H=void 0}if(re.type==="redacted-reasoning"&&Z.push({type:"redacted",data:re.data}),re.type==="file"&&U.push(re),re.type==="source"&&(te.push(re.source),L.push(re.source)),re.type==="tool-call"&&Q.push(re),re.type==="tool-result"&&ee.push(re),re.type==="step-finish"){const Re=h7({text:W,files:U,reasoning:Z,tools:c??{},toolCalls:Q,toolResults:ee,messageId:re.messageId,generateMessageId:T}),Be=Oe.length;let Te="done";Be+1<b&&(x&&re.finishReason==="length"&&Q.length===0?Te="continue":Q.length>0&&ee.length===Q.length&&(Te="tool-result"));const lt={stepType:ue,text:D,reasoning:e4e(Z),reasoningDetails:Z,files:U,sources:L,toolCalls:Q,toolResults:ee,finishReason:re.finishReason,usage:re.usage,warnings:re.warnings,logprobs:re.logprobs,request:re.request,response:{...re.response,messages:[...V.messages,...Re]},providerMetadata:re.experimental_providerMetadata,experimental_providerMetadata:re.experimental_providerMetadata,isContinued:re.isContinued};await(P==null?void 0:P(lt)),Oe.push(lt),Q=[],ee=[],D="",L=[],Z=[],U=[],H=void 0,Te!=="done"&&(ue=Te),Te!=="continue"&&(V.messages.push(...Re),W="")}re.type==="finish"&&(V.id=re.response.id,V.timestamp=re.response.timestamp,V.modelId=re.response.modelId,V.headers=re.response.headers,pe=re.usage,se=re.finishReason)},async flush(ce){var oe;try{if(Oe.length===0)return;const re=Oe[Oe.length-1];Ne.warningsPromise.resolve(re.warnings),Ne.requestPromise.resolve(re.request),Ne.responsePromise.resolve(re.response),Ne.toolCallsPromise.resolve(re.toolCalls),Ne.toolResultsPromise.resolve(re.toolResults),Ne.providerMetadataPromise.resolve(re.experimental_providerMetadata),Ne.reasoningPromise.resolve(re.reasoning),Ne.reasoningDetailsPromise.resolve(re.reasoningDetails);const Re=se??"unknown",Be=pe??{completionTokens:NaN,promptTokens:NaN,totalTokens:NaN};Ne.finishReasonPromise.resolve(Re),Ne.usagePromise.resolve(Be),Ne.textPromise.resolve(O),Ne.sourcesPromise.resolve(te),Ne.filesPromise.resolve(re.files),Ne.stepsPromise.resolve(Oe),await(I==null?void 0:I({finishReason:Re,logprobs:void 0,usage:Be,text:O,reasoning:re.reasoning,reasoningDetails:re.reasoningDetails,files:re.files,sources:re.sources,toolCalls:re.toolCalls,toolResults:re.toolResults,request:(oe=re.request)!=null?oe:{},response:re.response,warnings:re.warnings,providerMetadata:re.providerMetadata,experimental_providerMetadata:re.experimental_providerMetadata,steps:Oe})),Fe.setAttributes(w0({telemetry:t,attributes:{"ai.response.finishReason":Re,"ai.response.text":{output:()=>O},"ai.response.toolCalls":{output:()=>{var Te;return(Te=re.toolCalls)!=null&&Te.length?JSON.stringify(re.toolCalls):void 0}},"ai.usage.promptTokens":Be.promptTokens,"ai.usage.completionTokens":Be.completionTokens}}))}catch(re){ce.error(re)}finally{Fe.end()}}}),Ce=Bje();this.addStream=Ce.addStream,this.closeStream=Ce.close;let qe=Ce.stream;for(const ce of h)qe=qe.pipeThrough(ce({tools:c,stopStream(){Ce.terminate()}}));this.baseStream=qe.pipeThrough(p4e(v)).pipeThrough(Se);const{maxRetries:Qe,retry:We}=W3e({maxRetries:s}),Ie=Y3e(t),K=H3e({model:e,telemetry:t,headers:n,settings:{...r,maxRetries:Qe}}),ye=Aje({prompt:{system:(B=v==null?void 0:v.injectIntoSystemPrompt({system:a,model:e}))!=null?B:a,prompt:o,messages:l},tools:c}),Ne=this;Wj({name:"ai.streamText",attributes:w0({telemetry:t,attributes:{...Vj({operationId:"ai.streamText",telemetry:t}),...K,"ai.prompt":{input:()=>JSON.stringify({system:a,prompt:o,messages:l})},"ai.settings.maxSteps":b}}),tracer:Ie,endWhenDone:!1,fn:async ce=>{Fe=ce;async function oe({currentStep:re,responseMessages:Re,usage:Be,stepType:Te,previousStepText:lt,hasLeadingWhitespace:Tt,messageId:ut}){var jt;const qt=Re.length===0?ye.type:"messages",Ft=[...ye.messages,...Re],Ht=await uje({prompt:{type:qt,system:ye.system,messages:Ft},modelSupportsImageUrls:e.supportsImageUrls,modelSupportsUrl:(jt=e.supportsUrl)==null?void 0:jt.bind(e)}),we={type:"regular",...Hje({tools:c,toolChoice:u,activeTools:m})},{result:{stream:F,warnings:X,rawResponse:be,request:ke},doStreamSpan:ge,startTimestampMs:Ee}=await We(()=>Wj({name:"ai.streamText.doStream",attributes:w0({telemetry:t,attributes:{...Vj({operationId:"ai.streamText.doStream",telemetry:t}),...K,"ai.prompt.format":{input:()=>qt},"ai.prompt.messages":{input:()=>Fje(Ht)},"ai.prompt.tools":{input:()=>{var Zt;return(Zt=we.tools)==null?void 0:Zt.map(nn=>JSON.stringify(nn))}},"ai.prompt.toolChoice":{input:()=>we.toolChoice!=null?JSON.stringify(we.toolChoice):void 0},"gen_ai.system":e.provider,"gen_ai.request.model":e.modelId,"gen_ai.request.frequency_penalty":r.frequencyPenalty,"gen_ai.request.max_tokens":r.maxTokens,"gen_ai.request.presence_penalty":r.presencePenalty,"gen_ai.request.stop_sequences":r.stopSequences,"gen_ai.request.temperature":r.temperature,"gen_ai.request.top_k":r.topK,"gen_ai.request.top_p":r.topP}}),tracer:Ie,endWhenDone:!1,fn:async Zt=>({startTimestampMs:S(),doStreamSpan:Zt,result:await e.doStream({mode:we,...pje(r),inputFormat:qt,responseFormat:v==null?void 0:v.responseFormat({model:e}),prompt:Ht,providerMetadata:w,abortSignal:i,headers:n})})})),le=u4e({tools:c,generatorStream:F,toolCallStreaming:d,tracer:Ie,telemetry:t,system:a,messages:Ft,repairToolCall:y,abortSignal:i}),dt=ke??{},et=[],$=[],Ue=[],tt=[];let ve,_e="unknown",$e={promptTokens:0,completionTokens:0,totalTokens:0},Ct,fe=!0,Y="",G=Te==="continue"?lt:"",J,xe={id:C(),timestamp:k(),modelId:e.modelId},De="",He=!1,xt=!0,Qt=!1;async function On({controller:Zt,chunk:nn}){Zt.enqueue(nn),Y+=nn.textDelta,G+=nn.textDelta,He=!0,Qt=nn.textDelta.trimEnd()!==nn.textDelta}Ne.addStream(le.pipeThrough(new TransformStream({async transform(Zt,nn){var un,gr,Nr;if(fe){const rs=S()-Ee;fe=!1,ge.addEvent("ai.stream.firstChunk",{"ai.response.msToFirstChunk":rs}),ge.setAttributes({"ai.response.msToFirstChunk":rs}),nn.enqueue({type:"step-start",messageId:ut,request:dt,warnings:X??[]})}if(Zt.type==="text-delta"&&Zt.textDelta.length===0)return;const ns=Zt.type;switch(ns){case"text-delta":{if(x){const rs=xt&&Tt?Zt.textDelta.trimStart():Zt.textDelta;if(rs.length===0)break;xt=!1,De+=rs;const kr=Kje(De);kr!=null&&(De=kr.suffix,await On({controller:nn,chunk:{type:"text-delta",textDelta:kr.prefix+kr.whitespace}}))}else await On({controller:nn,chunk:Zt});break}case"reasoning":{nn.enqueue(Zt),ve==null?(ve={type:"text",text:Zt.textDelta},Ue.push(ve)):ve.text+=Zt.textDelta;break}case"reasoning-signature":{if(nn.enqueue(Zt),ve==null)throw new r4e({chunk:Zt,message:"reasoning-signature without reasoning"});ve.signature=Zt.signature,ve=void 0;break}case"redacted-reasoning":{nn.enqueue(Zt),Ue.push({type:"redacted",data:Zt.data});break}case"tool-call":{nn.enqueue(Zt),et.push(Zt);break}case"tool-result":{nn.enqueue(Zt),$.push(Zt);break}case"response-metadata":{xe={id:(un=Zt.id)!=null?un:xe.id,timestamp:(gr=Zt.timestamp)!=null?gr:xe.timestamp,modelId:(Nr=Zt.modelId)!=null?Nr:xe.modelId};break}case"finish":{$e=Zt.usage,_e=Zt.finishReason,Ct=Zt.experimental_providerMetadata,J=Zt.logprobs;const rs=S()-Ee;ge.addEvent("ai.stream.finish"),ge.setAttributes({"ai.response.msToFinish":rs,"ai.response.avgCompletionTokensPerSecond":1e3*$e.completionTokens/rs});break}case"file":{tt.push(Zt),nn.enqueue(Zt);break}case"source":case"tool-call-streaming-start":case"tool-call-delta":{nn.enqueue(Zt);break}case"error":{nn.enqueue(Zt),_e="error";break}default:{const rs=ns;throw new Error(`Unknown chunk type: ${rs}`)}}},async flush(Zt){const nn=et.length>0?JSON.stringify(et):void 0;let un="done";re+1<b&&(x&&_e==="length"&&et.length===0?un="continue":et.length>0&&$.length===et.length&&(un="tool-result")),x&&De.length>0&&(un!=="continue"||Te==="continue"&&!He)&&(await On({controller:Zt,chunk:{type:"text-delta",textDelta:De}}),De="");try{ge.setAttributes(w0({telemetry:t,attributes:{"ai.response.finishReason":_e,"ai.response.text":{output:()=>Y},"ai.response.toolCalls":{output:()=>nn},"ai.response.id":xe.id,"ai.response.model":xe.modelId,"ai.response.timestamp":xe.timestamp.toISOString(),"ai.usage.promptTokens":$e.promptTokens,"ai.usage.completionTokens":$e.completionTokens,"gen_ai.response.finish_reasons":[_e],"gen_ai.response.id":xe.id,"gen_ai.response.model":xe.modelId,"gen_ai.usage.input_tokens":$e.promptTokens,"gen_ai.usage.output_tokens":$e.completionTokens}}))}catch{}finally{ge.end()}Zt.enqueue({type:"step-finish",finishReason:_e,usage:$e,providerMetadata:Ct,experimental_providerMetadata:Ct,logprobs:J,request:dt,response:{...xe,headers:be==null?void 0:be.headers},warnings:X,isContinued:un==="continue",messageId:ut});const gr=Ije(Be,$e);if(un==="done")Zt.enqueue({type:"finish",finishReason:_e,usage:gr,providerMetadata:Ct,experimental_providerMetadata:Ct,logprobs:J,response:{...xe,headers:be==null?void 0:be.headers}}),Ne.closeStream();else{if(Te==="continue"){const Nr=Re[Re.length-1];typeof Nr.content=="string"?Nr.content+=Y:Nr.content.push({text:Y,type:"text"})}else Re.push(...h7({text:Y,files:tt,reasoning:Ue,tools:c??{},toolCalls:et,toolResults:$,messageId:ut,generateMessageId:T}));await oe({currentStep:re+1,responseMessages:Re,usage:gr,stepType:un,previousStepText:G,hasLeadingWhitespace:Qt,messageId:un==="continue"?ut:T()})}}})))}await oe({currentStep:0,responseMessages:[],usage:{promptTokens:0,completionTokens:0,totalTokens:0},previousStepText:"",stepType:"initial",hasLeadingWhitespace:!1,messageId:T()})}}).catch(ce=>{Ne.addStream(new ReadableStream({start(oe){oe.enqueue({type:"error",error:ce}),oe.close()}})),Ne.closeStream()})}get warnings(){return this.warningsPromise.value}get usage(){return this.usagePromise.value}get finishReason(){return this.finishReasonPromise.value}get experimental_providerMetadata(){return this.providerMetadataPromise.value}get providerMetadata(){return this.providerMetadataPromise.value}get text(){return this.textPromise.value}get reasoning(){return this.reasoningPromise.value}get reasoningDetails(){return this.reasoningDetailsPromise.value}get sources(){return this.sourcesPromise.value}get files(){return this.filesPromise.value}get toolCalls(){return this.toolCallsPromise.value}get toolResults(){return this.toolResultsPromise.value}get request(){return this.requestPromise.value}get response(){return this.responsePromise.value}get steps(){return this.stepsPromise.value}teeStream(){const[e,t]=this.baseStream.tee();return this.baseStream=t,e}get textStream(){return RI(this.teeStream().pipeThrough(new TransformStream({transform({part:e},t){e.type==="text-delta"&&t.enqueue(e.textDelta)}})))}get fullStream(){return RI(this.teeStream().pipeThrough(new TransformStream({transform({part:e},t){t.enqueue(e)}})))}async consumeStream(e){var t;try{await c4e({stream:this.fullStream,onError:e==null?void 0:e.onError})}catch(n){(t=e==null?void 0:e.onError)==null||t.call(e,n)}}get experimental_partialOutputStream(){if(this.output==null)throw new Uje;return RI(this.teeStream().pipeThrough(new TransformStream({transform({partialOutput:e},t){e!=null&&t.enqueue(e)}})))}toDataStreamInternal({getErrorMessage:e=()=>"An error occurred.",sendUsage:t=!0,sendReasoning:n=!1,sendSources:r=!1,experimental_sendFinish:s=!0}){return this.fullStream.pipeThrough(new TransformStream({transform:async(i,a)=>{const o=i.type;switch(o){case"text-delta":{a.enqueue(Ma("text",i.textDelta));break}case"reasoning":{n&&a.enqueue(Ma("reasoning",i.textDelta));break}case"redacted-reasoning":{n&&a.enqueue(Ma("redacted_reasoning",{data:i.data}));break}case"reasoning-signature":{n&&a.enqueue(Ma("reasoning_signature",{signature:i.signature}));break}case"file":{a.enqueue(Ma("file",{mimeType:i.mimeType,data:i.base64}));break}case"source":{r&&a.enqueue(Ma("source",i.source));break}case"tool-call-streaming-start":{a.enqueue(Ma("tool_call_streaming_start",{toolCallId:i.toolCallId,toolName:i.toolName}));break}case"tool-call-delta":{a.enqueue(Ma("tool_call_delta",{toolCallId:i.toolCallId,argsTextDelta:i.argsTextDelta}));break}case"tool-call":{a.enqueue(Ma("tool_call",{toolCallId:i.toolCallId,toolName:i.toolName,args:i.args}));break}case"tool-result":{a.enqueue(Ma("tool_result",{toolCallId:i.toolCallId,result:i.result}));break}case"error":{a.enqueue(Ma("error",e(i.error)));break}case"step-start":{a.enqueue(Ma("start_step",{messageId:i.messageId}));break}case"step-finish":{a.enqueue(Ma("finish_step",{finishReason:i.finishReason,usage:t?{promptTokens:i.usage.promptTokens,completionTokens:i.usage.completionTokens}:void 0,isContinued:i.isContinued}));break}case"finish":{s&&a.enqueue(Ma("finish_message",{finishReason:i.finishReason,usage:t?{promptTokens:i.usage.promptTokens,completionTokens:i.usage.completionTokens}:void 0}));break}default:{const l=o;throw new Error(`Unknown chunk type: ${l}`)}}}}))}pipeDataStreamToResponse(e,{status:t,statusText:n,headers:r,data:s,getErrorMessage:i,sendUsage:a,sendReasoning:o,sendSources:l,experimental_sendFinish:c}={}){a7({response:e,status:t,statusText:n,headers:i7(r,{contentType:"text/plain; charset=utf-8",dataStreamVersion:"v1"}),stream:this.toDataStream({data:s,getErrorMessage:i,sendUsage:a,sendReasoning:o,sendSources:l,experimental_sendFinish:c})})}pipeTextStreamToResponse(e,t){a7({response:e,status:t==null?void 0:t.status,statusText:t==null?void 0:t.statusText,headers:i7(t==null?void 0:t.headers,{contentType:"text/plain; charset=utf-8"}),stream:this.textStream.pipeThrough(new TextEncoderStream)})}toDataStream(e){const t=this.toDataStreamInternal({getErrorMessage:e==null?void 0:e.getErrorMessage,sendUsage:e==null?void 0:e.sendUsage,sendReasoning:e==null?void 0:e.sendReasoning,sendSources:e==null?void 0:e.sendSources,experimental_sendFinish:e==null?void 0:e.experimental_sendFinish}).pipeThrough(new TextEncoderStream);return e!=null&&e.data?DD(e==null?void 0:e.data.stream,t):t}mergeIntoDataStream(e,t){e.merge(this.toDataStreamInternal({getErrorMessage:e.onError,sendUsage:t==null?void 0:t.sendUsage,sendReasoning:t==null?void 0:t.sendReasoning,sendSources:t==null?void 0:t.sendSources,experimental_sendFinish:t==null?void 0:t.experimental_sendFinish}))}toDataStreamResponse({headers:e,status:t,statusText:n,data:r,getErrorMessage:s,sendUsage:i,sendReasoning:a,sendSources:o,experimental_sendFinish:l}={}){return new Response(this.toDataStream({data:r,getErrorMessage:s,sendUsage:i,sendReasoning:a,sendSources:o,experimental_sendFinish:l}),{status:t,statusText:n,headers:ck(e,{contentType:"text/plain; charset=utf-8",dataStreamVersion:"v1"})})}toTextStreamResponse(e){var t;return new Response(this.textStream.pipeThrough(new TextEncoderStream),{status:(t=e==null?void 0:e.status)!=null?t:200,headers:ck(e==null?void 0:e.headers,{contentType:"text/plain; charset=utf-8"})})}};var SJ="2024-11-05",g4e=[SJ,"2024-10-07"],y4e=Ke({name:ze(),version:ze()}).passthrough(),FD=Ke({_meta:sa(Ke({}).passthrough())}).passthrough(),Fw=FD,b4e=Ke({method:ze(),params:sa(FD)}),v4e=Ke({experimental:sa(Ke({}).passthrough()),logging:sa(Ke({}).passthrough()),prompts:sa(Ke({listChanged:sa(Kn())}).passthrough()),resources:sa(Ke({subscribe:sa(Kn()),listChanged:sa(Kn())}).passthrough()),tools:sa(Ke({listChanged:sa(Kn())}).passthrough())}).passthrough(),x4e=Fw.extend({protocolVersion:ze(),capabilities:v4e,serverInfo:y4e,instructions:sa(ze())}),w4e=Fw.extend({nextCursor:sa(ze())}),_4e=Ke({name:ze(),description:sa(ze()),inputSchema:Ke({type:Nn("object"),properties:sa(Ke({}).passthrough())}).passthrough()}).passthrough(),S4e=w4e.extend({tools:on(_4e)}),C4e=Ke({type:Nn("text"),text:ze()}).passthrough(),k4e=Ke({type:Nn("image"),data:ze().base64(),mimeType:ze()}).passthrough(),CJ=Ke({uri:ze(),mimeType:sa(ze())}).passthrough(),E4e=CJ.extend({text:ze()}),T4e=CJ.extend({blob:ze().base64()}),A4e=Ke({type:Nn("resource"),resource:ms([E4e,T4e])}).passthrough(),R4e=Fw.extend({content:on(ms([C4e,k4e,A4e])),isError:Kn().default(!1).optional()}).or(Fw.extend({toolResult:Wy()})),bT="2.0",N4e=Ke({jsonrpc:Nn(bT),id:ms([ze(),At().int()])}).merge(b4e).strict(),M4e=Ke({jsonrpc:Nn(bT),id:ms([ze(),At().int()]),result:Fw}).strict(),I4e=Ke({jsonrpc:Nn(bT),id:ms([ze(),At().int()]),error:Ke({code:At().int(),message:ze(),data:sa(Wy())})}).strict(),j4e=Ke({jsonrpc:Nn(bT)}).merge(Ke({method:ze(),params:sa(FD)})).strict(),O4e=ms([N4e,j4e,M4e,I4e]),P4e=class{constructor({url:e,headers:t}){this.connected=!1,this.url=new URL(e),this.headers=t}async start(){return new Promise((e,t)=>{if(this.connected)return e();this.abortController=new AbortController,(async()=>{var r,s,i;try{const a=new Headers(this.headers);a.set("Accept","text/event-stream");const o=await fetch(this.url.href,{headers:a,signal:(r=this.abortController)==null?void 0:r.signal});if(!o.ok||!o.body){const d=new ra({message:`MCP SSE Transport Error: ${o.status} ${o.statusText}`});return(s=this.onerror)==null||s.call(this,d),t(d)}const c=o.body.pipeThrough(new TextDecoderStream).pipeThrough(mG()).getReader(),u=async()=>{var d,h,m;try{for(;;){const{done:y,value:b}=await c.read();if(y){if(this.connected)throw this.connected=!1,new ra({message:"MCP SSE Transport Error: Connection closed unexpectedly"});return}const{event:v,data:x}=b;if(v==="endpoint"){if(this.endpoint=new URL(x,this.url),this.endpoint.origin!==this.url.origin)throw new ra({message:`MCP SSE Transport Error: Endpoint origin does not match connection origin: ${this.endpoint.origin}`});this.connected=!0,e()}else if(v==="message")try{const w=O4e.parse(JSON.parse(x));(d=this.onmessage)==null||d.call(this,w)}catch(w){const S=new ra({message:"MCP SSE Transport Error: Failed to parse message",cause:w});(h=this.onerror)==null||h.call(this,S)}}}catch(y){if(y instanceof Error&&y.name==="AbortError")return;(m=this.onerror)==null||m.call(this,y),t(y)}};this.sseConnection={close:()=>c.cancel()},u()}catch(a){if(a instanceof Error&&a.name==="AbortError")return;(i=this.onerror)==null||i.call(this,a),t(a)}})()})}async close(){var e,t,n;this.connected=!1,(e=this.sseConnection)==null||e.close(),(t=this.abortController)==null||t.abort(),(n=this.onclose)==null||n.call(this)}async send(e){var t,n,r;if(!this.endpoint||!this.connected)throw new ra({message:"MCP SSE Transport Error: Not connected"});try{const s=new Headers(this.headers);s.set("Content-Type","application/json");const i={method:"POST",headers:s,body:JSON.stringify(e),signal:(t=this.abortController)==null?void 0:t.signal},a=await fetch(this.endpoint,i);if(!a.ok){const o=await a.text().catch(()=>null),l=new ra({message:`MCP SSE Transport Error: POSTing to endpoint (HTTP ${a.status}): ${o}`});(n=this.onerror)==null||n.call(this,l);return}}catch(s){(r=this.onerror)==null||r.call(this,s);return}}};function D4e(e){if(e.type!=="sse")throw new ra({message:"Unsupported or invalid transport configuration. If you are using a custom transport, make sure it implements the MCPTransport interface."});return new P4e(e)}function F4e(e){return"start"in e&&typeof e.start=="function"&&"send"in e&&typeof e.send=="function"&&"close"in e&&typeof e.close=="function"}var L4e="1.0.0";async function p7(e){const t=new B4e(e);return await t.init(),t}var B4e=class{constructor({transport:e,name:t="ai-sdk-mcp-client",onUncaughtError:n}){this.requestMessageId=0,this.responseHandlers=new Map,this.serverCapabilities={},this.isClosed=!0,this.onUncaughtError=n,F4e(e)?this.transport=e:this.transport=D4e(e),this.transport.onclose=()=>this.onClose(),this.transport.onerror=r=>this.onError(r),this.transport.onmessage=r=>{if("method"in r){this.onError(new ra({message:"Unsupported message type"}));return}this.onResponse(r)},this.clientInfo={name:t,version:L4e}}async init(){try{await this.transport.start(),this.isClosed=!1;const e=await this.request({request:{method:"initialize",params:{protocolVersion:SJ,capabilities:{},clientInfo:this.clientInfo}},resultSchema:x4e});if(e===void 0)throw new ra({message:"Server sent invalid initialize result"});if(!g4e.includes(e.protocolVersion))throw new ra({message:`Server's protocol version is not supported: ${e.protocolVersion}`});return this.serverCapabilities=e.capabilities,await this.notification({method:"notifications/initialized"}),this}catch(e){throw await this.close(),e}}async close(){var e;this.isClosed||(await((e=this.transport)==null?void 0:e.close()),this.onClose())}assertCapability(e){switch(e){case"initialize":break;case"tools/list":case"tools/call":if(!this.serverCapabilities.tools)throw new ra({message:"Server does not support tools"});break;default:throw new ra({message:`Unsupported method: ${e}`})}}async request({request:e,resultSchema:t,options:n}){return new Promise((r,s)=>{if(this.isClosed)return s(new ra({message:"Attempted to send a request from a closed client"}));this.assertCapability(e.method);const i=n==null?void 0:n.signal;i==null||i.throwIfAborted();const a=this.requestMessageId++,o={...e,jsonrpc:"2.0",id:a},l=()=>{this.responseHandlers.delete(a)};this.responseHandlers.set(a,c=>{if(i!=null&&i.aborted)return s(new ra({message:"Request was aborted",cause:i.reason}));if(c instanceof Error)return s(c);try{const u=t.parse(c.result);r(u)}catch(u){const d=new ra({message:"Failed to parse server response",cause:u});s(d)}}),this.transport.send(o).catch(c=>{l(),s(c)})})}async listTools({params:e,options:t}={}){try{return this.request({request:{method:"tools/list",params:e},resultSchema:S4e,options:t})}catch(n){throw n}}async callTool({name:e,args:t,options:n}){try{return this.request({request:{method:"tools/call",params:{name:e,arguments:t}},resultSchema:R4e,options:{signal:n==null?void 0:n.abortSignal}})}catch(r){throw r}}async notification(e){const t={...e,jsonrpc:"2.0"};await this.transport.send(t)}async tools({schemas:e="automatic"}={}){var t;const n={};try{const r=await this.listTools();for(const{name:s,description:i,inputSchema:a}of r.tools){if(e!=="automatic"&&!(s in e))continue;const o=e==="automatic"?CX({...a,properties:(t=a.properties)!=null?t:{},additionalProperties:!1}):e[s].parameters,l=this,c={description:i,parameters:o,execute:async(u,d)=>{var h;return(h=d==null?void 0:d.abortSignal)==null||h.throwIfAborted(),l.callTool({name:s,args:u,options:d})}};n[s]=c}return n}catch(r){throw r}}onClose(){if(this.isClosed)return;this.isClosed=!0;const e=new ra({message:"Connection closed"});for(const t of this.responseHandlers.values())t(e);this.responseHandlers.clear()}onError(e){this.onUncaughtError&&this.onUncaughtError(e)}onResponse(e){const t=Number(e.id),n=this.responseHandlers.get(t);if(n===void 0)throw new ra({message:`Protocol error: Received a response for an unknown message ID: ${JSON.stringify(e)}`});this.responseHandlers.delete(t),n("result"in e?e:new ra({message:e.error.message,cause:e.error}))}},$4e={};OD($4e,{mergeIntoDataStream:()=>q4e,toDataStream:()=>z4e,toDataStreamResponse:()=>U4e});function kJ(e={}){const t=new TextEncoder;let n="";return new TransformStream({async start(){e.onStart&&await e.onStart()},async transform(r,s){s.enqueue(t.encode(r)),n+=r,e.onToken&&await e.onToken(r),e.onText&&typeof r=="string"&&await e.onText(r)},async flush(){e.onCompletion&&await e.onCompletion(n),e.onFinal&&await e.onFinal(n)}})}function LD(e,t){return e.pipeThrough(new TransformStream({transform:async(n,r)=>{var s;if(typeof n=="string"){r.enqueue(n);return}if("event"in n){n.event==="on_chat_model_stream"&&m7((s=n.data)==null?void 0:s.chunk,r);return}m7(n,r)}})).pipeThrough(kJ(t)).pipeThrough(new TextDecoderStream).pipeThrough(new TransformStream({transform:async(n,r)=>{r.enqueue(Ma("text",n))}}))}function z4e(e,t){return LD(e,t).pipeThrough(new TextEncoderStream)}function U4e(e,t){var n;const r=LD(e,t==null?void 0:t.callbacks).pipeThrough(new TextEncoderStream),s=t==null?void 0:t.data,i=t==null?void 0:t.init,a=s?DD(s.stream,r):r;return new Response(a,{status:(n=i==null?void 0:i.status)!=null?n:200,statusText:i==null?void 0:i.statusText,headers:ck(i==null?void 0:i.headers,{contentType:"text/plain; charset=utf-8",dataStreamVersion:"v1"})})}function q4e(e,t){t.dataStream.merge(LD(e,t.callbacks))}function m7(e,t){if(typeof e.content=="string")t.enqueue(e.content);else{const n=e.content;for(const r of n)r.type==="text"&&t.enqueue(r.text)}}var V4e={};OD(V4e,{mergeIntoDataStream:()=>G4e,toDataStream:()=>W4e,toDataStreamResponse:()=>H4e});function BD(e,t){const n=K4e();return Sye(e[Symbol.asyncIterator]()).pipeThrough(new TransformStream({async transform(r,s){s.enqueue(n(r.delta))}})).pipeThrough(kJ(t)).pipeThrough(new TextDecoderStream).pipeThrough(new TransformStream({transform:async(r,s)=>{s.enqueue(Ma("text",r))}}))}function W4e(e,t){return BD(e,t).pipeThrough(new TextEncoderStream)}function H4e(e,t={}){var n;const{init:r,data:s,callbacks:i}=t,a=BD(e,i).pipeThrough(new TextEncoderStream),o=s?DD(s.stream,a):a;return new Response(o,{status:(n=r==null?void 0:r.status)!=null?n:200,statusText:r==null?void 0:r.statusText,headers:ck(r==null?void 0:r.headers,{contentType:"text/plain; charset=utf-8",dataStreamVersion:"v1"})})}function G4e(e,t){t.dataStream.merge(BD(e,t.callbacks))}function K4e(){let e=!0;return t=>(e&&(t=t.trimStart(),t&&(e=!1)),t)}class Y4e{static async executeInteraction(t,n,r){let s,i=!1,a=null,o,l,c;try{s=await h4e(n);for await(const u of s.fullStream){if(n.abortSignal.aborted){console.log(`[AIService] Stream ${t} aborted by signal.`);break}switch(u.type){case"text-delta":r.onChunk(u.textDelta);break;case"reasoning":r.onReasoningChunk(u.textDelta);break;case"tool-call":r.onToolCall(u);break;case"tool-result":r.onToolResult(u);break;case"step-start":r.onStepStart&&r.onStepStart({messageId:u.messageId,request:u.request,warnings:u.warnings||[]}),console.log(`[AIService] Step started for ${t} - Message ID: ${u.messageId}`);break;case"step-finish":r.onStepFinish&&r.onStepFinish({finishReason:u.finishReason,usage:u.usage,isContinued:u.isContinued||!1,warnings:u.warnings||[]}),console.log(`[AIService] Step finished for ${t} - Reason: ${u.finishReason}, Continued: ${u.isContinued}`);break;case"finish":i=!0,a=u.finishReason,o=u.usage,l=u.providerMetadata;break;case"error":r.onError(new Error(`AI Stream Error Part: ${u.error instanceof Error?u.error.message:u.error}`));return;default:console.warn(`[AIService] Received unexpected stream part type: ${u.type} for ${t}`,u);break}}s!=null&&s.reasoning?(c=await s.reasoning,console.log(`[AIService] Extracted final reasoning for ${t}`)):console.log(`[AIService] No final reasoning found in stream result for ${t}.`),!n.abortSignal.aborted&&i?r.onFinish({finishReason:a,usage:o,providerMetadata:l,reasoning:c}):!n.abortSignal.aborted&&!i&&(console.warn(`[AIService] Stream ${t} ended without a 'finish' part.`),r.onError(new Error("Stream ended unexpectedly without a finish signal.")))}catch(u){console.error(`[AIService] Error during streamText call for ${t}:`,u),u instanceof Error&&u.name==="AbortError"||r.onError(u instanceof Error?u:new Error(String(u)))}finally{console.log(`[AIService] Stream processing finished for ${t}.`)}}}const Z4e="modulepreload",X4e=function(e){return"/"+e},g7={},Zr=function(t,n,r){let s=Promise.resolve();if(n&&n.length>0){let a=function(c){return Promise.all(c.map(u=>Promise.resolve(u).then(d=>({status:"fulfilled",value:d}),d=>({status:"rejected",reason:d}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));s=a(n.map(c=>{if(c=X4e(c),c in g7)return;g7[c]=!0;const u=c.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${d}`))return;const h=document.createElement("link");if(h.rel=u?"stylesheet":Z4e,u||(h.as="script"),h.crossOrigin="",h.href=c,l&&h.setAttribute("nonce",l),document.head.appendChild(h),u)return new Promise((m,y)=>{h.addEventListener("load",m),h.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return s.then(a=>{for(const o of a||[])o.status==="rejected"&&i(o.reason);return t().catch(i)})},J4e=".litechat/conversations",EJ="/synced_repos";async function Q4e(e,t,n,r=!1){n(t.id,"syncing");const s=zr(`${EJ}/${t.id}`),i={username:t.username,password:t.password},a=t.branch||"main";try{let o=!1;try{await e.promises.stat(Du(s,".git")),o=!0}catch(l){if(l.code==="ENOENT")o=!1;else throw l}o?(r||Me.info(`Pulling latest changes for "${t.name}"...`),await oT(s,a,i,{fsInstance:e}),r||Me.success(`Repository "${t.name}" synced successfully.`),n(t.id,"idle")):(r||Me.info(`Cloning repository "${t.name}"...`),await SZ(s,t.remoteUrl,a,i,{fsInstance:e}),r||Me.success(`Repository "${t.name}" cloned successfully.`),n(t.id,"idle"))}catch(o){console.error(`Failed to initialize/sync repository ${t.name}:`,o),n(t.id,"error")}}async function eOe(e,t,n,r,s,i,a,o=!1){var h,m;r(t.id,"syncing");const l=zr(`${EJ}/${n.id}`),c=Du(l,J4e,`${t.id}.json`),u={username:n.username,password:n.password},d=n.branch||"main";try{try{await e.promises.stat(Du(l,".git"))}catch(w){if(w.code==="ENOENT"){Me.error(`Repository "${n.name}" not found locally. Please clone/sync it from Settings first.`),r(t.id,"error","Repo not cloned");return}throw w}o||Me.info(`Pulling latest changes for "${n.name}"...`),await oT(l,d,u,{fsInstance:e});let y=null,b=null;try{const w=await Zh(c,{fsInstance:e}),S=new TextDecoder().decode(w);y=JSON.parse(S),b=(h=y==null?void 0:y.conversation)!=null&&h.updatedAt?new Date(y.conversation.updatedAt).getTime():null,isNaN(b??NaN)&&(b=null)}catch(w){w.code==="ENOENT"?console.log(`Conversation file ${c} not found in repo. Will push local version.`):(console.error(`Failed to read or parse remote conversation file: ${w.message}`),Me.warning(`Could not read remote version of conversation: ${w.message}`))}const v=t.updatedAt.getTime(),x=((m=t.lastSyncedAt)==null?void 0:m.getTime())??0;if(!y||v>(b??0)||v>x&&v>=(b??0)){o||Me.info("Local changes detected. Pushing to remote...");const w=await _t.loadInteractionsForConversation(t.id),{lastSyncedAt:S,...k}=t,C=JSON.stringify({conversation:k,interactions:w},null,2);await lT(c,C,{fsInstance:e}),await yD(l,`Sync conversation: ${t.title} (${t.id})`,{fsInstance:e}),await bD(l,d,u,{fsInstance:e}),await s(t.id,{lastSyncedAt:new Date}),r(t.id,"idle"),o||Me.success("Conversation synced successfully (pushed).")}else if(b&&b>v){o||Me.info("Remote changes detected. Updating local conversation...");const w={...y.conversation,createdAt:new Date(y.conversation.createdAt),updatedAt:new Date(y.conversation.updatedAt),lastSyncedAt:new Date};await _t.saveConversation(w),await _t.deleteInteractionsForConversation(t.id);const S=y.interactions.map(k=>_t.saveInteraction({...k,conversationId:t.id,startedAt:k.startedAt?new Date(k.startedAt):null,endedAt:k.endedAt?new Date(k.endedAt):null}));await Promise.all(S),i()===t.id&&a()==="conversation"&&await vn.getState().loadInteractions(t.id),r(t.id,"idle"),o||Me.success("Conversation synced successfully (pulled).")}else o||Me.info("Conversation already up-to-date."),await s(t.id,{lastSyncedAt:new Date}),r(t.id,"idle")}catch(y){console.error(`Sync failed for conversation ${t.id}:`,y),r(t.id,"error",y.message)}}const _a={loaded:"project.loaded",added:"project.added",updated:"project.updated",deleted:"project.deleted",loadingStateChanged:"project.loading.state.changed",loadProjectsRequest:"project.load.projects.request",addProjectRequest:"project.add.project.request",updateProjectRequest:"project.update.project.request",deleteProjectRequest:"project.delete.project.request"},Jn={conversationsLoaded:"conversation.conversations.loaded",selectedItemChanged:"conversation.selected.item.changed",conversationAdded:"conversation.added",conversationUpdated:"conversation.updated",conversationDeleted:"conversation.deleted",conversationSyncStatusChanged:"conversation.sync.status.changed",syncReposLoaded:"conversation.sync.repos.loaded",syncRepoChanged:"conversation.sync.repo.changed",syncRepoInitStatusChanged:"conversation.sync.repo.init.status.changed",loadingStateChanged:"conversation.loading.state.changed",loadConversationsRequest:"conversation.load.conversations.request",addConversationRequest:"conversation.add.conversation.request",updateConversationRequest:"conversation.update.conversation.request",deleteConversationRequest:"conversation.delete.conversation.request",selectItemRequest:"conversation.select.item.request",importConversationRequest:"conversation.import.conversation.request",exportConversationRequest:"conversation.export.conversation.request",exportProjectRequest:"conversation.export.project.request",exportAllConversationsRequest:"conversation.export.all.conversations.request",loadSyncReposRequest:"conversation.load.sync.repos.request",addSyncRepoRequest:"conversation.add.sync.repo.request",updateSyncRepoRequest:"conversation.update.sync.repo.request",deleteSyncRepoRequest:"conversation.delete.sync.repo.request",linkConversationToRepoRequest:"conversation.link.conversation.to.repo.request",syncConversationRequest:"conversation.sync.conversation.request",initializeOrSyncRepoRequest:"conversation.initialize.or.sync.repo.request",updateCurrentConversationToolSettingsRequest:"conversation.update.current.conversation.tool.settings.request"},zo=qo(Vo((e,t)=>({projects:[],isLoading:!1,error:null,loadProjects:async()=>{e({isLoading:!0,error:null});try{const n=await _t.loadProjects();e({projects:n,isLoading:!1}),Pe.emit(_a.loaded,{projects:n})}catch(n){console.error("ProjectStore: Error loading projects",n),e({error:"Failed to load projects",isLoading:!1}),Pe.emit(_a.loadingStateChanged,{isLoading:!1,error:"Failed to load projects"})}},addProject:async n=>{var l;const r=as(),s=new Date,i=n.parentId?((l=t().getProjectById(n.parentId))==null?void 0:l.path)??"/":"/",a=zr(`${i}/${n.name.replace(/\s+/g,"-").toLowerCase()}-${r.substring(0,4)}`),o={id:r,path:a,createdAt:s,updatedAt:s,name:n.name,parentId:n.parentId??null,systemPrompt:n.systemPrompt??null,modelId:n.modelId??null,temperature:n.temperature??null,maxTokens:n.maxTokens??null,topP:n.topP??null,topK:n.topK??null,presencePenalty:n.presencePenalty??null,frequencyPenalty:n.frequencyPenalty??null,defaultTagIds:n.defaultTagIds??null,defaultRuleIds:n.defaultRuleIds??null,metadata:n.metadata??{}};try{return await _t.saveProject(o),e(c=>{c.projects.unshift(o),c.projects.sort((u,d)=>d.updatedAt.getTime()-u.updatedAt.getTime())}),Pe.emit(_a.added,{project:o}),r}catch(c){throw console.error("ProjectStore: Error adding project",c),e({error:"Failed to save new project"}),c}},updateProject:async(n,r)=>{var a;const s=t().getProjectById(n);if(!s){console.warn(`ProjectStore: Project ${n} not found for update.`);return}const i={...s,...r,updatedAt:new Date};if(r.name&&r.name!==s.name){const o=s.parentId?((a=t().getProjectById(s.parentId))==null?void 0:a.path)??"/":"/";i.path=zr(`${o}/${r.name.replace(/\s+/g,"-").toLowerCase()}-${n.substring(0,4)}`)}try{await _t.saveProject(i),e(o=>{const l=o.projects.findIndex(c=>c.id===n);l!==-1&&(o.projects[l]=i,o.projects.sort((c,u)=>u.updatedAt.getTime()-c.updatedAt.getTime()))}),Pe.emit(_a.updated,{projectId:n,updates:i})}catch(o){throw console.error("ProjectStore: Error updating project",o),e({error:"Failed to save project update"}),o}},deleteProject:async n=>{const r=t().projects.find(a=>a.id===n);if(!r)return;const s=new Set,i=a=>{s.add(a),t().projects.filter(o=>o.parentId===a).forEach(o=>i(o.id))};i(n);try{await _t.deleteProject(n),e(a=>({projects:a.projects.filter(o=>!s.has(o.id))})),Pe.emit(Jn.loadConversationsRequest,void 0),Pe.emit(_a.deleted,{projectId:n}),Me.success(`Project "${r.name}" and its contents deleted.`)}catch(a){throw console.error("ProjectStore: Error deleting project",a),e({error:"Failed to delete project"}),a}},getProjectById:n=>{if(n)return t().projects.find(r=>r.id===n)},getTopLevelProjectId:n=>{if(!n)return null;let r=t().getProjectById(n);if(!r)return null;for(;r.parentId;){const s=t().getProjectById(r.parentId);if(!s)break;r=s}return r.id},getEffectiveProjectSettings:n=>{const r=br.getState(),s=Cr.getState().selectedModelId,i={systemPrompt:r.globalSystemPrompt,modelId:s,temperature:r.temperature,maxTokens:r.maxTokens,topP:r.topP,topK:r.topK,presencePenalty:r.presencePenalty,frequencyPenalty:r.frequencyPenalty,defaultTagIds:null,defaultRuleIds:null};if(!n)return i;const a=t().getProjectById(n);if(!a)return i;const o=a.parentId?t().getEffectiveProjectSettings(a.parentId):i;return{systemPrompt:a.systemPrompt!==null&&a.systemPrompt!==void 0?a.systemPrompt:o.systemPrompt,modelId:a.modelId!==null&&a.modelId!==void 0?a.modelId:o.modelId,temperature:a.temperature!==null&&a.temperature!==void 0?a.temperature:o.temperature,maxTokens:a.maxTokens!==null&&a.maxTokens!==void 0?a.maxTokens:o.maxTokens,topP:a.topP!==null&&a.topP!==void 0?a.topP:o.topP,topK:a.topK!==null&&a.topK!==void 0?a.topK:o.topK,presencePenalty:a.presencePenalty!==null&&a.presencePenalty!==void 0?a.presencePenalty:o.presencePenalty,frequencyPenalty:a.frequencyPenalty!==null&&a.frequencyPenalty!==void 0?a.frequencyPenalty:o.frequencyPenalty,defaultTagIds:a.defaultTagIds!==null&&a.defaultTagIds!==void 0?a.defaultTagIds:o.defaultTagIds,defaultRuleIds:a.defaultRuleIds!==null&&a.defaultRuleIds!==void 0?a.defaultRuleIds:o.defaultRuleIds}},getRegisteredActionHandlers:()=>{const n="projectStore",r=t(),s=i=>async a=>{await i(a)};return[{eventName:_a.loadProjectsRequest,handler:r.loadProjects,storeId:n},{eventName:_a.addProjectRequest,handler:s(r.addProject),storeId:n},{eventName:_a.updateProjectRequest,handler:i=>r.updateProject(i.id,i.updates),storeId:n},{eventName:_a.deleteProjectRequest,handler:i=>r.deleteProject(i.id),storeId:n}]}}))),Up=(e,t)=>{const n=URL.createObjectURL(e),r=document.createElement("a");r.href=n,r.download=t,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(n)},tOe=(e,t)=>{let n=`# ${e.title}

`;return n+=`*Conversation ID: ${e.id}*
`,n+=`*Created: ${Md(e.createdAt,"yyyy-MM-dd HH:mm:ss")}*
`,n+=`*Last Updated: ${Md(e.updatedAt,"yyyy-MM-dd HH:mm:ss")}*
`,e.projectId&&(n+=`*Project ID: ${e.projectId}*
`),n+=`
---

`,t.filter(r=>r.type==="message.user_assistant").sort((r,s)=>r.index-s.index).forEach(r=>{var s,i,a,o,l,c,u,d;((s=r.prompt)!=null&&s.content||(o=(a=(i=r.prompt)==null?void 0:i.metadata)==null?void 0:a.attachedFiles)!=null&&o.length)&&(n+=`## User (Index: ${r.index})

`,(l=r.prompt.metadata)!=null&&l.attachedFiles&&r.prompt.metadata.attachedFiles.length>0&&(n+=`**Attached Files:**
`,r.prompt.metadata.attachedFiles.forEach(h=>{n+=`- ${h.name} (${h.type}, ${pw(h.size)}) ${h.source==="vfs"?`(VFS: ${h.path})`:"(Direct Upload)"}
`}),n+=`
`),r.prompt.content&&(n+=`${r.prompt.content}

`)),r.response&&(n+=`## Assistant (Index: ${r.index})

`,(c=r.metadata)!=null&&c.modelId&&(n+=`*Model: ${r.metadata.modelId}*

`),typeof r.response=="string"?n+=`${r.response}

`:(n+="```json\n",n+=`${JSON.stringify(r.response,null,2)}
`,n+="```\n\n"),((u=r.metadata)!=null&&u.promptTokens||(d=r.metadata)!=null&&d.completionTokens)&&(n+=`*Tokens: ${r.metadata.promptTokens??"?"} (prompt) / ${r.metadata.completionTokens??"?"} (completion)*

`)),n+=`---

`}),n};class _0{static async importConversation(t,n,r){try{const s=await t.text(),i=JSON.parse(s);if(!i||typeof i!="object"||!i.conversation||!Array.isArray(i.interactions))throw new Error("Invalid import file format. Expected { conversation: {}, interactions: [] }.");const a=i.conversation,o=i.interactions;if(!a.id||!a.title||!a.createdAt||!a.updatedAt)throw new Error("Invalid conversation data in import file.");const l=await n({title:a.title||"Imported Chat",metadata:a.metadata,projectId:null,syncRepoId:null,lastSyncedAt:null}),c=o.map(u=>_t.saveInteraction({...u,conversationId:l,id:as()}));await Promise.all(c),await r(l,"conversation"),Me.success("Conversation imported successfully.")}catch(s){throw console.error("ImportExportService: Error importing conversation",s),Me.error(`Import failed: ${s instanceof Error?s.message:String(s)}`),s}}static async exportConversation(t,n){try{const r=qn.getState().getConversationById(t);if(!r)throw new Error("Conversation not found.");const s=await _t.loadInteractionsForConversation(t);let i,a;const o=r.title.replace(/[^a-z0-9]/gi,"_").toLowerCase()||"conversation";if(n==="json"){const c=JSON.stringify({conversation:r,interactions:s},null,2);i=new Blob([c],{type:"application/json"}),a=`litechat_conversation_${o}_${t.substring(0,6)}.json`}else if(n==="md"){const l=tOe(r,s);i=new Blob([l],{type:"text/markdown"}),a=`litechat_conversation_${o}_${t.substring(0,6)}.md`}else throw new Error("Invalid export format specified.");Up(i,a),Me.success(`Conversation exported as ${n.toUpperCase()}.`)}catch(r){throw console.error("ImportExportService: Error exporting conversation",r),Me.error(`Export failed: ${r instanceof Error?r.message:String(r)}`),r}}static async exportProject(t){try{const{projects:n,getProjectById:r}=zo.getState(),{conversations:s}=qn.getState(),i=r(t);if(!i)throw new Error("Project not found.");const a=async h=>{const m=n.find(x=>x.id===h);if(!m)throw new Error(`Project ${h} not found in state.`);const y=n.filter(x=>x.parentId===h),b=s.filter(x=>x.projectId===h),v=[];for(const x of y)v.push(await a(x.id));for(const x of b){const w=await _t.loadInteractionsForConversation(x.id);v.push({conversation:x,interactions:w})}return{project:m,children:v}},o=await a(t),l=JSON.stringify(o,null,2),c=new Blob([l],{type:"application/json"}),d=`litechat_project_${i.name.replace(/[^a-z0-9]/gi,"_").toLowerCase()||"project"}_${t.substring(0,6)}.json`;Up(c,d),Me.success(`Project "${i.name}" exported.`)}catch(n){throw console.error("ImportExportService: Error exporting project",n),Me.error(`Project export failed: ${n instanceof Error?n.message:String(n)}`),n}}static async exportAllConversations(){try{const t=qn.getState().conversations,n=[];for(const a of t){const o=await _t.loadInteractionsForConversation(a.id);n.push({conversation:a,interactions:o})}const r=JSON.stringify(n,null,2),s=new Blob([r],{type:"application/json"}),i=`litechat_all_conversations_export_${new Date().toISOString().split("T")[0]}.json`;Up(s,i),Me.success("All conversations exported.")}catch(t){throw console.error("ImportExportService: Error exporting conversations",t),Me.error(`Export failed: ${t instanceof Error?t.message:String(t)}`),t}}static async exportFullConfiguration(t){try{const n=await _t.getAllDataForExport(t),r=JSON.stringify(n,null,2),s=new Blob([r],{type:"application/json"}),a=`litechat_full_config_${Md(new Date,"yyyy-MM-dd_HH-mm-ss")}.json`;Up(s,a),Me.success("Full configuration exported successfully.")}catch(n){throw console.error("ImportExportService: Error exporting full configuration",n),Me.error(`Export failed: ${n instanceof Error?n.message:String(n)}`),n}}static async exportPromptTemplates(){try{const n=(await _t.loadPromptTemplates()).filter(l=>!l.type||l.type==="prompt"),r={version:1,exportedAt:new Date().toISOString(),promptTemplates:n},s=JSON.stringify(r,null,2),i=new Blob([s],{type:"application/json"}),o=`litechat_prompt_templates_${Md(new Date,"yyyy-MM-dd_HH-mm-ss")}.json`;Up(i,o),Me.success(`Exported ${n.length} prompt templates.`)}catch(t){throw console.error("ImportExportService: Error exporting prompt templates",t),Me.error(`Export failed: ${t instanceof Error?t.message:String(t)}`),t}}static async exportAgents(){try{const t=await _t.loadPromptTemplates(),n=t.filter(u=>u.type==="agent"),r=n.map(u=>u.id),s=t.filter(u=>u.type==="task"&&u.parentId&&r.includes(u.parentId)),i={version:1,exportedAt:new Date().toISOString(),agents:[...n,...s]},a=JSON.stringify(i,null,2),o=new Blob([a],{type:"application/json"}),c=`litechat_agents_${Md(new Date,"yyyy-MM-dd_HH-mm-ss")}.json`;Up(o,c),Me.success(`Exported ${n.length} agents with ${s.length} tasks.`)}catch(t){throw console.error("ImportExportService: Error exporting agents",t),Me.error(`Export failed: ${t instanceof Error?t.message:String(t)}`),t}}static async exportMcpServers(){try{const t=await _t.loadSetting("mcpServers",[]),n={version:1,exportedAt:new Date().toISOString(),mcpServers:t},r=JSON.stringify(n,null,2),s=new Blob([r],{type:"application/json"}),a=`litechat_mcp_servers_${Md(new Date,"yyyy-MM-dd_HH-mm-ss")}.json`;Up(s,a),Me.success(`Exported ${t.length} MCP server configurations.`)}catch(t){throw console.error("ImportExportService: Error exporting MCP servers",t),Me.error(`Export failed: ${t instanceof Error?t.message:String(t)}`),t}}static async importFullConfiguration(t,n){try{const r=await t.text(),s=JSON.parse(r);if(!s||typeof s!="object"||!s.version)throw new Error("Invalid import file format. Missing version or basic structure.");await _t.importAllData(s,n),Me.success("Configuration imported successfully. Reloading application..."),setTimeout(()=>window.location.reload(),1500)}catch(r){throw console.error("ImportExportService: Error importing full configuration",r),Me.error(`Full import failed: ${r instanceof Error?r.message:String(r)}`),r}}static async importPromptTemplates(t){try{const n=await t.text(),r=JSON.parse(n);if(!r||typeof r!="object"||!r.promptTemplates||!Array.isArray(r.promptTemplates))throw new Error("Invalid prompt templates file format.");let s=0;for(const i of r.promptTemplates)try{await _t.savePromptTemplate({...i,id:i.id||as(),createdAt:i.createdAt?new Date(i.createdAt):new Date,updatedAt:new Date}),s++}catch(a){console.warn(`Failed to import template ${i.name}:`,a)}Me.success(`Imported ${s} prompt templates.`)}catch(n){throw console.error("ImportExportService: Error importing prompt templates",n),Me.error(`Import failed: ${n instanceof Error?n.message:String(n)}`),n}}static async importAgents(t){try{const n=await t.text(),r=JSON.parse(n);if(!r||typeof r!="object"||!r.agents||!Array.isArray(r.agents))throw new Error("Invalid agents file format.");let s=0,i=0;for(const a of r.agents)try{await _t.savePromptTemplate({...a,id:a.id||as(),createdAt:a.createdAt?new Date(a.createdAt):new Date,updatedAt:new Date}),a.type==="agent"?s++:a.type==="task"&&i++}catch(o){console.warn(`Failed to import ${a.type} ${a.name}:`,o)}Me.success(`Imported ${s} agents with ${i} tasks.`)}catch(n){throw console.error("ImportExportService: Error importing agents",n),Me.error(`Import failed: ${n instanceof Error?n.message:String(n)}`),n}}static async importMcpServers(t){try{const n=await t.text(),r=JSON.parse(n);if(!r||typeof r!="object"||!r.mcpServers||!Array.isArray(r.mcpServers))throw new Error("Invalid MCP servers file format.");await _t.saveSetting("mcpServers",r.mcpServers),Me.success(`Imported ${r.mcpServers.length} MCP server configurations.`)}catch(n){throw console.error("ImportExportService: Error importing MCP servers",n),Me.error(`Import failed: ${n instanceof Error?n.message:String(n)}`),n}}}const iu="sync_repos",ds={repoChanged:"sync.repo.changed",repoInitStatusChanged:"sync.repo.init.status.changed",bulkSyncStarted:"sync.bulk.sync.started",bulkSyncProgress:"sync.bulk.sync.progress",bulkSyncCompleted:"sync.bulk.sync.completed",bulkSyncFailed:"sync.bulk.sync.failed"},ei=qo(Vo((e,t)=>({nodes:{},childrenMap:{"":[]},rootId:null,currentParentId:null,selectedFileIds:new Set,loading:!1,operationLoading:!1,error:null,fs:null,enableVfs:!0,vfsKey:null,configuredVfsKey:null,initializingKey:null,_setLoading:n=>{e(r=>{r.loading=n,n&&(r.error=null)}),Pe.emit(dn.loadingStateChanged,{isLoading:t().loading,operationLoading:t().operationLoading,error:t().error})},_setOperationLoading:n=>{e(r=>{r.operationLoading=n}),Pe.emit(dn.loadingStateChanged,{isLoading:t().loading,operationLoading:t().operationLoading,error:t().error})},_setError:n=>{e(r=>{r.error=n,r.loading=!1,r.operationLoading=!1,r.initializingKey=null,n&&Me.error(`VFS Error: ${n}`)}),Pe.emit(dn.loadingStateChanged,{isLoading:t().loading,operationLoading:t().operationLoading,error:t().error})},_addNodes:n=>{e(r=>{const s={};n.forEach(i=>{r.nodes[i.id]=i;const a=i.parentId??r.rootId??"";s[a]||(s[a]=r.childrenMap[a]?[...r.childrenMap[a]]:[]),s[a].includes(i.id)||s[a].push(i.id)});for(const i in s)(!r.childrenMap[i]||JSON.stringify(r.childrenMap[i].sort())!==JSON.stringify(s[i].sort()))&&(r.childrenMap[i]=s[i])}),Pe.emit(dn.nodesUpdated,{vfsKey:t().vfsKey,nodes:t().nodes,childrenMap:t().childrenMap})},_updateNode:(n,r)=>{e(s=>{s.nodes[n]&&Object.assign(s.nodes[n],r)}),Pe.emit(dn.nodesUpdated,{vfsKey:t().vfsKey,nodes:t().nodes,childrenMap:t().childrenMap})},_removeNodes:n=>{e(r=>{n.forEach(s=>{const i=r.nodes[s];if(i){const a=i.parentId??r.rootId??"";if(r.childrenMap[a]&&(r.childrenMap[a]=r.childrenMap[a].filter(o=>o!==s)),delete r.nodes[s],r.selectedFileIds.delete(s),i.type==="folder"){const o=Object.values(r.nodes).filter(l=>l.parentId===s).map(l=>l.id);o.length>0&&t()._removeNodes(o),delete r.childrenMap[s]}}})}),Pe.emit(dn.nodesUpdated,{vfsKey:t().vfsKey,nodes:t().nodes,childrenMap:t().childrenMap}),Pe.emit(dn.selectionChanged,{selectedFileIds:Array.from(t().selectedFileIds)})},_setFsInstance:n=>{e({fs:n}),Pe.emit(dn.fsInstanceChanged,{fsInstance:n})},_setEnableVfs:n=>{console.log(`[VfsStore] Setting global enableVfs to: ${n}`),e({enableVfs:n}),Pe.emit(dn.vfsEnabledChanged,{enabled:n}),n||(e({fs:null,configuredVfsKey:null,vfsKey:null,rootId:null,currentParentId:null,nodes:{},childrenMap:{"":[]},error:null,loading:!1,operationLoading:!1,initializingKey:null}),Pe.emit(dn.vfsKeyChanged,{vfsKey:null,configuredVfsKey:null}))},_setConfiguredVfsKey:n=>{e({configuredVfsKey:n}),Pe.emit(dn.vfsKeyChanged,{vfsKey:t().vfsKey,configuredVfsKey:n})},setVfsKey:n=>{if(n!==null){const r=t().vfsKey,s=t().configuredVfsKey;if(n===r){n&&n!==s&&!t().initializingKey&&t().initializeVFS(n).catch(i=>{console.error(`[VfsStore] Error during re-initialization trigger for ${n}:`,i)});return}console.log(`[VfsStore] setVfsKey: Changing desired key from ${r} to ${n}. Configured: ${s}`),e({vfsKey:n}),e({fs:null,configuredVfsKey:null,rootId:null,currentParentId:null,nodes:{},childrenMap:{"":[]},error:null,loading:!1,operationLoading:!1,selectedFileIds:new Set,initializingKey:null}),Pe.emit(dn.vfsKeyChanged,{vfsKey:n,configuredVfsKey:null}),n!==null&&t().initializeVFS(n).catch(i=>{console.error(`[VfsStore] Error during initialization trigger for ${n}:`,i)})}},initializeVFS:async(n,r)=>{let s,i;if(typeof n=="object"&&n!==null&&"vfsKey"in n)console.warn("[VfsStore] initializeVFS called with a single object payload. Correcting. Input:",JSON.parse(JSON.stringify(n))),s=String(n.vfsKey),i=n.options;else if(typeof n=="string")s=n,i=r;else{const h=`[VfsStore] initializeVFS called with invalid vfsKey type. Type: ${typeof n}, Value: "${String(n)}". Aborting.`;throw console.error(h,n),new Error("VFS key must be a string and cannot be empty.")}if(!s||s.trim()===""){const h=`[VfsStore] initializeVFS: Derived vfsKey is empty or invalid. Original param: ${String(n)}, Derived key: "${s}". Aborting.`;throw console.error(h,{originalVfsKeyParam:n,originalOptionsParam:r}),new Error("VFS key cannot be empty after processing.")}const a=(i==null?void 0:i.force)===!0;if(t().initializingKey===s){const h=`Initialization skipped for "${s}". Already actively initializing this exact key.`;return console.warn(`[VfsStore] ${h}`),new Promise((m,y)=>{const b=setInterval(()=>{const v=t();v.initializingKey!==s&&(clearInterval(b),v.configuredVfsKey===s&&v.fs?m(v.fs):y(new Error(`VFS initialization for "${s}" failed or was interrupted`)))},100);setTimeout(()=>{clearInterval(b),y(new Error(`Timeout waiting for VFS "${s}" initialization to complete`))},1e4)})}if(t().configuredVfsKey===s&&t().fs)return a||e({loading:!1}),t().fs;if(!a){if(t().vfsKey!==s){const h=`UI Initialization aborted for "${s}". Desired key is now "${t().vfsKey}".`;throw console.warn(`[VfsStore] ${h}`),new Error(h)}if(t().initializingKey!==null&&t().initializingKey!==s){const h=`UI Initialization skipped for "${s}". Already initializing a different key "${t().initializingKey}".`;throw console.warn(`[VfsStore] ${h}`),new Error(h)}}const{_setLoading:o,_setError:l,_addNodes:c,_setFsInstance:u,_setConfiguredVfsKey:d}=t();console.log(`[VfsStore] Initializing VFS with key: ${s} (Forced: ${a})`),e({initializingKey:s}),a||(o(!0),l(null));try{const h=await gTe(s);if(!h)throw new Error("Filesystem backend initialization failed.");if(!a&&t().vfsKey!==s){const b=`UI Initialization for key "${s}" completed, but desired key changed to "${t().vfsKey}". Discarding result.`;throw console.warn(`[VfsStore] ${b}`),e({initializingKey:null,loading:!1}),new Error(b)}if(a)return u(h),d(s),e({initializingKey:null}),Pe.emit(dn.loadingStateChanged,{isLoading:!1,operationLoading:!1,error:null}),h;u(h),d(s),console.log(`[VfsStore] UI VFS instance configured for key: ${s}`);const m="vfs-root";let y=t().nodes[m];try{await h.promises.stat("/")}catch(b){if(b.code==="ENOENT")console.warn("[VfsStore] Root directory '/' not found, will be created implicitly.");else throw b}if(!y||y.path!=="/"){const b=Date.now();y={id:m,parentId:null,name:"",path:"/",type:"folder",createdAt:b,lastModified:b},c([y])}return e(b=>{b.rootId=y.id,b.currentParentId=y.id}),await t().fetchNodes(y.id),h}catch(h){const m=`Failed to initialize VFS (${s}): ${h instanceof Error?h.message:String(h)}`;throw console.error(`[VfsStore DEBUG] Error in initializeVFS catch block: ${m}`,h),t().initializingKey===s&&(l(m),a||(u(null),d(null))),new Error(m)}finally{t().initializingKey===s&&(e({initializingKey:null}),a||e({loading:!1}))}},fetchNodes:async(n=null)=>{const{_setLoading:r,_setError:s,_addNodes:i,fs:a,nodes:o,rootId:l,configuredVfsKey:c,vfsKey:u,initializingKey:d}=t();if(!a||c!==u||d){console.warn(`[VfsStore] fetchNodes skipped. Ready: ${!!a}, Match: ${c===u}, Init: ${d}`);return}r(!0);try{const h=n?o[n]:o[l||""],m=h?h.path:"/",y=await vD(m,{fsInstance:a}),b=n??l??"",v=new Set(y.map(C=>C.path)),S=(t().childrenMap[b]||[]).map(C=>t().nodes[C]).filter(Boolean).filter(C=>!v.has(C.path)).map(C=>C.id);S.length>0&&t()._removeNodes(S);const k=y.map(C=>{const T=Object.values(t().nodes).find(N=>N.path===C.path),R=Date.now();return{id:(T==null?void 0:T.id)||as(),parentId:n,name:C.name,path:C.path,type:C.isDirectory?"folder":"file",size:C.size,createdAt:(T==null?void 0:T.createdAt)??R,lastModified:C.lastModified.getTime(),mimeType:C.isDirectory?void 0:C.mimeType}});k.length>0&&i(k),e(C=>{const T=k.map(R=>R.id);(!C.childrenMap[b]||JSON.stringify(C.childrenMap[b].sort())!==JSON.stringify(T.sort()))&&(C.childrenMap[b]=T)})}catch(h){console.error("Failed to fetch VFS nodes:",h),s("Failed to load directory contents.")}finally{r(!1)}},findNodeByPath:n=>{const r=zr(n);if(t().vfsKey===t().configuredVfsKey){if(r==="/"){const s=t().rootId;return s?t().nodes[s]:void 0}return Object.values(t().nodes).find(s=>s.path===r)}},setCurrentPath:async n=>{const{findNodeByPath:r,fetchNodes:s,rootId:i,fs:a}=t();if(!a||t().vfsKey!==t().configuredVfsKey)return;const o=zr(n),l=r(o);l&&l.type==="folder"?(e(c=>{c.currentParentId=l.id}),t().childrenMap[l.id]||await s(l.id)):o==="/"&&i?(e(c=>{c.currentParentId=i}),t().childrenMap[i]||await s(i)):console.warn(`Path not found or not a directory: ${n}`)},createDirectory:async(n,r)=>{const{_setOperationLoading:s,_setError:i,fs:a,nodes:o,rootId:l,_addNodes:c,configuredVfsKey:u,vfsKey:d}=t();if(!a||u!==d){i("Filesystem not ready.");return}if(!r.trim()){i("Directory name cannot be empty.");return}s(!0);try{const h=n?o[n]:o[l||""],m=h?h.path:"/",y=jj(m,r.trim());try{throw await a.promises.stat(y),new Error(`"${r.trim()}" already exists.`)}catch(w){if(w.code!=="ENOENT")throw w}await EZ(y,{fsInstance:a});const b=Date.now(),x={id:as(),parentId:n,name:r.trim(),path:y,type:"folder",createdAt:b,lastModified:b};c([x])}catch(h){console.error("Failed to create directory:",h),i(h.message||"Failed to create directory.")}finally{s(!1)}},uploadFiles:async(n,r)=>{const{_setOperationLoading:s,_setError:i,fs:a,nodes:o,rootId:l,configuredVfsKey:c,vfsKey:u}=t();if(!a||c!==u){i("Filesystem not ready.");return}s(!0);try{const d=n?o[n]:o[l||""],h=d?d.path:"/";await TZ(Array.from(r),h,{fsInstance:a}),await t().fetchNodes(n)}catch(d){console.error("Failed to upload files:",d),i("Failed to upload one or more files.")}finally{s(!1)}},deleteNodes:async n=>{const{_setOperationLoading:r,_setError:s,_removeNodes:i,fs:a,configuredVfsKey:o,vfsKey:l}=t();if(!a||o!==l){s("Filesystem not ready.");return}r(!0);try{const c=n.map(u=>t().nodes[u]).filter(Boolean);for(const u of c)await xD(u.path,u.type==="folder",{fsInstance:a});i(n)}catch(c){console.error("Failed to delete nodes:",c),s("Failed to delete one or more items."),await t().fetchNodes(t().currentParentId)}finally{r(!1)}},renameNode:async(n,r)=>{const{_setOperationLoading:s,_setError:i,_updateNode:a,nodes:o,fs:l,rootId:c,configuredVfsKey:u,vfsKey:d}=t();if(!l||u!==d){i("Filesystem not ready.");return}if(!r.trim()){i("Name cannot be empty.");return}const h=o[n];if(!h){i("Item not found.");return}if(h.name!==r.trim()){s(!0);try{const m=h.parentId?o[h.parentId]:o[c||""],y=m?m.path:"/",b=jj(y,r.trim());try{throw await l.promises.stat(b),new Error(`"${r.trim()}" already exists.`)}catch(x){if(x.code!=="ENOENT")throw x}await AZ(h.path,b,{fsInstance:l});const v={name:r.trim(),path:b,lastModified:Date.now()};a(n,v)}catch(m){console.error("Failed to rename item:",m),i(m.message||"Failed to rename item.")}finally{s(!1)}}},downloadFile:async n=>{const{nodes:r,fs:s,_setError:i,configuredVfsKey:a,vfsKey:o}=t();if(!s||a!==o)return i("Filesystem not ready."),null;const l=r[n];if(!l||l.type!=="file")return i("File not found."),null;try{const c=await Zh(l.path,{fsInstance:s}),u=l.mimeType||"application/octet-stream",d=new Blob([c],{type:u});return{name:l.name,blob:d}}catch(c){return console.error("Failed to download file:",c),i("Failed to retrieve file content."),null}},selectFile:n=>{e(r=>{r.selectedFileIds.add(n)}),Pe.emit(dn.selectionChanged,{selectedFileIds:Array.from(t().selectedFileIds)})},deselectFile:n=>{e(r=>{r.selectedFileIds.delete(n)}),Pe.emit(dn.selectionChanged,{selectedFileIds:Array.from(t().selectedFileIds)})},clearSelection:()=>{e(n=>{n.selectedFileIds.clear()}),Pe.emit(dn.selectionChanged,{selectedFileIds:[]})},resetStuckInitialization:()=>{console.warn("[VfsStore] Force resetting stuck initialization state"),e({initializingKey:null,loading:!1,operationLoading:!1,error:null})},getRegisteredActionHandlers:()=>{const n="vfsStore",r=t(),s=i=>async a=>{await i(a)};return[{eventName:dn.setVfsKeyRequest,handler:i=>r.setVfsKey(i.key),storeId:n},{eventName:dn.initializeVFSRequest,handler:async i=>{await r.initializeVFS(i.vfsKey,i.options)},storeId:n},{eventName:dn.fetchNodesRequest,handler:i=>r.fetchNodes(i.parentId),storeId:n},{eventName:dn.setCurrentPathRequest,handler:i=>r.setCurrentPath(i.path),storeId:n},{eventName:dn.createDirectoryRequest,handler:i=>r.createDirectory(i.parentId,i.name),storeId:n},{eventName:dn.uploadFilesRequest,handler:i=>r.uploadFiles(i.parentId,i.files),storeId:n},{eventName:dn.deleteNodesRequest,handler:i=>r.deleteNodes(i.ids),storeId:n},{eventName:dn.renameNodeRequest,handler:i=>r.renameNode(i.id,i.newName),storeId:n},{eventName:dn.downloadFileRequest,handler:s(r.downloadFile),storeId:n},{eventName:dn.selectFileRequest,handler:i=>r.selectFile(i.fileId),storeId:n},{eventName:dn.deselectFileRequest,handler:i=>r.deselectFile(i.fileId),storeId:n},{eventName:dn.clearSelectionRequest,handler:r.clearSelection,storeId:n},{eventName:dn.setEnableVfsRequest,handler:i=>r._setEnableVfs(i.enabled),storeId:n}]}}))),nOe="/synced_repos",qn=qo(Vo((e,t)=>({conversations:[],selectedItemId:null,selectedItemType:null,syncRepos:[],conversationSyncStatus:{},repoInitializationStatus:{},isLoading:!1,error:null,_ensureSyncVfsReady:async()=>(console.log("[ConversationStore] Ensuring Sync VFS is ready..."),ei.getState().initializingKey===iu&&(console.warn("[ConversationStore] VFS appears stuck in initializing state, resetting..."),ei.getState().resetStuckInitialization()),new Promise((r,s)=>{let i=null;const a=()=>{Pe.off(dn.fsInstanceChanged,o),Pe.off(dn.loadingStateChanged,l),i&&(clearTimeout(i),i=null)},o=u=>{ei.getState().configuredVfsKey===iu&&u.fsInstance&&(console.log(`[ConversationStore] Sync VFS ready via fsInstanceChanged for key ${iu}.`),a(),r(u.fsInstance))},l=u=>{const d=ei.getState();d.configuredVfsKey===iu&&(u.error?(console.error(`[ConversationStore] Sync VFS initialization error for key ${iu}: ${u.error}`),a(),s(new Error(u.error))):!u.isLoading&&!u.operationLoading&&d.fs&&(console.log(`[ConversationStore] Sync VFS ready via loadingStateChanged for key ${iu}.`),a(),r(d.fs)))};Pe.on(dn.fsInstanceChanged,o),Pe.on(dn.loadingStateChanged,l);const c=ei.getState();if(c.configuredVfsKey===iu&&c.fs&&!c.loading&&!c.operationLoading&&!c.error){console.log(`[ConversationStore] Sync VFS already ready for key ${iu}.`),a(),r(c.fs);return}i=setTimeout(()=>{const u=`Timeout waiting for Sync VFS (${iu}) to become ready.`;console.error(`[ConversationStore] ${u}`),a(),s(new Error(u))},3e4),Pe.emit(dn.initializeVFSRequest,{vfsKey:iu,options:{force:!0}})})),loadConversations:async()=>{e({isLoading:!0,error:null});try{const[n,r]=await Promise.all([_t.loadConversations(),_t.loadSyncRepos()]),s={};n.forEach(i=>{if(i.syncRepoId){const a=i.lastSyncedAt instanceof Date?i.lastSyncedAt.getTime():null,o=i.updatedAt instanceof Date?i.updatedAt.getTime():null;a?o&&o>a?s[i.id]="needs-sync":s[i.id]="idle":s[i.id]="needs-sync"}else s[i.id]="idle"}),e({conversations:n,syncRepos:r,conversationSyncStatus:s,repoInitializationStatus:{},isLoading:!1}),Pe.emit(Jn.conversationsLoaded,{conversations:n}),Pe.emit(Jn.syncReposLoaded,{repos:r})}catch(n){console.error("ConversationStore: Error loading conversations",n),e({error:"Failed load conversations",isLoading:!1}),Pe.emit(Jn.loadingStateChanged,{isLoading:!1,error:"Failed load conversations"})}},addConversation:async n=>{const r=as(),s=new Date,i={id:r,createdAt:s,updatedAt:s,title:n.title,projectId:n.projectId??null,metadata:{...n.metadata??{},enabledTools:[],toolMaxStepsOverride:null},syncRepoId:n.syncRepoId??null,lastSyncedAt:n.lastSyncedAt??null};let a=!1;try{const o=JSON.stringify(i);return await _t.saveConversation(JSON.parse(o)),a=!0,e(l=>{l.conversations.some(c=>c.id===i.id)||(l.conversations.unshift(i),l.conversationSyncStatus[r]=i.syncRepoId?"needs-sync":"idle")}),Pe.emit(Jn.conversationAdded,{conversation:i}),r}catch(o){throw console.error("ConversationStore: Error adding conversation",o),a&&e(l=>({error:"Failed to save new conversation to state",conversations:l.conversations.filter(c=>c.id!==r),conversationSyncStatus:Object.fromEntries(Object.entries(l.conversationSyncStatus).filter(([c])=>c!==r))})),o}},updateConversation:async(n,r)=>{const s=t().getConversationById(n);if(!s){console.warn(`ConversationStore: Conversation ${n} not found for update.`);return}e(a=>{const o=a.conversations.findIndex(l=>l.id===n);if(o!==-1){const l=a.conversations[o].metadata??{},c=r.metadata??{},u={...l,...c};Object.assign(a.conversations[o],{...r,metadata:u,updatedAt:new Date});const d=["title","metadata","projectId"].some(y=>y in r),h=a.conversations[o].lastSyncedAt instanceof Date?a.conversations[o].lastSyncedAt.getTime():null,m=a.conversations[o].updatedAt.getTime();"syncRepoId"in r?a.conversationSyncStatus[n]=r.syncRepoId?"needs-sync":"idle":d&&a.conversations[o].syncRepoId&&a.conversationSyncStatus[n]==="idle"&&(!h||m>h)&&(a.conversationSyncStatus[n]="needs-sync")}});const i=t().getConversationById(n);if(i)try{const a=JSON.parse(JSON.stringify(i));await _t.saveConversation(a),Pe.emit(Jn.conversationUpdated,{conversationId:n,updates:r})}catch(a){throw console.error("ConversationStore: Error updating conversation",a),e(o=>{const l=o.conversations.findIndex(c=>c.id===n);if(l!==-1){o.conversations[l]=s;const c=s.lastSyncedAt instanceof Date?s.lastSyncedAt.getTime():null,u=s.updatedAt.getTime();o.conversationSyncStatus[n]=s.syncRepoId&&c&&u<=c?"idle":s.syncRepoId?"needs-sync":"idle"}o.error="Failed to save conversation update"}),a}else console.error("ConversationStore: Failed to retrieve updated conversation state after update."),e(a=>{const o=a.conversations.findIndex(l=>l.id===n);if(o!==-1){a.conversations[o]=s;const l=s.lastSyncedAt instanceof Date?s.lastSyncedAt.getTime():null,c=s.updatedAt.getTime();a.conversationSyncStatus[n]=s.syncRepoId&&l&&c<=l?"idle":s.syncRepoId?"needs-sync":"idle"}a.error="Failed to save conversation update (state error)"})},deleteConversation:async n=>{const r=t().selectedItemId,s=t().selectedItemType,i=t().conversations.find(a=>a.id===n);if(i){e(a=>({conversations:a.conversations.filter(o=>o.id!==n),selectedItemId:r===n&&s==="conversation"?null:r,selectedItemType:r===n&&s==="conversation"?null:s,conversationSyncStatus:Object.fromEntries(Object.entries(a.conversationSyncStatus).filter(([o])=>o!==n))}));try{await _t.deleteConversation(n),await _t.deleteInteractionsForConversation(n),Pe.emit(Jn.conversationDeleted,{conversationId:n}),r===n&&s==="conversation"&&(Pe.emit(Zn.setCurrentConversationIdRequest,{id:null}),Pe.emit(Jn.selectedItemChanged,{itemId:null,itemType:null}))}catch(a){throw console.error("ConversationStore: Error deleting conversation",a),e(o=>{if(i){o.conversations.push(i);const l=i.lastSyncedAt instanceof Date?i.lastSyncedAt.getTime():null,c=i.updatedAt.getTime();o.conversationSyncStatus[n]=i.syncRepoId&&l&&c<=l?"idle":i.syncRepoId?"needs-sync":"idle"}r===n&&s==="conversation"&&(o.selectedItemId=n,o.selectedItemType="conversation"),o.error="Failed to delete conversation"}),a}}},selectItem:async(n,r)=>{const s=t().selectedItemId,i=t().selectedItemType;if(s===n&&i===r)return;console.log(`ConversationStore: Selecting item. ID: ${n}, Type: ${r}. Previous: ${s} (${i})`);const a=r==="conversation"?n:null;a&&(Pe.emit(Zn.setCurrentConversationIdRequest,{id:a}),Pe.emit(Zn.loadInteractionsRequest,{conversationId:a})),e({selectedItemId:n,selectedItemType:r}),Pe.emit(Jn.selectedItemChanged,{itemId:n,itemType:r})},importConversation:async n=>{await _0.importConversation(n,t().addConversation,t().selectItem)},exportConversation:async(n,r)=>{await _0.exportConversation(n,r)},exportProject:async n=>{await _0.exportProject(n)},exportAllConversations:async()=>{await _0.exportAllConversations()},loadSyncRepos:async()=>{if(!t().isLoading){e({isLoading:!0,error:null});try{const n=await _t.loadSyncRepos();e({syncRepos:n,isLoading:!1}),Pe.emit(Jn.syncReposLoaded,{repos:n})}catch(n){console.error("ConversationStore: Error loading sync repos",n),e({error:"Failed load sync repositories",isLoading:!1}),Pe.emit(Jn.loadingStateChanged,{isLoading:!1,error:"Failed load sync repositories"})}}},addSyncRepo:async n=>{const r=as(),s=new Date,i={id:r,createdAt:s,updatedAt:s,name:n.name,remoteUrl:n.remoteUrl,branch:n.branch||"main",username:n.username??null,password:n.password??null};e(a=>{a.syncRepos.push(i)});try{const a=t().syncRepos.find(o=>o.id===r);if(a){const o=JSON.parse(JSON.stringify(a));await _t.saveSyncRepo(o),Pe.emit(ds.repoChanged,{repoId:r,action:"added"})}else throw new Error("Failed to retrieve newly added sync repo state");Me.success(`Sync repository "${i.name}" added.`);try{await t().initializeOrSyncRepo(r)}catch(o){console.warn(`Failed to automatically initialize repository "${i.name}":`,o),Me.warning(`Repository "${i.name}" added but initialization failed. You can manually sync it later.`)}return r}catch(a){throw console.error("ConversationStore: Error adding sync repo",a),e(o=>({error:"Failed to save sync repository",syncRepos:o.syncRepos.filter(l=>l.id!==r)})),a}},updateSyncRepo:async(n,r)=>{const s=t().syncRepos.find(a=>a.id===n);if(!s){console.warn(`ConversationStore: SyncRepo ${n} not found.`);return}e(a=>{const o=a.syncRepos.findIndex(l=>l.id===n);o!==-1&&Object.assign(a.syncRepos[o],{...r,branch:r.branch||a.syncRepos[o].branch||"main",updatedAt:new Date})});const i=t().syncRepos.find(a=>a.id===n);if(i)try{const a=JSON.parse(JSON.stringify(i));await _t.saveSyncRepo(a),Pe.emit(ds.repoChanged,{repoId:n,action:"updated"}),Me.success(`Sync repository "${i.name}" updated.`)}catch(a){throw console.error("ConversationStore: Error updating sync repo",a),e(o=>{const l=o.syncRepos.findIndex(c=>c.id===n);l!==-1&&(o.syncRepos[l]=s),o.error="Failed to save sync repository update"}),a}else console.error("ConversationStore: Failed to retrieve updated sync repo state after update."),e(a=>{const o=a.syncRepos.findIndex(l=>l.id===n);o!==-1&&(a.syncRepos[o]=s),a.error="Failed to save sync repository update (state error)"})},deleteSyncRepo:async n=>{const r=t().syncRepos.find(s=>s.id===n);if(r)try{let s;try{s=await t()._ensureSyncVfsReady()}catch(a){throw console.error("ConversationStore: Failed to initialize sync VFS for deletion",a),Me.error("Failed to initialize filesystem for deletion. Repository not deleted."),a}await _t.deleteSyncRepo(n);const i=zr(`${nOe}/${n}`);try{await xD(i,!0,{fsInstance:s}),console.log(`[ConversationStore] Successfully deleted VFS directory: ${i}`)}catch(a){console.error(`[ConversationStore] Failed to delete VFS directory ${i}:`,a),a.code!=="ENOENT"&&console.warn(`Could not remove local sync folder for "${r.name}": ${a.message}`)}e(a=>({syncRepos:a.syncRepos.filter(o=>o.id!==n),repoInitializationStatus:Object.fromEntries(Object.entries(a.repoInitializationStatus).filter(([o])=>o!==n))})),Pe.emit(ds.repoChanged,{repoId:n,action:"deleted"}),Me.success(`Sync repository "${r.name}" deleted.`)}catch(s){throw console.error("ConversationStore: Error deleting sync repo",s),e(i=>{i.error="Failed to delete sync repository"}),s}},linkConversationToRepo:async(n,r)=>{await t().updateConversation(n,{syncRepoId:r,lastSyncedAt:null}),t()._setConversationSyncStatus(n,r?"needs-sync":"idle"),Me.info(`Conversation ${r?"linked to":"unlinked from"} sync repository.`)},_setConversationSyncStatus:(n,r,s=null)=>{e(i=>{i.conversationSyncStatus[n]=r,r==="error"&&s&&console.error(`Sync error for ${n}: ${s}`)}),Pe.emit(Jn.conversationSyncStatusChanged,{conversationId:n,status:r})},_setRepoInitializationStatus:(n,r)=>{e(s=>{s.repoInitializationStatus[n]=r}),Pe.emit(ds.repoInitStatusChanged,{repoId:n,status:r})},initializeOrSyncRepo:async(n,r=!1)=>{const s=t().syncRepos.find(a=>a.id===n);if(!s){r||Me.error("Sync repsitory configuration not found.");return}let i;try{i=await t()._ensureSyncVfsReady()}catch{t()._setRepoInitializationStatus(n,"error");return}await Q4e(i,s,t()._setRepoInitializationStatus,r)},syncConversation:async(n,r=!1)=>{const s=t().getConversationById(n);if(!s){r||Me.error("Conversation not found for syncing.");return}if(!s.syncRepoId){r||Me.info("Conversation not linked to a sync repository.");return}const i=t().syncRepos.find(l=>l.id===s.syncRepoId);if(!i){r||Me.error("Sync repository configuration not found."),t()._setConversationSyncStatus(n,"error","Repo not found");return}let a;try{a=await t()._ensureSyncVfsReady()}catch{t()._setConversationSyncStatus(n,"error","Filesystem not ready");return}await eOe(a,s,i,t()._setConversationSyncStatus,t().updateConversation,()=>t().selectedItemId,()=>t().selectedItemType,r);const o=t().getConversationById(n);o&&e(l=>{const c=l.conversations.findIndex(u=>u.id===n);c!==-1&&(l.conversations[c]=o)})},getConversationById:n=>{if(n)return t().conversations.find(r=>r.id===n)},syncAllConversations:async()=>{const{BulkSyncService:n}=await Zr(async()=>{const{BulkSyncService:r}=await Promise.resolve().then(()=>L0);return{BulkSyncService:r}},void 0);await n.syncAll({syncRepos:!1,syncConversations:!0,continueOnError:!0,maxConcurrent:3})},syncPendingConversations:async()=>{const{BulkSyncService:n}=await Zr(async()=>{const{BulkSyncService:r}=await Promise.resolve().then(()=>L0);return{BulkSyncService:r}},void 0);await n.syncPendingConversations()},initializeAllRepositories:async()=>{const{BulkSyncService:n}=await Zr(async()=>{const{BulkSyncService:r}=await Promise.resolve().then(()=>L0);return{BulkSyncService:r}},void 0);await n.initializeAllRepositories()},updateCurrentConversationToolSettings:async n=>{const{selectedItemId:r,selectedItemType:s,updateConversation:i}=t();if(s!=="conversation"||!r){console.warn("Cannot update tool settings: No conversation selected.");return}const a=t().getConversationById(r);if(!a){console.warn("Cannot update tool settings: Selected conversation not found.");return}const o=a.metadata??{},l={...o};n.enabledTools!==void 0&&(l.enabledTools=n.enabledTools),n.toolMaxStepsOverride!==void 0&&(l.toolMaxStepsOverride=n.toolMaxStepsOverride),(JSON.stringify(l)!==JSON.stringify(o)||!a.metadata)&&await i(r,{metadata:l})},_unlinkConversationsFromProjects:n=>{const r=new Set(n);e(s=>{s.conversations=s.conversations.map(i=>i.projectId&&r.has(i.projectId)?{...i,projectId:null}:i)})},getRegisteredActionHandlers:()=>{const n="conversationStore",r=t(),s=i=>async a=>{await i(a)};return[{eventName:Jn.loadConversationsRequest,handler:r.loadConversations,storeId:n},{eventName:Jn.addConversationRequest,handler:s(r.addConversation),storeId:n},{eventName:Jn.updateConversationRequest,handler:i=>r.updateConversation(i.id,i.updates),storeId:n},{eventName:Jn.deleteConversationRequest,handler:i=>r.deleteConversation(i.id),storeId:n},{eventName:Jn.selectItemRequest,handler:i=>r.selectItem(i.id,i.type),storeId:n},{eventName:Jn.importConversationRequest,handler:i=>r.importConversation(i.file),storeId:n},{eventName:Jn.exportConversationRequest,handler:i=>r.exportConversation(i.conversationId,i.format),storeId:n},{eventName:Jn.exportProjectRequest,handler:i=>r.exportProject(i.projectId),storeId:n},{eventName:Jn.exportAllConversationsRequest,handler:r.exportAllConversations,storeId:n},{eventName:Jn.loadSyncReposRequest,handler:r.loadSyncRepos,storeId:n},{eventName:Jn.addSyncRepoRequest,handler:s(r.addSyncRepo),storeId:n},{eventName:Jn.updateSyncRepoRequest,handler:i=>r.updateSyncRepo(i.id,i.updates),storeId:n},{eventName:Jn.deleteSyncRepoRequest,handler:i=>r.deleteSyncRepo(i.id),storeId:n},{eventName:Jn.linkConversationToRepoRequest,handler:i=>r.linkConversationToRepo(i.conversationId,i.repoId),storeId:n},{eventName:Jn.syncConversationRequest,handler:i=>r.syncConversation(i.conversationId),storeId:n},{eventName:Jn.initializeOrSyncRepoRequest,handler:i=>r.initializeOrSyncRepo(i.repoId),storeId:n},{eventName:Jn.updateCurrentConversationToolSettingsRequest,handler:i=>r.updateCurrentConversationToolSettings(i),storeId:n}]}}))),Sa={copyInteractionResponseRequest:"canvas.interaction.copy.response.request",regenerateInteractionRequest:"canvas.interaction.regenerate.request",regenerateInteractionWithModelRequest:"canvas.interaction.regenerate.with.model.request",forkConversationRequest:"canvas.interaction.fork.conversation.request",forkConversationWithModelRequest:"canvas.interaction.fork.conversation.with.model.request",raceInteractionRequest:"canvas.interaction.race.request",editResponseRequest:"canvas.interaction.edit.response.request",copyCodeBlockRequest:"canvas.codeblock.copy.request",editCodeBlockRequest:"canvas.codeblock.edit.request"},Qp={async submitPrompt(e){var P,B,D,W,O,Z;console.log("[ConversationService] submitPrompt called",e);const t=vn.getState(),n=zo.getState(),r=Fo.getState(),s=qn.getState(),i=br.getState(),a=t.currentConversationId;if(!a){Me.error("Cannot submit prompt: No active conversation."),console.error("[ConversationService] submitPrompt failed: No conversationId.");return}const o=s.getConversationById(a),l=(o==null?void 0:o.projectId)??null,c=n.getEffectiveProjectSettings(l),d=t.interactions.filter(U=>U.conversationId===a).length===0&&i.autoTitleEnabled&&((P=e.metadata)==null?void 0:P.autoTitleEnabledForTurn)===!0&&i.autoTitleModelId,m=t.interactions.filter(U=>U.parentId===null&&U.status==="COMPLETED").sort((U,H)=>U.index-H.index).map(U=>{var H;if(U.type==="message.assistant_regen"&&((H=U.metadata)!=null&&H.regeneratedFromId)){const L=t.interactions.find(te=>te.id===U.metadata.regeneratedFromId);if(L&&L.prompt&&L.type==="message.user_assistant")return{...U,prompt:L.prompt,type:"message.user_assistant"}}return U.type==="message.user_assistant"&&U.prompt?U:null}).filter(Boolean),y=bj(m);let b=e.content;const v=[],x=((B=e.metadata)==null?void 0:B.effectiveRulesContent)??[],w=x.filter(U=>U.type==="system").map(U=>U.content),S=x.filter(U=>U.type==="before").map(U=>U.content),k=x.filter(U=>U.type==="after").map(U=>U.content);S.length>0&&(b=`${S.join(`
`)}

${b}`),k.length>0&&(b=`${b}

    ${k.join(`
`)}`),b&&v.push({type:"text",text:b});const C=((D=e.metadata)==null?void 0:D.attachedFiles)??[];if(C.length>0){const U=await this._processFilesForPrompt(C,a);v.unshift(...U)}v.length>0?y.push({role:"user",content:v}):console.warn("[ConversationService] No user text or file content found in turnData. Submitting without user message.");let R=((W=e.metadata)==null?void 0:W.turnSystemPrompt)??c.systemPrompt??void 0;w.length>0&&(R=`${R?`${R}

        `:""}${w.join(`
`)}`);const N={temperature:r.temperature,max_tokens:r.maxTokens,top_p:r.topP,top_k:r.topK,presence_penalty:r.presencePenalty,frequency_penalty:r.frequencyPenalty,...e.parameters??{}};Object.keys(N).forEach(U=>{(N[U]===null||N[U]===void 0)&&delete N[U]});const I={system:R,messages:y,parameters:N,metadata:{...(({turnSystemPrompt:U,activeTagIds:H,activeRuleIds:L,effectiveRulesContent:te,autoTitleEnabledForTurn:V,...Q})=>({...Q,effectivelyAppliedTagIds:H,effectivelyAppliedRuleIds:L}))(e.metadata??{}),modelId:r.modelId??void 0,attachedFiles:(O=e.metadata.attachedFiles)==null?void 0:O.map(({contentBase64:U,contentText:H,...L})=>L)}};try{const U=pm.startInteraction(I,a,e);if(d){console.log("[ConversationService] Triggering asynchronous title generation.");const H=(((Z=e.metadata)==null?void 0:Z.effectiveRulesContent)??[]).map(L=>({id:L.sourceRuleId||as(),name:L.sourceRuleId?`Rule ${L.sourceRuleId.substring(0,4)}`:"Context Rule",content:L.content,type:L.type,createdAt:new Date,updatedAt:new Date}));this.generateConversationTitle(a,e,H).catch(L=>{console.error("[ConversationService] Background title generation failed:",L)})}await U}catch(U){throw console.error("[ConversationService] Error starting interaction:",U),Me.error(`Failed to start interaction: ${U instanceof Error?U.message:String(U)}`),U}},async generateConversationTitle(e,t,n){var o,l;const r=br.getState();if(!r.autoTitleModelId){console.warn("[ConversationService] Auto-title generation skipped: No model selected in settings.");return}let s=t.content;if(s.length>r.autoTitlePromptMaxLength&&(s=s.substring(0,r.autoTitlePromptMaxLength)+"..."),r.autoTitleIncludeFiles&&((l=(o=t.metadata)==null?void 0:o.attachedFiles)!=null&&l.length)){const c=t.metadata.attachedFiles.map(u=>u.name).join(", ");s+=`

[Attached files: ${c}]`}if(r.autoTitleIncludeRules&&n.length>0){const c=n.map(u=>u.name).join(", ");s+=`

[Active rules: ${c}]`}const i={system:"Generate a concise, descriptive title (max 8-10 words) for the following user prompt. Output ONLY the title text, nothing else.",messages:[{role:"user",content:s}],parameters:{temperature:.5,max_tokens:20},metadata:{modelId:r.autoTitleModelId,isTitleGeneration:!0},tools:void 0,toolChoice:"none"},a={id:as(),content:`[Generate title based on: ${t.content.substring(0,50)}...]`,parameters:i.parameters,metadata:{...i.metadata,originalTurnId:t.id}};try{await pm.startInteraction(i,e,a,"conversation.title_generation")}catch(c){console.error("[ConversationService] Error starting title generation interaction:",c)}},async regenerateInteraction(e){var D,W,O,Z;console.log(`[ConversationService] regenerateInteraction called for ID: ${e}`);const t=vn.getState(),n=zo.getState(),r=Fo.getState(),s=qn.getState(),i=t.interactions.find(U=>U.id===e);if(console.log("[ConversationService] Target interaction for regen:",JSON.parse(JSON.stringify(i))),!i||!i.prompt){Me.error("Cannot regenerate: Original interaction data missing.");return}const a=null,o=i.index,l=i.prompt,c=i.conversationId,u=s.getConversationById(c),d=(u==null?void 0:u.projectId)??null,h=n.getEffectiveProjectSettings(d),m=i.index,y=t.interactions.filter(U=>U.conversationId===c&&U.index<m&&U.status==="COMPLETED"&&U.type==="message.user_assistant"&&U.parentId===null).sort((U,H)=>U.index-H.index),b=bj(y);let v=l.content;const x=[],w=((D=l.metadata)==null?void 0:D.effectiveRulesContent)??[],S=w.filter(U=>U.type==="system").map(U=>U.content),k=w.filter(U=>U.type==="before").map(U=>U.content),C=w.filter(U=>U.type==="after").map(U=>U.content);k.length>0&&(v=`${k.join(`
`)}

${v}`),C.length>0&&(v=`${v}

    ${C.join(`
`)}`),v&&x.push({type:"text",text:v});const T=((W=l.metadata)==null?void 0:W.attachedFiles)??[];if(T.length>0){const U=await this._processFilesForPrompt(T,c);x.unshift(...U)}x.length>0?b.push({role:"user",content:x}):console.warn("[ConversationService] No user text or file content found in original turnData for regeneration.");let N=((O=l.metadata)==null?void 0:O.turnSystemPrompt)??h.systemPrompt??void 0;S.length>0&&(N=`${N?`${N}

        `:""}${S.join(`
`)}`);const I={temperature:r.temperature,max_tokens:r.maxTokens,top_p:r.topP,top_k:r.topK,presence_penalty:r.presencePenalty,frequency_penalty:r.frequencyPenalty,...l.parameters??{}};Object.keys(I).forEach(U=>{(I[U]===null||I[U]===void 0)&&delete I[U]});const P={system:N,messages:b,parameters:I,metadata:{...(({turnSystemPrompt:U,activeTagIds:H,activeRuleIds:L,effectiveRulesContent:te,autoTitleEnabledForTurn:V,...Q})=>({...Q,effectivelyAppliedTagIds:H,effectivelyAppliedRuleIds:L}))(l.metadata??{}),modelId:r.modelId??void 0,regeneratedFromId:e,attachedFiles:T.map(({contentBase64:U,contentText:H,...L})=>L)}};let B=null;try{if(B=await pm.startInteraction(P,c,l,"message.assistant_regen"),!B)throw new Error("Failed to create new interaction for regeneration.");const U={};let H=!1;B.index!==o&&(U.index=o,H=!0),B.parentId!==a&&(U.parentId=a,H=!0);let L=B;H&&(t._updateInteractionInState(B.id,U),L={...B,...U},await _t.saveInteraction(L)),console.log("[ConversationService] New active interaction state after potential updates:",JSON.parse(JSON.stringify(L)));const te=[];let V=i;for(;V;){te.push(V);const ee=(Z=V.metadata)==null?void 0:Z.regeneratedFromId;ee?V=t.interactions.find(se=>se.id===ee):V=null}const Q=te.sort((ee,se)=>{var Oe,Fe;const pe=((Oe=ee.startedAt)==null?void 0:Oe.getTime())??0,ue=((Fe=se.startedAt)==null?void 0:Fe.getTime())??0;return pe-ue});for(let ee=0;ee<Q.length;ee++){const se=Q[ee],pe={parentId:L.id,index:ee};console.log(`[ConversationService] Updating old version ${se.id} to be child of ${L.id} with childIndex ${ee}`,JSON.parse(JSON.stringify(pe))),t._updateInteractionInState(se.id,pe),await _t.saveInteraction({...se,...pe})}}catch(U){throw console.error("[ConversationService] Error during regeneration process:",U),Me.error(`Failed to regenerate response: ${U instanceof Error?U.message:String(U)}`),U}},_pendingForks:new Set,async forkConversation(e){if(console.log(`[ConversationService] forkConversation called for ID: ${e}`),this._pendingForks.has(e)){console.warn(`[ConversationService] Fork already in progress for ${e}`),Me.info("Fork already in progress for this interaction.");return}this._pendingForks.add(e);try{const t=vn.getState(),n=qn.getState(),r=t.interactions.find(l=>l.id===e);if(!r){Me.error("Cannot fork: Interaction not found.");return}const s=n.getConversationById(r.conversationId);if(!s){Me.error("Cannot fork: Original conversation not found.");return}const i=t.interactions.filter(l=>l.conversationId===r.conversationId&&l.index<=r.index&&l.parentId===null&&(l.type==="message.user_assistant"||l.type==="message.assistant_regen")).sort((l,c)=>l.index-c.index),a=`Fork: ${s.title}`,o=await n.addConversation({title:a,projectId:s.projectId,metadata:s.metadata});for(let l=0;l<i.length;l++){const c=i[l],u={...c,id:as(),conversationId:o,index:l,parentId:null,startedAt:new Date,endedAt:c.endedAt?new Date:null,metadata:{...c.metadata,forkedFromId:c.id}};await _t.saveInteraction(u)}await n.selectItem(o,"conversation"),Pe.emit(gn.focusInputRequest,void 0),Me.success(`Conversation forked successfully: "${a}"`)}catch(t){throw console.error("[ConversationService] Error during fork process:",t),Me.error(`Failed to fork conversation: ${t instanceof Error?t.message:String(t)}`),t}finally{this._pendingForks.delete(e)}},async _processFilesForPrompt(e,t){const n=[],r=e.filter(i=>i.source==="vfs");let s;if(r.length>0){const i=qn.getState().getConversationById(t),a=(i==null?void 0:i.projectId)??"orphan";try{s=await this._ensureVfsReady(a)}catch{Me.error(`Filesystem unavailable for key ${a}. VFS files cannot be processed.`),r.forEach(l=>{n.push({type:"text",text:`[Skipped VFS file: ${l.name} - Filesystem unavailable]`})}),s=void 0}}for(const i of e){let a=null;try{if(i.source==="direct")a=T$(i);else if(i.source==="vfs"&&s&&i.path){console.log(`[ConversationService] Fetching VFS file: ${i.path}`);const o=await Zh(i.path,{fsInstance:s});a=T$({...i,contentBytes:o})}else if(i.source==="vfs"&&!s)continue;a&&n.push(a)}catch(o){console.error(`[ConversationService] Error processing file ${i.name}:`,o),n.push({type:"text",text:`[Error processing file: ${i.name}]`})}}return n},async _ensureVfsReady(e){return console.log(`[ConversationService] Ensuring VFS ready for key "${e}"...`),new Promise((t,n)=>{const r=o=>{ei.getState().configuredVfsKey===e&&(i(),t(o.fsInstance))},s=o=>{if(ei.getState().configuredVfsKey===e&&!o.isLoading&&!o.operationLoading)if(o.error)i(),n(new Error(o.error));else{const l=ei.getState().fs;l&&(i(),t(l))}},i=()=>{Pe.off(dn.fsInstanceChanged,r),Pe.off(dn.loadingStateChanged,s)};Pe.on(dn.fsInstanceChanged,r),Pe.on(dn.loadingStateChanged,s);const a=ei.getState();if(a.configuredVfsKey===e&&a.fs&&!a.loading&&!a.operationLoading&&!a.error){i(),t(a.fs);return}if(a.configuredVfsKey===e&&a.error&&!a.loading&&!a.operationLoading){i(),n(new Error(a.error));return}Pe.emit(dn.initializeVFSRequest,{vfsKey:e,options:{force:!0}})})}},pm={_activeControllers:new Map,_streamingToolData:new Map,_firstChunkTimestamps:new Map,_interactionStartTimes:new Map,_pendingRegenerations:new Set,initializeCanvasEventHandlers(){Pe.on(Sa.copyInteractionResponseRequest,async e=>{const{interactionId:t}=e,n=vn.getState().interactions.find(s=>s.id===t);if(!n){Me.error(`Copy failed: Interaction ${t} not found.`),console.warn(`[InteractionService] Copy request for unknown interaction ${t}`);return}const r=n.response??"";if(typeof r!="string"||r.trim()===""){Me.info("No response content to copy.");return}try{await navigator.clipboard.writeText(r),Me.success("Response copied!")}catch(s){Me.error("Failed to copy response."),console.error("[InteractionService] Error copying response:",s)}}),Pe.on(Sa.regenerateInteractionRequest,async e=>{const{interactionId:t}=e;if(console.log(`[InteractionService] Received regenerateInteractionRequest for ${t}`),this._pendingRegenerations.has(t)){console.warn(`[InteractionService] Regeneration already pending for ${t}. Ignoring request.`);return}const n=vn.getState().interactions.find(o=>o.id===t);if(!n){Me.error(`Regeneration failed: Interaction ${t} not found.`),console.warn(`[InteractionService] Regeneration request for unknown interaction ${t}`);return}const r=vn.getState();if(r.status==="streaming"){Me.info("Cannot regenerate while another response is streaming.");return}const i=r.interactions.filter(o=>o.conversationId===n.conversationId&&o.parentId===null&&(o.type==="message.user_assistant"||o.type==="message.assistant_regen")).sort((o,l)=>o.index-l.index),a=i.length>0?i[i.length-1]:null;if((a==null?void 0:a.id)!==t){Me.info("Can only regenerate the last response in the conversation.");return}try{this._pendingRegenerations.add(t),await Qp.regenerateInteraction(t)}catch(o){Me.error(`Failed to regenerate response: ${String(o)}`),console.error(`[InteractionService] Error regenerating interaction ${t}:`,o)}finally{this._pendingRegenerations.delete(t)}}),Pe.on(Sa.regenerateInteractionWithModelRequest,async e=>{const{interactionId:t,modelId:n}=e;if(this._pendingRegenerations.has(t)){console.warn(`[InteractionService] Regeneration already pending for ${t}. Ignoring request.`);return}const r=vn.getState().interactions.find(l=>l.id===t);if(!r){Me.error(`Regeneration failed: Interaction ${t} not found.`),console.warn(`[InteractionService] Regeneration request for unknown interaction ${t}`);return}const s=vn.getState();if(s.status==="streaming"){Me.info("Cannot regenerate while another response is streaming.");return}const a=s.interactions.filter(l=>l.conversationId===r.conversationId&&l.parentId===null&&(l.type==="message.user_assistant"||l.type==="message.assistant_regen")).sort((l,c)=>l.index-c.index),o=a.length>0?a[a.length-1]:null;if((o==null?void 0:o.id)!==t){Me.info("Can only regenerate the last response in the conversation.");return}try{this._pendingRegenerations.add(t);const l=Fo.getState(),c=l.modelId;console.log(`[InteractionService] Temporarily setting model to ${n} for regeneration`),l.setModelId(n);try{await Qp.regenerateInteraction(t)}finally{console.log(`[InteractionService] Restoring original model ${c}`),l.setModelId(c)}}catch(l){Me.error(`Failed to regenerate response: ${String(l)}`),console.error(`[InteractionService] Error regenerating interaction ${t}:`,l)}finally{this._pendingRegenerations.delete(t)}}),Pe.on(Sa.raceInteractionRequest,async e=>{const{interactionId:t,modelIds:n,staggerMs:r}=e,s=vn.getState().interactions.find(c=>c.id===t);if(!s){Me.error(`Race failed: Interaction ${t} not found.`),console.warn(`[InteractionService] Race request for unknown interaction ${t}`);return}const i=vn.getState();if(i.status==="streaming"){Me.info("Cannot start race while another response is streaming.");return}const o=i.interactions.filter(c=>c.conversationId===s.conversationId&&c.parentId===null&&(c.type==="message.user_assistant"||c.type==="message.assistant_regen")).sort((c,u)=>c.index-u.index),l=o.length>0?o[o.length-1]:null;if((l==null?void 0:l.id)!==t){Me.info("Can only race from the last response in the conversation.");return}if(n.length<2){Me.error("Need at least 2 models to race");return}try{const c=Fo.getState(),u=c.modelId;console.log(`[InteractionService] Starting race with ${n.length} models`),Me.info(`Starting race with ${n.length} models...`);const d=n.map((b,v)=>new Promise(x=>{setTimeout(async()=>{try{c.setModelId(b),await Qp.regenerateInteraction(t),x({success:!0,modelId:b,index:v})}catch(w){console.error(`[InteractionService] Race participant ${v+1} failed:`,w),x({success:!1,modelId:b,index:v,error:w})}},v*r)})),h=await Promise.all(d);c.setModelId(u);const m=h.filter(b=>b.success).length,y=h.length-m;m>0?Me.success(`Race completed! ${m} models responded${y>0?`, ${y} failed`:""}`):Me.error(`Race failed: All ${n.length} models failed to respond`)}catch(c){Me.error(`Race failed: ${String(c)}`),console.error("[InteractionService] Error during race:",c)}}),Pe.on(Sa.forkConversationRequest,async e=>{const{interactionId:t}=e;if(console.log(`[InteractionService] Received forkConversationRequest for ${t}`),!vn.getState().interactions.find(i=>i.id===t)){Me.error(`Fork failed: Interaction ${t} not found.`),console.warn(`[InteractionService] Fork request for unknown interaction ${t}`);return}if(vn.getState().status==="streaming"){Me.info("Cannot fork while another response is streaming.");return}try{await Qp.forkConversation(t)}catch(i){Me.error(`Failed to fork conversation: ${String(i)}`),console.error(`[InteractionService] Error forking conversation ${t}:`,i)}}),Pe.on(Sa.forkConversationWithModelRequest,async e=>{const{interactionId:t,modelId:n}=e;if(console.log(`[InteractionService] Received forkConversationWithModelRequest for ${t} with model ${n}`),!vn.getState().interactions.find(a=>a.id===t)){Me.error(`Fork failed: Interaction ${t} not found.`),console.warn(`[InteractionService] Fork request for unknown interaction ${t}`);return}if(vn.getState().status==="streaming"){Me.info("Cannot fork while another response is streaming.");return}try{console.log(`[InteractionService] Creating fork conversation first, then setting model to ${n}`),await Qp.forkConversation(t),await new Promise(a=>requestAnimationFrame(a)),console.log(`[InteractionService] Setting global model to ${n} for the new forked conversation`),Pe.emit(Qn.selectModelRequest,{modelId:n})}catch(a){Me.error(`Failed to fork conversation: ${String(a)}`),console.error(`[InteractionService] Error forking conversation ${t}:`,a)}}),Pe.on(Sa.copyCodeBlockRequest,async e=>{const{content:t,interactionId:n,codeBlockId:r,language:s}=e;if(!t||t.trim()===""){Me.info("No code to copy.");return}try{await navigator.clipboard.writeText(t),Me.success(`Code block ${s?`(${s}) `:""}copied!`),console.log(`[InteractionService] Code block copied. InteractionID: ${n}, CodeBlockID: ${r}, Language: ${s}`)}catch(i){Me.error("Failed to copy code block."),console.error("[InteractionService] Error copying code block:",i)}})},async startInteraction(e,t,n,r="message.user_assistant"){var O,Z,U,H,L,te,V,Q,ee,se,pe,ue,Oe,Fe;console.log(`[InteractionService] startInteraction called (Type: ${r})`,e,t,n);const s=await PC(iy.INTERACTION_BEFORE_START,{prompt:e,conversationId:t});if(s===!1)return console.log("[InteractionService] Interaction start cancelled by middleware."),null;const i=s&&typeof s=="object"?s.prompt:e,a=as(),o=new AbortController;this._activeControllers.set(a,o),this._streamingToolData.set(a,{calls:[],results:[]}),this._firstChunkTimestamps.delete(a),this._interactionStartTimes.delete(a);const l=vn.getState(),u=l.interactions.filter(Se=>Se.conversationId===t),d=r==="conversation.title_generation"?-1:u.reduce((Se,Ce)=>Math.max(Se,Ce.index),-1)+1,h=null,m=performance.now();this._interactionStartTimes.set(a,m);const y={id:a,conversationId:t,type:r,prompt:{...n},response:null,status:"STREAMING",startedAt:new Date,endedAt:null,metadata:{...i.metadata||{},toolCalls:[],toolResults:[],reasoning:void 0,timeToFirstToken:void 0,generationTime:void 0,isTitleGeneration:r==="conversation.title_generation"},index:d,parentId:h};r!=="conversation.title_generation"?(l._addInteractionToState(y),l._addStreamingId(a)):(l._addInteractionToState(y),l._addStreamingId(a),console.log(`[InteractionService] Added title generation interaction ${a} to state.`)),_t.saveInteraction({...y}).catch(Se=>{console.error(`[InteractionService] Failed initial persistence for ${a}`,Se)}),Pe.emit(Zn.started,{interactionId:a,conversationId:t,type:y.type});const b=(O=i.metadata)==null?void 0:O.modelId;if(!b)return this._finalizeInteraction(a,"ERROR",new Error("No model ID specified in prompt metadata."),r),null;const{providerId:v,modelId:x}=Tc(b);if(!v||!x)return this._finalizeInteraction(a,"ERROR",new Error(`Invalid combined model ID format: ${b}`),r),null;const w=Cr.getState().dbProviderConfigs.find(Se=>Se.id===v);if(!w)return this._finalizeInteraction(a,"ERROR",new Error(`Provider configuration not found for ID: ${v}`),r),null;const S=Cr.getState().getApiKeyForProvider(v),k=sP(w,x,S);if(!k)return this._finalizeInteraction(a,"ERROR",new Error(`Failed to instantiate model instance ${b} from provider ${w.name}`),r),null;console.log(`[InteractionService] Using model instance for ${b}`);const C=r!=="conversation.title_generation"?(((Z=i.metadata)==null?void 0:Z.enabledTools)??[]).reduce((Se,Ce)=>{if(Ce.startsWith("mcp_")){const qe=globalThis.mcpToolsModuleInstance;if(qe&&qe.mcpClients){const Qe=Ce.substring(4).split("_");if(Qe.length>=2){const We=Qe[0],Ie=Qe.slice(1).join("_");for(const[,K]of qe.mcpClients)if(K.name===We&&K.tools[Ie]){const ye=Vi.getState().getRegisteredTools(),Ne=`mcp_${We}_${Ie}`,ce=ye[Ne];if(ce&&ce.definition){const oe={description:ce.definition.description,parameters:ce.definition.parameters,execute:async re=>{if(ce.implementation)return await ce.implementation(re,E$());throw console.error(`[InteractionService] MCP tool ${Ie} has no implementation`),new Error(`MCP tool ${Ie} has no implementation`)}};Se[Ce]=oe}else console.warn(`[InteractionService] MCP tool ${Ne} not found in control registry`);break}}}}else{const Qe=Vi.getState().getRegisteredTools()[Ce];if(Qe&&Qe.implementation){const We={description:Qe.definition.description,parameters:Qe.definition.parameters,execute:async Ie=>{const K=vn.getState().currentConversationId,ye=K?qn.getState().getConversationById(K):null;let Ne;ye&&ye.projectId?typeof ye.projectId=="string"?Ne=ye.projectId:(console.warn(`[InteractionService] conversation.projectId for conversation ${K} is not a string (type: ${typeof ye.projectId}). Defaulting VFS key to "orphan". Value:`,ye.projectId),Ne="orphan"):Ne="orphan";let ce;try{if(Pe.emit(dn.initializeVFSRequest,{vfsKey:Ne,options:{force:!0}}),await new Promise(oe=>setTimeout(oe,100)),ce=ei.getState().fs,ei.getState().configuredVfsKey!==Ne||!ce)throw new Error(`Filesystem for key "${Ne}" not ready after request.`)}catch(oe){throw new Error(`Filesystem error: ${oe.message}`)}try{const oe=E$(),re=Qe.definition.parameters.parse(Ie),Re=Qe.implementation,Be={...oe,fsInstance:ce};return await Re(re,Be)}catch(oe){throw oe instanceof Oc?new Error(`Invalid arguments: ${oe.errors.map(re=>`${re.path.join(".")} (${re.message})`).join(", ")}`):new Error(oe instanceof Error?oe.message:String(oe))}}};Se[Ce]=We}}return Se},{}):void 0,{getSelectedModel:T}=Cr.getState(),R=T(),N=((H=(U=R==null?void 0:R.metadata)==null?void 0:U.supported_parameters)==null?void 0:H.includes("tools"))??!1,I=(((L=i.metadata)==null?void 0:L.enabledTools)??[]).filter(Se=>Se.startsWith("mcp_")).length,P=(((te=i.metadata)==null?void 0:te.enabledTools)??[]).filter(Se=>!Se.startsWith("mcp_")).length;!N&&(I>0||P>0)&&console.warn(`[InteractionService] Model ${(R==null?void 0:R.name)||"unknown"} does not support tools. Ignoring ${I+P} enabled tools.`);const B=((V=i.parameters)==null?void 0:V.maxSteps)??br.getState().toolMaxSteps,D={model:k,messages:i.messages,abortSignal:o.signal,system:i.system,temperature:(Q=i.parameters)==null?void 0:Q.temperature,maxTokens:(ee=i.parameters)==null?void 0:ee.max_tokens,topP:(se=i.parameters)==null?void 0:se.top_p,topK:(pe=i.parameters)==null?void 0:pe.top_k,presencePenalty:(ue=i.parameters)==null?void 0:ue.presence_penalty,frequencyPenalty:(Oe=i.parameters)==null?void 0:Oe.frequency_penalty,maxSteps:B,...N&&C&&Object.keys(C).length>0&&{tools:C},...((Fe=i.parameters)==null?void 0:Fe.providerOptions)&&{providerOptions:i.parameters.providerOptions},...N&&i.toolChoice&&{toolChoice:i.toolChoice}},W={onChunk:Se=>this._handleChunk(a,Se),onReasoningChunk:Se=>this._handleReasoningChunk(a,Se),onToolCall:Se=>this._handleToolCall(a,Se),onToolResult:Se=>this._handleToolResult(a,Se),onFinish:Se=>this._handleFinish(a,Se,r),onError:Se=>this._handleError(a,Se,r)};return console.log(`[InteractionService] Calling AIService.executeInteraction for ${a}`),Y4e.executeInteraction(a,D,W).catch(Se=>{console.error(`[InteractionService] Error during AIService.executeInteraction for ${a}:`,Se);const Ce=vn.getState().interactions.find(qe=>qe.id===a);Ce&&Ce.status==="STREAMING"&&this._finalizeInteraction(a,"ERROR",Se instanceof Error?Se:new Error(String(Se)),r)}),y},abortInteraction(e){console.log(`[InteractionService] Aborting interaction ${e}`);const t=this._activeControllers.get(e);if(t&&!t.signal.aborted)t.abort(),Me.info("Interaction cancelled.");else{console.warn(`[InteractionService] No active controller found or already aborted for ${e}.`);const n=vn.getState(),r=n.interactions.find(s=>s.id===e);n.streamingInteractionIds.includes(e)&&(console.warn(`[InteractionService] Forcing cleanup for potentially stuck interaction ${e}`),this._finalizeInteraction(e,"CANCELLED",new Error("Interaction aborted manually (controller missing)"),(r==null?void 0:r.type)??"message.user_assistant"))}},async _handleChunk(e,t){this._firstChunkTimestamps.has(e)||this._firstChunkTimestamps.set(e,performance.now());const n={interactionId:e,chunk:t},r=await PC(iy.INTERACTION_PROCESS_CHUNK,n);if(r!==!1){const s=r&&typeof r=="object"&&"chunk"in r?r.chunk:t;vn.getState().appendInteractionResponseChunk(e,s),Pe.emit(Zn.streamChunk,{interactionId:e,chunk:s})}},_handleReasoningChunk(e,t){vn.getState().appendReasoningChunk(e,t)},_handleToolCall(e,t){try{const n=JSON.stringify(t),r=this._streamingToolData.get(e)||{calls:[],results:[]};r.calls.push(n),this._streamingToolData.set(e,r),vn.getState()._updateInteractionInState(e,{metadata:{toolCalls:[...r.calls]}})}catch(n){console.error(`[InteractionService] Failed to process tool call for ${e}:`,n)}},_handleToolResult(e,t){try{const n=JSON.stringify(t),r=this._streamingToolData.get(e)||{calls:[],results:[]};r.results.push(n),this._streamingToolData.set(e,r),vn.getState()._updateInteractionInState(e,{metadata:{toolResults:[...r.results]}})}catch(n){console.error(`[InteractionService] Failed to process tool result for ${e}:`,n)}},_handleFinish(e,t,n){console.log(`[InteractionService] Finishing interaction ${e} (Type: ${n}). Reason: ${t.finishReason}`),this._finalizeInteraction(e,"COMPLETED",void 0,n,t)},_handleError(e,t,n){console.error(`[InteractionService] Handling error for interaction ${e} (Type: ${n}):`,t);const r=t.name==="AbortError";this._finalizeInteraction(e,r?"CANCELLED":"ERROR",r?void 0:t,n)},_finalizeInteraction(e,t,n,r="message.user_assistant",s){var C;const i=vn.getState(),a=i.interactions.find(T=>T.id===e);if(!a||a.status!=="STREAMING"&&r!=="conversation.title_generation"){console.warn(`[InteractionService] Interaction ${e} already finalized or not found. Skipping finalization with status ${t}.`),this._activeControllers.delete(e),this._streamingToolData.delete(e),this._interactionStartTimes.delete(e),this._firstChunkTimestamps.delete(e);return}const o=i.activeStreamBuffers[e]??"",l=i.activeReasoningBuffers[e]??"",c=this._streamingToolData.get(e)||{calls:[],results:[]},u=(a==null?void 0:a.metadata)||{};console.log(`[InteractionService] Finalizing ${e}. Buffered Content Length: ${o.length}, Reasoning Length: ${l.length}`);const d=performance.now(),h=this._interactionStartTimes.get(e),m=this._firstChunkTimestamps.get(e),y=h?Math.round(d-h):void 0,b=h&&m?Math.round(m-h):void 0,v=(s==null?void 0:s.reasoning)??l,x={status:t,endedAt:new Date,response:o||null,metadata:{...u,...(s==null?void 0:s.usage)&&{promptTokens:s.usage.promptTokens,completionTokens:s.usage.completionTokens,totalTokens:s.usage.totalTokens},...(s==null?void 0:s.providerMetadata)&&{providerMetadata:s.providerMetadata},toolCalls:c.calls,toolResults:c.results,reasoning:v||void 0,timeToFirstToken:b,generationTime:y,...(t==="ERROR"||t==="WARNING"||t==="CANCELLED")&&{error:(n==null?void 0:n.message)??"Interaction ended unexpectedly."}}};if(r==="conversation.title_generation"&&t==="COMPLETED"&&x.response&&typeof x.response=="string"){const T=x.response.trim().replace(/^"|"$/g,"");T&&a&&(console.log(`[InteractionService] Updating conversation ${a.conversationId} title to: "${T}"`),Pe.emit(Jn.updateConversationRequest,{id:a.conversationId,updates:{title:T}}))}i._updateInteractionInState(e,x),i._removeStreamingId(e);const w=vn.getState().interactions.find(T=>T.id===e);w?(console.log(`[InteractionService] Persisting final state for ${e}. Response length: ${((C=w.response)==null?void 0:C.length)??0}`),_t.saveInteraction({...w}).catch(T=>{console.error(`[InteractionService] Failed final persistence for ${e}`,T)})):console.error(`[InteractionService] CRITICAL - Could not find final state for interaction ${e} to persist.`);let S=[],k=[];try{S=c.calls.map(T=>JSON.parse(T)),k=c.results.map(T=>JSON.parse(T))}catch(T){console.error("[InteractionService] Failed to parse tool strings for event emitter:",T)}Pe.emit(Zn.completed,{interactionId:e,status:t,error:n==null?void 0:n.message,toolCalls:S,toolResults:k}),this._activeControllers.delete(e),this._streamingToolData.delete(e),this._interactionStartTimes.delete(e),this._firstChunkTimestamps.delete(e),console.log(`[InteractionService] Finalized interaction ${e} with status ${t}.`)}},dk=Ve.memo(({interactionId:e,className:t,renderSlot:n,showPrompt:r=!0})=>{var O;const{interaction:s,interactionStatus:i}=vn(yn(Z=>{const U=Z.interactions.find(H=>H.id===e);return{interaction:U,interactionStatus:U==null?void 0:U.status}})),a=br(Z=>Z.streamingRenderFPS),[o,l]=E.useState(""),[c,u]=E.useState(""),[d,h]=E.useState(!0),[m,y]=E.useState(!1),b=E.useRef(null),v=E.useRef(0),x=E.useRef(null);E.useEffect(()=>{const Z=1e3/a;let U=!0;const H=L=>{if(!U)return;if(vn.getState().streamingInteractionIds.includes(e)){if(L-v.current>=Z){const V=vn.getState().activeStreamBuffers[e]??"",Q=vn.getState().activeReasoningBuffers[e]??"";l(V),u(Q),v.current=L}b.current=requestAnimationFrame(H)}else{const V=vn.getState().activeStreamBuffers[e]??"",Q=vn.getState().activeReasoningBuffers[e]??"";l(V),u(Q),b.current=null}};return b.current=requestAnimationFrame(H),()=>{U=!1,b.current&&(cancelAnimationFrame(b.current),b.current=null)}},[e,a]),E.useEffect(()=>{if(i&&i!=="STREAMING"){const Z=vn.getState().activeStreamBuffers[e]??"",U=vn.getState().activeReasoningBuffers[e]??"";l(Z),u(U),b.current&&(cancelAnimationFrame(b.current),b.current=null)}},[i,e]);const{dbProviderConfigs:w,getAllAvailableModelDefsForProvider:S}=Cr(yn(Z=>({dbProviderConfigs:Z.dbProviderConfigs,getAllAvailableModelDefsForProvider:Z.getAllAvailableModelDefsForProvider}))),k=E.useMemo(()=>{var ee;const Z=(ee=s==null?void 0:s.metadata)==null?void 0:ee.modelId;if(!Z)return"Loading Model...";const{providerId:U,modelId:H}=Tc(Z);if(!U||!H)return Z;const L=w.find(se=>se.id===U),te=(L==null?void 0:L.name)??U,Q=S(U).find(se=>se.id===H);return`${(Q==null?void 0:Q.name)??H} (${te})`},[(O=s==null?void 0:s.metadata)==null?void 0:O.modelId,w,S]),C=E.useCallback(()=>h(Z=>!Z),[]),T=E.useCallback(()=>{y(!1)},[]),R=E.useCallback(()=>{y(!0)},[]),N=E.useCallback(()=>{m?T():R()},[m,T,R]);if(!s)return r?f.jsxs("div",{className:Xe("group/card relative rounded-lg border border-primary/30 bg-card p-4 shadow-sm animate-pulse",t),children:[f.jsx("div",{className:"h-8 bg-muted rounded w-3/4 mb-4"}),f.jsxs("div",{className:"mt-3 pt-3 border-t border-border/50",children:[f.jsxs("div",{className:"flex justify-between items-center mb-2",children:[f.jsx("span",{className:"text-xs font-medium text-muted-foreground",children:"Assistant (Loading...)"}),f.jsx("span",{className:"text-xs text-muted-foreground",children:"Streaming..."})]}),f.jsxs("div",{className:"space-y-2 mt-2",children:[f.jsx("div",{className:"h-4 bg-muted rounded w-full"}),f.jsx("div",{className:"h-4 bg-muted rounded w-5/6"}),f.jsx("div",{className:"h-4 bg-muted rounded w-full"})]})]})]}):f.jsxs("div",{className:Xe("group/card relative rounded-lg border border-primary/30 bg-card p-4 shadow-sm animate-pulse",t),children:[f.jsxs("div",{className:"flex justify-between items-center mb-2",children:[f.jsx("span",{className:"text-xs font-medium text-muted-foreground",children:"Assistant (Loading...)"}),f.jsx("span",{className:"text-xs text-muted-foreground",children:"Streaming..."})]}),f.jsxs("div",{className:"space-y-2 mt-2",children:[f.jsx("div",{className:"h-4 bg-muted rounded w-full"}),f.jsx("div",{className:"h-4 bg-muted rounded w-5/6"}),f.jsx("div",{className:"h-4 bg-muted rounded w-full"})]})]});const I=()=>{pm.abortInteraction(e)},P=n==null?void 0:n("header-actions",s,{isFolded:m,toggleFold:N}),B=n==null?void 0:n("actions",s),D=n==null?void 0:n("content",s),W=n==null?void 0:n("menu",s);return f.jsxs("div",{ref:x,className:Xe("group/card relative rounded-lg border bg-card p-3 md:p-4 shadow-sm transition-colors",i==="ERROR"?"border-destructive/50 bg-destructive/5":i==="STREAMING"?"border-primary/30":"border-border",t),children:[r&&s.prompt&&f.jsx(mT,{turnData:s.prompt,timestamp:s.startedAt,isAssistantComplete:!1,interactionId:s.id}),f.jsxs("div",{className:Xe("relative group/assistant",r&&s.prompt?"mt-3 pt-3 border-t border-border/50":""),children:[W,f.jsxs("div",{className:Xe("flex flex-col sm:flex-row justify-between items-start mb-2 sticky top-0 bg-card/80 backdrop-blur-sm z-20 p-1 -m-1 rounded-t"),children:[f.jsxs("div",{className:"flex items-start gap-1 min-w-0 mb-1 sm:mb-0",children:[f.jsx(X0,{className:"h-4 w-4 text-secondary flex-shrink-0 mt-0.5"}),f.jsx("div",{className:"flex flex-col min-w-0",children:f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsxs("span",{className:"text-xs font-semibold text-secondary truncate mr-1",children:["Assistant (",k,")"]}),f.jsx("div",{className:"flex items-center gap-0.5 opacity-0 group-hover/assistant:opacity-100 focus-within:opacity-100 transition-opacity",children:P})]})})]}),f.jsx("div",{className:"flex items-start flex-shrink-0 gap-1 self-end sm:self-start",children:f.jsx("span",{className:"text-xs text-muted-foreground mt-0.5",children:"Streaming..."})})]}),!m&&f.jsxs(f.Fragment,{children:[D,c&&f.jsxs("div",{className:"my-2 p-2 border border-blue-500/30 bg-blue-500/10 rounded-md text-xs",children:[f.jsxs("div",{className:"flex items-center justify-between mb-1 cursor-pointer group/reasoning",onClick:C,children:[f.jsxs("span",{className:"font-semibold text-blue-700 dark:text-blue-300 flex items-center gap-1",children:[f.jsx(Uy,{className:"h-3.5 w-3.5"})," Reasoning (Streaming)"]}),f.jsx("div",{className:"flex items-center opacity-0 group-hover/reasoning:opacity-100 focus-within:opacity-100 transition-opacity",children:f.jsx(Un,{tooltipText:d?"Show Reasoning":"Hide Reasoning",onClick:Z=>{Z.stopPropagation(),C()},"aria-label":d?"Show reasoning":"Hide reasoning",icon:d?f.jsx(Jl,{}):f.jsx(Bh,{}),iconClassName:"h-3 w-3",className:"h-5 w-5 text-muted-foreground"})})]}),!d&&f.jsx("pre",{className:"whitespace-pre-wrap text-xs font-mono p-2 bg-background/30 rounded mt-1 overflow-wrap-anywhere",children:c})]}),f.jsx(ZMe,{interactionId:e,markdownContent:o,isStreaming:!0})]}),m&&f.jsxs("div",{className:"text-xs text-muted-foreground italic cursor-pointer hover:bg-muted/20 p-1 rounded",onClick:N,children:[c?"[Reasoning] ":"",o&&typeof o=="string"?`"${o.substring(0,80)}${o.length>80?"...":""}"`:"[Streaming...]"]})]}),f.jsxs("div",{className:Xe("absolute bottom-1 left-1 md:bottom-2 md:left-2 flex items-center space-x-0.5 md:space-x-1 opacity-0 group-hover/card:opacity-100 transition-opacity duration-200","bg-card/80 backdrop-blur-sm p-0.5 md:p-1 rounded-md shadow-md z-20"),children:[B,f.jsx(XMe,{onStop:I,"aria-label":"Stop Generation"})]})]})});dk.displayName="StreamingInteractionCard";const y7=e=>e===void 0?"?":e<1e3?`${e}ms`:`${(e/1e3).toFixed(2)}s`,rOe=({displayModelName:e,timeAgo:t,promptTokens:n,completionTokens:r,timeToFirstToken:s,generationTime:i,headerActionsSlot:a})=>{const o=n!==void 0&&r!==void 0?n+r:void 0;return f.jsxs("div",{className:Xe("flex flex-col sm:flex-row justify-between items-start mb-2 sticky top-0 bg-card/80 backdrop-blur-sm z-20 p-1 -m-1 rounded-t"),children:[f.jsxs("div",{className:"flex items-start gap-1 min-w-0 mb-1 sm:mb-0",children:[f.jsx(X0,{className:"h-4 w-4 text-secondary flex-shrink-0 mt-0.5"}),f.jsxs("div",{className:"flex flex-col min-w-0",children:[f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsxs("span",{className:"text-xs font-semibold text-secondary truncate mr-1",children:["Assistant (",e,")"]}),f.jsx("div",{className:"flex items-center gap-0.5 opacity-0 group-hover/assistant:opacity-100 focus-within:opacity-100 transition-opacity",children:a})]}),f.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground mt-0.5 flex-wrap",children:[o!==void 0&&f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsxs(_r,{className:"flex items-center gap-0.5 cursor-default",children:[f.jsx(eme,{className:"h-3 w-3"}),f.jsx("span",{children:o.toLocaleString()})]}),f.jsxs(Sr,{side:"bottom",children:["Tokens: ",n??"?"," (Prompt) +"," ",r??"?"," (Completion) = ",o]})]})}),s!==void 0&&f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsxs(_r,{className:"flex items-center gap-0.5 cursor-default",children:[f.jsx(n0e,{className:"h-3 w-3"}),f.jsx("span",{children:y7(s)})]}),f.jsx(Sr,{side:"bottom",children:"Time to First Token"})]})}),i!==void 0&&f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsxs(_r,{className:"flex items-center gap-0.5 cursor-default",children:[f.jsx(Kpe,{className:"h-3 w-3"}),f.jsx("span",{children:y7(i)})]}),f.jsx(Sr,{side:"bottom",children:"Total Generation Time"})]})})]})]})]}),f.jsx("div",{className:"flex items-start flex-shrink-0 gap-1 self-end sm:self-start",children:f.jsx("span",{className:"text-xs text-muted-foreground mt-0.5",children:t})})]})},sOe=({markdownContent:e,interactionId:t})=>{const n=pT(e);return e!=null&&e.trim()?f.jsx("div",{className:"overflow-wrap-anywhere",children:n.map((r,s)=>typeof r=="string"?f.jsx("div",{className:"markdown-content",dangerouslySetInnerHTML:{__html:r}},`html-${s}`):r.type==="block"?f.jsx(Yy,{lang:r.lang,code:r.code,filepath:r.filepath,interactionId:t},`block-${s}`):null)}):null},iOe=({interactionId:e,response:t,toolCalls:n,toolResults:r,reasoning:s,isError:i,errorMessage:a,isFolded:o,toggleFold:l})=>{const[c,u]=E.useState(!0),[d,h]=E.useState(!1),m=Vi(yn(C=>Object.values(C.canvasControls))),y=E.useCallback((C,T)=>m.filter(R=>R.type==="tool-call-step"&&R.targetSlot===C&&R.renderer).map(R=>R.renderer?f.jsx(Ve.Fragment,{children:R.renderer(T)},R.id):null).filter(Boolean),[m]),b=E.useMemo(()=>{if(!n)return[];const C=n.map(R=>JSON.parse(R)),T=(r==null?void 0:r.map(R=>JSON.parse(R)))??[];return C.map(R=>{const N=T.find(I=>I.toolCallId===R.toolCallId);return{call:R,result:N}})},[n,r]),v=E.useCallback(()=>u(C=>!C),[]),x=E.useCallback(async()=>{if(s)try{await navigator.clipboard.writeText(s),h(!0),Me.success("Reasoning copied!"),setTimeout(()=>h(!1),1500)}catch(C){Me.error("Failed to copy reasoning."),console.error("Clipboard copy failed for reasoning:",C)}},[s]),w=!!s,S=t&&(typeof t!="string"||t.trim().length>0),k=b&&b.length>0;return o?f.jsxs("div",{className:"text-xs text-muted-foreground italic cursor-pointer hover:bg-muted/20 p-1 rounded",onClick:l,children:[w?"[Reasoning] ":"",k?`[${b==null?void 0:b.length} Tool Call(s)] `:"",S&&typeof t=="string"?`"${t.substring(0,80)}${t.length>80?"...":""}"`:k||w?"":"[No text response]"]}):f.jsxs(f.Fragment,{children:[i&&a&&f.jsxs("div",{className:"mb-2 rounded border border-destructive bg-destructive/10 p-2 text-xs text-destructive-foreground",children:[f.jsx("p",{className:"font-semibold",children:"Error:"}),f.jsx("p",{children:a})]}),w&&f.jsxs("div",{className:"my-2 p-2 border border-blue-500/30 bg-blue-500/10 rounded-md text-xs",children:[f.jsxs("div",{className:"flex items-center justify-between mb-1 cursor-pointer group/reasoning",onClick:v,children:[f.jsxs("span",{className:"font-semibold text-blue-700 dark:text-blue-300 flex items-center gap-1",children:[f.jsx(Uy,{className:"h-3.5 w-3.5"})," Reasoning"]}),f.jsxs("div",{className:"flex items-center opacity-0 group-hover/reasoning:opacity-100 focus-within:opacity-100 transition-opacity",children:[f.jsx(Un,{tooltipText:"Copy Reasoning",onClick:C=>{C.stopPropagation(),x()},"aria-label":"Copy reasoning",icon:d?f.jsx(ao,{className:"text-green-500"}):f.jsx(pE,{}),className:"h-5 w-5 text-muted-foreground"}),f.jsx(Un,{tooltipText:c?"Show Reasoning":"Hide Reasoning",onClick:C=>{C.stopPropagation(),v()},"aria-label":c?"Show reasoning":"Hide reasoning",icon:c?f.jsx(Jl,{}):f.jsx(Bh,{}),iconClassName:"h-3 w-3",className:"h-5 w-5 text-muted-foreground"})]})]}),!c&&f.jsx("pre",{className:"whitespace-pre-wrap text-xs font-mono p-2 bg-background/30 rounded mt-1 overflow-wrap-anywhere",children:s})]}),b.map(({call:C,result:T},R)=>{const N={interactionId:e,toolCall:C,toolResult:T,canvasContextType:"tool-call-step"};return f.jsx(Ve.Fragment,{children:y("tool-call-content",N)},`tool-step-${C.toolCallId||R}`)}),S&&typeof t=="string"&&f.jsx(sOe,{markdownContent:t,interactionId:e}),!S&&!k&&!w&&!i&&f.jsx("div",{className:"text-xs text-muted-foreground italic p-1",children:"[No text response]"})]})},Kj=Ve.memo(({interaction:e,className:t,renderSlot:n,showPrompt:r=!0})=>{var P,B,D,W,O,Z,U,H,L,te,V,Q;const[s,i]=E.useState(!1),a=E.useRef(null),o=E.useCallback(()=>{i(!1)},[]),l=E.useCallback(()=>{i(!0)},[]),c=E.useCallback(()=>{s?o():l()},[s,o,l]),{dbProviderConfigs:u,getAllAvailableModelDefsForProvider:d}=Cr(yn(ee=>({dbProviderConfigs:ee.dbProviderConfigs,getAllAvailableModelDefsForProvider:ee.getAllAvailableModelDefsForProvider}))),h=e.endedAt?HZ(new Date(e.endedAt),{addSuffix:!0}):"Processing...",m=E.useMemo(()=>{var Ce;const ee=(Ce=e.metadata)==null?void 0:Ce.modelId;if(!ee)return"Unknown Model";const{providerId:se,modelId:pe}=Tc(ee);if(!se||!pe)return ee;const ue=u.find(qe=>qe.id===se),Oe=(ue==null?void 0:ue.name)??se,Se=d(se).find(qe=>qe.id===pe);return`${(Se==null?void 0:Se.name)??pe} (${Oe})`},[(P=e.metadata)==null?void 0:P.modelId,u,d]),y=e.status==="COMPLETED",b=y||e.status==="ERROR",v=e.status==="ERROR",x=e.response&&(typeof e.response!="string"||e.response.trim().length>0),w=((B=e.metadata)==null?void 0:B.toolCalls)&&e.metadata.toolCalls.length>0,S=((D=e.metadata)==null?void 0:D.toolResults)&&e.metadata.toolResults.length>0,k=!!((W=e.metadata)!=null&&W.reasoning),C=x||w||S||k,T=n==null?void 0:n("header-actions",e,{isFolded:s,toggleFold:c}),R=n==null?void 0:n("actions",e),N=n==null?void 0:n("content",e),I=n==null?void 0:n("menu",e);return f.jsxs("div",{ref:a,className:Xe("group/card relative rounded-lg border bg-card p-3 md:p-4 shadow-sm transition-colors hover:bg-muted/50","overflow-wrap-anywhere",v?"border-destructive/50 bg-destructive/5":"border-border",t),children:[r&&e.prompt&&f.jsx(mT,{turnData:e.prompt,timestamp:e.startedAt,isAssistantComplete:y,interactionId:e.id}),f.jsxs("div",{className:Xe("relative group/assistant",r&&e.prompt?"mt-3 pt-3 border-t border-border/50":""),children:[I,f.jsx(rOe,{displayModelName:m,timeAgo:h,isFolded:s,toggleFold:c,canFold:C,promptTokens:(O=e.metadata)==null?void 0:O.promptTokens,completionTokens:(Z=e.metadata)==null?void 0:Z.completionTokens,timeToFirstToken:(U=e.metadata)==null?void 0:U.timeToFirstToken,generationTime:(H=e.metadata)==null?void 0:H.generationTime,headerActionsSlot:T&&T.length>0?f.jsx(f.Fragment,{children:T}):void 0}),N,f.jsx(iOe,{interactionId:e.id,response:e.response,toolCalls:(L=e.metadata)==null?void 0:L.toolCalls,toolResults:(te=e.metadata)==null?void 0:te.toolResults,reasoning:(V=e.metadata)==null?void 0:V.reasoning,isError:v,errorMessage:(Q=e.metadata)==null?void 0:Q.error,isFolded:s,toggleFold:c})]}),b&&R&&R.length>0&&f.jsx("div",{className:Xe("absolute bottom-1 left-1 md:bottom-2 md:left-2 flex items-center space-x-0.5 md:space-x-1 opacity-0 group-hover/card:opacity-100 transition-opacity duration-200","bg-card/80 backdrop-blur-sm p-0.5 md:p-1 rounded-md shadow-md z-20"),children:R})]})});Kj.displayName="InteractionCard";const aOe=({interactionGroup:e,renderSlot:t,activeStreamingInteractionId:n})=>{const[r,s]=E.useState(0);if(!e||e.length===0)return null;if(e.length===1){const a=e[0];return f.jsxs("div",{className:"tab-content pt-0",children:[" ",a.id===n&&a.status==="STREAMING"?f.jsx(dk,{interactionId:a.id,renderSlot:t,showPrompt:!1},a.id):f.jsx(Kj,{interaction:a,renderSlot:t,showPrompt:!1},a.id)]})}const i=e[r];return f.jsxs("div",{className:"response-tabs-container flex flex-col",children:[f.jsxs("div",{className:"tabs-header flex border-b mb-1",children:[" ",e.map((a,o)=>{const l=()=>{var c,u,d;return o===0?(c=a.metadata)!=null&&c.editedResponse?f.jsx(MB,{className:"h-3.5 w-3.5 mr-1 flex-shrink-0"}):f.jsx(MB,{className:"h-3.5 w-3.5 mr-1 flex-shrink-0"}):(u=a.metadata)!=null&&u.raceTab?f.jsx(CH,{className:"h-3.5 w-3.5 mr-1 flex-shrink-0"}):(d=a.metadata)!=null&&d.originalVersion?f.jsx(WO,{className:"h-3.5 w-3.5 mr-1 flex-shrink-0"}):f.jsx($me,{className:"h-3.5 w-3.5 mr-1 flex-shrink-0"})};return f.jsxs(mt,{variant:"ghost",size:"sm",onClick:()=>s(o),className:`mr-0.5 rounded-b-none flex items-center px-2 py-1 text-xs font-medium hover:bg-muted/50 focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-0 transition-colors duration-150 ease-in-out                 ${r===o?"border-b-2 border-primary text-primary":"border-b-2 border-transparent text-muted-foreground hover:text-foreground"}`,children:[l(),o+1," "]},a.id)})]}),f.jsxs("div",{className:"tab-content pt-1",children:[" ",i&&(i.id===n&&i.status==="STREAMING"?f.jsx(dk,{interactionId:i.id,renderSlot:t,showPrompt:!1},i.id):f.jsx(Kj,{interaction:i,renderSlot:t,showPrompt:!1},i.id))]})]})};var oOe=E.createContext(void 0);function db(e){const t=E.useContext(oOe);return e||t||"ltr"}function Lw(e,[t,n]){return Math.min(n,Math.max(t,e))}function lOe(e,t){return E.useReducer((n,r)=>t[n][r]??n,e)}var $D="ScrollArea",[TJ,vdt]=Ki($D),[cOe,rc]=TJ($D),AJ=E.forwardRef((e,t)=>{const{__scopeScrollArea:n,type:r="hover",dir:s,scrollHideDelay:i=600,...a}=e,[o,l]=E.useState(null),[c,u]=E.useState(null),[d,h]=E.useState(null),[m,y]=E.useState(null),[b,v]=E.useState(null),[x,w]=E.useState(0),[S,k]=E.useState(0),[C,T]=E.useState(!1),[R,N]=E.useState(!1),I=Mn(t,B=>l(B)),P=db(s);return f.jsx(cOe,{scope:n,type:r,dir:P,scrollHideDelay:i,scrollArea:o,viewport:c,onViewportChange:u,content:d,onContentChange:h,scrollbarX:m,onScrollbarXChange:y,scrollbarXEnabled:C,onScrollbarXEnabledChange:T,scrollbarY:b,onScrollbarYChange:v,scrollbarYEnabled:R,onScrollbarYEnabledChange:N,onCornerWidthChange:w,onCornerHeightChange:k,children:f.jsx(lr.div,{dir:P,...a,ref:I,style:{position:"relative","--radix-scroll-area-corner-width":x+"px","--radix-scroll-area-corner-height":S+"px",...e.style}})})});AJ.displayName=$D;var RJ="ScrollAreaViewport",NJ=E.forwardRef((e,t)=>{const{__scopeScrollArea:n,children:r,nonce:s,...i}=e,a=rc(RJ,n),o=E.useRef(null),l=Mn(t,o,a.onViewportChange);return f.jsxs(f.Fragment,{children:[f.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:s}),f.jsx(lr.div,{"data-radix-scroll-area-viewport":"",...i,ref:l,style:{overflowX:a.scrollbarXEnabled?"scroll":"hidden",overflowY:a.scrollbarYEnabled?"scroll":"hidden",...e.style},children:f.jsx("div",{ref:a.onContentChange,style:{minWidth:"100%",display:"table"},children:r})})]})});NJ.displayName=RJ;var Vu="ScrollAreaScrollbar",MJ=E.forwardRef((e,t)=>{const{forceMount:n,...r}=e,s=rc(Vu,e.__scopeScrollArea),{onScrollbarXEnabledChange:i,onScrollbarYEnabledChange:a}=s,o=e.orientation==="horizontal";return E.useEffect(()=>(o?i(!0):a(!0),()=>{o?i(!1):a(!1)}),[o,i,a]),s.type==="hover"?f.jsx(uOe,{...r,ref:t,forceMount:n}):s.type==="scroll"?f.jsx(dOe,{...r,ref:t,forceMount:n}):s.type==="auto"?f.jsx(IJ,{...r,ref:t,forceMount:n}):s.type==="always"?f.jsx(zD,{...r,ref:t}):null});MJ.displayName=Vu;var uOe=E.forwardRef((e,t)=>{const{forceMount:n,...r}=e,s=rc(Vu,e.__scopeScrollArea),[i,a]=E.useState(!1);return E.useEffect(()=>{const o=s.scrollArea;let l=0;if(o){const c=()=>{window.clearTimeout(l),a(!0)},u=()=>{l=window.setTimeout(()=>a(!1),s.scrollHideDelay)};return o.addEventListener("pointerenter",c),o.addEventListener("pointerleave",u),()=>{window.clearTimeout(l),o.removeEventListener("pointerenter",c),o.removeEventListener("pointerleave",u)}}},[s.scrollArea,s.scrollHideDelay]),f.jsx(da,{present:n||i,children:f.jsx(IJ,{"data-state":i?"visible":"hidden",...r,ref:t})})}),dOe=E.forwardRef((e,t)=>{const{forceMount:n,...r}=e,s=rc(Vu,e.__scopeScrollArea),i=e.orientation==="horizontal",a=xT(()=>l("SCROLL_END"),100),[o,l]=lOe("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return E.useEffect(()=>{if(o==="idle"){const c=window.setTimeout(()=>l("HIDE"),s.scrollHideDelay);return()=>window.clearTimeout(c)}},[o,s.scrollHideDelay,l]),E.useEffect(()=>{const c=s.viewport,u=i?"scrollLeft":"scrollTop";if(c){let d=c[u];const h=()=>{const m=c[u];d!==m&&(l("SCROLL"),a()),d=m};return c.addEventListener("scroll",h),()=>c.removeEventListener("scroll",h)}},[s.viewport,i,l,a]),f.jsx(da,{present:n||o!=="hidden",children:f.jsx(zD,{"data-state":o==="hidden"?"hidden":"visible",...r,ref:t,onPointerEnter:Wt(e.onPointerEnter,()=>l("POINTER_ENTER")),onPointerLeave:Wt(e.onPointerLeave,()=>l("POINTER_LEAVE"))})})}),IJ=E.forwardRef((e,t)=>{const n=rc(Vu,e.__scopeScrollArea),{forceMount:r,...s}=e,[i,a]=E.useState(!1),o=e.orientation==="horizontal",l=xT(()=>{if(n.viewport){const c=n.viewport.offsetWidth<n.viewport.scrollWidth,u=n.viewport.offsetHeight<n.viewport.scrollHeight;a(o?c:u)}},10);return Sy(n.viewport,l),Sy(n.content,l),f.jsx(da,{present:r||i,children:f.jsx(zD,{"data-state":i?"visible":"hidden",...s,ref:t})})}),zD=E.forwardRef((e,t)=>{const{orientation:n="vertical",...r}=e,s=rc(Vu,e.__scopeScrollArea),i=E.useRef(null),a=E.useRef(0),[o,l]=E.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),c=FJ(o.viewport,o.content),u={...r,sizes:o,onSizesChange:l,hasThumb:c>0&&c<1,onThumbChange:h=>i.current=h,onThumbPointerUp:()=>a.current=0,onThumbPointerDown:h=>a.current=h};function d(h,m){return yOe(h,a.current,o,m)}return n==="horizontal"?f.jsx(fOe,{...u,ref:t,onThumbPositionChange:()=>{if(s.viewport&&i.current){const h=s.viewport.scrollLeft,m=b7(h,o,s.dir);i.current.style.transform=`translate3d(${m}px, 0, 0)`}},onWheelScroll:h=>{s.viewport&&(s.viewport.scrollLeft=h)},onDragScroll:h=>{s.viewport&&(s.viewport.scrollLeft=d(h,s.dir))}}):n==="vertical"?f.jsx(hOe,{...u,ref:t,onThumbPositionChange:()=>{if(s.viewport&&i.current){const h=s.viewport.scrollTop,m=b7(h,o);i.current.style.transform=`translate3d(0, ${m}px, 0)`}},onWheelScroll:h=>{s.viewport&&(s.viewport.scrollTop=h)},onDragScroll:h=>{s.viewport&&(s.viewport.scrollTop=d(h))}}):null}),fOe=E.forwardRef((e,t)=>{const{sizes:n,onSizesChange:r,...s}=e,i=rc(Vu,e.__scopeScrollArea),[a,o]=E.useState(),l=E.useRef(null),c=Mn(t,l,i.onScrollbarXChange);return E.useEffect(()=>{l.current&&o(getComputedStyle(l.current))},[l]),f.jsx(OJ,{"data-orientation":"horizontal",...s,ref:c,sizes:n,style:{bottom:0,left:i.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:i.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":vT(n)+"px",...e.style},onThumbPointerDown:u=>e.onThumbPointerDown(u.x),onDragScroll:u=>e.onDragScroll(u.x),onWheelScroll:(u,d)=>{if(i.viewport){const h=i.viewport.scrollLeft+u.deltaX;e.onWheelScroll(h),BJ(h,d)&&u.preventDefault()}},onResize:()=>{l.current&&i.viewport&&a&&r({content:i.viewport.scrollWidth,viewport:i.viewport.offsetWidth,scrollbar:{size:l.current.clientWidth,paddingStart:hk(a.paddingLeft),paddingEnd:hk(a.paddingRight)}})}})}),hOe=E.forwardRef((e,t)=>{const{sizes:n,onSizesChange:r,...s}=e,i=rc(Vu,e.__scopeScrollArea),[a,o]=E.useState(),l=E.useRef(null),c=Mn(t,l,i.onScrollbarYChange);return E.useEffect(()=>{l.current&&o(getComputedStyle(l.current))},[l]),f.jsx(OJ,{"data-orientation":"vertical",...s,ref:c,sizes:n,style:{top:0,right:i.dir==="ltr"?0:void 0,left:i.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":vT(n)+"px",...e.style},onThumbPointerDown:u=>e.onThumbPointerDown(u.y),onDragScroll:u=>e.onDragScroll(u.y),onWheelScroll:(u,d)=>{if(i.viewport){const h=i.viewport.scrollTop+u.deltaY;e.onWheelScroll(h),BJ(h,d)&&u.preventDefault()}},onResize:()=>{l.current&&i.viewport&&a&&r({content:i.viewport.scrollHeight,viewport:i.viewport.offsetHeight,scrollbar:{size:l.current.clientHeight,paddingStart:hk(a.paddingTop),paddingEnd:hk(a.paddingBottom)}})}})}),[pOe,jJ]=TJ(Vu),OJ=E.forwardRef((e,t)=>{const{__scopeScrollArea:n,sizes:r,hasThumb:s,onThumbChange:i,onThumbPointerUp:a,onThumbPointerDown:o,onThumbPositionChange:l,onDragScroll:c,onWheelScroll:u,onResize:d,...h}=e,m=rc(Vu,n),[y,b]=E.useState(null),v=Mn(t,I=>b(I)),x=E.useRef(null),w=E.useRef(""),S=m.viewport,k=r.content-r.viewport,C=Es(u),T=Es(l),R=xT(d,10);function N(I){if(x.current){const P=I.clientX-x.current.left,B=I.clientY-x.current.top;c({x:P,y:B})}}return E.useEffect(()=>{const I=P=>{const B=P.target;(y==null?void 0:y.contains(B))&&C(P,k)};return document.addEventListener("wheel",I,{passive:!1}),()=>document.removeEventListener("wheel",I,{passive:!1})},[S,y,k,C]),E.useEffect(T,[r,T]),Sy(y,R),Sy(m.content,R),f.jsx(pOe,{scope:n,scrollbar:y,hasThumb:s,onThumbChange:Es(i),onThumbPointerUp:Es(a),onThumbPositionChange:T,onThumbPointerDown:Es(o),children:f.jsx(lr.div,{...h,ref:v,style:{position:"absolute",...h.style},onPointerDown:Wt(e.onPointerDown,I=>{I.button===0&&(I.target.setPointerCapture(I.pointerId),x.current=y.getBoundingClientRect(),w.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",m.viewport&&(m.viewport.style.scrollBehavior="auto"),N(I))}),onPointerMove:Wt(e.onPointerMove,N),onPointerUp:Wt(e.onPointerUp,I=>{const P=I.target;P.hasPointerCapture(I.pointerId)&&P.releasePointerCapture(I.pointerId),document.body.style.webkitUserSelect=w.current,m.viewport&&(m.viewport.style.scrollBehavior=""),x.current=null})})})}),fk="ScrollAreaThumb",PJ=E.forwardRef((e,t)=>{const{forceMount:n,...r}=e,s=jJ(fk,e.__scopeScrollArea);return f.jsx(da,{present:n||s.hasThumb,children:f.jsx(mOe,{ref:t,...r})})}),mOe=E.forwardRef((e,t)=>{const{__scopeScrollArea:n,style:r,...s}=e,i=rc(fk,n),a=jJ(fk,n),{onThumbPositionChange:o}=a,l=Mn(t,d=>a.onThumbChange(d)),c=E.useRef(void 0),u=xT(()=>{c.current&&(c.current(),c.current=void 0)},100);return E.useEffect(()=>{const d=i.viewport;if(d){const h=()=>{if(u(),!c.current){const m=bOe(d,o);c.current=m,o()}};return o(),d.addEventListener("scroll",h),()=>d.removeEventListener("scroll",h)}},[i.viewport,u,o]),f.jsx(lr.div,{"data-state":a.hasThumb?"visible":"hidden",...s,ref:l,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...r},onPointerDownCapture:Wt(e.onPointerDownCapture,d=>{const m=d.target.getBoundingClientRect(),y=d.clientX-m.left,b=d.clientY-m.top;a.onThumbPointerDown({x:y,y:b})}),onPointerUp:Wt(e.onPointerUp,a.onThumbPointerUp)})});PJ.displayName=fk;var UD="ScrollAreaCorner",DJ=E.forwardRef((e,t)=>{const n=rc(UD,e.__scopeScrollArea),r=!!(n.scrollbarX&&n.scrollbarY);return n.type!=="scroll"&&r?f.jsx(gOe,{...e,ref:t}):null});DJ.displayName=UD;var gOe=E.forwardRef((e,t)=>{const{__scopeScrollArea:n,...r}=e,s=rc(UD,n),[i,a]=E.useState(0),[o,l]=E.useState(0),c=!!(i&&o);return Sy(s.scrollbarX,()=>{var d;const u=((d=s.scrollbarX)==null?void 0:d.offsetHeight)||0;s.onCornerHeightChange(u),l(u)}),Sy(s.scrollbarY,()=>{var d;const u=((d=s.scrollbarY)==null?void 0:d.offsetWidth)||0;s.onCornerWidthChange(u),a(u)}),c?f.jsx(lr.div,{...r,ref:t,style:{width:i,height:o,position:"absolute",right:s.dir==="ltr"?0:void 0,left:s.dir==="rtl"?0:void 0,bottom:0,...e.style}}):null});function hk(e){return e?parseInt(e,10):0}function FJ(e,t){const n=e/t;return isNaN(n)?0:n}function vT(e){const t=FJ(e.viewport,e.content),n=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,r=(e.scrollbar.size-n)*t;return Math.max(r,18)}function yOe(e,t,n,r="ltr"){const s=vT(n),i=s/2,a=t||i,o=s-a,l=n.scrollbar.paddingStart+a,c=n.scrollbar.size-n.scrollbar.paddingEnd-o,u=n.content-n.viewport,d=r==="ltr"?[0,u]:[u*-1,0];return LJ([l,c],d)(e)}function b7(e,t,n="ltr"){const r=vT(t),s=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,i=t.scrollbar.size-s,a=t.content-t.viewport,o=i-r,l=n==="ltr"?[0,a]:[a*-1,0],c=Lw(e,l);return LJ([0,a],[0,o])(c)}function LJ(e,t){return n=>{if(e[0]===e[1]||t[0]===t[1])return t[0];const r=(t[1]-t[0])/(e[1]-e[0]);return t[0]+r*(n-e[0])}}function BJ(e,t){return e>0&&e<t}var bOe=(e,t=()=>{})=>{let n={left:e.scrollLeft,top:e.scrollTop},r=0;return function s(){const i={left:e.scrollLeft,top:e.scrollTop},a=n.left!==i.left,o=n.top!==i.top;(a||o)&&t(),n=i,r=window.requestAnimationFrame(s)}(),()=>window.cancelAnimationFrame(r)};function xT(e,t){const n=Es(e),r=E.useRef(0);return E.useEffect(()=>()=>window.clearTimeout(r.current),[]),E.useCallback(()=>{window.clearTimeout(r.current),r.current=window.setTimeout(n,t)},[n,t])}function Sy(e,t){const n=Es(t);si(()=>{let r=0;if(e){const s=new ResizeObserver(()=>{cancelAnimationFrame(r),r=window.requestAnimationFrame(n)});return s.observe(e),()=>{window.cancelAnimationFrame(r),s.unobserve(e)}}},[e,n])}var vOe=AJ,xOe=NJ,wOe=DJ;function Yl({className:e,children:t,...n}){return f.jsxs(vOe,{"data-slot":"scroll-area",className:Xe("relative",e),...n,children:[f.jsx(xOe,{"data-slot":"scroll-area-viewport",className:"focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1",children:t}),f.jsx(_Oe,{}),f.jsx(wOe,{})]})}function _Oe({className:e,orientation:t="vertical",...n}){return f.jsx(MJ,{"data-slot":"scroll-area-scrollbar",orientation:t,className:Xe("flex touch-none p-px transition-colors select-none",t==="vertical"&&"h-full w-2.5 border-l border-l-transparent",t==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent",e),...n,children:f.jsx(PJ,{"data-slot":"scroll-area-thumb",className:"bg-border relative flex-1 rounded-full"})})}function Wr({className:e,...t}){return f.jsx("div",{"data-slot":"skeleton",className:Xe("bg-accent animate-pulse rounded-md",e),...t})}const SOe=e=>{const{size:t=24,color:n="currentColor",...r}=e;return f.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:t,height:t,viewBox:"0 0 512 512",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",...r,children:[f.jsx("g",{transform:"translate(0.000000,512.000000) scale(0.100000,-0.100000)",fill:n,stroke:"none",children:f.jsx("path",{d:`M2310 5053 c-1035 -101 -1883 -794 -2159 -1764 -55 -194 -79 -338
-91 -552 -18 -323 20 -620 117 -907 92 -272 238 -543 404 -747 33 -39 59 -75
59 -78 0 -4 -49 -129 -109 -279 -252 -624 -251 -621 -196 -676 57 -56 73 -53
351 58 137 55 349 143 472 195 l223 95 77 -38 c221 -109 437 -179 680 -219
132 -23 411 -44 475 -37 23 3 85 8 137 11 404 26 806 168 1180 417 282 188
571 489 759 792 400 642 467 1498 174 2216 -179 439 -495 826 -888 1088 -361
239 -743 378 -1165 422 -88 9 -419 11 -500 3z m404 -463 c-1 -30 -17 -128 -36
-217 l-34 -163 137 0 c128 0 139 -1 149 -20 11 -21 4 -44 -22 -72 -7 -7 -68
-75 -135 -150 l-123 -136 0 -175 0 -175 238 -4 c265 -5 329 -16 469 -82 220
-105 414 -311 486 -519 l24 -68 86 -4 c129 -7 195 -43 236 -130 20 -42 21 -61
21 -300 0 -240 -1 -258 -21 -297 -46 -90 -115 -127 -235 -128 l-82 0 -11 -47
c-17 -66 -71 -179 -119 -250 -108 -159 -276 -293 -452 -361 -174 -66 -251 -72
-830 -63 l-475 8 -89 27 c-303 91 -554 328 -650 614 l-23 67 -89 5 c-98 6
-131 20 -180 72 -63 66 -64 72 -64 354 0 240 1 261 21 301 40 84 105 119 232
129 l84 7 32 80 c84 215 291 424 513 519 126 53 225 68 466 68 l212 0 0 268 0
267 -126 -3 c-108 -3 -129 -1 -145 14 -10 9 -19 25 -19 35 0 9 111 146 246
304 234 273 247 286 277 283 32 -3 32 -3 31 -58z`})}),f.jsxs("g",{transform:"translate(165, 220) scale(2.5)",children:[f.jsx("path",{d:"M4 12h16",stroke:n,strokeWidth:"4"}),f.jsx("path",{d:"M12 5v16",stroke:n,strokeWidth:"4"})]}),f.jsxs("g",{transform:"translate(290, 220) scale(2.5)",children:[f.jsx("path",{d:"M4 12h16",stroke:n,strokeWidth:"4"}),f.jsx("path",{d:"M12 5v16",stroke:n,strokeWidth:"4"})]}),f.jsx("g",{transform:"translate(0.000000,512.000000) scale(0.100000,-0.100000)",fill:n,stroke:"none",children:f.jsx("path",{d:`M2147 1999 c-26 -15 -48 -65 -41 -94 15 -61 181 -167 304 -196 30 -7
100 -12 155 -12 81 1 115 6 178 27 135 45 247 133 249 194 2 60 -48 103 -104
88 -13 -3 -50 -25 -83 -50 -85 -64 -172 -90 -280 -84 -92 6 -165 35 -259 103
-49 35 -86 43 -119 24z`})})]})};function dl({className:e,...t}){return f.jsx("div",{"data-slot":"card",className:Xe("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",e),...t})}function fl({className:e,...t}){return f.jsx("div",{"data-slot":"card-header",className:Xe("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",e),...t})}function hl({className:e,...t}){return f.jsx("div",{"data-slot":"card-title",className:Xe("leading-none font-semibold",e),...t})}function zd({className:e,...t}){return f.jsx("div",{"data-slot":"card-description",className:Xe("text-muted-foreground text-sm",e),...t})}function pl({className:e,...t}){return f.jsx("div",{"data-slot":"card-content",className:Xe("px-6",e),...t})}function COe({className:e,...t}){return f.jsx("div",{"data-slot":"card-footer",className:Xe("flex items-center px-6 [.border-t]:pt-6",e),...t})}const Or={sidebarVisibilityChanged:"ui.sidebar.visibility.changed",chatControlPanelVisibilityChanged:"ui.chat.control.panel.visibility.changed",promptControlPanelVisibilityChanged:"ui.prompt.control.panel.visibility.changed",globalLoadingChanged:"ui.global.loading.changed",globalErrorChanged:"ui.global.error.changed",focusInputFlagChanged:"ui.focus.input.flag.changed",modalStateChanged:"ui.modal.state.changed",toggleSidebarRequest:"ui.toggle.sidebar.request",toggleChatControlPanelRequest:"ui.toggle.chat.control.panel.request",togglePromptControlPanelRequest:"ui.toggle.prompt.control.panel.request",setGlobalLoadingRequest:"ui.set.global.loading.request",setGlobalErrorRequest:"ui.set.global.error.request",setFocusInputFlagRequest:"ui.set.focus.input.flag.request",openModalRequest:"ui.modal.open.request",closeModalRequest:"ui.modal.close.request",contextChanged:"ui.legacy.contextChanged"},kOe=({title:e,description:t,icon:n,onClick:r})=>f.jsxs(dl,{className:"hover:border-primary/50 hover:bg-muted/30 transition-all cursor-pointer group",onClick:r,children:[f.jsxs(fl,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[f.jsxs(hl,{className:"text-sm font-medium flex items-center gap-2",children:[n," ",e]}),f.jsx(mpe,{className:"h-4 w-4 text-muted-foreground group-hover:translate-x-1 transition-transform"})]}),f.jsx(pl,{children:f.jsx("p",{className:"text-xs text-muted-foreground",children:t})})]}),$J=()=>{const e=(r,s)=>{Pe.emit(Or.openModalRequest,{modalId:"settingsModal",initialTab:r,initialSubTab:s})},t=()=>{Pe.emit(Or.openModalRequest,{modalId:"core-vfs-modal-panel"})},n=[{title:"Configure Theme",description:"Customize colors, fonts, and code block appearance.",icon:f.jsx(iC,{className:"h-4 w-4 text-purple-500"}),onClick:()=>e("theme")},{title:"Manage Rules & Tags",description:"Define reusable prompt snippets and organize them.",icon:f.jsx(Q3,{className:"h-4 w-4 text-blue-500"}),onClick:()=>e("rules-tags")},{title:"Add Files",description:"Upload or manage files in the virtual filesystem.",icon:f.jsx(qO,{className:"h-4 w-4 text-cyan-500"}),onClick:t},{title:"Add Provider",description:"Connect to AI services like OpenAI, Ollama, etc.",icon:f.jsx(Q0,{className:"h-4 w-4 text-green-500"}),onClick:()=>e("providers","providers-config")},{title:"Add API Key",description:"Store API keys securely in your browser.",icon:f.jsx(Hx,{className:"h-4 w-4 text-amber-500"}),onClick:()=>e("providers","api-keys")},{title:"Setup Git Sync",description:"Configure repositories to sync conversations with Git.",icon:f.jsx(Ic,{className:"h-4 w-4 text-orange-500"}),onClick:()=>e("git")}];return f.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 max-w-4xl w-full pt-4",children:n.map(r=>f.jsx(kOe,{title:r.title,description:r.description,icon:r.icon,onClick:r.onClick},r.title))})},v7=()=>f.jsxs("div",{className:"flex h-full flex-col items-center justify-center text-center p-4",children:[f.jsx(SOe,{className:"h-16 w-16 text-muted-foreground mb-4"}),f.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Start Chatting"}),f.jsx("p",{className:"text-muted-foreground max-w-md mb-8",children:"Select an existing conversation or project from the sidebar, or click the '+' button to start a new chat. You can also explore these setup options:"}),f.jsx($J,{})]}),qD=E.createContext({});function VD(e){const t=E.useRef(null);return t.current===null&&(t.current=e()),t.current}const WD=typeof window<"u",zJ=WD?E.useLayoutEffect:E.useEffect,wT=E.createContext(null),HD=E.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});class EOe extends E.Component{getSnapshotBeforeUpdate(t){const n=this.props.childRef.current;if(n&&t.isPresent&&!this.props.isPresent){const r=n.offsetParent,s=r instanceof HTMLElement&&r.offsetWidth||0,i=this.props.sizeRef.current;i.height=n.offsetHeight||0,i.width=n.offsetWidth||0,i.top=n.offsetTop,i.left=n.offsetLeft,i.right=s-i.width-i.left}return null}componentDidUpdate(){}render(){return this.props.children}}function TOe({children:e,isPresent:t,anchorX:n}){const r=E.useId(),s=E.useRef(null),i=E.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:a}=E.useContext(HD);return E.useInsertionEffect(()=>{const{width:o,height:l,top:c,left:u,right:d}=i.current;if(t||!s.current||!o||!l)return;const h=n==="left"?`left: ${u}`:`right: ${d}`;s.current.dataset.motionPopId=r;const m=document.createElement("style");return a&&(m.nonce=a),document.head.appendChild(m),m.sheet&&m.sheet.insertRule(`
          [data-motion-pop-id="${r}"] {
            position: absolute !important;
            width: ${o}px !important;
            height: ${l}px !important;
            ${h}px !important;
            top: ${c}px !important;
          }
        `),()=>{document.head.contains(m)&&document.head.removeChild(m)}},[t]),f.jsx(EOe,{isPresent:t,childRef:s,sizeRef:i,children:E.cloneElement(e,{ref:s})})}const AOe=({children:e,initial:t,isPresent:n,onExitComplete:r,custom:s,presenceAffectsLayout:i,mode:a,anchorX:o})=>{const l=VD(ROe),c=E.useId();let u=!0,d=E.useMemo(()=>(u=!1,{id:c,initial:t,isPresent:n,custom:s,onExitComplete:h=>{l.set(h,!0);for(const m of l.values())if(!m)return;r&&r()},register:h=>(l.set(h,!1),()=>l.delete(h))}),[n,l,r]);return i&&u&&(d={...d}),E.useMemo(()=>{l.forEach((h,m)=>l.set(m,!1))},[n]),E.useEffect(()=>{!n&&!l.size&&r&&r()},[n]),a==="popLayout"&&(e=f.jsx(TOe,{isPresent:n,anchorX:o,children:e})),f.jsx(wT.Provider,{value:d,children:e})};function ROe(){return new Map}function UJ(e=!0){const t=E.useContext(wT);if(t===null)return[!0,null];const{isPresent:n,onExitComplete:r,register:s}=t,i=E.useId();E.useEffect(()=>{if(e)return s(i)},[e]);const a=E.useCallback(()=>e&&r&&r(i),[i,r,e]);return!n&&r?[!1,a]:[!0]}const YS=e=>e.key||"";function x7(e){const t=[];return E.Children.forEach(e,n=>{E.isValidElement(n)&&t.push(n)}),t}const NOe=({children:e,custom:t,initial:n=!0,onExitComplete:r,presenceAffectsLayout:s=!0,mode:i="sync",propagate:a=!1,anchorX:o="left"})=>{const[l,c]=UJ(a),u=E.useMemo(()=>x7(e),[e]),d=a&&!l?[]:u.map(YS),h=E.useRef(!0),m=E.useRef(u),y=VD(()=>new Map),[b,v]=E.useState(u),[x,w]=E.useState(u);zJ(()=>{h.current=!1,m.current=u;for(let C=0;C<x.length;C++){const T=YS(x[C]);d.includes(T)?y.delete(T):y.get(T)!==!0&&y.set(T,!1)}},[x,d.length,d.join("-")]);const S=[];if(u!==b){let C=[...u];for(let T=0;T<x.length;T++){const R=x[T],N=YS(R);d.includes(N)||(C.splice(T,0,R),S.push(R))}return i==="wait"&&S.length&&(C=S),w(x7(C)),v(u),null}const{forceRender:k}=E.useContext(qD);return f.jsx(f.Fragment,{children:x.map(C=>{const T=YS(C),R=a&&!l?!1:u===x||d.includes(T),N=()=>{if(y.has(T))y.set(T,!0);else return;let I=!0;y.forEach(P=>{P||(I=!1)}),I&&(k==null||k(),w(m.current),a&&(c==null||c()),r&&r())};return f.jsx(AOe,{isPresent:R,initial:!h.current||n?void 0:!1,custom:t,presenceAffectsLayout:s,mode:i,onExitComplete:R?void 0:N,anchorX:o,children:C},T)})})},ZS=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"],w7={value:null};function MOe(e,t){let n=new Set,r=new Set,s=!1,i=!1;const a=new WeakSet;let o={delta:0,timestamp:0,isProcessing:!1},l=0;function c(d){a.has(d)&&(u.schedule(d),e()),l++,d(o)}const u={schedule:(d,h=!1,m=!1)=>{const b=m&&s?n:r;return h&&a.add(d),b.has(d)||b.add(d),d},cancel:d=>{r.delete(d),a.delete(d)},process:d=>{if(o=d,s){i=!0;return}s=!0,[n,r]=[r,n],n.forEach(c),t&&w7.value&&w7.value.frameloop[t].push(l),l=0,n.clear(),s=!1,i&&(i=!1,u.process(d))}};return u}const Jd={},IOe=40;function qJ(e,t){let n=!1,r=!0;const s={delta:0,timestamp:0,isProcessing:!1},i=()=>n=!0,a=ZS.reduce((S,k)=>(S[k]=MOe(i,t?k:void 0),S),{}),{setup:o,read:l,resolveKeyframes:c,preUpdate:u,update:d,preRender:h,render:m,postRender:y}=a,b=()=>{const S=Jd.useManualTiming?s.timestamp:performance.now();n=!1,Jd.useManualTiming||(s.delta=r?1e3/60:Math.max(Math.min(S-s.timestamp,IOe),1)),s.timestamp=S,s.isProcessing=!0,o.process(s),l.process(s),c.process(s),u.process(s),d.process(s),h.process(s),m.process(s),y.process(s),s.isProcessing=!1,n&&t&&(r=!1,e(b))},v=()=>{n=!0,r=!0,s.isProcessing||e(b)};return{schedule:ZS.reduce((S,k)=>{const C=a[k];return S[k]=(T,R=!1,N=!1)=>(n||v(),C.schedule(T,R,N)),S},{}),cancel:S=>{for(let k=0;k<ZS.length;k++)a[ZS[k]].cancel(S)},state:s,steps:a}}const Hl=e=>e,{schedule:ri,cancel:Mh,state:wa,steps:NI}=qJ(typeof requestAnimationFrame<"u"?requestAnimationFrame:Hl,!0),VJ=E.createContext({strict:!1}),_7={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Cy={};for(const e in _7)Cy[e]={isEnabled:t=>_7[e].some(n=>!!t[n])};function jOe(e){for(const t in e)Cy[t]={...Cy[t],...e[t]}}const OOe=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function pk(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||OOe.has(e)}let WJ=e=>!pk(e);function POe(e){e&&(WJ=t=>t.startsWith("on")?!pk(t):e(t))}try{POe(require("@emotion/is-prop-valid").default)}catch{}function DOe(e,t,n){const r={};for(const s in e)s==="values"&&typeof e.values=="object"||(WJ(s)||n===!0&&pk(s)||!t&&!pk(s)||e.draggable&&s.startsWith("onDrag"))&&(r[s]=e[s]);return r}function FOe(e){if(typeof Proxy>"u")return e;const t=new Map,n=(...r)=>e(...r);return new Proxy(n,{get:(r,s)=>s==="create"?e:(t.has(s)||t.set(s,e(s)),t.get(s))})}const _T=E.createContext({});function ST(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}function Bw(e){return typeof e=="string"||Array.isArray(e)}const GD=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],KD=["initial",...GD];function CT(e){return ST(e.animate)||KD.some(t=>Bw(e[t]))}function HJ(e){return!!(CT(e)||e.variants)}function LOe(e,t){if(CT(e)){const{initial:n,animate:r}=e;return{initial:n===!1||Bw(n)?n:void 0,animate:Bw(r)?r:void 0}}return e.inherit!==!1?t:{}}function BOe(e){const{initial:t,animate:n}=LOe(e,E.useContext(_T));return E.useMemo(()=>({initial:t,animate:n}),[S7(t),S7(n)])}function S7(e){return Array.isArray(e)?e.join(" "):e}const $Oe=Symbol.for("motionComponentSymbol");function S0(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function zOe(e,t,n){return E.useCallback(r=>{r&&e.onMount&&e.onMount(r),t&&(r?t.mount(r):t.unmount()),n&&(typeof n=="function"?n(r):S0(n)&&(n.current=r))},[t])}const YD=e=>e.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),UOe="framerAppearId",GJ="data-"+YD(UOe),KJ=E.createContext({}),{schedule:ZD}=qJ(queueMicrotask,!1);function qOe(e,t,n,r,s){var b,v;const{visualElement:i}=E.useContext(_T),a=E.useContext(VJ),o=E.useContext(wT),l=E.useContext(HD).reducedMotion,c=E.useRef(null);r=r||a.renderer,!c.current&&r&&(c.current=r(e,{visualState:t,parent:i,props:n,presenceContext:o,blockInitialAnimation:o?o.initial===!1:!1,reducedMotionConfig:l}));const u=c.current,d=E.useContext(KJ);u&&!u.projection&&s&&(u.type==="html"||u.type==="svg")&&VOe(c.current,n,s,d);const h=E.useRef(!1);E.useInsertionEffect(()=>{u&&h.current&&u.update(n,o)});const m=n[GJ],y=E.useRef(!!m&&!((b=window.MotionHandoffIsComplete)!=null&&b.call(window,m))&&((v=window.MotionHasOptimisedAnimation)==null?void 0:v.call(window,m)));return zJ(()=>{u&&(h.current=!0,window.MotionIsMounted=!0,u.updateFeatures(),ZD.render(u.render),y.current&&u.animationState&&u.animationState.animateChanges())}),E.useEffect(()=>{u&&(!y.current&&u.animationState&&u.animationState.animateChanges(),y.current&&(queueMicrotask(()=>{var x;(x=window.MotionHandoffMarkAsComplete)==null||x.call(window,m)}),y.current=!1))}),u}function VOe(e,t,n,r){const{layoutId:s,layout:i,drag:a,dragConstraints:o,layoutScroll:l,layoutRoot:c,layoutCrossfade:u}=t;e.projection=new n(e.latestValues,t["data-framer-portal-id"]?void 0:YJ(e.parent)),e.projection.setOptions({layoutId:s,layout:i,alwaysMeasureLayout:!!a||o&&S0(o),visualElement:e,animationType:typeof i=="string"?i:"both",initialPromotionConfig:r,crossfade:u,layoutScroll:l,layoutRoot:c})}function YJ(e){if(e)return e.options.allowProjection!==!1?e.projection:YJ(e.parent)}let XD=()=>{};function WOe({preloadedFeatures:e,createVisualElement:t,useRender:n,useVisualState:r,Component:s}){e&&jOe(e);function i(o,l){let c;const u={...E.useContext(HD),...o,layoutId:HOe(o)},{isStatic:d}=u,h=BOe(o),m=r(o,d);if(!d&&WD){GOe();const y=KOe(u);c=y.MeasureLayout,h.visualElement=qOe(s,m,u,t,y.ProjectionNode)}return f.jsxs(_T.Provider,{value:h,children:[c&&h.visualElement?f.jsx(c,{visualElement:h.visualElement,...u}):null,n(s,o,zOe(m,h.visualElement,l),m,d,h.visualElement)]})}i.displayName=`motion.${typeof s=="string"?s:`create(${s.displayName??s.name??""})`}`;const a=E.forwardRef(i);return a[$Oe]=s,a}function HOe({layoutId:e}){const t=E.useContext(qD).id;return t&&e!==void 0?t+"-"+e:e}function GOe(e,t){E.useContext(VJ).strict}function KOe(e){const{drag:t,layout:n}=Cy;if(!t&&!n)return{};const r={...t,...n};return{MeasureLayout:t!=null&&t.isEnabled(e)||n!=null&&n.isEnabled(e)?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}const ZJ=e=>t=>typeof t=="string"&&t.startsWith(e),JD=ZJ("--"),YOe=ZJ("var(--"),QD=e=>YOe(e)?ZOe.test(e.split("/*")[0].trim()):!1,ZOe=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,$w={};function XOe(e){for(const t in e)$w[t]=e[t],JD(t)&&($w[t].isCSSVariable=!0)}const fb=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],hb=new Set(fb);function XJ(e,{layout:t,layoutId:n}){return hb.has(e)||e.startsWith("origin")||(t||n!==void 0)&&(!!$w[e]||e==="opacity")}const La=e=>!!(e&&e.getVelocity),JJ=(e,t)=>t&&typeof e=="number"?t.transform(e):e,Qd=(e,t,n)=>n>t?t:n<e?e:n,pb={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},zw={...pb,transform:e=>Qd(0,1,e)},XS={...pb,default:1},C7={...pb,transform:Math.round},K1=e=>({test:t=>typeof t=="string"&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),eh=K1("deg"),Tu=K1("%"),or=K1("px"),JOe=K1("vh"),QOe=K1("vw"),k7={...Tu,parse:e=>Tu.parse(e)/100,transform:e=>Tu.transform(e*100)},ePe={rotate:eh,rotateX:eh,rotateY:eh,rotateZ:eh,scale:XS,scaleX:XS,scaleY:XS,scaleZ:XS,skew:eh,skewX:eh,skewY:eh,distance:or,translateX:or,translateY:or,translateZ:or,x:or,y:or,z:or,perspective:or,transformPerspective:or,opacity:zw,originX:k7,originY:k7,originZ:or},e6={borderWidth:or,borderTopWidth:or,borderRightWidth:or,borderBottomWidth:or,borderLeftWidth:or,borderRadius:or,radius:or,borderTopLeftRadius:or,borderTopRightRadius:or,borderBottomRightRadius:or,borderBottomLeftRadius:or,width:or,maxWidth:or,height:or,maxHeight:or,top:or,right:or,bottom:or,left:or,padding:or,paddingTop:or,paddingRight:or,paddingBottom:or,paddingLeft:or,margin:or,marginTop:or,marginRight:or,marginBottom:or,marginLeft:or,backgroundPositionX:or,backgroundPositionY:or,...ePe,zIndex:C7,fillOpacity:zw,strokeOpacity:zw,numOctaves:C7},tPe={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},nPe=fb.length;function rPe(e,t,n){let r="",s=!0;for(let i=0;i<nPe;i++){const a=fb[i],o=e[a];if(o===void 0)continue;let l=!0;if(typeof o=="number"?l=o===(a.startsWith("scale")?1:0):l=parseFloat(o)===0,!l||n){const c=JJ(o,e6[a]);if(!l){s=!1;const u=tPe[a]||a;r+=`${u}(${c}) `}n&&(t[a]=c)}}return r=r.trim(),n?r=n(t,s?"":r):s&&(r="none"),r}function t6(e,t,n){const{style:r,vars:s,transformOrigin:i}=e;let a=!1,o=!1;for(const l in t){const c=t[l];if(hb.has(l)){a=!0;continue}else if(JD(l)){s[l]=c;continue}else{const u=JJ(c,e6[l]);l.startsWith("origin")?(o=!0,i[l]=u):r[l]=u}}if(t.transform||(a||n?r.transform=rPe(t,e.transform,n):r.transform&&(r.transform="none")),o){const{originX:l="50%",originY:c="50%",originZ:u=0}=i;r.transformOrigin=`${l} ${c} ${u}`}}const n6=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function QJ(e,t,n){for(const r in t)!La(t[r])&&!XJ(r,n)&&(e[r]=t[r])}function sPe({transformTemplate:e},t){return E.useMemo(()=>{const n=n6();return t6(n,t,e),Object.assign({},n.vars,n.style)},[t])}function iPe(e,t){const n=e.style||{},r={};return QJ(r,n,e),Object.assign(r,sPe(e,t)),r}function aPe(e,t){const n={},r=iPe(e,t);return e.drag&&e.dragListener!==!1&&(n.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(n.tabIndex=0),n.style=r,n}const oPe=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function r6(e){return typeof e!="string"||e.includes("-")?!1:!!(oPe.indexOf(e)>-1||/[A-Z]/u.test(e))}const lPe={offset:"stroke-dashoffset",array:"stroke-dasharray"},cPe={offset:"strokeDashoffset",array:"strokeDasharray"};function uPe(e,t,n=1,r=0,s=!0){e.pathLength=1;const i=s?lPe:cPe;e[i.offset]=or.transform(-r);const a=or.transform(t),o=or.transform(n);e[i.array]=`${a} ${o}`}function eQ(e,{attrX:t,attrY:n,attrScale:r,pathLength:s,pathSpacing:i=1,pathOffset:a=0,...o},l,c,u){if(t6(e,o,c),l){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:d,style:h}=e;d.transform&&(h.transform=d.transform,delete d.transform),(h.transform||d.transformOrigin)&&(h.transformOrigin=d.transformOrigin??"50% 50%",delete d.transformOrigin),h.transform&&(h.transformBox=(u==null?void 0:u.transformBox)??"fill-box",delete d.transformBox),t!==void 0&&(d.x=t),n!==void 0&&(d.y=n),r!==void 0&&(d.scale=r),s!==void 0&&uPe(d,s,i,a,!1)}const tQ=()=>({...n6(),attrs:{}}),nQ=e=>typeof e=="string"&&e.toLowerCase()==="svg";function dPe(e,t,n,r){const s=E.useMemo(()=>{const i=tQ();return eQ(i,t,nQ(r),e.transformTemplate,e.style),{...i.attrs,style:{...i.style}}},[t]);if(e.style){const i={};QJ(i,e.style,e),s.style={...i,...s.style}}return s}function fPe(e=!1){return(n,r,s,{latestValues:i},a)=>{const l=(r6(n)?dPe:aPe)(r,i,a,n),c=DOe(r,typeof n=="string",e),u=n!==E.Fragment?{...c,...l,ref:s}:{},{children:d}=r,h=E.useMemo(()=>La(d)?d.get():d,[d]);return E.createElement(n,{...u,children:h})}}function E7(e){const t=[{},{}];return e==null||e.values.forEach((n,r)=>{t[0][r]=n.get(),t[1][r]=n.getVelocity()}),t}function s6(e,t,n,r){if(typeof t=="function"){const[s,i]=E7(r);t=t(n!==void 0?n:e.custom,s,i)}if(typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"){const[s,i]=E7(r);t=t(n!==void 0?n:e.custom,s,i)}return t}function P2(e){return La(e)?e.get():e}function hPe({scrapeMotionValuesFromProps:e,createRenderState:t},n,r,s){return{latestValues:pPe(n,r,s,e),renderState:t()}}const rQ=e=>(t,n)=>{const r=E.useContext(_T),s=E.useContext(wT),i=()=>hPe(e,t,r,s);return n?i():VD(i)};function pPe(e,t,n,r){const s={},i=r(e,{});for(const h in i)s[h]=P2(i[h]);let{initial:a,animate:o}=e;const l=CT(e),c=HJ(e);t&&c&&!l&&e.inherit!==!1&&(a===void 0&&(a=t.initial),o===void 0&&(o=t.animate));let u=n?n.initial===!1:!1;u=u||a===!1;const d=u?o:a;if(d&&typeof d!="boolean"&&!ST(d)){const h=Array.isArray(d)?d:[d];for(let m=0;m<h.length;m++){const y=s6(e,h[m]);if(y){const{transitionEnd:b,transition:v,...x}=y;for(const w in x){let S=x[w];if(Array.isArray(S)){const k=u?S.length-1:0;S=S[k]}S!==null&&(s[w]=S)}for(const w in b)s[w]=b[w]}}}return s}function i6(e,t,n){var i;const{style:r}=e,s={};for(const a in r)(La(r[a])||t.style&&La(t.style[a])||XJ(a,e)||((i=n==null?void 0:n.getValue(a))==null?void 0:i.liveStyle)!==void 0)&&(s[a]=r[a]);return s}const mPe={useVisualState:rQ({scrapeMotionValuesFromProps:i6,createRenderState:n6})};function sQ(e,t,n){const r=i6(e,t,n);for(const s in e)if(La(e[s])||La(t[s])){const i=fb.indexOf(s)!==-1?"attr"+s.charAt(0).toUpperCase()+s.substring(1):s;r[i]=e[s]}return r}const gPe={useVisualState:rQ({scrapeMotionValuesFromProps:sQ,createRenderState:tQ})};function yPe(e,t){return function(r,{forwardMotionProps:s}={forwardMotionProps:!1}){const a={...r6(r)?gPe:mPe,preloadedFeatures:e,useRender:fPe(s),createVisualElement:t,Component:r};return WOe(a)}}function Uw(e,t,n){const r=e.getProps();return s6(r,t,n!==void 0?n:r.custom,e)}const Yj=e=>Array.isArray(e);let D2;function bPe(){D2=void 0}const Ao={now:()=>(D2===void 0&&Ao.set(wa.isProcessing||Jd.useManualTiming?wa.timestamp:performance.now()),D2),set:e=>{D2=e,queueMicrotask(bPe)}};function a6(e,t){e.indexOf(t)===-1&&e.push(t)}function o6(e,t){const n=e.indexOf(t);n>-1&&e.splice(n,1)}class l6{constructor(){this.subscriptions=[]}add(t){return a6(this.subscriptions,t),()=>o6(this.subscriptions,t)}notify(t,n,r){const s=this.subscriptions.length;if(s)if(s===1)this.subscriptions[0](t,n,r);else for(let i=0;i<s;i++){const a=this.subscriptions[i];a&&a(t,n,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function iQ(e,t){return t?e*(1e3/t):0}const T7=30,vPe=e=>!isNaN(parseFloat(e));class xPe{constructor(t,n={}){this.version="__VERSION__",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(r,s=!0)=>{var a,o;const i=Ao.now();this.updatedAt!==i&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(r),this.current!==this.prev&&((a=this.events.change)==null||a.notify(this.current)),s&&((o=this.events.renderRequest)==null||o.notify(this.current))},this.hasAnimated=!1,this.setCurrent(t),this.owner=n.owner}setCurrent(t){this.current=t,this.updatedAt=Ao.now(),this.canTrackVelocity===null&&t!==void 0&&(this.canTrackVelocity=vPe(this.current))}setPrevFrameValue(t=this.current){this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,n){this.events[t]||(this.events[t]=new l6);const r=this.events[t].add(n);return t==="change"?()=>{r(),ri.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,n){this.passiveEffect=t,this.stopPassiveEffect=n}set(t,n=!0){!n||!this.passiveEffect?this.updateAndNotify(t,n):this.passiveEffect(t,this.updateAndNotify)}setWithVelocity(t,n,r){this.set(n),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-r}jump(t,n=!0){this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,n&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const t=Ao.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||t-this.updatedAt>T7)return 0;const n=Math.min(this.updatedAt-this.prevUpdatedAt,T7);return iQ(parseFloat(this.current)-parseFloat(this.prevFrameValue),n)}start(t){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=t(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var t;(t=this.events.destroy)==null||t.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function qw(e,t){return new xPe(e,t)}function wPe(e,t,n){e.hasValue(t)?e.getValue(t).set(n):e.addValue(t,qw(n))}function _Pe(e){return Yj(e)?e[e.length-1]||0:e}function SPe(e,t){const n=Uw(e,t);let{transitionEnd:r={},transition:s={},...i}=n||{};i={...i,...r};for(const a in i){const o=_Pe(i[a]);wPe(e,a,o)}}function CPe(e){return!!(La(e)&&e.add)}function Zj(e,t){const n=e.getValue("willChange");if(CPe(n))return n.add(t);if(!n&&Jd.WillChange){const r=new Jd.WillChange("auto");e.addValue("willChange",r),r.add(t)}}function aQ(e){return e.props[GJ]}const kPe=e=>e!==null;function EPe(e,{repeat:t,repeatType:n="loop"},r){const s=e.filter(kPe),i=t&&n!=="loop"&&t%2===1?0:s.length-1;return s[i]}const TPe={type:"spring",stiffness:500,damping:25,restSpeed:10},APe=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),RPe={type:"keyframes",duration:.8},NPe={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},MPe=(e,{keyframes:t})=>t.length>2?RPe:hb.has(e)?e.startsWith("scale")?APe(t[1]):TPe:NPe;function IPe({when:e,delay:t,delayChildren:n,staggerChildren:r,staggerDirection:s,repeat:i,repeatType:a,repeatDelay:o,from:l,elapsed:c,...u}){return!!Object.keys(u).length}function c6(e,t){return(e==null?void 0:e[t])??(e==null?void 0:e.default)??e}const Au=e=>e*1e3,Ru=e=>e/1e3,Ax=e=>Math.round(e*1e5)/1e5,u6=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function jPe(e){return e==null}const OPe=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,d6=(e,t)=>n=>!!(typeof n=="string"&&OPe.test(n)&&n.startsWith(e)||t&&!jPe(n)&&Object.prototype.hasOwnProperty.call(n,t)),oQ=(e,t,n)=>r=>{if(typeof r!="string")return r;const[s,i,a,o]=r.match(u6);return{[e]:parseFloat(s),[t]:parseFloat(i),[n]:parseFloat(a),alpha:o!==void 0?parseFloat(o):1}},PPe=e=>Qd(0,255,e),MI={...pb,transform:e=>Math.round(PPe(e))},im={test:d6("rgb","red"),parse:oQ("red","green","blue"),transform:({red:e,green:t,blue:n,alpha:r=1})=>"rgba("+MI.transform(e)+", "+MI.transform(t)+", "+MI.transform(n)+", "+Ax(zw.transform(r))+")"};function DPe(e){let t="",n="",r="",s="";return e.length>5?(t=e.substring(1,3),n=e.substring(3,5),r=e.substring(5,7),s=e.substring(7,9)):(t=e.substring(1,2),n=e.substring(2,3),r=e.substring(3,4),s=e.substring(4,5),t+=t,n+=n,r+=r,s+=s),{red:parseInt(t,16),green:parseInt(n,16),blue:parseInt(r,16),alpha:s?parseInt(s,16)/255:1}}const Xj={test:d6("#"),parse:DPe,transform:im.transform},C0={test:d6("hsl","hue"),parse:oQ("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:n,alpha:r=1})=>"hsla("+Math.round(e)+", "+Tu.transform(Ax(t))+", "+Tu.transform(Ax(n))+", "+Ax(zw.transform(r))+")"},Oa={test:e=>im.test(e)||Xj.test(e)||C0.test(e),parse:e=>im.test(e)?im.parse(e):C0.test(e)?C0.parse(e):Xj.parse(e),transform:e=>typeof e=="string"?e:e.hasOwnProperty("red")?im.transform(e):C0.transform(e)},FPe=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function LPe(e){var t,n;return isNaN(e)&&typeof e=="string"&&(((t=e.match(u6))==null?void 0:t.length)||0)+(((n=e.match(FPe))==null?void 0:n.length)||0)>0}const lQ="number",cQ="color",BPe="var",$Pe="var(",A7="${}",zPe=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Vw(e){const t=e.toString(),n=[],r={color:[],number:[],var:[]},s=[];let i=0;const o=t.replace(zPe,l=>(Oa.test(l)?(r.color.push(i),s.push(cQ),n.push(Oa.parse(l))):l.startsWith($Pe)?(r.var.push(i),s.push(BPe),n.push(l)):(r.number.push(i),s.push(lQ),n.push(parseFloat(l))),++i,A7)).split(A7);return{values:n,split:o,indexes:r,types:s}}function uQ(e){return Vw(e).values}function dQ(e){const{split:t,types:n}=Vw(e),r=t.length;return s=>{let i="";for(let a=0;a<r;a++)if(i+=t[a],s[a]!==void 0){const o=n[a];o===lQ?i+=Ax(s[a]):o===cQ?i+=Oa.transform(s[a]):i+=s[a]}return i}}const UPe=e=>typeof e=="number"?0:e;function qPe(e){const t=uQ(e);return dQ(e)(t.map(UPe))}const Ih={test:LPe,parse:uQ,createTransformer:dQ,getAnimatableNone:qPe};function II(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+(t-e)*6*n:n<1/2?t:n<2/3?e+(t-e)*(2/3-n)*6:e}function VPe({hue:e,saturation:t,lightness:n,alpha:r}){e/=360,t/=100,n/=100;let s=0,i=0,a=0;if(!t)s=i=a=n;else{const o=n<.5?n*(1+t):n+t-n*t,l=2*n-o;s=II(l,o,e+1/3),i=II(l,o,e),a=II(l,o,e-1/3)}return{red:Math.round(s*255),green:Math.round(i*255),blue:Math.round(a*255),alpha:r}}function mk(e,t){return n=>n>0?t:e}const ti=(e,t,n)=>e+(t-e)*n,jI=(e,t,n)=>{const r=e*e,s=n*(t*t-r)+r;return s<0?0:Math.sqrt(s)},WPe=[Xj,im,C0],HPe=e=>WPe.find(t=>t.test(e));function R7(e){const t=HPe(e);if(!t)return!1;let n=t.parse(e);return t===C0&&(n=VPe(n)),n}const N7=(e,t)=>{const n=R7(e),r=R7(t);if(!n||!r)return mk(e,t);const s={...n};return i=>(s.red=jI(n.red,r.red,i),s.green=jI(n.green,r.green,i),s.blue=jI(n.blue,r.blue,i),s.alpha=ti(n.alpha,r.alpha,i),im.transform(s))},Jj=new Set(["none","hidden"]);function GPe(e,t){return Jj.has(e)?n=>n<=0?e:t:n=>n>=1?t:e}const KPe=(e,t)=>n=>t(e(n)),Y1=(...e)=>e.reduce(KPe);function YPe(e,t){return n=>ti(e,t,n)}function f6(e){return typeof e=="number"?YPe:typeof e=="string"?QD(e)?mk:Oa.test(e)?N7:JPe:Array.isArray(e)?fQ:typeof e=="object"?Oa.test(e)?N7:ZPe:mk}function fQ(e,t){const n=[...e],r=n.length,s=e.map((i,a)=>f6(i)(i,t[a]));return i=>{for(let a=0;a<r;a++)n[a]=s[a](i);return n}}function ZPe(e,t){const n={...e,...t},r={};for(const s in n)e[s]!==void 0&&t[s]!==void 0&&(r[s]=f6(e[s])(e[s],t[s]));return s=>{for(const i in r)n[i]=r[i](s);return n}}function XPe(e,t){const n=[],r={color:0,var:0,number:0};for(let s=0;s<t.values.length;s++){const i=t.types[s],a=e.indexes[i][r[i]],o=e.values[a]??0;n[s]=o,r[i]++}return n}const JPe=(e,t)=>{const n=Ih.createTransformer(t),r=Vw(e),s=Vw(t);return r.indexes.var.length===s.indexes.var.length&&r.indexes.color.length===s.indexes.color.length&&r.indexes.number.length>=s.indexes.number.length?Jj.has(e)&&!s.values.length||Jj.has(t)&&!r.values.length?GPe(e,t):Y1(fQ(XPe(r,s),s.values),n):mk(e,t)};function hQ(e,t,n){return typeof e=="number"&&typeof t=="number"&&typeof n=="number"?ti(e,t,n):f6(e)(e,t)}const QPe=e=>{const t=({timestamp:n})=>e(n);return{start:()=>ri.update(t,!0),stop:()=>Mh(t),now:()=>wa.isProcessing?wa.timestamp:Ao.now()}},pQ=(e,t,n=10)=>{let r="";const s=Math.max(Math.round(t/n),2);for(let i=0;i<s;i++)r+=e(i/(s-1))+", ";return`linear(${r.substring(0,r.length-2)})`},gk=2e4;function h6(e){let t=0;const n=50;let r=e.next(t);for(;!r.done&&t<gk;)t+=n,r=e.next(t);return t>=gk?1/0:t}function eDe(e,t=100,n){const r=n({...e,keyframes:[0,t]}),s=Math.min(h6(r),gk);return{type:"keyframes",ease:i=>r.next(s*i).value/t,duration:Ru(s)}}const tDe=5;function mQ(e,t,n){const r=Math.max(t-tDe,0);return iQ(n-e(r),t-r)}const li={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},M7=.001;function nDe({duration:e=li.duration,bounce:t=li.bounce,velocity:n=li.velocity,mass:r=li.mass}){let s,i,a=1-t;a=Qd(li.minDamping,li.maxDamping,a),e=Qd(li.minDuration,li.maxDuration,Ru(e)),a<1?(s=c=>{const u=c*a,d=u*e,h=u-n,m=Qj(c,a),y=Math.exp(-d);return M7-h/m*y},i=c=>{const d=c*a*e,h=d*n+n,m=Math.pow(a,2)*Math.pow(c,2)*e,y=Math.exp(-d),b=Qj(Math.pow(c,2),a);return(-s(c)+M7>0?-1:1)*((h-m)*y)/b}):(s=c=>{const u=Math.exp(-c*e),d=(c-n)*e+1;return-.001+u*d},i=c=>{const u=Math.exp(-c*e),d=(n-c)*(e*e);return u*d});const o=5/e,l=sDe(s,i,o);if(e=Au(e),isNaN(l))return{stiffness:li.stiffness,damping:li.damping,duration:e};{const c=Math.pow(l,2)*r;return{stiffness:c,damping:a*2*Math.sqrt(r*c),duration:e}}}const rDe=12;function sDe(e,t,n){let r=n;for(let s=1;s<rDe;s++)r=r-e(r)/t(r);return r}function Qj(e,t){return e*Math.sqrt(1-t*t)}const iDe=["duration","bounce"],aDe=["stiffness","damping","mass"];function I7(e,t){return t.some(n=>e[n]!==void 0)}function oDe(e){let t={velocity:li.velocity,stiffness:li.stiffness,damping:li.damping,mass:li.mass,isResolvedFromDuration:!1,...e};if(!I7(e,aDe)&&I7(e,iDe))if(e.visualDuration){const n=e.visualDuration,r=2*Math.PI/(n*1.2),s=r*r,i=2*Qd(.05,1,1-(e.bounce||0))*Math.sqrt(s);t={...t,mass:li.mass,stiffness:s,damping:i}}else{const n=nDe(e);t={...t,...n,mass:li.mass},t.isResolvedFromDuration=!0}return t}function yk(e=li.visualDuration,t=li.bounce){const n=typeof e!="object"?{visualDuration:e,keyframes:[0,1],bounce:t}:e;let{restSpeed:r,restDelta:s}=n;const i=n.keyframes[0],a=n.keyframes[n.keyframes.length-1],o={done:!1,value:i},{stiffness:l,damping:c,mass:u,duration:d,velocity:h,isResolvedFromDuration:m}=oDe({...n,velocity:-Ru(n.velocity||0)}),y=h||0,b=c/(2*Math.sqrt(l*u)),v=a-i,x=Ru(Math.sqrt(l/u)),w=Math.abs(v)<5;r||(r=w?li.restSpeed.granular:li.restSpeed.default),s||(s=w?li.restDelta.granular:li.restDelta.default);let S;if(b<1){const C=Qj(x,b);S=T=>{const R=Math.exp(-b*x*T);return a-R*((y+b*x*v)/C*Math.sin(C*T)+v*Math.cos(C*T))}}else if(b===1)S=C=>a-Math.exp(-x*C)*(v+(y+x*v)*C);else{const C=x*Math.sqrt(b*b-1);S=T=>{const R=Math.exp(-b*x*T),N=Math.min(C*T,300);return a-R*((y+b*x*v)*Math.sinh(N)+C*v*Math.cosh(N))/C}}const k={calculatedDuration:m&&d||null,next:C=>{const T=S(C);if(m)o.done=C>=d;else{let R=C===0?y:0;b<1&&(R=C===0?Au(y):mQ(S,C,T));const N=Math.abs(R)<=r,I=Math.abs(a-T)<=s;o.done=N&&I}return o.value=o.done?a:T,o},toString:()=>{const C=Math.min(h6(k),gk),T=pQ(R=>k.next(C*R).value,C,30);return C+"ms "+T},toTransition:()=>{}};return k}yk.applyToOptions=e=>{const t=eDe(e,100,yk);return e.ease=t.ease,e.duration=Au(t.duration),e.type="keyframes",e};function e4({keyframes:e,velocity:t=0,power:n=.8,timeConstant:r=325,bounceDamping:s=10,bounceStiffness:i=500,modifyTarget:a,min:o,max:l,restDelta:c=.5,restSpeed:u}){const d=e[0],h={done:!1,value:d},m=N=>o!==void 0&&N<o||l!==void 0&&N>l,y=N=>o===void 0?l:l===void 0||Math.abs(o-N)<Math.abs(l-N)?o:l;let b=n*t;const v=d+b,x=a===void 0?v:a(v);x!==v&&(b=x-d);const w=N=>-b*Math.exp(-N/r),S=N=>x+w(N),k=N=>{const I=w(N),P=S(N);h.done=Math.abs(I)<=c,h.value=h.done?x:P};let C,T;const R=N=>{m(h.value)&&(C=N,T=yk({keyframes:[h.value,y(h.value)],velocity:mQ(S,N,h.value),damping:s,stiffness:i,restDelta:c,restSpeed:u}))};return R(0),{calculatedDuration:null,next:N=>{let I=!1;return!T&&C===void 0&&(I=!0,k(N),R(N)),C!==void 0&&N>=C?T.next(N-C):(!I&&k(N),h)}}}const Ww=(e,t,n)=>{const r=t-e;return r===0?1:(n-e)/r};function lDe(e,t,n){const r=[],s=n||Jd.mix||hQ,i=e.length-1;for(let a=0;a<i;a++){let o=s(e[a],e[a+1]);if(t){const l=Array.isArray(t)?t[a]||Hl:t;o=Y1(l,o)}r.push(o)}return r}function cDe(e,t,{clamp:n=!0,ease:r,mixer:s}={}){const i=e.length;if(XD(i===t.length),i===1)return()=>t[0];if(i===2&&t[0]===t[1])return()=>t[1];const a=e[0]===e[1];e[0]>e[i-1]&&(e=[...e].reverse(),t=[...t].reverse());const o=lDe(t,r,s),l=o.length,c=u=>{if(a&&u<e[0])return t[0];let d=0;if(l>1)for(;d<e.length-2&&!(u<e[d+1]);d++);const h=Ww(e[d],e[d+1],u);return o[d](h)};return n?u=>c(Qd(e[0],e[i-1],u)):c}function uDe(e,t){const n=e[e.length-1];for(let r=1;r<=t;r++){const s=Ww(0,t,r);e.push(ti(n,1,s))}}function dDe(e){const t=[0];return uDe(t,e.length-1),t}function fDe(e,t){return e.map(n=>n*t)}const gQ=(e,t,n)=>(((1-3*n+3*t)*e+(3*n-6*t))*e+3*t)*e,hDe=1e-7,pDe=12;function mDe(e,t,n,r,s){let i,a,o=0;do a=t+(n-t)/2,i=gQ(a,r,s)-e,i>0?n=a:t=a;while(Math.abs(i)>hDe&&++o<pDe);return a}function Z1(e,t,n,r){if(e===t&&n===r)return Hl;const s=i=>mDe(i,0,1,e,n);return i=>i===0||i===1?i:gQ(s(i),t,r)}const gDe=Z1(.42,0,1,1),yDe=Z1(0,0,.58,1),yQ=Z1(.42,0,.58,1),bDe=e=>Array.isArray(e)&&typeof e[0]!="number",bQ=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,vQ=e=>t=>1-e(1-t),xQ=Z1(.33,1.53,.69,.99),p6=vQ(xQ),wQ=bQ(p6),_Q=e=>(e*=2)<1?.5*p6(e):.5*(2-Math.pow(2,-10*(e-1))),m6=e=>1-Math.sin(Math.acos(e)),SQ=vQ(m6),CQ=bQ(m6),kQ=e=>Array.isArray(e)&&typeof e[0]=="number",vDe={linear:Hl,easeIn:gDe,easeInOut:yQ,easeOut:yDe,circIn:m6,circInOut:CQ,circOut:SQ,backIn:p6,backInOut:wQ,backOut:xQ,anticipate:_Q},xDe=e=>typeof e=="string",j7=e=>{if(kQ(e)){XD(e.length===4);const[t,n,r,s]=e;return Z1(t,n,r,s)}else if(xDe(e))return vDe[e];return e};function wDe(e,t){return e.map(()=>t||yQ).splice(0,e.length-1)}function Rx({duration:e=300,keyframes:t,times:n,ease:r="easeInOut"}){const s=bDe(r)?r.map(j7):j7(r),i={done:!1,value:t[0]},a=fDe(n&&n.length===t.length?n:dDe(t),e),o=cDe(a,t,{ease:Array.isArray(s)?s:wDe(t,s)});return{calculatedDuration:e,next:l=>(i.value=o(l),i.done=l>=e,i)}}const _De=e=>e!==null;function g6(e,{repeat:t,repeatType:n="loop"},r,s=1){const i=e.filter(_De),o=s<0||t&&n!=="loop"&&t%2===1?0:i.length-1;return!o||r===void 0?i[o]:r}const SDe={decay:e4,inertia:e4,tween:Rx,keyframes:Rx,spring:yk};function EQ(e){typeof e.type=="string"&&(e.type=SDe[e.type])}class y6{constructor(){this.count=0,this.updateFinished()}get finished(){return this._finished}updateFinished(){this.count++,this._finished=new Promise(t=>{this.resolve=t})}notifyFinished(){this.resolve()}then(t,n){return this.finished.then(t,n)}}const CDe=e=>e/100;class TQ extends y6{constructor(t){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{const{motionValue:n}=this.options;if(n&&n.updatedAt!==Ao.now()&&this.tick(Ao.now()),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:r}=this.options;r&&r()},this.options=t,this.initAnimation(),this.play(),t.autoplay===!1&&this.pause()}initAnimation(){const{options:t}=this;EQ(t);const{type:n=Rx,repeat:r=0,repeatDelay:s=0,repeatType:i,velocity:a=0}=t;let{keyframes:o}=t;const l=n||Rx;l!==Rx&&typeof o[0]!="number"&&(this.mixKeyframes=Y1(CDe,hQ(o[0],o[1])),o=[0,100]);const c=l({...t,keyframes:o});i==="mirror"&&(this.mirroredGenerator=l({...t,keyframes:[...o].reverse(),velocity:-a})),c.calculatedDuration===null&&(c.calculatedDuration=h6(c));const{calculatedDuration:u}=c;this.calculatedDuration=u,this.resolvedDuration=u+s,this.totalDuration=this.resolvedDuration*(r+1)-s,this.generator=c}updateTime(t){const n=Math.round(t-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=n}tick(t,n=!1){const{generator:r,totalDuration:s,mixKeyframes:i,mirroredGenerator:a,resolvedDuration:o,calculatedDuration:l}=this;if(this.startTime===null)return r.next(0);const{delay:c=0,keyframes:u,repeat:d,repeatType:h,repeatDelay:m,type:y,onUpdate:b,finalKeyframe:v}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-s/this.speed,this.startTime)),n?this.currentTime=t:this.updateTime(t);const x=this.currentTime-c*(this.playbackSpeed>=0?1:-1),w=this.playbackSpeed>=0?x<0:x>s;this.currentTime=Math.max(x,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=s);let S=this.currentTime,k=r;if(d){const N=Math.min(this.currentTime,s)/o;let I=Math.floor(N),P=N%1;!P&&N>=1&&(P=1),P===1&&I--,I=Math.min(I,d+1),!!(I%2)&&(h==="reverse"?(P=1-P,m&&(P-=m/o)):h==="mirror"&&(k=a)),S=Qd(0,1,P)*o}const C=w?{done:!1,value:u[0]}:k.next(S);i&&(C.value=i(C.value));let{done:T}=C;!w&&l!==null&&(T=this.playbackSpeed>=0?this.currentTime>=s:this.currentTime<=0);const R=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&T);return R&&y!==e4&&(C.value=g6(u,this.options,v,this.speed)),b&&b(C.value),R&&this.finish(),C}then(t,n){return this.finished.then(t,n)}get duration(){return Ru(this.calculatedDuration)}get time(){return Ru(this.currentTime)}set time(t){t=Au(t),this.currentTime=t,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.playbackSpeed)}get speed(){return this.playbackSpeed}set speed(t){this.updateTime(Ao.now());const n=this.playbackSpeed!==t;this.playbackSpeed=t,n&&(this.time=Ru(this.currentTime))}play(){if(this.isStopped)return;const{driver:t=QPe,onPlay:n,startTime:r}=this.options;this.driver||(this.driver=t(i=>this.tick(i))),n&&n();const s=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=s):this.holdTime!==null?this.startTime=s-this.holdTime:this.startTime||(this.startTime=r??s),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(Ao.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:t}=this.options;t&&t()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown()}teardown(){this.notifyFinished(),this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}attachTimeline(t){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),t.observe(this)}}function kDe(e){for(let t=1;t<e.length;t++)e[t]??(e[t]=e[t-1])}const am=e=>e*180/Math.PI,t4=e=>{const t=am(Math.atan2(e[1],e[0]));return n4(t)},EDe={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:e=>(Math.abs(e[0])+Math.abs(e[3]))/2,rotate:t4,rotateZ:t4,skewX:e=>am(Math.atan(e[1])),skewY:e=>am(Math.atan(e[2])),skew:e=>(Math.abs(e[1])+Math.abs(e[2]))/2},n4=e=>(e=e%360,e<0&&(e+=360),e),O7=t4,P7=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),D7=e=>Math.sqrt(e[4]*e[4]+e[5]*e[5]),TDe={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:P7,scaleY:D7,scale:e=>(P7(e)+D7(e))/2,rotateX:e=>n4(am(Math.atan2(e[6],e[5]))),rotateY:e=>n4(am(Math.atan2(-e[2],e[0]))),rotateZ:O7,rotate:O7,skewX:e=>am(Math.atan(e[4])),skewY:e=>am(Math.atan(e[1])),skew:e=>(Math.abs(e[1])+Math.abs(e[4]))/2};function F7(e){return e.includes("scale")?1:0}function r4(e,t){if(!e||e==="none")return F7(t);const n=e.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let r,s;if(n)r=TDe,s=n;else{const o=e.match(/^matrix\(([-\d.e\s,]+)\)$/u);r=EDe,s=o}if(!s)return F7(t);const i=r[t],a=s[1].split(",").map(RDe);return typeof i=="function"?i(a):a[i]}const ADe=(e,t)=>{const{transform:n="none"}=getComputedStyle(e);return r4(n,t)};function RDe(e){return parseFloat(e.trim())}const L7=e=>e===pb||e===or,NDe=new Set(["x","y","z"]),MDe=fb.filter(e=>!NDe.has(e));function IDe(e){const t=[];return MDe.forEach(n=>{const r=e.getValue(n);r!==void 0&&(t.push([n,r.get()]),r.set(n.startsWith("scale")?1:0))}),t}const mm={width:({x:e},{paddingLeft:t="0",paddingRight:n="0"})=>e.max-e.min-parseFloat(t)-parseFloat(n),height:({y:e},{paddingTop:t="0",paddingBottom:n="0"})=>e.max-e.min-parseFloat(t)-parseFloat(n),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:(e,{transform:t})=>r4(t,"x"),y:(e,{transform:t})=>r4(t,"y")};mm.translateX=mm.x;mm.translateY=mm.y;const gm=new Set;let s4=!1,i4=!1,a4=!1;function AQ(){if(i4){const e=Array.from(gm).filter(r=>r.needsMeasurement),t=new Set(e.map(r=>r.element)),n=new Map;t.forEach(r=>{const s=IDe(r);s.length&&(n.set(r,s),r.render())}),e.forEach(r=>r.measureInitialState()),t.forEach(r=>{r.render();const s=n.get(r);s&&s.forEach(([i,a])=>{var o;(o=r.getValue(i))==null||o.set(a)})}),e.forEach(r=>r.measureEndState()),e.forEach(r=>{r.suspendedScrollY!==void 0&&window.scrollTo(0,r.suspendedScrollY)})}i4=!1,s4=!1,gm.forEach(e=>e.complete(a4)),gm.clear()}function RQ(){gm.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(i4=!0)})}function jDe(){a4=!0,RQ(),AQ(),a4=!1}class b6{constructor(t,n,r,s,i,a=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...t],this.onComplete=n,this.name=r,this.motionValue=s,this.element=i,this.isAsync=a}scheduleResolve(){this.isScheduled=!0,this.isAsync?(gm.add(this),s4||(s4=!0,ri.read(RQ),ri.resolveKeyframes(AQ))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:t,name:n,element:r,motionValue:s}=this;if(t[0]===null){const i=s==null?void 0:s.get(),a=t[t.length-1];if(i!==void 0)t[0]=i;else if(r&&n){const o=r.readValue(n,a);o!=null&&(t[0]=o)}t[0]===void 0&&(t[0]=a),s&&i===void 0&&s.set(t[0])}kDe(t)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(t=!1){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,t),gm.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,gm.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const ODe=e=>e.startsWith("--");function PDe(e,t,n){ODe(t)?e.style.setProperty(t,n):e.style[t]=n}function v6(e){let t;return()=>(t===void 0&&(t=e()),t)}const DDe=v6(()=>window.ScrollTimeline!==void 0),FDe={};function LDe(e,t){const n=v6(e);return()=>FDe[t]??n()}const NQ=LDe(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),ix=([e,t,n,r])=>`cubic-bezier(${e}, ${t}, ${n}, ${r})`,B7={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:ix([0,.65,.55,1]),circOut:ix([.55,0,1,.45]),backIn:ix([.31,.01,.66,-.59]),backOut:ix([.33,1.53,.69,.99])};function MQ(e,t){if(e)return typeof e=="function"?NQ()?pQ(e,t):"ease-out":kQ(e)?ix(e):Array.isArray(e)?e.map(n=>MQ(n,t)||B7.easeOut):B7[e]}function BDe(e,t,n,{delay:r=0,duration:s=300,repeat:i=0,repeatType:a="loop",ease:o="easeOut",times:l}={},c=void 0){const u={[t]:n};l&&(u.offset=l);const d=MQ(o,s);Array.isArray(d)&&(u.easing=d);const h={delay:r,duration:s,easing:Array.isArray(d)?"linear":d,fill:"both",iterations:i+1,direction:a==="reverse"?"alternate":"normal"};return c&&(h.pseudoElement=c),e.animate(u,h)}function IQ(e){return typeof e=="function"&&"applyToOptions"in e}function $De({type:e,...t}){return IQ(e)&&NQ()?e.applyToOptions(t):(t.duration??(t.duration=300),t.ease??(t.ease="easeOut"),t)}class zDe extends y6{constructor(t){if(super(),this.finishedTime=null,this.isStopped=!1,!t)return;const{element:n,name:r,keyframes:s,pseudoElement:i,allowFlatten:a=!1,finalKeyframe:o,onComplete:l}=t;this.isPseudoElement=!!i,this.allowFlatten=a,this.options=t,XD(typeof t.type!="string");const c=$De(t);this.animation=BDe(n,r,s,c,i),c.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!i){const u=g6(s,this.options,o,this.speed);this.updateMotionValue?this.updateMotionValue(u):PDe(n,r,u),this.animation.cancel()}l==null||l(),this.notifyFinished()},this.animation.oncancel=()=>this.notifyFinished()}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){var t,n;(n=(t=this.animation).finish)==null||n.call(t)}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:t}=this;t==="idle"||t==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var t,n;this.isPseudoElement||(n=(t=this.animation).commitStyles)==null||n.call(t)}get duration(){var n,r;const t=((r=(n=this.animation.effect)==null?void 0:n.getComputedTiming)==null?void 0:r.call(n).duration)||0;return Ru(Number(t))}get time(){return Ru(Number(this.animation.currentTime)||0)}set time(t){this.finishedTime=null,this.animation.currentTime=Au(t)}get speed(){return this.animation.playbackRate}set speed(t){t<0&&(this.finishedTime=null),this.animation.playbackRate=t}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(t){this.animation.startTime=t}attachTimeline({timeline:t,observe:n}){var r;return this.allowFlatten&&((r=this.animation.effect)==null||r.updateTiming({easing:"linear"})),this.animation.onfinish=null,t&&DDe()?(this.animation.timeline=t,Hl):n(this)}}const jQ={anticipate:_Q,backInOut:wQ,circInOut:CQ};function UDe(e){return e in jQ}function qDe(e){typeof e.ease=="string"&&UDe(e.ease)&&(e.ease=jQ[e.ease])}const $7=10;class VDe extends zDe{constructor(t){qDe(t),EQ(t),super(t),t.startTime&&(this.startTime=t.startTime),this.options=t}updateMotionValue(t){const{motionValue:n,onUpdate:r,onComplete:s,element:i,...a}=this.options;if(!n)return;if(t!==void 0){n.set(t);return}const o=new TQ({...a,autoplay:!1}),l=Au(this.finishedTime??this.time);n.setWithVelocity(o.sample(l-$7).value,o.sample(l).value,$7),o.stop()}}const z7=(e,t)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(Ih.test(e)||e==="0")&&!e.startsWith("url("));function WDe(e){const t=e[0];if(e.length===1)return!0;for(let n=0;n<e.length;n++)if(e[n]!==t)return!0}function HDe(e,t,n,r){const s=e[0];if(s===null)return!1;if(t==="display"||t==="visibility")return!0;const i=e[e.length-1],a=z7(s,t),o=z7(i,t);return!a||!o?!1:WDe(e)||(n==="spring"||IQ(n))&&r}const GDe=new Set(["opacity","clipPath","filter","transform"]),KDe=v6(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function YDe(e){const{motionValue:t,name:n,repeatDelay:r,repeatType:s,damping:i,type:a}=e;if(!t||!t.owner||!(t.owner.current instanceof HTMLElement))return!1;const{onUpdate:o,transformTemplate:l}=t.owner.getProps();return KDe()&&n&&GDe.has(n)&&(n!=="transform"||!l)&&!o&&!r&&s!=="mirror"&&i!==0&&a!=="inertia"}const ZDe=40;class XDe extends y6{constructor({autoplay:t=!0,delay:n=0,type:r="keyframes",repeat:s=0,repeatDelay:i=0,repeatType:a="loop",keyframes:o,name:l,motionValue:c,element:u,...d}){var y;super(),this.stop=()=>{var b,v;this._animation?(this._animation.stop(),(b=this.stopTimeline)==null||b.call(this)):(v=this.keyframeResolver)==null||v.cancel()},this.createdAt=Ao.now();const h={autoplay:t,delay:n,type:r,repeat:s,repeatDelay:i,repeatType:a,name:l,motionValue:c,element:u,...d},m=(u==null?void 0:u.KeyframeResolver)||b6;this.keyframeResolver=new m(o,(b,v,x)=>this.onKeyframesResolved(b,v,h,!x),l,c,u),(y=this.keyframeResolver)==null||y.scheduleResolve()}onKeyframesResolved(t,n,r,s){this.keyframeResolver=void 0;const{name:i,type:a,velocity:o,delay:l,isHandoff:c,onUpdate:u}=r;this.resolvedAt=Ao.now(),HDe(t,i,a,o)||((Jd.instantAnimations||!l)&&(u==null||u(g6(t,r,n))),t[0]=t[t.length-1],r.duration=0,r.repeat=0);const h={startTime:s?this.resolvedAt?this.resolvedAt-this.createdAt>ZDe?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:n,...r,keyframes:t},m=!c&&YDe(h)?new VDe({...h,element:h.motionValue.owner.current}):new TQ(h);m.finished.then(()=>this.notifyFinished()).catch(Hl),this.pendingTimeline&&(this.stopTimeline=m.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=m}get finished(){return this._animation?this.animation.finished:this._finished}then(t,n){return this.finished.finally(t).then(()=>{})}get animation(){return this._animation||jDe(),this._animation}get duration(){return this.animation.duration}get time(){return this.animation.time}set time(t){this.animation.time=t}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(t){this.animation.speed=t}get startTime(){return this.animation.startTime}attachTimeline(t){return this._animation?this.stopTimeline=this.animation.attachTimeline(t):this.pendingTimeline=t,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this.animation.cancel()}}const x6=(e,t,n,r={},s,i)=>a=>{const o=c6(r,e)||{},l=o.delay||r.delay||0;let{elapsed:c=0}=r;c=c-Au(l);const u={keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:t.getVelocity(),...o,delay:-c,onUpdate:h=>{t.set(h),o.onUpdate&&o.onUpdate(h)},onComplete:()=>{a(),o.onComplete&&o.onComplete()},name:e,motionValue:t,element:i?void 0:s};IPe(o)||Object.assign(u,MPe(e,u)),u.duration&&(u.duration=Au(u.duration)),u.repeatDelay&&(u.repeatDelay=Au(u.repeatDelay)),u.from!==void 0&&(u.keyframes[0]=u.from);let d=!1;if((u.type===!1||u.duration===0&&!u.repeatDelay)&&(u.duration=0,u.delay===0&&(d=!0)),(Jd.instantAnimations||Jd.skipAnimations)&&(d=!0,u.duration=0,u.delay=0),u.allowFlatten=!o.type&&!o.ease,d&&!i&&t.get()!==void 0){const h=EPe(u.keyframes,o);if(h!==void 0){ri.update(()=>{u.onUpdate(h),u.onComplete()});return}}return new XDe(u)},OQ=new Set(["width","height","top","left","right","bottom",...fb]);function JDe({protectedKeys:e,needsAnimating:t},n){const r=e.hasOwnProperty(n)&&t[n]!==!0;return t[n]=!1,r}function PQ(e,t,{delay:n=0,transitionOverride:r,type:s}={}){let{transition:i=e.getDefaultTransition(),transitionEnd:a,...o}=t;r&&(i=r);const l=[],c=s&&e.animationState&&e.animationState.getState()[s];for(const u in o){const d=e.getValue(u,e.latestValues[u]??null),h=o[u];if(h===void 0||c&&JDe(c,u))continue;const m={delay:n,...c6(i||{},u)},y=d.get();if(y!==void 0&&!d.isAnimating&&!Array.isArray(h)&&h===y&&!m.velocity)continue;let b=!1;if(window.MotionHandoffAnimation){const x=aQ(e);if(x){const w=window.MotionHandoffAnimation(x,u,ri);w!==null&&(m.startTime=w,b=!0)}}Zj(e,u),d.start(x6(u,d,h,e.shouldReduceMotion&&OQ.has(u)?{type:!1}:m,e,b));const v=d.animation;v&&l.push(v)}return a&&Promise.all(l).then(()=>{ri.update(()=>{a&&SPe(e,a)})}),l}function o4(e,t,n={}){var l;const r=Uw(e,t,n.type==="exit"?(l=e.presenceContext)==null?void 0:l.custom:void 0);let{transition:s=e.getDefaultTransition()||{}}=r||{};n.transitionOverride&&(s=n.transitionOverride);const i=r?()=>Promise.all(PQ(e,r,n)):()=>Promise.resolve(),a=e.variantChildren&&e.variantChildren.size?(c=0)=>{const{delayChildren:u=0,staggerChildren:d,staggerDirection:h}=s;return QDe(e,t,u+c,d,h,n)}:()=>Promise.resolve(),{when:o}=s;if(o){const[c,u]=o==="beforeChildren"?[i,a]:[a,i];return c().then(()=>u())}else return Promise.all([i(),a(n.delay)])}function QDe(e,t,n=0,r=0,s=1,i){const a=[],o=(e.variantChildren.size-1)*r,l=s===1?(c=0)=>c*r:(c=0)=>o-c*r;return Array.from(e.variantChildren).sort(e6e).forEach((c,u)=>{c.notify("AnimationStart",t),a.push(o4(c,t,{...i,delay:n+l(u)}).then(()=>c.notify("AnimationComplete",t)))}),Promise.all(a)}function e6e(e,t){return e.sortNodePosition(t)}function t6e(e,t,n={}){e.notify("AnimationStart",t);let r;if(Array.isArray(t)){const s=t.map(i=>o4(e,i,n));r=Promise.all(s)}else if(typeof t=="string")r=o4(e,t,n);else{const s=typeof t=="function"?Uw(e,t,n.custom):t;r=Promise.all(PQ(e,s,n))}return r.then(()=>{e.notify("AnimationComplete",t)})}function DQ(e,t){if(!Array.isArray(t))return!1;const n=t.length;if(n!==e.length)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}const n6e=KD.length;function FQ(e){if(!e)return;if(!e.isControllingVariants){const n=e.parent?FQ(e.parent)||{}:{};return e.props.initial!==void 0&&(n.initial=e.props.initial),n}const t={};for(let n=0;n<n6e;n++){const r=KD[n],s=e.props[r];(Bw(s)||s===!1)&&(t[r]=s)}return t}const r6e=[...GD].reverse(),s6e=GD.length;function i6e(e){return t=>Promise.all(t.map(({animation:n,options:r})=>t6e(e,n,r)))}function a6e(e){let t=i6e(e),n=U7(),r=!0;const s=l=>(c,u)=>{var h;const d=Uw(e,u,l==="exit"?(h=e.presenceContext)==null?void 0:h.custom:void 0);if(d){const{transition:m,transitionEnd:y,...b}=d;c={...c,...b,...y}}return c};function i(l){t=l(e)}function a(l){const{props:c}=e,u=FQ(e.parent)||{},d=[],h=new Set;let m={},y=1/0;for(let v=0;v<s6e;v++){const x=r6e[v],w=n[x],S=c[x]!==void 0?c[x]:u[x],k=Bw(S),C=x===l?w.isActive:null;C===!1&&(y=v);let T=S===u[x]&&S!==c[x]&&k;if(T&&r&&e.manuallyAnimateOnMount&&(T=!1),w.protectedKeys={...m},!w.isActive&&C===null||!S&&!w.prevProp||ST(S)||typeof S=="boolean")continue;const R=o6e(w.prevProp,S);let N=R||x===l&&w.isActive&&!T&&k||v>y&&k,I=!1;const P=Array.isArray(S)?S:[S];let B=P.reduce(s(x),{});C===!1&&(B={});const{prevResolvedValues:D={}}=w,W={...D,...B},O=H=>{N=!0,h.has(H)&&(I=!0,h.delete(H)),w.needsAnimating[H]=!0;const L=e.getValue(H);L&&(L.liveStyle=!1)};for(const H in W){const L=B[H],te=D[H];if(m.hasOwnProperty(H))continue;let V=!1;Yj(L)&&Yj(te)?V=!DQ(L,te):V=L!==te,V?L!=null?O(H):h.add(H):L!==void 0&&h.has(H)?O(H):w.protectedKeys[H]=!0}w.prevProp=S,w.prevResolvedValues=B,w.isActive&&(m={...m,...B}),r&&e.blockInitialAnimation&&(N=!1),N&&(!(T&&R)||I)&&d.push(...P.map(H=>({animation:H,options:{type:x}})))}if(h.size){const v={};if(typeof c.initial!="boolean"){const x=Uw(e,Array.isArray(c.initial)?c.initial[0]:c.initial);x&&x.transition&&(v.transition=x.transition)}h.forEach(x=>{const w=e.getBaseTarget(x),S=e.getValue(x);S&&(S.liveStyle=!0),v[x]=w??null}),d.push({animation:v})}let b=!!d.length;return r&&(c.initial===!1||c.initial===c.animate)&&!e.manuallyAnimateOnMount&&(b=!1),r=!1,b?t(d):Promise.resolve()}function o(l,c){var d;if(n[l].isActive===c)return Promise.resolve();(d=e.variantChildren)==null||d.forEach(h=>{var m;return(m=h.animationState)==null?void 0:m.setActive(l,c)}),n[l].isActive=c;const u=a(l);for(const h in n)n[h].protectedKeys={};return u}return{animateChanges:a,setActive:o,setAnimateFunction:i,getState:()=>n,reset:()=>{n=U7(),r=!0}}}function o6e(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!DQ(t,e):!1}function qp(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function U7(){return{animate:qp(!0),whileInView:qp(),whileHover:qp(),whileTap:qp(),whileDrag:qp(),whileFocus:qp(),exit:qp()}}class Jh{constructor(t){this.isMounted=!1,this.node=t}update(){}}class l6e extends Jh{constructor(t){super(t),t.animationState||(t.animationState=a6e(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();ST(t)&&(this.unmountControls=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:n}=this.node.prevProps||{};t!==n&&this.updateAnimationControlsSubscription()}unmount(){var t;this.node.animationState.reset(),(t=this.unmountControls)==null||t.call(this)}}let c6e=0;class u6e extends Jh{constructor(){super(...arguments),this.id=c6e++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:n}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===r)return;const s=this.node.animationState.setActive("exit",!t);n&&!t&&s.then(()=>{n(this.id)})}mount(){const{register:t,onExitComplete:n}=this.node.presenceContext||{};n&&n(this.id),t&&(this.unmount=t(this.id))}unmount(){}}const d6e={animation:{Feature:l6e},exit:{Feature:u6e}};function Hw(e,t,n,r={passive:!0}){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n)}const w6=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1;function X1(e){return{point:{x:e.pageX,y:e.pageY}}}const f6e=e=>t=>w6(t)&&e(t,X1(t));function Nx(e,t,n,r){return Hw(e,t,f6e(n),r)}function LQ({top:e,left:t,right:n,bottom:r}){return{x:{min:t,max:n},y:{min:e,max:r}}}function h6e({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function p6e(e,t){if(!t)return e;const n=t({x:e.left,y:e.top}),r=t({x:e.right,y:e.bottom});return{top:n.y,left:n.x,bottom:r.y,right:r.x}}const BQ=1e-4,m6e=1-BQ,g6e=1+BQ,$Q=.01,y6e=0-$Q,b6e=0+$Q;function eo(e){return e.max-e.min}function v6e(e,t,n){return Math.abs(e-t)<=n}function q7(e,t,n,r=.5){e.origin=r,e.originPoint=ti(t.min,t.max,e.origin),e.scale=eo(n)/eo(t),e.translate=ti(n.min,n.max,e.origin)-e.originPoint,(e.scale>=m6e&&e.scale<=g6e||isNaN(e.scale))&&(e.scale=1),(e.translate>=y6e&&e.translate<=b6e||isNaN(e.translate))&&(e.translate=0)}function Mx(e,t,n,r){q7(e.x,t.x,n.x,r?r.originX:void 0),q7(e.y,t.y,n.y,r?r.originY:void 0)}function V7(e,t,n){e.min=n.min+t.min,e.max=e.min+eo(t)}function x6e(e,t,n){V7(e.x,t.x,n.x),V7(e.y,t.y,n.y)}function W7(e,t,n){e.min=t.min-n.min,e.max=e.min+eo(t)}function Ix(e,t,n){W7(e.x,t.x,n.x),W7(e.y,t.y,n.y)}const H7=()=>({translate:0,scale:1,origin:0,originPoint:0}),k0=()=>({x:H7(),y:H7()}),G7=()=>({min:0,max:0}),gi=()=>({x:G7(),y:G7()});function Ll(e){return[e("x"),e("y")]}function OI(e){return e===void 0||e===1}function l4({scale:e,scaleX:t,scaleY:n}){return!OI(e)||!OI(t)||!OI(n)}function Hp(e){return l4(e)||zQ(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function zQ(e){return K7(e.x)||K7(e.y)}function K7(e){return e&&e!=="0%"}function bk(e,t,n){const r=e-n,s=t*r;return n+s}function Y7(e,t,n,r,s){return s!==void 0&&(e=bk(e,s,r)),bk(e,n,r)+t}function c4(e,t=0,n=1,r,s){e.min=Y7(e.min,t,n,r,s),e.max=Y7(e.max,t,n,r,s)}function UQ(e,{x:t,y:n}){c4(e.x,t.translate,t.scale,t.originPoint),c4(e.y,n.translate,n.scale,n.originPoint)}const Z7=.999999999999,X7=1.0000000000001;function w6e(e,t,n,r=!1){const s=n.length;if(!s)return;t.x=t.y=1;let i,a;for(let o=0;o<s;o++){i=n[o],a=i.projectionDelta;const{visualElement:l}=i.options;l&&l.props.style&&l.props.style.display==="contents"||(r&&i.options.layoutScroll&&i.scroll&&i!==i.root&&T0(e,{x:-i.scroll.offset.x,y:-i.scroll.offset.y}),a&&(t.x*=a.x.scale,t.y*=a.y.scale,UQ(e,a)),r&&Hp(i.latestValues)&&T0(e,i.latestValues))}t.x<X7&&t.x>Z7&&(t.x=1),t.y<X7&&t.y>Z7&&(t.y=1)}function E0(e,t){e.min=e.min+t,e.max=e.max+t}function J7(e,t,n,r,s=.5){const i=ti(e.min,e.max,s);c4(e,t,n,i,r)}function T0(e,t){J7(e.x,t.x,t.scaleX,t.scale,t.originX),J7(e.y,t.y,t.scaleY,t.scale,t.originY)}function qQ(e,t){return LQ(p6e(e.getBoundingClientRect(),t))}function _6e(e,t,n){const r=qQ(e,n),{scroll:s}=t;return s&&(E0(r.x,s.offset.x),E0(r.y,s.offset.y)),r}const VQ=({current:e})=>e?e.ownerDocument.defaultView:null,Q7=(e,t)=>Math.abs(e-t);function S6e(e,t){const n=Q7(e.x,t.x),r=Q7(e.y,t.y);return Math.sqrt(n**2+r**2)}class WQ{constructor(t,n,{transformPagePoint:r,contextWindow:s,dragSnapToOrigin:i=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const d=DI(this.lastMoveEventInfo,this.history),h=this.startEvent!==null,m=S6e(d.offset,{x:0,y:0})>=3;if(!h&&!m)return;const{point:y}=d,{timestamp:b}=wa;this.history.push({...y,timestamp:b});const{onStart:v,onMove:x}=this.handlers;h||(v&&v(this.lastMoveEvent,d),this.startEvent=this.lastMoveEvent),x&&x(this.lastMoveEvent,d)},this.handlePointerMove=(d,h)=>{this.lastMoveEvent=d,this.lastMoveEventInfo=PI(h,this.transformPagePoint),ri.update(this.updatePoint,!0)},this.handlePointerUp=(d,h)=>{this.end();const{onEnd:m,onSessionEnd:y,resumeAnimation:b}=this.handlers;if(this.dragSnapToOrigin&&b&&b(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const v=DI(d.type==="pointercancel"?this.lastMoveEventInfo:PI(h,this.transformPagePoint),this.history);this.startEvent&&m&&m(d,v),y&&y(d,v)},!w6(t))return;this.dragSnapToOrigin=i,this.handlers=n,this.transformPagePoint=r,this.contextWindow=s||window;const a=X1(t),o=PI(a,this.transformPagePoint),{point:l}=o,{timestamp:c}=wa;this.history=[{...l,timestamp:c}];const{onSessionStart:u}=n;u&&u(t,DI(o,this.history)),this.removeListeners=Y1(Nx(this.contextWindow,"pointermove",this.handlePointerMove),Nx(this.contextWindow,"pointerup",this.handlePointerUp),Nx(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),Mh(this.updatePoint)}}function PI(e,t){return t?{point:t(e.point)}:e}function eU(e,t){return{x:e.x-t.x,y:e.y-t.y}}function DI({point:e},t){return{point:e,delta:eU(e,HQ(t)),offset:eU(e,C6e(t)),velocity:k6e(t,.1)}}function C6e(e){return e[0]}function HQ(e){return e[e.length-1]}function k6e(e,t){if(e.length<2)return{x:0,y:0};let n=e.length-1,r=null;const s=HQ(e);for(;n>=0&&(r=e[n],!(s.timestamp-r.timestamp>Au(t)));)n--;if(!r)return{x:0,y:0};const i=Ru(s.timestamp-r.timestamp);if(i===0)return{x:0,y:0};const a={x:(s.x-r.x)/i,y:(s.y-r.y)/i};return a.x===1/0&&(a.x=0),a.y===1/0&&(a.y=0),a}function E6e(e,{min:t,max:n},r){return t!==void 0&&e<t?e=r?ti(t,e,r.min):Math.max(e,t):n!==void 0&&e>n&&(e=r?ti(n,e,r.max):Math.min(e,n)),e}function tU(e,t,n){return{min:t!==void 0?e.min+t:void 0,max:n!==void 0?e.max+n-(e.max-e.min):void 0}}function T6e(e,{top:t,left:n,bottom:r,right:s}){return{x:tU(e.x,n,s),y:tU(e.y,t,r)}}function nU(e,t){let n=t.min-e.min,r=t.max-e.max;return t.max-t.min<e.max-e.min&&([n,r]=[r,n]),{min:n,max:r}}function A6e(e,t){return{x:nU(e.x,t.x),y:nU(e.y,t.y)}}function R6e(e,t){let n=.5;const r=eo(e),s=eo(t);return s>r?n=Ww(t.min,t.max-r,e.min):r>s&&(n=Ww(e.min,e.max-s,t.min)),Qd(0,1,n)}function N6e(e,t){const n={};return t.min!==void 0&&(n.min=t.min-e.min),t.max!==void 0&&(n.max=t.max-e.min),n}const u4=.35;function M6e(e=u4){return e===!1?e=0:e===!0&&(e=u4),{x:rU(e,"left","right"),y:rU(e,"top","bottom")}}function rU(e,t,n){return{min:sU(e,t),max:sU(e,n)}}function sU(e,t){return typeof e=="number"?e:e[t]||0}const gc={x:!1,y:!1};function GQ(){return gc.x||gc.y}function I6e(e){return e==="x"||e==="y"?gc[e]?null:(gc[e]=!0,()=>{gc[e]=!1}):gc.x||gc.y?null:(gc.x=gc.y=!0,()=>{gc.x=gc.y=!1})}const j6e=new WeakMap;class O6e{constructor(t){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=gi(),this.visualElement=t}start(t,{snapToCursor:n=!1}={}){const{presenceContext:r}=this.visualElement;if(r&&r.isPresent===!1)return;const s=u=>{const{dragSnapToOrigin:d}=this.getProps();d?this.pauseAnimation():this.stopAnimation(),n&&this.snapToCursor(X1(u).point)},i=(u,d)=>{const{drag:h,dragPropagation:m,onDragStart:y}=this.getProps();if(h&&!m&&(this.openDragLock&&this.openDragLock(),this.openDragLock=I6e(h),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Ll(v=>{let x=this.getAxisMotionValue(v).get()||0;if(Tu.test(x)){const{projection:w}=this.visualElement;if(w&&w.layout){const S=w.layout.layoutBox[v];S&&(x=eo(S)*(parseFloat(x)/100))}}this.originPoint[v]=x}),y&&ri.postRender(()=>y(u,d)),Zj(this.visualElement,"transform");const{animationState:b}=this.visualElement;b&&b.setActive("whileDrag",!0)},a=(u,d)=>{const{dragPropagation:h,dragDirectionLock:m,onDirectionLock:y,onDrag:b}=this.getProps();if(!h&&!this.openDragLock)return;const{offset:v}=d;if(m&&this.currentDirection===null){this.currentDirection=P6e(v),this.currentDirection!==null&&y&&y(this.currentDirection);return}this.updateAxis("x",d.point,v),this.updateAxis("y",d.point,v),this.visualElement.render(),b&&b(u,d)},o=(u,d)=>this.stop(u,d),l=()=>Ll(u=>{var d;return this.getAnimationState(u)==="paused"&&((d=this.getAxisMotionValue(u).animation)==null?void 0:d.play())}),{dragSnapToOrigin:c}=this.getProps();this.panSession=new WQ(t,{onSessionStart:s,onStart:i,onMove:a,onSessionEnd:o,resumeAnimation:l},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:c,contextWindow:VQ(this.visualElement)})}stop(t,n){const r=this.isDragging;if(this.cancel(),!r)return;const{velocity:s}=n;this.startAnimation(s);const{onDragEnd:i}=this.getProps();i&&ri.postRender(()=>i(t,n))}cancel(){this.isDragging=!1;const{projection:t,animationState:n}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(t,n,r){const{drag:s}=this.getProps();if(!r||!JS(t,s,this.currentDirection))return;const i=this.getAxisMotionValue(t);let a=this.originPoint[t]+r[t];this.constraints&&this.constraints[t]&&(a=E6e(a,this.constraints[t],this.elastic[t])),i.set(a)}resolveConstraints(){var i;const{dragConstraints:t,dragElastic:n}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(i=this.visualElement.projection)==null?void 0:i.layout,s=this.constraints;t&&S0(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&r?this.constraints=T6e(r.layoutBox,t):this.constraints=!1,this.elastic=M6e(n),s!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&Ll(a=>{this.constraints!==!1&&this.getAxisMotionValue(a)&&(this.constraints[a]=N6e(r.layoutBox[a],this.constraints[a]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:n}=this.getProps();if(!t||!S0(t))return!1;const r=t.current,{projection:s}=this.visualElement;if(!s||!s.layout)return!1;const i=_6e(r,s.root,this.visualElement.getTransformPagePoint());let a=A6e(s.layout.layoutBox,i);if(n){const o=n(h6e(a));this.hasMutatedConstraints=!!o,o&&(a=LQ(o))}return a}startAnimation(t){const{drag:n,dragMomentum:r,dragElastic:s,dragTransition:i,dragSnapToOrigin:a,onDragTransitionEnd:o}=this.getProps(),l=this.constraints||{},c=Ll(u=>{if(!JS(u,n,this.currentDirection))return;let d=l&&l[u]||{};a&&(d={min:0,max:0});const h=s?200:1e6,m=s?40:1e7,y={type:"inertia",velocity:r?t[u]:0,bounceStiffness:h,bounceDamping:m,timeConstant:750,restDelta:1,restSpeed:10,...i,...d};return this.startAxisValueAnimation(u,y)});return Promise.all(c).then(o)}startAxisValueAnimation(t,n){const r=this.getAxisMotionValue(t);return Zj(this.visualElement,t),r.start(x6(t,r,0,n,this.visualElement,!1))}stopAnimation(){Ll(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){Ll(t=>{var n;return(n=this.getAxisMotionValue(t).animation)==null?void 0:n.pause()})}getAnimationState(t){var n;return(n=this.getAxisMotionValue(t).animation)==null?void 0:n.state}getAxisMotionValue(t){const n=`_drag${t.toUpperCase()}`,r=this.visualElement.getProps(),s=r[n];return s||this.visualElement.getValue(t,(r.initial?r.initial[t]:void 0)||0)}snapToCursor(t){Ll(n=>{const{drag:r}=this.getProps();if(!JS(n,r,this.currentDirection))return;const{projection:s}=this.visualElement,i=this.getAxisMotionValue(n);if(s&&s.layout){const{min:a,max:o}=s.layout.layoutBox[n];i.set(t[n]-ti(a,o,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:n}=this.getProps(),{projection:r}=this.visualElement;if(!S0(n)||!r||!this.constraints)return;this.stopAnimation();const s={x:0,y:0};Ll(a=>{const o=this.getAxisMotionValue(a);if(o&&this.constraints!==!1){const l=o.get();s[a]=R6e({min:l,max:l},this.constraints[a])}});const{transformTemplate:i}=this.visualElement.getProps();this.visualElement.current.style.transform=i?i({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),Ll(a=>{if(!JS(a,t,null))return;const o=this.getAxisMotionValue(a),{min:l,max:c}=this.constraints[a];o.set(ti(l,c,s[a]))})}addListeners(){if(!this.visualElement.current)return;j6e.set(this.visualElement,this);const t=this.visualElement.current,n=Nx(t,"pointerdown",l=>{const{drag:c,dragListener:u=!0}=this.getProps();c&&u&&this.start(l)}),r=()=>{const{dragConstraints:l}=this.getProps();S0(l)&&l.current&&(this.constraints=this.resolveRefConstraints())},{projection:s}=this.visualElement,i=s.addEventListener("measure",r);s&&!s.layout&&(s.root&&s.root.updateScroll(),s.updateLayout()),ri.read(r);const a=Hw(window,"resize",()=>this.scalePositionWithinConstraints()),o=s.addEventListener("didUpdate",({delta:l,hasLayoutChanged:c})=>{this.isDragging&&c&&(Ll(u=>{const d=this.getAxisMotionValue(u);d&&(this.originPoint[u]+=l[u].translate,d.set(d.get()+l[u].translate))}),this.visualElement.render())});return()=>{a(),n(),i(),o&&o()}}getProps(){const t=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:r=!1,dragPropagation:s=!1,dragConstraints:i=!1,dragElastic:a=u4,dragMomentum:o=!0}=t;return{...t,drag:n,dragDirectionLock:r,dragPropagation:s,dragConstraints:i,dragElastic:a,dragMomentum:o}}}function JS(e,t,n){return(t===!0||t===e)&&(n===null||n===e)}function P6e(e,t=10){let n=null;return Math.abs(e.y)>t?n="y":Math.abs(e.x)>t&&(n="x"),n}class D6e extends Jh{constructor(t){super(t),this.removeGroupControls=Hl,this.removeListeners=Hl,this.controls=new O6e(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Hl}unmount(){this.removeGroupControls(),this.removeListeners()}}const iU=e=>(t,n)=>{e&&ri.postRender(()=>e(t,n))};class F6e extends Jh{constructor(){super(...arguments),this.removePointerDownListener=Hl}onPointerDown(t){this.session=new WQ(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:VQ(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:n,onPan:r,onPanEnd:s}=this.node.getProps();return{onSessionStart:iU(t),onStart:iU(n),onMove:r,onEnd:(i,a)=>{delete this.session,s&&ri.postRender(()=>s(i,a))}}}mount(){this.removePointerDownListener=Nx(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const F2={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function aU(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const Uv={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(or.test(e))e=parseFloat(e);else return e;const n=aU(e,t.target.x),r=aU(e,t.target.y);return`${n}% ${r}%`}},L6e={correct:(e,{treeScale:t,projectionDelta:n})=>{const r=e,s=Ih.parse(e);if(s.length>5)return r;const i=Ih.createTransformer(e),a=typeof s[0]!="number"?1:0,o=n.x.scale*t.x,l=n.y.scale*t.y;s[0+a]/=o,s[1+a]/=l;const c=ti(o,l,.5);return typeof s[2+a]=="number"&&(s[2+a]/=c),typeof s[3+a]=="number"&&(s[3+a]/=c),i(s)}};class B6e extends E.Component{componentDidMount(){const{visualElement:t,layoutGroup:n,switchLayoutGroup:r,layoutId:s}=this.props,{projection:i}=t;XOe($6e),i&&(n.group&&n.group.add(i),r&&r.register&&s&&r.register(i),i.root.didUpdate(),i.addEventListener("animationComplete",()=>{this.safeToRemove()}),i.setOptions({...i.options,onExitComplete:()=>this.safeToRemove()})),F2.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:n,visualElement:r,drag:s,isPresent:i}=this.props,{projection:a}=r;return a&&(a.isPresent=i,s||t.layoutDependency!==n||n===void 0||t.isPresent!==i?a.willUpdate():this.safeToRemove(),t.isPresent!==i&&(i?a.promote():a.relegate()||ri.postRender(()=>{const o=a.getStack();(!o||!o.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),ZD.postRender(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:n,switchLayoutGroup:r}=this.props,{projection:s}=t;s&&(s.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(s),r&&r.deregister&&r.deregister(s))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function KQ(e){const[t,n]=UJ(),r=E.useContext(qD);return f.jsx(B6e,{...e,layoutGroup:r,switchLayoutGroup:E.useContext(KJ),isPresent:t,safeToRemove:n})}const $6e={borderRadius:{...Uv,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Uv,borderTopRightRadius:Uv,borderBottomLeftRadius:Uv,borderBottomRightRadius:Uv,boxShadow:L6e};function z6e(e,t,n){const r=La(e)?e:qw(e);return r.start(x6("",r,t,n)),r.animation}function U6e(e){return e instanceof SVGElement&&e.tagName!=="svg"}const q6e=(e,t)=>e.depth-t.depth;class V6e{constructor(){this.children=[],this.isDirty=!1}add(t){a6(this.children,t),this.isDirty=!0}remove(t){o6(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(q6e),this.isDirty=!1,this.children.forEach(t)}}function W6e(e,t){const n=Ao.now(),r=({timestamp:s})=>{const i=s-n;i>=t&&(Mh(r),e(i-t))};return ri.setup(r,!0),()=>Mh(r)}const YQ=["TopLeft","TopRight","BottomLeft","BottomRight"],H6e=YQ.length,oU=e=>typeof e=="string"?parseFloat(e):e,lU=e=>typeof e=="number"||or.test(e);function G6e(e,t,n,r,s,i){s?(e.opacity=ti(0,n.opacity??1,K6e(r)),e.opacityExit=ti(t.opacity??1,0,Y6e(r))):i&&(e.opacity=ti(t.opacity??1,n.opacity??1,r));for(let a=0;a<H6e;a++){const o=`border${YQ[a]}Radius`;let l=cU(t,o),c=cU(n,o);if(l===void 0&&c===void 0)continue;l||(l=0),c||(c=0),l===0||c===0||lU(l)===lU(c)?(e[o]=Math.max(ti(oU(l),oU(c),r),0),(Tu.test(c)||Tu.test(l))&&(e[o]+="%")):e[o]=c}(t.rotate||n.rotate)&&(e.rotate=ti(t.rotate||0,n.rotate||0,r))}function cU(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const K6e=ZQ(0,.5,SQ),Y6e=ZQ(.5,.95,Hl);function ZQ(e,t,n){return r=>r<e?0:r>t?1:n(Ww(e,t,r))}function uU(e,t){e.min=t.min,e.max=t.max}function Ol(e,t){uU(e.x,t.x),uU(e.y,t.y)}function dU(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}function fU(e,t,n,r,s){return e-=t,e=bk(e,1/n,r),s!==void 0&&(e=bk(e,1/s,r)),e}function Z6e(e,t=0,n=1,r=.5,s,i=e,a=e){if(Tu.test(t)&&(t=parseFloat(t),t=ti(a.min,a.max,t/100)-a.min),typeof t!="number")return;let o=ti(i.min,i.max,r);e===i&&(o-=t),e.min=fU(e.min,t,n,o,s),e.max=fU(e.max,t,n,o,s)}function hU(e,t,[n,r,s],i,a){Z6e(e,t[n],t[r],t[s],t.scale,i,a)}const X6e=["x","scaleX","originX"],J6e=["y","scaleY","originY"];function pU(e,t,n,r){hU(e.x,t,X6e,n?n.x:void 0,r?r.x:void 0),hU(e.y,t,J6e,n?n.y:void 0,r?r.y:void 0)}function mU(e){return e.translate===0&&e.scale===1}function XQ(e){return mU(e.x)&&mU(e.y)}function gU(e,t){return e.min===t.min&&e.max===t.max}function Q6e(e,t){return gU(e.x,t.x)&&gU(e.y,t.y)}function yU(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function JQ(e,t){return yU(e.x,t.x)&&yU(e.y,t.y)}function bU(e){return eo(e.x)/eo(e.y)}function vU(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}class eFe{constructor(){this.members=[]}add(t){a6(this.members,t),t.scheduleRender()}remove(t){if(o6(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(t){const n=this.members.findIndex(s=>t===s);if(n===0)return!1;let r;for(let s=n;s>=0;s--){const i=this.members[s];if(i.isPresent!==!1){r=i;break}}return r?(this.promote(r),!0):!1}promote(t,n){const r=this.lead;if(t!==r&&(this.prevLead=r,this.lead=t,t.show(),r)){r.instance&&r.scheduleRender(),t.scheduleRender(),t.resumeFrom=r,n&&(t.resumeFrom.preserveOpacity=!0),r.snapshot&&(t.snapshot=r.snapshot,t.snapshot.latestValues=r.animationValues||r.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:s}=t.options;s===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:n,resumingFrom:r}=t;n.onExitComplete&&n.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function tFe(e,t,n){let r="";const s=e.x.translate/t.x,i=e.y.translate/t.y,a=(n==null?void 0:n.z)||0;if((s||i||a)&&(r=`translate3d(${s}px, ${i}px, ${a}px) `),(t.x!==1||t.y!==1)&&(r+=`scale(${1/t.x}, ${1/t.y}) `),n){const{transformPerspective:c,rotate:u,rotateX:d,rotateY:h,skewX:m,skewY:y}=n;c&&(r=`perspective(${c}px) ${r}`),u&&(r+=`rotate(${u}deg) `),d&&(r+=`rotateX(${d}deg) `),h&&(r+=`rotateY(${h}deg) `),m&&(r+=`skewX(${m}deg) `),y&&(r+=`skewY(${y}deg) `)}const o=e.x.scale*t.x,l=e.y.scale*t.y;return(o!==1||l!==1)&&(r+=`scale(${o}, ${l})`),r||"none"}const FI=["","X","Y","Z"],nFe={visibility:"hidden"},xU=1e3;let rFe=0;function LI(e,t,n,r){const{latestValues:s}=t;s[e]&&(n[e]=s[e],t.setStaticValue(e,0),r&&(r[e]=0))}function QQ(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:t}=e.options;if(!t)return;const n=aQ(t);if(window.MotionHasOptimisedAnimation(n,"transform")){const{layout:s,layoutId:i}=e.options;window.MotionCancelOptimisedAnimation(n,"transform",ri,!(s||i))}const{parent:r}=e;r&&!r.hasCheckedOptimisedAppear&&QQ(r)}function eee({attachResizeListener:e,defaultParent:t,measureScroll:n,checkIsScrollRoot:r,resetTransform:s}){return class{constructor(a={},o=t==null?void 0:t()){this.id=rFe++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(aFe),this.nodes.forEach(dFe),this.nodes.forEach(fFe),this.nodes.forEach(oFe)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=a,this.root=o?o.root||o:this,this.path=o?[...o.path,o]:[],this.parent=o,this.depth=o?o.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new V6e)}addEventListener(a,o){return this.eventHandlers.has(a)||this.eventHandlers.set(a,new l6),this.eventHandlers.get(a).add(o)}notifyListeners(a,...o){const l=this.eventHandlers.get(a);l&&l.notify(...o)}hasListeners(a){return this.eventHandlers.has(a)}mount(a){if(this.instance)return;this.isSVG=U6e(a),this.instance=a;const{layoutId:o,layout:l,visualElement:c}=this.options;if(c&&!c.current&&c.mount(a),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(l||o)&&(this.isLayoutDirty=!0),e){let u;const d=()=>this.root.updateBlockedByResize=!1;e(a,()=>{this.root.updateBlockedByResize=!0,u&&u(),u=W6e(d,250),F2.hasAnimatedSinceResize&&(F2.hasAnimatedSinceResize=!1,this.nodes.forEach(_U))})}o&&this.root.registerSharedNode(o,this),this.options.animate!==!1&&c&&(o||l)&&this.addEventListener("didUpdate",({delta:u,hasLayoutChanged:d,hasRelativeLayoutChanged:h,layout:m})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const y=this.options.transition||c.getDefaultTransition()||yFe,{onLayoutAnimationStart:b,onLayoutAnimationComplete:v}=c.getProps(),x=!this.targetLayout||!JQ(this.targetLayout,m),w=!d&&h;if(this.options.layoutRoot||this.resumeFrom||w||d&&(x||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(u,w);const S={...c6(y,"layout"),onPlay:b,onComplete:v};(c.shouldReduceMotion||this.options.layoutRoot)&&(S.delay=0,S.type=!1),this.startAnimation(S)}else d||_U(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=m})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const a=this.getStack();a&&a.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),Mh(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(hFe),this.animationId++)}getTransformTemplate(){const{visualElement:a}=this.options;return a&&a.getProps().transformTemplate}willUpdate(a=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&QQ(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let u=0;u<this.path.length;u++){const d=this.path[u];d.shouldResetTransform=!0,d.updateScroll("snapshot"),d.options.layoutRoot&&d.willUpdate(!1)}const{layoutId:o,layout:l}=this.options;if(o===void 0&&!l)return;const c=this.getTransformTemplate();this.prevTransformTemplateValue=c?c(this.latestValues,""):void 0,this.updateSnapshot(),a&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(wU);return}this.isUpdating||this.nodes.forEach(cFe),this.isUpdating=!1,this.nodes.forEach(uFe),this.nodes.forEach(sFe),this.nodes.forEach(iFe),this.clearAllSnapshots();const o=Ao.now();wa.delta=Qd(0,1e3/60,o-wa.timestamp),wa.timestamp=o,wa.isProcessing=!0,NI.update.process(wa),NI.preRender.process(wa),NI.render.process(wa),wa.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,ZD.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(lFe),this.sharedNodes.forEach(pFe)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,ri.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){ri.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!eo(this.snapshot.measuredBox.x)&&!eo(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const a=this.layout;this.layout=this.measure(!1),this.layoutCorrected=gi(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:o}=this.options;o&&o.notify("LayoutMeasure",this.layout.layoutBox,a?a.layoutBox:void 0)}updateScroll(a="measure"){let o=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===a&&(o=!1),o&&this.instance){const l=r(this.instance);this.scroll={animationId:this.root.animationId,phase:a,isRoot:l,offset:n(this.instance),wasRoot:this.scroll?this.scroll.isRoot:l}}}resetTransform(){if(!s)return;const a=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,o=this.projectionDelta&&!XQ(this.projectionDelta),l=this.getTransformTemplate(),c=l?l(this.latestValues,""):void 0,u=c!==this.prevTransformTemplateValue;a&&this.instance&&(o||Hp(this.latestValues)||u)&&(s(this.instance,c),this.shouldResetTransform=!1,this.scheduleRender())}measure(a=!0){const o=this.measurePageBox();let l=this.removeElementScroll(o);return a&&(l=this.removeTransform(l)),bFe(l),{animationId:this.root.animationId,measuredBox:o,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){var c;const{visualElement:a}=this.options;if(!a)return gi();const o=a.measureViewportBox();if(!(((c=this.scroll)==null?void 0:c.wasRoot)||this.path.some(vFe))){const{scroll:u}=this.root;u&&(E0(o.x,u.offset.x),E0(o.y,u.offset.y))}return o}removeElementScroll(a){var l;const o=gi();if(Ol(o,a),(l=this.scroll)!=null&&l.wasRoot)return o;for(let c=0;c<this.path.length;c++){const u=this.path[c],{scroll:d,options:h}=u;u!==this.root&&d&&h.layoutScroll&&(d.wasRoot&&Ol(o,a),E0(o.x,d.offset.x),E0(o.y,d.offset.y))}return o}applyTransform(a,o=!1){const l=gi();Ol(l,a);for(let c=0;c<this.path.length;c++){const u=this.path[c];!o&&u.options.layoutScroll&&u.scroll&&u!==u.root&&T0(l,{x:-u.scroll.offset.x,y:-u.scroll.offset.y}),Hp(u.latestValues)&&T0(l,u.latestValues)}return Hp(this.latestValues)&&T0(l,this.latestValues),l}removeTransform(a){const o=gi();Ol(o,a);for(let l=0;l<this.path.length;l++){const c=this.path[l];if(!c.instance||!Hp(c.latestValues))continue;l4(c.latestValues)&&c.updateSnapshot();const u=gi(),d=c.measurePageBox();Ol(u,d),pU(o,c.latestValues,c.snapshot?c.snapshot.layoutBox:void 0,u)}return Hp(this.latestValues)&&pU(o,this.latestValues),o}setTargetDelta(a){this.targetDelta=a,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(a){this.options={...this.options,...a,crossfade:a.crossfade!==void 0?a.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==wa.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(a=!1){var h;const o=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=o.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=o.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=o.isSharedProjectionDirty);const l=!!this.resumingFrom||this!==o;if(!(a||l&&this.isSharedProjectionDirty||this.isProjectionDirty||(h=this.parent)!=null&&h.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:u,layoutId:d}=this.options;if(!(!this.layout||!(u||d))){if(this.resolvedRelativeTargetAt=wa.timestamp,!this.targetDelta&&!this.relativeTarget){const m=this.getClosestProjectingParent();m&&m.layout&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=gi(),this.relativeTargetOrigin=gi(),Ix(this.relativeTargetOrigin,this.layout.layoutBox,m.layout.layoutBox),Ol(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=gi(),this.targetWithTransforms=gi()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),x6e(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Ol(this.target,this.layout.layoutBox),UQ(this.target,this.targetDelta)):Ol(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const m=this.getClosestProjectingParent();m&&!!m.resumingFrom==!!this.resumingFrom&&!m.options.layoutScroll&&m.target&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=gi(),this.relativeTargetOrigin=gi(),Ix(this.relativeTargetOrigin,this.target,m.target),Ol(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||l4(this.parent.latestValues)||zQ(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var y;const a=this.getLead(),o=!!this.resumingFrom||this!==a;let l=!0;if((this.isProjectionDirty||(y=this.parent)!=null&&y.isProjectionDirty)&&(l=!1),o&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(l=!1),this.resolvedRelativeTargetAt===wa.timestamp&&(l=!1),l)return;const{layout:c,layoutId:u}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(c||u))return;Ol(this.layoutCorrected,this.layout.layoutBox);const d=this.treeScale.x,h=this.treeScale.y;w6e(this.layoutCorrected,this.treeScale,this.path,o),a.layout&&!a.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(a.target=a.layout.layoutBox,a.targetWithTransforms=gi());const{target:m}=a;if(!m){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(dU(this.prevProjectionDelta.x,this.projectionDelta.x),dU(this.prevProjectionDelta.y,this.projectionDelta.y)),Mx(this.projectionDelta,this.layoutCorrected,m,this.latestValues),(this.treeScale.x!==d||this.treeScale.y!==h||!vU(this.projectionDelta.x,this.prevProjectionDelta.x)||!vU(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",m))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(a=!0){var o;if((o=this.options.visualElement)==null||o.scheduleRender(),a){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=k0(),this.projectionDelta=k0(),this.projectionDeltaWithTransform=k0()}setAnimationOrigin(a,o=!1){const l=this.snapshot,c=l?l.latestValues:{},u={...this.latestValues},d=k0();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!o;const h=gi(),m=l?l.source:void 0,y=this.layout?this.layout.source:void 0,b=m!==y,v=this.getStack(),x=!v||v.members.length<=1,w=!!(b&&!x&&this.options.crossfade===!0&&!this.path.some(gFe));this.animationProgress=0;let S;this.mixTargetDelta=k=>{const C=k/1e3;SU(d.x,a.x,C),SU(d.y,a.y,C),this.setTargetDelta(d),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Ix(h,this.layout.layoutBox,this.relativeParent.layout.layoutBox),mFe(this.relativeTarget,this.relativeTargetOrigin,h,C),S&&Q6e(this.relativeTarget,S)&&(this.isProjectionDirty=!1),S||(S=gi()),Ol(S,this.relativeTarget)),b&&(this.animationValues=u,G6e(u,c,this.latestValues,C,w,x)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=C},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(a){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(Mh(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=ri.update(()=>{F2.hasAnimatedSinceResize=!0,this.currentAnimation=z6e(0,xU,{...a,onUpdate:o=>{this.mixTargetDelta(o),a.onUpdate&&a.onUpdate(o)},onStop:()=>{},onComplete:()=>{a.onComplete&&a.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const a=this.getStack();a&&a.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(xU),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const a=this.getLead();let{targetWithTransforms:o,target:l,layout:c,latestValues:u}=a;if(!(!o||!l||!c)){if(this!==a&&this.layout&&c&&tee(this.options.animationType,this.layout.layoutBox,c.layoutBox)){l=this.target||gi();const d=eo(this.layout.layoutBox.x);l.x.min=a.target.x.min,l.x.max=l.x.min+d;const h=eo(this.layout.layoutBox.y);l.y.min=a.target.y.min,l.y.max=l.y.min+h}Ol(o,l),T0(o,u),Mx(this.projectionDeltaWithTransform,this.layoutCorrected,o,u)}}registerSharedNode(a,o){this.sharedNodes.has(a)||this.sharedNodes.set(a,new eFe),this.sharedNodes.get(a).add(o);const c=o.options.initialPromotionConfig;o.promote({transition:c?c.transition:void 0,preserveFollowOpacity:c&&c.shouldPreserveFollowOpacity?c.shouldPreserveFollowOpacity(o):void 0})}isLead(){const a=this.getStack();return a?a.lead===this:!0}getLead(){var o;const{layoutId:a}=this.options;return a?((o=this.getStack())==null?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:a}=this.options;return a?(o=this.getStack())==null?void 0:o.prevLead:void 0}getStack(){const{layoutId:a}=this.options;if(a)return this.root.sharedNodes.get(a)}promote({needsReset:a,transition:o,preserveFollowOpacity:l}={}){const c=this.getStack();c&&c.promote(this,l),a&&(this.projectionDelta=void 0,this.needsReset=!0),o&&this.setOptions({transition:o})}relegate(){const a=this.getStack();return a?a.relegate(this):!1}resetSkewAndRotation(){const{visualElement:a}=this.options;if(!a)return;let o=!1;const{latestValues:l}=a;if((l.z||l.rotate||l.rotateX||l.rotateY||l.rotateZ||l.skewX||l.skewY)&&(o=!0),!o)return;const c={};l.z&&LI("z",a,c,this.animationValues);for(let u=0;u<FI.length;u++)LI(`rotate${FI[u]}`,a,c,this.animationValues),LI(`skew${FI[u]}`,a,c,this.animationValues);a.render();for(const u in c)a.setStaticValue(u,c[u]),this.animationValues&&(this.animationValues[u]=c[u]);a.scheduleRender()}getProjectionStyles(a){if(!this.instance||this.isSVG)return;if(!this.isVisible)return nFe;const o={visibility:""},l=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,o.opacity="",o.pointerEvents=P2(a==null?void 0:a.pointerEvents)||"",o.transform=l?l(this.latestValues,""):"none",o;const c=this.getLead();if(!this.projectionDelta||!this.layout||!c.target){const m={};return this.options.layoutId&&(m.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,m.pointerEvents=P2(a==null?void 0:a.pointerEvents)||""),this.hasProjected&&!Hp(this.latestValues)&&(m.transform=l?l({},""):"none",this.hasProjected=!1),m}const u=c.animationValues||c.latestValues;this.applyTransformsToTarget(),o.transform=tFe(this.projectionDeltaWithTransform,this.treeScale,u),l&&(o.transform=l(u,o.transform));const{x:d,y:h}=this.projectionDelta;o.transformOrigin=`${d.origin*100}% ${h.origin*100}% 0`,c.animationValues?o.opacity=c===this?u.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:u.opacityExit:o.opacity=c===this?u.opacity!==void 0?u.opacity:"":u.opacityExit!==void 0?u.opacityExit:0;for(const m in $w){if(u[m]===void 0)continue;const{correct:y,applyTo:b,isCSSVariable:v}=$w[m],x=o.transform==="none"?u[m]:y(u[m],c);if(b){const w=b.length;for(let S=0;S<w;S++)o[b[S]]=x}else v?this.options.visualElement.renderState.vars[m]=x:o[m]=x}return this.options.layoutId&&(o.pointerEvents=c===this?P2(a==null?void 0:a.pointerEvents)||"":"none"),o}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(a=>{var o;return(o=a.currentAnimation)==null?void 0:o.stop()}),this.root.nodes.forEach(wU),this.root.sharedNodes.clear()}}}function sFe(e){e.updateLayout()}function iFe(e){var n;const t=((n=e.resumeFrom)==null?void 0:n.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&t&&e.hasListeners("didUpdate")){const{layoutBox:r,measuredBox:s}=e.layout,{animationType:i}=e.options,a=t.source!==e.layout.source;i==="size"?Ll(d=>{const h=a?t.measuredBox[d]:t.layoutBox[d],m=eo(h);h.min=r[d].min,h.max=h.min+m}):tee(i,t.layoutBox,r)&&Ll(d=>{const h=a?t.measuredBox[d]:t.layoutBox[d],m=eo(r[d]);h.max=h.min+m,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[d].max=e.relativeTarget[d].min+m)});const o=k0();Mx(o,r,t.layoutBox);const l=k0();a?Mx(l,e.applyTransform(s,!0),t.measuredBox):Mx(l,r,t.layoutBox);const c=!XQ(o);let u=!1;if(!e.resumeFrom){const d=e.getClosestProjectingParent();if(d&&!d.resumeFrom){const{snapshot:h,layout:m}=d;if(h&&m){const y=gi();Ix(y,t.layoutBox,h.layoutBox);const b=gi();Ix(b,r,m.layoutBox),JQ(y,b)||(u=!0),d.options.layoutRoot&&(e.relativeTarget=b,e.relativeTargetOrigin=y,e.relativeParent=d)}}}e.notifyListeners("didUpdate",{layout:r,snapshot:t,delta:l,layoutDelta:o,hasLayoutChanged:c,hasRelativeLayoutChanged:u})}else if(e.isLead()){const{onExitComplete:r}=e.options;r&&r()}e.options.transition=void 0}function aFe(e){e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function oFe(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function lFe(e){e.clearSnapshot()}function wU(e){e.clearMeasurements()}function cFe(e){e.isLayoutDirty=!1}function uFe(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function _U(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function dFe(e){e.resolveTargetDelta()}function fFe(e){e.calcProjection()}function hFe(e){e.resetSkewAndRotation()}function pFe(e){e.removeLeadSnapshot()}function SU(e,t,n){e.translate=ti(t.translate,0,n),e.scale=ti(t.scale,1,n),e.origin=t.origin,e.originPoint=t.originPoint}function CU(e,t,n,r){e.min=ti(t.min,n.min,r),e.max=ti(t.max,n.max,r)}function mFe(e,t,n,r){CU(e.x,t.x,n.x,r),CU(e.y,t.y,n.y,r)}function gFe(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const yFe={duration:.45,ease:[.4,0,.1,1]},kU=e=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),EU=kU("applewebkit/")&&!kU("chrome/")?Math.round:Hl;function TU(e){e.min=EU(e.min),e.max=EU(e.max)}function bFe(e){TU(e.x),TU(e.y)}function tee(e,t,n){return e==="position"||e==="preserve-aspect"&&!v6e(bU(t),bU(n),.2)}function vFe(e){var t;return e!==e.root&&((t=e.scroll)==null?void 0:t.wasRoot)}const xFe=eee({attachResizeListener:(e,t)=>Hw(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),BI={current:void 0},nee=eee({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!BI.current){const e=new xFe({});e.mount(window),e.setOptions({layoutScroll:!0}),BI.current=e}return BI.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),wFe={pan:{Feature:F6e},drag:{Feature:D6e,ProjectionNode:nee,MeasureLayout:KQ}};function _Fe(e,t,n){if(e instanceof EventTarget)return[e];if(typeof e=="string"){let r=document;const s=(n==null?void 0:n[e])??r.querySelectorAll(e);return s?Array.from(s):[]}return Array.from(e)}function ree(e,t){const n=_Fe(e),r=new AbortController,s={passive:!0,...t,signal:r.signal};return[n,s,()=>r.abort()]}function AU(e){return!(e.pointerType==="touch"||GQ())}function SFe(e,t,n={}){const[r,s,i]=ree(e,n),a=o=>{if(!AU(o))return;const{target:l}=o,c=t(l,o);if(typeof c!="function"||!l)return;const u=d=>{AU(d)&&(c(d),l.removeEventListener("pointerleave",u))};l.addEventListener("pointerleave",u,s)};return r.forEach(o=>{o.addEventListener("pointerenter",a,s)}),i}function RU(e,t,n){const{props:r}=e;e.animationState&&r.whileHover&&e.animationState.setActive("whileHover",n==="Start");const s="onHover"+n,i=r[s];i&&ri.postRender(()=>i(t,X1(t)))}class CFe extends Jh{mount(){const{current:t}=this.node;t&&(this.unmount=SFe(t,(n,r)=>(RU(this.node,r,"Start"),s=>RU(this.node,s,"End"))))}unmount(){}}class kFe extends Jh{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Y1(Hw(this.node.current,"focus",()=>this.onFocus()),Hw(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}const see=(e,t)=>t?e===t?!0:see(e,t.parentElement):!1,EFe=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function TFe(e){return EFe.has(e.tagName)||e.tabIndex!==-1}const ax=new WeakSet;function NU(e){return t=>{t.key==="Enter"&&e(t)}}function $I(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}const AFe=(e,t)=>{const n=e.currentTarget;if(!n)return;const r=NU(()=>{if(ax.has(n))return;$I(n,"down");const s=NU(()=>{$I(n,"up")}),i=()=>$I(n,"cancel");n.addEventListener("keyup",s,t),n.addEventListener("blur",i,t)});n.addEventListener("keydown",r,t),n.addEventListener("blur",()=>n.removeEventListener("keydown",r),t)};function MU(e){return w6(e)&&!GQ()}function RFe(e,t,n={}){const[r,s,i]=ree(e,n),a=o=>{const l=o.currentTarget;if(!MU(o)||ax.has(l))return;ax.add(l);const c=t(l,o),u=(m,y)=>{window.removeEventListener("pointerup",d),window.removeEventListener("pointercancel",h),!(!MU(m)||!ax.has(l))&&(ax.delete(l),typeof c=="function"&&c(m,{success:y}))},d=m=>{u(m,l===window||l===document||n.useGlobalTarget||see(l,m.target))},h=m=>{u(m,!1)};window.addEventListener("pointerup",d,s),window.addEventListener("pointercancel",h,s)};return r.forEach(o=>{(n.useGlobalTarget?window:o).addEventListener("pointerdown",a,s),o instanceof HTMLElement&&(o.addEventListener("focus",c=>AFe(c,s)),!TFe(o)&&!o.hasAttribute("tabindex")&&(o.tabIndex=0))}),i}function IU(e,t,n){const{props:r}=e;if(e.current instanceof HTMLButtonElement&&e.current.disabled)return;e.animationState&&r.whileTap&&e.animationState.setActive("whileTap",n==="Start");const s="onTap"+(n==="End"?"":n),i=r[s];i&&ri.postRender(()=>i(t,X1(t)))}class NFe extends Jh{mount(){const{current:t}=this.node;t&&(this.unmount=RFe(t,(n,r)=>(IU(this.node,r,"Start"),(s,{success:i})=>IU(this.node,s,i?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const d4=new WeakMap,zI=new WeakMap,MFe=e=>{const t=d4.get(e.target);t&&t(e)},IFe=e=>{e.forEach(MFe)};function jFe({root:e,...t}){const n=e||document;zI.has(n)||zI.set(n,{});const r=zI.get(n),s=JSON.stringify(t);return r[s]||(r[s]=new IntersectionObserver(IFe,{root:e,...t})),r[s]}function OFe(e,t,n){const r=jFe(t);return d4.set(e,n),r.observe(e),()=>{d4.delete(e),r.unobserve(e)}}const PFe={some:0,all:1};class DFe extends Jh{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:n,margin:r,amount:s="some",once:i}=t,a={root:n?n.current:void 0,rootMargin:r,threshold:typeof s=="number"?s:PFe[s]},o=l=>{const{isIntersecting:c}=l;if(this.isInView===c||(this.isInView=c,i&&!c&&this.hasEnteredView))return;c&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",c);const{onViewportEnter:u,onViewportLeave:d}=this.node.getProps(),h=c?u:d;h&&h(l)};return OFe(this.node.current,a,o)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:n}=this.node;["amount","margin","root"].some(FFe(t,n))&&this.startObserver()}unmount(){}}function FFe({viewport:e={}},{viewport:t={}}={}){return n=>e[n]!==t[n]}const LFe={inView:{Feature:DFe},tap:{Feature:NFe},focus:{Feature:kFe},hover:{Feature:CFe}},BFe={layout:{ProjectionNode:nee,MeasureLayout:KQ}},f4={current:null},iee={current:!1};function $Fe(){if(iee.current=!0,!!WD)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>f4.current=e.matches;e.addListener(t),t()}else f4.current=!1}const zFe=new WeakMap;function UFe(e,t,n){for(const r in t){const s=t[r],i=n[r];if(La(s))e.addValue(r,s);else if(La(i))e.addValue(r,qw(s,{owner:e}));else if(i!==s)if(e.hasValue(r)){const a=e.getValue(r);a.liveStyle===!0?a.jump(s):a.hasAnimated||a.set(s)}else{const a=e.getStaticValue(r);e.addValue(r,qw(a!==void 0?a:s,{owner:e}))}}for(const r in n)t[r]===void 0&&e.removeValue(r);return t}const aee=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e),oee=e=>/^0[^.\s]+$/u.test(e),qFe={test:e=>e==="auto",parse:e=>e},lee=e=>t=>t.test(e),cee=[pb,or,Tu,eh,QOe,JOe,qFe],jU=e=>cee.find(lee(e)),VFe=[...cee,Oa,Ih],WFe=e=>VFe.find(lee(e)),HFe=new Set(["brightness","contrast","saturate","opacity"]);function GFe(e){const[t,n]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[r]=n.match(u6)||[];if(!r)return e;const s=n.replace(r,"");let i=HFe.has(t)?1:0;return r!==n&&(i*=100),t+"("+i+s+")"}const KFe=/\b([a-z-]*)\(.*?\)/gu,h4={...Ih,getAnimatableNone:e=>{const t=e.match(KFe);return t?t.map(GFe).join(" "):e}},YFe={...e6,color:Oa,backgroundColor:Oa,outlineColor:Oa,fill:Oa,stroke:Oa,borderColor:Oa,borderTopColor:Oa,borderRightColor:Oa,borderBottomColor:Oa,borderLeftColor:Oa,filter:h4,WebkitFilter:h4},uee=e=>YFe[e];function dee(e,t){let n=uee(e);return n!==h4&&(n=Ih),n.getAnimatableNone?n.getAnimatableNone(t):void 0}const OU=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class ZFe{scrapeMotionValuesFromProps(t,n,r){return{}}constructor({parent:t,props:n,presenceContext:r,reducedMotionConfig:s,blockInitialAnimation:i,visualState:a},o={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=b6,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const h=Ao.now();this.renderScheduledAt<h&&(this.renderScheduledAt=h,ri.render(this.render,!1,!0))};const{latestValues:l,renderState:c}=a;this.latestValues=l,this.baseTarget={...l},this.initialValues=n.initial?{...l}:{},this.renderState=c,this.parent=t,this.props=n,this.presenceContext=r,this.depth=t?t.depth+1:0,this.reducedMotionConfig=s,this.options=o,this.blockInitialAnimation=!!i,this.isControllingVariants=CT(n),this.isVariantNode=HJ(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:u,...d}=this.scrapeMotionValuesFromProps(n,{},this);for(const h in d){const m=d[h];l[h]!==void 0&&La(m)&&m.set(l[h],!1)}}mount(t){this.current=t,zFe.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((n,r)=>this.bindToMotionValue(r,n)),iee.current||$Fe(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:f4.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),Mh(this.notifyUpdate),Mh(this.render),this.valueSubscriptions.forEach(t=>t()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const t in this.events)this.events[t].clear();for(const t in this.features){const n=this.features[t];n&&(n.unmount(),n.isMounted=!1)}this.current=null}bindToMotionValue(t,n){this.valueSubscriptions.has(t)&&this.valueSubscriptions.get(t)();const r=hb.has(t);r&&this.onBindTransform&&this.onBindTransform();const s=n.on("change",o=>{this.latestValues[t]=o,this.props.onUpdate&&ri.preRender(this.notifyUpdate),r&&this.projection&&(this.projection.isTransformDirty=!0)}),i=n.on("renderRequest",this.scheduleRender);let a;window.MotionCheckAppearSync&&(a=window.MotionCheckAppearSync(this,t,n)),this.valueSubscriptions.set(t,()=>{s(),i(),a&&a(),n.owner&&n.stop()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}updateFeatures(){let t="animation";for(t in Cy){const n=Cy[t];if(!n)continue;const{isEnabled:r,Feature:s}=n;if(!this.features[t]&&s&&r(this.props)&&(this.features[t]=new s(this)),this.features[t]){const i=this.features[t];i.isMounted?i.update():(i.mount(),i.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):gi()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,n){this.latestValues[t]=n}update(t,n){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let r=0;r<OU.length;r++){const s=OU[r];this.propEventSubscriptions[s]&&(this.propEventSubscriptions[s](),delete this.propEventSubscriptions[s]);const i="on"+s,a=t[i];a&&(this.propEventSubscriptions[s]=this.on(s,a))}this.prevMotionValues=UFe(this,this.scrapeMotionValuesFromProps(t,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(t){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(t),()=>n.variantChildren.delete(t)}addValue(t,n){const r=this.values.get(t);n!==r&&(r&&this.removeValue(t),this.bindToMotionValue(t,n),this.values.set(t,n),this.latestValues[t]=n.get())}removeValue(t){this.values.delete(t);const n=this.valueSubscriptions.get(t);n&&(n(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,n){if(this.props.values&&this.props.values[t])return this.props.values[t];let r=this.values.get(t);return r===void 0&&n!==void 0&&(r=qw(n===null?void 0:n,{owner:this}),this.addValue(t,r)),r}readValue(t,n){let r=this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:this.getBaseTargetFromProps(this.props,t)??this.readValueFromInstance(this.current,t,this.options);return r!=null&&(typeof r=="string"&&(aee(r)||oee(r))?r=parseFloat(r):!WFe(r)&&Ih.test(n)&&(r=dee(t,n)),this.setBaseTarget(t,La(r)?r.get():r)),La(r)?r.get():r}setBaseTarget(t,n){this.baseTarget[t]=n}getBaseTarget(t){var i;const{initial:n}=this.props;let r;if(typeof n=="string"||typeof n=="object"){const a=s6(this.props,n,(i=this.presenceContext)==null?void 0:i.custom);a&&(r=a[t])}if(n&&r!==void 0)return r;const s=this.getBaseTargetFromProps(this.props,t);return s!==void 0&&!La(s)?s:this.initialValues[t]!==void 0&&r===void 0?void 0:this.baseTarget[t]}on(t,n){return this.events[t]||(this.events[t]=new l6),this.events[t].add(n)}notify(t,...n){this.events[t]&&this.events[t].notify(...n)}}const XFe=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function JFe(e){const t=XFe.exec(e);if(!t)return[,];const[,n,r,s]=t;return[`--${n??r}`,s]}function fee(e,t,n=1){const[r,s]=JFe(e);if(!r)return;const i=window.getComputedStyle(t).getPropertyValue(r);if(i){const a=i.trim();return aee(a)?parseFloat(a):a}return QD(s)?fee(s,t,n+1):s}function QFe(e){return typeof e=="number"?e===0:e!==null?e==="none"||e==="0"||oee(e):!0}const e5e=new Set(["auto","none","0"]);function t5e(e,t,n){let r=0,s;for(;r<e.length&&!s;){const i=e[r];typeof i=="string"&&!e5e.has(i)&&Vw(i).values.length&&(s=e[r]),r++}if(s&&n)for(const i of t)e[i]=dee(n,s)}class n5e extends b6{constructor(t,n,r,s,i){super(t,n,r,s,i,!0)}readKeyframes(){const{unresolvedKeyframes:t,element:n,name:r}=this;if(!n||!n.current)return;super.readKeyframes();for(let l=0;l<t.length;l++){let c=t[l];if(typeof c=="string"&&(c=c.trim(),QD(c))){const u=fee(c,n.current);u!==void 0&&(t[l]=u),l===t.length-1&&(this.finalKeyframe=c)}}if(this.resolveNoneKeyframes(),!OQ.has(r)||t.length!==2)return;const[s,i]=t,a=jU(s),o=jU(i);if(a!==o)if(L7(a)&&L7(o))for(let l=0;l<t.length;l++){const c=t[l];typeof c=="string"&&(t[l]=parseFloat(c))}else mm[r]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:t,name:n}=this,r=[];for(let s=0;s<t.length;s++)(t[s]===null||QFe(t[s]))&&r.push(s);r.length&&t5e(t,r,n)}measureInitialState(){const{element:t,unresolvedKeyframes:n,name:r}=this;if(!t||!t.current)return;r==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=mm[r](t.measureViewportBox(),window.getComputedStyle(t.current)),n[0]=this.measuredOrigin;const s=n[n.length-1];s!==void 0&&t.getValue(r,s).jump(s,!1)}measureEndState(){var o;const{element:t,name:n,unresolvedKeyframes:r}=this;if(!t||!t.current)return;const s=t.getValue(n);s&&s.jump(this.measuredOrigin,!1);const i=r.length-1,a=r[i];r[i]=mm[n](t.measureViewportBox(),window.getComputedStyle(t.current)),a!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=a),(o=this.removedTransforms)!=null&&o.length&&this.removedTransforms.forEach(([l,c])=>{t.getValue(l).set(c)}),this.resolveNoneKeyframes()}}class hee extends ZFe{constructor(){super(...arguments),this.KeyframeResolver=n5e}sortInstanceNodePosition(t,n){return t.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(t,n){return t.style?t.style[n]:void 0}removeValueFromRenderState(t,{vars:n,style:r}){delete n[t],delete r[t]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;La(t)&&(this.childSubscription=t.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}}function pee(e,{style:t,vars:n},r,s){Object.assign(e.style,t,s&&s.getProjectionStyles(r));for(const i in n)e.style.setProperty(i,n[i])}function r5e(e){return window.getComputedStyle(e)}class s5e extends hee{constructor(){super(...arguments),this.type="html",this.renderInstance=pee}readValueFromInstance(t,n){if(hb.has(n))return ADe(t,n);{const r=r5e(t),s=(JD(n)?r.getPropertyValue(n):r[n])||0;return typeof s=="string"?s.trim():s}}measureInstanceViewportBox(t,{transformPagePoint:n}){return qQ(t,n)}build(t,n,r){t6(t,n,r.transformTemplate)}scrapeMotionValuesFromProps(t,n,r){return i6(t,n,r)}}const mee=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function i5e(e,t,n,r){pee(e,t,void 0,r);for(const s in t.attrs)e.setAttribute(mee.has(s)?s:YD(s),t.attrs[s])}class a5e extends hee{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=gi}getBaseTargetFromProps(t,n){return t[n]}readValueFromInstance(t,n){if(hb.has(n)){const r=uee(n);return r&&r.default||0}return n=mee.has(n)?n:YD(n),t.getAttribute(n)}scrapeMotionValuesFromProps(t,n,r){return sQ(t,n,r)}build(t,n,r){eQ(t,n,this.isSVGTag,r.transformTemplate,r.style)}renderInstance(t,n,r,s){i5e(t,n,r,s)}mount(t){this.isSVGTag=nQ(t.tagName),super.mount(t)}}const o5e=(e,t)=>r6(e)?new a5e(t):new s5e(t,{allowProjection:e!==E.Fragment}),l5e=yPe({...d6e,...LFe,...wFe,...BFe},o5e),mu=FOe(l5e),P0=new WeakMap,L2=new WeakMap,vk={current:[]};let UI=!1,jx=0;const ox=new Set,QS=new Map;function gee(e){const t=Array.from(e).sort((n,r)=>n instanceof Ud&&n.options.deps.includes(r)?1:r instanceof Ud&&r.options.deps.includes(n)?-1:0);for(const n of t){if(vk.current.includes(n))continue;vk.current.push(n),n.recompute();const r=L2.get(n);if(r)for(const s of r){const i=P0.get(s);i&&gee(i)}}}function c5e(e){e.listeners.forEach(t=>t({prevVal:e.prevState,currentVal:e.state}))}function u5e(e){e.listeners.forEach(t=>t({prevVal:e.prevState,currentVal:e.state}))}function yee(e){if(jx>0&&!QS.has(e)&&QS.set(e,e.prevState),ox.add(e),!(jx>0)&&!UI)try{for(UI=!0;ox.size>0;){const t=Array.from(ox);ox.clear();for(const n of t){const r=QS.get(n)??n.prevState;n.prevState=r,c5e(n)}for(const n of t){const r=P0.get(n);r&&(vk.current.push(n),gee(r))}for(const n of t){const r=P0.get(n);if(r)for(const s of r)u5e(s)}}}finally{UI=!1,vk.current=[],QS.clear()}}function ou(e){jx++;try{e()}finally{if(jx--,jx===0){const t=Array.from(ox)[0];t&&yee(t)}}}function d5e(e){return typeof e=="function"}class p4{constructor(t,n){this.listeners=new Set,this.subscribe=r=>{var s,i;this.listeners.add(r);const a=(i=(s=this.options)==null?void 0:s.onSubscribe)==null?void 0:i.call(s,r,this);return()=>{this.listeners.delete(r),a==null||a()}},this.prevState=t,this.state=t,this.options=n}setState(t){var n,r,s;this.prevState=this.state,(n=this.options)!=null&&n.updateFn?this.state=this.options.updateFn(this.prevState)(t):d5e(t)?this.state=t(this.prevState):this.state=t,(s=(r=this.options)==null?void 0:r.onUpdate)==null||s.call(r),yee(this)}}class Ud{constructor(t){this.listeners=new Set,this._subscriptions=[],this.lastSeenDepValues=[],this.getDepVals=()=>{const n=[],r=[];for(const s of this.options.deps)n.push(s.prevState),r.push(s.state);return this.lastSeenDepValues=r,{prevDepVals:n,currDepVals:r,prevVal:this.prevState??void 0}},this.recompute=()=>{var n,r;this.prevState=this.state;const{prevDepVals:s,currDepVals:i,prevVal:a}=this.getDepVals();this.state=this.options.fn({prevDepVals:s,currDepVals:i,prevVal:a}),(r=(n=this.options).onUpdate)==null||r.call(n)},this.checkIfRecalculationNeededDeeply=()=>{for(const i of this.options.deps)i instanceof Ud&&i.checkIfRecalculationNeededDeeply();let n=!1;const r=this.lastSeenDepValues,{currDepVals:s}=this.getDepVals();for(let i=0;i<s.length;i++)if(s[i]!==r[i]){n=!0;break}n&&this.recompute()},this.mount=()=>(this.registerOnGraph(),this.checkIfRecalculationNeededDeeply(),()=>{this.unregisterFromGraph();for(const n of this._subscriptions)n()}),this.subscribe=n=>{var r,s;this.listeners.add(n);const i=(s=(r=this.options).onSubscribe)==null?void 0:s.call(r,n,this);return()=>{this.listeners.delete(n),i==null||i()}},this.options=t,this.state=t.fn({prevDepVals:void 0,prevVal:void 0,currDepVals:this.getDepVals().currDepVals})}registerOnGraph(t=this.options.deps){for(const n of t)if(n instanceof Ud)n.registerOnGraph(),this.registerOnGraph(n.options.deps);else if(n instanceof p4){let r=P0.get(n);r||(r=new Set,P0.set(n,r)),r.add(this);let s=L2.get(this);s||(s=new Set,L2.set(this,s)),s.add(n)}}unregisterFromGraph(t=this.options.deps){for(const n of t)if(n instanceof Ud)this.unregisterFromGraph(n.options.deps);else if(n instanceof p4){const r=P0.get(n);r&&r.delete(this);const s=L2.get(this);s&&s.delete(n)}}}function kT(e,t){return typeof e=="function"?e(t):e}function lx(e,t){return _6(t).reduce((r,s)=>{if(r===null)return null;if(typeof r<"u")return r[s]},e)}function e2(e,t,n){const r=_6(t);function s(i){if(!r.length)return kT(n,i);const a=r.shift();if(typeof a=="string"||typeof a=="number"&&!Array.isArray(i))return typeof i=="object"?(i===null&&(i={}),{...i,[a]:s(i[a])}):{[a]:s()};if(Array.isArray(i)&&typeof a=="number"){const o=i.slice(0,a);return[...o.length?o:new Array(a),s(i[a]),...i.slice(a+1)]}return[...new Array(a),s()]}return s(e)}function f5e(e,t){const n=_6(t);function r(s){if(!s)return;if(n.length===1){const a=n[0];if(Array.isArray(s)&&typeof a=="number")return s.filter((c,u)=>u!==a);const{[a]:o,...l}=s;return l}const i=n.shift();if(typeof i=="string"&&typeof s=="object")return{...s,[i]:r(s[i])};if(typeof i=="number"&&Array.isArray(s)){if(i>=s.length)return s;const a=s.slice(0,i);return[...a.length?a:new Array(i),r(s[i]),...s.slice(i+1)]}throw new Error("It seems we have created an infinite loop in deleteBy. ")}return r(e)}const h5e=/^(\d+)$/gm,p5e=/\.(\d+)(?=\.)/gm,m5e=/^(\d+)\./gm,g5e=/\.(\d+$)/gm,y5e=/\.{2,}/gm,m4="__int__",t2=`${m4}$1`;function _6(e){if(Array.isArray(e))return[...e];if(typeof e!="string")throw new Error("Path must be a string.");return e.replace(/(^\[)|]/gm,"").replace(/\[/g,".").replace(h5e,t2).replace(p5e,`.${t2}.`).replace(m5e,`${t2}.`).replace(g5e,`.${t2}`).replace(y5e,".").split(".").map(t=>t.indexOf(m4)===0?parseInt(t.substring(m4.length),10):t)}function b5e(e){return!(Array.isArray(e)&&e.length===0)}function g4(e,t){const{asyncDebounceMs:n}=t,{onChangeAsync:r,onBlurAsync:s,onSubmitAsync:i,onBlurAsyncDebounceMs:a,onChangeAsyncDebounceMs:o}=t.validators||{},l=n??0,c={cause:"change",validate:r,debounceMs:o??l},u={cause:"blur",validate:s,debounceMs:a??l},d={cause:"submit",validate:i,debounceMs:0},h=m=>({...m,debounceMs:0});switch(e){case"submit":return[h(c),h(u),d];case"blur":return[u];case"change":return[c];case"server":default:return[]}}function y4(e,t){const{onChange:n,onBlur:r,onSubmit:s,onMount:i}=t.validators||{},a={cause:"change",validate:n},o={cause:"blur",validate:r},l={cause:"submit",validate:s},c={cause:"mount",validate:i},u={cause:"server",validate:()=>{}};switch(e){case"mount":return[c];case"submit":return[a,o,l,u];case"server":return[u];case"blur":return[o,u];case"change":default:return[a,u]}}const b4=e=>!!e&&typeof e=="object"&&"fields"in e;function f0(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[s,i]of e)if(!t.has(s)||!Object.is(i,t.get(s)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const s of e)if(!t.has(s))return!1;return!0}const n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(const s of n)if(!r.includes(s)||!f0(e[s],t[s]))return!1;return!0}const PU=({newFormValidatorError:e,isPreviousErrorFromFormValidator:t,previousErrorValue:n})=>e?{newErrorValue:e,newSource:"form"}:t?{newErrorValue:void 0,newSource:void 0}:n?{newErrorValue:n,newSource:"field"}:{newErrorValue:void 0,newSource:void 0},DU=({formLevelError:e,fieldLevelError:t})=>t?{newErrorValue:t,newSource:"field"}:e?{newErrorValue:e,newSource:"form"}:{newErrorValue:void 0,newSource:void 0};function v5e(e){const t=new Map;for(const n of e){const r=[...n.path??[]].map(s=>{const i=typeof s=="object"?s.key:s;return typeof i=="number"?`[${i}]`:i}).join(".").replace(/\.\[/g,"[");t.set(r,(t.get(r)??[]).concat(n))}return Object.fromEntries(t)}const FU=e=>{const t=v5e(e);return{form:t,fields:t}},D0={validate({value:e,validationSource:t},n){const r=n["~standard"].validate(e);if(r instanceof Promise)throw new Error("async function passed to sync validator");if(r.issues)return t==="field"?r.issues:FU(r.issues)},async validateAsync({value:e,validationSource:t},n){const r=await n["~standard"].validate(e);if(r.issues)return t==="field"?r.issues:FU(r.issues)}},bee=e=>!!e&&"~standard"in e,xk={isValidating:!1,isTouched:!1,isBlurred:!1,isDirty:!1,isPristine:!0,isValid:!0,isDefaultValue:!0,errors:[],errorMap:{},errorSourceMap:{}};function n2(e){function t(d,h,m,y){const b=r(d,h,m,y);({insert:()=>o(b,d,h),remove:()=>l(b),swap:()=>y!==void 0&&u(b,d,h,y),move:()=>y!==void 0&&c(b,d,h,y)})[m]()}function n(d,h){return`${d}[${h}]`}function r(d,h,m,y){const b=[n(d,h)];if(m==="swap")b.push(n(d,y));else if(m==="move"){const[v,x]=[Math.min(h,y),Math.max(h,y)];for(let w=v;w<=x;w++)b.push(n(d,w))}else{const v=e.getFieldValue(d),x=Array.isArray(v)?v.length:0;for(let w=h+1;w<x;w++)b.push(n(d,w))}return Object.keys(e.fieldInfo).filter(v=>b.some(x=>v.startsWith(x)))}function s(d,h){return d.replace(/\[(\d+)\]/,(m,y)=>{const b=parseInt(y,10);return`[${h==="up"?b+1:Math.max(0,b-1)}]`})}function i(d,h){(h==="up"?d:[...d].reverse()).forEach(y=>{const b=s(y.toString(),h),v=e.getFieldMeta(b);v?e.setFieldMeta(y,v):e.setFieldMeta(y,a())})}const a=()=>xk,o=(d,h,m)=>{i(d,"down"),d.forEach(y=>{y.toString().startsWith(n(h,m))&&e.setFieldMeta(y,a())})},l=d=>{i(d,"up")},c=(d,h,m,y)=>{const b=new Map(Object.keys(e.fieldInfo).filter(v=>v.startsWith(n(h,m))).map(v=>[v,e.getFieldMeta(v)]));i(d,m<y?"up":"down"),Object.keys(e.fieldInfo).filter(v=>v.startsWith(n(h,y))).forEach(v=>{const x=v.replace(n(h,y),n(h,m)),w=b.get(x);w&&e.setFieldMeta(v,w)})},u=(d,h,m,y)=>{d.forEach(b=>{if(!b.toString().startsWith(n(h,m)))return;const v=b.toString().replace(n(h,m),n(h,y)),[x,w]=[e.getFieldMeta(b),e.getFieldMeta(v)];x&&e.setFieldMeta(v,x),w&&e.setFieldMeta(b,w)})};return{handleArrayFieldMetaShift:t}}function qI(e){return{values:e.values??{},errorMap:e.errorMap??{},fieldMetaBase:e.fieldMetaBase??{},isSubmitted:e.isSubmitted??!1,isSubmitting:e.isSubmitting??!1,isValidating:e.isValidating??!1,submissionAttempts:e.submissionAttempts??0,isSubmitSuccessful:e.isSubmitSuccessful??!1,validationMetaMap:e.validationMetaMap??{onChange:void 0,onBlur:void 0,onSubmit:void 0,onMount:void 0,onServer:void 0}}}class x5e{constructor(t){var n;this.options={},this.fieldInfo={},this.prevTransformArray=[],this.mount=()=>{var r,s;const i=this.fieldMetaDerived.mount(),a=this.store.mount(),o=()=>{i(),a()};(s=(r=this.options.listeners)==null?void 0:r.onMount)==null||s.call(r,{formApi:this});const{onMount:l}=this.options.validators||{};return l&&this.validateSync("mount"),o},this.update=r=>{var s,i;if(!r)return;const a=this.options;this.options=r;const o=!!((i=(s=r.transform)==null?void 0:s.deps)!=null&&i.some((u,d)=>u!==this.prevTransformArray[d])),l=r.defaultValues&&!f0(r.defaultValues,a.defaultValues)&&!this.state.isTouched,c=!f0(r.defaultState,a.defaultState)&&!this.state.isTouched;!l&&!c&&!o||ou(()=>{this.baseStore.setState(()=>qI(Object.assign({},this.state,c?r.defaultState:{},l?{values:r.defaultValues}:{},o?{_force_re_eval:!this.state._force_re_eval}:{})))})},this.reset=(r,s)=>{const{fieldMeta:i}=this.state,a=this.resetFieldMeta(i);r&&!(s!=null&&s.keepDefaultValues)&&(this.options={...this.options,defaultValues:r}),this.baseStore.setState(()=>{var o;return qI({...this.options.defaultState,values:r??this.options.defaultValues??((o=this.options.defaultState)==null?void 0:o.values),fieldMetaBase:a})})},this.validateAllFields=async r=>{const s=[];return ou(()=>{Object.values(this.fieldInfo).forEach(a=>{if(!a.instance)return;const o=a.instance;s.push(Promise.resolve().then(()=>o.validate(r,{skipFormValidation:!0}))),a.instance.state.meta.isTouched||a.instance.setMeta(l=>({...l,isTouched:!0}))})}),(await Promise.all(s)).flat()},this.validateArrayFieldsStartingFrom=async(r,s,i)=>{const a=this.getFieldValue(r),o=Array.isArray(a)?Math.max(a.length-1,0):null,l=[`${r}[${s}]`];for(let h=s+1;h<=(o??0);h++)l.push(`${r}[${h}]`);const c=Object.keys(this.fieldInfo).filter(h=>l.some(m=>h.startsWith(m))),u=[];return ou(()=>{c.forEach(h=>{u.push(Promise.resolve().then(()=>this.validateField(h,i)))})}),(await Promise.all(u)).flat()},this.validateField=(r,s)=>{var i;const a=(i=this.fieldInfo[r])==null?void 0:i.instance;return a?(a.state.meta.isTouched||a.setMeta(o=>({...o,isTouched:!0})),a.validate(s)):[]},this.validateSync=r=>{const s=y4(r,this.options);let i=!1;const a={};return ou(()=>{var o,l;for(const u of s){if(!u.validate)continue;const d=this.runValidator({validate:u.validate,value:{value:this.state.values,formApi:this,validationSource:"form"},type:"validate"}),{formError:h,fieldErrors:m}=B2(d),y=r2(u.cause);for(const b of Object.keys(this.state.fieldMeta)){const v=this.getFieldMeta(b);if(!v)continue;const{errorMap:x,errorSourceMap:w}=v,S=m==null?void 0:m[b],{newErrorValue:k,newSource:C}=PU({newFormValidatorError:S,isPreviousErrorFromFormValidator:(w==null?void 0:w[y])==="form",previousErrorValue:x==null?void 0:x[y]});C==="form"&&(a[b]={...a[b],[y]:S}),(x==null?void 0:x[y])!==k&&this.setFieldMeta(b,T=>({...T,errorMap:{...T.errorMap,[y]:k},errorSourceMap:{...T.errorSourceMap,[y]:C}}))}((o=this.state.errorMap)==null?void 0:o[y])!==h&&this.baseStore.setState(b=>({...b,errorMap:{...b.errorMap,[y]:h}})),(h||m)&&(i=!0)}const c=r2("submit");(l=this.state.errorMap)!=null&&l[c]&&r!=="submit"&&!i&&this.baseStore.setState(u=>({...u,errorMap:{...u.errorMap,[c]:void 0}}))}),{hasErrored:i,fieldsErrorMap:a}},this.validateAsync=async r=>{const s=g4(r,this.options);this.state.isFormValidating||this.baseStore.setState(c=>({...c,isFormValidating:!0}));const i=[];let a;for(const c of s){if(!c.validate)continue;const u=r2(c.cause),d=this.state.validationMetaMap[u];d==null||d.lastAbortController.abort();const h=new AbortController;this.state.validationMetaMap[u]={lastAbortController:h},i.push(new Promise(async m=>{let y;try{y=await new Promise((w,S)=>{setTimeout(async()=>{if(h.signal.aborted)return w(void 0);try{w(await this.runValidator({validate:c.validate,value:{value:this.state.values,formApi:this,validationSource:"form",signal:h.signal},type:"validateAsync"}))}catch(k){S(k)}},c.debounceMs)})}catch(w){y=w}const{formError:b,fieldErrors:v}=B2(y);v&&(a=a?{...a,...v}:v);const x=r2(c.cause);for(const w of Object.keys(this.state.fieldMeta)){const S=this.getFieldMeta(w);if(!S)continue;const{errorMap:k,errorSourceMap:C}=S,T=a==null?void 0:a[w],{newErrorValue:R,newSource:N}=PU({newFormValidatorError:T,isPreviousErrorFromFormValidator:(C==null?void 0:C[x])==="form",previousErrorValue:k==null?void 0:k[x]});(k==null?void 0:k[x])!==R&&this.setFieldMeta(w,I=>({...I,errorMap:{...I.errorMap,[x]:R},errorSourceMap:{...I.errorSourceMap,[x]:N}}))}this.baseStore.setState(w=>({...w,errorMap:{...w.errorMap,[x]:b}})),m(a?{fieldErrors:a,errorMapKey:x}:void 0)}))}let o=[];const l={};if(i.length){o=await Promise.all(i);for(const c of o)if(c!=null&&c.fieldErrors){const{errorMapKey:u}=c;for(const[d,h]of Object.entries(c.fieldErrors)){const y={...l[d]||{},[u]:h};l[d]=y}}}return this.baseStore.setState(c=>({...c,isFormValidating:!1})),l},this.validate=r=>{const{hasErrored:s,fieldsErrorMap:i}=this.validateSync(r);return s&&!this.options.asyncAlways?i:this.validateAsync(r)},this.getFieldValue=r=>lx(this.state.values,r),this.getFieldMeta=r=>this.state.fieldMeta[r],this.getFieldInfo=r=>{var s;return(s=this.fieldInfo)[r]||(s[r]={instance:null,validationMetaMap:{onChange:void 0,onBlur:void 0,onSubmit:void 0,onMount:void 0,onServer:void 0}})},this.setFieldMeta=(r,s)=>{this.baseStore.setState(i=>({...i,fieldMetaBase:{...i.fieldMetaBase,[r]:kT(s,i.fieldMetaBase[r])}}))},this.resetFieldMeta=r=>Object.keys(r).reduce((s,i)=>{const a=i;return s[a]=xk,s},{}),this.setFieldValue=(r,s,i)=>{const a=(i==null?void 0:i.dontUpdateMeta)??!1;ou(()=>{a||this.setFieldMeta(r,o=>({...o,isTouched:!0,isDirty:!0,errorMap:{...o==null?void 0:o.errorMap,onMount:void 0}})),this.baseStore.setState(o=>({...o,values:e2(o.values,r,s)}))})},this.deleteField=r=>{const i=[...Object.keys(this.fieldInfo).filter(a=>{const o=r.toString();return a!==o&&a.startsWith(o)}),r];this.baseStore.setState(a=>{const o={...a};return i.forEach(l=>{o.values=f5e(o.values,l),delete this.fieldInfo[l],delete o.fieldMetaBase[l]}),o})},this.pushFieldValue=(r,s,i)=>{this.setFieldValue(r,a=>[...Array.isArray(a)?a:[],s],i),this.validateField(r,"change")},this.insertFieldValue=async(r,s,i,a)=>{this.setFieldValue(r,o=>[...o.slice(0,s),i,...o.slice(s)],a),await this.validateField(r,"change"),n2(this).handleArrayFieldMetaShift(r,s,"insert"),await this.validateArrayFieldsStartingFrom(r,s,"change")},this.replaceFieldValue=async(r,s,i,a)=>{this.setFieldValue(r,o=>o.map((l,c)=>c===s?i:l),a),await this.validateField(r,"change"),await this.validateArrayFieldsStartingFrom(r,s,"change")},this.removeFieldValue=async(r,s,i)=>{const a=this.getFieldValue(r),o=Array.isArray(a)?Math.max(a.length-1,0):null;if(this.setFieldValue(r,l=>l.filter((c,u)=>u!==s),i),n2(this).handleArrayFieldMetaShift(r,s,"remove"),o!==null){const l=`${r}[${o}]`;this.deleteField(l)}await this.validateField(r,"change"),await this.validateArrayFieldsStartingFrom(r,s,"change")},this.swapFieldValues=(r,s,i,a)=>{this.setFieldValue(r,o=>{const l=o[s],c=o[i];return e2(e2(o,`${s}`,c),`${i}`,l)},a),n2(this).handleArrayFieldMetaShift(r,s,"swap",i),this.validateField(r,"change"),this.validateField(`${r}[${s}]`,"change"),this.validateField(`${r}[${i}]`,"change")},this.moveFieldValues=(r,s,i,a)=>{this.setFieldValue(r,o=>{const l=[...o];return l.splice(i,0,l.splice(s,1)[0]),l},a),n2(this).handleArrayFieldMetaShift(r,s,"move",i),this.validateField(r,"change"),this.validateField(`${r}[${s}]`,"change"),this.validateField(`${r}[${i}]`,"change")},this.clearFieldValues=(r,s)=>{const i=this.getFieldValue(r),a=Array.isArray(i)?Math.max(i.length-1,0):null;if(this.setFieldValue(r,[],s),a!==null)for(let o=0;o<=a;o++){const l=`${r}[${o}]`;this.deleteField(l)}this.validateField(r,"change")},this.resetField=r=>{this.baseStore.setState(s=>({...s,fieldMetaBase:{...s.fieldMetaBase,[r]:xk},values:this.options.defaultValues?e2(s.values,r,lx(this.options.defaultValues,r)):s.values}))},this.getAllErrors=()=>({form:{errors:this.state.errors,errorMap:this.state.errorMap},fields:Object.entries(this.state.fieldMeta).reduce((r,[s,i])=>(Object.keys(i).length&&i.errors.length&&(r[s]={errors:i.errors,errorMap:i.errorMap}),r),{})}),this.parseValuesWithSchema=r=>D0.validate({value:this.state.values,validationSource:"form"},r),this.parseValuesWithSchemaAsync=r=>D0.validateAsync({value:this.state.values,validationSource:"form"},r),this.baseStore=new p4(qI({...t==null?void 0:t.defaultState,values:(t==null?void 0:t.defaultValues)??((n=t==null?void 0:t.defaultState)==null?void 0:n.values)})),this.fieldMetaDerived=new Ud({deps:[this.baseStore],fn:({prevDepVals:r,currDepVals:s,prevVal:i})=>{var a,o,l;const c=i,u=r==null?void 0:r[0],d=s[0];let h=0;const m={};for(const y of Object.keys(d.fieldMetaBase)){const b=d.fieldMetaBase[y],v=u==null?void 0:u.fieldMetaBase[y],x=c==null?void 0:c[y],w=lx(d.values,y);let S=x==null?void 0:x.errors;if(!v||b.errorMap!==v.errorMap){S=Object.values(b.errorMap??{}).filter(N=>N!==void 0);const R=(a=this.getFieldInfo(y))==null?void 0:a.instance;R&&!R.options.disableErrorFlat&&(S=S==null?void 0:S.flat(1))}const k=!b5e(S??[]),C=!b.isDirty,T=f0(w,lx(this.options.defaultValues,y))||f0(w,(l=(o=this.getFieldInfo(y))==null?void 0:o.instance)==null?void 0:l.options.defaultValue);if(x&&x.isPristine===C&&x.isValid===k&&x.isDefaultValue===T&&x.errors===S&&b===v){m[y]=x,h++;continue}m[y]={...b,errors:S,isPristine:C,isValid:k,isDefaultValue:T}}return Object.keys(d.fieldMetaBase).length&&c&&h===Object.keys(d.fieldMetaBase).length?c:m}}),this.store=new Ud({deps:[this.baseStore,this.fieldMetaDerived],fn:({prevDepVals:r,currDepVals:s,prevVal:i})=>{var a,o,l,c;const u=i,d=r==null?void 0:r[0],h=s[0],m=s[1],y=Object.values(m).filter(Boolean),b=y.some(L=>L.isValidating),v=y.every(L=>L.isValid),x=y.some(L=>L.isTouched),w=y.some(L=>L.isBlurred),S=y.every(L=>L.isDefaultValue),k=x&&((a=h.errorMap)==null?void 0:a.onMount),C=y.some(L=>L.isDirty),T=!C,R=!!((o=h.errorMap)!=null&&o.onMount||y.some(L=>{var te;return(te=L==null?void 0:L.errorMap)==null?void 0:te.onMount})),N=!!b;let I=(u==null?void 0:u.errors)??[];(!d||h.errorMap!==d.errorMap)&&(I=Object.values(h.errorMap).reduce((L,te)=>te===void 0?L:te&&b4(te)?(L.push(te.form),L):(L.push(te),L),[]));const P=I.length===0,B=v&&P,D=this.options.canSubmitWhenInvalid??!1,W=h.submissionAttempts===0&&!x&&!R||!N&&!h.isSubmitting&&B||D;let O=h.errorMap;if(k&&(I=I.filter(L=>L!==h.errorMap.onMount),O=Object.assign(O,{onMount:void 0})),u&&d&&u.errorMap===O&&u.fieldMeta===this.fieldMetaDerived.state&&u.errors===I&&u.isFieldsValidating===b&&u.isFieldsValid===v&&u.isFormValid===P&&u.isValid===B&&u.canSubmit===W&&u.isTouched===x&&u.isBlurred===w&&u.isPristine===T&&u.isDefaultValue===S&&u.isDirty===C&&f0(d,h))return u;let Z={...h,errorMap:O,fieldMeta:this.fieldMetaDerived.state,errors:I,isFieldsValidating:b,isFieldsValid:v,isFormValid:P,isValid:B,canSubmit:W,isTouched:x,isBlurred:w,isPristine:T,isDefaultValue:S,isDirty:C};const U=((l=this.options.transform)==null?void 0:l.deps)??[];if(U.length!==this.prevTransformArray.length||U.some((L,te)=>L!==this.prevTransformArray[te])){const L=Object.assign({},this,{state:Z});(c=this.options.transform)==null||c.fn(L),Z=L.state,this.prevTransformArray=U}return Z}}),this.handleSubmit=this.handleSubmit.bind(this),this.update(t||{})}get state(){return this.store.state}runValidator(t){return bee(t.validate)?D0[t.type](t.value,t.validate):t.validate(t.value)}async handleSubmit(t){var n,r,s,i,a,o,l,c;if(this.baseStore.setState(d=>({...d,isSubmitted:!1,submissionAttempts:d.submissionAttempts+1,isSubmitSuccessful:!1})),ou(()=>{Object.values(this.fieldInfo).forEach(d=>{d.instance&&(d.instance.state.meta.isTouched||d.instance.setMeta(h=>({...h,isTouched:!0})))})}),!this.state.canSubmit)return;this.baseStore.setState(d=>({...d,isSubmitting:!0}));const u=()=>{this.baseStore.setState(d=>({...d,isSubmitting:!1}))};if(await this.validateAllFields("submit"),!this.state.isFieldsValid){u(),(r=(n=this.options).onSubmitInvalid)==null||r.call(n,{value:this.state.values,formApi:this});return}if(await this.validate("submit"),!this.state.isValid){u(),(i=(s=this.options).onSubmitInvalid)==null||i.call(s,{value:this.state.values,formApi:this});return}ou(()=>{Object.values(this.fieldInfo).forEach(d=>{var h,m,y;(y=(m=(h=d.instance)==null?void 0:h.options.listeners)==null?void 0:m.onSubmit)==null||y.call(m,{value:d.instance.state.value,fieldApi:d.instance})})}),(o=(a=this.options.listeners)==null?void 0:a.onSubmit)==null||o.call(a,{formApi:this});try{await((c=(l=this.options).onSubmit)==null?void 0:c.call(l,{value:this.state.values,formApi:this,meta:t??this.options.onSubmitMeta})),ou(()=>{this.baseStore.setState(d=>({...d,isSubmitted:!0,isSubmitSuccessful:!0})),u()})}catch(d){throw this.baseStore.setState(h=>({...h,isSubmitSuccessful:!1})),u(),d}}setErrorMap(t){ou(()=>{Object.entries(t).forEach(([n,r])=>{const s=n;if(b4(r)){const{formError:i,fieldErrors:a}=B2(r);for(const o of Object.keys(this.fieldInfo))this.getFieldMeta(o)&&this.setFieldMeta(o,c=>({...c,errorMap:{...c.errorMap,[s]:a==null?void 0:a[o]},errorSourceMap:{...c.errorSourceMap,[s]:"form"}}));this.baseStore.setState(o=>({...o,errorMap:{...o.errorMap,[s]:i}}))}else this.baseStore.setState(i=>({...i,errorMap:{...i.errorMap,[s]:r}}))})})}}function B2(e){if(e){if(b4(e)){const t=B2(e.form).formError,n=e.fields;return{formError:t,fieldErrors:n}}return{formError:e}}return{formError:void 0}}function r2(e){switch(e){case"submit":return"onSubmit";case"blur":return"onBlur";case"mount":return"onMount";case"server":return"onServer";case"change":default:return"onChange"}}class w5e{constructor(t){this.options={},this.mount=()=>{var n,r;const s=this.store.mount();this.options.defaultValue!==void 0&&this.form.setFieldValue(this.name,this.options.defaultValue,{dontUpdateMeta:!0});const i=this.getInfo();i.instance=this,this.update(this.options);const{onMount:a}=this.options.validators||{};if(a){const o=this.runValidator({validate:a,value:{value:this.state.value,fieldApi:this,validationSource:"field"},type:"validate"});o&&this.setMeta(l=>({...l,errorMap:{...l==null?void 0:l.errorMap,onMount:o},errorSourceMap:{...l==null?void 0:l.errorSourceMap,onMount:"field"}}))}return(r=(n=this.options.listeners)==null?void 0:n.onMount)==null||r.call(n,{value:this.state.value,fieldApi:this}),s},this.update=n=>{this.options=n;const r=this.name!==n.name;if(this.name=n.name,this.state.value===void 0){const s=lx(n.form.options.defaultValues,n.name),i=n.defaultValue??s;r?this.setValue(a=>a||i,{dontUpdateMeta:!0}):i!==void 0&&this.setValue(i,{dontUpdateMeta:!0})}this.form.getFieldMeta(this.name)===void 0&&this.setMeta(this.state.meta)},this.getValue=()=>this.form.getFieldValue(this.name),this.setValue=(n,r)=>{this.form.setFieldValue(this.name,n,r),this.triggerOnChangeListener(),this.validate("change")},this.getMeta=()=>this.store.state.meta,this.setMeta=n=>this.form.setFieldMeta(this.name,n),this.getInfo=()=>this.form.getFieldInfo(this.name),this.pushValue=(n,r)=>{this.form.pushFieldValue(this.name,n,r),this.triggerOnChangeListener()},this.insertValue=(n,r,s)=>{this.form.insertFieldValue(this.name,n,r,s),this.triggerOnChangeListener()},this.replaceValue=(n,r,s)=>{this.form.replaceFieldValue(this.name,n,r,s),this.triggerOnChangeListener()},this.removeValue=(n,r)=>{this.form.removeFieldValue(this.name,n,r),this.triggerOnChangeListener()},this.swapValues=(n,r,s)=>{this.form.swapFieldValues(this.name,n,r,s),this.triggerOnChangeListener()},this.moveValue=(n,r,s)=>{this.form.moveFieldValues(this.name,n,r,s),this.triggerOnChangeListener()},this.clearValues=n=>{this.form.clearFieldValues(this.name,n),this.triggerOnChangeListener()},this.getLinkedFields=n=>{const r=Object.values(this.form.fieldInfo),s=[];for(const i of r){if(!i.instance)continue;const{onChangeListenTo:a,onBlurListenTo:o}=i.instance.options.validators||{};n==="change"&&(a!=null&&a.includes(this.name))&&s.push(i.instance),n==="blur"&&(o!=null&&o.includes(this.name))&&s.push(i.instance)}return s},this.validateSync=(n,r)=>{var s;const i=y4(n,this.options),o=this.getLinkedFields(n).reduce((u,d)=>{const h=y4(n,d.options);return h.forEach(m=>{m.field=d}),u.concat(h)},[]);let l=!1;ou(()=>{const u=(d,h)=>{var m;const y=s2(h.cause),b=h.validate?LU(d.runValidator({validate:h.validate,value:{value:d.store.state.value,validationSource:"field",fieldApi:d},type:"validate"})):void 0,v=r[y],{newErrorValue:x,newSource:w}=DU({formLevelError:v,fieldLevelError:b});((m=d.state.meta.errorMap)==null?void 0:m[y])!==x&&d.setMeta(S=>({...S,errorMap:{...S.errorMap,[y]:x},errorSourceMap:{...S.errorSourceMap,[y]:w}})),x&&(l=!0)};for(const d of i)u(this,d);for(const d of o)d.validate&&u(d.field,d)});const c=s2("submit");return(s=this.state.meta.errorMap)!=null&&s[c]&&n!=="submit"&&!l&&this.setMeta(u=>({...u,errorMap:{...u.errorMap,[c]:void 0},errorSourceMap:{...u.errorSourceMap,[c]:void 0}})),{hasErrored:l}},this.validateAsync=async(n,r)=>{const s=g4(n,this.options),i=await r,a=this.getLinkedFields(n),o=a.reduce((h,m)=>{const y=g4(n,m.options);return y.forEach(b=>{b.field=m}),h.concat(y)},[]);this.state.meta.isValidating||this.setMeta(h=>({...h,isValidating:!0}));for(const h of a)h.setMeta(m=>({...m,isValidating:!0}));const l=[],c=[],u=(h,m,y)=>{const b=s2(m.cause),v=h.getInfo().validationMetaMap[b];v==null||v.lastAbortController.abort();const x=new AbortController;this.getInfo().validationMetaMap[b]={lastAbortController:x},y.push(new Promise(async w=>{var S;let k;try{k=await new Promise((I,P)=>{this.timeoutIds.validations[m.cause]&&clearTimeout(this.timeoutIds.validations[m.cause]),this.timeoutIds.validations[m.cause]=setTimeout(async()=>{if(x.signal.aborted)return I(void 0);try{I(await this.runValidator({validate:m.validate,value:{value:h.store.state.value,fieldApi:h,signal:x.signal,validationSource:"field"},type:"validateAsync"}))}catch(B){P(B)}},m.debounceMs)})}catch(I){k=I}if(x.signal.aborted)return w(void 0);const C=LU(k),T=(S=i[this.name])==null?void 0:S[b],{newErrorValue:R,newSource:N}=DU({formLevelError:T,fieldLevelError:C});h.setMeta(I=>({...I,errorMap:{...I==null?void 0:I.errorMap,[b]:R},errorSourceMap:{...I.errorSourceMap,[b]:N}})),w(R)}))};for(const h of s)h.validate&&u(this,h,l);for(const h of o)h.validate&&u(h.field,h,c);let d=[];(l.length||c.length)&&(d=await Promise.all(l),await Promise.all(c)),this.setMeta(h=>({...h,isValidating:!1}));for(const h of a)h.setMeta(m=>({...m,isValidating:!1}));return d.filter(Boolean)},this.validate=(n,r)=>{var s;if(!this.state.meta.isTouched)return[];const{fieldsErrorMap:i}=r!=null&&r.skipFormValidation?{fieldsErrorMap:{}}:this.form.validateSync(n),{hasErrored:a}=this.validateSync(n,i[this.name]??{});if(a&&!this.options.asyncAlways)return(s=this.getInfo().validationMetaMap[s2(n)])==null||s.lastAbortController.abort(),this.state.meta.errors;const o=r!=null&&r.skipFormValidation?Promise.resolve({}):this.form.validateAsync(n);return this.validateAsync(n,o)},this.handleChange=n=>{this.setValue(n)},this.handleBlur=()=>{this.state.meta.isTouched||(this.setMeta(r=>({...r,isTouched:!0})),this.validate("change")),this.state.meta.isBlurred||this.setMeta(r=>({...r,isBlurred:!0})),this.validate("blur"),this.triggerOnBlurListener()},this.parseValueWithSchema=n=>D0.validate({value:this.state.value,validationSource:"field"},n),this.parseValueWithSchemaAsync=n=>D0.validateAsync({value:this.state.value,validationSource:"field"},n),this.form=t.form,this.name=t.name,this.timeoutIds={validations:{},listeners:{},formListeners:{}},this.store=new Ud({deps:[this.form.store],fn:()=>{const n=this.form.getFieldValue(this.name),r=this.form.getFieldMeta(this.name)??{...xk,...t.defaultMeta};return{value:n,meta:r}}}),this.options=t}get state(){return this.store.state}runValidator(t){return bee(t.validate)?D0[t.type](t.value,t.validate):t.validate(t.value)}setErrorMap(t){this.setMeta(n=>({...n,errorMap:{...n.errorMap,...t}}))}triggerOnBlurListener(){var t,n,r,s,i,a;const o=(t=this.form.options.listeners)==null?void 0:t.onBlurDebounceMs;o&&o>0?(this.timeoutIds.formListeners.blur&&clearTimeout(this.timeoutIds.formListeners.blur),this.timeoutIds.formListeners.blur=setTimeout(()=>{var c,u;(u=(c=this.form.options.listeners)==null?void 0:c.onBlur)==null||u.call(c,{formApi:this.form,fieldApi:this})},o)):(r=(n=this.form.options.listeners)==null?void 0:n.onBlur)==null||r.call(n,{formApi:this.form,fieldApi:this});const l=(s=this.options.listeners)==null?void 0:s.onBlurDebounceMs;l&&l>0?(this.timeoutIds.listeners.blur&&clearTimeout(this.timeoutIds.listeners.blur),this.timeoutIds.listeners.blur=setTimeout(()=>{var c,u;(u=(c=this.options.listeners)==null?void 0:c.onBlur)==null||u.call(c,{value:this.state.value,fieldApi:this})},l)):(a=(i=this.options.listeners)==null?void 0:i.onBlur)==null||a.call(i,{value:this.state.value,fieldApi:this})}triggerOnChangeListener(){var t,n,r,s,i,a;const o=(t=this.form.options.listeners)==null?void 0:t.onChangeDebounceMs;o&&o>0?(this.timeoutIds.formListeners.blur&&clearTimeout(this.timeoutIds.formListeners.blur),this.timeoutIds.formListeners.blur=setTimeout(()=>{var c,u;(u=(c=this.form.options.listeners)==null?void 0:c.onChange)==null||u.call(c,{formApi:this.form,fieldApi:this})},o)):(r=(n=this.form.options.listeners)==null?void 0:n.onChange)==null||r.call(n,{formApi:this.form,fieldApi:this});const l=(s=this.options.listeners)==null?void 0:s.onChangeDebounceMs;l&&l>0?(this.timeoutIds.listeners.change&&clearTimeout(this.timeoutIds.listeners.change),this.timeoutIds.listeners.change=setTimeout(()=>{var c,u;(u=(c=this.options.listeners)==null?void 0:c.onChange)==null||u.call(c,{value:this.state.value,fieldApi:this})},l)):(a=(i=this.options.listeners)==null?void 0:i.onChange)==null||a.call(i,{value:this.state.value,fieldApi:this})}}function LU(e){if(e)return e}function s2(e){switch(e){case"submit":return"onSubmit";case"blur":return"onBlur";case"mount":return"onMount";case"server":return"onServer";case"change":default:return"onChange"}}var VI={exports:{}},WI={},HI={exports:{}},GI={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var BU;function _5e(){if(BU)return GI;BU=1;var e=By();function t(d,h){return d===h&&(d!==0||1/d===1/h)||d!==d&&h!==h}var n=typeof Object.is=="function"?Object.is:t,r=e.useState,s=e.useEffect,i=e.useLayoutEffect,a=e.useDebugValue;function o(d,h){var m=h(),y=r({inst:{value:m,getSnapshot:h}}),b=y[0].inst,v=y[1];return i(function(){b.value=m,b.getSnapshot=h,l(b)&&v({inst:b})},[d,m,h]),s(function(){return l(b)&&v({inst:b}),d(function(){l(b)&&v({inst:b})})},[d]),a(m),m}function l(d){var h=d.getSnapshot;d=d.value;try{var m=h();return!n(d,m)}catch{return!0}}function c(d,h){return h()}var u=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?c:o;return GI.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:u,GI}var $U;function S5e(){return $U||($U=1,HI.exports=_5e()),HI.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zU;function C5e(){if(zU)return WI;zU=1;var e=By(),t=S5e();function n(c,u){return c===u&&(c!==0||1/c===1/u)||c!==c&&u!==u}var r=typeof Object.is=="function"?Object.is:n,s=t.useSyncExternalStore,i=e.useRef,a=e.useEffect,o=e.useMemo,l=e.useDebugValue;return WI.useSyncExternalStoreWithSelector=function(c,u,d,h,m){var y=i(null);if(y.current===null){var b={hasValue:!1,value:null};y.current=b}else b=y.current;y=o(function(){function x(T){if(!w){if(w=!0,S=T,T=h(T),m!==void 0&&b.hasValue){var R=b.value;if(m(R,T))return k=R}return k=T}if(R=k,r(S,T))return R;var N=h(T);return m!==void 0&&m(R,N)?(S=T,R):(S=T,k=N)}var w=!1,S,k,C=d===void 0?null:d;return[function(){return x(u())},C===null?void 0:function(){return x(C())}]},[u,d,h,m]);var v=s(c,y[0],y[1]);return a(function(){b.hasValue=!0,b.value=v},[v]),l(v),v},WI}var UU;function k5e(){return UU||(UU=1,VI.exports=C5e()),VI.exports}var E5e=k5e();function S6(e,t=n=>n){return E5e.useSyncExternalStoreWithSelector(e.subscribe,()=>e.state,()=>e.state,t,T5e)}function T5e(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[r,s]of e)if(!t.has(r)||!Object.is(s,t.get(r)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const r of e)if(!t.has(r))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(let r=0;r<n.length;r++)if(!Object.prototype.hasOwnProperty.call(t,n[r])||!Object.is(e[n[r]],t[n[r]]))return!1;return!0}const wk=typeof window<"u"?E.useLayoutEffect:E.useEffect;function A5e(e){const[t]=E.useState(()=>{const r=new w5e({...e,form:e.form,name:e.name});return r.Field=vee,r});return wk(t.mount,[t]),wk(()=>{t.update(e)}),S6(t.store,e.mode==="array"?n=>[n.meta,Object.keys(n.value??[]).length]:void 0),t}const vee=({children:e,...t})=>{const n=A5e(t),r=E.useMemo(()=>kT(e,n),[e,n,n.state.value,n.state.meta]);return f.jsx(f.Fragment,{children:r})};function R5e({form:e,selector:t,children:n}){const r=S6(e.store,t);return kT(n,r)}function ii(e){const[t]=E.useState(()=>{const n=new x5e(e),r=n;return r.Field=function(i){return f.jsx(vee,{...i,form:n})},r.Subscribe=s=>f.jsx(R5e,{form:n,selector:s.selector,children:s.children}),r});return wk(t.mount,[]),S6(t.store,n=>n.isSubmitting),wk(()=>{t.update(e)}),t}function Cn({className:e,type:t,...n}){return f.jsx("input",{type:t,"data-slot":"input",className:Xe("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",e),...n})}function N5e(e){const t=e+"CollectionProvider",[n,r]=Ki(t),[s,i]=n(t,{collectionRef:{current:null},itemMap:new Map}),a=b=>{const{scope:v,children:x}=b,w=Ve.useRef(null),S=Ve.useRef(new Map).current;return f.jsx(s,{scope:v,itemMap:S,collectionRef:w,children:x})};a.displayName=t;const o=e+"CollectionSlot",l=Mu(o),c=Ve.forwardRef((b,v)=>{const{scope:x,children:w}=b,S=i(o,x),k=Mn(v,S.collectionRef);return f.jsx(l,{ref:k,children:w})});c.displayName=o;const u=e+"CollectionItemSlot",d="data-radix-collection-item",h=Mu(u),m=Ve.forwardRef((b,v)=>{const{scope:x,children:w,...S}=b,k=Ve.useRef(null),C=Mn(v,k),T=i(u,x);return Ve.useEffect(()=>(T.itemMap.set(k,{ref:k,...S}),()=>void T.itemMap.delete(k))),f.jsx(h,{[d]:"",ref:C,children:w})});m.displayName=u;function y(b){const v=i(e+"CollectionConsumer",b);return Ve.useCallback(()=>{const w=v.collectionRef.current;if(!w)return[];const S=Array.from(w.querySelectorAll(`[${d}]`));return Array.from(v.itemMap.values()).sort((T,R)=>S.indexOf(T.ref.current)-S.indexOf(R.ref.current))},[v.collectionRef,v.itemMap])}return[{Provider:a,Slot:c,ItemSlot:m},y,r]}var M5e=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],_i=M5e.reduce((e,t)=>{const n=Mu(`Primitive.${t}`),r=E.forwardRef((s,i)=>{const{asChild:a,...o}=s,l=a?n:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),f.jsx(l,{...o,ref:i})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{});function I5e(e,t){e&&cl.flushSync(()=>e.dispatchEvent(t))}var j5e="DismissableLayer",v4="dismissableLayer.update",O5e="dismissableLayer.pointerDownOutside",P5e="dismissableLayer.focusOutside",qU,xee=E.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),wee=E.forwardRef((e,t)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:s,onFocusOutside:i,onInteractOutside:a,onDismiss:o,...l}=e,c=E.useContext(xee),[u,d]=E.useState(null),h=(u==null?void 0:u.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,m]=E.useState({}),y=Mn(t,R=>d(R)),b=Array.from(c.layers),[v]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),x=b.indexOf(v),w=u?b.indexOf(u):-1,S=c.layersWithOutsidePointerEventsDisabled.size>0,k=w>=x,C=L5e(R=>{const N=R.target,I=[...c.branches].some(P=>P.contains(N));!k||I||(s==null||s(R),a==null||a(R),R.defaultPrevented||o==null||o())},h),T=B5e(R=>{const N=R.target;[...c.branches].some(P=>P.contains(N))||(i==null||i(R),a==null||a(R),R.defaultPrevented||o==null||o())},h);return iP(R=>{w===c.layers.size-1&&(r==null||r(R),!R.defaultPrevented&&o&&(R.preventDefault(),o()))},h),E.useEffect(()=>{if(u)return n&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(qU=h.body.style.pointerEvents,h.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(u)),c.layers.add(u),VU(),()=>{n&&c.layersWithOutsidePointerEventsDisabled.size===1&&(h.body.style.pointerEvents=qU)}},[u,h,n,c]),E.useEffect(()=>()=>{u&&(c.layers.delete(u),c.layersWithOutsidePointerEventsDisabled.delete(u),VU())},[u,c]),E.useEffect(()=>{const R=()=>m({});return document.addEventListener(v4,R),()=>document.removeEventListener(v4,R)},[]),f.jsx(_i.div,{...l,ref:y,style:{pointerEvents:S?k?"auto":"none":void 0,...e.style},onFocusCapture:Wt(e.onFocusCapture,T.onFocusCapture),onBlurCapture:Wt(e.onBlurCapture,T.onBlurCapture),onPointerDownCapture:Wt(e.onPointerDownCapture,C.onPointerDownCapture)})});wee.displayName=j5e;var D5e="DismissableLayerBranch",F5e=E.forwardRef((e,t)=>{const n=E.useContext(xee),r=E.useRef(null),s=Mn(t,r);return E.useEffect(()=>{const i=r.current;if(i)return n.branches.add(i),()=>{n.branches.delete(i)}},[n.branches]),f.jsx(_i.div,{...e,ref:s})});F5e.displayName=D5e;function L5e(e,t=globalThis==null?void 0:globalThis.document){const n=Es(e),r=E.useRef(!1),s=E.useRef(()=>{});return E.useEffect(()=>{const i=o=>{if(o.target&&!r.current){let l=function(){_ee(O5e,n,c,{discrete:!0})};const c={originalEvent:o};o.pointerType==="touch"?(t.removeEventListener("click",s.current),s.current=l,t.addEventListener("click",s.current,{once:!0})):l()}else t.removeEventListener("click",s.current);r.current=!1},a=window.setTimeout(()=>{t.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(a),t.removeEventListener("pointerdown",i),t.removeEventListener("click",s.current)}},[t,n]),{onPointerDownCapture:()=>r.current=!0}}function B5e(e,t=globalThis==null?void 0:globalThis.document){const n=Es(e),r=E.useRef(!1);return E.useEffect(()=>{const s=i=>{i.target&&!r.current&&_ee(P5e,n,{originalEvent:i},{discrete:!1})};return t.addEventListener("focusin",s),()=>t.removeEventListener("focusin",s)},[t,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function VU(){const e=new CustomEvent(v4);document.dispatchEvent(e)}function _ee(e,t,n,{discrete:r}){const s=n.originalEvent.target,i=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&s.addEventListener(e,t,{once:!0}),r?I5e(s,i):s.dispatchEvent(i)}var KI=0;function ET(){E.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??WU()),document.body.insertAdjacentElement("beforeend",e[1]??WU()),KI++,()=>{KI===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),KI--}},[])}function WU(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var YI="focusScope.autoFocusOnMount",ZI="focusScope.autoFocusOnUnmount",HU={bubbles:!1,cancelable:!0},$5e="FocusScope",See=E.forwardRef((e,t)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:s,onUnmountAutoFocus:i,...a}=e,[o,l]=E.useState(null),c=Es(s),u=Es(i),d=E.useRef(null),h=Mn(t,b=>l(b)),m=E.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;E.useEffect(()=>{if(r){let b=function(S){if(m.paused||!o)return;const k=S.target;o.contains(k)?d.current=k:th(d.current,{select:!0})},v=function(S){if(m.paused||!o)return;const k=S.relatedTarget;k!==null&&(o.contains(k)||th(d.current,{select:!0}))},x=function(S){if(document.activeElement===document.body)for(const C of S)C.removedNodes.length>0&&th(o)};document.addEventListener("focusin",b),document.addEventListener("focusout",v);const w=new MutationObserver(x);return o&&w.observe(o,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",b),document.removeEventListener("focusout",v),w.disconnect()}}},[r,o,m.paused]),E.useEffect(()=>{if(o){KU.add(m);const b=document.activeElement;if(!o.contains(b)){const x=new CustomEvent(YI,HU);o.addEventListener(YI,c),o.dispatchEvent(x),x.defaultPrevented||(z5e(H5e(Cee(o)),{select:!0}),document.activeElement===b&&th(o))}return()=>{o.removeEventListener(YI,c),setTimeout(()=>{const x=new CustomEvent(ZI,HU);o.addEventListener(ZI,u),o.dispatchEvent(x),x.defaultPrevented||th(b??document.body,{select:!0}),o.removeEventListener(ZI,u),KU.remove(m)},0)}}},[o,c,u,m]);const y=E.useCallback(b=>{if(!n&&!r||m.paused)return;const v=b.key==="Tab"&&!b.altKey&&!b.ctrlKey&&!b.metaKey,x=document.activeElement;if(v&&x){const w=b.currentTarget,[S,k]=U5e(w);S&&k?!b.shiftKey&&x===k?(b.preventDefault(),n&&th(S,{select:!0})):b.shiftKey&&x===S&&(b.preventDefault(),n&&th(k,{select:!0})):x===w&&b.preventDefault()}},[n,r,m.paused]);return f.jsx(_i.div,{tabIndex:-1,...a,ref:h,onKeyDown:y})});See.displayName=$5e;function z5e(e,{select:t=!1}={}){const n=document.activeElement;for(const r of e)if(th(r,{select:t}),document.activeElement!==n)return}function U5e(e){const t=Cee(e),n=GU(t,e),r=GU(t.reverse(),e);return[n,r]}function Cee(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const s=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||s?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function GU(e,t){for(const n of e)if(!q5e(n,{upTo:t}))return n}function q5e(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function V5e(e){return e instanceof HTMLInputElement&&"select"in e}function th(e,{select:t=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&V5e(e)&&t&&e.select()}}var KU=W5e();function W5e(){let e=[];return{add(t){const n=e[0];t!==n&&(n==null||n.pause()),e=YU(e,t),e.unshift(t)},remove(t){var n;e=YU(e,t),(n=e[0])==null||n.resume()}}}function YU(e,t){const n=[...e],r=n.indexOf(t);return r!==-1&&n.splice(r,1),n}function H5e(e){return e.filter(t=>t.tagName!=="A")}var G5e="Arrow",kee=E.forwardRef((e,t)=>{const{children:n,width:r=10,height:s=5,...i}=e;return f.jsx(_i.svg,{...i,ref:t,width:r,height:s,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?n:f.jsx("polygon",{points:"0,0 30,0 15,10"})})});kee.displayName=G5e;var K5e=kee,C6="Popper",[Eee,Tee]=Ki(C6),[Y5e,Aee]=Eee(C6),Ree=e=>{const{__scopePopper:t,children:n}=e,[r,s]=E.useState(null);return f.jsx(Y5e,{scope:t,anchor:r,onAnchorChange:s,children:n})};Ree.displayName=C6;var Nee="PopperAnchor",Mee=E.forwardRef((e,t)=>{const{__scopePopper:n,virtualRef:r,...s}=e,i=Aee(Nee,n),a=E.useRef(null),o=Mn(t,a);return E.useEffect(()=>{i.onAnchorChange((r==null?void 0:r.current)||a.current)}),r?null:f.jsx(_i.div,{...s,ref:o})});Mee.displayName=Nee;var k6="PopperContent",[Z5e,X5e]=Eee(k6),Iee=E.forwardRef((e,t)=>{var Fe,Se,Ce,qe,Qe,We;const{__scopePopper:n,side:r="bottom",sideOffset:s=0,align:i="center",alignOffset:a=0,arrowPadding:o=0,avoidCollisions:l=!0,collisionBoundary:c=[],collisionPadding:u=0,sticky:d="partial",hideWhenDetached:h=!1,updatePositionStrategy:m="optimized",onPlaced:y,...b}=e,v=Aee(k6,n),[x,w]=E.useState(null),S=Mn(t,Ie=>w(Ie)),[k,C]=E.useState(null),T=Ky(k),R=(T==null?void 0:T.width)??0,N=(T==null?void 0:T.height)??0,I=r+(i!=="center"?"-"+i:""),P=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},B=Array.isArray(c)?c:[c],D=B.length>0,W={padding:P,boundary:B.filter(Q5e),altBoundary:D},{refs:O,floatingStyles:Z,placement:U,isPositioned:H,middlewareData:L}=pP({strategy:"fixed",placement:I,whileElementsMounted:(...Ie)=>hP(...Ie,{animationFrame:m==="always"}),elements:{reference:v.anchor},middleware:[mP({mainAxis:s+N,alignmentAxis:a}),l&&gP({mainAxis:!0,crossAxis:!1,limiter:d==="partial"?yP():void 0,...W}),l&&bP({...W}),vP({...W,apply:({elements:Ie,rects:K,availableWidth:ye,availableHeight:Ne})=>{const{width:ce,height:oe}=K.reference,re=Ie.floating.style;re.setProperty("--radix-popper-available-width",`${ye}px`),re.setProperty("--radix-popper-available-height",`${Ne}px`),re.setProperty("--radix-popper-anchor-width",`${ce}px`),re.setProperty("--radix-popper-anchor-height",`${oe}px`)}}),k&&wP({element:k,padding:o}),e8e({arrowWidth:R,arrowHeight:N}),h&&xP({strategy:"referenceHidden",...W})]}),[te,V]=Pee(U),Q=Es(y);si(()=>{H&&(Q==null||Q())},[H,Q]);const ee=(Fe=L.arrow)==null?void 0:Fe.x,se=(Se=L.arrow)==null?void 0:Se.y,pe=((Ce=L.arrow)==null?void 0:Ce.centerOffset)!==0,[ue,Oe]=E.useState();return si(()=>{x&&Oe(window.getComputedStyle(x).zIndex)},[x]),f.jsx("div",{ref:O.setFloating,"data-radix-popper-content-wrapper":"",style:{...Z,transform:H?Z.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:ue,"--radix-popper-transform-origin":[(qe=L.transformOrigin)==null?void 0:qe.x,(Qe=L.transformOrigin)==null?void 0:Qe.y].join(" "),...((We=L.hide)==null?void 0:We.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:f.jsx(Z5e,{scope:n,placedSide:te,onArrowChange:C,arrowX:ee,arrowY:se,shouldHideArrow:pe,children:f.jsx(_i.div,{"data-side":te,"data-align":V,...b,ref:S,style:{...b.style,animation:H?void 0:"none"}})})})});Iee.displayName=k6;var jee="PopperArrow",J5e={top:"bottom",right:"left",bottom:"top",left:"right"},Oee=E.forwardRef(function(t,n){const{__scopePopper:r,...s}=t,i=X5e(jee,r),a=J5e[i.placedSide];return f.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[a]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:f.jsx(K5e,{...s,ref:n,style:{...s.style,display:"block"}})})});Oee.displayName=jee;function Q5e(e){return e!==null}var e8e=e=>({name:"transformOrigin",options:e,fn(t){var v,x,w;const{placement:n,rects:r,middlewareData:s}=t,a=((v=s.arrow)==null?void 0:v.centerOffset)!==0,o=a?0:e.arrowWidth,l=a?0:e.arrowHeight,[c,u]=Pee(n),d={start:"0%",center:"50%",end:"100%"}[u],h=(((x=s.arrow)==null?void 0:x.x)??0)+o/2,m=(((w=s.arrow)==null?void 0:w.y)??0)+l/2;let y="",b="";return c==="bottom"?(y=a?d:`${h}px`,b=`${-l}px`):c==="top"?(y=a?d:`${h}px`,b=`${r.floating.height+l}px`):c==="right"?(y=`${-l}px`,b=a?d:`${m}px`):c==="left"&&(y=`${r.floating.width+l}px`,b=a?d:`${m}px`),{data:{x:y,y:b}}}});function Pee(e){const[t,n="center"]=e.split("-");return[t,n]}var t8e=Ree,n8e=Mee,r8e=Iee,s8e=Oee,i8e="Portal",Dee=E.forwardRef((e,t)=>{var o;const{container:n,...r}=e,[s,i]=E.useState(!1);si(()=>i(!0),[]);const a=n||s&&((o=globalThis==null?void 0:globalThis.document)==null?void 0:o.body);return a?_E.createPortal(f.jsx(_i.div,{...r,ref:t}),a):null});Dee.displayName=i8e;function TT(e){const t=E.useRef({value:e,previous:e});return E.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var Fee=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),a8e="VisuallyHidden",o8e=E.forwardRef((e,t)=>f.jsx(_i.span,{...e,ref:t,style:{...Fee,...e.style}}));o8e.displayName=a8e;var l8e=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},r0=new WeakMap,i2=new WeakMap,a2={},XI=0,Lee=function(e){return e&&(e.host||Lee(e.parentNode))},c8e=function(e,t){return t.map(function(n){if(e.contains(n))return n;var r=Lee(n);return r&&e.contains(r)?r:(console.error("aria-hidden",n,"in not contained inside",e,". Doing nothing"),null)}).filter(function(n){return!!n})},u8e=function(e,t,n,r){var s=c8e(t,Array.isArray(e)?e:[e]);a2[n]||(a2[n]=new WeakMap);var i=a2[n],a=[],o=new Set,l=new Set(s),c=function(d){!d||o.has(d)||(o.add(d),c(d.parentNode))};s.forEach(c);var u=function(d){!d||l.has(d)||Array.prototype.forEach.call(d.children,function(h){if(o.has(h))u(h);else try{var m=h.getAttribute(r),y=m!==null&&m!=="false",b=(r0.get(h)||0)+1,v=(i.get(h)||0)+1;r0.set(h,b),i.set(h,v),a.push(h),b===1&&y&&i2.set(h,!0),v===1&&h.setAttribute(n,"true"),y||h.setAttribute(r,"true")}catch(x){console.error("aria-hidden: cannot operate on ",h,x)}})};return u(t),o.clear(),XI++,function(){a.forEach(function(d){var h=r0.get(d)-1,m=i.get(d)-1;r0.set(d,h),i.set(d,m),h||(i2.has(d)||d.removeAttribute(r),i2.delete(d)),m||d.removeAttribute(n)}),XI--,XI||(r0=new WeakMap,r0=new WeakMap,i2=new WeakMap,a2={})}},AT=function(e,t,n){n===void 0&&(n="data-aria-hidden");var r=Array.from(Array.isArray(e)?e:[e]),s=l8e(e);return s?(r.push.apply(r,Array.from(s.querySelectorAll("[aria-live]"))),u8e(r,s,n,"aria-hidden")):function(){return null}},bu=function(){return bu=Object.assign||function(t){for(var n,r=1,s=arguments.length;r<s;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},bu.apply(this,arguments)};function Bee(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(e);s<r.length;s++)t.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(n[r[s]]=e[r[s]]);return n}function d8e(e,t,n){if(n||arguments.length===2)for(var r=0,s=t.length,i;r<s;r++)(i||!(r in t))&&(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))}var $2="right-scroll-bar-position",z2="width-before-scroll-bar",f8e="with-scroll-bars-hidden",h8e="--removed-body-scroll-bar-size";function JI(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function p8e(e,t){var n=E.useState(function(){return{value:e,callback:t,facade:{get current(){return n.value},set current(r){var s=n.value;s!==r&&(n.value=r,n.callback(r,s))}}}})[0];return n.callback=t,n.facade}var m8e=typeof window<"u"?E.useLayoutEffect:E.useEffect,ZU=new WeakMap;function g8e(e,t){var n=p8e(null,function(r){return e.forEach(function(s){return JI(s,r)})});return m8e(function(){var r=ZU.get(n);if(r){var s=new Set(r),i=new Set(e),a=n.current;s.forEach(function(o){i.has(o)||JI(o,null)}),i.forEach(function(o){s.has(o)||JI(o,a)})}ZU.set(n,e)},[e]),n}function y8e(e){return e}function b8e(e,t){t===void 0&&(t=y8e);var n=[],r=!1,s={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:e},useMedium:function(i){var a=t(i,r);return n.push(a),function(){n=n.filter(function(o){return o!==a})}},assignSyncMedium:function(i){for(r=!0;n.length;){var a=n;n=[],a.forEach(i)}n={push:function(o){return i(o)},filter:function(){return n}}},assignMedium:function(i){r=!0;var a=[];if(n.length){var o=n;n=[],o.forEach(i),a=n}var l=function(){var u=a;a=[],u.forEach(i)},c=function(){return Promise.resolve().then(l)};c(),n={push:function(u){a.push(u),c()},filter:function(u){return a=a.filter(u),n}}}};return s}function v8e(e){e===void 0&&(e={});var t=b8e(null);return t.options=bu({async:!0,ssr:!1},e),t}var $ee=function(e){var t=e.sideCar,n=Bee(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=t.read();if(!r)throw new Error("Sidecar medium not found");return E.createElement(r,bu({},n))};$ee.isSideCarExport=!0;function x8e(e,t){return e.useMedium(t),$ee}var zee=v8e(),QI=function(){},RT=E.forwardRef(function(e,t){var n=E.useRef(null),r=E.useState({onScrollCapture:QI,onWheelCapture:QI,onTouchMoveCapture:QI}),s=r[0],i=r[1],a=e.forwardProps,o=e.children,l=e.className,c=e.removeScrollBar,u=e.enabled,d=e.shards,h=e.sideCar,m=e.noIsolation,y=e.inert,b=e.allowPinchZoom,v=e.as,x=v===void 0?"div":v,w=e.gapMode,S=Bee(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),k=h,C=g8e([n,t]),T=bu(bu({},S),s);return E.createElement(E.Fragment,null,u&&E.createElement(k,{sideCar:zee,removeScrollBar:c,shards:d,noIsolation:m,inert:y,setCallbacks:i,allowPinchZoom:!!b,lockRef:n,gapMode:w}),a?E.cloneElement(E.Children.only(o),bu(bu({},T),{ref:C})):E.createElement(x,bu({},T,{className:l,ref:C}),o))});RT.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};RT.classNames={fullWidth:z2,zeroRight:$2};var w8e=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function _8e(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=w8e();return t&&e.setAttribute("nonce",t),e}function S8e(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function C8e(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var k8e=function(){var e=0,t=null;return{add:function(n){e==0&&(t=_8e())&&(S8e(t,n),C8e(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},E8e=function(){var e=k8e();return function(t,n){E.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&n])}},Uee=function(){var e=E8e(),t=function(n){var r=n.styles,s=n.dynamic;return e(r,s),null};return t},T8e={left:0,top:0,right:0,gap:0},e3=function(e){return parseInt(e||"",10)||0},A8e=function(e){var t=window.getComputedStyle(document.body),n=t[e==="padding"?"paddingLeft":"marginLeft"],r=t[e==="padding"?"paddingTop":"marginTop"],s=t[e==="padding"?"paddingRight":"marginRight"];return[e3(n),e3(r),e3(s)]},R8e=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return T8e;var t=A8e(e),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,r-n+t[2]-t[0])}},N8e=Uee(),F0="data-scroll-locked",M8e=function(e,t,n,r){var s=e.left,i=e.top,a=e.right,o=e.gap;return n===void 0&&(n="margin"),`
  .`.concat(f8e,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(o,"px ").concat(r,`;
  }
  body[`).concat(F0,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(r,";"),n==="margin"&&`
    padding-left: `.concat(s,`px;
    padding-top: `).concat(i,`px;
    padding-right: `).concat(a,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(o,"px ").concat(r,`;
    `),n==="padding"&&"padding-right: ".concat(o,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat($2,` {
    right: `).concat(o,"px ").concat(r,`;
  }
  
  .`).concat(z2,` {
    margin-right: `).concat(o,"px ").concat(r,`;
  }
  
  .`).concat($2," .").concat($2,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(z2," .").concat(z2,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(F0,`] {
    `).concat(h8e,": ").concat(o,`px;
  }
`)},XU=function(){var e=parseInt(document.body.getAttribute(F0)||"0",10);return isFinite(e)?e:0},I8e=function(){E.useEffect(function(){return document.body.setAttribute(F0,(XU()+1).toString()),function(){var e=XU()-1;e<=0?document.body.removeAttribute(F0):document.body.setAttribute(F0,e.toString())}},[])},j8e=function(e){var t=e.noRelative,n=e.noImportant,r=e.gapMode,s=r===void 0?"margin":r;I8e();var i=E.useMemo(function(){return R8e(s)},[s]);return E.createElement(N8e,{styles:M8e(i,!t,s,n?"":"!important")})},x4=!1;if(typeof window<"u")try{var o2=Object.defineProperty({},"passive",{get:function(){return x4=!0,!0}});window.addEventListener("test",o2,o2),window.removeEventListener("test",o2,o2)}catch{x4=!1}var s0=x4?{passive:!1}:!1,O8e=function(e){return e.tagName==="TEXTAREA"},qee=function(e,t){if(!(e instanceof Element))return!1;var n=window.getComputedStyle(e);return n[t]!=="hidden"&&!(n.overflowY===n.overflowX&&!O8e(e)&&n[t]==="visible")},P8e=function(e){return qee(e,"overflowY")},D8e=function(e){return qee(e,"overflowX")},JU=function(e,t){var n=t.ownerDocument,r=t;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var s=Vee(e,r);if(s){var i=Wee(e,r),a=i[1],o=i[2];if(a>o)return!0}r=r.parentNode}while(r&&r!==n.body);return!1},F8e=function(e){var t=e.scrollTop,n=e.scrollHeight,r=e.clientHeight;return[t,n,r]},L8e=function(e){var t=e.scrollLeft,n=e.scrollWidth,r=e.clientWidth;return[t,n,r]},Vee=function(e,t){return e==="v"?P8e(t):D8e(t)},Wee=function(e,t){return e==="v"?F8e(t):L8e(t)},B8e=function(e,t){return e==="h"&&t==="rtl"?-1:1},$8e=function(e,t,n,r,s){var i=B8e(e,window.getComputedStyle(t).direction),a=i*r,o=n.target,l=t.contains(o),c=!1,u=a>0,d=0,h=0;do{var m=Wee(e,o),y=m[0],b=m[1],v=m[2],x=b-v-i*y;(y||x)&&Vee(e,o)&&(d+=x,h+=y),o instanceof ShadowRoot?o=o.host:o=o.parentNode}while(!l&&o!==document.body||l&&(t.contains(o)||t===o));return(u&&Math.abs(d)<1||!u&&Math.abs(h)<1)&&(c=!0),c},l2=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},QU=function(e){return[e.deltaX,e.deltaY]},eq=function(e){return e&&"current"in e?e.current:e},z8e=function(e,t){return e[0]===t[0]&&e[1]===t[1]},U8e=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},q8e=0,i0=[];function V8e(e){var t=E.useRef([]),n=E.useRef([0,0]),r=E.useRef(),s=E.useState(q8e++)[0],i=E.useState(Uee)[0],a=E.useRef(e);E.useEffect(function(){a.current=e},[e]),E.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(s));var b=d8e([e.lockRef.current],(e.shards||[]).map(eq),!0).filter(Boolean);return b.forEach(function(v){return v.classList.add("allow-interactivity-".concat(s))}),function(){document.body.classList.remove("block-interactivity-".concat(s)),b.forEach(function(v){return v.classList.remove("allow-interactivity-".concat(s))})}}},[e.inert,e.lockRef.current,e.shards]);var o=E.useCallback(function(b,v){if("touches"in b&&b.touches.length===2||b.type==="wheel"&&b.ctrlKey)return!a.current.allowPinchZoom;var x=l2(b),w=n.current,S="deltaX"in b?b.deltaX:w[0]-x[0],k="deltaY"in b?b.deltaY:w[1]-x[1],C,T=b.target,R=Math.abs(S)>Math.abs(k)?"h":"v";if("touches"in b&&R==="h"&&T.type==="range")return!1;var N=JU(R,T);if(!N)return!0;if(N?C=R:(C=R==="v"?"h":"v",N=JU(R,T)),!N)return!1;if(!r.current&&"changedTouches"in b&&(S||k)&&(r.current=C),!C)return!0;var I=r.current||C;return $8e(I,v,b,I==="h"?S:k)},[]),l=E.useCallback(function(b){var v=b;if(!(!i0.length||i0[i0.length-1]!==i)){var x="deltaY"in v?QU(v):l2(v),w=t.current.filter(function(C){return C.name===v.type&&(C.target===v.target||v.target===C.shadowParent)&&z8e(C.delta,x)})[0];if(w&&w.should){v.cancelable&&v.preventDefault();return}if(!w){var S=(a.current.shards||[]).map(eq).filter(Boolean).filter(function(C){return C.contains(v.target)}),k=S.length>0?o(v,S[0]):!a.current.noIsolation;k&&v.cancelable&&v.preventDefault()}}},[]),c=E.useCallback(function(b,v,x,w){var S={name:b,delta:v,target:x,should:w,shadowParent:W8e(x)};t.current.push(S),setTimeout(function(){t.current=t.current.filter(function(k){return k!==S})},1)},[]),u=E.useCallback(function(b){n.current=l2(b),r.current=void 0},[]),d=E.useCallback(function(b){c(b.type,QU(b),b.target,o(b,e.lockRef.current))},[]),h=E.useCallback(function(b){c(b.type,l2(b),b.target,o(b,e.lockRef.current))},[]);E.useEffect(function(){return i0.push(i),e.setCallbacks({onScrollCapture:d,onWheelCapture:d,onTouchMoveCapture:h}),document.addEventListener("wheel",l,s0),document.addEventListener("touchmove",l,s0),document.addEventListener("touchstart",u,s0),function(){i0=i0.filter(function(b){return b!==i}),document.removeEventListener("wheel",l,s0),document.removeEventListener("touchmove",l,s0),document.removeEventListener("touchstart",u,s0)}},[]);var m=e.removeScrollBar,y=e.inert;return E.createElement(E.Fragment,null,y?E.createElement(i,{styles:U8e(s)}):null,m?E.createElement(j8e,{gapMode:e.gapMode}):null)}function W8e(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const H8e=x8e(zee,V8e);var J1=E.forwardRef(function(e,t){return E.createElement(RT,bu({},e,{ref:t,sideCar:H8e}))});J1.classNames=RT.classNames;var G8e=[" ","Enter","ArrowUp","ArrowDown"],K8e=[" ","Enter"],Rm="Select",[NT,MT,Y8e]=N5e(Rm),[mb,wdt]=Ki(Rm,[Y8e,Tee]),IT=Tee(),[Z8e,Qh]=mb(Rm),[X8e,J8e]=mb(Rm),Hee=e=>{const{__scopeSelect:t,children:n,open:r,defaultOpen:s,onOpenChange:i,value:a,defaultValue:o,onValueChange:l,dir:c,name:u,autoComplete:d,disabled:h,required:m,form:y}=e,b=IT(t),[v,x]=E.useState(null),[w,S]=E.useState(null),[k,C]=E.useState(!1),T=db(c),[R,N]=Fc({prop:r,defaultProp:s??!1,onChange:i,caller:Rm}),[I,P]=Fc({prop:a,defaultProp:o,onChange:l,caller:Rm}),B=E.useRef(null),D=v?y||!!v.closest("form"):!0,[W,O]=E.useState(new Set),Z=Array.from(W).map(U=>U.props.value).join(";");return f.jsx(t8e,{...b,children:f.jsxs(Z8e,{required:m,scope:t,trigger:v,onTriggerChange:x,valueNode:w,onValueNodeChange:S,valueNodeHasChildren:k,onValueNodeHasChildrenChange:C,contentId:la(),value:I,onValueChange:P,open:R,onOpenChange:N,dir:T,triggerPointerDownPosRef:B,disabled:h,children:[f.jsx(NT.Provider,{scope:t,children:f.jsx(X8e,{scope:e.__scopeSelect,onNativeOptionAdd:E.useCallback(U=>{O(H=>new Set(H).add(U))},[]),onNativeOptionRemove:E.useCallback(U=>{O(H=>{const L=new Set(H);return L.delete(U),L})},[]),children:n})}),D?f.jsxs(pte,{"aria-hidden":!0,required:m,tabIndex:-1,name:u,autoComplete:d,value:I,onChange:U=>P(U.target.value),disabled:h,form:y,children:[I===void 0?f.jsx("option",{value:""}):null,Array.from(W)]},Z):null]})})};Hee.displayName=Rm;var Gee="SelectTrigger",Kee=E.forwardRef((e,t)=>{const{__scopeSelect:n,disabled:r=!1,...s}=e,i=IT(n),a=Qh(Gee,n),o=a.disabled||r,l=Mn(t,a.onTriggerChange),c=MT(n),u=E.useRef("touch"),[d,h,m]=gte(b=>{const v=c().filter(S=>!S.disabled),x=v.find(S=>S.value===a.value),w=yte(v,b,x);w!==void 0&&a.onValueChange(w.value)}),y=b=>{o||(a.onOpenChange(!0),m()),b&&(a.triggerPointerDownPosRef.current={x:Math.round(b.pageX),y:Math.round(b.pageY)})};return f.jsx(n8e,{asChild:!0,...i,children:f.jsx(_i.button,{type:"button",role:"combobox","aria-controls":a.contentId,"aria-expanded":a.open,"aria-required":a.required,"aria-autocomplete":"none",dir:a.dir,"data-state":a.open?"open":"closed",disabled:o,"data-disabled":o?"":void 0,"data-placeholder":mte(a.value)?"":void 0,...s,ref:l,onClick:Wt(s.onClick,b=>{b.currentTarget.focus(),u.current!=="mouse"&&y(b)}),onPointerDown:Wt(s.onPointerDown,b=>{u.current=b.pointerType;const v=b.target;v.hasPointerCapture(b.pointerId)&&v.releasePointerCapture(b.pointerId),b.button===0&&b.ctrlKey===!1&&b.pointerType==="mouse"&&(y(b),b.preventDefault())}),onKeyDown:Wt(s.onKeyDown,b=>{const v=d.current!=="";!(b.ctrlKey||b.altKey||b.metaKey)&&b.key.length===1&&h(b.key),!(v&&b.key===" ")&&G8e.includes(b.key)&&(y(),b.preventDefault())})})})});Kee.displayName=Gee;var Yee="SelectValue",Zee=E.forwardRef((e,t)=>{const{__scopeSelect:n,className:r,style:s,children:i,placeholder:a="",...o}=e,l=Qh(Yee,n),{onValueNodeHasChildrenChange:c}=l,u=i!==void 0,d=Mn(t,l.onValueNodeChange);return si(()=>{c(u)},[c,u]),f.jsx(_i.span,{...o,ref:d,style:{pointerEvents:"none"},children:mte(l.value)?f.jsx(f.Fragment,{children:a}):i})});Zee.displayName=Yee;var Q8e="SelectIcon",Xee=E.forwardRef((e,t)=>{const{__scopeSelect:n,children:r,...s}=e;return f.jsx(_i.span,{"aria-hidden":!0,...s,ref:t,children:r||""})});Xee.displayName=Q8e;var eLe="SelectPortal",Jee=e=>f.jsx(Dee,{asChild:!0,...e});Jee.displayName=eLe;var Nm="SelectContent",Qee=E.forwardRef((e,t)=>{const n=Qh(Nm,e.__scopeSelect),[r,s]=E.useState();if(si(()=>{s(new DocumentFragment)},[]),!n.open){const i=r;return i?cl.createPortal(f.jsx(ete,{scope:e.__scopeSelect,children:f.jsx(NT.Slot,{scope:e.__scopeSelect,children:f.jsx("div",{children:e.children})})}),i):null}return f.jsx(tte,{...e,ref:t})});Qee.displayName=Nm;var yc=10,[ete,ep]=mb(Nm),tLe="SelectContentImpl",nLe=Mu("SelectContent.RemoveScroll"),tte=E.forwardRef((e,t)=>{const{__scopeSelect:n,position:r="item-aligned",onCloseAutoFocus:s,onEscapeKeyDown:i,onPointerDownOutside:a,side:o,sideOffset:l,align:c,alignOffset:u,arrowPadding:d,collisionBoundary:h,collisionPadding:m,sticky:y,hideWhenDetached:b,avoidCollisions:v,...x}=e,w=Qh(Nm,n),[S,k]=E.useState(null),[C,T]=E.useState(null),R=Mn(t,Fe=>k(Fe)),[N,I]=E.useState(null),[P,B]=E.useState(null),D=MT(n),[W,O]=E.useState(!1),Z=E.useRef(!1);E.useEffect(()=>{if(S)return AT(S)},[S]),ET();const U=E.useCallback(Fe=>{const[Se,...Ce]=D().map(We=>We.ref.current),[qe]=Ce.slice(-1),Qe=document.activeElement;for(const We of Fe)if(We===Qe||(We==null||We.scrollIntoView({block:"nearest"}),We===Se&&C&&(C.scrollTop=0),We===qe&&C&&(C.scrollTop=C.scrollHeight),We==null||We.focus(),document.activeElement!==Qe))return},[D,C]),H=E.useCallback(()=>U([N,S]),[U,N,S]);E.useEffect(()=>{W&&H()},[W,H]);const{onOpenChange:L,triggerPointerDownPosRef:te}=w;E.useEffect(()=>{if(S){let Fe={x:0,y:0};const Se=qe=>{var Qe,We;Fe={x:Math.abs(Math.round(qe.pageX)-(((Qe=te.current)==null?void 0:Qe.x)??0)),y:Math.abs(Math.round(qe.pageY)-(((We=te.current)==null?void 0:We.y)??0))}},Ce=qe=>{Fe.x<=10&&Fe.y<=10?qe.preventDefault():S.contains(qe.target)||L(!1),document.removeEventListener("pointermove",Se),te.current=null};return te.current!==null&&(document.addEventListener("pointermove",Se),document.addEventListener("pointerup",Ce,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",Se),document.removeEventListener("pointerup",Ce,{capture:!0})}}},[S,L,te]),E.useEffect(()=>{const Fe=()=>L(!1);return window.addEventListener("blur",Fe),window.addEventListener("resize",Fe),()=>{window.removeEventListener("blur",Fe),window.removeEventListener("resize",Fe)}},[L]);const[V,Q]=gte(Fe=>{const Se=D().filter(Qe=>!Qe.disabled),Ce=Se.find(Qe=>Qe.ref.current===document.activeElement),qe=yte(Se,Fe,Ce);qe&&setTimeout(()=>qe.ref.current.focus())}),ee=E.useCallback((Fe,Se,Ce)=>{const qe=!Z.current&&!Ce;(w.value!==void 0&&w.value===Se||qe)&&(I(Fe),qe&&(Z.current=!0))},[w.value]),se=E.useCallback(()=>S==null?void 0:S.focus(),[S]),pe=E.useCallback((Fe,Se,Ce)=>{const qe=!Z.current&&!Ce;(w.value!==void 0&&w.value===Se||qe)&&B(Fe)},[w.value]),ue=r==="popper"?w4:nte,Oe=ue===w4?{side:o,sideOffset:l,align:c,alignOffset:u,arrowPadding:d,collisionBoundary:h,collisionPadding:m,sticky:y,hideWhenDetached:b,avoidCollisions:v}:{};return f.jsx(ete,{scope:n,content:S,viewport:C,onViewportChange:T,itemRefCallback:ee,selectedItem:N,onItemLeave:se,itemTextRefCallback:pe,focusSelectedItem:H,selectedItemText:P,position:r,isPositioned:W,searchRef:V,children:f.jsx(J1,{as:nLe,allowPinchZoom:!0,children:f.jsx(See,{asChild:!0,trapped:w.open,onMountAutoFocus:Fe=>{Fe.preventDefault()},onUnmountAutoFocus:Wt(s,Fe=>{var Se;(Se=w.trigger)==null||Se.focus({preventScroll:!0}),Fe.preventDefault()}),children:f.jsx(wee,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:i,onPointerDownOutside:a,onFocusOutside:Fe=>Fe.preventDefault(),onDismiss:()=>w.onOpenChange(!1),children:f.jsx(ue,{role:"listbox",id:w.contentId,"data-state":w.open?"open":"closed",dir:w.dir,onContextMenu:Fe=>Fe.preventDefault(),...x,...Oe,onPlaced:()=>O(!0),ref:R,style:{display:"flex",flexDirection:"column",outline:"none",...x.style},onKeyDown:Wt(x.onKeyDown,Fe=>{const Se=Fe.ctrlKey||Fe.altKey||Fe.metaKey;if(Fe.key==="Tab"&&Fe.preventDefault(),!Se&&Fe.key.length===1&&Q(Fe.key),["ArrowUp","ArrowDown","Home","End"].includes(Fe.key)){let qe=D().filter(Qe=>!Qe.disabled).map(Qe=>Qe.ref.current);if(["ArrowUp","End"].includes(Fe.key)&&(qe=qe.slice().reverse()),["ArrowUp","ArrowDown"].includes(Fe.key)){const Qe=Fe.target,We=qe.indexOf(Qe);qe=qe.slice(We+1)}setTimeout(()=>U(qe)),Fe.preventDefault()}})})})})})})});tte.displayName=tLe;var rLe="SelectItemAlignedPosition",nte=E.forwardRef((e,t)=>{const{__scopeSelect:n,onPlaced:r,...s}=e,i=Qh(Nm,n),a=ep(Nm,n),[o,l]=E.useState(null),[c,u]=E.useState(null),d=Mn(t,R=>u(R)),h=MT(n),m=E.useRef(!1),y=E.useRef(!0),{viewport:b,selectedItem:v,selectedItemText:x,focusSelectedItem:w}=a,S=E.useCallback(()=>{if(i.trigger&&i.valueNode&&o&&c&&b&&v&&x){const R=i.trigger.getBoundingClientRect(),N=c.getBoundingClientRect(),I=i.valueNode.getBoundingClientRect(),P=x.getBoundingClientRect();if(i.dir!=="rtl"){const Qe=P.left-N.left,We=I.left-Qe,Ie=R.left-We,K=R.width+Ie,ye=Math.max(K,N.width),Ne=window.innerWidth-yc,ce=Lw(We,[yc,Math.max(yc,Ne-ye)]);o.style.minWidth=K+"px",o.style.left=ce+"px"}else{const Qe=N.right-P.right,We=window.innerWidth-I.right-Qe,Ie=window.innerWidth-R.right-We,K=R.width+Ie,ye=Math.max(K,N.width),Ne=window.innerWidth-yc,ce=Lw(We,[yc,Math.max(yc,Ne-ye)]);o.style.minWidth=K+"px",o.style.right=ce+"px"}const B=h(),D=window.innerHeight-yc*2,W=b.scrollHeight,O=window.getComputedStyle(c),Z=parseInt(O.borderTopWidth,10),U=parseInt(O.paddingTop,10),H=parseInt(O.borderBottomWidth,10),L=parseInt(O.paddingBottom,10),te=Z+U+W+L+H,V=Math.min(v.offsetHeight*5,te),Q=window.getComputedStyle(b),ee=parseInt(Q.paddingTop,10),se=parseInt(Q.paddingBottom,10),pe=R.top+R.height/2-yc,ue=D-pe,Oe=v.offsetHeight/2,Fe=v.offsetTop+Oe,Se=Z+U+Fe,Ce=te-Se;if(Se<=pe){const Qe=B.length>0&&v===B[B.length-1].ref.current;o.style.bottom="0px";const We=c.clientHeight-b.offsetTop-b.offsetHeight,Ie=Math.max(ue,Oe+(Qe?se:0)+We+H),K=Se+Ie;o.style.height=K+"px"}else{const Qe=B.length>0&&v===B[0].ref.current;o.style.top="0px";const Ie=Math.max(pe,Z+b.offsetTop+(Qe?ee:0)+Oe)+Ce;o.style.height=Ie+"px",b.scrollTop=Se-pe+b.offsetTop}o.style.margin=`${yc}px 0`,o.style.minHeight=V+"px",o.style.maxHeight=D+"px",r==null||r(),requestAnimationFrame(()=>m.current=!0)}},[h,i.trigger,i.valueNode,o,c,b,v,x,i.dir,r]);si(()=>S(),[S]);const[k,C]=E.useState();si(()=>{c&&C(window.getComputedStyle(c).zIndex)},[c]);const T=E.useCallback(R=>{R&&y.current===!0&&(S(),w==null||w(),y.current=!1)},[S,w]);return f.jsx(iLe,{scope:n,contentWrapper:o,shouldExpandOnScrollRef:m,onScrollButtonChange:T,children:f.jsx("div",{ref:l,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:k},children:f.jsx(_i.div,{...s,ref:d,style:{boxSizing:"border-box",maxHeight:"100%",...s.style}})})})});nte.displayName=rLe;var sLe="SelectPopperPosition",w4=E.forwardRef((e,t)=>{const{__scopeSelect:n,align:r="start",collisionPadding:s=yc,...i}=e,a=IT(n);return f.jsx(r8e,{...a,...i,ref:t,align:r,collisionPadding:s,style:{boxSizing:"border-box",...i.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});w4.displayName=sLe;var[iLe,E6]=mb(Nm,{}),_4="SelectViewport",rte=E.forwardRef((e,t)=>{const{__scopeSelect:n,nonce:r,...s}=e,i=ep(_4,n),a=E6(_4,n),o=Mn(t,i.onViewportChange),l=E.useRef(0);return f.jsxs(f.Fragment,{children:[f.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:r}),f.jsx(NT.Slot,{scope:n,children:f.jsx(_i.div,{"data-radix-select-viewport":"",role:"presentation",...s,ref:o,style:{position:"relative",flex:1,overflow:"hidden auto",...s.style},onScroll:Wt(s.onScroll,c=>{const u=c.currentTarget,{contentWrapper:d,shouldExpandOnScrollRef:h}=a;if(h!=null&&h.current&&d){const m=Math.abs(l.current-u.scrollTop);if(m>0){const y=window.innerHeight-yc*2,b=parseFloat(d.style.minHeight),v=parseFloat(d.style.height),x=Math.max(b,v);if(x<y){const w=x+m,S=Math.min(y,w),k=w-S;d.style.height=S+"px",d.style.bottom==="0px"&&(u.scrollTop=k>0?k:0,d.style.justifyContent="flex-end")}}}l.current=u.scrollTop})})})]})});rte.displayName=_4;var ste="SelectGroup",[aLe,oLe]=mb(ste),lLe=E.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,s=la();return f.jsx(aLe,{scope:n,id:s,children:f.jsx(_i.div,{role:"group","aria-labelledby":s,...r,ref:t})})});lLe.displayName=ste;var ite="SelectLabel",cLe=E.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,s=oLe(ite,n);return f.jsx(_i.div,{id:s.id,...r,ref:t})});cLe.displayName=ite;var _k="SelectItem",[uLe,ate]=mb(_k),ote=E.forwardRef((e,t)=>{const{__scopeSelect:n,value:r,disabled:s=!1,textValue:i,...a}=e,o=Qh(_k,n),l=ep(_k,n),c=o.value===r,[u,d]=E.useState(i??""),[h,m]=E.useState(!1),y=Mn(t,w=>{var S;return(S=l.itemRefCallback)==null?void 0:S.call(l,w,r,s)}),b=la(),v=E.useRef("touch"),x=()=>{s||(o.onValueChange(r),o.onOpenChange(!1))};if(r==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return f.jsx(uLe,{scope:n,value:r,disabled:s,textId:b,isSelected:c,onItemTextChange:E.useCallback(w=>{d(S=>S||((w==null?void 0:w.textContent)??"").trim())},[]),children:f.jsx(NT.ItemSlot,{scope:n,value:r,disabled:s,textValue:u,children:f.jsx(_i.div,{role:"option","aria-labelledby":b,"data-highlighted":h?"":void 0,"aria-selected":c&&h,"data-state":c?"checked":"unchecked","aria-disabled":s||void 0,"data-disabled":s?"":void 0,tabIndex:s?void 0:-1,...a,ref:y,onFocus:Wt(a.onFocus,()=>m(!0)),onBlur:Wt(a.onBlur,()=>m(!1)),onClick:Wt(a.onClick,()=>{v.current!=="mouse"&&x()}),onPointerUp:Wt(a.onPointerUp,()=>{v.current==="mouse"&&x()}),onPointerDown:Wt(a.onPointerDown,w=>{v.current=w.pointerType}),onPointerMove:Wt(a.onPointerMove,w=>{var S;v.current=w.pointerType,s?(S=l.onItemLeave)==null||S.call(l):v.current==="mouse"&&w.currentTarget.focus({preventScroll:!0})}),onPointerLeave:Wt(a.onPointerLeave,w=>{var S;w.currentTarget===document.activeElement&&((S=l.onItemLeave)==null||S.call(l))}),onKeyDown:Wt(a.onKeyDown,w=>{var k;((k=l.searchRef)==null?void 0:k.current)!==""&&w.key===" "||(K8e.includes(w.key)&&x(),w.key===" "&&w.preventDefault())})})})})});ote.displayName=_k;var cx="SelectItemText",lte=E.forwardRef((e,t)=>{const{__scopeSelect:n,className:r,style:s,...i}=e,a=Qh(cx,n),o=ep(cx,n),l=ate(cx,n),c=J8e(cx,n),[u,d]=E.useState(null),h=Mn(t,x=>d(x),l.onItemTextChange,x=>{var w;return(w=o.itemTextRefCallback)==null?void 0:w.call(o,x,l.value,l.disabled)}),m=u==null?void 0:u.textContent,y=E.useMemo(()=>f.jsx("option",{value:l.value,disabled:l.disabled,children:m},l.value),[l.disabled,l.value,m]),{onNativeOptionAdd:b,onNativeOptionRemove:v}=c;return si(()=>(b(y),()=>v(y)),[b,v,y]),f.jsxs(f.Fragment,{children:[f.jsx(_i.span,{id:l.textId,...i,ref:h}),l.isSelected&&a.valueNode&&!a.valueNodeHasChildren?cl.createPortal(i.children,a.valueNode):null]})});lte.displayName=cx;var cte="SelectItemIndicator",ute=E.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e;return ate(cte,n).isSelected?f.jsx(_i.span,{"aria-hidden":!0,...r,ref:t}):null});ute.displayName=cte;var S4="SelectScrollUpButton",dte=E.forwardRef((e,t)=>{const n=ep(S4,e.__scopeSelect),r=E6(S4,e.__scopeSelect),[s,i]=E.useState(!1),a=Mn(t,r.onScrollButtonChange);return si(()=>{if(n.viewport&&n.isPositioned){let o=function(){const c=l.scrollTop>0;i(c)};const l=n.viewport;return o(),l.addEventListener("scroll",o),()=>l.removeEventListener("scroll",o)}},[n.viewport,n.isPositioned]),s?f.jsx(hte,{...e,ref:a,onAutoScroll:()=>{const{viewport:o,selectedItem:l}=n;o&&l&&(o.scrollTop=o.scrollTop-l.offsetHeight)}}):null});dte.displayName=S4;var C4="SelectScrollDownButton",fte=E.forwardRef((e,t)=>{const n=ep(C4,e.__scopeSelect),r=E6(C4,e.__scopeSelect),[s,i]=E.useState(!1),a=Mn(t,r.onScrollButtonChange);return si(()=>{if(n.viewport&&n.isPositioned){let o=function(){const c=l.scrollHeight-l.clientHeight,u=Math.ceil(l.scrollTop)<c;i(u)};const l=n.viewport;return o(),l.addEventListener("scroll",o),()=>l.removeEventListener("scroll",o)}},[n.viewport,n.isPositioned]),s?f.jsx(hte,{...e,ref:a,onAutoScroll:()=>{const{viewport:o,selectedItem:l}=n;o&&l&&(o.scrollTop=o.scrollTop+l.offsetHeight)}}):null});fte.displayName=C4;var hte=E.forwardRef((e,t)=>{const{__scopeSelect:n,onAutoScroll:r,...s}=e,i=ep("SelectScrollButton",n),a=E.useRef(null),o=MT(n),l=E.useCallback(()=>{a.current!==null&&(window.clearInterval(a.current),a.current=null)},[]);return E.useEffect(()=>()=>l(),[l]),si(()=>{var u;const c=o().find(d=>d.ref.current===document.activeElement);(u=c==null?void 0:c.ref.current)==null||u.scrollIntoView({block:"nearest"})},[o]),f.jsx(_i.div,{"aria-hidden":!0,...s,ref:t,style:{flexShrink:0,...s.style},onPointerDown:Wt(s.onPointerDown,()=>{a.current===null&&(a.current=window.setInterval(r,50))}),onPointerMove:Wt(s.onPointerMove,()=>{var c;(c=i.onItemLeave)==null||c.call(i),a.current===null&&(a.current=window.setInterval(r,50))}),onPointerLeave:Wt(s.onPointerLeave,()=>{l()})})}),dLe="SelectSeparator",fLe=E.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e;return f.jsx(_i.div,{"aria-hidden":!0,...r,ref:t})});fLe.displayName=dLe;var k4="SelectArrow",hLe=E.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,s=IT(n),i=Qh(k4,n),a=ep(k4,n);return i.open&&a.position==="popper"?f.jsx(s8e,{...s,...r,ref:t}):null});hLe.displayName=k4;var pLe="SelectBubbleInput",pte=E.forwardRef(({__scopeSelect:e,value:t,...n},r)=>{const s=E.useRef(null),i=Mn(r,s),a=TT(t);return E.useEffect(()=>{const o=s.current;if(!o)return;const l=window.HTMLSelectElement.prototype,u=Object.getOwnPropertyDescriptor(l,"value").set;if(a!==t&&u){const d=new Event("change",{bubbles:!0});u.call(o,t),o.dispatchEvent(d)}},[a,t]),f.jsx(_i.select,{...n,style:{...Fee,...n.style},ref:i,defaultValue:t})});pte.displayName=pLe;function mte(e){return e===""||e===void 0}function gte(e){const t=Es(e),n=E.useRef(""),r=E.useRef(0),s=E.useCallback(a=>{const o=n.current+a;t(o),function l(c){n.current=c,window.clearTimeout(r.current),c!==""&&(r.current=window.setTimeout(()=>l(""),1e3))}(o)},[t]),i=E.useCallback(()=>{n.current="",window.clearTimeout(r.current)},[]);return E.useEffect(()=>()=>window.clearTimeout(r.current),[]),[n,s,i]}function yte(e,t,n){const s=t.length>1&&Array.from(t).every(c=>c===t[0])?t[0]:t,i=n?e.indexOf(n):-1;let a=mLe(e,Math.max(i,0));s.length===1&&(a=a.filter(c=>c!==n));const l=a.find(c=>c.textValue.toLowerCase().startsWith(s.toLowerCase()));return l!==n?l:void 0}function mLe(e,t){return e.map((n,r)=>e[(t+r)%e.length])}var gLe=Hee,yLe=Kee,bLe=Zee,vLe=Xee,xLe=Jee,wLe=Qee,_Le=rte,SLe=ote,CLe=lte,kLe=ute,ELe=dte,TLe=fte;function tp({...e}){return f.jsx(gLe,{"data-slot":"select",...e})}function np({...e}){return f.jsx(bLe,{"data-slot":"select-value",...e})}function rp({className:e,size:t="default",children:n,...r}){return f.jsxs(yLe,{"data-slot":"select-trigger","data-size":t,className:Xe("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...r,children:[n,f.jsx(vLe,{asChild:!0,children:f.jsx(Jl,{className:"size-4 opacity-50"})})]})}function sp({className:e,children:t,position:n="popper",...r}){return f.jsx(xLe,{children:f.jsxs(wLe,{"data-slot":"select-content",className:Xe("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md",n==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:n,...r,children:[f.jsx(ALe,{}),f.jsx(_Le,{className:Xe("p-1",n==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:t}),f.jsx(RLe,{})]})})}function Ro({className:e,children:t,...n}){return f.jsxs(SLe,{"data-slot":"select-item",className:Xe("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",e),...n,children:[f.jsx("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:f.jsx(kLe,{children:f.jsx(ao,{className:"size-4"})})}),f.jsx(CLe,{children:t})]})}function ALe({className:e,...t}){return f.jsx(ELe,{"data-slot":"select-scroll-up-button",className:Xe("flex cursor-default items-center justify-center py-1",e),...t,children:f.jsx(Bh,{className:"size-4"})})}function RLe({className:e,...t}){return f.jsx(TLe,{"data-slot":"select-scroll-down-button",className:Xe("flex cursor-default items-center justify-center py-1",e),...t,children:f.jsx(Jl,{className:"size-4"})})}var NLe=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],MLe=NLe.reduce((e,t)=>{const n=Mu(`Primitive.${t}`),r=E.forwardRef((s,i)=>{const{asChild:a,...o}=s,l=a?n:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),f.jsx(l,{...o,ref:i})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{}),ILe="Label",bte=E.forwardRef((e,t)=>f.jsx(MLe.label,{...e,ref:t,onMouseDown:n=>{var s;n.target.closest("button, input, select, textarea")||((s=e.onMouseDown)==null||s.call(e,n),!n.defaultPrevented&&n.detail>1&&n.preventDefault())}}));bte.displayName=ILe;var jLe=bte;function Ot({className:e,...t}){return f.jsx(jLe,{"data-slot":"label",className:Xe("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",e),...t})}const ji=({field:e,className:t})=>e.state.meta.isTouched&&e.state.meta.errors.length>0?f.jsx("em",{className:`text-xs text-destructive mt-1 block ${t||""}`,children:e.state.meta.errors.map(r=>typeof r=="string"?r:typeof r=="object"&&r!==null&&"message"in r&&typeof r.message=="string"?r.message:(console.warn("[GlobalFieldMetaMessages] Encountered an unexpected error structure:",r),"Validation error")).join(", ")}):null,OLe=Co.map(e=>e.value),c2=Ke({keyName:ze().min(1,"Key Name is required."),providerType:xl(OLe,{errorMap:()=>({message:"Provider Type is required."})}),keyValue:ze().min(1,"API Key Value is required.")}),vte=({initialProviderType:e=null,initialName:t="",initialValue:n="",onSave:r,onCancel:s,disabled:i=!1,className:a})=>{const o=E.useRef(null),l=ii({defaultValues:{keyName:t,providerType:e,keyValue:n},validators:{onChangeAsync:c2,onChangeAsyncDebounceMs:500},onSubmit:async({value:u})=>{await r(u.keyName,u.providerType,u.keyValue)}});E.useEffect(()=>{l.reset({keyName:t,providerType:e,keyValue:n})},[t,n,e,l]);const c=(u,d)=>{var b,v;if(!u)return;const h=(b=Co.find(x=>x.value===u))==null?void 0:b.label,m=l.getFieldValue("providerType"),y=(v=Co.find(x=>x.value===m))==null?void 0:v.label;h&&(!(d!=null&&d.trim())||d===y)&&l.setFieldValue("keyName",h),requestAnimationFrame(()=>{var x;(x=o.current)==null||x.focus()})};return f.jsxs("form",{onSubmit:u=>{u.preventDefault(),u.stopPropagation(),l.handleSubmit()},className:Xe("space-y-6",a),children:[f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[f.jsx(l.Field,{name:"providerType",validators:{onChange:c2.shape.providerType},children:u=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(Ot,{htmlFor:u.name,children:"Provider Type"}),f.jsxs(tp,{value:u.state.value??"",onValueChange:d=>{const h=d;u.handleChange(h),u.handleBlur(),c(h,l.getFieldValue("keyName"))},disabled:i||l.state.isSubmitting,children:[f.jsx(rp,{id:u.name,children:f.jsx(np,{placeholder:"Select Provider Type"})}),f.jsx(sp,{children:Co.map(d=>f.jsx(Ro,{value:d.value,children:d.label},d.value))})]}),f.jsx(ji,{field:u})]})}),f.jsx(l.Field,{name:"keyName",validators:{onChange:c2.shape.keyName},children:u=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(Ot,{htmlFor:u.name,children:"Key Name"}),f.jsx(Cn,{id:u.name,value:u.state.value??"",onChange:d=>u.handleChange(d.target.value),onBlur:u.handleBlur,placeholder:"e.g., My OpenAI Key",disabled:i||l.state.isSubmitting}),f.jsx(ji,{field:u})]})}),f.jsx(l.Field,{name:"keyValue",validators:{onChange:c2.shape.keyValue},children:u=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(Ot,{htmlFor:u.name,children:"API Key Value"}),f.jsx(Cn,{ref:o,id:u.name,type:"password",value:u.state.value??"",onChange:d=>u.handleChange(d.target.value),onBlur:u.handleBlur,placeholder:"Enter your API key",disabled:i||l.state.isSubmitting,autoComplete:"new-password"}),f.jsx(ji,{field:u})]})})]}),f.jsxs("div",{className:"flex justify-end space-x-2 pt-2",children:[f.jsxs(mt,{variant:"ghost",size:"sm",onClick:s,disabled:i||l.state.isSubmitting,type:"button",children:[f.jsx(Oi,{className:"h-4 w-4 mr-1"})," Cancel"]}),f.jsx(l.Subscribe,{selector:u=>[u.canSubmit,u.isSubmitting,u.isValidating,u.isValid],children:([u,d,h,m])=>f.jsxs(mt,{type:"submit",size:"sm",disabled:i||!u||d||h||!m,children:[(d||h)&&f.jsx(Xn,{className:"h-4 w-4 mr-1 animate-spin"}),f.jsx($u,{className:"h-4 w-4 mr-1"}),d||h?"Saving...":"Save API Key"]})})]})]})},PLe=({className:e,label:t,selectedKeyId:n,onKeySelected:r,apiKeys:s,disabled:i=!1})=>{var c;const a=u=>{r(u==="none"?null:u)},o=(c=s.find(u=>u.id===n))==null?void 0:c.name,l=n?o||`Key ID: ${n.substring(0,6)}...`:"None";return f.jsxs(tp,{value:n??"none",onValueChange:a,disabled:i||s.length===0,children:[f.jsx(rp,{className:Xe("w-full h-9 text-sm bg-background border-border text-foreground",e),"aria-label":t||"Select API Key",children:f.jsx(np,{asChild:!0,children:f.jsxs("div",{className:"flex items-center overflow-hidden",children:[f.jsx(Hx,{className:"h-3 w-3 mr-1.5 text-muted-foreground flex-shrink-0"}),f.jsxs("span",{className:"truncate flex-grow text-left",children:[t&&f.jsxs("span",{className:"mr-1",children:[t,":"]}),s.length===0?f.jsx("span",{className:"text-muted-foreground",children:"No keys available"}):l]})]})})}),f.jsxs(sp,{className:"bg-popover border-border text-popover-foreground",children:[f.jsx(Ro,{value:"none",children:f.jsx("span",{className:"text-muted-foreground",children:"None"})}),s.map(u=>f.jsx(Ro,{value:u.id,children:u.name||`Key ID: ${u.id.substring(0,6)}...`},u.id))]})]})};function Gw({form:e,name:t,label:n,type:r="text",placeholder:s,disabled:i,wrapperClassName:a,className:o,...l}){return f.jsx(e.Field,{name:t,children:c=>{const u=typeof c.state.value=="string"||typeof c.state.value=="number"?String(c.state.value):"";return f.jsxs("div",{className:Xe("space-y-1.5",a),children:[f.jsx(Ot,{htmlFor:c.name,className:"text-sm",children:n}),f.jsx(Cn,{id:c.name,name:c.name,type:r,value:u,onBlur:c.handleBlur,onChange:d=>c.handleChange(d.target.value),placeholder:s,disabled:i??c.form.state.isSubmitting,className:Xe(o,c.state.meta.errors.length?"border-destructive":""),...l}),f.jsx(ji,{field:c})]})}})}function Ox({form:e,name:t,label:n,options:r,placeholder:s,disabled:i,wrapperClassName:a,triggerClassName:o,contentClassName:l,...c}){return f.jsx(e.Field,{name:t,children:u=>{const d=u.state.value!==null&&u.state.value!==void 0?String(u.state.value):"";return f.jsxs("div",{className:Xe("space-y-1.5",a),children:[f.jsx(Ot,{htmlFor:u.name,className:"text-sm",children:n}),f.jsxs(tp,{value:d,onValueChange:h=>u.handleChange(h),disabled:i??u.form.state.isSubmitting,...c,children:[f.jsx(rp,{id:u.name,onBlur:u.handleBlur,className:Xe(o,u.state.meta.errors.length?"border-destructive":""),children:f.jsx(np,{placeholder:s})}),f.jsx(sp,{className:l,children:r.map(h=>f.jsx(Ro,{value:String(h.value),disabled:h.disabled,children:h.label},h.value))})]}),f.jsx(ji,{field:u})]})}})}var DLe=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],xte=DLe.reduce((e,t)=>{const n=Mu(`Primitive.${t}`),r=E.forwardRef((s,i)=>{const{asChild:a,...o}=s,l=a?n:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),f.jsx(l,{...o,ref:i})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{}),jT="Switch",[FLe,_dt]=Ki(jT),[LLe,BLe]=FLe(jT),wte=E.forwardRef((e,t)=>{const{__scopeSwitch:n,name:r,checked:s,defaultChecked:i,required:a,disabled:o,value:l="on",onCheckedChange:c,form:u,...d}=e,[h,m]=E.useState(null),y=Mn(t,S=>m(S)),b=E.useRef(!1),v=h?u||!!h.closest("form"):!0,[x,w]=Fc({prop:s,defaultProp:i??!1,onChange:c,caller:jT});return f.jsxs(LLe,{scope:n,checked:x,disabled:o,children:[f.jsx(xte.button,{type:"button",role:"switch","aria-checked":x,"aria-required":a,"data-state":kte(x),"data-disabled":o?"":void 0,disabled:o,value:l,...d,ref:y,onClick:Wt(e.onClick,S=>{w(k=>!k),v&&(b.current=S.isPropagationStopped(),b.current||S.stopPropagation())})}),v&&f.jsx(Cte,{control:h,bubbles:!b.current,name:r,value:l,checked:x,required:a,disabled:o,form:u,style:{transform:"translateX(-100%)"}})]})});wte.displayName=jT;var _te="SwitchThumb",Ste=E.forwardRef((e,t)=>{const{__scopeSwitch:n,...r}=e,s=BLe(_te,n);return f.jsx(xte.span,{"data-state":kte(s.checked),"data-disabled":s.disabled?"":void 0,...r,ref:t})});Ste.displayName=_te;var $Le="SwitchBubbleInput",Cte=E.forwardRef(({__scopeSwitch:e,control:t,checked:n,bubbles:r=!0,...s},i)=>{const a=E.useRef(null),o=Mn(a,i),l=TT(n),c=Ky(t);return E.useEffect(()=>{const u=a.current;if(!u)return;const d=window.HTMLInputElement.prototype,m=Object.getOwnPropertyDescriptor(d,"checked").set;if(l!==n&&m){const y=new Event("click",{bubbles:r});m.call(u,n),u.dispatchEvent(y)}},[l,n,r]),f.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:n,...s,tabIndex:-1,ref:o,style:{...s.style,...c,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});Cte.displayName=$Le;function kte(e){return e?"checked":"unchecked"}var zLe=wte,ULe=Ste;function Oo({className:e,...t}){return f.jsx(zLe,{"data-slot":"switch",className:Xe("peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",e),...t,children:f.jsx(ULe,{"data-slot":"switch-thumb",className:Xe("bg-background dark:data-[state=unchecked]:bg-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0")})})}function em({form:e,name:t,label:n,description:r,disabled:s,wrapperClassName:i,className:a,labelClassName:o,...l}){return f.jsx(e.Field,{name:t,children:c=>{const u=typeof c.state.value=="boolean"?c.state.value:!1;return f.jsxs("div",{className:Xe("space-y-1.5",i),children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx(Ot,{htmlFor:c.name,className:Xe("text-sm font-medium leading-none cursor-pointer",o),children:n}),f.jsx(Oo,{id:c.name,name:c.name,checked:u,onCheckedChange:d=>c.handleChange(d),onBlur:c.handleBlur,disabled:s??c.form.state.isSubmitting,className:Xe(a,c.state.meta.errors.length?"border-destructive":""),...l})]}),r&&f.jsx("p",{className:"text-xs text-muted-foreground pt-1",children:r}),f.jsx(ji,{field:c})]})}})}const qLe=Co.map(e=>e.value),VLe=Ke({name:ze().min(1,"Provider Name is required."),type:xl(qLe,{errorMap:()=>({message:"Provider Type is required."})}),isEnabled:Kn(),apiKeyId:ze().nullable(),baseURL:ze().url().nullable().or(Nn("")),autoFetchModels:Kn()}).refine(e=>OC(e.type)?!(!e.baseURL||e.baseURL.trim()===""):!0,{message:"Base URL is required and must be a valid URL for this provider type.",path:["baseURL"]}).refine(e=>sy(e.type)?!!e.apiKeyId:!0,{message:"API Key is required for this provider type.",path:["apiKeyId"]}),WLe=Co.map(e=>({value:e.value,label:e.label})),Ete=({initialData:e,onSubmit:t,onChange:n,onCancel:r,apiKeys:s,isSavingExt:i=!1,disabled:a=!1,className:o})=>{var v;const l=ii({defaultValues:{name:(e==null?void 0:e.name)||"",type:(e==null?void 0:e.type)||((v=Co[0])==null?void 0:v.value),isEnabled:(e==null?void 0:e.isEnabled)??!0,apiKeyId:(e==null?void 0:e.apiKeyId)||null,baseURL:(e==null?void 0:e.baseURL)||null,autoFetchModels:(e==null?void 0:e.autoFetchModels)??!1},validators:{onChangeAsync:VLe,onChangeAsyncDebounceMs:500},onSubmit:async({value:x})=>{const w={...x,baseURL:(x.baseURL===null||typeof x.baseURL=="string"&&x.baseURL.trim()==="")&&!OC(x.type)?null:x.baseURL};await t(w)}}),c=E.useRef(l.state.values);E.useEffect(()=>{const x=l.store.subscribe(()=>{const w=l.state.values,S=c.current;if(n&&S)for(const k in w){const C=k;w[C]!==S[C]&&n(C,w[C])}c.current={...w}});return l.state.values!==c.current&&(c.current=l.state.values),x},[l,n]),E.useEffect(()=>{var S,k;const x=(e==null?void 0:e.type)||((S=Co[0])==null?void 0:S.value),w={name:(e==null?void 0:e.name)||((k=Co.find(C=>C.value===x))==null?void 0:k.label)||"",type:x,isEnabled:(e==null?void 0:e.isEnabled)??!0,apiKeyId:(e==null?void 0:e.apiKeyId)||null,baseURL:(e==null?void 0:e.baseURL)||null,autoFetchModels:(e==null?void 0:e.autoFetchModels)??hm(x)};l.reset(w),c.current=w},[e]);const u=l.state.values.type,d=sy(u??null),h=OC(u??null),m=hm(u??null),y=E.useCallback(x=>{var S,k;if(!x)return;const w=l.state.values.type;if(x!==w){l.setFieldValue("apiKeyId",null),l.setFieldValue("baseURL",null),l.setFieldValue("autoFetchModels",hm(x));const C=(S=Co.find(N=>N.value===x))==null?void 0:S.label,T=(k=Co.find(N=>N.value===w))==null?void 0:k.label,R=l.state.values.name;C&&(!(R!=null&&R.trim())||R===T)&&l.setFieldValue("name",C)}},[l]);E.useEffect(()=>{const x=l.state.values.type;x!==void 0&&y(x)},[l.state.values.type,y]);const b=(s||[]).filter(x=>!u||x.providerId===u);return f.jsxs("form",{onSubmit:x=>{x.preventDefault(),x.stopPropagation(),l.handleSubmit()},className:Xe("space-y-4 border rounded-md p-4 bg-card shadow-sm",o),children:[f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-4 gap-y-3",children:[f.jsx(Ox,{form:l,name:"type",label:"Provider Type",options:WLe,disabled:a||i,placeholder:"Select Type",wrapperClassName:"md:col-span-1"}),f.jsx(Gw,{form:l,name:"name",label:"Provider Name",placeholder:"e.g., My Ollama",disabled:a||i,"aria-label":"Provider Name",wrapperClassName:"md:col-span-1"}),d&&f.jsx(l.Field,{name:"apiKeyId",children:x=>f.jsxs("div",{className:"space-y-1.5 md:col-span-2",children:[f.jsx(Ot,{htmlFor:`${x.name}-trigger`,children:"API Key"})," ",f.jsx(PLe,{selectedKeyId:x.state.value??null,onKeySelected:w=>{x.handleChange(w),x.handleBlur()},apiKeys:b,disabled:a||i||!u}),f.jsx(ji,{field:x})]})}),h&&f.jsx(Gw,{form:l,name:"baseURL",label:"Base URL",placeholder:"e.g., http://localhost:11434",type:"url",disabled:a||i||!u,wrapperClassName:"md:col-span-2"}),m&&f.jsx(em,{form:l,name:"autoFetchModels",label:"Auto-Fetch Models",description:"Automatically fetch and update the list of available models from this provider.",disabled:a||i||!u,wrapperClassName:"md:col-span-2"}),f.jsx(em,{form:l,name:"isEnabled",label:"Enable Provider",description:"Allow this provider to be used for generating responses.",disabled:a||i,wrapperClassName:"md:col-span-2"})]}),f.jsxs("div",{className:"flex justify-end space-x-2 pt-2",children:[f.jsxs(mt,{variant:"ghost",size:"sm",onClick:r,disabled:a||i,type:"button",children:[f.jsx(Oi,{className:"h-4 w-4 mr-1"})," Cancel"]}),f.jsx(l.Subscribe,{selector:x=>[x.canSubmit,x.isSubmitting,x.isValidating,x.isValid],children:([x,w,S,k])=>f.jsxs(mt,{type:"submit",size:"sm",disabled:a||i||!x||w||!k||S,children:[(i||w||S)&&f.jsx(Xn,{className:"h-4 w-4 mr-1 animate-spin"}),f.jsx($u,{className:"h-4 w-4 mr-1"})," ",i||w||S?"Saving...":e!=null&&e.name?"Save Changes":"Add Provider"]})})]})]})},Tte=({apiKeys:e,onAddProvider:t,onCancel:n,initialType:r="openai",initialName:s="",initialApiKeyId:i=null})=>{const[a,o]=E.useState(!1),[l,c]=E.useState({name:s,type:r,isEnabled:!0,apiKeyId:i,baseURL:null,autoFetchModels:hm(r)});E.useEffect(()=>{c(h=>({...h,name:s||h.name||"",type:r||h.type||null,apiKeyId:i||h.apiKeyId||null,autoFetchModels:!1}))},[s,r,i]);const u=E.useCallback((h,m)=>new Promise(y=>{c(b=>{var w,S;const v={...b,[h]:m},x=b.name||"";if(h==="type"){const k=m,C=(w=Co.find(R=>R.value===b.type))==null?void 0:w.label;v.apiKeyId=null,v.baseURL=null,v.autoFetchModels=k?hm(k):!1;const T=(S=Co.find(R=>R.value===k))==null?void 0:S.label;if(T&&(!x.trim()||x===C)&&(v.name=T),k&&sy(k)){const R=(e||[]).filter(N=>N.providerId===k);R.length>0&&(v.apiKeyId=R[0].id)}}return v}),y(void 0)}),[e]),d=E.useCallback(async()=>{var h,m;if(!((h=l.name)!=null&&h.trim())||!l.type){Me.error("Provider Name and Type are required.");return}o(!0);try{const y=l.type,b=l.autoFetchModels??hm(y),v={name:l.name.trim(),type:y,isEnabled:l.isEnabled??!0,apiKeyId:l.apiKeyId??null,baseURL:((m=l.baseURL)==null?void 0:m.trim())||null,enabledModels:null,autoFetchModels:b,fetchedModels:null,modelsLastFetchedAt:null};await t(v),n()}catch(y){console.error("Failed to add provider (from form component):",y)}finally{o(!1)}},[l,t,n]);return f.jsxs("div",{className:"border border-primary rounded-md p-4 space-y-3 bg-card shadow-lg flex-shrink-0",children:[f.jsx("h4",{className:"font-semibold text-card-foreground",children:"Add New Provider"}),f.jsx(Ete,{initialData:l,onSubmit:d,onCancel:n,onChange:u,apiKeys:e,disabled:a})]})},Ad=Ve.forwardRef(({className:e,href:t,children:n,...r},s)=>f.jsx("a",{ref:s,href:t,target:"_blank",rel:"noopener noreferrer",className:Xe("font-medium text-primary underline-offset-4 hover:underline focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...r,children:n}));Ad.displayName="Lnk";const HLe=e=>{const{size:t=24,color:n="currentColor",...r}=e;return f.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:t,height:t,viewBox:"0 0 512 512",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",...r,children:[f.jsx("g",{transform:"translate(0.000000,512.000000) scale(0.100000,-0.100000)",fill:n,stroke:"none",children:f.jsx("path",{d:`M2310 5053 c-1035 -101 -1883 -794 -2159 -1764 -55 -194 -79 -338
-91 -552 -18 -323 20 -620 117 -907 92 -272 238 -543 404 -747 33 -39 59 -75
59 -78 0 -4 -49 -129 -109 -279 -252 -624 -251 -621 -196 -676 57 -56 73 -53
351 58 137 55 349 143 472 195 l223 95 77 -38 c221 -109 437 -179 680 -219
132 -23 411 -44 475 -37 23 3 85 8 137 11 404 26 806 168 1180 417 282 188
571 489 759 792 400 642 467 1498 174 2216 -179 439 -495 826 -888 1088 -361
239 -743 378 -1165 422 -88 9 -419 11 -500 3z m404 -463 c-1 -30 -17 -128 -36
-217 l-34 -163 137 0 c128 0 139 -1 149 -20 11 -21 4 -44 -22 -72 -7 -7 -68
-75 -135 -150 l-123 -136 0 -175 0 -175 238 -4 c265 -5 329 -16 469 -82 220
-105 414 -311 486 -519 l24 -68 86 -4 c129 -7 195 -43 236 -130 20 -42 21 -61
21 -300 0 -240 -1 -258 -21 -297 -46 -90 -115 -127 -235 -128 l-82 0 -11 -47
c-17 -66 -71 -179 -119 -250 -108 -159 -276 -293 -452 -361 -174 -66 -251 -72
-830 -63 l-475 8 -89 27 c-303 91 -554 328 -650 614 l-23 67 -89 5 c-98 6
-131 20 -180 72 -63 66 -64 72 -64 354 0 240 1 261 21 301 40 84 105 119 232
129 l84 7 32 80 c84 215 291 424 513 519 126 53 225 68 466 68 l212 0 0 268 0
267 -126 -3 c-108 -3 -129 -1 -145 14 -10 9 -19 25 -19 35 0 9 111 146 246
304 234 273 247 286 277 283 32 -3 32 -3 31 -58z`})}),f.jsxs("g",{transform:"translate(165, 220) scale(2.5)",children:[f.jsx("path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",fill:"none",stroke:n,strokeWidth:"4"}),f.jsx("circle",{cx:"12",cy:"12",r:"3",fill:"none",stroke:n,strokeWidth:"4"})]}),f.jsxs("g",{transform:"translate(290, 220) scale(2.5)",children:[f.jsx("path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",fill:"none",stroke:n,strokeWidth:"4"}),f.jsx("circle",{cx:"12",cy:"12",r:"3",fill:"none",stroke:n,strokeWidth:"4"})]}),f.jsx("g",{transform:"translate(0.000000,512.000000) scale(0.100000,-0.100000)",fill:n,stroke:"none",children:f.jsx("path",{d:`M2147 1999 c-26 -15 -48 -65 -41 -94 15 -61 181 -167 304 -196 30 -7
100 -12 155 -12 81 1 115 6 178 27 135 45 247 133 249 194 2 60 -48 103 -104
88 -13 -3 -50 -25 -83 -50 -85 -64 -172 -90 -280 -84 -92 6 -165 35 -259 103
-49 35 -86 43 -119 24z`})})]})},GLe=LO("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function is({className:e,variant:t,asChild:n=!1,...r}){const s=n?nH:"span";return f.jsx(s,{"data-slot":"badge",className:Xe(GLe({variant:t}),e),...r})}const KLe=()=>{const[e,t]=E.useState(!1);E.useEffect(()=>{t(!0)},[]);const n={hidden:{opacity:0},show:{opacity:1,transition:{staggerChildren:.2,delayChildren:.3}}},r={hidden:{opacity:0,y:20},show:{opacity:1,y:0,transition:{duration:.5}}},s=[{word:"LiteChat",color:"bg-gradient-to-tr from-lime-500 via-amber-400 to-red-600 bg-clip-text text-transparent"},{word:"library",color:"text-emerald-500"},{word:"browser",color:"text-violet-500"},{word:"local",color:"text-amber-500"},{word:"remote",color:"text-sky-500"},{word:"providers",color:"text-purple-500"},{word:" AI ",color:"bg-gradient-to-b from-amber-300 to-rose-700 bg-clip-text text-transparent"},{word:"Open Source",color:"bg-gradient-to-r from-lime-500 to-yellow-500 bg-clip-text text-transparent"}],i=o=>{let l=[o];return s.forEach(({word:c,color:u})=>{l=l.reduce((d,h)=>typeof h!="string"?(d.push(h),d):(h.split(new RegExp(`(${c})`,"gi")).forEach((y,b)=>{y.toLowerCase()===c.toLowerCase()?d.push(f.jsx("span",{className:`${u} font-medium`,children:y},`${y}-${b}`)):d.push(y)}),d),[])}),l=l.reduce((c,u,d)=>{if(typeof u!="string")return c.push(u),c;const h=/(\([^)]*\))/g;return u.split(h).forEach((y,b)=>{h.test(y)?c.push(f.jsx("span",{className:"text-sm text-muted",children:y},`paren-${d}-${b}`)):c.push(y)}),c},[]),l},a=["Oh, hey?! Hi there!! How are you doing!?","Nice of you to pop by to checkout LiteChat!","What'd you mean you don't know what LiteChat is? Oh Boy hey, you in for a treat!","To start with, it's an(other) AI chat app (yes...shocker, right ?) and it's Open Source ! ","But, it is also an extensible library, so you can go on and create your own, AI chat app! With your own functionnalities !","(are AI chat apps the new JS frameworks?)","And cause I might be a wee bit on the reluctant side when it comes to parting with my coins, it doesn't require no servers! It all stays in your browser.","(that means I couldn't snoop on what you do here, even if I wanted to!)","While able to run LLM both local (did I tell you I ain't liking throwing coins out?) and from remote providers","(but sometimes you have to :(..)","To cap things off, there is no fancy/crazy tech involved, I just glued bricks together with AI","(kids call it vibing apparently ^^)","Enough of this interminable babble! Go setup your future chat to prompt your brains out!"];return f.jsxs(mu.div,{className:"text-center max-w-4xl mx-auto space-y-3 my-6",initial:"hidden",animate:e?"show":"hidden",variants:n,children:[f.jsx("div",{className:"flex justify-center mb-4",children:f.jsxs(is,{variant:"outline",className:"px-3 py-1 bg-black/5 dark:bg-white/10 backdrop-blur-sm border-none",children:[f.jsx(kH,{className:"w-4 h-4 mr-2 text-yellow-500"}),f.jsx("span",{className:"text-sm",children:"Welcome to your future AI chat"})]})}),a.map((o,l)=>f.jsx(mu.p,{className:`text-sm md:text-base ${l===0?"font-medium":""} leading-relaxed`,variants:r,children:i(o)},l)),f.jsxs(mu.div,{variants:r,className:"pt-2",children:[f.jsx(is,{className:"bg-gradient-to-r from-violet-600 to-primary border-none",children:"No server required!"}),f.jsx(is,{className:"ml-2 bg-gradient-to-r from-amber-500 to-emerald-500 border-none",children:"100% in-browser"})]})]})};var T6="Progress",A6=100,[YLe,Sdt]=Ki(T6),[ZLe,XLe]=YLe(T6),Ate=E.forwardRef((e,t)=>{const{__scopeProgress:n,value:r=null,max:s,getValueLabel:i=JLe,...a}=e;(s||s===0)&&!tq(s)&&console.error(QLe(`${s}`,"Progress"));const o=tq(s)?s:A6;r!==null&&!nq(r,o)&&console.error(eBe(`${r}`,"Progress"));const l=nq(r,o)?r:null,c=Sk(l)?i(l,o):void 0;return f.jsx(ZLe,{scope:n,value:l,max:o,children:f.jsx(lr.div,{"aria-valuemax":o,"aria-valuemin":0,"aria-valuenow":Sk(l)?l:void 0,"aria-valuetext":c,role:"progressbar","data-state":Mte(l,o),"data-value":l??void 0,"data-max":o,...a,ref:t})})});Ate.displayName=T6;var Rte="ProgressIndicator",Nte=E.forwardRef((e,t)=>{const{__scopeProgress:n,...r}=e,s=XLe(Rte,n);return f.jsx(lr.div,{"data-state":Mte(s.value,s.max),"data-value":s.value??void 0,"data-max":s.max,...r,ref:t})});Nte.displayName=Rte;function JLe(e,t){return`${Math.round(e/t*100)}%`}function Mte(e,t){return e==null?"indeterminate":e===t?"complete":"loading"}function Sk(e){return typeof e=="number"}function tq(e){return Sk(e)&&!isNaN(e)&&e>0}function nq(e,t){return Sk(e)&&!isNaN(e)&&e<=t&&e>=0}function QLe(e,t){return`Invalid prop \`max\` of value \`${e}\` supplied to \`${t}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${A6}\`.`}function eBe(e,t){return`Invalid prop \`value\` of value \`${e}\` supplied to \`${t}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${A6} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var Ite=Ate,tBe=Nte;const ky=E.forwardRef(({className:e,value:t,...n},r)=>f.jsx(Ite,{ref:r,className:Xe("relative h-4 w-full overflow-hidden rounded-full bg-secondary",e),...n,children:f.jsx(tBe,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(t||0)}%)`}})}));ky.displayName=Ite.displayName;function a0(e,t,n){let r=n.initialDeps??[],s;function i(){var a,o,l,c;let u;n.key&&((a=n.debug)!=null&&a.call(n))&&(u=Date.now());const d=e();if(!(d.length!==r.length||d.some((y,b)=>r[b]!==y)))return s;r=d;let m;if(n.key&&((o=n.debug)!=null&&o.call(n))&&(m=Date.now()),s=t(...d),n.key&&((l=n.debug)!=null&&l.call(n))){const y=Math.round((Date.now()-u)*100)/100,b=Math.round((Date.now()-m)*100)/100,v=b/16,x=(w,S)=>{for(w=String(w);w.length<S;)w=" "+w;return w};console.info(`%c ${x(b,5)} /${x(y,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*v,120))}deg 100% 31%);`,n==null?void 0:n.key)}return(c=n==null?void 0:n.onChange)==null||c.call(n,s),s}return i.updateDeps=a=>{r=a},i}function t3(e,t){if(e===void 0)throw new Error("Unexpected undefined");return e}const nBe=(e,t)=>Math.abs(e-t)<=1,rBe=(e,t,n)=>{let r;return function(...s){e.clearTimeout(r),r=e.setTimeout(()=>t.apply(this,s),n)}},rq=e=>{const{offsetWidth:t,offsetHeight:n}=e;return{width:t,height:n}},sBe=e=>e,iBe=e=>{const t=Math.max(e.startIndex-e.overscan,0),n=Math.min(e.endIndex+e.overscan,e.count-1),r=[];for(let s=t;s<=n;s++)r.push(s);return r},aBe=(e,t)=>{const n=e.scrollElement;if(!n)return;const r=e.targetWindow;if(!r)return;const s=a=>{const{width:o,height:l}=a;t({width:Math.round(o),height:Math.round(l)})};if(s(rq(n)),!r.ResizeObserver)return()=>{};const i=new r.ResizeObserver(a=>{const o=()=>{const l=a[0];if(l!=null&&l.borderBoxSize){const c=l.borderBoxSize[0];if(c){s({width:c.inlineSize,height:c.blockSize});return}}s(rq(n))};e.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(o):o()});return i.observe(n,{box:"border-box"}),()=>{i.unobserve(n)}},sq={passive:!0},iq=typeof window>"u"?!0:"onscrollend"in window,oBe=(e,t)=>{const n=e.scrollElement;if(!n)return;const r=e.targetWindow;if(!r)return;let s=0;const i=e.options.useScrollendEvent&&iq?()=>{}:rBe(r,()=>{t(s,!1)},e.options.isScrollingResetDelay),a=u=>()=>{const{horizontal:d,isRtl:h}=e.options;s=d?n.scrollLeft*(h&&-1||1):n.scrollTop,i(),t(s,u)},o=a(!0),l=a(!1);l(),n.addEventListener("scroll",o,sq);const c=e.options.useScrollendEvent&&iq;return c&&n.addEventListener("scrollend",l,sq),()=>{n.removeEventListener("scroll",o),c&&n.removeEventListener("scrollend",l)}},lBe=(e,t,n)=>{if(t!=null&&t.borderBoxSize){const r=t.borderBoxSize[0];if(r)return Math.round(r[n.options.horizontal?"inlineSize":"blockSize"])}return e[n.options.horizontal?"offsetWidth":"offsetHeight"]},cBe=(e,{adjustments:t=0,behavior:n},r)=>{var s,i;const a=e+t;(i=(s=r.scrollElement)==null?void 0:s.scrollTo)==null||i.call(s,{[r.options.horizontal?"left":"top"]:a,behavior:n})};class uBe{constructor(t){this.unsubs=[],this.scrollElement=null,this.targetWindow=null,this.isScrolling=!1,this.scrollToIndexTimeoutId=null,this.measurementsCache=[],this.itemSizeCache=new Map,this.pendingMeasuredCacheIndexes=[],this.scrollRect=null,this.scrollOffset=null,this.scrollDirection=null,this.scrollAdjustments=0,this.elementsCache=new Map,this.observer=(()=>{let n=null;const r=()=>n||(!this.targetWindow||!this.targetWindow.ResizeObserver?null:n=new this.targetWindow.ResizeObserver(s=>{s.forEach(i=>{const a=()=>{this._measureElement(i.target,i)};this.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(a):a()})}));return{disconnect:()=>{var s;(s=r())==null||s.disconnect(),n=null},observe:s=>{var i;return(i=r())==null?void 0:i.observe(s,{box:"border-box"})},unobserve:s=>{var i;return(i=r())==null?void 0:i.unobserve(s)}}})(),this.range=null,this.setOptions=n=>{Object.entries(n).forEach(([r,s])=>{typeof s>"u"&&delete n[r]}),this.options={debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:sBe,rangeExtractor:iBe,onChange:()=>{},measureElement:lBe,initialRect:{width:0,height:0},scrollMargin:0,gap:0,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1,isScrollingResetDelay:150,enabled:!0,isRtl:!1,useScrollendEvent:!1,useAnimationFrameWithResizeObserver:!1,...n}},this.notify=n=>{var r,s;(s=(r=this.options).onChange)==null||s.call(r,this,n)},this.maybeNotify=a0(()=>(this.calculateRange(),[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]),n=>{this.notify(n)},{key:!1,debug:()=>this.options.debug,initialDeps:[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]}),this.cleanup=()=>{this.unsubs.filter(Boolean).forEach(n=>n()),this.unsubs=[],this.observer.disconnect(),this.scrollElement=null,this.targetWindow=null},this._didMount=()=>()=>{this.cleanup()},this._willUpdate=()=>{var n;const r=this.options.enabled?this.options.getScrollElement():null;if(this.scrollElement!==r){if(this.cleanup(),!r){this.maybeNotify();return}this.scrollElement=r,this.scrollElement&&"ownerDocument"in this.scrollElement?this.targetWindow=this.scrollElement.ownerDocument.defaultView:this.targetWindow=((n=this.scrollElement)==null?void 0:n.window)??null,this.elementsCache.forEach(s=>{this.observer.observe(s)}),this._scrollToOffset(this.getScrollOffset(),{adjustments:void 0,behavior:void 0}),this.unsubs.push(this.options.observeElementRect(this,s=>{this.scrollRect=s,this.maybeNotify()})),this.unsubs.push(this.options.observeElementOffset(this,(s,i)=>{this.scrollAdjustments=0,this.scrollDirection=i?this.getScrollOffset()<s?"forward":"backward":null,this.scrollOffset=s,this.isScrolling=i,this.maybeNotify()}))}},this.getSize=()=>this.options.enabled?(this.scrollRect=this.scrollRect??this.options.initialRect,this.scrollRect[this.options.horizontal?"width":"height"]):(this.scrollRect=null,0),this.getScrollOffset=()=>this.options.enabled?(this.scrollOffset=this.scrollOffset??(typeof this.options.initialOffset=="function"?this.options.initialOffset():this.options.initialOffset),this.scrollOffset):(this.scrollOffset=null,0),this.getFurthestMeasurement=(n,r)=>{const s=new Map,i=new Map;for(let a=r-1;a>=0;a--){const o=n[a];if(s.has(o.lane))continue;const l=i.get(o.lane);if(l==null||o.end>l.end?i.set(o.lane,o):o.end<l.end&&s.set(o.lane,!0),s.size===this.options.lanes)break}return i.size===this.options.lanes?Array.from(i.values()).sort((a,o)=>a.end===o.end?a.index-o.index:a.end-o.end)[0]:void 0},this.getMeasurementOptions=a0(()=>[this.options.count,this.options.paddingStart,this.options.scrollMargin,this.options.getItemKey,this.options.enabled],(n,r,s,i,a)=>(this.pendingMeasuredCacheIndexes=[],{count:n,paddingStart:r,scrollMargin:s,getItemKey:i,enabled:a}),{key:!1}),this.getMeasurements=a0(()=>[this.getMeasurementOptions(),this.itemSizeCache],({count:n,paddingStart:r,scrollMargin:s,getItemKey:i,enabled:a},o)=>{if(!a)return this.measurementsCache=[],this.itemSizeCache.clear(),[];this.measurementsCache.length===0&&(this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach(u=>{this.itemSizeCache.set(u.key,u.size)}));const l=this.pendingMeasuredCacheIndexes.length>0?Math.min(...this.pendingMeasuredCacheIndexes):0;this.pendingMeasuredCacheIndexes=[];const c=this.measurementsCache.slice(0,l);for(let u=l;u<n;u++){const d=i(u),h=this.options.lanes===1?c[u-1]:this.getFurthestMeasurement(c,u),m=h?h.end+this.options.gap:r+s,y=o.get(d),b=typeof y=="number"?y:this.options.estimateSize(u),v=m+b,x=h?h.lane:u%this.options.lanes;c[u]={index:u,start:m,size:b,end:v,key:d,lane:x}}return this.measurementsCache=c,c},{key:!1,debug:()=>this.options.debug}),this.calculateRange=a0(()=>[this.getMeasurements(),this.getSize(),this.getScrollOffset(),this.options.lanes],(n,r,s,i)=>this.range=n.length>0&&r>0?dBe({measurements:n,outerSize:r,scrollOffset:s,lanes:i}):null,{key:!1,debug:()=>this.options.debug}),this.getVirtualIndexes=a0(()=>{let n=null,r=null;const s=this.calculateRange();return s&&(n=s.startIndex,r=s.endIndex),this.maybeNotify.updateDeps([this.isScrolling,n,r]),[this.options.rangeExtractor,this.options.overscan,this.options.count,n,r]},(n,r,s,i,a)=>i===null||a===null?[]:n({startIndex:i,endIndex:a,overscan:r,count:s}),{key:!1,debug:()=>this.options.debug}),this.indexFromElement=n=>{const r=this.options.indexAttribute,s=n.getAttribute(r);return s?parseInt(s,10):(console.warn(`Missing attribute name '${r}={index}' on measured element.`),-1)},this._measureElement=(n,r)=>{const s=this.indexFromElement(n),i=this.measurementsCache[s];if(!i)return;const a=i.key,o=this.elementsCache.get(a);o!==n&&(o&&this.observer.unobserve(o),this.observer.observe(n),this.elementsCache.set(a,n)),n.isConnected&&this.resizeItem(s,this.options.measureElement(n,r,this))},this.resizeItem=(n,r)=>{const s=this.measurementsCache[n];if(!s)return;const i=this.itemSizeCache.get(s.key)??s.size,a=r-i;a!==0&&((this.shouldAdjustScrollPositionOnItemSizeChange!==void 0?this.shouldAdjustScrollPositionOnItemSizeChange(s,a,this):s.start<this.getScrollOffset()+this.scrollAdjustments)&&this._scrollToOffset(this.getScrollOffset(),{adjustments:this.scrollAdjustments+=a,behavior:void 0}),this.pendingMeasuredCacheIndexes.push(s.index),this.itemSizeCache=new Map(this.itemSizeCache.set(s.key,r)),this.notify(!1))},this.measureElement=n=>{if(!n){this.elementsCache.forEach((r,s)=>{r.isConnected||(this.observer.unobserve(r),this.elementsCache.delete(s))});return}this._measureElement(n,void 0)},this.getVirtualItems=a0(()=>[this.getVirtualIndexes(),this.getMeasurements()],(n,r)=>{const s=[];for(let i=0,a=n.length;i<a;i++){const o=n[i],l=r[o];s.push(l)}return s},{key:!1,debug:()=>this.options.debug}),this.getVirtualItemForOffset=n=>{const r=this.getMeasurements();if(r.length!==0)return t3(r[jte(0,r.length-1,s=>t3(r[s]).start,n)])},this.getOffsetForAlignment=(n,r,s=0)=>{const i=this.getSize(),a=this.getScrollOffset();r==="auto"&&(r=n>=a+i?"end":"start"),r==="center"?n+=(s-i)/2:r==="end"&&(n-=i);const o=this.getTotalSize()-i;return Math.max(Math.min(o,n),0)},this.getOffsetForIndex=(n,r="auto")=>{n=Math.max(0,Math.min(n,this.options.count-1));const s=this.measurementsCache[n];if(!s)return;const i=this.getSize(),a=this.getScrollOffset();if(r==="auto")if(s.end>=a+i-this.options.scrollPaddingEnd)r="end";else if(s.start<=a+this.options.scrollPaddingStart)r="start";else return[a,r];const o=r==="end"?s.end+this.options.scrollPaddingEnd:s.start-this.options.scrollPaddingStart;return[this.getOffsetForAlignment(o,r,s.size),r]},this.isDynamicMode=()=>this.elementsCache.size>0,this.cancelScrollToIndex=()=>{this.scrollToIndexTimeoutId!==null&&this.targetWindow&&(this.targetWindow.clearTimeout(this.scrollToIndexTimeoutId),this.scrollToIndexTimeoutId=null)},this.scrollToOffset=(n,{align:r="start",behavior:s}={})=>{this.cancelScrollToIndex(),s==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getOffsetForAlignment(n,r),{adjustments:void 0,behavior:s})},this.scrollToIndex=(n,{align:r="auto",behavior:s}={})=>{n=Math.max(0,Math.min(n,this.options.count-1)),this.cancelScrollToIndex(),s==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size.");const i=this.getOffsetForIndex(n,r);if(!i)return;const[a,o]=i;this._scrollToOffset(a,{adjustments:void 0,behavior:s}),s!=="smooth"&&this.isDynamicMode()&&this.targetWindow&&(this.scrollToIndexTimeoutId=this.targetWindow.setTimeout(()=>{if(this.scrollToIndexTimeoutId=null,this.elementsCache.has(this.options.getItemKey(n))){const[c]=t3(this.getOffsetForIndex(n,o)),u=this.getScrollOffset();nBe(c,u)||this.scrollToIndex(n,{align:o,behavior:s})}else this.scrollToIndex(n,{align:o,behavior:s})}))},this.scrollBy=(n,{behavior:r}={})=>{this.cancelScrollToIndex(),r==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getScrollOffset()+n,{adjustments:void 0,behavior:r})},this.getTotalSize=()=>{var n;const r=this.getMeasurements();let s;if(r.length===0)s=this.options.paddingStart;else if(this.options.lanes===1)s=((n=r[r.length-1])==null?void 0:n.end)??0;else{const i=Array(this.options.lanes).fill(null);let a=r.length-1;for(;a>=0&&i.some(o=>o===null);){const o=r[a];i[o.lane]===null&&(i[o.lane]=o.end),a--}s=Math.max(...i.filter(o=>o!==null))}return Math.max(s-this.options.scrollMargin+this.options.paddingEnd,0)},this._scrollToOffset=(n,{adjustments:r,behavior:s})=>{this.options.scrollToFn(n,{behavior:s,adjustments:r},this)},this.measure=()=>{this.itemSizeCache=new Map,this.notify(!1)},this.setOptions(t)}}const jte=(e,t,n,r)=>{for(;e<=t;){const s=(e+t)/2|0,i=n(s);if(i<r)e=s+1;else if(i>r)t=s-1;else return s}return e>0?e-1:0};function dBe({measurements:e,outerSize:t,scrollOffset:n,lanes:r}){const s=e.length-1,i=l=>e[l].start;if(e.length<=r)return{startIndex:0,endIndex:s};let a=jte(0,s,i,n),o=a;if(r===1)for(;o<s&&e[o].end<n+t;)o++;else if(r>1){const l=Array(r).fill(0);for(;o<s&&l.some(u=>u<n+t);){const u=e[o];l[u.lane]=u.end,o++}const c=Array(r).fill(n+t);for(;a>=0&&c.some(u=>u>=n);){const u=e[a];c[u.lane]=u.start,a--}a=Math.max(0,a-a%r),o=Math.min(s,o+(r-1-o%r))}return{startIndex:a,endIndex:o}}const aq=typeof document<"u"?E.useLayoutEffect:E.useEffect;function fBe(e){const t=E.useReducer(()=>({}),{})[1],n={...e,onChange:(s,i)=>{var a;i?cl.flushSync(t):t(),(a=e.onChange)==null||a.call(e,s,i)}},[r]=E.useState(()=>new uBe(n));return r.setOptions(n),aq(()=>r._didMount(),[]),aq(()=>r._willUpdate()),r}function R6(e){return fBe({observeElementRect:aBe,observeElementOffset:oBe,scrollToFn:cBe,...e})}var hBe=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],of=hBe.reduce((e,t)=>{const n=Mu(`Primitive.${t}`),r=E.forwardRef((s,i)=>{const{asChild:a,...o}=s,l=a?n:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),f.jsx(l,{...o,ref:i})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{});function pBe(e,t){e&&cl.flushSync(()=>e.dispatchEvent(t))}var mBe="DismissableLayer",E4="dismissableLayer.update",gBe="dismissableLayer.pointerDownOutside",yBe="dismissableLayer.focusOutside",oq,Ote=E.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Pte=E.forwardRef((e,t)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:s,onFocusOutside:i,onInteractOutside:a,onDismiss:o,...l}=e,c=E.useContext(Ote),[u,d]=E.useState(null),h=(u==null?void 0:u.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,m]=E.useState({}),y=Mn(t,R=>d(R)),b=Array.from(c.layers),[v]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),x=b.indexOf(v),w=u?b.indexOf(u):-1,S=c.layersWithOutsidePointerEventsDisabled.size>0,k=w>=x,C=xBe(R=>{const N=R.target,I=[...c.branches].some(P=>P.contains(N));!k||I||(s==null||s(R),a==null||a(R),R.defaultPrevented||o==null||o())},h),T=wBe(R=>{const N=R.target;[...c.branches].some(P=>P.contains(N))||(i==null||i(R),a==null||a(R),R.defaultPrevented||o==null||o())},h);return iP(R=>{w===c.layers.size-1&&(r==null||r(R),!R.defaultPrevented&&o&&(R.preventDefault(),o()))},h),E.useEffect(()=>{if(u)return n&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(oq=h.body.style.pointerEvents,h.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(u)),c.layers.add(u),lq(),()=>{n&&c.layersWithOutsidePointerEventsDisabled.size===1&&(h.body.style.pointerEvents=oq)}},[u,h,n,c]),E.useEffect(()=>()=>{u&&(c.layers.delete(u),c.layersWithOutsidePointerEventsDisabled.delete(u),lq())},[u,c]),E.useEffect(()=>{const R=()=>m({});return document.addEventListener(E4,R),()=>document.removeEventListener(E4,R)},[]),f.jsx(of.div,{...l,ref:y,style:{pointerEvents:S?k?"auto":"none":void 0,...e.style},onFocusCapture:Wt(e.onFocusCapture,T.onFocusCapture),onBlurCapture:Wt(e.onBlurCapture,T.onBlurCapture),onPointerDownCapture:Wt(e.onPointerDownCapture,C.onPointerDownCapture)})});Pte.displayName=mBe;var bBe="DismissableLayerBranch",vBe=E.forwardRef((e,t)=>{const n=E.useContext(Ote),r=E.useRef(null),s=Mn(t,r);return E.useEffect(()=>{const i=r.current;if(i)return n.branches.add(i),()=>{n.branches.delete(i)}},[n.branches]),f.jsx(of.div,{...e,ref:s})});vBe.displayName=bBe;function xBe(e,t=globalThis==null?void 0:globalThis.document){const n=Es(e),r=E.useRef(!1),s=E.useRef(()=>{});return E.useEffect(()=>{const i=o=>{if(o.target&&!r.current){let l=function(){Dte(gBe,n,c,{discrete:!0})};const c={originalEvent:o};o.pointerType==="touch"?(t.removeEventListener("click",s.current),s.current=l,t.addEventListener("click",s.current,{once:!0})):l()}else t.removeEventListener("click",s.current);r.current=!1},a=window.setTimeout(()=>{t.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(a),t.removeEventListener("pointerdown",i),t.removeEventListener("click",s.current)}},[t,n]),{onPointerDownCapture:()=>r.current=!0}}function wBe(e,t=globalThis==null?void 0:globalThis.document){const n=Es(e),r=E.useRef(!1);return E.useEffect(()=>{const s=i=>{i.target&&!r.current&&Dte(yBe,n,{originalEvent:i},{discrete:!1})};return t.addEventListener("focusin",s),()=>t.removeEventListener("focusin",s)},[t,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function lq(){const e=new CustomEvent(E4);document.dispatchEvent(e)}function Dte(e,t,n,{discrete:r}){const s=n.originalEvent.target,i=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&s.addEventListener(e,t,{once:!0}),r?pBe(s,i):s.dispatchEvent(i)}var n3="focusScope.autoFocusOnMount",r3="focusScope.autoFocusOnUnmount",cq={bubbles:!1,cancelable:!0},_Be="FocusScope",Fte=E.forwardRef((e,t)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:s,onUnmountAutoFocus:i,...a}=e,[o,l]=E.useState(null),c=Es(s),u=Es(i),d=E.useRef(null),h=Mn(t,b=>l(b)),m=E.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;E.useEffect(()=>{if(r){let b=function(S){if(m.paused||!o)return;const k=S.target;o.contains(k)?d.current=k:nh(d.current,{select:!0})},v=function(S){if(m.paused||!o)return;const k=S.relatedTarget;k!==null&&(o.contains(k)||nh(d.current,{select:!0}))},x=function(S){if(document.activeElement===document.body)for(const C of S)C.removedNodes.length>0&&nh(o)};document.addEventListener("focusin",b),document.addEventListener("focusout",v);const w=new MutationObserver(x);return o&&w.observe(o,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",b),document.removeEventListener("focusout",v),w.disconnect()}}},[r,o,m.paused]),E.useEffect(()=>{if(o){dq.add(m);const b=document.activeElement;if(!o.contains(b)){const x=new CustomEvent(n3,cq);o.addEventListener(n3,c),o.dispatchEvent(x),x.defaultPrevented||(SBe(ABe(Lte(o)),{select:!0}),document.activeElement===b&&nh(o))}return()=>{o.removeEventListener(n3,c),setTimeout(()=>{const x=new CustomEvent(r3,cq);o.addEventListener(r3,u),o.dispatchEvent(x),x.defaultPrevented||nh(b??document.body,{select:!0}),o.removeEventListener(r3,u),dq.remove(m)},0)}}},[o,c,u,m]);const y=E.useCallback(b=>{if(!n&&!r||m.paused)return;const v=b.key==="Tab"&&!b.altKey&&!b.ctrlKey&&!b.metaKey,x=document.activeElement;if(v&&x){const w=b.currentTarget,[S,k]=CBe(w);S&&k?!b.shiftKey&&x===k?(b.preventDefault(),n&&nh(S,{select:!0})):b.shiftKey&&x===S&&(b.preventDefault(),n&&nh(k,{select:!0})):x===w&&b.preventDefault()}},[n,r,m.paused]);return f.jsx(of.div,{tabIndex:-1,...a,ref:h,onKeyDown:y})});Fte.displayName=_Be;function SBe(e,{select:t=!1}={}){const n=document.activeElement;for(const r of e)if(nh(r,{select:t}),document.activeElement!==n)return}function CBe(e){const t=Lte(e),n=uq(t,e),r=uq(t.reverse(),e);return[n,r]}function Lte(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const s=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||s?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function uq(e,t){for(const n of e)if(!kBe(n,{upTo:t}))return n}function kBe(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function EBe(e){return e instanceof HTMLInputElement&&"select"in e}function nh(e,{select:t=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&EBe(e)&&t&&e.select()}}var dq=TBe();function TBe(){let e=[];return{add(t){const n=e[0];t!==n&&(n==null||n.pause()),e=fq(e,t),e.unshift(t)},remove(t){var n;e=fq(e,t),(n=e[0])==null||n.resume()}}}function fq(e,t){const n=[...e],r=n.indexOf(t);return r!==-1&&n.splice(r,1),n}function ABe(e){return e.filter(t=>t.tagName!=="A")}var RBe="Arrow",Bte=E.forwardRef((e,t)=>{const{children:n,width:r=10,height:s=5,...i}=e;return f.jsx(of.svg,{...i,ref:t,width:r,height:s,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?n:f.jsx("polygon",{points:"0,0 30,0 15,10"})})});Bte.displayName=RBe;var NBe=Bte,N6="Popper",[$te,zte]=Ki(N6),[MBe,Ute]=$te(N6),qte=e=>{const{__scopePopper:t,children:n}=e,[r,s]=E.useState(null);return f.jsx(MBe,{scope:t,anchor:r,onAnchorChange:s,children:n})};qte.displayName=N6;var Vte="PopperAnchor",Wte=E.forwardRef((e,t)=>{const{__scopePopper:n,virtualRef:r,...s}=e,i=Ute(Vte,n),a=E.useRef(null),o=Mn(t,a);return E.useEffect(()=>{i.onAnchorChange((r==null?void 0:r.current)||a.current)}),r?null:f.jsx(of.div,{...s,ref:o})});Wte.displayName=Vte;var M6="PopperContent",[IBe,jBe]=$te(M6),Hte=E.forwardRef((e,t)=>{var Fe,Se,Ce,qe,Qe,We;const{__scopePopper:n,side:r="bottom",sideOffset:s=0,align:i="center",alignOffset:a=0,arrowPadding:o=0,avoidCollisions:l=!0,collisionBoundary:c=[],collisionPadding:u=0,sticky:d="partial",hideWhenDetached:h=!1,updatePositionStrategy:m="optimized",onPlaced:y,...b}=e,v=Ute(M6,n),[x,w]=E.useState(null),S=Mn(t,Ie=>w(Ie)),[k,C]=E.useState(null),T=Ky(k),R=(T==null?void 0:T.width)??0,N=(T==null?void 0:T.height)??0,I=r+(i!=="center"?"-"+i:""),P=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},B=Array.isArray(c)?c:[c],D=B.length>0,W={padding:P,boundary:B.filter(PBe),altBoundary:D},{refs:O,floatingStyles:Z,placement:U,isPositioned:H,middlewareData:L}=pP({strategy:"fixed",placement:I,whileElementsMounted:(...Ie)=>hP(...Ie,{animationFrame:m==="always"}),elements:{reference:v.anchor},middleware:[mP({mainAxis:s+N,alignmentAxis:a}),l&&gP({mainAxis:!0,crossAxis:!1,limiter:d==="partial"?yP():void 0,...W}),l&&bP({...W}),vP({...W,apply:({elements:Ie,rects:K,availableWidth:ye,availableHeight:Ne})=>{const{width:ce,height:oe}=K.reference,re=Ie.floating.style;re.setProperty("--radix-popper-available-width",`${ye}px`),re.setProperty("--radix-popper-available-height",`${Ne}px`),re.setProperty("--radix-popper-anchor-width",`${ce}px`),re.setProperty("--radix-popper-anchor-height",`${oe}px`)}}),k&&wP({element:k,padding:o}),DBe({arrowWidth:R,arrowHeight:N}),h&&xP({strategy:"referenceHidden",...W})]}),[te,V]=Yte(U),Q=Es(y);si(()=>{H&&(Q==null||Q())},[H,Q]);const ee=(Fe=L.arrow)==null?void 0:Fe.x,se=(Se=L.arrow)==null?void 0:Se.y,pe=((Ce=L.arrow)==null?void 0:Ce.centerOffset)!==0,[ue,Oe]=E.useState();return si(()=>{x&&Oe(window.getComputedStyle(x).zIndex)},[x]),f.jsx("div",{ref:O.setFloating,"data-radix-popper-content-wrapper":"",style:{...Z,transform:H?Z.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:ue,"--radix-popper-transform-origin":[(qe=L.transformOrigin)==null?void 0:qe.x,(Qe=L.transformOrigin)==null?void 0:Qe.y].join(" "),...((We=L.hide)==null?void 0:We.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:f.jsx(IBe,{scope:n,placedSide:te,onArrowChange:C,arrowX:ee,arrowY:se,shouldHideArrow:pe,children:f.jsx(of.div,{"data-side":te,"data-align":V,...b,ref:S,style:{...b.style,animation:H?void 0:"none"}})})})});Hte.displayName=M6;var Gte="PopperArrow",OBe={top:"bottom",right:"left",bottom:"top",left:"right"},Kte=E.forwardRef(function(t,n){const{__scopePopper:r,...s}=t,i=jBe(Gte,r),a=OBe[i.placedSide];return f.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[a]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:f.jsx(NBe,{...s,ref:n,style:{...s.style,display:"block"}})})});Kte.displayName=Gte;function PBe(e){return e!==null}var DBe=e=>({name:"transformOrigin",options:e,fn(t){var v,x,w;const{placement:n,rects:r,middlewareData:s}=t,a=((v=s.arrow)==null?void 0:v.centerOffset)!==0,o=a?0:e.arrowWidth,l=a?0:e.arrowHeight,[c,u]=Yte(n),d={start:"0%",center:"50%",end:"100%"}[u],h=(((x=s.arrow)==null?void 0:x.x)??0)+o/2,m=(((w=s.arrow)==null?void 0:w.y)??0)+l/2;let y="",b="";return c==="bottom"?(y=a?d:`${h}px`,b=`${-l}px`):c==="top"?(y=a?d:`${h}px`,b=`${r.floating.height+l}px`):c==="right"?(y=`${-l}px`,b=a?d:`${m}px`):c==="left"&&(y=`${r.floating.width+l}px`,b=a?d:`${m}px`),{data:{x:y,y:b}}}});function Yte(e){const[t,n="center"]=e.split("-");return[t,n]}var FBe=qte,Zte=Wte,LBe=Hte,BBe=Kte,$Be="Portal",Xte=E.forwardRef((e,t)=>{var o;const{container:n,...r}=e,[s,i]=E.useState(!1);si(()=>i(!0),[]);const a=n||s&&((o=globalThis==null?void 0:globalThis.document)==null?void 0:o.body);return a?_E.createPortal(f.jsx(of.div,{...r,ref:t}),a):null});Xte.displayName=$Be;var OT="Popover",[Jte,Cdt]=Ki(OT,[zte]),Q1=zte(),[zBe,ip]=Jte(OT),Qte=e=>{const{__scopePopover:t,children:n,open:r,defaultOpen:s,onOpenChange:i,modal:a=!1}=e,o=Q1(t),l=E.useRef(null),[c,u]=E.useState(!1),[d,h]=Fc({prop:r,defaultProp:s??!1,onChange:i,caller:OT});return f.jsx(FBe,{...o,children:f.jsx(zBe,{scope:t,contentId:la(),triggerRef:l,open:d,onOpenChange:h,onOpenToggle:E.useCallback(()=>h(m=>!m),[h]),hasCustomAnchor:c,onCustomAnchorAdd:E.useCallback(()=>u(!0),[]),onCustomAnchorRemove:E.useCallback(()=>u(!1),[]),modal:a,children:n})})};Qte.displayName=OT;var ene="PopoverAnchor",UBe=E.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,s=ip(ene,n),i=Q1(n),{onCustomAnchorAdd:a,onCustomAnchorRemove:o}=s;return E.useEffect(()=>(a(),()=>o()),[a,o]),f.jsx(Zte,{...i,...r,ref:t})});UBe.displayName=ene;var tne="PopoverTrigger",nne=E.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,s=ip(tne,n),i=Q1(n),a=Mn(t,s.triggerRef),o=f.jsx(of.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":one(s.open),...r,ref:a,onClick:Wt(e.onClick,s.onOpenToggle)});return s.hasCustomAnchor?o:f.jsx(Zte,{asChild:!0,...i,children:o})});nne.displayName=tne;var I6="PopoverPortal",[qBe,VBe]=Jte(I6,{forceMount:void 0}),rne=e=>{const{__scopePopover:t,forceMount:n,children:r,container:s}=e,i=ip(I6,t);return f.jsx(qBe,{scope:t,forceMount:n,children:f.jsx(da,{present:n||i.open,children:f.jsx(Xte,{asChild:!0,container:s,children:r})})})};rne.displayName=I6;var Ey="PopoverContent",sne=E.forwardRef((e,t)=>{const n=VBe(Ey,e.__scopePopover),{forceMount:r=n.forceMount,...s}=e,i=ip(Ey,e.__scopePopover);return f.jsx(da,{present:r||i.open,children:i.modal?f.jsx(HBe,{...s,ref:t}):f.jsx(GBe,{...s,ref:t})})});sne.displayName=Ey;var WBe=Mu("PopoverContent.RemoveScroll"),HBe=E.forwardRef((e,t)=>{const n=ip(Ey,e.__scopePopover),r=E.useRef(null),s=Mn(t,r),i=E.useRef(!1);return E.useEffect(()=>{const a=r.current;if(a)return AT(a)},[]),f.jsx(J1,{as:WBe,allowPinchZoom:!0,children:f.jsx(ine,{...e,ref:s,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Wt(e.onCloseAutoFocus,a=>{var o;a.preventDefault(),i.current||(o=n.triggerRef.current)==null||o.focus()}),onPointerDownOutside:Wt(e.onPointerDownOutside,a=>{const o=a.detail.originalEvent,l=o.button===0&&o.ctrlKey===!0,c=o.button===2||l;i.current=c},{checkForDefaultPrevented:!1}),onFocusOutside:Wt(e.onFocusOutside,a=>a.preventDefault(),{checkForDefaultPrevented:!1})})})}),GBe=E.forwardRef((e,t)=>{const n=ip(Ey,e.__scopePopover),r=E.useRef(!1),s=E.useRef(!1);return f.jsx(ine,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var a,o;(a=e.onCloseAutoFocus)==null||a.call(e,i),i.defaultPrevented||(r.current||(o=n.triggerRef.current)==null||o.focus(),i.preventDefault()),r.current=!1,s.current=!1},onInteractOutside:i=>{var l,c;(l=e.onInteractOutside)==null||l.call(e,i),i.defaultPrevented||(r.current=!0,i.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const a=i.target;((c=n.triggerRef.current)==null?void 0:c.contains(a))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&s.current&&i.preventDefault()}})}),ine=E.forwardRef((e,t)=>{const{__scopePopover:n,trapFocus:r,onOpenAutoFocus:s,onCloseAutoFocus:i,disableOutsidePointerEvents:a,onEscapeKeyDown:o,onPointerDownOutside:l,onFocusOutside:c,onInteractOutside:u,...d}=e,h=ip(Ey,n),m=Q1(n);return ET(),f.jsx(Fte,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:s,onUnmountAutoFocus:i,children:f.jsx(Pte,{asChild:!0,disableOutsidePointerEvents:a,onInteractOutside:u,onEscapeKeyDown:o,onPointerDownOutside:l,onFocusOutside:c,onDismiss:()=>h.onOpenChange(!1),children:f.jsx(LBe,{"data-state":one(h.open),role:"dialog",id:h.contentId,...m,...d,ref:t,style:{...d.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),ane="PopoverClose",KBe=E.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,s=ip(ane,n);return f.jsx(of.button,{type:"button",...r,ref:t,onClick:Wt(e.onClick,()=>s.onOpenChange(!1))})});KBe.displayName=ane;var YBe="PopoverArrow",ZBe=E.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,s=Q1(n);return f.jsx(BBe,{...s,...r,ref:t})});ZBe.displayName=YBe;function one(e){return e?"open":"closed"}var XBe=Qte,JBe=nne,QBe=rne,e$e=sne;function sc({...e}){return f.jsx(XBe,{"data-slot":"popover",...e})}function ic({...e}){return f.jsx(JBe,{"data-slot":"popover-trigger",...e})}function ac({className:e,align:t="center",sideOffset:n=4,...r}){return f.jsx(QBe,{children:f.jsx(e$e,{"data-slot":"popover-content",align:t,sideOffset:n,className:Xe("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-72 origin-(--radix-popover-content-transform-origin) rounded-md border p-4 shadow-md outline-hidden",e),...r})})}var t$e=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],j6=t$e.reduce((e,t)=>{const n=Mu(`Primitive.${t}`),r=E.forwardRef((s,i)=>{const{asChild:a,...o}=s,l=a?n:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),f.jsx(l,{...o,ref:i})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{}),PT="Checkbox",[n$e,kdt]=Ki(PT),[r$e,O6]=n$e(PT);function s$e(e){const{__scopeCheckbox:t,checked:n,children:r,defaultChecked:s,disabled:i,form:a,name:o,onCheckedChange:l,required:c,value:u="on",internal_do_not_use_render:d}=e,[h,m]=Fc({prop:n,defaultProp:s??!1,onChange:l,caller:PT}),[y,b]=E.useState(null),[v,x]=E.useState(null),w=E.useRef(!1),S=y?!!a||!!y.closest("form"):!0,k={checked:h,disabled:i,setChecked:m,control:y,setControl:b,name:o,form:a,value:u,hasConsumerStoppedPropagationRef:w,required:c,defaultChecked:mh(s)?!1:s,isFormControl:S,bubbleInput:v,setBubbleInput:x};return f.jsx(r$e,{scope:t,...k,children:i$e(d)?d(k):r})}var lne="CheckboxTrigger",cne=E.forwardRef(({__scopeCheckbox:e,onKeyDown:t,onClick:n,...r},s)=>{const{control:i,value:a,disabled:o,checked:l,required:c,setControl:u,setChecked:d,hasConsumerStoppedPropagationRef:h,isFormControl:m,bubbleInput:y}=O6(lne,e),b=Mn(s,u),v=E.useRef(l);return E.useEffect(()=>{const x=i==null?void 0:i.form;if(x){const w=()=>d(v.current);return x.addEventListener("reset",w),()=>x.removeEventListener("reset",w)}},[i,d]),f.jsx(j6.button,{type:"button",role:"checkbox","aria-checked":mh(l)?"mixed":l,"aria-required":c,"data-state":mne(l),"data-disabled":o?"":void 0,disabled:o,value:a,...r,ref:b,onKeyDown:Wt(t,x=>{x.key==="Enter"&&x.preventDefault()}),onClick:Wt(n,x=>{d(w=>mh(w)?!0:!w),y&&m&&(h.current=x.isPropagationStopped(),h.current||x.stopPropagation())})})});cne.displayName=lne;var une=E.forwardRef((e,t)=>{const{__scopeCheckbox:n,name:r,checked:s,defaultChecked:i,required:a,disabled:o,value:l,onCheckedChange:c,form:u,...d}=e;return f.jsx(s$e,{__scopeCheckbox:n,checked:s,defaultChecked:i,disabled:o,required:a,onCheckedChange:c,name:r,form:u,value:l,internal_do_not_use_render:({isFormControl:h})=>f.jsxs(f.Fragment,{children:[f.jsx(cne,{...d,ref:t,__scopeCheckbox:n}),h&&f.jsx(pne,{__scopeCheckbox:n})]})})});une.displayName=PT;var dne="CheckboxIndicator",fne=E.forwardRef((e,t)=>{const{__scopeCheckbox:n,forceMount:r,...s}=e,i=O6(dne,n);return f.jsx(da,{present:r||mh(i.checked)||i.checked===!0,children:f.jsx(j6.span,{"data-state":mne(i.checked),"data-disabled":i.disabled?"":void 0,...s,ref:t,style:{pointerEvents:"none",...e.style}})})});fne.displayName=dne;var hne="CheckboxBubbleInput",pne=E.forwardRef(({__scopeCheckbox:e,...t},n)=>{const{control:r,hasConsumerStoppedPropagationRef:s,checked:i,defaultChecked:a,required:o,disabled:l,name:c,value:u,form:d,bubbleInput:h,setBubbleInput:m}=O6(hne,e),y=Mn(n,m),b=TT(i),v=Ky(r);E.useEffect(()=>{const w=h;if(!w)return;const S=window.HTMLInputElement.prototype,C=Object.getOwnPropertyDescriptor(S,"checked").set,T=!s.current;if(b!==i&&C){const R=new Event("click",{bubbles:T});w.indeterminate=mh(i),C.call(w,mh(i)?!1:i),w.dispatchEvent(R)}},[h,b,i,s]);const x=E.useRef(mh(i)?!1:i);return f.jsx(j6.input,{type:"checkbox","aria-hidden":!0,defaultChecked:a??x.current,required:o,disabled:l,name:c,value:u,form:d,...t,tabIndex:-1,ref:y,style:{...t.style,...v,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});pne.displayName=hne;function i$e(e){return typeof e=="function"}function mh(e){return e==="indeterminate"}function mne(e){return mh(e)?"indeterminate":e?"checked":"unchecked"}function $c({className:e,...t}){return f.jsx(une,{"data-slot":"checkbox",className:Xe("peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",e),...t,children:f.jsx(fne,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:f.jsx(ao,{className:"size-3.5"})})})}const P6=({currentCapabilityFilters:e,onCapabilityFilterChange:t,currentSelectedProviders:n,onProviderFilterChange:r,currentEnabledFilter:s,onEnabledFilterChange:i,currentMinInputPrice:a,currentMaxInputPrice:o,currentMinOutputPrice:l,currentMaxOutputPrice:c,onPriceFilterChange:u,allProviders:d,showCapabilityFilters:h=!0,showProviderFilter:m=!1,showStatusFilter:y=!1,showPriceFilters:b=!1,disabled:v=!1,totalActiveFilters:x})=>{const[w,S]=E.useState(!1),k=E.useCallback(R=>{t({...e,[R]:!e[R]})},[e,t]),C=E.useCallback((R,N)=>{if(!n||!r)return;const I=new Set(n);N?I.add(R):I.delete(R),r(I)},[n,r]),T=E.useCallback((R,N)=>{if(!u)return;u(R==="minInput"?N:a??"",R==="maxInput"?N:o??"",R==="minOutput"?N:l??"",R==="maxOutput"?N:c??"")},[u,a,o,l,c]);return f.jsxs(sc,{open:w,onOpenChange:S,children:[f.jsx(ic,{asChild:!0,children:f.jsxs(mt,{variant:"outline",size:"sm",className:"h-9 px-3 relative",disabled:v,children:[f.jsx(Tme,{className:"h-4 w-4 mr-1"}),"Filters",x>0&&f.jsx("span",{className:"absolute -top-1 -right-1 inline-flex items-center justify-center px-1.5 py-0.5 text-xs font-semibold leading-none text-white bg-primary rounded-full",children:x})]})}),f.jsxs(ac,{className:"p-4 space-y-4 w-72 bg-popover shadow-lg relative",style:{zIndex:9999,pointerEvents:"auto"},onMouseDown:R=>R.preventDefault(),onClick:R=>R.stopPropagation(),onPointerDown:R=>R.stopPropagation(),onPointerDownCapture:R=>R.stopPropagation(),align:"end",children:[y&&s!==void 0&&i&&f.jsxs("div",{className:"space-y-2",onClick:R=>R.stopPropagation(),children:[f.jsx(Ot,{className:"text-xs font-semibold",children:"Status"}),f.jsxs("div",{className:"flex gap-1",children:[f.jsx(mt,{variant:s==="all"?"secondary":"outline",size:"sm",onClick:R=>{R.stopPropagation(),i("all")},children:"All"}),f.jsxs(mt,{variant:s==="enabled"?"secondary":"outline",size:"sm",onClick:R=>{R.stopPropagation(),i("enabled")},children:[f.jsx(ao,{className:"h-3 w-3 mr-1"})," Enabled"]}),f.jsxs(mt,{variant:s==="disabled"?"secondary":"outline",size:"sm",onClick:R=>{R.stopPropagation(),i("disabled")},children:[f.jsx(vpe,{className:"h-3 w-3 mr-1"})," Disabled"]})]})]}),m&&n&&d&&r&&f.jsxs("div",{onClick:R=>R.stopPropagation(),children:[f.jsx(Ot,{className:"text-xs px-2 font-semibold block mb-1",children:"Providers"}),f.jsx(Yl,{className:"h-32 border rounded-md p-1",children:d.map(R=>f.jsxs("div",{className:"flex items-center space-x-2 p-1.5 rounded hover:bg-muted",children:[f.jsx($c,{id:`filter-provider-${R.id}`,checked:n.has(R.id),onCheckedChange:N=>{C(R.id,!!N)}}),f.jsxs(Ot,{htmlFor:`filter-provider-${R.id}`,className:"text-sm font-normal cursor-pointer",children:[R.name," (",R.type,")"]})]},R.id))})]}),h&&f.jsxs("div",{className:"space-y-2",onClick:R=>R.stopPropagation(),children:[f.jsx(Ot,{className:"text-xs font-semibold",children:"Capabilities"}),f.jsxs("div",{className:"flex flex-wrap gap-1",children:[f.jsx(Un,{tooltipText:"Reasoning","aria-label":"Reasoning",icon:f.jsx(Uy,{}),onClick:R=>{R.stopPropagation(),k("reasoning")},variant:e.reasoning?"secondary":"outline",className:Xe(e.reasoning&&"text-primary")}),f.jsx(Un,{tooltipText:"Web Search","aria-label":"Web Search",icon:f.jsx(Do,{}),onClick:R=>{R.stopPropagation(),k("webSearch")},variant:e.webSearch?"secondary":"outline",className:Xe(e.webSearch&&"text-primary")}),f.jsx(Un,{tooltipText:"Tools","aria-label":"Tools",icon:f.jsx(Gx,{}),onClick:R=>{R.stopPropagation(),k("tools")},variant:e.tools?"secondary":"outline",className:Xe(e.tools&&"text-primary")}),f.jsx(Un,{tooltipText:"Multimodal","aria-label":"Multimodal",icon:f.jsx(J0,{}),onClick:R=>{R.stopPropagation(),k("multimodal")},variant:e.multimodal?"secondary":"outline",className:Xe(e.multimodal&&"text-primary")})]})]}),b&&a!==void 0&&u&&f.jsxs("div",{className:"space-y-2",onClick:R=>R.stopPropagation(),children:[f.jsxs(Ot,{className:"text-xs font-semibold flex items-center gap-1",children:[f.jsx(sme,{className:"h-3 w-3"})," Price Range ($ / 1M Tokens)"]}),f.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[f.jsx(Cn,{type:"number",min:"0",step:"0.01",placeholder:"Min Input",value:a,onChange:R=>{R.stopPropagation(),T("minInput",R.target.value)},className:"h-8 text-xs"}),f.jsx(Cn,{type:"number",min:"0",step:"0.01",placeholder:"Max Input",value:o,onChange:R=>{R.stopPropagation(),T("maxInput",R.target.value)},className:"h-8 text-xs"}),f.jsx(Cn,{type:"number",min:"0",step:"0.01",placeholder:"Min Output",value:l,onChange:R=>{R.stopPropagation(),T("minOutput",R.target.value)},className:"h-8 text-xs"}),f.jsx(Cn,{type:"number",min:"0",step:"0.01",placeholder:"Max Output",value:c,onChange:R=>{R.stopPropagation(),T("maxOutput",R.target.value)},className:"h-8 text-xs"})]})]})]})]})},hq=e=>{if(!e)return null;const t=parseFloat(e);return isNaN(t)?null:t/1e6},D6=({providerId:e,allAvailableModels:t,enabledModelIds:n,onToggleModel:r,isLoading:s=!1,disabled:i=!1,listHeightClass:a="h-[26rem]",onModelClick:o})=>{const[l,c]=E.useState(null),u=E.useCallback(Z=>{if(Z){const U=Z.querySelector("[data-radix-scroll-area-viewport]");if(U)c(U);else{const H=new MutationObserver(()=>{const L=Z.querySelector("[data-radix-scroll-area-viewport]");L&&(c(L),H.disconnect())});return H.observe(Z,{childList:!0,subtree:!0}),()=>H.disconnect()}}else c(null)},[]),[d,h]=E.useState(""),[m,y]=E.useState("all"),[b,v]=E.useState({reasoning:!1,webSearch:!1,tools:!1,multimodal:!1}),[x,w]=E.useState(""),[S,k]=E.useState(""),[C,T]=E.useState(""),[R,N]=E.useState(""),I=E.useMemo(()=>{let Z=[...t];if(m==="enabled"?Z=Z.filter(ue=>n.has(ue.id)):m==="disabled"&&(Z=Z.filter(ue=>!n.has(ue.id))),d.trim()){const ue=d.toLowerCase();Z=Z.filter(Oe=>Oe.name.toLowerCase().includes(ue)||Oe.id.toLowerCase().includes(ue))}const U=Object.entries(b).filter(([,ue])=>ue).map(([ue])=>ue);U.length>0&&(Z=Z.filter(ue=>{var Se;const Oe=new Set(ue.supported_parameters??[]),Fe=new Set(((Se=ue.architecture)==null?void 0:Se.input_modalities)??[]);return U.every(Ce=>{switch(Ce){case"reasoning":return Oe.has("reasoning");case"webSearch":return Oe.has("web_search")||Oe.has("web_search_options");case"tools":return Oe.has("tools");case"multimodal":return Array.from(Fe).some(qe=>qe!=="text");default:return!0}})}));const H=parseFloat(x),L=parseFloat(S),te=parseFloat(C),V=parseFloat(R),Q=!isNaN(H),ee=!isNaN(L),se=!isNaN(te),pe=!isNaN(V);return(Q||ee||se||pe)&&(Z=Z.filter(ue=>{var ye,Ne;const Oe=hq((ye=ue.pricing)==null?void 0:ye.prompt),Fe=hq((Ne=ue.pricing)==null?void 0:Ne.completion),Se=Q?H/1e6:-1/0,Ce=ee?L/1e6:1/0,qe=se?te/1e6:-1/0,Qe=pe?V/1e6:1/0,We=Oe!==null&&Oe>=Se&&Oe<=Ce,Ie=Fe!==null&&Fe>=qe&&Fe<=Qe;let K=!0;return(Q||ee)&&K&&(K=We),(se||pe)&&K&&(K=Ie),K})),Z},[t,d,m,n,b,x,S,C,R]),P=R6({count:I.length,getScrollElement:()=>l,estimateSize:()=>40,overscan:10}),B=E.useCallback(Z=>{v(Z)},[]),D=E.useCallback(Z=>{y(Z)},[]),W=E.useCallback((Z,U,H,L)=>{w(Z),k(U),T(H),N(L)},[]),O=E.useMemo(()=>(m!=="all"?1:0)+Object.values(b).filter(Boolean).length+(x||S||C||R?1:0),[m,b,x,S,C,R]);return s?f.jsxs("div",{className:Xe("space-y-2",a),children:[f.jsx("div",{className:"h-8 w-full bg-muted rounded animate-pulse"}),f.jsx("div",{className:"h-8 w-full bg-muted rounded animate-pulse"}),f.jsx("div",{className:"h-8 w-full bg-muted rounded animate-pulse"})]}):t.length===0?f.jsx("p",{className:"text-sm text-muted-foreground italic pt-2",children:"No models available for this provider. Try fetching models."}):f.jsxs("div",{className:"space-y-2 flex flex-col h-full",children:[f.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[f.jsxs("div",{className:"relative flex-grow",children:[f.jsx(Do,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),f.jsx(Cn,{value:d,onChange:Z=>h(Z.target.value),placeholder:"Filter models by name...",className:"pl-8 h-9 w-full text-xs",type:"text",disabled:i})]}),f.jsx(P6,{currentCapabilityFilters:b,onCapabilityFilterChange:B,currentEnabledFilter:m,onEnabledFilterChange:D,currentMinInputPrice:x,currentMaxInputPrice:S,currentMinOutputPrice:C,currentMaxOutputPrice:R,onPriceFilterChange:W,showStatusFilter:!0,showCapabilityFilters:!0,showPriceFilters:!0,disabled:i,totalActiveFilters:O})]}),f.jsxs(Yl,{className:Xe("w-full rounded-md border border-border p-1 bg-background/50 flex-grow",a),ref:u,children:[l&&f.jsx("div",{style:{height:`${P.getTotalSize()}px`,width:"100%",position:"relative"},children:I.length===0&&!s?f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4 absolute inset-0 flex items-center justify-center",children:"No models match the current filters."}):P.getVirtualItems().map(Z=>{const U=I[Z.index];return U?f.jsxs("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:`${Z.size}px`,transform:`translateY(${Z.start}px)`},className:"flex items-center justify-between space-x-2 p-1.5 rounded hover:bg-muted/50",children:[f.jsx(Oo,{id:`enable-model-${e}-${U.id}`,checked:n.has(U.id),onCheckedChange:H=>r(U.id,H),disabled:i,"aria-label":`Enable model ${U.name||U.id}`,className:"flex-shrink-0",onClick:H=>H.stopPropagation()}),f.jsx(Ot,{htmlFor:`enable-model-${e}-${U.id}`,className:"text-sm font-normal text-card-foreground flex-grow cursor-pointer truncate pl-2",title:U.name||U.id,onClick:o?()=>o(U.id):void 0,children:U.name||U.id})]},U.id):null})}),!l&&!s&&f.jsx("div",{className:"flex items-center justify-center h-full text-muted-foreground",children:"Initializing list..."})]})]})},a$e=({stepNumber:e,title:t,description:n,isComplete:r,isActive:s,openOnComplete:i=!1,contentClassName:a="",icon:o,children:l})=>{const[c,u]=E.useState(!1);return E.useEffect(()=>{u(s||r&&i)},[s,r,i]),f.jsxs(dl,{className:`border border-border/40 bg-card/50 backdrop-blur-sm shadow-lg ${r?"border-l-4 border-l-green-500/70":s?"border-l-4 border-l-primary/70":""}`,children:[f.jsx(fl,{className:"pb-2",children:f.jsxs("div",{className:"flex items-center space-x-3",children:[f.jsx("div",{className:`flex h-8 w-8 shrink-0 items-center justify-center rounded-full ${r?"bg-green-500/20 text-green-500":s?"bg-primary/20 text-primary":"bg-muted text-muted-foreground"}`,children:r?f.jsx(hE,{className:"h-5 w-5"}):f.jsx("div",{className:"flex items-center justify-center",children:o})}),f.jsxs("div",{className:"flex-1",children:[f.jsxs("div",{className:"flex items-center justify-between cursor-pointer",onClick:()=>u(!c),children:[f.jsxs(hl,{className:"text-base",children:[f.jsxs("span",{className:"opacity-60 mr-2",children:[e,"."]}),t]}),f.jsx("button",{className:`p-1 rounded-full transition-all ${c?"rotate-90":""} hover:bg-muted/60`,children:f.jsx($O,{className:"h-4 w-4"})})]}),!c&&f.jsx(zd,{className:"text-xs mt-1",children:typeof n=="string"?n.substring(0,60)+(n.length>60?"...":""):"Click to expand"})]})]})}),f.jsx(NOe,{children:c&&f.jsx(mu.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},className:"overflow-hidden",children:f.jsxs(pl,{className:"pt-2",children:[typeof n=="string"?f.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:n}):f.jsx("div",{className:"text-sm text-muted-foreground mb-4",children:n}),f.jsx("div",{className:a,children:l})]})})})]})},o$e=()=>{const{apiKeys:e,addApiKey:t,providers:n,addProviderConfig:r,updateProviderConfig:s,getAllAvailableModelDefsForProvider:i,isLoading:a,enableApiKeyManagement:o}=Cr(yn(se=>({apiKeys:se.dbApiKeys,addApiKey:se.addApiKey,providers:se.dbProviderConfigs,addProviderConfig:se.addProviderConfig,updateProviderConfig:se.updateProviderConfig,getAllAvailableModelDefsForProvider:se.getAllAvailableModelDefsForProvider,isLoading:se.isLoading,enableApiKeyManagement:se.enableApiKeyManagement}))),{addConversation:l,selectItem:c}=qn(yn(se=>({addConversation:se.addConversation,selectItem:se.selectItem}))),[u,d]=E.useState(!1),[h,m]=E.useState(!1),[y,b]=E.useState(!1),[v,x]=E.useState(!1),[w,S]=E.useState(!1),k=E.useMemo(()=>!o||e.length>0,[o,e]),C=E.useMemo(()=>n.length>0,[n]),T=E.useMemo(()=>n.some(se=>se.isEnabled&&se.enabledModels&&se.enabledModels.length>0),[n]),R=E.useMemo(()=>{const se=[...n].sort((pe,ue)=>ue.createdAt.getTime()-pe.createdAt.getTime());return se.length>0?se[0]:null},[n]),N=E.useMemo(()=>R?i(R.id):[],[R,i]),I=E.useMemo(()=>new Set((R==null?void 0:R.enabledModels)??[]),[R]),{initialProviderTypeForForm:P,initialProviderNameForForm:B,initialApiKeyIdForForm:D}=E.useMemo(()=>{var se;if(C)return{type:void 0,name:void 0,keyId:void 0};if(e.length>0){const ue=[...e].sort((Oe,Fe)=>Fe.createdAt.getTime()-Oe.createdAt.getTime()).find(Oe=>sy(Oe.providerId));if(ue){const Oe=ue.providerId,Fe=((se=Co.find(Se=>Se.value===Oe))==null?void 0:se.label)||Oe;return{initialProviderTypeForForm:Oe,initialProviderNameForForm:Fe,initialApiKeyIdForForm:ue.id}}}return{initialProviderTypeForForm:void 0,initialProviderNameForForm:void 0,initialApiKeyIdForForm:void 0}},[e,C]),W=E.useCallback(async(se,pe,ue)=>{d(!0);try{await t(se,pe,ue),Me.success("API key added successfully!")}finally{d(!1)}},[t]),O=E.useCallback(async se=>{m(!0);try{const pe={...se,apiKeyId:se.apiKeyId??(sy(se.type)?D??null:null)},ue=await r(pe);return Me.success("Provider added successfully!"),ue}finally{m(!1)}},[r,D]),Z=E.useCallback(async(se,pe)=>{if(!R)return;x(!0);const ue=new Set(R.enabledModels??[]);pe?ue.add(se):ue.delete(se);const Oe=Array.from(ue);try{await s(R.id,{enabledModels:Oe}),Me.success(pe?"Model enabled successfully!":"Model disabled successfully!")}catch(Fe){Me.error("Failed to update model status."),console.error("Failed to save model toggle:",Fe)}finally{x(!1)}},[R,s]),U=E.useCallback(async()=>{b(!0),S(!0);try{await new Promise(pe=>setTimeout(pe,800));const se=await l({title:"New Chat"});await c(se,"conversation"),Me.success("Welcome to your first chat!")}catch(se){Me.error("Failed to start your first chat."),console.error("Failed to start first chat:",se),b(!1),S(!1)}},[l,c]),H=()=>{Pe.emit(Or.openModalRequest,{modalId:"settingsModal",initialTab:"providers"})},L=[k,C,T].filter(Boolean).length,te=o?3:2,V=L/te*100,Q=[...o?[{id:"api-key",title:"Add API Key",description:f.jsxs("div",{className:"space-y-2",children:[f.jsxs("p",{children:["To use providers like"," ",f.jsx(Ad,{href:"https://platform.openai.com/api-keys",className:"text-blue-500 hover:text-blue-700 transition-colors",children:"OpenAI"}),","," ",f.jsx(Ad,{href:"https://aistudio.google.com/app/apikey",className:"text-green-600 hover:text-green-700 transition-colors",children:"Google"}),","," ",f.jsx(Ad,{href:"https://console.anthropic.com/settings/keys",className:"text-purple-500 hover:text-purple-700 transition-colors",children:"Anthropic (Claude)"}),", or"," ",f.jsx(Ad,{href:"https://openrouter.ai/keys",className:"text-orange-500 hover:text-orange-700 transition-colors",children:"OpenRouter"})," ","or any OpenAI API compatible provider, add an API key. Keys are stored securely in your browser."]}),f.jsxs("p",{children:['If you want truly local AI, "no internet required", you can setup'," ",f.jsx(Ad,{href:"https://www.ollama.com/",className:"text-teal-500 hover:text-teal-700 transition-colors",children:"Ollama"})," ","or,"," ",f.jsx(Ad,{href:"https://lmstudio.ai/",className:"text-indigo-500 hover:text-indigo-700 transition-colors",children:"LMStudio"})," ","(or any other local LLM solution with an OpenAI compatible API). These typically don't require API keys so see you in step 2."]})]}),isComplete:k,content:f.jsx(vte,{onSave:W,onCancel:()=>{},disabled:u,className:"border-none shadow-none p-0",initialProviderType:P}),icon:f.jsx(Hx,{className:"h-4 w-4"})}]:[],{id:"add-provider",title:"Add AI Provider",description:f.jsxs("div",{className:"space-y-2",children:[f.jsx("p",{children:"Connect to an AI provider you configured the key for..."}),f.jsx("p",{children:"This might look redundant, but it allows you to have multiple keys for the same provider (personal, professional, etc.)"})]}),isComplete:C,content:f.jsx(Tte,{apiKeys:e,onAddProvider:O,onCancel:()=>{},initialType:P,initialName:B,initialApiKeyId:D}),icon:f.jsx(Q0,{className:"h-4 w-4"})},{id:"enable-models",title:"Enable Models",description:f.jsxs("div",{className:"space-y-2",children:[f.jsxs("p",{children:["Enable models for the provider you just added (",f.jsx("span",{className:"font-medium text-primary",children:(R==null?void 0:R.name)||"..."}),")."]}),f.jsx("p",{children:"Enabling specific models improves the UI by reducing clutter and choice paralysis. You can enable more later in Settings."}),f.jsx("p",{children:"And just like before, you can choose to activate a model for a certain combination of key/provider!"})]}),isComplete:T,content:R?f.jsx("div",{className:"bg-card/40 rounded-lg p-3 border border-border/30 shadow-inner",children:f.jsx(D6,{providerId:R.id,allAvailableModels:N,enabledModelIds:I,onToggleModel:Z,isLoading:a||v,listHeightClass:"h-[26rem]"})}):f.jsxs("p",{className:"text-sm text-muted-foreground italic flex items-center",children:[f.jsx(Kl,{className:"h-4 w-4 mr-2 text-amber-500"}),"Add a provider in Step ",o?"2":"1"," first."]}),icon:f.jsx(Uy,{className:"h-4 w-4"})},{id:"start-chat",title:"Start Chatting",description:"You're all set! Click below to start your first chat.",isComplete:!1,content:f.jsxs("div",{children:[w&&f.jsx(mu.div,{initial:{opacity:0},animate:{opacity:1},className:"mb-4",children:f.jsx(ky,{value:y?void 0:100,className:"h-2"})}),f.jsxs(mt,{onClick:U,disabled:y||!T,className:"w-full bg-gradient-to-r from-indigo-500 to-primary hover:opacity-90 transition-all",children:[f.jsx(Qme,{className:"mr-2 h-4 w-4"}),y?"Launching...":"Start First Chat"]}),f.jsx($J,{})]}),contentClassName:"p-4",icon:f.jsx(Sge,{className:"h-4 w-4"})}],ee=Q.findIndex(se=>!se.isComplete);return a?f.jsx("div",{className:"flex h-full flex-col items-center justify-center p-4 space-y-4 max-w-4xl mx-auto w-full",children:f.jsxs(mu.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},className:"w-full",children:[f.jsx(Wr,{className:"h-12 w-1/2 mx-auto mb-6"}),f.jsx(Wr,{className:"h-8 w-3/4 mx-auto mb-2"}),f.jsx(Wr,{className:"h-4 w-1/2 mx-auto mb-8"}),f.jsx(Wr,{className:"h-20 w-full mb-6"}),f.jsx(Wr,{className:"h-20 w-full mb-6"}),f.jsx(Wr,{className:"h-20 w-full"})]})}):f.jsx("div",{className:"flex h-full flex-col items-center justify-start p-4 bg-gradient-to-b from-background to-background/80",children:f.jsxs("div",{className:"w-full max-w-4xl space-y-6 pt-8",children:[f.jsxs("div",{className:"text-center mb-8",children:[f.jsx(mu.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{type:"spring",stiffness:500,damping:30},children:f.jsxs("div",{className:"relative mx-auto w-16 h-16 mb-4",children:[f.jsx("div",{className:"absolute inset-0 bg-primary/20 rounded-full blur-xl"}),f.jsx("div",{className:"relative bg-gradient-to-br from-primary to-indigo-600 p-3 rounded-full",children:f.jsx(HLe,{className:"h-10 w-10 text-white"})})]})}),f.jsx("h2",{className:"text-3xl font-bold mb-3 bg-gradient-to-r from-primary to-indigo-500 bg-clip-text text-transparent",children:"Welcome to LiteChat"}),f.jsx(KLe,{})]}),f.jsxs(mu.div,{className:"space-y-4",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[f.jsx(xr,{children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsxs("div",{className:"mt-6 bg-card/40 backdrop-blur-sm border border-border/30 rounded-xl p-3 w-3/4 mx-auto",children:[f.jsx(ky,{value:V,className:"h-1.5"}),f.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["Setup Progress: ",Math.round(V),"%"]})]})}),f.jsx(Sr,{children:f.jsxs("p",{children:["Steps completed: ",L," of ",te]})})]})}),Q.map((se,pe)=>{const ue=pe===ee;return f.jsx(mu.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:pe*.1,duration:.3},children:f.jsx(a$e,{stepNumber:pe+1,title:se.title,description:se.description,isComplete:se.id!=="start-chat"&&se.isComplete,isActive:ue,openOnComplete:se.id==="enable-models",contentClassName:se.id==="add-provider"||se.id==="api-key"?"p-0 border-none shadow-none bg-transparent":se.contentClassName,icon:se.icon,children:se.content})},se.id)})]}),!a&&!C&&ee===-1&&f.jsxs(mu.div,{className:"text-center mt-6 p-4 bg-red-500/10 rounded-lg border border-red-500/30",initial:{opacity:0},animate:{opacity:1},transition:{delay:.5},children:[f.jsx(Kl,{className:"h-8 w-8 text-red-500 mx-auto mb-2"}),f.jsx("p",{className:"text-sm mb-3",children:"Configuration issue detected. Please review provider settings."}),f.jsx(mt,{variant:"outline",size:"sm",onClick:H,className:"border-red-500/50 hover:bg-red-500/20 transition-colors",children:"Open Provider Settings"})]})]})})},u2=["conversation.title_generation"],l$e=({conversationId:e,interactions:t,status:n,className:r})=>{const s=E.useRef(null),i=E.useRef(null),[a,o]=E.useState(!1),l=E.useRef(null),c=vn(O=>O.streamingInteractionIds),{chatMaxWidth:u,autoScrollInterval:d,enableAutoScrollOnStream:h}=br(yn(O=>({chatMaxWidth:O.chatMaxWidth,autoScrollInterval:O.autoScrollInterval,enableAutoScrollOnStream:O.enableAutoScrollOnStream}))),m=br(O=>O.setEnableAutoScrollOnStream),y=E.useMemo(()=>O=>({isLoading:O.isLoading}),[]),b=E.useMemo(()=>O=>({conversationCount:O.conversations.length,isConversationLoading:O.isLoading}),[]),{isLoading:v}=Cr(yn(y)),{conversationCount:x,isConversationLoading:w}=qn(yn(b)),{projectCount:S,isProjectLoading:k}=zo(yn(O=>({projectCount:O.projects.length,isProjectLoading:O.isLoading}))),C=E.useMemo(()=>v||w||k?!1:x===0&&S===0,[x,S,v,w,k]),T=E.useMemo(()=>t.filter(U=>U.parentId===null&&!u2.includes(U.type)).sort((U,H)=>U.index-H.index).map(U=>{const H=t.filter(L=>L.parentId===U.id&&!u2.includes(L.type)).sort((L,te)=>L.index-te.index);return[U,...H]}),[t]),R=Vi(yn(O=>Object.values(O.canvasControls))),N=E.useCallback((O,Z,U,H)=>R.filter(te=>{const V=te.type===O,Q=te.targetSlot===Z,ee=!!te.renderer;return V&&Q&&ee}).map(te=>{if(te.renderer){const Q={...{interaction:U,interactionId:U==null?void 0:U.id,responseContent:typeof(U==null?void 0:U.response)=="string"?U.response:void 0,canvasContextType:O},...H};return f.jsx(Ve.Fragment,{children:te.renderer(Q)},te.id)}return null}).filter(Boolean),[R]),I=(O="smooth")=>{if(i.current){i.current.scrollTo({top:i.current.scrollHeight,behavior:O});return}if(s.current){const Z=s.current.querySelector("[data-radix-scroll-area-viewport]");if(Z){i.current=Z,Z.scrollTo({top:Z.scrollHeight,behavior:O});return}}s.current&&s.current.scrollTo({top:s.current.scrollHeight,behavior:O})};E.useEffect(()=>{if(i.current){const{scrollHeight:O,clientHeight:Z,scrollTop:U}=i.current;(O-Z<=U+150||n!=="streaming")&&requestAnimationFrame(()=>{I(n==="streaming"?"smooth":"auto")})}},[T.length,n,c]),E.useEffect(()=>(n==="streaming"&&h?(l.current&&clearInterval(l.current),l.current=setInterval(()=>{I("smooth")},d)):l.current&&(clearInterval(l.current),l.current=null),()=>{l.current&&clearInterval(l.current)}),[n,d,h]),E.useEffect(()=>{const O=i.current;if(!O)return;const Z=()=>{if(!i.current)return;const{scrollHeight:U,clientHeight:H,scrollTop:L}=i.current,te=L<U-H-H*.5;o(te)};return O.addEventListener("scroll",Z,{passive:!0}),Z(),()=>{i.current&&i.current.removeEventListener("scroll",Z)}},[]),E.useEffect(()=>{if(s.current){const O=s.current.querySelector("[data-radix-scroll-area-viewport]");O&&(i.current=O)}},[]);const P=E.useMemo(()=>{const O=[];return[...t].sort((H,L)=>{var te,V;return H.index!==L.index?H.index-L.index:H.parentId===null&&L.parentId!==null?-1:H.parentId!==null&&L.parentId===null?1:H.parentId!==null&&L.parentId!==null&&H.parentId===L.parentId?H.index-L.index:(((te=H.startedAt)==null?void 0:te.getTime())??0)-(((V=L.startedAt)==null?void 0:V.getTime())??0)}).filter(H=>H.parentId===null&&!u2.includes(H.type)).forEach(H=>{var Q,ee;let L=null;if(H.type==="message.user_assistant"&&H.prompt)L=H.prompt;else if(H.type==="message.assistant_regen"&&((Q=H.metadata)!=null&&Q.regeneratedFromId)){let se,pe=H;const ue=new Set;for(;pe&&!ue.has(pe.id);){if(ue.add(pe.id),pe.type==="message.user_assistant"&&pe.prompt){se=pe;break}if((ee=pe.metadata)!=null&&ee.regeneratedFromId)pe=t.find(Oe=>Oe.id===pe.metadata.regeneratedFromId);else break}se?L=se.prompt:H.prompt?L=H.prompt:console.warn(`[ChatCanvas] Could not reliably find user prompt for active interaction ${H.id} of type ${H.type}. Displaying turn without prompt.`)}if(L)O.push(f.jsx(mT,{turnData:L,timestamp:H.startedAt,isAssistantComplete:H.status==="COMPLETED"||H.status==="ERROR",interactionId:H.id},`prompt-${H.id}`));else if(H.type!=="message.user_assistant"&&H.type!=="message.assistant_regen"){console.log("[ChatCanvas] Skipping active interaction on spine due to no user prompt and non-standard type:",H.id,H.type);return}const te=t.filter(se=>se.parentId===H.id&&!u2.includes(se.type)).sort((se,pe)=>se.index-pe.index),V=[H,...te];V.length>0&&O.push(f.jsx(aOe,{interactionGroup:V,renderSlot:(se,pe,ue)=>N("interaction",se,pe,ue),activeStreamingInteractionId:c.find(se=>V.some(pe=>pe.id===se))},`tabs-${H.id}`))}),O},[t,N,c]),B=E.useMemo(()=>c.filter(O=>!t.some(Z=>Z.id===O)).map(O=>f.jsx(dk,{interactionId:O,renderSlot:(Z,U,H)=>N("interaction",Z,U,H)},`${O}-streaming-new`)),[c,t,N]),D=()=>v||w||k?f.jsxs("div",{className:"space-y-4 p-2 md:p-4",children:[f.jsx(Wr,{className:"h-24 w-full"}),f.jsx(Wr,{className:"h-32 w-full"}),f.jsx(Wr,{className:"h-20 w-full"})]}):e?T.length===0&&n!=="streaming"&&c.length===0?f.jsx(v7,{}):f.jsxs("div",{className:"space-y-4 p-2 md:p-4 break-words",children:[P,B]}):f.jsx(v7,{}),W=u||"max-w-7xl";return f.jsx("div",{className:Xe("flex-grow relative",r),children:C?f.jsx(Yl,{className:"h-full w-full",children:f.jsx("div",{className:Xe("mx-auto w-full",W),children:f.jsx(o$e,{})})}):f.jsxs(f.Fragment,{children:[f.jsx(Yl,{className:"h-full w-full",ref:s,children:f.jsx("div",{className:Xe("mx-auto w-full",W),children:D()})}),a&&f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(mt,{variant:"outline",size:"icon",className:"absolute bottom-4 right-4 z-20 h-8 w-8 rounded-full shadow-md bg-background/80 backdrop-blur-sm hover:bg-muted",onClick:()=>I(),"aria-label":"Scroll to bottom",children:f.jsx(yH,{className:"h-4 w-4"})})}),f.jsx(Sr,{side:"left",children:"Scroll to Bottom"})]})}),n==="streaming"&&f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(mt,{variant:"outline",size:"icon",className:"absolute bottom-4 right-14 z-20 h-8 w-8 rounded-full shadow-md bg-background/80 backdrop-blur-sm hover:bg-muted",onClick:()=>m(!h),"aria-label":h?"Disable follow stream":"Enable follow stream",children:h?f.jsx(fge,{className:"h-4 w-4"}):f.jsx(mge,{className:"h-4 w-4"})})}),f.jsx(Sr,{side:"left",children:h?"Stop Following Stream":"Follow Stream"})]})})]})})},c$e=Ve.memo(l$e),o0=({controls:e,panelId:t,renderMode:n="full",className:r})=>{const s=e.filter(i=>(i.panel??"main")===t&&(i.show?i.show():!0));return s.length===0?null:f.jsx("div",{className:Xe(r),children:s.map(i=>{const a=n==="icon"?i.iconRenderer:i.renderer;return f.jsx(Ve.Fragment,{children:a?a():null},i.id)})})},Kw=qo(Vo((e,t)=>({isChatControlPanelOpen:{},isPromptControlPanelOpen:{},isSidebarCollapsed:!1,globalLoading:!1,globalError:null,focusInputOnNextRender:!1,toggleChatControlPanel:(n,r)=>{const s=t().isChatControlPanelOpen[n]??!1,i=r??!s;s!==i&&(e(a=>{a.isChatControlPanelOpen[n]=i}),Pe.emit(Or.chatControlPanelVisibilityChanged,{panelId:n,isOpen:i}))},togglePromptControlPanel:(n,r)=>{const s=t().isPromptControlPanelOpen[n]??!1,i=r??!s;s!==i&&(e(a=>{a.isPromptControlPanelOpen[n]=i}),Pe.emit(Or.promptControlPanelVisibilityChanged,{controlId:n,isOpen:i}))},toggleSidebar:n=>{const r=t().isSidebarCollapsed,s=n??!r;r!==s&&(e({isSidebarCollapsed:s}),Pe.emit(Or.sidebarVisibilityChanged,{isCollapsed:s}))},setGlobalLoading:n=>{t().globalLoading!==n&&(e({globalLoading:n}),Pe.emit(Or.globalLoadingChanged,{loading:n}))},setGlobalError:n=>{t().globalError!==n&&(e({globalError:n}),Pe.emit(Or.globalErrorChanged,{error:n}))},setFocusInputFlag:n=>{t().focusInputOnNextRender!==n&&(e({focusInputOnNextRender:n}),Pe.emit(Or.focusInputFlagChanged,{focus:n}))},getRegisteredActionHandlers:()=>{const n="uiStateStore",r=t();return[{eventName:Or.toggleSidebarRequest,handler:s=>r.toggleSidebar(s==null?void 0:s.isCollapsed),storeId:n},{eventName:Or.toggleChatControlPanelRequest,handler:s=>r.toggleChatControlPanel(s.panelId,s.isOpen),storeId:n},{eventName:Or.togglePromptControlPanelRequest,handler:s=>r.togglePromptControlPanel(s.controlId,s.isOpen),storeId:n},{eventName:Or.setGlobalLoadingRequest,handler:s=>r.setGlobalLoading(s.loading),storeId:n},{eventName:Or.setGlobalErrorRequest,handler:s=>r.setGlobalError(s.error),storeId:n},{eventName:Or.setFocusInputFlagRequest,handler:s=>r.setFocusInputFlag(s.focus),storeId:n}]}})));var u$e=(e,t,n,r,s,i,a,o)=>{let l=document.documentElement,c=["light","dark"];function u(m){(Array.isArray(e)?e:[e]).forEach(y=>{let b=y==="class",v=b&&i?s.map(x=>i[x]||x):s;b?(l.classList.remove(...v),l.classList.add(i&&i[m]?i[m]:m)):l.setAttribute(y,m)}),d(m)}function d(m){o&&c.includes(m)&&(l.style.colorScheme=m)}function h(){return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}if(r)u(r);else try{let m=localStorage.getItem(t)||n,y=a&&m==="system"?h():m;u(y)}catch{}},d$e=E.createContext(void 0),f$e={setTheme:e=>{},themes:[]},h$e=()=>{var e;return(e=E.useContext(d$e))!=null?e:f$e};E.memo(({forcedTheme:e,storageKey:t,attribute:n,enableSystem:r,enableColorScheme:s,defaultTheme:i,value:a,themes:o,nonce:l,scriptProps:c})=>{let u=JSON.stringify([n,t,i,e,o,a,r,s]).slice(1,-1);return E.createElement("script",{...c,suppressHydrationWarning:!0,nonce:typeof window>"u"?l:"",dangerouslySetInnerHTML:{__html:`(${u$e.toString()})(${u})`}})});const p$e=({...e})=>{const{theme:t="system"}=h$e();return f.jsx(X0e,{theme:t,className:"toaster group",style:{"--normal-bg":"var(--popover)","--normal-text":"var(--popover-foreground)","--normal-border":"var(--border)"},...e})};function Uo({className:e,...t}){return f.jsx("textarea",{"data-slot":"textarea",className:Xe("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),...t})}const gne=E.memo(E.forwardRef(({initialValue:e="",onSubmit:t,disabled:n,placeholder:r="Type message... (Shift+Enter for new line)",className:s,onValueChange:i,...a},o)=>{const l=E.useRef(null),[c,u]=E.useState(e);E.useImperativeHandle(o,()=>({getValue:()=>c,setValue:m=>{u(m),i&&i(m),Pe.emit(gn.inputChanged,{value:m}),requestAnimationFrame(()=>{const y=l.current;y&&(y.style.height="auto",y.style.height=`${y.scrollHeight}px`,y.style.overflowY=y.scrollHeight>250?"auto":"hidden")})},focus:()=>{var m;return(m=l.current)==null?void 0:m.focus()},clearValue:()=>{u(""),i&&i(""),Pe.emit(gn.inputChanged,{value:""}),requestAnimationFrame(()=>{const m=l.current;m&&(m.style.height="auto",m.style.height=`${m.scrollHeight}px`,m.style.overflowY="hidden")})}}));const d=m=>{var y;if(m.key==="Enter"&&!m.shiftKey&&!n){m.preventDefault();const b=bh.getState().attachedFilesMetadata.length>0;(c.trim().length>0||b)&&(t(),(y=o==null?void 0:o.current)==null||y.clearValue())}},h=m=>{const y=m.target.value;u(y),i&&i(y),Pe.emit(gn.inputChanged,{value:y})};return E.useEffect(()=>{const m=l.current;if(m){m.style.height="auto";const y=m.scrollHeight,b=250;m.style.height=`${Math.min(y,b)}px`,m.style.overflowY=y>b?"auto":"hidden"}},[c]),E.useEffect(()=>{e!==c&&(u(e),i&&i(e))},[e,i]),E.useEffect(()=>{const m=y=>{u(y.text),i&&i(y.text),Pe.emit(gn.inputChanged,{value:y.text}),requestAnimationFrame(()=>{const b=l.current;b&&(b.style.height="auto",b.style.height=`${b.scrollHeight}px`,b.style.overflowY=b.scrollHeight>250?"auto":"hidden")})};return Pe.on(gn.setInputTextRequest,m),()=>{Pe.off(gn.setInputTextRequest,m)}},[i]),f.jsx(Uo,{ref:l,value:c,onChange:h,onKeyDown:d,disabled:n,placeholder:r,rows:1,className:Xe("w-full p-3 border rounded bg-input text-foreground resize-none focus:ring-2 focus:ring-primary outline-none disabled:opacity-50 overflow-y-auto","min-h-[40px] max-h-[250px]",s),"aria-label":"Chat input",...a})}));gne.displayName="InputArea";const Ai={dbModsLoaded:"mod.db.mods.loaded",loadedInstancesChanged:"mod.loaded.instances.changed",settingsTabsChanged:"mod.settings.tabs.changed",loadingStateChanged:"mod.loading.state.changed",modLoaded:"mod.sdk.loaded",modError:"mod.sdk.error",loadDbModsRequest:"mod.load.db.mods.request",addDbModRequest:"mod.add.db.mod.request",updateDbModRequest:"mod.update.db.mod.request",deleteDbModRequest:"mod.delete.db.mod.request"},jh=qo(Vo((e,t)=>({dbMods:[],loadedMods:[],modSettingsTabs:[],isLoading:!1,error:null,loadDbMods:async()=>{e({isLoading:!0,error:null});try{const n=await _t.loadMods();e({dbMods:n,isLoading:!1}),Pe.emit(Ai.dbModsLoaded,{dbMods:n})}catch(n){const r="Failed to load mods";console.error("ModStore: Error loading mods",n),e({error:r,isLoading:!1}),Pe.emit(Ai.loadingStateChanged,{isLoading:!1,error:r}),Me.error(r)}},addDbMod:async n=>{const r=as(),s={id:r,createdAt:new Date,...n,loadOrder:n.loadOrder??Date.now()};e(i=>{i.dbMods.push(s),i.dbMods.sort((a,o)=>a.loadOrder-o.loadOrder)});try{return await _t.saveMod(s),Me.success(`Mod "${s.name}" added.`),Pe.emit(Ai.dbModsLoaded,{dbMods:t().dbMods}),r}catch(i){const a="Failed to save new mod";throw console.error("ModStore: Error adding mod",i),e(o=>{o.dbMods=o.dbMods.filter(l=>l.id!==r),o.error=a}),Pe.emit(Ai.loadingStateChanged,{isLoading:t().isLoading,error:a}),Me.error(a),i}},updateDbMod:async(n,r)=>{let s,i=-1;e(o=>{i=o.dbMods.findIndex(l=>l.id===n),i!==-1?(s={...o.dbMods[i]},o.dbMods[i]={...o.dbMods[i],...r},r.loadOrder!==void 0&&o.dbMods.sort((l,c)=>l.loadOrder-c.loadOrder)):console.warn(`ModStore: Mod ${n} not found for update.`)});const a=i!==-1?t().dbMods[i]:void 0;if(a)try{await _t.saveMod(a),Me.success(`Mod "${a.name}" updated.`),Pe.emit(Ai.dbModsLoaded,{dbMods:t().dbMods})}catch(o){const l="Failed to save mod update";throw console.error("ModStore: Error updating mod",o),e(c=>{const u=c.dbMods.findIndex(d=>d.id===n);u!==-1&&s&&(c.dbMods[u]=s,c.dbMods.sort((d,h)=>d.loadOrder-h.loadOrder)),c.error=l}),Pe.emit(Ai.loadingStateChanged,{isLoading:t().isLoading,error:l}),Me.error(l),o}},deleteDbMod:async n=>{const r=t().dbMods.find(i=>i.id===n);if(!r){console.warn(`ModStore: Mod ${n} not found for deletion.`);return}const s=r.name;e(i=>({dbMods:i.dbMods.filter(a=>a.id!==n)}));try{await _t.deleteMod(n),Me.success(`Mod "${s}" deleted.`),Pe.emit(Ai.dbModsLoaded,{dbMods:t().dbMods})}catch(i){const a="Failed to delete mod";throw console.error("ModStore: Error deleting mod",i),e(o=>{o.dbMods.push(r),o.dbMods.sort((l,c)=>l.loadOrder-c.loadOrder),o.error=a}),Pe.emit(Ai.loadingStateChanged,{isLoading:t().isLoading,error:a}),Me.error(a),i}},setLoadedMods:n=>{e({loadedMods:n}),Pe.emit(Ai.loadedInstancesChanged,{loadedMods:n})},_addSettingsTab:n=>{e(r=>{if(!r.modSettingsTabs.some(s=>s.id===n.id))r.modSettingsTabs.push(n),r.modSettingsTabs.sort((s,i)=>(s.order??999)-(i.order??999));else{console.warn(`ModStore: Settings tab with ID "${n.id}" already registered. Overwriting.`);const s=r.modSettingsTabs.findIndex(i=>i.id===n.id);r.modSettingsTabs[s]=n,r.modSettingsTabs.sort((i,a)=>(i.order??999)-(a.order??999))}}),Pe.emit(Ai.settingsTabsChanged,{tabs:t().modSettingsTabs})},_removeSettingsTab:n=>{e(r=>{r.modSettingsTabs=r.modSettingsTabs.filter(s=>s.id!==n)}),Pe.emit(Ai.settingsTabsChanged,{tabs:t().modSettingsTabs})},getRegisteredActionHandlers:()=>{const n="modStore",r=t(),s=i=>async a=>{await i(a)};return[{eventName:Ai.loadDbModsRequest,handler:r.loadDbMods,storeId:n},{eventName:Ai.addDbModRequest,handler:s(r.addDbMod),storeId:n},{eventName:Ai.updateDbModRequest,handler:i=>r.updateDbMod(i.id,i.changes),storeId:n},{eventName:Ai.deleteDbModRequest,handler:i=>r.deleteDbMod(i.id),storeId:n}]}}))),ap={loaded:"app.loaded",errorBoundaryTriggered:"app.error.boundary.triggered",initializationPhaseCompleted:"app.initialization.phase.completed"};function T4(e){const t=e.id,n=e.name;return{modId:t,modName:n,registerPromptControl:s=>(Pe.emit($r.registerPromptControlRequest,{control:s}),()=>Pe.emit($r.unregisterPromptControlRequest,{id:s.id})),registerChatControl:s=>{const i={...s,status:s.status??(()=>"ready")};return Pe.emit($r.registerChatControlRequest,{control:i}),()=>Pe.emit($r.unregisterChatControlRequest,{id:s.id})},registerCanvasControl:s=>(Pe.emit($r.registerCanvasControlRequest,{control:s}),()=>Pe.emit($r.unregisterCanvasControlRequest,{id:s.id})),registerBlockRenderer:s=>(Pe.emit(y0.registerBlockRendererRequest,{renderer:s}),()=>Pe.emit(y0.unregisterBlockRendererRequest,{id:s.id})),registerTool:(s,i,a)=>(console.log(`[${n}] Registering tool: ${s}`),Pe.emit($r.registerToolRequest,{modId:t,toolName:s,definition:i,implementation:a}),()=>Pe.emit($r.unregisterToolRequest,{toolName:s})),on:(s,i)=>(Pe.on(s,i),()=>Pe.off(s,i)),emit:(s,i)=>{Pe.emit(s,i)},addMiddleware:(s,i)=>(Pe.emit($r.registerMiddlewareRequest,{hookName:s,modId:t,callback:i}),()=>Pe.emit($r.unregisterMiddlewareRequest,{hookName:s,modId:t,callback:i})),registerSettingsTab:s=>(jh.getState()._addSettingsTab(s),()=>jh.getState()._removeSettingsTab(s.id)),getContextSnapshot:()=>{const s=vn.getState(),i=qn.getState(),a=br.getState(),o=Cr.getState(),{providerId:l}=Tc(o.selectedModelId),c=i.selectedItemType==="conversation"?i.selectedItemId:null;return Object.freeze({selectedConversationId:c,interactions:Object.freeze(s.currentConversationId===c?s.interactions.map(u=>Object.freeze({...u})):[]),isStreaming:s.status==="streaming",selectedProviderId:l,selectedModelId:o.selectedModelId,activeSystemPrompt:a.globalSystemPrompt,temperature:a.temperature,maxTokens:a.maxTokens,theme:a.theme,gitUserName:a.gitUserName,gitUserEmail:a.gitUserEmail})},showToast:(s,i)=>{Me[s](`[Mod: ${n}] ${i}`)},log:(s,...i)=>{console[s](`[Mod: ${n}]`,...i)},registerModalProvider:(s,i)=>(Pe.emit($r.registerModalProviderRequest,{modalId:s,provider:i}),()=>Pe.emit($r.unregisterModalProviderRequest,{modalId:s})),getVfsInstance:async s=>ei.getState().initializeVFS(s,{force:!0})}}async function m$e(e){const t=e.filter(r=>r.enabled),n=await Promise.all(t.map(async r=>{let s=r.scriptContent,i=null,a=null;try{if(i=T4(r),r.sourceUrl){console.log(`[ModLoader] Fetching script for ${r.name} from ${r.sourceUrl}`);try{const c=await fetch(r.sourceUrl);if(!c.ok)throw new Error(`Failed to fetch mod script: ${c.status} ${c.statusText}`);s=await c.text(),console.log(`[ModLoader] Successfully fetched script for ${r.name}`)}catch(c){throw console.error(`[ModLoader] Error fetching script from ${r.sourceUrl}:`,c),c}}if(!s)throw new Error("Mod script content is empty.");new Function("modApi",s)(i),console.log(`[ModLoader] Successfully executed script for ${r.name}`)}catch(l){a=l instanceof Error?l:String(l),console.error(`[ModLoader] Error loading mod "${r.name}":`,l),Me.error(`Error loading mod "${r.name}": ${a instanceof Error?a.message:a}`)}i||(i=T4(r));const o={id:r.id,name:r.name,api:i,error:a};return Pe.emit(o.error?Ai.modError:Ai.modLoaded,{id:r.id,name:r.name,error:o.error??"unknown error"}),o}));return Pe.emit(ap.loaded,void 0),console.log(`[ModLoader] Finished processing ${n.length} mods.`),n}const yr={dataLoaded:"rules.data.loaded",ruleSaved:"rules.rule.saved",ruleDeleted:"rules.rule.deleted",tagSaved:"rules.tag.saved",tagDeleted:"rules.tag.deleted",linkSaved:"rules.link.saved",linkDeleted:"rules.link.deleted",loadingStateChanged:"rules.loading.state.changed",loadRulesAndTagsRequest:"rules.load.rules.and.tags.request",addRuleRequest:"rules.add.rule.request",updateRuleRequest:"rules.update.rule.request",deleteRuleRequest:"rules.delete.rule.request",addTagRequest:"rules.add.tag.request",updateTagRequest:"rules.update.tag.request",deleteTagRequest:"rules.delete.tag.request",linkTagToRuleRequest:"rules.link.tag.to.rule.request",unlinkTagFromRuleRequest:"rules.unlink.tag.from.rule.request"},pq=null;class g$e{static async applyBundledConfig(t){{console.log("[BundledConfig] No bundled user configuration found, skipping...");return}}static hasBundledConfig(){return pq!==null}static getBundledConfig(){return pq}}class Yw{static async syncAll(t={}){const n={syncRepos:!0,syncConversations:!0,continueOnError:!0,maxConcurrent:3,...t};if(this.isRunning){Me.warning("Bulk sync already in progress");return}this.isRunning=!0,this.abortController=new AbortController;const r=qn.getState(),s=r.syncRepos,i=r.conversations.filter(o=>o.syncRepoId),a={totalRepos:n.syncRepos?s.length:0,completedRepos:0,totalConversations:n.syncConversations?i.length:0,completedConversations:0,currentOperation:"Starting bulk sync...",errors:[]};try{Pe.emit(ds.bulkSyncStarted,{progress:a}),Me.info(`Starting bulk sync: ${s.length} repositories, ${i.length} conversations`),n.syncRepos&&s.length>0&&await this.syncRepositoriesInBatches(s,n,a),n.syncConversations&&i.length>0&&await this.syncConversationsInBatches(i,n,a);const o=a.errors.length>0;Pe.emit(ds.bulkSyncCompleted,{progress:a,success:!o}),o?(Me.warning(`Bulk sync completed with ${a.errors.length} errors. Check console for details.`),console.warn("Bulk sync errors:",a.errors)):Me.success("Bulk sync completed successfully!")}catch(o){console.error("Bulk sync failed:",o),Me.error(`Bulk sync failed: ${o instanceof Error?o.message:"Unknown error"}`),Pe.emit(ds.bulkSyncFailed,{progress:a,error:String(o)})}finally{this.isRunning=!1,this.abortController=null}}static async syncPendingConversations(){const t=qn.getState(),n=t.conversations.filter(r=>{const s=t.conversationSyncStatus[r.id];return r.syncRepoId&&s==="needs-sync"});if(n.length===0){Me.info("No conversations need syncing");return}Me.info(`Syncing ${n.length} pending conversations...`),await this.syncAll({syncRepos:!1,syncConversations:!0,continueOnError:!0,maxConcurrent:2})}static async initializeAllRepositories(){const n=qn.getState().syncRepos;if(n.length===0){Me.info("No repositories configured");return}Me.info(`Initializing ${n.length} repositories...`),await this.syncAll({syncRepos:!0,syncConversations:!1,continueOnError:!0,maxConcurrent:2})}static abort(){this.isRunning&&this.abortController&&(this.abortController.abort(),Me.info("Bulk sync operation cancelled"))}static isActive(){return this.isRunning}static async syncRepositoriesInBatches(t,n,r){var i;r.currentOperation="Initializing repositories...",Pe.emit(ds.bulkSyncProgress,{progress:r});const s=this.createBatches(t,n.maxConcurrent);for(const a of s){if((i=this.abortController)!=null&&i.signal.aborted)throw new Error("Operation cancelled");const o=a.map(async l=>{try{r.currentOperation=`Syncing repository: ${l.name}`,Pe.emit(ds.bulkSyncProgress,{progress:r}),await qn.getState().initializeOrSyncRepo(l.id,!0),r.completedRepos++}catch(c){const u=c instanceof Error?c.message:String(c);if(r.errors.push({type:"repo",id:l.id,error:u}),console.error(`Failed to sync repository ${l.name}:`,c),!n.continueOnError)throw c}});await Promise.all(o),Pe.emit(ds.bulkSyncProgress,{progress:r})}}static async syncConversationsInBatches(t,n,r){var i;r.currentOperation="Syncing conversations...",Pe.emit(ds.bulkSyncProgress,{progress:r});const s=this.createBatches(t,n.maxConcurrent);for(const a of s){if((i=this.abortController)!=null&&i.signal.aborted)throw new Error("Operation cancelled");const o=a.map(async l=>{try{r.currentOperation=`Syncing conversation: ${l.title}`,Pe.emit(ds.bulkSyncProgress,{progress:r}),await qn.getState().syncConversation(l.id,!0),r.completedConversations++}catch(c){const u=c instanceof Error?c.message:String(c);if(r.errors.push({type:"conversation",id:l.id,error:u}),console.error(`Failed to sync conversation ${l.title}:`,c),!n.continueOnError)throw c}});await Promise.all(o),Pe.emit(ds.bulkSyncProgress,{progress:r})}}static createBatches(t,n){const r=[];for(let s=0;s<t.length;s+=n)r.push(t.slice(s,s+n));return r}}de(Yw,"isRunning",!1),de(Yw,"abortController",null);const L0=Object.freeze(Object.defineProperty({__proto__:null,BulkSyncService:Yw},Symbol.toStringTag,{value:"Module"}));class yne{static async runStartupSync(){if(!this.hasRunStartupSync){this.hasRunStartupSync=!0;try{const t=qn.getState(),n=br.getState();await new Promise(o=>setTimeout(o,1e3));const r=t.syncRepos,s=t.conversations.filter(o=>o.syncRepoId);if(r.length===0){console.log("[StartupSync] No repositories configured, skipping startup sync");return}console.log(`[StartupSync] Found ${r.length} repositories and ${s.length} synced conversations`);const i=r.filter(o=>{const l=t.repoInitializationStatus[o.id];return!l||l==="error"});i.length>0&&n.autoInitializeReposOnStartup?(console.log(`[StartupSync] Initializing ${i.length} repositories in background`),setTimeout(async()=>{try{await Yw.syncAll({syncRepos:!0,syncConversations:!1,continueOnError:!0,maxConcurrent:1})}catch(o){console.warn("[StartupSync] Background repo initialization failed:",o)}},2e3)):i.length>0&&console.log(`[StartupSync] Found ${i.length} uninitialized repositories, but auto-initialization is disabled`);const a=s.filter(o=>t.conversationSyncStatus[o.id]==="needs-sync");a.length>0&&n.autoSyncOnStreamComplete&&(console.log(`[StartupSync] Found ${a.length} conversations pending sync`),setTimeout(async()=>{try{await Yw.syncPendingConversations()}catch(o){console.warn("[StartupSync] Background conversation sync failed:",o)}},5e3))}catch(t){console.error("[StartupSync] Startup sync failed:",t)}}}static reset(){this.hasRunStartupSync=!1}}de(yne,"hasRunStartupSync",!1);function y$e(e){const t=new Map(e.map(a=>[a.id,a])),n=new Set,r=new Set,s=[];function i(a){if(n.has(a.id))return!0;if(r.has(a.id))return console.error(`[Init] Circular dependency detected involving module: ${a.id}`),Me.error("Initialization Error: Circular dependency in controls."),!1;r.add(a.id);for(const o of a.dependencies??[]){const l=t.get(o);if(!l)return console.error(`[Init] Missing dependency "${o}" for module "${a.id}"`),Me.error(`Initialization Error: Missing dependency "${o}" for "${a.id}".`),r.delete(a.id),!1;if(!i(l))return r.delete(a.id),!1}return r.delete(a.id),n.add(a.id),s.push(a),!0}for(const a of e)if(!n.has(a.id)&&!i(a))return null;return s}async function b$e(e,t){console.log("[Init] Core Data: Applying bundled configuration..."),await g$e.applyBundledConfig(),console.log("[Init] Core Data: Requesting loads..."),t.emit(sn.loadSettingsRequest,void 0),t.emit(Qn.loadInitialDataRequest,void 0),t.emit(yr.loadRulesAndTagsRequest,void 0),t.emit(Jn.loadConversationsRequest,void 0),t.emit(_a.loadProjectsRequest,void 0),await new Promise(n=>{let r=!1,s=!1,i=!1,a=!1,o=!1;const l=()=>{r&&s&&i&&a&&o&&n()},c=t.on(sn.loaded,()=>{r=!0,c(),l()}),u=t.on(Qn.initialDataLoaded,()=>{s=!0,u(),l()}),d=t.on(yr.dataLoaded,()=>{i=!0,d(),l()}),h=t.on(Jn.conversationsLoaded,()=>{a=!0,h(),l()}),m=t.on(_a.loaded,()=>{o=!0,m(),l()})}),Pe.emit(ap.initializationPhaseCompleted,{phase:"coreData"}),console.log("[Init] Core Data: Loaded (or load requested)."),setTimeout(()=>{yne.runStartupSync().catch(n=>{console.warn("[Init] Startup sync failed:",n)})},1e3)}async function v$e(e,t){console.log("[Init] Control Modules: Instantiation & Dependency Resolution START");const n=e.map(s=>new s),r=y$e(n);if(!r)throw console.error("[Init] Control Modules: Dependency resolution FAILED."),new Error("Failed to resolve control module dependency order.");console.log(`[Init] Control Modules: Dependency order resolved (${r.length} modules):`,r.map(s=>s.id)),console.log("[Init] Control Modules: Instantiation & Dependency Resolution COMPLETE"),console.log("[Init] Control Modules: Initialization START");for(const s of r)try{await s.initialize(t)}catch(i){console.error(`[Init] Error initializing module "${s.id}":`,i),Me.error(`Module Init Error (${s.id}): ${i instanceof Error?i.message:String(i)}`)}return Pe.emit(ap.initializationPhaseCompleted,{phase:"controlModulesInit"}),console.log("[Init] Control Modules: Initialization COMPLETE."),r}function x$e(e,t){console.log("[Init] Control Modules: Registration START");for(const n of e)try{n.register(t)}catch(r){console.error(`[Init] Error registering module "${n.id}":`,r),Me.error(`Module Registration Error (${n.id}): ${r instanceof Error?r.message:String(r)}`)}Pe.emit(ap.initializationPhaseCompleted,{phase:"controlModulesRegister"}),console.log("[Init] Control Modules: Registration COMPLETE.")}async function w$e(e,t){console.log("[Init] External Mods: Loading DB records..."),t.emit(Ai.loadDbModsRequest,void 0),await new Promise(s=>{const i=t.on(Ai.dbModsLoaded,()=>{i(),s()})});const n=jh.getState().dbMods;console.log(`[Init] External Mods: Processing ${n.length} mods...`);const r=await m$e(n);jh.getState().setLoadedMods(r),Pe.emit(ap.initializationPhaseCompleted,{phase:"externalMods"}),console.log(`[Init] External Mods: ${r.length} mods processed.`)}function _$e(e,t){var a;console.log("[Init] Core UI States: Initializing...");const n=e.selectedItemId,r=e.selectedItemType,s=r==="project"?n:r==="conversation"?((a=e.getConversationById(n))==null?void 0:a.projectId)??null:null,i=e.getEffectiveProjectSettings(s);t.emit(gn.initializePromptStateRequest,{effectiveSettings:i}),Pe.emit(ap.initializationPhaseCompleted,{phase:"uiStateSync"}),console.log("[Init] Core UI States: Initial prompt state synchronization requested.")}async function S$e(e,t){console.log("[Init] LiteChat Full Initialization START"),pm.initializeCanvasEventHandlers();const n={requestLoadSettings:()=>t.emit(sn.loadSettingsRequest,void 0),requestLoadProviderData:()=>t.emit(Qn.loadInitialDataRequest,void 0),requestLoadRulesAndTags:()=>t.emit(yr.loadRulesAndTagsRequest,void 0),requestLoadConversations:()=>t.emit(Jn.loadConversationsRequest,void 0),requestLoadProjects:()=>t.emit(_a.loadProjectsRequest,void 0),requestLoadDbMods:()=>t.emit(Ai.loadDbModsRequest,void 0),setLoadedMods:jh.getState().setLoadedMods,getConversationById:qn.getState().getConversationById,getEffectiveProjectSettings:zo.getState().getEffectiveProjectSettings,initializePromptState:Fo.getState().initializePromptState,selectedItemId:qn.getState().selectedItemId,selectedItemType:qn.getState().selectedItemType};let r=[];try{await b$e(n,t),r=await v$e(e,t),x$e(r,t),await w$e(n,t),_$e(n,t),Pe.emit(ap.initializationPhaseCompleted,{phase:"all"}),console.log("LiteChat: Full initialization sequence COMPLETE.")}catch(s){throw console.error("LiteChat: Full initialization sequence FAILED:",s),Me.error(`Initialization sequence failed: ${s instanceof Error?s.message:String(s)}`),Kw.getState().setGlobalError("Initialization sequence failed."),s}return r}const bne=qo(Vo((e,t)=>({rules:[],tags:[],tagRuleLinks:[],isLoading:!1,error:null,loadRulesAndTags:async()=>{e({isLoading:!0,error:null});try{const[n,r,s]=await Promise.all([_t.loadRules(),_t.loadTags(),_t.loadTagRuleLinks()]);e({rules:n,tags:r,tagRuleLinks:s,isLoading:!1}),Pe.emit(yr.dataLoaded,{rules:n,tags:r,links:s})}catch(n){console.error("RulesStore: Error loading rules and tags",n),e({error:"Failed load rules/tags",isLoading:!1}),Me.error("Failed to load rules and tags."),Pe.emit(yr.loadingStateChanged,{isLoading:!1,error:"Failed load rules/tags"})}},addRule:async n=>{const r=as(),s=new Date,i={id:r,createdAt:s,updatedAt:s,...n};e(a=>{a.rules.push(i),a.rules.sort((o,l)=>o.name.localeCompare(l.name))});try{await _t.saveRule(i),Me.success(`Rule "${i.name}" added.`),Pe.emit(yr.ruleSaved,{rule:i});const{rules:a,tags:o,tagRuleLinks:l}=t();return Pe.emit(yr.dataLoaded,{rules:[...a],tags:[...o],links:[...l]}),r}catch(a){throw console.error("RulesStore: Error adding rule",a),e(o=>({error:"Failed to save new rule",rules:o.rules.filter(l=>l.id!==r)})),Me.error("Failed to save new rule."),a}},updateRule:async(n,r)=>{const s=t().rules.find(a=>a.id===n);if(!s)throw Me.error("Rule not found for update."),new Error("Rule not found");const i={...s,...r,updatedAt:new Date};e(a=>{const o=a.rules.findIndex(l=>l.id===n);o!==-1&&(a.rules[o]=i,a.rules.sort((l,c)=>l.name.localeCompare(c.name)))});try{await _t.saveRule(i),Me.success(`Rule "${i.name}" updated.`),Pe.emit(yr.ruleSaved,{rule:i});const{rules:a,tags:o,tagRuleLinks:l}=t();Pe.emit(yr.dataLoaded,{rules:[...a],tags:[...o],links:[...l]})}catch(a){throw console.error("RulesStore: Error updating rule",a),e(o=>{const l=o.rules.findIndex(c=>c.id===n);l!==-1&&(o.rules[l]=s,o.rules.sort((c,u)=>c.name.localeCompare(u.name))),o.error="Failed to save rule update"}),Me.error("Failed to save rule update."),a}},deleteRule:async n=>{const r=t().rules.find(a=>a.id===n);if(!r)throw Me.error("Rule not found for deletion."),new Error("Rule not found");const s=[...t().tagRuleLinks.filter(a=>a.ruleId===n)],i={...r};e(a=>{a.rules=a.rules.filter(o=>o.id!==n),a.tagRuleLinks=a.tagRuleLinks.filter(o=>o.ruleId!==n)});try{await _t.deleteRule(n),Me.success(`Rule "${r.name}" deleted.`),Pe.emit(yr.ruleDeleted,{ruleId:n});const{rules:a,tags:o,tagRuleLinks:l}=t();Pe.emit(yr.dataLoaded,{rules:[...a],tags:[...o],links:[...l]})}catch(a){throw console.error("RulesStore: Error deleting rule",a),e(o=>{o.rules.find(l=>l.id===i.id)||(o.rules.push(i),o.rules.sort((l,c)=>l.name.localeCompare(c.name))),s.forEach(l=>{o.tagRuleLinks.find(c=>c.tagId===l.tagId&&c.ruleId===l.ruleId)||o.tagRuleLinks.push(l)}),o.error="Failed to delete rule"}),Me.error("Failed to delete rule."),a}},addTag:async n=>{const r=as(),s=new Date,i={id:r,createdAt:s,updatedAt:s,...n};e(a=>{a.tags.push(i),a.tags.sort((o,l)=>o.name.localeCompare(l.name))});try{await _t.saveTag(i),Me.success(`Tag "${i.name}" added.`),Pe.emit(yr.tagSaved,{tag:i});const{rules:a,tags:o,tagRuleLinks:l}=t();return Pe.emit(yr.dataLoaded,{rules:[...a],tags:[...o],links:[...l]}),r}catch(a){throw console.error("RulesStore: Error adding tag",a),e(o=>({error:"Failed to save new tag",tags:o.tags.filter(l=>l.id!==r)})),Me.error("Failed to save new tag."),a}},updateTag:async(n,r)=>{const s=t().tags.find(a=>a.id===n);if(!s)throw Me.error("Tag not found for update."),new Error("Tag not found");const i={...s,...r,updatedAt:new Date};e(a=>{const o=a.tags.findIndex(l=>l.id===n);o!==-1&&(a.tags[o]=i,a.tags.sort((l,c)=>l.name.localeCompare(c.name)))});try{await _t.saveTag(i),Me.success(`Tag "${i.name}" updated.`),Pe.emit(yr.tagSaved,{tag:i});const{rules:a,tags:o,tagRuleLinks:l}=t();Pe.emit(yr.dataLoaded,{rules:[...a],tags:[...o],links:[...l]})}catch(a){throw console.error("RulesStore: Error updating tag",a),e(o=>{const l=o.tags.findIndex(c=>c.id===n);l!==-1&&(o.tags[l]=s,o.tags.sort((c,u)=>c.name.localeCompare(u.name))),o.error="Failed to save tag update"}),Me.error("Failed to save tag update."),a}},deleteTag:async n=>{const r=t().tags.find(a=>a.id===n);if(!r)throw Me.error("Tag not found for deletion."),new Error("Tag not found");const s={...r},i=[...t().tagRuleLinks.filter(a=>a.tagId===n)];e(a=>{a.tags=a.tags.filter(o=>o.id!==n),a.tagRuleLinks=a.tagRuleLinks.filter(o=>o.tagId!==n)});try{await _t.deleteTag(n),Me.success(`Tag "${r.name}" deleted.`),Pe.emit(yr.tagDeleted,{tagId:n});const{rules:a,tags:o,tagRuleLinks:l}=t();Pe.emit(yr.dataLoaded,{rules:[...a],tags:[...o],links:[...l]})}catch(a){throw console.error("RulesStore: Error deleting tag",a),e(o=>{o.tags.find(l=>l.id===s.id)||(o.tags.push(s),o.tags.sort((l,c)=>l.name.localeCompare(c.name))),i.forEach(l=>{o.tagRuleLinks.find(c=>c.tagId===l.tagId&&c.ruleId===l.ruleId)||o.tagRuleLinks.push(l)}),o.error="Failed to delete tag"}),Me.error("Failed to delete tag."),a}},linkTagToRule:async(n,r)=>{const s=`${n}-${r}`;if(t().tagRuleLinks.some(a=>a.id===s)){Me.info("Link already exists.");return}const i={id:s,tagId:n,ruleId:r};e(a=>{a.tagRuleLinks.push(i)});try{await _t.saveTagRuleLink(i),Me.success("Tag linked to rule."),yr.linkSaved&&Pe.emit(yr.linkSaved,{link:i});const{rules:a,tags:o,tagRuleLinks:l}=t();Pe.emit(yr.dataLoaded,{rules:[...a],tags:[...o],links:[...l]})}catch(a){throw console.error("RulesStore: Error linking tag to rule",a),e(o=>{o.tagRuleLinks=o.tagRuleLinks.filter(l=>l.id!==s),o.error="Failed to link tag to rule"}),Me.error("Failed to link tag to rule."),a}},unlinkTagFromRule:async(n,r)=>{const s=`${n}-${r}`,i=t().tagRuleLinks.find(a=>a.id===s);i||Me.info("Link not found for unlinking."),e(a=>{a.tagRuleLinks=a.tagRuleLinks.filter(o=>o.id!==s)});try{await _t.deleteTagRuleLink(s),Me.success("Tag unlinked from rule."),yr.linkDeleted&&Pe.emit(yr.linkDeleted,{linkId:s});const{rules:a,tags:o,tagRuleLinks:l}=t();Pe.emit(yr.dataLoaded,{rules:[...a],tags:[...o],links:[...l]})}catch(a){throw console.error("RulesStore: Error unlinking tag from rule",a),i&&e(o=>{o.tagRuleLinks.some(l=>l.id===i.id)||o.tagRuleLinks.push(i),o.error="Failed to unlink tag from rule"}),Me.error("Failed to unlink tag from rule."),a}},getRulesForTag:n=>{const r=t(),s=new Set(r.tagRuleLinks.filter(i=>i.tagId===n).map(i=>i.ruleId));return r.rules.filter(i=>s.has(i.id))},getTagsForRule:n=>{const r=t(),s=new Set(r.tagRuleLinks.filter(i=>i.ruleId===n).map(i=>i.tagId));return r.tags.filter(i=>s.has(i.id))},getRuleById:n=>t().rules.find(r=>r.id===n),getTagById:n=>t().tags.find(r=>r.id===n),getRulesByIds:n=>{const r=new Set(n);return t().rules.filter(s=>r.has(s.id))},getRegisteredActionHandlers:()=>{const n="rulesStore",r=t(),s=i=>async a=>{await i(a)};return[{eventName:yr.loadRulesAndTagsRequest,handler:r.loadRulesAndTags,storeId:n},{eventName:yr.addRuleRequest,handler:s(r.addRule),storeId:n},{eventName:yr.updateRuleRequest,handler:i=>r.updateRule(i.id,i.updates),storeId:n},{eventName:yr.deleteRuleRequest,handler:i=>r.deleteRule(i.id),storeId:n},{eventName:yr.addTagRequest,handler:s(r.addTag),storeId:n},{eventName:yr.updateTagRequest,handler:i=>r.updateTag(i.id,i.updates),storeId:n},{eventName:yr.deleteTagRequest,handler:i=>r.deleteTag(i.id),storeId:n},{eventName:yr.linkTagToRuleRequest,handler:i=>r.linkTagToRule(i.tagId,i.ruleId),storeId:n},{eventName:yr.unlinkTagFromRuleRequest,handler:i=>r.unlinkTagFromRule(i.tagId,i.ruleId),storeId:n}]}}))),Qa={promptTemplatesChanged:"prompt-template.prompts.changed",promptTemplateAdded:"prompt-template.added",promptTemplateUpdated:"prompt-template.updated",promptTemplateDeleted:"prompt-template.deleted",loadPromptTemplatesRequest:"prompt-template.load.request",addPromptTemplateRequest:"prompt-template.add.request",updatePromptTemplateRequest:"prompt-template.update.request",deletePromptTemplateRequest:"prompt-template.delete.request",selectPromptTemplateRequest:"prompt-template.select.request",compilePromptTemplateRequest:"prompt-template.compile.request"},Mm=qo(Vo((e,t)=>({promptTemplates:[],loading:!1,error:null,loadPromptTemplates:async()=>{e(n=>{n.loading=!0,n.error=null});try{const n=await _t.loadPromptTemplates();e(r=>{r.promptTemplates=n,r.loading=!1}),Pe.emit(Qa.promptTemplatesChanged,{promptTemplates:n})}catch(n){const r=n instanceof Error?n.message:"Failed to load prompt templates";e(s=>{s.error=r,s.loading=!1}),Me.error(r)}},addPromptTemplate:async n=>{const r={id:as(),createdAt:new Date,updatedAt:new Date,...n};e(s=>{s.promptTemplates.push(r)});try{return await _t.savePromptTemplate(r),Pe.emit(Qa.promptTemplateAdded,{promptTemplate:r}),Me.success("Prompt template created successfully"),r.id}catch(s){e(a=>{a.promptTemplates=a.promptTemplates.filter(o=>o.id!==r.id)});const i=s instanceof Error?s.message:"Failed to create prompt template";throw e(a=>{a.error=i}),Me.error(i),s}},updatePromptTemplate:async(n,r)=>{const s=t().promptTemplates.find(a=>a.id===n);if(!s){Me.error("Prompt template not found");return}const i={...s,...r,updatedAt:new Date};e(a=>{const o=a.promptTemplates.findIndex(l=>l.id===n);o!==-1&&(a.promptTemplates[o]=i)});try{await _t.savePromptTemplate(i),Pe.emit(Qa.promptTemplateUpdated,{promptTemplate:i}),Me.success("Prompt template updated successfully")}catch(a){e(l=>{const c=l.promptTemplates.findIndex(u=>u.id===n);c!==-1&&(l.promptTemplates[c]=s)});const o=a instanceof Error?a.message:"Failed to update prompt template";throw e(l=>{l.error=o}),Me.error(o),a}},deletePromptTemplate:async n=>{const r=t().promptTemplates.find(s=>s.id===n);if(!r){Me.error("Prompt template not found");return}e(s=>{s.promptTemplates=s.promptTemplates.filter(i=>i.id!==n)});try{await _t.deletePromptTemplate(n),Pe.emit(Qa.promptTemplateDeleted,{id:n}),Me.success("Prompt template deleted successfully")}catch(s){e(a=>{a.promptTemplates.push(r)});const i=s instanceof Error?s.message:"Failed to delete prompt template";throw e(a=>{a.error=i}),Me.error(i),s}},compilePromptTemplate:async(n,r)=>{const s=t().promptTemplates.find(i=>i.id===n);if(!s)throw new Error("Template not found");try{let i=s.prompt;for(const o of s.variables){const l=r[o.name],c=[new RegExp(`{{\\s*${o.name}\\s*}}`,"g"),new RegExp(`{{${o.name}}}`,"g"),new RegExp(`{{ ${o.name} }}`,"g")];if(l!=null){let u;typeof l=="object"?u=JSON.stringify(l):u=String(l);for(const d of c){const h=i;i=i.replace(d,u),h!==i&&console.log(`Replaced "${o.name}" using pattern ${d} in:`,h,"",i)}}else{if(o.required)throw new Error(`Required variable "${o.name}" is missing`);if(o.default)for(const u of c)i=i.replace(u,o.default)}}return{content:i,selectedTools:s.tools,selectedRules:s.rules}}catch(i){const a=i instanceof Error?i.message:"Failed to compile prompt template";throw Me.error(a),i}},getTemplatesByType:n=>t().promptTemplates.filter(r=>(r.type||"prompt")===n),getAgents:()=>t().promptTemplates.filter(n=>(n.type||"prompt")==="agent"),getTasksForAgent:n=>t().promptTemplates.filter(r=>(r.type||"prompt")==="task"&&r.parentId===n),getAvailableFollowUps:(n,r)=>{const s=t().promptTemplates,i=s.find(a=>a.id===n);return r==="task"&&(i!=null&&i.parentId)?s.filter(a=>(a.type||"prompt")==="task"&&a.parentId===i.parentId&&a.id!==n):s.filter(a=>(a.type||"prompt")==="prompt"&&a.id!==n)},getRegisteredActionHandlers:()=>{const n=t();return[{eventName:Qa.loadPromptTemplatesRequest,handler:()=>n.loadPromptTemplates(),storeId:"promptTemplateStore"},{eventName:Qa.addPromptTemplateRequest,handler:async r=>{await n.addPromptTemplate(r.promptTemplate)},storeId:"promptTemplateStore"},{eventName:Qa.updatePromptTemplateRequest,handler:r=>n.updatePromptTemplate(r.id,r.updates),storeId:"promptTemplateStore"},{eventName:Qa.deletePromptTemplateRequest,handler:r=>n.deletePromptTemplate(r.id),storeId:"promptTemplateStore"},{eventName:Qa.compilePromptTemplateRequest,handler:async r=>{await n.compilePromptTemplate(r.templateId,r.formData)},storeId:"promptTemplateStore"}]}}))),Er={serversChanged:"mcp.servers.changed",serverAdded:"mcp.server.added",serverUpdated:"mcp.server.updated",serverDeleted:"mcp.server.deleted",serverConnectionChanged:"mcp.server.connection.changed",toolsChanged:"mcp.tools.changed",retryAttemptsChanged:"mcp.retry.attempts.changed",retryDelayChanged:"mcp.retry.delay.changed",connectionTimeoutChanged:"mcp.connection.timeout.changed",maxResponseSizeChanged:"mcp.max.response.size.changed",bridgeConfigChanged:"mcp.bridge.config.changed",beforeToolCall:"mcp.tool.before.call",afterToolCall:"mcp.tool.after.call",toolCallFailed:"mcp.tool.call.failed",beforeToolExecution:"mcp.tool.before.execution",toolDiscovered:"mcp.tool.discovered",toolRegistered:"mcp.tool.registered",toolUnregistered:"mcp.tool.unregistered",setServersRequest:"mcp.set.servers.request",addServerRequest:"mcp.add.server.request",updateServerRequest:"mcp.update.server.request",deleteServerRequest:"mcp.delete.server.request",connectServerRequest:"mcp.connect.server.request",disconnectServerRequest:"mcp.disconnect.server.request",refreshToolsRequest:"mcp.refresh.tools.request",loadMcpStateRequest:"mcp.load.state.request",resetMcpStateRequest:"mcp.reset.state.request",setRetryAttemptsRequest:"mcp.set.retry.attempts.request",setRetryDelayRequest:"mcp.set.retry.delay.request",setConnectionTimeoutRequest:"mcp.set.connection.timeout.request",setMaxResponseSizeRequest:"mcp.set.max.response.size.request"},ux=3,dx=2e3,fx=1e4,hx=128e3,C$e={servers:[],serverStatuses:{},loading:!1,error:null,retryAttempts:ux,retryDelay:dx,connectionTimeout:fx,maxResponseSize:hx,bridgeConfig:{}},al=qo(Vo((e,t)=>({...C$e,setServers:n=>{e(r=>{r.servers=n,r.error=null}),_t.saveSetting("mcpServers",n).catch(r=>{console.error("Failed to persist MCP servers:",r)}),Pe.emit(Er.serversChanged,{servers:n})},addServer:n=>{const r={...n,id:`mcp_${Date.now()}_${Math.random().toString(36).substr(2,9)}`};e(i=>{i.servers.push(r),i.error=null});const s=t().servers;_t.saveSetting("mcpServers",s).catch(i=>{console.error("Failed to persist MCP servers:",i)}),Pe.emit(Er.serverAdded,{server:r}),Pe.emit(Er.serversChanged,{servers:s})},updateServer:(n,r)=>{let s=null;if(e(i=>{const a=i.servers.findIndex(o=>o.id===n);a!==-1&&(i.servers[a]={...i.servers[a],...r},s=i.servers[a],i.error=null)}),s){const i=t().servers;_t.saveSetting("mcpServers",i).catch(a=>{console.error("Failed to persist MCP servers:",a)}),Pe.emit(Er.serverUpdated,{server:s}),Pe.emit(Er.serversChanged,{servers:i})}},deleteServer:n=>{e(s=>{s.servers=s.servers.filter(i=>i.id!==n),delete s.serverStatuses[n],s.error=null});const r=t().servers;_t.saveSetting("mcpServers",r).catch(s=>{console.error("Failed to persist MCP servers:",s)}),Pe.emit(Er.serverDeleted,{serverId:n}),Pe.emit(Er.serversChanged,{servers:r})},setServerStatus:n=>{e(r=>{r.serverStatuses[n.serverId]=n}),Pe.emit(Er.serverConnectionChanged,{serverId:n.serverId,connected:n.connected,error:n.error}),n.tools.length>0&&Pe.emit(Er.toolsChanged,{serverId:n.serverId,tools:n.tools})},clearServerStatus:n=>{e(r=>{delete r.serverStatuses[n]}),Pe.emit(Er.serverConnectionChanged,{serverId:n,connected:!1})},setRetryAttempts:n=>{const r=Math.max(0,Math.min(10,n));e(s=>{s.retryAttempts=r}),_t.saveSetting("mcpRetryAttempts",r).catch(s=>{console.error("Failed to persist MCP retry attempts:",s)}),Pe.emit(Er.retryAttemptsChanged,{attempts:r})},setRetryDelay:n=>{const r=Math.max(500,Math.min(3e4,n));e(s=>{s.retryDelay=r}),_t.saveSetting("mcpRetryDelay",r).catch(s=>{console.error("Failed to persist MCP retry delay:",s)}),Pe.emit(Er.retryDelayChanged,{delay:r})},setConnectionTimeout:n=>{const r=Math.max(1e3,Math.min(6e4,n));e(s=>{s.connectionTimeout=r}),_t.saveSetting("mcpConnectionTimeout",r).catch(s=>{console.error("Failed to persist MCP connection timeout:",s)}),Pe.emit(Er.connectionTimeoutChanged,{timeout:r})},setMaxResponseSize:n=>{const r=Math.max(1e3,Math.min(1e7,n));e(s=>{s.maxResponseSize=r}),_t.saveSetting("mcpMaxResponseSize",r).catch(s=>{console.error("Failed to persist MCP max response size:",s)}),Pe.emit(Er.maxResponseSizeChanged,{size:r})},setBridgeConfig:n=>{e(r=>{r.bridgeConfig={...n}}),_t.saveSetting("mcpBridgeConfig",n).catch(r=>{console.error("Failed to persist MCP bridge config:",r)}),Pe.emit(Er.bridgeConfigChanged,{config:n})},setLoading:n=>{e(r=>{r.loading=n})},setError:n=>{e(r=>{r.error=n})},loadMcpState:async()=>{try{e(l=>{l.loading=!0,l.error=null});const[n,r,s,i,a,o]=await Promise.all([_t.loadSetting("mcpServers",[]),_t.loadSetting("mcpRetryAttempts",ux),_t.loadSetting("mcpRetryDelay",dx),_t.loadSetting("mcpConnectionTimeout",fx),_t.loadSetting("mcpMaxResponseSize",hx),_t.loadSetting("mcpBridgeConfig",{})]);e(l=>{l.servers=n||[],l.retryAttempts=r,l.retryDelay=s,l.connectionTimeout=i,l.maxResponseSize=a,l.bridgeConfig=o||{},l.loading=!1}),Pe.emit(Er.serversChanged,{servers:n||[]}),Pe.emit(Er.retryAttemptsChanged,{attempts:r}),Pe.emit(Er.retryDelayChanged,{delay:s}),Pe.emit(Er.connectionTimeoutChanged,{timeout:i}),Pe.emit(Er.maxResponseSizeChanged,{size:a}),Pe.emit(Er.bridgeConfigChanged,{config:o||{}})}catch(n){console.error("Failed to load MCP state:",n),e(r=>{r.error=n.message||"Failed to load MCP state",r.loading=!1})}},resetMcpState:()=>{e(n=>{n.servers=[],n.serverStatuses={},n.retryAttempts=ux,n.retryDelay=dx,n.connectionTimeout=fx,n.maxResponseSize=hx,n.bridgeConfig={},n.loading=!1,n.error=null}),Promise.all([_t.saveSetting("mcpServers",[]),_t.saveSetting("mcpRetryAttempts",ux),_t.saveSetting("mcpRetryDelay",dx),_t.saveSetting("mcpConnectionTimeout",fx),_t.saveSetting("mcpMaxResponseSize",hx)]).catch(n=>{console.error("Failed to clear MCP settings from storage:",n)}),Pe.emit(Er.serversChanged,{servers:[]}),Pe.emit(Er.retryAttemptsChanged,{attempts:ux}),Pe.emit(Er.retryDelayChanged,{delay:dx}),Pe.emit(Er.connectionTimeoutChanged,{timeout:fx}),Pe.emit(Er.maxResponseSizeChanged,{size:hx})},getRegisteredActionHandlers:()=>{const n=t();return[{eventName:Er.setServersRequest,handler:r=>n.setServers(r.servers),storeId:"mcpStore"},{eventName:Er.addServerRequest,handler:r=>n.addServer(r.server),storeId:"mcpStore"},{eventName:Er.updateServerRequest,handler:r=>n.updateServer(r.id,r.updates),storeId:"mcpStore"},{eventName:Er.deleteServerRequest,handler:r=>n.deleteServer(r.id),storeId:"mcpStore"},{eventName:Er.setRetryAttemptsRequest,handler:r=>n.setRetryAttempts(r.attempts),storeId:"mcpStore"},{eventName:Er.setRetryDelayRequest,handler:r=>n.setRetryDelay(r.delay),storeId:"mcpStore"},{eventName:Er.setConnectionTimeoutRequest,handler:r=>n.setConnectionTimeout(r.timeout),storeId:"mcpStore"},{eventName:Er.setMaxResponseSizeRequest,handler:r=>n.setMaxResponseSize(r.size),storeId:"mcpStore"},{eventName:Er.loadMcpStateRequest,handler:()=>n.loadMcpState(),storeId:"mcpStore"},{eventName:Er.resetMcpStateRequest,handler:()=>n.resetMcpState(),storeId:"mcpStore"}]},exportProxyConfig:()=>t().servers.map(r=>({id:r.id,name:r.name,url:r.url,enabled:r.enabled}))}))),k$e=[br,Cr,bne,qn,zo,vn,bh,Fo,jh,Kw,ei,Vi,Mm,al];class vne{static initialize(){if(this.isInitialized){console.warn("[Coordinator] Already initialized. Skipping re-initialization.");return}console.log("[Coordinator] Initializing dynamic event listeners for action requests...");const t=[];k$e.forEach(n=>{const r=n.getState();if(r&&typeof r.getRegisteredActionHandlers=="function")try{const s=r.getRegisteredActionHandlers();Array.isArray(s)?t.push(...s):console.warn(`[Coordinator] getRegisteredActionHandlers for store did not return an array. Store ID: ${r.id||"Unknown"}`)}catch(s){console.error("[Coordinator] Error calling getRegisteredActionHandlers for a store:",s)}}),t.length===0?console.warn("[Coordinator] No action handlers were registered by any store."):t.forEach(n=>{n&&n.eventName&&typeof n.handler=="function"?Pe.on(n.eventName,n.handler):console.error("[Coordinator] Invalid action handler structure encountered:",n)}),this.isInitialized=!0,console.log(`[Coordinator] Dynamic event listeners initialized. Total handlers: ${t.length}.`)}}de(vne,"isInitialized",!1);const E$e=()=>{const[e,t]=E.useState({}),n=Vi(r=>r.modalProviders);return E.useEffect(()=>{const r=i=>{t(a=>({...a,[i.modalId]:{...i,isOpen:!0}})),Pe.emit(Or.modalStateChanged,{...i,isOpen:!0})},s=i=>{t(a=>{const o={...a};return o[i.modalId]&&(o[i.modalId].isOpen=!1),o}),Pe.emit(Or.modalStateChanged,{modalId:i.modalId,isOpen:!1})};return Pe.on(Or.openModalRequest,r),Pe.on(Or.closeModalRequest,s),()=>{Pe.off(Or.openModalRequest,r),Pe.off(Or.closeModalRequest,s)}},[]),f.jsx(f.Fragment,{children:Object.entries(e).map(([r,s])=>{if(!s.isOpen)return null;const i=n[r];if(!i)return console.warn(`[ModalManager] No provider for modalId: ${r}`),null;const a={isOpen:!0,onClose:()=>Pe.emit(Or.closeModalRequest,{modalId:r}),modalProps:s.modalProps,targetId:s.targetId,initialTab:s.initialTab,initialSubTab:s.initialSubTab};return f.jsx(i,{...a},r)})})};let mq=[],gq=null,bd=!1;const T$e=({controls:e=[]})=>{const[t,n]=E.useState(!0),[r,s]=E.useState(!1),i=E.useRef(null),a=E.useRef(null),{selectedItemId:o,selectedItemType:l,getConversationById:c}=qn(yn(I=>({selectedItemId:I.selectedItemId,selectedItemType:I.selectedItemType,getConversationById:I.getConversationById}))),{getEffectiveProjectSettings:u}=zo(yn(I=>({getEffectiveProjectSettings:I.getEffectiveProjectSettings}))),{interactions:d,status:h}=vn(yn(I=>({interactions:I.interactions,status:I.status}))),{globalError:m,isSidebarCollapsed:y,isChatControlPanelOpen:b}=Kw(yn(I=>({globalError:I.globalError,isSidebarCollapsed:I.isSidebarCollapsed,isChatControlPanelOpen:I.isChatControlPanelOpen}))),v=Vi(yn(I=>Object.values(I.chatControls))),x=E.useMemo(()=>v.filter(I=>(I.panel??"main")==="sidebar"&&(I.show?I.show():!0)),[v]),w=E.useMemo(()=>v.filter(I=>I.panel==="sidebar-footer"&&(I.show?I.show():!0)),[v]),S=E.useMemo(()=>v.filter(I=>I.panel==="header"&&(I.show?I.show():!0)),[v]),k=E.useCallback(()=>{s(I=>!I)},[]);E.useEffect(()=>{r&&o&&(l==="conversation"||l==="project")&&s(!1)},[o,l]),E.useEffect(()=>{a.current||(a.current=T4({id:"core-litechat-app",name:"LiteChat App Core"}));const I=a.current;vne.initialize(),gq||(gq=(async()=>{if(bd){n(!1);return}n(!0);try{mq=await S$e(e,I),bd=!0}catch(B){console.error("[LiteChat] App: Top-level initialization error:",B),bd=!1}finally{n(!1)}})().then(()=>mq))},[e]);const C=E.useRef({itemId:null,itemType:null,effectiveSettingsString:""});E.useEffect(()=>{if(t||!bd||!a.current)return;const I=a.current,P={itemId:o,itemType:l};let B=null;if(l==="project")B=o;else if(l==="conversation"&&o){const O=c(o);B=(O==null?void 0:O.projectId)??null}const D=u(B),W=JSON.stringify(D);(P.itemId!==C.current.itemId||P.itemType!==C.current.itemType||W!==C.current.effectiveSettingsString)&&(I.emit(gn.initializePromptStateRequest,{effectiveSettings:D}),I.emit(Or.contextChanged,{selectedItemId:o,selectedItemType:l}),C.current={...P,effectiveSettingsString:W})},[o,l,c,u,t,bd]),E.useEffect(()=>{if(t||!bd||!a.current)return;const I=a.current,P=()=>{let Z=null;if(l==="project")Z=o;else if(l==="conversation"&&o){const H=c(o);Z=(H==null?void 0:H.projectId)??null}const U=u(Z);I.emit(gn.initializePromptStateRequest,{effectiveSettings:U})},B=I.on(sn.loaded,P),D=I.on(_a.updated,P),W=I.on(sn.globalSystemPromptChanged,P),O=I.on(sn.temperatureChanged,P);return()=>{B(),D(),W(),O()}},[o,l,c,u,t,bd]),E.useEffect(()=>{if(t||!bd||!a.current)return;const I=a.current;let P=null;if(b["core-vfs-modal-panel"]||l==="project")if(l==="project")P=o;else if(l==="conversation"){const W=c(o);P=(W==null?void 0:W.projectId)??"orphan"}else P="orphan";else if(l==="conversation"){const W=c(o);P=(W==null?void 0:W.projectId)??"orphan"}let D=null;typeof P=="string"?D=P:P===null?D=null:(console.warn(`[LiteChatVFS] Calculated VFS key was not a string or null. Type: ${typeof P}, Value:`,P,"Defaulting to 'orphan'."),D="orphan"),ei.getState().vfsKey!==D&&I.emit(dn.setVfsKeyRequest,{key:D})},[o,l,c,t,bd,b]);const T=async I=>{const P=qn.getState(),B=await P.addConversation(I);return console.log("New conversation ID:",B),await P.selectItem(B,"conversation"),console.log("conv selected:",B),B},R=E.useCallback(async I=>{var W;if(!a.current){Me.error("Application core not ready. Please try again.");return}const P=qn.getState();let B=P.selectedItemType==="conversation"?P.selectedItemId:null;const D=P.selectedItemType==="project"?P.selectedItemId:P.selectedItemType==="conversation"?((W=P.getConversationById(P.selectedItemId))==null?void 0:W.projectId)??null:null;if(!B)try{B=await T({title:"New Chat",projectId:D}),console.log("New conversation ID 2:",B)}catch(O){console.error("[LiteChat] App: Failed to create new conversation",O),Me.error("Failed to start new chat.");return}try{const O=Fo.getState(),Z={...I,metadata:{...I.metadata,modelId:O.modelId}};await Qp.submitPrompt(Z)}catch(O){console.error("[LiteChat] App: Error submitting prompt:",O),Me.error("Failed to send message.")}},[]),N=l==="conversation"?o:null;return t?f.jsx("div",{className:"flex items-center justify-center h-screen w-screen bg-background text-foreground",children:f.jsxs("div",{className:"flex flex-col items-center gap-4",children:[f.jsx(Xn,{className:"h-12 w-12 animate-spin text-primary"}),f.jsx("p",{className:"text-lg text-muted-foreground",children:"Initializing LiteChat..."})]})}):f.jsxs(f.Fragment,{children:[f.jsx(E$e,{}),f.jsxs("div",{className:"flex h-full w-full border border-border rounded-lg overflow-hidden bg-background text-foreground",children:[f.jsxs("div",{className:Xe("hidden md:flex flex-col border-r border-border bg-card","transition-[width] duration-300 ease-in-out","flex-shrink-0 overflow-hidden",y?"w-16":"w-64"),children:[f.jsxs("div",{className:"flex-grow overflow-y-auto overflow-x-hidden",children:[f.jsx("div",{className:Xe(y?"hidden":"block"),children:f.jsx(o0,{controls:x,panelId:"sidebar",renderMode:"full",className:"h-full"})}),f.jsx("div",{className:Xe(y?"block":"hidden"),children:f.jsx(o0,{controls:x,panelId:"sidebar",renderMode:"icon",className:"flex flex-col items-center gap-2 p-2"})})]}),f.jsx("div",{className:Xe("flex-shrink-0 border-t border-border p-2",y?"flex flex-col items-center gap-2":"flex items-center justify-center"),children:f.jsx(o0,{controls:w,panelId:"sidebar-footer",renderMode:y?"icon":"full",className:Xe("flex",y?"flex-col gap-2 items-center":"items-center gap-1 justify-center")})})]}),r&&f.jsxs("div",{className:"md:hidden fixed inset-0 z-40 flex",children:[f.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm animate-fadeIn",onClick:k}),f.jsxs("div",{className:"relative w-4/5 max-w-sm bg-card border-r border-border h-full flex flex-col animate-slideInFromLeft shadow-2xl",children:[f.jsxs("div",{className:"sticky top-0 z-10 flex justify-between items-center p-4 border-b border-border bg-card",children:[f.jsx("h2",{className:"font-semibold text-card-foreground",children:"LiteChat Menu"}),f.jsx("button",{onClick:k,className:"p-2 rounded-md hover:bg-muted text-card-foreground touch-manipulation","aria-label":"Close menu",style:{minHeight:"44px",minWidth:"44px"},children:f.jsx(Oi,{className:"h-5 w-5"})})]}),f.jsx("div",{className:"flex-grow overflow-y-auto overflow-x-hidden bg-card",children:x.length>0?f.jsx(o0,{controls:x,panelId:"sidebar",renderMode:"full",className:"h-full"}):f.jsxs("div",{className:"p-4 text-center text-muted-foreground",children:[f.jsx("p",{className:"text-sm",children:"Loading menu..."}),f.jsx("p",{className:"text-xs mt-2",children:"Please wait while the application initializes."})]})}),f.jsx("div",{className:"flex-shrink-0 border-t border-border p-4 bg-card",children:w.length>0?f.jsx(o0,{controls:w,panelId:"sidebar-footer",renderMode:"full",className:"flex items-center justify-between"}):f.jsx("div",{className:"text-center text-muted-foreground text-xs",children:"Footer controls loading..."})})]})]}),f.jsxs("div",{className:"flex flex-col flex-grow min-w-0",children:[f.jsxs("div",{className:"flex items-center justify-between p-2 border-b border-border bg-card flex-shrink-0",children:[f.jsx("button",{className:Xe("md:hidden p-3 rounded-md hover:bg-muted active:bg-muted/80 transition-colors touch-manipulation",r&&"bg-muted"),onClick:k,"aria-label":r?"Close menu":"Open menu",style:{minHeight:"44px",minWidth:"44px"},children:r?f.jsx(Oi,{className:"h-6 w-6"}):f.jsx(Xme,{className:"h-6 w-6"})}),f.jsx(o0,{controls:S,panelId:"header",className:"flex items-center justify-end gap-1 flex-grow"})]}),f.jsx(c$e,{conversationId:N,interactions:d,status:h,className:"flex-grow overflow-y-hidden"}),m&&f.jsxs("div",{className:"p-2 bg-destructive text-destructive-foreground text-sm text-center",children:["Error: ",m]}),f.jsx(bxe,{InputAreaRenderer:gne,onSubmit:R,className:"border-t border-border bg-card flex-shrink-0",inputAreaRef:i,selectedItemId:o,selectedItemType:l})]})]}),f.jsx(p$e,{richColors:!0,position:"bottom-right",closeButton:!0})]})},A$e="prism-theme-link",R$e="prism-default-light-theme-link",N$e="prism-default-dark-theme-link",M$e="https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-material-light.min.css",I$e="https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-vsc-dark-plus.min.css",s3=e=>{let t=document.getElementById(e);return t||(t=document.createElement("link"),t.id=e,t.rel="stylesheet",document.head.appendChild(t)),t},j$e=()=>{const{prismThemeUrl:e,theme:t}=br(yn(s=>({prismThemeUrl:s.prismThemeUrl,theme:s.theme}))),n=E.useMemo(()=>typeof window>"u"?"light":window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light",[]),r=E.useMemo(()=>{const s=t==="system"?n:t;return s==="dark"||s==="TijuDark"?"dark":"light"},[t,n]);return E.useEffect(()=>{if(typeof window>"u")return;const s=s3(R$e),i=s3(N$e),a=s3(A$e);return s.disabled=!0,i.disabled=!0,a.disabled=!0,s.href=M$e,i.href=I$e,e?(a.href=e,a.disabled=!1):r==="dark"?i.disabled=!1:s.disabled=!1,()=>{}},[e,r]),null},i3=e=>e.replace(/([a-z0-9]|(?=[A-Z]))([A-Z])/g,"$1-$2").toLowerCase(),a3=["background","foreground","card","cardForeground","popover","popoverForeground","primary","primaryForeground","secondary","secondaryForeground","muted","mutedForeground","accent","accentForeground","destructive","destructiveForeground","border","input","ring","chart1","chart2","chart3","chart4","chart5","sidebar","sidebarForeground","sidebarPrimary","sidebarPrimaryForeground","sidebarAccent","sidebarAccentForeground","sidebarBorder","sidebarRing"],O$e=()=>{const{theme:e,customFontFamily:t,customFontSize:n,customThemeColors:r}=br(yn(s=>({theme:s.theme,customFontFamily:s.customFontFamily,customFontSize:s.customFontSize,customThemeColors:s.customThemeColors})));return E.useEffect(()=>{const s=document.body,i=document.documentElement;s.classList.remove("light","dark","TijuLight","TijuDark","custom"),a3.forEach(a=>{i.style.removeProperty(`--${i3(a)}`)}),i.style.removeProperty("--custom-font-family"),i.style.removeProperty("--custom-font-size"),e==="light"?s.classList.add("light"):e==="dark"?s.classList.add("dark"):e==="TijuLight"?s.classList.add("TijuLight"):e==="TijuDark"?s.classList.add("TijuDark"):e==="custom"?(s.classList.add("custom"),t?i.style.setProperty("--custom-font-family",t):i.style.removeProperty("--custom-font-family"),n?i.style.setProperty("--custom-font-size",`${n}px`):i.style.removeProperty("--custom-font-size"),r&&Object.entries(r).forEach(([a,o])=>{if(o&&a3.includes(a)){const l=`--${i3(a)}`;i.style.setProperty(l,o)}else if(a3.includes(a)){const l=`--${i3(a)}`;i.style.removeProperty(l)}})):window.matchMedia("(prefers-color-scheme: dark)").matches?s.classList.add("dark"):s.classList.add("light")},[e,t,n,r]),null},P$e=e=>{const{size:t=24,color:n="currentColor",...r}=e;return f.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:t,height:t,viewBox:"0 0 512 512",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",...r,children:[f.jsx("g",{transform:"translate(0.000000,512.000000) scale(0.100000,-0.100000)",fill:n,stroke:"none",children:f.jsx("path",{d:`M2310 5053 c-1035 -101 -1883 -794 -2159 -1764 -55 -194 -79 -338
-91 -552 -18 -323 20 -620 117 -907 92 -272 238 -543 404 -747 33 -39 59 -75
59 -78 0 -4 -49 -129 -109 -279 -252 -624 -251 -621 -196 -676 57 -56 73 -53
351 58 137 55 349 143 472 195 l223 95 77 -38 c221 -109 437 -179 680 -219
132 -23 411 -44 475 -37 23 3 85 8 137 11 404 26 806 168 1180 417 282 188
571 489 759 792 400 642 467 1498 174 2216 -179 439 -495 826 -888 1088 -361
239 -743 378 -1165 422 -88 9 -419 11 -500 3z m404 -463 c-1 -30 -17 -128 -36
-217 l-34 -163 137 0 c128 0 139 -1 149 -20 11 -21 4 -44 -22 -72 -7 -7 -68
-75 -135 -150 l-123 -136 0 -175 0 -175 238 -4 c265 -5 329 -16 469 -82 220
-105 414 -311 486 -519 l24 -68 86 -4 c129 -7 195 -43 236 -130 20 -42 21 -61
21 -300 0 -240 -1 -258 -21 -297 -46 -90 -115 -127 -235 -128 l-82 0 -11 -47
c-17 -66 -71 -179 -119 -250 -108 -159 -276 -293 -452 -361 -174 -66 -251 -72
-830 -63 l-475 8 -89 27 c-303 91 -554 328 -650 614 l-23 67 -89 5 c-98 6
-131 20 -180 72 -63 66 -64 72 -64 354 0 240 1 261 21 301 40 84 105 119 232
129 l84 7 32 80 c84 215 291 424 513 519 126 53 225 68 466 68 l212 0 0 268 0
267 -126 -3 c-108 -3 -129 -1 -145 14 -10 9 -19 25 -19 35 0 9 111 146 246
304 234 273 247 286 277 283 32 -3 32 -3 31 -58z`})}),f.jsxs("g",{transform:"translate(165, 220) scale(2.5)",children:[f.jsx("path",{d:"M5 5l14 14",stroke:n,strokeWidth:"4"}),f.jsx("path",{d:"M18 5l-14 14",stroke:n,strokeWidth:"4"})]}),f.jsxs("g",{transform:"translate(290, 220) scale(2.5)",children:[f.jsx("path",{d:"M5 5l14 14",stroke:n,strokeWidth:"4"}),f.jsx("path",{d:"M18 5l-14 14",stroke:n,strokeWidth:"4"})]}),f.jsx("g",{transform:"translate(0.000000,512.000000) scale(0.100000,-0.100000)",fill:n,stroke:"none",children:f.jsx("path",{d:`M2147 1750 c-26 15 -48 65 -41 94
             15 61 181 167 304 196
             30 7 100 12 155 12
             81 -1 115 -6 178 -27
             135 -45 247 -133 249 -194
             2 -60 -48 -103 -104 -88
             -13 3 -50 25 -83 50
             -85 64 -172 90 -280 84
             -92 -6 -165 -35 -259 -103
             -49 -35 -86 -43 -119 -24z`})})]})},yq="0.1.0-dev",bq="https://github.com/DimitriGilbert/LiteChat",vq=({textToCopy:e,label:t,className:n})=>{const[r,s]=E.useState(!1),i=async()=>{try{await navigator.clipboard.writeText(e),s(!0),Me.success(`${t} copied to clipboard!`),setTimeout(()=>s(!1),2e3)}catch(a){Me.error(`Failed to copy ${t.toLowerCase()}.`),console.error(`Clipboard copy failed for ${t}:`,a)}};return f.jsxs(mt,{variant:"outline",onClick:i,className:n,children:[r?f.jsx(ao,{className:"mr-2 h-4 w-4 text-green-500"}):f.jsx(nme,{className:"mr-2 h-4 w-4"}),r?"Copied!":`Copy ${t}`]})};class D$e extends E.Component{constructor(){super(...arguments);de(this,"state",{hasError:!1,error:null,errorInfo:null});de(this,"handleReportOnGitHub",async()=>{const n=this.generateErrorReport(!0);try{await navigator.clipboard.writeText(n),Me.success("Error report copied to clipboard. Paste it into the GitHub issue body.");const r=`${bq}/issues/new?title=${encodeURIComponent(this.getGitHubIssueTitle())}`;window.open(r,"_blank","noopener,noreferrer")}catch(r){Me.error("Failed to copy error report. Please copy manually."),console.error("Clipboard copy failed for GitHub report:",r);const s=`${bq}/issues/new?title=${encodeURIComponent(this.getGitHubIssueTitle())}`;window.open(s,"_blank","noopener,noreferrer")}})}static getDerivedStateFromError(n){return{hasError:!0,error:n,errorInfo:null}}componentDidCatch(n,r){console.error("Uncaught error:",n,r),this.setState({errorInfo:r})}getGitHubIssueTitle(){var i;const{error:n,errorInfo:r}=this.state;let s="Crash Report: ";if(r!=null&&r.componentStack){const a=(i=r.componentStack.trim().split(/\s+at\s+/)[1])==null?void 0:i.split(" ")[0];a&&(s+=`Error in <${a}> - `)}return s+=(n==null?void 0:n.message.substring(0,70))??"Unknown Error",n&&n.message.length>70&&(s+="..."),s}generateErrorReport(n=!1){const{error:r,errorInfo:s}=this.state,i=`
`,a=n?"```":"";let o=`## LiteChat Error Report${i}${i}`;return o+=`**Version:** ${yq}${i}`,o+=`**Timestamp:** ${new Date().toISOString()}${i}`,o+=`**User Agent:** ${typeof navigator<"u"?navigator.userAgent:"N/A"}${i}${i}`,r?o+=`**Error Message:**${i}${a}${i}${r.message}${i}${a}${i}${i}`:o+=`**Error Message:** Unknown Error${i}${i}`,s!=null&&s.componentStack&&(o+=`**Component Stack:**${i}${a}text${i}${s.componentStack.trim()}${i}${a}${i}${i}`),r!=null&&r.stack&&(o+=`**Error Stack Trace:**${i}${a}text${i}${r.stack.trim()}${i}${a}${i}${i}`),o+=`**Steps to Reproduce (Please Describe):**${i}1. ...${i}2. ...${i}${i}`,o+=`**Expected Behavior:**${i}...${i}${i}`,o+=`**Actual Behavior:**${i}...${i}`,o}generateAIPrompt(){var i,a;const{error:n,errorInfo:r}=this.state;return`I encountered an error in a React application (LiteChat v${yq}). Please help me debug it.

Error Message:
\`\`\`
${(n==null?void 0:n.message)??"Unknown Error"}
\`\`\`

Component Stack (if available):
\`\`\`
${((i=r==null?void 0:r.componentStack)==null?void 0:i.trim())??"Not available"}
\`\`\`

Error Stack Trace (if available):
\`\`\`
${((a=n==null?void 0:n.stack)==null?void 0:a.trim())??"Not available"}
\`\`\`

Based on this information, what are the likely causes and potential solutions? Focus on React-specific issues if the component stack is present.`}render(){var n;return this.state.hasError?this.props.fallback?this.props.fallback:f.jsx("div",{role:"alert",className:"flex flex-col items-center justify-center h-screen w-screen p-4 bg-background text-foreground",children:f.jsxs("div",{className:"max-w-2xl w-full border border-destructive bg-destructive/10 rounded-lg p-6 text-center shadow-lg",children:[f.jsx(P$e,{className:"h-24 w-24 text-destructive mx-auto mb-4"}),f.jsx("h1",{className:"text-2xl font-semibold text-destructive mb-2",children:"Oops! Something went wrong."}),f.jsx("p",{className:"text-destructive/90 mb-4",children:"LiteChat encountered an unexpected error. Please try refreshing the page. If the problem persists, consider reporting the issue. Copy the details and paste them into the GitHub issue."}),f.jsx("pre",{className:"text-left text-xs bg-destructive/10 border border-destructive/30 rounded p-3 max-h-32 overflow-auto mb-4 font-mono text-destructive/80",children:((n=this.state.error)==null?void 0:n.message)??"Unknown Error"}),f.jsxs("div",{className:"flex flex-wrap justify-center gap-2",children:[f.jsx(mt,{variant:"destructive",onClick:()=>window.location.reload(),children:"Refresh Page"}),f.jsx(vq,{textToCopy:this.generateErrorReport(),label:"Details"}),f.jsx(vq,{textToCopy:this.generateAIPrompt(),label:"AI Debug Prompt"}),f.jsxs(mt,{variant:"outline",onClick:this.handleReportOnGitHub,children:[f.jsx(mE,{className:"mr-2 h-4 w-4"})," Report on GitHub"]})]})]})}):this.props.children}}const xne=(e,t)=>{if(!t)return null;let n=Ic,r="text-muted-foreground/70",s=`Linked to ${t}`;switch(e){case"syncing":n=Xn,r="animate-spin text-blue-500",s=`Syncing with ${t}...`;break;case"error":n=Kl,r="text-destructive",s=`Sync error with ${t}`;break;case"needs-sync":n=HO,r="text-orange-500",s=`Needs sync with ${t}`;break;case"idle":n=hE,r="text-green-500",s=`Synced with ${t}`;break;default:n=Ic,r="text-muted-foreground/70",s=`Linked to ${t} (Status: ${e??"Unknown"})`;break}return f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(n,{className:Xe("h-3 w-3 ml-1 flex-shrink-0",r)})}),f.jsx(Sr,{side:"right",children:s})]})})},wne=E.memo(({item:e,level:t,selectedItemId:n,conversationSyncStatus:r,repoNameMap:s,onSelectItem:i,onDeleteConversation:a,onDeleteProject:o,onExportConversation:l,onExportProject:c,expandedProjects:u,toggleProjectExpansion:d,editingItemId:h,editingItemType:m,handleStartEditing:y,handleSaveEdit:b,handleCancelEdit:v,isSavingEdit:x,originalNameToCompare:w})=>{const S=e.id===n,k=e.itemType==="project",C=e.id===h&&e.itemType===m,[T,R]=E.useState(k?e.name:e.title),N=E.useRef(null);E.useEffect(()=>{if(C){const ue=k?e.name:e.title;R(ue),requestAnimationFrame(()=>{var Oe,Fe;(Oe=N.current)==null||Oe.focus(),(Fe=N.current)==null||Fe.select()})}},[C,e,k]),E.useEffect(()=>{if(!C){const ue=k?e.name:e.title;T!==ue&&R(ue)}},[k?e.name:e.title,C,T,k]);const I=k&&u.has(e.id),P=k,B=!k&&e.syncRepoId?r[e.id]:void 0,D=!k&&e.syncRepoId?s.get(e.syncRepoId):void 0,W=!k&&D?xne(B,D):null,O=ue=>{ue.stopPropagation(),Pe.emit(Or.openModalRequest,{modalId:"projectSettingsModal",targetId:e.id})},Z=()=>{C||(k&&d(e.id),i(e.id,e.itemType))},U=ue=>{ue.stopPropagation(),k?window.confirm(`Delete project "${e.name}" and ALL its contents (sub-projects and conversations)? This cannot be undone.`)&&o(e.id,ue):a(e.id,ue)},H=ue=>{ue.stopPropagation(),y(e)},L=()=>{R(w),v(e.itemType==="project"&&w==="New Project")},te=async()=>{if(x)return;const ue=T.trim();await b(e.id,e.itemType,ue)},V=()=>{var Fe;if(x)return;const ue=T.trim(),Oe=e.itemType==="project"&&w==="New Project";if(!ue){w!=="New Project"?(Me.error("Name cannot be empty."),R(w),(Fe=N.current)==null||Fe.focus()):L();return}ue!==w||Oe?te():L()},Q=ue=>{ue.key==="Enter"?(ue.preventDefault(),te()):ue.key==="Escape"&&(ue.preventDefault(),L())},ee=k?e.name:e.title,se=x?Xn:ao,pe=x?"h-3 w-3 animate-spin":"h-3 w-3";return f.jsxs("li",{className:Xe("relative flex justify-between items-center group p-1.5 text-xs rounded","border border-transparent",!C&&"hover:bg-muted/50 hover:text-primary/80",S&&!C?"bg-primary/10 text-primary font-medium border-primary dark:bg-primary/20 dark:border-primary/70":"",C&&"bg-muted ring-1 ring-primary",!C&&"cursor-pointer"),style:{paddingLeft:`${.375+t*.75}rem`},onClick:Z,title:C?"":ee,children:[f.jsxs("div",{className:"flex items-center min-w-0 gap-1 flex-grow mr-1",children:[P&&f.jsx("span",{className:"flex-shrink-0 w-3 cursor-pointer p-0.5 -ml-0.5",onClick:ue=>{ue.stopPropagation(),d(e.id)},children:I?f.jsx(Jl,{className:"h-3 w-3 text-muted-foreground"}):f.jsx($O,{className:"h-3 w-3 text-muted-foreground"})}),!P&&f.jsx("span",{className:"w-3 flex-shrink-0"}),k?f.jsx(yh,{className:"h-3.5 w-3.5 text-yellow-500 flex-shrink-0"}):f.jsx(J3,{className:"h-3.5 w-3.5 text-blue-400 flex-shrink-0"}),C?f.jsx(Cn,{ref:N,value:T,onChange:ue=>R(ue.target.value),onKeyDown:Q,onBlur:V,className:"h-6 px-1 py-0 text-xs flex-grow min-w-0",onClick:ue=>ue.stopPropagation(),disabled:x}):f.jsx("span",{className:"truncate min-w-0 flex-1",children:ee}),W]}),f.jsx("div",{className:Xe("items-center flex-shrink-0 ml-1",C?"flex":"hidden group-hover:flex transition-all duration-150"),onClick:ue=>ue.stopPropagation(),children:C?f.jsxs(f.Fragment,{children:[f.jsx(Un,{tooltipText:"Save (Enter)",onClick:ue=>{ue.stopPropagation(),te()},disabled:x||!T.trim(),"aria-label":"Save changes",icon:f.jsx(se,{}),iconClassName:pe,className:"h-5 w-5 text-green-500 hover:text-green-600"}),f.jsx(Un,{tooltipText:"Cancel (Esc)",onClick:ue=>{ue.stopPropagation(),L()},disabled:x,"aria-label":"Cancel edit",icon:f.jsx(Oi,{}),className:"h-5 w-5 text-muted-foreground hover:text-foreground"})]}):f.jsxs(f.Fragment,{children:[k&&f.jsx(Un,{tooltipText:"Project Settings",onClick:O,"aria-label":`Settings for ${ee}`,icon:f.jsx(Jpe,{}),className:"h-5 w-5 text-muted-foreground hover:text-foreground"}),f.jsx(Un,{tooltipText:"Edit",onClick:H,"aria-label":`Edit ${ee}`,icon:f.jsx(p1,{}),className:"h-5 w-5 text-muted-foreground hover:text-foreground"}),k?f.jsx(Un,{tooltipText:"Export Project (JSON)",onClick:ue=>c(e.id,ue),"aria-label":`Export project ${ee}`,icon:f.jsx(hme,{}),className:"h-5 w-5 text-muted-foreground hover:text-foreground"}):f.jsxs("div",{className:"relative group/export",children:[f.jsx(Un,{tooltipText:"Export Conversation","aria-label":`Export ${ee}`,icon:f.jsx(Ec,{}),className:"h-5 w-5 text-muted-foreground group-hover/export:text-foreground"}),f.jsxs("div",{className:`absolute right-0 top-full mt-1 hidden group-hover/export:flex
                                 bg-popover border border-border rounded-md shadow-lg p-0.5 z-10 gap-0.5`,onClick:ue=>ue.stopPropagation(),children:[f.jsx(mt,{variant:"ghost",size:"sm",className:"h-5 px-1.5 text-xs",onClick:ue=>l(e.id,"json",ue),children:"JSON"}),f.jsx(mt,{variant:"ghost",size:"sm",className:"h-5 px-1.5 text-xs",onClick:ue=>l(e.id,"md",ue),children:"MD"})]})]}),f.jsx(Un,{tooltipText:"Delete",onClick:U,"aria-label":`Delete ${ee}`,icon:f.jsx(Mo,{}),className:"h-5 w-5 text-destructive hover:text-destructive/80"})]})})]})});wne.displayName="ConversationItemRenderer";function F$e({updateProject:e,updateConversation:t,deleteProject:n}){const[r,s]=E.useState(null),[i,a]=E.useState(null),[o,l]=E.useState(""),[c,u]=E.useState(!1),d=E.useCallback(y=>{s(y.id),a(y.itemType);const b=y.itemType==="project"?y.name:y.title;l(b),u(!1)},[]),h=E.useCallback(y=>{const b=r,v=y??(i==="project"&&o==="New Project");s(null),a(null),l(""),u(!1),v&&b&&n(b).catch(x=>{console.error("Failed to delete new project on cancel:",x),Me.error("Failed to clean up cancelled new project.")})},[r,i,o,n]),m=E.useCallback(async(y,b,v)=>{if(y!==r||b!==i||c)return;const x=v==null?void 0:v.trim();if(!x){Me.error("Name cannot be empty.");return}if(x===o&&!(b==="project"&&o==="New Project")){h();return}u(!0);try{b==="project"?await e(y,{name:x}):await t(y,{title:x}),Me.success("Item renamed successfully."),s(null),a(null),l("")}catch(S){console.error("Failed to save item name:",S),Me.error(`Failed to rename item: ${S instanceof Error?S.message:String(S)}`)}finally{u(!1)}},[r,i,c,e,t,h,o]);return{editingItemId:r,editingItemType:i,isSavingEdit:c,handleStartEditing:d,handleSaveEdit:m,handleCancelEdit:h,originalNameToCompare:o}}const _ne=(e,t,n,r,s,i,a,o,l)=>{if(!n)return!0;const c=`${t}-${e}`;if(l[c]!==void 0)return l[c];let u=!1;{const d=i.get(e);if(d)if(d.name.toLowerCase().includes(n))u=!0;else{const h=o.get(e)||[],m=a.get(e)||[];for(const y of m)if(y.title.toLowerCase().includes(n)){u=!0;break}if(!u){for(const y of h)if(_ne(y.id,"project",n,r,s,i,a,o,l)){u=!0;break}}}}return l[c]=u,u},L$e=({module:e})=>{const t=E.useRef(null),n=E.useRef(null),[r,s]=E.useState(!1),[,i]=E.useState({});E.useEffect(()=>(e.setNotifyCallback(()=>i({})),e.isLoading&&!qn.getState().isLoading&&!zo.getState().isLoading&&e.setIsLoading(!1),()=>e.setNotifyCallback(null)),[e]),E.useEffect(()=>{const ye=t.current;if(ye){const Ne=ye.querySelector("[data-radix-scroll-area-viewport]");if(Ne&&n.current!==Ne?(n.current=Ne,r||s(!0),i({})):!Ne&&n.current&&(n.current=null,s(!1)),!n.current){const ce=new MutationObserver(()=>{const oe=ye.querySelector("[data-radix-scroll-area-viewport]");oe&&n.current!==oe&&(n.current=oe,s(!0),i({}),ce.disconnect())});return ce.observe(ye,{childList:!0,subtree:!0}),()=>ce.disconnect()}}},[t.current,r]);const{selectedItemId:a,selectedItemType:o,conversations:l,syncRepos:c,conversationSyncStatus:u,selectItem:d,addConversation:h,updateConversation:m,deleteConversation:y,exportConversation:b,exportProject:v,getConversationById:x}=qn(yn(ye=>({selectedItemId:ye.selectedItemId,selectedItemType:ye.selectedItemType,conversations:ye.conversations,syncRepos:ye.syncRepos,conversationSyncStatus:ye.conversationSyncStatus,selectItem:ye.selectItem,addConversation:ye.addConversation,updateConversation:ye.updateConversation,deleteConversation:ye.deleteConversation,exportConversation:ye.exportConversation,exportProject:ye.exportProject,getConversationById:ye.getConversationById}))),{projects:w,addProject:S,updateProject:k,deleteProject:C,getProjectById:T}=zo(yn(ye=>({projects:ye.projects,addProject:ye.addProject,updateProject:ye.updateProject,deleteProject:ye.deleteProject,getProjectById:ye.getProjectById}))),R=e.isLoading,[N,I]=Ve.useState(new Set),[P,B]=E.useState(""),D=F$e({updateProject:k,updateConversation:m,deleteProject:C}),{editingItemId:W,editingItemType:O,isSavingEdit:Z,handleStartEditing:U,handleSaveEdit:H,handleCancelEdit:L,originalNameToCompare:te}=D,V=E.useCallback(ye=>{I(Ne=>{const ce=new Set(Ne);return ce.has(ye)?ce.delete(ye):ce.add(ye),ce})},[]),Q=E.useCallback(()=>{if(o==="project")return a;if(o==="conversation"&&a){const ye=x(a);return(ye==null?void 0:ye.projectId)??null}return null},[a,o,x]),ee=E.useCallback(async()=>{if(!W)try{const ye=Q(),Ne=await h({title:"New Chat",projectId:ye});d(Ne,"conversation")}catch(ye){console.error("Failed to create new chat:",ye),Me.error("Failed to create new chat.")}},[W,Q,h,d]),se=E.useCallback(async()=>{if(!W)try{const ye=Q(),Ne=await S({name:"New Project",parentId:ye});d(Ne,"project"),ye&&I(ce=>new Set(ce).add(ye)),setTimeout(()=>{const ce=T(Ne);ce&&U({...ce,itemType:"project"})},50)}catch(ye){console.error("Failed to create new project:",ye)}},[W,Q,S,d,T,U]),pe=E.useCallback((ye,Ne)=>{ye===W&&Ne===O||(W&&(ye!==W||Ne!==O)&&L(),(ye!==a||Ne!==o)&&d(ye,Ne))},[W,O,a,o,L,d]),ue=E.useCallback((ye,Ne)=>{Ne.stopPropagation(),window.confirm("Delete this conversation? This cannot be undone.")&&y(ye).catch(ce=>{console.error("Failed to delete conversation:",ce),Me.error("Failed to delete conversation.")})},[y]),Oe=E.useCallback((ye,Ne)=>{Ne.stopPropagation(),C(ye).catch(ce=>{console.error("Failed to delete project:",ce),Me.error("Failed to delete project.")})},[C]),Fe=E.useCallback(async(ye,Ne,ce)=>{ce.stopPropagation();try{await b(ye,Ne)}catch(oe){console.error(`Failed to export conversation as ${Ne}:`,oe)}},[b]),Se=E.useCallback(async(ye,Ne)=>{Ne.stopPropagation();try{await v(ye)}catch(ce){console.error("Failed to export project:",ce)}},[v]),Ce=E.useMemo(()=>new Map((c||[]).map(ye=>[ye.id,ye.name])),[c]),{projectsById:qe,conversationsByProjectId:Qe,projectsByParentId:We}=E.useMemo(()=>{const ye=new Map(w.map(oe=>[oe.id,oe])),Ne=new Map;l.forEach(oe=>{const re=oe.projectId??null;Ne.has(re)||Ne.set(re,[]),Ne.get(re).push(oe)});const ce=new Map;return w.forEach(oe=>{const re=oe.parentId??null;ce.has(re)||ce.set(re,[]),ce.get(re).push(oe)}),{projectsById:ye,conversationsByProjectId:Ne,projectsByParentId:ce}},[w,l]),Ie=E.useMemo(()=>{const ye=[],Ne=P.toLowerCase(),ce={};function oe(re,Re){const Be=(We.get(re)||[]).filter(Tt=>_ne(Tt.id,"project",Ne,w,l,qe,Qe,We,ce)),Te=(Qe.get(re)||[]).filter(Tt=>Tt.title.toLowerCase().includes(Ne)),lt=[...Be,...Te];lt.sort((Tt,ut)=>new Date(ut.updatedAt).getTime()-new Date(Tt.updatedAt).getTime()),lt.forEach(Tt=>{"path"in Tt?(ye.push({id:`project-${Tt.id}`,originalId:Tt.id,type:"project",level:Re,data:Tt,updatedAt:Tt.updatedAt}),N.has(Tt.id)&&oe(Tt.id,Re+1)):ye.push({id:`conversation-${Tt.id}`,originalId:Tt.id,type:"conversation",level:Re,data:Tt,updatedAt:Tt.updatedAt})})}return oe(null,0),ye},[w,l,P,N,qe,Qe,We]),K=R6({count:Ie.length,getScrollElement:()=>n.current,estimateSize:()=>30,overscan:10});return f.jsxs("div",{className:"p-2 border-r border-[--border] bg-card text-card-foreground h-full flex flex-col",children:[f.jsxs("div",{className:"flex justify-between items-center mb-2 flex-shrink-0 px-1",children:[f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx("h3",{className:"text-sm font-semibold",children:"LiteChat"}),f.jsx(Ad,{href:"https://github.com/DimitriGilbert/LiteChat",target:"_blank",rel:"noopener noreferrer","aria-label":"GitHub Repository",children:f.jsx(mt,{size:"sm",variant:"ghost",className:"h-4 w-4 p-0",children:f.jsx(Ome,{className:"h-4 w-4"})})}),f.jsx(Ad,{href:"release/latest.zip",download:"LiteChat.zip","aria-label":"Download LiteChat",children:f.jsx(mt,{size:"sm",variant:"ghost",className:"h-4 w-4 p-0",children:f.jsx(Ec,{className:"h-4 w-4"})})})]}),f.jsxs("div",{className:"flex items-center",children:[f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(mt,{size:"sm",variant:"ghost",onClick:se,"aria-label":"New Project",disabled:R||!!W,className:"h-7 w-7 p-0",children:f.jsx(xH,{className:"h-4 w-4"})})}),f.jsx(Sr,{side:"bottom",children:"New Project"})]})}),f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(mt,{size:"sm",variant:"ghost",onClick:ee,"aria-label":"New Chat",disabled:R||!!W,className:"h-7 w-7 p-0",children:f.jsx(jc,{className:"h-4 w-4"})})}),f.jsx(Sr,{side:"bottom",children:"New Chat"})]})})]})]}),f.jsxs("div",{className:"relative mb-2 px-1 flex-shrink-0",children:[f.jsx(Do,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),f.jsx(Cn,{type:"search",placeholder:"Filter...",value:P,onChange:ye=>B(ye.target.value),className:"h-8 text-xs pl-8",disabled:R})]}),f.jsxs(Yl,{className:"flex-grow",ref:t,children:[R&&Ie.length===0?f.jsxs("div",{className:"space-y-1 p-1",children:[f.jsx("div",{className:"h-8 w-full bg-muted rounded animate-pulse"}),f.jsx("div",{className:"h-8 w-full bg-muted rounded animate-pulse"}),f.jsx("div",{className:"h-8 w-full bg-muted rounded animate-pulse"})]}):!R&&Ie.length===0?f.jsx("p",{className:"text-xs text-muted-foreground p-2 text-center",children:P.trim()!==""?"No items match your filter.":"Workspace is empty."}):r&&f.jsx("div",{style:{height:`${K.getTotalSize()}px`,width:"100%",position:"relative"},children:K.getVirtualItems().map(ye=>{const Ne=Ie[ye.index];if(!Ne)return null;const ce={...Ne.data,itemType:Ne.type};return f.jsx("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:`${ye.size}px`,transform:`translateY(${ye.start}px)`},className:"px-1",children:f.jsx(wne,{item:ce,level:Ne.level,selectedItemId:a,conversationSyncStatus:u,repoNameMap:Ce,onSelectItem:()=>pe(Ne.originalId,Ne.type),onDeleteConversation:ue,onDeleteProject:Oe,onExportConversation:Fe,onExportProject:Se,expandedProjects:N,toggleProjectExpansion:V,editingItemId:W,editingItemType:O,handleStartEditing:U,handleSaveEdit:H,handleCancelEdit:L,isSavingEdit:Z,originalNameToCompare:te})},Ne.id)})}),!r&&!R&&f.jsx("div",{className:"flex items-center justify-center h-full text-muted-foreground",children:"Initializing list..."})]})]})},B$e=({module:e})=>{const{selectedItemType:t}=qn(yn(r=>({selectedItemType:r.selectedItemType})));return e.isLoading?f.jsx(Xn,{className:"h-5 w-5 animate-spin text-muted-foreground"}):t==="project"?f.jsx(yh,{className:"h-5 w-5 text-primary"}):t==="conversation"?f.jsx(TB,{className:"h-5 w-5 text-primary"}):f.jsx(TB,{className:"h-5 w-5 text-muted-foreground"})};class $$e{constructor(){de(this,"id","core-conversation-list");de(this,"unregisterCallback",null);de(this,"eventUnsubscribers",[]);de(this,"isLoading",!0);de(this,"conversationsLoading",!0);de(this,"projectsLoading",!0);de(this,"notifyComponentUpdate",null);de(this,"setIsLoading",t=>{var n;this.isLoading!==t&&(this.isLoading=t,(n=this.notifyComponentUpdate)==null||n.call(this))});de(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){this.conversationsLoading=qn.getState().isLoading,this.projectsLoading=zo.getState().isLoading,this.updateCombinedLoadingState(),t.emit(Jn.loadConversationsRequest,void 0),t.emit(_a.loadProjectsRequest,void 0);const n=t.on(Jn.conversationsLoaded,()=>{this.conversationsLoading=!1,this.updateCombinedLoadingState()}),r=t.on(_a.loaded,()=>{this.projectsLoading=!1,this.updateCombinedLoadingState()}),s=t.on(Jn.loadingStateChanged,a=>{a.isLoading!==this.conversationsLoading&&(this.conversationsLoading=a.isLoading,this.updateCombinedLoadingState())}),i=t.on(_a.loadingStateChanged,a=>{a.isLoading!==this.projectsLoading&&(this.projectsLoading=a.isLoading,this.updateCombinedLoadingState())});this.eventUnsubscribers.push(n,r,s,i)}updateCombinedLoadingState(){var n;const t=this.conversationsLoading||this.projectsLoading;this.isLoading!==t&&(this.isLoading=t,(n=this.notifyComponentUpdate)==null||n.call(this))}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Module "${this.id}" already registered. Skipping.`);return}this.unregisterCallback=t.registerChatControl({id:this.id,panel:"sidebar",status:()=>this.isLoading?"loading":"ready",renderer:()=>Ve.createElement(L$e,{module:this}),iconRenderer:()=>Ve.createElement(B$e,{module:this}),show:()=>!0})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,console.log(`[${this.id}] Destroyed.`)}}const xq=({module:e})=>{const t=(n,r)=>{e.openSettingsModal(n,r)};return f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(mt,{variant:"ghost",size:"icon",onClick:()=>t(),className:"h-8 w-8","aria-label":"Open Settings",children:f.jsx(aC,{className:"h-4 w-4"})})}),f.jsx(Sr,{side:"top",children:"Settings"})]})})};var o3="focusScope.autoFocusOnMount",l3="focusScope.autoFocusOnUnmount",wq={bubbles:!1,cancelable:!0},z$e="FocusScope",F6=E.forwardRef((e,t)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:s,onUnmountAutoFocus:i,...a}=e,[o,l]=E.useState(null),c=Es(s),u=Es(i),d=E.useRef(null),h=Mn(t,b=>l(b)),m=E.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;E.useEffect(()=>{if(r){let b=function(S){if(m.paused||!o)return;const k=S.target;o.contains(k)?d.current=k:rh(d.current,{select:!0})},v=function(S){if(m.paused||!o)return;const k=S.relatedTarget;k!==null&&(o.contains(k)||rh(d.current,{select:!0}))},x=function(S){if(document.activeElement===document.body)for(const C of S)C.removedNodes.length>0&&rh(o)};document.addEventListener("focusin",b),document.addEventListener("focusout",v);const w=new MutationObserver(x);return o&&w.observe(o,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",b),document.removeEventListener("focusout",v),w.disconnect()}}},[r,o,m.paused]),E.useEffect(()=>{if(o){Sq.add(m);const b=document.activeElement;if(!o.contains(b)){const x=new CustomEvent(o3,wq);o.addEventListener(o3,c),o.dispatchEvent(x),x.defaultPrevented||(U$e(G$e(Sne(o)),{select:!0}),document.activeElement===b&&rh(o))}return()=>{o.removeEventListener(o3,c),setTimeout(()=>{const x=new CustomEvent(l3,wq);o.addEventListener(l3,u),o.dispatchEvent(x),x.defaultPrevented||rh(b??document.body,{select:!0}),o.removeEventListener(l3,u),Sq.remove(m)},0)}}},[o,c,u,m]);const y=E.useCallback(b=>{if(!n&&!r||m.paused)return;const v=b.key==="Tab"&&!b.altKey&&!b.ctrlKey&&!b.metaKey,x=document.activeElement;if(v&&x){const w=b.currentTarget,[S,k]=q$e(w);S&&k?!b.shiftKey&&x===k?(b.preventDefault(),n&&rh(S,{select:!0})):b.shiftKey&&x===S&&(b.preventDefault(),n&&rh(k,{select:!0})):x===w&&b.preventDefault()}},[n,r,m.paused]);return f.jsx(lr.div,{tabIndex:-1,...a,ref:h,onKeyDown:y})});F6.displayName=z$e;function U$e(e,{select:t=!1}={}){const n=document.activeElement;for(const r of e)if(rh(r,{select:t}),document.activeElement!==n)return}function q$e(e){const t=Sne(e),n=_q(t,e),r=_q(t.reverse(),e);return[n,r]}function Sne(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const s=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||s?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function _q(e,t){for(const n of e)if(!V$e(n,{upTo:t}))return n}function V$e(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function W$e(e){return e instanceof HTMLInputElement&&"select"in e}function rh(e,{select:t=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&W$e(e)&&t&&e.select()}}var Sq=H$e();function H$e(){let e=[];return{add(t){const n=e[0];t!==n&&(n==null||n.pause()),e=Cq(e,t),e.unshift(t)},remove(t){var n;e=Cq(e,t),(n=e[0])==null||n.resume()}}}function Cq(e,t){const n=[...e],r=n.indexOf(t);return r!==-1&&n.splice(r,1),n}function G$e(e){return e.filter(t=>t.tagName!=="A")}function K$e(e){const t=Y$e(e),n=E.forwardRef((r,s)=>{const{children:i,...a}=r,o=E.Children.toArray(i),l=o.find(X$e);if(l){const c=l.props.children,u=o.map(d=>d===l?E.Children.count(c)>1?E.Children.only(null):E.isValidElement(c)?c.props.children:null:d);return f.jsx(t,{...a,ref:s,children:E.isValidElement(c)?E.cloneElement(c,void 0,u):null})}return f.jsx(t,{...a,ref:s,children:i})});return n.displayName=`${e}.Slot`,n}function Y$e(e){const t=E.forwardRef((n,r)=>{const{children:s,...i}=n;if(E.isValidElement(s)){const a=Q$e(s),o=J$e(i,s.props);return s.type!==E.Fragment&&(o.ref=r?gl(r,a):a),E.cloneElement(s,o)}return E.Children.count(s)>1?E.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var Z$e=Symbol("radix.slottable");function X$e(e){return E.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===Z$e}function J$e(e,t){const n={...t};for(const r in t){const s=e[r],i=t[r];/^on[A-Z]/.test(r)?s&&i?n[r]=(...o)=>{i(...o),s(...o)}:s&&(n[r]=s):r==="style"?n[r]={...s,...i}:r==="className"&&(n[r]=[s,i].filter(Boolean).join(" "))}return{...e,...n}}function Q$e(e){var r,s;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(s=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:s.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var DT="Dialog",[Cne,Edt]=Ki(DT),[e9e,Wc]=Cne(DT),kne=e=>{const{__scopeDialog:t,children:n,open:r,defaultOpen:s,onOpenChange:i,modal:a=!0}=e,o=E.useRef(null),l=E.useRef(null),[c,u]=Fc({prop:r,defaultProp:s??!1,onChange:i,caller:DT});return f.jsx(e9e,{scope:t,triggerRef:o,contentRef:l,contentId:la(),titleId:la(),descriptionId:la(),open:c,onOpenChange:u,onOpenToggle:E.useCallback(()=>u(d=>!d),[u]),modal:a,children:n})};kne.displayName=DT;var Ene="DialogTrigger",t9e=E.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,s=Wc(Ene,n),i=Mn(t,s.triggerRef);return f.jsx(lr.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":$6(s.open),...r,ref:i,onClick:Wt(e.onClick,s.onOpenToggle)})});t9e.displayName=Ene;var L6="DialogPortal",[n9e,Tne]=Cne(L6,{forceMount:void 0}),Ane=e=>{const{__scopeDialog:t,forceMount:n,children:r,container:s}=e,i=Wc(L6,t);return f.jsx(n9e,{scope:t,forceMount:n,children:E.Children.map(r,a=>f.jsx(da,{present:n||i.open,children:f.jsx(OE,{asChild:!0,container:s,children:a})}))})};Ane.displayName=L6;var Ck="DialogOverlay",Rne=E.forwardRef((e,t)=>{const n=Tne(Ck,e.__scopeDialog),{forceMount:r=n.forceMount,...s}=e,i=Wc(Ck,e.__scopeDialog);return i.modal?f.jsx(da,{present:r||i.open,children:f.jsx(s9e,{...s,ref:t})}):null});Rne.displayName=Ck;var r9e=K$e("DialogOverlay.RemoveScroll"),s9e=E.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,s=Wc(Ck,n);return f.jsx(J1,{as:r9e,allowPinchZoom:!0,shards:[s.contentRef],children:f.jsx(lr.div,{"data-state":$6(s.open),...r,ref:t,style:{pointerEvents:"auto",...r.style}})})}),Im="DialogContent",Nne=E.forwardRef((e,t)=>{const n=Tne(Im,e.__scopeDialog),{forceMount:r=n.forceMount,...s}=e,i=Wc(Im,e.__scopeDialog);return f.jsx(da,{present:r||i.open,children:i.modal?f.jsx(i9e,{...s,ref:t}):f.jsx(a9e,{...s,ref:t})})});Nne.displayName=Im;var i9e=E.forwardRef((e,t)=>{const n=Wc(Im,e.__scopeDialog),r=E.useRef(null),s=Mn(t,n.contentRef,r);return E.useEffect(()=>{const i=r.current;if(i)return AT(i)},[]),f.jsx(Mne,{...e,ref:s,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Wt(e.onCloseAutoFocus,i=>{var a;i.preventDefault(),(a=n.triggerRef.current)==null||a.focus()}),onPointerDownOutside:Wt(e.onPointerDownOutside,i=>{const a=i.detail.originalEvent,o=a.button===0&&a.ctrlKey===!0;(a.button===2||o)&&i.preventDefault()}),onFocusOutside:Wt(e.onFocusOutside,i=>i.preventDefault())})}),a9e=E.forwardRef((e,t)=>{const n=Wc(Im,e.__scopeDialog),r=E.useRef(!1),s=E.useRef(!1);return f.jsx(Mne,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var a,o;(a=e.onCloseAutoFocus)==null||a.call(e,i),i.defaultPrevented||(r.current||(o=n.triggerRef.current)==null||o.focus(),i.preventDefault()),r.current=!1,s.current=!1},onInteractOutside:i=>{var l,c;(l=e.onInteractOutside)==null||l.call(e,i),i.defaultPrevented||(r.current=!0,i.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const a=i.target;((c=n.triggerRef.current)==null?void 0:c.contains(a))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&s.current&&i.preventDefault()}})}),Mne=E.forwardRef((e,t)=>{const{__scopeDialog:n,trapFocus:r,onOpenAutoFocus:s,onCloseAutoFocus:i,...a}=e,o=Wc(Im,n),l=E.useRef(null),c=Mn(t,l);return ET(),f.jsxs(f.Fragment,{children:[f.jsx(F6,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:s,onUnmountAutoFocus:i,children:f.jsx(RE,{role:"dialog",id:o.contentId,"aria-describedby":o.descriptionId,"aria-labelledby":o.titleId,"data-state":$6(o.open),...a,ref:c,onDismiss:()=>o.onOpenChange(!1)})}),f.jsxs(f.Fragment,{children:[f.jsx(o9e,{titleId:o.titleId}),f.jsx(c9e,{contentRef:l,descriptionId:o.descriptionId})]})]})}),B6="DialogTitle",Ine=E.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,s=Wc(B6,n);return f.jsx(lr.h2,{id:s.titleId,...r,ref:t})});Ine.displayName=B6;var jne="DialogDescription",One=E.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,s=Wc(jne,n);return f.jsx(lr.p,{id:s.descriptionId,...r,ref:t})});One.displayName=jne;var Pne="DialogClose",Dne=E.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,s=Wc(Pne,n);return f.jsx(lr.button,{type:"button",...r,ref:t,onClick:Wt(e.onClick,()=>s.onOpenChange(!1))})});Dne.displayName=Pne;function $6(e){return e?"open":"closed"}var Fne="DialogTitleWarning",[Tdt,Lne]=vxe(Fne,{contentName:Im,titleName:B6,docsSlug:"dialog"}),o9e=({titleId:e})=>{const t=Lne(Fne),n=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return E.useEffect(()=>{e&&(document.getElementById(e)||console.error(n))},[n,e]),null},l9e="DialogDescriptionWarning",c9e=({contentRef:e,descriptionId:t})=>{const r=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${Lne(l9e).contentName}}.`;return E.useEffect(()=>{var i;const s=(i=e.current)==null?void 0:i.getAttribute("aria-describedby");t&&s&&(document.getElementById(t)||console.warn(r))},[r,e,t]),null},Bne=kne,$ne=Ane,zne=Rne,Une=Nne,u9e=Ine,d9e=One,qne=Dne;function op({...e}){return f.jsx(Bne,{"data-slot":"dialog",...e})}function f9e({...e}){return f.jsx($ne,{"data-slot":"dialog-portal",...e})}function h9e({...e}){return f.jsx(qne,{"data-slot":"dialog-close",...e})}function p9e({className:e,...t}){return f.jsx(zne,{"data-slot":"dialog-overlay",className:Xe("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",e),...t})}function lp({className:e,children:t,...n}){return f.jsxs(f9e,{"data-slot":"dialog-portal",children:[f.jsx(p9e,{}),f.jsxs(Une,{"data-slot":"dialog-content",className:Xe("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",e),...n,children:[t,f.jsxs(qne,{className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[f.jsx(Oi,{}),f.jsx("span",{className:"sr-only",children:"Close"})]})]})]})}function cp({className:e,...t}){return f.jsx("div",{"data-slot":"dialog-header",className:Xe("flex flex-col gap-2 text-center sm:text-left",e),...t})}function gb({className:e,...t}){return f.jsx("div",{"data-slot":"dialog-footer",className:Xe("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",e),...t})}function up({className:e,...t}){return f.jsx(u9e,{"data-slot":"dialog-title",className:Xe("text-lg leading-none font-semibold",e),...t})}function eg({className:e,...t}){return f.jsx(d9e,{"data-slot":"dialog-description",className:Xe("text-muted-foreground text-sm",e),...t})}function kq(e){const t=m9e(e),n=E.forwardRef((r,s)=>{const{children:i,...a}=r,o=E.Children.toArray(i),l=o.find(y9e);if(l){const c=l.props.children,u=o.map(d=>d===l?E.Children.count(c)>1?E.Children.only(null):E.isValidElement(c)?c.props.children:null:d);return f.jsx(t,{...a,ref:s,children:E.isValidElement(c)?E.cloneElement(c,void 0,u):null})}return f.jsx(t,{...a,ref:s,children:i})});return n.displayName=`${e}.Slot`,n}function m9e(e){const t=E.forwardRef((n,r)=>{const{children:s,...i}=n;if(E.isValidElement(s)){const a=v9e(s),o=b9e(i,s.props);return s.type!==E.Fragment&&(o.ref=r?gl(r,a):a),E.cloneElement(s,o)}return E.Children.count(s)>1?E.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var g9e=Symbol("radix.slottable");function y9e(e){return E.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===g9e}function b9e(e,t){const n={...t};for(const r in t){const s=e[r],i=t[r];/^on[A-Z]/.test(r)?s&&i?n[r]=(...o)=>{i(...o),s(...o)}:s&&(n[r]=s):r==="style"?n[r]={...s,...i}:r==="className"&&(n[r]=[s,i].filter(Boolean).join(" "))}return{...e,...n}}function v9e(e){var r,s;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(s=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:s.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}function z6(e){const t=e+"CollectionProvider",[n,r]=Ki(t),[s,i]=n(t,{collectionRef:{current:null},itemMap:new Map}),a=b=>{const{scope:v,children:x}=b,w=Ve.useRef(null),S=Ve.useRef(new Map).current;return f.jsx(s,{scope:v,itemMap:S,collectionRef:w,children:x})};a.displayName=t;const o=e+"CollectionSlot",l=kq(o),c=Ve.forwardRef((b,v)=>{const{scope:x,children:w}=b,S=i(o,x),k=Mn(v,S.collectionRef);return f.jsx(l,{ref:k,children:w})});c.displayName=o;const u=e+"CollectionItemSlot",d="data-radix-collection-item",h=kq(u),m=Ve.forwardRef((b,v)=>{const{scope:x,children:w,...S}=b,k=Ve.useRef(null),C=Mn(v,k),T=i(u,x);return Ve.useEffect(()=>(T.itemMap.set(k,{ref:k,...S}),()=>void T.itemMap.delete(k))),f.jsx(h,{[d]:"",ref:C,children:w})});m.displayName=u;function y(b){const v=i(e+"CollectionConsumer",b);return Ve.useCallback(()=>{const w=v.collectionRef.current;if(!w)return[];const S=Array.from(w.querySelectorAll(`[${d}]`));return Array.from(v.itemMap.values()).sort((T,R)=>S.indexOf(T.ref.current)-S.indexOf(R.ref.current))},[v.collectionRef,v.itemMap])}return[{Provider:a,Slot:c,ItemSlot:m},y,r]}var c3="rovingFocusGroup.onEntryFocus",x9e={bubbles:!1,cancelable:!0},e_="RovingFocusGroup",[A4,Vne,w9e]=z6(e_),[_9e,FT]=Ki(e_,[w9e]),[S9e,C9e]=_9e(e_),Wne=E.forwardRef((e,t)=>f.jsx(A4.Provider,{scope:e.__scopeRovingFocusGroup,children:f.jsx(A4.Slot,{scope:e.__scopeRovingFocusGroup,children:f.jsx(k9e,{...e,ref:t})})}));Wne.displayName=e_;var k9e=E.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,orientation:r,loop:s=!1,dir:i,currentTabStopId:a,defaultCurrentTabStopId:o,onCurrentTabStopIdChange:l,onEntryFocus:c,preventScrollOnEntryFocus:u=!1,...d}=e,h=E.useRef(null),m=Mn(t,h),y=db(i),[b,v]=Fc({prop:a,defaultProp:o??null,onChange:l,caller:e_}),[x,w]=E.useState(!1),S=Es(c),k=Vne(n),C=E.useRef(!1),[T,R]=E.useState(0);return E.useEffect(()=>{const N=h.current;if(N)return N.addEventListener(c3,S),()=>N.removeEventListener(c3,S)},[S]),f.jsx(S9e,{scope:n,orientation:r,dir:y,loop:s,currentTabStopId:b,onItemFocus:E.useCallback(N=>v(N),[v]),onItemShiftTab:E.useCallback(()=>w(!0),[]),onFocusableItemAdd:E.useCallback(()=>R(N=>N+1),[]),onFocusableItemRemove:E.useCallback(()=>R(N=>N-1),[]),children:f.jsx(lr.div,{tabIndex:x||T===0?-1:0,"data-orientation":r,...d,ref:m,style:{outline:"none",...e.style},onMouseDown:Wt(e.onMouseDown,()=>{C.current=!0}),onFocus:Wt(e.onFocus,N=>{const I=!C.current;if(N.target===N.currentTarget&&I&&!x){const P=new CustomEvent(c3,x9e);if(N.currentTarget.dispatchEvent(P),!P.defaultPrevented){const B=k().filter(U=>U.focusable),D=B.find(U=>U.active),W=B.find(U=>U.id===b),Z=[D,W,...B].filter(Boolean).map(U=>U.ref.current);Kne(Z,u)}}C.current=!1}),onBlur:Wt(e.onBlur,()=>w(!1))})})}),Hne="RovingFocusGroupItem",Gne=E.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,focusable:r=!0,active:s=!1,tabStopId:i,children:a,...o}=e,l=la(),c=i||l,u=C9e(Hne,n),d=u.currentTabStopId===c,h=Vne(n),{onFocusableItemAdd:m,onFocusableItemRemove:y,currentTabStopId:b}=u;return E.useEffect(()=>{if(r)return m(),()=>y()},[r,m,y]),f.jsx(A4.ItemSlot,{scope:n,id:c,focusable:r,active:s,children:f.jsx(lr.span,{tabIndex:d?0:-1,"data-orientation":u.orientation,...o,ref:t,onMouseDown:Wt(e.onMouseDown,v=>{r?u.onItemFocus(c):v.preventDefault()}),onFocus:Wt(e.onFocus,()=>u.onItemFocus(c)),onKeyDown:Wt(e.onKeyDown,v=>{if(v.key==="Tab"&&v.shiftKey){u.onItemShiftTab();return}if(v.target!==v.currentTarget)return;const x=A9e(v,u.orientation,u.dir);if(x!==void 0){if(v.metaKey||v.ctrlKey||v.altKey||v.shiftKey)return;v.preventDefault();let S=h().filter(k=>k.focusable).map(k=>k.ref.current);if(x==="last")S.reverse();else if(x==="prev"||x==="next"){x==="prev"&&S.reverse();const k=S.indexOf(v.currentTarget);S=u.loop?R9e(S,k+1):S.slice(k+1)}setTimeout(()=>Kne(S))}}),children:typeof a=="function"?a({isCurrentTabStop:d,hasTabStop:b!=null}):a})})});Gne.displayName=Hne;var E9e={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function T9e(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function A9e(e,t,n){const r=T9e(e.key,n);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return E9e[r]}function Kne(e,t=!1){const n=document.activeElement;for(const r of e)if(r===n||(r.focus({preventScroll:t}),document.activeElement!==n))return}function R9e(e,t){return e.map((n,r)=>e[(t+r)%e.length])}var Yne=Wne,Zne=Gne,LT="Tabs",[N9e,Adt]=Ki(LT,[FT]),Xne=FT(),[M9e,U6]=N9e(LT),Jne=E.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,onValueChange:s,defaultValue:i,orientation:a="horizontal",dir:o,activationMode:l="automatic",...c}=e,u=db(o),[d,h]=Fc({prop:r,onChange:s,defaultProp:i??"",caller:LT});return f.jsx(M9e,{scope:n,baseId:la(),value:d,onValueChange:h,orientation:a,dir:u,activationMode:l,children:f.jsx(lr.div,{dir:u,"data-orientation":a,...c,ref:t})})});Jne.displayName=LT;var Qne="TabsList",ere=E.forwardRef((e,t)=>{const{__scopeTabs:n,loop:r=!0,...s}=e,i=U6(Qne,n),a=Xne(n);return f.jsx(Yne,{asChild:!0,...a,orientation:i.orientation,dir:i.dir,loop:r,children:f.jsx(lr.div,{role:"tablist","aria-orientation":i.orientation,...s,ref:t})})});ere.displayName=Qne;var tre="TabsTrigger",nre=E.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,disabled:s=!1,...i}=e,a=U6(tre,n),o=Xne(n),l=ire(a.baseId,r),c=are(a.baseId,r),u=r===a.value;return f.jsx(Zne,{asChild:!0,...o,focusable:!s,active:u,children:f.jsx(lr.button,{type:"button",role:"tab","aria-selected":u,"aria-controls":c,"data-state":u?"active":"inactive","data-disabled":s?"":void 0,disabled:s,id:l,...i,ref:t,onMouseDown:Wt(e.onMouseDown,d=>{!s&&d.button===0&&d.ctrlKey===!1?a.onValueChange(r):d.preventDefault()}),onKeyDown:Wt(e.onKeyDown,d=>{[" ","Enter"].includes(d.key)&&a.onValueChange(r)}),onFocus:Wt(e.onFocus,()=>{const d=a.activationMode!=="manual";!u&&!s&&d&&a.onValueChange(r)})})})});nre.displayName=tre;var rre="TabsContent",sre=E.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,forceMount:s,children:i,...a}=e,o=U6(rre,n),l=ire(o.baseId,r),c=are(o.baseId,r),u=r===o.value,d=E.useRef(u);return E.useEffect(()=>{const h=requestAnimationFrame(()=>d.current=!1);return()=>cancelAnimationFrame(h)},[]),f.jsx(da,{present:s||u,children:({present:h})=>f.jsx(lr.div,{"data-state":u?"active":"inactive","data-orientation":o.orientation,role:"tabpanel","aria-labelledby":l,hidden:!h,id:c,tabIndex:0,...a,ref:t,style:{...e.style,animationDuration:d.current?"0s":void 0},children:h&&i})})});sre.displayName=rre;function ire(e,t){return`${e}-trigger-${t}`}function are(e,t){return`${e}-content-${t}`}var I9e=Jne,j9e=ere,O9e=nre,P9e=sre;function D9e({className:e,...t}){return f.jsx(I9e,{"data-slot":"tabs",className:Xe("flex flex-col gap-2",e),...t})}function F9e({className:e,...t}){return f.jsx(j9e,{"data-slot":"tabs-list",className:Xe("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",e),...t})}function L9e({className:e,...t}){return f.jsx(O9e,{"data-slot":"tabs-trigger",className:Xe("data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...t})}function B9e({className:e,...t}){return f.jsx(P9e,{"data-slot":"tabs-content",className:Xe("flex-1 outline-none",e),...t})}const oc=({tabs:e,defaultValue:t,initialValue:n,onValueChange:r,className:s,listClassName:i,contentContainerClassName:a,scrollable:o})=>{var m;const[l,c]=E.useState(n??t??((m=e[0])==null?void 0:m.value));E.useEffect(()=>{n!==void 0&&n!==l&&c(n)},[n,l]);const u=y=>{c(y),r&&r(y)},d=Xe("px-1 py-0.25 text-xs sm:px-3 sm:py-1.5 sm:text-sm font-medium rounded-md","text-muted-foreground","border border-transparent","focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2","data-[state=active]:bg-primary/10 data-[state=active]:text-primary","data-[state=active]:border-primary","dark:data-[state=active]:bg-primary/20 dark:data-[state=active]:text-primary","dark:data-[state=active]:border-primary/70","hover:bg-muted/50 hover:text-primary/80"),h=({children:y})=>{const v=Xe(o?"flex-grow overflow-y-auto pb-2 sm:pb-6 pr-1 sm:pr-2 -mr-1 sm:-mr-2":"flex-grow pb-2 sm:pb-6 pr-1 sm:pr-2 -mr-1 sm:-mr-2",a);return o?f.jsx(Yl,{className:v,children:y}):f.jsx("div",{className:v,children:y})};return f.jsxs(D9e,{value:l,onValueChange:u,defaultValue:t,className:Xe("flex flex-col h-full",s),children:[f.jsx(F9e,{className:Xe("flex-shrink-0 sticky top-0 bg-background z-10 flex-wrap h-auto justify-start border-b gap-0.5 sm:gap-1 p-0.5 sm:p-1 px-2 sm:px-6",i),children:e.map(y=>f.jsx(L9e,{value:y.value,disabled:y.disabled,className:d,children:y.label},y.value))}),f.jsx(h,{children:e.map(y=>f.jsx(B9e,{value:y.value,className:"data-[state=inactive]:hidden h-full",children:y.content},y.value))})]})},ore=E.memo(({isOpen:e,onClose:t,initialTab:n})=>{const{modSettingsTabs:r}=jh(yn(u=>({modSettingsTabs:u.modSettingsTabs||[]}))),s=E.useMemo(()=>[...r.map(h=>{const m=h.component;return{value:h.id,label:h.title,content:f.jsx(m,{}),order:h.order??999}})].sort((h,m)=>(h.order??999)-(m.order??999)),[r]),i=E.useCallback(()=>s.length>0?s[0].value:"general",[s]),[a,o]=E.useState(i());E.useEffect(()=>{if(e){let u=i();n&&s.some(d=>d.value===n)?u=n:n&&(console.warn(`[SettingsModal] Initial tab "${n}" not found. Defaulting to "${u}".`),Me.error(`Settings tab "${n}" not found. Opening default tab.`)),o(u)}},[e,n,s,i]);const l=u=>{u||t()},c=u=>{o(u)};return f.jsx(op,{open:e,onOpenChange:l,children:f.jsxs(lp,{className:Xe("min-w-[95vw] h-[95vh] flex flex-col p-0"),children:[f.jsxs(cp,{className:"p-4 md:p-6 pb-2 md:pb-4 flex-shrink-0",children:[f.jsx(up,{children:"Settings"}),f.jsx(eg,{children:"Manage application settings, AI behavior, API keys, providers, and data."})]}),s.length>0?f.jsx(oc,{tabs:s,initialValue:a,onValueChange:c,className:"flex-grow overflow-hidden px-4 md:px-6",listClassName:"-mx-4 md:-mx-6 px-2 md:px-6 py-1 md:py-0",contentContainerClassName:"flex-grow overflow-y-auto pb-4 md:pb-6",scrollable:!1},a):f.jsx("div",{className:"flex-grow flex items-center justify-center text-muted-foreground p-4",children:"No settings tabs available or still loading. Check console for module registration errors."}),f.jsx(gb,{className:"flex-shrink-0 border-t p-4 md:p-6 pt-3 md:pt-4 mt-auto",children:f.jsx(mt,{variant:"outline",onClick:()=>l(!1),children:"Close"})})]})})});ore.displayName="SettingsModalComponent";const $9e=ore;class z9e{constructor(){de(this,"id","core-settings-trigger");de(this,"modalId","settingsModal");de(this,"unregisterChatControlCallback",null);de(this,"unregisterModalProviderCallback",null);de(this,"modApiRef",null);de(this,"openSettingsModal",(t,n)=>{var r;(r=this.modApiRef)==null||r.emit(Or.openModalRequest,{modalId:this.modalId,initialTab:t||"general",initialSubTab:n})});de(this,"closeSettingsModal",()=>{var t;(t=this.modApiRef)==null||t.emit(Or.closeModalRequest,{modalId:this.modalId})})}async initialize(t){this.modApiRef=t}register(t){if(this.modApiRef=t,this.unregisterChatControlCallback&&this.unregisterModalProviderCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterChatControlCallback||(this.unregisterChatControlCallback=t.registerChatControl({id:this.id,panel:"sidebar-footer",status:()=>"ready",renderer:()=>Ve.createElement(xq,{module:this}),iconRenderer:()=>Ve.createElement(xq,{module:this}),show:()=>!0})),this.unregisterModalProviderCallback||(this.unregisterModalProviderCallback=t.registerModalProvider(this.modalId,n=>Ve.createElement($9e,{isOpen:n.isOpen,onClose:n.onClose,initialTab:n.initialTab,initialSubTab:n.initialSubTab})))}destroy(){this.unregisterChatControlCallback&&(this.unregisterChatControlCallback(),this.unregisterChatControlCallback=null),this.unregisterModalProviderCallback&&(this.unregisterModalProviderCallback(),this.unregisterModalProviderCallback=null),this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const U9e=({module:e})=>{const[,t]=E.useState({});E.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const n=e.getIsSidebarCollapsed();return f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(mt,{variant:"ghost",size:"icon",onClick:()=>e.toggleSidebar(),className:"h-8 w-8","aria-label":n?"Expand Sidebar":"Collapse Sidebar",children:n?f.jsx(cge,{className:"h-4 w-4"}):f.jsx(oge,{className:"h-4 w-4"})})}),f.jsx(Sr,{side:"top",children:n?"Expand Sidebar":"Collapse Sidebar"})]})})};class q9e{constructor(){de(this,"id","core-sidebar-toggle");de(this,"unregisterCallback",null);de(this,"notifyComponentUpdate",null);de(this,"modApiRef",null);de(this,"getIsSidebarCollapsed",()=>Kw.getState().isSidebarCollapsed);de(this,"toggleSidebar",t=>{var s,i;const n=Kw.getState().isSidebarCollapsed,r=t??!n;n!==r&&((s=this.modApiRef)==null||s.emit(Or.toggleSidebarRequest,{isCollapsed:r}),(i=this.notifyComponentUpdate)==null||i.call(this))});de(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){this.modApiRef=t}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}const n=()=>Ve.createElement(U9e,{module:this});this.unregisterCallback=t.registerChatControl({id:this.id,panel:"sidebar-footer",status:()=>"ready",renderer:n,iconRenderer:n,show:()=>!0})}destroy(){this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}function Ty({form:e,name:t,label:n,placeholder:r,disabled:s,wrapperClassName:i,allowNull:a=!1,min:o,max:l,step:c,className:u,onBlurInput:d,...h}){return f.jsx(e.Field,{name:t,children:m=>{const y=x=>{const w=x.target.value;if(w===""&&a)m.handleChange(null);else{const S=parseFloat(w);isNaN(S)?w===""&&!a&&m.handleChange(w):m.handleChange(S)}},b=typeof m.state.value=="number"?m.state.value.toString():(m.state.value===null&&a,""),v=x=>{m.handleBlur(),d&&d(x)};return f.jsxs("div",{className:Xe("space-y-1.5",i),children:[" ",f.jsx(Ot,{htmlFor:m.name,className:"text-sm",children:n}),f.jsx(Cn,{id:m.name,name:m.name,type:"number",value:b,onBlur:v,onChange:y,placeholder:r,disabled:s??m.form.state.isSubmitting,min:o,max:l,step:c,className:Xe(u,m.state.meta.errors.length?"border-destructive":""),...h}),f.jsx(ji,{field:m})]})}})}var lre=["PageUp","PageDown"],cre=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],ure={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},yb="Slider",[R4,V9e,W9e]=z6(yb),[dre,Rdt]=Ki(yb,[W9e]),[H9e,BT]=dre(yb),fre=E.forwardRef((e,t)=>{const{name:n,min:r=0,max:s=100,step:i=1,orientation:a="horizontal",disabled:o=!1,minStepsBetweenThumbs:l=0,defaultValue:c=[r],value:u,onValueChange:d=()=>{},onValueCommit:h=()=>{},inverted:m=!1,form:y,...b}=e,v=E.useRef(new Set),x=E.useRef(0),S=a==="horizontal"?G9e:K9e,[k=[],C]=Fc({prop:u,defaultProp:c,onChange:B=>{var W;(W=[...v.current][x.current])==null||W.focus(),d(B)}}),T=E.useRef(k);function R(B){const D=Q9e(k,B);P(B,D)}function N(B){P(B,x.current)}function I(){const B=T.current[x.current];k[x.current]!==B&&h(k)}function P(B,D,{commit:W}={commit:!1}){const O=rze(i),Z=sze(Math.round((B-r)/i)*i+r,O),U=Lw(Z,[r,s]);C((H=[])=>{const L=X9e(H,U,D);if(nze(L,l*i)){x.current=L.indexOf(U);const te=String(L)!==String(H);return te&&W&&h(L),te?L:H}else return H})}return f.jsx(H9e,{scope:e.__scopeSlider,name:n,disabled:o,min:r,max:s,valueIndexToChangeRef:x,thumbs:v.current,values:k,orientation:a,form:y,children:f.jsx(R4.Provider,{scope:e.__scopeSlider,children:f.jsx(R4.Slot,{scope:e.__scopeSlider,children:f.jsx(S,{"aria-disabled":o,"data-disabled":o?"":void 0,...b,ref:t,onPointerDown:Wt(b.onPointerDown,()=>{o||(T.current=k)}),min:r,max:s,inverted:m,onSlideStart:o?void 0:R,onSlideMove:o?void 0:N,onSlideEnd:o?void 0:I,onHomeKeyDown:()=>!o&&P(r,0,{commit:!0}),onEndKeyDown:()=>!o&&P(s,k.length-1,{commit:!0}),onStepKeyDown:({event:B,direction:D})=>{if(!o){const Z=lre.includes(B.key)||B.shiftKey&&cre.includes(B.key)?10:1,U=x.current,H=k[U],L=i*Z*D;P(H+L,U,{commit:!0})}}})})})})});fre.displayName=yb;var[hre,pre]=dre(yb,{startEdge:"left",endEdge:"right",size:"width",direction:1}),G9e=E.forwardRef((e,t)=>{const{min:n,max:r,dir:s,inverted:i,onSlideStart:a,onSlideMove:o,onSlideEnd:l,onStepKeyDown:c,...u}=e,[d,h]=E.useState(null),m=Mn(t,S=>h(S)),y=E.useRef(void 0),b=db(s),v=b==="ltr",x=v&&!i||!v&&i;function w(S){const k=y.current||d.getBoundingClientRect(),C=[0,k.width],R=q6(C,x?[n,r]:[r,n]);return y.current=k,R(S-k.left)}return f.jsx(hre,{scope:e.__scopeSlider,startEdge:x?"left":"right",endEdge:x?"right":"left",direction:x?1:-1,size:"width",children:f.jsx(mre,{dir:b,"data-orientation":"horizontal",...u,ref:m,style:{...u.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:S=>{const k=w(S.clientX);a==null||a(k)},onSlideMove:S=>{const k=w(S.clientX);o==null||o(k)},onSlideEnd:()=>{y.current=void 0,l==null||l()},onStepKeyDown:S=>{const C=ure[x?"from-left":"from-right"].includes(S.key);c==null||c({event:S,direction:C?-1:1})}})})}),K9e=E.forwardRef((e,t)=>{const{min:n,max:r,inverted:s,onSlideStart:i,onSlideMove:a,onSlideEnd:o,onStepKeyDown:l,...c}=e,u=E.useRef(null),d=Mn(t,u),h=E.useRef(void 0),m=!s;function y(b){const v=h.current||u.current.getBoundingClientRect(),x=[0,v.height],S=q6(x,m?[r,n]:[n,r]);return h.current=v,S(b-v.top)}return f.jsx(hre,{scope:e.__scopeSlider,startEdge:m?"bottom":"top",endEdge:m?"top":"bottom",size:"height",direction:m?1:-1,children:f.jsx(mre,{"data-orientation":"vertical",...c,ref:d,style:{...c.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:b=>{const v=y(b.clientY);i==null||i(v)},onSlideMove:b=>{const v=y(b.clientY);a==null||a(v)},onSlideEnd:()=>{h.current=void 0,o==null||o()},onStepKeyDown:b=>{const x=ure[m?"from-bottom":"from-top"].includes(b.key);l==null||l({event:b,direction:x?-1:1})}})})}),mre=E.forwardRef((e,t)=>{const{__scopeSlider:n,onSlideStart:r,onSlideMove:s,onSlideEnd:i,onHomeKeyDown:a,onEndKeyDown:o,onStepKeyDown:l,...c}=e,u=BT(yb,n);return f.jsx(lr.span,{...c,ref:t,onKeyDown:Wt(e.onKeyDown,d=>{d.key==="Home"?(a(d),d.preventDefault()):d.key==="End"?(o(d),d.preventDefault()):lre.concat(cre).includes(d.key)&&(l(d),d.preventDefault())}),onPointerDown:Wt(e.onPointerDown,d=>{const h=d.target;h.setPointerCapture(d.pointerId),d.preventDefault(),u.thumbs.has(h)?h.focus():r(d)}),onPointerMove:Wt(e.onPointerMove,d=>{d.target.hasPointerCapture(d.pointerId)&&s(d)}),onPointerUp:Wt(e.onPointerUp,d=>{const h=d.target;h.hasPointerCapture(d.pointerId)&&(h.releasePointerCapture(d.pointerId),i(d))})})}),gre="SliderTrack",yre=E.forwardRef((e,t)=>{const{__scopeSlider:n,...r}=e,s=BT(gre,n);return f.jsx(lr.span,{"data-disabled":s.disabled?"":void 0,"data-orientation":s.orientation,...r,ref:t})});yre.displayName=gre;var N4="SliderRange",bre=E.forwardRef((e,t)=>{const{__scopeSlider:n,...r}=e,s=BT(N4,n),i=pre(N4,n),a=E.useRef(null),o=Mn(t,a),l=s.values.length,c=s.values.map(h=>wre(h,s.min,s.max)),u=l>1?Math.min(...c):0,d=100-Math.max(...c);return f.jsx(lr.span,{"data-orientation":s.orientation,"data-disabled":s.disabled?"":void 0,...r,ref:o,style:{...e.style,[i.startEdge]:u+"%",[i.endEdge]:d+"%"}})});bre.displayName=N4;var M4="SliderThumb",vre=E.forwardRef((e,t)=>{const n=V9e(e.__scopeSlider),[r,s]=E.useState(null),i=Mn(t,o=>s(o)),a=E.useMemo(()=>r?n().findIndex(o=>o.ref.current===r):-1,[n,r]);return f.jsx(Y9e,{...e,ref:i,index:a})}),Y9e=E.forwardRef((e,t)=>{const{__scopeSlider:n,index:r,name:s,...i}=e,a=BT(M4,n),o=pre(M4,n),[l,c]=E.useState(null),u=Mn(t,w=>c(w)),d=l?a.form||!!l.closest("form"):!0,h=Ky(l),m=a.values[r],y=m===void 0?0:wre(m,a.min,a.max),b=J9e(r,a.values.length),v=h==null?void 0:h[o.size],x=v?eze(v,y,o.direction):0;return E.useEffect(()=>{if(l)return a.thumbs.add(l),()=>{a.thumbs.delete(l)}},[l,a.thumbs]),f.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[o.startEdge]:`calc(${y}% + ${x}px)`},children:[f.jsx(R4.ItemSlot,{scope:e.__scopeSlider,children:f.jsx(lr.span,{role:"slider","aria-label":e["aria-label"]||b,"aria-valuemin":a.min,"aria-valuenow":m,"aria-valuemax":a.max,"aria-orientation":a.orientation,"data-orientation":a.orientation,"data-disabled":a.disabled?"":void 0,tabIndex:a.disabled?void 0:0,...i,ref:u,style:m===void 0?{display:"none"}:e.style,onFocus:Wt(e.onFocus,()=>{a.valueIndexToChangeRef.current=r})})}),d&&f.jsx(xre,{name:s??(a.name?a.name+(a.values.length>1?"[]":""):void 0),form:a.form,value:m},r)]})});vre.displayName=M4;var Z9e="RadioBubbleInput",xre=E.forwardRef(({__scopeSlider:e,value:t,...n},r)=>{const s=E.useRef(null),i=Mn(s,r),a=TT(t);return E.useEffect(()=>{const o=s.current;if(!o)return;const l=window.HTMLInputElement.prototype,u=Object.getOwnPropertyDescriptor(l,"value").set;if(a!==t&&u){const d=new Event("input",{bubbles:!0});u.call(o,t),o.dispatchEvent(d)}},[a,t]),f.jsx(lr.input,{style:{display:"none"},...n,ref:i,defaultValue:t})});xre.displayName=Z9e;function X9e(e=[],t,n){const r=[...e];return r[n]=t,r.sort((s,i)=>s-i)}function wre(e,t,n){const i=100/(n-t)*(e-t);return Lw(i,[0,100])}function J9e(e,t){return t>2?`Value ${e+1} of ${t}`:t===2?["Minimum","Maximum"][e]:void 0}function Q9e(e,t){if(e.length===1)return 0;const n=e.map(s=>Math.abs(s-t)),r=Math.min(...n);return n.indexOf(r)}function eze(e,t,n){const r=e/2,i=q6([0,50],[0,r]);return(r-i(t)*n)*n}function tze(e){return e.slice(0,-1).map((t,n)=>e[n+1]-t)}function nze(e,t){if(t>0){const n=tze(e);return Math.min(...n)>=t}return!0}function q6(e,t){return n=>{if(e[0]===e[1]||t[0]===t[1])return t[0];const r=(t[1]-t[0])/(e[1]-e[0]);return t[0]+r*(n-e[0])}}function rze(e){return(String(e).split(".")[1]||"").length}function sze(e,t){const n=Math.pow(10,t);return Math.round(e*n)/n}var ize=fre,aze=yre,oze=bre,lze=vre;function A0({className:e,defaultValue:t,value:n,min:r=0,max:s=100,...i}){const a=E.useMemo(()=>Array.isArray(n)?n:Array.isArray(t)?t:[r,s],[n,t,r,s]);return f.jsxs(ize,{"data-slot":"slider",defaultValue:t,value:n,min:r,max:s,className:Xe("relative flex w-full touch-none items-center select-none data-[disabled]:opacity-50 data-[orientation=vertical]:h-full data-[orientation=vertical]:min-h-44 data-[orientation=vertical]:w-auto data-[orientation=vertical]:flex-col",e),...i,children:[f.jsx(aze,{"data-slot":"slider-track",className:Xe("bg-muted relative grow overflow-hidden rounded-full data-[orientation=horizontal]:h-1.5 data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-1.5"),children:f.jsx(oze,{"data-slot":"slider-range",className:Xe("bg-primary absolute data-[orientation=horizontal]:h-full data-[orientation=vertical]:w-full")})}),Array.from({length:a.length},(o,l)=>f.jsx(lze,{"data-slot":"slider-thumb",className:"border-primary bg-background ring-ring/50 block size-4 shrink-0 rounded-full border shadow-sm transition-[color,box-shadow] hover:ring-4 focus-visible:ring-4 focus-visible:outline-hidden disabled:pointer-events-none disabled:opacity-50"},l))]})}function Sc({form:e,name:t,label:n,valueLabelPrefix:r="",valueLabelSuffix:s="",valueDisplayPrecision:i=2,showRawValue:a=!1,disabled:o,wrapperClassName:l,className:c,min:u,max:d,step:h,...m}){return f.jsx(e.Field,{name:t,children:y=>{const b=typeof y.state.value=="number"?y.state.value:u??0,v=b.toFixed(i);return f.jsxs("div",{className:Xe("space-y-1.5",l),children:[f.jsxs(Ot,{htmlFor:y.name,className:"text-sm",children:[n," (",r,v,s,")",a&&f.jsxs("span",{className:"text-xs text-muted-foreground ml-2",children:["(Raw: ",y.state.value,")"]})]}),f.jsx(A0,{id:y.name,name:y.name,value:[b],onValueChange:x=>y.handleChange(x[0]),onBlur:y.handleBlur,disabled:o??y.form.state.isSubmitting,min:u,max:d,step:h,className:Xe(c,y.state.meta.errors.length?"border-destructive":""),...m}),f.jsx(ji,{field:y})]})}})}const cze=Ke({temperature:At().min(0).max(1),topP:At().min(0).max(1),maxTokens:At().min(1).nullable(),topK:At().min(1).nullable(),presencePenalty:At().min(-2).max(2),frequencyPenalty:At().min(-2).max(2)}),uze=({module:e,className:t})=>{const n=ii({defaultValues:{temperature:e.temperature??e.defaultTemperature??.7,topP:e.topP??e.defaultTopP??1,maxTokens:e.maxTokens??e.defaultMaxTokens??null,topK:e.topK??e.defaultTopK??null,presencePenalty:e.presencePenalty??e.defaultPresencePenalty??0,frequencyPenalty:e.frequencyPenalty??e.defaultFrequencyPenalty??0},validators:{onChangeAsync:cze,onChangeAsyncDebounceMs:500}});E.useEffect(()=>{n.reset({temperature:e.temperature??e.defaultTemperature??.7,topP:e.topP??e.defaultTopP??1,maxTokens:e.maxTokens??e.defaultMaxTokens??null,topK:e.topK??e.defaultTopK??null,presencePenalty:e.presencePenalty??e.defaultPresencePenalty??0,frequencyPenalty:e.frequencyPenalty??e.defaultFrequencyPenalty??0})},[e.temperature,e.defaultTemperature,e.topP,e.defaultTopP,e.maxTokens,e.defaultMaxTokens,e.topK,e.defaultTopK,e.presencePenalty,e.defaultPresencePenalty,e.frequencyPenalty,e.defaultFrequencyPenalty]);const[,r]=Ve.useState({});E.useEffect(()=>{const u=()=>r({});return e.setNotifyCallback(u),()=>e.setNotifyCallback(null)},[e]);const s=E.useCallback((u,d,h)=>{var m;((m=n.getFieldMeta(u))==null?void 0:m.errors.length)===0&&d(h)},[n,e]),i=E.useCallback((u,d)=>{var h;if(((h=n.getFieldMeta(u))==null?void 0:h.errors.length)===0){const m=n.getFieldValue(u);d(m)}},[n,e]),a=E.useCallback((u,d,h)=>{n.setFieldValue(u,h),d(null)},[n,e]),o=e.supportedParams,l=e.defaultTemperature!==void 0||e.defaultTopP!==void 0||e.defaultMaxTokens!==void 0||e.defaultTopK!==void 0||e.defaultPresencePenalty!==void 0||e.defaultFrequencyPenalty!==void 0,c=(u,d,h,m,y="N/A")=>{var b;return!l||m===void 0?null:f.jsxs(mt,{variant:"link",size:"sm",className:"text-xs h-auto p-0 mt-1 text-muted-foreground",onClick:()=>a(u,h,m??null),disabled:d===null,children:["Use Default (",((b=m==null?void 0:m.toFixed)==null?void 0:b.call(m,2))??y,")"]})};return f.jsxs("div",{className:Xe("space-y-4 p-4",t),children:[o.has("temperature")&&f.jsxs("div",{className:"space-y-0.5",children:[" ",f.jsx(Sc,{form:n,name:"temperature",label:"Temperature",min:0,max:1,step:.01,valueDisplayPrecision:2,onValueCommit:u=>s("temperature",e.setTemperature,u[0]),wrapperClassName:"text-xs"}),c("temperature",e.temperature,e.setTemperature,e.defaultTemperature,"0.70")]}),o.has("top_p")&&f.jsxs("div",{className:"space-y-0.5",children:[f.jsx(Sc,{form:n,name:"topP",label:"Top P",min:0,max:1,step:.01,valueDisplayPrecision:2,onValueCommit:u=>s("topP",e.setTopP,u[0]),wrapperClassName:"text-xs"}),c("topP",e.topP,e.setTopP,e.defaultTopP,"1.00")]}),f.jsxs("div",{className:"grid grid-cols-2 gap-4 items-start",children:[" ",o.has("max_tokens")&&f.jsxs("div",{className:"space-y-0.5",children:[f.jsx(Ty,{form:n,name:"maxTokens",label:"Max Tokens",placeholder:`Default: ${e.defaultMaxTokens??"None"}`,min:1,allowNull:!0,onBlurInput:()=>i("maxTokens",e.setMaxTokens),className:"h-8 text-xs",wrapperClassName:"text-xs"}),c("maxTokens",e.maxTokens,e.setMaxTokens,e.defaultMaxTokens,"None")]}),o.has("top_k")&&f.jsxs("div",{className:"space-y-0.5",children:[f.jsx(Ty,{form:n,name:"topK",label:"Top K",placeholder:`Default: ${e.defaultTopK??"None"}`,min:1,allowNull:!0,onBlurInput:()=>i("topK",e.setTopK),className:"h-8 text-xs",wrapperClassName:"text-xs"}),c("topK",e.topK,e.setTopK,e.defaultTopK,"None")]})]}),o.has("presence_penalty")&&f.jsxs("div",{className:"space-y-0.5",children:[f.jsx(Sc,{form:n,name:"presencePenalty",label:"Presence Penalty",min:-2,max:2,step:.01,valueDisplayPrecision:2,onValueCommit:u=>s("presencePenalty",e.setPresencePenalty,u[0]),wrapperClassName:"text-xs"}),c("presencePenalty",e.presencePenalty,e.setPresencePenalty,e.defaultPresencePenalty,"0.00")]}),o.has("frequency_penalty")&&f.jsxs("div",{className:"space-y-0.5",children:[f.jsx(Sc,{form:n,name:"frequencyPenalty",label:"Frequency Penalty",min:-2,max:2,step:.01,valueDisplayPrecision:2,onValueCommit:u=>s("frequencyPenalty",e.setFrequencyPenalty,u[0]),wrapperClassName:"text-xs"}),c("frequencyPenalty",e.frequencyPenalty,e.setFrequencyPenalty,e.defaultFrequencyPenalty,"0.00")]})]})},dze=({module:e})=>{const[,t]=E.useState({});E.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const n=e.getIsStreaming();return e.getIsVisible()?f.jsxs(sc,{children:[f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(ic,{asChild:!0,children:f.jsx(mt,{variant:"ghost",size:"icon",className:"h-8 w-8",disabled:n,"aria-label":"Adjust Advanced Parameters",children:f.jsx(jge,{className:"h-4 w-4"})})})}),f.jsx(Sr,{side:"top",children:"Advanced Parameters"})]})}),f.jsx(ac,{className:"w-auto p-0",align:"start",children:f.jsx(uze,{module:e})})]}):null};class fze{constructor(){de(this,"id","core-parameters");de(this,"unregisterCallback",null);de(this,"eventUnsubscribers",[]);de(this,"modApiRef",null);de(this,"temperature",null);de(this,"topP",null);de(this,"maxTokens",null);de(this,"topK",null);de(this,"presencePenalty",null);de(this,"frequencyPenalty",null);de(this,"defaultTemperature",null);de(this,"defaultTopP",null);de(this,"defaultMaxTokens",null);de(this,"defaultTopK",null);de(this,"defaultPresencePenalty",null);de(this,"defaultFrequencyPenalty",null);de(this,"isStreaming",!1);de(this,"isVisible",!0);de(this,"supportedParams",new Set);de(this,"notifyComponentUpdate",null);de(this,"getIsStreaming",()=>this.isStreaming);de(this,"getIsVisible",()=>this.isVisible);de(this,"setTemperature",t=>{var n,r;this.temperature=t,(n=this.modApiRef)==null||n.emit(gn.setTemperatureRequest,{value:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});de(this,"setTopP",t=>{var n,r;this.topP=t,(n=this.modApiRef)==null||n.emit(gn.setTopPRequest,{value:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});de(this,"setMaxTokens",t=>{var n,r;this.maxTokens=t,(n=this.modApiRef)==null||n.emit(gn.setMaxTokensRequest,{value:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});de(this,"setTopK",t=>{var n,r;this.topK=t,(n=this.modApiRef)==null||n.emit(gn.setTopKRequest,{value:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});de(this,"setPresencePenalty",t=>{var n,r;this.presencePenalty=t,(n=this.modApiRef)==null||n.emit(gn.setPresencePenaltyRequest,{value:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});de(this,"setFrequencyPenalty",t=>{var n,r;this.frequencyPenalty=t,(n=this.modApiRef)==null||n.emit(gn.setFrequencyPenaltyRequest,{value:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});de(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){this.modApiRef=t,this.loadInitialState(),this.updateSupportedParams();const n=t.on(Zn.statusChanged,a=>{var o;typeof a=="object"&&a&&"status"in a&&this.isStreaming!==(a.status==="streaming")&&(this.isStreaming=a.status==="streaming",(o=this.notifyComponentUpdate)==null||o.call(this))}),r=t.on(Qn.selectedModelChanged,()=>{var a;this.updateSupportedParams(),this.updateVisibility(),(a=this.notifyComponentUpdate)==null||a.call(this)}),s=t.on(sn.enableAdvancedSettingsChanged,()=>{var a;this.updateVisibility(),(a=this.notifyComponentUpdate)==null||a.call(this)}),i=t.on(gn.parameterChanged,a=>{var o;if(typeof a=="object"&&a&&"params"in a){const l=a.params;let c=!1;"temperature"in l&&this.temperature!==l.temperature&&(this.temperature=l.temperature??null,c=!0),"topP"in l&&this.topP!==l.topP&&(this.topP=l.topP??null,c=!0),"maxTokens"in l&&this.maxTokens!==l.maxTokens&&(this.maxTokens=l.maxTokens??null,c=!0),"topK"in l&&this.topK!==l.topK&&(this.topK=l.topK??null,c=!0),"presencePenalty"in l&&this.presencePenalty!==l.presencePenalty&&(this.presencePenalty=l.presencePenalty??null,c=!0),"frequencyPenalty"in l&&this.frequencyPenalty!==l.frequencyPenalty&&(this.frequencyPenalty=l.frequencyPenalty??null,c=!0),c&&((o=this.notifyComponentUpdate)==null||o.call(this))}});this.eventUnsubscribers.push(n,r,s,i)}loadInitialState(){const t=br.getState(),n=Fo.getState();this.isStreaming=vn.getState().status==="streaming",this.temperature=n.temperature,this.topP=n.topP,this.maxTokens=n.maxTokens,this.topK=n.topK,this.presencePenalty=n.presencePenalty,this.frequencyPenalty=n.frequencyPenalty,this.defaultTemperature=t.temperature,this.defaultTopP=t.topP,this.defaultMaxTokens=t.maxTokens,this.defaultTopK=t.topK,this.defaultPresencePenalty=t.presencePenalty,this.defaultFrequencyPenalty=t.frequencyPenalty,this.updateVisibility()}updateSupportedParams(){var o;const t=Cr.getState();if(!t.selectedModelId){this.supportedParams=new Set;return}const{providerId:n,modelId:r}=Tc(t.selectedModelId);if(!n||!r){this.supportedParams=new Set;return}const s=t.dbProviderConfigs.find(l=>l.id===n);if(!s){this.supportedParams=new Set;return}const i=t.dbApiKeys.find(l=>l.id===s.apiKeyId),a=DG(s,r,i==null?void 0:i.value);this.supportedParams=new Set(((o=a==null?void 0:a.metadata)==null?void 0:o.supported_parameters)??[])}updateVisibility(){const r=br.getState().enableAdvancedSettings&&["temperature","top_p","max_tokens","top_k","presence_penalty","frequency_penalty"].some(s=>this.supportedParams.has(s));this.isVisible!==r&&(this.isVisible=r)}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>Ve.createElement(dze,{module:this}),getParameters:()=>{const n={},r=(s,i)=>{i!==null&&(n[s]=i)};return r("temperature",this.temperature),r("top_p",this.topP),r("max_tokens",this.maxTokens),r("top_k",this.topK),r("presence_penalty",this.presencePenalty),r("frequency_penalty",this.frequencyPenalty),Object.keys(n).length>0?n:void 0}})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const hze=({module:e})=>{const t=E.useRef(null),[,n]=E.useState({});E.useEffect(()=>(e.setNotifyCallback(()=>n({})),()=>e.setNotifyCallback(null)),[e]);const r=e.getIsStreaming(),s=e.getModelSupportsNonText(),i=E.useCallback(async l=>{const c=l.target.files;if(c){for(const u of Array.from(c))try{let d={};const h=e.isLikelyTextFile(u.name,u.type),m=u.type.startsWith("image/");if(h)d.contentText=await u.text();else if(m&&s){const y=new FileReader,b=new Promise((x,w)=>{y.onload=()=>x(y.result),y.onerror=S=>w(S)});y.readAsDataURL(u);const v=await b;v&&v.includes(",")&&(d.contentBase64=v.split(",")[1])}e.onFileAdd({source:"direct",name:u.name,type:u.type||"application/octet-stream",size:u.size,...d})}catch(d){console.error(`Error processing file ${u.name}:`,d),Me.error(`Failed to process file "${u.name}": ${d instanceof Error?d.message:String(d)}`)}l.target&&(l.target.value="")}},[e,s]),a=()=>{var l;(l=t.current)==null||l.click()},o=s?"Attach Files (Text, Images, etc.)":"Attach Text Files";return f.jsxs(f.Fragment,{children:[f.jsx("input",{type:"file",ref:t,onChange:i,multiple:!0,className:"hidden",disabled:r}),f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(mt,{type:"button",variant:"ghost",size:"icon",onClick:a,disabled:r,className:"h-8 w-8","aria-label":o,children:f.jsx(gE,{className:"h-4 w-4"})})}),f.jsx(Sr,{side:"top",children:o})]})})]})},pze=({module:e})=>{const[,t]=E.useState({}),n=e.getAttachedFiles(),r=e.getIsStreaming();return E.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]),n.length===0?null:f.jsx("div",{className:Xe("max-h-40 overflow-y-auto pr-1","flex flex-wrap gap-1"),children:n.map(s=>f.jsx(RZ,{fileMeta:s,onRemove:e.onFileRemove,isReadOnly:r},s.id))})},_re=20,mze=_re*1024*1024;class gze{constructor(){de(this,"id","core-file-attachment");de(this,"unregisterCallback",null);de(this,"eventUnsubscribers",[]);de(this,"modApiRef",null);de(this,"isStreaming",!1);de(this,"modelSupportsNonText",!0);de(this,"attachedFiles",[]);de(this,"notifyComponentUpdate",null);de(this,"getIsStreaming",()=>this.isStreaming);de(this,"getModelSupportsNonText",()=>this.modelSupportsNonText);de(this,"getAttachedFiles",()=>this.attachedFiles);de(this,"isLikelyTextFile",(t,n)=>Jx(t,n));de(this,"onFileAdd",t=>{var r;if(t.size>mze){Me.error(`File "${t.name}" exceeds the ${_re}MB limit.`);return}if(!Jx(t.name,t.type)&&!this.modelSupportsNonText){Me.warning(`File "${t.name}" (${t.type}) cannot be uploaded. The current model only supports text input.`);return}(r=this.modApiRef)==null||r.emit(Ul.addAttachedFileRequest,t)});de(this,"onFileRemove",t=>{var n;(n=this.modApiRef)==null||n.emit(Ul.removeAttachedFileRequest,{attachmentId:t})});de(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){var i;this.modApiRef=t,this.isStreaming=vn.getState().status==="streaming",this.attachedFiles=bh.getState().attachedFilesMetadata,this.updateModelSupport(),(i=this.notifyComponentUpdate)==null||i.call(this);const n=t.on(Zn.statusChanged,a=>{var o;typeof a=="object"&&a&&"status"in a&&this.isStreaming!==(a.status==="streaming")&&(this.isStreaming=a.status==="streaming",(o=this.notifyComponentUpdate)==null||o.call(this))}),r=t.on(Qn.selectedModelChanged,()=>{var a;this.updateModelSupport(),(a=this.notifyComponentUpdate)==null||a.call(this)}),s=t.on(Ul.attachedFilesChanged,a=>{var o;typeof a=="object"&&a&&"files"in a&&JSON.stringify(this.attachedFiles)!==JSON.stringify(a.files)&&(this.attachedFiles=a.files,(o=this.notifyComponentUpdate)==null||o.call(this))});this.eventUnsubscribers.push(n,r,s)}updateModelSupport(){var i,a;const{getSelectedModel:t}=Cr.getState(),n=t(),r=(a=(i=n==null?void 0:n.metadata)==null?void 0:i.architecture)==null?void 0:a.input_modalities,s=!r||r.some(o=>o!=="text");this.modelSupportsNonText!==s&&(this.modelSupportsNonText=s)}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,triggerRenderer:()=>Ve.createElement(hze,{module:this}),renderer:()=>Ve.createElement(pze,{module:this})})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const yze=({module:e})=>{const[,t]=E.useState({});E.useEffect(()=>{if(e&&typeof e.setNotifyTriggerUpdate=="function")return e.setNotifyTriggerUpdate(()=>t({})),()=>{e&&typeof e.setNotifyTriggerUpdate=="function"&&e.setNotifyTriggerUpdate(null)}},[e]);const n=e&&typeof e.getIsVfsModalOpen=="function"?e.getIsVfsModalOpen():!1,r=e&&typeof e.getSelectedFileIdsCount=="function"?e.getSelectedFileIdsCount():0,s=e&&typeof e.getEnableVfs=="function"?e.getEnableVfs():!1,i=bh.getState().addAttachedFile,a=()=>{const o=ei.getState().selectedFileIds;if(o.size===0){Me.info("No files selected in VFS to attach.");return}let l=0;const c=e.getVfsNodes();o.forEach(u=>{const d=c[u];d&&d.type==="file"&&(i({source:"vfs",name:d.name,type:d.mimeType||"application/octet-stream",size:d.size,path:d.path}),l++)}),l>0?(Me.success(`Attached ${l} file(s) from VFS to the next prompt.`),typeof e.clearVfsSelection=="function"&&e.clearVfsSelection(),e.toggleVfsModal):Me.warning("No valid files were selected to attach.")};return s?f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(mt,{variant:"ghost",size:"icon",className:Xe("h-8 w-8",n&&"bg-muted text-primary"),onClick:()=>e&&typeof e.toggleVfsModal=="function"&&e.toggleVfsModal(),"aria-label":"Toggle Virtual File System",children:f.jsx(qO,{className:"h-4 w-4"})})}),f.jsx(Sr,{side:"top",children:"Virtual Filesystem"})]})}),r>0&&f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsxs(mt,{variant:"secondary",size:"sm",className:"h-8 animate-fadeIn px-2",onClick:a,"aria-label":`Attach ${r} selected VFS file(s)`,children:[f.jsx(gE,{className:"h-4 w-4 mr-1"}),"Attach (",r,")"]})}),f.jsx(Sr,{side:"top",children:"Attach selected VFS files to prompt"})]})})]}):null};function lf({className:e,...t}){return f.jsx("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:f.jsx("table",{"data-slot":"table",className:Xe("w-full caption-bottom text-sm",e),...t})})}function dp({className:e,...t}){return f.jsx("thead",{"data-slot":"table-header",className:Xe("[&_tr]:border-b",e),...t})}function cf({className:e,...t}){return f.jsx("tbody",{"data-slot":"table-body",className:Xe("[&_tr:last-child]:border-0",e),...t})}function Ts({className:e,...t}){return f.jsx("tr",{"data-slot":"table-row",className:Xe("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",e),...t})}function Ar({className:e,...t}){return f.jsx("th",{"data-slot":"table-head",className:Xe("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...t})}function Fn({className:e,...t}){return f.jsx("td",{"data-slot":"table-cell",className:Xe("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...t})}function bze({className:e,...t}){return f.jsx("caption",{"data-slot":"table-caption",className:Xe("text-muted-foreground mt-4 text-sm",e),...t})}const Sre=({newFolderName:e,setNewFolderName:t,handleCreateFolder:n,cancelCreatingFolder:r,newFolderInputRef:s,isOperationLoading:i,isMobile:a=!1})=>{const o=l=>{l.key==="Enter"?n():l.key==="Escape"&&r()};return a?f.jsxs("div",{className:"flex items-center gap-2 p-1",children:[f.jsx(yh,{className:"h-5 w-5 text-yellow-400 flex-shrink-0"}),f.jsx(Cn,{ref:s,value:e,onChange:l=>t(l.target.value),onBlur:n,onKeyDown:o,className:"h-7 px-2 py-1 text-sm bg-input border-border focus:ring-1 focus:ring-primary flex-grow",placeholder:"New folder name",disabled:i}),f.jsxs("div",{className:"flex items-center gap-0.5 flex-shrink-0",children:[f.jsx(mt,{variant:"ghost",size:"icon",className:"h-7 w-7 text-green-500 hover:text-green-400",onClick:n,"aria-label":"Create folder",disabled:i||!e.trim(),children:i?f.jsx(Xn,{className:"h-4 w-4 animate-spin"}):f.jsx(ao,{className:"h-4 w-4"})}),f.jsx(mt,{variant:"ghost",size:"icon",className:"h-7 w-7 text-muted-foreground hover:text-foreground",onClick:r,"aria-label":"Cancel create folder",disabled:i,children:f.jsx(Oi,{className:"h-4 w-4"})})]})]}):f.jsxs(Ts,{className:"bg-muted/30",children:[f.jsx(Fn,{className:"px-2 py-1"}),f.jsx(Fn,{className:"px-2 py-1",children:f.jsx(yh,{className:"h-5 w-5 text-yellow-400"})}),f.jsx(Fn,{className:"py-1 px-2",colSpan:3,children:f.jsx(Cn,{ref:s,value:e,onChange:l=>t(l.target.value),onBlur:n,onKeyDown:o,className:"h-7 px-2 py-1 text-sm bg-input border-border focus:ring-1 focus:ring-primary w-full",placeholder:"New folder name",disabled:i})}),f.jsx(Fn,{className:"text-right pr-4 py-1",children:f.jsxs("div",{className:"flex items-center justify-end gap-0.5",children:[f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(mt,{variant:"ghost",size:"icon",className:"h-6 w-6 text-green-500 hover:text-green-400",onClick:n,"aria-label":"Create folder",disabled:i||!e.trim(),children:i?f.jsx(Xn,{className:"h-4 w-4 animate-spin"}):f.jsx(ao,{className:"h-4 w-4"})})}),f.jsx(Sr,{side:"top",children:"Create (Enter)"})]})}),f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(mt,{variant:"ghost",size:"icon",className:"h-6 w-6 text-muted-foreground hover:text-foreground",onClick:r,"aria-label":"Cancel create folder",disabled:i,children:f.jsx(Oi,{className:"h-4 w-4"})})}),f.jsx(Sr,{side:"top",children:"Cancel (Esc)"})]})})]})})]})};function vze(e){const t=xze(e),n=E.forwardRef((r,s)=>{const{children:i,...a}=r,o=E.Children.toArray(i),l=o.find(_ze);if(l){const c=l.props.children,u=o.map(d=>d===l?E.Children.count(c)>1?E.Children.only(null):E.isValidElement(c)?c.props.children:null:d);return f.jsx(t,{...a,ref:s,children:E.isValidElement(c)?E.cloneElement(c,void 0,u):null})}return f.jsx(t,{...a,ref:s,children:i})});return n.displayName=`${e}.Slot`,n}function xze(e){const t=E.forwardRef((n,r)=>{const{children:s,...i}=n;if(E.isValidElement(s)){const a=Cze(s),o=Sze(i,s.props);return s.type!==E.Fragment&&(o.ref=r?gl(r,a):a),E.cloneElement(s,o)}return E.Children.count(s)>1?E.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var wze=Symbol("radix.slottable");function _ze(e){return E.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===wze}function Sze(e,t){const n={...t};for(const r in t){const s=e[r],i=t[r];/^on[A-Z]/.test(r)?s&&i?n[r]=(...o)=>{i(...o),s(...o)}:s&&(n[r]=s):r==="style"?n[r]={...s,...i}:r==="className"&&(n[r]=[s,i].filter(Boolean).join(" "))}return{...e,...n}}function Cze(e){var r,s;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(s=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:s.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var I4=["Enter"," "],kze=["ArrowDown","PageUp","Home"],Cre=["ArrowUp","PageDown","End"],Eze=[...kze,...Cre],Tze={ltr:[...I4,"ArrowRight"],rtl:[...I4,"ArrowLeft"]},Aze={ltr:["ArrowLeft"],rtl:["ArrowRight"]},t_="Menu",[Zw,Rze,Nze]=z6(t_),[tg,$T]=Ki(t_,[Nze,jE,FT]),zT=jE(),kre=FT(),[Mze,ng]=tg(t_),[Ize,n_]=tg(t_),Ere=e=>{const{__scopeMenu:t,open:n=!1,children:r,dir:s,onOpenChange:i,modal:a=!0}=e,o=zT(t),[l,c]=E.useState(null),u=E.useRef(!1),d=Es(i),h=db(s);return E.useEffect(()=>{const m=()=>{u.current=!0,document.addEventListener("pointerdown",y,{capture:!0,once:!0}),document.addEventListener("pointermove",y,{capture:!0,once:!0})},y=()=>u.current=!1;return document.addEventListener("keydown",m,{capture:!0}),()=>{document.removeEventListener("keydown",m,{capture:!0}),document.removeEventListener("pointerdown",y,{capture:!0}),document.removeEventListener("pointermove",y,{capture:!0})}},[]),f.jsx(oK,{...o,children:f.jsx(Mze,{scope:t,open:n,onOpenChange:d,content:l,onContentChange:c,children:f.jsx(Ize,{scope:t,onClose:E.useCallback(()=>d(!1),[d]),isUsingKeyboardRef:u,dir:h,modal:a,children:r})})})};Ere.displayName=t_;var jze="MenuAnchor",V6=E.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e,s=zT(n);return f.jsx(lK,{...s,...r,ref:t})});V6.displayName=jze;var W6="MenuPortal",[Oze,Tre]=tg(W6,{forceMount:void 0}),Are=e=>{const{__scopeMenu:t,forceMount:n,children:r,container:s}=e,i=ng(W6,t);return f.jsx(Oze,{scope:t,forceMount:n,children:f.jsx(da,{present:n||i.open,children:f.jsx(OE,{asChild:!0,container:s,children:r})})})};Are.displayName=W6;var Gl="MenuContent",[Pze,H6]=tg(Gl),Rre=E.forwardRef((e,t)=>{const n=Tre(Gl,e.__scopeMenu),{forceMount:r=n.forceMount,...s}=e,i=ng(Gl,e.__scopeMenu),a=n_(Gl,e.__scopeMenu);return f.jsx(Zw.Provider,{scope:e.__scopeMenu,children:f.jsx(da,{present:r||i.open,children:f.jsx(Zw.Slot,{scope:e.__scopeMenu,children:a.modal?f.jsx(Dze,{...s,ref:t}):f.jsx(Fze,{...s,ref:t})})})})}),Dze=E.forwardRef((e,t)=>{const n=ng(Gl,e.__scopeMenu),r=E.useRef(null),s=Mn(t,r);return E.useEffect(()=>{const i=r.current;if(i)return AT(i)},[]),f.jsx(G6,{...e,ref:s,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:Wt(e.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)})}),Fze=E.forwardRef((e,t)=>{const n=ng(Gl,e.__scopeMenu);return f.jsx(G6,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)})}),Lze=vze("MenuContent.ScrollLock"),G6=E.forwardRef((e,t)=>{const{__scopeMenu:n,loop:r=!1,trapFocus:s,onOpenAutoFocus:i,onCloseAutoFocus:a,disableOutsidePointerEvents:o,onEntryFocus:l,onEscapeKeyDown:c,onPointerDownOutside:u,onFocusOutside:d,onInteractOutside:h,onDismiss:m,disableOutsideScroll:y,...b}=e,v=ng(Gl,n),x=n_(Gl,n),w=zT(n),S=kre(n),k=Rze(n),[C,T]=E.useState(null),R=E.useRef(null),N=Mn(t,R,v.onContentChange),I=E.useRef(0),P=E.useRef(""),B=E.useRef(0),D=E.useRef(null),W=E.useRef("right"),O=E.useRef(0),Z=y?J1:E.Fragment,U=y?{as:Lze,allowPinchZoom:!0}:void 0,H=te=>{var Fe,Se;const V=P.current+te,Q=k().filter(Ce=>!Ce.disabled),ee=document.activeElement,se=(Fe=Q.find(Ce=>Ce.ref.current===ee))==null?void 0:Fe.textValue,pe=Q.map(Ce=>Ce.textValue),ue=Zze(pe,V,se),Oe=(Se=Q.find(Ce=>Ce.textValue===ue))==null?void 0:Se.ref.current;(function Ce(qe){P.current=qe,window.clearTimeout(I.current),qe!==""&&(I.current=window.setTimeout(()=>Ce(""),1e3))})(V),Oe&&setTimeout(()=>Oe.focus())};E.useEffect(()=>()=>window.clearTimeout(I.current),[]),ET();const L=E.useCallback(te=>{var Q,ee;return W.current===((Q=D.current)==null?void 0:Q.side)&&Jze(te,(ee=D.current)==null?void 0:ee.area)},[]);return f.jsx(Pze,{scope:n,searchRef:P,onItemEnter:E.useCallback(te=>{L(te)&&te.preventDefault()},[L]),onItemLeave:E.useCallback(te=>{var V;L(te)||((V=R.current)==null||V.focus(),T(null))},[L]),onTriggerLeave:E.useCallback(te=>{L(te)&&te.preventDefault()},[L]),pointerGraceTimerRef:B,onPointerGraceIntentChange:E.useCallback(te=>{D.current=te},[]),children:f.jsx(Z,{...U,children:f.jsx(F6,{asChild:!0,trapped:s,onMountAutoFocus:Wt(i,te=>{var V;te.preventDefault(),(V=R.current)==null||V.focus({preventScroll:!0})}),onUnmountAutoFocus:a,children:f.jsx(RE,{asChild:!0,disableOutsidePointerEvents:o,onEscapeKeyDown:c,onPointerDownOutside:u,onFocusOutside:d,onInteractOutside:h,onDismiss:m,children:f.jsx(Yne,{asChild:!0,...S,dir:x.dir,orientation:"vertical",loop:r,currentTabStopId:C,onCurrentTabStopIdChange:T,onEntryFocus:Wt(l,te=>{x.isUsingKeyboardRef.current||te.preventDefault()}),preventScrollOnEntryFocus:!0,children:f.jsx(cK,{role:"menu","aria-orientation":"vertical","data-state":Wre(v.open),"data-radix-menu-content":"",dir:x.dir,...w,...b,ref:N,style:{outline:"none",...b.style},onKeyDown:Wt(b.onKeyDown,te=>{const Q=te.target.closest("[data-radix-menu-content]")===te.currentTarget,ee=te.ctrlKey||te.altKey||te.metaKey,se=te.key.length===1;Q&&(te.key==="Tab"&&te.preventDefault(),!ee&&se&&H(te.key));const pe=R.current;if(te.target!==pe||!Eze.includes(te.key))return;te.preventDefault();const Oe=k().filter(Fe=>!Fe.disabled).map(Fe=>Fe.ref.current);Cre.includes(te.key)&&Oe.reverse(),Kze(Oe)}),onBlur:Wt(e.onBlur,te=>{te.currentTarget.contains(te.target)||(window.clearTimeout(I.current),P.current="")}),onPointerMove:Wt(e.onPointerMove,Xw(te=>{const V=te.target,Q=O.current!==te.clientX;if(te.currentTarget.contains(V)&&Q){const ee=te.clientX>O.current?"right":"left";W.current=ee,O.current=te.clientX}}))})})})})})})});Rre.displayName=Gl;var Bze="MenuGroup",K6=E.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return f.jsx(lr.div,{role:"group",...r,ref:t})});K6.displayName=Bze;var $ze="MenuLabel",Nre=E.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return f.jsx(lr.div,{...r,ref:t})});Nre.displayName=$ze;var kk="MenuItem",Eq="menu.itemSelect",UT=E.forwardRef((e,t)=>{const{disabled:n=!1,onSelect:r,...s}=e,i=E.useRef(null),a=n_(kk,e.__scopeMenu),o=H6(kk,e.__scopeMenu),l=Mn(t,i),c=E.useRef(!1),u=()=>{const d=i.current;if(!n&&d){const h=new CustomEvent(Eq,{bubbles:!0,cancelable:!0});d.addEventListener(Eq,m=>r==null?void 0:r(m),{once:!0}),LG(d,h),h.defaultPrevented?c.current=!1:a.onClose()}};return f.jsx(Mre,{...s,ref:l,disabled:n,onClick:Wt(e.onClick,u),onPointerDown:d=>{var h;(h=e.onPointerDown)==null||h.call(e,d),c.current=!0},onPointerUp:Wt(e.onPointerUp,d=>{var h;c.current||(h=d.currentTarget)==null||h.click()}),onKeyDown:Wt(e.onKeyDown,d=>{const h=o.searchRef.current!=="";n||h&&d.key===" "||I4.includes(d.key)&&(d.currentTarget.click(),d.preventDefault())})})});UT.displayName=kk;var Mre=E.forwardRef((e,t)=>{const{__scopeMenu:n,disabled:r=!1,textValue:s,...i}=e,a=H6(kk,n),o=kre(n),l=E.useRef(null),c=Mn(t,l),[u,d]=E.useState(!1),[h,m]=E.useState("");return E.useEffect(()=>{const y=l.current;y&&m((y.textContent??"").trim())},[i.children]),f.jsx(Zw.ItemSlot,{scope:n,disabled:r,textValue:s??h,children:f.jsx(Zne,{asChild:!0,...o,focusable:!r,children:f.jsx(lr.div,{role:"menuitem","data-highlighted":u?"":void 0,"aria-disabled":r||void 0,"data-disabled":r?"":void 0,...i,ref:c,onPointerMove:Wt(e.onPointerMove,Xw(y=>{r?a.onItemLeave(y):(a.onItemEnter(y),y.defaultPrevented||y.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:Wt(e.onPointerLeave,Xw(y=>a.onItemLeave(y))),onFocus:Wt(e.onFocus,()=>d(!0)),onBlur:Wt(e.onBlur,()=>d(!1))})})})}),zze="MenuCheckboxItem",Ire=E.forwardRef((e,t)=>{const{checked:n=!1,onCheckedChange:r,...s}=e;return f.jsx(Fre,{scope:e.__scopeMenu,checked:n,children:f.jsx(UT,{role:"menuitemcheckbox","aria-checked":Ek(n)?"mixed":n,...s,ref:t,"data-state":Z6(n),onSelect:Wt(s.onSelect,()=>r==null?void 0:r(Ek(n)?!0:!n),{checkForDefaultPrevented:!1})})})});Ire.displayName=zze;var jre="MenuRadioGroup",[Uze,qze]=tg(jre,{value:void 0,onValueChange:()=>{}}),Ore=E.forwardRef((e,t)=>{const{value:n,onValueChange:r,...s}=e,i=Es(r);return f.jsx(Uze,{scope:e.__scopeMenu,value:n,onValueChange:i,children:f.jsx(K6,{...s,ref:t})})});Ore.displayName=jre;var Pre="MenuRadioItem",Dre=E.forwardRef((e,t)=>{const{value:n,...r}=e,s=qze(Pre,e.__scopeMenu),i=n===s.value;return f.jsx(Fre,{scope:e.__scopeMenu,checked:i,children:f.jsx(UT,{role:"menuitemradio","aria-checked":i,...r,ref:t,"data-state":Z6(i),onSelect:Wt(r.onSelect,()=>{var a;return(a=s.onValueChange)==null?void 0:a.call(s,n)},{checkForDefaultPrevented:!1})})})});Dre.displayName=Pre;var Y6="MenuItemIndicator",[Fre,Vze]=tg(Y6,{checked:!1}),Lre=E.forwardRef((e,t)=>{const{__scopeMenu:n,forceMount:r,...s}=e,i=Vze(Y6,n);return f.jsx(da,{present:r||Ek(i.checked)||i.checked===!0,children:f.jsx(lr.span,{...s,ref:t,"data-state":Z6(i.checked)})})});Lre.displayName=Y6;var Wze="MenuSeparator",Bre=E.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return f.jsx(lr.div,{role:"separator","aria-orientation":"horizontal",...r,ref:t})});Bre.displayName=Wze;var Hze="MenuArrow",$re=E.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e,s=zT(n);return f.jsx(uK,{...s,...r,ref:t})});$re.displayName=Hze;var Gze="MenuSub",[Ndt,zre]=tg(Gze),px="MenuSubTrigger",Ure=E.forwardRef((e,t)=>{const n=ng(px,e.__scopeMenu),r=n_(px,e.__scopeMenu),s=zre(px,e.__scopeMenu),i=H6(px,e.__scopeMenu),a=E.useRef(null),{pointerGraceTimerRef:o,onPointerGraceIntentChange:l}=i,c={__scopeMenu:e.__scopeMenu},u=E.useCallback(()=>{a.current&&window.clearTimeout(a.current),a.current=null},[]);return E.useEffect(()=>u,[u]),E.useEffect(()=>{const d=o.current;return()=>{window.clearTimeout(d),l(null)}},[o,l]),f.jsx(V6,{asChild:!0,...c,children:f.jsx(Mre,{id:s.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":s.contentId,"data-state":Wre(n.open),...e,ref:gl(t,s.onTriggerChange),onClick:d=>{var h;(h=e.onClick)==null||h.call(e,d),!(e.disabled||d.defaultPrevented)&&(d.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:Wt(e.onPointerMove,Xw(d=>{i.onItemEnter(d),!d.defaultPrevented&&!e.disabled&&!n.open&&!a.current&&(i.onPointerGraceIntentChange(null),a.current=window.setTimeout(()=>{n.onOpenChange(!0),u()},100))})),onPointerLeave:Wt(e.onPointerLeave,Xw(d=>{var m,y;u();const h=(m=n.content)==null?void 0:m.getBoundingClientRect();if(h){const b=(y=n.content)==null?void 0:y.dataset.side,v=b==="right",x=v?-5:5,w=h[v?"left":"right"],S=h[v?"right":"left"];i.onPointerGraceIntentChange({area:[{x:d.clientX+x,y:d.clientY},{x:w,y:h.top},{x:S,y:h.top},{x:S,y:h.bottom},{x:w,y:h.bottom}],side:b}),window.clearTimeout(o.current),o.current=window.setTimeout(()=>i.onPointerGraceIntentChange(null),300)}else{if(i.onTriggerLeave(d),d.defaultPrevented)return;i.onPointerGraceIntentChange(null)}})),onKeyDown:Wt(e.onKeyDown,d=>{var m;const h=i.searchRef.current!=="";e.disabled||h&&d.key===" "||Tze[r.dir].includes(d.key)&&(n.onOpenChange(!0),(m=n.content)==null||m.focus(),d.preventDefault())})})})});Ure.displayName=px;var qre="MenuSubContent",Vre=E.forwardRef((e,t)=>{const n=Tre(Gl,e.__scopeMenu),{forceMount:r=n.forceMount,...s}=e,i=ng(Gl,e.__scopeMenu),a=n_(Gl,e.__scopeMenu),o=zre(qre,e.__scopeMenu),l=E.useRef(null),c=Mn(t,l);return f.jsx(Zw.Provider,{scope:e.__scopeMenu,children:f.jsx(da,{present:r||i.open,children:f.jsx(Zw.Slot,{scope:e.__scopeMenu,children:f.jsx(G6,{id:o.contentId,"aria-labelledby":o.triggerId,...s,ref:c,align:"start",side:a.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:u=>{var d;a.isUsingKeyboardRef.current&&((d=l.current)==null||d.focus()),u.preventDefault()},onCloseAutoFocus:u=>u.preventDefault(),onFocusOutside:Wt(e.onFocusOutside,u=>{u.target!==o.trigger&&i.onOpenChange(!1)}),onEscapeKeyDown:Wt(e.onEscapeKeyDown,u=>{a.onClose(),u.preventDefault()}),onKeyDown:Wt(e.onKeyDown,u=>{var m;const d=u.currentTarget.contains(u.target),h=Aze[a.dir].includes(u.key);d&&h&&(i.onOpenChange(!1),(m=o.trigger)==null||m.focus(),u.preventDefault())})})})})})});Vre.displayName=qre;function Wre(e){return e?"open":"closed"}function Ek(e){return e==="indeterminate"}function Z6(e){return Ek(e)?"indeterminate":e?"checked":"unchecked"}function Kze(e){const t=document.activeElement;for(const n of e)if(n===t||(n.focus(),document.activeElement!==t))return}function Yze(e,t){return e.map((n,r)=>e[(t+r)%e.length])}function Zze(e,t,n){const s=t.length>1&&Array.from(t).every(c=>c===t[0])?t[0]:t,i=n?e.indexOf(n):-1;let a=Yze(e,Math.max(i,0));s.length===1&&(a=a.filter(c=>c!==n));const l=a.find(c=>c.toLowerCase().startsWith(s.toLowerCase()));return l!==n?l:void 0}function Xze(e,t){const{x:n,y:r}=e;let s=!1;for(let i=0,a=t.length-1;i<t.length;a=i++){const o=t[i],l=t[a],c=o.x,u=o.y,d=l.x,h=l.y;u>r!=h>r&&n<(d-c)*(r-u)/(h-u)+c&&(s=!s)}return s}function Jze(e,t){if(!t)return!1;const n={x:e.clientX,y:e.clientY};return Xze(n,t)}function Xw(e){return t=>t.pointerType==="mouse"?e(t):void 0}var Hre=Ere,Gre=V6,Kre=Are,Yre=Rre,Zre=K6,Xre=Nre,Jre=UT,Qre=Ire,ese=Ore,tse=Dre,nse=Lre,rse=Bre,sse=$re,ise=Ure,ase=Vre,X6="ContextMenu",[Qze,Mdt]=Ki(X6,[$T]),po=$T(),[e7e,ose]=Qze(X6),lse=e=>{const{__scopeContextMenu:t,children:n,onOpenChange:r,dir:s,modal:i=!0}=e,[a,o]=E.useState(!1),l=po(t),c=Es(r),u=E.useCallback(d=>{o(d),c(d)},[c]);return f.jsx(e7e,{scope:t,open:a,onOpenChange:u,modal:i,children:f.jsx(Hre,{...l,dir:s,open:a,onOpenChange:u,modal:i,children:n})})};lse.displayName=X6;var cse="ContextMenuTrigger",use=E.forwardRef((e,t)=>{const{__scopeContextMenu:n,disabled:r=!1,...s}=e,i=ose(cse,n),a=po(n),o=E.useRef({x:0,y:0}),l=E.useRef({getBoundingClientRect:()=>DOMRect.fromRect({width:0,height:0,...o.current})}),c=E.useRef(0),u=E.useCallback(()=>window.clearTimeout(c.current),[]),d=h=>{o.current={x:h.clientX,y:h.clientY},i.onOpenChange(!0)};return E.useEffect(()=>u,[u]),E.useEffect(()=>void(r&&u()),[r,u]),f.jsxs(f.Fragment,{children:[f.jsx(Gre,{...a,virtualRef:l}),f.jsx(lr.span,{"data-state":i.open?"open":"closed","data-disabled":r?"":void 0,...s,ref:t,style:{WebkitTouchCallout:"none",...e.style},onContextMenu:r?e.onContextMenu:Wt(e.onContextMenu,h=>{u(),d(h),h.preventDefault()}),onPointerDown:r?e.onPointerDown:Wt(e.onPointerDown,d2(h=>{u(),c.current=window.setTimeout(()=>d(h),700)})),onPointerMove:r?e.onPointerMove:Wt(e.onPointerMove,d2(u)),onPointerCancel:r?e.onPointerCancel:Wt(e.onPointerCancel,d2(u)),onPointerUp:r?e.onPointerUp:Wt(e.onPointerUp,d2(u))})]})});use.displayName=cse;var t7e="ContextMenuPortal",dse=e=>{const{__scopeContextMenu:t,...n}=e,r=po(t);return f.jsx(Kre,{...r,...n})};dse.displayName=t7e;var fse="ContextMenuContent",hse=E.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=ose(fse,n),i=po(n),a=E.useRef(!1);return f.jsx(Yre,{...i,...r,ref:t,side:"right",sideOffset:2,align:"start",onCloseAutoFocus:o=>{var l;(l=e.onCloseAutoFocus)==null||l.call(e,o),!o.defaultPrevented&&a.current&&o.preventDefault(),a.current=!1},onInteractOutside:o=>{var l;(l=e.onInteractOutside)==null||l.call(e,o),!o.defaultPrevented&&!s.modal&&(a.current=!0)},style:{...e.style,"--radix-context-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-context-menu-content-available-width":"var(--radix-popper-available-width)","--radix-context-menu-content-available-height":"var(--radix-popper-available-height)","--radix-context-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-context-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});hse.displayName=fse;var n7e="ContextMenuGroup",r7e=E.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=po(n);return f.jsx(Zre,{...s,...r,ref:t})});r7e.displayName=n7e;var s7e="ContextMenuLabel",i7e=E.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=po(n);return f.jsx(Xre,{...s,...r,ref:t})});i7e.displayName=s7e;var a7e="ContextMenuItem",pse=E.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=po(n);return f.jsx(Jre,{...s,...r,ref:t})});pse.displayName=a7e;var o7e="ContextMenuCheckboxItem",l7e=E.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=po(n);return f.jsx(Qre,{...s,...r,ref:t})});l7e.displayName=o7e;var c7e="ContextMenuRadioGroup",u7e=E.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=po(n);return f.jsx(ese,{...s,...r,ref:t})});u7e.displayName=c7e;var d7e="ContextMenuRadioItem",f7e=E.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=po(n);return f.jsx(tse,{...s,...r,ref:t})});f7e.displayName=d7e;var h7e="ContextMenuItemIndicator",p7e=E.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=po(n);return f.jsx(nse,{...s,...r,ref:t})});p7e.displayName=h7e;var m7e="ContextMenuSeparator",mse=E.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=po(n);return f.jsx(rse,{...s,...r,ref:t})});mse.displayName=m7e;var g7e="ContextMenuArrow",y7e=E.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=po(n);return f.jsx(sse,{...s,...r,ref:t})});y7e.displayName=g7e;var b7e="ContextMenuSubTrigger",v7e=E.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=po(n);return f.jsx(ise,{...s,...r,ref:t})});v7e.displayName=b7e;var x7e="ContextMenuSubContent",w7e=E.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=po(n);return f.jsx(ase,{...s,...r,ref:t,style:{...e.style,"--radix-context-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-context-menu-content-available-width":"var(--radix-popper-available-width)","--radix-context-menu-content-available-height":"var(--radix-popper-available-height)","--radix-context-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-context-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});w7e.displayName=x7e;function d2(e){return t=>t.pointerType!=="mouse"?e(t):void 0}var _7e=lse,S7e=use,C7e=dse,k7e=hse,E7e=pse,T7e=mse;function Tq({...e}){return f.jsx(_7e,{"data-slot":"context-menu",...e})}function Aq({...e}){return f.jsx(S7e,{"data-slot":"context-menu-trigger",...e})}function Rq({className:e,...t}){return f.jsx(C7e,{children:f.jsx(k7e,{"data-slot":"context-menu-content",className:Xe("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-context-menu-content-available-height) min-w-[8rem] origin-(--radix-context-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",e),...t})})}function rl({className:e,inset:t,variant:n="default",...r}){return f.jsx(E7e,{"data-slot":"context-menu-item","data-inset":t,"data-variant":n,className:Xe("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...r})}function Nq({className:e,...t}){return f.jsx(T7e,{"data-slot":"context-menu-separator",className:Xe("bg-border -mx-1 my-1 h-px",e),...t})}const A7e=({entry:e,isEditingThis:t,isChecked:n,isGitRepo:r,newName:s,isOperationLoading:i,creatingFolder:a,handleNavigate:o,handleCheckboxChange:l,startEditing:c,cancelEditing:u,handleRename:d,handleDownload:h,handleDelete:m,setNewName:y,renameInputRef:b,handleGitInit:v,handleGitPull:x,handleGitCommit:w,handleGitPush:S,handleGitStatus:k})=>{const C=e.type==="folder",T=B=>{B.target.closest('input[type="checkbox"], button, input[type="text"], [data-radix-context-menu-trigger]')||t||i||(C?o(e):l(!n,e.id))},R=B=>{B.key==="Enter"?d():B.key==="Escape"&&u()},N=C?r?vH:yh:bH,I=C?r?"text-green-400":"text-yellow-400":"text-blue-400",P=f.jsxs(Ts,{className:Xe("group hover:bg-muted/50",t&&"bg-muted ring-1 ring-primary",i&&"opacity-70 cursor-not-allowed",!C&&"cursor-pointer"),onClick:T,onDoubleClick:()=>!i&&!t&&o(e),children:[f.jsx(Fn,{className:"px-2 py-1",children:f.jsx($c,{checked:n,onCheckedChange:B=>l(!!B,e.id),"aria-label":`Select ${e.name}`,className:"border-border data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",disabled:i||C})}),f.jsx(Fn,{className:"px-2 py-1",children:f.jsx(N,{className:Xe("h-5 w-5",I)})}),f.jsx(Fn,{className:"py-1 px-2",children:t?f.jsx(Cn,{ref:b,value:s,onChange:B=>y(B.target.value),onBlur:d,onKeyDown:R,className:"h-7 px-2 py-1 text-sm bg-input border-border focus:ring-1 focus:ring-primary w-full",onClick:B=>B.stopPropagation(),disabled:i}):f.jsx("span",{className:Xe("truncate",C&&"cursor-pointer hover:underline"),title:e.name,onClick:B=>{C&&(B.stopPropagation(),o(e))},children:e.name})}),f.jsx(Fn,{className:"text-right py-1 px-2 text-xs text-muted-foreground",children:e.type==="file"&&e.size!==void 0?pw(e.size):""}),f.jsx(Fn,{className:"text-right text-xs text-muted-foreground py-1 px-2",children:new Date(e.lastModified).toLocaleString()}),f.jsx(Fn,{className:"text-right pr-4 py-1",children:f.jsx("div",{className:Xe("flex items-center justify-end gap-0.5 opacity-0 group-hover:opacity-100 focus-within:opacity-100 transition-opacity",t&&"opacity-100",i&&"opacity-30"),children:t?f.jsxs(f.Fragment,{children:[f.jsx(Un,{tooltipText:"Save (Enter)",onClick:B=>{B.stopPropagation(),d()},"aria-label":"Save name",disabled:i||!s.trim(),icon:i?f.jsx(Xn,{className:"h-4 w-4 animate-spin"}):f.jsx(ao,{}),className:"h-6 w-6 text-green-500 hover:text-green-400"}),f.jsx(Un,{tooltipText:"Cancel (Esc)",onClick:B=>{B.stopPropagation(),u()},"aria-label":"Cancel edit",disabled:i,icon:f.jsx(Oi,{}),className:"h-6 w-6 text-muted-foreground hover:text-foreground"})]}):f.jsxs(f.Fragment,{children:[f.jsx(Un,{tooltipText:"Rename",onClick:B=>{B.stopPropagation(),c(e)},"aria-label":"Rename",disabled:i||a,icon:f.jsx(ph,{}),className:"h-6 w-6 text-muted-foreground hover:text-foreground"}),f.jsx(Un,{tooltipText:C?"Download folder (.zip)":"Download file",onClick:B=>{B.stopPropagation(),h(e)},"aria-label":C?"Download folder as ZIP":"Download file",disabled:i,icon:f.jsx(Ec,{}),className:"h-6 w-6 text-muted-foreground hover:text-foreground"}),f.jsx(Un,{tooltipText:"Delete",onClick:B=>{B.stopPropagation(),m(e)},"aria-label":`Delete ${C?"folder":"file"}`,disabled:i,icon:f.jsx(Mo,{}),className:"h-6 w-6 text-destructive hover:text-destructive/80"})]})})})]},e.id);return C?f.jsxs(Tq,{children:[f.jsx(Aq,{disabled:t||i,asChild:!0,children:P}),f.jsxs(Rq,{children:[f.jsx(rl,{onSelect:()=>o(e),disabled:t||i,children:"Open Folder"}),f.jsx(Nq,{}),r?f.jsxs(f.Fragment,{children:[f.jsxs(rl,{onSelect:()=>x(e.path),disabled:i,children:[f.jsx(SH,{className:"mr-2 h-4 w-4"}),"Git Pull"]}),f.jsxs(rl,{onSelect:()=>w(e.path),disabled:i,children:[f.jsx(wH,{className:"mr-2 h-4 w-4"}),"Git Commit..."]}),f.jsxs(rl,{onSelect:()=>S(e.path),disabled:i,children:[f.jsx(UO,{className:"mr-2 h-4 w-4"}),"Git Push"]}),f.jsxs(rl,{onSelect:()=>k(e.path),disabled:i,children:[f.jsx(VO,{className:"mr-2 h-4 w-4"}),"Git Status"]})]}):f.jsxs(rl,{onSelect:()=>v(e.path),disabled:i,children:[f.jsx(Ic,{className:"mr-2 h-4 w-4"}),"Initialize Git Repository"]}),f.jsx(Nq,{}),f.jsxs(rl,{onSelect:()=>c(e),disabled:i,children:[f.jsx(ph,{className:"mr-2 h-4 w-4"}),"Rename"]}),f.jsxs(rl,{onSelect:()=>h(e),disabled:i,children:[f.jsx(Ec,{className:"mr-2 h-4 w-4"}),"Download as ZIP"]}),f.jsxs(rl,{className:"text-red-600 focus:text-red-600 focus:bg-red-100 dark:focus:bg-red-900/20",onSelect:()=>m(e),disabled:i,children:[f.jsx(Mo,{className:"mr-2 h-4 w-4"}),"Delete Folder"]})]})]},e.id):f.jsxs(Tq,{children:[f.jsx(Aq,{disabled:t||i,asChild:!0,children:P}),f.jsxs(Rq,{children:[f.jsxs(rl,{onSelect:()=>l(!n,e.id),disabled:i,children:[n?"Deselect":"Select"," File"]}),f.jsxs(rl,{onSelect:()=>c(e),disabled:i,children:[f.jsx(ph,{className:"mr-2 h-4 w-4"}),"Rename"]}),f.jsxs(rl,{onSelect:()=>h(e),disabled:i,children:[f.jsx(Ec,{className:"mr-2 h-4 w-4"}),"Download File"]}),f.jsxs(rl,{className:"text-red-600 focus:text-red-600 focus:bg-red-100 dark:focus:bg-red-900/20",onSelect:()=>m(e),disabled:i,children:[f.jsx(Mo,{className:"mr-2 h-4 w-4"}),"Delete File"]})]})]},e.id)},R7e=({entries:e,editingPath:t,newName:n,creatingFolder:r,newFolderName:s,selectedFileIds:i,isOperationLoading:a,handleNavigate:o,handleCheckboxChange:l,startEditing:c,cancelEditing:u,handleRename:d,cancelCreatingFolder:h,handleCreateFolder:m,handleDownload:y,handleDelete:b,setNewName:v,setNewFolderName:x,renameInputRef:w,newFolderInputRef:S,gitRepoStatus:k,handleGitInit:C,handleGitPull:T,handleGitCommit:R,handleGitPush:N,handleGitStatus:I})=>{const P=E.useMemo(()=>e,[e]);return a&&e.length===0&&!r?f.jsx("div",{className:"flex items-center justify-center h-full text-muted-foreground",children:"Loading..."}):f.jsx("div",{className:"relative h-full",children:f.jsxs(lf,{className:"w-full text-sm",children:[f.jsx(dp,{className:"sticky top-0 bg-card z-10",children:f.jsxs(Ts,{className:"hover:bg-card",children:[f.jsx(Ar,{className:"w-[40px] px-2"}),f.jsx(Ar,{className:"w-[40px] px-2"}),f.jsx(Ar,{children:"Name"}),f.jsx(Ar,{className:"w-[100px] text-right",children:"Size"}),f.jsx(Ar,{className:"w-[150px] text-right",children:"Modified"}),f.jsx(Ar,{className:"w-[100px] text-right pr-4",children:"Actions"})]})}),f.jsxs(cf,{children:[r&&f.jsx(Sre,{newFolderName:s,setNewFolderName:x,handleCreateFolder:m,cancelCreatingFolder:h,newFolderInputRef:S,isOperationLoading:a}),P.map(B=>{const D=t===B.path,W=i.has(B.id),O=k[B.path]??!1;return f.jsx(A7e,{entry:B,isEditingThis:D,isChecked:W,isGitRepo:O,newName:D?n:"",isOperationLoading:a,creatingFolder:r,handleNavigate:o,handleCheckboxChange:l,startEditing:c,cancelEditing:u,handleRename:d,handleDownload:y,handleDelete:b,setNewName:v,renameInputRef:w,handleGitInit:C,handleGitPull:T,handleGitCommit:R,handleGitPush:N,handleGitStatus:I},B.id)}),e.length===0&&!r&&!a&&f.jsx(Ts,{children:f.jsx(Fn,{colSpan:6,className:"h-24 text-center text-muted-foreground",children:"Folder is empty"})})]})]})})},N7e=({currentPath:e,isAnyLoading:t,isOperationLoading:n,entries:r,editingPath:s,creatingFolder:i,handleNavigateHome:a,handleNavigateUp:o,handleRefresh:l,startCreatingFolder:c,handleUploadClick:u,handleFolderUploadClick:d,handleArchiveUploadClick:h,handleDownloadAll:m,handleCloneClick:y,fileInputRef:b,folderInputRef:v,archiveInputRef:x,handleFileChange:w,handleArchiveChange:S})=>f.jsxs(f.Fragment,{children:[f.jsx("input",{type:"file",ref:b,onChange:w,className:"hidden",multiple:!0,disabled:t}),f.jsx("input",{type:"file",ref:v,onChange:w,className:"hidden",webkitdirectory:"true",mozdirectory:"true",directory:"true",disabled:t}),f.jsx("input",{type:"file",ref:x,onChange:S,className:"hidden",accept:".zip",disabled:t}),f.jsxs("div",{className:"flex items-center gap-1 p-2 border-b border-border flex-shrink-0 flex-wrap",children:[f.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[f.jsx(mt,{variant:"ghost",size:"icon",onClick:k=>{k.preventDefault(),k.stopPropagation(),a()},disabled:e==="/"||t,title:"Go to root directory",className:"h-8 w-8",type:"button",children:f.jsx(Ume,{className:"h-4 w-4"})}),f.jsx(mt,{variant:"ghost",size:"icon",onClick:k=>{k.preventDefault(),k.stopPropagation(),o()},disabled:e==="/"||t,title:"Go up one level",className:"h-8 w-8",type:"button",children:f.jsx(Cme,{className:"h-4 w-4"})}),f.jsx("span",{className:"text-sm font-mono text-muted-foreground truncate flex-shrink min-w-0 px-2 py-1 rounded bg-muted/50 max-w-[150px] sm:max-w-xs md:max-w-sm lg:max-w-md",title:e,children:e})]}),f.jsx("div",{className:"flex-grow"}),f.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0 flex-wrap justify-end",children:[" ",f.jsx(mt,{variant:"ghost",size:"icon",onClick:k=>{k.preventDefault(),k.stopPropagation(),l()},disabled:t,title:"Refresh current directory",className:"h-8 w-8",type:"button",children:n?f.jsx(Xn,{className:"h-4 w-4 animate-spin"}):f.jsx(vm,{className:"h-4 w-4"})}),f.jsxs(mt,{variant:"outline",size:"sm",onClick:k=>{k.preventDefault(),k.stopPropagation(),c()},disabled:t||i||!!s,className:"h-8",title:"Create New Folder",type:"button",children:[n&&i?f.jsx(Xn,{className:"h-4 w-4 mr-1 animate-spin"}):f.jsx(xH,{className:"h-4 w-4 mr-1"}),f.jsx("span",{className:"hidden sm:inline",children:"Folder"})," "]}),f.jsxs(mt,{variant:"outline",size:"sm",onClick:k=>{k.preventDefault(),k.stopPropagation(),u()},disabled:t,className:"h-8",title:"Upload Files",type:"button",children:[n?f.jsx(Xn,{className:"h-4 w-4 mr-1 animate-spin"}):f.jsx(zO,{className:"h-4 w-4 mr-1"}),f.jsx("span",{className:"hidden sm:inline",children:"Files"})," "]}),f.jsxs(mt,{variant:"outline",size:"sm",onClick:k=>{k.preventDefault(),k.stopPropagation(),d()},disabled:t,className:"h-8",title:"Upload Folder",type:"button",children:[n?f.jsx(Xn,{className:"h-4 w-4 mr-1 animate-spin"}):f.jsx(yh,{className:"h-4 w-4 mr-1"}),f.jsx("span",{className:"hidden sm:inline",children:"Folder"})," "]}),f.jsxs(mt,{variant:"outline",size:"sm",onClick:k=>{k.preventDefault(),k.stopPropagation(),h()},disabled:t,className:"h-8",title:"Upload & Extract ZIP",type:"button",children:[n?f.jsx(Xn,{className:"h-4 w-4 mr-1 animate-spin"}):f.jsx(cme,{className:"h-4 w-4 mr-1"}),f.jsx("span",{className:"hidden sm:inline",children:"ZIP"})," "]}),f.jsxs(mt,{variant:"outline",size:"sm",onClick:k=>{k.preventDefault(),k.stopPropagation(),y()},disabled:t,className:"h-8",title:"Clone Git Repository",type:"button",children:[n?f.jsx(Xn,{className:"h-4 w-4 mr-1 animate-spin"}):f.jsx(Ic,{className:"h-4 w-4 mr-1"}),f.jsx("span",{className:"hidden sm:inline",children:"Clone"})," "]}),f.jsxs(mt,{variant:"outline",size:"sm",onClick:k=>{k.preventDefault(),k.stopPropagation(),m()},disabled:t||r.length===0,className:"h-8",title:"Download Current Directory as ZIP",type:"button",children:[n?f.jsx(Xn,{className:"h-4 w-4 mr-1 animate-spin"}):f.jsx(gH,{className:"h-4 w-4 mr-1"}),f.jsx("span",{className:"hidden sm:inline",children:"Export"})," "]})]})]})]}),gse=({isOpen:e,onOpenChange:t,title:n,description:r,children:s,submitLabel:i="Submit",onSubmit:a,isSubmitting:o,submitDisabled:l=!1,className:c,contentClassName:u})=>{const d=async h=>{h==null||h.preventDefault(),!(o||l)&&await a()};return f.jsx(op,{open:e,onOpenChange:t,children:f.jsxs(lp,{className:Xe(c),children:[f.jsxs(cp,{children:[f.jsx(up,{children:n}),r&&f.jsx(eg,{children:r})]}),f.jsx("div",{className:Xe("py-4",u),children:s}),f.jsxs(gb,{children:[f.jsx(h9e,{asChild:!0,children:f.jsx(mt,{variant:"outline",disabled:o,children:"Cancel"})}),f.jsxs(mt,{onClick:d,disabled:o||l,children:[o&&f.jsx(Xn,{className:"mr-2 h-4 w-4 animate-spin"}),o?"Submitting...":i]})]})]})})},M7e=({isOpen:e,onOpenChange:t,cloneRepoUrl:n,setCloneRepoUrl:r,cloneBranch:s,setCloneBranch:i,isCloning:a,onSubmitClone:o,currentPath:l})=>f.jsx(gse,{isOpen:e,onOpenChange:t,title:"Clone Git Repository",description:f.jsxs(f.Fragment,{children:["Enter the repository URL. It will be cloned into a new folder named after the repository within ",f.jsx("code",{children:l}),"."]}),submitLabel:"Clone",onSubmit:o,isSubmitting:a,submitDisabled:!n.trim(),children:f.jsxs("div",{className:"grid gap-4",children:[f.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[f.jsx(Ot,{htmlFor:"clone-url",className:"text-right",children:"URL"}),f.jsx(Cn,{id:"clone-url",value:n,onChange:c=>r(c.target.value),className:"col-span-3",placeholder:"https://github.com/user/repo.git",disabled:a})]}),f.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[f.jsx(Ot,{htmlFor:"clone-branch",className:"text-right",children:"Branch"}),f.jsx(Cn,{id:"clone-branch",value:s,onChange:c=>i(c.target.value),className:"col-span-3",placeholder:"main (default)",disabled:a})]})]})}),I7e=({isOpen:e,onOpenChange:t,commitPath:n,commitMessage:r,setCommitMessage:s,isCommitting:i,onSubmitCommit:a})=>f.jsx(gse,{isOpen:e,onOpenChange:t,title:"Commit Changes",description:f.jsxs(f.Fragment,{children:["Enter a commit message for the changes in ",f.jsx("code",{children:n}),". All current changes in this directory will be staged and committed."]}),submitLabel:"Commit",onSubmit:a,isSubmitting:i,submitDisabled:!r.trim(),children:f.jsx("div",{className:"grid gap-4",children:f.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[f.jsx(Ot,{htmlFor:"commit-msg",className:"text-right",children:"Message"}),f.jsx(Cn,{id:"commit-msg",value:r,onChange:o=>s(o.target.value),className:"col-span-3",placeholder:"e.g., Add feature X",disabled:i})]})})});var qT="DropdownMenu",[j7e,Idt]=Ki(qT,[$T]),mo=$T(),[O7e,yse]=j7e(qT),bse=e=>{const{__scopeDropdownMenu:t,children:n,dir:r,open:s,defaultOpen:i,onOpenChange:a,modal:o=!0}=e,l=mo(t),c=E.useRef(null),[u,d]=Fc({prop:s,defaultProp:i??!1,onChange:a,caller:qT});return f.jsx(O7e,{scope:t,triggerId:la(),triggerRef:c,contentId:la(),open:u,onOpenChange:d,onOpenToggle:E.useCallback(()=>d(h=>!h),[d]),modal:o,children:f.jsx(Hre,{...l,open:u,onOpenChange:d,dir:r,modal:o,children:n})})};bse.displayName=qT;var vse="DropdownMenuTrigger",xse=E.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,disabled:r=!1,...s}=e,i=yse(vse,n),a=mo(n);return f.jsx(Gre,{asChild:!0,...a,children:f.jsx(lr.button,{type:"button",id:i.triggerId,"aria-haspopup":"menu","aria-expanded":i.open,"aria-controls":i.open?i.contentId:void 0,"data-state":i.open?"open":"closed","data-disabled":r?"":void 0,disabled:r,...s,ref:gl(t,i.triggerRef),onPointerDown:Wt(e.onPointerDown,o=>{!r&&o.button===0&&o.ctrlKey===!1&&(i.onOpenToggle(),i.open||o.preventDefault())}),onKeyDown:Wt(e.onKeyDown,o=>{r||(["Enter"," "].includes(o.key)&&i.onOpenToggle(),o.key==="ArrowDown"&&i.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(o.key)&&o.preventDefault())})})})});xse.displayName=vse;var P7e="DropdownMenuPortal",wse=e=>{const{__scopeDropdownMenu:t,...n}=e,r=mo(t);return f.jsx(Kre,{...r,...n})};wse.displayName=P7e;var _se="DropdownMenuContent",Sse=E.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=yse(_se,n),i=mo(n),a=E.useRef(!1);return f.jsx(Yre,{id:s.contentId,"aria-labelledby":s.triggerId,...i,...r,ref:t,onCloseAutoFocus:Wt(e.onCloseAutoFocus,o=>{var l;a.current||(l=s.triggerRef.current)==null||l.focus(),a.current=!1,o.preventDefault()}),onInteractOutside:Wt(e.onInteractOutside,o=>{const l=o.detail.originalEvent,c=l.button===0&&l.ctrlKey===!0,u=l.button===2||c;(!s.modal||u)&&(a.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});Sse.displayName=_se;var D7e="DropdownMenuGroup",F7e=E.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=mo(n);return f.jsx(Zre,{...s,...r,ref:t})});F7e.displayName=D7e;var L7e="DropdownMenuLabel",B7e=E.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=mo(n);return f.jsx(Xre,{...s,...r,ref:t})});B7e.displayName=L7e;var $7e="DropdownMenuItem",Cse=E.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=mo(n);return f.jsx(Jre,{...s,...r,ref:t})});Cse.displayName=$7e;var z7e="DropdownMenuCheckboxItem",U7e=E.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=mo(n);return f.jsx(Qre,{...s,...r,ref:t})});U7e.displayName=z7e;var q7e="DropdownMenuRadioGroup",V7e=E.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=mo(n);return f.jsx(ese,{...s,...r,ref:t})});V7e.displayName=q7e;var W7e="DropdownMenuRadioItem",H7e=E.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=mo(n);return f.jsx(tse,{...s,...r,ref:t})});H7e.displayName=W7e;var G7e="DropdownMenuItemIndicator",K7e=E.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=mo(n);return f.jsx(nse,{...s,...r,ref:t})});K7e.displayName=G7e;var Y7e="DropdownMenuSeparator",kse=E.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=mo(n);return f.jsx(rse,{...s,...r,ref:t})});kse.displayName=Y7e;var Z7e="DropdownMenuArrow",X7e=E.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=mo(n);return f.jsx(sse,{...s,...r,ref:t})});X7e.displayName=Z7e;var J7e="DropdownMenuSubTrigger",Q7e=E.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=mo(n);return f.jsx(ise,{...s,...r,ref:t})});Q7e.displayName=J7e;var eUe="DropdownMenuSubContent",tUe=E.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=mo(n);return f.jsx(ase,{...s,...r,ref:t,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});tUe.displayName=eUe;var nUe=bse,rUe=xse,sUe=wse,iUe=Sse,aUe=Cse,oUe=kse;function lUe({...e}){return f.jsx(nUe,{"data-slot":"dropdown-menu",...e})}function cUe({...e}){return f.jsx(rUe,{"data-slot":"dropdown-menu-trigger",...e})}function uUe({className:e,sideOffset:t=4,...n}){return f.jsx(sUe,{children:f.jsx(iUe,{"data-slot":"dropdown-menu-content",sideOffset:t,className:Xe("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-dropdown-menu-content-available-height) min-w-[8rem] origin-(--radix-dropdown-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",e),...n})})}function au({className:e,inset:t,variant:n="default",...r}){return f.jsx(aUe,{"data-slot":"dropdown-menu-item","data-inset":t,"data-variant":n,className:Xe("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...r})}function Mq({className:e,...t}){return f.jsx(oUe,{"data-slot":"dropdown-menu-separator",className:Xe("bg-border -mx-1 my-1 h-px",e),...t})}const dUe=({entries:e,editingPath:t,newName:n,creatingFolder:r,newFolderName:s,selectedFileIds:i,isOperationLoading:a,handleNavigate:o,handleCheckboxChange:l,startEditing:c,cancelEditing:u,handleRename:d,cancelCreatingFolder:h,handleCreateFolder:m,handleDownload:y,handleDelete:b,setNewName:v,setNewFolderName:x,renameInputRef:w,newFolderInputRef:S,gitRepoStatus:k,handleGitInit:C,handleGitPull:T,handleGitCommit:R,handleGitPush:N,handleGitStatus:I})=>{const P=B=>{B.key==="Enter"?d():B.key==="Escape"&&u()};return a&&e.length===0&&!r?f.jsx("div",{className:"flex items-center justify-center h-full text-muted-foreground p-4",children:"Loading..."}):f.jsxs("div",{className:"p-2 space-y-1",children:[r&&f.jsx("div",{className:"border rounded-md p-2 bg-muted/30",children:f.jsx(Sre,{newFolderName:s,setNewFolderName:x,handleCreateFolder:m,cancelCreatingFolder:h,newFolderInputRef:S,isOperationLoading:a,isMobile:!0})}),e.map(B=>{const D=t===B.path,W=i.has(B.id),O=k[B.path]??!1,Z=B.type==="folder",U=Z?O?vH:yh:bH,H=Z?O?"text-green-400":"text-yellow-400":"text-blue-400";return f.jsxs("div",{className:Xe("flex items-center justify-between p-2 border rounded-md",D&&"bg-muted ring-1 ring-primary",a&&"opacity-70 cursor-not-allowed",!D&&"hover:bg-muted/50",!D&&"cursor-pointer"),onClick:()=>{D||a||(Z?o(B):l(!W,B.id))},children:[f.jsxs("div",{className:"flex items-center gap-2 flex-grow min-w-0",children:[!Z&&f.jsx($c,{checked:W,onCheckedChange:L=>l(!!L,B.id),"aria-label":`Select ${B.name}`,className:"border-border data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground flex-shrink-0",disabled:a,onClick:L=>L.stopPropagation()}),Z&&f.jsx("div",{className:"w-6 flex-shrink-0"}),f.jsx(U,{className:Xe("h-5 w-5 flex-shrink-0",H)}),f.jsxs("div",{className:"flex flex-col min-w-0 flex-grow",children:[D?f.jsx(Cn,{ref:w,value:n,onChange:L=>v(L.target.value),onBlur:d,onKeyDown:P,className:"h-7 px-2 py-1 text-sm bg-input border-border focus:ring-1 focus:ring-primary w-full",onClick:L=>L.stopPropagation(),disabled:a}):f.jsx("span",{className:"text-sm font-medium truncate",title:B.name,children:B.name}),f.jsx("span",{className:"text-xs text-muted-foreground",children:B.type==="file"&&B.size!==void 0?pw(B.size):B.type==="folder"?O?"Git Repository":"Folder":""})]})]}),f.jsx("div",{className:"flex items-center flex-shrink-0 ml-2",children:D?f.jsxs(f.Fragment,{children:[f.jsx(mt,{variant:"ghost",size:"icon",className:"h-7 w-7 text-green-500 hover:text-green-600",onClick:L=>{L.stopPropagation(),d()},disabled:a||!n.trim(),"aria-label":"Save name",children:a?f.jsx(Xn,{className:"h-4 w-4 animate-spin"}):f.jsx(ao,{className:"h-4 w-4"})}),f.jsx(mt,{variant:"ghost",size:"icon",className:"h-7 w-7 text-muted-foreground hover:text-foreground",onClick:L=>{L.stopPropagation(),u()},disabled:a,"aria-label":"Cancel edit",children:f.jsx(Oi,{className:"h-4 w-4"})})]}):f.jsxs(lUe,{children:[f.jsx(cUe,{asChild:!0,children:f.jsx(mt,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:L=>L.stopPropagation(),disabled:a,"aria-label":"More actions",children:f.jsx(ome,{className:"h-4 w-4"})})}),f.jsxs(uUe,{align:"end",onClick:L=>L.stopPropagation(),children:[Z&&f.jsx(au,{onSelect:()=>o(B),children:"Open Folder"}),!Z&&f.jsxs(au,{onSelect:()=>l(!W,B.id),children:[W?"Deselect":"Select"," File"]}),f.jsxs(au,{onSelect:()=>c(B),children:[f.jsx(ph,{className:"mr-2 h-4 w-4"})," Rename"]}),f.jsxs(au,{onSelect:()=>y(B),children:[f.jsx(Ec,{className:"mr-2 h-4 w-4"})," Download"," ",Z?"as ZIP":""]}),Z&&f.jsx(Mq,{}),Z&&O&&f.jsxs(f.Fragment,{children:[f.jsxs(au,{onSelect:()=>T(B.path),children:[f.jsx(SH,{className:"mr-2 h-4 w-4"})," Git Pull"]}),f.jsxs(au,{onSelect:()=>R(B.path),children:[f.jsx(wH,{className:"mr-2 h-4 w-4"})," Git Commit..."]}),f.jsxs(au,{onSelect:()=>N(B.path),children:[f.jsx(UO,{className:"mr-2 h-4 w-4"})," Git Push"]}),f.jsxs(au,{onSelect:()=>I(B.path),children:[f.jsx(VO,{className:"mr-2 h-4 w-4"})," Git Status"]})]}),Z&&!O&&f.jsxs(au,{onSelect:()=>C(B.path),children:[f.jsx(Ic,{className:"mr-2 h-4 w-4"})," Initialize Git Repo"]}),f.jsx(Mq,{}),f.jsxs(au,{className:"text-red-600 focus:text-red-600",onSelect:()=>b(B),children:[f.jsx(Mo,{className:"mr-2 h-4 w-4"})," Delete"]})]})]})})]},B.id)}),e.length===0&&!r&&!a&&f.jsx("div",{className:"p-4 text-center text-sm text-muted-foreground",children:"Folder is empty"})]})},J6=E.memo(()=>{const{nodes:e,childrenMap:t,currentParentId:n,loading:r,operationLoading:s,error:i,rootId:a,selectedFileIds:o,vfsKey:l,configuredVfsKey:c,initializingKey:u}=ei(yn(_e=>({nodes:_e.nodes,childrenMap:_e.childrenMap,currentParentId:_e.currentParentId,selectedFileIds:_e.selectedFileIds,loading:_e.loading,operationLoading:_e.operationLoading,error:_e.error,rootId:_e.rootId,vfsKey:_e.vfsKey,configuredVfsKey:_e.configuredVfsKey,initializingKey:_e.initializingKey}))),[d,h]=E.useState(""),[m,y]=E.useState(null),[b,v]=E.useState(!1),[x,w]=E.useState(""),[S,k]=E.useState({}),[C,T]=E.useState(!1),[R,N]=E.useState(""),[I,P]=E.useState(""),[B,D]=E.useState(!1),[W,O]=E.useState(!1),[Z,U]=E.useState(null),[H,L]=E.useState(""),[te,V]=E.useState(!1),[Q,ee]=E.useState({}),se=E.useRef(null),pe=E.useRef(null),ue=E.useRef(null),Oe=E.useRef(null),Fe=E.useRef(null),Se=n?e[n]:null,Ce=Se?Se.path:"/",Qe=(t[n||a||""]||[]).map(_e=>e[_e]).filter(_e=>!!_e).sort((_e,$e)=>_e.type==="folder"&&$e.type==="file"?-1:_e.type==="file"&&$e.type==="folder"?1:_e.name.localeCompare($e.name)),We=E.useMemo(()=>Qe.filter(_e=>_e.type==="folder").map(_e=>_e.path),[Qe]),Ie=r||u!==null||l!==c,K=s||B||te||Object.values(Q).some(Boolean);E.useEffect(()=>{n!==null&&!t[n]&&!Ie&&c===l?Pe.emit(dn.fetchNodesRequest,{parentId:n}):n===null&&a&&!t[a]&&!Ie&&c===l&&Pe.emit(dn.fetchNodesRequest,{parentId:a})},[n,t,a,Ie,c,l]),E.useEffect(()=>{var _e,$e;m&&((_e=Oe.current)==null||_e.focus(),($e=Oe.current)==null||$e.select())},[m]),E.useEffect(()=>{var _e;b&&((_e=Fe.current)==null||_e.focus())},[b]),E.useEffect(()=>{(async()=>{if(Ie||We.length===0)return;const $e={};let Ct=!1;for(const fe of We)try{const Y=await mTe(fe);S[fe]!==Y&&($e[fe]=Y,Ct=!0)}catch(Y){console.error(`Error checking git status for ${fe}:`,Y),S[fe]!==!1&&($e[fe]=!1,Ct=!0)}Ct&&k(fe=>({...fe,...$e}))})()},[We,Ie,S]);const ye=E.useCallback(async(_e,$e,Ct)=>{if(!(K||Ie)){Ct!==!1&&Pe.emit(dn.loadingStateChanged,{isLoading:r,operationLoading:!0,error:null});try{Pe.emit(_e,$e)}catch(fe){console.error("[FileManager Operation Error]:",fe),Pe.emit(dn.loadingStateChanged,{isLoading:r,operationLoading:s,error:fe instanceof Error?fe.message:String(fe)})}finally{Ct!==!1&&Pe.emit(dn.loadingStateChanged,{isLoading:r,operationLoading:!1,error:i})}}},[K,Ie,r,s,i]),Ne=E.useCallback(_e=>{K||Ie||m||_e.type==="folder"&&ye(dn.setCurrentPathRequest,{path:_e.path},!1)},[K,Ie,m,ye]),ce=E.useCallback(()=>{if(K||Ie||Ce==="/")return;const _e=tT(Ce);ye(dn.setCurrentPathRequest,{path:_e},!1)},[K,Ie,Ce,ye]),oe=E.useCallback(()=>{K||Ie||Ce==="/"||ye(dn.setCurrentPathRequest,{path:"/"},!1)},[K,Ie,Ce,ye]),re=E.useCallback(()=>{Ie||ye(dn.fetchNodesRequest,{parentId:n},!1)},[ye,n,Ie]),Re=E.useCallback((_e,$e)=>{const Ct=e[$e];Ct&&Ct.type==="file"?_e?Pe.emit(dn.selectFileRequest,{fileId:$e}):Pe.emit(dn.deselectFileRequest,{fileId:$e}):Ct&&Ct.type==="folder"&&Me.info("Folders cannot be attached to the prompt.")},[e]),Be=E.useCallback(_e=>{K||Ie||b||(y(_e.path),h(_e.name),v(!1))},[K,Ie,b]),Te=E.useCallback(()=>{y(null),h("")},[]),lt=E.useCallback(async()=>{if(!m||!d.trim()){Te();return}const _e=Object.values(e).find($e=>$e.path===m);_e&&_e.name!==d.trim()&&await ye(dn.renameNodeRequest,{id:_e.id,newName:d.trim()}),Te()},[m,d,e,Te,ye]),Tt=E.useCallback(()=>{K||Ie||m||(v(!0),w(""),y(null))},[K,Ie,m]),ut=E.useCallback(()=>{v(!1),w("")},[]),jt=E.useCallback(async()=>{if(!x.trim()){ut();return}await ye(dn.createDirectoryRequest,{parentId:n,name:x.trim()}),ut()},[x,n,ut,ye]),qt=()=>{var _e;return(_e=se.current)==null?void 0:_e.click()},Ft=()=>{var _e;return(_e=pe.current)==null?void 0:_e.click()},Ht=()=>{var _e;return(_e=ue.current)==null?void 0:_e.click()},we=E.useCallback(async _e=>{const $e=_e.target.files;$e&&$e.length>0&&(await ye(dn.uploadFilesRequest,{parentId:n,files:$e}),_e.target&&(_e.target.value=""))},[n,ye]),F=E.useCallback(async _e=>{var Ct;const $e=(Ct=_e.target.files)==null?void 0:Ct[0];if($e){Pe.emit(dn.loadingStateChanged,{isLoading:r,operationLoading:!0,error:null});try{await bTe($e,Ce),Pe.emit(dn.fetchNodesRequest,{parentId:n})}catch(fe){console.error("Archive upload error:",fe)}finally{Pe.emit(dn.loadingStateChanged,{isLoading:r,operationLoading:!1,error:i}),_e.target&&(_e.target.value="")}}},[Ce,n,r,i]),X=E.useCallback(async _e=>{window.confirm(`Delete ${_e.type} "${_e.name}"?${_e.type==="folder"?`

WARNING: This will delete all contents inside`:""}`)&&await ye(dn.deleteNodesRequest,{ids:[_e.id]})},[ye]),be=E.useCallback(async _e=>{Pe.emit(dn.loadingStateChanged,{isLoading:r,operationLoading:!0,error:null});try{_e.type==="file"?await yTe(_e.path):await Az(`${_e.name}.zip`,_e.path)}catch($e){console.error("Download error:",$e)}finally{Pe.emit(dn.loadingStateChanged,{isLoading:r,operationLoading:!1,error:i})}},[r,i]),ke=E.useCallback(async()=>{if(Qe.length!==0){Pe.emit(dn.loadingStateChanged,{isLoading:r,operationLoading:!0,error:null});try{const _e=vi(Ce)||"root";await Az(`${_e}_export.zip`,Ce)}catch(_e){console.error("Download all error:",_e)}finally{Pe.emit(dn.loadingStateChanged,{isLoading:r,operationLoading:!1,error:i})}}},[Ce,Qe.length,r,i]),ge=E.useCallback(async(_e,$e)=>{if(!(Q[_e]||Ie||s)){ee(Ct=>({...Ct,[_e]:!0})),Pe.emit(dn.loadingStateChanged,{isLoading:r,operationLoading:s,error:null});try{await $e()}catch(Ct){console.error(`[FileManager Git Op Error @ ${_e}]:`,Ct)}finally{ee(Ct=>({...Ct,[_e]:!1}))}}},[Q,Ie,s,r]),Ee=E.useCallback(_e=>{ge(_e,async()=>{await CZ(_e),k($e=>({...$e,[_e]:!0}))})},[ge]),le=E.useCallback(_e=>{Me.info("Pulling default branch (auth not implemented yet)..."),ge(_e,()=>oT(_e,"main"))},[ge]),dt=E.useCallback(_e=>{U(_e),L(""),O(!0)},[]),et=E.useCallback(_e=>{Me.info("Pushing default branch (auth not implemented yet)..."),ge(_e,()=>bD(_e,"main"))},[ge]),$=E.useCallback(_e=>{ge(_e,()=>kZ(_e))},[ge]),Ue=E.useCallback(()=>{N(""),P(""),T(!0)},[]),tt=E.useCallback(async()=>{if(!R.trim()){Me.error("Repository URL cannot be empty.");return}D(!0),Pe.emit(dn.loadingStateChanged,{isLoading:r,operationLoading:s,error:null});try{const _e=vi(R.trim().replace(/\.git$/,""))||"cloned_repo",$e=jj(Ce,_e);await SZ($e,R.trim(),I.trim()||void 0),T(!1),Pe.emit(dn.fetchNodesRequest,{parentId:n})}catch{}finally{D(!1)}},[R,I,Ce,n,r,s]),ve=E.useCallback(async()=>{if(!Z||!H.trim()){Me.error("Commit message cannot be empty.");return}V(!0),Pe.emit(dn.loadingStateChanged,{isLoading:r,operationLoading:s,error:null});try{await yD(Z,H.trim()),O(!1)}catch{}finally{V(!1)}},[Z,H,r,s]);return Ie?f.jsxs("div",{className:"flex h-full flex-col items-center justify-center bg-card text-muted-foreground p-4",children:[f.jsx(Xn,{className:"h-8 w-8 animate-spin mb-2"}),f.jsx("p",{children:u?`Initializing filesystem: ${u}`:"Loading filesystem..."}),i&&f.jsxs("p",{className:"text-destructive mt-2",children:["Error: ",i]})]}):i&&!Ie?f.jsxs("div",{className:"flex h-full flex-col items-center justify-center bg-card text-destructive p-4",children:[f.jsxs("p",{children:["Error loading filesystem: ",i]}),f.jsx(mt,{variant:"outline",size:"sm",onClick:()=>Pe.emit(dn.initializeVFSRequest,{vfsKey:l||"default_fallback_key"}),className:"mt-2",children:"Retry"})]}):f.jsxs("div",{className:Xe("flex h-full flex-col bg-card text-card-foreground"),children:[f.jsx(N7e,{currentPath:Ce,isAnyLoading:K||Ie,isOperationLoading:s,entries:Qe,editingPath:m,creatingFolder:b,handleNavigateHome:oe,handleNavigateUp:ce,handleRefresh:re,startCreatingFolder:Tt,handleUploadClick:qt,handleFolderUploadClick:Ft,handleArchiveUploadClick:Ht,handleDownloadAll:ke,handleCloneClick:Ue,fileInputRef:se,folderInputRef:pe,archiveInputRef:ue,handleFileChange:we,handleArchiveChange:F}),f.jsx("div",{className:"flex-grow overflow-auto hidden md:block",children:f.jsx(R7e,{entries:Qe,editingPath:m,newName:d,creatingFolder:b,newFolderName:x,selectedFileIds:o,isOperationLoading:K,handleNavigate:Ne,handleCheckboxChange:Re,startEditing:Be,cancelEditing:Te,handleRename:lt,cancelCreatingFolder:ut,handleCreateFolder:jt,handleDownload:be,handleDelete:X,setNewName:h,setNewFolderName:w,renameInputRef:Oe,newFolderInputRef:Fe,gitRepoStatus:S,handleGitInit:Ee,handleGitPull:le,handleGitCommit:dt,handleGitPush:et,handleGitStatus:$})}),f.jsx("div",{className:"flex-grow overflow-auto block md:hidden",children:f.jsx(dUe,{entries:Qe,editingPath:m,newName:d,creatingFolder:b,newFolderName:x,selectedFileIds:o,isOperationLoading:K,handleNavigate:Ne,handleCheckboxChange:Re,startEditing:Be,cancelEditing:Te,handleRename:lt,cancelCreatingFolder:ut,handleCreateFolder:jt,handleDownload:be,handleDelete:X,setNewName:h,setNewFolderName:w,renameInputRef:Oe,newFolderInputRef:Fe,gitRepoStatus:S,handleGitInit:Ee,handleGitPull:le,handleGitCommit:dt,handleGitPush:et,handleGitStatus:$})}),f.jsx(M7e,{isOpen:C,onOpenChange:T,cloneRepoUrl:R,setCloneRepoUrl:N,cloneBranch:I,setCloneBranch:P,isCloning:B,onSubmitClone:tt,currentPath:Ce}),f.jsx(I7e,{isOpen:W,onOpenChange:O,commitPath:Z,commitMessage:H,setCommitMessage:L,isCommitting:te,onSubmitCommit:ve})]})});J6.displayName="FileManager";const fUe=({vfsKey:e,selectedItemType:t})=>e==="orphan"?f.jsxs("div",{className:"flex items-center gap-2 text-xs text-blue-300 bg-blue-900/40 px-2 py-1 rounded mb-1",children:[f.jsx(jB,{className:"h-4 w-4"}),f.jsxs("span",{children:[f.jsx("b",{children:"Shared VFS:"})," All chats ",f.jsx("i",{children:"not"})," in a project share this filesystem."]})]}):e&&t==="conversation"?f.jsxs("div",{className:"flex items-center gap-2 text-xs text-blue-300 bg-blue-900/40 px-2 py-1 rounded mb-1",children:[f.jsx(jB,{className:"h-4 w-4"}),f.jsxs("span",{children:[f.jsx("b",{children:"Project-shared VFS:"})," All chats in this project share this filesystem."]})]}):e&&t==="project"?f.jsxs("div",{className:"flex items-center gap-2 text-xs text-blue-300 bg-blue-900/40 px-2 py-1 rounded mb-1",children:[f.jsx(yh,{className:"h-4 w-4"}),f.jsxs("span",{children:[f.jsx("b",{children:"Project VFS:"})," Filesystem for this project and all its chats."]})]}):null,hUe=({module:e,isOpen:t,onClose:n})=>{const[r,s]=E.useState(e.getSelectedFileIdsCount()),[i,a]=E.useState(null);E.useEffect(()=>{const u=h=>{s(h.selectedFileIds.length)},d=h=>{a(h.itemType)};return Pe.on(dn.selectionChanged,u),Pe.on(Jn.selectedItemChanged,d),()=>{Pe.off(dn.selectionChanged,u),Pe.off(Jn.selectedItemChanged,d)}},[]);const o=ei.getState().vfsKey,l=()=>{const u=ei.getState().selectedFileIds,d=e.getVfsNodes();if(u.size===0){Me.info("No files selected in VFS to attach.");return}let h=0;u.forEach(m=>{const y=d[m];y&&y.type==="file"&&(Pe.emit(Ul.addAttachedFileRequest,{source:"vfs",name:y.name,type:y.mimeType||"application/octet-stream",size:y.size,path:y.path}),h++)}),h>0?(Me.success(`Attached ${h} file(s) from VFS to the next prompt.`),e.clearVfsSelection(),n()):Me.warning("No valid files were selected to attach.")},c=()=>{e.clearVfsSelection(),n()};return f.jsx(op,{open:t,onOpenChange:u=>!u&&c(),children:f.jsxs(lp,{className:"sm:max-w-[90vw] md:max-w-[80vw] lg:max-w-[70vw] w-[90vw] h-[80vh] min-h-[500px] max-h-[90vh] flex flex-col p-0 gap-0",children:[f.jsxs(cp,{className:"p-4 pb-2 border-b flex-shrink-0",children:[f.jsx(up,{children:"Virtual Filesystem"}),f.jsx(eg,{children:"Manage files associated with the current context. Select files to attach them to your next prompt."}),f.jsx(fUe,{vfsKey:o,selectedItemType:i})]}),f.jsx("div",{className:"flex-grow overflow-hidden",children:f.jsx(J6,{})}),f.jsxs(gb,{className:"p-4 pt-2 border-t flex-shrink-0",children:[f.jsx(mt,{variant:"outline",onClick:c,children:"Close"}),f.jsxs(mt,{onClick:l,disabled:r===0,children:[f.jsx(gE,{className:"h-4 w-4 mr-2"}),"Attach Selected (",r,")"]})]})]})})};class pUe{constructor(){de(this,"id","core-vfs");de(this,"modalId","core-vfs-modal-panel");de(this,"unregisterCallbacks",[]);de(this,"eventUnsubscribers",[]);de(this,"modApiRef",null);de(this,"notifyTriggerUpdate",null);de(this,"isModalOpenByManager",!1);de(this,"getEnableVfs",()=>ei.getState().enableVfs);de(this,"getIsVfsModalOpen",()=>this.isModalOpenByManager);de(this,"getSelectedFileIdsCount",()=>ei.getState().selectedFileIds.size);de(this,"toggleVfsModal",()=>{var t,n;this.isModalOpenByManager?(t=this.modApiRef)==null||t.emit(Or.closeModalRequest,{modalId:this.modalId}):(n=this.modApiRef)==null||n.emit(Or.openModalRequest,{modalId:this.modalId})});de(this,"clearVfsSelection",()=>{var t;(t=this.modApiRef)==null||t.emit(dn.clearSelectionRequest,void 0)});de(this,"getVfsNodes",()=>ei.getState().nodes);de(this,"setNotifyTriggerUpdate",t=>{this.notifyTriggerUpdate=t})}async initialize(t){this.modApiRef=t,this.updateVfsKeyBasedOnContext();const n=t.on(Or.contextChanged,()=>{var s;this.updateVfsKeyBasedOnContext(),(s=this.notifyTriggerUpdate)==null||s.call(this)}),r=t.on(Or.modalStateChanged,s=>{var i;if(s.modalId===this.modalId){const a=s.isOpen;this.isModalOpenByManager!==a&&(this.isModalOpenByManager=a,(i=this.notifyTriggerUpdate)==null||i.call(this),a&&this.updateVfsKeyBasedOnContext())}});this.eventUnsubscribers.push(n,r)}updateVfsKeyBasedOnContext(){var i;const{selectedItemId:t,selectedItemType:n}=qn.getState(),r=ei.getState().vfsKey;let s=null;if(this.isModalOpenByManager)if(n==="project")s=t;else if(n==="conversation"){const a=qn.getState().getConversationById(t);s=(a==null?void 0:a.projectId)??"orphan"}else s="orphan";else if(n==="project")s=t;else if(n==="conversation"){const a=qn.getState().getConversationById(t);s=(a==null?void 0:a.projectId)??"orphan"}else s="orphan";r!==s&&(console.log(`[${this.id}] Updating VFS key from "${r}" to "${s}"`),(i=this.modApiRef)==null||i.emit(dn.setVfsKeyRequest,{key:s}))}register(t){if(this.modApiRef=t,this.unregisterCallbacks.length>0){console.warn(`[${this.id}] Already registered. Skipping.`);return}const n=t.registerPromptControl({id:"core-vfs-prompt-trigger",triggerRenderer:()=>Ve.createElement(yze,{module:this})});this.unregisterCallbacks.push(n);const r=t.registerModalProvider(this.modalId,s=>Ve.createElement(hUe,{module:this,...s}));this.unregisterCallbacks.push(r)}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallbacks.forEach(t=>t()),this.unregisterCallbacks=[],this.notifyTriggerUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const mUe=({module:e})=>{const[,t]=E.useState({});E.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const n=e.selectedItemId,r=e.selectedItemType,s=e.syncRepos,i=e.conversationSyncStatus,a=e.isStreaming,[o,l]=E.useState(null),[c,u]=E.useState("idle"),[d,h]=E.useState(!1),[m,y]=E.useState(!1);E.useEffect(()=>{if(r==="conversation"&&n){const T=e.getConversationById(n);l((T==null?void 0:T.syncRepoId)??null),u(i[n]??"idle")}else l(null),u("idle")},[n,r,i,e]);const b=Ve.useMemo(()=>new Map(s.map(T=>[T.id,T.name])),[s]),v=o?b.get(o):void 0,x=E.useCallback(async T=>{if(!n||r!=="conversation")return;h(!0);const R=T==="none"?null:T;await e.linkConversationToRepo(n,R),h(!1)},[n,r,e]),w=E.useCallback(async()=>{!n||!o||(y(!0),await e.syncConversation(n),y(!1))},[n,o,e]),S=xne(c,v),k=!o||m||d||a||c==="syncing";return r==="conversation"&&s.length>0?f.jsxs(sc,{children:[f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(ic,{asChild:!0,children:f.jsx(mt,{variant:o?"secondary":"ghost",size:"icon",className:"h-8 w-8",disabled:a||d||m,"aria-label":"Configure Git Sync",children:c==="syncing"||m||d?f.jsx(Xn,{className:"h-4 w-4 animate-spin"}):f.jsx(Ic,{className:"h-4 w-4"})})})}),f.jsx(Sr,{side:"top",children:o?`Sync Status: ${c}`:"Link to Sync Repo"})]})}),f.jsxs(ac,{className:"w-64 p-4 space-y-3",align:"start",children:[f.jsx(Ot,{htmlFor:"sync-repo-select",className:"text-sm font-medium",children:"Link to Repository"}),f.jsxs(tp,{value:o??"none",onValueChange:x,disabled:d||m||a,children:[f.jsx(rp,{id:"sync-repo-select",className:"w-full h-9",children:f.jsx(np,{placeholder:"Select repository..."})}),f.jsxs(sp,{children:[f.jsx(Ro,{value:"none",children:f.jsx("span",{className:"text-muted-foreground",children:"None"})}),s.map(T=>f.jsx(Ro,{value:T.id,children:T.name},T.id))]})]}),f.jsxs("div",{className:"flex items-center justify-between pt-2",children:[f.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:["Status: ",S||"Not Linked"]}),f.jsxs(mt,{size:"sm",variant:"outline",onClick:w,disabled:k,className:"h-8",children:[m||c==="syncing"?f.jsx(Xn,{className:"h-4 w-4 mr-1 animate-spin"}):f.jsx(UO,{className:"h-4 w-4 mr-1"}),"Sync Now"]})]})]})]}):null},mx=({title:e,description:t,children:n,className:r,titleClassName:s,descriptionClassName:i,contentClassName:a})=>f.jsxs("div",{className:Xe("space-y-2",r),children:[f.jsxs("div",{children:[f.jsx("h3",{className:Xe("text-lg font-medium",s),children:e}),t&&f.jsx("p",{className:Xe("text-sm text-muted-foreground",i),children:t})]}),f.jsx("div",{className:Xe(a),children:n})]}),gUe=Ke({gitUserName:ze().min(1,"User name cannot be empty."),gitUserEmail:ze().email("Invalid email address.")});function Iq({field:e}){return f.jsx(f.Fragment,{children:e.state.meta.isTouched&&e.state.meta.errors.length>0?f.jsx("em",{className:"text-xs text-destructive mt-1 block",children:e.state.meta.errors.map(t=>typeof t=="string"?t:typeof t=="object"&&t!==null&&"message"in t&&typeof t.message=="string"?t.message:(console.warn("FieldMetaMessages encountered an unexpected error object:",t),"Invalid input")).join(", ")}):null})}const yUe=()=>{const{gitUserName:e,setGitUserName:t,gitUserEmail:n,setGitUserEmail:r}=br(yn(i=>({gitUserName:i.gitUserName,setGitUserName:i.setGitUserName,gitUserEmail:i.gitUserEmail,setGitUserEmail:i.setGitUserEmail}))),s=ii({defaultValues:{gitUserName:e??"",gitUserEmail:n??""},validators:{onChange:gUe},onSubmit:async({value:i})=>{try{t(i.gitUserName),r(i.gitUserEmail),Me.success("Git user configuration updated!")}catch(a){Me.error("Failed to update Git configuration."),console.error("Error submitting Git config form:",a)}}});return E.useEffect(()=>{s.reset({gitUserName:e??"",gitUserEmail:n??""})},[e,n,s]),f.jsx("div",{className:"space-y-4 p-1",children:f.jsx(mx,{title:"Git User Configuration",description:"Set your user name and email for Git commits made within the VFS. This is required for committing changes.",contentClassName:"rounded-lg border p-3 shadow-sm bg-card",children:f.jsxs("form",{onSubmit:i=>{i.preventDefault(),i.stopPropagation(),s.handleSubmit()},className:"space-y-3",children:[f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[f.jsx(s.Field,{name:"gitUserName",children:i=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(Ot,{htmlFor:i.name,children:"Git User Name"}),f.jsx(Cn,{id:i.name,value:i.state.value,onBlur:i.handleBlur,onChange:a=>i.handleChange(a.target.value),placeholder:"Your Name",className:i.state.meta.errors.length?"border-destructive":""}),f.jsx(Iq,{field:i})]})}),f.jsx(s.Field,{name:"gitUserEmail",children:i=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(Ot,{htmlFor:i.name,children:"Git User Email"}),f.jsx(Cn,{id:i.name,type:"email",value:i.state.value,onBlur:i.handleBlur,onChange:a=>i.handleChange(a.target.value),placeholder:"your.email@example.com",className:i.state.meta.errors.length?"border-destructive":""}),f.jsx(Iq,{field:i})]})})]}),f.jsx("div",{className:"flex justify-end pt-2",children:f.jsx(s.Subscribe,{selector:i=>[i.canSubmit,i.isSubmitting,i.isValidating,i.isValid],children:([i,a,o,l])=>f.jsx(mt,{type:"submit",size:"sm",disabled:!i||a||o||!l,children:a?"Saving...":o?"Validating...":"Save Git Config"})})})]})})})},bUe=Ve.memo(yUe),vUe=LO("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function Ese({className:e,variant:t,...n}){return f.jsx("div",{"data-slot":"alert",role:"alert",className:Xe(vUe({variant:t}),e),...n})}function Tse({className:e,...t}){return f.jsx("div",{"data-slot":"alert-title",className:Xe("col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight",e),...t})}function Ase({className:e,...t}){return f.jsx("div",{"data-slot":"alert-description",className:Xe("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",e),...t})}var xUe="Separator",jq="horizontal",wUe=["horizontal","vertical"],Rse=E.forwardRef((e,t)=>{const{decorative:n,orientation:r=jq,...s}=e,i=_Ue(r)?r:jq,o=n?{role:"none"}:{"aria-orientation":i==="vertical"?i:void 0,role:"separator"};return f.jsx(lr.div,{"data-orientation":i,...o,...s,ref:t})});Rse.displayName=xUe;function _Ue(e){return wUe.includes(e)}var SUe=Rse;function jm({className:e,orientation:t="horizontal",decorative:n=!0,...r}){return f.jsx(SUe,{"data-slot":"separator-root",decorative:n,orientation:t,className:Xe("bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px",e),...r})}const CUe=({onSyncAll:e,onSyncPending:t,onInitializeRepos:n,onAbortSync:r,isRunning:s=!1,totalRepos:i,totalConversations:a,pendingConversations:o})=>{const[l,c]=E.useState(null),[u,d]=E.useState(!1);E.useEffect(()=>{const S=R=>{R&&R.progress&&(c(R.progress),d(!0))},k=R=>{R&&R.progress&&c(R.progress)},C=R=>{R&&R.progress&&(c(R.progress),setTimeout(()=>{c(null),d(!1)},2e3))},T=R=>{R&&R.progress&&(c(R.progress),setTimeout(()=>{c(null),d(!1)},5e3))};return Pe.on(ds.bulkSyncStarted,S),Pe.on(ds.bulkSyncProgress,k),Pe.on(ds.bulkSyncCompleted,C),Pe.on(ds.bulkSyncFailed,T),()=>{Pe.off(ds.bulkSyncStarted,S),Pe.off(ds.bulkSyncProgress,k),Pe.off(ds.bulkSyncCompleted,C),Pe.off(ds.bulkSyncFailed,T)}},[]);const h=s||u,m=l?l.completedRepos/Math.max(l.totalRepos,1)*100:0,y=l?l.completedConversations/Math.max(l.totalConversations,1)*100:0,b=async()=>{d(!0);try{await e()}catch(S){console.error("Sync all failed:",S),d(!1)}},v=async()=>{d(!0);try{await t()}catch(S){console.error("Sync pending failed:",S),d(!1)}},x=async()=>{d(!0);try{await n()}catch(S){console.error("Initialize repos failed:",S),d(!1)}},w=async()=>{try{await r()}catch(S){console.error("Abort sync failed:",S)}};return f.jsxs(dl,{className:"w-full",children:[f.jsxs(fl,{className:"pb-3",children:[f.jsxs(hl,{className:"flex items-center gap-2",children:[f.jsx(Ic,{className:"h-5 w-5"}),"Bulk Git Sync"]}),f.jsx(zd,{children:"Manage synchronization across all repositories and conversations"})]}),f.jsxs(pl,{className:"space-y-4",children:[f.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"font-medium text-lg",children:i}),f.jsx("div",{className:"text-muted-foreground",children:"Repositories"})]}),f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"font-medium text-lg",children:a}),f.jsx("div",{className:"text-muted-foreground",children:"Total Conversations"})]}),f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:Xe("font-medium text-lg",o>0?"text-orange-600":"text-green-600"),children:o}),f.jsx("div",{className:"text-muted-foreground",children:"Pending Sync"})]})]}),f.jsx(jm,{}),l&&f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{className:"flex items-center justify-between text-sm",children:[f.jsx("span",{className:"font-medium",children:"Current Operation"}),f.jsx(is,{variant:l.errors.length>0?"destructive":"default",children:l.errors.length>0?"Errors":"Running"})]}),f.jsx("div",{className:"text-sm text-muted-foreground bg-muted p-2 rounded",children:l.currentOperation}),l.totalRepos>0&&f.jsxs("div",{className:"space-y-2",children:[f.jsxs("div",{className:"flex justify-between text-sm",children:[f.jsx("span",{children:"Repository Progress"}),f.jsxs("span",{children:[l.completedRepos,"/",l.totalRepos]})]}),f.jsx(ky,{value:m,className:"h-2"})]}),l.totalConversations>0&&f.jsxs("div",{className:"space-y-2",children:[f.jsxs("div",{className:"flex justify-between text-sm",children:[f.jsx("span",{children:"Conversation Progress"}),f.jsxs("span",{children:[l.completedConversations,"/",l.totalConversations]})]}),f.jsx(ky,{value:y,className:"h-2"})]}),l.errors.length>0&&f.jsxs("div",{className:"mt-2",children:[f.jsxs("div",{className:"flex items-center gap-2 text-sm text-destructive mb-2",children:[f.jsx(Kl,{className:"h-4 w-4"}),l.errors.length," Error",l.errors.length!==1?"s":""]}),f.jsxs("div",{className:"max-h-24 overflow-y-auto space-y-1",children:[l.errors.slice(0,5).map((S,k)=>f.jsxs("div",{className:"text-xs text-muted-foreground bg-destructive/10 p-2 rounded",children:[f.jsxs("span",{className:"font-medium",children:[S.type,":"]})," ",S.error]},k)),l.errors.length>5&&f.jsxs("div",{className:"text-xs text-muted-foreground",children:["...and ",l.errors.length-5," more errors"]})]})]})]}),f.jsx(jm,{}),f.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[f.jsx(xr,{children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsxs(mt,{onClick:x,disabled:h||i===0,variant:"outline",size:"sm",className:"w-full",children:[f.jsx(Ec,{className:"h-4 w-4 mr-1"}),"Clone Repos"]})}),f.jsx(Sr,{children:"Initialize/clone all configured repositories"})]})}),f.jsx(xr,{children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsxs(mt,{onClick:v,disabled:h||o===0,variant:"outline",size:"sm",className:"w-full",children:[f.jsx(EH,{className:"h-4 w-4 mr-1"}),"Sync Pending"]})}),f.jsx(Sr,{children:"Sync only conversations that need syncing"})]})}),f.jsx(xr,{children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsxs(mt,{onClick:b,disabled:h||i===0&&a===0,size:"sm",className:"w-full",children:[f.jsx(vm,{className:Xe("h-4 w-4 mr-1",h&&"animate-spin")}),"Sync All"]})}),f.jsx(Sr,{children:"Sync all repositories and conversations"})]})}),f.jsxs(mt,{onClick:w,disabled:!h,variant:"destructive",size:"sm",className:"w-full",children:[f.jsx(zpe,{className:"h-4 w-4 mr-1"}),"Stop"]})]})]})]})},kUe=Ke({name:ze().min(1,"Repository Name is required."),remoteUrl:ze().min(1,"Remote URL is required.").url("Invalid URL format (e.g., https://github.com/user/repo.git)"),branch:ze().min(1,"Branch name is required (e.g., main)."),username:ze().nullable().optional(),password:ze().nullable().optional()}),f2={name:"",remoteUrl:"",branch:"main",username:null,password:null},EUe=()=>{const{syncRepos:e,addSyncRepo:t,updateSyncRepo:n,repoInitializationStatus:r,isLoading:s}=qn(yn(k=>({syncRepos:k.syncRepos,addSyncRepo:k.addSyncRepo,updateSyncRepo:k.updateSyncRepo,repoInitializationStatus:k.repoInitializationStatus,isLoading:k.isLoading}))),{autoSyncOnStreamComplete:i,setAutoSyncOnStreamComplete:a}=br(yn(k=>({autoSyncOnStreamComplete:k.autoSyncOnStreamComplete,setAutoSyncOnStreamComplete:k.setAutoSyncOnStreamComplete}))),[o,l]=E.useState(!1),[c,u]=E.useState(null),[d,h]=E.useState({});E.useEffect(()=>{const k=C=>{C&&C.action==="deleted"&&C.repoId&&h(T=>({...T,[C.repoId]:!1}))};return Pe.on(ds.repoChanged,k),()=>Pe.off(ds.repoChanged,k)},[]);const m=ii({defaultValues:f2,validators:{onChangeAsync:kUe,onChangeAsyncDebounceMs:500},onSubmit:async({value:k})=>{var C,T,R,N;if(!((C=k.name)!=null&&C.trim())||!((T=k.remoteUrl)!=null&&T.trim())){Me.error("Repository Name and Remote URL are required.");return}try{const I={name:k.name.trim(),remoteUrl:k.remoteUrl.trim(),branch:((R=k.branch)==null?void 0:R.trim())||"main",username:((N=k.username)==null?void 0:N.trim())||null,password:k.password||null};c?await n(c,I):await t(I),y()}catch(I){console.error("Failed to save sync repo:",I)}}}),y=E.useCallback(()=>{m.reset(f2),l(!1),u(null)},[m]);E.useEffect(()=>{if(c){const k=e.find(C=>C.id===c);k?(m.reset({name:k.name,remoteUrl:k.remoteUrl,branch:k.branch||"main",username:k.username??null,password:k.password??null}),l(!1)):y()}else o||m.reset(f2)},[c,e,m,o,y]);const b=k=>{u(k.id),l(!1)},v=E.useCallback((k,C)=>{if(window.confirm(`Are you sure you want to delete the sync repository "${C}"? This will unlink it from any conversations and remove the local copy.`)){h(T=>({...T,[k]:!0}));try{Pe.emit(Jn.deleteSyncRepoRequest,{id:k}),c===k&&y()}catch(T){console.error("Failed to delete sync repo:",T),h(R=>({...R,[k]:!1}))}}},[c,y]),x=E.useCallback(k=>{Pe.emit(Jn.initializeOrSyncRepoRequest,{repoId:k})},[]),w=()=>{u(null),m.reset(f2),l(!0)},S=()=>f.jsxs("form",{onSubmit:k=>{k.preventDefault(),k.stopPropagation(),m.handleSubmit()},className:"border rounded-md p-4 space-y-3 bg-card shadow-md mb-4",children:[f.jsx("h4",{className:"font-semibold text-card-foreground",children:c?"Edit Sync Repository":"Add New Sync Repository"}),f.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[f.jsx(m.Field,{name:"name",children:k=>f.jsxs("div",{className:"sm:col-span-1 space-y-1.5",children:[f.jsx(Ot,{htmlFor:k.name,children:"Name"}),f.jsx(Cn,{id:k.name,value:k.state.value??"",onChange:C=>k.handleChange(C.target.value),onBlur:k.handleBlur,placeholder:"e.g., My Backup",disabled:m.state.isSubmitting}),f.jsx(ji,{field:k})]})}),f.jsx(m.Field,{name:"remoteUrl",children:k=>f.jsxs("div",{className:"sm:col-span-2 space-y-1.5",children:[f.jsx(Ot,{htmlFor:k.name,children:"Remote URL (HTTPS)"}),f.jsx(Cn,{id:k.name,type:"url",value:k.state.value??"",onChange:C=>k.handleChange(C.target.value),onBlur:k.handleBlur,placeholder:"https://github.com/user/repo.git",disabled:m.state.isSubmitting}),f.jsx(ji,{field:k})]})}),f.jsx(m.Field,{name:"branch",children:k=>f.jsxs("div",{className:"sm:col-span-1 space-y-1.5",children:[f.jsx(Ot,{htmlFor:k.name,children:"Branch"}),f.jsx(Cn,{id:k.name,value:k.state.value??"",onChange:C=>k.handleChange(C.target.value),onBlur:k.handleBlur,placeholder:"main",disabled:m.state.isSubmitting}),f.jsx(ji,{field:k})]})})]}),f.jsxs("div",{className:"pt-2",children:[f.jsx(Ot,{className:"text-sm font-medium",children:"Authentication (Optional - Basic Auth/Token)"}),f.jsxs(Ese,{variant:"destructive",className:"mt-2 mb-3",children:[f.jsx(HO,{className:"h-4 w-4"}),f.jsx(Tse,{children:"Security Warning"}),f.jsx(Ase,{className:"text-xs",children:"Storing credentials directly is insecure. Use a Personal Access Token (PAT) as the password if possible. Credentials are required only for private repositories."})]}),f.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[f.jsx(m.Field,{name:"username",children:k=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(Ot,{htmlFor:k.name,children:"Username"}),f.jsx(Cn,{id:k.name,value:k.state.value??"",onChange:C=>k.handleChange(C.target.value),onBlur:k.handleBlur,placeholder:"Git Username (Optional)",disabled:m.state.isSubmitting,autoComplete:"off"}),f.jsx(ji,{field:k})]})}),f.jsx(m.Field,{name:"password",children:k=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(Ot,{htmlFor:k.name,children:"Password / Token"}),f.jsx(Cn,{id:k.name,type:"password",value:k.state.value??"",onChange:C=>k.handleChange(C.target.value),onBlur:k.handleBlur,placeholder:"Password or PAT (Optional)",disabled:m.state.isSubmitting,autoComplete:"new-password"}),f.jsx(ji,{field:k})]})})]})]}),f.jsxs("div",{className:"flex justify-end space-x-2 pt-2",children:[f.jsxs(mt,{variant:"ghost",size:"sm",onClick:y,disabled:m.state.isSubmitting,type:"button",children:[f.jsx(Oi,{className:"h-4 w-4 mr-1"})," Cancel"]}),f.jsx(m.Subscribe,{selector:k=>[k.canSubmit,k.isSubmitting,k.isValidating,k.isValid],children:([k,C,T,R])=>f.jsxs(mt,{variant:"secondary",size:"sm",type:"submit",disabled:C||!k||!R||T,children:[(C||T)&&f.jsx(Xn,{className:"h-4 w-4 mr-1 animate-spin"}),f.jsx($u,{className:"h-4 w-4 mr-1"})," ",C||T?"Saving...":"Save Repository"]})})]})]});return f.jsxs("div",{className:"space-y-6 p-1",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"text-lg font-medium",children:"Sync Repositories"}),f.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Configure remote Git repositories to synchronize conversations. Link conversations to a repo using the sync control in the chat input area. Use the 'Sync/Clone' button to initialize the local copy or pull updates."}),f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg bg-card",children:[f.jsxs("div",{className:"space-y-1",children:[f.jsx(Ot,{htmlFor:"auto-sync-toggle",className:"text-sm font-medium",children:"Auto-sync after stream completion"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Automatically sync conversations with linked repositories when a message stream completes"})]}),f.jsx(Oo,{id:"auto-sync-toggle",checked:i,onCheckedChange:a})]}),f.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg bg-card",children:[f.jsxs("div",{className:"space-y-1",children:[f.jsx(Ot,{htmlFor:"auto-init-repos-toggle",className:"text-sm font-medium",children:"Auto-initialize repositories on startup"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Automatically clone/initialize configured repositories when the app starts (off by default)"})]}),f.jsx(Oo,{id:"auto-init-repos-toggle",checked:br(k=>k.autoInitializeReposOnStartup),onCheckedChange:br.getState().setAutoInitializeReposOnStartup})]})]}),e.length>0&&f.jsx(CUe,{onSyncAll:async()=>{await qn.getState().syncAllConversations()},onSyncPending:async()=>{await qn.getState().syncPendingConversations()},onInitializeRepos:async()=>{await qn.getState().initializeAllRepositories()},onAbortSync:async()=>{const{BulkSyncService:k}=await Zr(async()=>{const{BulkSyncService:C}=await Promise.resolve().then(()=>L0);return{BulkSyncService:C}},void 0);k.abort()},totalRepos:e.length,totalConversations:qn.getState().conversations.filter(k=>k.syncRepoId).length,pendingConversations:qn.getState().conversations.filter(k=>{const C=qn.getState().conversationSyncStatus[k.id];return k.syncRepoId&&C==="needs-sync"}).length})]}),!o&&!c&&f.jsxs(mt,{onClick:w,variant:"outline",className:"w-full mb-4",disabled:s,children:[f.jsx(jc,{className:"h-4 w-4 mr-1"})," Add Sync Repository"]}),(o||c)&&S(),f.jsxs("div",{children:[f.jsx("h4",{className:"text-md font-medium mb-2",children:"Configured Repositories"}),s&&!o&&!c?f.jsxs("div",{className:"space-y-2",children:[f.jsx(Wr,{className:"h-10 w-full"}),f.jsx(Wr,{className:"h-10 w-full"}),f.jsx(Wr,{className:"h-10 w-full"})]}):e.length===0&&!o&&!c?f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No sync repositories configured yet."}):f.jsx("div",{className:"border rounded-md overflow-x-auto",children:f.jsxs(lf,{children:[f.jsx(dp,{children:f.jsxs(Ts,{children:[f.jsx(Ar,{children:"Name"}),f.jsx(Ar,{className:"hidden md:table-cell",children:"Remote URL"}),f.jsx(Ar,{className:"hidden lg:table-cell",children:"Branch"}),f.jsx(Ar,{className:"hidden lg:table-cell",children:"Auth"}),f.jsx(Ar,{className:"text-right",children:"Actions"})]})}),f.jsx(cf,{children:e.map(k=>{const C=d[k.id],T=c===k.id,R=!!k.username||!!k.password,N=r[k.id]||"idle",I=N==="syncing",P=C||m.state.isSubmitting||!!c||I;let B=null,D="Initialize/Sync Repository";return N==="syncing"?(B=f.jsx(Xn,{className:"h-4 w-4 animate-spin mr-1"}),D="Initializing/Syncing..."):N==="idle"?(B=f.jsx(hE,{className:"h-4 w-4 text-green-500 mr-1"}),D="Sync Successful / Ready"):N==="error"?(B=f.jsx(Kl,{className:"h-4 w-4 text-destructive mr-1"}),D="Sync Failed"):B=f.jsx(vm,{className:"h-4 w-4 mr-1"}),f.jsxs(Ts,{className:Xe(T?"bg-muted/50":"",P&&!T?"opacity-70":""),children:[f.jsx(Fn,{className:"font-medium truncate max-w-[100px] sm:max-w-xs",children:k.name}),f.jsx(Fn,{className:"text-xs truncate max-w-[100px] sm:max-w-xs hidden md:table-cell",children:k.remoteUrl}),f.jsx(Fn,{className:"hidden lg:table-cell",children:k.branch||"main"}),f.jsx(Fn,{className:"text-xs hidden lg:table-cell",children:R?"Configured":"None"}),f.jsxs(Fn,{className:"text-right space-x-1",children:[f.jsx(Un,{tooltipText:D,onClick:()=>x(k.id),"aria-label":`Initialize or Sync repo ${k.name}`,disabled:P,icon:B,variant:"outline",className:"h-8 w-8"}),f.jsx(Un,{tooltipText:"Edit",onClick:()=>b(k),"aria-label":`Edit repo ${k.name}`,disabled:P,icon:f.jsx(p1,{}),className:"h-8 w-8"}),f.jsx(Un,{tooltipText:"Delete",onClick:()=>v(k.id,k.name),"aria-label":`Delete repo ${k.name}`,disabled:P,icon:C?f.jsx(Xn,{className:"h-4 w-4 animate-spin"}):f.jsx(Mo,{}),className:"text-destructive hover:text-destructive/80 h-8 w-8"})]})]},k.id)})})]})})]})]})},TUe=Ve.memo(EUe),AUe=()=>{const e=E.useMemo(()=>[{value:"config",label:"User Config",content:f.jsx(bUe,{})},{value:"sync",label:"Sync Repositories",content:f.jsx(TUe,{})}],[]);return f.jsx(oc,{tabs:e,defaultValue:"config",className:"h-full",listClassName:"bg-muted/50 rounded-md",contentContainerClassName:"mt-4"})},RUe=Ve.memo(AUe);class NUe{constructor(){de(this,"id","core-git-sync");de(this,"unregisterPromptControlCallback",null);de(this,"unregisterSettingsTabCallback",null);de(this,"eventUnsubscribers",[]);de(this,"modApiRef",null);de(this,"selectedItemId",null);de(this,"selectedItemType",null);de(this,"syncRepos",[]);de(this,"conversationSyncStatus",{});de(this,"isStreaming",!1);de(this,"autoSyncEnabled",!1);de(this,"isBulkSyncing",!1);de(this,"bulkSyncProgress",null);de(this,"notifyComponentUpdate",null);de(this,"linkConversationToRepo",(t,n)=>{var r;(r=this.modApiRef)==null||r.emit(Jn.linkConversationToRepoRequest,{conversationId:t,repoId:n})});de(this,"syncConversation",t=>{var n;(n=this.modApiRef)==null||n.emit(Jn.syncConversationRequest,{conversationId:t})});de(this,"getConversationById",t=>qn.getState().getConversationById(t));de(this,"syncAllConversations",async()=>{await qn.getState().syncAllConversations()});de(this,"syncPendingConversations",async()=>{await qn.getState().syncPendingConversations()});de(this,"initializeAllRepositories",async()=>{await qn.getState().initializeAllRepositories()});de(this,"abortBulkSync",async()=>{const{BulkSyncService:t}=await Zr(async()=>{const{BulkSyncService:n}=await Promise.resolve().then(()=>L0);return{BulkSyncService:n}},void 0);t.abort()});de(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){this.modApiRef=t,this.loadInitialState();const n=t.on(Or.contextChanged,m=>{var y;this.selectedItemId=m.selectedItemId,this.selectedItemType=m.selectedItemType,(y=this.notifyComponentUpdate)==null||y.call(this)}),r=t.on(ds.repoChanged,()=>{var m;this.syncRepos=qn.getState().syncRepos,(m=this.notifyComponentUpdate)==null||m.call(this)}),s=t.on(Jn.conversationSyncStatusChanged,m=>{var y;typeof m=="object"&&m&&"conversationId"in m&&"status"in m&&(this.conversationSyncStatus={...this.conversationSyncStatus,[m.conversationId]:m.status},(y=this.notifyComponentUpdate)==null||y.call(this))}),i=t.on(Zn.statusChanged,m=>{var y;typeof m=="object"&&m&&"status"in m&&(this.isStreaming=m.status==="streaming",(y=this.notifyComponentUpdate)==null||y.call(this))}),a=t.on(Zn.completed,async m=>{typeof m=="object"&&m&&"interactionId"in m&&"status"in m&&m.status==="COMPLETED"&&this.autoSyncEnabled&&await this.handleAutoSync()}),o=t.on(sn.autoSyncOnStreamCompleteChanged,m=>{var y;typeof m=="object"&&m&&"enabled"in m&&(this.autoSyncEnabled=m.enabled,(y=this.notifyComponentUpdate)==null||y.call(this))}),l=t.on(ds.bulkSyncStarted,m=>{var y;typeof m=="object"&&m&&"progress"in m&&(this.isBulkSyncing=!0,this.bulkSyncProgress=m.progress,(y=this.notifyComponentUpdate)==null||y.call(this))}),c=t.on(ds.bulkSyncProgress,m=>{var y;typeof m=="object"&&m&&"progress"in m&&(this.bulkSyncProgress=m.progress,(y=this.notifyComponentUpdate)==null||y.call(this))}),u=t.on(ds.bulkSyncCompleted,m=>{var y;typeof m=="object"&&m&&"progress"in m&&(this.isBulkSyncing=!1,this.bulkSyncProgress=null,(y=this.notifyComponentUpdate)==null||y.call(this))}),d=t.on(ds.bulkSyncFailed,m=>{var y;typeof m=="object"&&m&&"progress"in m&&(this.isBulkSyncing=!1,this.bulkSyncProgress=null,(y=this.notifyComponentUpdate)==null||y.call(this))}),h=t.on(Jn.conversationUpdated,m=>{var y;typeof m=="object"&&m&&"conversationId"in m&&"updates"in m&&m.conversationId===this.selectedItemId&&m.updates.syncRepoId!==void 0&&(this.loadInitialState(),(y=this.notifyComponentUpdate)==null||y.call(this))});this.eventUnsubscribers.push(n,r,s,i,a,o,l,c,u,d,h)}loadInitialState(){const t=qn.getState();this.selectedItemId=t.selectedItemId,this.selectedItemType=t.selectedItemType,this.syncRepos=t.syncRepos,this.conversationSyncStatus=t.conversationSyncStatus,this.isStreaming=vn.getState().status==="streaming",this.autoSyncEnabled=br.getState().autoSyncOnStreamComplete}async handleAutoSync(){if(!this.selectedItemId||this.selectedItemType!=="conversation")return;const t=this.getConversationById(this.selectedItemId);if(!(t!=null&&t.syncRepoId))return;const n=this.conversationSyncStatus[this.selectedItemId];if(!(n==="syncing"||n==="idle")){console.log(`[GitSyncControlModule] Auto-syncing conversation ${this.selectedItemId}`);try{await this.syncConversation(this.selectedItemId)}catch(r){console.error("[GitSyncControlModule] Auto-sync failed:",r)}}}register(t){this.modApiRef=t,this.unregisterPromptControlCallback||(this.unregisterPromptControlCallback=t.registerPromptControl({id:this.id,triggerRenderer:()=>Ve.createElement(mUe,{module:this})})),this.unregisterSettingsTabCallback||(this.unregisterSettingsTabCallback=t.registerSettingsTab({id:"git",title:"Git",component:RUe,order:60}))}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterPromptControlCallback&&(this.unregisterPromptControlCallback(),this.unregisterPromptControlCallback=null),this.unregisterSettingsTabCallback&&(this.unregisterSettingsTabCallback(),this.unregisterSettingsTabCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const MUe=({module:e})=>{const[,t]=E.useState({});E.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const{syncRepos:n,repoInitializationStatus:r}=qn(yn(c=>({syncRepos:c.syncRepos,repoInitializationStatus:c.repoInitializationStatus}))),s=()=>{e.syncAllRepos()},i=c=>{e.syncRepo(c)},a=e.isSyncing,o=n.length>0,l=Object.values(r).some(c=>c==="syncing");return f.jsx(xr,{delayDuration:100,children:f.jsxs(sc,{children:[f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(ic,{asChild:!0,children:f.jsx(mt,{variant:"ghost",size:"icon",className:"h-8 w-8",disabled:!o,"aria-label":"Manual Git Sync",children:a||l?f.jsx(Xn,{className:"h-4 w-4 animate-spin"}):f.jsx(Ic,{className:"h-4 w-4"})})})}),f.jsx(Sr,{side:"top",children:o?"Manual Git Sync":"No sync repositories configured"})]}),f.jsx(ac,{className:"w-80 p-4",align:"start",children:f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("h4",{className:"font-semibold text-sm",children:"Git Sync Repositories"}),f.jsxs(mt,{variant:"outline",size:"sm",onClick:s,disabled:!o||a||l,className:"h-8",children:[a||l?f.jsx(Xn,{className:"h-3 w-3 mr-1 animate-spin"}):f.jsx(vm,{className:"h-3 w-3 mr-1"}),"Sync All"]})]}),o?f.jsx("div",{className:"space-y-2",children:n.map(c=>{const u=r[c.id]||"idle",d=u==="syncing";return f.jsxs("div",{className:Xe("flex items-center justify-between p-3 border rounded-lg","bg-card hover:bg-muted/50 transition-colors"),children:[f.jsxs("div",{className:"min-w-0 flex-1",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("span",{className:"text-sm font-medium truncate",children:c.name}),f.jsx(is,{variant:u==="idle"?"secondary":u==="syncing"?"default":u==="error"?"destructive":"outline",className:"text-xs",children:u==="idle"?"Ready":u==="syncing"?"Syncing":u==="error"?"Error":"Unknown"})]}),f.jsx("p",{className:"text-xs text-muted-foreground truncate",children:c.branch||"main"})]}),f.jsx(mt,{variant:"ghost",size:"sm",onClick:()=>i(c.id),disabled:d||a,className:"h-8 w-8 p-0",children:d?f.jsx(Xn,{className:"h-3 w-3 animate-spin"}):f.jsx(vm,{className:"h-3 w-3"})})]},c.id)})}):f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No sync repositories configured. Go to Settings  Git  Sync Repositories to add one."})]})})]})})};class IUe{constructor(){de(this,"id","core-manual-git-sync-sidebar");de(this,"unregisterCallback",null);de(this,"eventUnsubscribers",[]);de(this,"modApiRef",null);de(this,"syncRepos",[]);de(this,"repoInitializationStatus",{});de(this,"isSyncing",!1);de(this,"notifyComponentUpdate",null);de(this,"syncAllRepos",async()=>{var t,n;if(!(this.isSyncing||this.syncRepos.length===0)){this.isSyncing=!0,(t=this.notifyComponentUpdate)==null||t.call(this);try{console.log("[ManualSyncSidebarControlModule] Starting bulk sync for all repositories and conversations");const{BulkSyncService:r}=await Zr(async()=>{const{BulkSyncService:s}=await Promise.resolve().then(()=>L0);return{BulkSyncService:s}},void 0);await r.syncAll({syncRepos:!0,syncConversations:!0,continueOnError:!0,maxConcurrent:3}),console.log("[ManualSyncSidebarControlModule] Completed bulk sync")}catch(r){console.error("[ManualSyncSidebarControlModule] Error in bulk sync:",r)}finally{this.isSyncing=!1,(n=this.notifyComponentUpdate)==null||n.call(this)}}});de(this,"syncRepo",async t=>{var r;const n=this.syncRepos.find(s=>s.id===t);if(!n){console.warn(`[ManualSyncSidebarControlModule] Repository ${t} not found`);return}console.log(`[ManualSyncSidebarControlModule] Starting sync for repository: ${n.name}`),(r=this.modApiRef)==null||r.emit(Jn.initializeOrSyncRepoRequest,{repoId:t})});de(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){this.modApiRef=t,this.loadInitialState();const n=t.on(ds.repoChanged,()=>{var i;this.syncRepos=qn.getState().syncRepos,(i=this.notifyComponentUpdate)==null||i.call(this)}),r=t.on(ds.repoInitStatusChanged,i=>{var a;typeof i=="object"&&i&&"repoId"in i&&"status"in i&&(this.repoInitializationStatus={...this.repoInitializationStatus,[i.repoId]:i.status},(a=this.notifyComponentUpdate)==null||a.call(this))}),s=t.on(Jn.syncReposLoaded,()=>{var i;this.loadInitialState(),(i=this.notifyComponentUpdate)==null||i.call(this)});this.eventUnsubscribers.push(n,r,s)}loadInitialState(){const t=qn.getState();this.syncRepos=t.syncRepos,this.repoInitializationStatus=t.repoInitializationStatus}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}const n=()=>Ve.createElement(MUe,{module:this});this.unregisterCallback=t.registerChatControl({id:this.id,panel:"sidebar-footer",status:()=>"ready",renderer:n,iconRenderer:n,show:()=>!0})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const jUe=Ke({path:ze().optional().describe("The directory path to list within the VFS. Defaults to the current directory if omitted.")}),OUe=Ke({path:ze().describe("The path of the file to read within the VFS."),encoding:xl(["utf-8","base64"]).optional().default("utf-8").describe("Encoding for reading the file (utf-8 or base64).")}),PUe=Ke({path:ze().describe("The path where the file should be written."),content:ze().describe("The content to write to the file."),encoding:xl(["utf-8","base64"]).optional().default("utf-8").describe("Encoding of the provided content (utf-8 or base64).")}),DUe=Ke({path:ze().describe("The path of the file or directory to delete."),recursive:Kn().optional().default(!1).describe("Whether to delete directories recursively.")}),FUe=Ke({path:ze().describe("The path of the directory to create (including parents).")}),LUe=Ke({oldPath:ze().describe("The current path of the item to rename."),newName:ze().describe("The new name for the item.")});class BUe{constructor(){de(this,"id","core-vfs-tools");de(this,"unregisterCallbacks",[])}async initialize(t){console.log(`[${this.id}] Initialized.`)}register(t){if(this.unregisterCallbacks.length>0){console.warn(`[${this.id}] Already registered. Skipping.`);return}console.log(`[${this.id}] Registering Core VFS Tools...`);const n={description:"List files and directories in a specified VFS path, or the current path if none is given.",parameters:jUe};this.unregisterCallbacks.push(t.registerTool("vfsListFiles",n,async({path:l},c)=>{const u=c==null?void 0:c.fsInstance;if(!u)return{success:!1,error:"Filesystem instance not available in context."};const d=zr(l||"/");try{const h=await vD(d,{fsInstance:u});return{success:!0,path:d,entries:h.map(m=>({name:m.name,type:m.isDirectory?"folder":"file",size:m.size,lastModified:m.lastModified.toISOString()}))}}catch(h){return{success:!1,path:d,error:h.message}}}));const r={description:"Read the content of a file from the VFS.",parameters:OUe};this.unregisterCallbacks.push(t.registerTool("vfsReadFile",r,async({path:l,encoding:c},u)=>{const d=u==null?void 0:u.fsInstance;if(!d)return{success:!1,error:"Filesystem instance not available in context."};const h=zr(l);try{const m=await Zh(h,{fsInstance:d});let y;return c==="base64"?y=btoa(String.fromCharCode(...m)):y=new TextDecoder().decode(m),{success:!0,path:h,content:y,encoding:c}}catch(m){return{success:!1,path:h,error:m.message}}}));const s={description:"Write content to a file in the VFS.",parameters:PUe};this.unregisterCallbacks.push(t.registerTool("vfsWriteFile",s,async({path:l,content:c,encoding:u},d)=>{const h=d==null?void 0:d.fsInstance;if(!h)return{success:!1,error:"Filesystem instance not available in context."};const m=zr(l);try{let y;if(u==="base64"){const b=atob(c),v=b.length,x=new Uint8Array(v);for(let w=0;w<v;w++)x[w]=b.charCodeAt(w);y=x}else y=c;return await lT(m,y,{fsInstance:h}),{success:!0,path:m}}catch(y){return{success:!1,path:m,error:y.message}}}));const i={description:"Delete a file or directory from the VFS.",parameters:DUe};this.unregisterCallbacks.push(t.registerTool("vfsDelete",i,async({path:l,recursive:c},u)=>{const d=u==null?void 0:u.fsInstance;if(!d)return{success:!1,error:"Filesystem instance not available in context."};const h=zr(l);try{return await xD(h,c,{fsInstance:d}),{success:!0,path:h}}catch(m){return{success:!1,path:h,error:m.message}}}));const a={description:"Create a directory (including parents) in the VFS.",parameters:FUe};this.unregisterCallbacks.push(t.registerTool("vfsCreateDirectory",a,async({path:l},c)=>{const u=c==null?void 0:c.fsInstance;if(!u)return{success:!1,error:"Filesystem instance not available in context."};const d=zr(l);try{return await EZ(d,{fsInstance:u}),{success:!0,path:d}}catch(h){return{success:!1,path:d,error:h.message}}}));const o={description:"Rename a file or directory in the VFS.",parameters:LUe};this.unregisterCallbacks.push(t.registerTool("vfsRename",o,async({oldPath:l,newName:c},u)=>{const d=u==null?void 0:u.fsInstance;if(!d)return{success:!1,error:"Filesystem instance not available in context."};const h=zr(l),m=zr(h.substring(0,h.lastIndexOf("/"))||"/"),y=Du(m,c);try{return await AZ(h,y,{fsInstance:d}),{success:!0,oldPath:h,newPath:y}}catch(b){return{success:!1,oldPath:h,newName:c,error:b.message}}})),console.log(`[${this.id}] Core VFS Tools Registered.`)}destroy(){this.unregisterCallbacks.forEach(t=>t()),this.unregisterCallbacks=[],console.log(`[${this.id}] Destroyed.`)}}const $Ue=Ke({path:ze().describe("The directory path within the VFS to initialize as a Git repository.")}),zUe=Ke({path:ze().describe("The directory path of the Git repository within the VFS to commit."),message:ze().describe("The commit message.")}),UUe=Ke({path:ze().describe("The directory path of the Git repository within the VFS to pull from."),branch:ze().optional().describe("The branch name to pull.")}),qUe=Ke({path:ze().describe("The directory path of the Git repository within the VFS to push."),branch:ze().optional().describe("The branch name to push.")}),VUe=Ke({path:ze().describe("The directory path of the Git repository within the VFS to check status.")});class WUe{constructor(){de(this,"id","core-git-tools");de(this,"unregisterCallbacks",[])}async initialize(t){}register(t){if(this.unregisterCallbacks.length>0){console.warn(`[${this.id}] Already registered. Skipping.`);return}const n={description:"Initialize an empty Git repository in a VFS directory.",parameters:$Ue};this.unregisterCallbacks.push(t.registerTool("gitInit",n,async({path:o},l)=>{const c=l==null?void 0:l.fsInstance;if(!c)return{success:!1,error:"Filesystem instance not available in context."};try{return await CZ(o,{fsInstance:c}),{success:!0,message:`Repository initialized at ${o}`}}catch(u){return{success:!1,error:u.message}}}));const r={description:"Stage all changes and commit them in a VFS Git repository.",parameters:zUe};this.unregisterCallbacks.push(t.registerTool("gitCommit",r,async({path:o,message:l},c)=>{const u=c==null?void 0:c.fsInstance;if(!u)return{success:!1,error:"Filesystem instance not available in context."};const d=br.getState();if(!d.gitUserName||!d.gitUserEmail)return{success:!1,error:"Git user name and email not configured in settings. Cannot commit."};try{return await yD(o,l,{fsInstance:u}),{success:!0,message:`Changes committed in ${o}`}}catch(h){return{success:!1,error:h.message}}}));const s={description:"Pull changes from the remote repository for the specified branch.",parameters:UUe};this.unregisterCallbacks.push(t.registerTool("gitPull",s,async({path:o,branch:l},c)=>{const u=c==null?void 0:c.fsInstance;if(!u)return{success:!1,error:"Filesystem instance not available in context."};try{return await oT(o,l||"main",void 0,{fsInstance:u}),{success:!0,message:`Pulled changes for ${o}`}}catch(d){return{success:!1,error:d.message}}}));const i={description:"Push committed changes from the local branch to the remote repository.",parameters:qUe};this.unregisterCallbacks.push(t.registerTool("gitPush",i,async({path:o,branch:l},c)=>{const u=c==null?void 0:c.fsInstance;if(!u)return{success:!1,error:"Filesystem instance not available in context."};try{return await bD(o,l||"main",void 0,{fsInstance:u}),{success:!0,message:`Pushed changes for ${o}`}}catch(d){return{success:!1,error:d.message}}}));const a={description:"Get the Git status for a VFS repository.",parameters:VUe};this.unregisterCallbacks.push(t.registerTool("gitStatus",a,async({path:o},l)=>{const c=l==null?void 0:l.fsInstance;if(!c)return{success:!1,error:"Filesystem instance not available in context."};try{return await kZ(o,{fsInstance:c}),{success:!0,message:`Status checked for ${o}`}}catch(u){return{success:!1,error:u.message}}}))}destroy(){this.unregisterCallbacks.forEach(t=>t()),this.unregisterCallbacks=[],console.log(`[${this.id}] Destroyed.`)}}class HUe{constructor(){de(this,"id","core-mcp-tools");de(this,"unregisterCallbacks",[]);de(this,"mcpToolUnregisterCallbacks",[]);de(this,"mcpClients",new Map);de(this,"modApi");de(this,"connectionAttempts",new Map);de(this,"retryTimeouts",new Map)}async initialize(t){this.modApi=t,globalThis.mcpToolsModuleInstance=this,Pe.emit(Er.loadMcpStateRequest,void 0),this.setupEventListeners(),await this.initializeMcpClients()}register(t){}destroy(){this.retryTimeouts.forEach(t=>{clearTimeout(t)}),this.retryTimeouts.clear(),this.connectionAttempts.clear(),this.mcpClients.forEach(t=>{try{t.client&&typeof t.client.disconnect=="function"&&t.client.disconnect()}catch(n){console.error(`[${this.id}] Error disconnecting MCP client ${t.id}:`,n)}}),this.mcpClients.clear(),this.unregisterCallbacks.forEach(t=>t()),this.unregisterCallbacks=[],this.mcpToolUnregisterCallbacks.forEach(t=>t()),this.mcpToolUnregisterCallbacks=[]}setupEventListeners(){const t=n=>{this.initializeMcpClients().catch(r=>{console.error(`[${this.id}] Error reinitializing MCP clients:`,r)})};Pe.on(Er.serversChanged,t),this.unregisterCallbacks.push(()=>{Pe.off(Er.serversChanged,t)})}getRetryConfig(){const t=al.getState();return{maxAttempts:t.retryAttempts,baseDelay:t.retryDelay,timeout:t.connectionTimeout}}async initializeMcpClients(){try{const n=al.getState().servers.filter(r=>r.enabled);this.connectionAttempts.clear(),this.retryTimeouts.forEach(r=>{clearTimeout(r)}),this.retryTimeouts.clear(),this.mcpClients.forEach(r=>{try{r.client&&typeof r.client.disconnect=="function"&&r.client.disconnect()}catch(s){console.error(`[${this.id}] Error disconnecting existing MCP client ${r.id}:`,s)}}),this.mcpClients.clear(),this.mcpToolUnregisterCallbacks.forEach(r=>r()),this.mcpToolUnregisterCallbacks=[];for(const r of n)this.connectToMcpServerWithRetry(r)}catch(t){console.error(`[${this.id}] Error initializing MCP clients:`,t),Me.error("Failed to initialize MCP clients",{description:t instanceof Error?t.message:"Unknown error occurred"})}}async connectToMcpServerWithRetry(t){const n=this.getRetryConfig(),r=this.connectionAttempts.get(t.id)||0;try{await this.connectToMcpServer(t),this.connectionAttempts.delete(t.id);const s=this.retryTimeouts.get(t.id);s&&(clearTimeout(s),this.retryTimeouts.delete(t.id)),Me.success(`Connected to MCP server: ${t.name}`,{description:"Successfully connected and loaded tools"})}catch(s){if(console.error(`[${this.id}] Failed to connect to MCP server ${t.name} (attempt ${r+1}):`,s),al.getState().setServerStatus({serverId:t.id,connected:!1,error:s instanceof Error?s.message:"Connection failed",lastConnected:void 0,toolCount:0,tools:[]}),r<n.maxAttempts){this.connectionAttempts.set(t.id,r+1);const a=r+1,o=n.baseDelay*Math.pow(1.5,r),l=setTimeout(()=>{this.retryTimeouts.delete(t.id),this.connectToMcpServerWithRetry(t)},o);this.retryTimeouts.set(t.id,l),Me.warning(`MCP server connection failed: ${t.name}`,{description:`Retrying in ${Math.round(o/1e3)}s (attempt ${a+1}/${n.maxAttempts+1})`})}else{this.connectionAttempts.delete(t.id);const a=s instanceof Error?s.message:"Connection failed";Me.error(`Failed to connect to MCP server: ${t.name}`,{description:`All ${n.maxAttempts+1} connection attempts failed. ${a}`,duration:1e4}),console.error(`[${this.id}] All retry attempts exhausted for MCP server ${t.name}`)}}}async connectToMcpServer(t){const n=this.getRetryConfig();try{let r,s="streamable-http";if(t.url.startsWith("stdio://"))r=await this.connectWithStdioTransport(t),s="stdio";else{const i=new Promise((a,o)=>{setTimeout(()=>{o(new Error(`Connection timeout after ${n.timeout}ms`))},n.timeout)});try{r=await Promise.race([this.connectWithStreamableHttp(t),i]),s="streamable-http"}catch{r=await Promise.race([this.connectWithSseTransport(t),i]),s="sse"}}await this.handleSuccessfulConnection(t,r,s)}catch(r){let s=r;throw r instanceof Error&&(r.message.includes("Bridge service not healthy")||r.message.includes("stdio bridge connection failed")?s=new Error("Stdio MCP server requires LiteChat MCP Bridge. Please install and start the bridge service: npm install -g litechat-mcp-bridge && litechat-mcp-bridge"):r.message.includes("fetch")?s=new Error(`Network error: Unable to reach MCP server at ${t.url}. Please check if the server is running and accessible.`):r.message.includes("timeout")?s=new Error(`Connection timeout: MCP server at ${t.url} did not respond within ${n.timeout}ms.`):r.message.includes("401")||r.message.includes("403")?s=new Error(`Authentication error: Invalid credentials for MCP server at ${t.url}.`):r.message.includes("404")?s=new Error(`Server not found: MCP server endpoint ${t.url} does not exist.`):r.message.includes("500")&&(s=new Error(`Server error: MCP server at ${t.url} returned an internal server error.`))),console.error(`[${this.id}] Failed to connect to MCP server ${t.name}:`,s),s}}async connectWithStreamableHttp(t){const n=this.createStreamableHttpTransport(t);return p7({transport:n})}async getBridgeUrl(){const n=al.getState().bridgeConfig||{};if(n.url)return n.url;if(n.host||n.port){const r=n.host||"localhost",s=n.port||3001;return`http://${r}:${s}`}return"http://localhost:3001"}async connectWithStdioTransport(t){var o;if(!t.url.startsWith("stdio://"))throw new Error("Not a stdio server configuration");const n=new URL(t.url),r=n.hostname||n.pathname.replace("//",""),s=n.searchParams.get("args")||"";if(!r)throw new Error("stdio:// URL must specify a command (e.g., stdio://npx?args=-y,@modelcontextprotocol/server-filesystem,.)");const i=await this.getBridgeUrl(),a=`${r}-${Date.now()}`;try{const l=new URLSearchParams;l.set("command",r),s&&l.set("args",s);const c=`${i}/servers/${a}/mcp?${l.toString()}`,u=await fetch(c,{method:"POST",headers:{"Content-Type":"application/json",...t.headers||{}},body:JSON.stringify({jsonrpc:"2.0",id:1,method:"tools/list",params:{}})});if(!u.ok)throw new Error(`Failed to get tools: ${u.status} ${u.statusText}`);const d=await u.json();if(d.error)throw new Error(`Tools request failed: ${d.error.message}`);let h=0;return{tools:((o=d.result)==null?void 0:o.tools)||[],serverEndpoint:c,callTool:async m=>{const y=`${Date.now()}_${++h}`,b=await fetch(c,{method:"POST",headers:{"Content-Type":"application/json",...t.headers||{}},body:JSON.stringify({jsonrpc:"2.0",id:y,method:"tools/call",params:{name:m.name,arguments:m.arguments}})});if(!b.ok)throw new Error(`Tool call failed: ${b.status} ${b.statusText}`);const v=await b.json();if(v.error)throw new Error(`Tool execution failed: ${v.error.message}`);return v.result}}}catch(l){throw new Error(`Bridge connection failed: ${l instanceof Error?l.message:l}. Ensure bridge is running with: npm run mcp-proxy. Command: ${r}, Args: ${s||"none"}`)}}async connectWithSseTransport(t){return p7({transport:{type:"sse",url:t.url,headers:t.headers||{}}})}createStreamableHttpTransport(t){let n=null,r=!1;return{async start(){const s=await fetch(t.url,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json, text/event-stream",Origin:window.location.origin,...t.headers},body:JSON.stringify({jsonrpc:"2.0",id:`init_${Date.now()}`,method:"initialize",params:{protocolVersion:"2025-03-26",capabilities:{tools:{}},clientInfo:{name:"LiteChat",version:"1.0.0"}}})});if(!s.ok)throw new Error(`HTTP ${s.status}: ${s.statusText}`);n=s.headers.get("Mcp-Session-Id");const i=await s.json();if(i.error)throw new Error(`MCP Initialize Error: ${i.error.message}`);const a=await fetch(t.url,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json",Origin:window.location.origin,...n&&{"Mcp-Session-Id":n},...t.headers},body:JSON.stringify({jsonrpc:"2.0",method:"initialized",params:{}})});if(!a.ok)throw new Error(`Failed to send initialized notification: ${a.status}`);r=!0},async send(s){var o,l;if(!r)throw new Error("Transport not connected");const i=await fetch(t.url,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json, text/event-stream",Origin:window.location.origin,...n&&{"Mcp-Session-Id":n},...t.headers},body:JSON.stringify(s)});if(!i.ok)throw i.status===404&&n?(n=null,r=!1,new Error("Session expired, reinitializing connection")):new Error(`HTTP ${i.status}: ${i.statusText}`);const a=i.headers.get("Content-Type")||"";if(a.includes("text/event-stream"))(o=i.body)==null||o.getReader();else if(a.includes("application/json")){const c=await i.json();(l=this.onmessage)==null||l.call(this,c)}},async close(){var s;if(n)try{await fetch(t.url,{method:"DELETE",headers:{Origin:window.location.origin,"Mcp-Session-Id":n,...t.headers}})}catch{}r=!1,n=null,(s=this.onclose)==null||s.call(this)},onclose:void 0,onerror:void 0,onmessage:void 0}}async handleSuccessfulConnection(t,n,r){let s;try{if(n.tools&&Array.isArray(n.tools))s={},n.tools.forEach(l=>{s[l.name]={description:l.description,parameters:l.inputSchema}});else throw console.error(`[${this.id}] Bridge client missing tools array:`,n),new Error("Bridge client missing tools array")}catch(l){throw console.error(`[${this.id}] Failed to retrieve tools from ${t.name}:`,l),console.error(`[${this.id}] Error stack:`,l instanceof Error?l.stack:"No stack trace available"),l}const i={id:t.id,name:t.name,client:n,tools:s,transport:r};this.mcpClients.set(t.id,i),i.tools=s,this.modApi&&Object.entries(s).forEach(([l,c])=>{const u=`mcp_${t.name}_${l}`,d=c;let h;if(d.parameters&&typeof d.parameters=="object"&&d.parameters.properties){const v={},x=d.parameters.required||[];for(const[w,S]of Object.entries(d.parameters.properties)){let k;switch(S.type){case"string":k=ze();break;case"number":k=At();break;case"boolean":k=Kn();break;case"array":k=on(Hd());break;case"object":k=Ke({}).passthrough();break;default:k=Hd()}S.description&&(k=k.describe(S.description)),x.includes(w)||(k=k.optional()),v[w]=k}h=Ke(v)}else h=Ke({});const m={description:d.description||`MCP tool ${l} from ${t.name}`,parameters:h},y=async v=>{const x=await i.client.callTool({name:l,arguments:v});return x&&x.content?Array.isArray(x.content)?x.content.map(S=>S.type==="text"?S.text:S.type==="image"?`[Image: ${S.mimeType||"unknown format"}]`:JSON.stringify(S)).join(`
`):typeof x.content=="string"?x.content:JSON.stringify(x.content):JSON.stringify(x)},b=this.modApi.registerTool(u,m,y);this.mcpToolUnregisterCallbacks.push(b),Pe.emit(Er.toolDiscovered,{toolName:l,serverId:t.id,serverName:t.name,toolDefinition:d})}),al.getState().setServerStatus({serverId:t.id,connected:!0,error:void 0,lastConnected:new Date,toolCount:Object.keys(s).length,tools:Object.keys(s)});const o={"streamable-http":"Streamable HTTP (latest)",sse:"SSE (legacy)",stdio:"Stdio (local bridge)"};Me.success(`Connected to MCP server: ${t.name}`,{description:`Using ${o[r]} transport with ${Object.keys(s).length} tools`})}retryServerConnection(t){const r=al.getState().servers.find(a=>a.id===t);if(!r){console.error(`[${this.id}] Server with ID ${t} not found`);return}if(!r.enabled)return;this.connectionAttempts.delete(t);const s=this.retryTimeouts.get(t);s&&(clearTimeout(s),this.retryTimeouts.delete(t));const i=this.mcpClients.get(t);if(i){try{i.client&&typeof i.client.disconnect=="function"&&i.client.disconnect()}catch(a){console.error(`[${this.id}] Error disconnecting existing client for ${r.name}:`,a)}this.mcpClients.delete(t)}this.connectToMcpServerWithRetry(r)}getConnectionStatus(){const t={},n=al.getState();return n.servers.forEach(r=>{const s=n.serverStatuses[r.id];t[r.id]={connected:(s==null?void 0:s.connected)||!1,error:s==null?void 0:s.error,toolCount:(s==null?void 0:s.toolCount)||0}}),t}registerMcpToolWithAI(t,n){const r=this.mcpClients.get(t);if(!r)return console.error(`[${this.id}] No MCP client found for server ${t}`),()=>{};const s=r.tools[n];if(!s)return console.error(`[${this.id}] Tool ${n} not found in server ${r.name}`),()=>{};if(!this.modApi)return console.error(`[${this.id}] ModApi not available for tool registration`),()=>{};const i=`mcp_${r.name}_${n}`;try{const a={description:s.description||`MCP tool ${n} from ${r.name}`,parameters:s.parameters||Ke({})},o=async c=>{const u=await r.client.callTool({name:n,arguments:c});let d="";u&&u.content?Array.isArray(u.content)?d=u.content.map(m=>m.type==="text"?m.text:m.type==="image"?`[Image: ${m.mimeType||"unknown format"}]`:JSON.stringify(m)).join(`
`):typeof u.content=="string"?d=u.content:d=JSON.stringify(u.content):d=JSON.stringify(u);const{maxResponseSize:h}=al.getState();return d.length>h&&(d=d.substring(0,h)+`

[... response truncated due to size ...]`),d},l=this.modApi.registerTool(i,a,o);return this.mcpToolUnregisterCallbacks.push(l),Pe.emit(Er.toolRegistered,{toolName:n,serverId:r.id,serverName:r.name,prefixedToolName:i}),l}catch(a){return console.error(`[${this.id}] Error registering MCP tool ${n} with AI SDK:`,a),()=>{}}}unregisterMcpToolFromAI(t,n){const r=this.mcpClients.get(t);if(!r){console.error(`[${this.id}] No MCP client found for server ${t}`);return}const s=`mcp_${r.name}_${n}`;Pe.emit(Er.toolUnregistered,{toolName:n,serverId:r.id,prefixedToolName:s})}}const GUe=(e,t=80)=>e.length<=t?e:e.slice(0,t).trim()+"...",Nse=({enabledTools:e,onToggleTool:t,onToggleAll:n,disabled:r=!1,className:s,maxSteps:i,onMaxStepsChange:a,globalDefaultMaxSteps:o=5,showMaxSteps:l=!1,disabledMessage:c})=>{const u=Vi(x=>x.tools),[d,h]=E.useState(""),m=E.useMemo(()=>Object.entries(u).map(([x,{definition:w,modId:S}])=>({name:x,description:w.description??"No description provided.",modId:S})).sort((x,w)=>x.name.localeCompare(w.name)),[u]),y=E.useMemo(()=>{const x=d.trim().toLowerCase();return x?m.filter(w=>w.name.toLowerCase().includes(x)||w.description.toLowerCase().includes(x)||w.modId.toLowerCase().includes(x)):m},[m,d]),b=E.useCallback(x=>{if(!a)return;const w=x.target.value;if(w===""){a(null);return}const S=parseInt(w,10);if(isNaN(S))a(null);else{const k=Math.max(1,Math.min(20,S));a(k)}},[a]),v=i===null?"":String(i);return f.jsxs("div",{className:Xe("p-4 max-w-2xl space-y-3",s),children:[f.jsx("h4",{className:"text-sm font-medium",children:"Available Tools"}),f.jsxs("div",{className:"relative",children:[f.jsx(Do,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),f.jsx(Cn,{type:"search",placeholder:"Filter tools...",value:d,onChange:x=>h(x.target.value),className:"pl-8 h-9",disabled:r})]}),f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsxs(Ot,{className:"text-xs text-muted-foreground",children:[y.length," tools shown (",e.size," enabled)"]}),f.jsxs("div",{className:"space-x-2",children:[f.jsx(mt,{variant:"outline",size:"sm",onClick:()=>n(!0,m.map(x=>x.name)),disabled:r||m.length===0,children:"Enable All"}),f.jsx(mt,{variant:"outline",size:"sm",onClick:()=>n(!1,m.map(x=>x.name)),disabled:r||m.length===0||e.size===0,children:"Disable All"})]})]}),f.jsx("div",{className:"border rounded-md bg-background/50",children:r&&c?f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:c}):m.length===0?f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No tools registered."}):y.length===0?f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No tools match filter."}):f.jsx(Yl,{className:"h-96 w-full",children:f.jsx("div",{className:"p-2 space-y-1",children:y.map(x=>f.jsxs("div",{className:"flex items-center justify-between p-1.5 rounded hover:bg-muted",children:[f.jsx(Oo,{id:`tool-switch-${x.name}`,checked:e.has(x.name),onCheckedChange:w=>t(x.name,w),className:"flex-shrink-0",disabled:r}),f.jsxs("div",{className:"flex-grow pl-2 space-y-0.5",children:[f.jsx(Ot,{htmlFor:`tool-switch-${x.name}`,className:Xe("block text-sm font-medium",r?"cursor-not-allowed":"cursor-pointer"),children:x.name}),f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx("span",{className:"block text-xs text-muted-foreground break-words cursor-help",children:GUe(x.description)})}),f.jsx(Sr,{side:"bottom",className:"max-w-sm",children:f.jsxs("div",{className:"space-y-1",children:[f.jsx("div",{className:"font-medium",children:x.name}),f.jsxs("div",{className:"text-xs opacity-90",children:["From: ",x.modId]}),f.jsx("div",{className:"text-xs",children:x.description})]})})]})]})]},x.name))})})}),l&&f.jsxs("div",{className:"pt-2",children:[f.jsx(Ot,{htmlFor:"local-max-steps",className:"text-xs font-medium",children:"Max Tool Steps (This Turn)"}),f.jsx(Cn,{id:"local-max-steps",type:"number",min:"1",max:"20",step:"1",value:v,onChange:b,className:"w-20 h-8 text-xs mt-1",placeholder:String(o),disabled:r}),f.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Overrides the global setting for the next message only (1-20). Leave blank to use default."})]})]})},KUe=({module:e,popoverMaxSteps:t,setPopoverMaxSteps:n,className:r})=>{const s=e.getEnabledTools(),i=e.getSelectedItemId(),a=e.getSelectedItemType(),o=e.getGlobalDefaultMaxSteps(),l=E.useCallback((h,m)=>{e.setEnabledTools(y=>{const b=new Set(y);return m?b.add(h):b.delete(h),b})},[e]),c=E.useCallback((h,m)=>{e.setEnabledTools(()=>h?new Set(m):new Set)},[e]),u=a!=="conversation"||!i;return f.jsx(Nse,{enabledTools:s,onToggleTool:l,onToggleAll:c,disabled:u,className:r,maxSteps:t,onMaxStepsChange:n,globalDefaultMaxSteps:o,showMaxSteps:!0,disabledMessage:"Select a conversation to manage tools."})},YUe=({module:e})=>{const[,t]=E.useState({});E.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const[n,r]=E.useState(!1),[s,i]=E.useState(e.getMaxStepsOverride()),a=e.getEnabledTools(),o=e.getMaxStepsOverride(),l=e.getIsStreaming(),c=e.getIsVisible();E.useEffect(()=>{i(e.getMaxStepsOverride())},[e.getMaxStepsOverride()]);const u=m=>{r(m),!m&&s!==e.getMaxStepsOverride()&&e.setMaxStepsOverride(s)},d=a.size>0||o!==null,h=l;return c?f.jsxs(sc,{open:n,onOpenChange:u,children:[f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(ic,{asChild:!0,children:f.jsx(mt,{variant:d?"secondary":"ghost",size:"icon",className:"h-8 w-8",disabled:h,"aria-label":"Configure Tools",children:f.jsx(Gx,{className:"h-4 w-4"})})})}),f.jsx(Sr,{side:"top",children:`Tools (${a.size} enabled)`})]})}),f.jsx(ac,{className:"w-auto p-0",align:"start",children:f.jsx(KUe,{module:e,popoverMaxSteps:s,setPopoverMaxSteps:i})})]}):null};class ZUe{constructor(){de(this,"id","core-tool-selector");de(this,"unregisterCallback",null);de(this,"eventUnsubscribers",[]);de(this,"transientEnabledTools",new Set);de(this,"transientMaxStepsOverride",null);de(this,"isStreaming",!1);de(this,"isVisible",!0);de(this,"selectedItemId",null);de(this,"selectedItemType",null);de(this,"allToolsCount",0);de(this,"globalDefaultMaxSteps",5);de(this,"notifyComponentUpdate",null);de(this,"getEnabledTools",()=>this.transientEnabledTools);de(this,"getMaxStepsOverride",()=>this.transientMaxStepsOverride);de(this,"getIsStreaming",()=>this.isStreaming);de(this,"getIsVisible",()=>this.isVisible);de(this,"getSelectedItemId",()=>this.selectedItemId);de(this,"getSelectedItemType",()=>this.selectedItemType);de(this,"getAllToolsCount",()=>this.allToolsCount);de(this,"getGlobalDefaultMaxSteps",()=>this.globalDefaultMaxSteps);de(this,"setEnabledTools",t=>{var n;this.transientEnabledTools=t(this.transientEnabledTools),(n=this.notifyComponentUpdate)==null||n.call(this)});de(this,"setMaxStepsOverride",t=>{var n;this.transientMaxStepsOverride=t,(n=this.notifyComponentUpdate)==null||n.call(this)});de(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){var o;this.loadInitialState(),this.updateVisibility(),(o=this.notifyComponentUpdate)==null||o.call(this);const n=t.on(Zn.statusChanged,l=>{var c;typeof l=="object"&&l&&"status"in l&&this.isStreaming!==(l.status==="streaming")&&(this.isStreaming=l.status==="streaming",(c=this.notifyComponentUpdate)==null||c.call(this))}),r=t.on(Qn.selectedModelChanged,()=>{var l;this.updateVisibility(),(l=this.notifyComponentUpdate)==null||l.call(this)}),s=t.on(Or.contextChanged,l=>{var c;this.selectedItemId=l.selectedItemId,this.selectedItemType=l.selectedItemType,this.updateVisibility(),(c=this.notifyComponentUpdate)==null||c.call(this)}),i=t.on(sn.toolMaxStepsChanged,l=>{var c;typeof l=="object"&&l&&"steps"in l&&(this.globalDefaultMaxSteps=l.steps,(c=this.notifyComponentUpdate)==null||c.call(this))}),a=t.on($r.toolsChanged,l=>{var c;if(l&&typeof l.tools=="object"){const u=Object.keys(l.tools).length;this.allToolsCount!==u&&(this.allToolsCount=u,this.updateVisibility(),(c=this.notifyComponentUpdate)==null||c.call(this))}});this.eventUnsubscribers.push(n,r,s,i,a)}loadInitialState(){this.isStreaming=vn.getState().status==="streaming",this.selectedItemId=qn.getState().selectedItemId,this.selectedItemType=qn.getState().selectedItemType,this.allToolsCount=Object.keys(Vi.getState().tools).length,this.globalDefaultMaxSteps=br.getState().toolMaxSteps}updateVisibility(){var a,o;const{getSelectedModel:t}=Cr.getState(),n=t(),r=this.allToolsCount>0,s=((o=(a=n==null?void 0:n.metadata)==null?void 0:a.supported_parameters)==null?void 0:o.includes("tools"))??!1,i=r&&s;this.isVisible!==i&&(this.isVisible=i)}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,triggerRenderer:()=>Ve.createElement(YUe,{module:this}),getMetadata:()=>{if(this.transientEnabledTools.size>0||this.transientMaxStepsOverride!==null)return{enabledTools:Array.from(this.transientEnabledTools),...this.transientMaxStepsOverride!==null&&{maxSteps:this.transientMaxStepsOverride}}},clearOnSubmit:()=>{var r;let n=!1;this.transientEnabledTools.size>0&&(this.transientEnabledTools=new Set,n=!0),this.transientMaxStepsOverride!==null&&(this.transientMaxStepsOverride=null,n=!0),n&&((r=this.notifyComponentUpdate)==null||r.call(this))}})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,console.log(`[${this.id}] Destroyed.`)}}var Oq=1,XUe=.9,JUe=.8,QUe=.17,u3=.1,d3=.999,eqe=.9999,tqe=.99,nqe=/[\\\/_+.#"@\[\(\{&]/,rqe=/[\\\/_+.#"@\[\(\{&]/g,sqe=/[\s-]/,Mse=/[\s-]/g;function j4(e,t,n,r,s,i,a){if(i===t.length)return s===e.length?Oq:tqe;var o=`${s},${i}`;if(a[o]!==void 0)return a[o];for(var l=r.charAt(i),c=n.indexOf(l,s),u=0,d,h,m,y;c>=0;)d=j4(e,t,n,r,c+1,i+1,a),d>u&&(c===s?d*=Oq:nqe.test(e.charAt(c-1))?(d*=JUe,m=e.slice(s,c-1).match(rqe),m&&s>0&&(d*=Math.pow(d3,m.length))):sqe.test(e.charAt(c-1))?(d*=XUe,y=e.slice(s,c-1).match(Mse),y&&s>0&&(d*=Math.pow(d3,y.length))):(d*=QUe,s>0&&(d*=Math.pow(d3,c-s))),e.charAt(c)!==t.charAt(i)&&(d*=eqe)),(d<u3&&n.charAt(c-1)===r.charAt(i+1)||r.charAt(i+1)===r.charAt(i)&&n.charAt(c-1)!==r.charAt(i))&&(h=j4(e,t,n,r,c+1,i+2,a),h*u3>d&&(d=h*u3)),d>u&&(u=d),c=n.indexOf(l,c+1);return a[o]=u,u}function Pq(e){return e.toLowerCase().replace(Mse," ")}function iqe(e,t,n){return e=n&&n.length>0?`${e+" "+n.join(" ")}`:e,j4(e,t,Pq(e),Pq(t),0,0,{})}var qv='[cmdk-group=""]',f3='[cmdk-group-items=""]',aqe='[cmdk-group-heading=""]',Ise='[cmdk-item=""]',Dq=`${Ise}:not([aria-disabled="true"])`,O4="cmdk-item-select",h0="data-value",oqe=(e,t,n)=>iqe(e,t,n),jse=E.createContext(void 0),r_=()=>E.useContext(jse),Ose=E.createContext(void 0),Q6=()=>E.useContext(Ose),Pse=E.createContext(void 0),Dse=E.forwardRef((e,t)=>{let n=p0(()=>{var ee,se;return{search:"",value:(se=(ee=e.value)!=null?ee:e.defaultValue)!=null?se:"",selectedItemId:void 0,filtered:{count:0,items:new Map,groups:new Set}}}),r=p0(()=>new Set),s=p0(()=>new Map),i=p0(()=>new Map),a=p0(()=>new Set),o=Fse(e),{label:l,children:c,value:u,onValueChange:d,filter:h,shouldFilter:m,loop:y,disablePointerSelection:b=!1,vimBindings:v=!0,...x}=e,w=la(),S=la(),k=la(),C=E.useRef(null),T=bqe();Om(()=>{if(u!==void 0){let ee=u.trim();n.current.value=ee,R.emit()}},[u]),Om(()=>{T(6,W)},[]);let R=E.useMemo(()=>({subscribe:ee=>(a.current.add(ee),()=>a.current.delete(ee)),snapshot:()=>n.current,setState:(ee,se,pe)=>{var ue,Oe,Fe,Se;if(!Object.is(n.current[ee],se)){if(n.current[ee]=se,ee==="search")D(),P(),T(1,B);else if(ee==="value"){if(document.activeElement.hasAttribute("cmdk-input")||document.activeElement.hasAttribute("cmdk-root")){let Ce=document.getElementById(k);Ce?Ce.focus():(ue=document.getElementById(w))==null||ue.focus()}if(T(7,()=>{var Ce;n.current.selectedItemId=(Ce=O())==null?void 0:Ce.id,R.emit()}),pe||T(5,W),((Oe=o.current)==null?void 0:Oe.value)!==void 0){let Ce=se??"";(Se=(Fe=o.current).onValueChange)==null||Se.call(Fe,Ce);return}}R.emit()}},emit:()=>{a.current.forEach(ee=>ee())}}),[]),N=E.useMemo(()=>({value:(ee,se,pe)=>{var ue;se!==((ue=i.current.get(ee))==null?void 0:ue.value)&&(i.current.set(ee,{value:se,keywords:pe}),n.current.filtered.items.set(ee,I(se,pe)),T(2,()=>{P(),R.emit()}))},item:(ee,se)=>(r.current.add(ee),se&&(s.current.has(se)?s.current.get(se).add(ee):s.current.set(se,new Set([ee]))),T(3,()=>{D(),P(),n.current.value||B(),R.emit()}),()=>{i.current.delete(ee),r.current.delete(ee),n.current.filtered.items.delete(ee);let pe=O();T(4,()=>{D(),(pe==null?void 0:pe.getAttribute("id"))===ee&&B(),R.emit()})}),group:ee=>(s.current.has(ee)||s.current.set(ee,new Set),()=>{i.current.delete(ee),s.current.delete(ee)}),filter:()=>o.current.shouldFilter,label:l||e["aria-label"],getDisablePointerSelection:()=>o.current.disablePointerSelection,listId:w,inputId:k,labelId:S,listInnerRef:C}),[]);function I(ee,se){var pe,ue;let Oe=(ue=(pe=o.current)==null?void 0:pe.filter)!=null?ue:oqe;return ee?Oe(ee,n.current.search,se):0}function P(){if(!n.current.search||o.current.shouldFilter===!1)return;let ee=n.current.filtered.items,se=[];n.current.filtered.groups.forEach(ue=>{let Oe=s.current.get(ue),Fe=0;Oe.forEach(Se=>{let Ce=ee.get(Se);Fe=Math.max(Ce,Fe)}),se.push([ue,Fe])});let pe=C.current;Z().sort((ue,Oe)=>{var Fe,Se;let Ce=ue.getAttribute("id"),qe=Oe.getAttribute("id");return((Fe=ee.get(qe))!=null?Fe:0)-((Se=ee.get(Ce))!=null?Se:0)}).forEach(ue=>{let Oe=ue.closest(f3);Oe?Oe.appendChild(ue.parentElement===Oe?ue:ue.closest(`${f3} > *`)):pe.appendChild(ue.parentElement===pe?ue:ue.closest(`${f3} > *`))}),se.sort((ue,Oe)=>Oe[1]-ue[1]).forEach(ue=>{var Oe;let Fe=(Oe=C.current)==null?void 0:Oe.querySelector(`${qv}[${h0}="${encodeURIComponent(ue[0])}"]`);Fe==null||Fe.parentElement.appendChild(Fe)})}function B(){let ee=Z().find(pe=>pe.getAttribute("aria-disabled")!=="true"),se=ee==null?void 0:ee.getAttribute(h0);R.setState("value",se||void 0)}function D(){var ee,se,pe,ue;if(!n.current.search||o.current.shouldFilter===!1){n.current.filtered.count=r.current.size;return}n.current.filtered.groups=new Set;let Oe=0;for(let Fe of r.current){let Se=(se=(ee=i.current.get(Fe))==null?void 0:ee.value)!=null?se:"",Ce=(ue=(pe=i.current.get(Fe))==null?void 0:pe.keywords)!=null?ue:[],qe=I(Se,Ce);n.current.filtered.items.set(Fe,qe),qe>0&&Oe++}for(let[Fe,Se]of s.current)for(let Ce of Se)if(n.current.filtered.items.get(Ce)>0){n.current.filtered.groups.add(Fe);break}n.current.filtered.count=Oe}function W(){var ee,se,pe;let ue=O();ue&&(((ee=ue.parentElement)==null?void 0:ee.firstChild)===ue&&((pe=(se=ue.closest(qv))==null?void 0:se.querySelector(aqe))==null||pe.scrollIntoView({block:"nearest"})),ue.scrollIntoView({block:"nearest"}))}function O(){var ee;return(ee=C.current)==null?void 0:ee.querySelector(`${Ise}[aria-selected="true"]`)}function Z(){var ee;return Array.from(((ee=C.current)==null?void 0:ee.querySelectorAll(Dq))||[])}function U(ee){let se=Z()[ee];se&&R.setState("value",se.getAttribute(h0))}function H(ee){var se;let pe=O(),ue=Z(),Oe=ue.findIndex(Se=>Se===pe),Fe=ue[Oe+ee];(se=o.current)!=null&&se.loop&&(Fe=Oe+ee<0?ue[ue.length-1]:Oe+ee===ue.length?ue[0]:ue[Oe+ee]),Fe&&R.setState("value",Fe.getAttribute(h0))}function L(ee){let se=O(),pe=se==null?void 0:se.closest(qv),ue;for(;pe&&!ue;)pe=ee>0?gqe(pe,qv):yqe(pe,qv),ue=pe==null?void 0:pe.querySelector(Dq);ue?R.setState("value",ue.getAttribute(h0)):H(ee)}let te=()=>U(Z().length-1),V=ee=>{ee.preventDefault(),ee.metaKey?te():ee.altKey?L(1):H(1)},Q=ee=>{ee.preventDefault(),ee.metaKey?U(0):ee.altKey?L(-1):H(-1)};return E.createElement(lr.div,{ref:t,tabIndex:-1,...x,"cmdk-root":"",onKeyDown:ee=>{var se;(se=x.onKeyDown)==null||se.call(x,ee);let pe=ee.nativeEvent.isComposing||ee.keyCode===229;if(!(ee.defaultPrevented||pe))switch(ee.key){case"n":case"j":{v&&ee.ctrlKey&&V(ee);break}case"ArrowDown":{V(ee);break}case"p":case"k":{v&&ee.ctrlKey&&Q(ee);break}case"ArrowUp":{Q(ee);break}case"Home":{ee.preventDefault(),U(0);break}case"End":{ee.preventDefault(),te();break}case"Enter":{ee.preventDefault();let ue=O();if(ue){let Oe=new Event(O4);ue.dispatchEvent(Oe)}}}}},E.createElement("label",{"cmdk-label":"",htmlFor:N.inputId,id:N.labelId,style:xqe},l),VT(e,ee=>E.createElement(Ose.Provider,{value:R},E.createElement(jse.Provider,{value:N},ee))))}),lqe=E.forwardRef((e,t)=>{var n,r;let s=la(),i=E.useRef(null),a=E.useContext(Pse),o=r_(),l=Fse(e),c=(r=(n=l.current)==null?void 0:n.forceMount)!=null?r:a==null?void 0:a.forceMount;Om(()=>{if(!c)return o.item(s,a==null?void 0:a.id)},[c]);let u=Lse(s,i,[e.value,e.children,i],e.keywords),d=Q6(),h=Oh(T=>T.value&&T.value===u.current),m=Oh(T=>c||o.filter()===!1?!0:T.search?T.filtered.items.get(s)>0:!0);E.useEffect(()=>{let T=i.current;if(!(!T||e.disabled))return T.addEventListener(O4,y),()=>T.removeEventListener(O4,y)},[m,e.onSelect,e.disabled]);function y(){var T,R;b(),(R=(T=l.current).onSelect)==null||R.call(T,u.current)}function b(){d.setState("value",u.current,!0)}if(!m)return null;let{disabled:v,value:x,onSelect:w,forceMount:S,keywords:k,...C}=e;return E.createElement(lr.div,{ref:gl(i,t),...C,id:s,"cmdk-item":"",role:"option","aria-disabled":!!v,"aria-selected":!!h,"data-disabled":!!v,"data-selected":!!h,onPointerMove:v||o.getDisablePointerSelection()?void 0:b,onClick:v?void 0:y},e.children)}),cqe=E.forwardRef((e,t)=>{let{heading:n,children:r,forceMount:s,...i}=e,a=la(),o=E.useRef(null),l=E.useRef(null),c=la(),u=r_(),d=Oh(m=>s||u.filter()===!1?!0:m.search?m.filtered.groups.has(a):!0);Om(()=>u.group(a),[]),Lse(a,o,[e.value,e.heading,l]);let h=E.useMemo(()=>({id:a,forceMount:s}),[s]);return E.createElement(lr.div,{ref:gl(o,t),...i,"cmdk-group":"",role:"presentation",hidden:d?void 0:!0},n&&E.createElement("div",{ref:l,"cmdk-group-heading":"","aria-hidden":!0,id:c},n),VT(e,m=>E.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":n?c:void 0},E.createElement(Pse.Provider,{value:h},m))))}),uqe=E.forwardRef((e,t)=>{let{alwaysRender:n,...r}=e,s=E.useRef(null),i=Oh(a=>!a.search);return!n&&!i?null:E.createElement(lr.div,{ref:gl(s,t),...r,"cmdk-separator":"",role:"separator"})}),dqe=E.forwardRef((e,t)=>{let{onValueChange:n,...r}=e,s=e.value!=null,i=Q6(),a=Oh(c=>c.search),o=Oh(c=>c.selectedItemId),l=r_();return E.useEffect(()=>{e.value!=null&&i.setState("search",e.value)},[e.value]),E.createElement(lr.input,{ref:t,...r,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":l.listId,"aria-labelledby":l.labelId,"aria-activedescendant":o,id:l.inputId,type:"text",value:s?e.value:a,onChange:c=>{s||i.setState("search",c.target.value),n==null||n(c.target.value)}})}),fqe=E.forwardRef((e,t)=>{let{children:n,label:r="Suggestions",...s}=e,i=E.useRef(null),a=E.useRef(null),o=Oh(c=>c.selectedItemId),l=r_();return E.useEffect(()=>{if(a.current&&i.current){let c=a.current,u=i.current,d,h=new ResizeObserver(()=>{d=requestAnimationFrame(()=>{let m=c.offsetHeight;u.style.setProperty("--cmdk-list-height",m.toFixed(1)+"px")})});return h.observe(c),()=>{cancelAnimationFrame(d),h.unobserve(c)}}},[]),E.createElement(lr.div,{ref:gl(i,t),...s,"cmdk-list":"",role:"listbox",tabIndex:-1,"aria-activedescendant":o,"aria-label":r,id:l.listId},VT(e,c=>E.createElement("div",{ref:gl(a,l.listInnerRef),"cmdk-list-sizer":""},c)))}),hqe=E.forwardRef((e,t)=>{let{open:n,onOpenChange:r,overlayClassName:s,contentClassName:i,container:a,...o}=e;return E.createElement(Bne,{open:n,onOpenChange:r},E.createElement($ne,{container:a},E.createElement(zne,{"cmdk-overlay":"",className:s}),E.createElement(Une,{"aria-label":e.label,"cmdk-dialog":"",className:i},E.createElement(Dse,{ref:t,...o}))))}),pqe=E.forwardRef((e,t)=>Oh(n=>n.filtered.count===0)?E.createElement(lr.div,{ref:t,...e,"cmdk-empty":"",role:"presentation"}):null),mqe=E.forwardRef((e,t)=>{let{progress:n,children:r,label:s="Loading...",...i}=e;return E.createElement(lr.div,{ref:t,...i,"cmdk-loading":"",role:"progressbar","aria-valuenow":n,"aria-valuemin":0,"aria-valuemax":100,"aria-label":s},VT(e,a=>E.createElement("div",{"aria-hidden":!0},a)))}),bb=Object.assign(Dse,{List:fqe,Item:lqe,Input:dqe,Group:cqe,Separator:uqe,Dialog:hqe,Empty:pqe,Loading:mqe});function gqe(e,t){let n=e.nextElementSibling;for(;n;){if(n.matches(t))return n;n=n.nextElementSibling}}function yqe(e,t){let n=e.previousElementSibling;for(;n;){if(n.matches(t))return n;n=n.previousElementSibling}}function Fse(e){let t=E.useRef(e);return Om(()=>{t.current=e}),t}var Om=typeof window>"u"?E.useEffect:E.useLayoutEffect;function p0(e){let t=E.useRef();return t.current===void 0&&(t.current=e()),t}function Oh(e){let t=Q6(),n=()=>e(t.snapshot());return E.useSyncExternalStore(t.subscribe,n,n)}function Lse(e,t,n,r=[]){let s=E.useRef(),i=r_();return Om(()=>{var a;let o=(()=>{var c;for(let u of n){if(typeof u=="string")return u.trim();if(typeof u=="object"&&"current"in u)return u.current?(c=u.current.textContent)==null?void 0:c.trim():s.current}})(),l=r.map(c=>c.trim());i.value(e,o,l),(a=t.current)==null||a.setAttribute(h0,o),s.current=o}),s}var bqe=()=>{let[e,t]=E.useState(),n=p0(()=>new Map);return Om(()=>{n.current.forEach(r=>r()),n.current=new Map},[e]),(r,s)=>{n.current.set(r,s),t({})}};function vqe(e){let t=e.type;return typeof t=="function"?t(e.props):"render"in t?t.render(e.props):e}function VT({asChild:e,children:t},n){return e&&E.isValidElement(t)?E.cloneElement(vqe(t),{ref:t.ref},n(t.props.children)):n(t)}var xqe={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};function Bse({className:e,...t}){return f.jsx(bb,{"data-slot":"command",className:Xe("bg-popover text-popover-foreground flex h-full w-full flex-col overflow-hidden rounded-md",e),...t})}function $se({className:e,...t}){return f.jsxs("div",{"data-slot":"command-input-wrapper",className:"flex h-9 items-center gap-2 border-b px-3",children:[f.jsx(Do,{className:"size-4 shrink-0 opacity-50"}),f.jsx(bb.Input,{"data-slot":"command-input",className:Xe("placeholder:text-muted-foreground flex h-10 w-full rounded-md bg-transparent py-3 text-sm outline-hidden disabled:cursor-not-allowed disabled:opacity-50",e),...t})]})}function zse({className:e,...t}){return f.jsx(bb.List,{"data-slot":"command-list",className:Xe("max-h-[300px] scroll-py-1 overflow-x-hidden overflow-y-auto",e),...t})}function Use({...e}){return f.jsx(bb.Empty,{"data-slot":"command-empty",className:"py-6 text-center text-sm",...e})}function qse({className:e,...t}){return f.jsx(bb.Group,{"data-slot":"command-group",className:Xe("text-foreground [&_[cmdk-group-heading]]:text-muted-foreground overflow-hidden p-1 [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium",e),...t})}function Vse({className:e,...t}){return f.jsx(bb.Item,{"data-slot":"command-item",className:Xe("data-[selected=true]:bg-accent data-[selected=true]:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled=true]:pointer-events-none data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...t})}const WT=({models:e,value:t,onChange:n,className:r,disabled:s,isLoading:i})=>{const[a,o]=E.useState(!1),[l,c]=E.useState(""),[u,d]=E.useState({reasoning:!1,webSearch:!1,tools:!1,multimodal:!1,imageGeneration:!1}),h=E.useMemo(()=>{let w=e;if(l.trim()){const k=l.toLowerCase();w=e.filter(C=>C.name.toLowerCase().includes(k)||C.providerName.toLowerCase().includes(k)||C.id.toLowerCase().includes(k))}const S=Object.entries(u).filter(([,k])=>k).map(([k])=>k);return S.length===0?w:w.filter(k=>{var N,I,P;const C=new Set(((N=k.metadataSummary)==null?void 0:N.supported_parameters)??[]),T=new Set(((I=k.metadataSummary)==null?void 0:I.input_modalities)??[]),R=new Set(((P=k.metadataSummary)==null?void 0:P.output_modalities)??[]);return S.every(B=>{switch(B){case"reasoning":return C.has("reasoning");case"webSearch":return C.has("web_search")||C.has("web_search_options");case"tools":return C.has("tools");case"multimodal":return Array.from(T).some(D=>D!=="text");case"imageGeneration":return R.has("image");default:return!0}})})},[e,l,u]),m=E.useMemo(()=>e.find(w=>w.id===t),[e,t]),y=E.useCallback(w=>{const S=w===t?null:w;n==null||n(S),o(!1),c("")},[t,n]),b=w=>{d(S=>({...S,[w]:!S[w]}))};if(i)return f.jsx(Wr,{className:Xe("h-9 w-[250px]",r)});const x=Object.values(u).filter(Boolean).length;return f.jsxs(sc,{open:a,onOpenChange:o,children:[f.jsx(ic,{asChild:!0,children:f.jsxs(mt,{variant:"outline",role:"combobox","aria-expanded":a,disabled:s||e.length===0,className:Xe("w-auto justify-between h-9 text-sm font-normal relative",r),children:[f.jsx("span",{className:"truncate max-w-[200px] sm:max-w-[300px]",children:m?`${m.name} (${m.providerName})`:"Select Model..."}),f.jsx(fE,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"}),x>0&&f.jsx("span",{className:"absolute -top-1 -right-1 inline-flex items-center justify-center px-1.5 py-0.5 text-xs font-semibold leading-none text-white bg-primary rounded-full",children:x})]})}),f.jsx(ac,{className:"w-[--radix-popover-trigger-width] p-0",style:{maxHeight:"min(40vh, 400px)",overflow:"hidden"},children:f.jsxs(Bse,{shouldFilter:!1,children:[f.jsxs("div",{className:"flex items-center border-b px-3",children:[f.jsx(Do,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),f.jsx($se,{placeholder:"Search model...",value:l,onValueChange:c,className:"flex h-10 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50 border-0 focus-visible:ring-0 focus-visible:ring-offset-0"}),f.jsxs("div",{className:"flex items-center gap-0.5 ml-auto pl-2",children:[f.jsx(mt,{variant:u.reasoning?"secondary":"ghost",size:"sm",className:Xe("h-7 w-7 p-0",u.reasoning&&"text-primary"),onClick:()=>b("reasoning"),title:"Filter: Reasoning","aria-label":"Filter by reasoning capability",children:f.jsx(CB,{className:"h-4 w-4"})}),f.jsx(mt,{variant:u.webSearch?"secondary":"ghost",size:"sm",className:Xe("h-7 w-7 p-0",u.webSearch&&"text-primary"),onClick:()=>b("webSearch"),title:"Filter: Web Search","aria-label":"Filter by web search capability",children:f.jsx(EB,{className:"h-4 w-4"})}),f.jsx(mt,{variant:u.tools?"secondary":"ghost",size:"sm",className:Xe("h-7 w-7 p-0",u.tools&&"text-primary"),onClick:()=>b("tools"),title:"Filter: Tools","aria-label":"Filter by tool usage capability",children:f.jsx(Gx,{className:"h-4 w-4"})}),f.jsx(mt,{variant:u.multimodal?"secondary":"ghost",size:"sm",className:Xe("h-7 w-7 p-0",u.multimodal&&"text-primary"),onClick:()=>b("multimodal"),title:"Filter: Multimodal","aria-label":"Filter by multimodal capability",children:f.jsx(J0,{className:"h-4 w-4"})}),f.jsx(mt,{variant:u.imageGeneration?"secondary":"ghost",size:"sm",className:Xe("h-7 w-7 p-0",u.imageGeneration&&"text-primary"),onClick:()=>b("imageGeneration"),title:"Filter: Image Generation","aria-label":"Filter by image generation capability",children:f.jsx(iC,{className:"h-4 w-4"})})]})]}),f.jsxs(zse,{className:"max-h-[calc(min(40vh,400px)-70px)] overflow-y-auto",children:[f.jsx(Use,{children:x>0?"No models match all active filters.":e.length===0?"No models available.":"No model found."}),f.jsx(qse,{children:h.map(w=>{var S,k,C,T,R,N,I,P,B,D,W,O;return f.jsx(Vse,{value:w.id,onSelect:y,className:"flex items-center",children:f.jsxs("div",{className:"flex-1 truncate flex justify-between items-center",children:[f.jsxs("div",{children:[f.jsx("div",{className:"text-sm font-medium",children:w.name}),f.jsx("div",{className:"text-xs text-muted-foreground",children:w.providerName})]}),f.jsxs("div",{className:"flex gap-1 ml-2",children:[((k=(S=w.metadataSummary)==null?void 0:S.supported_parameters)==null?void 0:k.includes("reasoning"))&&f.jsx(CB,{className:"h-3.5 w-3.5 text-purple-500"}),(((T=(C=w.metadataSummary)==null?void 0:C.supported_parameters)==null?void 0:T.includes("web_search"))||((N=(R=w.metadataSummary)==null?void 0:R.supported_parameters)==null?void 0:N.includes("web_search_options")))&&f.jsx(EB,{className:"h-3.5 w-3.5 text-blue-500"}),((P=(I=w.metadataSummary)==null?void 0:I.supported_parameters)==null?void 0:P.includes("tools"))&&f.jsx(Gx,{className:"h-3.5 w-3.5 text-orange-500"}),((D=(B=w.metadataSummary)==null?void 0:B.input_modalities)==null?void 0:D.some(Z=>Z!=="text"))&&f.jsx(J0,{className:"h-3.5 w-3.5 text-green-500"}),((O=(W=w.metadataSummary)==null?void 0:W.output_modalities)==null?void 0:O.includes("image"))&&f.jsx(iC,{className:"h-3.5 w-3.5 text-pink-500"})]})]})},w.id)})})]})]})})]})},h3=Ke({systemPrompt:ze().nullable(),modelId:ze().nullable()}),wqe=({initialSystemPrompt:e,initialModelId:t,onSave:n,effectiveSystemPrompt:r,effectiveModelId:s,isParentSaving:i=!1})=>{var u;const{getAvailableModelListItems:a}=Cr(yn(d=>({getAvailableModelListItems:d.getAvailableModelListItems}))),o=a(),l=((u=o.find(d=>d.id===s))==null?void 0:u.name)||s,c=ii({defaultValues:{systemPrompt:e??null,modelId:t??null},validators:{onChangeAsync:h3,onChangeAsyncDebounceMs:500},onSubmit:async({value:d})=>{await n({systemPrompt:d.systemPrompt,modelId:d.modelId})}});return E.useEffect(()=>{c.reset({systemPrompt:e??null,modelId:t??null})},[e,t,c]),f.jsxs("form",{onSubmit:d=>{d.preventDefault(),d.stopPropagation(),c.handleSubmit()},className:"space-y-6",children:[f.jsx(c.Field,{name:"systemPrompt",validators:{onChange:h3.shape.systemPrompt},children:d=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(Ot,{htmlFor:`${d.name}-textarea`,children:"System Prompt (Overrides Parent/Global)"}),f.jsx(Uo,{id:`${d.name}-textarea`,placeholder:`Inherited: ${(r==null?void 0:r.substring(0,100))||"Default"}${r&&r.length>100?"...":""}`,value:d.state.value??"",onChange:h=>d.handleChange(h.target.value),onBlur:d.handleBlur,rows:6,disabled:c.state.isSubmitting||i,className:"mt-1"}),f.jsx(ji,{field:d}),f.jsx(mt,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>c.setFieldValue("systemPrompt",null),disabled:c.state.isSubmitting||i||d.state.value===null,type:"button",children:"Use Inherited/Default"})]})}),f.jsx(c.Field,{name:"modelId",validators:{onChange:h3.shape.modelId},children:d=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(Ot,{children:"Default Model (Overrides Parent/Global)"}),f.jsx(WT,{models:o,value:d.state.value,onChange:h=>{d.handleChange(h),d.handleBlur()},disabled:c.state.isSubmitting||i,className:"w-full mt-1"}),f.jsx(ji,{field:d}),f.jsxs(mt,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>c.setFieldValue("modelId",null),disabled:c.state.isSubmitting||i||d.state.value===null,type:"button",children:["Use Inherited/Default (",l||"Global Default",")"]})]})}),f.jsx("div",{className:"flex justify-end pt-2",children:f.jsx(c.Subscribe,{selector:d=>[d.canSubmit,d.isSubmitting,d.isValidating,d.isValid],children:([d,h,m,y])=>f.jsxs(mt,{type:"submit",size:"sm",disabled:i||!d||h||m||!y,children:[(h||m)&&f.jsx(Xn,{className:"h-4 w-4 mr-1 animate-spin"}),f.jsx($u,{className:"h-4 w-4 mr-1"}),h||m?"Saving...":"Save Prompt Settings"]})})})]})};function l0({field:e}){return e.state.meta.isTouched&&e.state.meta.errors.length>0?f.jsx("em",{className:"text-xs text-destructive pt-1 block",children:e.state.meta.errors.join(", ")}):null}const _qe=({form:e,isSaving:t,effectiveTemperature:n,effectiveMaxTokens:r,effectiveTopP:s,effectiveTopK:i,effectivePresencePenalty:a,effectiveFrequencyPenalty:o})=>f.jsxs("div",{className:"space-y-4",children:[f.jsx(e.Field,{name:"temperature",children:l=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsxs(Ot,{htmlFor:l.name,className:"text-xs",children:["Temperature (",(l.state.value??n??.7).toFixed(2),")"]}),f.jsx(A0,{id:l.name,min:0,max:1,step:.01,value:[l.state.value??n??.7],onValueChange:c=>l.handleChange(c[0]),onBlur:l.handleBlur,disabled:t}),f.jsxs(mt,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>l.handleChange(null),disabled:t||l.state.value===null,children:["Use Inherited/Default (",(n==null?void 0:n.toFixed(2))??"N/A",")"]}),f.jsx(l0,{field:l})]})}),f.jsx(e.Field,{name:"topP",children:l=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsxs(Ot,{htmlFor:l.name,className:"text-xs",children:["Top P (",(l.state.value??s??1).toFixed(2),")"]}),f.jsx(A0,{id:l.name,min:0,max:1,step:.01,value:[l.state.value??s??1],onValueChange:c=>l.handleChange(c[0]),onBlur:l.handleBlur,disabled:t}),f.jsxs(mt,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>l.handleChange(null),disabled:t||l.state.value===null,children:["Use Inherited/Default (",(s==null?void 0:s.toFixed(2))??"N/A",")"]}),f.jsx(l0,{field:l})]})}),f.jsxs("div",{className:"grid grid-cols-2 gap-4 items-end",children:[f.jsx(e.Field,{name:"maxTokens",children:l=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(Ot,{htmlFor:l.name,className:"text-xs",children:"Max Tokens"}),f.jsx(Cn,{id:l.name,type:"number",placeholder:`Inherited: ${r??"Default"}`,value:l.state.value??"",onChange:c=>l.handleChange(c.target.value===""?null:parseInt(c.target.value,10)),onBlur:l.handleBlur,min:"1",className:"h-8 text-xs",disabled:t}),f.jsx(mt,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>l.handleChange(null),disabled:t||l.state.value===null,children:"Use Inherited/Default"}),f.jsx(l0,{field:l})]})}),f.jsx(e.Field,{name:"topK",children:l=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(Ot,{htmlFor:l.name,className:"text-xs",children:"Top K"}),f.jsx(Cn,{id:l.name,type:"number",placeholder:`Inherited: ${i??"Default"}`,value:l.state.value??"",onChange:c=>l.handleChange(c.target.value===""?null:parseInt(c.target.value,10)),onBlur:l.handleBlur,min:"1",className:"h-8 text-xs",disabled:t}),f.jsx(mt,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>l.handleChange(null),disabled:t||l.state.value===null,children:"Use Inherited/Default"}),f.jsx(l0,{field:l})]})})]}),f.jsx(e.Field,{name:"presencePenalty",children:l=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsxs(Ot,{htmlFor:l.name,className:"text-xs",children:["Presence Penalty (",(l.state.value??a??0).toFixed(2),")"]}),f.jsx(A0,{id:l.name,min:-2,max:2,step:.01,value:[l.state.value??a??0],onValueChange:c=>l.handleChange(c[0]),onBlur:l.handleBlur,disabled:t}),f.jsxs(mt,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>l.handleChange(null),disabled:t||l.state.value===null,children:["Use Inherited/Default (",(a==null?void 0:a.toFixed(2))??"N/A",")"]}),f.jsx(l0,{field:l})]})}),f.jsx(e.Field,{name:"frequencyPenalty",children:l=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsxs(Ot,{htmlFor:l.name,className:"text-xs",children:["Frequency Penalty (",(l.state.value??o??0).toFixed(2),")"]}),f.jsx(A0,{id:l.name,min:-2,max:2,step:.01,value:[l.state.value??o??0],onValueChange:c=>l.handleChange(c[0]),onBlur:l.handleBlur,disabled:t}),f.jsxs(mt,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>l.handleChange(null),disabled:t||l.state.value===null,children:["Use Inherited/Default (",(o==null?void 0:o.toFixed(2))??"N/A",")"]}),f.jsx(l0,{field:l})]})})]}),Fq=Ke({syncRepoId:ze().nullable()}),Sqe=({initialSyncRepoId:e,onSave:t,effectiveSyncRepoId:n,syncRepos:r,isParentSaving:s=!1})=>{var o;const i=((o=r.find(l=>l.id===n))==null?void 0:o.name)??"None",a=ii({defaultValues:{syncRepoId:e??null},validators:{onChangeAsync:Fq,onChangeAsyncDebounceMs:500},onSubmit:async({value:l})=>{await t(l)}});return E.useEffect(()=>{a.reset({syncRepoId:e??null})},[e,a]),f.jsxs("form",{onSubmit:l=>{l.preventDefault(),l.stopPropagation(),a.handleSubmit()},className:"space-y-6",children:[f.jsx(a.Field,{name:"syncRepoId",validators:{onChange:Fq.shape.syncRepoId},children:l=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(Ot,{htmlFor:l.name,children:"Sync Repository (Overrides Parent/Global)"}),f.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Link this project to a sync repository. All new conversations created within this project will automatically inherit this link."}),f.jsxs(tp,{value:l.state.value??"none",onValueChange:c=>{l.handleChange(c==="none"?null:c),l.handleBlur()},disabled:a.state.isSubmitting||s||r.length===0,children:[f.jsx(rp,{id:l.name,children:f.jsx(np,{placeholder:r.length===0?"No sync repos configured":`Inherited: ${i}`})}),f.jsxs(sp,{children:[f.jsx(Ro,{value:"none",children:f.jsxs("span",{className:"text-muted-foreground",children:["Use Inherited/Default (",i,")"]})}),r.map(c=>f.jsx(Ro,{value:c.id,children:c.name},c.id))]})]}),f.jsx(ji,{field:l}),f.jsx(mt,{variant:"link",size:"sm",className:"text-xs h-auto p-0 mt-1 text-muted-foreground",onClick:()=>a.setFieldValue("syncRepoId",null),disabled:a.state.isSubmitting||s||l.state.value===null,type:"button",children:"Use Inherited/Default"})]})}),f.jsx("div",{className:"flex justify-end pt-2",children:f.jsx(a.Subscribe,{selector:l=>[l.canSubmit,l.isSubmitting,l.isValidating,l.isValid],children:([l,c,u,d])=>f.jsxs(mt,{type:"submit",size:"sm",disabled:s||!l||c||u||!d||r.length===0,children:[(c||u)&&f.jsx(Xn,{className:"h-4 w-4 mr-1 animate-spin"}),f.jsx($u,{className:"h-4 w-4 mr-1"}),c||u?"Saving...":"Save Sync Settings"]})})})]})},Cqe=({projectId:e})=>{const t=E.useMemo(()=>[{value:"manage",label:"Manage Files",content:f.jsx("div",{className:"flex-grow border rounded-md overflow-hidden h-full",children:e?f.jsx(J6,{}):f.jsx("div",{className:"p-4 text-center text-muted-foreground",children:"Invalid Project ID. Cannot load filesystem."})})},{value:"settings",label:"Settings",content:f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx(Ot,{children:"Project Filesystem Info"}),f.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"Each project has its own dedicated Virtual File System (VFS)."}),f.jsxs("div",{className:"p-3 border rounded bg-muted/30 text-sm mb-2 break-all",children:[" ",f.jsxs("p",{children:[f.jsx("span",{className:"font-medium",children:"Project ID (VFS Key):"})," ",f.jsx("code",{className:"text-xs",children:e||"N/A"})]})]})]}),f.jsxs("div",{className:"border-t pt-4 border-destructive/50 mt-4 flex-shrink-0",children:[f.jsx(Ot,{className:"text-destructive",children:"Danger Zone"}),f.jsx("p",{className:"text-xs text-destructive/90 mb-2",children:"Clearing the VFS will permanently delete all files stored specifically for this project. This cannot be undone."})]})]})}],[e]);return f.jsx(oc,{tabs:t,defaultValue:"manage",className:"h-full flex flex-col",listClassName:Xe("bg-muted/50 rounded-md","flex-wrap justify-start h-auto","p-1 gap-1"),contentContainerClassName:"mt-3 flex-grow flex flex-col overflow-y-auto"})},kqe=({allRules:e,selectedRuleIds:t,onSelectionChange:n,disabled:r=!1})=>{const[s,i]=E.useState(""),a=E.useMemo(()=>{const o=s.toLowerCase();return o?e.filter(l=>l.name.toLowerCase().includes(o)||l.content.toLowerCase().includes(o)||l.type.toLowerCase().includes(o)):e},[e,s]);return f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{className:"relative",children:[f.jsx(Do,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),f.jsx(Cn,{type:"search",placeholder:"Filter rules...",value:s,onChange:o=>i(o.target.value),className:"pl-8 h-9",disabled:r})]}),f.jsx(Yl,{className:"h-48 border rounded-md p-2 bg-background/50",children:a.length===0?f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:e.length===0?"No rules defined globally.":"No rules match filter."}):f.jsx("div",{className:"space-y-1",children:a.map(o=>f.jsx("div",{className:"flex items-start justify-between p-1.5 rounded hover:bg-muted",children:f.jsxs("div",{className:"flex items-center space-x-2 flex-grow mr-2",children:[f.jsx($c,{id:`project-default-rule-${o.id}`,checked:t.has(o.id),onCheckedChange:l=>n(o.id,!!l),className:"mt-0.5",disabled:r}),f.jsxs(Ot,{htmlFor:`project-default-rule-${o.id}`,className:"text-sm font-normal cursor-pointer space-y-0.5",children:[f.jsx("span",{className:"block font-medium",children:o.name}),f.jsxs("span",{className:"block text-xs text-muted-foreground",children:["Type: ",o.type]}),f.jsxs("span",{className:"block text-xs text-muted-foreground truncate max-w-xs",children:["Content: ",o.content]})]})]})},o.id))})})]})},Eqe=({defaultRuleIds:e,setDefaultRuleIds:t,isSaving:n,allRules:r})=>{const s=E.useMemo(()=>new Set(e??[]),[e]),i=E.useCallback((a,o)=>{const l=new Set(s);o?l.add(a):l.delete(a);const c=Array.from(l);t(c.length>0?c:null)},[s,t]);return f.jsxs("div",{className:"space-y-4",children:[f.jsx(Ot,{children:"Default Rules for this Project"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Select rules that will be automatically applied to new conversations within this project. These can be overridden per-conversation or per-turn."}),f.jsx(kqe,{allRules:r,selectedRuleIds:s,onSelectionChange:i,disabled:n})]})},Tqe=({allTags:e,selectedTagIds:t,onSelectionChange:n,disabled:r=!1,getRulesForTag:s})=>{const[i,a]=E.useState(""),o=E.useMemo(()=>{const l=i.toLowerCase();return l?e.filter(c=>{var u;return c.name.toLowerCase().includes(l)||((u=c.description)==null?void 0:u.toLowerCase().includes(l))}):e},[e,i]);return f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{className:"relative",children:[f.jsx(Do,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),f.jsx(Cn,{type:"search",placeholder:"Filter tags...",value:i,onChange:l=>a(l.target.value),className:"pl-8 h-9",disabled:r})]}),f.jsx(Yl,{className:"h-48 border rounded-md p-2 bg-background/50",children:o.length===0?f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:e.length===0?"No tags defined globally.":"No tags match filter."}):f.jsx("div",{className:"space-y-1",children:o.map(l=>{const c=s(l.id);return f.jsx("div",{className:"flex items-start justify-between p-1.5 rounded hover:bg-muted",children:f.jsxs("div",{className:"flex items-center space-x-2 flex-grow mr-2",children:[f.jsx($c,{id:`project-default-tag-${l.id}`,checked:t.has(l.id),onCheckedChange:u=>n(l.id,!!u),className:"mt-0.5",disabled:r}),f.jsxs(Ot,{htmlFor:`project-default-tag-${l.id}`,className:"text-sm font-normal cursor-pointer space-y-0.5",children:[f.jsx("span",{className:"block font-medium",children:l.name}),l.description&&f.jsx("span",{className:"block text-xs text-muted-foreground",children:l.description}),c.length>0&&f.jsxs("span",{className:"block text-xs text-blue-500 dark:text-blue-400",children:["Includes: ",c.map(u=>u.name).join(", ")]})]})]})},l.id)})})})]})},Aqe=({defaultTagIds:e,setDefaultTagIds:t,isSaving:n,allTags:r,getRulesForTag:s})=>{const i=E.useMemo(()=>new Set(e??[]),[e]),a=E.useCallback((o,l)=>{const c=new Set(i);l?c.add(o):c.delete(o);const u=Array.from(c);t(u.length>0?u:null)},[i,t]);return f.jsxs("div",{className:"space-y-4",children:[f.jsx(Ot,{children:"Default Tags for this Project"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Select tags whose rules will be automatically applied to new conversations within this project. These can be overridden per-conversation or per-turn."}),f.jsx(Tqe,{allTags:r,selectedTagIds:i,onSelectionChange:a,disabled:n,getRulesForTag:s})]})},Rqe=Ke({temperature:At().min(0).max(1),topP:At().min(0).max(1),maxTokens:At().min(1).nullable(),topK:At().min(1).nullable(),presencePenalty:At().min(-2).max(2),frequencyPenalty:At().min(-2).max(2)}),Nqe=({isOpen:e,onClose:t,projectId:n,module:r})=>{const{getProjectById:s,updateProject:i}=zo(yn(U=>({getProjectById:U.getProjectById,updateProject:U.updateProject}))),a=zo(U=>U.getEffectiveProjectSettings),o=qn(U=>U.syncRepos),l=br(yn(U=>({globalSystemPrompt:U.globalSystemPrompt,temperature:U.temperature,maxTokens:U.maxTokens,topP:U.topP,topK:U.topK,presencePenalty:U.presencePenalty,frequencyPenalty:U.frequencyPenalty}))),c=Cr(U=>U.selectedModelId),u=ei(U=>U.setVfsKey),[d,h]=E.useState(null),[m,y]=E.useState(null),[b,v]=E.useState(null),[x,w]=E.useState(null),[S,k]=E.useState(null),[C,T]=E.useState(!1),[R,N]=E.useState("prompt"),{project:I,effectiveSettings:P}=E.useMemo(()=>{const U=n?s(n):null,H=n?a(n):null;return{project:U,effectiveSettings:H}},[n,s,a]),B=ii({defaultValues:{temperature:(I==null?void 0:I.temperature)??.7,topP:(I==null?void 0:I.topP)??1,maxTokens:(I==null?void 0:I.maxTokens)??null,topK:(I==null?void 0:I.topK)??null,presencePenalty:(I==null?void 0:I.presencePenalty)??0,frequencyPenalty:(I==null?void 0:I.presencePenalty)??0},validators:{onChangeAsync:Rqe,onChangeAsyncDebounceMs:500}}),D=E.useCallback(U=>{var L;if(!U)return null;const H=s(U);return H?((L=H.metadata)==null?void 0:L.syncRepoId)!==void 0?H.metadata.syncRepoId:D(H.parentId):null},[s]),W=n?D(n):null;E.useEffect(()=>{var U;e&&n&&I&&P?(u(n),h(I.systemPrompt??null),y(I.modelId??null),v(((U=I.metadata)==null?void 0:U.syncRepoId)??null),w(I.defaultTagIds??null),k(I.defaultRuleIds??null),B.reset({temperature:I.temperature??.7,topP:I.topP??1,maxTokens:I.maxTokens??null,topK:I.topK??null,presencePenalty:I.presencePenalty??0,frequencyPenalty:I.frequencyPenalty??0}),N("prompt")):e||(u(null),h(null),y(null),v(null),w(null),k(null),B.reset({temperature:.7,topP:1,maxTokens:null,topK:null,presencePenalty:0,frequencyPenalty:0}))},[e,n,I,P,u,B]);const O=async()=>{if(!(!n||!I)){T(!0);try{const U=I.parentId?a(I.parentId):{systemPrompt:l.globalSystemPrompt,modelId:c,temperature:l.temperature,maxTokens:l.maxTokens,topP:l.topP,topK:l.topK,presencePenalty:l.presencePenalty,frequencyPenalty:l.frequencyPenalty,defaultTagIds:null,defaultRuleIds:null},H=I.parentId?D(I.parentId):null,L={},te={...I.metadata??{}},V=B.state.values;d!==U.systemPrompt?L.systemPrompt=d:L.systemPrompt=void 0,m!==U.modelId?L.modelId=m:L.modelId=void 0,V.temperature!==U.temperature?L.temperature=V.temperature:L.temperature=void 0,V.maxTokens!==U.maxTokens?L.maxTokens=V.maxTokens:L.maxTokens=void 0,V.topP!==U.topP?L.topP=V.topP:L.topP=void 0,V.topK!==U.topK?L.topK=V.topK:L.topK=void 0,V.presencePenalty!==U.presencePenalty?L.presencePenalty=V.presencePenalty:L.presencePenalty=void 0,V.frequencyPenalty!==U.frequencyPenalty?L.frequencyPenalty=V.frequencyPenalty:L.frequencyPenalty=void 0,b!==H?te.syncRepoId=b:delete te.syncRepoId,JSON.stringify(x)!==JSON.stringify(U.defaultTagIds)?L.defaultTagIds=x:L.defaultTagIds=void 0,JSON.stringify(S)!==JSON.stringify(U.defaultRuleIds)?L.defaultRuleIds=S:L.defaultRuleIds=void 0,L.metadata=te,await i(n,L),Me.success(`Project "${I.name}" settings updated.`),t()}catch(U){Me.error("Failed to save project settings."),console.error("Failed to save project settings:",U)}finally{T(!1)}}},Z=E.useMemo(()=>[{value:"prompt",label:"Prompt & Model",content:f.jsx(wqe,{initialSystemPrompt:d,initialModelId:m,onSave:({systemPrompt:U,modelId:H})=>{h(U),y(H)},effectiveSystemPrompt:(P==null?void 0:P.systemPrompt)??l.globalSystemPrompt,effectiveModelId:(P==null?void 0:P.modelId)??c,isParentSaving:C})},{value:"params",label:"Parameters",content:f.jsx(_qe,{form:B,effectiveTemperature:(P==null?void 0:P.temperature)??l.temperature,effectiveMaxTokens:(P==null?void 0:P.maxTokens)??l.maxTokens,effectiveTopP:(P==null?void 0:P.topP)??l.topP??1,effectiveTopK:(P==null?void 0:P.topK)??l.topK,effectivePresencePenalty:(P==null?void 0:P.presencePenalty)??l.presencePenalty??0,effectiveFrequencyPenalty:(P==null?void 0:P.frequencyPenalty)??l.frequencyPenalty??0,isSaving:C})},{value:"rules-tags",label:"Rules & Tags",content:f.jsxs("div",{className:"space-y-6",children:[f.jsx(Eqe,{defaultRuleIds:S,setDefaultRuleIds:k,isSaving:C,allRules:r.getAllRules()}),f.jsx(Aqe,{defaultTagIds:x,setDefaultTagIds:w,isSaving:C,allTags:r.getAllTags(),getRulesForTag:r.getRulesForTag})]})},{value:"sync",label:"Sync",content:f.jsx(Sqe,{initialSyncRepoId:b,onSave:({syncRepoId:U})=>{v(U)},effectiveSyncRepoId:W,syncRepos:o,isParentSaving:C})},{value:"vfs",label:"Filesystem",content:f.jsx(Cqe,{projectId:n,projectName:(I==null?void 0:I.name)??null,isSaving:C})}],[d,m,b,x,S,B,P,l,c,C,W,o,n,I==null?void 0:I.name,r]);return f.jsx(op,{open:e,onOpenChange:t,children:f.jsxs(lp,{className:Xe("w-[95vw] h-[85vh] flex flex-col p-0","sm:w-[90vw] sm:max-w-[800px]","md:h-[75vh]","min-h-[500px] max-h-[90vh]"),children:[f.jsxs(cp,{className:"p-4 md:p-6 pb-2 md:pb-4 flex-shrink-0",children:[f.jsxs(up,{children:["Project Settings: ",I==null?void 0:I.name]}),f.jsx(eg,{children:"Configure default settings for this project. Settings inherit from parent projects or global defaults if not set here."})]}),f.jsx(oc,{tabs:Z,initialValue:R,onValueChange:N,className:"flex-grow overflow-hidden px-4 md:px-6",listClassName:"-mx-4 md:-mx-6 px-2 md:px-6 py-1 md:py-0",contentContainerClassName:"pb-4 md:pb-6 overflow-y-auto",scrollable:!1}),f.jsxs(gb,{className:"flex-shrink-0 border-t p-4 md:p-6 pt-3 md:pt-4 mt-auto",children:[f.jsx(mt,{variant:"outline",onClick:t,disabled:C,children:"Cancel"}),f.jsxs(mt,{onClick:O,disabled:C,children:[C&&f.jsx(Xn,{className:"mr-2 h-4 w-4 animate-spin"}),"Save Project Settings"]})]})]})})};class Mqe{constructor(){de(this,"id","core-project-settings");de(this,"modalId","projectSettingsModal");de(this,"unregisterModalProviderCallback",null);de(this,"modApiRef",null);de(this,"eventUnsubscribers",[]);de(this,"allRules",[]);de(this,"allTags",[]);de(this,"tagRuleLinks",[]);de(this,"getAllRules",()=>this.allRules);de(this,"getAllTags",()=>this.allTags);de(this,"getRulesForTag",t=>{const n=new Set(this.tagRuleLinks.filter(r=>r.tagId===t).map(r=>r.ruleId));return this.allRules.filter(r=>n.has(r.id))});de(this,"openModal",(t,n)=>{var r;(r=this.modApiRef)==null||r.emit(Or.openModalRequest,{modalId:this.modalId,targetId:t,initialTab:n})});de(this,"closeModal",()=>{var t;(t=this.modApiRef)==null||t.emit(Or.closeModalRequest,{modalId:this.modalId})})}async initialize(t){this.modApiRef=t;const n=t.on(yr.dataLoaded,r=>{r&&(this.allRules=r.rules||[],this.allTags=r.tags||[],this.tagRuleLinks=(r.links||[]).map(s=>({tagId:s.tagId,ruleId:s.ruleId})))});this.eventUnsubscribers.push(n),t.emit(yr.loadRulesAndTagsRequest,void 0),console.log(`[${this.id}] Initialized.`)}register(t){if(this.modApiRef=t,this.unregisterModalProviderCallback){console.warn(`[${this.id}] Modal provider already registered. Skipping.`);return}this.unregisterModalProviderCallback=t.registerModalProvider(this.modalId,n=>Ve.createElement(Nqe,{isOpen:n.isOpen,onClose:n.onClose,projectId:n.targetId||null,module:this})),console.log(`[${this.id}] Modal provider registered for ${this.modalId}.`)}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterModalProviderCallback&&(this.unregisterModalProviderCallback(),this.unregisterModalProviderCallback=null),this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const eF=Ve.memo(({module:e,value:t,onChange:n,className:r,disabled:s})=>{const[,i]=E.useState({});E.useEffect(()=>{if(e)return e.setNotifyCallback(()=>i({})),()=>e.setNotifyCallback(null)},[e]);const a=!!e,o=a?e.selectedModelId:t,l=a?e.isStreaming:s,c=a?e.isLoadingProviders:!1,u=a?e.globallyEnabledModels:Cr(h=>h.getGloballyEnabledModelDefinitions()),d=E.useCallback(h=>{a&&e?e.handleSelectionChange(h):n&&n(h)},[a,e,n]);return f.jsx(WT,{models:u,value:o,onChange:d,className:r,disabled:l,isLoading:c})});eF.displayName="GlobalModelSelector";class Iqe{constructor(){de(this,"id","core-global-model-selector");de(this,"unregisterCallback",null);de(this,"eventUnsubscribers",[]);de(this,"modApiRef",null);de(this,"selectedModelId",null);de(this,"isStreaming",!1);de(this,"isLoadingProviders",!0);de(this,"globallyEnabledModels",[]);de(this,"notifyComponentUpdate",null);de(this,"handleSelectionChange",t=>{var n,r;(n=this.modApiRef)==null||n.emit(Qn.selectModelRequest,{modelId:t}),(r=this.modApiRef)==null||r.emit(gn.setModelIdRequest,{id:t})});de(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){this.modApiRef=t;const n=Cr.getState();this.isLoadingProviders=n.isLoading,this.selectedModelId=n.selectedModelId,this.isStreaming=vn.getState().status==="streaming",this.isLoadingProviders||(this.globallyEnabledModels=n.getGloballyEnabledModelDefinitions());const r=t.on(Zn.statusChanged,o=>{var l;if(typeof o=="object"&&o&&"status"in o){const c=o.status==="streaming";this.isStreaming!==c&&(this.isStreaming=c,(l=this.notifyComponentUpdate)==null||l.call(this))}}),s=t.on(Qn.selectedModelChanged,o=>{var l,c;typeof o=="object"&&o&&"modelId"in o&&this.selectedModelId!==o.modelId&&(this.selectedModelId=o.modelId,(l=this.modApiRef)==null||l.emit(gn.setModelIdRequest,{id:o.modelId}),(c=this.notifyComponentUpdate)==null||c.call(this))}),i=t.on(Qn.globallyEnabledModelsUpdated,o=>{var d,h;let l=!1;JSON.stringify(this.globallyEnabledModels)!==JSON.stringify(o.models)&&(this.globallyEnabledModels=o.models,l=!0);const c=Cr.getState().isLoading;this.isLoadingProviders!==c&&(this.isLoadingProviders=c,l=!0);const u=Cr.getState().selectedModelId;this.selectedModelId!==u&&(this.selectedModelId=u,(d=this.modApiRef)==null||d.emit(gn.setModelIdRequest,{id:this.selectedModelId}),l=!0),l&&((h=this.notifyComponentUpdate)==null||h.call(this))}),a=t.on(Qn.initialDataLoaded,()=>{var u,d;const o=Cr.getState();let l=!1;this.isLoadingProviders!==o.isLoading&&(this.isLoadingProviders=o.isLoading,l=!0),this.selectedModelId!==o.selectedModelId&&(this.selectedModelId=o.selectedModelId,(u=this.modApiRef)==null||u.emit(gn.setModelIdRequest,{id:this.selectedModelId}),l=!0);const c=o.getGloballyEnabledModelDefinitions();JSON.stringify(this.globallyEnabledModels)!==JSON.stringify(c)&&(this.globallyEnabledModels=c,l=!0),l&&((d=this.notifyComponentUpdate)==null||d.call(this))});this.eventUnsubscribers.push(r,s,i,a)}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>this.isLoadingProviders?"loading":"ready",triggerRenderer:()=>Ve.createElement(eF,{module:this})})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const jqe=({module:e})=>{const[,t]=E.useState({});E.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const[n,r]=E.useState(!1),[s,i]=E.useState(e.getTurnSystemPrompt()),a=e.getEffectiveSystemPrompt(),o=e.getIsStreaming(),l=e.getTurnSystemPrompt();E.useEffect(()=>{n&&i(e.getTurnSystemPrompt())},[n,e]);const c=E.useCallback(()=>{e.setTurnSystemPrompt(s.trim()),r(!1)},[s,e]),u=E.useCallback(()=>{i(""),e.setTurnSystemPrompt(""),r(!1)},[e]),d=m=>{m&&i(e.getTurnSystemPrompt()),r(m)},h=l.trim().length>0;return f.jsxs(sc,{open:n,onOpenChange:d,children:[f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(ic,{asChild:!0,children:f.jsx(mt,{variant:h?"secondary":"ghost",size:"icon",className:"h-8 w-8",disabled:o,"aria-label":"Set System Prompt for Next Turn",children:f.jsx(Uge,{className:"h-4 w-4"})})})}),f.jsx(Sr,{side:"top",children:h?"System Prompt Override Active":"Set System Prompt (Next Turn)"})]})}),f.jsxs(ac,{className:"w-80 p-4 space-y-3",align:"start",children:[f.jsx(Ot,{htmlFor:"turn-system-prompt",children:"System Prompt (Overrides Project/Global for Next Turn)"}),f.jsx(Uo,{id:"turn-system-prompt",placeholder:`Inherited: ${(a==null?void 0:a.substring(0,50))||"Default"}${a&&a.length>50?"...":""}`,value:s,onChange:m=>i(m.target.value),rows:5,className:"text-sm"}),f.jsxs("div",{className:"flex justify-between",children:[f.jsx(mt,{variant:"outline",size:"sm",onClick:u,disabled:!s.trim(),children:"Clear Override"}),f.jsx(mt,{size:"sm",onClick:c,children:"Set for Next Turn"})]})]})]})};class Oqe{constructor(){de(this,"id","core-system-prompt");de(this,"unregisterCallback",null);de(this,"eventUnsubscribers",[]);de(this,"modApiRef",null);de(this,"turnSystemPromptValue","");de(this,"effectiveSystemPrompt",null);de(this,"isStreaming",!1);de(this,"notifyComponentUpdate",null);de(this,"getTurnSystemPrompt",()=>this.turnSystemPromptValue);de(this,"getEffectiveSystemPrompt",()=>this.effectiveSystemPrompt);de(this,"getIsStreaming",()=>this.isStreaming);de(this,"setTurnSystemPrompt",t=>{var n;this.turnSystemPromptValue!==t&&(this.turnSystemPromptValue=t,(n=this.notifyComponentUpdate)==null||n.call(this))});de(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){this.modApiRef=t,this.isStreaming=vn.getState().status==="streaming",this.updateEffectivePrompt();const n=t.on(Zn.statusChanged,a=>{var o;typeof a=="object"&&a&&"status"in a&&this.isStreaming!==(a.status==="streaming")&&(this.isStreaming=a.status==="streaming",(o=this.notifyComponentUpdate)==null||o.call(this))}),r=t.on(Or.contextChanged,()=>{var a;this.updateEffectivePrompt(),(a=this.notifyComponentUpdate)==null||a.call(this)}),s=t.on(_a.updated,()=>{var a;this.updateEffectivePrompt(),(a=this.notifyComponentUpdate)==null||a.call(this)}),i=t.on(sn.globalSystemPromptChanged,()=>{var a;this.updateEffectivePrompt(),(a=this.notifyComponentUpdate)==null||a.call(this)});this.eventUnsubscribers.push(n,r,s,i)}updateEffectivePrompt(){var a;const t=qn.getState(),n=zo.getState(),r=br.getState(),s=t.selectedItemType==="project"?t.selectedItemId:t.selectedItemType==="conversation"?((a=t.getConversationById(t.selectedItemId))==null?void 0:a.projectId)??null:null,i=n.getEffectiveProjectSettings(s).systemPrompt??r.globalSystemPrompt;this.effectiveSystemPrompt!==i&&(this.effectiveSystemPrompt=i)}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>Ve.createElement(jqe,{module:this}),getMetadata:()=>{const n=this.turnSystemPromptValue.trim();return n?{turnSystemPrompt:n}:void 0},clearOnSubmit:()=>{var n;this.turnSystemPromptValue!==""&&(this.turnSystemPromptValue="",(n=this.notifyComponentUpdate)==null||n.call(this))}})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const Pqe=({module:e})=>{const[,t]=E.useState({});E.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const n=e.getStructuredOutputJson(),[r,s]=E.useState(!1),[i,a]=E.useState(n??""),[o,l]=E.useState(""),[c,u]=E.useState([]),d=E.useCallback(()=>{try{JSON.parse(i),e.setStructuredOutputJson(i.trim()||null),s(!1),Me.success("Structured output applied for next turn.")}catch{Me.error("Invalid JSON format.")}},[i,e]),h=E.useCallback(()=>{a(""),e.setStructuredOutputJson(null),s(!1),Me.info("Structured output cleared.")},[e]),m=E.useCallback(()=>{if(!o.trim()){Me.error("Please provide a name to save to the library.");return}try{JSON.parse(i);const w={id:Date.now().toString(),name:o.trim(),json:i};u(S=>[...S,w]),l(""),Me.success(`"${w.name}" saved to library.`)}catch{Me.error("Cannot save invalid JSON to library.")}},[i,o]),y=E.useCallback(w=>{a(w.json),e.setStructuredOutputJson(w.json),s(!1),Me.success(`Loaded "${w.name}" from library.`)},[e]),b=E.useCallback(w=>{u(S=>S.filter(k=>k.id!==w)),Me.info("Item removed from library.")},[]);E.useEffect(()=>{r&&a(e.getStructuredOutputJson()??"")},[r,e]);const v=[{value:"entry",label:"Entry",content:f.jsxs("div",{className:"space-y-3 p-1",children:[f.jsx(Ot,{htmlFor:"structured-output-entry",children:"JSON Output Schema"}),f.jsx(Uo,{id:"structured-output-entry",placeholder:'e.g., {"type": "object", "properties": {"name": {"type": "string"}}}',value:i,onChange:w=>a(w.target.value),rows:8,className:"font-mono text-xs"}),f.jsxs("div",{className:"flex justify-between items-end gap-2",children:[f.jsxs("div",{className:"flex-grow space-y-1",children:[f.jsx(Ot,{htmlFor:"structured-output-name",className:"text-xs",children:"Save to Library (Optional Name)"}),f.jsx(Cn,{id:"structured-output-name",value:o,onChange:w=>l(w.target.value),placeholder:"Schema Name",className:"h-8 text-xs"})]}),f.jsxs(mt,{size:"sm",variant:"outline",onClick:m,disabled:!o.trim()||!i.trim(),className:"h-8",children:[f.jsx($u,{className:"h-3.5 w-3.5 mr-1"})," Save"]})]}),f.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[f.jsx(mt,{variant:"outline",size:"sm",onClick:h,disabled:!n,children:"Clear Applied Schema"}),f.jsx(mt,{size:"sm",onClick:d,disabled:!i,children:"Apply for Next Turn"})]})]})},{value:"library",label:"Library",content:f.jsx("div",{className:"space-y-2 p-1",children:c.length===0?f.jsx("p",{className:"text-xs text-muted-foreground text-center py-4",children:"No saved schemas yet."}):c.map(w=>f.jsxs("div",{className:"flex items-center justify-between p-2 border rounded hover:bg-muted/50",children:[f.jsx("span",{className:"text-sm font-medium truncate flex-grow mr-2",children:w.name}),f.jsxs("div",{className:"flex gap-1 flex-shrink-0",children:[f.jsx(mt,{size:"sm",variant:"outline",onClick:()=>y(w),className:"h-7 px-2 text-xs",children:"Use"}),f.jsx(mt,{size:"icon",variant:"ghost",onClick:()=>b(w.id),className:"h-7 w-7 text-destructive",children:f.jsx(Mo,{className:"h-3.5 w-3.5"})})]})]},w.id))})}],x=!!n;return f.jsxs(sc,{open:r,onOpenChange:s,children:[f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(ic,{asChild:!0,children:f.jsx(mt,{variant:x?"secondary":"ghost",size:"icon",className:"h-8 w-8","aria-label":"Set Structured Output",children:f.jsx(mE,{className:"h-4 w-4"})})})}),f.jsx(Sr,{side:"top",children:x?"Structured Output Active":"Set Structured Output (JSON Schema)"})]})}),f.jsx(ac,{className:"w-[450px] p-0",align:"start",children:f.jsx(oc,{tabs:v,defaultValue:"entry"})})]})},Dqe=({module:e})=>{const[,t]=E.useState({});return E.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]),e.getIsVisible()?f.jsx(Pqe,{module:e}):null};class Fqe{constructor(){de(this,"id","core-structured-output");de(this,"unregisterCallback",null);de(this,"eventUnsubscribers",[]);de(this,"modApiRef",null);de(this,"structuredOutputJson",null);de(this,"isVisible",!0);de(this,"notifyComponentUpdate",null);de(this,"getStructuredOutputJson",()=>this.structuredOutputJson);de(this,"getIsVisible",()=>this.isVisible);de(this,"setStructuredOutputJson",t=>{var n,r;this.structuredOutputJson=t,(n=this.modApiRef)==null||n.emit(gn.setStructuredOutputJsonRequest,{json:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});de(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){var s;this.modApiRef=t,this.structuredOutputJson=Fo.getState().structuredOutputJson,this.updateVisibility(),(s=this.notifyComponentUpdate)==null||s.call(this);const n=t.on(Qn.selectedModelChanged,()=>{var i;this.updateVisibility(),(i=this.notifyComponentUpdate)==null||i.call(this)}),r=t.on(gn.parameterChanged,i=>{var a;if(typeof i=="object"&&i&&"params"in i){const o=i.params;"structuredOutputJson"in o&&this.structuredOutputJson!==(o.structuredOutputJson??null)&&(this.structuredOutputJson=o.structuredOutputJson??null,(a=this.notifyComponentUpdate)==null||a.call(this))}});this.eventUnsubscribers.push(n,r)}updateVisibility(){var i;const{getSelectedModel:t}=Cr.getState(),n=t(),r=(i=n==null?void 0:n.metadata)==null?void 0:i.supported_parameters,s=Array.isArray(r)&&r.includes("structured_output");this.isVisible!==s&&(this.isVisible=s)}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>Ve.createElement(Dqe,{module:this}),getParameters:()=>{if(this.structuredOutputJson)try{return{structured_output:JSON.parse(this.structuredOutputJson)}}catch(n){console.error("Invalid JSON in structured output state:",n);return}},clearOnSubmit:()=>{var n;(n=this.modApiRef)==null||n.emit(gn.setStructuredOutputJsonRequest,{json:null})}})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const Lqe=({module:e})=>{const[,t]=E.useState({});E.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const n=e.contextLength,r=e.getEstimatedInputTokens(),s=e.getTotalEstimatedTokens(),i=e.getContextPercentage(),a=e.historyTokens,o=e.selectedModelId,l=E.useMemo(()=>i>85?"text-red-600 dark:text-red-500":i>70?"text-orange-500 dark:text-orange-400":i>40?"text-yellow-500 dark:text-yellow-400":"text-green-600 dark:text-green-500",[i]);if(!(o!==null&&n>0))return null;const u=`Context: ~${s.toLocaleString()} / ${n.toLocaleString()} tokens (${i}%) [History: ${a}, Input: ${r}]`;return f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx("div",{className:"flex items-center justify-center h-8 w-8 px-2",children:f.jsx(qpe,{className:Xe("h-3 w-3 fill-current",l)})})}),f.jsx(Sr,{side:"top",children:u})]})})},Wse=4,Bqe=e=>{let t=0;return e.forEach(n=>{var r,s,i,a;(r=n.prompt)!=null&&r.content&&(t+=new TextEncoder().encode(n.prompt.content).length),(a=(i=(s=n.prompt)==null?void 0:s.metadata)==null?void 0:i.attachedFiles)==null||a.forEach(o=>{t+=o.size}),n.response&&typeof n.response=="string"&&(t+=new TextEncoder().encode(n.response).length)}),Math.ceil(t/Wse)};class $qe{constructor(){de(this,"id","core-usage-display");de(this,"unregisterCallback",null);de(this,"eventUnsubscribers",[]);de(this,"currentInputText","");de(this,"historyTokens",0);de(this,"attachedFiles",[]);de(this,"selectedModelId",null);de(this,"contextLength",0);de(this,"notifyComponentUpdate",null);de(this,"getEstimatedInputTokens",()=>{const t=new TextEncoder().encode(this.currentInputText).length,n=this.attachedFiles.reduce((r,s)=>r+s.size,0);return Math.ceil((t+n)/Wse)});de(this,"getTotalEstimatedTokens",()=>this.historyTokens+this.getEstimatedInputTokens());de(this,"getContextPercentage",()=>this.contextLength?Math.min(100,Math.round(this.getTotalEstimatedTokens()/this.contextLength*100)):0);de(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){this.loadInitialState(),this.updateContextLength();const n=t.on(gn.inputChanged,o=>{var l;typeof o=="object"&&o&&"value"in o&&(this.currentInputText=o.value,(l=this.notifyComponentUpdate)==null||l.call(this))}),r=t.on(Ul.attachedFilesChanged,o=>{var l;typeof o=="object"&&o&&"files"in o&&(this.attachedFiles=o.files,(l=this.notifyComponentUpdate)==null||l.call(this))}),s=t.on(Qn.selectedModelChanged,o=>{var l;typeof o=="object"&&o&&"modelId"in o&&(this.selectedModelId=o.modelId,this.updateContextLength(),(l=this.notifyComponentUpdate)==null||l.call(this))}),i=t.on(Zn.completed,()=>{var o;this.updateHistoryTokens(),(o=this.notifyComponentUpdate)==null||o.call(this)}),a=t.on(Or.contextChanged,()=>{var o;this.updateHistoryTokens(),(o=this.notifyComponentUpdate)==null||o.call(this)});this.eventUnsubscribers.push(n,r,s,i,a),console.log(`[${this.id}] Initialized.`)}loadInitialState(){const t=bh.getState(),n=Cr.getState();this.attachedFiles=t.attachedFilesMetadata,this.selectedModelId=n.selectedModelId,this.updateHistoryTokens()}updateHistoryTokens(){const t=vn.getState();if(t.currentConversationId){const n=t.interactions.filter(r=>r.status==="COMPLETED");this.historyTokens=Bqe(n)}else this.historyTokens=0}updateContextLength(){var c;if(!this.selectedModelId){this.contextLength=0;return}const{dbProviderConfigs:t,dbApiKeys:n}=Cr.getState(),{providerId:r,modelId:s}=Tc(this.selectedModelId);if(!r||!s){this.contextLength=0;return}const i=t.find(u=>u.id===r);if(!i){this.contextLength=0;return}const a=n.find(u=>u.id===i.apiKeyId),o=DG(i,s,a==null?void 0:a.value),l=o==null?void 0:o.metadata;this.contextLength=((c=l==null?void 0:l.top_provider)==null?void 0:c.context_length)??(l==null?void 0:l.context_length)??0}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>Ve.createElement(Lqe,{module:this})}),console.log(`[${this.id}] Registered.`)}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,console.log(`[${this.id}] Destroyed.`)}}const zqe=({module:e})=>{const[,t]=E.useState({});E.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const n=e.getReasoningEnabled(),r=e.getIsStreaming(),s=e.getIsVisible(),i=n===!0,a=E.useCallback(()=>{const o=i?null:!0;e.setReasoningEnabled(o)},[i,e]);return s?f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(mt,{variant:i?"secondary":"ghost",size:"icon",className:"h-8 w-8",onClick:a,disabled:r,"aria-label":i?"Disable Reasoning for Next Turn":"Enable Reasoning for Next Turn",children:f.jsx(Uy,{className:Xe("h-4 w-4",i?"text-primary":"text-muted-foreground")})})}),f.jsx(Sr,{side:"top",children:i?"Reasoning Enabled (Click to Disable)":"Reasoning Disabled (Click to Enable)"})]})}):null};class Uqe{constructor(){de(this,"id","core-reasoning");de(this,"unregisterCallback",null);de(this,"eventUnsubscribers",[]);de(this,"modApiRef",null);de(this,"reasoningEnabled",null);de(this,"isStreaming",!1);de(this,"isVisible",!0);de(this,"notifyComponentUpdate",null);de(this,"getReasoningEnabled",()=>this.reasoningEnabled);de(this,"getIsStreaming",()=>this.isStreaming);de(this,"getIsVisible",()=>this.isVisible);de(this,"setReasoningEnabled",t=>{var n,r;this.reasoningEnabled=t,(n=this.modApiRef)==null||n.emit(gn.setReasoningEnabledRequest,{enabled:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});de(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){var i;this.modApiRef=t,this.reasoningEnabled=Fo.getState().reasoningEnabled,this.isStreaming=vn.getState().status==="streaming",this.updateVisibility(),(i=this.notifyComponentUpdate)==null||i.call(this);const n=t.on(Zn.statusChanged,a=>{var o;typeof a=="object"&&a&&"status"in a&&this.isStreaming!==(a.status==="streaming")&&(this.isStreaming=a.status==="streaming",(o=this.notifyComponentUpdate)==null||o.call(this))}),r=t.on(Qn.selectedModelChanged,()=>{var a;this.updateVisibility(),(a=this.notifyComponentUpdate)==null||a.call(this)}),s=t.on(gn.parameterChanged,a=>{var o;if(typeof a=="object"&&a&&"params"in a){const l=a.params;"reasoningEnabled"in l&&this.reasoningEnabled!==l.reasoningEnabled&&(this.reasoningEnabled=l.reasoningEnabled??null,(o=this.notifyComponentUpdate)==null||o.call(this))}});this.eventUnsubscribers.push(n,r,s)}updateVisibility(){var s,i;const{getSelectedModel:t}=Cr.getState(),n=t(),r=((i=(s=n==null?void 0:n.metadata)==null?void 0:s.supported_parameters)==null?void 0:i.includes("reasoning"))??!1;this.isVisible!==r&&(this.isVisible=r)}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>Ve.createElement(zqe,{module:this}),getMetadata:()=>this.reasoningEnabled===!0?{reasoningEnabled:!0}:void 0,clearOnSubmit:()=>{var n;(n=this.modApiRef)==null||n.emit(gn.setReasoningEnabledRequest,{enabled:null})}})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const qqe=({module:e})=>{const[,t]=E.useState({});E.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const n=e.getWebSearchEnabled(),r=e.getIsStreaming(),s=e.getIsVisible(),i=n===!0,a=E.useCallback(()=>{const o=i?null:!0;e.setWebSearchEnabled(o)},[i,e]);return s?f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(mt,{variant:i?"secondary":"ghost",size:"icon",className:"h-8 w-8",onClick:a,disabled:r,"aria-label":i?"Disable Web Search for Next Turn":"Enable Web Search for Next Turn",children:f.jsx(Do,{className:Xe("h-4 w-4",i?"text-primary":"text-muted-foreground")})})}),f.jsx(Sr,{side:"top",children:i?"Web Search Enabled (Click to Disable)":"Web Search Disabled (Click to Enable)"})]})}):null};class Vqe{constructor(){de(this,"id","core-web-search");de(this,"unregisterCallback",null);de(this,"eventUnsubscribers",[]);de(this,"modApiRef",null);de(this,"webSearchEnabled",null);de(this,"isStreaming",!1);de(this,"isVisible",!0);de(this,"notifyComponentUpdate",null);de(this,"getWebSearchEnabled",()=>this.webSearchEnabled);de(this,"getIsStreaming",()=>this.isStreaming);de(this,"getIsVisible",()=>this.isVisible);de(this,"setWebSearchEnabled",t=>{var n,r;this.webSearchEnabled=t,(n=this.modApiRef)==null||n.emit(gn.setWebSearchEnabledRequest,{enabled:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});de(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){var i;this.modApiRef=t,this.webSearchEnabled=Fo.getState().webSearchEnabled,this.isStreaming=vn.getState().status==="streaming",this.updateVisibility(),(i=this.notifyComponentUpdate)==null||i.call(this);const n=t.on(Zn.statusChanged,a=>{var o;typeof a=="object"&&a&&"status"in a&&this.isStreaming!==(a.status==="streaming")&&(this.isStreaming=a.status==="streaming",(o=this.notifyComponentUpdate)==null||o.call(this))}),r=t.on(Qn.selectedModelChanged,()=>{var a;this.updateVisibility(),(a=this.notifyComponentUpdate)==null||a.call(this)}),s=t.on(gn.parameterChanged,a=>{var o;if(typeof a=="object"&&a&&"params"in a){const l=a.params;"webSearchEnabled"in l&&this.webSearchEnabled!==l.webSearchEnabled&&(this.webSearchEnabled=l.webSearchEnabled??null,(o=this.notifyComponentUpdate)==null||o.call(this))}});this.eventUnsubscribers.push(n,r,s)}updateVisibility(){var i;const{getSelectedModel:t}=Cr.getState(),n=t(),r=((i=n==null?void 0:n.metadata)==null?void 0:i.supported_parameters)??[],s=r.includes("web_search")||r.includes("web_search_options");this.isVisible!==s&&(this.isVisible=s)}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>Ve.createElement(qqe,{module:this}),getParameters:()=>this.webSearchEnabled===!0?{web_search:!0}:void 0,clearOnSubmit:()=>{var n;(n=this.modApiRef)==null||n.emit(gn.setWebSearchEnabledRequest,{enabled:null})}})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const Hse=({activeTagIds:e,activeRuleIds:t,onToggleTag:n,onToggleRule:r,allRules:s,allTags:i,getRulesForTag:a})=>{const[o,l]=E.useState(""),[c,u]=E.useState(""),d=E.useMemo(()=>{const w=o.toLowerCase();return w?i.filter(S=>{var k;return S.name.toLowerCase().includes(w)||((k=S.description)==null?void 0:k.toLowerCase().includes(w))}):i},[i,o]),h=E.useMemo(()=>{const w=c.toLowerCase();return w?s.filter(S=>S.name.toLowerCase().includes(w)||S.content.toLowerCase().includes(w)||S.type.toLowerCase().includes(w)):s},[s,c]),m=E.useCallback((w,S)=>{n(w,S)},[n]),y=E.useCallback((w,S)=>{r(w,S)},[r]),b=()=>f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{className:"relative",children:[f.jsx(Do,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),f.jsx(Cn,{type:"search",placeholder:"Filter tags...",value:o,onChange:w=>l(w.target.value),className:"pl-8 h-9"})]}),f.jsx("div",{className:"border rounded-md p-2 bg-background/50",children:d.length===0?f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:i.length===0?"No tags defined.":"No tags match filter."}):f.jsx("div",{className:"space-y-1",children:d.map(w=>{const S=a(w.id);return f.jsx("div",{className:"flex items-start justify-between p-1.5 rounded hover:bg-muted",children:f.jsxs("div",{className:"flex items-center space-x-2 flex-grow mr-2",children:[f.jsx($c,{id:`tag-activate-${w.id}`,checked:e.has(w.id),onCheckedChange:k=>m(w.id,!!k),className:"mt-0.5"}),f.jsxs(Ot,{htmlFor:`tag-activate-${w.id}`,className:"text-sm font-normal cursor-pointer space-y-0.5",children:[f.jsx("span",{className:"block font-medium",children:w.name}),w.description&&f.jsx("span",{className:"block text-xs text-muted-foreground",children:w.description}),S.length>0&&f.jsxs("span",{className:"block text-xs text-blue-500 dark:text-blue-400",children:["Includes: ",S.map(k=>k.name).join(", ")]})]})]})},w.id)})})})]}),v=()=>f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{className:"relative",children:[f.jsx(Do,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),f.jsx(Cn,{type:"search",placeholder:"Filter rules...",value:c,onChange:w=>u(w.target.value),className:"pl-8 h-9"})]}),f.jsx("div",{className:"border rounded-md p-2 bg-background/50",children:h.length===0?f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:s.length===0?"No rules defined.":"No rules match filter."}):f.jsx("div",{className:"space-y-1",children:h.map(w=>f.jsx("div",{className:"flex items-start justify-between p-1.5 rounded hover:bg-muted",children:f.jsxs("div",{className:"flex items-center space-x-2 flex-grow mr-2",children:[f.jsx($c,{id:`rule-activate-${w.id}`,checked:t.has(w.id),onCheckedChange:S=>y(w.id,!!S),className:"mt-0.5"}),f.jsxs(Ot,{htmlFor:`rule-activate-${w.id}`,className:"text-sm font-normal cursor-pointer space-y-0.5",children:[f.jsx("span",{className:"block font-medium",children:w.name}),f.jsxs("span",{className:"block text-xs text-muted-foreground",children:["Type: ",w.type]}),f.jsxs("span",{className:"block text-xs text-muted-foreground truncate max-w-xs",children:["Content: ",w.content]})]})]})},w.id))})})]}),x=[{value:"tags",label:"Activate Tags",content:b()},{value:"rules",label:"Activate Rules",content:v()}];return f.jsx("div",{className:"p-0 max-w-lg",children:f.jsx(oc,{tabs:x,defaultValue:"tags",scrollable:!1})})},Wqe=({module:e})=>{const[,t]=E.useState({});E.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const[n,r]=E.useState(!1),s=e.getActiveTagIds(),i=e.getActiveRuleIds(),a=e.getIsStreaming(),o=e.getHasRulesOrTags(),l=e.getAllRules(),c=e.getAllTags(),u=e.getRulesForTag,d=E.useCallback((v,x)=>{e.setActiveTagIds(w=>{const S=new Set(w);return x?S.add(v):S.delete(v),S})},[e]),h=E.useCallback((v,x)=>{e.setActiveRuleIds(w=>{const S=new Set(w);return x?S.add(v):S.delete(v),S})},[e]),m=()=>{o?r(v=>!v):e.handleTriggerClick()&&r(!1)},y=s.size>0||i.size>0,b=a;return f.jsxs(sc,{open:n,onOpenChange:r,children:[f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:o?f.jsx(ic,{asChild:!0,children:f.jsx(mt,{variant:y?"secondary":"ghost",size:"icon",className:"h-8 w-8",disabled:b,"aria-label":"Configure Rules & Tags for Next Turn",onClick:m,children:f.jsx(NB,{className:"h-4 w-4"})})}):f.jsx(mt,{variant:"ghost",size:"icon",className:"h-8 w-8",disabled:b,"aria-label":"Add Rules & Tags (Opens Settings)",onClick:m,children:f.jsx(NB,{className:"h-4 w-4"})})}),f.jsx(Sr,{side:"top",children:o?y?`Rules/Tags Active (${s.size} tags, ${i.size} rules)`:"Activate Rules/Tags (Next Turn)":"Add Rules/Tags (Opens Settings)"})]})}),o&&f.jsx(ac,{className:"w-auto p-0",align:"start",children:f.jsx(Hse,{activeTagIds:s,activeRuleIds:i,onToggleTag:d,onToggleRule:h,allRules:l,allTags:c,getRulesForTag:u})})]})};function Hqe({form:e,name:t,label:n,description:r,placeholder:s,disabled:i,wrapperClassName:a,className:o,rows:l,...c}){return f.jsx(e.Field,{name:t,children:u=>{const d=typeof u.state.value=="string"||typeof u.state.value=="number"?String(u.state.value):"";return f.jsxs("div",{className:Xe("space-y-1.5",a),children:[f.jsx(Ot,{htmlFor:u.name,className:"text-sm",children:n}),r&&f.jsx("p",{className:"text-xs text-muted-foreground",children:r}),f.jsx(Uo,{id:u.name,name:u.name,value:d,onBlur:u.handleBlur,onChange:h=>u.handleChange(h.target.value),placeholder:s,disabled:i??u.form.state.isSubmitting,rows:l,className:Xe(o,u.state.meta.errors.length?"border-destructive":""),...c}),f.jsx(ji,{field:u})]})}})}const Gqe=Ke({name:ze().min(1,"Rule Name is required."),content:ze().min(1,"Rule Content is required."),type:xl(["system","before","after"],{errorMap:()=>({message:"Rule Type is required."})})}),Kqe=[{value:"system",label:"System Prompt"},{value:"before",label:"Before User Prompt"},{value:"after",label:"After User Prompt"}],Yqe=({initialData:e,isSavingExt:t,onSave:n,onCancel:r})=>{const s=ii({defaultValues:{name:(e==null?void 0:e.name)||"",content:(e==null?void 0:e.content)||"",type:(e==null?void 0:e.type)||"before"},validators:{onChangeAsync:Gqe,onChangeAsyncDebounceMs:500},onSubmit:async({value:i})=>{await n({name:i.name.trim(),content:i.content.trim(),type:i.type})}});return E.useEffect(()=>{s.reset({name:(e==null?void 0:e.name)||"",content:(e==null?void 0:e.content)||"",type:(e==null?void 0:e.type)||"before"})},[e,s]),f.jsxs("form",{onSubmit:i=>{i.preventDefault(),i.stopPropagation(),s.handleSubmit()},className:"space-y-4 border rounded-md p-4 bg-card shadow-md",children:[f.jsx("h4",{className:"font-semibold text-card-foreground",children:e!=null&&e.id?"Edit Rule":"Add New Rule"}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[f.jsx(Gw,{form:s,name:"name",label:"Rule Name",placeholder:"e.g., Always respond in JSON",required:!0,disabled:t,wrapperClassName:"md:col-span-2"}),f.jsx(Ox,{form:s,name:"type",label:"Rule Type",options:Kqe,placeholder:"Select Type",disabled:t})]}),f.jsx(Hqe,{form:s,name:"content",label:"Rule Content",placeholder:"Enter the rule text to be injected...",required:!0,rows:4,disabled:t,className:"font-mono text-xs"}),f.jsxs("div",{className:"flex justify-end space-x-2 pt-2",children:[f.jsxs(mt,{variant:"ghost",size:"sm",onClick:r,disabled:t,type:"button",children:[f.jsx(Oi,{className:"h-4 w-4 mr-1"})," Cancel"]}),f.jsx(s.Subscribe,{selector:i=>[i.canSubmit,i.isSubmitting,i.isValidating,i.isValid],children:([i,a,o,l])=>f.jsxs(mt,{variant:"secondary",size:"sm",type:"submit",disabled:t||!i||a||!l||o,children:[(t||a||o)&&f.jsx(Xn,{className:"h-4 w-4 mr-1 animate-spin"}),f.jsx($u,{className:"h-4 w-4 mr-1"})," ",t||a||o?"Saving...":"Save Rule"]})})]})]})},Zqe=({rules:e,isLoading:t,isDeleting:n,onEdit:r,onDelete:s})=>{const i=a=>{window.confirm(`Are you sure you want to delete the rule "${a.name}"? This will also remove it from any tags.`)&&s(a.id,a.name)};return f.jsx("div",{className:"border rounded-md overflow-hidden",children:f.jsxs(lf,{children:[f.jsx(dp,{children:f.jsxs(Ts,{children:[f.jsx(Ar,{children:"Name"}),f.jsx(Ar,{children:"Type"}),f.jsx(Ar,{children:"Content Preview"}),f.jsx(Ar,{className:"text-right",children:"Actions"})]})}),f.jsx(cf,{children:t?f.jsxs(f.Fragment,{children:[f.jsx(Ts,{children:f.jsx(Fn,{colSpan:4,children:f.jsx(Wr,{className:"h-10 w-full"})})}),f.jsx(Ts,{children:f.jsx(Fn,{colSpan:4,children:f.jsx(Wr,{className:"h-10 w-full"})})})]}):e.length===0?f.jsx(Ts,{children:f.jsx(Fn,{colSpan:4,className:"h-24 text-center text-muted-foreground",children:"No rules defined yet."})}):e.map(a=>{const o=n[a.id];return f.jsxs(Ts,{children:[f.jsx(Fn,{className:"font-medium",children:a.name}),f.jsx(Fn,{className:"capitalize",children:a.type}),f.jsx(Fn,{className:"text-xs text-muted-foreground truncate max-w-xs",children:a.content}),f.jsxs(Fn,{className:"text-right space-x-1",children:[f.jsx(Un,{tooltipText:"Edit Rule",onClick:()=>r(a),disabled:o,icon:f.jsx(p1,{}),className:"h-8 w-8","aria-label":`Edit rule ${a.name}`}),f.jsx(Un,{tooltipText:"Delete Rule",onClick:()=>i(a),disabled:o,icon:o?f.jsx(Xn,{className:"h-4 w-4 animate-spin"}):f.jsx(Mo,{}),className:"text-destructive hover:text-destructive/80 h-8 w-8","aria-label":`Delete rule ${a.name}`})]})]},a.id)})})]})})},Xqe=({module:e})=>{const[,t]=E.useState(Date.now()),n=e.getAllRules(),r=e.getIsLoadingRules(),[s,i]=E.useState(!1),[a,o]=E.useState(null),[l,c]=E.useState(!1),[u,d]=E.useState({});E.useEffect(()=>(e.setNotifySettingsCallback(()=>t(Date.now())),()=>{e.setNotifySettingsCallback(null)}),[e]);const h=()=>{o(null),i(!0)},m=x=>{o(x),i(!0)},y=E.useCallback(()=>{i(!1),o(null),c(!1)},[]),b=E.useCallback(async x=>{c(!0);try{a?e.updateRule(a.id,x):e.addRule(x),y()}catch{}finally{c(!1)}},[e,a,y]),v=E.useCallback(async x=>{d(w=>({...w,[x]:!0}));try{e.deleteRule(x),(a==null?void 0:a.id)===x&&y()}catch{}finally{d(w=>({...w,[x]:!1}))}},[e,a,y]);return f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"text-lg font-semibold text-card-foreground",children:"Manage Rules"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Create reusable text snippets (rules) that can be automatically injected into prompts based on assigned tags. Rules can modify the system prompt, or be added before/after the user's input."})]}),!s&&f.jsxs(mt,{onClick:h,variant:"outline",className:"w-full",disabled:r,children:[f.jsx(jc,{className:"h-4 w-4 mr-1"})," Add New Rule"]}),s&&f.jsx(Yqe,{initialData:a??void 0,isSavingExt:l,onSave:b,onCancel:y}),f.jsxs("div",{className:"pt-4",children:[f.jsx("h4",{className:"text-md font-medium mb-2",children:"Existing Rules"}),f.jsx(Zqe,{rules:n,isLoading:r,isDeleting:u,onEdit:m,onDelete:v})]})]})},p3=Ke({name:ze().min(1,"Tag Name is required."),description:ze().nullable()}),Jqe=({initialData:e,isParentSaving:t=!1,onSave:n,onCancel:r})=>{const s=ii({defaultValues:{name:(e==null?void 0:e.name)||"",description:(e==null?void 0:e.description)||null},validators:{onChangeAsync:p3,onChangeAsyncDebounceMs:500},onSubmit:async({value:i})=>{var a;await n({name:i.name.trim(),description:((a=i.description)==null?void 0:a.trim())||null})}});return E.useEffect(()=>{s.reset({name:(e==null?void 0:e.name)||"",description:(e==null?void 0:e.description)||null})},[e,s]),f.jsxs("form",{onSubmit:i=>{i.preventDefault(),i.stopPropagation(),s.handleSubmit()},className:"space-y-4 border rounded-md p-4 bg-card shadow-md",children:[f.jsx("h4",{className:"font-semibold text-card-foreground",children:e!=null&&e.id?"Edit Tag":"Add New Tag"}),f.jsx(s.Field,{name:"name",validators:{onChange:p3.shape.name},children:i=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(Ot,{htmlFor:i.name,children:"Tag Name"}),f.jsx(Cn,{id:i.name,value:i.state.value??"",onChange:a=>i.handleChange(a.target.value),onBlur:i.handleBlur,placeholder:"e.g., Code Generation, Summarization",disabled:s.state.isSubmitting||t}),f.jsx(ji,{field:i})]})}),f.jsx(s.Field,{name:"description",validators:{onChange:p3.shape.description},children:i=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(Ot,{htmlFor:i.name,children:"Description (Optional)"}),f.jsx(Uo,{id:i.name,value:i.state.value??"",onChange:a=>i.handleChange(a.target.value),onBlur:i.handleBlur,placeholder:"Describe when to use this tag...",rows:2,disabled:s.state.isSubmitting||t}),f.jsx(ji,{field:i})]})}),f.jsxs("div",{className:"flex justify-end space-x-2 pt-2",children:[f.jsxs(mt,{variant:"ghost",size:"sm",onClick:r,disabled:s.state.isSubmitting||t,type:"button",children:[f.jsx(Oi,{className:"h-4 w-4 mr-1"})," Cancel"]}),f.jsx(s.Subscribe,{selector:i=>[i.canSubmit,i.isSubmitting,i.isValidating,i.isValid],children:([i,a,o,l])=>f.jsxs(mt,{variant:"secondary",size:"sm",type:"submit",disabled:t||!i||a||o||!l,children:[(a||o)&&f.jsx(Xn,{className:"h-4 w-4 mr-1 animate-spin"}),f.jsx($u,{className:"h-4 w-4 mr-1"})," ",a||o?"Saving...":"Save Tag"]})})]})]})},Qqe=({tags:e,rulesByTagId:t,isLoading:n,isDeleting:r,onEdit:s,onDelete:i})=>{const a=o=>{window.confirm(`Are you sure you want to delete the tag "${o.name}"? This will remove it from all rules.`)&&i(o.id,o.name)};return f.jsx("div",{className:"border rounded-md overflow-hidden",children:f.jsxs(lf,{children:[f.jsx(dp,{children:f.jsxs(Ts,{children:[f.jsx(Ar,{children:"Name"}),f.jsx(Ar,{children:"Description"}),f.jsx(Ar,{children:"Linked Rules"}),f.jsx(Ar,{className:"text-right",children:"Actions"})]})}),f.jsx(cf,{children:n?f.jsxs(f.Fragment,{children:[f.jsx(Ts,{children:f.jsx(Fn,{colSpan:4,children:f.jsx(Wr,{className:"h-10 w-full"})})}),f.jsx(Ts,{children:f.jsx(Fn,{colSpan:4,children:f.jsx(Wr,{className:"h-10 w-full"})})})]}):e.length===0?f.jsx(Ts,{children:f.jsx(Fn,{colSpan:4,className:"h-24 text-center text-muted-foreground",children:"No tags defined yet."})}):e.map(o=>{const l=r[o.id],c=t.get(o.id)||[];return f.jsxs(Ts,{children:[f.jsx(Fn,{className:"font-medium",children:o.name}),f.jsx(Fn,{className:"text-xs text-muted-foreground truncate max-w-xs",children:o.description||"-"}),f.jsx(Fn,{className:"text-xs",children:c.length>0?c.map(u=>u.name).join(", "):"None"}),f.jsxs(Fn,{className:"text-right space-x-1",children:[f.jsx(Un,{tooltipText:"Edit Tag & Rules",onClick:()=>s(o),disabled:l,icon:f.jsx(p1,{}),className:"h-8 w-8","aria-label":`Edit tag ${o.name}`}),f.jsx(Un,{tooltipText:"Delete Tag",onClick:()=>a(o),disabled:l,icon:l?f.jsx(Xn,{className:"h-4 w-4 animate-spin"}):f.jsx(Mo,{}),className:"text-destructive hover:text-destructive/80 h-8 w-8","aria-label":`Delete tag ${o.name}`})]})]},o.id)})})]})})},eVe=({tag:e,allRules:t,linkedRuleIds:n,onLinkChange:r,disabled:s=!1})=>{const[i,a]=E.useState(!1),[o,l]=E.useState(""),c=E.useMemo(()=>[...t].sort((y,b)=>y.name.localeCompare(b.name)),[t]),u=E.useMemo(()=>{const y=o.toLowerCase();return y?c.filter(b=>b.name.toLowerCase().includes(y)||b.content.toLowerCase().includes(y)||b.type.toLowerCase().includes(y)):c},[c,o]),d=E.useCallback(y=>{const b=n.has(y);r(e.id,y,!b),l("")},[n,r,e.id]),h=E.useCallback((y,b)=>{b.stopPropagation(),r(e.id,y,!1)},[r,e.id]),m=E.useMemo(()=>c.filter(y=>n.has(y.id)),[c,n]);return f.jsxs("div",{className:"space-y-3",children:[f.jsxs(Ot,{className:"font-medium",children:['Associated Rules for "',e.name,'"']}),f.jsxs(sc,{open:i,onOpenChange:a,children:[f.jsx(ic,{asChild:!0,children:f.jsxs(mt,{variant:"outline",role:"combobox","aria-expanded":i,className:"w-full justify-between h-9",disabled:s||t.length===0,children:[f.jsx("span",{className:"truncate",children:m.length>0?`${m.length} rule(s) selected`:"Select rules..."}),f.jsx(fE,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),f.jsx(ac,{className:"w-[--radix-popover-trigger-width] p-0",children:f.jsxs(Bse,{shouldFilter:!1,children:[f.jsx($se,{placeholder:"Search rules...",value:o,onValueChange:l}),f.jsxs(zse,{children:[f.jsx(Use,{children:t.length===0?"No rules defined.":"No rules found."}),f.jsx(qse,{children:u.map(y=>{const b=n.has(y.id);return f.jsxs(Vse,{value:y.id,onSelect:()=>d(y.id),className:"cursor-pointer",children:[f.jsx(ao,{className:Xe("mr-2 h-4 w-4",b?"opacity-100":"opacity-0")}),f.jsx("span",{className:"truncate",children:y.name}),f.jsxs("span",{className:"ml-2 text-xs text-muted-foreground",children:["(",y.type,")"]})]},y.id)})})]})]})})]}),m.length>0&&f.jsx("div",{className:"flex flex-wrap gap-1 pt-2",children:m.map(y=>f.jsxs(is,{variant:"secondary",className:"flex items-center gap-1",children:[f.jsx("span",{className:"truncate",children:y.name}),f.jsx(mt,{variant:"ghost",size:"icon",className:"h-4 w-4 p-0 text-muted-foreground hover:text-destructive hover:bg-transparent",onClick:b=>h(y.id,b),disabled:s,"aria-label":`Unlink rule ${y.name}`,children:f.jsx(Oi,{className:"h-3 w-3"})})]},y.id))})]})},tVe=({module:e})=>{const[,t]=E.useState(Date.now()),n=e.getAllTags(),r=e.getAllRules(),s=e.getTagRuleLinks(),i=e.getRulesForTag,a=e.getIsLoadingRules(),[o,l]=E.useState(!1),[c,u]=E.useState(null),[d,h]=E.useState(!1),[m,y]=E.useState({});E.useEffect(()=>(e.setNotifySettingsCallback(()=>t(Date.now())),()=>{e.setNotifySettingsCallback(null)}),[e]);const b=()=>{u(null),l(!0)},v=R=>{u(R),l(!0)},x=E.useCallback(()=>{l(!1),u(null),h(!1)},[]),w=E.useCallback(async R=>{h(!0);try{c?e.updateTag(c.id,R):e.addTag(R),c||x()}catch{}finally{h(!1)}},[e,c,x]),S=E.useCallback(async R=>{y(N=>({...N,[R]:!0}));try{e.deleteTag(R),(c==null?void 0:c.id)===R&&x()}catch{}finally{y(N=>({...N,[R]:!1}))}},[e,c,x]),k=E.useCallback(async(R,N,I)=>{try{I?e.linkTagToRule(R,N):e.unlinkTagFromRule(R,N)}catch{}},[e]),C=E.useMemo(()=>{const R=new Map;return n.forEach(N=>{R.set(N.id,i(N.id))}),R},[n,i]),T=E.useMemo(()=>c?new Set(s.filter(R=>R.tagId===c.id).map(R=>R.ruleId)):new Set,[c,s]);return f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"text-lg font-semibold text-card-foreground",children:"Manage Tags"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Create tags to group related rules. You can activate tags before sending a prompt to apply their associated rules."})]}),!o&&f.jsxs(mt,{onClick:b,variant:"outline",className:"w-full",disabled:a,children:[f.jsx(jc,{className:"h-4 w-4 mr-1"})," Add New Tag"]}),o&&f.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[f.jsx(Jqe,{initialData:c??void 0,isParentSaving:d,onSave:w,onCancel:x}),c&&f.jsx(eVe,{tag:c,allRules:r,linkedRuleIds:T,onLinkChange:k,disabled:d})]}),f.jsx(jm,{}),f.jsxs("div",{className:"pt-4",children:[f.jsx("h4",{className:"text-md font-medium mb-2",children:"Existing Tags"}),f.jsx(Qqe,{tags:n,rulesByTagId:C,isLoading:a,isDeleting:m,onEdit:v,onDelete:S})]})]})},nVe=({module:e})=>{const[,t]=E.useState({});E.useEffect(()=>(e.setNotifySettingsCallback(()=>t({})),()=>e.setNotifySettingsCallback(null)),[e]);const n=E.useMemo(()=>[{value:"rules",label:"Rules",content:f.jsx(Xqe,{module:e})},{value:"tags",label:"Tags",content:f.jsx(tVe,{module:e})}],[e]);return f.jsx(oc,{tabs:n,defaultValue:"rules",className:"h-full",listClassName:"bg-muted/50 rounded-md",contentContainerClassName:"mt-4"})};class rVe{constructor(){de(this,"id","core-rules-tags");de(this,"unregisterPromptControlCallback",null);de(this,"unregisterSettingsTabCallback",null);de(this,"eventUnsubscribers",[]);de(this,"modApiRef",null);de(this,"allRules",[]);de(this,"allTags",[]);de(this,"tagRuleLinks",[]);de(this,"transientActiveTagIds",new Set);de(this,"transientActiveRuleIds",new Set);de(this,"isStreaming",!1);de(this,"hasRulesOrTags",!1);de(this,"isLoadingRules",!0);de(this,"notifyComponentUpdate",null);de(this,"notifySettingsComponentUpdate",null);de(this,"getAllRules",()=>this.allRules);de(this,"getAllTags",()=>this.allTags);de(this,"getTagRuleLinks",()=>this.tagRuleLinks);de(this,"getRulesForTag",t=>{const n=new Set(this.tagRuleLinks.filter(r=>r.tagId===t).map(r=>r.ruleId));return this.allRules.filter(r=>n.has(r.id))});de(this,"getRuleById",t=>this.allRules.find(n=>n.id===t));de(this,"getTagById",t=>this.allTags.find(n=>n.id===t));de(this,"getRulesByIds",t=>{const n=new Set(t);return this.allRules.filter(r=>n.has(r.id))});de(this,"addRule",t=>{var n;(n=this.modApiRef)==null||n.emit(yr.addRuleRequest,t)});de(this,"updateRule",(t,n)=>{var r;(r=this.modApiRef)==null||r.emit(yr.updateRuleRequest,{id:t,updates:n})});de(this,"deleteRule",t=>{var n;(n=this.modApiRef)==null||n.emit(yr.deleteRuleRequest,{id:t})});de(this,"addTag",t=>{var n;(n=this.modApiRef)==null||n.emit(yr.addTagRequest,t)});de(this,"updateTag",(t,n)=>{var r;(r=this.modApiRef)==null||r.emit(yr.updateTagRequest,{id:t,updates:n})});de(this,"deleteTag",t=>{var n;(n=this.modApiRef)==null||n.emit(yr.deleteTagRequest,{id:t})});de(this,"linkTagToRule",(t,n)=>{var r;(r=this.modApiRef)==null||r.emit(yr.linkTagToRuleRequest,{tagId:t,ruleId:n})});de(this,"unlinkTagFromRule",(t,n)=>{var r;(r=this.modApiRef)==null||r.emit(yr.unlinkTagFromRuleRequest,{tagId:t,ruleId:n})});de(this,"handleTriggerClick",()=>!this.hasRulesOrTags&&this.modApiRef?(this.modApiRef.emit(Or.openModalRequest,{modalId:"settingsModal",initialTab:"rules-tags"}),!0):!1);de(this,"getIsStreaming",()=>this.isStreaming);de(this,"getHasRulesOrTags",()=>this.hasRulesOrTags);de(this,"getIsLoadingRules",()=>this.isLoadingRules);de(this,"getActiveTagIds",()=>this.transientActiveTagIds);de(this,"getActiveRuleIds",()=>this.transientActiveRuleIds);de(this,"setActiveTagIds",t=>{var n;this.transientActiveTagIds=t(this.transientActiveTagIds),(n=this.notifyComponentUpdate)==null||n.call(this)});de(this,"setActiveRuleIds",t=>{var n;this.transientActiveRuleIds=t(this.transientActiveRuleIds),(n=this.notifyComponentUpdate)==null||n.call(this)});de(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t});de(this,"setNotifySettingsCallback",t=>{this.notifySettingsComponentUpdate=t})}async initialize(t){this.modApiRef=t,this.isStreaming=t.getContextSnapshot().isStreaming,t.emit(yr.loadRulesAndTagsRequest,void 0);const n=t.on(Zn.statusChanged,s=>{var i;typeof s=="object"&&s&&"status"in s&&this.isStreaming!==(s.status==="streaming")&&(this.isStreaming=s.status==="streaming",(i=this.notifyComponentUpdate)==null||i.call(this))}),r=t.on(yr.dataLoaded,s=>{var i,a;s&&(this.allRules=s.rules||[],this.allTags=s.tags||[],this.tagRuleLinks=(s.links||[]).map(o=>({tagId:o.tagId,ruleId:o.ruleId}))),this.updateHasRulesOrTags(),this.isLoadingRules=!1,(i=this.notifyComponentUpdate)==null||i.call(this),(a=this.notifySettingsComponentUpdate)==null||a.call(this)});this.eventUnsubscribers.push(n,r)}updateHasRulesOrTags(){const t=this.allRules.length>0||this.allTags.length>0;this.hasRulesOrTags!==t&&(this.hasRulesOrTags=t)}register(t){this.modApiRef=t,this.unregisterPromptControlCallback||(this.unregisterPromptControlCallback=t.registerPromptControl({id:this.id,status:()=>this.isLoadingRules?"loading":"ready",triggerRenderer:()=>Ve.createElement(Wqe,{module:this}),getMetadata:()=>{const n=Array.from(this.transientActiveTagIds),r=Array.from(this.transientActiveRuleIds),s=[],i=new Set(r);if(n.forEach(a=>{this.getRulesForTag(a).forEach(o=>i.add(o.id))}),i.forEach(a=>{const o=this.getRuleById(a);o&&s.push({type:o.type,content:o.content,sourceRuleId:o.id})}),n.length>0||r.length>0||s.length>0)return{activeTagIds:n,activeRuleIds:r,effectiveRulesContent:s}},clearOnSubmit:()=>{var r;let n=!1;this.transientActiveTagIds.size>0&&(this.transientActiveTagIds=new Set,n=!0),this.transientActiveRuleIds.size>0&&(this.transientActiveRuleIds=new Set,n=!0),n&&((r=this.notifyComponentUpdate)==null||r.call(this))}})),this.unregisterSettingsTabCallback||(this.unregisterSettingsTabCallback=t.registerSettingsTab({id:"rules-tags",title:"Rules & Tags",component:()=>Ve.createElement(nVe,{module:this}),order:50}))}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterPromptControlCallback&&(this.unregisterPromptControlCallback(),this.unregisterPromptControlCallback=null),this.unregisterSettingsTabCallback&&(this.unregisterSettingsTabCallback(),this.unregisterSettingsTabCallback=null),this.notifyComponentUpdate=null,this.notifySettingsComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const sVe=({module:e})=>{const[,t]=E.useState({});E.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const n=e.getTurnEnabled(),r=e.getIsStreaming(),s=e.getGlobalAutoTitleEnabled()&&e.getIsFirstInteraction(),i=E.useCallback(()=>{const a=!n;e.setTurnEnabled(a)},[n,e]);return s?f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(mt,{variant:n?"secondary":"ghost",size:"icon",className:"h-8 w-8",onClick:i,disabled:r,"aria-label":n?"Disable Auto-Title for this Chat":"Enable Auto-Title for this Chat",children:f.jsx(kH,{className:Xe("h-4 w-4",n?"text-primary":"text-muted-foreground")})})}),f.jsx(Sr,{side:"top",children:n?"Auto-Title Enabled (Click to Disable)":"Auto-Title Disabled (Click to Enable)"})]})}):null};class iVe{constructor(){de(this,"id","core-auto-title");de(this,"unregisterCallback",null);de(this,"eventUnsubscribers",[]);de(this,"turnAutoTitleEnabled",!1);de(this,"isStreaming",!1);de(this,"isFirstInteraction",!1);de(this,"globalAutoTitleEnabled",!0);de(this,"notifyComponentUpdate",null);de(this,"getTurnEnabled",()=>this.turnAutoTitleEnabled);de(this,"getIsStreaming",()=>this.isStreaming);de(this,"getIsFirstInteraction",()=>this.isFirstInteraction);de(this,"getGlobalAutoTitleEnabled",()=>this.globalAutoTitleEnabled);de(this,"setTurnEnabled",t=>{var n;this.turnAutoTitleEnabled!==t&&(this.turnAutoTitleEnabled=t,(n=this.notifyComponentUpdate)==null||n.call(this))});de(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){var a;this.turnAutoTitleEnabled=!1,this.isStreaming=vn.getState().status==="streaming",this.globalAutoTitleEnabled=br.getState().autoTitleEnabled,this.checkFirstInteraction(),(a=this.notifyComponentUpdate)==null||a.call(this);const n=t.on(Zn.statusChanged,o=>{var l;typeof o=="object"&&o&&"status"in o&&this.isStreaming!==(o.status==="streaming")&&(this.isStreaming=o.status==="streaming",(l=this.notifyComponentUpdate)==null||l.call(this))}),r=t.on(Or.contextChanged,()=>{var l;const o=this.isFirstInteraction;this.checkFirstInteraction(),o!==this.isFirstInteraction&&((l=this.notifyComponentUpdate)==null||l.call(this))}),s=t.on(Zn.completed,()=>{var l;const o=this.isFirstInteraction;this.checkFirstInteraction(),o!==this.isFirstInteraction&&((l=this.notifyComponentUpdate)==null||l.call(this))}),i=t.on(sn.autoTitleEnabledChanged,o=>{var l;typeof o=="object"&&o&&"enabled"in o&&this.globalAutoTitleEnabled!==o.enabled&&(this.globalAutoTitleEnabled=o.enabled,(l=this.notifyComponentUpdate)==null||l.call(this))});this.eventUnsubscribers.push(n,r,s,i)}checkFirstInteraction(){const t=vn.getState(),n=t.currentConversationId===null||t.interactions.filter(r=>r.conversationId===t.currentConversationId).length===0;this.isFirstInteraction!==n&&(this.isFirstInteraction=n,!n&&this.turnAutoTitleEnabled&&(this.turnAutoTitleEnabled=!1))}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}const n=()=>Ve.createElement(sVe,{module:this});this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:n,getMetadata:()=>this.turnAutoTitleEnabled?{autoTitleEnabledForTurn:!0}:void 0,clearOnSubmit:()=>{var r;this.turnAutoTitleEnabled&&(this.turnAutoTitleEnabled=!1,(r=this.notifyComponentUpdate)==null||r.call(this))}})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,console.log(`[${this.id}] Destroyed.`)}}function aVe(){const e=new URLSearchParams(window.location.search),t=e.get("q")??void 0,n=e.get("m")??void 0,r=e.getAll("vfs").filter(Boolean),s=e.get("s")??"1";return{query:t,modelId:n,vfsFiles:r.length>0?r:void 0,submit:s}}class oVe{constructor(){de(this,"id","core-url-parameters");de(this,"modApiRef",null)}async initialize(t){this.modApiRef=t,console.log(`[${this.id}] Initializing...`),t.on(ap.initializationPhaseCompleted,n=>{n.phase==="all"&&this.processUrlParameters().catch(r=>{console.error(`[${this.id}] Error processing URL parameters:`,r),Me.error("Failed to process URL parameters.")})}),console.log(`[${this.id}] Initialized, awaiting full app load.`)}register(t){}destroy(){this.modApiRef=null}async processUrlParameters(){var r,s;if(!this.modApiRef){console.warn(`[${this.id}] ModAPI not available, cannot process URL parameters.`);return}const t=this.modApiRef,n=aVe();if(!(!n.query&&!n.modelId&&!((r=n.vfsFiles)!=null&&r.length))){Me.info("Processing parameters from URL...");try{const i=await new Promise((a,o)=>{const l=t.on(Jn.conversationAdded,c=>{c.conversation.title.startsWith("From URL:")&&(l(),a(c.conversation.id))});setTimeout(()=>{l(),o(new Error("Timeout waiting for conversation creation event."))},5e3),t.emit(Jn.addConversationRequest,{title:n.query?`From URL: ${n.query.substring(0,30)}...`:"From URL Parameters"})});if(t.emit(Jn.selectItemRequest,{id:i,type:"conversation"}),n.modelId){const a=Cr.getState().getAvailableModelListItems();let o=null;const l=n.modelId.toLowerCase();if(n.modelId.includes(":")){const c=a.find(u=>u.id===n.modelId);c&&(o=c.id)}if(!o){const c=a.find(u=>u.name.toLowerCase()===l);c&&(o=c.id)}if(!o){const c=a.find(u=>u.name.toLowerCase().startsWith(l));c&&(o=c.id)}if(!o){const c=a.find(u=>{const d=u.id.toLowerCase().split("/");return d.length>1&&d[1].startsWith(l)});c&&(o=c.id)}if(o){t.emit(gn.setModelIdRequest,{id:o}),t.emit(Qn.selectModelRequest,{modelId:o});const c=a.find(u=>u.id===o);Me.success(`Model set to: ${c==null?void 0:c.name} (${c==null?void 0:c.providerName})`)}else Me.warning(`Model matching "${n.modelId}" not found or not enabled. Using default.`)}if(n.vfsFiles&&n.vfsFiles.length>0){const a="orphan";let o;try{if(o=await t.getVfsInstance(a),!o)throw new Error("Failed to get VFS instance via ModAPI.")}catch(l){Me.error(`Failed to initialize VFS for URL files: ${l instanceof Error?l.message:String(l)}`)}if(o)for(const l of n.vfsFiles)try{const c=await Zh(l,{fsInstance:o}),u=await o.promises.stat(l),d=vi(l),h="application/octet-stream",m=Jx(d,h);let y={};if(m)y.contentText=new TextDecoder().decode(c);else{let b="";const v=c.byteLength;for(let x=0;x<v;x++)b+=String.fromCharCode(c[x]);y.contentBase64=window.btoa(b)}t.emit(Ul.addAttachedFileRequest,{source:"vfs",name:d,type:h,size:u.size,path:l,...y}),Me.success(`Attached VFS file: ${d}`)}catch(c){c.code==="ENOENT"?Me.warning(`VFS file not found: ${l}`):Me.warning(`Failed to attach VFS file "${l}": ${c.message}`),console.error(`Error processing VFS file ${l}:`,c)}}if(n.query)if(n.submit==="0")t.emit(gn.inputChanged,{value:n.query}),Me.info("Query from URL loaded into input area."),window.history.replaceState({},document.title,window.location.pathname);else{let a={},o={};const l=bh.getState().attachedFilesMetadata;l.length>0&&(o.attachedFiles=[...l]);let c={id:as(),content:n.query,parameters:a,metadata:o};t.emit(gn.submitted,{turnData:c});const u=await PC(iy.PROMPT_TURN_FINALIZE,{turnData:c});if(u===!1){Me.warning("Prompt submission from URL cancelled by middleware.");return}const d=u&&typeof u=="object"?u.turnData:c;await Qp.submitPrompt(d),window.history.replaceState({},document.title,window.location.pathname)}else(n.modelId||(s=n.vfsFiles)!=null&&s.length)&&(Me.info("Model and/or VFS files from URL applied. Type your message."),window.history.replaceState({},document.title,window.location.pathname))}catch(i){Me.error(`Failed to process URL parameters: ${i instanceof Error?i.message:String(i)}`),console.error("Error processing URL parameters:",i)}}}}const lVe=({module:e})=>{const[t,n]=E.useState(!1),[,r]=E.useState({});E.useEffect(()=>(e.setNotifyCallback(()=>r({})),()=>e.setNotifyCallback(null)),[e]),E.useEffect(()=>{const o=e.getImageGenerationEnabled();n(o===!0)},[e]);const s=e.getIsVisible(),i=e.getIsStreaming(),a=E.useCallback(()=>{const o=!t;e.setImageGenerationEnabled(o?!0:null),n(o)},[t,e]);return s?f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(mt,{variant:t?"secondary":"ghost",size:"icon",onClick:a,disabled:i,className:"h-8 w-8","aria-label":t?"Disable Image Generation for Next Turn":"Enable Image Generation for Next Turn",children:f.jsx(iC,{className:Xe("h-4 w-4",t?"text-primary":"text-muted-foreground")})})}),f.jsx(Sr,{side:"top",children:t?"Image Generation Enabled (Click to Disable)":"Image Generation Disabled (Click to Enable)"})]})}):null};class cVe{constructor(){de(this,"id","core-image-generation");de(this,"modApiRef",null);de(this,"isImageGenerationEnabled",null);de(this,"unregisterCallback",null);de(this,"notifyComponentUpdate",null);de(this,"eventUnsubscribers",[]);de(this,"isVisible",!1);de(this,"isStreaming",!1);de(this,"getImageGenerationEnabled",()=>this.isImageGenerationEnabled);de(this,"getIsVisible",()=>this.isVisible);de(this,"getIsStreaming",()=>this.isStreaming);de(this,"setImageGenerationEnabled",t=>{var n,r;this.isImageGenerationEnabled=t,(n=this.modApiRef)==null||n.emit(gn.setImageGenerationEnabledRequest,{enabled:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});de(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){this.modApiRef=t,this.isImageGenerationEnabled=null,this.isStreaming=vn.getState().status==="streaming",this.updateVisibility();const n=t.on(Qn.selectedModelChanged,()=>{var s;this.updateVisibility(),(s=this.notifyComponentUpdate)==null||s.call(this)}),r=t.on(Zn.statusChanged,s=>{var i;typeof s=="object"&&s&&"status"in s&&this.isStreaming!==(s.status==="streaming")&&(this.isStreaming=s.status==="streaming",(i=this.notifyComponentUpdate)==null||i.call(this))});this.eventUnsubscribers.push(n,r),console.log(`[${this.id}] Initialized.`)}updateVisibility(){var i,a;const{getSelectedModel:t}=Cr.getState(),n=t(),s=(((a=(i=n==null?void 0:n.metadata)==null?void 0:i.architecture)==null?void 0:a.output_modalities)??[]).includes("image");this.isVisible!==s&&(this.isVisible=s)}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>Ve.createElement(lVe,{module:this}),getMetadata:()=>this.isImageGenerationEnabled===!0?{imageGenerationEnabled:!0}:void 0,clearOnSubmit:()=>{var s;(s=this.modApiRef)==null||s.emit(gn.setImageGenerationEnabledRequest,{enabled:null})}});const n=s=>{var i;s.enabled!==this.isImageGenerationEnabled&&(this.isImageGenerationEnabled=s.enabled,(i=this.notifyComponentUpdate)==null||i.call(this))},r=this.modApiRef.on(gn.setImageGenerationEnabledRequest,n);this.eventUnsubscribers.push(r),console.log(`[${this.id}] Registered successfully`)}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const uVe=({module:e})=>{const[t,n]=E.useState(!1),[r,s]=E.useState([]),[i,a]=E.useState(250),[,o]=E.useState({}),{status:l}=vn(yn(b=>({status:b.status})));E.useEffect(()=>{if(e)return e.setNotifyCallback(()=>o({})),()=>e.setNotifyCallback(null)},[e]);const c=(b,v)=>{s(x=>v?[...x,b]:x.filter(w=>w!==b))},u=()=>{if(r.length<2){Me.error("Please select at least 2 models to race");return}e.setRaceMode(!0,r,i),n(!1),Me.info(`Race mode enabled! Send your prompt to race ${r.length} models.`),s([]),a(250)},d=()=>{e.setRaceMode(!1),Me.info("Race mode disabled")},h=b=>{if(b.stopPropagation(),e.isRaceModeActive){d();return}if(l==="streaming"){Me.info("Cannot start race while another response is streaming");return}if(e.globallyEnabledModels.length<2){Me.info("Need at least 2 models enabled to race");return}n(!0)},m=l!=="streaming"&&e.globallyEnabledModels.length>=2,y=()=>e.isRaceModeActive?"Race mode active - click to cancel, or send your prompt to race models":l==="streaming"?"Cannot race while streaming":e.globallyEnabledModels.length<2?`Need at least 2 models enabled to race (currently have ${e.globallyEnabledModels.length})`:"Race multiple models with your prompt";return f.jsxs(f.Fragment,{children:[f.jsx(Un,{tooltipText:y(),onClick:h,"aria-label":"Race Multiple Models Against Each Other",disabled:!m,icon:f.jsx(CH,{}),className:`h-5 w-5 md:h-6 md:w-6 ${e.isRaceModeActive?"bg-primary text-primary-foreground":""}`}),f.jsx(op,{open:t,onOpenChange:n,children:f.jsxs(lp,{className:"max-w-md",children:[f.jsxs(cp,{children:[f.jsx(up,{children:"Race Models"}),f.jsx(eg,{children:'Select multiple models to race against each other. After clicking "Enable Race Mode", send your prompt and all selected models will respond.'})]}),f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"space-y-2",children:[f.jsx(Ot,{htmlFor:"stagger-input",children:"Stagger Delay (ms)"}),f.jsx(Cn,{id:"stagger-input",type:"number",min:"0",max:"5000",step:"50",value:i,onChange:b=>a(parseInt(b.target.value)||250),placeholder:"250",className:"w-full"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Delay between starting each model (0-5000ms)"})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsxs(Ot,{children:["Select Models to Race (",r.length," selected)"]}),f.jsx(Yl,{className:"h-48 w-full border rounded-md p-3",children:f.jsx("div",{className:"space-y-2",children:e.globallyEnabledModels.map(b=>f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx($c,{id:`model-${b.id}`,checked:r.includes(b.id),onCheckedChange:v=>c(b.id,v===!0)}),f.jsx(Ot,{htmlFor:`model-${b.id}`,className:"text-sm cursor-pointer flex-1 min-w-0",children:f.jsxs("div",{className:"truncate",children:[f.jsx("span",{className:"font-medium",children:b.name}),f.jsxs("span",{className:"text-muted-foreground ml-2",children:["(",b.providerName,")"]})]})})]},b.id))})}),e.globallyEnabledModels.length===0&&f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No models available"})]})]}),f.jsxs(gb,{children:[f.jsx(mt,{variant:"outline",onClick:()=>n(!1),children:"Cancel"}),f.jsx(mt,{onClick:u,disabled:r.length<2||e.isLoadingProviders,children:"Enable Race Mode"})]})]})})]})};class dVe{constructor(){de(this,"id","race-prompt-control");de(this,"eventUnsubscribers",[]);de(this,"modApi",null);de(this,"notifyComponentUpdate",null);de(this,"isRaceMode",!1);de(this,"raceModelIds",[]);de(this,"raceStaggerMs",250);de(this,"globallyEnabledModels",[]);de(this,"isLoadingProviders",!1)}async initialize(t){this.modApi=t;const n=Cr.getState();this.globallyEnabledModels=n.getGloballyEnabledModelDefinitions(),this.isLoadingProviders=n.isLoading;const r=t.on(Qn.globallyEnabledModelsUpdated,a=>{var o;this.globallyEnabledModels=a.models,(o=this.notifyComponentUpdate)==null||o.call(this)}),s=t.on(Qn.initialDataLoaded,a=>{var o;a.globallyEnabledModels&&(this.globallyEnabledModels=a.globallyEnabledModels,this.isLoadingProviders=!1,(o=this.notifyComponentUpdate)==null||o.call(this))}),i=t.addMiddleware(iy.PROMPT_TURN_FINALIZE,async a=>this.isRaceMode?await this.handleRaceSubmission(a.turnData):a);this.eventUnsubscribers.push(r,s,i)}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.notifyComponentUpdate=null,this.modApi=null}setNotifyCallback(t){this.notifyComponentUpdate=t}setRaceMode(t,n,r){var s;this.isRaceMode=t,t&&n&&r!==void 0?(this.raceModelIds=n,this.raceStaggerMs=r):(this.raceModelIds=[],this.raceStaggerMs=250),(s=this.notifyComponentUpdate)==null||s.call(this)}get isRaceModeActive(){return this.isRaceMode}async handleRaceSubmission(t){try{console.log(`[RacePromptControlModule] Starting race submission with ${this.raceModelIds.length} models:`,this.raceModelIds);const n=vn.getState(),r=n.currentConversationId;if(!r)return Me.error("No active conversation for racing"),!1;if(this.raceModelIds.length===0)return Me.error("No models selected for racing"),this.setRaceMode(!1),!1;Me.info(`Racing ${this.raceModelIds.length} models with your prompt...`);const i=n.interactions.filter(y=>y.conversationId===r).reduce((y,b)=>Math.max(y,b.index),-1)+1,a=await this.buildPromptObject(t,r,i),o=[...this.raceModelIds],l=this.raceStaggerMs,u=Fo.getState().modelId;if(!u)return Me.error("No model currently selected"),this.setRaceMode(!1),!1;this.setRaceMode(!1);const d={...a,metadata:{...a.metadata,modelId:u}},h=await pm.startInteraction(d,r,t,"message.user_assistant");if(!h)throw new Error("Failed to create main race interaction");const m=o.map((y,b)=>new Promise(v=>{setTimeout(async()=>{try{const x={...a,metadata:{...a.metadata,modelId:y,raceTab:!0,raceParticipantIndex:b+1}},w=await pm.startInteraction(x,r,t,"message.assistant_regen");if(w){const S={parentId:h.id,index:b+1};n._updateInteractionInState(w.id,S),await _t.saveInteraction({...w,...S})}v()}catch(x){console.error(`[RacePromptControlModule] Race participant ${b+1} failed:`,x),v()}},(b+1)*l)}));return await Promise.all(m),Me.success(`Race started! Current model + ${o.length} race models responding in tabs.`),!1}catch(n){return Me.error(`Race failed: ${String(n)}`),console.error("[RacePromptControlModule] Error during race:",n),this.setRaceMode(!1),!1}}async buildPromptObject(t,n,r){var R,N,I;const s=vn.getState(),i=zo.getState(),o=qn.getState().getConversationById(n),l=(o==null?void 0:o.projectId)??null,c=i.getEffectiveProjectSettings(l),u=s.interactions.filter(P=>P.conversationId===n&&P.index<r&&P.status==="COMPLETED"&&P.type==="message.user_assistant"&&P.parentId===null).sort((P,B)=>P.index-B.index),d=bj(u);let h=t.content;const m=[],y=((R=t.metadata)==null?void 0:R.effectiveRulesContent)??[],b=y.filter(P=>P.type==="system").map(P=>P.content),v=y.filter(P=>P.type==="before").map(P=>P.content),x=y.filter(P=>P.type==="after").map(P=>P.content);v.length>0&&(h=`${v.join(`
`)}

${h}`),x.length>0&&(h=`${h}

${x.join(`
`)}`),h&&m.push({type:"text",text:h});const w=((N=t.metadata)==null?void 0:N.attachedFiles)??[];w.length>0,m.length>0&&d.push({role:"user",content:m});let k=((I=t.metadata)==null?void 0:I.turnSystemPrompt)??c.systemPrompt??void 0;b.length>0&&(k=`${k?`${k}

`:""}${b.join(`
`)}`);const C=Fo.getState(),T={temperature:C.temperature,max_tokens:C.maxTokens,top_p:C.topP,top_k:C.topK,presence_penalty:C.presencePenalty,frequency_penalty:C.frequencyPenalty,...t.parameters??{}};return Object.keys(T).forEach(P=>{(T[P]===null||T[P]===void 0)&&delete T[P]}),{system:k,messages:d,parameters:T,metadata:{...t.metadata??{},attachedFiles:w.map(({contentBase64:P,contentText:B,...D})=>D)}}}register(t){t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>Ve.createElement(uVe,{module:this})})}}const gx=({fieldApi:e,label:t,description:n,placeholder:r,inputClassName:s,labelClassName:i,wrapperClassName:a,type:o="text"})=>{const{name:l,state:c,handleChange:u,handleBlur:d}=e,h=c.value,m=y=>{u(y.target.value)};return f.jsxs("div",{className:Xe("space-y-1.5",a),children:[t&&f.jsx(Ot,{htmlFor:l,className:Xe("text-sm font-medium",i),children:t}),n&&f.jsx("p",{className:"text-xs text-muted-foreground",children:n}),f.jsx(Cn,{id:l,name:l,type:o,value:h==null?"":String(h),onBlur:d,onChange:m,placeholder:r,className:Xe(s,c.meta.errors.length?"border-destructive":""),disabled:e.form.state.isSubmitting}),c.meta.isTouched&&c.meta.errors.length>0&&f.jsx("div",{className:"text-xs text-destructive pt-1",children:c.meta.errors.map((y,b)=>f.jsx("p",{children:typeof y=="string"?y:(y==null?void 0:y.message)||"Invalid"},b))})]})},fVe=({fieldApi:e,label:t,placeholder:n,description:r,rows:s=3,inputClassName:i,labelClassName:a,wrapperClassName:o})=>f.jsxs("div",{className:Xe("space-y-1.5",o),children:[t&&f.jsx(Ot,{htmlFor:e.name,className:Xe("text-sm font-medium",a),children:t}),r&&f.jsx("p",{className:"text-xs text-muted-foreground",children:r}),f.jsx(Uo,{id:e.name,name:e.name,value:e.state.value||"",onBlur:e.handleBlur,onChange:l=>e.handleChange(l.target.value),placeholder:n,rows:s,className:Xe(i,e.state.meta.errors.length?"border-destructive":""),disabled:e.form.state.isSubmitting}),e.state.meta.isTouched&&e.state.meta.errors.length>0&&f.jsx("div",{className:"text-xs text-destructive pt-1",children:e.state.meta.errors.map((l,c)=>f.jsx("p",{children:String(l)},c))})]}),hVe=({fieldApi:e,label:t,placeholder:n,description:r,options:s=[],inputClassName:i,labelClassName:a,wrapperClassName:o})=>f.jsxs("div",{className:Xe("space-y-1.5",o),children:[t&&f.jsx(Ot,{htmlFor:e.name+"-trigger",className:Xe("text-sm font-medium",a),children:t}),r&&f.jsx("p",{className:"text-xs text-muted-foreground",children:r}),f.jsxs(tp,{value:e.state.value||"",onValueChange:l=>e.handleChange(l),disabled:e.form.state.isSubmitting,children:[f.jsx(rp,{id:e.name+"-trigger",onBlur:e.handleBlur,className:Xe(i,e.state.meta.errors.length?"border-destructive":""),children:f.jsx(np,{placeholder:n||"Select an option"})}),f.jsx(sp,{children:s.map((l,c)=>{const u=typeof l=="string"?l:l.value,d=typeof l=="string"?l:l.label;return f.jsx(Ro,{value:u,children:d},u+c)})})]}),e.state.meta.isTouched&&e.state.meta.errors.length>0&&f.jsx("div",{className:"text-xs text-destructive pt-1",children:e.state.meta.errors.map((l,c)=>f.jsx("p",{children:String(l)},c))})]}),pVe=({fieldApi:e,label:t,description:n,labelClassName:r,wrapperClassName:s})=>f.jsxs("div",{className:Xe("space-y-1.5",s),children:[f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx($c,{id:e.name,checked:!!e.state.value,onCheckedChange:i=>e.handleChange(!!i),onBlur:e.handleBlur,disabled:e.form.state.isSubmitting,"aria-describedby":n?`${e.name}-description`:void 0}),t&&f.jsx(Ot,{htmlFor:e.name,className:Xe("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",r),children:t})]}),n&&f.jsx("p",{id:`${e.name}-description`,className:"text-xs text-muted-foreground",children:n}),e.state.meta.isTouched&&e.state.meta.errors.length>0&&f.jsx("div",{className:"text-xs text-destructive pt-1",children:e.state.meta.errors.map((i,a)=>f.jsx("p",{children:String(i)},a))})]}),mVe=({fieldApi:e,label:t,description:n,labelClassName:r,wrapperClassName:s})=>f.jsxs("div",{className:Xe("space-y-1.5",s),children:[f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(Oo,{id:e.name,checked:!!e.state.value,onCheckedChange:i=>e.handleChange(i),onBlur:e.handleBlur,disabled:e.form.state.isSubmitting,"aria-describedby":n?`${e.name}-description`:void 0}),t&&f.jsx(Ot,{htmlFor:e.name,className:Xe("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",r),children:t})]}),n&&f.jsx("p",{id:`${e.name}-description`,className:"text-xs text-muted-foreground",children:n}),e.state.meta.isTouched&&e.state.meta.errors.length>0&&f.jsx("div",{className:"text-xs text-destructive pt-1",children:e.state.meta.errors.map((i,a)=>f.jsx("p",{children:String(i)},a))})]}),gVe=({fieldApi:e,label:t,description:n,placeholder:r,inputClassName:s,labelClassName:i,wrapperClassName:a,min:o,max:l,step:c})=>{const{name:u,state:d,handleChange:h,handleBlur:m}=e,y=d.value,b=x=>{const w=x.target.value;if(w==="")h(void 0);else{const S=parseFloat(w);h(isNaN(S)?w:S)}};let v="";return(typeof y=="number"||typeof y=="string")&&(v=y),f.jsxs("div",{className:Xe("space-y-1.5",a),children:[t&&f.jsx(Ot,{htmlFor:u,className:Xe("text-sm font-medium",i),children:t}),n&&f.jsx("p",{className:"text-xs text-muted-foreground",children:n}),f.jsx(Cn,{id:u,name:u,type:"number",value:v,onBlur:m,onChange:b,placeholder:r,min:o,max:l,step:c,className:Xe(s,d.meta.errors.length?"border-destructive":""),disabled:e.form.state.isSubmitting}),d.meta.isTouched&&d.meta.errors.length>0&&f.jsx("div",{className:"text-xs text-destructive pt-1",children:d.meta.errors.map((x,w)=>f.jsx("p",{children:typeof x=="string"?x:(x==null?void 0:x.message)||"Invalid"},w))})]})},m3={},yx={};function Px(e,t){try{const r=(m3[e]||(m3[e]=new Intl.DateTimeFormat("en-GB",{timeZone:e,hour:"numeric",timeZoneName:"longOffset"}).format))(t).split("GMT")[1]||"";return r in yx?yx[r]:Lq(r,r.split(":"))}catch{if(e in yx)return yx[e];const n=e==null?void 0:e.match(yVe);return n?Lq(e,n.slice(1)):NaN}}const yVe=/([+-]\d\d):?(\d\d)?/;function Lq(e,t){const n=+t[0],r=+(t[1]||0);return yx[e]=n>0?n*60+r:n*60-r}class Su extends Date{constructor(...t){super(),t.length>1&&typeof t[t.length-1]=="string"&&(this.timeZone=t.pop()),this.internal=new Date,isNaN(Px(this.timeZone,this))?this.setTime(NaN):t.length?typeof t[0]=="number"&&(t.length===1||t.length===2&&typeof t[1]!="number")?this.setTime(t[0]):typeof t[0]=="string"?this.setTime(+new Date(t[0])):t[0]instanceof Date?this.setTime(+t[0]):(this.setTime(+new Date(...t)),Gse(this),P4(this)):this.setTime(Date.now())}static tz(t,...n){return n.length?new Su(...n,t):new Su(Date.now(),t)}withTimeZone(t){return new Su(+this,t)}getTimezoneOffset(){return-Px(this.timeZone,this)}setTime(t){return Date.prototype.setTime.apply(this,arguments),P4(this),+this}[Symbol.for("constructDateFrom")](t){return new Su(+new Date(t),this.timeZone)}}const Bq=/^(get|set)(?!UTC)/;Object.getOwnPropertyNames(Date.prototype).forEach(e=>{if(!Bq.test(e))return;const t=e.replace(Bq,"$1UTC");Su.prototype[t]&&(e.startsWith("get")?Su.prototype[e]=function(){return this.internal[t]()}:(Su.prototype[e]=function(){return Date.prototype[t].apply(this.internal,arguments),bVe(this),+this},Su.prototype[t]=function(){return Date.prototype[t].apply(this,arguments),P4(this),+this}))});function P4(e){e.internal.setTime(+e),e.internal.setUTCMinutes(e.internal.getUTCMinutes()-e.getTimezoneOffset())}function bVe(e){Date.prototype.setFullYear.call(e,e.internal.getUTCFullYear(),e.internal.getUTCMonth(),e.internal.getUTCDate()),Date.prototype.setHours.call(e,e.internal.getUTCHours(),e.internal.getUTCMinutes(),e.internal.getUTCSeconds(),e.internal.getUTCMilliseconds()),Gse(e)}function Gse(e){const t=Px(e.timeZone,e),n=new Date(+e);n.setUTCHours(n.getUTCHours()-1);const r=-new Date(+e).getTimezoneOffset(),s=-new Date(+n).getTimezoneOffset(),i=r-s,a=Date.prototype.getHours.apply(e)!==e.internal.getUTCHours();i&&a&&e.internal.setUTCMinutes(e.internal.getUTCMinutes()+i);const o=r-t;o&&Date.prototype.setUTCMinutes.call(e,Date.prototype.getUTCMinutes.call(e)+o);const l=Px(e.timeZone,e),u=-new Date(+e).getTimezoneOffset()-l,d=l!==t,h=u-o;if(d&&h){Date.prototype.setUTCMinutes.call(e,Date.prototype.getUTCMinutes.call(e)+h);const m=Px(e.timeZone,e),y=l-m;y&&(e.internal.setUTCMinutes(e.internal.getUTCMinutes()+y),Date.prototype.setUTCMinutes.call(e,Date.prototype.getUTCMinutes.call(e)+y))}}class Pa extends Su{static tz(t,...n){return n.length?new Pa(...n,t):new Pa(Date.now(),t)}toISOString(){const[t,n,r]=this.tzComponents(),s=`${t}${n}:${r}`;return this.internal.toISOString().slice(0,-1)+s}toString(){return`${this.toDateString()} ${this.toTimeString()}`}toDateString(){const[t,n,r,s]=this.internal.toUTCString().split(" ");return`${t==null?void 0:t.slice(0,-1)} ${r} ${n} ${s}`}toTimeString(){const t=this.internal.toUTCString().split(" ")[4],[n,r,s]=this.tzComponents();return`${t} GMT${n}${r}${s} (${vVe(this.timeZone,this)})`}toLocaleString(t,n){return Date.prototype.toLocaleString.call(this,t,{...n,timeZone:(n==null?void 0:n.timeZone)||this.timeZone})}toLocaleDateString(t,n){return Date.prototype.toLocaleDateString.call(this,t,{...n,timeZone:(n==null?void 0:n.timeZone)||this.timeZone})}toLocaleTimeString(t,n){return Date.prototype.toLocaleTimeString.call(this,t,{...n,timeZone:(n==null?void 0:n.timeZone)||this.timeZone})}tzComponents(){const t=this.getTimezoneOffset(),n=t>0?"-":"+",r=String(Math.floor(Math.abs(t)/60)).padStart(2,"0"),s=String(Math.abs(t)%60).padStart(2,"0");return[n,r,s]}withTimeZone(t){return new Pa(+this,t)}[Symbol.for("constructDateFrom")](t){return new Pa(+new Date(t),this.timeZone)}}function vVe(e,t){return new Intl.DateTimeFormat("en-GB",{timeZone:e,timeZoneName:"long"}).format(t).slice(12)}var Bn;(function(e){e.Root="root",e.Chevron="chevron",e.Day="day",e.DayButton="day_button",e.CaptionLabel="caption_label",e.Dropdowns="dropdowns",e.Dropdown="dropdown",e.DropdownRoot="dropdown_root",e.Footer="footer",e.MonthGrid="month_grid",e.MonthCaption="month_caption",e.MonthsDropdown="months_dropdown",e.Month="month",e.Months="months",e.Nav="nav",e.NextMonthButton="button_next",e.PreviousMonthButton="button_previous",e.Week="week",e.Weeks="weeks",e.Weekday="weekday",e.Weekdays="weekdays",e.WeekNumber="week_number",e.WeekNumberHeader="week_number_header",e.YearsDropdown="years_dropdown"})(Bn||(Bn={}));var Qs;(function(e){e.disabled="disabled",e.hidden="hidden",e.outside="outside",e.focused="focused",e.today="today"})(Qs||(Qs={}));var Cc;(function(e){e.range_end="range_end",e.range_middle="range_middle",e.range_start="range_start",e.selected="selected"})(Cc||(Cc={}));var ol;(function(e){e.weeks_before_enter="weeks_before_enter",e.weeks_before_exit="weeks_before_exit",e.weeks_after_enter="weeks_after_enter",e.weeks_after_exit="weeks_after_exit",e.caption_after_enter="caption_after_enter",e.caption_after_exit="caption_after_exit",e.caption_before_enter="caption_before_enter",e.caption_before_exit="caption_before_exit"})(ol||(ol={}));const $q=5,xVe=4;function wVe(e,t){const n=t.startOfMonth(e),r=n.getDay()>0?n.getDay():7,s=t.addDays(e,-r+1),i=t.addDays(s,$q*7-1);return t.getMonth(e)===t.getMonth(i)?$q:xVe}function Kse(e,t){const n=t.startOfMonth(e),r=n.getDay();return r===1?n:r===0?t.addDays(n,-1*6):t.addDays(n,-1*(r-1))}function _Ve(e,t){const n=Kse(e,t),r=wVe(e,t);return t.addDays(n,r*7-1)}class uf{constructor(t,n){this.Date=Date,this.today=()=>{var r;return(r=this.overrides)!=null&&r.today?this.overrides.today():this.options.timeZone?Pa.tz(this.options.timeZone):new this.Date},this.newDate=(r,s,i)=>{var a;return(a=this.overrides)!=null&&a.newDate?this.overrides.newDate(r,s,i):this.options.timeZone?new Pa(r,s,i,this.options.timeZone):new Date(r,s,i)},this.addDays=(r,s)=>{var i;return(i=this.overrides)!=null&&i.addDays?this.overrides.addDays(r,s):jZ(r,s)},this.addMonths=(r,s)=>{var i;return(i=this.overrides)!=null&&i.addMonths?this.overrides.addMonths(r,s):OZ(r,s)},this.addWeeks=(r,s)=>{var i;return(i=this.overrides)!=null&&i.addWeeks?this.overrides.addWeeks(r,s):CTe(r,s)},this.addYears=(r,s)=>{var i;return(i=this.overrides)!=null&&i.addYears?this.overrides.addYears(r,s):kTe(r,s)},this.differenceInCalendarDays=(r,s)=>{var i;return(i=this.overrides)!=null&&i.differenceInCalendarDays?this.overrides.differenceInCalendarDays(r,s):DZ(r,s)},this.differenceInCalendarMonths=(r,s)=>{var i;return(i=this.overrides)!=null&&i.differenceInCalendarMonths?this.overrides.differenceInCalendarMonths(r,s):LZ(r,s)},this.eachMonthOfInterval=r=>{var s;return(s=this.overrides)!=null&&s.eachMonthOfInterval?this.overrides.eachMonthOfInterval(r):LTe(r)},this.endOfBroadcastWeek=r=>{var s;return(s=this.overrides)!=null&&s.endOfBroadcastWeek?this.overrides.endOfBroadcastWeek(r):_Ve(r,this)},this.endOfISOWeek=r=>{var s;return(s=this.overrides)!=null&&s.endOfISOWeek?this.overrides.endOfISOWeek(r):zTe(r)},this.endOfMonth=r=>{var s;return(s=this.overrides)!=null&&s.endOfMonth?this.overrides.endOfMonth(r):BZ(r)},this.endOfWeek=(r,s)=>{var i;return(i=this.overrides)!=null&&i.endOfWeek?this.overrides.endOfWeek(r,s):zZ(r,this.options)},this.endOfYear=r=>{var s;return(s=this.overrides)!=null&&s.endOfYear?this.overrides.endOfYear(r):$Te(r)},this.format=(r,s,i)=>{var o;const a=(o=this.overrides)!=null&&o.format?this.overrides.format(r,s,this.options):Md(r,s,this.options);return this.options.numerals&&this.options.numerals!=="latn"?this.replaceDigits(a):a},this.getISOWeek=r=>{var s;return(s=this.overrides)!=null&&s.getISOWeek?this.overrides.getISOWeek(r):UZ(r)},this.getMonth=(r,s)=>{var i;return(i=this.overrides)!=null&&i.getMonth?this.overrides.getMonth(r,this.options):BAe(r,this.options)},this.getYear=(r,s)=>{var i;return(i=this.overrides)!=null&&i.getYear?this.overrides.getYear(r,this.options):$Ae(r,this.options)},this.getWeek=(r,s)=>{var i;return(i=this.overrides)!=null&&i.getWeek?this.overrides.getWeek(r,this.options):VZ(r,this.options)},this.isAfter=(r,s)=>{var i;return(i=this.overrides)!=null&&i.isAfter?this.overrides.isAfter(r,s):zAe(r,s)},this.isBefore=(r,s)=>{var i;return(i=this.overrides)!=null&&i.isBefore?this.overrides.isBefore(r,s):UAe(r,s)},this.isDate=r=>{var s;return(s=this.overrides)!=null&&s.isDate?this.overrides.isDate(r):FZ(r)},this.isSameDay=(r,s)=>{var i;return(i=this.overrides)!=null&&i.isSameDay?this.overrides.isSameDay(r,s):RTe(r,s)},this.isSameMonth=(r,s)=>{var i;return(i=this.overrides)!=null&&i.isSameMonth?this.overrides.isSameMonth(r,s):qAe(r,s)},this.isSameYear=(r,s)=>{var i;return(i=this.overrides)!=null&&i.isSameYear?this.overrides.isSameYear(r,s):VAe(r,s)},this.max=r=>{var s;return(s=this.overrides)!=null&&s.max?this.overrides.max(r):ETe(r)},this.min=r=>{var s;return(s=this.overrides)!=null&&s.min?this.overrides.min(r):TTe(r)},this.setMonth=(r,s)=>{var i;return(i=this.overrides)!=null&&i.setMonth?this.overrides.setMonth(r,s):oRe(r,s)},this.setYear=(r,s)=>{var i;return(i=this.overrides)!=null&&i.setYear?this.overrides.setYear(r,s):lRe(r,s)},this.startOfBroadcastWeek=(r,s)=>{var i;return(i=this.overrides)!=null&&i.startOfBroadcastWeek?this.overrides.startOfBroadcastWeek(r,this):Kse(r,this)},this.startOfDay=r=>{var s;return(s=this.overrides)!=null&&s.startOfDay?this.overrides.startOfDay(r):Cw(r)},this.startOfISOWeek=r=>{var s;return(s=this.overrides)!=null&&s.startOfISOWeek?this.overrides.startOfISOWeek(r):Sw(r)},this.startOfMonth=r=>{var s;return(s=this.overrides)!=null&&s.startOfMonth?this.overrides.startOfMonth(r):BTe(r)},this.startOfWeek=(r,s)=>{var i;return(i=this.overrides)!=null&&i.startOfWeek?this.overrides.startOfWeek(r,this.options):xy(r,this.options)},this.startOfYear=r=>{var s;return(s=this.overrides)!=null&&s.startOfYear?this.overrides.startOfYear(r):$Z(r)},this.options={locale:cT,...t},this.overrides=n}getDigitMap(){const{numerals:t="latn"}=this.options,n=new Intl.NumberFormat("en-US",{numberingSystem:t}),r={};for(let s=0;s<10;s++)r[s.toString()]=n.format(s);return r}replaceDigits(t){const n=this.getDigitMap();return t.replace(/\d/g,r=>n[r]||r)}formatNumber(t){return this.replaceDigits(t.toString())}}const Wu=new uf;class Yse{constructor(t,n,r=Wu){this.date=t,this.displayMonth=n,this.outside=!!(n&&!r.isSameMonth(t,n)),this.dateLib=r}isEqualTo(t){return this.dateLib.isSameDay(t.date,this.date)&&this.dateLib.isSameMonth(t.displayMonth,this.displayMonth)}}class SVe{constructor(t,n){this.date=t,this.weeks=n}}class CVe{constructor(t,n){this.days=n,this.weekNumber=t}}function Id(e,t,n=!1,r=Wu){let{from:s,to:i}=e;const{differenceInCalendarDays:a,isSameDay:o}=r;return s&&i?(a(i,s)<0&&([s,i]=[i,s]),a(t,s)>=(n?1:0)&&a(i,t)>=(n?1:0)):!n&&i?o(i,t):!n&&s?o(s,t):!1}function Zse(e){return!!(e&&typeof e=="object"&&"before"in e&&"after"in e)}function tF(e){return!!(e&&typeof e=="object"&&"from"in e)}function Xse(e){return!!(e&&typeof e=="object"&&"after"in e)}function Jse(e){return!!(e&&typeof e=="object"&&"before"in e)}function Qse(e){return!!(e&&typeof e=="object"&&"dayOfWeek"in e)}function eie(e,t){return Array.isArray(e)&&e.every(t.isDate)}function jd(e,t,n=Wu){const r=Array.isArray(t)?t:[t],{isSameDay:s,differenceInCalendarDays:i,isAfter:a}=n;return r.some(o=>{if(typeof o=="boolean")return o;if(n.isDate(o))return s(e,o);if(eie(o,n))return o.includes(e);if(tF(o))return Id(o,e,!1,n);if(Qse(o))return Array.isArray(o.dayOfWeek)?o.dayOfWeek.includes(e.getDay()):o.dayOfWeek===e.getDay();if(Zse(o)){const l=i(o.before,e),c=i(o.after,e),u=l>0,d=c<0;return a(o.before,o.after)?d&&u:u||d}return Xse(o)?i(e,o.after)>0:Jse(o)?i(o.before,e)>0:typeof o=="function"?o(e):!1})}function kVe(e,t,n){const{disabled:r,hidden:s,modifiers:i,showOutsideDays:a,broadcastCalendar:o,today:l}=t,{isSameDay:c,isSameMonth:u,startOfMonth:d,isBefore:h,endOfMonth:m,isAfter:y}=n,b=t.startMonth&&d(t.startMonth),v=t.endMonth&&m(t.endMonth),x={[Qs.focused]:[],[Qs.outside]:[],[Qs.disabled]:[],[Qs.hidden]:[],[Qs.today]:[]},w={};for(const S of e){const{date:k,displayMonth:C}=S,T=!!(C&&!u(k,C)),R=!!(b&&h(k,b)),N=!!(v&&y(k,v)),I=!!(r&&jd(k,r,n)),P=!!(s&&jd(k,s,n))||R||N||!o&&!a&&T||o&&a===!1&&T,B=c(k,l??n.today());T&&x.outside.push(S),I&&x.disabled.push(S),P&&x.hidden.push(S),B&&x.today.push(S),i&&Object.keys(i).forEach(D=>{const W=i==null?void 0:i[D];W&&jd(k,W,n)&&(w[D]?w[D].push(S):w[D]=[S])})}return S=>{const k={[Qs.focused]:!1,[Qs.disabled]:!1,[Qs.hidden]:!1,[Qs.outside]:!1,[Qs.today]:!1},C={};for(const T in x){const R=x[T];k[T]=R.some(N=>N===S)}for(const T in w)C[T]=w[T].some(R=>R===S);return{...k,...C}}}function EVe(e,t,n={}){return Object.entries(e).filter(([,s])=>s===!0).reduce((s,[i])=>(n[i]?s.push(n[i]):t[Qs[i]]?s.push(t[Qs[i]]):t[Cc[i]]&&s.push(t[Cc[i]]),s),[t[Bn.Day]])}function TVe(e){return Ve.createElement("button",{...e})}function AVe(e){return Ve.createElement("span",{...e})}function RVe(e){const{size:t=24,orientation:n="left",className:r}=e;return Ve.createElement("svg",{className:r,width:t,height:t,viewBox:"0 0 24 24"},n==="up"&&Ve.createElement("polygon",{points:"6.77 17 12.5 11.43 18.24 17 20 15.28 12.5 8 5 15.28"}),n==="down"&&Ve.createElement("polygon",{points:"6.77 8 12.5 13.57 18.24 8 20 9.72 12.5 17 5 9.72"}),n==="left"&&Ve.createElement("polygon",{points:"16 18.112 9.81111111 12 16 5.87733333 14.0888889 4 6 12 14.0888889 20"}),n==="right"&&Ve.createElement("polygon",{points:"8 18.112 14.18888889 12 8 5.87733333 9.91111111 4 18 12 9.91111111 20"}))}function NVe(e){const{day:t,modifiers:n,...r}=e;return Ve.createElement("td",{...r})}function MVe(e){const{day:t,modifiers:n,...r}=e,s=Ve.useRef(null);return Ve.useEffect(()=>{var i;n.focused&&((i=s.current)==null||i.focus())},[n.focused]),Ve.createElement("button",{ref:s,...r})}function IVe(e){const{options:t,className:n,components:r,classNames:s,...i}=e,a=[s[Bn.Dropdown],n].join(" "),o=t==null?void 0:t.find(({value:l})=>l===i.value);return Ve.createElement("span",{"data-disabled":i.disabled,className:s[Bn.DropdownRoot]},Ve.createElement(r.Select,{className:a,...i},t==null?void 0:t.map(({value:l,label:c,disabled:u})=>Ve.createElement(r.Option,{key:l,value:l,disabled:u},c))),Ve.createElement("span",{className:s[Bn.CaptionLabel],"aria-hidden":!0},o==null?void 0:o.label,Ve.createElement(r.Chevron,{orientation:"down",size:18,className:s[Bn.Chevron]})))}function jVe(e){return Ve.createElement("div",{...e})}function OVe(e){return Ve.createElement("div",{...e})}function PVe(e){const{calendarMonth:t,displayIndex:n,...r}=e;return Ve.createElement("div",{...r},e.children)}function DVe(e){const{calendarMonth:t,displayIndex:n,...r}=e;return Ve.createElement("div",{...r})}function FVe(e){return Ve.createElement("table",{...e})}function LVe(e){return Ve.createElement("div",{...e})}const tie=E.createContext(void 0);function s_(){const e=E.useContext(tie);if(e===void 0)throw new Error("useDayPicker() must be used within a custom component.");return e}function BVe(e){const{components:t}=s_();return Ve.createElement(t.Dropdown,{...e})}function $Ve(e){const{onPreviousClick:t,onNextClick:n,previousMonth:r,nextMonth:s,...i}=e,{components:a,classNames:o,labels:{labelPrevious:l,labelNext:c}}=s_(),u=E.useCallback(h=>{s&&(n==null||n(h))},[s,n]),d=E.useCallback(h=>{r&&(t==null||t(h))},[r,t]);return Ve.createElement("nav",{...i},Ve.createElement(a.PreviousMonthButton,{type:"button",className:o[Bn.PreviousMonthButton],tabIndex:r?void 0:-1,"aria-disabled":r?void 0:!0,"aria-label":l(r),onClick:d},Ve.createElement(a.Chevron,{disabled:r?void 0:!0,className:o[Bn.Chevron],orientation:"left"})),Ve.createElement(a.NextMonthButton,{type:"button",className:o[Bn.NextMonthButton],tabIndex:s?void 0:-1,"aria-disabled":s?void 0:!0,"aria-label":c(s),onClick:u},Ve.createElement(a.Chevron,{disabled:s?void 0:!0,orientation:"right",className:o[Bn.Chevron]})))}function zVe(e){const{components:t}=s_();return Ve.createElement(t.Button,{...e})}function UVe(e){return Ve.createElement("option",{...e})}function qVe(e){const{components:t}=s_();return Ve.createElement(t.Button,{...e})}function VVe(e){const{rootRef:t,...n}=e;return Ve.createElement("div",{...n,ref:t})}function WVe(e){return Ve.createElement("select",{...e})}function HVe(e){const{week:t,...n}=e;return Ve.createElement("tr",{...n})}function GVe(e){return Ve.createElement("th",{...e})}function KVe(e){return Ve.createElement("thead",{"aria-hidden":!0},Ve.createElement("tr",{...e}))}function YVe(e){const{week:t,...n}=e;return Ve.createElement("th",{...n})}function ZVe(e){return Ve.createElement("th",{...e})}function XVe(e){return Ve.createElement("tbody",{...e})}function JVe(e){const{components:t}=s_();return Ve.createElement(t.Dropdown,{...e})}const QVe=Object.freeze(Object.defineProperty({__proto__:null,Button:TVe,CaptionLabel:AVe,Chevron:RVe,Day:NVe,DayButton:MVe,Dropdown:IVe,DropdownNav:jVe,Footer:OVe,Month:PVe,MonthCaption:DVe,MonthGrid:FVe,Months:LVe,MonthsDropdown:BVe,Nav:$Ve,NextMonthButton:zVe,Option:UVe,PreviousMonthButton:qVe,Root:VVe,Select:WVe,Week:HVe,WeekNumber:YVe,WeekNumberHeader:ZVe,Weekday:GVe,Weekdays:KVe,Weeks:XVe,YearsDropdown:JVe},Symbol.toStringTag,{value:"Module"}));function eWe(e){return{...QVe,...e}}function tWe(e){const t={"data-mode":e.mode??void 0,"data-required":"required"in e?e.required:void 0,"data-multiple-months":e.numberOfMonths&&e.numberOfMonths>1||void 0,"data-week-numbers":e.showWeekNumber||void 0,"data-broadcast-calendar":e.broadcastCalendar||void 0,"data-nav-layout":e.navLayout||void 0};return Object.entries(e).forEach(([n,r])=>{n.startsWith("data-")&&(t[n]=r)}),t}function nF(){const e={};for(const t in Bn)e[Bn[t]]=`rdp-${Bn[t]}`;for(const t in Qs)e[Qs[t]]=`rdp-${Qs[t]}`;for(const t in Cc)e[Cc[t]]=`rdp-${Cc[t]}`;for(const t in ol)e[ol[t]]=`rdp-${ol[t]}`;return e}function nie(e,t,n){return(n??new uf(t)).format(e,"LLLL y")}const nWe=nie;function rWe(e,t,n){return(n??new uf(t)).format(e,"d")}function sWe(e,t=Wu){return t.format(e,"LLLL")}function iWe(e,t=Wu){return e<10?t.formatNumber(`0${e.toLocaleString()}`):t.formatNumber(`${e.toLocaleString()}`)}function aWe(){return""}function oWe(e,t,n){return(n??new uf(t)).format(e,"cccccc")}function rie(e,t=Wu){return t.format(e,"yyyy")}const lWe=rie,cWe=Object.freeze(Object.defineProperty({__proto__:null,formatCaption:nie,formatDay:rWe,formatMonthCaption:nWe,formatMonthDropdown:sWe,formatWeekNumber:iWe,formatWeekNumberHeader:aWe,formatWeekdayName:oWe,formatYearCaption:lWe,formatYearDropdown:rie},Symbol.toStringTag,{value:"Module"}));function uWe(e){return e!=null&&e.formatMonthCaption&&!e.formatCaption&&(e.formatCaption=e.formatMonthCaption),e!=null&&e.formatYearCaption&&!e.formatYearDropdown&&(e.formatYearDropdown=e.formatYearCaption),{...cWe,...e}}function dWe(e,t,n,r,s){const{startOfMonth:i,startOfYear:a,endOfYear:o,eachMonthOfInterval:l,getMonth:c}=s;return l({start:a(e),end:o(e)}).map(h=>{const m=r.formatMonthDropdown(h,s),y=c(h),b=t&&h<i(t)||n&&h>i(n)||!1;return{value:y,label:m,disabled:b}})}function fWe(e,t={},n={}){let r={...t==null?void 0:t[Bn.Day]};return Object.entries(e).filter(([,s])=>s===!0).forEach(([s])=>{r={...r,...n==null?void 0:n[s]}}),r}function hWe(e,t,n){const r=e.today(),s=t?e.startOfISOWeek(r):e.startOfWeek(r),i=[];for(let a=0;a<7;a++){const o=e.addDays(s,a);i.push(o)}return i}function pWe(e,t,n,r){if(!e||!t)return;const{startOfYear:s,endOfYear:i,addYears:a,getYear:o,isBefore:l,isSameYear:c}=r,u=s(e),d=i(t),h=[];let m=u;for(;l(m,d)||c(m,d);)h.push(m),m=a(m,1);return h.map(y=>{const b=n.formatYearDropdown(y,r);return{value:o(y),label:b,disabled:!1}})}function sie(e,t,n){return(n??new uf(t)).format(e,"LLLL y")}const mWe=sie;function gWe(e,t,n,r){let s=(r??new uf(n)).format(e,"PPPP");return t!=null&&t.today&&(s=`Today, ${s}`),s}function iie(e,t,n,r){let s=(r??new uf(n)).format(e,"PPPP");return t.today&&(s=`Today, ${s}`),t.selected&&(s=`${s}, selected`),s}const yWe=iie;function bWe(){return""}function vWe(e){return"Choose the Month"}function xWe(e){return"Go to the Next Month"}function wWe(e){return"Go to the Previous Month"}function _We(e,t,n){return(n??new uf(t)).format(e,"cccc")}function SWe(e,t){return`Week ${e}`}function CWe(e){return"Week Number"}function kWe(e){return"Choose the Year"}const EWe=Object.freeze(Object.defineProperty({__proto__:null,labelCaption:mWe,labelDay:yWe,labelDayButton:iie,labelGrid:sie,labelGridcell:gWe,labelMonthDropdown:vWe,labelNav:bWe,labelNext:xWe,labelPrevious:wWe,labelWeekNumber:SWe,labelWeekNumberHeader:CWe,labelWeekday:_We,labelYearDropdown:kWe},Symbol.toStringTag,{value:"Module"})),i_=e=>e instanceof HTMLElement?e:null,g3=e=>[...e.querySelectorAll("[data-animated-month]")??[]],TWe=e=>i_(e.querySelector("[data-animated-month]")),y3=e=>i_(e.querySelector("[data-animated-caption]")),b3=e=>i_(e.querySelector("[data-animated-weeks]")),AWe=e=>i_(e.querySelector("[data-animated-nav]")),RWe=e=>i_(e.querySelector("[data-animated-weekdays]"));function NWe(e,t,{classNames:n,months:r,focused:s,dateLib:i}){const a=E.useRef(null),o=E.useRef(r),l=E.useRef(!1);E.useLayoutEffect(()=>{const c=o.current;if(o.current=r,!t||!e.current||!(e.current instanceof HTMLElement)||r.length===0||c.length===0||r.length!==c.length)return;const u=i.isSameMonth(r[0].date,c[0].date),d=i.isAfter(r[0].date,c[0].date),h=d?n[ol.caption_after_enter]:n[ol.caption_before_enter],m=d?n[ol.weeks_after_enter]:n[ol.weeks_before_enter],y=a.current,b=e.current.cloneNode(!0);if(b instanceof HTMLElement?(g3(b).forEach(S=>{if(!(S instanceof HTMLElement))return;const k=TWe(S);k&&S.contains(k)&&S.removeChild(k);const C=y3(S);C&&C.classList.remove(h);const T=b3(S);T&&T.classList.remove(m)}),a.current=b):a.current=null,l.current||u||s)return;const v=y instanceof HTMLElement?g3(y):[],x=g3(e.current);if(x&&x.every(w=>w instanceof HTMLElement)&&v&&v.every(w=>w instanceof HTMLElement)){l.current=!0,e.current.style.isolation="isolate";const w=AWe(e.current);w&&(w.style.zIndex="1"),x.forEach((S,k)=>{const C=v[k];if(!C)return;S.style.position="relative",S.style.overflow="hidden";const T=y3(S);T&&T.classList.add(h);const R=b3(S);R&&R.classList.add(m);const N=()=>{l.current=!1,e.current&&(e.current.style.isolation=""),w&&(w.style.zIndex=""),T&&T.classList.remove(h),R&&R.classList.remove(m),S.style.position="",S.style.overflow="",S.contains(C)&&S.removeChild(C)};C.style.pointerEvents="none",C.style.position="absolute",C.style.overflow="hidden",C.setAttribute("aria-hidden","true");const I=RWe(C);I&&(I.style.opacity="0");const P=y3(C);P&&(P.classList.add(d?n[ol.caption_before_exit]:n[ol.caption_after_exit]),P.addEventListener("animationend",N));const B=b3(C);B&&B.classList.add(d?n[ol.weeks_before_exit]:n[ol.weeks_after_exit]),S.insertBefore(C,S.firstChild)})}})}function MWe(e,t,n,r){const s=e[0],i=e[e.length-1],{ISOWeek:a,fixedWeeks:o,broadcastCalendar:l}=n??{},{addDays:c,differenceInCalendarDays:u,differenceInCalendarMonths:d,endOfBroadcastWeek:h,endOfISOWeek:m,endOfMonth:y,endOfWeek:b,isAfter:v,startOfBroadcastWeek:x,startOfISOWeek:w,startOfWeek:S}=r,k=l?x(s,r):a?w(s):S(s),C=l?h(i):a?m(y(i)):b(y(i)),T=u(C,k),R=d(i,s)+1,N=[];for(let B=0;B<=T;B++){const D=c(k,B);if(t&&v(D,t))break;N.push(D)}const P=(l?35:42)*R;if(o&&N.length<P){const B=P-N.length;for(let D=0;D<B;D++){const W=c(N[N.length-1],1);N.push(W)}}return N}function IWe(e){const t=[];return e.reduce((n,r)=>{const s=r.weeks.reduce((i,a)=>[...i,...a.days],t);return[...n,...s]},t)}function jWe(e,t,n,r){const{numberOfMonths:s=1}=n,i=[];for(let a=0;a<s;a++){const o=r.addMonths(e,a);if(t&&o>t)break;i.push(o)}return i}function zq(e,t){const{month:n,defaultMonth:r,today:s=t.today(),numberOfMonths:i=1,endMonth:a,startMonth:o}=e;let l=n||r||s;const{differenceInCalendarMonths:c,addMonths:u,startOfMonth:d}=t;if(a&&c(a,l)<0){const h=-1*(i-1);l=u(a,h)}return o&&c(l,o)<0&&(l=o),d(l)}function OWe(e,t,n,r){const{addDays:s,endOfBroadcastWeek:i,endOfISOWeek:a,endOfMonth:o,endOfWeek:l,getISOWeek:c,getWeek:u,startOfBroadcastWeek:d,startOfISOWeek:h,startOfWeek:m}=r,y=e.reduce((b,v)=>{const x=n.broadcastCalendar?d(v,r):n.ISOWeek?h(v):m(v),w=n.broadcastCalendar?i(v):n.ISOWeek?a(o(v)):l(o(v)),S=t.filter(R=>R>=x&&R<=w),k=n.broadcastCalendar?35:42;if(n.fixedWeeks&&S.length<k){const R=t.filter(N=>{const I=k-S.length;return N>w&&N<=s(w,I)});S.push(...R)}const C=S.reduce((R,N)=>{const I=n.ISOWeek?c(N):u(N),P=R.find(D=>D.weekNumber===I),B=new Yse(N,v,r);return P?P.days.push(B):R.push(new CVe(I,[B])),R},[]),T=new SVe(v,C);return b.push(T),b},[]);return n.reverseMonths?y.reverse():y}function PWe(e,t){let{startMonth:n,endMonth:r}=e;const{startOfYear:s,startOfDay:i,startOfMonth:a,endOfMonth:o,addYears:l,endOfYear:c,newDate:u,today:d}=t,{fromYear:h,toYear:m,fromMonth:y,toMonth:b}=e;!n&&y&&(n=y),!n&&h&&(n=t.newDate(h,0,1)),!r&&b&&(r=b),!r&&m&&(r=u(m,11,31));const v=e.captionLayout==="dropdown"||e.captionLayout==="dropdown-years";return n?n=a(n):h?n=u(h,0,1):!n&&v&&(n=s(l(e.today??d(),-100))),r?r=o(r):m?r=u(m,11,31):!r&&v&&(r=c(e.today??d())),[n&&i(n),r&&i(r)]}function DWe(e,t,n,r){if(n.disableNavigation)return;const{pagedNavigation:s,numberOfMonths:i=1}=n,{startOfMonth:a,addMonths:o,differenceInCalendarMonths:l}=r,c=s?i:1,u=a(e);if(!t)return o(u,c);if(!(l(t,e)<i))return o(u,c)}function FWe(e,t,n,r){if(n.disableNavigation)return;const{pagedNavigation:s,numberOfMonths:i}=n,{startOfMonth:a,addMonths:o,differenceInCalendarMonths:l}=r,c=s?i??1:1,u=a(e);if(!t)return o(u,-c);if(!(l(u,t)<=0))return o(u,-c)}function LWe(e){const t=[];return e.reduce((n,r)=>[...n,...r.weeks],t)}function HT(e,t){const[n,r]=E.useState(e);return[t===void 0?n:t,r]}function BWe(e,t){const[n,r]=PWe(e,t),{startOfMonth:s,endOfMonth:i}=t,a=zq(e,t),[o,l]=HT(a,e.month?a:void 0);E.useEffect(()=>{const T=zq(e,t);l(T)},[e.timeZone]);const c=jWe(o,r,e,t),u=MWe(c,e.endMonth?i(e.endMonth):void 0,e,t),d=OWe(c,u,e,t),h=LWe(d),m=IWe(d),y=FWe(o,n,e,t),b=DWe(o,r,e,t),{disableNavigation:v,onMonthChange:x}=e,w=T=>h.some(R=>R.days.some(N=>N.isEqualTo(T))),S=T=>{if(v)return;let R=s(T);n&&R<s(n)&&(R=s(n)),r&&R>s(r)&&(R=s(r)),l(R),x==null||x(R)};return{months:d,weeks:h,days:m,navStart:n,navEnd:r,previousMonth:y,nextMonth:b,goToMonth:S,goToDay:T=>{w(T)||S(T.date)}}}var du;(function(e){e[e.Today=0]="Today",e[e.Selected=1]="Selected",e[e.LastFocused=2]="LastFocused",e[e.FocusedModifier=3]="FocusedModifier"})(du||(du={}));function Uq(e){return!e[Qs.disabled]&&!e[Qs.hidden]&&!e[Qs.outside]}function $We(e,t,n,r){let s,i=-1;for(const a of e){const o=t(a);Uq(o)&&(o[Qs.focused]&&i<du.FocusedModifier?(s=a,i=du.FocusedModifier):r!=null&&r.isEqualTo(a)&&i<du.LastFocused?(s=a,i=du.LastFocused):n(a.date)&&i<du.Selected?(s=a,i=du.Selected):o[Qs.today]&&i<du.Today&&(s=a,i=du.Today))}return s||(s=e.find(a=>Uq(t(a)))),s}function zWe(e,t,n,r,s,i,a){const{ISOWeek:o,broadcastCalendar:l}=i,{addDays:c,addMonths:u,addWeeks:d,addYears:h,endOfBroadcastWeek:m,endOfISOWeek:y,endOfWeek:b,max:v,min:x,startOfBroadcastWeek:w,startOfISOWeek:S,startOfWeek:k}=a;let T={day:c,week:d,month:u,year:h,startOfWeek:R=>l?w(R,a):o?S(R):k(R),endOfWeek:R=>l?m(R):o?y(R):b(R)}[e](n,t==="after"?1:-1);return t==="before"&&r?T=v([r,T]):t==="after"&&s&&(T=x([s,T])),T}function aie(e,t,n,r,s,i,a,o=0){if(o>365)return;const l=zWe(e,t,n.date,r,s,i,a),c=!!(i.disabled&&jd(l,i.disabled,a)),u=!!(i.hidden&&jd(l,i.hidden,a)),d=l,h=new Yse(l,d,a);return!c&&!u?h:aie(e,t,h,r,s,i,a,o+1)}function UWe(e,t,n,r,s){const{autoFocus:i}=e,[a,o]=E.useState(),l=$We(t.days,n,r||(()=>!1),a),[c,u]=E.useState(i?l:void 0);return{isFocusTarget:b=>!!(l!=null&&l.isEqualTo(b)),setFocused:u,focused:c,blur:()=>{o(c),u(void 0)},moveFocus:(b,v)=>{if(!c)return;const x=aie(b,v,c,t.navStart,t.navEnd,e,s);x&&(t.goToDay(x),u(x))}}}function qWe(e,t){const{selected:n,required:r,onSelect:s}=e,[i,a]=HT(n,s?n:void 0),o=s?n:i,{isSameDay:l}=t,c=m=>(o==null?void 0:o.some(y=>l(y,m)))??!1,{min:u,max:d}=e;return{selected:o,select:(m,y,b)=>{let v=[...o??[]];if(c(m)){if((o==null?void 0:o.length)===u||r&&(o==null?void 0:o.length)===1)return;v=o==null?void 0:o.filter(x=>!l(x,m))}else(o==null?void 0:o.length)===d?v=[m]:v=[...v,m];return s||a(v),s==null||s(v,m,y,b),v},isSelected:c}}function VWe(e,t,n=0,r=0,s=!1,i=Wu){const{from:a,to:o}=t||{},{isSameDay:l,isAfter:c,isBefore:u}=i;let d;if(!a&&!o)d={from:e,to:n>0?void 0:e};else if(a&&!o)l(a,e)?s?d={from:a,to:void 0}:d=void 0:u(e,a)?d={from:e,to:a}:d={from:a,to:e};else if(a&&o)if(l(a,e)&&l(o,e))s?d={from:a,to:o}:d=void 0;else if(l(a,e))d={from:a,to:n>0?void 0:e};else if(l(o,e))d={from:e,to:n>0?void 0:e};else if(u(e,a))d={from:e,to:o};else if(c(e,a))d={from:a,to:e};else if(c(e,o))d={from:a,to:e};else throw new Error("Invalid range");if(d!=null&&d.from&&(d!=null&&d.to)){const h=i.differenceInCalendarDays(d.to,d.from);r>0&&h>r?d={from:e,to:void 0}:n>1&&h<n&&(d={from:e,to:void 0})}return d}function WWe(e,t,n=Wu){const r=Array.isArray(t)?t:[t];let s=e.from;const i=n.differenceInCalendarDays(e.to,e.from),a=Math.min(i,6);for(let o=0;o<=a;o++){if(r.includes(s.getDay()))return!0;s=n.addDays(s,1)}return!1}function qq(e,t,n=Wu){return Id(e,t.from,!1,n)||Id(e,t.to,!1,n)||Id(t,e.from,!1,n)||Id(t,e.to,!1,n)}function HWe(e,t,n=Wu){const r=Array.isArray(t)?t:[t];if(r.filter(o=>typeof o!="function").some(o=>typeof o=="boolean"?o:n.isDate(o)?Id(e,o,!1,n):eie(o,n)?o.some(l=>Id(e,l,!1,n)):tF(o)?o.from&&o.to?qq(e,{from:o.from,to:o.to},n):!1:Qse(o)?WWe(e,o.dayOfWeek,n):Zse(o)?n.isAfter(o.before,o.after)?qq(e,{from:n.addDays(o.after,1),to:n.addDays(o.before,-1)},n):jd(e.from,o,n)||jd(e.to,o,n):Xse(o)||Jse(o)?jd(e.from,o,n)||jd(e.to,o,n):!1))return!0;const a=r.filter(o=>typeof o=="function");if(a.length){let o=e.from;const l=n.differenceInCalendarDays(e.to,e.from);for(let c=0;c<=l;c++){if(a.some(u=>u(o)))return!0;o=n.addDays(o,1)}}return!1}function GWe(e,t){const{disabled:n,excludeDisabled:r,selected:s,required:i,onSelect:a}=e,[o,l]=HT(s,a?s:void 0),c=a?s:o;return{selected:c,select:(h,m,y)=>{const{min:b,max:v}=e,x=h?VWe(h,c,b,v,i,t):void 0;return r&&n&&(x!=null&&x.from)&&x.to&&HWe({from:x.from,to:x.to},n,t)&&(x.from=h,x.to=void 0),a||l(x),a==null||a(x,h,m,y),x},isSelected:h=>c&&Id(c,h,!1,t)}}function KWe(e,t){const{selected:n,required:r,onSelect:s}=e,[i,a]=HT(n,s?n:void 0),o=s?n:i,{isSameDay:l}=t;return{selected:o,select:(d,h,m)=>{let y=d;return!r&&o&&o&&l(d,o)&&(y=void 0),s||a(y),s==null||s(y,d,h,m),y},isSelected:d=>o?l(o,d):!1}}function YWe(e,t){const n=KWe(e,t),r=qWe(e,t),s=GWe(e,t);switch(e.mode){case"single":return n;case"multiple":return r;case"range":return s;default:return}}function ZWe(e){var dt;let t=e;t.timeZone&&(t={...e},t.today&&(t.today=new Pa(t.today,t.timeZone)),t.month&&(t.month=new Pa(t.month,t.timeZone)),t.defaultMonth&&(t.defaultMonth=new Pa(t.defaultMonth,t.timeZone)),t.startMonth&&(t.startMonth=new Pa(t.startMonth,t.timeZone)),t.endMonth&&(t.endMonth=new Pa(t.endMonth,t.timeZone)),t.mode==="single"&&t.selected?t.selected=new Pa(t.selected,t.timeZone):t.mode==="multiple"&&t.selected?t.selected=(dt=t.selected)==null?void 0:dt.map(et=>new Pa(et,t.timeZone)):t.mode==="range"&&t.selected&&(t.selected={from:t.selected.from?new Pa(t.selected.from,t.timeZone):void 0,to:t.selected.to?new Pa(t.selected.to,t.timeZone):void 0}));const{components:n,formatters:r,labels:s,dateLib:i,locale:a,classNames:o}=E.useMemo(()=>{const et={...cT,...t.locale};return{dateLib:new uf({locale:et,weekStartsOn:t.broadcastCalendar?1:t.weekStartsOn,firstWeekContainsDate:t.firstWeekContainsDate,useAdditionalWeekYearTokens:t.useAdditionalWeekYearTokens,useAdditionalDayOfYearTokens:t.useAdditionalDayOfYearTokens,timeZone:t.timeZone,numerals:t.numerals},t.dateLib),components:eWe(t.components),formatters:uWe(t.formatters),labels:{...EWe,...t.labels},locale:et,classNames:{...nF(),...t.classNames}}},[t.locale,t.broadcastCalendar,t.weekStartsOn,t.firstWeekContainsDate,t.useAdditionalWeekYearTokens,t.useAdditionalDayOfYearTokens,t.timeZone,t.numerals,t.dateLib,t.components,t.formatters,t.labels,t.classNames]),{captionLayout:l,mode:c,navLayout:u,numberOfMonths:d=1,onDayBlur:h,onDayClick:m,onDayFocus:y,onDayKeyDown:b,onDayMouseEnter:v,onDayMouseLeave:x,onNextClick:w,onPrevClick:S,showWeekNumber:k,styles:C}=t,{formatCaption:T,formatDay:R,formatMonthDropdown:N,formatWeekNumber:I,formatWeekNumberHeader:P,formatWeekdayName:B,formatYearDropdown:D}=r,W=BWe(t,i),{days:O,months:Z,navStart:U,navEnd:H,previousMonth:L,nextMonth:te,goToMonth:V}=W,Q=kVe(O,t,i),{isSelected:ee,select:se,selected:pe}=YWe(t,i)??{},{blur:ue,focused:Oe,isFocusTarget:Fe,moveFocus:Se,setFocused:Ce}=UWe(t,W,Q,ee??(()=>!1),i),{labelDayButton:qe,labelGridcell:Qe,labelGrid:We,labelMonthDropdown:Ie,labelNav:K,labelPrevious:ye,labelNext:Ne,labelWeekday:ce,labelWeekNumber:oe,labelWeekNumberHeader:re,labelYearDropdown:Re}=s,Be=E.useMemo(()=>hWe(i,t.ISOWeek),[i,t.ISOWeek]),Te=c!==void 0||m!==void 0,lt=E.useCallback(()=>{L&&(V(L),S==null||S(L))},[L,V,S]),Tt=E.useCallback(()=>{te&&(V(te),w==null||w(te))},[V,te,w]),ut=E.useCallback((et,$)=>Ue=>{Ue.preventDefault(),Ue.stopPropagation(),Ce(et),se==null||se(et.date,$,Ue),m==null||m(et.date,$,Ue)},[se,m,Ce]),jt=E.useCallback((et,$)=>Ue=>{Ce(et),y==null||y(et.date,$,Ue)},[y,Ce]),qt=E.useCallback((et,$)=>Ue=>{ue(),h==null||h(et.date,$,Ue)},[ue,h]),Ft=E.useCallback((et,$)=>Ue=>{const tt={ArrowLeft:["day",t.dir==="rtl"?"after":"before"],ArrowRight:["day",t.dir==="rtl"?"before":"after"],ArrowDown:["week","after"],ArrowUp:["week","before"],PageUp:[Ue.shiftKey?"year":"month","before"],PageDown:[Ue.shiftKey?"year":"month","after"],Home:["startOfWeek","before"],End:["endOfWeek","after"]};if(tt[Ue.key]){Ue.preventDefault(),Ue.stopPropagation();const[ve,_e]=tt[Ue.key];Se(ve,_e)}b==null||b(et.date,$,Ue)},[Se,b,t.dir]),Ht=E.useCallback((et,$)=>Ue=>{v==null||v(et.date,$,Ue)},[v]),we=E.useCallback((et,$)=>Ue=>{x==null||x(et.date,$,Ue)},[x]),F=E.useCallback(et=>$=>{const Ue=Number($.target.value),tt=i.setMonth(i.startOfMonth(et),Ue);V(tt)},[i,V]),X=E.useCallback(et=>$=>{const Ue=Number($.target.value),tt=i.setYear(i.startOfMonth(et),Ue);V(tt)},[i,V]),{className:be,style:ke}=E.useMemo(()=>({className:[o[Bn.Root],t.className].filter(Boolean).join(" "),style:{...C==null?void 0:C[Bn.Root],...t.style}}),[o,t.className,t.style,C]),ge=tWe(t),Ee=E.useRef(null);NWe(Ee,!!t.animate,{classNames:o,months:Z,focused:Oe,dateLib:i});const le={dayPickerProps:t,selected:pe,select:se,isSelected:ee,months:Z,nextMonth:te,previousMonth:L,goToMonth:V,getModifiers:Q,components:n,classNames:o,styles:C,labels:s,formatters:r};return Ve.createElement(tie.Provider,{value:le},Ve.createElement(n.Root,{rootRef:t.animate?Ee:void 0,className:be,style:ke,dir:t.dir,id:t.id,lang:t.lang,nonce:t.nonce,title:t.title,role:t.role,"aria-label":t["aria-label"],...ge},Ve.createElement(n.Months,{className:o[Bn.Months],style:C==null?void 0:C[Bn.Months]},!t.hideNavigation&&!u&&Ve.createElement(n.Nav,{"data-animated-nav":t.animate?"true":void 0,className:o[Bn.Nav],style:C==null?void 0:C[Bn.Nav],"aria-label":K(),onPreviousClick:lt,onNextClick:Tt,previousMonth:L,nextMonth:te}),Z.map((et,$)=>{const Ue=dWe(et.date,U,H,r,i),tt=pWe(U,H,r,i);return Ve.createElement(n.Month,{"data-animated-month":t.animate?"true":void 0,className:o[Bn.Month],style:C==null?void 0:C[Bn.Month],key:$,displayIndex:$,calendarMonth:et},u==="around"&&!t.hideNavigation&&$===0&&Ve.createElement(n.PreviousMonthButton,{type:"button",className:o[Bn.PreviousMonthButton],tabIndex:L?void 0:-1,"aria-disabled":L?void 0:!0,"aria-label":ye(L),onClick:lt,"data-animated-button":t.animate?"true":void 0},Ve.createElement(n.Chevron,{disabled:L?void 0:!0,className:o[Bn.Chevron],orientation:t.dir==="rtl"?"right":"left"})),Ve.createElement(n.MonthCaption,{"data-animated-caption":t.animate?"true":void 0,className:o[Bn.MonthCaption],style:C==null?void 0:C[Bn.MonthCaption],calendarMonth:et,displayIndex:$},l!=null&&l.startsWith("dropdown")?Ve.createElement(n.DropdownNav,{className:o[Bn.Dropdowns],style:C==null?void 0:C[Bn.Dropdowns]},l==="dropdown"||l==="dropdown-months"?Ve.createElement(n.MonthsDropdown,{className:o[Bn.MonthsDropdown],"aria-label":Ie(),classNames:o,components:n,disabled:!!t.disableNavigation,onChange:F(et.date),options:Ue,style:C==null?void 0:C[Bn.Dropdown],value:i.getMonth(et.date)}):Ve.createElement("span",null,N(et.date,i)),l==="dropdown"||l==="dropdown-years"?Ve.createElement(n.YearsDropdown,{className:o[Bn.YearsDropdown],"aria-label":Re(i.options),classNames:o,components:n,disabled:!!t.disableNavigation,onChange:X(et.date),options:tt,style:C==null?void 0:C[Bn.Dropdown],value:i.getYear(et.date)}):Ve.createElement("span",null,D(et.date,i)),Ve.createElement("span",{role:"status","aria-live":"polite",style:{border:0,clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"absolute",width:"1px",whiteSpace:"nowrap",wordWrap:"normal"}},T(et.date,i.options,i))):Ve.createElement(n.CaptionLabel,{className:o[Bn.CaptionLabel],role:"status","aria-live":"polite"},T(et.date,i.options,i))),u==="around"&&!t.hideNavigation&&$===d-1&&Ve.createElement(n.NextMonthButton,{type:"button",className:o[Bn.NextMonthButton],tabIndex:te?void 0:-1,"aria-disabled":te?void 0:!0,"aria-label":Ne(te),onClick:Tt,"data-animated-button":t.animate?"true":void 0},Ve.createElement(n.Chevron,{disabled:te?void 0:!0,className:o[Bn.Chevron],orientation:t.dir==="rtl"?"left":"right"})),$===d-1&&u==="after"&&!t.hideNavigation&&Ve.createElement(n.Nav,{"data-animated-nav":t.animate?"true":void 0,className:o[Bn.Nav],style:C==null?void 0:C[Bn.Nav],"aria-label":K(),onPreviousClick:lt,onNextClick:Tt,previousMonth:L,nextMonth:te}),Ve.createElement(n.MonthGrid,{role:"grid","aria-multiselectable":c==="multiple"||c==="range","aria-label":We(et.date,i.options,i)||void 0,className:o[Bn.MonthGrid],style:C==null?void 0:C[Bn.MonthGrid]},!t.hideWeekdays&&Ve.createElement(n.Weekdays,{"data-animated-weekdays":t.animate?"true":void 0,className:o[Bn.Weekdays],style:C==null?void 0:C[Bn.Weekdays]},k&&Ve.createElement(n.WeekNumberHeader,{"aria-label":re(i.options),className:o[Bn.WeekNumberHeader],style:C==null?void 0:C[Bn.WeekNumberHeader],scope:"col"},P()),Be.map((ve,_e)=>Ve.createElement(n.Weekday,{"aria-label":ce(ve,i.options,i),className:o[Bn.Weekday],key:_e,style:C==null?void 0:C[Bn.Weekday],scope:"col"},B(ve,i.options,i)))),Ve.createElement(n.Weeks,{"data-animated-weeks":t.animate?"true":void 0,className:o[Bn.Weeks],style:C==null?void 0:C[Bn.Weeks]},et.weeks.map((ve,_e)=>Ve.createElement(n.Week,{className:o[Bn.Week],key:ve.weekNumber,style:C==null?void 0:C[Bn.Week],week:ve},k&&Ve.createElement(n.WeekNumber,{week:ve,style:C==null?void 0:C[Bn.WeekNumber],"aria-label":oe(ve.weekNumber,{locale:a}),className:o[Bn.WeekNumber],scope:"row",role:"rowheader"},I(ve.weekNumber,i)),ve.days.map($e=>{const{date:Ct}=$e,fe=Q($e);if(fe[Qs.focused]=!fe.hidden&&!!(Oe!=null&&Oe.isEqualTo($e)),fe[Cc.selected]=(ee==null?void 0:ee(Ct))||fe.selected,tF(pe)){const{from:xe,to:De}=pe;fe[Cc.range_start]=!!(xe&&De&&i.isSameDay(Ct,xe)),fe[Cc.range_end]=!!(xe&&De&&i.isSameDay(Ct,De)),fe[Cc.range_middle]=Id(pe,Ct,!0,i)}const Y=fWe(fe,C,t.modifiersStyles),G=EVe(fe,o,t.modifiersClassNames),J=!Te&&!fe.hidden?Qe(Ct,fe,i.options,i):void 0;return Ve.createElement(n.Day,{key:`${i.format(Ct,"yyyy-MM-dd")}_${i.format($e.displayMonth,"yyyy-MM")}`,day:$e,modifiers:fe,className:G.join(" "),style:Y,role:"gridcell","aria-selected":fe.selected||void 0,"aria-label":J,"data-day":i.format(Ct,"yyyy-MM-dd"),"data-month":$e.outside?i.format(Ct,"yyyy-MM"):void 0,"data-selected":fe.selected||void 0,"data-disabled":fe.disabled||void 0,"data-hidden":fe.hidden||void 0,"data-outside":$e.outside||void 0,"data-focused":fe.focused||void 0,"data-today":fe.today||void 0},!fe.hidden&&Te?Ve.createElement(n.DayButton,{className:o[Bn.DayButton],style:C==null?void 0:C[Bn.DayButton],type:"button",day:$e,modifiers:fe,disabled:fe.disabled||void 0,tabIndex:Fe($e)?0:-1,"aria-label":qe(Ct,fe,i.options,i),onClick:ut($e,fe),onBlur:qt($e,fe),onFocus:jt($e,fe),onKeyDown:Ft($e,fe),onMouseEnter:Ht($e,fe),onMouseLeave:we($e,fe)},R(Ct,i.options,i)):!fe.hidden&&R($e.date,i.options,i))}))))))})),t.footer&&Ve.createElement(n.Footer,{className:o[Bn.Footer],style:C==null?void 0:C[Bn.Footer],role:"status","aria-live":"polite"},t.footer)))}function XWe({className:e,classNames:t,showOutsideDays:n=!0,captionLayout:r="label",buttonVariant:s="ghost",formatters:i,components:a,...o}){const l=nF();return f.jsx(ZWe,{showOutsideDays:n,className:Xe("bg-background group/calendar p-3 [--cell-size:--spacing(8)] [[data-slot=card-content]_&]:bg-transparent [[data-slot=popover-content]_&]:bg-transparent",String.raw`rtl:**:[.rdp-button\_next>svg]:rotate-180`,String.raw`rtl:**:[.rdp-button\_previous>svg]:rotate-180`,e),captionLayout:r,formatters:{formatMonthDropdown:c=>c.toLocaleString("default",{month:"short"}),...i},classNames:{root:Xe("w-fit",l.root),months:Xe("flex gap-4 flex-col md:flex-row relative",l.months),month:Xe("flex flex-col w-full gap-4",l.month),nav:Xe("flex items-center gap-1 w-full absolute top-0 inset-x-0 justify-between",l.nav),button_previous:Xe(Z3({variant:s}),"size-(--cell-size) aria-disabled:opacity-50 p-0 select-none",l.button_previous),button_next:Xe(Z3({variant:s}),"size-(--cell-size) aria-disabled:opacity-50 p-0 select-none",l.button_next),month_caption:Xe("flex items-center justify-center h-(--cell-size) w-full px-(--cell-size)",l.month_caption),dropdowns:Xe("w-full flex items-center text-sm font-medium justify-center h-(--cell-size) gap-1.5",l.dropdowns),dropdown_root:Xe("relative has-focus:border-ring border border-input shadow-xs has-focus:ring-ring/50 has-focus:ring-[3px] rounded-md",l.dropdown_root),dropdown:Xe("absolute inset-0 opacity-0",l.dropdown),caption_label:Xe("select-none font-medium",r==="label"?"text-sm":"rounded-md pl-2 pr-1 flex items-center gap-1 text-sm h-8 [&>svg]:text-muted-foreground [&>svg]:size-3.5",l.caption_label),table:"w-full border-collapse",weekdays:Xe("flex",l.weekdays),weekday:Xe("text-muted-foreground rounded-md flex-1 font-normal text-[0.8rem] select-none",l.weekday),week:Xe("flex w-full mt-2",l.week),week_number_header:Xe("select-none w-(--cell-size)",l.week_number_header),week_number:Xe("text-[0.8rem] select-none text-muted-foreground",l.week_number),day:Xe("relative w-full h-full p-0 text-center [&:first-child[data-selected=true]_button]:rounded-l-md [&:last-child[data-selected=true]_button]:rounded-r-md group/day aspect-square select-none",l.day),range_start:Xe("rounded-l-md bg-accent",l.range_start),range_middle:Xe("rounded-none",l.range_middle),range_end:Xe("rounded-r-md bg-accent",l.range_end),today:Xe("bg-accent text-accent-foreground rounded-md data-[selected=true]:rounded-none",l.today),outside:Xe("text-muted-foreground aria-selected:text-muted-foreground",l.outside),disabled:Xe("text-muted-foreground opacity-50",l.disabled),hidden:Xe("invisible",l.hidden),...t},components:{Root:({className:c,rootRef:u,...d})=>f.jsx("div",{"data-slot":"calendar",ref:u,className:Xe(c),...d}),Chevron:({className:c,orientation:u,...d})=>u==="left"?f.jsx(Npe,{className:Xe("size-4",c),...d}):u==="right"?f.jsx($O,{className:Xe("size-4",c),...d}):f.jsx(Jl,{className:Xe("size-4",c),...d}),DayButton:JWe,WeekNumber:({children:c,...u})=>f.jsx("td",{...u,children:f.jsx("div",{className:"flex size-(--cell-size) items-center justify-center text-center",children:c})}),...a},...o})}function JWe({className:e,day:t,modifiers:n,...r}){const s=nF(),i=E.useRef(null);return E.useEffect(()=>{var a;n.focused&&((a=i.current)==null||a.focus())},[n.focused]),f.jsx(mt,{ref:i,variant:"ghost",size:"icon","data-day":t.date.toLocaleDateString(),"data-selected-single":n.selected&&!n.range_start&&!n.range_end&&!n.range_middle,"data-range-start":n.range_start,"data-range-end":n.range_end,"data-range-middle":n.range_middle,className:Xe("data-[selected-single=true]:bg-primary data-[selected-single=true]:text-primary-foreground data-[range-middle=true]:bg-accent data-[range-middle=true]:text-accent-foreground data-[range-start=true]:bg-primary data-[range-start=true]:text-primary-foreground data-[range-end=true]:bg-primary data-[range-end=true]:text-primary-foreground group-data-[focused=true]/day:border-ring group-data-[focused=true]/day:ring-ring/50 dark:hover:text-accent-foreground flex aspect-square size-auto w-full min-w-(--cell-size) flex-col gap-1 leading-none font-normal group-data-[focused=true]/day:relative group-data-[focused=true]/day:z-10 group-data-[focused=true]/day:ring-[3px] data-[range-end=true]:rounded-md data-[range-end=true]:rounded-r-md data-[range-middle=true]:rounded-none data-[range-start=true]:rounded-md data-[range-start=true]:rounded-l-md [&>span]:text-xs [&>span]:opacity-70",s.day,e),...r})}const QWe=({fieldApi:e,label:t,placeholder:n="Pick a date",description:r,inputClassName:s,labelClassName:i,wrapperClassName:a})=>{const[o,l]=Ve.useState(!1),c=e.state.value?e.state.value instanceof Date?e.state.value:typeof e.state.value=="string"?WAe(e.state.value):void 0:void 0,u=d=>{e.handleChange(d),e.handleBlur(),l(!1)};return f.jsxs("div",{className:Xe("space-y-1.5",a),children:[t&&f.jsx(Ot,{htmlFor:e.name+"-trigger",className:Xe("text-sm font-medium",i),children:t}),r&&f.jsx("p",{className:"text-xs text-muted-foreground",children:r}),f.jsxs(sc,{open:o,onOpenChange:l,children:[f.jsx(ic,{asChild:!0,children:f.jsxs(mt,{id:e.name+"-trigger",variant:"outline",className:Xe("w-full justify-start text-left font-normal",!c&&"text-muted-foreground",s,e.state.meta.errors.length?"border-destructive":""),disabled:e.form.state.isSubmitting,onBlur:e.handleBlur,children:[f.jsx(Epe,{className:"mr-2 h-4 w-4"}),c?Md(c,"PPP"):f.jsx("span",{children:n})]})}),f.jsx(ac,{className:"w-auto p-0",children:f.jsx(XWe,{mode:"single",selected:c,onSelect:u,initialFocus:!0,disabled:e.form.state.isSubmitting})})]}),e.state.meta.isTouched&&e.state.meta.errors.length>0&&f.jsx("div",{className:"text-xs text-destructive pt-1",children:e.state.meta.errors.map((d,h)=>f.jsx("p",{children:String(d)},h))})]})},eHe=({fieldApi:e,label:t,description:n,min:r=0,max:s=100,step:i=1,valueLabelPrefix:a="",valueLabelSuffix:o="",valueDisplayPrecision:l=0,showRawValue:c=!1,wrapperClassName:u,inputClassName:d,labelClassName:h})=>{const{name:m,state:y,handleChange:b,handleBlur:v}=e,x=typeof y.value=="number"?y.value:r,w=x.toFixed(l);return f.jsxs("div",{className:Xe("space-y-1.5",u),children:[t&&f.jsxs(Ot,{htmlFor:m,className:Xe("text-sm font-medium",h),children:[t," (",a,w,o,")",c&&f.jsxs("span",{className:"text-xs text-muted-foreground ml-2",children:["(Raw: ",y.value,")"]})]}),n&&f.jsx("p",{className:"text-xs text-muted-foreground",children:n}),f.jsx(A0,{id:m,name:m,value:[x],onValueChange:S=>b(S[0]),onBlur:v,disabled:e.form.state.isSubmitting,min:r,max:s,step:i,className:Xe(d,y.meta.errors.length?"border-destructive":"")}),y.meta.isTouched&&y.meta.errors.length>0&&f.jsx("div",{className:"text-xs text-destructive pt-1",children:y.meta.errors.map((S,k)=>f.jsx("p",{children:typeof S=="string"?S:(S==null?void 0:S.message)||"Invalid"},k))})]})},tHe=({fieldApi:e,label:t,accept:n,className:r,wrapperClassName:s,description:i})=>{const{name:a,state:o,handleChange:l,handleBlur:c}=e,u=o.value,d=y=>{var v;const b=((v=y.target.files)==null?void 0:v[0])??null;l(b),c()},h=()=>{l(null);const y=document.getElementById(a);y&&(y.value=""),c()},m=()=>{const y=document.getElementById(a);y==null||y.click()};return f.jsxs("div",{className:Xe("space-y-1.5",s),children:[t&&f.jsx(Ot,{className:"text-sm font-medium cursor-pointer",onClick:m,children:t}),i&&f.jsx("p",{className:"text-xs text-muted-foreground",children:i}),f.jsx(Cn,{id:a,name:a,type:"file",accept:n,onChange:d,className:"hidden"}),u?f.jsxs("div",{className:"flex items-center justify-between p-2.5 border rounded-lg bg-muted/40 shadow-sm hover:shadow-md transition-shadow",children:[f.jsxs("div",{className:"flex items-center gap-2 text-sm overflow-hidden",children:[f.jsx(gE,{className:"h-5 w-5 text-primary shrink-0"}),f.jsx("span",{className:"truncate",title:u.name,children:u.name}),f.jsxs("span",{className:"text-xs text-muted-foreground whitespace-nowrap",children:["(",(u.size/1024).toFixed(1)," KB)"]})]}),f.jsx(mt,{type:"button",variant:"ghost",size:"icon",onClick:h,className:"h-7 w-7 text-destructive hover:bg-destructive/10 shrink-0","aria-label":"Remove file",children:f.jsx(Oi,{className:"h-4 w-4"})})]}):f.jsxs("button",{type:"button",onClick:m,className:Xe("w-full flex flex-col items-center justify-center p-4 border-2 border-dashed rounded-lg hover:border-primary transition-colors cursor-pointer bg-background hover:bg-muted/50",r,o.meta.errors.length?"border-destructive hover:border-destructive":"border-muted-foreground/50"),children:[f.jsx(zO,{className:"h-8 w-8 text-muted-foreground mb-2"}),f.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Click or drag and drop a file"}),n&&f.jsxs("span",{className:"text-xs text-muted-foreground/80 mt-1",children:["Accepted types: ",n]})]}),o.meta.isTouched&&o.meta.errors.length>0&&f.jsx("div",{className:"text-xs text-destructive pt-1",children:o.meta.errors.map((y,b)=>f.jsx("p",{children:typeof y=="string"?y:(y==null?void 0:y.message)||"Invalid"},b))})]})},nHe={text:gx,email:gx,password:gx,url:gx,textarea:fVe,select:hVe,checkbox:pVe,switch:mVe,number:gVe,date:QWe,slider:eHe,file:tHe},rHe=({value:e,currentPage:t,totalPages:n,className:r})=>f.jsxs("div",{className:Xe("space-y-2",r),children:[f.jsxs("div",{className:"flex justify-between text-sm text-muted-foreground",children:[f.jsxs("span",{children:["Step ",t," of ",n]}),f.jsxs("span",{children:[Math.round(e),"%"]})]}),f.jsx(ky,{value:e,className:"h-2"})]}),sHe=({children:e,title:t,description:n})=>f.jsxs("div",{className:"space-y-6",children:[(t||n)&&f.jsxs("div",{className:"space-y-2",children:[t&&f.jsx("h3",{className:"text-lg font-semibold",children:t}),n&&f.jsx("p",{className:"text-muted-foreground",children:n})]}),f.jsx("div",{className:"space-y-4",children:e})]});function GT(e){const{fields:t=[],schema:n,submitLabel:r="Submit",nextLabel:s="Next",previousLabel:i="Previous",formClassName:a,fieldClassName:o,pages:l=[],progress:c,defaultComponents:u={},globalWrapper:d,formOptions:h,onPageChange:m,autoSubmitOnChange:y=!1,autoSubmitDebounceMs:b=1e3,disabled:v=!1,loading:x=!1,resetOnSubmitSuccess:w=!1}=e,[S,k]=E.useState(1),C={...nHe,...u},T=E.useMemo(()=>{const te={};return t.forEach(V=>{const Q=V.page||1;te[Q]||(te[Q]=[]),te[Q].push(V)}),te},[t]),R=Math.max(...Object.keys(T).map(Number),1),N=R>1,I=N?(S-1)/(R-1)*100:100,P={...h,...n&&{validators:{onChange:n,...h==null?void 0:h.validators}},...w&&(h==null?void 0:h.onSubmit)&&{onSubmit:async te=>{try{const V=await h.onSubmit(te);return B.reset(),V}catch(V){throw V}}}},B=ii(P);Ve.useEffect(()=>{const te=[];let V,Q;if(h!=null&&h.onChange||y){const ee=B.store.subscribe(()=>{const se=B,pe=se.state.values;h!=null&&h.onChange&&se.state.isValid&&(clearTimeout(Q),Q=setTimeout(()=>{h.onChange({value:pe,formApi:se})},300)),y&&!v&&!x&&(clearTimeout(V),V=setTimeout(()=>{B.state.canSubmit&&B.handleSubmit()},b))});te.push(ee)}return te.push(()=>{clearTimeout(V),clearTimeout(Q)}),()=>{te.forEach(ee=>ee())}},[B,y,b,v,x]);const D=()=>T[S]||[],W=()=>l.find(te=>te.page===S),O=()=>{if(S<R){const te=S+1;k(te),m==null||m(te,"next")}},Z=()=>{if(S>1){const te=S-1;k(te),m==null||m(te,"previous")}},U=S===R,H=S===1;return{form:B,Form:({className:te,children:V,onSubmit:Q})=>{const ee=Se=>{Se.preventDefault(),Se.stopPropagation(),Q?Q(Se):U?B.handleSubmit():O()},se=Xe("space-y-6",a,te),pe=Se=>{const{name:Ce,type:qe,label:Qe,placeholder:We,description:Ie,options:K,min:ye,max:Ne,step:ce,accept:oe,multiple:re,component:Re,wrapper:Be,conditional:Te,validation:lt}=Se;return f.jsx(B.Field,{name:Ce,validators:lt?{onChange:lt}:void 0,children:Tt=>{const ut=Tt.form.state.values;if(Te&&!Te(ut))return null;const jt={fieldApi:Tt,label:Qe,placeholder:We,description:Ie,wrapperClassName:o,min:ye,max:Ne,step:ce,accept:oe,multiple:re,disabled:v||x||Tt.form.state.isSubmitting},qt=Re||C[qe]||gx,Ft=qe==="select"?{...jt,options:K||[]}:{...jt,type:["text","email","password","url"].includes(qe)?qe:void 0},Ht=f.jsx(qt,{...Ft}),we=Be||d;return we?f.jsx(we,{field:Se,children:Ht}):Ht}},Ce)},ue=()=>{const Se=D(),Ce=W(),qe=Se.map(We=>pe(We)).filter(Boolean),Qe=(Ce==null?void 0:Ce.component)||sHe;return f.jsx(Qe,{title:Ce==null?void 0:Ce.title,description:Ce==null?void 0:Ce.description,page:S,totalPages:R,children:qe})},Oe=()=>{if(!N||!c)return null;const Se=c.component||rHe;return f.jsx(Se,{value:I,currentPage:S,totalPages:R,className:c.className})},Fe=()=>N?f.jsx(B.Subscribe,{selector:Se=>({canSubmit:Se.canSubmit,isSubmitting:Se.isSubmitting}),children:Se=>{const{canSubmit:Ce,isSubmitting:qe}=Se;return f.jsxs("div",{className:"flex justify-between gap-4",children:[f.jsx(mt,{type:"button",variant:"outline",onClick:Z,disabled:H||v||x,className:H?"invisible":"",children:i}),f.jsx(mt,{type:"submit",disabled:(!Ce||qe||v||x)&&U,className:"flex-1 max-w-xs",children:x&&U?"Loading...":qe&&U?"Submitting...":U?r:s})]})}}):f.jsx(B.Subscribe,{selector:Se=>({canSubmit:Se.canSubmit,isSubmitting:Se.isSubmitting}),children:Se=>{const{canSubmit:Ce,isSubmitting:qe}=Se;return f.jsx(mt,{type:"submit",disabled:!Ce||qe||v||x,className:"w-full",children:x?"Loading...":qe?"Submitting...":r})}});return f.jsx("form",{onSubmit:ee,className:se,children:V||f.jsxs(f.Fragment,{children:[Oe(),ue(),Fe()]})})},currentPage:S,totalPages:R,goToNextPage:O,goToPreviousPage:Z,setCurrentPage:k,isFirstPage:H,isLastPage:U,progressValue:I}}function iHe({templates:e,onSelect:t}){const[n,r]=E.useState(""),s=e.filter(i=>i.name.toLowerCase().includes(n.toLowerCase())||i.description.toLowerCase().includes(n.toLowerCase())||i.tags.some(a=>a.toLowerCase().includes(n.toLowerCase())));return f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx(Ot,{htmlFor:"search",children:"Search Templates"}),f.jsx(Cn,{id:"search",placeholder:"Search by name, description, or tags...",value:n,onChange:i=>r(i.target.value)})]}),f.jsx("div",{className:"grid gap-3",children:s.length===0?f.jsx("div",{className:"text-center py-8 text-muted-foreground",children:n?"No templates match your search.":"No templates available."}):s.map(i=>f.jsxs(dl,{className:"cursor-pointer hover:bg-muted/50 transition-colors",onClick:()=>t(i),children:[f.jsx(fl,{className:"pb-3",children:f.jsxs("div",{className:"flex items-start justify-between",children:[f.jsxs("div",{children:[f.jsx(hl,{className:"text-sm",children:i.name}),f.jsx(zd,{className:"text-xs",children:i.description})]}),i.isPublic&&f.jsx(is,{variant:"default",className:"text-xs",children:"Public"})]})}),f.jsx(pl,{className:"pt-0",children:f.jsxs("div",{className:"flex flex-wrap gap-1",children:[i.tags.map(a=>f.jsx(is,{variant:"outline",className:"text-xs",children:a},a)),i.variables.length>0&&f.jsxs(is,{variant:"secondary",className:"text-xs",children:[i.variables.length," variables"]}),i.tools&&i.tools.length>0&&f.jsxs(is,{variant:"secondary",className:"text-xs",children:[i.tools.length," tools"]}),i.rules&&i.rules.length>0&&f.jsxs(is,{variant:"secondary",className:"text-xs",children:[i.rules.length," rules"]})]})})]},i.id))})]})}function aHe({template:e,onSubmit:t,onBack:n,previewElementRef:r,onCompile:s}){const i=e.variables.map(l=>({name:l.name,type:l.type==="boolean"?"switch":l.type==="number"?"number":l.type==="array"?"textarea":"text",label:l.name,placeholder:l.default||`Enter ${l.name}`,description:l.description||l.instructions,required:l.required})),a=e.variables.reduce((l,c)=>{if(c.default)if(c.type==="number")l[c.name]=parseFloat(c.default)||0;else if(c.type==="boolean")l[c.name]=c.default.toLowerCase()==="true";else if(c.type==="array")try{l[c.name]=JSON.parse(c.default)}catch{l[c.name]=c.default.split(",").map(u=>u.trim())}else l[c.name]=c.default;return l},{}),{Form:o}=GT({fields:i,submitLabel:"Proompt !",formOptions:{defaultValues:a,onSubmit:async({value:l})=>{t(l)},onChange:async({value:l})=>{await s(l)}}});return f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx(mt,{variant:"outline",size:"sm",onClick:n,children:" Back"}),f.jsxs("div",{children:[f.jsx("h3",{className:"font-medium",children:e.name}),f.jsx("p",{className:"text-sm text-muted-foreground",children:e.description})]})]}),f.jsxs("div",{className:"md:flex md:space-x-4",children:[f.jsx("div",{className:"md:w-1/2 border rounded-lg p-4",children:e.variables.length===0?f.jsxs("div",{className:"text-center",children:[f.jsx("p",{className:"text-muted-foreground",children:"This template has no variables defined. The template will be applied as-is."}),f.jsx(mt,{onClick:()=>t({}),className:"mt-3",children:"Proompt !"})]}):f.jsxs(f.Fragment,{children:[f.jsx(Ot,{className:"text-sm font-medium mb-4 block",children:"Template Variables"}),f.jsx(o,{})]})}),f.jsxs("div",{className:"md:w-1/2 border rounded-lg p-4",children:[f.jsx(Ot,{className:"text-sm font-medium",children:"Live Preview"}),f.jsx("div",{ref:r,className:"mt-2 p-3 bg-muted rounded text-sm font-mono whitespace-pre-wrap max-h-64 overflow-y-auto",children:e.prompt})]})]})]})}const oHe=({module:e})=>{const[t,n]=E.useState(!1),[r,s]=E.useState(null),i=E.useRef(null),{loadPromptTemplates:a,getTemplatesByType:o}=Mm(yn(m=>({loadPromptTemplates:m.loadPromptTemplates,getTemplatesByType:m.getTemplatesByType}))),l=o("prompt");E.useEffect(()=>{t&&a()},[t,a]);const c=m=>{s(m),i.current&&(i.current.textContent=m.prompt)},u=async m=>{if(r)try{await e.applyTemplate(r.id,m),n(!1),s(null),Me.success("Template applied to input area!")}catch(y){console.error("Failed to Proompt :",y),Me.error("Failed to Proompt !")}},d=()=>{s(null)},h=async m=>{if(!(!r||!i.current))try{const y=await e.compileTemplate(r.id,m);i.current.textContent=y.content}catch(y){i.current.textContent=`Error: ${y instanceof Error?y.message:"Compilation failed"}`}};return f.jsxs(f.Fragment,{children:[f.jsx(mt,{variant:"ghost",size:"sm",onClick:()=>n(!0),className:"h-8 w-8 p-0",title:"Open Prompt Library",children:f.jsx(wpe,{className:"h-4 w-4"})}),f.jsx(op,{open:t,onOpenChange:n,children:f.jsxs(lp,{className:"!w-[80vw] !h-[85vh] !max-w-none flex flex-col",children:[f.jsxs(cp,{children:[f.jsx(up,{children:r?"Fill Template Variables":"Prompt Library"}),f.jsx(eg,{children:r?"Provide values for the template variables below.":"Select a prompt template to use. Templates can include dynamic variables, auto-select tools, and rules."})]}),f.jsx("div",{className:"flex-1 overflow-hidden",children:r?f.jsx(aHe,{template:r,onSubmit:u,onBack:d,module:e,previewElementRef:i,onCompile:h}):f.jsx(iHe,{templates:l,onSelect:c})})]})})]})};class lHe{constructor(){de(this,"id","core-prompt-library");de(this,"unregisterCallback",null);de(this,"eventUnsubscribers",[]);de(this,"notifyComponentUpdate",null);de(this,"isStreaming",!1);de(this,"modApiRef",null);de(this,"getIsStreaming",()=>this.isStreaming);de(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t});de(this,"compileTemplate",async(t,n)=>{const{compilePromptTemplate:r}=Mm.getState();return await r(t,n)});de(this,"applyTemplate",async(t,n)=>{var s;const r=await this.compileTemplate(t,n);(s=this.modApiRef)==null||s.emit(gn.setInputTextRequest,{text:r.content})})}async initialize(t){this.modApiRef=t,this.isStreaming=vn.getState().status==="streaming";const n=t.on(Zn.statusChanged,r=>{var s;typeof r=="object"&&r&&"status"in r&&this.isStreaming!==(r.status==="streaming")&&(this.isStreaming=r.status==="streaming",(s=this.notifyComponentUpdate)==null||s.call(this))});this.eventUnsubscribers.push(n)}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>Ve.createElement(oHe,{module:this})})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),console.log(`[${this.id}] Destroyed.`)}}const cHe=e=>{const{size:t=24,color:n="currentColor",...r}=e;return f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t,height:t,viewBox:"0 0 512 512",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",...r,children:f.jsxs("g",{transform:"translate(0.000000,512.000000) scale(0.100000,-0.100000)",fill:n,stroke:"none",children:[f.jsx("path",{d:`M2310 5053 c-1035 -101 -1883 -794 -2159 -1764 -55 -194 -79 -338
-91 -552 -18 -323 20 -620 117 -907 92 -272 238 -543 404 -747 33 -39 59 -75
59 -78 0 -4 -49 -129 -109 -279 -252 -624 -251 -621 -196 -676 57 -56 73 -53
351 58 137 55 349 143 472 195 l223 95 77 -38 c221 -109 437 -179 680 -219
132 -23 411 -44 475 -37 23 3 85 8 137 11 404 26 806 168 1180 417 282 188
571 489 759 792 400 642 467 1498 174 2216 -179 439 -495 826 -888 1088 -361
239 -743 378 -1165 422 -88 9 -419 11 -500 3z m404 -463 c-1 -30 -17 -128 -36
-217 l-34 -163 137 0 c128 0 139 -1 149 -20 11 -21 4 -44 -22 -72 -7 -7 -68
-75 -135 -150 l-123 -136 0 -175 0 -175 238 -4 c265 -5 329 -16 469 -82 220
-105 414 -311 486 -519 l24 -68 86 -4 c129 -7 195 -43 236 -130 20 -42 21 -61
21 -300 0 -240 -1 -258 -21 -297 -46 -90 -115 -127 -235 -128 l-82 0 -11 -47
c-17 -66 -71 -179 -119 -250 -108 -159 -276 -293 -452 -361 -174 -66 -251 -72
-830 -63 l-475 8 -89 27 c-303 91 -554 328 -650 614 l-23 67 -89 5 c-98 6
-131 20 -180 72 -63 66 -64 72 -64 354 0 240 1 261 21 301 40 84 105 119 232
129 l84 7 32 80 c84 215 291 424 513 519 126 53 225 68 466 68 l212 0 0 268 0
267 -126 -3 c-108 -3 -129 -1 -145 14 -10 9 -19 25 -19 35 0 9 111 146 246
304 234 273 247 286 277 283 32 -3 32 -3 31 -58z`}),f.jsx("path",{d:`M1854 2726 c-92 -40 -150 -139 -141 -239 21 -237 343 -298 446 -84
59 123 -10 287 -138 325 -51 16 -128 15 -167 -2z`}),f.jsx("path",{d:`M3053 2719 c-81 -40 -133 -121 -133 -205 0 -102 47 -180 134 -220 95
-44 193 -27 268 47 78 78 94 181 44 278 -21 38 -76 88 -118 105 -54 23 -144
20 -195 -5z`}),f.jsx("path",{d:`M2147 1999 c-26 -15 -48 -65 -41 -94 15 -61 181 -167 304 -196 30 -7
100 -12 155 -12 81 1 115 6 178 27 135 45 247 133 249 194 2 60 -48 103 -104
88 -13 -3 -50 -25 -83 -50 -85 -64 -172 -90 -280 -84 -92 6 -165 35 -259 103
-49 35 -86 43 -119 24z`})]})})};function uHe({agents:e,onUseAgent:t,onClearAgent:n,hasActiveAgent:r,currentAgentName:s,module:i}){const[a,o]=E.useState(""),l=e.filter(c=>c.name.toLowerCase().includes(a.toLowerCase())||c.description.toLowerCase().includes(a.toLowerCase())||c.tags.some(u=>u.toLowerCase().includes(a.toLowerCase())));return f.jsxs("div",{className:"space-y-4",children:[r&&f.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(X0,{className:"h-4 w-4 text-primary"}),f.jsxs("span",{className:"text-sm font-medium",children:["Active Agent: ",s]})]}),f.jsx(mt,{variant:"outline",size:"sm",onClick:n,children:"Clear Agent"})]}),f.jsxs("div",{children:[f.jsx(Ot,{htmlFor:"search",children:"Search Agents"}),f.jsx(Cn,{id:"search",placeholder:"Search by name, description, or tags...",value:a,onChange:c=>o(c.target.value)})]}),f.jsx("div",{className:"grid gap-3",children:l.length===0?f.jsx("div",{className:"text-center py-8 text-muted-foreground",children:a?"No agents match your search.":"No agents available."}):l.map(c=>{const u=i.getTasksForAgent(c.id);return f.jsxs(dl,{className:"hover:bg-muted/50 transition-colors",children:[f.jsx(fl,{className:"pb-3",children:f.jsxs("div",{className:"flex items-start justify-between",children:[f.jsxs("div",{children:[f.jsxs(hl,{className:"text-sm flex items-center gap-2",children:[f.jsx(X0,{className:"h-4 w-4"}),c.name]}),f.jsx(zd,{className:"text-xs",children:c.description})]}),c.isPublic&&f.jsx(is,{variant:"default",className:"text-xs",children:"Public"})]})}),f.jsxs(pl,{className:"pt-0 space-y-3",children:[f.jsxs("div",{className:"flex flex-wrap gap-1",children:[f.jsxs(is,{variant:"secondary",className:"text-xs",children:[u.length," tasks"]}),c.tags.map(d=>f.jsx(is,{variant:"outline",className:"text-xs",children:d},d)),c.variables.length>0&&f.jsxs(is,{variant:"secondary",className:"text-xs",children:[c.variables.length," variables"]}),c.tools&&c.tools.length>0&&f.jsxs(is,{variant:"secondary",className:"text-xs",children:[c.tools.length," tools"]}),c.rules&&c.rules.length>0&&f.jsxs(is,{variant:"secondary",className:"text-xs",children:[c.rules.length," rules"]})]}),f.jsx(mt,{size:"sm",onClick:()=>t(c),className:"w-full",children:"Use Agent"})]})]},c.id)})})]})}function dHe({agent:e,onChange:t,previewElementRef:n,onCompile:r}){const s=e.variables.map(o=>({name:o.name,type:o.type==="boolean"?"switch":o.type==="number"?"number":o.type==="array"?"textarea":"text",label:o.name,placeholder:o.default||`Enter ${o.name}`,description:o.description||o.instructions,required:o.required})),i=e.variables.reduce((o,l)=>{if(l.default)if(l.type==="number")o[l.name]=parseFloat(l.default)||0;else if(l.type==="boolean")o[l.name]=l.default.toLowerCase()==="true";else if(l.type==="array")try{o[l.name]=JSON.parse(l.default)}catch{o[l.name]=l.default.split(",").map(c=>c.trim())}else o[l.name]=l.default;return o},{}),{Form:a}=GT({fields:s,submitLabel:"",formOptions:{defaultValues:i,onSubmit:async()=>{},onChange:async({value:o})=>{t(o),await r(o)}}});return E.useEffect(()=>{n.current&&(n.current.textContent=e.prompt)},[e.prompt,n]),f.jsxs("div",{className:"md:flex md:space-x-4",children:[f.jsx("div",{className:"md:w-1/2 border rounded-lg p-4",children:e.variables.length===0?f.jsx("div",{className:"text-center",children:f.jsx("p",{className:"text-muted-foreground",children:"This agent has no variables defined. The agent will be applied as-is."})}):f.jsxs(f.Fragment,{children:[f.jsx(Ot,{className:"text-sm font-medium mb-4 block",children:"Agent Configuration"}),f.jsx(a,{})]})}),f.jsxs("div",{className:"md:w-1/2 border rounded-lg p-4",children:[f.jsx(Ot,{className:"text-sm font-medium",children:"System Prompt Preview"}),f.jsx("div",{ref:n,className:"mt-2 p-3 bg-muted rounded text-sm font-mono whitespace-pre-wrap max-h-64 overflow-y-auto"})]})]})}function fHe({task:e,onChange:t,previewElementRef:n,onCompile:r}){const s=e.variables.map(o=>({name:o.name,type:o.type==="boolean"?"switch":o.type==="number"?"number":o.type==="array"?"textarea":"text",label:o.name,placeholder:o.default||`Enter ${o.name}`,description:o.description||o.instructions,required:o.required})),i=e.variables.reduce((o,l)=>{if(l.default)if(l.type==="number")o[l.name]=parseFloat(l.default)||0;else if(l.type==="boolean")o[l.name]=l.default.toLowerCase()==="true";else if(l.type==="array")try{o[l.name]=JSON.parse(l.default)}catch{o[l.name]=l.default.split(",").map(c=>c.trim())}else o[l.name]=l.default;return o},{}),{Form:a}=GT({fields:s,submitLabel:"",formOptions:{defaultValues:i,onSubmit:async()=>{},onChange:async({value:o})=>{t(o),await r(o)}}});return E.useEffect(()=>{n.current&&(n.current.textContent=e.prompt)},[e.prompt,n]),f.jsxs("div",{className:"md:flex md:space-x-4",children:[f.jsx("div",{className:"md:w-1/2 border rounded-lg p-4",children:e.variables.length===0?f.jsx("div",{className:"text-center",children:f.jsx("p",{className:"text-muted-foreground",children:"This task has no variables defined. The task will be executed as-is."})}):f.jsxs(f.Fragment,{children:[f.jsx(Ot,{className:"text-sm font-medium mb-4 block",children:"Task Configuration"}),f.jsx(a,{})]})}),f.jsxs("div",{className:"md:w-1/2 border rounded-lg p-4",children:[f.jsx(Ot,{className:"text-sm font-medium",children:"Task Prompt Preview"}),f.jsx("div",{ref:n,className:"mt-2 p-3 bg-muted rounded text-sm font-mono whitespace-pre-wrap max-h-64 overflow-y-auto"})]})]})}function hHe({agent:e,tasks:t,onSubmit:n,onBack:r,previewElementRef:s,onCompile:i,autoClearEnabled:a,onAutoClearChange:o,module:l}){const[c,u]=E.useState(""),[d,h]=E.useState({}),[m,y]=E.useState({}),b=E.useRef(null),v=t.find(R=>R.id===c),x=R=>{h(R)},w=R=>{y(R)},S=R=>{u(R),y({})},k=()=>{v?n(d,v,m):n(d)},C=async R=>{if(s.current)try{await i(R)}catch(N){s.current&&(s.current.textContent=`Error: ${N instanceof Error?N.message:"Compilation failed"}`)}},T=async R=>{if(!(!v||!b.current))try{const N=await l.compileTaskTemplate(v.id,R);b.current.textContent=N.content}catch(N){b.current.textContent=`Error: ${N instanceof Error?N.message:"Compilation failed"}`}};return f.jsxs("div",{className:"flex flex-col h-full",children:[f.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[f.jsxs(mt,{variant:"ghost",size:"sm",onClick:r,children:[f.jsx(hpe,{className:"h-4 w-4 mr-1"}),"Back to Agents"]}),f.jsx("div",{className:"flex-1"}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(Ot,{htmlFor:"auto-clear",className:"text-sm",children:"Auto-clear after use"}),f.jsx(Oo,{id:"auto-clear",checked:a,onCheckedChange:o})]})]}),t.length>0&&f.jsxs(dl,{className:"mb-4",children:[f.jsxs(fl,{children:[f.jsx(hl,{className:"text-lg",children:"Task Selection (Optional)"}),f.jsx(zd,{children:"Choose a task to execute with this agent, or leave empty to use the agent alone."})]}),f.jsx(pl,{children:f.jsxs("div",{children:[f.jsx(Ot,{htmlFor:"task-select",children:"Select Task"}),f.jsxs("div",{className:"flex gap-2",children:[f.jsxs(tp,{value:c,onValueChange:S,children:[f.jsx(rp,{className:"flex-1",children:f.jsx(np,{placeholder:"Select a task (optional)"})}),f.jsx(sp,{children:t.map(R=>f.jsx(Ro,{value:R.id,children:R.name},R.id))})]}),c&&f.jsx(mt,{variant:"outline",size:"sm",onClick:()=>u(""),children:"Clear"})]})]})})]}),f.jsxs("div",{className:"flex-1 overflow-auto space-y-4",children:[f.jsxs(dl,{children:[f.jsxs(fl,{children:[f.jsx(hl,{className:"text-lg",children:"Agent Configuration"}),f.jsxs(zd,{children:["Configure the system prompt and settings for ",e.name]})]}),f.jsx(pl,{children:f.jsx(dHe,{agent:e,onChange:x,previewElementRef:s,onCompile:C})})]}),v&&f.jsxs(dl,{children:[f.jsxs(fl,{children:[f.jsx(hl,{className:"text-lg",children:"Task Configuration"}),f.jsxs(zd,{children:["Configure the task prompt for ",v.name]})]}),f.jsx(pl,{children:f.jsx(fHe,{task:v,onChange:w,previewElementRef:b,onCompile:T})})]}),f.jsx("div",{className:"flex justify-end pt-4",children:f.jsxs(mt,{onClick:k,size:"lg",children:["Use Agent ",v?`with ${v.name}`:""]})})]})]})}const pHe=({module:e})=>{const[t,n]=E.useState(!1),[r,s]=E.useState(null),[i,a]=E.useState(!1),[o,l]=E.useState(0),c=E.useRef(null);E.useEffect(()=>{const C=()=>{l(T=>T+1)};return e.setNotifyCallback(C),()=>{e.setNotifyCallback(null)}},[e]),E.useEffect(()=>{t&&e.loadPromptTemplates()},[t,e]);const u=e.getAgents(),d=e.hasActiveAgent(),h=e.getCurrentAgentId(),m=h?u.find(C=>C.id===h):null;E.useEffect(()=>{},[o]);const y=C=>{s(C),a(!0)},b=async(C,T,R)=>{var N;if(r)try{T&&R?(await e.applyAgentWithTask(r.id,T.id,C,R),Me.success(`Agent "${r.name}" applied with task "${T.name}"!`)):(await e.applyAgent(r.id,C),Me.success(`Agent "${r.name}" applied!`)),e.getAutoClearEnabled()&&((N=e.clearOnSubmit)==null||N.call(e)),n(!1),s(null),a(!1)}catch(I){console.error("Failed to apply agent:",I),Me.error("Failed to apply agent!")}},v=()=>{s(null),a(!1)},x=()=>{var C;(C=e.clearOnSubmit)==null||C.call(e),Me.success("Agent cleared!")},w=async C=>{if(!(!r||!c.current))try{const T=await e.compileTemplate(r.id,C);c.current.textContent=T.content}catch(T){c.current.textContent=`Error: ${T instanceof Error?T.message:"Compilation failed"}`}},S=()=>i&&r?`Configure ${r.name}`:"Select Agent",k=()=>i&&r?"Configure the agent and optionally select a task to execute.":"Select an AI agent to work with. Each agent has specialized capabilities and tasks.";return f.jsxs(f.Fragment,{children:[f.jsx(mt,{variant:d?"secondary":"ghost",size:"sm",onClick:()=>n(!0),className:"h-8 w-8 p-0",title:d?`Active Agent: ${(m==null?void 0:m.name)||"Unknown"}`:"Select Agent",children:f.jsx(cHe,{className:"h-4 w-4"})}),f.jsx(op,{open:t,onOpenChange:n,children:f.jsxs(lp,{className:"!w-[80vw] !h-[85vh] !max-w-none flex flex-col",children:[f.jsxs(cp,{children:[f.jsx(up,{children:S()}),f.jsx(eg,{children:k()})]}),f.jsx("div",{className:"flex-1 overflow-hidden",children:i&&r?f.jsx(hHe,{agent:r,tasks:e.getTasksForAgent(r.id),onSubmit:b,onBack:v,previewElementRef:c,onCompile:w,autoClearEnabled:e.getAutoClearEnabled(),onAutoClearChange:e.setAutoClearEnabled,module:e}):f.jsx(uHe,{agents:u,onUseAgent:y,onClearAgent:x,hasActiveAgent:d,currentAgentName:m==null?void 0:m.name,module:e})})]})})]})};class mHe{constructor(){de(this,"id","agent-control");de(this,"unregisterPromptControlCallback",null);de(this,"unregisterCallback");de(this,"eventUnsubscribers",[]);de(this,"modApiRef",null);de(this,"allTemplates",[]);de(this,"isLoadingTemplates",!0);de(this,"notifyComponentUpdate",null);de(this,"currentAgentId",null);de(this,"currentAgentSystemPrompt",null);de(this,"autoClearEnabled",!1);de(this,"getAllTemplates",()=>this.allTemplates);de(this,"getAgents",()=>this.allTemplates.filter(t=>(t.type||"prompt")==="agent"));de(this,"getTasksForAgent",t=>this.allTemplates.filter(n=>(n.type||"prompt")==="task"&&n.parentId===t));de(this,"getIsLoadingTemplates",()=>this.isLoadingTemplates);de(this,"compileTemplate",async(t,n)=>{const{compilePromptTemplate:r}=Mm.getState();return await r(t,n)});de(this,"compileTaskTemplate",async(t,n)=>{const{compilePromptTemplate:r}=Mm.getState();return await r(t,n)});de(this,"applyTemplate",async(t,n)=>{var s;const r=await this.compileTemplate(t,n);(s=this.modApiRef)==null||s.emit(gn.setInputTextRequest,{text:r.content}),r.selectedTools&&r.selectedTools.length>0,r.selectedRules&&r.selectedRules.length>0});de(this,"applyAgent",async(t,n)=>{var s;const r=await this.compileTemplate(t,n);this.currentAgentId=t,this.currentAgentSystemPrompt=r.content,(s=this.notifyComponentUpdate)==null||s.call(this),r.selectedTools&&r.selectedTools.length>0,r.selectedRules&&r.selectedRules.length>0});de(this,"applyAgentWithTask",async(t,n,r,s)=>{var a;await this.applyAgent(t,r);const i=await this.compileTemplate(n,s);(a=this.modApiRef)==null||a.emit(gn.setInputTextRequest,{text:i.content}),i.selectedTools&&i.selectedTools.length>0,i.selectedRules&&i.selectedRules.length>0});de(this,"getCurrentAgentId",()=>this.currentAgentId);de(this,"getCurrentAgentSystemPrompt",()=>this.currentAgentSystemPrompt);de(this,"hasActiveAgent",()=>this.currentAgentId!==null);de(this,"getAutoClearEnabled",()=>this.autoClearEnabled);de(this,"setAutoClearEnabled",t=>{this.autoClearEnabled=t});de(this,"clearOnSubmit",()=>{var t;this.currentAgentId=null,this.currentAgentSystemPrompt=null,(t=this.notifyComponentUpdate)==null||t.call(this)});de(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t});de(this,"loadPromptTemplates",()=>{var t;(t=this.modApiRef)==null||t.emit(Qa.loadPromptTemplatesRequest,{})})}async initialize(t){this.modApiRef=t,t.emit(Qa.loadPromptTemplatesRequest,{});const n=t.on(Qa.promptTemplatesChanged,a=>{var o;a!=null&&a.promptTemplates&&(this.allTemplates=a.promptTemplates,this.isLoadingTemplates=!1,(o=this.notifyComponentUpdate)==null||o.call(this))}),r=t.on(Qa.promptTemplateAdded,a=>{var o;a!=null&&a.promptTemplate&&(this.allTemplates=[...this.allTemplates,a.promptTemplate],(o=this.notifyComponentUpdate)==null||o.call(this))}),s=t.on(Qa.promptTemplateUpdated,a=>{var o;if(a!=null&&a.promptTemplate){const l=this.allTemplates.findIndex(c=>c.id===a.promptTemplate.id);l!==-1&&(this.allTemplates[l]=a.promptTemplate,(o=this.notifyComponentUpdate)==null||o.call(this))}}),i=t.on(Qa.promptTemplateDeleted,a=>{var o;a!=null&&a.id&&(this.allTemplates=this.allTemplates.filter(l=>l.id!==a.id),(o=this.notifyComponentUpdate)==null||o.call(this))});this.eventUnsubscribers.push(n,r,s,i)}register(t){this.modApiRef=t,this.unregisterPromptControlCallback||(this.unregisterPromptControlCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>Ve.createElement(pHe,{module:this}),getMetadata:()=>{if(this.currentAgentSystemPrompt)return{turnSystemPrompt:this.currentAgentSystemPrompt}},clearOnSubmit:()=>{var n;this.autoClearEnabled&&(this.currentAgentId=null,this.currentAgentSystemPrompt=null,(n=this.notifyComponentUpdate)==null||n.call(this))}}))}destroy(t){this.eventUnsubscribers.forEach(n=>n()),this.eventUnsubscribers=[],this.unregisterPromptControlCallback&&(this.unregisterPromptControlCallback(),this.unregisterPromptControlCallback=null),this.modApiRef=null,this.notifyComponentUpdate=null,this.unregisterCallback&&this.unregisterCallback()}}const gHe=Ke({enableStreamingMarkdown:Kn(),enableStreamingCodeBlockParsing:Kn(),foldStreamingCodeBlocks:Kn(),foldUserMessagesOnCompletion:Kn(),enableAutoScrollOnStream:Kn(),streamingRenderFPS:At().min(3,"Min 3 FPS").max(60,"Max 60 FPS"),autoScrollInterval:At().min(50,"Min 50ms").max(5e3,"Max 5000ms")}),yHe=()=>{const e=br(yn(s=>({setEnableStreamingMarkdown:s.setEnableStreamingMarkdown,setEnableStreamingCodeBlockParsing:s.setEnableStreamingCodeBlockParsing,setFoldStreamingCodeBlocks:s.setFoldStreamingCodeBlocks,setFoldUserMessagesOnCompletion:s.setFoldUserMessagesOnCompletion,setStreamingRenderFPS:s.setStreamingRenderFPS,setAutoScrollInterval:s.setAutoScrollInterval,setEnableAutoScrollOnStream:s.setEnableAutoScrollOnStream,resetGeneralSettings:s.resetGeneralSettings}))),t=br(yn(s=>({enableStreamingMarkdown:s.enableStreamingMarkdown,enableStreamingCodeBlockParsing:s.enableStreamingCodeBlockParsing,foldStreamingCodeBlocks:s.foldStreamingCodeBlocks,foldUserMessagesOnCompletion:s.foldUserMessagesOnCompletion,streamingRenderFPS:s.streamingRenderFPS,autoScrollInterval:s.autoScrollInterval,enableAutoScrollOnStream:s.enableAutoScrollOnStream}))),n=ii({defaultValues:{enableStreamingMarkdown:t.enableStreamingMarkdown??!0,enableStreamingCodeBlockParsing:t.enableStreamingCodeBlockParsing??!0,foldStreamingCodeBlocks:t.foldStreamingCodeBlocks??!1,foldUserMessagesOnCompletion:t.foldUserMessagesOnCompletion??!1,enableAutoScrollOnStream:t.enableAutoScrollOnStream??!0,streamingRenderFPS:t.streamingRenderFPS??15,autoScrollInterval:t.autoScrollInterval??1e3},validators:{onChangeAsync:gHe,onChangeAsyncDebounceMs:500},onSubmit:async({value:s})=>{e.setEnableStreamingMarkdown(s.enableStreamingMarkdown),e.setEnableStreamingCodeBlockParsing(s.enableStreamingCodeBlockParsing),e.setFoldStreamingCodeBlocks(s.foldStreamingCodeBlocks),e.setFoldUserMessagesOnCompletion(s.foldUserMessagesOnCompletion),e.setEnableAutoScrollOnStream(s.enableAutoScrollOnStream),e.setStreamingRenderFPS(s.streamingRenderFPS),e.setAutoScrollInterval(s.autoScrollInterval)}});E.useEffect(()=>{n.reset({enableStreamingMarkdown:t.enableStreamingMarkdown??!0,enableStreamingCodeBlockParsing:t.enableStreamingCodeBlockParsing??!0,foldStreamingCodeBlocks:t.foldStreamingCodeBlocks??!1,foldUserMessagesOnCompletion:t.foldUserMessagesOnCompletion??!1,enableAutoScrollOnStream:t.enableAutoScrollOnStream??!0,streamingRenderFPS:t.streamingRenderFPS??15,autoScrollInterval:t.autoScrollInterval??1e3})},[t.enableStreamingMarkdown,t.enableStreamingCodeBlockParsing,t.foldStreamingCodeBlocks,t.foldUserMessagesOnCompletion,t.enableAutoScrollOnStream,t.streamingRenderFPS,t.autoScrollInterval,n]);const r=()=>{window.confirm("Are you sure you want to reset Streaming & Display settings to their defaults?")&&e.resetGeneralSettings()};return f.jsxs("form",{onSubmit:s=>{s.preventDefault(),s.stopPropagation(),n.handleSubmit()},className:"p-1 space-y-4",children:[f.jsxs("div",{className:"space-y-3",children:[f.jsx("h3",{className:"text-lg font-medium",children:"Streaming & Display"}),f.jsx(em,{form:n,name:"enableStreamingMarkdown",label:"Parse Markdown While Streaming",description:"Render Markdown formatting as the response arrives (may impact performance slightly)."}),f.jsx(em,{form:n,name:"enableStreamingCodeBlockParsing",label:"Use Full Code Blocks While Streaming",description:"Use the syntax-highlighting component for code blocks during streaming."}),f.jsx(em,{form:n,name:"foldStreamingCodeBlocks",label:"Fold Code Blocks by Default During Streaming",description:"Automatically collapse code blocks as they stream in. Useful for long code outputs."}),f.jsx(em,{form:n,name:"foldUserMessagesOnCompletion",label:"Fold User Messages After Response",description:"Automatically collapse the user's prompt message once the assistant finishes responding."}),f.jsx(em,{form:n,name:"enableAutoScrollOnStream",label:"Auto-Scroll While Streaming",description:"Automatically scroll to the bottom as new content arrives."}),f.jsxs("div",{className:"rounded-lg border p-3 shadow-sm space-y-2",children:[f.jsx(Sc,{form:n,name:"streamingRenderFPS",label:"Streaming Update Rate",min:3,max:60,step:1,valueLabelSuffix:" FPS"}),f.jsx(Ty,{form:n,name:"streamingRenderFPS",label:"FPS Input",min:3,max:60,step:1,className:"w-24 h-8 text-xs ml-auto","aria-label":"Streaming Render FPS Value"}),f.jsx("p",{className:Xe("text-sm text-muted-foreground"),children:"Controls how frequently the UI updates during streaming (3-60 FPS)."})]}),f.jsxs("div",{className:"rounded-lg border p-3 shadow-sm space-y-2",children:[f.jsx(Sc,{form:n,name:"autoScrollInterval",label:"Auto-Scroll Interval",min:50,max:5e3,step:50,valueLabelSuffix:" ms",disabled:!n.state.values.enableAutoScrollOnStream}),f.jsx(Ty,{form:n,name:"autoScrollInterval",label:"Interval Input (ms)",min:50,max:5e3,step:50,className:"w-24 h-8 text-xs ml-auto",disabled:!n.state.values.enableAutoScrollOnStream,"aria-label":"Auto Scroll Interval Value"}),f.jsx("p",{className:Xe("text-sm text-muted-foreground"),children:"How often to scroll to the bottom during streaming (50-5000 ms)."})]})]}),f.jsx(jm,{}),f.jsx("div",{className:"flex items-center justify-between pt-3",children:f.jsx(n.Subscribe,{children:s=>{const i=s.canSubmit,a=s.isSubmitting,o=s.isValidating,l=s.isValid;return f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(mt,{type:"submit",size:"sm",disabled:!i||a||o||!l,children:a?"Saving...":o?"Validating...":"Save Changes"}),f.jsxs(mt,{variant:"outline",size:"sm",onClick:r,type:"button",children:[f.jsx(yE,{className:"mr-2 h-4 w-4"}),"Reset General Settings"]})]})}})})]})},bHe=Ve.memo(yHe);class vHe{constructor(){de(this,"id","core-settings-general");de(this,"unregisterCallback",null)}async initialize(t){}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerSettingsTab({id:"general",title:"General",component:bHe,order:10})}destroy(){this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),console.log(`[${this.id}] Destroyed.`)}}const xHe=({label:e,colorKey:t,value:n,onChange:r})=>{const[s,i]=E.useState(n??"");E.useEffect(()=>{i(n??"")},[n]);const a=()=>{r(t,s.trim()||null)},o=l=>{i(l.target.value)};return f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(Ot,{htmlFor:`color-${t}`,className:"text-xs w-28 shrink-0",children:e}),f.jsx(Cn,{id:`color-${t}`,type:"text",value:s,onChange:o,onBlur:a,className:"h-8 text-xs flex-grow",placeholder:"e.g., #ffffff or oklch(0.5 0.2 180)"}),f.jsx(Cn,{type:"color",value:s!=null&&s.startsWith("#")?s:"#000000",onChange:l=>{i(l.target.value),r(t,l.target.value)},className:"h-8 w-10 p-1 border-none cursor-pointer bg-transparent","aria-label":`Pick ${e} color`})]})},wHe=[{label:"Default Light",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-material-light.min.css"},{label:"A11y Dark",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-a11y-dark.min.css"},{label:"Atom Dark",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-atom-dark.min.css"},{label:"Atelier Sulphurpool Light",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-base16-ateliersulphurpool.light.min.css"},{label:"CB",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-cb.min.css"},{label:"Coldark Cold",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-coldark-cold.min.css"},{label:"Coldark Dark",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-coldark-dark.min.css"},{label:"Coy (No Shadow)",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-coy-without-shadows.min.css"},{label:"Darcula",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-darcula.min.css"},{label:"Dracula",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-dracula.min.css"},{label:"Duotone Dark",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-duotone-dark.min.css"},{label:"Duotone Earth",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-duotone-earth.min.css"},{label:"Duotone Forest",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-duotone-forest.min.css"},{label:"Duotone Light",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-duotone-light.min.css"},{label:"Duotone Sea",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-duotone-sea.min.css"},{label:"Duotone Space",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-duotone-space.min.css"},{label:"GH Colors",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-ghcolors.min.css"},{label:"Gruvbox Dark",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-gruvbox-dark.min.css"},{label:"Gruvbox Light",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-gruvbox-light.min.css"},{label:"Holi",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-holi-theme.min.css"},{label:"Hopscotch",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-hopscotch.min.css"},{label:"Lucario",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-lucario.min.css"},{label:"Material Dark",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-material-dark.min.css"},{label:"Material Oceanic",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-material-oceanic.min.css"},{label:"Night Owl",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-night-owl.min.css"},{label:"Nord",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-nord.min.css"},{label:"One Dark",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-one-dark.min.css"},{label:"One Light",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-one-light.min.css"},{label:"Pojoaque",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-pojoaque.min.css"},{label:"Shades of Purple",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-shades-of-purple.min.css"},{label:"Solarized Dark Atom",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-solarized-dark-atom.min.css"},{label:"Synthwave '84",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-synthwave84.min.css"},{label:"VS",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-vs.min.css"},{label:"VSC Dark Plus",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-vsc-dark-plus.min.css"},{label:"Xonokai",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-xonokai.min.css"},{label:"Z-Touch",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-z-touch.min.css"}],_He=xl(["system","light","dark","TijuLight","TijuDark","custom"]),SHe=Ke({theme:_He,prismThemeUrl:ze(),customFontFamily:ze(),customFontSize:At().min(12).max(20),chatMaxWidth:ze(),customThemeColors:xh(ze(),ze().nullable())}),CHe=()=>{const e=br(yn(a=>({setTheme:a.setTheme,setPrismThemeUrl:a.setPrismThemeUrl,setCustomFontFamily:a.setCustomFontFamily,setCustomFontSize:a.setCustomFontSize,setChatMaxWidth:a.setChatMaxWidth,setCustomThemeColor:a.setCustomThemeColor,resetThemeSettings:a.resetThemeSettings}))),t=br(yn(a=>({theme:a.theme,prismThemeUrl:a.prismThemeUrl,customFontFamily:a.customFontFamily,customFontSize:a.customFontSize,chatMaxWidth:a.chatMaxWidth,_rawCustomThemeColors:a.customThemeColors}))),n=ii({defaultValues:{theme:t.theme??"system",prismThemeUrl:t.prismThemeUrl??"",customFontFamily:t.customFontFamily??"",customFontSize:t.customFontSize??16,chatMaxWidth:t.chatMaxWidth??"max-w-7xl",customThemeColors:t._rawCustomThemeColors??{}},onSubmit:async({value:a})=>{e.setTheme(a.theme),e.setPrismThemeUrl(a.prismThemeUrl||null),e.setCustomFontFamily(a.customFontFamily),e.setCustomFontSize(a.customFontSize),e.setChatMaxWidth(a.chatMaxWidth),a.customThemeColors&&Object.entries(a.customThemeColors).forEach(([o,l])=>{e.setCustomThemeColor(o,l)})},validators:{onChangeAsync:SHe,onChangeAsyncDebounceMs:300}});E.useEffect(()=>{n.reset({theme:t.theme??"system",prismThemeUrl:t.prismThemeUrl??"",customFontFamily:t.customFontFamily??"",customFontSize:t.customFontSize??16,chatMaxWidth:t.chatMaxWidth??"max-w-7xl",customThemeColors:t._rawCustomThemeColors??{}})},[t.theme,t.prismThemeUrl,t.customFontFamily,t.customFontSize,t.chatMaxWidth,t._rawCustomThemeColors]);const r=()=>{window.confirm("Are you sure you want to reset all Theme settings to their defaults?")&&e.resetThemeSettings()},s=[{value:"max-w-3xl",label:"Very Small"},{value:"max-w-4xl",label:"Small"},{value:"max-w-5xl",label:"Medium"},{value:"max-w-6xl",label:"Large"},{value:"max-w-7xl",label:"Very Large"},{value:"max-w-full",label:"Full Width"}],i=[{key:"background",label:"Background"},{key:"foreground",label:"Foreground"},{key:"card",label:"Card BG"},{key:"cardForeground",label:"Card FG"},{key:"popover",label:"Popover BG"},{key:"popoverForeground",label:"Popover FG"},{key:"primary",label:"Primary"},{key:"primaryForeground",label:"Primary FG"},{key:"secondary",label:"Secondary"},{key:"secondaryForeground",label:"Secondary FG"},{key:"muted",label:"Muted BG"},{key:"mutedForeground",label:"Muted FG"},{key:"accent",label:"Accent"},{key:"accentForeground",label:"Accent FG"},{key:"destructive",label:"Destructive"},{key:"destructiveForeground",label:"Destructive FG"},{key:"border",label:"Border"},{key:"input",label:"Input BG"},{key:"ring",label:"Ring (Focus)"},{key:"sidebar",label:"Sidebar BG"},{key:"sidebarForeground",label:"Sidebar FG"},{key:"sidebarPrimary",label:"Sidebar Primary"},{key:"sidebarPrimaryForeground",label:"Sidebar Primary FG"},{key:"sidebarAccent",label:"Sidebar Accent"},{key:"sidebarAccentForeground",label:"Sidebar Accent FG"},{key:"sidebarBorder",label:"Sidebar Border"},{key:"sidebarRing",label:"Sidebar Ring"},{key:"chart1",label:"Chart 1"},{key:"chart2",label:"Chart 2"},{key:"chart3",label:"Chart 3"},{key:"chart4",label:"Chart 4"},{key:"chart5",label:"Chart 5"}];return f.jsxs("form",{onSubmit:a=>{a.preventDefault(),a.stopPropagation(),n.handleSubmit()},className:"space-y-4 p-1",children:[f.jsx(mx,{title:"Base Theme",description:"Select the overall look and feel.",contentClassName:"rounded-lg border p-3 shadow-sm bg-card",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx(Ot,{htmlFor:"theme-select",className:"font-medium",children:"Theme"}),f.jsx(Ox,{form:n,name:"theme",label:"Theme",options:[{value:"light",label:"Default Light"},{value:"dark",label:"Default Dark"},{value:"system",label:"System"},{value:"TijuLight",label:"Tiju Light"},{value:"TijuDark",label:"Tiju Dark"},{value:"custom",label:"User Custom"}],triggerClassName:"w-[180px]"})]})}),f.jsxs(mx,{title:"Font & Layout",description:"Customize typography and content width.",contentClassName:"rounded-lg border p-3 shadow-sm bg-card space-y-3",children:[f.jsxs("div",{children:[f.jsx(Gw,{form:n,name:"customFontFamily",label:"Custom Font Family",placeholder:"e.g., 'Inter', sans-serif (Leave blank for default)",className:"mt-1"}),f.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Applies only when 'User Custom' theme is selected. Ensure the font is available (system or web font)."})]}),f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(Sc,{form:n,name:"customFontSize",label:`Base Font Size (${n.getFieldValue("customFontSize")}px)`,min:12,max:20,step:1,className:"mt-1"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Applies only when 'User Custom' theme is selected. Affects base text size (Default: 16px)."})]}),f.jsxs("div",{children:[f.jsx(Ox,{form:n,name:"chatMaxWidth",label:"Chat Content Max Width",options:s,triggerClassName:"w-full mt-1"}),f.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Controls the maximum width of the main chat message area."})]})]}),f.jsxs(mx,{title:"Code Block Theme",description:"Customize syntax highlighting appearance.",contentClassName:"rounded-lg border p-3 shadow-sm bg-card space-y-3",children:[f.jsx(Ox,{form:n,name:"prismThemeUrl",label:"Code Block Theme",options:wHe,triggerClassName:"w-full"}),f.jsx(Gw,{form:n,name:"prismThemeUrl",label:"Or paste custom theme URL here...",placeholder:"Or paste custom theme URL here...",type:"url",className:"mt-1"}),f.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Select a preset theme or paste a URL to a PrismJS CSS file. Leave blank or select 'Default' to use themes matching light/dark mode."})]}),n.getFieldValue("theme")==="custom"&&f.jsx(mx,{title:"Custom Theme Colors",description:"Define custom colors. Use valid CSS color values (hex, rgb, oklch, etc.). Leave blank to use default light/dark theme colors.",contentClassName:"rounded-lg border p-3 shadow-sm bg-card",children:f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-4 gap-y-2",children:i.map(({key:a,label:o})=>{var l;return f.jsx(xHe,{label:o,colorKey:a,value:(l=n.getFieldValue("customThemeColors"))==null?void 0:l[a],onChange:(c,u)=>n.setFieldValue(`customThemeColors.${c}`,u===null?"":u)},a)})})}),f.jsx(jm,{}),f.jsxs("div",{className:"flex justify-between pt-3",children:[f.jsxs(mt,{variant:"outline",size:"sm",onClick:r,type:"button",children:[f.jsx(yE,{className:"mr-2 h-4 w-4"}),"Reset Theme Settings"]}),f.jsx(mt,{type:"submit",size:"sm",className:"bg-primary text-primary-foreground hover:bg-primary/90",children:"Apply Theme Settings"})]})]})},kHe=Ve.memo(CHe);class EHe{constructor(){de(this,"id","core-settings-theme");de(this,"unregisterCallback",null)}async initialize(t){}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerSettingsTab({id:"theme",title:"Theme",component:kHe,order:20})}destroy(){this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),console.log(`[${this.id}] Destroyed.`)}}const THe=({provider:e,apiKeys:t,onEdit:n,onDelete:r,onFetchModels:s,onUpdate:i,fetchStatus:a,isDeleting:o,allAvailableModelsForView:l})=>{var N,I;const[c,u]=E.useState(!0),d=sy(e.type),h=OC(e.type),m=hm(e.type),y=a==="fetching"||o,b=o||a==="fetching",v=o||a==="fetching",x=E.useMemo(()=>new Set(e.enabledModels??[]),[e.enabledModels]),w=e.apiKeyId?t.some(P=>P.id===e.apiKeyId):!1,S=d&&!w,k=E.useCallback(async(P,B)=>{const D=new Set(e.enabledModels??[]);B?D.add(P):D.delete(P);const W=Array.from(D);try{await i(e.id,{enabledModels:W})}catch(O){Me.error("Failed to update model status."),console.error("Failed to save model toggle:",O)}},[e.enabledModels,e.id,i]),C=()=>u(P=>!P),T=((N=e.enabledModels)==null?void 0:N.length)??0,R=l.length;return f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center space-x-3 min-w-0",children:[f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{children:f.jsx("span",{className:Xe("h-2.5 w-2.5 rounded-full flex-shrink-0 block",a==="error"?"bg-destructive animate-pulse":e.isEnabled?"bg-green-500":"bg-muted-foreground")})}),f.jsx(Sr,{side:"top",children:a==="error"?"Error fetching models":e.isEnabled?"Enabled":"Disabled"})]})}),f.jsx("h3",{className:"font-semibold text-lg text-card-foreground truncate",children:e.name}),f.jsxs("span",{className:"text-sm text-muted-foreground flex-shrink-0",children:["(",e.type,")"]}),S&&f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{children:f.jsx(Kl,{className:"h-4 w-4 text-amber-500 flex-shrink-0"})}),f.jsx(Sr,{side:"top",children:f.jsx("p",{children:"API Key required but none linked/found."})})]})})]}),f.jsxs("div",{className:"flex items-center space-x-1 flex-shrink-0",children:[f.jsx(Un,{tooltipText:"Edit",onClick:n,disabled:b,"aria-label":"Edit provider",icon:f.jsx(p1,{}),className:"h-8 w-8"}),f.jsx(Un,{tooltipText:"Delete",onClick:r,disabled:v,className:"text-destructive hover:text-destructive/80 h-8 w-8","aria-label":"Delete provider",icon:o?f.jsx(Xn,{className:"h-4 w-4 animate-spin"}):f.jsx(Mo,{})})]})]}),f.jsxs("div",{className:"text-sm text-muted-foreground mt-1 space-y-1 pl-5",children:[d&&f.jsxs("div",{children:["API Key:"," ",e.apiKeyId?w?f.jsx("span",{className:"text-green-400",children:((I=t.find(P=>P.id===e.apiKeyId))==null?void 0:I.name)||"Linked (Unnamed Key)"}):f.jsx("span",{className:"text-destructive",children:"Linked Key Missing!"}):f.jsx("span",{className:"text-amber-400",children:"Not Linked"})]}),h&&f.jsxs("div",{children:["Base URL: ",e.baseURL||"Not Set"]}),f.jsxs("div",{children:["Auto-fetch Models:"," ",e.autoFetchModels?f.jsx("span",{className:"text-green-400",children:"Enabled"}):f.jsx("span",{className:"text-muted-foreground/80",children:"Disabled"}),e.fetchedModels&&f.jsxs("span",{className:"text-xs text-muted-foreground/80 ml-2",children:["(Last fetched:"," ",e.modelsLastFetchedAt?new Date(e.modelsLastFetchedAt).toLocaleString():"Never",")"]})]}),m&&f.jsx("div",{className:"pt-1",children:f.jsxs(mt,{variant:"outline",size:"sm",onClick:s,disabled:y,className:"text-xs h-7 px-2",children:[a==="fetching"&&f.jsx(Xn,{className:"h-3 w-3 mr-1 animate-spin"}),a==="success"&&f.jsx(ao,{className:"h-3 w-3 mr-1 text-green-500"}),a==="error"&&f.jsx(Kl,{className:"h-3 w-3 mr-1 text-destructive"}),a==="idle"&&f.jsx(vm,{className:"h-3 w-3 mr-1"}),a==="fetching"?"Fetching...":a==="error"?"Fetch Failed":"Fetch Models Now"]})})]}),f.jsxs("div",{className:"space-y-1 pt-2",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("span",{className:"font-medium text-card-foreground text-sm",children:["Model Enablement (",T," / ",R," enabled)"]}),f.jsx(Un,{tooltipText:c?"Show Models":"Hide Models",onClick:C,"aria-label":c?"Show model list":"Hide model list",icon:c?f.jsx(Jl,{}):f.jsx(Bh,{}),className:"h-6 w-6"})]}),!c&&f.jsx(D6,{providerId:e.id,allAvailableModels:l,enabledModelIds:x,onToggleModel:k,isLoading:a==="fetching",disabled:o,listHeightClass:"h-[26rem]"})]})]})},AHe=Ve.memo(THe),RHe=({providerId:e,editData:t,apiKeys:n,allAvailableModels:r,isSaving:s,onCancel:i,onSave:a,onChange:o})=>{const l=E.useMemo(()=>new Set(t.enabledModels??[]),[t.enabledModels]),c=E.useCallback((d,h)=>{const m=new Set(t.enabledModels??[]);h?m.add(d):m.delete(d);const y=Array.from(m);o("enabledModels",y)},[t.enabledModels,o]),u=E.useCallback((d,h)=>new Promise(m=>{o(d,h),m(void 0)}),[o]);return f.jsx("div",{className:"space-y-4",children:f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[f.jsxs("div",{className:"space-y-3",children:[f.jsx("h4",{className:"text-md font-semibold text-card-foreground mb-2",children:"Basic Configuration"}),f.jsx(Ete,{initialData:t,onChange:u,onSubmit:a,onCancel:i,apiKeys:n,disabled:s})]}),f.jsxs("div",{className:"space-y-3",children:[f.jsx("h4",{className:"text-md font-semibold text-card-foreground",children:"Model Enablement"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Toggle models on/off for global use. Changes will be saved with the form."}),f.jsx(D6,{providerId:e,allAvailableModels:r,enabledModelIds:l,onToggleModel:c,disabled:s,listHeightClass:"h-[calc(100%-8rem)]"})]})]})})},NHe=Ve.memo(RHe),MHe=({provider:e,apiKeys:t,onUpdate:n,onDelete:r,onFetchModels:s,fetchStatus:i,onSelectModelForDetails:a})=>{const[o,l]=E.useState(!1),[c,u]=E.useState(!1),[d,h]=E.useState(!1),[m,y]=E.useState({name:"placeholder"}),b=Cr(I=>I.getAllAvailableModelDefsForProvider),[v,x]=E.useState([]),w=E.useMemo(()=>[...b(e.id)].sort((P,B)=>(P.name||P.id).localeCompare(B.name||B.id)),[e.id,b]);E.useEffect(()=>{if(o){const I=b(e.id);x([...I].sort((P,B)=>(P.name||P.id).localeCompare(B.name||B.id))),y({name:e.name,type:e.type,isEnabled:e.isEnabled,apiKeyId:e.apiKeyId,baseURL:e.baseURL,enabledModels:e.enabledModels??[],autoFetchModels:e.autoFetchModels})}else x([])},[o,e.id,e.name,e.type,e.isEnabled,e.apiKeyId,e.baseURL,e.enabledModels,e.autoFetchModels,b]);const S=()=>l(!0),k=()=>{l(!1),y({}),u(!1)},C=E.useCallback(async()=>{u(!0);try{const I=m.enabledModels&&m.enabledModels.length>0?m.enabledModels:null,P={name:m.name,type:m.type,isEnabled:m.isEnabled,apiKeyId:m.apiKeyId,baseURL:m.baseURL,autoFetchModels:m.autoFetchModels,enabledModels:I};Object.keys(P).forEach(B=>{P[B]===void 0&&delete P[B]}),await n(e.id,P),l(!1),y({}),Me.success(`Provider "${P.name||e.name}" updated.`)}catch(I){console.error("Failed to save provider update:",I),Me.error("Failed to save provider configuration.")}finally{u(!1)}},[m,n,e.id,e.name]),T=E.useCallback((I,P)=>{y(B=>({...B,[I]:P}))},[]),R=E.useCallback(async()=>{if(window.confirm(`Delete provider "${e.name}"?`)){h(!0);try{await r(e.id)}catch(I){console.error("Failed to delete provider:",I),h(!1)}}},[r,e.id,e.name]),N=E.useCallback(async()=>{if(await s(e.id),o){const I=b(e.id);x([...I].sort((P,B)=>(P.name||P.id).localeCompare(B.name||B.id)))}},[s,e.id,o,b]);return f.jsx("div",{className:"border border-border p-4 space-y-3 bg-card rounded-md shadow-sm",children:o?f.jsx(NHe,{providerId:e.id,editData:m,apiKeys:t,allAvailableModels:v,isSaving:c,onCancel:k,onSave:C,onChange:T}):f.jsx(AHe,{provider:e,apiKeys:t,onEdit:S,onDelete:R,onFetchModels:N,onUpdate:n,fetchStatus:i,isDeleting:d,onSelectModelForDetails:a,allAvailableModelsForView:w})})},IHe=Ve.memo(MHe);function jHe(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return E.useMemo(()=>r=>{t.forEach(s=>s(r))},t)}const KT=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function vb(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function rF(e){return"nodeType"in e}function Ho(e){var t,n;return e?vb(e)?e:rF(e)&&(t=(n=e.ownerDocument)==null?void 0:n.defaultView)!=null?t:window:window}function sF(e){const{Document:t}=Ho(e);return e instanceof t}function a_(e){return vb(e)?!1:e instanceof Ho(e).HTMLElement}function oie(e){return e instanceof Ho(e).SVGElement}function xb(e){return e?vb(e)?e.document:rF(e)?sF(e)?e:a_(e)||oie(e)?e.ownerDocument:document:document:document}const Fu=KT?E.useLayoutEffect:E.useEffect;function iF(e){const t=E.useRef(e);return Fu(()=>{t.current=e}),E.useCallback(function(){for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return t.current==null?void 0:t.current(...r)},[])}function OHe(){const e=E.useRef(null),t=E.useCallback((r,s)=>{e.current=setInterval(r,s)},[]),n=E.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,n]}function Jw(e,t){t===void 0&&(t=[e]);const n=E.useRef(e);return Fu(()=>{n.current!==e&&(n.current=e)},t),n}function o_(e,t){const n=E.useRef();return E.useMemo(()=>{const r=e(n.current);return n.current=r,r},[...t])}function Tk(e){const t=iF(e),n=E.useRef(null),r=E.useCallback(s=>{s!==n.current&&(t==null||t(s,n.current)),n.current=s},[]);return[n,r]}function D4(e){const t=E.useRef();return E.useEffect(()=>{t.current=e},[e]),t.current}let v3={};function l_(e,t){return E.useMemo(()=>{if(t)return t;const n=v3[e]==null?0:v3[e]+1;return v3[e]=n,e+"-"+n},[e,t])}function lie(e){return function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),s=1;s<n;s++)r[s-1]=arguments[s];return r.reduce((i,a)=>{const o=Object.entries(a);for(const[l,c]of o){const u=i[l];u!=null&&(i[l]=u+e*c)}return i},{...t})}}const B0=lie(1),Qw=lie(-1);function PHe(e){return"clientX"in e&&"clientY"in e}function aF(e){if(!e)return!1;const{KeyboardEvent:t}=Ho(e.target);return t&&e instanceof t}function DHe(e){if(!e)return!1;const{TouchEvent:t}=Ho(e.target);return t&&e instanceof t}function F4(e){if(DHe(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:n}=e.touches[0];return{x:t,y:n}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:n}=e.changedTouches[0];return{x:t,y:n}}}return PHe(e)?{x:e.clientX,y:e.clientY}:null}const e1=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:n}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:n}=e;return"scaleX("+t+") scaleY("+n+")"}},Transform:{toString(e){if(e)return[e1.Translate.toString(e),e1.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:n,easing:r}=e;return t+" "+n+"ms "+r}}}),Vq="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function FHe(e){return e.matches(Vq)?e:e.querySelector(Vq)}const LHe={display:"none"};function BHe(e){let{id:t,value:n}=e;return Ve.createElement("div",{id:t,style:LHe},n)}function $He(e){let{id:t,announcement:n,ariaLiveType:r="assertive"}=e;const s={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return Ve.createElement("div",{id:t,style:s,role:"status","aria-live":r,"aria-atomic":!0},n)}function zHe(){const[e,t]=E.useState("");return{announce:E.useCallback(r=>{r!=null&&t(r)},[]),announcement:e}}const cie=E.createContext(null);function UHe(e){const t=E.useContext(cie);E.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function qHe(){const[e]=E.useState(()=>new Set),t=E.useCallback(r=>(e.add(r),()=>e.delete(r)),[e]);return[E.useCallback(r=>{let{type:s,event:i}=r;e.forEach(a=>{var o;return(o=a[s])==null?void 0:o.call(a,i)})},[e]),t]}const VHe={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},WHe={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was moved over droppable area "+n.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was dropped over droppable area "+n.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function HHe(e){let{announcements:t=WHe,container:n,hiddenTextDescribedById:r,screenReaderInstructions:s=VHe}=e;const{announce:i,announcement:a}=zHe(),o=l_("DndLiveRegion"),[l,c]=E.useState(!1);if(E.useEffect(()=>{c(!0)},[]),UHe(E.useMemo(()=>({onDragStart(d){let{active:h}=d;i(t.onDragStart({active:h}))},onDragMove(d){let{active:h,over:m}=d;t.onDragMove&&i(t.onDragMove({active:h,over:m}))},onDragOver(d){let{active:h,over:m}=d;i(t.onDragOver({active:h,over:m}))},onDragEnd(d){let{active:h,over:m}=d;i(t.onDragEnd({active:h,over:m}))},onDragCancel(d){let{active:h,over:m}=d;i(t.onDragCancel({active:h,over:m}))}}),[i,t])),!l)return null;const u=Ve.createElement(Ve.Fragment,null,Ve.createElement(BHe,{id:r,value:s.draggable}),Ve.createElement($He,{id:o,announcement:a}));return n?cl.createPortal(u,n):u}var zi;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(zi||(zi={}));function Ak(){}function Wq(e,t){return E.useMemo(()=>({sensor:e,options:t??{}}),[e,t])}function GHe(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return E.useMemo(()=>[...t].filter(r=>r!=null),[...t])}const zc=Object.freeze({x:0,y:0});function uie(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function die(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return n-r}function KHe(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return r-n}function Hq(e){let{left:t,top:n,height:r,width:s}=e;return[{x:t,y:n},{x:t+s,y:n},{x:t,y:n+r},{x:t+s,y:n+r}]}function fie(e,t){if(!e||e.length===0)return null;const[n]=e;return n[t]}function Gq(e,t,n){return t===void 0&&(t=e.left),n===void 0&&(n=e.top),{x:t+e.width*.5,y:n+e.height*.5}}const YHe=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const s=Gq(t,t.left,t.top),i=[];for(const a of r){const{id:o}=a,l=n.get(o);if(l){const c=uie(Gq(l),s);i.push({id:o,data:{droppableContainer:a,value:c}})}}return i.sort(die)},ZHe=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const s=Hq(t),i=[];for(const a of r){const{id:o}=a,l=n.get(o);if(l){const c=Hq(l),u=s.reduce((h,m,y)=>h+uie(c[y],m),0),d=Number((u/4).toFixed(4));i.push({id:o,data:{droppableContainer:a,value:d}})}}return i.sort(die)};function XHe(e,t){const n=Math.max(t.top,e.top),r=Math.max(t.left,e.left),s=Math.min(t.left+t.width,e.left+e.width),i=Math.min(t.top+t.height,e.top+e.height),a=s-r,o=i-n;if(r<s&&n<i){const l=t.width*t.height,c=e.width*e.height,u=a*o,d=u/(l+c-u);return Number(d.toFixed(4))}return 0}const JHe=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const s=[];for(const i of r){const{id:a}=i,o=n.get(a);if(o){const l=XHe(o,t);l>0&&s.push({id:a,data:{droppableContainer:i,value:l}})}}return s.sort(KHe)};function QHe(e,t,n){return{...e,scaleX:t&&n?t.width/n.width:1,scaleY:t&&n?t.height/n.height:1}}function hie(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:zc}function eGe(e){return function(n){for(var r=arguments.length,s=new Array(r>1?r-1:0),i=1;i<r;i++)s[i-1]=arguments[i];return s.reduce((a,o)=>({...a,top:a.top+e*o.y,bottom:a.bottom+e*o.y,left:a.left+e*o.x,right:a.right+e*o.x}),{...n})}}const tGe=eGe(1);function nGe(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function rGe(e,t,n){const r=nGe(t);if(!r)return e;const{scaleX:s,scaleY:i,x:a,y:o}=r,l=e.left-a-(1-s)*parseFloat(n),c=e.top-o-(1-i)*parseFloat(n.slice(n.indexOf(" ")+1)),u=s?e.width/s:e.width,d=i?e.height/i:e.height;return{width:u,height:d,top:c,right:l+u,bottom:c+d,left:l}}const sGe={ignoreTransform:!1};function wb(e,t){t===void 0&&(t=sGe);let n=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:c,transformOrigin:u}=Ho(e).getComputedStyle(e);c&&(n=rGe(n,c,u))}const{top:r,left:s,width:i,height:a,bottom:o,right:l}=n;return{top:r,left:s,width:i,height:a,bottom:o,right:l}}function Kq(e){return wb(e,{ignoreTransform:!0})}function iGe(e){const t=e.innerWidth,n=e.innerHeight;return{top:0,left:0,right:t,bottom:n,width:t,height:n}}function aGe(e,t){return t===void 0&&(t=Ho(e).getComputedStyle(e)),t.position==="fixed"}function oGe(e,t){t===void 0&&(t=Ho(e).getComputedStyle(e));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(s=>{const i=t[s];return typeof i=="string"?n.test(i):!1})}function YT(e,t){const n=[];function r(s){if(t!=null&&n.length>=t||!s)return n;if(sF(s)&&s.scrollingElement!=null&&!n.includes(s.scrollingElement))return n.push(s.scrollingElement),n;if(!a_(s)||oie(s)||n.includes(s))return n;const i=Ho(e).getComputedStyle(s);return s!==e&&oGe(s,i)&&n.push(s),aGe(s,i)?n:r(s.parentNode)}return e?r(e):n}function pie(e){const[t]=YT(e,1);return t??null}function x3(e){return!KT||!e?null:vb(e)?e:rF(e)?sF(e)||e===xb(e).scrollingElement?window:a_(e)?e:null:null}function mie(e){return vb(e)?e.scrollX:e.scrollLeft}function gie(e){return vb(e)?e.scrollY:e.scrollTop}function L4(e){return{x:mie(e),y:gie(e)}}var ia;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(ia||(ia={}));function yie(e){return!KT||!e?!1:e===document.scrollingElement}function bie(e){const t={x:0,y:0},n=yie(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},r={x:e.scrollWidth-n.width,y:e.scrollHeight-n.height},s=e.scrollTop<=t.y,i=e.scrollLeft<=t.x,a=e.scrollTop>=r.y,o=e.scrollLeft>=r.x;return{isTop:s,isLeft:i,isBottom:a,isRight:o,maxScroll:r,minScroll:t}}const lGe={x:.2,y:.2};function cGe(e,t,n,r,s){let{top:i,left:a,right:o,bottom:l}=n;r===void 0&&(r=10),s===void 0&&(s=lGe);const{isTop:c,isBottom:u,isLeft:d,isRight:h}=bie(e),m={x:0,y:0},y={x:0,y:0},b={height:t.height*s.y,width:t.width*s.x};return!c&&i<=t.top+b.height?(m.y=ia.Backward,y.y=r*Math.abs((t.top+b.height-i)/b.height)):!u&&l>=t.bottom-b.height&&(m.y=ia.Forward,y.y=r*Math.abs((t.bottom-b.height-l)/b.height)),!h&&o>=t.right-b.width?(m.x=ia.Forward,y.x=r*Math.abs((t.right-b.width-o)/b.width)):!d&&a<=t.left+b.width&&(m.x=ia.Backward,y.x=r*Math.abs((t.left+b.width-a)/b.width)),{direction:m,speed:y}}function uGe(e){if(e===document.scrollingElement){const{innerWidth:i,innerHeight:a}=window;return{top:0,left:0,right:i,bottom:a,width:i,height:a}}const{top:t,left:n,right:r,bottom:s}=e.getBoundingClientRect();return{top:t,left:n,right:r,bottom:s,width:e.clientWidth,height:e.clientHeight}}function vie(e){return e.reduce((t,n)=>B0(t,L4(n)),zc)}function dGe(e){return e.reduce((t,n)=>t+mie(n),0)}function fGe(e){return e.reduce((t,n)=>t+gie(n),0)}function hGe(e,t){if(t===void 0&&(t=wb),!e)return;const{top:n,left:r,bottom:s,right:i}=t(e);pie(e)&&(s<=0||i<=0||n>=window.innerHeight||r>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const pGe=[["x",["left","right"],dGe],["y",["top","bottom"],fGe]];class oF{constructor(t,n){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const r=YT(n),s=vie(r);this.rect={...t},this.width=t.width,this.height=t.height;for(const[i,a,o]of pGe)for(const l of a)Object.defineProperty(this,l,{get:()=>{const c=o(r),u=s[i]-c;return this.rect[l]+u},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class Dx{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(n=>{var r;return(r=this.target)==null?void 0:r.removeEventListener(...n)})},this.target=t}add(t,n,r){var s;(s=this.target)==null||s.addEventListener(t,n,r),this.listeners.push([t,n,r])}}function mGe(e){const{EventTarget:t}=Ho(e);return e instanceof t?e:xb(e)}function w3(e,t){const n=Math.abs(e.x),r=Math.abs(e.y);return typeof t=="number"?Math.sqrt(n**2+r**2)>t:"x"in t&&"y"in t?n>t.x&&r>t.y:"x"in t?n>t.x:"y"in t?r>t.y:!1}var zl;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(zl||(zl={}));function Yq(e){e.preventDefault()}function gGe(e){e.stopPropagation()}var Vr;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(Vr||(Vr={}));const xie={start:[Vr.Space,Vr.Enter],cancel:[Vr.Esc],end:[Vr.Space,Vr.Enter,Vr.Tab]},yGe=(e,t)=>{let{currentCoordinates:n}=t;switch(e.code){case Vr.Right:return{...n,x:n.x+25};case Vr.Left:return{...n,x:n.x-25};case Vr.Down:return{...n,y:n.y+25};case Vr.Up:return{...n,y:n.y-25}}};class lF{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:n}}=t;this.props=t,this.listeners=new Dx(xb(n)),this.windowListeners=new Dx(Ho(n)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(zl.Resize,this.handleCancel),this.windowListeners.add(zl.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(zl.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:n}=this.props,r=t.node.current;r&&hGe(r),n(zc)}handleKeyDown(t){if(aF(t)){const{active:n,context:r,options:s}=this.props,{keyboardCodes:i=xie,coordinateGetter:a=yGe,scrollBehavior:o="smooth"}=s,{code:l}=t;if(i.end.includes(l)){this.handleEnd(t);return}if(i.cancel.includes(l)){this.handleCancel(t);return}const{collisionRect:c}=r.current,u=c?{x:c.left,y:c.top}:zc;this.referenceCoordinates||(this.referenceCoordinates=u);const d=a(t,{active:n,context:r.current,currentCoordinates:u});if(d){const h=Qw(d,u),m={x:0,y:0},{scrollableAncestors:y}=r.current;for(const b of y){const v=t.code,{isTop:x,isRight:w,isLeft:S,isBottom:k,maxScroll:C,minScroll:T}=bie(b),R=uGe(b),N={x:Math.min(v===Vr.Right?R.right-R.width/2:R.right,Math.max(v===Vr.Right?R.left:R.left+R.width/2,d.x)),y:Math.min(v===Vr.Down?R.bottom-R.height/2:R.bottom,Math.max(v===Vr.Down?R.top:R.top+R.height/2,d.y))},I=v===Vr.Right&&!w||v===Vr.Left&&!S,P=v===Vr.Down&&!k||v===Vr.Up&&!x;if(I&&N.x!==d.x){const B=b.scrollLeft+h.x,D=v===Vr.Right&&B<=C.x||v===Vr.Left&&B>=T.x;if(D&&!h.y){b.scrollTo({left:B,behavior:o});return}D?m.x=b.scrollLeft-B:m.x=v===Vr.Right?b.scrollLeft-C.x:b.scrollLeft-T.x,m.x&&b.scrollBy({left:-m.x,behavior:o});break}else if(P&&N.y!==d.y){const B=b.scrollTop+h.y,D=v===Vr.Down&&B<=C.y||v===Vr.Up&&B>=T.y;if(D&&!h.x){b.scrollTo({top:B,behavior:o});return}D?m.y=b.scrollTop-B:m.y=v===Vr.Down?b.scrollTop-C.y:b.scrollTop-T.y,m.y&&b.scrollBy({top:-m.y,behavior:o});break}}this.handleMove(t,B0(Qw(d,this.referenceCoordinates),m))}}}handleMove(t,n){const{onMove:r}=this.props;t.preventDefault(),r(n)}handleEnd(t){const{onEnd:n}=this.props;t.preventDefault(),this.detach(),n()}handleCancel(t){const{onCancel:n}=this.props;t.preventDefault(),this.detach(),n()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}lF.activators=[{eventName:"onKeyDown",handler:(e,t,n)=>{let{keyboardCodes:r=xie,onActivation:s}=t,{active:i}=n;const{code:a}=e.nativeEvent;if(r.start.includes(a)){const o=i.activatorNode.current;return o&&e.target!==o?!1:(e.preventDefault(),s==null||s({event:e.nativeEvent}),!0)}return!1}}];function Zq(e){return!!(e&&"distance"in e)}function Xq(e){return!!(e&&"delay"in e)}class cF{constructor(t,n,r){var s;r===void 0&&(r=mGe(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=n;const{event:i}=t,{target:a}=i;this.props=t,this.events=n,this.document=xb(a),this.documentListeners=new Dx(this.document),this.listeners=new Dx(r),this.windowListeners=new Dx(Ho(a)),this.initialCoordinates=(s=F4(i))!=null?s:zc,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:n,bypassActivationConstraint:r}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(zl.Resize,this.handleCancel),this.windowListeners.add(zl.DragStart,Yq),this.windowListeners.add(zl.VisibilityChange,this.handleCancel),this.windowListeners.add(zl.ContextMenu,Yq),this.documentListeners.add(zl.Keydown,this.handleKeydown),n){if(r!=null&&r({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(Xq(n)){this.timeoutId=setTimeout(this.handleStart,n.delay),this.handlePending(n);return}if(Zq(n)){this.handlePending(n);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,n){const{active:r,onPending:s}=this.props;s(r,t,this.initialCoordinates,n)}handleStart(){const{initialCoordinates:t}=this,{onStart:n}=this.props;t&&(this.activated=!0,this.documentListeners.add(zl.Click,gGe,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(zl.SelectionChange,this.removeTextSelection),n(t))}handleMove(t){var n;const{activated:r,initialCoordinates:s,props:i}=this,{onMove:a,options:{activationConstraint:o}}=i;if(!s)return;const l=(n=F4(t))!=null?n:zc,c=Qw(s,l);if(!r&&o){if(Zq(o)){if(o.tolerance!=null&&w3(c,o.tolerance))return this.handleCancel();if(w3(c,o.distance))return this.handleStart()}if(Xq(o)&&w3(c,o.tolerance))return this.handleCancel();this.handlePending(o,c);return}t.cancelable&&t.preventDefault(),a(l)}handleEnd(){const{onAbort:t,onEnd:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleCancel(){const{onAbort:t,onCancel:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleKeydown(t){t.code===Vr.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const bGe={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class uF extends cF{constructor(t){const{event:n}=t,r=xb(n.target);super(t,bGe,r)}}uF.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return!n.isPrimary||n.button!==0?!1:(r==null||r({event:n}),!0)}}];const vGe={move:{name:"mousemove"},end:{name:"mouseup"}};var B4;(function(e){e[e.RightClick=2]="RightClick"})(B4||(B4={}));class xGe extends cF{constructor(t){super(t,vGe,xb(t.event.target))}}xGe.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return n.button===B4.RightClick?!1:(r==null||r({event:n}),!0)}}];const _3={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class wGe extends cF{constructor(t){super(t,_3)}static setup(){return window.addEventListener(_3.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(_3.move.name,t)};function t(){}}}wGe.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;const{touches:s}=n;return s.length>1?!1:(r==null||r({event:n}),!0)}}];var Fx;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(Fx||(Fx={}));var Rk;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(Rk||(Rk={}));function _Ge(e){let{acceleration:t,activator:n=Fx.Pointer,canScroll:r,draggingRect:s,enabled:i,interval:a=5,order:o=Rk.TreeOrder,pointerCoordinates:l,scrollableAncestors:c,scrollableAncestorRects:u,delta:d,threshold:h}=e;const m=CGe({delta:d,disabled:!i}),[y,b]=OHe(),v=E.useRef({x:0,y:0}),x=E.useRef({x:0,y:0}),w=E.useMemo(()=>{switch(n){case Fx.Pointer:return l?{top:l.y,bottom:l.y,left:l.x,right:l.x}:null;case Fx.DraggableRect:return s}},[n,s,l]),S=E.useRef(null),k=E.useCallback(()=>{const T=S.current;if(!T)return;const R=v.current.x*x.current.x,N=v.current.y*x.current.y;T.scrollBy(R,N)},[]),C=E.useMemo(()=>o===Rk.TreeOrder?[...c].reverse():c,[o,c]);E.useEffect(()=>{if(!i||!c.length||!w){b();return}for(const T of C){if((r==null?void 0:r(T))===!1)continue;const R=c.indexOf(T),N=u[R];if(!N)continue;const{direction:I,speed:P}=cGe(T,N,w,t,h);for(const B of["x","y"])m[B][I[B]]||(P[B]=0,I[B]=0);if(P.x>0||P.y>0){b(),S.current=T,y(k,a),v.current=P,x.current=I;return}}v.current={x:0,y:0},x.current={x:0,y:0},b()},[t,k,r,b,i,a,JSON.stringify(w),JSON.stringify(m),y,c,C,u,JSON.stringify(h)])}const SGe={x:{[ia.Backward]:!1,[ia.Forward]:!1},y:{[ia.Backward]:!1,[ia.Forward]:!1}};function CGe(e){let{delta:t,disabled:n}=e;const r=D4(t);return o_(s=>{if(n||!r||!s)return SGe;const i={x:Math.sign(t.x-r.x),y:Math.sign(t.y-r.y)};return{x:{[ia.Backward]:s.x[ia.Backward]||i.x===-1,[ia.Forward]:s.x[ia.Forward]||i.x===1},y:{[ia.Backward]:s.y[ia.Backward]||i.y===-1,[ia.Forward]:s.y[ia.Forward]||i.y===1}}},[n,t,r])}function kGe(e,t){const n=t!=null?e.get(t):void 0,r=n?n.node.current:null;return o_(s=>{var i;return t==null?null:(i=r??s)!=null?i:null},[r,t])}function EGe(e,t){return E.useMemo(()=>e.reduce((n,r)=>{const{sensor:s}=r,i=s.activators.map(a=>({eventName:a.eventName,handler:t(a.handler,r)}));return[...n,...i]},[]),[e,t])}var t1;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(t1||(t1={}));var $4;(function(e){e.Optimized="optimized"})($4||($4={}));const Jq=new Map;function TGe(e,t){let{dragging:n,dependencies:r,config:s}=t;const[i,a]=E.useState(null),{frequency:o,measure:l,strategy:c}=s,u=E.useRef(e),d=v(),h=Jw(d),m=E.useCallback(function(x){x===void 0&&(x=[]),!h.current&&a(w=>w===null?x:w.concat(x.filter(S=>!w.includes(S))))},[h]),y=E.useRef(null),b=o_(x=>{if(d&&!n)return Jq;if(!x||x===Jq||u.current!==e||i!=null){const w=new Map;for(let S of e){if(!S)continue;if(i&&i.length>0&&!i.includes(S.id)&&S.rect.current){w.set(S.id,S.rect.current);continue}const k=S.node.current,C=k?new oF(l(k),k):null;S.rect.current=C,C&&w.set(S.id,C)}return w}return x},[e,i,n,d,l]);return E.useEffect(()=>{u.current=e},[e]),E.useEffect(()=>{d||m()},[n,d]),E.useEffect(()=>{i&&i.length>0&&a(null)},[JSON.stringify(i)]),E.useEffect(()=>{d||typeof o!="number"||y.current!==null||(y.current=setTimeout(()=>{m(),y.current=null},o))},[o,d,m,...r]),{droppableRects:b,measureDroppableContainers:m,measuringScheduled:i!=null};function v(){switch(c){case t1.Always:return!1;case t1.BeforeDragging:return n;default:return!n}}}function wie(e,t){return o_(n=>e?n||(typeof t=="function"?t(e):e):null,[t,e])}function AGe(e,t){return wie(e,t)}function RGe(e){let{callback:t,disabled:n}=e;const r=iF(t),s=E.useMemo(()=>{if(n||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:i}=window;return new i(r)},[r,n]);return E.useEffect(()=>()=>s==null?void 0:s.disconnect(),[s]),s}function ZT(e){let{callback:t,disabled:n}=e;const r=iF(t),s=E.useMemo(()=>{if(n||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:i}=window;return new i(r)},[n]);return E.useEffect(()=>()=>s==null?void 0:s.disconnect(),[s]),s}function NGe(e){return new oF(wb(e),e)}function Qq(e,t,n){t===void 0&&(t=NGe);const[r,s]=E.useState(null);function i(){s(l=>{if(!e)return null;if(e.isConnected===!1){var c;return(c=l??n)!=null?c:null}const u=t(e);return JSON.stringify(l)===JSON.stringify(u)?l:u})}const a=RGe({callback(l){if(e)for(const c of l){const{type:u,target:d}=c;if(u==="childList"&&d instanceof HTMLElement&&d.contains(e)){i();break}}}}),o=ZT({callback:i});return Fu(()=>{i(),e?(o==null||o.observe(e),a==null||a.observe(document.body,{childList:!0,subtree:!0})):(o==null||o.disconnect(),a==null||a.disconnect())},[e]),r}function MGe(e){const t=wie(e);return hie(e,t)}const eV=[];function IGe(e){const t=E.useRef(e),n=o_(r=>e?r&&r!==eV&&e&&t.current&&e.parentNode===t.current.parentNode?r:YT(e):eV,[e]);return E.useEffect(()=>{t.current=e},[e]),n}function jGe(e){const[t,n]=E.useState(null),r=E.useRef(e),s=E.useCallback(i=>{const a=x3(i.target);a&&n(o=>o?(o.set(a,L4(a)),new Map(o)):null)},[]);return E.useEffect(()=>{const i=r.current;if(e!==i){a(i);const o=e.map(l=>{const c=x3(l);return c?(c.addEventListener("scroll",s,{passive:!0}),[c,L4(c)]):null}).filter(l=>l!=null);n(o.length?new Map(o):null),r.current=e}return()=>{a(e),a(i)};function a(o){o.forEach(l=>{const c=x3(l);c==null||c.removeEventListener("scroll",s)})}},[s,e]),E.useMemo(()=>e.length?t?Array.from(t.values()).reduce((i,a)=>B0(i,a),zc):vie(e):zc,[e,t])}function tV(e,t){t===void 0&&(t=[]);const n=E.useRef(null);return E.useEffect(()=>{n.current=null},t),E.useEffect(()=>{const r=e!==zc;r&&!n.current&&(n.current=e),!r&&n.current&&(n.current=null)},[e]),n.current?Qw(e,n.current):zc}function OGe(e){E.useEffect(()=>{if(!KT)return;const t=e.map(n=>{let{sensor:r}=n;return r.setup==null?void 0:r.setup()});return()=>{for(const n of t)n==null||n()}},e.map(t=>{let{sensor:n}=t;return n}))}function PGe(e,t){return E.useMemo(()=>e.reduce((n,r)=>{let{eventName:s,handler:i}=r;return n[s]=a=>{i(a,t)},n},{}),[e,t])}function _ie(e){return E.useMemo(()=>e?iGe(e):null,[e])}const nV=[];function DGe(e,t){t===void 0&&(t=wb);const[n]=e,r=_ie(n?Ho(n):null),[s,i]=E.useState(nV);function a(){i(()=>e.length?e.map(l=>yie(l)?r:new oF(t(l),l)):nV)}const o=ZT({callback:a});return Fu(()=>{o==null||o.disconnect(),a(),e.forEach(l=>o==null?void 0:o.observe(l))},[e]),s}function FGe(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return a_(t)?t:e}function LGe(e){let{measure:t}=e;const[n,r]=E.useState(null),s=E.useCallback(c=>{for(const{target:u}of c)if(a_(u)){r(d=>{const h=t(u);return d?{...d,width:h.width,height:h.height}:h});break}},[t]),i=ZT({callback:s}),a=E.useCallback(c=>{const u=FGe(c);i==null||i.disconnect(),u&&(i==null||i.observe(u)),r(u?t(u):null)},[t,i]),[o,l]=Tk(a);return E.useMemo(()=>({nodeRef:o,rect:n,setRef:l}),[n,o,l])}const BGe=[{sensor:uF,options:{}},{sensor:lF,options:{}}],$Ge={current:{}},U2={draggable:{measure:Kq},droppable:{measure:Kq,strategy:t1.WhileDragging,frequency:$4.Optimized},dragOverlay:{measure:wb}};class Lx extends Map{get(t){var n;return t!=null&&(n=super.get(t))!=null?n:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:n}=t;return!n})}getNodeFor(t){var n,r;return(n=(r=this.get(t))==null?void 0:r.node.current)!=null?n:void 0}}const zGe={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new Lx,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:Ak},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:U2,measureDroppableContainers:Ak,windowRect:null,measuringScheduled:!1},UGe={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:Ak,draggableNodes:new Map,over:null,measureDroppableContainers:Ak},XT=E.createContext(UGe),Sie=E.createContext(zGe);function qGe(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new Lx}}}function VGe(e,t){switch(t.type){case zi.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case zi.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case zi.DragEnd:case zi.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case zi.RegisterDroppable:{const{element:n}=t,{id:r}=n,s=new Lx(e.droppable.containers);return s.set(r,n),{...e,droppable:{...e.droppable,containers:s}}}case zi.SetDroppableDisabled:{const{id:n,key:r,disabled:s}=t,i=e.droppable.containers.get(n);if(!i||r!==i.key)return e;const a=new Lx(e.droppable.containers);return a.set(n,{...i,disabled:s}),{...e,droppable:{...e.droppable,containers:a}}}case zi.UnregisterDroppable:{const{id:n,key:r}=t,s=e.droppable.containers.get(n);if(!s||r!==s.key)return e;const i=new Lx(e.droppable.containers);return i.delete(n),{...e,droppable:{...e.droppable,containers:i}}}default:return e}}function WGe(e){let{disabled:t}=e;const{active:n,activatorEvent:r,draggableNodes:s}=E.useContext(XT),i=D4(r),a=D4(n==null?void 0:n.id);return E.useEffect(()=>{if(!t&&!r&&i&&a!=null){if(!aF(i)||document.activeElement===i.target)return;const o=s.get(a);if(!o)return;const{activatorNode:l,node:c}=o;if(!l.current&&!c.current)return;requestAnimationFrame(()=>{for(const u of[l.current,c.current]){if(!u)continue;const d=FHe(u);if(d){d.focus();break}}})}},[r,t,s,a,i]),null}function HGe(e,t){let{transform:n,...r}=t;return e!=null&&e.length?e.reduce((s,i)=>i({transform:s,...r}),n):n}function GGe(e){return E.useMemo(()=>({draggable:{...U2.draggable,...e==null?void 0:e.draggable},droppable:{...U2.droppable,...e==null?void 0:e.droppable},dragOverlay:{...U2.dragOverlay,...e==null?void 0:e.dragOverlay}}),[e==null?void 0:e.draggable,e==null?void 0:e.droppable,e==null?void 0:e.dragOverlay])}function KGe(e){let{activeNode:t,measure:n,initialRect:r,config:s=!0}=e;const i=E.useRef(!1),{x:a,y:o}=typeof s=="boolean"?{x:s,y:s}:s;Fu(()=>{if(!a&&!o||!t){i.current=!1;return}if(i.current||!r)return;const c=t==null?void 0:t.node.current;if(!c||c.isConnected===!1)return;const u=n(c),d=hie(u,r);if(a||(d.x=0),o||(d.y=0),i.current=!0,Math.abs(d.x)>0||Math.abs(d.y)>0){const h=pie(c);h&&h.scrollBy({top:d.y,left:d.x})}},[t,a,o,r,n])}const Cie=E.createContext({...zc,scaleX:1,scaleY:1});var oh;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(oh||(oh={}));const YGe=E.memo(function(t){var n,r,s,i;let{id:a,accessibility:o,autoScroll:l=!0,children:c,sensors:u=BGe,collisionDetection:d=JHe,measuring:h,modifiers:m,...y}=t;const b=E.useReducer(VGe,void 0,qGe),[v,x]=b,[w,S]=qHe(),[k,C]=E.useState(oh.Uninitialized),T=k===oh.Initialized,{draggable:{active:R,nodes:N,translate:I},droppable:{containers:P}}=v,B=R!=null?N.get(R):null,D=E.useRef({initial:null,translated:null}),W=E.useMemo(()=>{var tt;return R!=null?{id:R,data:(tt=B==null?void 0:B.data)!=null?tt:$Ge,rect:D}:null},[R,B]),O=E.useRef(null),[Z,U]=E.useState(null),[H,L]=E.useState(null),te=Jw(y,Object.values(y)),V=l_("DndDescribedBy",a),Q=E.useMemo(()=>P.getEnabled(),[P]),ee=GGe(h),{droppableRects:se,measureDroppableContainers:pe,measuringScheduled:ue}=TGe(Q,{dragging:T,dependencies:[I.x,I.y],config:ee.droppable}),Oe=kGe(N,R),Fe=E.useMemo(()=>H?F4(H):null,[H]),Se=Ue(),Ce=AGe(Oe,ee.draggable.measure);KGe({activeNode:R!=null?N.get(R):null,config:Se.layoutShiftCompensation,initialRect:Ce,measure:ee.draggable.measure});const qe=Qq(Oe,ee.draggable.measure,Ce),Qe=Qq(Oe?Oe.parentElement:null),We=E.useRef({activatorEvent:null,active:null,activeNode:Oe,collisionRect:null,collisions:null,droppableRects:se,draggableNodes:N,draggingNode:null,draggingNodeRect:null,droppableContainers:P,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),Ie=P.getNodeFor((n=We.current.over)==null?void 0:n.id),K=LGe({measure:ee.dragOverlay.measure}),ye=(r=K.nodeRef.current)!=null?r:Oe,Ne=T?(s=K.rect)!=null?s:qe:null,ce=!!(K.nodeRef.current&&K.rect),oe=MGe(ce?null:qe),re=_ie(ye?Ho(ye):null),Re=IGe(T?Ie??Oe:null),Be=DGe(Re),Te=HGe(m,{transform:{x:I.x-oe.x,y:I.y-oe.y,scaleX:1,scaleY:1},activatorEvent:H,active:W,activeNodeRect:qe,containerNodeRect:Qe,draggingNodeRect:Ne,over:We.current.over,overlayNodeRect:K.rect,scrollableAncestors:Re,scrollableAncestorRects:Be,windowRect:re}),lt=Fe?B0(Fe,I):null,Tt=jGe(Re),ut=tV(Tt),jt=tV(Tt,[qe]),qt=B0(Te,ut),Ft=Ne?tGe(Ne,Te):null,Ht=W&&Ft?d({active:W,collisionRect:Ft,droppableRects:se,droppableContainers:Q,pointerCoordinates:lt}):null,we=fie(Ht,"id"),[F,X]=E.useState(null),be=ce?Te:B0(Te,jt),ke=QHe(be,(i=F==null?void 0:F.rect)!=null?i:null,qe),ge=E.useRef(null),Ee=E.useCallback((tt,ve)=>{let{sensor:_e,options:$e}=ve;if(O.current==null)return;const Ct=N.get(O.current);if(!Ct)return;const fe=tt.nativeEvent,Y=new _e({active:O.current,activeNode:Ct,event:fe,options:$e,context:We,onAbort(J){if(!N.get(J))return;const{onDragAbort:De}=te.current,He={id:J};De==null||De(He),w({type:"onDragAbort",event:He})},onPending(J,xe,De,He){if(!N.get(J))return;const{onDragPending:Qt}=te.current,On={id:J,constraint:xe,initialCoordinates:De,offset:He};Qt==null||Qt(On),w({type:"onDragPending",event:On})},onStart(J){const xe=O.current;if(xe==null)return;const De=N.get(xe);if(!De)return;const{onDragStart:He}=te.current,xt={activatorEvent:fe,active:{id:xe,data:De.data,rect:D}};cl.unstable_batchedUpdates(()=>{He==null||He(xt),C(oh.Initializing),x({type:zi.DragStart,initialCoordinates:J,active:xe}),w({type:"onDragStart",event:xt}),U(ge.current),L(fe)})},onMove(J){x({type:zi.DragMove,coordinates:J})},onEnd:G(zi.DragEnd),onCancel:G(zi.DragCancel)});ge.current=Y;function G(J){return async function(){const{active:De,collisions:He,over:xt,scrollAdjustedTranslate:Qt}=We.current;let On=null;if(De&&Qt){const{cancelDrop:Zt}=te.current;On={activatorEvent:fe,active:De,collisions:He,delta:Qt,over:xt},J===zi.DragEnd&&typeof Zt=="function"&&await Promise.resolve(Zt(On))&&(J=zi.DragCancel)}O.current=null,cl.unstable_batchedUpdates(()=>{x({type:J}),C(oh.Uninitialized),X(null),U(null),L(null),ge.current=null;const Zt=J===zi.DragEnd?"onDragEnd":"onDragCancel";if(On){const nn=te.current[Zt];nn==null||nn(On),w({type:Zt,event:On})}})}}},[N]),le=E.useCallback((tt,ve)=>(_e,$e)=>{const Ct=_e.nativeEvent,fe=N.get($e);if(O.current!==null||!fe||Ct.dndKit||Ct.defaultPrevented)return;const Y={active:fe};tt(_e,ve.options,Y)===!0&&(Ct.dndKit={capturedBy:ve.sensor},O.current=$e,Ee(_e,ve))},[N,Ee]),dt=EGe(u,le);OGe(u),Fu(()=>{qe&&k===oh.Initializing&&C(oh.Initialized)},[qe,k]),E.useEffect(()=>{const{onDragMove:tt}=te.current,{active:ve,activatorEvent:_e,collisions:$e,over:Ct}=We.current;if(!ve||!_e)return;const fe={active:ve,activatorEvent:_e,collisions:$e,delta:{x:qt.x,y:qt.y},over:Ct};cl.unstable_batchedUpdates(()=>{tt==null||tt(fe),w({type:"onDragMove",event:fe})})},[qt.x,qt.y]),E.useEffect(()=>{const{active:tt,activatorEvent:ve,collisions:_e,droppableContainers:$e,scrollAdjustedTranslate:Ct}=We.current;if(!tt||O.current==null||!ve||!Ct)return;const{onDragOver:fe}=te.current,Y=$e.get(we),G=Y&&Y.rect.current?{id:Y.id,rect:Y.rect.current,data:Y.data,disabled:Y.disabled}:null,J={active:tt,activatorEvent:ve,collisions:_e,delta:{x:Ct.x,y:Ct.y},over:G};cl.unstable_batchedUpdates(()=>{X(G),fe==null||fe(J),w({type:"onDragOver",event:J})})},[we]),Fu(()=>{We.current={activatorEvent:H,active:W,activeNode:Oe,collisionRect:Ft,collisions:Ht,droppableRects:se,draggableNodes:N,draggingNode:ye,draggingNodeRect:Ne,droppableContainers:P,over:F,scrollableAncestors:Re,scrollAdjustedTranslate:qt},D.current={initial:Ne,translated:Ft}},[W,Oe,Ht,Ft,N,ye,Ne,se,P,F,Re,qt]),_Ge({...Se,delta:I,draggingRect:Ft,pointerCoordinates:lt,scrollableAncestors:Re,scrollableAncestorRects:Be});const et=E.useMemo(()=>({active:W,activeNode:Oe,activeNodeRect:qe,activatorEvent:H,collisions:Ht,containerNodeRect:Qe,dragOverlay:K,draggableNodes:N,droppableContainers:P,droppableRects:se,over:F,measureDroppableContainers:pe,scrollableAncestors:Re,scrollableAncestorRects:Be,measuringConfiguration:ee,measuringScheduled:ue,windowRect:re}),[W,Oe,qe,H,Ht,Qe,K,N,P,se,F,pe,Re,Be,ee,ue,re]),$=E.useMemo(()=>({activatorEvent:H,activators:dt,active:W,activeNodeRect:qe,ariaDescribedById:{draggable:V},dispatch:x,draggableNodes:N,over:F,measureDroppableContainers:pe}),[H,dt,W,qe,x,V,N,F,pe]);return Ve.createElement(cie.Provider,{value:S},Ve.createElement(XT.Provider,{value:$},Ve.createElement(Sie.Provider,{value:et},Ve.createElement(Cie.Provider,{value:ke},c)),Ve.createElement(WGe,{disabled:(o==null?void 0:o.restoreFocus)===!1})),Ve.createElement(HHe,{...o,hiddenTextDescribedById:V}));function Ue(){const tt=(Z==null?void 0:Z.autoScrollEnabled)===!1,ve=typeof l=="object"?l.enabled===!1:l===!1,_e=T&&!tt&&!ve;return typeof l=="object"?{...l,enabled:_e}:{enabled:_e}}}),ZGe=E.createContext(null),rV="button",XGe="Draggable";function JGe(e){let{id:t,data:n,disabled:r=!1,attributes:s}=e;const i=l_(XGe),{activators:a,activatorEvent:o,active:l,activeNodeRect:c,ariaDescribedById:u,draggableNodes:d,over:h}=E.useContext(XT),{role:m=rV,roleDescription:y="draggable",tabIndex:b=0}=s??{},v=(l==null?void 0:l.id)===t,x=E.useContext(v?Cie:ZGe),[w,S]=Tk(),[k,C]=Tk(),T=PGe(a,t),R=Jw(n);Fu(()=>(d.set(t,{id:t,key:i,node:w,activatorNode:k,data:R}),()=>{const I=d.get(t);I&&I.key===i&&d.delete(t)}),[d,t]);const N=E.useMemo(()=>({role:m,tabIndex:b,"aria-disabled":r,"aria-pressed":v&&m===rV?!0:void 0,"aria-roledescription":y,"aria-describedby":u.draggable}),[r,m,b,v,y,u.draggable]);return{active:l,activatorEvent:o,activeNodeRect:c,attributes:N,isDragging:v,listeners:r?void 0:T,node:w,over:h,setNodeRef:S,setActivatorNodeRef:C,transform:x}}function QGe(){return E.useContext(Sie)}const eKe="Droppable",tKe={timeout:25};function nKe(e){let{data:t,disabled:n=!1,id:r,resizeObserverConfig:s}=e;const i=l_(eKe),{active:a,dispatch:o,over:l,measureDroppableContainers:c}=E.useContext(XT),u=E.useRef({disabled:n}),d=E.useRef(!1),h=E.useRef(null),m=E.useRef(null),{disabled:y,updateMeasurementsFor:b,timeout:v}={...tKe,...s},x=Jw(b??r),w=E.useCallback(()=>{if(!d.current){d.current=!0;return}m.current!=null&&clearTimeout(m.current),m.current=setTimeout(()=>{c(Array.isArray(x.current)?x.current:[x.current]),m.current=null},v)},[v]),S=ZT({callback:w,disabled:y||!a}),k=E.useCallback((N,I)=>{S&&(I&&(S.unobserve(I),d.current=!1),N&&S.observe(N))},[S]),[C,T]=Tk(k),R=Jw(t);return E.useEffect(()=>{!S||!C.current||(S.disconnect(),d.current=!1,S.observe(C.current))},[C,S]),E.useEffect(()=>(o({type:zi.RegisterDroppable,element:{id:r,key:i,disabled:n,node:C,rect:h,data:R}}),()=>o({type:zi.UnregisterDroppable,key:i,id:r})),[r]),E.useEffect(()=>{n!==u.current.disabled&&(o({type:zi.SetDroppableDisabled,id:r,key:i,disabled:n}),u.current.disabled=n)},[r,i,n,o]),{active:a,rect:h,isOver:(l==null?void 0:l.id)===r,node:C,over:l,setNodeRef:T}}function Bx(e,t,n){const r=e.slice();return r.splice(n<0?r.length+n:n,0,r.splice(t,1)[0]),r}function rKe(e,t){return e.reduce((n,r,s)=>{const i=t.get(r);return i&&(n[s]=i),n},Array(e.length))}function h2(e){return e!==null&&e>=0}function sKe(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function iKe(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const kie=e=>{let{rects:t,activeIndex:n,overIndex:r,index:s}=e;const i=Bx(t,r,n),a=t[s],o=i[s];return!o||!a?null:{x:o.left-a.left,y:o.top-a.top,scaleX:o.width/a.width,scaleY:o.height/a.height}},p2={scaleX:1,scaleY:1},aKe=e=>{var t;let{activeIndex:n,activeNodeRect:r,index:s,rects:i,overIndex:a}=e;const o=(t=i[n])!=null?t:r;if(!o)return null;if(s===n){const c=i[a];return c?{x:0,y:n<a?c.top+c.height-(o.top+o.height):c.top-o.top,...p2}:null}const l=oKe(i,s,n);return s>n&&s<=a?{x:0,y:-o.height-l,...p2}:s<n&&s>=a?{x:0,y:o.height+l,...p2}:{x:0,y:0,...p2}};function oKe(e,t,n){const r=e[t],s=e[t-1],i=e[t+1];return r?n<t?s?r.top-(s.top+s.height):i?i.top-(r.top+r.height):0:i?i.top-(r.top+r.height):s?r.top-(s.top+s.height):0:0}const Eie="Sortable",Tie=Ve.createContext({activeIndex:-1,containerId:Eie,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:kie,disabled:{draggable:!1,droppable:!1}});function lKe(e){let{children:t,id:n,items:r,strategy:s=kie,disabled:i=!1}=e;const{active:a,dragOverlay:o,droppableRects:l,over:c,measureDroppableContainers:u}=QGe(),d=l_(Eie,n),h=o.rect!==null,m=E.useMemo(()=>r.map(T=>typeof T=="object"&&"id"in T?T.id:T),[r]),y=a!=null,b=a?m.indexOf(a.id):-1,v=c?m.indexOf(c.id):-1,x=E.useRef(m),w=!sKe(m,x.current),S=v!==-1&&b===-1||w,k=iKe(i);Fu(()=>{w&&y&&u(m)},[w,m,y,u]),E.useEffect(()=>{x.current=m},[m]);const C=E.useMemo(()=>({activeIndex:b,containerId:d,disabled:k,disableTransforms:S,items:m,overIndex:v,useDragOverlay:h,sortedRects:rKe(m,l),strategy:s}),[b,d,k.draggable,k.droppable,S,m,v,l,h,s]);return Ve.createElement(Tie.Provider,{value:C},t)}const cKe=e=>{let{id:t,items:n,activeIndex:r,overIndex:s}=e;return Bx(n,r,s).indexOf(t)},uKe=e=>{let{containerId:t,isSorting:n,wasDragging:r,index:s,items:i,newIndex:a,previousItems:o,previousContainerId:l,transition:c}=e;return!c||!r||o!==i&&s===a?!1:n?!0:a!==s&&t===l},dKe={duration:200,easing:"ease"},Aie="transform",fKe=e1.Transition.toString({property:Aie,duration:0,easing:"linear"}),hKe={roleDescription:"sortable"};function pKe(e){let{disabled:t,index:n,node:r,rect:s}=e;const[i,a]=E.useState(null),o=E.useRef(n);return Fu(()=>{if(!t&&n!==o.current&&r.current){const l=s.current;if(l){const c=wb(r.current,{ignoreTransform:!0}),u={x:l.left-c.left,y:l.top-c.top,scaleX:l.width/c.width,scaleY:l.height/c.height};(u.x||u.y)&&a(u)}}n!==o.current&&(o.current=n)},[t,n,r,s]),E.useEffect(()=>{i&&a(null)},[i]),i}function mKe(e){let{animateLayoutChanges:t=uKe,attributes:n,disabled:r,data:s,getNewIndex:i=cKe,id:a,strategy:o,resizeObserverConfig:l,transition:c=dKe}=e;const{items:u,containerId:d,activeIndex:h,disabled:m,disableTransforms:y,sortedRects:b,overIndex:v,useDragOverlay:x,strategy:w}=E.useContext(Tie),S=gKe(r,m),k=u.indexOf(a),C=E.useMemo(()=>({sortable:{containerId:d,index:k,items:u},...s}),[d,s,k,u]),T=E.useMemo(()=>u.slice(u.indexOf(a)),[u,a]),{rect:R,node:N,isOver:I,setNodeRef:P}=nKe({id:a,data:C,disabled:S.droppable,resizeObserverConfig:{updateMeasurementsFor:T,...l}}),{active:B,activatorEvent:D,activeNodeRect:W,attributes:O,setNodeRef:Z,listeners:U,isDragging:H,over:L,setActivatorNodeRef:te,transform:V}=JGe({id:a,data:C,attributes:{...hKe,...n},disabled:S.draggable}),Q=jHe(P,Z),ee=!!B,se=ee&&!y&&h2(h)&&h2(v),pe=!x&&H,ue=pe&&se?V:null,Fe=se?ue??(o??w)({rects:b,activeNodeRect:W,activeIndex:h,overIndex:v,index:k}):null,Se=h2(h)&&h2(v)?i({id:a,items:u,activeIndex:h,overIndex:v}):k,Ce=B==null?void 0:B.id,qe=E.useRef({activeId:Ce,items:u,newIndex:Se,containerId:d}),Qe=u!==qe.current.items,We=t({active:B,containerId:d,isDragging:H,isSorting:ee,id:a,index:k,items:u,newIndex:qe.current.newIndex,previousItems:qe.current.items,previousContainerId:qe.current.containerId,transition:c,wasDragging:qe.current.activeId!=null}),Ie=pKe({disabled:!We,index:k,node:N,rect:R});return E.useEffect(()=>{ee&&qe.current.newIndex!==Se&&(qe.current.newIndex=Se),d!==qe.current.containerId&&(qe.current.containerId=d),u!==qe.current.items&&(qe.current.items=u)},[ee,Se,d,u]),E.useEffect(()=>{if(Ce===qe.current.activeId)return;if(Ce!=null&&qe.current.activeId==null){qe.current.activeId=Ce;return}const ye=setTimeout(()=>{qe.current.activeId=Ce},50);return()=>clearTimeout(ye)},[Ce]),{active:B,activeIndex:h,attributes:O,data:C,rect:R,index:k,newIndex:Se,items:u,isOver:I,isSorting:ee,isDragging:H,listeners:U,node:N,overIndex:v,over:L,setNodeRef:Q,setActivatorNodeRef:te,setDroppableNodeRef:P,setDraggableNodeRef:Z,transform:Ie??Fe,transition:K()};function K(){if(Ie||Qe&&qe.current.newIndex===k)return fKe;if(!(pe&&!aF(D)||!c)&&(ee||We))return e1.Transition.toString({...c,property:Aie})}}function gKe(e,t){var n,r;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(n=e==null?void 0:e.draggable)!=null?n:t.draggable,droppable:(r=e==null?void 0:e.droppable)!=null?r:t.droppable}}function Nk(e){if(!e)return!1;const t=e.data.current;return!!(t&&"sortable"in t&&typeof t.sortable=="object"&&"containerId"in t.sortable&&"items"in t.sortable&&"index"in t.sortable)}const yKe=[Vr.Down,Vr.Right,Vr.Up,Vr.Left],bKe=(e,t)=>{let{context:{active:n,collisionRect:r,droppableRects:s,droppableContainers:i,over:a,scrollableAncestors:o}}=t;if(yKe.includes(e.code)){if(e.preventDefault(),!n||!r)return;const l=[];i.getEnabled().forEach(d=>{if(!d||d!=null&&d.disabled)return;const h=s.get(d.id);if(h)switch(e.code){case Vr.Down:r.top<h.top&&l.push(d);break;case Vr.Up:r.top>h.top&&l.push(d);break;case Vr.Left:r.left>h.left&&l.push(d);break;case Vr.Right:r.left<h.left&&l.push(d);break}});const c=ZHe({collisionRect:r,droppableRects:s,droppableContainers:l});let u=fie(c,"id");if(u===(a==null?void 0:a.id)&&c.length>1&&(u=c[1].id),u!=null){const d=i.get(n.id),h=i.get(u),m=h?s.get(h.id):null,y=h==null?void 0:h.node.current;if(y&&m&&d&&h){const v=YT(y).some((T,R)=>o[R]!==T),x=Rie(d,h),w=vKe(d,h),S=v||!x?{x:0,y:0}:{x:w?r.width-m.width:0,y:w?r.height-m.height:0},k={x:m.left,y:m.top};return S.x&&S.y?k:Qw(k,S)}}}};function Rie(e,t){return!Nk(e)||!Nk(t)?!1:e.data.current.sortable.containerId===t.data.current.sortable.containerId}function vKe(e,t){return!Nk(e)||!Nk(t)||!Rie(e,t)?!1:e.data.current.sortable.index<t.data.current.sortable.index}const xKe=({id:e,modelDetails:t,buttonsDisabled:n,onMoveToTop:r,onMoveUp:s,onMoveDown:i,isFirst:a,isLast:o})=>{var C,T,R;const{attributes:l,listeners:c,setNodeRef:u,transform:d,transition:h,isDragging:m}=mKe({id:e,disabled:!1}),y={transform:e1.Transform.toString(d),transition:h,zIndex:m?10:void 0},b=new Set(((C=t.metadataSummary)==null?void 0:C.supported_parameters)??[]),v=new Set(((T=t.metadataSummary)==null?void 0:T.input_modalities)??[]),x=b.has("reasoning"),w=b.has("web_search")||b.has("web_search_options"),S=b.has("tools"),k=Array.from(v).some(N=>N!=="text");return f.jsxs("div",{ref:u,style:y,className:Xe("flex items-center space-x-2 p-2 rounded border border-transparent bg-muted/50 hover:bg-muted mb-1",m&&"shadow-lg border-primary bg-card","cursor-grab active:cursor-grabbing"),"aria-label":`Drag to reorder model ${t.name}`,children:[f.jsx("button",{...l,...c,type:"button",className:Xe("p-1 flex-shrink-0","hover:text-foreground"),"aria-hidden":"true",tabIndex:-1,children:f.jsx(Fme,{className:"h-5 w-5 text-muted-foreground"})}),f.jsxs("div",{className:"flex-grow min-w-0",children:[f.jsxs(Ot,{className:Xe("text-sm font-normal text-foreground flex-grow truncate pointer-events-none"),children:[t.name," ",f.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",t.providerName,")"]})]}),f.jsxs("div",{className:"flex items-center gap-1 mt-0.5",children:[x&&f.jsx(Uy,{className:"h-3 w-3 text-blue-500"}),w&&f.jsx(Do,{className:"h-3 w-3 text-green-500"}),S&&f.jsx(Gx,{className:"h-3 w-3 text-orange-500"}),k&&f.jsx(J0,{className:"h-3 w-3 text-purple-500"})]})]}),f.jsxs("div",{className:"flex items-center gap-0.5 ml-auto flex-shrink-0",children:[((R=t.metadataSummary)==null?void 0:R.description)&&f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx("span",{className:"p-1 text-muted-foreground hover:text-foreground cursor-default","aria-label":"Model information",children:f.jsx(VO,{className:"h-4 w-4"})})}),f.jsx(Sr,{side:"top",align:"end",className:"max-w-xs break-words",children:f.jsx("p",{children:t.metadataSummary.description})})]})}),f.jsx(Un,{tooltipText:"Move to Top",onClick:()=>r(e),disabled:a||n,icon:f.jsx(Ppe,{}),className:"h-6 w-6"}),f.jsx(Un,{tooltipText:"Move Up",onClick:()=>s(e),disabled:a||n,icon:f.jsx(ype,{}),className:"h-6 w-6"}),f.jsx(Un,{tooltipText:"Move Down",onClick:()=>i(e),disabled:o||n,icon:f.jsx(yH,{}),className:"h-6 w-6"})]})]})},wKe=({setGlobalModelSortOrderFromModule:e})=>{const{dbProviderConfigs:t,globalModelSortOrder:n,isLoading:r,getAvailableModelListItems:s}=Cr(yn(S=>({dbProviderConfigs:S.dbProviderConfigs,globalModelSortOrder:S.globalModelSortOrder,isLoading:S.isLoading,getAvailableModelListItems:S.getAvailableModelListItems}))),[i,a]=E.useState(""),[o,l]=E.useState(()=>new Set(t.map(S=>S.id))),[c,u]=E.useState({reasoning:!1,webSearch:!1,tools:!1,multimodal:!1});E.useEffect(()=>{l(new Set(t.map(S=>S.id)))},[t]);const d=E.useMemo(()=>{const S=s(),k=new Map(S.map(I=>[I.id,I])),C=new Set;t.forEach(I=>{I.isEnabled&&I.enabledModels&&I.enabledModels.forEach(P=>{C.add(kx(I.id,P))})});const T=S.filter(I=>C.has(I.id)),R=[],N=new Set;return n.forEach(I=>{if(C.has(I)){const P=k.get(I);P&&!N.has(I)&&(R.push(P),N.add(I))}}),T.forEach(I=>{N.has(I.id)||R.push(I)}),R},[t,n,s]),h=E.useMemo(()=>{let S=d;if(o.size!==t.length&&(S=S.filter(C=>o.has(C.providerId))),i.trim()){const C=i.toLowerCase();S=S.filter(T=>T.name.toLowerCase().includes(C)||T.providerName.toLowerCase().includes(C)||T.id.toLowerCase().includes(C))}const k=Object.entries(c).filter(([,C])=>C).map(([C])=>C);return k.length>0&&(S=S.filter(C=>{var N,I;const T=new Set(((N=C.metadataSummary)==null?void 0:N.supported_parameters)??[]),R=new Set(((I=C.metadataSummary)==null?void 0:I.input_modalities)??[]);return k.every(P=>{switch(P){case"reasoning":return T.has("reasoning");case"webSearch":return T.has("web_search")||T.has("web_search_options");case"tools":return T.has("tools");case"multimodal":return Array.from(R).some(B=>B!=="text");default:return!0}})})),S},[d,i,o,t.length,c]),m=E.useMemo(()=>i.trim().length>0||o.size!==t.length||Object.values(c).some(Boolean),[i,o,t.length,c]),y=E.useMemo(()=>{const S=o.size!==t.length?1:0,k=Object.values(c).filter(Boolean).length;return S+k},[o,t.length,c]),b=E.useMemo(()=>h.map(S=>S.id),[h]),v=E.useCallback(S=>{const{active:k,over:C}=S;if(C&&k.id!==C.id){const T=d.map(B=>B.id),R=k.id,N=C.id,I=T.indexOf(R),P=T.indexOf(N);if(I!==-1&&P!==-1){const B=Bx(T,I,P);e(B)}else console.warn("DND: Could not find dragged items in the full model order. This might happen if the underlying list changed during drag or items are filtered out.")}},[d,e]),x=E.useCallback((S,k)=>{if(m)return;const C=d.map(N=>N.id),T=C.indexOf(S);if(T===-1)return;let R;if(k==="top"){if(T===0)return;const N=C.splice(T,1)[0];C.unshift(N),R=C}else if(k==="up"){if(T===0)return;R=Bx(C,T,T-1)}else{if(T===C.length-1)return;R=Bx(C,T,T+1)}e(R)},[d,e,m]),w=GHe(Wq(uF),Wq(lF,{coordinateGetter:bKe}));return r?f.jsxs("div",{className:"space-y-4 border border-border rounded-lg p-4 bg-card shadow-sm",children:[f.jsx(Wr,{className:"h-8 w-1/3"}),f.jsx(Wr,{className:"h-6 w-1/2"}),f.jsx(Wr,{className:"h-64 w-full"})]}):f.jsxs("div",{className:"space-y-4 border border-border rounded-lg p-4 bg-card shadow-sm",children:[f.jsx("h3",{className:"text-lg font-semibold text-card-foreground",children:"Global Model Order"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Drag and drop the globally enabled models to define their display order. Filtering affects the view below. Move buttons (up/down/top) are disabled when filters are active."}),f.jsx(jm,{}),f.jsxs("div",{className:"space-y-3",children:[f.jsx(Ot,{className:"text-base font-medium text-card-foreground",children:"Enabled & Ordered Models"}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsxs("div",{className:"relative flex-grow",children:[f.jsx(Do,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),f.jsx(Cn,{type:"search",placeholder:"Filter models by name or provider...",value:i,onChange:S=>a(S.target.value),className:"pl-8 w-full h-9",disabled:r})]}),f.jsx(P6,{currentCapabilityFilters:c,onCapabilityFilterChange:u,currentSelectedProviders:o,onProviderFilterChange:l,allProviders:t,showProviderFilter:!0,showCapabilityFilters:!0,disabled:r||t.length===0,totalActiveFilters:y})]}),f.jsx("div",{className:"w-full rounded-md border border-border p-3 bg-background/50",children:h.length>0?f.jsx(YGe,{sensors:w,collisionDetection:YHe,onDragEnd:v,children:f.jsx(lKe,{items:b,strategy:aKe,children:h.map(S=>f.jsx(xKe,{id:S.id,modelDetails:S,onMoveToTop:()=>x(S.id,"top"),onMoveUp:()=>x(S.id,"up"),onMoveDown:()=>x(S.id,"down"),isFirst:d.findIndex(k=>k.id===S.id)===0,isLast:d.findIndex(k=>k.id===S.id)===d.length-1,buttonsDisabled:m},S.id))})}):f.jsx("div",{className:"flex items-center justify-center h-full text-sm text-muted-foreground",children:m?"No models match your filters.":"No models enabled globally. Enable models within provider configurations."})})]})]})},m2=e=>{if(!e)return"N/A";const t=parseFloat(e);return isNaN(t)?"N/A":`$${(t/1e3).toFixed(4)} / 1K tokens`},Pl=(e,t,n=!1,r="secondary")=>t==null||String(t).trim()===""?null:f.jsxs(Ts,{children:[f.jsx(Fn,{className:"font-medium text-xs w-1/3 py-1.5 px-3",children:e}),f.jsx(Fn,{className:"text-xs py-1.5 px-3 break-all",children:n?f.jsx(is,{variant:r,className:"text-xs",children:String(t)}):Array.isArray(t)?f.jsx("div",{className:"flex flex-wrap gap-1",children:t.map((s,i)=>f.jsx(is,{variant:"outline",className:"text-xs",children:String(s)},i))}):String(t)})]}),_Ke=({modelId:e})=>{var m,y,b,v,x,w,S,k,C,T,R,N;const{createAiModelConfig:t,dbProviderConfigs:n,dbApiKeys:r,updateProviderConfig:s,isLoading:i}=Cr(yn(I=>({createAiModelConfig:I.createAiModelConfig,dbProviderConfigs:I.dbProviderConfigs,dbApiKeys:I.dbApiKeys,updateProviderConfig:I.updateProviderConfig,isLoading:I.isLoading}))),a=E.useMemo(()=>{if(!e)return;const{providerId:I,modelId:P}=Tc(e);if(!I||!P)return;const B=n.find(W=>W.id===I);if(!B)return;const D=r.find(W=>W.id===B.apiKeyId);return t(B,P,D==null?void 0:D.value)},[e,n,r,t]),o=a==null?void 0:a.metadata,l=E.useCallback(async()=>{if(!a||!e)return;const{providerId:I,modelId:P}=Tc(e);if(!I||!P)return;const B=n.find(Z=>Z.id===I);if(!B){Me.error("Provider configuration not found.");return}const D=new Set(B.enabledModels??[]),W=D.has(P);W?D.delete(P):D.add(P);const O=Array.from(D);try{await s(B.id,{enabledModels:O}),Me.success(`Model "${a.name}" ${W?"disabled":"enabled"}.`)}catch{Me.error("Failed to update model status.")}},[a,e,n,s]);if(i)return f.jsxs("div",{className:"space-y-4 p-1 h-full flex flex-col",children:[f.jsx(Wr,{className:"h-8 w-3/4 flex-shrink-0"}),f.jsx(Wr,{className:"h-4 w-1/2 flex-shrink-0"}),f.jsxs("div",{className:"flex-grow space-y-2",children:[f.jsx(Wr,{className:"h-10 w-full"}),f.jsx(Wr,{className:"h-10 w-full"}),f.jsx(Wr,{className:"h-10 w-full"}),f.jsx(Wr,{className:"h-10 w-full"})]})]});if(!e)return f.jsxs("div",{className:"p-4 text-center text-muted-foreground h-full flex flex-col items-center justify-center",children:[f.jsx(Kl,{className:"mx-auto h-10 w-10 mb-2 text-amber-500"}),f.jsx("p",{className:"text-sm",children:'No model selected. Click a model in the "Configuration" or "Browse Models" tab to view its details.'})]});if(!a||!o)return f.jsxs("div",{className:"p-4 text-center text-destructive h-full flex flex-col items-center justify-center",children:[f.jsx(Kl,{className:"mx-auto h-10 w-10 mb-2"}),f.jsxs("p",{className:"text-sm",children:["Details not available for model: ",e,". It might be misconfigured or no longer available."]})]});const{providerId:c,modelId:u}=Tc(e),d=n.find(I=>I.id===c),h=u!=null&&(d==null?void 0:d.isEnabled)&&((m=d==null?void 0:d.enabledModels)==null?void 0:m.includes(u))===!0;return f.jsxs("div",{className:"space-y-4 p-1 h-full flex flex-col",children:[f.jsxs("div",{className:"flex items-center justify-between flex-shrink-0",children:[f.jsxs("h4",{className:"text-lg font-semibold text-card-foreground truncate",children:[a.name,f.jsxs("span",{className:"text-sm text-muted-foreground ml-2",children:["(",a.providerName,")"]})]}),f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(Ot,{htmlFor:`enable-details-${u}`,className:"text-xs",children:h?"Enabled":"Disabled"}),f.jsx(Oo,{id:`enable-details-${u}`,checked:h,onCheckedChange:l,disabled:!(d!=null&&d.isEnabled),"aria-label":`Enable model ${a.name}`})]})]}),o.description&&f.jsx("p",{className:"text-xs text-muted-foreground flex-shrink-0",children:o.description}),f.jsx(Yl,{className:"flex-grow border rounded-md bg-background/30",children:f.jsxs(lf,{children:[f.jsxs(bze,{className:"py-2 text-xs",children:["Model ID: ",o.id]}),f.jsxs(cf,{children:[Pl("Context Length",((y=o.top_provider)==null?void 0:y.context_length)??o.context_length),Pl("Max Completion Tokens",(b=o.top_provider)==null?void 0:b.max_completion_tokens),Pl("Input Modalities",(v=o.architecture)==null?void 0:v.input_modalities),Pl("Output Modalities",(x=o.architecture)==null?void 0:x.output_modalities),Pl("Tokenizer",(w=o.architecture)==null?void 0:w.tokenizer,!0),Pl("Instruct Type",(S=o.architecture)==null?void 0:S.instruct_type,!0),Pl("Pricing (Prompt)",m2((k=o.pricing)==null?void 0:k.prompt)),Pl("Pricing (Completion)",m2((C=o.pricing)==null?void 0:C.completion)),Pl("Pricing (Image)",m2((T=o.pricing)==null?void 0:T.image)),Pl("Pricing (Request)",m2((R=o.pricing)==null?void 0:R.request)),Pl("Supported Parameters",o.supported_parameters),Pl("Moderated",(N=o.top_provider)!=null&&N.is_moderated?f.jsx(hE,{className:"h-4 w-4 text-green-500"}):"No")]})]})})]})},SKe=()=>{const{apiKeys:e,addApiKey:t,deleteApiKey:n,isLoading:r}=Cr(yn(h=>({apiKeys:h.dbApiKeys,addApiKey:h.addApiKey,deleteApiKey:h.deleteApiKey,isLoading:h.isLoading}))),[s,i]=E.useState(!1),[a,o]=E.useState(!1),[l,c]=E.useState({}),u=E.useCallback(async(h,m,y)=>{o(!0);try{await t(h,m,y),i(!1)}catch(b){console.error("Failed to add API key (from component):",b)}finally{o(!1)}},[t]),d=E.useCallback(async(h,m)=>{if(window.confirm(`Are you sure you want to delete the API key "${m}"? This will unlink it from any providers using it.`)){c(y=>({...y,[h]:!0}));try{await n(h)}catch(y){console.error("Failed to delete API key (from component):",y)}finally{c(y=>({...y,[h]:!1}))}}},[n]);return f.jsxs("div",{className:"space-y-6 p-1",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"text-lg font-medium",children:"API Key Management"}),f.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Manage API keys for different providers. Keys are stored securely in your browser's local storage and never sent to any server other than the intended AI provider."})]}),!s&&f.jsxs(mt,{onClick:()=>i(!0),variant:"outline",className:"w-full mb-4",disabled:r,children:[f.jsx(jc,{className:"h-4 w-4 mr-1"})," Add New API Key"]}),s&&f.jsxs("div",{className:"border rounded-md p-4 space-y-3 bg-card shadow-md mb-4",children:[f.jsx("h4",{className:"font-semibold text-card-foreground",children:"Add New Key"}),f.jsx(vte,{onSave:u,onCancel:()=>i(!1),disabled:a})]}),f.jsxs("div",{children:[f.jsx("h4",{className:"text-md font-medium mb-2",children:"Stored API Keys"}),r&&!s?f.jsxs("div",{className:"space-y-2",children:[f.jsx(Wr,{className:"h-10 w-full"}),f.jsx(Wr,{className:"h-10 w-full"})]}):(e||[]).length===0&&!s?f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No API keys stored yet."}):f.jsx("div",{className:"border rounded-md overflow-hidden",children:f.jsxs(lf,{children:[f.jsx(dp,{children:f.jsxs(Ts,{children:[f.jsx(Ar,{children:"Name"}),f.jsx(Ar,{children:"Provider Type"}),f.jsx(Ar,{children:"Created"}),f.jsx(Ar,{className:"text-right",children:"Actions"})]})}),f.jsx(cf,{children:(e||[]).map(h=>{const m=l[h.id];return f.jsxs(Ts,{className:m?"opacity-50":"",children:[f.jsx(Fn,{className:"font-medium",children:h.name||"Unnamed Key"}),f.jsx(Fn,{children:h.providerId||"Unknown"}),f.jsx(Fn,{className:"text-xs text-muted-foreground",children:Md(new Date(h.createdAt),"PPp")}),f.jsx(Fn,{className:"text-right",children:f.jsx(Un,{tooltipText:"Delete Key",onClick:()=>d(h.id,h.name||"Unnamed Key"),disabled:m,"aria-label":`Delete key ${h.name||"Unnamed Key"}`,icon:m?f.jsx(Xn,{className:"h-4 w-4 animate-spin"}):f.jsx(Mo,{}),className:"text-destructive hover:text-destructive/80 h-8 w-8"})})]},h.id)})})]})})]})]})},CKe=Ve.memo(SKe),kKe=({onSelectModelForDetails:e})=>{const[t,n]=E.useState(null),[r,s]=E.useState(null),i=E.useCallback(C=>{if(C){n(C);const T=C.querySelector("[data-radix-scroll-area-viewport]");if(T)s(T);else{const R=new MutationObserver(()=>{const N=C.querySelector("[data-radix-scroll-area-viewport]");N&&(s(N),R.disconnect())});return R.observe(C,{childList:!0,subtree:!0}),()=>R.disconnect()}}else n(null),s(null)},[]),{getAvailableModelListItems:a,isLoading:o,dbProviderConfigs:l}=Cr(yn(C=>({getAvailableModelListItems:C.getAvailableModelListItems,isLoading:C.isLoading,dbProviderConfigs:C.dbProviderConfigs}))),[c,u]=E.useState(""),[d,h]=E.useState(()=>new Set(l.map(C=>C.id))),[m,y]=E.useState({reasoning:!1,webSearch:!1,tools:!1,multimodal:!1}),b=E.useMemo(()=>a(),[a]);E.useEffect(()=>{h(new Set(l.map(C=>C.id)))},[l]);const v=E.useMemo(()=>{let C=b;if(d.size!==l.length&&(C=C.filter(R=>d.has(R.providerId))),c.trim()){const R=c.toLowerCase();C=C.filter(N=>N.name.toLowerCase().includes(R)||N.providerName.toLowerCase().includes(R)||N.id.toLowerCase().includes(R))}const T=Object.entries(m).filter(([,R])=>R).map(([R])=>R);return T.length>0&&(C=C.filter(R=>{var P,B;const N=new Set(((P=R.metadataSummary)==null?void 0:P.supported_parameters)??[]),I=new Set(((B=R.metadataSummary)==null?void 0:B.input_modalities)??[]);return T.every(D=>{switch(D){case"reasoning":return N.has("reasoning");case"webSearch":return N.has("web_search")||N.has("web_search_options");case"tools":return N.has("tools");case"multimodal":return Array.from(I).some(W=>W!=="text");default:return!0}})})),C.sort((R,N)=>{const I=R.providerName.localeCompare(N.providerName);return I!==0?I:R.name.localeCompare(N.name)})},[b,c,d,l.length,m]),x=R6({count:v.length,getScrollElement:()=>r,estimateSize:()=>48,overscan:10}),w=E.useCallback(C=>{e(C)},[e]),S=E.useCallback(C=>{y(C)},[]),k=E.useMemo(()=>(d.size!==l.length?1:0)+Object.values(m).filter(Boolean).length,[d,l.length,m]);return o?f.jsxs("div",{className:"space-y-2 h-full flex flex-col",children:[f.jsx(Wr,{className:"h-9 w-full flex-shrink-0"}),f.jsx(Wr,{className:"h-full w-full flex-grow"})]}):f.jsxs("div",{className:"space-y-3 h-full flex flex-col",children:[f.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[f.jsxs("div",{className:"relative flex-grow",children:[f.jsx(Do,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),f.jsx(Cn,{type:"search",placeholder:"Filter models by name or provider...",value:c,onChange:C=>u(C.target.value),className:"pl-8 w-full h-9",disabled:o})]}),f.jsx(P6,{currentCapabilityFilters:m,onCapabilityFilterChange:S,currentSelectedProviders:d,onProviderFilterChange:h,allProviders:l,showProviderFilter:!0,showCapabilityFilters:!0,disabled:o||l.length===0,totalActiveFilters:k})]}),f.jsxs(Yl,{className:"flex-grow border rounded-md bg-background/50 h-[calc(15*2.5rem+2px)]",ref:i,children:[r&&f.jsx("div",{style:{height:`${x.getTotalSize()}px`,width:"100%",position:"relative"},children:v.length===0&&!o?f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4 absolute inset-0 flex items-center justify-center",children:"No models match your filters."}):x.getVirtualItems().map(C=>{var R;const T=v[C.index];return T?f.jsx("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:`${C.size}px`,transform:`translateY(${C.start}px)`},className:"p-1",children:f.jsx(xr,{delayDuration:300,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsxs("button",{className:"w-full text-left p-1.5 rounded hover:bg-muted/50 flex flex-col",onClick:()=>w(T.id),children:[f.jsx("span",{className:"text-sm font-medium truncate",children:T.name}),f.jsx("span",{className:"text-xs text-muted-foreground truncate",children:T.providerName})]})}),((R=T.metadataSummary)==null?void 0:R.description)&&f.jsx(Sr,{side:"bottom",align:"start",className:"max-w-xs",children:f.jsx("p",{children:T.metadataSummary.description})})]})})},T.id):null})}),!r&&!o&&f.jsx("div",{className:"flex items-center justify-center h-full text-muted-foreground",children:"Initializing list..."})]})]})},EKe=({onSelectModelForDetails:e})=>{const{addDbProviderConfig:t,updateDbProviderConfig:n,deleteDbProviderConfig:r,fetchModels:s,providerFetchStatus:i,dbProviderConfigs:a,apiKeys:o,isLoading:l}=Cr(yn(b=>({addDbProviderConfig:b.addProviderConfig,updateDbProviderConfig:b.updateProviderConfig,deleteDbProviderConfig:b.deleteProviderConfig,fetchModels:b.fetchModels,providerFetchStatus:b.providerFetchStatus,dbProviderConfigs:b.dbProviderConfigs,apiKeys:b.dbApiKeys,isLoading:b.isLoading}))),[c,u]=E.useState(!1),d=()=>u(!0),h=E.useCallback(()=>u(!1),[]),m=E.useCallback(async b=>{await s(b)},[s]),y=E.useMemo(()=>a||[],[a]);return f.jsxs("div",{className:"space-y-6 h-full flex flex-col",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"text-lg font-semibold text-card-foreground",children:"Provider Configuration"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Add, remove, or configure connections to AI providers. Enable models within each provider's edit section. Click a model name to view its details."})]}),f.jsx("div",{className:"flex-shrink-0",children:c?f.jsx(Tte,{apiKeys:o||[],onAddProvider:t,onCancel:h}):f.jsxs(mt,{onClick:d,variant:"outline",className:"w-full",disabled:l,children:[f.jsx(jc,{className:"h-4 w-4 mr-1"})," Add Provider Configuration"]})}),f.jsx("div",{className:"flex-grow border-t border-border pt-4 mt-4 overflow-y-auto",children:f.jsxs("div",{className:"space-y-2",children:[l&&!c?f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:[f.jsx(Wr,{className:"h-24 w-full"}),f.jsx(Wr,{className:"h-24 w-full"}),f.jsx(Wr,{className:"h-24 w-full"})]}):f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:y.map(b=>f.jsx(IHe,{provider:b,apiKeys:o||[],onUpdate:n,onDelete:r,onFetchModels:m,fetchStatus:i[b.id]||"idle",onSelectModelForDetails:e},b.id))}),!l&&y.length===0&&!c&&f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:'No providers configured yet. Click "Add Provider Configuration" above.'})]})})]})},TKe=({setGlobalModelSortOrderFromModule:e})=>{const{selectedModelForDetails:t,setSelectedModelForDetails:n}=Cr(yn(o=>({selectedModelForDetails:o._selectedModelForDetails,setSelectedModelForDetails:o.setSelectedModelForDetails}))),[r,s]=E.useState("providers-config"),i=E.useCallback(o=>{n(o),o&&s("providers-details-current")},[n,s]),a=E.useMemo(()=>[{value:"providers-config",label:"Configuration",content:f.jsx(EKe,{onSelectModelForDetails:i})},{value:"providers-order",label:"Model Order",content:f.jsx(wKe,{setGlobalModelSortOrderFromModule:e})},{value:"api-keys",label:"API Keys",content:f.jsx(CKe,{})},{value:"providers-details-current",label:"Selected Model",content:f.jsx(_Ke,{modelId:t})},{value:"providers-browse-all",label:"Browse Models",content:f.jsx(kKe,{onSelectModelForDetails:i}),scrollable:!1}],[t,i,e]);return f.jsx(oc,{tabs:a,initialValue:r,onValueChange:s,className:"h-full",listClassName:"bg-muted/50 rounded-md",contentContainerClassName:"mt-4"})},AKe=Ve.memo(TKe);class RKe{constructor(){de(this,"id","core-provider-settings");de(this,"modApiRef",null);de(this,"eventUnsubscribers",[]);de(this,"setGlobalModelSortOrderFromModule",t=>{var n;(n=this.modApiRef)==null||n.emit(Qn.setGlobalModelSortOrderRequest,{ids:t})})}async initialize(t){this.modApiRef=t}register(t){this.modApiRef=t,t.registerSettingsTab({id:"providers",title:"Providers & Models",order:20,component:()=>Ve.createElement(AKe,{setGlobalModelSortOrderFromModule:this.setGlobalModelSortOrderFromModule})})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.modApiRef=null}}const NKe=Ke({globalSystemPrompt:ze()});function MKe({field:e}){return f.jsx(f.Fragment,{children:e.state.meta.isTouched&&e.state.meta.errors.length>0?f.jsx("em",{className:"text-xs text-destructive mt-1 block",children:e.state.meta.errors.join(", ")}):null})}const IKe=()=>{const{globalSystemPrompt:e,setGlobalSystemPrompt:t}=br(yn(r=>({globalSystemPrompt:r.globalSystemPrompt,setGlobalSystemPrompt:r.setGlobalSystemPrompt}))),n=ii({defaultValues:{globalSystemPrompt:e??""},validators:{onChangeAsync:NKe,onChangeAsyncDebounceMs:500},onSubmit:async({value:r})=>{try{t(r.globalSystemPrompt),Me.success("Global system prompt updated!")}catch(s){Me.error("Failed to update prompt. Please try again."),console.error("Error submitting assistant prompt form:",s)}}});return E.useEffect(()=>{n.state.values.globalSystemPrompt!==(e??"")&&n.reset({globalSystemPrompt:e??""})},[e,n]),f.jsxs("form",{onSubmit:r=>{r.preventDefault(),r.stopPropagation(),n.handleSubmit()},className:"space-y-3",children:[f.jsx("div",{children:f.jsx(n.Field,{name:"globalSystemPrompt",children:r=>f.jsxs(f.Fragment,{children:[f.jsx(Ot,{htmlFor:r.name,className:"text-sm mb-1 block",children:"Global System Prompt"}),f.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"Default instructions for the assistant. Can be overridden per-project."}),f.jsx(Uo,{id:r.name,placeholder:"Enter default system instructions for the assistant...",value:r.state.value,onBlur:r.handleBlur,onChange:s=>r.handleChange(s.target.value),rows:6,className:r.state.meta.errors.length?"border-destructive":""}),f.jsx(MKe,{field:r})]})})}),f.jsx("div",{className:"flex justify-end pt-2",children:f.jsx(n.Subscribe,{selector:r=>[r.canSubmit,r.isSubmitting,r.isValidating,r.isValid],children:([r,s,i,a])=>f.jsx(mt,{type:"submit",size:"sm",disabled:!r||s||i||!a,children:s?"Saving...":i?"Validating...":"Save Prompt"})})})]})},jKe=Ke({temperature:At().min(0).max(1),topP:At().min(0).max(1),maxTokens:At().min(1).nullable(),topK:At().min(1).nullable(),presencePenalty:At().min(-2).max(2),frequencyPenalty:At().min(-2).max(2)}),OKe=()=>{const e=br(yn(n=>({temperature:n.temperature,setTemperature:n.setTemperature,topP:n.topP,setTopP:n.setTopP,maxTokens:n.maxTokens,setMaxTokens:n.setMaxTokens,topK:n.topK,setTopK:n.setTopK,presencePenalty:n.presencePenalty,setPresencePenalty:n.setPresencePenalty,frequencyPenalty:n.frequencyPenalty,setFrequencyPenalty:n.setFrequencyPenalty}))),t=ii({defaultValues:{temperature:e.temperature??.7,topP:e.topP??1,maxTokens:e.maxTokens??null,topK:e.topK??null,presencePenalty:e.presencePenalty??0,frequencyPenalty:e.frequencyPenalty??0},validators:{onChangeAsync:jKe,onChangeAsyncDebounceMs:500},onSubmit:async({value:n})=>{try{e.setTemperature(n.temperature),e.setTopP(n.topP),e.setMaxTokens(n.maxTokens??null),e.setTopK(n.topK??null),e.setPresencePenalty(n.presencePenalty),e.setFrequencyPenalty(n.frequencyPenalty),Me.success("Assistant parameters updated!")}catch(r){Me.error("Failed to update parameters."),console.error("Error submitting parameters form:",r)}}});return E.useEffect(()=>{t.reset({temperature:e.temperature??.7,topP:e.topP??1,maxTokens:e.maxTokens??null,topK:e.topK??null,presencePenalty:e.presencePenalty??0,frequencyPenalty:e.frequencyPenalty??0})},[e.temperature,e.topP,e.maxTokens,e.topK,e.presencePenalty,e.frequencyPenalty,t]),f.jsxs("form",{onSubmit:n=>{n.preventDefault(),n.stopPropagation(),t.handleSubmit()},className:"space-y-4",children:[f.jsx("p",{className:"text-xs text-muted-foreground mb-3",children:"Set the default global values for AI parameters. These can be overridden per-project or per-prompt turn."}),f.jsx(Sc,{form:t,name:"temperature",label:"Temperature",min:0,max:1,step:.01,valueDisplayPrecision:2,wrapperClassName:"space-y-1.5"}),f.jsx(Sc,{form:t,name:"topP",label:"Top P",min:0,max:1,step:.01,valueDisplayPrecision:2,wrapperClassName:"space-y-1.5"}),f.jsxs("div",{className:"grid grid-cols-2 gap-4 items-end",children:[f.jsx(Ty,{form:t,name:"maxTokens",label:"Max Tokens",placeholder:"Default (None)",min:1,className:"h-9 text-sm",allowNull:!0,wrapperClassName:"space-y-1.5"}),f.jsx(Ty,{form:t,name:"topK",label:"Top K",placeholder:"Default (None)",min:1,className:"h-9 text-sm",allowNull:!0,wrapperClassName:"space-y-1.5"})]}),f.jsx(Sc,{form:t,name:"presencePenalty",label:"Presence Penalty",min:-2,max:2,step:.01,valueDisplayPrecision:2,wrapperClassName:"space-y-1.5"}),f.jsx(Sc,{form:t,name:"frequencyPenalty",label:"Frequency Penalty",min:-2,max:2,step:.01,valueDisplayPrecision:2,wrapperClassName:"space-y-1.5"}),f.jsxs("div",{className:"flex justify-end space-x-2",children:[f.jsx(mt,{type:"button",variant:"ghost",onClick:()=>t.reset(),disabled:!t.state.isDirty,children:"Reset"}),f.jsx(t.Subscribe,{selector:n=>[n.canSubmit,n.isSubmitting],children:([n,r])=>f.jsx(mt,{type:"submit",disabled:!n||r,children:r?"Saving...":"Save Changes"})})]})]})},PKe=Ke({toolMaxSteps:At({required_error:"Max steps is required",invalid_type_error:"Max steps must be a number"}).min(1,"Must be at least 1").max(20,"Cannot exceed 20")});function DKe({field:e}){return f.jsx(f.Fragment,{children:e.state.meta.isTouched&&e.state.meta.errors.length>0?f.jsx("em",{className:"text-xs text-destructive mt-1 block",children:e.state.meta.errors.join(", ")}):null})}const FKe=()=>{const{toolMaxSteps:e,setToolMaxSteps:t}=br(yn(r=>({toolMaxSteps:r.toolMaxSteps,setToolMaxSteps:r.setToolMaxSteps}))),n=ii({defaultValues:{toolMaxSteps:e??5},validators:{onChangeAsync:PKe,onChangeAsyncDebounceMs:500},onSubmit:async({value:r})=>{try{t(r.toolMaxSteps),Me.success("Tool settings updated!")}catch(s){Me.error("Failed to update tool settings."),console.error("Error submitting tool settings form:",s)}}});return E.useEffect(()=>{n.state.values.toolMaxSteps!==(e??5)&&n.reset({toolMaxSteps:e??5})},[e,n]),f.jsxs("form",{onSubmit:r=>{r.preventDefault(),r.stopPropagation(),n.handleSubmit()},className:"space-y-3",children:[f.jsx(n.Field,{name:"toolMaxSteps",children:r=>f.jsxs("div",{children:[f.jsx(Ot,{htmlFor:r.name,className:"text-sm mb-1 block",children:"Maximum Tool Steps per Turn"}),f.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"Limits the number of sequential tool calls the AI can make before generating a final response (1-20). Higher values allow more complex tasks but increase latency and cost. (Default: 5)"}),f.jsx(Cn,{id:r.name,type:"number",min:1,max:20,step:1,value:r.state.value,onBlur:r.handleBlur,onChange:s=>{const i=s.target.valueAsNumber;isNaN(i)?s.target.value===""&&r.handleChange(void 0):r.handleChange(i)},className:`w-24 ${r.state.meta.errors.length?"border-destructive":""}`}),f.jsx(DKe,{field:r})]})}),f.jsx("div",{className:"flex justify-end pt-2",children:f.jsx(n.Subscribe,{selector:r=>[r.canSubmit,r.isSubmitting,r.isValidating,r.isValid],children:([r,s,i,a])=>f.jsx(mt,{type:"submit",size:"sm",disabled:!r||s||i||!a,children:s?"Saving...":i?"Validating...":"Save Tool Settings"})})})]})},LKe=Ke({autoTitleEnabled:Kn(),autoTitleModelId:ze().nullable(),autoTitlePromptMaxLength:At().min(100).max(4e3),autoTitleIncludeFiles:Kn(),autoTitleIncludeRules:Kn()});function Vv({field:e}){return f.jsx(f.Fragment,{children:e.state.meta.isTouched&&e.state.meta.errors.length>0?f.jsx("em",{className:"text-xs text-destructive mt-1 block",children:e.state.meta.errors.join(", ")}):null})}const BKe=()=>{const e=br(yn(n=>({autoTitleEnabled:n.autoTitleEnabled,setAutoTitleEnabled:n.setAutoTitleEnabled,autoTitleModelId:n.autoTitleModelId,setAutoTitleModelId:n.setAutoTitleModelId,autoTitlePromptMaxLength:n.autoTitlePromptMaxLength,setAutoTitlePromptMaxLength:n.setAutoTitlePromptMaxLength,autoTitleIncludeFiles:n.autoTitleIncludeFiles,setAutoTitleIncludeFiles:n.setAutoTitleIncludeFiles,autoTitleIncludeRules:n.autoTitleIncludeRules,setAutoTitleIncludeRules:n.setAutoTitleIncludeRules}))),t=ii({defaultValues:{autoTitleEnabled:e.autoTitleEnabled??!1,autoTitleModelId:e.autoTitleModelId??null,autoTitlePromptMaxLength:e.autoTitlePromptMaxLength??768,autoTitleIncludeFiles:e.autoTitleIncludeFiles??!1,autoTitleIncludeRules:e.autoTitleIncludeRules??!1},validators:{onChangeAsync:LKe,onChangeAsyncDebounceMs:500},onSubmit:async({value:n})=>{try{e.setAutoTitleEnabled(n.autoTitleEnabled),e.setAutoTitleModelId(n.autoTitleModelId??null),e.setAutoTitlePromptMaxLength(n.autoTitlePromptMaxLength),e.setAutoTitleIncludeFiles(n.autoTitleIncludeFiles),e.setAutoTitleIncludeRules(n.autoTitleIncludeRules),Me.success("Auto-title settings updated!")}catch(r){Me.error("Failed to update auto-title settings."),console.error("Error submitting auto-title settings form:",r)}}});return E.useEffect(()=>{t.reset({autoTitleEnabled:e.autoTitleEnabled??!1,autoTitleModelId:e.autoTitleModelId??null,autoTitlePromptMaxLength:e.autoTitlePromptMaxLength??768,autoTitleIncludeFiles:e.autoTitleIncludeFiles??!1,autoTitleIncludeRules:e.autoTitleIncludeRules??!1})},[e.autoTitleEnabled,e.autoTitleModelId,e.autoTitlePromptMaxLength,e.autoTitleIncludeFiles,e.autoTitleIncludeRules,t]),f.jsxs("form",{onSubmit:n=>{n.preventDefault(),n.stopPropagation(),t.handleSubmit()},className:"space-y-3",children:[f.jsx(t.Field,{name:"autoTitleEnabled",children:n=>f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(Oo,{id:n.name,checked:n.state.value,onCheckedChange:n.handleChange,onBlur:n.handleBlur,"aria-labelledby":`${n.name}-label`}),f.jsx(Ot,{id:`${n.name}-label`,htmlFor:n.name,children:"Enable Auto-Title Generation"}),f.jsx(Vv,{field:n})]})}),t.state.values.autoTitleEnabled&&f.jsxs("div",{className:"space-y-3 pl-6 border-l-2 border-muted",children:[f.jsx(t.Field,{name:"autoTitleModelId",children:n=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(Ot,{htmlFor:n.name,children:"Model for Title Generation"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Choose which model to use for generating conversation titles. Uses global default model if not specified."}),f.jsx(eF,{value:n.state.value,onChange:r=>n.handleChange(r),className:"w-full"}),f.jsx(Vv,{field:n})]})}),f.jsx(t.Field,{name:"autoTitlePromptMaxLength",children:n=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(Ot,{htmlFor:n.name,children:"Conversation Content Length Limit"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Maximum characters from conversation to include in title generation prompt (100-4000)."}),f.jsx(Cn,{id:n.name,type:"number",min:100,max:4e3,step:1,value:n.state.value,onBlur:n.handleBlur,onChange:r=>{const s=r.target.valueAsNumber;isNaN(s)||n.handleChange(s)},className:`w-32 ${n.state.meta.errors.length?"border-destructive":""}`}),f.jsx(Vv,{field:n})]})}),f.jsx(t.Field,{name:"autoTitleIncludeFiles",children:n=>f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(Oo,{id:n.name,checked:n.state.value,onCheckedChange:n.handleChange,onBlur:n.handleBlur,"aria-labelledby":`${n.name}-label`}),f.jsx(Ot,{id:`${n.name}-label`,htmlFor:n.name,children:"Include file context in title prompt"}),f.jsx(Vv,{field:n})]})}),f.jsx(t.Field,{name:"autoTitleIncludeRules",children:n=>f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(Oo,{id:n.name,checked:n.state.value,onCheckedChange:n.handleChange,onBlur:n.handleBlur,"aria-labelledby":`${n.name}-label`}),f.jsx(Ot,{id:`${n.name}-label`,htmlFor:n.name,children:"Include active rules in title prompt"}),f.jsx(Vv,{field:n})]})})]}),f.jsx("div",{className:"flex justify-end pt-2",children:f.jsx(t.Subscribe,{selector:n=>[n.canSubmit,n.isSubmitting,n.isValidating,n.isValid],children:([n,r,s,i])=>f.jsx(mt,{type:"submit",size:"sm",disabled:!n||r||s||!i,children:r?"Saving...":s?"Validating...":"Save Title Settings"})})})]})},$Ke=({selectedTools:e,onToolsChange:t,className:n,disabled:r=!1,maxSteps:s,onMaxStepsChange:i,globalDefaultMaxSteps:a=5,showMaxSteps:o=!1})=>{const l=E.useMemo(()=>new Set(e),[e]),c=E.useCallback((d,h)=>{const m=h?[...e,d]:e.filter(y=>y!==d);t(m)},[e,t]),u=E.useCallback((d,h)=>{t(d?h:[])},[t]);return f.jsx(Nse,{enabledTools:l,onToggleTool:c,onToggleAll:u,disabled:r,className:n,maxSteps:s,onMaxStepsChange:i,globalDefaultMaxSteps:a,showMaxSteps:o})},zKe=({variables:e,onVariablesChange:t,templateId:n})=>{const[r,s]=E.useState({name:"",description:"",type:"string",required:!1,default:"",instructions:""});E.useEffect(()=>{s({name:"",description:"",type:"string",required:!1,default:"",instructions:""})},[n]),E.useEffect(()=>()=>{s({name:"",description:"",type:"string",required:!1,default:"",instructions:""})},[]);const i=()=>{r.name&&(t([...e,{...r}]),s({name:"",description:"",type:"string",required:!1,default:"",instructions:""}))},a=o=>{t(e.filter((l,c)=>c!==o))};return f.jsx("div",{className:"space-y-4",children:f.jsxs("div",{children:[f.jsx(Ot,{className:"text-base font-medium",children:"Variables"}),f.jsxs("div",{className:"space-y-3 mt-2",children:[e.map((o,l)=>f.jsxs("div",{className:"p-3 border rounded-lg space-y-2",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("h4",{className:"font-medium",children:o.name}),f.jsx(mt,{variant:"ghost",size:"sm",onClick:()=>a(l),children:f.jsx(Oi,{className:"h-4 w-4"})})]}),f.jsx("p",{className:"text-sm text-muted-foreground",children:o.description}),f.jsxs("div",{className:"flex gap-2 text-xs",children:[f.jsx(is,{variant:o.required?"default":"secondary",children:o.required?"Required":"Optional"}),f.jsx(is,{variant:"outline",children:o.type}),o.default&&f.jsxs(is,{variant:"outline",children:["Default: ",o.default]})]})]},`${o.name}-${l}`)),f.jsxs("div",{className:"p-3 border-2 border-dashed rounded-lg space-y-3",children:[f.jsx(Ot,{children:"Add New Variable"}),f.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[f.jsxs("div",{children:[f.jsx(Ot,{children:"Name"}),f.jsx(Cn,{value:r.name,onChange:o=>s(l=>({...l,name:o.target.value})),placeholder:"Variable name"})]}),f.jsxs("div",{children:[f.jsx(Ot,{children:"Type"}),f.jsxs(tp,{value:r.type,onValueChange:o=>s(l=>({...l,type:o})),children:[f.jsx(rp,{children:f.jsx(np,{})}),f.jsxs(sp,{children:[f.jsx(Ro,{value:"string",children:"String"}),f.jsx(Ro,{value:"number",children:"Number"}),f.jsx(Ro,{value:"boolean",children:"Boolean"}),f.jsx(Ro,{value:"array",children:"Array"})]})]},`new-variable-type-${n||"new"}`)]})]}),f.jsxs("div",{children:[f.jsx(Ot,{children:"Description"}),f.jsx(Cn,{value:r.description,onChange:o=>s(l=>({...l,description:o.target.value})),placeholder:"Describe this variable"})]}),f.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[f.jsxs("div",{children:[f.jsx(Ot,{children:"Default Value"}),f.jsx(Cn,{value:r.default,onChange:o=>s(l=>({...l,default:o.target.value})),placeholder:"Default value (optional)"})]}),f.jsxs("div",{className:"flex items-center space-x-2 pt-6",children:[f.jsx($c,{checked:r.required,onCheckedChange:o=>s(l=>({...l,required:!!o}))}),f.jsx(Ot,{children:"Required"})]})]}),f.jsxs(mt,{type:"button",onClick:i,className:"w-full",children:[f.jsx(jc,{className:"h-4 w-4 mr-2"}),"Add Variable"]})]})]})]})})},UKe=({selectedFollowUps:e,onFollowUpsChange:t,followUpOptions:n,templateId:r})=>{const[s,i]=E.useState(!1),[a,o]=E.useState(""),l=E.useRef(null),c=n.filter(m=>m.id!==r&&!e.includes(m.id)),u=c.filter(m=>m.name.toLowerCase().includes(a.toLowerCase())||m.description.toLowerCase().includes(a.toLowerCase())),d=m=>{m&&!e.includes(m)&&(t([...e,m]),o(""),i(!1))};E.useEffect(()=>{const m=y=>{l.current&&!l.current.contains(y.target)&&i(!1)};return document.addEventListener("mousedown",m),()=>{document.removeEventListener("mousedown",m)}},[]);const h=m=>{t(e.filter(y=>y!==m))};return f.jsx("div",{className:"space-y-4",children:f.jsxs("div",{children:[f.jsx(Ot,{className:"text-base font-medium",children:"Follow-up Templates"}),f.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Select templates that can be suggested as follow-ups after this template is used."}),f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{className:"space-y-2",children:[f.jsx(Ot,{className:"text-sm font-medium",children:"Selected Follow-ups:"}),e.length===0?f.jsx("p",{className:"text-sm text-muted-foreground",children:"No follow-ups selected yet."}):f.jsx("div",{className:"flex flex-wrap gap-2",children:e.map(m=>{const y=n.find(b=>b.id===m);return y?f.jsxs(is,{variant:"secondary",className:"flex items-center gap-1",children:[y.name,f.jsx(mt,{variant:"ghost",size:"sm",className:"h-4 w-4 p-0 hover:bg-destructive hover:text-destructive-foreground",onClick:()=>h(m),children:f.jsx(Oi,{className:"h-3 w-3"})})]},m):f.jsxs(is,{variant:"destructive",className:"flex items-center gap-1",children:["Unknown Template (",m,")",f.jsx(mt,{variant:"ghost",size:"sm",className:"h-4 w-4 p-0 hover:bg-destructive hover:text-destructive-foreground",onClick:()=>h(m),children:f.jsx(Oi,{className:"h-3 w-3"})})]},m)})})]}),c.length>0&&f.jsxs("div",{className:"relative",ref:l,children:[f.jsx(Ot,{className:"text-sm",children:"Add Follow-up Template:"}),f.jsxs("div",{className:"relative",children:[f.jsxs("div",{className:"flex h-9 w-full items-center justify-between rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm cursor-pointer hover:bg-accent",onClick:()=>i(!s),children:[f.jsx("span",{className:"text-muted-foreground",children:a||"Select a template to add as follow-up"}),f.jsx(Jl,{className:"h-4 w-4 opacity-50"})]}),s&&f.jsxs("div",{className:"absolute top-full left-0 right-0 z-50 mt-1 max-h-60 overflow-auto rounded-md border bg-popover text-popover-foreground shadow-md",children:[f.jsx("div",{className:"p-2",children:f.jsx(Cn,{placeholder:"Search templates...",value:a,onChange:m=>o(m.target.value),className:"h-8"})}),f.jsx("div",{className:"max-h-48 overflow-auto",children:u.length===0?f.jsx("div",{className:"px-2 py-1.5 text-sm text-muted-foreground",children:"No templates found."}):u.map(m=>f.jsxs("div",{className:"relative flex cursor-pointer select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none hover:bg-accent hover:text-accent-foreground",onClick:()=>d(m.id),children:[m.name," - ",m.description]},m.id))})]})]})]}),c.length===0&&e.length===0&&f.jsx("p",{className:"text-sm text-muted-foreground",children:"No templates available for follow-ups. Create more templates first."}),c.length===0&&e.length>0&&f.jsx("p",{className:"text-sm text-muted-foreground",children:"All available templates have been selected as follow-ups."})]})]})})},qKe=()=>{const e=Ke({name:ze().min(1,"Name is required"),description:ze(),variables:on(Ke({name:ze().min(1,"Variable name is required"),description:ze(),type:xl(["string","number","boolean","array"]),required:Kn(),default:ze().optional(),instructions:ze().optional()})),prompt:ze().min(1,"Prompt content is required"),tags:on(ze()),tools:on(ze()),rules:on(ze()),followUps:on(ze())});return async({value:t})=>{try{await e.parseAsync(t)}catch(n){return n instanceof Oc?n.formErrors.fieldErrors:{root:"Validation failed"}}}},R0=({template:e,onSubmit:t,onSuccess:n,type:r,showFollowUps:s=!1,showMaxSteps:i=!1,followUpOptions:a=[],additionalActions:o})=>{const[l,c]=E.useState(null),{rules:u,tags:d,tagRuleLinks:h,loadRulesAndTags:m}=bne(yn(w=>({rules:w.rules,tags:w.tags,tagRuleLinks:w.tagRuleLinks,loadRulesAndTags:w.loadRulesAndTags})));E.useEffect(()=>{m()},[m]);const y=ii({defaultValues:{name:(e==null?void 0:e.name)||"",description:(e==null?void 0:e.description)||"",variables:(e==null?void 0:e.variables)||[],prompt:(e==null?void 0:e.prompt)||"",tags:(e==null?void 0:e.tags)||[],tools:(e==null?void 0:e.tools)||[],rules:(e==null?void 0:e.rules)||[],followUps:(e==null?void 0:e.followUps)||[]},validators:{onChangeAsync:qKe(),onChangeAsyncDebounceMs:500},onSubmit:async({value:w})=>{t(w),n()}}),b=w=>{const S=h.filter(k=>k.tagId===w).map(k=>k.ruleId);return u.filter(k=>S.includes(k.id))},v=()=>{switch(r){case"agent":return"Agent";case"task":return"Task";default:return"Template"}},x=()=>{switch(r){case"agent":return"Agent Prompt";case"task":return"Task Prompt";default:return"Prompt Template"}};return f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"font-medium",children:e?`Edit ${v()}`:`New ${v()}`}),f.jsx("p",{className:"text-sm text-muted-foreground",children:e?`Update your ${r}`:`Create a new ${r}${r==="prompt"?" template with variables":""}`})]}),f.jsxs("form",{onSubmit:w=>{w.preventDefault(),w.stopPropagation(),y.handleSubmit()},className:"space-y-6",children:[f.jsxs("div",{className:"space-y-4",children:[f.jsx(y.Field,{name:"name",children:w=>f.jsxs("div",{children:[f.jsxs(Ot,{htmlFor:w.name,children:[v()," Name"]}),f.jsx(Cn,{id:w.name,value:w.state.value,onChange:S=>w.handleChange(S.target.value),onBlur:w.handleBlur,placeholder:`Enter ${r} name`}),w.state.meta.errors&&w.state.meta.errors.length>0&&f.jsx("p",{className:"text-xs text-destructive mt-1",children:w.state.meta.errors[0]||"Invalid input"})]})}),f.jsx(y.Field,{name:"description",children:w=>f.jsxs("div",{children:[f.jsx(Ot,{htmlFor:w.name,children:"Description"}),f.jsx(Uo,{id:w.name,value:w.state.value,onChange:S=>w.handleChange(S.target.value),onBlur:w.handleBlur,placeholder:`Describe what this ${r} does`,rows:3})]})}),f.jsx(y.Field,{name:"prompt",children:w=>f.jsxs("div",{children:[f.jsx(Ot,{htmlFor:w.name,children:x()}),f.jsx(Uo,{id:w.name,value:w.state.value,onChange:S=>w.handleChange(S.target.value),onBlur:w.handleBlur,placeholder:`Enter your ${r} prompt using {{ variable_name }} syntax`,rows:6,className:"font-mono"}),f.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["Use double curly braces to reference variables:"," ","{{ variable_name }}"]}),w.state.meta.errors&&w.state.meta.errors.length>0&&f.jsx("p",{className:"text-xs text-destructive mt-1",children:w.state.meta.errors[0]||"Invalid input"})]})})]}),f.jsx(y.Field,{name:"variables",children:w=>f.jsx(zKe,{variables:w.state.value,onVariablesChange:S=>w.handleChange(S),templateId:e==null?void 0:e.id})}),s&&f.jsx(y.Field,{name:"followUps",children:w=>f.jsx(UKe,{selectedFollowUps:w.state.value||[],onFollowUpsChange:S=>w.handleChange(S),followUpOptions:a,templateId:e==null?void 0:e.id})}),f.jsx("div",{className:"space-y-4",children:f.jsxs("div",{children:[f.jsx(Ot,{className:"text-base font-medium",children:"Auto-select Tools"}),f.jsxs("p",{className:"text-sm text-muted-foreground mb-4",children:["Choose tools that will be automatically enabled when this ",r,"is applied."]}),f.jsx(y.Field,{name:"tools",children:w=>f.jsx($Ke,{selectedTools:w.state.value,onToolsChange:S=>w.handleChange(S),className:"p-0 max-w-none",maxSteps:l,onMaxStepsChange:c,showMaxSteps:i})})]})}),f.jsx("div",{className:"space-y-4",children:f.jsxs("div",{children:[f.jsx(Ot,{className:"text-base font-medium",children:"Auto-select Rules & Tags"}),f.jsxs("p",{className:"text-sm text-muted-foreground mb-4",children:["Choose rules and tags that will be automatically enabled when this",r," is applied."]}),f.jsx(Hse,{activeTagIds:new Set(y.getFieldValue("tags")),activeRuleIds:new Set(y.getFieldValue("rules")),onToggleTag:(w,S)=>{const k=y.getFieldValue("tags");S?y.setFieldValue("tags",[...k,w]):y.setFieldValue("tags",k.filter(C=>C!==w))},onToggleRule:(w,S)=>{const k=y.getFieldValue("rules");S?y.setFieldValue("rules",[...k,w]):y.setFieldValue("rules",k.filter(C=>C!==w))},allRules:u,allTags:d,getRulesForTag:b})]})}),f.jsxs("div",{className:"flex gap-3 pt-4 border-t",children:[f.jsxs(mt,{type:"submit",className:"flex-1",children:[f.jsx($u,{className:"h-4 w-4 mr-2"}),e?`Update ${v()}`:`Create ${v()}`]}),o]})]})]})},z4=({templates:e,onEdit:t,onDelete:n,type:r,emptyMessage:s,additionalActions:i,getTaskCount:a})=>{const o=()=>{switch(r){case"agent":return"Agents";case"task":return"Tasks";default:return"Templates"}},l=()=>{switch(r){case"agent":return"Manage your AI agents and their associated tasks";case"task":return"Manage tasks for this agent";default:return"Manage your reusable prompt templates with dynamic variables"}},c=()=>{if(s)return s;switch(r){case"agent":return"No Agents Yet";case"task":return"No Tasks Yet";default:return"No Templates Yet"}},u=()=>{switch(r){case"agent":return'Use the "New Agent" tab to create your first agent';case"task":return"Create tasks to define what this agent can do";default:return'Use the "New Template" tab to create your first template'}};return f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"font-medium",children:o()}),f.jsx("p",{className:"text-sm text-muted-foreground",children:l()})]}),e.length===0?f.jsxs("div",{className:"text-center py-12 border-2 border-dashed rounded-lg",children:[f.jsx("h4",{className:"font-medium text-muted-foreground",children:c()}),f.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:u()})]}):f.jsxs(lf,{children:[f.jsx(dp,{children:f.jsxs(Ts,{children:[f.jsx(Ar,{children:"Name"}),f.jsx(Ar,{children:"Description"}),f.jsx(Ar,{children:"Variables"}),r==="agent"&&f.jsx(Ar,{children:"Tasks"}),(r==="prompt"||r==="task")&&f.jsx(Ar,{children:"Follow-ups"}),f.jsx(Ar,{children:"Tools"}),f.jsx(Ar,{children:"Rules/Tags"}),f.jsx(Ar,{className:"text-right",children:"Actions"})]})}),f.jsx(cf,{children:e.map(d=>{var h,m,y,b;return f.jsxs(Ts,{children:[f.jsx(Fn,{className:"font-medium",children:d.name}),f.jsx(Fn,{className:"max-w-xs truncate",children:d.description}),f.jsx(Fn,{children:f.jsx(is,{variant:"secondary",children:d.variables.length})}),r==="agent"&&f.jsx(Fn,{children:f.jsx(is,{variant:"secondary",children:a?a(d.id):0})}),(r==="prompt"||r==="task")&&f.jsx(Fn,{children:f.jsx(is,{variant:"secondary",children:((h=d.followUps)==null?void 0:h.length)||0})}),f.jsx(Fn,{children:f.jsx(is,{variant:"secondary",children:((m=d.tools)==null?void 0:m.length)||0})}),f.jsx(Fn,{children:f.jsxs("div",{className:"flex gap-1",children:[f.jsxs(is,{variant:"secondary",children:[((y=d.tags)==null?void 0:y.length)||0," tags"]}),f.jsxs(is,{variant:"secondary",children:[((b=d.rules)==null?void 0:b.length)||0," rules"]})]})}),f.jsx(Fn,{className:"text-right",children:f.jsxs("div",{className:"flex gap-2 justify-end",children:[i&&i(d),f.jsx(mt,{variant:"ghost",size:"sm",onClick:()=>t(d),title:`Edit ${r}`,children:f.jsx(ph,{className:"h-4 w-4"})}),f.jsx(mt,{variant:"ghost",size:"sm",onClick:()=>n(d.id),title:`Delete ${r}`,children:f.jsx(Mo,{className:"h-4 w-4"})})]})})]},d.id)})})]})]})},VKe=()=>{const[e,t]=E.useState("templates"),[n,r]=E.useState(),{loadPromptTemplates:s,addPromptTemplate:i,updatePromptTemplate:a,deletePromptTemplate:o,getTemplatesByType:l}=Mm(yn(v=>({loadPromptTemplates:v.loadPromptTemplates,addPromptTemplate:v.addPromptTemplate,updatePromptTemplate:v.updatePromptTemplate,deletePromptTemplate:v.deletePromptTemplate,getTemplatesByType:v.getTemplatesByType}))),c=l("prompt");E.useEffect(()=>{s()},[s]);const u=async v=>{await i({...v,type:"prompt",isPublic:!1})},d=async v=>{n&&await a(n.id,v)},h=async v=>{confirm("Are you sure you want to delete this template?")&&await o(v)},m=v=>{r(v),t("edit")},y=()=>{t("templates"),r(void 0)},b=[{value:"templates",label:"Templates",content:f.jsx(z4,{templates:c,onEdit:m,onDelete:h,type:"prompt"})},{value:"new",label:"New Template",content:f.jsx(R0,{onSubmit:u,onSuccess:y,type:"prompt",showFollowUps:!0,followUpOptions:c},"new-template-form")}];return n&&b.push({value:"edit",label:`Edit: ${n.name}`,content:f.jsx(R0,{template:n,onSubmit:d,onSuccess:y,type:"prompt",showFollowUps:!0,followUpOptions:c},`edit-template-form-${n.id}`)}),f.jsx(oc,{tabs:b,initialValue:e,onValueChange:t,defaultValue:"templates",contentContainerClassName:"pb-2 sm:pb-6 pr-1 sm:pr-2 -mr-1 sm:-mr-2",scrollable:!1})},WKe=()=>{const[e,t]=E.useState("agents"),[n,r]=E.useState(),[s,i]=E.useState(),[a,o]=E.useState(),{loadPromptTemplates:l,addPromptTemplate:c,updatePromptTemplate:u,deletePromptTemplate:d,getAgents:h,getTasksForAgent:m}=Mm(yn(O=>({loadPromptTemplates:O.loadPromptTemplates,addPromptTemplate:O.addPromptTemplate,updatePromptTemplate:O.updatePromptTemplate,deletePromptTemplate:O.deletePromptTemplate,getAgents:O.getAgents,getTasksForAgent:O.getTasksForAgent})));E.useEffect(()=>{l()},[l]);const y=h(),b=s?m(s.id):[],v=async O=>{await c({...O,type:"agent",isPublic:!1})},x=async O=>{n&&await u(n.id,O)},w=async O=>{if(confirm("Are you sure you want to delete this agent and all its tasks?")){const Z=m(O);for(const U of Z)await d(U.id);await d(O)}},S=async O=>{s&&await c({...O,type:"task",parentId:s.id,isPublic:!1})},k=async O=>{!a||!s||await u(a.id,{...O,parentId:s.id})},C=async O=>{confirm("Are you sure you want to delete this task?")&&await d(O)},T=O=>{r(O),t("edit-agent")},R=O=>{i(O),t("manage-tasks")},N=O=>{o(O),t("edit-task")},I=()=>{o(void 0),t("new-task")},P=()=>{t("agents"),r(void 0),i(void 0),o(void 0)},B=()=>{t("agents"),i(void 0),o(void 0)},D=()=>{t("manage-tasks"),o(void 0)},W=[{value:"agents",label:"Agents",content:f.jsx(z4,{templates:y,onEdit:T,onDelete:w,type:"agent",getTaskCount:O=>m(O).length,additionalActions:O=>f.jsxs(mt,{variant:"ghost",size:"sm",onClick:()=>R(O),title:"Manage Tasks",children:[f.jsx(ph,{className:"h-4 w-4"}),"Tasks"]})})},{value:"new-agent",label:"New Agent",content:f.jsx(R0,{onSubmit:v,onSuccess:P,type:"agent",showFollowUps:!1,showMaxSteps:!0},"new-agent-form")}];return n&&W.push({value:"edit-agent",label:`Edit: ${n.name}`,content:f.jsx(R0,{template:n,onSubmit:x,onSuccess:P,type:"agent",showFollowUps:!1,showMaxSteps:!0,additionalActions:f.jsxs(mt,{type:"button",variant:"outline",onClick:()=>R(n),className:"flex items-center gap-2",children:[f.jsx(ph,{className:"h-4 w-4"}),"Tasks (",m(n.id).length,")"]})},`edit-agent-form-${n.id}`)}),s&&W.push({value:"manage-tasks",label:`Tasks: ${s.name}`,content:f.jsxs("div",{className:"space-y-4",children:[f.jsx("div",{className:"flex items-center gap-2",children:f.jsx(mt,{variant:"outline",onClick:B,children:" Back to Agents"})}),f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsxs("h3",{className:"font-medium",children:["Tasks for ",s.name]}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Manage tasks for this agent"})]}),f.jsxs(mt,{onClick:I,children:[f.jsx(jc,{className:"h-4 w-4 mr-2"}),"New Task"]})]}),f.jsx(z4,{templates:b,onEdit:N,onDelete:C,type:"task",emptyMessage:"No Tasks Yet"})]})}),s&&e==="new-task"&&W.push({value:"new-task",label:"New Task",content:f.jsxs("div",{className:"space-y-4",children:[f.jsx("div",{className:"flex items-center gap-2",children:f.jsx(mt,{variant:"outline",onClick:D,children:" Back to Tasks"})}),f.jsx(R0,{onSubmit:S,onSuccess:D,type:"task",showFollowUps:!0,followUpOptions:b,showMaxSteps:!0},`new-task-form-${s.id}`)]})}),a&&s&&W.push({value:"edit-task",label:`Edit: ${a.name}`,content:f.jsxs("div",{className:"space-y-4",children:[f.jsx("div",{className:"flex items-center gap-2",children:f.jsx(mt,{variant:"outline",onClick:D,children:" Back to Tasks"})}),f.jsx(R0,{template:a,onSubmit:k,onSuccess:D,type:"task",showFollowUps:!0,followUpOptions:b.filter(O=>O.id!==a.id),showMaxSteps:!0},`edit-task-form-${a.id}`)]})}),f.jsx(oc,{tabs:W,initialValue:e,onValueChange:t,defaultValue:"agents",contentContainerClassName:"pb-2 sm:pb-6 pr-1 sm:pr-2 -mr-1 sm:-mr-2",scrollable:!1})},HKe=Ke({name:ze().min(1,"Name is required"),url:ze().url("Must be a valid URL"),description:ze(),headers:ze(),enabled:Kn()}),GKe=Ke({retryAttempts:At().min(0,"Min 0 attempts").max(10,"Max 10 attempts"),retryDelay:At().min(500,"Min 500ms").max(3e4,"Max 30000ms"),connectionTimeout:At().min(1e3,"Min 1000ms").max(6e4,"Max 60000ms"),maxResponseSize:At().min(1e3,"Min 1KB").max(1e7,"Max 10MB")});function kc({field:e}){return f.jsx(f.Fragment,{children:e.state.meta.isTouched&&e.state.meta.errors.length>0?f.jsx("em",{className:"text-xs text-destructive mt-1 block",children:e.state.meta.errors.join(", ")}):null})}function KKe(){const{bridgeConfig:e,setBridgeConfig:t}=al(yn(s=>({bridgeConfig:s.bridgeConfig,setBridgeConfig:s.setBridgeConfig}))),n=ii({defaultValues:{url:e.url||"",host:e.host||"",port:e.port||void 0},onSubmit:async({value:s})=>{t({url:s.url||void 0,host:s.host||void 0,port:s.port})}});E.useEffect(()=>{n.reset({url:e.url||"",host:e.host||"",port:e.port||void 0})},[e,n]);const r=()=>{window.confirm("Reset bridge configuration to defaults?")&&t({})};return f.jsxs("form",{onSubmit:s=>{s.preventDefault(),s.stopPropagation(),n.handleSubmit()},className:"space-y-6",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"font-medium",children:"Dynamic MCP Bridge Configuration"}),f.jsxs("p",{className:"text-sm text-muted-foreground",children:["Configure where LiteChat looks for the dynamic MCP bridge service (required for stdio:// servers). Start the bridge with: ",f.jsx("code",{className:"bg-muted px-1 rounded",children:"npm run mcp-proxy"})]})]}),f.jsxs(dl,{children:[f.jsxs(fl,{children:[f.jsxs(hl,{className:"text-base flex items-center",children:[f.jsx(aC,{className:"mr-2 h-4 w-4"}),"Bridge Location"]}),f.jsx(zd,{children:"Specify where your dynamic MCP bridge is running (default: localhost:3001)"})]}),f.jsxs(pl,{className:"space-y-4",children:[f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[f.jsx(n.Field,{name:"url",children:s=>f.jsxs("div",{className:"space-y-2",children:[f.jsx(Ot,{htmlFor:s.name,children:"Full Bridge URL (highest priority)"}),f.jsx(Cn,{id:s.name,value:s.state.value,onChange:i=>s.handleChange(i.target.value),onBlur:s.handleBlur,placeholder:"http://192.168.1.100:3001"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Complete URL where the dynamic MCP bridge is running"}),f.jsx(kc,{field:s})]})}),f.jsxs("div",{className:"space-y-2",children:[f.jsx(Ot,{children:"Or configure Host + Port"}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx(n.Field,{name:"host",children:s=>f.jsxs("div",{className:"flex-1",children:[f.jsx(Cn,{value:s.state.value,onChange:i=>s.handleChange(i.target.value),onBlur:s.handleBlur,placeholder:"localhost"}),f.jsx(kc,{field:s})]})}),f.jsx(n.Field,{name:"port",children:s=>f.jsxs("div",{className:"w-20",children:[f.jsx(Cn,{type:"number",value:s.state.value||"",onChange:i=>s.handleChange(parseInt(i.target.value)||void 0),onBlur:s.handleBlur,placeholder:"3001"}),f.jsx(kc,{field:s})]})})]}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Host and port (uses HTTP by default)"})]})]}),f.jsxs("div",{className:"text-sm text-muted-foreground bg-muted/50 p-3 rounded-md",children:[f.jsx("p",{className:"font-medium mb-1",children:"Bridge Detection Priority:"}),f.jsxs("ol",{className:"list-decimal list-inside space-y-1 text-xs",children:[f.jsx("li",{children:"Full URL (if specified above)"}),f.jsx("li",{children:"Host + Port combination (if specified above)"}),f.jsx("li",{children:"Auto-detection fallback: localhost:3001"})]}),f.jsx("p",{className:"mt-2 text-xs",children:"Leave empty for auto-detection. For remote bridge, use full URL or configure host binding."})]})]})]}),f.jsxs(dl,{children:[f.jsx(fl,{children:f.jsx(hl,{className:"text-base",children:"Bridge Setup Instructions"})}),f.jsx(pl,{className:"space-y-3",children:f.jsxs("div",{className:"text-sm space-y-2",children:[f.jsx("p",{className:"font-medium",children:"To use stdio MCP servers, install and run the bridge:"}),f.jsxs("div",{className:"bg-muted p-3 rounded font-mono text-xs",children:[f.jsx("p",{children:"# Start the bridge (from LiteChat project directory)"}),f.jsx("p",{children:"node bin/mcp-bridge.js"}),f.jsx("p",{}),f.jsx("p",{children:"# Or with custom settings"}),f.jsx("p",{children:"node bin/mcp-bridge.js --host 0.0.0.0 --port 3001"})]})]})})]}),f.jsx("div",{className:"flex items-center justify-between pt-3 border-t",children:f.jsx(n.Subscribe,{children:s=>f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(mt,{type:"submit",size:"sm",disabled:!s.canSubmit||s.isSubmitting||s.isValidating||!s.isValid,children:s.isSubmitting?"Saving...":s.isValidating?"Validating...":"Save Bridge Config"}),f.jsxs(mt,{variant:"outline",size:"sm",onClick:r,type:"button",children:[f.jsx(yE,{className:"mr-2 h-4 w-4"}),"Reset"]})]})})})]})}function YKe(){const{retryAttempts:e,retryDelay:t,connectionTimeout:n,maxResponseSize:r,setRetryAttempts:s,setRetryDelay:i,setConnectionTimeout:a,setMaxResponseSize:o}=al(yn(u=>({retryAttempts:u.retryAttempts,retryDelay:u.retryDelay,connectionTimeout:u.connectionTimeout,maxResponseSize:u.maxResponseSize,setRetryAttempts:u.setRetryAttempts,setRetryDelay:u.setRetryDelay,setConnectionTimeout:u.setConnectionTimeout,setMaxResponseSize:u.setMaxResponseSize}))),l=ii({defaultValues:{retryAttempts:e,retryDelay:t,connectionTimeout:n,maxResponseSize:r},validators:{onChangeAsync:GKe,onChangeAsyncDebounceMs:500},onSubmit:async({value:u})=>{s(u.retryAttempts),i(u.retryDelay),a(u.connectionTimeout),o(u.maxResponseSize)}});E.useEffect(()=>{l.reset({retryAttempts:e,retryDelay:t,connectionTimeout:n,maxResponseSize:r})},[e,t,n,r,l]);const c=()=>{window.confirm("Reset connection settings to defaults?")&&(s(3),i(2e3),a(1e4),o(128e3))};return f.jsxs("form",{onSubmit:u=>{u.preventDefault(),u.stopPropagation(),l.handleSubmit()},className:"space-y-6",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"font-medium",children:"Connection Settings"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Configure retry behavior and timeouts for MCP server connections"})]}),f.jsxs(dl,{children:[f.jsxs(fl,{children:[f.jsx(hl,{className:"text-base",children:"Retry Configuration"}),f.jsx(zd,{children:"How LiteChat handles failed connections"})]}),f.jsx(pl,{className:"space-y-4",children:f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[f.jsx(l.Field,{name:"retryAttempts",children:u=>f.jsxs("div",{className:"space-y-2",children:[f.jsx(Ot,{htmlFor:u.name,children:"Retry Attempts"}),f.jsx(Cn,{id:u.name,type:"number",min:"0",max:"10",value:u.state.value,onChange:d=>u.handleChange(parseInt(d.target.value)||0),onBlur:u.handleBlur,placeholder:"3"}),f.jsx(kc,{field:u}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Number of retry attempts (0-10)"})]})}),f.jsx(l.Field,{name:"retryDelay",children:u=>f.jsxs("div",{className:"space-y-2",children:[f.jsx(Ot,{htmlFor:u.name,children:"Retry Delay (ms)"}),f.jsx(Cn,{id:u.name,type:"number",min:"500",max:"30000",step:"500",value:u.state.value,onChange:d=>u.handleChange(parseInt(d.target.value)||2e3),onBlur:u.handleBlur,placeholder:"2000"}),f.jsx(kc,{field:u}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Initial delay between retries (500-30000ms)"})]})}),f.jsx(l.Field,{name:"connectionTimeout",children:u=>f.jsxs("div",{className:"space-y-2",children:[f.jsx(Ot,{htmlFor:u.name,children:"Connection Timeout (ms)"}),f.jsx(Cn,{id:u.name,type:"number",min:"1000",max:"60000",step:"1000",value:u.state.value,onChange:d=>u.handleChange(parseInt(d.target.value)||1e4),onBlur:u.handleBlur,placeholder:"10000"}),f.jsx(kc,{field:u}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Connection timeout (1000-60000ms)"})]})}),f.jsx(l.Field,{name:"maxResponseSize",children:u=>f.jsxs("div",{className:"space-y-2",children:[f.jsx(Ot,{htmlFor:u.name,children:"Max Response Size (bytes)"}),f.jsx(Cn,{id:u.name,type:"number",min:"1000",max:"10000000",step:"1000",value:u.state.value,onChange:d=>u.handleChange(parseInt(d.target.value)||128e3),onBlur:u.handleBlur,placeholder:"128000"}),f.jsx(kc,{field:u}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Max tool response size (1KB-10MB)"})]})})]})})]}),f.jsxs(dl,{children:[f.jsx(fl,{children:f.jsx(hl,{className:"text-base",children:"How It Works"})}),f.jsx(pl,{children:f.jsx("div",{className:"text-sm text-muted-foreground bg-muted/50 p-3 rounded-md",children:f.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[f.jsx("li",{children:"Failed connections will be retried automatically with exponential backoff"}),f.jsx("li",{children:"Toast notifications will show connection status and retry progress"}),f.jsx("li",{children:"Servers that fail all retry attempts will be marked as disconnected"}),f.jsx("li",{children:"You can manually retry connections from the server cards in the Servers tab"}),f.jsxs("li",{children:[f.jsx("strong",{children:"Max Response Size:"})," Tool responses larger than this limit will be automatically truncated to prevent API errors"]})]})})})]}),f.jsx("div",{className:"flex items-center justify-between pt-3 border-t",children:f.jsx(l.Subscribe,{children:u=>f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(mt,{type:"submit",size:"sm",disabled:!u.canSubmit||u.isSubmitting||u.isValidating||!u.isValid,children:u.isSubmitting?"Saving...":u.isValidating?"Validating...":"Save Connection Settings"}),f.jsxs(mt,{variant:"outline",size:"sm",onClick:c,type:"button",children:[f.jsx(yE,{className:"mr-2 h-4 w-4"}),"Reset"]})]})})})]})}function sV({server:e,onSubmit:t,onCancel:n}){const r=ii({defaultValues:{name:(e==null?void 0:e.name)||"",url:(e==null?void 0:e.url)||"",description:(e==null?void 0:e.description)||"",headers:e!=null&&e.headers?JSON.stringify(e.headers,null,2):"",enabled:(e==null?void 0:e.enabled)??!0},validators:{onChangeAsync:HKe,onChangeAsyncDebounceMs:500},onSubmit:async({value:s})=>{t(s)}});return E.useEffect(()=>{r.reset({name:(e==null?void 0:e.name)||"",url:(e==null?void 0:e.url)||"",description:(e==null?void 0:e.description)||"",headers:e!=null&&e.headers?JSON.stringify(e.headers,null,2):"",enabled:(e==null?void 0:e.enabled)??!0})},[e,r]),f.jsxs("form",{onSubmit:s=>{s.preventDefault(),s.stopPropagation(),r.handleSubmit()},className:"space-y-6",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"text-lg font-medium",children:e?"Edit MCP Server":"Add New MCP Server"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:e?"Modify the server configuration below.":"Configure a new MCP server to connect to."})]}),f.jsxs(dl,{children:[f.jsx(fl,{children:f.jsxs(hl,{className:"text-base flex items-center",children:[f.jsx(Q0,{className:"mr-2 h-4 w-4"}),"Server Details"]})}),f.jsxs(pl,{className:"space-y-4",children:[f.jsx(r.Field,{name:"name",children:s=>f.jsxs("div",{className:"space-y-2",children:[f.jsx(Ot,{htmlFor:s.name,children:"Server Name"}),f.jsx(Cn,{id:s.name,value:s.state.value,onChange:i=>s.handleChange(i.target.value),onBlur:s.handleBlur,placeholder:"My MCP Server"}),f.jsx(kc,{field:s})]})}),f.jsx(r.Field,{name:"url",children:s=>f.jsxs("div",{className:"space-y-2",children:[f.jsx(Ot,{htmlFor:s.name,children:"Server URL"}),f.jsx(Cn,{id:s.name,value:s.state.value,onChange:i=>s.handleChange(i.target.value),onBlur:s.handleBlur,placeholder:"https://api.example.com/mcp or stdio://npx?args=-y,@modelcontextprotocol/server-filesystem,."}),f.jsx(kc,{field:s}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"HTTP/HTTPS URLs for remote servers, or stdio://command?args=arg1,arg2 for dynamic bridge servers"})]})}),f.jsx(r.Field,{name:"description",children:s=>f.jsxs("div",{className:"space-y-2",children:[f.jsx(Ot,{htmlFor:s.name,children:"Description (Optional)"}),f.jsx(Uo,{id:s.name,value:s.state.value,onChange:i=>s.handleChange(i.target.value),onBlur:s.handleBlur,placeholder:"Brief description of this server's purpose",rows:2}),f.jsx(kc,{field:s})]})}),f.jsx(r.Field,{name:"headers",children:s=>f.jsxs("div",{className:"space-y-2",children:[f.jsx(Ot,{htmlFor:s.name,children:"Authentication Headers (Optional)"}),f.jsx(Uo,{id:s.name,value:s.state.value,onChange:i=>s.handleChange(i.target.value),onBlur:s.handleBlur,placeholder:'{"Authorization": "Bearer your-token-here"}',rows:3}),f.jsx(kc,{field:s}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"JSON object with authentication headers (not applicable for stdio servers)"})]})}),f.jsx(r.Field,{name:"enabled",children:s=>f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(Oo,{id:s.name,checked:s.state.value,onCheckedChange:s.handleChange}),f.jsx(Ot,{htmlFor:s.name,children:"Enable this server"})]})})]}),f.jsxs(COe,{className:"flex gap-2",children:[f.jsx(r.Subscribe,{selector:s=>[s.canSubmit,s.isSubmitting],children:([s,i])=>f.jsx(mt,{type:"submit",disabled:!s||i,children:i?e?"Updating...":"Adding...":e?"Update Server":"Add Server"})}),f.jsx(mt,{type:"button",variant:"outline",onClick:n,children:"Cancel"})]})]})]})}function ZKe({onNewServer:e,onEditServer:t}){const{servers:n,deleteServer:r,updateServer:s}=al(yn(o=>({servers:o.servers,deleteServer:o.deleteServer,updateServer:o.updateServer}))),i=o=>{window.confirm("Are you sure you want to delete this MCP server?")&&r(o)},a=o=>{s(o.id,{enabled:!o.enabled})};return f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"font-medium",children:"MCP Servers"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Manage your Model Context Protocol servers"})]}),f.jsxs(mt,{onClick:e,children:[f.jsx(jc,{className:"mr-2 h-4 w-4"}),"Add Server"]})]}),n.length===0?f.jsxs("div",{className:"text-center py-12 border-2 border-dashed rounded-lg",children:[f.jsx(Q0,{className:"h-12 w-12 text-muted-foreground mb-4 mx-auto"}),f.jsx("h4",{className:"font-medium text-muted-foreground",children:"No MCP Servers"}),f.jsx("p",{className:"text-sm text-muted-foreground mt-1 mb-4",children:"Add HTTP-based MCP servers to extend LiteChat with additional tools and capabilities"}),f.jsxs(mt,{onClick:e,children:[f.jsx(jc,{className:"mr-2 h-4 w-4"}),"Add Your First Server"]})]}):f.jsxs(lf,{children:[f.jsx(dp,{children:f.jsxs(Ts,{children:[f.jsx(Ar,{children:"Name"}),f.jsx(Ar,{children:"URL"}),f.jsx(Ar,{children:"Status"}),f.jsx(Ar,{children:"Description"}),f.jsx(Ar,{className:"text-right",children:"Actions"})]})}),f.jsx(cf,{children:n.map(o=>f.jsxs(Ts,{children:[f.jsx(Fn,{className:"font-medium",children:o.name}),f.jsx(Fn,{className:"max-w-xs truncate font-mono text-xs",children:o.url}),f.jsx(Fn,{children:f.jsx(is,{variant:o.enabled?"default":"secondary",children:o.enabled?f.jsxs(f.Fragment,{children:[f.jsx(Lpe,{className:"mr-1 h-3 w-3"}),"Enabled"]}):f.jsxs(f.Fragment,{children:[f.jsx(Wpe,{className:"mr-1 h-3 w-3"}),"Disabled"]})})}),f.jsx(Fn,{className:"max-w-xs truncate",children:o.description||""}),f.jsx(Fn,{className:"text-right",children:f.jsxs("div",{className:"flex gap-2 justify-end",children:[f.jsx(Oo,{checked:o.enabled,onCheckedChange:()=>a(o),className:"scale-75"}),f.jsx(mt,{variant:"ghost",size:"sm",onClick:()=>t(o),children:f.jsx(ph,{className:"h-4 w-4"})}),f.jsx(mt,{variant:"ghost",size:"sm",onClick:()=>i(o.id),children:f.jsx(Wge,{className:"h-4 w-4"})})]})})]},o.id))})]})]})}const XKe=()=>{const[e,t]=E.useState("servers"),[n,r]=E.useState(),{addServer:s,updateServer:i}=al(yn(h=>({addServer:h.addServer,updateServer:h.updateServer}))),a=async h=>{try{const m=h.headers?JSON.parse(h.headers):void 0;s({name:h.name,url:h.url,description:h.description,headers:m,enabled:h.enabled}),t("servers")}catch(m){console.error("Invalid headers JSON:",m),Me.error("Invalid JSON in headers field")}},o=async h=>{if(n)try{const m=h.headers?JSON.parse(h.headers):void 0;i(n.id,{name:h.name,url:h.url,description:h.description,headers:m,enabled:h.enabled}),t("servers"),r(void 0)}catch(m){console.error("Invalid headers JSON:",m),Me.error("Invalid JSON in headers field")}},l=()=>{r(void 0),t("new")},c=h=>{r(h),t("edit")},u=()=>{t("servers"),r(void 0)},d=[{value:"servers",label:"Servers",content:f.jsx(ZKe,{onNewServer:l,onEditServer:c})},{value:"bridge",label:"Bridge Config",content:f.jsx(KKe,{})},{value:"connection",label:"Connection",content:f.jsx(YKe,{})},{value:"new",label:"Add Server",content:f.jsx(sV,{onSubmit:a,onCancel:u},"new-server-form")}];return n&&d.push({value:"edit",label:`Edit: ${n.name}`,content:f.jsx(sV,{server:n,onSubmit:o,onCancel:u},`edit-server-form-${n.id}`)}),f.jsx(oc,{tabs:d,initialValue:e,onValueChange:t,defaultValue:"servers",contentContainerClassName:"pb-2 sm:pb-6 pr-1 sm:pr-2 -mr-1 sm:-mr-2",scrollable:!1})},JKe=()=>{const e=E.useMemo(()=>[{value:"prompt",label:"System Prompt",content:f.jsx(IKe,{})},{value:"parameters",label:"Parameters",content:f.jsx(OKe,{})},{value:"tools",label:"Tools",content:f.jsx(FKe,{})},{value:"mcp",label:"MCP",content:f.jsx(XKe,{})},{value:"titles",label:"Auto-Titles",content:f.jsx(BKe,{})},{value:"prompts",label:"Prompts",content:f.jsx(VKe,{})},{value:"agents",label:"Agents",content:f.jsx(WKe,{})}],[]);return f.jsx("div",{className:"space-y-4 p-1 h-full flex flex-col",children:f.jsx(oc,{tabs:e,defaultValue:"prompt",className:"flex-grow",listClassName:"bg-muted/50 rounded-md",contentContainerClassName:"mt-3",scrollable:!1})})},QKe=Ve.memo(JKe);class eYe{constructor(){de(this,"id","core-settings-assistant");de(this,"unregisterCallback",null);de(this,"modApiRef",null);de(this,"eventUnsubscribers",[]);de(this,"isVisible",!1)}async initialize(t){this.modApiRef=t,this.isVisible=br.getState().enableAdvancedSettings;const n=t.on(sn.enableAdvancedSettingsChanged,r=>{typeof r=="object"&&r&&"enabled"in r&&this.isVisible!==r.enabled&&(this.isVisible=r.enabled,this.reregisterTab())});this.eventUnsubscribers.push(n)}reregisterTab(){this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.modApiRef&&this.register(this.modApiRef)}register(t){this.modApiRef=t,this.isVisible?this.unregisterCallback||(this.unregisterCallback=t.registerSettingsTab({id:"assistant",title:"Assistant",component:QKe,order:40})):this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null)}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const tYe=Ke({importSettings:Kn(),importApiKeys:Kn(),importProviderConfigs:Kn(),importProjects:Kn(),importConversations:Kn(),importRulesAndTags:Kn(),importMods:Kn(),importSyncRepos:Kn(),importMcpServers:Kn(),importPromptTemplates:Kn(),importAgents:Kn()}),nYe=Ke({importSettings:Kn(),importApiKeys:Kn(),importProviderConfigs:Kn(),importProjects:Kn(),importConversations:Kn(),importRulesAndTags:Kn(),importMods:Kn(),importSyncRepos:Kn(),importMcpServers:Kn(),importPromptTemplates:Kn(),importAgents:Kn()}),rYe=()=>{const{importConversation:e,exportAllConversations:t}=qn(yn(N=>({importConversation:N.importConversation,exportAllConversations:N.exportAllConversations}))),n=E.useRef(null),r=E.useRef(null),[s,i]=E.useState(!1),[a,o]=E.useState(!1),[l,c]=E.useState(!1),[u,d]=E.useState(!1),[h,m]=E.useState(!1),y=ii({defaultValues:{importSettings:!0,importApiKeys:!0,importProviderConfigs:!0,importProjects:!0,importConversations:!0,importRulesAndTags:!0,importMods:!0,importSyncRepos:!0,importMcpServers:!0,importPromptTemplates:!0,importAgents:!0},validators:{onChange:tYe}}),b=ii({defaultValues:{importSettings:!0,importApiKeys:!0,importProviderConfigs:!0,importProjects:!0,importConversations:!0,importRulesAndTags:!0,importMods:!0,importSyncRepos:!0,importMcpServers:!0,importPromptTemplates:!0,importAgents:!0},validators:{onChange:nYe}}),v=()=>{var N;(N=n.current)==null||N.click()},x=()=>{var N;(N=r.current)==null||N.click()},w=E.useCallback(async N=>{var P;const I=(P=N.target.files)==null?void 0:P[0];if(I){i(!0);try{await e(I)}catch(B){console.error("Import failed (from component):",B)}finally{n.current&&(n.current.value=""),i(!1)}}},[e]),S=E.useCallback(async N=>{var P;const I=(P=N.target.files)==null?void 0:P[0];if(I){if(!window.confirm("Importing this file will OVERWRITE existing data for the selected categories. Are you sure you want to proceed?")){r.current&&(r.current.value="");return}m(!0);try{await _0.importFullConfiguration(I,y.state.values)}catch(B){console.error("Full import failed (from component):",B)}finally{r.current&&(r.current.value=""),m(!1)}}},[y]),k=E.useCallback(async()=>{o(!0);try{await t()}catch(N){console.error("Export all failed (from component):",N)}finally{o(!1)}},[t]),C=E.useCallback(async()=>{d(!0);try{await _0.exportFullConfiguration(b.state.values)}catch(N){console.error("Full export failed (from component):",N)}finally{d(!1)}},[b]),T=E.useCallback(async()=>{if(window.confirm(` ARE YOU ABSOLUTELY SURE? 

This will permanently delete ALL conversations, messages, mods, settings, providers, and stored API keys from your browser. This action cannot be undone.`)&&window.confirm(`SECOND CONFIRMATION:

Really delete everything? Consider exporting first.`)){c(!0);try{await _t.clearAllData(),Me.success("All local data cleared. Reloading the application..."),setTimeout(()=>window.location.reload(),1500)}catch(N){const I="Failed to clear all data";console.error(I,N),Me.error(`${I}: ${N instanceof Error?N.message:String(N)}`),c(!1)}}},[]),R=(N,I,P,B,D,W)=>{const O=`${W}-${I}-checkbox`;return f.jsx(N.Field,{name:I,children:Z=>f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx($c,{id:O,checked:Z.state.value,onCheckedChange:U=>Z.handleChange(!!U),disabled:D}),f.jsxs(Ot,{htmlFor:O,className:"text-sm font-normal flex items-center gap-1.5",children:[f.jsx(B,{className:"h-4 w-4 text-muted-foreground"})," ",P]})]})},I)};return f.jsxs("div",{className:"space-y-4 p-1",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"text-lg font-medium mb-2",children:"Single Conversation"}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[f.jsxs("div",{className:"border p-3 rounded-md space-y-2",children:[f.jsx(Ot,{className:"font-semibold",children:"Import Conversation"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Import a previously exported single conversation (.json file)."}),f.jsx("input",{type:"file",ref:n,onChange:w,accept:".json",className:"hidden",id:"import-file-input",disabled:s}),f.jsxs(mt,{onClick:v,variant:"outline",size:"sm",disabled:s,children:[s?f.jsx(Xn,{className:"mr-2 h-4 w-4 animate-spin"}):f.jsx(EH,{className:"mr-2 h-4 w-4"}),s?"Importing...":"Select File..."]})]}),f.jsxs("div",{className:"border p-3 rounded-md space-y-2",children:[f.jsx(Ot,{className:"font-semibold",children:"Export All Conversations"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Export all conversations and messages into a single JSON file."}),f.jsxs(mt,{onClick:k,variant:"outline",size:"sm",disabled:a,children:[a?f.jsx(Xn,{className:"mr-2 h-4 w-4 animate-spin"}):f.jsx(Ec,{className:"mr-2 h-4 w-4"}),a?"Exporting...":"Export All Chats"]})]})]})]}),f.jsx(jm,{}),f.jsxs("div",{children:[f.jsx("h3",{className:"text-lg font-medium mb-2",children:"Full Configuration Backup"}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[f.jsxs("div",{className:"border p-3 rounded-md space-y-3",children:[f.jsx(Ot,{className:"font-semibold",children:"Import Full Configuration"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Import settings, providers, keys, projects, conversations, etc., from a backup file. Select which data types to restore."}),f.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-2 pt-2",children:[R(y,"importSettings","Settings",aC,h,"import"),R(y,"importApiKeys","API Keys",Hx,h,"import"),R(y,"importProviderConfigs","Providers",Q0,h,"import"),R(y,"importProjects","Projects",kB,h,"import"),R(y,"importConversations","Conversations",J3,h,"import"),R(y,"importRulesAndTags","Rules & Tags",Q3,h,"import"),R(y,"importMods","Mods",RB,h,"import"),R(y,"importSyncRepos","Sync Repos",Ic,h,"import"),R(y,"importMcpServers","MCP Servers",AB,h,"import"),R(y,"importPromptTemplates","Prompt Templates",X3,h,"import"),R(y,"importAgents","Agents",X0,h,"import")]}),f.jsx("input",{type:"file",ref:r,onChange:S,accept:".json",className:"hidden",id:"full-import-file-input",disabled:h}),f.jsxs(mt,{onClick:x,variant:"outline",size:"sm",disabled:h,children:[h?f.jsx(Xn,{className:"mr-2 h-4 w-4 animate-spin"}):f.jsx(bme,{className:"mr-2 h-4 w-4"}),h?"Importing...":"Select Backup File..."]})]}),f.jsxs("div",{className:"border p-3 rounded-md space-y-3",children:[f.jsx(Ot,{className:"font-semibold",children:"Export Full Configuration"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Export all settings, providers, keys, projects, conversations, rules, tags, mods, etc., into a single backup file. Select which data types to include."}),f.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-2 pt-2",children:[R(b,"importSettings","Settings",aC,u,"export"),R(b,"importApiKeys","API Keys",Hx,u,"export"),R(b,"importProviderConfigs","Providers",Q0,u,"export"),R(b,"importProjects","Projects",kB,u,"export"),R(b,"importConversations","Conversations",J3,u,"export"),R(b,"importRulesAndTags","Rules & Tags",Q3,u,"export"),R(b,"importMods","Mods",RB,u,"export"),R(b,"importSyncRepos","Sync Repos",Ic,u,"export"),R(b,"importMcpServers","MCP Servers",AB,u,"export"),R(b,"importPromptTemplates","Prompt Templates",X3,u,"export"),R(b,"importAgents","Agents",X0,u,"export")]}),f.jsxs(mt,{onClick:C,variant:"secondary",size:"sm",disabled:u,children:[u?f.jsx(Xn,{className:"mr-2 h-4 w-4 animate-spin"}):f.jsx(dme,{className:"mr-2 h-4 w-4"}),u?"Exporting...":"Export Configuration"]})]})]})]}),f.jsxs("div",{className:"border-t pt-6 border-destructive/50",children:[f.jsx("h3",{className:"text-lg font-medium text-destructive mb-2",children:"Danger Zone"}),f.jsx("p",{className:"text-sm text-destructive/90 mb-3",children:"Be very careful with these actions. Data loss may be permanent."}),f.jsxs(mt,{onClick:T,variant:"destructive",disabled:l,children:[l?f.jsx(Xn,{className:"mr-2 h-4 w-4 animate-spin"}):f.jsx(Mo,{className:"mr-2 h-4 w-4"}),l?"Clearing Data...":"Clear All Local Data (Conversations, Keys, Settings, etc.)"]})]})]})},sYe=Ve.memo(rYe);class iYe{constructor(){de(this,"id","core-settings-data");de(this,"unregisterCallback",null)}async initialize(t){}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerSettingsTab({id:"data",title:"Data",component:sYe,order:70})}destroy(){this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),console.log(`[${this.id}] Destroyed.`)}}const aYe=()=>{const{loadedMods:e,addDbMod:t,updateDbMod:n,deleteDbMod:r,dbMods:s,isLoading:i}=jh(yn(T=>({loadedMods:T.loadedMods,addDbMod:T.addDbMod,updateDbMod:T.updateDbMod,deleteDbMod:T.deleteDbMod,dbMods:T.dbMods,isLoading:T.isLoading}))),[a,o]=E.useState(""),[l,c]=E.useState(""),[u,d]=E.useState(""),[h,m]=E.useState(!1),[y,b]=E.useState({}),[v,x]=E.useState({}),w=E.useCallback(async()=>{if(!a.trim()){Me.error("Mod name cannot be empty.");return}if(!l.trim()&&!u.trim()){Me.error("Either Mod URL or Script Content must be provided.");return}if(l.trim()&&u.trim()){Me.error("Provide either a Mod URL or Script Content, not both.");return}m(!0);try{const T={name:a.trim(),sourceUrl:l.trim()||null,scriptContent:u.trim()||null,enabled:!0,loadOrder:((s==null?void 0:s.length)??1)*10};await t(T),o(""),c(""),d(""),Me.info("Mod added. Reload required for changes to take effect.")}catch(T){console.error("Failed to add mod (from component):",T)}finally{m(!1)}},[a,l,u,t,s==null?void 0:s.length]),S=E.useCallback(async T=>{b(R=>({...R,[T.id]:!0}));try{await n(T.id,{enabled:!T.enabled}),Me.info(`Mod "${T.name}" ${T.enabled?"disabled":"enabled"}. Reload required for changes to take effect.`)}catch(R){console.error("Failed to update mod (from component):",R)}finally{b(R=>({...R,[T.id]:!1}))}},[n]),k=E.useCallback(async T=>{if(window.confirm(`Are you sure you want to delete the mod "${T.name}"? This cannot be undone.`)){x(R=>({...R,[T.id]:!0}));try{await r(T.id),Me.info("Mod deleted. Reload required for changes to take effect.")}catch(R){console.error("Failed to delete mod (from component):",R)}finally{x(R=>({...R,[T.id]:!1}))}}},[r]),C=E.useCallback(T=>{const R=e.find(I=>I.id===T);if(R)if(R.error){const I=R.error instanceof Error?R.error.message:String(R.error);return{status:"Error",error:R.error,tooltip:I}}else return{status:"Loaded"};const N=(s||[]).find(I=>I.id===T);return N?N.enabled?{status:"Load Pending (Reload Required)"}:{status:"Disabled"}:{status:"Unknown"}},[e,s]);return f.jsxs("div",{className:"space-y-6 p-1",children:[f.jsxs(Ese,{variant:"destructive",className:"border-destructive/50",children:[f.jsx(HO,{className:"h-4 w-4"}),f.jsx(Tse,{children:"Security Warning"}),f.jsx(Ase,{children:"Running mods from untrusted sources can compromise your security and privacy. Mods execute arbitrary JavaScript code within LiteChat and can potentially access sensitive data like API keys stored in the browser or interact with external services. Only install mods you trust. LiteChat is not responsible for any damage caused by mods."})]}),f.jsxs("div",{className:"space-y-4 rounded-md border p-4",children:[f.jsx("h3",{className:"text-lg font-medium",children:"Add New Mod"}),f.jsxs("div",{className:"space-y-2",children:[f.jsx(Ot,{htmlFor:"mod-name",children:"Mod Name"}),f.jsx(Cn,{id:"mod-name",value:a,onChange:T=>o(T.target.value),placeholder:"My Awesome Mod",disabled:h})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx(Ot,{htmlFor:"mod-url",children:"Source URL (Optional)"}),f.jsx(Cn,{id:"mod-url",type:"url",value:l,onChange:T=>c(T.target.value),placeholder:"https://example.com/my-mod.js",disabled:h||!!u.trim()})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx(Ot,{htmlFor:"mod-script",children:"Script Content (Optional)"}),f.jsx(Uo,{id:"mod-script",value:u,onChange:T=>d(T.target.value),placeholder:`/* Paste your mod script here */
// Example: modApi.log('log', 'My Mod Loaded!');`,className:"min-h-[100px] font-mono text-xs",disabled:h||!!l.trim()})]}),f.jsxs(mt,{onClick:w,disabled:h,children:[h&&f.jsx(Xn,{className:"mr-2 h-4 w-4 animate-spin"}),h?"Adding...":"Add Mod"]})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx("h3",{className:"text-lg font-medium",children:"Installed Mods"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Enable or disable mods below. A page reload is required for changes to fully take effect."}),f.jsx("div",{className:"rounded-md border",children:f.jsx(xr,{delayDuration:100,children:f.jsxs(lf,{children:[f.jsx(dp,{children:f.jsxs(Ts,{children:[f.jsx(Ar,{children:"Name"}),f.jsx(Ar,{children:"Source"}),f.jsx(Ar,{children:"Status"}),f.jsx(Ar,{className:"text-center",children:"Enabled"}),f.jsx(Ar,{className:"text-right",children:"Actions"})]})}),f.jsx(cf,{children:i?f.jsxs(f.Fragment,{children:[f.jsx(Ts,{children:f.jsx(Fn,{colSpan:5,children:f.jsx(Wr,{className:"h-10 w-full"})})}),f.jsx(Ts,{children:f.jsx(Fn,{colSpan:5,children:f.jsx(Wr,{className:"h-10 w-full"})})})]}):(s||[]).length===0?f.jsx(Ts,{children:f.jsx(Fn,{colSpan:5,className:"h-24 text-center",children:"No mods installed yet."})}):(s||[]).map(T=>{const{status:R,error:N,tooltip:I}=C(T.id),P=T.sourceUrl?new URL(T.sourceUrl).hostname:"Direct Script",B=y[T.id],D=v[T.id],W=B||D,O=R==="Error";return f.jsxs(Ts,{children:[f.jsx(Fn,{className:"font-medium",children:T.name}),f.jsx(Fn,{className:"text-muted-foreground",children:P}),f.jsxs(Fn,{children:[f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx("span",{className:O?"text-destructive font-semibold cursor-help":"",children:R})}),I&&f.jsx(Sr,{className:"max-w-xs break-words",children:f.jsx("p",{children:I})})]}),O&&N&&f.jsx("p",{className:"text-xs text-destructive truncate",children:N instanceof Error?N.message:String(N)})]}),f.jsxs(Fn,{className:"text-center",children:[f.jsx(Oo,{checked:T.enabled??!1,onCheckedChange:()=>S(T),disabled:W,"aria-label":`Enable ${T.name}`}),B&&f.jsx(Xn,{className:"h-4 w-4 animate-spin inline-block ml-2"})]}),f.jsx(Fn,{className:"text-right",children:f.jsx(mt,{variant:"ghost",size:"icon",onClick:()=>k(T),disabled:W,"aria-label":`Delete ${T.name}`,className:"text-destructive hover:text-destructive/80",children:D?f.jsx(Xn,{className:"h-4 w-4 animate-spin"}):f.jsx(Mo,{className:"h-4 w-4"})})})]},T.id)})})]})})})]})]})},oYe=Ve.memo(aYe);class lYe{constructor(){de(this,"id","core-settings-mods");de(this,"unregisterCallback",null)}async initialize(t){}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerSettingsTab({id:"mods",title:"Mods",component:oYe,order:80})}destroy(){this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),console.log(`[${this.id}] Destroyed.`)}}const cYe=({interactionId:e,contentToCopy:t,disabled:n})=>{const[r]=E.useState(!1),s=E.useCallback(async i=>{if(i.stopPropagation(),n||!t){Me.info("No content to copy or action disabled.");return}Pe.emit(Sa.copyInteractionResponseRequest,{interactionId:e})},[e,t,n]);return f.jsx(Un,{tooltipText:"Copy",onClick:s,"aria-label":"Copy content",disabled:n||!t,icon:r?f.jsx(ao,{className:"text-green-500"}):f.jsx(pE,{}),className:"h-5 w-5"})};class uYe{constructor(){de(this,"id","core-canvas-copy-action")}async initialize(t){}register(t){t.registerCanvasControl({id:this.id,type:"interaction",targetSlot:"header-actions",renderer:n=>n.interactionId?Ve.createElement(cYe,{interactionId:n.interactionId,contentToCopy:n.responseContent??"",disabled:!n.responseContent||n.responseContent.trim()===""}):(console.warn("CopyActionControlModule: interactionId is missing in context for an interaction control."),null)})}destroy(t){}}const dYe=({interactionId:e,disabled:t})=>{const n=r=>{if(r.stopPropagation(),t){Me.info("Regeneration is currently disabled.");return}Pe.emit(Sa.regenerateInteractionRequest,{interactionId:e})};return f.jsx(Un,{tooltipText:"Regenerate",onClick:n,"aria-label":"Regenerate Response",disabled:t,icon:f.jsx(vm,{}),className:"h-5 w-5 md:h-6 md:w-6"})};class fYe{constructor(){de(this,"id","core-canvas-regenerate-action")}async initialize(t){}register(t){t.registerCanvasControl({id:this.id,type:"interaction",targetSlot:"actions",renderer:n=>{if(!n.interactionId||!n.interaction)return null;const r=n.interaction,s=vn.getState(),i=s.status,a=s.interactions.filter(u=>u.conversationId===r.conversationId&&u.parentId===null&&(u.type==="message.user_assistant"||u.type==="message.assistant_regen"));a.sort((u,d)=>u.index-d.index);const o=a.length>0?a[a.length-1]:null,l=(o==null?void 0:o.id)===r.id,c=l&&(r.status==="COMPLETED"||r.status==="ERROR")&&i!=="streaming";return l?Ve.createElement(dYe,{interactionId:r.id,disabled:!c}):null}})}destroy(t){}}const hYe=({module:e,interactionId:t,disabled:n})=>{const[r,s]=E.useState(!1),[,i]=E.useState({});E.useEffect(()=>{if(e)return e.setNotifyCallback(()=>i({})),()=>e.setNotifyCallback(null)},[e]);const a=l=>{if(!l){s(!1);return}s(!1),Pe.emit(Sa.regenerateInteractionWithModelRequest,{interactionId:t,modelId:l})},o=l=>{if(l.stopPropagation(),n){Me.info("Regeneration is currently disabled.");return}s(!r)};return r?f.jsx("div",{className:"relative",children:f.jsx(WT,{models:e.globallyEnabledModels,value:null,onChange:a,isLoading:e.isLoadingProviders})}):f.jsx(Un,{tooltipText:"Regenerate with Model",onClick:o,"aria-label":"Regenerate Response with Model Selection",disabled:n,icon:f.jsx(Kme,{}),className:"h-5 w-5 md:h-6 md:w-6"})};class pYe{constructor(){de(this,"id","core-canvas-regenerate-with-model-action");de(this,"eventUnsubscribers",[]);de(this,"notifyComponentUpdate",null);de(this,"globallyEnabledModels",[]);de(this,"isLoadingProviders",!0)}async initialize(t){const n=Cr.getState();this.isLoadingProviders=n.isLoading,this.globallyEnabledModels=n.getGloballyEnabledModelDefinitions();const r=t.on(Qn.globallyEnabledModelsUpdated,a=>{var c;let o=!1;JSON.stringify(this.globallyEnabledModels)!==JSON.stringify(a.models)&&(this.globallyEnabledModels=a.models,o=!0);const l=Cr.getState().isLoading;this.isLoadingProviders!==l&&(this.isLoadingProviders=l,o=!0),o&&((c=this.notifyComponentUpdate)==null||c.call(this))}),s=t.on(Qn.initialDataLoaded,()=>{var c;const a=Cr.getState();let o=!1;this.isLoadingProviders!==a.isLoading&&(this.isLoadingProviders=a.isLoading,o=!0);const l=a.getGloballyEnabledModelDefinitions();JSON.stringify(this.globallyEnabledModels)!==JSON.stringify(l)&&(this.globallyEnabledModels=l,o=!0),o&&((c=this.notifyComponentUpdate)==null||c.call(this))}),i=t.on(Zn.statusChanged,()=>{var a;(a=this.notifyComponentUpdate)==null||a.call(this)});this.eventUnsubscribers.push(r,s,i)}setNotifyCallback(t){this.notifyComponentUpdate=t}register(t){t.registerCanvasControl({id:this.id,type:"interaction",targetSlot:"actions",renderer:n=>{if(!n.interactionId||!n.interaction)return null;const r=n.interaction,s=vn.getState(),i=s.status,a=s.interactions.filter(u=>u.conversationId===r.conversationId&&u.parentId===null&&(u.type==="message.user_assistant"||u.type==="message.assistant_regen"));a.sort((u,d)=>u.index-d.index);const o=a.length>0?a[a.length-1]:null,l=(o==null?void 0:o.id)===r.id,c=l&&(r.status==="COMPLETED"||r.status==="ERROR")&&i!=="streaming";return l?Ve.createElement(hYe,{module:this,interactionId:r.id,disabled:!c}):null}})}async cleanup(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.notifyComponentUpdate=null}async destroy(){await this.cleanup()}}const mYe=({interactionId:e,disabled:t})=>{const n=r=>{if(r.stopPropagation(),t){Me.info("Fork is currently disabled.");return}Pe.emit(Sa.forkConversationRequest,{interactionId:e})};return f.jsx(Un,{tooltipText:"Fork",onClick:n,"aria-label":"Fork Conversation",disabled:t,icon:f.jsx(_H,{}),className:"h-5 w-5 md:h-6 md:w-6"})};class gYe{constructor(){de(this,"id","core-canvas-fork-action")}async initialize(t){}register(t){t.registerCanvasControl({id:this.id,type:"interaction",targetSlot:"actions",renderer:n=>{if(!n.interactionId||!n.interaction)return null;const r=n.interaction,s=vn.getState(),i=s.status,a=s.interactions.filter(u=>u.conversationId===r.conversationId&&u.parentId===null&&(u.type==="message.user_assistant"||u.type==="message.assistant_regen"));a.sort((u,d)=>u.index-d.index);const o=a.length>0?a[a.length-1]:null;if((o==null?void 0:o.id)===r.id)return null;const c=(r.status==="COMPLETED"||r.status==="ERROR")&&i!=="streaming";return Ve.createElement(mYe,{interactionId:r.id,disabled:!c})}})}destroy(t){}}const yYe=({module:e,interactionId:t,disabled:n})=>{const[r,s]=E.useState(!1),[,i]=E.useState({});E.useEffect(()=>{if(e)return e.setNotifyCallback(()=>i({})),()=>e.setNotifyCallback(null)},[e]);const a=l=>{if(!l){s(!1);return}s(!1),Pe.emit(Sa.forkConversationWithModelRequest,{interactionId:t,modelId:l})},o=l=>{if(l.stopPropagation(),n){Me.info("Fork is currently disabled.");return}s(!r)};return r?f.jsx("div",{className:"relative",children:f.jsx(WT,{models:e.globallyEnabledModels,value:null,onChange:a,isLoading:e.isLoadingProviders})}):f.jsx(Un,{tooltipText:"Fork with",onClick:o,"aria-label":"Fork Conversation with Model Selection",disabled:n,icon:f.jsxs("div",{className:"relative",children:[f.jsx(_H,{className:"h-4 w-4"}),f.jsx(jc,{className:"absolute -top-1 -right-1 h-2 w-2"})]}),className:"h-5 w-5 md:h-6 md:w-6"})};class bYe{constructor(){de(this,"id","core-canvas-fork-with-model-action");de(this,"eventUnsubscribers",[]);de(this,"notifyComponentUpdate",null);de(this,"globallyEnabledModels",[]);de(this,"isLoadingProviders",!0)}async initialize(t){const n=Cr.getState();this.isLoadingProviders=n.isLoading,this.globallyEnabledModels=n.getGloballyEnabledModelDefinitions();const r=t.on(Qn.globallyEnabledModelsUpdated,a=>{var c;let o=!1;JSON.stringify(this.globallyEnabledModels)!==JSON.stringify(a.models)&&(this.globallyEnabledModels=a.models,o=!0);const l=Cr.getState().isLoading;this.isLoadingProviders!==l&&(this.isLoadingProviders=l,o=!0),o&&((c=this.notifyComponentUpdate)==null||c.call(this))}),s=t.on(Qn.initialDataLoaded,()=>{var c;const a=Cr.getState();let o=!1;this.isLoadingProviders!==a.isLoading&&(this.isLoadingProviders=a.isLoading,o=!0);const l=a.getGloballyEnabledModelDefinitions();JSON.stringify(this.globallyEnabledModels)!==JSON.stringify(l)&&(this.globallyEnabledModels=l,o=!0),o&&((c=this.notifyComponentUpdate)==null||c.call(this))}),i=t.on(Zn.statusChanged,()=>{var a;(a=this.notifyComponentUpdate)==null||a.call(this)});this.eventUnsubscribers.push(r,s,i)}setNotifyCallback(t){this.notifyComponentUpdate=t}register(t){t.registerCanvasControl({id:this.id,type:"interaction",targetSlot:"actions",renderer:n=>{if(!n.interactionId||!n.interaction)return null;const r=n.interaction,s=vn.getState(),i=s.status,a=s.interactions.filter(u=>u.conversationId===r.conversationId&&u.parentId===null&&(u.type==="message.user_assistant"||u.type==="message.assistant_regen"));a.sort((u,d)=>u.index-d.index);const o=a.length>0?a[a.length-1]:null;if((o==null?void 0:o.id)===r.id)return null;const c=(r.status==="COMPLETED"||r.status==="ERROR")&&i!=="streaming";return Ve.createElement(yYe,{module:this,interactionId:r.id,disabled:!c})}})}async cleanup(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.notifyComponentUpdate=null}async destroy(){await this.cleanup()}}const vYe=({interactionId:e,currentRating:t})=>{const[n,r]=E.useState(!1),s=c=>{const u=c===t?null:c;Pe.emit(Zn.rateInteractionRequest,{interactionId:e,rating:u}),r(!1)},i=Array.from({length:11},(c,u)=>u-5);let a="text-muted-foreground",o="",l="hover:text-foreground";return t!=null&&(t<0?(a="text-red-500",o="fill-red-500"):t===0?(a="text-gray-500",o="fill-gray-500"):(a="text-green-500",o="fill-green-500")),f.jsxs(sc,{open:n,onOpenChange:r,children:[f.jsx(ic,{asChild:!0,children:f.jsx(Un,{tooltipText:t!=null?`Rating: ${t}`:"Rate response",onClick:()=>r(!n),"aria-label":"Rate response",icon:f.jsx(IB,{className:Xe(o,t!=null?"fill-current":"fill-none")}),variant:"ghost",className:Xe("h-4 w-4 md:h-5 md:w-5 p-0",a,l)})}),f.jsx(ac,{className:"w-80 p-4",align:"start",children:f.jsxs("div",{className:"space-y-3",children:[f.jsx("div",{className:"text-sm font-medium",children:"Rate this response"}),f.jsx("div",{className:"grid grid-cols-11 gap-1",children:i.map(c=>{let u="";c===-5?u="Terrible":c===-4?u="Very Bad":c===-3?u="Bad":c===-2?u="Poor":c===-1?u="Below Average":c===0?u="Neutral":c===1?u="Above Average":c===2?u="Good":c===3?u="Very Good":c===4?u="Excellent":c===5&&(u="Perfect");let d="text-muted-foreground",h="hover:text-foreground",m="";c<0?(h="hover:text-red-500",t===c&&(d="text-red-500",m="fill-red-500")):c===0?(h="hover:text-gray-500",t===c&&(d="text-gray-500",m="fill-gray-500")):(h="hover:text-green-500",t===c&&(d="text-green-500",m="fill-green-500"));const y=t===c?"bg-muted":"";return f.jsx(Un,{tooltipText:`${c}: ${u}`,onClick:()=>s(c),"aria-label":`Rate response as ${u} (${c})`,icon:f.jsx(IB,{className:Xe(m,t===c?"fill-current":"fill-none")}),variant:"ghost",className:Xe("h-6 w-6 p-0",d,h,y)},c)})}),f.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[f.jsx("span",{children:"-5 (Terrible)"}),f.jsx("span",{children:"0 (Neutral)"}),f.jsx("span",{children:"+5 (Perfect)"})]}),t!=null&&f.jsx("div",{className:"pt-2 border-t",children:f.jsx("button",{onClick:()=>s(null),className:"text-xs text-muted-foreground hover:text-foreground",children:"Clear rating"})})]})})]})};class xYe{constructor(){de(this,"id","core-canvas-rating-action")}async initialize(t){}register(t){t.registerCanvasControl({id:this.id,type:"interaction",targetSlot:"actions",renderer:n=>!n.interactionId||!n.interaction?null:Ve.createElement(vYe,{interactionId:n.interactionId,currentRating:n.interaction.rating})})}destroy(t){}}const wYe=({interactionId:e,response:t,disabled:n})=>{const[r,s]=E.useState(!1),[i,a]=E.useState(""),o=u=>{if(u.stopPropagation(),n){Me.info("Response editing is currently disabled.");return}a(t||""),s(!0)},l=()=>{if(i.trim()===""){Me.error("Response cannot be empty");return}Pe.emit(Sa.editResponseRequest,{interactionId:e,newContent:i.trim()}),s(!1),Me.success("Response edited successfully")},c=()=>{s(!1),a("")};return f.jsxs(f.Fragment,{children:[f.jsx(Un,{tooltipText:"Edit Response",onClick:o,"aria-label":"Edit Assistant Response",disabled:n,icon:f.jsx(WO,{}),className:"h-5 max-w-7xl md:h-6 md:max-w-6xl"}),f.jsx(op,{open:r,onOpenChange:s,children:f.jsxs(lp,{className:"!w-[80vw] !h-[85vh] !max-w-none flex flex-col",children:[f.jsx(cp,{children:f.jsx(up,{children:"Edit Assistant Response"})}),f.jsx("div",{className:"flex-1 space-y-4 overflow-hidden",children:f.jsxs("div",{className:"space-y-2 h-full",children:[f.jsx(Ot,{htmlFor:"response-edit",children:"Response Content"}),f.jsx(Uo,{id:"response-edit",value:i,onChange:u=>a(u.target.value),placeholder:"Edit the assistant's response...",className:"min-h-[60vh] h-full resize-none text-sm leading-relaxed"})]})}),f.jsxs(gb,{className:"flex-shrink-0",children:[f.jsx(mt,{variant:"outline",onClick:c,children:"Cancel"}),f.jsx(mt,{onClick:l,children:"Save Changes"})]})]})})]})};class _Ye{constructor(){de(this,"id","core-canvas-edit-response-action");de(this,"eventUnsubscribers",[])}async initialize(t){const n=t.on(Sa.editResponseRequest,async r=>{await this.handleResponseEdit(r.interactionId,r.newContent)});this.eventUnsubscribers.push(n)}async handleResponseEdit(t,n){var r;try{const s=vn.getState(),i=s.interactions.find(y=>y.id===t);if(!i)throw new Error("Original interaction not found");if(i.status!=="COMPLETED")throw new Error("Can only edit completed interactions");const a=as(),o={...i,id:a,response:n,parentId:null,index:i.index,metadata:{...i.metadata,editedResponse:!0,editedFromId:i.id},endedAt:new Date};s._addInteractionToState(o);const l=s.interactions.filter(y=>y.parentId===i.id),c=[];let u=i;for(;u;){c.push(u);const y=(r=u.metadata)==null?void 0:r.editedFromId;y?u=s.interactions.find(b=>b.id===y):u=void 0}const d=c.sort((y,b)=>{var w,S;const v=((w=y.startedAt)==null?void 0:w.getTime())??0,x=((S=b.startedAt)==null?void 0:S.getTime())??0;return v-x}),h=d.map(async(y,b)=>{const v={parentId:a,index:b,metadata:{...y.metadata,originalVersion:b===0}};return console.log(`[EditResponseControlModule] Updating version ${y.id} to be child of ${a} with childIndex ${b}`),s._updateInteractionInState(y.id,v),_t.saveInteraction({...y,...v})}),m=l.map(async y=>{const b={parentId:a,index:d.length+y.index};return s._updateInteractionInState(y.id,b),_t.saveInteraction({...y,...b})});await Promise.all([_t.saveInteraction(o),...h,...m]),console.log(`[EditResponseControlModule] Response edited successfully. Original: ${t}, Edited: ${a}`)}catch(s){throw console.error("[EditResponseControlModule] Failed to edit response:",s),s}}register(t){t.registerCanvasControl({id:this.id,type:"interaction",targetSlot:"actions",renderer:n=>{if(!n.interactionId||!n.interaction)return null;const r=n.interaction,i=vn.getState().status,a=r.status==="COMPLETED"&&r.response&&typeof r.response=="string"&&i!=="streaming"&&(r.type==="message.user_assistant"||r.type==="message.assistant_regen");return a?Ve.createElement(wYe,{interactionId:r.id,response:r.response,disabled:!a}):null}})}async cleanup(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[]}async destroy(){await this.cleanup()}}var xo={},iV;function SYe(){if(iV)return xo;iV=1;var e=xo&&xo.__assign||function(){return e=Object.assign||function(C){for(var T,R=1,N=arguments.length;R<N;R++){T=arguments[R];for(var I in T)Object.prototype.hasOwnProperty.call(T,I)&&(C[I]=T[I])}return C},e.apply(this,arguments)},t=xo&&xo.__createBinding||(Object.create?function(C,T,R,N){N===void 0&&(N=R);var I=Object.getOwnPropertyDescriptor(T,R);(!I||("get"in I?!T.__esModule:I.writable||I.configurable))&&(I={enumerable:!0,get:function(){return T[R]}}),Object.defineProperty(C,N,I)}:function(C,T,R,N){N===void 0&&(N=R),C[N]=T[R]}),n=xo&&xo.__setModuleDefault||(Object.create?function(C,T){Object.defineProperty(C,"default",{enumerable:!0,value:T})}:function(C,T){C.default=T}),r=xo&&xo.__importStar||function(C){if(C&&C.__esModule)return C;var T={};if(C!=null)for(var R in C)R!=="default"&&Object.prototype.hasOwnProperty.call(C,R)&&t(T,C,R);return n(T,C),T},s=xo&&xo.__rest||function(C,T){var R={};for(var N in C)Object.prototype.hasOwnProperty.call(C,N)&&T.indexOf(N)<0&&(R[N]=C[N]);if(C!=null&&typeof Object.getOwnPropertySymbols=="function")for(var I=0,N=Object.getOwnPropertySymbols(C);I<N.length;I++)T.indexOf(N[I])<0&&Object.prototype.propertyIsEnumerable.call(C,N[I])&&(R[N[I]]=C[N[I]]);return R};Object.defineProperty(xo,"__esModule",{value:!0});var i=r(By()),a=89,o=90,l=77,c=57,u=219,d=222,h=192,m=100,y=3e3,b=typeof window<"u"&&"navigator"in window&&/Win/i.test(navigator.platform),v=typeof window<"u"&&"navigator"in window&&/(Mac|iPhone|iPod|iPad)/i.test(navigator.platform),x="npm__react-simple-code-editor__textarea",w=`
/**
 * Reset the text fill color so that placeholder is visible
 */
.`.concat(x,`:empty {
  -webkit-text-fill-color: inherit !important;
}

/**
 * Hack to apply on some CSS on IE10 and IE11
 */
@media all and (-ms-high-contrast: none), (-ms-high-contrast: active) {
  /**
    * IE doesn't support '-webkit-text-fill-color'
    * So we use 'color: transparent' to make the text transparent on IE
    * Unlike other browsers, it doesn't affect caret color in IE
    */
  .`).concat(x,` {
    color: transparent !important;
  }

  .`).concat(x,`::selection {
    background-color: #accef7 !important;
    color: transparent !important;
  }
}
`),S=i.forwardRef(function(T,R){var N=T.autoFocus,I=T.disabled,P=T.form,B=T.highlight,D=T.ignoreTabKey,W=D===void 0?!1:D,O=T.insertSpaces,Z=O===void 0?!0:O,U=T.maxLength,H=T.minLength,L=T.name,te=T.onBlur,V=T.onClick,Q=T.onFocus,ee=T.onKeyDown,se=T.onKeyUp,pe=T.onValueChange,ue=T.padding,Oe=ue===void 0?0:ue,Fe=T.placeholder,Se=T.preClassName,Ce=T.readOnly,qe=T.required,Qe=T.style,We=T.tabSize,Ie=We===void 0?2:We,K=T.textareaClassName,ye=T.textareaId,Ne=T.value,ce=s(T,["autoFocus","disabled","form","highlight","ignoreTabKey","insertSpaces","maxLength","minLength","name","onBlur","onClick","onFocus","onKeyDown","onKeyUp","onValueChange","padding","placeholder","preClassName","readOnly","required","style","tabSize","textareaClassName","textareaId","value"]),oe=i.useRef({stack:[],offset:-1}),re=i.useRef(null),Re=i.useState(!0),Be=Re[0],Te=Re[1],lt={paddingTop:typeof Oe=="object"?Oe.top:Oe,paddingRight:typeof Oe=="object"?Oe.right:Oe,paddingBottom:typeof Oe=="object"?Oe.bottom:Oe,paddingLeft:typeof Oe=="object"?Oe.left:Oe},Tt=B(Ne),ut=function(ke,ge){return ke.substring(0,ge).split(`
`)},jt=i.useCallback(function(ke,ge){var Ee,le,dt;ge===void 0&&(ge=!1);var et=oe.current,$=et.stack,Ue=et.offset;if($.length&&Ue>-1){oe.current.stack=$.slice(0,Ue+1);var tt=oe.current.stack.length;if(tt>m){var ve=tt-m;oe.current.stack=$.slice(ve,tt),oe.current.offset=Math.max(oe.current.offset-ve,0)}}var _e=Date.now();if(ge){var $e=oe.current.stack[oe.current.offset];if($e&&_e-$e.timestamp<y){var Ct=/[^a-z0-9]([a-z0-9]+)$/i,fe=(Ee=ut($e.value,$e.selectionStart).pop())===null||Ee===void 0?void 0:Ee.match(Ct),Y=(le=ut(ke.value,ke.selectionStart).pop())===null||le===void 0?void 0:le.match(Ct);if(fe!=null&&fe[1]&&(!((dt=Y==null?void 0:Y[1])===null||dt===void 0)&&dt.startsWith(fe[1]))){oe.current.stack[oe.current.offset]=e(e({},ke),{timestamp:_e});return}}}oe.current.stack.push(e(e({},ke),{timestamp:_e})),oe.current.offset++},[]),qt=i.useCallback(function(){var ke=re.current;if(ke){var ge=ke.value,Ee=ke.selectionStart,le=ke.selectionEnd;jt({value:ge,selectionStart:Ee,selectionEnd:le})}},[jt]),Ft=function(ke){var ge=re.current;ge&&(ge.value=ke.value,ge.selectionStart=ke.selectionStart,ge.selectionEnd=ke.selectionEnd,pe==null||pe(ke.value))},Ht=function(ke){var ge=re.current,Ee=oe.current.stack[oe.current.offset];Ee&&ge&&(oe.current.stack[oe.current.offset]=e(e({},Ee),{selectionStart:ge.selectionStart,selectionEnd:ge.selectionEnd})),jt(ke),Ft(ke)},we=function(){var ke=oe.current,ge=ke.stack,Ee=ke.offset,le=ge[Ee-1];le&&(Ft(le),oe.current.offset=Math.max(Ee-1,0))},F=function(){var ke=oe.current,ge=ke.stack,Ee=ke.offset,le=ge[Ee+1];le&&(Ft(le),oe.current.offset=Math.min(Ee+1,ge.length-1))},X=function(ke){if(!(ee&&(ee(ke),ke.defaultPrevented))){ke.key==="Escape"&&ke.currentTarget.blur();var ge=ke.currentTarget,Ee=ge.value,le=ge.selectionStart,dt=ge.selectionEnd,et=(Z?" ":"	").repeat(Ie);if(ke.key==="Tab"&&!W&&Be)if(ke.preventDefault(),ke.shiftKey){var $=ut(Ee,le),Ue=$.length-1,tt=ut(Ee,dt).length-1,ve=Ee.split(`
`).map(function(xt,Qt){return Qt>=Ue&&Qt<=tt&&xt.startsWith(et)?xt.substring(et.length):xt}).join(`
`);if(Ee!==ve){var _e=$[Ue];Ht({value:ve,selectionStart:_e!=null&&_e.startsWith(et)?le-et.length:le,selectionEnd:dt-(Ee.length-ve.length)})}}else if(le!==dt){var $=ut(Ee,le),$e=$.length-1,Ct=ut(Ee,dt).length-1,_e=$[$e];Ht({value:Ee.split(`
`).map(function(On,Zt){return Zt>=$e&&Zt<=Ct?et+On:On}).join(`
`),selectionStart:_e&&/\S/.test(_e)?le+et.length:le,selectionEnd:dt+et.length*(Ct-$e+1)})}else{var fe=le+et.length;Ht({value:Ee.substring(0,le)+et+Ee.substring(dt),selectionStart:fe,selectionEnd:fe})}else if(ke.key==="Backspace"){var Y=le!==dt,G=Ee.substring(0,le);if(G.endsWith(et)&&!Y){ke.preventDefault();var fe=le-et.length;Ht({value:Ee.substring(0,le-et.length)+Ee.substring(dt),selectionStart:fe,selectionEnd:fe})}}else if(ke.key==="Enter"){if(le===dt){var J=ut(Ee,le).pop(),xe=J==null?void 0:J.match(/^\s+/);if(xe!=null&&xe[0]){ke.preventDefault();var De=`
`+xe[0],fe=le+De.length;Ht({value:Ee.substring(0,le)+De+Ee.substring(dt),selectionStart:fe,selectionEnd:fe})}}}else if(ke.keyCode===c||ke.keyCode===u||ke.keyCode===d||ke.keyCode===h){var He=void 0;ke.keyCode===c&&ke.shiftKey?He=["(",")"]:ke.keyCode===u?ke.shiftKey?He=["{","}"]:He=["[","]"]:ke.keyCode===d?ke.shiftKey?He=['"','"']:He=["'","'"]:ke.keyCode===h&&!ke.shiftKey&&(He=["`","`"]),le!==dt&&He&&(ke.preventDefault(),Ht({value:Ee.substring(0,le)+He[0]+Ee.substring(le,dt)+He[1]+Ee.substring(dt),selectionStart:le,selectionEnd:dt+2}))}else(v?ke.metaKey&&ke.keyCode===o:ke.ctrlKey&&ke.keyCode===o)&&!ke.shiftKey&&!ke.altKey?(ke.preventDefault(),we()):(v?ke.metaKey&&ke.keyCode===o&&ke.shiftKey:b?ke.ctrlKey&&ke.keyCode===a:ke.ctrlKey&&ke.keyCode===o&&ke.shiftKey)&&!ke.altKey?(ke.preventDefault(),F()):ke.keyCode===l&&ke.ctrlKey&&(!v||ke.shiftKey)&&(ke.preventDefault(),Te(function(xt){return!xt}))}},be=function(ke){var ge=ke.currentTarget,Ee=ge.value,le=ge.selectionStart,dt=ge.selectionEnd;jt({value:Ee,selectionStart:le,selectionEnd:dt},!0),pe(Ee)};return i.useEffect(function(){qt()},[qt]),i.useImperativeHandle(R,function(){return{get session(){return{history:oe.current}},set session(ke){oe.current=ke.history}}},[]),i.createElement("div",e({},ce,{style:e(e({},k.container),Qe)}),i.createElement("pre",e({className:Se,"aria-hidden":"true",style:e(e(e({},k.editor),k.highlight),lt)},typeof Tt=="string"?{dangerouslySetInnerHTML:{__html:Tt+"<br />"}}:{children:Tt})),i.createElement("textarea",{ref:function(ke){return re.current=ke},style:e(e(e({},k.editor),k.textarea),lt),className:x+(K?" ".concat(K):""),id:ye,value:Ne,onChange:be,onKeyDown:X,onClick:V,onKeyUp:se,onFocus:Q,onBlur:te,disabled:I,form:P,maxLength:U,minLength:H,name:L,placeholder:Fe,readOnly:Ce,required:qe,autoFocus:N,autoCapitalize:"off",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"data-gramm":!1}),i.createElement("style",{dangerouslySetInnerHTML:{__html:w}}))}),k={container:{position:"relative",textAlign:"left",boxSizing:"border-box",padding:0,overflow:"hidden"},textarea:{position:"absolute",top:0,left:0,height:"100%",width:"100%",resize:"none",color:"inherit",overflow:"hidden",MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",WebkitTextFillColor:"transparent"},highlight:{position:"relative",pointerEvents:"none"},editor:{margin:0,border:0,background:"none",boxSizing:"inherit",display:"inherit",fontFamily:"inherit",fontSize:"inherit",fontStyle:"inherit",fontVariantLigatures:"inherit",fontWeight:"inherit",letterSpacing:"inherit",lineHeight:"inherit",tabSize:"inherit",textIndent:"inherit",textRendering:"inherit",textTransform:"inherit",whiteSpace:"pre-wrap",wordBreak:"keep-all",overflowWrap:"break-word"}};return xo.default=S,xo}var CYe=SYe();const kYe=ua(CYe);var S3={exports:{}},aV;function EYe(){return aV||(aV=1,function(e){var t=typeof window<"u"?window:typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope?self:{};/**
 * Prism: Lightweight, robust, elegant syntax highlighting
 *
 * @license MIT <https://opensource.org/licenses/MIT>
 * @author Lea Verou <https://lea.verou.me>
 * @namespace
 * @public
 */var n=function(r){var s=/(?:^|\s)lang(?:uage)?-([\w-]+)(?=\s|$)/i,i=0,a={},o={manual:r.Prism&&r.Prism.manual,disableWorkerMessageHandler:r.Prism&&r.Prism.disableWorkerMessageHandler,util:{encode:function w(S){return S instanceof l?new l(S.type,w(S.content),S.alias):Array.isArray(S)?S.map(w):S.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ")},type:function(w){return Object.prototype.toString.call(w).slice(8,-1)},objId:function(w){return w.__id||Object.defineProperty(w,"__id",{value:++i}),w.__id},clone:function w(S,k){k=k||{};var C,T;switch(o.util.type(S)){case"Object":if(T=o.util.objId(S),k[T])return k[T];C={},k[T]=C;for(var R in S)S.hasOwnProperty(R)&&(C[R]=w(S[R],k));return C;case"Array":return T=o.util.objId(S),k[T]?k[T]:(C=[],k[T]=C,S.forEach(function(N,I){C[I]=w(N,k)}),C);default:return S}},getLanguage:function(w){for(;w;){var S=s.exec(w.className);if(S)return S[1].toLowerCase();w=w.parentElement}return"none"},setLanguage:function(w,S){w.className=w.className.replace(RegExp(s,"gi"),""),w.classList.add("language-"+S)},currentScript:function(){if(typeof document>"u")return null;if(document.currentScript&&document.currentScript.tagName==="SCRIPT")return document.currentScript;try{throw new Error}catch(C){var w=(/at [^(\r\n]*\((.*):[^:]+:[^:]+\)$/i.exec(C.stack)||[])[1];if(w){var S=document.getElementsByTagName("script");for(var k in S)if(S[k].src==w)return S[k]}return null}},isActive:function(w,S,k){for(var C="no-"+S;w;){var T=w.classList;if(T.contains(S))return!0;if(T.contains(C))return!1;w=w.parentElement}return!!k}},languages:{plain:a,plaintext:a,text:a,txt:a,extend:function(w,S){var k=o.util.clone(o.languages[w]);for(var C in S)k[C]=S[C];return k},insertBefore:function(w,S,k,C){C=C||o.languages;var T=C[w],R={};for(var N in T)if(T.hasOwnProperty(N)){if(N==S)for(var I in k)k.hasOwnProperty(I)&&(R[I]=k[I]);k.hasOwnProperty(N)||(R[N]=T[N])}var P=C[w];return C[w]=R,o.languages.DFS(o.languages,function(B,D){D===P&&B!=w&&(this[B]=R)}),R},DFS:function w(S,k,C,T){T=T||{};var R=o.util.objId;for(var N in S)if(S.hasOwnProperty(N)){k.call(S,N,S[N],C||N);var I=S[N],P=o.util.type(I);P==="Object"&&!T[R(I)]?(T[R(I)]=!0,w(I,k,null,T)):P==="Array"&&!T[R(I)]&&(T[R(I)]=!0,w(I,k,N,T))}}},plugins:{},highlightAll:function(w,S){o.highlightAllUnder(document,w,S)},highlightAllUnder:function(w,S,k){var C={callback:k,container:w,selector:'code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'};o.hooks.run("before-highlightall",C),C.elements=Array.prototype.slice.apply(C.container.querySelectorAll(C.selector)),o.hooks.run("before-all-elements-highlight",C);for(var T=0,R;R=C.elements[T++];)o.highlightElement(R,S===!0,C.callback)},highlightElement:function(w,S,k){var C=o.util.getLanguage(w),T=o.languages[C];o.util.setLanguage(w,C);var R=w.parentElement;R&&R.nodeName.toLowerCase()==="pre"&&o.util.setLanguage(R,C);var N=w.textContent,I={element:w,language:C,grammar:T,code:N};function P(D){I.highlightedCode=D,o.hooks.run("before-insert",I),I.element.innerHTML=I.highlightedCode,o.hooks.run("after-highlight",I),o.hooks.run("complete",I),k&&k.call(I.element)}if(o.hooks.run("before-sanity-check",I),R=I.element.parentElement,R&&R.nodeName.toLowerCase()==="pre"&&!R.hasAttribute("tabindex")&&R.setAttribute("tabindex","0"),!I.code){o.hooks.run("complete",I),k&&k.call(I.element);return}if(o.hooks.run("before-highlight",I),!I.grammar){P(o.util.encode(I.code));return}if(S&&r.Worker){var B=new Worker(o.filename);B.onmessage=function(D){P(D.data)},B.postMessage(JSON.stringify({language:I.language,code:I.code,immediateClose:!0}))}else P(o.highlight(I.code,I.grammar,I.language))},highlight:function(w,S,k){var C={code:w,grammar:S,language:k};if(o.hooks.run("before-tokenize",C),!C.grammar)throw new Error('The language "'+C.language+'" has no grammar.');return C.tokens=o.tokenize(C.code,C.grammar),o.hooks.run("after-tokenize",C),l.stringify(o.util.encode(C.tokens),C.language)},tokenize:function(w,S){var k=S.rest;if(k){for(var C in k)S[C]=k[C];delete S.rest}var T=new d;return h(T,T.head,w),u(w,T,S,T.head,0),y(T)},hooks:{all:{},add:function(w,S){var k=o.hooks.all;k[w]=k[w]||[],k[w].push(S)},run:function(w,S){var k=o.hooks.all[w];if(!(!k||!k.length))for(var C=0,T;T=k[C++];)T(S)}},Token:l};r.Prism=o;function l(w,S,k,C){this.type=w,this.content=S,this.alias=k,this.length=(C||"").length|0}l.stringify=function w(S,k){if(typeof S=="string")return S;if(Array.isArray(S)){var C="";return S.forEach(function(P){C+=w(P,k)}),C}var T={type:S.type,content:w(S.content,k),tag:"span",classes:["token",S.type],attributes:{},language:k},R=S.alias;R&&(Array.isArray(R)?Array.prototype.push.apply(T.classes,R):T.classes.push(R)),o.hooks.run("wrap",T);var N="";for(var I in T.attributes)N+=" "+I+'="'+(T.attributes[I]||"").replace(/"/g,"&quot;")+'"';return"<"+T.tag+' class="'+T.classes.join(" ")+'"'+N+">"+T.content+"</"+T.tag+">"};function c(w,S,k,C){w.lastIndex=S;var T=w.exec(k);if(T&&C&&T[1]){var R=T[1].length;T.index+=R,T[0]=T[0].slice(R)}return T}function u(w,S,k,C,T,R){for(var N in k)if(!(!k.hasOwnProperty(N)||!k[N])){var I=k[N];I=Array.isArray(I)?I:[I];for(var P=0;P<I.length;++P){if(R&&R.cause==N+","+P)return;var B=I[P],D=B.inside,W=!!B.lookbehind,O=!!B.greedy,Z=B.alias;if(O&&!B.pattern.global){var U=B.pattern.toString().match(/[imsuy]*$/)[0];B.pattern=RegExp(B.pattern.source,U+"g")}for(var H=B.pattern||B,L=C.next,te=T;L!==S.tail&&!(R&&te>=R.reach);te+=L.value.length,L=L.next){var V=L.value;if(S.length>w.length)return;if(!(V instanceof l)){var Q=1,ee;if(O){if(ee=c(H,te,w,W),!ee||ee.index>=w.length)break;var Oe=ee.index,se=ee.index+ee[0].length,pe=te;for(pe+=L.value.length;Oe>=pe;)L=L.next,pe+=L.value.length;if(pe-=L.value.length,te=pe,L.value instanceof l)continue;for(var ue=L;ue!==S.tail&&(pe<se||typeof ue.value=="string");ue=ue.next)Q++,pe+=ue.value.length;Q--,V=w.slice(te,pe),ee.index-=te}else if(ee=c(H,0,V,W),!ee)continue;var Oe=ee.index,Fe=ee[0],Se=V.slice(0,Oe),Ce=V.slice(Oe+Fe.length),qe=te+V.length;R&&qe>R.reach&&(R.reach=qe);var Qe=L.prev;Se&&(Qe=h(S,Qe,Se),te+=Se.length),m(S,Qe,Q);var We=new l(N,D?o.tokenize(Fe,D):Fe,Z,Fe);if(L=h(S,Qe,We),Ce&&h(S,L,Ce),Q>1){var Ie={cause:N+","+P,reach:qe};u(w,S,k,L.prev,te,Ie),R&&Ie.reach>R.reach&&(R.reach=Ie.reach)}}}}}}function d(){var w={value:null,prev:null,next:null},S={value:null,prev:w,next:null};w.next=S,this.head=w,this.tail=S,this.length=0}function h(w,S,k){var C=S.next,T={value:k,prev:S,next:C};return S.next=T,C.prev=T,w.length++,T}function m(w,S,k){for(var C=S.next,T=0;T<k&&C!==w.tail;T++)C=C.next;S.next=C,C.prev=S,w.length-=T}function y(w){for(var S=[],k=w.head.next;k!==w.tail;)S.push(k.value),k=k.next;return S}if(!r.document)return r.addEventListener&&(o.disableWorkerMessageHandler||r.addEventListener("message",function(w){var S=JSON.parse(w.data),k=S.language,C=S.code,T=S.immediateClose;r.postMessage(o.highlight(C,o.languages[k],k)),T&&r.close()},!1)),o;var b=o.util.currentScript();b&&(o.filename=b.src,b.hasAttribute("data-manual")&&(o.manual=!0));function v(){o.manual||o.highlightAll()}if(!o.manual){var x=document.readyState;x==="loading"||x==="interactive"&&b&&b.defer?document.addEventListener("DOMContentLoaded",v):window.requestAnimationFrame?window.requestAnimationFrame(v):window.setTimeout(v,16)}return o}(t);e.exports&&(e.exports=n),typeof tm<"u"&&(tm.Prism=n),n.languages.markup={comment:{pattern:/<!--(?:(?!<!--)[\s\S])*?-->/,greedy:!0},prolog:{pattern:/<\?[\s\S]+?\?>/,greedy:!0},doctype:{pattern:/<!DOCTYPE(?:[^>"'[\]]|"[^"]*"|'[^']*')+(?:\[(?:[^<"'\]]|"[^"]*"|'[^']*'|<(?!!--)|<!--(?:[^-]|-(?!->))*-->)*\]\s*)?>/i,greedy:!0,inside:{"internal-subset":{pattern:/(^[^\[]*\[)[\s\S]+(?=\]>$)/,lookbehind:!0,greedy:!0,inside:null},string:{pattern:/"[^"]*"|'[^']*'/,greedy:!0},punctuation:/^<!|>$|[[\]]/,"doctype-tag":/^DOCTYPE/i,name:/[^\s<>'"]+/}},cdata:{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,greedy:!0},tag:{pattern:/<\/?(?!\d)[^\s>\/=$<%]+(?:\s(?:\s*[^\s>\/=]+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))|(?=[\s/>])))+)?\s*\/?>/,greedy:!0,inside:{tag:{pattern:/^<\/?[^\s>\/]+/,inside:{punctuation:/^<\/?/,namespace:/^[^\s>\/:]+:/}},"special-attr":[],"attr-value":{pattern:/=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+)/,inside:{punctuation:[{pattern:/^=/,alias:"attr-equals"},{pattern:/^(\s*)["']|["']$/,lookbehind:!0}]}},punctuation:/\/?>/,"attr-name":{pattern:/[^\s>\/]+/,inside:{namespace:/^[^\s>\/:]+:/}}}},entity:[{pattern:/&[\da-z]{1,8};/i,alias:"named-entity"},/&#x?[\da-f]{1,8};/i]},n.languages.markup.tag.inside["attr-value"].inside.entity=n.languages.markup.entity,n.languages.markup.doctype.inside["internal-subset"].inside=n.languages.markup,n.hooks.add("wrap",function(r){r.type==="entity"&&(r.attributes.title=r.content.replace(/&amp;/,"&"))}),Object.defineProperty(n.languages.markup.tag,"addInlined",{value:function(s,i){var a={};a["language-"+i]={pattern:/(^<!\[CDATA\[)[\s\S]+?(?=\]\]>$)/i,lookbehind:!0,inside:n.languages[i]},a.cdata=/^<!\[CDATA\[|\]\]>$/i;var o={"included-cdata":{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,inside:a}};o["language-"+i]={pattern:/[\s\S]+/,inside:n.languages[i]};var l={};l[s]={pattern:RegExp(/(<__[^>]*>)(?:<!\[CDATA\[(?:[^\]]|\](?!\]>))*\]\]>|(?!<!\[CDATA\[)[\s\S])*?(?=<\/__>)/.source.replace(/__/g,function(){return s}),"i"),lookbehind:!0,greedy:!0,inside:o},n.languages.insertBefore("markup","cdata",l)}}),Object.defineProperty(n.languages.markup.tag,"addAttribute",{value:function(r,s){n.languages.markup.tag.inside["special-attr"].push({pattern:RegExp(/(^|["'\s])/.source+"(?:"+r+")"+/\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))/.source,"i"),lookbehind:!0,inside:{"attr-name":/^[^\s=]+/,"attr-value":{pattern:/=[\s\S]+/,inside:{value:{pattern:/(^=\s*(["']|(?!["'])))\S[\s\S]*(?=\2$)/,lookbehind:!0,alias:[s,"language-"+s],inside:n.languages[s]},punctuation:[{pattern:/^=/,alias:"attr-equals"},/"|'/]}}}})}}),n.languages.html=n.languages.markup,n.languages.mathml=n.languages.markup,n.languages.svg=n.languages.markup,n.languages.xml=n.languages.extend("markup",{}),n.languages.ssml=n.languages.xml,n.languages.atom=n.languages.xml,n.languages.rss=n.languages.xml,function(r){var s=/(?:"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n])*')/;r.languages.css={comment:/\/\*[\s\S]*?\*\//,atrule:{pattern:RegExp("@[\\w-](?:"+/[^;{\s"']|\s+(?!\s)/.source+"|"+s.source+")*?"+/(?:;|(?=\s*\{))/.source),inside:{rule:/^@[\w-]+/,"selector-function-argument":{pattern:/(\bselector\s*\(\s*(?![\s)]))(?:[^()\s]|\s+(?![\s)])|\((?:[^()]|\([^()]*\))*\))+(?=\s*\))/,lookbehind:!0,alias:"selector"},keyword:{pattern:/(^|[^\w-])(?:and|not|only|or)(?![\w-])/,lookbehind:!0}}},url:{pattern:RegExp("\\burl\\((?:"+s.source+"|"+/(?:[^\\\r\n()"']|\\[\s\S])*/.source+")\\)","i"),greedy:!0,inside:{function:/^url/i,punctuation:/^\(|\)$/,string:{pattern:RegExp("^"+s.source+"$"),alias:"url"}}},selector:{pattern:RegExp(`(^|[{}\\s])[^{}\\s](?:[^{};"'\\s]|\\s+(?![\\s{])|`+s.source+")*(?=\\s*\\{)"),lookbehind:!0},string:{pattern:s,greedy:!0},property:{pattern:/(^|[^-\w\xA0-\uFFFF])(?!\s)[-_a-z\xA0-\uFFFF](?:(?!\s)[-\w\xA0-\uFFFF])*(?=\s*:)/i,lookbehind:!0},important:/!important\b/i,function:{pattern:/(^|[^-a-z0-9])[-a-z0-9]+(?=\()/i,lookbehind:!0},punctuation:/[(){};:,]/},r.languages.css.atrule.inside.rest=r.languages.css;var i=r.languages.markup;i&&(i.tag.addInlined("style","css"),i.tag.addAttribute("style","css"))}(n),n.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\s\S]*?(?:\*\/|$)/,lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|trait)\s+|\bcatch\s+\()[\w.\\]+/i,lookbehind:!0,inside:{punctuation:/[.\\]/}},keyword:/\b(?:break|catch|continue|do|else|finally|for|function|if|in|instanceof|new|null|return|throw|try|while)\b/,boolean:/\b(?:false|true)\b/,function:/\b\w+(?=\()/,number:/\b0x[\da-f]+\b|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?/i,operator:/[<>]=?|[!=]=?=?|--?|\+\+?|&&?|\|\|?|[?*/~^%]/,punctuation:/[{}[\];(),.:]/},n.languages.javascript=n.languages.extend("clike",{"class-name":[n.languages.clike["class-name"],{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$A-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\.(?:constructor|prototype))/,lookbehind:!0}],keyword:[{pattern:/((?:^|\})\s*)catch\b/,lookbehind:!0},{pattern:/(^|[^.]|\.\.\.\s*)\b(?:as|assert(?=\s*\{)|async(?=\s*(?:function\b|\(|[$\w\xA0-\uFFFF]|$))|await|break|case|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally(?=\s*(?:\{|$))|for|from(?=\s*(?:['"]|$))|function|(?:get|set)(?=\s*(?:[#\[$\w\xA0-\uFFFF]|$))|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)\b/,lookbehind:!0}],function:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*(?:\.\s*(?:apply|bind|call)\s*)?\()/,number:{pattern:RegExp(/(^|[^\w$])/.source+"(?:"+(/NaN|Infinity/.source+"|"+/0[bB][01]+(?:_[01]+)*n?/.source+"|"+/0[oO][0-7]+(?:_[0-7]+)*n?/.source+"|"+/0[xX][\dA-Fa-f]+(?:_[\dA-Fa-f]+)*n?/.source+"|"+/\d+(?:_\d+)*n/.source+"|"+/(?:\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\.\d+(?:_\d+)*)(?:[Ee][+-]?\d+(?:_\d+)*)?/.source)+")"+/(?![\w$])/.source),lookbehind:!0},operator:/--|\+\+|\*\*=?|=>|&&=?|\|\|=?|[!=]==|<<=?|>>>?=?|[-+*/%&|^!=<>]=?|\.{3}|\?\?=?|\?\.?|[~:]/}),n.languages.javascript["class-name"][0].pattern=/(\b(?:class|extends|implements|instanceof|interface|new)\s+)[\w.\\]+/,n.languages.insertBefore("javascript","keyword",{regex:{pattern:RegExp(/((?:^|[^$\w\xA0-\uFFFF."'\])\s]|\b(?:return|yield))\s*)/.source+/\//.source+"(?:"+/(?:\[(?:[^\]\\\r\n]|\\.)*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}/.source+"|"+/(?:\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.)*\])*\])*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}v[dgimyus]{0,7}/.source+")"+/(?=(?:\s|\/\*(?:[^*]|\*(?!\/))*\*\/)*(?:$|[\r\n,.;:})\]]|\/\/))/.source),lookbehind:!0,greedy:!0,inside:{"regex-source":{pattern:/^(\/)[\s\S]+(?=\/[a-z]*$)/,lookbehind:!0,alias:"language-regex",inside:n.languages.regex},"regex-delimiter":/^\/|\/$/,"regex-flags":/^[a-z]+$/}},"function-variable":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*[=:]\s*(?:async\s*)?(?:\bfunction\b|(?:\((?:[^()]|\([^()]*\))*\)|(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)\s*=>))/,alias:"function"},parameter:[{pattern:/(function(?:\s+(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)?\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\))/,lookbehind:!0,inside:n.languages.javascript},{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$a-z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*=>)/i,lookbehind:!0,inside:n.languages.javascript},{pattern:/(\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*=>)/,lookbehind:!0,inside:n.languages.javascript},{pattern:/((?:\b|\s|^)(?!(?:as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)(?![$\w\xA0-\uFFFF]))(?:(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*)\(\s*|\]\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*\{)/,lookbehind:!0,inside:n.languages.javascript}],constant:/\b[A-Z](?:[A-Z_]|\dx?)*\b/}),n.languages.insertBefore("javascript","string",{hashbang:{pattern:/^#!.*/,greedy:!0,alias:"comment"},"template-string":{pattern:/`(?:\\[\s\S]|\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}|(?!\$\{)[^\\`])*`/,greedy:!0,inside:{"template-punctuation":{pattern:/^`|`$/,alias:"string"},interpolation:{pattern:/((?:^|[^\\])(?:\\{2})*)\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}/,lookbehind:!0,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:"punctuation"},rest:n.languages.javascript}},string:/[\s\S]+/}},"string-property":{pattern:/((?:^|[,{])[ \t]*)(["'])(?:\\(?:\r\n|[\s\S])|(?!\2)[^\\\r\n])*\2(?=\s*:)/m,lookbehind:!0,greedy:!0,alias:"property"}}),n.languages.insertBefore("javascript","operator",{"literal-property":{pattern:/((?:^|[,{])[ \t]*)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*:)/m,lookbehind:!0,alias:"property"}}),n.languages.markup&&(n.languages.markup.tag.addInlined("script","javascript"),n.languages.markup.tag.addAttribute(/on(?:abort|blur|change|click|composition(?:end|start|update)|dblclick|error|focus(?:in|out)?|key(?:down|up)|load|mouse(?:down|enter|leave|move|out|over|up)|reset|resize|scroll|select|slotchange|submit|unload|wheel)/.source,"javascript")),n.languages.js=n.languages.javascript,function(){if(typeof n>"u"||typeof document>"u")return;Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector);var r="Loading",s=function(b,v){return" Error "+b+" while fetching file: "+v},i=" Error: File does not exist or is empty",a={js:"javascript",py:"python",rb:"ruby",ps1:"powershell",psm1:"powershell",sh:"bash",bat:"batch",h:"c",tex:"latex"},o="data-src-status",l="loading",c="loaded",u="failed",d="pre[data-src]:not(["+o+'="'+c+'"]):not(['+o+'="'+l+'"])';function h(b,v,x){var w=new XMLHttpRequest;w.open("GET",b,!0),w.onreadystatechange=function(){w.readyState==4&&(w.status<400&&w.responseText?v(w.responseText):w.status>=400?x(s(w.status,w.statusText)):x(i))},w.send(null)}function m(b){var v=/^\s*(\d+)\s*(?:(,)\s*(?:(\d+)\s*)?)?$/.exec(b||"");if(v){var x=Number(v[1]),w=v[2],S=v[3];return w?S?[x,Number(S)]:[x,void 0]:[x,x]}}n.hooks.add("before-highlightall",function(b){b.selector+=", "+d}),n.hooks.add("before-sanity-check",function(b){var v=b.element;if(v.matches(d)){b.code="",v.setAttribute(o,l);var x=v.appendChild(document.createElement("CODE"));x.textContent=r;var w=v.getAttribute("data-src"),S=b.language;if(S==="none"){var k=(/\.(\w+)$/.exec(w)||[,"none"])[1];S=a[k]||k}n.util.setLanguage(x,S),n.util.setLanguage(v,S);var C=n.plugins.autoloader;C&&C.loadLanguages(S),h(w,function(T){v.setAttribute(o,c);var R=m(v.getAttribute("data-range"));if(R){var N=T.split(/\r\n?|\n/g),I=R[0],P=R[1]==null?N.length:R[1];I<0&&(I+=N.length),I=Math.max(0,Math.min(I-1,N.length)),P<0&&(P+=N.length),P=Math.max(0,Math.min(P,N.length)),T=N.slice(I,P).join(`
`),v.hasAttribute("data-start")||v.setAttribute("data-start",String(I+1))}x.textContent=T,n.highlightElement(x)},function(T){v.setAttribute(o,u),x.textContent=T})}}),n.plugins.fileHighlight={highlight:function(v){for(var x=(v||document).querySelectorAll(d),w=0,S;S=x[w++];)n.highlightElement(S)}};var y=!1;n.fileHighlight=function(){y||(console.warn("Prism.fileHighlight is deprecated. Use `Prism.plugins.fileHighlight.highlight` instead."),y=!0),n.plugins.fileHighlight.highlight.apply(this,arguments)}}()}(S3)),S3.exports}var TYe=EYe();const Ks=ua(TYe);var oV={},lV;function AYe(){return lV||(lV=1,function(e){e.languages.typescript=e.languages.extend("javascript",{"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|type)\s+)(?!keyof\b)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?:\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>)?/,lookbehind:!0,greedy:!0,inside:null},builtin:/\b(?:Array|Function|Promise|any|boolean|console|never|number|string|symbol|unknown)\b/}),e.languages.typescript.keyword.push(/\b(?:abstract|declare|is|keyof|readonly|require)\b/,/\b(?:asserts|infer|interface|module|namespace|type)\b(?=\s*(?:[{_$a-zA-Z\xA0-\uFFFF]|$))/,/\btype\b(?=\s*(?:[\{*]|$))/),delete e.languages.typescript.parameter,delete e.languages.typescript["literal-property"];var t=e.languages.extend("typescript",{});delete t["class-name"],e.languages.typescript["class-name"].inside=t,e.languages.insertBefore("typescript","function",{decorator:{pattern:/@[$\w\xA0-\uFFFF]+/,inside:{at:{pattern:/^@/,alias:"operator"},function:/^[\s\S]+/}},"generic-function":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>(?=\s*\()/,greedy:!0,inside:{function:/^#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*/,generic:{pattern:/<[\s\S]+/,alias:"class-name",inside:t}}}}),e.languages.ts=e.languages.typescript}(Prism)),oV}AYe();var cV={},uV;function RYe(){return uV||(uV=1,Prism.languages.python={comment:{pattern:/(^|[^\\])#.*/,lookbehind:!0,greedy:!0},"string-interpolation":{pattern:/(?:f|fr|rf)(?:("""|''')[\s\S]*?\1|("|')(?:\\.|(?!\2)[^\\\r\n])*\2)/i,greedy:!0,inside:{interpolation:{pattern:/((?:^|[^{])(?:\{\{)*)\{(?!\{)(?:[^{}]|\{(?!\{)(?:[^{}]|\{(?!\{)(?:[^{}])+\})+\})+\}/,lookbehind:!0,inside:{"format-spec":{pattern:/(:)[^:(){}]+(?=\}$)/,lookbehind:!0},"conversion-option":{pattern:/![sra](?=[:}]$)/,alias:"punctuation"},rest:null}},string:/[\s\S]+/}},"triple-quoted-string":{pattern:/(?:[rub]|br|rb)?("""|''')[\s\S]*?\1/i,greedy:!0,alias:"string"},string:{pattern:/(?:[rub]|br|rb)?("|')(?:\\.|(?!\1)[^\\\r\n])*\1/i,greedy:!0},function:{pattern:/((?:^|\s)def[ \t]+)[a-zA-Z_]\w*(?=\s*\()/g,lookbehind:!0},"class-name":{pattern:/(\bclass\s+)\w+/i,lookbehind:!0},decorator:{pattern:/(^[\t ]*)@\w+(?:\.\w+)*/m,lookbehind:!0,alias:["annotation","punctuation"],inside:{punctuation:/\./}},keyword:/\b(?:_(?=\s*:)|and|as|assert|async|await|break|case|class|continue|def|del|elif|else|except|exec|finally|for|from|global|if|import|in|is|lambda|match|nonlocal|not|or|pass|print|raise|return|try|while|with|yield)\b/,builtin:/\b(?:__import__|abs|all|any|apply|ascii|basestring|bin|bool|buffer|bytearray|bytes|callable|chr|classmethod|cmp|coerce|compile|complex|delattr|dict|dir|divmod|enumerate|eval|execfile|file|filter|float|format|frozenset|getattr|globals|hasattr|hash|help|hex|id|input|int|intern|isinstance|issubclass|iter|len|list|locals|long|map|max|memoryview|min|next|object|oct|open|ord|pow|property|range|raw_input|reduce|reload|repr|reversed|round|set|setattr|slice|sorted|staticmethod|str|sum|super|tuple|type|unichr|unicode|vars|xrange|zip)\b/,boolean:/\b(?:False|None|True)\b/,number:/\b0(?:b(?:_?[01])+|o(?:_?[0-7])+|x(?:_?[a-f0-9])+)\b|(?:\b\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\B\.\d+(?:_\d+)*)(?:e[+-]?\d+(?:_\d+)*)?j?(?!\w)/i,operator:/[-+%=]=?|!=|:=|\*\*?=?|\/\/?=?|<[<=>]?|>[=>]?|[&|^~]/,punctuation:/[{}[\];(),.:]/},Prism.languages.python["string-interpolation"].inside.interpolation.inside.rest=Prism.languages.python,Prism.languages.py=Prism.languages.python),cV}RYe();(function(e){var t="\\b(?:BASH|BASHOPTS|BASH_ALIASES|BASH_ARGC|BASH_ARGV|BASH_CMDS|BASH_COMPLETION_COMPAT_DIR|BASH_LINENO|BASH_REMATCH|BASH_SOURCE|BASH_VERSINFO|BASH_VERSION|COLORTERM|COLUMNS|COMP_WORDBREAKS|DBUS_SESSION_BUS_ADDRESS|DEFAULTS_PATH|DESKTOP_SESSION|DIRSTACK|DISPLAY|EUID|GDMSESSION|GDM_LANG|GNOME_KEYRING_CONTROL|GNOME_KEYRING_PID|GPG_AGENT_INFO|GROUPS|HISTCONTROL|HISTFILE|HISTFILESIZE|HISTSIZE|HOME|HOSTNAME|HOSTTYPE|IFS|INSTANCE|JOB|LANG|LANGUAGE|LC_ADDRESS|LC_ALL|LC_IDENTIFICATION|LC_MEASUREMENT|LC_MONETARY|LC_NAME|LC_NUMERIC|LC_PAPER|LC_TELEPHONE|LC_TIME|LESSCLOSE|LESSOPEN|LINES|LOGNAME|LS_COLORS|MACHTYPE|MAILCHECK|MANDATORY_PATH|NO_AT_BRIDGE|OLDPWD|OPTERR|OPTIND|ORBIT_SOCKETDIR|OSTYPE|PAPERSIZE|PATH|PIPESTATUS|PPID|PS1|PS2|PS3|PS4|PWD|RANDOM|REPLY|SECONDS|SELINUX_INIT|SESSION|SESSIONTYPE|SESSION_MANAGER|SHELL|SHELLOPTS|SHLVL|SSH_AUTH_SOCK|TERM|UID|UPSTART_EVENTS|UPSTART_INSTANCE|UPSTART_JOB|UPSTART_SESSION|USER|WINDOWID|XAUTHORITY|XDG_CONFIG_DIRS|XDG_CURRENT_DESKTOP|XDG_DATA_DIRS|XDG_GREETER_DATA_DIR|XDG_MENU_PREFIX|XDG_RUNTIME_DIR|XDG_SEAT|XDG_SEAT_PATH|XDG_SESSION_DESKTOP|XDG_SESSION_ID|XDG_SESSION_PATH|XDG_SESSION_TYPE|XDG_VTNR|XMODIFIERS)\\b",n={pattern:/(^(["']?)\w+\2)[ \t]+\S.*/,lookbehind:!0,alias:"punctuation",inside:null},r={bash:n,environment:{pattern:RegExp("\\$"+t),alias:"constant"},variable:[{pattern:/\$?\(\([\s\S]+?\)\)/,greedy:!0,inside:{variable:[{pattern:/(^\$\(\([\s\S]+)\)\)/,lookbehind:!0},/^\$\(\(/],number:/\b0x[\dA-Fa-f]+\b|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:[Ee]-?\d+)?/,operator:/--|\+\+|\*\*=?|<<=?|>>=?|&&|\|\||[=!+\-*/%<>^&|]=?|[?~:]/,punctuation:/\(\(?|\)\)?|,|;/}},{pattern:/\$\((?:\([^)]+\)|[^()])+\)|`[^`]+`/,greedy:!0,inside:{variable:/^\$\(|^`|\)$|`$/}},{pattern:/\$\{[^}]+\}/,greedy:!0,inside:{operator:/:[-=?+]?|[!\/]|##?|%%?|\^\^?|,,?/,punctuation:/[\[\]]/,environment:{pattern:RegExp("(\\{)"+t),lookbehind:!0,alias:"constant"}}},/\$(?:\w+|[#?*!@$])/],entity:/\\(?:[abceEfnrtv\\"]|O?[0-7]{1,3}|U[0-9a-fA-F]{8}|u[0-9a-fA-F]{4}|x[0-9a-fA-F]{1,2})/};e.languages.bash={shebang:{pattern:/^#!\s*\/.*/,alias:"important"},comment:{pattern:/(^|[^"{\\$])#.*/,lookbehind:!0},"function-name":[{pattern:/(\bfunction\s+)[\w-]+(?=(?:\s*\(?:\s*\))?\s*\{)/,lookbehind:!0,alias:"function"},{pattern:/\b[\w-]+(?=\s*\(\s*\)\s*\{)/,alias:"function"}],"for-or-select":{pattern:/(\b(?:for|select)\s+)\w+(?=\s+in\s)/,alias:"variable",lookbehind:!0},"assign-left":{pattern:/(^|[\s;|&]|[<>]\()\w+(?:\.\w+)*(?=\+?=)/,inside:{environment:{pattern:RegExp("(^|[\\s;|&]|[<>]\\()"+t),lookbehind:!0,alias:"constant"}},alias:"variable",lookbehind:!0},parameter:{pattern:/(^|\s)-{1,2}(?:\w+:[+-]?)?\w+(?:\.\w+)*(?=[=\s]|$)/,alias:"variable",lookbehind:!0},string:[{pattern:/((?:^|[^<])<<-?\s*)(\w+)\s[\s\S]*?(?:\r?\n|\r)\2/,lookbehind:!0,greedy:!0,inside:r},{pattern:/((?:^|[^<])<<-?\s*)(["'])(\w+)\2\s[\s\S]*?(?:\r?\n|\r)\3/,lookbehind:!0,greedy:!0,inside:{bash:n}},{pattern:/(^|[^\\](?:\\\\)*)"(?:\\[\s\S]|\$\([^)]+\)|\$(?!\()|`[^`]+`|[^"\\`$])*"/,lookbehind:!0,greedy:!0,inside:r},{pattern:/(^|[^$\\])'[^']*'/,lookbehind:!0,greedy:!0},{pattern:/\$'(?:[^'\\]|\\[\s\S])*'/,greedy:!0,inside:{entity:r.entity}}],environment:{pattern:RegExp("\\$?"+t),alias:"constant"},variable:r.variable,function:{pattern:/(^|[\s;|&]|[<>]\()(?:add|apropos|apt|apt-cache|apt-get|aptitude|aspell|automysqlbackup|awk|basename|bash|bc|bconsole|bg|bzip2|cal|cargo|cat|cfdisk|chgrp|chkconfig|chmod|chown|chroot|cksum|clear|cmp|column|comm|composer|cp|cron|crontab|csplit|curl|cut|date|dc|dd|ddrescue|debootstrap|df|diff|diff3|dig|dir|dircolors|dirname|dirs|dmesg|docker|docker-compose|du|egrep|eject|env|ethtool|expand|expect|expr|fdformat|fdisk|fg|fgrep|file|find|fmt|fold|format|free|fsck|ftp|fuser|gawk|git|gparted|grep|groupadd|groupdel|groupmod|groups|grub-mkconfig|gzip|halt|head|hg|history|host|hostname|htop|iconv|id|ifconfig|ifdown|ifup|import|install|ip|java|jobs|join|kill|killall|less|link|ln|locate|logname|logrotate|look|lpc|lpr|lprint|lprintd|lprintq|lprm|ls|lsof|lynx|make|man|mc|mdadm|mkconfig|mkdir|mke2fs|mkfifo|mkfs|mkisofs|mknod|mkswap|mmv|more|most|mount|mtools|mtr|mutt|mv|nano|nc|netstat|nice|nl|node|nohup|notify-send|npm|nslookup|op|open|parted|passwd|paste|pathchk|ping|pkill|pnpm|podman|podman-compose|popd|pr|printcap|printenv|ps|pushd|pv|quota|quotacheck|quotactl|ram|rar|rcp|reboot|remsync|rename|renice|rev|rm|rmdir|rpm|rsync|scp|screen|sdiff|sed|sendmail|seq|service|sftp|sh|shellcheck|shuf|shutdown|sleep|slocate|sort|split|ssh|stat|strace|su|sudo|sum|suspend|swapon|sync|sysctl|tac|tail|tar|tee|time|timeout|top|touch|tr|traceroute|tsort|tty|umount|uname|unexpand|uniq|units|unrar|unshar|unzip|update-grub|uptime|useradd|userdel|usermod|users|uudecode|uuencode|v|vcpkg|vdir|vi|vim|virsh|vmstat|wait|watch|wc|wget|whereis|which|who|whoami|write|xargs|xdg-open|yarn|yes|zenity|zip|zsh|zypper)(?=$|[)\s;|&])/,lookbehind:!0},keyword:{pattern:/(^|[\s;|&]|[<>]\()(?:case|do|done|elif|else|esac|fi|for|function|if|in|select|then|until|while)(?=$|[)\s;|&])/,lookbehind:!0},builtin:{pattern:/(^|[\s;|&]|[<>]\()(?:\.|:|alias|bind|break|builtin|caller|cd|command|continue|declare|echo|enable|eval|exec|exit|export|getopts|hash|help|let|local|logout|mapfile|printf|pwd|read|readarray|readonly|return|set|shift|shopt|source|test|times|trap|type|typeset|ulimit|umask|unalias|unset)(?=$|[)\s;|&])/,lookbehind:!0,alias:"class-name"},boolean:{pattern:/(^|[\s;|&]|[<>]\()(?:false|true)(?=$|[)\s;|&])/,lookbehind:!0},"file-descriptor":{pattern:/\B&\d\b/,alias:"important"},operator:{pattern:/\d?<>|>\||\+=|=[=~]?|!=?|<<[<-]?|[&\d]?>>|\d[<>]&?|[<>][&=]?|&[>&]?|\|[&|]?/,inside:{"file-descriptor":{pattern:/^\d/,alias:"important"}}},punctuation:/\$?\(\(?|\)\)?|\.\.|[{}[\];\\]/,number:{pattern:/(^|\s)(?:[1-9]\d*|0)(?:[.,]\d+)?\b/,lookbehind:!0}},n.inside=e.languages.bash;for(var s=["comment","function-name","for-or-select","assign-left","parameter","string","environment","function","keyword","builtin","boolean","file-descriptor","operator","punctuation","number"],i=r.variable[1].inside,a=0;a<s.length;a++)i[s[a]]=e.languages.bash[s[a]];e.languages.sh=e.languages.bash,e.languages.shell=e.languages.bash})(Prism);Prism.languages.json={property:{pattern:/(^|[^\\])"(?:\\.|[^\\"\r\n])*"(?=\s*:)/,lookbehind:!0,greedy:!0},string:{pattern:/(^|[^\\])"(?:\\.|[^\\"\r\n])*"(?!\s*:)/,lookbehind:!0,greedy:!0},comment:{pattern:/\/\/.*|\/\*[\s\S]*?(?:\*\/|$)/,greedy:!0},number:/-?\b\d+(?:\.\d+)?(?:e[+-]?\d+)?\b/i,punctuation:/[{}[\],]/,operator:/:/,boolean:/\b(?:false|true)\b/,null:{pattern:/\bnull\b/,alias:"keyword"}};Prism.languages.webmanifest=Prism.languages.json;(function(e){var t=/(?:\\.|[^\\\n\r]|(?:\n|\r\n?)(?![\r\n]))/.source;function n(u){return u=u.replace(/<inner>/g,function(){return t}),RegExp(/((?:^|[^\\])(?:\\{2})*)/.source+"(?:"+u+")")}var r=/(?:\\.|``(?:[^`\r\n]|`(?!`))+``|`[^`\r\n]+`|[^\\|\r\n`])+/.source,s=/\|?__(?:\|__)+\|?(?:(?:\n|\r\n?)|(?![\s\S]))/.source.replace(/__/g,function(){return r}),i=/\|?[ \t]*:?-{3,}:?[ \t]*(?:\|[ \t]*:?-{3,}:?[ \t]*)+\|?(?:\n|\r\n?)/.source;e.languages.markdown=e.languages.extend("markup",{}),e.languages.insertBefore("markdown","prolog",{"front-matter-block":{pattern:/(^(?:\s*[\r\n])?)---(?!.)[\s\S]*?[\r\n]---(?!.)/,lookbehind:!0,greedy:!0,inside:{punctuation:/^---|---$/,"front-matter":{pattern:/\S+(?:\s+\S+)*/,alias:["yaml","language-yaml"],inside:e.languages.yaml}}},blockquote:{pattern:/^>(?:[\t ]*>)*/m,alias:"punctuation"},table:{pattern:RegExp("^"+s+i+"(?:"+s+")*","m"),inside:{"table-data-rows":{pattern:RegExp("^("+s+i+")(?:"+s+")*$"),lookbehind:!0,inside:{"table-data":{pattern:RegExp(r),inside:e.languages.markdown},punctuation:/\|/}},"table-line":{pattern:RegExp("^("+s+")"+i+"$"),lookbehind:!0,inside:{punctuation:/\||:?-{3,}:?/}},"table-header-row":{pattern:RegExp("^"+s+"$"),inside:{"table-header":{pattern:RegExp(r),alias:"important",inside:e.languages.markdown},punctuation:/\|/}}}},code:[{pattern:/((?:^|\n)[ \t]*\n|(?:^|\r\n?)[ \t]*\r\n?)(?: {4}|\t).+(?:(?:\n|\r\n?)(?: {4}|\t).+)*/,lookbehind:!0,alias:"keyword"},{pattern:/^```[\s\S]*?^```$/m,greedy:!0,inside:{"code-block":{pattern:/^(```.*(?:\n|\r\n?))[\s\S]+?(?=(?:\n|\r\n?)^```$)/m,lookbehind:!0},"code-language":{pattern:/^(```).+/,lookbehind:!0},punctuation:/```/}}],title:[{pattern:/\S.*(?:\n|\r\n?)(?:==+|--+)(?=[ \t]*$)/m,alias:"important",inside:{punctuation:/==+$|--+$/}},{pattern:/(^\s*)#.+/m,lookbehind:!0,alias:"important",inside:{punctuation:/^#+|#+$/}}],hr:{pattern:/(^\s*)([*-])(?:[\t ]*\2){2,}(?=\s*$)/m,lookbehind:!0,alias:"punctuation"},list:{pattern:/(^\s*)(?:[*+-]|\d+\.)(?=[\t ].)/m,lookbehind:!0,alias:"punctuation"},"url-reference":{pattern:/!?\[[^\]]+\]:[\t ]+(?:\S+|<(?:\\.|[^>\\])+>)(?:[\t ]+(?:"(?:\\.|[^"\\])*"|'(?:\\.|[^'\\])*'|\((?:\\.|[^)\\])*\)))?/,inside:{variable:{pattern:/^(!?\[)[^\]]+/,lookbehind:!0},string:/(?:"(?:\\.|[^"\\])*"|'(?:\\.|[^'\\])*'|\((?:\\.|[^)\\])*\))$/,punctuation:/^[\[\]!:]|[<>]/},alias:"url"},bold:{pattern:n(/\b__(?:(?!_)<inner>|_(?:(?!_)<inner>)+_)+__\b|\*\*(?:(?!\*)<inner>|\*(?:(?!\*)<inner>)+\*)+\*\*/.source),lookbehind:!0,greedy:!0,inside:{content:{pattern:/(^..)[\s\S]+(?=..$)/,lookbehind:!0,inside:{}},punctuation:/\*\*|__/}},italic:{pattern:n(/\b_(?:(?!_)<inner>|__(?:(?!_)<inner>)+__)+_\b|\*(?:(?!\*)<inner>|\*\*(?:(?!\*)<inner>)+\*\*)+\*/.source),lookbehind:!0,greedy:!0,inside:{content:{pattern:/(^.)[\s\S]+(?=.$)/,lookbehind:!0,inside:{}},punctuation:/[*_]/}},strike:{pattern:n(/(~~?)(?:(?!~)<inner>)+\2/.source),lookbehind:!0,greedy:!0,inside:{content:{pattern:/(^~~?)[\s\S]+(?=\1$)/,lookbehind:!0,inside:{}},punctuation:/~~?/}},"code-snippet":{pattern:/(^|[^\\`])(?:``[^`\r\n]+(?:`[^`\r\n]+)*``(?!`)|`[^`\r\n]+`(?!`))/,lookbehind:!0,greedy:!0,alias:["code","keyword"]},url:{pattern:n(/!?\[(?:(?!\])<inner>)+\](?:\([^\s)]+(?:[\t ]+"(?:\\.|[^"\\])*")?\)|[ \t]?\[(?:(?!\])<inner>)+\])/.source),lookbehind:!0,greedy:!0,inside:{operator:/^!/,content:{pattern:/(^\[)[^\]]+(?=\])/,lookbehind:!0,inside:{}},variable:{pattern:/(^\][ \t]?\[)[^\]]+(?=\]$)/,lookbehind:!0},url:{pattern:/(^\]\()[^\s)]+/,lookbehind:!0},string:{pattern:/(^[ \t]+)"(?:\\.|[^"\\])*"(?=\)$)/,lookbehind:!0}}}}),["url","bold","italic","strike"].forEach(function(u){["url","bold","italic","strike","code-snippet"].forEach(function(d){u!==d&&(e.languages.markdown[u].inside.content.inside[d]=e.languages.markdown[d])})}),e.hooks.add("after-tokenize",function(u){if(u.language!=="markdown"&&u.language!=="md")return;function d(h){if(!(!h||typeof h=="string"))for(var m=0,y=h.length;m<y;m++){var b=h[m];if(b.type!=="code"){d(b.content);continue}var v=b.content[1],x=b.content[3];if(v&&x&&v.type==="code-language"&&x.type==="code-block"&&typeof v.content=="string"){var w=v.content.replace(/\b#/g,"sharp").replace(/\b\+\+/g,"pp");w=(/[a-z][\w-]*/i.exec(w)||[""])[0].toLowerCase();var S="language-"+w;x.alias?typeof x.alias=="string"?x.alias=[x.alias,S]:x.alias.push(S):x.alias=[S]}}}d(u.tokens)}),e.hooks.add("wrap",function(u){if(u.type==="code-block"){for(var d="",h=0,m=u.classes.length;h<m;h++){var y=u.classes[h],b=/language-(.+)/.exec(y);if(b){d=b[1];break}}var v=e.languages[d];if(v)u.content=e.highlight(c(u.content),v,d);else if(d&&d!=="none"&&e.plugins.autoloader){var x="md-"+new Date().valueOf()+"-"+Math.floor(Math.random()*1e16);u.attributes.id=x,e.plugins.autoloader.loadLanguages(d,function(){var w=document.getElementById(x);w&&(w.innerHTML=e.highlight(w.textContent,e.languages[d],d))})}}});var a=RegExp(e.languages.markup.tag.pattern.source,"gi"),o={amp:"&",lt:"<",gt:">",quot:'"'},l=String.fromCodePoint||String.fromCharCode;function c(u){var d=u.replace(a,"");return d=d.replace(/&(\w{1,8}|#x?[\da-f]{1,8});/gi,function(h,m){if(m=m.toLowerCase(),m[0]==="#"){var y;return m[1]==="x"?y=parseInt(m.slice(2),16):y=Number(m.slice(1)),l(y)}else{var b=o[m];return b||h}}),d}e.languages.md=e.languages.markdown})(Prism);(function(e){e.languages.diff={coord:[/^(?:\*{3}|-{3}|\+{3}).*$/m,/^@@.*@@$/m,/^\d.*$/m]};var t={"deleted-sign":"-","deleted-arrow":"<","inserted-sign":"+","inserted-arrow":">",unchanged:" ",diff:"!"};Object.keys(t).forEach(function(n){var r=t[n],s=[];/^\w+$/.test(n)||s.push(/\w+/.exec(n)[0]),n==="diff"&&s.push("bold"),e.languages.diff[n]={pattern:RegExp("^(?:["+r+`].*(?:\r
?|
|(?![\\s\\S])))+`,"m"),alias:s,inside:{line:{pattern:/(.)(?=[\s\S]).*(?:\r\n?|\n)?/,lookbehind:!0},prefix:{pattern:/[\s\S]/,alias:/\w+/.exec(n)[0]}}}}),Object.defineProperty(e.languages.diff,"PREFIXES",{value:t})})(Prism);Prism.languages.go=Prism.languages.extend("clike",{string:{pattern:/(^|[^\\])"(?:\\.|[^"\\\r\n])*"|`[^`]*`/,lookbehind:!0,greedy:!0},keyword:/\b(?:break|case|chan|const|continue|default|defer|else|fallthrough|for|func|go(?:to)?|if|import|interface|map|package|range|return|select|struct|switch|type|var)\b/,boolean:/\b(?:_|false|iota|nil|true)\b/,number:[/\b0(?:b[01_]+|o[0-7_]+)i?\b/i,/\b0x(?:[a-f\d_]+(?:\.[a-f\d_]*)?|\.[a-f\d_]+)(?:p[+-]?\d+(?:_\d+)*)?i?(?!\w)/i,/(?:\b\d[\d_]*(?:\.[\d_]*)?|\B\.\d[\d_]*)(?:e[+-]?[\d_]+)?i?(?!\w)/i],operator:/[*\/%^!=]=?|\+[=+]?|-[=-]?|\|[=|]?|&(?:=|&|\^=?)?|>(?:>=?|=)?|<(?:<=?|=|-)?|:=|\.\.\./,builtin:/\b(?:append|bool|byte|cap|close|complex|complex(?:64|128)|copy|delete|error|float(?:32|64)|u?int(?:8|16|32|64)?|imag|len|make|new|panic|print(?:ln)?|real|recover|rune|string|uintptr)\b/});Prism.languages.insertBefore("go","string",{char:{pattern:/'(?:\\.|[^'\\\r\n]){0,10}'/,greedy:!0}});delete Prism.languages.go["class-name"];(function(e){var t=/[*&][^\s[\]{},]+/,n=/!(?:<[\w\-%#;/?:@&=+$,.!~*'()[\]]+>|(?:[a-zA-Z\d-]*!)?[\w\-%#;/?:@&=+$.~*'()]+)?/,r="(?:"+n.source+"(?:[ 	]+"+t.source+")?|"+t.source+"(?:[ 	]+"+n.source+")?)",s=/(?:[^\s\x00-\x08\x0e-\x1f!"#%&'*,\-:>?@[\]`{|}\x7f-\x84\x86-\x9f\ud800-\udfff\ufffe\uffff]|[?:-]<PLAIN>)(?:[ \t]*(?:(?![#:])<PLAIN>|:<PLAIN>))*/.source.replace(/<PLAIN>/g,function(){return/[^\s\x00-\x08\x0e-\x1f,[\]{}\x7f-\x84\x86-\x9f\ud800-\udfff\ufffe\uffff]/.source}),i=/"(?:[^"\\\r\n]|\\.)*"|'(?:[^'\\\r\n]|\\.)*'/.source;function a(o,l){l=(l||"").replace(/m/g,"")+"m";var c=/([:\-,[{]\s*(?:\s<<prop>>[ \t]+)?)(?:<<value>>)(?=[ \t]*(?:$|,|\]|\}|(?:[\r\n]\s*)?#))/.source.replace(/<<prop>>/g,function(){return r}).replace(/<<value>>/g,function(){return o});return RegExp(c,l)}e.languages.yaml={scalar:{pattern:RegExp(/([\-:]\s*(?:\s<<prop>>[ \t]+)?[|>])[ \t]*(?:((?:\r?\n|\r)[ \t]+)\S[^\r\n]*(?:\2[^\r\n]+)*)/.source.replace(/<<prop>>/g,function(){return r})),lookbehind:!0,alias:"string"},comment:/#.*/,key:{pattern:RegExp(/((?:^|[:\-,[{\r\n?])[ \t]*(?:<<prop>>[ \t]+)?)<<key>>(?=\s*:\s)/.source.replace(/<<prop>>/g,function(){return r}).replace(/<<key>>/g,function(){return"(?:"+s+"|"+i+")"})),lookbehind:!0,greedy:!0,alias:"atrule"},directive:{pattern:/(^[ \t]*)%.+/m,lookbehind:!0,alias:"important"},datetime:{pattern:a(/\d{4}-\d\d?-\d\d?(?:[tT]|[ \t]+)\d\d?:\d{2}:\d{2}(?:\.\d*)?(?:[ \t]*(?:Z|[-+]\d\d?(?::\d{2})?))?|\d{4}-\d{2}-\d{2}|\d\d?:\d{2}(?::\d{2}(?:\.\d*)?)?/.source),lookbehind:!0,alias:"number"},boolean:{pattern:a(/false|true/.source,"i"),lookbehind:!0,alias:"important"},null:{pattern:a(/null|~/.source,"i"),lookbehind:!0,alias:"important"},string:{pattern:a(i),lookbehind:!0,greedy:!0},number:{pattern:a(/[+-]?(?:0x[\da-f]+|0o[0-7]+|(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?|\.inf|\.nan)/.source,"i"),lookbehind:!0},tag:n,important:t,punctuation:/---|[:[\]{}\-,|>?]|\.\.\./},e.languages.yml=e.languages.yaml})(Prism);var dV={},fV;function NYe(){return fV||(fV=1,function(e){for(var t=/\/\*(?:[^*/]|\*(?!\/)|\/(?!\*)|<self>)*\*\//.source,n=0;n<2;n++)t=t.replace(/<self>/g,function(){return t});t=t.replace(/<self>/g,function(){return/[^\s\S]/.source}),e.languages.rust={comment:[{pattern:RegExp(/(^|[^\\])/.source+t),lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/b?"(?:\\[\s\S]|[^\\"])*"|b?r(#*)"(?:[^"]|"(?!\1))*"\1/,greedy:!0},char:{pattern:/b?'(?:\\(?:x[0-7][\da-fA-F]|u\{(?:[\da-fA-F]_*){1,6}\}|.)|[^\\\r\n\t'])'/,greedy:!0},attribute:{pattern:/#!?\[(?:[^\[\]"]|"(?:\\[\s\S]|[^\\"])*")*\]/,greedy:!0,alias:"attr-name",inside:{string:null}},"closure-params":{pattern:/([=(,:]\s*|\bmove\s*)\|[^|]*\||\|[^|]*\|(?=\s*(?:\{|->))/,lookbehind:!0,greedy:!0,inside:{"closure-punctuation":{pattern:/^\||\|$/,alias:"punctuation"},rest:null}},"lifetime-annotation":{pattern:/'\w+/,alias:"symbol"},"fragment-specifier":{pattern:/(\$\w+:)[a-z]+/,lookbehind:!0,alias:"punctuation"},variable:/\$\w+/,"function-definition":{pattern:/(\bfn\s+)\w+/,lookbehind:!0,alias:"function"},"type-definition":{pattern:/(\b(?:enum|struct|trait|type|union)\s+)\w+/,lookbehind:!0,alias:"class-name"},"module-declaration":[{pattern:/(\b(?:crate|mod)\s+)[a-z][a-z_\d]*/,lookbehind:!0,alias:"namespace"},{pattern:/(\b(?:crate|self|super)\s*)::\s*[a-z][a-z_\d]*\b(?:\s*::(?:\s*[a-z][a-z_\d]*\s*::)*)?/,lookbehind:!0,alias:"namespace",inside:{punctuation:/::/}}],keyword:[/\b(?:Self|abstract|as|async|await|become|box|break|const|continue|crate|do|dyn|else|enum|extern|final|fn|for|if|impl|in|let|loop|macro|match|mod|move|mut|override|priv|pub|ref|return|self|static|struct|super|trait|try|type|typeof|union|unsafe|unsized|use|virtual|where|while|yield)\b/,/\b(?:bool|char|f(?:32|64)|[ui](?:8|16|32|64|128|size)|str)\b/],function:/\b[a-z_]\w*(?=\s*(?:::\s*<|\())/,macro:{pattern:/\b\w+!/,alias:"property"},constant:/\b[A-Z_][A-Z_\d]+\b/,"class-name":/\b[A-Z]\w*\b/,namespace:{pattern:/(?:\b[a-z][a-z_\d]*\s*::\s*)*\b[a-z][a-z_\d]*\s*::(?!\s*<)/,inside:{punctuation:/::/}},number:/\b(?:0x[\dA-Fa-f](?:_?[\dA-Fa-f])*|0o[0-7](?:_?[0-7])*|0b[01](?:_?[01])*|(?:(?:\d(?:_?\d)*)?\.)?\d(?:_?\d)*(?:[Ee][+-]?\d+)?)(?:_?(?:f32|f64|[iu](?:8|16|32|64|size)?))?\b/,boolean:/\b(?:false|true)\b/,punctuation:/->|\.\.=|\.{1,3}|::|[{}[\];(),:]/,operator:/[-+*\/%!^]=?|=[=>]?|&[&=]?|\|[|=]?|<<?=?|>>?=?|[@?]/},e.languages.rust["closure-params"].inside.rest=e.languages.rust,e.languages.rust.attribute.inside.string=e.languages.rust.string}(Prism)),dV}NYe();Prism.languages.sql={comment:{pattern:/(^|[^\\])(?:\/\*[\s\S]*?\*\/|(?:--|\/\/|#).*)/,lookbehind:!0},variable:[{pattern:/@(["'`])(?:\\[\s\S]|(?!\1)[^\\])+\1/,greedy:!0},/@[\w.$]+/],string:{pattern:/(^|[^@\\])("|')(?:\\[\s\S]|(?!\2)[^\\]|\2\2)*\2/,greedy:!0,lookbehind:!0},identifier:{pattern:/(^|[^@\\])`(?:\\[\s\S]|[^`\\]|``)*`/,greedy:!0,lookbehind:!0,inside:{punctuation:/^`|`$/}},function:/\b(?:AVG|COUNT|FIRST|FORMAT|LAST|LCASE|LEN|MAX|MID|MIN|MOD|NOW|ROUND|SUM|UCASE)(?=\s*\()/i,keyword:/\b(?:ACTION|ADD|AFTER|ALGORITHM|ALL|ALTER|ANALYZE|ANY|APPLY|AS|ASC|AUTHORIZATION|AUTO_INCREMENT|BACKUP|BDB|BEGIN|BERKELEYDB|BIGINT|BINARY|BIT|BLOB|BOOL|BOOLEAN|BREAK|BROWSE|BTREE|BULK|BY|CALL|CASCADED?|CASE|CHAIN|CHAR(?:ACTER|SET)?|CHECK(?:POINT)?|CLOSE|CLUSTERED|COALESCE|COLLATE|COLUMNS?|COMMENT|COMMIT(?:TED)?|COMPUTE|CONNECT|CONSISTENT|CONSTRAINT|CONTAINS(?:TABLE)?|CONTINUE|CONVERT|CREATE|CROSS|CURRENT(?:_DATE|_TIME|_TIMESTAMP|_USER)?|CURSOR|CYCLE|DATA(?:BASES?)?|DATE(?:TIME)?|DAY|DBCC|DEALLOCATE|DEC|DECIMAL|DECLARE|DEFAULT|DEFINER|DELAYED|DELETE|DELIMITERS?|DENY|DESC|DESCRIBE|DETERMINISTIC|DISABLE|DISCARD|DISK|DISTINCT|DISTINCTROW|DISTRIBUTED|DO|DOUBLE|DROP|DUMMY|DUMP(?:FILE)?|DUPLICATE|ELSE(?:IF)?|ENABLE|ENCLOSED|END|ENGINE|ENUM|ERRLVL|ERRORS|ESCAPED?|EXCEPT|EXEC(?:UTE)?|EXISTS|EXIT|EXPLAIN|EXTENDED|FETCH|FIELDS|FILE|FILLFACTOR|FIRST|FIXED|FLOAT|FOLLOWING|FOR(?: EACH ROW)?|FORCE|FOREIGN|FREETEXT(?:TABLE)?|FROM|FULL|FUNCTION|GEOMETRY(?:COLLECTION)?|GLOBAL|GOTO|GRANT|GROUP|HANDLER|HASH|HAVING|HOLDLOCK|HOUR|IDENTITY(?:COL|_INSERT)?|IF|IGNORE|IMPORT|INDEX|INFILE|INNER|INNODB|INOUT|INSERT|INT|INTEGER|INTERSECT|INTERVAL|INTO|INVOKER|ISOLATION|ITERATE|JOIN|KEYS?|KILL|LANGUAGE|LAST|LEAVE|LEFT|LEVEL|LIMIT|LINENO|LINES|LINESTRING|LOAD|LOCAL|LOCK|LONG(?:BLOB|TEXT)|LOOP|MATCH(?:ED)?|MEDIUM(?:BLOB|INT|TEXT)|MERGE|MIDDLEINT|MINUTE|MODE|MODIFIES|MODIFY|MONTH|MULTI(?:LINESTRING|POINT|POLYGON)|NATIONAL|NATURAL|NCHAR|NEXT|NO|NONCLUSTERED|NULLIF|NUMERIC|OFF?|OFFSETS?|ON|OPEN(?:DATASOURCE|QUERY|ROWSET)?|OPTIMIZE|OPTION(?:ALLY)?|ORDER|OUT(?:ER|FILE)?|OVER|PARTIAL|PARTITION|PERCENT|PIVOT|PLAN|POINT|POLYGON|PRECEDING|PRECISION|PREPARE|PREV|PRIMARY|PRINT|PRIVILEGES|PROC(?:EDURE)?|PUBLIC|PURGE|QUICK|RAISERROR|READS?|REAL|RECONFIGURE|REFERENCES|RELEASE|RENAME|REPEAT(?:ABLE)?|REPLACE|REPLICATION|REQUIRE|RESIGNAL|RESTORE|RESTRICT|RETURN(?:ING|S)?|REVOKE|RIGHT|ROLLBACK|ROUTINE|ROW(?:COUNT|GUIDCOL|S)?|RTREE|RULE|SAVE(?:POINT)?|SCHEMA|SECOND|SELECT|SERIAL(?:IZABLE)?|SESSION(?:_USER)?|SET(?:USER)?|SHARE|SHOW|SHUTDOWN|SIMPLE|SMALLINT|SNAPSHOT|SOME|SONAME|SQL|START(?:ING)?|STATISTICS|STATUS|STRIPED|SYSTEM_USER|TABLES?|TABLESPACE|TEMP(?:ORARY|TABLE)?|TERMINATED|TEXT(?:SIZE)?|THEN|TIME(?:STAMP)?|TINY(?:BLOB|INT|TEXT)|TOP?|TRAN(?:SACTIONS?)?|TRIGGER|TRUNCATE|TSEQUAL|TYPES?|UNBOUNDED|UNCOMMITTED|UNDEFINED|UNION|UNIQUE|UNLOCK|UNPIVOT|UNSIGNED|UPDATE(?:TEXT)?|USAGE|USE|USER|USING|VALUES?|VAR(?:BINARY|CHAR|CHARACTER|YING)|VIEW|WAITFOR|WARNINGS|WHEN|WHERE|WHILE|WITH(?: ROLLUP|IN)?|WORK|WRITE(?:TEXT)?|YEAR)\b/i,boolean:/\b(?:FALSE|NULL|TRUE)\b/i,number:/\b0x[\da-f]+\b|\b\d+(?:\.\d*)?|\B\.\d+\b/i,operator:/[-+*\/=%^~]|&&?|\|\|?|!=?|<(?:=>?|<|>)?|>[>=]?|\b(?:AND|BETWEEN|DIV|ILIKE|IN|IS|LIKE|NOT|OR|REGEXP|RLIKE|SOUNDS LIKE|XOR)\b/i,punctuation:/[;[\]()`,.]/};const MYe=({interactionId:e,codeBlockId:t,language:n,originalContent:r,editedContent:s,filepath:i,disabled:a,onEditModeChange:o})=>{const[l,c]=E.useState(!1),u=E.useCallback(y=>{if(y.stopPropagation(),a||!r||!e||!t){Me.info("Code editing is currently disabled.");return}c(!0),o==null||o(!0)},[a,r,e,t,o]),d=E.useCallback(()=>{if(!e||!t){Me.error("Missing interaction or code block ID");return}if(s.trim()===""){Me.error("Code cannot be empty");return}Pe.emit(Sa.editCodeBlockRequest,{interactionId:e,codeBlockId:t,language:n,filepath:i,originalContent:r,newContent:s}),c(!1),o==null||o(!1),Me.success("Code block edited successfully")},[e,t,n,i,r,s,o]),h=E.useCallback(()=>{c(!1),o==null||o(!1)},[o]);return r&&r.trim().length>0&&e&&t?l?f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsxs(mt,{size:"sm",onClick:d,className:"h-6 px-2 text-xs",children:[f.jsx($u,{className:"h-3 w-3 mr-1"}),"Save"]}),f.jsxs(mt,{size:"sm",variant:"outline",onClick:h,className:"h-6 px-2 text-xs",children:[f.jsx(Oi,{className:"h-3 w-3 mr-1"}),"Cancel"]})]}):f.jsx(Un,{tooltipText:"Edit Code",onClick:u,"aria-label":"Edit code block",disabled:a||!r||!e||!t,icon:f.jsx(WO,{}),iconClassName:"h-3.5 w-3.5",className:"h-6 w-6 text-muted-foreground hover:text-foreground"}):null},IYe=({code:e,language:t,onChange:n})=>{const r=E.useCallback(i=>i?{javascript:Ks.languages.javascript,js:Ks.languages.javascript,typescript:Ks.languages.typescript,ts:Ks.languages.typescript,python:Ks.languages.python,py:Ks.languages.python,bash:Ks.languages.bash,sh:Ks.languages.bash,json:Ks.languages.json,markdown:Ks.languages.markdown,md:Ks.languages.markdown,diff:Ks.languages.diff,go:Ks.languages.go,yaml:Ks.languages.yaml,yml:Ks.languages.yaml,rust:Ks.languages.rust,rs:Ks.languages.rust,sql:Ks.languages.sql}[i.toLowerCase()]||Ks.languages.plaintext||Ks.languages.text:Ks.languages.plaintext||Ks.languages.text,[]),s=E.useCallback(i=>{try{const a=r(t);return Ks.highlight(i,a,t||"text")}catch(a){return console.error("Syntax highlighting error:",a),i}},[t,r]);return f.jsx(kYe,{value:e,onValueChange:n,highlight:s,padding:16,tabSize:2,insertSpaces:!0,style:{fontFamily:'"Fira Code", "Fira Mono", "Consolas", "Monaco", monospace',fontSize:14,lineHeight:1.5,minHeight:"100px",backgroundColor:"transparent",outline:"none"}})},jYe=new $o({html:!1,linkify:!0,breaks:!0});class OYe{constructor(){de(this,"id","core-canvas-edit-codeblock-action");de(this,"eventUnsubscribers",[])}async initialize(t){const n=t.on(Sa.editCodeBlockRequest,async r=>{await this.handleCodeBlockEdit(r.interactionId,r.codeBlockId,r.language,r.filepath,r.originalContent,r.newContent)});this.eventUnsubscribers.push(n)}parseMarkdownForCodeBlocks(t){var n,r,s;if(!t)return[];try{const i=jYe.parse(t,{}),a=[];for(const o of i)if(o.type==="fence"){const l=((n=o.info)==null?void 0:n.trim())||"";let c,u;if(l.includes(":")){const[m,...y]=l.split(":");c=m||void 0,u=y.join(":")||void 0}else c=l.split(" ")[0]||void 0;const d=((r=o.map)==null?void 0:r[0])||0,h=((s=o.map)==null?void 0:s[1])||0;a.push({type:"block",lang:c,code:o.content,filepath:u,startPos:d,endPos:h})}return a}catch(i){return console.error("Markdown parsing error:",i),[]}}findCodeBlockByContent(t,n,r,s){const i=this.parseMarkdownForCodeBlocks(t);for(let a=0;a<i.length;a++){const o=i[a];if(o.code===n&&o.lang===r&&o.filepath===s)return a}for(let a=0;a<i.length;a++)if(i[a].code===n)return a;return-1}replaceCodeBlockInMarkdown(t,n,r,s,i){const a=t.split(`
`),o=this.parseMarkdownForCodeBlocks(t);if(n<0||n>=o.length)throw new Error(`Code block index ${n} not found`);const l=o[n],c=l.startPos,u=l.endPos,d=s||"",h=i?`:${i}`:"",m=[`\`\`\`${d}${h}`,...r.split(`
`),"```"];return[...a.slice(0,c),...m,...a.slice(u)].join(`
`)}async handleCodeBlockEdit(t,n,r,s,i,a){var o;try{const l=vn.getState(),c=l.interactions.find(k=>k.id===t);if(!c)throw new Error("Original interaction not found");if(c.status!=="COMPLETED")throw new Error("Can only edit completed interactions");if(!c.response||typeof c.response!="string")throw new Error("Invalid response content");const u=this.findCodeBlockByContent(c.response,i||"",r,s);if(u===-1)throw new Error("Code block not found in response");const d=this.replaceCodeBlockInMarkdown(c.response,u,a||"",r,s),h=as(),m={...c,id:h,response:d,parentId:null,index:c.index,metadata:{...c.metadata,editedResponse:!0,editedFromId:c.id,editedCodeBlock:{codeBlockId:n,language:r,filepath:s,originalContent:i,newContent:a}},endedAt:new Date};l._addInteractionToState(m);const y=l.interactions.filter(k=>k.parentId===c.id),b=[];let v=c;for(;v;){b.push(v);const k=(o=v.metadata)==null?void 0:o.editedFromId;k?v=l.interactions.find(C=>C.id===k):v=void 0}const x=b.sort((k,C)=>{var N,I;const T=((N=k.startedAt)==null?void 0:N.getTime())??0,R=((I=C.startedAt)==null?void 0:I.getTime())??0;return T-R}),w=x.map(async(k,C)=>{const T={parentId:h,index:C,metadata:{...k.metadata,originalVersion:C===0}};return l._updateInteractionInState(k.id,T),_t.saveInteraction({...k,...T})}),S=y.map(async k=>{const C={parentId:h,index:x.length+k.index};return l._updateInteractionInState(k.id,C),_t.saveInteraction({...k,...C})});await Promise.all([_t.saveInteraction(m),...w,...S])}catch(l){throw console.error("[EditCodeBlockControlModule] Failed to edit code block:",l),l}}register(t){t.registerCanvasControl({id:this.id,type:"codeblock",targetSlot:"codeblock-header-actions",renderer:n=>{if(!n.codeBlockContent||!n.interactionId)return null;const r=vn.getState(),s=r.status,i=r.interactions.find(l=>l.id===n.interactionId),a=i&&i.status==="COMPLETED"&&i.response&&typeof i.response=="string"&&s!=="streaming"&&(i.type==="message.user_assistant"||i.type==="message.assistant_regen")&&n.codeBlockContent&&n.codeBlockContent.trim().length>0;if(!a)return null;const o=n.blockId||`fallback-${Date.now()}`;return Ve.createElement(MYe,{interactionId:n.interactionId,codeBlockId:o,language:n.codeBlockLang,filepath:n.codeBlockFilepath,originalContent:n.codeBlockContent||"",editedContent:n.codeBlockEditedContent||n.codeBlockContent||"",disabled:!a,onEditModeChange:n.onEditModeChange})}})}async cleanup(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[]}async destroy(){await this.cleanup()}}const PYe=({isFolded:e,toggleFold:t,canFold:n})=>{if(!n)return null;const r=s=>{s.stopPropagation(),t()};return f.jsx(Un,{tooltipText:e?"Unfold":"Fold",onClick:r,"aria-label":e?"Unfold response":"Fold response",icon:e?f.jsx(Jl,{}):f.jsx(Bh,{}),iconClassName:"h-3.5 w-3.5",className:"h-5 w-5"})};class DYe{constructor(){de(this,"id","core-canvas-fold-interaction")}async initialize(t){}register(t){t.registerCanvasControl({id:this.id,type:"interaction",targetSlot:"header-actions",renderer:n=>!n.toggleFold||n.isFolded===void 0?null:Ve.createElement(PYe,{isFolded:n.isFolded,toggleFold:n.toggleFold,canFold:!0})})}destroy(t){}}const FYe=({context:e})=>{const t=pT(e.responseContent||""),n=E.useMemo(()=>{const s=[];return t.forEach(i=>{if(typeof i=="object"&&i.type==="block"){const a=i;a.filepath&&a.filepath.trim()&&s.push({filepath:a.filepath,code:a.code,lang:a.lang})}}),s},[t]),r=E.useCallback(async()=>{var s;if(n.length===0){Me.info("No code blocks with filepaths found to download");return}try{const i=new lD,a=new Set;n.forEach(({filepath:h,code:m})=>{const y=h.replace(/^[\/\\]+/,"").replace(/\\/g,"/"),b=y.split("/");if(b.length>1)for(let w=1;w<b.length;w++){const S=b.slice(0,w).join("/");a.has(S)||(i.folder(S),a.add(S))}let v=y,x=1;for(;i.file(v);){const w=y.lastIndexOf(".");if(w>0){const S=y.substring(0,w),k=y.substring(w);v=`${S}_${x}${k}`}else v=`${y}_${x}`;x++}i.file(v,m)});const o=await i.generateAsync({type:"blob",compression:"DEFLATE",compressionOptions:{level:6}}),l=URL.createObjectURL(o),c=document.createElement("a");c.href=l;const u=new Date().toISOString().slice(0,19).replace(/[:.]/g,"-"),d=((s=e.interactionId)==null?void 0:s.slice(0,8))||"unknown";c.download=`codeblocks_${d}_${u}.zip`,document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL(l),Me.success(`Downloaded ${n.length} code files as ZIP`)}catch(i){console.error("ZIP download failed:",i),Me.error("Failed to create ZIP file")}},[n,e.interactionId]);return n.length===0?null:f.jsx(Un,{tooltipText:`Download ${n.length} code files as ZIP`,onClick:r,"aria-label":"Download code blocks as ZIP file",icon:f.jsx(gH,{}),iconClassName:"h-4 w-4",className:"h-6 w-6 text-muted-foreground hover:text-foreground"})};class LYe{constructor(){de(this,"id","core-interaction-zip-download")}async initialize(t){}register(t){t.registerCanvasControl({id:this.id,type:"interaction",targetSlot:"header-actions",renderer:n=>!n.interactionId||!n.responseContent?null:Ve.createElement(FYe,{context:n})})}destroy(t){}}const BYe=({interactionId:e,codeBlockId:t,language:n,codeToCopy:r,disabled:s})=>{const[i,a]=E.useState(!1),o=E.useCallback(async l=>{l.stopPropagation(),!(s||!r)&&(Pe.emit(Sa.copyCodeBlockRequest,{interactionId:e,codeBlockId:t,language:n,content:r}),a(!0),setTimeout(()=>a(!1),1500))},[e,t,n,r,s]);return f.jsx(Un,{tooltipText:"Copy Code",onClick:o,"aria-label":"Copy code block",disabled:s||!r,icon:i?f.jsx(ao,{className:"text-green-500"}):f.jsx(pE,{}),className:"h-6 w-6 text-muted-foreground hover:text-foreground"})};class $Ye{constructor(){de(this,"id","core-codeblock-copy")}async initialize(t){}register(t){t.registerCanvasControl({id:this.id,type:"codeblock",targetSlot:"codeblock-header-actions",renderer:n=>Ve.createElement(BYe,{interactionId:n.interactionId,codeBlockId:n.codeBlockId,language:n.codeBlockLang,codeToCopy:n.codeBlockContent??"",disabled:!n.codeBlockContent||n.codeBlockContent.trim()===""})})}destroy(t){}}const zYe=({isFolded:e,toggleFold:t})=>{const n=r=>{r.stopPropagation(),t()};return f.jsx(Un,{tooltipText:e?"Unfold Code":"Fold Code",onClick:n,"aria-label":e?"Unfold code block":"Fold code block",icon:f.jsx(fE,{}),iconClassName:"h-3.5 w-3.5",className:"h-6 w-6 text-muted-foreground hover:text-foreground"})};class UYe{constructor(){de(this,"id","core-codeblock-fold")}async initialize(t){}register(t){t.registerCanvasControl({id:this.id,type:"codeblock",targetSlot:"codeblock-header-actions",renderer:n=>n.toggleFold===void 0||n.isFolded===void 0?null:Ve.createElement(zYe,{isFolded:n.isFolded,toggleFold:n.toggleFold})})}destroy(t){}}const qYe=({interactionId:e,codeBlockId:t,language:n,codeToDownload:r,filepath:s,disabled:i})=>{const a=E.useCallback(l=>{if(l.stopPropagation(),!(i||!r))try{let c;if(s){const m=s.split("/");c=m[m.length-1]}else c=`code${VYe(n)}`;const u=new Blob([r],{type:"text/plain"}),d=URL.createObjectURL(u),h=document.createElement("a");h.href=d,h.download=c,document.body.appendChild(h),h.click(),document.body.removeChild(h),URL.revokeObjectURL(d),Me.success(`Downloaded ${c}`)}catch(c){console.error("Download failed:",c),Me.error("Failed to download file")}},[e,t,n,r,s,i]);return s||r&&r.trim().length>1e3?f.jsx(Un,{tooltipText:"Download File",onClick:a,"aria-label":"Download code as file",disabled:i||!r,icon:f.jsx(Ec,{}),iconClassName:"h-3.5 w-3.5",className:"h-6 w-6 text-muted-foreground hover:text-foreground"}):null};function VYe(e){return e&&{javascript:".js",js:".js",typescript:".ts",ts:".ts",tsx:".tsx",jsx:".jsx",python:".py",py:".py",java:".java",c:".c",cpp:".cpp",cxx:".cxx",cc:".cc","c++":".cpp",csharp:".cs",cs:".cs",php:".php",ruby:".rb",rb:".rb",go:".go",rust:".rs",rs:".rs",swift:".swift",kotlin:".kt",kt:".kt",scala:".scala",html:".html",css:".css",scss:".scss",sass:".sass",less:".less",json:".json",xml:".xml",yaml:".yaml",yml:".yml",toml:".toml",ini:".ini",conf:".conf",config:".config",sh:".sh",bash:".sh",zsh:".zsh",fish:".fish",powershell:".ps1",ps1:".ps1",bat:".bat",cmd:".cmd",sql:".sql",r:".r",matlab:".m",octave:".m",lua:".lua",perl:".pl",vim:".vim",dockerfile:"Dockerfile",makefile:"Makefile",markdown:".md",md:".md",tex:".tex",latex:".tex"}[e.toLowerCase()]||".txt"}class WYe{constructor(){de(this,"id","core-codeblock-download")}async initialize(t){}register(t){t.registerCanvasControl({id:this.id,type:"codeblock",targetSlot:"codeblock-header-actions",renderer:n=>Ve.createElement(qYe,{interactionId:n.interactionId,codeBlockId:n.codeBlockId,language:n.codeBlockLang,codeToDownload:n.codeBlockContent??"",filepath:n.codeBlockFilepath,disabled:!n.codeBlockContent||n.codeBlockContent.trim()===""})})}destroy(t){}}const HYe=({toolCall:e})=>{const[t,n]=E.useState(!0),r=()=>n(i=>!i),s=E.useMemo(()=>{try{return JSON.stringify(e.args,null,2)}catch{return String(e.args)}},[e.args]);return f.jsxs("div",{className:"my-2 p-2 border border-amber-500/30 bg-amber-500/10 rounded-md text-xs",children:[f.jsxs("div",{className:"flex items-center justify-between mb-1",children:[f.jsxs("span",{className:"font-semibold text-amber-700 dark:text-amber-300",children:["Tool Call: ",f.jsx("code",{className:"font-mono",children:e.toolName})]}),f.jsx(Un,{tooltipText:t?"Show Args":"Hide Args",onClick:r,"aria-label":t?"Show arguments":"Hide arguments",icon:t?f.jsx(Jl,{}):f.jsx(Bh,{}),iconClassName:"h-3 w-3",className:"h-5 w-5 text-muted-foreground"})]}),!t&&f.jsx(Yy,{lang:"json",code:s})]})},GYe=({toolResult:e})=>{const[t,n]=E.useState(!0),r=()=>n(a=>!a),s=E.useMemo(()=>{try{return typeof e.result=="object"&&e.result!==null&&e.result._isError===!0?`Error: ${e.result.error}`:JSON.stringify(e.result,null,2)}catch{return String(e.result)}},[e.result]),i=typeof e.result=="object"&&e.result!==null&&e.result._isError===!0;return f.jsxs("div",{className:Xe("my-2 p-2 border rounded-md text-xs",i?"border-destructive/30 bg-destructive/10":"border-green-500/30 bg-green-500/10"),children:[f.jsxs("div",{className:"flex items-center justify-between mb-1",children:[f.jsxs("span",{className:Xe("font-semibold",i?"text-destructive":"text-green-700 dark:text-green-300"),children:["Tool Result: ",f.jsx("code",{className:"font-mono",children:e.toolName})]}),f.jsx(Un,{tooltipText:t?"Show Result":"Hide Result",onClick:r,"aria-label":t?"Show result":"Hide result",icon:t?f.jsx(Jl,{}):f.jsx(Bh,{}),iconClassName:"h-3 w-3",className:"h-5 w-5 text-muted-foreground"})]}),!t&&f.jsx(Yy,{lang:i?"text":"json",code:s})]})},KYe=({interactionId:e,toolCall:t,toolResult:n})=>f.jsxs("div",{className:"tool-call-step my-1","data-interaction-id":e,"data-tool-call-id":t.toolCallId,children:[f.jsx(HYe,{toolCall:t}),n&&f.jsx(GYe,{toolResult:n})]});class YYe{constructor(){de(this,"id","core-tool-call-step-display")}async initialize(t){}register(t){t.registerCanvasControl({id:this.id,type:"tool-call-step",targetSlot:"tool-call-content",renderer:n=>!n.interactionId||!n.toolCall?(console.warn("[ToolCallStepControlModule] Missing interactionId or toolCall in context"),null):Ve.createElement(KYe,{interactionId:n.interactionId,toolCall:n.toolCall,toolResult:n.toolResult})})}destroy(t){}}const ZYe=({lang:e,code:t,filepath:n,isStreaming:r=!1,interactionId:s,blockId:i})=>{const{foldStreamingCodeBlocks:a}=br(yn(C=>({foldStreamingCodeBlocks:C.foldStreamingCodeBlocks}))),[o,l]=E.useState(r?a:!1),[c,u]=E.useState(!1),[d,h]=E.useState(t);E.useEffect(()=>{c||h(t)},[t,c]);const m=E.useRef(null),y=Vi(yn(C=>Object.values(C.canvasControls))),b=E.useCallback((C,T,R,N,I,P)=>y.filter(B=>B.type==="codeblock"&&B.targetSlot===C&&B.renderer).map(B=>{if(B.renderer){const D={codeBlockContent:T,codeBlockEditedContent:d,codeBlockLang:R,codeBlockFilepath:N,isFolded:I,toggleFold:P,canvasContextType:"codeblock",interactionId:s,blockId:i,onEditModeChange:u};return f.jsx(Ve.Fragment,{children:B.renderer(D)},B.id)}return null}).filter(Boolean),[y,d,s,u]),v=E.useCallback(()=>{if(m.current&&t)try{m.current.style.whiteSpace!=="pre-wrap"&&(m.current.style.whiteSpace="pre-wrap"),m.current.textContent=t,Ks.highlightElement(m.current)}catch(C){console.error("Prism highlight error:",C),m.current.textContent=t}else m.current&&(m.current.textContent="")},[t]);E.useEffect(()=>{o||v()},[t,e,o,v]);const x=()=>{const C=o;l(T=>!T),C&&setTimeout(v,0)},w=e?`language-${e}`:"language-plaintext",S=E.useMemo(()=>t?t.split(`
`).slice(0,3).join(`
`):"",[t]),k=b("codeblock-header-actions",t,e,n,o,x);return f.jsxs("div",{className:"code-block-container group/codeblock my-4 max-w-full",children:[f.jsxs("div",{className:"code-block-header sticky top-0 z-10 flex items-center justify-between px-3 py-2 border border-b-0 border-border bg-muted/50 rounded-t-lg",children:[f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx("div",{className:"text-sm font-medium",children:e?e.toUpperCase():"CODE"}),n&&f.jsx("div",{className:"text-xs text-muted-foreground font-mono",children:n}),f.jsx("div",{className:"flex items-center gap-0.5 opacity-0 group-hover/codeblock:opacity-100 focus-within:opacity-100 transition-opacity",children:k})]}),f.jsx("div",{})]}),!o&&!c&&f.jsx("div",{className:"overflow-hidden w-full",children:f.jsx("pre",{className:"overflow-x-auto w-full relative overflow-wrap-anywhere border border-border rounded-b-lg bg-muted/20",children:f.jsx("code",{ref:m,className:w+" block p-4 font-mono text-sm leading-relaxed"})})}),!o&&c&&f.jsx("div",{className:"overflow-hidden w-full border border-border rounded-b-lg bg-muted/20",children:f.jsx(IYe,{code:d,language:e,onChange:h})}),o&&f.jsx("div",{className:"folded-content-preview p-4 cursor-pointer w-full box-border border border-t-0 border-border rounded-b-lg bg-muted/10 hover:bg-muted/20 transition-colors",onClick:x,children:f.jsx("pre",{className:"whitespace-pre-wrap break-words text-muted-foreground font-mono text-sm",children:S})})]})},dF=E.memo(ZYe);class XYe{constructor(){de(this,"id","core-block-renderer-code");de(this,"unregisterCallback")}async initialize(){}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}const n={id:this.id,supportedLanguages:void 0,priority:0,renderer:r=>Ve.createElement(dF,{lang:r.lang,code:r.code,filepath:r.filepath,isStreaming:r.isStreaming,interactionId:r.interactionId,blockId:r.blockId})};this.unregisterCallback=t.registerBlockRenderer(n)}destroy(){this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=void 0)}}var q2={exports:{}},JYe=q2.exports,hV;function QYe(){return hV||(hV=1,function(e,t){(function(n,r){e.exports=r()})(JYe,function(){var n=1e3,r=6e4,s=36e5,i="millisecond",a="second",o="minute",l="hour",c="day",u="week",d="month",h="quarter",m="year",y="date",b="Invalid Date",v=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,x=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,w={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(O){var Z=["th","st","nd","rd"],U=O%100;return"["+O+(Z[(U-20)%10]||Z[U]||Z[0])+"]"}},S=function(O,Z,U){var H=String(O);return!H||H.length>=Z?O:""+Array(Z+1-H.length).join(U)+O},k={s:S,z:function(O){var Z=-O.utcOffset(),U=Math.abs(Z),H=Math.floor(U/60),L=U%60;return(Z<=0?"+":"-")+S(H,2,"0")+":"+S(L,2,"0")},m:function O(Z,U){if(Z.date()<U.date())return-O(U,Z);var H=12*(U.year()-Z.year())+(U.month()-Z.month()),L=Z.clone().add(H,d),te=U-L<0,V=Z.clone().add(H+(te?-1:1),d);return+(-(H+(U-L)/(te?L-V:V-L))||0)},a:function(O){return O<0?Math.ceil(O)||0:Math.floor(O)},p:function(O){return{M:d,y:m,w:u,d:c,D:y,h:l,m:o,s:a,ms:i,Q:h}[O]||String(O||"").toLowerCase().replace(/s$/,"")},u:function(O){return O===void 0}},C="en",T={};T[C]=w;var R="$isDayjsObject",N=function(O){return O instanceof D||!(!O||!O[R])},I=function O(Z,U,H){var L;if(!Z)return C;if(typeof Z=="string"){var te=Z.toLowerCase();T[te]&&(L=te),U&&(T[te]=U,L=te);var V=Z.split("-");if(!L&&V.length>1)return O(V[0])}else{var Q=Z.name;T[Q]=Z,L=Q}return!H&&L&&(C=L),L||!H&&C},P=function(O,Z){if(N(O))return O.clone();var U=typeof Z=="object"?Z:{};return U.date=O,U.args=arguments,new D(U)},B=k;B.l=I,B.i=N,B.w=function(O,Z){return P(O,{locale:Z.$L,utc:Z.$u,x:Z.$x,$offset:Z.$offset})};var D=function(){function O(U){this.$L=I(U.locale,null,!0),this.parse(U),this.$x=this.$x||U.x||{},this[R]=!0}var Z=O.prototype;return Z.parse=function(U){this.$d=function(H){var L=H.date,te=H.utc;if(L===null)return new Date(NaN);if(B.u(L))return new Date;if(L instanceof Date)return new Date(L);if(typeof L=="string"&&!/Z$/i.test(L)){var V=L.match(v);if(V){var Q=V[2]-1||0,ee=(V[7]||"0").substring(0,3);return te?new Date(Date.UTC(V[1],Q,V[3]||1,V[4]||0,V[5]||0,V[6]||0,ee)):new Date(V[1],Q,V[3]||1,V[4]||0,V[5]||0,V[6]||0,ee)}}return new Date(L)}(U),this.init()},Z.init=function(){var U=this.$d;this.$y=U.getFullYear(),this.$M=U.getMonth(),this.$D=U.getDate(),this.$W=U.getDay(),this.$H=U.getHours(),this.$m=U.getMinutes(),this.$s=U.getSeconds(),this.$ms=U.getMilliseconds()},Z.$utils=function(){return B},Z.isValid=function(){return this.$d.toString()!==b},Z.isSame=function(U,H){var L=P(U);return this.startOf(H)<=L&&L<=this.endOf(H)},Z.isAfter=function(U,H){return P(U)<this.startOf(H)},Z.isBefore=function(U,H){return this.endOf(H)<P(U)},Z.$g=function(U,H,L){return B.u(U)?this[H]:this.set(L,U)},Z.unix=function(){return Math.floor(this.valueOf()/1e3)},Z.valueOf=function(){return this.$d.getTime()},Z.startOf=function(U,H){var L=this,te=!!B.u(H)||H,V=B.p(U),Q=function(Ce,qe){var Qe=B.w(L.$u?Date.UTC(L.$y,qe,Ce):new Date(L.$y,qe,Ce),L);return te?Qe:Qe.endOf(c)},ee=function(Ce,qe){return B.w(L.toDate()[Ce].apply(L.toDate("s"),(te?[0,0,0,0]:[23,59,59,999]).slice(qe)),L)},se=this.$W,pe=this.$M,ue=this.$D,Oe="set"+(this.$u?"UTC":"");switch(V){case m:return te?Q(1,0):Q(31,11);case d:return te?Q(1,pe):Q(0,pe+1);case u:var Fe=this.$locale().weekStart||0,Se=(se<Fe?se+7:se)-Fe;return Q(te?ue-Se:ue+(6-Se),pe);case c:case y:return ee(Oe+"Hours",0);case l:return ee(Oe+"Minutes",1);case o:return ee(Oe+"Seconds",2);case a:return ee(Oe+"Milliseconds",3);default:return this.clone()}},Z.endOf=function(U){return this.startOf(U,!1)},Z.$set=function(U,H){var L,te=B.p(U),V="set"+(this.$u?"UTC":""),Q=(L={},L[c]=V+"Date",L[y]=V+"Date",L[d]=V+"Month",L[m]=V+"FullYear",L[l]=V+"Hours",L[o]=V+"Minutes",L[a]=V+"Seconds",L[i]=V+"Milliseconds",L)[te],ee=te===c?this.$D+(H-this.$W):H;if(te===d||te===m){var se=this.clone().set(y,1);se.$d[Q](ee),se.init(),this.$d=se.set(y,Math.min(this.$D,se.daysInMonth())).$d}else Q&&this.$d[Q](ee);return this.init(),this},Z.set=function(U,H){return this.clone().$set(U,H)},Z.get=function(U){return this[B.p(U)]()},Z.add=function(U,H){var L,te=this;U=Number(U);var V=B.p(H),Q=function(pe){var ue=P(te);return B.w(ue.date(ue.date()+Math.round(pe*U)),te)};if(V===d)return this.set(d,this.$M+U);if(V===m)return this.set(m,this.$y+U);if(V===c)return Q(1);if(V===u)return Q(7);var ee=(L={},L[o]=r,L[l]=s,L[a]=n,L)[V]||1,se=this.$d.getTime()+U*ee;return B.w(se,this)},Z.subtract=function(U,H){return this.add(-1*U,H)},Z.format=function(U){var H=this,L=this.$locale();if(!this.isValid())return L.invalidDate||b;var te=U||"YYYY-MM-DDTHH:mm:ssZ",V=B.z(this),Q=this.$H,ee=this.$m,se=this.$M,pe=L.weekdays,ue=L.months,Oe=L.meridiem,Fe=function(qe,Qe,We,Ie){return qe&&(qe[Qe]||qe(H,te))||We[Qe].slice(0,Ie)},Se=function(qe){return B.s(Q%12||12,qe,"0")},Ce=Oe||function(qe,Qe,We){var Ie=qe<12?"AM":"PM";return We?Ie.toLowerCase():Ie};return te.replace(x,function(qe,Qe){return Qe||function(We){switch(We){case"YY":return String(H.$y).slice(-2);case"YYYY":return B.s(H.$y,4,"0");case"M":return se+1;case"MM":return B.s(se+1,2,"0");case"MMM":return Fe(L.monthsShort,se,ue,3);case"MMMM":return Fe(ue,se);case"D":return H.$D;case"DD":return B.s(H.$D,2,"0");case"d":return String(H.$W);case"dd":return Fe(L.weekdaysMin,H.$W,pe,2);case"ddd":return Fe(L.weekdaysShort,H.$W,pe,3);case"dddd":return pe[H.$W];case"H":return String(Q);case"HH":return B.s(Q,2,"0");case"h":return Se(1);case"hh":return Se(2);case"a":return Ce(Q,ee,!0);case"A":return Ce(Q,ee,!1);case"m":return String(ee);case"mm":return B.s(ee,2,"0");case"s":return String(H.$s);case"ss":return B.s(H.$s,2,"0");case"SSS":return B.s(H.$ms,3,"0");case"Z":return V}return null}(qe)||V.replace(":","")})},Z.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},Z.diff=function(U,H,L){var te,V=this,Q=B.p(H),ee=P(U),se=(ee.utcOffset()-this.utcOffset())*r,pe=this-ee,ue=function(){return B.m(V,ee)};switch(Q){case m:te=ue()/12;break;case d:te=ue();break;case h:te=ue()/3;break;case u:te=(pe-se)/6048e5;break;case c:te=(pe-se)/864e5;break;case l:te=pe/s;break;case o:te=pe/r;break;case a:te=pe/n;break;default:te=pe}return L?te:B.a(te)},Z.daysInMonth=function(){return this.endOf(d).$D},Z.$locale=function(){return T[this.$L]},Z.locale=function(U,H){if(!U)return this.$L;var L=this.clone(),te=I(U,H,!0);return te&&(L.$L=te),L},Z.clone=function(){return B.w(this.$d,this)},Z.toDate=function(){return new Date(this.valueOf())},Z.toJSON=function(){return this.isValid()?this.toISOString():null},Z.toISOString=function(){return this.$d.toISOString()},Z.toString=function(){return this.$d.toUTCString()},O}(),W=D.prototype;return P.prototype=W,[["$ms",i],["$s",a],["$m",o],["$H",l],["$W",c],["$M",d],["$y",m],["$D",y]].forEach(function(O){W[O[1]]=function(Z){return this.$g(Z,O[0],O[1])}}),P.extend=function(O,Z){return O.$i||(O(Z,D,P),O.$i=!0),P},P.locale=I,P.isDayjs=N,P.unix=function(O){return P(1e3*O)},P.en=T[C],P.Ls=T,P.p={},P})}(q2)),q2.exports}var eZe=QYe();const tZe=ua(eZe),V2={min:{r:0,g:0,b:0,s:0,l:0,a:0},max:{r:255,g:255,b:255,h:360,s:100,l:100,a:1},clamp:{r:e=>e>=255?255:e<0?0:e,g:e=>e>=255?255:e<0?0:e,b:e=>e>=255?255:e<0?0:e,h:e=>e%360,s:e=>e>=100?100:e<0?0:e,l:e=>e>=100?100:e<0?0:e,a:e=>e>=1?1:e<0?0:e},toLinear:e=>{const t=e/255;return e>.03928?Math.pow((t+.055)/1.055,2.4):t/12.92},hue2rgb:(e,t,n)=>(n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+(t-e)*6*n:n<1/2?t:n<2/3?e+(t-e)*(2/3-n)*6:e),hsl2rgb:({h:e,s:t,l:n},r)=>{if(!t)return n*2.55;e/=360,t/=100,n/=100;const s=n<.5?n*(1+t):n+t-n*t,i=2*n-s;switch(r){case"r":return V2.hue2rgb(i,s,e+1/3)*255;case"g":return V2.hue2rgb(i,s,e)*255;case"b":return V2.hue2rgb(i,s,e-1/3)*255}},rgb2hsl:({r:e,g:t,b:n},r)=>{e/=255,t/=255,n/=255;const s=Math.max(e,t,n),i=Math.min(e,t,n),a=(s+i)/2;if(r==="l")return a*100;if(s===i)return 0;const o=s-i,l=a>.5?o/(2-s-i):o/(s+i);if(r==="s")return l*100;switch(s){case e:return((t-n)/o+(t<n?6:0))*60;case t:return((n-e)/o+2)*60;case n:return((e-t)/o+4)*60;default:return-1}}},nZe={clamp:(e,t,n)=>t>n?Math.min(t,Math.max(n,e)):Math.min(n,Math.max(t,e)),round:e=>Math.round(e*1e10)/1e10},rZe={dec2hex:e=>{const t=Math.round(e).toString(16);return t.length>1?t:`0${t}`}},ur={channel:V2,lang:nZe,unit:rZe},sh={};for(let e=0;e<=255;e++)sh[e]=ur.unit.dec2hex(e);const Ia={ALL:0,RGB:1,HSL:2};class sZe{constructor(){this.type=Ia.ALL}get(){return this.type}set(t){if(this.type&&this.type!==t)throw new Error("Cannot change both RGB and HSL channels at the same time");this.type=t}reset(){this.type=Ia.ALL}is(t){return this.type===t}}class iZe{constructor(t,n){this.color=n,this.changed=!1,this.data=t,this.type=new sZe}set(t,n){return this.color=n,this.changed=!1,this.data=t,this.type.type=Ia.ALL,this}_ensureHSL(){const t=this.data,{h:n,s:r,l:s}=t;n===void 0&&(t.h=ur.channel.rgb2hsl(t,"h")),r===void 0&&(t.s=ur.channel.rgb2hsl(t,"s")),s===void 0&&(t.l=ur.channel.rgb2hsl(t,"l"))}_ensureRGB(){const t=this.data,{r:n,g:r,b:s}=t;n===void 0&&(t.r=ur.channel.hsl2rgb(t,"r")),r===void 0&&(t.g=ur.channel.hsl2rgb(t,"g")),s===void 0&&(t.b=ur.channel.hsl2rgb(t,"b"))}get r(){const t=this.data,n=t.r;return!this.type.is(Ia.HSL)&&n!==void 0?n:(this._ensureHSL(),ur.channel.hsl2rgb(t,"r"))}get g(){const t=this.data,n=t.g;return!this.type.is(Ia.HSL)&&n!==void 0?n:(this._ensureHSL(),ur.channel.hsl2rgb(t,"g"))}get b(){const t=this.data,n=t.b;return!this.type.is(Ia.HSL)&&n!==void 0?n:(this._ensureHSL(),ur.channel.hsl2rgb(t,"b"))}get h(){const t=this.data,n=t.h;return!this.type.is(Ia.RGB)&&n!==void 0?n:(this._ensureRGB(),ur.channel.rgb2hsl(t,"h"))}get s(){const t=this.data,n=t.s;return!this.type.is(Ia.RGB)&&n!==void 0?n:(this._ensureRGB(),ur.channel.rgb2hsl(t,"s"))}get l(){const t=this.data,n=t.l;return!this.type.is(Ia.RGB)&&n!==void 0?n:(this._ensureRGB(),ur.channel.rgb2hsl(t,"l"))}get a(){return this.data.a}set r(t){this.type.set(Ia.RGB),this.changed=!0,this.data.r=t}set g(t){this.type.set(Ia.RGB),this.changed=!0,this.data.g=t}set b(t){this.type.set(Ia.RGB),this.changed=!0,this.data.b=t}set h(t){this.type.set(Ia.HSL),this.changed=!0,this.data.h=t}set s(t){this.type.set(Ia.HSL),this.changed=!0,this.data.s=t}set l(t){this.type.set(Ia.HSL),this.changed=!0,this.data.l=t}set a(t){this.changed=!0,this.data.a=t}}const JT=new iZe({r:0,g:0,b:0,a:0},"transparent"),$0={re:/^#((?:[a-f0-9]{2}){2,4}|[a-f0-9]{3})$/i,parse:e=>{if(e.charCodeAt(0)!==35)return;const t=e.match($0.re);if(!t)return;const n=t[1],r=parseInt(n,16),s=n.length,i=s%4===0,a=s>4,o=a?1:17,l=a?8:4,c=i?0:-1,u=a?255:15;return JT.set({r:(r>>l*(c+3)&u)*o,g:(r>>l*(c+2)&u)*o,b:(r>>l*(c+1)&u)*o,a:i?(r&u)*o/255:1},e)},stringify:e=>{const{r:t,g:n,b:r,a:s}=e;return s<1?`#${sh[Math.round(t)]}${sh[Math.round(n)]}${sh[Math.round(r)]}${sh[Math.round(s*255)]}`:`#${sh[Math.round(t)]}${sh[Math.round(n)]}${sh[Math.round(r)]}`}},om={re:/^hsla?\(\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e-?\d+)?(?:deg|grad|rad|turn)?)\s*?(?:,|\s)\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e-?\d+)?%)\s*?(?:,|\s)\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e-?\d+)?%)(?:\s*?(?:,|\/)\s*?\+?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e-?\d+)?(%)?))?\s*?\)$/i,hueRe:/^(.+?)(deg|grad|rad|turn)$/i,_hue2deg:e=>{const t=e.match(om.hueRe);if(t){const[,n,r]=t;switch(r){case"grad":return ur.channel.clamp.h(parseFloat(n)*.9);case"rad":return ur.channel.clamp.h(parseFloat(n)*180/Math.PI);case"turn":return ur.channel.clamp.h(parseFloat(n)*360)}}return ur.channel.clamp.h(parseFloat(e))},parse:e=>{const t=e.charCodeAt(0);if(t!==104&&t!==72)return;const n=e.match(om.re);if(!n)return;const[,r,s,i,a,o]=n;return JT.set({h:om._hue2deg(r),s:ur.channel.clamp.s(parseFloat(s)),l:ur.channel.clamp.l(parseFloat(i)),a:a?ur.channel.clamp.a(o?parseFloat(a)/100:parseFloat(a)):1},e)},stringify:e=>{const{h:t,s:n,l:r,a:s}=e;return s<1?`hsla(${ur.lang.round(t)}, ${ur.lang.round(n)}%, ${ur.lang.round(r)}%, ${s})`:`hsl(${ur.lang.round(t)}, ${ur.lang.round(n)}%, ${ur.lang.round(r)}%)`}},$x={colors:{aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyanaqua:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",transparent:"#00000000",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},parse:e=>{e=e.toLowerCase();const t=$x.colors[e];if(t)return $0.parse(t)},stringify:e=>{const t=$0.stringify(e);for(const n in $x.colors)if($x.colors[n]===t)return n}},bx={re:/^rgba?\(\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e\d+)?(%?))\s*?(?:,|\s)\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e\d+)?(%?))\s*?(?:,|\s)\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e\d+)?(%?))(?:\s*?(?:,|\/)\s*?\+?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e\d+)?(%?)))?\s*?\)$/i,parse:e=>{const t=e.charCodeAt(0);if(t!==114&&t!==82)return;const n=e.match(bx.re);if(!n)return;const[,r,s,i,a,o,l,c,u]=n;return JT.set({r:ur.channel.clamp.r(s?parseFloat(r)*2.55:parseFloat(r)),g:ur.channel.clamp.g(a?parseFloat(i)*2.55:parseFloat(i)),b:ur.channel.clamp.b(l?parseFloat(o)*2.55:parseFloat(o)),a:c?ur.channel.clamp.a(u?parseFloat(c)/100:parseFloat(c)):1},e)},stringify:e=>{const{r:t,g:n,b:r,a:s}=e;return s<1?`rgba(${ur.lang.round(t)}, ${ur.lang.round(n)}, ${ur.lang.round(r)}, ${ur.lang.round(s)})`:`rgb(${ur.lang.round(t)}, ${ur.lang.round(n)}, ${ur.lang.round(r)})`}},Lu={format:{keyword:$x,hex:$0,rgb:bx,rgba:bx,hsl:om,hsla:om},parse:e=>{if(typeof e!="string")return e;const t=$0.parse(e)||bx.parse(e)||om.parse(e)||$x.parse(e);if(t)return t;throw new Error(`Unsupported color format: "${e}"`)},stringify:e=>!e.changed&&e.color?e.color:e.type.is(Ia.HSL)||e.data.r===void 0?om.stringify(e):e.a<1||!Number.isInteger(e.r)||!Number.isInteger(e.g)||!Number.isInteger(e.b)?bx.stringify(e):$0.stringify(e)},Nie=(e,t)=>{const n=Lu.parse(e);for(const r in t)n[r]=ur.channel.clamp[r](t[r]);return Lu.stringify(n)},zx=(e,t,n=0,r=1)=>{if(typeof e!="number")return Nie(e,{a:t});const s=JT.set({r:ur.channel.clamp.r(e),g:ur.channel.clamp.g(t),b:ur.channel.clamp.b(n),a:ur.channel.clamp.a(r)});return Lu.stringify(s)},aZe=e=>{const{r:t,g:n,b:r}=Lu.parse(e),s=.2126*ur.channel.toLinear(t)+.7152*ur.channel.toLinear(n)+.0722*ur.channel.toLinear(r);return ur.lang.round(s)},oZe=e=>aZe(e)>=.5,c_=e=>!oZe(e),Mie=(e,t,n)=>{const r=Lu.parse(e),s=r[t],i=ur.channel.clamp[t](s+n);return s!==i&&(r[t]=i),Lu.stringify(r)},Sn=(e,t)=>Mie(e,"l",t),zn=(e,t)=>Mie(e,"l",-t),vt=(e,t)=>{const n=Lu.parse(e),r={};for(const s in t)t[s]&&(r[s]=n[s]+t[s]);return Nie(e,r)},lZe=(e,t,n=50)=>{const{r,g:s,b:i,a}=Lu.parse(e),{r:o,g:l,b:c,a:u}=Lu.parse(t),d=n/100,h=d*2-1,m=a-u,b=((h*m===-1?h:(h+m)/(1+h*m))+1)/2,v=1-b,x=r*b+o*v,w=s*b+l*v,S=i*b+c*v,k=a*d+u*(1-d);return zx(x,w,S,k)},cn=(e,t=100)=>{const n=Lu.parse(e);return n.r=255-n.r,n.g=255-n.g,n.b=255-n.b,lZe(n,e,t)};/*! @license DOMPurify 3.2.6 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.6/LICENSE */const{entries:Iie,setPrototypeOf:pV,isFrozen:cZe,getPrototypeOf:uZe,getOwnPropertyDescriptor:dZe}=Object;let{freeze:co,seal:Zl,create:jie}=Object,{apply:U4,construct:q4}=typeof Reflect<"u"&&Reflect;co||(co=function(t){return t});Zl||(Zl=function(t){return t});U4||(U4=function(t,n,r){return t.apply(n,r)});q4||(q4=function(t,n){return new t(...n)});const g2=uo(Array.prototype.forEach),fZe=uo(Array.prototype.lastIndexOf),mV=uo(Array.prototype.pop),Wv=uo(Array.prototype.push),hZe=uo(Array.prototype.splice),W2=uo(String.prototype.toLowerCase),C3=uo(String.prototype.toString),gV=uo(String.prototype.match),Hv=uo(String.prototype.replace),pZe=uo(String.prototype.indexOf),mZe=uo(String.prototype.trim),bc=uo(Object.prototype.hasOwnProperty),Ja=uo(RegExp.prototype.test),Gv=gZe(TypeError);function uo(e){return function(t){t instanceof RegExp&&(t.lastIndex=0);for(var n=arguments.length,r=new Array(n>1?n-1:0),s=1;s<n;s++)r[s-1]=arguments[s];return U4(e,t,r)}}function gZe(e){return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return q4(e,n)}}function Br(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:W2;pV&&pV(e,null);let r=t.length;for(;r--;){let s=t[r];if(typeof s=="string"){const i=n(s);i!==s&&(cZe(t)||(t[r]=i),s=i)}e[s]=!0}return e}function yZe(e){for(let t=0;t<e.length;t++)bc(e,t)||(e[t]=null);return e}function Sd(e){const t=jie(null);for(const[n,r]of Iie(e))bc(e,n)&&(Array.isArray(r)?t[n]=yZe(r):r&&typeof r=="object"&&r.constructor===Object?t[n]=Sd(r):t[n]=r);return t}function Kv(e,t){for(;e!==null;){const r=dZe(e,t);if(r){if(r.get)return uo(r.get);if(typeof r.value=="function")return uo(r.value)}e=uZe(e)}function n(){return null}return n}const yV=co(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),k3=co(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),E3=co(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),bZe=co(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),T3=co(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),vZe=co(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),bV=co(["#text"]),vV=co(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),A3=co(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),xV=co(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),y2=co(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),xZe=Zl(/\{\{[\w\W]*|[\w\W]*\}\}/gm),wZe=Zl(/<%[\w\W]*|[\w\W]*%>/gm),_Ze=Zl(/\$\{[\w\W]*/gm),SZe=Zl(/^data-[\-\w.\u00B7-\uFFFF]+$/),CZe=Zl(/^aria-[\-\w]+$/),Oie=Zl(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),kZe=Zl(/^(?:\w+script|data):/i),EZe=Zl(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Pie=Zl(/^html$/i),TZe=Zl(/^[a-z][.\w]*(-[.\w]+)+$/i);var wV=Object.freeze({__proto__:null,ARIA_ATTR:CZe,ATTR_WHITESPACE:EZe,CUSTOM_ELEMENT:TZe,DATA_ATTR:SZe,DOCTYPE_NAME:Pie,ERB_EXPR:wZe,IS_ALLOWED_URI:Oie,IS_SCRIPT_OR_DATA:kZe,MUSTACHE_EXPR:xZe,TMPLIT_EXPR:_Ze});const Yv={element:1,text:3,progressingInstruction:7,comment:8,document:9},AZe=function(){return typeof window>"u"?null:window},RZe=function(t,n){if(typeof t!="object"||typeof t.createPolicy!="function")return null;let r=null;const s="data-tt-policy-suffix";n&&n.hasAttribute(s)&&(r=n.getAttribute(s));const i="dompurify"+(r?"#"+r:"");try{return t.createPolicy(i,{createHTML(a){return a},createScriptURL(a){return a}})}catch{return console.warn("TrustedTypes policy "+i+" could not be created."),null}},_V=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function Die(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:AZe();const t=hn=>Die(hn);if(t.version="3.2.6",t.removed=[],!e||!e.document||e.document.nodeType!==Yv.document||!e.Element)return t.isSupported=!1,t;let{document:n}=e;const r=n,s=r.currentScript,{DocumentFragment:i,HTMLTemplateElement:a,Node:o,Element:l,NodeFilter:c,NamedNodeMap:u=e.NamedNodeMap||e.MozNamedAttrMap,HTMLFormElement:d,DOMParser:h,trustedTypes:m}=e,y=l.prototype,b=Kv(y,"cloneNode"),v=Kv(y,"remove"),x=Kv(y,"nextSibling"),w=Kv(y,"childNodes"),S=Kv(y,"parentNode");if(typeof a=="function"){const hn=n.createElement("template");hn.content&&hn.content.ownerDocument&&(n=hn.content.ownerDocument)}let k,C="";const{implementation:T,createNodeIterator:R,createDocumentFragment:N,getElementsByTagName:I}=n,{importNode:P}=r;let B=_V();t.isSupported=typeof Iie=="function"&&typeof S=="function"&&T&&T.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:D,ERB_EXPR:W,TMPLIT_EXPR:O,DATA_ATTR:Z,ARIA_ATTR:U,IS_SCRIPT_OR_DATA:H,ATTR_WHITESPACE:L,CUSTOM_ELEMENT:te}=wV;let{IS_ALLOWED_URI:V}=wV,Q=null;const ee=Br({},[...yV,...k3,...E3,...T3,...bV]);let se=null;const pe=Br({},[...vV,...A3,...xV,...y2]);let ue=Object.seal(jie(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Oe=null,Fe=null,Se=!0,Ce=!0,qe=!1,Qe=!0,We=!1,Ie=!0,K=!1,ye=!1,Ne=!1,ce=!1,oe=!1,re=!1,Re=!0,Be=!1;const Te="user-content-";let lt=!0,Tt=!1,ut={},jt=null;const qt=Br({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Ft=null;const Ht=Br({},["audio","video","img","source","image","track"]);let we=null;const F=Br({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),X="http://www.w3.org/1998/Math/MathML",be="http://www.w3.org/2000/svg",ke="http://www.w3.org/1999/xhtml";let ge=ke,Ee=!1,le=null;const dt=Br({},[X,be,ke],C3);let et=Br({},["mi","mo","mn","ms","mtext"]),$=Br({},["annotation-xml"]);const Ue=Br({},["title","style","font","a","script"]);let tt=null;const ve=["application/xhtml+xml","text/html"],_e="text/html";let $e=null,Ct=null;const fe=n.createElement("form"),Y=function(nt){return nt instanceof RegExp||nt instanceof Function},G=function(){let nt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(Ct&&Ct===nt)){if((!nt||typeof nt!="object")&&(nt={}),nt=Sd(nt),tt=ve.indexOf(nt.PARSER_MEDIA_TYPE)===-1?_e:nt.PARSER_MEDIA_TYPE,$e=tt==="application/xhtml+xml"?C3:W2,Q=bc(nt,"ALLOWED_TAGS")?Br({},nt.ALLOWED_TAGS,$e):ee,se=bc(nt,"ALLOWED_ATTR")?Br({},nt.ALLOWED_ATTR,$e):pe,le=bc(nt,"ALLOWED_NAMESPACES")?Br({},nt.ALLOWED_NAMESPACES,C3):dt,we=bc(nt,"ADD_URI_SAFE_ATTR")?Br(Sd(F),nt.ADD_URI_SAFE_ATTR,$e):F,Ft=bc(nt,"ADD_DATA_URI_TAGS")?Br(Sd(Ht),nt.ADD_DATA_URI_TAGS,$e):Ht,jt=bc(nt,"FORBID_CONTENTS")?Br({},nt.FORBID_CONTENTS,$e):qt,Oe=bc(nt,"FORBID_TAGS")?Br({},nt.FORBID_TAGS,$e):Sd({}),Fe=bc(nt,"FORBID_ATTR")?Br({},nt.FORBID_ATTR,$e):Sd({}),ut=bc(nt,"USE_PROFILES")?nt.USE_PROFILES:!1,Se=nt.ALLOW_ARIA_ATTR!==!1,Ce=nt.ALLOW_DATA_ATTR!==!1,qe=nt.ALLOW_UNKNOWN_PROTOCOLS||!1,Qe=nt.ALLOW_SELF_CLOSE_IN_ATTR!==!1,We=nt.SAFE_FOR_TEMPLATES||!1,Ie=nt.SAFE_FOR_XML!==!1,K=nt.WHOLE_DOCUMENT||!1,ce=nt.RETURN_DOM||!1,oe=nt.RETURN_DOM_FRAGMENT||!1,re=nt.RETURN_TRUSTED_TYPE||!1,Ne=nt.FORCE_BODY||!1,Re=nt.SANITIZE_DOM!==!1,Be=nt.SANITIZE_NAMED_PROPS||!1,lt=nt.KEEP_CONTENT!==!1,Tt=nt.IN_PLACE||!1,V=nt.ALLOWED_URI_REGEXP||Oie,ge=nt.NAMESPACE||ke,et=nt.MATHML_TEXT_INTEGRATION_POINTS||et,$=nt.HTML_INTEGRATION_POINTS||$,ue=nt.CUSTOM_ELEMENT_HANDLING||{},nt.CUSTOM_ELEMENT_HANDLING&&Y(nt.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(ue.tagNameCheck=nt.CUSTOM_ELEMENT_HANDLING.tagNameCheck),nt.CUSTOM_ELEMENT_HANDLING&&Y(nt.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(ue.attributeNameCheck=nt.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),nt.CUSTOM_ELEMENT_HANDLING&&typeof nt.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(ue.allowCustomizedBuiltInElements=nt.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),We&&(Ce=!1),oe&&(ce=!0),ut&&(Q=Br({},bV),se=[],ut.html===!0&&(Br(Q,yV),Br(se,vV)),ut.svg===!0&&(Br(Q,k3),Br(se,A3),Br(se,y2)),ut.svgFilters===!0&&(Br(Q,E3),Br(se,A3),Br(se,y2)),ut.mathMl===!0&&(Br(Q,T3),Br(se,xV),Br(se,y2))),nt.ADD_TAGS&&(Q===ee&&(Q=Sd(Q)),Br(Q,nt.ADD_TAGS,$e)),nt.ADD_ATTR&&(se===pe&&(se=Sd(se)),Br(se,nt.ADD_ATTR,$e)),nt.ADD_URI_SAFE_ATTR&&Br(we,nt.ADD_URI_SAFE_ATTR,$e),nt.FORBID_CONTENTS&&(jt===qt&&(jt=Sd(jt)),Br(jt,nt.FORBID_CONTENTS,$e)),lt&&(Q["#text"]=!0),K&&Br(Q,["html","head","body"]),Q.table&&(Br(Q,["tbody"]),delete Oe.tbody),nt.TRUSTED_TYPES_POLICY){if(typeof nt.TRUSTED_TYPES_POLICY.createHTML!="function")throw Gv('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof nt.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Gv('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');k=nt.TRUSTED_TYPES_POLICY,C=k.createHTML("")}else k===void 0&&(k=RZe(m,s)),k!==null&&typeof C=="string"&&(C=k.createHTML(""));co&&co(nt),Ct=nt}},J=Br({},[...k3,...E3,...bZe]),xe=Br({},[...T3,...vZe]),De=function(nt){let Vt=S(nt);(!Vt||!Vt.tagName)&&(Vt={namespaceURI:ge,tagName:"template"});const pn=W2(nt.tagName),sr=W2(Vt.tagName);return le[nt.namespaceURI]?nt.namespaceURI===be?Vt.namespaceURI===ke?pn==="svg":Vt.namespaceURI===X?pn==="svg"&&(sr==="annotation-xml"||et[sr]):!!J[pn]:nt.namespaceURI===X?Vt.namespaceURI===ke?pn==="math":Vt.namespaceURI===be?pn==="math"&&$[sr]:!!xe[pn]:nt.namespaceURI===ke?Vt.namespaceURI===be&&!$[sr]||Vt.namespaceURI===X&&!et[sr]?!1:!xe[pn]&&(Ue[pn]||!J[pn]):!!(tt==="application/xhtml+xml"&&le[nt.namespaceURI]):!1},He=function(nt){Wv(t.removed,{element:nt});try{S(nt).removeChild(nt)}catch{v(nt)}},xt=function(nt,Vt){try{Wv(t.removed,{attribute:Vt.getAttributeNode(nt),from:Vt})}catch{Wv(t.removed,{attribute:null,from:Vt})}if(Vt.removeAttribute(nt),nt==="is")if(ce||oe)try{He(Vt)}catch{}else try{Vt.setAttribute(nt,"")}catch{}},Qt=function(nt){let Vt=null,pn=null;if(Ne)nt="<remove></remove>"+nt;else{const es=gV(nt,/^[\r\n\t ]+/);pn=es&&es[0]}tt==="application/xhtml+xml"&&ge===ke&&(nt='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+nt+"</body></html>");const sr=k?k.createHTML(nt):nt;if(ge===ke)try{Vt=new h().parseFromString(sr,tt)}catch{}if(!Vt||!Vt.documentElement){Vt=T.createDocument(ge,"template",null);try{Vt.documentElement.innerHTML=Ee?C:sr}catch{}}const Rs=Vt.body||Vt.documentElement;return nt&&pn&&Rs.insertBefore(n.createTextNode(pn),Rs.childNodes[0]||null),ge===ke?I.call(Vt,K?"html":"body")[0]:K?Vt.documentElement:Rs},On=function(nt){return R.call(nt.ownerDocument||nt,nt,c.SHOW_ELEMENT|c.SHOW_COMMENT|c.SHOW_TEXT|c.SHOW_PROCESSING_INSTRUCTION|c.SHOW_CDATA_SECTION,null)},Zt=function(nt){return nt instanceof d&&(typeof nt.nodeName!="string"||typeof nt.textContent!="string"||typeof nt.removeChild!="function"||!(nt.attributes instanceof u)||typeof nt.removeAttribute!="function"||typeof nt.setAttribute!="function"||typeof nt.namespaceURI!="string"||typeof nt.insertBefore!="function"||typeof nt.hasChildNodes!="function")},nn=function(nt){return typeof o=="function"&&nt instanceof o};function un(hn,nt,Vt){g2(hn,pn=>{pn.call(t,nt,Vt,Ct)})}const gr=function(nt){let Vt=null;if(un(B.beforeSanitizeElements,nt,null),Zt(nt))return He(nt),!0;const pn=$e(nt.nodeName);if(un(B.uponSanitizeElement,nt,{tagName:pn,allowedTags:Q}),Ie&&nt.hasChildNodes()&&!nn(nt.firstElementChild)&&Ja(/<[/\w!]/g,nt.innerHTML)&&Ja(/<[/\w!]/g,nt.textContent)||nt.nodeType===Yv.progressingInstruction||Ie&&nt.nodeType===Yv.comment&&Ja(/<[/\w]/g,nt.data))return He(nt),!0;if(!Q[pn]||Oe[pn]){if(!Oe[pn]&&ns(pn)&&(ue.tagNameCheck instanceof RegExp&&Ja(ue.tagNameCheck,pn)||ue.tagNameCheck instanceof Function&&ue.tagNameCheck(pn)))return!1;if(lt&&!jt[pn]){const sr=S(nt)||nt.parentNode,Rs=w(nt)||nt.childNodes;if(Rs&&sr){const es=Rs.length;for(let Di=es-1;Di>=0;--Di){const di=b(Rs[Di],!0);di.__removalCount=(nt.__removalCount||0)+1,sr.insertBefore(di,x(nt))}}}return He(nt),!0}return nt instanceof l&&!De(nt)||(pn==="noscript"||pn==="noembed"||pn==="noframes")&&Ja(/<\/no(script|embed|frames)/i,nt.innerHTML)?(He(nt),!0):(We&&nt.nodeType===Yv.text&&(Vt=nt.textContent,g2([D,W,O],sr=>{Vt=Hv(Vt,sr," ")}),nt.textContent!==Vt&&(Wv(t.removed,{element:nt.cloneNode()}),nt.textContent=Vt)),un(B.afterSanitizeElements,nt,null),!1)},Nr=function(nt,Vt,pn){if(Re&&(Vt==="id"||Vt==="name")&&(pn in n||pn in fe))return!1;if(!(Ce&&!Fe[Vt]&&Ja(Z,Vt))){if(!(Se&&Ja(U,Vt))){if(!se[Vt]||Fe[Vt]){if(!(ns(nt)&&(ue.tagNameCheck instanceof RegExp&&Ja(ue.tagNameCheck,nt)||ue.tagNameCheck instanceof Function&&ue.tagNameCheck(nt))&&(ue.attributeNameCheck instanceof RegExp&&Ja(ue.attributeNameCheck,Vt)||ue.attributeNameCheck instanceof Function&&ue.attributeNameCheck(Vt))||Vt==="is"&&ue.allowCustomizedBuiltInElements&&(ue.tagNameCheck instanceof RegExp&&Ja(ue.tagNameCheck,pn)||ue.tagNameCheck instanceof Function&&ue.tagNameCheck(pn))))return!1}else if(!we[Vt]){if(!Ja(V,Hv(pn,L,""))){if(!((Vt==="src"||Vt==="xlink:href"||Vt==="href")&&nt!=="script"&&pZe(pn,"data:")===0&&Ft[nt])){if(!(qe&&!Ja(H,Hv(pn,L,"")))){if(pn)return!1}}}}}}return!0},ns=function(nt){return nt!=="annotation-xml"&&gV(nt,te)},rs=function(nt){un(B.beforeSanitizeAttributes,nt,null);const{attributes:Vt}=nt;if(!Vt||Zt(nt))return;const pn={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:se,forceKeepAttr:void 0};let sr=Vt.length;for(;sr--;){const Rs=Vt[sr],{name:es,namespaceURI:Di,value:di}=Rs,Wa=$e(es),ha=di;let Hs=es==="value"?ha:mZe(ha);if(pn.attrName=Wa,pn.attrValue=Hs,pn.keepAttr=!0,pn.forceKeepAttr=void 0,un(B.uponSanitizeAttribute,nt,pn),Hs=pn.attrValue,Be&&(Wa==="id"||Wa==="name")&&(xt(es,nt),Hs=Te+Hs),Ie&&Ja(/((--!?|])>)|<\/(style|title)/i,Hs)){xt(es,nt);continue}if(pn.forceKeepAttr)continue;if(!pn.keepAttr){xt(es,nt);continue}if(!Qe&&Ja(/\/>/i,Hs)){xt(es,nt);continue}We&&g2([D,W,O],wl=>{Hs=Hv(Hs,wl," ")});const Go=$e(nt.nodeName);if(!Nr(Go,Wa,Hs)){xt(es,nt);continue}if(k&&typeof m=="object"&&typeof m.getAttributeType=="function"&&!Di)switch(m.getAttributeType(Go,Wa)){case"TrustedHTML":{Hs=k.createHTML(Hs);break}case"TrustedScriptURL":{Hs=k.createScriptURL(Hs);break}}if(Hs!==ha)try{Di?nt.setAttributeNS(Di,es,Hs):nt.setAttribute(es,Hs),Zt(nt)?He(nt):mV(t.removed)}catch{xt(es,nt)}}un(B.afterSanitizeAttributes,nt,null)},kr=function hn(nt){let Vt=null;const pn=On(nt);for(un(B.beforeSanitizeShadowDOM,nt,null);Vt=pn.nextNode();)un(B.uponSanitizeShadowNode,Vt,null),gr(Vt),rs(Vt),Vt.content instanceof i&&hn(Vt.content);un(B.afterSanitizeShadowDOM,nt,null)};return t.sanitize=function(hn){let nt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Vt=null,pn=null,sr=null,Rs=null;if(Ee=!hn,Ee&&(hn="<!-->"),typeof hn!="string"&&!nn(hn))if(typeof hn.toString=="function"){if(hn=hn.toString(),typeof hn!="string")throw Gv("dirty is not a string, aborting")}else throw Gv("toString is not a function");if(!t.isSupported)return hn;if(ye||G(nt),t.removed=[],typeof hn=="string"&&(Tt=!1),Tt){if(hn.nodeName){const di=$e(hn.nodeName);if(!Q[di]||Oe[di])throw Gv("root node is forbidden and cannot be sanitized in-place")}}else if(hn instanceof o)Vt=Qt("<!---->"),pn=Vt.ownerDocument.importNode(hn,!0),pn.nodeType===Yv.element&&pn.nodeName==="BODY"||pn.nodeName==="HTML"?Vt=pn:Vt.appendChild(pn);else{if(!ce&&!We&&!K&&hn.indexOf("<")===-1)return k&&re?k.createHTML(hn):hn;if(Vt=Qt(hn),!Vt)return ce?null:re?C:""}Vt&&Ne&&He(Vt.firstChild);const es=On(Tt?hn:Vt);for(;sr=es.nextNode();)gr(sr),rs(sr),sr.content instanceof i&&kr(sr.content);if(Tt)return hn;if(ce){if(oe)for(Rs=N.call(Vt.ownerDocument);Vt.firstChild;)Rs.appendChild(Vt.firstChild);else Rs=Vt;return(se.shadowroot||se.shadowrootmode)&&(Rs=P.call(r,Rs,!0)),Rs}let Di=K?Vt.outerHTML:Vt.innerHTML;return K&&Q["!doctype"]&&Vt.ownerDocument&&Vt.ownerDocument.doctype&&Vt.ownerDocument.doctype.name&&Ja(Pie,Vt.ownerDocument.doctype.name)&&(Di="<!DOCTYPE "+Vt.ownerDocument.doctype.name+`>
`+Di),We&&g2([D,W,O],di=>{Di=Hv(Di,di," ")}),k&&re?k.createHTML(Di):Di},t.setConfig=function(){let hn=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};G(hn),ye=!0},t.clearConfig=function(){Ct=null,ye=!1},t.isValidAttribute=function(hn,nt,Vt){Ct||G({});const pn=$e(hn),sr=$e(nt);return Nr(pn,sr,Vt)},t.addHook=function(hn,nt){typeof nt=="function"&&Wv(B[hn],nt)},t.removeHook=function(hn,nt){if(nt!==void 0){const Vt=fZe(B[hn],nt);return Vt===-1?void 0:hZe(B[hn],Vt,1)[0]}return mV(B[hn])},t.removeHooks=function(hn){B[hn]=[]},t.removeAllHooks=function(){B=_V()},t}var Ay=Die(),Fie=Object.defineProperty,ie=(e,t)=>Fie(e,"name",{value:t,configurable:!0}),NZe=(e,t)=>{for(var n in t)Fie(e,n,{get:t[n],enumerable:!0})},vd={trace:0,debug:1,info:2,warn:3,error:4,fatal:5},zt={trace:ie((...e)=>{},"trace"),debug:ie((...e)=>{},"debug"),info:ie((...e)=>{},"info"),warn:ie((...e)=>{},"warn"),error:ie((...e)=>{},"error"),fatal:ie((...e)=>{},"fatal")},fF=ie(function(e="fatal"){let t=vd.fatal;typeof e=="string"?e.toLowerCase()in vd&&(t=vd[e]):typeof e=="number"&&(t=e),zt.trace=()=>{},zt.debug=()=>{},zt.info=()=>{},zt.warn=()=>{},zt.error=()=>{},zt.fatal=()=>{},t<=vd.fatal&&(zt.fatal=console.error?console.error.bind(console,Dl("FATAL"),"color: orange"):console.log.bind(console,"\x1B[35m",Dl("FATAL"))),t<=vd.error&&(zt.error=console.error?console.error.bind(console,Dl("ERROR"),"color: orange"):console.log.bind(console,"\x1B[31m",Dl("ERROR"))),t<=vd.warn&&(zt.warn=console.warn?console.warn.bind(console,Dl("WARN"),"color: orange"):console.log.bind(console,"\x1B[33m",Dl("WARN"))),t<=vd.info&&(zt.info=console.info?console.info.bind(console,Dl("INFO"),"color: lightblue"):console.log.bind(console,"\x1B[34m",Dl("INFO"))),t<=vd.debug&&(zt.debug=console.debug?console.debug.bind(console,Dl("DEBUG"),"color: lightgreen"):console.log.bind(console,"\x1B[32m",Dl("DEBUG"))),t<=vd.trace&&(zt.trace=console.debug?console.debug.bind(console,Dl("TRACE"),"color: lightgreen"):console.log.bind(console,"\x1B[32m",Dl("TRACE")))},"setLogLevel"),Dl=ie(e=>`%c${tZe().format("ss.SSS")} : ${e} : `,"format"),Lie=/^-{3}\s*[\n\r](.*?)[\n\r]-{3}\s*[\n\r]+/s,Ux=/%{2}{\s*(?:(\w+)\s*:|(\w+))\s*(?:(\w+)|((?:(?!}%{2}).|\r?\n)*))?\s*(?:}%{2})?/gi,MZe=/\s*%%.*\n/gm,q0,Bie=(q0=class extends Error{constructor(t){super(t),this.name="UnknownDiagramError"}},ie(q0,"UnknownDiagramError"),q0),Ry={},hF=ie(function(e,t){e=e.replace(Lie,"").replace(Ux,"").replace(MZe,`
`);for(const[n,{detector:r}]of Object.entries(Ry))if(r(e,t))return n;throw new Bie(`No diagram type detected matching given configuration for text: ${e}`)},"detectType"),$ie=ie((...e)=>{for(const{id:t,detector:n,loader:r}of e)zie(t,n,r)},"registerLazyLoadedDiagrams"),zie=ie((e,t,n)=>{Ry[e]&&zt.warn(`Detector with key ${e} already exists. Overwriting.`),Ry[e]={detector:t,loader:n},zt.debug(`Detector with key ${e} added${n?" with loader":""}`)},"addDetector"),IZe=ie(e=>Ry[e].loader,"getDiagramLoader"),V4=ie((e,t,{depth:n=2,clobber:r=!1}={})=>{const s={depth:n,clobber:r};return Array.isArray(t)&&!Array.isArray(e)?(t.forEach(i=>V4(e,i,s)),e):Array.isArray(t)&&Array.isArray(e)?(t.forEach(i=>{e.includes(i)||e.push(i)}),e):e===void 0||n<=0?e!=null&&typeof e=="object"&&typeof t=="object"?Object.assign(e,t):t:(t!==void 0&&typeof e=="object"&&typeof t=="object"&&Object.keys(t).forEach(i=>{typeof t[i]=="object"&&(e[i]===void 0||typeof e[i]=="object")?(e[i]===void 0&&(e[i]=Array.isArray(t[i])?[]:{}),e[i]=V4(e[i],t[i],{depth:n-1,clobber:r})):(r||typeof e[i]!="object"&&typeof t[i]!="object")&&(e[i]=t[i])}),e)},"assignWithDepth"),Ca=V4,QT="#ffffff",eA="#f2f2f2",to=ie((e,t)=>t?vt(e,{s:-40,l:10}):vt(e,{s:-40,l:-10}),"mkBorder"),V0,jZe=(V0=class{constructor(){this.background="#f4f4f4",this.primaryColor="#fff4dd",this.noteBkgColor="#fff5ad",this.noteTextColor="#333",this.THEME_COLOR_LIMIT=12,this.fontFamily='"trebuchet ms", verdana, arial, sans-serif',this.fontSize="16px"}updateColors(){var n,r,s,i,a,o,l,c,u,d,h,m,y,b,v,x,w,S,k,C,T;if(this.primaryTextColor=this.primaryTextColor||(this.darkMode?"#eee":"#333"),this.secondaryColor=this.secondaryColor||vt(this.primaryColor,{h:-120}),this.tertiaryColor=this.tertiaryColor||vt(this.primaryColor,{h:180,l:5}),this.primaryBorderColor=this.primaryBorderColor||to(this.primaryColor,this.darkMode),this.secondaryBorderColor=this.secondaryBorderColor||to(this.secondaryColor,this.darkMode),this.tertiaryBorderColor=this.tertiaryBorderColor||to(this.tertiaryColor,this.darkMode),this.noteBorderColor=this.noteBorderColor||to(this.noteBkgColor,this.darkMode),this.noteBkgColor=this.noteBkgColor||"#fff5ad",this.noteTextColor=this.noteTextColor||"#333",this.secondaryTextColor=this.secondaryTextColor||cn(this.secondaryColor),this.tertiaryTextColor=this.tertiaryTextColor||cn(this.tertiaryColor),this.lineColor=this.lineColor||cn(this.background),this.arrowheadColor=this.arrowheadColor||cn(this.background),this.textColor=this.textColor||this.primaryTextColor,this.border2=this.border2||this.tertiaryBorderColor,this.nodeBkg=this.nodeBkg||this.primaryColor,this.mainBkg=this.mainBkg||this.primaryColor,this.nodeBorder=this.nodeBorder||this.primaryBorderColor,this.clusterBkg=this.clusterBkg||this.tertiaryColor,this.clusterBorder=this.clusterBorder||this.tertiaryBorderColor,this.defaultLinkColor=this.defaultLinkColor||this.lineColor,this.titleColor=this.titleColor||this.tertiaryTextColor,this.edgeLabelBackground=this.edgeLabelBackground||(this.darkMode?zn(this.secondaryColor,30):this.secondaryColor),this.nodeTextColor=this.nodeTextColor||this.primaryTextColor,this.actorBorder=this.actorBorder||this.primaryBorderColor,this.actorBkg=this.actorBkg||this.mainBkg,this.actorTextColor=this.actorTextColor||this.primaryTextColor,this.actorLineColor=this.actorLineColor||this.actorBorder,this.labelBoxBkgColor=this.labelBoxBkgColor||this.actorBkg,this.signalColor=this.signalColor||this.textColor,this.signalTextColor=this.signalTextColor||this.textColor,this.labelBoxBorderColor=this.labelBoxBorderColor||this.actorBorder,this.labelTextColor=this.labelTextColor||this.actorTextColor,this.loopTextColor=this.loopTextColor||this.actorTextColor,this.activationBorderColor=this.activationBorderColor||zn(this.secondaryColor,10),this.activationBkgColor=this.activationBkgColor||this.secondaryColor,this.sequenceNumberColor=this.sequenceNumberColor||cn(this.lineColor),this.sectionBkgColor=this.sectionBkgColor||this.tertiaryColor,this.altSectionBkgColor=this.altSectionBkgColor||"white",this.sectionBkgColor=this.sectionBkgColor||this.secondaryColor,this.sectionBkgColor2=this.sectionBkgColor2||this.primaryColor,this.excludeBkgColor=this.excludeBkgColor||"#eeeeee",this.taskBorderColor=this.taskBorderColor||this.primaryBorderColor,this.taskBkgColor=this.taskBkgColor||this.primaryColor,this.activeTaskBorderColor=this.activeTaskBorderColor||this.primaryColor,this.activeTaskBkgColor=this.activeTaskBkgColor||Sn(this.primaryColor,23),this.gridColor=this.gridColor||"lightgrey",this.doneTaskBkgColor=this.doneTaskBkgColor||"lightgrey",this.doneTaskBorderColor=this.doneTaskBorderColor||"grey",this.critBorderColor=this.critBorderColor||"#ff8888",this.critBkgColor=this.critBkgColor||"red",this.todayLineColor=this.todayLineColor||"red",this.taskTextColor=this.taskTextColor||this.textColor,this.taskTextOutsideColor=this.taskTextOutsideColor||this.textColor,this.taskTextLightColor=this.taskTextLightColor||this.textColor,this.taskTextColor=this.taskTextColor||this.primaryTextColor,this.taskTextDarkColor=this.taskTextDarkColor||this.textColor,this.taskTextClickableColor=this.taskTextClickableColor||"#003163",this.personBorder=this.personBorder||this.primaryBorderColor,this.personBkg=this.personBkg||this.mainBkg,this.darkMode?(this.rowOdd=this.rowOdd||zn(this.mainBkg,5)||"#ffffff",this.rowEven=this.rowEven||zn(this.mainBkg,10)):(this.rowOdd=this.rowOdd||Sn(this.mainBkg,75)||"#ffffff",this.rowEven=this.rowEven||Sn(this.mainBkg,5)),this.transitionColor=this.transitionColor||this.lineColor,this.transitionLabelColor=this.transitionLabelColor||this.textColor,this.stateLabelColor=this.stateLabelColor||this.stateBkg||this.primaryTextColor,this.stateBkg=this.stateBkg||this.mainBkg,this.labelBackgroundColor=this.labelBackgroundColor||this.stateBkg,this.compositeBackground=this.compositeBackground||this.background||this.tertiaryColor,this.altBackground=this.altBackground||this.tertiaryColor,this.compositeTitleBackground=this.compositeTitleBackground||this.mainBkg,this.compositeBorder=this.compositeBorder||this.nodeBorder,this.innerEndBackground=this.nodeBorder,this.errorBkgColor=this.errorBkgColor||this.tertiaryColor,this.errorTextColor=this.errorTextColor||this.tertiaryTextColor,this.transitionColor=this.transitionColor||this.lineColor,this.specialStateColor=this.lineColor,this.cScale0=this.cScale0||this.primaryColor,this.cScale1=this.cScale1||this.secondaryColor,this.cScale2=this.cScale2||this.tertiaryColor,this.cScale3=this.cScale3||vt(this.primaryColor,{h:30}),this.cScale4=this.cScale4||vt(this.primaryColor,{h:60}),this.cScale5=this.cScale5||vt(this.primaryColor,{h:90}),this.cScale6=this.cScale6||vt(this.primaryColor,{h:120}),this.cScale7=this.cScale7||vt(this.primaryColor,{h:150}),this.cScale8=this.cScale8||vt(this.primaryColor,{h:210,l:150}),this.cScale9=this.cScale9||vt(this.primaryColor,{h:270}),this.cScale10=this.cScale10||vt(this.primaryColor,{h:300}),this.cScale11=this.cScale11||vt(this.primaryColor,{h:330}),this.darkMode)for(let R=0;R<this.THEME_COLOR_LIMIT;R++)this["cScale"+R]=zn(this["cScale"+R],75);else for(let R=0;R<this.THEME_COLOR_LIMIT;R++)this["cScale"+R]=zn(this["cScale"+R],25);for(let R=0;R<this.THEME_COLOR_LIMIT;R++)this["cScaleInv"+R]=this["cScaleInv"+R]||cn(this["cScale"+R]);for(let R=0;R<this.THEME_COLOR_LIMIT;R++)this.darkMode?this["cScalePeer"+R]=this["cScalePeer"+R]||Sn(this["cScale"+R],10):this["cScalePeer"+R]=this["cScalePeer"+R]||zn(this["cScale"+R],10);this.scaleLabelColor=this.scaleLabelColor||this.labelTextColor;for(let R=0;R<this.THEME_COLOR_LIMIT;R++)this["cScaleLabel"+R]=this["cScaleLabel"+R]||this.scaleLabelColor;const t=this.darkMode?-4:-1;for(let R=0;R<5;R++)this["surface"+R]=this["surface"+R]||vt(this.mainBkg,{h:180,s:-15,l:t*(5+R*3)}),this["surfacePeer"+R]=this["surfacePeer"+R]||vt(this.mainBkg,{h:180,s:-15,l:t*(8+R*3)});this.classText=this.classText||this.textColor,this.fillType0=this.fillType0||this.primaryColor,this.fillType1=this.fillType1||this.secondaryColor,this.fillType2=this.fillType2||vt(this.primaryColor,{h:64}),this.fillType3=this.fillType3||vt(this.secondaryColor,{h:64}),this.fillType4=this.fillType4||vt(this.primaryColor,{h:-64}),this.fillType5=this.fillType5||vt(this.secondaryColor,{h:-64}),this.fillType6=this.fillType6||vt(this.primaryColor,{h:128}),this.fillType7=this.fillType7||vt(this.secondaryColor,{h:128}),this.pie1=this.pie1||this.primaryColor,this.pie2=this.pie2||this.secondaryColor,this.pie3=this.pie3||this.tertiaryColor,this.pie4=this.pie4||vt(this.primaryColor,{l:-10}),this.pie5=this.pie5||vt(this.secondaryColor,{l:-10}),this.pie6=this.pie6||vt(this.tertiaryColor,{l:-10}),this.pie7=this.pie7||vt(this.primaryColor,{h:60,l:-10}),this.pie8=this.pie8||vt(this.primaryColor,{h:-60,l:-10}),this.pie9=this.pie9||vt(this.primaryColor,{h:120,l:0}),this.pie10=this.pie10||vt(this.primaryColor,{h:60,l:-20}),this.pie11=this.pie11||vt(this.primaryColor,{h:-60,l:-20}),this.pie12=this.pie12||vt(this.primaryColor,{h:120,l:-10}),this.pieTitleTextSize=this.pieTitleTextSize||"25px",this.pieTitleTextColor=this.pieTitleTextColor||this.taskTextDarkColor,this.pieSectionTextSize=this.pieSectionTextSize||"17px",this.pieSectionTextColor=this.pieSectionTextColor||this.textColor,this.pieLegendTextSize=this.pieLegendTextSize||"17px",this.pieLegendTextColor=this.pieLegendTextColor||this.taskTextDarkColor,this.pieStrokeColor=this.pieStrokeColor||"black",this.pieStrokeWidth=this.pieStrokeWidth||"2px",this.pieOuterStrokeWidth=this.pieOuterStrokeWidth||"2px",this.pieOuterStrokeColor=this.pieOuterStrokeColor||"black",this.pieOpacity=this.pieOpacity||"0.7",this.radar={axisColor:((n=this.radar)==null?void 0:n.axisColor)||this.lineColor,axisStrokeWidth:((r=this.radar)==null?void 0:r.axisStrokeWidth)||2,axisLabelFontSize:((s=this.radar)==null?void 0:s.axisLabelFontSize)||12,curveOpacity:((i=this.radar)==null?void 0:i.curveOpacity)||.5,curveStrokeWidth:((a=this.radar)==null?void 0:a.curveStrokeWidth)||2,graticuleColor:((o=this.radar)==null?void 0:o.graticuleColor)||"#DEDEDE",graticuleStrokeWidth:((l=this.radar)==null?void 0:l.graticuleStrokeWidth)||1,graticuleOpacity:((c=this.radar)==null?void 0:c.graticuleOpacity)||.3,legendBoxSize:((u=this.radar)==null?void 0:u.legendBoxSize)||12,legendFontSize:((d=this.radar)==null?void 0:d.legendFontSize)||12},this.archEdgeColor=this.archEdgeColor||"#777",this.archEdgeArrowColor=this.archEdgeArrowColor||"#777",this.archEdgeWidth=this.archEdgeWidth||"3",this.archGroupBorderColor=this.archGroupBorderColor||"#000",this.archGroupBorderWidth=this.archGroupBorderWidth||"2px",this.quadrant1Fill=this.quadrant1Fill||this.primaryColor,this.quadrant2Fill=this.quadrant2Fill||vt(this.primaryColor,{r:5,g:5,b:5}),this.quadrant3Fill=this.quadrant3Fill||vt(this.primaryColor,{r:10,g:10,b:10}),this.quadrant4Fill=this.quadrant4Fill||vt(this.primaryColor,{r:15,g:15,b:15}),this.quadrant1TextFill=this.quadrant1TextFill||this.primaryTextColor,this.quadrant2TextFill=this.quadrant2TextFill||vt(this.primaryTextColor,{r:-5,g:-5,b:-5}),this.quadrant3TextFill=this.quadrant3TextFill||vt(this.primaryTextColor,{r:-10,g:-10,b:-10}),this.quadrant4TextFill=this.quadrant4TextFill||vt(this.primaryTextColor,{r:-15,g:-15,b:-15}),this.quadrantPointFill=this.quadrantPointFill||c_(this.quadrant1Fill)?Sn(this.quadrant1Fill):zn(this.quadrant1Fill),this.quadrantPointTextFill=this.quadrantPointTextFill||this.primaryTextColor,this.quadrantXAxisTextFill=this.quadrantXAxisTextFill||this.primaryTextColor,this.quadrantYAxisTextFill=this.quadrantYAxisTextFill||this.primaryTextColor,this.quadrantInternalBorderStrokeFill=this.quadrantInternalBorderStrokeFill||this.primaryBorderColor,this.quadrantExternalBorderStrokeFill=this.quadrantExternalBorderStrokeFill||this.primaryBorderColor,this.quadrantTitleFill=this.quadrantTitleFill||this.primaryTextColor,this.xyChart={backgroundColor:((h=this.xyChart)==null?void 0:h.backgroundColor)||this.background,titleColor:((m=this.xyChart)==null?void 0:m.titleColor)||this.primaryTextColor,xAxisTitleColor:((y=this.xyChart)==null?void 0:y.xAxisTitleColor)||this.primaryTextColor,xAxisLabelColor:((b=this.xyChart)==null?void 0:b.xAxisLabelColor)||this.primaryTextColor,xAxisTickColor:((v=this.xyChart)==null?void 0:v.xAxisTickColor)||this.primaryTextColor,xAxisLineColor:((x=this.xyChart)==null?void 0:x.xAxisLineColor)||this.primaryTextColor,yAxisTitleColor:((w=this.xyChart)==null?void 0:w.yAxisTitleColor)||this.primaryTextColor,yAxisLabelColor:((S=this.xyChart)==null?void 0:S.yAxisLabelColor)||this.primaryTextColor,yAxisTickColor:((k=this.xyChart)==null?void 0:k.yAxisTickColor)||this.primaryTextColor,yAxisLineColor:((C=this.xyChart)==null?void 0:C.yAxisLineColor)||this.primaryTextColor,plotColorPalette:((T=this.xyChart)==null?void 0:T.plotColorPalette)||"#FFF4DD,#FFD8B1,#FFA07A,#ECEFF1,#D6DBDF,#C3E0A8,#FFB6A4,#FFD74D,#738FA7,#FFFFF0"},this.requirementBackground=this.requirementBackground||this.primaryColor,this.requirementBorderColor=this.requirementBorderColor||this.primaryBorderColor,this.requirementBorderSize=this.requirementBorderSize||"1",this.requirementTextColor=this.requirementTextColor||this.primaryTextColor,this.relationColor=this.relationColor||this.lineColor,this.relationLabelBackground=this.relationLabelBackground||(this.darkMode?zn(this.secondaryColor,30):this.secondaryColor),this.relationLabelColor=this.relationLabelColor||this.actorTextColor,this.git0=this.git0||this.primaryColor,this.git1=this.git1||this.secondaryColor,this.git2=this.git2||this.tertiaryColor,this.git3=this.git3||vt(this.primaryColor,{h:-30}),this.git4=this.git4||vt(this.primaryColor,{h:-60}),this.git5=this.git5||vt(this.primaryColor,{h:-90}),this.git6=this.git6||vt(this.primaryColor,{h:60}),this.git7=this.git7||vt(this.primaryColor,{h:120}),this.darkMode?(this.git0=Sn(this.git0,25),this.git1=Sn(this.git1,25),this.git2=Sn(this.git2,25),this.git3=Sn(this.git3,25),this.git4=Sn(this.git4,25),this.git5=Sn(this.git5,25),this.git6=Sn(this.git6,25),this.git7=Sn(this.git7,25)):(this.git0=zn(this.git0,25),this.git1=zn(this.git1,25),this.git2=zn(this.git2,25),this.git3=zn(this.git3,25),this.git4=zn(this.git4,25),this.git5=zn(this.git5,25),this.git6=zn(this.git6,25),this.git7=zn(this.git7,25)),this.gitInv0=this.gitInv0||cn(this.git0),this.gitInv1=this.gitInv1||cn(this.git1),this.gitInv2=this.gitInv2||cn(this.git2),this.gitInv3=this.gitInv3||cn(this.git3),this.gitInv4=this.gitInv4||cn(this.git4),this.gitInv5=this.gitInv5||cn(this.git5),this.gitInv6=this.gitInv6||cn(this.git6),this.gitInv7=this.gitInv7||cn(this.git7),this.branchLabelColor=this.branchLabelColor||(this.darkMode?"black":this.labelTextColor),this.gitBranchLabel0=this.gitBranchLabel0||this.branchLabelColor,this.gitBranchLabel1=this.gitBranchLabel1||this.branchLabelColor,this.gitBranchLabel2=this.gitBranchLabel2||this.branchLabelColor,this.gitBranchLabel3=this.gitBranchLabel3||this.branchLabelColor,this.gitBranchLabel4=this.gitBranchLabel4||this.branchLabelColor,this.gitBranchLabel5=this.gitBranchLabel5||this.branchLabelColor,this.gitBranchLabel6=this.gitBranchLabel6||this.branchLabelColor,this.gitBranchLabel7=this.gitBranchLabel7||this.branchLabelColor,this.tagLabelColor=this.tagLabelColor||this.primaryTextColor,this.tagLabelBackground=this.tagLabelBackground||this.primaryColor,this.tagLabelBorder=this.tagBorder||this.primaryBorderColor,this.tagLabelFontSize=this.tagLabelFontSize||"10px",this.commitLabelColor=this.commitLabelColor||this.secondaryTextColor,this.commitLabelBackground=this.commitLabelBackground||this.secondaryColor,this.commitLabelFontSize=this.commitLabelFontSize||"10px",this.attributeBackgroundColorOdd=this.attributeBackgroundColorOdd||QT,this.attributeBackgroundColorEven=this.attributeBackgroundColorEven||eA}calculate(t){if(typeof t!="object"){this.updateColors();return}const n=Object.keys(t);n.forEach(r=>{this[r]=t[r]}),this.updateColors(),n.forEach(r=>{this[r]=t[r]})}},ie(V0,"Theme"),V0),OZe=ie(e=>{const t=new jZe;return t.calculate(e),t},"getThemeVariables"),W0,PZe=(W0=class{constructor(){this.background="#333",this.primaryColor="#1f2020",this.secondaryColor=Sn(this.primaryColor,16),this.tertiaryColor=vt(this.primaryColor,{h:-160}),this.primaryBorderColor=cn(this.background),this.secondaryBorderColor=to(this.secondaryColor,this.darkMode),this.tertiaryBorderColor=to(this.tertiaryColor,this.darkMode),this.primaryTextColor=cn(this.primaryColor),this.secondaryTextColor=cn(this.secondaryColor),this.tertiaryTextColor=cn(this.tertiaryColor),this.lineColor=cn(this.background),this.textColor=cn(this.background),this.mainBkg="#1f2020",this.secondBkg="calculated",this.mainContrastColor="lightgrey",this.darkTextColor=Sn(cn("#323D47"),10),this.lineColor="calculated",this.border1="#ccc",this.border2=zx(255,255,255,.25),this.arrowheadColor="calculated",this.fontFamily='"trebuchet ms", verdana, arial, sans-serif',this.fontSize="16px",this.labelBackground="#181818",this.textColor="#ccc",this.THEME_COLOR_LIMIT=12,this.nodeBkg="calculated",this.nodeBorder="calculated",this.clusterBkg="calculated",this.clusterBorder="calculated",this.defaultLinkColor="calculated",this.titleColor="#F9FFFE",this.edgeLabelBackground="calculated",this.actorBorder="calculated",this.actorBkg="calculated",this.actorTextColor="calculated",this.actorLineColor="calculated",this.signalColor="calculated",this.signalTextColor="calculated",this.labelBoxBkgColor="calculated",this.labelBoxBorderColor="calculated",this.labelTextColor="calculated",this.loopTextColor="calculated",this.noteBorderColor="calculated",this.noteBkgColor="#fff5ad",this.noteTextColor="calculated",this.activationBorderColor="calculated",this.activationBkgColor="calculated",this.sequenceNumberColor="black",this.sectionBkgColor=zn("#EAE8D9",30),this.altSectionBkgColor="calculated",this.sectionBkgColor2="#EAE8D9",this.excludeBkgColor=zn(this.sectionBkgColor,10),this.taskBorderColor=zx(255,255,255,70),this.taskBkgColor="calculated",this.taskTextColor="calculated",this.taskTextLightColor="calculated",this.taskTextOutsideColor="calculated",this.taskTextClickableColor="#003163",this.activeTaskBorderColor=zx(255,255,255,50),this.activeTaskBkgColor="#81B1DB",this.gridColor="calculated",this.doneTaskBkgColor="calculated",this.doneTaskBorderColor="grey",this.critBorderColor="#E83737",this.critBkgColor="#E83737",this.taskTextDarkColor="calculated",this.todayLineColor="#DB5757",this.personBorder=this.primaryBorderColor,this.personBkg=this.mainBkg,this.archEdgeColor="calculated",this.archEdgeArrowColor="calculated",this.archEdgeWidth="3",this.archGroupBorderColor=this.primaryBorderColor,this.archGroupBorderWidth="2px",this.rowOdd=this.rowOdd||Sn(this.mainBkg,5)||"#ffffff",this.rowEven=this.rowEven||zn(this.mainBkg,10),this.labelColor="calculated",this.errorBkgColor="#a44141",this.errorTextColor="#ddd"}updateColors(){var t,n,r,s,i,a,o,l,c,u,d,h,m,y,b,v,x,w,S,k,C;this.secondBkg=Sn(this.mainBkg,16),this.lineColor=this.mainContrastColor,this.arrowheadColor=this.mainContrastColor,this.nodeBkg=this.mainBkg,this.nodeBorder=this.border1,this.clusterBkg=this.secondBkg,this.clusterBorder=this.border2,this.defaultLinkColor=this.lineColor,this.edgeLabelBackground=Sn(this.labelBackground,25),this.actorBorder=this.border1,this.actorBkg=this.mainBkg,this.actorTextColor=this.mainContrastColor,this.actorLineColor=this.actorBorder,this.signalColor=this.mainContrastColor,this.signalTextColor=this.mainContrastColor,this.labelBoxBkgColor=this.actorBkg,this.labelBoxBorderColor=this.actorBorder,this.labelTextColor=this.mainContrastColor,this.loopTextColor=this.mainContrastColor,this.noteBorderColor=this.secondaryBorderColor,this.noteBkgColor=this.secondBkg,this.noteTextColor=this.secondaryTextColor,this.activationBorderColor=this.border1,this.activationBkgColor=this.secondBkg,this.altSectionBkgColor=this.background,this.taskBkgColor=Sn(this.mainBkg,23),this.taskTextColor=this.darkTextColor,this.taskTextLightColor=this.mainContrastColor,this.taskTextOutsideColor=this.taskTextLightColor,this.gridColor=this.mainContrastColor,this.doneTaskBkgColor=this.mainContrastColor,this.taskTextDarkColor=this.darkTextColor,this.archEdgeColor=this.lineColor,this.archEdgeArrowColor=this.lineColor,this.transitionColor=this.transitionColor||this.lineColor,this.transitionLabelColor=this.transitionLabelColor||this.textColor,this.stateLabelColor=this.stateLabelColor||this.stateBkg||this.primaryTextColor,this.stateBkg=this.stateBkg||this.mainBkg,this.labelBackgroundColor=this.labelBackgroundColor||this.stateBkg,this.compositeBackground=this.compositeBackground||this.background||this.tertiaryColor,this.altBackground=this.altBackground||"#555",this.compositeTitleBackground=this.compositeTitleBackground||this.mainBkg,this.compositeBorder=this.compositeBorder||this.nodeBorder,this.innerEndBackground=this.primaryBorderColor,this.specialStateColor="#f4f4f4",this.errorBkgColor=this.errorBkgColor||this.tertiaryColor,this.errorTextColor=this.errorTextColor||this.tertiaryTextColor,this.fillType0=this.primaryColor,this.fillType1=this.secondaryColor,this.fillType2=vt(this.primaryColor,{h:64}),this.fillType3=vt(this.secondaryColor,{h:64}),this.fillType4=vt(this.primaryColor,{h:-64}),this.fillType5=vt(this.secondaryColor,{h:-64}),this.fillType6=vt(this.primaryColor,{h:128}),this.fillType7=vt(this.secondaryColor,{h:128}),this.cScale1=this.cScale1||"#0b0000",this.cScale2=this.cScale2||"#4d1037",this.cScale3=this.cScale3||"#3f5258",this.cScale4=this.cScale4||"#4f2f1b",this.cScale5=this.cScale5||"#6e0a0a",this.cScale6=this.cScale6||"#3b0048",this.cScale7=this.cScale7||"#995a01",this.cScale8=this.cScale8||"#154706",this.cScale9=this.cScale9||"#161722",this.cScale10=this.cScale10||"#00296f",this.cScale11=this.cScale11||"#01629c",this.cScale12=this.cScale12||"#010029",this.cScale0=this.cScale0||this.primaryColor,this.cScale1=this.cScale1||this.secondaryColor,this.cScale2=this.cScale2||this.tertiaryColor,this.cScale3=this.cScale3||vt(this.primaryColor,{h:30}),this.cScale4=this.cScale4||vt(this.primaryColor,{h:60}),this.cScale5=this.cScale5||vt(this.primaryColor,{h:90}),this.cScale6=this.cScale6||vt(this.primaryColor,{h:120}),this.cScale7=this.cScale7||vt(this.primaryColor,{h:150}),this.cScale8=this.cScale8||vt(this.primaryColor,{h:210}),this.cScale9=this.cScale9||vt(this.primaryColor,{h:270}),this.cScale10=this.cScale10||vt(this.primaryColor,{h:300}),this.cScale11=this.cScale11||vt(this.primaryColor,{h:330});for(let T=0;T<this.THEME_COLOR_LIMIT;T++)this["cScaleInv"+T]=this["cScaleInv"+T]||cn(this["cScale"+T]);for(let T=0;T<this.THEME_COLOR_LIMIT;T++)this["cScalePeer"+T]=this["cScalePeer"+T]||Sn(this["cScale"+T],10);for(let T=0;T<5;T++)this["surface"+T]=this["surface"+T]||vt(this.mainBkg,{h:30,s:-30,l:-(-10+T*4)}),this["surfacePeer"+T]=this["surfacePeer"+T]||vt(this.mainBkg,{h:30,s:-30,l:-(-7+T*4)});this.scaleLabelColor=this.scaleLabelColor||(this.darkMode?"black":this.labelTextColor);for(let T=0;T<this.THEME_COLOR_LIMIT;T++)this["cScaleLabel"+T]=this["cScaleLabel"+T]||this.scaleLabelColor;for(let T=0;T<this.THEME_COLOR_LIMIT;T++)this["pie"+T]=this["cScale"+T];this.pieTitleTextSize=this.pieTitleTextSize||"25px",this.pieTitleTextColor=this.pieTitleTextColor||this.taskTextDarkColor,this.pieSectionTextSize=this.pieSectionTextSize||"17px",this.pieSectionTextColor=this.pieSectionTextColor||this.textColor,this.pieLegendTextSize=this.pieLegendTextSize||"17px",this.pieLegendTextColor=this.pieLegendTextColor||this.taskTextDarkColor,this.pieStrokeColor=this.pieStrokeColor||"black",this.pieStrokeWidth=this.pieStrokeWidth||"2px",this.pieOuterStrokeWidth=this.pieOuterStrokeWidth||"2px",this.pieOuterStrokeColor=this.pieOuterStrokeColor||"black",this.pieOpacity=this.pieOpacity||"0.7",this.quadrant1Fill=this.quadrant1Fill||this.primaryColor,this.quadrant2Fill=this.quadrant2Fill||vt(this.primaryColor,{r:5,g:5,b:5}),this.quadrant3Fill=this.quadrant3Fill||vt(this.primaryColor,{r:10,g:10,b:10}),this.quadrant4Fill=this.quadrant4Fill||vt(this.primaryColor,{r:15,g:15,b:15}),this.quadrant1TextFill=this.quadrant1TextFill||this.primaryTextColor,this.quadrant2TextFill=this.quadrant2TextFill||vt(this.primaryTextColor,{r:-5,g:-5,b:-5}),this.quadrant3TextFill=this.quadrant3TextFill||vt(this.primaryTextColor,{r:-10,g:-10,b:-10}),this.quadrant4TextFill=this.quadrant4TextFill||vt(this.primaryTextColor,{r:-15,g:-15,b:-15}),this.quadrantPointFill=this.quadrantPointFill||c_(this.quadrant1Fill)?Sn(this.quadrant1Fill):zn(this.quadrant1Fill),this.quadrantPointTextFill=this.quadrantPointTextFill||this.primaryTextColor,this.quadrantXAxisTextFill=this.quadrantXAxisTextFill||this.primaryTextColor,this.quadrantYAxisTextFill=this.quadrantYAxisTextFill||this.primaryTextColor,this.quadrantInternalBorderStrokeFill=this.quadrantInternalBorderStrokeFill||this.primaryBorderColor,this.quadrantExternalBorderStrokeFill=this.quadrantExternalBorderStrokeFill||this.primaryBorderColor,this.quadrantTitleFill=this.quadrantTitleFill||this.primaryTextColor,this.xyChart={backgroundColor:((t=this.xyChart)==null?void 0:t.backgroundColor)||this.background,titleColor:((n=this.xyChart)==null?void 0:n.titleColor)||this.primaryTextColor,xAxisTitleColor:((r=this.xyChart)==null?void 0:r.xAxisTitleColor)||this.primaryTextColor,xAxisLabelColor:((s=this.xyChart)==null?void 0:s.xAxisLabelColor)||this.primaryTextColor,xAxisTickColor:((i=this.xyChart)==null?void 0:i.xAxisTickColor)||this.primaryTextColor,xAxisLineColor:((a=this.xyChart)==null?void 0:a.xAxisLineColor)||this.primaryTextColor,yAxisTitleColor:((o=this.xyChart)==null?void 0:o.yAxisTitleColor)||this.primaryTextColor,yAxisLabelColor:((l=this.xyChart)==null?void 0:l.yAxisLabelColor)||this.primaryTextColor,yAxisTickColor:((c=this.xyChart)==null?void 0:c.yAxisTickColor)||this.primaryTextColor,yAxisLineColor:((u=this.xyChart)==null?void 0:u.yAxisLineColor)||this.primaryTextColor,plotColorPalette:((d=this.xyChart)==null?void 0:d.plotColorPalette)||"#3498db,#2ecc71,#e74c3c,#f1c40f,#bdc3c7,#ffffff,#34495e,#9b59b6,#1abc9c,#e67e22"},this.packet={startByteColor:this.primaryTextColor,endByteColor:this.primaryTextColor,labelColor:this.primaryTextColor,titleColor:this.primaryTextColor,blockStrokeColor:this.primaryTextColor,blockFillColor:this.background},this.radar={axisColor:((h=this.radar)==null?void 0:h.axisColor)||this.lineColor,axisStrokeWidth:((m=this.radar)==null?void 0:m.axisStrokeWidth)||2,axisLabelFontSize:((y=this.radar)==null?void 0:y.axisLabelFontSize)||12,curveOpacity:((b=this.radar)==null?void 0:b.curveOpacity)||.5,curveStrokeWidth:((v=this.radar)==null?void 0:v.curveStrokeWidth)||2,graticuleColor:((x=this.radar)==null?void 0:x.graticuleColor)||"#DEDEDE",graticuleStrokeWidth:((w=this.radar)==null?void 0:w.graticuleStrokeWidth)||1,graticuleOpacity:((S=this.radar)==null?void 0:S.graticuleOpacity)||.3,legendBoxSize:((k=this.radar)==null?void 0:k.legendBoxSize)||12,legendFontSize:((C=this.radar)==null?void 0:C.legendFontSize)||12},this.classText=this.primaryTextColor,this.requirementBackground=this.requirementBackground||this.primaryColor,this.requirementBorderColor=this.requirementBorderColor||this.primaryBorderColor,this.requirementBorderSize=this.requirementBorderSize||"1",this.requirementTextColor=this.requirementTextColor||this.primaryTextColor,this.relationColor=this.relationColor||this.lineColor,this.relationLabelBackground=this.relationLabelBackground||(this.darkMode?zn(this.secondaryColor,30):this.secondaryColor),this.relationLabelColor=this.relationLabelColor||this.actorTextColor,this.git0=Sn(this.secondaryColor,20),this.git1=Sn(this.pie2||this.secondaryColor,20),this.git2=Sn(this.pie3||this.tertiaryColor,20),this.git3=Sn(this.pie4||vt(this.primaryColor,{h:-30}),20),this.git4=Sn(this.pie5||vt(this.primaryColor,{h:-60}),20),this.git5=Sn(this.pie6||vt(this.primaryColor,{h:-90}),10),this.git6=Sn(this.pie7||vt(this.primaryColor,{h:60}),10),this.git7=Sn(this.pie8||vt(this.primaryColor,{h:120}),20),this.gitInv0=this.gitInv0||cn(this.git0),this.gitInv1=this.gitInv1||cn(this.git1),this.gitInv2=this.gitInv2||cn(this.git2),this.gitInv3=this.gitInv3||cn(this.git3),this.gitInv4=this.gitInv4||cn(this.git4),this.gitInv5=this.gitInv5||cn(this.git5),this.gitInv6=this.gitInv6||cn(this.git6),this.gitInv7=this.gitInv7||cn(this.git7),this.gitBranchLabel0=this.gitBranchLabel0||cn(this.labelTextColor),this.gitBranchLabel1=this.gitBranchLabel1||this.labelTextColor,this.gitBranchLabel2=this.gitBranchLabel2||this.labelTextColor,this.gitBranchLabel3=this.gitBranchLabel3||cn(this.labelTextColor),this.gitBranchLabel4=this.gitBranchLabel4||this.labelTextColor,this.gitBranchLabel5=this.gitBranchLabel5||this.labelTextColor,this.gitBranchLabel6=this.gitBranchLabel6||this.labelTextColor,this.gitBranchLabel7=this.gitBranchLabel7||this.labelTextColor,this.tagLabelColor=this.tagLabelColor||this.primaryTextColor,this.tagLabelBackground=this.tagLabelBackground||this.primaryColor,this.tagLabelBorder=this.tagBorder||this.primaryBorderColor,this.tagLabelFontSize=this.tagLabelFontSize||"10px",this.commitLabelColor=this.commitLabelColor||this.secondaryTextColor,this.commitLabelBackground=this.commitLabelBackground||this.secondaryColor,this.commitLabelFontSize=this.commitLabelFontSize||"10px",this.attributeBackgroundColorOdd=this.attributeBackgroundColorOdd||Sn(this.background,12),this.attributeBackgroundColorEven=this.attributeBackgroundColorEven||Sn(this.background,2),this.nodeBorder=this.nodeBorder||"#999"}calculate(t){if(typeof t!="object"){this.updateColors();return}const n=Object.keys(t);n.forEach(r=>{this[r]=t[r]}),this.updateColors(),n.forEach(r=>{this[r]=t[r]})}},ie(W0,"Theme"),W0),DZe=ie(e=>{const t=new PZe;return t.calculate(e),t},"getThemeVariables"),H0,FZe=(H0=class{constructor(){this.background="#f4f4f4",this.primaryColor="#ECECFF",this.secondaryColor=vt(this.primaryColor,{h:120}),this.secondaryColor="#ffffde",this.tertiaryColor=vt(this.primaryColor,{h:-160}),this.primaryBorderColor=to(this.primaryColor,this.darkMode),this.secondaryBorderColor=to(this.secondaryColor,this.darkMode),this.tertiaryBorderColor=to(this.tertiaryColor,this.darkMode),this.primaryTextColor=cn(this.primaryColor),this.secondaryTextColor=cn(this.secondaryColor),this.tertiaryTextColor=cn(this.tertiaryColor),this.lineColor=cn(this.background),this.textColor=cn(this.background),this.background="white",this.mainBkg="#ECECFF",this.secondBkg="#ffffde",this.lineColor="#333333",this.border1="#9370DB",this.border2="#aaaa33",this.arrowheadColor="#333333",this.fontFamily='"trebuchet ms", verdana, arial, sans-serif',this.fontSize="16px",this.labelBackground="rgba(232,232,232, 0.8)",this.textColor="#333",this.THEME_COLOR_LIMIT=12,this.nodeBkg="calculated",this.nodeBorder="calculated",this.clusterBkg="calculated",this.clusterBorder="calculated",this.defaultLinkColor="calculated",this.titleColor="calculated",this.edgeLabelBackground="calculated",this.actorBorder="calculated",this.actorBkg="calculated",this.actorTextColor="black",this.actorLineColor="calculated",this.signalColor="calculated",this.signalTextColor="calculated",this.labelBoxBkgColor="calculated",this.labelBoxBorderColor="calculated",this.labelTextColor="calculated",this.loopTextColor="calculated",this.noteBorderColor="calculated",this.noteBkgColor="#fff5ad",this.noteTextColor="calculated",this.activationBorderColor="#666",this.activationBkgColor="#f4f4f4",this.sequenceNumberColor="white",this.sectionBkgColor="calculated",this.altSectionBkgColor="calculated",this.sectionBkgColor2="calculated",this.excludeBkgColor="#eeeeee",this.taskBorderColor="calculated",this.taskBkgColor="calculated",this.taskTextLightColor="calculated",this.taskTextColor=this.taskTextLightColor,this.taskTextDarkColor="calculated",this.taskTextOutsideColor=this.taskTextDarkColor,this.taskTextClickableColor="calculated",this.activeTaskBorderColor="calculated",this.activeTaskBkgColor="calculated",this.gridColor="calculated",this.doneTaskBkgColor="calculated",this.doneTaskBorderColor="calculated",this.critBorderColor="calculated",this.critBkgColor="calculated",this.todayLineColor="calculated",this.sectionBkgColor=zx(102,102,255,.49),this.altSectionBkgColor="white",this.sectionBkgColor2="#fff400",this.taskBorderColor="#534fbc",this.taskBkgColor="#8a90dd",this.taskTextLightColor="white",this.taskTextColor="calculated",this.taskTextDarkColor="black",this.taskTextOutsideColor="calculated",this.taskTextClickableColor="#003163",this.activeTaskBorderColor="#534fbc",this.activeTaskBkgColor="#bfc7ff",this.gridColor="lightgrey",this.doneTaskBkgColor="lightgrey",this.doneTaskBorderColor="grey",this.critBorderColor="#ff8888",this.critBkgColor="red",this.todayLineColor="red",this.personBorder=this.primaryBorderColor,this.personBkg=this.mainBkg,this.archEdgeColor="calculated",this.archEdgeArrowColor="calculated",this.archEdgeWidth="3",this.archGroupBorderColor=this.primaryBorderColor,this.archGroupBorderWidth="2px",this.rowOdd="calculated",this.rowEven="calculated",this.labelColor="black",this.errorBkgColor="#552222",this.errorTextColor="#552222",this.updateColors()}updateColors(){var t,n,r,s,i,a,o,l,c,u,d,h,m,y,b,v,x,w,S,k,C;this.cScale0=this.cScale0||this.primaryColor,this.cScale1=this.cScale1||this.secondaryColor,this.cScale2=this.cScale2||this.tertiaryColor,this.cScale3=this.cScale3||vt(this.primaryColor,{h:30}),this.cScale4=this.cScale4||vt(this.primaryColor,{h:60}),this.cScale5=this.cScale5||vt(this.primaryColor,{h:90}),this.cScale6=this.cScale6||vt(this.primaryColor,{h:120}),this.cScale7=this.cScale7||vt(this.primaryColor,{h:150}),this.cScale8=this.cScale8||vt(this.primaryColor,{h:210}),this.cScale9=this.cScale9||vt(this.primaryColor,{h:270}),this.cScale10=this.cScale10||vt(this.primaryColor,{h:300}),this.cScale11=this.cScale11||vt(this.primaryColor,{h:330}),this.cScalePeer1=this.cScalePeer1||zn(this.secondaryColor,45),this.cScalePeer2=this.cScalePeer2||zn(this.tertiaryColor,40);for(let T=0;T<this.THEME_COLOR_LIMIT;T++)this["cScale"+T]=zn(this["cScale"+T],10),this["cScalePeer"+T]=this["cScalePeer"+T]||zn(this["cScale"+T],25);for(let T=0;T<this.THEME_COLOR_LIMIT;T++)this["cScaleInv"+T]=this["cScaleInv"+T]||vt(this["cScale"+T],{h:180});for(let T=0;T<5;T++)this["surface"+T]=this["surface"+T]||vt(this.mainBkg,{h:30,l:-(5+T*5)}),this["surfacePeer"+T]=this["surfacePeer"+T]||vt(this.mainBkg,{h:30,l:-(7+T*5)});if(this.scaleLabelColor=this.scaleLabelColor!=="calculated"&&this.scaleLabelColor?this.scaleLabelColor:this.labelTextColor,this.labelTextColor!=="calculated"){this.cScaleLabel0=this.cScaleLabel0||cn(this.labelTextColor),this.cScaleLabel3=this.cScaleLabel3||cn(this.labelTextColor);for(let T=0;T<this.THEME_COLOR_LIMIT;T++)this["cScaleLabel"+T]=this["cScaleLabel"+T]||this.labelTextColor}this.nodeBkg=this.mainBkg,this.nodeBorder=this.border1,this.clusterBkg=this.secondBkg,this.clusterBorder=this.border2,this.defaultLinkColor=this.lineColor,this.titleColor=this.textColor,this.edgeLabelBackground=this.labelBackground,this.actorBorder=Sn(this.border1,23),this.actorBkg=this.mainBkg,this.labelBoxBkgColor=this.actorBkg,this.signalColor=this.textColor,this.signalTextColor=this.textColor,this.labelBoxBorderColor=this.actorBorder,this.labelTextColor=this.actorTextColor,this.loopTextColor=this.actorTextColor,this.noteBorderColor=this.border2,this.noteTextColor=this.actorTextColor,this.actorLineColor=this.actorBorder,this.taskTextColor=this.taskTextLightColor,this.taskTextOutsideColor=this.taskTextDarkColor,this.archEdgeColor=this.lineColor,this.archEdgeArrowColor=this.lineColor,this.rowOdd=this.rowOdd||Sn(this.primaryColor,75)||"#ffffff",this.rowEven=this.rowEven||Sn(this.primaryColor,1),this.transitionColor=this.transitionColor||this.lineColor,this.transitionLabelColor=this.transitionLabelColor||this.textColor,this.stateLabelColor=this.stateLabelColor||this.stateBkg||this.primaryTextColor,this.stateBkg=this.stateBkg||this.mainBkg,this.labelBackgroundColor=this.labelBackgroundColor||this.stateBkg,this.compositeBackground=this.compositeBackground||this.background||this.tertiaryColor,this.altBackground=this.altBackground||"#f0f0f0",this.compositeTitleBackground=this.compositeTitleBackground||this.mainBkg,this.compositeBorder=this.compositeBorder||this.nodeBorder,this.innerEndBackground=this.nodeBorder,this.specialStateColor=this.lineColor,this.errorBkgColor=this.errorBkgColor||this.tertiaryColor,this.errorTextColor=this.errorTextColor||this.tertiaryTextColor,this.transitionColor=this.transitionColor||this.lineColor,this.classText=this.primaryTextColor,this.fillType0=this.primaryColor,this.fillType1=this.secondaryColor,this.fillType2=vt(this.primaryColor,{h:64}),this.fillType3=vt(this.secondaryColor,{h:64}),this.fillType4=vt(this.primaryColor,{h:-64}),this.fillType5=vt(this.secondaryColor,{h:-64}),this.fillType6=vt(this.primaryColor,{h:128}),this.fillType7=vt(this.secondaryColor,{h:128}),this.pie1=this.pie1||this.primaryColor,this.pie2=this.pie2||this.secondaryColor,this.pie3=this.pie3||vt(this.tertiaryColor,{l:-40}),this.pie4=this.pie4||vt(this.primaryColor,{l:-10}),this.pie5=this.pie5||vt(this.secondaryColor,{l:-30}),this.pie6=this.pie6||vt(this.tertiaryColor,{l:-20}),this.pie7=this.pie7||vt(this.primaryColor,{h:60,l:-20}),this.pie8=this.pie8||vt(this.primaryColor,{h:-60,l:-40}),this.pie9=this.pie9||vt(this.primaryColor,{h:120,l:-40}),this.pie10=this.pie10||vt(this.primaryColor,{h:60,l:-40}),this.pie11=this.pie11||vt(this.primaryColor,{h:-90,l:-40}),this.pie12=this.pie12||vt(this.primaryColor,{h:120,l:-30}),this.pieTitleTextSize=this.pieTitleTextSize||"25px",this.pieTitleTextColor=this.pieTitleTextColor||this.taskTextDarkColor,this.pieSectionTextSize=this.pieSectionTextSize||"17px",this.pieSectionTextColor=this.pieSectionTextColor||this.textColor,this.pieLegendTextSize=this.pieLegendTextSize||"17px",this.pieLegendTextColor=this.pieLegendTextColor||this.taskTextDarkColor,this.pieStrokeColor=this.pieStrokeColor||"black",this.pieStrokeWidth=this.pieStrokeWidth||"2px",this.pieOuterStrokeWidth=this.pieOuterStrokeWidth||"2px",this.pieOuterStrokeColor=this.pieOuterStrokeColor||"black",this.pieOpacity=this.pieOpacity||"0.7",this.quadrant1Fill=this.quadrant1Fill||this.primaryColor,this.quadrant2Fill=this.quadrant2Fill||vt(this.primaryColor,{r:5,g:5,b:5}),this.quadrant3Fill=this.quadrant3Fill||vt(this.primaryColor,{r:10,g:10,b:10}),this.quadrant4Fill=this.quadrant4Fill||vt(this.primaryColor,{r:15,g:15,b:15}),this.quadrant1TextFill=this.quadrant1TextFill||this.primaryTextColor,this.quadrant2TextFill=this.quadrant2TextFill||vt(this.primaryTextColor,{r:-5,g:-5,b:-5}),this.quadrant3TextFill=this.quadrant3TextFill||vt(this.primaryTextColor,{r:-10,g:-10,b:-10}),this.quadrant4TextFill=this.quadrant4TextFill||vt(this.primaryTextColor,{r:-15,g:-15,b:-15}),this.quadrantPointFill=this.quadrantPointFill||c_(this.quadrant1Fill)?Sn(this.quadrant1Fill):zn(this.quadrant1Fill),this.quadrantPointTextFill=this.quadrantPointTextFill||this.primaryTextColor,this.quadrantXAxisTextFill=this.quadrantXAxisTextFill||this.primaryTextColor,this.quadrantYAxisTextFill=this.quadrantYAxisTextFill||this.primaryTextColor,this.quadrantInternalBorderStrokeFill=this.quadrantInternalBorderStrokeFill||this.primaryBorderColor,this.quadrantExternalBorderStrokeFill=this.quadrantExternalBorderStrokeFill||this.primaryBorderColor,this.quadrantTitleFill=this.quadrantTitleFill||this.primaryTextColor,this.radar={axisColor:((t=this.radar)==null?void 0:t.axisColor)||this.lineColor,axisStrokeWidth:((n=this.radar)==null?void 0:n.axisStrokeWidth)||2,axisLabelFontSize:((r=this.radar)==null?void 0:r.axisLabelFontSize)||12,curveOpacity:((s=this.radar)==null?void 0:s.curveOpacity)||.5,curveStrokeWidth:((i=this.radar)==null?void 0:i.curveStrokeWidth)||2,graticuleColor:((a=this.radar)==null?void 0:a.graticuleColor)||"#DEDEDE",graticuleStrokeWidth:((o=this.radar)==null?void 0:o.graticuleStrokeWidth)||1,graticuleOpacity:((l=this.radar)==null?void 0:l.graticuleOpacity)||.3,legendBoxSize:((c=this.radar)==null?void 0:c.legendBoxSize)||12,legendFontSize:((u=this.radar)==null?void 0:u.legendFontSize)||12},this.xyChart={backgroundColor:((d=this.xyChart)==null?void 0:d.backgroundColor)||this.background,titleColor:((h=this.xyChart)==null?void 0:h.titleColor)||this.primaryTextColor,xAxisTitleColor:((m=this.xyChart)==null?void 0:m.xAxisTitleColor)||this.primaryTextColor,xAxisLabelColor:((y=this.xyChart)==null?void 0:y.xAxisLabelColor)||this.primaryTextColor,xAxisTickColor:((b=this.xyChart)==null?void 0:b.xAxisTickColor)||this.primaryTextColor,xAxisLineColor:((v=this.xyChart)==null?void 0:v.xAxisLineColor)||this.primaryTextColor,yAxisTitleColor:((x=this.xyChart)==null?void 0:x.yAxisTitleColor)||this.primaryTextColor,yAxisLabelColor:((w=this.xyChart)==null?void 0:w.yAxisLabelColor)||this.primaryTextColor,yAxisTickColor:((S=this.xyChart)==null?void 0:S.yAxisTickColor)||this.primaryTextColor,yAxisLineColor:((k=this.xyChart)==null?void 0:k.yAxisLineColor)||this.primaryTextColor,plotColorPalette:((C=this.xyChart)==null?void 0:C.plotColorPalette)||"#ECECFF,#8493A6,#FFC3A0,#DCDDE1,#B8E994,#D1A36F,#C3CDE6,#FFB6C1,#496078,#F8F3E3"},this.requirementBackground=this.requirementBackground||this.primaryColor,this.requirementBorderColor=this.requirementBorderColor||this.primaryBorderColor,this.requirementBorderSize=this.requirementBorderSize||"1",this.requirementTextColor=this.requirementTextColor||this.primaryTextColor,this.relationColor=this.relationColor||this.lineColor,this.relationLabelBackground=this.relationLabelBackground||this.labelBackground,this.relationLabelColor=this.relationLabelColor||this.actorTextColor,this.git0=this.git0||this.primaryColor,this.git1=this.git1||this.secondaryColor,this.git2=this.git2||this.tertiaryColor,this.git3=this.git3||vt(this.primaryColor,{h:-30}),this.git4=this.git4||vt(this.primaryColor,{h:-60}),this.git5=this.git5||vt(this.primaryColor,{h:-90}),this.git6=this.git6||vt(this.primaryColor,{h:60}),this.git7=this.git7||vt(this.primaryColor,{h:120}),this.darkMode?(this.git0=Sn(this.git0,25),this.git1=Sn(this.git1,25),this.git2=Sn(this.git2,25),this.git3=Sn(this.git3,25),this.git4=Sn(this.git4,25),this.git5=Sn(this.git5,25),this.git6=Sn(this.git6,25),this.git7=Sn(this.git7,25)):(this.git0=zn(this.git0,25),this.git1=zn(this.git1,25),this.git2=zn(this.git2,25),this.git3=zn(this.git3,25),this.git4=zn(this.git4,25),this.git5=zn(this.git5,25),this.git6=zn(this.git6,25),this.git7=zn(this.git7,25)),this.gitInv0=this.gitInv0||zn(cn(this.git0),25),this.gitInv1=this.gitInv1||cn(this.git1),this.gitInv2=this.gitInv2||cn(this.git2),this.gitInv3=this.gitInv3||cn(this.git3),this.gitInv4=this.gitInv4||cn(this.git4),this.gitInv5=this.gitInv5||cn(this.git5),this.gitInv6=this.gitInv6||cn(this.git6),this.gitInv7=this.gitInv7||cn(this.git7),this.gitBranchLabel0=this.gitBranchLabel0||cn(this.labelTextColor),this.gitBranchLabel1=this.gitBranchLabel1||this.labelTextColor,this.gitBranchLabel2=this.gitBranchLabel2||this.labelTextColor,this.gitBranchLabel3=this.gitBranchLabel3||cn(this.labelTextColor),this.gitBranchLabel4=this.gitBranchLabel4||this.labelTextColor,this.gitBranchLabel5=this.gitBranchLabel5||this.labelTextColor,this.gitBranchLabel6=this.gitBranchLabel6||this.labelTextColor,this.gitBranchLabel7=this.gitBranchLabel7||this.labelTextColor,this.tagLabelColor=this.tagLabelColor||this.primaryTextColor,this.tagLabelBackground=this.tagLabelBackground||this.primaryColor,this.tagLabelBorder=this.tagBorder||this.primaryBorderColor,this.tagLabelFontSize=this.tagLabelFontSize||"10px",this.commitLabelColor=this.commitLabelColor||this.secondaryTextColor,this.commitLabelBackground=this.commitLabelBackground||this.secondaryColor,this.commitLabelFontSize=this.commitLabelFontSize||"10px",this.attributeBackgroundColorOdd=this.attributeBackgroundColorOdd||QT,this.attributeBackgroundColorEven=this.attributeBackgroundColorEven||eA}calculate(t){if(Object.keys(this).forEach(r=>{this[r]==="calculated"&&(this[r]=void 0)}),typeof t!="object"){this.updateColors();return}const n=Object.keys(t);n.forEach(r=>{this[r]=t[r]}),this.updateColors(),n.forEach(r=>{this[r]=t[r]})}},ie(H0,"Theme"),H0),LZe=ie(e=>{const t=new FZe;return t.calculate(e),t},"getThemeVariables"),G0,BZe=(G0=class{constructor(){this.background="#f4f4f4",this.primaryColor="#cde498",this.secondaryColor="#cdffb2",this.background="white",this.mainBkg="#cde498",this.secondBkg="#cdffb2",this.lineColor="green",this.border1="#13540c",this.border2="#6eaa49",this.arrowheadColor="green",this.fontFamily='"trebuchet ms", verdana, arial, sans-serif',this.fontSize="16px",this.tertiaryColor=Sn("#cde498",10),this.primaryBorderColor=to(this.primaryColor,this.darkMode),this.secondaryBorderColor=to(this.secondaryColor,this.darkMode),this.tertiaryBorderColor=to(this.tertiaryColor,this.darkMode),this.primaryTextColor=cn(this.primaryColor),this.secondaryTextColor=cn(this.secondaryColor),this.tertiaryTextColor=cn(this.primaryColor),this.lineColor=cn(this.background),this.textColor=cn(this.background),this.THEME_COLOR_LIMIT=12,this.nodeBkg="calculated",this.nodeBorder="calculated",this.clusterBkg="calculated",this.clusterBorder="calculated",this.defaultLinkColor="calculated",this.titleColor="#333",this.edgeLabelBackground="#e8e8e8",this.actorBorder="calculated",this.actorBkg="calculated",this.actorTextColor="black",this.actorLineColor="calculated",this.signalColor="#333",this.signalTextColor="#333",this.labelBoxBkgColor="calculated",this.labelBoxBorderColor="#326932",this.labelTextColor="calculated",this.loopTextColor="calculated",this.noteBorderColor="calculated",this.noteBkgColor="#fff5ad",this.noteTextColor="calculated",this.activationBorderColor="#666",this.activationBkgColor="#f4f4f4",this.sequenceNumberColor="white",this.sectionBkgColor="#6eaa49",this.altSectionBkgColor="white",this.sectionBkgColor2="#6eaa49",this.excludeBkgColor="#eeeeee",this.taskBorderColor="calculated",this.taskBkgColor="#487e3a",this.taskTextLightColor="white",this.taskTextColor="calculated",this.taskTextDarkColor="black",this.taskTextOutsideColor="calculated",this.taskTextClickableColor="#003163",this.activeTaskBorderColor="calculated",this.activeTaskBkgColor="calculated",this.gridColor="lightgrey",this.doneTaskBkgColor="lightgrey",this.doneTaskBorderColor="grey",this.critBorderColor="#ff8888",this.critBkgColor="red",this.todayLineColor="red",this.personBorder=this.primaryBorderColor,this.personBkg=this.mainBkg,this.archEdgeColor="calculated",this.archEdgeArrowColor="calculated",this.archEdgeWidth="3",this.archGroupBorderColor=this.primaryBorderColor,this.archGroupBorderWidth="2px",this.labelColor="black",this.errorBkgColor="#552222",this.errorTextColor="#552222"}updateColors(){var t,n,r,s,i,a,o,l,c,u,d,h,m,y,b,v,x,w,S,k,C;this.actorBorder=zn(this.mainBkg,20),this.actorBkg=this.mainBkg,this.labelBoxBkgColor=this.actorBkg,this.labelTextColor=this.actorTextColor,this.loopTextColor=this.actorTextColor,this.noteBorderColor=this.border2,this.noteTextColor=this.actorTextColor,this.actorLineColor=this.actorBorder,this.cScale0=this.cScale0||this.primaryColor,this.cScale1=this.cScale1||this.secondaryColor,this.cScale2=this.cScale2||this.tertiaryColor,this.cScale3=this.cScale3||vt(this.primaryColor,{h:30}),this.cScale4=this.cScale4||vt(this.primaryColor,{h:60}),this.cScale5=this.cScale5||vt(this.primaryColor,{h:90}),this.cScale6=this.cScale6||vt(this.primaryColor,{h:120}),this.cScale7=this.cScale7||vt(this.primaryColor,{h:150}),this.cScale8=this.cScale8||vt(this.primaryColor,{h:210}),this.cScale9=this.cScale9||vt(this.primaryColor,{h:270}),this.cScale10=this.cScale10||vt(this.primaryColor,{h:300}),this.cScale11=this.cScale11||vt(this.primaryColor,{h:330}),this.cScalePeer1=this.cScalePeer1||zn(this.secondaryColor,45),this.cScalePeer2=this.cScalePeer2||zn(this.tertiaryColor,40);for(let T=0;T<this.THEME_COLOR_LIMIT;T++)this["cScale"+T]=zn(this["cScale"+T],10),this["cScalePeer"+T]=this["cScalePeer"+T]||zn(this["cScale"+T],25);for(let T=0;T<this.THEME_COLOR_LIMIT;T++)this["cScaleInv"+T]=this["cScaleInv"+T]||vt(this["cScale"+T],{h:180});this.scaleLabelColor=this.scaleLabelColor!=="calculated"&&this.scaleLabelColor?this.scaleLabelColor:this.labelTextColor;for(let T=0;T<this.THEME_COLOR_LIMIT;T++)this["cScaleLabel"+T]=this["cScaleLabel"+T]||this.scaleLabelColor;for(let T=0;T<5;T++)this["surface"+T]=this["surface"+T]||vt(this.mainBkg,{h:30,s:-30,l:-(5+T*5)}),this["surfacePeer"+T]=this["surfacePeer"+T]||vt(this.mainBkg,{h:30,s:-30,l:-(8+T*5)});this.nodeBkg=this.mainBkg,this.nodeBorder=this.border1,this.clusterBkg=this.secondBkg,this.clusterBorder=this.border2,this.defaultLinkColor=this.lineColor,this.taskBorderColor=this.border1,this.taskTextColor=this.taskTextLightColor,this.taskTextOutsideColor=this.taskTextDarkColor,this.activeTaskBorderColor=this.taskBorderColor,this.activeTaskBkgColor=this.mainBkg,this.archEdgeColor=this.lineColor,this.archEdgeArrowColor=this.lineColor,this.rowOdd=this.rowOdd||Sn(this.mainBkg,75)||"#ffffff",this.rowEven=this.rowEven||Sn(this.mainBkg,20),this.transitionColor=this.transitionColor||this.lineColor,this.transitionLabelColor=this.transitionLabelColor||this.textColor,this.stateLabelColor=this.stateLabelColor||this.stateBkg||this.primaryTextColor,this.stateBkg=this.stateBkg||this.mainBkg,this.labelBackgroundColor=this.labelBackgroundColor||this.stateBkg,this.compositeBackground=this.compositeBackground||this.background||this.tertiaryColor,this.altBackground=this.altBackground||"#f0f0f0",this.compositeTitleBackground=this.compositeTitleBackground||this.mainBkg,this.compositeBorder=this.compositeBorder||this.nodeBorder,this.innerEndBackground=this.primaryBorderColor,this.specialStateColor=this.lineColor,this.errorBkgColor=this.errorBkgColor||this.tertiaryColor,this.errorTextColor=this.errorTextColor||this.tertiaryTextColor,this.transitionColor=this.transitionColor||this.lineColor,this.classText=this.primaryTextColor,this.fillType0=this.primaryColor,this.fillType1=this.secondaryColor,this.fillType2=vt(this.primaryColor,{h:64}),this.fillType3=vt(this.secondaryColor,{h:64}),this.fillType4=vt(this.primaryColor,{h:-64}),this.fillType5=vt(this.secondaryColor,{h:-64}),this.fillType6=vt(this.primaryColor,{h:128}),this.fillType7=vt(this.secondaryColor,{h:128}),this.pie1=this.pie1||this.primaryColor,this.pie2=this.pie2||this.secondaryColor,this.pie3=this.pie3||this.tertiaryColor,this.pie4=this.pie4||vt(this.primaryColor,{l:-30}),this.pie5=this.pie5||vt(this.secondaryColor,{l:-30}),this.pie6=this.pie6||vt(this.tertiaryColor,{h:40,l:-40}),this.pie7=this.pie7||vt(this.primaryColor,{h:60,l:-10}),this.pie8=this.pie8||vt(this.primaryColor,{h:-60,l:-10}),this.pie9=this.pie9||vt(this.primaryColor,{h:120,l:0}),this.pie10=this.pie10||vt(this.primaryColor,{h:60,l:-50}),this.pie11=this.pie11||vt(this.primaryColor,{h:-60,l:-50}),this.pie12=this.pie12||vt(this.primaryColor,{h:120,l:-50}),this.pieTitleTextSize=this.pieTitleTextSize||"25px",this.pieTitleTextColor=this.pieTitleTextColor||this.taskTextDarkColor,this.pieSectionTextSize=this.pieSectionTextSize||"17px",this.pieSectionTextColor=this.pieSectionTextColor||this.textColor,this.pieLegendTextSize=this.pieLegendTextSize||"17px",this.pieLegendTextColor=this.pieLegendTextColor||this.taskTextDarkColor,this.pieStrokeColor=this.pieStrokeColor||"black",this.pieStrokeWidth=this.pieStrokeWidth||"2px",this.pieOuterStrokeWidth=this.pieOuterStrokeWidth||"2px",this.pieOuterStrokeColor=this.pieOuterStrokeColor||"black",this.pieOpacity=this.pieOpacity||"0.7",this.quadrant1Fill=this.quadrant1Fill||this.primaryColor,this.quadrant2Fill=this.quadrant2Fill||vt(this.primaryColor,{r:5,g:5,b:5}),this.quadrant3Fill=this.quadrant3Fill||vt(this.primaryColor,{r:10,g:10,b:10}),this.quadrant4Fill=this.quadrant4Fill||vt(this.primaryColor,{r:15,g:15,b:15}),this.quadrant1TextFill=this.quadrant1TextFill||this.primaryTextColor,this.quadrant2TextFill=this.quadrant2TextFill||vt(this.primaryTextColor,{r:-5,g:-5,b:-5}),this.quadrant3TextFill=this.quadrant3TextFill||vt(this.primaryTextColor,{r:-10,g:-10,b:-10}),this.quadrant4TextFill=this.quadrant4TextFill||vt(this.primaryTextColor,{r:-15,g:-15,b:-15}),this.quadrantPointFill=this.quadrantPointFill||c_(this.quadrant1Fill)?Sn(this.quadrant1Fill):zn(this.quadrant1Fill),this.quadrantPointTextFill=this.quadrantPointTextFill||this.primaryTextColor,this.quadrantXAxisTextFill=this.quadrantXAxisTextFill||this.primaryTextColor,this.quadrantYAxisTextFill=this.quadrantYAxisTextFill||this.primaryTextColor,this.quadrantInternalBorderStrokeFill=this.quadrantInternalBorderStrokeFill||this.primaryBorderColor,this.quadrantExternalBorderStrokeFill=this.quadrantExternalBorderStrokeFill||this.primaryBorderColor,this.quadrantTitleFill=this.quadrantTitleFill||this.primaryTextColor,this.packet={startByteColor:this.primaryTextColor,endByteColor:this.primaryTextColor,labelColor:this.primaryTextColor,titleColor:this.primaryTextColor,blockStrokeColor:this.primaryTextColor,blockFillColor:this.mainBkg},this.radar={axisColor:((t=this.radar)==null?void 0:t.axisColor)||this.lineColor,axisStrokeWidth:((n=this.radar)==null?void 0:n.axisStrokeWidth)||2,axisLabelFontSize:((r=this.radar)==null?void 0:r.axisLabelFontSize)||12,curveOpacity:((s=this.radar)==null?void 0:s.curveOpacity)||.5,curveStrokeWidth:((i=this.radar)==null?void 0:i.curveStrokeWidth)||2,graticuleColor:((a=this.radar)==null?void 0:a.graticuleColor)||"#DEDEDE",graticuleStrokeWidth:((o=this.radar)==null?void 0:o.graticuleStrokeWidth)||1,graticuleOpacity:((l=this.radar)==null?void 0:l.graticuleOpacity)||.3,legendBoxSize:((c=this.radar)==null?void 0:c.legendBoxSize)||12,legendFontSize:((u=this.radar)==null?void 0:u.legendFontSize)||12},this.xyChart={backgroundColor:((d=this.xyChart)==null?void 0:d.backgroundColor)||this.background,titleColor:((h=this.xyChart)==null?void 0:h.titleColor)||this.primaryTextColor,xAxisTitleColor:((m=this.xyChart)==null?void 0:m.xAxisTitleColor)||this.primaryTextColor,xAxisLabelColor:((y=this.xyChart)==null?void 0:y.xAxisLabelColor)||this.primaryTextColor,xAxisTickColor:((b=this.xyChart)==null?void 0:b.xAxisTickColor)||this.primaryTextColor,xAxisLineColor:((v=this.xyChart)==null?void 0:v.xAxisLineColor)||this.primaryTextColor,yAxisTitleColor:((x=this.xyChart)==null?void 0:x.yAxisTitleColor)||this.primaryTextColor,yAxisLabelColor:((w=this.xyChart)==null?void 0:w.yAxisLabelColor)||this.primaryTextColor,yAxisTickColor:((S=this.xyChart)==null?void 0:S.yAxisTickColor)||this.primaryTextColor,yAxisLineColor:((k=this.xyChart)==null?void 0:k.yAxisLineColor)||this.primaryTextColor,plotColorPalette:((C=this.xyChart)==null?void 0:C.plotColorPalette)||"#CDE498,#FF6B6B,#A0D2DB,#D7BDE2,#F0F0F0,#FFC3A0,#7FD8BE,#FF9A8B,#FAF3E0,#FFF176"},this.requirementBackground=this.requirementBackground||this.primaryColor,this.requirementBorderColor=this.requirementBorderColor||this.primaryBorderColor,this.requirementBorderSize=this.requirementBorderSize||"1",this.requirementTextColor=this.requirementTextColor||this.primaryTextColor,this.relationColor=this.relationColor||this.lineColor,this.relationLabelBackground=this.relationLabelBackground||this.edgeLabelBackground,this.relationLabelColor=this.relationLabelColor||this.actorTextColor,this.git0=this.git0||this.primaryColor,this.git1=this.git1||this.secondaryColor,this.git2=this.git2||this.tertiaryColor,this.git3=this.git3||vt(this.primaryColor,{h:-30}),this.git4=this.git4||vt(this.primaryColor,{h:-60}),this.git5=this.git5||vt(this.primaryColor,{h:-90}),this.git6=this.git6||vt(this.primaryColor,{h:60}),this.git7=this.git7||vt(this.primaryColor,{h:120}),this.darkMode?(this.git0=Sn(this.git0,25),this.git1=Sn(this.git1,25),this.git2=Sn(this.git2,25),this.git3=Sn(this.git3,25),this.git4=Sn(this.git4,25),this.git5=Sn(this.git5,25),this.git6=Sn(this.git6,25),this.git7=Sn(this.git7,25)):(this.git0=zn(this.git0,25),this.git1=zn(this.git1,25),this.git2=zn(this.git2,25),this.git3=zn(this.git3,25),this.git4=zn(this.git4,25),this.git5=zn(this.git5,25),this.git6=zn(this.git6,25),this.git7=zn(this.git7,25)),this.gitInv0=this.gitInv0||cn(this.git0),this.gitInv1=this.gitInv1||cn(this.git1),this.gitInv2=this.gitInv2||cn(this.git2),this.gitInv3=this.gitInv3||cn(this.git3),this.gitInv4=this.gitInv4||cn(this.git4),this.gitInv5=this.gitInv5||cn(this.git5),this.gitInv6=this.gitInv6||cn(this.git6),this.gitInv7=this.gitInv7||cn(this.git7),this.gitBranchLabel0=this.gitBranchLabel0||cn(this.labelTextColor),this.gitBranchLabel1=this.gitBranchLabel1||this.labelTextColor,this.gitBranchLabel2=this.gitBranchLabel2||this.labelTextColor,this.gitBranchLabel3=this.gitBranchLabel3||cn(this.labelTextColor),this.gitBranchLabel4=this.gitBranchLabel4||this.labelTextColor,this.gitBranchLabel5=this.gitBranchLabel5||this.labelTextColor,this.gitBranchLabel6=this.gitBranchLabel6||this.labelTextColor,this.gitBranchLabel7=this.gitBranchLabel7||this.labelTextColor,this.tagLabelColor=this.tagLabelColor||this.primaryTextColor,this.tagLabelBackground=this.tagLabelBackground||this.primaryColor,this.tagLabelBorder=this.tagBorder||this.primaryBorderColor,this.tagLabelFontSize=this.tagLabelFontSize||"10px",this.commitLabelColor=this.commitLabelColor||this.secondaryTextColor,this.commitLabelBackground=this.commitLabelBackground||this.secondaryColor,this.commitLabelFontSize=this.commitLabelFontSize||"10px",this.attributeBackgroundColorOdd=this.attributeBackgroundColorOdd||QT,this.attributeBackgroundColorEven=this.attributeBackgroundColorEven||eA}calculate(t){if(typeof t!="object"){this.updateColors();return}const n=Object.keys(t);n.forEach(r=>{this[r]=t[r]}),this.updateColors(),n.forEach(r=>{this[r]=t[r]})}},ie(G0,"Theme"),G0),$Ze=ie(e=>{const t=new BZe;return t.calculate(e),t},"getThemeVariables"),K0,zZe=(K0=class{constructor(){this.primaryColor="#eee",this.contrast="#707070",this.secondaryColor=Sn(this.contrast,55),this.background="#ffffff",this.tertiaryColor=vt(this.primaryColor,{h:-160}),this.primaryBorderColor=to(this.primaryColor,this.darkMode),this.secondaryBorderColor=to(this.secondaryColor,this.darkMode),this.tertiaryBorderColor=to(this.tertiaryColor,this.darkMode),this.primaryTextColor=cn(this.primaryColor),this.secondaryTextColor=cn(this.secondaryColor),this.tertiaryTextColor=cn(this.tertiaryColor),this.lineColor=cn(this.background),this.textColor=cn(this.background),this.mainBkg="#eee",this.secondBkg="calculated",this.lineColor="#666",this.border1="#999",this.border2="calculated",this.note="#ffa",this.text="#333",this.critical="#d42",this.done="#bbb",this.arrowheadColor="#333333",this.fontFamily='"trebuchet ms", verdana, arial, sans-serif',this.fontSize="16px",this.THEME_COLOR_LIMIT=12,this.nodeBkg="calculated",this.nodeBorder="calculated",this.clusterBkg="calculated",this.clusterBorder="calculated",this.defaultLinkColor="calculated",this.titleColor="calculated",this.edgeLabelBackground="white",this.actorBorder="calculated",this.actorBkg="calculated",this.actorTextColor="calculated",this.actorLineColor=this.actorBorder,this.signalColor="calculated",this.signalTextColor="calculated",this.labelBoxBkgColor="calculated",this.labelBoxBorderColor="calculated",this.labelTextColor="calculated",this.loopTextColor="calculated",this.noteBorderColor="calculated",this.noteBkgColor="calculated",this.noteTextColor="calculated",this.activationBorderColor="#666",this.activationBkgColor="#f4f4f4",this.sequenceNumberColor="white",this.sectionBkgColor="calculated",this.altSectionBkgColor="white",this.sectionBkgColor2="calculated",this.excludeBkgColor="#eeeeee",this.taskBorderColor="calculated",this.taskBkgColor="calculated",this.taskTextLightColor="white",this.taskTextColor="calculated",this.taskTextDarkColor="calculated",this.taskTextOutsideColor="calculated",this.taskTextClickableColor="#003163",this.activeTaskBorderColor="calculated",this.activeTaskBkgColor="calculated",this.gridColor="calculated",this.doneTaskBkgColor="calculated",this.doneTaskBorderColor="calculated",this.critBkgColor="calculated",this.critBorderColor="calculated",this.todayLineColor="calculated",this.personBorder=this.primaryBorderColor,this.personBkg=this.mainBkg,this.archEdgeColor="calculated",this.archEdgeArrowColor="calculated",this.archEdgeWidth="3",this.archGroupBorderColor=this.primaryBorderColor,this.archGroupBorderWidth="2px",this.rowOdd=this.rowOdd||Sn(this.mainBkg,75)||"#ffffff",this.rowEven=this.rowEven||"#f4f4f4",this.labelColor="black",this.errorBkgColor="#552222",this.errorTextColor="#552222"}updateColors(){var t,n,r,s,i,a,o,l,c,u,d,h,m,y,b,v,x,w,S,k,C;this.secondBkg=Sn(this.contrast,55),this.border2=this.contrast,this.actorBorder=Sn(this.border1,23),this.actorBkg=this.mainBkg,this.actorTextColor=this.text,this.actorLineColor=this.actorBorder,this.signalColor=this.text,this.signalTextColor=this.text,this.labelBoxBkgColor=this.actorBkg,this.labelBoxBorderColor=this.actorBorder,this.labelTextColor=this.text,this.loopTextColor=this.text,this.noteBorderColor="#999",this.noteBkgColor="#666",this.noteTextColor="#fff",this.cScale0=this.cScale0||"#555",this.cScale1=this.cScale1||"#F4F4F4",this.cScale2=this.cScale2||"#555",this.cScale3=this.cScale3||"#BBB",this.cScale4=this.cScale4||"#777",this.cScale5=this.cScale5||"#999",this.cScale6=this.cScale6||"#DDD",this.cScale7=this.cScale7||"#FFF",this.cScale8=this.cScale8||"#DDD",this.cScale9=this.cScale9||"#BBB",this.cScale10=this.cScale10||"#999",this.cScale11=this.cScale11||"#777";for(let T=0;T<this.THEME_COLOR_LIMIT;T++)this["cScaleInv"+T]=this["cScaleInv"+T]||cn(this["cScale"+T]);for(let T=0;T<this.THEME_COLOR_LIMIT;T++)this.darkMode?this["cScalePeer"+T]=this["cScalePeer"+T]||Sn(this["cScale"+T],10):this["cScalePeer"+T]=this["cScalePeer"+T]||zn(this["cScale"+T],10);this.scaleLabelColor=this.scaleLabelColor||(this.darkMode?"black":this.labelTextColor),this.cScaleLabel0=this.cScaleLabel0||this.cScale1,this.cScaleLabel2=this.cScaleLabel2||this.cScale1;for(let T=0;T<this.THEME_COLOR_LIMIT;T++)this["cScaleLabel"+T]=this["cScaleLabel"+T]||this.scaleLabelColor;for(let T=0;T<5;T++)this["surface"+T]=this["surface"+T]||vt(this.mainBkg,{l:-(5+T*5)}),this["surfacePeer"+T]=this["surfacePeer"+T]||vt(this.mainBkg,{l:-(8+T*5)});this.nodeBkg=this.mainBkg,this.nodeBorder=this.border1,this.clusterBkg=this.secondBkg,this.clusterBorder=this.border2,this.defaultLinkColor=this.lineColor,this.titleColor=this.text,this.sectionBkgColor=Sn(this.contrast,30),this.sectionBkgColor2=Sn(this.contrast,30),this.taskBorderColor=zn(this.contrast,10),this.taskBkgColor=this.contrast,this.taskTextColor=this.taskTextLightColor,this.taskTextDarkColor=this.text,this.taskTextOutsideColor=this.taskTextDarkColor,this.activeTaskBorderColor=this.taskBorderColor,this.activeTaskBkgColor=this.mainBkg,this.gridColor=Sn(this.border1,30),this.doneTaskBkgColor=this.done,this.doneTaskBorderColor=this.lineColor,this.critBkgColor=this.critical,this.critBorderColor=zn(this.critBkgColor,10),this.todayLineColor=this.critBkgColor,this.archEdgeColor=this.lineColor,this.archEdgeArrowColor=this.lineColor,this.transitionColor=this.transitionColor||"#000",this.transitionLabelColor=this.transitionLabelColor||this.textColor,this.stateLabelColor=this.stateLabelColor||this.stateBkg||this.primaryTextColor,this.stateBkg=this.stateBkg||this.mainBkg,this.labelBackgroundColor=this.labelBackgroundColor||this.stateBkg,this.compositeBackground=this.compositeBackground||this.background||this.tertiaryColor,this.altBackground=this.altBackground||"#f4f4f4",this.compositeTitleBackground=this.compositeTitleBackground||this.mainBkg,this.stateBorder=this.stateBorder||"#000",this.innerEndBackground=this.primaryBorderColor,this.specialStateColor="#222",this.errorBkgColor=this.errorBkgColor||this.tertiaryColor,this.errorTextColor=this.errorTextColor||this.tertiaryTextColor,this.classText=this.primaryTextColor,this.fillType0=this.primaryColor,this.fillType1=this.secondaryColor,this.fillType2=vt(this.primaryColor,{h:64}),this.fillType3=vt(this.secondaryColor,{h:64}),this.fillType4=vt(this.primaryColor,{h:-64}),this.fillType5=vt(this.secondaryColor,{h:-64}),this.fillType6=vt(this.primaryColor,{h:128}),this.fillType7=vt(this.secondaryColor,{h:128});for(let T=0;T<this.THEME_COLOR_LIMIT;T++)this["pie"+T]=this["cScale"+T];this.pie12=this.pie0,this.pieTitleTextSize=this.pieTitleTextSize||"25px",this.pieTitleTextColor=this.pieTitleTextColor||this.taskTextDarkColor,this.pieSectionTextSize=this.pieSectionTextSize||"17px",this.pieSectionTextColor=this.pieSectionTextColor||this.textColor,this.pieLegendTextSize=this.pieLegendTextSize||"17px",this.pieLegendTextColor=this.pieLegendTextColor||this.taskTextDarkColor,this.pieStrokeColor=this.pieStrokeColor||"black",this.pieStrokeWidth=this.pieStrokeWidth||"2px",this.pieOuterStrokeWidth=this.pieOuterStrokeWidth||"2px",this.pieOuterStrokeColor=this.pieOuterStrokeColor||"black",this.pieOpacity=this.pieOpacity||"0.7",this.quadrant1Fill=this.quadrant1Fill||this.primaryColor,this.quadrant2Fill=this.quadrant2Fill||vt(this.primaryColor,{r:5,g:5,b:5}),this.quadrant3Fill=this.quadrant3Fill||vt(this.primaryColor,{r:10,g:10,b:10}),this.quadrant4Fill=this.quadrant4Fill||vt(this.primaryColor,{r:15,g:15,b:15}),this.quadrant1TextFill=this.quadrant1TextFill||this.primaryTextColor,this.quadrant2TextFill=this.quadrant2TextFill||vt(this.primaryTextColor,{r:-5,g:-5,b:-5}),this.quadrant3TextFill=this.quadrant3TextFill||vt(this.primaryTextColor,{r:-10,g:-10,b:-10}),this.quadrant4TextFill=this.quadrant4TextFill||vt(this.primaryTextColor,{r:-15,g:-15,b:-15}),this.quadrantPointFill=this.quadrantPointFill||c_(this.quadrant1Fill)?Sn(this.quadrant1Fill):zn(this.quadrant1Fill),this.quadrantPointTextFill=this.quadrantPointTextFill||this.primaryTextColor,this.quadrantXAxisTextFill=this.quadrantXAxisTextFill||this.primaryTextColor,this.quadrantYAxisTextFill=this.quadrantYAxisTextFill||this.primaryTextColor,this.quadrantInternalBorderStrokeFill=this.quadrantInternalBorderStrokeFill||this.primaryBorderColor,this.quadrantExternalBorderStrokeFill=this.quadrantExternalBorderStrokeFill||this.primaryBorderColor,this.quadrantTitleFill=this.quadrantTitleFill||this.primaryTextColor,this.xyChart={backgroundColor:((t=this.xyChart)==null?void 0:t.backgroundColor)||this.background,titleColor:((n=this.xyChart)==null?void 0:n.titleColor)||this.primaryTextColor,xAxisTitleColor:((r=this.xyChart)==null?void 0:r.xAxisTitleColor)||this.primaryTextColor,xAxisLabelColor:((s=this.xyChart)==null?void 0:s.xAxisLabelColor)||this.primaryTextColor,xAxisTickColor:((i=this.xyChart)==null?void 0:i.xAxisTickColor)||this.primaryTextColor,xAxisLineColor:((a=this.xyChart)==null?void 0:a.xAxisLineColor)||this.primaryTextColor,yAxisTitleColor:((o=this.xyChart)==null?void 0:o.yAxisTitleColor)||this.primaryTextColor,yAxisLabelColor:((l=this.xyChart)==null?void 0:l.yAxisLabelColor)||this.primaryTextColor,yAxisTickColor:((c=this.xyChart)==null?void 0:c.yAxisTickColor)||this.primaryTextColor,yAxisLineColor:((u=this.xyChart)==null?void 0:u.yAxisLineColor)||this.primaryTextColor,plotColorPalette:((d=this.xyChart)==null?void 0:d.plotColorPalette)||"#EEE,#6BB8E4,#8ACB88,#C7ACD6,#E8DCC2,#FFB2A8,#FFF380,#7E8D91,#FFD8B1,#FAF3E0"},this.radar={axisColor:((h=this.radar)==null?void 0:h.axisColor)||this.lineColor,axisStrokeWidth:((m=this.radar)==null?void 0:m.axisStrokeWidth)||2,axisLabelFontSize:((y=this.radar)==null?void 0:y.axisLabelFontSize)||12,curveOpacity:((b=this.radar)==null?void 0:b.curveOpacity)||.5,curveStrokeWidth:((v=this.radar)==null?void 0:v.curveStrokeWidth)||2,graticuleColor:((x=this.radar)==null?void 0:x.graticuleColor)||"#DEDEDE",graticuleStrokeWidth:((w=this.radar)==null?void 0:w.graticuleStrokeWidth)||1,graticuleOpacity:((S=this.radar)==null?void 0:S.graticuleOpacity)||.3,legendBoxSize:((k=this.radar)==null?void 0:k.legendBoxSize)||12,legendFontSize:((C=this.radar)==null?void 0:C.legendFontSize)||12},this.requirementBackground=this.requirementBackground||this.primaryColor,this.requirementBorderColor=this.requirementBorderColor||this.primaryBorderColor,this.requirementBorderSize=this.requirementBorderSize||"1",this.requirementTextColor=this.requirementTextColor||this.primaryTextColor,this.relationColor=this.relationColor||this.lineColor,this.relationLabelBackground=this.relationLabelBackground||this.edgeLabelBackground,this.relationLabelColor=this.relationLabelColor||this.actorTextColor,this.git0=zn(this.pie1,25)||this.primaryColor,this.git1=this.pie2||this.secondaryColor,this.git2=this.pie3||this.tertiaryColor,this.git3=this.pie4||vt(this.primaryColor,{h:-30}),this.git4=this.pie5||vt(this.primaryColor,{h:-60}),this.git5=this.pie6||vt(this.primaryColor,{h:-90}),this.git6=this.pie7||vt(this.primaryColor,{h:60}),this.git7=this.pie8||vt(this.primaryColor,{h:120}),this.gitInv0=this.gitInv0||cn(this.git0),this.gitInv1=this.gitInv1||cn(this.git1),this.gitInv2=this.gitInv2||cn(this.git2),this.gitInv3=this.gitInv3||cn(this.git3),this.gitInv4=this.gitInv4||cn(this.git4),this.gitInv5=this.gitInv5||cn(this.git5),this.gitInv6=this.gitInv6||cn(this.git6),this.gitInv7=this.gitInv7||cn(this.git7),this.branchLabelColor=this.branchLabelColor||this.labelTextColor,this.gitBranchLabel0=this.branchLabelColor,this.gitBranchLabel1="white",this.gitBranchLabel2=this.branchLabelColor,this.gitBranchLabel3="white",this.gitBranchLabel4=this.branchLabelColor,this.gitBranchLabel5=this.branchLabelColor,this.gitBranchLabel6=this.branchLabelColor,this.gitBranchLabel7=this.branchLabelColor,this.tagLabelColor=this.tagLabelColor||this.primaryTextColor,this.tagLabelBackground=this.tagLabelBackground||this.primaryColor,this.tagLabelBorder=this.tagBorder||this.primaryBorderColor,this.tagLabelFontSize=this.tagLabelFontSize||"10px",this.commitLabelColor=this.commitLabelColor||this.secondaryTextColor,this.commitLabelBackground=this.commitLabelBackground||this.secondaryColor,this.commitLabelFontSize=this.commitLabelFontSize||"10px",this.attributeBackgroundColorOdd=this.attributeBackgroundColorOdd||QT,this.attributeBackgroundColorEven=this.attributeBackgroundColorEven||eA}calculate(t){if(typeof t!="object"){this.updateColors();return}const n=Object.keys(t);n.forEach(r=>{this[r]=t[r]}),this.updateColors(),n.forEach(r=>{this[r]=t[r]})}},ie(K0,"Theme"),K0),UZe=ie(e=>{const t=new zZe;return t.calculate(e),t},"getThemeVariables"),qd={base:{getThemeVariables:OZe},dark:{getThemeVariables:DZe},default:{getThemeVariables:LZe},forest:{getThemeVariables:$Ze},neutral:{getThemeVariables:UZe}},xd={flowchart:{useMaxWidth:!0,titleTopMargin:25,subGraphTitleMargin:{top:0,bottom:0},diagramPadding:8,htmlLabels:!0,nodeSpacing:50,rankSpacing:50,curve:"basis",padding:15,defaultRenderer:"dagre-wrapper",wrappingWidth:200},sequence:{useMaxWidth:!0,hideUnusedParticipants:!1,activationWidth:10,diagramMarginX:50,diagramMarginY:10,actorMargin:50,width:150,height:65,boxMargin:10,boxTextMargin:5,noteMargin:10,messageMargin:35,messageAlign:"center",mirrorActors:!0,forceMenus:!1,bottomMarginAdj:1,rightAngles:!1,showSequenceNumbers:!1,actorFontSize:14,actorFontFamily:'"Open Sans", sans-serif',actorFontWeight:400,noteFontSize:14,noteFontFamily:'"trebuchet ms", verdana, arial, sans-serif',noteFontWeight:400,noteAlign:"center",messageFontSize:16,messageFontFamily:'"trebuchet ms", verdana, arial, sans-serif',messageFontWeight:400,wrap:!1,wrapPadding:10,labelBoxWidth:50,labelBoxHeight:20},gantt:{useMaxWidth:!0,titleTopMargin:25,barHeight:20,barGap:4,topPadding:50,rightPadding:75,leftPadding:75,gridLineStartPadding:35,fontSize:11,sectionFontSize:11,numberSectionStyles:4,axisFormat:"%Y-%m-%d",topAxis:!1,displayMode:"",weekday:"sunday"},journey:{useMaxWidth:!0,diagramMarginX:50,diagramMarginY:10,leftMargin:150,width:150,height:50,boxMargin:10,boxTextMargin:5,noteMargin:10,messageMargin:35,messageAlign:"center",bottomMarginAdj:1,rightAngles:!1,taskFontSize:14,taskFontFamily:'"Open Sans", sans-serif',taskMargin:50,activationWidth:10,textPlacement:"fo",actorColours:["#8FBC8F","#7CFC00","#00FFFF","#20B2AA","#B0E0E6","#FFFFE0"],sectionFills:["#191970","#8B008B","#4B0082","#2F4F4F","#800000","#8B4513","#00008B"],sectionColours:["#fff"]},class:{useMaxWidth:!0,titleTopMargin:25,arrowMarkerAbsolute:!1,dividerMargin:10,padding:5,textHeight:10,defaultRenderer:"dagre-wrapper",htmlLabels:!1,hideEmptyMembersBox:!1},state:{useMaxWidth:!0,titleTopMargin:25,dividerMargin:10,sizeUnit:5,padding:8,textHeight:10,titleShift:-15,noteMargin:10,forkWidth:70,forkHeight:7,miniPadding:2,fontSizeFactor:5.02,fontSize:24,labelHeight:16,edgeLengthFactor:"20",compositTitleSize:35,radius:5,defaultRenderer:"dagre-wrapper"},er:{useMaxWidth:!0,titleTopMargin:25,diagramPadding:20,layoutDirection:"TB",minEntityWidth:100,minEntityHeight:75,entityPadding:15,nodeSpacing:140,rankSpacing:80,stroke:"gray",fill:"honeydew",fontSize:12},pie:{useMaxWidth:!0,textPosition:.75},quadrantChart:{useMaxWidth:!0,chartWidth:500,chartHeight:500,titleFontSize:20,titlePadding:10,quadrantPadding:5,xAxisLabelPadding:5,yAxisLabelPadding:5,xAxisLabelFontSize:16,yAxisLabelFontSize:16,quadrantLabelFontSize:16,quadrantTextTopPadding:5,pointTextPadding:5,pointLabelFontSize:12,pointRadius:5,xAxisPosition:"top",yAxisPosition:"left",quadrantInternalBorderStrokeWidth:1,quadrantExternalBorderStrokeWidth:2},xyChart:{useMaxWidth:!0,width:700,height:500,titleFontSize:20,titlePadding:10,showTitle:!0,xAxis:{$ref:"#/$defs/XYChartAxisConfig",showLabel:!0,labelFontSize:14,labelPadding:5,showTitle:!0,titleFontSize:16,titlePadding:5,showTick:!0,tickLength:5,tickWidth:2,showAxisLine:!0,axisLineWidth:2},yAxis:{$ref:"#/$defs/XYChartAxisConfig",showLabel:!0,labelFontSize:14,labelPadding:5,showTitle:!0,titleFontSize:16,titlePadding:5,showTick:!0,tickLength:5,tickWidth:2,showAxisLine:!0,axisLineWidth:2},chartOrientation:"vertical",plotReservedSpacePercent:50},requirement:{useMaxWidth:!0,rect_fill:"#f9f9f9",text_color:"#333",rect_border_size:"0.5px",rect_border_color:"#bbb",rect_min_width:200,rect_min_height:200,fontSize:14,rect_padding:10,line_height:20},mindmap:{useMaxWidth:!0,padding:10,maxNodeWidth:200},kanban:{useMaxWidth:!0,padding:8,sectionWidth:200,ticketBaseUrl:""},timeline:{useMaxWidth:!0,diagramMarginX:50,diagramMarginY:10,leftMargin:150,width:150,height:50,boxMargin:10,boxTextMargin:5,noteMargin:10,messageMargin:35,messageAlign:"center",bottomMarginAdj:1,rightAngles:!1,taskFontSize:14,taskFontFamily:'"Open Sans", sans-serif',taskMargin:50,activationWidth:10,textPlacement:"fo",actorColours:["#8FBC8F","#7CFC00","#00FFFF","#20B2AA","#B0E0E6","#FFFFE0"],sectionFills:["#191970","#8B008B","#4B0082","#2F4F4F","#800000","#8B4513","#00008B"],sectionColours:["#fff"],disableMulticolor:!1},gitGraph:{useMaxWidth:!0,titleTopMargin:25,diagramPadding:8,nodeLabel:{width:75,height:100,x:-25,y:0},mainBranchName:"main",mainBranchOrder:0,showCommitLabel:!0,showBranches:!0,rotateCommitLabel:!0,parallelCommits:!1,arrowMarkerAbsolute:!1},c4:{useMaxWidth:!0,diagramMarginX:50,diagramMarginY:10,c4ShapeMargin:50,c4ShapePadding:20,width:216,height:60,boxMargin:10,c4ShapeInRow:4,nextLinePaddingX:0,c4BoundaryInRow:2,personFontSize:14,personFontFamily:'"Open Sans", sans-serif',personFontWeight:"normal",external_personFontSize:14,external_personFontFamily:'"Open Sans", sans-serif',external_personFontWeight:"normal",systemFontSize:14,systemFontFamily:'"Open Sans", sans-serif',systemFontWeight:"normal",external_systemFontSize:14,external_systemFontFamily:'"Open Sans", sans-serif',external_systemFontWeight:"normal",system_dbFontSize:14,system_dbFontFamily:'"Open Sans", sans-serif',system_dbFontWeight:"normal",external_system_dbFontSize:14,external_system_dbFontFamily:'"Open Sans", sans-serif',external_system_dbFontWeight:"normal",system_queueFontSize:14,system_queueFontFamily:'"Open Sans", sans-serif',system_queueFontWeight:"normal",external_system_queueFontSize:14,external_system_queueFontFamily:'"Open Sans", sans-serif',external_system_queueFontWeight:"normal",boundaryFontSize:14,boundaryFontFamily:'"Open Sans", sans-serif',boundaryFontWeight:"normal",messageFontSize:12,messageFontFamily:'"Open Sans", sans-serif',messageFontWeight:"normal",containerFontSize:14,containerFontFamily:'"Open Sans", sans-serif',containerFontWeight:"normal",external_containerFontSize:14,external_containerFontFamily:'"Open Sans", sans-serif',external_containerFontWeight:"normal",container_dbFontSize:14,container_dbFontFamily:'"Open Sans", sans-serif',container_dbFontWeight:"normal",external_container_dbFontSize:14,external_container_dbFontFamily:'"Open Sans", sans-serif',external_container_dbFontWeight:"normal",container_queueFontSize:14,container_queueFontFamily:'"Open Sans", sans-serif',container_queueFontWeight:"normal",external_container_queueFontSize:14,external_container_queueFontFamily:'"Open Sans", sans-serif',external_container_queueFontWeight:"normal",componentFontSize:14,componentFontFamily:'"Open Sans", sans-serif',componentFontWeight:"normal",external_componentFontSize:14,external_componentFontFamily:'"Open Sans", sans-serif',external_componentFontWeight:"normal",component_dbFontSize:14,component_dbFontFamily:'"Open Sans", sans-serif',component_dbFontWeight:"normal",external_component_dbFontSize:14,external_component_dbFontFamily:'"Open Sans", sans-serif',external_component_dbFontWeight:"normal",component_queueFontSize:14,component_queueFontFamily:'"Open Sans", sans-serif',component_queueFontWeight:"normal",external_component_queueFontSize:14,external_component_queueFontFamily:'"Open Sans", sans-serif',external_component_queueFontWeight:"normal",wrap:!0,wrapPadding:10,person_bg_color:"#08427B",person_border_color:"#073B6F",external_person_bg_color:"#686868",external_person_border_color:"#8A8A8A",system_bg_color:"#1168BD",system_border_color:"#3C7FC0",system_db_bg_color:"#1168BD",system_db_border_color:"#3C7FC0",system_queue_bg_color:"#1168BD",system_queue_border_color:"#3C7FC0",external_system_bg_color:"#999999",external_system_border_color:"#8A8A8A",external_system_db_bg_color:"#999999",external_system_db_border_color:"#8A8A8A",external_system_queue_bg_color:"#999999",external_system_queue_border_color:"#8A8A8A",container_bg_color:"#438DD5",container_border_color:"#3C7FC0",container_db_bg_color:"#438DD5",container_db_border_color:"#3C7FC0",container_queue_bg_color:"#438DD5",container_queue_border_color:"#3C7FC0",external_container_bg_color:"#B3B3B3",external_container_border_color:"#A6A6A6",external_container_db_bg_color:"#B3B3B3",external_container_db_border_color:"#A6A6A6",external_container_queue_bg_color:"#B3B3B3",external_container_queue_border_color:"#A6A6A6",component_bg_color:"#85BBF0",component_border_color:"#78A8D8",component_db_bg_color:"#85BBF0",component_db_border_color:"#78A8D8",component_queue_bg_color:"#85BBF0",component_queue_border_color:"#78A8D8",external_component_bg_color:"#CCCCCC",external_component_border_color:"#BFBFBF",external_component_db_bg_color:"#CCCCCC",external_component_db_border_color:"#BFBFBF",external_component_queue_bg_color:"#CCCCCC",external_component_queue_border_color:"#BFBFBF"},sankey:{useMaxWidth:!0,width:600,height:400,linkColor:"gradient",nodeAlignment:"justify",showValues:!0,prefix:"",suffix:""},block:{useMaxWidth:!0,padding:8},packet:{useMaxWidth:!0,rowHeight:32,bitWidth:32,bitsPerRow:32,showBits:!0,paddingX:5,paddingY:5},architecture:{useMaxWidth:!0,padding:40,iconSize:80,fontSize:16},radar:{useMaxWidth:!0,width:600,height:600,marginTop:50,marginRight:50,marginBottom:50,marginLeft:50,axisScaleFactor:1,axisLabelFactor:1.05,curveTension:.17},theme:"default",look:"classic",handDrawnSeed:0,layout:"dagre",maxTextSize:5e4,maxEdges:500,darkMode:!1,fontFamily:'"trebuchet ms", verdana, arial, sans-serif;',logLevel:5,securityLevel:"strict",startOnLoad:!0,arrowMarkerAbsolute:!1,secure:["secure","securityLevel","startOnLoad","maxTextSize","suppressErrorRendering","maxEdges"],legacyMathML:!1,forceLegacyMathML:!1,deterministicIds:!1,fontSize:16,markdownAutoWrap:!0,suppressErrorRendering:!1},Uie={...xd,deterministicIDSeed:void 0,elk:{mergeEdges:!1,nodePlacementStrategy:"BRANDES_KOEPF"},themeCSS:void 0,themeVariables:qd.default.getThemeVariables(),sequence:{...xd.sequence,messageFont:ie(function(){return{fontFamily:this.messageFontFamily,fontSize:this.messageFontSize,fontWeight:this.messageFontWeight}},"messageFont"),noteFont:ie(function(){return{fontFamily:this.noteFontFamily,fontSize:this.noteFontSize,fontWeight:this.noteFontWeight}},"noteFont"),actorFont:ie(function(){return{fontFamily:this.actorFontFamily,fontSize:this.actorFontSize,fontWeight:this.actorFontWeight}},"actorFont")},class:{hideEmptyMembersBox:!1},gantt:{...xd.gantt,tickInterval:void 0,useWidth:void 0},c4:{...xd.c4,useWidth:void 0,personFont:ie(function(){return{fontFamily:this.personFontFamily,fontSize:this.personFontSize,fontWeight:this.personFontWeight}},"personFont"),external_personFont:ie(function(){return{fontFamily:this.external_personFontFamily,fontSize:this.external_personFontSize,fontWeight:this.external_personFontWeight}},"external_personFont"),systemFont:ie(function(){return{fontFamily:this.systemFontFamily,fontSize:this.systemFontSize,fontWeight:this.systemFontWeight}},"systemFont"),external_systemFont:ie(function(){return{fontFamily:this.external_systemFontFamily,fontSize:this.external_systemFontSize,fontWeight:this.external_systemFontWeight}},"external_systemFont"),system_dbFont:ie(function(){return{fontFamily:this.system_dbFontFamily,fontSize:this.system_dbFontSize,fontWeight:this.system_dbFontWeight}},"system_dbFont"),external_system_dbFont:ie(function(){return{fontFamily:this.external_system_dbFontFamily,fontSize:this.external_system_dbFontSize,fontWeight:this.external_system_dbFontWeight}},"external_system_dbFont"),system_queueFont:ie(function(){return{fontFamily:this.system_queueFontFamily,fontSize:this.system_queueFontSize,fontWeight:this.system_queueFontWeight}},"system_queueFont"),external_system_queueFont:ie(function(){return{fontFamily:this.external_system_queueFontFamily,fontSize:this.external_system_queueFontSize,fontWeight:this.external_system_queueFontWeight}},"external_system_queueFont"),containerFont:ie(function(){return{fontFamily:this.containerFontFamily,fontSize:this.containerFontSize,fontWeight:this.containerFontWeight}},"containerFont"),external_containerFont:ie(function(){return{fontFamily:this.external_containerFontFamily,fontSize:this.external_containerFontSize,fontWeight:this.external_containerFontWeight}},"external_containerFont"),container_dbFont:ie(function(){return{fontFamily:this.container_dbFontFamily,fontSize:this.container_dbFontSize,fontWeight:this.container_dbFontWeight}},"container_dbFont"),external_container_dbFont:ie(function(){return{fontFamily:this.external_container_dbFontFamily,fontSize:this.external_container_dbFontSize,fontWeight:this.external_container_dbFontWeight}},"external_container_dbFont"),container_queueFont:ie(function(){return{fontFamily:this.container_queueFontFamily,fontSize:this.container_queueFontSize,fontWeight:this.container_queueFontWeight}},"container_queueFont"),external_container_queueFont:ie(function(){return{fontFamily:this.external_container_queueFontFamily,fontSize:this.external_container_queueFontSize,fontWeight:this.external_container_queueFontWeight}},"external_container_queueFont"),componentFont:ie(function(){return{fontFamily:this.componentFontFamily,fontSize:this.componentFontSize,fontWeight:this.componentFontWeight}},"componentFont"),external_componentFont:ie(function(){return{fontFamily:this.external_componentFontFamily,fontSize:this.external_componentFontSize,fontWeight:this.external_componentFontWeight}},"external_componentFont"),component_dbFont:ie(function(){return{fontFamily:this.component_dbFontFamily,fontSize:this.component_dbFontSize,fontWeight:this.component_dbFontWeight}},"component_dbFont"),external_component_dbFont:ie(function(){return{fontFamily:this.external_component_dbFontFamily,fontSize:this.external_component_dbFontSize,fontWeight:this.external_component_dbFontWeight}},"external_component_dbFont"),component_queueFont:ie(function(){return{fontFamily:this.component_queueFontFamily,fontSize:this.component_queueFontSize,fontWeight:this.component_queueFontWeight}},"component_queueFont"),external_component_queueFont:ie(function(){return{fontFamily:this.external_component_queueFontFamily,fontSize:this.external_component_queueFontSize,fontWeight:this.external_component_queueFontWeight}},"external_component_queueFont"),boundaryFont:ie(function(){return{fontFamily:this.boundaryFontFamily,fontSize:this.boundaryFontSize,fontWeight:this.boundaryFontWeight}},"boundaryFont"),messageFont:ie(function(){return{fontFamily:this.messageFontFamily,fontSize:this.messageFontSize,fontWeight:this.messageFontWeight}},"messageFont")},pie:{...xd.pie,useWidth:984},xyChart:{...xd.xyChart,useWidth:void 0},requirement:{...xd.requirement,useWidth:void 0},packet:{...xd.packet},radar:{...xd.radar}},qie=ie((e,t="")=>Object.keys(e).reduce((n,r)=>Array.isArray(e[r])?n:typeof e[r]=="object"&&e[r]!==null?[...n,t+r,...qie(e[r],"")]:[...n,t+r],[]),"keyify"),qZe=new Set(qie(Uie,"")),Vie=Uie,Mk=ie(e=>{if(zt.debug("sanitizeDirective called with",e),!(typeof e!="object"||e==null)){if(Array.isArray(e)){e.forEach(t=>Mk(t));return}for(const t of Object.keys(e)){if(zt.debug("Checking key",t),t.startsWith("__")||t.includes("proto")||t.includes("constr")||!qZe.has(t)||e[t]==null){zt.debug("sanitize deleting key: ",t),delete e[t];continue}if(typeof e[t]=="object"){zt.debug("sanitizing object",t),Mk(e[t]);continue}const n=["themeCSS","fontFamily","altFontFamily"];for(const r of n)t.includes(r)&&(zt.debug("sanitizing css option",t),e[t]=VZe(e[t]))}if(e.themeVariables)for(const t of Object.keys(e.themeVariables)){const n=e.themeVariables[t];n!=null&&n.match&&!n.match(/^[\d "#%(),.;A-Za-z]+$/)&&(e.themeVariables[t]="")}zt.debug("After sanitization",e)}},"sanitizeDirective"),VZe=ie(e=>{let t=0,n=0;for(const r of e){if(t<n)return"{ /* ERROR: Unbalanced CSS */ }";r==="{"?t++:r==="}"&&n++}return t!==n?"{ /* ERROR: Unbalanced CSS */ }":e},"sanitizeCss"),Ny=Object.freeze(Vie),So=Ca({},Ny),Wie,My=[],qx=Ca({},Ny),tA=ie((e,t)=>{let n=Ca({},e),r={};for(const s of t)Kie(s),r=Ca(r,s);if(n=Ca(n,r),r.theme&&r.theme in qd){const s=Ca({},Wie),i=Ca(s.themeVariables||{},r.themeVariables);n.theme&&n.theme in qd&&(n.themeVariables=qd[n.theme].getThemeVariables(i))}return qx=n,Yie(qx),qx},"updateCurrentConfig"),WZe=ie(e=>(So=Ca({},Ny),So=Ca(So,e),e.theme&&qd[e.theme]&&(So.themeVariables=qd[e.theme].getThemeVariables(e.themeVariables)),tA(So,My),So),"setSiteConfig"),HZe=ie(e=>{Wie=Ca({},e)},"saveConfigFromInitialize"),GZe=ie(e=>(So=Ca(So,e),tA(So,My),So),"updateSiteConfig"),Hie=ie(()=>Ca({},So),"getSiteConfig"),Gie=ie(e=>(Yie(e),Ca(qx,e),Po()),"setConfig"),Po=ie(()=>Ca({},qx),"getConfig"),Kie=ie(e=>{e&&(["secure",...So.secure??[]].forEach(t=>{Object.hasOwn(e,t)&&(zt.debug(`Denied attempt to modify a secure key ${t}`,e[t]),delete e[t])}),Object.keys(e).forEach(t=>{t.startsWith("__")&&delete e[t]}),Object.keys(e).forEach(t=>{typeof e[t]=="string"&&(e[t].includes("<")||e[t].includes(">")||e[t].includes("url(data:"))&&delete e[t],typeof e[t]=="object"&&Kie(e[t])}))},"sanitize"),KZe=ie(e=>{var t;Mk(e),e.fontFamily&&!((t=e.themeVariables)!=null&&t.fontFamily)&&(e.themeVariables={...e.themeVariables,fontFamily:e.fontFamily}),My.push(e),tA(So,My)},"addDirective"),Ik=ie((e=So)=>{My=[],tA(e,My)},"reset"),YZe={LAZY_LOAD_DEPRECATED:"The configuration options lazyLoadedDiagrams and loadExternalDiagramsAtStartup are deprecated. Please use registerExternalDiagrams instead."},SV={},ZZe=ie(e=>{SV[e]||(zt.warn(YZe[e]),SV[e]=!0)},"issueWarning"),Yie=ie(e=>{e&&(e.lazyLoadedDiagrams||e.loadExternalDiagramsAtStartup)&&ZZe("LAZY_LOAD_DEPRECATED")},"checkConfig"),u_=/<br\s*\/?>/gi,XZe=ie(e=>e?Jie(e).replace(/\\n/g,"#br#").split("#br#"):[""],"getRows"),JZe=(()=>{let e=!1;return()=>{e||(Zie(),e=!0)}})();function Zie(){const e="data-temp-href-target";Ay.addHook("beforeSanitizeAttributes",t=>{t instanceof Element&&t.tagName==="A"&&t.hasAttribute("target")&&t.setAttribute(e,t.getAttribute("target")??"")}),Ay.addHook("afterSanitizeAttributes",t=>{t instanceof Element&&t.tagName==="A"&&t.hasAttribute(e)&&(t.setAttribute("target",t.getAttribute(e)??""),t.removeAttribute(e),t.getAttribute("target")==="_blank"&&t.setAttribute("rel","noopener"))})}ie(Zie,"setupDompurifyHooks");var Xie=ie(e=>(JZe(),Ay.sanitize(e)),"removeScript"),CV=ie((e,t)=>{var n;if(((n=t.flowchart)==null?void 0:n.htmlLabels)!==!1){const r=t.securityLevel;r==="antiscript"||r==="strict"?e=Xie(e):r!=="loose"&&(e=Jie(e),e=e.replace(/</g,"&lt;").replace(/>/g,"&gt;"),e=e.replace(/=/g,"&equals;"),e=nXe(e))}return e},"sanitizeMore"),Pm=ie((e,t)=>e&&(t.dompurifyConfig?e=Ay.sanitize(CV(e,t),t.dompurifyConfig).toString():e=Ay.sanitize(CV(e,t),{FORBID_TAGS:["style"]}).toString(),e),"sanitizeText"),QZe=ie((e,t)=>typeof e=="string"?Pm(e,t):e.flat().map(n=>Pm(n,t)),"sanitizeTextOrArray"),eXe=ie(e=>u_.test(e),"hasBreaks"),tXe=ie(e=>e.split(u_),"splitBreaks"),nXe=ie(e=>e.replace(/#br#/g,"<br/>"),"placeholderToBreak"),Jie=ie(e=>e.replace(u_,"#br#"),"breakToPlaceholder"),rXe=ie(e=>{let t="";return e&&(t=window.location.protocol+"//"+window.location.host+window.location.pathname+window.location.search,t=t.replaceAll(/\(/g,"\\("),t=t.replaceAll(/\)/g,"\\)")),t},"getUrl"),Gi=ie(e=>!(e===!1||["false","null","0"].includes(String(e).trim().toLowerCase())),"evaluate"),sXe=ie(function(...e){const t=e.filter(n=>!isNaN(n));return Math.max(...t)},"getMax"),iXe=ie(function(...e){const t=e.filter(n=>!isNaN(n));return Math.min(...t)},"getMin"),kV=ie(function(e){const t=e.split(/(,)/),n=[];for(let r=0;r<t.length;r++){let s=t[r];if(s===","&&r>0&&r+1<t.length){const i=t[r-1],a=t[r+1];aXe(i,a)&&(s=i+","+a,r++,n.pop())}n.push(oXe(s))}return n.join("")},"parseGenericTypes"),W4=ie((e,t)=>Math.max(0,e.split(t).length-1),"countOccurrence"),aXe=ie((e,t)=>{const n=W4(e,"~"),r=W4(t,"~");return n===1&&r===1},"shouldCombineSets"),oXe=ie(e=>{const t=W4(e,"~");let n=!1;if(t<=1)return e;t%2!==0&&e.startsWith("~")&&(e=e.substring(1),n=!0);const r=[...e];let s=r.indexOf("~"),i=r.lastIndexOf("~");for(;s!==-1&&i!==-1&&s!==i;)r[s]="<",r[i]=">",s=r.indexOf("~"),i=r.lastIndexOf("~");return n&&r.unshift("~"),r.join("")},"processSet"),EV=ie(()=>window.MathMLElement!==void 0,"isMathMLSupported"),H4=/\$\$(.*)\$\$/g,Iy=ie(e=>{var t;return(((t=e.match(H4))==null?void 0:t.length)??0)>0},"hasKatex"),jdt=ie(async(e,t)=>{e=await pF(e,t);const n=document.createElement("div");n.innerHTML=e,n.id="katex-temp",n.style.visibility="hidden",n.style.position="absolute",n.style.top="0";const r=document.querySelector("body");r==null||r.insertAdjacentElement("beforeend",n);const s={width:n.clientWidth,height:n.clientHeight};return n.remove(),s},"calculateMathMLDimensions"),pF=ie(async(e,t)=>{if(!Iy(e))return e;if(!(EV()||t.legacyMathML||t.forceLegacyMathML))return e.replace(H4,"MathML is unsupported in this environment.");const{default:n}=await Zr(async()=>{const{default:s}=await import("./katex-ChWnQ-fc.js");return{default:s}},[]),r=t.forceLegacyMathML||!EV()&&t.legacyMathML?"htmlAndMathml":"mathml";return e.split(u_).map(s=>Iy(s)?`<div style="display: flex; align-items: center; justify-content: center; white-space: nowrap;">${s}</div>`:`<div>${s}</div>`).join("").replace(H4,(s,i)=>n.renderToString(i,{throwOnError:!0,displayMode:!0,output:r}).replace(/\n/g," ").replace(/<annotation.*<\/annotation>/g,""))},"renderKatex"),_b={getRows:XZe,sanitizeText:Pm,sanitizeTextOrArray:QZe,hasBreaks:eXe,splitBreaks:tXe,lineBreakRegex:u_,removeScript:Xie,getUrl:rXe,evaluate:Gi,getMax:sXe,getMin:iXe},lXe=ie(function(e,t){for(let n of t)e.attr(n[0],n[1])},"d3Attrs"),cXe=ie(function(e,t,n){let r=new Map;return n?(r.set("width","100%"),r.set("style",`max-width: ${t}px;`)):(r.set("height",e),r.set("width",t)),r},"calculateSvgSizeAttrs"),Qie=ie(function(e,t,n,r){const s=cXe(t,n,r);lXe(e,s)},"configureSvgSize"),uXe=ie(function(e,t,n,r){const s=t.node().getBBox(),i=s.width,a=s.height;zt.info(`SVG bounds: ${i}x${a}`,s);let o=0,l=0;zt.info(`Graph bounds: ${o}x${l}`,e),o=i+n*2,l=a+n*2,zt.info(`Calculated bounds: ${o}x${l}`),Qie(t,l,o,r);const c=`${s.x-n} ${s.y-n} ${s.width+2*n} ${s.height+2*n}`;t.attr("viewBox",c)},"setupGraphViewbox"),H2={},dXe=ie((e,t,n)=>{let r="";return e in H2&&H2[e]?r=H2[e](n):zt.warn(`No theme found for ${e}`),` & {
    font-family: ${n.fontFamily};
    font-size: ${n.fontSize};
    fill: ${n.textColor}
  }
  @keyframes edge-animation-frame {
    from {
      stroke-dashoffset: 0;
    }
  }
  @keyframes dash {
    to {
      stroke-dashoffset: 0;
    }
  }
  & .edge-animation-slow {
    stroke-dasharray: 9,5 !important;
    stroke-dashoffset: 900;
    animation: dash 50s linear infinite;
    stroke-linecap: round;
  }
  & .edge-animation-fast {
    stroke-dasharray: 9,5 !important;
    stroke-dashoffset: 900;
    animation: dash 20s linear infinite;
    stroke-linecap: round;
  }
  /* Classes common for multiple diagrams */

  & .error-icon {
    fill: ${n.errorBkgColor};
  }
  & .error-text {
    fill: ${n.errorTextColor};
    stroke: ${n.errorTextColor};
  }

  & .edge-thickness-normal {
    stroke-width: 1px;
  }
  & .edge-thickness-thick {
    stroke-width: 3.5px
  }
  & .edge-pattern-solid {
    stroke-dasharray: 0;
  }
  & .edge-thickness-invisible {
    stroke-width: 0;
    fill: none;
  }
  & .edge-pattern-dashed{
    stroke-dasharray: 3;
  }
  .edge-pattern-dotted {
    stroke-dasharray: 2;
  }

  & .marker {
    fill: ${n.lineColor};
    stroke: ${n.lineColor};
  }
  & .marker.cross {
    stroke: ${n.lineColor};
  }

  & svg {
    font-family: ${n.fontFamily};
    font-size: ${n.fontSize};
  }
   & p {
    margin: 0
   }

  ${r}

  ${t}
`},"getStyles"),fXe=ie((e,t)=>{t!==void 0&&(H2[e]=t)},"addStylesForDiagram"),hXe=dXe,eae={};NZe(eae,{clear:()=>pXe,getAccDescription:()=>bXe,getAccTitle:()=>gXe,getDiagramTitle:()=>xXe,setAccDescription:()=>yXe,setAccTitle:()=>mXe,setDiagramTitle:()=>vXe});var mF="",gF="",yF="",bF=ie(e=>Pm(e,Po()),"sanitizeText"),pXe=ie(()=>{mF="",yF="",gF=""},"clear"),mXe=ie(e=>{mF=bF(e).replace(/^\s+/g,"")},"setAccTitle"),gXe=ie(()=>mF,"getAccTitle"),yXe=ie(e=>{yF=bF(e).replace(/\n\s+/g,`
`)},"setAccDescription"),bXe=ie(()=>yF,"getAccDescription"),vXe=ie(e=>{gF=bF(e)},"setDiagramTitle"),xXe=ie(()=>gF,"getDiagramTitle"),TV=zt,wXe=fF,ls=Po,Odt=Gie,Pdt=Ny,vF=ie(e=>Pm(e,ls()),"sanitizeText"),_Xe=uXe,SXe=ie(()=>eae,"getCommonDb"),jk={},Ok=ie((e,t,n)=>{var r;jk[e]&&TV.warn(`Diagram with id ${e} already registered. Overwriting.`),jk[e]=t,n&&zie(e,n),fXe(e,t.styles),(r=t.injectUtils)==null||r.call(t,TV,wXe,ls,vF,_Xe,SXe(),()=>{})},"registerDiagram"),G4=ie(e=>{if(e in jk)return jk[e];throw new CXe(e)},"getDiagram"),Y0,CXe=(Y0=class extends Error{constructor(t){super(`Diagram ${t} not found.`)}},ie(Y0,"DiagramNotFoundError"),Y0);function xF(e){return typeof e>"u"||e===null}ie(xF,"isNothing");function tae(e){return typeof e=="object"&&e!==null}ie(tae,"isObject");function nae(e){return Array.isArray(e)?e:xF(e)?[]:[e]}ie(nae,"toArray");function rae(e,t){var n,r,s,i;if(t)for(i=Object.keys(t),n=0,r=i.length;n<r;n+=1)s=i[n],e[s]=t[s];return e}ie(rae,"extend");function sae(e,t){var n="",r;for(r=0;r<t;r+=1)n+=e;return n}ie(sae,"repeat");function iae(e){return e===0&&Number.NEGATIVE_INFINITY===1/e}ie(iae,"isNegativeZero");var kXe=xF,EXe=tae,TXe=nae,AXe=sae,RXe=iae,NXe=rae,qi={isNothing:kXe,isObject:EXe,toArray:TXe,repeat:AXe,isNegativeZero:RXe,extend:NXe};function wF(e,t){var n="",r=e.reason||"(unknown reason)";return e.mark?(e.mark.name&&(n+='in "'+e.mark.name+'" '),n+="("+(e.mark.line+1)+":"+(e.mark.column+1)+")",!t&&e.mark.snippet&&(n+=`

`+e.mark.snippet),r+" "+n):r}ie(wF,"formatError");function jy(e,t){Error.call(this),this.name="YAMLException",this.reason=e,this.mark=t,this.message=wF(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack||""}ie(jy,"YAMLException$1");jy.prototype=Object.create(Error.prototype);jy.prototype.constructor=jy;jy.prototype.toString=ie(function(t){return this.name+": "+wF(this,t)},"toString");var To=jy;function G2(e,t,n,r,s){var i="",a="",o=Math.floor(s/2)-1;return r-t>o&&(i=" ... ",t=r-o+i.length),n-r>o&&(a=" ...",n=r+o-a.length),{str:i+e.slice(t,n).replace(/\t/g,"")+a,pos:r-t+i.length}}ie(G2,"getLine");function K2(e,t){return qi.repeat(" ",t-e.length)+e}ie(K2,"padStart");function aae(e,t){if(t=Object.create(t||null),!e.buffer)return null;t.maxLength||(t.maxLength=79),typeof t.indent!="number"&&(t.indent=1),typeof t.linesBefore!="number"&&(t.linesBefore=3),typeof t.linesAfter!="number"&&(t.linesAfter=2);for(var n=/\r?\n|\r|\0/g,r=[0],s=[],i,a=-1;i=n.exec(e.buffer);)s.push(i.index),r.push(i.index+i[0].length),e.position<=i.index&&a<0&&(a=r.length-2);a<0&&(a=r.length-1);var o="",l,c,u=Math.min(e.line+t.linesAfter,s.length).toString().length,d=t.maxLength-(t.indent+u+3);for(l=1;l<=t.linesBefore&&!(a-l<0);l++)c=G2(e.buffer,r[a-l],s[a-l],e.position-(r[a]-r[a-l]),d),o=qi.repeat(" ",t.indent)+K2((e.line-l+1).toString(),u)+" | "+c.str+`
`+o;for(c=G2(e.buffer,r[a],s[a],e.position,d),o+=qi.repeat(" ",t.indent)+K2((e.line+1).toString(),u)+" | "+c.str+`
`,o+=qi.repeat("-",t.indent+u+3+c.pos)+`^
`,l=1;l<=t.linesAfter&&!(a+l>=s.length);l++)c=G2(e.buffer,r[a+l],s[a+l],e.position-(r[a]-r[a+l]),d),o+=qi.repeat(" ",t.indent)+K2((e.line+l+1).toString(),u)+" | "+c.str+`
`;return o.replace(/\n$/,"")}ie(aae,"makeSnippet");var MXe=aae,IXe=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],jXe=["scalar","sequence","mapping"];function oae(e){var t={};return e!==null&&Object.keys(e).forEach(function(n){e[n].forEach(function(r){t[String(r)]=n})}),t}ie(oae,"compileStyleAliases");function lae(e,t){if(t=t||{},Object.keys(t).forEach(function(n){if(IXe.indexOf(n)===-1)throw new To('Unknown option "'+n+'" is met in definition of "'+e+'" YAML type.')}),this.options=t,this.tag=e,this.kind=t.kind||null,this.resolve=t.resolve||function(){return!0},this.construct=t.construct||function(n){return n},this.instanceOf=t.instanceOf||null,this.predicate=t.predicate||null,this.represent=t.represent||null,this.representName=t.representName||null,this.defaultStyle=t.defaultStyle||null,this.multi=t.multi||!1,this.styleAliases=oae(t.styleAliases||null),jXe.indexOf(this.kind)===-1)throw new To('Unknown kind "'+this.kind+'" is specified for "'+e+'" YAML type.')}ie(lae,"Type$1");var Ba=lae;function K4(e,t){var n=[];return e[t].forEach(function(r){var s=n.length;n.forEach(function(i,a){i.tag===r.tag&&i.kind===r.kind&&i.multi===r.multi&&(s=a)}),n[s]=r}),n}ie(K4,"compileList");function cae(){var e={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}},t,n;function r(s){s.multi?(e.multi[s.kind].push(s),e.multi.fallback.push(s)):e[s.kind][s.tag]=e.fallback[s.tag]=s}for(ie(r,"collectType"),t=0,n=arguments.length;t<n;t+=1)arguments[t].forEach(r);return e}ie(cae,"compileMap");function Pk(e){return this.extend(e)}ie(Pk,"Schema$1");Pk.prototype.extend=ie(function(t){var n=[],r=[];if(t instanceof Ba)r.push(t);else if(Array.isArray(t))r=r.concat(t);else if(t&&(Array.isArray(t.implicit)||Array.isArray(t.explicit)))t.implicit&&(n=n.concat(t.implicit)),t.explicit&&(r=r.concat(t.explicit));else throw new To("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");n.forEach(function(i){if(!(i instanceof Ba))throw new To("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(i.loadKind&&i.loadKind!=="scalar")throw new To("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(i.multi)throw new To("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")}),r.forEach(function(i){if(!(i instanceof Ba))throw new To("Specified list of YAML types (or a single Type object) contains a non-Type object.")});var s=Object.create(Pk.prototype);return s.implicit=(this.implicit||[]).concat(n),s.explicit=(this.explicit||[]).concat(r),s.compiledImplicit=K4(s,"implicit"),s.compiledExplicit=K4(s,"explicit"),s.compiledTypeMap=cae(s.compiledImplicit,s.compiledExplicit),s},"extend");var OXe=Pk,PXe=new Ba("tag:yaml.org,2002:str",{kind:"scalar",construct:ie(function(e){return e!==null?e:""},"construct")}),DXe=new Ba("tag:yaml.org,2002:seq",{kind:"sequence",construct:ie(function(e){return e!==null?e:[]},"construct")}),FXe=new Ba("tag:yaml.org,2002:map",{kind:"mapping",construct:ie(function(e){return e!==null?e:{}},"construct")}),LXe=new OXe({explicit:[PXe,DXe,FXe]});function uae(e){if(e===null)return!0;var t=e.length;return t===1&&e==="~"||t===4&&(e==="null"||e==="Null"||e==="NULL")}ie(uae,"resolveYamlNull");function dae(){return null}ie(dae,"constructYamlNull");function fae(e){return e===null}ie(fae,"isNull");var BXe=new Ba("tag:yaml.org,2002:null",{kind:"scalar",resolve:uae,construct:dae,predicate:fae,represent:{canonical:ie(function(){return"~"},"canonical"),lowercase:ie(function(){return"null"},"lowercase"),uppercase:ie(function(){return"NULL"},"uppercase"),camelcase:ie(function(){return"Null"},"camelcase"),empty:ie(function(){return""},"empty")},defaultStyle:"lowercase"});function hae(e){if(e===null)return!1;var t=e.length;return t===4&&(e==="true"||e==="True"||e==="TRUE")||t===5&&(e==="false"||e==="False"||e==="FALSE")}ie(hae,"resolveYamlBoolean");function pae(e){return e==="true"||e==="True"||e==="TRUE"}ie(pae,"constructYamlBoolean");function mae(e){return Object.prototype.toString.call(e)==="[object Boolean]"}ie(mae,"isBoolean");var $Xe=new Ba("tag:yaml.org,2002:bool",{kind:"scalar",resolve:hae,construct:pae,predicate:mae,represent:{lowercase:ie(function(e){return e?"true":"false"},"lowercase"),uppercase:ie(function(e){return e?"TRUE":"FALSE"},"uppercase"),camelcase:ie(function(e){return e?"True":"False"},"camelcase")},defaultStyle:"lowercase"});function gae(e){return 48<=e&&e<=57||65<=e&&e<=70||97<=e&&e<=102}ie(gae,"isHexCode");function yae(e){return 48<=e&&e<=55}ie(yae,"isOctCode");function bae(e){return 48<=e&&e<=57}ie(bae,"isDecCode");function vae(e){if(e===null)return!1;var t=e.length,n=0,r=!1,s;if(!t)return!1;if(s=e[n],(s==="-"||s==="+")&&(s=e[++n]),s==="0"){if(n+1===t)return!0;if(s=e[++n],s==="b"){for(n++;n<t;n++)if(s=e[n],s!=="_"){if(s!=="0"&&s!=="1")return!1;r=!0}return r&&s!=="_"}if(s==="x"){for(n++;n<t;n++)if(s=e[n],s!=="_"){if(!gae(e.charCodeAt(n)))return!1;r=!0}return r&&s!=="_"}if(s==="o"){for(n++;n<t;n++)if(s=e[n],s!=="_"){if(!yae(e.charCodeAt(n)))return!1;r=!0}return r&&s!=="_"}}if(s==="_")return!1;for(;n<t;n++)if(s=e[n],s!=="_"){if(!bae(e.charCodeAt(n)))return!1;r=!0}return!(!r||s==="_")}ie(vae,"resolveYamlInteger");function xae(e){var t=e,n=1,r;if(t.indexOf("_")!==-1&&(t=t.replace(/_/g,"")),r=t[0],(r==="-"||r==="+")&&(r==="-"&&(n=-1),t=t.slice(1),r=t[0]),t==="0")return 0;if(r==="0"){if(t[1]==="b")return n*parseInt(t.slice(2),2);if(t[1]==="x")return n*parseInt(t.slice(2),16);if(t[1]==="o")return n*parseInt(t.slice(2),8)}return n*parseInt(t,10)}ie(xae,"constructYamlInteger");function wae(e){return Object.prototype.toString.call(e)==="[object Number]"&&e%1===0&&!qi.isNegativeZero(e)}ie(wae,"isInteger");var zXe=new Ba("tag:yaml.org,2002:int",{kind:"scalar",resolve:vae,construct:xae,predicate:wae,represent:{binary:ie(function(e){return e>=0?"0b"+e.toString(2):"-0b"+e.toString(2).slice(1)},"binary"),octal:ie(function(e){return e>=0?"0o"+e.toString(8):"-0o"+e.toString(8).slice(1)},"octal"),decimal:ie(function(e){return e.toString(10)},"decimal"),hexadecimal:ie(function(e){return e>=0?"0x"+e.toString(16).toUpperCase():"-0x"+e.toString(16).toUpperCase().slice(1)},"hexadecimal")},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),UXe=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$");function _ae(e){return!(e===null||!UXe.test(e)||e[e.length-1]==="_")}ie(_ae,"resolveYamlFloat");function Sae(e){var t,n;return t=e.replace(/_/g,"").toLowerCase(),n=t[0]==="-"?-1:1,"+-".indexOf(t[0])>=0&&(t=t.slice(1)),t===".inf"?n===1?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:t===".nan"?NaN:n*parseFloat(t,10)}ie(Sae,"constructYamlFloat");var qXe=/^[-+]?[0-9]+e/;function Cae(e,t){var n;if(isNaN(e))switch(t){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===e)switch(t){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===e)switch(t){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(qi.isNegativeZero(e))return"-0.0";return n=e.toString(10),qXe.test(n)?n.replace("e",".e"):n}ie(Cae,"representYamlFloat");function kae(e){return Object.prototype.toString.call(e)==="[object Number]"&&(e%1!==0||qi.isNegativeZero(e))}ie(kae,"isFloat");var VXe=new Ba("tag:yaml.org,2002:float",{kind:"scalar",resolve:_ae,construct:Sae,predicate:kae,represent:Cae,defaultStyle:"lowercase"}),Eae=LXe.extend({implicit:[BXe,$Xe,zXe,VXe]}),WXe=Eae,Tae=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),Aae=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$");function Rae(e){return e===null?!1:Tae.exec(e)!==null||Aae.exec(e)!==null}ie(Rae,"resolveYamlTimestamp");function Nae(e){var t,n,r,s,i,a,o,l=0,c=null,u,d,h;if(t=Tae.exec(e),t===null&&(t=Aae.exec(e)),t===null)throw new Error("Date resolve error");if(n=+t[1],r=+t[2]-1,s=+t[3],!t[4])return new Date(Date.UTC(n,r,s));if(i=+t[4],a=+t[5],o=+t[6],t[7]){for(l=t[7].slice(0,3);l.length<3;)l+="0";l=+l}return t[9]&&(u=+t[10],d=+(t[11]||0),c=(u*60+d)*6e4,t[9]==="-"&&(c=-c)),h=new Date(Date.UTC(n,r,s,i,a,o,l)),c&&h.setTime(h.getTime()-c),h}ie(Nae,"constructYamlTimestamp");function Mae(e){return e.toISOString()}ie(Mae,"representYamlTimestamp");var HXe=new Ba("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:Rae,construct:Nae,instanceOf:Date,represent:Mae});function Iae(e){return e==="<<"||e===null}ie(Iae,"resolveYamlMerge");var GXe=new Ba("tag:yaml.org,2002:merge",{kind:"scalar",resolve:Iae}),_F=`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=
\r`;function jae(e){if(e===null)return!1;var t,n,r=0,s=e.length,i=_F;for(n=0;n<s;n++)if(t=i.indexOf(e.charAt(n)),!(t>64)){if(t<0)return!1;r+=6}return r%8===0}ie(jae,"resolveYamlBinary");function Oae(e){var t,n,r=e.replace(/[\r\n=]/g,""),s=r.length,i=_F,a=0,o=[];for(t=0;t<s;t++)t%4===0&&t&&(o.push(a>>16&255),o.push(a>>8&255),o.push(a&255)),a=a<<6|i.indexOf(r.charAt(t));return n=s%4*6,n===0?(o.push(a>>16&255),o.push(a>>8&255),o.push(a&255)):n===18?(o.push(a>>10&255),o.push(a>>2&255)):n===12&&o.push(a>>4&255),new Uint8Array(o)}ie(Oae,"constructYamlBinary");function Pae(e){var t="",n=0,r,s,i=e.length,a=_F;for(r=0;r<i;r++)r%3===0&&r&&(t+=a[n>>18&63],t+=a[n>>12&63],t+=a[n>>6&63],t+=a[n&63]),n=(n<<8)+e[r];return s=i%3,s===0?(t+=a[n>>18&63],t+=a[n>>12&63],t+=a[n>>6&63],t+=a[n&63]):s===2?(t+=a[n>>10&63],t+=a[n>>4&63],t+=a[n<<2&63],t+=a[64]):s===1&&(t+=a[n>>2&63],t+=a[n<<4&63],t+=a[64],t+=a[64]),t}ie(Pae,"representYamlBinary");function Dae(e){return Object.prototype.toString.call(e)==="[object Uint8Array]"}ie(Dae,"isBinary");var KXe=new Ba("tag:yaml.org,2002:binary",{kind:"scalar",resolve:jae,construct:Oae,predicate:Dae,represent:Pae}),YXe=Object.prototype.hasOwnProperty,ZXe=Object.prototype.toString;function Fae(e){if(e===null)return!0;var t=[],n,r,s,i,a,o=e;for(n=0,r=o.length;n<r;n+=1){if(s=o[n],a=!1,ZXe.call(s)!=="[object Object]")return!1;for(i in s)if(YXe.call(s,i))if(!a)a=!0;else return!1;if(!a)return!1;if(t.indexOf(i)===-1)t.push(i);else return!1}return!0}ie(Fae,"resolveYamlOmap");function Lae(e){return e!==null?e:[]}ie(Lae,"constructYamlOmap");var XXe=new Ba("tag:yaml.org,2002:omap",{kind:"sequence",resolve:Fae,construct:Lae}),JXe=Object.prototype.toString;function Bae(e){if(e===null)return!0;var t,n,r,s,i,a=e;for(i=new Array(a.length),t=0,n=a.length;t<n;t+=1){if(r=a[t],JXe.call(r)!=="[object Object]"||(s=Object.keys(r),s.length!==1))return!1;i[t]=[s[0],r[s[0]]]}return!0}ie(Bae,"resolveYamlPairs");function $ae(e){if(e===null)return[];var t,n,r,s,i,a=e;for(i=new Array(a.length),t=0,n=a.length;t<n;t+=1)r=a[t],s=Object.keys(r),i[t]=[s[0],r[s[0]]];return i}ie($ae,"constructYamlPairs");var QXe=new Ba("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:Bae,construct:$ae}),eJe=Object.prototype.hasOwnProperty;function zae(e){if(e===null)return!0;var t,n=e;for(t in n)if(eJe.call(n,t)&&n[t]!==null)return!1;return!0}ie(zae,"resolveYamlSet");function Uae(e){return e!==null?e:{}}ie(Uae,"constructYamlSet");var tJe=new Ba("tag:yaml.org,2002:set",{kind:"mapping",resolve:zae,construct:Uae}),qae=WXe.extend({implicit:[HXe,GXe],explicit:[KXe,XXe,QXe,tJe]}),Ph=Object.prototype.hasOwnProperty,Dk=1,Vae=2,Wae=3,Fk=4,R3=1,nJe=2,AV=3,rJe=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,sJe=/[\x85\u2028\u2029]/,iJe=/[,\[\]\{\}]/,Hae=/^(?:!|!!|![a-z\-]+!)$/i,Gae=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function Y4(e){return Object.prototype.toString.call(e)}ie(Y4,"_class");function Nc(e){return e===10||e===13}ie(Nc,"is_EOL");function gh(e){return e===9||e===32}ie(gh,"is_WHITE_SPACE");function no(e){return e===9||e===32||e===10||e===13}ie(no,"is_WS_OR_EOL");function lm(e){return e===44||e===91||e===93||e===123||e===125}ie(lm,"is_FLOW_INDICATOR");function Kae(e){var t;return 48<=e&&e<=57?e-48:(t=e|32,97<=t&&t<=102?t-97+10:-1)}ie(Kae,"fromHexCode");function Yae(e){return e===120?2:e===117?4:e===85?8:0}ie(Yae,"escapedHexLen");function Zae(e){return 48<=e&&e<=57?e-48:-1}ie(Zae,"fromDecimalCode");function Z4(e){return e===48?"\0":e===97?"\x07":e===98?"\b":e===116||e===9?"	":e===110?`
`:e===118?"\v":e===102?"\f":e===114?"\r":e===101?"\x1B":e===32?" ":e===34?'"':e===47?"/":e===92?"\\":e===78?"":e===95?"":e===76?"\u2028":e===80?"\u2029":""}ie(Z4,"simpleEscapeSequence");function Xae(e){return e<=65535?String.fromCharCode(e):String.fromCharCode((e-65536>>10)+55296,(e-65536&1023)+56320)}ie(Xae,"charFromCodepoint");var Jae=new Array(256),Qae=new Array(256);for(Vp=0;Vp<256;Vp++)Jae[Vp]=Z4(Vp)?1:0,Qae[Vp]=Z4(Vp);var Vp;function eoe(e,t){this.input=e,this.filename=t.filename||null,this.schema=t.schema||qae,this.onWarning=t.onWarning||null,this.legacy=t.legacy||!1,this.json=t.json||!1,this.listener=t.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=e.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}ie(eoe,"State$1");function SF(e,t){var n={name:e.filename,buffer:e.input.slice(0,-1),position:e.position,line:e.line,column:e.position-e.lineStart};return n.snippet=MXe(n),new To(t,n)}ie(SF,"generateError");function Dn(e,t){throw SF(e,t)}ie(Dn,"throwError");function n1(e,t){e.onWarning&&e.onWarning.call(null,SF(e,t))}ie(n1,"throwWarning");var RV={YAML:ie(function(t,n,r){var s,i,a;t.version!==null&&Dn(t,"duplication of %YAML directive"),r.length!==1&&Dn(t,"YAML directive accepts exactly one argument"),s=/^([0-9]+)\.([0-9]+)$/.exec(r[0]),s===null&&Dn(t,"ill-formed argument of the YAML directive"),i=parseInt(s[1],10),a=parseInt(s[2],10),i!==1&&Dn(t,"unacceptable YAML version of the document"),t.version=r[0],t.checkLineBreaks=a<2,a!==1&&a!==2&&n1(t,"unsupported YAML version of the document")},"handleYamlDirective"),TAG:ie(function(t,n,r){var s,i;r.length!==2&&Dn(t,"TAG directive accepts exactly two arguments"),s=r[0],i=r[1],Hae.test(s)||Dn(t,"ill-formed tag handle (first argument) of the TAG directive"),Ph.call(t.tagMap,s)&&Dn(t,'there is a previously declared suffix for "'+s+'" tag handle'),Gae.test(i)||Dn(t,"ill-formed tag prefix (second argument) of the TAG directive");try{i=decodeURIComponent(i)}catch{Dn(t,"tag prefix is malformed: "+i)}t.tagMap[s]=i},"handleTagDirective")};function Vd(e,t,n,r){var s,i,a,o;if(t<n){if(o=e.input.slice(t,n),r)for(s=0,i=o.length;s<i;s+=1)a=o.charCodeAt(s),a===9||32<=a&&a<=1114111||Dn(e,"expected valid JSON character");else rJe.test(o)&&Dn(e,"the stream contains non-printable characters");e.result+=o}}ie(Vd,"captureSegment");function X4(e,t,n,r){var s,i,a,o;for(qi.isObject(n)||Dn(e,"cannot merge mappings; the provided source object is unacceptable"),s=Object.keys(n),a=0,o=s.length;a<o;a+=1)i=s[a],Ph.call(t,i)||(t[i]=n[i],r[i]=!0)}ie(X4,"mergeMappings");function cm(e,t,n,r,s,i,a,o,l){var c,u;if(Array.isArray(s))for(s=Array.prototype.slice.call(s),c=0,u=s.length;c<u;c+=1)Array.isArray(s[c])&&Dn(e,"nested arrays are not supported inside keys"),typeof s=="object"&&Y4(s[c])==="[object Object]"&&(s[c]="[object Object]");if(typeof s=="object"&&Y4(s)==="[object Object]"&&(s="[object Object]"),s=String(s),t===null&&(t={}),r==="tag:yaml.org,2002:merge")if(Array.isArray(i))for(c=0,u=i.length;c<u;c+=1)X4(e,t,i[c],n);else X4(e,t,i,n);else!e.json&&!Ph.call(n,s)&&Ph.call(t,s)&&(e.line=a||e.line,e.lineStart=o||e.lineStart,e.position=l||e.position,Dn(e,"duplicated mapping key")),s==="__proto__"?Object.defineProperty(t,s,{configurable:!0,enumerable:!0,writable:!0,value:i}):t[s]=i,delete n[s];return t}ie(cm,"storeMappingPair");function nA(e){var t;t=e.input.charCodeAt(e.position),t===10?e.position++:t===13?(e.position++,e.input.charCodeAt(e.position)===10&&e.position++):Dn(e,"a line break is expected"),e.line+=1,e.lineStart=e.position,e.firstTabInLine=-1}ie(nA,"readLineBreak");function bi(e,t,n){for(var r=0,s=e.input.charCodeAt(e.position);s!==0;){for(;gh(s);)s===9&&e.firstTabInLine===-1&&(e.firstTabInLine=e.position),s=e.input.charCodeAt(++e.position);if(t&&s===35)do s=e.input.charCodeAt(++e.position);while(s!==10&&s!==13&&s!==0);if(Nc(s))for(nA(e),s=e.input.charCodeAt(e.position),r++,e.lineIndent=0;s===32;)e.lineIndent++,s=e.input.charCodeAt(++e.position);else break}return n!==-1&&r!==0&&e.lineIndent<n&&n1(e,"deficient indentation"),r}ie(bi,"skipSeparationSpace");function d_(e){var t=e.position,n;return n=e.input.charCodeAt(t),!!((n===45||n===46)&&n===e.input.charCodeAt(t+1)&&n===e.input.charCodeAt(t+2)&&(t+=3,n=e.input.charCodeAt(t),n===0||no(n)))}ie(d_,"testDocumentSeparator");function rA(e,t){t===1?e.result+=" ":t>1&&(e.result+=qi.repeat(`
`,t-1))}ie(rA,"writeFoldedLines");function toe(e,t,n){var r,s,i,a,o,l,c,u,d=e.kind,h=e.result,m;if(m=e.input.charCodeAt(e.position),no(m)||lm(m)||m===35||m===38||m===42||m===33||m===124||m===62||m===39||m===34||m===37||m===64||m===96||(m===63||m===45)&&(s=e.input.charCodeAt(e.position+1),no(s)||n&&lm(s)))return!1;for(e.kind="scalar",e.result="",i=a=e.position,o=!1;m!==0;){if(m===58){if(s=e.input.charCodeAt(e.position+1),no(s)||n&&lm(s))break}else if(m===35){if(r=e.input.charCodeAt(e.position-1),no(r))break}else{if(e.position===e.lineStart&&d_(e)||n&&lm(m))break;if(Nc(m))if(l=e.line,c=e.lineStart,u=e.lineIndent,bi(e,!1,-1),e.lineIndent>=t){o=!0,m=e.input.charCodeAt(e.position);continue}else{e.position=a,e.line=l,e.lineStart=c,e.lineIndent=u;break}}o&&(Vd(e,i,a,!1),rA(e,e.line-l),i=a=e.position,o=!1),gh(m)||(a=e.position+1),m=e.input.charCodeAt(++e.position)}return Vd(e,i,a,!1),e.result?!0:(e.kind=d,e.result=h,!1)}ie(toe,"readPlainScalar");function noe(e,t){var n,r,s;if(n=e.input.charCodeAt(e.position),n!==39)return!1;for(e.kind="scalar",e.result="",e.position++,r=s=e.position;(n=e.input.charCodeAt(e.position))!==0;)if(n===39)if(Vd(e,r,e.position,!0),n=e.input.charCodeAt(++e.position),n===39)r=e.position,e.position++,s=e.position;else return!0;else Nc(n)?(Vd(e,r,s,!0),rA(e,bi(e,!1,t)),r=s=e.position):e.position===e.lineStart&&d_(e)?Dn(e,"unexpected end of the document within a single quoted scalar"):(e.position++,s=e.position);Dn(e,"unexpected end of the stream within a single quoted scalar")}ie(noe,"readSingleQuotedScalar");function roe(e,t){var n,r,s,i,a,o;if(o=e.input.charCodeAt(e.position),o!==34)return!1;for(e.kind="scalar",e.result="",e.position++,n=r=e.position;(o=e.input.charCodeAt(e.position))!==0;){if(o===34)return Vd(e,n,e.position,!0),e.position++,!0;if(o===92){if(Vd(e,n,e.position,!0),o=e.input.charCodeAt(++e.position),Nc(o))bi(e,!1,t);else if(o<256&&Jae[o])e.result+=Qae[o],e.position++;else if((a=Yae(o))>0){for(s=a,i=0;s>0;s--)o=e.input.charCodeAt(++e.position),(a=Kae(o))>=0?i=(i<<4)+a:Dn(e,"expected hexadecimal character");e.result+=Xae(i),e.position++}else Dn(e,"unknown escape sequence");n=r=e.position}else Nc(o)?(Vd(e,n,r,!0),rA(e,bi(e,!1,t)),n=r=e.position):e.position===e.lineStart&&d_(e)?Dn(e,"unexpected end of the document within a double quoted scalar"):(e.position++,r=e.position)}Dn(e,"unexpected end of the stream within a double quoted scalar")}ie(roe,"readDoubleQuotedScalar");function soe(e,t){var n=!0,r,s,i,a=e.tag,o,l=e.anchor,c,u,d,h,m,y=Object.create(null),b,v,x,w;if(w=e.input.charCodeAt(e.position),w===91)u=93,m=!1,o=[];else if(w===123)u=125,m=!0,o={};else return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=o),w=e.input.charCodeAt(++e.position);w!==0;){if(bi(e,!0,t),w=e.input.charCodeAt(e.position),w===u)return e.position++,e.tag=a,e.anchor=l,e.kind=m?"mapping":"sequence",e.result=o,!0;n?w===44&&Dn(e,"expected the node content, but found ','"):Dn(e,"missed comma between flow collection entries"),v=b=x=null,d=h=!1,w===63&&(c=e.input.charCodeAt(e.position+1),no(c)&&(d=h=!0,e.position++,bi(e,!0,t))),r=e.line,s=e.lineStart,i=e.position,Dm(e,t,Dk,!1,!0),v=e.tag,b=e.result,bi(e,!0,t),w=e.input.charCodeAt(e.position),(h||e.line===r)&&w===58&&(d=!0,w=e.input.charCodeAt(++e.position),bi(e,!0,t),Dm(e,t,Dk,!1,!0),x=e.result),m?cm(e,o,y,v,b,x,r,s,i):d?o.push(cm(e,null,y,v,b,x,r,s,i)):o.push(b),bi(e,!0,t),w=e.input.charCodeAt(e.position),w===44?(n=!0,w=e.input.charCodeAt(++e.position)):n=!1}Dn(e,"unexpected end of the stream within a flow collection")}ie(soe,"readFlowCollection");function ioe(e,t){var n,r,s=R3,i=!1,a=!1,o=t,l=0,c=!1,u,d;if(d=e.input.charCodeAt(e.position),d===124)r=!1;else if(d===62)r=!0;else return!1;for(e.kind="scalar",e.result="";d!==0;)if(d=e.input.charCodeAt(++e.position),d===43||d===45)R3===s?s=d===43?AV:nJe:Dn(e,"repeat of a chomping mode identifier");else if((u=Zae(d))>=0)u===0?Dn(e,"bad explicit indentation width of a block scalar; it cannot be less than one"):a?Dn(e,"repeat of an indentation width identifier"):(o=t+u-1,a=!0);else break;if(gh(d)){do d=e.input.charCodeAt(++e.position);while(gh(d));if(d===35)do d=e.input.charCodeAt(++e.position);while(!Nc(d)&&d!==0)}for(;d!==0;){for(nA(e),e.lineIndent=0,d=e.input.charCodeAt(e.position);(!a||e.lineIndent<o)&&d===32;)e.lineIndent++,d=e.input.charCodeAt(++e.position);if(!a&&e.lineIndent>o&&(o=e.lineIndent),Nc(d)){l++;continue}if(e.lineIndent<o){s===AV?e.result+=qi.repeat(`
`,i?1+l:l):s===R3&&i&&(e.result+=`
`);break}for(r?gh(d)?(c=!0,e.result+=qi.repeat(`
`,i?1+l:l)):c?(c=!1,e.result+=qi.repeat(`
`,l+1)):l===0?i&&(e.result+=" "):e.result+=qi.repeat(`
`,l):e.result+=qi.repeat(`
`,i?1+l:l),i=!0,a=!0,l=0,n=e.position;!Nc(d)&&d!==0;)d=e.input.charCodeAt(++e.position);Vd(e,n,e.position,!1)}return!0}ie(ioe,"readBlockScalar");function J4(e,t){var n,r=e.tag,s=e.anchor,i=[],a,o=!1,l;if(e.firstTabInLine!==-1)return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=i),l=e.input.charCodeAt(e.position);l!==0&&(e.firstTabInLine!==-1&&(e.position=e.firstTabInLine,Dn(e,"tab characters must not be used in indentation")),!(l!==45||(a=e.input.charCodeAt(e.position+1),!no(a))));){if(o=!0,e.position++,bi(e,!0,-1)&&e.lineIndent<=t){i.push(null),l=e.input.charCodeAt(e.position);continue}if(n=e.line,Dm(e,t,Wae,!1,!0),i.push(e.result),bi(e,!0,-1),l=e.input.charCodeAt(e.position),(e.line===n||e.lineIndent>t)&&l!==0)Dn(e,"bad indentation of a sequence entry");else if(e.lineIndent<t)break}return o?(e.tag=r,e.anchor=s,e.kind="sequence",e.result=i,!0):!1}ie(J4,"readBlockSequence");function aoe(e,t,n){var r,s,i,a,o,l,c=e.tag,u=e.anchor,d={},h=Object.create(null),m=null,y=null,b=null,v=!1,x=!1,w;if(e.firstTabInLine!==-1)return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=d),w=e.input.charCodeAt(e.position);w!==0;){if(!v&&e.firstTabInLine!==-1&&(e.position=e.firstTabInLine,Dn(e,"tab characters must not be used in indentation")),r=e.input.charCodeAt(e.position+1),i=e.line,(w===63||w===58)&&no(r))w===63?(v&&(cm(e,d,h,m,y,null,a,o,l),m=y=b=null),x=!0,v=!0,s=!0):v?(v=!1,s=!0):Dn(e,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),e.position+=1,w=r;else{if(a=e.line,o=e.lineStart,l=e.position,!Dm(e,n,Vae,!1,!0))break;if(e.line===i){for(w=e.input.charCodeAt(e.position);gh(w);)w=e.input.charCodeAt(++e.position);if(w===58)w=e.input.charCodeAt(++e.position),no(w)||Dn(e,"a whitespace character is expected after the key-value separator within a block mapping"),v&&(cm(e,d,h,m,y,null,a,o,l),m=y=b=null),x=!0,v=!1,s=!1,m=e.tag,y=e.result;else if(x)Dn(e,"can not read an implicit mapping pair; a colon is missed");else return e.tag=c,e.anchor=u,!0}else if(x)Dn(e,"can not read a block mapping entry; a multiline key may not be an implicit key");else return e.tag=c,e.anchor=u,!0}if((e.line===i||e.lineIndent>t)&&(v&&(a=e.line,o=e.lineStart,l=e.position),Dm(e,t,Fk,!0,s)&&(v?y=e.result:b=e.result),v||(cm(e,d,h,m,y,b,a,o,l),m=y=b=null),bi(e,!0,-1),w=e.input.charCodeAt(e.position)),(e.line===i||e.lineIndent>t)&&w!==0)Dn(e,"bad indentation of a mapping entry");else if(e.lineIndent<t)break}return v&&cm(e,d,h,m,y,null,a,o,l),x&&(e.tag=c,e.anchor=u,e.kind="mapping",e.result=d),x}ie(aoe,"readBlockMapping");function ooe(e){var t,n=!1,r=!1,s,i,a;if(a=e.input.charCodeAt(e.position),a!==33)return!1;if(e.tag!==null&&Dn(e,"duplication of a tag property"),a=e.input.charCodeAt(++e.position),a===60?(n=!0,a=e.input.charCodeAt(++e.position)):a===33?(r=!0,s="!!",a=e.input.charCodeAt(++e.position)):s="!",t=e.position,n){do a=e.input.charCodeAt(++e.position);while(a!==0&&a!==62);e.position<e.length?(i=e.input.slice(t,e.position),a=e.input.charCodeAt(++e.position)):Dn(e,"unexpected end of the stream within a verbatim tag")}else{for(;a!==0&&!no(a);)a===33&&(r?Dn(e,"tag suffix cannot contain exclamation marks"):(s=e.input.slice(t-1,e.position+1),Hae.test(s)||Dn(e,"named tag handle cannot contain such characters"),r=!0,t=e.position+1)),a=e.input.charCodeAt(++e.position);i=e.input.slice(t,e.position),iJe.test(i)&&Dn(e,"tag suffix cannot contain flow indicator characters")}i&&!Gae.test(i)&&Dn(e,"tag name cannot contain such characters: "+i);try{i=decodeURIComponent(i)}catch{Dn(e,"tag name is malformed: "+i)}return n?e.tag=i:Ph.call(e.tagMap,s)?e.tag=e.tagMap[s]+i:s==="!"?e.tag="!"+i:s==="!!"?e.tag="tag:yaml.org,2002:"+i:Dn(e,'undeclared tag handle "'+s+'"'),!0}ie(ooe,"readTagProperty");function loe(e){var t,n;if(n=e.input.charCodeAt(e.position),n!==38)return!1;for(e.anchor!==null&&Dn(e,"duplication of an anchor property"),n=e.input.charCodeAt(++e.position),t=e.position;n!==0&&!no(n)&&!lm(n);)n=e.input.charCodeAt(++e.position);return e.position===t&&Dn(e,"name of an anchor node must contain at least one character"),e.anchor=e.input.slice(t,e.position),!0}ie(loe,"readAnchorProperty");function coe(e){var t,n,r;if(r=e.input.charCodeAt(e.position),r!==42)return!1;for(r=e.input.charCodeAt(++e.position),t=e.position;r!==0&&!no(r)&&!lm(r);)r=e.input.charCodeAt(++e.position);return e.position===t&&Dn(e,"name of an alias node must contain at least one character"),n=e.input.slice(t,e.position),Ph.call(e.anchorMap,n)||Dn(e,'unidentified alias "'+n+'"'),e.result=e.anchorMap[n],bi(e,!0,-1),!0}ie(coe,"readAlias");function Dm(e,t,n,r,s){var i,a,o,l=1,c=!1,u=!1,d,h,m,y,b,v;if(e.listener!==null&&e.listener("open",e),e.tag=null,e.anchor=null,e.kind=null,e.result=null,i=a=o=Fk===n||Wae===n,r&&bi(e,!0,-1)&&(c=!0,e.lineIndent>t?l=1:e.lineIndent===t?l=0:e.lineIndent<t&&(l=-1)),l===1)for(;ooe(e)||loe(e);)bi(e,!0,-1)?(c=!0,o=i,e.lineIndent>t?l=1:e.lineIndent===t?l=0:e.lineIndent<t&&(l=-1)):o=!1;if(o&&(o=c||s),(l===1||Fk===n)&&(Dk===n||Vae===n?b=t:b=t+1,v=e.position-e.lineStart,l===1?o&&(J4(e,v)||aoe(e,v,b))||soe(e,b)?u=!0:(a&&ioe(e,b)||noe(e,b)||roe(e,b)?u=!0:coe(e)?(u=!0,(e.tag!==null||e.anchor!==null)&&Dn(e,"alias node should not have any properties")):toe(e,b,Dk===n)&&(u=!0,e.tag===null&&(e.tag="?")),e.anchor!==null&&(e.anchorMap[e.anchor]=e.result)):l===0&&(u=o&&J4(e,v))),e.tag===null)e.anchor!==null&&(e.anchorMap[e.anchor]=e.result);else if(e.tag==="?"){for(e.result!==null&&e.kind!=="scalar"&&Dn(e,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+e.kind+'"'),d=0,h=e.implicitTypes.length;d<h;d+=1)if(y=e.implicitTypes[d],y.resolve(e.result)){e.result=y.construct(e.result),e.tag=y.tag,e.anchor!==null&&(e.anchorMap[e.anchor]=e.result);break}}else if(e.tag!=="!"){if(Ph.call(e.typeMap[e.kind||"fallback"],e.tag))y=e.typeMap[e.kind||"fallback"][e.tag];else for(y=null,m=e.typeMap.multi[e.kind||"fallback"],d=0,h=m.length;d<h;d+=1)if(e.tag.slice(0,m[d].tag.length)===m[d].tag){y=m[d];break}y||Dn(e,"unknown tag !<"+e.tag+">"),e.result!==null&&y.kind!==e.kind&&Dn(e,"unacceptable node kind for !<"+e.tag+'> tag; it should be "'+y.kind+'", not "'+e.kind+'"'),y.resolve(e.result,e.tag)?(e.result=y.construct(e.result,e.tag),e.anchor!==null&&(e.anchorMap[e.anchor]=e.result)):Dn(e,"cannot resolve a node with !<"+e.tag+"> explicit tag")}return e.listener!==null&&e.listener("close",e),e.tag!==null||e.anchor!==null||u}ie(Dm,"composeNode");function uoe(e){var t=e.position,n,r,s,i=!1,a;for(e.version=null,e.checkLineBreaks=e.legacy,e.tagMap=Object.create(null),e.anchorMap=Object.create(null);(a=e.input.charCodeAt(e.position))!==0&&(bi(e,!0,-1),a=e.input.charCodeAt(e.position),!(e.lineIndent>0||a!==37));){for(i=!0,a=e.input.charCodeAt(++e.position),n=e.position;a!==0&&!no(a);)a=e.input.charCodeAt(++e.position);for(r=e.input.slice(n,e.position),s=[],r.length<1&&Dn(e,"directive name must not be less than one character in length");a!==0;){for(;gh(a);)a=e.input.charCodeAt(++e.position);if(a===35){do a=e.input.charCodeAt(++e.position);while(a!==0&&!Nc(a));break}if(Nc(a))break;for(n=e.position;a!==0&&!no(a);)a=e.input.charCodeAt(++e.position);s.push(e.input.slice(n,e.position))}a!==0&&nA(e),Ph.call(RV,r)?RV[r](e,r,s):n1(e,'unknown document directive "'+r+'"')}if(bi(e,!0,-1),e.lineIndent===0&&e.input.charCodeAt(e.position)===45&&e.input.charCodeAt(e.position+1)===45&&e.input.charCodeAt(e.position+2)===45?(e.position+=3,bi(e,!0,-1)):i&&Dn(e,"directives end mark is expected"),Dm(e,e.lineIndent-1,Fk,!1,!0),bi(e,!0,-1),e.checkLineBreaks&&sJe.test(e.input.slice(t,e.position))&&n1(e,"non-ASCII line breaks are interpreted as content"),e.documents.push(e.result),e.position===e.lineStart&&d_(e)){e.input.charCodeAt(e.position)===46&&(e.position+=3,bi(e,!0,-1));return}if(e.position<e.length-1)Dn(e,"end of the stream or a document separator is expected");else return}ie(uoe,"readDocument");function CF(e,t){e=String(e),t=t||{},e.length!==0&&(e.charCodeAt(e.length-1)!==10&&e.charCodeAt(e.length-1)!==13&&(e+=`
`),e.charCodeAt(0)===65279&&(e=e.slice(1)));var n=new eoe(e,t),r=e.indexOf("\0");for(r!==-1&&(n.position=r,Dn(n,"null byte is not allowed in input")),n.input+="\0";n.input.charCodeAt(n.position)===32;)n.lineIndent+=1,n.position+=1;for(;n.position<n.length-1;)uoe(n);return n.documents}ie(CF,"loadDocuments");function aJe(e,t,n){t!==null&&typeof t=="object"&&typeof n>"u"&&(n=t,t=null);var r=CF(e,n);if(typeof t!="function")return r;for(var s=0,i=r.length;s<i;s+=1)t(r[s])}ie(aJe,"loadAll$1");function doe(e,t){var n=CF(e,t);if(n.length!==0){if(n.length===1)return n[0];throw new To("expected a single document in the stream, but found more")}}ie(doe,"load$1");var oJe=doe,lJe={load:oJe},foe=Object.prototype.toString,hoe=Object.prototype.hasOwnProperty,kF=65279,cJe=9,r1=10,uJe=13,dJe=32,fJe=33,hJe=34,Q4=35,pJe=37,mJe=38,gJe=39,yJe=42,poe=44,bJe=45,Lk=58,vJe=61,xJe=62,wJe=63,_Je=64,moe=91,goe=93,SJe=96,yoe=123,CJe=124,boe=125,Va={};Va[0]="\\0";Va[7]="\\a";Va[8]="\\b";Va[9]="\\t";Va[10]="\\n";Va[11]="\\v";Va[12]="\\f";Va[13]="\\r";Va[27]="\\e";Va[34]='\\"';Va[92]="\\\\";Va[133]="\\N";Va[160]="\\_";Va[8232]="\\L";Va[8233]="\\P";var kJe=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"],EJe=/^[-+]?[0-9_]+(?::[0-9_]+)+(?:\.[0-9_]*)?$/;function voe(e,t){var n,r,s,i,a,o,l;if(t===null)return{};for(n={},r=Object.keys(t),s=0,i=r.length;s<i;s+=1)a=r[s],o=String(t[a]),a.slice(0,2)==="!!"&&(a="tag:yaml.org,2002:"+a.slice(2)),l=e.compiledTypeMap.fallback[a],l&&hoe.call(l.styleAliases,o)&&(o=l.styleAliases[o]),n[a]=o;return n}ie(voe,"compileStyleMap");function xoe(e){var t,n,r;if(t=e.toString(16).toUpperCase(),e<=255)n="x",r=2;else if(e<=65535)n="u",r=4;else if(e<=4294967295)n="U",r=8;else throw new To("code point within a string may not be greater than 0xFFFFFFFF");return"\\"+n+qi.repeat("0",r-t.length)+t}ie(xoe,"encodeHex");var TJe=1,s1=2;function woe(e){this.schema=e.schema||qae,this.indent=Math.max(1,e.indent||2),this.noArrayIndent=e.noArrayIndent||!1,this.skipInvalid=e.skipInvalid||!1,this.flowLevel=qi.isNothing(e.flowLevel)?-1:e.flowLevel,this.styleMap=voe(this.schema,e.styles||null),this.sortKeys=e.sortKeys||!1,this.lineWidth=e.lineWidth||80,this.noRefs=e.noRefs||!1,this.noCompatMode=e.noCompatMode||!1,this.condenseFlow=e.condenseFlow||!1,this.quotingType=e.quotingType==='"'?s1:TJe,this.forceQuotes=e.forceQuotes||!1,this.replacer=typeof e.replacer=="function"?e.replacer:null,this.implicitTypes=this.schema.compiledImplicit,this.explicitTypes=this.schema.compiledExplicit,this.tag=null,this.result="",this.duplicates=[],this.usedDuplicates=null}ie(woe,"State");function eO(e,t){for(var n=qi.repeat(" ",t),r=0,s=-1,i="",a,o=e.length;r<o;)s=e.indexOf(`
`,r),s===-1?(a=e.slice(r),r=o):(a=e.slice(r,s+1),r=s+1),a.length&&a!==`
`&&(i+=n),i+=a;return i}ie(eO,"indentString");function Bk(e,t){return`
`+qi.repeat(" ",e.indent*t)}ie(Bk,"generateNextLine");function _oe(e,t){var n,r,s;for(n=0,r=e.implicitTypes.length;n<r;n+=1)if(s=e.implicitTypes[n],s.resolve(t))return!0;return!1}ie(_oe,"testImplicitResolving");function i1(e){return e===dJe||e===cJe}ie(i1,"isWhitespace");function Oy(e){return 32<=e&&e<=126||161<=e&&e<=55295&&e!==8232&&e!==8233||57344<=e&&e<=65533&&e!==kF||65536<=e&&e<=1114111}ie(Oy,"isPrintable");function tO(e){return Oy(e)&&e!==kF&&e!==uJe&&e!==r1}ie(tO,"isNsCharOrWhitespace");function nO(e,t,n){var r=tO(e),s=r&&!i1(e);return(n?r:r&&e!==poe&&e!==moe&&e!==goe&&e!==yoe&&e!==boe)&&e!==Q4&&!(t===Lk&&!s)||tO(t)&&!i1(t)&&e===Q4||t===Lk&&s}ie(nO,"isPlainSafe");function Soe(e){return Oy(e)&&e!==kF&&!i1(e)&&e!==bJe&&e!==wJe&&e!==Lk&&e!==poe&&e!==moe&&e!==goe&&e!==yoe&&e!==boe&&e!==Q4&&e!==mJe&&e!==yJe&&e!==fJe&&e!==CJe&&e!==vJe&&e!==xJe&&e!==gJe&&e!==hJe&&e!==pJe&&e!==_Je&&e!==SJe}ie(Soe,"isPlainSafeFirst");function Coe(e){return!i1(e)&&e!==Lk}ie(Coe,"isPlainSafeLast");function N0(e,t){var n=e.charCodeAt(t),r;return n>=55296&&n<=56319&&t+1<e.length&&(r=e.charCodeAt(t+1),r>=56320&&r<=57343)?(n-55296)*1024+r-56320+65536:n}ie(N0,"codePointAt");function EF(e){var t=/^\n* /;return t.test(e)}ie(EF,"needIndentIndicator");var koe=1,rO=2,Eoe=3,Toe=4,m0=5;function Aoe(e,t,n,r,s,i,a,o){var l,c=0,u=null,d=!1,h=!1,m=r!==-1,y=-1,b=Soe(N0(e,0))&&Coe(N0(e,e.length-1));if(t||a)for(l=0;l<e.length;c>=65536?l+=2:l++){if(c=N0(e,l),!Oy(c))return m0;b=b&&nO(c,u,o),u=c}else{for(l=0;l<e.length;c>=65536?l+=2:l++){if(c=N0(e,l),c===r1)d=!0,m&&(h=h||l-y-1>r&&e[y+1]!==" ",y=l);else if(!Oy(c))return m0;b=b&&nO(c,u,o),u=c}h=h||m&&l-y-1>r&&e[y+1]!==" "}return!d&&!h?b&&!a&&!s(e)?koe:i===s1?m0:rO:n>9&&EF(e)?m0:a?i===s1?m0:rO:h?Toe:Eoe}ie(Aoe,"chooseScalarStyle");function Roe(e,t,n,r,s){e.dump=function(){if(t.length===0)return e.quotingType===s1?'""':"''";if(!e.noCompatMode&&(kJe.indexOf(t)!==-1||EJe.test(t)))return e.quotingType===s1?'"'+t+'"':"'"+t+"'";var i=e.indent*Math.max(1,n),a=e.lineWidth===-1?-1:Math.max(Math.min(e.lineWidth,40),e.lineWidth-i),o=r||e.flowLevel>-1&&n>=e.flowLevel;function l(c){return _oe(e,c)}switch(ie(l,"testAmbiguity"),Aoe(t,o,e.indent,a,l,e.quotingType,e.forceQuotes&&!r,s)){case koe:return t;case rO:return"'"+t.replace(/'/g,"''")+"'";case Eoe:return"|"+sO(t,e.indent)+iO(eO(t,i));case Toe:return">"+sO(t,e.indent)+iO(eO(Noe(t,a),i));case m0:return'"'+Moe(t)+'"';default:throw new To("impossible error: invalid scalar style")}}()}ie(Roe,"writeScalar");function sO(e,t){var n=EF(e)?String(t):"",r=e[e.length-1]===`
`,s=r&&(e[e.length-2]===`
`||e===`
`),i=s?"+":r?"":"-";return n+i+`
`}ie(sO,"blockHeader");function iO(e){return e[e.length-1]===`
`?e.slice(0,-1):e}ie(iO,"dropEndingNewline");function Noe(e,t){for(var n=/(\n+)([^\n]*)/g,r=function(){var c=e.indexOf(`
`);return c=c!==-1?c:e.length,n.lastIndex=c,aO(e.slice(0,c),t)}(),s=e[0]===`
`||e[0]===" ",i,a;a=n.exec(e);){var o=a[1],l=a[2];i=l[0]===" ",r+=o+(!s&&!i&&l!==""?`
`:"")+aO(l,t),s=i}return r}ie(Noe,"foldString");function aO(e,t){if(e===""||e[0]===" ")return e;for(var n=/ [^ ]/g,r,s=0,i,a=0,o=0,l="";r=n.exec(e);)o=r.index,o-s>t&&(i=a>s?a:o,l+=`
`+e.slice(s,i),s=i+1),a=o;return l+=`
`,e.length-s>t&&a>s?l+=e.slice(s,a)+`
`+e.slice(a+1):l+=e.slice(s),l.slice(1)}ie(aO,"foldLine");function Moe(e){for(var t="",n=0,r,s=0;s<e.length;n>=65536?s+=2:s++)n=N0(e,s),r=Va[n],!r&&Oy(n)?(t+=e[s],n>=65536&&(t+=e[s+1])):t+=r||xoe(n);return t}ie(Moe,"escapeString");function Ioe(e,t,n){var r="",s=e.tag,i,a,o;for(i=0,a=n.length;i<a;i+=1)o=n[i],e.replacer&&(o=e.replacer.call(n,String(i),o)),(Bu(e,t,o,!1,!1)||typeof o>"u"&&Bu(e,t,null,!1,!1))&&(r!==""&&(r+=","+(e.condenseFlow?"":" ")),r+=e.dump);e.tag=s,e.dump="["+r+"]"}ie(Ioe,"writeFlowSequence");function oO(e,t,n,r){var s="",i=e.tag,a,o,l;for(a=0,o=n.length;a<o;a+=1)l=n[a],e.replacer&&(l=e.replacer.call(n,String(a),l)),(Bu(e,t+1,l,!0,!0,!1,!0)||typeof l>"u"&&Bu(e,t+1,null,!0,!0,!1,!0))&&((!r||s!=="")&&(s+=Bk(e,t)),e.dump&&r1===e.dump.charCodeAt(0)?s+="-":s+="- ",s+=e.dump);e.tag=i,e.dump=s||"[]"}ie(oO,"writeBlockSequence");function joe(e,t,n){var r="",s=e.tag,i=Object.keys(n),a,o,l,c,u;for(a=0,o=i.length;a<o;a+=1)u="",r!==""&&(u+=", "),e.condenseFlow&&(u+='"'),l=i[a],c=n[l],e.replacer&&(c=e.replacer.call(n,l,c)),Bu(e,t,l,!1,!1)&&(e.dump.length>1024&&(u+="? "),u+=e.dump+(e.condenseFlow?'"':"")+":"+(e.condenseFlow?"":" "),Bu(e,t,c,!1,!1)&&(u+=e.dump,r+=u));e.tag=s,e.dump="{"+r+"}"}ie(joe,"writeFlowMapping");function Ooe(e,t,n,r){var s="",i=e.tag,a=Object.keys(n),o,l,c,u,d,h;if(e.sortKeys===!0)a.sort();else if(typeof e.sortKeys=="function")a.sort(e.sortKeys);else if(e.sortKeys)throw new To("sortKeys must be a boolean or a function");for(o=0,l=a.length;o<l;o+=1)h="",(!r||s!=="")&&(h+=Bk(e,t)),c=a[o],u=n[c],e.replacer&&(u=e.replacer.call(n,c,u)),Bu(e,t+1,c,!0,!0,!0)&&(d=e.tag!==null&&e.tag!=="?"||e.dump&&e.dump.length>1024,d&&(e.dump&&r1===e.dump.charCodeAt(0)?h+="?":h+="? "),h+=e.dump,d&&(h+=Bk(e,t)),Bu(e,t+1,u,!0,d)&&(e.dump&&r1===e.dump.charCodeAt(0)?h+=":":h+=": ",h+=e.dump,s+=h));e.tag=i,e.dump=s||"{}"}ie(Ooe,"writeBlockMapping");function lO(e,t,n){var r,s,i,a,o,l;for(s=n?e.explicitTypes:e.implicitTypes,i=0,a=s.length;i<a;i+=1)if(o=s[i],(o.instanceOf||o.predicate)&&(!o.instanceOf||typeof t=="object"&&t instanceof o.instanceOf)&&(!o.predicate||o.predicate(t))){if(n?o.multi&&o.representName?e.tag=o.representName(t):e.tag=o.tag:e.tag="?",o.represent){if(l=e.styleMap[o.tag]||o.defaultStyle,foe.call(o.represent)==="[object Function]")r=o.represent(t,l);else if(hoe.call(o.represent,l))r=o.represent[l](t,l);else throw new To("!<"+o.tag+'> tag resolver accepts not "'+l+'" style');e.dump=r}return!0}return!1}ie(lO,"detectType");function Bu(e,t,n,r,s,i,a){e.tag=null,e.dump=n,lO(e,n,!1)||lO(e,n,!0);var o=foe.call(e.dump),l=r,c;r&&(r=e.flowLevel<0||e.flowLevel>t);var u=o==="[object Object]"||o==="[object Array]",d,h;if(u&&(d=e.duplicates.indexOf(n),h=d!==-1),(e.tag!==null&&e.tag!=="?"||h||e.indent!==2&&t>0)&&(s=!1),h&&e.usedDuplicates[d])e.dump="*ref_"+d;else{if(u&&h&&!e.usedDuplicates[d]&&(e.usedDuplicates[d]=!0),o==="[object Object]")r&&Object.keys(e.dump).length!==0?(Ooe(e,t,e.dump,s),h&&(e.dump="&ref_"+d+e.dump)):(joe(e,t,e.dump),h&&(e.dump="&ref_"+d+" "+e.dump));else if(o==="[object Array]")r&&e.dump.length!==0?(e.noArrayIndent&&!a&&t>0?oO(e,t-1,e.dump,s):oO(e,t,e.dump,s),h&&(e.dump="&ref_"+d+e.dump)):(Ioe(e,t,e.dump),h&&(e.dump="&ref_"+d+" "+e.dump));else if(o==="[object String]")e.tag!=="?"&&Roe(e,e.dump,t,i,l);else{if(o==="[object Undefined]")return!1;if(e.skipInvalid)return!1;throw new To("unacceptable kind of an object to dump "+o)}e.tag!==null&&e.tag!=="?"&&(c=encodeURI(e.tag[0]==="!"?e.tag.slice(1):e.tag).replace(/!/g,"%21"),e.tag[0]==="!"?c="!"+c:c.slice(0,18)==="tag:yaml.org,2002:"?c="!!"+c.slice(18):c="!<"+c+">",e.dump=c+" "+e.dump)}return!0}ie(Bu,"writeNode");function Poe(e,t){var n=[],r=[],s,i;for($k(e,n,r),s=0,i=r.length;s<i;s+=1)t.duplicates.push(n[r[s]]);t.usedDuplicates=new Array(i)}ie(Poe,"getDuplicateReferences");function $k(e,t,n){var r,s,i;if(e!==null&&typeof e=="object")if(s=t.indexOf(e),s!==-1)n.indexOf(s)===-1&&n.push(s);else if(t.push(e),Array.isArray(e))for(s=0,i=e.length;s<i;s+=1)$k(e[s],t,n);else for(r=Object.keys(e),s=0,i=r.length;s<i;s+=1)$k(e[r[s]],t,n)}ie($k,"inspectNode");function AJe(e,t){t=t||{};var n=new woe(t);n.noRefs||Poe(e,n);var r=e;return n.replacer&&(r=n.replacer.call({"":r},"",r)),Bu(n,0,r,!0,!0)?n.dump+`
`:""}ie(AJe,"dump$1");function RJe(e,t){return function(){throw new Error("Function yaml."+e+" is removed in js-yaml 4. Use yaml."+t+" instead, which is now safe by default.")}}ie(RJe,"renamed");var NJe=Eae,MJe=lJe.load;/*! Bundled license information:

js-yaml/dist/js-yaml.mjs:
  (*! js-yaml 4.1.0 https://github.com/nodeca/js-yaml @license MIT *)
*/var Fl={aggregation:18,extension:18,composition:18,dependency:6,lollipop:13.5,arrow_point:4};function vx(e,t){if(e===void 0||t===void 0)return{angle:0,deltaX:0,deltaY:0};e=Ys(e),t=Ys(t);const[n,r]=[e.x,e.y],[s,i]=[t.x,t.y],a=s-n,o=i-r;return{angle:Math.atan(o/a),deltaX:a,deltaY:o}}ie(vx,"calculateDeltaAndAngle");var Ys=ie(e=>Array.isArray(e)?{x:e[0],y:e[1]}:e,"pointTransformer"),IJe=ie(e=>({x:ie(function(t,n,r){let s=0;const i=Ys(r[0]).x<Ys(r[r.length-1]).x?"left":"right";if(n===0&&Object.hasOwn(Fl,e.arrowTypeStart)){const{angle:m,deltaX:y}=vx(r[0],r[1]);s=Fl[e.arrowTypeStart]*Math.cos(m)*(y>=0?1:-1)}else if(n===r.length-1&&Object.hasOwn(Fl,e.arrowTypeEnd)){const{angle:m,deltaX:y}=vx(r[r.length-1],r[r.length-2]);s=Fl[e.arrowTypeEnd]*Math.cos(m)*(y>=0?1:-1)}const a=Math.abs(Ys(t).x-Ys(r[r.length-1]).x),o=Math.abs(Ys(t).y-Ys(r[r.length-1]).y),l=Math.abs(Ys(t).x-Ys(r[0]).x),c=Math.abs(Ys(t).y-Ys(r[0]).y),u=Fl[e.arrowTypeStart],d=Fl[e.arrowTypeEnd],h=1;if(a<d&&a>0&&o<d){let m=d+h-a;m*=i==="right"?-1:1,s-=m}if(l<u&&l>0&&c<u){let m=u+h-l;m*=i==="right"?-1:1,s+=m}return Ys(t).x+s},"x"),y:ie(function(t,n,r){let s=0;const i=Ys(r[0]).y<Ys(r[r.length-1]).y?"down":"up";if(n===0&&Object.hasOwn(Fl,e.arrowTypeStart)){const{angle:m,deltaY:y}=vx(r[0],r[1]);s=Fl[e.arrowTypeStart]*Math.abs(Math.sin(m))*(y>=0?1:-1)}else if(n===r.length-1&&Object.hasOwn(Fl,e.arrowTypeEnd)){const{angle:m,deltaY:y}=vx(r[r.length-1],r[r.length-2]);s=Fl[e.arrowTypeEnd]*Math.abs(Math.sin(m))*(y>=0?1:-1)}const a=Math.abs(Ys(t).y-Ys(r[r.length-1]).y),o=Math.abs(Ys(t).x-Ys(r[r.length-1]).x),l=Math.abs(Ys(t).y-Ys(r[0]).y),c=Math.abs(Ys(t).x-Ys(r[0]).x),u=Fl[e.arrowTypeStart],d=Fl[e.arrowTypeEnd],h=1;if(a<d&&a>0&&o<d){let m=d+h-a;m*=i==="up"?-1:1,s-=m}if(l<u&&l>0&&c<u){let m=u+h-l;m*=i==="up"?-1:1,s+=m}return Ys(t).y+s},"y")}),"getLineFunctionsWithOffset"),TF=ie(({flowchart:e})=>{var s,i;const t=((s=e==null?void 0:e.subGraphTitleMargin)==null?void 0:s.top)??0,n=((i=e==null?void 0:e.subGraphTitleMargin)==null?void 0:i.bottom)??0,r=t+n;return{subGraphTitleTopMargin:t,subGraphTitleBottomMargin:n,subGraphTitleTotalMargin:r}},"getSubGraphTitleMargins");const jJe=Object.freeze({left:0,top:0,width:16,height:16}),zk=Object.freeze({rotate:0,vFlip:!1,hFlip:!1}),Doe=Object.freeze({...jJe,...zk}),OJe=Object.freeze({...Doe,body:"",hidden:!1}),PJe=Object.freeze({width:null,height:null}),DJe=Object.freeze({...PJe,...zk}),FJe=(e,t,n,r="")=>{const s=e.split(":");if(e.slice(0,1)==="@"){if(s.length<2||s.length>3)return null;r=s.shift().slice(1)}if(s.length>3||!s.length)return null;if(s.length>1){const o=s.pop(),l=s.pop(),c={provider:s.length>0?s[0]:r,prefix:l,name:o};return N3(c)?c:null}const i=s[0],a=i.split("-");if(a.length>1){const o={provider:r,prefix:a.shift(),name:a.join("-")};return N3(o)?o:null}if(n&&r===""){const o={provider:r,prefix:"",name:i};return N3(o,n)?o:null}return null},N3=(e,t)=>e?!!((t&&e.prefix===""||e.prefix)&&e.name):!1;function LJe(e,t){const n={};!e.hFlip!=!t.hFlip&&(n.hFlip=!0),!e.vFlip!=!t.vFlip&&(n.vFlip=!0);const r=((e.rotate||0)+(t.rotate||0))%4;return r&&(n.rotate=r),n}function NV(e,t){const n=LJe(e,t);for(const r in OJe)r in zk?r in e&&!(r in n)&&(n[r]=zk[r]):r in t?n[r]=t[r]:r in e&&(n[r]=e[r]);return n}function BJe(e,t){const n=e.icons,r=e.aliases||Object.create(null),s=Object.create(null);function i(a){if(n[a])return s[a]=[];if(!(a in s)){s[a]=null;const o=r[a]&&r[a].parent,l=o&&i(o);l&&(s[a]=[o].concat(l))}return s[a]}return(t||Object.keys(n).concat(Object.keys(r))).forEach(i),s}function MV(e,t,n){const r=e.icons,s=e.aliases||Object.create(null);let i={};function a(o){i=NV(r[o]||s[o],i)}return a(t),n.forEach(a),NV(e,i)}function $Je(e,t){if(e.icons[t])return MV(e,t,[]);const n=BJe(e,[t])[t];return n?MV(e,t,n):null}const zJe=/(-?[0-9.]*[0-9]+[0-9.]*)/g,UJe=/^-?[0-9.]*[0-9]+[0-9.]*$/g;function IV(e,t,n){if(t===1)return e;if(n=n||100,typeof e=="number")return Math.ceil(e*t*n)/n;if(typeof e!="string")return e;const r=e.split(zJe);if(r===null||!r.length)return e;const s=[];let i=r.shift(),a=UJe.test(i);for(;;){if(a){const o=parseFloat(i);isNaN(o)?s.push(i):s.push(Math.ceil(o*t*n)/n)}else s.push(i);if(i=r.shift(),i===void 0)return s.join("");a=!a}}function qJe(e,t="defs"){let n="";const r=e.indexOf("<"+t);for(;r>=0;){const s=e.indexOf(">",r),i=e.indexOf("</"+t);if(s===-1||i===-1)break;const a=e.indexOf(">",i);if(a===-1)break;n+=e.slice(s+1,i).trim(),e=e.slice(0,r).trim()+e.slice(a+1)}return{defs:n,content:e}}function VJe(e,t){return e?"<defs>"+e+"</defs>"+t:t}function WJe(e,t,n){const r=qJe(e);return VJe(r.defs,t+r.content+n)}const HJe=e=>e==="unset"||e==="undefined"||e==="none";function GJe(e,t){const n={...Doe,...e},r={...DJe,...t},s={left:n.left,top:n.top,width:n.width,height:n.height};let i=n.body;[n,r].forEach(b=>{const v=[],x=b.hFlip,w=b.vFlip;let S=b.rotate;x?w?S+=2:(v.push("translate("+(s.width+s.left).toString()+" "+(0-s.top).toString()+")"),v.push("scale(-1 1)"),s.top=s.left=0):w&&(v.push("translate("+(0-s.left).toString()+" "+(s.height+s.top).toString()+")"),v.push("scale(1 -1)"),s.top=s.left=0);let k;switch(S<0&&(S-=Math.floor(S/4)*4),S=S%4,S){case 1:k=s.height/2+s.top,v.unshift("rotate(90 "+k.toString()+" "+k.toString()+")");break;case 2:v.unshift("rotate(180 "+(s.width/2+s.left).toString()+" "+(s.height/2+s.top).toString()+")");break;case 3:k=s.width/2+s.left,v.unshift("rotate(-90 "+k.toString()+" "+k.toString()+")");break}S%2===1&&(s.left!==s.top&&(k=s.left,s.left=s.top,s.top=k),s.width!==s.height&&(k=s.width,s.width=s.height,s.height=k)),v.length&&(i=WJe(i,'<g transform="'+v.join(" ")+'">',"</g>"))});const a=r.width,o=r.height,l=s.width,c=s.height;let u,d;a===null?(d=o===null?"1em":o==="auto"?c:o,u=IV(d,l/c)):(u=a==="auto"?l:a,d=o===null?IV(u,c/l):o==="auto"?c:o);const h={},m=(b,v)=>{HJe(v)||(h[b]=v.toString())};m("width",u),m("height",d);const y=[s.left,s.top,l,c];return h.viewBox=y.join(" "),{attributes:h,viewBox:y,body:i}}const KJe=/\sid="(\S+)"/g,YJe="IconifyId"+Date.now().toString(16)+(Math.random()*16777216|0).toString(16);let ZJe=0;function XJe(e,t=YJe){const n=[];let r;for(;r=KJe.exec(e);)n.push(r[1]);if(!n.length)return e;const s="suffix"+(Math.random()*16777216|Date.now()).toString(16);return n.forEach(i=>{const a=typeof t=="function"?t(i):t+(ZJe++).toString(),o=i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");e=e.replace(new RegExp('([#;"])('+o+')([")]|\\.[a-z])',"g"),"$1"+a+s+"$3")}),e=e.replace(new RegExp(s,"g"),""),e}function JJe(e,t){let n=e.indexOf("xlink:")===-1?"":' xmlns:xlink="http://www.w3.org/1999/xlink"';for(const r in t)n+=" "+r+'="'+t[r]+'"';return'<svg xmlns="http://www.w3.org/2000/svg"'+n+">"+e+"</svg>"}var QJe={body:'<g><rect width="80" height="80" style="fill: #087ebf; stroke-width: 0px;"/><text transform="translate(21.16 64.67)" style="fill: #fff; font-family: ArialMT, Arial; font-size: 67.75px;"><tspan x="0" y="0">?</tspan></text></g>',height:80,width:80},cO=new Map,Foe=new Map,eQe=ie(e=>{for(const t of e){if(!t.name)throw new Error('Invalid icon loader. Must have a "name" property with non-empty string value.');if(zt.debug("Registering icon pack:",t.name),"loader"in t)Foe.set(t.name,t.loader);else if("icons"in t)cO.set(t.name,t.icons);else throw zt.error("Invalid icon loader:",t),new Error('Invalid icon loader. Must have either "icons" or "loader" property.')}},"registerIconPacks"),tQe=ie(async(e,t)=>{const n=FJe(e,!0,t!==void 0);if(!n)throw new Error(`Invalid icon name: ${e}`);const r=n.prefix||t;if(!r)throw new Error(`Icon name must contain a prefix: ${e}`);let s=cO.get(r);if(!s){const a=Foe.get(r);if(!a)throw new Error(`Icon set not found: ${n.prefix}`);try{s={...await a(),prefix:r},cO.set(r,s)}catch(o){throw zt.error(o),new Error(`Failed to load icon set: ${n.prefix}`)}}const i=$Je(s,n.name);if(!i)throw new Error(`Icon not found: ${e}`);return i},"getRegisteredIconData"),sA=ie(async(e,t)=>{let n;try{n=await tQe(e,t==null?void 0:t.fallbackPrefix)}catch(i){zt.error(i),n=QJe}const r=GJe(n,t);return JJe(XJe(r.body),r.attributes)},"getIconSVG"),Zv={},$i={},jV;function nQe(){return jV||(jV=1,Object.defineProperty($i,"__esModule",{value:!0}),$i.BLANK_URL=$i.relativeFirstCharacters=$i.whitespaceEscapeCharsRegex=$i.urlSchemeRegex=$i.ctrlCharactersRegex=$i.htmlCtrlEntityRegex=$i.htmlEntitiesRegex=$i.invalidProtocolRegex=void 0,$i.invalidProtocolRegex=/^([^\w]*)(javascript|data|vbscript)/im,$i.htmlEntitiesRegex=/&#(\w+)(^\w|;)?/g,$i.htmlCtrlEntityRegex=/&(newline|tab);/gi,$i.ctrlCharactersRegex=/[\u0000-\u001F\u007F-\u009F\u2000-\u200D\uFEFF]/gim,$i.urlSchemeRegex=/^.+(:|&colon;)/gim,$i.whitespaceEscapeCharsRegex=/(\\|%5[cC])((%(6[eE]|72|74))|[nrt])/g,$i.relativeFirstCharacters=[".","/"],$i.BLANK_URL="about:blank"),$i}var OV;function rQe(){if(OV)return Zv;OV=1,Object.defineProperty(Zv,"__esModule",{value:!0}),Zv.sanitizeUrl=void 0;var e=nQe();function t(a){return e.relativeFirstCharacters.indexOf(a[0])>-1}function n(a){var o=a.replace(e.ctrlCharactersRegex,"");return o.replace(e.htmlEntitiesRegex,function(l,c){return String.fromCharCode(c)})}function r(a){return URL.canParse(a)}function s(a){try{return decodeURIComponent(a)}catch{return a}}function i(a){if(!a)return e.BLANK_URL;var o,l=s(a.trim());do l=n(l).replace(e.htmlCtrlEntityRegex,"").replace(e.ctrlCharactersRegex,"").replace(e.whitespaceEscapeCharsRegex,"").trim(),l=s(l),o=l.match(e.ctrlCharactersRegex)||l.match(e.htmlEntitiesRegex)||l.match(e.htmlCtrlEntityRegex)||l.match(e.whitespaceEscapeCharsRegex);while(o&&o.length>0);var c=l;if(!c)return e.BLANK_URL;if(t(c))return c;var u=c.trimStart(),d=u.match(e.urlSchemeRegex);if(!d)return c;var h=d[0].toLowerCase().trim();if(e.invalidProtocolRegex.test(h))return e.BLANK_URL;var m=u.replace(/\\/g,"/");if(h==="mailto:"||h.includes("://"))return m;if(h==="http:"||h==="https:"){if(!r(m))return e.BLANK_URL;var y=new URL(m);return y.protocol=y.protocol.toLowerCase(),y.hostname=y.hostname.toLowerCase(),y.toString()}return m}return Zv.sanitizeUrl=i,Zv}var sQe=rQe(),iQe={value:()=>{}};function Loe(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new Y2(n)}function Y2(e){this._=e}function aQe(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",s=n.indexOf(".");if(s>=0&&(r=n.slice(s+1),n=n.slice(0,s)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}Y2.prototype=Loe.prototype={constructor:Y2,on:function(e,t){var n=this._,r=aQe(e+"",n),s,i=-1,a=r.length;if(arguments.length<2){for(;++i<a;)if((s=(e=r[i]).type)&&(s=oQe(n[s],e.name)))return s;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++i<a;)if(s=(e=r[i]).type)n[s]=PV(n[s],e.name,t);else if(t==null)for(s in n)n[s]=PV(n[s],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new Y2(e)},call:function(e,t){if((s=arguments.length-2)>0)for(var n=new Array(s),r=0,s,i;r<s;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(i=this._[e],r=0,s=i.length;r<s;++r)i[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],s=0,i=r.length;s<i;++s)r[s].value.apply(t,n)}};function oQe(e,t){for(var n=0,r=e.length,s;n<r;++n)if((s=e[n]).name===t)return s.value}function PV(e,t,n){for(var r=0,s=e.length;r<s;++r)if(e[r].name===t){e[r]=iQe,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var uO="http://www.w3.org/1999/xhtml";const DV={svg:"http://www.w3.org/2000/svg",xhtml:uO,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function iA(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),DV.hasOwnProperty(t)?{space:DV[t],local:e}:e}function lQe(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===uO&&t.documentElement.namespaceURI===uO?t.createElement(e):t.createElementNS(n,e)}}function cQe(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function Boe(e){var t=iA(e);return(t.local?cQe:lQe)(t)}function uQe(){}function AF(e){return e==null?uQe:function(){return this.querySelector(e)}}function dQe(e){typeof e!="function"&&(e=AF(e));for(var t=this._groups,n=t.length,r=new Array(n),s=0;s<n;++s)for(var i=t[s],a=i.length,o=r[s]=new Array(a),l,c,u=0;u<a;++u)(l=i[u])&&(c=e.call(l,l.__data__,u,i))&&("__data__"in l&&(c.__data__=l.__data__),o[u]=c);return new vl(r,this._parents)}function fQe(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function hQe(){return[]}function $oe(e){return e==null?hQe:function(){return this.querySelectorAll(e)}}function pQe(e){return function(){return fQe(e.apply(this,arguments))}}function mQe(e){typeof e=="function"?e=pQe(e):e=$oe(e);for(var t=this._groups,n=t.length,r=[],s=[],i=0;i<n;++i)for(var a=t[i],o=a.length,l,c=0;c<o;++c)(l=a[c])&&(r.push(e.call(l,l.__data__,c,a)),s.push(l));return new vl(r,s)}function zoe(e){return function(){return this.matches(e)}}function Uoe(e){return function(t){return t.matches(e)}}var gQe=Array.prototype.find;function yQe(e){return function(){return gQe.call(this.children,e)}}function bQe(){return this.firstElementChild}function vQe(e){return this.select(e==null?bQe:yQe(typeof e=="function"?e:Uoe(e)))}var xQe=Array.prototype.filter;function wQe(){return Array.from(this.children)}function _Qe(e){return function(){return xQe.call(this.children,e)}}function SQe(e){return this.selectAll(e==null?wQe:_Qe(typeof e=="function"?e:Uoe(e)))}function CQe(e){typeof e!="function"&&(e=zoe(e));for(var t=this._groups,n=t.length,r=new Array(n),s=0;s<n;++s)for(var i=t[s],a=i.length,o=r[s]=[],l,c=0;c<a;++c)(l=i[c])&&e.call(l,l.__data__,c,i)&&o.push(l);return new vl(r,this._parents)}function qoe(e){return new Array(e.length)}function kQe(){return new vl(this._enter||this._groups.map(qoe),this._parents)}function Uk(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}Uk.prototype={constructor:Uk,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function EQe(e){return function(){return e}}function TQe(e,t,n,r,s,i){for(var a=0,o,l=t.length,c=i.length;a<c;++a)(o=t[a])?(o.__data__=i[a],r[a]=o):n[a]=new Uk(e,i[a]);for(;a<l;++a)(o=t[a])&&(s[a]=o)}function AQe(e,t,n,r,s,i,a){var o,l,c=new Map,u=t.length,d=i.length,h=new Array(u),m;for(o=0;o<u;++o)(l=t[o])&&(h[o]=m=a.call(l,l.__data__,o,t)+"",c.has(m)?s[o]=l:c.set(m,l));for(o=0;o<d;++o)m=a.call(e,i[o],o,i)+"",(l=c.get(m))?(r[o]=l,l.__data__=i[o],c.delete(m)):n[o]=new Uk(e,i[o]);for(o=0;o<u;++o)(l=t[o])&&c.get(h[o])===l&&(s[o]=l)}function RQe(e){return e.__data__}function NQe(e,t){if(!arguments.length)return Array.from(this,RQe);var n=t?AQe:TQe,r=this._parents,s=this._groups;typeof e!="function"&&(e=EQe(e));for(var i=s.length,a=new Array(i),o=new Array(i),l=new Array(i),c=0;c<i;++c){var u=r[c],d=s[c],h=d.length,m=MQe(e.call(u,u&&u.__data__,c,r)),y=m.length,b=o[c]=new Array(y),v=a[c]=new Array(y),x=l[c]=new Array(h);n(u,d,b,v,x,m,t);for(var w=0,S=0,k,C;w<y;++w)if(k=b[w]){for(w>=S&&(S=w+1);!(C=v[S])&&++S<y;);k._next=C||null}}return a=new vl(a,r),a._enter=o,a._exit=l,a}function MQe(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function IQe(){return new vl(this._exit||this._groups.map(qoe),this._parents)}function jQe(e,t,n){var r=this.enter(),s=this,i=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),t!=null&&(s=t(s),s&&(s=s.selection())),n==null?i.remove():n(i),r&&s?r.merge(s).order():s}function OQe(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,s=n.length,i=r.length,a=Math.min(s,i),o=new Array(s),l=0;l<a;++l)for(var c=n[l],u=r[l],d=c.length,h=o[l]=new Array(d),m,y=0;y<d;++y)(m=c[y]||u[y])&&(h[y]=m);for(;l<s;++l)o[l]=n[l];return new vl(o,this._parents)}function PQe(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],s=r.length-1,i=r[s],a;--s>=0;)(a=r[s])&&(i&&a.compareDocumentPosition(i)^4&&i.parentNode.insertBefore(a,i),i=a);return this}function DQe(e){e||(e=FQe);function t(d,h){return d&&h?e(d.__data__,h.__data__):!d-!h}for(var n=this._groups,r=n.length,s=new Array(r),i=0;i<r;++i){for(var a=n[i],o=a.length,l=s[i]=new Array(o),c,u=0;u<o;++u)(c=a[u])&&(l[u]=c);l.sort(t)}return new vl(s,this._parents).order()}function FQe(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function LQe(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function BQe(){return Array.from(this)}function $Qe(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],s=0,i=r.length;s<i;++s){var a=r[s];if(a)return a}return null}function zQe(){let e=0;for(const t of this)++e;return e}function UQe(){return!this.node()}function qQe(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var s=t[n],i=0,a=s.length,o;i<a;++i)(o=s[i])&&e.call(o,o.__data__,i,s);return this}function VQe(e){return function(){this.removeAttribute(e)}}function WQe(e){return function(){this.removeAttributeNS(e.space,e.local)}}function HQe(e,t){return function(){this.setAttribute(e,t)}}function GQe(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function KQe(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function YQe(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function ZQe(e,t){var n=iA(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?WQe:VQe:typeof t=="function"?n.local?YQe:KQe:n.local?GQe:HQe)(n,t))}function Voe(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function XQe(e){return function(){this.style.removeProperty(e)}}function JQe(e,t,n){return function(){this.style.setProperty(e,t,n)}}function QQe(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function eet(e,t,n){return arguments.length>1?this.each((t==null?XQe:typeof t=="function"?QQe:JQe)(e,t,n??"")):Py(this.node(),e)}function Py(e,t){return e.style.getPropertyValue(t)||Voe(e).getComputedStyle(e,null).getPropertyValue(t)}function tet(e){return function(){delete this[e]}}function net(e,t){return function(){this[e]=t}}function ret(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function set(e,t){return arguments.length>1?this.each((t==null?tet:typeof t=="function"?ret:net)(e,t)):this.node()[e]}function Woe(e){return e.trim().split(/^|\s+/)}function RF(e){return e.classList||new Hoe(e)}function Hoe(e){this._node=e,this._names=Woe(e.getAttribute("class")||"")}Hoe.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function Goe(e,t){for(var n=RF(e),r=-1,s=t.length;++r<s;)n.add(t[r])}function Koe(e,t){for(var n=RF(e),r=-1,s=t.length;++r<s;)n.remove(t[r])}function iet(e){return function(){Goe(this,e)}}function aet(e){return function(){Koe(this,e)}}function oet(e,t){return function(){(t.apply(this,arguments)?Goe:Koe)(this,e)}}function cet(e,t){var n=Woe(e+"");if(arguments.length<2){for(var r=RF(this.node()),s=-1,i=n.length;++s<i;)if(!r.contains(n[s]))return!1;return!0}return this.each((typeof t=="function"?oet:t?iet:aet)(n,t))}function uet(){this.textContent=""}function det(e){return function(){this.textContent=e}}function fet(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function het(e){return arguments.length?this.each(e==null?uet:(typeof e=="function"?fet:det)(e)):this.node().textContent}function pet(){this.innerHTML=""}function met(e){return function(){this.innerHTML=e}}function get(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function yet(e){return arguments.length?this.each(e==null?pet:(typeof e=="function"?get:met)(e)):this.node().innerHTML}function bet(){this.nextSibling&&this.parentNode.appendChild(this)}function vet(){return this.each(bet)}function xet(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function wet(){return this.each(xet)}function _et(e){var t=typeof e=="function"?e:Boe(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function Cet(){return null}function ket(e,t){var n=typeof e=="function"?e:Boe(e),r=t==null?Cet:typeof t=="function"?t:AF(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function Eet(){var e=this.parentNode;e&&e.removeChild(this)}function Tet(){return this.each(Eet)}function Aet(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Ret(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Net(e){return this.select(e?Ret:Aet)}function Met(e){return arguments.length?this.property("__data__",e):this.node().__data__}function Iet(e){return function(t){e.call(this,t,this.__data__)}}function jet(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function Oet(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,s=t.length,i;n<s;++n)i=t[n],(!e.type||i.type===e.type)&&i.name===e.name?this.removeEventListener(i.type,i.listener,i.options):t[++r]=i;++r?t.length=r:delete this.__on}}}function Pet(e,t,n){return function(){var r=this.__on,s,i=Iet(t);if(r){for(var a=0,o=r.length;a<o;++a)if((s=r[a]).type===e.type&&s.name===e.name){this.removeEventListener(s.type,s.listener,s.options),this.addEventListener(s.type,s.listener=i,s.options=n),s.value=t;return}}this.addEventListener(e.type,i,n),s={type:e.type,name:e.name,value:t,listener:i,options:n},r?r.push(s):this.__on=[s]}}function Det(e,t,n){var r=jet(e+""),s,i=r.length,a;if(arguments.length<2){var o=this.node().__on;if(o){for(var l=0,c=o.length,u;l<c;++l)for(s=0,u=o[l];s<i;++s)if((a=r[s]).type===u.type&&a.name===u.name)return u.value}return}for(o=t?Pet:Oet,s=0;s<i;++s)this.each(o(r[s],t,n));return this}function Yoe(e,t,n){var r=Voe(e),s=r.CustomEvent;typeof s=="function"?s=new s(t,n):(s=r.document.createEvent("Event"),n?(s.initEvent(t,n.bubbles,n.cancelable),s.detail=n.detail):s.initEvent(t,!1,!1)),e.dispatchEvent(s)}function Fet(e,t){return function(){return Yoe(this,e,t)}}function Let(e,t){return function(){return Yoe(this,e,t.apply(this,arguments))}}function Bet(e,t){return this.each((typeof t=="function"?Let:Fet)(e,t))}function*$et(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],s=0,i=r.length,a;s<i;++s)(a=r[s])&&(yield a)}var Zoe=[null];function vl(e,t){this._groups=e,this._parents=t}function f_(){return new vl([[document.documentElement]],Zoe)}function zet(){return this}vl.prototype=f_.prototype={constructor:vl,select:dQe,selectAll:mQe,selectChild:vQe,selectChildren:SQe,filter:CQe,data:NQe,enter:kQe,exit:IQe,join:jQe,merge:OQe,selection:zet,order:PQe,sort:DQe,call:LQe,nodes:BQe,node:$Qe,size:zQe,empty:UQe,each:qQe,attr:ZQe,style:eet,property:set,classed:cet,text:het,html:yet,raise:vet,lower:wet,append:_et,insert:ket,remove:Tet,clone:Net,datum:Met,on:Det,dispatch:Bet,[Symbol.iterator]:$et};function Kr(e){return typeof e=="string"?new vl([[document.querySelector(e)]],[document.documentElement]):new vl([[e]],Zoe)}function NF(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function Xoe(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function h_(){}var a1=.7,qk=1/a1,z0="\\s*([+-]?\\d+)\\s*",o1="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Nu="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Uet=/^#([0-9a-f]{3,8})$/,qet=new RegExp(`^rgb\\(${z0},${z0},${z0}\\)$`),Vet=new RegExp(`^rgb\\(${Nu},${Nu},${Nu}\\)$`),Wet=new RegExp(`^rgba\\(${z0},${z0},${z0},${o1}\\)$`),Het=new RegExp(`^rgba\\(${Nu},${Nu},${Nu},${o1}\\)$`),Get=new RegExp(`^hsl\\(${o1},${Nu},${Nu}\\)$`),Ket=new RegExp(`^hsla\\(${o1},${Nu},${Nu},${o1}\\)$`),FV={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};NF(h_,l1,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:LV,formatHex:LV,formatHex8:Yet,formatHsl:Zet,formatRgb:BV,toString:BV});function LV(){return this.rgb().formatHex()}function Yet(){return this.rgb().formatHex8()}function Zet(){return Joe(this).formatHsl()}function BV(){return this.rgb().formatRgb()}function l1(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=Uet.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?$V(t):n===3?new No(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?b2(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?b2(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=qet.exec(e))?new No(t[1],t[2],t[3],1):(t=Vet.exec(e))?new No(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=Wet.exec(e))?b2(t[1],t[2],t[3],t[4]):(t=Het.exec(e))?b2(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=Get.exec(e))?qV(t[1],t[2]/100,t[3]/100,1):(t=Ket.exec(e))?qV(t[1],t[2]/100,t[3]/100,t[4]):FV.hasOwnProperty(e)?$V(FV[e]):e==="transparent"?new No(NaN,NaN,NaN,0):null}function $V(e){return new No(e>>16&255,e>>8&255,e&255,1)}function b2(e,t,n,r){return r<=0&&(e=t=n=NaN),new No(e,t,n,r)}function Xet(e){return e instanceof h_||(e=l1(e)),e?(e=e.rgb(),new No(e.r,e.g,e.b,e.opacity)):new No}function dO(e,t,n,r){return arguments.length===1?Xet(e):new No(e,t,n,r??1)}function No(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}NF(No,dO,Xoe(h_,{brighter(e){return e=e==null?qk:Math.pow(qk,e),new No(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?a1:Math.pow(a1,e),new No(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new No(ym(this.r),ym(this.g),ym(this.b),Vk(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:zV,formatHex:zV,formatHex8:Jet,formatRgb:UV,toString:UV}));function zV(){return`#${um(this.r)}${um(this.g)}${um(this.b)}`}function Jet(){return`#${um(this.r)}${um(this.g)}${um(this.b)}${um((isNaN(this.opacity)?1:this.opacity)*255)}`}function UV(){const e=Vk(this.opacity);return`${e===1?"rgb(":"rgba("}${ym(this.r)}, ${ym(this.g)}, ${ym(this.b)}${e===1?")":`, ${e})`}`}function Vk(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function ym(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function um(e){return e=ym(e),(e<16?"0":"")+e.toString(16)}function qV(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new wc(e,t,n,r)}function Joe(e){if(e instanceof wc)return new wc(e.h,e.s,e.l,e.opacity);if(e instanceof h_||(e=l1(e)),!e)return new wc;if(e instanceof wc)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,s=Math.min(t,n,r),i=Math.max(t,n,r),a=NaN,o=i-s,l=(i+s)/2;return o?(t===i?a=(n-r)/o+(n<r)*6:n===i?a=(r-t)/o+2:a=(t-n)/o+4,o/=l<.5?i+s:2-i-s,a*=60):o=l>0&&l<1?0:a,new wc(a,o,l,e.opacity)}function Qet(e,t,n,r){return arguments.length===1?Joe(e):new wc(e,t,n,r??1)}function wc(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}NF(wc,Qet,Xoe(h_,{brighter(e){return e=e==null?qk:Math.pow(qk,e),new wc(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?a1:Math.pow(a1,e),new wc(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,s=2*n-r;return new No(M3(e>=240?e-240:e+120,s,r),M3(e,s,r),M3(e<120?e+240:e-120,s,r),this.opacity)},clamp(){return new wc(VV(this.h),v2(this.s),v2(this.l),Vk(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Vk(this.opacity);return`${e===1?"hsl(":"hsla("}${VV(this.h)}, ${v2(this.s)*100}%, ${v2(this.l)*100}%${e===1?")":`, ${e})`}`}}));function VV(e){return e=(e||0)%360,e<0?e+360:e}function v2(e){return Math.max(0,Math.min(1,e||0))}function M3(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const MF=e=>()=>e;function Qoe(e,t){return function(n){return e+n*t}}function ett(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function Ddt(e,t){var n=t-e;return n?Qoe(e,n>180||n<-180?n-360*Math.round(n/360):n):MF(isNaN(e)?t:e)}function ttt(e){return(e=+e)==1?ele:function(t,n){return n-t?ett(t,n,e):MF(isNaN(t)?n:t)}}function ele(e,t){var n=t-e;return n?Qoe(e,n):MF(isNaN(e)?t:e)}const WV=function e(t){var n=ttt(t);function r(s,i){var a=n((s=dO(s)).r,(i=dO(i)).r),o=n(s.g,i.g),l=n(s.b,i.b),c=ele(s.opacity,i.opacity);return function(u){return s.r=a(u),s.g=o(u),s.b=l(u),s.opacity=c(u),s+""}}return r.gamma=e,r}(1);function lh(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var fO=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,I3=new RegExp(fO.source,"g");function ntt(e){return function(){return e}}function rtt(e){return function(t){return e(t)+""}}function stt(e,t){var n=fO.lastIndex=I3.lastIndex=0,r,s,i,a=-1,o=[],l=[];for(e=e+"",t=t+"";(r=fO.exec(e))&&(s=I3.exec(t));)(i=s.index)>n&&(i=t.slice(n,i),o[a]?o[a]+=i:o[++a]=i),(r=r[0])===(s=s[0])?o[a]?o[a]+=s:o[++a]=s:(o[++a]=null,l.push({i:a,x:lh(r,s)})),n=I3.lastIndex;return n<t.length&&(i=t.slice(n),o[a]?o[a]+=i:o[++a]=i),o.length<2?l[0]?rtt(l[0].x):ntt(t):(t=l.length,function(c){for(var u=0,d;u<t;++u)o[(d=l[u]).i]=d.x(c);return o.join("")})}var HV=180/Math.PI,hO={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function tle(e,t,n,r,s,i){var a,o,l;return(a=Math.sqrt(e*e+t*t))&&(e/=a,t/=a),(l=e*n+t*r)&&(n-=e*l,r-=t*l),(o=Math.sqrt(n*n+r*r))&&(n/=o,r/=o,l/=o),e*r<t*n&&(e=-e,t=-t,l=-l,a=-a),{translateX:s,translateY:i,rotate:Math.atan2(t,e)*HV,skewX:Math.atan(l)*HV,scaleX:a,scaleY:o}}var x2;function itt(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?hO:tle(t.a,t.b,t.c,t.d,t.e,t.f)}function att(e){return e==null||(x2||(x2=document.createElementNS("http://www.w3.org/2000/svg","g")),x2.setAttribute("transform",e),!(e=x2.transform.baseVal.consolidate()))?hO:(e=e.matrix,tle(e.a,e.b,e.c,e.d,e.e,e.f))}function nle(e,t,n,r){function s(c){return c.length?c.pop()+" ":""}function i(c,u,d,h,m,y){if(c!==d||u!==h){var b=m.push("translate(",null,t,null,n);y.push({i:b-4,x:lh(c,d)},{i:b-2,x:lh(u,h)})}else(d||h)&&m.push("translate("+d+t+h+n)}function a(c,u,d,h){c!==u?(c-u>180?u+=360:u-c>180&&(c+=360),h.push({i:d.push(s(d)+"rotate(",null,r)-2,x:lh(c,u)})):u&&d.push(s(d)+"rotate("+u+r)}function o(c,u,d,h){c!==u?h.push({i:d.push(s(d)+"skewX(",null,r)-2,x:lh(c,u)}):u&&d.push(s(d)+"skewX("+u+r)}function l(c,u,d,h,m,y){if(c!==d||u!==h){var b=m.push(s(m)+"scale(",null,",",null,")");y.push({i:b-4,x:lh(c,d)},{i:b-2,x:lh(u,h)})}else(d!==1||h!==1)&&m.push(s(m)+"scale("+d+","+h+")")}return function(c,u){var d=[],h=[];return c=e(c),u=e(u),i(c.translateX,c.translateY,u.translateX,u.translateY,d,h),a(c.rotate,u.rotate,d,h),o(c.skewX,u.skewX,d,h),l(c.scaleX,c.scaleY,u.scaleX,u.scaleY,d,h),c=u=null,function(m){for(var y=-1,b=h.length,v;++y<b;)d[(v=h[y]).i]=v.x(m);return d.join("")}}}var ott=nle(itt,"px, ","px)","deg)"),ltt=nle(att,", ",")",")"),Dy=0,xx=0,Xv=0,rle=1e3,Wk,wx,Hk=0,Fm=0,aA=0,c1=typeof performance=="object"&&performance.now?performance:Date,sle=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function IF(){return Fm||(sle(ctt),Fm=c1.now()+aA)}function ctt(){Fm=0}function Gk(){this._call=this._time=this._next=null}Gk.prototype=ile.prototype={constructor:Gk,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?IF():+n)+(t==null?0:+t),!this._next&&wx!==this&&(wx?wx._next=this:Wk=this,wx=this),this._call=e,this._time=n,pO()},stop:function(){this._call&&(this._call=null,this._time=1/0,pO())}};function ile(e,t,n){var r=new Gk;return r.restart(e,t,n),r}function utt(){IF(),++Dy;for(var e=Wk,t;e;)(t=Fm-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Dy}function GV(){Fm=(Hk=c1.now())+aA,Dy=xx=0;try{utt()}finally{Dy=0,ftt(),Fm=0}}function dtt(){var e=c1.now(),t=e-Hk;t>rle&&(aA-=t,Hk=e)}function ftt(){for(var e,t=Wk,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:Wk=n);wx=e,pO(r)}function pO(e){if(!Dy){xx&&(xx=clearTimeout(xx));var t=e-Fm;t>24?(e<1/0&&(xx=setTimeout(GV,e-c1.now()-aA)),Xv&&(Xv=clearInterval(Xv))):(Xv||(Hk=c1.now(),Xv=setInterval(dtt,rle)),Dy=1,sle(GV))}}function KV(e,t,n){var r=new Gk;return t=t==null?0:+t,r.restart(s=>{r.stop(),e(s+t)},t,n),r}var htt=Loe("start","end","cancel","interrupt"),ptt=[],ale=0,YV=1,mO=2,Z2=3,ZV=4,gO=5,X2=6;function oA(e,t,n,r,s,i){var a=e.__transition;if(!a)e.__transition={};else if(n in a)return;mtt(e,n,{name:t,index:r,group:s,on:htt,tween:ptt,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:ale})}function jF(e,t){var n=Hc(e,t);if(n.state>ale)throw new Error("too late; already scheduled");return n}function Hu(e,t){var n=Hc(e,t);if(n.state>Z2)throw new Error("too late; already running");return n}function Hc(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function mtt(e,t,n){var r=e.__transition,s;r[t]=n,n.timer=ile(i,0,n.time);function i(c){n.state=YV,n.timer.restart(a,n.delay,n.time),n.delay<=c&&a(c-n.delay)}function a(c){var u,d,h,m;if(n.state!==YV)return l();for(u in r)if(m=r[u],m.name===n.name){if(m.state===Z2)return KV(a);m.state===ZV?(m.state=X2,m.timer.stop(),m.on.call("interrupt",e,e.__data__,m.index,m.group),delete r[u]):+u<t&&(m.state=X2,m.timer.stop(),m.on.call("cancel",e,e.__data__,m.index,m.group),delete r[u])}if(KV(function(){n.state===Z2&&(n.state=ZV,n.timer.restart(o,n.delay,n.time),o(c))}),n.state=mO,n.on.call("start",e,e.__data__,n.index,n.group),n.state===mO){for(n.state=Z2,s=new Array(h=n.tween.length),u=0,d=-1;u<h;++u)(m=n.tween[u].value.call(e,e.__data__,n.index,n.group))&&(s[++d]=m);s.length=d+1}}function o(c){for(var u=c<n.duration?n.ease.call(null,c/n.duration):(n.timer.restart(l),n.state=gO,1),d=-1,h=s.length;++d<h;)s[d].call(e,u);n.state===gO&&(n.on.call("end",e,e.__data__,n.index,n.group),l())}function l(){n.state=X2,n.timer.stop(),delete r[t];for(var c in r)return;delete e.__transition}}function gtt(e,t){var n=e.__transition,r,s,i=!0,a;if(n){t=t==null?null:t+"";for(a in n){if((r=n[a]).name!==t){i=!1;continue}s=r.state>mO&&r.state<gO,r.state=X2,r.timer.stop(),r.on.call(s?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[a]}i&&delete e.__transition}}function ytt(e){return this.each(function(){gtt(this,e)})}function btt(e,t){var n,r;return function(){var s=Hu(this,e),i=s.tween;if(i!==n){r=n=i;for(var a=0,o=r.length;a<o;++a)if(r[a].name===t){r=r.slice(),r.splice(a,1);break}}s.tween=r}}function vtt(e,t,n){var r,s;if(typeof n!="function")throw new Error;return function(){var i=Hu(this,e),a=i.tween;if(a!==r){s=(r=a).slice();for(var o={name:t,value:n},l=0,c=s.length;l<c;++l)if(s[l].name===t){s[l]=o;break}l===c&&s.push(o)}i.tween=s}}function xtt(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=Hc(this.node(),n).tween,s=0,i=r.length,a;s<i;++s)if((a=r[s]).name===e)return a.value;return null}return this.each((t==null?btt:vtt)(n,e,t))}function OF(e,t,n){var r=e._id;return e.each(function(){var s=Hu(this,r);(s.value||(s.value={}))[t]=n.apply(this,arguments)}),function(s){return Hc(s,r).value[t]}}function ole(e,t){var n;return(typeof t=="number"?lh:t instanceof l1?WV:(n=l1(t))?(t=n,WV):stt)(e,t)}function wtt(e){return function(){this.removeAttribute(e)}}function _tt(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Stt(e,t,n){var r,s=n+"",i;return function(){var a=this.getAttribute(e);return a===s?null:a===r?i:i=t(r=a,n)}}function Ctt(e,t,n){var r,s=n+"",i;return function(){var a=this.getAttributeNS(e.space,e.local);return a===s?null:a===r?i:i=t(r=a,n)}}function ktt(e,t,n){var r,s,i;return function(){var a,o=n(this),l;return o==null?void this.removeAttribute(e):(a=this.getAttribute(e),l=o+"",a===l?null:a===r&&l===s?i:(s=l,i=t(r=a,o)))}}function Ett(e,t,n){var r,s,i;return function(){var a,o=n(this),l;return o==null?void this.removeAttributeNS(e.space,e.local):(a=this.getAttributeNS(e.space,e.local),l=o+"",a===l?null:a===r&&l===s?i:(s=l,i=t(r=a,o)))}}function Ttt(e,t){var n=iA(e),r=n==="transform"?ltt:ole;return this.attrTween(e,typeof t=="function"?(n.local?Ett:ktt)(n,r,OF(this,"attr."+e,t)):t==null?(n.local?_tt:wtt)(n):(n.local?Ctt:Stt)(n,r,t))}function Att(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function Rtt(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function Ntt(e,t){var n,r;function s(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&Rtt(e,i)),n}return s._value=t,s}function Mtt(e,t){var n,r;function s(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&Att(e,i)),n}return s._value=t,s}function Itt(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=iA(e);return this.tween(n,(r.local?Ntt:Mtt)(r,t))}function jtt(e,t){return function(){jF(this,e).delay=+t.apply(this,arguments)}}function Ott(e,t){return t=+t,function(){jF(this,e).delay=t}}function Ptt(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?jtt:Ott)(t,e)):Hc(this.node(),t).delay}function Dtt(e,t){return function(){Hu(this,e).duration=+t.apply(this,arguments)}}function Ftt(e,t){return t=+t,function(){Hu(this,e).duration=t}}function Ltt(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Dtt:Ftt)(t,e)):Hc(this.node(),t).duration}function Btt(e,t){if(typeof t!="function")throw new Error;return function(){Hu(this,e).ease=t}}function $tt(e){var t=this._id;return arguments.length?this.each(Btt(t,e)):Hc(this.node(),t).ease}function ztt(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;Hu(this,e).ease=n}}function Utt(e){if(typeof e!="function")throw new Error;return this.each(ztt(this._id,e))}function qtt(e){typeof e!="function"&&(e=zoe(e));for(var t=this._groups,n=t.length,r=new Array(n),s=0;s<n;++s)for(var i=t[s],a=i.length,o=r[s]=[],l,c=0;c<a;++c)(l=i[c])&&e.call(l,l.__data__,c,i)&&o.push(l);return new ef(r,this._parents,this._name,this._id)}function Vtt(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,s=n.length,i=Math.min(r,s),a=new Array(r),o=0;o<i;++o)for(var l=t[o],c=n[o],u=l.length,d=a[o]=new Array(u),h,m=0;m<u;++m)(h=l[m]||c[m])&&(d[m]=h);for(;o<r;++o)a[o]=t[o];return new ef(a,this._parents,this._name,this._id)}function Wtt(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function Htt(e,t,n){var r,s,i=Wtt(t)?jF:Hu;return function(){var a=i(this,e),o=a.on;o!==r&&(s=(r=o).copy()).on(t,n),a.on=s}}function Gtt(e,t){var n=this._id;return arguments.length<2?Hc(this.node(),n).on.on(e):this.each(Htt(n,e,t))}function Ktt(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function Ytt(){return this.on("end.remove",Ktt(this._id))}function Ztt(e){var t=this._name,n=this._id;typeof e!="function"&&(e=AF(e));for(var r=this._groups,s=r.length,i=new Array(s),a=0;a<s;++a)for(var o=r[a],l=o.length,c=i[a]=new Array(l),u,d,h=0;h<l;++h)(u=o[h])&&(d=e.call(u,u.__data__,h,o))&&("__data__"in u&&(d.__data__=u.__data__),c[h]=d,oA(c[h],t,n,h,c,Hc(u,n)));return new ef(i,this._parents,t,n)}function Xtt(e){var t=this._name,n=this._id;typeof e!="function"&&(e=$oe(e));for(var r=this._groups,s=r.length,i=[],a=[],o=0;o<s;++o)for(var l=r[o],c=l.length,u,d=0;d<c;++d)if(u=l[d]){for(var h=e.call(u,u.__data__,d,l),m,y=Hc(u,n),b=0,v=h.length;b<v;++b)(m=h[b])&&oA(m,t,n,b,h,y);i.push(h),a.push(u)}return new ef(i,a,t,n)}var Jtt=f_.prototype.constructor;function Qtt(){return new Jtt(this._groups,this._parents)}function ent(e,t){var n,r,s;return function(){var i=Py(this,e),a=(this.style.removeProperty(e),Py(this,e));return i===a?null:i===n&&a===r?s:s=t(n=i,r=a)}}function lle(e){return function(){this.style.removeProperty(e)}}function tnt(e,t,n){var r,s=n+"",i;return function(){var a=Py(this,e);return a===s?null:a===r?i:i=t(r=a,n)}}function nnt(e,t,n){var r,s,i;return function(){var a=Py(this,e),o=n(this),l=o+"";return o==null&&(l=o=(this.style.removeProperty(e),Py(this,e))),a===l?null:a===r&&l===s?i:(s=l,i=t(r=a,o))}}function rnt(e,t){var n,r,s,i="style."+t,a="end."+i,o;return function(){var l=Hu(this,e),c=l.on,u=l.value[i]==null?o||(o=lle(t)):void 0;(c!==n||s!==u)&&(r=(n=c).copy()).on(a,s=u),l.on=r}}function snt(e,t,n){var r=(e+="")=="transform"?ott:ole;return t==null?this.styleTween(e,ent(e,r)).on("end.style."+e,lle(e)):typeof t=="function"?this.styleTween(e,nnt(e,r,OF(this,"style."+e,t))).each(rnt(this._id,e)):this.styleTween(e,tnt(e,r,t),n).on("end.style."+e,null)}function int(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function ant(e,t,n){var r,s;function i(){var a=t.apply(this,arguments);return a!==s&&(r=(s=a)&&int(e,a,n)),r}return i._value=t,i}function ont(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,ant(e,t,n??""))}function lnt(e){return function(){this.textContent=e}}function cnt(e){return function(){var t=e(this);this.textContent=t??""}}function unt(e){return this.tween("text",typeof e=="function"?cnt(OF(this,"text",e)):lnt(e==null?"":e+""))}function dnt(e){return function(t){this.textContent=e.call(this,t)}}function fnt(e){var t,n;function r(){var s=e.apply(this,arguments);return s!==n&&(t=(n=s)&&dnt(s)),t}return r._value=e,r}function hnt(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,fnt(e))}function pnt(){for(var e=this._name,t=this._id,n=cle(),r=this._groups,s=r.length,i=0;i<s;++i)for(var a=r[i],o=a.length,l,c=0;c<o;++c)if(l=a[c]){var u=Hc(l,t);oA(l,e,n,c,a,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new ef(r,this._parents,e,n)}function mnt(){var e,t,n=this,r=n._id,s=n.size();return new Promise(function(i,a){var o={value:a},l={value:function(){--s===0&&i()}};n.each(function(){var c=Hu(this,r),u=c.on;u!==e&&(t=(e=u).copy(),t._.cancel.push(o),t._.interrupt.push(o),t._.end.push(l)),c.on=t}),s===0&&i()})}var gnt=0;function ef(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function cle(){return++gnt}var wd=f_.prototype;ef.prototype={constructor:ef,select:Ztt,selectAll:Xtt,selectChild:wd.selectChild,selectChildren:wd.selectChildren,filter:qtt,merge:Vtt,selection:Qtt,transition:pnt,call:wd.call,nodes:wd.nodes,node:wd.node,size:wd.size,empty:wd.empty,each:wd.each,on:Gtt,attr:Ttt,attrTween:Itt,style:snt,styleTween:ont,text:unt,textTween:hnt,remove:Ytt,tween:xtt,delay:Ptt,duration:Ltt,ease:$tt,easeVarying:Utt,end:mnt,[Symbol.iterator]:wd[Symbol.iterator]};function ynt(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var bnt={time:null,delay:0,duration:250,ease:ynt};function vnt(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function xnt(e){var t,n;e instanceof ef?(t=e._id,e=e._name):(t=cle(),(n=bnt).time=IF(),e=e==null?null:e+"");for(var r=this._groups,s=r.length,i=0;i<s;++i)for(var a=r[i],o=a.length,l,c=0;c<o;++c)(l=a[c])&&oA(l,e,t,c,a,n||vnt(l,t));return new ef(r,this._parents,e,t)}f_.prototype.interrupt=ytt;f_.prototype.transition=xnt;const yO=Math.PI,bO=2*yO,Gp=1e-6,wnt=bO-Gp;function ule(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function _nt(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return ule;const n=10**t;return function(r){this._+=r[0];for(let s=1,i=r.length;s<i;++s)this._+=Math.round(arguments[s]*n)/n+r[s]}}class Snt{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?ule:_nt(t)}moveTo(t,n){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,n){this._append`L${this._x1=+t},${this._y1=+n}`}quadraticCurveTo(t,n,r,s){this._append`Q${+t},${+n},${this._x1=+r},${this._y1=+s}`}bezierCurveTo(t,n,r,s,i,a){this._append`C${+t},${+n},${+r},${+s},${this._x1=+i},${this._y1=+a}`}arcTo(t,n,r,s,i){if(t=+t,n=+n,r=+r,s=+s,i=+i,i<0)throw new Error(`negative radius: ${i}`);let a=this._x1,o=this._y1,l=r-t,c=s-n,u=a-t,d=o-n,h=u*u+d*d;if(this._x1===null)this._append`M${this._x1=t},${this._y1=n}`;else if(h>Gp)if(!(Math.abs(d*l-c*u)>Gp)||!i)this._append`L${this._x1=t},${this._y1=n}`;else{let m=r-a,y=s-o,b=l*l+c*c,v=m*m+y*y,x=Math.sqrt(b),w=Math.sqrt(h),S=i*Math.tan((yO-Math.acos((b+h-v)/(2*x*w)))/2),k=S/w,C=S/x;Math.abs(k-1)>Gp&&this._append`L${t+k*u},${n+k*d}`,this._append`A${i},${i},0,0,${+(d*m>u*y)},${this._x1=t+C*l},${this._y1=n+C*c}`}}arc(t,n,r,s,i,a){if(t=+t,n=+n,r=+r,a=!!a,r<0)throw new Error(`negative radius: ${r}`);let o=r*Math.cos(s),l=r*Math.sin(s),c=t+o,u=n+l,d=1^a,h=a?s-i:i-s;this._x1===null?this._append`M${c},${u}`:(Math.abs(this._x1-c)>Gp||Math.abs(this._y1-u)>Gp)&&this._append`L${c},${u}`,r&&(h<0&&(h=h%bO+bO),h>wnt?this._append`A${r},${r},0,1,${d},${t-o},${n-l}A${r},${r},0,1,${d},${this._x1=c},${this._y1=u}`:h>Gp&&this._append`A${r},${r},0,${+(h>=yO)},${d},${this._x1=t+r*Math.cos(i)},${this._y1=n+r*Math.sin(i)}`)}rect(t,n,r,s){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${r=+r}v${+s}h${-r}Z`}toString(){return this._}}function c0(e){return function(){return e}}const Fdt=Math.abs,Ldt=Math.atan2,Bdt=Math.cos,$dt=Math.max,zdt=Math.min,Udt=Math.sin,qdt=Math.sqrt,XV=1e-12,PF=Math.PI,JV=PF/2,Vdt=2*PF;function Wdt(e){return e>1?0:e<-1?PF:Math.acos(e)}function Hdt(e){return e>=1?JV:e<=-1?-JV:Math.asin(e)}function Cnt(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(n==null)t=null;else{const r=Math.floor(n);if(!(r>=0))throw new RangeError(`invalid digits: ${n}`);t=r}return e},()=>new Snt(t)}function knt(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function dle(e){this._context=e}dle.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function Kk(e){return new dle(e)}function Ent(e){return e[0]}function Tnt(e){return e[1]}function Ant(e,t){var n=c0(!0),r=null,s=Kk,i=null,a=Cnt(o);e=typeof e=="function"?e:e===void 0?Ent:c0(e),t=typeof t=="function"?t:t===void 0?Tnt:c0(t);function o(l){var c,u=(l=knt(l)).length,d,h=!1,m;for(r==null&&(i=s(m=a())),c=0;c<=u;++c)!(c<u&&n(d=l[c],c,l))===h&&((h=!h)?i.lineStart():i.lineEnd()),h&&i.point(+e(d,c,l),+t(d,c,l));if(m)return i=null,m+""||null}return o.x=function(l){return arguments.length?(e=typeof l=="function"?l:c0(+l),o):e},o.y=function(l){return arguments.length?(t=typeof l=="function"?l:c0(+l),o):t},o.defined=function(l){return arguments.length?(n=typeof l=="function"?l:c0(!!l),o):n},o.curve=function(l){return arguments.length?(s=l,r!=null&&(i=s(r)),o):s},o.context=function(l){return arguments.length?(l==null?r=i=null:i=s(r=l),o):r},o}class fle{constructor(t,n){this._context=t,this._x=n}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,n){switch(t=+t,n=+n,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,n,t,n):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+n)/2,t,this._y0,t,n);break}}this._x0=t,this._y0=n}}function hle(e){return new fle(e,!0)}function ple(e){return new fle(e,!1)}function Dh(){}function Yk(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function lA(e){this._context=e}lA.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Yk(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Yk(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function J2(e){return new lA(e)}function mle(e){this._context=e}mle.prototype={areaStart:Dh,areaEnd:Dh,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:Yk(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Rnt(e){return new mle(e)}function gle(e){this._context=e}gle.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:Yk(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Nnt(e){return new gle(e)}function yle(e,t){this._basis=new lA(e),this._beta=t}yle.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var r=e[0],s=t[0],i=e[n]-r,a=t[n]-s,o=-1,l;++o<=n;)l=o/n,this._basis.point(this._beta*e[o]+(1-this._beta)*(r+l*i),this._beta*t[o]+(1-this._beta)*(s+l*a));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};const Mnt=function e(t){function n(r){return t===1?new lA(r):new yle(r,t)}return n.beta=function(r){return e(+r)},n}(.85);function Zk(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function DF(e,t){this._context=e,this._k=(1-t)/6}DF.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:Zk(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:Zk(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const ble=function e(t){function n(r){return new DF(r,t)}return n.tension=function(r){return e(+r)},n}(0);function FF(e,t){this._context=e,this._k=(1-t)/6}FF.prototype={areaStart:Dh,areaEnd:Dh,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:Zk(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const Int=function e(t){function n(r){return new FF(r,t)}return n.tension=function(r){return e(+r)},n}(0);function LF(e,t){this._context=e,this._k=(1-t)/6}LF.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Zk(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const jnt=function e(t){function n(r){return new LF(r,t)}return n.tension=function(r){return e(+r)},n}(0);function BF(e,t,n){var r=e._x1,s=e._y1,i=e._x2,a=e._y2;if(e._l01_a>XV){var o=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,l=3*e._l01_a*(e._l01_a+e._l12_a);r=(r*o-e._x0*e._l12_2a+e._x2*e._l01_2a)/l,s=(s*o-e._y0*e._l12_2a+e._y2*e._l01_2a)/l}if(e._l23_a>XV){var c=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,u=3*e._l23_a*(e._l23_a+e._l12_a);i=(i*c+e._x1*e._l23_2a-t*e._l12_2a)/u,a=(a*c+e._y1*e._l23_2a-n*e._l12_2a)/u}e._context.bezierCurveTo(r,s,i,a,e._x2,e._y2)}function vle(e,t){this._context=e,this._alpha=t}vle.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:BF(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const xle=function e(t){function n(r){return t?new vle(r,t):new DF(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function wle(e,t){this._context=e,this._alpha=t}wle.prototype={areaStart:Dh,areaEnd:Dh,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:BF(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const Ont=function e(t){function n(r){return t?new wle(r,t):new FF(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function _le(e,t){this._context=e,this._alpha=t}_le.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:BF(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const Pnt=function e(t){function n(r){return t?new _le(r,t):new LF(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function Sle(e){this._context=e}Sle.prototype={areaStart:Dh,areaEnd:Dh,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function Dnt(e){return new Sle(e)}function QV(e){return e<0?-1:1}function eW(e,t,n){var r=e._x1-e._x0,s=t-e._x1,i=(e._y1-e._y0)/(r||s<0&&-0),a=(n-e._y1)/(s||r<0&&-0),o=(i*s+a*r)/(r+s);return(QV(i)+QV(a))*Math.min(Math.abs(i),Math.abs(a),.5*Math.abs(o))||0}function tW(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function j3(e,t,n){var r=e._x0,s=e._y0,i=e._x1,a=e._y1,o=(i-r)/3;e._context.bezierCurveTo(r+o,s+o*t,i-o,a-o*n,i,a)}function Xk(e){this._context=e}Xk.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:j3(this,this._t0,tW(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,j3(this,tW(this,n=eW(this,e,t)),n);break;default:j3(this,this._t0,n=eW(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function Cle(e){this._context=new kle(e)}(Cle.prototype=Object.create(Xk.prototype)).point=function(e,t){Xk.prototype.point.call(this,t,e)};function kle(e){this._context=e}kle.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,s,i){this._context.bezierCurveTo(t,e,r,n,i,s)}};function Ele(e){return new Xk(e)}function Tle(e){return new Cle(e)}function Ale(e){this._context=e}Ale.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var r=nW(e),s=nW(t),i=0,a=1;a<n;++i,++a)this._context.bezierCurveTo(r[0][i],s[0][i],r[1][i],s[1][i],e[a],t[a]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function nW(e){var t,n=e.length-1,r,s=new Array(n),i=new Array(n),a=new Array(n);for(s[0]=0,i[0]=2,a[0]=e[0]+2*e[1],t=1;t<n-1;++t)s[t]=1,i[t]=4,a[t]=4*e[t]+2*e[t+1];for(s[n-1]=2,i[n-1]=7,a[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)r=s[t]/i[t-1],i[t]-=r,a[t]-=r*a[t-1];for(s[n-1]=a[n-1]/i[n-1],t=n-2;t>=0;--t)s[t]=(a[t]-s[t+1])/i[t];for(i[n-1]=(e[n]+s[n-1])/2,t=0;t<n-1;++t)i[t]=2*e[t+1]-s[t+1];return[s,i]}function Rle(e){return new Ale(e)}function cA(e,t){this._context=e,this._t=t}cA.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function Nle(e){return new cA(e,.5)}function Mle(e){return new cA(e,0)}function Ile(e){return new cA(e,1)}function _x(e,t,n){this.k=e,this.x=t,this.y=n}_x.prototype={constructor:_x,scale:function(e){return e===1?this:new _x(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new _x(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};_x.prototype;var jle=typeof x0=="object"&&x0&&x0.Object===Object&&x0,Fnt=typeof self=="object"&&self&&self.Object===Object&&self,Gu=jle||Fnt||Function("return this")(),Jk=Gu.Symbol,Ole=Object.prototype,Lnt=Ole.hasOwnProperty,Bnt=Ole.toString,Jv=Jk?Jk.toStringTag:void 0;function $nt(e){var t=Lnt.call(e,Jv),n=e[Jv];try{e[Jv]=void 0;var r=!0}catch{}var s=Bnt.call(e);return r&&(t?e[Jv]=n:delete e[Jv]),s}var znt=Object.prototype,Unt=znt.toString;function qnt(e){return Unt.call(e)}var Vnt="[object Null]",Wnt="[object Undefined]",rW=Jk?Jk.toStringTag:void 0;function Sb(e){return e==null?e===void 0?Wnt:Vnt:rW&&rW in Object(e)?$nt(e):qnt(e)}function rg(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var Hnt="[object AsyncFunction]",Gnt="[object Function]",Knt="[object GeneratorFunction]",Ynt="[object Proxy]";function $F(e){if(!rg(e))return!1;var t=Sb(e);return t==Gnt||t==Knt||t==Hnt||t==Ynt}var O3=Gu["__core-js_shared__"],sW=function(){var e=/[^.]+$/.exec(O3&&O3.keys&&O3.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function Znt(e){return!!sW&&sW in e}var Xnt=Function.prototype,Jnt=Xnt.toString;function sg(e){if(e!=null){try{return Jnt.call(e)}catch{}try{return e+""}catch{}}return""}var Qnt=/[\\^$.*+?()[\]{}|]/g,ert=/^\[object .+?Constructor\]$/,trt=Function.prototype,nrt=Object.prototype,rrt=trt.toString,srt=nrt.hasOwnProperty,irt=RegExp("^"+rrt.call(srt).replace(Qnt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function art(e){if(!rg(e)||Znt(e))return!1;var t=$F(e)?irt:ert;return t.test(sg(e))}function ort(e,t){return e==null?void 0:e[t]}function ig(e,t){var n=ort(e,t);return art(n)?n:void 0}var u1=ig(Object,"create");function lrt(){this.__data__=u1?u1(null):{},this.size=0}function crt(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var urt="__lodash_hash_undefined__",drt=Object.prototype,frt=drt.hasOwnProperty;function hrt(e){var t=this.__data__;if(u1){var n=t[e];return n===urt?void 0:n}return frt.call(t,e)?t[e]:void 0}var prt=Object.prototype,mrt=prt.hasOwnProperty;function grt(e){var t=this.__data__;return u1?t[e]!==void 0:mrt.call(t,e)}var yrt="__lodash_hash_undefined__";function brt(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=u1&&t===void 0?yrt:t,this}function Lm(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}Lm.prototype.clear=lrt;Lm.prototype.delete=crt;Lm.prototype.get=hrt;Lm.prototype.has=grt;Lm.prototype.set=brt;function vrt(){this.__data__=[],this.size=0}function uA(e,t){return e===t||e!==e&&t!==t}function dA(e,t){for(var n=e.length;n--;)if(uA(e[n][0],t))return n;return-1}var xrt=Array.prototype,wrt=xrt.splice;function _rt(e){var t=this.__data__,n=dA(t,e);if(n<0)return!1;var r=t.length-1;return n==r?t.pop():wrt.call(t,n,1),--this.size,!0}function Srt(e){var t=this.__data__,n=dA(t,e);return n<0?void 0:t[n][1]}function Crt(e){return dA(this.__data__,e)>-1}function krt(e,t){var n=this.__data__,r=dA(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this}function df(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}df.prototype.clear=vrt;df.prototype.delete=_rt;df.prototype.get=Srt;df.prototype.has=Crt;df.prototype.set=krt;var d1=ig(Gu,"Map");function Ert(){this.size=0,this.__data__={hash:new Lm,map:new(d1||df),string:new Lm}}function Trt(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function fA(e,t){var n=e.__data__;return Trt(t)?n[typeof t=="string"?"string":"hash"]:n.map}function Art(e){var t=fA(this,e).delete(e);return this.size-=t?1:0,t}function Rrt(e){return fA(this,e).get(e)}function Nrt(e){return fA(this,e).has(e)}function Mrt(e,t){var n=fA(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this}function fp(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}fp.prototype.clear=Ert;fp.prototype.delete=Art;fp.prototype.get=Rrt;fp.prototype.has=Nrt;fp.prototype.set=Mrt;var Irt="Expected a function";function p_(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(Irt);var n=function(){var r=arguments,s=t?t.apply(this,r):r[0],i=n.cache;if(i.has(s))return i.get(s);var a=e.apply(this,r);return n.cache=i.set(s,a)||i,a};return n.cache=new(p_.Cache||fp),n}p_.Cache=fp;function jrt(){this.__data__=new df,this.size=0}function Ort(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}function Prt(e){return this.__data__.get(e)}function Drt(e){return this.__data__.has(e)}var Frt=200;function Lrt(e,t){var n=this.__data__;if(n instanceof df){var r=n.__data__;if(!d1||r.length<Frt-1)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new fp(r)}return n.set(e,t),this.size=n.size,this}function Cb(e){var t=this.__data__=new df(e);this.size=t.size}Cb.prototype.clear=jrt;Cb.prototype.delete=Ort;Cb.prototype.get=Prt;Cb.prototype.has=Drt;Cb.prototype.set=Lrt;var Qk=function(){try{var e=ig(Object,"defineProperty");return e({},"",{}),e}catch{}}();function zF(e,t,n){t=="__proto__"&&Qk?Qk(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function vO(e,t,n){(n!==void 0&&!uA(e[t],n)||n===void 0&&!(t in e))&&zF(e,t,n)}function Brt(e){return function(t,n,r){for(var s=-1,i=Object(t),a=r(t),o=a.length;o--;){var l=a[++s];if(n(i[l],l,i)===!1)break}return t}}var $rt=Brt(),Ple=typeof exports=="object"&&exports&&!exports.nodeType&&exports,iW=Ple&&typeof module=="object"&&module&&!module.nodeType&&module,zrt=iW&&iW.exports===Ple,aW=zrt?Gu.Buffer:void 0,oW=aW?aW.allocUnsafe:void 0;function Urt(e,t){if(t)return e.slice();var n=e.length,r=oW?oW(n):new e.constructor(n);return e.copy(r),r}var lW=Gu.Uint8Array;function qrt(e){var t=new e.constructor(e.byteLength);return new lW(t).set(new lW(e)),t}function Vrt(e,t){var n=t?qrt(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function Wrt(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}var cW=Object.create,Hrt=function(){function e(){}return function(t){if(!rg(t))return{};if(cW)return cW(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();function Dle(e,t){return function(n){return e(t(n))}}var Fle=Dle(Object.getPrototypeOf,Object),Grt=Object.prototype;function hA(e){var t=e&&e.constructor,n=typeof t=="function"&&t.prototype||Grt;return e===n}function Krt(e){return typeof e.constructor=="function"&&!hA(e)?Hrt(Fle(e)):{}}function m_(e){return e!=null&&typeof e=="object"}var Yrt="[object Arguments]";function uW(e){return m_(e)&&Sb(e)==Yrt}var Lle=Object.prototype,Zrt=Lle.hasOwnProperty,Xrt=Lle.propertyIsEnumerable,eE=uW(function(){return arguments}())?uW:function(e){return m_(e)&&Zrt.call(e,"callee")&&!Xrt.call(e,"callee")},tE=Array.isArray,Jrt=9007199254740991;function Ble(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=Jrt}function pA(e){return e!=null&&Ble(e.length)&&!$F(e)}function Qrt(e){return m_(e)&&pA(e)}function est(){return!1}var $le=typeof exports=="object"&&exports&&!exports.nodeType&&exports,dW=$le&&typeof module=="object"&&module&&!module.nodeType&&module,tst=dW&&dW.exports===$le,fW=tst?Gu.Buffer:void 0,nst=fW?fW.isBuffer:void 0,UF=nst||est,rst="[object Object]",sst=Function.prototype,ist=Object.prototype,zle=sst.toString,ast=ist.hasOwnProperty,ost=zle.call(Object);function lst(e){if(!m_(e)||Sb(e)!=rst)return!1;var t=Fle(e);if(t===null)return!0;var n=ast.call(t,"constructor")&&t.constructor;return typeof n=="function"&&n instanceof n&&zle.call(n)==ost}var cst="[object Arguments]",ust="[object Array]",dst="[object Boolean]",fst="[object Date]",hst="[object Error]",pst="[object Function]",mst="[object Map]",gst="[object Number]",yst="[object Object]",bst="[object RegExp]",vst="[object Set]",xst="[object String]",wst="[object WeakMap]",_st="[object ArrayBuffer]",Sst="[object DataView]",Cst="[object Float32Array]",kst="[object Float64Array]",Est="[object Int8Array]",Tst="[object Int16Array]",Ast="[object Int32Array]",Rst="[object Uint8Array]",Nst="[object Uint8ClampedArray]",Mst="[object Uint16Array]",Ist="[object Uint32Array]",$s={};$s[Cst]=$s[kst]=$s[Est]=$s[Tst]=$s[Ast]=$s[Rst]=$s[Nst]=$s[Mst]=$s[Ist]=!0;$s[cst]=$s[ust]=$s[_st]=$s[dst]=$s[Sst]=$s[fst]=$s[hst]=$s[pst]=$s[mst]=$s[gst]=$s[yst]=$s[bst]=$s[vst]=$s[xst]=$s[wst]=!1;function jst(e){return m_(e)&&Ble(e.length)&&!!$s[Sb(e)]}function Ost(e){return function(t){return e(t)}}var Ule=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Vx=Ule&&typeof module=="object"&&module&&!module.nodeType&&module,Pst=Vx&&Vx.exports===Ule,P3=Pst&&jle.process,hW=function(){try{var e=Vx&&Vx.require&&Vx.require("util").types;return e||P3&&P3.binding&&P3.binding("util")}catch{}}(),pW=hW&&hW.isTypedArray,qF=pW?Ost(pW):jst;function xO(e,t){if(!(t==="constructor"&&typeof e[t]=="function")&&t!="__proto__")return e[t]}var Dst=Object.prototype,Fst=Dst.hasOwnProperty;function Lst(e,t,n){var r=e[t];(!(Fst.call(e,t)&&uA(r,n))||n===void 0&&!(t in e))&&zF(e,t,n)}function Bst(e,t,n,r){var s=!n;n||(n={});for(var i=-1,a=t.length;++i<a;){var o=t[i],l=void 0;l===void 0&&(l=e[o]),s?zF(n,o,l):Lst(n,o,l)}return n}function $st(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}var zst=9007199254740991,Ust=/^(?:0|[1-9]\d*)$/;function qle(e,t){var n=typeof e;return t=t??zst,!!t&&(n=="number"||n!="symbol"&&Ust.test(e))&&e>-1&&e%1==0&&e<t}var qst=Object.prototype,Vst=qst.hasOwnProperty;function Wst(e,t){var n=tE(e),r=!n&&eE(e),s=!n&&!r&&UF(e),i=!n&&!r&&!s&&qF(e),a=n||r||s||i,o=a?$st(e.length,String):[],l=o.length;for(var c in e)(t||Vst.call(e,c))&&!(a&&(c=="length"||s&&(c=="offset"||c=="parent")||i&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||qle(c,l)))&&o.push(c);return o}function Hst(e){var t=[];if(e!=null)for(var n in Object(e))t.push(n);return t}var Gst=Object.prototype,Kst=Gst.hasOwnProperty;function Yst(e){if(!rg(e))return Hst(e);var t=hA(e),n=[];for(var r in e)r=="constructor"&&(t||!Kst.call(e,r))||n.push(r);return n}function Vle(e){return pA(e)?Wst(e,!0):Yst(e)}function Zst(e){return Bst(e,Vle(e))}function Xst(e,t,n,r,s,i,a){var o=xO(e,n),l=xO(t,n),c=a.get(l);if(c){vO(e,n,c);return}var u=i?i(o,l,n+"",e,t,a):void 0,d=u===void 0;if(d){var h=tE(l),m=!h&&UF(l),y=!h&&!m&&qF(l);u=l,h||m||y?tE(o)?u=o:Qrt(o)?u=Wrt(o):m?(d=!1,u=Urt(l,!0)):y?(d=!1,u=Vrt(l,!0)):u=[]:lst(l)||eE(l)?(u=o,eE(o)?u=Zst(o):(!rg(o)||$F(o))&&(u=Krt(l))):d=!1}d&&(a.set(l,u),s(u,l,r,i,a),a.delete(l)),vO(e,n,u)}function Wle(e,t,n,r,s){e!==t&&$rt(t,function(i,a){if(s||(s=new Cb),rg(i))Xst(e,t,a,n,Wle,r,s);else{var o=r?r(xO(e,a),i,a+"",e,t,s):void 0;o===void 0&&(o=i),vO(e,a,o)}},Vle)}function Hle(e){return e}function Jst(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}var mW=Math.max;function Qst(e,t,n){return t=mW(t===void 0?e.length-1:t,0),function(){for(var r=arguments,s=-1,i=mW(r.length-t,0),a=Array(i);++s<i;)a[s]=r[t+s];s=-1;for(var o=Array(t+1);++s<t;)o[s]=r[s];return o[t]=n(a),Jst(e,this,o)}}function eit(e){return function(){return e}}var tit=Qk?function(e,t){return Qk(e,"toString",{configurable:!0,enumerable:!1,value:eit(t),writable:!0})}:Hle,nit=800,rit=16,sit=Date.now;function iit(e){var t=0,n=0;return function(){var r=sit(),s=rit-(r-n);if(n=r,s>0){if(++t>=nit)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var ait=iit(tit);function oit(e,t){return ait(Qst(e,t,Hle),e+"")}function lit(e,t,n){if(!rg(n))return!1;var r=typeof t;return(r=="number"?pA(n)&&qle(t,n.length):r=="string"&&t in n)?uA(n[t],e):!1}function cit(e){return oit(function(t,n){var r=-1,s=n.length,i=s>1?n[s-1]:void 0,a=s>2?n[2]:void 0;for(i=e.length>3&&typeof i=="function"?(s--,i):void 0,a&&lit(n[0],n[1],a)&&(i=s<3?void 0:i,s=1),t=Object(t);++r<s;){var o=n[r];o&&e(t,o,r,i)}return t})}var uit=cit(function(e,t,n){Wle(e,t,n)}),dit="",fit={curveBasis:J2,curveBasisClosed:Rnt,curveBasisOpen:Nnt,curveBumpX:hle,curveBumpY:ple,curveBundle:Mnt,curveCardinalClosed:Int,curveCardinalOpen:jnt,curveCardinal:ble,curveCatmullRomClosed:Ont,curveCatmullRomOpen:Pnt,curveCatmullRom:xle,curveLinear:Kk,curveLinearClosed:Dnt,curveMonotoneX:Ele,curveMonotoneY:Tle,curveNatural:Rle,curveStep:Nle,curveStepAfter:Ile,curveStepBefore:Mle},hit=/\s*(?:(\w+)(?=:):|(\w+))\s*(?:(\w+)|((?:(?!}%{2}).|\r?\n)*))?\s*(?:}%{2})?/gi,pit=ie(function(e,t){const n=Gle(e,/(?:init\b)|(?:initialize\b)/);let r={};if(Array.isArray(n)){const a=n.map(o=>o.args);Mk(a),r=Ca(r,[...a])}else r=n.args;if(!r)return;let s=hF(e,t);const i="config";return r[i]!==void 0&&(s==="flowchart-v2"&&(s="flowchart"),r[s]=r[i],delete r[i]),r},"detectInit"),Gle=ie(function(e,t=null){var n,r;try{const s=new RegExp(`[%]{2}(?![{]${hit.source})(?=[}][%]{2}).*
`,"ig");e=e.trim().replace(s,"").replace(/'/gm,'"'),zt.debug(`Detecting diagram directive${t!==null?" type:"+t:""} based on the text:${e}`);let i;const a=[];for(;(i=Ux.exec(e))!==null;)if(i.index===Ux.lastIndex&&Ux.lastIndex++,i&&!t||t&&((n=i[1])!=null&&n.match(t))||t&&((r=i[2])!=null&&r.match(t))){const o=i[1]?i[1]:i[2],l=i[3]?i[3].trim():i[4]?JSON.parse(i[4].trim()):null;a.push({type:o,args:l})}return a.length===0?{type:e,args:null}:a.length===1?a[0]:a}catch(s){return zt.error(`ERROR: ${s.message} - Unable to parse directive type: '${t}' based on the text: '${e}'`),{type:void 0,args:null}}},"detectDirective"),mit=ie(function(e){return e.replace(Ux,"")},"removeDirectives"),git=ie(function(e,t){for(const[n,r]of t.entries())if(r.match(e))return n;return-1},"isSubstringInArray");function VF(e,t){if(!e)return t;const n=`curve${e.charAt(0).toUpperCase()+e.slice(1)}`;return fit[n]??t}ie(VF,"interpolateToCurve");function Kle(e,t){const n=e.trim();if(n)return t.securityLevel!=="loose"?sQe.sanitizeUrl(n):n}ie(Kle,"formatUrl");var yit=ie((e,...t)=>{const n=e.split("."),r=n.length-1,s=n[r];let i=window;for(let a=0;a<r;a++)if(i=i[n[a]],!i){zt.error(`Function name: ${e} not found in window`);return}i[s](...t)},"runFunc");function WF(e,t){return!e||!t?0:Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}ie(WF,"distance");function Yle(e){let t,n=0;e.forEach(s=>{n+=WF(s,t),t=s});const r=n/2;return HF(e,r)}ie(Yle,"traverseEdge");function Zle(e){return e.length===1?e[0]:Yle(e)}ie(Zle,"calcLabelPosition");var gW=ie((e,t=2)=>{const n=Math.pow(10,t);return Math.round(e*n)/n},"roundNumber"),HF=ie((e,t)=>{let n,r=t;for(const s of e){if(n){const i=WF(s,n);if(i===0)return n;if(i<r)r-=i;else{const a=r/i;if(a<=0)return n;if(a>=1)return{x:s.x,y:s.y};if(a>0&&a<1)return{x:gW((1-a)*n.x+a*s.x,5),y:gW((1-a)*n.y+a*s.y,5)}}}n=s}throw new Error("Could not find a suitable point for the given distance")},"calculatePoint"),bit=ie((e,t,n)=>{zt.info(`our points ${JSON.stringify(t)}`),t[0]!==n&&(t=t.reverse());const s=HF(t,25),i=e?10:5,a=Math.atan2(t[0].y-s.y,t[0].x-s.x),o={x:0,y:0};return o.x=Math.sin(a)*i+(t[0].x+s.x)/2,o.y=-Math.cos(a)*i+(t[0].y+s.y)/2,o},"calcCardinalityPosition");function Xle(e,t,n){const r=structuredClone(n);zt.info("our points",r),t!=="start_left"&&t!=="start_right"&&r.reverse();const s=25+e,i=HF(r,s),a=10+e*.5,o=Math.atan2(r[0].y-i.y,r[0].x-i.x),l={x:0,y:0};return t==="start_left"?(l.x=Math.sin(o+Math.PI)*a+(r[0].x+i.x)/2,l.y=-Math.cos(o+Math.PI)*a+(r[0].y+i.y)/2):t==="end_right"?(l.x=Math.sin(o-Math.PI)*a+(r[0].x+i.x)/2-5,l.y=-Math.cos(o-Math.PI)*a+(r[0].y+i.y)/2-5):t==="end_left"?(l.x=Math.sin(o)*a+(r[0].x+i.x)/2-5,l.y=-Math.cos(o)*a+(r[0].y+i.y)/2-5):(l.x=Math.sin(o)*a+(r[0].x+i.x)/2,l.y=-Math.cos(o)*a+(r[0].y+i.y)/2),l}ie(Xle,"calcTerminalLabelPosition");function Jle(e){let t="",n="";for(const r of e)r!==void 0&&(r.startsWith("color:")||r.startsWith("text-align:")?n=n+r+";":t=t+r+";");return{style:t,labelStyle:n}}ie(Jle,"getStylesFromArray");var yW=0,vit=ie(()=>(yW++,"id-"+Math.random().toString(36).substr(2,12)+"-"+yW),"generateId");function Qle(e){let t="";const n="0123456789abcdef",r=n.length;for(let s=0;s<e;s++)t+=n.charAt(Math.floor(Math.random()*r));return t}ie(Qle,"makeRandomHex");var xit=ie(e=>Qle(e.length),"random"),wit=ie(function(){return{x:0,y:0,fill:void 0,anchor:"start",style:"#666",width:100,height:100,textMargin:0,rx:0,ry:0,valign:void 0,text:""}},"getTextObj"),_it=ie(function(e,t){const n=t.text.replace(_b.lineBreakRegex," "),[,r]=mA(t.fontSize),s=e.append("text");s.attr("x",t.x),s.attr("y",t.y),s.style("text-anchor",t.anchor),s.style("font-family",t.fontFamily),s.style("font-size",r),s.style("font-weight",t.fontWeight),s.attr("fill",t.fill),t.class!==void 0&&s.attr("class",t.class);const i=s.append("tspan");return i.attr("x",t.x+t.textMargin*2),i.attr("fill",t.fill),i.text(n),s},"drawSimpleText"),Sit=p_((e,t,n)=>{if(!e||(n=Object.assign({fontSize:12,fontWeight:400,fontFamily:"Arial",joinWith:"<br/>"},n),_b.lineBreakRegex.test(e)))return e;const r=e.split(" ").filter(Boolean),s=[];let i="";return r.forEach((a,o)=>{const l=tf(`${a} `,n),c=tf(i,n);if(l>t){const{hyphenatedStrings:h,remainingWord:m}=Cit(a,t,"-",n);s.push(i,...h),i=m}else c+l>=t?(s.push(i),i=a):i=[i,a].filter(Boolean).join(" ");o+1===r.length&&s.push(i)}),s.filter(a=>a!=="").join(n.joinWith)},(e,t,n)=>`${e}${t}${n.fontSize}${n.fontWeight}${n.fontFamily}${n.joinWith}`),Cit=p_((e,t,n="-",r)=>{r=Object.assign({fontSize:12,fontWeight:400,fontFamily:"Arial",margin:0},r);const s=[...e],i=[];let a="";return s.forEach((o,l)=>{const c=`${a}${o}`;if(tf(c,r)>=t){const d=l+1,h=s.length===d,m=`${c}${n}`;i.push(h?c:m),a=""}else a=c}),{hyphenatedStrings:i,remainingWord:a}},(e,t,n="-",r)=>`${e}${t}${n}${r.fontSize}${r.fontWeight}${r.fontFamily}`);function ece(e,t){return GF(e,t).height}ie(ece,"calculateTextHeight");function tf(e,t){return GF(e,t).width}ie(tf,"calculateTextWidth");var GF=p_((e,t)=>{const{fontSize:n=12,fontFamily:r="Arial",fontWeight:s=400}=t;if(!e)return{width:0,height:0};const[,i]=mA(n),a=["sans-serif",r],o=e.split(_b.lineBreakRegex),l=[],c=Kr("body");if(!c.remove)return{width:0,height:0,lineHeight:0};const u=c.append("svg");for(const h of a){let m=0;const y={width:0,height:0,lineHeight:0};for(const b of o){const v=wit();v.text=b||dit;const x=_it(u,v).style("font-size",i).style("font-weight",s).style("font-family",h),w=(x._groups||x)[0][0].getBBox();if(w.width===0&&w.height===0)throw new Error("svg element not in render tree");y.width=Math.round(Math.max(y.width,w.width)),m=Math.round(w.height),y.height+=m,y.lineHeight=Math.round(Math.max(y.lineHeight,m))}l.push(y)}u.remove();const d=isNaN(l[1].height)||isNaN(l[1].width)||isNaN(l[1].lineHeight)||l[0].height>l[1].height&&l[0].width>l[1].width&&l[0].lineHeight>l[1].lineHeight?0:1;return l[d]},(e,t)=>`${e}${t.fontSize}${t.fontWeight}${t.fontFamily}`),Z0,kit=(Z0=class{constructor(t=!1,n){this.count=0,this.count=n?n.length:0,this.next=t?()=>this.count++:()=>Date.now()}},ie(Z0,"InitIDGenerator"),Z0),w2,Eit=ie(function(e){return w2=w2||document.createElement("div"),e=escape(e).replace(/%26/g,"&").replace(/%23/g,"#").replace(/%3B/g,";"),w2.innerHTML=e,unescape(w2.textContent)},"entityDecode");function KF(e){return"str"in e}ie(KF,"isDetailedError");var Tit=ie((e,t,n,r)=>{var i;if(!r)return;const s=(i=e.node())==null?void 0:i.getBBox();s&&e.append("text").text(r).attr("text-anchor","middle").attr("x",s.x+s.width/2).attr("y",-n).attr("class",t)},"insertTitle"),mA=ie(e=>{if(typeof e=="number")return[e,e+"px"];const t=parseInt(e??"",10);return Number.isNaN(t)?[void 0,void 0]:e===String(t)?[t,e+"px"]:[t,e]},"parseFontSize");function YF(e,t){return uit({},e,t)}ie(YF,"cleanAndMerge");var vu={assignWithDepth:Ca,wrapLabel:Sit,calculateTextHeight:ece,calculateTextWidth:tf,calculateTextDimensions:GF,cleanAndMerge:YF,detectInit:pit,detectDirective:Gle,isSubstringInArray:git,interpolateToCurve:VF,calcLabelPosition:Zle,calcCardinalityPosition:bit,calcTerminalLabelPosition:Xle,formatUrl:Kle,getStylesFromArray:Jle,generateId:vit,random:xit,runFunc:yit,entityDecode:Eit,insertTitle:Tit,parseFontSize:mA,InitIDGenerator:kit},Ait=ie(function(e){let t=e;return t=t.replace(/style.*:\S*#.*;/g,function(n){return n.substring(0,n.length-1)}),t=t.replace(/classDef.*:\S*#.*;/g,function(n){return n.substring(0,n.length-1)}),t=t.replace(/#\w+;/g,function(n){const r=n.substring(1,n.length-1);return/^\+?\d+$/.test(r)?""+r+"":""+r+""}),t},"encodeEntities"),ag=ie(function(e){return e.replace(//g,"&#").replace(//g,"&").replace(//g,";")},"decodeEntities"),Gdt=ie((e,t,{counter:n=0,prefix:r,suffix:s},i)=>i||`${r?`${r}_`:""}${e}_${t}_${n}${s?`_${s}`:""}`,"getEdgeId");function io(e){return e??null}ie(io,"handleUndefinedAttr");function ZF(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var og=ZF();function tce(e){og=e}var Wx={exec:()=>null};function gs(e,t=""){let n=typeof e=="string"?e:e.source;const r={replace:(s,i)=>{let a=typeof i=="string"?i:i.source;return a=a.replace(ro.caret,"$1"),n=n.replace(s,a),r},getRegex:()=>new RegExp(n,t)};return r}var ro={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] /,listReplaceTask:/^\[[ xX]\] +/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:e=>new RegExp(`^( {0,3}${e})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}#`),htmlBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}<(?:[a-z].*>|!--)`,"i")},Rit=/^(?:[ \t]*(?:\n|$))+/,Nit=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,Mit=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,g_=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,Iit=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,XF=/(?:[*+-]|\d{1,9}[.)])/,nce=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,rce=gs(nce).replace(/bull/g,XF).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),jit=gs(nce).replace(/bull/g,XF).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),JF=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,Oit=/^[^\n]+/,QF=/(?!\s*\])(?:\\.|[^\[\]\\])+/,Pit=gs(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",QF).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),Dit=gs(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,XF).getRegex(),gA="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",e5=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,Fit=gs("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",e5).replace("tag",gA).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),sce=gs(JF).replace("hr",g_).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",gA).getRegex(),Lit=gs(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",sce).getRegex(),t5={blockquote:Lit,code:Nit,def:Pit,fences:Mit,heading:Iit,hr:g_,html:Fit,lheading:rce,list:Dit,newline:Rit,paragraph:sce,table:Wx,text:Oit},bW=gs("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",g_).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",gA).getRegex(),Bit={...t5,lheading:jit,table:bW,paragraph:gs(JF).replace("hr",g_).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",bW).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",gA).getRegex()},$it={...t5,html:gs(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",e5).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Wx,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:gs(JF).replace("hr",g_).replace("heading",` *#{1,6} *[^
]`).replace("lheading",rce).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},zit=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,Uit=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,ice=/^( {2,}|\\)\n(?!\s*$)/,qit=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,yA=/[\p{P}\p{S}]/u,n5=/[\s\p{P}\p{S}]/u,ace=/[^\s\p{P}\p{S}]/u,Vit=gs(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,n5).getRegex(),oce=/(?!~)[\p{P}\p{S}]/u,Wit=/(?!~)[\s\p{P}\p{S}]/u,Hit=/(?:[^\s\p{P}\p{S}]|~)/u,Git=/\[[^[\]]*?\]\((?:\\.|[^\\\(\)]|\((?:\\.|[^\\\(\)])*\))*\)|`[^`]*?`|<[^<>]*?>/g,lce=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,Kit=gs(lce,"u").replace(/punct/g,yA).getRegex(),Yit=gs(lce,"u").replace(/punct/g,oce).getRegex(),cce="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",Zit=gs(cce,"gu").replace(/notPunctSpace/g,ace).replace(/punctSpace/g,n5).replace(/punct/g,yA).getRegex(),Xit=gs(cce,"gu").replace(/notPunctSpace/g,Hit).replace(/punctSpace/g,Wit).replace(/punct/g,oce).getRegex(),Jit=gs("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,ace).replace(/punctSpace/g,n5).replace(/punct/g,yA).getRegex(),Qit=gs(/\\(punct)/,"gu").replace(/punct/g,yA).getRegex(),eat=gs(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),tat=gs(e5).replace("(?:-->|$)","-->").getRegex(),nat=gs("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",tat).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),nE=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,rat=gs(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",nE).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),uce=gs(/^!?\[(label)\]\[(ref)\]/).replace("label",nE).replace("ref",QF).getRegex(),dce=gs(/^!?\[(ref)\](?:\[\])?/).replace("ref",QF).getRegex(),sat=gs("reflink|nolink(?!\\()","g").replace("reflink",uce).replace("nolink",dce).getRegex(),r5={_backpedal:Wx,anyPunctuation:Qit,autolink:eat,blockSkip:Git,br:ice,code:Uit,del:Wx,emStrongLDelim:Kit,emStrongRDelimAst:Zit,emStrongRDelimUnd:Jit,escape:zit,link:rat,nolink:dce,punctuation:Vit,reflink:uce,reflinkSearch:sat,tag:nat,text:qit,url:Wx},iat={...r5,link:gs(/^!?\[(label)\]\((.*?)\)/).replace("label",nE).getRegex(),reflink:gs(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",nE).getRegex()},wO={...r5,emStrongRDelimAst:Xit,emStrongLDelim:Yit,url:gs(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\.|[^\\])*?(?:\\.|[^\s~\\]))\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},aat={...wO,br:gs(ice).replace("{2,}","*").getRegex(),text:gs(wO.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},_2={normal:t5,gfm:Bit,pedantic:$it},Qv={normal:r5,gfm:wO,breaks:aat,pedantic:iat},oat={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},vW=e=>oat[e];function lu(e,t){if(t){if(ro.escapeTest.test(e))return e.replace(ro.escapeReplace,vW)}else if(ro.escapeTestNoEncode.test(e))return e.replace(ro.escapeReplaceNoEncode,vW);return e}function xW(e){try{e=encodeURI(e).replace(ro.percentDecode,"%")}catch{return null}return e}function wW(e,t){var i;const n=e.replace(ro.findPipe,(a,o,l)=>{let c=!1,u=o;for(;--u>=0&&l[u]==="\\";)c=!c;return c?"|":" |"}),r=n.split(ro.splitPipe);let s=0;if(r[0].trim()||r.shift(),r.length>0&&!((i=r.at(-1))!=null&&i.trim())&&r.pop(),t)if(r.length>t)r.splice(t);else for(;r.length<t;)r.push("");for(;s<r.length;s++)r[s]=r[s].trim().replace(ro.slashPipe,"|");return r}function ex(e,t,n){const r=e.length;if(r===0)return"";let s=0;for(;s<r&&e.charAt(r-s-1)===t;)s++;return e.slice(0,r-s)}function lat(e,t){if(e.indexOf(t[1])===-1)return-1;let n=0;for(let r=0;r<e.length;r++)if(e[r]==="\\")r++;else if(e[r]===t[0])n++;else if(e[r]===t[1]&&(n--,n<0))return r;return n>0?-2:-1}function _W(e,t,n,r,s){const i=t.href,a=t.title||null,o=e[1].replace(s.other.outputLinkReplace,"$1");r.state.inLink=!0;const l={type:e[0].charAt(0)==="!"?"image":"link",raw:n,href:i,title:a,text:o,tokens:r.inlineTokens(o)};return r.state.inLink=!1,l}function cat(e,t,n){const r=e.match(n.other.indentCodeCompensation);if(r===null)return t;const s=r[1];return t.split(`
`).map(i=>{const a=i.match(n.other.beginningSpace);if(a===null)return i;const[o]=a;return o.length>=s.length?i.slice(s.length):i}).join(`
`)}var rE=class{constructor(e){de(this,"options");de(this,"rules");de(this,"lexer");this.options=e||og}space(e){const t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){const t=this.rules.block.code.exec(e);if(t){const n=t[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?n:ex(n,`
`)}}}fences(e){const t=this.rules.block.fences.exec(e);if(t){const n=t[0],r=cat(n,t[3]||"",this.rules);return{type:"code",raw:n,lang:t[2]?t[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):t[2],text:r}}}heading(e){const t=this.rules.block.heading.exec(e);if(t){let n=t[2].trim();if(this.rules.other.endingHash.test(n)){const r=ex(n,"#");(this.options.pedantic||!r||this.rules.other.endingSpaceChar.test(r))&&(n=r.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:n,tokens:this.lexer.inline(n)}}}hr(e){const t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:ex(t[0],`
`)}}blockquote(e){const t=this.rules.block.blockquote.exec(e);if(t){let n=ex(t[0],`
`).split(`
`),r="",s="";const i=[];for(;n.length>0;){let a=!1;const o=[];let l;for(l=0;l<n.length;l++)if(this.rules.other.blockquoteStart.test(n[l]))o.push(n[l]),a=!0;else if(!a)o.push(n[l]);else break;n=n.slice(l);const c=o.join(`
`),u=c.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");r=r?`${r}
${c}`:c,s=s?`${s}
${u}`:u;const d=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(u,i,!0),this.lexer.state.top=d,n.length===0)break;const h=i.at(-1);if((h==null?void 0:h.type)==="code")break;if((h==null?void 0:h.type)==="blockquote"){const m=h,y=m.raw+`
`+n.join(`
`),b=this.blockquote(y);i[i.length-1]=b,r=r.substring(0,r.length-m.raw.length)+b.raw,s=s.substring(0,s.length-m.text.length)+b.text;break}else if((h==null?void 0:h.type)==="list"){const m=h,y=m.raw+`
`+n.join(`
`),b=this.list(y);i[i.length-1]=b,r=r.substring(0,r.length-h.raw.length)+b.raw,s=s.substring(0,s.length-m.raw.length)+b.raw,n=y.substring(i.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:r,tokens:i,text:s}}}list(e){let t=this.rules.block.list.exec(e);if(t){let n=t[1].trim();const r=n.length>1,s={type:"list",raw:"",ordered:r,start:r?+n.slice(0,-1):"",loose:!1,items:[]};n=r?`\\d{1,9}\\${n.slice(-1)}`:`\\${n}`,this.options.pedantic&&(n=r?n:"[*+-]");const i=this.rules.other.listItemRegex(n);let a=!1;for(;e;){let l=!1,c="",u="";if(!(t=i.exec(e))||this.rules.block.hr.test(e))break;c=t[0],e=e.substring(c.length);let d=t[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,x=>" ".repeat(3*x.length)),h=e.split(`
`,1)[0],m=!d.trim(),y=0;if(this.options.pedantic?(y=2,u=d.trimStart()):m?y=t[1].length+1:(y=t[2].search(this.rules.other.nonSpaceChar),y=y>4?1:y,u=d.slice(y),y+=t[1].length),m&&this.rules.other.blankLine.test(h)&&(c+=h+`
`,e=e.substring(h.length+1),l=!0),!l){const x=this.rules.other.nextBulletRegex(y),w=this.rules.other.hrRegex(y),S=this.rules.other.fencesBeginRegex(y),k=this.rules.other.headingBeginRegex(y),C=this.rules.other.htmlBeginRegex(y);for(;e;){const T=e.split(`
`,1)[0];let R;if(h=T,this.options.pedantic?(h=h.replace(this.rules.other.listReplaceNesting,"  "),R=h):R=h.replace(this.rules.other.tabCharGlobal,"    "),S.test(h)||k.test(h)||C.test(h)||x.test(h)||w.test(h))break;if(R.search(this.rules.other.nonSpaceChar)>=y||!h.trim())u+=`
`+R.slice(y);else{if(m||d.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||S.test(d)||k.test(d)||w.test(d))break;u+=`
`+h}!m&&!h.trim()&&(m=!0),c+=T+`
`,e=e.substring(T.length+1),d=R.slice(y)}}s.loose||(a?s.loose=!0:this.rules.other.doubleBlankLine.test(c)&&(a=!0));let b=null,v;this.options.gfm&&(b=this.rules.other.listIsTask.exec(u),b&&(v=b[0]!=="[ ] ",u=u.replace(this.rules.other.listReplaceTask,""))),s.items.push({type:"list_item",raw:c,task:!!b,checked:v,loose:!1,text:u,tokens:[]}),s.raw+=c}const o=s.items.at(-1);if(o)o.raw=o.raw.trimEnd(),o.text=o.text.trimEnd();else return;s.raw=s.raw.trimEnd();for(let l=0;l<s.items.length;l++)if(this.lexer.state.top=!1,s.items[l].tokens=this.lexer.blockTokens(s.items[l].text,[]),!s.loose){const c=s.items[l].tokens.filter(d=>d.type==="space"),u=c.length>0&&c.some(d=>this.rules.other.anyLine.test(d.raw));s.loose=u}if(s.loose)for(let l=0;l<s.items.length;l++)s.items[l].loose=!0;return s}}html(e){const t=this.rules.block.html.exec(e);if(t)return{type:"html",block:!0,raw:t[0],pre:t[1]==="pre"||t[1]==="script"||t[1]==="style",text:t[0]}}def(e){const t=this.rules.block.def.exec(e);if(t){const n=t[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),r=t[2]?t[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",s=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):t[3];return{type:"def",tag:n,raw:t[0],href:r,title:s}}}table(e){var a;const t=this.rules.block.table.exec(e);if(!t||!this.rules.other.tableDelimiter.test(t[2]))return;const n=wW(t[1]),r=t[2].replace(this.rules.other.tableAlignChars,"").split("|"),s=(a=t[3])!=null&&a.trim()?t[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],i={type:"table",raw:t[0],header:[],align:[],rows:[]};if(n.length===r.length){for(const o of r)this.rules.other.tableAlignRight.test(o)?i.align.push("right"):this.rules.other.tableAlignCenter.test(o)?i.align.push("center"):this.rules.other.tableAlignLeft.test(o)?i.align.push("left"):i.align.push(null);for(let o=0;o<n.length;o++)i.header.push({text:n[o],tokens:this.lexer.inline(n[o]),header:!0,align:i.align[o]});for(const o of s)i.rows.push(wW(o,i.header.length).map((l,c)=>({text:l,tokens:this.lexer.inline(l),header:!1,align:i.align[c]})));return i}}lheading(e){const t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:t[2].charAt(0)==="="?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){const t=this.rules.block.paragraph.exec(e);if(t){const n=t[1].charAt(t[1].length-1)===`
`?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:n,tokens:this.lexer.inline(n)}}}text(e){const t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){const t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:t[1]}}tag(e){const t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&this.rules.other.startATag.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:t[0]}}link(e){const t=this.rules.inline.link.exec(e);if(t){const n=t[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(n)){if(!this.rules.other.endAngleBracket.test(n))return;const i=ex(n.slice(0,-1),"\\");if((n.length-i.length)%2===0)return}else{const i=lat(t[2],"()");if(i===-2)return;if(i>-1){const o=(t[0].indexOf("!")===0?5:4)+t[1].length+i;t[2]=t[2].substring(0,i),t[0]=t[0].substring(0,o).trim(),t[3]=""}}let r=t[2],s="";if(this.options.pedantic){const i=this.rules.other.pedanticHrefTitle.exec(r);i&&(r=i[1],s=i[3])}else s=t[3]?t[3].slice(1,-1):"";return r=r.trim(),this.rules.other.startAngleBracket.test(r)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(n)?r=r.slice(1):r=r.slice(1,-1)),_W(t,{href:r&&r.replace(this.rules.inline.anyPunctuation,"$1"),title:s&&s.replace(this.rules.inline.anyPunctuation,"$1")},t[0],this.lexer,this.rules)}}reflink(e,t){let n;if((n=this.rules.inline.reflink.exec(e))||(n=this.rules.inline.nolink.exec(e))){const r=(n[2]||n[1]).replace(this.rules.other.multipleSpaceGlobal," "),s=t[r.toLowerCase()];if(!s){const i=n[0].charAt(0);return{type:"text",raw:i,text:i}}return _W(n,s,n[0],this.lexer,this.rules)}}emStrong(e,t,n=""){let r=this.rules.inline.emStrongLDelim.exec(e);if(!r||r[3]&&n.match(this.rules.other.unicodeAlphaNumeric))return;if(!(r[1]||r[2]||"")||!n||this.rules.inline.punctuation.exec(n)){const i=[...r[0]].length-1;let a,o,l=i,c=0;const u=r[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(u.lastIndex=0,t=t.slice(-1*e.length+i);(r=u.exec(t))!=null;){if(a=r[1]||r[2]||r[3]||r[4]||r[5]||r[6],!a)continue;if(o=[...a].length,r[3]||r[4]){l+=o;continue}else if((r[5]||r[6])&&i%3&&!((i+o)%3)){c+=o;continue}if(l-=o,l>0)continue;o=Math.min(o,o+l+c);const d=[...r[0]][0].length,h=e.slice(0,i+r.index+d+o);if(Math.min(i,o)%2){const y=h.slice(1,-1);return{type:"em",raw:h,text:y,tokens:this.lexer.inlineTokens(y)}}const m=h.slice(2,-2);return{type:"strong",raw:h,text:m,tokens:this.lexer.inlineTokens(m)}}}}codespan(e){const t=this.rules.inline.code.exec(e);if(t){let n=t[2].replace(this.rules.other.newLineCharGlobal," ");const r=this.rules.other.nonSpaceChar.test(n),s=this.rules.other.startingSpaceChar.test(n)&&this.rules.other.endingSpaceChar.test(n);return r&&s&&(n=n.substring(1,n.length-1)),{type:"codespan",raw:t[0],text:n}}}br(e){const t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){const t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e){const t=this.rules.inline.autolink.exec(e);if(t){let n,r;return t[2]==="@"?(n=t[1],r="mailto:"+n):(n=t[1],r=n),{type:"link",raw:t[0],text:n,href:r,tokens:[{type:"text",raw:n,text:n}]}}}url(e){var n;let t;if(t=this.rules.inline.url.exec(e)){let r,s;if(t[2]==="@")r=t[0],s="mailto:"+r;else{let i;do i=t[0],t[0]=((n=this.rules.inline._backpedal.exec(t[0]))==null?void 0:n[0])??"";while(i!==t[0]);r=t[0],t[1]==="www."?s="http://"+t[0]:s=t[0]}return{type:"link",raw:t[0],text:r,href:s,tokens:[{type:"text",raw:r,text:r}]}}}inlineText(e){const t=this.rules.inline.text.exec(e);if(t){const n=this.lexer.state.inRawBlock;return{type:"text",raw:t[0],text:t[0],escaped:n}}}},Od=class _O{constructor(t){de(this,"tokens");de(this,"options");de(this,"state");de(this,"tokenizer");de(this,"inlineQueue");this.tokens=[],this.tokens.links=Object.create(null),this.options=t||og,this.options.tokenizer=this.options.tokenizer||new rE,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const n={other:ro,block:_2.normal,inline:Qv.normal};this.options.pedantic?(n.block=_2.pedantic,n.inline=Qv.pedantic):this.options.gfm&&(n.block=_2.gfm,this.options.breaks?n.inline=Qv.breaks:n.inline=Qv.gfm),this.tokenizer.rules=n}static get rules(){return{block:_2,inline:Qv}}static lex(t,n){return new _O(n).lex(t)}static lexInline(t,n){return new _O(n).inlineTokens(t)}lex(t){t=t.replace(ro.carriageReturn,`
`),this.blockTokens(t,this.tokens);for(let n=0;n<this.inlineQueue.length;n++){const r=this.inlineQueue[n];this.inlineTokens(r.src,r.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(t,n=[],r=!1){var s,i,a;for(this.options.pedantic&&(t=t.replace(ro.tabCharGlobal,"    ").replace(ro.spaceLine,""));t;){let o;if((i=(s=this.options.extensions)==null?void 0:s.block)!=null&&i.some(c=>(o=c.call({lexer:this},t,n))?(t=t.substring(o.raw.length),n.push(o),!0):!1))continue;if(o=this.tokenizer.space(t)){t=t.substring(o.raw.length);const c=n.at(-1);o.raw.length===1&&c!==void 0?c.raw+=`
`:n.push(o);continue}if(o=this.tokenizer.code(t)){t=t.substring(o.raw.length);const c=n.at(-1);(c==null?void 0:c.type)==="paragraph"||(c==null?void 0:c.type)==="text"?(c.raw+=`
`+o.raw,c.text+=`
`+o.text,this.inlineQueue.at(-1).src=c.text):n.push(o);continue}if(o=this.tokenizer.fences(t)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.heading(t)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.hr(t)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.blockquote(t)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.list(t)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.html(t)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.def(t)){t=t.substring(o.raw.length);const c=n.at(-1);(c==null?void 0:c.type)==="paragraph"||(c==null?void 0:c.type)==="text"?(c.raw+=`
`+o.raw,c.text+=`
`+o.raw,this.inlineQueue.at(-1).src=c.text):this.tokens.links[o.tag]||(this.tokens.links[o.tag]={href:o.href,title:o.title});continue}if(o=this.tokenizer.table(t)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.lheading(t)){t=t.substring(o.raw.length),n.push(o);continue}let l=t;if((a=this.options.extensions)!=null&&a.startBlock){let c=1/0;const u=t.slice(1);let d;this.options.extensions.startBlock.forEach(h=>{d=h.call({lexer:this},u),typeof d=="number"&&d>=0&&(c=Math.min(c,d))}),c<1/0&&c>=0&&(l=t.substring(0,c+1))}if(this.state.top&&(o=this.tokenizer.paragraph(l))){const c=n.at(-1);r&&(c==null?void 0:c.type)==="paragraph"?(c.raw+=`
`+o.raw,c.text+=`
`+o.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=c.text):n.push(o),r=l.length!==t.length,t=t.substring(o.raw.length);continue}if(o=this.tokenizer.text(t)){t=t.substring(o.raw.length);const c=n.at(-1);(c==null?void 0:c.type)==="text"?(c.raw+=`
`+o.raw,c.text+=`
`+o.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=c.text):n.push(o);continue}if(t){const c="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(c);break}else throw new Error(c)}}return this.state.top=!0,n}inline(t,n=[]){return this.inlineQueue.push({src:t,tokens:n}),n}inlineTokens(t,n=[]){var o,l,c;let r=t,s=null;if(this.tokens.links){const u=Object.keys(this.tokens.links);if(u.length>0)for(;(s=this.tokenizer.rules.inline.reflinkSearch.exec(r))!=null;)u.includes(s[0].slice(s[0].lastIndexOf("[")+1,-1))&&(r=r.slice(0,s.index)+"["+"a".repeat(s[0].length-2)+"]"+r.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(s=this.tokenizer.rules.inline.anyPunctuation.exec(r))!=null;)r=r.slice(0,s.index)+"++"+r.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;(s=this.tokenizer.rules.inline.blockSkip.exec(r))!=null;)r=r.slice(0,s.index)+"["+"a".repeat(s[0].length-2)+"]"+r.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);let i=!1,a="";for(;t;){i||(a=""),i=!1;let u;if((l=(o=this.options.extensions)==null?void 0:o.inline)!=null&&l.some(h=>(u=h.call({lexer:this},t,n))?(t=t.substring(u.raw.length),n.push(u),!0):!1))continue;if(u=this.tokenizer.escape(t)){t=t.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.tag(t)){t=t.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.link(t)){t=t.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.reflink(t,this.tokens.links)){t=t.substring(u.raw.length);const h=n.at(-1);u.type==="text"&&(h==null?void 0:h.type)==="text"?(h.raw+=u.raw,h.text+=u.text):n.push(u);continue}if(u=this.tokenizer.emStrong(t,r,a)){t=t.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.codespan(t)){t=t.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.br(t)){t=t.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.del(t)){t=t.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.autolink(t)){t=t.substring(u.raw.length),n.push(u);continue}if(!this.state.inLink&&(u=this.tokenizer.url(t))){t=t.substring(u.raw.length),n.push(u);continue}let d=t;if((c=this.options.extensions)!=null&&c.startInline){let h=1/0;const m=t.slice(1);let y;this.options.extensions.startInline.forEach(b=>{y=b.call({lexer:this},m),typeof y=="number"&&y>=0&&(h=Math.min(h,y))}),h<1/0&&h>=0&&(d=t.substring(0,h+1))}if(u=this.tokenizer.inlineText(d)){t=t.substring(u.raw.length),u.raw.slice(-1)!=="_"&&(a=u.raw.slice(-1)),i=!0;const h=n.at(-1);(h==null?void 0:h.type)==="text"?(h.raw+=u.raw,h.text+=u.text):n.push(u);continue}if(t){const h="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(h);break}else throw new Error(h)}}return n}},sE=class{constructor(e){de(this,"options");de(this,"parser");this.options=e||og}space(e){return""}code({text:e,lang:t,escaped:n}){var i;const r=(i=(t||"").match(ro.notSpaceStart))==null?void 0:i[0],s=e.replace(ro.endingNewline,"")+`
`;return r?'<pre><code class="language-'+lu(r)+'">'+(n?s:lu(s,!0))+`</code></pre>
`:"<pre><code>"+(n?s:lu(s,!0))+`</code></pre>
`}blockquote({tokens:e}){return`<blockquote>
${this.parser.parse(e)}</blockquote>
`}html({text:e}){return e}heading({tokens:e,depth:t}){return`<h${t}>${this.parser.parseInline(e)}</h${t}>
`}hr(e){return`<hr>
`}list(e){const t=e.ordered,n=e.start;let r="";for(let a=0;a<e.items.length;a++){const o=e.items[a];r+=this.listitem(o)}const s=t?"ol":"ul",i=t&&n!==1?' start="'+n+'"':"";return"<"+s+i+`>
`+r+"</"+s+`>
`}listitem(e){var n;let t="";if(e.task){const r=this.checkbox({checked:!!e.checked});e.loose?((n=e.tokens[0])==null?void 0:n.type)==="paragraph"?(e.tokens[0].text=r+" "+e.tokens[0].text,e.tokens[0].tokens&&e.tokens[0].tokens.length>0&&e.tokens[0].tokens[0].type==="text"&&(e.tokens[0].tokens[0].text=r+" "+lu(e.tokens[0].tokens[0].text),e.tokens[0].tokens[0].escaped=!0)):e.tokens.unshift({type:"text",raw:r+" ",text:r+" ",escaped:!0}):t+=r+" "}return t+=this.parser.parse(e.tokens,!!e.loose),`<li>${t}</li>
`}checkbox({checked:e}){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:e}){return`<p>${this.parser.parseInline(e)}</p>
`}table(e){let t="",n="";for(let s=0;s<e.header.length;s++)n+=this.tablecell(e.header[s]);t+=this.tablerow({text:n});let r="";for(let s=0;s<e.rows.length;s++){const i=e.rows[s];n="";for(let a=0;a<i.length;a++)n+=this.tablecell(i[a]);r+=this.tablerow({text:n})}return r&&(r=`<tbody>${r}</tbody>`),`<table>
<thead>
`+t+`</thead>
`+r+`</table>
`}tablerow({text:e}){return`<tr>
${e}</tr>
`}tablecell(e){const t=this.parser.parseInline(e.tokens),n=e.header?"th":"td";return(e.align?`<${n} align="${e.align}">`:`<${n}>`)+t+`</${n}>
`}strong({tokens:e}){return`<strong>${this.parser.parseInline(e)}</strong>`}em({tokens:e}){return`<em>${this.parser.parseInline(e)}</em>`}codespan({text:e}){return`<code>${lu(e,!0)}</code>`}br(e){return"<br>"}del({tokens:e}){return`<del>${this.parser.parseInline(e)}</del>`}link({href:e,title:t,tokens:n}){const r=this.parser.parseInline(n),s=xW(e);if(s===null)return r;e=s;let i='<a href="'+e+'"';return t&&(i+=' title="'+lu(t)+'"'),i+=">"+r+"</a>",i}image({href:e,title:t,text:n,tokens:r}){r&&(n=this.parser.parseInline(r,this.parser.textRenderer));const s=xW(e);if(s===null)return lu(n);e=s;let i=`<img src="${e}" alt="${n}"`;return t&&(i+=` title="${lu(t)}"`),i+=">",i}text(e){return"tokens"in e&&e.tokens?this.parser.parseInline(e.tokens):"escaped"in e&&e.escaped?e.text:lu(e.text)}},s5=class{strong({text:e}){return e}em({text:e}){return e}codespan({text:e}){return e}del({text:e}){return e}html({text:e}){return e}text({text:e}){return e}link({text:e}){return""+e}image({text:e}){return""+e}br(){return""}},Pd=class SO{constructor(t){de(this,"options");de(this,"renderer");de(this,"textRenderer");this.options=t||og,this.options.renderer=this.options.renderer||new sE,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new s5}static parse(t,n){return new SO(n).parse(t)}static parseInline(t,n){return new SO(n).parseInline(t)}parse(t,n=!0){var s,i;let r="";for(let a=0;a<t.length;a++){const o=t[a];if((i=(s=this.options.extensions)==null?void 0:s.renderers)!=null&&i[o.type]){const c=o,u=this.options.extensions.renderers[c.type].call({parser:this},c);if(u!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(c.type)){r+=u||"";continue}}const l=o;switch(l.type){case"space":{r+=this.renderer.space(l);continue}case"hr":{r+=this.renderer.hr(l);continue}case"heading":{r+=this.renderer.heading(l);continue}case"code":{r+=this.renderer.code(l);continue}case"table":{r+=this.renderer.table(l);continue}case"blockquote":{r+=this.renderer.blockquote(l);continue}case"list":{r+=this.renderer.list(l);continue}case"html":{r+=this.renderer.html(l);continue}case"paragraph":{r+=this.renderer.paragraph(l);continue}case"text":{let c=l,u=this.renderer.text(c);for(;a+1<t.length&&t[a+1].type==="text";)c=t[++a],u+=`
`+this.renderer.text(c);n?r+=this.renderer.paragraph({type:"paragraph",raw:u,text:u,tokens:[{type:"text",raw:u,text:u,escaped:!0}]}):r+=u;continue}default:{const c='Token with "'+l.type+'" type was not found.';if(this.options.silent)return console.error(c),"";throw new Error(c)}}}return r}parseInline(t,n=this.renderer){var s,i;let r="";for(let a=0;a<t.length;a++){const o=t[a];if((i=(s=this.options.extensions)==null?void 0:s.renderers)!=null&&i[o.type]){const c=this.options.extensions.renderers[o.type].call({parser:this},o);if(c!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(o.type)){r+=c||"";continue}}const l=o;switch(l.type){case"escape":{r+=n.text(l);break}case"html":{r+=n.html(l);break}case"link":{r+=n.link(l);break}case"image":{r+=n.image(l);break}case"strong":{r+=n.strong(l);break}case"em":{r+=n.em(l);break}case"codespan":{r+=n.codespan(l);break}case"br":{r+=n.br(l);break}case"del":{r+=n.del(l);break}case"text":{r+=n.text(l);break}default:{const c='Token with "'+l.type+'" type was not found.';if(this.options.silent)return console.error(c),"";throw new Error(c)}}}return r}},V3,Q2=(V3=class{constructor(e){de(this,"options");de(this,"block");this.options=e||og}preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}provideLexer(){return this.block?Od.lex:Od.lexInline}provideParser(){return this.block?Pd.parse:Pd.parseInline}},de(V3,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens"])),V3),uat=class{constructor(...e){de(this,"defaults",ZF());de(this,"options",this.setOptions);de(this,"parse",this.parseMarkdown(!0));de(this,"parseInline",this.parseMarkdown(!1));de(this,"Parser",Pd);de(this,"Renderer",sE);de(this,"TextRenderer",s5);de(this,"Lexer",Od);de(this,"Tokenizer",rE);de(this,"Hooks",Q2);this.use(...e)}walkTokens(e,t){var r,s;let n=[];for(const i of e)switch(n=n.concat(t.call(this,i)),i.type){case"table":{const a=i;for(const o of a.header)n=n.concat(this.walkTokens(o.tokens,t));for(const o of a.rows)for(const l of o)n=n.concat(this.walkTokens(l.tokens,t));break}case"list":{const a=i;n=n.concat(this.walkTokens(a.items,t));break}default:{const a=i;(s=(r=this.defaults.extensions)==null?void 0:r.childTokens)!=null&&s[a.type]?this.defaults.extensions.childTokens[a.type].forEach(o=>{const l=a[o].flat(1/0);n=n.concat(this.walkTokens(l,t))}):a.tokens&&(n=n.concat(this.walkTokens(a.tokens,t)))}}return n}use(...e){const t=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach(n=>{const r={...n};if(r.async=this.defaults.async||r.async||!1,n.extensions&&(n.extensions.forEach(s=>{if(!s.name)throw new Error("extension name required");if("renderer"in s){const i=t.renderers[s.name];i?t.renderers[s.name]=function(...a){let o=s.renderer.apply(this,a);return o===!1&&(o=i.apply(this,a)),o}:t.renderers[s.name]=s.renderer}if("tokenizer"in s){if(!s.level||s.level!=="block"&&s.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");const i=t[s.level];i?i.unshift(s.tokenizer):t[s.level]=[s.tokenizer],s.start&&(s.level==="block"?t.startBlock?t.startBlock.push(s.start):t.startBlock=[s.start]:s.level==="inline"&&(t.startInline?t.startInline.push(s.start):t.startInline=[s.start]))}"childTokens"in s&&s.childTokens&&(t.childTokens[s.name]=s.childTokens)}),r.extensions=t),n.renderer){const s=this.defaults.renderer||new sE(this.defaults);for(const i in n.renderer){if(!(i in s))throw new Error(`renderer '${i}' does not exist`);if(["options","parser"].includes(i))continue;const a=i,o=n.renderer[a],l=s[a];s[a]=(...c)=>{let u=o.apply(s,c);return u===!1&&(u=l.apply(s,c)),u||""}}r.renderer=s}if(n.tokenizer){const s=this.defaults.tokenizer||new rE(this.defaults);for(const i in n.tokenizer){if(!(i in s))throw new Error(`tokenizer '${i}' does not exist`);if(["options","rules","lexer"].includes(i))continue;const a=i,o=n.tokenizer[a],l=s[a];s[a]=(...c)=>{let u=o.apply(s,c);return u===!1&&(u=l.apply(s,c)),u}}r.tokenizer=s}if(n.hooks){const s=this.defaults.hooks||new Q2;for(const i in n.hooks){if(!(i in s))throw new Error(`hook '${i}' does not exist`);if(["options","block"].includes(i))continue;const a=i,o=n.hooks[a],l=s[a];Q2.passThroughHooks.has(i)?s[a]=c=>{if(this.defaults.async)return Promise.resolve(o.call(s,c)).then(d=>l.call(s,d));const u=o.call(s,c);return l.call(s,u)}:s[a]=(...c)=>{let u=o.apply(s,c);return u===!1&&(u=l.apply(s,c)),u}}r.hooks=s}if(n.walkTokens){const s=this.defaults.walkTokens,i=n.walkTokens;r.walkTokens=function(a){let o=[];return o.push(i.call(this,a)),s&&(o=o.concat(s.call(this,a))),o}}this.defaults={...this.defaults,...r}}),this}setOptions(e){return this.defaults={...this.defaults,...e},this}lexer(e,t){return Od.lex(e,t??this.defaults)}parser(e,t){return Pd.parse(e,t??this.defaults)}parseMarkdown(e){return(n,r)=>{const s={...r},i={...this.defaults,...s},a=this.onError(!!i.silent,!!i.async);if(this.defaults.async===!0&&s.async===!1)return a(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof n>"u"||n===null)return a(new Error("marked(): input parameter is undefined or null"));if(typeof n!="string")return a(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(n)+", string expected"));i.hooks&&(i.hooks.options=i,i.hooks.block=e);const o=i.hooks?i.hooks.provideLexer():e?Od.lex:Od.lexInline,l=i.hooks?i.hooks.provideParser():e?Pd.parse:Pd.parseInline;if(i.async)return Promise.resolve(i.hooks?i.hooks.preprocess(n):n).then(c=>o(c,i)).then(c=>i.hooks?i.hooks.processAllTokens(c):c).then(c=>i.walkTokens?Promise.all(this.walkTokens(c,i.walkTokens)).then(()=>c):c).then(c=>l(c,i)).then(c=>i.hooks?i.hooks.postprocess(c):c).catch(a);try{i.hooks&&(n=i.hooks.preprocess(n));let c=o(n,i);i.hooks&&(c=i.hooks.processAllTokens(c)),i.walkTokens&&this.walkTokens(c,i.walkTokens);let u=l(c,i);return i.hooks&&(u=i.hooks.postprocess(u)),u}catch(c){return a(c)}}}onError(e,t){return n=>{if(n.message+=`
Please report this to https://github.com/markedjs/marked.`,e){const r="<p>An error occurred:</p><pre>"+lu(n.message+"",!0)+"</pre>";return t?Promise.resolve(r):r}if(t)return Promise.reject(n);throw n}}},Bm=new uat;function fs(e,t){return Bm.parse(e,t)}fs.options=fs.setOptions=function(e){return Bm.setOptions(e),fs.defaults=Bm.defaults,tce(fs.defaults),fs};fs.getDefaults=ZF;fs.defaults=og;fs.use=function(...e){return Bm.use(...e),fs.defaults=Bm.defaults,tce(fs.defaults),fs};fs.walkTokens=function(e,t){return Bm.walkTokens(e,t)};fs.parseInline=Bm.parseInline;fs.Parser=Pd;fs.parser=Pd.parse;fs.Renderer=sE;fs.TextRenderer=s5;fs.Lexer=Od;fs.lexer=Od.lex;fs.Tokenizer=rE;fs.Hooks=Q2;fs.parse=fs;fs.options;fs.setOptions;fs.use;fs.walkTokens;fs.parseInline;Pd.parse;Od.lex;function fce(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=Array.from(typeof e=="string"?[e]:e);r[r.length-1]=r[r.length-1].replace(/\r?\n([\t ]*)$/,"");var s=r.reduce(function(o,l){var c=l.match(/\n([\t ]+|(?!\s).)/g);return c?o.concat(c.map(function(u){var d,h;return(h=(d=u.match(/[\t ]/g))===null||d===void 0?void 0:d.length)!==null&&h!==void 0?h:0})):o},[]);if(s.length){var i=new RegExp(`
[	 ]{`+Math.min.apply(Math,s)+"}","g");r=r.map(function(o){return o.replace(i,`
`)})}r[0]=r[0].replace(/^\r?\n/,"");var a=r[0];return t.forEach(function(o,l){var c=a.match(/(?:^|\n)( *)$/),u=c?c[1]:"",d=o;typeof o=="string"&&o.includes(`
`)&&(d=String(o).split(`
`).map(function(h,m){return m===0?h:""+u+h}).join(`
`)),a+=d+r[l+1]}),a}function hce(e,{markdownAutoWrap:t}){const r=e.replace(/<br\/>/g,`
`).replace(/\n{2,}/g,`
`),s=fce(r);return t===!1?s.replace(/ /g,"&nbsp;"):s}ie(hce,"preprocessMarkdown");function pce(e,t={}){const n=hce(e,t),r=fs.lexer(n),s=[[]];let i=0;function a(o,l="normal"){o.type==="text"?o.text.split(`
`).forEach((u,d)=>{d!==0&&(i++,s.push([])),u.split(" ").forEach(h=>{h=h.replace(/&#39;/g,"'"),h&&s[i].push({content:h,type:l})})}):o.type==="strong"||o.type==="em"?o.tokens.forEach(c=>{a(c,o.type)}):o.type==="html"&&s[i].push({content:o.text,type:"normal"})}return ie(a,"processNode"),r.forEach(o=>{var l;o.type==="paragraph"?(l=o.tokens)==null||l.forEach(c=>{a(c)}):o.type==="html"&&s[i].push({content:o.text,type:"normal"})}),s}ie(pce,"markdownToLines");function mce(e,{markdownAutoWrap:t}={}){const n=fs.lexer(e);function r(s){var i,a,o;return s.type==="text"?t===!1?s.text.replace(/\n */g,"<br/>").replace(/ /g,"&nbsp;"):s.text.replace(/\n */g,"<br/>"):s.type==="strong"?`<strong>${(i=s.tokens)==null?void 0:i.map(r).join("")}</strong>`:s.type==="em"?`<em>${(a=s.tokens)==null?void 0:a.map(r).join("")}</em>`:s.type==="paragraph"?`<p>${(o=s.tokens)==null?void 0:o.map(r).join("")}</p>`:s.type==="space"?"":s.type==="html"?`${s.text}`:s.type==="escape"?s.text:`Unsupported markdown: ${s.type}`}return ie(r,"output"),n.map(r).join("")}ie(mce,"markdownToHTML");function gce(e){return Intl.Segmenter?[...new Intl.Segmenter().segment(e)].map(t=>t.segment):[...e]}ie(gce,"splitTextToChars");function yce(e,t){const n=gce(t.content);return i5(e,[],n,t.type)}ie(yce,"splitWordToFitWidth");function i5(e,t,n,r){if(n.length===0)return[{content:t.join(""),type:r},{content:"",type:r}];const[s,...i]=n,a=[...t,s];return e([{content:a.join(""),type:r}])?i5(e,a,i,r):(t.length===0&&s&&(t.push(s),n.shift()),[{content:t.join(""),type:r},{content:n.join(""),type:r}])}ie(i5,"splitWordToFitWidthRecursion");function bce(e,t){if(e.some(({content:n})=>n.includes(`
`)))throw new Error("splitLineToFitWidth does not support newlines in the line");return iE(e,t)}ie(bce,"splitLineToFitWidth");function iE(e,t,n=[],r=[]){if(e.length===0)return r.length>0&&n.push(r),n.length>0?n:[];let s="";e[0].content===" "&&(s=" ",e.shift());const i=e.shift()??{content:" ",type:"normal"},a=[...r];if(s!==""&&a.push({content:s,type:"normal"}),a.push(i),t(a))return iE(e,t,n,a);if(r.length>0)n.push(r),e.unshift(i);else if(i.content){const[o,l]=yce(t,i);n.push([o]),l.content&&e.unshift(l)}return iE(e,t,n)}ie(iE,"splitLineToFitWidthRecursion");function CO(e,t){t&&e.attr("style",t)}ie(CO,"applyStyle");async function vce(e,t,n,r,s=!1){const i=e.append("foreignObject");i.attr("width",`${10*n}px`),i.attr("height",`${10*n}px`);const a=i.append("xhtml:div");let o=t.label;t.label&&Iy(t.label)&&(o=await pF(t.label.replace(_b.lineBreakRegex,`
`),ls()));const l=t.isNode?"nodeLabel":"edgeLabel",c=a.append("span");c.html(o),CO(c,t.labelStyle),c.attr("class",`${l} ${r}`),CO(a,t.labelStyle),a.style("display","table-cell"),a.style("white-space","nowrap"),a.style("line-height","1.5"),a.style("max-width",n+"px"),a.style("text-align","center"),a.attr("xmlns","http://www.w3.org/1999/xhtml"),s&&a.attr("class","labelBkg");let u=a.node().getBoundingClientRect();return u.width===n&&(a.style("display","table"),a.style("white-space","break-spaces"),a.style("width",n+"px"),u=a.node().getBoundingClientRect()),i.node()}ie(vce,"addHtmlSpan");function bA(e,t,n){return e.append("tspan").attr("class","text-outer-tspan").attr("x",0).attr("y",t*n-.1+"em").attr("dy",n+"em")}ie(bA,"createTspan");function xce(e,t,n){const r=e.append("text"),s=bA(r,1,t);vA(s,n);const i=s.node().getComputedTextLength();return r.remove(),i}ie(xce,"computeWidthOfText");function dat(e,t,n){var a;const r=e.append("text"),s=bA(r,1,t);vA(s,[{content:n,type:"normal"}]);const i=(a=s.node())==null?void 0:a.getBoundingClientRect();return i&&r.remove(),i}ie(dat,"computeDimensionOfText");function wce(e,t,n,r=!1){const i=t.append("g"),a=i.insert("rect").attr("class","background").attr("style","stroke: none"),o=i.append("text").attr("y","-10.1");let l=0;for(const c of n){const u=ie(h=>xce(i,1.1,h)<=e,"checkWidth"),d=u(c)?[c]:bce(c,u);for(const h of d){const m=bA(o,l,1.1);vA(m,h),l++}}if(r){const c=o.node().getBBox(),u=2;return a.attr("x",c.x-u).attr("y",c.y-u).attr("width",c.width+2*u).attr("height",c.height+2*u),i.node()}else return o.node()}ie(wce,"createFormattedText");function vA(e,t){e.text(""),t.forEach((n,r)=>{const s=e.append("tspan").attr("font-style",n.type==="em"?"italic":"normal").attr("class","text-inner-tspan").attr("font-weight",n.type==="strong"?"bold":"normal");r===0?s.text(n.content):s.text(" "+n.content)})}ie(vA,"updateTextContentAndStyles");function _ce(e){return e.replace(/fa[bklrs]?:fa-[\w-]+/g,t=>`<i class='${t.replace(":"," ")}'></i>`)}ie(_ce,"replaceIconSubstring");var hp=ie(async(e,t="",{style:n="",isTitle:r=!1,classes:s="",useHtmlLabels:i=!0,isNode:a=!0,width:o=200,addSvgBackground:l=!1}={},c)=>{if(zt.debug("XYZ createText",t,n,r,s,i,a,"addSvgBackground: ",l),i){const u=mce(t,c),d=_ce(ag(u)),h=t.replace(/\\\\/g,"\\"),m={isNode:a,label:Iy(t)?h:d,labelStyle:n.replace("fill:","color:")};return await vce(e,m,o,s,l)}else{const u=t.replace(/<br\s*\/?>/g,"<br/>"),d=pce(u.replace("<br>","<br/>"),c),h=wce(o,e,d,t?l:!1);if(a){/stroke:/.exec(n)&&(n=n.replace("stroke:","lineColor:"));const m=n.replace(/stroke:[^;]+;?/g,"").replace(/stroke-width:[^;]+;?/g,"").replace(/fill:[^;]+;?/g,"").replace(/color:/g,"fill:");Kr(h).attr("style",m)}else{const m=n.replace(/stroke:[^;]+;?/g,"").replace(/stroke-width:[^;]+;?/g,"").replace(/fill:[^;]+;?/g,"").replace(/background:/g,"fill:");Kr(h).select("rect").attr("style",m.replace(/background:/g,"fill:"));const y=n.replace(/stroke:[^;]+;?/g,"").replace(/stroke-width:[^;]+;?/g,"").replace(/fill:[^;]+;?/g,"").replace(/color:/g,"fill:");Kr(h).select("text").attr("style",y)}return h}},"createText");function D3(e,t,n){if(e&&e.length){const[r,s]=t,i=Math.PI/180*n,a=Math.cos(i),o=Math.sin(i);for(const l of e){const[c,u]=l;l[0]=(c-r)*a-(u-s)*o+r,l[1]=(c-r)*o+(u-s)*a+s}}}function fat(e,t){return e[0]===t[0]&&e[1]===t[1]}function hat(e,t,n,r=1){const s=n,i=Math.max(t,.1),a=e[0]&&e[0][0]&&typeof e[0][0]=="number"?[e]:e,o=[0,0];if(s)for(const c of a)D3(c,o,s);const l=function(c,u,d){const h=[];for(const w of c){const S=[...w];fat(S[0],S[S.length-1])||S.push([S[0][0],S[0][1]]),S.length>2&&h.push(S)}const m=[];u=Math.max(u,.1);const y=[];for(const w of h)for(let S=0;S<w.length-1;S++){const k=w[S],C=w[S+1];if(k[1]!==C[1]){const T=Math.min(k[1],C[1]);y.push({ymin:T,ymax:Math.max(k[1],C[1]),x:T===k[1]?k[0]:C[0],islope:(C[0]-k[0])/(C[1]-k[1])})}}if(y.sort((w,S)=>w.ymin<S.ymin?-1:w.ymin>S.ymin?1:w.x<S.x?-1:w.x>S.x?1:w.ymax===S.ymax?0:(w.ymax-S.ymax)/Math.abs(w.ymax-S.ymax)),!y.length)return m;let b=[],v=y[0].ymin,x=0;for(;b.length||y.length;){if(y.length){let w=-1;for(let S=0;S<y.length&&!(y[S].ymin>v);S++)w=S;y.splice(0,w+1).forEach(S=>{b.push({s:v,edge:S})})}if(b=b.filter(w=>!(w.edge.ymax<=v)),b.sort((w,S)=>w.edge.x===S.edge.x?0:(w.edge.x-S.edge.x)/Math.abs(w.edge.x-S.edge.x)),(d!==1||x%u==0)&&b.length>1)for(let w=0;w<b.length;w+=2){const S=w+1;if(S>=b.length)break;const k=b[w].edge,C=b[S].edge;m.push([[Math.round(k.x),v],[Math.round(C.x),v]])}v+=d,b.forEach(w=>{w.edge.x=w.edge.x+d*w.edge.islope}),x++}return m}(a,i,r);if(s){for(const c of a)D3(c,o,-s);(function(c,u,d){const h=[];c.forEach(m=>h.push(...m)),D3(h,u,d)})(l,o,-s)}return l}function y_(e,t){var n;const r=t.hachureAngle+90;let s=t.hachureGap;s<0&&(s=4*t.strokeWidth),s=Math.round(Math.max(s,.1));let i=1;return t.roughness>=1&&(((n=t.randomizer)===null||n===void 0?void 0:n.next())||Math.random())>.7&&(i=s),hat(e,s,r,i||1)}class a5{constructor(t){this.helper=t}fillPolygons(t,n){return this._fillPolygons(t,n)}_fillPolygons(t,n){const r=y_(t,n);return{type:"fillSketch",ops:this.renderLines(r,n)}}renderLines(t,n){const r=[];for(const s of t)r.push(...this.helper.doubleLineOps(s[0][0],s[0][1],s[1][0],s[1][1],n));return r}}function xA(e){const t=e[0],n=e[1];return Math.sqrt(Math.pow(t[0]-n[0],2)+Math.pow(t[1]-n[1],2))}class pat extends a5{fillPolygons(t,n){let r=n.hachureGap;r<0&&(r=4*n.strokeWidth),r=Math.max(r,.1);const s=y_(t,Object.assign({},n,{hachureGap:r})),i=Math.PI/180*n.hachureAngle,a=[],o=.5*r*Math.cos(i),l=.5*r*Math.sin(i);for(const[c,u]of s)xA([c,u])&&a.push([[c[0]-o,c[1]+l],[...u]],[[c[0]+o,c[1]-l],[...u]]);return{type:"fillSketch",ops:this.renderLines(a,n)}}}class mat extends a5{fillPolygons(t,n){const r=this._fillPolygons(t,n),s=Object.assign({},n,{hachureAngle:n.hachureAngle+90}),i=this._fillPolygons(t,s);return r.ops=r.ops.concat(i.ops),r}}class gat{constructor(t){this.helper=t}fillPolygons(t,n){const r=y_(t,n=Object.assign({},n,{hachureAngle:0}));return this.dotsOnLines(r,n)}dotsOnLines(t,n){const r=[];let s=n.hachureGap;s<0&&(s=4*n.strokeWidth),s=Math.max(s,.1);let i=n.fillWeight;i<0&&(i=n.strokeWidth/2);const a=s/4;for(const o of t){const l=xA(o),c=l/s,u=Math.ceil(c)-1,d=l-u*s,h=(o[0][0]+o[1][0])/2-s/4,m=Math.min(o[0][1],o[1][1]);for(let y=0;y<u;y++){const b=m+d+y*s,v=h-a+2*Math.random()*a,x=b-a+2*Math.random()*a,w=this.helper.ellipse(v,x,i,i,n);r.push(...w.ops)}}return{type:"fillSketch",ops:r}}}class yat{constructor(t){this.helper=t}fillPolygons(t,n){const r=y_(t,n);return{type:"fillSketch",ops:this.dashedLine(r,n)}}dashedLine(t,n){const r=n.dashOffset<0?n.hachureGap<0?4*n.strokeWidth:n.hachureGap:n.dashOffset,s=n.dashGap<0?n.hachureGap<0?4*n.strokeWidth:n.hachureGap:n.dashGap,i=[];return t.forEach(a=>{const o=xA(a),l=Math.floor(o/(r+s)),c=(o+s-l*(r+s))/2;let u=a[0],d=a[1];u[0]>d[0]&&(u=a[1],d=a[0]);const h=Math.atan((d[1]-u[1])/(d[0]-u[0]));for(let m=0;m<l;m++){const y=m*(r+s),b=y+r,v=[u[0]+y*Math.cos(h)+c*Math.cos(h),u[1]+y*Math.sin(h)+c*Math.sin(h)],x=[u[0]+b*Math.cos(h)+c*Math.cos(h),u[1]+b*Math.sin(h)+c*Math.sin(h)];i.push(...this.helper.doubleLineOps(v[0],v[1],x[0],x[1],n))}}),i}}class bat{constructor(t){this.helper=t}fillPolygons(t,n){const r=n.hachureGap<0?4*n.strokeWidth:n.hachureGap,s=n.zigzagOffset<0?r:n.zigzagOffset,i=y_(t,n=Object.assign({},n,{hachureGap:r+s}));return{type:"fillSketch",ops:this.zigzagLines(i,s,n)}}zigzagLines(t,n,r){const s=[];return t.forEach(i=>{const a=xA(i),o=Math.round(a/(2*n));let l=i[0],c=i[1];l[0]>c[0]&&(l=i[1],c=i[0]);const u=Math.atan((c[1]-l[1])/(c[0]-l[0]));for(let d=0;d<o;d++){const h=2*d*n,m=2*(d+1)*n,y=Math.sqrt(2*Math.pow(n,2)),b=[l[0]+h*Math.cos(u),l[1]+h*Math.sin(u)],v=[l[0]+m*Math.cos(u),l[1]+m*Math.sin(u)],x=[b[0]+y*Math.cos(u+Math.PI/4),b[1]+y*Math.sin(u+Math.PI/4)];s.push(...this.helper.doubleLineOps(b[0],b[1],x[0],x[1],r),...this.helper.doubleLineOps(x[0],x[1],v[0],v[1],r))}}),s}}const wo={};class vat{constructor(t){this.seed=t}next(){return this.seed?(2**31-1&(this.seed=Math.imul(48271,this.seed)))/2**31:Math.random()}}const xat=0,F3=1,SW=2,S2={A:7,a:7,C:6,c:6,H:1,h:1,L:2,l:2,M:2,m:2,Q:4,q:4,S:4,s:4,T:2,t:2,V:1,v:1,Z:0,z:0};function L3(e,t){return e.type===t}function o5(e){const t=[],n=function(a){const o=new Array;for(;a!=="";)if(a.match(/^([ \t\r\n,]+)/))a=a.substr(RegExp.$1.length);else if(a.match(/^([aAcChHlLmMqQsStTvVzZ])/))o[o.length]={type:xat,text:RegExp.$1},a=a.substr(RegExp.$1.length);else{if(!a.match(/^(([-+]?[0-9]+(\.[0-9]*)?|[-+]?\.[0-9]+)([eE][-+]?[0-9]+)?)/))return[];o[o.length]={type:F3,text:`${parseFloat(RegExp.$1)}`},a=a.substr(RegExp.$1.length)}return o[o.length]={type:SW,text:""},o}(e);let r="BOD",s=0,i=n[s];for(;!L3(i,SW);){let a=0;const o=[];if(r==="BOD"){if(i.text!=="M"&&i.text!=="m")return o5("M0,0"+e);s++,a=S2[i.text],r=i.text}else L3(i,F3)?a=S2[r]:(s++,a=S2[i.text],r=i.text);if(!(s+a<n.length))throw new Error("Path data ended short");for(let l=s;l<s+a;l++){const c=n[l];if(!L3(c,F3))throw new Error("Param not a number: "+r+","+c.text);o[o.length]=+c.text}if(typeof S2[r]!="number")throw new Error("Bad segment: "+r);{const l={key:r,data:o};t.push(l),s+=a,i=n[s],r==="M"&&(r="L"),r==="m"&&(r="l")}}return t}function Sce(e){let t=0,n=0,r=0,s=0;const i=[];for(const{key:a,data:o}of e)switch(a){case"M":i.push({key:"M",data:[...o]}),[t,n]=o,[r,s]=o;break;case"m":t+=o[0],n+=o[1],i.push({key:"M",data:[t,n]}),r=t,s=n;break;case"L":i.push({key:"L",data:[...o]}),[t,n]=o;break;case"l":t+=o[0],n+=o[1],i.push({key:"L",data:[t,n]});break;case"C":i.push({key:"C",data:[...o]}),t=o[4],n=o[5];break;case"c":{const l=o.map((c,u)=>u%2?c+n:c+t);i.push({key:"C",data:l}),t=l[4],n=l[5];break}case"Q":i.push({key:"Q",data:[...o]}),t=o[2],n=o[3];break;case"q":{const l=o.map((c,u)=>u%2?c+n:c+t);i.push({key:"Q",data:l}),t=l[2],n=l[3];break}case"A":i.push({key:"A",data:[...o]}),t=o[5],n=o[6];break;case"a":t+=o[5],n+=o[6],i.push({key:"A",data:[o[0],o[1],o[2],o[3],o[4],t,n]});break;case"H":i.push({key:"H",data:[...o]}),t=o[0];break;case"h":t+=o[0],i.push({key:"H",data:[t]});break;case"V":i.push({key:"V",data:[...o]}),n=o[0];break;case"v":n+=o[0],i.push({key:"V",data:[n]});break;case"S":i.push({key:"S",data:[...o]}),t=o[2],n=o[3];break;case"s":{const l=o.map((c,u)=>u%2?c+n:c+t);i.push({key:"S",data:l}),t=l[2],n=l[3];break}case"T":i.push({key:"T",data:[...o]}),t=o[0],n=o[1];break;case"t":t+=o[0],n+=o[1],i.push({key:"T",data:[t,n]});break;case"Z":case"z":i.push({key:"Z",data:[]}),t=r,n=s}return i}function Cce(e){const t=[];let n="",r=0,s=0,i=0,a=0,o=0,l=0;for(const{key:c,data:u}of e){switch(c){case"M":t.push({key:"M",data:[...u]}),[r,s]=u,[i,a]=u;break;case"C":t.push({key:"C",data:[...u]}),r=u[4],s=u[5],o=u[2],l=u[3];break;case"L":t.push({key:"L",data:[...u]}),[r,s]=u;break;case"H":r=u[0],t.push({key:"L",data:[r,s]});break;case"V":s=u[0],t.push({key:"L",data:[r,s]});break;case"S":{let d=0,h=0;n==="C"||n==="S"?(d=r+(r-o),h=s+(s-l)):(d=r,h=s),t.push({key:"C",data:[d,h,...u]}),o=u[0],l=u[1],r=u[2],s=u[3];break}case"T":{const[d,h]=u;let m=0,y=0;n==="Q"||n==="T"?(m=r+(r-o),y=s+(s-l)):(m=r,y=s);const b=r+2*(m-r)/3,v=s+2*(y-s)/3,x=d+2*(m-d)/3,w=h+2*(y-h)/3;t.push({key:"C",data:[b,v,x,w,d,h]}),o=m,l=y,r=d,s=h;break}case"Q":{const[d,h,m,y]=u,b=r+2*(d-r)/3,v=s+2*(h-s)/3,x=m+2*(d-m)/3,w=y+2*(h-y)/3;t.push({key:"C",data:[b,v,x,w,m,y]}),o=d,l=h,r=m,s=y;break}case"A":{const d=Math.abs(u[0]),h=Math.abs(u[1]),m=u[2],y=u[3],b=u[4],v=u[5],x=u[6];d===0||h===0?(t.push({key:"C",data:[r,s,v,x,v,x]}),r=v,s=x):(r!==v||s!==x)&&(kce(r,s,v,x,d,h,m,y,b).forEach(function(w){t.push({key:"C",data:w})}),r=v,s=x);break}case"Z":t.push({key:"Z",data:[]}),r=i,s=a}n=c}return t}function tx(e,t,n){return[e*Math.cos(n)-t*Math.sin(n),e*Math.sin(n)+t*Math.cos(n)]}function kce(e,t,n,r,s,i,a,o,l,c){const u=(d=a,Math.PI*d/180);var d;let h=[],m=0,y=0,b=0,v=0;if(c)[m,y,b,v]=c;else{[e,t]=tx(e,t,-u),[n,r]=tx(n,r,-u);const W=(e-n)/2,O=(t-r)/2;let Z=W*W/(s*s)+O*O/(i*i);Z>1&&(Z=Math.sqrt(Z),s*=Z,i*=Z);const U=s*s,H=i*i,L=U*H-U*O*O-H*W*W,te=U*O*O+H*W*W,V=(o===l?-1:1)*Math.sqrt(Math.abs(L/te));b=V*s*O/i+(e+n)/2,v=V*-i*W/s+(t+r)/2,m=Math.asin(parseFloat(((t-v)/i).toFixed(9))),y=Math.asin(parseFloat(((r-v)/i).toFixed(9))),e<b&&(m=Math.PI-m),n<b&&(y=Math.PI-y),m<0&&(m=2*Math.PI+m),y<0&&(y=2*Math.PI+y),l&&m>y&&(m-=2*Math.PI),!l&&y>m&&(y-=2*Math.PI)}let x=y-m;if(Math.abs(x)>120*Math.PI/180){const W=y,O=n,Z=r;y=l&&y>m?m+120*Math.PI/180*1:m+120*Math.PI/180*-1,h=kce(n=b+s*Math.cos(y),r=v+i*Math.sin(y),O,Z,s,i,a,0,l,[y,W,b,v])}x=y-m;const w=Math.cos(m),S=Math.sin(m),k=Math.cos(y),C=Math.sin(y),T=Math.tan(x/4),R=4/3*s*T,N=4/3*i*T,I=[e,t],P=[e+R*S,t-N*w],B=[n+R*C,r-N*k],D=[n,r];if(P[0]=2*I[0]-P[0],P[1]=2*I[1]-P[1],c)return[P,B,D].concat(h);{h=[P,B,D].concat(h);const W=[];for(let O=0;O<h.length;O+=3){const Z=tx(h[O][0],h[O][1],u),U=tx(h[O+1][0],h[O+1][1],u),H=tx(h[O+2][0],h[O+2][1],u);W.push([Z[0],Z[1],U[0],U[1],H[0],H[1]])}return W}}const wat={randOffset:function(e,t){return tr(e,t)},randOffsetWithRange:function(e,t,n){return aE(e,t,n)},ellipse:function(e,t,n,r,s){const i=Tce(n,r,s);return kO(e,t,s,i).opset},doubleLineOps:function(e,t,n,r,s){return Fh(e,t,n,r,s,!0)}};function Ece(e,t,n,r,s){return{type:"path",ops:Fh(e,t,n,r,s)}}function eC(e,t,n){const r=(e||[]).length;if(r>2){const s=[];for(let i=0;i<r-1;i++)s.push(...Fh(e[i][0],e[i][1],e[i+1][0],e[i+1][1],n));return t&&s.push(...Fh(e[r-1][0],e[r-1][1],e[0][0],e[0][1],n)),{type:"path",ops:s}}return r===2?Ece(e[0][0],e[0][1],e[1][0],e[1][1],n):{type:"path",ops:[]}}function _at(e,t,n,r,s){return function(i,a){return eC(i,!0,a)}([[e,t],[e+n,t],[e+n,t+r],[e,t+r]],s)}function CW(e,t){if(e.length){const n=typeof e[0][0]=="number"?[e]:e,r=C2(n[0],1*(1+.2*t.roughness),t),s=t.disableMultiStroke?[]:C2(n[0],1.5*(1+.22*t.roughness),TW(t));for(let i=1;i<n.length;i++){const a=n[i];if(a.length){const o=C2(a,1*(1+.2*t.roughness),t),l=t.disableMultiStroke?[]:C2(a,1.5*(1+.22*t.roughness),TW(t));for(const c of o)c.op!=="move"&&r.push(c);for(const c of l)c.op!=="move"&&s.push(c)}}return{type:"path",ops:r.concat(s)}}return{type:"path",ops:[]}}function Tce(e,t,n){const r=Math.sqrt(2*Math.PI*Math.sqrt((Math.pow(e/2,2)+Math.pow(t/2,2))/2)),s=Math.ceil(Math.max(n.curveStepCount,n.curveStepCount/Math.sqrt(200)*r)),i=2*Math.PI/s;let a=Math.abs(e/2),o=Math.abs(t/2);const l=1-n.curveFitting;return a+=tr(a*l,n),o+=tr(o*l,n),{increment:i,rx:a,ry:o}}function kO(e,t,n,r){const[s,i]=AW(r.increment,e,t,r.rx,r.ry,1,r.increment*aE(.1,aE(.4,1,n),n),n);let a=oE(s,null,n);if(!n.disableMultiStroke&&n.roughness!==0){const[o]=AW(r.increment,e,t,r.rx,r.ry,1.5,0,n),l=oE(o,null,n);a=a.concat(l)}return{estimatedPoints:i,opset:{type:"path",ops:a}}}function kW(e,t,n,r,s,i,a,o,l){const c=e,u=t;let d=Math.abs(n/2),h=Math.abs(r/2);d+=tr(.01*d,l),h+=tr(.01*h,l);let m=s,y=i;for(;m<0;)m+=2*Math.PI,y+=2*Math.PI;y-m>2*Math.PI&&(m=0,y=2*Math.PI);const b=2*Math.PI/l.curveStepCount,v=Math.min(b/2,(y-m)/2),x=RW(v,c,u,d,h,m,y,1,l);if(!l.disableMultiStroke){const w=RW(v,c,u,d,h,m,y,1.5,l);x.push(...w)}return a&&(o?x.push(...Fh(c,u,c+d*Math.cos(m),u+h*Math.sin(m),l),...Fh(c,u,c+d*Math.cos(y),u+h*Math.sin(y),l)):x.push({op:"lineTo",data:[c,u]},{op:"lineTo",data:[c+d*Math.cos(m),u+h*Math.sin(m)]})),{type:"path",ops:x}}function EW(e,t){const n=Cce(Sce(o5(e))),r=[];let s=[0,0],i=[0,0];for(const{key:a,data:o}of n)switch(a){case"M":i=[o[0],o[1]],s=[o[0],o[1]];break;case"L":r.push(...Fh(i[0],i[1],o[0],o[1],t)),i=[o[0],o[1]];break;case"C":{const[l,c,u,d,h,m]=o;r.push(...Sat(l,c,u,d,h,m,i,t)),i=[h,m];break}case"Z":r.push(...Fh(i[0],i[1],s[0],s[1],t)),i=[s[0],s[1]]}return{type:"path",ops:r}}function B3(e,t){const n=[];for(const r of e)if(r.length){const s=t.maxRandomnessOffset||0,i=r.length;if(i>2){n.push({op:"move",data:[r[0][0]+tr(s,t),r[0][1]+tr(s,t)]});for(let a=1;a<i;a++)n.push({op:"lineTo",data:[r[a][0]+tr(s,t),r[a][1]+tr(s,t)]})}}return{type:"fillPath",ops:n}}function u0(e,t){return function(n,r){let s=n.fillStyle||"hachure";if(!wo[s])switch(s){case"zigzag":wo[s]||(wo[s]=new pat(r));break;case"cross-hatch":wo[s]||(wo[s]=new mat(r));break;case"dots":wo[s]||(wo[s]=new gat(r));break;case"dashed":wo[s]||(wo[s]=new yat(r));break;case"zigzag-line":wo[s]||(wo[s]=new bat(r));break;default:s="hachure",wo[s]||(wo[s]=new a5(r))}return wo[s]}(t,wat).fillPolygons(e,t)}function TW(e){const t=Object.assign({},e);return t.randomizer=void 0,e.seed&&(t.seed=e.seed+1),t}function Ace(e){return e.randomizer||(e.randomizer=new vat(e.seed||0)),e.randomizer.next()}function aE(e,t,n,r=1){return n.roughness*r*(Ace(n)*(t-e)+e)}function tr(e,t,n=1){return aE(-e,e,t,n)}function Fh(e,t,n,r,s,i=!1){const a=i?s.disableMultiStrokeFill:s.disableMultiStroke,o=EO(e,t,n,r,s,!0,!1);if(a)return o;const l=EO(e,t,n,r,s,!0,!0);return o.concat(l)}function EO(e,t,n,r,s,i,a){const o=Math.pow(e-n,2)+Math.pow(t-r,2),l=Math.sqrt(o);let c=1;c=l<200?1:l>500?.4:-.0016668*l+1.233334;let u=s.maxRandomnessOffset||0;u*u*100>o&&(u=l/10);const d=u/2,h=.2+.2*Ace(s);let m=s.bowing*s.maxRandomnessOffset*(r-t)/200,y=s.bowing*s.maxRandomnessOffset*(e-n)/200;m=tr(m,s,c),y=tr(y,s,c);const b=[],v=()=>tr(d,s,c),x=()=>tr(u,s,c),w=s.preserveVertices;return a?b.push({op:"move",data:[e+(w?0:v()),t+(w?0:v())]}):b.push({op:"move",data:[e+(w?0:tr(u,s,c)),t+(w?0:tr(u,s,c))]}),a?b.push({op:"bcurveTo",data:[m+e+(n-e)*h+v(),y+t+(r-t)*h+v(),m+e+2*(n-e)*h+v(),y+t+2*(r-t)*h+v(),n+(w?0:v()),r+(w?0:v())]}):b.push({op:"bcurveTo",data:[m+e+(n-e)*h+x(),y+t+(r-t)*h+x(),m+e+2*(n-e)*h+x(),y+t+2*(r-t)*h+x(),n+(w?0:x()),r+(w?0:x())]}),b}function C2(e,t,n){if(!e.length)return[];const r=[];r.push([e[0][0]+tr(t,n),e[0][1]+tr(t,n)]),r.push([e[0][0]+tr(t,n),e[0][1]+tr(t,n)]);for(let s=1;s<e.length;s++)r.push([e[s][0]+tr(t,n),e[s][1]+tr(t,n)]),s===e.length-1&&r.push([e[s][0]+tr(t,n),e[s][1]+tr(t,n)]);return oE(r,null,n)}function oE(e,t,n){const r=e.length,s=[];if(r>3){const i=[],a=1-n.curveTightness;s.push({op:"move",data:[e[1][0],e[1][1]]});for(let o=1;o+2<r;o++){const l=e[o];i[0]=[l[0],l[1]],i[1]=[l[0]+(a*e[o+1][0]-a*e[o-1][0])/6,l[1]+(a*e[o+1][1]-a*e[o-1][1])/6],i[2]=[e[o+1][0]+(a*e[o][0]-a*e[o+2][0])/6,e[o+1][1]+(a*e[o][1]-a*e[o+2][1])/6],i[3]=[e[o+1][0],e[o+1][1]],s.push({op:"bcurveTo",data:[i[1][0],i[1][1],i[2][0],i[2][1],i[3][0],i[3][1]]})}}else r===3?(s.push({op:"move",data:[e[1][0],e[1][1]]}),s.push({op:"bcurveTo",data:[e[1][0],e[1][1],e[2][0],e[2][1],e[2][0],e[2][1]]})):r===2&&s.push(...EO(e[0][0],e[0][1],e[1][0],e[1][1],n,!0,!0));return s}function AW(e,t,n,r,s,i,a,o){const l=[],c=[];if(o.roughness===0){e/=4,c.push([t+r*Math.cos(-e),n+s*Math.sin(-e)]);for(let u=0;u<=2*Math.PI;u+=e){const d=[t+r*Math.cos(u),n+s*Math.sin(u)];l.push(d),c.push(d)}c.push([t+r*Math.cos(0),n+s*Math.sin(0)]),c.push([t+r*Math.cos(e),n+s*Math.sin(e)])}else{const u=tr(.5,o)-Math.PI/2;c.push([tr(i,o)+t+.9*r*Math.cos(u-e),tr(i,o)+n+.9*s*Math.sin(u-e)]);const d=2*Math.PI+u-.01;for(let h=u;h<d;h+=e){const m=[tr(i,o)+t+r*Math.cos(h),tr(i,o)+n+s*Math.sin(h)];l.push(m),c.push(m)}c.push([tr(i,o)+t+r*Math.cos(u+2*Math.PI+.5*a),tr(i,o)+n+s*Math.sin(u+2*Math.PI+.5*a)]),c.push([tr(i,o)+t+.98*r*Math.cos(u+a),tr(i,o)+n+.98*s*Math.sin(u+a)]),c.push([tr(i,o)+t+.9*r*Math.cos(u+.5*a),tr(i,o)+n+.9*s*Math.sin(u+.5*a)])}return[c,l]}function RW(e,t,n,r,s,i,a,o,l){const c=i+tr(.1,l),u=[];u.push([tr(o,l)+t+.9*r*Math.cos(c-e),tr(o,l)+n+.9*s*Math.sin(c-e)]);for(let d=c;d<=a;d+=e)u.push([tr(o,l)+t+r*Math.cos(d),tr(o,l)+n+s*Math.sin(d)]);return u.push([t+r*Math.cos(a),n+s*Math.sin(a)]),u.push([t+r*Math.cos(a),n+s*Math.sin(a)]),oE(u,null,l)}function Sat(e,t,n,r,s,i,a,o){const l=[],c=[o.maxRandomnessOffset||1,(o.maxRandomnessOffset||1)+.3];let u=[0,0];const d=o.disableMultiStroke?1:2,h=o.preserveVertices;for(let m=0;m<d;m++)m===0?l.push({op:"move",data:[a[0],a[1]]}):l.push({op:"move",data:[a[0]+(h?0:tr(c[0],o)),a[1]+(h?0:tr(c[0],o))]}),u=h?[s,i]:[s+tr(c[m],o),i+tr(c[m],o)],l.push({op:"bcurveTo",data:[e+tr(c[m],o),t+tr(c[m],o),n+tr(c[m],o),r+tr(c[m],o),u[0],u[1]]});return l}function nx(e){return[...e]}function NW(e,t=0){const n=e.length;if(n<3)throw new Error("A curve must have at least three points.");const r=[];if(n===3)r.push(nx(e[0]),nx(e[1]),nx(e[2]),nx(e[2]));else{const s=[];s.push(e[0],e[0]);for(let o=1;o<e.length;o++)s.push(e[o]),o===e.length-1&&s.push(e[o]);const i=[],a=1-t;r.push(nx(s[0]));for(let o=1;o+2<s.length;o++){const l=s[o];i[0]=[l[0],l[1]],i[1]=[l[0]+(a*s[o+1][0]-a*s[o-1][0])/6,l[1]+(a*s[o+1][1]-a*s[o-1][1])/6],i[2]=[s[o+1][0]+(a*s[o][0]-a*s[o+2][0])/6,s[o+1][1]+(a*s[o][1]-a*s[o+2][1])/6],i[3]=[s[o+1][0],s[o+1][1]],r.push(i[1],i[2],i[3])}}return r}function tC(e,t){return Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2)}function Cat(e,t,n){const r=tC(t,n);if(r===0)return tC(e,t);let s=((e[0]-t[0])*(n[0]-t[0])+(e[1]-t[1])*(n[1]-t[1]))/r;return s=Math.max(0,Math.min(1,s)),tC(e,Kp(t,n,s))}function Kp(e,t,n){return[e[0]+(t[0]-e[0])*n,e[1]+(t[1]-e[1])*n]}function TO(e,t,n,r){const s=r||[];if(function(o,l){const c=o[l+0],u=o[l+1],d=o[l+2],h=o[l+3];let m=3*u[0]-2*c[0]-h[0];m*=m;let y=3*u[1]-2*c[1]-h[1];y*=y;let b=3*d[0]-2*h[0]-c[0];b*=b;let v=3*d[1]-2*h[1]-c[1];return v*=v,m<b&&(m=b),y<v&&(y=v),m+y}(e,t)<n){const o=e[t+0];s.length?(i=s[s.length-1],a=o,Math.sqrt(tC(i,a))>1&&s.push(o)):s.push(o),s.push(e[t+3])}else{const l=e[t+0],c=e[t+1],u=e[t+2],d=e[t+3],h=Kp(l,c,.5),m=Kp(c,u,.5),y=Kp(u,d,.5),b=Kp(h,m,.5),v=Kp(m,y,.5),x=Kp(b,v,.5);TO([l,h,b,x],0,n,s),TO([x,v,y,d],0,n,s)}var i,a;return s}function kat(e,t){return lE(e,0,e.length,t)}function lE(e,t,n,r,s){const i=s||[],a=e[t],o=e[n-1];let l=0,c=1;for(let u=t+1;u<n-1;++u){const d=Cat(e[u],a,o);d>l&&(l=d,c=u)}return Math.sqrt(l)>r?(lE(e,t,c+1,r,i),lE(e,c,n,r,i)):(i.length||i.push(a),i.push(o)),i}function $3(e,t=.15,n){const r=[],s=(e.length-1)/3;for(let i=0;i<s;i++)TO(e,3*i,t,r);return n&&n>0?lE(r,0,r.length,n):r}const sl="none";class cE{constructor(t){this.defaultOptions={maxRandomnessOffset:2,roughness:1,bowing:1,stroke:"#000",strokeWidth:1,curveTightness:0,curveFitting:.95,curveStepCount:9,fillStyle:"hachure",fillWeight:-1,hachureAngle:-41,hachureGap:-1,dashOffset:-1,dashGap:-1,zigzagOffset:-1,seed:0,disableMultiStroke:!1,disableMultiStrokeFill:!1,preserveVertices:!1,fillShapeRoughnessGain:.8},this.config=t||{},this.config.options&&(this.defaultOptions=this._o(this.config.options))}static newSeed(){return Math.floor(Math.random()*2**31)}_o(t){return t?Object.assign({},this.defaultOptions,t):this.defaultOptions}_d(t,n,r){return{shape:t,sets:n||[],options:r||this.defaultOptions}}line(t,n,r,s,i){const a=this._o(i);return this._d("line",[Ece(t,n,r,s,a)],a)}rectangle(t,n,r,s,i){const a=this._o(i),o=[],l=_at(t,n,r,s,a);if(a.fill){const c=[[t,n],[t+r,n],[t+r,n+s],[t,n+s]];a.fillStyle==="solid"?o.push(B3([c],a)):o.push(u0([c],a))}return a.stroke!==sl&&o.push(l),this._d("rectangle",o,a)}ellipse(t,n,r,s,i){const a=this._o(i),o=[],l=Tce(r,s,a),c=kO(t,n,a,l);if(a.fill)if(a.fillStyle==="solid"){const u=kO(t,n,a,l).opset;u.type="fillPath",o.push(u)}else o.push(u0([c.estimatedPoints],a));return a.stroke!==sl&&o.push(c.opset),this._d("ellipse",o,a)}circle(t,n,r,s){const i=this.ellipse(t,n,r,r,s);return i.shape="circle",i}linearPath(t,n){const r=this._o(n);return this._d("linearPath",[eC(t,!1,r)],r)}arc(t,n,r,s,i,a,o=!1,l){const c=this._o(l),u=[],d=kW(t,n,r,s,i,a,o,!0,c);if(o&&c.fill)if(c.fillStyle==="solid"){const h=Object.assign({},c);h.disableMultiStroke=!0;const m=kW(t,n,r,s,i,a,!0,!1,h);m.type="fillPath",u.push(m)}else u.push(function(h,m,y,b,v,x,w){const S=h,k=m;let C=Math.abs(y/2),T=Math.abs(b/2);C+=tr(.01*C,w),T+=tr(.01*T,w);let R=v,N=x;for(;R<0;)R+=2*Math.PI,N+=2*Math.PI;N-R>2*Math.PI&&(R=0,N=2*Math.PI);const I=(N-R)/w.curveStepCount,P=[];for(let B=R;B<=N;B+=I)P.push([S+C*Math.cos(B),k+T*Math.sin(B)]);return P.push([S+C*Math.cos(N),k+T*Math.sin(N)]),P.push([S,k]),u0([P],w)}(t,n,r,s,i,a,c));return c.stroke!==sl&&u.push(d),this._d("arc",u,c)}curve(t,n){const r=this._o(n),s=[],i=CW(t,r);if(r.fill&&r.fill!==sl)if(r.fillStyle==="solid"){const a=CW(t,Object.assign(Object.assign({},r),{disableMultiStroke:!0,roughness:r.roughness?r.roughness+r.fillShapeRoughnessGain:0}));s.push({type:"fillPath",ops:this._mergedShape(a.ops)})}else{const a=[],o=t;if(o.length){const l=typeof o[0][0]=="number"?[o]:o;for(const c of l)c.length<3?a.push(...c):c.length===3?a.push(...$3(NW([c[0],c[0],c[1],c[2]]),10,(1+r.roughness)/2)):a.push(...$3(NW(c),10,(1+r.roughness)/2))}a.length&&s.push(u0([a],r))}return r.stroke!==sl&&s.push(i),this._d("curve",s,r)}polygon(t,n){const r=this._o(n),s=[],i=eC(t,!0,r);return r.fill&&(r.fillStyle==="solid"?s.push(B3([t],r)):s.push(u0([t],r))),r.stroke!==sl&&s.push(i),this._d("polygon",s,r)}path(t,n){const r=this._o(n),s=[];if(!t)return this._d("path",s,r);t=(t||"").replace(/\n/g," ").replace(/(-\s)/g,"-").replace("/(ss)/g"," ");const i=r.fill&&r.fill!=="transparent"&&r.fill!==sl,a=r.stroke!==sl,o=!!(r.simplification&&r.simplification<1),l=function(u,d,h){const m=Cce(Sce(o5(u))),y=[];let b=[],v=[0,0],x=[];const w=()=>{x.length>=4&&b.push(...$3(x,d)),x=[]},S=()=>{w(),b.length&&(y.push(b),b=[])};for(const{key:C,data:T}of m)switch(C){case"M":S(),v=[T[0],T[1]],b.push(v);break;case"L":w(),b.push([T[0],T[1]]);break;case"C":if(!x.length){const R=b.length?b[b.length-1]:v;x.push([R[0],R[1]])}x.push([T[0],T[1]]),x.push([T[2],T[3]]),x.push([T[4],T[5]]);break;case"Z":w(),b.push([v[0],v[1]])}if(S(),!h)return y;const k=[];for(const C of y){const T=kat(C,h);T.length&&k.push(T)}return k}(t,1,o?4-4*(r.simplification||1):(1+r.roughness)/2),c=EW(t,r);if(i)if(r.fillStyle==="solid")if(l.length===1){const u=EW(t,Object.assign(Object.assign({},r),{disableMultiStroke:!0,roughness:r.roughness?r.roughness+r.fillShapeRoughnessGain:0}));s.push({type:"fillPath",ops:this._mergedShape(u.ops)})}else s.push(B3(l,r));else s.push(u0(l,r));return a&&(o?l.forEach(u=>{s.push(eC(u,!1,r))}):s.push(c)),this._d("path",s,r)}opsToPath(t,n){let r="";for(const s of t.ops){const i=typeof n=="number"&&n>=0?s.data.map(a=>+a.toFixed(n)):s.data;switch(s.op){case"move":r+=`M${i[0]} ${i[1]} `;break;case"bcurveTo":r+=`C${i[0]} ${i[1]}, ${i[2]} ${i[3]}, ${i[4]} ${i[5]} `;break;case"lineTo":r+=`L${i[0]} ${i[1]} `}}return r.trim()}toPaths(t){const n=t.sets||[],r=t.options||this.defaultOptions,s=[];for(const i of n){let a=null;switch(i.type){case"path":a={d:this.opsToPath(i),stroke:r.stroke,strokeWidth:r.strokeWidth,fill:sl};break;case"fillPath":a={d:this.opsToPath(i),stroke:sl,strokeWidth:0,fill:r.fill||sl};break;case"fillSketch":a=this.fillSketch(i,r)}a&&s.push(a)}return s}fillSketch(t,n){let r=n.fillWeight;return r<0&&(r=n.strokeWidth/2),{d:this.opsToPath(t),stroke:n.fill||sl,strokeWidth:r,fill:sl}}_mergedShape(t){return t.filter((n,r)=>r===0||n.op!=="move")}}class Eat{constructor(t,n){this.canvas=t,this.ctx=this.canvas.getContext("2d"),this.gen=new cE(n)}draw(t){const n=t.sets||[],r=t.options||this.getDefaultOptions(),s=this.ctx,i=t.options.fixedDecimalPlaceDigits;for(const a of n)switch(a.type){case"path":s.save(),s.strokeStyle=r.stroke==="none"?"transparent":r.stroke,s.lineWidth=r.strokeWidth,r.strokeLineDash&&s.setLineDash(r.strokeLineDash),r.strokeLineDashOffset&&(s.lineDashOffset=r.strokeLineDashOffset),this._drawToContext(s,a,i),s.restore();break;case"fillPath":{s.save(),s.fillStyle=r.fill||"";const o=t.shape==="curve"||t.shape==="polygon"||t.shape==="path"?"evenodd":"nonzero";this._drawToContext(s,a,i,o),s.restore();break}case"fillSketch":this.fillSketch(s,a,r)}}fillSketch(t,n,r){let s=r.fillWeight;s<0&&(s=r.strokeWidth/2),t.save(),r.fillLineDash&&t.setLineDash(r.fillLineDash),r.fillLineDashOffset&&(t.lineDashOffset=r.fillLineDashOffset),t.strokeStyle=r.fill||"",t.lineWidth=s,this._drawToContext(t,n,r.fixedDecimalPlaceDigits),t.restore()}_drawToContext(t,n,r,s="nonzero"){t.beginPath();for(const i of n.ops){const a=typeof r=="number"&&r>=0?i.data.map(o=>+o.toFixed(r)):i.data;switch(i.op){case"move":t.moveTo(a[0],a[1]);break;case"bcurveTo":t.bezierCurveTo(a[0],a[1],a[2],a[3],a[4],a[5]);break;case"lineTo":t.lineTo(a[0],a[1])}}n.type==="fillPath"?t.fill(s):t.stroke()}get generator(){return this.gen}getDefaultOptions(){return this.gen.defaultOptions}line(t,n,r,s,i){const a=this.gen.line(t,n,r,s,i);return this.draw(a),a}rectangle(t,n,r,s,i){const a=this.gen.rectangle(t,n,r,s,i);return this.draw(a),a}ellipse(t,n,r,s,i){const a=this.gen.ellipse(t,n,r,s,i);return this.draw(a),a}circle(t,n,r,s){const i=this.gen.circle(t,n,r,s);return this.draw(i),i}linearPath(t,n){const r=this.gen.linearPath(t,n);return this.draw(r),r}polygon(t,n){const r=this.gen.polygon(t,n);return this.draw(r),r}arc(t,n,r,s,i,a,o=!1,l){const c=this.gen.arc(t,n,r,s,i,a,o,l);return this.draw(c),c}curve(t,n){const r=this.gen.curve(t,n);return this.draw(r),r}path(t,n){const r=this.gen.path(t,n);return this.draw(r),r}}const k2="http://www.w3.org/2000/svg";class Tat{constructor(t,n){this.svg=t,this.gen=new cE(n)}draw(t){const n=t.sets||[],r=t.options||this.getDefaultOptions(),s=this.svg.ownerDocument||window.document,i=s.createElementNS(k2,"g"),a=t.options.fixedDecimalPlaceDigits;for(const o of n){let l=null;switch(o.type){case"path":l=s.createElementNS(k2,"path"),l.setAttribute("d",this.opsToPath(o,a)),l.setAttribute("stroke",r.stroke),l.setAttribute("stroke-width",r.strokeWidth+""),l.setAttribute("fill","none"),r.strokeLineDash&&l.setAttribute("stroke-dasharray",r.strokeLineDash.join(" ").trim()),r.strokeLineDashOffset&&l.setAttribute("stroke-dashoffset",`${r.strokeLineDashOffset}`);break;case"fillPath":l=s.createElementNS(k2,"path"),l.setAttribute("d",this.opsToPath(o,a)),l.setAttribute("stroke","none"),l.setAttribute("stroke-width","0"),l.setAttribute("fill",r.fill||""),t.shape!=="curve"&&t.shape!=="polygon"||l.setAttribute("fill-rule","evenodd");break;case"fillSketch":l=this.fillSketch(s,o,r)}l&&i.appendChild(l)}return i}fillSketch(t,n,r){let s=r.fillWeight;s<0&&(s=r.strokeWidth/2);const i=t.createElementNS(k2,"path");return i.setAttribute("d",this.opsToPath(n,r.fixedDecimalPlaceDigits)),i.setAttribute("stroke",r.fill||""),i.setAttribute("stroke-width",s+""),i.setAttribute("fill","none"),r.fillLineDash&&i.setAttribute("stroke-dasharray",r.fillLineDash.join(" ").trim()),r.fillLineDashOffset&&i.setAttribute("stroke-dashoffset",`${r.fillLineDashOffset}`),i}get generator(){return this.gen}getDefaultOptions(){return this.gen.defaultOptions}opsToPath(t,n){return this.gen.opsToPath(t,n)}line(t,n,r,s,i){const a=this.gen.line(t,n,r,s,i);return this.draw(a)}rectangle(t,n,r,s,i){const a=this.gen.rectangle(t,n,r,s,i);return this.draw(a)}ellipse(t,n,r,s,i){const a=this.gen.ellipse(t,n,r,s,i);return this.draw(a)}circle(t,n,r,s){const i=this.gen.circle(t,n,r,s);return this.draw(i)}linearPath(t,n){const r=this.gen.linearPath(t,n);return this.draw(r)}polygon(t,n){const r=this.gen.polygon(t,n);return this.draw(r)}arc(t,n,r,s,i,a,o=!1,l){const c=this.gen.arc(t,n,r,s,i,a,o,l);return this.draw(c)}curve(t,n){const r=this.gen.curve(t,n);return this.draw(r)}path(t,n){const r=this.gen.path(t,n);return this.draw(r)}}var Tn={canvas:(e,t)=>new Eat(e,t),svg:(e,t)=>new Tat(e,t),generator:e=>new cE(e),newSeed:()=>cE.newSeed()},fr=ie(async(e,t,n)=>{var d,h;let r;const s=t.useHtmlLabels||Gi((d=ls())==null?void 0:d.htmlLabels);n?r=n:r="node default";const i=e.insert("g").attr("class",r).attr("id",t.domId||t.id),a=i.insert("g").attr("class","label").attr("style",io(t.labelStyle));let o;t.label===void 0?o="":o=typeof t.label=="string"?t.label:t.label[0];const l=await hp(a,Pm(ag(o),ls()),{useHtmlLabels:s,width:t.width||((h=ls().flowchart)==null?void 0:h.wrappingWidth),cssClasses:"markdown-node-label",style:t.labelStyle,addSvgBackground:!!t.icon||!!t.img});let c=l.getBBox();const u=((t==null?void 0:t.padding)??0)/2;if(s){const m=l.children[0],y=Kr(l),b=m.getElementsByTagName("img");if(b){const v=o.replace(/<img[^>]*>/g,"").trim()==="";await Promise.all([...b].map(x=>new Promise(w=>{function S(){if(x.style.display="flex",x.style.flexDirection="column",v){const k=ls().fontSize?ls().fontSize:window.getComputedStyle(document.body).fontSize,C=5,[T=Vie.fontSize]=mA(k),R=T*C+"px";x.style.minWidth=R,x.style.maxWidth=R}else x.style.width="100%";w(x)}ie(S,"setupImage"),setTimeout(()=>{x.complete&&S()}),x.addEventListener("error",S),x.addEventListener("load",S)})))}c=m.getBoundingClientRect(),y.attr("width",c.width),y.attr("height",c.height)}return s?a.attr("transform","translate("+-c.width/2+", "+-c.height/2+")"):a.attr("transform","translate(0, "+-c.height/2+")"),t.centerLabel&&a.attr("transform","translate("+-c.width/2+", "+-c.height/2+")"),a.insert("rect",":first-child"),{shapeSvg:i,bbox:c,halfPadding:u,label:a}},"labelHelper"),z3=ie(async(e,t,n)=>{var l,c,u,d,h,m;const r=n.useHtmlLabels||Gi((c=(l=ls())==null?void 0:l.flowchart)==null?void 0:c.htmlLabels),s=e.insert("g").attr("class","label").attr("style",n.labelStyle||""),i=await hp(s,Pm(ag(t),ls()),{useHtmlLabels:r,width:n.width||((d=(u=ls())==null?void 0:u.flowchart)==null?void 0:d.wrappingWidth),style:n.labelStyle,addSvgBackground:!!n.icon||!!n.img});let a=i.getBBox();const o=n.padding/2;if(Gi((m=(h=ls())==null?void 0:h.flowchart)==null?void 0:m.htmlLabels)){const y=i.children[0],b=Kr(i);a=y.getBoundingClientRect(),b.attr("width",a.width),b.attr("height",a.height)}return r?s.attr("transform","translate("+-a.width/2+", "+-a.height/2+")"):s.attr("transform","translate(0, "+-a.height/2+")"),n.centerLabel&&s.attr("transform","translate("+-a.width/2+", "+-a.height/2+")"),s.insert("rect",":first-child"),{shapeSvg:e,bbox:a,halfPadding:o,label:s}},"insertLabel"),In=ie((e,t)=>{const n=t.node().getBBox();e.width=n.width,e.height=n.height},"updateNodeBounds"),rr=ie((e,t)=>(e.look==="handDrawn"?"rough-node":"node")+" "+e.cssClasses+" "+(t||""),"getNodeClasses");function Xr(e){const t=e.map((n,r)=>`${r===0?"M":"L"}${n.x},${n.y}`);return t.push("Z"),t.join(" ")}ie(Xr,"createPathFromPoints");function Lh(e,t,n,r,s,i){const a=[],l=n-e,c=r-t,u=l/i,d=2*Math.PI/u,h=t+c/2;for(let m=0;m<=50;m++){const y=m/50,b=e+y*l,v=h+s*Math.sin(d*(b-e));a.push({x:b,y:v})}return a}ie(Lh,"generateFullSineWavePoints");function l5(e,t,n,r,s,i){const a=[],o=s*Math.PI/180,u=(i*Math.PI/180-o)/(r-1);for(let d=0;d<r;d++){const h=o+d*u,m=e+n*Math.cos(h),y=t+n*Math.sin(h);a.push({x:-m,y:-y})}return a}ie(l5,"generateCirclePoints");var Aat=ie((e,t)=>{var n=e.x,r=e.y,s=t.x-n,i=t.y-r,a=e.width/2,o=e.height/2,l,c;return Math.abs(i)*a>Math.abs(s)*o?(i<0&&(o=-o),l=i===0?0:o*s/i,c=o):(s<0&&(a=-a),l=a,c=s===0?0:a*i/s),{x:n+l,y:r+c}},"intersectRect"),kb=Aat;function Rce(e,t){t&&e.attr("style",t)}ie(Rce,"applyStyle");async function Nce(e){const t=Kr(document.createElementNS("http://www.w3.org/2000/svg","foreignObject")),n=t.append("xhtml:div");let r=e.label;e.label&&Iy(e.label)&&(r=await pF(e.label.replace(_b.lineBreakRegex,`
`),ls()));const s=e.isNode?"nodeLabel":"edgeLabel";return n.html('<span class="'+s+'" '+(e.labelStyle?'style="'+e.labelStyle+'"':"")+">"+r+"</span>"),Rce(n,e.labelStyle),n.style("display","inline-block"),n.style("padding-right","1px"),n.style("white-space","nowrap"),n.attr("xmlns","http://www.w3.org/1999/xhtml"),t.node()}ie(Nce,"addHtmlLabel");var Rat=ie(async(e,t,n,r)=>{let s=e||"";if(typeof s=="object"&&(s=s[0]),Gi(ls().flowchart.htmlLabels)){s=s.replace(/\\n|\n/g,"<br />"),zt.info("vertexText"+s);const i={isNode:r,label:ag(s).replace(/fa[blrs]?:fa-[\w-]+/g,o=>`<i class='${o.replace(":"," ")}'></i>`),labelStyle:t&&t.replace("fill:","color:")};return await Nce(i)}else{const i=document.createElementNS("http://www.w3.org/2000/svg","text");i.setAttribute("style",t.replace("color:","fill:"));let a=[];typeof s=="string"?a=s.split(/\\n|\n|<br\s*\/?>/gi):Array.isArray(s)?a=s:a=[];for(const o of a){const l=document.createElementNS("http://www.w3.org/2000/svg","tspan");l.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),l.setAttribute("dy","1em"),l.setAttribute("x","0"),n?l.setAttribute("class","title-row"):l.setAttribute("class","row"),l.textContent=o.trim(),i.appendChild(l)}return i}},"createLabel"),dm=Rat,ff=ie((e,t,n,r,s)=>["M",e+s,t,"H",e+n-s,"A",s,s,0,0,1,e+n,t+s,"V",t+r-s,"A",s,s,0,0,1,e+n-s,t+r,"H",e+s,"A",s,s,0,0,1,e,t+r-s,"V",t+s,"A",s,s,0,0,1,e+s,t,"Z"].join(" "),"createRoundedRectPathD"),Nat=ie(e=>{const{handDrawnSeed:t}=ls();return{fill:e,hachureAngle:120,hachureGap:4,fillWeight:2,roughness:.7,stroke:e,seed:t}},"solidStateFill"),Eb=ie(e=>{const t=Mat([...e.cssCompiledStyles||[],...e.cssStyles||[]]);return{stylesMap:t,stylesArray:[...t]}},"compileStyles"),Mat=ie(e=>{const t=new Map;return e.forEach(n=>{const[r,s]=n.split(":");t.set(r.trim(),s==null?void 0:s.trim())}),t},"styles2Map"),Mce=ie(e=>e==="color"||e==="font-size"||e==="font-family"||e==="font-weight"||e==="font-style"||e==="text-decoration"||e==="text-align"||e==="text-transform"||e==="line-height"||e==="letter-spacing"||e==="word-spacing"||e==="text-shadow"||e==="text-overflow"||e==="white-space"||e==="word-wrap"||e==="word-break"||e==="overflow-wrap"||e==="hyphens","isLabelStyle"),jn=ie(e=>{const{stylesArray:t}=Eb(e),n=[],r=[],s=[],i=[];return t.forEach(a=>{const o=a[0];Mce(o)?n.push(a.join(":")+" !important"):(r.push(a.join(":")+" !important"),o.includes("stroke")&&s.push(a.join(":")+" !important"),o==="fill"&&i.push(a.join(":")+" !important"))}),{labelStyles:n.join(";"),nodeStyles:r.join(";"),stylesArray:t,borderStyles:s,backgroundStyles:i}},"styles2String"),Rn=ie((e,t)=>{var l;const{themeVariables:n,handDrawnSeed:r}=ls(),{nodeBorder:s,mainBkg:i}=n,{stylesMap:a}=Eb(e);return Object.assign({roughness:.7,fill:a.get("fill")||i,fillStyle:"hachure",fillWeight:4,hachureGap:5.2,stroke:a.get("stroke")||s,seed:r,strokeWidth:((l=a.get("stroke-width"))==null?void 0:l.replace("px",""))||1.3,fillLineDash:[0,0]},t)},"userNodeOverrides"),Ice=ie(async(e,t)=>{zt.info("Creating subgraph rect for ",t.id,t);const n=ls(),{themeVariables:r,handDrawnSeed:s}=n,{clusterBkg:i,clusterBorder:a}=r,{labelStyles:o,nodeStyles:l,borderStyles:c,backgroundStyles:u}=jn(t),d=e.insert("g").attr("class","cluster "+t.cssClasses).attr("id",t.id).attr("data-look",t.look),h=Gi(n.flowchart.htmlLabels),m=d.insert("g").attr("class","cluster-label "),y=await hp(m,t.label,{style:t.labelStyle,useHtmlLabels:h,isNode:!0});let b=y.getBBox();if(Gi(n.flowchart.htmlLabels)){const R=y.children[0],N=Kr(y);b=R.getBoundingClientRect(),N.attr("width",b.width),N.attr("height",b.height)}const v=t.width<=b.width+t.padding?b.width+t.padding:t.width;t.width<=b.width+t.padding?t.diff=(v-t.width)/2-t.padding:t.diff=-t.padding;const x=t.height,w=t.x-v/2,S=t.y-x/2;zt.trace("Data ",t,JSON.stringify(t));let k;if(t.look==="handDrawn"){const R=Tn.svg(d),N=Rn(t,{roughness:.7,fill:i,stroke:a,fillWeight:3,seed:s}),I=R.path(ff(w,S,v,x,0),N);k=d.insert(()=>(zt.debug("Rough node insert CXC",I),I),":first-child"),k.select("path:nth-child(2)").attr("style",c.join(";")),k.select("path").attr("style",u.join(";").replace("fill","stroke"))}else k=d.insert("rect",":first-child"),k.attr("style",l).attr("rx",t.rx).attr("ry",t.ry).attr("x",w).attr("y",S).attr("width",v).attr("height",x);const{subGraphTitleTopMargin:C}=TF(n);if(m.attr("transform",`translate(${t.x-b.width/2}, ${t.y-t.height/2+C})`),o){const R=m.select("span");R&&R.attr("style",o)}const T=k.node().getBBox();return t.offsetX=0,t.width=T.width,t.height=T.height,t.offsetY=b.height-t.padding/2,t.intersect=function(R){return kb(t,R)},{cluster:d,labelBBox:b}},"rect"),Iat=ie((e,t)=>{const n=e.insert("g").attr("class","note-cluster").attr("id",t.id),r=n.insert("rect",":first-child"),s=0*t.padding,i=s/2;r.attr("rx",t.rx).attr("ry",t.ry).attr("x",t.x-t.width/2-i).attr("y",t.y-t.height/2-i).attr("width",t.width+s).attr("height",t.height+s).attr("fill","none");const a=r.node().getBBox();return t.width=a.width,t.height=a.height,t.intersect=function(o){return kb(t,o)},{cluster:n,labelBBox:{width:0,height:0}}},"noteGroup"),jat=ie(async(e,t)=>{const n=ls(),{themeVariables:r,handDrawnSeed:s}=n,{altBackground:i,compositeBackground:a,compositeTitleBackground:o,nodeBorder:l}=r,c=e.insert("g").attr("class",t.cssClasses).attr("id",t.id).attr("data-id",t.id).attr("data-look",t.look),u=c.insert("g",":first-child"),d=c.insert("g").attr("class","cluster-label");let h=c.append("rect");const m=d.node().appendChild(await dm(t.label,t.labelStyle,void 0,!0));let y=m.getBBox();if(Gi(n.flowchart.htmlLabels)){const I=m.children[0],P=Kr(m);y=I.getBoundingClientRect(),P.attr("width",y.width),P.attr("height",y.height)}const b=0*t.padding,v=b/2,x=(t.width<=y.width+t.padding?y.width+t.padding:t.width)+b;t.width<=y.width+t.padding?t.diff=(x-t.width)/2-t.padding:t.diff=-t.padding;const w=t.height+b,S=t.height+b-y.height-6,k=t.x-x/2,C=t.y-w/2;t.width=x;const T=t.y-t.height/2-v+y.height+2;let R;if(t.look==="handDrawn"){const I=t.cssClasses.includes("statediagram-cluster-alt"),P=Tn.svg(c),B=t.rx||t.ry?P.path(ff(k,C,x,w,10),{roughness:.7,fill:o,fillStyle:"solid",stroke:l,seed:s}):P.rectangle(k,C,x,w,{seed:s});R=c.insert(()=>B,":first-child");const D=P.rectangle(k,T,x,S,{fill:I?i:a,fillStyle:I?"hachure":"solid",stroke:l,seed:s});R=c.insert(()=>B,":first-child"),h=c.insert(()=>D)}else R=u.insert("rect",":first-child"),R.attr("class","outer").attr("x",k).attr("y",C).attr("width",x).attr("height",w).attr("data-look",t.look),h.attr("class","inner").attr("x",k).attr("y",T).attr("width",x).attr("height",S);d.attr("transform",`translate(${t.x-y.width/2}, ${C+1-(Gi(n.flowchart.htmlLabels)?0:3)})`);const N=R.node().getBBox();return t.height=N.height,t.offsetX=0,t.offsetY=y.height-t.padding/2,t.labelBBox=y,t.intersect=function(I){return kb(t,I)},{cluster:c,labelBBox:y}},"roundedWithTitle"),Oat=ie(async(e,t)=>{zt.info("Creating subgraph rect for ",t.id,t);const n=ls(),{themeVariables:r,handDrawnSeed:s}=n,{clusterBkg:i,clusterBorder:a}=r,{labelStyles:o,nodeStyles:l,borderStyles:c,backgroundStyles:u}=jn(t),d=e.insert("g").attr("class","cluster "+t.cssClasses).attr("id",t.id).attr("data-look",t.look),h=Gi(n.flowchart.htmlLabels),m=d.insert("g").attr("class","cluster-label "),y=await hp(m,t.label,{style:t.labelStyle,useHtmlLabels:h,isNode:!0,width:t.width});let b=y.getBBox();if(Gi(n.flowchart.htmlLabels)){const R=y.children[0],N=Kr(y);b=R.getBoundingClientRect(),N.attr("width",b.width),N.attr("height",b.height)}const v=t.width<=b.width+t.padding?b.width+t.padding:t.width;t.width<=b.width+t.padding?t.diff=(v-t.width)/2-t.padding:t.diff=-t.padding;const x=t.height,w=t.x-v/2,S=t.y-x/2;zt.trace("Data ",t,JSON.stringify(t));let k;if(t.look==="handDrawn"){const R=Tn.svg(d),N=Rn(t,{roughness:.7,fill:i,stroke:a,fillWeight:4,seed:s}),I=R.path(ff(w,S,v,x,t.rx),N);k=d.insert(()=>(zt.debug("Rough node insert CXC",I),I),":first-child"),k.select("path:nth-child(2)").attr("style",c.join(";")),k.select("path").attr("style",u.join(";").replace("fill","stroke"))}else k=d.insert("rect",":first-child"),k.attr("style",l).attr("rx",t.rx).attr("ry",t.ry).attr("x",w).attr("y",S).attr("width",v).attr("height",x);const{subGraphTitleTopMargin:C}=TF(n);if(m.attr("transform",`translate(${t.x-b.width/2}, ${t.y-t.height/2+C})`),o){const R=m.select("span");R&&R.attr("style",o)}const T=k.node().getBBox();return t.offsetX=0,t.width=T.width,t.height=T.height,t.offsetY=b.height-t.padding/2,t.intersect=function(R){return kb(t,R)},{cluster:d,labelBBox:b}},"kanbanSection"),Pat=ie((e,t)=>{const n=ls(),{themeVariables:r,handDrawnSeed:s}=n,{nodeBorder:i}=r,a=e.insert("g").attr("class",t.cssClasses).attr("id",t.id).attr("data-look",t.look),o=a.insert("g",":first-child"),l=0*t.padding,c=t.width+l;t.diff=-t.padding;const u=t.height+l,d=t.x-c/2,h=t.y-u/2;t.width=c;let m;if(t.look==="handDrawn"){const v=Tn.svg(a).rectangle(d,h,c,u,{fill:"lightgrey",roughness:.5,strokeLineDash:[5],stroke:i,seed:s});m=a.insert(()=>v,":first-child")}else m=o.insert("rect",":first-child"),m.attr("class","divider").attr("x",d).attr("y",h).attr("width",c).attr("height",u).attr("data-look",t.look);const y=m.node().getBBox();return t.height=y.height,t.offsetX=0,t.offsetY=0,t.intersect=function(b){return kb(t,b)},{cluster:a,labelBBox:{}}},"divider"),Dat=Ice,Fat={rect:Ice,squareRect:Dat,roundedWithTitle:jat,noteGroup:Iat,divider:Pat,kanbanSection:Oat},jce=new Map,Lat=ie(async(e,t)=>{const n=t.shape||"rect",r=await Fat[n](e,t);return jce.set(t.id,r),r},"insertCluster"),Kdt=ie(()=>{jce=new Map},"clear");function Oce(e,t){return e.intersect(t)}ie(Oce,"intersectNode");var Bat=Oce;function Pce(e,t,n,r){var s=e.x,i=e.y,a=s-r.x,o=i-r.y,l=Math.sqrt(t*t*o*o+n*n*a*a),c=Math.abs(t*n*a/l);r.x<s&&(c=-c);var u=Math.abs(t*n*o/l);return r.y<i&&(u=-u),{x:s+c,y:i+u}}ie(Pce,"intersectEllipse");var Dce=Pce;function Fce(e,t,n){return Dce(e,t,t,n)}ie(Fce,"intersectCircle");var $at=Fce;function Lce(e,t,n,r){var s,i,a,o,l,c,u,d,h,m,y,b,v,x,w;if(s=t.y-e.y,a=e.x-t.x,l=t.x*e.y-e.x*t.y,h=s*n.x+a*n.y+l,m=s*r.x+a*r.y+l,!(h!==0&&m!==0&&AO(h,m))&&(i=r.y-n.y,o=n.x-r.x,c=r.x*n.y-n.x*r.y,u=i*e.x+o*e.y+c,d=i*t.x+o*t.y+c,!(u!==0&&d!==0&&AO(u,d))&&(y=s*o-i*a,y!==0)))return b=Math.abs(y/2),v=a*c-o*l,x=v<0?(v-b)/y:(v+b)/y,v=i*l-s*c,w=v<0?(v-b)/y:(v+b)/y,{x,y:w}}ie(Lce,"intersectLine");function AO(e,t){return e*t>0}ie(AO,"sameSign");var zat=Lce;function Bce(e,t,n){let r=e.x,s=e.y,i=[],a=Number.POSITIVE_INFINITY,o=Number.POSITIVE_INFINITY;typeof t.forEach=="function"?t.forEach(function(u){a=Math.min(a,u.x),o=Math.min(o,u.y)}):(a=Math.min(a,t.x),o=Math.min(o,t.y));let l=r-e.width/2-a,c=s-e.height/2-o;for(let u=0;u<t.length;u++){let d=t[u],h=t[u<t.length-1?u+1:0],m=zat(e,n,{x:l+d.x,y:c+d.y},{x:l+h.x,y:c+h.y});m&&i.push(m)}return i.length?(i.length>1&&i.sort(function(u,d){let h=u.x-n.x,m=u.y-n.y,y=Math.sqrt(h*h+m*m),b=d.x-n.x,v=d.y-n.y,x=Math.sqrt(b*b+v*v);return y<x?-1:y===x?0:1}),i[0]):e}ie(Bce,"intersectPolygon");var Uat=Bce,kn={node:Bat,circle:$at,ellipse:Dce,polygon:Uat,rect:kb};function $ce(e,t){const{labelStyles:n}=jn(t);t.labelStyle=n;const r=rr(t);let s=r;r||(s="anchor");const i=e.insert("g").attr("class",s).attr("id",t.domId||t.id),a=1,{cssStyles:o}=t,l=Tn.svg(i),c=Rn(t,{fill:"black",stroke:"none",fillStyle:"solid"});t.look!=="handDrawn"&&(c.roughness=0);const u=l.circle(0,0,a*2,c),d=i.insert(()=>u,":first-child");return d.attr("class","anchor").attr("style",io(o)),In(t,d),t.intersect=function(h){return zt.info("Circle intersect",t,a,h),kn.circle(t,a,h)},i}ie($ce,"anchor");function RO(e,t,n,r,s,i,a){const l=(e+n)/2,c=(t+r)/2,u=Math.atan2(r-t,n-e),d=(n-e)/2,h=(r-t)/2,m=d/s,y=h/i,b=Math.sqrt(m**2+y**2);if(b>1)throw new Error("The given radii are too small to create an arc between the points.");const v=Math.sqrt(1-b**2),x=l+v*i*Math.sin(u)*(a?-1:1),w=c-v*s*Math.cos(u)*(a?-1:1),S=Math.atan2((t-w)/i,(e-x)/s);let C=Math.atan2((r-w)/i,(n-x)/s)-S;a&&C<0&&(C+=2*Math.PI),!a&&C>0&&(C-=2*Math.PI);const T=[];for(let R=0;R<20;R++){const N=R/19,I=S+N*C,P=x+s*Math.cos(I),B=w+i*Math.sin(I);T.push({x:P,y:B})}return T}ie(RO,"generateArcPoints");async function zce(e,t){const{labelStyles:n,nodeStyles:r}=jn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await fr(e,t,rr(t)),a=i.width+t.padding+20,o=i.height+t.padding,l=o/2,c=l/(2.5+o/50),{cssStyles:u}=t,d=[{x:a/2,y:-o/2},{x:-a/2,y:-o/2},...RO(-a/2,-o/2,-a/2,o/2,c,l,!1),{x:a/2,y:o/2},...RO(a/2,o/2,a/2,-o/2,c,l,!0)],h=Tn.svg(s),m=Rn(t,{});t.look!=="handDrawn"&&(m.roughness=0,m.fillStyle="solid");const y=Xr(d),b=h.path(y,m),v=s.insert(()=>b,":first-child");return v.attr("class","basic label-container"),u&&t.look!=="handDrawn"&&v.selectAll("path").attr("style",u),r&&t.look!=="handDrawn"&&v.selectAll("path").attr("style",r),v.attr("transform",`translate(${c/2}, 0)`),In(t,v),t.intersect=function(x){return kn.polygon(t,d,x)},s}ie(zce,"bowTieRect");function hf(e,t,n,r){return e.insert("polygon",":first-child").attr("points",r.map(function(s){return s.x+","+s.y}).join(" ")).attr("class","label-container").attr("transform","translate("+-t/2+","+n/2+")")}ie(hf,"insertPolygonShape");async function Uce(e,t){const{labelStyles:n,nodeStyles:r}=jn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await fr(e,t,rr(t)),a=i.height+t.padding,o=12,l=i.width+t.padding+o,c=0,u=l,d=-a,h=0,m=[{x:c+o,y:d},{x:u,y:d},{x:u,y:h},{x:c,y:h},{x:c,y:d+o},{x:c+o,y:d}];let y;const{cssStyles:b}=t;if(t.look==="handDrawn"){const v=Tn.svg(s),x=Rn(t,{}),w=Xr(m),S=v.path(w,x);y=s.insert(()=>S,":first-child").attr("transform",`translate(${-l/2}, ${a/2})`),b&&y.attr("style",b)}else y=hf(s,l,a,m);return r&&y.attr("style",r),In(t,y),t.intersect=function(v){return kn.polygon(t,m,v)},s}ie(Uce,"card");function qce(e,t){const{nodeStyles:n}=jn(t);t.label="";const r=e.insert("g").attr("class",rr(t)).attr("id",t.domId??t.id),{cssStyles:s}=t,i=Math.max(28,t.width??0),a=[{x:0,y:i/2},{x:i/2,y:0},{x:0,y:-i/2},{x:-i/2,y:0}],o=Tn.svg(r),l=Rn(t,{});t.look!=="handDrawn"&&(l.roughness=0,l.fillStyle="solid");const c=Xr(a),u=o.path(c,l),d=r.insert(()=>u,":first-child");return s&&t.look!=="handDrawn"&&d.selectAll("path").attr("style",s),n&&t.look!=="handDrawn"&&d.selectAll("path").attr("style",n),t.width=28,t.height=28,t.intersect=function(h){return kn.polygon(t,a,h)},r}ie(qce,"choice");async function Vce(e,t){const{labelStyles:n,nodeStyles:r}=jn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,halfPadding:a}=await fr(e,t,rr(t)),o=i.width/2+a;let l;const{cssStyles:c}=t;if(t.look==="handDrawn"){const u=Tn.svg(s),d=Rn(t,{}),h=u.circle(0,0,o*2,d);l=s.insert(()=>h,":first-child"),l.attr("class","basic label-container").attr("style",io(c))}else l=s.insert("circle",":first-child").attr("class","basic label-container").attr("style",r).attr("r",o).attr("cx",0).attr("cy",0);return In(t,l),t.intersect=function(u){return zt.info("Circle intersect",t,o,u),kn.circle(t,o,u)},s}ie(Vce,"circle");function Wce(e){const t=Math.cos(Math.PI/4),n=Math.sin(Math.PI/4),r=e*2,s={x:r/2*t,y:r/2*n},i={x:-(r/2)*t,y:r/2*n},a={x:-(r/2)*t,y:-(r/2)*n},o={x:r/2*t,y:-(r/2)*n};return`M ${i.x},${i.y} L ${o.x},${o.y}
                   M ${s.x},${s.y} L ${a.x},${a.y}`}ie(Wce,"createLine");function Hce(e,t){const{labelStyles:n,nodeStyles:r}=jn(t);t.labelStyle=n,t.label="";const s=e.insert("g").attr("class",rr(t)).attr("id",t.domId??t.id),i=Math.max(30,(t==null?void 0:t.width)??0),{cssStyles:a}=t,o=Tn.svg(s),l=Rn(t,{});t.look!=="handDrawn"&&(l.roughness=0,l.fillStyle="solid");const c=o.circle(0,0,i*2,l),u=Wce(i),d=o.path(u,l),h=s.insert(()=>c,":first-child");return h.insert(()=>d),a&&t.look!=="handDrawn"&&h.selectAll("path").attr("style",a),r&&t.look!=="handDrawn"&&h.selectAll("path").attr("style",r),In(t,h),t.intersect=function(m){return zt.info("crossedCircle intersect",t,{radius:i,point:m}),kn.circle(t,i,m)},s}ie(Hce,"crossedCircle");function Cd(e,t,n,r=100,s=0,i=180){const a=[],o=s*Math.PI/180,u=(i*Math.PI/180-o)/(r-1);for(let d=0;d<r;d++){const h=o+d*u,m=e+n*Math.cos(h),y=t+n*Math.sin(h);a.push({x:-m,y:-y})}return a}ie(Cd,"generateCirclePoints");async function Gce(e,t){const{labelStyles:n,nodeStyles:r}=jn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await fr(e,t,rr(t)),o=i.width+(t.padding??0),l=i.height+(t.padding??0),c=Math.max(5,l*.1),{cssStyles:u}=t,d=[...Cd(o/2,-l/2,c,30,-90,0),{x:-o/2-c,y:c},...Cd(o/2+c*2,-c,c,20,-180,-270),...Cd(o/2+c*2,c,c,20,-90,-180),{x:-o/2-c,y:-l/2},...Cd(o/2,l/2,c,20,0,90)],h=[{x:o/2,y:-l/2-c},{x:-o/2,y:-l/2-c},...Cd(o/2,-l/2,c,20,-90,0),{x:-o/2-c,y:-c},...Cd(o/2+o*.1,-c,c,20,-180,-270),...Cd(o/2+o*.1,c,c,20,-90,-180),{x:-o/2-c,y:l/2},...Cd(o/2,l/2,c,20,0,90),{x:-o/2,y:l/2+c},{x:o/2,y:l/2+c}],m=Tn.svg(s),y=Rn(t,{fill:"none"});t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");const v=Xr(d).replace("Z",""),x=m.path(v,y),w=Xr(h),S=m.path(w,{...y}),k=s.insert("g",":first-child");return k.insert(()=>S,":first-child").attr("stroke-opacity",0),k.insert(()=>x,":first-child"),k.attr("class","text"),u&&t.look!=="handDrawn"&&k.selectAll("path").attr("style",u),r&&t.look!=="handDrawn"&&k.selectAll("path").attr("style",r),k.attr("transform",`translate(${c}, 0)`),a.attr("transform",`translate(${-o/2+c-(i.x-(i.left??0))},${-l/2+(t.padding??0)/2-(i.y-(i.top??0))})`),In(t,k),t.intersect=function(C){return kn.polygon(t,h,C)},s}ie(Gce,"curlyBraceLeft");function kd(e,t,n,r=100,s=0,i=180){const a=[],o=s*Math.PI/180,u=(i*Math.PI/180-o)/(r-1);for(let d=0;d<r;d++){const h=o+d*u,m=e+n*Math.cos(h),y=t+n*Math.sin(h);a.push({x:m,y})}return a}ie(kd,"generateCirclePoints");async function Kce(e,t){const{labelStyles:n,nodeStyles:r}=jn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await fr(e,t,rr(t)),o=i.width+(t.padding??0),l=i.height+(t.padding??0),c=Math.max(5,l*.1),{cssStyles:u}=t,d=[...kd(o/2,-l/2,c,20,-90,0),{x:o/2+c,y:-c},...kd(o/2+c*2,-c,c,20,-180,-270),...kd(o/2+c*2,c,c,20,-90,-180),{x:o/2+c,y:l/2},...kd(o/2,l/2,c,20,0,90)],h=[{x:-o/2,y:-l/2-c},{x:o/2,y:-l/2-c},...kd(o/2,-l/2,c,20,-90,0),{x:o/2+c,y:-c},...kd(o/2+c*2,-c,c,20,-180,-270),...kd(o/2+c*2,c,c,20,-90,-180),{x:o/2+c,y:l/2},...kd(o/2,l/2,c,20,0,90),{x:o/2,y:l/2+c},{x:-o/2,y:l/2+c}],m=Tn.svg(s),y=Rn(t,{fill:"none"});t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");const v=Xr(d).replace("Z",""),x=m.path(v,y),w=Xr(h),S=m.path(w,{...y}),k=s.insert("g",":first-child");return k.insert(()=>S,":first-child").attr("stroke-opacity",0),k.insert(()=>x,":first-child"),k.attr("class","text"),u&&t.look!=="handDrawn"&&k.selectAll("path").attr("style",u),r&&t.look!=="handDrawn"&&k.selectAll("path").attr("style",r),k.attr("transform",`translate(${-c}, 0)`),a.attr("transform",`translate(${-o/2+(t.padding??0)/2-(i.x-(i.left??0))},${-l/2+(t.padding??0)/2-(i.y-(i.top??0))})`),In(t,k),t.intersect=function(C){return kn.polygon(t,h,C)},s}ie(Kce,"curlyBraceRight");function ba(e,t,n,r=100,s=0,i=180){const a=[],o=s*Math.PI/180,u=(i*Math.PI/180-o)/(r-1);for(let d=0;d<r;d++){const h=o+d*u,m=e+n*Math.cos(h),y=t+n*Math.sin(h);a.push({x:-m,y:-y})}return a}ie(ba,"generateCirclePoints");async function Yce(e,t){const{labelStyles:n,nodeStyles:r}=jn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await fr(e,t,rr(t)),o=i.width+(t.padding??0),l=i.height+(t.padding??0),c=Math.max(5,l*.1),{cssStyles:u}=t,d=[...ba(o/2,-l/2,c,30,-90,0),{x:-o/2-c,y:c},...ba(o/2+c*2,-c,c,20,-180,-270),...ba(o/2+c*2,c,c,20,-90,-180),{x:-o/2-c,y:-l/2},...ba(o/2,l/2,c,20,0,90)],h=[...ba(-o/2+c+c/2,-l/2,c,20,-90,-180),{x:o/2-c/2,y:c},...ba(-o/2-c/2,-c,c,20,0,90),...ba(-o/2-c/2,c,c,20,-90,0),{x:o/2-c/2,y:-c},...ba(-o/2+c+c/2,l/2,c,30,-180,-270)],m=[{x:o/2,y:-l/2-c},{x:-o/2,y:-l/2-c},...ba(o/2,-l/2,c,20,-90,0),{x:-o/2-c,y:-c},...ba(o/2+c*2,-c,c,20,-180,-270),...ba(o/2+c*2,c,c,20,-90,-180),{x:-o/2-c,y:l/2},...ba(o/2,l/2,c,20,0,90),{x:-o/2,y:l/2+c},{x:o/2-c-c/2,y:l/2+c},...ba(-o/2+c+c/2,-l/2,c,20,-90,-180),{x:o/2-c/2,y:c},...ba(-o/2-c/2,-c,c,20,0,90),...ba(-o/2-c/2,c,c,20,-90,0),{x:o/2-c/2,y:-c},...ba(-o/2+c+c/2,l/2,c,30,-180,-270)],y=Tn.svg(s),b=Rn(t,{fill:"none"});t.look!=="handDrawn"&&(b.roughness=0,b.fillStyle="solid");const x=Xr(d).replace("Z",""),w=y.path(x,b),k=Xr(h).replace("Z",""),C=y.path(k,b),T=Xr(m),R=y.path(T,{...b}),N=s.insert("g",":first-child");return N.insert(()=>R,":first-child").attr("stroke-opacity",0),N.insert(()=>w,":first-child"),N.insert(()=>C,":first-child"),N.attr("class","text"),u&&t.look!=="handDrawn"&&N.selectAll("path").attr("style",u),r&&t.look!=="handDrawn"&&N.selectAll("path").attr("style",r),N.attr("transform",`translate(${c-c/4}, 0)`),a.attr("transform",`translate(${-o/2+(t.padding??0)/2-(i.x-(i.left??0))},${-l/2+(t.padding??0)/2-(i.y-(i.top??0))})`),In(t,N),t.intersect=function(I){return kn.polygon(t,m,I)},s}ie(Yce,"curlyBraces");async function Zce(e,t){const{labelStyles:n,nodeStyles:r}=jn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await fr(e,t,rr(t)),a=80,o=20,l=Math.max(a,(i.width+(t.padding??0)*2)*1.25,(t==null?void 0:t.width)??0),c=Math.max(o,i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),u=c/2,{cssStyles:d}=t,h=Tn.svg(s),m=Rn(t,{});t.look!=="handDrawn"&&(m.roughness=0,m.fillStyle="solid");const y=l,b=c,v=y-u,x=b/4,w=[{x:v,y:0},{x,y:0},{x:0,y:b/2},{x,y:b},{x:v,y:b},...l5(-v,-b/2,u,50,270,90)],S=Xr(w),k=h.path(S,m),C=s.insert(()=>k,":first-child");return C.attr("class","basic label-container"),d&&t.look!=="handDrawn"&&C.selectChildren("path").attr("style",d),r&&t.look!=="handDrawn"&&C.selectChildren("path").attr("style",r),C.attr("transform",`translate(${-l/2}, ${-c/2})`),In(t,C),t.intersect=function(T){return kn.polygon(t,w,T)},s}ie(Zce,"curvedTrapezoid");var qat=ie((e,t,n,r,s,i)=>[`M${e},${t+i}`,`a${s},${i} 0,0,0 ${n},0`,`a${s},${i} 0,0,0 ${-n},0`,`l0,${r}`,`a${s},${i} 0,0,0 ${n},0`,`l0,${-r}`].join(" "),"createCylinderPathD"),Vat=ie((e,t,n,r,s,i)=>[`M${e},${t+i}`,`M${e+n},${t+i}`,`a${s},${i} 0,0,0 ${-n},0`,`l0,${r}`,`a${s},${i} 0,0,0 ${n},0`,`l0,${-r}`].join(" "),"createOuterCylinderPathD"),Wat=ie((e,t,n,r,s,i)=>[`M${e-n/2},${-r/2}`,`a${s},${i} 0,0,0 ${n},0`].join(" "),"createInnerCylinderPathD");async function Xce(e,t){const{labelStyles:n,nodeStyles:r}=jn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await fr(e,t,rr(t)),o=Math.max(i.width+t.padding,t.width??0),l=o/2,c=l/(2.5+o/50),u=Math.max(i.height+c+t.padding,t.height??0);let d;const{cssStyles:h}=t;if(t.look==="handDrawn"){const m=Tn.svg(s),y=Vat(0,0,o,u,l,c),b=Wat(0,c,o,u,l,c),v=m.path(y,Rn(t,{})),x=m.path(b,Rn(t,{fill:"none"}));d=s.insert(()=>x,":first-child"),d=s.insert(()=>v,":first-child"),d.attr("class","basic label-container"),h&&d.attr("style",h)}else{const m=qat(0,0,o,u,l,c);d=s.insert("path",":first-child").attr("d",m).attr("class","basic label-container").attr("style",io(h)).attr("style",r)}return d.attr("label-offset-y",c),d.attr("transform",`translate(${-o/2}, ${-(u/2+c)})`),In(t,d),a.attr("transform",`translate(${-(i.width/2)-(i.x-(i.left??0))}, ${-(i.height/2)+(t.padding??0)/1.5-(i.y-(i.top??0))})`),t.intersect=function(m){const y=kn.rect(t,m),b=y.x-(t.x??0);if(l!=0&&(Math.abs(b)<(t.width??0)/2||Math.abs(b)==(t.width??0)/2&&Math.abs(y.y-(t.y??0))>(t.height??0)/2-c)){let v=c*c*(1-b*b/(l*l));v>0&&(v=Math.sqrt(v)),v=c-v,m.y-(t.y??0)>0&&(v=-v),y.y+=v}return y},s}ie(Xce,"cylinder");async function Jce(e,t){const{labelStyles:n,nodeStyles:r}=jn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await fr(e,t,rr(t)),o=i.width+t.padding,l=i.height+t.padding,c=l*.2,u=-o/2,d=-l/2-c/2,{cssStyles:h}=t,m=Tn.svg(s),y=Rn(t,{});t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");const b=[{x:u,y:d+c},{x:-u,y:d+c},{x:-u,y:-d},{x:u,y:-d},{x:u,y:d},{x:-u,y:d},{x:-u,y:d+c}],v=m.polygon(b.map(w=>[w.x,w.y]),y),x=s.insert(()=>v,":first-child");return x.attr("class","basic label-container"),h&&t.look!=="handDrawn"&&x.selectAll("path").attr("style",h),r&&t.look!=="handDrawn"&&x.selectAll("path").attr("style",r),a.attr("transform",`translate(${u+(t.padding??0)/2-(i.x-(i.left??0))}, ${d+c+(t.padding??0)/2-(i.y-(i.top??0))})`),In(t,x),t.intersect=function(w){return kn.rect(t,w)},s}ie(Jce,"dividedRectangle");async function Qce(e,t){var h,m;const{labelStyles:n,nodeStyles:r}=jn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,halfPadding:a}=await fr(e,t,rr(t)),l=i.width/2+a+5,c=i.width/2+a;let u;const{cssStyles:d}=t;if(t.look==="handDrawn"){const y=Tn.svg(s),b=Rn(t,{roughness:.2,strokeWidth:2.5}),v=Rn(t,{roughness:.2,strokeWidth:1.5}),x=y.circle(0,0,l*2,b),w=y.circle(0,0,c*2,v);u=s.insert("g",":first-child"),u.attr("class",io(t.cssClasses)).attr("style",io(d)),(h=u.node())==null||h.appendChild(x),(m=u.node())==null||m.appendChild(w)}else{u=s.insert("g",":first-child");const y=u.insert("circle",":first-child"),b=u.insert("circle");u.attr("class","basic label-container").attr("style",r),y.attr("class","outer-circle").attr("style",r).attr("r",l).attr("cx",0).attr("cy",0),b.attr("class","inner-circle").attr("style",r).attr("r",c).attr("cx",0).attr("cy",0)}return In(t,u),t.intersect=function(y){return zt.info("DoubleCircle intersect",t,l,y),kn.circle(t,l,y)},s}ie(Qce,"doublecircle");function eue(e,t,{config:{themeVariables:n}}){const{labelStyles:r,nodeStyles:s}=jn(t);t.label="",t.labelStyle=r;const i=e.insert("g").attr("class",rr(t)).attr("id",t.domId??t.id),a=7,{cssStyles:o}=t,l=Tn.svg(i),{nodeBorder:c}=n,u=Rn(t,{fillStyle:"solid"});t.look!=="handDrawn"&&(u.roughness=0);const d=l.circle(0,0,a*2,u),h=i.insert(()=>d,":first-child");return h.selectAll("path").attr("style",`fill: ${c} !important;`),o&&o.length>0&&t.look!=="handDrawn"&&h.selectAll("path").attr("style",o),s&&t.look!=="handDrawn"&&h.selectAll("path").attr("style",s),In(t,h),t.intersect=function(m){return zt.info("filledCircle intersect",t,{radius:a,point:m}),kn.circle(t,a,m)},i}ie(eue,"filledCircle");async function tue(e,t){const{labelStyles:n,nodeStyles:r}=jn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await fr(e,t,rr(t)),o=i.width+(t.padding??0),l=o+i.height,c=o+i.height,u=[{x:0,y:-l},{x:c,y:-l},{x:c/2,y:0}],{cssStyles:d}=t,h=Tn.svg(s),m=Rn(t,{});t.look!=="handDrawn"&&(m.roughness=0,m.fillStyle="solid");const y=Xr(u),b=h.path(y,m),v=s.insert(()=>b,":first-child").attr("transform",`translate(${-l/2}, ${l/2})`);return d&&t.look!=="handDrawn"&&v.selectChildren("path").attr("style",d),r&&t.look!=="handDrawn"&&v.selectChildren("path").attr("style",r),t.width=o,t.height=l,In(t,v),a.attr("transform",`translate(${-i.width/2-(i.x-(i.left??0))}, ${-l/2+(t.padding??0)/2+(i.y-(i.top??0))})`),t.intersect=function(x){return zt.info("Triangle intersect",t,u,x),kn.polygon(t,u,x)},s}ie(tue,"flippedTriangle");function nue(e,t,{dir:n,config:{state:r,themeVariables:s}}){const{nodeStyles:i}=jn(t);t.label="";const a=e.insert("g").attr("class",rr(t)).attr("id",t.domId??t.id),{cssStyles:o}=t;let l=Math.max(70,(t==null?void 0:t.width)??0),c=Math.max(10,(t==null?void 0:t.height)??0);n==="LR"&&(l=Math.max(10,(t==null?void 0:t.width)??0),c=Math.max(70,(t==null?void 0:t.height)??0));const u=-1*l/2,d=-1*c/2,h=Tn.svg(a),m=Rn(t,{stroke:s.lineColor,fill:s.lineColor});t.look!=="handDrawn"&&(m.roughness=0,m.fillStyle="solid");const y=h.rectangle(u,d,l,c,m),b=a.insert(()=>y,":first-child");o&&t.look!=="handDrawn"&&b.selectAll("path").attr("style",o),i&&t.look!=="handDrawn"&&b.selectAll("path").attr("style",i),In(t,b);const v=(r==null?void 0:r.padding)??0;return t.width&&t.height&&(t.width+=v/2||0,t.height+=v/2||0),t.intersect=function(x){return kn.rect(t,x)},a}ie(nue,"forkJoin");async function rue(e,t){const{labelStyles:n,nodeStyles:r}=jn(t);t.labelStyle=n;const s=80,i=50,{shapeSvg:a,bbox:o}=await fr(e,t,rr(t)),l=Math.max(s,o.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),c=Math.max(i,o.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),u=c/2,{cssStyles:d}=t,h=Tn.svg(a),m=Rn(t,{});t.look!=="handDrawn"&&(m.roughness=0,m.fillStyle="solid");const y=[{x:-l/2,y:-c/2},{x:l/2-u,y:-c/2},...l5(-l/2+u,0,u,50,90,270),{x:l/2-u,y:c/2},{x:-l/2,y:c/2}],b=Xr(y),v=h.path(b,m),x=a.insert(()=>v,":first-child");return x.attr("class","basic label-container"),d&&t.look!=="handDrawn"&&x.selectChildren("path").attr("style",d),r&&t.look!=="handDrawn"&&x.selectChildren("path").attr("style",r),In(t,x),t.intersect=function(w){return zt.info("Pill intersect",t,{radius:u,point:w}),kn.polygon(t,y,w)},a}ie(rue,"halfRoundedRectangle");var Hat=ie((e,t,n,r,s)=>[`M${e+s},${t}`,`L${e+n-s},${t}`,`L${e+n},${t-r/2}`,`L${e+n-s},${t-r}`,`L${e+s},${t-r}`,`L${e},${t-r/2}`,"Z"].join(" "),"createHexagonPathD");async function sue(e,t){const{labelStyles:n,nodeStyles:r}=jn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await fr(e,t,rr(t)),a=4,o=i.height+t.padding,l=o/a,c=i.width+2*l+t.padding,u=[{x:l,y:0},{x:c-l,y:0},{x:c,y:-o/2},{x:c-l,y:-o},{x:l,y:-o},{x:0,y:-o/2}];let d;const{cssStyles:h}=t;if(t.look==="handDrawn"){const m=Tn.svg(s),y=Rn(t,{}),b=Hat(0,0,c,o,l),v=m.path(b,y);d=s.insert(()=>v,":first-child").attr("transform",`translate(${-c/2}, ${o/2})`),h&&d.attr("style",h)}else d=hf(s,c,o,u);return r&&d.attr("style",r),t.width=c,t.height=o,In(t,d),t.intersect=function(m){return kn.polygon(t,u,m)},s}ie(sue,"hexagon");async function iue(e,t){const{labelStyles:n,nodeStyles:r}=jn(t);t.label="",t.labelStyle=n;const{shapeSvg:s}=await fr(e,t,rr(t)),i=Math.max(30,(t==null?void 0:t.width)??0),a=Math.max(30,(t==null?void 0:t.height)??0),{cssStyles:o}=t,l=Tn.svg(s),c=Rn(t,{});t.look!=="handDrawn"&&(c.roughness=0,c.fillStyle="solid");const u=[{x:0,y:0},{x:i,y:0},{x:0,y:a},{x:i,y:a}],d=Xr(u),h=l.path(d,c),m=s.insert(()=>h,":first-child");return m.attr("class","basic label-container"),o&&t.look!=="handDrawn"&&m.selectChildren("path").attr("style",o),r&&t.look!=="handDrawn"&&m.selectChildren("path").attr("style",r),m.attr("transform",`translate(${-i/2}, ${-a/2})`),In(t,m),t.intersect=function(y){return zt.info("Pill intersect",t,{points:u}),kn.polygon(t,u,y)},s}ie(iue,"hourglass");async function aue(e,t,{config:{themeVariables:n,flowchart:r}}){const{labelStyles:s}=jn(t);t.labelStyle=s;const i=t.assetHeight??48,a=t.assetWidth??48,o=Math.max(i,a),l=r==null?void 0:r.wrappingWidth;t.width=Math.max(o,l??0);const{shapeSvg:c,bbox:u,label:d}=await fr(e,t,"icon-shape default"),h=t.pos==="t",m=o,y=o,{nodeBorder:b}=n,{stylesMap:v}=Eb(t),x=-y/2,w=-m/2,S=t.label?8:0,k=Tn.svg(c),C=Rn(t,{stroke:"none",fill:"none"});t.look!=="handDrawn"&&(C.roughness=0,C.fillStyle="solid");const T=k.rectangle(x,w,y,m,C),R=Math.max(y,u.width),N=m+u.height+S,I=k.rectangle(-R/2,-N/2,R,N,{...C,fill:"transparent",stroke:"none"}),P=c.insert(()=>T,":first-child"),B=c.insert(()=>I);if(t.icon){const D=c.append("g");D.html(`<g>${await sA(t.icon,{height:o,width:o,fallbackPrefix:""})}</g>`);const W=D.node().getBBox(),O=W.width,Z=W.height,U=W.x,H=W.y;D.attr("transform",`translate(${-O/2-U},${h?u.height/2+S/2-Z/2-H:-u.height/2-S/2-Z/2-H})`),D.attr("style",`color: ${v.get("stroke")??b};`)}return d.attr("transform",`translate(${-u.width/2-(u.x-(u.left??0))},${h?-N/2:N/2-u.height})`),P.attr("transform",`translate(0,${h?u.height/2+S/2:-u.height/2-S/2})`),In(t,B),t.intersect=function(D){if(zt.info("iconSquare intersect",t,D),!t.label)return kn.rect(t,D);const W=t.x??0,O=t.y??0,Z=t.height??0;let U=[];return h?U=[{x:W-u.width/2,y:O-Z/2},{x:W+u.width/2,y:O-Z/2},{x:W+u.width/2,y:O-Z/2+u.height+S},{x:W+y/2,y:O-Z/2+u.height+S},{x:W+y/2,y:O+Z/2},{x:W-y/2,y:O+Z/2},{x:W-y/2,y:O-Z/2+u.height+S},{x:W-u.width/2,y:O-Z/2+u.height+S}]:U=[{x:W-y/2,y:O-Z/2},{x:W+y/2,y:O-Z/2},{x:W+y/2,y:O-Z/2+m},{x:W+u.width/2,y:O-Z/2+m},{x:W+u.width/2/2,y:O+Z/2},{x:W-u.width/2,y:O+Z/2},{x:W-u.width/2,y:O-Z/2+m},{x:W-y/2,y:O-Z/2+m}],kn.polygon(t,U,D)},c}ie(aue,"icon");async function oue(e,t,{config:{themeVariables:n,flowchart:r}}){const{labelStyles:s}=jn(t);t.labelStyle=s;const i=t.assetHeight??48,a=t.assetWidth??48,o=Math.max(i,a),l=r==null?void 0:r.wrappingWidth;t.width=Math.max(o,l??0);const{shapeSvg:c,bbox:u,label:d}=await fr(e,t,"icon-shape default"),h=20,m=t.label?8:0,y=t.pos==="t",{nodeBorder:b,mainBkg:v}=n,{stylesMap:x}=Eb(t),w=Tn.svg(c),S=Rn(t,{});t.look!=="handDrawn"&&(S.roughness=0,S.fillStyle="solid");const k=x.get("fill");S.stroke=k??v;const C=c.append("g");t.icon&&C.html(`<g>${await sA(t.icon,{height:o,width:o,fallbackPrefix:""})}</g>`);const T=C.node().getBBox(),R=T.width,N=T.height,I=T.x,P=T.y,B=Math.max(R,N)*Math.SQRT2+h*2,D=w.circle(0,0,B,S),W=Math.max(B,u.width),O=B+u.height+m,Z=w.rectangle(-W/2,-O/2,W,O,{...S,fill:"transparent",stroke:"none"}),U=c.insert(()=>D,":first-child"),H=c.insert(()=>Z);return C.attr("transform",`translate(${-R/2-I},${y?u.height/2+m/2-N/2-P:-u.height/2-m/2-N/2-P})`),C.attr("style",`color: ${x.get("stroke")??b};`),d.attr("transform",`translate(${-u.width/2-(u.x-(u.left??0))},${y?-O/2:O/2-u.height})`),U.attr("transform",`translate(0,${y?u.height/2+m/2:-u.height/2-m/2})`),In(t,H),t.intersect=function(L){return zt.info("iconSquare intersect",t,L),kn.rect(t,L)},c}ie(oue,"iconCircle");async function lue(e,t,{config:{themeVariables:n,flowchart:r}}){const{labelStyles:s}=jn(t);t.labelStyle=s;const i=t.assetHeight??48,a=t.assetWidth??48,o=Math.max(i,a),l=r==null?void 0:r.wrappingWidth;t.width=Math.max(o,l??0);const{shapeSvg:c,bbox:u,halfPadding:d,label:h}=await fr(e,t,"icon-shape default"),m=t.pos==="t",y=o+d*2,b=o+d*2,{nodeBorder:v,mainBkg:x}=n,{stylesMap:w}=Eb(t),S=-b/2,k=-y/2,C=t.label?8:0,T=Tn.svg(c),R=Rn(t,{});t.look!=="handDrawn"&&(R.roughness=0,R.fillStyle="solid");const N=w.get("fill");R.stroke=N??x;const I=T.path(ff(S,k,b,y,5),R),P=Math.max(b,u.width),B=y+u.height+C,D=T.rectangle(-P/2,-B/2,P,B,{...R,fill:"transparent",stroke:"none"}),W=c.insert(()=>I,":first-child").attr("class","icon-shape2"),O=c.insert(()=>D);if(t.icon){const Z=c.append("g");Z.html(`<g>${await sA(t.icon,{height:o,width:o,fallbackPrefix:""})}</g>`);const U=Z.node().getBBox(),H=U.width,L=U.height,te=U.x,V=U.y;Z.attr("transform",`translate(${-H/2-te},${m?u.height/2+C/2-L/2-V:-u.height/2-C/2-L/2-V})`),Z.attr("style",`color: ${w.get("stroke")??v};`)}return h.attr("transform",`translate(${-u.width/2-(u.x-(u.left??0))},${m?-B/2:B/2-u.height})`),W.attr("transform",`translate(0,${m?u.height/2+C/2:-u.height/2-C/2})`),In(t,O),t.intersect=function(Z){if(zt.info("iconSquare intersect",t,Z),!t.label)return kn.rect(t,Z);const U=t.x??0,H=t.y??0,L=t.height??0;let te=[];return m?te=[{x:U-u.width/2,y:H-L/2},{x:U+u.width/2,y:H-L/2},{x:U+u.width/2,y:H-L/2+u.height+C},{x:U+b/2,y:H-L/2+u.height+C},{x:U+b/2,y:H+L/2},{x:U-b/2,y:H+L/2},{x:U-b/2,y:H-L/2+u.height+C},{x:U-u.width/2,y:H-L/2+u.height+C}]:te=[{x:U-b/2,y:H-L/2},{x:U+b/2,y:H-L/2},{x:U+b/2,y:H-L/2+y},{x:U+u.width/2,y:H-L/2+y},{x:U+u.width/2/2,y:H+L/2},{x:U-u.width/2,y:H+L/2},{x:U-u.width/2,y:H-L/2+y},{x:U-b/2,y:H-L/2+y}],kn.polygon(t,te,Z)},c}ie(lue,"iconRounded");async function cue(e,t,{config:{themeVariables:n,flowchart:r}}){const{labelStyles:s}=jn(t);t.labelStyle=s;const i=t.assetHeight??48,a=t.assetWidth??48,o=Math.max(i,a),l=r==null?void 0:r.wrappingWidth;t.width=Math.max(o,l??0);const{shapeSvg:c,bbox:u,halfPadding:d,label:h}=await fr(e,t,"icon-shape default"),m=t.pos==="t",y=o+d*2,b=o+d*2,{nodeBorder:v,mainBkg:x}=n,{stylesMap:w}=Eb(t),S=-b/2,k=-y/2,C=t.label?8:0,T=Tn.svg(c),R=Rn(t,{});t.look!=="handDrawn"&&(R.roughness=0,R.fillStyle="solid");const N=w.get("fill");R.stroke=N??x;const I=T.path(ff(S,k,b,y,.1),R),P=Math.max(b,u.width),B=y+u.height+C,D=T.rectangle(-P/2,-B/2,P,B,{...R,fill:"transparent",stroke:"none"}),W=c.insert(()=>I,":first-child"),O=c.insert(()=>D);if(t.icon){const Z=c.append("g");Z.html(`<g>${await sA(t.icon,{height:o,width:o,fallbackPrefix:""})}</g>`);const U=Z.node().getBBox(),H=U.width,L=U.height,te=U.x,V=U.y;Z.attr("transform",`translate(${-H/2-te},${m?u.height/2+C/2-L/2-V:-u.height/2-C/2-L/2-V})`),Z.attr("style",`color: ${w.get("stroke")??v};`)}return h.attr("transform",`translate(${-u.width/2-(u.x-(u.left??0))},${m?-B/2:B/2-u.height})`),W.attr("transform",`translate(0,${m?u.height/2+C/2:-u.height/2-C/2})`),In(t,O),t.intersect=function(Z){if(zt.info("iconSquare intersect",t,Z),!t.label)return kn.rect(t,Z);const U=t.x??0,H=t.y??0,L=t.height??0;let te=[];return m?te=[{x:U-u.width/2,y:H-L/2},{x:U+u.width/2,y:H-L/2},{x:U+u.width/2,y:H-L/2+u.height+C},{x:U+b/2,y:H-L/2+u.height+C},{x:U+b/2,y:H+L/2},{x:U-b/2,y:H+L/2},{x:U-b/2,y:H-L/2+u.height+C},{x:U-u.width/2,y:H-L/2+u.height+C}]:te=[{x:U-b/2,y:H-L/2},{x:U+b/2,y:H-L/2},{x:U+b/2,y:H-L/2+y},{x:U+u.width/2,y:H-L/2+y},{x:U+u.width/2/2,y:H+L/2},{x:U-u.width/2,y:H+L/2},{x:U-u.width/2,y:H-L/2+y},{x:U-b/2,y:H-L/2+y}],kn.polygon(t,te,Z)},c}ie(cue,"iconSquare");async function uue(e,t,{config:{flowchart:n}}){const r=new Image;r.src=(t==null?void 0:t.img)??"",await r.decode();const s=Number(r.naturalWidth.toString().replace("px","")),i=Number(r.naturalHeight.toString().replace("px",""));t.imageAspectRatio=s/i;const{labelStyles:a}=jn(t);t.labelStyle=a;const o=n==null?void 0:n.wrappingWidth;t.defaultWidth=n==null?void 0:n.wrappingWidth;const l=Math.max(t.label?o??0:0,(t==null?void 0:t.assetWidth)??s),c=t.constraint==="on"&&t!=null&&t.assetHeight?t.assetHeight*t.imageAspectRatio:l,u=t.constraint==="on"?c/t.imageAspectRatio:(t==null?void 0:t.assetHeight)??i;t.width=Math.max(c,o??0);const{shapeSvg:d,bbox:h,label:m}=await fr(e,t,"image-shape default"),y=t.pos==="t",b=-c/2,v=-u/2,x=t.label?8:0,w=Tn.svg(d),S=Rn(t,{});t.look!=="handDrawn"&&(S.roughness=0,S.fillStyle="solid");const k=w.rectangle(b,v,c,u,S),C=Math.max(c,h.width),T=u+h.height+x,R=w.rectangle(-C/2,-T/2,C,T,{...S,fill:"none",stroke:"none"}),N=d.insert(()=>k,":first-child"),I=d.insert(()=>R);if(t.img){const P=d.append("image");P.attr("href",t.img),P.attr("width",c),P.attr("height",u),P.attr("preserveAspectRatio","none"),P.attr("transform",`translate(${-c/2},${y?T/2-u:-T/2})`)}return m.attr("transform",`translate(${-h.width/2-(h.x-(h.left??0))},${y?-u/2-h.height/2-x/2:u/2-h.height/2+x/2})`),N.attr("transform",`translate(0,${y?h.height/2+x/2:-h.height/2-x/2})`),In(t,I),t.intersect=function(P){if(zt.info("iconSquare intersect",t,P),!t.label)return kn.rect(t,P);const B=t.x??0,D=t.y??0,W=t.height??0;let O=[];return y?O=[{x:B-h.width/2,y:D-W/2},{x:B+h.width/2,y:D-W/2},{x:B+h.width/2,y:D-W/2+h.height+x},{x:B+c/2,y:D-W/2+h.height+x},{x:B+c/2,y:D+W/2},{x:B-c/2,y:D+W/2},{x:B-c/2,y:D-W/2+h.height+x},{x:B-h.width/2,y:D-W/2+h.height+x}]:O=[{x:B-c/2,y:D-W/2},{x:B+c/2,y:D-W/2},{x:B+c/2,y:D-W/2+u},{x:B+h.width/2,y:D-W/2+u},{x:B+h.width/2/2,y:D+W/2},{x:B-h.width/2,y:D+W/2},{x:B-h.width/2,y:D-W/2+u},{x:B-c/2,y:D-W/2+u}],kn.polygon(t,O,P)},d}ie(uue,"imageSquare");async function due(e,t){const{labelStyles:n,nodeStyles:r}=jn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await fr(e,t,rr(t)),a=Math.max(i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),o=Math.max(i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),l=[{x:0,y:0},{x:a,y:0},{x:a+3*o/6,y:-o},{x:-3*o/6,y:-o}];let c;const{cssStyles:u}=t;if(t.look==="handDrawn"){const d=Tn.svg(s),h=Rn(t,{}),m=Xr(l),y=d.path(m,h);c=s.insert(()=>y,":first-child").attr("transform",`translate(${-a/2}, ${o/2})`),u&&c.attr("style",u)}else c=hf(s,a,o,l);return r&&c.attr("style",r),t.width=a,t.height=o,In(t,c),t.intersect=function(d){return kn.polygon(t,l,d)},s}ie(due,"inv_trapezoid");async function b_(e,t,n){const{labelStyles:r,nodeStyles:s}=jn(t);t.labelStyle=r;const{shapeSvg:i,bbox:a}=await fr(e,t,rr(t)),o=Math.max(a.width+n.labelPaddingX*2,(t==null?void 0:t.width)||0),l=Math.max(a.height+n.labelPaddingY*2,(t==null?void 0:t.height)||0),c=-o/2,u=-l/2;let d,{rx:h,ry:m}=t;const{cssStyles:y}=t;if(n!=null&&n.rx&&n.ry&&(h=n.rx,m=n.ry),t.look==="handDrawn"){const b=Tn.svg(i),v=Rn(t,{}),x=h||m?b.path(ff(c,u,o,l,h||0),v):b.rectangle(c,u,o,l,v);d=i.insert(()=>x,":first-child"),d.attr("class","basic label-container").attr("style",io(y))}else d=i.insert("rect",":first-child"),d.attr("class","basic label-container").attr("style",s).attr("rx",io(h)).attr("ry",io(m)).attr("x",c).attr("y",u).attr("width",o).attr("height",l);return In(t,d),t.intersect=function(b){return kn.rect(t,b)},i}ie(b_,"drawRect");async function fue(e,t){const{shapeSvg:n,bbox:r,label:s}=await fr(e,t,"label"),i=n.insert("rect",":first-child");return i.attr("width",.1).attr("height",.1),n.attr("class","label edgeLabel"),s.attr("transform",`translate(${-(r.width/2)-(r.x-(r.left??0))}, ${-(r.height/2)-(r.y-(r.top??0))})`),In(t,i),t.intersect=function(l){return kn.rect(t,l)},n}ie(fue,"labelRect");async function hue(e,t){const{labelStyles:n,nodeStyles:r}=jn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await fr(e,t,rr(t)),a=Math.max(i.width+(t.padding??0),(t==null?void 0:t.width)??0),o=Math.max(i.height+(t.padding??0),(t==null?void 0:t.height)??0),l=[{x:0,y:0},{x:a+3*o/6,y:0},{x:a,y:-o},{x:-(3*o)/6,y:-o}];let c;const{cssStyles:u}=t;if(t.look==="handDrawn"){const d=Tn.svg(s),h=Rn(t,{}),m=Xr(l),y=d.path(m,h);c=s.insert(()=>y,":first-child").attr("transform",`translate(${-a/2}, ${o/2})`),u&&c.attr("style",u)}else c=hf(s,a,o,l);return r&&c.attr("style",r),t.width=a,t.height=o,In(t,c),t.intersect=function(d){return kn.polygon(t,l,d)},s}ie(hue,"lean_left");async function pue(e,t){const{labelStyles:n,nodeStyles:r}=jn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await fr(e,t,rr(t)),a=Math.max(i.width+(t.padding??0),(t==null?void 0:t.width)??0),o=Math.max(i.height+(t.padding??0),(t==null?void 0:t.height)??0),l=[{x:-3*o/6,y:0},{x:a,y:0},{x:a+3*o/6,y:-o},{x:0,y:-o}];let c;const{cssStyles:u}=t;if(t.look==="handDrawn"){const d=Tn.svg(s),h=Rn(t,{}),m=Xr(l),y=d.path(m,h);c=s.insert(()=>y,":first-child").attr("transform",`translate(${-a/2}, ${o/2})`),u&&c.attr("style",u)}else c=hf(s,a,o,l);return r&&c.attr("style",r),t.width=a,t.height=o,In(t,c),t.intersect=function(d){return kn.polygon(t,l,d)},s}ie(pue,"lean_right");function mue(e,t){const{labelStyles:n,nodeStyles:r}=jn(t);t.label="",t.labelStyle=n;const s=e.insert("g").attr("class",rr(t)).attr("id",t.domId??t.id),{cssStyles:i}=t,a=Math.max(35,(t==null?void 0:t.width)??0),o=Math.max(35,(t==null?void 0:t.height)??0),l=7,c=[{x:a,y:0},{x:0,y:o+l/2},{x:a-2*l,y:o+l/2},{x:0,y:2*o},{x:a,y:o-l/2},{x:2*l,y:o-l/2}],u=Tn.svg(s),d=Rn(t,{});t.look!=="handDrawn"&&(d.roughness=0,d.fillStyle="solid");const h=Xr(c),m=u.path(h,d),y=s.insert(()=>m,":first-child");return i&&t.look!=="handDrawn"&&y.selectAll("path").attr("style",i),r&&t.look!=="handDrawn"&&y.selectAll("path").attr("style",r),y.attr("transform",`translate(-${a/2},${-o})`),In(t,y),t.intersect=function(b){return zt.info("lightningBolt intersect",t,b),kn.polygon(t,c,b)},s}ie(mue,"lightningBolt");var Gat=ie((e,t,n,r,s,i,a)=>[`M${e},${t+i}`,`a${s},${i} 0,0,0 ${n},0`,`a${s},${i} 0,0,0 ${-n},0`,`l0,${r}`,`a${s},${i} 0,0,0 ${n},0`,`l0,${-r}`,`M${e},${t+i+a}`,`a${s},${i} 0,0,0 ${n},0`].join(" "),"createCylinderPathD"),Kat=ie((e,t,n,r,s,i,a)=>[`M${e},${t+i}`,`M${e+n},${t+i}`,`a${s},${i} 0,0,0 ${-n},0`,`l0,${r}`,`a${s},${i} 0,0,0 ${n},0`,`l0,${-r}`,`M${e},${t+i+a}`,`a${s},${i} 0,0,0 ${n},0`].join(" "),"createOuterCylinderPathD"),Yat=ie((e,t,n,r,s,i)=>[`M${e-n/2},${-r/2}`,`a${s},${i} 0,0,0 ${n},0`].join(" "),"createInnerCylinderPathD");async function gue(e,t){const{labelStyles:n,nodeStyles:r}=jn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await fr(e,t,rr(t)),o=Math.max(i.width+(t.padding??0),t.width??0),l=o/2,c=l/(2.5+o/50),u=Math.max(i.height+c+(t.padding??0),t.height??0),d=u*.1;let h;const{cssStyles:m}=t;if(t.look==="handDrawn"){const y=Tn.svg(s),b=Kat(0,0,o,u,l,c,d),v=Yat(0,c,o,u,l,c),x=Rn(t,{}),w=y.path(b,x),S=y.path(v,x);s.insert(()=>S,":first-child").attr("class","line"),h=s.insert(()=>w,":first-child"),h.attr("class","basic label-container"),m&&h.attr("style",m)}else{const y=Gat(0,0,o,u,l,c,d);h=s.insert("path",":first-child").attr("d",y).attr("class","basic label-container").attr("style",io(m)).attr("style",r)}return h.attr("label-offset-y",c),h.attr("transform",`translate(${-o/2}, ${-(u/2+c)})`),In(t,h),a.attr("transform",`translate(${-(i.width/2)-(i.x-(i.left??0))}, ${-(i.height/2)+c-(i.y-(i.top??0))})`),t.intersect=function(y){const b=kn.rect(t,y),v=b.x-(t.x??0);if(l!=0&&(Math.abs(v)<(t.width??0)/2||Math.abs(v)==(t.width??0)/2&&Math.abs(b.y-(t.y??0))>(t.height??0)/2-c)){let x=c*c*(1-v*v/(l*l));x>0&&(x=Math.sqrt(x)),x=c-x,y.y-(t.y??0)>0&&(x=-x),b.y+=x}return b},s}ie(gue,"linedCylinder");async function yue(e,t){const{labelStyles:n,nodeStyles:r}=jn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await fr(e,t,rr(t)),o=Math.max(i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),l=Math.max(i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),c=l/4,u=l+c,{cssStyles:d}=t,h=Tn.svg(s),m=Rn(t,{});t.look!=="handDrawn"&&(m.roughness=0,m.fillStyle="solid");const y=[{x:-o/2-o/2*.1,y:-u/2},{x:-o/2-o/2*.1,y:u/2},...Lh(-o/2-o/2*.1,u/2,o/2+o/2*.1,u/2,c,.8),{x:o/2+o/2*.1,y:-u/2},{x:-o/2-o/2*.1,y:-u/2},{x:-o/2,y:-u/2},{x:-o/2,y:u/2*1.1},{x:-o/2,y:-u/2}],b=h.polygon(y.map(x=>[x.x,x.y]),m),v=s.insert(()=>b,":first-child");return v.attr("class","basic label-container"),d&&t.look!=="handDrawn"&&v.selectAll("path").attr("style",d),r&&t.look!=="handDrawn"&&v.selectAll("path").attr("style",r),v.attr("transform",`translate(0,${-c/2})`),a.attr("transform",`translate(${-o/2+(t.padding??0)+o/2*.1/2-(i.x-(i.left??0))},${-l/2+(t.padding??0)-c/2-(i.y-(i.top??0))})`),In(t,v),t.intersect=function(x){return kn.polygon(t,y,x)},s}ie(yue,"linedWaveEdgedRect");async function bue(e,t){const{labelStyles:n,nodeStyles:r}=jn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await fr(e,t,rr(t)),o=Math.max(i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),l=Math.max(i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),c=5,u=-o/2,d=-l/2,{cssStyles:h}=t,m=Tn.svg(s),y=Rn(t,{}),b=[{x:u-c,y:d+c},{x:u-c,y:d+l+c},{x:u+o-c,y:d+l+c},{x:u+o-c,y:d+l},{x:u+o,y:d+l},{x:u+o,y:d+l-c},{x:u+o+c,y:d+l-c},{x:u+o+c,y:d-c},{x:u+c,y:d-c},{x:u+c,y:d},{x:u,y:d},{x:u,y:d+c}],v=[{x:u,y:d+c},{x:u+o-c,y:d+c},{x:u+o-c,y:d+l},{x:u+o,y:d+l},{x:u+o,y:d},{x:u,y:d}];t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");const x=Xr(b),w=m.path(x,y),S=Xr(v),k=m.path(S,{...y,fill:"none"}),C=s.insert(()=>k,":first-child");return C.insert(()=>w,":first-child"),C.attr("class","basic label-container"),h&&t.look!=="handDrawn"&&C.selectAll("path").attr("style",h),r&&t.look!=="handDrawn"&&C.selectAll("path").attr("style",r),a.attr("transform",`translate(${-(i.width/2)-c-(i.x-(i.left??0))}, ${-(i.height/2)+c-(i.y-(i.top??0))})`),In(t,C),t.intersect=function(T){return kn.polygon(t,b,T)},s}ie(bue,"multiRect");async function vue(e,t){const{labelStyles:n,nodeStyles:r}=jn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await fr(e,t,rr(t)),o=Math.max(i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),l=Math.max(i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),c=l/4,u=l+c,d=-o/2,h=-u/2,m=5,{cssStyles:y}=t,b=Lh(d-m,h+u+m,d+o-m,h+u+m,c,.8),v=b==null?void 0:b[b.length-1],x=[{x:d-m,y:h+m},{x:d-m,y:h+u+m},...b,{x:d+o-m,y:v.y-m},{x:d+o,y:v.y-m},{x:d+o,y:v.y-2*m},{x:d+o+m,y:v.y-2*m},{x:d+o+m,y:h-m},{x:d+m,y:h-m},{x:d+m,y:h},{x:d,y:h},{x:d,y:h+m}],w=[{x:d,y:h+m},{x:d+o-m,y:h+m},{x:d+o-m,y:v.y-m},{x:d+o,y:v.y-m},{x:d+o,y:h},{x:d,y:h}],S=Tn.svg(s),k=Rn(t,{});t.look!=="handDrawn"&&(k.roughness=0,k.fillStyle="solid");const C=Xr(x),T=S.path(C,k),R=Xr(w),N=S.path(R,k),I=s.insert(()=>T,":first-child");return I.insert(()=>N),I.attr("class","basic label-container"),y&&t.look!=="handDrawn"&&I.selectAll("path").attr("style",y),r&&t.look!=="handDrawn"&&I.selectAll("path").attr("style",r),I.attr("transform",`translate(0,${-c/2})`),a.attr("transform",`translate(${-(i.width/2)-m-(i.x-(i.left??0))}, ${-(i.height/2)+m-c/2-(i.y-(i.top??0))})`),In(t,I),t.intersect=function(P){return kn.polygon(t,x,P)},s}ie(vue,"multiWaveEdgedRectangle");async function xue(e,t,{config:{themeVariables:n}}){var x;const{labelStyles:r,nodeStyles:s}=jn(t);t.labelStyle=r,t.useHtmlLabels||((x=Po().flowchart)==null?void 0:x.htmlLabels)!==!1||(t.centerLabel=!0);const{shapeSvg:a,bbox:o}=await fr(e,t,rr(t)),l=Math.max(o.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),c=Math.max(o.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),u=-l/2,d=-c/2,{cssStyles:h}=t,m=Tn.svg(a),y=Rn(t,{fill:n.noteBkgColor,stroke:n.noteBorderColor});t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");const b=m.rectangle(u,d,l,c,y),v=a.insert(()=>b,":first-child");return v.attr("class","basic label-container"),h&&t.look!=="handDrawn"&&v.selectAll("path").attr("style",h),s&&t.look!=="handDrawn"&&v.selectAll("path").attr("style",s),In(t,v),t.intersect=function(w){return kn.rect(t,w)},a}ie(xue,"note");var Zat=ie((e,t,n)=>[`M${e+n/2},${t}`,`L${e+n},${t-n/2}`,`L${e+n/2},${t-n}`,`L${e},${t-n/2}`,"Z"].join(" "),"createDecisionBoxPathD");async function wue(e,t){const{labelStyles:n,nodeStyles:r}=jn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await fr(e,t,rr(t)),a=i.width+t.padding,o=i.height+t.padding,l=a+o,c=[{x:l/2,y:0},{x:l,y:-l/2},{x:l/2,y:-l},{x:0,y:-l/2}];let u;const{cssStyles:d}=t;if(t.look==="handDrawn"){const h=Tn.svg(s),m=Rn(t,{}),y=Zat(0,0,l),b=h.path(y,m);u=s.insert(()=>b,":first-child").attr("transform",`translate(${-l/2}, ${l/2})`),d&&u.attr("style",d)}else u=hf(s,l,l,c);return r&&u.attr("style",r),In(t,u),t.intersect=function(h){return zt.debug(`APA12 Intersect called SPLIT
point:`,h,`
node:
`,t,`
res:`,kn.polygon(t,c,h)),kn.polygon(t,c,h)},s}ie(wue,"question");async function _ue(e,t){const{labelStyles:n,nodeStyles:r}=jn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await fr(e,t,rr(t)),o=Math.max(i.width+(t.padding??0),(t==null?void 0:t.width)??0),l=Math.max(i.height+(t.padding??0),(t==null?void 0:t.height)??0),c=-o/2,u=-l/2,d=u/2,h=[{x:c+d,y:u},{x:c,y:0},{x:c+d,y:-u},{x:-c,y:-u},{x:-c,y:u}],{cssStyles:m}=t,y=Tn.svg(s),b=Rn(t,{});t.look!=="handDrawn"&&(b.roughness=0,b.fillStyle="solid");const v=Xr(h),x=y.path(v,b),w=s.insert(()=>x,":first-child");return w.attr("class","basic label-container"),m&&t.look!=="handDrawn"&&w.selectAll("path").attr("style",m),r&&t.look!=="handDrawn"&&w.selectAll("path").attr("style",r),w.attr("transform",`translate(${-d/2},0)`),a.attr("transform",`translate(${-d/2-i.width/2-(i.x-(i.left??0))}, ${-(i.height/2)-(i.y-(i.top??0))})`),In(t,w),t.intersect=function(S){return kn.polygon(t,h,S)},s}ie(_ue,"rect_left_inv_arrow");async function Sue(e,t){var N,I;const{labelStyles:n,nodeStyles:r}=jn(t);t.labelStyle=n;let s;t.cssClasses?s="node "+t.cssClasses:s="node default";const i=e.insert("g").attr("class",s).attr("id",t.domId||t.id),a=i.insert("g"),o=i.insert("g").attr("class","label").attr("style",r),l=t.description,c=t.label,u=o.node().appendChild(await dm(c,t.labelStyle,!0,!0));let d={width:0,height:0};if(Gi((I=(N=ls())==null?void 0:N.flowchart)==null?void 0:I.htmlLabels)){const P=u.children[0],B=Kr(u);d=P.getBoundingClientRect(),B.attr("width",d.width),B.attr("height",d.height)}zt.info("Text 2",l);const h=l||[],m=u.getBBox(),y=o.node().appendChild(await dm(h.join?h.join("<br/>"):h,t.labelStyle,!0,!0)),b=y.children[0],v=Kr(y);d=b.getBoundingClientRect(),v.attr("width",d.width),v.attr("height",d.height);const x=(t.padding||0)/2;Kr(y).attr("transform","translate( "+(d.width>m.width?0:(m.width-d.width)/2)+", "+(m.height+x+5)+")"),Kr(u).attr("transform","translate( "+(d.width<m.width?0:-(m.width-d.width)/2)+", 0)"),d=o.node().getBBox(),o.attr("transform","translate("+-d.width/2+", "+(-d.height/2-x+3)+")");const w=d.width+(t.padding||0),S=d.height+(t.padding||0),k=-d.width/2-x,C=-d.height/2-x;let T,R;if(t.look==="handDrawn"){const P=Tn.svg(i),B=Rn(t,{}),D=P.path(ff(k,C,w,S,t.rx||0),B),W=P.line(-d.width/2-x,-d.height/2-x+m.height+x,d.width/2+x,-d.height/2-x+m.height+x,B);R=i.insert(()=>(zt.debug("Rough node insert CXC",D),W),":first-child"),T=i.insert(()=>(zt.debug("Rough node insert CXC",D),D),":first-child")}else T=a.insert("rect",":first-child"),R=a.insert("line"),T.attr("class","outer title-state").attr("style",r).attr("x",-d.width/2-x).attr("y",-d.height/2-x).attr("width",d.width+(t.padding||0)).attr("height",d.height+(t.padding||0)),R.attr("class","divider").attr("x1",-d.width/2-x).attr("x2",d.width/2+x).attr("y1",-d.height/2-x+m.height+x).attr("y2",-d.height/2-x+m.height+x);return In(t,T),t.intersect=function(P){return kn.rect(t,P)},i}ie(Sue,"rectWithTitle");async function Cue(e,t){const n={rx:5,ry:5,labelPaddingX:((t==null?void 0:t.padding)||0)*1,labelPaddingY:((t==null?void 0:t.padding)||0)*1};return b_(e,t,n)}ie(Cue,"roundedRect");async function kue(e,t){const{labelStyles:n,nodeStyles:r}=jn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await fr(e,t,rr(t)),o=(t==null?void 0:t.padding)??0,l=Math.max(i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),c=Math.max(i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),u=-i.width/2-o,d=-i.height/2-o,{cssStyles:h}=t,m=Tn.svg(s),y=Rn(t,{});t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");const b=[{x:u,y:d},{x:u+l+8,y:d},{x:u+l+8,y:d+c},{x:u-8,y:d+c},{x:u-8,y:d},{x:u,y:d},{x:u,y:d+c}],v=m.polygon(b.map(w=>[w.x,w.y]),y),x=s.insert(()=>v,":first-child");return x.attr("class","basic label-container").attr("style",io(h)),r&&t.look!=="handDrawn"&&x.selectAll("path").attr("style",r),h&&t.look!=="handDrawn"&&x.selectAll("path").attr("style",r),a.attr("transform",`translate(${-l/2+4+(t.padding??0)-(i.x-(i.left??0))},${-c/2+(t.padding??0)-(i.y-(i.top??0))})`),In(t,x),t.intersect=function(w){return kn.rect(t,w)},s}ie(kue,"shadedProcess");async function Eue(e,t){const{labelStyles:n,nodeStyles:r}=jn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await fr(e,t,rr(t)),o=Math.max(i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),l=Math.max(i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),c=-o/2,u=-l/2,{cssStyles:d}=t,h=Tn.svg(s),m=Rn(t,{});t.look!=="handDrawn"&&(m.roughness=0,m.fillStyle="solid");const y=[{x:c,y:u},{x:c,y:u+l},{x:c+o,y:u+l},{x:c+o,y:u-l/2}],b=Xr(y),v=h.path(b,m),x=s.insert(()=>v,":first-child");return x.attr("class","basic label-container"),d&&t.look!=="handDrawn"&&x.selectChildren("path").attr("style",d),r&&t.look!=="handDrawn"&&x.selectChildren("path").attr("style",r),x.attr("transform",`translate(0, ${l/4})`),a.attr("transform",`translate(${-o/2+(t.padding??0)-(i.x-(i.left??0))}, ${-l/4+(t.padding??0)-(i.y-(i.top??0))})`),In(t,x),t.intersect=function(w){return kn.polygon(t,y,w)},s}ie(Eue,"slopedRect");async function Tue(e,t){const n={rx:0,ry:0,labelPaddingX:((t==null?void 0:t.padding)||0)*2,labelPaddingY:((t==null?void 0:t.padding)||0)*1};return b_(e,t,n)}ie(Tue,"squareRect");async function Aue(e,t){const{labelStyles:n,nodeStyles:r}=jn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await fr(e,t,rr(t)),a=i.height+t.padding,o=i.width+a/4+t.padding;let l;const{cssStyles:c}=t;if(t.look==="handDrawn"){const u=Tn.svg(s),d=Rn(t,{}),h=ff(-o/2,-a/2,o,a,a/2),m=u.path(h,d);l=s.insert(()=>m,":first-child"),l.attr("class","basic label-container").attr("style",io(c))}else l=s.insert("rect",":first-child"),l.attr("class","basic label-container").attr("style",r).attr("rx",a/2).attr("ry",a/2).attr("x",-o/2).attr("y",-a/2).attr("width",o).attr("height",a);return In(t,l),t.intersect=function(u){return kn.rect(t,u)},s}ie(Aue,"stadium");async function Rue(e,t){return b_(e,t,{rx:5,ry:5})}ie(Rue,"state");function Nue(e,t,{config:{themeVariables:n}}){const{labelStyles:r,nodeStyles:s}=jn(t);t.labelStyle=r;const{cssStyles:i}=t,{lineColor:a,stateBorder:o,nodeBorder:l}=n,c=e.insert("g").attr("class","node default").attr("id",t.domId||t.id),u=Tn.svg(c),d=Rn(t,{});t.look!=="handDrawn"&&(d.roughness=0,d.fillStyle="solid");const h=u.circle(0,0,14,{...d,stroke:a,strokeWidth:2}),m=o??l,y=u.circle(0,0,5,{...d,fill:m,stroke:m,strokeWidth:2,fillStyle:"solid"}),b=c.insert(()=>h,":first-child");return b.insert(()=>y),i&&b.selectAll("path").attr("style",i),s&&b.selectAll("path").attr("style",s),In(t,b),t.intersect=function(v){return kn.circle(t,7,v)},c}ie(Nue,"stateEnd");function Mue(e,t,{config:{themeVariables:n}}){const{lineColor:r}=n,s=e.insert("g").attr("class","node default").attr("id",t.domId||t.id);let i;if(t.look==="handDrawn"){const o=Tn.svg(s).circle(0,0,14,Nat(r));i=s.insert(()=>o),i.attr("class","state-start").attr("r",7).attr("width",14).attr("height",14)}else i=s.insert("circle",":first-child"),i.attr("class","state-start").attr("r",7).attr("width",14).attr("height",14);return In(t,i),t.intersect=function(a){return kn.circle(t,7,a)},s}ie(Mue,"stateStart");async function Iue(e,t){const{labelStyles:n,nodeStyles:r}=jn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await fr(e,t,rr(t)),a=((t==null?void 0:t.padding)||0)/2,o=i.width+t.padding,l=i.height+t.padding,c=-i.width/2-a,u=-i.height/2-a,d=[{x:0,y:0},{x:o,y:0},{x:o,y:-l},{x:0,y:-l},{x:0,y:0},{x:-8,y:0},{x:o+8,y:0},{x:o+8,y:-l},{x:-8,y:-l},{x:-8,y:0}];if(t.look==="handDrawn"){const h=Tn.svg(s),m=Rn(t,{}),y=h.rectangle(c-8,u,o+16,l,m),b=h.line(c,u,c,u+l,m),v=h.line(c+o,u,c+o,u+l,m);s.insert(()=>b,":first-child"),s.insert(()=>v,":first-child");const x=s.insert(()=>y,":first-child"),{cssStyles:w}=t;x.attr("class","basic label-container").attr("style",io(w)),In(t,x)}else{const h=hf(s,o,l,d);r&&h.attr("style",r),In(t,h)}return t.intersect=function(h){return kn.polygon(t,d,h)},s}ie(Iue,"subroutine");async function jue(e,t){const{labelStyles:n,nodeStyles:r}=jn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await fr(e,t,rr(t)),a=Math.max(i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),o=Math.max(i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),l=-a/2,c=-o/2,u=.2*o,d=.2*o,{cssStyles:h}=t,m=Tn.svg(s),y=Rn(t,{}),b=[{x:l-u/2,y:c},{x:l+a+u/2,y:c},{x:l+a+u/2,y:c+o},{x:l-u/2,y:c+o}],v=[{x:l+a-u/2,y:c+o},{x:l+a+u/2,y:c+o},{x:l+a+u/2,y:c+o-d}];t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");const x=Xr(b),w=m.path(x,y),S=Xr(v),k=m.path(S,{...y,fillStyle:"solid"}),C=s.insert(()=>k,":first-child");return C.insert(()=>w,":first-child"),C.attr("class","basic label-container"),h&&t.look!=="handDrawn"&&C.selectAll("path").attr("style",h),r&&t.look!=="handDrawn"&&C.selectAll("path").attr("style",r),In(t,C),t.intersect=function(T){return kn.polygon(t,b,T)},s}ie(jue,"taggedRect");async function Oue(e,t){const{labelStyles:n,nodeStyles:r}=jn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await fr(e,t,rr(t)),o=Math.max(i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),l=Math.max(i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),c=l/4,u=.2*o,d=.2*l,h=l+c,{cssStyles:m}=t,y=Tn.svg(s),b=Rn(t,{});t.look!=="handDrawn"&&(b.roughness=0,b.fillStyle="solid");const v=[{x:-o/2-o/2*.1,y:h/2},...Lh(-o/2-o/2*.1,h/2,o/2+o/2*.1,h/2,c,.8),{x:o/2+o/2*.1,y:-h/2},{x:-o/2-o/2*.1,y:-h/2}],x=-o/2+o/2*.1,w=-h/2-d*.4,S=[{x:x+o-u,y:(w+l)*1.4},{x:x+o,y:w+l-d},{x:x+o,y:(w+l)*.9},...Lh(x+o,(w+l)*1.3,x+o-u,(w+l)*1.5,-l*.03,.5)],k=Xr(v),C=y.path(k,b),T=Xr(S),R=y.path(T,{...b,fillStyle:"solid"}),N=s.insert(()=>R,":first-child");return N.insert(()=>C,":first-child"),N.attr("class","basic label-container"),m&&t.look!=="handDrawn"&&N.selectAll("path").attr("style",m),r&&t.look!=="handDrawn"&&N.selectAll("path").attr("style",r),N.attr("transform",`translate(0,${-c/2})`),a.attr("transform",`translate(${-o/2+(t.padding??0)-(i.x-(i.left??0))},${-l/2+(t.padding??0)-c/2-(i.y-(i.top??0))})`),In(t,N),t.intersect=function(I){return kn.polygon(t,v,I)},s}ie(Oue,"taggedWaveEdgedRectangle");async function Pue(e,t){const{labelStyles:n,nodeStyles:r}=jn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await fr(e,t,rr(t)),a=Math.max(i.width+t.padding,(t==null?void 0:t.width)||0),o=Math.max(i.height+t.padding,(t==null?void 0:t.height)||0),l=-a/2,c=-o/2,u=s.insert("rect",":first-child");return u.attr("class","text").attr("style",r).attr("rx",0).attr("ry",0).attr("x",l).attr("y",c).attr("width",a).attr("height",o),In(t,u),t.intersect=function(d){return kn.rect(t,d)},s}ie(Pue,"text");var Xat=ie((e,t,n,r,s,i)=>`M${e},${t}
    a${s},${i} 0,0,1 0,${-r}
    l${n},0
    a${s},${i} 0,0,1 0,${r}
    M${n},${-r}
    a${s},${i} 0,0,0 0,${r}
    l${-n},0`,"createCylinderPathD"),Jat=ie((e,t,n,r,s,i)=>[`M${e},${t}`,`M${e+n},${t}`,`a${s},${i} 0,0,0 0,${-r}`,`l${-n},0`,`a${s},${i} 0,0,0 0,${r}`,`l${n},0`].join(" "),"createOuterCylinderPathD"),Qat=ie((e,t,n,r,s,i)=>[`M${e+n/2},${-r/2}`,`a${s},${i} 0,0,0 0,${r}`].join(" "),"createInnerCylinderPathD");async function Due(e,t){const{labelStyles:n,nodeStyles:r}=jn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a,halfPadding:o}=await fr(e,t,rr(t)),l=t.look==="neo"?o*2:o,c=i.height+l,u=c/2,d=u/(2.5+c/50),h=i.width+d+l,{cssStyles:m}=t;let y;if(t.look==="handDrawn"){const b=Tn.svg(s),v=Jat(0,0,h,c,d,u),x=Qat(0,0,h,c,d,u),w=b.path(v,Rn(t,{})),S=b.path(x,Rn(t,{fill:"none"}));y=s.insert(()=>S,":first-child"),y=s.insert(()=>w,":first-child"),y.attr("class","basic label-container"),m&&y.attr("style",m)}else{const b=Xat(0,0,h,c,d,u);y=s.insert("path",":first-child").attr("d",b).attr("class","basic label-container").attr("style",io(m)).attr("style",r),y.attr("class","basic label-container"),m&&y.selectAll("path").attr("style",m),r&&y.selectAll("path").attr("style",r)}return y.attr("label-offset-x",d),y.attr("transform",`translate(${-h/2}, ${c/2} )`),a.attr("transform",`translate(${-(i.width/2)-d-(i.x-(i.left??0))}, ${-(i.height/2)-(i.y-(i.top??0))})`),In(t,y),t.intersect=function(b){const v=kn.rect(t,b),x=v.y-(t.y??0);if(u!=0&&(Math.abs(x)<(t.height??0)/2||Math.abs(x)==(t.height??0)/2&&Math.abs(v.x-(t.x??0))>(t.width??0)/2-d)){let w=d*d*(1-x*x/(u*u));w!=0&&(w=Math.sqrt(Math.abs(w))),w=d-w,b.x-(t.x??0)>0&&(w=-w),v.x+=w}return v},s}ie(Due,"tiltedCylinder");async function Fue(e,t){const{labelStyles:n,nodeStyles:r}=jn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await fr(e,t,rr(t)),a=i.width+t.padding,o=i.height+t.padding,l=[{x:-3*o/6,y:0},{x:a+3*o/6,y:0},{x:a,y:-o},{x:0,y:-o}];let c;const{cssStyles:u}=t;if(t.look==="handDrawn"){const d=Tn.svg(s),h=Rn(t,{}),m=Xr(l),y=d.path(m,h);c=s.insert(()=>y,":first-child").attr("transform",`translate(${-a/2}, ${o/2})`),u&&c.attr("style",u)}else c=hf(s,a,o,l);return r&&c.attr("style",r),t.width=a,t.height=o,In(t,c),t.intersect=function(d){return kn.polygon(t,l,d)},s}ie(Fue,"trapezoid");async function Lue(e,t){const{labelStyles:n,nodeStyles:r}=jn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await fr(e,t,rr(t)),a=60,o=20,l=Math.max(a,i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),c=Math.max(o,i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),{cssStyles:u}=t,d=Tn.svg(s),h=Rn(t,{});t.look!=="handDrawn"&&(h.roughness=0,h.fillStyle="solid");const m=[{x:-l/2*.8,y:-c/2},{x:l/2*.8,y:-c/2},{x:l/2,y:-c/2*.6},{x:l/2,y:c/2},{x:-l/2,y:c/2},{x:-l/2,y:-c/2*.6}],y=Xr(m),b=d.path(y,h),v=s.insert(()=>b,":first-child");return v.attr("class","basic label-container"),u&&t.look!=="handDrawn"&&v.selectChildren("path").attr("style",u),r&&t.look!=="handDrawn"&&v.selectChildren("path").attr("style",r),In(t,v),t.intersect=function(x){return kn.polygon(t,m,x)},s}ie(Lue,"trapezoidalPentagon");async function Bue(e,t){var w;const{labelStyles:n,nodeStyles:r}=jn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await fr(e,t,rr(t)),o=Gi((w=ls().flowchart)==null?void 0:w.htmlLabels),l=i.width+(t.padding??0),c=l+i.height,u=l+i.height,d=[{x:0,y:0},{x:u,y:0},{x:u/2,y:-c}],{cssStyles:h}=t,m=Tn.svg(s),y=Rn(t,{});t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");const b=Xr(d),v=m.path(b,y),x=s.insert(()=>v,":first-child").attr("transform",`translate(${-c/2}, ${c/2})`);return h&&t.look!=="handDrawn"&&x.selectChildren("path").attr("style",h),r&&t.look!=="handDrawn"&&x.selectChildren("path").attr("style",r),t.width=l,t.height=c,In(t,x),a.attr("transform",`translate(${-i.width/2-(i.x-(i.left??0))}, ${c/2-(i.height+(t.padding??0)/(o?2:1)-(i.y-(i.top??0)))})`),t.intersect=function(S){return zt.info("Triangle intersect",t,d,S),kn.polygon(t,d,S)},s}ie(Bue,"triangle");async function $ue(e,t){const{labelStyles:n,nodeStyles:r}=jn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await fr(e,t,rr(t)),o=Math.max(i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),l=Math.max(i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),c=l/8,u=l+c,{cssStyles:d}=t,m=70-o,y=m>0?m/2:0,b=Tn.svg(s),v=Rn(t,{});t.look!=="handDrawn"&&(v.roughness=0,v.fillStyle="solid");const x=[{x:-o/2-y,y:u/2},...Lh(-o/2-y,u/2,o/2+y,u/2,c,.8),{x:o/2+y,y:-u/2},{x:-o/2-y,y:-u/2}],w=Xr(x),S=b.path(w,v),k=s.insert(()=>S,":first-child");return k.attr("class","basic label-container"),d&&t.look!=="handDrawn"&&k.selectAll("path").attr("style",d),r&&t.look!=="handDrawn"&&k.selectAll("path").attr("style",r),k.attr("transform",`translate(0,${-c/2})`),a.attr("transform",`translate(${-o/2+(t.padding??0)-(i.x-(i.left??0))},${-l/2+(t.padding??0)-c-(i.y-(i.top??0))})`),In(t,k),t.intersect=function(C){return kn.polygon(t,x,C)},s}ie($ue,"waveEdgedRectangle");async function zue(e,t){const{labelStyles:n,nodeStyles:r}=jn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await fr(e,t,rr(t)),a=100,o=50,l=Math.max(i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),c=Math.max(i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),u=l/c;let d=l,h=c;d>h*u?h=d/u:d=h*u,d=Math.max(d,a),h=Math.max(h,o);const m=Math.min(h*.2,h/4),y=h+m*2,{cssStyles:b}=t,v=Tn.svg(s),x=Rn(t,{});t.look!=="handDrawn"&&(x.roughness=0,x.fillStyle="solid");const w=[{x:-d/2,y:y/2},...Lh(-d/2,y/2,d/2,y/2,m,1),{x:d/2,y:-y/2},...Lh(d/2,-y/2,-d/2,-y/2,m,-1)],S=Xr(w),k=v.path(S,x),C=s.insert(()=>k,":first-child");return C.attr("class","basic label-container"),b&&t.look!=="handDrawn"&&C.selectAll("path").attr("style",b),r&&t.look!=="handDrawn"&&C.selectAll("path").attr("style",r),In(t,C),t.intersect=function(T){return kn.polygon(t,w,T)},s}ie(zue,"waveRectangle");async function Uue(e,t){const{labelStyles:n,nodeStyles:r}=jn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await fr(e,t,rr(t)),o=Math.max(i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),l=Math.max(i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),c=5,u=-o/2,d=-l/2,{cssStyles:h}=t,m=Tn.svg(s),y=Rn(t,{}),b=[{x:u-c,y:d-c},{x:u-c,y:d+l},{x:u+o,y:d+l},{x:u+o,y:d-c}],v=`M${u-c},${d-c} L${u+o},${d-c} L${u+o},${d+l} L${u-c},${d+l} L${u-c},${d-c}
                M${u-c},${d} L${u+o},${d}
                M${u},${d-c} L${u},${d+l}`;t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");const x=m.path(v,y),w=s.insert(()=>x,":first-child");return w.attr("transform",`translate(${c/2}, ${c/2})`),w.attr("class","basic label-container"),h&&t.look!=="handDrawn"&&w.selectAll("path").attr("style",h),r&&t.look!=="handDrawn"&&w.selectAll("path").attr("style",r),a.attr("transform",`translate(${-(i.width/2)+c/2-(i.x-(i.left??0))}, ${-(i.height/2)+c/2-(i.y-(i.top??0))})`),In(t,w),t.intersect=function(S){return kn.polygon(t,b,S)},s}ie(Uue,"windowPane");async function c5(e,t){var te,V,Q;const n=t;if(n.alias&&(t.label=n.alias),t.look==="handDrawn"){const{themeVariables:ee}=Po(),{background:se}=ee,pe={...t,id:t.id+"-background",look:"default",cssStyles:["stroke: none",`fill: ${se}`]};await c5(e,pe)}const r=Po();t.useHtmlLabels=r.htmlLabels;let s=((te=r.er)==null?void 0:te.diagramPadding)??10,i=((V=r.er)==null?void 0:V.entityPadding)??6;const{cssStyles:a}=t,{labelStyles:o}=jn(t);if(n.attributes.length===0&&t.label){const ee={rx:0,ry:0,labelPaddingX:s,labelPaddingY:s*1.5};tf(t.label,r)+ee.labelPaddingX*2<r.er.minEntityWidth&&(t.width=r.er.minEntityWidth);const se=await b_(e,t,ee);if(!Gi(r.htmlLabels)){const pe=se.select("text"),ue=(Q=pe.node())==null?void 0:Q.getBBox();pe.attr("transform",`translate(${-ue.width/2}, 0)`)}return se}r.htmlLabels||(s*=1.25,i*=1.25);let l=rr(t);l||(l="node default");const c=e.insert("g").attr("class",l).attr("id",t.domId||t.id),u=await g0(c,t.label??"",r,0,0,["name"],o);u.height+=i;let d=0;const h=[];let m=0,y=0,b=0,v=0,x=!0,w=!0;for(const ee of n.attributes){const se=await g0(c,ee.type,r,0,d,["attribute-type"],o);m=Math.max(m,se.width+s);const pe=await g0(c,ee.name,r,0,d,["attribute-name"],o);y=Math.max(y,pe.width+s);const ue=await g0(c,ee.keys.join(),r,0,d,["attribute-keys"],o);b=Math.max(b,ue.width+s);const Oe=await g0(c,ee.comment,r,0,d,["attribute-comment"],o);v=Math.max(v,Oe.width+s),d+=Math.max(se.height,pe.height,ue.height,Oe.height)+i,h.push(d)}h.pop();let S=4;b<=s&&(x=!1,b=0,S--),v<=s&&(w=!1,v=0,S--);const k=c.node().getBBox();if(u.width+s*2-(m+y+b+v)>0){const ee=u.width+s*2-(m+y+b+v);m+=ee/S,y+=ee/S,b>0&&(b+=ee/S),v>0&&(v+=ee/S)}const C=m+y+b+v,T=Tn.svg(c),R=Rn(t,{});t.look!=="handDrawn"&&(R.roughness=0,R.fillStyle="solid");const N=Math.max(k.width+s*2,(t==null?void 0:t.width)||0,C),I=Math.max(k.height+(h[0]||d)+i,(t==null?void 0:t.height)||0),P=-N/2,B=-I/2;c.selectAll("g:not(:first-child)").each((ee,se,pe)=>{const ue=Kr(pe[se]),Oe=ue.attr("transform");let Fe=0,Se=0;if(Oe){const qe=RegExp(/translate\(([^,]+),([^)]+)\)/).exec(Oe);qe&&(Fe=parseFloat(qe[1]),Se=parseFloat(qe[2]),ue.attr("class").includes("attribute-name")?Fe+=m:ue.attr("class").includes("attribute-keys")?Fe+=m+y:ue.attr("class").includes("attribute-comment")&&(Fe+=m+y+b))}ue.attr("transform",`translate(${P+s/2+Fe}, ${Se+B+u.height+i/2})`)}),c.select(".name").attr("transform","translate("+-u.width/2+", "+(B+i/2)+")");const D=T.rectangle(P,B,N,I,R),W=c.insert(()=>D,":first-child").attr("style",a.join("")),{themeVariables:O}=Po(),{rowEven:Z,rowOdd:U,nodeBorder:H}=O;h.push(0);for(const[ee,se]of h.entries()){if(ee===0&&h.length>1)continue;const pe=ee%2===0&&se!==0,ue=T.rectangle(P,u.height+B+se,N,u.height,{...R,fill:pe?Z:U,stroke:H});c.insert(()=>ue,"g.label").attr("style",a.join("")).attr("class",`row-rect-${ee%2===0?"even":"odd"}`)}let L=T.line(P,u.height+B,N+P,u.height+B,R);c.insert(()=>L).attr("class","divider"),L=T.line(m+P,u.height+B,m+P,I+B,R),c.insert(()=>L).attr("class","divider"),x&&(L=T.line(m+y+P,u.height+B,m+y+P,I+B,R),c.insert(()=>L).attr("class","divider")),w&&(L=T.line(m+y+b+P,u.height+B,m+y+b+P,I+B,R),c.insert(()=>L).attr("class","divider"));for(const ee of h)L=T.line(P,u.height+B+ee,N+P,u.height+B+ee,R),c.insert(()=>L).attr("class","divider");return In(t,W),t.intersect=function(ee){return kn.rect(t,ee)},c}ie(c5,"erBox");async function g0(e,t,n,r=0,s=0,i=[],a=""){const o=e.insert("g").attr("class",`label ${i.join(" ")}`).attr("transform",`translate(${r}, ${s})`).attr("style",a);t!==kV(t)&&(t=kV(t),t=t.replaceAll("<","&lt;").replaceAll(">","&gt;"));const l=o.node().appendChild(await hp(o,t,{width:tf(t,n)+100,style:a,useHtmlLabels:n.htmlLabels},n));if(t.includes("&lt;")||t.includes("&gt;")){let u=l.children[0];for(u.textContent=u.textContent.replaceAll("&lt;","<").replaceAll("&gt;",">");u.childNodes[0];)u=u.childNodes[0],u.textContent=u.textContent.replaceAll("&lt;","<").replaceAll("&gt;",">")}let c=l.getBBox();if(Gi(n.htmlLabels)){const u=l.children[0];u.style.textAlign="start";const d=Kr(l);c=u.getBoundingClientRect(),d.attr("width",c.width),d.attr("height",c.height)}return c}ie(g0,"addText");async function que(e,t,n,r,s=n.class.padding??12){const i=r?0:3,a=e.insert("g").attr("class",rr(t)).attr("id",t.domId||t.id);let o=null,l=null,c=null,u=null,d=0,h=0,m=0;if(o=a.insert("g").attr("class","annotation-group text"),t.annotations.length>0){const w=t.annotations[0];await Sx(o,{text:`${w}`},0),d=o.node().getBBox().height}l=a.insert("g").attr("class","label-group text"),await Sx(l,t,0,["font-weight: bolder"]);const y=l.node().getBBox();h=y.height,c=a.insert("g").attr("class","members-group text");let b=0;for(const w of t.members){const S=await Sx(c,w,b,[w.parseClassifier()]);b+=S+i}m=c.node().getBBox().height,m<=0&&(m=s/2),u=a.insert("g").attr("class","methods-group text");let v=0;for(const w of t.methods){const S=await Sx(u,w,v,[w.parseClassifier()]);v+=S+i}let x=a.node().getBBox();if(o!==null){const w=o.node().getBBox();o.attr("transform",`translate(${-w.width/2})`)}return l.attr("transform",`translate(${-y.width/2}, ${d})`),x=a.node().getBBox(),c.attr("transform",`translate(0, ${d+h+s*2})`),x=a.node().getBBox(),u.attr("transform",`translate(0, ${d+h+(m?m+s*4:s*2)})`),x=a.node().getBBox(),{shapeSvg:a,bbox:x}}ie(que,"textHelper");async function Sx(e,t,n,r=[]){const s=e.insert("g").attr("class","label").attr("style",r.join("; ")),i=Po();let a="useHtmlLabels"in t?t.useHtmlLabels:Gi(i.htmlLabels)??!0,o="";"text"in t?o=t.text:o=t.label,!a&&o.startsWith("\\")&&(o=o.substring(1)),Iy(o)&&(a=!0);const l=await hp(s,vF(ag(o)),{width:tf(o,i)+50,classes:"markdown-node-label",useHtmlLabels:a},i);let c,u=1;if(a){const d=l.children[0],h=Kr(l);u=d.innerHTML.split("<br>").length,d.innerHTML.includes("</math>")&&(u+=d.innerHTML.split("<mrow>").length-1);const m=d.getElementsByTagName("img");if(m){const y=o.replace(/<img[^>]*>/g,"").trim()==="";await Promise.all([...m].map(b=>new Promise(v=>{function x(){var w;if(b.style.display="flex",b.style.flexDirection="column",y){const S=((w=i.fontSize)==null?void 0:w.toString())??window.getComputedStyle(document.body).fontSize,C=parseInt(S,10)*5+"px";b.style.minWidth=C,b.style.maxWidth=C}else b.style.width="100%";v(b)}ie(x,"setupImage"),setTimeout(()=>{b.complete&&x()}),b.addEventListener("error",x),b.addEventListener("load",x)})))}c=d.getBoundingClientRect(),h.attr("width",c.width),h.attr("height",c.height)}else{r.includes("font-weight: bolder")&&Kr(l).selectAll("tspan").attr("font-weight",""),u=l.children.length;const d=l.children[0];(l.textContent===""||l.textContent.includes("&gt"))&&(d.textContent=o[0]+o.substring(1).replaceAll("&gt;",">").replaceAll("&lt;","<").trim(),o[1]===" "&&(d.textContent=d.textContent[0]+" "+d.textContent.substring(1))),d.textContent==="undefined"&&(d.textContent=""),c=l.getBBox()}return s.attr("transform","translate(0,"+(-c.height/(2*u)+n)+")"),c.height}ie(Sx,"addText");async function Vue(e,t){var I,P;const n=ls(),r=n.class.padding??12,s=r,i=t.useHtmlLabels??Gi(n.htmlLabels)??!0,a=t;a.annotations=a.annotations??[],a.members=a.members??[],a.methods=a.methods??[];const{shapeSvg:o,bbox:l}=await que(e,t,n,i,s),{labelStyles:c,nodeStyles:u}=jn(t);t.labelStyle=c,t.cssStyles=a.styles||"";const d=((I=a.styles)==null?void 0:I.join(";"))||u||"";t.cssStyles||(t.cssStyles=d.replaceAll("!important","").split(";"));const h=a.members.length===0&&a.methods.length===0&&!((P=n.class)!=null&&P.hideEmptyMembersBox),m=Tn.svg(o),y=Rn(t,{});t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");const b=l.width;let v=l.height;a.members.length===0&&a.methods.length===0?v+=s:a.members.length>0&&a.methods.length===0&&(v+=s*2);const x=-b/2,w=-v/2,S=m.rectangle(x-r,w-r-(h?r:a.members.length===0&&a.methods.length===0?-r/2:0),b+2*r,v+2*r+(h?r*2:a.members.length===0&&a.methods.length===0?-r:0),y),k=o.insert(()=>S,":first-child");k.attr("class","basic label-container");const C=k.node().getBBox();o.selectAll(".text").each((B,D,W)=>{var te;const O=Kr(W[D]),Z=O.attr("transform");let U=0;if(Z){const Q=RegExp(/translate\(([^,]+),([^)]+)\)/).exec(Z);Q&&(U=parseFloat(Q[2]))}let H=U+w+r-(h?r:a.members.length===0&&a.methods.length===0?-r/2:0);i||(H-=4);let L=x;(O.attr("class").includes("label-group")||O.attr("class").includes("annotation-group"))&&(L=-((te=O.node())==null?void 0:te.getBBox().width)/2||0,o.selectAll("text").each(function(V,Q,ee){window.getComputedStyle(ee[Q]).textAnchor==="middle"&&(L=0)})),O.attr("transform",`translate(${L}, ${H})`)});const T=o.select(".annotation-group").node().getBBox().height-(h?r/2:0)||0,R=o.select(".label-group").node().getBBox().height-(h?r/2:0)||0,N=o.select(".members-group").node().getBBox().height-(h?r/2:0)||0;if(a.members.length>0||a.methods.length>0||h){const B=m.line(C.x,T+R+w+r,C.x+C.width,T+R+w+r,y);o.insert(()=>B).attr("class","divider").attr("style",d)}if(h||a.members.length>0||a.methods.length>0){const B=m.line(C.x,T+R+N+w+s*2+r,C.x+C.width,T+R+N+w+r+s*2,y);o.insert(()=>B).attr("class","divider").attr("style",d)}if(a.look!=="handDrawn"&&o.selectAll("path").attr("style",d),k.select(":nth-child(2)").attr("style",d),o.selectAll(".divider").select("path").attr("style",d),t.labelStyle?o.selectAll("span").attr("style",t.labelStyle):o.selectAll("span").attr("style",d),!i){const B=RegExp(/color\s*:\s*([^;]*)/),D=B.exec(d);if(D){const W=D[0].replace("color","fill");o.selectAll("tspan").attr("style",W)}else if(c){const W=B.exec(c);if(W){const O=W[0].replace("color","fill");o.selectAll("tspan").attr("style",O)}}}return In(t,k),t.intersect=function(B){return kn.rect(t,B)},o}ie(Vue,"classBox");async function Wue(e,t){var T,R;const{labelStyles:n,nodeStyles:r}=jn(t);t.labelStyle=n;const s=t,i=t,a=20,o=20,l="verifyMethod"in t,c=rr(t),u=e.insert("g").attr("class",c).attr("id",t.domId??t.id);let d;l?d=await cu(u,`&lt;&lt;${s.type}&gt;&gt;`,0,t.labelStyle):d=await cu(u,"&lt;&lt;Element&gt;&gt;",0,t.labelStyle);let h=d;const m=await cu(u,s.name,h,t.labelStyle+"; font-weight: bold;");if(h+=m+o,l){const N=await cu(u,`${s.requirementId?`Id: ${s.requirementId}`:""}`,h,t.labelStyle);h+=N;const I=await cu(u,`${s.text?`Text: ${s.text}`:""}`,h,t.labelStyle);h+=I;const P=await cu(u,`${s.risk?`Risk: ${s.risk}`:""}`,h,t.labelStyle);h+=P,await cu(u,`${s.verifyMethod?`Verification: ${s.verifyMethod}`:""}`,h,t.labelStyle)}else{const N=await cu(u,`${i.type?`Type: ${i.type}`:""}`,h,t.labelStyle);h+=N,await cu(u,`${i.docRef?`Doc Ref: ${i.docRef}`:""}`,h,t.labelStyle)}const y=(((T=u.node())==null?void 0:T.getBBox().width)??200)+a,b=(((R=u.node())==null?void 0:R.getBBox().height)??200)+a,v=-y/2,x=-b/2,w=Tn.svg(u),S=Rn(t,{});t.look!=="handDrawn"&&(S.roughness=0,S.fillStyle="solid");const k=w.rectangle(v,x,y,b,S),C=u.insert(()=>k,":first-child");if(C.attr("class","basic label-container").attr("style",r),u.selectAll(".label").each((N,I,P)=>{const B=Kr(P[I]),D=B.attr("transform");let W=0,O=0;if(D){const L=RegExp(/translate\(([^,]+),([^)]+)\)/).exec(D);L&&(W=parseFloat(L[1]),O=parseFloat(L[2]))}const Z=O-b/2;let U=v+a/2;(I===0||I===1)&&(U=W),B.attr("transform",`translate(${U}, ${Z+a})`)}),h>d+m+o){const N=w.line(v,x+d+m+o,v+y,x+d+m+o,S);u.insert(()=>N).attr("style",r)}return In(t,C),t.intersect=function(N){return kn.rect(t,N)},u}ie(Wue,"requirementBox");async function cu(e,t,n,r=""){if(t==="")return 0;const s=e.insert("g").attr("class","label").attr("style",r),i=ls(),a=i.htmlLabels??!0,o=await hp(s,vF(ag(t)),{width:tf(t,i)+50,classes:"markdown-node-label",useHtmlLabels:a,style:r},i);let l;if(a){const c=o.children[0],u=Kr(o);l=c.getBoundingClientRect(),u.attr("width",l.width),u.attr("height",l.height)}else{const c=o.children[0];for(const u of c.children)u.textContent=u.textContent.replaceAll("&gt;",">").replaceAll("&lt;","<"),r&&u.setAttribute("style",r);l=o.getBBox(),l.height+=6}return s.attr("transform",`translate(${-l.width/2},${-l.height/2+n})`),l.height}ie(cu,"addText");var eot=ie(e=>{switch(e){case"Very High":return"red";case"High":return"orange";case"Medium":return null;case"Low":return"blue";case"Very Low":return"lightblue"}},"colorFromPriority");async function Hue(e,t,{config:n}){var D,W;const{labelStyles:r,nodeStyles:s}=jn(t);t.labelStyle=r||"";const i=10,a=t.width;t.width=(t.width??200)-10;const{shapeSvg:o,bbox:l,label:c}=await fr(e,t,rr(t)),u=t.padding||10;let d="",h;"ticket"in t&&t.ticket&&((D=n==null?void 0:n.kanban)!=null&&D.ticketBaseUrl)&&(d=(W=n==null?void 0:n.kanban)==null?void 0:W.ticketBaseUrl.replace("#TICKET#",t.ticket),h=o.insert("svg:a",":first-child").attr("class","kanban-ticket-link").attr("xlink:href",d).attr("target","_blank"));const m={useHtmlLabels:t.useHtmlLabels,labelStyle:t.labelStyle||"",width:t.width,img:t.img,padding:t.padding||8,centerLabel:!1};let y,b;h?{label:y,bbox:b}=await z3(h,"ticket"in t&&t.ticket||"",m):{label:y,bbox:b}=await z3(o,"ticket"in t&&t.ticket||"",m);const{label:v,bbox:x}=await z3(o,"assigned"in t&&t.assigned||"",m);t.width=a;const w=10,S=(t==null?void 0:t.width)||0,k=Math.max(b.height,x.height)/2,C=Math.max(l.height+w*2,(t==null?void 0:t.height)||0)+k,T=-S/2,R=-C/2;c.attr("transform","translate("+(u-S/2)+", "+(-k-l.height/2)+")"),y.attr("transform","translate("+(u-S/2)+", "+(-k+l.height/2)+")"),v.attr("transform","translate("+(u+S/2-x.width-2*i)+", "+(-k+l.height/2)+")");let N;const{rx:I,ry:P}=t,{cssStyles:B}=t;if(t.look==="handDrawn"){const O=Tn.svg(o),Z=Rn(t,{}),U=I||P?O.path(ff(T,R,S,C,I||0),Z):O.rectangle(T,R,S,C,Z);N=o.insert(()=>U,":first-child"),N.attr("class","basic label-container").attr("style",B||null)}else{N=o.insert("rect",":first-child"),N.attr("class","basic label-container __APA__").attr("style",s).attr("rx",I??5).attr("ry",P??5).attr("x",T).attr("y",R).attr("width",S).attr("height",C);const O="priority"in t&&t.priority;if(O){const Z=o.append("line"),U=T+2,H=R+Math.floor((I??0)/2),L=R+C-Math.floor((I??0)/2);Z.attr("x1",U).attr("y1",H).attr("x2",U).attr("y2",L).attr("stroke-width","4").attr("stroke",eot(O))}}return In(t,N),t.height=C,t.intersect=function(O){return kn.rect(t,O)},o}ie(Hue,"kanbanItem");var tot=[{semanticName:"Process",name:"Rectangle",shortName:"rect",description:"Standard process shape",aliases:["proc","process","rectangle"],internalAliases:["squareRect"],handler:Tue},{semanticName:"Event",name:"Rounded Rectangle",shortName:"rounded",description:"Represents an event",aliases:["event"],internalAliases:["roundedRect"],handler:Cue},{semanticName:"Terminal Point",name:"Stadium",shortName:"stadium",description:"Terminal point",aliases:["terminal","pill"],handler:Aue},{semanticName:"Subprocess",name:"Framed Rectangle",shortName:"fr-rect",description:"Subprocess",aliases:["subprocess","subproc","framed-rectangle","subroutine"],handler:Iue},{semanticName:"Database",name:"Cylinder",shortName:"cyl",description:"Database storage",aliases:["db","database","cylinder"],handler:Xce},{semanticName:"Start",name:"Circle",shortName:"circle",description:"Starting point",aliases:["circ"],handler:Vce},{semanticName:"Decision",name:"Diamond",shortName:"diam",description:"Decision-making step",aliases:["decision","diamond","question"],handler:wue},{semanticName:"Prepare Conditional",name:"Hexagon",shortName:"hex",description:"Preparation or condition step",aliases:["hexagon","prepare"],handler:sue},{semanticName:"Data Input/Output",name:"Lean Right",shortName:"lean-r",description:"Represents input or output",aliases:["lean-right","in-out"],internalAliases:["lean_right"],handler:pue},{semanticName:"Data Input/Output",name:"Lean Left",shortName:"lean-l",description:"Represents output or input",aliases:["lean-left","out-in"],internalAliases:["lean_left"],handler:hue},{semanticName:"Priority Action",name:"Trapezoid Base Bottom",shortName:"trap-b",description:"Priority action",aliases:["priority","trapezoid-bottom","trapezoid"],handler:Fue},{semanticName:"Manual Operation",name:"Trapezoid Base Top",shortName:"trap-t",description:"Represents a manual task",aliases:["manual","trapezoid-top","inv-trapezoid"],internalAliases:["inv_trapezoid"],handler:due},{semanticName:"Stop",name:"Double Circle",shortName:"dbl-circ",description:"Represents a stop point",aliases:["double-circle"],internalAliases:["doublecircle"],handler:Qce},{semanticName:"Text Block",name:"Text Block",shortName:"text",description:"Text block",handler:Pue},{semanticName:"Card",name:"Notched Rectangle",shortName:"notch-rect",description:"Represents a card",aliases:["card","notched-rectangle"],handler:Uce},{semanticName:"Lined/Shaded Process",name:"Lined Rectangle",shortName:"lin-rect",description:"Lined process shape",aliases:["lined-rectangle","lined-process","lin-proc","shaded-process"],handler:kue},{semanticName:"Start",name:"Small Circle",shortName:"sm-circ",description:"Small starting point",aliases:["start","small-circle"],internalAliases:["stateStart"],handler:Mue},{semanticName:"Stop",name:"Framed Circle",shortName:"fr-circ",description:"Stop point",aliases:["stop","framed-circle"],internalAliases:["stateEnd"],handler:Nue},{semanticName:"Fork/Join",name:"Filled Rectangle",shortName:"fork",description:"Fork or join in process flow",aliases:["join"],internalAliases:["forkJoin"],handler:nue},{semanticName:"Collate",name:"Hourglass",shortName:"hourglass",description:"Represents a collate operation",aliases:["hourglass","collate"],handler:iue},{semanticName:"Comment",name:"Curly Brace",shortName:"brace",description:"Adds a comment",aliases:["comment","brace-l"],handler:Gce},{semanticName:"Comment Right",name:"Curly Brace",shortName:"brace-r",description:"Adds a comment",handler:Kce},{semanticName:"Comment with braces on both sides",name:"Curly Braces",shortName:"braces",description:"Adds a comment",handler:Yce},{semanticName:"Com Link",name:"Lightning Bolt",shortName:"bolt",description:"Communication link",aliases:["com-link","lightning-bolt"],handler:mue},{semanticName:"Document",name:"Document",shortName:"doc",description:"Represents a document",aliases:["doc","document"],handler:$ue},{semanticName:"Delay",name:"Half-Rounded Rectangle",shortName:"delay",description:"Represents a delay",aliases:["half-rounded-rectangle"],handler:rue},{semanticName:"Direct Access Storage",name:"Horizontal Cylinder",shortName:"h-cyl",description:"Direct access storage",aliases:["das","horizontal-cylinder"],handler:Due},{semanticName:"Disk Storage",name:"Lined Cylinder",shortName:"lin-cyl",description:"Disk storage",aliases:["disk","lined-cylinder"],handler:gue},{semanticName:"Display",name:"Curved Trapezoid",shortName:"curv-trap",description:"Represents a display",aliases:["curved-trapezoid","display"],handler:Zce},{semanticName:"Divided Process",name:"Divided Rectangle",shortName:"div-rect",description:"Divided process shape",aliases:["div-proc","divided-rectangle","divided-process"],handler:Jce},{semanticName:"Extract",name:"Triangle",shortName:"tri",description:"Extraction process",aliases:["extract","triangle"],handler:Bue},{semanticName:"Internal Storage",name:"Window Pane",shortName:"win-pane",description:"Internal storage",aliases:["internal-storage","window-pane"],handler:Uue},{semanticName:"Junction",name:"Filled Circle",shortName:"f-circ",description:"Junction point",aliases:["junction","filled-circle"],handler:eue},{semanticName:"Loop Limit",name:"Trapezoidal Pentagon",shortName:"notch-pent",description:"Loop limit step",aliases:["loop-limit","notched-pentagon"],handler:Lue},{semanticName:"Manual File",name:"Flipped Triangle",shortName:"flip-tri",description:"Manual file operation",aliases:["manual-file","flipped-triangle"],handler:tue},{semanticName:"Manual Input",name:"Sloped Rectangle",shortName:"sl-rect",description:"Manual input step",aliases:["manual-input","sloped-rectangle"],handler:Eue},{semanticName:"Multi-Document",name:"Stacked Document",shortName:"docs",description:"Multiple documents",aliases:["documents","st-doc","stacked-document"],handler:vue},{semanticName:"Multi-Process",name:"Stacked Rectangle",shortName:"st-rect",description:"Multiple processes",aliases:["procs","processes","stacked-rectangle"],handler:bue},{semanticName:"Stored Data",name:"Bow Tie Rectangle",shortName:"bow-rect",description:"Stored data",aliases:["stored-data","bow-tie-rectangle"],handler:zce},{semanticName:"Summary",name:"Crossed Circle",shortName:"cross-circ",description:"Summary",aliases:["summary","crossed-circle"],handler:Hce},{semanticName:"Tagged Document",name:"Tagged Document",shortName:"tag-doc",description:"Tagged document",aliases:["tag-doc","tagged-document"],handler:Oue},{semanticName:"Tagged Process",name:"Tagged Rectangle",shortName:"tag-rect",description:"Tagged process",aliases:["tagged-rectangle","tag-proc","tagged-process"],handler:jue},{semanticName:"Paper Tape",name:"Flag",shortName:"flag",description:"Paper tape",aliases:["paper-tape"],handler:zue},{semanticName:"Odd",name:"Odd",shortName:"odd",description:"Odd shape",internalAliases:["rect_left_inv_arrow"],handler:_ue},{semanticName:"Lined Document",name:"Lined Document",shortName:"lin-doc",description:"Lined document",aliases:["lined-document"],handler:yue}],not=ie(()=>{const t=[...Object.entries({state:Rue,choice:qce,note:xue,rectWithTitle:Sue,labelRect:fue,iconSquare:cue,iconCircle:oue,icon:aue,iconRounded:lue,imageSquare:uue,anchor:$ce,kanbanItem:Hue,classBox:Vue,erBox:c5,requirementBox:Wue}),...tot.flatMap(n=>[n.shortName,..."aliases"in n?n.aliases:[],..."internalAliases"in n?n.internalAliases:[]].map(s=>[s,n.handler]))];return Object.fromEntries(t)},"generateShapeMap"),Gue=not();function rot(e){return e in Gue}ie(rot,"isValidShape");var wA=new Map;async function Kue(e,t,n){let r,s;t.shape==="rect"&&(t.rx&&t.ry?t.shape="roundedRect":t.shape="squareRect");const i=t.shape?Gue[t.shape]:void 0;if(!i)throw new Error(`No such shape: ${t.shape}. Please check your syntax.`);if(t.link){let a;n.config.securityLevel==="sandbox"?a="_top":t.linkTarget&&(a=t.linkTarget||"_blank"),r=e.insert("svg:a").attr("xlink:href",t.link).attr("target",a??null),s=await i(r,t,n)}else s=await i(e,t,n),r=s;return t.tooltip&&s.attr("title",t.tooltip),wA.set(t.id,r),t.haveCallback&&r.attr("class",r.attr("class")+" clickable"),r}ie(Kue,"insertNode");var Ydt=ie((e,t)=>{wA.set(t.id,e)},"setNodeElem"),Zdt=ie(()=>{wA.clear()},"clear"),Xdt=ie(e=>{const t=wA.get(e.id);zt.trace("Transforming node",e.diff,e,"translate("+(e.x-e.width/2-5)+", "+e.width/2+")");const n=8,r=e.diff||0;return e.clusterNode?t.attr("transform","translate("+(e.x+r-e.width/2)+", "+(e.y-e.height/2-n)+")"):t.attr("transform","translate("+e.x+", "+e.y+")"),r},"positionNode"),sot=ie((e,t,n,r,s,i)=>{t.arrowTypeStart&&MW(e,"start",t.arrowTypeStart,n,r,s,i),t.arrowTypeEnd&&MW(e,"end",t.arrowTypeEnd,n,r,s,i)},"addEdgeMarkers"),iot={arrow_cross:{type:"cross",fill:!1},arrow_point:{type:"point",fill:!0},arrow_barb:{type:"barb",fill:!0},arrow_circle:{type:"circle",fill:!1},aggregation:{type:"aggregation",fill:!1},extension:{type:"extension",fill:!1},composition:{type:"composition",fill:!0},dependency:{type:"dependency",fill:!0},lollipop:{type:"lollipop",fill:!1},only_one:{type:"onlyOne",fill:!1},zero_or_one:{type:"zeroOrOne",fill:!1},one_or_more:{type:"oneOrMore",fill:!1},zero_or_more:{type:"zeroOrMore",fill:!1},requirement_arrow:{type:"requirement_arrow",fill:!1},requirement_contains:{type:"requirement_contains",fill:!1}},MW=ie((e,t,n,r,s,i,a)=>{var d;const o=iot[n];if(!o){zt.warn(`Unknown arrow type: ${n}`);return}const l=o.type,u=`${s}_${i}-${l}${t==="start"?"Start":"End"}`;if(a&&a.trim()!==""){const h=a.replace(/[^\dA-Za-z]/g,"_"),m=`${u}_${h}`;if(!document.getElementById(m)){const y=document.getElementById(u);if(y){const b=y.cloneNode(!0);b.id=m,b.querySelectorAll("path, circle, line").forEach(x=>{x.setAttribute("stroke",a),o.fill&&x.setAttribute("fill",a)}),(d=y.parentNode)==null||d.appendChild(b)}}e.attr(`marker-${t}`,`url(${r}#${m})`)}else e.attr(`marker-${t}`,`url(${r}#${u})`)},"addEdgeMarker"),uE=new Map,xa=new Map,Jdt=ie(()=>{uE.clear(),xa.clear()},"clear"),rx=ie(e=>e?e.reduce((n,r)=>n+";"+r,""):"","getLabelStyles"),aot=ie(async(e,t)=>{let n=Gi(ls().flowchart.htmlLabels);const r=await hp(e,t.label,{style:rx(t.labelStyle),useHtmlLabels:n,addSvgBackground:!0,isNode:!1});zt.info("abc82",t,t.labelType);const s=e.insert("g").attr("class","edgeLabel"),i=s.insert("g").attr("class","label");i.node().appendChild(r);let a=r.getBBox();if(n){const l=r.children[0],c=Kr(r);a=l.getBoundingClientRect(),c.attr("width",a.width),c.attr("height",a.height)}i.attr("transform","translate("+-a.width/2+", "+-a.height/2+")"),uE.set(t.id,s),t.width=a.width,t.height=a.height;let o;if(t.startLabelLeft){const l=await dm(t.startLabelLeft,rx(t.labelStyle)),c=e.insert("g").attr("class","edgeTerminals"),u=c.insert("g").attr("class","inner");o=u.node().appendChild(l);const d=l.getBBox();u.attr("transform","translate("+-d.width/2+", "+-d.height/2+")"),xa.get(t.id)||xa.set(t.id,{}),xa.get(t.id).startLeft=c,Cx(o,t.startLabelLeft)}if(t.startLabelRight){const l=await dm(t.startLabelRight,rx(t.labelStyle)),c=e.insert("g").attr("class","edgeTerminals"),u=c.insert("g").attr("class","inner");o=c.node().appendChild(l),u.node().appendChild(l);const d=l.getBBox();u.attr("transform","translate("+-d.width/2+", "+-d.height/2+")"),xa.get(t.id)||xa.set(t.id,{}),xa.get(t.id).startRight=c,Cx(o,t.startLabelRight)}if(t.endLabelLeft){const l=await dm(t.endLabelLeft,rx(t.labelStyle)),c=e.insert("g").attr("class","edgeTerminals"),u=c.insert("g").attr("class","inner");o=u.node().appendChild(l);const d=l.getBBox();u.attr("transform","translate("+-d.width/2+", "+-d.height/2+")"),c.node().appendChild(l),xa.get(t.id)||xa.set(t.id,{}),xa.get(t.id).endLeft=c,Cx(o,t.endLabelLeft)}if(t.endLabelRight){const l=await dm(t.endLabelRight,rx(t.labelStyle)),c=e.insert("g").attr("class","edgeTerminals"),u=c.insert("g").attr("class","inner");o=u.node().appendChild(l);const d=l.getBBox();u.attr("transform","translate("+-d.width/2+", "+-d.height/2+")"),c.node().appendChild(l),xa.get(t.id)||xa.set(t.id,{}),xa.get(t.id).endRight=c,Cx(o,t.endLabelRight)}return r},"insertEdgeLabel");function Cx(e,t){ls().flowchart.htmlLabels&&e&&(e.style.width=t.length*9+"px",e.style.height="12px")}ie(Cx,"setTerminalWidth");var oot=ie((e,t)=>{zt.debug("Moving label abc88 ",e.id,e.label,uE.get(e.id),t);let n=t.updatedPath?t.updatedPath:t.originalPath;const r=ls(),{subGraphTitleTotalMargin:s}=TF(r);if(e.label){const i=uE.get(e.id);let a=e.x,o=e.y;if(n){const l=vu.calcLabelPosition(n);zt.debug("Moving label "+e.label+" from (",a,",",o,") to (",l.x,",",l.y,") abc88"),t.updatedPath&&(a=l.x,o=l.y)}i.attr("transform",`translate(${a}, ${o+s/2})`)}if(e.startLabelLeft){const i=xa.get(e.id).startLeft;let a=e.x,o=e.y;if(n){const l=vu.calcTerminalLabelPosition(e.arrowTypeStart?10:0,"start_left",n);a=l.x,o=l.y}i.attr("transform",`translate(${a}, ${o})`)}if(e.startLabelRight){const i=xa.get(e.id).startRight;let a=e.x,o=e.y;if(n){const l=vu.calcTerminalLabelPosition(e.arrowTypeStart?10:0,"start_right",n);a=l.x,o=l.y}i.attr("transform",`translate(${a}, ${o})`)}if(e.endLabelLeft){const i=xa.get(e.id).endLeft;let a=e.x,o=e.y;if(n){const l=vu.calcTerminalLabelPosition(e.arrowTypeEnd?10:0,"end_left",n);a=l.x,o=l.y}i.attr("transform",`translate(${a}, ${o})`)}if(e.endLabelRight){const i=xa.get(e.id).endRight;let a=e.x,o=e.y;if(n){const l=vu.calcTerminalLabelPosition(e.arrowTypeEnd?10:0,"end_right",n);a=l.x,o=l.y}i.attr("transform",`translate(${a}, ${o})`)}},"positionEdgeLabel"),lot=ie((e,t)=>{const n=e.x,r=e.y,s=Math.abs(t.x-n),i=Math.abs(t.y-r),a=e.width/2,o=e.height/2;return s>=a||i>=o},"outsideNode"),cot=ie((e,t,n)=>{zt.debug(`intersection calc abc89:
  outsidePoint: ${JSON.stringify(t)}
  insidePoint : ${JSON.stringify(n)}
  node        : x:${e.x} y:${e.y} w:${e.width} h:${e.height}`);const r=e.x,s=e.y,i=Math.abs(r-n.x),a=e.width/2;let o=n.x<t.x?a-i:a+i;const l=e.height/2,c=Math.abs(t.y-n.y),u=Math.abs(t.x-n.x);if(Math.abs(s-t.y)*a>Math.abs(r-t.x)*l){let d=n.y<t.y?t.y-l-s:s-l-t.y;o=u*d/c;const h={x:n.x<t.x?n.x+o:n.x-u+o,y:n.y<t.y?n.y+c-d:n.y-c+d};return o===0&&(h.x=t.x,h.y=t.y),u===0&&(h.x=t.x),c===0&&(h.y=t.y),zt.debug(`abc89 top/bottom calc, Q ${c}, q ${d}, R ${u}, r ${o}`,h),h}else{n.x<t.x?o=t.x-a-r:o=r-a-t.x;let d=c*o/u,h=n.x<t.x?n.x+u-o:n.x-u+o,m=n.y<t.y?n.y+d:n.y-d;return zt.debug(`sides calc abc89, Q ${c}, q ${d}, R ${u}, r ${o}`,{_x:h,_y:m}),o===0&&(h=t.x,m=t.y),u===0&&(h=t.x),c===0&&(m=t.y),{x:h,y:m}}},"intersection"),IW=ie((e,t)=>{zt.warn("abc88 cutPathAtIntersect",e,t);let n=[],r=e[0],s=!1;return e.forEach(i=>{if(zt.info("abc88 checking point",i,t),!lot(t,i)&&!s){const a=cot(t,r,i);zt.debug("abc88 inside",i,r,a),zt.debug("abc88 intersection",a,t);let o=!1;n.forEach(l=>{o=o||l.x===a.x&&l.y===a.y}),n.some(l=>l.x===a.x&&l.y===a.y)?zt.warn("abc88 no intersect",a,n):n.push(a),s=!0}else zt.warn("abc88 outside",i,r),r=i,s||n.push(i)}),zt.debug("returning points",n),n},"cutPathAtIntersect");function Yue(e){const t=[],n=[];for(let r=1;r<e.length-1;r++){const s=e[r-1],i=e[r],a=e[r+1];(s.x===i.x&&i.y===a.y&&Math.abs(i.x-a.x)>5&&Math.abs(i.y-s.y)>5||s.y===i.y&&i.x===a.x&&Math.abs(i.x-s.x)>5&&Math.abs(i.y-a.y)>5)&&(t.push(i),n.push(r))}return{cornerPoints:t,cornerPointPositions:n}}ie(Yue,"extractCornerPoints");var jW=ie(function(e,t,n){const r=t.x-e.x,s=t.y-e.y,i=Math.sqrt(r*r+s*s),a=n/i;return{x:t.x-a*r,y:t.y-a*s}},"findAdjacentPoint"),uot=ie(function(e){const{cornerPointPositions:t}=Yue(e),n=[];for(let r=0;r<e.length;r++)if(t.includes(r)){const s=e[r-1],i=e[r+1],a=e[r],o=jW(s,a,5),l=jW(i,a,5),c=l.x-o.x,u=l.y-o.y;n.push(o);const d=Math.sqrt(2)*2;let h={x:a.x,y:a.y};if(Math.abs(i.x-s.x)>10&&Math.abs(i.y-s.y)>=10){zt.debug("Corner point fixing",Math.abs(i.x-s.x),Math.abs(i.y-s.y));const m=5;a.x===o.x?h={x:c<0?o.x-m+d:o.x+m-d,y:u<0?o.y-d:o.y+d}:h={x:c<0?o.x-d:o.x+d,y:u<0?o.y-m+d:o.y+m-d}}else zt.debug("Corner point skipping fixing",Math.abs(i.x-s.x),Math.abs(i.y-s.y));n.push(h,l)}else n.push(e[r]);return n},"fixCorners"),dot=ie(function(e,t,n,r,s,i,a){var I;const{handDrawnSeed:o}=ls();let l=t.points,c=!1;const u=s;var d=i;const h=[];for(const P in t.cssCompiledStyles)Mce(P)||h.push(t.cssCompiledStyles[P]);d.intersect&&u.intersect&&(l=l.slice(1,t.points.length-1),l.unshift(u.intersect(l[0])),zt.debug("Last point APA12",t.start,"-->",t.end,l[l.length-1],d,d.intersect(l[l.length-1])),l.push(d.intersect(l[l.length-1]))),t.toCluster&&(zt.info("to cluster abc88",n.get(t.toCluster)),l=IW(t.points,n.get(t.toCluster).node),c=!0),t.fromCluster&&(zt.debug("from cluster abc88",n.get(t.fromCluster),JSON.stringify(l,null,2)),l=IW(l.reverse(),n.get(t.fromCluster).node).reverse(),c=!0);let m=l.filter(P=>!Number.isNaN(P.y));m=uot(m);let y=J2;switch(y=Kk,t.curve){case"linear":y=Kk;break;case"basis":y=J2;break;case"cardinal":y=ble;break;case"bumpX":y=hle;break;case"bumpY":y=ple;break;case"catmullRom":y=xle;break;case"monotoneX":y=Ele;break;case"monotoneY":y=Tle;break;case"natural":y=Rle;break;case"step":y=Nle;break;case"stepAfter":y=Ile;break;case"stepBefore":y=Mle;break;default:y=J2}const{x:b,y:v}=IJe(t),x=Ant().x(b).y(v).curve(y);let w;switch(t.thickness){case"normal":w="edge-thickness-normal";break;case"thick":w="edge-thickness-thick";break;case"invisible":w="edge-thickness-invisible";break;default:w="edge-thickness-normal"}switch(t.pattern){case"solid":w+=" edge-pattern-solid";break;case"dotted":w+=" edge-pattern-dotted";break;case"dashed":w+=" edge-pattern-dashed";break;default:w+=" edge-pattern-solid"}let S,k=x(m);const C=Array.isArray(t.style)?t.style:[t.style];let T=C.find(P=>P==null?void 0:P.startsWith("stroke:"));if(t.look==="handDrawn"){const P=Tn.svg(e);Object.assign([],m);const B=P.path(k,{roughness:.3,seed:o});w+=" transition",S=Kr(B).select("path").attr("id",t.id).attr("class"," "+w+(t.classes?" "+t.classes:"")).attr("style",C?C.reduce((W,O)=>W+";"+O,""):"");let D=S.attr("d");S.attr("d",D),e.node().appendChild(S.node())}else{const P=h.join(";"),B=C?C.reduce((O,Z)=>O+Z+";",""):"";let D="";t.animate&&(D=" edge-animation-fast"),t.animation&&(D=" edge-animation-"+t.animation);const W=P?P+";"+B+";":B;S=e.append("path").attr("d",k).attr("id",t.id).attr("class"," "+w+(t.classes?" "+t.classes:"")+(D??"")).attr("style",W),T=(I=W.match(/stroke:([^;]+)/))==null?void 0:I[1]}let R="";(ls().flowchart.arrowMarkerAbsolute||ls().state.arrowMarkerAbsolute)&&(R=window.location.protocol+"//"+window.location.host+window.location.pathname+window.location.search,R=R.replace(/\(/g,"\\(").replace(/\)/g,"\\)")),zt.info("arrowTypeStart",t.arrowTypeStart),zt.info("arrowTypeEnd",t.arrowTypeEnd),sot(S,t,R,a,r,T);let N={};return c&&(N.updatedPath=l),N.originalPath=t.points,N},"insertEdge"),fot=ie((e,t,n,r)=>{t.forEach(s=>{Aot[s](e,n,r)})},"insertMarkers"),hot=ie((e,t,n)=>{zt.trace("Making markers for ",n),e.append("defs").append("marker").attr("id",n+"_"+t+"-extensionStart").attr("class","marker extension "+t).attr("refX",18).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 1,7 L18,13 V 1 Z"),e.append("defs").append("marker").attr("id",n+"_"+t+"-extensionEnd").attr("class","marker extension "+t).attr("refX",1).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 1,1 V 13 L18,7 Z")},"extension"),pot=ie((e,t,n)=>{e.append("defs").append("marker").attr("id",n+"_"+t+"-compositionStart").attr("class","marker composition "+t).attr("refX",18).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z"),e.append("defs").append("marker").attr("id",n+"_"+t+"-compositionEnd").attr("class","marker composition "+t).attr("refX",1).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z")},"composition"),mot=ie((e,t,n)=>{e.append("defs").append("marker").attr("id",n+"_"+t+"-aggregationStart").attr("class","marker aggregation "+t).attr("refX",18).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z"),e.append("defs").append("marker").attr("id",n+"_"+t+"-aggregationEnd").attr("class","marker aggregation "+t).attr("refX",1).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z")},"aggregation"),got=ie((e,t,n)=>{e.append("defs").append("marker").attr("id",n+"_"+t+"-dependencyStart").attr("class","marker dependency "+t).attr("refX",6).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 5,7 L9,13 L1,7 L9,1 Z"),e.append("defs").append("marker").attr("id",n+"_"+t+"-dependencyEnd").attr("class","marker dependency "+t).attr("refX",13).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L14,7 L9,1 Z")},"dependency"),yot=ie((e,t,n)=>{e.append("defs").append("marker").attr("id",n+"_"+t+"-lollipopStart").attr("class","marker lollipop "+t).attr("refX",13).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("circle").attr("stroke","black").attr("fill","transparent").attr("cx",7).attr("cy",7).attr("r",6),e.append("defs").append("marker").attr("id",n+"_"+t+"-lollipopEnd").attr("class","marker lollipop "+t).attr("refX",1).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("circle").attr("stroke","black").attr("fill","transparent").attr("cx",7).attr("cy",7).attr("r",6)},"lollipop"),bot=ie((e,t,n)=>{e.append("marker").attr("id",n+"_"+t+"-pointEnd").attr("class","marker "+t).attr("viewBox","0 0 10 10").attr("refX",5).attr("refY",5).attr("markerUnits","userSpaceOnUse").attr("markerWidth",8).attr("markerHeight",8).attr("orient","auto").append("path").attr("d","M 0 0 L 10 5 L 0 10 z").attr("class","arrowMarkerPath").style("stroke-width",1).style("stroke-dasharray","1,0"),e.append("marker").attr("id",n+"_"+t+"-pointStart").attr("class","marker "+t).attr("viewBox","0 0 10 10").attr("refX",4.5).attr("refY",5).attr("markerUnits","userSpaceOnUse").attr("markerWidth",8).attr("markerHeight",8).attr("orient","auto").append("path").attr("d","M 0 5 L 10 10 L 10 0 z").attr("class","arrowMarkerPath").style("stroke-width",1).style("stroke-dasharray","1,0")},"point"),vot=ie((e,t,n)=>{e.append("marker").attr("id",n+"_"+t+"-circleEnd").attr("class","marker "+t).attr("viewBox","0 0 10 10").attr("refX",11).attr("refY",5).attr("markerUnits","userSpaceOnUse").attr("markerWidth",11).attr("markerHeight",11).attr("orient","auto").append("circle").attr("cx","5").attr("cy","5").attr("r","5").attr("class","arrowMarkerPath").style("stroke-width",1).style("stroke-dasharray","1,0"),e.append("marker").attr("id",n+"_"+t+"-circleStart").attr("class","marker "+t).attr("viewBox","0 0 10 10").attr("refX",-1).attr("refY",5).attr("markerUnits","userSpaceOnUse").attr("markerWidth",11).attr("markerHeight",11).attr("orient","auto").append("circle").attr("cx","5").attr("cy","5").attr("r","5").attr("class","arrowMarkerPath").style("stroke-width",1).style("stroke-dasharray","1,0")},"circle"),xot=ie((e,t,n)=>{e.append("marker").attr("id",n+"_"+t+"-crossEnd").attr("class","marker cross "+t).attr("viewBox","0 0 11 11").attr("refX",12).attr("refY",5.2).attr("markerUnits","userSpaceOnUse").attr("markerWidth",11).attr("markerHeight",11).attr("orient","auto").append("path").attr("d","M 1,1 l 9,9 M 10,1 l -9,9").attr("class","arrowMarkerPath").style("stroke-width",2).style("stroke-dasharray","1,0"),e.append("marker").attr("id",n+"_"+t+"-crossStart").attr("class","marker cross "+t).attr("viewBox","0 0 11 11").attr("refX",-1).attr("refY",5.2).attr("markerUnits","userSpaceOnUse").attr("markerWidth",11).attr("markerHeight",11).attr("orient","auto").append("path").attr("d","M 1,1 l 9,9 M 10,1 l -9,9").attr("class","arrowMarkerPath").style("stroke-width",2).style("stroke-dasharray","1,0")},"cross"),wot=ie((e,t,n)=>{e.append("defs").append("marker").attr("id",n+"_"+t+"-barbEnd").attr("refX",19).attr("refY",7).attr("markerWidth",20).attr("markerHeight",14).attr("markerUnits","userSpaceOnUse").attr("orient","auto").append("path").attr("d","M 19,7 L9,13 L14,7 L9,1 Z")},"barb"),_ot=ie((e,t,n)=>{e.append("defs").append("marker").attr("id",n+"_"+t+"-onlyOneStart").attr("class","marker onlyOne "+t).attr("refX",0).attr("refY",9).attr("markerWidth",18).attr("markerHeight",18).attr("orient","auto").append("path").attr("d","M9,0 L9,18 M15,0 L15,18"),e.append("defs").append("marker").attr("id",n+"_"+t+"-onlyOneEnd").attr("class","marker onlyOne "+t).attr("refX",18).attr("refY",9).attr("markerWidth",18).attr("markerHeight",18).attr("orient","auto").append("path").attr("d","M3,0 L3,18 M9,0 L9,18")},"only_one"),Sot=ie((e,t,n)=>{const r=e.append("defs").append("marker").attr("id",n+"_"+t+"-zeroOrOneStart").attr("class","marker zeroOrOne "+t).attr("refX",0).attr("refY",9).attr("markerWidth",30).attr("markerHeight",18).attr("orient","auto");r.append("circle").attr("fill","white").attr("cx",21).attr("cy",9).attr("r",6),r.append("path").attr("d","M9,0 L9,18");const s=e.append("defs").append("marker").attr("id",n+"_"+t+"-zeroOrOneEnd").attr("class","marker zeroOrOne "+t).attr("refX",30).attr("refY",9).attr("markerWidth",30).attr("markerHeight",18).attr("orient","auto");s.append("circle").attr("fill","white").attr("cx",9).attr("cy",9).attr("r",6),s.append("path").attr("d","M21,0 L21,18")},"zero_or_one"),Cot=ie((e,t,n)=>{e.append("defs").append("marker").attr("id",n+"_"+t+"-oneOrMoreStart").attr("class","marker oneOrMore "+t).attr("refX",18).attr("refY",18).attr("markerWidth",45).attr("markerHeight",36).attr("orient","auto").append("path").attr("d","M0,18 Q 18,0 36,18 Q 18,36 0,18 M42,9 L42,27"),e.append("defs").append("marker").attr("id",n+"_"+t+"-oneOrMoreEnd").attr("class","marker oneOrMore "+t).attr("refX",27).attr("refY",18).attr("markerWidth",45).attr("markerHeight",36).attr("orient","auto").append("path").attr("d","M3,9 L3,27 M9,18 Q27,0 45,18 Q27,36 9,18")},"one_or_more"),kot=ie((e,t,n)=>{const r=e.append("defs").append("marker").attr("id",n+"_"+t+"-zeroOrMoreStart").attr("class","marker zeroOrMore "+t).attr("refX",18).attr("refY",18).attr("markerWidth",57).attr("markerHeight",36).attr("orient","auto");r.append("circle").attr("fill","white").attr("cx",48).attr("cy",18).attr("r",6),r.append("path").attr("d","M0,18 Q18,0 36,18 Q18,36 0,18");const s=e.append("defs").append("marker").attr("id",n+"_"+t+"-zeroOrMoreEnd").attr("class","marker zeroOrMore "+t).attr("refX",39).attr("refY",18).attr("markerWidth",57).attr("markerHeight",36).attr("orient","auto");s.append("circle").attr("fill","white").attr("cx",9).attr("cy",18).attr("r",6),s.append("path").attr("d","M21,18 Q39,0 57,18 Q39,36 21,18")},"zero_or_more"),Eot=ie((e,t,n)=>{e.append("defs").append("marker").attr("id",n+"_"+t+"-requirement_arrowEnd").attr("refX",20).attr("refY",10).attr("markerWidth",20).attr("markerHeight",20).attr("orient","auto").append("path").attr("d",`M0,0
      L20,10
      M20,10
      L0,20`)},"requirement_arrow"),Tot=ie((e,t,n)=>{const r=e.append("defs").append("marker").attr("id",n+"_"+t+"-requirement_containsStart").attr("refX",0).attr("refY",10).attr("markerWidth",20).attr("markerHeight",20).attr("orient","auto").append("g");r.append("circle").attr("cx",10).attr("cy",10).attr("r",9).attr("fill","none"),r.append("line").attr("x1",1).attr("x2",19).attr("y1",10).attr("y2",10),r.append("line").attr("y1",1).attr("y2",19).attr("x1",10).attr("x2",10)},"requirement_contains"),Aot={extension:hot,composition:pot,aggregation:mot,dependency:got,lollipop:yot,point:bot,circle:vot,cross:xot,barb:wot,only_one:_ot,zero_or_one:Sot,one_or_more:Cot,zero_or_more:kot,requirement_arrow:Eot,requirement_contains:Tot},Rot=fot,Not={common:_b,getConfig:Po,insertCluster:Lat,insertEdge:dot,insertEdgeLabel:aot,insertMarkers:Rot,insertNode:Kue,interpolateToCurve:VF,labelHelper:fr,log:zt,positionEdgeLabel:oot},f1={},Zue=ie(e=>{for(const t of e)f1[t.name]=t},"registerLayoutLoaders"),Mot=ie(()=>{Zue([{name:"dagre",loader:ie(async()=>await Zr(()=>import("./dagre-OKDRZEBW-D1My2Aup.js"),__vite__mapDeps([0,1,2,3,4,5])),"loader")}])},"registerDefaultLayoutLoaders");Mot();var Qdt=ie(async(e,t)=>{if(!(e.layoutAlgorithm in f1))throw new Error(`Unknown layout algorithm: ${e.layoutAlgorithm}`);const n=f1[e.layoutAlgorithm];return(await n.loader()).render(e,t,Not,{algorithm:n.algorithm})},"render"),eft=ie((e="",{fallback:t="dagre"}={})=>{if(e in f1)return e;if(t in f1)return zt.warn(`Layout algorithm ${e} is not registered. Using ${t} as fallback.`),t;throw new Error(`Both layout algorithms ${e} and ${t} are not registered.`)},"getRegisteredLayoutAlgorithm"),OW={name:"mermaid",version:"11.6.0",description:"Markdown-ish syntax for generating flowcharts, mindmaps, sequence diagrams, class diagrams, gantt charts, git graphs and more.",type:"module",module:"./dist/mermaid.core.mjs",types:"./dist/mermaid.d.ts",exports:{".":{types:"./dist/mermaid.d.ts",import:"./dist/mermaid.core.mjs",default:"./dist/mermaid.core.mjs"},"./*":"./*"},keywords:["diagram","markdown","flowchart","sequence diagram","gantt","class diagram","git graph","mindmap","packet diagram","c4 diagram","er diagram","pie chart","pie diagram","quadrant chart","requirement diagram","graph"],scripts:{clean:"rimraf dist",dev:"pnpm -w dev","docs:code":"typedoc src/defaultConfig.ts src/config.ts src/mermaid.ts && prettier --write ./src/docs/config/setup","docs:build":"rimraf ../../docs && pnpm docs:code && pnpm docs:spellcheck && tsx scripts/docs.cli.mts","docs:verify":"pnpm docs:code && pnpm docs:spellcheck && tsx scripts/docs.cli.mts --verify","docs:pre:vitepress":"pnpm --filter ./src/docs prefetch && rimraf src/vitepress && pnpm docs:code && tsx scripts/docs.cli.mts --vitepress && pnpm --filter ./src/vitepress install --no-frozen-lockfile --ignore-scripts","docs:build:vitepress":"pnpm docs:pre:vitepress && (cd src/vitepress && pnpm run build) && cpy --flat src/docs/landing/ ./src/vitepress/.vitepress/dist/landing","docs:dev":'pnpm docs:pre:vitepress && concurrently "pnpm --filter ./src/vitepress dev" "tsx scripts/docs.cli.mts --watch --vitepress"',"docs:dev:docker":'pnpm docs:pre:vitepress && concurrently "pnpm --filter ./src/vitepress dev:docker" "tsx scripts/docs.cli.mts --watch --vitepress"',"docs:serve":"pnpm docs:build:vitepress && vitepress serve src/vitepress","docs:spellcheck":'cspell "src/docs/**/*.md"',"docs:release-version":"tsx scripts/update-release-version.mts","docs:verify-version":"tsx scripts/update-release-version.mts --verify","types:build-config":"tsx scripts/create-types-from-json-schema.mts","types:verify-config":"tsx scripts/create-types-from-json-schema.mts --verify",checkCircle:"npx madge --circular ./src",prepublishOnly:"pnpm docs:verify-version"},repository:{type:"git",url:"https://github.com/mermaid-js/mermaid"},author:"Knut Sveidqvist",license:"MIT",standard:{ignore:["**/parser/*.js","dist/**/*.js","cypress/**/*.js"],globals:["page"]},dependencies:{"@braintree/sanitize-url":"^7.0.4","@iconify/utils":"^2.1.33","@mermaid-js/parser":"workspace:^","@types/d3":"^7.4.3",cytoscape:"^3.29.3","cytoscape-cose-bilkent":"^4.1.0","cytoscape-fcose":"^2.2.0",d3:"^7.9.0","d3-sankey":"^0.12.3","dagre-d3-es":"7.0.11",dayjs:"^1.11.13",dompurify:"^3.2.4",katex:"^0.16.9",khroma:"^2.1.0","lodash-es":"^4.17.21",marked:"^15.0.7",roughjs:"^4.6.6",stylis:"^4.3.6","ts-dedent":"^2.2.0",uuid:"^11.1.0"},devDependencies:{"@adobe/jsonschema2md":"^8.0.2","@iconify/types":"^2.0.0","@types/cytoscape":"^3.21.9","@types/cytoscape-fcose":"^2.2.4","@types/d3-sankey":"^0.12.4","@types/d3-scale":"^4.0.9","@types/d3-scale-chromatic":"^3.1.0","@types/d3-selection":"^3.0.11","@types/d3-shape":"^3.1.7","@types/jsdom":"^21.1.7","@types/katex":"^0.16.7","@types/lodash-es":"^4.17.12","@types/micromatch":"^4.0.9","@types/stylis":"^4.2.7","@types/uuid":"^10.0.0",ajv:"^8.17.1",chokidar:"^4.0.3",concurrently:"^9.1.2","csstree-validator":"^4.0.1",globby:"^14.0.2",jison:"^0.4.18","js-base64":"^3.7.7",jsdom:"^26.0.0","json-schema-to-typescript":"^15.0.4",micromatch:"^4.0.8","path-browserify":"^1.0.1",prettier:"^3.5.2",remark:"^15.0.1","remark-frontmatter":"^5.0.0","remark-gfm":"^4.0.1",rimraf:"^6.0.1","start-server-and-test":"^2.0.10","type-fest":"^4.35.0",typedoc:"^0.27.8","typedoc-plugin-markdown":"^4.4.2",typescript:"~5.7.3","unist-util-flatmap":"^1.0.0","unist-util-visit":"^5.0.0",vitepress:"^1.0.2","vitepress-plugin-search":"1.0.4-alpha.22"},files:["dist/","README.md"],publishConfig:{access:"public"}},Iot=ie(e=>{var s;const{securityLevel:t}=ls();let n=Kr("body");if(t==="sandbox"){const a=((s=Kr(`#i${e}`).node())==null?void 0:s.contentDocument)??document;n=Kr(a.body)}return n.select(`#${e}`)},"selectSvgElement"),Xue="comm",Jue="rule",Que="decl",jot="@import",Oot="@namespace",Pot="@keyframes",Dot="@layer",ede=Math.abs,u5=String.fromCharCode;function tde(e){return e.trim()}function nC(e,t,n){return e.replace(t,n)}function Fot(e,t,n){return e.indexOf(t,n)}function U0(e,t){return e.charCodeAt(t)|0}function Fy(e,t,n){return e.slice(t,n)}function pu(e){return e.length}function Lot(e){return e.length}function E2(e,t){return t.push(e),e}var _A=1,Ly=1,nde=0,Xl=0,Ii=0,Tb="";function d5(e,t,n,r,s,i,a,o){return{value:e,root:t,parent:n,type:r,props:s,children:i,line:_A,column:Ly,length:a,return:"",siblings:o}}function Bot(){return Ii}function $ot(){return Ii=Xl>0?U0(Tb,--Xl):0,Ly--,Ii===10&&(Ly=1,_A--),Ii}function Mc(){return Ii=Xl<nde?U0(Tb,Xl++):0,Ly++,Ii===10&&(Ly=1,_A++),Ii}function hh(){return U0(Tb,Xl)}function rC(){return Xl}function SA(e,t){return Fy(Tb,e,t)}function h1(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function zot(e){return _A=Ly=1,nde=pu(Tb=e),Xl=0,[]}function Uot(e){return Tb="",e}function U3(e){return tde(SA(Xl-1,NO(e===91?e+2:e===40?e+1:e)))}function qot(e){for(;(Ii=hh())&&Ii<33;)Mc();return h1(e)>2||h1(Ii)>3?"":" "}function Vot(e,t){for(;--t&&Mc()&&!(Ii<48||Ii>102||Ii>57&&Ii<65||Ii>70&&Ii<97););return SA(e,rC()+(t<6&&hh()==32&&Mc()==32))}function NO(e){for(;Mc();)switch(Ii){case e:return Xl;case 34:case 39:e!==34&&e!==39&&NO(Ii);break;case 40:e===41&&NO(e);break;case 92:Mc();break}return Xl}function Wot(e,t){for(;Mc()&&e+Ii!==57;)if(e+Ii===84&&hh()===47)break;return"/*"+SA(t,Xl-1)+"*"+u5(e===47?e:Mc())}function Hot(e){for(;!h1(hh());)Mc();return SA(e,Xl)}function Got(e){return Uot(sC("",null,null,null,[""],e=zot(e),0,[0],e))}function sC(e,t,n,r,s,i,a,o,l){for(var c=0,u=0,d=a,h=0,m=0,y=0,b=1,v=1,x=1,w=0,S="",k=s,C=i,T=r,R=S;v;)switch(y=w,w=Mc()){case 40:if(y!=108&&U0(R,d-1)==58){Fot(R+=nC(U3(w),"&","&\f"),"&\f",ede(c?o[c-1]:0))!=-1&&(x=-1);break}case 34:case 39:case 91:R+=U3(w);break;case 9:case 10:case 13:case 32:R+=qot(y);break;case 92:R+=Vot(rC()-1,7);continue;case 47:switch(hh()){case 42:case 47:E2(Kot(Wot(Mc(),rC()),t,n,l),l),(h1(y||1)==5||h1(hh()||1)==5)&&pu(R)&&Fy(R,-1,void 0)!==" "&&(R+=" ");break;default:R+="/"}break;case 123*b:o[c++]=pu(R)*x;case 125*b:case 59:case 0:switch(w){case 0:case 125:v=0;case 59+u:x==-1&&(R=nC(R,/\f/g,"")),m>0&&(pu(R)-d||b===0&&y===47)&&E2(m>32?DW(R+";",r,n,d-1,l):DW(nC(R," ","")+";",r,n,d-2,l),l);break;case 59:R+=";";default:if(E2(T=PW(R,t,n,c,u,s,o,S,k=[],C=[],d,i),i),w===123)if(u===0)sC(R,t,T,T,k,i,d,o,C);else{switch(h){case 99:if(U0(R,3)===110)break;case 108:if(U0(R,2)===97)break;default:u=0;case 100:case 109:case 115:}u?sC(e,T,T,r&&E2(PW(e,T,T,0,0,s,o,S,s,k=[],d,C),C),s,C,d,o,r?k:C):sC(R,T,T,T,[""],C,0,o,C)}}c=u=m=0,b=x=1,S=R="",d=a;break;case 58:d=1+pu(R),m=y;default:if(b<1){if(w==123)--b;else if(w==125&&b++==0&&$ot()==125)continue}switch(R+=u5(w),w*b){case 38:x=u>0?1:(R+="\f",-1);break;case 44:o[c++]=(pu(R)-1)*x,x=1;break;case 64:hh()===45&&(R+=U3(Mc())),h=hh(),u=d=pu(S=R+=Hot(rC())),w++;break;case 45:y===45&&pu(R)==2&&(b=0)}}return i}function PW(e,t,n,r,s,i,a,o,l,c,u,d){for(var h=s-1,m=s===0?i:[""],y=Lot(m),b=0,v=0,x=0;b<r;++b)for(var w=0,S=Fy(e,h+1,h=ede(v=a[b])),k=e;w<y;++w)(k=tde(v>0?m[w]+" "+S:nC(S,/&\f/g,m[w])))&&(l[x++]=k);return d5(e,t,n,s===0?Jue:o,l,c,u,d)}function Kot(e,t,n,r){return d5(e,t,n,Xue,u5(Bot()),Fy(e,2,-2),0,r)}function DW(e,t,n,r,s){return d5(e,t,n,Que,Fy(e,0,r),Fy(e,r+1,-1),r,s)}function MO(e,t){for(var n="",r=0;r<e.length;r++)n+=t(e[r],r,e,t)||"";return n}function Yot(e,t,n,r){switch(e.type){case Dot:if(e.children.length)break;case jot:case Oot:case Que:return e.return=e.return||e.value;case Xue:return"";case Pot:return e.return=e.value+"{"+MO(e.children,r)+"}";case Jue:if(!pu(e.value=e.props.join(",")))return""}return pu(n=MO(e.children,r))?e.return=e.value+"{"+n+"}":""}var Zot=Dle(Object.keys,Object),Xot=Object.prototype,Jot=Xot.hasOwnProperty;function Qot(e){if(!hA(e))return Zot(e);var t=[];for(var n in Object(e))Jot.call(e,n)&&n!="constructor"&&t.push(n);return t}var IO=ig(Gu,"DataView"),jO=ig(Gu,"Promise"),OO=ig(Gu,"Set"),PO=ig(Gu,"WeakMap"),FW="[object Map]",elt="[object Object]",LW="[object Promise]",BW="[object Set]",$W="[object WeakMap]",zW="[object DataView]",tlt=sg(IO),nlt=sg(d1),rlt=sg(jO),slt=sg(OO),ilt=sg(PO),Yp=Sb;(IO&&Yp(new IO(new ArrayBuffer(1)))!=zW||d1&&Yp(new d1)!=FW||jO&&Yp(jO.resolve())!=LW||OO&&Yp(new OO)!=BW||PO&&Yp(new PO)!=$W)&&(Yp=function(e){var t=Sb(e),n=t==elt?e.constructor:void 0,r=n?sg(n):"";if(r)switch(r){case tlt:return zW;case nlt:return FW;case rlt:return LW;case slt:return BW;case ilt:return $W}return t});var alt="[object Map]",olt="[object Set]",llt=Object.prototype,clt=llt.hasOwnProperty;function UW(e){if(e==null)return!0;if(pA(e)&&(tE(e)||typeof e=="string"||typeof e.splice=="function"||UF(e)||qF(e)||eE(e)))return!e.length;var t=Yp(e);if(t==alt||t==olt)return!e.size;if(hA(e))return!Qot(e).length;for(var n in e)if(clt.call(e,n))return!1;return!0}var rde="c4",ult=ie(e=>/^\s*C4Context|C4Container|C4Component|C4Dynamic|C4Deployment/.test(e),"detector"),dlt=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./c4Diagram-VJAJSXHY-CJp36gal.js");return{diagram:t}},__vite__mapDeps([6,7]));return{id:rde,diagram:e}},"loader"),flt={id:rde,detector:ult,loader:dlt},hlt=flt,sde="flowchart",plt=ie((e,t)=>{var n,r;return((n=t==null?void 0:t.flowchart)==null?void 0:n.defaultRenderer)==="dagre-wrapper"||((r=t==null?void 0:t.flowchart)==null?void 0:r.defaultRenderer)==="elk"?!1:/^\s*graph/.test(e)},"detector"),mlt=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./flowDiagram-4HSFHLVR-dLjRI7TS.js");return{diagram:t}},__vite__mapDeps([8,9,10]));return{id:sde,diagram:e}},"loader"),glt={id:sde,detector:plt,loader:mlt},ylt=glt,ide="flowchart-v2",blt=ie((e,t)=>{var n,r,s;return((n=t==null?void 0:t.flowchart)==null?void 0:n.defaultRenderer)==="dagre-d3"?!1:(((r=t==null?void 0:t.flowchart)==null?void 0:r.defaultRenderer)==="elk"&&(t.layout="elk"),/^\s*graph/.test(e)&&((s=t==null?void 0:t.flowchart)==null?void 0:s.defaultRenderer)==="dagre-wrapper"?!0:/^\s*flowchart/.test(e))},"detector"),vlt=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./flowDiagram-4HSFHLVR-dLjRI7TS.js");return{diagram:t}},__vite__mapDeps([8,9,10]));return{id:ide,diagram:e}},"loader"),xlt={id:ide,detector:blt,loader:vlt},wlt=xlt,ade="er",_lt=ie(e=>/^\s*erDiagram/.test(e),"detector"),Slt=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./erDiagram-Q7BY3M3F-r1PlCGr9.js");return{diagram:t}},__vite__mapDeps([11,9,10]));return{id:ade,diagram:e}},"loader"),Clt={id:ade,detector:_lt,loader:Slt},klt=Clt,ode="gitGraph",Elt=ie(e=>/^\s*gitGraph/.test(e),"detector"),Tlt=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./gitGraphDiagram-7IBYFJ6S-CYx-3I0a.js");return{diagram:t}},__vite__mapDeps([12,13,14,15,2,4,5]));return{id:ode,diagram:e}},"loader"),Alt={id:ode,detector:Elt,loader:Tlt},Rlt=Alt,lde="gantt",Nlt=ie(e=>/^\s*gantt/.test(e),"detector"),Mlt=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./ganttDiagram-APWFNJXF-DfECq3RF.js");return{diagram:t}},__vite__mapDeps([16,17,18]));return{id:lde,diagram:e}},"loader"),Ilt={id:lde,detector:Nlt,loader:Mlt},jlt=Ilt,cde="info",Olt=ie(e=>/^\s*info/.test(e),"detector"),Plt=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./infoDiagram-PH2N3AL5-C12INeM9.js");return{diagram:t}},__vite__mapDeps([19,15,2,4,5]));return{id:cde,diagram:e}},"loader"),Dlt={id:cde,detector:Olt,loader:Plt},ude="pie",Flt=ie(e=>/^\s*pie/.test(e),"detector"),Llt=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./pieDiagram-IB7DONF6-DUVre1JV.js");return{diagram:t}},__vite__mapDeps([20,13,15,2,4,5,21,22,18]));return{id:ude,diagram:e}},"loader"),Blt={id:ude,detector:Flt,loader:Llt},dde="quadrantChart",$lt=ie(e=>/^\s*quadrantChart/.test(e),"detector"),zlt=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./quadrantDiagram-7GDLP6J5-Bs3I977R.js");return{diagram:t}},__vite__mapDeps([23,17,18]));return{id:dde,diagram:e}},"loader"),Ult={id:dde,detector:$lt,loader:zlt},qlt=Ult,fde="xychart",Vlt=ie(e=>/^\s*xychart-beta/.test(e),"detector"),Wlt=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./xychartDiagram-VJFVF3MP-DGOmMVCs.js");return{diagram:t}},__vite__mapDeps([24,18,22,17]));return{id:fde,diagram:e}},"loader"),Hlt={id:fde,detector:Vlt,loader:Wlt},Glt=Hlt,hde="requirement",Klt=ie(e=>/^\s*requirement(Diagram)?/.test(e),"detector"),Ylt=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./requirementDiagram-KVF5MWMF-DGOU7iYq.js");return{diagram:t}},__vite__mapDeps([25,9]));return{id:hde,diagram:e}},"loader"),Zlt={id:hde,detector:Klt,loader:Ylt},Xlt=Zlt,pde="sequence",Jlt=ie(e=>/^\s*sequenceDiagram/.test(e),"detector"),Qlt=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./sequenceDiagram-X6HHIX6F-BgC9UtfA.js");return{diagram:t}},__vite__mapDeps([26,7,14]));return{id:pde,diagram:e}},"loader"),ect={id:pde,detector:Jlt,loader:Qlt},tct=ect,mde="class",nct=ie((e,t)=>{var n;return((n=t==null?void 0:t.class)==null?void 0:n.defaultRenderer)==="dagre-wrapper"?!1:/^\s*classDiagram/.test(e)},"detector"),rct=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./classDiagram-GIVACNV2-DeNZmcv7.js");return{diagram:t}},__vite__mapDeps([27,28,9]));return{id:mde,diagram:e}},"loader"),sct={id:mde,detector:nct,loader:rct},ict=sct,gde="classDiagram",act=ie((e,t)=>{var n;return/^\s*classDiagram/.test(e)&&((n=t==null?void 0:t.class)==null?void 0:n.defaultRenderer)==="dagre-wrapper"?!0:/^\s*classDiagram-v2/.test(e)},"detector"),oct=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./classDiagram-v2-COTLJTTW-DeNZmcv7.js");return{diagram:t}},__vite__mapDeps([29,28,9]));return{id:gde,diagram:e}},"loader"),lct={id:gde,detector:act,loader:oct},cct=lct,yde="state",uct=ie((e,t)=>{var n;return((n=t==null?void 0:t.state)==null?void 0:n.defaultRenderer)==="dagre-wrapper"?!1:/^\s*stateDiagram/.test(e)},"detector"),dct=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./stateDiagram-DGXRK772-CSuiU3oR.js");return{diagram:t}},__vite__mapDeps([30,31,9,1,2,3,4]));return{id:yde,diagram:e}},"loader"),fct={id:yde,detector:uct,loader:dct},hct=fct,bde="stateDiagram",pct=ie((e,t)=>{var n;return!!(/^\s*stateDiagram-v2/.test(e)||/^\s*stateDiagram/.test(e)&&((n=t==null?void 0:t.state)==null?void 0:n.defaultRenderer)==="dagre-wrapper")},"detector"),mct=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./stateDiagram-v2-YXO3MK2T-BLDFo6Dx.js");return{diagram:t}},__vite__mapDeps([32,31,9]));return{id:bde,diagram:e}},"loader"),gct={id:bde,detector:pct,loader:mct},yct=gct,vde="journey",bct=ie(e=>/^\s*journey/.test(e),"detector"),vct=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./journeyDiagram-U35MCT3I-DO428gRt.js");return{diagram:t}},__vite__mapDeps([33,7,21]));return{id:vde,diagram:e}},"loader"),xct={id:vde,detector:bct,loader:vct},wct=xct,_ct=ie((e,t,n)=>{zt.debug(`rendering svg for syntax error
`);const r=Iot(t),s=r.append("g");r.attr("viewBox","0 0 2412 512"),Qie(r,100,512,!0),s.append("path").attr("class","error-icon").attr("d","m411.313,123.313c6.25-6.25 6.25-16.375 0-22.625s-16.375-6.25-22.625,0l-32,32-9.375,9.375-20.688-20.688c-12.484-12.5-32.766-12.5-45.25,0l-16,16c-1.261,1.261-2.304,2.648-3.31,4.051-21.739-8.561-45.324-13.426-70.065-13.426-105.867,0-192,86.133-192,192s86.133,192 192,192 192-86.133 192-192c0-24.741-4.864-48.327-13.426-70.065 1.402-1.007 2.79-2.049 4.051-3.31l16-16c12.5-12.492 12.5-32.758 0-45.25l-20.688-20.688 9.375-9.375 32.001-31.999zm-219.313,100.687c-52.938,0-96,43.063-96,96 0,8.836-7.164,16-16,16s-16-7.164-16-16c0-70.578 57.422-128 128-128 8.836,0 16,7.164 16,16s-7.164,16-16,16z"),s.append("path").attr("class","error-icon").attr("d","m459.02,148.98c-6.25-6.25-16.375-6.25-22.625,0s-6.25,16.375 0,22.625l16,16c3.125,3.125 7.219,4.688 11.313,4.688 4.094,0 8.188-1.563 11.313-4.688 6.25-6.25 6.25-16.375 0-22.625l-16.001-16z"),s.append("path").attr("class","error-icon").attr("d","m340.395,75.605c3.125,3.125 7.219,4.688 11.313,4.688 4.094,0 8.188-1.563 11.313-4.688 6.25-6.25 6.25-16.375 0-22.625l-16-16c-6.25-6.25-16.375-6.25-22.625,0s-6.25,16.375 0,22.625l15.999,16z"),s.append("path").attr("class","error-icon").attr("d","m400,64c8.844,0 16-7.164 16-16v-32c0-8.836-7.156-16-16-16-8.844,0-16,7.164-16,16v32c0,8.836 7.156,16 16,16z"),s.append("path").attr("class","error-icon").attr("d","m496,96.586h-32c-8.844,0-16,7.164-16,16 0,8.836 7.156,16 16,16h32c8.844,0 16-7.164 16-16 0-8.836-7.156-16-16-16z"),s.append("path").attr("class","error-icon").attr("d","m436.98,75.605c3.125,3.125 7.219,4.688 11.313,4.688 4.094,0 8.188-1.563 11.313-4.688l32-32c6.25-6.25 6.25-16.375 0-22.625s-16.375-6.25-22.625,0l-32,32c-6.251,6.25-6.251,16.375-0.001,22.625z"),s.append("text").attr("class","error-text").attr("x",1440).attr("y",250).attr("font-size","150px").style("text-anchor","middle").text("Syntax error in text"),s.append("text").attr("class","error-text").attr("x",1250).attr("y",400).attr("font-size","100px").style("text-anchor","middle").text(`mermaid version ${n}`)},"draw"),xde={draw:_ct},Sct=xde,Cct={db:{},renderer:xde,parser:{parse:ie(()=>{},"parse")}},kct=Cct,wde="flowchart-elk",Ect=ie((e,t={})=>{var n;return/^\s*flowchart-elk/.test(e)||/^\s*flowchart|graph/.test(e)&&((n=t==null?void 0:t.flowchart)==null?void 0:n.defaultRenderer)==="elk"?(t.layout="elk",!0):!1},"detector"),Tct=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./flowDiagram-4HSFHLVR-dLjRI7TS.js");return{diagram:t}},__vite__mapDeps([8,9,10]));return{id:wde,diagram:e}},"loader"),Act={id:wde,detector:Ect,loader:Tct},Rct=Act,_de="timeline",Nct=ie(e=>/^\s*timeline/.test(e),"detector"),Mct=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./timeline-definition-BDJGKUSR-5PNCS8va.js");return{diagram:t}},__vite__mapDeps([34,21]));return{id:_de,diagram:e}},"loader"),Ict={id:_de,detector:Nct,loader:Mct},jct=Ict,Sde="mindmap",Oct=ie(e=>/^\s*mindmap/.test(e),"detector"),Pct=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./mindmap-definition-ALO5MXBD-B5NydZAu.js");return{diagram:t}},__vite__mapDeps([35,36]));return{id:Sde,diagram:e}},"loader"),Dct={id:Sde,detector:Oct,loader:Pct},Fct=Dct,Cde="kanban",Lct=ie(e=>/^\s*kanban/.test(e),"detector"),Bct=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./kanban-definition-NDS4AKOZ-Bukjs2UI.js");return{diagram:t}},[]);return{id:Cde,diagram:e}},"loader"),$ct={id:Cde,detector:Lct,loader:Bct},zct=$ct,kde="sankey",Uct=ie(e=>/^\s*sankey-beta/.test(e),"detector"),qct=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./sankeyDiagram-QLVOVGJD-DLGD-uQD.js");return{diagram:t}},__vite__mapDeps([37,22,18]));return{id:kde,diagram:e}},"loader"),Vct={id:kde,detector:Uct,loader:qct},Wct=Vct,Ede="packet",Hct=ie(e=>/^\s*packet-beta/.test(e),"detector"),Gct=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./diagram-VNBRO52H-CfsbngXl.js");return{diagram:t}},__vite__mapDeps([38,13,15,2,4,5]));return{id:Ede,diagram:e}},"loader"),Kct={id:Ede,detector:Hct,loader:Gct},Tde="radar",Yct=ie(e=>/^\s*radar-beta/.test(e),"detector"),Zct=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./diagram-SSKATNLV-B7I0IRWi.js");return{diagram:t}},__vite__mapDeps([39,13,15,2,4,5]));return{id:Tde,diagram:e}},"loader"),Xct={id:Tde,detector:Yct,loader:Zct},Ade="block",Jct=ie(e=>/^\s*block-beta/.test(e),"detector"),Qct=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./blockDiagram-JOT3LUYC-D6w7gP5a.js");return{diagram:t}},__vite__mapDeps([40,5,2,1,10]));return{id:Ade,diagram:e}},"loader"),eut={id:Ade,detector:Jct,loader:Qct},tut=eut,Rde="architecture",nut=ie(e=>/^\s*architecture/.test(e),"detector"),rut=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./architectureDiagram-IEHRJDOE-13jt_nqz.js");return{diagram:t}},__vite__mapDeps([41,13,14,15,2,4,5,36]));return{id:Rde,diagram:e}},"loader"),sut={id:Rde,detector:nut,loader:rut},iut=sut,qW=!1,CA=ie(()=>{qW||(qW=!0,Ok("error",kct,e=>e.toLowerCase().trim()==="error"),Ok("---",{db:{clear:ie(()=>{},"clear")},styles:{},renderer:{draw:ie(()=>{},"draw")},parser:{parse:ie(()=>{throw new Error("Diagrams beginning with --- are not valid. If you were trying to use a YAML front-matter, please ensure that you've correctly opened and closed the YAML front-matter with un-indented `---` blocks")},"parse")},init:ie(()=>null,"init")},e=>e.toLowerCase().trimStart().startsWith("---")),$ie(hlt,zct,cct,ict,klt,jlt,Dlt,Blt,Xlt,tct,Rct,wlt,ylt,Fct,jct,Rlt,yct,hct,wct,qlt,Wct,Kct,Glt,tut,iut,Xct))},"addDiagrams"),aut=ie(async()=>{zt.debug("Loading registered diagrams");const t=(await Promise.allSettled(Object.entries(Ry).map(async([n,{detector:r,loader:s}])=>{if(s)try{G4(n)}catch{try{const{diagram:i,id:a}=await s();Ok(a,i,r)}catch(i){throw zt.error(`Failed to load external diagram with key ${n}. Removing from detectors.`),delete Ry[n],i}}}))).filter(n=>n.status==="rejected");if(t.length>0){zt.error(`Failed to load ${t.length} external diagrams`);for(const n of t)zt.error(n);throw new Error(`Failed to load ${t.length} external diagrams`)}},"loadRegisteredDiagrams"),out="graphics-document document";function Nde(e,t){e.attr("role",out),t!==""&&e.attr("aria-roledescription",t)}ie(Nde,"setA11yDiagramInfo");function Mde(e,t,n,r){if(e.insert!==void 0){if(n){const s=`chart-desc-${r}`;e.attr("aria-describedby",s),e.insert("desc",":first-child").attr("id",s).text(n)}if(t){const s=`chart-title-${r}`;e.attr("aria-labelledby",s),e.insert("title",":first-child").attr("id",s).text(t)}}}ie(Mde,"addSVGa11yTitleDescription");var bm,DO=(bm=class{constructor(t,n,r,s,i){this.type=t,this.text=n,this.db=r,this.parser=s,this.renderer=i}static async fromText(t,n={}){var c,u;const r=Po(),s=hF(t,r);t=Ait(t)+`
`;try{G4(s)}catch{const d=IZe(s);if(!d)throw new Bie(`Diagram ${s} not found.`);const{id:h,diagram:m}=await d();Ok(h,m)}const{db:i,parser:a,renderer:o,init:l}=G4(s);return a.parser&&(a.parser.yy=i),(c=i.clear)==null||c.call(i),l==null||l(r),n.title&&((u=i.setDiagramTitle)==null||u.call(i,n.title)),await a.parse(t),new bm(s,t,i,a,o)}async render(t,n){await this.renderer.draw(this.text,t,n,this)}getParser(){return this.parser}getType(){return this.type}},ie(bm,"Diagram"),bm),VW=[],lut=ie(()=>{VW.forEach(e=>{e()}),VW=[]},"attachFunctions"),cut=ie(e=>e.replace(/^\s*%%(?!{)[^\n]+\n?/gm,"").trimStart(),"cleanupComments");function Ide(e){const t=e.match(Lie);if(!t)return{text:e,metadata:{}};let n=MJe(t[1],{schema:NJe})??{};n=typeof n=="object"&&!Array.isArray(n)?n:{};const r={};return n.displayMode&&(r.displayMode=n.displayMode.toString()),n.title&&(r.title=n.title.toString()),n.config&&(r.config=n.config),{text:e.slice(t[0].length),metadata:r}}ie(Ide,"extractFrontMatter");var uut=ie(e=>e.replace(/\r\n?/g,`
`).replace(/<(\w+)([^>]*)>/g,(t,n,r)=>"<"+n+r.replace(/="([^"]*)"/g,"='$1'")+">"),"cleanupText"),dut=ie(e=>{const{text:t,metadata:n}=Ide(e),{displayMode:r,title:s,config:i={}}=n;return r&&(i.gantt||(i.gantt={}),i.gantt.displayMode=r),{title:s,config:i,text:t}},"processFrontmatter"),fut=ie(e=>{const t=vu.detectInit(e)??{},n=vu.detectDirective(e,"wrap");return Array.isArray(n)?t.wrap=n.some(({type:r})=>r==="wrap"):(n==null?void 0:n.type)==="wrap"&&(t.wrap=!0),{text:mit(e),directive:t}},"processDirectives");function f5(e){const t=uut(e),n=dut(t),r=fut(n.text),s=YF(n.config,r.directive);return e=cut(r.text),{code:e,title:n.title,config:s}}ie(f5,"preprocessDiagram");function jde(e){const t=new TextEncoder().encode(e),n=Array.from(t,r=>String.fromCodePoint(r)).join("");return btoa(n)}ie(jde,"toBase64");var hut=5e4,put="graph TB;a[Maximum text size in diagram exceeded];style a fill:#faa",mut="sandbox",gut="loose",yut="http://www.w3.org/2000/svg",but="http://www.w3.org/1999/xlink",vut="http://www.w3.org/1999/xhtml",xut="100%",wut="100%",_ut="border:0;margin:0;",Sut="margin:0",Cut="allow-top-navigation-by-user-activation allow-popups",kut='The "iframe" tag is not supported by your browser.',Eut=["foreignobject"],Tut=["dominant-baseline"];function h5(e){const t=f5(e);return Ik(),KZe(t.config??{}),t}ie(h5,"processAndSetConfigs");async function Ode(e,t){CA();try{const{code:n,config:r}=h5(e);return{diagramType:(await Dde(n)).type,config:r}}catch(n){if(t!=null&&t.suppressErrors)return!1;throw n}}ie(Ode,"parse");var WW=ie((e,t,n=[])=>`
.${e} ${t} { ${n.join(" !important; ")} !important; }`,"cssImportantStyles"),Aut=ie((e,t=new Map)=>{var r;let n="";if(e.themeCSS!==void 0&&(n+=`
${e.themeCSS}`),e.fontFamily!==void 0&&(n+=`
:root { --mermaid-font-family: ${e.fontFamily}}`),e.altFontFamily!==void 0&&(n+=`
:root { --mermaid-alt-font-family: ${e.altFontFamily}}`),t instanceof Map){const o=e.htmlLabels??((r=e.flowchart)==null?void 0:r.htmlLabels)?["> *","span"]:["rect","polygon","ellipse","circle","path"];t.forEach(l=>{UW(l.styles)||o.forEach(c=>{n+=WW(l.id,c,l.styles)}),UW(l.textStyles)||(n+=WW(l.id,"tspan",((l==null?void 0:l.textStyles)||[]).map(c=>c.replace("color","fill"))))})}return n},"createCssStyles"),Rut=ie((e,t,n,r)=>{const s=Aut(e,n),i=hXe(t,s,e.themeVariables);return MO(Got(`${r}{${i}}`),Yot)},"createUserStyles"),Nut=ie((e="",t,n)=>{let r=e;return!n&&!t&&(r=r.replace(/marker-end="url\([\d+./:=?A-Za-z-]*?#/g,'marker-end="url(#')),r=ag(r),r=r.replace(/<br>/g,"<br/>"),r},"cleanUpSvgCode"),Mut=ie((e="",t)=>{var s,i;const n=(i=(s=t==null?void 0:t.viewBox)==null?void 0:s.baseVal)!=null&&i.height?t.viewBox.baseVal.height+"px":wut,r=jde(`<body style="${Sut}">${e}</body>`);return`<iframe style="width:${xut};height:${n};${_ut}" src="data:text/html;charset=UTF-8;base64,${r}" sandbox="${Cut}">
  ${kut}
</iframe>`},"putIntoIFrame"),HW=ie((e,t,n,r,s)=>{const i=e.append("div");i.attr("id",n),r&&i.attr("style",r);const a=i.append("svg").attr("id",t).attr("width","100%").attr("xmlns",yut);return s&&a.attr("xmlns:xlink",s),a.append("g"),e},"appendDivSvgG");function FO(e,t){return e.append("iframe").attr("id",t).attr("style","width: 100%; height: 100%;").attr("sandbox","")}ie(FO,"sandboxedIframe");var Iut=ie((e,t,n,r)=>{var s,i,a;(s=e.getElementById(t))==null||s.remove(),(i=e.getElementById(n))==null||i.remove(),(a=e.getElementById(r))==null||a.remove()},"removeExistingElements"),jut=ie(async function(e,t,n){var D,W,O,Z,U,H;CA();const r=h5(t);t=r.code;const s=Po();zt.debug(s),t.length>((s==null?void 0:s.maxTextSize)??hut)&&(t=put);const i="#"+e,a="i"+e,o="#"+a,l="d"+e,c="#"+l,u=ie(()=>{const te=Kr(h?o:c).node();te&&"remove"in te&&te.remove()},"removeTempElements");let d=Kr("body");const h=s.securityLevel===mut,m=s.securityLevel===gut,y=s.fontFamily;if(n!==void 0){if(n&&(n.innerHTML=""),h){const L=FO(Kr(n),a);d=Kr(L.nodes()[0].contentDocument.body),d.node().style.margin=0}else d=Kr(n);HW(d,e,l,`font-family: ${y}`,but)}else{if(Iut(document,e,l,a),h){const L=FO(Kr("body"),a);d=Kr(L.nodes()[0].contentDocument.body),d.node().style.margin=0}else d=Kr("body");HW(d,e,l)}let b,v;try{b=await DO.fromText(t,{title:r.title})}catch(L){if(s.suppressErrorRendering)throw u(),L;b=await DO.fromText("error"),v=L}const x=d.select(c).node(),w=b.type,S=x.firstChild,k=S.firstChild,C=(W=(D=b.renderer).getClasses)==null?void 0:W.call(D,t,b),T=Rut(s,w,C,i),R=document.createElement("style");R.innerHTML=T,S.insertBefore(R,k);try{await b.renderer.draw(t,e,OW.version,b)}catch(L){throw s.suppressErrorRendering?u():Sct.draw(t,e,OW.version),L}const N=d.select(`${c} svg`),I=(Z=(O=b.db).getAccTitle)==null?void 0:Z.call(O),P=(H=(U=b.db).getAccDescription)==null?void 0:H.call(U);Fde(w,N,I,P),d.select(`[id="${e}"]`).selectAll("foreignobject > *").attr("xmlns",vut);let B=d.select(c).node().innerHTML;if(zt.debug("config.arrowMarkerAbsolute",s.arrowMarkerAbsolute),B=Nut(B,h,Gi(s.arrowMarkerAbsolute)),h){const L=d.select(c+" svg").node();B=Mut(B,L)}else m||(B=Ay.sanitize(B,{ADD_TAGS:Eut,ADD_ATTR:Tut,HTML_INTEGRATION_POINTS:{foreignobject:!0}}));if(lut(),v)throw v;return u(),{diagramType:w,svg:B,bindFunctions:b.db.bindFunctions}},"render");function Pde(e={}){var r;const t=Ca({},e);t!=null&&t.fontFamily&&!((r=t.themeVariables)!=null&&r.fontFamily)&&(t.themeVariables||(t.themeVariables={}),t.themeVariables.fontFamily=t.fontFamily),HZe(t),t!=null&&t.theme&&t.theme in qd?t.themeVariables=qd[t.theme].getThemeVariables(t.themeVariables):t&&(t.themeVariables=qd.default.getThemeVariables(t.themeVariables));const n=typeof t=="object"?WZe(t):Hie();fF(n.logLevel),CA()}ie(Pde,"initialize");var Dde=ie((e,t={})=>{const{code:n}=f5(e);return DO.fromText(n,t)},"getDiagramFromText");function Fde(e,t,n,r){Nde(t,e),Mde(t,n,r,t.attr("id"))}ie(Fde,"addA11yInfo");var $m=Object.freeze({render:jut,parse:Ode,getDiagramFromText:Dde,initialize:Pde,getConfig:Po,setConfig:Gie,getSiteConfig:Hie,updateSiteConfig:GZe,reset:ie(()=>{Ik()},"reset"),globalReset:ie(()=>{Ik(Ny)},"globalReset"),defaultConfig:Ny});fF(Po().logLevel);Ik(Po());var Out=ie((e,t,n)=>{zt.warn(e),KF(e)?(n&&n(e.str,e.hash),t.push({...e,message:e.str,error:e})):(n&&n(e),e instanceof Error&&t.push({str:e.message,message:e.message,hash:e.name,error:e}))},"handleError"),Lde=ie(async function(e={querySelector:".mermaid"}){try{await Put(e)}catch(t){if(KF(t)&&zt.error(t.str),ml.parseError&&ml.parseError(t),!e.suppressErrors)throw zt.error("Use the suppressErrors option to suppress these errors"),t}},"run"),Put=ie(async function({postRenderCallback:e,querySelector:t,nodes:n}={querySelector:".mermaid"}){const r=$m.getConfig();zt.debug(`${e?"":"No "}Callback function found`);let s;if(n)s=n;else if(t)s=document.querySelectorAll(t);else throw new Error("Nodes and querySelector are both undefined");zt.debug(`Found ${s.length} diagrams`),(r==null?void 0:r.startOnLoad)!==void 0&&(zt.debug("Start On Load: "+(r==null?void 0:r.startOnLoad)),$m.updateSiteConfig({startOnLoad:r==null?void 0:r.startOnLoad}));const i=new vu.InitIDGenerator(r.deterministicIds,r.deterministicIDSeed);let a;const o=[];for(const l of Array.from(s)){if(zt.info("Rendering diagram: "+l.id),l.getAttribute("data-processed"))continue;l.setAttribute("data-processed","true");const c=`mermaid-${i.next()}`;a=l.innerHTML,a=fce(vu.entityDecode(a)).trim().replace(/<br\s*\/?>/gi,"<br/>");const u=vu.detectInit(a);u&&zt.debug("Detected early reinit: ",u);try{const{svg:d,bindFunctions:h}=await Ude(c,a,l);l.innerHTML=d,e&&await e(c),h&&h(l)}catch(d){Out(d,o,ml.parseError)}}if(o.length>0)throw o[0]},"runThrowsErrors"),Bde=ie(function(e){$m.initialize(e)},"initialize"),Dut=ie(async function(e,t,n){zt.warn("mermaid.init is deprecated. Please use run instead."),e&&Bde(e);const r={postRenderCallback:n,querySelector:".mermaid"};typeof t=="string"?r.querySelector=t:t&&(t instanceof HTMLElement?r.nodes=[t]:r.nodes=t),await Lde(r)},"init"),Fut=ie(async(e,{lazyLoad:t=!0}={})=>{CA(),$ie(...e),t===!1&&await aut()},"registerExternalDiagrams"),$de=ie(function(){if(ml.startOnLoad){const{startOnLoad:e}=$m.getConfig();e&&ml.run().catch(t=>zt.error("Mermaid failed to initialize",t))}},"contentLoaded");typeof document<"u"&&window.addEventListener("load",$de,!1);var Lut=ie(function(e){ml.parseError=e},"setParseErrorHandler"),dE=[],q3=!1,zde=ie(async()=>{if(!q3){for(q3=!0;dE.length>0;){const e=dE.shift();if(e)try{await e()}catch(t){zt.error("Error executing queue",t)}}q3=!1}},"executeQueue"),But=ie(async(e,t)=>new Promise((n,r)=>{const s=ie(()=>new Promise((i,a)=>{$m.parse(e,t).then(o=>{i(o),n(o)},o=>{var l;zt.error("Error parsing",o),(l=ml.parseError)==null||l.call(ml,o),a(o),r(o)})}),"performCall");dE.push(s),zde().catch(r)}),"parse"),Ude=ie((e,t,n)=>new Promise((r,s)=>{const i=ie(()=>new Promise((a,o)=>{$m.render(e,t,n).then(l=>{a(l),r(l)},l=>{var c;zt.error("Error parsing",l),(c=ml.parseError)==null||c.call(ml,l),o(l),s(l)})}),"performCall");dE.push(i),zde().catch(s)}),"render"),ml={startOnLoad:!0,mermaidAPI:$m,parse:But,render:Ude,init:Dut,run:Lde,registerExternalDiagrams:Fut,registerLayoutLoaders:Zue,initialize:Bde,parseError:void 0,contentLoaded:$de,setParseErrorHandler:Lut,detectType:hF,registerIconPacks:eQe},$ut=ml;/*! Check if previously processed *//*!
 * Wait for document loaded before starting the execution
 */const zut=new DOMParser,Uut=new XMLSerializer;function GW(e,t){const n=e.getAttribute(t);if(!n)return;let r="";for(const s of n.split(/\s+/)){const i=e.getElementById(s);i&&(r+=i.textContent)}return r}let KW=0;const qut=async(e,t)=>{const n=document.createElement("div");n.ariaHidden="true",n.style.maxHeight="0",n.style.opacity="0",n.style.overflow="hidden",t!=null&&t.containerStyle&&Object.assign(n.style,t.containerStyle),document.body.append(n);const r=await Promise.allSettled(e.map(async s=>{const i=`${(t==null?void 0:t.prefix)??"mermaid"}-${KW}`;KW+=1;const{svg:a}=await $ut.render(i,s,n),o=zut.parseFromString(a,"text/html"),[l]=o.getElementsByTagName("svg"),{height:c,width:u}=l.viewBox.baseVal,d=GW(l,"aria-describedby"),h=GW(l,"aria-labelledby"),m={height:c,id:i,svg:Uut.serializeToString(l),width:u};return d&&(m.description=d),h&&(m.title=h),m}));return n.remove(),r},Vut=()=>qut,Wut=({code:e,isStreaming:t=!1})=>{const{foldStreamingCodeBlocks:n}=br(yn(T=>({foldStreamingCodeBlocks:T.foldStreamingCodeBlocks}))),[r,s]=E.useState(t?n:!1),[i,a]=E.useState(null),[o,l]=E.useState(!1),[c,u]=E.useState(null),[d,h]=E.useState(!1),m=E.useRef(null),y=Vi(yn(T=>Object.values(T.canvasControls))),b=E.useCallback((T,R,N,I,P)=>y.filter(B=>B.type==="codeblock"&&B.targetSlot===T&&B.renderer).map(B=>{if(B.renderer){const D={codeBlockContent:R,codeBlockLang:"mermaid",isFolded:I,toggleFold:P,canvasContextType:"codeblock"};return f.jsx(Ve.Fragment,{children:B.renderer(D)},B.id)}return null}).filter(Boolean),[y]),v=E.useCallback(async()=>{if(!(!e.trim()||r)){l(!0),u(null),a(null);try{const R=await Vut()([e]);if(R.length>0&&R[0].status==="fulfilled")a(R[0].value.svg);else if(R.length>0&&R[0].status==="rejected"){const N=R[0].reason;u((N==null?void 0:N.message)||"Failed to render Mermaid diagram")}else u("No results returned from Mermaid renderer")}catch(T){console.error("Mermaid rendering error:",T),u(T instanceof Error?T.message:"Failed to render Mermaid diagram")}finally{l(!1)}}},[e,r]);E.useEffect(()=>{!r&&e.trim()&&!d&&v()},[e,r,d,v]);const x=()=>{const T=r;s(R=>!R),T&&!d&&setTimeout(v,0)},w=E.useCallback(async()=>{if(!i){Me.error("No SVG content to download");return}try{const T=new Blob([i],{type:"image/svg+xml"}),R=URL.createObjectURL(T),N=document.createElement("a");N.href=R,N.download="mermaid-diagram.svg",document.body.appendChild(N),N.click(),document.body.removeChild(N),URL.revokeObjectURL(R),Me.success("SVG downloaded successfully!")}catch(T){console.error("Download error:",T),Me.error("Failed to download SVG")}},[i]),S=E.useCallback(()=>{h(T=>!T)},[]),k=E.useMemo(()=>e?e.split(`
`).slice(0,3).join(`
`):"",[e]),C=b("codeblock-header-actions",e,"mermaid",r,x);return f.jsxs("div",{className:"code-block-container group/codeblock my-4 max-w-full",children:[f.jsxs("div",{className:"code-block-header sticky top-0 z-10 flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx("div",{className:"text-sm font-medium",children:"MERMAID"}),f.jsx("div",{className:"flex items-center gap-0.5 opacity-0 group-hover/codeblock:opacity-100 focus-within:opacity-100 transition-opacity",children:C})]}),f.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover/codeblock:opacity-100 focus-within:opacity-100 transition-opacity",children:[f.jsx("button",{onClick:S,className:"p-1.5 rounded-md hover:bg-muted/50 transition-colors",title:d?"Show diagram":"Show code",children:d?f.jsx(J0,{className:"h-4 w-4"}):f.jsx(mE,{className:"h-4 w-4"})}),i&&!d&&f.jsx("button",{onClick:w,className:"p-1.5 rounded-md hover:bg-muted/50 transition-colors",title:"Download SVG",children:f.jsx(Ec,{className:"h-4 w-4"})})]})]}),!r&&f.jsx("div",{className:"overflow-hidden w-full",children:d?f.jsx(dF,{lang:"mermaid",code:e,isStreaming:t}):f.jsxs(f.Fragment,{children:[o&&f.jsxs("div",{className:"flex items-center justify-center p-8",children:[f.jsx(Xn,{className:"h-6 w-6 animate-spin text-muted-foreground"}),f.jsx("span",{className:"ml-2 text-sm text-muted-foreground",children:"Rendering diagram..."})]}),c&&f.jsxs("div",{className:"flex items-center gap-2 p-4 border border-destructive/20 bg-destructive/10 rounded-md",children:[f.jsx(Kl,{className:"h-5 w-5 text-destructive flex-shrink-0"}),f.jsxs("div",{className:"text-sm text-destructive",children:[f.jsx("div",{className:"font-medium",children:"Failed to render Mermaid diagram"}),f.jsx("div",{className:"text-xs mt-1 opacity-80",children:c})]})]}),i&&!o&&!c&&f.jsx("div",{ref:m,className:"mermaid-container p-4 bg-background border rounded-md overflow-auto",dangerouslySetInnerHTML:{__html:i}})]})}),r&&f.jsx("div",{className:"folded-content-preview p-4 cursor-pointer w-full box-border",onClick:x,children:f.jsx("pre",{className:"whitespace-pre-wrap break-words text-muted-foreground font-mono text-sm",children:k})})]})},Hut=E.memo(Wut);class Gut{constructor(){de(this,"id","core-block-renderer-mermaid");de(this,"unregisterCallback")}async initialize(){}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}const n={id:this.id,supportedLanguages:["mermaid"],priority:10,renderer:r=>Ve.createElement(Hut,{code:r.code,isStreaming:r.isStreaming})};this.unregisterCallback=t.registerBlockRenderer(n)}destroy(){this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=void 0)}}class Zp{static parse(t){try{const n=this.sanitizeCode(t),r=this.parseObjectLiteral(n);return this.validateAndSanitize(r)}catch(n){throw new Error(`Failed to parse Formedible definition: ${n instanceof Error?n.message:String(n)}`)}}static sanitizeCode(t){let n=t.replace(/\/\*[\s\S]*?\*\//g,"").replace(/\/\/.*$/gm,"");return n=n.replace(/\b(eval|Function|setTimeout|setInterval|require|import)\s*\(/g,""),n=n.replace(/=>\s*{[^}]*}/g,'""'),n=n.replace(/function\s*\([^)]*\)\s*{[^}]*}/g,'""'),n}static parseObjectLiteral(t){try{return JSON.parse(t)}catch{try{let r=t.trim();return r=this.replaceZodExpressions(r),r=r.replace(/([{,]\s*)([a-zA-Z_$][a-zA-Z0-9_$]*)\s*:/g,'$1"$2":'),r=r.replace(/,(\s*[}\]])/g,"$1"),r=r.replace(/'/g,'"'),JSON.parse(r)}catch(r){throw new Error(`Invalid syntax. Please use valid JSON format or JavaScript object literal syntax. Error: ${r instanceof Error?r.message:String(r)}`)}}}static replaceZodExpressions(t){let n=t,r=!0;for(;r;){r=!1;const s=n.match(/z\.[a-zA-Z]+\(/);if(s){const i=s.index,a=i+s[0].length-1;let o=1,l=a+1;for(;l<n.length&&o>0;)n[l]==="("?o++:n[l]===")"&&o--,l++;if(o===0){let c=l;for(;c<n.length;){const u=n.slice(c).match(/^\.[a-zA-Z]+\(/);if(u){let d=1,m=c+u[0].length-1+1;for(;m<n.length&&d>0;)n[m]==="("?d++:n[m]===")"&&d--,m++;if(d===0)c=m;else break}else break}n=n.slice(0,i)+'"__ZOD_SCHEMA__"'+n.slice(c),r=!0}else n=n.replace(/z\.[a-zA-Z]+/,'"__ZOD_SCHEMA__"'),r=!0}}return n}static validateAndSanitize(t){if(typeof t!="object"||t===null)throw new Error("Definition must be an object");const n={};for(const[r,s]of Object.entries(t))if(this.ALLOWED_KEYS.includes(r))switch(r){case"schema":break;case"fields":n[r]=this.validateFields(s);break;case"pages":n[r]=this.validatePages(s);break;case"progress":n[r]=this.validateProgress(s);break;case"formOptions":n[r]=this.validateFormOptions(s);break;case"submitLabel":case"nextLabel":case"previousLabel":case"formClassName":case"fieldClassName":typeof s=="string"&&(n[r]=s);break}return n}static validateFields(t){if(!Array.isArray(t))throw new Error("Fields must be an array");return t.map((n,r)=>{if(typeof n!="object"||n===null)throw new Error(`Field at index ${r} must be an object`);const s={};for(const[i,a]of Object.entries(n))if(this.ALLOWED_FIELD_KEYS.includes(i))switch(i){case"name":typeof a=="string"&&/^[a-zA-Z_$][a-zA-Z0-9_$]*$/.test(a)&&(s[i]=a);break;case"type":typeof a=="string"&&this.ALLOWED_FIELD_TYPES.includes(a)&&(s[i]=a);break;case"label":case"placeholder":case"description":case"accept":typeof a=="string"&&(s[i]=a);break;case"options":Array.isArray(a)&&(s[i]=a.filter(o=>typeof o=="string"||typeof o=="object"&&o!==null&&typeof o.value=="string"&&typeof o.label=="string"));break;case"min":case"max":case"step":case"page":typeof a=="number"&&!isNaN(a)&&(s[i]=a);break;case"multiple":typeof a=="boolean"&&(s[i]=a);break}if(!s.name||!s.type)throw new Error(`Field at index ${r} must have 'name' and 'type' properties`);return s})}static validatePages(t){return Array.isArray(t)?t.map(n=>{if(typeof n!="object"||n===null)return null;const r={};for(const[s,i]of Object.entries(n))if(this.ALLOWED_PAGE_KEYS.includes(s))switch(s){case"page":typeof i=="number"&&!isNaN(i)&&(r[s]=i);break;case"title":case"description":typeof i=="string"&&(r[s]=i);break}return r.page?r:null}).filter(Boolean):[]}static validateProgress(t){if(typeof t!="object"||t===null)return{};const n={};for(const[r,s]of Object.entries(t))if(this.ALLOWED_PROGRESS_KEYS.includes(r))switch(r){case"showSteps":case"showPercentage":typeof s=="boolean"&&(n[r]=s);break;case"className":typeof s=="string"&&(n[r]=s);break}return n}static validateFormOptions(t){if(typeof t!="object"||t===null)return{};const n={};for(const[r,s]of Object.entries(t))if(this.ALLOWED_FORM_OPTIONS_KEYS.includes(r))switch(r){case"defaultValues":typeof s=="object"&&s!==null&&(n[r]=s);break;case"asyncDebounceMs":typeof s=="number"&&!isNaN(s)&&(n[r]=s);break;case"canSubmitWhenInvalid":typeof s=="boolean"&&(n[r]=s);break}return n}}de(Zp,"ALLOWED_FIELD_TYPES",["text","email","password","url","tel","textarea","select","checkbox","switch","number","date","slider","file"]),de(Zp,"ALLOWED_KEYS",["schema","fields","pages","progress","submitLabel","nextLabel","previousLabel","formClassName","fieldClassName","formOptions"]),de(Zp,"ALLOWED_FIELD_KEYS",["name","type","label","placeholder","description","options","min","max","step","accept","multiple","page","conditional"]),de(Zp,"ALLOWED_PAGE_KEYS",["page","title","description"]),de(Zp,"ALLOWED_PROGRESS_KEYS",["showSteps","showPercentage","className"]),de(Zp,"ALLOWED_FORM_OPTIONS_KEYS",["defaultValues","asyncDebounceMs","canSubmitWhenInvalid"]);const Kut=({code:e,isStreaming:t=!1})=>{const{foldStreamingCodeBlocks:n}=br(yn(W=>({foldStreamingCodeBlocks:W.foldStreamingCodeBlocks}))),[r,s]=E.useState(t?n:!1),[i,a]=E.useState(null),[o,l]=E.useState(!1),[c,u]=E.useState(null),[d,h]=E.useState(!1),[m,y]=E.useState(!1),b=E.useMemo(()=>`_sendOnSubmit_${as()}`,[]),v=Vi(yn(W=>Object.values(W.canvasControls))),x=E.useCallback((W,O,Z,U,H)=>v.filter(L=>L.type==="codeblock"&&L.targetSlot===W&&L.renderer).map(L=>{if(L.renderer){const te={codeBlockContent:O,codeBlockLang:"formedible",isFolded:U,toggleFold:H,canvasContextType:"codeblock"};return f.jsx(Ve.Fragment,{children:L.renderer(te)},L.id)}return null}).filter(Boolean),[v]),w=E.useCallback(async()=>{if(!(!e.trim()||r)){l(!0),u(null),a(null);try{const W=Zp.parse(e);a(W)}catch(W){console.error("Formedible parsing error:",W),u(W instanceof Error?W.message:"Failed to parse Formedible definition")}finally{l(!1)}}},[e,r]);E.useEffect(()=>{!r&&e.trim()&&!d&&!t&&w()},[e,r,d,t,w]);const S=()=>{const W=r;s(O=>!O),W&&!d&&setTimeout(w,0)},k=E.useCallback(()=>{h(W=>!W)},[]),C=E.useMemo(()=>e?e.split(`
`).slice(0,3).join(`
`):"",[e]),T=E.useCallback(W=>{const O={};return W.forEach(Z=>{switch(Z.type){case"text":case"email":case"password":case"url":case"tel":case"textarea":O[Z.name]=ze();break;case"number":case"slider":O[Z.name]=At();break;case"checkbox":case"switch":O[Z.name]=Kn();break;case"date":O[Z.name]=ube();break;case"select":O[Z.name]=ze();break;case"file":O[Z.name]=Hd();break;default:O[Z.name]=ze()}}),Ke(O)},[]),R=E.useCallback(W=>{const O={};return W.forEach(Z=>{switch(Z.type){case"text":case"email":case"password":case"url":case"tel":case"textarea":O[Z.name]="";break;case"number":case"slider":O[Z.name]=Z.min||0;break;case"checkbox":case"switch":O[Z.name]=!1;break;case"date":O[Z.name]=new Date().toISOString().split("T")[0];break;case"select":if(Z.options&&Z.options.length>0){const U=Z.options[0];O[Z.name]=typeof U=="string"?U:U.value}else O[Z.name]="";break;case"file":O[Z.name]=null;break;default:O[Z.name]=""}}),O},[]),N=E.useCallback(async(W,O)=>{try{const U=`These are the form values:
\`\`\`json
${JSON.stringify(W,null,2)}
\`\`\`
`;Pe.emit(gn.setInputTextRequest,{text:U}),Pe.emit(gn.focusInputRequest,void 0),console.log("Formedible: sendOnSubmit value before conditional: ",O),O?(console.log("Sending form data to prompt"),requestAnimationFrame(()=>{console.log("Setting input text");try{console.log("Creating turn data");const H={id:as(),content:U,parameters:{},metadata:{}};Pe.emit(gn.submitPromptRequest,{turnData:H}),Me.success("Form submitted and prompt sent!")}catch(H){console.error("Failed to submit prompt:",H),Me.error("Form data added to input, but failed to send prompt")}})):Me.success("Form data added to prompt input")}catch(Z){console.error("Form submission error:",Z),Me.error("Failed to process form submission")}},[]),I=E.useMemo(()=>{var W;if(!i||!i.fields)return null;try{const O=T(i.fields),Z=((W=i.formOptions)==null?void 0:W.defaultValues)||R(i.fields),U=i.pages&&i.pages.length>0?Math.max(...i.pages.map(V=>V.page)):1,H=[...i.fields,{name:b,type:"switch",label:"Send on submit",description:"Automatically send the prompt after form submission",page:U}],L=O.extend({[b]:Kn().default(!1)}),te={...Z,[b]:!1};return{schema:L,fields:H,pages:i.pages,progress:i.progress,submitLabel:i.submitLabel||"Submit",nextLabel:i.nextLabel||"Next",previousLabel:i.previousLabel||"Previous",formClassName:i.formClassName,fieldClassName:i.fieldClassName,formOptions:{...i.formOptions,defaultValues:te,canSubmitWhenInvalid:!0,onSubmit:async({value:V})=>{console.log("Formedible onSubmit received full value:",V),console.log("Formedible onSubmit received sendOnSubmit:",V[b]);const Q=V[b],ee={...V};delete ee[b],y(Q),await N(ee,Q)},onSubmitInvalid:({value:V,formApi:Q})=>{console.error("Formedible onSubmitInvalid triggered. Values:",V),console.error("Formedible onSubmitInvalid triggered. Form API errors:",Q.formState.errors),Me.error("Form has validation errors. Please check your input.")}},disabled:!1}}catch(O){return console.error("Form configuration error:",O),{error:O instanceof Error?O.message:"Unknown error"}}},[i,T,R,N,b]),P=GT(I&&!("error"in I)?I:{fields:[],formOptions:{defaultValues:{}}}),B=E.useMemo(()=>I?"error"in I?f.jsx("div",{className:"p-4 border border-destructive/20 bg-destructive/10 rounded-md",children:f.jsxs("div",{className:"text-sm text-destructive",children:["Failed to render form: ",I.error]})}):!i||!i.fields?null:f.jsx(P.Form,{}):null,[I,i,P.Form]),D=x("codeblock-header-actions",e,"formedible",r,S);return f.jsxs("div",{className:"code-block-container group/codeblock my-4 max-w-full",children:[f.jsxs("div",{className:"code-block-header sticky top-0 z-10 flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx("div",{className:"text-sm font-medium",children:"FORMEDIBLE"}),f.jsx("div",{className:"flex items-center gap-0.5 opacity-0 group-hover/codeblock:opacity-100 focus-within:opacity-100 transition-opacity",children:D})]}),f.jsx("div",{className:"flex items-center gap-1 opacity-0 group-hover/codeblock:opacity-100 focus-within:opacity-100 transition-opacity",children:f.jsx("button",{onClick:k,className:"p-1.5 rounded-md hover:bg-muted/50 transition-colors",title:d?"Show form":"Show code",children:d?f.jsx(xge,{className:"h-4 w-4"}):f.jsx(mE,{className:"h-4 w-4"})})})]}),!r&&f.jsx("div",{className:"overflow-hidden w-full",children:d?f.jsx(dF,{lang:"formedible",code:e,isStreaming:t}):f.jsxs(f.Fragment,{children:[o&&f.jsxs("div",{className:"flex items-center justify-center p-8",children:[f.jsx(Xn,{className:"h-6 w-6 animate-spin text-muted-foreground"}),f.jsx("span",{className:"ml-2 text-sm text-muted-foreground",children:"Parsing form definition..."})]}),c&&f.jsxs("div",{className:"flex items-center gap-2 p-4 border border-destructive/20 bg-destructive/10 rounded-md",children:[f.jsx(Kl,{className:"h-5 w-5 text-destructive flex-shrink-0"}),f.jsxs("div",{className:"text-sm text-destructive",children:[f.jsx("div",{className:"font-medium",children:"Failed to parse Formedible definition"}),f.jsx("div",{className:"text-xs mt-1 opacity-80",children:c})]})]}),B&&!o&&!c&&f.jsxs("div",{className:"p-4 bg-background border rounded-md",children:[f.jsx("div",{className:"mb-4 p-2 bg-muted/50 rounded text-xs text-muted-foreground",children:" Interactive Form - Fill out and submit to add data to prompt input"}),B]})]})}),r&&f.jsx("div",{className:"folded-content-preview p-4 cursor-pointer w-full box-border",onClick:S,children:f.jsx("pre",{className:"whitespace-pre-wrap break-words text-muted-foreground font-mono text-sm",children:C})})]})},Yut=E.memo(Kut);class Zut{constructor(){de(this,"id","core-block-renderer-formedible");de(this,"unregisterCallback")}async initialize(){}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}const n={id:this.id,supportedLanguages:["formedible"],priority:10,renderer:r=>Ve.createElement(Yut,{code:r.code,isStreaming:r.isStreaming})};this.unregisterCallback=t.registerBlockRenderer(n)}destroy(){this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=void 0)}}const Xut=[oVe,vHe,EHe,RKe,eYe,iYe,lYe,$$e,q9e,z9e,Mqe,Iqe,iVe,$qe,Uqe,Vqe,cVe,gze,pUe,rVe,Oqe,ZUe,fze,Fqe,dVe,lHe,mHe,NUe,IUe,BUe,WUe,HUe,XYe,Gut,Zut,uYe,DYe,LYe,fYe,pYe,gYe,bYe,_Ye,xYe,$Ye,UYe,WYe,OYe,YYe];function Jut(){return f.jsxs(D$e,{children:[f.jsx(O$e,{}),f.jsx(j$e,{}),f.jsx("div",{className:"h-screen bg-background text-foreground flex flex-col",children:f.jsx("main",{className:"flex-grow overflow-hidden",children:f.jsx(T$e,{controls:Xut})})})]})}g0e();xhe.createRoot(document.getElementById("root")).render(f.jsx(Ve.StrictMode,{children:f.jsx(Jut,{})}));export{Cnt as $,zx as A,NZe as B,_Xe as C,YF as D,Po as E,Vie as F,xit as G,Iot as H,OW as I,NJe as J,LZe as K,Iy as L,jdt as M,mA as N,pF as O,kV as P,Ant as Q,J2 as R,vit as S,u_ as T,uXe as U,c_ as V,Sn as W,zn as X,eae as Y,dit as Z,ie as _,gXe as a,tZe as a$,PF as a0,Bdt as a1,Udt as a2,c0 as a3,JV as a4,XV as a5,Vdt as a6,qdt as a7,zdt as a8,Fdt as a9,oit as aA,Qrt as aB,eit as aC,$F as aD,UW as aE,dat as aF,knt as aG,ua as aH,sA as aI,eQe as aJ,QJe as aK,rg as aL,lit as aM,Vle as aN,uA as aO,pA as aP,tE as aQ,Hle as aR,qle as aS,Lst as aT,No as aU,Xet as aV,NF as aW,Xoe as aX,h_ as aY,ele as aZ,Ddt as a_,Ldt as aa,Hdt as ab,$dt as ac,Wdt as ad,Lat as ae,Kue as af,Xdt as ag,IJe as ah,Gi as ai,hp as aj,TF as ak,_ce as al,ag as am,Jle as an,ur as ao,Lu as ap,x0 as aq,Rot as ar,Zdt as as,Jdt as at,Kdt as au,In as av,Ydt as aw,dot as ax,oot as ay,aot as az,mXe as b,MF as b0,lh as b1,WV as b2,stt as b3,l1 as b4,ait as b5,Qst as b6,$rt as b7,zF as b8,Ost as b9,Mi as bA,Zr as bB,uit as ba,m_ as bb,Sb as bc,Jk as bd,Wst as be,Qot as bf,p_ as bg,eE as bh,Bst as bi,Fle as bj,qrt as bk,Vrt as bl,Yp as bm,hW as bn,Wrt as bo,UF as bp,Urt as bq,Krt as br,Cb as bs,fp as bt,lW as bu,qF as bv,Ble as bw,OO as bx,cit as by,hA as bz,ls as c,Kr as d,Qie as e,Ca as f,bXe as g,tf as h,Pm as i,sQe as j,_b as k,zt as l,ece as m,Odt as n,eft as o,vXe as p,xXe as q,Qdt as r,yXe as s,MJe as t,vu as u,rot as v,Sit as w,Gdt as x,pXe as y,Pdt as z};
