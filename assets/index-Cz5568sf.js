const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/dagre-OKDRZEBW-CBBoKnMw.js","assets/graph-DWLZOY7e.js","assets/_baseUniq-BtrEp2zv.js","assets/layout-CyTiiNh6.js","assets/_basePickBy-DPCznsSc.js","assets/clone-Ct8_ADj8.js","assets/c4Diagram-VJAJSXHY-BW9LcBI6.js","assets/chunk-D6G4REZN-BJGBXS9f.js","assets/flowDiagram-4HSFHLVR-BEU4pOJ5.js","assets/chunk-RZ5BOZE2-xjqrHDl5.js","assets/channel-CGCgkxHR.js","assets/erDiagram-Q7BY3M3F-C7BmkNxh.js","assets/gitGraphDiagram-7IBYFJ6S-I9vGv3ZN.js","assets/chunk-4BMEZGHF-BTMsGsvA.js","assets/chunk-XZIHB7SX-EtzkxLbI.js","assets/radar-MK3ICKWK-BaQE2z6j.js","assets/ganttDiagram-APWFNJXF-CSECoJ7y.js","assets/linear-Bsh7oZEt.js","assets/init-Gi6I4Gst.js","assets/infoDiagram-PH2N3AL5-FbNNtBDj.js","assets/pieDiagram-IB7DONF6-DcRBIKhM.js","assets/arc-Cb5B-jwV.js","assets/ordinal-Cboi1Yqb.js","assets/quadrantDiagram-7GDLP6J5-BwVdjH6H.js","assets/xychartDiagram-VJFVF3MP-w9swyRw2.js","assets/requirementDiagram-KVF5MWMF-gL4siWGK.js","assets/sequenceDiagram-X6HHIX6F-qQVa0kQ5.js","assets/classDiagram-GIVACNV2-DntLRIBO.js","assets/chunk-A2AXSNBT-CSW63ODB.js","assets/classDiagram-v2-COTLJTTW-DntLRIBO.js","assets/stateDiagram-DGXRK772-CXTZSSzY.js","assets/chunk-AEK57VVT-pDF6YJW1.js","assets/stateDiagram-v2-YXO3MK2T-CDfRCE0L.js","assets/journeyDiagram-U35MCT3I-Cqkeyu5_.js","assets/timeline-definition-BDJGKUSR-DsCIzaY8.js","assets/mindmap-definition-ALO5MXBD-lQ8UUZk1.js","assets/cytoscape.esm-POAh7USk.js","assets/sankeyDiagram-QLVOVGJD-aOaimDEW.js","assets/diagram-VNBRO52H-Cj43Pxrz.js","assets/diagram-SSKATNLV-BfgSKhnp.js","assets/blockDiagram-JOT3LUYC-D6qkrzE8.js","assets/architectureDiagram-IEHRJDOE-DnhRXVCc.js"])))=>i.map(i=>d[i]);
var Rhe=Object.defineProperty;var Nhe=(e,t,n)=>t in e?Rhe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var ce=(e,t,n)=>Nhe(e,typeof t!="symbol"?t+"":t,n);function Ihe(e,t){for(var n=0;n<t.length;n++){const r=t[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in e)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(e,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var cm=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ga(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var xN={exports:{}},$v={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var CB;function Mhe(){if(CB)return $v;CB=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function n(r,s,i){var a=null;if(i!==void 0&&(a=""+i),s.key!==void 0&&(a=""+s.key),"key"in s){i={};for(var o in s)o!=="key"&&(i[o]=s[o])}else i=s;return s=i.ref,{$$typeof:e,type:r,key:a,ref:s!==void 0?s:null,props:i}}return $v.Fragment=t,$v.jsx=n,$v.jsxs=n,$v}var kB;function jhe(){return kB||(kB=1,xN.exports=Mhe()),xN.exports}var f=jhe(),wN={exports:{}};function Phe(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var mH={exports:{}},ki=mH.exports={},wu,Su;function n3(){throw new Error("setTimeout has not been defined")}function r3(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?wu=setTimeout:wu=n3}catch{wu=n3}try{typeof clearTimeout=="function"?Su=clearTimeout:Su=r3}catch{Su=r3}})();function gH(e){if(wu===setTimeout)return setTimeout(e,0);if((wu===n3||!wu)&&setTimeout)return wu=setTimeout,setTimeout(e,0);try{return wu(e,0)}catch{try{return wu.call(null,e,0)}catch{return wu.call(this,e,0)}}}function Ohe(e){if(Su===clearTimeout)return clearTimeout(e);if((Su===r3||!Su)&&clearTimeout)return Su=clearTimeout,clearTimeout(e);try{return Su(e)}catch{try{return Su.call(null,e)}catch{return Su.call(this,e)}}}var Ud=[],U0=!1,um,zC=-1;function Dhe(){!U0||!um||(U0=!1,um.length?Ud=um.concat(Ud):zC=-1,Ud.length&&yH())}function yH(){if(!U0){var e=gH(Dhe);U0=!0;for(var t=Ud.length;t;){for(um=Ud,Ud=[];++zC<t;)um&&um[zC].run();zC=-1,t=Ud.length}um=null,U0=!1,Ohe(e)}}ki.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];Ud.push(new bH(e,t)),Ud.length===1&&!U0&&gH(yH)};function bH(e,t){this.fun=e,this.array=t}bH.prototype.run=function(){this.fun.apply(null,this.array)};ki.title="browser";ki.browser=!0;ki.env={};ki.argv=[];ki.version="";ki.versions={};function mf(){}ki.on=mf;ki.addListener=mf;ki.once=mf;ki.off=mf;ki.removeListener=mf;ki.removeAllListeners=mf;ki.emit=mf;ki.prependListener=mf;ki.prependOnceListener=mf;ki.listeners=function(e){return[]};ki.binding=function(e){throw new Error("process.binding is not supported")};ki.cwd=function(){return"/"};ki.chdir=function(e){throw new Error("process.chdir is not supported")};ki.umask=function(){return 0};var Fhe=mH.exports;const Di=Phe(Fhe);var Ar={},EB;function Lhe(){if(EB)return Ar;EB=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),i=Symbol.for("react.consumer"),a=Symbol.for("react.context"),o=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),c=Symbol.for("react.memo"),u=Symbol.for("react.lazy"),d=Symbol.iterator;function h(V){return V===null||typeof V!="object"?null:(V=d&&V[d]||V["@@iterator"],typeof V=="function"?V:null)}var m={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y=Object.assign,b={};function v(V,Q,ee){this.props=V,this.context=Q,this.refs=b,this.updater=ee||m}v.prototype.isReactComponent={},v.prototype.setState=function(V,Q){if(typeof V!="object"&&typeof V!="function"&&V!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,V,Q,"setState")},v.prototype.forceUpdate=function(V){this.updater.enqueueForceUpdate(this,V,"forceUpdate")};function x(){}x.prototype=v.prototype;function w(V,Q,ee){this.props=V,this.context=Q,this.refs=b,this.updater=ee||m}var _=w.prototype=new x;_.constructor=w,y(_,v.prototype),_.isPureReactComponent=!0;var k=Array.isArray,C={H:null,A:null,T:null,S:null,V:null},T=Object.prototype.hasOwnProperty;function A(V,Q,ee,re,de,me){return ee=me.ref,{$$typeof:e,type:V,key:Q,ref:ee!==void 0?ee:null,props:me}}function N(V,Q){return A(V.type,Q,void 0,void 0,void 0,V.props)}function I(V){return typeof V=="object"&&V!==null&&V.$$typeof===e}function j(V){var Q={"=":"=0",":":"=2"};return"$"+V.replace(/[=:]/g,function(ee){return Q[ee]})}var L=/\/+/g;function D(V,Q){return typeof V=="object"&&V!==null&&V.key!=null?j(""+V.key):Q.toString(36)}function H(){}function O(V){switch(V.status){case"fulfilled":return V.value;case"rejected":throw V.reason;default:switch(typeof V.status=="string"?V.then(H,H):(V.status="pending",V.then(function(Q){V.status==="pending"&&(V.status="fulfilled",V.value=Q)},function(Q){V.status==="pending"&&(V.status="rejected",V.reason=Q)})),V.status){case"fulfilled":return V.value;case"rejected":throw V.reason}}throw V}function K(V,Q,ee,re,de){var me=typeof V;(me==="undefined"||me==="boolean")&&(V=null);var De=!1;if(V===null)De=!0;else switch(me){case"bigint":case"string":case"number":De=!0;break;case"object":switch(V.$$typeof){case e:case t:De=!0;break;case u:return De=V._init,K(De(V._payload),Q,ee,re,de)}}if(De)return de=de(V),De=re===""?"."+D(V,0):re,k(de)?(ee="",De!=null&&(ee=De.replace(L,"$&/")+"/"),K(de,Q,ee,"",function(_e){return _e})):de!=null&&(I(de)&&(de=N(de,ee+(de.key==null||V&&V.key===de.key?"":(""+de.key).replace(L,"$&/")+"/")+De)),Q.push(de)),1;De=0;var je=re===""?".":re+":";if(k(V))for(var Te=0;Te<V.length;Te++)re=V[Te],me=je+D(re,Te),De+=K(re,Q,ee,me,de);else if(Te=h(V),typeof Te=="function")for(V=Te.call(V),Te=0;!(re=V.next()).done;)re=re.value,me=je+D(re,Te++),De+=K(re,Q,ee,me,de);else if(me==="object"){if(typeof V.then=="function")return K(O(V),Q,ee,re,de);throw Q=String(V),Error("Objects are not valid as a React child (found: "+(Q==="[object Object]"?"object with keys {"+Object.keys(V).join(", ")+"}":Q)+"). If you meant to render a collection of children, use an array instead.")}return De}function U(V,Q,ee){if(V==null)return V;var re=[],de=0;return K(V,re,"","",function(me){return Q.call(ee,me,de++)}),re}function W(V){if(V._status===-1){var Q=V._result;Q=Q(),Q.then(function(ee){(V._status===0||V._status===-1)&&(V._status=1,V._result=ee)},function(ee){(V._status===0||V._status===-1)&&(V._status=2,V._result=ee)}),V._status===-1&&(V._status=0,V._result=Q)}if(V._status===1)return V._result.default;throw V._result}var B=typeof reportError=="function"?reportError:function(V){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var Q=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof V=="object"&&V!==null&&typeof V.message=="string"?String(V.message):String(V),error:V});if(!window.dispatchEvent(Q))return}else if(typeof Di=="object"&&typeof Di.emit=="function"){Di.emit("uncaughtException",V);return}console.error(V)};function ne(){}return Ar.Children={map:U,forEach:function(V,Q,ee){U(V,function(){Q.apply(this,arguments)},ee)},count:function(V){var Q=0;return U(V,function(){Q++}),Q},toArray:function(V){return U(V,function(Q){return Q})||[]},only:function(V){if(!I(V))throw Error("React.Children.only expected to receive a single React element child.");return V}},Ar.Component=v,Ar.Fragment=n,Ar.Profiler=s,Ar.PureComponent=w,Ar.StrictMode=r,Ar.Suspense=l,Ar.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=C,Ar.__COMPILER_RUNTIME={__proto__:null,c:function(V){return C.H.useMemoCache(V)}},Ar.cache=function(V){return function(){return V.apply(null,arguments)}},Ar.cloneElement=function(V,Q,ee){if(V==null)throw Error("The argument must be a React element, but you passed "+V+".");var re=y({},V.props),de=V.key,me=void 0;if(Q!=null)for(De in Q.ref!==void 0&&(me=void 0),Q.key!==void 0&&(de=""+Q.key),Q)!T.call(Q,De)||De==="key"||De==="__self"||De==="__source"||De==="ref"&&Q.ref===void 0||(re[De]=Q[De]);var De=arguments.length-2;if(De===1)re.children=ee;else if(1<De){for(var je=Array(De),Te=0;Te<De;Te++)je[Te]=arguments[Te+2];re.children=je}return A(V.type,de,void 0,void 0,me,re)},Ar.createContext=function(V){return V={$$typeof:a,_currentValue:V,_currentValue2:V,_threadCount:0,Provider:null,Consumer:null},V.Provider=V,V.Consumer={$$typeof:i,_context:V},V},Ar.createElement=function(V,Q,ee){var re,de={},me=null;if(Q!=null)for(re in Q.key!==void 0&&(me=""+Q.key),Q)T.call(Q,re)&&re!=="key"&&re!=="__self"&&re!=="__source"&&(de[re]=Q[re]);var De=arguments.length-2;if(De===1)de.children=ee;else if(1<De){for(var je=Array(De),Te=0;Te<De;Te++)je[Te]=arguments[Te+2];de.children=je}if(V&&V.defaultProps)for(re in De=V.defaultProps,De)de[re]===void 0&&(de[re]=De[re]);return A(V,me,void 0,void 0,null,de)},Ar.createRef=function(){return{current:null}},Ar.forwardRef=function(V){return{$$typeof:o,render:V}},Ar.isValidElement=I,Ar.lazy=function(V){return{$$typeof:u,_payload:{_status:-1,_result:V},_init:W}},Ar.memo=function(V,Q){return{$$typeof:c,type:V,compare:Q===void 0?null:Q}},Ar.startTransition=function(V){var Q=C.T,ee={};C.T=ee;try{var re=V(),de=C.S;de!==null&&de(ee,re),typeof re=="object"&&re!==null&&typeof re.then=="function"&&re.then(ne,B)}catch(me){B(me)}finally{C.T=Q}},Ar.unstable_useCacheRefresh=function(){return C.H.useCacheRefresh()},Ar.use=function(V){return C.H.use(V)},Ar.useActionState=function(V,Q,ee){return C.H.useActionState(V,Q,ee)},Ar.useCallback=function(V,Q){return C.H.useCallback(V,Q)},Ar.useContext=function(V){return C.H.useContext(V)},Ar.useDebugValue=function(){},Ar.useDeferredValue=function(V,Q){return C.H.useDeferredValue(V,Q)},Ar.useEffect=function(V,Q,ee){var re=C.H;if(typeof ee=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return re.useEffect(V,Q)},Ar.useId=function(){return C.H.useId()},Ar.useImperativeHandle=function(V,Q,ee){return C.H.useImperativeHandle(V,Q,ee)},Ar.useInsertionEffect=function(V,Q){return C.H.useInsertionEffect(V,Q)},Ar.useLayoutEffect=function(V,Q){return C.H.useLayoutEffect(V,Q)},Ar.useMemo=function(V,Q){return C.H.useMemo(V,Q)},Ar.useOptimistic=function(V,Q){return C.H.useOptimistic(V,Q)},Ar.useReducer=function(V,Q,ee){return C.H.useReducer(V,Q,ee)},Ar.useRef=function(V){return C.H.useRef(V)},Ar.useState=function(V){return C.H.useState(V)},Ar.useSyncExternalStore=function(V,Q,ee){return C.H.useSyncExternalStore(V,Q,ee)},Ar.useTransition=function(){return C.H.useTransition()},Ar.version="19.1.0",Ar}var TB;function Zy(){return TB||(TB=1,wN.exports=Lhe()),wN.exports}var E=Zy();const Ve=ga(E),vH=Ihe({__proto__:null,default:Ve},[E]);var SN={exports:{}},zv={},_N={exports:{}},CN={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var AB;function Bhe(){return AB||(AB=1,function(e){function t(U,W){var B=U.length;U.push(W);e:for(;0<B;){var ne=B-1>>>1,V=U[ne];if(0<s(V,W))U[ne]=W,U[B]=V,B=ne;else break e}}function n(U){return U.length===0?null:U[0]}function r(U){if(U.length===0)return null;var W=U[0],B=U.pop();if(B!==W){U[0]=B;e:for(var ne=0,V=U.length,Q=V>>>1;ne<Q;){var ee=2*(ne+1)-1,re=U[ee],de=ee+1,me=U[de];if(0>s(re,B))de<V&&0>s(me,re)?(U[ne]=me,U[de]=B,ne=de):(U[ne]=re,U[ee]=B,ne=ee);else if(de<V&&0>s(me,B))U[ne]=me,U[de]=B,ne=de;else break e}}return W}function s(U,W){var B=U.sortIndex-W.sortIndex;return B!==0?B:U.id-W.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var a=Date,o=a.now();e.unstable_now=function(){return a.now()-o}}var l=[],c=[],u=1,d=null,h=3,m=!1,y=!1,b=!1,v=!1,x=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;function k(U){for(var W=n(c);W!==null;){if(W.callback===null)r(c);else if(W.startTime<=U)r(c),W.sortIndex=W.expirationTime,t(l,W);else break;W=n(c)}}function C(U){if(b=!1,k(U),!y)if(n(l)!==null)y=!0,T||(T=!0,D());else{var W=n(c);W!==null&&K(C,W.startTime-U)}}var T=!1,A=-1,N=5,I=-1;function j(){return v?!0:!(e.unstable_now()-I<N)}function L(){if(v=!1,T){var U=e.unstable_now();I=U;var W=!0;try{e:{y=!1,b&&(b=!1,w(A),A=-1),m=!0;var B=h;try{t:{for(k(U),d=n(l);d!==null&&!(d.expirationTime>U&&j());){var ne=d.callback;if(typeof ne=="function"){d.callback=null,h=d.priorityLevel;var V=ne(d.expirationTime<=U);if(U=e.unstable_now(),typeof V=="function"){d.callback=V,k(U),W=!0;break t}d===n(l)&&r(l),k(U)}else r(l);d=n(l)}if(d!==null)W=!0;else{var Q=n(c);Q!==null&&K(C,Q.startTime-U),W=!1}}break e}finally{d=null,h=B,m=!1}W=void 0}}finally{W?D():T=!1}}}var D;if(typeof _=="function")D=function(){_(L)};else if(typeof MessageChannel<"u"){var H=new MessageChannel,O=H.port2;H.port1.onmessage=L,D=function(){O.postMessage(null)}}else D=function(){x(L,0)};function K(U,W){A=x(function(){U(e.unstable_now())},W)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(U){U.callback=null},e.unstable_forceFrameRate=function(U){0>U||125<U?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):N=0<U?Math.floor(1e3/U):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_next=function(U){switch(h){case 1:case 2:case 3:var W=3;break;default:W=h}var B=h;h=W;try{return U()}finally{h=B}},e.unstable_requestPaint=function(){v=!0},e.unstable_runWithPriority=function(U,W){switch(U){case 1:case 2:case 3:case 4:case 5:break;default:U=3}var B=h;h=U;try{return W()}finally{h=B}},e.unstable_scheduleCallback=function(U,W,B){var ne=e.unstable_now();switch(typeof B=="object"&&B!==null?(B=B.delay,B=typeof B=="number"&&0<B?ne+B:ne):B=ne,U){case 1:var V=-1;break;case 2:V=250;break;case 5:V=1073741823;break;case 4:V=1e4;break;default:V=5e3}return V=B+V,U={id:u++,callback:W,priorityLevel:U,startTime:B,expirationTime:V,sortIndex:-1},B>ne?(U.sortIndex=B,t(c,U),n(l)===null&&U===n(c)&&(b?(w(A),A=-1):b=!0,K(C,B-ne))):(U.sortIndex=V,t(l,U),y||m||(y=!0,T||(T=!0,D()))),U},e.unstable_shouldYield=j,e.unstable_wrapCallback=function(U){var W=h;return function(){var B=h;h=W;try{return U.apply(this,arguments)}finally{h=B}}}}(CN)),CN}var RB;function $he(){return RB||(RB=1,_N.exports=Bhe()),_N.exports}var kN={exports:{}},Oa={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var NB;function zhe(){if(NB)return Oa;NB=1;var e=Zy();function t(l){var c="https://react.dev/errors/"+l;if(1<arguments.length){c+="?args[]="+encodeURIComponent(arguments[1]);for(var u=2;u<arguments.length;u++)c+="&args[]="+encodeURIComponent(arguments[u])}return"Minified React error #"+l+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var r={d:{f:n,r:function(){throw Error(t(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},s=Symbol.for("react.portal");function i(l,c,u){var d=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:d==null?null:""+d,children:l,containerInfo:c,implementation:u}}var a=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function o(l,c){if(l==="font")return"";if(typeof c=="string")return c==="use-credentials"?c:""}return Oa.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,Oa.createPortal=function(l,c){var u=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!c||c.nodeType!==1&&c.nodeType!==9&&c.nodeType!==11)throw Error(t(299));return i(l,c,null,u)},Oa.flushSync=function(l){var c=a.T,u=r.p;try{if(a.T=null,r.p=2,l)return l()}finally{a.T=c,r.p=u,r.d.f()}},Oa.preconnect=function(l,c){typeof l=="string"&&(c?(c=c.crossOrigin,c=typeof c=="string"?c==="use-credentials"?c:"":void 0):c=null,r.d.C(l,c))},Oa.prefetchDNS=function(l){typeof l=="string"&&r.d.D(l)},Oa.preinit=function(l,c){if(typeof l=="string"&&c&&typeof c.as=="string"){var u=c.as,d=o(u,c.crossOrigin),h=typeof c.integrity=="string"?c.integrity:void 0,m=typeof c.fetchPriority=="string"?c.fetchPriority:void 0;u==="style"?r.d.S(l,typeof c.precedence=="string"?c.precedence:void 0,{crossOrigin:d,integrity:h,fetchPriority:m}):u==="script"&&r.d.X(l,{crossOrigin:d,integrity:h,fetchPriority:m,nonce:typeof c.nonce=="string"?c.nonce:void 0})}},Oa.preinitModule=function(l,c){if(typeof l=="string")if(typeof c=="object"&&c!==null){if(c.as==null||c.as==="script"){var u=o(c.as,c.crossOrigin);r.d.M(l,{crossOrigin:u,integrity:typeof c.integrity=="string"?c.integrity:void 0,nonce:typeof c.nonce=="string"?c.nonce:void 0})}}else c==null&&r.d.M(l)},Oa.preload=function(l,c){if(typeof l=="string"&&typeof c=="object"&&c!==null&&typeof c.as=="string"){var u=c.as,d=o(u,c.crossOrigin);r.d.L(l,u,{crossOrigin:d,integrity:typeof c.integrity=="string"?c.integrity:void 0,nonce:typeof c.nonce=="string"?c.nonce:void 0,type:typeof c.type=="string"?c.type:void 0,fetchPriority:typeof c.fetchPriority=="string"?c.fetchPriority:void 0,referrerPolicy:typeof c.referrerPolicy=="string"?c.referrerPolicy:void 0,imageSrcSet:typeof c.imageSrcSet=="string"?c.imageSrcSet:void 0,imageSizes:typeof c.imageSizes=="string"?c.imageSizes:void 0,media:typeof c.media=="string"?c.media:void 0})}},Oa.preloadModule=function(l,c){if(typeof l=="string")if(c){var u=o(c.as,c.crossOrigin);r.d.m(l,{as:typeof c.as=="string"&&c.as!=="script"?c.as:void 0,crossOrigin:u,integrity:typeof c.integrity=="string"?c.integrity:void 0})}else r.d.m(l)},Oa.requestFormReset=function(l){r.d.r(l)},Oa.unstable_batchedUpdates=function(l,c){return l(c)},Oa.useFormState=function(l,c,u){return a.H.useFormState(l,c,u)},Oa.useFormStatus=function(){return a.H.useHostTransitionStatus()},Oa.version="19.1.0",Oa}var IB;function xH(){if(IB)return kN.exports;IB=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),kN.exports=zhe(),kN.exports}var MB;function Uhe(){if(MB)return zv;MB=1;var e=$he(),t=Zy(),n=xH();function r(p){var g="https://react.dev/errors/"+p;if(1<arguments.length){g+="?args[]="+encodeURIComponent(arguments[1]);for(var S=2;S<arguments.length;S++)g+="&args[]="+encodeURIComponent(arguments[S])}return"Minified React error #"+p+"; visit "+g+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(p){return!(!p||p.nodeType!==1&&p.nodeType!==9&&p.nodeType!==11)}function i(p){var g=p,S=p;if(p.alternate)for(;g.return;)g=g.return;else{p=g;do g=p,(g.flags&4098)!==0&&(S=g.return),p=g.return;while(p)}return g.tag===3?S:null}function a(p){if(p.tag===13){var g=p.memoizedState;if(g===null&&(p=p.alternate,p!==null&&(g=p.memoizedState)),g!==null)return g.dehydrated}return null}function o(p){if(i(p)!==p)throw Error(r(188))}function l(p){var g=p.alternate;if(!g){if(g=i(p),g===null)throw Error(r(188));return g!==p?null:p}for(var S=p,R=g;;){var P=S.return;if(P===null)break;var q=P.alternate;if(q===null){if(R=P.return,R!==null){S=R;continue}break}if(P.child===q.child){for(q=P.child;q;){if(q===S)return o(P),p;if(q===R)return o(P),g;q=q.sibling}throw Error(r(188))}if(S.return!==R.return)S=P,R=q;else{for(var he=!1,Oe=P.child;Oe;){if(Oe===S){he=!0,S=P,R=q;break}if(Oe===R){he=!0,R=P,S=q;break}Oe=Oe.sibling}if(!he){for(Oe=q.child;Oe;){if(Oe===S){he=!0,S=q,R=P;break}if(Oe===R){he=!0,R=q,S=P;break}Oe=Oe.sibling}if(!he)throw Error(r(189))}}if(S.alternate!==R)throw Error(r(190))}if(S.tag!==3)throw Error(r(188));return S.stateNode.current===S?p:g}function c(p){var g=p.tag;if(g===5||g===26||g===27||g===6)return p;for(p=p.child;p!==null;){if(g=c(p),g!==null)return g;p=p.sibling}return null}var u=Object.assign,d=Symbol.for("react.element"),h=Symbol.for("react.transitional.element"),m=Symbol.for("react.portal"),y=Symbol.for("react.fragment"),b=Symbol.for("react.strict_mode"),v=Symbol.for("react.profiler"),x=Symbol.for("react.provider"),w=Symbol.for("react.consumer"),_=Symbol.for("react.context"),k=Symbol.for("react.forward_ref"),C=Symbol.for("react.suspense"),T=Symbol.for("react.suspense_list"),A=Symbol.for("react.memo"),N=Symbol.for("react.lazy"),I=Symbol.for("react.activity"),j=Symbol.for("react.memo_cache_sentinel"),L=Symbol.iterator;function D(p){return p===null||typeof p!="object"?null:(p=L&&p[L]||p["@@iterator"],typeof p=="function"?p:null)}var H=Symbol.for("react.client.reference");function O(p){if(p==null)return null;if(typeof p=="function")return p.$$typeof===H?null:p.displayName||p.name||null;if(typeof p=="string")return p;switch(p){case y:return"Fragment";case v:return"Profiler";case b:return"StrictMode";case C:return"Suspense";case T:return"SuspenseList";case I:return"Activity"}if(typeof p=="object")switch(p.$$typeof){case m:return"Portal";case _:return(p.displayName||"Context")+".Provider";case w:return(p._context.displayName||"Context")+".Consumer";case k:var g=p.render;return p=p.displayName,p||(p=g.displayName||g.name||"",p=p!==""?"ForwardRef("+p+")":"ForwardRef"),p;case A:return g=p.displayName||null,g!==null?g:O(p.type)||"Memo";case N:g=p._payload,p=p._init;try{return O(p(g))}catch{}}return null}var K=Array.isArray,U=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,W=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,B={pending:!1,data:null,method:null,action:null},ne=[],V=-1;function Q(p){return{current:p}}function ee(p){0>V||(p.current=ne[V],ne[V]=null,V--)}function re(p,g){V++,ne[V]=p.current,p.current=g}var de=Q(null),me=Q(null),De=Q(null),je=Q(null);function Te(p,g){switch(re(De,g),re(me,p),re(de,null),g.nodeType){case 9:case 11:p=(p=g.documentElement)&&(p=p.namespaceURI)?JL(p):0;break;default:if(p=g.tagName,g=g.namespaceURI)g=JL(g),p=QL(g,p);else switch(p){case"svg":p=1;break;case"math":p=2;break;default:p=0}}ee(de),re(de,p)}function _e(){ee(de),ee(me),ee(De)}function Ue(p){p.memoizedState!==null&&re(je,p);var g=de.current,S=QL(g,p.type);g!==S&&(re(me,p),re(de,S))}function Qe(p){me.current===p&&(ee(de),ee(me)),je.current===p&&(ee(je),Ov._currentValue=B)}var We=Object.prototype.hasOwnProperty,Pe=e.unstable_scheduleCallback,Y=e.unstable_cancelCallback,ye=e.unstable_shouldYield,Me=e.unstable_requestPaint,ue=e.unstable_now,oe=e.unstable_getCurrentPriorityLevel,se=e.unstable_ImmediatePriority,Ie=e.unstable_UserBlockingPriority,Be=e.unstable_NormalPriority,Re=e.unstable_LowPriority,ct=e.unstable_IdlePriority,At=e.log,ut=e.unstable_setDisableYieldValue,Pt=null,Ut=null;function Ft(p){if(typeof At=="function"&&ut(p),Ut&&typeof Ut.setStrictMode=="function")try{Ut.setStrictMode(Pt,p)}catch{}}var Yt=Math.clz32?Math.clz32:X,we=Math.log,F=Math.LN2;function X(p){return p>>>=0,p===0?32:31-(we(p)/F|0)|0}var be=256,Ee=4194304;function ge(p){var g=p&42;if(g!==0)return g;switch(p&-p){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return p&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return p&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return p}}function Ae(p,g,S){var R=p.pendingLanes;if(R===0)return 0;var P=0,q=p.suspendedLanes,he=p.pingedLanes;p=p.warmLanes;var Oe=R&134217727;return Oe!==0?(R=Oe&~q,R!==0?P=ge(R):(he&=Oe,he!==0?P=ge(he):S||(S=Oe&~p,S!==0&&(P=ge(S))))):(Oe=R&~q,Oe!==0?P=ge(Oe):he!==0?P=ge(he):S||(S=R&~p,S!==0&&(P=ge(S)))),P===0?0:g!==0&&g!==P&&(g&q)===0&&(q=P&-P,S=g&-g,q>=S||q===32&&(S&4194048)!==0)?g:P}function le(p,g){return(p.pendingLanes&~(p.suspendedLanes&~p.pingedLanes)&g)===0}function ft(p,g){switch(p){case 1:case 2:case 4:case 8:case 64:return g+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return g+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function et(){var p=be;return be<<=1,(be&4194048)===0&&(be=256),p}function $(){var p=Ee;return Ee<<=1,(Ee&62914560)===0&&(Ee=4194304),p}function qe(p){for(var g=[],S=0;31>S;S++)g.push(p);return g}function tt(p,g){p.pendingLanes|=g,g!==268435456&&(p.suspendedLanes=0,p.pingedLanes=0,p.warmLanes=0)}function ve(p,g,S,R,P,q){var he=p.pendingLanes;p.pendingLanes=S,p.suspendedLanes=0,p.pingedLanes=0,p.warmLanes=0,p.expiredLanes&=S,p.entangledLanes&=S,p.errorRecoveryDisabledLanes&=S,p.shellSuspendCounter=0;var Oe=p.entanglements,Ze=p.expirationTimes,_t=p.hiddenUpdates;for(S=he&~S;0<S;){var Dt=31-Yt(S),$t=1<<Dt;Oe[Dt]=0,Ze[Dt]=-1;var Et=_t[Dt];if(Et!==null)for(_t[Dt]=null,Dt=0;Dt<Et.length;Dt++){var Rt=Et[Dt];Rt!==null&&(Rt.lane&=-536870913)}S&=~$t}R!==0&&Se(p,R,0),q!==0&&P===0&&p.tag!==0&&(p.suspendedLanes|=q&~(he&~g))}function Se(p,g,S){p.pendingLanes|=g,p.suspendedLanes&=~g;var R=31-Yt(g);p.entangledLanes|=g,p.entanglements[R]=p.entanglements[R]|1073741824|S&4194090}function ze(p,g){var S=p.entangledLanes|=g;for(p=p.entanglements;S;){var R=31-Yt(S),P=1<<R;P&g|p[R]&g&&(p[R]|=g),S&=~P}}function Ct(p){switch(p){case 2:p=1;break;case 8:p=4;break;case 32:p=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:p=128;break;case 268435456:p=134217728;break;default:p=0}return p}function fe(p){return p&=-p,2<p?8<p?(p&134217727)!==0?32:268435456:8:2}function Z(){var p=W.p;return p!==0?p:(p=window.event,p===void 0?32:bB(p.type))}function G(p,g){var S=W.p;try{return W.p=p,g()}finally{W.p=S}}var J=Math.random().toString(36).slice(2),xe="__reactFiber$"+J,Fe="__reactProps$"+J,He="__reactContainer$"+J,wt="__reactEvents$"+J,Qt="__reactListeners$"+J,Dn="__reactHandles$"+J,Zt="__reactResources$"+J,rn="__reactMarker$"+J;function fn(p){delete p[xe],delete p[Fe],delete p[wt],delete p[Qt],delete p[Dn]}function br(p){var g=p[xe];if(g)return g;for(var S=p.parentNode;S;){if(g=S[He]||S[xe]){if(S=g.alternate,g.child!==null||S!==null&&S.child!==null)for(p=rB(p);p!==null;){if(S=p[xe])return S;p=rB(p)}return g}p=S,S=p.parentNode}return null}function Mr(p){if(p=p[xe]||p[He]){var g=p.tag;if(g===5||g===6||g===13||g===26||g===27||g===3)return p}return null}function rs(p){var g=p.tag;if(g===5||g===26||g===27||g===6)return p.stateNode;throw Error(r(33))}function ss(p){var g=p[Zt];return g||(g=p[Zt]={hoistableStyles:new Map,hoistableScripts:new Map}),g}function kr(p){p[rn]=!0}var gn=new Set,nt={};function Vt(p,g){yn(p,g),yn(p+"Capture",g)}function yn(p,g){for(nt[p]=g,p=0;p<g.length;p++)gn.add(g[p])}var ar=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Ns={},ts={};function zi(p){return We.call(ts,p)?!0:We.call(Ns,p)?!1:ar.test(p)?ts[p]=!0:(Ns[p]=!0,!1)}function fi(p,g,S){if(zi(g))if(S===null)p.removeAttribute(g);else{switch(typeof S){case"undefined":case"function":case"symbol":p.removeAttribute(g);return;case"boolean":var R=g.toLowerCase().slice(0,5);if(R!=="data-"&&R!=="aria-"){p.removeAttribute(g);return}}p.setAttribute(g,""+S)}}function Xa(p,g,S){if(S===null)p.removeAttribute(g);else{switch(typeof S){case"undefined":case"function":case"symbol":case"boolean":p.removeAttribute(g);return}p.setAttribute(g,""+S)}}function ba(p,g,S,R){if(R===null)p.removeAttribute(S);else{switch(typeof R){case"undefined":case"function":case"symbol":case"boolean":p.removeAttribute(S);return}p.setAttributeNS(g,S,""+R)}}var Gs,el;function Al(p){if(Gs===void 0)try{throw Error()}catch(S){var g=S.stack.trim().match(/\n( *(at )?)/);Gs=g&&g[1]||"",el=-1<S.stack.indexOf(`
    at`)?" (<anonymous>)":-1<S.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Gs+p+el}var Tf=!1;function vg(p,g){if(!p||Tf)return"";Tf=!0;var S=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var R={DetermineComponentFrameRoot:function(){try{if(g){var $t=function(){throw Error()};if(Object.defineProperty($t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct($t,[])}catch(Rt){var Et=Rt}Reflect.construct(p,[],$t)}else{try{$t.call()}catch(Rt){Et=Rt}p.call($t.prototype)}}else{try{throw Error()}catch(Rt){Et=Rt}($t=p())&&typeof $t.catch=="function"&&$t.catch(function(){})}}catch(Rt){if(Rt&&Et&&typeof Rt.stack=="string")return[Rt.stack,Et.stack]}return[null,null]}};R.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var P=Object.getOwnPropertyDescriptor(R.DetermineComponentFrameRoot,"name");P&&P.configurable&&Object.defineProperty(R.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var q=R.DetermineComponentFrameRoot(),he=q[0],Oe=q[1];if(he&&Oe){var Ze=he.split(`
`),_t=Oe.split(`
`);for(P=R=0;R<Ze.length&&!Ze[R].includes("DetermineComponentFrameRoot");)R++;for(;P<_t.length&&!_t[P].includes("DetermineComponentFrameRoot");)P++;if(R===Ze.length||P===_t.length)for(R=Ze.length-1,P=_t.length-1;1<=R&&0<=P&&Ze[R]!==_t[P];)P--;for(;1<=R&&0<=P;R--,P--)if(Ze[R]!==_t[P]){if(R!==1||P!==1)do if(R--,P--,0>P||Ze[R]!==_t[P]){var Dt=`
`+Ze[R].replace(" at new "," at ");return p.displayName&&Dt.includes("<anonymous>")&&(Dt=Dt.replace("<anonymous>",p.displayName)),Dt}while(1<=R&&0<=P);break}}}finally{Tf=!1,Error.prepareStackTrace=S}return(S=p?p.displayName||p.name:"")?Al(S):""}function Lr(p){switch(p.tag){case 26:case 27:case 5:return Al(p.type);case 16:return Al("Lazy");case 13:return Al("Suspense");case 19:return Al("SuspenseList");case 0:case 15:return vg(p.type,!1);case 11:return vg(p.type.render,!1);case 1:return vg(p.type,!0);case 31:return Al("Activity");default:return""}}function Fb(p){try{var g="";do g+=Lr(p),p=p.return;while(p);return g}catch(S){return`
Error generating stack: `+S.message+`
`+S.stack}}function Ja(p){switch(typeof p){case"bigint":case"boolean":case"number":case"string":case"undefined":return p;case"object":return p;default:return""}}function Lb(p){var g=p.type;return(p=p.nodeName)&&p.toLowerCase()==="input"&&(g==="checkbox"||g==="radio")}function Is(p){var g=Lb(p)?"checked":"value",S=Object.getOwnPropertyDescriptor(p.constructor.prototype,g),R=""+p[g];if(!p.hasOwnProperty(g)&&typeof S<"u"&&typeof S.get=="function"&&typeof S.set=="function"){var P=S.get,q=S.set;return Object.defineProperty(p,g,{configurable:!0,get:function(){return P.call(this)},set:function(he){R=""+he,q.call(this,he)}}),Object.defineProperty(p,g,{enumerable:S.enumerable}),{getValue:function(){return R},setValue:function(he){R=""+he},stopTracking:function(){p._valueTracker=null,delete p[g]}}}}function nu(p){p._valueTracker||(p._valueTracker=Is(p))}function Af(p){if(!p)return!1;var g=p._valueTracker;if(!g)return!0;var S=g.getValue(),R="";return p&&(R=Lb(p)?p.checked?"true":"false":p.value),p=R,p!==S?(g.setValue(p),!0):!1}function vc(p){if(p=p||(typeof document<"u"?document:void 0),typeof p>"u")return null;try{return p.activeElement||p.body}catch{return p.body}}var Bb=/[\n"\\]/g;function Ia(p){return p.replace(Bb,function(g){return"\\"+g.charCodeAt(0).toString(16)+" "})}function Rf(p,g,S,R,P,q,he,Oe){p.name="",he!=null&&typeof he!="function"&&typeof he!="symbol"&&typeof he!="boolean"?p.type=he:p.removeAttribute("type"),g!=null?he==="number"?(g===0&&p.value===""||p.value!=g)&&(p.value=""+Ja(g)):p.value!==""+Ja(g)&&(p.value=""+Ja(g)):he!=="submit"&&he!=="reset"||p.removeAttribute("value"),g!=null?Nf(p,he,Ja(g)):S!=null?Nf(p,he,Ja(S)):R!=null&&p.removeAttribute("value"),P==null&&q!=null&&(p.defaultChecked=!!q),P!=null&&(p.checked=P&&typeof P!="function"&&typeof P!="symbol"),Oe!=null&&typeof Oe!="function"&&typeof Oe!="symbol"&&typeof Oe!="boolean"?p.name=""+Ja(Oe):p.removeAttribute("name")}function $b(p,g,S,R,P,q,he,Oe){if(q!=null&&typeof q!="function"&&typeof q!="symbol"&&typeof q!="boolean"&&(p.type=q),g!=null||S!=null){if(!(q!=="submit"&&q!=="reset"||g!=null))return;S=S!=null?""+Ja(S):"",g=g!=null?""+Ja(g):S,Oe||g===p.value||(p.value=g),p.defaultValue=g}R=R??P,R=typeof R!="function"&&typeof R!="symbol"&&!!R,p.checked=Oe?p.checked:!!R,p.defaultChecked=!!R,he!=null&&typeof he!="function"&&typeof he!="symbol"&&typeof he!="boolean"&&(p.name=he)}function Nf(p,g,S){g==="number"&&vc(p.ownerDocument)===p||p.defaultValue===""+S||(p.defaultValue=""+S)}function od(p,g,S,R){if(p=p.options,g){g={};for(var P=0;P<S.length;P++)g["$"+S[P]]=!0;for(S=0;S<p.length;S++)P=g.hasOwnProperty("$"+p[S].value),p[S].selected!==P&&(p[S].selected=P),P&&R&&(p[S].defaultSelected=!0)}else{for(S=""+Ja(S),g=null,P=0;P<p.length;P++){if(p[P].value===S){p[P].selected=!0,R&&(p[P].defaultSelected=!0);return}g!==null||p[P].disabled||(g=p[P])}g!==null&&(g.selected=!0)}}function If(p,g,S){if(g!=null&&(g=""+Ja(g),g!==p.value&&(p.value=g),S==null)){p.defaultValue!==g&&(p.defaultValue=g);return}p.defaultValue=S!=null?""+Ja(S):""}function zb(p,g,S,R){if(g==null){if(R!=null){if(S!=null)throw Error(r(92));if(K(R)){if(1<R.length)throw Error(r(93));R=R[0]}S=R}S==null&&(S=""),g=S}S=Ja(g),p.defaultValue=S,R=p.textContent,R===S&&R!==""&&R!==null&&(p.value=R)}function Mf(p,g){if(g){var S=p.firstChild;if(S&&S===p.lastChild&&S.nodeType===3){S.nodeValue=g;return}}p.textContent=g}var Kr=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function xg(p,g,S){var R=g.indexOf("--")===0;S==null||typeof S=="boolean"||S===""?R?p.setProperty(g,""):g==="float"?p.cssFloat="":p[g]="":R?p.setProperty(g,S):typeof S!="number"||S===0||Kr.has(g)?g==="float"?p.cssFloat=S:p[g]=(""+S).trim():p[g]=S+"px"}function MS(p,g,S){if(g!=null&&typeof g!="object")throw Error(r(62));if(p=p.style,S!=null){for(var R in S)!S.hasOwnProperty(R)||g!=null&&g.hasOwnProperty(R)||(R.indexOf("--")===0?p.setProperty(R,""):R==="float"?p.cssFloat="":p[R]="");for(var P in g)R=g[P],g.hasOwnProperty(P)&&S[P]!==R&&xg(p,P,R)}else for(var q in g)g.hasOwnProperty(q)&&xg(p,q,g[q])}function Ub(p){if(p.indexOf("-")===-1)return!1;switch(p){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Qa=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),jf=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ld(p){return jf.test(""+p)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":p}var Rl=null;function wg(p){return p=p.target||p.srcElement||window,p.correspondingUseElement&&(p=p.correspondingUseElement),p.nodeType===3?p.parentNode:p}var cd=null,Bs=null;function tl(p){var g=Mr(p);if(g&&(p=g.stateNode)){var S=p[Fe]||null;e:switch(p=g.stateNode,g.type){case"input":if(Rf(p,S.value,S.defaultValue,S.defaultValue,S.checked,S.defaultChecked,S.type,S.name),g=S.name,S.type==="radio"&&g!=null){for(S=p;S.parentNode;)S=S.parentNode;for(S=S.querySelectorAll('input[name="'+Ia(""+g)+'"][type="radio"]'),g=0;g<S.length;g++){var R=S[g];if(R!==p&&R.form===p.form){var P=R[Fe]||null;if(!P)throw Error(r(90));Rf(R,P.value,P.defaultValue,P.defaultValue,P.checked,P.defaultChecked,P.type,P.name)}}for(g=0;g<S.length;g++)R=S[g],R.form===p.form&&Af(R)}break e;case"textarea":If(p,S.value,S.defaultValue);break e;case"select":g=S.value,g!=null&&od(p,!!S.multiple,g,!1)}}}var ud=!1;function Pf(p,g,S){if(ud)return p(g,S);ud=!0;try{var R=p(g);return R}finally{if(ud=!1,(cd!==null||Bs!==null)&&(x_(),cd&&(g=cd,p=Bs,Bs=cd=null,tl(g),p)))for(g=0;g<p.length;g++)tl(p[g])}}function dd(p,g){var S=p.stateNode;if(S===null)return null;var R=S[Fe]||null;if(R===null)return null;S=R[g];e:switch(g){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(R=!R.disabled)||(p=p.type,R=!(p==="button"||p==="input"||p==="select"||p==="textarea")),p=!R;break e;default:p=!1}if(p)return null;if(S&&typeof S!="function")throw Error(r(231,g,typeof S));return S}var ta=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),qb=!1;if(ta)try{var Ma={};Object.defineProperty(Ma,"passive",{get:function(){qb=!0}}),window.addEventListener("test",Ma,Ma),window.removeEventListener("test",Ma,Ma)}catch{qb=!1}var Nl=null,Sg=null,Of=null;function Df(){if(Of)return Of;var p,g=Sg,S=g.length,R,P="value"in Nl?Nl.value:Nl.textContent,q=P.length;for(p=0;p<S&&g[p]===P[p];p++);var he=S-p;for(R=1;R<=he&&g[S-R]===P[q-R];R++);return Of=P.slice(p,1<R?1-R:void 0)}function Ff(p){var g=p.keyCode;return"charCode"in p?(p=p.charCode,p===0&&g===13&&(p=13)):p=g,p===10&&(p=13),32<=p||p===13?p:0}function _p(){return!0}function jS(){return!1}function Ai(p){function g(S,R,P,q,he){this._reactName=S,this._targetInst=P,this.type=R,this.nativeEvent=q,this.target=he,this.currentTarget=null;for(var Oe in p)p.hasOwnProperty(Oe)&&(S=p[Oe],this[Oe]=S?S(q):q[Oe]);return this.isDefaultPrevented=(q.defaultPrevented!=null?q.defaultPrevented:q.returnValue===!1)?_p:jS,this.isPropagationStopped=jS,this}return u(g.prototype,{preventDefault:function(){this.defaultPrevented=!0;var S=this.nativeEvent;S&&(S.preventDefault?S.preventDefault():typeof S.returnValue!="unknown"&&(S.returnValue=!1),this.isDefaultPrevented=_p)},stopPropagation:function(){var S=this.nativeEvent;S&&(S.stopPropagation?S.stopPropagation():typeof S.cancelBubble!="unknown"&&(S.cancelBubble=!0),this.isPropagationStopped=_p)},persist:function(){},isPersistent:_p}),g}var fd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(p){return p.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},_g=Ai(fd),ru=u({},fd,{view:0,detail:0}),Cg=Ai(ru),Cp,Vb,kp,kg=u({},ru,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:hd,button:0,buttons:0,relatedTarget:function(p){return p.relatedTarget===void 0?p.fromElement===p.srcElement?p.toElement:p.fromElement:p.relatedTarget},movementX:function(p){return"movementX"in p?p.movementX:(p!==kp&&(kp&&p.type==="mousemove"?(Cp=p.screenX-kp.screenX,Vb=p.screenY-kp.screenY):Vb=Cp=0,kp=p),Cp)},movementY:function(p){return"movementY"in p?p.movementY:Vb}}),Eg=Ai(kg),Wb=u({},kg,{dataTransfer:0}),PS=Ai(Wb),Tg=u({},ru,{relatedTarget:0}),Lf=Ai(Tg),Ag=u({},fd,{animationName:0,elapsedTime:0,pseudoElement:0}),OS=Ai(Ag),PA=u({},fd,{clipboardData:function(p){return"clipboardData"in p?p.clipboardData:window.clipboardData}}),Rg=Ai(PA),Hb=u({},fd,{data:0}),Ng=Ai(Hb),Gb={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Kb={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},na={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ep(p){var g=this.nativeEvent;return g.getModifierState?g.getModifierState(p):(p=na[p])?!!g[p]:!1}function hd(){return Ep}var DS=u({},ru,{key:function(p){if(p.key){var g=Gb[p.key]||p.key;if(g!=="Unidentified")return g}return p.type==="keypress"?(p=Ff(p),p===13?"Enter":String.fromCharCode(p)):p.type==="keydown"||p.type==="keyup"?Kb[p.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:hd,charCode:function(p){return p.type==="keypress"?Ff(p):0},keyCode:function(p){return p.type==="keydown"||p.type==="keyup"?p.keyCode:0},which:function(p){return p.type==="keypress"?Ff(p):p.type==="keydown"||p.type==="keyup"?p.keyCode:0}}),Ig=Ai(DS),FS=u({},kg,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Yb=Ai(FS),Mg=u({},ru,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:hd}),Zb=Ai(Mg),pd=u({},fd,{propertyName:0,elapsedTime:0,pseudoElement:0}),Xb=Ai(pd),Jb=u({},kg,{deltaX:function(p){return"deltaX"in p?p.deltaX:"wheelDeltaX"in p?-p.wheelDeltaX:0},deltaY:function(p){return"deltaY"in p?p.deltaY:"wheelDeltaY"in p?-p.wheelDeltaY:"wheelDelta"in p?-p.wheelDelta:0},deltaZ:0,deltaMode:0}),jg=Ai(Jb),Qb=u({},fd,{newState:0,oldState:0}),LS=Ai(Qb),OA=[9,13,27,32],Tp=ta&&"CompositionEvent"in window,su=null;ta&&"documentMode"in document&&(su=document.documentMode);var DA=ta&&"TextEvent"in window&&!su,Pg=ta&&(!Tp||su&&8<su&&11>=su),Og=" ",BS=!1;function ev(p,g){switch(p){case"keyup":return OA.indexOf(g.keyCode)!==-1;case"keydown":return g.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function $S(p){return p=p.detail,typeof p=="object"&&"data"in p?p.data:null}var md=!1;function zS(p,g){switch(p){case"compositionend":return $S(g);case"keypress":return g.which!==32?null:(BS=!0,Og);case"textInput":return p=g.data,p===Og&&BS?null:p;default:return null}}function FA(p,g){if(md)return p==="compositionend"||!Tp&&ev(p,g)?(p=Df(),Of=Sg=Nl=null,md=!1,p):null;switch(p){case"paste":return null;case"keypress":if(!(g.ctrlKey||g.altKey||g.metaKey)||g.ctrlKey&&g.altKey){if(g.char&&1<g.char.length)return g.char;if(g.which)return String.fromCharCode(g.which)}return null;case"compositionend":return Pg&&g.locale!=="ko"?null:g.data;default:return null}}var US={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Dg(p){var g=p&&p.nodeName&&p.nodeName.toLowerCase();return g==="input"?!!US[p.type]:g==="textarea"}function tv(p,g,S,R){cd?Bs?Bs.push(R):Bs=[R]:cd=R,g=E_(g,"onChange"),0<g.length&&(S=new _g("onChange","change",null,S,R),p.push({event:S,listeners:g}))}var Bf=null,Ap=null;function LA(p){GL(p,0)}function Fg(p){var g=rs(p);if(Af(g))return p}function Rp(p,g){if(p==="change")return g}var Il=!1;if(ta){var $s;if(ta){var $f="oninput"in document;if(!$f){var eo=document.createElement("div");eo.setAttribute("oninput","return;"),$f=typeof eo.oninput=="function"}$s=$f}else $s=!1;Il=$s&&(!document.documentMode||9<document.documentMode)}function qS(){Bf&&(Bf.detachEvent("onpropertychange",Lg),Ap=Bf=null)}function Lg(p){if(p.propertyName==="value"&&Fg(Ap)){var g=[];tv(g,Ap,p,wg(p)),Pf(LA,g)}}function VS(p,g,S){p==="focusin"?(qS(),Bf=g,Ap=S,Bf.attachEvent("onpropertychange",Lg)):p==="focusout"&&qS()}function gd(p){if(p==="selectionchange"||p==="keyup"||p==="keydown")return Fg(Ap)}function nv(p,g){if(p==="click")return Fg(g)}function zf(p,g){if(p==="input"||p==="change")return Fg(g)}function iu(p,g){return p===g&&(p!==0||1/p===1/g)||p!==p&&g!==g}var ja=typeof Object.is=="function"?Object.is:iu;function M(p,g){if(ja(p,g))return!0;if(typeof p!="object"||p===null||typeof g!="object"||g===null)return!1;var S=Object.keys(p),R=Object.keys(g);if(S.length!==R.length)return!1;for(R=0;R<S.length;R++){var P=S[R];if(!We.call(g,P)||!ja(p[P],g[P]))return!1}return!0}function z(p){for(;p&&p.firstChild;)p=p.firstChild;return p}function te(p,g){var S=z(p);p=0;for(var R;S;){if(S.nodeType===3){if(R=p+S.textContent.length,p<=g&&R>=g)return{node:S,offset:g-p};p=R}e:{for(;S;){if(S.nextSibling){S=S.nextSibling;break e}S=S.parentNode}S=void 0}S=z(S)}}function ae(p,g){return p&&g?p===g?!0:p&&p.nodeType===3?!1:g&&g.nodeType===3?ae(p,g.parentNode):"contains"in p?p.contains(g):p.compareDocumentPosition?!!(p.compareDocumentPosition(g)&16):!1:!1}function pe(p){p=p!=null&&p.ownerDocument!=null&&p.ownerDocument.defaultView!=null?p.ownerDocument.defaultView:window;for(var g=vc(p.document);g instanceof p.HTMLIFrameElement;){try{var S=typeof g.contentWindow.location.href=="string"}catch{S=!1}if(S)p=g.contentWindow;else break;g=vc(p.document)}return g}function Ne(p){var g=p&&p.nodeName&&p.nodeName.toLowerCase();return g&&(g==="input"&&(p.type==="text"||p.type==="search"||p.type==="tel"||p.type==="url"||p.type==="password")||g==="textarea"||p.contentEditable==="true")}var Le=ta&&"documentMode"in document&&11>=document.documentMode,Ge=null,st=null,at=null,pt=!1;function Je(p,g,S){var R=S.window===S?S.document:S.nodeType===9?S:S.ownerDocument;pt||Ge==null||Ge!==vc(R)||(R=Ge,"selectionStart"in R&&Ne(R)?R={start:R.selectionStart,end:R.selectionEnd}:(R=(R.ownerDocument&&R.ownerDocument.defaultView||window).getSelection(),R={anchorNode:R.anchorNode,anchorOffset:R.anchorOffset,focusNode:R.focusNode,focusOffset:R.focusOffset}),at&&M(at,R)||(at=R,R=E_(st,"onSelect"),0<R.length&&(g=new _g("onSelect","select",null,g,S),p.push({event:g,listeners:R}),g.target=Ge)))}function gt(p,g){var S={};return S[p.toLowerCase()]=g.toLowerCase(),S["Webkit"+p]="webkit"+g,S["Moz"+p]="moz"+g,S}var rt={animationend:gt("Animation","AnimationEnd"),animationiteration:gt("Animation","AnimationIteration"),animationstart:gt("Animation","AnimationStart"),transitionrun:gt("Transition","TransitionRun"),transitionstart:gt("Transition","TransitionStart"),transitioncancel:gt("Transition","TransitionCancel"),transitionend:gt("Transition","TransitionEnd")},ht={},bt={};ta&&(bt=document.createElement("div").style,"AnimationEvent"in window||(delete rt.animationend.animation,delete rt.animationiteration.animation,delete rt.animationstart.animation),"TransitionEvent"in window||delete rt.transitionend.transition);function lt(p){if(ht[p])return ht[p];if(!rt[p])return p;var g=rt[p],S;for(S in g)if(g.hasOwnProperty(S)&&S in bt)return ht[p]=g[S];return p}var kt=lt("animationend"),It=lt("animationiteration"),Mt=lt("animationstart"),Ot=lt("transitionrun"),Xt=lt("transitionstart"),sn=lt("transitioncancel"),Ht=lt("transitionend"),en=new Map,ln="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");ln.push("scrollEnd");function Gt(p,g){en.set(p,g),Vt(g,[p])}var bn=new WeakMap;function qn(p,g){if(typeof p=="object"&&p!==null){var S=bn.get(p);return S!==void 0?S:(g={value:p,source:g,stack:Fb(g)},bn.set(p,g),g)}return{value:p,source:g,stack:Fb(g)}}var Yn=[],mr=0,va=0;function or(){for(var p=mr,g=va=mr=0;g<p;){var S=Yn[g];Yn[g++]=null;var R=Yn[g];Yn[g++]=null;var P=Yn[g];Yn[g++]=null;var q=Yn[g];if(Yn[g++]=null,R!==null&&P!==null){var he=R.pending;he===null?P.next=P:(P.next=he.next,he.next=P),R.pending=P}q!==0&&ra(S,P,q)}}function hi(p,g,S,R){Yn[mr++]=p,Yn[mr++]=g,Yn[mr++]=S,Yn[mr++]=R,va|=R,p.lanes|=R,p=p.alternate,p!==null&&(p.lanes|=R)}function Ri(p,g,S,R){return hi(p,g,S,R),Ml(p)}function xc(p,g){return hi(p,null,null,g),Ml(p)}function ra(p,g,S){p.lanes|=S;var R=p.alternate;R!==null&&(R.lanes|=S);for(var P=!1,q=p.return;q!==null;)q.childLanes|=S,R=q.alternate,R!==null&&(R.childLanes|=S),q.tag===22&&(p=q.stateNode,p===null||p._visibility&1||(P=!0)),p=q,q=q.return;return p.tag===3?(q=p.stateNode,P&&g!==null&&(P=31-Yt(S),p=q.hiddenUpdates,R=p[P],R===null?p[P]=[g]:R.push(g),g.lane=S|536870912),q):null}function Ml(p){if(50<Tv)throw Tv=0,VR=null,Error(r(185));for(var g=p.return;g!==null;)p=g,g=p.return;return p.tag===3?p.stateNode:null}var au={};function pfe(p,g,S,R){this.tag=p,this.key=S,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=g,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=R,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function nl(p,g,S,R){return new pfe(p,g,S,R)}function BA(p){return p=p.prototype,!(!p||!p.isReactComponent)}function yd(p,g){var S=p.alternate;return S===null?(S=nl(p.tag,g,p.key,p.mode),S.elementType=p.elementType,S.type=p.type,S.stateNode=p.stateNode,S.alternate=p,p.alternate=S):(S.pendingProps=g,S.type=p.type,S.flags=0,S.subtreeFlags=0,S.deletions=null),S.flags=p.flags&65011712,S.childLanes=p.childLanes,S.lanes=p.lanes,S.child=p.child,S.memoizedProps=p.memoizedProps,S.memoizedState=p.memoizedState,S.updateQueue=p.updateQueue,g=p.dependencies,S.dependencies=g===null?null:{lanes:g.lanes,firstContext:g.firstContext},S.sibling=p.sibling,S.index=p.index,S.ref=p.ref,S.refCleanup=p.refCleanup,S}function M5(p,g){p.flags&=65011714;var S=p.alternate;return S===null?(p.childLanes=0,p.lanes=g,p.child=null,p.subtreeFlags=0,p.memoizedProps=null,p.memoizedState=null,p.updateQueue=null,p.dependencies=null,p.stateNode=null):(p.childLanes=S.childLanes,p.lanes=S.lanes,p.child=S.child,p.subtreeFlags=0,p.deletions=null,p.memoizedProps=S.memoizedProps,p.memoizedState=S.memoizedState,p.updateQueue=S.updateQueue,p.type=S.type,g=S.dependencies,p.dependencies=g===null?null:{lanes:g.lanes,firstContext:g.firstContext}),p}function WS(p,g,S,R,P,q){var he=0;if(R=p,typeof p=="function")BA(p)&&(he=1);else if(typeof p=="string")he=ghe(p,S,de.current)?26:p==="html"||p==="head"||p==="body"?27:5;else e:switch(p){case I:return p=nl(31,S,g,P),p.elementType=I,p.lanes=q,p;case y:return Np(S.children,P,q,g);case b:he=8,P|=24;break;case v:return p=nl(12,S,g,P|2),p.elementType=v,p.lanes=q,p;case C:return p=nl(13,S,g,P),p.elementType=C,p.lanes=q,p;case T:return p=nl(19,S,g,P),p.elementType=T,p.lanes=q,p;default:if(typeof p=="object"&&p!==null)switch(p.$$typeof){case x:case _:he=10;break e;case w:he=9;break e;case k:he=11;break e;case A:he=14;break e;case N:he=16,R=null;break e}he=29,S=Error(r(130,p===null?"null":typeof p,"")),R=null}return g=nl(he,S,g,P),g.elementType=p,g.type=R,g.lanes=q,g}function Np(p,g,S,R){return p=nl(7,p,R,g),p.lanes=S,p}function $A(p,g,S){return p=nl(6,p,null,g),p.lanes=S,p}function zA(p,g,S){return g=nl(4,p.children!==null?p.children:[],p.key,g),g.lanes=S,g.stateNode={containerInfo:p.containerInfo,pendingChildren:null,implementation:p.implementation},g}var Bg=[],$g=0,HS=null,GS=0,jl=[],Pl=0,Ip=null,bd=1,vd="";function Mp(p,g){Bg[$g++]=GS,Bg[$g++]=HS,HS=p,GS=g}function j5(p,g,S){jl[Pl++]=bd,jl[Pl++]=vd,jl[Pl++]=Ip,Ip=p;var R=bd;p=vd;var P=32-Yt(R)-1;R&=~(1<<P),S+=1;var q=32-Yt(g)+P;if(30<q){var he=P-P%5;q=(R&(1<<he)-1).toString(32),R>>=he,P-=he,bd=1<<32-Yt(g)+P|S<<P|R,vd=q+p}else bd=1<<q|S<<P|R,vd=p}function UA(p){p.return!==null&&(Mp(p,1),j5(p,1,0))}function qA(p){for(;p===HS;)HS=Bg[--$g],Bg[$g]=null,GS=Bg[--$g],Bg[$g]=null;for(;p===Ip;)Ip=jl[--Pl],jl[Pl]=null,vd=jl[--Pl],jl[Pl]=null,bd=jl[--Pl],jl[Pl]=null}var to=null,oi=null,is=!1,jp=null,ou=!1,VA=Error(r(519));function Pp(p){var g=Error(r(418,""));throw iv(qn(g,p)),VA}function P5(p){var g=p.stateNode,S=p.type,R=p.memoizedProps;switch(g[xe]=p,g[Fe]=R,S){case"dialog":$r("cancel",g),$r("close",g);break;case"iframe":case"object":case"embed":$r("load",g);break;case"video":case"audio":for(S=0;S<Rv.length;S++)$r(Rv[S],g);break;case"source":$r("error",g);break;case"img":case"image":case"link":$r("error",g),$r("load",g);break;case"details":$r("toggle",g);break;case"input":$r("invalid",g),$b(g,R.value,R.defaultValue,R.checked,R.defaultChecked,R.type,R.name,!0),nu(g);break;case"select":$r("invalid",g);break;case"textarea":$r("invalid",g),zb(g,R.value,R.defaultValue,R.children),nu(g)}S=R.children,typeof S!="string"&&typeof S!="number"&&typeof S!="bigint"||g.textContent===""+S||R.suppressHydrationWarning===!0||XL(g.textContent,S)?(R.popover!=null&&($r("beforetoggle",g),$r("toggle",g)),R.onScroll!=null&&$r("scroll",g),R.onScrollEnd!=null&&$r("scrollend",g),R.onClick!=null&&(g.onclick=T_),g=!0):g=!1,g||Pp(p)}function O5(p){for(to=p.return;to;)switch(to.tag){case 5:case 13:ou=!1;return;case 27:case 3:ou=!0;return;default:to=to.return}}function rv(p){if(p!==to)return!1;if(!is)return O5(p),is=!0,!1;var g=p.tag,S;if((S=g!==3&&g!==27)&&((S=g===5)&&(S=p.type,S=!(S!=="form"&&S!=="button")||aN(p.type,p.memoizedProps)),S=!S),S&&oi&&Pp(p),O5(p),g===13){if(p=p.memoizedState,p=p!==null?p.dehydrated:null,!p)throw Error(r(317));e:{for(p=p.nextSibling,g=0;p;){if(p.nodeType===8)if(S=p.data,S==="/$"){if(g===0){oi=Sc(p.nextSibling);break e}g--}else S!=="$"&&S!=="$!"&&S!=="$?"||g++;p=p.nextSibling}oi=null}}else g===27?(g=oi,rh(p.type)?(p=uN,uN=null,oi=p):oi=g):oi=to?Sc(p.stateNode.nextSibling):null;return!0}function sv(){oi=to=null,is=!1}function D5(){var p=jp;return p!==null&&(Mo===null?Mo=p:Mo.push.apply(Mo,p),jp=null),p}function iv(p){jp===null?jp=[p]:jp.push(p)}var WA=Q(null),Op=null,xd=null;function Uf(p,g,S){re(WA,g._currentValue),g._currentValue=S}function wd(p){p._currentValue=WA.current,ee(WA)}function HA(p,g,S){for(;p!==null;){var R=p.alternate;if((p.childLanes&g)!==g?(p.childLanes|=g,R!==null&&(R.childLanes|=g)):R!==null&&(R.childLanes&g)!==g&&(R.childLanes|=g),p===S)break;p=p.return}}function GA(p,g,S,R){var P=p.child;for(P!==null&&(P.return=p);P!==null;){var q=P.dependencies;if(q!==null){var he=P.child;q=q.firstContext;e:for(;q!==null;){var Oe=q;q=P;for(var Ze=0;Ze<g.length;Ze++)if(Oe.context===g[Ze]){q.lanes|=S,Oe=q.alternate,Oe!==null&&(Oe.lanes|=S),HA(q.return,S,p),R||(he=null);break e}q=Oe.next}}else if(P.tag===18){if(he=P.return,he===null)throw Error(r(341));he.lanes|=S,q=he.alternate,q!==null&&(q.lanes|=S),HA(he,S,p),he=null}else he=P.child;if(he!==null)he.return=P;else for(he=P;he!==null;){if(he===p){he=null;break}if(P=he.sibling,P!==null){P.return=he.return,he=P;break}he=he.return}P=he}}function av(p,g,S,R){p=null;for(var P=g,q=!1;P!==null;){if(!q){if((P.flags&524288)!==0)q=!0;else if((P.flags&262144)!==0)break}if(P.tag===10){var he=P.alternate;if(he===null)throw Error(r(387));if(he=he.memoizedProps,he!==null){var Oe=P.type;ja(P.pendingProps.value,he.value)||(p!==null?p.push(Oe):p=[Oe])}}else if(P===je.current){if(he=P.alternate,he===null)throw Error(r(387));he.memoizedState.memoizedState!==P.memoizedState.memoizedState&&(p!==null?p.push(Ov):p=[Ov])}P=P.return}p!==null&&GA(g,p,S,R),g.flags|=262144}function KS(p){for(p=p.firstContext;p!==null;){if(!ja(p.context._currentValue,p.memoizedValue))return!0;p=p.next}return!1}function Dp(p){Op=p,xd=null,p=p.dependencies,p!==null&&(p.firstContext=null)}function Pa(p){return F5(Op,p)}function YS(p,g){return Op===null&&Dp(p),F5(p,g)}function F5(p,g){var S=g._currentValue;if(g={context:g,memoizedValue:S,next:null},xd===null){if(p===null)throw Error(r(308));xd=g,p.dependencies={lanes:0,firstContext:g},p.flags|=524288}else xd=xd.next=g;return S}var mfe=typeof AbortController<"u"?AbortController:function(){var p=[],g=this.signal={aborted:!1,addEventListener:function(S,R){p.push(R)}};this.abort=function(){g.aborted=!0,p.forEach(function(S){return S()})}},gfe=e.unstable_scheduleCallback,yfe=e.unstable_NormalPriority,Ui={$$typeof:_,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function KA(){return{controller:new mfe,data:new Map,refCount:0}}function ov(p){p.refCount--,p.refCount===0&&gfe(yfe,function(){p.controller.abort()})}var lv=null,YA=0,zg=0,Ug=null;function bfe(p,g){if(lv===null){var S=lv=[];YA=0,zg=XR(),Ug={status:"pending",value:void 0,then:function(R){S.push(R)}}}return YA++,g.then(L5,L5),g}function L5(){if(--YA===0&&lv!==null){Ug!==null&&(Ug.status="fulfilled");var p=lv;lv=null,zg=0,Ug=null;for(var g=0;g<p.length;g++)(0,p[g])()}}function vfe(p,g){var S=[],R={status:"pending",value:null,reason:null,then:function(P){S.push(P)}};return p.then(function(){R.status="fulfilled",R.value=g;for(var P=0;P<S.length;P++)(0,S[P])(g)},function(P){for(R.status="rejected",R.reason=P,P=0;P<S.length;P++)(0,S[P])(void 0)}),R}var B5=U.S;U.S=function(p,g){typeof g=="object"&&g!==null&&typeof g.then=="function"&&bfe(p,g),B5!==null&&B5(p,g)};var Fp=Q(null);function ZA(){var p=Fp.current;return p!==null?p:Ds.pooledCache}function ZS(p,g){g===null?re(Fp,Fp.current):re(Fp,g.pool)}function $5(){var p=ZA();return p===null?null:{parent:Ui._currentValue,pool:p}}var cv=Error(r(460)),z5=Error(r(474)),XS=Error(r(542)),XA={then:function(){}};function U5(p){return p=p.status,p==="fulfilled"||p==="rejected"}function JS(){}function q5(p,g,S){switch(S=p[S],S===void 0?p.push(g):S!==g&&(g.then(JS,JS),g=S),g.status){case"fulfilled":return g.value;case"rejected":throw p=g.reason,W5(p),p;default:if(typeof g.status=="string")g.then(JS,JS);else{if(p=Ds,p!==null&&100<p.shellSuspendCounter)throw Error(r(482));p=g,p.status="pending",p.then(function(R){if(g.status==="pending"){var P=g;P.status="fulfilled",P.value=R}},function(R){if(g.status==="pending"){var P=g;P.status="rejected",P.reason=R}})}switch(g.status){case"fulfilled":return g.value;case"rejected":throw p=g.reason,W5(p),p}throw uv=g,cv}}var uv=null;function V5(){if(uv===null)throw Error(r(459));var p=uv;return uv=null,p}function W5(p){if(p===cv||p===XS)throw Error(r(483))}var qf=!1;function JA(p){p.updateQueue={baseState:p.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function QA(p,g){p=p.updateQueue,g.updateQueue===p&&(g.updateQueue={baseState:p.baseState,firstBaseUpdate:p.firstBaseUpdate,lastBaseUpdate:p.lastBaseUpdate,shared:p.shared,callbacks:null})}function Vf(p){return{lane:p,tag:0,payload:null,callback:null,next:null}}function Wf(p,g,S){var R=p.updateQueue;if(R===null)return null;if(R=R.shared,(ys&2)!==0){var P=R.pending;return P===null?g.next=g:(g.next=P.next,P.next=g),R.pending=g,g=Ml(p),ra(p,null,S),g}return hi(p,R,g,S),Ml(p)}function dv(p,g,S){if(g=g.updateQueue,g!==null&&(g=g.shared,(S&4194048)!==0)){var R=g.lanes;R&=p.pendingLanes,S|=R,g.lanes=S,ze(p,S)}}function eR(p,g){var S=p.updateQueue,R=p.alternate;if(R!==null&&(R=R.updateQueue,S===R)){var P=null,q=null;if(S=S.firstBaseUpdate,S!==null){do{var he={lane:S.lane,tag:S.tag,payload:S.payload,callback:null,next:null};q===null?P=q=he:q=q.next=he,S=S.next}while(S!==null);q===null?P=q=g:q=q.next=g}else P=q=g;S={baseState:R.baseState,firstBaseUpdate:P,lastBaseUpdate:q,shared:R.shared,callbacks:R.callbacks},p.updateQueue=S;return}p=S.lastBaseUpdate,p===null?S.firstBaseUpdate=g:p.next=g,S.lastBaseUpdate=g}var tR=!1;function fv(){if(tR){var p=Ug;if(p!==null)throw p}}function hv(p,g,S,R){tR=!1;var P=p.updateQueue;qf=!1;var q=P.firstBaseUpdate,he=P.lastBaseUpdate,Oe=P.shared.pending;if(Oe!==null){P.shared.pending=null;var Ze=Oe,_t=Ze.next;Ze.next=null,he===null?q=_t:he.next=_t,he=Ze;var Dt=p.alternate;Dt!==null&&(Dt=Dt.updateQueue,Oe=Dt.lastBaseUpdate,Oe!==he&&(Oe===null?Dt.firstBaseUpdate=_t:Oe.next=_t,Dt.lastBaseUpdate=Ze))}if(q!==null){var $t=P.baseState;he=0,Dt=_t=Ze=null,Oe=q;do{var Et=Oe.lane&-536870913,Rt=Et!==Oe.lane;if(Rt?(Yr&Et)===Et:(R&Et)===Et){Et!==0&&Et===zg&&(tR=!0),Dt!==null&&(Dt=Dt.next={lane:0,tag:Oe.tag,payload:Oe.payload,callback:null,next:null});e:{var lr=p,Zn=Oe;Et=g;var ks=S;switch(Zn.tag){case 1:if(lr=Zn.payload,typeof lr=="function"){$t=lr.call(ks,$t,Et);break e}$t=lr;break e;case 3:lr.flags=lr.flags&-65537|128;case 0:if(lr=Zn.payload,Et=typeof lr=="function"?lr.call(ks,$t,Et):lr,Et==null)break e;$t=u({},$t,Et);break e;case 2:qf=!0}}Et=Oe.callback,Et!==null&&(p.flags|=64,Rt&&(p.flags|=8192),Rt=P.callbacks,Rt===null?P.callbacks=[Et]:Rt.push(Et))}else Rt={lane:Et,tag:Oe.tag,payload:Oe.payload,callback:Oe.callback,next:null},Dt===null?(_t=Dt=Rt,Ze=$t):Dt=Dt.next=Rt,he|=Et;if(Oe=Oe.next,Oe===null){if(Oe=P.shared.pending,Oe===null)break;Rt=Oe,Oe=Rt.next,Rt.next=null,P.lastBaseUpdate=Rt,P.shared.pending=null}}while(!0);Dt===null&&(Ze=$t),P.baseState=Ze,P.firstBaseUpdate=_t,P.lastBaseUpdate=Dt,q===null&&(P.shared.lanes=0),Qf|=he,p.lanes=he,p.memoizedState=$t}}function H5(p,g){if(typeof p!="function")throw Error(r(191,p));p.call(g)}function G5(p,g){var S=p.callbacks;if(S!==null)for(p.callbacks=null,p=0;p<S.length;p++)H5(S[p],g)}var qg=Q(null),QS=Q(0);function K5(p,g){p=Ad,re(QS,p),re(qg,g),Ad=p|g.baseLanes}function nR(){re(QS,Ad),re(qg,qg.current)}function rR(){Ad=QS.current,ee(qg),ee(QS)}var Hf=0,Pr=null,_s=null,Ni=null,e_=!1,Vg=!1,Lp=!1,t_=0,pv=0,Wg=null,xfe=0;function pi(){throw Error(r(321))}function sR(p,g){if(g===null)return!1;for(var S=0;S<g.length&&S<p.length;S++)if(!ja(p[S],g[S]))return!1;return!0}function iR(p,g,S,R,P,q){return Hf=q,Pr=g,g.memoizedState=null,g.updateQueue=null,g.lanes=0,U.H=p===null||p.memoizedState===null?I8:M8,Lp=!1,q=S(R,P),Lp=!1,Vg&&(q=Z5(g,S,R,P)),Y5(p),q}function Y5(p){U.H=o_;var g=_s!==null&&_s.next!==null;if(Hf=0,Ni=_s=Pr=null,e_=!1,pv=0,Wg=null,g)throw Error(r(300));p===null||sa||(p=p.dependencies,p!==null&&KS(p)&&(sa=!0))}function Z5(p,g,S,R){Pr=p;var P=0;do{if(Vg&&(Wg=null),pv=0,Vg=!1,25<=P)throw Error(r(301));if(P+=1,Ni=_s=null,p.updateQueue!=null){var q=p.updateQueue;q.lastEffect=null,q.events=null,q.stores=null,q.memoCache!=null&&(q.memoCache.index=0)}U.H=Tfe,q=g(S,R)}while(Vg);return q}function wfe(){var p=U.H,g=p.useState()[0];return g=typeof g.then=="function"?mv(g):g,p=p.useState()[0],(_s!==null?_s.memoizedState:null)!==p&&(Pr.flags|=1024),g}function aR(){var p=t_!==0;return t_=0,p}function oR(p,g,S){g.updateQueue=p.updateQueue,g.flags&=-2053,p.lanes&=~S}function lR(p){if(e_){for(p=p.memoizedState;p!==null;){var g=p.queue;g!==null&&(g.pending=null),p=p.next}e_=!1}Hf=0,Ni=_s=Pr=null,Vg=!1,pv=t_=0,Wg=null}function No(){var p={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ni===null?Pr.memoizedState=Ni=p:Ni=Ni.next=p,Ni}function Ii(){if(_s===null){var p=Pr.alternate;p=p!==null?p.memoizedState:null}else p=_s.next;var g=Ni===null?Pr.memoizedState:Ni.next;if(g!==null)Ni=g,_s=p;else{if(p===null)throw Pr.alternate===null?Error(r(467)):Error(r(310));_s=p,p={memoizedState:_s.memoizedState,baseState:_s.baseState,baseQueue:_s.baseQueue,queue:_s.queue,next:null},Ni===null?Pr.memoizedState=Ni=p:Ni=Ni.next=p}return Ni}function cR(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function mv(p){var g=pv;return pv+=1,Wg===null&&(Wg=[]),p=q5(Wg,p,g),g=Pr,(Ni===null?g.memoizedState:Ni.next)===null&&(g=g.alternate,U.H=g===null||g.memoizedState===null?I8:M8),p}function n_(p){if(p!==null&&typeof p=="object"){if(typeof p.then=="function")return mv(p);if(p.$$typeof===_)return Pa(p)}throw Error(r(438,String(p)))}function uR(p){var g=null,S=Pr.updateQueue;if(S!==null&&(g=S.memoCache),g==null){var R=Pr.alternate;R!==null&&(R=R.updateQueue,R!==null&&(R=R.memoCache,R!=null&&(g={data:R.data.map(function(P){return P.slice()}),index:0})))}if(g==null&&(g={data:[],index:0}),S===null&&(S=cR(),Pr.updateQueue=S),S.memoCache=g,S=g.data[g.index],S===void 0)for(S=g.data[g.index]=Array(p),R=0;R<p;R++)S[R]=j;return g.index++,S}function Sd(p,g){return typeof g=="function"?g(p):g}function r_(p){var g=Ii();return dR(g,_s,p)}function dR(p,g,S){var R=p.queue;if(R===null)throw Error(r(311));R.lastRenderedReducer=S;var P=p.baseQueue,q=R.pending;if(q!==null){if(P!==null){var he=P.next;P.next=q.next,q.next=he}g.baseQueue=P=q,R.pending=null}if(q=p.baseState,P===null)p.memoizedState=q;else{g=P.next;var Oe=he=null,Ze=null,_t=g,Dt=!1;do{var $t=_t.lane&-536870913;if($t!==_t.lane?(Yr&$t)===$t:(Hf&$t)===$t){var Et=_t.revertLane;if(Et===0)Ze!==null&&(Ze=Ze.next={lane:0,revertLane:0,action:_t.action,hasEagerState:_t.hasEagerState,eagerState:_t.eagerState,next:null}),$t===zg&&(Dt=!0);else if((Hf&Et)===Et){_t=_t.next,Et===zg&&(Dt=!0);continue}else $t={lane:0,revertLane:_t.revertLane,action:_t.action,hasEagerState:_t.hasEagerState,eagerState:_t.eagerState,next:null},Ze===null?(Oe=Ze=$t,he=q):Ze=Ze.next=$t,Pr.lanes|=Et,Qf|=Et;$t=_t.action,Lp&&S(q,$t),q=_t.hasEagerState?_t.eagerState:S(q,$t)}else Et={lane:$t,revertLane:_t.revertLane,action:_t.action,hasEagerState:_t.hasEagerState,eagerState:_t.eagerState,next:null},Ze===null?(Oe=Ze=Et,he=q):Ze=Ze.next=Et,Pr.lanes|=$t,Qf|=$t;_t=_t.next}while(_t!==null&&_t!==g);if(Ze===null?he=q:Ze.next=Oe,!ja(q,p.memoizedState)&&(sa=!0,Dt&&(S=Ug,S!==null)))throw S;p.memoizedState=q,p.baseState=he,p.baseQueue=Ze,R.lastRenderedState=q}return P===null&&(R.lanes=0),[p.memoizedState,R.dispatch]}function fR(p){var g=Ii(),S=g.queue;if(S===null)throw Error(r(311));S.lastRenderedReducer=p;var R=S.dispatch,P=S.pending,q=g.memoizedState;if(P!==null){S.pending=null;var he=P=P.next;do q=p(q,he.action),he=he.next;while(he!==P);ja(q,g.memoizedState)||(sa=!0),g.memoizedState=q,g.baseQueue===null&&(g.baseState=q),S.lastRenderedState=q}return[q,R]}function X5(p,g,S){var R=Pr,P=Ii(),q=is;if(q){if(S===void 0)throw Error(r(407));S=S()}else S=g();var he=!ja((_s||P).memoizedState,S);he&&(P.memoizedState=S,sa=!0),P=P.queue;var Oe=e8.bind(null,R,P,p);if(gv(2048,8,Oe,[p]),P.getSnapshot!==g||he||Ni!==null&&Ni.memoizedState.tag&1){if(R.flags|=2048,Hg(9,s_(),Q5.bind(null,R,P,S,g),null),Ds===null)throw Error(r(349));q||(Hf&124)!==0||J5(R,g,S)}return S}function J5(p,g,S){p.flags|=16384,p={getSnapshot:g,value:S},g=Pr.updateQueue,g===null?(g=cR(),Pr.updateQueue=g,g.stores=[p]):(S=g.stores,S===null?g.stores=[p]:S.push(p))}function Q5(p,g,S,R){g.value=S,g.getSnapshot=R,t8(g)&&n8(p)}function e8(p,g,S){return S(function(){t8(g)&&n8(p)})}function t8(p){var g=p.getSnapshot;p=p.value;try{var S=g();return!ja(p,S)}catch{return!0}}function n8(p){var g=xc(p,2);g!==null&&ol(g,p,2)}function hR(p){var g=No();if(typeof p=="function"){var S=p;if(p=S(),Lp){Ft(!0);try{S()}finally{Ft(!1)}}}return g.memoizedState=g.baseState=p,g.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Sd,lastRenderedState:p},g}function r8(p,g,S,R){return p.baseState=S,dR(p,_s,typeof R=="function"?R:Sd)}function Sfe(p,g,S,R,P){if(a_(p))throw Error(r(485));if(p=g.action,p!==null){var q={payload:P,action:p,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(he){q.listeners.push(he)}};U.T!==null?S(!0):q.isTransition=!1,R(q),S=g.pending,S===null?(q.next=g.pending=q,s8(g,q)):(q.next=S.next,g.pending=S.next=q)}}function s8(p,g){var S=g.action,R=g.payload,P=p.state;if(g.isTransition){var q=U.T,he={};U.T=he;try{var Oe=S(P,R),Ze=U.S;Ze!==null&&Ze(he,Oe),i8(p,g,Oe)}catch(_t){pR(p,g,_t)}finally{U.T=q}}else try{q=S(P,R),i8(p,g,q)}catch(_t){pR(p,g,_t)}}function i8(p,g,S){S!==null&&typeof S=="object"&&typeof S.then=="function"?S.then(function(R){a8(p,g,R)},function(R){return pR(p,g,R)}):a8(p,g,S)}function a8(p,g,S){g.status="fulfilled",g.value=S,o8(g),p.state=S,g=p.pending,g!==null&&(S=g.next,S===g?p.pending=null:(S=S.next,g.next=S,s8(p,S)))}function pR(p,g,S){var R=p.pending;if(p.pending=null,R!==null){R=R.next;do g.status="rejected",g.reason=S,o8(g),g=g.next;while(g!==R)}p.action=null}function o8(p){p=p.listeners;for(var g=0;g<p.length;g++)(0,p[g])()}function l8(p,g){return g}function c8(p,g){if(is){var S=Ds.formState;if(S!==null){e:{var R=Pr;if(is){if(oi){t:{for(var P=oi,q=ou;P.nodeType!==8;){if(!q){P=null;break t}if(P=Sc(P.nextSibling),P===null){P=null;break t}}q=P.data,P=q==="F!"||q==="F"?P:null}if(P){oi=Sc(P.nextSibling),R=P.data==="F!";break e}}Pp(R)}R=!1}R&&(g=S[0])}}return S=No(),S.memoizedState=S.baseState=g,R={pending:null,lanes:0,dispatch:null,lastRenderedReducer:l8,lastRenderedState:g},S.queue=R,S=A8.bind(null,Pr,R),R.dispatch=S,R=hR(!1),q=vR.bind(null,Pr,!1,R.queue),R=No(),P={state:g,dispatch:null,action:p,pending:null},R.queue=P,S=Sfe.bind(null,Pr,P,q,S),P.dispatch=S,R.memoizedState=p,[g,S,!1]}function u8(p){var g=Ii();return d8(g,_s,p)}function d8(p,g,S){if(g=dR(p,g,l8)[0],p=r_(Sd)[0],typeof g=="object"&&g!==null&&typeof g.then=="function")try{var R=mv(g)}catch(he){throw he===cv?XS:he}else R=g;g=Ii();var P=g.queue,q=P.dispatch;return S!==g.memoizedState&&(Pr.flags|=2048,Hg(9,s_(),_fe.bind(null,P,S),null)),[R,q,p]}function _fe(p,g){p.action=g}function f8(p){var g=Ii(),S=_s;if(S!==null)return d8(g,S,p);Ii(),g=g.memoizedState,S=Ii();var R=S.queue.dispatch;return S.memoizedState=p,[g,R,!1]}function Hg(p,g,S,R){return p={tag:p,create:S,deps:R,inst:g,next:null},g=Pr.updateQueue,g===null&&(g=cR(),Pr.updateQueue=g),S=g.lastEffect,S===null?g.lastEffect=p.next=p:(R=S.next,S.next=p,p.next=R,g.lastEffect=p),p}function s_(){return{destroy:void 0,resource:void 0}}function h8(){return Ii().memoizedState}function i_(p,g,S,R){var P=No();R=R===void 0?null:R,Pr.flags|=p,P.memoizedState=Hg(1|g,s_(),S,R)}function gv(p,g,S,R){var P=Ii();R=R===void 0?null:R;var q=P.memoizedState.inst;_s!==null&&R!==null&&sR(R,_s.memoizedState.deps)?P.memoizedState=Hg(g,q,S,R):(Pr.flags|=p,P.memoizedState=Hg(1|g,q,S,R))}function p8(p,g){i_(8390656,8,p,g)}function m8(p,g){gv(2048,8,p,g)}function g8(p,g){return gv(4,2,p,g)}function y8(p,g){return gv(4,4,p,g)}function b8(p,g){if(typeof g=="function"){p=p();var S=g(p);return function(){typeof S=="function"?S():g(null)}}if(g!=null)return p=p(),g.current=p,function(){g.current=null}}function v8(p,g,S){S=S!=null?S.concat([p]):null,gv(4,4,b8.bind(null,g,p),S)}function mR(){}function x8(p,g){var S=Ii();g=g===void 0?null:g;var R=S.memoizedState;return g!==null&&sR(g,R[1])?R[0]:(S.memoizedState=[p,g],p)}function w8(p,g){var S=Ii();g=g===void 0?null:g;var R=S.memoizedState;if(g!==null&&sR(g,R[1]))return R[0];if(R=p(),Lp){Ft(!0);try{p()}finally{Ft(!1)}}return S.memoizedState=[R,g],R}function gR(p,g,S){return S===void 0||(Hf&1073741824)!==0?p.memoizedState=g:(p.memoizedState=S,p=CL(),Pr.lanes|=p,Qf|=p,S)}function S8(p,g,S,R){return ja(S,g)?S:qg.current!==null?(p=gR(p,S,R),ja(p,g)||(sa=!0),p):(Hf&42)===0?(sa=!0,p.memoizedState=S):(p=CL(),Pr.lanes|=p,Qf|=p,g)}function _8(p,g,S,R,P){var q=W.p;W.p=q!==0&&8>q?q:8;var he=U.T,Oe={};U.T=Oe,vR(p,!1,g,S);try{var Ze=P(),_t=U.S;if(_t!==null&&_t(Oe,Ze),Ze!==null&&typeof Ze=="object"&&typeof Ze.then=="function"){var Dt=vfe(Ze,R);yv(p,g,Dt,al(p))}else yv(p,g,R,al(p))}catch($t){yv(p,g,{then:function(){},status:"rejected",reason:$t},al())}finally{W.p=q,U.T=he}}function Cfe(){}function yR(p,g,S,R){if(p.tag!==5)throw Error(r(476));var P=C8(p).queue;_8(p,P,g,B,S===null?Cfe:function(){return k8(p),S(R)})}function C8(p){var g=p.memoizedState;if(g!==null)return g;g={memoizedState:B,baseState:B,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Sd,lastRenderedState:B},next:null};var S={};return g.next={memoizedState:S,baseState:S,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Sd,lastRenderedState:S},next:null},p.memoizedState=g,p=p.alternate,p!==null&&(p.memoizedState=g),g}function k8(p){var g=C8(p).next.queue;yv(p,g,{},al())}function bR(){return Pa(Ov)}function E8(){return Ii().memoizedState}function T8(){return Ii().memoizedState}function kfe(p){for(var g=p.return;g!==null;){switch(g.tag){case 24:case 3:var S=al();p=Vf(S);var R=Wf(g,p,S);R!==null&&(ol(R,g,S),dv(R,g,S)),g={cache:KA()},p.payload=g;return}g=g.return}}function Efe(p,g,S){var R=al();S={lane:R,revertLane:0,action:S,hasEagerState:!1,eagerState:null,next:null},a_(p)?R8(g,S):(S=Ri(p,g,S,R),S!==null&&(ol(S,p,R),N8(S,g,R)))}function A8(p,g,S){var R=al();yv(p,g,S,R)}function yv(p,g,S,R){var P={lane:R,revertLane:0,action:S,hasEagerState:!1,eagerState:null,next:null};if(a_(p))R8(g,P);else{var q=p.alternate;if(p.lanes===0&&(q===null||q.lanes===0)&&(q=g.lastRenderedReducer,q!==null))try{var he=g.lastRenderedState,Oe=q(he,S);if(P.hasEagerState=!0,P.eagerState=Oe,ja(Oe,he))return hi(p,g,P,0),Ds===null&&or(),!1}catch{}finally{}if(S=Ri(p,g,P,R),S!==null)return ol(S,p,R),N8(S,g,R),!0}return!1}function vR(p,g,S,R){if(R={lane:2,revertLane:XR(),action:R,hasEagerState:!1,eagerState:null,next:null},a_(p)){if(g)throw Error(r(479))}else g=Ri(p,S,R,2),g!==null&&ol(g,p,2)}function a_(p){var g=p.alternate;return p===Pr||g!==null&&g===Pr}function R8(p,g){Vg=e_=!0;var S=p.pending;S===null?g.next=g:(g.next=S.next,S.next=g),p.pending=g}function N8(p,g,S){if((S&4194048)!==0){var R=g.lanes;R&=p.pendingLanes,S|=R,g.lanes=S,ze(p,S)}}var o_={readContext:Pa,use:n_,useCallback:pi,useContext:pi,useEffect:pi,useImperativeHandle:pi,useLayoutEffect:pi,useInsertionEffect:pi,useMemo:pi,useReducer:pi,useRef:pi,useState:pi,useDebugValue:pi,useDeferredValue:pi,useTransition:pi,useSyncExternalStore:pi,useId:pi,useHostTransitionStatus:pi,useFormState:pi,useActionState:pi,useOptimistic:pi,useMemoCache:pi,useCacheRefresh:pi},I8={readContext:Pa,use:n_,useCallback:function(p,g){return No().memoizedState=[p,g===void 0?null:g],p},useContext:Pa,useEffect:p8,useImperativeHandle:function(p,g,S){S=S!=null?S.concat([p]):null,i_(4194308,4,b8.bind(null,g,p),S)},useLayoutEffect:function(p,g){return i_(4194308,4,p,g)},useInsertionEffect:function(p,g){i_(4,2,p,g)},useMemo:function(p,g){var S=No();g=g===void 0?null:g;var R=p();if(Lp){Ft(!0);try{p()}finally{Ft(!1)}}return S.memoizedState=[R,g],R},useReducer:function(p,g,S){var R=No();if(S!==void 0){var P=S(g);if(Lp){Ft(!0);try{S(g)}finally{Ft(!1)}}}else P=g;return R.memoizedState=R.baseState=P,p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:p,lastRenderedState:P},R.queue=p,p=p.dispatch=Efe.bind(null,Pr,p),[R.memoizedState,p]},useRef:function(p){var g=No();return p={current:p},g.memoizedState=p},useState:function(p){p=hR(p);var g=p.queue,S=A8.bind(null,Pr,g);return g.dispatch=S,[p.memoizedState,S]},useDebugValue:mR,useDeferredValue:function(p,g){var S=No();return gR(S,p,g)},useTransition:function(){var p=hR(!1);return p=_8.bind(null,Pr,p.queue,!0,!1),No().memoizedState=p,[!1,p]},useSyncExternalStore:function(p,g,S){var R=Pr,P=No();if(is){if(S===void 0)throw Error(r(407));S=S()}else{if(S=g(),Ds===null)throw Error(r(349));(Yr&124)!==0||J5(R,g,S)}P.memoizedState=S;var q={value:S,getSnapshot:g};return P.queue=q,p8(e8.bind(null,R,q,p),[p]),R.flags|=2048,Hg(9,s_(),Q5.bind(null,R,q,S,g),null),S},useId:function(){var p=No(),g=Ds.identifierPrefix;if(is){var S=vd,R=bd;S=(R&~(1<<32-Yt(R)-1)).toString(32)+S,g="«"+g+"R"+S,S=t_++,0<S&&(g+="H"+S.toString(32)),g+="»"}else S=xfe++,g="«"+g+"r"+S.toString(32)+"»";return p.memoizedState=g},useHostTransitionStatus:bR,useFormState:c8,useActionState:c8,useOptimistic:function(p){var g=No();g.memoizedState=g.baseState=p;var S={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return g.queue=S,g=vR.bind(null,Pr,!0,S),S.dispatch=g,[p,g]},useMemoCache:uR,useCacheRefresh:function(){return No().memoizedState=kfe.bind(null,Pr)}},M8={readContext:Pa,use:n_,useCallback:x8,useContext:Pa,useEffect:m8,useImperativeHandle:v8,useInsertionEffect:g8,useLayoutEffect:y8,useMemo:w8,useReducer:r_,useRef:h8,useState:function(){return r_(Sd)},useDebugValue:mR,useDeferredValue:function(p,g){var S=Ii();return S8(S,_s.memoizedState,p,g)},useTransition:function(){var p=r_(Sd)[0],g=Ii().memoizedState;return[typeof p=="boolean"?p:mv(p),g]},useSyncExternalStore:X5,useId:E8,useHostTransitionStatus:bR,useFormState:u8,useActionState:u8,useOptimistic:function(p,g){var S=Ii();return r8(S,_s,p,g)},useMemoCache:uR,useCacheRefresh:T8},Tfe={readContext:Pa,use:n_,useCallback:x8,useContext:Pa,useEffect:m8,useImperativeHandle:v8,useInsertionEffect:g8,useLayoutEffect:y8,useMemo:w8,useReducer:fR,useRef:h8,useState:function(){return fR(Sd)},useDebugValue:mR,useDeferredValue:function(p,g){var S=Ii();return _s===null?gR(S,p,g):S8(S,_s.memoizedState,p,g)},useTransition:function(){var p=fR(Sd)[0],g=Ii().memoizedState;return[typeof p=="boolean"?p:mv(p),g]},useSyncExternalStore:X5,useId:E8,useHostTransitionStatus:bR,useFormState:f8,useActionState:f8,useOptimistic:function(p,g){var S=Ii();return _s!==null?r8(S,_s,p,g):(S.baseState=p,[p,S.queue.dispatch])},useMemoCache:uR,useCacheRefresh:T8},Gg=null,bv=0;function l_(p){var g=bv;return bv+=1,Gg===null&&(Gg=[]),q5(Gg,p,g)}function vv(p,g){g=g.props.ref,p.ref=g!==void 0?g:null}function c_(p,g){throw g.$$typeof===d?Error(r(525)):(p=Object.prototype.toString.call(g),Error(r(31,p==="[object Object]"?"object with keys {"+Object.keys(g).join(", ")+"}":p)))}function j8(p){var g=p._init;return g(p._payload)}function P8(p){function g(mt,it){if(p){var St=mt.deletions;St===null?(mt.deletions=[it],mt.flags|=16):St.push(it)}}function S(mt,it){if(!p)return null;for(;it!==null;)g(mt,it),it=it.sibling;return null}function R(mt){for(var it=new Map;mt!==null;)mt.key!==null?it.set(mt.key,mt):it.set(mt.index,mt),mt=mt.sibling;return it}function P(mt,it){return mt=yd(mt,it),mt.index=0,mt.sibling=null,mt}function q(mt,it,St){return mt.index=St,p?(St=mt.alternate,St!==null?(St=St.index,St<it?(mt.flags|=67108866,it):St):(mt.flags|=67108866,it)):(mt.flags|=1048576,it)}function he(mt){return p&&mt.alternate===null&&(mt.flags|=67108866),mt}function Oe(mt,it,St,Lt){return it===null||it.tag!==6?(it=$A(St,mt.mode,Lt),it.return=mt,it):(it=P(it,St),it.return=mt,it)}function Ze(mt,it,St,Lt){var Sn=St.type;return Sn===y?Dt(mt,it,St.props.children,Lt,St.key):it!==null&&(it.elementType===Sn||typeof Sn=="object"&&Sn!==null&&Sn.$$typeof===N&&j8(Sn)===it.type)?(it=P(it,St.props),vv(it,St),it.return=mt,it):(it=WS(St.type,St.key,St.props,null,mt.mode,Lt),vv(it,St),it.return=mt,it)}function _t(mt,it,St,Lt){return it===null||it.tag!==4||it.stateNode.containerInfo!==St.containerInfo||it.stateNode.implementation!==St.implementation?(it=zA(St,mt.mode,Lt),it.return=mt,it):(it=P(it,St.children||[]),it.return=mt,it)}function Dt(mt,it,St,Lt,Sn){return it===null||it.tag!==7?(it=Np(St,mt.mode,Lt,Sn),it.return=mt,it):(it=P(it,St),it.return=mt,it)}function $t(mt,it,St){if(typeof it=="string"&&it!==""||typeof it=="number"||typeof it=="bigint")return it=$A(""+it,mt.mode,St),it.return=mt,it;if(typeof it=="object"&&it!==null){switch(it.$$typeof){case h:return St=WS(it.type,it.key,it.props,null,mt.mode,St),vv(St,it),St.return=mt,St;case m:return it=zA(it,mt.mode,St),it.return=mt,it;case N:var Lt=it._init;return it=Lt(it._payload),$t(mt,it,St)}if(K(it)||D(it))return it=Np(it,mt.mode,St,null),it.return=mt,it;if(typeof it.then=="function")return $t(mt,l_(it),St);if(it.$$typeof===_)return $t(mt,YS(mt,it),St);c_(mt,it)}return null}function Et(mt,it,St,Lt){var Sn=it!==null?it.key:null;if(typeof St=="string"&&St!==""||typeof St=="number"||typeof St=="bigint")return Sn!==null?null:Oe(mt,it,""+St,Lt);if(typeof St=="object"&&St!==null){switch(St.$$typeof){case h:return St.key===Sn?Ze(mt,it,St,Lt):null;case m:return St.key===Sn?_t(mt,it,St,Lt):null;case N:return Sn=St._init,St=Sn(St._payload),Et(mt,it,St,Lt)}if(K(St)||D(St))return Sn!==null?null:Dt(mt,it,St,Lt,null);if(typeof St.then=="function")return Et(mt,it,l_(St),Lt);if(St.$$typeof===_)return Et(mt,it,YS(mt,St),Lt);c_(mt,St)}return null}function Rt(mt,it,St,Lt,Sn){if(typeof Lt=="string"&&Lt!==""||typeof Lt=="number"||typeof Lt=="bigint")return mt=mt.get(St)||null,Oe(it,mt,""+Lt,Sn);if(typeof Lt=="object"&&Lt!==null){switch(Lt.$$typeof){case h:return mt=mt.get(Lt.key===null?St:Lt.key)||null,Ze(it,mt,Lt,Sn);case m:return mt=mt.get(Lt.key===null?St:Lt.key)||null,_t(it,mt,Lt,Sn);case N:var Dr=Lt._init;return Lt=Dr(Lt._payload),Rt(mt,it,St,Lt,Sn)}if(K(Lt)||D(Lt))return mt=mt.get(St)||null,Dt(it,mt,Lt,Sn,null);if(typeof Lt.then=="function")return Rt(mt,it,St,l_(Lt),Sn);if(Lt.$$typeof===_)return Rt(mt,it,St,YS(it,Lt),Sn);c_(it,Lt)}return null}function lr(mt,it,St,Lt){for(var Sn=null,Dr=null,Fn=it,er=it=0,aa=null;Fn!==null&&er<St.length;er++){Fn.index>er?(aa=Fn,Fn=null):aa=Fn.sibling;var ns=Et(mt,Fn,St[er],Lt);if(ns===null){Fn===null&&(Fn=aa);break}p&&Fn&&ns.alternate===null&&g(mt,Fn),it=q(ns,it,er),Dr===null?Sn=ns:Dr.sibling=ns,Dr=ns,Fn=aa}if(er===St.length)return S(mt,Fn),is&&Mp(mt,er),Sn;if(Fn===null){for(;er<St.length;er++)Fn=$t(mt,St[er],Lt),Fn!==null&&(it=q(Fn,it,er),Dr===null?Sn=Fn:Dr.sibling=Fn,Dr=Fn);return is&&Mp(mt,er),Sn}for(Fn=R(Fn);er<St.length;er++)aa=Rt(Fn,mt,er,St[er],Lt),aa!==null&&(p&&aa.alternate!==null&&Fn.delete(aa.key===null?er:aa.key),it=q(aa,it,er),Dr===null?Sn=aa:Dr.sibling=aa,Dr=aa);return p&&Fn.forEach(function(lh){return g(mt,lh)}),is&&Mp(mt,er),Sn}function Zn(mt,it,St,Lt){if(St==null)throw Error(r(151));for(var Sn=null,Dr=null,Fn=it,er=it=0,aa=null,ns=St.next();Fn!==null&&!ns.done;er++,ns=St.next()){Fn.index>er?(aa=Fn,Fn=null):aa=Fn.sibling;var lh=Et(mt,Fn,ns.value,Lt);if(lh===null){Fn===null&&(Fn=aa);break}p&&Fn&&lh.alternate===null&&g(mt,Fn),it=q(lh,it,er),Dr===null?Sn=lh:Dr.sibling=lh,Dr=lh,Fn=aa}if(ns.done)return S(mt,Fn),is&&Mp(mt,er),Sn;if(Fn===null){for(;!ns.done;er++,ns=St.next())ns=$t(mt,ns.value,Lt),ns!==null&&(it=q(ns,it,er),Dr===null?Sn=ns:Dr.sibling=ns,Dr=ns);return is&&Mp(mt,er),Sn}for(Fn=R(Fn);!ns.done;er++,ns=St.next())ns=Rt(Fn,mt,er,ns.value,Lt),ns!==null&&(p&&ns.alternate!==null&&Fn.delete(ns.key===null?er:ns.key),it=q(ns,it,er),Dr===null?Sn=ns:Dr.sibling=ns,Dr=ns);return p&&Fn.forEach(function(Ahe){return g(mt,Ahe)}),is&&Mp(mt,er),Sn}function ks(mt,it,St,Lt){if(typeof St=="object"&&St!==null&&St.type===y&&St.key===null&&(St=St.props.children),typeof St=="object"&&St!==null){switch(St.$$typeof){case h:e:{for(var Sn=St.key;it!==null;){if(it.key===Sn){if(Sn=St.type,Sn===y){if(it.tag===7){S(mt,it.sibling),Lt=P(it,St.props.children),Lt.return=mt,mt=Lt;break e}}else if(it.elementType===Sn||typeof Sn=="object"&&Sn!==null&&Sn.$$typeof===N&&j8(Sn)===it.type){S(mt,it.sibling),Lt=P(it,St.props),vv(Lt,St),Lt.return=mt,mt=Lt;break e}S(mt,it);break}else g(mt,it);it=it.sibling}St.type===y?(Lt=Np(St.props.children,mt.mode,Lt,St.key),Lt.return=mt,mt=Lt):(Lt=WS(St.type,St.key,St.props,null,mt.mode,Lt),vv(Lt,St),Lt.return=mt,mt=Lt)}return he(mt);case m:e:{for(Sn=St.key;it!==null;){if(it.key===Sn)if(it.tag===4&&it.stateNode.containerInfo===St.containerInfo&&it.stateNode.implementation===St.implementation){S(mt,it.sibling),Lt=P(it,St.children||[]),Lt.return=mt,mt=Lt;break e}else{S(mt,it);break}else g(mt,it);it=it.sibling}Lt=zA(St,mt.mode,Lt),Lt.return=mt,mt=Lt}return he(mt);case N:return Sn=St._init,St=Sn(St._payload),ks(mt,it,St,Lt)}if(K(St))return lr(mt,it,St,Lt);if(D(St)){if(Sn=D(St),typeof Sn!="function")throw Error(r(150));return St=Sn.call(St),Zn(mt,it,St,Lt)}if(typeof St.then=="function")return ks(mt,it,l_(St),Lt);if(St.$$typeof===_)return ks(mt,it,YS(mt,St),Lt);c_(mt,St)}return typeof St=="string"&&St!==""||typeof St=="number"||typeof St=="bigint"?(St=""+St,it!==null&&it.tag===6?(S(mt,it.sibling),Lt=P(it,St),Lt.return=mt,mt=Lt):(S(mt,it),Lt=$A(St,mt.mode,Lt),Lt.return=mt,mt=Lt),he(mt)):S(mt,it)}return function(mt,it,St,Lt){try{bv=0;var Sn=ks(mt,it,St,Lt);return Gg=null,Sn}catch(Fn){if(Fn===cv||Fn===XS)throw Fn;var Dr=nl(29,Fn,null,mt.mode);return Dr.lanes=Lt,Dr.return=mt,Dr}finally{}}}var Kg=P8(!0),O8=P8(!1),Ol=Q(null),lu=null;function Gf(p){var g=p.alternate;re(qi,qi.current&1),re(Ol,p),lu===null&&(g===null||qg.current!==null||g.memoizedState!==null)&&(lu=p)}function D8(p){if(p.tag===22){if(re(qi,qi.current),re(Ol,p),lu===null){var g=p.alternate;g!==null&&g.memoizedState!==null&&(lu=p)}}else Kf()}function Kf(){re(qi,qi.current),re(Ol,Ol.current)}function _d(p){ee(Ol),lu===p&&(lu=null),ee(qi)}var qi=Q(0);function u_(p){for(var g=p;g!==null;){if(g.tag===13){var S=g.memoizedState;if(S!==null&&(S=S.dehydrated,S===null||S.data==="$?"||cN(S)))return g}else if(g.tag===19&&g.memoizedProps.revealOrder!==void 0){if((g.flags&128)!==0)return g}else if(g.child!==null){g.child.return=g,g=g.child;continue}if(g===p)break;for(;g.sibling===null;){if(g.return===null||g.return===p)return null;g=g.return}g.sibling.return=g.return,g=g.sibling}return null}function xR(p,g,S,R){g=p.memoizedState,S=S(R,g),S=S==null?g:u({},g,S),p.memoizedState=S,p.lanes===0&&(p.updateQueue.baseState=S)}var wR={enqueueSetState:function(p,g,S){p=p._reactInternals;var R=al(),P=Vf(R);P.payload=g,S!=null&&(P.callback=S),g=Wf(p,P,R),g!==null&&(ol(g,p,R),dv(g,p,R))},enqueueReplaceState:function(p,g,S){p=p._reactInternals;var R=al(),P=Vf(R);P.tag=1,P.payload=g,S!=null&&(P.callback=S),g=Wf(p,P,R),g!==null&&(ol(g,p,R),dv(g,p,R))},enqueueForceUpdate:function(p,g){p=p._reactInternals;var S=al(),R=Vf(S);R.tag=2,g!=null&&(R.callback=g),g=Wf(p,R,S),g!==null&&(ol(g,p,S),dv(g,p,S))}};function F8(p,g,S,R,P,q,he){return p=p.stateNode,typeof p.shouldComponentUpdate=="function"?p.shouldComponentUpdate(R,q,he):g.prototype&&g.prototype.isPureReactComponent?!M(S,R)||!M(P,q):!0}function L8(p,g,S,R){p=g.state,typeof g.componentWillReceiveProps=="function"&&g.componentWillReceiveProps(S,R),typeof g.UNSAFE_componentWillReceiveProps=="function"&&g.UNSAFE_componentWillReceiveProps(S,R),g.state!==p&&wR.enqueueReplaceState(g,g.state,null)}function Bp(p,g){var S=g;if("ref"in g){S={};for(var R in g)R!=="ref"&&(S[R]=g[R])}if(p=p.defaultProps){S===g&&(S=u({},S));for(var P in p)S[P]===void 0&&(S[P]=p[P])}return S}var d_=typeof reportError=="function"?reportError:function(p){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var g=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof p=="object"&&p!==null&&typeof p.message=="string"?String(p.message):String(p),error:p});if(!window.dispatchEvent(g))return}else if(typeof Di=="object"&&typeof Di.emit=="function"){Di.emit("uncaughtException",p);return}console.error(p)};function B8(p){d_(p)}function $8(p){console.error(p)}function z8(p){d_(p)}function f_(p,g){try{var S=p.onUncaughtError;S(g.value,{componentStack:g.stack})}catch(R){setTimeout(function(){throw R})}}function U8(p,g,S){try{var R=p.onCaughtError;R(S.value,{componentStack:S.stack,errorBoundary:g.tag===1?g.stateNode:null})}catch(P){setTimeout(function(){throw P})}}function SR(p,g,S){return S=Vf(S),S.tag=3,S.payload={element:null},S.callback=function(){f_(p,g)},S}function q8(p){return p=Vf(p),p.tag=3,p}function V8(p,g,S,R){var P=S.type.getDerivedStateFromError;if(typeof P=="function"){var q=R.value;p.payload=function(){return P(q)},p.callback=function(){U8(g,S,R)}}var he=S.stateNode;he!==null&&typeof he.componentDidCatch=="function"&&(p.callback=function(){U8(g,S,R),typeof P!="function"&&(eh===null?eh=new Set([this]):eh.add(this));var Oe=R.stack;this.componentDidCatch(R.value,{componentStack:Oe!==null?Oe:""})})}function Afe(p,g,S,R,P){if(S.flags|=32768,R!==null&&typeof R=="object"&&typeof R.then=="function"){if(g=S.alternate,g!==null&&av(g,S,P,!0),S=Ol.current,S!==null){switch(S.tag){case 13:return lu===null?HR():S.alternate===null&&li===0&&(li=3),S.flags&=-257,S.flags|=65536,S.lanes=P,R===XA?S.flags|=16384:(g=S.updateQueue,g===null?S.updateQueue=new Set([R]):g.add(R),KR(p,R,P)),!1;case 22:return S.flags|=65536,R===XA?S.flags|=16384:(g=S.updateQueue,g===null?(g={transitions:null,markerInstances:null,retryQueue:new Set([R])},S.updateQueue=g):(S=g.retryQueue,S===null?g.retryQueue=new Set([R]):S.add(R)),KR(p,R,P)),!1}throw Error(r(435,S.tag))}return KR(p,R,P),HR(),!1}if(is)return g=Ol.current,g!==null?((g.flags&65536)===0&&(g.flags|=256),g.flags|=65536,g.lanes=P,R!==VA&&(p=Error(r(422),{cause:R}),iv(qn(p,S)))):(R!==VA&&(g=Error(r(423),{cause:R}),iv(qn(g,S))),p=p.current.alternate,p.flags|=65536,P&=-P,p.lanes|=P,R=qn(R,S),P=SR(p.stateNode,R,P),eR(p,P),li!==4&&(li=2)),!1;var q=Error(r(520),{cause:R});if(q=qn(q,S),Ev===null?Ev=[q]:Ev.push(q),li!==4&&(li=2),g===null)return!0;R=qn(R,S),S=g;do{switch(S.tag){case 3:return S.flags|=65536,p=P&-P,S.lanes|=p,p=SR(S.stateNode,R,p),eR(S,p),!1;case 1:if(g=S.type,q=S.stateNode,(S.flags&128)===0&&(typeof g.getDerivedStateFromError=="function"||q!==null&&typeof q.componentDidCatch=="function"&&(eh===null||!eh.has(q))))return S.flags|=65536,P&=-P,S.lanes|=P,P=q8(P),V8(P,p,S,R),eR(S,P),!1}S=S.return}while(S!==null);return!1}var W8=Error(r(461)),sa=!1;function xa(p,g,S,R){g.child=p===null?O8(g,null,S,R):Kg(g,p.child,S,R)}function H8(p,g,S,R,P){S=S.render;var q=g.ref;if("ref"in R){var he={};for(var Oe in R)Oe!=="ref"&&(he[Oe]=R[Oe])}else he=R;return Dp(g),R=iR(p,g,S,he,q,P),Oe=aR(),p!==null&&!sa?(oR(p,g,P),Cd(p,g,P)):(is&&Oe&&UA(g),g.flags|=1,xa(p,g,R,P),g.child)}function G8(p,g,S,R,P){if(p===null){var q=S.type;return typeof q=="function"&&!BA(q)&&q.defaultProps===void 0&&S.compare===null?(g.tag=15,g.type=q,K8(p,g,q,R,P)):(p=WS(S.type,null,R,g,g.mode,P),p.ref=g.ref,p.return=g,g.child=p)}if(q=p.child,!NR(p,P)){var he=q.memoizedProps;if(S=S.compare,S=S!==null?S:M,S(he,R)&&p.ref===g.ref)return Cd(p,g,P)}return g.flags|=1,p=yd(q,R),p.ref=g.ref,p.return=g,g.child=p}function K8(p,g,S,R,P){if(p!==null){var q=p.memoizedProps;if(M(q,R)&&p.ref===g.ref)if(sa=!1,g.pendingProps=R=q,NR(p,P))(p.flags&131072)!==0&&(sa=!0);else return g.lanes=p.lanes,Cd(p,g,P)}return _R(p,g,S,R,P)}function Y8(p,g,S){var R=g.pendingProps,P=R.children,q=p!==null?p.memoizedState:null;if(R.mode==="hidden"){if((g.flags&128)!==0){if(R=q!==null?q.baseLanes|S:S,p!==null){for(P=g.child=p.child,q=0;P!==null;)q=q|P.lanes|P.childLanes,P=P.sibling;g.childLanes=q&~R}else g.childLanes=0,g.child=null;return Z8(p,g,R,S)}if((S&536870912)!==0)g.memoizedState={baseLanes:0,cachePool:null},p!==null&&ZS(g,q!==null?q.cachePool:null),q!==null?K5(g,q):nR(),D8(g);else return g.lanes=g.childLanes=536870912,Z8(p,g,q!==null?q.baseLanes|S:S,S)}else q!==null?(ZS(g,q.cachePool),K5(g,q),Kf(),g.memoizedState=null):(p!==null&&ZS(g,null),nR(),Kf());return xa(p,g,P,S),g.child}function Z8(p,g,S,R){var P=ZA();return P=P===null?null:{parent:Ui._currentValue,pool:P},g.memoizedState={baseLanes:S,cachePool:P},p!==null&&ZS(g,null),nR(),D8(g),p!==null&&av(p,g,R,!0),null}function h_(p,g){var S=g.ref;if(S===null)p!==null&&p.ref!==null&&(g.flags|=4194816);else{if(typeof S!="function"&&typeof S!="object")throw Error(r(284));(p===null||p.ref!==S)&&(g.flags|=4194816)}}function _R(p,g,S,R,P){return Dp(g),S=iR(p,g,S,R,void 0,P),R=aR(),p!==null&&!sa?(oR(p,g,P),Cd(p,g,P)):(is&&R&&UA(g),g.flags|=1,xa(p,g,S,P),g.child)}function X8(p,g,S,R,P,q){return Dp(g),g.updateQueue=null,S=Z5(g,R,S,P),Y5(p),R=aR(),p!==null&&!sa?(oR(p,g,q),Cd(p,g,q)):(is&&R&&UA(g),g.flags|=1,xa(p,g,S,q),g.child)}function J8(p,g,S,R,P){if(Dp(g),g.stateNode===null){var q=au,he=S.contextType;typeof he=="object"&&he!==null&&(q=Pa(he)),q=new S(R,q),g.memoizedState=q.state!==null&&q.state!==void 0?q.state:null,q.updater=wR,g.stateNode=q,q._reactInternals=g,q=g.stateNode,q.props=R,q.state=g.memoizedState,q.refs={},JA(g),he=S.contextType,q.context=typeof he=="object"&&he!==null?Pa(he):au,q.state=g.memoizedState,he=S.getDerivedStateFromProps,typeof he=="function"&&(xR(g,S,he,R),q.state=g.memoizedState),typeof S.getDerivedStateFromProps=="function"||typeof q.getSnapshotBeforeUpdate=="function"||typeof q.UNSAFE_componentWillMount!="function"&&typeof q.componentWillMount!="function"||(he=q.state,typeof q.componentWillMount=="function"&&q.componentWillMount(),typeof q.UNSAFE_componentWillMount=="function"&&q.UNSAFE_componentWillMount(),he!==q.state&&wR.enqueueReplaceState(q,q.state,null),hv(g,R,q,P),fv(),q.state=g.memoizedState),typeof q.componentDidMount=="function"&&(g.flags|=4194308),R=!0}else if(p===null){q=g.stateNode;var Oe=g.memoizedProps,Ze=Bp(S,Oe);q.props=Ze;var _t=q.context,Dt=S.contextType;he=au,typeof Dt=="object"&&Dt!==null&&(he=Pa(Dt));var $t=S.getDerivedStateFromProps;Dt=typeof $t=="function"||typeof q.getSnapshotBeforeUpdate=="function",Oe=g.pendingProps!==Oe,Dt||typeof q.UNSAFE_componentWillReceiveProps!="function"&&typeof q.componentWillReceiveProps!="function"||(Oe||_t!==he)&&L8(g,q,R,he),qf=!1;var Et=g.memoizedState;q.state=Et,hv(g,R,q,P),fv(),_t=g.memoizedState,Oe||Et!==_t||qf?(typeof $t=="function"&&(xR(g,S,$t,R),_t=g.memoizedState),(Ze=qf||F8(g,S,Ze,R,Et,_t,he))?(Dt||typeof q.UNSAFE_componentWillMount!="function"&&typeof q.componentWillMount!="function"||(typeof q.componentWillMount=="function"&&q.componentWillMount(),typeof q.UNSAFE_componentWillMount=="function"&&q.UNSAFE_componentWillMount()),typeof q.componentDidMount=="function"&&(g.flags|=4194308)):(typeof q.componentDidMount=="function"&&(g.flags|=4194308),g.memoizedProps=R,g.memoizedState=_t),q.props=R,q.state=_t,q.context=he,R=Ze):(typeof q.componentDidMount=="function"&&(g.flags|=4194308),R=!1)}else{q=g.stateNode,QA(p,g),he=g.memoizedProps,Dt=Bp(S,he),q.props=Dt,$t=g.pendingProps,Et=q.context,_t=S.contextType,Ze=au,typeof _t=="object"&&_t!==null&&(Ze=Pa(_t)),Oe=S.getDerivedStateFromProps,(_t=typeof Oe=="function"||typeof q.getSnapshotBeforeUpdate=="function")||typeof q.UNSAFE_componentWillReceiveProps!="function"&&typeof q.componentWillReceiveProps!="function"||(he!==$t||Et!==Ze)&&L8(g,q,R,Ze),qf=!1,Et=g.memoizedState,q.state=Et,hv(g,R,q,P),fv();var Rt=g.memoizedState;he!==$t||Et!==Rt||qf||p!==null&&p.dependencies!==null&&KS(p.dependencies)?(typeof Oe=="function"&&(xR(g,S,Oe,R),Rt=g.memoizedState),(Dt=qf||F8(g,S,Dt,R,Et,Rt,Ze)||p!==null&&p.dependencies!==null&&KS(p.dependencies))?(_t||typeof q.UNSAFE_componentWillUpdate!="function"&&typeof q.componentWillUpdate!="function"||(typeof q.componentWillUpdate=="function"&&q.componentWillUpdate(R,Rt,Ze),typeof q.UNSAFE_componentWillUpdate=="function"&&q.UNSAFE_componentWillUpdate(R,Rt,Ze)),typeof q.componentDidUpdate=="function"&&(g.flags|=4),typeof q.getSnapshotBeforeUpdate=="function"&&(g.flags|=1024)):(typeof q.componentDidUpdate!="function"||he===p.memoizedProps&&Et===p.memoizedState||(g.flags|=4),typeof q.getSnapshotBeforeUpdate!="function"||he===p.memoizedProps&&Et===p.memoizedState||(g.flags|=1024),g.memoizedProps=R,g.memoizedState=Rt),q.props=R,q.state=Rt,q.context=Ze,R=Dt):(typeof q.componentDidUpdate!="function"||he===p.memoizedProps&&Et===p.memoizedState||(g.flags|=4),typeof q.getSnapshotBeforeUpdate!="function"||he===p.memoizedProps&&Et===p.memoizedState||(g.flags|=1024),R=!1)}return q=R,h_(p,g),R=(g.flags&128)!==0,q||R?(q=g.stateNode,S=R&&typeof S.getDerivedStateFromError!="function"?null:q.render(),g.flags|=1,p!==null&&R?(g.child=Kg(g,p.child,null,P),g.child=Kg(g,null,S,P)):xa(p,g,S,P),g.memoizedState=q.state,p=g.child):p=Cd(p,g,P),p}function Q8(p,g,S,R){return sv(),g.flags|=256,xa(p,g,S,R),g.child}var CR={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function kR(p){return{baseLanes:p,cachePool:$5()}}function ER(p,g,S){return p=p!==null?p.childLanes&~S:0,g&&(p|=Dl),p}function eL(p,g,S){var R=g.pendingProps,P=!1,q=(g.flags&128)!==0,he;if((he=q)||(he=p!==null&&p.memoizedState===null?!1:(qi.current&2)!==0),he&&(P=!0,g.flags&=-129),he=(g.flags&32)!==0,g.flags&=-33,p===null){if(is){if(P?Gf(g):Kf(),is){var Oe=oi,Ze;if(Ze=Oe){e:{for(Ze=Oe,Oe=ou;Ze.nodeType!==8;){if(!Oe){Oe=null;break e}if(Ze=Sc(Ze.nextSibling),Ze===null){Oe=null;break e}}Oe=Ze}Oe!==null?(g.memoizedState={dehydrated:Oe,treeContext:Ip!==null?{id:bd,overflow:vd}:null,retryLane:536870912,hydrationErrors:null},Ze=nl(18,null,null,0),Ze.stateNode=Oe,Ze.return=g,g.child=Ze,to=g,oi=null,Ze=!0):Ze=!1}Ze||Pp(g)}if(Oe=g.memoizedState,Oe!==null&&(Oe=Oe.dehydrated,Oe!==null))return cN(Oe)?g.lanes=32:g.lanes=536870912,null;_d(g)}return Oe=R.children,R=R.fallback,P?(Kf(),P=g.mode,Oe=p_({mode:"hidden",children:Oe},P),R=Np(R,P,S,null),Oe.return=g,R.return=g,Oe.sibling=R,g.child=Oe,P=g.child,P.memoizedState=kR(S),P.childLanes=ER(p,he,S),g.memoizedState=CR,R):(Gf(g),TR(g,Oe))}if(Ze=p.memoizedState,Ze!==null&&(Oe=Ze.dehydrated,Oe!==null)){if(q)g.flags&256?(Gf(g),g.flags&=-257,g=AR(p,g,S)):g.memoizedState!==null?(Kf(),g.child=p.child,g.flags|=128,g=null):(Kf(),P=R.fallback,Oe=g.mode,R=p_({mode:"visible",children:R.children},Oe),P=Np(P,Oe,S,null),P.flags|=2,R.return=g,P.return=g,R.sibling=P,g.child=R,Kg(g,p.child,null,S),R=g.child,R.memoizedState=kR(S),R.childLanes=ER(p,he,S),g.memoizedState=CR,g=P);else if(Gf(g),cN(Oe)){if(he=Oe.nextSibling&&Oe.nextSibling.dataset,he)var _t=he.dgst;he=_t,R=Error(r(419)),R.stack="",R.digest=he,iv({value:R,source:null,stack:null}),g=AR(p,g,S)}else if(sa||av(p,g,S,!1),he=(S&p.childLanes)!==0,sa||he){if(he=Ds,he!==null&&(R=S&-S,R=(R&42)!==0?1:Ct(R),R=(R&(he.suspendedLanes|S))!==0?0:R,R!==0&&R!==Ze.retryLane))throw Ze.retryLane=R,xc(p,R),ol(he,p,R),W8;Oe.data==="$?"||HR(),g=AR(p,g,S)}else Oe.data==="$?"?(g.flags|=192,g.child=p.child,g=null):(p=Ze.treeContext,oi=Sc(Oe.nextSibling),to=g,is=!0,jp=null,ou=!1,p!==null&&(jl[Pl++]=bd,jl[Pl++]=vd,jl[Pl++]=Ip,bd=p.id,vd=p.overflow,Ip=g),g=TR(g,R.children),g.flags|=4096);return g}return P?(Kf(),P=R.fallback,Oe=g.mode,Ze=p.child,_t=Ze.sibling,R=yd(Ze,{mode:"hidden",children:R.children}),R.subtreeFlags=Ze.subtreeFlags&65011712,_t!==null?P=yd(_t,P):(P=Np(P,Oe,S,null),P.flags|=2),P.return=g,R.return=g,R.sibling=P,g.child=R,R=P,P=g.child,Oe=p.child.memoizedState,Oe===null?Oe=kR(S):(Ze=Oe.cachePool,Ze!==null?(_t=Ui._currentValue,Ze=Ze.parent!==_t?{parent:_t,pool:_t}:Ze):Ze=$5(),Oe={baseLanes:Oe.baseLanes|S,cachePool:Ze}),P.memoizedState=Oe,P.childLanes=ER(p,he,S),g.memoizedState=CR,R):(Gf(g),S=p.child,p=S.sibling,S=yd(S,{mode:"visible",children:R.children}),S.return=g,S.sibling=null,p!==null&&(he=g.deletions,he===null?(g.deletions=[p],g.flags|=16):he.push(p)),g.child=S,g.memoizedState=null,S)}function TR(p,g){return g=p_({mode:"visible",children:g},p.mode),g.return=p,p.child=g}function p_(p,g){return p=nl(22,p,null,g),p.lanes=0,p.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},p}function AR(p,g,S){return Kg(g,p.child,null,S),p=TR(g,g.pendingProps.children),p.flags|=2,g.memoizedState=null,p}function tL(p,g,S){p.lanes|=g;var R=p.alternate;R!==null&&(R.lanes|=g),HA(p.return,g,S)}function RR(p,g,S,R,P){var q=p.memoizedState;q===null?p.memoizedState={isBackwards:g,rendering:null,renderingStartTime:0,last:R,tail:S,tailMode:P}:(q.isBackwards=g,q.rendering=null,q.renderingStartTime=0,q.last=R,q.tail=S,q.tailMode=P)}function nL(p,g,S){var R=g.pendingProps,P=R.revealOrder,q=R.tail;if(xa(p,g,R.children,S),R=qi.current,(R&2)!==0)R=R&1|2,g.flags|=128;else{if(p!==null&&(p.flags&128)!==0)e:for(p=g.child;p!==null;){if(p.tag===13)p.memoizedState!==null&&tL(p,S,g);else if(p.tag===19)tL(p,S,g);else if(p.child!==null){p.child.return=p,p=p.child;continue}if(p===g)break e;for(;p.sibling===null;){if(p.return===null||p.return===g)break e;p=p.return}p.sibling.return=p.return,p=p.sibling}R&=1}switch(re(qi,R),P){case"forwards":for(S=g.child,P=null;S!==null;)p=S.alternate,p!==null&&u_(p)===null&&(P=S),S=S.sibling;S=P,S===null?(P=g.child,g.child=null):(P=S.sibling,S.sibling=null),RR(g,!1,P,S,q);break;case"backwards":for(S=null,P=g.child,g.child=null;P!==null;){if(p=P.alternate,p!==null&&u_(p)===null){g.child=P;break}p=P.sibling,P.sibling=S,S=P,P=p}RR(g,!0,S,null,q);break;case"together":RR(g,!1,null,null,void 0);break;default:g.memoizedState=null}return g.child}function Cd(p,g,S){if(p!==null&&(g.dependencies=p.dependencies),Qf|=g.lanes,(S&g.childLanes)===0)if(p!==null){if(av(p,g,S,!1),(S&g.childLanes)===0)return null}else return null;if(p!==null&&g.child!==p.child)throw Error(r(153));if(g.child!==null){for(p=g.child,S=yd(p,p.pendingProps),g.child=S,S.return=g;p.sibling!==null;)p=p.sibling,S=S.sibling=yd(p,p.pendingProps),S.return=g;S.sibling=null}return g.child}function NR(p,g){return(p.lanes&g)!==0?!0:(p=p.dependencies,!!(p!==null&&KS(p)))}function Rfe(p,g,S){switch(g.tag){case 3:Te(g,g.stateNode.containerInfo),Uf(g,Ui,p.memoizedState.cache),sv();break;case 27:case 5:Ue(g);break;case 4:Te(g,g.stateNode.containerInfo);break;case 10:Uf(g,g.type,g.memoizedProps.value);break;case 13:var R=g.memoizedState;if(R!==null)return R.dehydrated!==null?(Gf(g),g.flags|=128,null):(S&g.child.childLanes)!==0?eL(p,g,S):(Gf(g),p=Cd(p,g,S),p!==null?p.sibling:null);Gf(g);break;case 19:var P=(p.flags&128)!==0;if(R=(S&g.childLanes)!==0,R||(av(p,g,S,!1),R=(S&g.childLanes)!==0),P){if(R)return nL(p,g,S);g.flags|=128}if(P=g.memoizedState,P!==null&&(P.rendering=null,P.tail=null,P.lastEffect=null),re(qi,qi.current),R)break;return null;case 22:case 23:return g.lanes=0,Y8(p,g,S);case 24:Uf(g,Ui,p.memoizedState.cache)}return Cd(p,g,S)}function rL(p,g,S){if(p!==null)if(p.memoizedProps!==g.pendingProps)sa=!0;else{if(!NR(p,S)&&(g.flags&128)===0)return sa=!1,Rfe(p,g,S);sa=(p.flags&131072)!==0}else sa=!1,is&&(g.flags&1048576)!==0&&j5(g,GS,g.index);switch(g.lanes=0,g.tag){case 16:e:{p=g.pendingProps;var R=g.elementType,P=R._init;if(R=P(R._payload),g.type=R,typeof R=="function")BA(R)?(p=Bp(R,p),g.tag=1,g=J8(null,g,R,p,S)):(g.tag=0,g=_R(null,g,R,p,S));else{if(R!=null){if(P=R.$$typeof,P===k){g.tag=11,g=H8(null,g,R,p,S);break e}else if(P===A){g.tag=14,g=G8(null,g,R,p,S);break e}}throw g=O(R)||R,Error(r(306,g,""))}}return g;case 0:return _R(p,g,g.type,g.pendingProps,S);case 1:return R=g.type,P=Bp(R,g.pendingProps),J8(p,g,R,P,S);case 3:e:{if(Te(g,g.stateNode.containerInfo),p===null)throw Error(r(387));R=g.pendingProps;var q=g.memoizedState;P=q.element,QA(p,g),hv(g,R,null,S);var he=g.memoizedState;if(R=he.cache,Uf(g,Ui,R),R!==q.cache&&GA(g,[Ui],S,!0),fv(),R=he.element,q.isDehydrated)if(q={element:R,isDehydrated:!1,cache:he.cache},g.updateQueue.baseState=q,g.memoizedState=q,g.flags&256){g=Q8(p,g,R,S);break e}else if(R!==P){P=qn(Error(r(424)),g),iv(P),g=Q8(p,g,R,S);break e}else{switch(p=g.stateNode.containerInfo,p.nodeType){case 9:p=p.body;break;default:p=p.nodeName==="HTML"?p.ownerDocument.body:p}for(oi=Sc(p.firstChild),to=g,is=!0,jp=null,ou=!0,S=O8(g,null,R,S),g.child=S;S;)S.flags=S.flags&-3|4096,S=S.sibling}else{if(sv(),R===P){g=Cd(p,g,S);break e}xa(p,g,R,S)}g=g.child}return g;case 26:return h_(p,g),p===null?(S=oB(g.type,null,g.pendingProps,null))?g.memoizedState=S:is||(S=g.type,p=g.pendingProps,R=A_(De.current).createElement(S),R[xe]=g,R[Fe]=p,Sa(R,S,p),kr(R),g.stateNode=R):g.memoizedState=oB(g.type,p.memoizedProps,g.pendingProps,p.memoizedState),null;case 27:return Ue(g),p===null&&is&&(R=g.stateNode=sB(g.type,g.pendingProps,De.current),to=g,ou=!0,P=oi,rh(g.type)?(uN=P,oi=Sc(R.firstChild)):oi=P),xa(p,g,g.pendingProps.children,S),h_(p,g),p===null&&(g.flags|=4194304),g.child;case 5:return p===null&&is&&((P=R=oi)&&(R=rhe(R,g.type,g.pendingProps,ou),R!==null?(g.stateNode=R,to=g,oi=Sc(R.firstChild),ou=!1,P=!0):P=!1),P||Pp(g)),Ue(g),P=g.type,q=g.pendingProps,he=p!==null?p.memoizedProps:null,R=q.children,aN(P,q)?R=null:he!==null&&aN(P,he)&&(g.flags|=32),g.memoizedState!==null&&(P=iR(p,g,wfe,null,null,S),Ov._currentValue=P),h_(p,g),xa(p,g,R,S),g.child;case 6:return p===null&&is&&((p=S=oi)&&(S=she(S,g.pendingProps,ou),S!==null?(g.stateNode=S,to=g,oi=null,p=!0):p=!1),p||Pp(g)),null;case 13:return eL(p,g,S);case 4:return Te(g,g.stateNode.containerInfo),R=g.pendingProps,p===null?g.child=Kg(g,null,R,S):xa(p,g,R,S),g.child;case 11:return H8(p,g,g.type,g.pendingProps,S);case 7:return xa(p,g,g.pendingProps,S),g.child;case 8:return xa(p,g,g.pendingProps.children,S),g.child;case 12:return xa(p,g,g.pendingProps.children,S),g.child;case 10:return R=g.pendingProps,Uf(g,g.type,R.value),xa(p,g,R.children,S),g.child;case 9:return P=g.type._context,R=g.pendingProps.children,Dp(g),P=Pa(P),R=R(P),g.flags|=1,xa(p,g,R,S),g.child;case 14:return G8(p,g,g.type,g.pendingProps,S);case 15:return K8(p,g,g.type,g.pendingProps,S);case 19:return nL(p,g,S);case 31:return R=g.pendingProps,S=g.mode,R={mode:R.mode,children:R.children},p===null?(S=p_(R,S),S.ref=g.ref,g.child=S,S.return=g,g=S):(S=yd(p.child,R),S.ref=g.ref,g.child=S,S.return=g,g=S),g;case 22:return Y8(p,g,S);case 24:return Dp(g),R=Pa(Ui),p===null?(P=ZA(),P===null&&(P=Ds,q=KA(),P.pooledCache=q,q.refCount++,q!==null&&(P.pooledCacheLanes|=S),P=q),g.memoizedState={parent:R,cache:P},JA(g),Uf(g,Ui,P)):((p.lanes&S)!==0&&(QA(p,g),hv(g,null,null,S),fv()),P=p.memoizedState,q=g.memoizedState,P.parent!==R?(P={parent:R,cache:R},g.memoizedState=P,g.lanes===0&&(g.memoizedState=g.updateQueue.baseState=P),Uf(g,Ui,R)):(R=q.cache,Uf(g,Ui,R),R!==P.cache&&GA(g,[Ui],S,!0))),xa(p,g,g.pendingProps.children,S),g.child;case 29:throw g.pendingProps}throw Error(r(156,g.tag))}function kd(p){p.flags|=4}function sL(p,g){if(g.type!=="stylesheet"||(g.state.loading&4)!==0)p.flags&=-16777217;else if(p.flags|=16777216,!fB(g)){if(g=Ol.current,g!==null&&((Yr&4194048)===Yr?lu!==null:(Yr&62914560)!==Yr&&(Yr&536870912)===0||g!==lu))throw uv=XA,z5;p.flags|=8192}}function m_(p,g){g!==null&&(p.flags|=4),p.flags&16384&&(g=p.tag!==22?$():536870912,p.lanes|=g,Jg|=g)}function xv(p,g){if(!is)switch(p.tailMode){case"hidden":g=p.tail;for(var S=null;g!==null;)g.alternate!==null&&(S=g),g=g.sibling;S===null?p.tail=null:S.sibling=null;break;case"collapsed":S=p.tail;for(var R=null;S!==null;)S.alternate!==null&&(R=S),S=S.sibling;R===null?g||p.tail===null?p.tail=null:p.tail.sibling=null:R.sibling=null}}function Qs(p){var g=p.alternate!==null&&p.alternate.child===p.child,S=0,R=0;if(g)for(var P=p.child;P!==null;)S|=P.lanes|P.childLanes,R|=P.subtreeFlags&65011712,R|=P.flags&65011712,P.return=p,P=P.sibling;else for(P=p.child;P!==null;)S|=P.lanes|P.childLanes,R|=P.subtreeFlags,R|=P.flags,P.return=p,P=P.sibling;return p.subtreeFlags|=R,p.childLanes=S,g}function Nfe(p,g,S){var R=g.pendingProps;switch(qA(g),g.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Qs(g),null;case 1:return Qs(g),null;case 3:return S=g.stateNode,R=null,p!==null&&(R=p.memoizedState.cache),g.memoizedState.cache!==R&&(g.flags|=2048),wd(Ui),_e(),S.pendingContext&&(S.context=S.pendingContext,S.pendingContext=null),(p===null||p.child===null)&&(rv(g)?kd(g):p===null||p.memoizedState.isDehydrated&&(g.flags&256)===0||(g.flags|=1024,D5())),Qs(g),null;case 26:return S=g.memoizedState,p===null?(kd(g),S!==null?(Qs(g),sL(g,S)):(Qs(g),g.flags&=-16777217)):S?S!==p.memoizedState?(kd(g),Qs(g),sL(g,S)):(Qs(g),g.flags&=-16777217):(p.memoizedProps!==R&&kd(g),Qs(g),g.flags&=-16777217),null;case 27:Qe(g),S=De.current;var P=g.type;if(p!==null&&g.stateNode!=null)p.memoizedProps!==R&&kd(g);else{if(!R){if(g.stateNode===null)throw Error(r(166));return Qs(g),null}p=de.current,rv(g)?P5(g):(p=sB(P,R,S),g.stateNode=p,kd(g))}return Qs(g),null;case 5:if(Qe(g),S=g.type,p!==null&&g.stateNode!=null)p.memoizedProps!==R&&kd(g);else{if(!R){if(g.stateNode===null)throw Error(r(166));return Qs(g),null}if(p=de.current,rv(g))P5(g);else{switch(P=A_(De.current),p){case 1:p=P.createElementNS("http://www.w3.org/2000/svg",S);break;case 2:p=P.createElementNS("http://www.w3.org/1998/Math/MathML",S);break;default:switch(S){case"svg":p=P.createElementNS("http://www.w3.org/2000/svg",S);break;case"math":p=P.createElementNS("http://www.w3.org/1998/Math/MathML",S);break;case"script":p=P.createElement("div"),p.innerHTML="<script><\/script>",p=p.removeChild(p.firstChild);break;case"select":p=typeof R.is=="string"?P.createElement("select",{is:R.is}):P.createElement("select"),R.multiple?p.multiple=!0:R.size&&(p.size=R.size);break;default:p=typeof R.is=="string"?P.createElement(S,{is:R.is}):P.createElement(S)}}p[xe]=g,p[Fe]=R;e:for(P=g.child;P!==null;){if(P.tag===5||P.tag===6)p.appendChild(P.stateNode);else if(P.tag!==4&&P.tag!==27&&P.child!==null){P.child.return=P,P=P.child;continue}if(P===g)break e;for(;P.sibling===null;){if(P.return===null||P.return===g)break e;P=P.return}P.sibling.return=P.return,P=P.sibling}g.stateNode=p;e:switch(Sa(p,S,R),S){case"button":case"input":case"select":case"textarea":p=!!R.autoFocus;break e;case"img":p=!0;break e;default:p=!1}p&&kd(g)}}return Qs(g),g.flags&=-16777217,null;case 6:if(p&&g.stateNode!=null)p.memoizedProps!==R&&kd(g);else{if(typeof R!="string"&&g.stateNode===null)throw Error(r(166));if(p=De.current,rv(g)){if(p=g.stateNode,S=g.memoizedProps,R=null,P=to,P!==null)switch(P.tag){case 27:case 5:R=P.memoizedProps}p[xe]=g,p=!!(p.nodeValue===S||R!==null&&R.suppressHydrationWarning===!0||XL(p.nodeValue,S)),p||Pp(g)}else p=A_(p).createTextNode(R),p[xe]=g,g.stateNode=p}return Qs(g),null;case 13:if(R=g.memoizedState,p===null||p.memoizedState!==null&&p.memoizedState.dehydrated!==null){if(P=rv(g),R!==null&&R.dehydrated!==null){if(p===null){if(!P)throw Error(r(318));if(P=g.memoizedState,P=P!==null?P.dehydrated:null,!P)throw Error(r(317));P[xe]=g}else sv(),(g.flags&128)===0&&(g.memoizedState=null),g.flags|=4;Qs(g),P=!1}else P=D5(),p!==null&&p.memoizedState!==null&&(p.memoizedState.hydrationErrors=P),P=!0;if(!P)return g.flags&256?(_d(g),g):(_d(g),null)}if(_d(g),(g.flags&128)!==0)return g.lanes=S,g;if(S=R!==null,p=p!==null&&p.memoizedState!==null,S){R=g.child,P=null,R.alternate!==null&&R.alternate.memoizedState!==null&&R.alternate.memoizedState.cachePool!==null&&(P=R.alternate.memoizedState.cachePool.pool);var q=null;R.memoizedState!==null&&R.memoizedState.cachePool!==null&&(q=R.memoizedState.cachePool.pool),q!==P&&(R.flags|=2048)}return S!==p&&S&&(g.child.flags|=8192),m_(g,g.updateQueue),Qs(g),null;case 4:return _e(),p===null&&tN(g.stateNode.containerInfo),Qs(g),null;case 10:return wd(g.type),Qs(g),null;case 19:if(ee(qi),P=g.memoizedState,P===null)return Qs(g),null;if(R=(g.flags&128)!==0,q=P.rendering,q===null)if(R)xv(P,!1);else{if(li!==0||p!==null&&(p.flags&128)!==0)for(p=g.child;p!==null;){if(q=u_(p),q!==null){for(g.flags|=128,xv(P,!1),p=q.updateQueue,g.updateQueue=p,m_(g,p),g.subtreeFlags=0,p=S,S=g.child;S!==null;)M5(S,p),S=S.sibling;return re(qi,qi.current&1|2),g.child}p=p.sibling}P.tail!==null&&ue()>b_&&(g.flags|=128,R=!0,xv(P,!1),g.lanes=4194304)}else{if(!R)if(p=u_(q),p!==null){if(g.flags|=128,R=!0,p=p.updateQueue,g.updateQueue=p,m_(g,p),xv(P,!0),P.tail===null&&P.tailMode==="hidden"&&!q.alternate&&!is)return Qs(g),null}else 2*ue()-P.renderingStartTime>b_&&S!==536870912&&(g.flags|=128,R=!0,xv(P,!1),g.lanes=4194304);P.isBackwards?(q.sibling=g.child,g.child=q):(p=P.last,p!==null?p.sibling=q:g.child=q,P.last=q)}return P.tail!==null?(g=P.tail,P.rendering=g,P.tail=g.sibling,P.renderingStartTime=ue(),g.sibling=null,p=qi.current,re(qi,R?p&1|2:p&1),g):(Qs(g),null);case 22:case 23:return _d(g),rR(),R=g.memoizedState!==null,p!==null?p.memoizedState!==null!==R&&(g.flags|=8192):R&&(g.flags|=8192),R?(S&536870912)!==0&&(g.flags&128)===0&&(Qs(g),g.subtreeFlags&6&&(g.flags|=8192)):Qs(g),S=g.updateQueue,S!==null&&m_(g,S.retryQueue),S=null,p!==null&&p.memoizedState!==null&&p.memoizedState.cachePool!==null&&(S=p.memoizedState.cachePool.pool),R=null,g.memoizedState!==null&&g.memoizedState.cachePool!==null&&(R=g.memoizedState.cachePool.pool),R!==S&&(g.flags|=2048),p!==null&&ee(Fp),null;case 24:return S=null,p!==null&&(S=p.memoizedState.cache),g.memoizedState.cache!==S&&(g.flags|=2048),wd(Ui),Qs(g),null;case 25:return null;case 30:return null}throw Error(r(156,g.tag))}function Ife(p,g){switch(qA(g),g.tag){case 1:return p=g.flags,p&65536?(g.flags=p&-65537|128,g):null;case 3:return wd(Ui),_e(),p=g.flags,(p&65536)!==0&&(p&128)===0?(g.flags=p&-65537|128,g):null;case 26:case 27:case 5:return Qe(g),null;case 13:if(_d(g),p=g.memoizedState,p!==null&&p.dehydrated!==null){if(g.alternate===null)throw Error(r(340));sv()}return p=g.flags,p&65536?(g.flags=p&-65537|128,g):null;case 19:return ee(qi),null;case 4:return _e(),null;case 10:return wd(g.type),null;case 22:case 23:return _d(g),rR(),p!==null&&ee(Fp),p=g.flags,p&65536?(g.flags=p&-65537|128,g):null;case 24:return wd(Ui),null;case 25:return null;default:return null}}function iL(p,g){switch(qA(g),g.tag){case 3:wd(Ui),_e();break;case 26:case 27:case 5:Qe(g);break;case 4:_e();break;case 13:_d(g);break;case 19:ee(qi);break;case 10:wd(g.type);break;case 22:case 23:_d(g),rR(),p!==null&&ee(Fp);break;case 24:wd(Ui)}}function wv(p,g){try{var S=g.updateQueue,R=S!==null?S.lastEffect:null;if(R!==null){var P=R.next;S=P;do{if((S.tag&p)===p){R=void 0;var q=S.create,he=S.inst;R=q(),he.destroy=R}S=S.next}while(S!==P)}}catch(Oe){Ms(g,g.return,Oe)}}function Yf(p,g,S){try{var R=g.updateQueue,P=R!==null?R.lastEffect:null;if(P!==null){var q=P.next;R=q;do{if((R.tag&p)===p){var he=R.inst,Oe=he.destroy;if(Oe!==void 0){he.destroy=void 0,P=g;var Ze=S,_t=Oe;try{_t()}catch(Dt){Ms(P,Ze,Dt)}}}R=R.next}while(R!==q)}}catch(Dt){Ms(g,g.return,Dt)}}function aL(p){var g=p.updateQueue;if(g!==null){var S=p.stateNode;try{G5(g,S)}catch(R){Ms(p,p.return,R)}}}function oL(p,g,S){S.props=Bp(p.type,p.memoizedProps),S.state=p.memoizedState;try{S.componentWillUnmount()}catch(R){Ms(p,g,R)}}function Sv(p,g){try{var S=p.ref;if(S!==null){switch(p.tag){case 26:case 27:case 5:var R=p.stateNode;break;case 30:R=p.stateNode;break;default:R=p.stateNode}typeof S=="function"?p.refCleanup=S(R):S.current=R}}catch(P){Ms(p,g,P)}}function cu(p,g){var S=p.ref,R=p.refCleanup;if(S!==null)if(typeof R=="function")try{R()}catch(P){Ms(p,g,P)}finally{p.refCleanup=null,p=p.alternate,p!=null&&(p.refCleanup=null)}else if(typeof S=="function")try{S(null)}catch(P){Ms(p,g,P)}else S.current=null}function lL(p){var g=p.type,S=p.memoizedProps,R=p.stateNode;try{e:switch(g){case"button":case"input":case"select":case"textarea":S.autoFocus&&R.focus();break e;case"img":S.src?R.src=S.src:S.srcSet&&(R.srcset=S.srcSet)}}catch(P){Ms(p,p.return,P)}}function IR(p,g,S){try{var R=p.stateNode;Jfe(R,p.type,S,g),R[Fe]=g}catch(P){Ms(p,p.return,P)}}function cL(p){return p.tag===5||p.tag===3||p.tag===26||p.tag===27&&rh(p.type)||p.tag===4}function MR(p){e:for(;;){for(;p.sibling===null;){if(p.return===null||cL(p.return))return null;p=p.return}for(p.sibling.return=p.return,p=p.sibling;p.tag!==5&&p.tag!==6&&p.tag!==18;){if(p.tag===27&&rh(p.type)||p.flags&2||p.child===null||p.tag===4)continue e;p.child.return=p,p=p.child}if(!(p.flags&2))return p.stateNode}}function jR(p,g,S){var R=p.tag;if(R===5||R===6)p=p.stateNode,g?(S.nodeType===9?S.body:S.nodeName==="HTML"?S.ownerDocument.body:S).insertBefore(p,g):(g=S.nodeType===9?S.body:S.nodeName==="HTML"?S.ownerDocument.body:S,g.appendChild(p),S=S._reactRootContainer,S!=null||g.onclick!==null||(g.onclick=T_));else if(R!==4&&(R===27&&rh(p.type)&&(S=p.stateNode,g=null),p=p.child,p!==null))for(jR(p,g,S),p=p.sibling;p!==null;)jR(p,g,S),p=p.sibling}function g_(p,g,S){var R=p.tag;if(R===5||R===6)p=p.stateNode,g?S.insertBefore(p,g):S.appendChild(p);else if(R!==4&&(R===27&&rh(p.type)&&(S=p.stateNode),p=p.child,p!==null))for(g_(p,g,S),p=p.sibling;p!==null;)g_(p,g,S),p=p.sibling}function uL(p){var g=p.stateNode,S=p.memoizedProps;try{for(var R=p.type,P=g.attributes;P.length;)g.removeAttributeNode(P[0]);Sa(g,R,S),g[xe]=p,g[Fe]=S}catch(q){Ms(p,p.return,q)}}var Ed=!1,mi=!1,PR=!1,dL=typeof WeakSet=="function"?WeakSet:Set,ia=null;function Mfe(p,g){if(p=p.containerInfo,sN=P_,p=pe(p),Ne(p)){if("selectionStart"in p)var S={start:p.selectionStart,end:p.selectionEnd};else e:{S=(S=p.ownerDocument)&&S.defaultView||window;var R=S.getSelection&&S.getSelection();if(R&&R.rangeCount!==0){S=R.anchorNode;var P=R.anchorOffset,q=R.focusNode;R=R.focusOffset;try{S.nodeType,q.nodeType}catch{S=null;break e}var he=0,Oe=-1,Ze=-1,_t=0,Dt=0,$t=p,Et=null;t:for(;;){for(var Rt;$t!==S||P!==0&&$t.nodeType!==3||(Oe=he+P),$t!==q||R!==0&&$t.nodeType!==3||(Ze=he+R),$t.nodeType===3&&(he+=$t.nodeValue.length),(Rt=$t.firstChild)!==null;)Et=$t,$t=Rt;for(;;){if($t===p)break t;if(Et===S&&++_t===P&&(Oe=he),Et===q&&++Dt===R&&(Ze=he),(Rt=$t.nextSibling)!==null)break;$t=Et,Et=$t.parentNode}$t=Rt}S=Oe===-1||Ze===-1?null:{start:Oe,end:Ze}}else S=null}S=S||{start:0,end:0}}else S=null;for(iN={focusedElem:p,selectionRange:S},P_=!1,ia=g;ia!==null;)if(g=ia,p=g.child,(g.subtreeFlags&1024)!==0&&p!==null)p.return=g,ia=p;else for(;ia!==null;){switch(g=ia,q=g.alternate,p=g.flags,g.tag){case 0:break;case 11:case 15:break;case 1:if((p&1024)!==0&&q!==null){p=void 0,S=g,P=q.memoizedProps,q=q.memoizedState,R=S.stateNode;try{var lr=Bp(S.type,P,S.elementType===S.type);p=R.getSnapshotBeforeUpdate(lr,q),R.__reactInternalSnapshotBeforeUpdate=p}catch(Zn){Ms(S,S.return,Zn)}}break;case 3:if((p&1024)!==0){if(p=g.stateNode.containerInfo,S=p.nodeType,S===9)lN(p);else if(S===1)switch(p.nodeName){case"HEAD":case"HTML":case"BODY":lN(p);break;default:p.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((p&1024)!==0)throw Error(r(163))}if(p=g.sibling,p!==null){p.return=g.return,ia=p;break}ia=g.return}}function fL(p,g,S){var R=S.flags;switch(S.tag){case 0:case 11:case 15:Zf(p,S),R&4&&wv(5,S);break;case 1:if(Zf(p,S),R&4)if(p=S.stateNode,g===null)try{p.componentDidMount()}catch(he){Ms(S,S.return,he)}else{var P=Bp(S.type,g.memoizedProps);g=g.memoizedState;try{p.componentDidUpdate(P,g,p.__reactInternalSnapshotBeforeUpdate)}catch(he){Ms(S,S.return,he)}}R&64&&aL(S),R&512&&Sv(S,S.return);break;case 3:if(Zf(p,S),R&64&&(p=S.updateQueue,p!==null)){if(g=null,S.child!==null)switch(S.child.tag){case 27:case 5:g=S.child.stateNode;break;case 1:g=S.child.stateNode}try{G5(p,g)}catch(he){Ms(S,S.return,he)}}break;case 27:g===null&&R&4&&uL(S);case 26:case 5:Zf(p,S),g===null&&R&4&&lL(S),R&512&&Sv(S,S.return);break;case 12:Zf(p,S);break;case 13:Zf(p,S),R&4&&mL(p,S),R&64&&(p=S.memoizedState,p!==null&&(p=p.dehydrated,p!==null&&(S=zfe.bind(null,S),ihe(p,S))));break;case 22:if(R=S.memoizedState!==null||Ed,!R){g=g!==null&&g.memoizedState!==null||mi,P=Ed;var q=mi;Ed=R,(mi=g)&&!q?Xf(p,S,(S.subtreeFlags&8772)!==0):Zf(p,S),Ed=P,mi=q}break;case 30:break;default:Zf(p,S)}}function hL(p){var g=p.alternate;g!==null&&(p.alternate=null,hL(g)),p.child=null,p.deletions=null,p.sibling=null,p.tag===5&&(g=p.stateNode,g!==null&&fn(g)),p.stateNode=null,p.return=null,p.dependencies=null,p.memoizedProps=null,p.memoizedState=null,p.pendingProps=null,p.stateNode=null,p.updateQueue=null}var Ks=null,Io=!1;function Td(p,g,S){for(S=S.child;S!==null;)pL(p,g,S),S=S.sibling}function pL(p,g,S){if(Ut&&typeof Ut.onCommitFiberUnmount=="function")try{Ut.onCommitFiberUnmount(Pt,S)}catch{}switch(S.tag){case 26:mi||cu(S,g),Td(p,g,S),S.memoizedState?S.memoizedState.count--:S.stateNode&&(S=S.stateNode,S.parentNode.removeChild(S));break;case 27:mi||cu(S,g);var R=Ks,P=Io;rh(S.type)&&(Ks=S.stateNode,Io=!1),Td(p,g,S),Iv(S.stateNode),Ks=R,Io=P;break;case 5:mi||cu(S,g);case 6:if(R=Ks,P=Io,Ks=null,Td(p,g,S),Ks=R,Io=P,Ks!==null)if(Io)try{(Ks.nodeType===9?Ks.body:Ks.nodeName==="HTML"?Ks.ownerDocument.body:Ks).removeChild(S.stateNode)}catch(q){Ms(S,g,q)}else try{Ks.removeChild(S.stateNode)}catch(q){Ms(S,g,q)}break;case 18:Ks!==null&&(Io?(p=Ks,nB(p.nodeType===9?p.body:p.nodeName==="HTML"?p.ownerDocument.body:p,S.stateNode),Bv(p)):nB(Ks,S.stateNode));break;case 4:R=Ks,P=Io,Ks=S.stateNode.containerInfo,Io=!0,Td(p,g,S),Ks=R,Io=P;break;case 0:case 11:case 14:case 15:mi||Yf(2,S,g),mi||Yf(4,S,g),Td(p,g,S);break;case 1:mi||(cu(S,g),R=S.stateNode,typeof R.componentWillUnmount=="function"&&oL(S,g,R)),Td(p,g,S);break;case 21:Td(p,g,S);break;case 22:mi=(R=mi)||S.memoizedState!==null,Td(p,g,S),mi=R;break;default:Td(p,g,S)}}function mL(p,g){if(g.memoizedState===null&&(p=g.alternate,p!==null&&(p=p.memoizedState,p!==null&&(p=p.dehydrated,p!==null))))try{Bv(p)}catch(S){Ms(g,g.return,S)}}function jfe(p){switch(p.tag){case 13:case 19:var g=p.stateNode;return g===null&&(g=p.stateNode=new dL),g;case 22:return p=p.stateNode,g=p._retryCache,g===null&&(g=p._retryCache=new dL),g;default:throw Error(r(435,p.tag))}}function OR(p,g){var S=jfe(p);g.forEach(function(R){var P=Ufe.bind(null,p,R);S.has(R)||(S.add(R),R.then(P,P))})}function rl(p,g){var S=g.deletions;if(S!==null)for(var R=0;R<S.length;R++){var P=S[R],q=p,he=g,Oe=he;e:for(;Oe!==null;){switch(Oe.tag){case 27:if(rh(Oe.type)){Ks=Oe.stateNode,Io=!1;break e}break;case 5:Ks=Oe.stateNode,Io=!1;break e;case 3:case 4:Ks=Oe.stateNode.containerInfo,Io=!0;break e}Oe=Oe.return}if(Ks===null)throw Error(r(160));pL(q,he,P),Ks=null,Io=!1,q=P.alternate,q!==null&&(q.return=null),P.return=null}if(g.subtreeFlags&13878)for(g=g.child;g!==null;)gL(g,p),g=g.sibling}var wc=null;function gL(p,g){var S=p.alternate,R=p.flags;switch(p.tag){case 0:case 11:case 14:case 15:rl(g,p),sl(p),R&4&&(Yf(3,p,p.return),wv(3,p),Yf(5,p,p.return));break;case 1:rl(g,p),sl(p),R&512&&(mi||S===null||cu(S,S.return)),R&64&&Ed&&(p=p.updateQueue,p!==null&&(R=p.callbacks,R!==null&&(S=p.shared.hiddenCallbacks,p.shared.hiddenCallbacks=S===null?R:S.concat(R))));break;case 26:var P=wc;if(rl(g,p),sl(p),R&512&&(mi||S===null||cu(S,S.return)),R&4){var q=S!==null?S.memoizedState:null;if(R=p.memoizedState,S===null)if(R===null)if(p.stateNode===null){e:{R=p.type,S=p.memoizedProps,P=P.ownerDocument||P;t:switch(R){case"title":q=P.getElementsByTagName("title")[0],(!q||q[rn]||q[xe]||q.namespaceURI==="http://www.w3.org/2000/svg"||q.hasAttribute("itemprop"))&&(q=P.createElement(R),P.head.insertBefore(q,P.querySelector("head > title"))),Sa(q,R,S),q[xe]=p,kr(q),R=q;break e;case"link":var he=uB("link","href",P).get(R+(S.href||""));if(he){for(var Oe=0;Oe<he.length;Oe++)if(q=he[Oe],q.getAttribute("href")===(S.href==null||S.href===""?null:S.href)&&q.getAttribute("rel")===(S.rel==null?null:S.rel)&&q.getAttribute("title")===(S.title==null?null:S.title)&&q.getAttribute("crossorigin")===(S.crossOrigin==null?null:S.crossOrigin)){he.splice(Oe,1);break t}}q=P.createElement(R),Sa(q,R,S),P.head.appendChild(q);break;case"meta":if(he=uB("meta","content",P).get(R+(S.content||""))){for(Oe=0;Oe<he.length;Oe++)if(q=he[Oe],q.getAttribute("content")===(S.content==null?null:""+S.content)&&q.getAttribute("name")===(S.name==null?null:S.name)&&q.getAttribute("property")===(S.property==null?null:S.property)&&q.getAttribute("http-equiv")===(S.httpEquiv==null?null:S.httpEquiv)&&q.getAttribute("charset")===(S.charSet==null?null:S.charSet)){he.splice(Oe,1);break t}}q=P.createElement(R),Sa(q,R,S),P.head.appendChild(q);break;default:throw Error(r(468,R))}q[xe]=p,kr(q),R=q}p.stateNode=R}else dB(P,p.type,p.stateNode);else p.stateNode=cB(P,R,p.memoizedProps);else q!==R?(q===null?S.stateNode!==null&&(S=S.stateNode,S.parentNode.removeChild(S)):q.count--,R===null?dB(P,p.type,p.stateNode):cB(P,R,p.memoizedProps)):R===null&&p.stateNode!==null&&IR(p,p.memoizedProps,S.memoizedProps)}break;case 27:rl(g,p),sl(p),R&512&&(mi||S===null||cu(S,S.return)),S!==null&&R&4&&IR(p,p.memoizedProps,S.memoizedProps);break;case 5:if(rl(g,p),sl(p),R&512&&(mi||S===null||cu(S,S.return)),p.flags&32){P=p.stateNode;try{Mf(P,"")}catch(Rt){Ms(p,p.return,Rt)}}R&4&&p.stateNode!=null&&(P=p.memoizedProps,IR(p,P,S!==null?S.memoizedProps:P)),R&1024&&(PR=!0);break;case 6:if(rl(g,p),sl(p),R&4){if(p.stateNode===null)throw Error(r(162));R=p.memoizedProps,S=p.stateNode;try{S.nodeValue=R}catch(Rt){Ms(p,p.return,Rt)}}break;case 3:if(I_=null,P=wc,wc=R_(g.containerInfo),rl(g,p),wc=P,sl(p),R&4&&S!==null&&S.memoizedState.isDehydrated)try{Bv(g.containerInfo)}catch(Rt){Ms(p,p.return,Rt)}PR&&(PR=!1,yL(p));break;case 4:R=wc,wc=R_(p.stateNode.containerInfo),rl(g,p),sl(p),wc=R;break;case 12:rl(g,p),sl(p);break;case 13:rl(g,p),sl(p),p.child.flags&8192&&p.memoizedState!==null!=(S!==null&&S.memoizedState!==null)&&(zR=ue()),R&4&&(R=p.updateQueue,R!==null&&(p.updateQueue=null,OR(p,R)));break;case 22:P=p.memoizedState!==null;var Ze=S!==null&&S.memoizedState!==null,_t=Ed,Dt=mi;if(Ed=_t||P,mi=Dt||Ze,rl(g,p),mi=Dt,Ed=_t,sl(p),R&8192)e:for(g=p.stateNode,g._visibility=P?g._visibility&-2:g._visibility|1,P&&(S===null||Ze||Ed||mi||$p(p)),S=null,g=p;;){if(g.tag===5||g.tag===26){if(S===null){Ze=S=g;try{if(q=Ze.stateNode,P)he=q.style,typeof he.setProperty=="function"?he.setProperty("display","none","important"):he.display="none";else{Oe=Ze.stateNode;var $t=Ze.memoizedProps.style,Et=$t!=null&&$t.hasOwnProperty("display")?$t.display:null;Oe.style.display=Et==null||typeof Et=="boolean"?"":(""+Et).trim()}}catch(Rt){Ms(Ze,Ze.return,Rt)}}}else if(g.tag===6){if(S===null){Ze=g;try{Ze.stateNode.nodeValue=P?"":Ze.memoizedProps}catch(Rt){Ms(Ze,Ze.return,Rt)}}}else if((g.tag!==22&&g.tag!==23||g.memoizedState===null||g===p)&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===p)break e;for(;g.sibling===null;){if(g.return===null||g.return===p)break e;S===g&&(S=null),g=g.return}S===g&&(S=null),g.sibling.return=g.return,g=g.sibling}R&4&&(R=p.updateQueue,R!==null&&(S=R.retryQueue,S!==null&&(R.retryQueue=null,OR(p,S))));break;case 19:rl(g,p),sl(p),R&4&&(R=p.updateQueue,R!==null&&(p.updateQueue=null,OR(p,R)));break;case 30:break;case 21:break;default:rl(g,p),sl(p)}}function sl(p){var g=p.flags;if(g&2){try{for(var S,R=p.return;R!==null;){if(cL(R)){S=R;break}R=R.return}if(S==null)throw Error(r(160));switch(S.tag){case 27:var P=S.stateNode,q=MR(p);g_(p,q,P);break;case 5:var he=S.stateNode;S.flags&32&&(Mf(he,""),S.flags&=-33);var Oe=MR(p);g_(p,Oe,he);break;case 3:case 4:var Ze=S.stateNode.containerInfo,_t=MR(p);jR(p,_t,Ze);break;default:throw Error(r(161))}}catch(Dt){Ms(p,p.return,Dt)}p.flags&=-3}g&4096&&(p.flags&=-4097)}function yL(p){if(p.subtreeFlags&1024)for(p=p.child;p!==null;){var g=p;yL(g),g.tag===5&&g.flags&1024&&g.stateNode.reset(),p=p.sibling}}function Zf(p,g){if(g.subtreeFlags&8772)for(g=g.child;g!==null;)fL(p,g.alternate,g),g=g.sibling}function $p(p){for(p=p.child;p!==null;){var g=p;switch(g.tag){case 0:case 11:case 14:case 15:Yf(4,g,g.return),$p(g);break;case 1:cu(g,g.return);var S=g.stateNode;typeof S.componentWillUnmount=="function"&&oL(g,g.return,S),$p(g);break;case 27:Iv(g.stateNode);case 26:case 5:cu(g,g.return),$p(g);break;case 22:g.memoizedState===null&&$p(g);break;case 30:$p(g);break;default:$p(g)}p=p.sibling}}function Xf(p,g,S){for(S=S&&(g.subtreeFlags&8772)!==0,g=g.child;g!==null;){var R=g.alternate,P=p,q=g,he=q.flags;switch(q.tag){case 0:case 11:case 15:Xf(P,q,S),wv(4,q);break;case 1:if(Xf(P,q,S),R=q,P=R.stateNode,typeof P.componentDidMount=="function")try{P.componentDidMount()}catch(_t){Ms(R,R.return,_t)}if(R=q,P=R.updateQueue,P!==null){var Oe=R.stateNode;try{var Ze=P.shared.hiddenCallbacks;if(Ze!==null)for(P.shared.hiddenCallbacks=null,P=0;P<Ze.length;P++)H5(Ze[P],Oe)}catch(_t){Ms(R,R.return,_t)}}S&&he&64&&aL(q),Sv(q,q.return);break;case 27:uL(q);case 26:case 5:Xf(P,q,S),S&&R===null&&he&4&&lL(q),Sv(q,q.return);break;case 12:Xf(P,q,S);break;case 13:Xf(P,q,S),S&&he&4&&mL(P,q);break;case 22:q.memoizedState===null&&Xf(P,q,S),Sv(q,q.return);break;case 30:break;default:Xf(P,q,S)}g=g.sibling}}function DR(p,g){var S=null;p!==null&&p.memoizedState!==null&&p.memoizedState.cachePool!==null&&(S=p.memoizedState.cachePool.pool),p=null,g.memoizedState!==null&&g.memoizedState.cachePool!==null&&(p=g.memoizedState.cachePool.pool),p!==S&&(p!=null&&p.refCount++,S!=null&&ov(S))}function FR(p,g){p=null,g.alternate!==null&&(p=g.alternate.memoizedState.cache),g=g.memoizedState.cache,g!==p&&(g.refCount++,p!=null&&ov(p))}function uu(p,g,S,R){if(g.subtreeFlags&10256)for(g=g.child;g!==null;)bL(p,g,S,R),g=g.sibling}function bL(p,g,S,R){var P=g.flags;switch(g.tag){case 0:case 11:case 15:uu(p,g,S,R),P&2048&&wv(9,g);break;case 1:uu(p,g,S,R);break;case 3:uu(p,g,S,R),P&2048&&(p=null,g.alternate!==null&&(p=g.alternate.memoizedState.cache),g=g.memoizedState.cache,g!==p&&(g.refCount++,p!=null&&ov(p)));break;case 12:if(P&2048){uu(p,g,S,R),p=g.stateNode;try{var q=g.memoizedProps,he=q.id,Oe=q.onPostCommit;typeof Oe=="function"&&Oe(he,g.alternate===null?"mount":"update",p.passiveEffectDuration,-0)}catch(Ze){Ms(g,g.return,Ze)}}else uu(p,g,S,R);break;case 13:uu(p,g,S,R);break;case 23:break;case 22:q=g.stateNode,he=g.alternate,g.memoizedState!==null?q._visibility&2?uu(p,g,S,R):_v(p,g):q._visibility&2?uu(p,g,S,R):(q._visibility|=2,Yg(p,g,S,R,(g.subtreeFlags&10256)!==0)),P&2048&&DR(he,g);break;case 24:uu(p,g,S,R),P&2048&&FR(g.alternate,g);break;default:uu(p,g,S,R)}}function Yg(p,g,S,R,P){for(P=P&&(g.subtreeFlags&10256)!==0,g=g.child;g!==null;){var q=p,he=g,Oe=S,Ze=R,_t=he.flags;switch(he.tag){case 0:case 11:case 15:Yg(q,he,Oe,Ze,P),wv(8,he);break;case 23:break;case 22:var Dt=he.stateNode;he.memoizedState!==null?Dt._visibility&2?Yg(q,he,Oe,Ze,P):_v(q,he):(Dt._visibility|=2,Yg(q,he,Oe,Ze,P)),P&&_t&2048&&DR(he.alternate,he);break;case 24:Yg(q,he,Oe,Ze,P),P&&_t&2048&&FR(he.alternate,he);break;default:Yg(q,he,Oe,Ze,P)}g=g.sibling}}function _v(p,g){if(g.subtreeFlags&10256)for(g=g.child;g!==null;){var S=p,R=g,P=R.flags;switch(R.tag){case 22:_v(S,R),P&2048&&DR(R.alternate,R);break;case 24:_v(S,R),P&2048&&FR(R.alternate,R);break;default:_v(S,R)}g=g.sibling}}var Cv=8192;function Zg(p){if(p.subtreeFlags&Cv)for(p=p.child;p!==null;)vL(p),p=p.sibling}function vL(p){switch(p.tag){case 26:Zg(p),p.flags&Cv&&p.memoizedState!==null&&bhe(wc,p.memoizedState,p.memoizedProps);break;case 5:Zg(p);break;case 3:case 4:var g=wc;wc=R_(p.stateNode.containerInfo),Zg(p),wc=g;break;case 22:p.memoizedState===null&&(g=p.alternate,g!==null&&g.memoizedState!==null?(g=Cv,Cv=16777216,Zg(p),Cv=g):Zg(p));break;default:Zg(p)}}function xL(p){var g=p.alternate;if(g!==null&&(p=g.child,p!==null)){g.child=null;do g=p.sibling,p.sibling=null,p=g;while(p!==null)}}function kv(p){var g=p.deletions;if((p.flags&16)!==0){if(g!==null)for(var S=0;S<g.length;S++){var R=g[S];ia=R,SL(R,p)}xL(p)}if(p.subtreeFlags&10256)for(p=p.child;p!==null;)wL(p),p=p.sibling}function wL(p){switch(p.tag){case 0:case 11:case 15:kv(p),p.flags&2048&&Yf(9,p,p.return);break;case 3:kv(p);break;case 12:kv(p);break;case 22:var g=p.stateNode;p.memoizedState!==null&&g._visibility&2&&(p.return===null||p.return.tag!==13)?(g._visibility&=-3,y_(p)):kv(p);break;default:kv(p)}}function y_(p){var g=p.deletions;if((p.flags&16)!==0){if(g!==null)for(var S=0;S<g.length;S++){var R=g[S];ia=R,SL(R,p)}xL(p)}for(p=p.child;p!==null;){switch(g=p,g.tag){case 0:case 11:case 15:Yf(8,g,g.return),y_(g);break;case 22:S=g.stateNode,S._visibility&2&&(S._visibility&=-3,y_(g));break;default:y_(g)}p=p.sibling}}function SL(p,g){for(;ia!==null;){var S=ia;switch(S.tag){case 0:case 11:case 15:Yf(8,S,g);break;case 23:case 22:if(S.memoizedState!==null&&S.memoizedState.cachePool!==null){var R=S.memoizedState.cachePool.pool;R!=null&&R.refCount++}break;case 24:ov(S.memoizedState.cache)}if(R=S.child,R!==null)R.return=S,ia=R;else e:for(S=p;ia!==null;){R=ia;var P=R.sibling,q=R.return;if(hL(R),R===S){ia=null;break e}if(P!==null){P.return=q,ia=P;break e}ia=q}}}var Pfe={getCacheForType:function(p){var g=Pa(Ui),S=g.data.get(p);return S===void 0&&(S=p(),g.data.set(p,S)),S}},Ofe=typeof WeakMap=="function"?WeakMap:Map,ys=0,Ds=null,Br=null,Yr=0,bs=0,il=null,Jf=!1,Xg=!1,LR=!1,Ad=0,li=0,Qf=0,zp=0,BR=0,Dl=0,Jg=0,Ev=null,Mo=null,$R=!1,zR=0,b_=1/0,v_=null,eh=null,wa=0,th=null,Qg=null,e0=0,UR=0,qR=null,_L=null,Tv=0,VR=null;function al(){if((ys&2)!==0&&Yr!==0)return Yr&-Yr;if(U.T!==null){var p=zg;return p!==0?p:XR()}return Z()}function CL(){Dl===0&&(Dl=(Yr&536870912)===0||is?et():536870912);var p=Ol.current;return p!==null&&(p.flags|=32),Dl}function ol(p,g,S){(p===Ds&&(bs===2||bs===9)||p.cancelPendingCommit!==null)&&(t0(p,0),nh(p,Yr,Dl,!1)),tt(p,S),((ys&2)===0||p!==Ds)&&(p===Ds&&((ys&2)===0&&(zp|=S),li===4&&nh(p,Yr,Dl,!1)),du(p))}function kL(p,g,S){if((ys&6)!==0)throw Error(r(327));var R=!S&&(g&124)===0&&(g&p.expiredLanes)===0||le(p,g),P=R?Lfe(p,g):GR(p,g,!0),q=R;do{if(P===0){Xg&&!R&&nh(p,g,0,!1);break}else{if(S=p.current.alternate,q&&!Dfe(S)){P=GR(p,g,!1),q=!1;continue}if(P===2){if(q=g,p.errorRecoveryDisabledLanes&q)var he=0;else he=p.pendingLanes&-536870913,he=he!==0?he:he&536870912?536870912:0;if(he!==0){g=he;e:{var Oe=p;P=Ev;var Ze=Oe.current.memoizedState.isDehydrated;if(Ze&&(t0(Oe,he).flags|=256),he=GR(Oe,he,!1),he!==2){if(LR&&!Ze){Oe.errorRecoveryDisabledLanes|=q,zp|=q,P=4;break e}q=Mo,Mo=P,q!==null&&(Mo===null?Mo=q:Mo.push.apply(Mo,q))}P=he}if(q=!1,P!==2)continue}}if(P===1){t0(p,0),nh(p,g,0,!0);break}e:{switch(R=p,q=P,q){case 0:case 1:throw Error(r(345));case 4:if((g&4194048)!==g)break;case 6:nh(R,g,Dl,!Jf);break e;case 2:Mo=null;break;case 3:case 5:break;default:throw Error(r(329))}if((g&62914560)===g&&(P=zR+300-ue(),10<P)){if(nh(R,g,Dl,!Jf),Ae(R,0,!0)!==0)break e;R.timeoutHandle=eB(EL.bind(null,R,S,Mo,v_,$R,g,Dl,zp,Jg,Jf,q,2,-0,0),P);break e}EL(R,S,Mo,v_,$R,g,Dl,zp,Jg,Jf,q,0,-0,0)}}break}while(!0);du(p)}function EL(p,g,S,R,P,q,he,Oe,Ze,_t,Dt,$t,Et,Rt){if(p.timeoutHandle=-1,$t=g.subtreeFlags,($t&8192||($t&16785408)===16785408)&&(Pv={stylesheets:null,count:0,unsuspend:yhe},vL(g),$t=vhe(),$t!==null)){p.cancelPendingCommit=$t(jL.bind(null,p,g,q,S,R,P,he,Oe,Ze,Dt,1,Et,Rt)),nh(p,q,he,!_t);return}jL(p,g,q,S,R,P,he,Oe,Ze)}function Dfe(p){for(var g=p;;){var S=g.tag;if((S===0||S===11||S===15)&&g.flags&16384&&(S=g.updateQueue,S!==null&&(S=S.stores,S!==null)))for(var R=0;R<S.length;R++){var P=S[R],q=P.getSnapshot;P=P.value;try{if(!ja(q(),P))return!1}catch{return!1}}if(S=g.child,g.subtreeFlags&16384&&S!==null)S.return=g,g=S;else{if(g===p)break;for(;g.sibling===null;){if(g.return===null||g.return===p)return!0;g=g.return}g.sibling.return=g.return,g=g.sibling}}return!0}function nh(p,g,S,R){g&=~BR,g&=~zp,p.suspendedLanes|=g,p.pingedLanes&=~g,R&&(p.warmLanes|=g),R=p.expirationTimes;for(var P=g;0<P;){var q=31-Yt(P),he=1<<q;R[q]=-1,P&=~he}S!==0&&Se(p,S,g)}function x_(){return(ys&6)===0?(Av(0),!1):!0}function WR(){if(Br!==null){if(bs===0)var p=Br.return;else p=Br,xd=Op=null,lR(p),Gg=null,bv=0,p=Br;for(;p!==null;)iL(p.alternate,p),p=p.return;Br=null}}function t0(p,g){var S=p.timeoutHandle;S!==-1&&(p.timeoutHandle=-1,ehe(S)),S=p.cancelPendingCommit,S!==null&&(p.cancelPendingCommit=null,S()),WR(),Ds=p,Br=S=yd(p.current,null),Yr=g,bs=0,il=null,Jf=!1,Xg=le(p,g),LR=!1,Jg=Dl=BR=zp=Qf=li=0,Mo=Ev=null,$R=!1,(g&8)!==0&&(g|=g&32);var R=p.entangledLanes;if(R!==0)for(p=p.entanglements,R&=g;0<R;){var P=31-Yt(R),q=1<<P;g|=p[P],R&=~q}return Ad=g,or(),S}function TL(p,g){Pr=null,U.H=o_,g===cv||g===XS?(g=V5(),bs=3):g===z5?(g=V5(),bs=4):bs=g===W8?8:g!==null&&typeof g=="object"&&typeof g.then=="function"?6:1,il=g,Br===null&&(li=1,f_(p,qn(g,p.current)))}function AL(){var p=U.H;return U.H=o_,p===null?o_:p}function RL(){var p=U.A;return U.A=Pfe,p}function HR(){li=4,Jf||(Yr&4194048)!==Yr&&Ol.current!==null||(Xg=!0),(Qf&134217727)===0&&(zp&134217727)===0||Ds===null||nh(Ds,Yr,Dl,!1)}function GR(p,g,S){var R=ys;ys|=2;var P=AL(),q=RL();(Ds!==p||Yr!==g)&&(v_=null,t0(p,g)),g=!1;var he=li;e:do try{if(bs!==0&&Br!==null){var Oe=Br,Ze=il;switch(bs){case 8:WR(),he=6;break e;case 3:case 2:case 9:case 6:Ol.current===null&&(g=!0);var _t=bs;if(bs=0,il=null,n0(p,Oe,Ze,_t),S&&Xg){he=0;break e}break;default:_t=bs,bs=0,il=null,n0(p,Oe,Ze,_t)}}Ffe(),he=li;break}catch(Dt){TL(p,Dt)}while(!0);return g&&p.shellSuspendCounter++,xd=Op=null,ys=R,U.H=P,U.A=q,Br===null&&(Ds=null,Yr=0,or()),he}function Ffe(){for(;Br!==null;)NL(Br)}function Lfe(p,g){var S=ys;ys|=2;var R=AL(),P=RL();Ds!==p||Yr!==g?(v_=null,b_=ue()+500,t0(p,g)):Xg=le(p,g);e:do try{if(bs!==0&&Br!==null){g=Br;var q=il;t:switch(bs){case 1:bs=0,il=null,n0(p,g,q,1);break;case 2:case 9:if(U5(q)){bs=0,il=null,IL(g);break}g=function(){bs!==2&&bs!==9||Ds!==p||(bs=7),du(p)},q.then(g,g);break e;case 3:bs=7;break e;case 4:bs=5;break e;case 7:U5(q)?(bs=0,il=null,IL(g)):(bs=0,il=null,n0(p,g,q,7));break;case 5:var he=null;switch(Br.tag){case 26:he=Br.memoizedState;case 5:case 27:var Oe=Br;if(!he||fB(he)){bs=0,il=null;var Ze=Oe.sibling;if(Ze!==null)Br=Ze;else{var _t=Oe.return;_t!==null?(Br=_t,w_(_t)):Br=null}break t}}bs=0,il=null,n0(p,g,q,5);break;case 6:bs=0,il=null,n0(p,g,q,6);break;case 8:WR(),li=6;break e;default:throw Error(r(462))}}Bfe();break}catch(Dt){TL(p,Dt)}while(!0);return xd=Op=null,U.H=R,U.A=P,ys=S,Br!==null?0:(Ds=null,Yr=0,or(),li)}function Bfe(){for(;Br!==null&&!ye();)NL(Br)}function NL(p){var g=rL(p.alternate,p,Ad);p.memoizedProps=p.pendingProps,g===null?w_(p):Br=g}function IL(p){var g=p,S=g.alternate;switch(g.tag){case 15:case 0:g=X8(S,g,g.pendingProps,g.type,void 0,Yr);break;case 11:g=X8(S,g,g.pendingProps,g.type.render,g.ref,Yr);break;case 5:lR(g);default:iL(S,g),g=Br=M5(g,Ad),g=rL(S,g,Ad)}p.memoizedProps=p.pendingProps,g===null?w_(p):Br=g}function n0(p,g,S,R){xd=Op=null,lR(g),Gg=null,bv=0;var P=g.return;try{if(Afe(p,P,g,S,Yr)){li=1,f_(p,qn(S,p.current)),Br=null;return}}catch(q){if(P!==null)throw Br=P,q;li=1,f_(p,qn(S,p.current)),Br=null;return}g.flags&32768?(is||R===1?p=!0:Xg||(Yr&536870912)!==0?p=!1:(Jf=p=!0,(R===2||R===9||R===3||R===6)&&(R=Ol.current,R!==null&&R.tag===13&&(R.flags|=16384))),ML(g,p)):w_(g)}function w_(p){var g=p;do{if((g.flags&32768)!==0){ML(g,Jf);return}p=g.return;var S=Nfe(g.alternate,g,Ad);if(S!==null){Br=S;return}if(g=g.sibling,g!==null){Br=g;return}Br=g=p}while(g!==null);li===0&&(li=5)}function ML(p,g){do{var S=Ife(p.alternate,p);if(S!==null){S.flags&=32767,Br=S;return}if(S=p.return,S!==null&&(S.flags|=32768,S.subtreeFlags=0,S.deletions=null),!g&&(p=p.sibling,p!==null)){Br=p;return}Br=p=S}while(p!==null);li=6,Br=null}function jL(p,g,S,R,P,q,he,Oe,Ze){p.cancelPendingCommit=null;do S_();while(wa!==0);if((ys&6)!==0)throw Error(r(327));if(g!==null){if(g===p.current)throw Error(r(177));if(q=g.lanes|g.childLanes,q|=va,ve(p,S,q,he,Oe,Ze),p===Ds&&(Br=Ds=null,Yr=0),Qg=g,th=p,e0=S,UR=q,qR=P,_L=R,(g.subtreeFlags&10256)!==0||(g.flags&10256)!==0?(p.callbackNode=null,p.callbackPriority=0,qfe(Be,function(){return LL(),null})):(p.callbackNode=null,p.callbackPriority=0),R=(g.flags&13878)!==0,(g.subtreeFlags&13878)!==0||R){R=U.T,U.T=null,P=W.p,W.p=2,he=ys,ys|=4;try{Mfe(p,g,S)}finally{ys=he,W.p=P,U.T=R}}wa=1,PL(),OL(),DL()}}function PL(){if(wa===1){wa=0;var p=th,g=Qg,S=(g.flags&13878)!==0;if((g.subtreeFlags&13878)!==0||S){S=U.T,U.T=null;var R=W.p;W.p=2;var P=ys;ys|=4;try{gL(g,p);var q=iN,he=pe(p.containerInfo),Oe=q.focusedElem,Ze=q.selectionRange;if(he!==Oe&&Oe&&Oe.ownerDocument&&ae(Oe.ownerDocument.documentElement,Oe)){if(Ze!==null&&Ne(Oe)){var _t=Ze.start,Dt=Ze.end;if(Dt===void 0&&(Dt=_t),"selectionStart"in Oe)Oe.selectionStart=_t,Oe.selectionEnd=Math.min(Dt,Oe.value.length);else{var $t=Oe.ownerDocument||document,Et=$t&&$t.defaultView||window;if(Et.getSelection){var Rt=Et.getSelection(),lr=Oe.textContent.length,Zn=Math.min(Ze.start,lr),ks=Ze.end===void 0?Zn:Math.min(Ze.end,lr);!Rt.extend&&Zn>ks&&(he=ks,ks=Zn,Zn=he);var mt=te(Oe,Zn),it=te(Oe,ks);if(mt&&it&&(Rt.rangeCount!==1||Rt.anchorNode!==mt.node||Rt.anchorOffset!==mt.offset||Rt.focusNode!==it.node||Rt.focusOffset!==it.offset)){var St=$t.createRange();St.setStart(mt.node,mt.offset),Rt.removeAllRanges(),Zn>ks?(Rt.addRange(St),Rt.extend(it.node,it.offset)):(St.setEnd(it.node,it.offset),Rt.addRange(St))}}}}for($t=[],Rt=Oe;Rt=Rt.parentNode;)Rt.nodeType===1&&$t.push({element:Rt,left:Rt.scrollLeft,top:Rt.scrollTop});for(typeof Oe.focus=="function"&&Oe.focus(),Oe=0;Oe<$t.length;Oe++){var Lt=$t[Oe];Lt.element.scrollLeft=Lt.left,Lt.element.scrollTop=Lt.top}}P_=!!sN,iN=sN=null}finally{ys=P,W.p=R,U.T=S}}p.current=g,wa=2}}function OL(){if(wa===2){wa=0;var p=th,g=Qg,S=(g.flags&8772)!==0;if((g.subtreeFlags&8772)!==0||S){S=U.T,U.T=null;var R=W.p;W.p=2;var P=ys;ys|=4;try{fL(p,g.alternate,g)}finally{ys=P,W.p=R,U.T=S}}wa=3}}function DL(){if(wa===4||wa===3){wa=0,Me();var p=th,g=Qg,S=e0,R=_L;(g.subtreeFlags&10256)!==0||(g.flags&10256)!==0?wa=5:(wa=0,Qg=th=null,FL(p,p.pendingLanes));var P=p.pendingLanes;if(P===0&&(eh=null),fe(S),g=g.stateNode,Ut&&typeof Ut.onCommitFiberRoot=="function")try{Ut.onCommitFiberRoot(Pt,g,void 0,(g.current.flags&128)===128)}catch{}if(R!==null){g=U.T,P=W.p,W.p=2,U.T=null;try{for(var q=p.onRecoverableError,he=0;he<R.length;he++){var Oe=R[he];q(Oe.value,{componentStack:Oe.stack})}}finally{U.T=g,W.p=P}}(e0&3)!==0&&S_(),du(p),P=p.pendingLanes,(S&4194090)!==0&&(P&42)!==0?p===VR?Tv++:(Tv=0,VR=p):Tv=0,Av(0)}}function FL(p,g){(p.pooledCacheLanes&=g)===0&&(g=p.pooledCache,g!=null&&(p.pooledCache=null,ov(g)))}function S_(p){return PL(),OL(),DL(),LL()}function LL(){if(wa!==5)return!1;var p=th,g=UR;UR=0;var S=fe(e0),R=U.T,P=W.p;try{W.p=32>S?32:S,U.T=null,S=qR,qR=null;var q=th,he=e0;if(wa=0,Qg=th=null,e0=0,(ys&6)!==0)throw Error(r(331));var Oe=ys;if(ys|=4,wL(q.current),bL(q,q.current,he,S),ys=Oe,Av(0,!1),Ut&&typeof Ut.onPostCommitFiberRoot=="function")try{Ut.onPostCommitFiberRoot(Pt,q)}catch{}return!0}finally{W.p=P,U.T=R,FL(p,g)}}function BL(p,g,S){g=qn(S,g),g=SR(p.stateNode,g,2),p=Wf(p,g,2),p!==null&&(tt(p,2),du(p))}function Ms(p,g,S){if(p.tag===3)BL(p,p,S);else for(;g!==null;){if(g.tag===3){BL(g,p,S);break}else if(g.tag===1){var R=g.stateNode;if(typeof g.type.getDerivedStateFromError=="function"||typeof R.componentDidCatch=="function"&&(eh===null||!eh.has(R))){p=qn(S,p),S=q8(2),R=Wf(g,S,2),R!==null&&(V8(S,R,g,p),tt(R,2),du(R));break}}g=g.return}}function KR(p,g,S){var R=p.pingCache;if(R===null){R=p.pingCache=new Ofe;var P=new Set;R.set(g,P)}else P=R.get(g),P===void 0&&(P=new Set,R.set(g,P));P.has(S)||(LR=!0,P.add(S),p=$fe.bind(null,p,g,S),g.then(p,p))}function $fe(p,g,S){var R=p.pingCache;R!==null&&R.delete(g),p.pingedLanes|=p.suspendedLanes&S,p.warmLanes&=~S,Ds===p&&(Yr&S)===S&&(li===4||li===3&&(Yr&62914560)===Yr&&300>ue()-zR?(ys&2)===0&&t0(p,0):BR|=S,Jg===Yr&&(Jg=0)),du(p)}function $L(p,g){g===0&&(g=$()),p=xc(p,g),p!==null&&(tt(p,g),du(p))}function zfe(p){var g=p.memoizedState,S=0;g!==null&&(S=g.retryLane),$L(p,S)}function Ufe(p,g){var S=0;switch(p.tag){case 13:var R=p.stateNode,P=p.memoizedState;P!==null&&(S=P.retryLane);break;case 19:R=p.stateNode;break;case 22:R=p.stateNode._retryCache;break;default:throw Error(r(314))}R!==null&&R.delete(g),$L(p,S)}function qfe(p,g){return Pe(p,g)}var __=null,r0=null,YR=!1,C_=!1,ZR=!1,Up=0;function du(p){p!==r0&&p.next===null&&(r0===null?__=r0=p:r0=r0.next=p),C_=!0,YR||(YR=!0,Wfe())}function Av(p,g){if(!ZR&&C_){ZR=!0;do for(var S=!1,R=__;R!==null;){if(p!==0){var P=R.pendingLanes;if(P===0)var q=0;else{var he=R.suspendedLanes,Oe=R.pingedLanes;q=(1<<31-Yt(42|p)+1)-1,q&=P&~(he&~Oe),q=q&201326741?q&201326741|1:q?q|2:0}q!==0&&(S=!0,VL(R,q))}else q=Yr,q=Ae(R,R===Ds?q:0,R.cancelPendingCommit!==null||R.timeoutHandle!==-1),(q&3)===0||le(R,q)||(S=!0,VL(R,q));R=R.next}while(S);ZR=!1}}function Vfe(){zL()}function zL(){C_=YR=!1;var p=0;Up!==0&&(Qfe()&&(p=Up),Up=0);for(var g=ue(),S=null,R=__;R!==null;){var P=R.next,q=UL(R,g);q===0?(R.next=null,S===null?__=P:S.next=P,P===null&&(r0=S)):(S=R,(p!==0||(q&3)!==0)&&(C_=!0)),R=P}Av(p)}function UL(p,g){for(var S=p.suspendedLanes,R=p.pingedLanes,P=p.expirationTimes,q=p.pendingLanes&-62914561;0<q;){var he=31-Yt(q),Oe=1<<he,Ze=P[he];Ze===-1?((Oe&S)===0||(Oe&R)!==0)&&(P[he]=ft(Oe,g)):Ze<=g&&(p.expiredLanes|=Oe),q&=~Oe}if(g=Ds,S=Yr,S=Ae(p,p===g?S:0,p.cancelPendingCommit!==null||p.timeoutHandle!==-1),R=p.callbackNode,S===0||p===g&&(bs===2||bs===9)||p.cancelPendingCommit!==null)return R!==null&&R!==null&&Y(R),p.callbackNode=null,p.callbackPriority=0;if((S&3)===0||le(p,S)){if(g=S&-S,g===p.callbackPriority)return g;switch(R!==null&&Y(R),fe(S)){case 2:case 8:S=Ie;break;case 32:S=Be;break;case 268435456:S=ct;break;default:S=Be}return R=qL.bind(null,p),S=Pe(S,R),p.callbackPriority=g,p.callbackNode=S,g}return R!==null&&R!==null&&Y(R),p.callbackPriority=2,p.callbackNode=null,2}function qL(p,g){if(wa!==0&&wa!==5)return p.callbackNode=null,p.callbackPriority=0,null;var S=p.callbackNode;if(S_()&&p.callbackNode!==S)return null;var R=Yr;return R=Ae(p,p===Ds?R:0,p.cancelPendingCommit!==null||p.timeoutHandle!==-1),R===0?null:(kL(p,R,g),UL(p,ue()),p.callbackNode!=null&&p.callbackNode===S?qL.bind(null,p):null)}function VL(p,g){if(S_())return null;kL(p,g,!0)}function Wfe(){the(function(){(ys&6)!==0?Pe(se,Vfe):zL()})}function XR(){return Up===0&&(Up=et()),Up}function WL(p){return p==null||typeof p=="symbol"||typeof p=="boolean"?null:typeof p=="function"?p:ld(""+p)}function HL(p,g){var S=g.ownerDocument.createElement("input");return S.name=g.name,S.value=g.value,p.id&&S.setAttribute("form",p.id),g.parentNode.insertBefore(S,g),p=new FormData(p),S.parentNode.removeChild(S),p}function Hfe(p,g,S,R,P){if(g==="submit"&&S&&S.stateNode===P){var q=WL((P[Fe]||null).action),he=R.submitter;he&&(g=(g=he[Fe]||null)?WL(g.formAction):he.getAttribute("formAction"),g!==null&&(q=g,he=null));var Oe=new _g("action","action",null,R,P);p.push({event:Oe,listeners:[{instance:null,listener:function(){if(R.defaultPrevented){if(Up!==0){var Ze=he?HL(P,he):new FormData(P);yR(S,{pending:!0,data:Ze,method:P.method,action:q},null,Ze)}}else typeof q=="function"&&(Oe.preventDefault(),Ze=he?HL(P,he):new FormData(P),yR(S,{pending:!0,data:Ze,method:P.method,action:q},q,Ze))},currentTarget:P}]})}}for(var JR=0;JR<ln.length;JR++){var QR=ln[JR],Gfe=QR.toLowerCase(),Kfe=QR[0].toUpperCase()+QR.slice(1);Gt(Gfe,"on"+Kfe)}Gt(kt,"onAnimationEnd"),Gt(It,"onAnimationIteration"),Gt(Mt,"onAnimationStart"),Gt("dblclick","onDoubleClick"),Gt("focusin","onFocus"),Gt("focusout","onBlur"),Gt(Ot,"onTransitionRun"),Gt(Xt,"onTransitionStart"),Gt(sn,"onTransitionCancel"),Gt(Ht,"onTransitionEnd"),yn("onMouseEnter",["mouseout","mouseover"]),yn("onMouseLeave",["mouseout","mouseover"]),yn("onPointerEnter",["pointerout","pointerover"]),yn("onPointerLeave",["pointerout","pointerover"]),Vt("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Vt("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Vt("onBeforeInput",["compositionend","keypress","textInput","paste"]),Vt("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Vt("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Vt("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Rv="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Yfe=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Rv));function GL(p,g){g=(g&4)!==0;for(var S=0;S<p.length;S++){var R=p[S],P=R.event;R=R.listeners;e:{var q=void 0;if(g)for(var he=R.length-1;0<=he;he--){var Oe=R[he],Ze=Oe.instance,_t=Oe.currentTarget;if(Oe=Oe.listener,Ze!==q&&P.isPropagationStopped())break e;q=Oe,P.currentTarget=_t;try{q(P)}catch(Dt){d_(Dt)}P.currentTarget=null,q=Ze}else for(he=0;he<R.length;he++){if(Oe=R[he],Ze=Oe.instance,_t=Oe.currentTarget,Oe=Oe.listener,Ze!==q&&P.isPropagationStopped())break e;q=Oe,P.currentTarget=_t;try{q(P)}catch(Dt){d_(Dt)}P.currentTarget=null,q=Ze}}}}function $r(p,g){var S=g[wt];S===void 0&&(S=g[wt]=new Set);var R=p+"__bubble";S.has(R)||(KL(g,p,2,!1),S.add(R))}function eN(p,g,S){var R=0;g&&(R|=4),KL(S,p,R,g)}var k_="_reactListening"+Math.random().toString(36).slice(2);function tN(p){if(!p[k_]){p[k_]=!0,gn.forEach(function(S){S!=="selectionchange"&&(Yfe.has(S)||eN(S,!1,p),eN(S,!0,p))});var g=p.nodeType===9?p:p.ownerDocument;g===null||g[k_]||(g[k_]=!0,eN("selectionchange",!1,g))}}function KL(p,g,S,R){switch(bB(g)){case 2:var P=She;break;case 8:P=_he;break;default:P=mN}S=P.bind(null,g,S,p),P=void 0,!qb||g!=="touchstart"&&g!=="touchmove"&&g!=="wheel"||(P=!0),R?P!==void 0?p.addEventListener(g,S,{capture:!0,passive:P}):p.addEventListener(g,S,!0):P!==void 0?p.addEventListener(g,S,{passive:P}):p.addEventListener(g,S,!1)}function nN(p,g,S,R,P){var q=R;if((g&1)===0&&(g&2)===0&&R!==null)e:for(;;){if(R===null)return;var he=R.tag;if(he===3||he===4){var Oe=R.stateNode.containerInfo;if(Oe===P)break;if(he===4)for(he=R.return;he!==null;){var Ze=he.tag;if((Ze===3||Ze===4)&&he.stateNode.containerInfo===P)return;he=he.return}for(;Oe!==null;){if(he=br(Oe),he===null)return;if(Ze=he.tag,Ze===5||Ze===6||Ze===26||Ze===27){R=q=he;continue e}Oe=Oe.parentNode}}R=R.return}Pf(function(){var _t=q,Dt=wg(S),$t=[];e:{var Et=en.get(p);if(Et!==void 0){var Rt=_g,lr=p;switch(p){case"keypress":if(Ff(S)===0)break e;case"keydown":case"keyup":Rt=Ig;break;case"focusin":lr="focus",Rt=Lf;break;case"focusout":lr="blur",Rt=Lf;break;case"beforeblur":case"afterblur":Rt=Lf;break;case"click":if(S.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Rt=Eg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Rt=PS;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Rt=Zb;break;case kt:case It:case Mt:Rt=OS;break;case Ht:Rt=Xb;break;case"scroll":case"scrollend":Rt=Cg;break;case"wheel":Rt=jg;break;case"copy":case"cut":case"paste":Rt=Rg;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Rt=Yb;break;case"toggle":case"beforetoggle":Rt=LS}var Zn=(g&4)!==0,ks=!Zn&&(p==="scroll"||p==="scrollend"),mt=Zn?Et!==null?Et+"Capture":null:Et;Zn=[];for(var it=_t,St;it!==null;){var Lt=it;if(St=Lt.stateNode,Lt=Lt.tag,Lt!==5&&Lt!==26&&Lt!==27||St===null||mt===null||(Lt=dd(it,mt),Lt!=null&&Zn.push(Nv(it,Lt,St))),ks)break;it=it.return}0<Zn.length&&(Et=new Rt(Et,lr,null,S,Dt),$t.push({event:Et,listeners:Zn}))}}if((g&7)===0){e:{if(Et=p==="mouseover"||p==="pointerover",Rt=p==="mouseout"||p==="pointerout",Et&&S!==Rl&&(lr=S.relatedTarget||S.fromElement)&&(br(lr)||lr[He]))break e;if((Rt||Et)&&(Et=Dt.window===Dt?Dt:(Et=Dt.ownerDocument)?Et.defaultView||Et.parentWindow:window,Rt?(lr=S.relatedTarget||S.toElement,Rt=_t,lr=lr?br(lr):null,lr!==null&&(ks=i(lr),Zn=lr.tag,lr!==ks||Zn!==5&&Zn!==27&&Zn!==6)&&(lr=null)):(Rt=null,lr=_t),Rt!==lr)){if(Zn=Eg,Lt="onMouseLeave",mt="onMouseEnter",it="mouse",(p==="pointerout"||p==="pointerover")&&(Zn=Yb,Lt="onPointerLeave",mt="onPointerEnter",it="pointer"),ks=Rt==null?Et:rs(Rt),St=lr==null?Et:rs(lr),Et=new Zn(Lt,it+"leave",Rt,S,Dt),Et.target=ks,Et.relatedTarget=St,Lt=null,br(Dt)===_t&&(Zn=new Zn(mt,it+"enter",lr,S,Dt),Zn.target=St,Zn.relatedTarget=ks,Lt=Zn),ks=Lt,Rt&&lr)t:{for(Zn=Rt,mt=lr,it=0,St=Zn;St;St=s0(St))it++;for(St=0,Lt=mt;Lt;Lt=s0(Lt))St++;for(;0<it-St;)Zn=s0(Zn),it--;for(;0<St-it;)mt=s0(mt),St--;for(;it--;){if(Zn===mt||mt!==null&&Zn===mt.alternate)break t;Zn=s0(Zn),mt=s0(mt)}Zn=null}else Zn=null;Rt!==null&&YL($t,Et,Rt,Zn,!1),lr!==null&&ks!==null&&YL($t,ks,lr,Zn,!0)}}e:{if(Et=_t?rs(_t):window,Rt=Et.nodeName&&Et.nodeName.toLowerCase(),Rt==="select"||Rt==="input"&&Et.type==="file")var Sn=Rp;else if(Dg(Et))if(Il)Sn=zf;else{Sn=gd;var Dr=VS}else Rt=Et.nodeName,!Rt||Rt.toLowerCase()!=="input"||Et.type!=="checkbox"&&Et.type!=="radio"?_t&&Ub(_t.elementType)&&(Sn=Rp):Sn=nv;if(Sn&&(Sn=Sn(p,_t))){tv($t,Sn,S,Dt);break e}Dr&&Dr(p,Et,_t),p==="focusout"&&_t&&Et.type==="number"&&_t.memoizedProps.value!=null&&Nf(Et,"number",Et.value)}switch(Dr=_t?rs(_t):window,p){case"focusin":(Dg(Dr)||Dr.contentEditable==="true")&&(Ge=Dr,st=_t,at=null);break;case"focusout":at=st=Ge=null;break;case"mousedown":pt=!0;break;case"contextmenu":case"mouseup":case"dragend":pt=!1,Je($t,S,Dt);break;case"selectionchange":if(Le)break;case"keydown":case"keyup":Je($t,S,Dt)}var Fn;if(Tp)e:{switch(p){case"compositionstart":var er="onCompositionStart";break e;case"compositionend":er="onCompositionEnd";break e;case"compositionupdate":er="onCompositionUpdate";break e}er=void 0}else md?ev(p,S)&&(er="onCompositionEnd"):p==="keydown"&&S.keyCode===229&&(er="onCompositionStart");er&&(Pg&&S.locale!=="ko"&&(md||er!=="onCompositionStart"?er==="onCompositionEnd"&&md&&(Fn=Df()):(Nl=Dt,Sg="value"in Nl?Nl.value:Nl.textContent,md=!0)),Dr=E_(_t,er),0<Dr.length&&(er=new Ng(er,p,null,S,Dt),$t.push({event:er,listeners:Dr}),Fn?er.data=Fn:(Fn=$S(S),Fn!==null&&(er.data=Fn)))),(Fn=DA?zS(p,S):FA(p,S))&&(er=E_(_t,"onBeforeInput"),0<er.length&&(Dr=new Ng("onBeforeInput","beforeinput",null,S,Dt),$t.push({event:Dr,listeners:er}),Dr.data=Fn)),Hfe($t,p,_t,S,Dt)}GL($t,g)})}function Nv(p,g,S){return{instance:p,listener:g,currentTarget:S}}function E_(p,g){for(var S=g+"Capture",R=[];p!==null;){var P=p,q=P.stateNode;if(P=P.tag,P!==5&&P!==26&&P!==27||q===null||(P=dd(p,S),P!=null&&R.unshift(Nv(p,P,q)),P=dd(p,g),P!=null&&R.push(Nv(p,P,q))),p.tag===3)return R;p=p.return}return[]}function s0(p){if(p===null)return null;do p=p.return;while(p&&p.tag!==5&&p.tag!==27);return p||null}function YL(p,g,S,R,P){for(var q=g._reactName,he=[];S!==null&&S!==R;){var Oe=S,Ze=Oe.alternate,_t=Oe.stateNode;if(Oe=Oe.tag,Ze!==null&&Ze===R)break;Oe!==5&&Oe!==26&&Oe!==27||_t===null||(Ze=_t,P?(_t=dd(S,q),_t!=null&&he.unshift(Nv(S,_t,Ze))):P||(_t=dd(S,q),_t!=null&&he.push(Nv(S,_t,Ze)))),S=S.return}he.length!==0&&p.push({event:g,listeners:he})}var Zfe=/\r\n?/g,Xfe=/\u0000|\uFFFD/g;function ZL(p){return(typeof p=="string"?p:""+p).replace(Zfe,`
`).replace(Xfe,"")}function XL(p,g){return g=ZL(g),ZL(p)===g}function T_(){}function Cs(p,g,S,R,P,q){switch(S){case"children":typeof R=="string"?g==="body"||g==="textarea"&&R===""||Mf(p,R):(typeof R=="number"||typeof R=="bigint")&&g!=="body"&&Mf(p,""+R);break;case"className":Xa(p,"class",R);break;case"tabIndex":Xa(p,"tabindex",R);break;case"dir":case"role":case"viewBox":case"width":case"height":Xa(p,S,R);break;case"style":MS(p,R,q);break;case"data":if(g!=="object"){Xa(p,"data",R);break}case"src":case"href":if(R===""&&(g!=="a"||S!=="href")){p.removeAttribute(S);break}if(R==null||typeof R=="function"||typeof R=="symbol"||typeof R=="boolean"){p.removeAttribute(S);break}R=ld(""+R),p.setAttribute(S,R);break;case"action":case"formAction":if(typeof R=="function"){p.setAttribute(S,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof q=="function"&&(S==="formAction"?(g!=="input"&&Cs(p,g,"name",P.name,P,null),Cs(p,g,"formEncType",P.formEncType,P,null),Cs(p,g,"formMethod",P.formMethod,P,null),Cs(p,g,"formTarget",P.formTarget,P,null)):(Cs(p,g,"encType",P.encType,P,null),Cs(p,g,"method",P.method,P,null),Cs(p,g,"target",P.target,P,null)));if(R==null||typeof R=="symbol"||typeof R=="boolean"){p.removeAttribute(S);break}R=ld(""+R),p.setAttribute(S,R);break;case"onClick":R!=null&&(p.onclick=T_);break;case"onScroll":R!=null&&$r("scroll",p);break;case"onScrollEnd":R!=null&&$r("scrollend",p);break;case"dangerouslySetInnerHTML":if(R!=null){if(typeof R!="object"||!("__html"in R))throw Error(r(61));if(S=R.__html,S!=null){if(P.children!=null)throw Error(r(60));p.innerHTML=S}}break;case"multiple":p.multiple=R&&typeof R!="function"&&typeof R!="symbol";break;case"muted":p.muted=R&&typeof R!="function"&&typeof R!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(R==null||typeof R=="function"||typeof R=="boolean"||typeof R=="symbol"){p.removeAttribute("xlink:href");break}S=ld(""+R),p.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",S);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":R!=null&&typeof R!="function"&&typeof R!="symbol"?p.setAttribute(S,""+R):p.removeAttribute(S);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":R&&typeof R!="function"&&typeof R!="symbol"?p.setAttribute(S,""):p.removeAttribute(S);break;case"capture":case"download":R===!0?p.setAttribute(S,""):R!==!1&&R!=null&&typeof R!="function"&&typeof R!="symbol"?p.setAttribute(S,R):p.removeAttribute(S);break;case"cols":case"rows":case"size":case"span":R!=null&&typeof R!="function"&&typeof R!="symbol"&&!isNaN(R)&&1<=R?p.setAttribute(S,R):p.removeAttribute(S);break;case"rowSpan":case"start":R==null||typeof R=="function"||typeof R=="symbol"||isNaN(R)?p.removeAttribute(S):p.setAttribute(S,R);break;case"popover":$r("beforetoggle",p),$r("toggle",p),fi(p,"popover",R);break;case"xlinkActuate":ba(p,"http://www.w3.org/1999/xlink","xlink:actuate",R);break;case"xlinkArcrole":ba(p,"http://www.w3.org/1999/xlink","xlink:arcrole",R);break;case"xlinkRole":ba(p,"http://www.w3.org/1999/xlink","xlink:role",R);break;case"xlinkShow":ba(p,"http://www.w3.org/1999/xlink","xlink:show",R);break;case"xlinkTitle":ba(p,"http://www.w3.org/1999/xlink","xlink:title",R);break;case"xlinkType":ba(p,"http://www.w3.org/1999/xlink","xlink:type",R);break;case"xmlBase":ba(p,"http://www.w3.org/XML/1998/namespace","xml:base",R);break;case"xmlLang":ba(p,"http://www.w3.org/XML/1998/namespace","xml:lang",R);break;case"xmlSpace":ba(p,"http://www.w3.org/XML/1998/namespace","xml:space",R);break;case"is":fi(p,"is",R);break;case"innerText":case"textContent":break;default:(!(2<S.length)||S[0]!=="o"&&S[0]!=="O"||S[1]!=="n"&&S[1]!=="N")&&(S=Qa.get(S)||S,fi(p,S,R))}}function rN(p,g,S,R,P,q){switch(S){case"style":MS(p,R,q);break;case"dangerouslySetInnerHTML":if(R!=null){if(typeof R!="object"||!("__html"in R))throw Error(r(61));if(S=R.__html,S!=null){if(P.children!=null)throw Error(r(60));p.innerHTML=S}}break;case"children":typeof R=="string"?Mf(p,R):(typeof R=="number"||typeof R=="bigint")&&Mf(p,""+R);break;case"onScroll":R!=null&&$r("scroll",p);break;case"onScrollEnd":R!=null&&$r("scrollend",p);break;case"onClick":R!=null&&(p.onclick=T_);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!nt.hasOwnProperty(S))e:{if(S[0]==="o"&&S[1]==="n"&&(P=S.endsWith("Capture"),g=S.slice(2,P?S.length-7:void 0),q=p[Fe]||null,q=q!=null?q[S]:null,typeof q=="function"&&p.removeEventListener(g,q,P),typeof R=="function")){typeof q!="function"&&q!==null&&(S in p?p[S]=null:p.hasAttribute(S)&&p.removeAttribute(S)),p.addEventListener(g,R,P);break e}S in p?p[S]=R:R===!0?p.setAttribute(S,""):fi(p,S,R)}}}function Sa(p,g,S){switch(g){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":$r("error",p),$r("load",p);var R=!1,P=!1,q;for(q in S)if(S.hasOwnProperty(q)){var he=S[q];if(he!=null)switch(q){case"src":R=!0;break;case"srcSet":P=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,g));default:Cs(p,g,q,he,S,null)}}P&&Cs(p,g,"srcSet",S.srcSet,S,null),R&&Cs(p,g,"src",S.src,S,null);return;case"input":$r("invalid",p);var Oe=q=he=P=null,Ze=null,_t=null;for(R in S)if(S.hasOwnProperty(R)){var Dt=S[R];if(Dt!=null)switch(R){case"name":P=Dt;break;case"type":he=Dt;break;case"checked":Ze=Dt;break;case"defaultChecked":_t=Dt;break;case"value":q=Dt;break;case"defaultValue":Oe=Dt;break;case"children":case"dangerouslySetInnerHTML":if(Dt!=null)throw Error(r(137,g));break;default:Cs(p,g,R,Dt,S,null)}}$b(p,q,Oe,Ze,_t,he,P,!1),nu(p);return;case"select":$r("invalid",p),R=he=q=null;for(P in S)if(S.hasOwnProperty(P)&&(Oe=S[P],Oe!=null))switch(P){case"value":q=Oe;break;case"defaultValue":he=Oe;break;case"multiple":R=Oe;default:Cs(p,g,P,Oe,S,null)}g=q,S=he,p.multiple=!!R,g!=null?od(p,!!R,g,!1):S!=null&&od(p,!!R,S,!0);return;case"textarea":$r("invalid",p),q=P=R=null;for(he in S)if(S.hasOwnProperty(he)&&(Oe=S[he],Oe!=null))switch(he){case"value":R=Oe;break;case"defaultValue":P=Oe;break;case"children":q=Oe;break;case"dangerouslySetInnerHTML":if(Oe!=null)throw Error(r(91));break;default:Cs(p,g,he,Oe,S,null)}zb(p,R,P,q),nu(p);return;case"option":for(Ze in S)if(S.hasOwnProperty(Ze)&&(R=S[Ze],R!=null))switch(Ze){case"selected":p.selected=R&&typeof R!="function"&&typeof R!="symbol";break;default:Cs(p,g,Ze,R,S,null)}return;case"dialog":$r("beforetoggle",p),$r("toggle",p),$r("cancel",p),$r("close",p);break;case"iframe":case"object":$r("load",p);break;case"video":case"audio":for(R=0;R<Rv.length;R++)$r(Rv[R],p);break;case"image":$r("error",p),$r("load",p);break;case"details":$r("toggle",p);break;case"embed":case"source":case"link":$r("error",p),$r("load",p);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(_t in S)if(S.hasOwnProperty(_t)&&(R=S[_t],R!=null))switch(_t){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,g));default:Cs(p,g,_t,R,S,null)}return;default:if(Ub(g)){for(Dt in S)S.hasOwnProperty(Dt)&&(R=S[Dt],R!==void 0&&rN(p,g,Dt,R,S,void 0));return}}for(Oe in S)S.hasOwnProperty(Oe)&&(R=S[Oe],R!=null&&Cs(p,g,Oe,R,S,null))}function Jfe(p,g,S,R){switch(g){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var P=null,q=null,he=null,Oe=null,Ze=null,_t=null,Dt=null;for(Rt in S){var $t=S[Rt];if(S.hasOwnProperty(Rt)&&$t!=null)switch(Rt){case"checked":break;case"value":break;case"defaultValue":Ze=$t;default:R.hasOwnProperty(Rt)||Cs(p,g,Rt,null,R,$t)}}for(var Et in R){var Rt=R[Et];if($t=S[Et],R.hasOwnProperty(Et)&&(Rt!=null||$t!=null))switch(Et){case"type":q=Rt;break;case"name":P=Rt;break;case"checked":_t=Rt;break;case"defaultChecked":Dt=Rt;break;case"value":he=Rt;break;case"defaultValue":Oe=Rt;break;case"children":case"dangerouslySetInnerHTML":if(Rt!=null)throw Error(r(137,g));break;default:Rt!==$t&&Cs(p,g,Et,Rt,R,$t)}}Rf(p,he,Oe,Ze,_t,Dt,q,P);return;case"select":Rt=he=Oe=Et=null;for(q in S)if(Ze=S[q],S.hasOwnProperty(q)&&Ze!=null)switch(q){case"value":break;case"multiple":Rt=Ze;default:R.hasOwnProperty(q)||Cs(p,g,q,null,R,Ze)}for(P in R)if(q=R[P],Ze=S[P],R.hasOwnProperty(P)&&(q!=null||Ze!=null))switch(P){case"value":Et=q;break;case"defaultValue":Oe=q;break;case"multiple":he=q;default:q!==Ze&&Cs(p,g,P,q,R,Ze)}g=Oe,S=he,R=Rt,Et!=null?od(p,!!S,Et,!1):!!R!=!!S&&(g!=null?od(p,!!S,g,!0):od(p,!!S,S?[]:"",!1));return;case"textarea":Rt=Et=null;for(Oe in S)if(P=S[Oe],S.hasOwnProperty(Oe)&&P!=null&&!R.hasOwnProperty(Oe))switch(Oe){case"value":break;case"children":break;default:Cs(p,g,Oe,null,R,P)}for(he in R)if(P=R[he],q=S[he],R.hasOwnProperty(he)&&(P!=null||q!=null))switch(he){case"value":Et=P;break;case"defaultValue":Rt=P;break;case"children":break;case"dangerouslySetInnerHTML":if(P!=null)throw Error(r(91));break;default:P!==q&&Cs(p,g,he,P,R,q)}If(p,Et,Rt);return;case"option":for(var lr in S)if(Et=S[lr],S.hasOwnProperty(lr)&&Et!=null&&!R.hasOwnProperty(lr))switch(lr){case"selected":p.selected=!1;break;default:Cs(p,g,lr,null,R,Et)}for(Ze in R)if(Et=R[Ze],Rt=S[Ze],R.hasOwnProperty(Ze)&&Et!==Rt&&(Et!=null||Rt!=null))switch(Ze){case"selected":p.selected=Et&&typeof Et!="function"&&typeof Et!="symbol";break;default:Cs(p,g,Ze,Et,R,Rt)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Zn in S)Et=S[Zn],S.hasOwnProperty(Zn)&&Et!=null&&!R.hasOwnProperty(Zn)&&Cs(p,g,Zn,null,R,Et);for(_t in R)if(Et=R[_t],Rt=S[_t],R.hasOwnProperty(_t)&&Et!==Rt&&(Et!=null||Rt!=null))switch(_t){case"children":case"dangerouslySetInnerHTML":if(Et!=null)throw Error(r(137,g));break;default:Cs(p,g,_t,Et,R,Rt)}return;default:if(Ub(g)){for(var ks in S)Et=S[ks],S.hasOwnProperty(ks)&&Et!==void 0&&!R.hasOwnProperty(ks)&&rN(p,g,ks,void 0,R,Et);for(Dt in R)Et=R[Dt],Rt=S[Dt],!R.hasOwnProperty(Dt)||Et===Rt||Et===void 0&&Rt===void 0||rN(p,g,Dt,Et,R,Rt);return}}for(var mt in S)Et=S[mt],S.hasOwnProperty(mt)&&Et!=null&&!R.hasOwnProperty(mt)&&Cs(p,g,mt,null,R,Et);for($t in R)Et=R[$t],Rt=S[$t],!R.hasOwnProperty($t)||Et===Rt||Et==null&&Rt==null||Cs(p,g,$t,Et,R,Rt)}var sN=null,iN=null;function A_(p){return p.nodeType===9?p:p.ownerDocument}function JL(p){switch(p){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function QL(p,g){if(p===0)switch(g){case"svg":return 1;case"math":return 2;default:return 0}return p===1&&g==="foreignObject"?0:p}function aN(p,g){return p==="textarea"||p==="noscript"||typeof g.children=="string"||typeof g.children=="number"||typeof g.children=="bigint"||typeof g.dangerouslySetInnerHTML=="object"&&g.dangerouslySetInnerHTML!==null&&g.dangerouslySetInnerHTML.__html!=null}var oN=null;function Qfe(){var p=window.event;return p&&p.type==="popstate"?p===oN?!1:(oN=p,!0):(oN=null,!1)}var eB=typeof setTimeout=="function"?setTimeout:void 0,ehe=typeof clearTimeout=="function"?clearTimeout:void 0,tB=typeof Promise=="function"?Promise:void 0,the=typeof queueMicrotask=="function"?queueMicrotask:typeof tB<"u"?function(p){return tB.resolve(null).then(p).catch(nhe)}:eB;function nhe(p){setTimeout(function(){throw p})}function rh(p){return p==="head"}function nB(p,g){var S=g,R=0,P=0;do{var q=S.nextSibling;if(p.removeChild(S),q&&q.nodeType===8)if(S=q.data,S==="/$"){if(0<R&&8>R){S=R;var he=p.ownerDocument;if(S&1&&Iv(he.documentElement),S&2&&Iv(he.body),S&4)for(S=he.head,Iv(S),he=S.firstChild;he;){var Oe=he.nextSibling,Ze=he.nodeName;he[rn]||Ze==="SCRIPT"||Ze==="STYLE"||Ze==="LINK"&&he.rel.toLowerCase()==="stylesheet"||S.removeChild(he),he=Oe}}if(P===0){p.removeChild(q),Bv(g);return}P--}else S==="$"||S==="$?"||S==="$!"?P++:R=S.charCodeAt(0)-48;else R=0;S=q}while(S);Bv(g)}function lN(p){var g=p.firstChild;for(g&&g.nodeType===10&&(g=g.nextSibling);g;){var S=g;switch(g=g.nextSibling,S.nodeName){case"HTML":case"HEAD":case"BODY":lN(S),fn(S);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(S.rel.toLowerCase()==="stylesheet")continue}p.removeChild(S)}}function rhe(p,g,S,R){for(;p.nodeType===1;){var P=S;if(p.nodeName.toLowerCase()!==g.toLowerCase()){if(!R&&(p.nodeName!=="INPUT"||p.type!=="hidden"))break}else if(R){if(!p[rn])switch(g){case"meta":if(!p.hasAttribute("itemprop"))break;return p;case"link":if(q=p.getAttribute("rel"),q==="stylesheet"&&p.hasAttribute("data-precedence"))break;if(q!==P.rel||p.getAttribute("href")!==(P.href==null||P.href===""?null:P.href)||p.getAttribute("crossorigin")!==(P.crossOrigin==null?null:P.crossOrigin)||p.getAttribute("title")!==(P.title==null?null:P.title))break;return p;case"style":if(p.hasAttribute("data-precedence"))break;return p;case"script":if(q=p.getAttribute("src"),(q!==(P.src==null?null:P.src)||p.getAttribute("type")!==(P.type==null?null:P.type)||p.getAttribute("crossorigin")!==(P.crossOrigin==null?null:P.crossOrigin))&&q&&p.hasAttribute("async")&&!p.hasAttribute("itemprop"))break;return p;default:return p}}else if(g==="input"&&p.type==="hidden"){var q=P.name==null?null:""+P.name;if(P.type==="hidden"&&p.getAttribute("name")===q)return p}else return p;if(p=Sc(p.nextSibling),p===null)break}return null}function she(p,g,S){if(g==="")return null;for(;p.nodeType!==3;)if((p.nodeType!==1||p.nodeName!=="INPUT"||p.type!=="hidden")&&!S||(p=Sc(p.nextSibling),p===null))return null;return p}function cN(p){return p.data==="$!"||p.data==="$?"&&p.ownerDocument.readyState==="complete"}function ihe(p,g){var S=p.ownerDocument;if(p.data!=="$?"||S.readyState==="complete")g();else{var R=function(){g(),S.removeEventListener("DOMContentLoaded",R)};S.addEventListener("DOMContentLoaded",R),p._reactRetry=R}}function Sc(p){for(;p!=null;p=p.nextSibling){var g=p.nodeType;if(g===1||g===3)break;if(g===8){if(g=p.data,g==="$"||g==="$!"||g==="$?"||g==="F!"||g==="F")break;if(g==="/$")return null}}return p}var uN=null;function rB(p){p=p.previousSibling;for(var g=0;p;){if(p.nodeType===8){var S=p.data;if(S==="$"||S==="$!"||S==="$?"){if(g===0)return p;g--}else S==="/$"&&g++}p=p.previousSibling}return null}function sB(p,g,S){switch(g=A_(S),p){case"html":if(p=g.documentElement,!p)throw Error(r(452));return p;case"head":if(p=g.head,!p)throw Error(r(453));return p;case"body":if(p=g.body,!p)throw Error(r(454));return p;default:throw Error(r(451))}}function Iv(p){for(var g=p.attributes;g.length;)p.removeAttributeNode(g[0]);fn(p)}var Fl=new Map,iB=new Set;function R_(p){return typeof p.getRootNode=="function"?p.getRootNode():p.nodeType===9?p:p.ownerDocument}var Rd=W.d;W.d={f:ahe,r:ohe,D:lhe,C:che,L:uhe,m:dhe,X:hhe,S:fhe,M:phe};function ahe(){var p=Rd.f(),g=x_();return p||g}function ohe(p){var g=Mr(p);g!==null&&g.tag===5&&g.type==="form"?k8(g):Rd.r(p)}var i0=typeof document>"u"?null:document;function aB(p,g,S){var R=i0;if(R&&typeof g=="string"&&g){var P=Ia(g);P='link[rel="'+p+'"][href="'+P+'"]',typeof S=="string"&&(P+='[crossorigin="'+S+'"]'),iB.has(P)||(iB.add(P),p={rel:p,crossOrigin:S,href:g},R.querySelector(P)===null&&(g=R.createElement("link"),Sa(g,"link",p),kr(g),R.head.appendChild(g)))}}function lhe(p){Rd.D(p),aB("dns-prefetch",p,null)}function che(p,g){Rd.C(p,g),aB("preconnect",p,g)}function uhe(p,g,S){Rd.L(p,g,S);var R=i0;if(R&&p&&g){var P='link[rel="preload"][as="'+Ia(g)+'"]';g==="image"&&S&&S.imageSrcSet?(P+='[imagesrcset="'+Ia(S.imageSrcSet)+'"]',typeof S.imageSizes=="string"&&(P+='[imagesizes="'+Ia(S.imageSizes)+'"]')):P+='[href="'+Ia(p)+'"]';var q=P;switch(g){case"style":q=a0(p);break;case"script":q=o0(p)}Fl.has(q)||(p=u({rel:"preload",href:g==="image"&&S&&S.imageSrcSet?void 0:p,as:g},S),Fl.set(q,p),R.querySelector(P)!==null||g==="style"&&R.querySelector(Mv(q))||g==="script"&&R.querySelector(jv(q))||(g=R.createElement("link"),Sa(g,"link",p),kr(g),R.head.appendChild(g)))}}function dhe(p,g){Rd.m(p,g);var S=i0;if(S&&p){var R=g&&typeof g.as=="string"?g.as:"script",P='link[rel="modulepreload"][as="'+Ia(R)+'"][href="'+Ia(p)+'"]',q=P;switch(R){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":q=o0(p)}if(!Fl.has(q)&&(p=u({rel:"modulepreload",href:p},g),Fl.set(q,p),S.querySelector(P)===null)){switch(R){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(S.querySelector(jv(q)))return}R=S.createElement("link"),Sa(R,"link",p),kr(R),S.head.appendChild(R)}}}function fhe(p,g,S){Rd.S(p,g,S);var R=i0;if(R&&p){var P=ss(R).hoistableStyles,q=a0(p);g=g||"default";var he=P.get(q);if(!he){var Oe={loading:0,preload:null};if(he=R.querySelector(Mv(q)))Oe.loading=5;else{p=u({rel:"stylesheet",href:p,"data-precedence":g},S),(S=Fl.get(q))&&dN(p,S);var Ze=he=R.createElement("link");kr(Ze),Sa(Ze,"link",p),Ze._p=new Promise(function(_t,Dt){Ze.onload=_t,Ze.onerror=Dt}),Ze.addEventListener("load",function(){Oe.loading|=1}),Ze.addEventListener("error",function(){Oe.loading|=2}),Oe.loading|=4,N_(he,g,R)}he={type:"stylesheet",instance:he,count:1,state:Oe},P.set(q,he)}}}function hhe(p,g){Rd.X(p,g);var S=i0;if(S&&p){var R=ss(S).hoistableScripts,P=o0(p),q=R.get(P);q||(q=S.querySelector(jv(P)),q||(p=u({src:p,async:!0},g),(g=Fl.get(P))&&fN(p,g),q=S.createElement("script"),kr(q),Sa(q,"link",p),S.head.appendChild(q)),q={type:"script",instance:q,count:1,state:null},R.set(P,q))}}function phe(p,g){Rd.M(p,g);var S=i0;if(S&&p){var R=ss(S).hoistableScripts,P=o0(p),q=R.get(P);q||(q=S.querySelector(jv(P)),q||(p=u({src:p,async:!0,type:"module"},g),(g=Fl.get(P))&&fN(p,g),q=S.createElement("script"),kr(q),Sa(q,"link",p),S.head.appendChild(q)),q={type:"script",instance:q,count:1,state:null},R.set(P,q))}}function oB(p,g,S,R){var P=(P=De.current)?R_(P):null;if(!P)throw Error(r(446));switch(p){case"meta":case"title":return null;case"style":return typeof S.precedence=="string"&&typeof S.href=="string"?(g=a0(S.href),S=ss(P).hoistableStyles,R=S.get(g),R||(R={type:"style",instance:null,count:0,state:null},S.set(g,R)),R):{type:"void",instance:null,count:0,state:null};case"link":if(S.rel==="stylesheet"&&typeof S.href=="string"&&typeof S.precedence=="string"){p=a0(S.href);var q=ss(P).hoistableStyles,he=q.get(p);if(he||(P=P.ownerDocument||P,he={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},q.set(p,he),(q=P.querySelector(Mv(p)))&&!q._p&&(he.instance=q,he.state.loading=5),Fl.has(p)||(S={rel:"preload",as:"style",href:S.href,crossOrigin:S.crossOrigin,integrity:S.integrity,media:S.media,hrefLang:S.hrefLang,referrerPolicy:S.referrerPolicy},Fl.set(p,S),q||mhe(P,p,S,he.state))),g&&R===null)throw Error(r(528,""));return he}if(g&&R!==null)throw Error(r(529,""));return null;case"script":return g=S.async,S=S.src,typeof S=="string"&&g&&typeof g!="function"&&typeof g!="symbol"?(g=o0(S),S=ss(P).hoistableScripts,R=S.get(g),R||(R={type:"script",instance:null,count:0,state:null},S.set(g,R)),R):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,p))}}function a0(p){return'href="'+Ia(p)+'"'}function Mv(p){return'link[rel="stylesheet"]['+p+"]"}function lB(p){return u({},p,{"data-precedence":p.precedence,precedence:null})}function mhe(p,g,S,R){p.querySelector('link[rel="preload"][as="style"]['+g+"]")?R.loading=1:(g=p.createElement("link"),R.preload=g,g.addEventListener("load",function(){return R.loading|=1}),g.addEventListener("error",function(){return R.loading|=2}),Sa(g,"link",S),kr(g),p.head.appendChild(g))}function o0(p){return'[src="'+Ia(p)+'"]'}function jv(p){return"script[async]"+p}function cB(p,g,S){if(g.count++,g.instance===null)switch(g.type){case"style":var R=p.querySelector('style[data-href~="'+Ia(S.href)+'"]');if(R)return g.instance=R,kr(R),R;var P=u({},S,{"data-href":S.href,"data-precedence":S.precedence,href:null,precedence:null});return R=(p.ownerDocument||p).createElement("style"),kr(R),Sa(R,"style",P),N_(R,S.precedence,p),g.instance=R;case"stylesheet":P=a0(S.href);var q=p.querySelector(Mv(P));if(q)return g.state.loading|=4,g.instance=q,kr(q),q;R=lB(S),(P=Fl.get(P))&&dN(R,P),q=(p.ownerDocument||p).createElement("link"),kr(q);var he=q;return he._p=new Promise(function(Oe,Ze){he.onload=Oe,he.onerror=Ze}),Sa(q,"link",R),g.state.loading|=4,N_(q,S.precedence,p),g.instance=q;case"script":return q=o0(S.src),(P=p.querySelector(jv(q)))?(g.instance=P,kr(P),P):(R=S,(P=Fl.get(q))&&(R=u({},S),fN(R,P)),p=p.ownerDocument||p,P=p.createElement("script"),kr(P),Sa(P,"link",R),p.head.appendChild(P),g.instance=P);case"void":return null;default:throw Error(r(443,g.type))}else g.type==="stylesheet"&&(g.state.loading&4)===0&&(R=g.instance,g.state.loading|=4,N_(R,S.precedence,p));return g.instance}function N_(p,g,S){for(var R=S.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),P=R.length?R[R.length-1]:null,q=P,he=0;he<R.length;he++){var Oe=R[he];if(Oe.dataset.precedence===g)q=Oe;else if(q!==P)break}q?q.parentNode.insertBefore(p,q.nextSibling):(g=S.nodeType===9?S.head:S,g.insertBefore(p,g.firstChild))}function dN(p,g){p.crossOrigin==null&&(p.crossOrigin=g.crossOrigin),p.referrerPolicy==null&&(p.referrerPolicy=g.referrerPolicy),p.title==null&&(p.title=g.title)}function fN(p,g){p.crossOrigin==null&&(p.crossOrigin=g.crossOrigin),p.referrerPolicy==null&&(p.referrerPolicy=g.referrerPolicy),p.integrity==null&&(p.integrity=g.integrity)}var I_=null;function uB(p,g,S){if(I_===null){var R=new Map,P=I_=new Map;P.set(S,R)}else P=I_,R=P.get(S),R||(R=new Map,P.set(S,R));if(R.has(p))return R;for(R.set(p,null),S=S.getElementsByTagName(p),P=0;P<S.length;P++){var q=S[P];if(!(q[rn]||q[xe]||p==="link"&&q.getAttribute("rel")==="stylesheet")&&q.namespaceURI!=="http://www.w3.org/2000/svg"){var he=q.getAttribute(g)||"";he=p+he;var Oe=R.get(he);Oe?Oe.push(q):R.set(he,[q])}}return R}function dB(p,g,S){p=p.ownerDocument||p,p.head.insertBefore(S,g==="title"?p.querySelector("head > title"):null)}function ghe(p,g,S){if(S===1||g.itemProp!=null)return!1;switch(p){case"meta":case"title":return!0;case"style":if(typeof g.precedence!="string"||typeof g.href!="string"||g.href==="")break;return!0;case"link":if(typeof g.rel!="string"||typeof g.href!="string"||g.href===""||g.onLoad||g.onError)break;switch(g.rel){case"stylesheet":return p=g.disabled,typeof g.precedence=="string"&&p==null;default:return!0}case"script":if(g.async&&typeof g.async!="function"&&typeof g.async!="symbol"&&!g.onLoad&&!g.onError&&g.src&&typeof g.src=="string")return!0}return!1}function fB(p){return!(p.type==="stylesheet"&&(p.state.loading&3)===0)}var Pv=null;function yhe(){}function bhe(p,g,S){if(Pv===null)throw Error(r(475));var R=Pv;if(g.type==="stylesheet"&&(typeof S.media!="string"||matchMedia(S.media).matches!==!1)&&(g.state.loading&4)===0){if(g.instance===null){var P=a0(S.href),q=p.querySelector(Mv(P));if(q){p=q._p,p!==null&&typeof p=="object"&&typeof p.then=="function"&&(R.count++,R=M_.bind(R),p.then(R,R)),g.state.loading|=4,g.instance=q,kr(q);return}q=p.ownerDocument||p,S=lB(S),(P=Fl.get(P))&&dN(S,P),q=q.createElement("link"),kr(q);var he=q;he._p=new Promise(function(Oe,Ze){he.onload=Oe,he.onerror=Ze}),Sa(q,"link",S),g.instance=q}R.stylesheets===null&&(R.stylesheets=new Map),R.stylesheets.set(g,p),(p=g.state.preload)&&(g.state.loading&3)===0&&(R.count++,g=M_.bind(R),p.addEventListener("load",g),p.addEventListener("error",g))}}function vhe(){if(Pv===null)throw Error(r(475));var p=Pv;return p.stylesheets&&p.count===0&&hN(p,p.stylesheets),0<p.count?function(g){var S=setTimeout(function(){if(p.stylesheets&&hN(p,p.stylesheets),p.unsuspend){var R=p.unsuspend;p.unsuspend=null,R()}},6e4);return p.unsuspend=g,function(){p.unsuspend=null,clearTimeout(S)}}:null}function M_(){if(this.count--,this.count===0){if(this.stylesheets)hN(this,this.stylesheets);else if(this.unsuspend){var p=this.unsuspend;this.unsuspend=null,p()}}}var j_=null;function hN(p,g){p.stylesheets=null,p.unsuspend!==null&&(p.count++,j_=new Map,g.forEach(xhe,p),j_=null,M_.call(p))}function xhe(p,g){if(!(g.state.loading&4)){var S=j_.get(p);if(S)var R=S.get(null);else{S=new Map,j_.set(p,S);for(var P=p.querySelectorAll("link[data-precedence],style[data-precedence]"),q=0;q<P.length;q++){var he=P[q];(he.nodeName==="LINK"||he.getAttribute("media")!=="not all")&&(S.set(he.dataset.precedence,he),R=he)}R&&S.set(null,R)}P=g.instance,he=P.getAttribute("data-precedence"),q=S.get(he)||R,q===R&&S.set(null,P),S.set(he,P),this.count++,R=M_.bind(this),P.addEventListener("load",R),P.addEventListener("error",R),q?q.parentNode.insertBefore(P,q.nextSibling):(p=p.nodeType===9?p.head:p,p.insertBefore(P,p.firstChild)),g.state.loading|=4}}var Ov={$$typeof:_,Provider:null,Consumer:null,_currentValue:B,_currentValue2:B,_threadCount:0};function whe(p,g,S,R,P,q,he,Oe){this.tag=1,this.containerInfo=p,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=qe(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=qe(0),this.hiddenUpdates=qe(null),this.identifierPrefix=R,this.onUncaughtError=P,this.onCaughtError=q,this.onRecoverableError=he,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Oe,this.incompleteTransitions=new Map}function hB(p,g,S,R,P,q,he,Oe,Ze,_t,Dt,$t){return p=new whe(p,g,S,he,Oe,Ze,_t,$t),g=1,q===!0&&(g|=24),q=nl(3,null,null,g),p.current=q,q.stateNode=p,g=KA(),g.refCount++,p.pooledCache=g,g.refCount++,q.memoizedState={element:R,isDehydrated:S,cache:g},JA(q),p}function pB(p){return p?(p=au,p):au}function mB(p,g,S,R,P,q){P=pB(P),R.context===null?R.context=P:R.pendingContext=P,R=Vf(g),R.payload={element:S},q=q===void 0?null:q,q!==null&&(R.callback=q),S=Wf(p,R,g),S!==null&&(ol(S,p,g),dv(S,p,g))}function gB(p,g){if(p=p.memoizedState,p!==null&&p.dehydrated!==null){var S=p.retryLane;p.retryLane=S!==0&&S<g?S:g}}function pN(p,g){gB(p,g),(p=p.alternate)&&gB(p,g)}function yB(p){if(p.tag===13){var g=xc(p,67108864);g!==null&&ol(g,p,67108864),pN(p,67108864)}}var P_=!0;function She(p,g,S,R){var P=U.T;U.T=null;var q=W.p;try{W.p=2,mN(p,g,S,R)}finally{W.p=q,U.T=P}}function _he(p,g,S,R){var P=U.T;U.T=null;var q=W.p;try{W.p=8,mN(p,g,S,R)}finally{W.p=q,U.T=P}}function mN(p,g,S,R){if(P_){var P=gN(R);if(P===null)nN(p,g,R,O_,S),vB(p,R);else if(khe(P,p,g,S,R))R.stopPropagation();else if(vB(p,R),g&4&&-1<Che.indexOf(p)){for(;P!==null;){var q=Mr(P);if(q!==null)switch(q.tag){case 3:if(q=q.stateNode,q.current.memoizedState.isDehydrated){var he=ge(q.pendingLanes);if(he!==0){var Oe=q;for(Oe.pendingLanes|=2,Oe.entangledLanes|=2;he;){var Ze=1<<31-Yt(he);Oe.entanglements[1]|=Ze,he&=~Ze}du(q),(ys&6)===0&&(b_=ue()+500,Av(0))}}break;case 13:Oe=xc(q,2),Oe!==null&&ol(Oe,q,2),x_(),pN(q,2)}if(q=gN(R),q===null&&nN(p,g,R,O_,S),q===P)break;P=q}P!==null&&R.stopPropagation()}else nN(p,g,R,null,S)}}function gN(p){return p=wg(p),yN(p)}var O_=null;function yN(p){if(O_=null,p=br(p),p!==null){var g=i(p);if(g===null)p=null;else{var S=g.tag;if(S===13){if(p=a(g),p!==null)return p;p=null}else if(S===3){if(g.stateNode.current.memoizedState.isDehydrated)return g.tag===3?g.stateNode.containerInfo:null;p=null}else g!==p&&(p=null)}}return O_=p,null}function bB(p){switch(p){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(oe()){case se:return 2;case Ie:return 8;case Be:case Re:return 32;case ct:return 268435456;default:return 32}default:return 32}}var bN=!1,sh=null,ih=null,ah=null,Dv=new Map,Fv=new Map,oh=[],Che="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function vB(p,g){switch(p){case"focusin":case"focusout":sh=null;break;case"dragenter":case"dragleave":ih=null;break;case"mouseover":case"mouseout":ah=null;break;case"pointerover":case"pointerout":Dv.delete(g.pointerId);break;case"gotpointercapture":case"lostpointercapture":Fv.delete(g.pointerId)}}function Lv(p,g,S,R,P,q){return p===null||p.nativeEvent!==q?(p={blockedOn:g,domEventName:S,eventSystemFlags:R,nativeEvent:q,targetContainers:[P]},g!==null&&(g=Mr(g),g!==null&&yB(g)),p):(p.eventSystemFlags|=R,g=p.targetContainers,P!==null&&g.indexOf(P)===-1&&g.push(P),p)}function khe(p,g,S,R,P){switch(g){case"focusin":return sh=Lv(sh,p,g,S,R,P),!0;case"dragenter":return ih=Lv(ih,p,g,S,R,P),!0;case"mouseover":return ah=Lv(ah,p,g,S,R,P),!0;case"pointerover":var q=P.pointerId;return Dv.set(q,Lv(Dv.get(q)||null,p,g,S,R,P)),!0;case"gotpointercapture":return q=P.pointerId,Fv.set(q,Lv(Fv.get(q)||null,p,g,S,R,P)),!0}return!1}function xB(p){var g=br(p.target);if(g!==null){var S=i(g);if(S!==null){if(g=S.tag,g===13){if(g=a(S),g!==null){p.blockedOn=g,G(p.priority,function(){if(S.tag===13){var R=al();R=Ct(R);var P=xc(S,R);P!==null&&ol(P,S,R),pN(S,R)}});return}}else if(g===3&&S.stateNode.current.memoizedState.isDehydrated){p.blockedOn=S.tag===3?S.stateNode.containerInfo:null;return}}}p.blockedOn=null}function D_(p){if(p.blockedOn!==null)return!1;for(var g=p.targetContainers;0<g.length;){var S=gN(p.nativeEvent);if(S===null){S=p.nativeEvent;var R=new S.constructor(S.type,S);Rl=R,S.target.dispatchEvent(R),Rl=null}else return g=Mr(S),g!==null&&yB(g),p.blockedOn=S,!1;g.shift()}return!0}function wB(p,g,S){D_(p)&&S.delete(g)}function Ehe(){bN=!1,sh!==null&&D_(sh)&&(sh=null),ih!==null&&D_(ih)&&(ih=null),ah!==null&&D_(ah)&&(ah=null),Dv.forEach(wB),Fv.forEach(wB)}function F_(p,g){p.blockedOn===g&&(p.blockedOn=null,bN||(bN=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Ehe)))}var L_=null;function SB(p){L_!==p&&(L_=p,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){L_===p&&(L_=null);for(var g=0;g<p.length;g+=3){var S=p[g],R=p[g+1],P=p[g+2];if(typeof R!="function"){if(yN(R||S)===null)continue;break}var q=Mr(S);q!==null&&(p.splice(g,3),g-=3,yR(q,{pending:!0,data:P,method:S.method,action:R},R,P))}}))}function Bv(p){function g(Ze){return F_(Ze,p)}sh!==null&&F_(sh,p),ih!==null&&F_(ih,p),ah!==null&&F_(ah,p),Dv.forEach(g),Fv.forEach(g);for(var S=0;S<oh.length;S++){var R=oh[S];R.blockedOn===p&&(R.blockedOn=null)}for(;0<oh.length&&(S=oh[0],S.blockedOn===null);)xB(S),S.blockedOn===null&&oh.shift();if(S=(p.ownerDocument||p).$$reactFormReplay,S!=null)for(R=0;R<S.length;R+=3){var P=S[R],q=S[R+1],he=P[Fe]||null;if(typeof q=="function")he||SB(S);else if(he){var Oe=null;if(q&&q.hasAttribute("formAction")){if(P=q,he=q[Fe]||null)Oe=he.formAction;else if(yN(P)!==null)continue}else Oe=he.action;typeof Oe=="function"?S[R+1]=Oe:(S.splice(R,3),R-=3),SB(S)}}}function vN(p){this._internalRoot=p}B_.prototype.render=vN.prototype.render=function(p){var g=this._internalRoot;if(g===null)throw Error(r(409));var S=g.current,R=al();mB(S,R,p,g,null,null)},B_.prototype.unmount=vN.prototype.unmount=function(){var p=this._internalRoot;if(p!==null){this._internalRoot=null;var g=p.containerInfo;mB(p.current,2,null,p,null,null),x_(),g[He]=null}};function B_(p){this._internalRoot=p}B_.prototype.unstable_scheduleHydration=function(p){if(p){var g=Z();p={blockedOn:null,target:p,priority:g};for(var S=0;S<oh.length&&g!==0&&g<oh[S].priority;S++);oh.splice(S,0,p),S===0&&xB(p)}};var _B=t.version;if(_B!=="19.1.0")throw Error(r(527,_B,"19.1.0"));W.findDOMNode=function(p){var g=p._reactInternals;if(g===void 0)throw typeof p.render=="function"?Error(r(188)):(p=Object.keys(p).join(","),Error(r(268,p)));return p=l(g),p=p!==null?c(p):null,p=p===null?null:p.stateNode,p};var The={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:U,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var $_=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!$_.isDisabled&&$_.supportsFiber)try{Pt=$_.inject(The),Ut=$_}catch{}}return zv.createRoot=function(p,g){if(!s(p))throw Error(r(299));var S=!1,R="",P=B8,q=$8,he=z8,Oe=null;return g!=null&&(g.unstable_strictMode===!0&&(S=!0),g.identifierPrefix!==void 0&&(R=g.identifierPrefix),g.onUncaughtError!==void 0&&(P=g.onUncaughtError),g.onCaughtError!==void 0&&(q=g.onCaughtError),g.onRecoverableError!==void 0&&(he=g.onRecoverableError),g.unstable_transitionCallbacks!==void 0&&(Oe=g.unstable_transitionCallbacks)),g=hB(p,1,!1,null,null,S,R,P,q,he,Oe,null),p[He]=g.current,tN(p),new vN(g)},zv.hydrateRoot=function(p,g,S){if(!s(p))throw Error(r(299));var R=!1,P="",q=B8,he=$8,Oe=z8,Ze=null,_t=null;return S!=null&&(S.unstable_strictMode===!0&&(R=!0),S.identifierPrefix!==void 0&&(P=S.identifierPrefix),S.onUncaughtError!==void 0&&(q=S.onUncaughtError),S.onCaughtError!==void 0&&(he=S.onCaughtError),S.onRecoverableError!==void 0&&(Oe=S.onRecoverableError),S.unstable_transitionCallbacks!==void 0&&(Ze=S.unstable_transitionCallbacks),S.formState!==void 0&&(_t=S.formState)),g=hB(p,1,!0,g,S??null,R,P,q,he,Oe,Ze,_t),g.context=pB(null),S=g.current,R=al(),R=Ct(R),P=Vf(R),P.callback=null,Wf(S,P,R),S=R,g.current.lanes=S,tt(g,S),du(g),p[He]=g.current,tN(p),new B_(g)},zv.version="19.1.0",zv}var jB;function qhe(){if(jB)return SN.exports;jB=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),SN.exports=Uhe(),SN.exports}var Vhe=qhe();const Whe=ga(Vhe);function PB(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function wl(...e){return t=>{let n=!1;const r=e.map(s=>{const i=PB(s,t);return!n&&typeof i=="function"&&(n=!0),i});if(n)return()=>{for(let s=0;s<r.length;s++){const i=r[s];typeof i=="function"?i():PB(e[s],null)}}}}function Tn(...e){return E.useCallback(wl(...e),e)}function $u(e){const t=Hhe(e),n=E.forwardRef((r,s)=>{const{children:i,...a}=r,o=E.Children.toArray(i),l=o.find(Khe);if(l){const c=l.props.children,u=o.map(d=>d===l?E.Children.count(c)>1?E.Children.only(null):E.isValidElement(c)?c.props.children:null:d);return f.jsx(t,{...a,ref:s,children:E.isValidElement(c)?E.cloneElement(c,void 0,u):null})}return f.jsx(t,{...a,ref:s,children:i})});return n.displayName=`${e}.Slot`,n}var wH=$u("Slot");function Hhe(e){const t=E.forwardRef((n,r)=>{const{children:s,...i}=n;if(E.isValidElement(s)){const a=Zhe(s),o=Yhe(i,s.props);return s.type!==E.Fragment&&(o.ref=r?wl(r,a):a),E.cloneElement(s,o)}return E.Children.count(s)>1?E.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var Ghe=Symbol("radix.slottable");function Khe(e){return E.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===Ghe}function Yhe(e,t){const n={...t};for(const r in t){const s=e[r],i=t[r];/^on[A-Z]/.test(r)?s&&i?n[r]=(...o)=>{const l=i(...o);return s(...o),l}:s&&(n[r]=s):r==="style"?n[r]={...s,...i}:r==="className"&&(n[r]=[s,i].filter(Boolean).join(" "))}return{...e,...n}}function Zhe(e){var r,s;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(s=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:s.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}function SH(e){var t,n,r="";if(typeof e=="string"||typeof e=="number")r+=e;else if(typeof e=="object")if(Array.isArray(e)){var s=e.length;for(t=0;t<s;t++)e[t]&&(n=SH(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}function _H(){for(var e,t,n=0,r="",s=arguments.length;n<s;n++)(e=arguments[n])&&(t=SH(e))&&(r&&(r+=" "),r+=t);return r}const OB=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,DB=_H,Y4=(e,t)=>n=>{var r;if((t==null?void 0:t.variants)==null)return DB(e,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:s,defaultVariants:i}=t,a=Object.keys(s).map(c=>{const u=n==null?void 0:n[c],d=i==null?void 0:i[c];if(u===null)return null;const h=OB(u)||OB(d);return s[c][h]}),o=n&&Object.entries(n).reduce((c,u)=>{let[d,h]=u;return h===void 0||(c[d]=h),c},{}),l=t==null||(r=t.compoundVariants)===null||r===void 0?void 0:r.reduce((c,u)=>{let{class:d,className:h,...m}=u;return Object.entries(m).every(y=>{let[b,v]=y;return Array.isArray(v)?v.includes({...i,...o}[b]):{...i,...o}[b]===v})?[...c,d,h]:c},[]);return DB(e,a,l,n==null?void 0:n.class,n==null?void 0:n.className)},Z4="-",Xhe=e=>{const t=Qhe(e),{conflictingClassGroups:n,conflictingClassGroupModifiers:r}=e;return{getClassGroupId:a=>{const o=a.split(Z4);return o[0]===""&&o.length!==1&&o.shift(),CH(o,t)||Jhe(a)},getConflictingClassGroupIds:(a,o)=>{const l=n[a]||[];return o&&r[a]?[...l,...r[a]]:l}}},CH=(e,t)=>{var a;if(e.length===0)return t.classGroupId;const n=e[0],r=t.nextPart.get(n),s=r?CH(e.slice(1),r):void 0;if(s)return s;if(t.validators.length===0)return;const i=e.join(Z4);return(a=t.validators.find(({validator:o})=>o(i)))==null?void 0:a.classGroupId},FB=/^\[(.+)\]$/,Jhe=e=>{if(FB.test(e)){const t=FB.exec(e)[1],n=t==null?void 0:t.substring(0,t.indexOf(":"));if(n)return"arbitrary.."+n}},Qhe=e=>{const{theme:t,classGroups:n}=e,r={nextPart:new Map,validators:[]};for(const s in n)s3(n[s],r,s,t);return r},s3=(e,t,n,r)=>{e.forEach(s=>{if(typeof s=="string"){const i=s===""?t:LB(t,s);i.classGroupId=n;return}if(typeof s=="function"){if(epe(s)){s3(s(r),t,n,r);return}t.validators.push({validator:s,classGroupId:n});return}Object.entries(s).forEach(([i,a])=>{s3(a,LB(t,i),n,r)})})},LB=(e,t)=>{let n=e;return t.split(Z4).forEach(r=>{n.nextPart.has(r)||n.nextPart.set(r,{nextPart:new Map,validators:[]}),n=n.nextPart.get(r)}),n},epe=e=>e.isThemeGetter,tpe=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,n=new Map,r=new Map;const s=(i,a)=>{n.set(i,a),t++,t>e&&(t=0,r=n,n=new Map)};return{get(i){let a=n.get(i);if(a!==void 0)return a;if((a=r.get(i))!==void 0)return s(i,a),a},set(i,a){n.has(i)?n.set(i,a):s(i,a)}}},i3="!",a3=":",npe=a3.length,rpe=e=>{const{prefix:t,experimentalParseClassName:n}=e;let r=s=>{const i=[];let a=0,o=0,l=0,c;for(let y=0;y<s.length;y++){let b=s[y];if(a===0&&o===0){if(b===a3){i.push(s.slice(l,y)),l=y+npe;continue}if(b==="/"){c=y;continue}}b==="["?a++:b==="]"?a--:b==="("?o++:b===")"&&o--}const u=i.length===0?s:s.substring(l),d=spe(u),h=d!==u,m=c&&c>l?c-l:void 0;return{modifiers:i,hasImportantModifier:h,baseClassName:d,maybePostfixModifierPosition:m}};if(t){const s=t+a3,i=r;r=a=>a.startsWith(s)?i(a.substring(s.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:a,maybePostfixModifierPosition:void 0}}if(n){const s=r;r=i=>n({className:i,parseClassName:s})}return r},spe=e=>e.endsWith(i3)?e.substring(0,e.length-1):e.startsWith(i3)?e.substring(1):e,ipe=e=>{const t=Object.fromEntries(e.orderSensitiveModifiers.map(r=>[r,!0]));return r=>{if(r.length<=1)return r;const s=[];let i=[];return r.forEach(a=>{a[0]==="["||t[a]?(s.push(...i.sort(),a),i=[]):i.push(a)}),s.push(...i.sort()),s}},ape=e=>({cache:tpe(e.cacheSize),parseClassName:rpe(e),sortModifiers:ipe(e),...Xhe(e)}),ope=/\s+/,lpe=(e,t)=>{const{parseClassName:n,getClassGroupId:r,getConflictingClassGroupIds:s,sortModifiers:i}=t,a=[],o=e.trim().split(ope);let l="";for(let c=o.length-1;c>=0;c-=1){const u=o[c],{isExternal:d,modifiers:h,hasImportantModifier:m,baseClassName:y,maybePostfixModifierPosition:b}=n(u);if(d){l=u+(l.length>0?" "+l:l);continue}let v=!!b,x=r(v?y.substring(0,b):y);if(!x){if(!v){l=u+(l.length>0?" "+l:l);continue}if(x=r(y),!x){l=u+(l.length>0?" "+l:l);continue}v=!1}const w=i(h).join(":"),_=m?w+i3:w,k=_+x;if(a.includes(k))continue;a.push(k);const C=s(x,v);for(let T=0;T<C.length;++T){const A=C[T];a.push(_+A)}l=u+(l.length>0?" "+l:l)}return l};function cpe(){let e=0,t,n,r="";for(;e<arguments.length;)(t=arguments[e++])&&(n=kH(t))&&(r&&(r+=" "),r+=n);return r}const kH=e=>{if(typeof e=="string")return e;let t,n="";for(let r=0;r<e.length;r++)e[r]&&(t=kH(e[r]))&&(n&&(n+=" "),n+=t);return n};function upe(e,...t){let n,r,s,i=a;function a(l){const c=t.reduce((u,d)=>d(u),e());return n=ape(c),r=n.cache.get,s=n.cache.set,i=o,o(l)}function o(l){const c=r(l);if(c)return c;const u=lpe(l,n);return s(l,u),u}return function(){return i(cpe.apply(null,arguments))}}const Vi=e=>{const t=n=>n[e]||[];return t.isThemeGetter=!0,t},EH=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,TH=/^\((?:(\w[\w-]*):)?(.+)\)$/i,dpe=/^\d+\/\d+$/,fpe=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,hpe=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,ppe=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,mpe=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,gpe=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,l0=e=>dpe.test(e),Or=e=>!!e&&!Number.isNaN(Number(e)),ch=e=>!!e&&Number.isInteger(Number(e)),EN=e=>e.endsWith("%")&&Or(e.slice(0,-1)),Nd=e=>fpe.test(e),ype=()=>!0,bpe=e=>hpe.test(e)&&!ppe.test(e),AH=()=>!1,vpe=e=>mpe.test(e),xpe=e=>gpe.test(e),wpe=e=>!_n(e)&&!Cn(e),Spe=e=>Xy(e,IH,AH),_n=e=>EH.test(e),qp=e=>Xy(e,MH,bpe),TN=e=>Xy(e,Tpe,Or),BB=e=>Xy(e,RH,AH),_pe=e=>Xy(e,NH,xpe),z_=e=>Xy(e,jH,vpe),Cn=e=>TH.test(e),Uv=e=>Jy(e,MH),Cpe=e=>Jy(e,Ape),$B=e=>Jy(e,RH),kpe=e=>Jy(e,IH),Epe=e=>Jy(e,NH),U_=e=>Jy(e,jH,!0),Xy=(e,t,n)=>{const r=EH.exec(e);return r?r[1]?t(r[1]):n(r[2]):!1},Jy=(e,t,n=!1)=>{const r=TH.exec(e);return r?r[1]?t(r[1]):n:!1},RH=e=>e==="position"||e==="percentage",NH=e=>e==="image"||e==="url",IH=e=>e==="length"||e==="size"||e==="bg-size",MH=e=>e==="length",Tpe=e=>e==="number",Ape=e=>e==="family-name",jH=e=>e==="shadow",Rpe=()=>{const e=Vi("color"),t=Vi("font"),n=Vi("text"),r=Vi("font-weight"),s=Vi("tracking"),i=Vi("leading"),a=Vi("breakpoint"),o=Vi("container"),l=Vi("spacing"),c=Vi("radius"),u=Vi("shadow"),d=Vi("inset-shadow"),h=Vi("text-shadow"),m=Vi("drop-shadow"),y=Vi("blur"),b=Vi("perspective"),v=Vi("aspect"),x=Vi("ease"),w=Vi("animate"),_=()=>["auto","avoid","all","avoid-page","page","left","right","column"],k=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],C=()=>[...k(),Cn,_n],T=()=>["auto","hidden","clip","visible","scroll"],A=()=>["auto","contain","none"],N=()=>[Cn,_n,l],I=()=>[l0,"full","auto",...N()],j=()=>[ch,"none","subgrid",Cn,_n],L=()=>["auto",{span:["full",ch,Cn,_n]},ch,Cn,_n],D=()=>[ch,"auto",Cn,_n],H=()=>["auto","min","max","fr",Cn,_n],O=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],K=()=>["start","end","center","stretch","center-safe","end-safe"],U=()=>["auto",...N()],W=()=>[l0,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...N()],B=()=>[e,Cn,_n],ne=()=>[...k(),$B,BB,{position:[Cn,_n]}],V=()=>["no-repeat",{repeat:["","x","y","space","round"]}],Q=()=>["auto","cover","contain",kpe,Spe,{size:[Cn,_n]}],ee=()=>[EN,Uv,qp],re=()=>["","none","full",c,Cn,_n],de=()=>["",Or,Uv,qp],me=()=>["solid","dashed","dotted","double"],De=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],je=()=>[Or,EN,$B,BB],Te=()=>["","none",y,Cn,_n],_e=()=>["none",Or,Cn,_n],Ue=()=>["none",Or,Cn,_n],Qe=()=>[Or,Cn,_n],We=()=>[l0,"full",...N()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[Nd],breakpoint:[Nd],color:[ype],container:[Nd],"drop-shadow":[Nd],ease:["in","out","in-out"],font:[wpe],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[Nd],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[Nd],shadow:[Nd],spacing:["px",Or],text:[Nd],"text-shadow":[Nd],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",l0,_n,Cn,v]}],container:["container"],columns:[{columns:[Or,_n,Cn,o]}],"break-after":[{"break-after":_()}],"break-before":[{"break-before":_()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:C()}],overflow:[{overflow:T()}],"overflow-x":[{"overflow-x":T()}],"overflow-y":[{"overflow-y":T()}],overscroll:[{overscroll:A()}],"overscroll-x":[{"overscroll-x":A()}],"overscroll-y":[{"overscroll-y":A()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:I()}],"inset-x":[{"inset-x":I()}],"inset-y":[{"inset-y":I()}],start:[{start:I()}],end:[{end:I()}],top:[{top:I()}],right:[{right:I()}],bottom:[{bottom:I()}],left:[{left:I()}],visibility:["visible","invisible","collapse"],z:[{z:[ch,"auto",Cn,_n]}],basis:[{basis:[l0,"full","auto",o,...N()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[Or,l0,"auto","initial","none",_n]}],grow:[{grow:["",Or,Cn,_n]}],shrink:[{shrink:["",Or,Cn,_n]}],order:[{order:[ch,"first","last","none",Cn,_n]}],"grid-cols":[{"grid-cols":j()}],"col-start-end":[{col:L()}],"col-start":[{"col-start":D()}],"col-end":[{"col-end":D()}],"grid-rows":[{"grid-rows":j()}],"row-start-end":[{row:L()}],"row-start":[{"row-start":D()}],"row-end":[{"row-end":D()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":H()}],"auto-rows":[{"auto-rows":H()}],gap:[{gap:N()}],"gap-x":[{"gap-x":N()}],"gap-y":[{"gap-y":N()}],"justify-content":[{justify:[...O(),"normal"]}],"justify-items":[{"justify-items":[...K(),"normal"]}],"justify-self":[{"justify-self":["auto",...K()]}],"align-content":[{content:["normal",...O()]}],"align-items":[{items:[...K(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...K(),{baseline:["","last"]}]}],"place-content":[{"place-content":O()}],"place-items":[{"place-items":[...K(),"baseline"]}],"place-self":[{"place-self":["auto",...K()]}],p:[{p:N()}],px:[{px:N()}],py:[{py:N()}],ps:[{ps:N()}],pe:[{pe:N()}],pt:[{pt:N()}],pr:[{pr:N()}],pb:[{pb:N()}],pl:[{pl:N()}],m:[{m:U()}],mx:[{mx:U()}],my:[{my:U()}],ms:[{ms:U()}],me:[{me:U()}],mt:[{mt:U()}],mr:[{mr:U()}],mb:[{mb:U()}],ml:[{ml:U()}],"space-x":[{"space-x":N()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":N()}],"space-y-reverse":["space-y-reverse"],size:[{size:W()}],w:[{w:[o,"screen",...W()]}],"min-w":[{"min-w":[o,"screen","none",...W()]}],"max-w":[{"max-w":[o,"screen","none","prose",{screen:[a]},...W()]}],h:[{h:["screen",...W()]}],"min-h":[{"min-h":["screen","none",...W()]}],"max-h":[{"max-h":["screen",...W()]}],"font-size":[{text:["base",n,Uv,qp]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[r,Cn,TN]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",EN,_n]}],"font-family":[{font:[Cpe,_n,t]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[s,Cn,_n]}],"line-clamp":[{"line-clamp":[Or,"none",Cn,TN]}],leading:[{leading:[i,...N()]}],"list-image":[{"list-image":["none",Cn,_n]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",Cn,_n]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:B()}],"text-color":[{text:B()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...me(),"wavy"]}],"text-decoration-thickness":[{decoration:[Or,"from-font","auto",Cn,qp]}],"text-decoration-color":[{decoration:B()}],"underline-offset":[{"underline-offset":[Or,"auto",Cn,_n]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:N()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Cn,_n]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Cn,_n]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:ne()}],"bg-repeat":[{bg:V()}],"bg-size":[{bg:Q()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},ch,Cn,_n],radial:["",Cn,_n],conic:[ch,Cn,_n]},Epe,_pe]}],"bg-color":[{bg:B()}],"gradient-from-pos":[{from:ee()}],"gradient-via-pos":[{via:ee()}],"gradient-to-pos":[{to:ee()}],"gradient-from":[{from:B()}],"gradient-via":[{via:B()}],"gradient-to":[{to:B()}],rounded:[{rounded:re()}],"rounded-s":[{"rounded-s":re()}],"rounded-e":[{"rounded-e":re()}],"rounded-t":[{"rounded-t":re()}],"rounded-r":[{"rounded-r":re()}],"rounded-b":[{"rounded-b":re()}],"rounded-l":[{"rounded-l":re()}],"rounded-ss":[{"rounded-ss":re()}],"rounded-se":[{"rounded-se":re()}],"rounded-ee":[{"rounded-ee":re()}],"rounded-es":[{"rounded-es":re()}],"rounded-tl":[{"rounded-tl":re()}],"rounded-tr":[{"rounded-tr":re()}],"rounded-br":[{"rounded-br":re()}],"rounded-bl":[{"rounded-bl":re()}],"border-w":[{border:de()}],"border-w-x":[{"border-x":de()}],"border-w-y":[{"border-y":de()}],"border-w-s":[{"border-s":de()}],"border-w-e":[{"border-e":de()}],"border-w-t":[{"border-t":de()}],"border-w-r":[{"border-r":de()}],"border-w-b":[{"border-b":de()}],"border-w-l":[{"border-l":de()}],"divide-x":[{"divide-x":de()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":de()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...me(),"hidden","none"]}],"divide-style":[{divide:[...me(),"hidden","none"]}],"border-color":[{border:B()}],"border-color-x":[{"border-x":B()}],"border-color-y":[{"border-y":B()}],"border-color-s":[{"border-s":B()}],"border-color-e":[{"border-e":B()}],"border-color-t":[{"border-t":B()}],"border-color-r":[{"border-r":B()}],"border-color-b":[{"border-b":B()}],"border-color-l":[{"border-l":B()}],"divide-color":[{divide:B()}],"outline-style":[{outline:[...me(),"none","hidden"]}],"outline-offset":[{"outline-offset":[Or,Cn,_n]}],"outline-w":[{outline:["",Or,Uv,qp]}],"outline-color":[{outline:B()}],shadow:[{shadow:["","none",u,U_,z_]}],"shadow-color":[{shadow:B()}],"inset-shadow":[{"inset-shadow":["none",d,U_,z_]}],"inset-shadow-color":[{"inset-shadow":B()}],"ring-w":[{ring:de()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:B()}],"ring-offset-w":[{"ring-offset":[Or,qp]}],"ring-offset-color":[{"ring-offset":B()}],"inset-ring-w":[{"inset-ring":de()}],"inset-ring-color":[{"inset-ring":B()}],"text-shadow":[{"text-shadow":["none",h,U_,z_]}],"text-shadow-color":[{"text-shadow":B()}],opacity:[{opacity:[Or,Cn,_n]}],"mix-blend":[{"mix-blend":[...De(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":De()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[Or]}],"mask-image-linear-from-pos":[{"mask-linear-from":je()}],"mask-image-linear-to-pos":[{"mask-linear-to":je()}],"mask-image-linear-from-color":[{"mask-linear-from":B()}],"mask-image-linear-to-color":[{"mask-linear-to":B()}],"mask-image-t-from-pos":[{"mask-t-from":je()}],"mask-image-t-to-pos":[{"mask-t-to":je()}],"mask-image-t-from-color":[{"mask-t-from":B()}],"mask-image-t-to-color":[{"mask-t-to":B()}],"mask-image-r-from-pos":[{"mask-r-from":je()}],"mask-image-r-to-pos":[{"mask-r-to":je()}],"mask-image-r-from-color":[{"mask-r-from":B()}],"mask-image-r-to-color":[{"mask-r-to":B()}],"mask-image-b-from-pos":[{"mask-b-from":je()}],"mask-image-b-to-pos":[{"mask-b-to":je()}],"mask-image-b-from-color":[{"mask-b-from":B()}],"mask-image-b-to-color":[{"mask-b-to":B()}],"mask-image-l-from-pos":[{"mask-l-from":je()}],"mask-image-l-to-pos":[{"mask-l-to":je()}],"mask-image-l-from-color":[{"mask-l-from":B()}],"mask-image-l-to-color":[{"mask-l-to":B()}],"mask-image-x-from-pos":[{"mask-x-from":je()}],"mask-image-x-to-pos":[{"mask-x-to":je()}],"mask-image-x-from-color":[{"mask-x-from":B()}],"mask-image-x-to-color":[{"mask-x-to":B()}],"mask-image-y-from-pos":[{"mask-y-from":je()}],"mask-image-y-to-pos":[{"mask-y-to":je()}],"mask-image-y-from-color":[{"mask-y-from":B()}],"mask-image-y-to-color":[{"mask-y-to":B()}],"mask-image-radial":[{"mask-radial":[Cn,_n]}],"mask-image-radial-from-pos":[{"mask-radial-from":je()}],"mask-image-radial-to-pos":[{"mask-radial-to":je()}],"mask-image-radial-from-color":[{"mask-radial-from":B()}],"mask-image-radial-to-color":[{"mask-radial-to":B()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":k()}],"mask-image-conic-pos":[{"mask-conic":[Or]}],"mask-image-conic-from-pos":[{"mask-conic-from":je()}],"mask-image-conic-to-pos":[{"mask-conic-to":je()}],"mask-image-conic-from-color":[{"mask-conic-from":B()}],"mask-image-conic-to-color":[{"mask-conic-to":B()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:ne()}],"mask-repeat":[{mask:V()}],"mask-size":[{mask:Q()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",Cn,_n]}],filter:[{filter:["","none",Cn,_n]}],blur:[{blur:Te()}],brightness:[{brightness:[Or,Cn,_n]}],contrast:[{contrast:[Or,Cn,_n]}],"drop-shadow":[{"drop-shadow":["","none",m,U_,z_]}],"drop-shadow-color":[{"drop-shadow":B()}],grayscale:[{grayscale:["",Or,Cn,_n]}],"hue-rotate":[{"hue-rotate":[Or,Cn,_n]}],invert:[{invert:["",Or,Cn,_n]}],saturate:[{saturate:[Or,Cn,_n]}],sepia:[{sepia:["",Or,Cn,_n]}],"backdrop-filter":[{"backdrop-filter":["","none",Cn,_n]}],"backdrop-blur":[{"backdrop-blur":Te()}],"backdrop-brightness":[{"backdrop-brightness":[Or,Cn,_n]}],"backdrop-contrast":[{"backdrop-contrast":[Or,Cn,_n]}],"backdrop-grayscale":[{"backdrop-grayscale":["",Or,Cn,_n]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[Or,Cn,_n]}],"backdrop-invert":[{"backdrop-invert":["",Or,Cn,_n]}],"backdrop-opacity":[{"backdrop-opacity":[Or,Cn,_n]}],"backdrop-saturate":[{"backdrop-saturate":[Or,Cn,_n]}],"backdrop-sepia":[{"backdrop-sepia":["",Or,Cn,_n]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":N()}],"border-spacing-x":[{"border-spacing-x":N()}],"border-spacing-y":[{"border-spacing-y":N()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",Cn,_n]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[Or,"initial",Cn,_n]}],ease:[{ease:["linear","initial",x,Cn,_n]}],delay:[{delay:[Or,Cn,_n]}],animate:[{animate:["none",w,Cn,_n]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[b,Cn,_n]}],"perspective-origin":[{"perspective-origin":C()}],rotate:[{rotate:_e()}],"rotate-x":[{"rotate-x":_e()}],"rotate-y":[{"rotate-y":_e()}],"rotate-z":[{"rotate-z":_e()}],scale:[{scale:Ue()}],"scale-x":[{"scale-x":Ue()}],"scale-y":[{"scale-y":Ue()}],"scale-z":[{"scale-z":Ue()}],"scale-3d":["scale-3d"],skew:[{skew:Qe()}],"skew-x":[{"skew-x":Qe()}],"skew-y":[{"skew-y":Qe()}],transform:[{transform:[Cn,_n,"","none","gpu","cpu"]}],"transform-origin":[{origin:C()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:We()}],"translate-x":[{"translate-x":We()}],"translate-y":[{"translate-y":We()}],"translate-z":[{"translate-z":We()}],"translate-none":["translate-none"],accent:[{accent:B()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:B()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Cn,_n]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":N()}],"scroll-mx":[{"scroll-mx":N()}],"scroll-my":[{"scroll-my":N()}],"scroll-ms":[{"scroll-ms":N()}],"scroll-me":[{"scroll-me":N()}],"scroll-mt":[{"scroll-mt":N()}],"scroll-mr":[{"scroll-mr":N()}],"scroll-mb":[{"scroll-mb":N()}],"scroll-ml":[{"scroll-ml":N()}],"scroll-p":[{"scroll-p":N()}],"scroll-px":[{"scroll-px":N()}],"scroll-py":[{"scroll-py":N()}],"scroll-ps":[{"scroll-ps":N()}],"scroll-pe":[{"scroll-pe":N()}],"scroll-pt":[{"scroll-pt":N()}],"scroll-pr":[{"scroll-pr":N()}],"scroll-pb":[{"scroll-pb":N()}],"scroll-pl":[{"scroll-pl":N()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Cn,_n]}],fill:[{fill:["none",...B()]}],"stroke-w":[{stroke:[Or,Uv,qp,TN]}],stroke:[{stroke:["none",...B()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},Npe=upe(Rpe);function Ye(...e){return Npe(_H(e))}const o3=Y4("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function ot({className:e,variant:t,size:n,asChild:r=!1,...s}){const i=r?wH:"button";return f.jsx(i,{"data-slot":"button",className:Ye(o3({variant:t,size:n,className:e})),...s})}/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ipe=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Mpe=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,n,r)=>r?r.toUpperCase():n.toLowerCase()),zB=e=>{const t=Mpe(e);return t.charAt(0).toUpperCase()+t.slice(1)},PH=(...e)=>e.filter((t,n,r)=>!!t&&t.trim()!==""&&r.indexOf(t)===n).join(" ").trim();/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var jpe={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ppe=E.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:s="",children:i,iconNode:a,...o},l)=>E.createElement("svg",{ref:l,...jpe,width:t,height:t,stroke:e,strokeWidth:r?Number(n)*24/Number(t):n,className:PH("lucide",s),...o},[...a.map(([c,u])=>E.createElement(c,u)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bt=(e,t)=>{const n=E.forwardRef(({className:r,...s},i)=>E.createElement(Ppe,{ref:i,iconNode:t,className:PH(`lucide-${Ipe(zB(e))}`,`lucide-${e}`,r),...s}));return n.displayName=zB(e),n};/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ope=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],OH=Bt("archive",Ope);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dpe=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],DH=Bt("arrow-down",Dpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fpe=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],Lpe=Bt("arrow-left",Fpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bpe=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],$pe=Bt("arrow-right",Bpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zpe=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],Upe=Bt("arrow-up",zpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qpe=[["path",{d:"m14 12-8.5 8.5a2.12 2.12 0 1 1-3-3L11 9",key:"csbz4o"}],["path",{d:"M15 13 9 7l4-4 6 6h3a8 8 0 0 1-7 7z",key:"113wfo"}]],Vpe=Bt("axe",qpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wpe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]],Hpe=Bt("ban",Wpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gpe=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M16 12h2",key:"7q9ll5"}],["path",{d:"M16 8h2",key:"msurwy"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}],["path",{d:"M6 12h2",key:"32wvfc"}],["path",{d:"M6 8h2",key:"30oboj"}]],Kpe=Bt("book-open-text",Gpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ype=[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]],Em=Bt("bot",Ype);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zpe=[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M9 13a4.5 4.5 0 0 0 3-4",key:"10igwf"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M12 13h4",key:"1ku699"}],["path",{d:"M12 18h6a2 2 0 0 1 2 2v1",key:"105ag5"}],["path",{d:"M12 8h8",key:"1lhi5i"}],["path",{d:"M16 8V5a2 2 0 0 1 2-2",key:"u6izg6"}],["circle",{cx:"16",cy:"13",r:".5",key:"ry7gng"}],["circle",{cx:"18",cy:"3",r:".5",key:"1aiba7"}],["circle",{cx:"20",cy:"21",r:".5",key:"yhc1fs"}],["circle",{cx:"20",cy:"8",r:".5",key:"1e43v0"}]],Qy=Bt("brain-circuit",Zpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xpe=[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]],v2=Bt("brain",Xpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jpe=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],Qpe=Bt("calendar",Jpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eme=[["rect",{width:"18",height:"14",x:"3",y:"5",rx:"2",ry:"2",key:"12ruh7"}],["path",{d:"M7 15h4M15 15h2M7 11h2M13 11h4",key:"1ueiar"}]],tme=Bt("captions",eme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nme=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],bo=Bt("check",nme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rme=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],uc=Bt("chevron-down",rme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sme=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],ime=Bt("chevron-left",sme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ame=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],X4=Bt("chevron-right",ame);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ome=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],tp=Bt("chevron-up",ome);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lme=[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]],EE=Bt("chevrons-up-down",lme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cme=[["path",{d:"m17 11-5-5-5 5",key:"e8nh98"}],["path",{d:"m17 18-5-5-5 5",key:"2avn1x"}]],ume=Bt("chevrons-up",cme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dme=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Sl=Bt("circle-alert",dme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fme=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],hme=Bt("circle-check-big",fme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pme=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],C1=Bt("circle-check",pme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mme=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["rect",{x:"9",y:"9",width:"6",height:"6",rx:"1",key:"1ssd4o"}]],gme=Bt("circle-stop",mme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yme=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],FH=Bt("circle",yme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bme=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],l3=Bt("circle-x",bme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vme=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]],TE=Bt("clipboard",vme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xme=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]],wme=Bt("clock",xme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sme=[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]],J4=Bt("cloud-upload",Sme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _me=[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]],AE=Bt("code",_me);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cme=[["path",{d:"M12 20a8 8 0 1 0 0-16 8 8 0 0 0 0 16Z",key:"sobvz5"}],["path",{d:"M12 14a2 2 0 1 0 0-4 2 2 0 0 0 0 4Z",key:"11i496"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 22v-2",key:"1osdcq"}],["path",{d:"m17 20.66-1-1.73",key:"eq3orb"}],["path",{d:"M11 10.27 7 3.34",key:"16pf9h"}],["path",{d:"m20.66 17-1.73-1",key:"sg0v6f"}],["path",{d:"m3.34 7 1.73 1",key:"1ulond"}],["path",{d:"M14 12h8",key:"4f43i9"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"m20.66 7-1.73 1",key:"1ow05n"}],["path",{d:"m3.34 17 1.73-1",key:"nuk764"}],["path",{d:"m17 3.34-1 1.73",key:"2wel8s"}],["path",{d:"m11 13.73-4 6.93",key:"794ttg"}]],kme=Bt("cog",Cme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eme=[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]],Tme=Bt("coins",Eme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ame=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],Rme=Bt("copy",Ame);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nme=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],Ime=Bt("dollar-sign",Nme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mme=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]],Fc=Bt("download",Mme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jme=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]],Pme=Bt("ellipsis-vertical",jme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ome=[["path",{d:"M10 12v-1",key:"v7bkov"}],["path",{d:"M10 18v-2",key:"1cjy8d"}],["path",{d:"M10 7V6",key:"dljcrl"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M15.5 22H18a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v16a2 2 0 0 0 .274 1.01",key:"gkbcor"}],["circle",{cx:"10",cy:"20",r:"2",key:"1xzdoj"}]],Dme=Bt("file-archive",Ome);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fme=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]],Lme=Bt("file-down",Fme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bme=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 12a1 1 0 0 0-1 1v1a1 1 0 0 1-1 1 1 1 0 0 1 1 1v1a1 1 0 0 0 1 1",key:"1oajmo"}],["path",{d:"M14 18a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1 1 1 0 0 1-1-1v-1a1 1 0 0 0-1-1",key:"mpwhp6"}]],$me=Bt("file-json",Bme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zme=[["path",{d:"M12 17h.01",key:"p32p05"}],["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7z",key:"1mlx9k"}],["path",{d:"M9.1 9a3 3 0 0 1 5.82 1c0 2-3 3-3 3",key:"mhlwft"}]],Ume=Bt("file-question",zme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qme=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],c3=Bt("file-text",qme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vme=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 12v6",key:"3ahymv"}],["path",{d:"m15 15-3-3-3 3",key:"15xj92"}]],Wme=Bt("file-up",Vme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hme=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]],LH=Bt("file",Hme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gme=[["circle",{cx:"12",cy:"13",r:"2",key:"1c1ljs"}],["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}],["path",{d:"M14 13h3",key:"1dgedf"}],["path",{d:"M7 13h3",key:"1pygq7"}]],BH=Bt("folder-git",Gme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kme=[["path",{d:"M12 10v6",key:"1bos4e"}],["path",{d:"M9 13h6",key:"1uhe8q"}],["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],$H=Bt("folder-plus",Kme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yme=[["path",{d:"M20 10a1 1 0 0 0 1-1V6a1 1 0 0 0-1-1h-2.5a1 1 0 0 1-.8-.4l-.9-1.2A1 1 0 0 0 15 3h-2a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1Z",key:"hod4my"}],["path",{d:"M20 21a1 1 0 0 0 1-1v-3a1 1 0 0 0-1-1h-2.9a1 1 0 0 1-.88-.55l-.42-.85a1 1 0 0 0-.92-.6H13a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1Z",key:"w4yl2u"}],["path",{d:"M3 5a2 2 0 0 0 2 2h3",key:"f2jnh7"}],["path",{d:"M3 3v13a2 2 0 0 0 2 2h3",key:"k8epm1"}]],UB=Bt("folder-tree",Yme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zme=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}],["path",{d:"M12 10v6",key:"1bos4e"}],["path",{d:"m9 13 3-3 3 3",key:"1pxg3c"}]],Xme=Bt("folder-up",Zme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jme=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],Ih=Bt("folder",Jme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qme=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],ege=Bt("funnel",Qme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tge=[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]],qc=Bt("git-branch",tge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nge=[["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}],["line",{x1:"3",x2:"9",y1:"12",y2:"12",key:"1dyftd"}],["line",{x1:"15",x2:"21",y1:"12",y2:"12",key:"oup4p8"}]],zH=Bt("git-commit-horizontal",nge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rge=[["circle",{cx:"12",cy:"18",r:"3",key:"1mpf1b"}],["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["path",{d:"M18 9v2c0 .6-.4 1-1 1H7c-.6 0-1-.4-1-1V9",key:"1uq4wg"}],["path",{d:"M12 12v3",key:"158kv8"}]],UH=Bt("git-fork",rge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sge=[["circle",{cx:"18",cy:"18",r:"3",key:"1xkwt0"}],["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M6 21V9a9 9 0 0 0 9 9",key:"7kw0sc"}]],qH=Bt("git-merge",sge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ige=[["circle",{cx:"18",cy:"18",r:"3",key:"1xkwt0"}],["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M13 6h3a2 2 0 0 1 2 2v7",key:"1yeb86"}],["line",{x1:"6",x2:"6",y1:"9",y2:"21",key:"rroup"}]],Q4=Bt("git-pull-request",ige);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const age=[["path",{d:"M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4",key:"tonef"}],["path",{d:"M9 18c-4.51 2-5-2-7-2",key:"9comsn"}]],oge=Bt("github",age);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lge=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],x2=Bt("globe",lge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cge=[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]],uge=Bt("grip-vertical",cge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dge=[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]],eO=Bt("hard-drive",dge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fge=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],hge=Bt("history",fge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pge=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]],mge=Bt("house",pge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gge=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],Mh=Bt("image",gge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yge=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],tO=Bt("info",yge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bge=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],nw=Bt("key",bge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vge=[["path",{d:"m12 8 6-3-6-3v10",key:"mvpnpy"}],["path",{d:"m8 11.99-5.5 3.14a1 1 0 0 0 0 1.74l8.5 4.86a2 2 0 0 0 2 0l8.5-4.86a1 1 0 0 0 0-1.74L16 12",key:"ek95tt"}],["path",{d:"m6.49 12.85 11.02 6.3",key:"1kt42w"}],["path",{d:"M17.51 12.85 6.5 19.15",key:"v55bdg"}]],VH=Bt("land-plot",vge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xge=[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]],wge=Bt("lightbulb",xge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sge=[["path",{d:"M21 6H3",key:"1jwq7v"}],["path",{d:"M7 12H3",key:"13ou7f"}],["path",{d:"M7 18H3",key:"1sijw9"}],["path",{d:"M12 18a5 5 0 0 0 9-3 4.5 4.5 0 0 0-4.5-4.5c-1.33 0-2.54.54-3.41 1.41L11 14",key:"qth677"}],["path",{d:"M11 10v4h4",key:"172dkj"}]],_ge=Bt("list-restart",Sge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cge=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Hn=Bt("loader-circle",Cge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kge=[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]],Ege=Bt("menu",kge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tge=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}],["path",{d:"M12 7v6",key:"lw1j43"}],["path",{d:"M9 10h6",key:"9gxzsh"}]],Age=Bt("message-square-plus",Tge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rge=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}],["path",{d:"M13 8H7",key:"14i4kc"}],["path",{d:"M17 12H7",key:"16if0g"}]],qB=Bt("message-square-text",Rge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nge=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]],u3=Bt("message-square",Nge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ige=[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]],Mge=Bt("music",Ige);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jge=[["path",{d:"M13.4 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-7.4",key:"re6nr2"}],["path",{d:"M2 6h4",key:"aawbzj"}],["path",{d:"M2 10h4",key:"l0bgd4"}],["path",{d:"M2 14h4",key:"1gsvsf"}],["path",{d:"M2 18h4",key:"1bu2t1"}],["path",{d:"M21.378 5.626a1 1 0 1 0-3.004-3.004l-5.01 5.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z",key:"pqwjuv"}]],nO=Bt("notebook-pen",jge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pge=[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]],cy=Bt("palette",Pge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oge=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"m16 15-3-3 3-3",key:"14y99z"}]],Dge=Bt("panel-left-close",Oge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fge=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M15 3v18",key:"14nvp0"}],["path",{d:"m8 9 3 3-3 3",key:"12hl5m"}]],Lge=Bt("panel-right-close",Fge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bge=[["path",{d:"M13.234 20.252 21 12.3",key:"1cbrk9"}],["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 0 2.828 2 2 0 0 0 2.828 0l8.414-8.586a4 4 0 0 0 0-5.656 4 4 0 0 0-5.656 0l-8.415 8.585a6 6 0 1 0 8.486 8.486",key:"1pkts6"}]],RE=Bt("paperclip",Bge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $ge=[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]],zge=Bt("pause",$ge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uge=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],k1=Bt("pen",Uge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qge=[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]],WH=Bt("play",qge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vge=[["path",{d:"M12 22v-5",key:"1ega77"}],["path",{d:"M9 8V2",key:"14iosj"}],["path",{d:"M15 8V2",key:"18g5xt"}],["path",{d:"M18 8v5a4 4 0 0 1-4 4h-4a4 4 0 0 1-4-4V8Z",key:"osxo6l"}]],VB=Bt("plug",Vge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wge=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],nc=Bt("plus",Wge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hge=[["path",{d:"M15.39 4.39a1 1 0 0 0 1.68-.474 2.5 2.5 0 1 1 3.014 3.015 1 1 0 0 0-.474 1.68l1.683 1.682a2.414 2.414 0 0 1 0 3.414L19.61 15.39a1 1 0 0 1-1.68-.474 2.5 2.5 0 1 0-3.014 3.015 1 1 0 0 1 .474 1.68l-1.683 1.682a2.414 2.414 0 0 1-3.414 0L8.61 19.61a1 1 0 0 0-1.68.474 2.5 2.5 0 1 1-3.014-3.015 1 1 0 0 0 .474-1.68l-1.683-1.682a2.414 2.414 0 0 1 0-3.414L4.39 8.61a1 1 0 0 1 1.68.474 2.5 2.5 0 1 0 3.014-3.015 1 1 0 0 1-.474-1.68l1.683-1.682a2.414 2.414 0 0 1 3.414 0z",key:"w46dr5"}]],WB=Bt("puzzle",Hge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gge=[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}],["path",{d:"M12 12h.01",key:"1mp3jc"}],["path",{d:"M17 12h.01",key:"1m0b6t"}],["path",{d:"M7 12h.01",key:"eqddd0"}]],Kge=Bt("rectangle-ellipsis",Gge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yge=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],Tm=Bt("refresh-cw",Yge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zge=[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]],Xge=Bt("rocket",Zge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jge=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],E1=Bt("rotate-ccw",Jge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qge=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],Yu=Bt("save",Qge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e0e=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]],vo=Bt("search",e0e);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t0e=[["path",{d:"M3.714 3.048a.498.498 0 0 0-.683.627l2.843 7.627a2 2 0 0 1 0 1.396l-2.842 7.627a.498.498 0 0 0 .682.627l18-8.5a.5.5 0 0 0 0-.904z",key:"117uat"}],["path",{d:"M6 12h16",key:"s4cdu5"}]],n0e=Bt("send-horizontal",t0e);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r0e=[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]],uy=Bt("server",r0e);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s0e=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],jh=Bt("settings",s0e);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i0e=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]],HB=Bt("shield-alert",i0e);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a0e=[["line",{x1:"21",x2:"14",y1:"4",y2:"4",key:"obuewd"}],["line",{x1:"10",x2:"3",y1:"4",y2:"4",key:"1q6298"}],["line",{x1:"21",x2:"12",y1:"12",y2:"12",key:"1iu8h1"}],["line",{x1:"8",x2:"3",y1:"12",y2:"12",key:"ntss68"}],["line",{x1:"21",x2:"16",y1:"20",y2:"20",key:"14d8ph"}],["line",{x1:"12",x2:"3",y1:"20",y2:"20",key:"m0wm8r"}],["line",{x1:"14",x2:"14",y1:"2",y2:"6",key:"14e1ph"}],["line",{x1:"8",x2:"8",y1:"10",y2:"14",key:"1i6ji0"}],["line",{x1:"16",x2:"16",y1:"18",y2:"22",key:"1lctlv"}]],o0e=Bt("sliders-horizontal",a0e);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l0e=[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]],HH=Bt("sparkles",l0e);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c0e=[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}]],GB=Bt("sparkle",c0e);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u0e=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],Ah=Bt("square-pen",u0e);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d0e=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],f0e=Bt("square",d0e);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h0e=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],KB=Bt("star",h0e);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p0e=[["path",{d:"m15 5 6.3 6.3a2.4 2.4 0 0 1 0 3.4L17 19",key:"1cbfv1"}],["path",{d:"M9.586 5.586A2 2 0 0 0 8.172 5H3a1 1 0 0 0-1 1v5.172a2 2 0 0 0 .586 1.414L8.29 18.29a2.426 2.426 0 0 0 3.42 0l3.58-3.58a2.426 2.426 0 0 0 0-3.42z",key:"135mg7"}],["circle",{cx:"6.5",cy:"9.5",r:".5",fill:"currentColor",key:"5pm5xn"}]],d3=Bt("tags",p0e);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m0e=[["path",{d:"M17 6.1H3",key:"wptmhv"}],["path",{d:"M21 12.1H3",key:"1j38uz"}],["path",{d:"M15.1 18H3",key:"1nb16a"}]],g0e=Bt("text",m0e);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y0e=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],Vo=Bt("trash-2",y0e);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b0e=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]],v0e=Bt("trash",b0e);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x0e=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],rO=Bt("triangle-alert",x0e);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w0e=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]],GH=Bt("upload",w0e);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S0e=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]],YB=Bt("user-check",S0e);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _0e=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],C0e=Bt("user",_0e);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k0e=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]],ZB=Bt("users",k0e);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E0e=[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]],T0e=Bt("video",E0e);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A0e=[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]],R0e=Bt("wand-sparkles",A0e);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N0e=[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]],Am=Bt("wrench",N0e);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I0e=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Si=Bt("x",I0e);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M0e=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],j0e=Bt("zap",M0e),XB=({controls:e,area:t,className:n})=>{const r=e.filter(s=>t==="trigger"?!!s.triggerRenderer:!!s.renderer);return r.length===0?null:f.jsx("div",{className:Ye(n),children:r.map(s=>{var a,o;const i=t==="trigger"?(a=s.triggerRenderer)==null?void 0:a.call(s):(o=s.renderer)==null?void 0:o.call(s);return i?f.jsx(Ve.Fragment,{children:i},s.id):null})})},JB=e=>{let t;const n=new Set,r=(c,u)=>{const d=typeof c=="function"?c(t):c;if(!Object.is(d,t)){const h=t;t=u??(typeof d!="object"||d===null)?d:Object.assign({},t,d),n.forEach(m=>m(t,h))}},s=()=>t,o={setState:r,getState:s,getInitialState:()=>l,subscribe:c=>(n.add(c),()=>n.delete(c))},l=t=e(r,s,o);return o},P0e=e=>e?JB(e):JB,O0e=e=>e;function D0e(e,t=O0e){const n=Ve.useSyncExternalStore(e.subscribe,()=>t(e.getState()),()=>t(e.getInitialState()));return Ve.useDebugValue(n),n}const QB=e=>{const t=P0e(e),n=r=>D0e(t,r);return Object.assign(n,t),n},Co=e=>e?QB(e):QB;var KH=Symbol.for("immer-nothing"),e$=Symbol.for("immer-draftable"),us=Symbol.for("immer-state");function Zl(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var dy=Object.getPrototypeOf;function fy(e){return!!e&&!!e[us]}function rf(e){var t;return e?YH(e)||Array.isArray(e)||!!e[e$]||!!((t=e.constructor)!=null&&t[e$])||IE(e)||ME(e):!1}var F0e=Object.prototype.constructor.toString();function YH(e){if(!e||typeof e!="object")return!1;const t=dy(e);if(t===null)return!0;const n=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return n===Object?!0:typeof n=="function"&&Function.toString.call(n)===F0e}function rw(e,t){NE(e)===0?Reflect.ownKeys(e).forEach(n=>{t(n,e[n],e)}):e.forEach((n,r)=>t(r,n,e))}function NE(e){const t=e[us];return t?t.type_:Array.isArray(e)?1:IE(e)?2:ME(e)?3:0}function f3(e,t){return NE(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function ZH(e,t,n){const r=NE(e);r===2?e.set(t,n):r===3?e.add(n):e[t]=n}function L0e(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function IE(e){return e instanceof Map}function ME(e){return e instanceof Set}function la(e){return e.copy_||e.base_}function h3(e,t){if(IE(e))return new Map(e);if(ME(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const n=YH(e);if(t===!0||t==="class_only"&&!n){const r=Object.getOwnPropertyDescriptors(e);delete r[us];let s=Reflect.ownKeys(r);for(let i=0;i<s.length;i++){const a=s[i],o=r[a];o.writable===!1&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(r[a]={configurable:!0,writable:!0,enumerable:o.enumerable,value:e[a]})}return Object.create(dy(e),r)}else{const r=dy(e);if(r!==null&&n)return{...e};const s=Object.create(r);return Object.assign(s,e)}}function sO(e,t=!1){return jE(e)||fy(e)||!rf(e)||(NE(e)>1&&(e.set=e.add=e.clear=e.delete=B0e),Object.freeze(e),t&&Object.entries(e).forEach(([n,r])=>sO(r,!0))),e}function B0e(){Zl(2)}function jE(e){return Object.isFrozen(e)}var p3={};function Rm(e){const t=p3[e];return t||Zl(0,e),t}function $0e(e,t){p3[e]||(p3[e]=t)}var sw;function w2(){return sw}function z0e(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function t$(e,t){t&&(Rm("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function m3(e){g3(e),e.drafts_.forEach(U0e),e.drafts_=null}function g3(e){e===sw&&(sw=e.parent_)}function n$(e){return sw=z0e(sw,e)}function U0e(e){const t=e[us];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function r$(e,t){t.unfinalizedDrafts_=t.drafts_.length;const n=t.drafts_[0];return e!==void 0&&e!==n?(n[us].modified_&&(m3(t),Zl(4)),rf(e)&&(e=S2(t,e),t.parent_||_2(t,e)),t.patches_&&Rm("Patches").generateReplacementPatches_(n[us].base_,e,t.patches_,t.inversePatches_)):e=S2(t,n,[]),m3(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==KH?e:void 0}function S2(e,t,n){if(jE(t))return t;const r=t[us];if(!r)return rw(t,(s,i)=>s$(e,r,t,s,i,n)),t;if(r.scope_!==e)return t;if(!r.modified_)return _2(e,r.base_,!0),r.base_;if(!r.finalized_){r.finalized_=!0,r.scope_.unfinalizedDrafts_--;const s=r.copy_;let i=s,a=!1;r.type_===3&&(i=new Set(s),s.clear(),a=!0),rw(i,(o,l)=>s$(e,r,s,o,l,n,a)),_2(e,s,!1),n&&e.patches_&&Rm("Patches").generatePatches_(r,n,e.patches_,e.inversePatches_)}return r.copy_}function s$(e,t,n,r,s,i,a){if(fy(s)){const o=i&&t&&t.type_!==3&&!f3(t.assigned_,r)?i.concat(r):void 0,l=S2(e,s,o);if(ZH(n,r,l),fy(l))e.canAutoFreeze_=!1;else return}else a&&n.add(s);if(rf(s)&&!jE(s)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;S2(e,s),(!t||!t.scope_.parent_)&&typeof r!="symbol"&&Object.prototype.propertyIsEnumerable.call(n,r)&&_2(e,s)}}function _2(e,t,n=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&sO(t,n)}function q0e(e,t){const n=Array.isArray(e),r={type_:n?1:0,scope_:t?t.scope_:w2(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let s=r,i=iO;n&&(s=[r],i=iw);const{revoke:a,proxy:o}=Proxy.revocable(s,i);return r.draft_=o,r.revoke_=a,o}var iO={get(e,t){if(t===us)return e;const n=la(e);if(!f3(n,t))return V0e(e,n,t);const r=n[t];return e.finalized_||!rf(r)?r:r===AN(e.base_,t)?(RN(e),e.copy_[t]=aw(r,e)):r},has(e,t){return t in la(e)},ownKeys(e){return Reflect.ownKeys(la(e))},set(e,t,n){const r=XH(la(e),t);if(r!=null&&r.set)return r.set.call(e.draft_,n),!0;if(!e.modified_){const s=AN(la(e),t),i=s==null?void 0:s[us];if(i&&i.base_===n)return e.copy_[t]=n,e.assigned_[t]=!1,!0;if(L0e(n,s)&&(n!==void 0||f3(e.base_,t)))return!0;RN(e),Bd(e)}return e.copy_[t]===n&&(n!==void 0||t in e.copy_)||Number.isNaN(n)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=n,e.assigned_[t]=!0),!0},deleteProperty(e,t){return AN(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,RN(e),Bd(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const n=la(e),r=Reflect.getOwnPropertyDescriptor(n,t);return r&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:r.enumerable,value:n[t]}},defineProperty(){Zl(11)},getPrototypeOf(e){return dy(e.base_)},setPrototypeOf(){Zl(12)}},iw={};rw(iO,(e,t)=>{iw[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});iw.deleteProperty=function(e,t){return iw.set.call(this,e,t,void 0)};iw.set=function(e,t,n){return iO.set.call(this,e[0],t,n,e[0])};function AN(e,t){const n=e[us];return(n?la(n):e)[t]}function V0e(e,t,n){var s;const r=XH(t,n);return r?"value"in r?r.value:(s=r.get)==null?void 0:s.call(e.draft_):void 0}function XH(e,t){if(!(t in e))return;let n=dy(e);for(;n;){const r=Object.getOwnPropertyDescriptor(n,t);if(r)return r;n=dy(n)}}function Bd(e){e.modified_||(e.modified_=!0,e.parent_&&Bd(e.parent_))}function RN(e){e.copy_||(e.copy_=h3(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var W0e=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(t,n,r)=>{if(typeof t=="function"&&typeof n!="function"){const i=n;n=t;const a=this;return function(l=i,...c){return a.produce(l,u=>n.call(this,u,...c))}}typeof n!="function"&&Zl(6),r!==void 0&&typeof r!="function"&&Zl(7);let s;if(rf(t)){const i=n$(this),a=aw(t,void 0);let o=!0;try{s=n(a),o=!1}finally{o?m3(i):g3(i)}return t$(i,r),r$(s,i)}else if(!t||typeof t!="object"){if(s=n(t),s===void 0&&(s=t),s===KH&&(s=void 0),this.autoFreeze_&&sO(s,!0),r){const i=[],a=[];Rm("Patches").generateReplacementPatches_(t,s,i,a),r(i,a)}return s}else Zl(1,t)},this.produceWithPatches=(t,n)=>{if(typeof t=="function")return(a,...o)=>this.produceWithPatches(a,l=>t(l,...o));let r,s;return[this.produce(t,n,(a,o)=>{r=a,s=o}),r,s]},typeof(e==null?void 0:e.autoFreeze)=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof(e==null?void 0:e.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){rf(e)||Zl(8),fy(e)&&(e=H0e(e));const t=n$(this),n=aw(e,void 0);return n[us].isManual_=!0,g3(t),n}finishDraft(e,t){const n=e&&e[us];(!n||!n.isManual_)&&Zl(9);const{scope_:r}=n;return t$(r,t),r$(void 0,r)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let n;for(n=t.length-1;n>=0;n--){const s=t[n];if(s.path.length===0&&s.op==="replace"){e=s.value;break}}n>-1&&(t=t.slice(n+1));const r=Rm("Patches").applyPatches_;return fy(e)?r(e,t):this.produce(e,s=>r(s,t))}};function aw(e,t){const n=IE(e)?Rm("MapSet").proxyMap_(e,t):ME(e)?Rm("MapSet").proxySet_(e,t):q0e(e,t);return(t?t.scope_:w2()).drafts_.push(n),n}function H0e(e){return fy(e)||Zl(10,e),JH(e)}function JH(e){if(!rf(e)||jE(e))return e;const t=e[us];let n;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,n=h3(e,t.scope_.immer_.useStrictShallowCopy_)}else n=h3(e,!0);return rw(n,(r,s)=>{ZH(n,r,JH(s))}),t&&(t.finalized_=!1),n}function G0e(){class e extends Map{constructor(l,c){super(),this[us]={type_:2,parent_:c,scope_:c?c.scope_:w2(),modified_:!1,finalized_:!1,copy_:void 0,assigned_:void 0,base_:l,draft_:this,isManual_:!1,revoked_:!1}}get size(){return la(this[us]).size}has(l){return la(this[us]).has(l)}set(l,c){const u=this[us];return a(u),(!la(u).has(l)||la(u).get(l)!==c)&&(n(u),Bd(u),u.assigned_.set(l,!0),u.copy_.set(l,c),u.assigned_.set(l,!0)),this}delete(l){if(!this.has(l))return!1;const c=this[us];return a(c),n(c),Bd(c),c.base_.has(l)?c.assigned_.set(l,!1):c.assigned_.delete(l),c.copy_.delete(l),!0}clear(){const l=this[us];a(l),la(l).size&&(n(l),Bd(l),l.assigned_=new Map,rw(l.base_,c=>{l.assigned_.set(c,!1)}),l.copy_.clear())}forEach(l,c){const u=this[us];la(u).forEach((d,h,m)=>{l.call(c,this.get(h),h,this)})}get(l){const c=this[us];a(c);const u=la(c).get(l);if(c.finalized_||!rf(u)||u!==c.base_.get(l))return u;const d=aw(u,c);return n(c),c.copy_.set(l,d),d}keys(){return la(this[us]).keys()}values(){const l=this.keys();return{[Symbol.iterator]:()=>this.values(),next:()=>{const c=l.next();return c.done?c:{done:!1,value:this.get(c.value)}}}}entries(){const l=this.keys();return{[Symbol.iterator]:()=>this.entries(),next:()=>{const c=l.next();if(c.done)return c;const u=this.get(c.value);return{done:!1,value:[c.value,u]}}}}[Symbol.iterator](){return this.entries()}}function t(o,l){return new e(o,l)}function n(o){o.copy_||(o.assigned_=new Map,o.copy_=new Map(o.base_))}class r extends Set{constructor(l,c){super(),this[us]={type_:3,parent_:c,scope_:c?c.scope_:w2(),modified_:!1,finalized_:!1,copy_:void 0,base_:l,draft_:this,drafts_:new Map,revoked_:!1,isManual_:!1}}get size(){return la(this[us]).size}has(l){const c=this[us];return a(c),c.copy_?!!(c.copy_.has(l)||c.drafts_.has(l)&&c.copy_.has(c.drafts_.get(l))):c.base_.has(l)}add(l){const c=this[us];return a(c),this.has(l)||(i(c),Bd(c),c.copy_.add(l)),this}delete(l){if(!this.has(l))return!1;const c=this[us];return a(c),i(c),Bd(c),c.copy_.delete(l)||(c.drafts_.has(l)?c.copy_.delete(c.drafts_.get(l)):!1)}clear(){const l=this[us];a(l),la(l).size&&(i(l),Bd(l),l.copy_.clear())}values(){const l=this[us];return a(l),i(l),l.copy_.values()}entries(){const l=this[us];return a(l),i(l),l.copy_.entries()}keys(){return this.values()}[Symbol.iterator](){return this.values()}forEach(l,c){const u=this.values();let d=u.next();for(;!d.done;)l.call(c,d.value,d.value,this),d=u.next()}}function s(o,l){return new r(o,l)}function i(o){o.copy_||(o.copy_=new Set,o.base_.forEach(l=>{if(rf(l)){const c=aw(l,o);o.drafts_.set(l,c),o.copy_.add(c)}else o.copy_.add(l)}))}function a(o){o.revoked_&&Zl(3,JSON.stringify(la(o)))}$0e("MapSet",{proxyMap_:t,proxySet_:s})}var _l=new W0e,K0e=_l.produce;_l.produceWithPatches.bind(_l);_l.setAutoFreeze.bind(_l);_l.setUseStrictShallowCopy.bind(_l);_l.applyPatches.bind(_l);_l.createDraft.bind(_l);_l.finishDraft.bind(_l);const Y0e=e=>(t,n,r)=>(r.setState=(s,i,...a)=>{const o=typeof s=="function"?K0e(s):s;return t(o,i,...a)},e(r.setState,n,r)),ko=Y0e;function Z0e(e){return{all:e=e||new Map,on:function(t,n){var r=e.get(t);r?r.push(n):e.set(t,[n])},off:function(t,n){var r=e.get(t);r&&(n?r.splice(r.indexOf(n)>>>0,1):e.set(t,[]))},emit:function(t,n){var r=e.get(t);r&&r.slice().map(function(s){s(n)}),(r=e.get("*"))&&r.slice().map(function(s){s(t,n)})}}}const Ce=Z0e(),Ur={promptControlsChanged:"control.registry.prompt.controls.changed",chatControlsChanged:"control.registry.chat.controls.changed",canvasControlsChanged:"control.registry.canvas.controls.changed",middlewareChanged:"control.registry.middleware.changed",toolsChanged:"control.registry.tools.changed",modalProvidersChanged:"control.registry.modal.providers.changed",registerPromptControlRequest:"control.registry.register.prompt.control.request",unregisterPromptControlRequest:"control.registry.unregister.prompt.control.request",registerChatControlRequest:"control.registry.register.chat.control.request",unregisterChatControlRequest:"control.registry.unregister.chat.control.request",registerCanvasControlRequest:"control.registry.register.canvas.control.request",unregisterCanvasControlRequest:"control.registry.unregister.canvas.control.request",registerMiddlewareRequest:"control.registry.register.middleware.request",unregisterMiddlewareRequest:"control.registry.unregister.middleware.request",registerToolRequest:"control.registry.register.tool.request",unregisterToolRequest:"control.registry.unregister.tool.request",registerModalProviderRequest:"control.registry.register.modal.provider.request",unregisterModalProviderRequest:"control.registry.unregister.modal.provider.request"},A0={blockRenderersChanged:"block.renderer.renderers.changed",registerBlockRendererRequest:"block.renderer.register.request",unregisterBlockRendererRequest:"block.renderer.unregister.request"},Bi=Co(ko((e,t)=>({promptControls:{},chatControls:{},canvasControls:{},blockRenderers:{},middlewareRegistry:{},tools:{},modalProviders:{},registerPromptControl:n=>(e(r=>{r.promptControls[n.id]&&console.warn(`ControlRegistryStore: PromptControl with ID "${n.id}" already registered. Overwriting.`),r.promptControls[n.id]=n}),Ce.emit(Ur.promptControlsChanged,{controls:t().promptControls}),()=>t().unregisterPromptControl(n.id)),unregisterPromptControl:n=>{e(r=>{r.promptControls[n]?delete r.promptControls[n]:console.warn(`ControlRegistryStore: PromptControl with ID "${n}" not found for unregistration.`)}),Ce.emit(Ur.promptControlsChanged,{controls:t().promptControls})},registerChatControl:n=>(e(r=>{r.chatControls[n.id]&&console.warn(`ControlRegistryStore: ChatControl with ID "${n.id}" already registered. Overwriting.`),r.chatControls[n.id]=n}),Ce.emit(Ur.chatControlsChanged,{controls:t().chatControls}),()=>t().unregisterChatControl(n.id)),unregisterChatControl:n=>{e(r=>{r.chatControls[n]?delete r.chatControls[n]:console.warn(`ControlRegistryStore: ChatControl with ID "${n}" not found for unregistration.`)}),Ce.emit(Ur.chatControlsChanged,{controls:t().chatControls})},registerCanvasControl:n=>(e(r=>{r.canvasControls[n.id]&&console.warn(`ControlRegistryStore: CanvasControl with ID "${n.id}" already registered. Overwriting.`),r.canvasControls[n.id]=n}),Ce.emit(Ur.canvasControlsChanged,{controls:t().canvasControls}),()=>t().unregisterCanvasControl(n.id)),unregisterCanvasControl:n=>{e(r=>{r.canvasControls[n]?delete r.canvasControls[n]:console.warn(`ControlRegistryStore: CanvasControl with ID "${n}" not found for unregistration.`)}),Ce.emit(Ur.canvasControlsChanged,{controls:t().canvasControls})},registerBlockRenderer:n=>(e(r=>{r.blockRenderers[n.id]&&console.warn(`ControlRegistryStore: BlockRenderer with ID "${n.id}" already registered. Overwriting.`),r.blockRenderers[n.id]=n}),Ce.emit(A0.blockRenderersChanged,{renderers:t().blockRenderers}),()=>t().unregisterBlockRenderer(n.id)),unregisterBlockRenderer:n=>{e(r=>{r.blockRenderers[n]?delete r.blockRenderers[n]:console.warn(`ControlRegistryStore: BlockRenderer with ID "${n}" not found for unregistration.`)}),Ce.emit(A0.blockRenderersChanged,{renderers:t().blockRenderers})},registerMiddleware:(n,r,s,i=0)=>{const a={modId:r,callback:s,order:i};return e(o=>{o.middlewareRegistry[n]||(o.middlewareRegistry[n]=[]),o.middlewareRegistry[n].push(a),o.middlewareRegistry[n].sort((l,c)=>(l.order??0)-(c.order??0))}),Ce.emit(Ur.middlewareChanged,{middleware:t().middlewareRegistry}),()=>t().unregisterMiddleware(n,r,s)},unregisterMiddleware:(n,r,s)=>{e(i=>{var a;i.middlewareRegistry[n]?(i.middlewareRegistry[n]=i.middlewareRegistry[n].filter(o=>!(o.modId===r&&o.callback===s)),((a=i.middlewareRegistry[n])==null?void 0:a.length)===0&&delete i.middlewareRegistry[n]):console.warn(`ControlRegistryStore: Middleware hook "${n}" not found for unregistration.`)}),Ce.emit(Ur.middlewareChanged,{middleware:t().middlewareRegistry})},getMiddlewareForHook:n=>{const r=t().middlewareRegistry[n]??[];return Object.freeze([...r].sort((s,i)=>(s.order??0)-(i.order??0)))},registerTool:(n,r,s,i)=>(e(a=>{a.tools[r]&&console.warn(`ControlRegistryStore: Tool "${r}" already registered by mod "${a.tools[r].modId}". Overwriting with registration from mod "${n}".`),a.tools[r]={definition:s,implementation:i,modId:n}}),Ce.emit(Ur.toolsChanged,{tools:t().tools}),()=>t().unregisterTool(r)),unregisterTool:n=>{e(r=>{r.tools[n]?delete r.tools[n]:console.warn(`ControlRegistryStore: Tool "${n}" not found for unregistration.`)}),Ce.emit(Ur.toolsChanged,{tools:t().tools})},getRegisteredTools:()=>Object.freeze({...t().tools}),registerModalProvider:(n,r)=>(e(s=>{s.modalProviders[n]&&console.warn(`ControlRegistryStore: ModalProvider with ID "${n}" already registered. Overwriting.`),s.modalProviders[n]=r}),Ce.emit(Ur.modalProvidersChanged,{providers:t().modalProviders}),()=>t().unregisterModalProvider(n)),unregisterModalProvider:n=>{e(r=>{r.modalProviders[n]?delete r.modalProviders[n]:console.warn(`ControlRegistryStore: ModalProvider with ID "${n}" not found for unregistration.`)}),Ce.emit(Ur.modalProvidersChanged,{providers:t().modalProviders})},getRegisteredActionHandlers:()=>{const n="controlRegistryStore",r=t();return[{eventName:Ur.registerPromptControlRequest,handler:s=>{r.registerPromptControl(s.control)},storeId:n},{eventName:Ur.unregisterPromptControlRequest,handler:s=>{r.unregisterPromptControl(s.id)},storeId:n},{eventName:Ur.registerChatControlRequest,handler:s=>{r.registerChatControl(s.control)},storeId:n},{eventName:Ur.unregisterChatControlRequest,handler:s=>{r.unregisterChatControl(s.id)},storeId:n},{eventName:Ur.registerCanvasControlRequest,handler:s=>{r.registerCanvasControl(s.control)},storeId:n},{eventName:Ur.unregisterCanvasControlRequest,handler:s=>{r.unregisterCanvasControl(s.id)},storeId:n},{eventName:A0.registerBlockRendererRequest,handler:s=>{r.registerBlockRenderer(s.renderer)},storeId:n},{eventName:A0.unregisterBlockRendererRequest,handler:s=>{r.unregisterBlockRenderer(s.id)},storeId:n},{eventName:Ur.registerMiddlewareRequest,handler:s=>{r.registerMiddleware(s.hookName,s.modId,s.callback,s.order)},storeId:n},{eventName:Ur.unregisterMiddlewareRequest,handler:s=>{r.unregisterMiddleware(s.hookName,s.modId,s.callback)},storeId:n},{eventName:Ur.registerToolRequest,handler:s=>{r.registerTool(s.modId,s.toolName,s.definition,s.implementation)},storeId:n},{eventName:Ur.unregisterToolRequest,handler:s=>{r.unregisterTool(s.toolName)},storeId:n},{eventName:Ur.registerModalProviderRequest,handler:s=>{r.registerModalProvider(s.modalId,s.provider)},storeId:n},{eventName:Ur.unregisterModalProviderRequest,handler:s=>{r.unregisterModalProvider(s.modalId)},storeId:n}]}})));var UC={exports:{}},X0e=UC.exports,i$;function J0e(){return i$||(i$=1,function(e,t){(function(n,r){e.exports=r()})(X0e,function(){var n=function(M,z){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(te,ae){te.__proto__=ae}||function(te,ae){for(var pe in ae)Object.prototype.hasOwnProperty.call(ae,pe)&&(te[pe]=ae[pe])})(M,z)},r=function(){return(r=Object.assign||function(M){for(var z,te=1,ae=arguments.length;te<ae;te++)for(var pe in z=arguments[te])Object.prototype.hasOwnProperty.call(z,pe)&&(M[pe]=z[pe]);return M}).apply(this,arguments)};function s(M,z,te){for(var ae,pe=0,Ne=z.length;pe<Ne;pe++)!ae&&pe in z||((ae=ae||Array.prototype.slice.call(z,0,pe))[pe]=z[pe]);return M.concat(ae||Array.prototype.slice.call(z))}var i=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:cm,a=Object.keys,o=Array.isArray;function l(M,z){return typeof z!="object"||a(z).forEach(function(te){M[te]=z[te]}),M}typeof Promise>"u"||i.Promise||(i.Promise=Promise);var c=Object.getPrototypeOf,u={}.hasOwnProperty;function d(M,z){return u.call(M,z)}function h(M,z){typeof z=="function"&&(z=z(c(M))),(typeof Reflect>"u"?a:Reflect.ownKeys)(z).forEach(function(te){y(M,te,z[te])})}var m=Object.defineProperty;function y(M,z,te,ae){m(M,z,l(te&&d(te,"get")&&typeof te.get=="function"?{get:te.get,set:te.set,configurable:!0}:{value:te,configurable:!0,writable:!0},ae))}function b(M){return{from:function(z){return M.prototype=Object.create(z.prototype),y(M.prototype,"constructor",M),{extend:h.bind(null,M.prototype)}}}}var v=Object.getOwnPropertyDescriptor,x=[].slice;function w(M,z,te){return x.call(M,z,te)}function _(M,z){return z(M)}function k(M){if(!M)throw new Error("Assertion Failed")}function C(M){i.setImmediate?setImmediate(M):setTimeout(M,0)}function T(M,z){if(typeof z=="string"&&d(M,z))return M[z];if(!z)return M;if(typeof z!="string"){for(var te=[],ae=0,pe=z.length;ae<pe;++ae){var Ne=T(M,z[ae]);te.push(Ne)}return te}var Le=z.indexOf(".");if(Le!==-1){var Ge=M[z.substr(0,Le)];return Ge==null?void 0:T(Ge,z.substr(Le+1))}}function A(M,z,te){if(M&&z!==void 0&&!("isFrozen"in Object&&Object.isFrozen(M)))if(typeof z!="string"&&"length"in z){k(typeof te!="string"&&"length"in te);for(var ae=0,pe=z.length;ae<pe;++ae)A(M,z[ae],te[ae])}else{var Ne,Le,Ge=z.indexOf(".");Ge!==-1?(Ne=z.substr(0,Ge),(Le=z.substr(Ge+1))===""?te===void 0?o(M)&&!isNaN(parseInt(Ne))?M.splice(Ne,1):delete M[Ne]:M[Ne]=te:A(Ge=!(Ge=M[Ne])||!d(M,Ne)?M[Ne]={}:Ge,Le,te)):te===void 0?o(M)&&!isNaN(parseInt(z))?M.splice(z,1):delete M[z]:M[z]=te}}function N(M){var z,te={};for(z in M)d(M,z)&&(te[z]=M[z]);return te}var I=[].concat;function j(M){return I.apply([],M)}var Pt="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(j([8,16,32,64].map(function(M){return["Int","Uint","Float"].map(function(z){return z+M+"Array"})}))).filter(function(M){return i[M]}),L=new Set(Pt.map(function(M){return i[M]})),D=null;function H(M){return D=new WeakMap,M=function z(te){if(!te||typeof te!="object")return te;var ae=D.get(te);if(ae)return ae;if(o(te)){ae=[],D.set(te,ae);for(var pe=0,Ne=te.length;pe<Ne;++pe)ae.push(z(te[pe]))}else if(L.has(te.constructor))ae=te;else{var Le,Ge=c(te);for(Le in ae=Ge===Object.prototype?{}:Object.create(Ge),D.set(te,ae),te)d(te,Le)&&(ae[Le]=z(te[Le]))}return ae}(M),D=null,M}var O={}.toString;function K(M){return O.call(M).slice(8,-1)}var U=typeof Symbol<"u"?Symbol.iterator:"@@iterator",W=typeof U=="symbol"?function(M){var z;return M!=null&&(z=M[U])&&z.apply(M)}:function(){return null};function B(M,z){return z=M.indexOf(z),0<=z&&M.splice(z,1),0<=z}var ne={};function V(M){var z,te,ae,pe;if(arguments.length===1){if(o(M))return M.slice();if(this===ne&&typeof M=="string")return[M];if(pe=W(M)){for(te=[];!(ae=pe.next()).done;)te.push(ae.value);return te}if(M==null)return[M];if(typeof(z=M.length)!="number")return[M];for(te=new Array(z);z--;)te[z]=M[z];return te}for(z=arguments.length,te=new Array(z);z--;)te[z]=arguments[z];return te}var Q=typeof Symbol<"u"?function(M){return M[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},ut=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],eo=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(ut),ee={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function re(M,z){this.name=M,this.message=z}function de(M,z){return M+". Errors: "+Object.keys(z).map(function(te){return z[te].toString()}).filter(function(te,ae,pe){return pe.indexOf(te)===ae}).join(`
`)}function me(M,z,te,ae){this.failures=z,this.failedKeys=ae,this.successCount=te,this.message=de(M,z)}function De(M,z){this.name="BulkError",this.failures=Object.keys(z).map(function(te){return z[te]}),this.failuresByPos=z,this.message=de(M,this.failures)}b(re).from(Error).extend({toString:function(){return this.name+": "+this.message}}),b(me).from(re),b(De).from(re);var je=eo.reduce(function(M,z){return M[z]=z+"Error",M},{}),Te=re,_e=eo.reduce(function(M,z){var te=z+"Error";function ae(pe,Ne){this.name=te,pe?typeof pe=="string"?(this.message="".concat(pe).concat(Ne?`
 `+Ne:""),this.inner=Ne||null):typeof pe=="object"&&(this.message="".concat(pe.name," ").concat(pe.message),this.inner=pe):(this.message=ee[z]||te,this.inner=null)}return b(ae).from(Te),M[z]=ae,M},{});_e.Syntax=SyntaxError,_e.Type=TypeError,_e.Range=RangeError;var Ue=ut.reduce(function(M,z){return M[z+"Error"]=_e[z],M},{}),Qe=eo.reduce(function(M,z){return["Syntax","Type","Range"].indexOf(z)===-1&&(M[z+"Error"]=_e[z]),M},{});function We(){}function Pe(M){return M}function Y(M,z){return M==null||M===Pe?z:function(te){return z(M(te))}}function ye(M,z){return function(){M.apply(this,arguments),z.apply(this,arguments)}}function Me(M,z){return M===We?z:function(){var te=M.apply(this,arguments);te!==void 0&&(arguments[0]=te);var ae=this.onsuccess,pe=this.onerror;this.onsuccess=null,this.onerror=null;var Ne=z.apply(this,arguments);return ae&&(this.onsuccess=this.onsuccess?ye(ae,this.onsuccess):ae),pe&&(this.onerror=this.onerror?ye(pe,this.onerror):pe),Ne!==void 0?Ne:te}}function ue(M,z){return M===We?z:function(){M.apply(this,arguments);var te=this.onsuccess,ae=this.onerror;this.onsuccess=this.onerror=null,z.apply(this,arguments),te&&(this.onsuccess=this.onsuccess?ye(te,this.onsuccess):te),ae&&(this.onerror=this.onerror?ye(ae,this.onerror):ae)}}function oe(M,z){return M===We?z:function(te){var ae=M.apply(this,arguments);l(te,ae);var pe=this.onsuccess,Ne=this.onerror;return this.onsuccess=null,this.onerror=null,te=z.apply(this,arguments),pe&&(this.onsuccess=this.onsuccess?ye(pe,this.onsuccess):pe),Ne&&(this.onerror=this.onerror?ye(Ne,this.onerror):Ne),ae===void 0?te===void 0?void 0:te:l(ae,te)}}function se(M,z){return M===We?z:function(){return z.apply(this,arguments)!==!1&&M.apply(this,arguments)}}function Ie(M,z){return M===We?z:function(){var te=M.apply(this,arguments);if(te&&typeof te.then=="function"){for(var ae=this,pe=arguments.length,Ne=new Array(pe);pe--;)Ne[pe]=arguments[pe];return te.then(function(){return z.apply(ae,Ne)})}return z.apply(this,arguments)}}Qe.ModifyError=me,Qe.DexieError=re,Qe.BulkError=De;var Be=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function Re(M){Be=M}var ct={},At=100,Pt=typeof Promise>"u"?[]:function(){var M=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[M,c(M),M];var z=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[z,c(z),M]}(),ut=Pt[0],eo=Pt[1],Pt=Pt[2],eo=eo&&eo.then,Ut=ut&&ut.constructor,Ft=!!Pt,Yt=function(M,z){le.push([M,z]),F&&(queueMicrotask(fe),F=!1)},we=!0,F=!0,X=[],be=[],Ee=Pe,ge={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:We,pgp:!1,env:{},finalize:We},Ae=ge,le=[],ft=0,et=[];function $(M){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var z=this._PSD=Ae;if(typeof M!="function"){if(M!==ct)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&ve(this,this._value))}this._state=null,this._value=null,++z.ref,function te(ae,pe){try{pe(function(Ne){if(ae._state===null){if(Ne===ae)throw new TypeError("A promise cannot be resolved with itself.");var Le=ae._lib&&Z();Ne&&typeof Ne.then=="function"?te(ae,function(Ge,st){Ne instanceof $?Ne._then(Ge,st):Ne.then(Ge,st)}):(ae._state=!0,ae._value=Ne,Se(ae)),Le&&G()}},ve.bind(null,ae))}catch(Ne){ve(ae,Ne)}}(this,M)}var qe={get:function(){var M=Ae,z=Zt;function te(ae,pe){var Ne=this,Le=!M.global&&(M!==Ae||z!==Zt),Ge=Le&&!Mr(),st=new $(function(at,pt){ze(Ne,new tt(Vt(ae,M,Le,Ge),Vt(pe,M,Le,Ge),at,pt,M))});return this._consoleTask&&(st._consoleTask=this._consoleTask),st}return te.prototype=ct,te},set:function(M){y(this,"then",M&&M.prototype===ct?qe:{get:function(){return M},set:qe.set})}};function tt(M,z,te,ae,pe){this.onFulfilled=typeof M=="function"?M:null,this.onRejected=typeof z=="function"?z:null,this.resolve=te,this.reject=ae,this.psd=pe}function ve(M,z){var te,ae;be.push(z),M._state===null&&(te=M._lib&&Z(),z=Ee(z),M._state=!1,M._value=z,ae=M,X.some(function(pe){return pe._value===ae._value})||X.push(ae),Se(M),te&&G())}function Se(M){var z=M._listeners;M._listeners=[];for(var te=0,ae=z.length;te<ae;++te)ze(M,z[te]);var pe=M._PSD;--pe.ref||pe.finalize(),ft===0&&(++ft,Yt(function(){--ft==0&&J()},[]))}function ze(M,z){if(M._state!==null){var te=M._state?z.onFulfilled:z.onRejected;if(te===null)return(M._state?z.resolve:z.reject)(M._value);++z.psd.ref,++ft,Yt(Ct,[te,M,z])}else M._listeners.push(z)}function Ct(M,z,te){try{var ae,pe=z._value;!z._state&&be.length&&(be=[]),ae=Be&&z._consoleTask?z._consoleTask.run(function(){return M(pe)}):M(pe),z._state||be.indexOf(pe)!==-1||function(Ne){for(var Le=X.length;Le;)if(X[--Le]._value===Ne._value)return X.splice(Le,1)}(z),te.resolve(ae)}catch(Ne){te.reject(Ne)}finally{--ft==0&&J(),--te.psd.ref||te.psd.finalize()}}function fe(){nt(ge,function(){Z()&&G()})}function Z(){var M=we;return F=we=!1,M}function G(){var M,z,te;do for(;0<le.length;)for(M=le,le=[],te=M.length,z=0;z<te;++z){var ae=M[z];ae[0].apply(null,ae[1])}while(0<le.length);F=we=!0}function J(){var M=X;X=[],M.forEach(function(ae){ae._PSD.onunhandled.call(null,ae._value,ae)});for(var z=et.slice(0),te=z.length;te;)z[--te]()}function xe(M){return new $(ct,!1,M)}function Fe(M,z){var te=Ae;return function(){var ae=Z(),pe=Ae;try{return kr(te,!0),M.apply(this,arguments)}catch(Ne){z&&z(Ne)}finally{kr(pe,!1),ae&&G()}}}h($.prototype,{then:qe,_then:function(M,z){ze(this,new tt(null,null,M,z,Ae))},catch:function(M){if(arguments.length===1)return this.then(null,M);var z=M,te=arguments[1];return typeof z=="function"?this.then(null,function(ae){return(ae instanceof z?te:xe)(ae)}):this.then(null,function(ae){return(ae&&ae.name===z?te:xe)(ae)})},finally:function(M){return this.then(function(z){return $.resolve(M()).then(function(){return z})},function(z){return $.resolve(M()).then(function(){return xe(z)})})},timeout:function(M,z){var te=this;return M<1/0?new $(function(ae,pe){var Ne=setTimeout(function(){return pe(new _e.Timeout(z))},M);te.then(ae,pe).finally(clearTimeout.bind(null,Ne))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&y($.prototype,Symbol.toStringTag,"Dexie.Promise"),ge.env=gn(),h($,{all:function(){var M=V.apply(null,arguments).map(rs);return new $(function(z,te){M.length===0&&z([]);var ae=M.length;M.forEach(function(pe,Ne){return $.resolve(pe).then(function(Le){M[Ne]=Le,--ae||z(M)},te)})})},resolve:function(M){return M instanceof $?M:M&&typeof M.then=="function"?new $(function(z,te){M.then(z,te)}):new $(ct,!0,M)},reject:xe,race:function(){var M=V.apply(null,arguments).map(rs);return new $(function(z,te){M.map(function(ae){return $.resolve(ae).then(z,te)})})},PSD:{get:function(){return Ae},set:function(M){return Ae=M}},totalEchoes:{get:function(){return Zt}},newPSD:fn,usePSD:nt,scheduler:{get:function(){return Yt},set:function(M){Yt=M}},rejectionMapper:{get:function(){return Ee},set:function(M){Ee=M}},follow:function(M,z){return new $(function(te,ae){return fn(function(pe,Ne){var Le=Ae;Le.unhandleds=[],Le.onunhandled=Ne,Le.finalize=ye(function(){var Ge,st=this;Ge=function(){st.unhandleds.length===0?pe():Ne(st.unhandleds[0])},et.push(function at(){Ge(),et.splice(et.indexOf(at),1)}),++ft,Yt(function(){--ft==0&&J()},[])},Le.finalize),M()},z,te,ae)})}}),Ut&&(Ut.allSettled&&y($,"allSettled",function(){var M=V.apply(null,arguments).map(rs);return new $(function(z){M.length===0&&z([]);var te=M.length,ae=new Array(te);M.forEach(function(pe,Ne){return $.resolve(pe).then(function(Le){return ae[Ne]={status:"fulfilled",value:Le}},function(Le){return ae[Ne]={status:"rejected",reason:Le}}).then(function(){return--te||z(ae)})})})}),Ut.any&&typeof AggregateError<"u"&&y($,"any",function(){var M=V.apply(null,arguments).map(rs);return new $(function(z,te){M.length===0&&te(new AggregateError([]));var ae=M.length,pe=new Array(ae);M.forEach(function(Ne,Le){return $.resolve(Ne).then(function(Ge){return z(Ge)},function(Ge){pe[Le]=Ge,--ae||te(new AggregateError(pe))})})})}),Ut.withResolvers&&($.withResolvers=Ut.withResolvers));var He={awaits:0,echoes:0,id:0},wt=0,Qt=[],Dn=0,Zt=0,rn=0;function fn(M,z,te,ae){var pe=Ae,Ne=Object.create(pe);return Ne.parent=pe,Ne.ref=0,Ne.global=!1,Ne.id=++rn,ge.env,Ne.env=Ft?{Promise:$,PromiseProp:{value:$,configurable:!0,writable:!0},all:$.all,race:$.race,allSettled:$.allSettled,any:$.any,resolve:$.resolve,reject:$.reject}:{},z&&l(Ne,z),++pe.ref,Ne.finalize=function(){--this.parent.ref||this.parent.finalize()},ae=nt(Ne,M,te,ae),Ne.ref===0&&Ne.finalize(),ae}function br(){return He.id||(He.id=++wt),++He.awaits,He.echoes+=At,He.id}function Mr(){return!!He.awaits&&(--He.awaits==0&&(He.id=0),He.echoes=He.awaits*At,!0)}function rs(M){return He.echoes&&M&&M.constructor===Ut?(br(),M.then(function(z){return Mr(),z},function(z){return Mr(),ar(z)})):M}function ss(){var M=Qt[Qt.length-1];Qt.pop(),kr(M,!1)}function kr(M,z){var te,ae=Ae;(z?!He.echoes||Dn++&&M===Ae:!Dn||--Dn&&M===Ae)||queueMicrotask(z?(function(pe){++Zt,He.echoes&&--He.echoes!=0||(He.echoes=He.awaits=He.id=0),Qt.push(Ae),kr(pe,!0)}).bind(null,M):ss),M!==Ae&&(Ae=M,ae===ge&&(ge.env=gn()),Ft&&(te=ge.env.Promise,z=M.env,(ae.global||M.global)&&(Object.defineProperty(i,"Promise",z.PromiseProp),te.all=z.all,te.race=z.race,te.resolve=z.resolve,te.reject=z.reject,z.allSettled&&(te.allSettled=z.allSettled),z.any&&(te.any=z.any))))}function gn(){var M=i.Promise;return Ft?{Promise:M,PromiseProp:Object.getOwnPropertyDescriptor(i,"Promise"),all:M.all,race:M.race,allSettled:M.allSettled,any:M.any,resolve:M.resolve,reject:M.reject}:{}}function nt(M,z,te,ae,pe){var Ne=Ae;try{return kr(M,!0),z(te,ae,pe)}finally{kr(Ne,!1)}}function Vt(M,z,te,ae){return typeof M!="function"?M:function(){var pe=Ae;te&&br(),kr(z,!0);try{return M.apply(this,arguments)}finally{kr(pe,!1),ae&&queueMicrotask(Mr)}}}function yn(M){Promise===Ut&&He.echoes===0?Dn===0?M():enqueueNativeMicroTask(M):setTimeout(M,0)}(""+eo).indexOf("[native code]")===-1&&(br=Mr=We);var ar=$.reject,Ns="￿",ts="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",zi="String expected.",fi=[],Xa="__dbnames",ba="readonly",Gs="readwrite";function el(M,z){return M?z?function(){return M.apply(this,arguments)&&z.apply(this,arguments)}:M:z}var Al={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Tf(M){return typeof M!="string"||/\./.test(M)?function(z){return z}:function(z){return z[M]===void 0&&M in z&&delete(z=H(z))[M],z}}function vg(){throw _e.Type()}function Lr(M,z){try{var te=Fb(M),ae=Fb(z);if(te!==ae)return te==="Array"?1:ae==="Array"?-1:te==="binary"?1:ae==="binary"?-1:te==="string"?1:ae==="string"?-1:te==="Date"?1:ae!=="Date"?NaN:-1;switch(te){case"number":case"Date":case"string":return z<M?1:M<z?-1:0;case"binary":return function(pe,Ne){for(var Le=pe.length,Ge=Ne.length,st=Le<Ge?Le:Ge,at=0;at<st;++at)if(pe[at]!==Ne[at])return pe[at]<Ne[at]?-1:1;return Le===Ge?0:Le<Ge?-1:1}(Ja(M),Ja(z));case"Array":return function(pe,Ne){for(var Le=pe.length,Ge=Ne.length,st=Le<Ge?Le:Ge,at=0;at<st;++at){var pt=Lr(pe[at],Ne[at]);if(pt!==0)return pt}return Le===Ge?0:Le<Ge?-1:1}(M,z)}}catch{}return NaN}function Fb(M){var z=typeof M;return z!="object"?z:ArrayBuffer.isView(M)?"binary":(M=K(M),M==="ArrayBuffer"?"binary":M)}function Ja(M){return M instanceof Uint8Array?M:ArrayBuffer.isView(M)?new Uint8Array(M.buffer,M.byteOffset,M.byteLength):new Uint8Array(M)}var Lb=(Is.prototype._trans=function(M,z,te){var ae=this._tx||Ae.trans,pe=this.name,Ne=Be&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(M==="readonly"?"read":"write"," ").concat(this.name));function Le(at,pt,Je){if(!Je.schema[pe])throw new _e.NotFound("Table "+pe+" not part of transaction");return z(Je.idbtrans,Je)}var Ge=Z();try{var st=ae&&ae.db._novip===this.db._novip?ae===Ae.trans?ae._promise(M,Le,te):fn(function(){return ae._promise(M,Le,te)},{trans:ae,transless:Ae.transless||Ae}):function at(pt,Je,gt,rt){if(pt.idbdb&&(pt._state.openComplete||Ae.letThrough||pt._vip)){var ht=pt._createTransaction(Je,gt,pt._dbSchema);try{ht.create(),pt._state.PR1398_maxLoop=3}catch(bt){return bt.name===je.InvalidState&&pt.isOpen()&&0<--pt._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),pt.close({disableAutoOpen:!1}),pt.open().then(function(){return at(pt,Je,gt,rt)})):ar(bt)}return ht._promise(Je,function(bt,lt){return fn(function(){return Ae.trans=ht,rt(bt,lt,ht)})}).then(function(bt){if(Je==="readwrite")try{ht.idbtrans.commit()}catch{}return Je==="readonly"?bt:ht._completion.then(function(){return bt})})}if(pt._state.openComplete)return ar(new _e.DatabaseClosed(pt._state.dbOpenError));if(!pt._state.isBeingOpened){if(!pt._state.autoOpen)return ar(new _e.DatabaseClosed);pt.open().catch(We)}return pt._state.dbReadyPromise.then(function(){return at(pt,Je,gt,rt)})}(this.db,M,[this.name],Le);return Ne&&(st._consoleTask=Ne,st=st.catch(function(at){return console.trace(at),ar(at)})),st}finally{Ge&&G()}},Is.prototype.get=function(M,z){var te=this;return M&&M.constructor===Object?this.where(M).first(z):M==null?ar(new _e.Type("Invalid argument to Table.get()")):this._trans("readonly",function(ae){return te.core.get({trans:ae,key:M}).then(function(pe){return te.hook.reading.fire(pe)})}).then(z)},Is.prototype.where=function(M){if(typeof M=="string")return new this.db.WhereClause(this,M);if(o(M))return new this.db.WhereClause(this,"[".concat(M.join("+"),"]"));var z=a(M);if(z.length===1)return this.where(z[0]).equals(M[z[0]]);var te=this.schema.indexes.concat(this.schema.primKey).filter(function(Ge){if(Ge.compound&&z.every(function(at){return 0<=Ge.keyPath.indexOf(at)})){for(var st=0;st<z.length;++st)if(z.indexOf(Ge.keyPath[st])===-1)return!1;return!0}return!1}).sort(function(Ge,st){return Ge.keyPath.length-st.keyPath.length})[0];if(te&&this.db._maxKey!==Ns){var Ne=te.keyPath.slice(0,z.length);return this.where(Ne).equals(Ne.map(function(st){return M[st]}))}!te&&Be&&console.warn("The query ".concat(JSON.stringify(M)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(z.join("+"),"]"));var ae=this.schema.idxByName;function pe(Ge,st){return Lr(Ge,st)===0}var Le=z.reduce(function(Je,st){var at=Je[0],pt=Je[1],Je=ae[st],gt=M[st];return[at||Je,at||!Je?el(pt,Je&&Je.multi?function(rt){return rt=T(rt,st),o(rt)&&rt.some(function(ht){return pe(gt,ht)})}:function(rt){return pe(gt,T(rt,st))}):pt]},[null,null]),Ne=Le[0],Le=Le[1];return Ne?this.where(Ne.name).equals(M[Ne.keyPath]).filter(Le):te?this.filter(Le):this.where(z).equals("")},Is.prototype.filter=function(M){return this.toCollection().and(M)},Is.prototype.count=function(M){return this.toCollection().count(M)},Is.prototype.offset=function(M){return this.toCollection().offset(M)},Is.prototype.limit=function(M){return this.toCollection().limit(M)},Is.prototype.each=function(M){return this.toCollection().each(M)},Is.prototype.toArray=function(M){return this.toCollection().toArray(M)},Is.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},Is.prototype.orderBy=function(M){return new this.db.Collection(new this.db.WhereClause(this,o(M)?"[".concat(M.join("+"),"]"):M))},Is.prototype.reverse=function(){return this.toCollection().reverse()},Is.prototype.mapToClass=function(M){var z,te=this.db,ae=this.name;function pe(){return z!==null&&z.apply(this,arguments)||this}(this.schema.mappedClass=M).prototype instanceof vg&&(function(st,at){if(typeof at!="function"&&at!==null)throw new TypeError("Class extends value "+String(at)+" is not a constructor or null");function pt(){this.constructor=st}n(st,at),st.prototype=at===null?Object.create(at):(pt.prototype=at.prototype,new pt)}(pe,z=M),Object.defineProperty(pe.prototype,"db",{get:function(){return te},enumerable:!1,configurable:!0}),pe.prototype.table=function(){return ae},M=pe);for(var Ne=new Set,Le=M.prototype;Le;Le=c(Le))Object.getOwnPropertyNames(Le).forEach(function(st){return Ne.add(st)});function Ge(st){if(!st)return st;var at,pt=Object.create(M.prototype);for(at in st)if(!Ne.has(at))try{pt[at]=st[at]}catch{}return pt}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=Ge,this.hook("reading",Ge),M},Is.prototype.defineClass=function(){return this.mapToClass(function(M){l(this,M)})},Is.prototype.add=function(M,z){var te=this,ae=this.schema.primKey,pe=ae.auto,Ne=ae.keyPath,Le=M;return Ne&&pe&&(Le=Tf(Ne)(M)),this._trans("readwrite",function(Ge){return te.core.mutate({trans:Ge,type:"add",keys:z!=null?[z]:null,values:[Le]})}).then(function(Ge){return Ge.numFailures?$.reject(Ge.failures[0]):Ge.lastResult}).then(function(Ge){if(Ne)try{A(M,Ne,Ge)}catch{}return Ge})},Is.prototype.update=function(M,z){return typeof M!="object"||o(M)?this.where(":id").equals(M).modify(z):(M=T(M,this.schema.primKey.keyPath),M===void 0?ar(new _e.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(M).modify(z))},Is.prototype.put=function(M,z){var te=this,ae=this.schema.primKey,pe=ae.auto,Ne=ae.keyPath,Le=M;return Ne&&pe&&(Le=Tf(Ne)(M)),this._trans("readwrite",function(Ge){return te.core.mutate({trans:Ge,type:"put",values:[Le],keys:z!=null?[z]:null})}).then(function(Ge){return Ge.numFailures?$.reject(Ge.failures[0]):Ge.lastResult}).then(function(Ge){if(Ne)try{A(M,Ne,Ge)}catch{}return Ge})},Is.prototype.delete=function(M){var z=this;return this._trans("readwrite",function(te){return z.core.mutate({trans:te,type:"delete",keys:[M]})}).then(function(te){return te.numFailures?$.reject(te.failures[0]):void 0})},Is.prototype.clear=function(){var M=this;return this._trans("readwrite",function(z){return M.core.mutate({trans:z,type:"deleteRange",range:Al})}).then(function(z){return z.numFailures?$.reject(z.failures[0]):void 0})},Is.prototype.bulkGet=function(M){var z=this;return this._trans("readonly",function(te){return z.core.getMany({keys:M,trans:te}).then(function(ae){return ae.map(function(pe){return z.hook.reading.fire(pe)})})})},Is.prototype.bulkAdd=function(M,z,te){var ae=this,pe=Array.isArray(z)?z:void 0,Ne=(te=te||(pe?void 0:z))?te.allKeys:void 0;return this._trans("readwrite",function(Le){var at=ae.schema.primKey,Ge=at.auto,at=at.keyPath;if(at&&pe)throw new _e.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(pe&&pe.length!==M.length)throw new _e.InvalidArgument("Arguments objects and keys must have the same length");var st=M.length,at=at&&Ge?M.map(Tf(at)):M;return ae.core.mutate({trans:Le,type:"add",keys:pe,values:at,wantResults:Ne}).then(function(ht){var Je=ht.numFailures,gt=ht.results,rt=ht.lastResult,ht=ht.failures;if(Je===0)return Ne?gt:rt;throw new De("".concat(ae.name,".bulkAdd(): ").concat(Je," of ").concat(st," operations failed"),ht)})})},Is.prototype.bulkPut=function(M,z,te){var ae=this,pe=Array.isArray(z)?z:void 0,Ne=(te=te||(pe?void 0:z))?te.allKeys:void 0;return this._trans("readwrite",function(Le){var at=ae.schema.primKey,Ge=at.auto,at=at.keyPath;if(at&&pe)throw new _e.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(pe&&pe.length!==M.length)throw new _e.InvalidArgument("Arguments objects and keys must have the same length");var st=M.length,at=at&&Ge?M.map(Tf(at)):M;return ae.core.mutate({trans:Le,type:"put",keys:pe,values:at,wantResults:Ne}).then(function(ht){var Je=ht.numFailures,gt=ht.results,rt=ht.lastResult,ht=ht.failures;if(Je===0)return Ne?gt:rt;throw new De("".concat(ae.name,".bulkPut(): ").concat(Je," of ").concat(st," operations failed"),ht)})})},Is.prototype.bulkUpdate=function(M){var z=this,te=this.core,ae=M.map(function(Le){return Le.key}),pe=M.map(function(Le){return Le.changes}),Ne=[];return this._trans("readwrite",function(Le){return te.getMany({trans:Le,keys:ae,cache:"clone"}).then(function(Ge){var st=[],at=[];M.forEach(function(Je,gt){var rt=Je.key,ht=Je.changes,bt=Ge[gt];if(bt){for(var lt=0,kt=Object.keys(ht);lt<kt.length;lt++){var It=kt[lt],Mt=ht[It];if(It===z.schema.primKey.keyPath){if(Lr(Mt,rt)!==0)throw new _e.Constraint("Cannot update primary key in bulkUpdate()")}else A(bt,It,Mt)}Ne.push(gt),st.push(rt),at.push(bt)}});var pt=st.length;return te.mutate({trans:Le,type:"put",keys:st,values:at,updates:{keys:ae,changeSpecs:pe}}).then(function(Je){var gt=Je.numFailures,rt=Je.failures;if(gt===0)return pt;for(var ht=0,bt=Object.keys(rt);ht<bt.length;ht++){var lt,kt=bt[ht],It=Ne[Number(kt)];It!=null&&(lt=rt[kt],delete rt[kt],rt[It]=lt)}throw new De("".concat(z.name,".bulkUpdate(): ").concat(gt," of ").concat(pt," operations failed"),rt)})})})},Is.prototype.bulkDelete=function(M){var z=this,te=M.length;return this._trans("readwrite",function(ae){return z.core.mutate({trans:ae,type:"delete",keys:M})}).then(function(Le){var pe=Le.numFailures,Ne=Le.lastResult,Le=Le.failures;if(pe===0)return Ne;throw new De("".concat(z.name,".bulkDelete(): ").concat(pe," of ").concat(te," operations failed"),Le)})},Is);function Is(){}function nu(M){function z(Le,Ge){if(Ge){for(var st=arguments.length,at=new Array(st-1);--st;)at[st-1]=arguments[st];return te[Le].subscribe.apply(null,at),M}if(typeof Le=="string")return te[Le]}var te={};z.addEventType=Ne;for(var ae=1,pe=arguments.length;ae<pe;++ae)Ne(arguments[ae]);return z;function Ne(Le,Ge,st){if(typeof Le!="object"){var at;Ge=Ge||se;var pt={subscribers:[],fire:st=st||We,subscribe:function(Je){pt.subscribers.indexOf(Je)===-1&&(pt.subscribers.push(Je),pt.fire=Ge(pt.fire,Je))},unsubscribe:function(Je){pt.subscribers=pt.subscribers.filter(function(gt){return gt!==Je}),pt.fire=pt.subscribers.reduce(Ge,st)}};return te[Le]=z[Le]=pt}a(at=Le).forEach(function(Je){var gt=at[Je];if(o(gt))Ne(Je,at[Je][0],at[Je][1]);else{if(gt!=="asap")throw new _e.InvalidArgument("Invalid event config");var rt=Ne(Je,Pe,function(){for(var ht=arguments.length,bt=new Array(ht);ht--;)bt[ht]=arguments[ht];rt.subscribers.forEach(function(lt){C(function(){lt.apply(null,bt)})})})}})}}function Af(M,z){return b(z).from({prototype:M}),z}function vc(M,z){return!(M.filter||M.algorithm||M.or)&&(z?M.justLimit:!M.replayFilter)}function Bb(M,z){M.filter=el(M.filter,z)}function Ia(M,z,te){var ae=M.replayFilter;M.replayFilter=ae?function(){return el(ae(),z())}:z,M.justLimit=te&&!ae}function Rf(M,z){if(M.isPrimKey)return z.primaryKey;var te=z.getIndexByKeyPath(M.index);if(!te)throw new _e.Schema("KeyPath "+M.index+" on object store "+z.name+" is not indexed");return te}function $b(M,z,te){var ae=Rf(M,z.schema);return z.openCursor({trans:te,values:!M.keysOnly,reverse:M.dir==="prev",unique:!!M.unique,query:{index:ae,range:M.range}})}function Nf(M,z,te,ae){var pe=M.replayFilter?el(M.filter,M.replayFilter()):M.filter;if(M.or){var Ne={},Le=function(Ge,st,at){var pt,Je;pe&&!pe(st,at,function(gt){return st.stop(gt)},function(gt){return st.fail(gt)})||((Je=""+(pt=st.primaryKey))=="[object ArrayBuffer]"&&(Je=""+new Uint8Array(pt)),d(Ne,Je)||(Ne[Je]=!0,z(Ge,st,at)))};return Promise.all([M.or._iterate(Le,te),od($b(M,ae,te),M.algorithm,Le,!M.keysOnly&&M.valueMapper)])}return od($b(M,ae,te),el(M.algorithm,pe),z,!M.keysOnly&&M.valueMapper)}function od(M,z,te,ae){var pe=Fe(ae?function(Ne,Le,Ge){return te(ae(Ne),Le,Ge)}:te);return M.then(function(Ne){if(Ne)return Ne.start(function(){var Le=function(){return Ne.continue()};z&&!z(Ne,function(Ge){return Le=Ge},function(Ge){Ne.stop(Ge),Le=We},function(Ge){Ne.fail(Ge),Le=We})||pe(Ne.value,Ne,function(Ge){return Le=Ge}),Le()})})}var If=(zb.prototype.execute=function(M){var z=this["@@propmod"];if(z.add!==void 0){var te=z.add;if(o(te))return s(s([],o(M)?M:[],!0),te).sort();if(typeof te=="number")return(Number(M)||0)+te;if(typeof te=="bigint")try{return BigInt(M)+te}catch{return BigInt(0)+te}throw new TypeError("Invalid term ".concat(te))}if(z.remove!==void 0){var ae=z.remove;if(o(ae))return o(M)?M.filter(function(pe){return!ae.includes(pe)}).sort():[];if(typeof ae=="number")return Number(M)-ae;if(typeof ae=="bigint")try{return BigInt(M)-ae}catch{return BigInt(0)-ae}throw new TypeError("Invalid subtrahend ".concat(ae))}return te=(te=z.replacePrefix)===null||te===void 0?void 0:te[0],te&&typeof M=="string"&&M.startsWith(te)?z.replacePrefix[1]+M.substring(te.length):M},zb);function zb(M){this["@@propmod"]=M}var Mf=(Kr.prototype._read=function(M,z){var te=this._ctx;return te.error?te.table._trans(null,ar.bind(null,te.error)):te.table._trans("readonly",M).then(z)},Kr.prototype._write=function(M){var z=this._ctx;return z.error?z.table._trans(null,ar.bind(null,z.error)):z.table._trans("readwrite",M,"locked")},Kr.prototype._addAlgorithm=function(M){var z=this._ctx;z.algorithm=el(z.algorithm,M)},Kr.prototype._iterate=function(M,z){return Nf(this._ctx,M,z,this._ctx.table.core)},Kr.prototype.clone=function(M){var z=Object.create(this.constructor.prototype),te=Object.create(this._ctx);return M&&l(te,M),z._ctx=te,z},Kr.prototype.raw=function(){return this._ctx.valueMapper=null,this},Kr.prototype.each=function(M){var z=this._ctx;return this._read(function(te){return Nf(z,M,te,z.table.core)})},Kr.prototype.count=function(M){var z=this;return this._read(function(te){var ae=z._ctx,pe=ae.table.core;if(vc(ae,!0))return pe.count({trans:te,query:{index:Rf(ae,pe.schema),range:ae.range}}).then(function(Le){return Math.min(Le,ae.limit)});var Ne=0;return Nf(ae,function(){return++Ne,!1},te,pe).then(function(){return Ne})}).then(M)},Kr.prototype.sortBy=function(M,z){var te=M.split(".").reverse(),ae=te[0],pe=te.length-1;function Ne(st,at){return at?Ne(st[te[at]],at-1):st[ae]}var Le=this._ctx.dir==="next"?1:-1;function Ge(st,at){return Lr(Ne(st,pe),Ne(at,pe))*Le}return this.toArray(function(st){return st.sort(Ge)}).then(z)},Kr.prototype.toArray=function(M){var z=this;return this._read(function(te){var ae=z._ctx;if(ae.dir==="next"&&vc(ae,!0)&&0<ae.limit){var pe=ae.valueMapper,Ne=Rf(ae,ae.table.core.schema);return ae.table.core.query({trans:te,limit:ae.limit,values:!0,query:{index:Ne,range:ae.range}}).then(function(Ge){return Ge=Ge.result,pe?Ge.map(pe):Ge})}var Le=[];return Nf(ae,function(Ge){return Le.push(Ge)},te,ae.table.core).then(function(){return Le})},M)},Kr.prototype.offset=function(M){var z=this._ctx;return M<=0||(z.offset+=M,vc(z)?Ia(z,function(){var te=M;return function(ae,pe){return te===0||(te===1?--te:pe(function(){ae.advance(te),te=0}),!1)}}):Ia(z,function(){var te=M;return function(){return--te<0}})),this},Kr.prototype.limit=function(M){return this._ctx.limit=Math.min(this._ctx.limit,M),Ia(this._ctx,function(){var z=M;return function(te,ae,pe){return--z<=0&&ae(pe),0<=z}},!0),this},Kr.prototype.until=function(M,z){return Bb(this._ctx,function(te,ae,pe){return!M(te.value)||(ae(pe),z)}),this},Kr.prototype.first=function(M){return this.limit(1).toArray(function(z){return z[0]}).then(M)},Kr.prototype.last=function(M){return this.reverse().first(M)},Kr.prototype.filter=function(M){var z;return Bb(this._ctx,function(te){return M(te.value)}),(z=this._ctx).isMatch=el(z.isMatch,M),this},Kr.prototype.and=function(M){return this.filter(M)},Kr.prototype.or=function(M){return new this.db.WhereClause(this._ctx.table,M,this)},Kr.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},Kr.prototype.desc=function(){return this.reverse()},Kr.prototype.eachKey=function(M){var z=this._ctx;return z.keysOnly=!z.isMatch,this.each(function(te,ae){M(ae.key,ae)})},Kr.prototype.eachUniqueKey=function(M){return this._ctx.unique="unique",this.eachKey(M)},Kr.prototype.eachPrimaryKey=function(M){var z=this._ctx;return z.keysOnly=!z.isMatch,this.each(function(te,ae){M(ae.primaryKey,ae)})},Kr.prototype.keys=function(M){var z=this._ctx;z.keysOnly=!z.isMatch;var te=[];return this.each(function(ae,pe){te.push(pe.key)}).then(function(){return te}).then(M)},Kr.prototype.primaryKeys=function(M){var z=this._ctx;if(z.dir==="next"&&vc(z,!0)&&0<z.limit)return this._read(function(ae){var pe=Rf(z,z.table.core.schema);return z.table.core.query({trans:ae,values:!1,limit:z.limit,query:{index:pe,range:z.range}})}).then(function(ae){return ae.result}).then(M);z.keysOnly=!z.isMatch;var te=[];return this.each(function(ae,pe){te.push(pe.primaryKey)}).then(function(){return te}).then(M)},Kr.prototype.uniqueKeys=function(M){return this._ctx.unique="unique",this.keys(M)},Kr.prototype.firstKey=function(M){return this.limit(1).keys(function(z){return z[0]}).then(M)},Kr.prototype.lastKey=function(M){return this.reverse().firstKey(M)},Kr.prototype.distinct=function(){var M=this._ctx,M=M.index&&M.table.schema.idxByName[M.index];if(!M||!M.multi)return this;var z={};return Bb(this._ctx,function(pe){var ae=pe.primaryKey.toString(),pe=d(z,ae);return z[ae]=!0,!pe}),this},Kr.prototype.modify=function(M){var z=this,te=this._ctx;return this._write(function(ae){var pe,Ne,Le;Le=typeof M=="function"?M:(pe=a(M),Ne=pe.length,function(lt){for(var kt=!1,It=0;It<Ne;++It){var Mt=pe[It],Ot=M[Mt],Xt=T(lt,Mt);Ot instanceof If?(A(lt,Mt,Ot.execute(Xt)),kt=!0):Xt!==Ot&&(A(lt,Mt,Ot),kt=!0)}return kt});var Ge=te.table.core,Je=Ge.schema.primaryKey,st=Je.outbound,at=Je.extractKey,pt=200,Je=z.db._options.modifyChunkSize;Je&&(pt=typeof Je=="object"?Je[Ge.name]||Je["*"]||200:Je);function gt(lt,Mt){var It=Mt.failures,Mt=Mt.numFailures;ht+=lt-Mt;for(var Ot=0,Xt=a(It);Ot<Xt.length;Ot++){var sn=Xt[Ot];rt.push(It[sn])}}var rt=[],ht=0,bt=[];return z.clone().primaryKeys().then(function(lt){function kt(Mt){var Ot=Math.min(pt,lt.length-Mt);return Ge.getMany({trans:ae,keys:lt.slice(Mt,Mt+Ot),cache:"immutable"}).then(function(Xt){for(var sn=[],Ht=[],en=st?[]:null,ln=[],Gt=0;Gt<Ot;++Gt){var bn=Xt[Gt],qn={value:H(bn),primKey:lt[Mt+Gt]};Le.call(qn,qn.value,qn)!==!1&&(qn.value==null?ln.push(lt[Mt+Gt]):st||Lr(at(bn),at(qn.value))===0?(Ht.push(qn.value),st&&en.push(lt[Mt+Gt])):(ln.push(lt[Mt+Gt]),sn.push(qn.value)))}return Promise.resolve(0<sn.length&&Ge.mutate({trans:ae,type:"add",values:sn}).then(function(Yn){for(var mr in Yn.failures)ln.splice(parseInt(mr),1);gt(sn.length,Yn)})).then(function(){return(0<Ht.length||It&&typeof M=="object")&&Ge.mutate({trans:ae,type:"put",keys:en,values:Ht,criteria:It,changeSpec:typeof M!="function"&&M,isAdditionalChunk:0<Mt}).then(function(Yn){return gt(Ht.length,Yn)})}).then(function(){return(0<ln.length||It&&M===xg)&&Ge.mutate({trans:ae,type:"delete",keys:ln,criteria:It,isAdditionalChunk:0<Mt}).then(function(Yn){return gt(ln.length,Yn)})}).then(function(){return lt.length>Mt+Ot&&kt(Mt+pt)})})}var It=vc(te)&&te.limit===1/0&&(typeof M!="function"||M===xg)&&{index:te.index,range:te.range};return kt(0).then(function(){if(0<rt.length)throw new me("Error modifying one or more objects",rt,ht,bt);return lt.length})})})},Kr.prototype.delete=function(){var M=this._ctx,z=M.range;return vc(M)&&(M.isPrimKey||z.type===3)?this._write(function(te){var ae=M.table.core.schema.primaryKey,pe=z;return M.table.core.count({trans:te,query:{index:ae,range:pe}}).then(function(Ne){return M.table.core.mutate({trans:te,type:"deleteRange",range:pe}).then(function(Le){var Ge=Le.failures;if(Le.lastResult,Le.results,Le=Le.numFailures,Le)throw new me("Could not delete some values",Object.keys(Ge).map(function(st){return Ge[st]}),Ne-Le);return Ne-Le})})}):this.modify(xg)},Kr);function Kr(){}var xg=function(M,z){return z.value=null};function MS(M,z){return M<z?-1:M===z?0:1}function Ub(M,z){return z<M?-1:M===z?0:1}function Qa(M,z,te){return M=M instanceof cd?new M.Collection(M):M,M._ctx.error=new(te||TypeError)(z),M}function jf(M){return new M.Collection(M,function(){return wg("")}).limit(0)}function ld(M,z,te,ae){var pe,Ne,Le,Ge,st,at,pt,Je=te.length;if(!te.every(function(ht){return typeof ht=="string"}))return Qa(M,zi);function gt(ht){pe=ht==="next"?function(lt){return lt.toUpperCase()}:function(lt){return lt.toLowerCase()},Ne=ht==="next"?function(lt){return lt.toLowerCase()}:function(lt){return lt.toUpperCase()},Le=ht==="next"?MS:Ub;var bt=te.map(function(lt){return{lower:Ne(lt),upper:pe(lt)}}).sort(function(lt,kt){return Le(lt.lower,kt.lower)});Ge=bt.map(function(lt){return lt.upper}),st=bt.map(function(lt){return lt.lower}),pt=(at=ht)==="next"?"":ae}gt("next"),M=new M.Collection(M,function(){return Rl(Ge[0],st[Je-1]+ae)}),M._ondirectionchange=function(ht){gt(ht)};var rt=0;return M._addAlgorithm(function(ht,bt,lt){var kt=ht.key;if(typeof kt!="string")return!1;var It=Ne(kt);if(z(It,st,rt))return!0;for(var Mt=null,Ot=rt;Ot<Je;++Ot){var Xt=function(sn,Ht,en,ln,Gt,bn){for(var qn=Math.min(sn.length,ln.length),Yn=-1,mr=0;mr<qn;++mr){var va=Ht[mr];if(va!==ln[mr])return Gt(sn[mr],en[mr])<0?sn.substr(0,mr)+en[mr]+en.substr(mr+1):Gt(sn[mr],ln[mr])<0?sn.substr(0,mr)+ln[mr]+en.substr(mr+1):0<=Yn?sn.substr(0,Yn)+Ht[Yn]+en.substr(Yn+1):null;Gt(sn[mr],va)<0&&(Yn=mr)}return qn<ln.length&&bn==="next"?sn+en.substr(sn.length):qn<sn.length&&bn==="prev"?sn.substr(0,en.length):Yn<0?null:sn.substr(0,Yn)+ln[Yn]+en.substr(Yn+1)}(kt,It,Ge[Ot],st[Ot],Le,at);Xt===null&&Mt===null?rt=Ot+1:(Mt===null||0<Le(Mt,Xt))&&(Mt=Xt)}return bt(Mt!==null?function(){ht.continue(Mt+pt)}:lt),!1}),M}function Rl(M,z,te,ae){return{type:2,lower:M,upper:z,lowerOpen:te,upperOpen:ae}}function wg(M){return{type:1,lower:M,upper:M}}var cd=(Object.defineProperty(Bs.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),Bs.prototype.between=function(M,z,te,ae){te=te!==!1,ae=ae===!0;try{return 0<this._cmp(M,z)||this._cmp(M,z)===0&&(te||ae)&&(!te||!ae)?jf(this):new this.Collection(this,function(){return Rl(M,z,!te,!ae)})}catch{return Qa(this,ts)}},Bs.prototype.equals=function(M){return M==null?Qa(this,ts):new this.Collection(this,function(){return wg(M)})},Bs.prototype.above=function(M){return M==null?Qa(this,ts):new this.Collection(this,function(){return Rl(M,void 0,!0)})},Bs.prototype.aboveOrEqual=function(M){return M==null?Qa(this,ts):new this.Collection(this,function(){return Rl(M,void 0,!1)})},Bs.prototype.below=function(M){return M==null?Qa(this,ts):new this.Collection(this,function(){return Rl(void 0,M,!1,!0)})},Bs.prototype.belowOrEqual=function(M){return M==null?Qa(this,ts):new this.Collection(this,function(){return Rl(void 0,M)})},Bs.prototype.startsWith=function(M){return typeof M!="string"?Qa(this,zi):this.between(M,M+Ns,!0,!0)},Bs.prototype.startsWithIgnoreCase=function(M){return M===""?this.startsWith(M):ld(this,function(z,te){return z.indexOf(te[0])===0},[M],Ns)},Bs.prototype.equalsIgnoreCase=function(M){return ld(this,function(z,te){return z===te[0]},[M],"")},Bs.prototype.anyOfIgnoreCase=function(){var M=V.apply(ne,arguments);return M.length===0?jf(this):ld(this,function(z,te){return te.indexOf(z)!==-1},M,"")},Bs.prototype.startsWithAnyOfIgnoreCase=function(){var M=V.apply(ne,arguments);return M.length===0?jf(this):ld(this,function(z,te){return te.some(function(ae){return z.indexOf(ae)===0})},M,Ns)},Bs.prototype.anyOf=function(){var M=this,z=V.apply(ne,arguments),te=this._cmp;try{z.sort(te)}catch{return Qa(this,ts)}if(z.length===0)return jf(this);var ae=new this.Collection(this,function(){return Rl(z[0],z[z.length-1])});ae._ondirectionchange=function(Ne){te=Ne==="next"?M._ascending:M._descending,z.sort(te)};var pe=0;return ae._addAlgorithm(function(Ne,Le,Ge){for(var st=Ne.key;0<te(st,z[pe]);)if(++pe===z.length)return Le(Ge),!1;return te(st,z[pe])===0||(Le(function(){Ne.continue(z[pe])}),!1)}),ae},Bs.prototype.notEqual=function(M){return this.inAnyRange([[-1/0,M],[M,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},Bs.prototype.noneOf=function(){var M=V.apply(ne,arguments);if(M.length===0)return new this.Collection(this);try{M.sort(this._ascending)}catch{return Qa(this,ts)}var z=M.reduce(function(te,ae){return te?te.concat([[te[te.length-1][1],ae]]):[[-1/0,ae]]},null);return z.push([M[M.length-1],this.db._maxKey]),this.inAnyRange(z,{includeLowers:!1,includeUppers:!1})},Bs.prototype.inAnyRange=function(kt,z){var te=this,ae=this._cmp,pe=this._ascending,Ne=this._descending,Le=this._min,Ge=this._max;if(kt.length===0)return jf(this);if(!kt.every(function(It){return It[0]!==void 0&&It[1]!==void 0&&pe(It[0],It[1])<=0}))return Qa(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",_e.InvalidArgument);var st=!z||z.includeLowers!==!1,at=z&&z.includeUppers===!0,pt,Je=pe;function gt(It,Mt){return Je(It[0],Mt[0])}try{(pt=kt.reduce(function(It,Mt){for(var Ot=0,Xt=It.length;Ot<Xt;++Ot){var sn=It[Ot];if(ae(Mt[0],sn[1])<0&&0<ae(Mt[1],sn[0])){sn[0]=Le(sn[0],Mt[0]),sn[1]=Ge(sn[1],Mt[1]);break}}return Ot===Xt&&It.push(Mt),It},[])).sort(gt)}catch{return Qa(this,ts)}var rt=0,ht=at?function(It){return 0<pe(It,pt[rt][1])}:function(It){return 0<=pe(It,pt[rt][1])},bt=st?function(It){return 0<Ne(It,pt[rt][0])}:function(It){return 0<=Ne(It,pt[rt][0])},lt=ht,kt=new this.Collection(this,function(){return Rl(pt[0][0],pt[pt.length-1][1],!st,!at)});return kt._ondirectionchange=function(It){Je=It==="next"?(lt=ht,pe):(lt=bt,Ne),pt.sort(gt)},kt._addAlgorithm(function(It,Mt,Ot){for(var Xt,sn=It.key;lt(sn);)if(++rt===pt.length)return Mt(Ot),!1;return!ht(Xt=sn)&&!bt(Xt)||(te._cmp(sn,pt[rt][1])===0||te._cmp(sn,pt[rt][0])===0||Mt(function(){Je===pe?It.continue(pt[rt][0]):It.continue(pt[rt][1])}),!1)}),kt},Bs.prototype.startsWithAnyOf=function(){var M=V.apply(ne,arguments);return M.every(function(z){return typeof z=="string"})?M.length===0?jf(this):this.inAnyRange(M.map(function(z){return[z,z+Ns]})):Qa(this,"startsWithAnyOf() only works with strings")},Bs);function Bs(){}function tl(M){return Fe(function(z){return ud(z),M(z.target.error),!1})}function ud(M){M.stopPropagation&&M.stopPropagation(),M.preventDefault&&M.preventDefault()}var Pf="storagemutated",dd="x-storagemutated-1",ta=nu(null,Pf),qb=(Ma.prototype._lock=function(){return k(!Ae.global),++this._reculock,this._reculock!==1||Ae.global||(Ae.lockOwnerFor=this),this},Ma.prototype._unlock=function(){if(k(!Ae.global),--this._reculock==0)for(Ae.global||(Ae.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var M=this._blockedFuncs.shift();try{nt(M[1],M[0])}catch{}}return this},Ma.prototype._locked=function(){return this._reculock&&Ae.lockOwnerFor!==this},Ma.prototype.create=function(M){var z=this;if(!this.mode)return this;var te=this.db.idbdb,ae=this.db._state.dbOpenError;if(k(!this.idbtrans),!M&&!te)switch(ae&&ae.name){case"DatabaseClosedError":throw new _e.DatabaseClosed(ae);case"MissingAPIError":throw new _e.MissingAPI(ae.message,ae);default:throw new _e.OpenFailed(ae)}if(!this.active)throw new _e.TransactionInactive;return k(this._completion._state===null),(M=this.idbtrans=M||(this.db.core||te).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=Fe(function(pe){ud(pe),z._reject(M.error)}),M.onabort=Fe(function(pe){ud(pe),z.active&&z._reject(new _e.Abort(M.error)),z.active=!1,z.on("abort").fire(pe)}),M.oncomplete=Fe(function(){z.active=!1,z._resolve(),"mutatedParts"in M&&ta.storagemutated.fire(M.mutatedParts)}),this},Ma.prototype._promise=function(M,z,te){var ae=this;if(M==="readwrite"&&this.mode!=="readwrite")return ar(new _e.ReadOnly("Transaction is readonly"));if(!this.active)return ar(new _e.TransactionInactive);if(this._locked())return new $(function(Ne,Le){ae._blockedFuncs.push([function(){ae._promise(M,z,te).then(Ne,Le)},Ae])});if(te)return fn(function(){var Ne=new $(function(Le,Ge){ae._lock();var st=z(Le,Ge,ae);st&&st.then&&st.then(Le,Ge)});return Ne.finally(function(){return ae._unlock()}),Ne._lib=!0,Ne});var pe=new $(function(Ne,Le){var Ge=z(Ne,Le,ae);Ge&&Ge.then&&Ge.then(Ne,Le)});return pe._lib=!0,pe},Ma.prototype._root=function(){return this.parent?this.parent._root():this},Ma.prototype.waitFor=function(M){var z,te=this._root(),ae=$.resolve(M);te._waitingFor?te._waitingFor=te._waitingFor.then(function(){return ae}):(te._waitingFor=ae,te._waitingQueue=[],z=te.idbtrans.objectStore(te.storeNames[0]),function Ne(){for(++te._spinCount;te._waitingQueue.length;)te._waitingQueue.shift()();te._waitingFor&&(z.get(-1/0).onsuccess=Ne)}());var pe=te._waitingFor;return new $(function(Ne,Le){ae.then(function(Ge){return te._waitingQueue.push(Fe(Ne.bind(null,Ge)))},function(Ge){return te._waitingQueue.push(Fe(Le.bind(null,Ge)))}).finally(function(){te._waitingFor===pe&&(te._waitingFor=null)})})},Ma.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new _e.Abort))},Ma.prototype.table=function(M){var z=this._memoizedTables||(this._memoizedTables={});if(d(z,M))return z[M];var te=this.schema[M];if(!te)throw new _e.NotFound("Table "+M+" not part of transaction");return te=new this.db.Table(M,te,this),te.core=this.db.core.table(M),z[M]=te},Ma);function Ma(){}function Nl(M,z,te,ae,pe,Ne,Le){return{name:M,keyPath:z,unique:te,multi:ae,auto:pe,compound:Ne,src:(te&&!Le?"&":"")+(ae?"*":"")+(pe?"++":"")+Sg(z)}}function Sg(M){return typeof M=="string"?M:M?"["+[].join.call(M,"+")+"]":""}function Of(M,z,te){return{name:M,primKey:z,indexes:te,mappedClass:null,idxByName:(ae=function(pe){return[pe.name,pe]},te.reduce(function(pe,Ne,Le){return Le=ae(Ne,Le),Le&&(pe[Le[0]]=Le[1]),pe},{}))};var ae}var Df=function(M){try{return M.only([[]]),Df=function(){return[[]]},[[]]}catch{return Df=function(){return Ns},Ns}};function Ff(M){return M==null?function(){}:typeof M=="string"?(z=M).split(".").length===1?function(te){return te[z]}:function(te){return T(te,z)}:function(te){return T(te,M)};var z}function _p(M){return[].slice.call(M)}var jS=0;function Ai(M){return M==null?":id":typeof M=="string"?M:"[".concat(M.join("+"),"]")}function fd(M,z,st){function ae(lt){if(lt.type===3)return null;if(lt.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var rt=lt.lower,ht=lt.upper,bt=lt.lowerOpen,lt=lt.upperOpen;return rt===void 0?ht===void 0?null:z.upperBound(ht,!!lt):ht===void 0?z.lowerBound(rt,!!bt):z.bound(rt,ht,!!bt,!!lt)}function pe(gt){var rt,ht=gt.name;return{name:ht,schema:gt,mutate:function(bt){var lt=bt.trans,kt=bt.type,It=bt.keys,Mt=bt.values,Ot=bt.range;return new Promise(function(Xt,sn){Xt=Fe(Xt);var Ht=lt.objectStore(ht),en=Ht.keyPath==null,ln=kt==="put"||kt==="add";if(!ln&&kt!=="delete"&&kt!=="deleteRange")throw new Error("Invalid operation type: "+kt);var Gt,bn=(It||Mt||{length:1}).length;if(It&&Mt&&It.length!==Mt.length)throw new Error("Given keys array must have same length as given values array.");if(bn===0)return Xt({numFailures:0,failures:{},results:[],lastResult:void 0});function qn(ra){++va,ud(ra)}var Yn=[],mr=[],va=0;if(kt==="deleteRange"){if(Ot.type===4)return Xt({numFailures:va,failures:mr,results:[],lastResult:void 0});Ot.type===3?Yn.push(Gt=Ht.clear()):Yn.push(Gt=Ht.delete(ae(Ot)))}else{var en=ln?en?[Mt,It]:[Mt,null]:[It,null],or=en[0],hi=en[1];if(ln)for(var Ri=0;Ri<bn;++Ri)Yn.push(Gt=hi&&hi[Ri]!==void 0?Ht[kt](or[Ri],hi[Ri]):Ht[kt](or[Ri])),Gt.onerror=qn;else for(Ri=0;Ri<bn;++Ri)Yn.push(Gt=Ht[kt](or[Ri])),Gt.onerror=qn}function xc(ra){ra=ra.target.result,Yn.forEach(function(Ml,au){return Ml.error!=null&&(mr[au]=Ml.error)}),Xt({numFailures:va,failures:mr,results:kt==="delete"?It:Yn.map(function(Ml){return Ml.result}),lastResult:ra})}Gt.onerror=function(ra){qn(ra),xc(ra)},Gt.onsuccess=xc})},getMany:function(bt){var lt=bt.trans,kt=bt.keys;return new Promise(function(It,Mt){It=Fe(It);for(var Ot,Xt=lt.objectStore(ht),sn=kt.length,Ht=new Array(sn),en=0,ln=0,Gt=function(Yn){Yn=Yn.target,Ht[Yn._pos]=Yn.result,++ln===en&&It(Ht)},bn=tl(Mt),qn=0;qn<sn;++qn)kt[qn]!=null&&((Ot=Xt.get(kt[qn]))._pos=qn,Ot.onsuccess=Gt,Ot.onerror=bn,++en);en===0&&It(Ht)})},get:function(bt){var lt=bt.trans,kt=bt.key;return new Promise(function(It,Mt){It=Fe(It);var Ot=lt.objectStore(ht).get(kt);Ot.onsuccess=function(Xt){return It(Xt.target.result)},Ot.onerror=tl(Mt)})},query:(rt=at,function(bt){return new Promise(function(lt,kt){lt=Fe(lt);var It,Mt,Ot,en=bt.trans,Xt=bt.values,sn=bt.limit,Gt=bt.query,Ht=sn===1/0?void 0:sn,ln=Gt.index,Gt=Gt.range,en=en.objectStore(ht),ln=ln.isPrimaryKey?en:en.index(ln.name),Gt=ae(Gt);if(sn===0)return lt({result:[]});rt?((Ht=Xt?ln.getAll(Gt,Ht):ln.getAllKeys(Gt,Ht)).onsuccess=function(bn){return lt({result:bn.target.result})},Ht.onerror=tl(kt)):(It=0,Mt=!Xt&&"openKeyCursor"in ln?ln.openKeyCursor(Gt):ln.openCursor(Gt),Ot=[],Mt.onsuccess=function(bn){var qn=Mt.result;return qn?(Ot.push(Xt?qn.value:qn.primaryKey),++It===sn?lt({result:Ot}):void qn.continue()):lt({result:Ot})},Mt.onerror=tl(kt))})}),openCursor:function(bt){var lt=bt.trans,kt=bt.values,It=bt.query,Mt=bt.reverse,Ot=bt.unique;return new Promise(function(Xt,sn){Xt=Fe(Xt);var ln=It.index,Ht=It.range,en=lt.objectStore(ht),en=ln.isPrimaryKey?en:en.index(ln.name),ln=Mt?Ot?"prevunique":"prev":Ot?"nextunique":"next",Gt=!kt&&"openKeyCursor"in en?en.openKeyCursor(ae(Ht),ln):en.openCursor(ae(Ht),ln);Gt.onerror=tl(sn),Gt.onsuccess=Fe(function(bn){var qn,Yn,mr,va,or=Gt.result;or?(or.___id=++jS,or.done=!1,qn=or.continue.bind(or),Yn=(Yn=or.continuePrimaryKey)&&Yn.bind(or),mr=or.advance.bind(or),va=function(){throw new Error("Cursor not stopped")},or.trans=lt,or.stop=or.continue=or.continuePrimaryKey=or.advance=function(){throw new Error("Cursor not started")},or.fail=Fe(sn),or.next=function(){var hi=this,Ri=1;return this.start(function(){return Ri--?hi.continue():hi.stop()}).then(function(){return hi})},or.start=function(hi){function Ri(){if(Gt.result)try{hi()}catch(ra){or.fail(ra)}else or.done=!0,or.start=function(){throw new Error("Cursor behind last entry")},or.stop()}var xc=new Promise(function(ra,Ml){ra=Fe(ra),Gt.onerror=tl(Ml),or.fail=Ml,or.stop=function(au){or.stop=or.continue=or.continuePrimaryKey=or.advance=va,ra(au)}});return Gt.onsuccess=Fe(function(ra){Gt.onsuccess=Ri,Ri()}),or.continue=qn,or.continuePrimaryKey=Yn,or.advance=mr,Ri(),xc},Xt(or)):Xt(null)},sn)})},count:function(bt){var lt=bt.query,kt=bt.trans,It=lt.index,Mt=lt.range;return new Promise(function(Ot,Xt){var sn=kt.objectStore(ht),Ht=It.isPrimaryKey?sn:sn.index(It.name),sn=ae(Mt),Ht=sn?Ht.count(sn):Ht.count();Ht.onsuccess=Fe(function(en){return Ot(en.target.result)}),Ht.onerror=tl(Xt)})}}}var Ne,Le,Ge,pt=(Le=st,Ge=_p((Ne=M).objectStoreNames),{schema:{name:Ne.name,tables:Ge.map(function(gt){return Le.objectStore(gt)}).map(function(gt){var rt=gt.keyPath,lt=gt.autoIncrement,ht=o(rt),bt={},lt={name:gt.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:rt==null,compound:ht,keyPath:rt,autoIncrement:lt,unique:!0,extractKey:Ff(rt)},indexes:_p(gt.indexNames).map(function(kt){return gt.index(kt)}).map(function(Ot){var It=Ot.name,Mt=Ot.unique,Xt=Ot.multiEntry,Ot=Ot.keyPath,Xt={name:It,compound:o(Ot),keyPath:Ot,unique:Mt,multiEntry:Xt,extractKey:Ff(Ot)};return bt[Ai(Ot)]=Xt}),getIndexByKeyPath:function(kt){return bt[Ai(kt)]}};return bt[":id"]=lt.primaryKey,rt!=null&&(bt[Ai(rt)]=lt.primaryKey),lt})},hasGetAll:0<Ge.length&&"getAll"in Le.objectStore(Ge[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),st=pt.schema,at=pt.hasGetAll,pt=st.tables.map(pe),Je={};return pt.forEach(function(gt){return Je[gt.name]=gt}),{stack:"dbcore",transaction:M.transaction.bind(M),table:function(gt){if(!Je[gt])throw new Error("Table '".concat(gt,"' not found"));return Je[gt]},MIN_KEY:-1/0,MAX_KEY:Df(z),schema:st}}function _g(M,z,te,ae){var pe=te.IDBKeyRange;return te.indexedDB,{dbcore:(ae=fd(z,pe,ae),M.dbcore.reduce(function(Ne,Le){return Le=Le.create,r(r({},Ne),Le(Ne))},ae))}}function ru(M,ae){var te=ae.db,ae=_g(M._middlewares,te,M._deps,ae);M.core=ae.dbcore,M.tables.forEach(function(pe){var Ne=pe.name;M.core.schema.tables.some(function(Le){return Le.name===Ne})&&(pe.core=M.core.table(Ne),M[Ne]instanceof M.Table&&(M[Ne].core=pe.core))})}function Cg(M,z,te,ae){te.forEach(function(pe){var Ne=ae[pe];z.forEach(function(Le){var Ge=function st(at,pt){return v(at,pt)||(at=c(at))&&st(at,pt)}(Le,pe);(!Ge||"value"in Ge&&Ge.value===void 0)&&(Le===M.Transaction.prototype||Le instanceof M.Transaction?y(Le,pe,{get:function(){return this.table(pe)},set:function(st){m(this,pe,{value:st,writable:!0,configurable:!0,enumerable:!0})}}):Le[pe]=new M.Table(pe,Ne))})})}function Cp(M,z){z.forEach(function(te){for(var ae in te)te[ae]instanceof M.Table&&delete te[ae]})}function Vb(M,z){return M._cfg.version-z._cfg.version}function kp(M,z,te,ae){var pe=M._dbSchema;te.objectStoreNames.contains("$meta")&&!pe.$meta&&(pe.$meta=Of("$meta",OS("")[0],[]),M._storeNames.push("$meta"));var Ne=M._createTransaction("readwrite",M._storeNames,pe);Ne.create(te),Ne._completion.catch(ae);var Le=Ne._reject.bind(Ne),Ge=Ae.transless||Ae;fn(function(){return Ae.trans=Ne,Ae.transless=Ge,z!==0?(ru(M,te),at=z,((st=Ne).storeNames.includes("$meta")?st.table("$meta").get("version").then(function(pt){return pt??at}):$.resolve(at)).then(function(pt){return gt=pt,rt=Ne,ht=te,bt=[],pt=(Je=M)._versions,lt=Je._dbSchema=Lf(0,Je.idbdb,ht),(pt=pt.filter(function(kt){return kt._cfg.version>=gt})).length!==0?(pt.forEach(function(kt){bt.push(function(){var It=lt,Mt=kt._cfg.dbschema;Ag(Je,It,ht),Ag(Je,Mt,ht),lt=Je._dbSchema=Mt;var Ot=Eg(It,Mt);Ot.add.forEach(function(ln){Wb(ht,ln[0],ln[1].primKey,ln[1].indexes)}),Ot.change.forEach(function(ln){if(ln.recreate)throw new _e.Upgrade("Not yet support for changing primary key");var Gt=ht.objectStore(ln.name);ln.add.forEach(function(bn){return Tg(Gt,bn)}),ln.change.forEach(function(bn){Gt.deleteIndex(bn.name),Tg(Gt,bn)}),ln.del.forEach(function(bn){return Gt.deleteIndex(bn)})});var Xt=kt._cfg.contentUpgrade;if(Xt&&kt._cfg.version>gt){ru(Je,ht),rt._memoizedTables={};var sn=N(Mt);Ot.del.forEach(function(ln){sn[ln]=It[ln]}),Cp(Je,[Je.Transaction.prototype]),Cg(Je,[Je.Transaction.prototype],a(sn),sn),rt.schema=sn;var Ht,en=Q(Xt);return en&&br(),Ot=$.follow(function(){var ln;(Ht=Xt(rt))&&en&&(ln=Mr.bind(null,null),Ht.then(ln,ln))}),Ht&&typeof Ht.then=="function"?$.resolve(Ht):Ot.then(function(){return Ht})}}),bt.push(function(It){var Mt,Ot,Xt=kt._cfg.dbschema;Mt=Xt,Ot=It,[].slice.call(Ot.db.objectStoreNames).forEach(function(sn){return Mt[sn]==null&&Ot.db.deleteObjectStore(sn)}),Cp(Je,[Je.Transaction.prototype]),Cg(Je,[Je.Transaction.prototype],Je._storeNames,Je._dbSchema),rt.schema=Je._dbSchema}),bt.push(function(It){Je.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(Je.idbdb.version/10)===kt._cfg.version?(Je.idbdb.deleteObjectStore("$meta"),delete Je._dbSchema.$meta,Je._storeNames=Je._storeNames.filter(function(Mt){return Mt!=="$meta"})):It.objectStore("$meta").put(kt._cfg.version,"version"))})}),function kt(){return bt.length?$.resolve(bt.shift()(rt.idbtrans)).then(kt):$.resolve()}().then(function(){PS(lt,ht)})):$.resolve();var Je,gt,rt,ht,bt,lt}).catch(Le)):(a(pe).forEach(function(pt){Wb(te,pt,pe[pt].primKey,pe[pt].indexes)}),ru(M,te),void $.follow(function(){return M.on.populate.fire(Ne)}).catch(Le));var st,at})}function kg(M,z){PS(M._dbSchema,z),z.db.version%10!=0||z.objectStoreNames.contains("$meta")||z.db.createObjectStore("$meta").add(Math.ceil(z.db.version/10-1),"version");var te=Lf(0,M.idbdb,z);Ag(M,M._dbSchema,z);for(var ae=0,pe=Eg(te,M._dbSchema).change;ae<pe.length;ae++){var Ne=function(Le){if(Le.change.length||Le.recreate)return console.warn("Unable to patch indexes of table ".concat(Le.name," because it has changes on the type of index or primary key.")),{value:void 0};var Ge=z.objectStore(Le.name);Le.add.forEach(function(st){Be&&console.debug("Dexie upgrade patch: Creating missing index ".concat(Le.name,".").concat(st.src)),Tg(Ge,st)})}(pe[ae]);if(typeof Ne=="object")return Ne.value}}function Eg(M,z){var te,ae={del:[],add:[],change:[]};for(te in M)z[te]||ae.del.push(te);for(te in z){var pe=M[te],Ne=z[te];if(pe){var Le={name:te,def:Ne,recreate:!1,del:[],add:[],change:[]};if(""+(pe.primKey.keyPath||"")!=""+(Ne.primKey.keyPath||"")||pe.primKey.auto!==Ne.primKey.auto)Le.recreate=!0,ae.change.push(Le);else{var Ge=pe.idxByName,st=Ne.idxByName,at=void 0;for(at in Ge)st[at]||Le.del.push(at);for(at in st){var pt=Ge[at],Je=st[at];pt?pt.src!==Je.src&&Le.change.push(Je):Le.add.push(Je)}(0<Le.del.length||0<Le.add.length||0<Le.change.length)&&ae.change.push(Le)}}else ae.add.push([te,Ne])}return ae}function Wb(M,z,te,ae){var pe=M.db.createObjectStore(z,te.keyPath?{keyPath:te.keyPath,autoIncrement:te.auto}:{autoIncrement:te.auto});return ae.forEach(function(Ne){return Tg(pe,Ne)}),pe}function PS(M,z){a(M).forEach(function(te){z.db.objectStoreNames.contains(te)||(Be&&console.debug("Dexie: Creating missing table",te),Wb(z,te,M[te].primKey,M[te].indexes))})}function Tg(M,z){M.createIndex(z.name,z.keyPath,{unique:z.unique,multiEntry:z.multi})}function Lf(M,z,te){var ae={};return w(z.objectStoreNames,0).forEach(function(pe){for(var Ne=te.objectStore(pe),Le=Nl(Sg(at=Ne.keyPath),at||"",!0,!1,!!Ne.autoIncrement,at&&typeof at!="string",!0),Ge=[],st=0;st<Ne.indexNames.length;++st){var pt=Ne.index(Ne.indexNames[st]),at=pt.keyPath,pt=Nl(pt.name,at,!!pt.unique,!!pt.multiEntry,!1,at&&typeof at!="string",!1);Ge.push(pt)}ae[pe]=Of(pe,Le,Ge)}),ae}function Ag(M,z,te){for(var ae=te.db.objectStoreNames,pe=0;pe<ae.length;++pe){var Ne=ae[pe],Le=te.objectStore(Ne);M._hasGetAll="getAll"in Le;for(var Ge=0;Ge<Le.indexNames.length;++Ge){var st=Le.indexNames[Ge],at=Le.index(st).keyPath,pt=typeof at=="string"?at:"["+w(at).join("+")+"]";!z[Ne]||(at=z[Ne].idxByName[pt])&&(at.name=st,delete z[Ne].idxByName[pt],z[Ne].idxByName[st]=at)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&i.WorkerGlobalScope&&i instanceof i.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(M._hasGetAll=!1)}function OS(M){return M.split(",").map(function(z,te){var ae=(z=z.trim()).replace(/([&*]|\+\+)/g,""),pe=/^\[/.test(ae)?ae.match(/^\[(.*)\]$/)[1].split("+"):ae;return Nl(ae,pe||null,/\&/.test(z),/\*/.test(z),/\+\+/.test(z),o(pe),te===0)})}var PA=(Rg.prototype._parseStoresSpec=function(M,z){a(M).forEach(function(te){if(M[te]!==null){var ae=OS(M[te]),pe=ae.shift();if(pe.unique=!0,pe.multi)throw new _e.Schema("Primary key cannot be multi-valued");ae.forEach(function(Ne){if(Ne.auto)throw new _e.Schema("Only primary key can be marked as autoIncrement (++)");if(!Ne.keyPath)throw new _e.Schema("Index must have a name and cannot be an empty string")}),z[te]=Of(te,pe,ae)}})},Rg.prototype.stores=function(te){var z=this.db;this._cfg.storesSource=this._cfg.storesSource?l(this._cfg.storesSource,te):te;var te=z._versions,ae={},pe={};return te.forEach(function(Ne){l(ae,Ne._cfg.storesSource),pe=Ne._cfg.dbschema={},Ne._parseStoresSpec(ae,pe)}),z._dbSchema=pe,Cp(z,[z._allTables,z,z.Transaction.prototype]),Cg(z,[z._allTables,z,z.Transaction.prototype,this._cfg.tables],a(pe),pe),z._storeNames=a(pe),this},Rg.prototype.upgrade=function(M){return this._cfg.contentUpgrade=Ie(this._cfg.contentUpgrade||We,M),this},Rg);function Rg(){}function Hb(M,z){var te=M._dbNamesDB;return te||(te=M._dbNamesDB=new Il(Xa,{addons:[],indexedDB:M,IDBKeyRange:z})).version(1).stores({dbnames:"name"}),te.table("dbnames")}function Ng(M){return M&&typeof M.databases=="function"}function Gb(M){return fn(function(){return Ae.letThrough=!0,M()})}function Kb(M){return!("from"in M)}var na=function(M,z){if(!this){var te=new na;return M&&"d"in M&&l(te,M),te}l(this,arguments.length?{d:1,from:M,to:1<arguments.length?z:M}:{d:0})};function Ep(M,z,te){var ae=Lr(z,te);if(!isNaN(ae)){if(0<ae)throw RangeError();if(Kb(M))return l(M,{from:z,to:te,d:1});var pe=M.l,ae=M.r;if(Lr(te,M.from)<0)return pe?Ep(pe,z,te):M.l={from:z,to:te,d:1,l:null,r:null},FS(M);if(0<Lr(z,M.to))return ae?Ep(ae,z,te):M.r={from:z,to:te,d:1,l:null,r:null},FS(M);Lr(z,M.from)<0&&(M.from=z,M.l=null,M.d=ae?ae.d+1:1),0<Lr(te,M.to)&&(M.to=te,M.r=null,M.d=M.l?M.l.d+1:1),te=!M.r,pe&&!M.l&&hd(M,pe),ae&&te&&hd(M,ae)}}function hd(M,z){Kb(z)||function te(ae,st){var Ne=st.from,Le=st.to,Ge=st.l,st=st.r;Ep(ae,Ne,Le),Ge&&te(ae,Ge),st&&te(ae,st)}(M,z)}function DS(M,z){var te=Ig(z),ae=te.next();if(ae.done)return!1;for(var pe=ae.value,Ne=Ig(M),Le=Ne.next(pe.from),Ge=Le.value;!ae.done&&!Le.done;){if(Lr(Ge.from,pe.to)<=0&&0<=Lr(Ge.to,pe.from))return!0;Lr(pe.from,Ge.from)<0?pe=(ae=te.next(Ge.from)).value:Ge=(Le=Ne.next(pe.from)).value}return!1}function Ig(M){var z=Kb(M)?null:{s:0,n:M};return{next:function(te){for(var ae=0<arguments.length;z;)switch(z.s){case 0:if(z.s=1,ae)for(;z.n.l&&Lr(te,z.n.from)<0;)z={up:z,n:z.n.l,s:1};else for(;z.n.l;)z={up:z,n:z.n.l,s:1};case 1:if(z.s=2,!ae||Lr(te,z.n.to)<=0)return{value:z.n,done:!1};case 2:if(z.n.r){z.s=3,z={up:z,n:z.n.r,s:0};continue}case 3:z=z.up}return{done:!0}}}}function FS(M){var z,te,ae=(((z=M.r)===null||z===void 0?void 0:z.d)||0)-(((te=M.l)===null||te===void 0?void 0:te.d)||0),pe=1<ae?"r":ae<-1?"l":"";pe&&(z=pe=="r"?"l":"r",te=r({},M),ae=M[pe],M.from=ae.from,M.to=ae.to,M[pe]=ae[pe],te[pe]=ae[z],(M[z]=te).d=Yb(te)),M.d=Yb(M)}function Yb(te){var z=te.r,te=te.l;return(z?te?Math.max(z.d,te.d):z.d:te?te.d:0)+1}function Mg(M,z){return a(z).forEach(function(te){M[te]?hd(M[te],z[te]):M[te]=function ae(pe){var Ne,Le,Ge={};for(Ne in pe)d(pe,Ne)&&(Le=pe[Ne],Ge[Ne]=!Le||typeof Le!="object"||L.has(Le.constructor)?Le:ae(Le));return Ge}(z[te])}),M}function Zb(M,z){return M.all||z.all||Object.keys(M).some(function(te){return z[te]&&DS(z[te],M[te])})}h(na.prototype,((eo={add:function(M){return hd(this,M),this},addKey:function(M){return Ep(this,M,M),this},addKeys:function(M){var z=this;return M.forEach(function(te){return Ep(z,te,te)}),this},hasKey:function(M){var z=Ig(this).next(M).value;return z&&Lr(z.from,M)<=0&&0<=Lr(z.to,M)}})[U]=function(){return Ig(this)},eo));var pd={},Xb={},Jb=!1;function jg(M){Mg(Xb,M),Jb||(Jb=!0,setTimeout(function(){Jb=!1,Qb(Xb,!(Xb={}))},0))}function Qb(M,z){z===void 0&&(z=!1);var te=new Set;if(M.all)for(var ae=0,pe=Object.values(pd);ae<pe.length;ae++)LS(Le=pe[ae],M,te,z);else for(var Ne in M){var Le,Ge=/^idb\:\/\/(.*)\/(.*)\//.exec(Ne);Ge&&(Ne=Ge[1],Ge=Ge[2],(Le=pd["idb://".concat(Ne,"/").concat(Ge)])&&LS(Le,M,te,z))}te.forEach(function(st){return st()})}function LS(M,z,te,ae){for(var pe=[],Ne=0,Le=Object.entries(M.queries.query);Ne<Le.length;Ne++){for(var Ge=Le[Ne],st=Ge[0],at=[],pt=0,Je=Ge[1];pt<Je.length;pt++){var gt=Je[pt];Zb(z,gt.obsSet)?gt.subscribers.forEach(function(lt){return te.add(lt)}):ae&&at.push(gt)}ae&&pe.push([st,at])}if(ae)for(var rt=0,ht=pe;rt<ht.length;rt++){var bt=ht[rt],st=bt[0],at=bt[1];M.queries.query[st]=at}}function OA(M){var z=M._state,te=M._deps.indexedDB;if(z.isBeingOpened||M.idbdb)return z.dbReadyPromise.then(function(){return z.dbOpenError?ar(z.dbOpenError):M});z.isBeingOpened=!0,z.dbOpenError=null,z.openComplete=!1;var ae=z.openCanceller,pe=Math.round(10*M.verno),Ne=!1;function Le(){if(z.openCanceller!==ae)throw new _e.DatabaseClosed("db.open() was cancelled")}function Ge(){return new $(function(gt,rt){if(Le(),!te)throw new _e.MissingAPI;var ht=M.name,bt=z.autoSchema||!pe?te.open(ht):te.open(ht,pe);if(!bt)throw new _e.MissingAPI;bt.onerror=tl(rt),bt.onblocked=Fe(M._fireOnBlocked),bt.onupgradeneeded=Fe(function(lt){var kt;pt=bt.transaction,z.autoSchema&&!M._options.allowEmptyDB?(bt.onerror=ud,pt.abort(),bt.result.close(),(kt=te.deleteDatabase(ht)).onsuccess=kt.onerror=Fe(function(){rt(new _e.NoSuchDatabase("Database ".concat(ht," doesnt exist")))})):(pt.onerror=tl(rt),lt=lt.oldVersion>Math.pow(2,62)?0:lt.oldVersion,Je=lt<1,M.idbdb=bt.result,Ne&&kg(M,pt),kp(M,lt/10,pt,rt))},rt),bt.onsuccess=Fe(function(){pt=null;var lt,kt,It,Mt,Ot,Xt=M.idbdb=bt.result,sn=w(Xt.objectStoreNames);if(0<sn.length)try{var Ht=Xt.transaction((Mt=sn).length===1?Mt[0]:Mt,"readonly");if(z.autoSchema)kt=Xt,It=Ht,(lt=M).verno=kt.version/10,It=lt._dbSchema=Lf(0,kt,It),lt._storeNames=w(kt.objectStoreNames,0),Cg(lt,[lt._allTables],a(It),It);else if(Ag(M,M._dbSchema,Ht),((Ot=Eg(Lf(0,(Ot=M).idbdb,Ht),Ot._dbSchema)).add.length||Ot.change.some(function(en){return en.add.length||en.change.length}))&&!Ne)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),Xt.close(),pe=Xt.version+1,Ne=!0,gt(Ge());ru(M,Ht)}catch{}fi.push(M),Xt.onversionchange=Fe(function(en){z.vcFired=!0,M.on("versionchange").fire(en)}),Xt.onclose=Fe(function(en){M.on("close").fire(en)}),Je&&(Ot=M._deps,Ht=ht,Xt=Ot.indexedDB,Ot=Ot.IDBKeyRange,Ng(Xt)||Ht===Xa||Hb(Xt,Ot).put({name:Ht}).catch(We)),gt()},rt)}).catch(function(gt){switch(gt==null?void 0:gt.name){case"UnknownError":if(0<z.PR1398_maxLoop)return z.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),Ge();break;case"VersionError":if(0<pe)return pe=0,Ge()}return $.reject(gt)})}var st,at=z.dbReadyResolve,pt=null,Je=!1;return $.race([ae,(typeof navigator>"u"?$.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(gt){function rt(){return indexedDB.databases().finally(gt)}st=setInterval(rt,100),rt()}).finally(function(){return clearInterval(st)}):Promise.resolve()).then(Ge)]).then(function(){return Le(),z.onReadyBeingFired=[],$.resolve(Gb(function(){return M.on.ready.fire(M.vip)})).then(function gt(){if(0<z.onReadyBeingFired.length){var rt=z.onReadyBeingFired.reduce(Ie,We);return z.onReadyBeingFired=[],$.resolve(Gb(function(){return rt(M.vip)})).then(gt)}})}).finally(function(){z.openCanceller===ae&&(z.onReadyBeingFired=null,z.isBeingOpened=!1)}).catch(function(gt){z.dbOpenError=gt;try{pt&&pt.abort()}catch{}return ae===z.openCanceller&&M._close(),ar(gt)}).finally(function(){z.openComplete=!0,at()}).then(function(){var gt;return Je&&(gt={},M.tables.forEach(function(rt){rt.schema.indexes.forEach(function(ht){ht.name&&(gt["idb://".concat(M.name,"/").concat(rt.name,"/").concat(ht.name)]=new na(-1/0,[[[]]]))}),gt["idb://".concat(M.name,"/").concat(rt.name,"/")]=gt["idb://".concat(M.name,"/").concat(rt.name,"/:dels")]=new na(-1/0,[[[]]])}),ta(Pf).fire(gt),Qb(gt,!0)),M})}function Tp(M){function z(Ne){return M.next(Ne)}var te=pe(z),ae=pe(function(Ne){return M.throw(Ne)});function pe(Ne){return function(st){var Ge=Ne(st),st=Ge.value;return Ge.done?st:st&&typeof st.then=="function"?st.then(te,ae):o(st)?Promise.all(st).then(te,ae):te(st)}}return pe(z)()}function su(M,z,te){for(var ae=o(M)?M.slice():[M],pe=0;pe<te;++pe)ae.push(z);return ae}var DA={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(M){return r(r({},M),{table:function(z){var te=M.table(z),ae=te.schema,pe={},Ne=[];function Le(Je,gt,rt){var ht=Ai(Je),bt=pe[ht]=pe[ht]||[],lt=Je==null?0:typeof Je=="string"?1:Je.length,kt=0<gt,kt=r(r({},rt),{name:kt?"".concat(ht,"(virtual-from:").concat(rt.name,")"):rt.name,lowLevelIndex:rt,isVirtual:kt,keyTail:gt,keyLength:lt,extractKey:Ff(Je),unique:!kt&&rt.unique});return bt.push(kt),kt.isPrimaryKey||Ne.push(kt),1<lt&&Le(lt===2?Je[0]:Je.slice(0,lt-1),gt+1,rt),bt.sort(function(It,Mt){return It.keyTail-Mt.keyTail}),kt}z=Le(ae.primaryKey.keyPath,0,ae.primaryKey),pe[":id"]=[z];for(var Ge=0,st=ae.indexes;Ge<st.length;Ge++){var at=st[Ge];Le(at.keyPath,0,at)}function pt(Je){var gt,rt=Je.query.index;return rt.isVirtual?r(r({},Je),{query:{index:rt.lowLevelIndex,range:(gt=Je.query.range,rt=rt.keyTail,{type:gt.type===1?2:gt.type,lower:su(gt.lower,gt.lowerOpen?M.MAX_KEY:M.MIN_KEY,rt),lowerOpen:!0,upper:su(gt.upper,gt.upperOpen?M.MIN_KEY:M.MAX_KEY,rt),upperOpen:!0})}}):Je}return r(r({},te),{schema:r(r({},ae),{primaryKey:z,indexes:Ne,getIndexByKeyPath:function(Je){return(Je=pe[Ai(Je)])&&Je[0]}}),count:function(Je){return te.count(pt(Je))},query:function(Je){return te.query(pt(Je))},openCursor:function(Je){var gt=Je.query.index,rt=gt.keyTail,ht=gt.isVirtual,bt=gt.keyLength;return ht?te.openCursor(pt(Je)).then(function(kt){return kt&&lt(kt)}):te.openCursor(Je);function lt(kt){return Object.create(kt,{continue:{value:function(It){It!=null?kt.continue(su(It,Je.reverse?M.MAX_KEY:M.MIN_KEY,rt)):Je.unique?kt.continue(kt.key.slice(0,bt).concat(Je.reverse?M.MIN_KEY:M.MAX_KEY,rt)):kt.continue()}},continuePrimaryKey:{value:function(It,Mt){kt.continuePrimaryKey(su(It,M.MAX_KEY,rt),Mt)}},primaryKey:{get:function(){return kt.primaryKey}},key:{get:function(){var It=kt.key;return bt===1?It[0]:It.slice(0,bt)}},value:{get:function(){return kt.value}}})}}})}})}};function Pg(M,z,te,ae){return te=te||{},ae=ae||"",a(M).forEach(function(pe){var Ne,Le,Ge;d(z,pe)?(Ne=M[pe],Le=z[pe],typeof Ne=="object"&&typeof Le=="object"&&Ne&&Le?(Ge=K(Ne))!==K(Le)?te[ae+pe]=z[pe]:Ge==="Object"?Pg(Ne,Le,te,ae+pe+"."):Ne!==Le&&(te[ae+pe]=z[pe]):Ne!==Le&&(te[ae+pe]=z[pe])):te[ae+pe]=void 0}),a(z).forEach(function(pe){d(M,pe)||(te[ae+pe]=z[pe])}),te}function Og(M,z){return z.type==="delete"?z.keys:z.keys||z.values.map(M.extractKey)}var BS={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(M){return r(r({},M),{table:function(z){var te=M.table(z),ae=te.schema.primaryKey;return r(r({},te),{mutate:function(pe){var Ne=Ae.trans,Le=Ne.table(z).hook,Ge=Le.deleting,st=Le.creating,at=Le.updating;switch(pe.type){case"add":if(st.fire===We)break;return Ne._promise("readwrite",function(){return pt(pe)},!0);case"put":if(st.fire===We&&at.fire===We)break;return Ne._promise("readwrite",function(){return pt(pe)},!0);case"delete":if(Ge.fire===We)break;return Ne._promise("readwrite",function(){return pt(pe)},!0);case"deleteRange":if(Ge.fire===We)break;return Ne._promise("readwrite",function(){return function Je(gt,rt,ht){return te.query({trans:gt,values:!1,query:{index:ae,range:rt},limit:ht}).then(function(bt){var lt=bt.result;return pt({type:"delete",keys:lt,trans:gt}).then(function(kt){return 0<kt.numFailures?Promise.reject(kt.failures[0]):lt.length<ht?{failures:[],numFailures:0,lastResult:void 0}:Je(gt,r(r({},rt),{lower:lt[lt.length-1],lowerOpen:!0}),ht)})})}(pe.trans,pe.range,1e4)},!0)}return te.mutate(pe);function pt(Je){var gt,rt,ht,bt=Ae.trans,lt=Je.keys||Og(ae,Je);if(!lt)throw new Error("Keys missing");return(Je=Je.type==="add"||Je.type==="put"?r(r({},Je),{keys:lt}):r({},Je)).type!=="delete"&&(Je.values=s([],Je.values)),Je.keys&&(Je.keys=s([],Je.keys)),gt=te,ht=lt,((rt=Je).type==="add"?Promise.resolve([]):gt.getMany({trans:rt.trans,keys:ht,cache:"immutable"})).then(function(kt){var It=lt.map(function(Mt,Ot){var Xt,sn,Ht,en=kt[Ot],ln={onerror:null,onsuccess:null};return Je.type==="delete"?Ge.fire.call(ln,Mt,en,bt):Je.type==="add"||en===void 0?(Xt=st.fire.call(ln,Mt,Je.values[Ot],bt),Mt==null&&Xt!=null&&(Je.keys[Ot]=Mt=Xt,ae.outbound||A(Je.values[Ot],ae.keyPath,Mt))):(Xt=Pg(en,Je.values[Ot]),(sn=at.fire.call(ln,Xt,Mt,en,bt))&&(Ht=Je.values[Ot],Object.keys(sn).forEach(function(Gt){d(Ht,Gt)?Ht[Gt]=sn[Gt]:A(Ht,Gt,sn[Gt])}))),ln});return te.mutate(Je).then(function(Mt){for(var Ot=Mt.failures,Xt=Mt.results,sn=Mt.numFailures,Mt=Mt.lastResult,Ht=0;Ht<lt.length;++Ht){var en=(Xt||lt)[Ht],ln=It[Ht];en==null?ln.onerror&&ln.onerror(Ot[Ht]):ln.onsuccess&&ln.onsuccess(Je.type==="put"&&kt[Ht]?Je.values[Ht]:en)}return{failures:Ot,results:Xt,numFailures:sn,lastResult:Mt}}).catch(function(Mt){return It.forEach(function(Ot){return Ot.onerror&&Ot.onerror(Mt)}),Promise.reject(Mt)})})}}})}})}};function ev(M,z,te){try{if(!z||z.keys.length<M.length)return null;for(var ae=[],pe=0,Ne=0;pe<z.keys.length&&Ne<M.length;++pe)Lr(z.keys[pe],M[Ne])===0&&(ae.push(te?H(z.values[pe]):z.values[pe]),++Ne);return ae.length===M.length?ae:null}catch{return null}}var $S={stack:"dbcore",level:-1,create:function(M){return{table:function(z){var te=M.table(z);return r(r({},te),{getMany:function(ae){if(!ae.cache)return te.getMany(ae);var pe=ev(ae.keys,ae.trans._cache,ae.cache==="clone");return pe?$.resolve(pe):te.getMany(ae).then(function(Ne){return ae.trans._cache={keys:ae.keys,values:ae.cache==="clone"?H(Ne):Ne},Ne})},mutate:function(ae){return ae.type!=="add"&&(ae.trans._cache=null),te.mutate(ae)}})}}}};function md(M,z){return M.trans.mode==="readonly"&&!!M.subscr&&!M.trans.explicit&&M.trans.db._options.cache!=="disabled"&&!z.schema.primaryKey.outbound}function zS(M,z){switch(M){case"query":return z.values&&!z.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var FA={stack:"dbcore",level:0,name:"Observability",create:function(M){var z=M.schema.name,te=new na(M.MIN_KEY,M.MAX_KEY);return r(r({},M),{transaction:function(ae,pe,Ne){if(Ae.subscr&&pe!=="readonly")throw new _e.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(Ae.querier));return M.transaction(ae,pe,Ne)},table:function(ae){var pe=M.table(ae),Ne=pe.schema,Le=Ne.primaryKey,Je=Ne.indexes,Ge=Le.extractKey,st=Le.outbound,at=Le.autoIncrement&&Je.filter(function(rt){return rt.compound&&rt.keyPath.includes(Le.keyPath)}),pt=r(r({},pe),{mutate:function(rt){function ht(Gt){return Gt="idb://".concat(z,"/").concat(ae,"/").concat(Gt),Mt[Gt]||(Mt[Gt]=new na)}var bt,lt,kt,It=rt.trans,Mt=rt.mutatedParts||(rt.mutatedParts={}),Ot=ht(""),Xt=ht(":dels"),sn=rt.type,ln=rt.type==="deleteRange"?[rt.range]:rt.type==="delete"?[rt.keys]:rt.values.length<50?[Og(Le,rt).filter(function(Gt){return Gt}),rt.values]:[],Ht=ln[0],en=ln[1],ln=rt.trans._cache;return o(Ht)?(Ot.addKeys(Ht),(ln=sn==="delete"||Ht.length===en.length?ev(Ht,ln):null)||Xt.addKeys(Ht),(ln||en)&&(bt=ht,lt=ln,kt=en,Ne.indexes.forEach(function(Gt){var bn=bt(Gt.name||"");function qn(mr){return mr!=null?Gt.extractKey(mr):null}function Yn(mr){return Gt.multiEntry&&o(mr)?mr.forEach(function(va){return bn.addKey(va)}):bn.addKey(mr)}(lt||kt).forEach(function(mr,hi){var or=lt&&qn(lt[hi]),hi=kt&&qn(kt[hi]);Lr(or,hi)!==0&&(or!=null&&Yn(or),hi!=null&&Yn(hi))})}))):Ht?(en={from:(en=Ht.lower)!==null&&en!==void 0?en:M.MIN_KEY,to:(en=Ht.upper)!==null&&en!==void 0?en:M.MAX_KEY},Xt.add(en),Ot.add(en)):(Ot.add(te),Xt.add(te),Ne.indexes.forEach(function(Gt){return ht(Gt.name).add(te)})),pe.mutate(rt).then(function(Gt){return!Ht||rt.type!=="add"&&rt.type!=="put"||(Ot.addKeys(Gt.results),at&&at.forEach(function(bn){for(var qn=rt.values.map(function(or){return bn.extractKey(or)}),Yn=bn.keyPath.findIndex(function(or){return or===Le.keyPath}),mr=0,va=Gt.results.length;mr<va;++mr)qn[mr][Yn]=Gt.results[mr];ht(bn.name).addKeys(qn)})),It.mutatedParts=Mg(It.mutatedParts||{},Mt),Gt})}}),Je=function(ht){var bt=ht.query,ht=bt.index,bt=bt.range;return[ht,new na((ht=bt.lower)!==null&&ht!==void 0?ht:M.MIN_KEY,(bt=bt.upper)!==null&&bt!==void 0?bt:M.MAX_KEY)]},gt={get:function(rt){return[Le,new na(rt.key)]},getMany:function(rt){return[Le,new na().addKeys(rt.keys)]},count:Je,query:Je,openCursor:Je};return a(gt).forEach(function(rt){pt[rt]=function(ht){var bt=Ae.subscr,lt=!!bt,kt=md(Ae,pe)&&zS(rt,ht)?ht.obsSet={}:bt;if(lt){var It=function(en){return en="idb://".concat(z,"/").concat(ae,"/").concat(en),kt[en]||(kt[en]=new na)},Mt=It(""),Ot=It(":dels"),bt=gt[rt](ht),lt=bt[0],bt=bt[1];if((rt==="query"&&lt.isPrimaryKey&&!ht.values?Ot:It(lt.name||"")).add(bt),!lt.isPrimaryKey){if(rt!=="count"){var Xt=rt==="query"&&st&&ht.values&&pe.query(r(r({},ht),{values:!1}));return pe[rt].apply(this,arguments).then(function(en){if(rt==="query"){if(st&&ht.values)return Xt.then(function(qn){return qn=qn.result,Mt.addKeys(qn),en});var ln=ht.values?en.result.map(Ge):en.result;(ht.values?Mt:Ot).addKeys(ln)}else if(rt==="openCursor"){var Gt=en,bn=ht.values;return Gt&&Object.create(Gt,{key:{get:function(){return Ot.addKey(Gt.primaryKey),Gt.key}},primaryKey:{get:function(){var qn=Gt.primaryKey;return Ot.addKey(qn),qn}},value:{get:function(){return bn&&Mt.addKey(Gt.primaryKey),Gt.value}}})}return en})}Ot.add(te)}}return pe[rt].apply(this,arguments)}}),pt}})}};function US(M,z,te){if(te.numFailures===0)return z;if(z.type==="deleteRange")return null;var ae=z.keys?z.keys.length:"values"in z&&z.values?z.values.length:1;return te.numFailures===ae?null:(z=r({},z),o(z.keys)&&(z.keys=z.keys.filter(function(pe,Ne){return!(Ne in te.failures)})),"values"in z&&o(z.values)&&(z.values=z.values.filter(function(pe,Ne){return!(Ne in te.failures)})),z)}function Dg(M,z){return te=M,((ae=z).lower===void 0||(ae.lowerOpen?0<Lr(te,ae.lower):0<=Lr(te,ae.lower)))&&(M=M,(z=z).upper===void 0||(z.upperOpen?Lr(M,z.upper)<0:Lr(M,z.upper)<=0));var te,ae}function tv(M,z,gt,ae,pe,Ne){if(!gt||gt.length===0)return M;var Le=z.query.index,Ge=Le.multiEntry,st=z.query.range,at=ae.schema.primaryKey.extractKey,pt=Le.extractKey,Je=(Le.lowLevelIndex||Le).extractKey,gt=gt.reduce(function(rt,ht){var bt=rt,lt=[];if(ht.type==="add"||ht.type==="put")for(var kt=new na,It=ht.values.length-1;0<=It;--It){var Mt,Ot=ht.values[It],Xt=at(Ot);kt.hasKey(Xt)||(Mt=pt(Ot),(Ge&&o(Mt)?Mt.some(function(Gt){return Dg(Gt,st)}):Dg(Mt,st))&&(kt.addKey(Xt),lt.push(Ot)))}switch(ht.type){case"add":var sn=new na().addKeys(z.values?rt.map(function(bn){return at(bn)}):rt),bt=rt.concat(z.values?lt.filter(function(bn){return bn=at(bn),!sn.hasKey(bn)&&(sn.addKey(bn),!0)}):lt.map(function(bn){return at(bn)}).filter(function(bn){return!sn.hasKey(bn)&&(sn.addKey(bn),!0)}));break;case"put":var Ht=new na().addKeys(ht.values.map(function(bn){return at(bn)}));bt=rt.filter(function(bn){return!Ht.hasKey(z.values?at(bn):bn)}).concat(z.values?lt:lt.map(function(bn){return at(bn)}));break;case"delete":var en=new na().addKeys(ht.keys);bt=rt.filter(function(bn){return!en.hasKey(z.values?at(bn):bn)});break;case"deleteRange":var ln=ht.range;bt=rt.filter(function(bn){return!Dg(at(bn),ln)})}return bt},M);return gt===M?M:(gt.sort(function(rt,ht){return Lr(Je(rt),Je(ht))||Lr(at(rt),at(ht))}),z.limit&&z.limit<1/0&&(gt.length>z.limit?gt.length=z.limit:M.length===z.limit&&gt.length<z.limit&&(pe.dirty=!0)),Ne?Object.freeze(gt):gt)}function Bf(M,z){return Lr(M.lower,z.lower)===0&&Lr(M.upper,z.upper)===0&&!!M.lowerOpen==!!z.lowerOpen&&!!M.upperOpen==!!z.upperOpen}function Ap(M,z){return function(te,ae,pe,Ne){if(te===void 0)return ae!==void 0?-1:0;if(ae===void 0)return 1;if((ae=Lr(te,ae))===0){if(pe&&Ne)return 0;if(pe)return 1;if(Ne)return-1}return ae}(M.lower,z.lower,M.lowerOpen,z.lowerOpen)<=0&&0<=function(te,ae,pe,Ne){if(te===void 0)return ae!==void 0?1:0;if(ae===void 0)return-1;if((ae=Lr(te,ae))===0){if(pe&&Ne)return 0;if(pe)return-1;if(Ne)return 1}return ae}(M.upper,z.upper,M.upperOpen,z.upperOpen)}function LA(M,z,te,ae){M.subscribers.add(te),ae.addEventListener("abort",function(){var pe,Ne;M.subscribers.delete(te),M.subscribers.size===0&&(pe=M,Ne=z,setTimeout(function(){pe.subscribers.size===0&&B(Ne,pe)},3e3))})}var Fg={stack:"dbcore",level:0,name:"Cache",create:function(M){var z=M.schema.name;return r(r({},M),{transaction:function(te,ae,pe){var Ne,Le,Ge=M.transaction(te,ae,pe);return ae==="readwrite"&&(Le=(Ne=new AbortController).signal,pe=function(st){return function(){if(Ne.abort(),ae==="readwrite"){for(var at=new Set,pt=0,Je=te;pt<Je.length;pt++){var gt=Je[pt],rt=pd["idb://".concat(z,"/").concat(gt)];if(rt){var ht=M.table(gt),bt=rt.optimisticOps.filter(function(bn){return bn.trans===Ge});if(Ge._explicit&&st&&Ge.mutatedParts)for(var lt=0,kt=Object.values(rt.queries.query);lt<kt.length;lt++)for(var It=0,Mt=(sn=kt[lt]).slice();It<Mt.length;It++)Zb((Ht=Mt[It]).obsSet,Ge.mutatedParts)&&(B(sn,Ht),Ht.subscribers.forEach(function(bn){return at.add(bn)}));else if(0<bt.length){rt.optimisticOps=rt.optimisticOps.filter(function(bn){return bn.trans!==Ge});for(var Ot=0,Xt=Object.values(rt.queries.query);Ot<Xt.length;Ot++)for(var sn,Ht,en,ln=0,Gt=(sn=Xt[Ot]).slice();ln<Gt.length;ln++)(Ht=Gt[ln]).res!=null&&Ge.mutatedParts&&(st&&!Ht.dirty?(en=Object.isFrozen(Ht.res),en=tv(Ht.res,Ht.req,bt,ht,Ht,en),Ht.dirty?(B(sn,Ht),Ht.subscribers.forEach(function(bn){return at.add(bn)})):en!==Ht.res&&(Ht.res=en,Ht.promise=$.resolve({result:en}))):(Ht.dirty&&B(sn,Ht),Ht.subscribers.forEach(function(bn){return at.add(bn)})))}}}at.forEach(function(bn){return bn()})}}},Ge.addEventListener("abort",pe(!1),{signal:Le}),Ge.addEventListener("error",pe(!1),{signal:Le}),Ge.addEventListener("complete",pe(!0),{signal:Le})),Ge},table:function(te){var ae=M.table(te),pe=ae.schema.primaryKey;return r(r({},ae),{mutate:function(Ne){var Le=Ae.trans;if(pe.outbound||Le.db._options.cache==="disabled"||Le.explicit||Le.idbtrans.mode!=="readwrite")return ae.mutate(Ne);var Ge=pd["idb://".concat(z,"/").concat(te)];return Ge?(Le=ae.mutate(Ne),Ne.type!=="add"&&Ne.type!=="put"||!(50<=Ne.values.length||Og(pe,Ne).some(function(st){return st==null}))?(Ge.optimisticOps.push(Ne),Ne.mutatedParts&&jg(Ne.mutatedParts),Le.then(function(st){0<st.numFailures&&(B(Ge.optimisticOps,Ne),(st=US(0,Ne,st))&&Ge.optimisticOps.push(st),Ne.mutatedParts&&jg(Ne.mutatedParts))}),Le.catch(function(){B(Ge.optimisticOps,Ne),Ne.mutatedParts&&jg(Ne.mutatedParts)})):Le.then(function(st){var at=US(0,r(r({},Ne),{values:Ne.values.map(function(pt,Je){var gt;return st.failures[Je]?pt:(pt=(gt=pe.keyPath)!==null&&gt!==void 0&&gt.includes(".")?H(pt):r({},pt),A(pt,pe.keyPath,st.results[Je]),pt)})}),st);Ge.optimisticOps.push(at),queueMicrotask(function(){return Ne.mutatedParts&&jg(Ne.mutatedParts)})}),Le):ae.mutate(Ne)},query:function(Ne){if(!md(Ae,ae)||!zS("query",Ne))return ae.query(Ne);var Le=((at=Ae.trans)===null||at===void 0?void 0:at.db._options.cache)==="immutable",Je=Ae,Ge=Je.requery,st=Je.signal,at=function(ht,bt,lt,kt){var It=pd["idb://".concat(ht,"/").concat(bt)];if(!It)return[];if(!(bt=It.queries[lt]))return[null,!1,It,null];var Mt=bt[(kt.query?kt.query.index.name:null)||""];if(!Mt)return[null,!1,It,null];switch(lt){case"query":var Ot=Mt.find(function(Xt){return Xt.req.limit===kt.limit&&Xt.req.values===kt.values&&Bf(Xt.req.query.range,kt.query.range)});return Ot?[Ot,!0,It,Mt]:[Mt.find(function(Xt){return("limit"in Xt.req?Xt.req.limit:1/0)>=kt.limit&&(!kt.values||Xt.req.values)&&Ap(Xt.req.query.range,kt.query.range)}),!1,It,Mt];case"count":return Ot=Mt.find(function(Xt){return Bf(Xt.req.query.range,kt.query.range)}),[Ot,!!Ot,It,Mt]}}(z,te,"query",Ne),pt=at[0],Je=at[1],gt=at[2],rt=at[3];return pt&&Je?pt.obsSet=Ne.obsSet:(Je=ae.query(Ne).then(function(ht){var bt=ht.result;if(pt&&(pt.res=bt),Le){for(var lt=0,kt=bt.length;lt<kt;++lt)Object.freeze(bt[lt]);Object.freeze(bt)}else ht.result=H(bt);return ht}).catch(function(ht){return rt&&pt&&B(rt,pt),Promise.reject(ht)}),pt={obsSet:Ne.obsSet,promise:Je,subscribers:new Set,type:"query",req:Ne,dirty:!1},rt?rt.push(pt):(rt=[pt],(gt=gt||(pd["idb://".concat(z,"/").concat(te)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[Ne.query.index.name||""]=rt)),LA(pt,rt,Ge,st),pt.promise.then(function(ht){return{result:tv(ht.result,Ne,gt==null?void 0:gt.optimisticOps,ae,pt,Le)}})}})}})}};function Rp(M,z){return new Proxy(M,{get:function(te,ae,pe){return ae==="db"?z:Reflect.get(te,ae,pe)}})}var Il=($s.prototype.version=function(M){if(isNaN(M)||M<.1)throw new _e.Type("Given version is not a positive number");if(M=Math.round(10*M)/10,this.idbdb||this._state.isBeingOpened)throw new _e.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,M);var z=this._versions,te=z.filter(function(ae){return ae._cfg.version===M})[0];return te||(te=new this.Version(M),z.push(te),z.sort(Vb),te.stores({}),this._state.autoSchema=!1,te)},$s.prototype._whenReady=function(M){var z=this;return this.idbdb&&(this._state.openComplete||Ae.letThrough||this._vip)?M():new $(function(te,ae){if(z._state.openComplete)return ae(new _e.DatabaseClosed(z._state.dbOpenError));if(!z._state.isBeingOpened){if(!z._state.autoOpen)return void ae(new _e.DatabaseClosed);z.open().catch(We)}z._state.dbReadyPromise.then(te,ae)}).then(M)},$s.prototype.use=function(M){var z=M.stack,te=M.create,ae=M.level,pe=M.name;return pe&&this.unuse({stack:z,name:pe}),M=this._middlewares[z]||(this._middlewares[z]=[]),M.push({stack:z,create:te,level:ae??10,name:pe}),M.sort(function(Ne,Le){return Ne.level-Le.level}),this},$s.prototype.unuse=function(M){var z=M.stack,te=M.name,ae=M.create;return z&&this._middlewares[z]&&(this._middlewares[z]=this._middlewares[z].filter(function(pe){return ae?pe.create!==ae:!!te&&pe.name!==te})),this},$s.prototype.open=function(){var M=this;return nt(ge,function(){return OA(M)})},$s.prototype._close=function(){var M=this._state,z=fi.indexOf(this);if(0<=z&&fi.splice(z,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}M.isBeingOpened||(M.dbReadyPromise=new $(function(te){M.dbReadyResolve=te}),M.openCanceller=new $(function(te,ae){M.cancelOpen=ae}))},$s.prototype.close=function(te){var z=(te===void 0?{disableAutoOpen:!0}:te).disableAutoOpen,te=this._state;z?(te.isBeingOpened&&te.cancelOpen(new _e.DatabaseClosed),this._close(),te.autoOpen=!1,te.dbOpenError=new _e.DatabaseClosed):(this._close(),te.autoOpen=this._options.autoOpen||te.isBeingOpened,te.openComplete=!1,te.dbOpenError=null)},$s.prototype.delete=function(M){var z=this;M===void 0&&(M={disableAutoOpen:!0});var te=0<arguments.length&&typeof arguments[0]!="object",ae=this._state;return new $(function(pe,Ne){function Le(){z.close(M);var Ge=z._deps.indexedDB.deleteDatabase(z.name);Ge.onsuccess=Fe(function(){var st,at,pt;st=z._deps,at=z.name,pt=st.indexedDB,st=st.IDBKeyRange,Ng(pt)||at===Xa||Hb(pt,st).delete(at).catch(We),pe()}),Ge.onerror=tl(Ne),Ge.onblocked=z._fireOnBlocked}if(te)throw new _e.InvalidArgument("Invalid closeOptions argument to db.delete()");ae.isBeingOpened?ae.dbReadyPromise.then(Le):Le()})},$s.prototype.backendDB=function(){return this.idbdb},$s.prototype.isOpen=function(){return this.idbdb!==null},$s.prototype.hasBeenClosed=function(){var M=this._state.dbOpenError;return M&&M.name==="DatabaseClosed"},$s.prototype.hasFailed=function(){return this._state.dbOpenError!==null},$s.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty($s.prototype,"tables",{get:function(){var M=this;return a(this._allTables).map(function(z){return M._allTables[z]})},enumerable:!1,configurable:!0}),$s.prototype.transaction=function(){var M=(function(z,te,ae){var pe=arguments.length;if(pe<2)throw new _e.InvalidArgument("Too few arguments");for(var Ne=new Array(pe-1);--pe;)Ne[pe-1]=arguments[pe];return ae=Ne.pop(),[z,j(Ne),ae]}).apply(this,arguments);return this._transaction.apply(this,M)},$s.prototype._transaction=function(M,z,te){var ae=this,pe=Ae.trans;pe&&pe.db===this&&M.indexOf("!")===-1||(pe=null);var Ne,Le,Ge=M.indexOf("?")!==-1;M=M.replace("!","").replace("?","");try{if(Le=z.map(function(at){if(at=at instanceof ae.Table?at.name:at,typeof at!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return at}),M=="r"||M===ba)Ne=ba;else{if(M!="rw"&&M!=Gs)throw new _e.InvalidArgument("Invalid transaction mode: "+M);Ne=Gs}if(pe){if(pe.mode===ba&&Ne===Gs){if(!Ge)throw new _e.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");pe=null}pe&&Le.forEach(function(at){if(pe&&pe.storeNames.indexOf(at)===-1){if(!Ge)throw new _e.SubTransaction("Table "+at+" not included in parent transaction.");pe=null}}),Ge&&pe&&!pe.active&&(pe=null)}}catch(at){return pe?pe._promise(null,function(pt,Je){Je(at)}):ar(at)}var st=(function at(pt,Je,gt,rt,ht){return $.resolve().then(function(){var bt=Ae.transless||Ae,lt=pt._createTransaction(Je,gt,pt._dbSchema,rt);if(lt.explicit=!0,bt={trans:lt,transless:bt},rt)lt.idbtrans=rt.idbtrans;else try{lt.create(),lt.idbtrans._explicit=!0,pt._state.PR1398_maxLoop=3}catch(Mt){return Mt.name===je.InvalidState&&pt.isOpen()&&0<--pt._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),pt.close({disableAutoOpen:!1}),pt.open().then(function(){return at(pt,Je,gt,null,ht)})):ar(Mt)}var kt,It=Q(ht);return It&&br(),bt=$.follow(function(){var Mt;(kt=ht.call(lt,lt))&&(It?(Mt=Mr.bind(null,null),kt.then(Mt,Mt)):typeof kt.next=="function"&&typeof kt.throw=="function"&&(kt=Tp(kt)))},bt),(kt&&typeof kt.then=="function"?$.resolve(kt).then(function(Mt){return lt.active?Mt:ar(new _e.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):bt.then(function(){return kt})).then(function(Mt){return rt&&lt._resolve(),lt._completion.then(function(){return Mt})}).catch(function(Mt){return lt._reject(Mt),ar(Mt)})})}).bind(null,this,Ne,Le,pe,te);return pe?pe._promise(Ne,st,"lock"):Ae.trans?nt(Ae.transless,function(){return ae._whenReady(st)}):this._whenReady(st)},$s.prototype.table=function(M){if(!d(this._allTables,M))throw new _e.InvalidTable("Table ".concat(M," does not exist"));return this._allTables[M]},$s);function $s(M,z){var te=this;this._middlewares={},this.verno=0;var ae=$s.dependencies;this._options=z=r({addons:$s.addons,autoOpen:!0,indexedDB:ae.indexedDB,IDBKeyRange:ae.IDBKeyRange,cache:"cloned"},z),this._deps={indexedDB:z.indexedDB,IDBKeyRange:z.IDBKeyRange},ae=z.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var pe,Ne,Le,Ge,st,at={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:We,dbReadyPromise:null,cancelOpen:We,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:z.autoOpen};at.dbReadyPromise=new $(function(Je){at.dbReadyResolve=Je}),at.openCanceller=new $(function(Je,gt){at.cancelOpen=gt}),this._state=at,this.name=M,this.on=nu(this,"populate","blocked","versionchange","close",{ready:[Ie,We]}),this.on.ready.subscribe=_(this.on.ready.subscribe,function(Je){return function(gt,rt){$s.vip(function(){var ht,bt=te._state;bt.openComplete?(bt.dbOpenError||$.resolve().then(gt),rt&&Je(gt)):bt.onReadyBeingFired?(bt.onReadyBeingFired.push(gt),rt&&Je(gt)):(Je(gt),ht=te,rt||Je(function lt(){ht.on.ready.unsubscribe(gt),ht.on.ready.unsubscribe(lt)}))})}}),this.Collection=(pe=this,Af(Mf.prototype,function(kt,lt){this.db=pe;var rt=Al,ht=null;if(lt)try{rt=lt()}catch(It){ht=It}var bt=kt._ctx,lt=bt.table,kt=lt.hook.reading.fire;this._ctx={table:lt,index:bt.index,isPrimKey:!bt.index||lt.schema.primKey.keyPath&&bt.index===lt.schema.primKey.name,range:rt,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:ht,or:bt.or,valueMapper:kt!==Pe?kt:null}})),this.Table=(Ne=this,Af(Lb.prototype,function(Je,gt,rt){this.db=Ne,this._tx=rt,this.name=Je,this.schema=gt,this.hook=Ne._allTables[Je]?Ne._allTables[Je].hook:nu(null,{creating:[Me,We],reading:[Y,Pe],updating:[oe,We],deleting:[ue,We]})})),this.Transaction=(Le=this,Af(qb.prototype,function(Je,gt,rt,ht,bt){var lt=this;this.db=Le,this.mode=Je,this.storeNames=gt,this.schema=rt,this.chromeTransactionDurability=ht,this.idbtrans=null,this.on=nu(this,"complete","error","abort"),this.parent=bt||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new $(function(kt,It){lt._resolve=kt,lt._reject=It}),this._completion.then(function(){lt.active=!1,lt.on.complete.fire()},function(kt){var It=lt.active;return lt.active=!1,lt.on.error.fire(kt),lt.parent?lt.parent._reject(kt):It&&lt.idbtrans&&lt.idbtrans.abort(),ar(kt)})})),this.Version=(Ge=this,Af(PA.prototype,function(Je){this.db=Ge,this._cfg={version:Je,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(st=this,Af(cd.prototype,function(Je,gt,rt){if(this.db=st,this._ctx={table:Je,index:gt===":id"?null:gt,or:rt},this._cmp=this._ascending=Lr,this._descending=function(ht,bt){return Lr(bt,ht)},this._max=function(ht,bt){return 0<Lr(ht,bt)?ht:bt},this._min=function(ht,bt){return Lr(ht,bt)<0?ht:bt},this._IDBKeyRange=st._deps.IDBKeyRange,!this._IDBKeyRange)throw new _e.MissingAPI})),this.on("versionchange",function(Je){0<Je.newVersion?console.warn("Another connection wants to upgrade database '".concat(te.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(te.name,"'. Closing db now to resume the delete request.")),te.close({disableAutoOpen:!1})}),this.on("blocked",function(Je){!Je.newVersion||Je.newVersion<Je.oldVersion?console.warn("Dexie.delete('".concat(te.name,"') was blocked")):console.warn("Upgrade '".concat(te.name,"' blocked by other connection holding version ").concat(Je.oldVersion/10))}),this._maxKey=Df(z.IDBKeyRange),this._createTransaction=function(Je,gt,rt,ht){return new te.Transaction(Je,gt,rt,te._options.chromeTransactionDurability,ht)},this._fireOnBlocked=function(Je){te.on("blocked").fire(Je),fi.filter(function(gt){return gt.name===te.name&&gt!==te&&!gt._state.vcFired}).map(function(gt){return gt.on("versionchange").fire(Je)})},this.use($S),this.use(Fg),this.use(FA),this.use(DA),this.use(BS);var pt=new Proxy(this,{get:function(Je,gt,rt){if(gt==="_vip")return!0;if(gt==="table")return function(bt){return Rp(te.table(bt),pt)};var ht=Reflect.get(Je,gt,rt);return ht instanceof Lb?Rp(ht,pt):gt==="tables"?ht.map(function(bt){return Rp(bt,pt)}):gt==="_createTransaction"?function(){return Rp(ht.apply(this,arguments),pt)}:ht}});this.vip=pt,ae.forEach(function(Je){return Je(te)})}var $f,eo=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",qS=(Lg.prototype.subscribe=function(M,z,te){return this._subscribe(M&&typeof M!="function"?M:{next:M,error:z,complete:te})},Lg.prototype[eo]=function(){return this},Lg);function Lg(M){this._subscribe=M}try{$f={indexedDB:i.indexedDB||i.mozIndexedDB||i.webkitIndexedDB||i.msIndexedDB,IDBKeyRange:i.IDBKeyRange||i.webkitIDBKeyRange}}catch{$f={indexedDB:null,IDBKeyRange:null}}function VS(M){var z,te=!1,ae=new qS(function(pe){var Ne=Q(M),Le,Ge=!1,st={},at={},pt={get closed(){return Ge},unsubscribe:function(){Ge||(Ge=!0,Le&&Le.abort(),Je&&ta.storagemutated.unsubscribe(rt))}};pe.start&&pe.start(pt);var Je=!1,gt=function(){return yn(ht)},rt=function(bt){Mg(st,bt),Zb(at,st)&&gt()},ht=function(){var bt,lt,kt;!Ge&&$f.indexedDB&&(st={},bt={},Le&&Le.abort(),Le=new AbortController,kt=function(It){var Mt=Z();try{Ne&&br();var Ot=fn(M,It);return Ot=Ne?Ot.finally(Mr):Ot}finally{Mt&&G()}}(lt={subscr:bt,signal:Le.signal,requery:gt,querier:M,trans:null}),Promise.resolve(kt).then(function(It){te=!0,z=It,Ge||lt.signal.aborted||(st={},function(Mt){for(var Ot in Mt)if(d(Mt,Ot))return;return 1}(at=bt)||Je||(ta(Pf,rt),Je=!0),yn(function(){return!Ge&&pe.next&&pe.next(It)}))},function(It){te=!1,["DatabaseClosedError","AbortError"].includes(It==null?void 0:It.name)||Ge||yn(function(){Ge||pe.error&&pe.error(It)})}))};return setTimeout(gt,0),pt});return ae.hasValue=function(){return te},ae.getValue=function(){return z},ae}var gd=Il;function nv(M){var z=iu;try{iu=!0,ta.storagemutated.fire(M),Qb(M,!0)}finally{iu=z}}h(gd,r(r({},Qe),{delete:function(M){return new gd(M,{addons:[]}).delete()},exists:function(M){return new gd(M,{addons:[]}).open().then(function(z){return z.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(M){try{return z=gd.dependencies,te=z.indexedDB,z=z.IDBKeyRange,(Ng(te)?Promise.resolve(te.databases()).then(function(ae){return ae.map(function(pe){return pe.name}).filter(function(pe){return pe!==Xa})}):Hb(te,z).toCollection().primaryKeys()).then(M)}catch{return ar(new _e.MissingAPI)}var z,te},defineClass:function(){return function(M){l(this,M)}},ignoreTransaction:function(M){return Ae.trans?nt(Ae.transless,M):M()},vip:Gb,async:function(M){return function(){try{var z=Tp(M.apply(this,arguments));return z&&typeof z.then=="function"?z:$.resolve(z)}catch(te){return ar(te)}}},spawn:function(M,z,te){try{var ae=Tp(M.apply(te,z||[]));return ae&&typeof ae.then=="function"?ae:$.resolve(ae)}catch(pe){return ar(pe)}},currentTransaction:{get:function(){return Ae.trans||null}},waitFor:function(M,z){return z=$.resolve(typeof M=="function"?gd.ignoreTransaction(M):M).timeout(z||6e4),Ae.trans?Ae.trans.waitFor(z):z},Promise:$,debug:{get:function(){return Be},set:function(M){Re(M)}},derive:b,extend:l,props:h,override:_,Events:nu,on:ta,liveQuery:VS,extendObservabilitySet:Mg,getByKeyPath:T,setByKeyPath:A,delByKeyPath:function(M,z){typeof z=="string"?A(M,z,void 0):"length"in z&&[].map.call(z,function(te){A(M,te,void 0)})},shallowClone:N,deepClone:H,getObjectDiff:Pg,cmp:Lr,asap:C,minKey:-1/0,addons:[],connections:fi,errnames:je,dependencies:$f,cache:pd,semVer:"4.0.11",version:"4.0.11".split(".").map(function(M){return parseInt(M)}).reduce(function(M,z,te){return M+z/Math.pow(10,2*te)})})),gd.maxKey=Df(gd.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(ta(Pf,function(M){iu||(M=new CustomEvent(dd,{detail:M}),iu=!0,dispatchEvent(M),iu=!1)}),addEventListener(dd,function(M){M=M.detail,iu||nv(M)}));var zf,iu=!1,ja=function(){};return typeof BroadcastChannel<"u"&&((ja=function(){(zf=new BroadcastChannel(dd)).onmessage=function(M){return M.data&&nv(M.data)}})(),typeof zf.unref=="function"&&zf.unref(),ta(Pf,function(M){iu||zf.postMessage(M)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(M){if(!Il.disableBfCache&&M.persisted){Be&&console.debug("Dexie: handling persisted pagehide"),zf!=null&&zf.close();for(var z=0,te=fi;z<te.length;z++)te[z].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(M){!Il.disableBfCache&&M.persisted&&(Be&&console.debug("Dexie: handling persisted pageshow"),ja(),nv({all:new na(-1/0,[[]])}))})),$.rejectionMapper=function(M,z){return!M||M instanceof re||M instanceof TypeError||M instanceof SyntaxError||!M.name||!Ue[M.name]?M:(z=new Ue[M.name](z||M.message,M),"stack"in M&&y(z,"stack",{get:function(){return this.inner.stack}}),z)},Re(Be),r(Il,Object.freeze({__proto__:null,Dexie:Il,liveQuery:VS,Entity:vg,cmp:Lr,PropModification:If,replacePrefix:function(M,z){return new If({replacePrefix:[M,z]})},add:function(M){return new If({add:M})},remove:function(M){return new If({remove:M})},default:Il,RangeSet:na,mergeRanges:hd,rangesOverlap:DS}),{default:Il}),Il})}(UC)),UC.exports}var Q0e=J0e();const y3=ga(Q0e),a$=Symbol.for("Dexie"),C2=globalThis[a$]||(globalThis[a$]=y3);if(y3.semVer!==C2.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${y3.semVer} and ${C2.semVer}`);const{liveQuery:fft,mergeRanges:hft,rangesOverlap:pft,RangeSet:mft,cmp:gft,Entity:yft,PropModification:bft,replacePrefix:vft,add:xft,remove:wft}=C2;class eye extends C2{constructor(){super("LiteChatDatabase_Rewrite_v1");ce(this,"conversations");ce(this,"interactions");ce(this,"mods");ce(this,"appState");ce(this,"providerConfigs");ce(this,"apiKeys");ce(this,"syncRepos");ce(this,"projects");ce(this,"rules");ce(this,"tags");ce(this,"tagRuleLinks");ce(this,"promptTemplates");this.version(9).stores({conversations:"++id, title, createdAt, updatedAt, syncRepoId, lastSyncedAt, projectId",interactions:"++id, conversationId, index, type, status, startedAt, parentId, rating",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name",syncRepos:"++id, &name, remoteUrl, username",projects:"++id, &path, parentId, createdAt, updatedAt, name",rules:"++id, &name, type, createdAt, updatedAt",tags:"++id, &name, createdAt, updatedAt",tagRuleLinks:"++id, tagId, ruleId, &[tagId+ruleId]",promptTemplates:"++id, &name, createdAt, updatedAt, isPublic"}),this.version(8).stores({conversations:"++id, title, createdAt, updatedAt, syncRepoId, lastSyncedAt, projectId",interactions:"++id, conversationId, index, type, status, startedAt, parentId, rating",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name",syncRepos:"++id, &name, remoteUrl, username",projects:"++id, &path, parentId, createdAt, updatedAt, name",rules:"++id, &name, type, createdAt, updatedAt",tags:"++id, &name, createdAt, updatedAt",tagRuleLinks:"++id, tagId, ruleId, &[tagId+ruleId]"}),this.version(7).stores({conversations:"++id, title, createdAt, updatedAt, syncRepoId, lastSyncedAt, projectId",interactions:"++id, conversationId, index, type, status, startedAt, parentId",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name",syncRepos:"++id, &name, remoteUrl, username",projects:"++id, &path, parentId, createdAt, updatedAt, name",rules:"++id, &name, type, createdAt, updatedAt",tags:"++id, &name, createdAt, updatedAt",tagRuleLinks:"++id, tagId, ruleId, &[tagId+ruleId]"}),this.version(6).stores({conversations:"++id, title, createdAt, updatedAt, syncRepoId, lastSyncedAt, projectId",interactions:"++id, conversationId, index, type, status, startedAt, parentId",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name",syncRepos:"++id, &name, remoteUrl, username",projects:"++id, &path, parentId, createdAt, updatedAt, name"}),this.version(5).stores({conversations:"++id, title, createdAt, updatedAt, syncRepoId, lastSyncedAt, projectId",interactions:"++id, conversationId, index, type, status, startedAt, parentId",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name",syncRepos:"++id, &name, remoteUrl",projects:"++id, &path, parentId, createdAt, updatedAt, name"}),this.version(4).stores({conversations:"++id, title, createdAt, updatedAt, syncRepoId, lastSyncedAt, projectId",interactions:"++id, conversationId, index, type, status, startedAt, parentId",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name",syncRepos:"++id, &name, remoteUrl",projects:"++id, name, parentId, createdAt, updatedAt"}),this.version(3).stores({conversations:"++id, title, createdAt, updatedAt, syncRepoId, lastSyncedAt, projectId",interactions:"++id, conversationId, index, type, status, startedAt, parentId",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name",syncRepos:"++id, &name, remoteUrl",projects:"++id, &name, parentId, createdAt, updatedAt"}),this.version(2).stores({conversations:"++id, title, createdAt, updatedAt, syncRepoId, lastSyncedAt",interactions:"++id, conversationId, index, type, status, startedAt, parentId",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name",syncRepos:"++id, &name, remoteUrl"}),this.version(1).stores({conversations:"++id, title, createdAt, updatedAt",interactions:"++id, conversationId, index, type, status, startedAt, parentId",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name"})}}const jt=new eye,QH="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";let Nr=(e=21)=>{let t="",n=crypto.getRandomValues(new Uint8Array(e|=0));for(;e--;)t+=QH[n[e]&63];return t};const NN=Object.freeze(Object.defineProperty({__proto__:null,nanoid:Nr,urlAlphabet:QH},Symbol.toStringTag,{value:"Module"})),gi=(e,t=[])=>{const n={...e};return e.createdAt&&!(e.createdAt instanceof Date)&&(n.createdAt=new Date(e.createdAt)),e.updatedAt&&!(e.updatedAt instanceof Date)&&(n.updatedAt=new Date(e.updatedAt)),Array.isArray(t)?t.forEach(r=>{e[r]&&!(e[r]instanceof Date)&&(n[r]=new Date(e[r]))}):console.warn("[ensureDateFields] Expected otherDateFields to be an array, but received:",t),n};class yt{static async loadConversations(){try{return(await jt.conversations.orderBy("updatedAt").reverse().toArray()).map(n=>gi(n,["lastSyncedAt"]))}catch(t){throw console.error("PersistenceService: Error loading conversations:",t),t}}static async saveConversation(t){try{const n={...t,syncRepoId:t.syncRepoId??null,lastSyncedAt:t.lastSyncedAt??null,projectId:t.projectId??null};return await jt.conversations.put(n)}catch(n){throw console.error("PersistenceService: Error saving conversation:",n),n}}static async deleteConversation(t){try{await jt.conversations.delete(t)}catch(n){throw console.error("PersistenceService: Error deleting conversation:",n),n}}static async loadInteractionsForConversation(t){try{return(await jt.interactions.where({conversationId:t}).sortBy("index")).map(r=>gi(r,["startedAt","endedAt"]))}catch(n){throw console.error("PersistenceService: Error loading interactions for conversation:",n),n}}static async saveInteraction(t){try{return await jt.interactions.put(t)}catch(n){throw console.error("PersistenceService: Error saving interaction:",n),n}}static async deleteInteraction(t){try{await jt.interactions.delete(t)}catch(n){throw console.error("PersistenceService: Error deleting interaction:",n),n}}static async deleteInteractionsForConversation(t){try{await jt.interactions.where({conversationId:t}).delete()}catch(n){throw console.error("PersistenceService: Error deleting interactions for conversation:",n),n}}static async loadMods(){try{return(await jt.mods.orderBy("loadOrder").toArray()).map(n=>gi(n,[]))}catch(t){throw console.error("PersistenceService: Error loading mods:",t),t}}static async saveMod(t){try{return await jt.mods.put(t)}catch(n){throw console.error("PersistenceService: Error saving mod:",n),n}}static async deleteMod(t){try{await jt.mods.delete(t)}catch(n){throw console.error("PersistenceService: Error deleting mod:",n),n}}static async saveSetting(t,n){try{return await jt.appState.put({key:`settings:${t}`,value:n})}catch(r){throw console.error("PersistenceService: Error saving setting:",r),r}}static async loadSetting(t,n){try{const r=await jt.appState.get(`settings:${t}`);return(r==null?void 0:r.value)!==void 0?r.value:n}catch(r){return console.error("PersistenceService: Error loading setting:",r),n}}static async loadProviderConfigs(){var t;try{return(await((t=jt.providerConfigs)==null?void 0:t.toArray())??[]).map(r=>gi(r,["modelsLastFetchedAt"]))}catch(n){throw console.error("PersistenceService: Error loading provider configs:",n),n}}static async saveProviderConfig(t){try{return await jt.providerConfigs.put(t)}catch(n){throw console.error("PersistenceService: Error saving provider config:",n),n}}static async deleteProviderConfig(t){try{await jt.providerConfigs.delete(t)}catch(n){throw console.error("PersistenceService: Error deleting provider config:",n),n}}static async loadApiKeys(){var t;try{return(await((t=jt.apiKeys)==null?void 0:t.toArray())??[]).map(r=>gi(r,[]))}catch(n){throw console.error("PersistenceService: Error loading API keys:",n),n}}static async saveApiKey(t){try{return await jt.apiKeys.put(t)}catch(n){throw console.error("PersistenceService: Error saving API key:",n),n}}static async deleteApiKey(t){try{await jt.transaction("rw",[jt.apiKeys,jt.providerConfigs],async()=>{const n=await jt.providerConfigs.where("apiKeyId").equals(t).toArray();if(n.length>0){const r=n.map(s=>jt.providerConfigs.update(s.id,{apiKeyId:null}));await Promise.all(r),console.log(`PersistenceService: Unlinked API key ${t} from ${n.length} provider configs.`)}await jt.apiKeys.delete(t)})}catch(n){throw console.error("PersistenceService: Error deleting API key:",n),n}}static async loadSyncRepos(){try{return(await jt.syncRepos.toArray()).map(n=>gi(n,["lastPulledAt","lastPushedAt"]))}catch(t){throw console.error("PersistenceService: Error loading sync repos:",t),t}}static async saveSyncRepo(t){try{return await jt.syncRepos.put(t)}catch(n){throw console.error("PersistenceService: Error saving sync repo:",n),n}}static async deleteSyncRepo(t){try{await jt.transaction("rw",[jt.syncRepos,jt.conversations],async()=>{const n=await jt.conversations.where("syncRepoId").equals(t).toArray();if(n.length>0){const r=n.map(s=>jt.conversations.update(s.id,{syncRepoId:null}));await Promise.all(r),console.log(`PersistenceService: Unlinked SyncRepo ${t} from ${n.length} conversations.`)}await jt.syncRepos.delete(t)})}catch(n){throw console.error("PersistenceService: Error deleting sync repo:",n),n}}static async loadProjects(){try{return(await jt.projects.orderBy("updatedAt").reverse().toArray()).map(n=>gi(n,[]))}catch(t){throw console.error("PersistenceService: Error loading projects:",t),t}}static async saveProject(t){try{const n={id:t.id,path:t.path,createdAt:t.createdAt,updatedAt:t.updatedAt,name:t.name,parentId:t.parentId??null,systemPrompt:t.systemPrompt??null,modelId:t.modelId??null,temperature:t.temperature??null,maxTokens:t.maxTokens??null,topP:t.topP??null,topK:t.topK??null,presencePenalty:t.presencePenalty??null,frequencyPenalty:t.frequencyPenalty??null,defaultTagIds:t.defaultTagIds??null,defaultRuleIds:t.defaultRuleIds??null,metadata:t.metadata?{...t.metadata}:{}};return await jt.projects.put(n)}catch(n){throw console.error("PersistenceService: Error saving project:",n),n}}static async deleteProject(t){try{const n=async r=>{const s=await jt.projects.where("parentId").equals(r).toArray();for(const i of s)await n(i.id);await jt.projects.delete(r),console.log(`PersistenceService: Deleted Project ${r}`)};await jt.transaction("rw",[jt.projects],async()=>{await n(t)})}catch(n){throw console.error("PersistenceService: Error deleting project:",n),n}}static async loadRules(){try{return(await jt.rules.orderBy("name").toArray()).map(n=>gi(n))}catch(t){throw console.error("PersistenceService: Error loading rules:",t),t}}static async saveRule(t){try{return await jt.rules.put(t)}catch(n){throw console.error("PersistenceService: Error saving rule:",n),n}}static async deleteRule(t){try{await jt.transaction("rw",[jt.rules,jt.tagRuleLinks],async()=>{await jt.tagRuleLinks.where("ruleId").equals(t).delete(),await jt.rules.delete(t)})}catch(n){throw console.error("PersistenceService: Error deleting rule:",n),n}}static async loadTags(){try{return(await jt.tags.orderBy("name").toArray()).map(n=>gi(n))}catch(t){throw console.error("PersistenceService: Error loading tags:",t),t}}static async saveTag(t){try{return await jt.tags.put(t)}catch(n){throw console.error("PersistenceService: Error saving tag:",n),n}}static async deleteTag(t){try{await jt.transaction("rw",[jt.tags,jt.tagRuleLinks],async()=>{await jt.tagRuleLinks.where("tagId").equals(t).delete(),await jt.tags.delete(t)})}catch(n){throw console.error("PersistenceService: Error deleting tag:",n),n}}static async loadTagRuleLinks(){try{return await jt.tagRuleLinks.toArray()}catch(t){throw console.error("PersistenceService: Error loading tag-rule links:",t),t}}static async saveTagRuleLink(t){try{return await jt.tagRuleLinks.put(t)}catch(n){throw console.error("PersistenceService: Error saving tag-rule link:",n),n}}static async deleteTagRuleLink(t){try{await jt.tagRuleLinks.delete(t)}catch(n){throw console.error("PersistenceService: Error deleting tag-rule link:",n),n}}static async getAllDataForExport(t){const n={version:1,exportedAt:new Date().toISOString()};if(t.importSettings){const r=await jt.appState.toArray();n.settings={},r.forEach(s=>{s.key.startsWith("settings:")&&s.key!=="settings:mcpServers"&&(n.settings[s.key.substring(9)]=s.value)})}if(t.importApiKeys&&(n.apiKeys=await jt.apiKeys.toArray()),t.importProviderConfigs&&(n.providerConfigs=await jt.providerConfigs.toArray()),t.importProjects&&(n.projects=await jt.projects.toArray()),t.importConversations&&(n.conversations=await jt.conversations.toArray(),n.interactions=await jt.interactions.toArray()),t.importRulesAndTags&&(n.rules=await jt.rules.toArray(),n.tags=await jt.tags.toArray(),n.tagRuleLinks=await jt.tagRuleLinks.toArray()),t.importMods&&(n.mods=await jt.mods.toArray()),t.importSyncRepos&&(n.syncRepos=await jt.syncRepos.toArray()),t.importMcpServers){const s=(await jt.appState.toArray()).find(i=>i.key==="settings:mcpServers");n.mcpServers=s?s.value:[]}if(t.importPromptTemplates){const r=await jt.promptTemplates.toArray();n.promptTemplates=r.filter(s=>!s.type||s.type==="prompt")}if(t.importAgents){const r=await jt.promptTemplates.toArray(),s=r.filter(o=>o.type==="agent"),i=s.map(o=>o.id),a=r.filter(o=>o.type==="task"&&i.includes(o.parentId));n.agents=[...s,...a]}return n}static async importAllData(t,n){if(t.version!==1)throw new Error(`Unsupported export version: ${t.version}. Expected version 1.`);await jt.transaction("rw",[jt.appState,jt.apiKeys,jt.providerConfigs,jt.projects,jt.conversations,jt.interactions,jt.rules,jt.tags,jt.tagRuleLinks,jt.mods,jt.syncRepos,jt.promptTemplates],async()=>{if(n.importSettings&&await jt.appState.clear(),n.importApiKeys&&await jt.apiKeys.clear(),n.importProviderConfigs&&await jt.providerConfigs.clear(),n.importProjects&&await jt.projects.clear(),n.importConversations&&(await jt.conversations.clear(),await jt.interactions.clear()),n.importRulesAndTags&&(await jt.rules.clear(),await jt.tags.clear(),await jt.tagRuleLinks.clear()),n.importMods&&await jt.mods.clear(),n.importSyncRepos&&await jt.syncRepos.clear(),n.importMcpServers&&await jt.appState.where("key").equals("settings:mcpServers").delete(),n.importPromptTemplates){const i=(await jt.promptTemplates.toArray()).filter(a=>!a.type||a.type==="prompt").map(a=>a.id||Nr());i.length>0&&await jt.promptTemplates.where("id").anyOf(i).delete()}if(n.importAgents&&t.agents){const s=t.agents.filter(l=>l.type==="agent").map(l=>l.id||Nr()),a=t.agents.filter(l=>l.type==="task").map(l=>l.id||Nr()),o=[...s,...a];o.length>0&&await jt.promptTemplates.where("id").anyOf(o).delete()}if(n.importSettings&&t.settings){const r=Object.entries(t.settings).map(([s,i])=>({key:`settings:${s}`,value:i}));await jt.appState.bulkPut(r)}n.importApiKeys&&t.apiKeys&&await jt.apiKeys.bulkPut(t.apiKeys.map(r=>gi(r))),n.importProviderConfigs&&t.providerConfigs&&await jt.providerConfigs.bulkPut(t.providerConfigs.map(r=>gi(r,["modelsLastFetchedAt"]))),n.importProjects&&t.projects&&await jt.projects.bulkPut(t.projects.map(r=>gi(r))),n.importConversations&&t.conversations&&(await jt.conversations.bulkPut(t.conversations.map(r=>gi(r,["lastSyncedAt"]))),t.interactions&&await jt.interactions.bulkPut(t.interactions.map(r=>gi(r,["startedAt","endedAt"])))),n.importRulesAndTags&&(t.rules&&await jt.rules.bulkPut(t.rules.map(r=>gi(r))),t.tags&&await jt.tags.bulkPut(t.tags.map(r=>gi(r))),t.tagRuleLinks&&await jt.tagRuleLinks.bulkPut(t.tagRuleLinks)),n.importMods&&t.mods&&await jt.mods.bulkPut(t.mods.map(r=>gi(r))),n.importSyncRepos&&t.syncRepos&&await jt.syncRepos.bulkPut(t.syncRepos.map(r=>gi(r,["lastPulledAt","lastPushedAt"]))),n.importMcpServers&&t.mcpServers&&await jt.appState.put({key:"settings:mcpServers",value:t.mcpServers}),n.importPromptTemplates&&t.promptTemplates&&await jt.promptTemplates.bulkPut(t.promptTemplates.map(r=>gi({...r,id:r.id||Nr()},["createdAt","updatedAt"]))),n.importAgents&&t.agents&&await jt.promptTemplates.bulkPut(t.agents.map(r=>gi({...r,id:r.id||Nr()},["createdAt","updatedAt"])))})}static async loadPromptTemplates(){try{return(await jt.promptTemplates.orderBy("name").toArray()).map(n=>gi(n,["createdAt","updatedAt"]))}catch(t){throw console.error("PersistenceService: Error loading prompt templates:",t),t}}static async savePromptTemplate(t){try{return await jt.promptTemplates.put(t)}catch(n){throw console.error("PersistenceService: Error saving prompt template:",n),n}}static async deletePromptTemplate(t){try{await jt.promptTemplates.delete(t)}catch(n){throw console.error("PersistenceService: Error deleting prompt template:",n),n}}static async clearAllData(){try{await jt.transaction("rw",[jt.conversations,jt.interactions,jt.mods,jt.appState,jt.providerConfigs,jt.apiKeys,jt.syncRepos,jt.projects,jt.rules,jt.tags,jt.tagRuleLinks,jt.promptTemplates],async()=>{await jt.conversations.clear(),await jt.interactions.clear(),await jt.mods.clear(),await jt.appState.clear(),await jt.providerConfigs.clear(),await jt.apiKeys.clear(),await jt.syncRepos.clear(),await jt.projects.clear(),await jt.rules.clear(),await jt.tags.clear(),await jt.tagRuleLinks.clear(),await jt.promptTemplates.clear()})}catch(t){throw console.error("PersistenceService: Error clearing all data:",t),t}}}const xn={loaded:"interaction.loaded",currentConversationIdChanged:"interaction.current.conversation.id.changed",added:"interaction.added",updated:"interaction.updated",streamingIdsChanged:"interaction.streaming.ids.changed",activeStreamBuffersChanged:"interaction.active.stream.buffers.changed",activeReasoningBuffersChanged:"interaction.active.reasoning.buffers.changed",statusChanged:"interaction.status.changed",errorChanged:"interaction.error.changed",interactionRated:"interaction.rated",started:"interaction.sdk.started",streamChunk:"interaction.sdk.streamChunk",completed:"interaction.sdk.completed",loadInteractionsRequest:"interaction.load.interactions.request",rateInteractionRequest:"interaction.rate.interaction.request",setCurrentConversationIdRequest:"interaction.set.current.conversation.id.request",clearInteractionsRequest:"interaction.clear.interactions.request",setErrorRequest:"interaction.set.error.request",setStatusRequest:"interaction.set.status.request"};var yl=xH();const PE=ga(yl);function tye(e){if(typeof document>"u")return;let t=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",t.appendChild(n),n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e))}const nye=e=>{switch(e){case"success":return iye;case"info":return oye;case"warning":return aye;case"error":return lye;default:return null}},rye=Array(12).fill(0),sye=({visible:e,className:t})=>Ve.createElement("div",{className:["sonner-loading-wrapper",t].filter(Boolean).join(" "),"data-visible":e},Ve.createElement("div",{className:"sonner-spinner"},rye.map((n,r)=>Ve.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${r}`})))),iye=Ve.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Ve.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),aye=Ve.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},Ve.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),oye=Ve.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Ve.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),lye=Ve.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Ve.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),cye=Ve.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},Ve.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),Ve.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),uye=()=>{const[e,t]=Ve.useState(document.hidden);return Ve.useEffect(()=>{const n=()=>{t(document.hidden)};return document.addEventListener("visibilitychange",n),()=>window.removeEventListener("visibilitychange",n)},[]),e};let b3=1;class dye{constructor(){this.subscribe=t=>(this.subscribers.push(t),()=>{const n=this.subscribers.indexOf(t);this.subscribers.splice(n,1)}),this.publish=t=>{this.subscribers.forEach(n=>n(t))},this.addToast=t=>{this.publish(t),this.toasts=[...this.toasts,t]},this.create=t=>{var n;const{message:r,...s}=t,i=typeof(t==null?void 0:t.id)=="number"||((n=t.id)==null?void 0:n.length)>0?t.id:b3++,a=this.toasts.find(l=>l.id===i),o=t.dismissible===void 0?!0:t.dismissible;return this.dismissedToasts.has(i)&&this.dismissedToasts.delete(i),a?this.toasts=this.toasts.map(l=>l.id===i?(this.publish({...l,...t,id:i,title:r}),{...l,...t,id:i,dismissible:o,title:r}):l):this.addToast({title:r,...s,dismissible:o,id:i}),i},this.dismiss=t=>(t?(this.dismissedToasts.add(t),requestAnimationFrame(()=>this.subscribers.forEach(n=>n({id:t,dismiss:!0})))):this.toasts.forEach(n=>{this.subscribers.forEach(r=>r({id:n.id,dismiss:!0}))}),t),this.message=(t,n)=>this.create({...n,message:t}),this.error=(t,n)=>this.create({...n,message:t,type:"error"}),this.success=(t,n)=>this.create({...n,type:"success",message:t}),this.info=(t,n)=>this.create({...n,type:"info",message:t}),this.warning=(t,n)=>this.create({...n,type:"warning",message:t}),this.loading=(t,n)=>this.create({...n,type:"loading",message:t}),this.promise=(t,n)=>{if(!n)return;let r;n.loading!==void 0&&(r=this.create({...n,promise:t,type:"loading",message:n.loading,description:typeof n.description!="function"?n.description:void 0}));const s=Promise.resolve(t instanceof Function?t():t);let i=r!==void 0,a;const o=s.then(async c=>{if(a=["resolve",c],Ve.isValidElement(c))i=!1,this.create({id:r,type:"default",message:c});else if(hye(c)&&!c.ok){i=!1;const d=typeof n.error=="function"?await n.error(`HTTP error! status: ${c.status}`):n.error,h=typeof n.description=="function"?await n.description(`HTTP error! status: ${c.status}`):n.description,y=typeof d=="object"&&!Ve.isValidElement(d)?d:{message:d};this.create({id:r,type:"error",description:h,...y})}else if(c instanceof Error){i=!1;const d=typeof n.error=="function"?await n.error(c):n.error,h=typeof n.description=="function"?await n.description(c):n.description,y=typeof d=="object"&&!Ve.isValidElement(d)?d:{message:d};this.create({id:r,type:"error",description:h,...y})}else if(n.success!==void 0){i=!1;const d=typeof n.success=="function"?await n.success(c):n.success,h=typeof n.description=="function"?await n.description(c):n.description,y=typeof d=="object"&&!Ve.isValidElement(d)?d:{message:d};this.create({id:r,type:"success",description:h,...y})}}).catch(async c=>{if(a=["reject",c],n.error!==void 0){i=!1;const u=typeof n.error=="function"?await n.error(c):n.error,d=typeof n.description=="function"?await n.description(c):n.description,m=typeof u=="object"&&!Ve.isValidElement(u)?u:{message:u};this.create({id:r,type:"error",description:d,...m})}}).finally(()=>{i&&(this.dismiss(r),r=void 0),n.finally==null||n.finally.call(n)}),l=()=>new Promise((c,u)=>o.then(()=>a[0]==="reject"?u(a[1]):c(a[1])).catch(u));return typeof r!="string"&&typeof r!="number"?{unwrap:l}:Object.assign(r,{unwrap:l})},this.custom=(t,n)=>{const r=(n==null?void 0:n.id)||b3++;return this.create({jsx:t(r),id:r,...n}),r},this.getActiveToasts=()=>this.toasts.filter(t=>!this.dismissedToasts.has(t.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}}const Do=new dye,fye=(e,t)=>{const n=(t==null?void 0:t.id)||b3++;return Do.addToast({title:e,...t,id:n}),n},hye=e=>e&&typeof e=="object"&&"ok"in e&&typeof e.ok=="boolean"&&"status"in e&&typeof e.status=="number",pye=fye,mye=()=>Do.toasts,gye=()=>Do.getActiveToasts(),ke=Object.assign(pye,{success:Do.success,info:Do.info,warning:Do.warning,error:Do.error,custom:Do.custom,message:Do.message,promise:Do.promise,dismiss:Do.dismiss,loading:Do.loading},{getHistory:mye,getToasts:gye});tye("[data-sonner-toaster][dir=ltr],html[dir=ltr]{--toast-icon-margin-start:-3px;--toast-icon-margin-end:4px;--toast-svg-margin-start:-1px;--toast-svg-margin-end:0px;--toast-button-margin-start:auto;--toast-button-margin-end:0;--toast-close-button-start:0;--toast-close-button-end:unset;--toast-close-button-transform:translate(-35%, -35%)}[data-sonner-toaster][dir=rtl],html[dir=rtl]{--toast-icon-margin-start:4px;--toast-icon-margin-end:-3px;--toast-svg-margin-start:0px;--toast-svg-margin-end:-1px;--toast-button-margin-start:0;--toast-button-margin-end:auto;--toast-close-button-start:unset;--toast-close-button-end:0;--toast-close-button-transform:translate(35%, -35%)}[data-sonner-toaster]{position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1:hsl(0, 0%, 99%);--gray2:hsl(0, 0%, 97.3%);--gray3:hsl(0, 0%, 95.1%);--gray4:hsl(0, 0%, 93%);--gray5:hsl(0, 0%, 90.9%);--gray6:hsl(0, 0%, 88.7%);--gray7:hsl(0, 0%, 85.8%);--gray8:hsl(0, 0%, 78%);--gray9:hsl(0, 0%, 56.1%);--gray10:hsl(0, 0%, 52.3%);--gray11:hsl(0, 0%, 43.5%);--gray12:hsl(0, 0%, 9%);--border-radius:8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:0;z-index:999999999;transition:transform .4s ease}[data-sonner-toaster][data-lifted=true]{transform:translateY(-8px)}@media (hover:none) and (pointer:coarse){[data-sonner-toaster][data-lifted=true]{transform:none}}[data-sonner-toaster][data-x-position=right]{right:var(--offset-right)}[data-sonner-toaster][data-x-position=left]{left:var(--offset-left)}[data-sonner-toaster][data-x-position=center]{left:50%;transform:translateX(-50%)}[data-sonner-toaster][data-y-position=top]{top:var(--offset-top)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--offset-bottom)}[data-sonner-toast]{--y:translateY(100%);--lift-amount:calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:0;overflow-wrap:anywhere}[data-sonner-toast][data-styled=true]{padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px rgba(0,0,0,.1);width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}[data-sonner-toast]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-y-position=top]{top:0;--y:translateY(-100%);--lift:1;--lift-amount:calc(1 * var(--gap))}[data-sonner-toast][data-y-position=bottom]{bottom:0;--y:translateY(100%);--lift:-1;--lift-amount:calc(var(--lift) * var(--gap))}[data-sonner-toast][data-styled=true] [data-description]{font-weight:400;line-height:1.4;color:#3f3f3f}[data-rich-colors=true][data-sonner-toast][data-styled=true] [data-description]{color:inherit}[data-sonner-toaster][data-sonner-theme=dark] [data-description]{color:#e8e8e8}[data-sonner-toast][data-styled=true] [data-title]{font-weight:500;line-height:1.5;color:inherit}[data-sonner-toast][data-styled=true] [data-icon]{display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}[data-sonner-toast][data-promise=true] [data-icon]>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}[data-sonner-toast][data-styled=true] [data-icon]>*{flex-shrink:0}[data-sonner-toast][data-styled=true] [data-icon] svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}[data-sonner-toast][data-styled=true] [data-content]{display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;font-weight:500;cursor:pointer;outline:0;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}[data-sonner-toast][data-styled=true] [data-button]:focus-visible{box-shadow:0 0 0 2px rgba(0,0,0,.4)}[data-sonner-toast][data-styled=true] [data-button]:first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}[data-sonner-toast][data-styled=true] [data-cancel]{color:var(--normal-text);background:rgba(0,0,0,.08)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-styled=true] [data-cancel]{background:rgba(255,255,255,.3)}[data-sonner-toast][data-styled=true] [data-close-button]{position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);background:var(--normal-bg);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast][data-styled=true] [data-close-button]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-styled=true] [data-disabled=true]{cursor:not-allowed}[data-sonner-toast][data-styled=true]:hover [data-close-button]:hover{background:var(--gray2);border-color:var(--gray5)}[data-sonner-toast][data-swiping=true]::before{content:'';position:absolute;left:-100%;right:-100%;height:100%;z-index:-1}[data-sonner-toast][data-y-position=top][data-swiping=true]::before{bottom:50%;transform:scaleY(3) translateY(50%)}[data-sonner-toast][data-y-position=bottom][data-swiping=true]::before{top:50%;transform:scaleY(3) translateY(-50%)}[data-sonner-toast][data-swiping=false][data-removed=true]::before{content:'';position:absolute;inset:0;transform:scaleY(2)}[data-sonner-toast][data-expanded=true]::after{content:'';position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}[data-sonner-toast][data-mounted=true]{--y:translateY(0);opacity:1}[data-sonner-toast][data-expanded=false][data-front=false]{--scale:var(--toasts-before) * 0.05 + 1;--y:translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}[data-sonner-toast]>*{transition:opacity .4s}[data-sonner-toast][data-x-position=right]{right:0}[data-sonner-toast][data-x-position=left]{left:0}[data-sonner-toast][data-expanded=false][data-front=false][data-styled=true]>*{opacity:0}[data-sonner-toast][data-visible=false]{opacity:0;pointer-events:none}[data-sonner-toast][data-mounted=true][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}[data-sonner-toast][data-removed=true][data-front=true][data-swipe-out=false]{--y:translateY(calc(var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=false]{--y:translateY(40%);opacity:0;transition:transform .5s,opacity .2s}[data-sonner-toast][data-removed=true][data-front=false]::before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y,0)) translateX(var(--swipe-amount-x,0));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width:600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-sonner-theme=light]{--normal-bg:#fff;--normal-border:var(--gray4);--normal-text:var(--gray12);--success-bg:hsl(143, 85%, 96%);--success-border:hsl(145, 92%, 87%);--success-text:hsl(140, 100%, 27%);--info-bg:hsl(208, 100%, 97%);--info-border:hsl(221, 91%, 93%);--info-text:hsl(210, 92%, 45%);--warning-bg:hsl(49, 100%, 97%);--warning-border:hsl(49, 91%, 84%);--warning-text:hsl(31, 92%, 45%);--error-bg:hsl(359, 100%, 97%);--error-border:hsl(359, 100%, 94%);--error-text:hsl(360, 100%, 45%)}[data-sonner-toaster][data-sonner-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg:#000;--normal-border:hsl(0, 0%, 20%);--normal-text:var(--gray1)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg:#fff;--normal-border:var(--gray3);--normal-text:var(--gray12)}[data-sonner-toaster][data-sonner-theme=dark]{--normal-bg:#000;--normal-bg-hover:hsl(0, 0%, 12%);--normal-border:hsl(0, 0%, 20%);--normal-border-hover:hsl(0, 0%, 25%);--normal-text:var(--gray1);--success-bg:hsl(150, 100%, 6%);--success-border:hsl(147, 100%, 12%);--success-text:hsl(150, 86%, 65%);--info-bg:hsl(215, 100%, 6%);--info-border:hsl(223, 43%, 17%);--info-text:hsl(216, 87%, 65%);--warning-bg:hsl(64, 100%, 6%);--warning-border:hsl(60, 100%, 9%);--warning-text:hsl(46, 87%, 65%);--error-bg:hsl(358, 76%, 10%);--error-border:hsl(357, 89%, 16%);--error-text:hsl(358, 100%, 81%)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size:16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:first-child{animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}100%{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}100%{opacity:.15}}@media (prefers-reduced-motion){.sonner-loading-bar,[data-sonner-toast],[data-sonner-toast]>*{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}");function q_(e){return e.label!==void 0}const yye=3,bye="24px",vye="16px",o$=4e3,xye=356,wye=14,Sye=45,_ye=200;function fu(...e){return e.filter(Boolean).join(" ")}function Cye(e){const[t,n]=e.split("-"),r=[];return t&&r.push(t),n&&r.push(n),r}const kye=e=>{var t,n,r,s,i,a,o,l,c;const{invert:u,toast:d,unstyled:h,interacting:m,setHeights:y,visibleToasts:b,heights:v,index:x,toasts:w,expanded:_,removeToast:k,defaultRichColors:C,closeButton:T,style:A,cancelButtonStyle:N,actionButtonStyle:I,className:j="",descriptionClassName:L="",duration:D,position:H,gap:O,expandByDefault:K,classNames:U,icons:W,closeButtonAriaLabel:B="Close toast"}=e,[ne,V]=Ve.useState(null),[Q,ee]=Ve.useState(null),[re,de]=Ve.useState(!1),[me,De]=Ve.useState(!1),[je,Te]=Ve.useState(!1),[_e,Ue]=Ve.useState(!1),[Qe,We]=Ve.useState(!1),[Pe,Y]=Ve.useState(0),[ye,Me]=Ve.useState(0),ue=Ve.useRef(d.duration||D||o$),oe=Ve.useRef(null),se=Ve.useRef(null),Ie=x===0,Be=x+1<=b,Re=d.type,ct=d.dismissible!==!1,At=d.className||"",ut=d.descriptionClassName||"",Pt=Ve.useMemo(()=>v.findIndex(Se=>Se.toastId===d.id)||0,[v,d.id]),Ut=Ve.useMemo(()=>{var Se;return(Se=d.closeButton)!=null?Se:T},[d.closeButton,T]),Ft=Ve.useMemo(()=>d.duration||D||o$,[d.duration,D]),Yt=Ve.useRef(0),we=Ve.useRef(0),F=Ve.useRef(0),X=Ve.useRef(null),[be,Ee]=H.split("-"),ge=Ve.useMemo(()=>v.reduce((Se,ze,Ct)=>Ct>=Pt?Se:Se+ze.height,0),[v,Pt]),Ae=uye(),le=d.invert||u,ft=Re==="loading";we.current=Ve.useMemo(()=>Pt*O+ge,[Pt,ge]),Ve.useEffect(()=>{ue.current=Ft},[Ft]),Ve.useEffect(()=>{de(!0)},[]),Ve.useEffect(()=>{const Se=se.current;if(Se){const ze=Se.getBoundingClientRect().height;return Me(ze),y(Ct=>[{toastId:d.id,height:ze,position:d.position},...Ct]),()=>y(Ct=>Ct.filter(fe=>fe.toastId!==d.id))}},[y,d.id]),Ve.useLayoutEffect(()=>{if(!re)return;const Se=se.current,ze=Se.style.height;Se.style.height="auto";const Ct=Se.getBoundingClientRect().height;Se.style.height=ze,Me(Ct),y(fe=>fe.find(G=>G.toastId===d.id)?fe.map(G=>G.toastId===d.id?{...G,height:Ct}:G):[{toastId:d.id,height:Ct,position:d.position},...fe])},[re,d.title,d.description,y,d.id]);const et=Ve.useCallback(()=>{De(!0),Y(we.current),y(Se=>Se.filter(ze=>ze.toastId!==d.id)),setTimeout(()=>{k(d)},_ye)},[d,k,y,we]);Ve.useEffect(()=>{if(d.promise&&Re==="loading"||d.duration===1/0||d.type==="loading")return;let Se;return _||m||Ae?(()=>{if(F.current<Yt.current){const fe=new Date().getTime()-Yt.current;ue.current=ue.current-fe}F.current=new Date().getTime()})():(()=>{ue.current!==1/0&&(Yt.current=new Date().getTime(),Se=setTimeout(()=>{d.onAutoClose==null||d.onAutoClose.call(d,d),et()},ue.current))})(),()=>clearTimeout(Se)},[_,m,d,Re,Ae,et]),Ve.useEffect(()=>{d.delete&&et()},[et,d.delete]);function $(){var Se;if(W!=null&&W.loading){var ze;return Ve.createElement("div",{className:fu(U==null?void 0:U.loader,d==null||(ze=d.classNames)==null?void 0:ze.loader,"sonner-loader"),"data-visible":Re==="loading"},W.loading)}return Ve.createElement(sye,{className:fu(U==null?void 0:U.loader,d==null||(Se=d.classNames)==null?void 0:Se.loader),visible:Re==="loading"})}const qe=d.icon||(W==null?void 0:W[Re])||nye(Re);var tt,ve;return Ve.createElement("li",{tabIndex:0,ref:se,className:fu(j,At,U==null?void 0:U.toast,d==null||(t=d.classNames)==null?void 0:t.toast,U==null?void 0:U.default,U==null?void 0:U[Re],d==null||(n=d.classNames)==null?void 0:n[Re]),"data-sonner-toast":"","data-rich-colors":(tt=d.richColors)!=null?tt:C,"data-styled":!(d.jsx||d.unstyled||h),"data-mounted":re,"data-promise":!!d.promise,"data-swiped":Qe,"data-removed":me,"data-visible":Be,"data-y-position":be,"data-x-position":Ee,"data-index":x,"data-front":Ie,"data-swiping":je,"data-dismissible":ct,"data-type":Re,"data-invert":le,"data-swipe-out":_e,"data-swipe-direction":Q,"data-expanded":!!(_||K&&re),style:{"--index":x,"--toasts-before":x,"--z-index":w.length-x,"--offset":`${me?Pe:we.current}px`,"--initial-height":K?"auto":`${ye}px`,...A,...d.style},onDragEnd:()=>{Te(!1),V(null),X.current=null},onPointerDown:Se=>{ft||!ct||(oe.current=new Date,Y(we.current),Se.target.setPointerCapture(Se.pointerId),Se.target.tagName!=="BUTTON"&&(Te(!0),X.current={x:Se.clientX,y:Se.clientY}))},onPointerUp:()=>{var Se,ze,Ct;if(_e||!ct)return;X.current=null;const fe=Number(((Se=se.current)==null?void 0:Se.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),Z=Number(((ze=se.current)==null?void 0:ze.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),G=new Date().getTime()-((Ct=oe.current)==null?void 0:Ct.getTime()),J=ne==="x"?fe:Z,xe=Math.abs(J)/G;if(Math.abs(J)>=Sye||xe>.11){Y(we.current),d.onDismiss==null||d.onDismiss.call(d,d),ee(ne==="x"?fe>0?"right":"left":Z>0?"down":"up"),et(),Ue(!0);return}else{var Fe,He;(Fe=se.current)==null||Fe.style.setProperty("--swipe-amount-x","0px"),(He=se.current)==null||He.style.setProperty("--swipe-amount-y","0px")}We(!1),Te(!1),V(null)},onPointerMove:Se=>{var ze,Ct,fe;if(!X.current||!ct||((ze=window.getSelection())==null?void 0:ze.toString().length)>0)return;const G=Se.clientY-X.current.y,J=Se.clientX-X.current.x;var xe;const Fe=(xe=e.swipeDirections)!=null?xe:Cye(H);!ne&&(Math.abs(J)>1||Math.abs(G)>1)&&V(Math.abs(J)>Math.abs(G)?"x":"y");let He={x:0,y:0};const wt=Qt=>1/(1.5+Math.abs(Qt)/20);if(ne==="y"){if(Fe.includes("top")||Fe.includes("bottom"))if(Fe.includes("top")&&G<0||Fe.includes("bottom")&&G>0)He.y=G;else{const Qt=G*wt(G);He.y=Math.abs(Qt)<Math.abs(G)?Qt:G}}else if(ne==="x"&&(Fe.includes("left")||Fe.includes("right")))if(Fe.includes("left")&&J<0||Fe.includes("right")&&J>0)He.x=J;else{const Qt=J*wt(J);He.x=Math.abs(Qt)<Math.abs(J)?Qt:J}(Math.abs(He.x)>0||Math.abs(He.y)>0)&&We(!0),(Ct=se.current)==null||Ct.style.setProperty("--swipe-amount-x",`${He.x}px`),(fe=se.current)==null||fe.style.setProperty("--swipe-amount-y",`${He.y}px`)}},Ut&&!d.jsx&&Re!=="loading"?Ve.createElement("button",{"aria-label":B,"data-disabled":ft,"data-close-button":!0,onClick:ft||!ct?()=>{}:()=>{et(),d.onDismiss==null||d.onDismiss.call(d,d)},className:fu(U==null?void 0:U.closeButton,d==null||(r=d.classNames)==null?void 0:r.closeButton)},(ve=W==null?void 0:W.close)!=null?ve:cye):null,(Re||d.icon||d.promise)&&d.icon!==null&&((W==null?void 0:W[Re])!==null||d.icon)?Ve.createElement("div",{"data-icon":"",className:fu(U==null?void 0:U.icon,d==null||(s=d.classNames)==null?void 0:s.icon)},d.promise||d.type==="loading"&&!d.icon?d.icon||$():null,d.type!=="loading"?qe:null):null,Ve.createElement("div",{"data-content":"",className:fu(U==null?void 0:U.content,d==null||(i=d.classNames)==null?void 0:i.content)},Ve.createElement("div",{"data-title":"",className:fu(U==null?void 0:U.title,d==null||(a=d.classNames)==null?void 0:a.title)},d.jsx?d.jsx:typeof d.title=="function"?d.title():d.title),d.description?Ve.createElement("div",{"data-description":"",className:fu(L,ut,U==null?void 0:U.description,d==null||(o=d.classNames)==null?void 0:o.description)},typeof d.description=="function"?d.description():d.description):null),Ve.isValidElement(d.cancel)?d.cancel:d.cancel&&q_(d.cancel)?Ve.createElement("button",{"data-button":!0,"data-cancel":!0,style:d.cancelButtonStyle||N,onClick:Se=>{q_(d.cancel)&&ct&&(d.cancel.onClick==null||d.cancel.onClick.call(d.cancel,Se),et())},className:fu(U==null?void 0:U.cancelButton,d==null||(l=d.classNames)==null?void 0:l.cancelButton)},d.cancel.label):null,Ve.isValidElement(d.action)?d.action:d.action&&q_(d.action)?Ve.createElement("button",{"data-button":!0,"data-action":!0,style:d.actionButtonStyle||I,onClick:Se=>{q_(d.action)&&(d.action.onClick==null||d.action.onClick.call(d.action,Se),!Se.defaultPrevented&&et())},className:fu(U==null?void 0:U.actionButton,d==null||(c=d.classNames)==null?void 0:c.actionButton)},d.action.label):null)};function l$(){if(typeof window>"u"||typeof document>"u")return"ltr";const e=document.documentElement.getAttribute("dir");return e==="auto"||!e?window.getComputedStyle(document.documentElement).direction:e}function Eye(e,t){const n={};return[e,t].forEach((r,s)=>{const i=s===1,a=i?"--mobile-offset":"--offset",o=i?vye:bye;function l(c){["top","right","bottom","left"].forEach(u=>{n[`${a}-${u}`]=typeof c=="number"?`${c}px`:c})}typeof r=="number"||typeof r=="string"?l(r):typeof r=="object"?["top","right","bottom","left"].forEach(c=>{r[c]===void 0?n[`${a}-${c}`]=o:n[`${a}-${c}`]=typeof r[c]=="number"?`${r[c]}px`:r[c]}):l(o)}),n}const Tye=Ve.forwardRef(function(t,n){const{invert:r,position:s="bottom-right",hotkey:i=["altKey","KeyT"],expand:a,closeButton:o,className:l,offset:c,mobileOffset:u,theme:d="light",richColors:h,duration:m,style:y,visibleToasts:b=yye,toastOptions:v,dir:x=l$(),gap:w=wye,icons:_,containerAriaLabel:k="Notifications"}=t,[C,T]=Ve.useState([]),A=Ve.useMemo(()=>Array.from(new Set([s].concat(C.filter(Q=>Q.position).map(Q=>Q.position)))),[C,s]),[N,I]=Ve.useState([]),[j,L]=Ve.useState(!1),[D,H]=Ve.useState(!1),[O,K]=Ve.useState(d!=="system"?d:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),U=Ve.useRef(null),W=i.join("+").replace(/Key/g,"").replace(/Digit/g,""),B=Ve.useRef(null),ne=Ve.useRef(!1),V=Ve.useCallback(Q=>{T(ee=>{var re;return(re=ee.find(de=>de.id===Q.id))!=null&&re.delete||Do.dismiss(Q.id),ee.filter(({id:de})=>de!==Q.id)})},[]);return Ve.useEffect(()=>Do.subscribe(Q=>{if(Q.dismiss){requestAnimationFrame(()=>{T(ee=>ee.map(re=>re.id===Q.id?{...re,delete:!0}:re))});return}setTimeout(()=>{PE.flushSync(()=>{T(ee=>{const re=ee.findIndex(de=>de.id===Q.id);return re!==-1?[...ee.slice(0,re),{...ee[re],...Q},...ee.slice(re+1)]:[Q,...ee]})})})}),[C]),Ve.useEffect(()=>{if(d!=="system"){K(d);return}if(d==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?K("dark"):K("light")),typeof window>"u")return;const Q=window.matchMedia("(prefers-color-scheme: dark)");try{Q.addEventListener("change",({matches:ee})=>{K(ee?"dark":"light")})}catch{Q.addListener(({matches:re})=>{try{K(re?"dark":"light")}catch(de){console.error(de)}})}},[d]),Ve.useEffect(()=>{C.length<=1&&L(!1)},[C]),Ve.useEffect(()=>{const Q=ee=>{var re;if(i.every(De=>ee[De]||ee.code===De)){var me;L(!0),(me=U.current)==null||me.focus()}ee.code==="Escape"&&(document.activeElement===U.current||(re=U.current)!=null&&re.contains(document.activeElement))&&L(!1)};return document.addEventListener("keydown",Q),()=>document.removeEventListener("keydown",Q)},[i]),Ve.useEffect(()=>{if(U.current)return()=>{B.current&&(B.current.focus({preventScroll:!0}),B.current=null,ne.current=!1)}},[U.current]),Ve.createElement("section",{ref:n,"aria-label":`${k} ${W}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},A.map((Q,ee)=>{var re;const[de,me]=Q.split("-");return C.length?Ve.createElement("ol",{key:Q,dir:x==="auto"?l$():x,tabIndex:-1,ref:U,className:l,"data-sonner-toaster":!0,"data-sonner-theme":O,"data-y-position":de,"data-lifted":j&&C.length>1&&!a,"data-x-position":me,style:{"--front-toast-height":`${((re=N[0])==null?void 0:re.height)||0}px`,"--width":`${xye}px`,"--gap":`${w}px`,...y,...Eye(c,u)},onBlur:De=>{ne.current&&!De.currentTarget.contains(De.relatedTarget)&&(ne.current=!1,B.current&&(B.current.focus({preventScroll:!0}),B.current=null))},onFocus:De=>{De.target instanceof HTMLElement&&De.target.dataset.dismissible==="false"||ne.current||(ne.current=!0,B.current=De.relatedTarget)},onMouseEnter:()=>L(!0),onMouseMove:()=>L(!0),onMouseLeave:()=>{D||L(!1)},onDragEnd:()=>L(!1),onPointerDown:De=>{De.target instanceof HTMLElement&&De.target.dataset.dismissible==="false"||H(!0)},onPointerUp:()=>H(!1)},C.filter(De=>!De.position&&ee===0||De.position===Q).map((De,je)=>{var Te,_e;return Ve.createElement(kye,{key:De.id,icons:_,index:je,toast:De,defaultRichColors:h,duration:(Te=v==null?void 0:v.duration)!=null?Te:m,className:v==null?void 0:v.className,descriptionClassName:v==null?void 0:v.descriptionClassName,invert:r,visibleToasts:b,closeButton:(_e=v==null?void 0:v.closeButton)!=null?_e:o,interacting:D,position:Q,style:v==null?void 0:v.style,unstyled:v==null?void 0:v.unstyled,classNames:v==null?void 0:v.classNames,cancelButtonStyle:v==null?void 0:v.cancelButtonStyle,actionButtonStyle:v==null?void 0:v.actionButtonStyle,closeButtonAriaLabel:v==null?void 0:v.closeButtonAriaLabel,removeToast:V,toasts:C.filter(Ue=>Ue.position==De.position),heights:N.filter(Ue=>Ue.position==De.position),setHeights:I,expandByDefault:a,gap:w,expanded:j,swipeDirections:t.swipeDirections})})):null}))}),nn=Co(ko((e,t)=>({interactions:[],currentConversationId:null,streamingInteractionIds:[],activeStreamBuffers:{},activeReasoningBuffers:{},error:null,status:"idle",loadInteractions:async n=>{if(t().currentConversationId!==n){console.warn(`InteractionStore: loadInteractions called for ${n}, but current is ${t().currentConversationId}. Aborting load.`);return}const r=t().status;e({status:"loading",error:null,interactions:[],streamingInteractionIds:[],activeStreamBuffers:{},activeReasoningBuffers:{}}),r!=="loading"&&Ce.emit(xn.statusChanged,{status:"loading"});try{const s=await yt.loadInteractionsForConversation(n);s.sort((l,c)=>l.index-c.index);const i=t().interactions.filter(l=>l.conversationId===n),a=new Set(s.map(l=>l.id)),o=[...s,...i.filter(l=>!a.has(l.id))];o.sort((l,c)=>l.index-c.index),t().currentConversationId===n?(e({interactions:o,status:"idle"}),Ce.emit(xn.loaded,{conversationId:n,interactions:o}),Ce.emit(xn.statusChanged,{status:"idle"})):console.warn(`InteractionStore: loadInteractions for ${n} completed, but currentConversationId changed during fetch to ${t().currentConversationId}. Discarding.`)}catch(s){console.error(`InteractionStore: Error loading interactions for ${n}`,s),t().currentConversationId===n&&(e({error:"Failed load interactions",status:"error"}),Ce.emit(xn.statusChanged,{status:"error"}),Ce.emit(xn.errorChanged,{error:"Failed load interactions"}))}},_addInteractionToState:n=>{e(r=>{if(r.currentConversationId!==n.conversationId){console.warn(`InteractionStore: Attempted to add interaction for ${n.conversationId} but current is ${r.currentConversationId}. Skipping.`);return}if(!r.interactions.some(s=>s.id===n.id))r.interactions.push(n),r.interactions.sort((s,i)=>s.index-i.index);else{const s=r.interactions.findIndex(i=>i.id===n.id);s!==-1&&(r.interactions[s]={...r.interactions[s],...n})}}),Ce.emit(xn.added,{interaction:n})},_updateInteractionInState:(n,r)=>{e(s=>{const i=s.interactions.findIndex(a=>a.id===n);if(i!==-1){if(s.currentConversationId!==s.interactions[i].conversationId){console.warn(`InteractionStore: Attempted to update interaction ${n} which is not in the current conversation ${s.currentConversationId}. Skipping.`);return}const a=s.interactions[i];let o={...a.metadata||{}};r.metadata&&(o={...o,...r.metadata},r.metadata.toolCalls!==void 0&&Array.isArray(r.metadata.toolCalls)&&(o.toolCalls=[...r.metadata.toolCalls]),r.metadata.toolResults!==void 0&&Array.isArray(r.metadata.toolResults)&&(o.toolResults=[...r.metadata.toolResults]),r.metadata.reasoning!==void 0&&(o.reasoning=r.metadata.reasoning));const l={...a,...r,metadata:o};"response"in r&&(l.response=r.response),"rating"in r&&(l.rating=r.rating),s.interactions[i]=l}}),Ce.emit(xn.updated,{interactionId:n,updates:r})},appendInteractionResponseChunk:(n,r)=>{e(s=>{var i;s.streamingInteractionIds.includes(n)&&s.currentConversationId===((i=s.interactions.find(a=>a.id===n))==null?void 0:i.conversationId)&&(s.activeStreamBuffers[n]=(s.activeStreamBuffers[n]||"")+r)}),Ce.emit(xn.activeStreamBuffersChanged,{buffers:t().activeStreamBuffers})},appendReasoningChunk:(n,r)=>{e(s=>{var i;s.streamingInteractionIds.includes(n)&&s.currentConversationId===((i=s.interactions.find(a=>a.id===n))==null?void 0:i.conversationId)&&(s.activeReasoningBuffers[n]=(s.activeReasoningBuffers[n]||"")+r)}),Ce.emit(xn.activeReasoningBuffersChanged,{buffers:t().activeReasoningBuffers})},setActiveStreamBuffer:(n,r)=>{e(s=>{s.streamingInteractionIds.includes(n)&&(s.activeStreamBuffers[n]=r)}),Ce.emit(xn.activeStreamBuffersChanged,{buffers:t().activeStreamBuffers})},appendStreamBuffer:(n,r)=>{e(s=>{s.streamingInteractionIds.includes(n)&&(s.activeStreamBuffers[n]===void 0?s.activeStreamBuffers[n]=r:s.activeStreamBuffers[n]+=r)}),Ce.emit(xn.activeStreamBuffersChanged,{buffers:t().activeStreamBuffers})},removeActiveStreamBuffer:n=>{e(r=>{delete r.activeStreamBuffers[n]})},_removeInteractionFromState:n=>{e(r=>{r.interactions=r.interactions.filter(s=>s.id!==n)})},rateInteraction:async(n,r)=>{const s=t().interactions.find(i=>i.id===n);if(s&&t().currentConversationId===s.conversationId){t()._updateInteractionInState(n,{rating:r});try{await yt.saveInteraction({...s,rating:r}),Ce.emit(xn.interactionRated,{interactionId:n,rating:r})}catch{t()._updateInteractionInState(n,{rating:s.rating}),ke.error("Failed to save rating.")}}},setCurrentConversationId:async n=>{const r=t().currentConversationId;if(r===n){n&&t().interactions.length===0&&t().status!=="loading"?(console.warn(`InteractionStore: Current ID ${n} matches, but no interactions. Forcing reload.`),await t().loadInteractions(n)):console.log(`InteractionStore: setCurrentConversationId called with the same ID (${n}). No change needed or already handled.`);return}console.log(`InteractionStore: Setting current conversation ID from ${r} to ${n}`),e({currentConversationId:n}),Ce.emit(xn.currentConversationIdChanged,{conversationId:n}),n?await t().loadInteractions(n):t().clearInteractions()},clearInteractions:()=>{const n=t().status;e({interactions:[],streamingInteractionIds:[],activeStreamBuffers:{},activeReasoningBuffers:{},status:"idle",error:null,currentConversationId:null}),n!=="idle"&&Ce.emit(xn.statusChanged,{status:"idle"}),Ce.emit(xn.currentConversationIdChanged,{conversationId:null})},setError:n=>{const r=t().status;let s="idle";e(i=>{i.error=n,n?(s="error",i.status="error"):i.status==="error"?(s=i.streamingInteractionIds.length>0?"streaming":"idle",i.status=s):s=i.status}),r!==s&&Ce.emit(xn.statusChanged,{status:s}),Ce.emit(xn.errorChanged,{error:n})},setStatus:n=>{t().status!==n&&(e({status:n}),Ce.emit(xn.statusChanged,{status:n}))},_addStreamingId:n=>{let r=!1;e(s=>{s.streamingInteractionIds.includes(n)||(s.streamingInteractionIds.push(n),s.activeStreamBuffers[n]="",s.activeReasoningBuffers[n]="",s.streamingInteractionIds.length===1&&(s.status="streaming",r=!0),s.error=null)}),r&&Ce.emit(xn.statusChanged,{status:"streaming"}),Ce.emit(xn.streamingIdsChanged,{streamingIds:t().streamingInteractionIds})},_removeStreamingId:n=>{let r=!1;e(s=>{const i=s.streamingInteractionIds.indexOf(n);i!==-1&&(s.streamingInteractionIds.splice(i,1),delete s.activeStreamBuffers[n],delete s.activeReasoningBuffers[n],s.streamingInteractionIds.length===0&&s.status==="streaming"&&(s.status=s.error?"error":"idle",r=!0))}),r&&Ce.emit(xn.statusChanged,{status:t().status}),Ce.emit(xn.streamingIdsChanged,{streamingIds:t().streamingInteractionIds})},getRegisteredActionHandlers:()=>{const n="interactionStore",r=t();return[{eventName:xn.loadInteractionsRequest,handler:s=>r.loadInteractions(s.conversationId),storeId:n},{eventName:xn.rateInteractionRequest,handler:s=>r.rateInteraction(s.interactionId,s.rating),storeId:n},{eventName:xn.setCurrentConversationIdRequest,handler:s=>r.setCurrentConversationId(s.id),storeId:n},{eventName:xn.clearInteractionsRequest,handler:()=>r.clearInteractions(),storeId:n},{eventName:xn.setErrorRequest,handler:s=>r.setError(s.error),storeId:n},{eventName:xn.setStatusRequest,handler:s=>r.setStatus(s.status),storeId:n}]}}))),Yl={attachedFilesChanged:"input.attached.files.changed",addAttachedFileRequest:"input.add.attached.file.request",removeAttachedFileRequest:"input.remove.attached.file.request",clearAttachedFilesRequest:"input.clear.attached.files.request"},Ph=Co(ko((e,t)=>({attachedFilesMetadata:[],addAttachedFile:n=>{let r=!1;e(s=>{if(s.attachedFilesMetadata.some(a=>a.source==="direct"&&n.source==="direct"?a.name===n.name&&a.size===n.size:a.source==="vfs"&&n.source==="vfs"?a.path===n.path:!1))console.warn(`InputStore: File "${n.name}" (source: ${n.source}) already attached. Skipping.`);else{const a={id:Nr(),...n};s.attachedFilesMetadata.push(a),r=!0}}),r&&Ce.emit(Yl.attachedFilesChanged,{files:t().attachedFilesMetadata})},removeAttachedFile:n=>{let r=!1;e(s=>{const i=s.attachedFilesMetadata.length;s.attachedFilesMetadata=s.attachedFilesMetadata.filter(a=>a.id!==n),r=s.attachedFilesMetadata.length<i}),r&&Ce.emit(Yl.attachedFilesChanged,{files:t().attachedFilesMetadata})},clearAttachedFiles:()=>{const n=t().attachedFilesMetadata.length>0;e({attachedFilesMetadata:[]}),n&&Ce.emit(Yl.attachedFilesChanged,{files:[]})},getRegisteredActionHandlers:()=>{const n="inputStore",r=t();return[{eventName:Yl.addAttachedFileRequest,handler:s=>r.addAttachedFile(s),storeId:n},{eventName:Yl.removeAttachedFileRequest,handler:s=>r.removeAttachedFile(s.attachmentId),storeId:n},{eventName:Yl.clearAttachedFilesRequest,handler:()=>r.clearAttachedFiles(),storeId:n}]}}))),eG=new Set([".txt",".md",".markdown",".json",".js",".ts",".jsx",".tsx",".html",".htm",".css",".scss",".less",".py",".pyw",".java",".c",".cpp",".h",".hpp",".cs",".go",".php",".rb",".swift",".kt",".kts",".rs",".toml",".yaml",".yml",".xml",".sh",".bash",".zsh",".bat",".cmd",".ps1",".gitignore",".gitattributes",".env",".log",".csv",".tsv",".ini",".cfg",".conf",".sql",".dockerfile","dockerfile",".mod",".sum",".csproj",".vbproj",".fsproj",".sln",".props",".targets",".gradle",".kts",".pom",".rst",".tex",".bib",".r",".rmd",".pl",".pm",".lua",".dart",".diff",".patch",".applescript",".properties",".http",".rest",".tf",".tfvars",".hcl",".rego",".liquid",".erb",".jinja",".j2",".mustache",".hbs",".pug",".haml",".slim",".svelte",".vue",".astro",".svg",".webmanifest",".vtt",".srt",".sbv",".ass",".ssa",".config",".mdx",".nfo",".diz"]);Object.freeze(eG);const ow=(e,t)=>{if(!e)return!1;const n=e.toLowerCase();if(t!=null&&t.startsWith("text/")||t==="application/json"||t==="application/xml"||t==="application/javascript"||t==="application/typescript"||t==="application/yaml"||t==="application/toml"||t==="application/sql"||t==="application/x-sh"||t==="application/x-httpd-php"||t==="application/x-python"||t==="application/x-ruby"||t==="image/svg+xml"||n.split(".").length<2)return!0;const s="."+n.split(".").pop();return eG.has(s)};var tG="vercel.ai.error",Aye=Symbol.for(tG),nG,Rye=class rG extends Error{constructor({name:t,message:n,cause:r}){super(n),this[nG]=!0,this.name=t,this.cause=r}static isInstance(t){return rG.hasMarker(t,tG)}static hasMarker(t,n){const r=Symbol.for(n);return t!=null&&typeof t=="object"&&r in t&&typeof t[r]=="boolean"&&t[r]===!0}};nG=Aye;var sr=Rye,sG="AI_APICallError",iG=`vercel.ai.error.${sG}`,Nye=Symbol.for(iG),aG,Xl=class extends sr{constructor({message:e,url:t,requestBodyValues:n,statusCode:r,responseHeaders:s,responseBody:i,cause:a,isRetryable:o=r!=null&&(r===408||r===409||r===429||r>=500),data:l}){super({name:sG,message:e,cause:a}),this[aG]=!0,this.url=t,this.requestBodyValues=n,this.statusCode=r,this.responseHeaders=s,this.responseBody=i,this.isRetryable=o,this.data=l}static isInstance(e){return sr.hasMarker(e,iG)}};aG=Nye;var oG="AI_EmptyResponseBodyError",lG=`vercel.ai.error.${oG}`,Iye=Symbol.for(lG),cG,uG=class extends sr{constructor({message:e="Empty response body"}={}){super({name:oG,message:e}),this[cG]=!0}static isInstance(e){return sr.hasMarker(e,lG)}};cG=Iye;function T1(e){return e==null?"unknown error":typeof e=="string"?e:e instanceof Error?e.message:JSON.stringify(e)}var dG="AI_InvalidArgumentError",fG=`vercel.ai.error.${dG}`,Mye=Symbol.for(fG),hG,pG=class extends sr{constructor({message:t,cause:n,argument:r}){super({name:dG,message:t,cause:n}),this[hG]=!0,this.argument=r}static isInstance(t){return sr.hasMarker(t,fG)}};hG=Mye;var mG="AI_InvalidPromptError",gG=`vercel.ai.error.${mG}`,jye=Symbol.for(gG),yG,Ic=class extends sr{constructor({prompt:e,message:t,cause:n}){super({name:mG,message:`Invalid prompt: ${t}`,cause:n}),this[yG]=!0,this.prompt=e}static isInstance(e){return sr.hasMarker(e,gG)}};yG=jye;var bG="AI_InvalidResponseDataError",vG=`vercel.ai.error.${bG}`,Pye=Symbol.for(vG),xG,Yd=class extends sr{constructor({data:e,message:t=`Invalid response data: ${JSON.stringify(e)}.`}){super({name:bG,message:t}),this[xG]=!0,this.data=e}static isInstance(e){return sr.hasMarker(e,vG)}};xG=Pye;var wG="AI_JSONParseError",SG=`vercel.ai.error.${wG}`,Oye=Symbol.for(SG),_G,k2=class extends sr{constructor({text:e,cause:t}){super({name:wG,message:`JSON parsing failed: Text: ${e}.
Error message: ${T1(t)}`,cause:t}),this[_G]=!0,this.text=e}static isInstance(e){return sr.hasMarker(e,SG)}};_G=Oye;var CG="AI_LoadAPIKeyError",kG=`vercel.ai.error.${CG}`,Dye=Symbol.for(kG),EG,V_=class extends sr{constructor({message:e}){super({name:CG,message:e}),this[EG]=!0}static isInstance(e){return sr.hasMarker(e,kG)}};EG=Dye;var TG="AI_TooManyEmbeddingValuesForCallError",AG=`vercel.ai.error.${TG}`,Fye=Symbol.for(AG),RG,OE=class extends sr{constructor(e){super({name:TG,message:`Too many values for a single embedding call. The ${e.provider} model "${e.modelId}" can only embed up to ${e.maxEmbeddingsPerCall} values per call, but ${e.values.length} values were provided.`}),this[RG]=!0,this.provider=e.provider,this.modelId=e.modelId,this.maxEmbeddingsPerCall=e.maxEmbeddingsPerCall,this.values=e.values}static isInstance(e){return sr.hasMarker(e,AG)}};RG=Fye;var NG="AI_TypeValidationError",IG=`vercel.ai.error.${NG}`,Lye=Symbol.for(IG),MG,Bye=class v3 extends sr{constructor({value:t,cause:n}){super({name:NG,message:`Type validation failed: Value: ${JSON.stringify(t)}.
Error message: ${T1(n)}`,cause:n}),this[MG]=!0,this.value=t}static isInstance(t){return sr.hasMarker(t,IG)}static wrap({value:t,cause:n}){return v3.isInstance(n)&&n.value===t?n:new v3({value:t,cause:n})}};MG=Lye;var E2=Bye,jG="AI_UnsupportedFunctionalityError",PG=`vercel.ai.error.${jG}`,$ye=Symbol.for(PG),OG,gr=class extends sr{constructor({functionality:e,message:t=`'${e}' functionality not supported.`}){super({name:jG,message:t}),this[OG]=!0,this.functionality=e}static isInstance(e){return sr.hasMarker(e,PG)}};OG=$ye;let zye=(e,t=21)=>(n=t)=>{let r="",s=n|0;for(;s--;)r+=e[Math.random()*e.length|0];return r};var aO={},DE={};DE.byteLength=Vye;DE.toByteArray=Hye;DE.fromByteArray=Yye;var ku=[],Hl=[],Uye=typeof Uint8Array<"u"?Uint8Array:Array,IN="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var c0=0,qye=IN.length;c0<qye;++c0)ku[c0]=IN[c0],Hl[IN.charCodeAt(c0)]=c0;Hl[45]=62;Hl[95]=63;function DG(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");n===-1&&(n=t);var r=n===t?0:4-n%4;return[n,r]}function Vye(e){var t=DG(e),n=t[0],r=t[1];return(n+r)*3/4-r}function Wye(e,t,n){return(t+n)*3/4-n}function Hye(e){var t,n=DG(e),r=n[0],s=n[1],i=new Uye(Wye(e,r,s)),a=0,o=s>0?r-4:r,l;for(l=0;l<o;l+=4)t=Hl[e.charCodeAt(l)]<<18|Hl[e.charCodeAt(l+1)]<<12|Hl[e.charCodeAt(l+2)]<<6|Hl[e.charCodeAt(l+3)],i[a++]=t>>16&255,i[a++]=t>>8&255,i[a++]=t&255;return s===2&&(t=Hl[e.charCodeAt(l)]<<2|Hl[e.charCodeAt(l+1)]>>4,i[a++]=t&255),s===1&&(t=Hl[e.charCodeAt(l)]<<10|Hl[e.charCodeAt(l+1)]<<4|Hl[e.charCodeAt(l+2)]>>2,i[a++]=t>>8&255,i[a++]=t&255),i}function Gye(e){return ku[e>>18&63]+ku[e>>12&63]+ku[e>>6&63]+ku[e&63]}function Kye(e,t,n){for(var r,s=[],i=t;i<n;i+=3)r=(e[i]<<16&16711680)+(e[i+1]<<8&65280)+(e[i+2]&255),s.push(Gye(r));return s.join("")}function Yye(e){for(var t,n=e.length,r=n%3,s=[],i=16383,a=0,o=n-r;a<o;a+=i)s.push(Kye(e,a,a+i>o?o:a+i));return r===1?(t=e[n-1],s.push(ku[t>>2]+ku[t<<4&63]+"==")):r===2&&(t=(e[n-2]<<8)+e[n-1],s.push(ku[t>>10]+ku[t>>4&63]+ku[t<<2&63]+"=")),s.join("")}var oO={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */oO.read=function(e,t,n,r,s){var i,a,o=s*8-r-1,l=(1<<o)-1,c=l>>1,u=-7,d=n?s-1:0,h=n?-1:1,m=e[t+d];for(d+=h,i=m&(1<<-u)-1,m>>=-u,u+=o;u>0;i=i*256+e[t+d],d+=h,u-=8);for(a=i&(1<<-u)-1,i>>=-u,u+=r;u>0;a=a*256+e[t+d],d+=h,u-=8);if(i===0)i=1-c;else{if(i===l)return a?NaN:(m?-1:1)*(1/0);a=a+Math.pow(2,r),i=i-c}return(m?-1:1)*a*Math.pow(2,i-r)};oO.write=function(e,t,n,r,s,i){var a,o,l,c=i*8-s-1,u=(1<<c)-1,d=u>>1,h=s===23?Math.pow(2,-24)-Math.pow(2,-77):0,m=r?0:i-1,y=r?1:-1,b=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(o=isNaN(t)?1:0,a=u):(a=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-a))<1&&(a--,l*=2),a+d>=1?t+=h/l:t+=h*Math.pow(2,1-d),t*l>=2&&(a++,l/=2),a+d>=u?(o=0,a=u):a+d>=1?(o=(t*l-1)*Math.pow(2,s),a=a+d):(o=t*Math.pow(2,d-1)*Math.pow(2,s),a=0));s>=8;e[n+m]=o&255,m+=y,o/=256,s-=8);for(a=a<<s|o,c+=s;c>0;e[n+m]=a&255,m+=y,a/=256,c-=8);e[n+m-y]|=b*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(e){const t=DE,n=oO,r=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=u,e.SlowBuffer=C,e.INSPECT_MAX_BYTES=50;const s=2147483647;e.kMaxLength=s;const{Uint8Array:i,ArrayBuffer:a,SharedArrayBuffer:o}=globalThis;u.TYPED_ARRAY_SUPPORT=l(),!u.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function l(){try{const we=new i(1),F={foo:function(){return 42}};return Object.setPrototypeOf(F,i.prototype),Object.setPrototypeOf(we,F),we.foo()===42}catch{return!1}}Object.defineProperty(u.prototype,"parent",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.buffer}}),Object.defineProperty(u.prototype,"offset",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.byteOffset}});function c(we){if(we>s)throw new RangeError('The value "'+we+'" is invalid for option "size"');const F=new i(we);return Object.setPrototypeOf(F,u.prototype),F}function u(we,F,X){if(typeof we=="number"){if(typeof F=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return y(we)}return d(we,F,X)}u.poolSize=8192;function d(we,F,X){if(typeof we=="string")return b(we,F);if(a.isView(we))return x(we);if(we==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof we);if(ut(we,a)||we&&ut(we.buffer,a)||typeof o<"u"&&(ut(we,o)||we&&ut(we.buffer,o)))return w(we,F,X);if(typeof we=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const be=we.valueOf&&we.valueOf();if(be!=null&&be!==we)return u.from(be,F,X);const Ee=_(we);if(Ee)return Ee;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof we[Symbol.toPrimitive]=="function")return u.from(we[Symbol.toPrimitive]("string"),F,X);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof we)}u.from=function(we,F,X){return d(we,F,X)},Object.setPrototypeOf(u.prototype,i.prototype),Object.setPrototypeOf(u,i);function h(we){if(typeof we!="number")throw new TypeError('"size" argument must be of type number');if(we<0)throw new RangeError('The value "'+we+'" is invalid for option "size"')}function m(we,F,X){return h(we),we<=0?c(we):F!==void 0?typeof X=="string"?c(we).fill(F,X):c(we).fill(F):c(we)}u.alloc=function(we,F,X){return m(we,F,X)};function y(we){return h(we),c(we<0?0:k(we)|0)}u.allocUnsafe=function(we){return y(we)},u.allocUnsafeSlow=function(we){return y(we)};function b(we,F){if((typeof F!="string"||F==="")&&(F="utf8"),!u.isEncoding(F))throw new TypeError("Unknown encoding: "+F);const X=T(we,F)|0;let be=c(X);const Ee=be.write(we,F);return Ee!==X&&(be=be.slice(0,Ee)),be}function v(we){const F=we.length<0?0:k(we.length)|0,X=c(F);for(let be=0;be<F;be+=1)X[be]=we[be]&255;return X}function x(we){if(ut(we,i)){const F=new i(we);return w(F.buffer,F.byteOffset,F.byteLength)}return v(we)}function w(we,F,X){if(F<0||we.byteLength<F)throw new RangeError('"offset" is outside of buffer bounds');if(we.byteLength<F+(X||0))throw new RangeError('"length" is outside of buffer bounds');let be;return F===void 0&&X===void 0?be=new i(we):X===void 0?be=new i(we,F):be=new i(we,F,X),Object.setPrototypeOf(be,u.prototype),be}function _(we){if(u.isBuffer(we)){const F=k(we.length)|0,X=c(F);return X.length===0||we.copy(X,0,0,F),X}if(we.length!==void 0)return typeof we.length!="number"||Pt(we.length)?c(0):v(we);if(we.type==="Buffer"&&Array.isArray(we.data))return v(we.data)}function k(we){if(we>=s)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s.toString(16)+" bytes");return we|0}function C(we){return+we!=we&&(we=0),u.alloc(+we)}u.isBuffer=function(F){return F!=null&&F._isBuffer===!0&&F!==u.prototype},u.compare=function(F,X){if(ut(F,i)&&(F=u.from(F,F.offset,F.byteLength)),ut(X,i)&&(X=u.from(X,X.offset,X.byteLength)),!u.isBuffer(F)||!u.isBuffer(X))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(F===X)return 0;let be=F.length,Ee=X.length;for(let ge=0,Ae=Math.min(be,Ee);ge<Ae;++ge)if(F[ge]!==X[ge]){be=F[ge],Ee=X[ge];break}return be<Ee?-1:Ee<be?1:0},u.isEncoding=function(F){switch(String(F).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(F,X){if(!Array.isArray(F))throw new TypeError('"list" argument must be an Array of Buffers');if(F.length===0)return u.alloc(0);let be;if(X===void 0)for(X=0,be=0;be<F.length;++be)X+=F[be].length;const Ee=u.allocUnsafe(X);let ge=0;for(be=0;be<F.length;++be){let Ae=F[be];if(ut(Ae,i))ge+Ae.length>Ee.length?(u.isBuffer(Ae)||(Ae=u.from(Ae)),Ae.copy(Ee,ge)):i.prototype.set.call(Ee,Ae,ge);else if(u.isBuffer(Ae))Ae.copy(Ee,ge);else throw new TypeError('"list" argument must be an Array of Buffers');ge+=Ae.length}return Ee};function T(we,F){if(u.isBuffer(we))return we.length;if(a.isView(we)||ut(we,a))return we.byteLength;if(typeof we!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof we);const X=we.length,be=arguments.length>2&&arguments[2]===!0;if(!be&&X===0)return 0;let Ee=!1;for(;;)switch(F){case"ascii":case"latin1":case"binary":return X;case"utf8":case"utf-8":return Ie(we).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return X*2;case"hex":return X>>>1;case"base64":return ct(we).length;default:if(Ee)return be?-1:Ie(we).length;F=(""+F).toLowerCase(),Ee=!0}}u.byteLength=T;function A(we,F,X){let be=!1;if((F===void 0||F<0)&&(F=0),F>this.length||((X===void 0||X>this.length)&&(X=this.length),X<=0)||(X>>>=0,F>>>=0,X<=F))return"";for(we||(we="utf8");;)switch(we){case"hex":return ee(this,F,X);case"utf8":case"utf-8":return W(this,F,X);case"ascii":return V(this,F,X);case"latin1":case"binary":return Q(this,F,X);case"base64":return U(this,F,X);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return re(this,F,X);default:if(be)throw new TypeError("Unknown encoding: "+we);we=(we+"").toLowerCase(),be=!0}}u.prototype._isBuffer=!0;function N(we,F,X){const be=we[F];we[F]=we[X],we[X]=be}u.prototype.swap16=function(){const F=this.length;if(F%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let X=0;X<F;X+=2)N(this,X,X+1);return this},u.prototype.swap32=function(){const F=this.length;if(F%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let X=0;X<F;X+=4)N(this,X,X+3),N(this,X+1,X+2);return this},u.prototype.swap64=function(){const F=this.length;if(F%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let X=0;X<F;X+=8)N(this,X,X+7),N(this,X+1,X+6),N(this,X+2,X+5),N(this,X+3,X+4);return this},u.prototype.toString=function(){const F=this.length;return F===0?"":arguments.length===0?W(this,0,F):A.apply(this,arguments)},u.prototype.toLocaleString=u.prototype.toString,u.prototype.equals=function(F){if(!u.isBuffer(F))throw new TypeError("Argument must be a Buffer");return this===F?!0:u.compare(this,F)===0},u.prototype.inspect=function(){let F="";const X=e.INSPECT_MAX_BYTES;return F=this.toString("hex",0,X).replace(/(.{2})/g,"$1 ").trim(),this.length>X&&(F+=" ... "),"<Buffer "+F+">"},r&&(u.prototype[r]=u.prototype.inspect),u.prototype.compare=function(F,X,be,Ee,ge){if(ut(F,i)&&(F=u.from(F,F.offset,F.byteLength)),!u.isBuffer(F))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof F);if(X===void 0&&(X=0),be===void 0&&(be=F?F.length:0),Ee===void 0&&(Ee=0),ge===void 0&&(ge=this.length),X<0||be>F.length||Ee<0||ge>this.length)throw new RangeError("out of range index");if(Ee>=ge&&X>=be)return 0;if(Ee>=ge)return-1;if(X>=be)return 1;if(X>>>=0,be>>>=0,Ee>>>=0,ge>>>=0,this===F)return 0;let Ae=ge-Ee,le=be-X;const ft=Math.min(Ae,le),et=this.slice(Ee,ge),$=F.slice(X,be);for(let qe=0;qe<ft;++qe)if(et[qe]!==$[qe]){Ae=et[qe],le=$[qe];break}return Ae<le?-1:le<Ae?1:0};function I(we,F,X,be,Ee){if(we.length===0)return-1;if(typeof X=="string"?(be=X,X=0):X>2147483647?X=2147483647:X<-2147483648&&(X=-2147483648),X=+X,Pt(X)&&(X=Ee?0:we.length-1),X<0&&(X=we.length+X),X>=we.length){if(Ee)return-1;X=we.length-1}else if(X<0)if(Ee)X=0;else return-1;if(typeof F=="string"&&(F=u.from(F,be)),u.isBuffer(F))return F.length===0?-1:j(we,F,X,be,Ee);if(typeof F=="number")return F=F&255,typeof i.prototype.indexOf=="function"?Ee?i.prototype.indexOf.call(we,F,X):i.prototype.lastIndexOf.call(we,F,X):j(we,[F],X,be,Ee);throw new TypeError("val must be string, number or Buffer")}function j(we,F,X,be,Ee){let ge=1,Ae=we.length,le=F.length;if(be!==void 0&&(be=String(be).toLowerCase(),be==="ucs2"||be==="ucs-2"||be==="utf16le"||be==="utf-16le")){if(we.length<2||F.length<2)return-1;ge=2,Ae/=2,le/=2,X/=2}function ft($,qe){return ge===1?$[qe]:$.readUInt16BE(qe*ge)}let et;if(Ee){let $=-1;for(et=X;et<Ae;et++)if(ft(we,et)===ft(F,$===-1?0:et-$)){if($===-1&&($=et),et-$+1===le)return $*ge}else $!==-1&&(et-=et-$),$=-1}else for(X+le>Ae&&(X=Ae-le),et=X;et>=0;et--){let $=!0;for(let qe=0;qe<le;qe++)if(ft(we,et+qe)!==ft(F,qe)){$=!1;break}if($)return et}return-1}u.prototype.includes=function(F,X,be){return this.indexOf(F,X,be)!==-1},u.prototype.indexOf=function(F,X,be){return I(this,F,X,be,!0)},u.prototype.lastIndexOf=function(F,X,be){return I(this,F,X,be,!1)};function L(we,F,X,be){X=Number(X)||0;const Ee=we.length-X;be?(be=Number(be),be>Ee&&(be=Ee)):be=Ee;const ge=F.length;be>ge/2&&(be=ge/2);let Ae;for(Ae=0;Ae<be;++Ae){const le=parseInt(F.substr(Ae*2,2),16);if(Pt(le))return Ae;we[X+Ae]=le}return Ae}function D(we,F,X,be){return At(Ie(F,we.length-X),we,X,be)}function H(we,F,X,be){return At(Be(F),we,X,be)}function O(we,F,X,be){return At(ct(F),we,X,be)}function K(we,F,X,be){return At(Re(F,we.length-X),we,X,be)}u.prototype.write=function(F,X,be,Ee){if(X===void 0)Ee="utf8",be=this.length,X=0;else if(be===void 0&&typeof X=="string")Ee=X,be=this.length,X=0;else if(isFinite(X))X=X>>>0,isFinite(be)?(be=be>>>0,Ee===void 0&&(Ee="utf8")):(Ee=be,be=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const ge=this.length-X;if((be===void 0||be>ge)&&(be=ge),F.length>0&&(be<0||X<0)||X>this.length)throw new RangeError("Attempt to write outside buffer bounds");Ee||(Ee="utf8");let Ae=!1;for(;;)switch(Ee){case"hex":return L(this,F,X,be);case"utf8":case"utf-8":return D(this,F,X,be);case"ascii":case"latin1":case"binary":return H(this,F,X,be);case"base64":return O(this,F,X,be);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return K(this,F,X,be);default:if(Ae)throw new TypeError("Unknown encoding: "+Ee);Ee=(""+Ee).toLowerCase(),Ae=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function U(we,F,X){return F===0&&X===we.length?t.fromByteArray(we):t.fromByteArray(we.slice(F,X))}function W(we,F,X){X=Math.min(we.length,X);const be=[];let Ee=F;for(;Ee<X;){const ge=we[Ee];let Ae=null,le=ge>239?4:ge>223?3:ge>191?2:1;if(Ee+le<=X){let ft,et,$,qe;switch(le){case 1:ge<128&&(Ae=ge);break;case 2:ft=we[Ee+1],(ft&192)===128&&(qe=(ge&31)<<6|ft&63,qe>127&&(Ae=qe));break;case 3:ft=we[Ee+1],et=we[Ee+2],(ft&192)===128&&(et&192)===128&&(qe=(ge&15)<<12|(ft&63)<<6|et&63,qe>2047&&(qe<55296||qe>57343)&&(Ae=qe));break;case 4:ft=we[Ee+1],et=we[Ee+2],$=we[Ee+3],(ft&192)===128&&(et&192)===128&&($&192)===128&&(qe=(ge&15)<<18|(ft&63)<<12|(et&63)<<6|$&63,qe>65535&&qe<1114112&&(Ae=qe))}}Ae===null?(Ae=65533,le=1):Ae>65535&&(Ae-=65536,be.push(Ae>>>10&1023|55296),Ae=56320|Ae&1023),be.push(Ae),Ee+=le}return ne(be)}const B=4096;function ne(we){const F=we.length;if(F<=B)return String.fromCharCode.apply(String,we);let X="",be=0;for(;be<F;)X+=String.fromCharCode.apply(String,we.slice(be,be+=B));return X}function V(we,F,X){let be="";X=Math.min(we.length,X);for(let Ee=F;Ee<X;++Ee)be+=String.fromCharCode(we[Ee]&127);return be}function Q(we,F,X){let be="";X=Math.min(we.length,X);for(let Ee=F;Ee<X;++Ee)be+=String.fromCharCode(we[Ee]);return be}function ee(we,F,X){const be=we.length;(!F||F<0)&&(F=0),(!X||X<0||X>be)&&(X=be);let Ee="";for(let ge=F;ge<X;++ge)Ee+=Ut[we[ge]];return Ee}function re(we,F,X){const be=we.slice(F,X);let Ee="";for(let ge=0;ge<be.length-1;ge+=2)Ee+=String.fromCharCode(be[ge]+be[ge+1]*256);return Ee}u.prototype.slice=function(F,X){const be=this.length;F=~~F,X=X===void 0?be:~~X,F<0?(F+=be,F<0&&(F=0)):F>be&&(F=be),X<0?(X+=be,X<0&&(X=0)):X>be&&(X=be),X<F&&(X=F);const Ee=this.subarray(F,X);return Object.setPrototypeOf(Ee,u.prototype),Ee};function de(we,F,X){if(we%1!==0||we<0)throw new RangeError("offset is not uint");if(we+F>X)throw new RangeError("Trying to access beyond buffer length")}u.prototype.readUintLE=u.prototype.readUIntLE=function(F,X,be){F=F>>>0,X=X>>>0,be||de(F,X,this.length);let Ee=this[F],ge=1,Ae=0;for(;++Ae<X&&(ge*=256);)Ee+=this[F+Ae]*ge;return Ee},u.prototype.readUintBE=u.prototype.readUIntBE=function(F,X,be){F=F>>>0,X=X>>>0,be||de(F,X,this.length);let Ee=this[F+--X],ge=1;for(;X>0&&(ge*=256);)Ee+=this[F+--X]*ge;return Ee},u.prototype.readUint8=u.prototype.readUInt8=function(F,X){return F=F>>>0,X||de(F,1,this.length),this[F]},u.prototype.readUint16LE=u.prototype.readUInt16LE=function(F,X){return F=F>>>0,X||de(F,2,this.length),this[F]|this[F+1]<<8},u.prototype.readUint16BE=u.prototype.readUInt16BE=function(F,X){return F=F>>>0,X||de(F,2,this.length),this[F]<<8|this[F+1]},u.prototype.readUint32LE=u.prototype.readUInt32LE=function(F,X){return F=F>>>0,X||de(F,4,this.length),(this[F]|this[F+1]<<8|this[F+2]<<16)+this[F+3]*16777216},u.prototype.readUint32BE=u.prototype.readUInt32BE=function(F,X){return F=F>>>0,X||de(F,4,this.length),this[F]*16777216+(this[F+1]<<16|this[F+2]<<8|this[F+3])},u.prototype.readBigUInt64LE=Ft(function(F){F=F>>>0,Me(F,"offset");const X=this[F],be=this[F+7];(X===void 0||be===void 0)&&ue(F,this.length-8);const Ee=X+this[++F]*2**8+this[++F]*2**16+this[++F]*2**24,ge=this[++F]+this[++F]*2**8+this[++F]*2**16+be*2**24;return BigInt(Ee)+(BigInt(ge)<<BigInt(32))}),u.prototype.readBigUInt64BE=Ft(function(F){F=F>>>0,Me(F,"offset");const X=this[F],be=this[F+7];(X===void 0||be===void 0)&&ue(F,this.length-8);const Ee=X*2**24+this[++F]*2**16+this[++F]*2**8+this[++F],ge=this[++F]*2**24+this[++F]*2**16+this[++F]*2**8+be;return(BigInt(Ee)<<BigInt(32))+BigInt(ge)}),u.prototype.readIntLE=function(F,X,be){F=F>>>0,X=X>>>0,be||de(F,X,this.length);let Ee=this[F],ge=1,Ae=0;for(;++Ae<X&&(ge*=256);)Ee+=this[F+Ae]*ge;return ge*=128,Ee>=ge&&(Ee-=Math.pow(2,8*X)),Ee},u.prototype.readIntBE=function(F,X,be){F=F>>>0,X=X>>>0,be||de(F,X,this.length);let Ee=X,ge=1,Ae=this[F+--Ee];for(;Ee>0&&(ge*=256);)Ae+=this[F+--Ee]*ge;return ge*=128,Ae>=ge&&(Ae-=Math.pow(2,8*X)),Ae},u.prototype.readInt8=function(F,X){return F=F>>>0,X||de(F,1,this.length),this[F]&128?(255-this[F]+1)*-1:this[F]},u.prototype.readInt16LE=function(F,X){F=F>>>0,X||de(F,2,this.length);const be=this[F]|this[F+1]<<8;return be&32768?be|4294901760:be},u.prototype.readInt16BE=function(F,X){F=F>>>0,X||de(F,2,this.length);const be=this[F+1]|this[F]<<8;return be&32768?be|4294901760:be},u.prototype.readInt32LE=function(F,X){return F=F>>>0,X||de(F,4,this.length),this[F]|this[F+1]<<8|this[F+2]<<16|this[F+3]<<24},u.prototype.readInt32BE=function(F,X){return F=F>>>0,X||de(F,4,this.length),this[F]<<24|this[F+1]<<16|this[F+2]<<8|this[F+3]},u.prototype.readBigInt64LE=Ft(function(F){F=F>>>0,Me(F,"offset");const X=this[F],be=this[F+7];(X===void 0||be===void 0)&&ue(F,this.length-8);const Ee=this[F+4]+this[F+5]*2**8+this[F+6]*2**16+(be<<24);return(BigInt(Ee)<<BigInt(32))+BigInt(X+this[++F]*2**8+this[++F]*2**16+this[++F]*2**24)}),u.prototype.readBigInt64BE=Ft(function(F){F=F>>>0,Me(F,"offset");const X=this[F],be=this[F+7];(X===void 0||be===void 0)&&ue(F,this.length-8);const Ee=(X<<24)+this[++F]*2**16+this[++F]*2**8+this[++F];return(BigInt(Ee)<<BigInt(32))+BigInt(this[++F]*2**24+this[++F]*2**16+this[++F]*2**8+be)}),u.prototype.readFloatLE=function(F,X){return F=F>>>0,X||de(F,4,this.length),n.read(this,F,!0,23,4)},u.prototype.readFloatBE=function(F,X){return F=F>>>0,X||de(F,4,this.length),n.read(this,F,!1,23,4)},u.prototype.readDoubleLE=function(F,X){return F=F>>>0,X||de(F,8,this.length),n.read(this,F,!0,52,8)},u.prototype.readDoubleBE=function(F,X){return F=F>>>0,X||de(F,8,this.length),n.read(this,F,!1,52,8)};function me(we,F,X,be,Ee,ge){if(!u.isBuffer(we))throw new TypeError('"buffer" argument must be a Buffer instance');if(F>Ee||F<ge)throw new RangeError('"value" argument is out of bounds');if(X+be>we.length)throw new RangeError("Index out of range")}u.prototype.writeUintLE=u.prototype.writeUIntLE=function(F,X,be,Ee){if(F=+F,X=X>>>0,be=be>>>0,!Ee){const le=Math.pow(2,8*be)-1;me(this,F,X,be,le,0)}let ge=1,Ae=0;for(this[X]=F&255;++Ae<be&&(ge*=256);)this[X+Ae]=F/ge&255;return X+be},u.prototype.writeUintBE=u.prototype.writeUIntBE=function(F,X,be,Ee){if(F=+F,X=X>>>0,be=be>>>0,!Ee){const le=Math.pow(2,8*be)-1;me(this,F,X,be,le,0)}let ge=be-1,Ae=1;for(this[X+ge]=F&255;--ge>=0&&(Ae*=256);)this[X+ge]=F/Ae&255;return X+be},u.prototype.writeUint8=u.prototype.writeUInt8=function(F,X,be){return F=+F,X=X>>>0,be||me(this,F,X,1,255,0),this[X]=F&255,X+1},u.prototype.writeUint16LE=u.prototype.writeUInt16LE=function(F,X,be){return F=+F,X=X>>>0,be||me(this,F,X,2,65535,0),this[X]=F&255,this[X+1]=F>>>8,X+2},u.prototype.writeUint16BE=u.prototype.writeUInt16BE=function(F,X,be){return F=+F,X=X>>>0,be||me(this,F,X,2,65535,0),this[X]=F>>>8,this[X+1]=F&255,X+2},u.prototype.writeUint32LE=u.prototype.writeUInt32LE=function(F,X,be){return F=+F,X=X>>>0,be||me(this,F,X,4,4294967295,0),this[X+3]=F>>>24,this[X+2]=F>>>16,this[X+1]=F>>>8,this[X]=F&255,X+4},u.prototype.writeUint32BE=u.prototype.writeUInt32BE=function(F,X,be){return F=+F,X=X>>>0,be||me(this,F,X,4,4294967295,0),this[X]=F>>>24,this[X+1]=F>>>16,this[X+2]=F>>>8,this[X+3]=F&255,X+4};function De(we,F,X,be,Ee){ye(F,be,Ee,we,X,7);let ge=Number(F&BigInt(4294967295));we[X++]=ge,ge=ge>>8,we[X++]=ge,ge=ge>>8,we[X++]=ge,ge=ge>>8,we[X++]=ge;let Ae=Number(F>>BigInt(32)&BigInt(4294967295));return we[X++]=Ae,Ae=Ae>>8,we[X++]=Ae,Ae=Ae>>8,we[X++]=Ae,Ae=Ae>>8,we[X++]=Ae,X}function je(we,F,X,be,Ee){ye(F,be,Ee,we,X,7);let ge=Number(F&BigInt(4294967295));we[X+7]=ge,ge=ge>>8,we[X+6]=ge,ge=ge>>8,we[X+5]=ge,ge=ge>>8,we[X+4]=ge;let Ae=Number(F>>BigInt(32)&BigInt(4294967295));return we[X+3]=Ae,Ae=Ae>>8,we[X+2]=Ae,Ae=Ae>>8,we[X+1]=Ae,Ae=Ae>>8,we[X]=Ae,X+8}u.prototype.writeBigUInt64LE=Ft(function(F,X=0){return De(this,F,X,BigInt(0),BigInt("0xffffffffffffffff"))}),u.prototype.writeBigUInt64BE=Ft(function(F,X=0){return je(this,F,X,BigInt(0),BigInt("0xffffffffffffffff"))}),u.prototype.writeIntLE=function(F,X,be,Ee){if(F=+F,X=X>>>0,!Ee){const ft=Math.pow(2,8*be-1);me(this,F,X,be,ft-1,-ft)}let ge=0,Ae=1,le=0;for(this[X]=F&255;++ge<be&&(Ae*=256);)F<0&&le===0&&this[X+ge-1]!==0&&(le=1),this[X+ge]=(F/Ae>>0)-le&255;return X+be},u.prototype.writeIntBE=function(F,X,be,Ee){if(F=+F,X=X>>>0,!Ee){const ft=Math.pow(2,8*be-1);me(this,F,X,be,ft-1,-ft)}let ge=be-1,Ae=1,le=0;for(this[X+ge]=F&255;--ge>=0&&(Ae*=256);)F<0&&le===0&&this[X+ge+1]!==0&&(le=1),this[X+ge]=(F/Ae>>0)-le&255;return X+be},u.prototype.writeInt8=function(F,X,be){return F=+F,X=X>>>0,be||me(this,F,X,1,127,-128),F<0&&(F=255+F+1),this[X]=F&255,X+1},u.prototype.writeInt16LE=function(F,X,be){return F=+F,X=X>>>0,be||me(this,F,X,2,32767,-32768),this[X]=F&255,this[X+1]=F>>>8,X+2},u.prototype.writeInt16BE=function(F,X,be){return F=+F,X=X>>>0,be||me(this,F,X,2,32767,-32768),this[X]=F>>>8,this[X+1]=F&255,X+2},u.prototype.writeInt32LE=function(F,X,be){return F=+F,X=X>>>0,be||me(this,F,X,4,2147483647,-2147483648),this[X]=F&255,this[X+1]=F>>>8,this[X+2]=F>>>16,this[X+3]=F>>>24,X+4},u.prototype.writeInt32BE=function(F,X,be){return F=+F,X=X>>>0,be||me(this,F,X,4,2147483647,-2147483648),F<0&&(F=4294967295+F+1),this[X]=F>>>24,this[X+1]=F>>>16,this[X+2]=F>>>8,this[X+3]=F&255,X+4},u.prototype.writeBigInt64LE=Ft(function(F,X=0){return De(this,F,X,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),u.prototype.writeBigInt64BE=Ft(function(F,X=0){return je(this,F,X,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function Te(we,F,X,be,Ee,ge){if(X+be>we.length)throw new RangeError("Index out of range");if(X<0)throw new RangeError("Index out of range")}function _e(we,F,X,be,Ee){return F=+F,X=X>>>0,Ee||Te(we,F,X,4),n.write(we,F,X,be,23,4),X+4}u.prototype.writeFloatLE=function(F,X,be){return _e(this,F,X,!0,be)},u.prototype.writeFloatBE=function(F,X,be){return _e(this,F,X,!1,be)};function Ue(we,F,X,be,Ee){return F=+F,X=X>>>0,Ee||Te(we,F,X,8),n.write(we,F,X,be,52,8),X+8}u.prototype.writeDoubleLE=function(F,X,be){return Ue(this,F,X,!0,be)},u.prototype.writeDoubleBE=function(F,X,be){return Ue(this,F,X,!1,be)},u.prototype.copy=function(F,X,be,Ee){if(!u.isBuffer(F))throw new TypeError("argument should be a Buffer");if(be||(be=0),!Ee&&Ee!==0&&(Ee=this.length),X>=F.length&&(X=F.length),X||(X=0),Ee>0&&Ee<be&&(Ee=be),Ee===be||F.length===0||this.length===0)return 0;if(X<0)throw new RangeError("targetStart out of bounds");if(be<0||be>=this.length)throw new RangeError("Index out of range");if(Ee<0)throw new RangeError("sourceEnd out of bounds");Ee>this.length&&(Ee=this.length),F.length-X<Ee-be&&(Ee=F.length-X+be);const ge=Ee-be;return this===F&&typeof i.prototype.copyWithin=="function"?this.copyWithin(X,be,Ee):i.prototype.set.call(F,this.subarray(be,Ee),X),ge},u.prototype.fill=function(F,X,be,Ee){if(typeof F=="string"){if(typeof X=="string"?(Ee=X,X=0,be=this.length):typeof be=="string"&&(Ee=be,be=this.length),Ee!==void 0&&typeof Ee!="string")throw new TypeError("encoding must be a string");if(typeof Ee=="string"&&!u.isEncoding(Ee))throw new TypeError("Unknown encoding: "+Ee);if(F.length===1){const Ae=F.charCodeAt(0);(Ee==="utf8"&&Ae<128||Ee==="latin1")&&(F=Ae)}}else typeof F=="number"?F=F&255:typeof F=="boolean"&&(F=Number(F));if(X<0||this.length<X||this.length<be)throw new RangeError("Out of range index");if(be<=X)return this;X=X>>>0,be=be===void 0?this.length:be>>>0,F||(F=0);let ge;if(typeof F=="number")for(ge=X;ge<be;++ge)this[ge]=F;else{const Ae=u.isBuffer(F)?F:u.from(F,Ee),le=Ae.length;if(le===0)throw new TypeError('The value "'+F+'" is invalid for argument "value"');for(ge=0;ge<be-X;++ge)this[ge+X]=Ae[ge%le]}return this};const Qe={};function We(we,F,X){Qe[we]=class extends X{constructor(){super(),Object.defineProperty(this,"message",{value:F.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${we}]`,this.stack,delete this.name}get code(){return we}set code(Ee){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:Ee,writable:!0})}toString(){return`${this.name} [${we}]: ${this.message}`}}}We("ERR_BUFFER_OUT_OF_BOUNDS",function(we){return we?`${we} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),We("ERR_INVALID_ARG_TYPE",function(we,F){return`The "${we}" argument must be of type number. Received type ${typeof F}`},TypeError),We("ERR_OUT_OF_RANGE",function(we,F,X){let be=`The value of "${we}" is out of range.`,Ee=X;return Number.isInteger(X)&&Math.abs(X)>2**32?Ee=Pe(String(X)):typeof X=="bigint"&&(Ee=String(X),(X>BigInt(2)**BigInt(32)||X<-(BigInt(2)**BigInt(32)))&&(Ee=Pe(Ee)),Ee+="n"),be+=` It must be ${F}. Received ${Ee}`,be},RangeError);function Pe(we){let F="",X=we.length;const be=we[0]==="-"?1:0;for(;X>=be+4;X-=3)F=`_${we.slice(X-3,X)}${F}`;return`${we.slice(0,X)}${F}`}function Y(we,F,X){Me(F,"offset"),(we[F]===void 0||we[F+X]===void 0)&&ue(F,we.length-(X+1))}function ye(we,F,X,be,Ee,ge){if(we>X||we<F){const Ae=typeof F=="bigint"?"n":"";let le;throw F===0||F===BigInt(0)?le=`>= 0${Ae} and < 2${Ae} ** ${(ge+1)*8}${Ae}`:le=`>= -(2${Ae} ** ${(ge+1)*8-1}${Ae}) and < 2 ** ${(ge+1)*8-1}${Ae}`,new Qe.ERR_OUT_OF_RANGE("value",le,we)}Y(be,Ee,ge)}function Me(we,F){if(typeof we!="number")throw new Qe.ERR_INVALID_ARG_TYPE(F,"number",we)}function ue(we,F,X){throw Math.floor(we)!==we?(Me(we,X),new Qe.ERR_OUT_OF_RANGE("offset","an integer",we)):F<0?new Qe.ERR_BUFFER_OUT_OF_BOUNDS:new Qe.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${F}`,we)}const oe=/[^+/0-9A-Za-z-_]/g;function se(we){if(we=we.split("=")[0],we=we.trim().replace(oe,""),we.length<2)return"";for(;we.length%4!==0;)we=we+"=";return we}function Ie(we,F){F=F||1/0;let X;const be=we.length;let Ee=null;const ge=[];for(let Ae=0;Ae<be;++Ae){if(X=we.charCodeAt(Ae),X>55295&&X<57344){if(!Ee){if(X>56319){(F-=3)>-1&&ge.push(239,191,189);continue}else if(Ae+1===be){(F-=3)>-1&&ge.push(239,191,189);continue}Ee=X;continue}if(X<56320){(F-=3)>-1&&ge.push(239,191,189),Ee=X;continue}X=(Ee-55296<<10|X-56320)+65536}else Ee&&(F-=3)>-1&&ge.push(239,191,189);if(Ee=null,X<128){if((F-=1)<0)break;ge.push(X)}else if(X<2048){if((F-=2)<0)break;ge.push(X>>6|192,X&63|128)}else if(X<65536){if((F-=3)<0)break;ge.push(X>>12|224,X>>6&63|128,X&63|128)}else if(X<1114112){if((F-=4)<0)break;ge.push(X>>18|240,X>>12&63|128,X>>6&63|128,X&63|128)}else throw new Error("Invalid code point")}return ge}function Be(we){const F=[];for(let X=0;X<we.length;++X)F.push(we.charCodeAt(X)&255);return F}function Re(we,F){let X,be,Ee;const ge=[];for(let Ae=0;Ae<we.length&&!((F-=2)<0);++Ae)X=we.charCodeAt(Ae),be=X>>8,Ee=X%256,ge.push(Ee),ge.push(be);return ge}function ct(we){return t.toByteArray(se(we))}function At(we,F,X,be){let Ee;for(Ee=0;Ee<be&&!(Ee+X>=F.length||Ee>=we.length);++Ee)F[Ee+X]=we[Ee];return Ee}function ut(we,F){return we instanceof F||we!=null&&we.constructor!=null&&we.constructor.name!=null&&we.constructor.name===F.name}function Pt(we){return we!==we}const Ut=function(){const we="0123456789abcdef",F=new Array(256);for(let X=0;X<16;++X){const be=X*16;for(let Ee=0;Ee<16;++Ee)F[be+Ee]=we[X]+we[Ee]}return F}();function Ft(we){return typeof BigInt>"u"?Yt:we}function Yt(){throw new Error("BigInt not supported")}})(aO);const un=aO.Buffer,Fs=aO.Buffer;var Vp={exports:{}},c$;function Zye(){if(c$)return Vp.exports;c$=1;const e=typeof un<"u",t=/"(?:_|\\u005[Ff])(?:_|\\u005[Ff])(?:p|\\u0070)(?:r|\\u0072)(?:o|\\u006[Ff])(?:t|\\u0074)(?:o|\\u006[Ff])(?:_|\\u005[Ff])(?:_|\\u005[Ff])"\s*:/,n=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/;function r(o,l,c){c==null&&l!==null&&typeof l=="object"&&(c=l,l=void 0),e&&un.isBuffer(o)&&(o=o.toString()),o&&o.charCodeAt(0)===65279&&(o=o.slice(1));const u=JSON.parse(o,l);if(u===null||typeof u!="object")return u;const d=c&&c.protoAction||"error",h=c&&c.constructorAction||"error";if(d==="ignore"&&h==="ignore")return u;if(d!=="ignore"&&h!=="ignore"){if(t.test(o)===!1&&n.test(o)===!1)return u}else if(d!=="ignore"&&h==="ignore"){if(t.test(o)===!1)return u}else if(n.test(o)===!1)return u;return s(u,{protoAction:d,constructorAction:h,safe:c&&c.safe})}function s(o,{protoAction:l="error",constructorAction:c="error",safe:u}={}){let d=[o];for(;d.length;){const h=d;d=[];for(const m of h){if(l!=="ignore"&&Object.prototype.hasOwnProperty.call(m,"__proto__")){if(u===!0)return null;if(l==="error")throw new SyntaxError("Object contains forbidden prototype property");delete m.__proto__}if(c!=="ignore"&&Object.prototype.hasOwnProperty.call(m,"constructor")&&Object.prototype.hasOwnProperty.call(m.constructor,"prototype")){if(u===!0)return null;if(c==="error")throw new SyntaxError("Object contains forbidden prototype property");delete m.constructor}for(const y in m){const b=m[y];b&&typeof b=="object"&&d.push(b)}}}return o}function i(o,l,c){const u=Error.stackTraceLimit;Error.stackTraceLimit=0;try{return r(o,l,c)}finally{Error.stackTraceLimit=u}}function a(o,l){const c=Error.stackTraceLimit;Error.stackTraceLimit=0;try{return r(o,l,{safe:!0})}catch{return null}finally{Error.stackTraceLimit=c}}return Vp.exports=i,Vp.exports.default=i,Vp.exports.parse=i,Vp.exports.safeParse=a,Vp.exports.scan=s,Vp.exports}var Xye=Zye();const lO=ga(Xye);var Jye={};function Ws(...e){return e.reduce((t,n)=>({...t,...n??{}}),{})}function Qye(e){return new ReadableStream({async pull(t){try{const{value:n,done:r}=await e.next();r?t.close():t.enqueue(n)}catch(n){t.error(n)}},cancel(){}})}async function ebe(e){return e==null?Promise.resolve():new Promise(t=>setTimeout(t,e))}function FG(){let e="",t,n=[],r,s;function i(l,c){if(l===""){a(c);return}if(l.startsWith(":"))return;const u=l.indexOf(":");if(u===-1){o(l,"");return}const d=l.slice(0,u),h=u+1,m=h<l.length&&l[h]===" "?l.slice(h+1):l.slice(h);o(d,m)}function a(l){n.length>0&&(l.enqueue({event:t,data:n.join(`
`),id:r,retry:s}),n=[],t=void 0,s=void 0)}function o(l,c){switch(l){case"event":t=c;break;case"data":n.push(c);break;case"id":r=c;break;case"retry":const u=parseInt(c,10);isNaN(u)||(s=u);break}}return new TransformStream({transform(l,c){const{lines:u,incompleteLine:d}=tbe(e,l);e=d;for(let h=0;h<u.length;h++)i(u[h],c)},flush(l){i(e,l),a(l)}})}function tbe(e,t){const n=[];let r=e;for(let s=0;s<t.length;){const i=t[s++];i===`
`?(n.push(r),r=""):i==="\r"?(n.push(r),r="",t[s]===`
`&&s++):r+=i}return{lines:n,incompleteLine:r}}function eb(e){const t={};return e.headers.forEach((n,r)=>{t[r]=n}),t}var Ym=({prefix:e,size:t=16,alphabet:n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",separator:r="-"}={})=>{const s=zye(n,t);if(e==null)return s;if(n.includes(r))throw new pG({argument:"separator",message:`The separator "${r}" must not be part of the alphabet "${n}".`});return i=>`${e}${r}${s(i)}`},fa=Ym();function nbe(e){return e==null?"unknown error":typeof e=="string"?e:e instanceof Error?e.message:JSON.stringify(e)}function rbe(e){return Object.fromEntries(Object.entries(e).filter(([t,n])=>n!=null))}function qC(e){return e instanceof Error&&(e.name==="AbortError"||e.name==="TimeoutError")}function cO({apiKey:e,environmentVariableName:t,apiKeyParameterName:n="apiKey",description:r}){if(typeof e=="string")return e;if(e!=null)throw new V_({message:`${r} API key must be a string.`});if(typeof Di>"u")throw new V_({message:`${r} API key is missing. Pass it using the '${n}' parameter. Environment variables is not supported in this environment.`});if(e=Jye[t],e==null)throw new V_({message:`${r} API key is missing. Pass it using the '${n}' parameter or the ${t} environment variable.`});if(typeof e!="string")throw new V_({message:`${r} API key must be a string. The value of the ${t} environment variable is not a string.`});return e}var T2=Symbol.for("vercel.ai.validator");function sbe(e){return{[T2]:!0,validate:e}}function ibe(e){return typeof e=="object"&&e!==null&&T2 in e&&e[T2]===!0&&"validate"in e}function abe(e){return ibe(e)?e:obe(e)}function obe(e){return sbe(t=>{const n=e.safeParse(t);return n.success?{success:!0,value:n.data}:{success:!1,error:n.error}})}function lbe({value:e,schema:t}){const n=tb({value:e,schema:t});if(!n.success)throw E2.wrap({value:e,cause:n.error});return n.value}function tb({value:e,schema:t}){const n=abe(t);try{if(n.validate==null)return{success:!0,value:e};const r=n.validate(e);return r.success?r:{success:!1,error:E2.wrap({value:e,cause:r.error})}}catch(r){return{success:!1,error:E2.wrap({value:e,cause:r})}}}function cbe({text:e,schema:t}){try{const n=lO.parse(e);return t==null?n:lbe({value:n,schema:t})}catch(n){throw k2.isInstance(n)||E2.isInstance(n)?n:new k2({text:e,cause:n})}}function Nm({text:e,schema:t}){try{const n=lO.parse(e);if(t==null)return{success:!0,value:n,rawValue:n};const r=tb({value:n,schema:t});return r.success?{...r,rawValue:n}:r}catch(n){return{success:!1,error:k2.isInstance(n)?n:new k2({text:e,cause:n})}}}function xm(e){try{return lO.parse(e),!0}catch{return!1}}function FE({provider:e,providerOptions:t,schema:n}){if((t==null?void 0:t[e])==null)return;const r=tb({value:t[e],schema:n});if(!r.success)throw new pG({argument:"providerOptions",message:`invalid ${e} provider options`,cause:r.error});return r.value}var ube=()=>globalThis.fetch,Hs=async({url:e,headers:t,body:n,failedResponseHandler:r,successfulResponseHandler:s,abortSignal:i,fetch:a})=>LG({url:e,headers:{"Content-Type":"application/json",...t},body:{content:JSON.stringify(n),values:n},failedResponseHandler:r,successfulResponseHandler:s,abortSignal:i,fetch:a}),dbe=async({url:e,headers:t,formData:n,failedResponseHandler:r,successfulResponseHandler:s,abortSignal:i,fetch:a})=>LG({url:e,headers:t,body:{content:n,values:Object.fromEntries(n.entries())},failedResponseHandler:r,successfulResponseHandler:s,abortSignal:i,fetch:a}),LG=async({url:e,headers:t={},body:n,successfulResponseHandler:r,failedResponseHandler:s,abortSignal:i,fetch:a=ube()})=>{try{const o=await a(e,{method:"POST",headers:rbe(t),body:n.content,signal:i}),l=eb(o);if(!o.ok){let c;try{c=await s({response:o,url:e,requestBodyValues:n.values})}catch(u){throw qC(u)||Xl.isInstance(u)?u:new Xl({message:"Failed to process error response",cause:u,statusCode:o.status,url:e,responseHeaders:l,requestBodyValues:n.values})}throw c.value}try{return await r({response:o,url:e,requestBodyValues:n.values})}catch(c){throw c instanceof Error&&(qC(c)||Xl.isInstance(c))?c:new Xl({message:"Failed to process successful response",cause:c,statusCode:o.status,url:e,responseHeaders:l,requestBodyValues:n.values})}}catch(o){if(qC(o))throw o;if(o instanceof TypeError&&o.message==="fetch failed"){const l=o.cause;if(l!=null)throw new Xl({message:`Cannot connect to API: ${l.message}`,cause:l,url:e,requestBodyValues:n.values,isRetryable:!0})}throw o}};async function x3(e){return typeof e=="function"&&(e=e()),Promise.resolve(e)}var np=({errorSchema:e,errorToMessage:t,isRetryable:n})=>async({response:r,url:s,requestBodyValues:i})=>{const a=await r.text(),o=eb(r);if(a.trim()==="")return{responseHeaders:o,value:new Xl({message:r.statusText,url:s,requestBodyValues:i,statusCode:r.status,responseHeaders:o,responseBody:a,isRetryable:n==null?void 0:n(r)})};try{const l=cbe({text:a,schema:e});return{responseHeaders:o,value:new Xl({message:t(l),url:s,requestBodyValues:i,statusCode:r.status,responseHeaders:o,responseBody:a,data:l,isRetryable:n==null?void 0:n(r,l)})}}catch{return{responseHeaders:o,value:new Xl({message:r.statusText,url:s,requestBodyValues:i,statusCode:r.status,responseHeaders:o,responseBody:a,isRetryable:n==null?void 0:n(r)})}}},rp=e=>async({response:t})=>{const n=eb(t);if(t.body==null)throw new uG({});return{responseHeaders:n,value:t.body.pipeThrough(new TextDecoderStream).pipeThrough(FG()).pipeThrough(new TransformStream({transform({data:r},s){r!=="[DONE]"&&s.enqueue(Nm({text:r,schema:e}))}}))}},Ka=e=>async({response:t,url:n,requestBodyValues:r})=>{const s=await t.text(),i=Nm({text:s,schema:e}),a=eb(t);if(!i.success)throw new Xl({message:"Invalid JSON response",cause:i.error,statusCode:t.status,responseHeaders:a,responseBody:s,url:n,requestBodyValues:r});return{responseHeaders:a,value:i.value,rawValue:i.rawValue}},fbe=()=>async({response:e,url:t,requestBodyValues:n})=>{const r=eb(e);if(!e.body)throw new Xl({message:"Response body is empty",url:t,requestBodyValues:n,statusCode:e.status,responseHeaders:r,responseBody:void 0});try{const s=await e.arrayBuffer();return{responseHeaders:r,value:new Uint8Array(s)}}catch(s){throw new Xl({message:"Failed to read response as array buffer",url:t,requestBodyValues:n,statusCode:e.status,responseHeaders:r,responseBody:void 0,cause:s})}},{btoa:hbe,atob:pbe}=globalThis;function LE(e){const t=e.replace(/-/g,"+").replace(/_/g,"/"),n=pbe(t);return Uint8Array.from(n,r=>r.codePointAt(0))}function zu(e){let t="";for(let n=0;n<e.length;n++)t+=String.fromCodePoint(e[n]);return hbe(t)}function A1(e){return e==null?void 0:e.replace(/\/$/,"")}var es;(function(e){e.assertEqual=s=>{};function t(s){}e.assertIs=t;function n(s){throw new Error}e.assertNever=n,e.arrayToEnum=s=>{const i={};for(const a of s)i[a]=a;return i},e.getValidEnumValues=s=>{const i=e.objectKeys(s).filter(o=>typeof s[s[o]]!="number"),a={};for(const o of i)a[o]=s[o];return e.objectValues(a)},e.objectValues=s=>e.objectKeys(s).map(function(i){return s[i]}),e.objectKeys=typeof Object.keys=="function"?s=>Object.keys(s):s=>{const i=[];for(const a in s)Object.prototype.hasOwnProperty.call(s,a)&&i.push(a);return i},e.find=(s,i)=>{for(const a of s)if(i(a))return a},e.isInteger=typeof Number.isInteger=="function"?s=>Number.isInteger(s):s=>typeof s=="number"&&Number.isFinite(s)&&Math.floor(s)===s;function r(s,i=" | "){return s.map(a=>typeof a=="string"?`'${a}'`:a).join(i)}e.joinValues=r,e.jsonStringifyReplacer=(s,i)=>typeof i=="bigint"?i.toString():i})(es||(es={}));var u$;(function(e){e.mergeShapes=(t,n)=>({...t,...n})})(u$||(u$={}));const wn=es.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),bh=e=>{switch(typeof e){case"undefined":return wn.undefined;case"string":return wn.string;case"number":return Number.isNaN(e)?wn.nan:wn.number;case"boolean":return wn.boolean;case"function":return wn.function;case"bigint":return wn.bigint;case"symbol":return wn.symbol;case"object":return Array.isArray(e)?wn.array:e===null?wn.null:e.then&&typeof e.then=="function"&&e.catch&&typeof e.catch=="function"?wn.promise:typeof Map<"u"&&e instanceof Map?wn.map:typeof Set<"u"&&e instanceof Set?wn.set:typeof Date<"u"&&e instanceof Date?wn.date:wn.object;default:return wn.unknown}},Jt=es.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class Vc extends Error{get errors(){return this.issues}constructor(t){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=t}format(t){const n=t||function(i){return i.message},r={_errors:[]},s=i=>{for(const a of i.issues)if(a.code==="invalid_union")a.unionErrors.map(s);else if(a.code==="invalid_return_type")s(a.returnTypeError);else if(a.code==="invalid_arguments")s(a.argumentsError);else if(a.path.length===0)r._errors.push(n(a));else{let o=r,l=0;for(;l<a.path.length;){const c=a.path[l];l===a.path.length-1?(o[c]=o[c]||{_errors:[]},o[c]._errors.push(n(a))):o[c]=o[c]||{_errors:[]},o=o[c],l++}}};return s(this),r}static assert(t){if(!(t instanceof Vc))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,es.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(t=n=>n.message){const n={},r=[];for(const s of this.issues)s.path.length>0?(n[s.path[0]]=n[s.path[0]]||[],n[s.path[0]].push(t(s))):r.push(t(s));return{formErrors:r,fieldErrors:n}}get formErrors(){return this.flatten()}}Vc.create=e=>new Vc(e);const w3=(e,t)=>{let n;switch(e.code){case Jt.invalid_type:e.received===wn.undefined?n="Required":n=`Expected ${e.expected}, received ${e.received}`;break;case Jt.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(e.expected,es.jsonStringifyReplacer)}`;break;case Jt.unrecognized_keys:n=`Unrecognized key(s) in object: ${es.joinValues(e.keys,", ")}`;break;case Jt.invalid_union:n="Invalid input";break;case Jt.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${es.joinValues(e.options)}`;break;case Jt.invalid_enum_value:n=`Invalid enum value. Expected ${es.joinValues(e.options)}, received '${e.received}'`;break;case Jt.invalid_arguments:n="Invalid function arguments";break;case Jt.invalid_return_type:n="Invalid function return type";break;case Jt.invalid_date:n="Invalid date";break;case Jt.invalid_string:typeof e.validation=="object"?"includes"in e.validation?(n=`Invalid input: must include "${e.validation.includes}"`,typeof e.validation.position=="number"&&(n=`${n} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?n=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?n=`Invalid input: must end with "${e.validation.endsWith}"`:es.assertNever(e.validation):e.validation!=="regex"?n=`Invalid ${e.validation}`:n="Invalid";break;case Jt.too_small:e.type==="array"?n=`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:e.type==="string"?n=`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:e.type==="number"?n=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="date"?n=`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:n="Invalid input";break;case Jt.too_big:e.type==="array"?n=`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:e.type==="string"?n=`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:e.type==="number"?n=`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="bigint"?n=`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="date"?n=`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:n="Invalid input";break;case Jt.custom:n="Invalid input";break;case Jt.invalid_intersection_types:n="Intersection results could not be merged";break;case Jt.not_multiple_of:n=`Number must be a multiple of ${e.multipleOf}`;break;case Jt.not_finite:n="Number must be finite";break;default:n=t.defaultError,es.assertNever(e)}return{message:n}};let mbe=w3;function gbe(){return mbe}const ybe=e=>{const{data:t,path:n,errorMaps:r,issueData:s}=e,i=[...n,...s.path||[]],a={...s,path:i};if(s.message!==void 0)return{...s,path:i,message:s.message};let o="";const l=r.filter(c=>!!c).slice().reverse();for(const c of l)o=c(a,{data:t,defaultError:o}).message;return{...s,path:i,message:o}};function pn(e,t){const n=gbe(),r=ybe({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,n,n===w3?void 0:w3].filter(s=>!!s)});e.common.issues.push(r)}class xo{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(t,n){const r=[];for(const s of n){if(s.status==="aborted")return fr;s.status==="dirty"&&t.dirty(),r.push(s.value)}return{status:t.value,value:r}}static async mergeObjectAsync(t,n){const r=[];for(const s of n){const i=await s.key,a=await s.value;r.push({key:i,value:a})}return xo.mergeObjectSync(t,r)}static mergeObjectSync(t,n){const r={};for(const s of n){const{key:i,value:a}=s;if(i.status==="aborted"||a.status==="aborted")return fr;i.status==="dirty"&&t.dirty(),a.status==="dirty"&&t.dirty(),i.value!=="__proto__"&&(typeof a.value<"u"||s.alwaysSet)&&(r[i.value]=a.value)}return{status:t.value,value:r}}}const fr=Object.freeze({status:"aborted"}),hx=e=>({status:"dirty",value:e}),dc=e=>({status:"valid",value:e}),d$=e=>e.status==="aborted",f$=e=>e.status==="dirty",hy=e=>e.status==="valid",A2=e=>typeof Promise<"u"&&e instanceof Promise;var Nn;(function(e){e.errToObj=t=>typeof t=="string"?{message:t}:t||{},e.toString=t=>typeof t=="string"?t:t==null?void 0:t.message})(Nn||(Nn={}));class Uu{constructor(t,n,r,s){this._cachedPath=[],this.parent=t,this.data=n,this._path=r,this._key=s}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const h$=(e,t)=>{if(hy(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const n=new Vc(e.common.issues);return this._error=n,this._error}}};function Ir(e){if(!e)return{};const{errorMap:t,invalid_type_error:n,required_error:r,description:s}=e;if(t&&(n||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return t?{errorMap:t,description:s}:{errorMap:(a,o)=>{const{message:l}=e;return a.code==="invalid_enum_value"?{message:l??o.defaultError}:typeof o.data>"u"?{message:l??r??o.defaultError}:a.code!=="invalid_type"?{message:o.defaultError}:{message:l??n??o.defaultError}},description:s}}class Vr{get description(){return this._def.description}_getType(t){return bh(t.data)}_getOrReturnCtx(t,n){return n||{common:t.parent.common,data:t.data,parsedType:bh(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}_processInputParams(t){return{status:new xo,ctx:{common:t.parent.common,data:t.data,parsedType:bh(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}}_parseSync(t){const n=this._parse(t);if(A2(n))throw new Error("Synchronous parse encountered promise.");return n}_parseAsync(t){const n=this._parse(t);return Promise.resolve(n)}parse(t,n){const r=this.safeParse(t,n);if(r.success)return r.data;throw r.error}safeParse(t,n){const r={common:{issues:[],async:(n==null?void 0:n.async)??!1,contextualErrorMap:n==null?void 0:n.errorMap},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:bh(t)},s=this._parseSync({data:t,path:r.path,parent:r});return h$(r,s)}"~validate"(t){var r,s;const n={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:bh(t)};if(!this["~standard"].async)try{const i=this._parseSync({data:t,path:[],parent:n});return hy(i)?{value:i.value}:{issues:n.common.issues}}catch(i){(s=(r=i==null?void 0:i.message)==null?void 0:r.toLowerCase())!=null&&s.includes("encountered")&&(this["~standard"].async=!0),n.common={issues:[],async:!0}}return this._parseAsync({data:t,path:[],parent:n}).then(i=>hy(i)?{value:i.value}:{issues:n.common.issues})}async parseAsync(t,n){const r=await this.safeParseAsync(t,n);if(r.success)return r.data;throw r.error}async safeParseAsync(t,n){const r={common:{issues:[],contextualErrorMap:n==null?void 0:n.errorMap,async:!0},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:bh(t)},s=this._parse({data:t,path:r.path,parent:r}),i=await(A2(s)?s:Promise.resolve(s));return h$(r,i)}refine(t,n){const r=s=>typeof n=="string"||typeof n>"u"?{message:n}:typeof n=="function"?n(s):n;return this._refinement((s,i)=>{const a=t(s),o=()=>i.addIssue({code:Jt.custom,...r(s)});return typeof Promise<"u"&&a instanceof Promise?a.then(l=>l?!0:(o(),!1)):a?!0:(o(),!1)})}refinement(t,n){return this._refinement((r,s)=>t(r)?!0:(s.addIssue(typeof n=="function"?n(r,s):n),!1))}_refinement(t){return new jm({schema:this,typeName:tn.ZodEffects,effect:{type:"refinement",refinement:t}})}superRefine(t){return this._refinement(t)}constructor(t){this.spa=this.safeParseAsync,this._def=t,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:n=>this["~validate"](n)}}optional(){return Pu.create(this,this._def)}nullable(){return Pm.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return ju.create(this)}promise(){return O2.create(this,this._def)}or(t){return N2.create([this,t],this._def)}and(t){return I2.create(this,t,this._def)}transform(t){return new jm({...Ir(this._def),schema:this,typeName:tn.ZodEffects,effect:{type:"transform",transform:t}})}default(t){const n=typeof t=="function"?t:()=>t;return new D2({...Ir(this._def),innerType:this,defaultValue:n,typeName:tn.ZodDefault})}brand(){return new UG({typeName:tn.ZodBranded,type:this,...Ir(this._def)})}catch(t){const n=typeof t=="function"?t:()=>t;return new F2({...Ir(this._def),innerType:this,catchValue:n,typeName:tn.ZodCatch})}describe(t){const n=this.constructor;return new n({...this._def,description:t})}pipe(t){return dO.create(this,t)}readonly(){return L2.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const bbe=/^c[^\s-]{8,}$/i,vbe=/^[0-9a-z]+$/,xbe=/^[0-9A-HJKMNP-TV-Z]{26}$/i,wbe=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,Sbe=/^[a-z0-9_-]{21}$/i,_be=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,Cbe=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,kbe=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,Ebe="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let MN;const Tbe=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Abe=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,Rbe=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,Nbe=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,Ibe=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,Mbe=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,BG="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",jbe=new RegExp(`^${BG}$`);function $G(e){let t="[0-5]\\d";e.precision?t=`${t}\\.\\d{${e.precision}}`:e.precision==null&&(t=`${t}(\\.\\d+)?`);const n=e.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${t})${n}`}function Pbe(e){return new RegExp(`^${$G(e)}$`)}function Obe(e){let t=`${BG}T${$G(e)}`;const n=[];return n.push(e.local?"Z?":"Z"),e.offset&&n.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${n.join("|")})`,new RegExp(`^${t}$`)}function Dbe(e,t){return!!((t==="v4"||!t)&&Tbe.test(e)||(t==="v6"||!t)&&Rbe.test(e))}function Fbe(e,t){if(!_be.test(e))return!1;try{const[n]=e.split("."),r=n.replace(/-/g,"+").replace(/_/g,"/").padEnd(n.length+(4-n.length%4)%4,"="),s=JSON.parse(atob(r));return!(typeof s!="object"||s===null||"typ"in s&&(s==null?void 0:s.typ)!=="JWT"||!s.alg||t&&s.alg!==t)}catch{return!1}}function Lbe(e,t){return!!((t==="v4"||!t)&&Abe.test(e)||(t==="v6"||!t)&&Nbe.test(e))}class qd extends Vr{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==wn.string){const i=this._getOrReturnCtx(t);return pn(i,{code:Jt.invalid_type,expected:wn.string,received:i.parsedType}),fr}const r=new xo;let s;for(const i of this._def.checks)if(i.kind==="min")t.data.length<i.value&&(s=this._getOrReturnCtx(t,s),pn(s,{code:Jt.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="max")t.data.length>i.value&&(s=this._getOrReturnCtx(t,s),pn(s,{code:Jt.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="length"){const a=t.data.length>i.value,o=t.data.length<i.value;(a||o)&&(s=this._getOrReturnCtx(t,s),a?pn(s,{code:Jt.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):o&&pn(s,{code:Jt.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),r.dirty())}else if(i.kind==="email")kbe.test(t.data)||(s=this._getOrReturnCtx(t,s),pn(s,{validation:"email",code:Jt.invalid_string,message:i.message}),r.dirty());else if(i.kind==="emoji")MN||(MN=new RegExp(Ebe,"u")),MN.test(t.data)||(s=this._getOrReturnCtx(t,s),pn(s,{validation:"emoji",code:Jt.invalid_string,message:i.message}),r.dirty());else if(i.kind==="uuid")wbe.test(t.data)||(s=this._getOrReturnCtx(t,s),pn(s,{validation:"uuid",code:Jt.invalid_string,message:i.message}),r.dirty());else if(i.kind==="nanoid")Sbe.test(t.data)||(s=this._getOrReturnCtx(t,s),pn(s,{validation:"nanoid",code:Jt.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid")bbe.test(t.data)||(s=this._getOrReturnCtx(t,s),pn(s,{validation:"cuid",code:Jt.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid2")vbe.test(t.data)||(s=this._getOrReturnCtx(t,s),pn(s,{validation:"cuid2",code:Jt.invalid_string,message:i.message}),r.dirty());else if(i.kind==="ulid")xbe.test(t.data)||(s=this._getOrReturnCtx(t,s),pn(s,{validation:"ulid",code:Jt.invalid_string,message:i.message}),r.dirty());else if(i.kind==="url")try{new URL(t.data)}catch{s=this._getOrReturnCtx(t,s),pn(s,{validation:"url",code:Jt.invalid_string,message:i.message}),r.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(t.data)||(s=this._getOrReturnCtx(t,s),pn(s,{validation:"regex",code:Jt.invalid_string,message:i.message}),r.dirty())):i.kind==="trim"?t.data=t.data.trim():i.kind==="includes"?t.data.includes(i.value,i.position)||(s=this._getOrReturnCtx(t,s),pn(s,{code:Jt.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),r.dirty()):i.kind==="toLowerCase"?t.data=t.data.toLowerCase():i.kind==="toUpperCase"?t.data=t.data.toUpperCase():i.kind==="startsWith"?t.data.startsWith(i.value)||(s=this._getOrReturnCtx(t,s),pn(s,{code:Jt.invalid_string,validation:{startsWith:i.value},message:i.message}),r.dirty()):i.kind==="endsWith"?t.data.endsWith(i.value)||(s=this._getOrReturnCtx(t,s),pn(s,{code:Jt.invalid_string,validation:{endsWith:i.value},message:i.message}),r.dirty()):i.kind==="datetime"?Obe(i).test(t.data)||(s=this._getOrReturnCtx(t,s),pn(s,{code:Jt.invalid_string,validation:"datetime",message:i.message}),r.dirty()):i.kind==="date"?jbe.test(t.data)||(s=this._getOrReturnCtx(t,s),pn(s,{code:Jt.invalid_string,validation:"date",message:i.message}),r.dirty()):i.kind==="time"?Pbe(i).test(t.data)||(s=this._getOrReturnCtx(t,s),pn(s,{code:Jt.invalid_string,validation:"time",message:i.message}),r.dirty()):i.kind==="duration"?Cbe.test(t.data)||(s=this._getOrReturnCtx(t,s),pn(s,{validation:"duration",code:Jt.invalid_string,message:i.message}),r.dirty()):i.kind==="ip"?Dbe(t.data,i.version)||(s=this._getOrReturnCtx(t,s),pn(s,{validation:"ip",code:Jt.invalid_string,message:i.message}),r.dirty()):i.kind==="jwt"?Fbe(t.data,i.alg)||(s=this._getOrReturnCtx(t,s),pn(s,{validation:"jwt",code:Jt.invalid_string,message:i.message}),r.dirty()):i.kind==="cidr"?Lbe(t.data,i.version)||(s=this._getOrReturnCtx(t,s),pn(s,{validation:"cidr",code:Jt.invalid_string,message:i.message}),r.dirty()):i.kind==="base64"?Ibe.test(t.data)||(s=this._getOrReturnCtx(t,s),pn(s,{validation:"base64",code:Jt.invalid_string,message:i.message}),r.dirty()):i.kind==="base64url"?Mbe.test(t.data)||(s=this._getOrReturnCtx(t,s),pn(s,{validation:"base64url",code:Jt.invalid_string,message:i.message}),r.dirty()):es.assertNever(i);return{status:r.value,value:t.data}}_regex(t,n,r){return this.refinement(s=>t.test(s),{validation:n,code:Jt.invalid_string,...Nn.errToObj(r)})}_addCheck(t){return new qd({...this._def,checks:[...this._def.checks,t]})}email(t){return this._addCheck({kind:"email",...Nn.errToObj(t)})}url(t){return this._addCheck({kind:"url",...Nn.errToObj(t)})}emoji(t){return this._addCheck({kind:"emoji",...Nn.errToObj(t)})}uuid(t){return this._addCheck({kind:"uuid",...Nn.errToObj(t)})}nanoid(t){return this._addCheck({kind:"nanoid",...Nn.errToObj(t)})}cuid(t){return this._addCheck({kind:"cuid",...Nn.errToObj(t)})}cuid2(t){return this._addCheck({kind:"cuid2",...Nn.errToObj(t)})}ulid(t){return this._addCheck({kind:"ulid",...Nn.errToObj(t)})}base64(t){return this._addCheck({kind:"base64",...Nn.errToObj(t)})}base64url(t){return this._addCheck({kind:"base64url",...Nn.errToObj(t)})}jwt(t){return this._addCheck({kind:"jwt",...Nn.errToObj(t)})}ip(t){return this._addCheck({kind:"ip",...Nn.errToObj(t)})}cidr(t){return this._addCheck({kind:"cidr",...Nn.errToObj(t)})}datetime(t){return typeof t=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:t}):this._addCheck({kind:"datetime",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,offset:(t==null?void 0:t.offset)??!1,local:(t==null?void 0:t.local)??!1,...Nn.errToObj(t==null?void 0:t.message)})}date(t){return this._addCheck({kind:"date",message:t})}time(t){return typeof t=="string"?this._addCheck({kind:"time",precision:null,message:t}):this._addCheck({kind:"time",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,...Nn.errToObj(t==null?void 0:t.message)})}duration(t){return this._addCheck({kind:"duration",...Nn.errToObj(t)})}regex(t,n){return this._addCheck({kind:"regex",regex:t,...Nn.errToObj(n)})}includes(t,n){return this._addCheck({kind:"includes",value:t,position:n==null?void 0:n.position,...Nn.errToObj(n==null?void 0:n.message)})}startsWith(t,n){return this._addCheck({kind:"startsWith",value:t,...Nn.errToObj(n)})}endsWith(t,n){return this._addCheck({kind:"endsWith",value:t,...Nn.errToObj(n)})}min(t,n){return this._addCheck({kind:"min",value:t,...Nn.errToObj(n)})}max(t,n){return this._addCheck({kind:"max",value:t,...Nn.errToObj(n)})}length(t,n){return this._addCheck({kind:"length",value:t,...Nn.errToObj(n)})}nonempty(t){return this.min(1,Nn.errToObj(t))}trim(){return new qd({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new qd({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new qd({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(t=>t.kind==="datetime")}get isDate(){return!!this._def.checks.find(t=>t.kind==="date")}get isTime(){return!!this._def.checks.find(t=>t.kind==="time")}get isDuration(){return!!this._def.checks.find(t=>t.kind==="duration")}get isEmail(){return!!this._def.checks.find(t=>t.kind==="email")}get isURL(){return!!this._def.checks.find(t=>t.kind==="url")}get isEmoji(){return!!this._def.checks.find(t=>t.kind==="emoji")}get isUUID(){return!!this._def.checks.find(t=>t.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(t=>t.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(t=>t.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(t=>t.kind==="cuid2")}get isULID(){return!!this._def.checks.find(t=>t.kind==="ulid")}get isIP(){return!!this._def.checks.find(t=>t.kind==="ip")}get isCIDR(){return!!this._def.checks.find(t=>t.kind==="cidr")}get isBase64(){return!!this._def.checks.find(t=>t.kind==="base64")}get isBase64url(){return!!this._def.checks.find(t=>t.kind==="base64url")}get minLength(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxLength(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}}qd.create=e=>new qd({checks:[],typeName:tn.ZodString,coerce:(e==null?void 0:e.coerce)??!1,...Ir(e)});function Bbe(e,t){const n=(e.toString().split(".")[1]||"").length,r=(t.toString().split(".")[1]||"").length,s=n>r?n:r,i=Number.parseInt(e.toFixed(s).replace(".","")),a=Number.parseInt(t.toFixed(s).replace(".",""));return i%a/10**s}class py extends Vr{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==wn.number){const i=this._getOrReturnCtx(t);return pn(i,{code:Jt.invalid_type,expected:wn.number,received:i.parsedType}),fr}let r;const s=new xo;for(const i of this._def.checks)i.kind==="int"?es.isInteger(t.data)||(r=this._getOrReturnCtx(t,r),pn(r,{code:Jt.invalid_type,expected:"integer",received:"float",message:i.message}),s.dirty()):i.kind==="min"?(i.inclusive?t.data<i.value:t.data<=i.value)&&(r=this._getOrReturnCtx(t,r),pn(r,{code:Jt.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?t.data>i.value:t.data>=i.value)&&(r=this._getOrReturnCtx(t,r),pn(r,{code:Jt.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="multipleOf"?Bbe(t.data,i.value)!==0&&(r=this._getOrReturnCtx(t,r),pn(r,{code:Jt.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):i.kind==="finite"?Number.isFinite(t.data)||(r=this._getOrReturnCtx(t,r),pn(r,{code:Jt.not_finite,message:i.message}),s.dirty()):es.assertNever(i);return{status:s.value,value:t.data}}gte(t,n){return this.setLimit("min",t,!0,Nn.toString(n))}gt(t,n){return this.setLimit("min",t,!1,Nn.toString(n))}lte(t,n){return this.setLimit("max",t,!0,Nn.toString(n))}lt(t,n){return this.setLimit("max",t,!1,Nn.toString(n))}setLimit(t,n,r,s){return new py({...this._def,checks:[...this._def.checks,{kind:t,value:n,inclusive:r,message:Nn.toString(s)}]})}_addCheck(t){return new py({...this._def,checks:[...this._def.checks,t]})}int(t){return this._addCheck({kind:"int",message:Nn.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:!1,message:Nn.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:!1,message:Nn.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:!0,message:Nn.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:!0,message:Nn.toString(t)})}multipleOf(t,n){return this._addCheck({kind:"multipleOf",value:t,message:Nn.toString(n)})}finite(t){return this._addCheck({kind:"finite",message:Nn.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:Nn.toString(t)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:Nn.toString(t)})}get minValue(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxValue(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}get isInt(){return!!this._def.checks.find(t=>t.kind==="int"||t.kind==="multipleOf"&&es.isInteger(t.value))}get isFinite(){let t=null,n=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(n===null||r.value>n)&&(n=r.value):r.kind==="max"&&(t===null||r.value<t)&&(t=r.value)}return Number.isFinite(n)&&Number.isFinite(t)}}py.create=e=>new py({checks:[],typeName:tn.ZodNumber,coerce:(e==null?void 0:e.coerce)||!1,...Ir(e)});class lw extends Vr{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(t){if(this._def.coerce)try{t.data=BigInt(t.data)}catch{return this._getInvalidInput(t)}if(this._getType(t)!==wn.bigint)return this._getInvalidInput(t);let r;const s=new xo;for(const i of this._def.checks)i.kind==="min"?(i.inclusive?t.data<i.value:t.data<=i.value)&&(r=this._getOrReturnCtx(t,r),pn(r,{code:Jt.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?t.data>i.value:t.data>=i.value)&&(r=this._getOrReturnCtx(t,r),pn(r,{code:Jt.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="multipleOf"?t.data%i.value!==BigInt(0)&&(r=this._getOrReturnCtx(t,r),pn(r,{code:Jt.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):es.assertNever(i);return{status:s.value,value:t.data}}_getInvalidInput(t){const n=this._getOrReturnCtx(t);return pn(n,{code:Jt.invalid_type,expected:wn.bigint,received:n.parsedType}),fr}gte(t,n){return this.setLimit("min",t,!0,Nn.toString(n))}gt(t,n){return this.setLimit("min",t,!1,Nn.toString(n))}lte(t,n){return this.setLimit("max",t,!0,Nn.toString(n))}lt(t,n){return this.setLimit("max",t,!1,Nn.toString(n))}setLimit(t,n,r,s){return new lw({...this._def,checks:[...this._def.checks,{kind:t,value:n,inclusive:r,message:Nn.toString(s)}]})}_addCheck(t){return new lw({...this._def,checks:[...this._def.checks,t]})}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:Nn.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:Nn.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:Nn.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:Nn.toString(t)})}multipleOf(t,n){return this._addCheck({kind:"multipleOf",value:t,message:Nn.toString(n)})}get minValue(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxValue(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}}lw.create=e=>new lw({checks:[],typeName:tn.ZodBigInt,coerce:(e==null?void 0:e.coerce)??!1,...Ir(e)});class S3 extends Vr{_parse(t){if(this._def.coerce&&(t.data=!!t.data),this._getType(t)!==wn.boolean){const r=this._getOrReturnCtx(t);return pn(r,{code:Jt.invalid_type,expected:wn.boolean,received:r.parsedType}),fr}return dc(t.data)}}S3.create=e=>new S3({typeName:tn.ZodBoolean,coerce:(e==null?void 0:e.coerce)||!1,...Ir(e)});class cw extends Vr{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==wn.date){const i=this._getOrReturnCtx(t);return pn(i,{code:Jt.invalid_type,expected:wn.date,received:i.parsedType}),fr}if(Number.isNaN(t.data.getTime())){const i=this._getOrReturnCtx(t);return pn(i,{code:Jt.invalid_date}),fr}const r=new xo;let s;for(const i of this._def.checks)i.kind==="min"?t.data.getTime()<i.value&&(s=this._getOrReturnCtx(t,s),pn(s,{code:Jt.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),r.dirty()):i.kind==="max"?t.data.getTime()>i.value&&(s=this._getOrReturnCtx(t,s),pn(s,{code:Jt.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),r.dirty()):es.assertNever(i);return{status:r.value,value:new Date(t.data.getTime())}}_addCheck(t){return new cw({...this._def,checks:[...this._def.checks,t]})}min(t,n){return this._addCheck({kind:"min",value:t.getTime(),message:Nn.toString(n)})}max(t,n){return this._addCheck({kind:"max",value:t.getTime(),message:Nn.toString(n)})}get minDate(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t!=null?new Date(t):null}get maxDate(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t!=null?new Date(t):null}}cw.create=e=>new cw({checks:[],coerce:(e==null?void 0:e.coerce)||!1,typeName:tn.ZodDate,...Ir(e)});class p$ extends Vr{_parse(t){if(this._getType(t)!==wn.symbol){const r=this._getOrReturnCtx(t);return pn(r,{code:Jt.invalid_type,expected:wn.symbol,received:r.parsedType}),fr}return dc(t.data)}}p$.create=e=>new p$({typeName:tn.ZodSymbol,...Ir(e)});class _3 extends Vr{_parse(t){if(this._getType(t)!==wn.undefined){const r=this._getOrReturnCtx(t);return pn(r,{code:Jt.invalid_type,expected:wn.undefined,received:r.parsedType}),fr}return dc(t.data)}}_3.create=e=>new _3({typeName:tn.ZodUndefined,...Ir(e)});class R2 extends Vr{_parse(t){if(this._getType(t)!==wn.null){const r=this._getOrReturnCtx(t);return pn(r,{code:Jt.invalid_type,expected:wn.null,received:r.parsedType}),fr}return dc(t.data)}}R2.create=e=>new R2({typeName:tn.ZodNull,...Ir(e)});class uw extends Vr{constructor(){super(...arguments),this._any=!0}_parse(t){return dc(t.data)}}uw.create=e=>new uw({typeName:tn.ZodAny,...Ir(e)});class C3 extends Vr{constructor(){super(...arguments),this._unknown=!0}_parse(t){return dc(t.data)}}C3.create=e=>new C3({typeName:tn.ZodUnknown,...Ir(e)});class Oh extends Vr{_parse(t){const n=this._getOrReturnCtx(t);return pn(n,{code:Jt.invalid_type,expected:wn.never,received:n.parsedType}),fr}}Oh.create=e=>new Oh({typeName:tn.ZodNever,...Ir(e)});class m$ extends Vr{_parse(t){if(this._getType(t)!==wn.undefined){const r=this._getOrReturnCtx(t);return pn(r,{code:Jt.invalid_type,expected:wn.void,received:r.parsedType}),fr}return dc(t.data)}}m$.create=e=>new m$({typeName:tn.ZodVoid,...Ir(e)});class ju extends Vr{_parse(t){const{ctx:n,status:r}=this._processInputParams(t),s=this._def;if(n.parsedType!==wn.array)return pn(n,{code:Jt.invalid_type,expected:wn.array,received:n.parsedType}),fr;if(s.exactLength!==null){const a=n.data.length>s.exactLength.value,o=n.data.length<s.exactLength.value;(a||o)&&(pn(n,{code:a?Jt.too_big:Jt.too_small,minimum:o?s.exactLength.value:void 0,maximum:a?s.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:s.exactLength.message}),r.dirty())}if(s.minLength!==null&&n.data.length<s.minLength.value&&(pn(n,{code:Jt.too_small,minimum:s.minLength.value,type:"array",inclusive:!0,exact:!1,message:s.minLength.message}),r.dirty()),s.maxLength!==null&&n.data.length>s.maxLength.value&&(pn(n,{code:Jt.too_big,maximum:s.maxLength.value,type:"array",inclusive:!0,exact:!1,message:s.maxLength.message}),r.dirty()),n.common.async)return Promise.all([...n.data].map((a,o)=>s.type._parseAsync(new Uu(n,a,n.path,o)))).then(a=>xo.mergeArray(r,a));const i=[...n.data].map((a,o)=>s.type._parseSync(new Uu(n,a,n.path,o)));return xo.mergeArray(r,i)}get element(){return this._def.type}min(t,n){return new ju({...this._def,minLength:{value:t,message:Nn.toString(n)}})}max(t,n){return new ju({...this._def,maxLength:{value:t,message:Nn.toString(n)}})}length(t,n){return new ju({...this._def,exactLength:{value:t,message:Nn.toString(n)}})}nonempty(t){return this.min(1,t)}}ju.create=(e,t)=>new ju({type:e,minLength:null,maxLength:null,exactLength:null,typeName:tn.ZodArray,...Ir(t)});function S0(e){if(e instanceof Pi){const t={};for(const n in e.shape){const r=e.shape[n];t[n]=Pu.create(S0(r))}return new Pi({...e._def,shape:()=>t})}else return e instanceof ju?new ju({...e._def,type:S0(e.element)}):e instanceof Pu?Pu.create(S0(e.unwrap())):e instanceof Pm?Pm.create(S0(e.unwrap())):e instanceof Im?Im.create(e.items.map(t=>S0(t))):e}class Pi extends Vr{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const t=this._def.shape(),n=es.objectKeys(t);return this._cached={shape:t,keys:n},this._cached}_parse(t){if(this._getType(t)!==wn.object){const c=this._getOrReturnCtx(t);return pn(c,{code:Jt.invalid_type,expected:wn.object,received:c.parsedType}),fr}const{status:r,ctx:s}=this._processInputParams(t),{shape:i,keys:a}=this._getCached(),o=[];if(!(this._def.catchall instanceof Oh&&this._def.unknownKeys==="strip"))for(const c in s.data)a.includes(c)||o.push(c);const l=[];for(const c of a){const u=i[c],d=s.data[c];l.push({key:{status:"valid",value:c},value:u._parse(new Uu(s,d,s.path,c)),alwaysSet:c in s.data})}if(this._def.catchall instanceof Oh){const c=this._def.unknownKeys;if(c==="passthrough")for(const u of o)l.push({key:{status:"valid",value:u},value:{status:"valid",value:s.data[u]}});else if(c==="strict")o.length>0&&(pn(s,{code:Jt.unrecognized_keys,keys:o}),r.dirty());else if(c!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const c=this._def.catchall;for(const u of o){const d=s.data[u];l.push({key:{status:"valid",value:u},value:c._parse(new Uu(s,d,s.path,u)),alwaysSet:u in s.data})}}return s.common.async?Promise.resolve().then(async()=>{const c=[];for(const u of l){const d=await u.key,h=await u.value;c.push({key:d,value:h,alwaysSet:u.alwaysSet})}return c}).then(c=>xo.mergeObjectSync(r,c)):xo.mergeObjectSync(r,l)}get shape(){return this._def.shape()}strict(t){return Nn.errToObj,new Pi({...this._def,unknownKeys:"strict",...t!==void 0?{errorMap:(n,r)=>{var i,a;const s=((a=(i=this._def).errorMap)==null?void 0:a.call(i,n,r).message)??r.defaultError;return n.code==="unrecognized_keys"?{message:Nn.errToObj(t).message??s}:{message:s}}}:{}})}strip(){return new Pi({...this._def,unknownKeys:"strip"})}passthrough(){return new Pi({...this._def,unknownKeys:"passthrough"})}extend(t){return new Pi({...this._def,shape:()=>({...this._def.shape(),...t})})}merge(t){return new Pi({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>({...this._def.shape(),...t._def.shape()}),typeName:tn.ZodObject})}setKey(t,n){return this.augment({[t]:n})}catchall(t){return new Pi({...this._def,catchall:t})}pick(t){const n={};for(const r of es.objectKeys(t))t[r]&&this.shape[r]&&(n[r]=this.shape[r]);return new Pi({...this._def,shape:()=>n})}omit(t){const n={};for(const r of es.objectKeys(this.shape))t[r]||(n[r]=this.shape[r]);return new Pi({...this._def,shape:()=>n})}deepPartial(){return S0(this)}partial(t){const n={};for(const r of es.objectKeys(this.shape)){const s=this.shape[r];t&&!t[r]?n[r]=s:n[r]=s.optional()}return new Pi({...this._def,shape:()=>n})}required(t){const n={};for(const r of es.objectKeys(this.shape))if(t&&!t[r])n[r]=this.shape[r];else{let i=this.shape[r];for(;i instanceof Pu;)i=i._def.innerType;n[r]=i}return new Pi({...this._def,shape:()=>n})}keyof(){return zG(es.objectKeys(this.shape))}}Pi.create=(e,t)=>new Pi({shape:()=>e,unknownKeys:"strip",catchall:Oh.create(),typeName:tn.ZodObject,...Ir(t)});Pi.strictCreate=(e,t)=>new Pi({shape:()=>e,unknownKeys:"strict",catchall:Oh.create(),typeName:tn.ZodObject,...Ir(t)});Pi.lazycreate=(e,t)=>new Pi({shape:e,unknownKeys:"strip",catchall:Oh.create(),typeName:tn.ZodObject,...Ir(t)});class N2 extends Vr{_parse(t){const{ctx:n}=this._processInputParams(t),r=this._def.options;function s(i){for(const o of i)if(o.result.status==="valid")return o.result;for(const o of i)if(o.result.status==="dirty")return n.common.issues.push(...o.ctx.common.issues),o.result;const a=i.map(o=>new Vc(o.ctx.common.issues));return pn(n,{code:Jt.invalid_union,unionErrors:a}),fr}if(n.common.async)return Promise.all(r.map(async i=>{const a={...n,common:{...n.common,issues:[]},parent:null};return{result:await i._parseAsync({data:n.data,path:n.path,parent:a}),ctx:a}})).then(s);{let i;const a=[];for(const l of r){const c={...n,common:{...n.common,issues:[]},parent:null},u=l._parseSync({data:n.data,path:n.path,parent:c});if(u.status==="valid")return u;u.status==="dirty"&&!i&&(i={result:u,ctx:c}),c.common.issues.length&&a.push(c.common.issues)}if(i)return n.common.issues.push(...i.ctx.common.issues),i.result;const o=a.map(l=>new Vc(l));return pn(n,{code:Jt.invalid_union,unionErrors:o}),fr}}get options(){return this._def.options}}N2.create=(e,t)=>new N2({options:e,typeName:tn.ZodUnion,...Ir(t)});const Od=e=>e instanceof j2?Od(e.schema):e instanceof jm?Od(e.innerType()):e instanceof P2?[e.value]:e instanceof Mm?e.options:e instanceof E3?es.objectValues(e.enum):e instanceof D2?Od(e._def.innerType):e instanceof _3?[void 0]:e instanceof R2?[null]:e instanceof Pu?[void 0,...Od(e.unwrap())]:e instanceof Pm?[null,...Od(e.unwrap())]:e instanceof UG||e instanceof L2?Od(e.unwrap()):e instanceof F2?Od(e._def.innerType):[];class uO extends Vr{_parse(t){const{ctx:n}=this._processInputParams(t);if(n.parsedType!==wn.object)return pn(n,{code:Jt.invalid_type,expected:wn.object,received:n.parsedType}),fr;const r=this.discriminator,s=n.data[r],i=this.optionsMap.get(s);return i?n.common.async?i._parseAsync({data:n.data,path:n.path,parent:n}):i._parseSync({data:n.data,path:n.path,parent:n}):(pn(n,{code:Jt.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),fr)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(t,n,r){const s=new Map;for(const i of n){const a=Od(i.shape[t]);if(!a.length)throw new Error(`A discriminator value for key \`${t}\` could not be extracted from all schema options`);for(const o of a){if(s.has(o))throw new Error(`Discriminator property ${String(t)} has duplicate value ${String(o)}`);s.set(o,i)}}return new uO({typeName:tn.ZodDiscriminatedUnion,discriminator:t,options:n,optionsMap:s,...Ir(r)})}}function k3(e,t){const n=bh(e),r=bh(t);if(e===t)return{valid:!0,data:e};if(n===wn.object&&r===wn.object){const s=es.objectKeys(t),i=es.objectKeys(e).filter(o=>s.indexOf(o)!==-1),a={...e,...t};for(const o of i){const l=k3(e[o],t[o]);if(!l.valid)return{valid:!1};a[o]=l.data}return{valid:!0,data:a}}else if(n===wn.array&&r===wn.array){if(e.length!==t.length)return{valid:!1};const s=[];for(let i=0;i<e.length;i++){const a=e[i],o=t[i],l=k3(a,o);if(!l.valid)return{valid:!1};s.push(l.data)}return{valid:!0,data:s}}else return n===wn.date&&r===wn.date&&+e==+t?{valid:!0,data:e}:{valid:!1}}class I2 extends Vr{_parse(t){const{status:n,ctx:r}=this._processInputParams(t),s=(i,a)=>{if(d$(i)||d$(a))return fr;const o=k3(i.value,a.value);return o.valid?((f$(i)||f$(a))&&n.dirty(),{status:n.value,value:o.data}):(pn(r,{code:Jt.invalid_intersection_types}),fr)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([i,a])=>s(i,a)):s(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}I2.create=(e,t,n)=>new I2({left:e,right:t,typeName:tn.ZodIntersection,...Ir(n)});class Im extends Vr{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==wn.array)return pn(r,{code:Jt.invalid_type,expected:wn.array,received:r.parsedType}),fr;if(r.data.length<this._def.items.length)return pn(r,{code:Jt.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),fr;!this._def.rest&&r.data.length>this._def.items.length&&(pn(r,{code:Jt.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),n.dirty());const i=[...r.data].map((a,o)=>{const l=this._def.items[o]||this._def.rest;return l?l._parse(new Uu(r,a,r.path,o)):null}).filter(a=>!!a);return r.common.async?Promise.all(i).then(a=>xo.mergeArray(n,a)):xo.mergeArray(n,i)}get items(){return this._def.items}rest(t){return new Im({...this._def,rest:t})}}Im.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Im({items:e,typeName:tn.ZodTuple,rest:null,...Ir(t)})};class M2 extends Vr{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==wn.object)return pn(r,{code:Jt.invalid_type,expected:wn.object,received:r.parsedType}),fr;const s=[],i=this._def.keyType,a=this._def.valueType;for(const o in r.data)s.push({key:i._parse(new Uu(r,o,r.path,o)),value:a._parse(new Uu(r,r.data[o],r.path,o)),alwaysSet:o in r.data});return r.common.async?xo.mergeObjectAsync(n,s):xo.mergeObjectSync(n,s)}get element(){return this._def.valueType}static create(t,n,r){return n instanceof Vr?new M2({keyType:t,valueType:n,typeName:tn.ZodRecord,...Ir(r)}):new M2({keyType:qd.create(),valueType:t,typeName:tn.ZodRecord,...Ir(n)})}}class g$ extends Vr{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==wn.map)return pn(r,{code:Jt.invalid_type,expected:wn.map,received:r.parsedType}),fr;const s=this._def.keyType,i=this._def.valueType,a=[...r.data.entries()].map(([o,l],c)=>({key:s._parse(new Uu(r,o,r.path,[c,"key"])),value:i._parse(new Uu(r,l,r.path,[c,"value"]))}));if(r.common.async){const o=new Map;return Promise.resolve().then(async()=>{for(const l of a){const c=await l.key,u=await l.value;if(c.status==="aborted"||u.status==="aborted")return fr;(c.status==="dirty"||u.status==="dirty")&&n.dirty(),o.set(c.value,u.value)}return{status:n.value,value:o}})}else{const o=new Map;for(const l of a){const c=l.key,u=l.value;if(c.status==="aborted"||u.status==="aborted")return fr;(c.status==="dirty"||u.status==="dirty")&&n.dirty(),o.set(c.value,u.value)}return{status:n.value,value:o}}}}g$.create=(e,t,n)=>new g$({valueType:t,keyType:e,typeName:tn.ZodMap,...Ir(n)});class dw extends Vr{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==wn.set)return pn(r,{code:Jt.invalid_type,expected:wn.set,received:r.parsedType}),fr;const s=this._def;s.minSize!==null&&r.data.size<s.minSize.value&&(pn(r,{code:Jt.too_small,minimum:s.minSize.value,type:"set",inclusive:!0,exact:!1,message:s.minSize.message}),n.dirty()),s.maxSize!==null&&r.data.size>s.maxSize.value&&(pn(r,{code:Jt.too_big,maximum:s.maxSize.value,type:"set",inclusive:!0,exact:!1,message:s.maxSize.message}),n.dirty());const i=this._def.valueType;function a(l){const c=new Set;for(const u of l){if(u.status==="aborted")return fr;u.status==="dirty"&&n.dirty(),c.add(u.value)}return{status:n.value,value:c}}const o=[...r.data.values()].map((l,c)=>i._parse(new Uu(r,l,r.path,c)));return r.common.async?Promise.all(o).then(l=>a(l)):a(o)}min(t,n){return new dw({...this._def,minSize:{value:t,message:Nn.toString(n)}})}max(t,n){return new dw({...this._def,maxSize:{value:t,message:Nn.toString(n)}})}size(t,n){return this.min(t,n).max(t,n)}nonempty(t){return this.min(1,t)}}dw.create=(e,t)=>new dw({valueType:e,minSize:null,maxSize:null,typeName:tn.ZodSet,...Ir(t)});class j2 extends Vr{get schema(){return this._def.getter()}_parse(t){const{ctx:n}=this._processInputParams(t);return this._def.getter()._parse({data:n.data,path:n.path,parent:n})}}j2.create=(e,t)=>new j2({getter:e,typeName:tn.ZodLazy,...Ir(t)});class P2 extends Vr{_parse(t){if(t.data!==this._def.value){const n=this._getOrReturnCtx(t);return pn(n,{received:n.data,code:Jt.invalid_literal,expected:this._def.value}),fr}return{status:"valid",value:t.data}}get value(){return this._def.value}}P2.create=(e,t)=>new P2({value:e,typeName:tn.ZodLiteral,...Ir(t)});function zG(e,t){return new Mm({values:e,typeName:tn.ZodEnum,...Ir(t)})}class Mm extends Vr{_parse(t){if(typeof t.data!="string"){const n=this._getOrReturnCtx(t),r=this._def.values;return pn(n,{expected:es.joinValues(r),received:n.parsedType,code:Jt.invalid_type}),fr}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(t.data)){const n=this._getOrReturnCtx(t),r=this._def.values;return pn(n,{received:n.data,code:Jt.invalid_enum_value,options:r}),fr}return dc(t.data)}get options(){return this._def.values}get enum(){const t={};for(const n of this._def.values)t[n]=n;return t}get Values(){const t={};for(const n of this._def.values)t[n]=n;return t}get Enum(){const t={};for(const n of this._def.values)t[n]=n;return t}extract(t,n=this._def){return Mm.create(t,{...this._def,...n})}exclude(t,n=this._def){return Mm.create(this.options.filter(r=>!t.includes(r)),{...this._def,...n})}}Mm.create=zG;class E3 extends Vr{_parse(t){const n=es.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(t);if(r.parsedType!==wn.string&&r.parsedType!==wn.number){const s=es.objectValues(n);return pn(r,{expected:es.joinValues(s),received:r.parsedType,code:Jt.invalid_type}),fr}if(this._cache||(this._cache=new Set(es.getValidEnumValues(this._def.values))),!this._cache.has(t.data)){const s=es.objectValues(n);return pn(r,{received:r.data,code:Jt.invalid_enum_value,options:s}),fr}return dc(t.data)}get enum(){return this._def.values}}E3.create=(e,t)=>new E3({values:e,typeName:tn.ZodNativeEnum,...Ir(t)});class O2 extends Vr{unwrap(){return this._def.type}_parse(t){const{ctx:n}=this._processInputParams(t);if(n.parsedType!==wn.promise&&n.common.async===!1)return pn(n,{code:Jt.invalid_type,expected:wn.promise,received:n.parsedType}),fr;const r=n.parsedType===wn.promise?n.data:Promise.resolve(n.data);return dc(r.then(s=>this._def.type.parseAsync(s,{path:n.path,errorMap:n.common.contextualErrorMap})))}}O2.create=(e,t)=>new O2({type:e,typeName:tn.ZodPromise,...Ir(t)});class jm extends Vr{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===tn.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(t){const{status:n,ctx:r}=this._processInputParams(t),s=this._def.effect||null,i={addIssue:a=>{pn(r,a),a.fatal?n.abort():n.dirty()},get path(){return r.path}};if(i.addIssue=i.addIssue.bind(i),s.type==="preprocess"){const a=s.transform(r.data,i);if(r.common.async)return Promise.resolve(a).then(async o=>{if(n.value==="aborted")return fr;const l=await this._def.schema._parseAsync({data:o,path:r.path,parent:r});return l.status==="aborted"?fr:l.status==="dirty"||n.value==="dirty"?hx(l.value):l});{if(n.value==="aborted")return fr;const o=this._def.schema._parseSync({data:a,path:r.path,parent:r});return o.status==="aborted"?fr:o.status==="dirty"||n.value==="dirty"?hx(o.value):o}}if(s.type==="refinement"){const a=o=>{const l=s.refinement(o,i);if(r.common.async)return Promise.resolve(l);if(l instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return o};if(r.common.async===!1){const o=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return o.status==="aborted"?fr:(o.status==="dirty"&&n.dirty(),a(o.value),{status:n.value,value:o.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(o=>o.status==="aborted"?fr:(o.status==="dirty"&&n.dirty(),a(o.value).then(()=>({status:n.value,value:o.value}))))}if(s.type==="transform")if(r.common.async===!1){const a=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!hy(a))return fr;const o=s.transform(a.value,i);if(o instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:n.value,value:o}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(a=>hy(a)?Promise.resolve(s.transform(a.value,i)).then(o=>({status:n.value,value:o})):fr);es.assertNever(s)}}jm.create=(e,t,n)=>new jm({schema:e,typeName:tn.ZodEffects,effect:t,...Ir(n)});jm.createWithPreprocess=(e,t,n)=>new jm({schema:t,effect:{type:"preprocess",transform:e},typeName:tn.ZodEffects,...Ir(n)});class Pu extends Vr{_parse(t){return this._getType(t)===wn.undefined?dc(void 0):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}Pu.create=(e,t)=>new Pu({innerType:e,typeName:tn.ZodOptional,...Ir(t)});class Pm extends Vr{_parse(t){return this._getType(t)===wn.null?dc(null):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}Pm.create=(e,t)=>new Pm({innerType:e,typeName:tn.ZodNullable,...Ir(t)});class D2 extends Vr{_parse(t){const{ctx:n}=this._processInputParams(t);let r=n.data;return n.parsedType===wn.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:n.path,parent:n})}removeDefault(){return this._def.innerType}}D2.create=(e,t)=>new D2({innerType:e,typeName:tn.ZodDefault,defaultValue:typeof t.default=="function"?t.default:()=>t.default,...Ir(t)});class F2 extends Vr{_parse(t){const{ctx:n}=this._processInputParams(t),r={...n,common:{...n.common,issues:[]}},s=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return A2(s)?s.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new Vc(r.common.issues)},input:r.data})})):{status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new Vc(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}F2.create=(e,t)=>new F2({innerType:e,typeName:tn.ZodCatch,catchValue:typeof t.catch=="function"?t.catch:()=>t.catch,...Ir(t)});class y$ extends Vr{_parse(t){if(this._getType(t)!==wn.nan){const r=this._getOrReturnCtx(t);return pn(r,{code:Jt.invalid_type,expected:wn.nan,received:r.parsedType}),fr}return{status:"valid",value:t.data}}}y$.create=e=>new y$({typeName:tn.ZodNaN,...Ir(e)});class UG extends Vr{_parse(t){const{ctx:n}=this._processInputParams(t),r=n.data;return this._def.type._parse({data:r,path:n.path,parent:n})}unwrap(){return this._def.type}}class dO extends Vr{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.common.async)return(async()=>{const i=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return i.status==="aborted"?fr:i.status==="dirty"?(n.dirty(),hx(i.value)):this._def.out._parseAsync({data:i.value,path:r.path,parent:r})})();{const s=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return s.status==="aborted"?fr:s.status==="dirty"?(n.dirty(),{status:"dirty",value:s.value}):this._def.out._parseSync({data:s.value,path:r.path,parent:r})}}static create(t,n){return new dO({in:t,out:n,typeName:tn.ZodPipeline})}}class L2 extends Vr{_parse(t){const n=this._def.innerType._parse(t),r=s=>(hy(s)&&(s.value=Object.freeze(s.value)),s);return A2(n)?n.then(s=>r(s)):r(n)}unwrap(){return this._def.innerType}}L2.create=(e,t)=>new L2({innerType:e,typeName:tn.ZodReadonly,...Ir(t)});function b$(e,t){const n=typeof e=="function"?e(t):typeof e=="string"?{message:e}:e;return typeof n=="string"?{message:n}:n}function qG(e,t={},n){return e?uw.create().superRefine((r,s)=>{const i=e(r);if(i instanceof Promise)return i.then(a=>{if(!a){const o=b$(t,r),l=o.fatal??n??!0;s.addIssue({code:"custom",...o,fatal:l})}});if(!i){const a=b$(t,r),o=a.fatal??n??!0;s.addIssue({code:"custom",...a,fatal:o})}}):uw.create()}var tn;(function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"})(tn||(tn={}));const B2=(e,t={message:`Input not instance of ${e.name}`})=>qG(n=>n instanceof e,t),$e=qd.create,Tt=py.create,Qn=S3.create,$be=cw.create,zbe=R2.create,sf=uw.create,nb=C3.create;Oh.create;const cn=ju.create,Ke=Pi.create,ms=N2.create,BE=uO.create;I2.create;Im.create;const Dh=M2.create,Ube=j2.create,Mn=P2.create,El=Mm.create;O2.create;const ua=Pu.create;Pm.create;function qbe({prompt:e,useLegacyFunctionCalling:t=!1,systemMessageMode:n="system"}){const r=[],s=[];for(const{role:i,content:a}of e)switch(i){case"system":{switch(n){case"system":{r.push({role:"system",content:a});break}case"developer":{r.push({role:"developer",content:a});break}case"remove":{s.push({type:"other",message:"system messages are removed for this model"});break}default:{const o=n;throw new Error(`Unsupported system message mode: ${o}`)}}break}case"user":{if(a.length===1&&a[0].type==="text"){r.push({role:"user",content:a[0].text});break}r.push({role:"user",content:a.map((o,l)=>{var c,u,d,h;switch(o.type){case"text":return{type:"text",text:o.text};case"image":return{type:"image_url",image_url:{url:o.image instanceof URL?o.image.toString():`data:${(c=o.mimeType)!=null?c:"image/jpeg"};base64,${zu(o.image)}`,detail:(d=(u=o.providerMetadata)==null?void 0:u.openai)==null?void 0:d.imageDetail}};case"file":{if(o.data instanceof URL)throw new gr({functionality:"'File content parts with URL data' functionality not supported."});switch(o.mimeType){case"audio/wav":return{type:"input_audio",input_audio:{data:o.data,format:"wav"}};case"audio/mp3":case"audio/mpeg":return{type:"input_audio",input_audio:{data:o.data,format:"mp3"}};case"application/pdf":return{type:"file",file:{filename:(h=o.filename)!=null?h:`part-${l}.pdf`,file_data:`data:application/pdf;base64,${o.data}`}};default:throw new gr({functionality:`File content part type ${o.mimeType} in user messages`})}}}})});break}case"assistant":{let o="";const l=[];for(const c of a)switch(c.type){case"text":{o+=c.text;break}case"tool-call":{l.push({id:c.toolCallId,type:"function",function:{name:c.toolName,arguments:JSON.stringify(c.args)}});break}}if(t){if(l.length>1)throw new gr({functionality:"useLegacyFunctionCalling with multiple tool calls in one message"});r.push({role:"assistant",content:o,function_call:l.length>0?l[0].function:void 0})}else r.push({role:"assistant",content:o,tool_calls:l.length>0?l:void 0});break}case"tool":{for(const o of a)t?r.push({role:"function",name:o.toolName,content:JSON.stringify(o.result)}):r.push({role:"tool",tool_call_id:o.toolCallId,content:JSON.stringify(o.result)});break}default:{const o=i;throw new Error(`Unsupported role: ${o}`)}}return{messages:r,warnings:s}}function v$(e){var t,n;return(n=(t=e==null?void 0:e.content)==null?void 0:t.map(({token:r,logprob:s,top_logprobs:i})=>({token:r,logprob:s,topLogprobs:i?i.map(({token:a,logprob:o})=>({token:a,logprob:o})):[]})))!=null?n:void 0}function $2(e){switch(e){case"stop":return"stop";case"length":return"length";case"content_filter":return"content-filter";case"function_call":case"tool_calls":return"tool-calls";default:return"unknown"}}var fO=Ke({error:Ke({message:$e(),type:$e().nullish(),param:sf().nullish(),code:ms([$e(),Tt()]).nullish()})}),qu=np({errorSchema:fO,errorToMessage:e=>e.error.message});function z2({id:e,model:t,created:n}){return{id:e??void 0,modelId:t??void 0,timestamp:n!=null?new Date(n*1e3):void 0}}function Vbe({mode:e,useLegacyFunctionCalling:t=!1,structuredOutputs:n}){var r;const s=(r=e.tools)!=null&&r.length?e.tools:void 0,i=[];if(s==null)return{tools:void 0,tool_choice:void 0,toolWarnings:i};const a=e.toolChoice;if(t){const c=[];for(const d of s)d.type==="provider-defined"?i.push({type:"unsupported-tool",tool:d}):c.push({name:d.name,description:d.description,parameters:d.parameters});if(a==null)return{functions:c,function_call:void 0,toolWarnings:i};switch(a.type){case"auto":case"none":case void 0:return{functions:c,function_call:void 0,toolWarnings:i};case"required":throw new gr({functionality:"useLegacyFunctionCalling and toolChoice: required"});default:return{functions:c,function_call:{name:a.toolName},toolWarnings:i}}}const o=[];for(const c of s)c.type==="provider-defined"?i.push({type:"unsupported-tool",tool:c}):o.push({type:"function",function:{name:c.name,description:c.description,parameters:c.parameters,strict:n?!0:void 0}});if(a==null)return{tools:o,tool_choice:void 0,toolWarnings:i};const l=a.type;switch(l){case"auto":case"none":case"required":return{tools:o,tool_choice:l,toolWarnings:i};case"tool":return{tools:o,tool_choice:{type:"function",function:{name:a.toolName}},toolWarnings:i};default:{const c=l;throw new gr({functionality:`Unsupported tool choice type: ${c}`})}}}var Wbe=class{constructor(e,t,n){this.specificationVersion="v1",this.modelId=e,this.settings=t,this.config=n}get supportsStructuredOutputs(){var e;return(e=this.settings.structuredOutputs)!=null?e:T3(this.modelId)}get defaultObjectGenerationMode(){return Kbe(this.modelId)?"tool":this.supportsStructuredOutputs?"json":"tool"}get provider(){return this.config.provider}get supportsImageUrls(){return!this.settings.downloadImages}getArgs({mode:e,prompt:t,maxTokens:n,temperature:r,topP:s,topK:i,frequencyPenalty:a,presencePenalty:o,stopSequences:l,responseFormat:c,seed:u,providerMetadata:d}){var h,m,y,b,v,x,w,_;const k=e.type,C=[];i!=null&&C.push({type:"unsupported-setting",setting:"topK"}),(c==null?void 0:c.type)==="json"&&c.schema!=null&&!this.supportsStructuredOutputs&&C.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format schema is only supported with structuredOutputs"});const T=this.settings.useLegacyFunctionCalling;if(T&&this.settings.parallelToolCalls===!0)throw new gr({functionality:"useLegacyFunctionCalling with parallelToolCalls"});if(T&&this.supportsStructuredOutputs)throw new gr({functionality:"structuredOutputs with useLegacyFunctionCalling"});const{messages:A,warnings:N}=qbe({prompt:t,useLegacyFunctionCalling:T,systemMessageMode:Ybe(this.modelId)});C.push(...N);const I={model:this.modelId,logit_bias:this.settings.logitBias,logprobs:this.settings.logprobs===!0||typeof this.settings.logprobs=="number"?!0:void 0,top_logprobs:typeof this.settings.logprobs=="number"?this.settings.logprobs:typeof this.settings.logprobs=="boolean"&&this.settings.logprobs?0:void 0,user:this.settings.user,parallel_tool_calls:this.settings.parallelToolCalls,max_tokens:n,temperature:r,top_p:s,frequency_penalty:a,presence_penalty:o,response_format:(c==null?void 0:c.type)==="json"?this.supportsStructuredOutputs&&c.schema!=null?{type:"json_schema",json_schema:{schema:c.schema,strict:!0,name:(h=c.name)!=null?h:"response",description:c.description}}:{type:"json_object"}:void 0,stop:l,seed:u,max_completion_tokens:(m=d==null?void 0:d.openai)==null?void 0:m.maxCompletionTokens,store:(y=d==null?void 0:d.openai)==null?void 0:y.store,metadata:(b=d==null?void 0:d.openai)==null?void 0:b.metadata,prediction:(v=d==null?void 0:d.openai)==null?void 0:v.prediction,reasoning_effort:(w=(x=d==null?void 0:d.openai)==null?void 0:x.reasoningEffort)!=null?w:this.settings.reasoningEffort,messages:A};switch(T3(this.modelId)?(I.temperature!=null&&(I.temperature=void 0,C.push({type:"unsupported-setting",setting:"temperature",details:"temperature is not supported for reasoning models"})),I.top_p!=null&&(I.top_p=void 0,C.push({type:"unsupported-setting",setting:"topP",details:"topP is not supported for reasoning models"})),I.frequency_penalty!=null&&(I.frequency_penalty=void 0,C.push({type:"unsupported-setting",setting:"frequencyPenalty",details:"frequencyPenalty is not supported for reasoning models"})),I.presence_penalty!=null&&(I.presence_penalty=void 0,C.push({type:"unsupported-setting",setting:"presencePenalty",details:"presencePenalty is not supported for reasoning models"})),I.logit_bias!=null&&(I.logit_bias=void 0,C.push({type:"other",message:"logitBias is not supported for reasoning models"})),I.logprobs!=null&&(I.logprobs=void 0,C.push({type:"other",message:"logprobs is not supported for reasoning models"})),I.top_logprobs!=null&&(I.top_logprobs=void 0,C.push({type:"other",message:"topLogprobs is not supported for reasoning models"})),I.max_tokens!=null&&(I.max_completion_tokens==null&&(I.max_completion_tokens=I.max_tokens),I.max_tokens=void 0)):(this.modelId.startsWith("gpt-4o-search-preview")||this.modelId.startsWith("gpt-4o-mini-search-preview"))&&I.temperature!=null&&(I.temperature=void 0,C.push({type:"unsupported-setting",setting:"temperature",details:"temperature is not supported for the search preview models and has been removed."})),k){case"regular":{const{tools:j,tool_choice:L,functions:D,function_call:H,toolWarnings:O}=Vbe({mode:e,useLegacyFunctionCalling:T,structuredOutputs:this.supportsStructuredOutputs});return{args:{...I,tools:j,tool_choice:L,functions:D,function_call:H},warnings:[...C,...O]}}case"object-json":return{args:{...I,response_format:this.supportsStructuredOutputs&&e.schema!=null?{type:"json_schema",json_schema:{schema:e.schema,strict:!0,name:(_=e.name)!=null?_:"response",description:e.description}}:{type:"json_object"}},warnings:C};case"object-tool":return{args:T?{...I,function_call:{name:e.tool.name},functions:[{name:e.tool.name,description:e.tool.description,parameters:e.tool.parameters}]}:{...I,tool_choice:{type:"function",function:{name:e.tool.name}},tools:[{type:"function",function:{name:e.tool.name,description:e.tool.description,parameters:e.tool.parameters,strict:this.supportsStructuredOutputs?!0:void 0}}]},warnings:C};default:{const j=k;throw new Error(`Unsupported type: ${j}`)}}}async doGenerate(e){var t,n,r,s,i,a,o,l;const{args:c,warnings:u}=this.getArgs(e),{responseHeaders:d,value:h,rawValue:m}=await Hs({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:Ws(this.config.headers(),e.headers),body:c,failedResponseHandler:qu,successfulResponseHandler:Ka(Hbe),abortSignal:e.abortSignal,fetch:this.config.fetch}),{messages:y,...b}=c,v=h.choices[0],x=(t=h.usage)==null?void 0:t.completion_tokens_details,w=(n=h.usage)==null?void 0:n.prompt_tokens_details,_={openai:{}};return(x==null?void 0:x.reasoning_tokens)!=null&&(_.openai.reasoningTokens=x==null?void 0:x.reasoning_tokens),(x==null?void 0:x.accepted_prediction_tokens)!=null&&(_.openai.acceptedPredictionTokens=x==null?void 0:x.accepted_prediction_tokens),(x==null?void 0:x.rejected_prediction_tokens)!=null&&(_.openai.rejectedPredictionTokens=x==null?void 0:x.rejected_prediction_tokens),(w==null?void 0:w.cached_tokens)!=null&&(_.openai.cachedPromptTokens=w==null?void 0:w.cached_tokens),{text:(r=v.message.content)!=null?r:void 0,toolCalls:this.settings.useLegacyFunctionCalling&&v.message.function_call?[{toolCallType:"function",toolCallId:fa(),toolName:v.message.function_call.name,args:v.message.function_call.arguments}]:(s=v.message.tool_calls)==null?void 0:s.map(k=>{var C;return{toolCallType:"function",toolCallId:(C=k.id)!=null?C:fa(),toolName:k.function.name,args:k.function.arguments}}),finishReason:$2(v.finish_reason),usage:{promptTokens:(a=(i=h.usage)==null?void 0:i.prompt_tokens)!=null?a:NaN,completionTokens:(l=(o=h.usage)==null?void 0:o.completion_tokens)!=null?l:NaN},rawCall:{rawPrompt:y,rawSettings:b},rawResponse:{headers:d,body:m},request:{body:JSON.stringify(c)},response:z2(h),warnings:u,logprobs:v$(v.logprobs),providerMetadata:_}}async doStream(e){if(this.settings.simulateStreaming){const b=await this.doGenerate(e);return{stream:new ReadableStream({start(x){if(x.enqueue({type:"response-metadata",...b.response}),b.text&&x.enqueue({type:"text-delta",textDelta:b.text}),b.toolCalls)for(const w of b.toolCalls)x.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:w.toolCallId,toolName:w.toolName,argsTextDelta:w.args}),x.enqueue({type:"tool-call",...w});x.enqueue({type:"finish",finishReason:b.finishReason,usage:b.usage,logprobs:b.logprobs,providerMetadata:b.providerMetadata}),x.close()}}),rawCall:b.rawCall,rawResponse:b.rawResponse,warnings:b.warnings}}const{args:t,warnings:n}=this.getArgs(e),r={...t,stream:!0,stream_options:this.config.compatibility==="strict"?{include_usage:!0}:void 0},{responseHeaders:s,value:i}=await Hs({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:Ws(this.config.headers(),e.headers),body:r,failedResponseHandler:qu,successfulResponseHandler:rp(Gbe),abortSignal:e.abortSignal,fetch:this.config.fetch}),{messages:a,...o}=t,l=[];let c="unknown",u={promptTokens:void 0,completionTokens:void 0},d,h=!0;const{useLegacyFunctionCalling:m}=this.settings,y={openai:{}};return{stream:i.pipeThrough(new TransformStream({transform(b,v){var x,w,_,k,C,T,A,N,I,j,L,D;if(!b.success){c="error",v.enqueue({type:"error",error:b.error});return}const H=b.value;if("error"in H){c="error",v.enqueue({type:"error",error:H.error});return}if(h&&(h=!1,v.enqueue({type:"response-metadata",...z2(H)})),H.usage!=null){const{prompt_tokens:B,completion_tokens:ne,prompt_tokens_details:V,completion_tokens_details:Q}=H.usage;u={promptTokens:B??void 0,completionTokens:ne??void 0},(Q==null?void 0:Q.reasoning_tokens)!=null&&(y.openai.reasoningTokens=Q==null?void 0:Q.reasoning_tokens),(Q==null?void 0:Q.accepted_prediction_tokens)!=null&&(y.openai.acceptedPredictionTokens=Q==null?void 0:Q.accepted_prediction_tokens),(Q==null?void 0:Q.rejected_prediction_tokens)!=null&&(y.openai.rejectedPredictionTokens=Q==null?void 0:Q.rejected_prediction_tokens),(V==null?void 0:V.cached_tokens)!=null&&(y.openai.cachedPromptTokens=V==null?void 0:V.cached_tokens)}const O=H.choices[0];if((O==null?void 0:O.finish_reason)!=null&&(c=$2(O.finish_reason)),(O==null?void 0:O.delta)==null)return;const K=O.delta;K.content!=null&&v.enqueue({type:"text-delta",textDelta:K.content});const U=v$(O==null?void 0:O.logprobs);U!=null&&U.length&&(d===void 0&&(d=[]),d.push(...U));const W=m&&K.function_call!=null?[{type:"function",id:fa(),function:K.function_call,index:0}]:K.tool_calls;if(W!=null)for(const B of W){const ne=B.index;if(l[ne]==null){if(B.type!=="function")throw new Yd({data:B,message:"Expected 'function' type."});if(B.id==null)throw new Yd({data:B,message:"Expected 'id' to be a string."});if(((x=B.function)==null?void 0:x.name)==null)throw new Yd({data:B,message:"Expected 'function.name' to be a string."});l[ne]={id:B.id,type:"function",function:{name:B.function.name,arguments:(w=B.function.arguments)!=null?w:""},hasFinished:!1};const Q=l[ne];((_=Q.function)==null?void 0:_.name)!=null&&((k=Q.function)==null?void 0:k.arguments)!=null&&(Q.function.arguments.length>0&&v.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:Q.id,toolName:Q.function.name,argsTextDelta:Q.function.arguments}),xm(Q.function.arguments)&&(v.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(C=Q.id)!=null?C:fa(),toolName:Q.function.name,args:Q.function.arguments}),Q.hasFinished=!0));continue}const V=l[ne];V.hasFinished||(((T=B.function)==null?void 0:T.arguments)!=null&&(V.function.arguments+=(N=(A=B.function)==null?void 0:A.arguments)!=null?N:""),v.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:V.id,toolName:V.function.name,argsTextDelta:(I=B.function.arguments)!=null?I:""}),((j=V.function)==null?void 0:j.name)!=null&&((L=V.function)==null?void 0:L.arguments)!=null&&xm(V.function.arguments)&&(v.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(D=V.id)!=null?D:fa(),toolName:V.function.name,args:V.function.arguments}),V.hasFinished=!0))}},flush(b){var v,x;b.enqueue({type:"finish",finishReason:c,logprobs:d,usage:{promptTokens:(v=u.promptTokens)!=null?v:NaN,completionTokens:(x=u.completionTokens)!=null?x:NaN},...y!=null?{providerMetadata:y}:{}})}})),rawCall:{rawPrompt:a,rawSettings:o},rawResponse:{headers:s},request:{body:JSON.stringify(r)},warnings:n}}},VG=Ke({prompt_tokens:Tt().nullish(),completion_tokens:Tt().nullish(),prompt_tokens_details:Ke({cached_tokens:Tt().nullish()}).nullish(),completion_tokens_details:Ke({reasoning_tokens:Tt().nullish(),accepted_prediction_tokens:Tt().nullish(),rejected_prediction_tokens:Tt().nullish()}).nullish()}).nullish(),Hbe=Ke({id:$e().nullish(),created:Tt().nullish(),model:$e().nullish(),choices:cn(Ke({message:Ke({role:Mn("assistant").nullish(),content:$e().nullish(),function_call:Ke({arguments:$e(),name:$e()}).nullish(),tool_calls:cn(Ke({id:$e().nullish(),type:Mn("function"),function:Ke({name:$e(),arguments:$e()})})).nullish()}),index:Tt(),logprobs:Ke({content:cn(Ke({token:$e(),logprob:Tt(),top_logprobs:cn(Ke({token:$e(),logprob:Tt()}))})).nullable()}).nullish(),finish_reason:$e().nullish()})),usage:VG}),Gbe=ms([Ke({id:$e().nullish(),created:Tt().nullish(),model:$e().nullish(),choices:cn(Ke({delta:Ke({role:El(["assistant"]).nullish(),content:$e().nullish(),function_call:Ke({name:$e().optional(),arguments:$e().optional()}).nullish(),tool_calls:cn(Ke({index:Tt(),id:$e().nullish(),type:Mn("function").nullish(),function:Ke({name:$e().nullish(),arguments:$e().nullish()})})).nullish()}).nullish(),logprobs:Ke({content:cn(Ke({token:$e(),logprob:Tt(),top_logprobs:cn(Ke({token:$e(),logprob:Tt()}))})).nullable()}).nullish(),finish_reason:$e().nullish(),index:Tt()})),usage:VG}),fO]);function T3(e){return e.startsWith("o")}function Kbe(e){return e.startsWith("gpt-4o-audio-preview")}function Ybe(e){var t,n;return T3(e)?(n=(t=Zbe[e])==null?void 0:t.systemMessageMode)!=null?n:"developer":"system"}var Zbe={"o1-mini":{systemMessageMode:"remove"},"o1-mini-2024-09-12":{systemMessageMode:"remove"},"o1-preview":{systemMessageMode:"remove"},"o1-preview-2024-09-12":{systemMessageMode:"remove"},o3:{systemMessageMode:"developer"},"o3-2025-04-16":{systemMessageMode:"developer"},"o3-mini":{systemMessageMode:"developer"},"o3-mini-2025-01-31":{systemMessageMode:"developer"},"o4-mini":{systemMessageMode:"developer"},"o4-mini-2025-04-16":{systemMessageMode:"developer"}};function Xbe({prompt:e,inputFormat:t,user:n="user",assistant:r="assistant"}){if(t==="prompt"&&e.length===1&&e[0].role==="user"&&e[0].content.length===1&&e[0].content[0].type==="text")return{prompt:e[0].content[0].text};let s="";e[0].role==="system"&&(s+=`${e[0].content}

`,e=e.slice(1));for(const{role:i,content:a}of e)switch(i){case"system":throw new Ic({message:"Unexpected system message in prompt: ${content}",prompt:e});case"user":{const o=a.map(l=>{switch(l.type){case"text":return l.text;case"image":throw new gr({functionality:"images"})}}).join("");s+=`${n}:
${o}

`;break}case"assistant":{const o=a.map(l=>{switch(l.type){case"text":return l.text;case"tool-call":throw new gr({functionality:"tool-call messages"})}}).join("");s+=`${r}:
${o}

`;break}case"tool":throw new gr({functionality:"tool messages"});default:{const o=i;throw new Error(`Unsupported role: ${o}`)}}return s+=`${r}:
`,{prompt:s,stopSequences:[`
${n}:`]}}function x$(e){return e==null?void 0:e.tokens.map((t,n)=>({token:t,logprob:e.token_logprobs[n],topLogprobs:e.top_logprobs?Object.entries(e.top_logprobs[n]).map(([r,s])=>({token:r,logprob:s})):[]}))}var Jbe=class{constructor(e,t,n){this.specificationVersion="v1",this.defaultObjectGenerationMode=void 0,this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}getArgs({mode:e,inputFormat:t,prompt:n,maxTokens:r,temperature:s,topP:i,topK:a,frequencyPenalty:o,presencePenalty:l,stopSequences:c,responseFormat:u,seed:d}){var h;const m=e.type,y=[];a!=null&&y.push({type:"unsupported-setting",setting:"topK"}),u!=null&&u.type!=="text"&&y.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format is not supported."});const{prompt:b,stopSequences:v}=Xbe({prompt:n,inputFormat:t}),x=[...v??[],...c??[]],w={model:this.modelId,echo:this.settings.echo,logit_bias:this.settings.logitBias,logprobs:typeof this.settings.logprobs=="number"?this.settings.logprobs:typeof this.settings.logprobs=="boolean"&&this.settings.logprobs?0:void 0,suffix:this.settings.suffix,user:this.settings.user,max_tokens:r,temperature:s,top_p:i,frequency_penalty:o,presence_penalty:l,seed:d,prompt:b,stop:x.length>0?x:void 0};switch(m){case"regular":{if((h=e.tools)!=null&&h.length)throw new gr({functionality:"tools"});if(e.toolChoice)throw new gr({functionality:"toolChoice"});return{args:w,warnings:y}}case"object-json":throw new gr({functionality:"object-json mode"});case"object-tool":throw new gr({functionality:"object-tool mode"});default:{const _=m;throw new Error(`Unsupported type: ${_}`)}}}async doGenerate(e){const{args:t,warnings:n}=this.getArgs(e),{responseHeaders:r,value:s,rawValue:i}=await Hs({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:Ws(this.config.headers(),e.headers),body:t,failedResponseHandler:qu,successfulResponseHandler:Ka(Qbe),abortSignal:e.abortSignal,fetch:this.config.fetch}),{prompt:a,...o}=t,l=s.choices[0];return{text:l.text,usage:{promptTokens:s.usage.prompt_tokens,completionTokens:s.usage.completion_tokens},finishReason:$2(l.finish_reason),logprobs:x$(l.logprobs),rawCall:{rawPrompt:a,rawSettings:o},rawResponse:{headers:r,body:i},response:z2(s),warnings:n,request:{body:JSON.stringify(t)}}}async doStream(e){const{args:t,warnings:n}=this.getArgs(e),r={...t,stream:!0,stream_options:this.config.compatibility==="strict"?{include_usage:!0}:void 0},{responseHeaders:s,value:i}=await Hs({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:Ws(this.config.headers(),e.headers),body:r,failedResponseHandler:qu,successfulResponseHandler:rp(eve),abortSignal:e.abortSignal,fetch:this.config.fetch}),{prompt:a,...o}=t;let l="unknown",c={promptTokens:Number.NaN,completionTokens:Number.NaN},u,d=!0;return{stream:i.pipeThrough(new TransformStream({transform(h,m){if(!h.success){l="error",m.enqueue({type:"error",error:h.error});return}const y=h.value;if("error"in y){l="error",m.enqueue({type:"error",error:y.error});return}d&&(d=!1,m.enqueue({type:"response-metadata",...z2(y)})),y.usage!=null&&(c={promptTokens:y.usage.prompt_tokens,completionTokens:y.usage.completion_tokens});const b=y.choices[0];(b==null?void 0:b.finish_reason)!=null&&(l=$2(b.finish_reason)),(b==null?void 0:b.text)!=null&&m.enqueue({type:"text-delta",textDelta:b.text});const v=x$(b==null?void 0:b.logprobs);v!=null&&v.length&&(u===void 0&&(u=[]),u.push(...v))},flush(h){h.enqueue({type:"finish",finishReason:l,logprobs:u,usage:c})}})),rawCall:{rawPrompt:a,rawSettings:o},rawResponse:{headers:s},warnings:n,request:{body:JSON.stringify(r)}}}},Qbe=Ke({id:$e().nullish(),created:Tt().nullish(),model:$e().nullish(),choices:cn(Ke({text:$e(),finish_reason:$e(),logprobs:Ke({tokens:cn($e()),token_logprobs:cn(Tt()),top_logprobs:cn(Dh($e(),Tt())).nullable()}).nullish()})),usage:Ke({prompt_tokens:Tt(),completion_tokens:Tt()})}),eve=ms([Ke({id:$e().nullish(),created:Tt().nullish(),model:$e().nullish(),choices:cn(Ke({text:$e(),finish_reason:$e().nullish(),index:Tt(),logprobs:Ke({tokens:cn($e()),token_logprobs:cn(Tt()),top_logprobs:cn(Dh($e(),Tt())).nullable()}).nullish()})),usage:Ke({prompt_tokens:Tt(),completion_tokens:Tt()}).nullish()}),fO]),tve=class{constructor(e,t,n){this.specificationVersion="v1",this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}get maxEmbeddingsPerCall(){var e;return(e=this.settings.maxEmbeddingsPerCall)!=null?e:2048}get supportsParallelCalls(){var e;return(e=this.settings.supportsParallelCalls)!=null?e:!0}async doEmbed({values:e,headers:t,abortSignal:n}){if(e.length>this.maxEmbeddingsPerCall)throw new OE({provider:this.provider,modelId:this.modelId,maxEmbeddingsPerCall:this.maxEmbeddingsPerCall,values:e});const{responseHeaders:r,value:s}=await Hs({url:this.config.url({path:"/embeddings",modelId:this.modelId}),headers:Ws(this.config.headers(),t),body:{model:this.modelId,input:e,encoding_format:"float",dimensions:this.settings.dimensions,user:this.settings.user},failedResponseHandler:qu,successfulResponseHandler:Ka(nve),abortSignal:n,fetch:this.config.fetch});return{embeddings:s.data.map(i=>i.embedding),usage:s.usage?{tokens:s.usage.prompt_tokens}:void 0,rawResponse:{headers:r}}}},nve=Ke({data:cn(Ke({embedding:cn(Tt())})),usage:Ke({prompt_tokens:Tt()}).nullish()}),rve={"dall-e-3":1,"dall-e-2":10,"gpt-image-1":10},sve=new Set(["gpt-image-1"]),ive=class{constructor(e,t,n){this.modelId=e,this.settings=t,this.config=n,this.specificationVersion="v1"}get maxImagesPerCall(){var e,t;return(t=(e=this.settings.maxImagesPerCall)!=null?e:rve[this.modelId])!=null?t:1}get provider(){return this.config.provider}async doGenerate({prompt:e,n:t,size:n,aspectRatio:r,seed:s,providerOptions:i,headers:a,abortSignal:o}){var l,c,u,d;const h=[];r!=null&&h.push({type:"unsupported-setting",setting:"aspectRatio",details:"This model does not support aspect ratio. Use `size` instead."}),s!=null&&h.push({type:"unsupported-setting",setting:"seed"});const m=(u=(c=(l=this.config._internal)==null?void 0:l.currentDate)==null?void 0:c.call(l))!=null?u:new Date,{value:y,responseHeaders:b}=await Hs({url:this.config.url({path:"/images/generations",modelId:this.modelId}),headers:Ws(this.config.headers(),a),body:{model:this.modelId,prompt:e,n:t,size:n,...(d=i.openai)!=null?d:{},...sve.has(this.modelId)?{}:{response_format:"b64_json"}},failedResponseHandler:qu,successfulResponseHandler:Ka(ave),abortSignal:o,fetch:this.config.fetch});return{images:y.data.map(v=>v.b64_json),warnings:h,response:{timestamp:m,modelId:this.modelId,headers:b}}}},ave=Ke({data:cn(Ke({b64_json:$e()}))}),ove=Ke({include:cn($e()).nullish(),language:$e().nullish(),prompt:$e().nullish(),temperature:Tt().min(0).max(1).nullish().default(0),timestampGranularities:cn(El(["word","segment"])).nullish().default(["segment"])}),w$={afrikaans:"af",arabic:"ar",armenian:"hy",azerbaijani:"az",belarusian:"be",bosnian:"bs",bulgarian:"bg",catalan:"ca",chinese:"zh",croatian:"hr",czech:"cs",danish:"da",dutch:"nl",english:"en",estonian:"et",finnish:"fi",french:"fr",galician:"gl",german:"de",greek:"el",hebrew:"he",hindi:"hi",hungarian:"hu",icelandic:"is",indonesian:"id",italian:"it",japanese:"ja",kannada:"kn",kazakh:"kk",korean:"ko",latvian:"lv",lithuanian:"lt",macedonian:"mk",malay:"ms",marathi:"mr",maori:"mi",nepali:"ne",norwegian:"no",persian:"fa",polish:"pl",portuguese:"pt",romanian:"ro",russian:"ru",serbian:"sr",slovak:"sk",slovenian:"sl",spanish:"es",swahili:"sw",swedish:"sv",tagalog:"tl",tamil:"ta",thai:"th",turkish:"tr",ukrainian:"uk",urdu:"ur",vietnamese:"vi",welsh:"cy"},lve=class{constructor(e,t){this.modelId=e,this.config=t,this.specificationVersion="v1"}get provider(){return this.config.provider}getArgs({audio:e,mediaType:t,providerOptions:n}){var r,s,i,a,o;const l=[],c=FE({provider:"openai",providerOptions:n,schema:ove}),u=new FormData,d=e instanceof Uint8Array?new Blob([e]):new Blob([LE(e)]);if(u.append("model",this.modelId),u.append("file",new File([d],"audio",{type:t})),c){const h={include:(r=c.include)!=null?r:void 0,language:(s=c.language)!=null?s:void 0,prompt:(i=c.prompt)!=null?i:void 0,temperature:(a=c.temperature)!=null?a:void 0,timestamp_granularities:(o=c.timestampGranularities)!=null?o:void 0};for(const m in h){const y=h[m];y!==void 0&&u.append(m,String(y))}}return{formData:u,warnings:l}}async doGenerate(e){var t,n,r,s,i,a;const o=(r=(n=(t=this.config._internal)==null?void 0:t.currentDate)==null?void 0:n.call(t))!=null?r:new Date,{formData:l,warnings:c}=this.getArgs(e),{value:u,responseHeaders:d,rawValue:h}=await dbe({url:this.config.url({path:"/audio/transcriptions",modelId:this.modelId}),headers:Ws(this.config.headers(),e.headers),formData:l,failedResponseHandler:qu,successfulResponseHandler:Ka(cve),abortSignal:e.abortSignal,fetch:this.config.fetch}),m=u.language!=null&&u.language in w$?w$[u.language]:void 0;return{text:u.text,segments:(i=(s=u.words)==null?void 0:s.map(y=>({text:y.word,startSecond:y.start,endSecond:y.end})))!=null?i:[],language:m,durationInSeconds:(a=u.duration)!=null?a:void 0,warnings:c,response:{timestamp:o,modelId:this.modelId,headers:d,body:h}}}},cve=Ke({text:$e(),language:$e().nullish(),duration:Tt().nullish(),words:cn(Ke({word:$e(),start:Tt(),end:Tt()})).nullish()});function uve({prompt:e,systemMessageMode:t}){const n=[],r=[];for(const{role:s,content:i}of e)switch(s){case"system":{switch(t){case"system":{n.push({role:"system",content:i});break}case"developer":{n.push({role:"developer",content:i});break}case"remove":{r.push({type:"other",message:"system messages are removed for this model"});break}default:{const a=t;throw new Error(`Unsupported system message mode: ${a}`)}}break}case"user":{n.push({role:"user",content:i.map((a,o)=>{var l,c,u,d;switch(a.type){case"text":return{type:"input_text",text:a.text};case"image":return{type:"input_image",image_url:a.image instanceof URL?a.image.toString():`data:${(l=a.mimeType)!=null?l:"image/jpeg"};base64,${zu(a.image)}`,detail:(u=(c=a.providerMetadata)==null?void 0:c.openai)==null?void 0:u.imageDetail};case"file":{if(a.data instanceof URL)throw new gr({functionality:"File URLs in user messages"});switch(a.mimeType){case"application/pdf":return{type:"input_file",filename:(d=a.filename)!=null?d:`part-${o}.pdf`,file_data:`data:application/pdf;base64,${a.data}`};default:throw new gr({functionality:"Only PDF files are supported in user messages"})}}}})});break}case"assistant":{for(const a of i)switch(a.type){case"text":{n.push({role:"assistant",content:[{type:"output_text",text:a.text}]});break}case"tool-call":{n.push({type:"function_call",call_id:a.toolCallId,name:a.toolName,arguments:JSON.stringify(a.args)});break}}break}case"tool":{for(const a of i)n.push({type:"function_call_output",call_id:a.toolCallId,output:JSON.stringify(a.result)});break}default:{const a=s;throw new Error(`Unsupported role: ${a}`)}}return{messages:n,warnings:r}}function S$({finishReason:e,hasToolCalls:t}){switch(e){case void 0:case null:return t?"tool-calls":"stop";case"max_output_tokens":return"length";case"content_filter":return"content-filter";default:return t?"tool-calls":"unknown"}}function dve({mode:e,strict:t}){var n;const r=(n=e.tools)!=null&&n.length?e.tools:void 0,s=[];if(r==null)return{tools:void 0,tool_choice:void 0,toolWarnings:s};const i=e.toolChoice,a=[];for(const l of r)switch(l.type){case"function":a.push({type:"function",name:l.name,description:l.description,parameters:l.parameters,strict:t?!0:void 0});break;case"provider-defined":switch(l.id){case"openai.web_search_preview":a.push({type:"web_search_preview",search_context_size:l.args.searchContextSize,user_location:l.args.userLocation});break;default:s.push({type:"unsupported-tool",tool:l});break}break;default:s.push({type:"unsupported-tool",tool:l});break}if(i==null)return{tools:a,tool_choice:void 0,toolWarnings:s};const o=i.type;switch(o){case"auto":case"none":case"required":return{tools:a,tool_choice:o,toolWarnings:s};case"tool":return i.toolName==="web_search_preview"?{tools:a,tool_choice:{type:"web_search_preview"},toolWarnings:s}:{tools:a,tool_choice:{type:"function",name:i.toolName},toolWarnings:s};default:{const l=o;throw new gr({functionality:`Unsupported tool choice type: ${l}`})}}}var fve=class{constructor(e,t){this.specificationVersion="v1",this.defaultObjectGenerationMode="json",this.supportsStructuredOutputs=!0,this.modelId=e,this.config=t}get provider(){return this.config.provider}getArgs({mode:e,maxTokens:t,temperature:n,stopSequences:r,topP:s,topK:i,presencePenalty:a,frequencyPenalty:o,seed:l,prompt:c,providerMetadata:u,responseFormat:d}){var h,m,y;const b=[],v=Nve(this.modelId),x=e.type;i!=null&&b.push({type:"unsupported-setting",setting:"topK"}),l!=null&&b.push({type:"unsupported-setting",setting:"seed"}),a!=null&&b.push({type:"unsupported-setting",setting:"presencePenalty"}),o!=null&&b.push({type:"unsupported-setting",setting:"frequencyPenalty"}),r!=null&&b.push({type:"unsupported-setting",setting:"stopSequences"});const{messages:w,warnings:_}=uve({prompt:c,systemMessageMode:v.systemMessageMode});b.push(..._);const k=FE({provider:"openai",providerOptions:u,schema:Ive}),C=(h=k==null?void 0:k.strictSchemas)!=null?h:!0,T={model:this.modelId,input:w,temperature:n,top_p:s,max_output_tokens:t,...(d==null?void 0:d.type)==="json"&&{text:{format:d.schema!=null?{type:"json_schema",strict:C,name:(m=d.name)!=null?m:"response",description:d.description,schema:d.schema}:{type:"json_object"}}},metadata:k==null?void 0:k.metadata,parallel_tool_calls:k==null?void 0:k.parallelToolCalls,previous_response_id:k==null?void 0:k.previousResponseId,store:k==null?void 0:k.store,user:k==null?void 0:k.user,instructions:k==null?void 0:k.instructions,...v.isReasoningModel&&((k==null?void 0:k.reasoningEffort)!=null||(k==null?void 0:k.reasoningSummary)!=null)&&{reasoning:{...(k==null?void 0:k.reasoningEffort)!=null&&{effort:k.reasoningEffort},...(k==null?void 0:k.reasoningSummary)!=null&&{summary:k.reasoningSummary}}},...v.requiredAutoTruncation&&{truncation:"auto"}};switch(v.isReasoningModel&&(T.temperature!=null&&(T.temperature=void 0,b.push({type:"unsupported-setting",setting:"temperature",details:"temperature is not supported for reasoning models"})),T.top_p!=null&&(T.top_p=void 0,b.push({type:"unsupported-setting",setting:"topP",details:"topP is not supported for reasoning models"}))),x){case"regular":{const{tools:A,tool_choice:N,toolWarnings:I}=dve({mode:e,strict:C});return{args:{...T,tools:A,tool_choice:N},warnings:[...b,...I]}}case"object-json":return{args:{...T,text:{format:e.schema!=null?{type:"json_schema",strict:C,name:(y=e.name)!=null?y:"response",description:e.description,schema:e.schema}:{type:"json_object"}}},warnings:b};case"object-tool":return{args:{...T,tool_choice:{type:"function",name:e.tool.name},tools:[{type:"function",name:e.tool.name,description:e.tool.description,parameters:e.tool.parameters,strict:C}]},warnings:b};default:{const A=x;throw new Error(`Unsupported type: ${A}`)}}}async doGenerate(e){var t,n,r,s,i,a,o;const{args:l,warnings:c}=this.getArgs(e),{responseHeaders:u,value:d,rawValue:h}=await Hs({url:this.config.url({path:"/responses",modelId:this.modelId}),headers:Ws(this.config.headers(),e.headers),body:l,failedResponseHandler:qu,successfulResponseHandler:Ka(Ke({id:$e(),created_at:Tt(),model:$e(),output:cn(BE("type",[Ke({type:Mn("message"),role:Mn("assistant"),content:cn(Ke({type:Mn("output_text"),text:$e(),annotations:cn(Ke({type:Mn("url_citation"),start_index:Tt(),end_index:Tt(),url:$e(),title:$e()}))}))}),Ke({type:Mn("function_call"),call_id:$e(),name:$e(),arguments:$e()}),Ke({type:Mn("web_search_call")}),Ke({type:Mn("computer_call")}),Ke({type:Mn("reasoning"),summary:cn(Ke({type:Mn("summary_text"),text:$e()}))})])),incomplete_details:Ke({reason:$e()}).nullable(),usage:WG})),abortSignal:e.abortSignal,fetch:this.config.fetch}),m=d.output.filter(v=>v.type==="message").flatMap(v=>v.content).filter(v=>v.type==="output_text"),y=d.output.filter(v=>v.type==="function_call").map(v=>({toolCallType:"function",toolCallId:v.call_id,toolName:v.name,args:v.arguments})),b=(n=(t=d.output.find(v=>v.type==="reasoning"))==null?void 0:t.summary)!=null?n:null;return{text:m.map(v=>v.text).join(`
`),sources:m.flatMap(v=>v.annotations.map(x=>{var w,_,k;return{sourceType:"url",id:(k=(_=(w=this.config).generateId)==null?void 0:_.call(w))!=null?k:fa(),url:x.url,title:x.title}})),finishReason:S$({finishReason:(r=d.incomplete_details)==null?void 0:r.reason,hasToolCalls:y.length>0}),toolCalls:y.length>0?y:void 0,reasoning:b?b.map(v=>({type:"text",text:v.text})):void 0,usage:{promptTokens:d.usage.input_tokens,completionTokens:d.usage.output_tokens},rawCall:{rawPrompt:void 0,rawSettings:{}},rawResponse:{headers:u,body:h},request:{body:JSON.stringify(l)},response:{id:d.id,timestamp:new Date(d.created_at*1e3),modelId:d.model},providerMetadata:{openai:{responseId:d.id,cachedPromptTokens:(i=(s=d.usage.input_tokens_details)==null?void 0:s.cached_tokens)!=null?i:null,reasoningTokens:(o=(a=d.usage.output_tokens_details)==null?void 0:a.reasoning_tokens)!=null?o:null}},warnings:c}}async doStream(e){const{args:t,warnings:n}=this.getArgs(e),{responseHeaders:r,value:s}=await Hs({url:this.config.url({path:"/responses",modelId:this.modelId}),headers:Ws(this.config.headers(),e.headers),body:{...t,stream:!0},failedResponseHandler:qu,successfulResponseHandler:rp(wve),abortSignal:e.abortSignal,fetch:this.config.fetch}),i=this;let a="unknown",o=NaN,l=NaN,c=null,u=null,d=null;const h={};let m=!1;return{stream:s.pipeThrough(new TransformStream({transform(y,b){var v,x,w,_,k,C,T,A;if(!y.success){a="error",b.enqueue({type:"error",error:y.error});return}const N=y.value;if(Tve(N))N.item.type==="function_call"&&(h[N.output_index]={toolName:N.item.name,toolCallId:N.item.call_id},b.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:N.item.call_id,toolName:N.item.name,argsTextDelta:N.item.arguments}));else if(Eve(N)){const I=h[N.output_index];I!=null&&b.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:I.toolCallId,toolName:I.toolName,argsTextDelta:N.delta})}else kve(N)?(d=N.response.id,b.enqueue({type:"response-metadata",id:N.response.id,timestamp:new Date(N.response.created_at*1e3),modelId:N.response.model})):Sve(N)?b.enqueue({type:"text-delta",textDelta:N.delta}):Rve(N)?b.enqueue({type:"reasoning",textDelta:N.delta}):_ve(N)&&N.item.type==="function_call"?(h[N.output_index]=void 0,m=!0,b.enqueue({type:"tool-call",toolCallType:"function",toolCallId:N.item.call_id,toolName:N.item.name,args:N.item.arguments})):Cve(N)?(a=S$({finishReason:(v=N.response.incomplete_details)==null?void 0:v.reason,hasToolCalls:m}),o=N.response.usage.input_tokens,l=N.response.usage.output_tokens,c=(w=(x=N.response.usage.input_tokens_details)==null?void 0:x.cached_tokens)!=null?w:c,u=(k=(_=N.response.usage.output_tokens_details)==null?void 0:_.reasoning_tokens)!=null?k:u):Ave(N)&&b.enqueue({type:"source",source:{sourceType:"url",id:(A=(T=(C=i.config).generateId)==null?void 0:T.call(C))!=null?A:fa(),url:N.annotation.url,title:N.annotation.title}})},flush(y){y.enqueue({type:"finish",finishReason:a,usage:{promptTokens:o,completionTokens:l},...(c!=null||u!=null)&&{providerMetadata:{openai:{responseId:d,cachedPromptTokens:c,reasoningTokens:u}}}})}})),rawCall:{rawPrompt:void 0,rawSettings:{}},rawResponse:{headers:r},request:{body:JSON.stringify(t)},warnings:n}}},WG=Ke({input_tokens:Tt(),input_tokens_details:Ke({cached_tokens:Tt().nullish()}).nullish(),output_tokens:Tt(),output_tokens_details:Ke({reasoning_tokens:Tt().nullish()}).nullish()}),hve=Ke({type:Mn("response.output_text.delta"),delta:$e()}),pve=Ke({type:El(["response.completed","response.incomplete"]),response:Ke({incomplete_details:Ke({reason:$e()}).nullish(),usage:WG})}),mve=Ke({type:Mn("response.created"),response:Ke({id:$e(),created_at:Tt(),model:$e()})}),gve=Ke({type:Mn("response.output_item.done"),output_index:Tt(),item:BE("type",[Ke({type:Mn("message")}),Ke({type:Mn("function_call"),id:$e(),call_id:$e(),name:$e(),arguments:$e(),status:Mn("completed")})])}),yve=Ke({type:Mn("response.function_call_arguments.delta"),item_id:$e(),output_index:Tt(),delta:$e()}),bve=Ke({type:Mn("response.output_item.added"),output_index:Tt(),item:BE("type",[Ke({type:Mn("message")}),Ke({type:Mn("function_call"),id:$e(),call_id:$e(),name:$e(),arguments:$e()})])}),vve=Ke({type:Mn("response.output_text.annotation.added"),annotation:Ke({type:Mn("url_citation"),url:$e(),title:$e()})}),xve=Ke({type:Mn("response.reasoning_summary_text.delta"),item_id:$e(),output_index:Tt(),summary_index:Tt(),delta:$e()}),wve=ms([hve,pve,mve,gve,yve,bve,vve,xve,Ke({type:$e()}).passthrough()]);function Sve(e){return e.type==="response.output_text.delta"}function _ve(e){return e.type==="response.output_item.done"}function Cve(e){return e.type==="response.completed"||e.type==="response.incomplete"}function kve(e){return e.type==="response.created"}function Eve(e){return e.type==="response.function_call_arguments.delta"}function Tve(e){return e.type==="response.output_item.added"}function Ave(e){return e.type==="response.output_text.annotation.added"}function Rve(e){return e.type==="response.reasoning_summary_text.delta"}function Nve(e){return e.startsWith("o")?e.startsWith("o1-mini")||e.startsWith("o1-preview")?{isReasoningModel:!0,systemMessageMode:"remove",requiredAutoTruncation:!1}:{isReasoningModel:!0,systemMessageMode:"developer",requiredAutoTruncation:!1}:{isReasoningModel:!1,systemMessageMode:"system",requiredAutoTruncation:!1}}var Ive=Ke({metadata:sf().nullish(),parallelToolCalls:Qn().nullish(),previousResponseId:$e().nullish(),store:Qn().nullish(),user:$e().nullish(),reasoningEffort:$e().nullish(),strictSchemas:Qn().nullish(),instructions:$e().nullish(),reasoningSummary:$e().nullish()}),Mve=Ke({});function jve({searchContextSize:e,userLocation:t}={}){return{type:"provider-defined",id:"openai.web_search_preview",args:{searchContextSize:e,userLocation:t},parameters:Mve}}var Pve={webSearchPreview:jve},Ove=Ke({instructions:$e().nullish(),speed:Tt().min(.25).max(4).default(1).nullish()}),Dve=class{constructor(e,t){this.modelId=e,this.config=t,this.specificationVersion="v1"}get provider(){return this.config.provider}getArgs({text:e,voice:t="alloy",outputFormat:n="mp3",speed:r,instructions:s,providerOptions:i}){const a=[],o=FE({provider:"openai",providerOptions:i,schema:Ove}),l={model:this.modelId,input:e,voice:t,response_format:"mp3",speed:r,instructions:s};if(n&&(["mp3","opus","aac","flac","wav","pcm"].includes(n)?l.response_format=n:a.push({type:"unsupported-setting",setting:"outputFormat",details:`Unsupported output format: ${n}. Using mp3 instead.`})),o){const c={};for(const u in c){const d=c[u];d!==void 0&&(l[u]=d)}}return{requestBody:l,warnings:a}}async doGenerate(e){var t,n,r;const s=(r=(n=(t=this.config._internal)==null?void 0:t.currentDate)==null?void 0:n.call(t))!=null?r:new Date,{requestBody:i,warnings:a}=this.getArgs(e),{value:o,responseHeaders:l,rawValue:c}=await Hs({url:this.config.url({path:"/audio/speech",modelId:this.modelId}),headers:Ws(this.config.headers(),e.headers),body:i,failedResponseHandler:qu,successfulResponseHandler:fbe(),abortSignal:e.abortSignal,fetch:this.config.fetch});return{audio:o,warnings:a,request:{body:JSON.stringify(i)},response:{timestamp:s,modelId:this.modelId,headers:l,body:c}}}};function HG(e={}){var t,n,r;const s=(t=A1(e.baseURL))!=null?t:"https://api.openai.com/v1",i=(n=e.compatibility)!=null?n:"compatible",a=(r=e.name)!=null?r:"openai",o=()=>({Authorization:`Bearer ${cO({apiKey:e.apiKey,environmentVariableName:"OPENAI_API_KEY",description:"OpenAI"})}`,"OpenAI-Organization":e.organization,"OpenAI-Project":e.project,...e.headers}),l=(x,w={})=>new Wbe(x,w,{provider:`${a}.chat`,url:({path:_})=>`${s}${_}`,headers:o,compatibility:i,fetch:e.fetch}),c=(x,w={})=>new Jbe(x,w,{provider:`${a}.completion`,url:({path:_})=>`${s}${_}`,headers:o,compatibility:i,fetch:e.fetch}),u=(x,w={})=>new tve(x,w,{provider:`${a}.embedding`,url:({path:_})=>`${s}${_}`,headers:o,fetch:e.fetch}),d=(x,w={})=>new ive(x,w,{provider:`${a}.image`,url:({path:_})=>`${s}${_}`,headers:o,fetch:e.fetch}),h=x=>new lve(x,{provider:`${a}.transcription`,url:({path:w})=>`${s}${w}`,headers:o,fetch:e.fetch}),m=x=>new Dve(x,{provider:`${a}.speech`,url:({path:w})=>`${s}${w}`,headers:o,fetch:e.fetch}),y=(x,w)=>{if(new.target)throw new Error("The OpenAI model function cannot be called with the new keyword.");return x==="gpt-3.5-turbo-instruct"?c(x,w):l(x,w)},b=x=>new fve(x,{provider:`${a}.responses`,url:({path:w})=>`${s}${w}`,headers:o,fetch:e.fetch}),v=function(x,w){return y(x,w)};return v.languageModel=y,v.chat=l,v.completion=c,v.responses=b,v.embedding=u,v.textEmbedding=u,v.textEmbeddingModel=u,v.image=d,v.imageModel=d,v.transcription=h,v.transcriptionModel=h,v.speech=m,v.speechModel=m,v.tools=Pve,v}HG({compatibility:"strict"});function Gl(e){if(Fve(e))return;if(typeof e=="boolean")return{type:"boolean",properties:{}};const{type:t,description:n,required:r,properties:s,items:i,allOf:a,anyOf:o,oneOf:l,format:c,const:u,minLength:d,enum:h}=e,m={};if(n&&(m.description=n),r&&(m.required=r),c&&(m.format=c),u!==void 0&&(m.enum=[u]),t&&(Array.isArray(t)?t.includes("null")?(m.type=t.filter(y=>y!=="null")[0],m.nullable=!0):m.type=t:t==="null"?m.type="null":m.type=t),h!==void 0&&(m.enum=h),s!=null&&(m.properties=Object.entries(s).reduce((y,[b,v])=>(y[b]=Gl(v),y),{})),i&&(m.items=Array.isArray(i)?i.map(Gl):Gl(i)),a&&(m.allOf=a.map(Gl)),o)if(o.some(y=>typeof y=="object"&&(y==null?void 0:y.type)==="null")){const y=o.filter(b=>!(typeof b=="object"&&(b==null?void 0:b.type)==="null"));if(y.length===1){const b=Gl(y[0]);typeof b=="object"&&(m.nullable=!0,Object.assign(m,b))}else m.anyOf=y.map(Gl),m.nullable=!0}else m.anyOf=o.map(Gl);return l&&(m.oneOf=l.map(Gl)),d!==void 0&&(m.minLength=d),m}function Fve(e){return e!=null&&typeof e=="object"&&e.type==="object"&&(e.properties==null||Object.keys(e.properties).length===0)}function Lve(e){var t,n;const r=[],s=[];let i=!0;for(const{role:a,content:o}of e)switch(a){case"system":{if(!i)throw new gr({functionality:"system messages are only supported at the beginning of the conversation"});r.push({text:o});break}case"user":{i=!1;const l=[];for(const c of o)switch(c.type){case"text":{l.push({text:c.text});break}case"image":{l.push(c.image instanceof URL?{fileData:{mimeType:(t=c.mimeType)!=null?t:"image/jpeg",fileUri:c.image.toString()}}:{inlineData:{mimeType:(n=c.mimeType)!=null?n:"image/jpeg",data:zu(c.image)}});break}case"file":{l.push(c.data instanceof URL?{fileData:{mimeType:c.mimeType,fileUri:c.data.toString()}}:{inlineData:{mimeType:c.mimeType,data:c.data}});break}}s.push({role:"user",parts:l});break}case"assistant":{i=!1,s.push({role:"model",parts:o.map(l=>{switch(l.type){case"text":return l.text.length===0?void 0:{text:l.text};case"file":{if(l.mimeType!=="image/png")throw new gr({functionality:"Only PNG images are supported in assistant messages"});if(l.data instanceof URL)throw new gr({functionality:"File data URLs in assistant messages are not supported"});return{inlineData:{mimeType:l.mimeType,data:l.data}}}case"tool-call":return{functionCall:{name:l.toolName,args:l.args}}}}).filter(l=>l!==void 0)});break}case"tool":{i=!1,s.push({role:"user",parts:o.map(l=>({functionResponse:{name:l.toolName,response:{name:l.toolName,content:l.result}}}))});break}}return{systemInstruction:r.length>0?{parts:r}:void 0,contents:s}}function _$(e){return e.includes("/")?e:`models/${e}`}var Bve=Ke({error:Ke({code:Tt().nullable(),message:$e(),status:$e()})}),A3=np({errorSchema:Bve,errorToMessage:e=>e.error.message});function $ve(e,t,n,r){var s,i;const a=(s=e.tools)!=null&&s.length?e.tools:void 0,o=[],l=r.includes("gemini-2"),c=r.includes("gemini-1.5-flash")&&!r.includes("-8b");if(t)return{tools:l?{googleSearch:{}}:{googleSearchRetrieval:!c||!n?{}:{dynamicRetrievalConfig:n}},toolConfig:void 0,toolWarnings:o};if(a==null)return{tools:void 0,toolConfig:void 0,toolWarnings:o};const u=[];for(const m of a)m.type==="provider-defined"?o.push({type:"unsupported-tool",tool:m}):u.push({name:m.name,description:(i=m.description)!=null?i:"",parameters:Gl(m.parameters)});const d=e.toolChoice;if(d==null)return{tools:{functionDeclarations:u},toolConfig:void 0,toolWarnings:o};const h=d.type;switch(h){case"auto":return{tools:{functionDeclarations:u},toolConfig:{functionCallingConfig:{mode:"AUTO"}},toolWarnings:o};case"none":return{tools:{functionDeclarations:u},toolConfig:{functionCallingConfig:{mode:"NONE"}},toolWarnings:o};case"required":return{tools:{functionDeclarations:u},toolConfig:{functionCallingConfig:{mode:"ANY"}},toolWarnings:o};case"tool":return{tools:{functionDeclarations:u},toolConfig:{functionCallingConfig:{mode:"ANY",allowedFunctionNames:[d.toolName]}},toolWarnings:o};default:{const m=h;throw new gr({functionality:`Unsupported tool choice type: ${m}`})}}}function C$({finishReason:e,hasToolCalls:t}){switch(e){case"STOP":return t?"tool-calls":"stop";case"MAX_TOKENS":return"length";case"IMAGE_SAFETY":case"RECITATION":case"SAFETY":case"BLOCKLIST":case"PROHIBITED_CONTENT":case"SPII":return"content-filter";case"FINISH_REASON_UNSPECIFIED":case"OTHER":return"other";case"MALFORMED_FUNCTION_CALL":return"error";default:return"unknown"}}var zve=class{constructor(e,t,n){this.specificationVersion="v1",this.defaultObjectGenerationMode="json",this.supportsImageUrls=!1,this.modelId=e,this.settings=t,this.config=n}get supportsStructuredOutputs(){var e;return(e=this.settings.structuredOutputs)!=null?e:!0}get provider(){return this.config.provider}async getArgs({mode:e,prompt:t,maxTokens:n,temperature:r,topP:s,topK:i,frequencyPenalty:a,presencePenalty:o,stopSequences:l,responseFormat:c,seed:u,providerMetadata:d}){var h,m,y;const b=e.type,v=[],x=FE({provider:"google",providerOptions:d,schema:Wve});((h=x==null?void 0:x.thinkingConfig)==null?void 0:h.includeThoughts)===!0&&!this.config.provider.startsWith("google.vertex.")&&v.push({type:"other",message:`The 'includeThoughts' option is only supported with the Google Vertex provider and might not be supported or could behave unexpectedly with the current Google provider (${this.config.provider}).`});const w={maxOutputTokens:n,temperature:r,topK:i,topP:s,frequencyPenalty:a,presencePenalty:o,stopSequences:l,seed:u,responseMimeType:(c==null?void 0:c.type)==="json"?"application/json":void 0,responseSchema:(c==null?void 0:c.type)==="json"&&c.schema!=null&&this.supportsStructuredOutputs?Gl(c.schema):void 0,...this.settings.audioTimestamp&&{audioTimestamp:this.settings.audioTimestamp},responseModalities:x==null?void 0:x.responseModalities,thinkingConfig:x==null?void 0:x.thinkingConfig},{contents:_,systemInstruction:k}=Lve(t);switch(b){case"regular":{const{tools:C,toolConfig:T,toolWarnings:A}=$ve(e,(m=this.settings.useSearchGrounding)!=null?m:!1,this.settings.dynamicRetrievalConfig,this.modelId);return{args:{generationConfig:w,contents:_,systemInstruction:k,safetySettings:this.settings.safetySettings,tools:C,toolConfig:T,cachedContent:this.settings.cachedContent},warnings:[...v,...A]}}case"object-json":return{args:{generationConfig:{...w,responseMimeType:"application/json",responseSchema:e.schema!=null&&this.supportsStructuredOutputs?Gl(e.schema):void 0},contents:_,systemInstruction:k,safetySettings:this.settings.safetySettings,cachedContent:this.settings.cachedContent},warnings:v};case"object-tool":return{args:{generationConfig:w,contents:_,tools:{functionDeclarations:[{name:e.tool.name,description:(y=e.tool.description)!=null?y:"",parameters:Gl(e.tool.parameters)}]},toolConfig:{functionCallingConfig:{mode:"ANY"}},safetySettings:this.settings.safetySettings,cachedContent:this.settings.cachedContent},warnings:v};default:{const C=b;throw new Error(`Unsupported type: ${C}`)}}}supportsUrl(e){return this.config.isSupportedUrl(e)}async doGenerate(e){var t,n,r,s,i;const{args:a,warnings:o}=await this.getArgs(e),l=JSON.stringify(a),c=Ws(await x3(this.config.headers),e.headers),{responseHeaders:u,value:d,rawValue:h}=await Hs({url:`${this.config.baseURL}/${_$(this.modelId)}:generateContent`,headers:c,body:a,failedResponseHandler:A3,successfulResponseHandler:Ka(qve),abortSignal:e.abortSignal,fetch:this.config.fetch}),{contents:m,...y}=a,b=d.candidates[0],v=b.content==null||typeof b.content!="object"||!("parts"in b.content)?[]:b.content.parts,x=k$({parts:v,generateId:this.config.generateId}),w=d.usageMetadata;return{text:E$(v),reasoning:T$(v),files:(t=A$(v))==null?void 0:t.map(_=>({data:_.inlineData.data,mimeType:_.inlineData.mimeType})),toolCalls:x,finishReason:C$({finishReason:b.finishReason,hasToolCalls:x!=null&&x.length>0}),usage:{promptTokens:(n=w==null?void 0:w.promptTokenCount)!=null?n:NaN,completionTokens:(r=w==null?void 0:w.candidatesTokenCount)!=null?r:NaN},rawCall:{rawPrompt:m,rawSettings:y},rawResponse:{headers:u,body:h},warnings:o,providerMetadata:{google:{groundingMetadata:(s=b.groundingMetadata)!=null?s:null,safetyRatings:(i=b.safetyRatings)!=null?i:null}},sources:R$({groundingMetadata:b.groundingMetadata,generateId:this.config.generateId}),request:{body:l}}}async doStream(e){const{args:t,warnings:n}=await this.getArgs(e),r=JSON.stringify(t),s=Ws(await x3(this.config.headers),e.headers),{responseHeaders:i,value:a}=await Hs({url:`${this.config.baseURL}/${_$(this.modelId)}:streamGenerateContent?alt=sse`,headers:s,body:t,failedResponseHandler:A3,successfulResponseHandler:rp(Vve),abortSignal:e.abortSignal,fetch:this.config.fetch}),{contents:o,...l}=t;let c="unknown",u={promptTokens:Number.NaN,completionTokens:Number.NaN},d;const h=this.config.generateId;let m=!1;return{stream:a.pipeThrough(new TransformStream({transform(y,b){var v,x,w,_,k,C;if(!y.success){b.enqueue({type:"error",error:y.error});return}const T=y.value,A=T.usageMetadata;A!=null&&(u={promptTokens:(v=A.promptTokenCount)!=null?v:NaN,completionTokens:(x=A.candidatesTokenCount)!=null?x:NaN});const N=(w=T.candidates)==null?void 0:w[0];if(N==null)return;const I=N.content;if(I!=null){const j=E$(I.parts);j!=null&&b.enqueue({type:"text-delta",textDelta:j});const L=T$(I.parts);if(L!=null)for(const O of L)b.enqueue({type:"reasoning",textDelta:O.text});const D=A$(I.parts);if(D!=null)for(const O of D)b.enqueue({type:"file",mimeType:O.inlineData.mimeType,data:O.inlineData.data});const H=k$({parts:I.parts,generateId:h});if(H!=null)for(const O of H)b.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:O.toolCallId,toolName:O.toolName,argsTextDelta:O.args}),b.enqueue({type:"tool-call",toolCallType:"function",toolCallId:O.toolCallId,toolName:O.toolName,args:O.args}),m=!0}if(N.finishReason!=null){c=C$({finishReason:N.finishReason,hasToolCalls:m});const j=(_=R$({groundingMetadata:N.groundingMetadata,generateId:h}))!=null?_:[];for(const L of j)b.enqueue({type:"source",source:L});d={google:{groundingMetadata:(k=N.groundingMetadata)!=null?k:null,safetyRatings:(C=N.safetyRatings)!=null?C:null}}}},flush(y){y.enqueue({type:"finish",finishReason:c,usage:u,providerMetadata:d})}})),rawCall:{rawPrompt:o,rawSettings:l},rawResponse:{headers:i},warnings:n,request:{body:r}}}};function k$({parts:e,generateId:t}){const n=e==null?void 0:e.filter(r=>"functionCall"in r);return n==null||n.length===0?void 0:n.map(r=>({toolCallType:"function",toolCallId:t(),toolName:r.functionCall.name,args:JSON.stringify(r.functionCall.args)}))}function E$(e){const t=e==null?void 0:e.filter(n=>"text"in n&&n.thought!==!0);return t==null||t.length===0?void 0:t.map(n=>n.text).join("")}function T$(e){const t=e==null?void 0:e.filter(n=>"text"in n&&n.thought===!0&&n.text!=null);return t==null||t.length===0?void 0:t.map(n=>({type:"text",text:n.text}))}function A$(e){return e==null?void 0:e.filter(t=>"inlineData"in t)}function R$({groundingMetadata:e,generateId:t}){var n;return(n=e==null?void 0:e.groundingChunks)==null?void 0:n.filter(r=>r.web!=null).map(r=>({sourceType:"url",id:t(),url:r.web.uri,title:r.web.title}))}var GG=Ke({parts:cn(ms([Ke({functionCall:Ke({name:$e(),args:nb()})}),Ke({inlineData:Ke({mimeType:$e(),data:$e()})}),Ke({text:$e().nullish(),thought:Qn().nullish()})])).nullish()}),Uve=Ke({web:Ke({uri:$e(),title:$e()}).nullish(),retrievedContext:Ke({uri:$e(),title:$e()}).nullish()}),KG=Ke({webSearchQueries:cn($e()).nullish(),retrievalQueries:cn($e()).nullish(),searchEntryPoint:Ke({renderedContent:$e()}).nullish(),groundingChunks:cn(Uve).nullish(),groundingSupports:cn(Ke({segment:Ke({startIndex:Tt().nullish(),endIndex:Tt().nullish(),text:$e().nullish()}),segment_text:$e().nullish(),groundingChunkIndices:cn(Tt()).nullish(),supportChunkIndices:cn(Tt()).nullish(),confidenceScores:cn(Tt()).nullish(),confidenceScore:cn(Tt()).nullish()})).nullish(),retrievalMetadata:ms([Ke({webDynamicRetrievalScore:Tt()}),Ke({})]).nullish()}),YG=Ke({category:$e().nullish(),probability:$e().nullish(),probabilityScore:Tt().nullish(),severity:$e().nullish(),severityScore:Tt().nullish(),blocked:Qn().nullish()}),qve=Ke({candidates:cn(Ke({content:GG.nullish().or(Ke({}).strict()),finishReason:$e().nullish(),safetyRatings:cn(YG).nullish(),groundingMetadata:KG.nullish()})),usageMetadata:Ke({promptTokenCount:Tt().nullish(),candidatesTokenCount:Tt().nullish(),totalTokenCount:Tt().nullish()}).nullish()}),Vve=Ke({candidates:cn(Ke({content:GG.nullish(),finishReason:$e().nullish(),safetyRatings:cn(YG).nullish(),groundingMetadata:KG.nullish()})).nullish(),usageMetadata:Ke({promptTokenCount:Tt().nullish(),candidatesTokenCount:Tt().nullish(),totalTokenCount:Tt().nullish()}).nullish()}),Wve=Ke({responseModalities:cn(El(["TEXT","IMAGE"])).nullish(),thinkingConfig:Ke({thinkingBudget:Tt().nullish(),includeThoughts:Qn().nullish()}).nullish()}),Hve=class{constructor(e,t,n){this.specificationVersion="v1",this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}get maxEmbeddingsPerCall(){return 2048}get supportsParallelCalls(){return!0}async doEmbed({values:e,headers:t,abortSignal:n}){if(e.length>this.maxEmbeddingsPerCall)throw new OE({provider:this.provider,modelId:this.modelId,maxEmbeddingsPerCall:this.maxEmbeddingsPerCall,values:e});const r=Ws(await x3(this.config.headers),t),{responseHeaders:s,value:i}=await Hs({url:`${this.config.baseURL}/models/${this.modelId}:batchEmbedContents`,headers:r,body:{requests:e.map(a=>({model:`models/${this.modelId}`,content:{role:"user",parts:[{text:a}]},outputDimensionality:this.settings.outputDimensionality,taskType:this.settings.taskType}))},failedResponseHandler:A3,successfulResponseHandler:Ka(Gve),abortSignal:n,fetch:this.config.fetch});return{embeddings:i.embeddings.map(a=>a.values),usage:void 0,rawResponse:{headers:s}}}},Gve=Ke({embeddings:cn(Ke({values:cn(Tt())}))});function Kve(e){return e.toString().startsWith("https://generativelanguage.googleapis.com/v1beta/files/")}function ZG(e={}){var t;const n=(t=A1(e.baseURL))!=null?t:"https://generativelanguage.googleapis.com/v1beta",r=()=>({"x-goog-api-key":cO({apiKey:e.apiKey,environmentVariableName:"GOOGLE_GENERATIVE_AI_API_KEY",description:"Google Generative AI"}),...e.headers}),s=(o,l={})=>{var c;return new zve(o,l,{provider:"google.generative-ai",baseURL:n,headers:r,generateId:(c=e.generateId)!=null?c:fa,isSupportedUrl:Kve,fetch:e.fetch})},i=(o,l={})=>new Hve(o,l,{provider:"google.generative-ai",baseURL:n,headers:r,fetch:e.fetch}),a=function(o,l){if(new.target)throw new Error("The Google Generative AI model function cannot be called with the new keyword.");return s(o,l)};return a.languageModel=s,a.chat=s,a.generativeAI=s,a.embedding=i,a.textEmbedding=i,a.textEmbeddingModel=i,a}ZG();var Yve=Object.defineProperty,Zve=Object.defineProperties,Xve=Object.getOwnPropertyDescriptors,U2=Object.getOwnPropertySymbols,XG=Object.prototype.hasOwnProperty,JG=Object.prototype.propertyIsEnumerable,N$=(e,t,n)=>t in e?Yve(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,La=(e,t)=>{for(var n in t||(t={}))XG.call(t,n)&&N$(e,n,t[n]);if(U2)for(var n of U2(t))JG.call(t,n)&&N$(e,n,t[n]);return e},VC=(e,t)=>Zve(e,Xve(t)),q2=(e,t)=>{var n={};for(var r in e)XG.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&U2)for(var r of U2(e))t.indexOf(r)<0&&JG.call(e,r)&&(n[r]=e[r]);return n},Jve=Ke({type:Mn("reasoning.summary"),summary:$e()}),Qve=Ke({type:Mn("reasoning.encrypted"),data:$e()}),exe=Ke({type:Mn("reasoning.text"),text:$e().nullish(),signature:$e().nullish()}),txe=ms([Jve,Qve,exe]),nxe=ms([txe,nb().transform(()=>null)]),hO=cn(nxe).transform(e=>e.filter(t=>!!t));function uh(e){var t,n,r;const s=e==null?void 0:e.anthropic,i=e==null?void 0:e.openrouter;return(r=(n=(t=i==null?void 0:i.cacheControl)!=null?t:i==null?void 0:i.cache_control)!=null?n:s==null?void 0:s.cacheControl)!=null?r:s==null?void 0:s.cache_control}function rxe(e){var t,n,r;const s=[];for(const{role:i,content:a,providerMetadata:o}of e)switch(i){case"system":{s.push({role:"system",content:a,cache_control:uh(o)});break}case"user":{if(a.length===1&&((t=a[0])==null?void 0:t.type)==="text"){s.push({role:"user",content:a[0].text,cache_control:(n=uh(o))!=null?n:uh(a[0].providerMetadata)});break}const l=uh(o),c=a.map(u=>{var d,h,m,y;const b=(d=uh(u.providerMetadata))!=null?d:l;switch(u.type){case"text":return{type:"text",text:u.text,cache_control:b};case"image":return{type:"image_url",image_url:{url:u.image instanceof URL?u.image.toString():`data:${(h=u.mimeType)!=null?h:"image/jpeg"};base64,${zu(u.image)}`},cache_control:b};case"file":return{type:"file",file:{filename:String((y=(m=u.providerMetadata)==null?void 0:m.openrouter)==null?void 0:y.filename),file_data:u.data instanceof Uint8Array?`data:${u.mimeType};base64,${zu(u.data)}`:`data:${u.mimeType};base64,${u.data}`},cache_control:b};default:{const v=u;throw new Error(`Unsupported content part type: ${v}`)}}});s.push({role:"user",content:c});break}case"assistant":{let l="",c="";const u=[],d=[];for(const h of a)switch(h.type){case"text":{l+=h.text;break}case"tool-call":{d.push({id:h.toolCallId,type:"function",function:{name:h.toolName,arguments:JSON.stringify(h.args)}});break}case"reasoning":{c+=h.text,u.push({type:"reasoning.text",text:h.text,signature:h.signature});break}case"redacted-reasoning":{u.push({type:"reasoning.encrypted",data:h.data});break}case"file":break;default:{const m=h;throw new Error(`Unsupported part: ${m}`)}}s.push({role:"assistant",content:l,tool_calls:d.length>0?d:void 0,reasoning:c||void 0,reasoning_details:u.length>0?u:void 0,cache_control:uh(o)});break}case"tool":{for(const l of a)s.push({role:"tool",tool_call_id:l.toolCallId,content:JSON.stringify(l.result),cache_control:(r=uh(o))!=null?r:uh(l.providerMetadata)});break}default:{const l=i;throw new Error(`Unsupported role: ${l}`)}}return s}function I$(e){var t,n;return(n=(t=e==null?void 0:e.content)==null?void 0:t.map(({token:r,logprob:s,top_logprobs:i})=>({token:r,logprob:s,topLogprobs:i?i.map(({token:a,logprob:o})=>({token:a,logprob:o})):[]})))!=null?n:void 0}function V2(e){switch(e){case"stop":return"stop";case"length":return"length";case"content_filter":return"content-filter";case"function_call":case"tool_calls":return"tool-calls";default:return"unknown"}}var pO=Ke({error:Ke({code:ms([$e(),Tt()]).nullable(),message:$e(),type:$e().nullable(),param:sf().nullable()})}),W2=np({errorSchema:pO,errorToMessage:e=>e.error.message});function sxe(e){return"parameters"in e}var ixe=class{constructor(e,t,n){this.specificationVersion="v1",this.defaultObjectGenerationMode="tool",this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}getArgs({mode:e,prompt:t,maxTokens:n,temperature:r,topP:s,frequencyPenalty:i,presencePenalty:a,seed:o,stopSequences:l,responseFormat:c,topK:u,providerMetadata:d}){var h;const m=e.type,y=(h=d==null?void 0:d.openrouter)!=null?h:{},b=La(La(La({model:this.modelId,models:this.settings.models,logit_bias:this.settings.logitBias,logprobs:this.settings.logprobs===!0||typeof this.settings.logprobs=="number"?!0:void 0,top_logprobs:typeof this.settings.logprobs=="number"?this.settings.logprobs:typeof this.settings.logprobs=="boolean"&&this.settings.logprobs?0:void 0,user:this.settings.user,parallel_tool_calls:this.settings.parallelToolCalls,max_tokens:n,temperature:r,top_p:s,frequency_penalty:i,presence_penalty:a,seed:o,stop:l,response_format:c,top_k:u,messages:rxe(t),include_reasoning:this.settings.includeReasoning,reasoning:this.settings.reasoning,usage:this.settings.usage},this.config.extraBody),this.settings.extraBody),y);switch(m){case"regular":return La(La({},b),lxe(e));case"object-json":return VC(La({},b),{response_format:{type:"json_object"}});case"object-tool":return VC(La({},b),{tool_choice:{type:"function",function:{name:e.tool.name}},tools:[{type:"function",function:{name:e.tool.name,description:e.tool.description,parameters:e.tool.parameters}}]});default:{const v=m;throw new gr({functionality:`${v} mode`})}}}async doGenerate(e){var t,n,r,s,i,a,o,l,c;const u=this.getArgs(e),{responseHeaders:d,value:h}=await Hs({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:Ws(this.config.headers(),e.headers),body:u,failedResponseHandler:W2,successfulResponseHandler:Ka(axe),abortSignal:e.abortSignal,fetch:this.config.fetch}),m=u,{messages:y}=m,b=q2(m,["messages"]),v=h.choices[0];if(!v)throw new Error("No choice in response");const x=h.usage?{promptTokens:(t=h.usage.prompt_tokens)!=null?t:0,completionTokens:(n=h.usage.completion_tokens)!=null?n:0}:{promptTokens:0,completionTokens:0},w={};h.usage&&((r=this.settings.usage)!=null&&r.include)&&(w.openrouter={usage:{promptTokens:h.usage.prompt_tokens,promptTokensDetails:h.usage.prompt_tokens_details?{cachedTokens:(s=h.usage.prompt_tokens_details.cached_tokens)!=null?s:0}:void 0,completionTokens:h.usage.completion_tokens,completionTokensDetails:h.usage.completion_tokens_details?{reasoningTokens:(i=h.usage.completion_tokens_details.reasoning_tokens)!=null?i:0}:void 0,cost:h.usage.cost,totalTokens:(a=h.usage.total_tokens)!=null?a:0}});const _=Object.keys(w).length>0,k=(o=v.message.reasoning_details)!=null?o:[],C=k.length>0?k.map(T=>{var A;switch(T.type){case"reasoning.text":{if(T.text)return{type:"text",text:T.text,signature:(A=T.signature)!=null?A:void 0};break}case"reasoning.summary":{if(T.summary)return{type:"text",text:T.summary};break}case"reasoning.encrypted":{if(T.data)return{type:"redacted",data:T.data};break}}return null}).filter(T=>T!==null):v.message.reasoning?[{type:"text",text:v.message.reasoning}]:[];return La({response:{id:h.id,modelId:h.model},text:(l=v.message.content)!=null?l:void 0,reasoning:C,toolCalls:(c=v.message.tool_calls)==null?void 0:c.map(T=>{var A;return{toolCallType:"function",toolCallId:(A=T.id)!=null?A:fa(),toolName:T.function.name,args:T.function.arguments}}),finishReason:V2(v.finish_reason),usage:x,rawCall:{rawPrompt:y,rawSettings:b},rawResponse:{headers:d},warnings:[],logprobs:I$(v.logprobs)},_?{providerMetadata:w}:{})}async doStream(e){var t,n;const r=this.getArgs(e),{responseHeaders:s,value:i}=await Hs({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:Ws(this.config.headers(),e.headers),body:VC(La({},r),{stream:!0,stream_options:this.config.compatibility==="strict"?La({include_usage:!0},(t=this.settings.usage)!=null&&t.include?{include_usage:!0}:{}):void 0}),failedResponseHandler:W2,successfulResponseHandler:rp(oxe),abortSignal:e.abortSignal,fetch:this.config.fetch}),a=r,{messages:o}=a,l=q2(a,["messages"]),c=[];let u="other",d={promptTokens:Number.NaN,completionTokens:Number.NaN},h;const m={},y=!!((n=this.settings.usage)!=null&&n.include);return{stream:i.pipeThrough(new TransformStream({transform(b,v){var x,w,_,k,C,T,A,N,I,j,L,D,H,O;if(!b.success){u="error",v.enqueue({type:"error",error:b.error});return}const K=b.value;if("error"in K){u="error",v.enqueue({type:"error",error:K.error});return}K.id&&v.enqueue({type:"response-metadata",id:K.id}),K.model&&v.enqueue({type:"response-metadata",modelId:K.model}),K.usage!=null&&(d={promptTokens:K.usage.prompt_tokens,completionTokens:K.usage.completion_tokens},m.promptTokens=K.usage.prompt_tokens,K.usage.prompt_tokens_details&&(m.promptTokensDetails={cachedTokens:(x=K.usage.prompt_tokens_details.cached_tokens)!=null?x:0}),m.completionTokens=K.usage.completion_tokens,K.usage.completion_tokens_details&&(m.completionTokensDetails={reasoningTokens:(w=K.usage.completion_tokens_details.reasoning_tokens)!=null?w:0}),m.cost=K.usage.cost,m.totalTokens=K.usage.total_tokens);const U=K.choices[0];if((U==null?void 0:U.finish_reason)!=null&&(u=V2(U.finish_reason)),(U==null?void 0:U.delta)==null)return;const W=U.delta;if(W.content!=null&&v.enqueue({type:"text-delta",textDelta:W.content}),W.reasoning!=null&&v.enqueue({type:"reasoning",textDelta:W.reasoning}),W.reasoning_details&&W.reasoning_details.length>0)for(const ne of W.reasoning_details)switch(ne.type){case"reasoning.text":{ne.text&&v.enqueue({type:"reasoning",textDelta:ne.text}),ne.signature&&v.enqueue({type:"reasoning-signature",signature:ne.signature});break}case"reasoning.encrypted":{ne.data&&v.enqueue({type:"redacted-reasoning",data:ne.data});break}case"reasoning.summary":{ne.summary&&v.enqueue({type:"reasoning",textDelta:ne.summary});break}}const B=I$(U==null?void 0:U.logprobs);if(B!=null&&B.length&&(h===void 0&&(h=[]),h.push(...B)),W.tool_calls!=null)for(const ne of W.tool_calls){const V=ne.index;if(c[V]==null){if(ne.type!=="function")throw new Yd({data:ne,message:"Expected 'function' type."});if(ne.id==null)throw new Yd({data:ne,message:"Expected 'id' to be a string."});if(((_=ne.function)==null?void 0:_.name)==null)throw new Yd({data:ne,message:"Expected 'function.name' to be a string."});c[V]={id:ne.id,type:"function",function:{name:ne.function.name,arguments:(k=ne.function.arguments)!=null?k:""},sent:!1};const ee=c[V];if(ee==null)throw new Error("Tool call is missing");((C=ee.function)==null?void 0:C.name)!=null&&((T=ee.function)==null?void 0:T.arguments)!=null&&xm(ee.function.arguments)&&(v.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:ee.id,toolName:ee.function.name,argsTextDelta:ee.function.arguments}),v.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(A=ee.id)!=null?A:fa(),toolName:ee.function.name,args:ee.function.arguments}),ee.sent=!0);continue}const Q=c[V];if(Q==null)throw new Error("Tool call is missing");((N=ne.function)==null?void 0:N.arguments)!=null&&(Q.function.arguments+=(j=(I=ne.function)==null?void 0:I.arguments)!=null?j:""),v.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:Q.id,toolName:Q.function.name,argsTextDelta:(L=ne.function.arguments)!=null?L:""}),((D=Q.function)==null?void 0:D.name)!=null&&((H=Q.function)==null?void 0:H.arguments)!=null&&xm(Q.function.arguments)&&(v.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(O=Q.id)!=null?O:fa(),toolName:Q.function.name,args:Q.function.arguments}),Q.sent=!0)}},flush(b){var v;if(u==="tool-calls")for(const _ of c)_.sent||(b.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(v=_.id)!=null?v:fa(),toolName:_.function.name,args:xm(_.function.arguments)?_.function.arguments:"{}"}),_.sent=!0);const x={};y&&(m.totalTokens!==void 0||m.cost!==void 0||m.promptTokensDetails!==void 0||m.completionTokensDetails!==void 0)&&(x.openrouter={usage:m});const w=Object.keys(x).length>0&&y;b.enqueue(La({type:"finish",finishReason:u,logprobs:h,usage:d},w?{providerMetadata:x}:{}))}})),rawCall:{rawPrompt:o,rawSettings:l},rawResponse:{headers:s},warnings:[]}}},QG=Ke({id:$e().optional(),model:$e().optional(),usage:Ke({prompt_tokens:Tt(),prompt_tokens_details:Ke({cached_tokens:Tt()}).nullish(),completion_tokens:Tt(),completion_tokens_details:Ke({reasoning_tokens:Tt()}).nullish(),total_tokens:Tt(),cost:Tt().optional()}).nullish()}),axe=QG.extend({choices:cn(Ke({message:Ke({role:Mn("assistant"),content:$e().nullable().optional(),reasoning:$e().nullable().optional(),reasoning_details:hO.nullish(),tool_calls:cn(Ke({id:$e().optional().nullable(),type:Mn("function"),function:Ke({name:$e(),arguments:$e()})})).optional()}),index:Tt(),logprobs:Ke({content:cn(Ke({token:$e(),logprob:Tt(),top_logprobs:cn(Ke({token:$e(),logprob:Tt()}))})).nullable()}).nullable().optional(),finish_reason:$e().optional().nullable()}))}),oxe=ms([QG.extend({choices:cn(Ke({delta:Ke({role:El(["assistant"]).optional(),content:$e().nullish(),reasoning:$e().nullish().optional(),reasoning_details:hO.nullish(),tool_calls:cn(Ke({index:Tt(),id:$e().nullish(),type:Mn("function").optional(),function:Ke({name:$e().nullish(),arguments:$e().nullish()})})).nullish()}).nullish(),logprobs:Ke({content:cn(Ke({token:$e(),logprob:Tt(),top_logprobs:cn(Ke({token:$e(),logprob:Tt()}))})).nullable()}).nullish(),finish_reason:$e().nullable().optional(),index:Tt()}))}),pO]);function lxe(e){var t;const n=(t=e.tools)!=null&&t.length?e.tools:void 0;if(n==null)return{tools:void 0,tool_choice:void 0};const r=n.map(a=>sxe(a)?{type:"function",function:{name:a.name,description:a.description,parameters:a.parameters}}:{type:"function",function:{name:a.name}}),s=e.toolChoice;if(s==null)return{tools:r,tool_choice:void 0};const i=s.type;switch(i){case"auto":case"none":case"required":return{tools:r,tool_choice:i};case"tool":return{tools:r,tool_choice:{type:"function",function:{name:s.toolName}}};default:{const a=i;throw new Error(`Unsupported tool choice type: ${a}`)}}}function cxe({prompt:e,inputFormat:t,user:n="user",assistant:r="assistant"}){if(t==="prompt"&&e.length===1&&e[0]&&e[0].role==="user"&&e[0].content.length===1&&e[0].content[0]&&e[0].content[0].type==="text")return{prompt:e[0].content[0].text};let s="";e[0]&&e[0].role==="system"&&(s+=`${e[0].content}

`,e=e.slice(1));for(const{role:i,content:a}of e)switch(i){case"system":throw new Ic({message:"Unexpected system message in prompt: ${content}",prompt:e});case"user":{const o=a.map(l=>{switch(l.type){case"text":return l.text;case"image":throw new gr({functionality:"images"});case"file":throw new gr({functionality:"file attachments"});default:{const c=l;throw new Error(`Unsupported content type: ${c}`)}}}).join("");s+=`${n}:
${o}

`;break}case"assistant":{const o=a.map(l=>{switch(l.type){case"text":return l.text;case"tool-call":throw new gr({functionality:"tool-call messages"});case"reasoning":throw new gr({functionality:"reasoning messages"});case"redacted-reasoning":throw new gr({functionality:"redacted reasoning messages"});case"file":throw new gr({functionality:"file attachments"});default:{const c=l;throw new Error(`Unsupported content type: ${c}`)}}}).join("");s+=`${r}:
${o}

`;break}case"tool":throw new gr({functionality:"tool messages"});default:{const o=i;throw new Error(`Unsupported role: ${o}`)}}return s+=`${r}:
`,{prompt:s}}function M$(e){return e==null?void 0:e.tokens.map((t,n)=>{var r,s;return{token:t,logprob:(r=e.token_logprobs[n])!=null?r:0,topLogprobs:e.top_logprobs?Object.entries((s=e.top_logprobs[n])!=null?s:{}).map(([i,a])=>({token:i,logprob:a})):[]}})}var uxe=class{constructor(e,t,n){this.specificationVersion="v1",this.defaultObjectGenerationMode=void 0,this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}getArgs({mode:e,inputFormat:t,prompt:n,maxTokens:r,temperature:s,topP:i,frequencyPenalty:a,presencePenalty:o,seed:l,responseFormat:c,topK:u,stopSequences:d,providerMetadata:h}){var m,y;const b=e.type,v=(m=h==null?void 0:h.openrouter)!=null?m:{},{prompt:x}=cxe({prompt:n,inputFormat:t}),w=La(La(La({model:this.modelId,models:this.settings.models,logit_bias:this.settings.logitBias,logprobs:typeof this.settings.logprobs=="number"?this.settings.logprobs:typeof this.settings.logprobs=="boolean"&&this.settings.logprobs?0:void 0,suffix:this.settings.suffix,user:this.settings.user,max_tokens:r,temperature:s,top_p:i,frequency_penalty:a,presence_penalty:o,seed:l,stop:d,response_format:c,top_k:u,prompt:x,include_reasoning:this.settings.includeReasoning,reasoning:this.settings.reasoning},this.config.extraBody),this.settings.extraBody),v);switch(b){case"regular":{if((y=e.tools)!=null&&y.length)throw new gr({functionality:"tools"});if(e.toolChoice)throw new gr({functionality:"toolChoice"});return w}case"object-json":throw new gr({functionality:"object-json mode"});case"object-tool":throw new gr({functionality:"object-tool mode"});default:{const _=b;throw new gr({functionality:`${_} mode`})}}}async doGenerate(e){var t,n,r,s,i;const a=this.getArgs(e),{responseHeaders:o,value:l}=await Hs({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:Ws(this.config.headers(),e.headers),body:a,failedResponseHandler:W2,successfulResponseHandler:Ka(j$),abortSignal:e.abortSignal,fetch:this.config.fetch}),c=a,{prompt:u}=c,d=q2(c,["prompt"]);if("error"in l)throw new Error(`${l.error.message}`);const h=l.choices[0];if(!h)throw new Error("No choice in OpenRouter completion response");return{response:{id:l.id,modelId:l.model},text:(t=h.text)!=null?t:"",reasoning:h.reasoning||void 0,usage:{promptTokens:(r=(n=l.usage)==null?void 0:n.prompt_tokens)!=null?r:0,completionTokens:(i=(s=l.usage)==null?void 0:s.completion_tokens)!=null?i:0},finishReason:V2(h.finish_reason),logprobs:M$(h.logprobs),rawCall:{rawPrompt:u,rawSettings:d},rawResponse:{headers:o},warnings:[]}}async doStream(e){const t=this.getArgs(e),{responseHeaders:n,value:r}=await Hs({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:Ws(this.config.headers(),e.headers),body:VC(La({},this.getArgs(e)),{stream:!0,stream_options:this.config.compatibility==="strict"?{include_usage:!0}:void 0}),failedResponseHandler:W2,successfulResponseHandler:rp(j$),abortSignal:e.abortSignal,fetch:this.config.fetch}),s=t,{prompt:i}=s,a=q2(s,["prompt"]);let o="other",l={promptTokens:Number.NaN,completionTokens:Number.NaN},c;return{stream:r.pipeThrough(new TransformStream({transform(u,d){if(!u.success){o="error",d.enqueue({type:"error",error:u.error});return}const h=u.value;if("error"in h){o="error",d.enqueue({type:"error",error:h.error});return}h.usage!=null&&(l={promptTokens:h.usage.prompt_tokens,completionTokens:h.usage.completion_tokens});const m=h.choices[0];(m==null?void 0:m.finish_reason)!=null&&(o=V2(m.finish_reason)),(m==null?void 0:m.text)!=null&&d.enqueue({type:"text-delta",textDelta:m.text});const y=M$(m==null?void 0:m.logprobs);y!=null&&y.length&&(c===void 0&&(c=[]),c.push(...y))},flush(u){u.enqueue({type:"finish",finishReason:o,logprobs:c,usage:l})}})),rawCall:{rawPrompt:i,rawSettings:a},rawResponse:{headers:n},warnings:[]}}},j$=ms([Ke({id:$e().optional(),model:$e().optional(),choices:cn(Ke({text:$e(),reasoning:$e().nullish().optional(),reasoning_details:hO.nullish(),finish_reason:$e().nullish(),index:Tt(),logprobs:Ke({tokens:cn($e()),token_logprobs:cn(Tt()),top_logprobs:cn(Dh($e(),Tt())).nullable()}).nullable().optional()})),usage:Ke({prompt_tokens:Tt(),completion_tokens:Tt()}).optional().nullable()}),pO]);function eK(e={}){var t,n,r;const s=(n=A1((t=e.baseURL)!=null?t:e.baseUrl))!=null?n:"https://openrouter.ai/api/v1",i=(r=e.compatibility)!=null?r:"compatible",a=()=>La({Authorization:`Bearer ${cO({apiKey:e.apiKey,environmentVariableName:"OPENROUTER_API_KEY",description:"OpenRouter"})}`},e.headers),o=(d,h={})=>new ixe(d,h,{provider:"openrouter.chat",url:({path:m})=>`${s}${m}`,headers:a,compatibility:i,fetch:e.fetch,extraBody:e.extraBody}),l=(d,h={})=>new uxe(d,h,{provider:"openrouter.completion",url:({path:m})=>`${s}${m}`,headers:a,compatibility:i,fetch:e.fetch,extraBody:e.extraBody}),c=(d,h)=>{if(new.target)throw new Error("The OpenRouter model function cannot be called with the new keyword.");return d==="openai/gpt-3.5-turbo-instruct"?l(d,h):o(d,h)},u=(d,h)=>c(d,h);return u.languageModel=c,u.chat=o,u.completion=l,u}eK({compatibility:"strict"});var Wp={},jN={},P$;function O$(){return P$||(P$=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Allow=e.ALL=e.COLLECTION=e.ATOM=e.SPECIAL=e.INF=e._INFINITY=e.INFINITY=e.NAN=e.BOOL=e.NULL=e.OBJ=e.ARR=e.NUM=e.STR=void 0,e.STR=1,e.NUM=2,e.ARR=4,e.OBJ=8,e.NULL=16,e.BOOL=32,e.NAN=64,e.INFINITY=128,e._INFINITY=256,e.INF=e.INFINITY|e._INFINITY,e.SPECIAL=e.NULL|e.BOOL|e.INF|e.NAN,e.ATOM=e.STR|e.NUM|e.SPECIAL,e.COLLECTION=e.ARR|e.OBJ,e.ALL=e.ATOM|e.COLLECTION,e.Allow={STR:e.STR,NUM:e.NUM,ARR:e.ARR,OBJ:e.OBJ,NULL:e.NULL,BOOL:e.BOOL,NAN:e.NAN,INFINITY:e.INFINITY,_INFINITY:e._INFINITY,INF:e.INF,SPECIAL:e.SPECIAL,ATOM:e.ATOM,COLLECTION:e.COLLECTION,ALL:e.ALL},e.default=e.Allow}(jN)),jN}var D$;function dxe(){return D$||(D$=1,function(e){var t=Wp&&Wp.__createBinding||(Object.create?function(c,u,d,h){h===void 0&&(h=d);var m=Object.getOwnPropertyDescriptor(u,d);(!m||("get"in m?!u.__esModule:m.writable||m.configurable))&&(m={enumerable:!0,get:function(){return u[d]}}),Object.defineProperty(c,h,m)}:function(c,u,d,h){h===void 0&&(h=d),c[h]=u[d]}),n=Wp&&Wp.__exportStar||function(c,u){for(var d in c)d!=="default"&&!Object.prototype.hasOwnProperty.call(u,d)&&t(u,c,d)};Object.defineProperty(e,"__esModule",{value:!0}),e.Allow=e.MalformedJSON=e.PartialJSON=e.parseJSON=e.parse=void 0;const r=O$();Object.defineProperty(e,"Allow",{enumerable:!0,get:function(){return r.Allow}}),n(O$(),e);class s extends Error{}e.PartialJSON=s;class i extends Error{}e.MalformedJSON=i;function a(c,u=r.Allow.ALL){if(typeof c!="string")throw new TypeError(`expecting str, got ${typeof c}`);if(!c.trim())throw new Error(`${c} is empty`);return o(c.trim(),u)}e.parseJSON=a;const o=(c,u)=>{const d=c.length;let h=0;const m=C=>{throw new s(`${C} at position ${h}`)},y=C=>{throw new i(`${C} at position ${h}`)},b=()=>(k(),h>=d&&m("Unexpected end of input"),c[h]==='"'?v():c[h]==="{"?x():c[h]==="["?w():c.substring(h,h+4)==="null"||r.Allow.NULL&u&&d-h<4&&"null".startsWith(c.substring(h))?(h+=4,null):c.substring(h,h+4)==="true"||r.Allow.BOOL&u&&d-h<4&&"true".startsWith(c.substring(h))?(h+=4,!0):c.substring(h,h+5)==="false"||r.Allow.BOOL&u&&d-h<5&&"false".startsWith(c.substring(h))?(h+=5,!1):c.substring(h,h+8)==="Infinity"||r.Allow.INFINITY&u&&d-h<8&&"Infinity".startsWith(c.substring(h))?(h+=8,1/0):c.substring(h,h+9)==="-Infinity"||r.Allow._INFINITY&u&&1<d-h&&d-h<9&&"-Infinity".startsWith(c.substring(h))?(h+=9,-1/0):c.substring(h,h+3)==="NaN"||r.Allow.NAN&u&&d-h<3&&"NaN".startsWith(c.substring(h))?(h+=3,NaN):_()),v=()=>{const C=h;let T=!1;for(h++;h<d&&(c[h]!=='"'||T&&c[h-1]==="\\");)T=c[h]==="\\"?!T:!1,h++;if(c.charAt(h)=='"')try{return JSON.parse(c.substring(C,++h-Number(T)))}catch(A){y(String(A))}else if(r.Allow.STR&u)try{return JSON.parse(c.substring(C,h-Number(T))+'"')}catch{return JSON.parse(c.substring(C,c.lastIndexOf("\\"))+'"')}m("Unterminated string literal")},x=()=>{h++,k();const C={};try{for(;c[h]!=="}";){if(k(),h>=d&&r.Allow.OBJ&u)return C;const T=v();k(),h++;try{const A=b();C[T]=A}catch(A){if(r.Allow.OBJ&u)return C;throw A}k(),c[h]===","&&h++}}catch{if(r.Allow.OBJ&u)return C;m("Expected '}' at end of object")}return h++,C},w=()=>{h++;const C=[];try{for(;c[h]!=="]";)C.push(b()),k(),c[h]===","&&h++}catch{if(r.Allow.ARR&u)return C;m("Expected ']' at end of array")}return h++,C},_=()=>{if(h===0){c==="-"&&y("Not sure what '-' is");try{return JSON.parse(c)}catch(T){if(r.Allow.NUM&u)try{return JSON.parse(c.substring(0,c.lastIndexOf("e")))}catch{}y(String(T))}}const C=h;for(c[h]==="-"&&h++;c[h]&&",]}".indexOf(c[h])===-1;)h++;h==d&&!(r.Allow.NUM&u)&&m("Unterminated number literal");try{return JSON.parse(c.substring(C,h))}catch{c.substring(C,h)==="-"&&m("Not sure what '-' is");try{return JSON.parse(c.substring(C,c.lastIndexOf("e")))}catch(A){y(String(A))}}},k=()=>{for(;h<d&&` 
\r	`.includes(c[h]);)h++};return b()},l=a;e.parse=l}(Wp)),Wp}var fxe=dxe();function PN(e){const t=[];for(const{content:n,role:r}of e)switch(r){case"system":{t.push({content:n,role:"system"});break}case"user":{t.push({...n.reduce((s,i)=>{if(i.type==="text")s.content+=i.text;else{if(i.type==="image"&&i.image instanceof URL)throw new gr({functionality:"Image URLs in user messages"});i.type==="image"&&i.image instanceof Uint8Array&&(s.images=s.images||[],s.images.push(zu(i.image)))}return s},{content:""}),role:"user"});break}case"assistant":{const s=[],i=[];for(const a of n)switch(a.type){case"text":{s.push(a.text);break}case"tool-call":{i.push({function:{arguments:a.args,name:a.toolName},id:a.toolCallId,type:"function"});break}default:{const o=a;throw new Error(`Unsupported part: ${o}`)}}t.push({content:s.join(","),role:"assistant",tool_calls:i.length>0?i:void 0});break}case"tool":{t.push(...n.map(s=>({content:typeof s.result=="object"?JSON.stringify(s.result):`${s.result}`,role:"tool",tool_call_id:s.toolCallId})));break}default:{const s=r;throw new Error(`Unsupported role: ${s}`)}}return t}var hxe=class{constructor({tools:e,type:t}){this._firstMessage=!0,this._tools=e,this._toolPartial="",this._toolCalls=[],this._type=t,this._detectedToolCall=!1}get toolCalls(){return this._toolCalls}get detectedToolCall(){return this._detectedToolCall}parse({controller:e,delta:t}){var n;if(this.detectToolCall(t),!this._detectedToolCall)return!1;this._toolPartial+=t;let r=fxe.parse(this._toolPartial);Array.isArray(r)||(r=[r]);for(const[s,i]of r.entries()){const a=(n=JSON.stringify(i==null?void 0:i.parameters))!=null?n:"";if(a==="")continue;this._toolCalls[s]||(this._toolCalls[s]={function:{arguments:"",name:i.name},id:fa(),type:"function"});const o=this._toolCalls[s];o.function.arguments=a,e.enqueue({argsTextDelta:t,toolCallId:o.id,toolCallType:"function",toolName:o.function.name,type:"tool-call-delta"})}return!0}finish({controller:e}){for(const t of this.toolCalls)e.enqueue({args:t.function.arguments,toolCallId:t.id,toolCallType:"function",toolName:t.function.name,type:"tool-call"});return this.finishReason()}detectToolCall(e){!this._tools||this._tools.length===0||this._firstMessage&&(this._type==="object-tool"?this._detectedToolCall=!0:this._type==="regular"&&(e.trim().startsWith("{")||e.trim().startsWith("["))&&(this._detectedToolCall=!0),this._firstMessage=!1)}finishReason(){return this.detectedToolCall?this._type==="object-tool"?"stop":"tool-calls":"stop"}};function pxe({finishReason:e,hasToolCalls:t}){switch(e){case"stop":return t?"tool-calls":"stop";default:return"other"}}var mxe=Ke({error:Ke({code:$e().nullable(),message:$e(),param:sf().nullable(),type:$e()})}),R3=np({errorSchema:mxe,errorToMessage:e=>e.error.message});function gxe({mode:e}){var t;const n=(t=e.tools)!=null&&t.length?e.tools:void 0,r=[],s=e.toolChoice;if(n===void 0)return{tools:void 0,toolWarnings:r};const i=[];for(const o of n)o.type==="provider-defined"?r.push({tool:o,type:"unsupported-tool"}):i.push({function:{description:o.description,name:o.name,parameters:o.parameters},type:"function"});if(s===void 0)return{tools:i,toolWarnings:r};const a=s.type;switch(a){case"auto":return{tools:i,toolWarnings:r};case"none":return{tools:void 0,toolWarnings:r};default:{const o=a;throw new gr({functionality:`Unsupported tool choice type: ${o}`})}}}function yxe(e){return Object.fromEntries(Object.entries(e).filter(([,t])=>t!==void 0))}var bxe=class extends TransformStream{constructor(){super({flush:e=>{this.buffer.length!==0&&e.enqueue(this.buffer)},transform:(e,t)=>{for(e=this.buffer+e;;){const n=e.indexOf(`
`);if(n===-1)break;t.enqueue(e.slice(0,n)),e=e.slice(n+1)}this.buffer=e}}),this.buffer=""}},vxe=e=>async({response:t})=>{const n=eb(t);if(t.body===null)throw new uG({});return{responseHeaders:n,value:t.body.pipeThrough(new TextDecoderStream).pipeThrough(new bxe).pipeThrough(new TransformStream({transform(r,s){s.enqueue(Nm({schema:e,text:r}))}}))}},xxe=class{constructor(e,t,n){this.modelId=e,this.settings=t,this.config=n,this.specificationVersion="v1",this.defaultObjectGenerationMode="json",this.supportsImageUrls=!1}get supportsStructuredOutputs(){var e;return(e=this.settings.structuredOutputs)!=null?e:!1}get provider(){return this.config.provider}getArguments({frequencyPenalty:e,maxTokens:t,mode:n,presencePenalty:r,prompt:s,responseFormat:i,seed:a,stopSequences:o,temperature:l,topK:c,topP:u}){const d=n.type,h=[];i!==void 0&&i.type==="json"&&i.schema!==void 0&&!this.supportsStructuredOutputs&&h.push({details:"JSON response format schema is only supported with structuredOutputs",setting:"responseFormat",type:"unsupported-setting"});const m={format:i==null?void 0:i.type,model:this.modelId,options:yxe({f16_kv:this.settings.f16Kv,frequency_penalty:e,low_vram:this.settings.lowVram,main_gpu:this.settings.mainGpu,min_p:this.settings.minP,mirostat:this.settings.mirostat,mirostat_eta:this.settings.mirostatEta,mirostat_tau:this.settings.mirostatTau,num_batch:this.settings.numBatch,num_ctx:this.settings.numCtx,num_gpu:this.settings.numGpu,num_keep:this.settings.numKeep,num_predict:t,num_thread:this.settings.numThread,numa:this.settings.numa,penalize_newline:this.settings.penalizeNewline,presence_penalty:r,repeat_last_n:this.settings.repeatLastN,repeat_penalty:this.settings.repeatPenalty,seed:a,stop:o,temperature:l,tfs_z:this.settings.tfsZ,top_k:c,top_p:u,typical_p:this.settings.typicalP,use_mlock:this.settings.useMlock,use_mmap:this.settings.useMmap,vocab_only:this.settings.vocabOnly})};switch(d){case"regular":{const{tools:y,toolWarnings:b}=gxe({mode:n});return{args:{...m,messages:PN(s),tools:y},type:d,warnings:[...h,...b]}}case"object-json":return{args:{...m,format:this.supportsStructuredOutputs&&n.schema!==void 0?n.schema:"json",messages:PN(s)},type:d,warnings:h};case"object-tool":return{args:{...m,messages:PN(s),tool_choice:{function:{name:n.tool.name},type:"function"},tools:[{function:{description:n.tool.description,name:n.tool.name,parameters:n.tool.parameters},type:"function"}]},type:d,warnings:h};default:{const y=d;throw new Error(`Unsupported type: ${y}`)}}}async doGenerate(e){var t,n;const{args:r,warnings:s}=this.getArguments(e),i={...r,stream:!1},{responseHeaders:a,value:o}=await Hs({abortSignal:e.abortSignal,body:i,failedResponseHandler:R3,fetch:this.config.fetch,headers:Ws(this.config.headers(),e.headers),successfulResponseHandler:Ka(wxe),url:`${this.config.baseURL}/chat`}),{messages:l,...c}=i,u=(t=o.message.tool_calls)==null?void 0:t.map(d=>{var h;return{args:JSON.stringify(d.function.arguments),toolCallId:(h=d.id)!=null?h:fa(),toolCallType:"function",toolName:d.function.name}});return{finishReason:pxe({finishReason:o.done_reason,hasToolCalls:u!==void 0&&u.length>0}),rawCall:{rawPrompt:l,rawSettings:c},rawResponse:{headers:a},request:{body:JSON.stringify(i)},text:(n=o.message.content)!=null?n:void 0,toolCalls:u,usage:{completionTokens:o.eval_count||0,promptTokens:o.prompt_eval_count||0},warnings:s}}async doStream(e){if(this.settings.simulateStreaming){const m=await this.doGenerate(e),y=new ReadableStream({start(b){if(b.enqueue({type:"response-metadata",...m.response}),m.text&&b.enqueue({textDelta:m.text,type:"text-delta"}),m.toolCalls)for(const v of m.toolCalls)b.enqueue({argsTextDelta:v.args,toolCallId:v.toolCallId,toolCallType:"function",toolName:v.toolName,type:"tool-call-delta"}),b.enqueue({type:"tool-call",...v});b.enqueue({finishReason:m.finishReason,logprobs:m.logprobs,providerMetadata:m.providerMetadata,type:"finish",usage:m.usage}),b.close()}});return{rawCall:m.rawCall,rawResponse:m.rawResponse,stream:y,warnings:m.warnings}}const{args:t,type:n,warnings:r}=this.getArguments(e),{responseHeaders:s,value:i}=await Hs({abortSignal:e.abortSignal,body:t,failedResponseHandler:R3,fetch:this.config.fetch,headers:Ws(this.config.headers(),e.headers),successfulResponseHandler:vxe(Sxe),url:`${this.config.baseURL}/chat`}),{messages:a,...o}=t,l=e.mode.type==="regular"?e.mode.tools:e.mode.type==="object-tool"?[e.mode.tool]:void 0,c=new hxe({tools:l,type:n});let u="other",d={completionTokens:Number.NaN,promptTokens:Number.NaN};const{experimentalStreamTools:h=!0}=this.settings;return{rawCall:{rawPrompt:a,rawSettings:o},rawResponse:{headers:s},request:{body:JSON.stringify(t)},stream:i.pipeThrough(new TransformStream({async flush(m){m.enqueue({finishReason:u,type:"finish",usage:d})},async transform(m,y){if(!m.success){y.enqueue({error:m.error,type:"error"});return}const b=m.value;if(b.done){u=c.finish({controller:y}),d={completionTokens:b.eval_count,promptTokens:b.prompt_eval_count||0};return}h&&c.parse({controller:y,delta:b.message.content})||b.message.content!==null&&y.enqueue({textDelta:b.message.content,type:"text-delta"})}})),warnings:r}}},wxe=Ke({created_at:$e(),done:Mn(!0),done_reason:$e().optional().nullable(),eval_count:Tt(),eval_duration:Tt(),load_duration:Tt().optional(),message:Ke({content:$e(),role:$e(),tool_calls:cn(Ke({function:Ke({arguments:Dh(sf()),name:$e()}),id:$e().optional()})).optional().nullable()}),model:$e(),prompt_eval_count:Tt().optional(),prompt_eval_duration:Tt().optional(),total_duration:Tt()}),Sxe=BE("done",[Ke({created_at:$e(),done:Mn(!1),message:Ke({content:$e(),role:$e()}),model:$e()}),Ke({created_at:$e(),done:Mn(!0),eval_count:Tt(),eval_duration:Tt(),load_duration:Tt().optional(),model:$e(),prompt_eval_count:Tt().optional(),prompt_eval_duration:Tt().optional(),total_duration:Tt()})]),_xe=class{constructor(e,t,n){this.specificationVersion="v1",this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}get maxEmbeddingsPerCall(){var e;return(e=this.settings.maxEmbeddingsPerCall)!=null?e:2048}get supportsParallelCalls(){return!1}async doEmbed({abortSignal:e,values:t}){if(t.length>this.maxEmbeddingsPerCall)throw new OE({maxEmbeddingsPerCall:this.maxEmbeddingsPerCall,modelId:this.modelId,provider:this.provider,values:t});const{responseHeaders:n,value:r}=await Hs({abortSignal:e,body:{input:t,model:this.modelId},failedResponseHandler:R3,fetch:this.config.fetch,headers:this.config.headers(),successfulResponseHandler:Ka(Cxe),url:`${this.config.baseURL}/embed`});return{embeddings:r.embeddings,rawResponse:{headers:n},usage:r.prompt_eval_count?{tokens:r.prompt_eval_count}:void 0}}},Cxe=Ke({embeddings:cn(cn(Tt())),prompt_eval_count:Tt().nullable()});function tK(e={}){var t;const n=(t=A1(e.baseURL))!=null?t:"http://127.0.0.1:11434/api",r=()=>({...e.headers}),s=(o,l={})=>new xxe(o,l,{baseURL:n,fetch:e.fetch,headers:r,provider:"ollama.chat"}),i=(o,l={})=>new _xe(o,l,{baseURL:n,fetch:e.fetch,headers:r,provider:"ollama.embedding"}),a=function(o,l){if(new.target)throw new Error("The Ollama model function cannot be called with the new keyword.");return s(o,l)};return a.chat=s,a.embedding=i,a.languageModel=s,a.textEmbedding=i,a.textEmbeddingModel=i,a}tK();function qv(e){var t,n;return(n=(t=e==null?void 0:e.providerMetadata)==null?void 0:t.openaiCompatible)!=null?n:{}}function kxe(e){const t=[];for(const{role:n,content:r,...s}of e){const i=qv({...s});switch(n){case"system":{t.push({role:"system",content:r,...i});break}case"user":{if(r.length===1&&r[0].type==="text"){t.push({role:"user",content:r[0].text,...qv(r[0])});break}t.push({role:"user",content:r.map(a=>{var o;const l=qv(a);switch(a.type){case"text":return{type:"text",text:a.text,...l};case"image":return{type:"image_url",image_url:{url:a.image instanceof URL?a.image.toString():`data:${(o=a.mimeType)!=null?o:"image/jpeg"};base64,${zu(a.image)}`},...l};case"file":throw new gr({functionality:"File content parts in user messages"})}}),...i});break}case"assistant":{let a="";const o=[];for(const l of r){const c=qv(l);switch(l.type){case"text":{a+=l.text;break}case"tool-call":{o.push({id:l.toolCallId,type:"function",function:{name:l.toolName,arguments:JSON.stringify(l.args)},...c});break}}}t.push({role:"assistant",content:a,tool_calls:o.length>0?o:void 0,...i});break}case"tool":{for(const a of r){const o=qv(a);t.push({role:"tool",tool_call_id:a.toolCallId,content:JSON.stringify(a.result),...o})}break}default:{const a=n;throw new Error(`Unsupported role: ${a}`)}}}return t}function H2({id:e,model:t,created:n}){return{id:e??void 0,modelId:t??void 0,timestamp:n!=null?new Date(n*1e3):void 0}}function G2(e){switch(e){case"stop":return"stop";case"length":return"length";case"content_filter":return"content-filter";case"function_call":case"tool_calls":return"tool-calls";default:return"unknown"}}var Exe=Ke({error:Ke({message:$e(),type:$e().nullish(),param:sf().nullish(),code:ms([$e(),Tt()]).nullish()})}),$E={errorSchema:Exe,errorToMessage:e=>e.error.message};function Txe({mode:e,structuredOutputs:t}){var n;const r=(n=e.tools)!=null&&n.length?e.tools:void 0,s=[];if(r==null)return{tools:void 0,tool_choice:void 0,toolWarnings:s};const i=e.toolChoice,a=[];for(const l of r)l.type==="provider-defined"?s.push({type:"unsupported-tool",tool:l}):a.push({type:"function",function:{name:l.name,description:l.description,parameters:l.parameters}});if(i==null)return{tools:a,tool_choice:void 0,toolWarnings:s};const o=i.type;switch(o){case"auto":case"none":case"required":return{tools:a,tool_choice:o,toolWarnings:s};case"tool":return{tools:a,tool_choice:{type:"function",function:{name:i.toolName}},toolWarnings:s};default:{const l=o;throw new gr({functionality:`Unsupported tool choice type: ${l}`})}}}var Axe=class{constructor(e,t,n){this.specificationVersion="v1";var r,s;this.modelId=e,this.settings=t,this.config=n;const i=(r=n.errorStructure)!=null?r:$E;this.chunkSchema=Nxe(i.errorSchema),this.failedResponseHandler=np(i),this.supportsStructuredOutputs=(s=n.supportsStructuredOutputs)!=null?s:!1}get defaultObjectGenerationMode(){return this.config.defaultObjectGenerationMode}get provider(){return this.config.provider}get providerOptionsName(){return this.config.provider.split(".")[0].trim()}getArgs({mode:e,prompt:t,maxTokens:n,temperature:r,topP:s,topK:i,frequencyPenalty:a,presencePenalty:o,providerMetadata:l,stopSequences:c,responseFormat:u,seed:d}){var h,m,y,b,v;const x=e.type,w=[];i!=null&&w.push({type:"unsupported-setting",setting:"topK"}),(u==null?void 0:u.type)==="json"&&u.schema!=null&&!this.supportsStructuredOutputs&&w.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format schema is only supported with structuredOutputs"});const _={model:this.modelId,user:this.settings.user,max_tokens:n,temperature:r,top_p:s,frequency_penalty:a,presence_penalty:o,response_format:(u==null?void 0:u.type)==="json"?this.supportsStructuredOutputs===!0&&u.schema!=null?{type:"json_schema",json_schema:{schema:u.schema,name:(h=u.name)!=null?h:"response",description:u.description}}:{type:"json_object"}:void 0,stop:c,seed:d,...l==null?void 0:l[this.providerOptionsName],reasoning_effort:(b=(m=l==null?void 0:l[this.providerOptionsName])==null?void 0:m.reasoningEffort)!=null?b:(y=l==null?void 0:l["openai-compatible"])==null?void 0:y.reasoningEffort,messages:kxe(t)};switch(x){case"regular":{const{tools:k,tool_choice:C,toolWarnings:T}=Txe({mode:e,structuredOutputs:this.supportsStructuredOutputs});return{args:{..._,tools:k,tool_choice:C},warnings:[...w,...T]}}case"object-json":return{args:{..._,response_format:this.supportsStructuredOutputs===!0&&e.schema!=null?{type:"json_schema",json_schema:{schema:e.schema,name:(v=e.name)!=null?v:"response",description:e.description}}:{type:"json_object"}},warnings:w};case"object-tool":return{args:{..._,tool_choice:{type:"function",function:{name:e.tool.name}},tools:[{type:"function",function:{name:e.tool.name,description:e.tool.description,parameters:e.tool.parameters}}]},warnings:w};default:{const k=x;throw new Error(`Unsupported type: ${k}`)}}}async doGenerate(e){var t,n,r,s,i,a,o,l,c,u,d;const{args:h,warnings:m}=this.getArgs({...e}),y=JSON.stringify(h),{responseHeaders:b,value:v,rawValue:x}=await Hs({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:Ws(this.config.headers(),e.headers),body:h,failedResponseHandler:this.failedResponseHandler,successfulResponseHandler:Ka(Rxe),abortSignal:e.abortSignal,fetch:this.config.fetch}),{messages:w,..._}=h,k=v.choices[0],C={[this.providerOptionsName]:{},...(n=(t=this.config.metadataExtractor)==null?void 0:t.extractMetadata)==null?void 0:n.call(t,{parsedBody:x})},T=(r=v.usage)==null?void 0:r.completion_tokens_details,A=(s=v.usage)==null?void 0:s.prompt_tokens_details;return(T==null?void 0:T.reasoning_tokens)!=null&&(C[this.providerOptionsName].reasoningTokens=T==null?void 0:T.reasoning_tokens),(T==null?void 0:T.accepted_prediction_tokens)!=null&&(C[this.providerOptionsName].acceptedPredictionTokens=T==null?void 0:T.accepted_prediction_tokens),(T==null?void 0:T.rejected_prediction_tokens)!=null&&(C[this.providerOptionsName].rejectedPredictionTokens=T==null?void 0:T.rejected_prediction_tokens),(A==null?void 0:A.cached_tokens)!=null&&(C[this.providerOptionsName].cachedPromptTokens=A==null?void 0:A.cached_tokens),{text:(i=k.message.content)!=null?i:void 0,reasoning:(a=k.message.reasoning_content)!=null?a:void 0,toolCalls:(o=k.message.tool_calls)==null?void 0:o.map(N=>{var I;return{toolCallType:"function",toolCallId:(I=N.id)!=null?I:fa(),toolName:N.function.name,args:N.function.arguments}}),finishReason:G2(k.finish_reason),usage:{promptTokens:(c=(l=v.usage)==null?void 0:l.prompt_tokens)!=null?c:NaN,completionTokens:(d=(u=v.usage)==null?void 0:u.completion_tokens)!=null?d:NaN},providerMetadata:C,rawCall:{rawPrompt:w,rawSettings:_},rawResponse:{headers:b,body:x},response:H2(v),warnings:m,request:{body:y}}}async doStream(e){var t;if(this.settings.simulateStreaming){const b=await this.doGenerate(e);return{stream:new ReadableStream({start(x){if(x.enqueue({type:"response-metadata",...b.response}),b.reasoning)if(Array.isArray(b.reasoning))for(const w of b.reasoning)w.type==="text"&&x.enqueue({type:"reasoning",textDelta:w.text});else x.enqueue({type:"reasoning",textDelta:b.reasoning});if(b.text&&x.enqueue({type:"text-delta",textDelta:b.text}),b.toolCalls)for(const w of b.toolCalls)x.enqueue({type:"tool-call",...w});x.enqueue({type:"finish",finishReason:b.finishReason,usage:b.usage,logprobs:b.logprobs,providerMetadata:b.providerMetadata}),x.close()}}),rawCall:b.rawCall,rawResponse:b.rawResponse,warnings:b.warnings}}const{args:n,warnings:r}=this.getArgs({...e}),s={...n,stream:!0,stream_options:this.config.includeUsage?{include_usage:!0}:void 0},i=(t=this.config.metadataExtractor)==null?void 0:t.createStreamExtractor(),{responseHeaders:a,value:o}=await Hs({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:Ws(this.config.headers(),e.headers),body:s,failedResponseHandler:this.failedResponseHandler,successfulResponseHandler:rp(this.chunkSchema),abortSignal:e.abortSignal,fetch:this.config.fetch}),{messages:l,...c}=n,u=[];let d="unknown",h={completionTokens:void 0,completionTokensDetails:{reasoningTokens:void 0,acceptedPredictionTokens:void 0,rejectedPredictionTokens:void 0},promptTokens:void 0,promptTokensDetails:{cachedTokens:void 0}},m=!0,y=this.providerOptionsName;return{stream:o.pipeThrough(new TransformStream({transform(b,v){var x,w,_,k,C,T,A,N,I,j,L,D;if(!b.success){d="error",v.enqueue({type:"error",error:b.error});return}const H=b.value;if(i==null||i.processChunk(b.rawValue),"error"in H){d="error",v.enqueue({type:"error",error:H.error.message});return}if(m&&(m=!1,v.enqueue({type:"response-metadata",...H2(H)})),H.usage!=null){const{prompt_tokens:U,completion_tokens:W,prompt_tokens_details:B,completion_tokens_details:ne}=H.usage;h.promptTokens=U??void 0,h.completionTokens=W??void 0,(ne==null?void 0:ne.reasoning_tokens)!=null&&(h.completionTokensDetails.reasoningTokens=ne==null?void 0:ne.reasoning_tokens),(ne==null?void 0:ne.accepted_prediction_tokens)!=null&&(h.completionTokensDetails.acceptedPredictionTokens=ne==null?void 0:ne.accepted_prediction_tokens),(ne==null?void 0:ne.rejected_prediction_tokens)!=null&&(h.completionTokensDetails.rejectedPredictionTokens=ne==null?void 0:ne.rejected_prediction_tokens),(B==null?void 0:B.cached_tokens)!=null&&(h.promptTokensDetails.cachedTokens=B==null?void 0:B.cached_tokens)}const O=H.choices[0];if((O==null?void 0:O.finish_reason)!=null&&(d=G2(O.finish_reason)),(O==null?void 0:O.delta)==null)return;const K=O.delta;if(K.reasoning_content!=null&&v.enqueue({type:"reasoning",textDelta:K.reasoning_content}),K.content!=null&&v.enqueue({type:"text-delta",textDelta:K.content}),K.tool_calls!=null)for(const U of K.tool_calls){const W=U.index;if(u[W]==null){if(U.type!=="function")throw new Yd({data:U,message:"Expected 'function' type."});if(U.id==null)throw new Yd({data:U,message:"Expected 'id' to be a string."});if(((x=U.function)==null?void 0:x.name)==null)throw new Yd({data:U,message:"Expected 'function.name' to be a string."});u[W]={id:U.id,type:"function",function:{name:U.function.name,arguments:(w=U.function.arguments)!=null?w:""},hasFinished:!1};const ne=u[W];((_=ne.function)==null?void 0:_.name)!=null&&((k=ne.function)==null?void 0:k.arguments)!=null&&(ne.function.arguments.length>0&&v.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:ne.id,toolName:ne.function.name,argsTextDelta:ne.function.arguments}),xm(ne.function.arguments)&&(v.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(C=ne.id)!=null?C:fa(),toolName:ne.function.name,args:ne.function.arguments}),ne.hasFinished=!0));continue}const B=u[W];B.hasFinished||(((T=U.function)==null?void 0:T.arguments)!=null&&(B.function.arguments+=(N=(A=U.function)==null?void 0:A.arguments)!=null?N:""),v.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:B.id,toolName:B.function.name,argsTextDelta:(I=U.function.arguments)!=null?I:""}),((j=B.function)==null?void 0:j.name)!=null&&((L=B.function)==null?void 0:L.arguments)!=null&&xm(B.function.arguments)&&(v.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(D=B.id)!=null?D:fa(),toolName:B.function.name,args:B.function.arguments}),B.hasFinished=!0))}},flush(b){var v,x;const w={[y]:{},...i==null?void 0:i.buildMetadata()};h.completionTokensDetails.reasoningTokens!=null&&(w[y].reasoningTokens=h.completionTokensDetails.reasoningTokens),h.completionTokensDetails.acceptedPredictionTokens!=null&&(w[y].acceptedPredictionTokens=h.completionTokensDetails.acceptedPredictionTokens),h.completionTokensDetails.rejectedPredictionTokens!=null&&(w[y].rejectedPredictionTokens=h.completionTokensDetails.rejectedPredictionTokens),h.promptTokensDetails.cachedTokens!=null&&(w[y].cachedPromptTokens=h.promptTokensDetails.cachedTokens),b.enqueue({type:"finish",finishReason:d,usage:{promptTokens:(v=h.promptTokens)!=null?v:NaN,completionTokens:(x=h.completionTokens)!=null?x:NaN},providerMetadata:w})}})),rawCall:{rawPrompt:l,rawSettings:c},rawResponse:{headers:a},warnings:r,request:{body:JSON.stringify(s)}}}},nK=Ke({prompt_tokens:Tt().nullish(),completion_tokens:Tt().nullish(),prompt_tokens_details:Ke({cached_tokens:Tt().nullish()}).nullish(),completion_tokens_details:Ke({reasoning_tokens:Tt().nullish(),accepted_prediction_tokens:Tt().nullish(),rejected_prediction_tokens:Tt().nullish()}).nullish()}).nullish(),Rxe=Ke({id:$e().nullish(),created:Tt().nullish(),model:$e().nullish(),choices:cn(Ke({message:Ke({role:Mn("assistant").nullish(),content:$e().nullish(),reasoning_content:$e().nullish(),tool_calls:cn(Ke({id:$e().nullish(),type:Mn("function"),function:Ke({name:$e(),arguments:$e()})})).nullish()}),finish_reason:$e().nullish()})),usage:nK}),Nxe=e=>ms([Ke({id:$e().nullish(),created:Tt().nullish(),model:$e().nullish(),choices:cn(Ke({delta:Ke({role:El(["assistant"]).nullish(),content:$e().nullish(),reasoning_content:$e().nullish(),tool_calls:cn(Ke({index:Tt(),id:$e().nullish(),type:Mn("function").nullish(),function:Ke({name:$e().nullish(),arguments:$e().nullish()})})).nullish()}).nullish(),finish_reason:$e().nullish()})),usage:nK}),e]);function Ixe({prompt:e,inputFormat:t,user:n="user",assistant:r="assistant"}){if(t==="prompt"&&e.length===1&&e[0].role==="user"&&e[0].content.length===1&&e[0].content[0].type==="text")return{prompt:e[0].content[0].text};let s="";e[0].role==="system"&&(s+=`${e[0].content}

`,e=e.slice(1));for(const{role:i,content:a}of e)switch(i){case"system":throw new Ic({message:"Unexpected system message in prompt: ${content}",prompt:e});case"user":{const o=a.map(l=>{switch(l.type){case"text":return l.text;case"image":throw new gr({functionality:"images"})}}).join("");s+=`${n}:
${o}

`;break}case"assistant":{const o=a.map(l=>{switch(l.type){case"text":return l.text;case"tool-call":throw new gr({functionality:"tool-call messages"})}}).join("");s+=`${r}:
${o}

`;break}case"tool":throw new gr({functionality:"tool messages"});default:{const o=i;throw new Error(`Unsupported role: ${o}`)}}return s+=`${r}:
`,{prompt:s,stopSequences:[`
${n}:`]}}var Mxe=class{constructor(e,t,n){this.specificationVersion="v1",this.defaultObjectGenerationMode=void 0;var r;this.modelId=e,this.settings=t,this.config=n;const s=(r=n.errorStructure)!=null?r:$E;this.chunkSchema=Pxe(s.errorSchema),this.failedResponseHandler=np(s)}get provider(){return this.config.provider}get providerOptionsName(){return this.config.provider.split(".")[0].trim()}getArgs({mode:e,inputFormat:t,prompt:n,maxTokens:r,temperature:s,topP:i,topK:a,frequencyPenalty:o,presencePenalty:l,stopSequences:c,responseFormat:u,seed:d,providerMetadata:h}){var m;const y=e.type,b=[];a!=null&&b.push({type:"unsupported-setting",setting:"topK"}),u!=null&&u.type!=="text"&&b.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format is not supported."});const{prompt:v,stopSequences:x}=Ixe({prompt:n,inputFormat:t}),w=[...x??[],...c??[]],_={model:this.modelId,echo:this.settings.echo,logit_bias:this.settings.logitBias,suffix:this.settings.suffix,user:this.settings.user,max_tokens:r,temperature:s,top_p:i,frequency_penalty:o,presence_penalty:l,seed:d,...h==null?void 0:h[this.providerOptionsName],prompt:v,stop:w.length>0?w:void 0};switch(y){case"regular":{if((m=e.tools)!=null&&m.length)throw new gr({functionality:"tools"});if(e.toolChoice)throw new gr({functionality:"toolChoice"});return{args:_,warnings:b}}case"object-json":throw new gr({functionality:"object-json mode"});case"object-tool":throw new gr({functionality:"object-tool mode"});default:{const k=y;throw new Error(`Unsupported type: ${k}`)}}}async doGenerate(e){var t,n,r,s;const{args:i,warnings:a}=this.getArgs(e),{responseHeaders:o,value:l,rawValue:c}=await Hs({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:Ws(this.config.headers(),e.headers),body:i,failedResponseHandler:this.failedResponseHandler,successfulResponseHandler:Ka(jxe),abortSignal:e.abortSignal,fetch:this.config.fetch}),{prompt:u,...d}=i,h=l.choices[0];return{text:h.text,usage:{promptTokens:(n=(t=l.usage)==null?void 0:t.prompt_tokens)!=null?n:NaN,completionTokens:(s=(r=l.usage)==null?void 0:r.completion_tokens)!=null?s:NaN},finishReason:G2(h.finish_reason),rawCall:{rawPrompt:u,rawSettings:d},rawResponse:{headers:o,body:c},response:H2(l),warnings:a,request:{body:JSON.stringify(i)}}}async doStream(e){const{args:t,warnings:n}=this.getArgs(e),r={...t,stream:!0,stream_options:this.config.includeUsage?{include_usage:!0}:void 0},{responseHeaders:s,value:i}=await Hs({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:Ws(this.config.headers(),e.headers),body:r,failedResponseHandler:this.failedResponseHandler,successfulResponseHandler:rp(this.chunkSchema),abortSignal:e.abortSignal,fetch:this.config.fetch}),{prompt:a,...o}=t;let l="unknown",c={promptTokens:Number.NaN,completionTokens:Number.NaN},u=!0;return{stream:i.pipeThrough(new TransformStream({transform(d,h){if(!d.success){l="error",h.enqueue({type:"error",error:d.error});return}const m=d.value;if("error"in m){l="error",h.enqueue({type:"error",error:m.error});return}u&&(u=!1,h.enqueue({type:"response-metadata",...H2(m)})),m.usage!=null&&(c={promptTokens:m.usage.prompt_tokens,completionTokens:m.usage.completion_tokens});const y=m.choices[0];(y==null?void 0:y.finish_reason)!=null&&(l=G2(y.finish_reason)),(y==null?void 0:y.text)!=null&&h.enqueue({type:"text-delta",textDelta:y.text})},flush(d){d.enqueue({type:"finish",finishReason:l,usage:c})}})),rawCall:{rawPrompt:a,rawSettings:o},rawResponse:{headers:s},warnings:n,request:{body:JSON.stringify(r)}}}},jxe=Ke({id:$e().nullish(),created:Tt().nullish(),model:$e().nullish(),choices:cn(Ke({text:$e(),finish_reason:$e()})),usage:Ke({prompt_tokens:Tt(),completion_tokens:Tt()}).nullish()}),Pxe=e=>ms([Ke({id:$e().nullish(),created:Tt().nullish(),model:$e().nullish(),choices:cn(Ke({text:$e(),finish_reason:$e().nullish(),index:Tt()})),usage:Ke({prompt_tokens:Tt(),completion_tokens:Tt()}).nullish()}),e]),Oxe=class{constructor(e,t,n){this.specificationVersion="v1",this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}get maxEmbeddingsPerCall(){var e;return(e=this.config.maxEmbeddingsPerCall)!=null?e:2048}get supportsParallelCalls(){var e;return(e=this.config.supportsParallelCalls)!=null?e:!0}async doEmbed({values:e,headers:t,abortSignal:n}){var r;if(e.length>this.maxEmbeddingsPerCall)throw new OE({provider:this.provider,modelId:this.modelId,maxEmbeddingsPerCall:this.maxEmbeddingsPerCall,values:e});const{responseHeaders:s,value:i}=await Hs({url:this.config.url({path:"/embeddings",modelId:this.modelId}),headers:Ws(this.config.headers(),t),body:{model:this.modelId,input:e,encoding_format:"float",dimensions:this.settings.dimensions,user:this.settings.user},failedResponseHandler:np((r=this.config.errorStructure)!=null?r:$E),successfulResponseHandler:Ka(Dxe),abortSignal:n,fetch:this.config.fetch});return{embeddings:i.data.map(a=>a.embedding),usage:i.usage?{tokens:i.usage.prompt_tokens}:void 0,rawResponse:{headers:s}}}},Dxe=Ke({data:cn(Ke({embedding:cn(Tt())})),usage:Ke({prompt_tokens:Tt()}).nullish()}),Fxe=class{constructor(e,t,n){this.modelId=e,this.settings=t,this.config=n,this.specificationVersion="v1"}get maxImagesPerCall(){var e;return(e=this.settings.maxImagesPerCall)!=null?e:10}get provider(){return this.config.provider}async doGenerate({prompt:e,n:t,size:n,aspectRatio:r,seed:s,providerOptions:i,headers:a,abortSignal:o}){var l,c,u,d,h;const m=[];r!=null&&m.push({type:"unsupported-setting",setting:"aspectRatio",details:"This model does not support aspect ratio. Use `size` instead."}),s!=null&&m.push({type:"unsupported-setting",setting:"seed"});const y=(u=(c=(l=this.config._internal)==null?void 0:l.currentDate)==null?void 0:c.call(l))!=null?u:new Date,{value:b,responseHeaders:v}=await Hs({url:this.config.url({path:"/images/generations",modelId:this.modelId}),headers:Ws(this.config.headers(),a),body:{model:this.modelId,prompt:e,n:t,size:n,...(d=i.openai)!=null?d:{},response_format:"b64_json",...this.settings.user?{user:this.settings.user}:{}},failedResponseHandler:np((h=this.config.errorStructure)!=null?h:$E),successfulResponseHandler:Ka(Lxe),abortSignal:o,fetch:this.config.fetch});return{images:b.data.map(x=>x.b64_json),warnings:m,response:{timestamp:y,modelId:this.modelId,headers:v}}}},Lxe=Ke({data:cn(Ke({b64_json:$e()}))});function Bxe(e){const t=A1(e.baseURL),n=e.name,r=()=>({...e.apiKey&&{Authorization:`Bearer ${e.apiKey}`},...e.headers}),s=d=>({provider:`${n}.${d}`,url:({path:h})=>{const m=new URL(`${t}${h}`);return e.queryParams&&(m.search=new URLSearchParams(e.queryParams).toString()),m.toString()},headers:r,fetch:e.fetch}),i=(d,h={})=>a(d,h),a=(d,h={})=>new Axe(d,h,{...s("chat"),defaultObjectGenerationMode:"tool"}),o=(d,h={})=>new Mxe(d,h,s("completion")),l=(d,h={})=>new Oxe(d,h,s("embedding")),c=(d,h={})=>new Fxe(d,h,s("image")),u=(d,h)=>i(d,h);return u.languageModel=i,u.chatModel=a,u.completionModel=o,u.textEmbeddingModel=l,u.imageModel=c,u}const Px=(e,t)=>`${e}:${t}`,Ql=e=>{if(!e||!e.includes(":"))return{providerId:null,modelId:null};const t=e.split(":"),n=t[0],r=t.slice(1).join(":");return{providerId:n,modelId:r}},my=e=>e==="openai"||e==="openrouter"||e==="google",K2=e=>e==="ollama"||e==="openai-compatible",wm=e=>e==="openai"||e==="openrouter"||e==="ollama"||e==="openai-compatible",Lo=[{value:"openrouter",label:"OpenRouter"},{value:"openai",label:"OpenAI"},{value:"ollama",label:"Ollama"},{value:"openai-compatible",label:"OpenAI-Compatible (LMStudio, etc.)"},{value:"google",label:"Google Gemini"}],$xe={openai:[{id:"gpt-4o",name:"GPT-4o"},{id:"dall-e-3",name:"DALL-E 3"},{id:"dall-e-2",name:"DALL-E 2"},{id:"o3-mini",name:"o3-mini"},{id:"o4-mini",name:"o4-mini"},{id:"o4-mini-high",name:"o4-mini-high"},{id:"o3-mini-high",name:"o3-mini-high"},{id:"o3",name:"o3"},{id:"4.1",name:"4.1"},{id:"4.1-mini",name:"4.1-mini"},{id:"4.1-nano",name:"4.1-nano"},{id:"o3-pro",name:"o3-pro"},{id:"codex-mini",name:"codex-mini"}],google:[{id:"gemini-2.5-pro-preview",name:"Gemini 2.5 Pro Preview"},{id:"gemini-2.5-flash-preview-05-20:thinking",name:"Gemini 2.5 Flash Preview (Thinking)"},{id:"gemini-2.5-flash-preview",name:"Gemini 2.5 Flash Preview"},{id:"gemini-2.0-flash-001",name:"Gemini 2.0 Flash"}],openrouter:[],ollama:[{id:"llama3",name:"Llama 3 (Ollama)"}],"openai-compatible":[]},rK=e=>{try{const t=e.replace(/\/+$/,"");return/\/(v\d+(\.\d+)*)$/.test(t)?t:t+"/v1"}catch(t){return console.error("Error processing base URL:",e,t),e.replace(/\/+$/,"")}};function mO(e,t,n){try{switch(e.type){case"openai":return HG({apiKey:n})(t);case"google":return ZG({apiKey:n})(t);case"openrouter":const s=eK({apiKey:n,extraBody:{include_reasoning:!0}})(t),i=s.doStream.bind(s);return s.doStream=async function(a){const o=await i(a),l=o.stream.getReader(),c=new ReadableStream({async start(u){try{for(;;){const{done:d,value:h}=await l.read();if(d)break;u.enqueue(h)}}catch(d){d&&typeof d=="object"&&"message"in d&&typeof d.message=="string"&&d.message.includes("reading 'sent'")?console.warn("[OpenRouter Provider Bug] Caught toolCall.sent error, attempting graceful recovery"):u.error(d)}finally{u.close()}}});return{...o,stream:c}},s;case"ollama":return tK({baseURL:e.baseURL??void 0})(t);case"openai-compatible":if(!e.baseURL)throw new Error("Base URL required");return Bxe({baseURL:rK(e.baseURL),apiKey:n,name:e.name||"Custom API"})(t);default:return console.warn(`Unsupported provider type: ${e.type}`),null}}catch(r){return console.error(`Failed instantiate model ${t} for ${e.name}:`,r),null}}function sK(e,t,n){const s=Gn.getState().getAllAvailableModelDefsForProvider(e.id).find(a=>a.id===t);if(!s){console.warn(`Model definition not found for ${t} in provider ${e.name}`);return}const i=mO(e,t,n);if(!i){console.warn(`Failed to instantiate AI SDK instance for ${t} from provider ${e.name}`);return}return{id:Px(e.id,t),name:s.name,providerId:e.id,providerName:e.name,instance:i,metadata:s}}const iK={openai:["max_tokens","temperature","top_p","stop","presence_penalty","frequency_penalty","seed","logit_bias","response_format","tools","tool_choice","logprobs","top_logprobs"],google:["max_tokens","temperature","top_p","top_k","stop","tools","tool_choice"],ollama:["max_tokens","temperature","top_p","top_k","stop","presence_penalty","frequency_penalty","seed","repetition_penalty","response_format"],"openai-compatible":["max_tokens","temperature","top_p","stop","presence_penalty","frequency_penalty","seed","logit_bias","response_format","tools","tool_choice","logprobs","top_logprobs","repetition_penalty","min_p","top_k"],openrouter:[]},Vv=new Map,zxe=5*60*1e3,Uxe=(e,t)=>{var i,a,o,l,c,u,d,h,m,y,b,v,x,w;const n=e.id||e.name,r=e.name||n,s={id:n,name:r,created:e.created??null,description:e.description??null,context_length:e.context_length??null,architecture:{modality:((i=e.architecture)==null?void 0:i.modality)??"text->text",input_modalities:((a=e.architecture)==null?void 0:a.input_modalities)??["text"],output_modalities:((o=e.architecture)==null?void 0:o.output_modalities)??["text"],tokenizer:((l=e.architecture)==null?void 0:l.tokenizer)??"Unknown",instruct_type:((c=e.architecture)==null?void 0:c.instruct_type)??null},pricing:{prompt:((u=e.pricing)==null?void 0:u.prompt)??"0",completion:((d=e.pricing)==null?void 0:d.completion)??"0",request:((h=e.pricing)==null?void 0:h.request)??"0",image:((m=e.pricing)==null?void 0:m.image)??"0",web_search:((y=e.pricing)==null?void 0:y.web_search)??"0",internal_reasoning:((b=e.pricing)==null?void 0:b.internal_reasoning)??"0"},top_provider:{context_length:((v=e.top_provider)==null?void 0:v.context_length)??e.context_length??null,max_completion_tokens:((x=e.top_provider)==null?void 0:x.max_completion_tokens)??null,is_moderated:((w=e.top_provider)==null?void 0:w.is_moderated)??!1},per_request_limits:e.per_request_limits??null,supported_parameters:e.supported_parameters??iK[t]??[]};return t==="ollama"?(s.context_length=s.context_length??4096,s.top_provider&&(s.top_provider.context_length=s.context_length),s.architecture&&(s.architecture.tokenizer="Ollama")):t==="openai"?(n.includes("gpt-4")&&(s.context_length=8192),n.includes("gpt-4-32k")&&(s.context_length=32768),n.includes("gpt-4-turbo")&&(s.context_length=128e3),n.includes("gpt-4o")&&(s.context_length=128e3),n.includes("gpt-3.5-turbo")&&(s.context_length=16385),s.top_provider&&(s.top_provider.context_length=s.context_length),s.architecture&&(s.architecture.tokenizer="OpenAI")):t==="google"?(n.includes("gemini-1.5")?s.context_length=1048576:n.includes("gemini")&&(s.context_length=32768),s.top_provider&&(s.top_provider.context_length=s.context_length),s.architecture&&(s.architecture.tokenizer="Google")):t==="openai-compatible"&&(s.context_length=s.context_length??4096,s.top_provider&&(s.top_provider.context_length=s.context_length),s.architecture&&(s.architecture.tokenizer="Compatible")),s};async function qxe(e,t){const n=`${e.id}-${e.baseURL||""}`,r=Vv.get(n);if(r)return console.log(`[ModelFetcher] Using cache for provider ${e.name} (ID: ${e.id})`),r;const s=(async()=>{var o,l,c;let i;const a={Accept:"application/json"};t&&(a.Authorization=`Bearer ${t}`);try{switch(e.type){case"openai":if(!t)throw new Error("API Key required for OpenAI");i="https://api.openai.com/v1/models";break;case"openrouter":if(!t)throw new Error("API Key required for OpenRouter");i="https://openrouter.ai/api/v1/models",a["HTTP-Referer"]=((o=globalThis.location)==null?void 0:o.origin)||"http://localhost:3000",a["X-Title"]="LiteChat";break;case"ollama":const u=((l=e.baseURL)==null?void 0:l.replace(/\/$/,""))||"http://localhost:11434";i=new URL("/api/tags",u).toString(),delete a.Authorization;break;case"openai-compatible":if(!e.baseURL)throw new Error("Base URL required for OpenAI-Compatible");const d=rK(e.baseURL);i=new URL("models",d.endsWith("/")?d:d+"/").toString();break;case"google":default:return console.log(`[ModelFetcher] Model fetching not supported via API for type: ${e.type}. Returning empty list.`),[]}}catch(u){return console.error(`[ModelFetcher] Error constructing URL for ${e.name}:`,u),ke.error(`Invalid Base URL for ${e.name}: ${u instanceof Error?u.message:String(u)}`),[]}console.log(`[ModelFetcher] Fetching models for ${e.name} (Type: ${e.type}) from ${i}`);try{const u=await fetch(i,{headers:a});if(!u.ok){let y=`(${u.status} ${u.statusText})`;try{const b=await u.text();y=b||y;try{const v=JSON.parse(b);y=((c=v==null?void 0:v.error)==null?void 0:c.message)||(v==null?void 0:v.message)||y}catch{}}catch(b){console.warn("[ModelFetcher] Failed to read error response body:",b)}throw new Error(`API Error: ${y}`)}const d=await u.json();let h=[];if(e.type==="ollama"?h=d.models||[]:h=d.data||d||[],!Array.isArray(h))return console.warn(`[ModelFetcher] Unexpected non-array response for ${e.name}:`,d),[];const m=h.map(y=>Uxe(y,e.type));return m.sort((y,b)=>(y.name||y.id).localeCompare(b.name||b.id)),console.log(`[ModelFetcher] Fetched and mapped ${m.length} models for ${e.name}`),m}catch(u){const d=u instanceof Error?u.message:String(u);return console.error(`[ModelFetcher] Error fetching models for ${e.name}:`,d),ke.error(`Failed to fetch models for ${e.name}: ${d}`),Vv.delete(n),[]}})();return Vv.set(n,s),setTimeout(()=>{Vv.get(n)===s&&(Vv.delete(n),console.log(`[ModelFetcher] Cache expired for provider ${e.name} (ID: ${e.id})`))},zxe),s}const Vn={initialDataLoaded:"provider.initial.data.loaded",configsChanged:"provider.configs.changed",apiKeysChanged:"provider.api.keys.changed",selectedModelChanged:"provider.selected.model.changed",globalModelSortOrderChanged:"provider.global.model.sort.order.changed",fetchStatusChanged:"provider.fetch.status.changed",globallyEnabledModelsUpdated:"provider.globally.enabled.models.updated",selectedModelForDetailsChanged:"provider.selected.model.for.details.changed",enableApiKeyManagementChanged:"provider.enable.api.key.management.changed",loadInitialDataRequest:"provider.load.initial.data.request",selectModelRequest:"provider.select.model.request",addApiKeyRequest:"provider.add.api.key.request",deleteApiKeyRequest:"provider.delete.api.key.request",addProviderConfigRequest:"provider.add.config.request",updateProviderConfigRequest:"provider.update.config.request",deleteProviderConfigRequest:"provider.delete.config.request",fetchModelsRequest:"provider.fetch.models.request",setGlobalModelSortOrderRequest:"provider.set.global.model.sort.order.request",setEnableApiKeyManagementRequest:"provider.set.enable.api.key.management.request",setSelectedModelForDetailsRequest:"provider.set.selected.model.for.details.request"},ON="provider:lastModelSelection",F$="provider:globalModelSortOrder",Gn=Co(ko((e,t)=>({dbProviderConfigs:[],dbApiKeys:[],selectedModelId:null,globalModelSortOrder:[],providerFetchStatus:{},isLoading:!0,error:null,enableApiKeyManagement:!0,_selectedModelForDetails:null,globallyEnabledModelDefinitions:[],_updateGloballyEnabledModelDefinitions:()=>{const{dbProviderConfigs:n,globalModelSortOrder:r}=t(),s=t().getAvailableModelListItems(),i=new Map(s.map(u=>[u.id,u])),a=new Set;n.forEach(u=>{u.isEnabled&&u.enabledModels&&u.enabledModels.forEach(d=>{a.add(Px(u.id,d))})});const o=[],l=new Set;r.forEach(u=>{if(a.has(u)){const d=i.get(u);d&&!l.has(u)&&(o.push(d),l.add(u))}});const c=s.filter(u=>a.has(u.id)&&!l.has(u.id)).sort((u,d)=>u.name.localeCompare(d.name));o.push(...c),e({globallyEnabledModelDefinitions:o}),Ce.emit(Vn.globallyEnabledModelsUpdated,{models:o})},getGloballyEnabledModelDefinitions:()=>t().globallyEnabledModelDefinitions,getModelConfigById:n=>{var c;const{dbProviderConfigs:r,dbApiKeys:s}=t(),{providerId:i,modelId:a}=Ql(n);if(!i||!a){console.warn(`[ProviderStore] Invalid combined ID for getModelConfigById: ${n}`);return}const o=r.find(u=>u.id===i);if(!o){console.warn(`[ProviderStore] Could not find provider config for ID: ${i}`);return}const l=(c=s.find(u=>u.id===o.apiKeyId))==null?void 0:c.value;return t().createAiModelConfig(o,a,l)},createAiModelConfig:(n,r,s)=>{const a=t().getAllAvailableModelDefsForProvider(n.id).find(l=>l.id===r);if(!a){console.warn(`Model definition not found for ${r} in provider ${n.name}`);return}const o=mO(n,r,s);if(!o){console.warn(`Failed to instantiate AI SDK instance for ${r} from provider ${n.name}`);return}return{id:Px(n.id,r),name:a.name,providerId:n.id,providerName:n.name,instance:o,metadata:a}},setEnableApiKeyManagement:n=>{e({enableApiKeyManagement:n}),yt.saveSetting("enableApiKeyManagement",n),Ce.emit(Vn.enableApiKeyManagementChanged,{enabled:n})},loadInitialData:async()=>{e({isLoading:!0,error:null});try{const n=await yt.loadSetting("enableApiKeyManagement",!0),[r,s,i,a]=await Promise.all([yt.loadProviderConfigs(),yt.loadApiKeys(),yt.loadSetting(F$,[]),yt.loadSetting(ON,null)]);e({dbProviderConfigs:r,dbApiKeys:s,enableApiKeyManagement:n,globalModelSortOrder:i}),t()._updateGloballyEnabledModelDefinitions();const o=t().globallyEnabledModelDefinitions.map(d=>d.id),l=new Set(o);let c=a;c&&l.has(c)||(c=o[0]??null),e({selectedModelId:c,isLoading:!1}),await yt.saveSetting(ON,c),Ce.emit(Vn.initialDataLoaded,{configs:r,apiKeys:s,selectedModelId:c,globalSortOrder:t().globalModelSortOrder}),t().selectedModelId!==c?t().selectModel(c):Ce.emit(Vn.selectedModelChanged,{modelId:c})}catch(n){console.error("ProviderStore: Error loading initial data",n),e({isLoading:!1,error:"Failed to load provider data"}),ke.error("Failed to load provider data")}},selectModel:n=>{t().selectedModelId!==n&&(e({selectedModelId:n}),yt.saveSetting(ON,n),Ce.emit(Vn.selectedModelChanged,{modelId:n}))},addApiKey:async(n,r,s)=>{const i=Nr(),a=new Date,o={id:i,name:n,value:s,providerId:r,createdAt:a,updatedAt:a};try{return await yt.saveApiKey(o),e(l=>{l.dbApiKeys.push(o)}),ke.success(`API Key "${n}" added.`),Ce.emit(Vn.apiKeysChanged,{apiKeys:t().dbApiKeys}),i}catch(l){throw console.error("ProviderStore: Error adding API key",l),ke.error(`Failed to add API Key: ${l instanceof Error?l.message:String(l)}`),l}},deleteApiKey:async n=>{var s;const r=((s=t().dbApiKeys.find(i=>i.id===n))==null?void 0:s.name)??"Unknown Key";try{await yt.deleteApiKey(n),e(i=>{i.dbApiKeys=i.dbApiKeys.filter(a=>a.id!==n),i.dbProviderConfigs=i.dbProviderConfigs.map(a=>a.apiKeyId===n?{...a,apiKeyId:null}:a)}),ke.success(`API Key "${r}" deleted.`),Ce.emit(Vn.apiKeysChanged,{apiKeys:t().dbApiKeys}),Ce.emit(Vn.configsChanged,{providerConfigs:t().dbProviderConfigs})}catch(i){throw console.error("ProviderStore: Error deleting API key",i),ke.error(`Failed to delete API Key: ${i instanceof Error?i.message:String(i)}`),i}},addProviderConfig:async n=>{const r=Nr(),s=new Date,i={id:r,createdAt:s,updatedAt:s,name:n.name,type:n.type,isEnabled:n.isEnabled??!0,apiKeyId:n.apiKeyId??null,baseURL:n.baseURL??null,enabledModels:n.enabledModels??null,autoFetchModels:n.autoFetchModels??!0,fetchedModels:n.fetchedModels??null,modelsLastFetchedAt:n.modelsLastFetchedAt??null};try{return await yt.saveProviderConfig(i),e(a=>{a.dbProviderConfigs.push(i)}),t()._updateGloballyEnabledModelDefinitions(),ke.success(`Provider "${n.name}" added.`),Ce.emit(Vn.configsChanged,{providerConfigs:t().dbProviderConfigs}),t().fetchModels(r).catch(a=>{console.warn(`[ProviderStore] Initial model fetch failed for new provider ${r}:`,a)}),r}catch(a){throw console.error("ProviderStore: Error adding provider config",a),ke.error(`Failed to add Provider: ${a instanceof Error?a.message:String(a)}`),a}},updateProviderConfig:async(n,r)=>{const s=t().dbProviderConfigs.find(a=>a.id===n);if(!s)return;const i={...s,...r,fetchedModels:r.fetchedModels!==void 0?r.fetchedModels:s.fetchedModels,modelsLastFetchedAt:r.modelsLastFetchedAt!==void 0?r.modelsLastFetchedAt:s.modelsLastFetchedAt,updatedAt:new Date};try{await yt.saveProviderConfig(i),e(a=>{const o=a.dbProviderConfigs.findIndex(l=>l.id===n);o!==-1&&(a.dbProviderConfigs[o]=i)}),t()._updateGloballyEnabledModelDefinitions(),Ce.emit(Vn.configsChanged,{providerConfigs:t().dbProviderConfigs})}catch(a){throw console.error("ProviderStore: Error updating provider config",a),ke.error(`Failed to update Provider: ${a instanceof Error?a.message:String(a)}`),a}},deleteProviderConfig:async n=>{const r=t().dbProviderConfigs.find(i=>i.id===n);if(!r)return;const s=r.name;try{await yt.deleteProviderConfig(n),e(i=>{i.dbProviderConfigs=i.dbProviderConfigs.filter(a=>a.id!==n),delete i.providerFetchStatus[n]}),t()._updateGloballyEnabledModelDefinitions(),Ce.emit(Vn.configsChanged,{providerConfigs:t().dbProviderConfigs}),ke.success(`Provider "${s}" deleted.`)}catch(i){throw console.error("ProviderStore: Error deleting provider config",i),ke.error(`Failed to delete Provider: ${i instanceof Error?i.message:String(i)}`),i}},fetchModels:async n=>{var s;const r=t().dbProviderConfigs.find(i=>i.id===n);if(!r){ke.error("Provider configuration not found for fetching models.");return}if(t().providerFetchStatus[n]!=="fetching"){t()._setProviderFetchStatus(n,"fetching");try{const i=r.apiKeyId,a=(s=t().dbApiKeys.find(l=>l.id===i))==null?void 0:s.value,o=await qxe(r,a);await t().updateProviderConfig(n,{fetchedModels:o,modelsLastFetchedAt:new Date}),t()._setProviderFetchStatus(n,"success"),ke.success(`Models fetched successfully for ${r.name}`)}catch(i){console.error(`Error fetching models for ${r.name}:`,i),t()._setProviderFetchStatus(n,"error")}}},setGlobalModelSortOrder:async n=>{const r=Array.from(new Set(n));e({globalModelSortOrder:r}),await yt.saveSetting(F$,r),t()._updateGloballyEnabledModelDefinitions(),Ce.emit(Vn.globalModelSortOrderChanged,{ids:r});const s=t().selectedModelId,i=t().globallyEnabledModelDefinitions.map(o=>o.id),a=new Set(i);if(!s||!a.has(s)){const o=i[0]??null;o!==s&&t().selectModel(o)}},_setProviderFetchStatus:(n,r)=>{e(s=>{s.providerFetchStatus[n]=r}),Ce.emit(Vn.fetchStatusChanged,{providerId:n,status:r})},setSelectedModelForDetails:n=>{e({_selectedModelForDetails:n}),Ce.emit(Vn.selectedModelForDetailsChanged,{modelId:n})},getSelectedModel:()=>{const{selectedModelId:n}=t();if(!n)return;const{providerId:r,modelId:s}=Ql(n);if(!r||!s)return;const i=t().dbProviderConfigs.find(o=>o.id===r);if(!i)return;const a=t().dbApiKeys.find(o=>o.id===i.apiKeyId);return t().createAiModelConfig(i,s,a==null?void 0:a.value)},getApiKeyForProvider:n=>{var s;const r=t().dbProviderConfigs.find(i=>i.id===n);return(s=t().dbApiKeys.find(i=>i.id===(r==null?void 0:r.apiKeyId)))==null?void 0:s.value},getActiveProviders:()=>t().dbProviderConfigs.filter(n=>n.isEnabled).map(n=>{const r=t().getAllAvailableModelDefsForProvider(n.id);return{id:n.id,name:n.name,type:n.type,allAvailableModels:r}}),getAllAvailableModelDefsForProvider:n=>{const r=t().dbProviderConfigs.find(a=>a.id===n);if(!r)return[];if(r.fetchedModels&&r.fetchedModels.length>0)return[...r.fetchedModels];const s=r.type;return($xe[s]||[]).map(a=>{let o="text->text",l=["text"],c=["text"];return(a.id.includes("dall-e")||a.id.includes("imagen")||a.id.includes("flux")||a.id.includes("stable-diffusion"))&&(o="text->image",l=["text"],c=["image"]),{id:a.id,name:a.name,context_length:4096,architecture:{modality:o,input_modalities:l,output_modalities:c},pricing:{prompt:"0",completion:"0"},top_provider:{context_length:4096},supported_parameters:iK[r.type]??[]}})},getAvailableModelListItems:()=>{const{dbProviderConfigs:n}=t(),r=[];return n.forEach(s=>{t().getAllAvailableModelDefsForProvider(s.id).forEach(a=>{var o,l,c;r.push({id:Px(s.id,a.id),name:a.name,providerId:s.id,providerName:s.name,metadataSummary:{context_length:((o=a.top_provider)==null?void 0:o.context_length)??a.context_length,supported_parameters:a.supported_parameters,input_modalities:(l=a.architecture)==null?void 0:l.input_modalities,output_modalities:(c=a.architecture)==null?void 0:c.output_modalities,pricing:a.pricing,description:a.description}})})}),r},getRegisteredActionHandlers:()=>{const n="providerStore",r=t();return[{eventName:Vn.loadInitialDataRequest,handler:r.loadInitialData,storeId:n},{eventName:Vn.selectModelRequest,handler:s=>r.selectModel(s.modelId),storeId:n},{eventName:Vn.addApiKeyRequest,handler:s=>r.addApiKey(s.name,s.providerId,s.value).then(()=>{}),storeId:n},{eventName:Vn.deleteApiKeyRequest,handler:s=>r.deleteApiKey(s.id),storeId:n},{eventName:Vn.addProviderConfigRequest,handler:s=>r.addProviderConfig(s).then(()=>{}),storeId:n},{eventName:Vn.updateProviderConfigRequest,handler:s=>r.updateProviderConfig(s.id,s.changes),storeId:n},{eventName:Vn.deleteProviderConfigRequest,handler:s=>r.deleteProviderConfig(s.id),storeId:n},{eventName:Vn.fetchModelsRequest,handler:s=>r.fetchModels(s.providerConfigId),storeId:n},{eventName:Vn.setGlobalModelSortOrderRequest,handler:s=>r.setGlobalModelSortOrder(s.ids),storeId:n},{eventName:Vn.setEnableApiKeyManagementRequest,handler:s=>r.setEnableApiKeyManagement(s.enabled),storeId:n},{eventName:Vn.setSelectedModelForDetailsRequest,handler:s=>r.setSelectedModelForDetails(s.modelId),storeId:n}]}}))),on={loaded:"settings.loaded",themeChanged:"settings.theme.changed",globalSystemPromptChanged:"settings.global.system.prompt.changed",temperatureChanged:"settings.temperature.changed",maxTokensChanged:"settings.max.tokens.changed",topPChanged:"settings.top.p.changed",topKChanged:"settings.top.k.changed",presencePenaltyChanged:"settings.presence.penalty.changed",frequencyPenaltyChanged:"settings.frequency.penalty.changed",enableAdvancedSettingsChanged:"settings.enable.advanced.settings.changed",enableStreamingMarkdownChanged:"settings.enable.streaming.markdown.changed",enableStreamingCodeBlockParsingChanged:"settings.enable.streaming.code.block.parsing.changed",foldStreamingCodeBlocksChanged:"settings.fold.streaming.code.blocks.changed",foldUserMessagesOnCompletionChanged:"settings.fold.user.messages.on.completion.changed",streamingRenderFpsChanged:"settings.streaming.render.fps.changed",gitUserNameChanged:"settings.git.user.name.changed",gitUserEmailChanged:"settings.git.user.email.changed",toolMaxStepsChanged:"settings.tool.max.steps.changed",prismThemeUrlChanged:"settings.prism.theme.url.changed",autoTitleEnabledChanged:"settings.auto.title.enabled.changed",autoTitleModelIdChanged:"settings.auto.title.model.id.changed",autoTitlePromptMaxLengthChanged:"settings.auto.title.prompt.max.length.changed",autoTitleIncludeFilesChanged:"settings.auto.title.include.files.changed",autoTitleIncludeRulesChanged:"settings.auto.title.include.rules.changed",customFontFamilyChanged:"settings.custom.font.family.changed",customFontSizeChanged:"settings.custom.font.size.changed",chatMaxWidthChanged:"settings.chat.max.width.changed",customThemeColorsChanged:"settings.custom.theme.colors.changed",autoScrollIntervalChanged:"settings.auto.scroll.interval.changed",enableAutoScrollOnStreamChanged:"settings.enable.auto.scroll.on.stream.changed",autoSyncOnStreamCompleteChanged:"settings.auto.sync.on.stream.complete.changed",autoInitializeReposOnStartupChanged:"settings.auto.initialize.repos.on.startup.changed",setThemeRequest:"settings.set.theme.request",setGlobalSystemPromptRequest:"settings.set.global.system.prompt.request",setTemperatureRequest:"settings.set.temperature.request",setMaxTokensRequest:"settings.set.max.tokens.request",setTopPRequest:"settings.set.top.p.request",setTopKRequest:"settings.set.top.k.request",setPresencePenaltyRequest:"settings.set.presence.penalty.request",setFrequencyPenaltyRequest:"settings.set.frequency.penalty.request",setEnableAdvancedSettingsRequest:"settings.set.enable.advanced.settings.request",setEnableStreamingMarkdownRequest:"settings.set.enable.streaming.markdown.request",setEnableStreamingCodeBlockParsingRequest:"settings.set.enable.streaming.code.block.parsing.request",setFoldStreamingCodeBlocksRequest:"settings.set.fold.streaming.code.blocks.request",setFoldUserMessagesOnCompletionRequest:"settings.set.fold.user.messages.on.completion.request",setStreamingRenderFpsRequest:"settings.set.streaming.render.fps.request",setGitUserNameRequest:"settings.set.git.user.name.request",setGitUserEmailRequest:"settings.set.git.user.email.request",setToolMaxStepsRequest:"settings.set.tool.max.steps.request",setPrismThemeUrlRequest:"settings.set.prism.theme.url.request",setAutoTitleEnabledRequest:"settings.set.auto.title.enabled.request",setAutoTitleModelIdRequest:"settings.set.auto.title.model.id.request",setAutoTitlePromptMaxLengthRequest:"settings.set.auto.title.prompt.max.length.request",setAutoTitleIncludeFilesRequest:"settings.set.auto.title.include.files.request",setAutoTitleIncludeRulesRequest:"settings.set.auto.title.include.rules.request",setCustomFontFamilyRequest:"settings.set.custom.font.family.request",setCustomFontSizeRequest:"settings.set.custom.font.size.request",setChatMaxWidthRequest:"settings.set.chat.max.width.request",setCustomThemeColorsRequest:"settings.set.custom.theme.colors.request",setCustomThemeColorRequest:"settings.set.custom.theme.color.request",setAutoScrollIntervalRequest:"settings.set.auto.scroll.interval.request",setEnableAutoScrollOnStreamRequest:"settings.set.enable.auto.scroll.on.stream.request",setAutoSyncOnStreamCompleteRequest:"settings.set.auto.sync.on.stream.complete.request",setAutoInitializeReposOnStartupRequest:"settings.set.auto.initialize.repos.on.startup.request",loadSettingsRequest:"settings.load.settings.request",resetGeneralSettingsRequest:"settings.reset.general.settings.request",resetAssistantSettingsRequest:"settings.reset.assistant.settings.request",resetThemeSettingsRequest:"settings.reset.theme.settings.request"},Vxe=`You are a helpful AI assistant used in LiteChat.

You are knowledgeable, friendly, and always strive to provide accurate and useful information. When you don't know something, you admit it honestly. You communicate clearly and concisely, adapting your tone to be appropriate for the context.

## Key principles
- Be helpful and respectful
- Provide accurate information
- Ask clarifying questions when needed
- Explain complex concepts clearly
- Acknowledge limitations honestly 


## Litechat codeblock support

### downloadable codeblocks

If you create gated blocks and you can infer a filepath or a name for it, you should create it as follow : 

\`\`\`language:relative/path/to/file.ext
The file content would be completely normal
\`\`\`

examples : 
\`\`\`jsx:src/components/button.jsx
export const Button = ({ children, onClick }) => {
  return <button onClick={onClick}>{children}</button>;
};
\`\`\`

\`\`\`markdown:readme.md
---
title: My Project
description: This is a project description
---

# My Project

This is a project description
\`\`\`

### MermaidJS diagrams

Litechat support MermaidJS diagrams. only valid uncommented diagrams are supported.
For example, if a user asks you a simple explanation on http request, you should use a sequence diagram like so : 
\`\`\`mermaid
sequenceDiagram
    participant Client as "Web Browser"
    participant Server as "Web Server"

    Note over Client,Server: User initiates HTTP request
    Client->>Server: HTTP Request (GET /index.html)
    Server->>Server: Process request
    Server->>Client: HTTP Response (200 OK, HTML content)
    Note over Client,Server: User receives response
\`\`\`

### Formedible codeblocks

For guided deterministic interaction with the user through a form, you can use the \`formedible\` codeblock.

**Functionality:**
- The \`formedible\` block interprets a JavaScript object literal that defines a form structure.
- It supports multi-page forms, various input field types (text, number, select, checkbox, etc.), progress indicators, and labels.
- For security reasons, the rendered forms are **read-only** and **cannot execute any custom code or callback functions** (like \`onSubmit\`). Their primary purpose is for previewing and understanding form layouts and data structures.

**Usage:**
To generate a formedible block, enclose your form definition within a markdown code block with the language identifier \`formedible\`.

**Expected Content Format:**
The content inside the \`formedible\` block must be a single JavaScript object literal containing the form's configuration. This object can include the following top-level keys:
- \`schema\`: A \`z.object()\` definition (e.g., \`z.object({ fieldName: z.string().min(1) })\`). You can use basic Zod types. Complex Zod methods or custom functions are not supported and will be ignored or cause parsing errors.
- \`fields\`: An array of field objects. Each field object requires \`name\` (string) and \`type\` (string). Supported types are: \`text\`, \`email\`, \`password\`, \`url\`, \`tel\`, \`textarea\`, \`select\`, \`checkbox\`, \`switch\`, \`number\`, \`date\`, \`slider\`, \`file\`. Additional properties like \`label\`, \`placeholder\`, \`description\`, \`options\`, \`min\`, \`max\`, \`step\`, \`accept\`, \`multiple\`, and \`page\` can be included.
- \`pages\`: (Optional) An array of page objects for multi-page forms. Each page object requires \`page\` (number). \`title\` and \`description\` are optional.
- \`progress\`: (Optional) An object to configure the progress bar, e.g., \`{ showSteps: true, showPercentage: true }\`.
- \`submitLabel\`, \`nextLabel\`, \`previousLabel\`: (Optional) Strings for navigation button labels.
- \`formClassName\`, \`fieldClassName\`: (Optional) Strings for CSS classes.
- \`formOptions\`: (Optional) An object for basic form options. Only \`defaultValues\`, \`asyncDebounceMs\`, and \`canSubmitWhenInvalid\` are supported. Any \`onSubmit\` or other callback functions will be ignored and replaced with a disabled toast message.

**Examples:**

simple: 
\`\`\`formedible
{
  schema: z.object({
    taskName: z.string().min(3, "Task name is required"),
    priority: z.enum(["low", "medium", "high"]),
    dueDate: z.string().optional(),
    isCompleted: z.boolean(),
  }),
  fields: [
    { name: "taskName", type: "text", label: "Task Name", placeholder: "e.g., Finish report" },
    { name: "priority", type: "select", label: "Priority", options: ["low", "medium", "high"] },
    { name: "dueDate", type: "date", label: "Due Date" },
    { name: "isCompleted", type: "checkbox", label: "Mark as Completed" },
  ],
  submitLabel: "Save Task",
  formOptions: {
    defaultValues: {
      taskName: "",
      priority: "medium",
      isCompleted: false,
    }
  }
}
\`\`\`
with pages :
\`\`\`formedible
{
  schema: z.object({
    firstName: z.string().min(1, "First name is required"),
    lastName: z.string().min(1, "Last name is required"),
    email: z.string().email("Invalid email"),
    age: z.number().min(18, "Must be 18 or older"),
    bio: z.string().min(10, "Bio must be at least 10 characters"),
    notifications: z.boolean(),
  }),
  fields: [
    { name: "firstName", type: "text", label: "First Name", page: 1 },
    { name: "lastName", type: "text", label: "Last Name", page: 1 },
    { name: "email", type: "email", label: "Email", page: 2 },
    { name: "age", type: "number", label: "Age", min: 18, max: 120, page: 2 },
    { name: "bio", type: "textarea", label: "Bio", page: 3 },
    { name: "notifications", type: "switch", label: "Enable notifications", page: 3 },
  ],
  pages: [
    { page: 1, title: "Personal Info", description: "Tell us about yourself" },
    { page: 2, title: "Contact Details", description: "How can we reach you?" },
    { page: 3, title: "Preferences", description: "Customize your experience" },
  ],
  progress: { showSteps: true, showPercentage: true },
  nextLabel: "Continue →",
  previousLabel: "← Back",
  submitLabel: "Complete Registration",
  formOptions: {
    defaultValues: {
      firstName: "",
      lastName: "",
      email: "",
      age: 18,
      bio: "",
      notifications: true,
    },
  },
}
\`\`\``,DN="system",FN=Vxe,LN=.7,BN=null,$N=null,zN=null,UN=0,qN=0,L$=!0,VN=!0,WN=!0,HN=!1,GN=!1,KN=15,B$=null,$$=null,YN=5,ZN=null,XN=!0,JN=null,QN=768,eI=!1,tI=!1,z$=null,U$=null,nI=null,rI=16,sI="max-w-7xl",iI=null,aI=1e3,oI=!0,q$=!1,V$=!1,pr=Co(ko((e,t)=>({theme:DN,globalSystemPrompt:FN,temperature:LN,maxTokens:BN,topP:$N,topK:zN,presencePenalty:UN,frequencyPenalty:qN,enableAdvancedSettings:L$,enableStreamingMarkdown:VN,enableStreamingCodeBlockParsing:WN,foldStreamingCodeBlocks:HN,foldUserMessagesOnCompletion:GN,streamingRenderFPS:KN,gitUserName:B$,gitUserEmail:$$,toolMaxSteps:YN,prismThemeUrl:ZN,autoTitleEnabled:XN,autoTitleModelId:JN,autoTitlePromptMaxLength:QN,autoTitleIncludeFiles:eI,autoTitleIncludeRules:tI,forkCompactPrompt:z$,forkCompactModelId:U$,customFontFamily:nI,customFontSize:rI,chatMaxWidth:sI,customThemeColors:iI,autoScrollInterval:aI,enableAutoScrollOnStream:oI,autoSyncOnStreamComplete:q$,autoInitializeReposOnStartup:V$,setTheme:n=>{e({theme:n}),yt.saveSetting("theme",n),Ce.emit(on.themeChanged,{theme:n})},setGlobalSystemPrompt:n=>{e({globalSystemPrompt:n}),yt.saveSetting("globalSystemPrompt",n),Ce.emit(on.globalSystemPromptChanged,{prompt:n})},setTemperature:n=>{e({temperature:n}),yt.saveSetting("temperature",n),Ce.emit(on.temperatureChanged,{value:n})},setMaxTokens:n=>{e({maxTokens:n}),yt.saveSetting("maxTokens",n),Ce.emit(on.maxTokensChanged,{value:n})},setTopP:n=>{e({topP:n}),yt.saveSetting("topP",n),Ce.emit(on.topPChanged,{value:n})},setTopK:n=>{e({topK:n}),yt.saveSetting("topK",n),Ce.emit(on.topKChanged,{value:n})},setPresencePenalty:n=>{e({presencePenalty:n}),yt.saveSetting("presencePenalty",n),Ce.emit(on.presencePenaltyChanged,{value:n})},setFrequencyPenalty:n=>{e({frequencyPenalty:n}),yt.saveSetting("frequencyPenalty",n),Ce.emit(on.frequencyPenaltyChanged,{value:n})},setEnableAdvancedSettings:n=>{e({enableAdvancedSettings:n}),yt.saveSetting("enableAdvancedSettings",n),Ce.emit(on.enableAdvancedSettingsChanged,{enabled:n})},setEnableStreamingMarkdown:n=>{e({enableStreamingMarkdown:n}),yt.saveSetting("enableStreamingMarkdown",n),Ce.emit(on.enableStreamingMarkdownChanged,{enabled:n})},setEnableStreamingCodeBlockParsing:n=>{e({enableStreamingCodeBlockParsing:n}),yt.saveSetting("enableStreamingCodeBlockParsing",n),Ce.emit(on.enableStreamingCodeBlockParsingChanged,{enabled:n})},setFoldStreamingCodeBlocks:n=>{e({foldStreamingCodeBlocks:n}),yt.saveSetting("foldStreamingCodeBlocks",n),Ce.emit(on.foldStreamingCodeBlocksChanged,{fold:n})},setFoldUserMessagesOnCompletion:n=>{e({foldUserMessagesOnCompletion:n}),yt.saveSetting("foldUserMessagesOnCompletion",n),Ce.emit(on.foldUserMessagesOnCompletionChanged,{fold:n})},setStreamingRenderFPS:n=>{const r=Math.max(3,Math.min(60,n));e({streamingRenderFPS:r}),yt.saveSetting("streamingRenderFPS",r),Ce.emit(on.streamingRenderFpsChanged,{fps:r})},setGitUserName:n=>{const r=(n==null?void 0:n.trim())||null;e({gitUserName:r}),yt.saveSetting("gitUserName",r),Ce.emit(on.gitUserNameChanged,{name:r})},setGitUserEmail:n=>{const r=(n==null?void 0:n.trim())||null;e({gitUserEmail:r}),yt.saveSetting("gitUserEmail",r),Ce.emit(on.gitUserEmailChanged,{email:r})},setToolMaxSteps:n=>{const r=Math.max(1,Math.min(20,n));e({toolMaxSteps:r}),yt.saveSetting("toolMaxSteps",r),Ce.emit(on.toolMaxStepsChanged,{steps:r})},setPrismThemeUrl:n=>{const r=(n==null?void 0:n.trim())||null;e({prismThemeUrl:r}),yt.saveSetting("prismThemeUrl",r),Ce.emit(on.prismThemeUrlChanged,{url:r})},setAutoTitleEnabled:n=>{e({autoTitleEnabled:n}),yt.saveSetting("autoTitleEnabled",n),Ce.emit(on.autoTitleEnabledChanged,{enabled:n})},setAutoTitleModelId:n=>{e({autoTitleModelId:n}),yt.saveSetting("autoTitleModelId",n),Ce.emit(on.autoTitleModelIdChanged,{modelId:n})},setAutoTitlePromptMaxLength:n=>{const r=Math.max(100,Math.min(4e3,n));e({autoTitlePromptMaxLength:r}),yt.saveSetting("autoTitlePromptMaxLength",r),Ce.emit(on.autoTitlePromptMaxLengthChanged,{length:r})},setAutoTitleIncludeFiles:n=>{e({autoTitleIncludeFiles:n}),yt.saveSetting("autoTitleIncludeFiles",n),Ce.emit(on.autoTitleIncludeFilesChanged,{include:n})},setAutoTitleIncludeRules:n=>{e({autoTitleIncludeRules:n}),yt.saveSetting("autoTitleIncludeRules",n),Ce.emit(on.autoTitleIncludeRulesChanged,{include:n})},setForkCompactPrompt:n=>{e({forkCompactPrompt:n}),yt.saveSetting("forkCompactPrompt",n)},setForkCompactModelId:n=>{e({forkCompactModelId:n}),yt.saveSetting("forkCompactModelId",n)},setCustomFontFamily:n=>{const r=(n==null?void 0:n.trim())||null;e({customFontFamily:r}),yt.saveSetting("customFontFamily",r),Ce.emit(on.customFontFamilyChanged,{fontFamily:r})},setCustomFontSize:n=>{const r=n===null?null:Math.max(10,Math.min(24,n));e({customFontSize:r}),yt.saveSetting("customFontSize",r),Ce.emit(on.customFontSizeChanged,{fontSize:r})},setChatMaxWidth:n=>{e({chatMaxWidth:n}),yt.saveSetting("chatMaxWidth",n),Ce.emit(on.chatMaxWidthChanged,{maxWidth:n})},setCustomThemeColors:n=>{e({customThemeColors:n}),yt.saveSetting("customThemeColors",n),Ce.emit(on.customThemeColorsChanged,{colors:n})},setCustomThemeColor:(n,r)=>{e(i=>{const o={...i.customThemeColors??{}};r===null||r.trim()===""?delete o[n]:o[n]=r.trim(),i.customThemeColors=Object.keys(o).length>0?o:null});const s=t().customThemeColors;yt.saveSetting("customThemeColors",s),Ce.emit(on.customThemeColorsChanged,{colors:s})},setAutoScrollInterval:n=>{const r=Math.max(50,n);e({autoScrollInterval:r}),yt.saveSetting("autoScrollInterval",r),Ce.emit(on.autoScrollIntervalChanged,{interval:r})},setEnableAutoScrollOnStream:n=>{e({enableAutoScrollOnStream:n}),yt.saveSetting("enableAutoScrollOnStream",n),Ce.emit(on.enableAutoScrollOnStreamChanged,{enabled:n})},setAutoSyncOnStreamComplete:n=>{e({autoSyncOnStreamComplete:n}),yt.saveSetting("autoSyncOnStreamComplete",n),Ce.emit(on.autoSyncOnStreamCompleteChanged,{enabled:n})},setAutoInitializeReposOnStartup:n=>{e({autoInitializeReposOnStartup:n}),yt.saveSetting("autoInitializeReposOnStartup",n),Ce.emit(on.autoInitializeReposOnStartupChanged,{enabled:n})},loadSettings:async()=>{try{const[n,r,s,i,a,o,l,c,u,d,h,m,y,b,v,x,w,_,k,C,T,A,N,I,j,L,D,H,O,K,U,W,B]=await Promise.all([yt.loadSetting("theme",DN),yt.loadSetting("temperature",LN),yt.loadSetting("maxTokens",BN),yt.loadSetting("topP",$N),yt.loadSetting("topK",zN),yt.loadSetting("presencePenalty",UN),yt.loadSetting("frequencyPenalty",qN),yt.loadSetting("globalSystemPrompt",FN),yt.loadSetting("enableAdvancedSettings",L$),yt.loadSetting("enableStreamingMarkdown",VN),yt.loadSetting("enableStreamingCodeBlockParsing",WN),yt.loadSetting("foldStreamingCodeBlocks",HN),yt.loadSetting("foldUserMessagesOnCompletion",GN),yt.loadSetting("streamingRenderFPS",KN),yt.loadSetting("gitUserName",B$),yt.loadSetting("gitUserEmail",$$),yt.loadSetting("toolMaxSteps",YN),yt.loadSetting("prismThemeUrl",ZN),yt.loadSetting("autoTitleEnabled",XN),yt.loadSetting("autoTitleModelId",JN),yt.loadSetting("autoTitlePromptMaxLength",QN),yt.loadSetting("autoTitleIncludeFiles",eI),yt.loadSetting("autoTitleIncludeRules",tI),yt.loadSetting("forkCompactPrompt",z$),yt.loadSetting("forkCompactModelId",U$),yt.loadSetting("customFontFamily",nI),yt.loadSetting("customFontSize",rI),yt.loadSetting("chatMaxWidth",sI),yt.loadSetting("customThemeColors",iI),yt.loadSetting("autoScrollInterval",aI),yt.loadSetting("enableAutoScrollOnStream",oI),yt.loadSetting("autoSyncOnStreamComplete",q$),yt.loadSetting("autoInitializeReposOnStartup",V$)]),ne={theme:n,temperature:r,maxTokens:s,topP:i,topK:a,presencePenalty:o,frequencyPenalty:l,globalSystemPrompt:c,enableAdvancedSettings:u,enableStreamingMarkdown:d,enableStreamingCodeBlockParsing:h,foldStreamingCodeBlocks:m,foldUserMessagesOnCompletion:y,streamingRenderFPS:b,gitUserName:v,gitUserEmail:x,toolMaxSteps:w,prismThemeUrl:_,autoTitleEnabled:k,autoTitleModelId:C,autoTitlePromptMaxLength:T,autoTitleIncludeFiles:A,autoTitleIncludeRules:N,forkCompactPrompt:I,forkCompactModelId:j,customFontFamily:L,customFontSize:D,chatMaxWidth:H,customThemeColors:O,autoScrollInterval:K,enableAutoScrollOnStream:U,autoSyncOnStreamComplete:W,autoInitializeReposOnStartup:B};e(ne),Ce.emit(on.loaded,{settings:ne})}catch(n){console.error("SettingsStore: Error loading settings",n),Ce.emit(on.loaded,{settings:t()})}},resetGeneralSettings:async()=>{try{t().setEnableStreamingMarkdown(VN),t().setEnableStreamingCodeBlockParsing(WN),t().setFoldStreamingCodeBlocks(HN),t().setFoldUserMessagesOnCompletion(GN),t().setStreamingRenderFPS(KN),t().setAutoScrollInterval(aI),t().setEnableAutoScrollOnStream(oI),ke.success("Streaming & Display settings reset to defaults.")}catch(n){console.error("SettingsStore: Error resetting general settings",n),ke.error("Failed to reset general settings.")}},resetAssistantSettings:async()=>{try{t().setGlobalSystemPrompt(FN),t().setTemperature(LN),t().setMaxTokens(BN),t().setTopP($N),t().setTopK(zN),t().setPresencePenalty(UN),t().setFrequencyPenalty(qN),t().setToolMaxSteps(YN),t().setAutoTitleEnabled(XN),t().setAutoTitleModelId(JN),t().setAutoTitlePromptMaxLength(QN),t().setAutoTitleIncludeFiles(eI),t().setAutoTitleIncludeRules(tI),ke.success("Assistant settings reset to defaults.")}catch(n){console.error("SettingsStore: Error resetting assistant settings",n),ke.error("Failed to reset assistant settings.")}},resetThemeSettings:async()=>{try{t().setTheme(DN),t().setPrismThemeUrl(ZN),t().setCustomFontFamily(nI),t().setCustomFontSize(rI),t().setChatMaxWidth(sI),t().setCustomThemeColors(iI),ke.success("Theme settings reset to defaults.")}catch(n){console.error("SettingsStore: Error resetting theme settings",n),ke.error("Failed to reset theme settings.")}},getRegisteredActionHandlers:()=>{const n="settingsStore",r=t();return[{eventName:on.setThemeRequest,handler:s=>r.setTheme(s.theme),storeId:n},{eventName:on.setGlobalSystemPromptRequest,handler:s=>r.setGlobalSystemPrompt(s.prompt),storeId:n},{eventName:on.setTemperatureRequest,handler:s=>r.setTemperature(s.value),storeId:n},{eventName:on.setMaxTokensRequest,handler:s=>r.setMaxTokens(s.value),storeId:n},{eventName:on.setTopPRequest,handler:s=>r.setTopP(s.value),storeId:n},{eventName:on.setTopKRequest,handler:s=>r.setTopK(s.value),storeId:n},{eventName:on.setPresencePenaltyRequest,handler:s=>r.setPresencePenalty(s.value),storeId:n},{eventName:on.setFrequencyPenaltyRequest,handler:s=>r.setFrequencyPenalty(s.value),storeId:n},{eventName:on.setEnableAdvancedSettingsRequest,handler:s=>r.setEnableAdvancedSettings(s.enabled),storeId:n},{eventName:on.setEnableStreamingMarkdownRequest,handler:s=>r.setEnableStreamingMarkdown(s.enabled),storeId:n},{eventName:on.setEnableStreamingCodeBlockParsingRequest,handler:s=>r.setEnableStreamingCodeBlockParsing(s.enabled),storeId:n},{eventName:on.setFoldStreamingCodeBlocksRequest,handler:s=>r.setFoldStreamingCodeBlocks(s.fold),storeId:n},{eventName:on.setFoldUserMessagesOnCompletionRequest,handler:s=>r.setFoldUserMessagesOnCompletion(s.fold),storeId:n},{eventName:on.setStreamingRenderFpsRequest,handler:s=>r.setStreamingRenderFPS(s.fps),storeId:n},{eventName:on.setGitUserNameRequest,handler:s=>r.setGitUserName(s.name),storeId:n},{eventName:on.setGitUserEmailRequest,handler:s=>r.setGitUserEmail(s.email),storeId:n},{eventName:on.setToolMaxStepsRequest,handler:s=>r.setToolMaxSteps(s.steps),storeId:n},{eventName:on.setPrismThemeUrlRequest,handler:s=>r.setPrismThemeUrl(s.url),storeId:n},{eventName:on.setAutoTitleEnabledRequest,handler:s=>r.setAutoTitleEnabled(s.enabled),storeId:n},{eventName:on.setAutoTitleModelIdRequest,handler:s=>r.setAutoTitleModelId(s.modelId),storeId:n},{eventName:on.setAutoTitlePromptMaxLengthRequest,handler:s=>r.setAutoTitlePromptMaxLength(s.length),storeId:n},{eventName:on.setAutoTitleIncludeFilesRequest,handler:s=>r.setAutoTitleIncludeFiles(s.include),storeId:n},{eventName:on.setAutoTitleIncludeRulesRequest,handler:s=>r.setAutoTitleIncludeRules(s.include),storeId:n},{eventName:on.setCustomFontFamilyRequest,handler:s=>r.setCustomFontFamily(s.fontFamily),storeId:n},{eventName:on.setCustomFontSizeRequest,handler:s=>r.setCustomFontSize(s.fontSize),storeId:n},{eventName:on.setChatMaxWidthRequest,handler:s=>r.setChatMaxWidth(s.maxWidth),storeId:n},{eventName:on.setCustomThemeColorsRequest,handler:s=>r.setCustomThemeColors(s.colors),storeId:n},{eventName:on.setCustomThemeColorRequest,handler:s=>r.setCustomThemeColor(s.colorKey,s.value),storeId:n},{eventName:on.setAutoScrollIntervalRequest,handler:s=>r.setAutoScrollInterval(s.interval),storeId:n},{eventName:on.setEnableAutoScrollOnStreamRequest,handler:s=>r.setEnableAutoScrollOnStream(s.enabled),storeId:n},{eventName:on.setAutoSyncOnStreamCompleteRequest,handler:s=>r.setAutoSyncOnStreamComplete(s.enabled),storeId:n},{eventName:on.setAutoInitializeReposOnStartupRequest,handler:s=>r.setAutoInitializeReposOnStartup(s.enabled),storeId:n},{eventName:on.loadSettingsRequest,handler:()=>r.loadSettings(),storeId:n},{eventName:on.resetGeneralSettingsRequest,handler:()=>r.resetGeneralSettings(),storeId:n},{eventName:on.resetAssistantSettingsRequest,handler:()=>r.resetAssistantSettings(),storeId:n},{eventName:on.resetThemeSettingsRequest,handler:()=>r.resetThemeSettings(),storeId:n}]}})));async function Y2(e,t){const n=Bi.getState().getMiddlewareForHook,r=n(e);let s=t;for(const i of r)try{const a=await i.callback(s);if(a===!1)return console.log(`Middleware ${i.modId} cancelled action for hook ${e}`),!1;a&&typeof a=="object"&&(s=a)}catch(a){return console.error(`Middleware error in mod ${i.modId} for hook ${e}:`,a),!1}return s}function W$(){const e=nn.getState(),t=Gn.getState(),n=pr.getState(),{providerId:r}=Ql(t.selectedModelId),s={selectedConversationId:e.currentConversationId,interactions:e.interactions,isStreaming:e.status==="streaming",selectedProviderId:r,selectedModelId:t.selectedModelId,activeSystemPrompt:n.globalSystemPrompt,temperature:n.temperature,maxTokens:n.maxTokens,theme:n.theme,gitUserName:n.gitUserName,gitUserEmail:n.gitUserEmail};return Object.freeze(s)}function Wxe(e){try{const t=atob(e),n=t.length,r=new Uint8Array(n);for(let s=0;s<n;s++)r[s]=t.charCodeAt(s);return r}catch(t){throw console.error("Error decoding base64 string:",t),new Error("Invalid base64 string for file content.")}}function H$(e){try{const t=e.type||"application/octet-stream",n=ow(e.name,t),r=t.startsWith("image/");if(e.contentBytes!==void 0)return n?{type:"text",text:new TextDecoder().decode(e.contentBytes)}:r?{type:"image",image:e.contentBytes,mimeType:t}:(console.warn(`AIService: Unsupported VFS file type "${t}" for direct inclusion. Sending note.`),{type:"text",text:`[Attached VFS file: ${e.name} (${t})]`});if(e.contentText!==void 0&&n)return{type:"text",text:e.contentText};if(e.contentBase64!==void 0&&r)return{type:"image",image:Wxe(e.contentBase64),mimeType:t};if(e.contentBase64!==void 0&&!n&&!r)return console.warn(`AIService: Unsupported direct upload type "${t}" for direct inclusion. Sending note.`),{type:"text",text:`[Attached file: ${e.name} (${t})]`};throw n&&e.contentText===void 0?new Error(`Missing text content for likely text file: ${e.name}`):r&&e.contentBase64===void 0?new Error(`Missing base64 content for image file: ${e.name}`):new Error(`Missing or unusable content for file: ${e.name}`)}catch(t){return console.error(`AIService: Failed to process content for ${e.name}:`,t),ke.error(`Failed to process file "${e.name}": ${t instanceof Error?t.message:String(t)}`),{type:"text",text:`[Error processing file: ${e.name}]`}}}function Ox(e){return e.flatMap(t=>{var s,i,a;const n=[],r=t.prompt;if(r){const o=[];r.content&&o.push({type:"text",text:r.content}),(s=r.metadata)!=null&&s.attachedFiles&&r.metadata.attachedFiles.length>0&&r.metadata.attachedFiles.forEach(l=>{o.push({type:"text",text:`[User attached file: ${l.name}]`})}),o.length>0&&n.push({role:"user",content:o})}if(t.response&&typeof t.response=="string"&&n.push({role:"assistant",content:t.response}),(i=t.metadata)!=null&&i.toolCalls&&Array.isArray(t.metadata.toolCalls)){const o=[];t.metadata.toolCalls.forEach(l=>{try{const c=JSON.parse(l);c&&c.type==="tool-call"&&c.toolCallId&&c.toolName&&c.args!==void 0?o.push(c):console.warn("[AIService] buildHistory: Invalid tool call structure after parsing:",l)}catch(c){console.error("[AIService] buildHistory: Failed to parse tool call string:",l,c)}}),o.length>0&&n.push({role:"assistant",content:o})}if((a=t.metadata)!=null&&a.toolResults&&Array.isArray(t.metadata.toolResults)){const o=[];t.metadata.toolResults.forEach(l=>{try{const c=JSON.parse(l);c&&c.type==="tool-result"&&c.toolCallId&&c.toolName&&c.result!==void 0?o.push(c):console.warn("[AIService] buildHistory: Invalid tool result structure after parsing:",l)}catch(c){console.error("[AIService] buildHistory: Failed to parse tool result string:",l,c)}}),o.length>0&&n.push({role:"tool",content:o})}return n})}const G$=e=>Symbol.iterator in e,K$=e=>"entries"in e,Y$=(e,t)=>{const n=e instanceof Map?e:new Map(e.entries()),r=t instanceof Map?t:new Map(t.entries());if(n.size!==r.size)return!1;for(const[s,i]of n)if(!Object.is(i,r.get(s)))return!1;return!0},Hxe=(e,t)=>{const n=e[Symbol.iterator](),r=t[Symbol.iterator]();let s=n.next(),i=r.next();for(;!s.done&&!i.done;){if(!Object.is(s.value,i.value))return!1;s=n.next(),i=r.next()}return!!s.done&&!!i.done};function Gxe(e,t){return Object.is(e,t)?!0:typeof e!="object"||e===null||typeof t!="object"||t===null?!1:!G$(e)||!G$(t)?Y$({entries:()=>Object.entries(e)},{entries:()=>Object.entries(t)}):K$(e)&&K$(t)?Y$(e,t):Hxe(e,t)}function mn(e){const t=Ve.useRef(void 0);return n=>{const r=e(n);return Gxe(t.current,r)?t.current:t.current=r}}var gy=(e=>(e.PROMPT_TURN_FINALIZE="middleware.prompt.turnFinalize",e.INTERACTION_BEFORE_START="middleware.interaction.beforeStart",e.INTERACTION_PROCESS_CHUNK="middleware.interaction.processChunk",e))(gy||{});const an={initialized:"prompt.state.initialized",parameterChanged:"prompt.state.parameter.changed",transientParametersReset:"prompt.state.transient.parameters.reset",inputTextStateChanged:"prompt.state.input.text.changed",submitted:"prompt.state.submitted",enhancementStarted:"prompt.enhancement.started",enhancementCompleted:"prompt.enhancement.completed",enhancementFailed:"prompt.enhancement.failed",setModelIdRequest:"prompt.state.set.model.id.request",setTemperatureRequest:"prompt.state.set.temperature.request",setMaxTokensRequest:"prompt.state.set.max.tokens.request",setTopPRequest:"prompt.state.set.top.p.request",setTopKRequest:"prompt.state.set.top.k.request",setPresencePenaltyRequest:"prompt.state.set.presence.penalty.request",setFrequencyPenaltyRequest:"prompt.state.set.frequency.penalty.request",setReasoningEnabledRequest:"prompt.state.set.reasoning.enabled.request",setWebSearchEnabledRequest:"prompt.state.set.web.search.enabled.request",setImageGenerationEnabledRequest:"prompt.state.set.image.generation.enabled.request",setStructuredOutputJsonRequest:"prompt.state.set.structured.output.json.request",initializePromptStateRequest:"prompt.state.initialize.prompt.state.request",resetTransientParametersRequest:"prompt.state.reset.transient.parameters.request",setInputTextRequest:"prompt.input.set.text.request",focusInputRequest:"prompt.input.focus.request",submitPromptRequest:"prompt.submit.request",enhancePromptRequest:"prompt.enhance.request",inputChanged:"prompt.inputChanged"},_c=(e,t)=>{Ce.emit(an.parameterChanged,{params:{[e]:t}})},co=Co(ko((e,t)=>({modelId:null,temperature:null,maxTokens:null,topP:null,topK:null,presencePenalty:null,frequencyPenalty:null,reasoningEnabled:null,webSearchEnabled:null,imageGenerationEnabled:null,structuredOutputJson:null,setModelId:n=>{t().modelId!==n&&(e({modelId:n}),_c("modelId",n))},setTemperature:n=>{t().temperature!==n&&(e({temperature:n}),_c("temperature",n))},setMaxTokens:n=>{t().maxTokens!==n&&(e({maxTokens:n}),_c("maxTokens",n))},setTopP:n=>{t().topP!==n&&(e({topP:n}),_c("topP",n))},setTopK:n=>{t().topK!==n&&(e({topK:n}),_c("topK",n))},setPresencePenalty:n=>{t().presencePenalty!==n&&(e({presencePenalty:n}),_c("presencePenalty",n))},setFrequencyPenalty:n=>{t().frequencyPenalty!==n&&(e({frequencyPenalty:n}),_c("frequencyPenalty",n))},setReasoningEnabled:n=>{t().reasoningEnabled!==n&&(e({reasoningEnabled:n}),_c("reasoningEnabled",n))},setWebSearchEnabled:n=>{t().webSearchEnabled!==n&&(e({webSearchEnabled:n}),_c("webSearchEnabled",n))},setImageGenerationEnabled:n=>{t().imageGenerationEnabled!==n&&(e({imageGenerationEnabled:n}),_c("imageGenerationEnabled",n))},setStructuredOutputJson:n=>{t().structuredOutputJson!==n&&(e({structuredOutputJson:n}),_c("structuredOutputJson",n))},initializePromptState:n=>{console.log("[PromptStateStore] Initializing with:",n);const r=t(),s={};let i=!1;r.modelId!==n.modelId&&(s.modelId=n.modelId,i=!0),r.temperature!==n.temperature&&(s.temperature=n.temperature,i=!0),r.maxTokens!==n.maxTokens&&(s.maxTokens=n.maxTokens,i=!0),r.topP!==n.topP&&(s.topP=n.topP,i=!0),r.topK!==n.topK&&(s.topK=n.topK,i=!0),r.presencePenalty!==n.presencePenalty&&(s.presencePenalty=n.presencePenalty,i=!0),r.frequencyPenalty!==n.frequencyPenalty&&(s.frequencyPenalty=n.frequencyPenalty,i=!0),i&&(e(s),Ce.emit(an.parameterChanged,{params:s})),Ce.emit(an.initialized,{state:{...t()}})},resetTransientParameters:()=>{console.log("[PromptStateStore] Resetting transient parameters.");const n=t(),r={};let s=!1;n.temperature!==null&&(r.temperature=null,s=!0),n.maxTokens!==null&&(r.maxTokens=null,s=!0),n.topP!==null&&(r.topP=null,s=!0),n.topK!==null&&(r.topK=null,s=!0),n.presencePenalty!==null&&(r.presencePenalty=null,s=!0),n.frequencyPenalty!==null&&(r.frequencyPenalty=null,s=!0),n.reasoningEnabled!==null&&(r.reasoningEnabled=null,s=!0),n.webSearchEnabled!==null&&(r.webSearchEnabled=null,s=!0),n.imageGenerationEnabled!==null&&(r.imageGenerationEnabled=null,s=!0),n.structuredOutputJson!==null&&(r.structuredOutputJson=null,s=!0),s&&(e(r),Ce.emit(an.parameterChanged,{params:r})),Ce.emit(an.transientParametersReset,void 0)},getRegisteredActionHandlers:()=>{const n="promptStateStore",r=t();return[{eventName:an.setModelIdRequest,handler:s=>r.setModelId(s.id),storeId:n},{eventName:an.setTemperatureRequest,handler:s=>r.setTemperature(s.value),storeId:n},{eventName:an.setMaxTokensRequest,handler:s=>r.setMaxTokens(s.value),storeId:n},{eventName:an.setTopPRequest,handler:s=>r.setTopP(s.value),storeId:n},{eventName:an.setTopKRequest,handler:s=>r.setTopK(s.value),storeId:n},{eventName:an.setPresencePenaltyRequest,handler:s=>r.setPresencePenalty(s.value),storeId:n},{eventName:an.setFrequencyPenaltyRequest,handler:s=>r.setFrequencyPenalty(s.value),storeId:n},{eventName:an.setReasoningEnabledRequest,handler:s=>r.setReasoningEnabled(s.enabled),storeId:n},{eventName:an.setWebSearchEnabledRequest,handler:s=>r.setWebSearchEnabled(s.enabled),storeId:n},{eventName:an.setImageGenerationEnabledRequest,handler:s=>r.setImageGenerationEnabled(s.enabled),storeId:n},{eventName:an.setStructuredOutputJsonRequest,handler:s=>r.setStructuredOutputJson(s.json),storeId:n},{eventName:an.initializePromptStateRequest,handler:s=>r.initializePromptState(s.effectiveSettings),storeId:n},{eventName:an.resetTransientParametersRequest,handler:()=>r.resetTransientParameters(),storeId:n}]}}))),Kxe=({InputAreaRenderer:e,onSubmit:t,className:n,placeholder:r="Send a message...",inputAreaRef:s,selectedItemId:i,selectedItemType:a})=>{const[o,l]=E.useState(!1),[c,u]=E.useState(!1),d=Bi(mn(C=>C.promptControls)),h=nn(mn(C=>C.status==="streaming")),{attachedFilesMetadata:m,clearAttachedFiles:y}=Ph(mn(C=>({attachedFilesMetadata:C.attachedFilesMetadata,clearAttachedFiles:C.clearAttachedFiles}))),b=co(C=>C.modelId),v=E.useMemo(()=>Object.values(d),[d]),x=E.useMemo(()=>v.filter(C=>C.renderer),[v]),w=E.useMemo(()=>v.filter(C=>C.triggerRenderer),[v]),_=E.useCallback(async C=>{var I,j;const T=((I=s==null?void 0:s.current)==null?void 0:I.getValue())??"",A=C!==void 0?C.trim():T.trim(),N=Ph.getState().attachedFilesMetadata;if(!(!A&&N.length===0)&&!(h||o)){l(!0);try{let L={},D={};for(const U of v){if(U.getParameters){const W=await U.getParameters();W&&(L={...L,...W})}if(U.getMetadata){const W=await U.getMetadata();W&&(D={...D,...W})}}N.length>0&&(D.attachedFiles=[...N]),!D.modelId&&b&&(D.modelId=b);let H={id:Nr(),content:A,parameters:L,metadata:D};Ce.emit(an.submitted,{turnData:H});const O=await Y2(gy.PROMPT_TURN_FINALIZE,{turnData:H});if(O===!1){console.log("Prompt submission cancelled by middleware."),l(!1);return}const K=O&&typeof O=="object"?O.turnData:H;await t(K),y(),v.forEach(U=>{U.clearOnSubmit&&U.clearOnSubmit()}),(j=s.current)==null||j.clearValue(),u(!1)}catch(L){console.error("Error during prompt submission:",L),ke.error(`Failed to send message: ${L instanceof Error?L.message:String(L)}`)}finally{l(!1)}}},[s,h,o,v,t,y,b]);E.useEffect(()=>{a==="conversation"&&i&&requestAnimationFrame(()=>{var C;(C=s.current)==null||C.focus()})},[i,a,s]),E.useEffect(()=>{const C=()=>{requestAnimationFrame(()=>{var N;(N=s.current)==null||N.focus()})},T=N=>{s.current&&(s.current.setValue(N.text),u(N.text.trim().length>0))},A=async N=>{nn.getState().status==="streaming"||o||await _(N.turnData.content)};return Ce.on(an.focusInputRequest,C),Ce.on(an.setInputTextRequest,T),Ce.on(an.submitPromptRequest,A),()=>{Ce.off(an.focusInputRequest,C),Ce.off(an.setInputTextRequest,T),Ce.off(an.submitPromptRequest,A)}},[s,_,o]);const k=E.useCallback(C=>{u(C.trim().length>0)},[]);return f.jsxs("div",{className:Ye("p-2 md:p-4 space-y-2 md:space-y-3",n),children:[x.length>0&&f.jsx(XB,{controls:x,area:"panel",className:"flex flex-wrap gap-1 md:gap-2 items-start mb-1 md:mb-2"}),f.jsxs("div",{className:"flex items-end gap-2",children:[f.jsx(e,{ref:s,onSubmit:_,disabled:h||o,placeholder:r,onValueChange:k,className:"flex-grow"}),f.jsx(ot,{type:"button",size:"icon",onClick:()=>_(void 0),disabled:h||o||!c&&m.length===0,className:"h-9 w-9 flex-shrink-0","aria-label":"Send message",children:o?f.jsx(Hn,{className:"h-4 w-4 animate-spin"}):f.jsx(n0e,{className:"h-4 w-4"})})]})," ",f.jsx(XB,{controls:w,area:"trigger",className:"flex items-center gap-1 flex-wrap flex-shrink-0 mt-1 md:mt-2"})]})};function Wt(e,t,{checkForDefaultPrevented:n=!0}={}){return function(s){if(e==null||e(s),n===!1||!s.defaultPrevented)return t==null?void 0:t(s)}}function Yxe(e,t){const n=E.createContext(t),r=i=>{const{children:a,...o}=i,l=E.useMemo(()=>o,Object.values(o));return f.jsx(n.Provider,{value:l,children:a})};r.displayName=e+"Provider";function s(i){const a=E.useContext(n);if(a)return a;if(t!==void 0)return t;throw new Error(`\`${i}\` must be used within \`${e}\``)}return[r,s]}function Ei(e,t=[]){let n=[];function r(i,a){const o=E.createContext(a),l=n.length;n=[...n,a];const c=d=>{var x;const{scope:h,children:m,...y}=d,b=((x=h==null?void 0:h[e])==null?void 0:x[l])||o,v=E.useMemo(()=>y,Object.values(y));return f.jsx(b.Provider,{value:v,children:m})};c.displayName=i+"Provider";function u(d,h){var b;const m=((b=h==null?void 0:h[e])==null?void 0:b[l])||o,y=E.useContext(m);if(y)return y;if(a!==void 0)return a;throw new Error(`\`${d}\` must be used within \`${i}\``)}return[c,u]}const s=()=>{const i=n.map(a=>E.createContext(a));return function(o){const l=(o==null?void 0:o[e])||i;return E.useMemo(()=>({[`__scope${e}`]:{...o,[e]:l}}),[o,l])}};return s.scopeName=e,[r,Zxe(s,...t)]}function Zxe(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const r=e.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(i){const a=r.reduce((o,{useScope:l,scopeName:c})=>{const d=l(i)[`__scope${c}`];return{...o,...d}},{});return E.useMemo(()=>({[`__scope${t.scopeName}`]:a}),[a])}};return n.scopeName=t.scopeName,n}function Xxe(e){const t=Jxe(e),n=E.forwardRef((r,s)=>{const{children:i,...a}=r,o=E.Children.toArray(i),l=o.find(ewe);if(l){const c=l.props.children,u=o.map(d=>d===l?E.Children.count(c)>1?E.Children.only(null):E.isValidElement(c)?c.props.children:null:d);return f.jsx(t,{...a,ref:s,children:E.isValidElement(c)?E.cloneElement(c,void 0,u):null})}return f.jsx(t,{...a,ref:s,children:i})});return n.displayName=`${e}.Slot`,n}function Jxe(e){const t=E.forwardRef((n,r)=>{const{children:s,...i}=n;if(E.isValidElement(s)){const a=nwe(s),o=twe(i,s.props);return s.type!==E.Fragment&&(o.ref=r?wl(r,a):a),E.cloneElement(s,o)}return E.Children.count(s)>1?E.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var Qxe=Symbol("radix.slottable");function ewe(e){return E.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===Qxe}function twe(e,t){const n={...t};for(const r in t){const s=e[r],i=t[r];/^on[A-Z]/.test(r)?s&&i?n[r]=(...o)=>{i(...o),s(...o)}:s&&(n[r]=s):r==="style"?n[r]={...s,...i}:r==="className"&&(n[r]=[s,i].filter(Boolean).join(" "))}return{...e,...n}}function nwe(e){var r,s;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(s=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:s.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var rwe=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Kn=rwe.reduce((e,t)=>{const n=Xxe(`Primitive.${t}`),r=E.forwardRef((s,i)=>{const{asChild:a,...o}=s,l=a?n:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),f.jsx(l,{...o,ref:i})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{});function aK(e,t){e&&yl.flushSync(()=>e.dispatchEvent(t))}function Ts(e){const t=E.useRef(e);return E.useEffect(()=>{t.current=e}),E.useMemo(()=>(...n)=>{var r;return(r=t.current)==null?void 0:r.call(t,...n)},[])}function gO(e,t=globalThis==null?void 0:globalThis.document){const n=Ts(e);E.useEffect(()=>{const r=s=>{s.key==="Escape"&&n(s)};return t.addEventListener("keydown",r,{capture:!0}),()=>t.removeEventListener("keydown",r,{capture:!0})},[n,t])}var swe="DismissableLayer",N3="dismissableLayer.update",iwe="dismissableLayer.pointerDownOutside",awe="dismissableLayer.focusOutside",Z$,oK=E.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),zE=E.forwardRef((e,t)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:s,onFocusOutside:i,onInteractOutside:a,onDismiss:o,...l}=e,c=E.useContext(oK),[u,d]=E.useState(null),h=(u==null?void 0:u.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,m]=E.useState({}),y=Tn(t,A=>d(A)),b=Array.from(c.layers),[v]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),x=b.indexOf(v),w=u?b.indexOf(u):-1,_=c.layersWithOutsidePointerEventsDisabled.size>0,k=w>=x,C=cwe(A=>{const N=A.target,I=[...c.branches].some(j=>j.contains(N));!k||I||(s==null||s(A),a==null||a(A),A.defaultPrevented||o==null||o())},h),T=uwe(A=>{const N=A.target;[...c.branches].some(j=>j.contains(N))||(i==null||i(A),a==null||a(A),A.defaultPrevented||o==null||o())},h);return gO(A=>{w===c.layers.size-1&&(r==null||r(A),!A.defaultPrevented&&o&&(A.preventDefault(),o()))},h),E.useEffect(()=>{if(u)return n&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(Z$=h.body.style.pointerEvents,h.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(u)),c.layers.add(u),X$(),()=>{n&&c.layersWithOutsidePointerEventsDisabled.size===1&&(h.body.style.pointerEvents=Z$)}},[u,h,n,c]),E.useEffect(()=>()=>{u&&(c.layers.delete(u),c.layersWithOutsidePointerEventsDisabled.delete(u),X$())},[u,c]),E.useEffect(()=>{const A=()=>m({});return document.addEventListener(N3,A),()=>document.removeEventListener(N3,A)},[]),f.jsx(Kn.div,{...l,ref:y,style:{pointerEvents:_?k?"auto":"none":void 0,...e.style},onFocusCapture:Wt(e.onFocusCapture,T.onFocusCapture),onBlurCapture:Wt(e.onBlurCapture,T.onBlurCapture),onPointerDownCapture:Wt(e.onPointerDownCapture,C.onPointerDownCapture)})});zE.displayName=swe;var owe="DismissableLayerBranch",lwe=E.forwardRef((e,t)=>{const n=E.useContext(oK),r=E.useRef(null),s=Tn(t,r);return E.useEffect(()=>{const i=r.current;if(i)return n.branches.add(i),()=>{n.branches.delete(i)}},[n.branches]),f.jsx(Kn.div,{...e,ref:s})});lwe.displayName=owe;function cwe(e,t=globalThis==null?void 0:globalThis.document){const n=Ts(e),r=E.useRef(!1),s=E.useRef(()=>{});return E.useEffect(()=>{const i=o=>{if(o.target&&!r.current){let l=function(){lK(iwe,n,c,{discrete:!0})};const c={originalEvent:o};o.pointerType==="touch"?(t.removeEventListener("click",s.current),s.current=l,t.addEventListener("click",s.current,{once:!0})):l()}else t.removeEventListener("click",s.current);r.current=!1},a=window.setTimeout(()=>{t.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(a),t.removeEventListener("pointerdown",i),t.removeEventListener("click",s.current)}},[t,n]),{onPointerDownCapture:()=>r.current=!0}}function uwe(e,t=globalThis==null?void 0:globalThis.document){const n=Ts(e),r=E.useRef(!1);return E.useEffect(()=>{const s=i=>{i.target&&!r.current&&lK(awe,n,{originalEvent:i},{discrete:!1})};return t.addEventListener("focusin",s),()=>t.removeEventListener("focusin",s)},[t,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function X$(){const e=new CustomEvent(N3);document.dispatchEvent(e)}function lK(e,t,n,{discrete:r}){const s=n.originalEvent.target,i=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&s.addEventListener(e,t,{once:!0}),r?aK(s,i):s.dispatchEvent(i)}var ii=globalThis!=null&&globalThis.document?E.useLayoutEffect:()=>{},dwe=vH[" useId ".trim().toString()]||(()=>{}),fwe=0;function pa(e){const[t,n]=E.useState(dwe());return ii(()=>{n(r=>r??String(fwe++))},[e]),t?`radix-${t}`:""}const hwe=["top","right","bottom","left"],Fh=Math.min,ml=Math.max,Z2=Math.round,W_=Math.floor,Ou=e=>({x:e,y:e}),pwe={left:"right",right:"left",bottom:"top",top:"bottom"},mwe={start:"end",end:"start"};function I3(e,t,n){return ml(e,Fh(t,n))}function af(e,t){return typeof e=="function"?e(t):e}function of(e){return e.split("-")[0]}function rb(e){return e.split("-")[1]}function yO(e){return e==="x"?"y":"x"}function bO(e){return e==="y"?"height":"width"}function Lh(e){return["top","bottom"].includes(of(e))?"y":"x"}function vO(e){return yO(Lh(e))}function gwe(e,t,n){n===void 0&&(n=!1);const r=rb(e),s=vO(e),i=bO(s);let a=s==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return t.reference[i]>t.floating[i]&&(a=X2(a)),[a,X2(a)]}function ywe(e){const t=X2(e);return[M3(e),t,M3(t)]}function M3(e){return e.replace(/start|end/g,t=>mwe[t])}function bwe(e,t,n){const r=["left","right"],s=["right","left"],i=["top","bottom"],a=["bottom","top"];switch(e){case"top":case"bottom":return n?t?s:r:t?r:s;case"left":case"right":return t?i:a;default:return[]}}function vwe(e,t,n,r){const s=rb(e);let i=bwe(of(e),n==="start",r);return s&&(i=i.map(a=>a+"-"+s),t&&(i=i.concat(i.map(M3)))),i}function X2(e){return e.replace(/left|right|bottom|top/g,t=>pwe[t])}function xwe(e){return{top:0,right:0,bottom:0,left:0,...e}}function cK(e){return typeof e!="number"?xwe(e):{top:e,right:e,bottom:e,left:e}}function J2(e){const{x:t,y:n,width:r,height:s}=e;return{width:r,height:s,top:n,left:t,right:t+r,bottom:n+s,x:t,y:n}}function J$(e,t,n){let{reference:r,floating:s}=e;const i=Lh(t),a=vO(t),o=bO(a),l=of(t),c=i==="y",u=r.x+r.width/2-s.width/2,d=r.y+r.height/2-s.height/2,h=r[o]/2-s[o]/2;let m;switch(l){case"top":m={x:u,y:r.y-s.height};break;case"bottom":m={x:u,y:r.y+r.height};break;case"right":m={x:r.x+r.width,y:d};break;case"left":m={x:r.x-s.width,y:d};break;default:m={x:r.x,y:r.y}}switch(rb(t)){case"start":m[a]-=h*(n&&c?-1:1);break;case"end":m[a]+=h*(n&&c?-1:1);break}return m}const wwe=async(e,t,n)=>{const{placement:r="bottom",strategy:s="absolute",middleware:i=[],platform:a}=n,o=i.filter(Boolean),l=await(a.isRTL==null?void 0:a.isRTL(t));let c=await a.getElementRects({reference:e,floating:t,strategy:s}),{x:u,y:d}=J$(c,r,l),h=r,m={},y=0;for(let b=0;b<o.length;b++){const{name:v,fn:x}=o[b],{x:w,y:_,data:k,reset:C}=await x({x:u,y:d,initialPlacement:r,placement:h,strategy:s,middlewareData:m,rects:c,platform:a,elements:{reference:e,floating:t}});u=w??u,d=_??d,m={...m,[v]:{...m[v],...k}},C&&y<=50&&(y++,typeof C=="object"&&(C.placement&&(h=C.placement),C.rects&&(c=C.rects===!0?await a.getElementRects({reference:e,floating:t,strategy:s}):C.rects),{x:u,y:d}=J$(c,h,l)),b=-1)}return{x:u,y:d,placement:h,strategy:s,middlewareData:m}};async function fw(e,t){var n;t===void 0&&(t={});const{x:r,y:s,platform:i,rects:a,elements:o,strategy:l}=e,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:h=!1,padding:m=0}=af(t,e),y=cK(m),v=o[h?d==="floating"?"reference":"floating":d],x=J2(await i.getClippingRect({element:(n=await(i.isElement==null?void 0:i.isElement(v)))==null||n?v:v.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(o.floating)),boundary:c,rootBoundary:u,strategy:l})),w=d==="floating"?{x:r,y:s,width:a.floating.width,height:a.floating.height}:a.reference,_=await(i.getOffsetParent==null?void 0:i.getOffsetParent(o.floating)),k=await(i.isElement==null?void 0:i.isElement(_))?await(i.getScale==null?void 0:i.getScale(_))||{x:1,y:1}:{x:1,y:1},C=J2(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:o,rect:w,offsetParent:_,strategy:l}):w);return{top:(x.top-C.top+y.top)/k.y,bottom:(C.bottom-x.bottom+y.bottom)/k.y,left:(x.left-C.left+y.left)/k.x,right:(C.right-x.right+y.right)/k.x}}const Swe=e=>({name:"arrow",options:e,async fn(t){const{x:n,y:r,placement:s,rects:i,platform:a,elements:o,middlewareData:l}=t,{element:c,padding:u=0}=af(e,t)||{};if(c==null)return{};const d=cK(u),h={x:n,y:r},m=vO(s),y=bO(m),b=await a.getDimensions(c),v=m==="y",x=v?"top":"left",w=v?"bottom":"right",_=v?"clientHeight":"clientWidth",k=i.reference[y]+i.reference[m]-h[m]-i.floating[y],C=h[m]-i.reference[m],T=await(a.getOffsetParent==null?void 0:a.getOffsetParent(c));let A=T?T[_]:0;(!A||!await(a.isElement==null?void 0:a.isElement(T)))&&(A=o.floating[_]||i.floating[y]);const N=k/2-C/2,I=A/2-b[y]/2-1,j=Fh(d[x],I),L=Fh(d[w],I),D=j,H=A-b[y]-L,O=A/2-b[y]/2+N,K=I3(D,O,H),U=!l.arrow&&rb(s)!=null&&O!==K&&i.reference[y]/2-(O<D?j:L)-b[y]/2<0,W=U?O<D?O-D:O-H:0;return{[m]:h[m]+W,data:{[m]:K,centerOffset:O-K-W,...U&&{alignmentOffset:W}},reset:U}}}),_we=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var n,r;const{placement:s,middlewareData:i,rects:a,initialPlacement:o,platform:l,elements:c}=t,{mainAxis:u=!0,crossAxis:d=!0,fallbackPlacements:h,fallbackStrategy:m="bestFit",fallbackAxisSideDirection:y="none",flipAlignment:b=!0,...v}=af(e,t);if((n=i.arrow)!=null&&n.alignmentOffset)return{};const x=of(s),w=Lh(o),_=of(o)===o,k=await(l.isRTL==null?void 0:l.isRTL(c.floating)),C=h||(_||!b?[X2(o)]:ywe(o)),T=y!=="none";!h&&T&&C.push(...vwe(o,b,y,k));const A=[o,...C],N=await fw(t,v),I=[];let j=((r=i.flip)==null?void 0:r.overflows)||[];if(u&&I.push(N[x]),d){const O=gwe(s,a,k);I.push(N[O[0]],N[O[1]])}if(j=[...j,{placement:s,overflows:I}],!I.every(O=>O<=0)){var L,D;const O=(((L=i.flip)==null?void 0:L.index)||0)+1,K=A[O];if(K)return{data:{index:O,overflows:j},reset:{placement:K}};let U=(D=j.filter(W=>W.overflows[0]<=0).sort((W,B)=>W.overflows[1]-B.overflows[1])[0])==null?void 0:D.placement;if(!U)switch(m){case"bestFit":{var H;const W=(H=j.filter(B=>{if(T){const ne=Lh(B.placement);return ne===w||ne==="y"}return!0}).map(B=>[B.placement,B.overflows.filter(ne=>ne>0).reduce((ne,V)=>ne+V,0)]).sort((B,ne)=>B[1]-ne[1])[0])==null?void 0:H[0];W&&(U=W);break}case"initialPlacement":U=o;break}if(s!==U)return{reset:{placement:U}}}return{}}}};function Q$(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function ez(e){return hwe.some(t=>e[t]>=0)}const Cwe=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:n}=t,{strategy:r="referenceHidden",...s}=af(e,t);switch(r){case"referenceHidden":{const i=await fw(t,{...s,elementContext:"reference"}),a=Q$(i,n.reference);return{data:{referenceHiddenOffsets:a,referenceHidden:ez(a)}}}case"escaped":{const i=await fw(t,{...s,altBoundary:!0}),a=Q$(i,n.floating);return{data:{escapedOffsets:a,escaped:ez(a)}}}default:return{}}}}};async function kwe(e,t){const{placement:n,platform:r,elements:s}=e,i=await(r.isRTL==null?void 0:r.isRTL(s.floating)),a=of(n),o=rb(n),l=Lh(n)==="y",c=["left","top"].includes(a)?-1:1,u=i&&l?-1:1,d=af(t,e);let{mainAxis:h,crossAxis:m,alignmentAxis:y}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:d.mainAxis||0,crossAxis:d.crossAxis||0,alignmentAxis:d.alignmentAxis};return o&&typeof y=="number"&&(m=o==="end"?y*-1:y),l?{x:m*u,y:h*c}:{x:h*c,y:m*u}}const Ewe=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var n,r;const{x:s,y:i,placement:a,middlewareData:o}=t,l=await kwe(t,e);return a===((n=o.offset)==null?void 0:n.placement)&&(r=o.arrow)!=null&&r.alignmentOffset?{}:{x:s+l.x,y:i+l.y,data:{...l,placement:a}}}}},Twe=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:n,y:r,placement:s}=t,{mainAxis:i=!0,crossAxis:a=!1,limiter:o={fn:v=>{let{x,y:w}=v;return{x,y:w}}},...l}=af(e,t),c={x:n,y:r},u=await fw(t,l),d=Lh(of(s)),h=yO(d);let m=c[h],y=c[d];if(i){const v=h==="y"?"top":"left",x=h==="y"?"bottom":"right",w=m+u[v],_=m-u[x];m=I3(w,m,_)}if(a){const v=d==="y"?"top":"left",x=d==="y"?"bottom":"right",w=y+u[v],_=y-u[x];y=I3(w,y,_)}const b=o.fn({...t,[h]:m,[d]:y});return{...b,data:{x:b.x-n,y:b.y-r,enabled:{[h]:i,[d]:a}}}}}},Awe=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:n,y:r,placement:s,rects:i,middlewareData:a}=t,{offset:o=0,mainAxis:l=!0,crossAxis:c=!0}=af(e,t),u={x:n,y:r},d=Lh(s),h=yO(d);let m=u[h],y=u[d];const b=af(o,t),v=typeof b=="number"?{mainAxis:b,crossAxis:0}:{mainAxis:0,crossAxis:0,...b};if(l){const _=h==="y"?"height":"width",k=i.reference[h]-i.floating[_]+v.mainAxis,C=i.reference[h]+i.reference[_]-v.mainAxis;m<k?m=k:m>C&&(m=C)}if(c){var x,w;const _=h==="y"?"width":"height",k=["top","left"].includes(of(s)),C=i.reference[d]-i.floating[_]+(k&&((x=a.offset)==null?void 0:x[d])||0)+(k?0:v.crossAxis),T=i.reference[d]+i.reference[_]+(k?0:((w=a.offset)==null?void 0:w[d])||0)-(k?v.crossAxis:0);y<C?y=C:y>T&&(y=T)}return{[h]:m,[d]:y}}}},Rwe=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){var n,r;const{placement:s,rects:i,platform:a,elements:o}=t,{apply:l=()=>{},...c}=af(e,t),u=await fw(t,c),d=of(s),h=rb(s),m=Lh(s)==="y",{width:y,height:b}=i.floating;let v,x;d==="top"||d==="bottom"?(v=d,x=h===(await(a.isRTL==null?void 0:a.isRTL(o.floating))?"start":"end")?"left":"right"):(x=d,v=h==="end"?"top":"bottom");const w=b-u.top-u.bottom,_=y-u.left-u.right,k=Fh(b-u[v],w),C=Fh(y-u[x],_),T=!t.middlewareData.shift;let A=k,N=C;if((n=t.middlewareData.shift)!=null&&n.enabled.x&&(N=_),(r=t.middlewareData.shift)!=null&&r.enabled.y&&(A=w),T&&!h){const j=ml(u.left,0),L=ml(u.right,0),D=ml(u.top,0),H=ml(u.bottom,0);m?N=y-2*(j!==0||L!==0?j+L:ml(u.left,u.right)):A=b-2*(D!==0||H!==0?D+H:ml(u.top,u.bottom))}await l({...t,availableWidth:N,availableHeight:A});const I=await a.getDimensions(o.floating);return y!==I.width||b!==I.height?{reset:{rects:!0}}:{}}}};function UE(){return typeof window<"u"}function sb(e){return uK(e)?(e.nodeName||"").toLowerCase():"#document"}function vl(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function Zu(e){var t;return(t=(uK(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function uK(e){return UE()?e instanceof Node||e instanceof vl(e).Node:!1}function Wc(e){return UE()?e instanceof Element||e instanceof vl(e).Element:!1}function Vu(e){return UE()?e instanceof HTMLElement||e instanceof vl(e).HTMLElement:!1}function tz(e){return!UE()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof vl(e).ShadowRoot}function R1(e){const{overflow:t,overflowX:n,overflowY:r,display:s}=Hc(e);return/auto|scroll|overlay|hidden|clip/.test(t+r+n)&&!["inline","contents"].includes(s)}function Nwe(e){return["table","td","th"].includes(sb(e))}function qE(e){return[":popover-open",":modal"].some(t=>{try{return e.matches(t)}catch{return!1}})}function xO(e){const t=wO(),n=Wc(e)?Hc(e):e;return["transform","translate","scale","rotate","perspective"].some(r=>n[r]?n[r]!=="none":!1)||(n.containerType?n.containerType!=="normal":!1)||!t&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!t&&(n.filter?n.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(r=>(n.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(n.contain||"").includes(r))}function Iwe(e){let t=Bh(e);for(;Vu(t)&&!yy(t);){if(xO(t))return t;if(qE(t))return null;t=Bh(t)}return null}function wO(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function yy(e){return["html","body","#document"].includes(sb(e))}function Hc(e){return vl(e).getComputedStyle(e)}function VE(e){return Wc(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function Bh(e){if(sb(e)==="html")return e;const t=e.assignedSlot||e.parentNode||tz(e)&&e.host||Zu(e);return tz(t)?t.host:t}function dK(e){const t=Bh(e);return yy(t)?e.ownerDocument?e.ownerDocument.body:e.body:Vu(t)&&R1(t)?t:dK(t)}function hw(e,t,n){var r;t===void 0&&(t=[]),n===void 0&&(n=!0);const s=dK(e),i=s===((r=e.ownerDocument)==null?void 0:r.body),a=vl(s);if(i){const o=j3(a);return t.concat(a,a.visualViewport||[],R1(s)?s:[],o&&n?hw(o):[])}return t.concat(s,hw(s,[],n))}function j3(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function fK(e){const t=Hc(e);let n=parseFloat(t.width)||0,r=parseFloat(t.height)||0;const s=Vu(e),i=s?e.offsetWidth:n,a=s?e.offsetHeight:r,o=Z2(n)!==i||Z2(r)!==a;return o&&(n=i,r=a),{width:n,height:r,$:o}}function SO(e){return Wc(e)?e:e.contextElement}function q0(e){const t=SO(e);if(!Vu(t))return Ou(1);const n=t.getBoundingClientRect(),{width:r,height:s,$:i}=fK(t);let a=(i?Z2(n.width):n.width)/r,o=(i?Z2(n.height):n.height)/s;return(!a||!Number.isFinite(a))&&(a=1),(!o||!Number.isFinite(o))&&(o=1),{x:a,y:o}}const Mwe=Ou(0);function hK(e){const t=vl(e);return!wO()||!t.visualViewport?Mwe:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function jwe(e,t,n){return t===void 0&&(t=!1),!n||t&&n!==vl(e)?!1:t}function Om(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=!1);const s=e.getBoundingClientRect(),i=SO(e);let a=Ou(1);t&&(r?Wc(r)&&(a=q0(r)):a=q0(e));const o=jwe(i,n,r)?hK(i):Ou(0);let l=(s.left+o.x)/a.x,c=(s.top+o.y)/a.y,u=s.width/a.x,d=s.height/a.y;if(i){const h=vl(i),m=r&&Wc(r)?vl(r):r;let y=h,b=j3(y);for(;b&&r&&m!==y;){const v=q0(b),x=b.getBoundingClientRect(),w=Hc(b),_=x.left+(b.clientLeft+parseFloat(w.paddingLeft))*v.x,k=x.top+(b.clientTop+parseFloat(w.paddingTop))*v.y;l*=v.x,c*=v.y,u*=v.x,d*=v.y,l+=_,c+=k,y=vl(b),b=j3(y)}}return J2({width:u,height:d,x:l,y:c})}function _O(e,t){const n=VE(e).scrollLeft;return t?t.left+n:Om(Zu(e)).left+n}function pK(e,t,n){n===void 0&&(n=!1);const r=e.getBoundingClientRect(),s=r.left+t.scrollLeft-(n?0:_O(e,r)),i=r.top+t.scrollTop;return{x:s,y:i}}function Pwe(e){let{elements:t,rect:n,offsetParent:r,strategy:s}=e;const i=s==="fixed",a=Zu(r),o=t?qE(t.floating):!1;if(r===a||o&&i)return n;let l={scrollLeft:0,scrollTop:0},c=Ou(1);const u=Ou(0),d=Vu(r);if((d||!d&&!i)&&((sb(r)!=="body"||R1(a))&&(l=VE(r)),Vu(r))){const m=Om(r);c=q0(r),u.x=m.x+r.clientLeft,u.y=m.y+r.clientTop}const h=a&&!d&&!i?pK(a,l,!0):Ou(0);return{width:n.width*c.x,height:n.height*c.y,x:n.x*c.x-l.scrollLeft*c.x+u.x+h.x,y:n.y*c.y-l.scrollTop*c.y+u.y+h.y}}function Owe(e){return Array.from(e.getClientRects())}function Dwe(e){const t=Zu(e),n=VE(e),r=e.ownerDocument.body,s=ml(t.scrollWidth,t.clientWidth,r.scrollWidth,r.clientWidth),i=ml(t.scrollHeight,t.clientHeight,r.scrollHeight,r.clientHeight);let a=-n.scrollLeft+_O(e);const o=-n.scrollTop;return Hc(r).direction==="rtl"&&(a+=ml(t.clientWidth,r.clientWidth)-s),{width:s,height:i,x:a,y:o}}function Fwe(e,t){const n=vl(e),r=Zu(e),s=n.visualViewport;let i=r.clientWidth,a=r.clientHeight,o=0,l=0;if(s){i=s.width,a=s.height;const c=wO();(!c||c&&t==="fixed")&&(o=s.offsetLeft,l=s.offsetTop)}return{width:i,height:a,x:o,y:l}}function Lwe(e,t){const n=Om(e,!0,t==="fixed"),r=n.top+e.clientTop,s=n.left+e.clientLeft,i=Vu(e)?q0(e):Ou(1),a=e.clientWidth*i.x,o=e.clientHeight*i.y,l=s*i.x,c=r*i.y;return{width:a,height:o,x:l,y:c}}function nz(e,t,n){let r;if(t==="viewport")r=Fwe(e,n);else if(t==="document")r=Dwe(Zu(e));else if(Wc(t))r=Lwe(t,n);else{const s=hK(e);r={x:t.x-s.x,y:t.y-s.y,width:t.width,height:t.height}}return J2(r)}function mK(e,t){const n=Bh(e);return n===t||!Wc(n)||yy(n)?!1:Hc(n).position==="fixed"||mK(n,t)}function Bwe(e,t){const n=t.get(e);if(n)return n;let r=hw(e,[],!1).filter(o=>Wc(o)&&sb(o)!=="body"),s=null;const i=Hc(e).position==="fixed";let a=i?Bh(e):e;for(;Wc(a)&&!yy(a);){const o=Hc(a),l=xO(a);!l&&o.position==="fixed"&&(s=null),(i?!l&&!s:!l&&o.position==="static"&&!!s&&["absolute","fixed"].includes(s.position)||R1(a)&&!l&&mK(e,a))?r=r.filter(u=>u!==a):s=o,a=Bh(a)}return t.set(e,r),r}function $we(e){let{element:t,boundary:n,rootBoundary:r,strategy:s}=e;const a=[...n==="clippingAncestors"?qE(t)?[]:Bwe(t,this._c):[].concat(n),r],o=a[0],l=a.reduce((c,u)=>{const d=nz(t,u,s);return c.top=ml(d.top,c.top),c.right=Fh(d.right,c.right),c.bottom=Fh(d.bottom,c.bottom),c.left=ml(d.left,c.left),c},nz(t,o,s));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function zwe(e){const{width:t,height:n}=fK(e);return{width:t,height:n}}function Uwe(e,t,n){const r=Vu(t),s=Zu(t),i=n==="fixed",a=Om(e,!0,i,t);let o={scrollLeft:0,scrollTop:0};const l=Ou(0);if(r||!r&&!i)if((sb(t)!=="body"||R1(s))&&(o=VE(t)),r){const h=Om(t,!0,i,t);l.x=h.x+t.clientLeft,l.y=h.y+t.clientTop}else s&&(l.x=_O(s));const c=s&&!r&&!i?pK(s,o):Ou(0),u=a.left+o.scrollLeft-l.x-c.x,d=a.top+o.scrollTop-l.y-c.y;return{x:u,y:d,width:a.width,height:a.height}}function lI(e){return Hc(e).position==="static"}function rz(e,t){if(!Vu(e)||Hc(e).position==="fixed")return null;if(t)return t(e);let n=e.offsetParent;return Zu(e)===n&&(n=n.ownerDocument.body),n}function gK(e,t){const n=vl(e);if(qE(e))return n;if(!Vu(e)){let s=Bh(e);for(;s&&!yy(s);){if(Wc(s)&&!lI(s))return s;s=Bh(s)}return n}let r=rz(e,t);for(;r&&Nwe(r)&&lI(r);)r=rz(r,t);return r&&yy(r)&&lI(r)&&!xO(r)?n:r||Iwe(e)||n}const qwe=async function(e){const t=this.getOffsetParent||gK,n=this.getDimensions,r=await n(e.floating);return{reference:Uwe(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function Vwe(e){return Hc(e).direction==="rtl"}const Wwe={convertOffsetParentRelativeRectToViewportRelativeRect:Pwe,getDocumentElement:Zu,getClippingRect:$we,getOffsetParent:gK,getElementRects:qwe,getClientRects:Owe,getDimensions:zwe,getScale:q0,isElement:Wc,isRTL:Vwe};function yK(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function Hwe(e,t){let n=null,r;const s=Zu(e);function i(){var o;clearTimeout(r),(o=n)==null||o.disconnect(),n=null}function a(o,l){o===void 0&&(o=!1),l===void 0&&(l=1),i();const c=e.getBoundingClientRect(),{left:u,top:d,width:h,height:m}=c;if(o||t(),!h||!m)return;const y=W_(d),b=W_(s.clientWidth-(u+h)),v=W_(s.clientHeight-(d+m)),x=W_(u),_={rootMargin:-y+"px "+-b+"px "+-v+"px "+-x+"px",threshold:ml(0,Fh(1,l))||1};let k=!0;function C(T){const A=T[0].intersectionRatio;if(A!==l){if(!k)return a();A?a(!1,A):r=setTimeout(()=>{a(!1,1e-7)},1e3)}A===1&&!yK(c,e.getBoundingClientRect())&&a(),k=!1}try{n=new IntersectionObserver(C,{..._,root:s.ownerDocument})}catch{n=new IntersectionObserver(C,_)}n.observe(e)}return a(!0),i}function CO(e,t,n,r){r===void 0&&(r={});const{ancestorScroll:s=!0,ancestorResize:i=!0,elementResize:a=typeof ResizeObserver=="function",layoutShift:o=typeof IntersectionObserver=="function",animationFrame:l=!1}=r,c=SO(e),u=s||i?[...c?hw(c):[],...hw(t)]:[];u.forEach(x=>{s&&x.addEventListener("scroll",n,{passive:!0}),i&&x.addEventListener("resize",n)});const d=c&&o?Hwe(c,n):null;let h=-1,m=null;a&&(m=new ResizeObserver(x=>{let[w]=x;w&&w.target===c&&m&&(m.unobserve(t),cancelAnimationFrame(h),h=requestAnimationFrame(()=>{var _;(_=m)==null||_.observe(t)})),n()}),c&&!l&&m.observe(c),m.observe(t));let y,b=l?Om(e):null;l&&v();function v(){const x=Om(e);b&&!yK(b,x)&&n(),b=x,y=requestAnimationFrame(v)}return n(),()=>{var x;u.forEach(w=>{s&&w.removeEventListener("scroll",n),i&&w.removeEventListener("resize",n)}),d==null||d(),(x=m)==null||x.disconnect(),m=null,l&&cancelAnimationFrame(y)}}const Gwe=Ewe,Kwe=Twe,Ywe=_we,Zwe=Rwe,Xwe=Cwe,sz=Swe,Jwe=Awe,Qwe=(e,t,n)=>{const r=new Map,s={platform:Wwe,...n},i={...s.platform,_c:r};return wwe(e,t,{...s,platform:i})};var WC=typeof document<"u"?E.useLayoutEffect:E.useEffect;function Q2(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let n,r,s;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(n=e.length,n!==t.length)return!1;for(r=n;r--!==0;)if(!Q2(e[r],t[r]))return!1;return!0}if(s=Object.keys(e),n=s.length,n!==Object.keys(t).length)return!1;for(r=n;r--!==0;)if(!{}.hasOwnProperty.call(t,s[r]))return!1;for(r=n;r--!==0;){const i=s[r];if(!(i==="_owner"&&e.$$typeof)&&!Q2(e[i],t[i]))return!1}return!0}return e!==e&&t!==t}function bK(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function iz(e,t){const n=bK(e);return Math.round(t*n)/n}function cI(e){const t=E.useRef(e);return WC(()=>{t.current=e}),t}function kO(e){e===void 0&&(e={});const{placement:t="bottom",strategy:n="absolute",middleware:r=[],platform:s,elements:{reference:i,floating:a}={},transform:o=!0,whileElementsMounted:l,open:c}=e,[u,d]=E.useState({x:0,y:0,strategy:n,placement:t,middlewareData:{},isPositioned:!1}),[h,m]=E.useState(r);Q2(h,r)||m(r);const[y,b]=E.useState(null),[v,x]=E.useState(null),w=E.useCallback(B=>{B!==T.current&&(T.current=B,b(B))},[]),_=E.useCallback(B=>{B!==A.current&&(A.current=B,x(B))},[]),k=i||y,C=a||v,T=E.useRef(null),A=E.useRef(null),N=E.useRef(u),I=l!=null,j=cI(l),L=cI(s),D=cI(c),H=E.useCallback(()=>{if(!T.current||!A.current)return;const B={placement:t,strategy:n,middleware:h};L.current&&(B.platform=L.current),Qwe(T.current,A.current,B).then(ne=>{const V={...ne,isPositioned:D.current!==!1};O.current&&!Q2(N.current,V)&&(N.current=V,yl.flushSync(()=>{d(V)}))})},[h,t,n,L,D]);WC(()=>{c===!1&&N.current.isPositioned&&(N.current.isPositioned=!1,d(B=>({...B,isPositioned:!1})))},[c]);const O=E.useRef(!1);WC(()=>(O.current=!0,()=>{O.current=!1}),[]),WC(()=>{if(k&&(T.current=k),C&&(A.current=C),k&&C){if(j.current)return j.current(k,C,H);H()}},[k,C,H,j,I]);const K=E.useMemo(()=>({reference:T,floating:A,setReference:w,setFloating:_}),[w,_]),U=E.useMemo(()=>({reference:k,floating:C}),[k,C]),W=E.useMemo(()=>{const B={position:n,left:0,top:0};if(!U.floating)return B;const ne=iz(U.floating,u.x),V=iz(U.floating,u.y);return o?{...B,transform:"translate("+ne+"px, "+V+"px)",...bK(U.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:ne,top:V}},[n,o,U.floating,u.x,u.y]);return E.useMemo(()=>({...u,update:H,refs:K,elements:U,floatingStyles:W}),[u,H,K,U,W])}const e1e=e=>{function t(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:e,fn(n){const{element:r,padding:s}=typeof e=="function"?e(n):e;return r&&t(r)?r.current!=null?sz({element:r.current,padding:s}).fn(n):{}:r?sz({element:r,padding:s}).fn(n):{}}}},EO=(e,t)=>({...Gwe(e),options:[e,t]}),TO=(e,t)=>({...Kwe(e),options:[e,t]}),AO=(e,t)=>({...Jwe(e),options:[e,t]}),RO=(e,t)=>({...Ywe(e),options:[e,t]}),NO=(e,t)=>({...Zwe(e),options:[e,t]}),IO=(e,t)=>({...Xwe(e),options:[e,t]}),MO=(e,t)=>({...e1e(e),options:[e,t]});var t1e="Arrow",vK=E.forwardRef((e,t)=>{const{children:n,width:r=10,height:s=5,...i}=e;return f.jsx(Kn.svg,{...i,ref:t,width:r,height:s,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?n:f.jsx("polygon",{points:"0,0 30,0 15,10"})})});vK.displayName=t1e;var n1e=vK;function Zm(e){const[t,n]=E.useState(void 0);return ii(()=>{if(e){n({width:e.offsetWidth,height:e.offsetHeight});const r=new ResizeObserver(s=>{if(!Array.isArray(s)||!s.length)return;const i=s[0];let a,o;if("borderBoxSize"in i){const l=i.borderBoxSize,c=Array.isArray(l)?l[0]:l;a=c.inlineSize,o=c.blockSize}else a=e.offsetWidth,o=e.offsetHeight;n({width:a,height:o})});return r.observe(e,{box:"border-box"}),()=>r.unobserve(e)}else n(void 0)},[e]),t}var jO="Popper",[xK,WE]=Ei(jO),[r1e,wK]=xK(jO),SK=e=>{const{__scopePopper:t,children:n}=e,[r,s]=E.useState(null);return f.jsx(r1e,{scope:t,anchor:r,onAnchorChange:s,children:n})};SK.displayName=jO;var _K="PopperAnchor",CK=E.forwardRef((e,t)=>{const{__scopePopper:n,virtualRef:r,...s}=e,i=wK(_K,n),a=E.useRef(null),o=Tn(t,a);return E.useEffect(()=>{i.onAnchorChange((r==null?void 0:r.current)||a.current)}),r?null:f.jsx(Kn.div,{...s,ref:o})});CK.displayName=_K;var PO="PopperContent",[s1e,i1e]=xK(PO),kK=E.forwardRef((e,t)=>{var je,Te,_e,Ue,Qe,We;const{__scopePopper:n,side:r="bottom",sideOffset:s=0,align:i="center",alignOffset:a=0,arrowPadding:o=0,avoidCollisions:l=!0,collisionBoundary:c=[],collisionPadding:u=0,sticky:d="partial",hideWhenDetached:h=!1,updatePositionStrategy:m="optimized",onPlaced:y,...b}=e,v=wK(PO,n),[x,w]=E.useState(null),_=Tn(t,Pe=>w(Pe)),[k,C]=E.useState(null),T=Zm(k),A=(T==null?void 0:T.width)??0,N=(T==null?void 0:T.height)??0,I=r+(i!=="center"?"-"+i:""),j=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},L=Array.isArray(c)?c:[c],D=L.length>0,H={padding:j,boundary:L.filter(o1e),altBoundary:D},{refs:O,floatingStyles:K,placement:U,isPositioned:W,middlewareData:B}=kO({strategy:"fixed",placement:I,whileElementsMounted:(...Pe)=>CO(...Pe,{animationFrame:m==="always"}),elements:{reference:v.anchor},middleware:[EO({mainAxis:s+N,alignmentAxis:a}),l&&TO({mainAxis:!0,crossAxis:!1,limiter:d==="partial"?AO():void 0,...H}),l&&RO({...H}),NO({...H,apply:({elements:Pe,rects:Y,availableWidth:ye,availableHeight:Me})=>{const{width:ue,height:oe}=Y.reference,se=Pe.floating.style;se.setProperty("--radix-popper-available-width",`${ye}px`),se.setProperty("--radix-popper-available-height",`${Me}px`),se.setProperty("--radix-popper-anchor-width",`${ue}px`),se.setProperty("--radix-popper-anchor-height",`${oe}px`)}}),k&&MO({element:k,padding:o}),l1e({arrowWidth:A,arrowHeight:N}),h&&IO({strategy:"referenceHidden",...H})]}),[ne,V]=AK(U),Q=Ts(y);ii(()=>{W&&(Q==null||Q())},[W,Q]);const ee=(je=B.arrow)==null?void 0:je.x,re=(Te=B.arrow)==null?void 0:Te.y,de=((_e=B.arrow)==null?void 0:_e.centerOffset)!==0,[me,De]=E.useState();return ii(()=>{x&&De(window.getComputedStyle(x).zIndex)},[x]),f.jsx("div",{ref:O.setFloating,"data-radix-popper-content-wrapper":"",style:{...K,transform:W?K.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:me,"--radix-popper-transform-origin":[(Ue=B.transformOrigin)==null?void 0:Ue.x,(Qe=B.transformOrigin)==null?void 0:Qe.y].join(" "),...((We=B.hide)==null?void 0:We.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:f.jsx(s1e,{scope:n,placedSide:ne,onArrowChange:C,arrowX:ee,arrowY:re,shouldHideArrow:de,children:f.jsx(Kn.div,{"data-side":ne,"data-align":V,...b,ref:_,style:{...b.style,animation:W?void 0:"none"}})})})});kK.displayName=PO;var EK="PopperArrow",a1e={top:"bottom",right:"left",bottom:"top",left:"right"},TK=E.forwardRef(function(t,n){const{__scopePopper:r,...s}=t,i=i1e(EK,r),a=a1e[i.placedSide];return f.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[a]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:f.jsx(n1e,{...s,ref:n,style:{...s.style,display:"block"}})})});TK.displayName=EK;function o1e(e){return e!==null}var l1e=e=>({name:"transformOrigin",options:e,fn(t){var v,x,w;const{placement:n,rects:r,middlewareData:s}=t,a=((v=s.arrow)==null?void 0:v.centerOffset)!==0,o=a?0:e.arrowWidth,l=a?0:e.arrowHeight,[c,u]=AK(n),d={start:"0%",center:"50%",end:"100%"}[u],h=(((x=s.arrow)==null?void 0:x.x)??0)+o/2,m=(((w=s.arrow)==null?void 0:w.y)??0)+l/2;let y="",b="";return c==="bottom"?(y=a?d:`${h}px`,b=`${-l}px`):c==="top"?(y=a?d:`${h}px`,b=`${r.floating.height+l}px`):c==="right"?(y=`${-l}px`,b=a?d:`${m}px`):c==="left"&&(y=`${r.floating.width+l}px`,b=a?d:`${m}px`),{data:{x:y,y:b}}}});function AK(e){const[t,n="center"]=e.split("-");return[t,n]}var RK=SK,NK=CK,IK=kK,MK=TK,c1e="Portal",HE=E.forwardRef((e,t)=>{var o;const{container:n,...r}=e,[s,i]=E.useState(!1);ii(()=>i(!0),[]);const a=n||s&&((o=globalThis==null?void 0:globalThis.document)==null?void 0:o.body);return a?PE.createPortal(f.jsx(Kn.div,{...r,ref:t}),a):null});HE.displayName=c1e;function u1e(e,t){return E.useReducer((n,r)=>t[n][r]??n,e)}var ea=e=>{const{present:t,children:n}=e,r=d1e(t),s=typeof n=="function"?n({present:r.isPresent}):E.Children.only(n),i=Tn(r.ref,f1e(s));return typeof n=="function"||r.isPresent?E.cloneElement(s,{ref:i}):null};ea.displayName="Presence";function d1e(e){const[t,n]=E.useState(),r=E.useRef(null),s=E.useRef(e),i=E.useRef("none"),a=e?"mounted":"unmounted",[o,l]=u1e(a,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return E.useEffect(()=>{const c=H_(r.current);i.current=o==="mounted"?c:"none"},[o]),ii(()=>{const c=r.current,u=s.current;if(u!==e){const h=i.current,m=H_(c);e?l("MOUNT"):m==="none"||(c==null?void 0:c.display)==="none"?l("UNMOUNT"):l(u&&h!==m?"ANIMATION_OUT":"UNMOUNT"),s.current=e}},[e,l]),ii(()=>{if(t){let c;const u=t.ownerDocument.defaultView??window,d=m=>{const b=H_(r.current).includes(m.animationName);if(m.target===t&&b&&(l("ANIMATION_END"),!s.current)){const v=t.style.animationFillMode;t.style.animationFillMode="forwards",c=u.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=v)})}},h=m=>{m.target===t&&(i.current=H_(r.current))};return t.addEventListener("animationstart",h),t.addEventListener("animationcancel",d),t.addEventListener("animationend",d),()=>{u.clearTimeout(c),t.removeEventListener("animationstart",h),t.removeEventListener("animationcancel",d),t.removeEventListener("animationend",d)}}else l("ANIMATION_END")},[t,l]),{isPresent:["mounted","unmountSuspended"].includes(o),ref:E.useCallback(c=>{r.current=c?getComputedStyle(c):null,n(c)},[])}}function H_(e){return(e==null?void 0:e.animationName)||"none"}function f1e(e){var r,s;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(s=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:s.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var h1e=Symbol("radix.slottable");function p1e(e){const t=({children:n})=>f.jsx(f.Fragment,{children:n});return t.displayName=`${e}.Slottable`,t.__radixId=h1e,t}var m1e=vH[" useInsertionEffect ".trim().toString()]||ii;function rc({prop:e,defaultProp:t,onChange:n=()=>{},caller:r}){const[s,i,a]=g1e({defaultProp:t,onChange:n}),o=e!==void 0,l=o?e:s;{const u=E.useRef(e!==void 0);E.useEffect(()=>{const d=u.current;d!==o&&console.warn(`${r} is changing from ${d?"controlled":"uncontrolled"} to ${o?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),u.current=o},[o,r])}const c=E.useCallback(u=>{var d;if(o){const h=y1e(u)?u(e):u;h!==e&&((d=a.current)==null||d.call(a,h))}else i(u)},[o,e,i,a]);return[l,c]}function g1e({defaultProp:e,onChange:t}){const[n,r]=E.useState(e),s=E.useRef(n),i=E.useRef(t);return m1e(()=>{i.current=t},[t]),E.useEffect(()=>{var a;s.current!==n&&((a=i.current)==null||a.call(i,n),s.current=n)},[n,s]),[n,r,i]}function y1e(e){return typeof e=="function"}var b1e=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),v1e="VisuallyHidden",jK=E.forwardRef((e,t)=>f.jsx(Kn.span,{...e,ref:t,style:{...b1e,...e.style}}));jK.displayName=v1e;var x1e=jK,[GE,Cft]=Ei("Tooltip",[WE]),KE=WE(),PK="TooltipProvider",w1e=700,P3="tooltip.open",[S1e,OO]=GE(PK),OK=e=>{const{__scopeTooltip:t,delayDuration:n=w1e,skipDelayDuration:r=300,disableHoverableContent:s=!1,children:i}=e,a=E.useRef(!0),o=E.useRef(!1),l=E.useRef(0);return E.useEffect(()=>{const c=l.current;return()=>window.clearTimeout(c)},[]),f.jsx(S1e,{scope:t,isOpenDelayedRef:a,delayDuration:n,onOpen:E.useCallback(()=>{window.clearTimeout(l.current),a.current=!1},[]),onClose:E.useCallback(()=>{window.clearTimeout(l.current),l.current=window.setTimeout(()=>a.current=!0,r)},[r]),isPointerInTransitRef:o,onPointerInTransitChange:E.useCallback(c=>{o.current=c},[]),disableHoverableContent:s,children:i})};OK.displayName=PK;var pw="Tooltip",[_1e,N1]=GE(pw),DK=e=>{const{__scopeTooltip:t,children:n,open:r,defaultOpen:s,onOpenChange:i,disableHoverableContent:a,delayDuration:o}=e,l=OO(pw,e.__scopeTooltip),c=KE(t),[u,d]=E.useState(null),h=pa(),m=E.useRef(0),y=a??l.disableHoverableContent,b=o??l.delayDuration,v=E.useRef(!1),[x,w]=rc({prop:r,defaultProp:s??!1,onChange:A=>{A?(l.onOpen(),document.dispatchEvent(new CustomEvent(P3))):l.onClose(),i==null||i(A)},caller:pw}),_=E.useMemo(()=>x?v.current?"delayed-open":"instant-open":"closed",[x]),k=E.useCallback(()=>{window.clearTimeout(m.current),m.current=0,v.current=!1,w(!0)},[w]),C=E.useCallback(()=>{window.clearTimeout(m.current),m.current=0,w(!1)},[w]),T=E.useCallback(()=>{window.clearTimeout(m.current),m.current=window.setTimeout(()=>{v.current=!0,w(!0),m.current=0},b)},[b,w]);return E.useEffect(()=>()=>{m.current&&(window.clearTimeout(m.current),m.current=0)},[]),f.jsx(RK,{...c,children:f.jsx(_1e,{scope:t,contentId:h,open:x,stateAttribute:_,trigger:u,onTriggerChange:d,onTriggerEnter:E.useCallback(()=>{l.isOpenDelayedRef.current?T():k()},[l.isOpenDelayedRef,T,k]),onTriggerLeave:E.useCallback(()=>{y?C():(window.clearTimeout(m.current),m.current=0)},[C,y]),onOpen:k,onClose:C,disableHoverableContent:y,children:n})})};DK.displayName=pw;var O3="TooltipTrigger",FK=E.forwardRef((e,t)=>{const{__scopeTooltip:n,...r}=e,s=N1(O3,n),i=OO(O3,n),a=KE(n),o=E.useRef(null),l=Tn(t,o,s.onTriggerChange),c=E.useRef(!1),u=E.useRef(!1),d=E.useCallback(()=>c.current=!1,[]);return E.useEffect(()=>()=>document.removeEventListener("pointerup",d),[d]),f.jsx(NK,{asChild:!0,...a,children:f.jsx(Kn.button,{"aria-describedby":s.open?s.contentId:void 0,"data-state":s.stateAttribute,...r,ref:l,onPointerMove:Wt(e.onPointerMove,h=>{h.pointerType!=="touch"&&!u.current&&!i.isPointerInTransitRef.current&&(s.onTriggerEnter(),u.current=!0)}),onPointerLeave:Wt(e.onPointerLeave,()=>{s.onTriggerLeave(),u.current=!1}),onPointerDown:Wt(e.onPointerDown,()=>{s.open&&s.onClose(),c.current=!0,document.addEventListener("pointerup",d,{once:!0})}),onFocus:Wt(e.onFocus,()=>{c.current||s.onOpen()}),onBlur:Wt(e.onBlur,s.onClose),onClick:Wt(e.onClick,s.onClose)})})});FK.displayName=O3;var DO="TooltipPortal",[C1e,k1e]=GE(DO,{forceMount:void 0}),LK=e=>{const{__scopeTooltip:t,forceMount:n,children:r,container:s}=e,i=N1(DO,t);return f.jsx(C1e,{scope:t,forceMount:n,children:f.jsx(ea,{present:n||i.open,children:f.jsx(HE,{asChild:!0,container:s,children:r})})})};LK.displayName=DO;var by="TooltipContent",BK=E.forwardRef((e,t)=>{const n=k1e(by,e.__scopeTooltip),{forceMount:r=n.forceMount,side:s="top",...i}=e,a=N1(by,e.__scopeTooltip);return f.jsx(ea,{present:r||a.open,children:a.disableHoverableContent?f.jsx($K,{side:s,...i,ref:t}):f.jsx(E1e,{side:s,...i,ref:t})})}),E1e=E.forwardRef((e,t)=>{const n=N1(by,e.__scopeTooltip),r=OO(by,e.__scopeTooltip),s=E.useRef(null),i=Tn(t,s),[a,o]=E.useState(null),{trigger:l,onClose:c}=n,u=s.current,{onPointerInTransitChange:d}=r,h=E.useCallback(()=>{o(null),d(!1)},[d]),m=E.useCallback((y,b)=>{const v=y.currentTarget,x={x:y.clientX,y:y.clientY},w=N1e(x,v.getBoundingClientRect()),_=I1e(x,w),k=M1e(b.getBoundingClientRect()),C=P1e([..._,...k]);o(C),d(!0)},[d]);return E.useEffect(()=>()=>h(),[h]),E.useEffect(()=>{if(l&&u){const y=v=>m(v,u),b=v=>m(v,l);return l.addEventListener("pointerleave",y),u.addEventListener("pointerleave",b),()=>{l.removeEventListener("pointerleave",y),u.removeEventListener("pointerleave",b)}}},[l,u,m,h]),E.useEffect(()=>{if(a){const y=b=>{const v=b.target,x={x:b.clientX,y:b.clientY},w=(l==null?void 0:l.contains(v))||(u==null?void 0:u.contains(v)),_=!j1e(x,a);w?h():_&&(h(),c())};return document.addEventListener("pointermove",y),()=>document.removeEventListener("pointermove",y)}},[l,u,a,c,h]),f.jsx($K,{...e,ref:i})}),[T1e,A1e]=GE(pw,{isInside:!1}),R1e=p1e("TooltipContent"),$K=E.forwardRef((e,t)=>{const{__scopeTooltip:n,children:r,"aria-label":s,onEscapeKeyDown:i,onPointerDownOutside:a,...o}=e,l=N1(by,n),c=KE(n),{onClose:u}=l;return E.useEffect(()=>(document.addEventListener(P3,u),()=>document.removeEventListener(P3,u)),[u]),E.useEffect(()=>{if(l.trigger){const d=h=>{const m=h.target;m!=null&&m.contains(l.trigger)&&u()};return window.addEventListener("scroll",d,{capture:!0}),()=>window.removeEventListener("scroll",d,{capture:!0})}},[l.trigger,u]),f.jsx(zE,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:i,onPointerDownOutside:a,onFocusOutside:d=>d.preventDefault(),onDismiss:u,children:f.jsxs(IK,{"data-state":l.stateAttribute,...c,...o,ref:t,style:{...o.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[f.jsx(R1e,{children:r}),f.jsx(T1e,{scope:n,isInside:!0,children:f.jsx(x1e,{id:l.contentId,role:"tooltip",children:s||r})})]})})});BK.displayName=by;var zK="TooltipArrow",UK=E.forwardRef((e,t)=>{const{__scopeTooltip:n,...r}=e,s=KE(n);return A1e(zK,n).isInside?null:f.jsx(MK,{...s,...r,ref:t})});UK.displayName=zK;function N1e(e,t){const n=Math.abs(t.top-e.y),r=Math.abs(t.bottom-e.y),s=Math.abs(t.right-e.x),i=Math.abs(t.left-e.x);switch(Math.min(n,r,s,i)){case i:return"left";case s:return"right";case n:return"top";case r:return"bottom";default:throw new Error("unreachable")}}function I1e(e,t,n=5){const r=[];switch(t){case"top":r.push({x:e.x-n,y:e.y+n},{x:e.x+n,y:e.y+n});break;case"bottom":r.push({x:e.x-n,y:e.y-n},{x:e.x+n,y:e.y-n});break;case"left":r.push({x:e.x+n,y:e.y-n},{x:e.x+n,y:e.y+n});break;case"right":r.push({x:e.x-n,y:e.y-n},{x:e.x-n,y:e.y+n});break}return r}function M1e(e){const{top:t,right:n,bottom:r,left:s}=e;return[{x:s,y:t},{x:n,y:t},{x:n,y:r},{x:s,y:r}]}function j1e(e,t){const{x:n,y:r}=e;let s=!1;for(let i=0,a=t.length-1;i<t.length;a=i++){const o=t[i],l=t[a],c=o.x,u=o.y,d=l.x,h=l.y;u>r!=h>r&&n<(d-c)*(r-u)/(h-u)+c&&(s=!s)}return s}function P1e(e){const t=e.slice();return t.sort((n,r)=>n.x<r.x?-1:n.x>r.x?1:n.y<r.y?-1:n.y>r.y?1:0),O1e(t)}function O1e(e){if(e.length<=1)return e.slice();const t=[];for(let r=0;r<e.length;r++){const s=e[r];for(;t.length>=2;){const i=t[t.length-1],a=t[t.length-2];if((i.x-a.x)*(s.y-a.y)>=(i.y-a.y)*(s.x-a.x))t.pop();else break}t.push(s)}t.pop();const n=[];for(let r=e.length-1;r>=0;r--){const s=e[r];for(;n.length>=2;){const i=n[n.length-1],a=n[n.length-2];if((i.x-a.x)*(s.y-a.y)>=(i.y-a.y)*(s.x-a.x))n.pop();else break}n.push(s)}return n.pop(),t.length===1&&n.length===1&&t[0].x===n[0].x&&t[0].y===n[0].y?t:t.concat(n)}var D1e=OK,F1e=DK,L1e=FK,B1e=LK,$1e=BK,z1e=UK;function wr({delayDuration:e=0,...t}){return f.jsx(D1e,{"data-slot":"tooltip-provider",delayDuration:e,...t})}function Sr({...e}){return f.jsx(wr,{children:f.jsx(F1e,{"data-slot":"tooltip",...e})})}function _r({...e}){return f.jsx(L1e,{"data-slot":"tooltip-trigger",...e})}function Cr({className:e,sideOffset:t=0,children:n,...r}){return f.jsx(B1e,{children:f.jsxs($1e,{"data-slot":"tooltip-content",sideOffset:t,className:Ye("bg-primary text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-fit origin-(--radix-tooltip-content-transform-origin) rounded-md px-3 py-1.5 text-xs text-balance",e),...r,children:[n,f.jsx(z1e,{className:"bg-primary fill-primary z-50 size-2.5 translate-y-[calc(-50%_-_2px)] rotate-45 rounded-[2px]"})]})})}class U1e{static findRendererForLanguage(t,n){const r=Object.values(n);if(r.length===0)return null;const s=r.filter(o=>{var l;return(l=o.supportedLanguages)==null?void 0:l.includes(t||"")}),i=r.filter(o=>!o.supportedLanguages||o.supportedLanguages.length===0);return[...s,...i].sort((o,l)=>(l.priority||0)-(o.priority||0))[0]||null}static renderBlock(t){const n=Bi.getState().blockRenderers,r=this.findRendererForLanguage(t.lang,n);if(!r)return null;try{return r.renderer(t)}catch(s){return console.error(`[BlockRendererService] Error rendering block with renderer ${r.id}:`,s),null}}static getRegisteredRenderers(){return Bi.getState().blockRenderers}static hasRendererForLanguage(t){const n=Bi.getState().blockRenderers;return this.findRendererForLanguage(t,n)!==null}}const ib=({lang:e,code:t,filepath:n,isStreaming:r=!1,interactionId:s})=>{const i=Bi(mn(l=>l.blockRenderers)),a=E.useMemo(()=>Nr(),[]),o=E.useMemo(()=>{const l={lang:e,code:t,filepath:n,isStreaming:r,blockId:a,interactionId:s},c=U1e.findRendererForLanguage(e,i);if(!c){const u=e?`language-${e}`:"language-plaintext";return f.jsxs("div",{className:"code-block-container my-4 max-w-full",children:[f.jsx("div",{className:"code-block-header flex items-center justify-between px-3 py-2 border border-b-0 border-border bg-muted/50 rounded-t-lg",children:f.jsx("div",{className:"text-sm font-medium",children:e?e.toUpperCase():"CODE"})}),f.jsx("pre",{className:"overflow-x-auto w-full relative overflow-wrap-anywhere border border-border rounded-b-lg bg-muted/20",children:f.jsx("code",{className:`${u} block p-4 font-mono text-sm leading-relaxed`,children:t})})]})}try{return c.renderer(l)}catch(u){return console.error(`[UniversalBlockRenderer] Error rendering block with renderer ${c.id}:`,u),f.jsxs("div",{className:"code-block-container my-4 max-w-full",children:[f.jsx("div",{className:"code-block-header flex items-center justify-between px-3 py-2 border border-b-0 border-border bg-muted/50 rounded-t-lg",children:f.jsxs("div",{className:"text-sm font-medium text-destructive",children:[e?e.toUpperCase():"CODE"," (Render Error)"]})}),f.jsx("pre",{className:"overflow-x-auto w-full relative overflow-wrap-anywhere border border-border rounded-b-lg bg-muted/20",children:f.jsx("code",{className:"block p-4 font-mono text-sm leading-relaxed",children:t})})]})}},[e,t,n,r,a,i]);return f.jsx(f.Fragment,{children:o})};var vt;(function(e){e[e.EPERM=1]="EPERM",e[e.ENOENT=2]="ENOENT",e[e.EINTR=4]="EINTR",e[e.EIO=5]="EIO",e[e.ENXIO=6]="ENXIO",e[e.EBADF=9]="EBADF",e[e.EAGAIN=11]="EAGAIN",e[e.ENOMEM=12]="ENOMEM",e[e.EACCES=13]="EACCES",e[e.EFAULT=14]="EFAULT",e[e.ENOTBLK=15]="ENOTBLK",e[e.EBUSY=16]="EBUSY",e[e.EEXIST=17]="EEXIST",e[e.EXDEV=18]="EXDEV",e[e.ENODEV=19]="ENODEV",e[e.ENOTDIR=20]="ENOTDIR",e[e.EISDIR=21]="EISDIR",e[e.EINVAL=22]="EINVAL",e[e.ENFILE=23]="ENFILE",e[e.EMFILE=24]="EMFILE",e[e.ETXTBSY=26]="ETXTBSY",e[e.EFBIG=27]="EFBIG",e[e.ENOSPC=28]="ENOSPC",e[e.ESPIPE=29]="ESPIPE",e[e.EROFS=30]="EROFS",e[e.EMLINK=31]="EMLINK",e[e.EPIPE=32]="EPIPE",e[e.EDOM=33]="EDOM",e[e.ERANGE=34]="ERANGE",e[e.EDEADLK=35]="EDEADLK",e[e.ENAMETOOLONG=36]="ENAMETOOLONG",e[e.ENOLCK=37]="ENOLCK",e[e.ENOSYS=38]="ENOSYS",e[e.ENOTEMPTY=39]="ENOTEMPTY",e[e.ELOOP=40]="ELOOP",e[e.ENOMSG=42]="ENOMSG",e[e.EBADE=52]="EBADE",e[e.EBADR=53]="EBADR",e[e.EXFULL=54]="EXFULL",e[e.ENOANO=55]="ENOANO",e[e.EBADRQC=56]="EBADRQC",e[e.ENOSTR=60]="ENOSTR",e[e.ENODATA=61]="ENODATA",e[e.ETIME=62]="ETIME",e[e.ENOSR=63]="ENOSR",e[e.ENONET=64]="ENONET",e[e.EREMOTE=66]="EREMOTE",e[e.ENOLINK=67]="ENOLINK",e[e.ECOMM=70]="ECOMM",e[e.EPROTO=71]="EPROTO",e[e.EBADMSG=74]="EBADMSG",e[e.EOVERFLOW=75]="EOVERFLOW",e[e.EBADFD=77]="EBADFD",e[e.ESTRPIPE=86]="ESTRPIPE",e[e.ENOTSOCK=88]="ENOTSOCK",e[e.EDESTADDRREQ=89]="EDESTADDRREQ",e[e.EMSGSIZE=90]="EMSGSIZE",e[e.EPROTOTYPE=91]="EPROTOTYPE",e[e.ENOPROTOOPT=92]="ENOPROTOOPT",e[e.EPROTONOSUPPORT=93]="EPROTONOSUPPORT",e[e.ESOCKTNOSUPPORT=94]="ESOCKTNOSUPPORT",e[e.ENOTSUP=95]="ENOTSUP",e[e.ENETDOWN=100]="ENETDOWN",e[e.ENETUNREACH=101]="ENETUNREACH",e[e.ENETRESET=102]="ENETRESET",e[e.ETIMEDOUT=110]="ETIMEDOUT",e[e.ECONNREFUSED=111]="ECONNREFUSED",e[e.EHOSTDOWN=112]="EHOSTDOWN",e[e.EHOSTUNREACH=113]="EHOSTUNREACH",e[e.EALREADY=114]="EALREADY",e[e.EINPROGRESS=115]="EINPROGRESS",e[e.ESTALE=116]="ESTALE",e[e.EREMOTEIO=121]="EREMOTEIO",e[e.EDQUOT=122]="EDQUOT"})(vt||(vt={}));const az={[vt.EPERM]:"Operation not permitted",[vt.ENOENT]:"No such file or directory",[vt.EINTR]:"Interrupted system call",[vt.EIO]:"Input/output error",[vt.ENXIO]:"No such device or address",[vt.EBADF]:"Bad file descriptor",[vt.EAGAIN]:"Resource temporarily unavailable",[vt.ENOMEM]:"Cannot allocate memory",[vt.EACCES]:"Permission denied",[vt.EFAULT]:"Bad address",[vt.ENOTBLK]:"Block device required",[vt.EBUSY]:"Resource busy or locked",[vt.EEXIST]:"File exists",[vt.EXDEV]:"Invalid cross-device link",[vt.ENODEV]:"No such device",[vt.ENOTDIR]:"File is not a directory",[vt.EISDIR]:"File is a directory",[vt.EINVAL]:"Invalid argument",[vt.ENFILE]:"Too many open files in system",[vt.EMFILE]:"Too many open files",[vt.ETXTBSY]:"Text file busy",[vt.EFBIG]:"File is too big",[vt.ENOSPC]:"No space left on disk",[vt.ESPIPE]:"Illegal seek",[vt.EROFS]:"Cannot modify a read-only file system",[vt.EMLINK]:"Too many links",[vt.EPIPE]:"Broken pipe",[vt.EDOM]:"Numerical argument out of domain",[vt.ERANGE]:"Numerical result out of range",[vt.EDEADLK]:"Resource deadlock would occur",[vt.ENAMETOOLONG]:"File name too long",[vt.ENOLCK]:"No locks available",[vt.ENOSYS]:"Function not implemented",[vt.ENOTEMPTY]:"Directory is not empty",[vt.ELOOP]:"Too many levels of symbolic links",[vt.ENOMSG]:"No message of desired type",[vt.EBADE]:"Invalid exchange",[vt.EBADR]:"Invalid request descriptor",[vt.EXFULL]:"Exchange full",[vt.ENOANO]:"No anode",[vt.EBADRQC]:"Invalid request code",[vt.ENOSTR]:"Device not a stream",[vt.ENODATA]:"No data available",[vt.ETIME]:"Timer expired",[vt.ENOSR]:"Out of streams resources",[vt.ENONET]:"Machine is not on the network",[vt.EREMOTE]:"Object is remote",[vt.ENOLINK]:"Link has been severed",[vt.ECOMM]:"Communication error on send",[vt.EPROTO]:"Protocol error",[vt.EBADMSG]:"Bad message",[vt.EOVERFLOW]:"Value too large for defined data type",[vt.EBADFD]:"File descriptor in bad state",[vt.ESTRPIPE]:"Streams pipe error",[vt.ENOTSOCK]:"Socket operation on non-socket",[vt.EDESTADDRREQ]:"Destination address required",[vt.EMSGSIZE]:"Message too long",[vt.EPROTOTYPE]:"Protocol wrong type for socket",[vt.ENOPROTOOPT]:"Protocol not available",[vt.EPROTONOSUPPORT]:"Protocol not supported",[vt.ESOCKTNOSUPPORT]:"Socket type not supported",[vt.ENOTSUP]:"Operation is not supported",[vt.ENETDOWN]:"Network is down",[vt.ENETUNREACH]:"Network is unreachable",[vt.ENETRESET]:"Network dropped connection on reset",[vt.ETIMEDOUT]:"Connection timed out",[vt.ECONNREFUSED]:"Connection refused",[vt.EHOSTDOWN]:"Host is down",[vt.EHOSTUNREACH]:"No route to host",[vt.EALREADY]:"Operation already in progress",[vt.EINPROGRESS]:"Operation now in progress",[vt.ESTALE]:"Stale file handle",[vt.EREMOTEIO]:"Remote I/O error",[vt.EDQUOT]:"Disk quota exceeded"};class Xe extends Error{static fromJSON(t){const n=new Xe(t.errno,t.message,t.path,t.syscall);return n.code=t.code,n.stack=t.stack,n}static With(t,n,r){return new Xe(vt[t],az[vt[t]],n,r)}constructor(t,n=az[t],r,s=""){super(n),this.errno=t,this.message=n,this.path=r,this.syscall=s,this.code=vt[t]}toString(){return this.code+": "+this.message+(this.path?`, '${this.path}'`:"")}toJSON(){return{errno:this.errno,code:this.code,path:this.path,stack:this.stack,message:this.message,syscall:this.syscall}}bufferSize(){return 4+JSON.stringify(this.toJSON()).length}}var uI={exports:{}},oz;function q1e(){return oz||(oz=1,function(e){var t=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function s(l,c,u){this.fn=l,this.context=c,this.once=u||!1}function i(l,c,u,d,h){if(typeof u!="function")throw new TypeError("The listener must be a function");var m=new s(u,d||l,h),y=n?n+c:c;return l._events[y]?l._events[y].fn?l._events[y]=[l._events[y],m]:l._events[y].push(m):(l._events[y]=m,l._eventsCount++),l}function a(l,c){--l._eventsCount===0?l._events=new r:delete l._events[c]}function o(){this._events=new r,this._eventsCount=0}o.prototype.eventNames=function(){var c=[],u,d;if(this._eventsCount===0)return c;for(d in u=this._events)t.call(u,d)&&c.push(n?d.slice(1):d);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(u)):c},o.prototype.listeners=function(c){var u=n?n+c:c,d=this._events[u];if(!d)return[];if(d.fn)return[d.fn];for(var h=0,m=d.length,y=new Array(m);h<m;h++)y[h]=d[h].fn;return y},o.prototype.listenerCount=function(c){var u=n?n+c:c,d=this._events[u];return d?d.fn?1:d.length:0},o.prototype.emit=function(c,u,d,h,m,y){var b=n?n+c:c;if(!this._events[b])return!1;var v=this._events[b],x=arguments.length,w,_;if(v.fn){switch(v.once&&this.removeListener(c,v.fn,void 0,!0),x){case 1:return v.fn.call(v.context),!0;case 2:return v.fn.call(v.context,u),!0;case 3:return v.fn.call(v.context,u,d),!0;case 4:return v.fn.call(v.context,u,d,h),!0;case 5:return v.fn.call(v.context,u,d,h,m),!0;case 6:return v.fn.call(v.context,u,d,h,m,y),!0}for(_=1,w=new Array(x-1);_<x;_++)w[_-1]=arguments[_];v.fn.apply(v.context,w)}else{var k=v.length,C;for(_=0;_<k;_++)switch(v[_].once&&this.removeListener(c,v[_].fn,void 0,!0),x){case 1:v[_].fn.call(v[_].context);break;case 2:v[_].fn.call(v[_].context,u);break;case 3:v[_].fn.call(v[_].context,u,d);break;case 4:v[_].fn.call(v[_].context,u,d,h);break;default:if(!w)for(C=1,w=new Array(x-1);C<x;C++)w[C-1]=arguments[C];v[_].fn.apply(v[_].context,w)}}return!0},o.prototype.on=function(c,u,d){return i(this,c,u,d,!1)},o.prototype.once=function(c,u,d){return i(this,c,u,d,!0)},o.prototype.removeListener=function(c,u,d,h){var m=n?n+c:c;if(!this._events[m])return this;if(!u)return a(this,m),this;var y=this._events[m];if(y.fn)y.fn===u&&(!h||y.once)&&(!d||y.context===d)&&a(this,m);else{for(var b=0,v=[],x=y.length;b<x;b++)(y[b].fn!==u||h&&!y[b].once||d&&y[b].context!==d)&&v.push(y[b]);v.length?this._events[m]=v.length===1?v[0]:v:a(this,m)}return this},o.prototype.removeAllListeners=function(c){var u;return c?(u=n?n+c:c,this._events[u]&&a(this,u)):(this._events=new r,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=n,o.EventEmitter=o,e.exports=o}(uI)),uI.exports}var V1e=q1e();const FO=ga(V1e);var pH;let W1e=class extends FO{constructor(n){super();ce(this,pH,"List");ce(this,"data",new Set);n&&this.push(...n)}toSet(){return new Set(this.data)}toArray(){return Array.from(this.data)}toJSON(){return JSON.stringify(Array.from(this.data))}toString(){return this.join(",")}_set(n,r,s=!1){if(Math.abs(n)>this.data.size)throw new ReferenceError("Can not set an element outside the bounds of the list");const i=Array.from(this.data);i.splice(n,+s,r),this.data=new Set(i),this.emit("update")}set(n,r){this._set(n,r,!0)}deleteAt(n){if(Math.abs(n)>this.data.size)throw new ReferenceError("Can not delete an element outside the bounds of the list");this.delete(Array.from(this.data).at(n))}insert(n,r=this.data.size){this._set(r,n,!1)}at(n){if(Math.abs(n)>this.data.size)throw new ReferenceError("Can not access an element outside the bounds of the list");return Array.from(this.data).at(n)}pop(){const n=Array.from(this.data).pop();return n!==void 0&&this.delete(n),n}push(...n){for(const r of n)this.add(r);return this.data.size}join(n){return Array.from(this.data).join(n)}splice(n,r,...s){if(Math.abs(n)>this.data.size)throw new ReferenceError("Can not splice elements outside the bounds of the list");const i=Array.from(this.data),a=i.splice(n,r,...s);return this.data=new Set(i),this.emit("update"),a}add(n){return this.data.add(n),this.emit("update"),this.emit("add",n),this}clear(){this.data.clear(),this.emit("update")}delete(n){const r=this.data.delete(n);return this.emit("update"),r}has(n){return this.data.has(n)}get size(){return this.data.size}entries(){return this.toArray().entries()}keys(){return this.toArray().keys()}values(){return this.data.values()}[(pH=Symbol.toStringTag,Symbol.iterator)](){return this.data[Symbol.iterator]()}};function lz(e=new Error){const t=setTimeout(()=>{throw e},5e3);return()=>clearTimeout(t)}function vs(e){throw e}const cz=Intl.NumberFormat("en",{notation:"compact"});cz.format.bind(cz);function Xm(e,...t){const n={};for(const r of t.flat())n[r]=e[r];return n}function H1e(e){try{return JSON.parse(e),!0}catch{return!1}}function D3(e=0,t=1){return Math.round(Math.random()*(t-e)+e)}function LO(e){return e.at(0).toUpperCase()+e.slice(1)}const G1e=new TextEncoder;function am(e){return G1e.encode(e)}const uz=new TextDecoder;function BO(e){if(!e)return"";if(e.buffer instanceof ArrayBuffer&&!e.buffer.resizable)return uz.decode(e);const t=new Uint8Array(e.byteLength);return t.set(e),uz.decode(t)}function mw(e,t){if(e.byteLength>=t)return e;if(ArrayBuffer.isView(e)){const r=mw(e.buffer,t);return new e.constructor(r,e.byteOffset,t)}const n=typeof SharedArrayBuffer<"u"&&e instanceof SharedArrayBuffer;if(e.maxByteLength>t)return n?e.grow(t):e.resize(t),e;if(n){const r=new SharedArrayBuffer(t);return new Uint8Array(r).set(new Uint8Array(e)),r}try{return e.transfer(t)}catch{const r=new ArrayBuffer(t);return new Uint8Array(r).set(new Uint8Array(e)),r}}function K1e(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}var Y1e={};let Z1e="process"in globalThis&&"env"in globalThis.process&&Y1e.U_DEBUG=="true";function gw(...e){Z1e&&console.debug("[U]",...e)}const dz=["int8","uint8","int16","uint16","int32","uint32","int64","uint64","int128","uint128","float32","float64","float128"],X1e=[...dz,...dz.map(e=>LO(e)),"char"],$O=/^(u?int|float)(8|16|32|64|128)$/i;function qK(e){return e=="char"?"uint8":e.toLowerCase()}function zO(e){return $O.test(e.toString())}function F3(e){return e=="char"||$O.test(e.toString().toLowerCase())}function J1e(e){if(!F3(e))throw new TypeError("Not a valid primitive type: "+e)}const fz=BigInt("0xffffffffffffffff");Symbol.metadata??(Symbol.metadata=Symbol.for("Symbol.metadata"));Object.assign(Symbol,{size:Symbol("uSize"),serialize:Symbol("uSerialize"),deserialize:Symbol("uDeserialize")});function VK(e){return e.metadata??(e.metadata={}),e.metadata.structInit=[...e.metadata.structInit??[]],e.metadata.structInit}function Q1e(e){return e!=null&&typeof e=="object"&&"struct"in e}function YE(e){Symbol.metadata in e||Object.defineProperty(e,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:Object.create(null)})}function Lc(e){return typeof e=="function"&&Symbol.metadata in e&&Q1e(e[Symbol.metadata])}function I1(e){return e!=null&&typeof e=="object"&&Lc(e.constructor)}function WK(e){if(!I1(e))throw new TypeError((typeof e=="function"?e.name:typeof e=="object"&&e?e.constructor.name:e)+" is not a struct instance")}function UO(e){return I1(e)||Lc(e)}function HK(e){if(!UO(e))throw new TypeError((typeof e=="function"?e.name:typeof e=="object"&&e?e.constructor.name:e)+" is not a struct")}function qO(e){return typeof e=="object"&&e!=null&&Symbol.size in e}function Vs(e){if(e==null)return 0;if(Array.isArray(e)){let s=0;for(let i=0;i<e.length;i++)s+=Vs(e[i]);return s}if(typeof e=="string")return J1e(e),+qK(e).match($O)[2]/8;if(qO(e))return e[Symbol.size];HK(e);const t=Lc(e)?e:e.constructor;YE(t);const{struct:n}=t[Symbol.metadata];let r=n.staticSize;if(Lc(e))return r;for(const s of n.members.values()){const i=e[s.name];if(I1(i)&&i.constructor[Symbol.metadata].struct.isDynamic){n.isUnion?r=Math.max(r,Vs(i)):r+=Vs(i);continue}if(typeof s.length!="string")continue;let a=0;for(let o=0;o<e[s.length];o++)a+=Vs(UO(i[o])?i[o]:s.type);n.isUnion?r=Math.max(r,a):r+=a}return r}function eSe(e,t){var i;HK(e);const n=Lc(e)?e:e.constructor;YE(n);const{struct:r}=n[Symbol.metadata];if(Lc(e)||!r.isDynamic)return((i=r.members.get(t))==null?void 0:i.staticOffset)??vs(new Error("Struct does not have member: "+t));let s=0;for(const a of r.members.values()){if(a.name==t)return s;const o=e[a.name];s+=Vs(UO(o)?o:a.type)}throw new Error("Struct does not have member: "+t)}function tSe(e,t){return Math.ceil(e/t)*t}function Jm(e={}){return function(n,r){const s=new Map;let i=0,a=!1;for(const{name:o,type:l,length:c}of VK(r)){if(!F3(l)&&!Lc(l))throw new TypeError("Not a valid type: "+l);if(typeof c=="string"){const h=s.get(c);if(!h)throw new Error(`"${c}" is undefined or declared after "${o}"`);if(!zO(h.type))throw new Error(`"${c}" is not a number and cannot be used to count "${o}"`)}let u=`${typeof l=="string"?l:l.name} ${o}`;c!==void 0&&(u+=`[${c}]`),s.set(o,{name:o,staticOffset:e.isUnion?0:i,type:F3(l)?qK(l):l,length:c,decl:u});const d=typeof c=="string"||Lc(l)&&l[Symbol.metadata].struct.isDynamic?0:Vs(l)*(c||1);a||(a=Lc(l)?l[Symbol.metadata].struct.isDynamic:typeof c=="string"),i=e.isUnion?Math.max(i,d):i+d,i=tSe(i,e.align||1),gw("define",n.name+"."+o)}return r.metadata.struct={options:e,members:s,staticSize:i,isDynamic:a,isUnion:e.isUnion??!1},n}}function yw(e,t){return function(n,r){let s=r.name;if(typeof s=="symbol"&&(console.warn("Symbol used for struct member name will be coerced to string: "+s.toString()),s=s.toString()),!s)throw new ReferenceError("Invalid name for struct member");return VK(r).push({name:s,type:e,length:t}),n}}function GK(e,t){return t.length===void 0?-1:typeof t.length=="string"?e[t.length]:Number.isSafeInteger(t.length)&&t.length>=0?t.length:vs(new Error("Array lengths must be natural numbers"))}function Ca(e){if(qO(e)&&typeof e[Symbol.serialize]=="function")return e[Symbol.serialize]();WK(e),YE(e.constructor);const{options:t,members:n}=e.constructor[Symbol.metadata].struct,r=Vs(e),s=new Uint8Array(r),i=new DataView(s.buffer);gw("serialize",e.constructor.name);let a=0,o=0;for(const l of n.values()){const c=GK(e,l);gw("	",l.decl);for(let u=0;u<Math.abs(c);u++){let d=c!=-1?e[l.name][u]:e[l.name];if(typeof d=="string"&&(d=d.charCodeAt(0)),a=o,o+=I1(d)?Vs(d):Vs(l.type),!zO(l.type)){s.set(d?Ca(d):new Uint8Array(Vs(l.type)),a);continue}const h=`set${LO(l.type)}`;if(h=="setInt64"){i.setBigInt64(a,BigInt(d),!t.bigEndian);continue}if(h=="setUint64"){i.setBigUint64(a,BigInt(d),!t.bigEndian);continue}if(h=="setInt128"){i.setBigUint64(a+(t.bigEndian?8:0),d&fz,!t.bigEndian),i.setBigInt64(a+(t.bigEndian?0:8),d>>BigInt(64),!t.bigEndian);continue}if(h=="setUint128"){i.setBigUint64(a+(t.bigEndian?8:0),d&fz,!t.bigEndian),i.setBigUint64(a+(t.bigEndian?0:8),d>>BigInt(64),!t.bigEndian);continue}if(h=="setFloat128"){i.setFloat64(a+(t.bigEndian?8:0),Number(d),!t.bigEndian),i.setBigUint64(a+(t.bigEndian?0:8),BigInt(0),!t.bigEndian);continue}i[h](a,Number(d),!t.bigEndian)}}return s}function ZE(e,t){const n=K1e(t);if(qO(e)&&typeof e[Symbol.deserialize]=="function")return e[Symbol.deserialize](n);WK(e),YE(e.constructor);const{options:r,members:s}=e.constructor[Symbol.metadata].struct,i=new DataView(n.buffer,n.byteOffset,n.byteLength);gw("deserialize",e.constructor.name);let a=0,o=0;for(const l of s.values()){const c=GK(e,l);gw("	",l.decl);for(let u=0;u<Math.abs(c);u++){let d=c!=-1?e[l.name]:e;const h=c!=-1?u:l.name,m=d[h]===null||d[h]===void 0,y=m&&Lc(l.type)&&l.type[Symbol.metadata].struct.isDynamic;if(a=o,!I1(d[h])&&!y&&(o+=Vs(l.type)),typeof e[l.name]=="string"){e[l.name]=e[l.name].slice(0,u)+String.fromCharCode(i.getUint8(a))+e[l.name].slice(u+1);continue}if(!zO(l.type)){if(y&&Lc(l.type))d[h]??(d[h]=new l.type);else if(m)continue;ZE(d[h],new Uint8Array(n.subarray(a))),o+=Vs(d[h]);continue}c&&c!=-1&&(d||(d=[]));const b=`get${LO(l.type)}`;if(b=="getInt64"){d[h]=i.getBigInt64(a,!r.bigEndian);continue}if(b=="getUint64"){d[h]=i.getBigUint64(a,!r.bigEndian);continue}if(b=="getInt128"){d[h]=i.getBigInt64(a+(r.bigEndian?0:8),!r.bigEndian)<<BigInt(64)|i.getBigUint64(a+(r.bigEndian?8:0),!r.bigEndian);continue}if(b=="getUint128"){d[h]=i.getBigUint64(a+(r.bigEndian?0:8),!r.bigEndian)<<BigInt(64)|i.getBigUint64(a+(r.bigEndian?8:0),!r.bigEndian);continue}if(b=="getFloat128"){d[h]=i.getFloat64(a+(r.bigEndian?8:0),!r.bigEndian);continue}d[h]=i[b](a,!r.bigEndian)}}}function nSe(e){function t(n,r){return typeof n=="number"||typeof n=="string"?yw(e,n):yw(e)(n,r)}return t}const nr=Object.fromEntries(X1e.map(e=>[e,nSe(e)]));function rSe(e){return{suid:e.uid,sgid:e.gid,euid:e.uid,egid:e.gid,groups:[],...e}}const Xc={root:"/",pwd:"/",credentials:rSe({uid:0,gid:0}),descriptors:new Map};function KK(e,t){let n="",r=0,s=-1,i=0,a="\0";for(let o=0;o<=e.length;++o){if(o<e.length)a=e[o];else{if(a=="/")break;a="/"}if(a=="/"){if(!(s===o-1||i===1))if(i===2){if(n.length<2||r!==2||n.at(-1)!=="."||n.at(-2)!=="."){if(n.length>2){const l=n.lastIndexOf("/");l===-1?(n="",r=0):(n=n.slice(0,l),r=n.length-1-n.lastIndexOf("/")),s=o,i=0;continue}else if(n.length!==0){n="",r=0,s=o,i=0;continue}}t&&(n+=n.length>0?"/..":"..",r=2)}else n.length>0?n+="/"+e.slice(s+1,o):n=e.slice(s+1,o),r=o-s-1;s=o,i=0}else a==="."&&i!==-1?++i:i=-1}return n}function lf(...e){var t;let n="";for(const s of[...e.reverse(),(t=this===null||this===void 0?void 0:this.pwd)!==null&&t!==void 0?t:Xc.pwd])if(s!=null&&s.length&&(n=`${s}/${n}`,s.startsWith("/")))break;const r=n.startsWith("/");return n=KK(n,!r),r?`/${n}`:n.length?n:"/"}function sSe(e){if(!e.length)return".";const t=e.startsWith("/"),n=e.endsWith("/");return e=KK(e,!t),e.length?(n&&(e+="/"),t?`/${e}`:e):t?"/":n?"./":"."}function os(...e){if(!e.length)return".";const t=e.join("/");return t!=null&&t.length?sSe(t):"."}function YK(e,t){if(e===t||(e=lf.call(this,e),t=lf.call(this,t),e===t))return"";const n=1,r=e.length,s=r-n,i=1,a=t.length-i,o=s<a?s:a;let l=-1,c=0;for(;c<o;c++){const d=e[n+c];if(d!==t[i+c])break;d==="/"&&(l=c)}if(c===o)if(a>o){if(t[i+c]==="/")return t.slice(i+c+1);if(c===0)return t.slice(i+c)}else s>o&&(e[n+c]==="/"?l=c:c===0&&(l=0));let u="";for(c=n+l+1;c<=r;++c)(c===r||e[c]==="/")&&(u+=u.length===0?"..":"/..");return`${u}${t.slice(i+l)}`}function Xr(e){if(e.length===0)return".";const t=e[0]==="/";let n=-1,r=!0;for(let s=e.length-1;s>=1;--s)if(e[s]==="/"){if(!r){n=s;break}}else r=!1;return n===-1?t?"/":".":t&&n===1?"//":e.slice(0,n)}function vy(e,t){let n=0,r=-1,s=!0;for(let i=e.length-1;i>=0;--i)if(e[i]==="/"){if(!s){n=i+1;break}}else r===-1&&(s=!1,r=i+1);return r===-1?"":e.slice(n,r)}function vu(e){const t=e.startsWith("/"),n={root:t?"/":"",dir:"",base:"",ext:"",name:""};if(e.length===0)return n;const r=t?1:0;let s=-1,i=0,a=-1,o=!0,l=e.length-1,c=0;for(;l>=r;--l){if(e[l]==="/"){if(!o){i=l+1;break}continue}a===-1&&(o=!1,a=l+1),e[l]==="."?s===-1?s=l:c!==1&&(c=1):s!==-1&&(c=-1)}if(a!==-1){const u=i===0&&t?1:i;s===-1||c===0||c===1&&s===a-1&&s===i+1?n.base=n.name=e.slice(u,a):(n.name=e.slice(u,s),n.base=e.slice(u,a),n.ext=e.slice(s,a))}return i>0?n.dir=e.slice(0,i-1):t&&(n.dir="/"),n}var Jn;(function(e){e[e.EMERG=0]="EMERG",e[e.ALERT=1]="ALERT",e[e.CRIT=2]="CRIT",e[e.ERR=3]="ERR",e[e.WARN=4]="WARN",e[e.NOTICE=5]="NOTICE",e[e.INFO=6]="INFO",e[e.DEBUG=7]="DEBUG"})(Jn||(Jn={}));Jn.EMERG+"",Jn.ALERT+"",Jn.CRIT+"",Jn.ERR+"",Jn.WARN+"",Jn.NOTICE+"",Jn.INFO+"",Jn.DEBUG+"";const iSe=new W1e;function aSe(e,t){const n={level:e,message:t,timestamp:new Date,elapsedMs:performance.now()};iSe.add(n),pSe(n)}function oSe(e,t){var n,r;if(!(e instanceof Xe))return e.toString();const s=e.code+": "+e.message;if(!e.path)return s;const i=typeof t.fs=="string"?t.fs:(r=(n=t.fs)===null||n===void 0?void 0:n._mountPoint)!==null&&r!==void 0?r:"<unknown>";return s+": "+os(i,e.path)}function sp(e){return function(t,n={}){return aSe(e,oSe(t,n)),t}}sp(Jn.EMERG);const lSe=sp(Jn.ALERT),XE=sp(Jn.CRIT),Bo=sp(Jn.ERR),Ua=sp(Jn.WARN),VO=sp(Jn.NOTICE),ZK=sp(Jn.INFO),Dx=sp(Jn.DEBUG);function cSe(e,t){return`\x1B[${t}m${e}\x1B[0m`}function uSe(e,t){const n="["+(e.elapsedMs/1e3).toFixed(3).padStart(10)+"] ";switch(t){case"ansi":return[cSe(n,"2;37")];case"css":return["%c"+n,"opacity: 0.8; color: white;"];default:return[n]}}Jn.EMERG+"",Jn.ALERT+"",Jn.CRIT+"",Jn.ERR+"",Jn.WARN+"",Jn.NOTICE+"",Jn.INFO+"",Jn.DEBUG+"",Jn.EMERG+"",Jn.ALERT+"",Jn.CRIT+"",Jn.ERR+"",Jn.WARN+"",Jn.NOTICE+"",Jn.INFO+"",Jn.DEBUG+"";Jn.EMERG+"",Jn.ALERT+"",Jn.CRIT+"",Jn.ERR+"",Jn.WARN+"",Jn.NOTICE+"",Jn.INFO+"",Jn.DEBUG+"",Jn.EMERG+"",Jn.ALERT+"",Jn.CRIT+"",Jn.ERR+"",Jn.WARN+"",Jn.NOTICE+"",Jn.INFO+"",Jn.DEBUG+"";let dSe=e=>[...uSe(e),e.message];function fSe(e){const t=dSe(e);return typeof t=="string"?[t]:Array.from(t)}let hSe=console.error;function pSe(e){e.level>mSe||hSe(...fSe(e))}let mSe=Jn.ALERT;function WO(e){return e!=null&&typeof e=="object"&&"create"in e&&typeof e.create=="function"}function gSe(e,t){return Object.defineProperty(t,"prototype",{value:void 0}),Object.defineProperty(t,"name",{value:e}),t}function ySe(e,t){if(typeof t!="object"||t===null)throw Bo(new Xe(vt.EINVAL,"Invalid options"));for(const[n,r]of Object.entries(e.options)){const s=t==null?void 0:t[n];if(s==null){if(!r.required){Dx("Using default for option: "+n);continue}throw Bo(new Xe(vt.EINVAL,"Missing required option: "+n))}const i=(c,u=s)=>{var d;return typeof c=="function"?Symbol.hasInstance in c&&c.prototype?s instanceof c:c(s):typeof s===c||((d=s==null?void 0:s.constructor)===null||d===void 0?void 0:d.name)===c};if(Array.isArray(r.type)?r.type.some(c=>i(c)):i(r.type))continue;const a=typeof s=="object"&&"constructor"in s?s.constructor.name:typeof s,o=c=>typeof c=="function"?c.name!="type"?c.name:c.toString():c,l=Array.isArray(r.type)?`one of ${r.type.map(o).join(", ")}`:o(r.type);throw Bo(new Xe(vt.EINVAL,`Incorrect type for "${n}": ${a} (expected ${l})`))}}function XK(e){return e!=null&&typeof e=="object"&&"backend"in e&&WO(e.backend)}const HO=0,Xi=4,ui=2,HC=1,GO=1,bSe=2,vSe=4,JK=0,za=1,Zd=2,JE=64,QE=128,xSe=256,eT=512,Dm=1024,wSe=65536,SSe=262144,_Se=131072,tT=1052672,CSe=4096,kSe=32768,ESe=16384,TSe=2048,Es=61440,Qm=49152,gf=40960,Bc=32768,eg=24576,Oi=16384,tg=8192,ng=4096,M1=2048,j1=1024,ASe=512,RSe=448,QK=256,eY=128,tY=64,NSe=56,nY=32,rY=16,sY=8,ISe=7,iY=4,aY=2,oY=1,MSe=0,wo=4294967295,lY=Object.freeze(Object.defineProperty({__proto__:null,COPYFILE_EXCL:GO,COPYFILE_FICLONE:bSe,COPYFILE_FICLONE_FORCE:vSe,F_OK:HO,O_APPEND:Dm,O_CREAT:JE,O_DIRECT:ESe,O_DIRECTORY:wSe,O_DSYNC:CSe,O_EXCL:QE,O_NOATIME:SSe,O_NOCTTY:xSe,O_NOFOLLOW:_Se,O_NONBLOCK:TSe,O_RDONLY:JK,O_RDWR:Zd,O_SYMLINK:kSe,O_SYNC:tT,O_TRUNC:eT,O_WRONLY:za,R_OK:Xi,S_IFBLK:eg,S_IFCHR:tg,S_IFDIR:Oi,S_IFIFO:ng,S_IFLNK:gf,S_IFMT:Es,S_IFREG:Bc,S_IFSOCK:Qm,S_IRGRP:nY,S_IROTH:iY,S_IRUSR:QK,S_IRWXG:NSe,S_IRWXO:ISe,S_IRWXU:RSe,S_ISGID:j1,S_ISUID:M1,S_ISVTX:ASe,S_IWGRP:rY,S_IWOTH:aY,S_IWUSR:eY,S_IXGRP:sY,S_IXOTH:oY,S_IXUSR:tY,UV_FS_O_FILEMAP:MSe,W_OK:ui,X_OK:HC,size_max:wo},Symbol.toStringTag,{value:"Module"})),G_=BigInt(1e3);class cY{_convert(t){return this._isBigint?BigInt(t):Number(t)}get blocks(){return this._convert(Math.ceil(Number(this.size)/512))}set blocks(t){}get atime(){return new Date(Number(this.atimeMs))}set atime(t){this.atimeMs=this._convert(t.getTime())}get mtime(){return new Date(Number(this.mtimeMs))}set mtime(t){this.mtimeMs=this._convert(t.getTime())}get ctime(){return new Date(Number(this.ctimeMs))}set ctime(t){this.ctimeMs=this._convert(t.getTime())}get birthtime(){return new Date(Number(this.birthtimeMs))}set birthtime(t){this.birthtimeMs=this._convert(t.getTime())}constructor({atimeMs:t,mtimeMs:n,ctimeMs:r,birthtimeMs:s,uid:i,gid:a,size:o,mode:l,ino:c,...u}={}){this.dev=this._convert(0),this.ino=this._convert(0),this.rdev=this._convert(0),this.nlink=this._convert(1),this.blksize=this._convert(4096),this.uid=this._convert(0),this.gid=this._convert(0);const d=Date.now();this.atimeMs=this._convert(t??d),this.mtimeMs=this._convert(n??d),this.ctimeMs=this._convert(r??d),this.birthtimeMs=this._convert(s??d),this.uid=this._convert(i??0),this.gid=this._convert(a??0),this.size=this._convert(o??0),this.ino=this._convert(c??0),this.mode=this._convert(l??420&Bc),(this.mode&Es)==0&&(this.mode=this.mode|this._convert(Bc)),Object.assign(this,u)}isFile(){return(this.mode&Es)===Bc}isDirectory(){return(this.mode&Es)===Oi}isSymbolicLink(){return(this.mode&Es)===gf}isSocket(){return(this.mode&Es)===Qm}isBlockDevice(){return(this.mode&Es)===eg}isCharacterDevice(){return(this.mode&Es)===tg}isFIFO(){return(this.mode&Es)===ng}toJSON(){return Xm(this,L3)}hasAccess(t,n){return hs(n,this._isBigint?new yf(this):this,t)}get atimeNs(){return BigInt(this.atimeMs)*G_}get mtimeNs(){return BigInt(this.mtimeMs)*G_}get ctimeNs(){return BigInt(this.ctimeMs)*G_}get birthtimeNs(){return BigInt(this.birthtimeMs)*G_}}function uY(e,t,n){let r=!0;return!isNaN(t)&&t>=0&&t<wo?e.uid=t:r=!1,!isNaN(n)&&n>=0&&n<wo?e.gid=n:r=!1,r}class yf extends cY{constructor(){super(...arguments),this._isBigint=!1}}class rg extends cY{constructor(){super(...arguments),this._isBigint=!0}}function jSe(e,t){return e.size==t.size&&+e.atime==+t.atime&&+e.mtime==+t.mtime&&+e.ctime==+t.ctime&&e.mode==t.mode}class PSe{constructor(){this.type=525687744115,this.bsize=4096,this.blocks=0,this.bfree=0,this.bavail=0,this.files=wo,this.ffree=wo}}class OSe{constructor(){this.type=BigInt("0x7a656e6673"),this.bsize=BigInt(4096),this.blocks=BigInt(0),this.bfree=BigInt(0),this.bavail=BigInt(0),this.files=BigInt(wo),this.ffree=BigInt(wo)}}var Os=function(e,t,n,r,s,i){function a(x){if(x!==void 0&&typeof x!="function")throw new TypeError("Function expected");return x}for(var o=r.kind,l=o==="getter"?"get":o==="setter"?"set":"value",c=!t&&e?r.static?e:e.prototype:null,u=t||(c?Object.getOwnPropertyDescriptor(c,r.name):{}),d,h=!1,m=n.length-1;m>=0;m--){var y={};for(var b in r)y[b]=b==="access"?{}:r[b];for(var b in r.access)y.access[b]=r.access[b];y.addInitializer=function(x){if(h)throw new TypeError("Cannot add initializers after decoration has completed");i.push(a(x||null))};var v=(0,n[m])(o==="accessor"?{get:u.get,set:u.set}:u[l],y);if(o==="accessor"){if(v===void 0)continue;if(v===null||typeof v!="object")throw new TypeError("Object expected");(d=a(v.get))&&(u.get=d),(d=a(v.set))&&(u.set=d),(d=a(v.init))&&s.unshift(d)}else(d=a(v))&&(o==="field"?s.unshift(d):u[l]=d)}c&&Object.defineProperty(c,r.name,u),h=!0},Xn=function(e,t,n){for(var r=arguments.length>2,s=0;s<t.length;s++)n=r?t[s].call(e,n):t[s].call(e);return r?n:void 0},KO=function(e,t,n){return typeof t=="symbol"&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:n?"".concat(n," ",t):t})};const ll=0,DSe=1024;let hz=(()=>{var e,t;let n=[Jm()],r,s=[],i,a,o=[],l=[],c,u=[],d=[],h,m=[],y=[],b,v=[],x=[];return i=class{get key(){return this._key}set key(w){this._key=w,this.keySize=w.length}get value(){return this._value.subarray(0,this.valueSize)}set value(w){this._value=w,this.valueSize=w.length}constructor(w,_){this.keySize=Xn(this,o,0),this.valueSize=(Xn(this,l),Xn(this,u,0)),this._key=(Xn(this,d),Xn(this,m,"")),this._value=(Xn(this,y),Xn(this,v,new Uint8Array(DSe))),Xn(this,x),w&&(this.key=w),_&&(this.value=_)}},KO(i,"Attribute"),(()=>{const w=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;a=[(e=nr).uint32.bind(e)],c=[(t=nr).uint32.bind(t)],h=[nr.char("keySize")],b=[nr.uint8("valueSize")],Os(null,null,a,{kind:"field",name:"keySize",static:!1,private:!1,access:{has:_=>"keySize"in _,get:_=>_.keySize,set:(_,k)=>{_.keySize=k}},metadata:w},o,l),Os(null,null,c,{kind:"field",name:"valueSize",static:!1,private:!1,access:{has:_=>"valueSize"in _,get:_=>_.valueSize,set:(_,k)=>{_.valueSize=k}},metadata:w},u,d),Os(null,null,h,{kind:"field",name:"_key",static:!1,private:!1,access:{has:_=>"_key"in _,get:_=>_._key,set:(_,k)=>{_._key=k}},metadata:w},m,y),Os(null,null,b,{kind:"field",name:"_value",static:!1,private:!1,access:{has:_=>"_value"in _,get:_=>_._value,set:(_,k)=>{_._value=k}},metadata:w},v,x),Os(null,r={value:i},n,{kind:"class",name:i.name,metadata:w},null,s),i=r.value,w&&Object.defineProperty(i,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:w}),Xn(i,s)})(),i})(),$h=(()=>{var e;let t=[Jm()],n,r=[],s,i,a=[],o=[],l,c=[],u=[];return s=class{has(d){return this.data.some(h=>h.key==d)}get(d){return this.data.find(h=>h.key==d)}set(d,h){const m=this.get(d);if(m){m.value=h;return}this.data.push(new hz(d,h)),this.size++}remove(d){const h=this.data.findIndex(m=>m.key==d);return h===-1?!1:(this.data.splice(h,1),this.size--,!0)}keys(){return this.data.map(d=>d.key)}values(){return this.data.map(d=>d.value)}entries(){return this.data.map(d=>[d.key,d.value])}constructor(){this.size=Xn(this,a,0),this.data=(Xn(this,o),Xn(this,c,[])),Xn(this,u)}},KO(s,"Attributes"),(()=>{const d=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;i=[(e=nr).uint32.bind(e)],l=[yw(hz,"size")],Os(null,null,i,{kind:"field",name:"size",static:!1,private:!1,access:{has:h=>"size"in h,get:h=>h.size,set:(h,m)=>{h.size=m}},metadata:d},a,o),Os(null,null,l,{kind:"field",name:"data",static:!1,private:!1,access:{has:h=>"data"in h,get:h=>h.data,set:(h,m)=>{h.data=m}},metadata:d},c,u),Os(null,n={value:s},t,{kind:"class",name:s.name,metadata:d},null,r),s=n.value,d&&Object.defineProperty(s,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:d}),Xn(s,r)})(),s})();const L3=["ino","data","size","mode","flags","nlink","uid","gid","atimeMs","birthtimeMs","mtimeMs","ctimeMs","version"],FSe=4;var $o;(function(e){e[e.SecureRm=1]="SecureRm",e[e.Undelete=2]="Undelete",e[e.Compress=4]="Compress",e[e.Sync=8]="Sync",e[e.Immutable=16]="Immutable",e[e.Append=32]="Append",e[e.NoDump=64]="NoDump",e[e.NoAtime=128]="NoAtime",e[e.Dirty=256]="Dirty",e[e.CompressBlk=512]="CompressBlk",e[e.NoCompress=1024]="NoCompress",e[e.Encrypt=2048]="Encrypt",e[e.Btree=4096]="Btree",e[e.Index=4096]="Index",e[e.IMagic=8192]="IMagic",e[e.JournalData=16384]="JournalData",e[e.NoTail=32768]="NoTail",e[e.DirSync=65536]="DirSync",e[e.TopDir=131072]="TopDir",e[e.HugeFile=262144]="HugeFile",e[e.Extent=524288]="Extent",e[e.Verity=1048576]="Verity",e[e.EaInode=2097152]="EaInode",e[e.EofBlocks=4194304]="EofBlocks",e[e.NoCow=8388608]="NoCow",e[e.Dax=33554432]="Dax",e[e.InlineData=268435456]="InlineData",e[e.ProjInherit=536870912]="ProjInherit",e[e.CaseFold=1073741824]="CaseFold",e[e.Reserved=2147483648]="Reserved"})($o||($o={}));let Mi=(()=>{var e,t,n,r,s,i,a,o,l,c,u,d,h,m,y,b;let v=[Jm()],x,w=[],_,k,C=[],T=[],A,N=[],I=[],j,L=[],D=[],H,O=[],K=[],U,W=[],B=[],ne,V=[],Q=[],ee,re=[],de=[],me,De=[],je=[],Te,_e=[],Ue=[],Qe,We=[],Pe=[],Y,ye=[],Me=[],ue,oe=[],se=[],Ie,Be=[],Re=[],ct,At=[],ut=[],Pt,Ut=[],Ft=[],Yt,we=[],F=[],X,be=[],Ee=[],ge,Ae=[],le=[];var ft=_=class{constructor(et){if(this.data=Xn(this,C,D3(0,wo)),this.__data_old=(Xn(this,T),Xn(this,N,0)),this.size=(Xn(this,I),Xn(this,L,0)),this.mode=(Xn(this,D),Xn(this,O,0)),this.nlink=(Xn(this,K),Xn(this,W,1)),this.uid=(Xn(this,B),Xn(this,V,0)),this.gid=(Xn(this,Q),Xn(this,re,0)),this.atimeMs=(Xn(this,de),Xn(this,De,Date.now())),this.birthtimeMs=(Xn(this,je),Xn(this,_e,Date.now())),this.mtimeMs=(Xn(this,Ue),Xn(this,We,Date.now())),this.ctimeMs=(Xn(this,Pe),Xn(this,ye,Date.now())),this.ino=(Xn(this,Me),Xn(this,oe,D3(0,wo))),this.__ino_old=(Xn(this,se),Xn(this,Be,0)),this.flags=(Xn(this,Re),Xn(this,At,0)),this.__after_flags=(Xn(this,ut),Xn(this,Ut,0)),this.version=(Xn(this,Ft),Xn(this,we,0)),this.__padding=(Xn(this,F),Xn(this,be,[])),this.attributes=(Xn(this,Ee),Xn(this,Ae,new $h)),Xn(this,le),!!et){if(!("byteLength"in et)){Object.assign(this,et);return}if(et.byteLength<Vs(ft))throw XE(new Xe(vt.EIO,"Buffer is too small to create an inode"));ZE(this,et)}}toString(){return`<Inode ${this.ino}>`}toJSON(){return{...Xm(this,L3),attributes:this.attributes}}toStats(){return new yf(this)}update(et){if(!et)return!1;let $=!1;for(const qe of L3)et[qe]!==void 0&&(qe=="ino"||qe=="data"||this[qe]!==et[qe]&&(qe=="atimeMs"&&this.flags&$o.NoAtime||(this[qe]=et[qe],$=!0)));return et.attributes&&(this.attributes=et.attributes,$=!0),$&&(this.ctimeMs=Date.now()),$}};return KO(_,"Inode"),(()=>{const et=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;k=[(e=nr).uint32.bind(e)],A=[(t=nr).uint32.bind(t)],j=[(n=nr).uint32.bind(n)],H=[(r=nr).uint16.bind(r)],U=[(s=nr).uint32.bind(s)],ne=[(i=nr).uint32.bind(i)],ee=[(a=nr).uint32.bind(a)],me=[(o=nr).float64.bind(o)],Te=[(l=nr).float64.bind(l)],Qe=[(c=nr).float64.bind(c)],Y=[(u=nr).float64.bind(u)],ue=[(d=nr).uint32.bind(d)],Ie=[(h=nr).uint32.bind(h)],ct=[(m=nr).uint32.bind(m)],Pt=[(y=nr).uint16.bind(y)],Yt=[(b=nr).uint32.bind(b)],X=[nr.uint8(48)],ge=[yw($h)],Os(null,null,k,{kind:"field",name:"data",static:!1,private:!1,access:{has:$=>"data"in $,get:$=>$.data,set:($,qe)=>{$.data=qe}},metadata:et},C,T),Os(null,null,A,{kind:"field",name:"__data_old",static:!1,private:!1,access:{has:$=>"__data_old"in $,get:$=>$.__data_old,set:($,qe)=>{$.__data_old=qe}},metadata:et},N,I),Os(null,null,j,{kind:"field",name:"size",static:!1,private:!1,access:{has:$=>"size"in $,get:$=>$.size,set:($,qe)=>{$.size=qe}},metadata:et},L,D),Os(null,null,H,{kind:"field",name:"mode",static:!1,private:!1,access:{has:$=>"mode"in $,get:$=>$.mode,set:($,qe)=>{$.mode=qe}},metadata:et},O,K),Os(null,null,U,{kind:"field",name:"nlink",static:!1,private:!1,access:{has:$=>"nlink"in $,get:$=>$.nlink,set:($,qe)=>{$.nlink=qe}},metadata:et},W,B),Os(null,null,ne,{kind:"field",name:"uid",static:!1,private:!1,access:{has:$=>"uid"in $,get:$=>$.uid,set:($,qe)=>{$.uid=qe}},metadata:et},V,Q),Os(null,null,ee,{kind:"field",name:"gid",static:!1,private:!1,access:{has:$=>"gid"in $,get:$=>$.gid,set:($,qe)=>{$.gid=qe}},metadata:et},re,de),Os(null,null,me,{kind:"field",name:"atimeMs",static:!1,private:!1,access:{has:$=>"atimeMs"in $,get:$=>$.atimeMs,set:($,qe)=>{$.atimeMs=qe}},metadata:et},De,je),Os(null,null,Te,{kind:"field",name:"birthtimeMs",static:!1,private:!1,access:{has:$=>"birthtimeMs"in $,get:$=>$.birthtimeMs,set:($,qe)=>{$.birthtimeMs=qe}},metadata:et},_e,Ue),Os(null,null,Qe,{kind:"field",name:"mtimeMs",static:!1,private:!1,access:{has:$=>"mtimeMs"in $,get:$=>$.mtimeMs,set:($,qe)=>{$.mtimeMs=qe}},metadata:et},We,Pe),Os(null,null,Y,{kind:"field",name:"ctimeMs",static:!1,private:!1,access:{has:$=>"ctimeMs"in $,get:$=>$.ctimeMs,set:($,qe)=>{$.ctimeMs=qe}},metadata:et},ye,Me),Os(null,null,ue,{kind:"field",name:"ino",static:!1,private:!1,access:{has:$=>"ino"in $,get:$=>$.ino,set:($,qe)=>{$.ino=qe}},metadata:et},oe,se),Os(null,null,Ie,{kind:"field",name:"__ino_old",static:!1,private:!1,access:{has:$=>"__ino_old"in $,get:$=>$.__ino_old,set:($,qe)=>{$.__ino_old=qe}},metadata:et},Be,Re),Os(null,null,ct,{kind:"field",name:"flags",static:!1,private:!1,access:{has:$=>"flags"in $,get:$=>$.flags,set:($,qe)=>{$.flags=qe}},metadata:et},At,ut),Os(null,null,Pt,{kind:"field",name:"__after_flags",static:!1,private:!1,access:{has:$=>"__after_flags"in $,get:$=>$.__after_flags,set:($,qe)=>{$.__after_flags=qe}},metadata:et},Ut,Ft),Os(null,null,Yt,{kind:"field",name:"version",static:!1,private:!1,access:{has:$=>"version"in $,get:$=>$.version,set:($,qe)=>{$.version=qe}},metadata:et},we,F),Os(null,null,X,{kind:"field",name:"__padding",static:!1,private:!1,access:{has:$=>"__padding"in $,get:$=>$.__padding,set:($,qe)=>{$.__padding=qe}},metadata:et},be,Ee),Os(null,null,ge,{kind:"field",name:"attributes",static:!1,private:!1,access:{has:$=>"attributes"in $,get:$=>$.attributes,set:($,qe)=>{$.attributes=qe}},metadata:et},Ae,le),Os(null,x={value:_},v,{kind:"class",name:_.name,metadata:et},null,w),ft=_=x.value,et&&Object.defineProperty(_,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:et}),Xn(_,w)})(),ft=_})();function LSe(e){return(e.mode&Es)===Bc}function Gc(e){return(e.mode&Es)===Oi}function xy(e){return(e.mode&Es)===gf}function BSe(e){return(e.mode&Es)===Qm}function bw(e){return(e.mode&Es)===eg}function vw(e){return(e.mode&Es)===tg}function $Se(e){return(e.mode&Es)===ng}function hs(e,t,n){const r=(e==null?void 0:e.credentials)||Xc.credentials;if(xy(t)||r.euid===0||r.egid===0)return!0;let s=0;return r.uid===t.uid&&(t.mode&QK&&(s|=Xi),t.mode&eY&&(s|=ui),t.mode&tY&&(s|=HC)),(r.gid===t.gid||r.groups.includes(Number(t.gid)))&&(t.mode&nY&&(s|=Xi),t.mode&rY&&(s|=ui),t.mode&sY&&(s|=HC)),t.mode&iY&&(s|=Xi),t.mode&aY&&(s|=ui),t.mode&oY&&(s|=HC),(s&n)===n}const pz=1;class ek extends Map{constructor(){super(...arguments),this.maxSize=wo}toJSON(){return{version:pz,maxSize:this.maxSize,entries:Object.fromEntries([...this].map(([t,n])=>[t,n.toJSON()]))}}toString(){return JSON.stringify(this.toJSON())}get byteSize(){let t=this.size*Vs(Mi);for(const n of this.values())t+=n.size;return t}usage(){return{totalSpace:this.maxSize,freeSpace:this.maxSize-this.byteSize}}pathOf(t){for(const[n,r]of this)if(r.ino==t||r.data==t)return n}getByID(t){var n;return(n=this.entryByID(t))===null||n===void 0?void 0:n.inode}entryByID(t){for(const[n,r]of this)if(r.ino==t||r.data==t)return{path:n,inode:r}}directoryEntries(t){const n=this.get(t);if(!n)throw Xe.With("ENOENT",t);if((n.mode&Es)!=Oi)throw Xe.With("ENOTDIR",t);const r={};for(const s of this.keys())Xr(s)==t&&s!=t&&(r[vy(s)]=this.get(s).ino);return r}_alloc(){return Math.max(...[...this.values()].flatMap(t=>[t.ino,t.data]))+1}directories(){const t=new Map;for(const[n,r]of this){if((r.mode&Es)!=Oi)continue;const s={};for(const i of this.keys())Xr(i)==n&&i!=n&&(s[vy(i)]=this.get(i).ino);t.set(n,s)}return t}fromJSON(t){var n;if(t.version!=pz)throw new Xe(vt.EINVAL,"Index version mismatch");this.clear();for(const[r,s]of Object.entries(t.entries))(n=s.data)!==null&&n!==void 0||(s.data=D3(1,wo)),r=="/"&&(s.ino=0),this.set(r,new Mi(s));return this}static parse(t){if(!H1e(t))throw new Xe(vt.EINVAL,"Invalid JSON");const n=JSON.parse(t),r=new ek;return r.fromJSON(n),r}}const dI=4096;let YO=class B3{get uuid(){return this._uuid}constructor(t,n){this.type=t,this.name=n,this._uuid=crypto.randomUUID(),this.attributes=new Map,this.streamRead===B3.prototype.streamRead&&this.attributes.set("default_stream_read"),this.streamWrite===B3.prototype.streamWrite&&this.attributes.set("default_stream_write")}toString(){var t;return`${this.name} ${(t=this.label)!==null&&t!==void 0?t:""} (${this._mountPoint?"mounted on "+this._mountPoint:"unmounted"})`}usage(){return{totalSpace:0,freeSpace:0}}async ready(){}async exists(t){try{return await this.stat(t),!0}catch(n){return n.code!="ENOENT"}}existsSync(t){try{return this.statSync(t),!0}catch(n){return n.code!="ENOENT"}}streamRead(t,n){return new ReadableStream({start:async r=>{const{size:s}=await this.stat(t),{start:i=0,end:a=s}=n;for(let o=i;o<a;o+=dI){const l=o+dI>a?a-o:dI,c=new Uint8Array(l);await this.read(t,c,o,o+l).catch(r.error.bind(r)),r.enqueue(c)}r.close()},type:"bytes"})}streamWrite(t,n){var r;let s=(r=n.start)!==null&&r!==void 0?r:0;return new WritableStream({write:async(i,a)=>{let o=!1;const l=u=>{o=!0,a.error(u)},{size:c}=await this.stat(t);await this.write(t,i,s).catch(l),!o&&(s+=i.byteLength,await this.touch(t,{mtimeMs:Date.now(),size:Math.max(c,s)}).catch(l))}})}};function no(e){return JSON.parse(BO(e),(t,n)=>t==""?n:typeof n=="string"?BigInt(n).toString(16).slice(0,Math.min(n.length,8)):n)}function Ll(e){return am(JSON.stringify(e))}function ip(e,t){if(typeof e=="number")return e;if(typeof e=="string"){const n=parseInt(e,8);if(!isNaN(n))return n}if(typeof t=="number")return t;throw new Xe(vt.EINVAL,"Invalid mode: "+(e==null?void 0:e.toString()))}function tk(e){if(e instanceof Date)return e.getTime();try{return Number(e)}catch{throw new Xe(vt.EINVAL,"Invalid time.")}}function $n(e,t=!1){if(e instanceof URL){if(e.protocol!="file:")throw new Xe(vt.EINVAL,"URLs must use the file: protocol");e=e.pathname}if(e=e.toString(),e.startsWith("file://")&&(e=e.slice(7)),e.includes("\0"))throw new Xe(vt.EINVAL,"Path can not contain null character");if(e.length==0)throw new Xe(vt.EINVAL,"Path can not be empty");return e=e.replaceAll(/[/\\]+/g,"/"),t?e:lf(e)}function Xd(e,t="utf8",n,r=0){return typeof e!="object"||e===null?{encoding:typeof e=="string"?e:t??null,flag:n,mode:r}:{encoding:typeof(e==null?void 0:e.encoding)=="string"?e.encoding:t??null,flag:typeof(e==null?void 0:e.flag)=="string"?e.flag:n,mode:ip("mode"in e?e==null?void 0:e.mode:null,r)}}class zSe{constructor(t,n,r,s){ce(this,"id");ce(this,"_size");ce(this,"options");ce(this,"regions",[]);this.id=t,this._size=n,this.options=r,r.sparse??(r.sparse=!0),r.sparse||this.regions.push({offset:0,data:new Uint8Array(n),ranges:[]}),s==null||s.set(t,this)}get size(){return this._size}set size(t){if(t>=this._size){this._size=t;return}this._size=t;for(let n=this.regions.length-1;n>=0;n--){const r=this.regions[n];if(r.offset>=t){this.regions.splice(n,1);continue}const s=t-r.offset;r.data.byteLength>s&&(r.data=r.data.subarray(0,s)),r.ranges=r.ranges.filter(i=>i.start<t).map(i=>i.end>t?{start:i.start,end:t}:i)}}collect(){if(!this.options.sparse)return;const{regionGapThreshold:t=4095}=this.options;for(let n=0;n<this.regions.length-1;){const r=this.regions[n],s=this.regions[n+1];if(s.offset-(r.offset+r.data.byteLength)>t){n++;continue}r.ranges.push(...s.ranges),r.ranges.sort((i,a)=>i.start-a.start),r.ranges=r.ranges.reduce((i,a)=>(!i.length||i.at(-1).end<a.start?i.push(a):i.at(-1).end=Math.max(i.at(-1).end,a.end),i),[]),r.data=mw(r.data,s.offset+s.data.byteLength),r.data.set(s.data,s.offset-r.offset),this.regions.splice(n+1,1)}}missing(t,n){const r=[];for(const s of this.regions){if(s.offset>=n)break;for(const i of s.ranges)if(!(i.end<=t)&&(i.start>=n||(i.start>t&&r.push({start:t,end:Math.min(i.start,n)}),i.end>t&&(t=Math.max(t,i.end)),t>=n)))break;if(t>=n)break}return t<n&&r.push({start:t,end:n}),r}cached(t,n){const r=[];for(const i of this.regions){if(i.offset>=n)break;for(const a of i.ranges)if(!(a.end<=t)){if(a.start>=n)break;r.push({start:Math.max(t,a.start),end:Math.min(n,a.end)})}}r.sort((i,a)=>i.start-a.start);const s=[];for(const i of r){const a=s.at(-1);a&&i.start<=a.end?a.end=Math.max(a.end,i.end):s.push(i)}return s}regionAt(t){if(this.regions.length)for(const n of this.regions){if(n.offset>t)break;if(t>=n.offset&&t<n.offset+n.data.byteLength)return n}}add(t,n){const r=n+t.byteLength,s=this.regionAt(n);if(s)return s.data=mw(s.data,r),s.data.set(t,n),s.ranges.push({start:n,end:r}),s.ranges.sort((o,l)=>o.start-l.start),this.collect(),this;const i={data:t,offset:n,ranges:[{start:n,end:r}]},a=this.regions.findIndex(o=>o.offset>n);return a==-1?this.regions.push(i):this.regions.splice(a,0,i),this.collect(),this}}var fI,hI,pI;(fI=Promise.withResolvers)!==null&&fI!==void 0||(Promise.withResolvers=(Ua("Using a polyfill of Promise.withResolvers"),function(){let e,t;return{promise:new Promise((r,s)=>{e=r,t=s}),resolve:e,reject:t}}));(hI=Symbol.dispose)!==null&&hI!==void 0||(Symbol.dispose=(Ua("Using a polyfill of Symbol.dispose"),Symbol("Symbol.dispose")));(pI=Symbol.asyncDispose)!==null&&pI!==void 0||(Symbol.asyncDispose=(Ua("Using a polyfill of Symbol.asyncDispose"),Symbol("Symbol.asyncDispose")));class dY{constructor(t){this.store=t}}class USe extends dY{async get(t,n,r){return this.getSync(t,n,r)}async set(t,n,r){return this.setSync(t,n,r)}async remove(t){return this.removeSync(t)}}class $3 extends dY{constructor(){super(...arguments),this.asyncDone=Promise.resolve()}async(t){this.asyncDone=this.asyncDone.then(()=>t)}_cached(t,n){var r,s;(r=(s=this.store).cache)!==null&&r!==void 0||(s.cache=new Map);const i=this.store.cache.get(t);return i?(n&&(i.size=n.size),i):n?new zSe(t,n.size,{},this.store.cache):void 0}getSync(t,n,r){var s;const i=this._cached(t);if(!i)return;r??(r=i.size);const a=i.missing(n,r);for(const{start:l,end:c}of a)this.async(this.get(t,l,c));if(a.length)throw Bo(Xe.With("EAGAIN",(s=this.store._fs)===null||s===void 0?void 0:s._path(t)));const o=i.regionAt(n);if(!o){Ua("Missing cache region for "+t);return}return o.data.subarray(n-o.offset,r-o.offset)}setSync(t,n,r){this.async(this.set(t,n,r))}removeSync(t){var n;this.async(this.remove(t)),(n=this.store.cache)===null||n===void 0||n.delete(t)}}class qSe{flag(t){var n,r;return(r=(n=this.raw.store.flags)===null||n===void 0?void 0:n.includes(t))!==null&&r!==void 0?r:!1}constructor(t,n){this.raw=t,this.fs=n,this.done=!1,this.originalData=new Map,this.modifiedKeys=new Set}keys(){return this.raw.keys()}async get(t,n=0,r){const s=await this.raw.get(t,n,r);return this.stash(t),s}getSync(t,n=0,r){const s=this.raw.getSync(t,n,r);return this.stash(t),s}async set(t,n,r=0){await this.markModified(t,r,n.byteLength),await this.raw.set(t,n,r)}setSync(t,n,r=0){this.markModifiedSync(t,r,n.byteLength),this.raw.setSync(t,n,r)}async remove(t){await this.markModified(t,0,void 0),await this.raw.remove(t)}removeSync(t){this.markModifiedSync(t,0,void 0),this.raw.removeSync(t)}commit(){return this.done=!0,Promise.resolve()}commitSync(){this.done=!0}async abort(){if(!this.done){for(const[t,n]of this.originalData)if(this.modifiedKeys.has(t)){if(n.some(r=>!r.data)){await this.raw.remove(t),this.fs._remove(t);continue}for(const r of n.reverse())await this.raw.set(t,r.data,r.offset)}this.done=!0}}abortSync(){if(!this.done){for(const[t,n]of this.originalData)if(this.modifiedKeys.has(t)){if(n.some(r=>!r.data)){this.raw.removeSync(t),this.fs._remove(t);continue}for(const r of n.reverse())this.raw.setSync(t,r.data,r.offset)}this.done=!0}}async[Symbol.asyncDispose](){this.done||await this.abort()}[Symbol.dispose](){this.done||this.abortSync()}stash(t,n,r=0){this.originalData.has(t)||this.originalData.set(t,[]),this.originalData.get(t).push({data:n,offset:r})}async markModified(t,n,r){this.modifiedKeys.add(t);const s=r?n+r:void 0;try{this.stash(t,await this.raw.get(t,n,s),n)}catch(i){if(!(this.raw instanceof $3))throw i;const o=this.raw._cached(t);if(!o)throw i;for(const l of o.cached(n,s??n))this.stash(t,await this.raw.get(t,l.start,l.end),l.start)}}markModifiedSync(t,n,r){this.modifiedKeys.add(t);const s=r?n+r:void 0;try{this.stash(t,this.raw.getSync(t,n,s),n)}catch(i){if(!(this.raw instanceof $3))throw i;const o=this.raw._cached(t);if(!o)throw i;for(const l of o.cached(n,s??n))this.stash(t,this.raw.getSync(t,l.start,l.end),l.start)}}}var js=function(e,t,n){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var r,s;if(n){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=t[Symbol.asyncDispose]}if(r===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=t[Symbol.dispose],n&&(s=r)}if(typeof r!="function")throw new TypeError("Object not disposable.");s&&(r=function(){try{s.call(this)}catch(i){return Promise.reject(i)}}),e.stack.push({value:t,dispose:r,async:n})}else n&&e.stack.push({async:!0});return t},Ps=function(e){return function(t){function n(a){t.error=t.hasError?new e(a,t.error,"An error was suppressed during disposal."):a,t.hasError=!0}var r,s=0;function i(){for(;r=t.stack.pop();)try{if(!r.async&&s===1)return s=0,t.stack.push(r),Promise.resolve().then(i);if(r.dispose){var a=r.dispose.call(r.value);if(r.async)return s|=2,Promise.resolve(a).then(i,function(o){return n(o),i()})}else s|=1}catch(o){n(o)}if(s===1)return t.hasError?Promise.reject(t.error):Promise.resolve();if(t.hasError)throw t.error}return i()}}(typeof SuppressedError=="function"?SuppressedError:function(e,t,n){var r=new Error(n);return r.name="SuppressedError",r.error=e,r.suppressed=t,r});class fY extends YO{_path(t){var n;const[r]=(n=this._paths.get(t))!==null&&n!==void 0?n:[];return r}_add(t,n){this._paths.has(t)||this._paths.set(t,new Set),this._paths.get(t).add(n),this._ids.set(n,t)}_remove(t){var n;for(const r of(n=this._paths.get(t))!==null&&n!==void 0?n:[])this._ids.delete(r);this._paths.delete(t)}_move(t,n){const r=[];for(const[s,i]of this._ids){const a=YK(t,s);if(a.startsWith(".."))continue;let o=os(n,a);o.endsWith("/")&&(o=o.slice(0,-1)),r.push({oldKey:s,newKey:o,ino:i})}for(const{oldKey:s,newKey:i,ino:a}of r){this._ids.delete(s),this._ids.set(i,a);const o=this._paths.get(a);if(!o){Ua("Missing paths in table for ino "+a);continue}o.delete(s),o.add(i)}}async ready(){this._initialized||(this.checkRootSync(),await this.checkRoot(),await this._populate(),this._initialized=!0)}constructor(t){var n,r,s;super((n=t.type)!==null&&n!==void 0?n:1802921587,t.name),this.store=t,this._ids=new Map([["/",0]]),this._paths=new Map([[0,new Set("/")]]),this._initialized=!1,t._fs=this,this._uuid=(r=t.uuid)!==null&&r!==void 0?r:this.uuid,Dx(this.name+": supports features: "+((s=this.store.flags)===null||s===void 0?void 0:s.join(", ")))}usage(){var t,n;return((n=(t=this.store).usage)===null||n===void 0?void 0:n.call(t))||{totalSpace:0,freeSpace:0}}async loadIndex(t){const n={stack:[],error:void 0,hasError:!1};try{const r=js(n,this.transaction(),!0),s=t.directories();for(const[i,a]of t)this._add(a.ino,i),await r.set(a.ino,Ca(a)),s.has(i)&&await r.set(a.data,Ll(s.get(i)));await r.commit()}catch(r){n.error=r,n.hasError=!0}finally{const r=Ps(n);r&&await r}}loadIndexSync(t){const n={stack:[],error:void 0,hasError:!1};try{const r=js(n,this.transaction(),!1),s=t.directories();for(const[i,a]of t)this._add(a.ino,i),r.setSync(a.ino,Ca(a)),s.has(i)&&r.setSync(a.data,Ll(s.get(i)));r.commitSync()}catch(r){n.error=r,n.hasError=!0}finally{Ps(n)}}async createIndex(){var t;const n={stack:[],error:void 0,hasError:!1};try{const r=new ek,s=js(n,this.transaction(),!0),i=[["/",0]],a=lz(Xe.With("EDEADLK"));for(;i.length;){const[o,l]=i.shift(),c=new Mi(await s.get(l));if(r.set(o,c),c.mode&Oi){const u=no((t=await s.get(c.data))!==null&&t!==void 0?t:vs(Xe.With("ENODATA",o)));for(const[d,h]of Object.entries(u))i.push([os(o,d),h])}}return a(),r}catch(r){n.error=r,n.hasError=!0}finally{const r=Ps(n);r&&await r}}createIndexSync(){var t;const n={stack:[],error:void 0,hasError:!1};try{const r=new ek,s=js(n,this.transaction(),!1),i=[["/",0]],a=lz(Xe.With("EDEADLK"));for(;i.length;){const[o,l]=i.shift(),c=new Mi(s.getSync(l));if(r.set(o,c),c.mode&Oi){const u=no((t=s.getSync(c.data))!==null&&t!==void 0?t:vs(Xe.With("ENODATA",o)));for(const[d,h]of Object.entries(u))i.push([os(o,d),h])}}return a(),r}catch(r){n.error=r,n.hasError=!0}finally{Ps(n)}}async rename(t,n){var r,s,i;const a={stack:[],error:void 0,hasError:!1};try{const o=js(a,this.transaction(),!0),l=vu(t),c=vu(n),u=await this.findInode(o,l.dir,"rename"),d=no((r=await o.get(u.data))!==null&&r!==void 0?r:vs(Xe.With("ENODATA",l.dir,"rename")));if(!d[l.base])throw Xe.With("ENOENT",t,"rename");const h=d[l.base];if(h!=this._ids.get(t)&&Bo(`Ino mismatch while renaming ${t} to ${n}`),delete d[l.base],(c.dir+"/").startsWith(t+"/"))throw new Xe(vt.EBUSY,l.dir);const m=c.dir==l.dir,y=m?u:await this.findInode(o,c.dir,"rename"),b=m?d:no((s=await o.get(y.data))!==null&&s!==void 0?s:vs(Xe.With("ENODATA",c.dir,"rename")));if(b[c.base]){const v=new Mi((i=await o.get(b[c.base]))!==null&&i!==void 0?i:vs(Xe.With("ENOENT",n,"rename")));if(!v.toStats().isFile())throw Xe.With("EPERM",n,"rename");await o.remove(v.data),await o.remove(b[c.base])}b[c.base]=h,await o.set(u.data,Ll(d)),await o.set(y.data,Ll(b)),await o.commit(),this._move(t,n)}catch(o){a.error=o,a.hasError=!0}finally{const o=Ps(a);o&&await o}}renameSync(t,n){var r,s,i;const a={stack:[],error:void 0,hasError:!1};try{const o=js(a,this.transaction(),!1),l=vu(t),c=vu(n),u=this.findInodeSync(o,l.dir,"rename"),d=no((r=o.getSync(u.data))!==null&&r!==void 0?r:vs(Xe.With("ENODATA",l.dir,"rename")));if(!d[l.base])throw Xe.With("ENOENT",t,"rename");const h=d[l.base];if(h!=this._ids.get(t)&&Bo(`Ino mismatch while renaming ${t} to ${n}`),delete d[l.base],(c.dir+"/").startsWith(t+"/"))throw new Xe(vt.EBUSY,l.dir);const m=c.dir===l.dir,y=m?u:this.findInodeSync(o,c.dir,"rename"),b=m?d:no((s=o.getSync(y.data))!==null&&s!==void 0?s:vs(Xe.With("ENODATA",c.dir,"rename")));if(b[c.base]){const v=new Mi((i=o.getSync(b[c.base]))!==null&&i!==void 0?i:vs(Xe.With("ENOENT",n,"rename")));if(!v.toStats().isFile())throw Xe.With("EPERM",n,"rename");o.removeSync(v.data),o.removeSync(b[c.base])}b[c.base]=h,o.setSync(u.data,Ll(d)),o.setSync(y.data,Ll(b)),o.commitSync(),this._move(t,n)}catch(o){a.error=o,a.hasError=!0}finally{Ps(a)}}async stat(t){const n={stack:[],error:void 0,hasError:!1};try{const r=js(n,this.transaction(),!0);return await this.findInode(r,t,"stat")}catch(r){n.error=r,n.hasError=!0}finally{const r=Ps(n);r&&await r}}statSync(t){const n={stack:[],error:void 0,hasError:!1};try{const r=js(n,this.transaction(),!1);return this.findInodeSync(r,t,"stat")}catch(r){n.error=r,n.hasError=!0}finally{Ps(n)}}async touch(t,n){const r={stack:[],error:void 0,hasError:!1};try{const s=js(r,this.transaction(),!0),i=await this.findInode(s,t,"touch");i.update(n)&&(this._add(i.ino,t),s.setSync(i.ino,Ca(i))),await s.commit()}catch(s){r.error=s,r.hasError=!0}finally{const s=Ps(r);s&&await s}}touchSync(t,n){const r={stack:[],error:void 0,hasError:!1};try{const s=js(r,this.transaction(),!1),i=this.findInodeSync(s,t,"touch");i.update(n)&&(this._add(i.ino,t),s.setSync(i.ino,Ca(i))),s.commitSync()}catch(s){r.error=s,r.hasError=!0}finally{Ps(r)}}async createFile(t,n){return n.mode|=Bc,await this.commitNew(t,n,new Uint8Array,"createFile")}createFileSync(t,n){return n.mode|=Bc,this.commitNewSync(t,n,new Uint8Array,"createFile")}async unlink(t){return this.remove(t,!1)}unlinkSync(t){this.removeSync(t,!1)}async rmdir(t){if((await this.readdir(t)).length)throw Xe.With("ENOTEMPTY",t,"rmdir");await this.remove(t,!0)}rmdirSync(t){if(this.readdirSync(t).length)throw Xe.With("ENOTEMPTY",t,"rmdir");this.removeSync(t,!0)}async mkdir(t,n){return n.mode|=Oi,await this.commitNew(t,n,am("{}"),"mkdir")}mkdirSync(t,n){return n.mode|=Oi,this.commitNewSync(t,n,am("{}"),"mkdir")}async readdir(t){var n;const r={stack:[],error:void 0,hasError:!1};try{const s=js(r,this.transaction(),!0),i=await this.findInode(s,t,"readdir");return Object.keys(no((n=await s.get(i.data))!==null&&n!==void 0?n:vs(Xe.With("ENOENT",t,"readdir"))))}catch(s){r.error=s,r.hasError=!0}finally{const s=Ps(r);s&&await s}}readdirSync(t){var n;const r={stack:[],error:void 0,hasError:!1};try{const s=js(r,this.transaction(),!1),i=this.findInodeSync(s,t,"readdir");return Object.keys(no((n=s.getSync(i.data))!==null&&n!==void 0?n:vs(Xe.With("ENOENT",t,"readdir"))))}catch(s){r.error=s,r.hasError=!0}finally{Ps(r)}}async sync(t,n,r){const s={stack:[],error:void 0,hasError:!1};try{const i=js(s,this.transaction(),!0),a=await this.findInode(i,t,"sync");n&&await i.set(a.data,n),a.update(r)&&(this._add(a.ino,t),await i.set(a.ino,Ca(a))),await i.commit()}catch(i){s.error=i,s.hasError=!0}finally{const i=Ps(s);i&&await i}}syncSync(t,n,r){const s={stack:[],error:void 0,hasError:!1};try{const i=js(s,this.transaction(),!1),a=this.findInodeSync(i,t,"sync");n&&i.setSync(a.data,n),a.update(r)&&(this._add(a.ino,t),i.setSync(a.ino,Ca(a))),i.commitSync()}catch(i){s.error=i,s.hasError=!0}finally{Ps(s)}}async link(t,n){var r;const s={stack:[],error:void 0,hasError:!1};try{const i=js(s,this.transaction(),!0),a=Xr(n),o=await this.findInode(i,a,"link"),l=no((r=await i.get(o.data))!==null&&r!==void 0?r:vs(Xe.With("ENOENT",a,"link"))),c=await this.findInode(i,t,"link");c.nlink++,l[vy(n)]=c.ino,this._add(c.ino,n),await i.set(c.ino,Ca(c)),await i.set(o.data,Ll(l)),await i.commit()}catch(i){s.error=i,s.hasError=!0}finally{const i=Ps(s);i&&await i}}linkSync(t,n){var r;const s={stack:[],error:void 0,hasError:!1};try{const i=js(s,this.transaction(),!1),a=Xr(n),o=this.findInodeSync(i,a,"link"),l=no((r=i.getSync(o.data))!==null&&r!==void 0?r:vs(Xe.With("ENOENT",a,"link"))),c=this.findInodeSync(i,t,"link");c.nlink++,l[vy(n)]=c.ino,this._add(c.ino,n),i.setSync(c.ino,Ca(c)),i.setSync(o.data,Ll(l)),i.commitSync()}catch(i){s.error=i,s.hasError=!0}finally{Ps(s)}}async read(t,n,r,s){var i;const a={stack:[],error:void 0,hasError:!1};try{const o=js(a,this.transaction(),!0),l=await this.findInode(o,t,"read");if(l.size==0)return;const c=(i=await o.get(l.data,r,s))!==null&&i!==void 0?i:vs(Xe.With("ENODATA",t,"read")),u=o.flag("partial")?c:c.subarray(r,s);u.byteLength>n.byteLength&&Bo(`Trying to place ${u.byteLength} bytes into a ${n.byteLength} byte buffer on read`),n.set(u)}catch(o){a.error=o,a.hasError=!0}finally{const o=Ps(a);o&&await o}}readSync(t,n,r,s){var i;const a={stack:[],error:void 0,hasError:!1};try{const o=js(a,this.transaction(),!1),l=this.findInodeSync(o,t,"read");if(l.size==0)return;const c=(i=o.getSync(l.data,r,s))!==null&&i!==void 0?i:vs(Xe.With("ENODATA",t,"read")),u=o.flag("partial")?c:c.subarray(r,s);u.byteLength>n.byteLength&&Bo(`Trying to place ${u.byteLength} bytes into a ${n.byteLength} byte buffer on read`),n.set(u)}catch(o){a.error=o,a.hasError=!0}finally{Ps(a)}}async write(t,n,r){var s;const i={stack:[],error:void 0,hasError:!1};try{const a=js(i,this.transaction(),!0),o=await this.findInode(a,t,"write");let l=n;a.flag("partial")||(l=mw((s=await a.get(o.data))!==null&&s!==void 0?s:new Uint8Array,r+n.byteLength),l.set(n,r),r=0),await a.set(o.data,l,r),this._add(o.ino,t),await a.commit()}catch(a){i.error=a,i.hasError=!0}finally{const a=Ps(i);a&&await a}}writeSync(t,n,r){var s;const i={stack:[],error:void 0,hasError:!1};try{const a=js(i,this.transaction(),!1),o=this.findInodeSync(a,t,"write");let l=n;a.flag("partial")||(l=mw((s=a.getSync(o.data))!==null&&s!==void 0?s:new Uint8Array,r+n.byteLength),l.set(n,r),r=0),a.setSync(o.data,l,r),this._add(o.ino,t),a.commitSync()}catch(a){i.error=a,i.hasError=!0}finally{Ps(i)}}transaction(){return new qSe(this.store.transaction(),this)}async checkRoot(){const t={stack:[],error:void 0,hasError:!1};try{const n=js(t,this.transaction(),!0);if(await n.get(ll))return;const r=new Mi({ino:ll,data:1,mode:511|Oi});await n.set(r.data,am("{}")),this._add(ll,"/"),await n.set(ll,Ca(r)),await n.commit()}catch(n){t.error=n,t.hasError=!0}finally{const n=Ps(t);n&&await n}}checkRootSync(){const t={stack:[],error:void 0,hasError:!1};try{const n=js(t,this.transaction(),!1);if(n.getSync(ll))return;const r=new Mi({ino:ll,data:1,mode:511|Oi});n.setSync(r.data,am("{}")),this._add(ll,"/"),n.setSync(ll,Ca(r)),n.commitSync()}catch(n){t.error=n,t.hasError=!0}finally{Ps(t)}}async _populate(){const t={stack:[],error:void 0,hasError:!1};try{if(this._initialized){Ua("Attempted to populate tables after initialization");return}Dx("Populating tables with existing store metadata");const n=js(t,this.transaction(),!0),r=await n.get(ll);if(!r){VO("Store does not have a root inode");const o=new Mi({ino:ll,data:1,mode:511|Oi});await n.set(o.data,am("{}")),this._add(ll,"/"),await n.set(ll,Ca(o)),await n.commit();return}if(r.length<Vs(Mi)){XE("Store contains an invalid root inode. Refusing to populate tables");return}const s=new Set;let i=0;const a=[["/",ll]];for(;a.length>0;){i++;const[o,l]=a.shift();this._add(l,o);const c=await n.get(l);if(!c){Ua("Store is missing data for inode: "+l);continue}if(c.length<Vs(Mi)){Ua(`Invalid inode size for ino ${l}: ${c.length}`);continue}const u=new Mi(c);if((u.mode&Oi)!=Oi||s.has(l))continue;s.add(l);const d=await n.get(u.data);if(!d){Ua("Store is missing directory data: "+u.data);continue}const h=no(d);for(const[m,y]of Object.entries(h))a.push([os(o,m),y])}Dx(`Added ${i} existing inode(s) from store`)}catch(n){t.error=n,t.hasError=!0}finally{const n=Ps(t);n&&await n}}async findInode(t,n,r){var s;const i=this._ids.get(n);if(i===void 0)throw Xe.With("ENOENT",n,r);return new Mi((s=await t.get(i))!==null&&s!==void 0?s:vs(Xe.With("ENOENT",n,r)))}findInodeSync(t,n,r){var s;const i=this._ids.get(n);if(i===void 0)throw Xe.With("ENOENT",n,r);return new Mi((s=t.getSync(i))!==null&&s!==void 0?s:vs(Xe.With("ENOENT",n,r)))}allocNew(t,n){var r;(r=this._lastID)!==null&&r!==void 0||(this._lastID=Math.max(...this._paths.keys())),this._lastID+=2;const s=this._lastID;if(s>wo)throw Bo(new Xe(vt.ENOSPC,"No IDs available",t,n),{fs:this});return this._add(s,t),s}async commitNew(t,n,r,s){var i;const a={stack:[],error:void 0,hasError:!1};try{if(t=="/")throw Xe.With("EEXIST",t,s);const o=js(a,this.transaction(),!0),{dir:l,base:c}=vu(t),u=await this.findInode(o,l,s),d=no((i=await o.get(u.data))!==null&&i!==void 0?i:vs(Xe.With("ENOENT",l,s)));if(d[c])throw Xe.With("EEXIST",t,s);const h=this.allocNew(t,s),m=new Mi({...n,ino:h,data:h+1,size:r.byteLength});return await o.set(m.ino,Ca(m)),await o.set(m.data,r),d[c]=m.ino,await o.set(u.data,Ll(d)),await o.commit(),m}catch(o){a.error=o,a.hasError=!0}finally{const o=Ps(a);o&&await o}}commitNewSync(t,n,r,s){var i;const a={stack:[],error:void 0,hasError:!1};try{if(t=="/")throw Xe.With("EEXIST",t,s);const o=js(a,this.transaction(),!1),{dir:l,base:c}=vu(t),u=this.findInodeSync(o,l,s),d=no((i=o.getSync(u.data))!==null&&i!==void 0?i:vs(Xe.With("ENOENT",l,s)));if(d[c])throw Xe.With("EEXIST",t,s);const h=this.allocNew(t,s),m=new Mi({...n,ino:h,data:h+1,size:r.byteLength});return o.setSync(m.ino,Ca(m)),o.setSync(m.data,r),d[c]=m.ino,o.setSync(u.data,Ll(d)),o.commitSync(),m}catch(o){a.error=o,a.hasError=!0}finally{Ps(a)}}async remove(t,n){var r,s;const i={stack:[],error:void 0,hasError:!1};try{const a=n?"rmdir":"unlink",o=js(i,this.transaction(),!0),{dir:l,base:c}=vu(t),u=await this.findInode(o,l,a),d=no((r=await o.get(u.data))!==null&&r!==void 0?r:vs(Xe.With("ENOENT",l,a)));if(!d[c])throw Xe.With("ENOENT",t,a);const h=d[c],m=new Mi((s=await o.get(h))!==null&&s!==void 0?s:vs(Xe.With("ENOENT",t,a)));if(delete d[c],!n&&Gc(m))throw Xe.With("EISDIR",t,a);await o.set(u.data,Ll(d)),m.nlink>1?(m.update({nlink:m.nlink-1}),await o.set(m.ino,Ca(m))):(await o.remove(m.data),await o.remove(h),this._remove(h)),await o.commit()}catch(a){i.error=a,i.hasError=!0}finally{const a=Ps(i);a&&await a}}removeSync(t,n){var r,s;const i={stack:[],error:void 0,hasError:!1};try{const a=n?"rmdir":"unlink",o=js(i,this.transaction(),!1),{dir:l,base:c}=vu(t),u=this.findInodeSync(o,l,a),d=no((r=o.getSync(u.data))!==null&&r!==void 0?r:vs(Xe.With("ENOENT",l,a))),h=d[c];if(!h)throw Xe.With("ENOENT",t,a);const m=new Mi((s=o.getSync(h))!==null&&s!==void 0?s:vs(Xe.With("ENOENT",t,a)));if(delete d[c],!n&&Gc(m))throw Xe.With("EISDIR",t,a);o.setSync(u.data,Ll(d)),m.nlink>1?(m.update({nlink:m.nlink-1}),o.setSync(m.ino,Ca(m))):(o.removeSync(m.data),o.removeSync(h),this._remove(h)),o.commitSync()}catch(a){i.error=a,i.hasError=!0}finally{Ps(i)}}}class VSe extends USe{async keys(){return this.store.keys()}async get(t){var n,r,s;return await((s=(r=(n=this.store).getAsync)===null||r===void 0?void 0:r.call(n,t))!==null&&s!==void 0?s:this.store.get(t))}getSync(t){return this.store.get(t)}setSync(t,n){this.store.set(t,n)}removeSync(t){this.store.delete(t)}}class WSe extends Map{constructor(t=wo,n){super(),this.maxSize=t,this.label=n,this.flags=[],this.name="tmpfs"}async sync(){}transaction(){return new VSe(this)}get bytes(){let t=this.size*4;for(const n of this.values())t+=n.byteLength;return t}usage(){return{totalSpace:this.maxSize,freeSpace:this.maxSize-this.bytes}}}const HSe={name:"InMemory",options:{maxSize:{type:"number",required:!1},label:{type:"string",required:!1}},create({maxSize:e,label:t}){const n=new fY(new WSe(e,t));return n.checkRootSync(),n}},GSe=HSe;let Ji=!0;class mz extends FO{get cursor(){return this._cursor}constructor(t,n,r,s=!1){super(),this.input=t,this.output=n,this.terminal=s,this.line="",this._cursor=0,this._buffer="",this._closed=!1,this._paused=!1,this._prompt="",this._history=[],this._historyIndex=-1,this._currentLine="",this._onData=i=>{if(!(this._paused||this._closed)){this._buffer+=typeof i=="string"?i:i.toString("utf8");for(let a=this._buffer.indexOf(`
`);a>=0;a=this._buffer.indexOf(`
`)){let o=this._buffer.substring(0,a);o.endsWith("\r")&&(o=o.substring(0,o.length-1)),this._buffer=this._buffer.substring(a+1),this.line=o,o.trim()&&!o.trim().match(/^\s*$/)&&this._history.at(-1)!=o&&(this._history.push(o),this._historyIndex=this._history.length,this.emit("history",this._history)),this.emit("line",o)}}},this.input.on("data",this._onData),this.input.on("end",this.close.bind(this)),this.input.on("close",this.close.bind(this))}close(){var t,n;if(!this._closed){if(this._closed=!0,(n=(t=this.input)===null||t===void 0?void 0:t.removeAllListeners)===null||n===void 0||n.call(t),this._buffer.length){const r=this._buffer;this._buffer="",this.line=r,this.emit("line",r)}this.emit("history",this._history),this.emit("close"),this.removeAllListeners()}}pause(){return this._paused?this:(this._paused=!0,"pause"in this.input&&this.input.pause(),this.emit("pause"),this)}resume(){return this._paused?(this._paused=!1,"resume"in this.input&&this.input.resume(),this.emit("resume"),this):this}setPrompt(t){this._prompt=t}getPrompt(){return this._prompt}prompt(t){if(!this.output)return;if(!t){this.output.write(this._prompt);return}const{cols:n}=this.getCursorPos();this.output.write(this._prompt),this._cursor=n}write(t,n){if(!this._closed){if(t){const r=typeof t=="string"?t:t.toString("utf8");this._onData(r)}if(!(!n||!this.terminal))switch((n.ctrl?"^":"")+n.name){case"^c":this.emit("SIGINT");break;case"^z":this.emit("SIGTSTP");break;case"^q":this.emit("SIGCONT");break;case"home":case"^a":if(!this.output)return;Bl(this.output,-this._cursor,0),this._cursor=0,this._cursor=0;break;case"^e":case"end":{if(!this.output)return;const r=this.line.length-this._cursor;if(!r)return;Bl(this.output,r,0),this._cursor=this.line.length,this._cursor=this.line.length;break}case"^k":{if(!this.output||this._cursor>=this.line.length)return;const r=this.line.slice(0,this._cursor);K_(this.output,1),this.line=r;break}case"^u":{if(!this.output||!this._cursor)return;const r=this.line.slice(this._cursor);K_(this.output,0),Bl(this.output,0,0),this.output.write(this._prompt+r),this.line=r,this._cursor=0,this._cursor=0;break}case"^w":{if(!this.output||!this._cursor)return;let r=this._cursor-1;for(;r>=0&&this.line[r]===" ";)r--;for(;r>=0&&this.line[r]!==" ";)r--;const s=this.line.slice(0,r+1)+this.line.slice(this._cursor),i=r+1;this._renderLine(s),this._cursor=i,this._cursor=i,Bl(this.output,-s.length,0),Bl(this.output,i,0);break}case"^return":case"^enter":this._onData(`
`);break;case"return":case"enter":this._onData((t?typeof t=="string"?t:t.toString("utf8"):"")+`
`);break;case"up":case"down":{if(!this.output||!this._history.length)return;if(this._historyIndex===this._history.length&&(this._currentLine=this.line||""),n.name=="up"&&this._historyIndex>0)this._historyIndex--;else if(n.name=="down"&&this._historyIndex<this._history.length-1)this._historyIndex++;else if(n.name=="down"&&this._historyIndex==this._history.length-1){this._historyIndex=this._history.length,this._renderLine(this._currentLine);return}else return;const r=this._history[this._historyIndex];this._renderLine(r);break}case"left":case"right":{const r=n.name=="left"?-1:1;if(!this.output)return;const s=Math.max(0,Math.min(this.line.length,this._cursor+r));if(s==this._cursor)return;Bl(this.output,r,0),this._cursor=s,this._cursor=s;break}case"backspace":{if(!this.output||!this._cursor)return;const r=this.line.slice(0,this._cursor-1)+this.line.slice(this._cursor);this._renderLine(r),this._cursor=--this._cursor,this._cursor>0&&(Bl(this.output,-this._cursor,0),Bl(this.output,this._cursor,0));break}case"delete":{if(!this.output||this._cursor>=this.line.length)return;const r=this.line.slice(0,this._cursor)+this.line.slice(this._cursor+1);K_(this.output,0),Bl(this.output,0,0),this.output.write(this._prompt+r),this.line=r,Bl(this.output,-r.length,0),Bl(this.output,this._cursor,0);break}}}}_renderLine(t){this.output&&(K_(this.output,0),Bl(this.output,0,0),this.output.write(this._prompt+t),this.line=t,this._cursor=t.length,this._cursor=t.length)}question(t,n,r){const s=typeof n=="function"?n:r;if(this._closed||!this.output){s("");return}this.output.write(t),this.once("line",s)}getCursorPos(){return{rows:0,cols:this.cursor}}prependListener(t,n){const r=this.listeners(t);return this.removeAllListeners(t),this.on(t,n),r.forEach(this.on.bind(this,t)),this}prependOnceListener(t,n){const r=this.listeners(t);return this.removeAllListeners(t),this.once(t,n),r.forEach(this.on.bind(this,t)),this}setMaxListeners(){return Ua("Interface.prototype.setMaxListeners is not supported"),this}getMaxListeners(){return Ua("Interface.prototype.getMaxListeners is not supported"),10}[Symbol.asyncIterator](){let t=!1;return{next:async()=>{if(t)return{done:t,value:void 0};const{resolve:n,promise:r}=Promise.withResolvers();return this.once("line",s=>n({value:s,done:!1})),this.once("close",()=>{t=!0,n({value:void 0,done:t})}),r},return:async n=>t?{done:t,value:n}:(t=!0,this.close(),{done:t,value:n}),throw:async n=>{throw t||(t=!0,this.close()),n},[Symbol.asyncIterator](){return this},[Symbol.asyncDispose]:async()=>{t||(t=!0,this.close())}}}async[Symbol.asyncDispose](){if(this._closed)return;const{resolve:t,promise:n}=Promise.withResolvers();this.once("close",()=>t()),this.close(),await n}rawListeners(t){return this.listeners(t)}}function KSe(e,t,n,r){return"input"in e?new mz(e.input,e.output,e.completer,e.terminal):new mz(e,t,n,r)}function K_(e,t){return e.write(t>=0?"\r\x1B[K":"\x1B[K"),!0}function Bl(e,t,n){if(!e.write)return!1;let r="";return t<0?r+=`\x1B[${-t}D`:t>0&&(r+=`\x1B[${t}C`),n<0?r+=`\x1B[${-n}A`:n>0&&(r+=`\x1B[${n}B`),r&&e.write(r),!0}class nk{get position(){return this.flag&Dm?this.inode.size:this._position}set position(t){this._position=t}constructor(t,n,r,s,i,a){this.context=t,this.path=n,this.fs=r,this.internalPath=s,this.flag=i,this.inode=a,this._position=0,this.dirty=!1,this.closed=!1}[Symbol.dispose](){this.close()}get _isSync(){return!!(this.flag&tT||this.inode.flags&$o.Sync)}sync(){if(this.closed)throw Xe.With("EBADF",this.path,"sync");this.dirty&&(this.fs.attributes.has("no_write")||this.fs.touchSync(this.internalPath,this.inode),this.dirty=!1)}datasync(){return this.sync()}close(){if(this.closed)throw Xe.With("EBADF",this.path,"close");this.sync(),this.dispose()}dispose(t){if(this.closed)throw Xe.With("EBADF",this.path,"dispose");if(this.dirty&&!t)throw Xe.With("EBUSY",this.path,"dispose");this.closed=!0}stat(){if(this.closed)throw Xe.With("EBADF",this.path,"stat");return this.inode}truncate(t){if(this.closed)throw Xe.With("EBADF",this.path,"truncate");if(this.dirty=!0,!(this.flag&za||this.flag&Zd))throw new Xe(vt.EPERM,"File not opened with a writeable mode",this.path,"truncate");this.inode.mtimeMs=Date.now(),this.inode.size=t,this.inode.ctimeMs=Date.now(),this._isSync&&this.sync()}write(t,n=0,r=t.byteLength-n,s=this.position){if(this.closed)throw Xe.With("EBADF",this.path,"write");if(!(this.flag&za||this.flag&Zd))throw new Xe(vt.EPERM,"File not opened with a writeable mode");if(this.inode.flags&$o.Immutable)throw new Xe(vt.EPERM,"File is immutable",this.path,"write");this.dirty=!0;const i=s+r,a=t.subarray(n,n+r);return!vw(this.inode)&&!bw(this.inode)&&i>this.inode.size&&(this.inode.size=i),this.inode.mtimeMs=Date.now(),this.inode.ctimeMs=Date.now(),this._position=s+a.byteLength,this.fs.writeSync(this.internalPath,a,s),this._isSync&&this.sync(),a.byteLength}read(t,n=0,r=t.byteLength-n,s=this.position){if(this.closed)throw Xe.With("EBADF",this.path,"read");if(this.flag&za)throw new Xe(vt.EPERM,"File not opened with a readable mode");this.inode.flags&$o.NoAtime||(this.dirty=!0,this.inode.atimeMs=Date.now());let i=s+r;!vw(this.inode)&&!bw(this.inode)&&i>this.inode.size&&(i=s+Math.max(this.inode.size-s,0)),this._position=i;const a=new Uint8Array(t.buffer,t.byteOffset,t.byteLength);return this.fs.readSync(this.internalPath,a.subarray(n,n+r),s,i),this._isSync&&this.sync(),i-s}chmod(t){if(this.closed)throw Xe.With("EBADF",this.path,"chmod");this.dirty=!0,this.inode.mode=this.inode.mode&(t>Es?-61441:Es)|t,(this._isSync||t>Es)&&this.sync()}chown(t,n){if(this.closed)throw Xe.With("EBADF",this.path,"chown");this.dirty=!0,uY(this.inode,t,n),this._isSync&&this.sync()}utimes(t,n){if(this.closed)throw Xe.With("EBADF",this.path,"utimes");this.dirty=!0,this.inode.atimeMs=t,this.inode.mtimeMs=n,this._isSync&&this.sync()}streamRead(t){if(this.closed)throw Xe.With("EBADF",this.path,"streamRead");return this.fs.streamRead(this.internalPath,t)}streamWrite(t){if(this.closed)throw Xe.With("EBADF",this.path,"streamWrite");if(this.inode.flags&$o.Immutable)throw new Xe(vt.EPERM,"File is immutable",this.path,"streamWrite");return this.fs.streamWrite(this.internalPath,t)}}function rk(e){var t,n;const r=(n=(t=e.context)===null||t===void 0?void 0:t.descriptors)!==null&&n!==void 0?n:Xc.descriptors,s=Math.max(r.size?Math.max(...r.keys())+1:0,4);return r.set(s,e),s}function Ya(e,t){var n;const s=((n=e==null?void 0:e.descriptors)!==null&&n!==void 0?n:Xc.descriptors).get(t);if(!s)throw new Xe(vt.EBADF);return s}function hY(e,t){var n;return((n=e==null?void 0:e.descriptors)!==null&&n!==void 0?n:Xc.descriptors).delete(t)}const YSe=/[rwasx]{1,2}\+?/;function Jd(e){if(typeof e=="number")return e;if(!YSe.test(e))throw new Xe(vt.EINVAL,"Invalid flag string: "+e);return ZSe(e)}function ZSe(e){if(!e.includes("r")&&!e.includes("w")&&!e.includes("a"))throw new Xe(vt.EINVAL,"Invalid flag string: "+e);let t=e.includes("r")?JK:JE;return e.includes("w")&&(t|=eT),e.includes("a")&&(t|=Dm),e.includes("+")?t|=Zd:e.includes("r")||(t|=za),e.includes("s")&&(t|=tT),e.includes("x")&&(t|=QE),t}function pY(e){let t=0;return e&za||(t|=Xi),(e&za||e&Zd)&&(t|=ui),t}const xw=new Map;ZO("/",GSe.create({label:"root"}));function ZO(e,t){if(e[0]!="/"&&(e="/"+e),e=lf.call(this,e),xw.has(e))throw Bo(new Xe(vt.EINVAL,"Mount point is already in use: "+e));t._mountPoint=e,xw.set(e,t),ZK(`Mounted ${t.name} on ${e}`),Dx(`${t.name} attributes: ${[...t.attributes].map(([n,r])=>r!=null?n+"="+r:n).join(", ")}`)}function mY(e){if(e[0]!="/"&&(e="/"+e),e=lf.call(this,e),!xw.has(e)){Ua(e+" is already unmounted");return}xw.delete(e),VO("Unmounted "+e)}function jr(e,t){const n=(t==null?void 0:t.root)||Xc.root;e=$n(os(n,e));const r=[...xw].sort((s,i)=>s[0].length>i[0].length?-1:1);for(const[s,i]of r)if(JSe(s,e))return e=e.slice(s.length>1?s.length:0),e===""&&(e=n),{fs:i,path:e,mountPoint:s,root:n};throw lSe(new Xe(vt.EIO,"No file system",e))}function mI(e,t){for(const[n,r]of Object.entries(t))e=e==null?void 0:e.replaceAll(n,r);return e}function ps(e,t){typeof e.stack=="string"&&(e.stack=mI(e.stack,t));try{e.message=mI(e.message,t)}catch{}return e.path&&(e.path=mI(e.path,t)),e}function gY(e,t){const n=e.usage(),r=n.blockSize||4096;return{type:(t?BigInt:Number)(e.type),bsize:(t?BigInt:Number)(r),ffree:(t?BigInt:Number)(n.freeNodes||wo),files:(t?BigInt:Number)(n.totalNodes||wo),bavail:(t?BigInt:Number)(n.freeSpace/r),bfree:(t?BigInt:Number)(n.freeSpace/r),blocks:(t?BigInt:Number)(n.totalSpace/r)}}function XSe(e){var t,n,r,s,i,a,o;const l=this!==null&&this!==void 0?this:Xc;if(((t=l.credentials)===null||t===void 0?void 0:t.uid)!==0&&((n=l.credentials)===null||n===void 0?void 0:n.gid)!==0&&((r=l.credentials)===null||r===void 0?void 0:r.euid)!==0&&((s=l.credentials)===null||s===void 0?void 0:s.egid)!==0)throw new Xe(vt.EPERM,"Can not chroot() as non-root user");(i=l.root)!==null&&i!==void 0||(l.root="/");const c=os(l.root,e);for(const u of(o=(a=l.descriptors)===null||a===void 0?void 0:a.values())!==null&&o!==void 0?o:[]){if(!u.path.startsWith(l.root))throw Xe.With("EBUSY",u.path,"chroot");u.path=u.path.slice(l.root.length)}if(c.length>l.root.length)throw new Xe(vt.EPERM,"Can not chroot() outside of current root");l.root=c}function JSe(e,t){return e==="/"||e===t?!0:(e.endsWith("/")||(e+="/"),t.startsWith(e))}class yY extends FO{off(t,n,r,s){return super.off(t,n,r,s)}removeListener(t,n,r,s){return super.removeListener(t,n,r,s)}constructor(t,n){super(),this._context=t,this.path=n}setMaxListeners(){throw Xe.With("ENOSYS",this.path,"Watcher.setMaxListeners")}getMaxListeners(){throw Xe.With("ENOSYS",this.path,"Watcher.getMaxListeners")}prependListener(){throw Xe.With("ENOSYS",this.path,"Watcher.prependListener")}prependOnceListener(){throw Xe.With("ENOSYS",this.path,"Watcher.prependOnceListener")}rawListeners(){throw Xe.With("ENOSYS",this.path,"Watcher.rawListeners")}ref(){return this}unref(){return this}}class bY extends yY{constructor(t,n,r){super(t,n),this.options=r,this.realpath=t!=null&&t.root?os(t.root,n):n,e_e(this.realpath,this)}close(){super.emit("close"),t_e(this.realpath,this)}[Symbol.dispose](){this.close()}}class QSe extends yY{constructor(t,n,r){super(t,n),this.options=r,this.start()}onInterval(){try{const t=zh(this.path);jSe(this.previous,t)||(this.emit("change",t,this.previous),this.previous=t)}catch(t){this.emit("error",t)}}start(){const t=this.options.interval||5e3;try{this.previous=zh(this.path)}catch(n){this.emit("error",n);return}this.intervalId=setInterval(this.onInterval.bind(this),t),!this.options.persistent&&typeof this.intervalId=="object"&&this.intervalId.unref()}stop(){this.intervalId&&(clearInterval(this.intervalId),this.intervalId=void 0),this.removeAllListeners()}}const Ch=new Map;function e_e(e,t){const n=$n(e);Ch.has(n)||Ch.set(n,new Set),Ch.get(n).add(t)}function t_e(e,t){const n=$n(e);Ch.has(n)&&(Ch.get(n).delete(t),Ch.get(n).size===0&&Ch.delete(n))}function Na(e,t,n){var r;e&&(n=os((r=e.root)!==null&&r!==void 0?r:"/",n)),n=$n(n);for(let s=n;s!="/";s=Xr(s)){const i=Ch.get(s);if(i)for(const a of i)a.emit("change",t,YK.call(a._context,s,n)||vy(n))}}var P1=function(e,t,n){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var r,s;if(n){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=t[Symbol.asyncDispose]}if(r===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=t[Symbol.dispose],n&&(s=r)}if(typeof r!="function")throw new TypeError("Object not disposable.");s&&(r=function(){try{s.call(this)}catch(i){return Promise.reject(i)}}),e.stack.push({value:t,dispose:r,async:n})}else n&&e.stack.push({async:!0});return t},O1=function(e){return function(t){function n(a){t.error=t.hasError?new e(a,t.error,"An error was suppressed during disposal."):a,t.hasError=!0}var r,s=0;function i(){for(;r=t.stack.pop();)try{if(!r.async&&s===1)return s=0,t.stack.push(r),Promise.resolve().then(i);if(r.dispose){var a=r.dispose.call(r.value);if(r.async)return s|=2,Promise.resolve(a).then(i,function(o){return n(o),i()})}else s|=1}catch(o){n(o)}if(s===1)return t.hasError?Promise.reject(t.error):Promise.resolve();if(t.hasError)throw t.error}return i()}}(typeof SuppressedError=="function"?SuppressedError:function(e,t,n){var r=new Error(n);return r.name="SuppressedError",r.error=e,r.suppressed=t,r});function n_e(e,t){e=$n(e),t=$n(t);const n=jr(e,this),r=jr(t,this);if(!zh.call(this,Xr(e)).hasAccess(ui,this))throw Xe.With("EACCES",e,"rename");try{if(n===r){n.fs.renameSync(n.path,r.path),Na(this,"rename",e.toString()),Na(this,"change",t.toString());return}tD.call(this,t,eD(e)),QO.call(this,e),Na(this,"rename",e.toString())}catch(s){throw ps(s,{[n.path]:e,[r.path]:t})}}function XO(e){e=$n(e);try{const{fs:t,path:n}=jr(ap.call(this,e),this);return t.existsSync(n)}catch(t){if(t.errno==vt.ENOENT)return!1;throw t}}function zh(e,t){e=$n(e);const{fs:n,path:r}=jr(ap.call(this,e),this);try{const s=n.statSync(r);if(Ji&&!hs(this,s,Xi))throw Xe.With("EACCES",r,"stat");return t!=null&&t.bigint?new rg(s):new yf(s)}catch(s){throw ps(s,{[r]:e})}}function JO(e,t){e=$n(e);const{fs:n,path:r}=jr(e,this);try{const s=n.statSync(r);if(Ji&&!hs(this,s,Xi))throw Xe.With("EACCES",r,"lstat");return t!=null&&t.bigint?new rg(s):new yf(s)}catch(s){throw ps(s,{[r]:e})}}function r_e(e,t=0){const n={stack:[],error:void 0,hasError:!1};try{const r=P1(n,sg.call(this,e,{flag:"r+"}),!1);if(t||(t=0),t<0)throw new Xe(vt.EINVAL);r.truncate(t)}catch(r){n.error=r,n.hasError=!0}finally{O1(n)}}function QO(e){e=$n(e);const{fs:t,path:n}=jr(e,this);try{if(Ji&&!hs(this,t.statSync(n),ui))throw Xe.With("EACCES",n,"unlink");t.unlinkSync(n),Na(this,"rename",e.toString())}catch(r){throw ps(r,{[n]:e})}}function sg(e,t){var n;e=$n(e);const r=ip(t.mode,420),s=Jd(t.flag);e=t.preserveSymlinks?e:ap.call(this,e);const{fs:i,path:a}=jr(e,this);let o;try{o=i.statSync(a)}catch{}if(!o){if(!(s&JE))throw Xe.With("ENOENT",e,"_open");const c=i.statSync(Xr(a));if(!hs(this,c,ui))throw Xe.With("EACCES",Xr(e),"_open");if(!Gc(c))throw Xe.With("ENOTDIR",Xr(e),"_open");if(!t.allowDirectory&&r&Oi)throw Xe.With("EISDIR",e,"_open");if(!hs(this,c,ui))throw Xe.With("EACCES",Xr(a),"_open");const{euid:u,egid:d}=(n=this===null||this===void 0?void 0:this.credentials)!==null&&n!==void 0?n:Xc.credentials,h=i.createFileSync(a,{mode:r,uid:c.mode&M1?c.uid:u,gid:c.mode&j1?c.gid:d});return new nk(this,e,i,a,s,h)}if(!hs(this,o,r)||!hs(this,o,pY(s)))throw Xe.With("EACCES",e,"_open");if(s&QE)throw Xe.With("EEXIST",e,"_open");const l=new nk(this,e,i,a,s,o);if(s&eT&&l.truncate(0),!t.allowDirectory&&o.mode&Oi)throw Xe.With("EISDIR",e,"_open");return l}function nT(e,t,n=HO){return rk(sg.call(this,e,{flag:t,mode:n}))}function rT(e,t,n){return rk(sg.call(this,e,{flag:t,mode:n,preserveSymlinks:!0}))}function vY(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{const s=P1(r,typeof e=="number"?Ya(this,e):sg.call(this,e.toString(),{flag:t,mode:420,preserveSymlinks:n}),!1),{size:i}=s.stat(),a=new Uint8Array(i);return s.read(a,0,i,0),a}catch(s){r.error=s,r.hasError=!0}finally{O1(r)}}function eD(e,t={}){const n=Xd(t,null,"r",420);if(Jd(n.flag)&za)throw new Xe(vt.EINVAL,"Flag passed to readFile must allow for reading");const s=Fs.from(vY.call(this,e,n.flag,!1));return n.encoding?s.toString(n.encoding):s}function tD(e,t,n={}){const r={stack:[],error:void 0,hasError:!1};try{const s=Xd(n,"utf8","w+",420),i=Jd(s.flag);if(!(i&za||i&Zd))throw new Xe(vt.EINVAL,"Flag passed to writeFile must allow for writing");if(typeof t!="string"&&!s.encoding)throw new Xe(vt.EINVAL,"Encoding not specified");const a=typeof t=="string"?Fs.from(t,s.encoding):new Uint8Array(t.buffer,t.byteOffset,t.byteLength);if(!a)throw new Xe(vt.EINVAL,"Data not specified");P1(r,typeof e=="number"?Ya(this,e):sg.call(this,e.toString(),{flag:i,mode:s.mode,preserveSymlinks:!0}),!1).write(a,0,a.byteLength,0),Na(this,"change",e.toString())}catch(s){r.error=s,r.hasError=!0}finally{O1(r)}}function s_e(e,t,n={}){const r={stack:[],error:void 0,hasError:!1};try{const s=Xd(n,"utf8","a+",420),i=Jd(s.flag);if(!(i&Dm))throw new Xe(vt.EINVAL,"Flag passed to appendFile must allow for appending");if(typeof t!="string"&&!s.encoding)throw new Xe(vt.EINVAL,"Encoding not specified");const a=typeof t=="string"?Fs.from(t,s.encoding):new Uint8Array(t.buffer,t.byteOffset,t.byteLength);P1(r,sg.call(this,typeof e=="number"?Ya(this,e).path:e.toString(),{flag:i,mode:s.mode,preserveSymlinks:!0}),!1).write(a,0,a.byteLength)}catch(s){r.error=s,r.hasError=!0}finally{O1(r)}}function i_e(e,t){const n=Ya(this,e).stat();return t!=null&&t.bigint?new rg(n):new yf(n)}function ig(e){Ya(this,e).close(),hY(this,e)}function a_e(e,t=0){if(t||(t=0),t<0)throw new Xe(vt.EINVAL);Ya(this,e).truncate(t)}function o_e(e){Ya(this,e).sync()}function l_e(e){Ya(this,e).datasync()}function c_e(e,t,n,r,s){let i,a,o,l;if(typeof t=="string"){l=typeof n=="number"?n:null;const d=typeof r=="string"?r:"utf8";a=0,i=Fs.from(t,d),o=i.byteLength}else i=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),a=n,o=r,l=typeof s=="number"?s:null;const c=Ya(this,e);l??(l=c.position);const u=c.write(i,a,o,l);return Na(this,"change",c.path),u}function u_e(e,t,n,r,s){const i=Ya(this,e),a=typeof n=="object"?n.offset:n;return typeof n=="object"&&(r=n.length,s=n.position),s=Number(s),isNaN(s)&&(s=i.position),i.read(t,a,r,s)}function nD(e,t,n){Ya(this,e).chown(t,n)}function rD(e,t){const n=ip(t,-1);if(n<0)throw new Xe(vt.EINVAL,"Invalid mode.");Ya(this,e).chmod(n)}function sD(e,t,n){Ya(this,e).utimes(tk(t),tk(n))}function xY(e){e=$n(e);const{fs:t,path:n}=jr(ap.call(this,e),this);try{const r=t.statSync(n);if(!Gc(r))throw Xe.With("ENOTDIR",n,"rmdir");if(Ji&&!hs(this,r,ui))throw Xe.With("EACCES",n,"rmdir");t.rmdirSync(n),Na(this,"rename",e.toString())}catch(r){throw ps(r,{[n]:e})}}function iD(e,t){var n,r;const{euid:s,egid:i}=(n=this===null||this===void 0?void 0:this.credentials)!==null&&n!==void 0?n:Xc.credentials;t=typeof t=="object"?t:{mode:t};const a=ip(t==null?void 0:t.mode,511);e=ap.call(this,e);const{fs:o,path:l,root:c}=jr(e,this),u={[l]:e},d=(h,m)=>{if(!hs(this,m,ui))throw Xe.With("EACCES",Xr(h),"mkdir");const y=o.mkdirSync(h,{mode:a,uid:m.mode&M1?m.uid:s,gid:m.mode&j1?m.gid:i});return Na(this,"rename",h),y};try{if(!(t!=null&&t.recursive)){d(l,o.statSync(Xr(l)));return}const h=[];for(let y=l,b=e;!o.existsSync(y);y=Xr(y),b=Xr(b))h.unshift(y),u[y]=b;if(!h.length)return;const m=[o.statSync(Xr(h[0]))];for(const[y,b]of h.entries())m.push(d(b,m[y]));return c.length==1?h[0]:(r=h[0])===null||r===void 0?void 0:r.slice(c.length)}catch(h){throw ps(h,u)}}function ab(e,t){t=typeof t=="object"?t:{encoding:t},e=$n(e);const{fs:n,path:r}=jr(ap.call(this,e),this);let s;try{const a=n.statSync(r);if(Ji&&!hs(this,a,Xi))throw Xe.With("EACCES",r,"readdir");if(!Gc(a))throw Xe.With("ENOTDIR",r,"readdir");s=n.readdirSync(r)}catch(a){throw ps(a,{[r]:e})}const i=[];for(const a of s){let o;try{o=n.statSync(os(r,a))}catch{continue}if(t!=null&&t.withFileTypes?i.push(new ww(a,o)):(t==null?void 0:t.encoding)=="buffer"?i.push(Fs.from(a)):i.push(a),!(!Gc(o)||!(t!=null&&t.recursive)))for(const l of ab.call(this,os(e,a),t))l instanceof ww?(l.path=os(a,l.path),i.push(l)):Fs.isBuffer(l)?i.push(Fs.from(os(a,BO(l)))):i.push(os(a,l))}return i}function d_e(e,t){if(e=$n(e),!zh(Xr(e)).hasAccess(Xi,this))throw Xe.With("EACCES",Xr(e),"link");if(t=$n(t),!zh(Xr(t)).hasAccess(ui,this))throw Xe.With("EACCES",Xr(t),"link");const{fs:n,path:r}=jr(e,this),s=jr(t,this);if(n!=s.fs)throw Xe.With("EXDEV",t,"link");try{if(Ji&&!hs(this,n.statSync(r),Xi))throw Xe.With("EACCES",r,"link");return n.linkSync(r,s.path)}catch(i){throw ps(i,{[r]:e,[s.path]:t})}}function f_e(e,t,n="file"){const r={stack:[],error:void 0,hasError:!1};try{if(!["file","dir","junction"].includes(n))throw new Xe(vt.EINVAL,"Invalid type: "+n);t=$n(t);const s=P1(r,sg.call(this,t,{flag:"wx",mode:420}),!1);s.write(am($n(e,!0))),s.chmod(gf)}catch(s){r.error=s,r.hasError=!0}finally{O1(r)}}function z3(e,t){const n=Fs.from(vY.call(this,e,"r",!0)),r=typeof t=="object"?t==null?void 0:t.encoding:t;return r=="buffer"?n:n.toString(r??"utf-8")}function h_e(e,t,n){const r=nT.call(this,e,"r+");nD.call(this,r,t,n),ig.call(this,r)}function p_e(e,t,n){const r=rT.call(this,e,"r+");nD.call(this,r,t,n),ig.call(this,r)}function m_e(e,t){const n=nT.call(this,e,"r+");rD.call(this,n,t),ig.call(this,n)}function g_e(e,t){const n=rT.call(this,e,"r+");rD.call(this,n,t),ig.call(this,n)}function wY(e,t,n){const r=nT.call(this,e,"r+");sD.call(this,r,t,n),ig.call(this,r)}function y_e(e,t,n){const r=rT.call(this,e,"r+");sD.call(this,r,t,n),ig.call(this,r)}function U3(e,t,n){try{const l=jr(t,e),c=l.fs.statSync(l.path);if(!xy(c))return{...l,fullPath:t,stats:c};const u=lf.call(e,Xr(t),z3.call(e,t).toString());return U3(e,u)}catch{}const{base:r,dir:s}=vu(t),i=s=="/"?"/":ap.call(e,s),a=os(i,r),o=jr(a,e);try{const l=o.fs.statSync(o.path);if(!xy(l))return{...o,fullPath:a,stats:l};const c=lf.call(e,i,z3.call(e,a).toString());return U3(e,c)}catch(l){if(l.code=="ENOENT")return{...o,fullPath:t};throw ps(l,{[o.path]:a})}}function ap(e,t){var n;const r=typeof t=="string"?t:(n=t==null?void 0:t.encoding)!==null&&n!==void 0?n:"utf8";e=$n(e);const{fullPath:s}=U3(this,e);if(r=="utf8"||r=="utf-8")return s;const i=Fs.from(s,"utf-8");return r=="buffer"?i:i.toString(r)}function b_e(e,t=384){if(!hs(this,zh.call(this,e),t))throw new Xe(vt.EACCES)}function SY(e,t){e=$n(e);let n;try{n=JO.bind(this)(e)}catch(r){if(r.code!="ENOENT"||!(t!=null&&t.force))throw r}if(n)switch(n.mode&Es){case Oi:if(t!=null&&t.recursive)for(const r of ab.call(this,e))SY.call(this,os(e,r),t);xY.call(this,e);break;case Bc:case gf:case eg:case tg:QO.call(this,e);break;case ng:case Qm:default:throw new Xe(vt.EPERM,"File type not supported",e,"rm")}}function v_e(e,t){const n=typeof t=="object"?t==null?void 0:t.encoding:t||"utf8",s="/tmp/"+`${e}${Date.now()}-${Math.random().toString(36).slice(2)}`;return iD.call(this,s),n=="buffer"?Fs.from(s):s}function _Y(e,t,n){if(e=$n(e),t=$n(t),n&&n&GO&&XO(t))throw new Xe(vt.EEXIST,"Destination file already exists",t,"copyFile");tD.call(this,t,eD(e)),Na(this,"rename",t.toString())}function x_e(e,t,n){const r=Ya(this,e);let s=0;for(const i of t)s+=r.read(i,0,i.byteLength,n+s);return s}function w_e(e,t,n){const r=Ya(this,e);let s=0;for(const i of t)s+=r.write(new Uint8Array(i.buffer),0,i.byteLength,n+s);return s}function S_e(e,t){return e=$n(e),new aD(e,this)}function CY(e,t,n){e=$n(e),t=$n(t);const r=JO.call(this,e);if(n!=null&&n.errorOnExist&&XO.call(this,t))throw new Xe(vt.EEXIST,"Destination file or directory already exists",t,"cp");switch(r.mode&Es){case Oi:if(!(n!=null&&n.recursive))throw new Xe(vt.EISDIR,e+" is a directory (not copied)",e,"cp");iD.call(this,t,{recursive:!0});for(const s of ab.call(this,e,{withFileTypes:!0}))n.filter&&!n.filter(os(e,s.name),os(t,s.name))||CY.call(this,os(e,s.name),os(t,s.name),n);break;case Bc:case gf:_Y.call(this,e,t);break;case eg:case tg:case ng:case Qm:default:throw new Xe(vt.EPERM,"File type not supported",e,"rm")}n!=null&&n.preserveTimestamps&&wY.call(this,t,r.atime,r.mtime)}function __e(e,t){e=$n(e);const{fs:n}=jr(e,this);return gY(n,t==null?void 0:t.bigint)}function C_e(e,t={}){e=Array.isArray(e)?e:[e];const{cwd:n="/",withFileTypes:r=!1,exclude:s=()=>!1}=t,i=e.map(l=>(l=l.replace(/([.?+^$(){}|[\]/])/g,"\\$1").replace(/\*\*/g,".*").replace(/\*/g,"[^/]*").replace(/\?/g,"."),new RegExp(`^${l}$`))),a=[];function o(l){const c=ab(l,{withFileTypes:r,encoding:"utf8"});for(const u of c){const d=r?u.path:l+"/"+u;s(r?u:d)||(zh(d).isDirectory()&&i.some(h=>h.source.includes(".*"))&&o(d),i.some(h=>h.test(d.replace(/^\/+/g,"")))&&a.push(r?u.path:d.replace(/^\/+/g,"")))}}return o(n),a}class ww{get name(){return vy(this.path)}constructor(t,n){this.path=t,this.stats=n}get parentPath(){return this.path}isFile(){return LSe(this.stats)}isDirectory(){return Gc(this.stats)}isBlockDevice(){return bw(this.stats)}isCharacterDevice(){return vw(this.stats)}isSymbolicLink(){return xy(this.stats)}isFIFO(){return $Se(this.stats)}isSocket(){return BSe(this.stats)}}class aD{checkClosed(){if(this.closed)throw new Xe(vt.EBADF,"Can not use closed Dir")}constructor(t,n){this.path=t,this.context=n,this.closed=!1}close(t){if(this.closed=!0,!t)return Promise.resolve();t()}closeSync(){this.closed=!0}async _read(){var t,n;return this.checkClosed(),(t=this._entries)!==null&&t!==void 0||(this._entries=await og.call(this.context,this.path,{withFileTypes:!0})),this._entries.length&&(n=this._entries.shift())!==null&&n!==void 0?n:null}read(t){if(!t)return this._read();this._read().then(n=>t(void 0,n))}readSync(){var t,n;return this.checkClosed(),(t=this._entries)!==null&&t!==void 0||(this._entries=ab.call(this.context,this.path,{withFileTypes:!0})),this._entries.length&&(n=this._entries.shift())!==null&&n!==void 0?n:null}async next(){const t=await this._read();return t?{done:!1,value:t}:(await this.close(),{done:!0,value:void 0})}[Symbol.asyncIterator](){return this}[Symbol.asyncDispose](){return Promise.resolve()}}var gI={exports:{}},yI={exports:{}},bI={},gz;function op(){return gz||(gz=1,function(e){Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});var t={},n={};n.byteLength=u,n.toByteArray=h,n.fromByteArray=b;for(var r=[],s=[],i=typeof Uint8Array<"u"?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,l=a.length;o<l;++o)r[o]=a[o],s[a.charCodeAt(o)]=o;s[45]=62,s[95]=63;function c(w){var _=w.length;if(_%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var k=w.indexOf("=");k===-1&&(k=_);var C=k===_?0:4-k%4;return[k,C]}function u(w){var _=c(w),k=_[0],C=_[1];return(k+C)*3/4-C}function d(w,_,k){return(_+k)*3/4-k}function h(w){var _,k=c(w),C=k[0],T=k[1],A=new i(d(w,C,T)),N=0,I=T>0?C-4:C,j;for(j=0;j<I;j+=4)_=s[w.charCodeAt(j)]<<18|s[w.charCodeAt(j+1)]<<12|s[w.charCodeAt(j+2)]<<6|s[w.charCodeAt(j+3)],A[N++]=_>>16&255,A[N++]=_>>8&255,A[N++]=_&255;return T===2&&(_=s[w.charCodeAt(j)]<<2|s[w.charCodeAt(j+1)]>>4,A[N++]=_&255),T===1&&(_=s[w.charCodeAt(j)]<<10|s[w.charCodeAt(j+1)]<<4|s[w.charCodeAt(j+2)]>>2,A[N++]=_>>8&255,A[N++]=_&255),A}function m(w){return r[w>>18&63]+r[w>>12&63]+r[w>>6&63]+r[w&63]}function y(w,_,k){for(var C,T=[],A=_;A<k;A+=3)C=(w[A]<<16&16711680)+(w[A+1]<<8&65280)+(w[A+2]&255),T.push(m(C));return T.join("")}function b(w){for(var _,k=w.length,C=k%3,T=[],A=16383,N=0,I=k-C;N<I;N+=A)T.push(y(w,N,N+A>I?I:N+A));return C===1?(_=w[k-1],T.push(r[_>>2]+r[_<<4&63]+"==")):C===2&&(_=(w[k-2]<<8)+w[k-1],T.push(r[_>>10]+r[_>>4&63]+r[_<<2&63]+"=")),T.join("")}var v={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */v.read=function(w,_,k,C,T){var A,N,I=T*8-C-1,j=(1<<I)-1,L=j>>1,D=-7,H=k?T-1:0,O=k?-1:1,K=w[_+H];for(H+=O,A=K&(1<<-D)-1,K>>=-D,D+=I;D>0;A=A*256+w[_+H],H+=O,D-=8);for(N=A&(1<<-D)-1,A>>=-D,D+=C;D>0;N=N*256+w[_+H],H+=O,D-=8);if(A===0)A=1-L;else{if(A===j)return N?NaN:(K?-1:1)*(1/0);N=N+Math.pow(2,C),A=A-L}return(K?-1:1)*N*Math.pow(2,A-C)},v.write=function(w,_,k,C,T,A){var N,I,j,L=A*8-T-1,D=(1<<L)-1,H=D>>1,O=T===23?Math.pow(2,-24)-Math.pow(2,-77):0,K=C?0:A-1,U=C?1:-1,W=_<0||_===0&&1/_<0?1:0;for(_=Math.abs(_),isNaN(_)||_===1/0?(I=isNaN(_)?1:0,N=D):(N=Math.floor(Math.log(_)/Math.LN2),_*(j=Math.pow(2,-N))<1&&(N--,j*=2),N+H>=1?_+=O/j:_+=O*Math.pow(2,1-H),_*j>=2&&(N++,j/=2),N+H>=D?(I=0,N=D):N+H>=1?(I=(_*j-1)*Math.pow(2,T),N=N+H):(I=_*Math.pow(2,H-1)*Math.pow(2,T),N=0));T>=8;w[k+K]=I&255,K+=U,I/=256,T-=8);for(N=N<<T|I,L+=T;L>0;w[k+K]=N&255,K+=U,N/=256,L-=8);w[k+K-U]|=W*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(w){const _=n,k=v,C=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;w.Buffer=D,w.SlowBuffer=re,w.INSPECT_MAX_BYTES=50;const T=2147483647;w.kMaxLength=T;const{Uint8Array:A,ArrayBuffer:N,SharedArrayBuffer:I}=globalThis;D.TYPED_ARRAY_SUPPORT=j(),!D.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function j(){try{const Z=new A(1),G={foo:function(){return 42}};return Object.setPrototypeOf(G,A.prototype),Object.setPrototypeOf(Z,G),Z.foo()===42}catch{return!1}}Object.defineProperty(D.prototype,"parent",{enumerable:!0,get:function(){if(D.isBuffer(this))return this.buffer}}),Object.defineProperty(D.prototype,"offset",{enumerable:!0,get:function(){if(D.isBuffer(this))return this.byteOffset}});function L(Z){if(Z>T)throw new RangeError('The value "'+Z+'" is invalid for option "size"');const G=new A(Z);return Object.setPrototypeOf(G,D.prototype),G}function D(Z,G,J){if(typeof Z=="number"){if(typeof G=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return U(Z)}return H(Z,G,J)}D.poolSize=8192;function H(Z,G,J){if(typeof Z=="string")return W(Z,G);if(N.isView(Z))return ne(Z);if(Z==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof Z);if(ve(Z,N)||Z&&ve(Z.buffer,N)||typeof I<"u"&&(ve(Z,I)||Z&&ve(Z.buffer,I)))return V(Z,G,J);if(typeof Z=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const xe=Z.valueOf&&Z.valueOf();if(xe!=null&&xe!==Z)return D.from(xe,G,J);const Fe=Q(Z);if(Fe)return Fe;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof Z[Symbol.toPrimitive]=="function")return D.from(Z[Symbol.toPrimitive]("string"),G,J);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof Z)}D.from=function(Z,G,J){return H(Z,G,J)},Object.setPrototypeOf(D.prototype,A.prototype),Object.setPrototypeOf(D,A);function O(Z){if(typeof Z!="number")throw new TypeError('"size" argument must be of type number');if(Z<0)throw new RangeError('The value "'+Z+'" is invalid for option "size"')}function K(Z,G,J){return O(Z),Z<=0?L(Z):G!==void 0?typeof J=="string"?L(Z).fill(G,J):L(Z).fill(G):L(Z)}D.alloc=function(Z,G,J){return K(Z,G,J)};function U(Z){return O(Z),L(Z<0?0:ee(Z)|0)}D.allocUnsafe=function(Z){return U(Z)},D.allocUnsafeSlow=function(Z){return U(Z)};function W(Z,G){if((typeof G!="string"||G==="")&&(G="utf8"),!D.isEncoding(G))throw new TypeError("Unknown encoding: "+G);const J=de(Z,G)|0;let xe=L(J);const Fe=xe.write(Z,G);return Fe!==J&&(xe=xe.slice(0,Fe)),xe}function B(Z){const G=Z.length<0?0:ee(Z.length)|0,J=L(G);for(let xe=0;xe<G;xe+=1)J[xe]=Z[xe]&255;return J}function ne(Z){if(ve(Z,A)){const G=new A(Z);return V(G.buffer,G.byteOffset,G.byteLength)}return B(Z)}function V(Z,G,J){if(G<0||Z.byteLength<G)throw new RangeError('"offset" is outside of buffer bounds');if(Z.byteLength<G+(J||0))throw new RangeError('"length" is outside of buffer bounds');let xe;return G===void 0&&J===void 0?xe=new A(Z):J===void 0?xe=new A(Z,G):xe=new A(Z,G,J),Object.setPrototypeOf(xe,D.prototype),xe}function Q(Z){if(D.isBuffer(Z)){const G=ee(Z.length)|0,J=L(G);return J.length===0||Z.copy(J,0,0,G),J}if(Z.length!==void 0)return typeof Z.length!="number"||Se(Z.length)?L(0):B(Z);if(Z.type==="Buffer"&&Array.isArray(Z.data))return B(Z.data)}function ee(Z){if(Z>=T)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+T.toString(16)+" bytes");return Z|0}function re(Z){return+Z!=Z&&(Z=0),D.alloc(+Z)}D.isBuffer=function(G){return G!=null&&G._isBuffer===!0&&G!==D.prototype},D.compare=function(G,J){if(ve(G,A)&&(G=D.from(G,G.offset,G.byteLength)),ve(J,A)&&(J=D.from(J,J.offset,J.byteLength)),!D.isBuffer(G)||!D.isBuffer(J))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(G===J)return 0;let xe=G.length,Fe=J.length;for(let He=0,wt=Math.min(xe,Fe);He<wt;++He)if(G[He]!==J[He]){xe=G[He],Fe=J[He];break}return xe<Fe?-1:Fe<xe?1:0},D.isEncoding=function(G){switch(String(G).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},D.concat=function(G,J){if(!Array.isArray(G))throw new TypeError('"list" argument must be an Array of Buffers');if(G.length===0)return D.alloc(0);let xe;if(J===void 0)for(J=0,xe=0;xe<G.length;++xe)J+=G[xe].length;const Fe=D.allocUnsafe(J);let He=0;for(xe=0;xe<G.length;++xe){let wt=G[xe];if(ve(wt,A))He+wt.length>Fe.length?(D.isBuffer(wt)||(wt=D.from(wt)),wt.copy(Fe,He)):A.prototype.set.call(Fe,wt,He);else if(D.isBuffer(wt))wt.copy(Fe,He);else throw new TypeError('"list" argument must be an Array of Buffers');He+=wt.length}return Fe};function de(Z,G){if(D.isBuffer(Z))return Z.length;if(N.isView(Z)||ve(Z,N))return Z.byteLength;if(typeof Z!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof Z);const J=Z.length,xe=arguments.length>2&&arguments[2]===!0;if(!xe&&J===0)return 0;let Fe=!1;for(;;)switch(G){case"ascii":case"latin1":case"binary":return J;case"utf8":case"utf-8":return ft(Z).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return J*2;case"hex":return J>>>1;case"base64":return qe(Z).length;default:if(Fe)return xe?-1:ft(Z).length;G=(""+G).toLowerCase(),Fe=!0}}D.byteLength=de;function me(Z,G,J){let xe=!1;if((G===void 0||G<0)&&(G=0),G>this.length||((J===void 0||J>this.length)&&(J=this.length),J<=0)||(J>>>=0,G>>>=0,J<=G))return"";for(Z||(Z="utf8");;)switch(Z){case"hex":return Ie(this,G,J);case"utf8":case"utf-8":return ye(this,G,J);case"ascii":return oe(this,G,J);case"latin1":case"binary":return se(this,G,J);case"base64":return Y(this,G,J);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Be(this,G,J);default:if(xe)throw new TypeError("Unknown encoding: "+Z);Z=(Z+"").toLowerCase(),xe=!0}}D.prototype._isBuffer=!0;function De(Z,G,J){const xe=Z[G];Z[G]=Z[J],Z[J]=xe}D.prototype.swap16=function(){const G=this.length;if(G%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let J=0;J<G;J+=2)De(this,J,J+1);return this},D.prototype.swap32=function(){const G=this.length;if(G%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let J=0;J<G;J+=4)De(this,J,J+3),De(this,J+1,J+2);return this},D.prototype.swap64=function(){const G=this.length;if(G%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let J=0;J<G;J+=8)De(this,J,J+7),De(this,J+1,J+6),De(this,J+2,J+5),De(this,J+3,J+4);return this},D.prototype.toString=function(){const G=this.length;return G===0?"":arguments.length===0?ye(this,0,G):me.apply(this,arguments)},D.prototype.toLocaleString=D.prototype.toString,D.prototype.equals=function(G){if(!D.isBuffer(G))throw new TypeError("Argument must be a Buffer");return this===G?!0:D.compare(this,G)===0},D.prototype.inspect=function(){let G="";const J=w.INSPECT_MAX_BYTES;return G=this.toString("hex",0,J).replace(/(.{2})/g,"$1 ").trim(),this.length>J&&(G+=" ... "),"<Buffer "+G+">"},C&&(D.prototype[C]=D.prototype.inspect),D.prototype.compare=function(G,J,xe,Fe,He){if(ve(G,A)&&(G=D.from(G,G.offset,G.byteLength)),!D.isBuffer(G))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof G);if(J===void 0&&(J=0),xe===void 0&&(xe=G?G.length:0),Fe===void 0&&(Fe=0),He===void 0&&(He=this.length),J<0||xe>G.length||Fe<0||He>this.length)throw new RangeError("out of range index");if(Fe>=He&&J>=xe)return 0;if(Fe>=He)return-1;if(J>=xe)return 1;if(J>>>=0,xe>>>=0,Fe>>>=0,He>>>=0,this===G)return 0;let wt=He-Fe,Qt=xe-J;const Dn=Math.min(wt,Qt),Zt=this.slice(Fe,He),rn=G.slice(J,xe);for(let fn=0;fn<Dn;++fn)if(Zt[fn]!==rn[fn]){wt=Zt[fn],Qt=rn[fn];break}return wt<Qt?-1:Qt<wt?1:0};function je(Z,G,J,xe,Fe){if(Z.length===0)return-1;if(typeof J=="string"?(xe=J,J=0):J>2147483647?J=2147483647:J<-2147483648&&(J=-2147483648),J=+J,Se(J)&&(J=Fe?0:Z.length-1),J<0&&(J=Z.length+J),J>=Z.length){if(Fe)return-1;J=Z.length-1}else if(J<0)if(Fe)J=0;else return-1;if(typeof G=="string"&&(G=D.from(G,xe)),D.isBuffer(G))return G.length===0?-1:Te(Z,G,J,xe,Fe);if(typeof G=="number")return G=G&255,typeof A.prototype.indexOf=="function"?Fe?A.prototype.indexOf.call(Z,G,J):A.prototype.lastIndexOf.call(Z,G,J):Te(Z,[G],J,xe,Fe);throw new TypeError("val must be string, number or Buffer")}function Te(Z,G,J,xe,Fe){let He=1,wt=Z.length,Qt=G.length;if(xe!==void 0&&(xe=String(xe).toLowerCase(),xe==="ucs2"||xe==="ucs-2"||xe==="utf16le"||xe==="utf-16le")){if(Z.length<2||G.length<2)return-1;He=2,wt/=2,Qt/=2,J/=2}function Dn(rn,fn){return He===1?rn[fn]:rn.readUInt16BE(fn*He)}let Zt;if(Fe){let rn=-1;for(Zt=J;Zt<wt;Zt++)if(Dn(Z,Zt)===Dn(G,rn===-1?0:Zt-rn)){if(rn===-1&&(rn=Zt),Zt-rn+1===Qt)return rn*He}else rn!==-1&&(Zt-=Zt-rn),rn=-1}else for(J+Qt>wt&&(J=wt-Qt),Zt=J;Zt>=0;Zt--){let rn=!0;for(let fn=0;fn<Qt;fn++)if(Dn(Z,Zt+fn)!==Dn(G,fn)){rn=!1;break}if(rn)return Zt}return-1}D.prototype.includes=function(G,J,xe){return this.indexOf(G,J,xe)!==-1},D.prototype.indexOf=function(G,J,xe){return je(this,G,J,xe,!0)},D.prototype.lastIndexOf=function(G,J,xe){return je(this,G,J,xe,!1)};function _e(Z,G,J,xe){J=Number(J)||0;const Fe=Z.length-J;xe?(xe=Number(xe),xe>Fe&&(xe=Fe)):xe=Fe;const He=G.length;xe>He/2&&(xe=He/2);let wt;for(wt=0;wt<xe;++wt){const Qt=parseInt(G.substr(wt*2,2),16);if(Se(Qt))return wt;Z[J+wt]=Qt}return wt}function Ue(Z,G,J,xe){return tt(ft(G,Z.length-J),Z,J,xe)}function Qe(Z,G,J,xe){return tt(et(G),Z,J,xe)}function We(Z,G,J,xe){return tt(qe(G),Z,J,xe)}function Pe(Z,G,J,xe){return tt($(G,Z.length-J),Z,J,xe)}D.prototype.write=function(G,J,xe,Fe){if(J===void 0)Fe="utf8",xe=this.length,J=0;else if(xe===void 0&&typeof J=="string")Fe=J,xe=this.length,J=0;else if(isFinite(J))J=J>>>0,isFinite(xe)?(xe=xe>>>0,Fe===void 0&&(Fe="utf8")):(Fe=xe,xe=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const He=this.length-J;if((xe===void 0||xe>He)&&(xe=He),G.length>0&&(xe<0||J<0)||J>this.length)throw new RangeError("Attempt to write outside buffer bounds");Fe||(Fe="utf8");let wt=!1;for(;;)switch(Fe){case"hex":return _e(this,G,J,xe);case"utf8":case"utf-8":return Ue(this,G,J,xe);case"ascii":case"latin1":case"binary":return Qe(this,G,J,xe);case"base64":return We(this,G,J,xe);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Pe(this,G,J,xe);default:if(wt)throw new TypeError("Unknown encoding: "+Fe);Fe=(""+Fe).toLowerCase(),wt=!0}},D.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function Y(Z,G,J){return G===0&&J===Z.length?_.fromByteArray(Z):_.fromByteArray(Z.slice(G,J))}function ye(Z,G,J){J=Math.min(Z.length,J);const xe=[];let Fe=G;for(;Fe<J;){const He=Z[Fe];let wt=null,Qt=He>239?4:He>223?3:He>191?2:1;if(Fe+Qt<=J){let Dn,Zt,rn,fn;switch(Qt){case 1:He<128&&(wt=He);break;case 2:Dn=Z[Fe+1],(Dn&192)===128&&(fn=(He&31)<<6|Dn&63,fn>127&&(wt=fn));break;case 3:Dn=Z[Fe+1],Zt=Z[Fe+2],(Dn&192)===128&&(Zt&192)===128&&(fn=(He&15)<<12|(Dn&63)<<6|Zt&63,fn>2047&&(fn<55296||fn>57343)&&(wt=fn));break;case 4:Dn=Z[Fe+1],Zt=Z[Fe+2],rn=Z[Fe+3],(Dn&192)===128&&(Zt&192)===128&&(rn&192)===128&&(fn=(He&15)<<18|(Dn&63)<<12|(Zt&63)<<6|rn&63,fn>65535&&fn<1114112&&(wt=fn))}}wt===null?(wt=65533,Qt=1):wt>65535&&(wt-=65536,xe.push(wt>>>10&1023|55296),wt=56320|wt&1023),xe.push(wt),Fe+=Qt}return ue(xe)}const Me=4096;function ue(Z){const G=Z.length;if(G<=Me)return String.fromCharCode.apply(String,Z);let J="",xe=0;for(;xe<G;)J+=String.fromCharCode.apply(String,Z.slice(xe,xe+=Me));return J}function oe(Z,G,J){let xe="";J=Math.min(Z.length,J);for(let Fe=G;Fe<J;++Fe)xe+=String.fromCharCode(Z[Fe]&127);return xe}function se(Z,G,J){let xe="";J=Math.min(Z.length,J);for(let Fe=G;Fe<J;++Fe)xe+=String.fromCharCode(Z[Fe]);return xe}function Ie(Z,G,J){const xe=Z.length;(!G||G<0)&&(G=0),(!J||J<0||J>xe)&&(J=xe);let Fe="";for(let He=G;He<J;++He)Fe+=ze[Z[He]];return Fe}function Be(Z,G,J){const xe=Z.slice(G,J);let Fe="";for(let He=0;He<xe.length-1;He+=2)Fe+=String.fromCharCode(xe[He]+xe[He+1]*256);return Fe}D.prototype.slice=function(G,J){const xe=this.length;G=~~G,J=J===void 0?xe:~~J,G<0?(G+=xe,G<0&&(G=0)):G>xe&&(G=xe),J<0?(J+=xe,J<0&&(J=0)):J>xe&&(J=xe),J<G&&(J=G);const Fe=this.subarray(G,J);return Object.setPrototypeOf(Fe,D.prototype),Fe};function Re(Z,G,J){if(Z%1!==0||Z<0)throw new RangeError("offset is not uint");if(Z+G>J)throw new RangeError("Trying to access beyond buffer length")}D.prototype.readUintLE=D.prototype.readUIntLE=function(G,J,xe){G=G>>>0,J=J>>>0,xe||Re(G,J,this.length);let Fe=this[G],He=1,wt=0;for(;++wt<J&&(He*=256);)Fe+=this[G+wt]*He;return Fe},D.prototype.readUintBE=D.prototype.readUIntBE=function(G,J,xe){G=G>>>0,J=J>>>0,xe||Re(G,J,this.length);let Fe=this[G+--J],He=1;for(;J>0&&(He*=256);)Fe+=this[G+--J]*He;return Fe},D.prototype.readUint8=D.prototype.readUInt8=function(G,J){return G=G>>>0,J||Re(G,1,this.length),this[G]},D.prototype.readUint16LE=D.prototype.readUInt16LE=function(G,J){return G=G>>>0,J||Re(G,2,this.length),this[G]|this[G+1]<<8},D.prototype.readUint16BE=D.prototype.readUInt16BE=function(G,J){return G=G>>>0,J||Re(G,2,this.length),this[G]<<8|this[G+1]},D.prototype.readUint32LE=D.prototype.readUInt32LE=function(G,J){return G=G>>>0,J||Re(G,4,this.length),(this[G]|this[G+1]<<8|this[G+2]<<16)+this[G+3]*16777216},D.prototype.readUint32BE=D.prototype.readUInt32BE=function(G,J){return G=G>>>0,J||Re(G,4,this.length),this[G]*16777216+(this[G+1]<<16|this[G+2]<<8|this[G+3])},D.prototype.readBigUInt64LE=Ct(function(G){G=G>>>0,Ee(G,"offset");const J=this[G],xe=this[G+7];(J===void 0||xe===void 0)&&ge(G,this.length-8);const Fe=J+this[++G]*2**8+this[++G]*2**16+this[++G]*2**24,He=this[++G]+this[++G]*2**8+this[++G]*2**16+xe*2**24;return BigInt(Fe)+(BigInt(He)<<BigInt(32))}),D.prototype.readBigUInt64BE=Ct(function(G){G=G>>>0,Ee(G,"offset");const J=this[G],xe=this[G+7];(J===void 0||xe===void 0)&&ge(G,this.length-8);const Fe=J*2**24+this[++G]*2**16+this[++G]*2**8+this[++G],He=this[++G]*2**24+this[++G]*2**16+this[++G]*2**8+xe;return(BigInt(Fe)<<BigInt(32))+BigInt(He)}),D.prototype.readIntLE=function(G,J,xe){G=G>>>0,J=J>>>0,xe||Re(G,J,this.length);let Fe=this[G],He=1,wt=0;for(;++wt<J&&(He*=256);)Fe+=this[G+wt]*He;return He*=128,Fe>=He&&(Fe-=Math.pow(2,8*J)),Fe},D.prototype.readIntBE=function(G,J,xe){G=G>>>0,J=J>>>0,xe||Re(G,J,this.length);let Fe=J,He=1,wt=this[G+--Fe];for(;Fe>0&&(He*=256);)wt+=this[G+--Fe]*He;return He*=128,wt>=He&&(wt-=Math.pow(2,8*J)),wt},D.prototype.readInt8=function(G,J){return G=G>>>0,J||Re(G,1,this.length),this[G]&128?(255-this[G]+1)*-1:this[G]},D.prototype.readInt16LE=function(G,J){G=G>>>0,J||Re(G,2,this.length);const xe=this[G]|this[G+1]<<8;return xe&32768?xe|4294901760:xe},D.prototype.readInt16BE=function(G,J){G=G>>>0,J||Re(G,2,this.length);const xe=this[G+1]|this[G]<<8;return xe&32768?xe|4294901760:xe},D.prototype.readInt32LE=function(G,J){return G=G>>>0,J||Re(G,4,this.length),this[G]|this[G+1]<<8|this[G+2]<<16|this[G+3]<<24},D.prototype.readInt32BE=function(G,J){return G=G>>>0,J||Re(G,4,this.length),this[G]<<24|this[G+1]<<16|this[G+2]<<8|this[G+3]},D.prototype.readBigInt64LE=Ct(function(G){G=G>>>0,Ee(G,"offset");const J=this[G],xe=this[G+7];(J===void 0||xe===void 0)&&ge(G,this.length-8);const Fe=this[G+4]+this[G+5]*2**8+this[G+6]*2**16+(xe<<24);return(BigInt(Fe)<<BigInt(32))+BigInt(J+this[++G]*2**8+this[++G]*2**16+this[++G]*2**24)}),D.prototype.readBigInt64BE=Ct(function(G){G=G>>>0,Ee(G,"offset");const J=this[G],xe=this[G+7];(J===void 0||xe===void 0)&&ge(G,this.length-8);const Fe=(J<<24)+this[++G]*2**16+this[++G]*2**8+this[++G];return(BigInt(Fe)<<BigInt(32))+BigInt(this[++G]*2**24+this[++G]*2**16+this[++G]*2**8+xe)}),D.prototype.readFloatLE=function(G,J){return G=G>>>0,J||Re(G,4,this.length),k.read(this,G,!0,23,4)},D.prototype.readFloatBE=function(G,J){return G=G>>>0,J||Re(G,4,this.length),k.read(this,G,!1,23,4)},D.prototype.readDoubleLE=function(G,J){return G=G>>>0,J||Re(G,8,this.length),k.read(this,G,!0,52,8)},D.prototype.readDoubleBE=function(G,J){return G=G>>>0,J||Re(G,8,this.length),k.read(this,G,!1,52,8)};function ct(Z,G,J,xe,Fe,He){if(!D.isBuffer(Z))throw new TypeError('"buffer" argument must be a Buffer instance');if(G>Fe||G<He)throw new RangeError('"value" argument is out of bounds');if(J+xe>Z.length)throw new RangeError("Index out of range")}D.prototype.writeUintLE=D.prototype.writeUIntLE=function(G,J,xe,Fe){if(G=+G,J=J>>>0,xe=xe>>>0,!Fe){const Qt=Math.pow(2,8*xe)-1;ct(this,G,J,xe,Qt,0)}let He=1,wt=0;for(this[J]=G&255;++wt<xe&&(He*=256);)this[J+wt]=G/He&255;return J+xe},D.prototype.writeUintBE=D.prototype.writeUIntBE=function(G,J,xe,Fe){if(G=+G,J=J>>>0,xe=xe>>>0,!Fe){const Qt=Math.pow(2,8*xe)-1;ct(this,G,J,xe,Qt,0)}let He=xe-1,wt=1;for(this[J+He]=G&255;--He>=0&&(wt*=256);)this[J+He]=G/wt&255;return J+xe},D.prototype.writeUint8=D.prototype.writeUInt8=function(G,J,xe){return G=+G,J=J>>>0,xe||ct(this,G,J,1,255,0),this[J]=G&255,J+1},D.prototype.writeUint16LE=D.prototype.writeUInt16LE=function(G,J,xe){return G=+G,J=J>>>0,xe||ct(this,G,J,2,65535,0),this[J]=G&255,this[J+1]=G>>>8,J+2},D.prototype.writeUint16BE=D.prototype.writeUInt16BE=function(G,J,xe){return G=+G,J=J>>>0,xe||ct(this,G,J,2,65535,0),this[J]=G>>>8,this[J+1]=G&255,J+2},D.prototype.writeUint32LE=D.prototype.writeUInt32LE=function(G,J,xe){return G=+G,J=J>>>0,xe||ct(this,G,J,4,4294967295,0),this[J+3]=G>>>24,this[J+2]=G>>>16,this[J+1]=G>>>8,this[J]=G&255,J+4},D.prototype.writeUint32BE=D.prototype.writeUInt32BE=function(G,J,xe){return G=+G,J=J>>>0,xe||ct(this,G,J,4,4294967295,0),this[J]=G>>>24,this[J+1]=G>>>16,this[J+2]=G>>>8,this[J+3]=G&255,J+4};function At(Z,G,J,xe,Fe){be(G,xe,Fe,Z,J,7);let He=Number(G&BigInt(4294967295));Z[J++]=He,He=He>>8,Z[J++]=He,He=He>>8,Z[J++]=He,He=He>>8,Z[J++]=He;let wt=Number(G>>BigInt(32)&BigInt(4294967295));return Z[J++]=wt,wt=wt>>8,Z[J++]=wt,wt=wt>>8,Z[J++]=wt,wt=wt>>8,Z[J++]=wt,J}function ut(Z,G,J,xe,Fe){be(G,xe,Fe,Z,J,7);let He=Number(G&BigInt(4294967295));Z[J+7]=He,He=He>>8,Z[J+6]=He,He=He>>8,Z[J+5]=He,He=He>>8,Z[J+4]=He;let wt=Number(G>>BigInt(32)&BigInt(4294967295));return Z[J+3]=wt,wt=wt>>8,Z[J+2]=wt,wt=wt>>8,Z[J+1]=wt,wt=wt>>8,Z[J]=wt,J+8}D.prototype.writeBigUInt64LE=Ct(function(G,J=0){return At(this,G,J,BigInt(0),BigInt("0xffffffffffffffff"))}),D.prototype.writeBigUInt64BE=Ct(function(G,J=0){return ut(this,G,J,BigInt(0),BigInt("0xffffffffffffffff"))}),D.prototype.writeIntLE=function(G,J,xe,Fe){if(G=+G,J=J>>>0,!Fe){const Dn=Math.pow(2,8*xe-1);ct(this,G,J,xe,Dn-1,-Dn)}let He=0,wt=1,Qt=0;for(this[J]=G&255;++He<xe&&(wt*=256);)G<0&&Qt===0&&this[J+He-1]!==0&&(Qt=1),this[J+He]=(G/wt>>0)-Qt&255;return J+xe},D.prototype.writeIntBE=function(G,J,xe,Fe){if(G=+G,J=J>>>0,!Fe){const Dn=Math.pow(2,8*xe-1);ct(this,G,J,xe,Dn-1,-Dn)}let He=xe-1,wt=1,Qt=0;for(this[J+He]=G&255;--He>=0&&(wt*=256);)G<0&&Qt===0&&this[J+He+1]!==0&&(Qt=1),this[J+He]=(G/wt>>0)-Qt&255;return J+xe},D.prototype.writeInt8=function(G,J,xe){return G=+G,J=J>>>0,xe||ct(this,G,J,1,127,-128),G<0&&(G=255+G+1),this[J]=G&255,J+1},D.prototype.writeInt16LE=function(G,J,xe){return G=+G,J=J>>>0,xe||ct(this,G,J,2,32767,-32768),this[J]=G&255,this[J+1]=G>>>8,J+2},D.prototype.writeInt16BE=function(G,J,xe){return G=+G,J=J>>>0,xe||ct(this,G,J,2,32767,-32768),this[J]=G>>>8,this[J+1]=G&255,J+2},D.prototype.writeInt32LE=function(G,J,xe){return G=+G,J=J>>>0,xe||ct(this,G,J,4,2147483647,-2147483648),this[J]=G&255,this[J+1]=G>>>8,this[J+2]=G>>>16,this[J+3]=G>>>24,J+4},D.prototype.writeInt32BE=function(G,J,xe){return G=+G,J=J>>>0,xe||ct(this,G,J,4,2147483647,-2147483648),G<0&&(G=4294967295+G+1),this[J]=G>>>24,this[J+1]=G>>>16,this[J+2]=G>>>8,this[J+3]=G&255,J+4},D.prototype.writeBigInt64LE=Ct(function(G,J=0){return At(this,G,J,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),D.prototype.writeBigInt64BE=Ct(function(G,J=0){return ut(this,G,J,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function Pt(Z,G,J,xe,Fe,He){if(J+xe>Z.length)throw new RangeError("Index out of range");if(J<0)throw new RangeError("Index out of range")}function Ut(Z,G,J,xe,Fe){return G=+G,J=J>>>0,Fe||Pt(Z,G,J,4),k.write(Z,G,J,xe,23,4),J+4}D.prototype.writeFloatLE=function(G,J,xe){return Ut(this,G,J,!0,xe)},D.prototype.writeFloatBE=function(G,J,xe){return Ut(this,G,J,!1,xe)};function Ft(Z,G,J,xe,Fe){return G=+G,J=J>>>0,Fe||Pt(Z,G,J,8),k.write(Z,G,J,xe,52,8),J+8}D.prototype.writeDoubleLE=function(G,J,xe){return Ft(this,G,J,!0,xe)},D.prototype.writeDoubleBE=function(G,J,xe){return Ft(this,G,J,!1,xe)},D.prototype.copy=function(G,J,xe,Fe){if(!D.isBuffer(G))throw new TypeError("argument should be a Buffer");if(xe||(xe=0),!Fe&&Fe!==0&&(Fe=this.length),J>=G.length&&(J=G.length),J||(J=0),Fe>0&&Fe<xe&&(Fe=xe),Fe===xe||G.length===0||this.length===0)return 0;if(J<0)throw new RangeError("targetStart out of bounds");if(xe<0||xe>=this.length)throw new RangeError("Index out of range");if(Fe<0)throw new RangeError("sourceEnd out of bounds");Fe>this.length&&(Fe=this.length),G.length-J<Fe-xe&&(Fe=G.length-J+xe);const He=Fe-xe;return this===G&&typeof A.prototype.copyWithin=="function"?this.copyWithin(J,xe,Fe):A.prototype.set.call(G,this.subarray(xe,Fe),J),He},D.prototype.fill=function(G,J,xe,Fe){if(typeof G=="string"){if(typeof J=="string"?(Fe=J,J=0,xe=this.length):typeof xe=="string"&&(Fe=xe,xe=this.length),Fe!==void 0&&typeof Fe!="string")throw new TypeError("encoding must be a string");if(typeof Fe=="string"&&!D.isEncoding(Fe))throw new TypeError("Unknown encoding: "+Fe);if(G.length===1){const wt=G.charCodeAt(0);(Fe==="utf8"&&wt<128||Fe==="latin1")&&(G=wt)}}else typeof G=="number"?G=G&255:typeof G=="boolean"&&(G=Number(G));if(J<0||this.length<J||this.length<xe)throw new RangeError("Out of range index");if(xe<=J)return this;J=J>>>0,xe=xe===void 0?this.length:xe>>>0,G||(G=0);let He;if(typeof G=="number")for(He=J;He<xe;++He)this[He]=G;else{const wt=D.isBuffer(G)?G:D.from(G,Fe),Qt=wt.length;if(Qt===0)throw new TypeError('The value "'+G+'" is invalid for argument "value"');for(He=0;He<xe-J;++He)this[He+J]=wt[He%Qt]}return this};const Yt={};function we(Z,G,J){Yt[Z]=class extends J{constructor(){super(),Object.defineProperty(this,"message",{value:G.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${Z}]`,this.stack,delete this.name}get code(){return Z}set code(Fe){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:Fe,writable:!0})}toString(){return`${this.name} [${Z}]: ${this.message}`}}}we("ERR_BUFFER_OUT_OF_BOUNDS",function(Z){return Z?`${Z} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),we("ERR_INVALID_ARG_TYPE",function(Z,G){return`The "${Z}" argument must be of type number. Received type ${typeof G}`},TypeError),we("ERR_OUT_OF_RANGE",function(Z,G,J){let xe=`The value of "${Z}" is out of range.`,Fe=J;return Number.isInteger(J)&&Math.abs(J)>2**32?Fe=F(String(J)):typeof J=="bigint"&&(Fe=String(J),(J>BigInt(2)**BigInt(32)||J<-(BigInt(2)**BigInt(32)))&&(Fe=F(Fe)),Fe+="n"),xe+=` It must be ${G}. Received ${Fe}`,xe},RangeError);function F(Z){let G="",J=Z.length;const xe=Z[0]==="-"?1:0;for(;J>=xe+4;J-=3)G=`_${Z.slice(J-3,J)}${G}`;return`${Z.slice(0,J)}${G}`}function X(Z,G,J){Ee(G,"offset"),(Z[G]===void 0||Z[G+J]===void 0)&&ge(G,Z.length-(J+1))}function be(Z,G,J,xe,Fe,He){if(Z>J||Z<G){const wt=typeof G=="bigint"?"n":"";let Qt;throw G===0||G===BigInt(0)?Qt=`>= 0${wt} and < 2${wt} ** ${(He+1)*8}${wt}`:Qt=`>= -(2${wt} ** ${(He+1)*8-1}${wt}) and < 2 ** ${(He+1)*8-1}${wt}`,new Yt.ERR_OUT_OF_RANGE("value",Qt,Z)}X(xe,Fe,He)}function Ee(Z,G){if(typeof Z!="number")throw new Yt.ERR_INVALID_ARG_TYPE(G,"number",Z)}function ge(Z,G,J){throw Math.floor(Z)!==Z?(Ee(Z,J),new Yt.ERR_OUT_OF_RANGE("offset","an integer",Z)):G<0?new Yt.ERR_BUFFER_OUT_OF_BOUNDS:new Yt.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${G}`,Z)}const Ae=/[^+/0-9A-Za-z-_]/g;function le(Z){if(Z=Z.split("=")[0],Z=Z.trim().replace(Ae,""),Z.length<2)return"";for(;Z.length%4!==0;)Z=Z+"=";return Z}function ft(Z,G){G=G||1/0;let J;const xe=Z.length;let Fe=null;const He=[];for(let wt=0;wt<xe;++wt){if(J=Z.charCodeAt(wt),J>55295&&J<57344){if(!Fe){if(J>56319){(G-=3)>-1&&He.push(239,191,189);continue}else if(wt+1===xe){(G-=3)>-1&&He.push(239,191,189);continue}Fe=J;continue}if(J<56320){(G-=3)>-1&&He.push(239,191,189),Fe=J;continue}J=(Fe-55296<<10|J-56320)+65536}else Fe&&(G-=3)>-1&&He.push(239,191,189);if(Fe=null,J<128){if((G-=1)<0)break;He.push(J)}else if(J<2048){if((G-=2)<0)break;He.push(J>>6|192,J&63|128)}else if(J<65536){if((G-=3)<0)break;He.push(J>>12|224,J>>6&63|128,J&63|128)}else if(J<1114112){if((G-=4)<0)break;He.push(J>>18|240,J>>12&63|128,J>>6&63|128,J&63|128)}else throw new Error("Invalid code point")}return He}function et(Z){const G=[];for(let J=0;J<Z.length;++J)G.push(Z.charCodeAt(J)&255);return G}function $(Z,G){let J,xe,Fe;const He=[];for(let wt=0;wt<Z.length&&!((G-=2)<0);++wt)J=Z.charCodeAt(wt),xe=J>>8,Fe=J%256,He.push(Fe),He.push(xe);return He}function qe(Z){return _.toByteArray(le(Z))}function tt(Z,G,J,xe){let Fe;for(Fe=0;Fe<xe&&!(Fe+J>=G.length||Fe>=Z.length);++Fe)G[Fe+J]=Z[Fe];return Fe}function ve(Z,G){return Z instanceof G||Z!=null&&Z.constructor!=null&&Z.constructor.name!=null&&Z.constructor.name===G.name}function Se(Z){return Z!==Z}const ze=function(){const Z="0123456789abcdef",G=new Array(256);for(let J=0;J<16;++J){const xe=J*16;for(let Fe=0;Fe<16;++Fe)G[xe+Fe]=Z[J]+Z[Fe]}return G}();function Ct(Z){return typeof BigInt>"u"?fe:Z}function fe(){throw new Error("BigInt not supported")}})(t);const x=t.Buffer;e.Blob=t.Blob,e.BlobOptions=t.BlobOptions,e.Buffer=t.Buffer,e.File=t.File,e.FileOptions=t.FileOptions,e.INSPECT_MAX_BYTES=t.INSPECT_MAX_BYTES,e.SlowBuffer=t.SlowBuffer,e.TranscodeEncoding=t.TranscodeEncoding,e.atob=t.atob,e.btoa=t.btoa,e.constants=t.constants,e.default=x,e.isAscii=t.isAscii,e.isUtf8=t.isUtf8,e.kMaxLength=t.kMaxLength,e.kStringMaxLength=t.kStringMaxLength,e.resolveObjectURL=t.resolveObjectURL,e.transcode=t.transcode}(bI)),bI}var vI,yz;function ri(){if(yz)return vI;yz=1;class e extends Error{constructor(n){if(!Array.isArray(n))throw new TypeError(`Expected input to be an Array, got ${typeof n}`);let r="";for(let s=0;s<n.length;s++)r+=`    ${n[s].stack}
`;super(r),this.name="AggregateError",this.errors=n}}return vI={AggregateError:e,ArrayIsArray(t){return Array.isArray(t)},ArrayPrototypeIncludes(t,n){return t.includes(n)},ArrayPrototypeIndexOf(t,n){return t.indexOf(n)},ArrayPrototypeJoin(t,n){return t.join(n)},ArrayPrototypeMap(t,n){return t.map(n)},ArrayPrototypePop(t,n){return t.pop(n)},ArrayPrototypePush(t,n){return t.push(n)},ArrayPrototypeSlice(t,n,r){return t.slice(n,r)},Error,FunctionPrototypeCall(t,n,...r){return t.call(n,...r)},FunctionPrototypeSymbolHasInstance(t,n){return Function.prototype[Symbol.hasInstance].call(t,n)},MathFloor:Math.floor,Number,NumberIsInteger:Number.isInteger,NumberIsNaN:Number.isNaN,NumberMAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER,NumberMIN_SAFE_INTEGER:Number.MIN_SAFE_INTEGER,NumberParseInt:Number.parseInt,ObjectDefineProperties(t,n){return Object.defineProperties(t,n)},ObjectDefineProperty(t,n,r){return Object.defineProperty(t,n,r)},ObjectGetOwnPropertyDescriptor(t,n){return Object.getOwnPropertyDescriptor(t,n)},ObjectKeys(t){return Object.keys(t)},ObjectSetPrototypeOf(t,n){return Object.setPrototypeOf(t,n)},Promise,PromisePrototypeCatch(t,n){return t.catch(n)},PromisePrototypeThen(t,n,r){return t.then(n,r)},PromiseReject(t){return Promise.reject(t)},PromiseResolve(t){return Promise.resolve(t)},ReflectApply:Reflect.apply,RegExpPrototypeTest(t,n){return t.test(n)},SafeSet:Set,String,StringPrototypeSlice(t,n,r){return t.slice(n,r)},StringPrototypeToLowerCase(t){return t.toLowerCase()},StringPrototypeToUpperCase(t){return t.toUpperCase()},StringPrototypeTrim(t){return t.trim()},Symbol,SymbolFor:Symbol.for,SymbolAsyncIterator:Symbol.asyncIterator,SymbolHasInstance:Symbol.hasInstance,SymbolIterator:Symbol.iterator,SymbolDispose:Symbol.dispose||Symbol("Symbol.dispose"),SymbolAsyncDispose:Symbol.asyncDispose||Symbol("Symbol.asyncDispose"),TypedArrayPrototypeSet(t,n,r){return t.set(n,r)},Boolean,Uint8Array},vI}var xI={exports:{}},wI,bz;function kY(){return bz||(bz=1,wI={format(e,...t){return e.replace(/%([sdifj])/g,function(...[n,r]){const s=t.shift();return r==="f"?s.toFixed(6):r==="j"?JSON.stringify(s):r==="s"&&typeof s=="object"?`${s.constructor!==Object?s.constructor.name:""} {}`.trim():s.toString()})},inspect(e){switch(typeof e){case"string":if(e.includes("'"))if(e.includes('"')){if(!e.includes("`")&&!e.includes("${"))return`\`${e}\``}else return`"${e}"`;return`'${e}'`;case"number":return isNaN(e)?"NaN":Object.is(e,-0)?String(e):e;case"bigint":return`${String(e)}n`;case"boolean":case"undefined":return String(e);case"object":return"{}"}}}),wI}var SI,vz;function Eo(){if(vz)return SI;vz=1;const{format:e,inspect:t}=kY(),{AggregateError:n}=ri(),r=globalThis.AggregateError||n,s=Symbol("kIsNodeError"),i=["string","function","number","object","Function","Object","boolean","bigint","symbol"],a=/^([A-Z][a-z0-9]*)+$/,o="__node_internal_",l={};function c(v,x){if(!v)throw new l.ERR_INTERNAL_ASSERTION(x)}function u(v){let x="",w=v.length;const _=v[0]==="-"?1:0;for(;w>=_+4;w-=3)x=`_${v.slice(w-3,w)}${x}`;return`${v.slice(0,w)}${x}`}function d(v,x,w){if(typeof x=="function")return c(x.length<=w.length,`Code: ${v}; The provided arguments length (${w.length}) does not match the required ones (${x.length}).`),x(...w);const _=(x.match(/%[dfijoOs]/g)||[]).length;return c(_===w.length,`Code: ${v}; The provided arguments length (${w.length}) does not match the required ones (${_}).`),w.length===0?x:e(x,...w)}function h(v,x,w){w||(w=Error);class _ extends w{constructor(...C){super(d(v,x,C))}toString(){return`${this.name} [${v}]: ${this.message}`}}Object.defineProperties(_.prototype,{name:{value:w.name,writable:!0,enumerable:!1,configurable:!0},toString:{value(){return`${this.name} [${v}]: ${this.message}`},writable:!0,enumerable:!1,configurable:!0}}),_.prototype.code=v,_.prototype[s]=!0,l[v]=_}function m(v){const x=o+v.name;return Object.defineProperty(v,"name",{value:x}),v}function y(v,x){if(v&&x&&v!==x){if(Array.isArray(x.errors))return x.errors.push(v),x;const w=new r([x,v],x.message);return w.code=x.code,w}return v||x}class b extends Error{constructor(x="The operation was aborted",w=void 0){if(w!==void 0&&typeof w!="object")throw new l.ERR_INVALID_ARG_TYPE("options","Object",w);super(x,w),this.code="ABORT_ERR",this.name="AbortError"}}return h("ERR_ASSERTION","%s",Error),h("ERR_INVALID_ARG_TYPE",(v,x,w)=>{c(typeof v=="string","'name' must be a string"),Array.isArray(x)||(x=[x]);let _="The ";v.endsWith(" argument")?_+=`${v} `:_+=`"${v}" ${v.includes(".")?"property":"argument"} `,_+="must be ";const k=[],C=[],T=[];for(const N of x)c(typeof N=="string","All expected entries have to be of type string"),i.includes(N)?k.push(N.toLowerCase()):a.test(N)?C.push(N):(c(N!=="object",'The value "object" should be written as "Object"'),T.push(N));if(C.length>0){const N=k.indexOf("object");N!==-1&&(k.splice(k,N,1),C.push("Object"))}if(k.length>0){switch(k.length){case 1:_+=`of type ${k[0]}`;break;case 2:_+=`one of type ${k[0]} or ${k[1]}`;break;default:{const N=k.pop();_+=`one of type ${k.join(", ")}, or ${N}`}}(C.length>0||T.length>0)&&(_+=" or ")}if(C.length>0){switch(C.length){case 1:_+=`an instance of ${C[0]}`;break;case 2:_+=`an instance of ${C[0]} or ${C[1]}`;break;default:{const N=C.pop();_+=`an instance of ${C.join(", ")}, or ${N}`}}T.length>0&&(_+=" or ")}switch(T.length){case 0:break;case 1:T[0].toLowerCase()!==T[0]&&(_+="an "),_+=`${T[0]}`;break;case 2:_+=`one of ${T[0]} or ${T[1]}`;break;default:{const N=T.pop();_+=`one of ${T.join(", ")}, or ${N}`}}if(w==null)_+=`. Received ${w}`;else if(typeof w=="function"&&w.name)_+=`. Received function ${w.name}`;else if(typeof w=="object"){var A;if((A=w.constructor)!==null&&A!==void 0&&A.name)_+=`. Received an instance of ${w.constructor.name}`;else{const N=t(w,{depth:-1});_+=`. Received ${N}`}}else{let N=t(w,{colors:!1});N.length>25&&(N=`${N.slice(0,25)}...`),_+=`. Received type ${typeof w} (${N})`}return _},TypeError),h("ERR_INVALID_ARG_VALUE",(v,x,w="is invalid")=>{let _=t(x);return _.length>128&&(_=_.slice(0,128)+"..."),`The ${v.includes(".")?"property":"argument"} '${v}' ${w}. Received ${_}`},TypeError),h("ERR_INVALID_RETURN_VALUE",(v,x,w)=>{var _;const k=w!=null&&(_=w.constructor)!==null&&_!==void 0&&_.name?`instance of ${w.constructor.name}`:`type ${typeof w}`;return`Expected ${v} to be returned from the "${x}" function but got ${k}.`},TypeError),h("ERR_MISSING_ARGS",(...v)=>{c(v.length>0,"At least one arg needs to be specified");let x;const w=v.length;switch(v=(Array.isArray(v)?v:[v]).map(_=>`"${_}"`).join(" or "),w){case 1:x+=`The ${v[0]} argument`;break;case 2:x+=`The ${v[0]} and ${v[1]} arguments`;break;default:{const _=v.pop();x+=`The ${v.join(", ")}, and ${_} arguments`}break}return`${x} must be specified`},TypeError),h("ERR_OUT_OF_RANGE",(v,x,w)=>{c(x,'Missing "range" argument');let _;if(Number.isInteger(w)&&Math.abs(w)>2**32)_=u(String(w));else if(typeof w=="bigint"){_=String(w);const k=BigInt(2)**BigInt(32);(w>k||w<-k)&&(_=u(_)),_+="n"}else _=t(w);return`The value of "${v}" is out of range. It must be ${x}. Received ${_}`},RangeError),h("ERR_MULTIPLE_CALLBACK","Callback called multiple times",Error),h("ERR_METHOD_NOT_IMPLEMENTED","The %s method is not implemented",Error),h("ERR_STREAM_ALREADY_FINISHED","Cannot call %s after a stream was finished",Error),h("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable",Error),h("ERR_STREAM_DESTROYED","Cannot call %s after a stream was destroyed",Error),h("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),h("ERR_STREAM_PREMATURE_CLOSE","Premature close",Error),h("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF",Error),h("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event",Error),h("ERR_STREAM_WRITE_AFTER_END","write after end",Error),h("ERR_UNKNOWN_ENCODING","Unknown encoding: %s",TypeError),SI={AbortError:b,aggregateTwoErrors:m(y),hideStackFrames:m,codes:l},SI}var Wv={exports:{}},xz;function Sw(){if(xz)return Wv.exports;xz=1;const{AbortController:e,AbortSignal:t}=typeof self<"u"?self:typeof window<"u"?window:void 0;return Wv.exports=e,Wv.exports.AbortSignal=t,Wv.exports.default=e,Wv.exports}var Y_={exports:{}},wz;function sT(){if(wz)return Y_.exports;wz=1;var e=typeof Reflect=="object"?Reflect:null,t=e&&typeof e.apply=="function"?e.apply:function(C,T,A){return Function.prototype.apply.call(C,T,A)},n;e&&typeof e.ownKeys=="function"?n=e.ownKeys:Object.getOwnPropertySymbols?n=function(C){return Object.getOwnPropertyNames(C).concat(Object.getOwnPropertySymbols(C))}:n=function(C){return Object.getOwnPropertyNames(C)};function r(k){console&&console.warn&&console.warn(k)}var s=Number.isNaN||function(C){return C!==C};function i(){i.init.call(this)}Y_.exports=i,Y_.exports.once=x,i.EventEmitter=i,i.prototype._events=void 0,i.prototype._eventsCount=0,i.prototype._maxListeners=void 0;var a=10;function o(k){if(typeof k!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof k)}Object.defineProperty(i,"defaultMaxListeners",{enumerable:!0,get:function(){return a},set:function(k){if(typeof k!="number"||k<0||s(k))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+k+".");a=k}}),i.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},i.prototype.setMaxListeners=function(C){if(typeof C!="number"||C<0||s(C))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+C+".");return this._maxListeners=C,this};function l(k){return k._maxListeners===void 0?i.defaultMaxListeners:k._maxListeners}i.prototype.getMaxListeners=function(){return l(this)},i.prototype.emit=function(C){for(var T=[],A=1;A<arguments.length;A++)T.push(arguments[A]);var N=C==="error",I=this._events;if(I!==void 0)N=N&&I.error===void 0;else if(!N)return!1;if(N){var j;if(T.length>0&&(j=T[0]),j instanceof Error)throw j;var L=new Error("Unhandled error."+(j?" ("+j.message+")":""));throw L.context=j,L}var D=I[C];if(D===void 0)return!1;if(typeof D=="function")t(D,this,T);else for(var H=D.length,O=y(D,H),A=0;A<H;++A)t(O[A],this,T);return!0};function c(k,C,T,A){var N,I,j;if(o(T),I=k._events,I===void 0?(I=k._events=Object.create(null),k._eventsCount=0):(I.newListener!==void 0&&(k.emit("newListener",C,T.listener?T.listener:T),I=k._events),j=I[C]),j===void 0)j=I[C]=T,++k._eventsCount;else if(typeof j=="function"?j=I[C]=A?[T,j]:[j,T]:A?j.unshift(T):j.push(T),N=l(k),N>0&&j.length>N&&!j.warned){j.warned=!0;var L=new Error("Possible EventEmitter memory leak detected. "+j.length+" "+String(C)+" listeners added. Use emitter.setMaxListeners() to increase limit");L.name="MaxListenersExceededWarning",L.emitter=k,L.type=C,L.count=j.length,r(L)}return k}i.prototype.addListener=function(C,T){return c(this,C,T,!1)},i.prototype.on=i.prototype.addListener,i.prototype.prependListener=function(C,T){return c(this,C,T,!0)};function u(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function d(k,C,T){var A={fired:!1,wrapFn:void 0,target:k,type:C,listener:T},N=u.bind(A);return N.listener=T,A.wrapFn=N,N}i.prototype.once=function(C,T){return o(T),this.on(C,d(this,C,T)),this},i.prototype.prependOnceListener=function(C,T){return o(T),this.prependListener(C,d(this,C,T)),this},i.prototype.removeListener=function(C,T){var A,N,I,j,L;if(o(T),N=this._events,N===void 0)return this;if(A=N[C],A===void 0)return this;if(A===T||A.listener===T)--this._eventsCount===0?this._events=Object.create(null):(delete N[C],N.removeListener&&this.emit("removeListener",C,A.listener||T));else if(typeof A!="function"){for(I=-1,j=A.length-1;j>=0;j--)if(A[j]===T||A[j].listener===T){L=A[j].listener,I=j;break}if(I<0)return this;I===0?A.shift():b(A,I),A.length===1&&(N[C]=A[0]),N.removeListener!==void 0&&this.emit("removeListener",C,L||T)}return this},i.prototype.off=i.prototype.removeListener,i.prototype.removeAllListeners=function(C){var T,A,N;if(A=this._events,A===void 0)return this;if(A.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):A[C]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete A[C]),this;if(arguments.length===0){var I=Object.keys(A),j;for(N=0;N<I.length;++N)j=I[N],j!=="removeListener"&&this.removeAllListeners(j);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(T=A[C],typeof T=="function")this.removeListener(C,T);else if(T!==void 0)for(N=T.length-1;N>=0;N--)this.removeListener(C,T[N]);return this};function h(k,C,T){var A=k._events;if(A===void 0)return[];var N=A[C];return N===void 0?[]:typeof N=="function"?T?[N.listener||N]:[N]:T?v(N):y(N,N.length)}i.prototype.listeners=function(C){return h(this,C,!0)},i.prototype.rawListeners=function(C){return h(this,C,!1)},i.listenerCount=function(k,C){return typeof k.listenerCount=="function"?k.listenerCount(C):m.call(k,C)},i.prototype.listenerCount=m;function m(k){var C=this._events;if(C!==void 0){var T=C[k];if(typeof T=="function")return 1;if(T!==void 0)return T.length}return 0}i.prototype.eventNames=function(){return this._eventsCount>0?n(this._events):[]};function y(k,C){for(var T=new Array(C),A=0;A<C;++A)T[A]=k[A];return T}function b(k,C){for(;C+1<k.length;C++)k[C]=k[C+1];k.pop()}function v(k){for(var C=new Array(k.length),T=0;T<C.length;++T)C[T]=k[T].listener||k[T];return C}function x(k,C){return new Promise(function(T,A){function N(j){k.removeListener(C,I),A(j)}function I(){typeof k.removeListener=="function"&&k.removeListener("error",N),T([].slice.call(arguments))}_(k,C,I,{once:!0}),C!=="error"&&w(k,N,{once:!0})})}function w(k,C,T){typeof k.on=="function"&&_(k,"error",C,T)}function _(k,C,T,A){if(typeof k.on=="function")A.once?k.once(C,T):k.on(C,T);else if(typeof k.addEventListener=="function")k.addEventListener(C,function N(I){A.once&&k.removeEventListener(C,N),T(I)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof k)}return Y_.exports}var Sz;function Wo(){return Sz||(Sz=1,function(e){const t=op(),{format:n,inspect:r}=kY(),{codes:{ERR_INVALID_ARG_TYPE:s}}=Eo(),{kResistStopPropagation:i,AggregateError:a,SymbolDispose:o}=ri(),l=globalThis.AbortSignal||Sw().AbortSignal,c=globalThis.AbortController||Sw().AbortController,u=Object.getPrototypeOf(async function(){}).constructor,d=globalThis.Blob||t.Blob,h=typeof d<"u"?function(v){return v instanceof d}:function(v){return!1},m=(b,v)=>{if(b!==void 0&&(b===null||typeof b!="object"||!("aborted"in b)))throw new s(v,"AbortSignal",b)},y=(b,v)=>{if(typeof b!="function")throw new s(v,"Function",b)};e.exports={AggregateError:a,kEmptyObject:Object.freeze({}),once(b){let v=!1;return function(...x){v||(v=!0,b.apply(this,x))}},createDeferredPromise:function(){let b,v;return{promise:new Promise((w,_)=>{b=w,v=_}),resolve:b,reject:v}},promisify(b){return new Promise((v,x)=>{b((w,..._)=>w?x(w):v(..._))})},debuglog(){return function(){}},format:n,inspect:r,types:{isAsyncFunction(b){return b instanceof u},isArrayBufferView(b){return ArrayBuffer.isView(b)}},isBlob:h,deprecate(b,v){return b},addAbortListener:sT().addAbortListener||function(v,x){if(v===void 0)throw new s("signal","AbortSignal",v);m(v,"signal"),y(x,"listener");let w;return v.aborted?queueMicrotask(()=>x()):(v.addEventListener("abort",x,{__proto__:null,once:!0,[i]:!0}),w=()=>{v.removeEventListener("abort",x)}),{__proto__:null,[o](){var _;(_=w)===null||_===void 0||_()}}},AbortSignalAny:l.any||function(v){if(v.length===1)return v[0];const x=new c,w=()=>x.abort();return v.forEach(_=>{m(_,"signals"),_.addEventListener("abort",w,{once:!0})}),x.signal.addEventListener("abort",()=>{v.forEach(_=>_.removeEventListener("abort",w))},{once:!0}),x.signal}},e.exports.promisify.custom=Symbol.for("nodejs.util.promisify.custom")}(xI)),xI.exports}var Z_={},_I,_z;function D1(){if(_z)return _I;_z=1;const{ArrayIsArray:e,ArrayPrototypeIncludes:t,ArrayPrototypeJoin:n,ArrayPrototypeMap:r,NumberIsInteger:s,NumberIsNaN:i,NumberMAX_SAFE_INTEGER:a,NumberMIN_SAFE_INTEGER:o,NumberParseInt:l,ObjectPrototypeHasOwnProperty:c,RegExpPrototypeExec:u,String:d,StringPrototypeToUpperCase:h,StringPrototypeTrim:m}=ri(),{hideStackFrames:y,codes:{ERR_SOCKET_BAD_PORT:b,ERR_INVALID_ARG_TYPE:v,ERR_INVALID_ARG_VALUE:x,ERR_OUT_OF_RANGE:w,ERR_UNKNOWN_SIGNAL:_}}=Eo(),{normalizeEncoding:k}=Wo(),{isAsyncFunction:C,isArrayBufferView:T}=Wo().types,A={};function N(se){return se===(se|0)}function I(se){return se===se>>>0}const j=/^[0-7]+$/,L="must be a 32-bit unsigned integer or an octal string";function D(se,Ie,Be){if(typeof se>"u"&&(se=Be),typeof se=="string"){if(u(j,se)===null)throw new x(Ie,se,L);se=l(se,8)}return K(se,Ie),se}const H=y((se,Ie,Be=o,Re=a)=>{if(typeof se!="number")throw new v(Ie,"number",se);if(!s(se))throw new w(Ie,"an integer",se);if(se<Be||se>Re)throw new w(Ie,`>= ${Be} && <= ${Re}`,se)}),O=y((se,Ie,Be=-2147483648,Re=2147483647)=>{if(typeof se!="number")throw new v(Ie,"number",se);if(!s(se))throw new w(Ie,"an integer",se);if(se<Be||se>Re)throw new w(Ie,`>= ${Be} && <= ${Re}`,se)}),K=y((se,Ie,Be=!1)=>{if(typeof se!="number")throw new v(Ie,"number",se);if(!s(se))throw new w(Ie,"an integer",se);const Re=Be?1:0,ct=4294967295;if(se<Re||se>ct)throw new w(Ie,`>= ${Re} && <= ${ct}`,se)});function U(se,Ie){if(typeof se!="string")throw new v(Ie,"string",se)}function W(se,Ie,Be=void 0,Re){if(typeof se!="number")throw new v(Ie,"number",se);if(Be!=null&&se<Be||Re!=null&&se>Re||(Be!=null||Re!=null)&&i(se))throw new w(Ie,`${Be!=null?`>= ${Be}`:""}${Be!=null&&Re!=null?" && ":""}${Re!=null?`<= ${Re}`:""}`,se)}const B=y((se,Ie,Be)=>{if(!t(Be,se)){const ct="must be one of: "+n(r(Be,At=>typeof At=="string"?`'${At}'`:d(At)),", ");throw new x(Ie,se,ct)}});function ne(se,Ie){if(typeof se!="boolean")throw new v(Ie,"boolean",se)}function V(se,Ie,Be){return se==null||!c(se,Ie)?Be:se[Ie]}const Q=y((se,Ie,Be=null)=>{const Re=V(Be,"allowArray",!1),ct=V(Be,"allowFunction",!1);if(!V(Be,"nullable",!1)&&se===null||!Re&&e(se)||typeof se!="object"&&(!ct||typeof se!="function"))throw new v(Ie,"Object",se)}),ee=y((se,Ie)=>{if(se!=null&&typeof se!="object"&&typeof se!="function")throw new v(Ie,"a dictionary",se)}),re=y((se,Ie,Be=0)=>{if(!e(se))throw new v(Ie,"Array",se);if(se.length<Be){const Re=`must be longer than ${Be}`;throw new x(Ie,se,Re)}});function de(se,Ie){re(se,Ie);for(let Be=0;Be<se.length;Be++)U(se[Be],`${Ie}[${Be}]`)}function me(se,Ie){re(se,Ie);for(let Be=0;Be<se.length;Be++)ne(se[Be],`${Ie}[${Be}]`)}function De(se,Ie){re(se,Ie);for(let Be=0;Be<se.length;Be++){const Re=se[Be],ct=`${Ie}[${Be}]`;if(Re==null)throw new v(ct,"AbortSignal",Re);Qe(Re,ct)}}function je(se,Ie="signal"){if(U(se,Ie),A[se]===void 0)throw A[h(se)]!==void 0?new _(se+" (signals must use all capital letters)"):new _(se)}const Te=y((se,Ie="buffer")=>{if(!T(se))throw new v(Ie,["Buffer","TypedArray","DataView"],se)});function _e(se,Ie){const Be=k(Ie),Re=se.length;if(Be==="hex"&&Re%2!==0)throw new x("encoding",Ie,`is invalid for data of length ${Re}`)}function Ue(se,Ie="Port",Be=!0){if(typeof se!="number"&&typeof se!="string"||typeof se=="string"&&m(se).length===0||+se!==+se>>>0||se>65535||se===0&&!Be)throw new b(Ie,se,Be);return se|0}const Qe=y((se,Ie)=>{if(se!==void 0&&(se===null||typeof se!="object"||!("aborted"in se)))throw new v(Ie,"AbortSignal",se)}),We=y((se,Ie)=>{if(typeof se!="function")throw new v(Ie,"Function",se)}),Pe=y((se,Ie)=>{if(typeof se!="function"||C(se))throw new v(Ie,"Function",se)}),Y=y((se,Ie)=>{if(se!==void 0)throw new v(Ie,"undefined",se)});function ye(se,Ie,Be){if(!t(Be,se))throw new v(Ie,`('${n(Be,"|")}')`,se)}const Me=/^(?:<[^>]*>)(?:\s*;\s*[^;"\s]+(?:=(")?[^;"\s]*\1)?)*$/;function ue(se,Ie){if(typeof se>"u"||!u(Me,se))throw new x(Ie,se,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}function oe(se){if(typeof se=="string")return ue(se,"hints"),se;if(e(se)){const Ie=se.length;let Be="";if(Ie===0)return Be;for(let Re=0;Re<Ie;Re++){const ct=se[Re];ue(ct,"hints"),Be+=ct,Re!==Ie-1&&(Be+=", ")}return Be}throw new x("hints",se,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}return _I={isInt32:N,isUint32:I,parseFileMode:D,validateArray:re,validateStringArray:de,validateBooleanArray:me,validateAbortSignalArray:De,validateBoolean:ne,validateBuffer:Te,validateDictionary:ee,validateEncoding:_e,validateFunction:We,validateInt32:O,validateInteger:H,validateNumber:W,validateObject:Q,validateOneOf:B,validatePlainFunction:Pe,validatePort:Ue,validateSignalName:je,validateString:U,validateUint32:K,validateUndefined:Y,validateUnion:ye,validateAbortSignal:Qe,validateLinkHeaderValue:oe},_I}var X_={exports:{}},CI={},Cz;function ag(){return Cz||(Cz=1,function(e){Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});function t(k){return k&&k.__esModule&&Object.prototype.hasOwnProperty.call(k,"default")?k.default:k}var n={exports:{}},r=n.exports={},s,i;function a(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?s=setTimeout:s=a}catch{s=a}try{typeof clearTimeout=="function"?i=clearTimeout:i=o}catch{i=o}})();function l(k){if(s===setTimeout)return setTimeout(k,0);if((s===a||!s)&&setTimeout)return s=setTimeout,setTimeout(k,0);try{return s(k,0)}catch{try{return s.call(null,k,0)}catch{return s.call(this,k,0)}}}function c(k){if(i===clearTimeout)return clearTimeout(k);if((i===o||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(k);try{return i(k)}catch{try{return i.call(null,k)}catch{return i.call(this,k)}}}var u=[],d=!1,h,m=-1;function y(){!d||!h||(d=!1,h.length?u=h.concat(u):m=-1,u.length&&b())}function b(){if(!d){var k=l(y);d=!0;for(var C=u.length;C;){for(h=u,u=[];++m<C;)h&&h[m].run();m=-1,C=u.length}h=null,d=!1,c(k)}}r.nextTick=function(k){var C=new Array(arguments.length-1);if(arguments.length>1)for(var T=1;T<arguments.length;T++)C[T-1]=arguments[T];u.push(new v(k,C)),u.length===1&&!d&&l(b)};function v(k,C){this.fun=k,this.array=C}v.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={};function x(){}r.on=x,r.addListener=x,r.once=x,r.off=x,r.removeListener=x,r.removeAllListeners=x,r.emit=x,r.prependListener=x,r.prependOnceListener=x,r.listeners=function(k){return[]},r.binding=function(k){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(k){throw new Error("process.chdir is not supported")},r.umask=function(){return 0};var w=n.exports;const _=t(w);e.default=_,e.process=_}(CI)),CI}var kI,kz;function bf(){if(kz)return kI;kz=1;const{SymbolAsyncIterator:e,SymbolIterator:t,SymbolFor:n}=ri(),r=n("nodejs.stream.destroyed"),s=n("nodejs.stream.errored"),i=n("nodejs.stream.readable"),a=n("nodejs.stream.writable"),o=n("nodejs.stream.disturbed"),l=n("nodejs.webstream.isClosedPromise"),c=n("nodejs.webstream.controllerErrorFunction");function u(V,Q=!1){var ee;return!!(V&&typeof V.pipe=="function"&&typeof V.on=="function"&&(!Q||typeof V.pause=="function"&&typeof V.resume=="function")&&(!V._writableState||((ee=V._readableState)===null||ee===void 0?void 0:ee.readable)!==!1)&&(!V._writableState||V._readableState))}function d(V){var Q;return!!(V&&typeof V.write=="function"&&typeof V.on=="function"&&(!V._readableState||((Q=V._writableState)===null||Q===void 0?void 0:Q.writable)!==!1))}function h(V){return!!(V&&typeof V.pipe=="function"&&V._readableState&&typeof V.on=="function"&&typeof V.write=="function")}function m(V){return V&&(V._readableState||V._writableState||typeof V.write=="function"&&typeof V.on=="function"||typeof V.pipe=="function"&&typeof V.on=="function")}function y(V){return!!(V&&!m(V)&&typeof V.pipeThrough=="function"&&typeof V.getReader=="function"&&typeof V.cancel=="function")}function b(V){return!!(V&&!m(V)&&typeof V.getWriter=="function"&&typeof V.abort=="function")}function v(V){return!!(V&&!m(V)&&typeof V.readable=="object"&&typeof V.writable=="object")}function x(V){return y(V)||b(V)||v(V)}function w(V,Q){return V==null?!1:Q===!0?typeof V[e]=="function":Q===!1?typeof V[t]=="function":typeof V[e]=="function"||typeof V[t]=="function"}function _(V){if(!m(V))return null;const Q=V._writableState,ee=V._readableState,re=Q||ee;return!!(V.destroyed||V[r]||re!=null&&re.destroyed)}function k(V){if(!d(V))return null;if(V.writableEnded===!0)return!0;const Q=V._writableState;return Q!=null&&Q.errored?!1:typeof(Q==null?void 0:Q.ended)!="boolean"?null:Q.ended}function C(V,Q){if(!d(V))return null;if(V.writableFinished===!0)return!0;const ee=V._writableState;return ee!=null&&ee.errored?!1:typeof(ee==null?void 0:ee.finished)!="boolean"?null:!!(ee.finished||Q===!1&&ee.ended===!0&&ee.length===0)}function T(V){if(!u(V))return null;if(V.readableEnded===!0)return!0;const Q=V._readableState;return!Q||Q.errored?!1:typeof(Q==null?void 0:Q.ended)!="boolean"?null:Q.ended}function A(V,Q){if(!u(V))return null;const ee=V._readableState;return ee!=null&&ee.errored?!1:typeof(ee==null?void 0:ee.endEmitted)!="boolean"?null:!!(ee.endEmitted||Q===!1&&ee.ended===!0&&ee.length===0)}function N(V){return V&&V[i]!=null?V[i]:typeof(V==null?void 0:V.readable)!="boolean"?null:_(V)?!1:u(V)&&V.readable&&!A(V)}function I(V){return V&&V[a]!=null?V[a]:typeof(V==null?void 0:V.writable)!="boolean"?null:_(V)?!1:d(V)&&V.writable&&!k(V)}function j(V,Q){return m(V)?_(V)?!0:!((Q==null?void 0:Q.readable)!==!1&&N(V)||(Q==null?void 0:Q.writable)!==!1&&I(V)):null}function L(V){var Q,ee;return m(V)?V.writableErrored?V.writableErrored:(Q=(ee=V._writableState)===null||ee===void 0?void 0:ee.errored)!==null&&Q!==void 0?Q:null:null}function D(V){var Q,ee;return m(V)?V.readableErrored?V.readableErrored:(Q=(ee=V._readableState)===null||ee===void 0?void 0:ee.errored)!==null&&Q!==void 0?Q:null:null}function H(V){if(!m(V))return null;if(typeof V.closed=="boolean")return V.closed;const Q=V._writableState,ee=V._readableState;return typeof(Q==null?void 0:Q.closed)=="boolean"||typeof(ee==null?void 0:ee.closed)=="boolean"?(Q==null?void 0:Q.closed)||(ee==null?void 0:ee.closed):typeof V._closed=="boolean"&&O(V)?V._closed:null}function O(V){return typeof V._closed=="boolean"&&typeof V._defaultKeepAlive=="boolean"&&typeof V._removedConnection=="boolean"&&typeof V._removedContLen=="boolean"}function K(V){return typeof V._sent100=="boolean"&&O(V)}function U(V){var Q;return typeof V._consuming=="boolean"&&typeof V._dumped=="boolean"&&((Q=V.req)===null||Q===void 0?void 0:Q.upgradeOrConnect)===void 0}function W(V){if(!m(V))return null;const Q=V._writableState,ee=V._readableState,re=Q||ee;return!re&&K(V)||!!(re&&re.autoDestroy&&re.emitClose&&re.closed===!1)}function B(V){var Q;return!!(V&&((Q=V[o])!==null&&Q!==void 0?Q:V.readableDidRead||V.readableAborted))}function ne(V){var Q,ee,re,de,me,De,je,Te,_e,Ue;return!!(V&&((Q=(ee=(re=(de=(me=(De=V[s])!==null&&De!==void 0?De:V.readableErrored)!==null&&me!==void 0?me:V.writableErrored)!==null&&de!==void 0?de:(je=V._readableState)===null||je===void 0?void 0:je.errorEmitted)!==null&&re!==void 0?re:(Te=V._writableState)===null||Te===void 0?void 0:Te.errorEmitted)!==null&&ee!==void 0?ee:(_e=V._readableState)===null||_e===void 0?void 0:_e.errored)!==null&&Q!==void 0?Q:!((Ue=V._writableState)===null||Ue===void 0)&&Ue.errored))}return kI={isDestroyed:_,kIsDestroyed:r,isDisturbed:B,kIsDisturbed:o,isErrored:ne,kIsErrored:s,isReadable:N,kIsReadable:i,kIsClosedPromise:l,kControllerErrorFunction:c,kIsWritable:a,isClosed:H,isDuplexNodeStream:h,isFinished:j,isIterable:w,isReadableNodeStream:u,isReadableStream:y,isReadableEnded:T,isReadableFinished:A,isReadableErrored:D,isNodeStream:m,isWebStream:x,isWritable:I,isWritableNodeStream:d,isWritableStream:b,isWritableEnded:k,isWritableFinished:C,isWritableErrored:L,isServerRequest:U,isServerResponse:K,willEmitClose:W,isTransformStream:v},kI}var Ez;function lp(){if(Ez)return X_.exports;Ez=1;const e=ag(),{AbortError:t,codes:n}=Eo(),{ERR_INVALID_ARG_TYPE:r,ERR_STREAM_PREMATURE_CLOSE:s}=n,{kEmptyObject:i,once:a}=Wo(),{validateAbortSignal:o,validateFunction:l,validateObject:c,validateBoolean:u}=D1(),{Promise:d,PromisePrototypeThen:h,SymbolDispose:m}=ri(),{isClosed:y,isReadable:b,isReadableNodeStream:v,isReadableStream:x,isReadableFinished:w,isReadableErrored:_,isWritable:k,isWritableNodeStream:C,isWritableStream:T,isWritableFinished:A,isWritableErrored:N,isNodeStream:I,willEmitClose:j,kIsClosedPromise:L}=bf();let D;function H(B){return B.setHeader&&typeof B.abort=="function"}const O=()=>{};function K(B,ne,V){var Q,ee;if(arguments.length===2?(V=ne,ne=i):ne==null?ne=i:c(ne,"options"),l(V,"callback"),o(ne.signal,"options.signal"),V=a(V),x(B)||T(B))return U(B,ne,V);if(!I(B))throw new r("stream",["ReadableStream","WritableStream","Stream"],B);const re=(Q=ne.readable)!==null&&Q!==void 0?Q:v(B),de=(ee=ne.writable)!==null&&ee!==void 0?ee:C(B),me=B._writableState,De=B._readableState,je=()=>{B.writable||Ue()};let Te=j(B)&&v(B)===re&&C(B)===de,_e=A(B,!1);const Ue=()=>{_e=!0,B.destroyed&&(Te=!1),!(Te&&(!B.readable||re))&&(!re||Qe)&&V.call(B)};let Qe=w(B,!1);const We=()=>{Qe=!0,B.destroyed&&(Te=!1),!(Te&&(!B.writable||de))&&(!de||_e)&&V.call(B)},Pe=se=>{V.call(B,se)};let Y=y(B);const ye=()=>{Y=!0;const se=N(B)||_(B);if(se&&typeof se!="boolean")return V.call(B,se);if(re&&!Qe&&v(B,!0)&&!w(B,!1))return V.call(B,new s);if(de&&!_e&&!A(B,!1))return V.call(B,new s);V.call(B)},Me=()=>{Y=!0;const se=N(B)||_(B);if(se&&typeof se!="boolean")return V.call(B,se);V.call(B)},ue=()=>{B.req.on("finish",Ue)};H(B)?(B.on("complete",Ue),Te||B.on("abort",ye),B.req?ue():B.on("request",ue)):de&&!me&&(B.on("end",je),B.on("close",je)),!Te&&typeof B.aborted=="boolean"&&B.on("aborted",ye),B.on("end",We),B.on("finish",Ue),ne.error!==!1&&B.on("error",Pe),B.on("close",ye),Y?e.nextTick(ye):me!=null&&me.errorEmitted||De!=null&&De.errorEmitted?Te||e.nextTick(Me):(!re&&(!Te||b(B))&&(_e||k(B)===!1)||!de&&(!Te||k(B))&&(Qe||b(B)===!1)||De&&B.req&&B.aborted)&&e.nextTick(Me);const oe=()=>{V=O,B.removeListener("aborted",ye),B.removeListener("complete",Ue),B.removeListener("abort",ye),B.removeListener("request",ue),B.req&&B.req.removeListener("finish",Ue),B.removeListener("end",je),B.removeListener("close",je),B.removeListener("finish",Ue),B.removeListener("end",We),B.removeListener("error",Pe),B.removeListener("close",ye)};if(ne.signal&&!Y){const se=()=>{const Ie=V;oe(),Ie.call(B,new t(void 0,{cause:ne.signal.reason}))};if(ne.signal.aborted)e.nextTick(se);else{D=D||Wo().addAbortListener;const Ie=D(ne.signal,se),Be=V;V=a((...Re)=>{Ie[m](),Be.apply(B,Re)})}}return oe}function U(B,ne,V){let Q=!1,ee=O;if(ne.signal)if(ee=()=>{Q=!0,V.call(B,new t(void 0,{cause:ne.signal.reason}))},ne.signal.aborted)e.nextTick(ee);else{D=D||Wo().addAbortListener;const de=D(ne.signal,ee),me=V;V=a((...De)=>{de[m](),me.apply(B,De)})}const re=(...de)=>{Q||e.nextTick(()=>V.apply(B,de))};return h(B[L].promise,re,re),O}function W(B,ne){var V;let Q=!1;return ne===null&&(ne=i),(V=ne)!==null&&V!==void 0&&V.cleanup&&(u(ne.cleanup,"cleanup"),Q=ne.cleanup),new d((ee,re)=>{const de=K(B,ne,me=>{Q&&de(),me?re(me):ee()})})}return X_.exports=K,X_.exports.finished=W,X_.exports}var EI,Tz;function ob(){if(Tz)return EI;Tz=1;const e=ag(),{aggregateTwoErrors:t,codes:{ERR_MULTIPLE_CALLBACK:n},AbortError:r}=Eo(),{Symbol:s}=ri(),{kIsDestroyed:i,isDestroyed:a,isFinished:o,isServerRequest:l}=bf(),c=s("kDestroy"),u=s("kConstruct");function d(j,L,D){j&&(j.stack,L&&!L.errored&&(L.errored=j),D&&!D.errored&&(D.errored=j))}function h(j,L){const D=this._readableState,H=this._writableState,O=H||D;return H!=null&&H.destroyed||D!=null&&D.destroyed?(typeof L=="function"&&L(),this):(d(j,H,D),H&&(H.destroyed=!0),D&&(D.destroyed=!0),O.constructed?m(this,j,L):this.once(c,function(K){m(this,t(K,j),L)}),this)}function m(j,L,D){let H=!1;function O(K){if(H)return;H=!0;const U=j._readableState,W=j._writableState;d(K,W,U),W&&(W.closed=!0),U&&(U.closed=!0),typeof D=="function"&&D(K),K?e.nextTick(y,j,K):e.nextTick(b,j)}try{j._destroy(L||null,O)}catch(K){O(K)}}function y(j,L){v(j,L),b(j)}function b(j){const L=j._readableState,D=j._writableState;D&&(D.closeEmitted=!0),L&&(L.closeEmitted=!0),(D!=null&&D.emitClose||L!=null&&L.emitClose)&&j.emit("close")}function v(j,L){const D=j._readableState,H=j._writableState;H!=null&&H.errorEmitted||D!=null&&D.errorEmitted||(H&&(H.errorEmitted=!0),D&&(D.errorEmitted=!0),j.emit("error",L))}function x(){const j=this._readableState,L=this._writableState;j&&(j.constructed=!0,j.closed=!1,j.closeEmitted=!1,j.destroyed=!1,j.errored=null,j.errorEmitted=!1,j.reading=!1,j.ended=j.readable===!1,j.endEmitted=j.readable===!1),L&&(L.constructed=!0,L.destroyed=!1,L.closed=!1,L.closeEmitted=!1,L.errored=null,L.errorEmitted=!1,L.finalCalled=!1,L.prefinished=!1,L.ended=L.writable===!1,L.ending=L.writable===!1,L.finished=L.writable===!1)}function w(j,L,D){const H=j._readableState,O=j._writableState;if(O!=null&&O.destroyed||H!=null&&H.destroyed)return this;H!=null&&H.autoDestroy||O!=null&&O.autoDestroy?j.destroy(L):L&&(L.stack,O&&!O.errored&&(O.errored=L),H&&!H.errored&&(H.errored=L),D?e.nextTick(v,j,L):v(j,L))}function _(j,L){if(typeof j._construct!="function")return;const D=j._readableState,H=j._writableState;D&&(D.constructed=!1),H&&(H.constructed=!1),j.once(u,L),!(j.listenerCount(u)>1)&&e.nextTick(k,j)}function k(j){let L=!1;function D(H){if(L){w(j,H??new n);return}L=!0;const O=j._readableState,K=j._writableState,U=K||O;O&&(O.constructed=!0),K&&(K.constructed=!0),U.destroyed?j.emit(c,H):H?w(j,H,!0):e.nextTick(C,j)}try{j._construct(H=>{e.nextTick(D,H)})}catch(H){e.nextTick(D,H)}}function C(j){j.emit(u)}function T(j){return(j==null?void 0:j.setHeader)&&typeof j.abort=="function"}function A(j){j.emit("close")}function N(j,L){j.emit("error",L),e.nextTick(A,j)}function I(j,L){!j||a(j)||(!L&&!o(j)&&(L=new r),l(j)?(j.socket=null,j.destroy(L)):T(j)?j.abort():T(j.req)?j.req.abort():typeof j.destroy=="function"?j.destroy(L):typeof j.close=="function"?j.close():L?e.nextTick(N,j,L):e.nextTick(A,j),j.destroyed||(j[i]=!0))}return EI={construct:_,destroyer:I,destroy:h,undestroy:x,errorOrDestroy:w},EI}var TI,Az;function oD(){if(Az)return TI;Az=1;const{ArrayIsArray:e,ObjectSetPrototypeOf:t}=ri(),{EventEmitter:n}=sT();function r(i){n.call(this,i)}t(r.prototype,n.prototype),t(r,n),r.prototype.pipe=function(i,a){const o=this;function l(b){i.writable&&i.write(b)===!1&&o.pause&&o.pause()}o.on("data",l);function c(){o.readable&&o.resume&&o.resume()}i.on("drain",c),!i._isStdio&&(!a||a.end!==!1)&&(o.on("end",d),o.on("close",h));let u=!1;function d(){u||(u=!0,i.end())}function h(){u||(u=!0,typeof i.destroy=="function"&&i.destroy())}function m(b){y(),n.listenerCount(this,"error")===0&&this.emit("error",b)}s(o,"error",m),s(i,"error",m);function y(){o.removeListener("data",l),i.removeListener("drain",c),o.removeListener("end",d),o.removeListener("close",h),o.removeListener("error",m),i.removeListener("error",m),o.removeListener("end",y),o.removeListener("close",y),i.removeListener("close",y)}return o.on("end",y),o.on("close",y),i.on("close",y),i.emit("pipe",o),i};function s(i,a,o){if(typeof i.prependListener=="function")return i.prependListener(a,o);!i._events||!i._events[a]?i.on(a,o):e(i._events[a])?i._events[a].unshift(o):i._events[a]=[o,i._events[a]]}return TI={Stream:r,prependListener:s},TI}var AI={exports:{}},Rz;function iT(){return Rz||(Rz=1,function(e){const{SymbolDispose:t}=ri(),{AbortError:n,codes:r}=Eo(),{isNodeStream:s,isWebStream:i,kControllerErrorFunction:a}=bf(),o=lp(),{ERR_INVALID_ARG_TYPE:l}=r;let c;const u=(d,h)=>{if(typeof d!="object"||!("aborted"in d))throw new l(h,"AbortSignal",d)};e.exports.addAbortSignal=function(h,m){if(u(h,"signal"),!s(m)&&!i(m))throw new l("stream",["ReadableStream","WritableStream","Stream"],m);return e.exports.addAbortSignalNoValidate(h,m)},e.exports.addAbortSignalNoValidate=function(d,h){if(typeof d!="object"||!("aborted"in d))return h;const m=s(h)?()=>{h.destroy(new n(void 0,{cause:d.reason}))}:()=>{h[a](new n(void 0,{cause:d.reason}))};if(d.aborted)m();else{c=c||Wo().addAbortListener;const y=c(d,m);o(h,y[t])}return h}}(AI)),AI.exports}var RI,Nz;function k_e(){if(Nz)return RI;Nz=1;const{StringPrototypeSlice:e,SymbolIterator:t,TypedArrayPrototypeSet:n,Uint8Array:r}=ri(),{Buffer:s}=op(),{inspect:i}=Wo();return RI=class{constructor(){this.head=null,this.tail=null,this.length=0}push(o){const l={data:o,next:null};this.length>0?this.tail.next=l:this.head=l,this.tail=l,++this.length}unshift(o){const l={data:o,next:this.head};this.length===0&&(this.tail=l),this.head=l,++this.length}shift(){if(this.length===0)return;const o=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,o}clear(){this.head=this.tail=null,this.length=0}join(o){if(this.length===0)return"";let l=this.head,c=""+l.data;for(;(l=l.next)!==null;)c+=o+l.data;return c}concat(o){if(this.length===0)return s.alloc(0);const l=s.allocUnsafe(o>>>0);let c=this.head,u=0;for(;c;)n(l,c.data,u),u+=c.data.length,c=c.next;return l}consume(o,l){const c=this.head.data;if(o<c.length){const u=c.slice(0,o);return this.head.data=c.slice(o),u}return o===c.length?this.shift():l?this._getString(o):this._getBuffer(o)}first(){return this.head.data}*[t](){for(let o=this.head;o;o=o.next)yield o.data}_getString(o){let l="",c=this.head,u=0;do{const d=c.data;if(o>d.length)l+=d,o-=d.length;else{o===d.length?(l+=d,++u,c.next?this.head=c.next:this.head=this.tail=null):(l+=e(d,0,o),this.head=c,c.data=e(d,o));break}++u}while((c=c.next)!==null);return this.length-=u,l}_getBuffer(o){const l=s.allocUnsafe(o),c=o;let u=this.head,d=0;do{const h=u.data;if(o>h.length)n(l,h,c-o),o-=h.length;else{o===h.length?(n(l,h,c-o),++d,u.next?this.head=u.next:this.head=this.tail=null):(n(l,new r(h.buffer,h.byteOffset,o),c-o),this.head=u,u.data=h.slice(o));break}++d}while((u=u.next)!==null);return this.length-=d,l}[Symbol.for("nodejs.util.inspect.custom")](o,l){return i(this,{...l,depth:0,customInspect:!1})}},RI}var NI,Iz;function aT(){if(Iz)return NI;Iz=1;const{MathFloor:e,NumberIsInteger:t}=ri(),{validateInteger:n}=D1(),{ERR_INVALID_ARG_VALUE:r}=Eo().codes;let s=16*1024,i=16;function a(u,d,h){return u.highWaterMark!=null?u.highWaterMark:d?u[h]:null}function o(u){return u?i:s}function l(u,d){n(d,"value",0),u?i=d:s=d}function c(u,d,h,m){const y=a(d,m,h);if(y!=null){if(!t(y)||y<0){const b=m?`options.${h}`:"options.highWaterMark";throw new r(b,y)}return e(y)}return o(u.objectMode)}return NI={getHighWaterMark:c,getDefaultHighWaterMark:o,setDefaultHighWaterMark:l},NI}var II={},J_={exports:{}},Mz;function lD(){return Mz||(Mz=1,function(e,t){var n=op(),r=n.Buffer;function s(a,o){for(var l in a)o[l]=a[l]}r.from&&r.alloc&&r.allocUnsafe&&r.allocUnsafeSlow?e.exports=n:(s(n,t),t.Buffer=i);function i(a,o,l){return r(a,o,l)}s(r,i),i.from=function(a,o,l){if(typeof a=="number")throw new TypeError("Argument must not be a number");return r(a,o,l)},i.alloc=function(a,o,l){if(typeof a!="number")throw new TypeError("Argument must be a number");var c=r(a);return o!==void 0?typeof l=="string"?c.fill(o,l):c.fill(o):c.fill(0),c},i.allocUnsafe=function(a){if(typeof a!="number")throw new TypeError("Argument must be a number");return r(a)},i.allocUnsafeSlow=function(a){if(typeof a!="number")throw new TypeError("Argument must be a number");return n.SlowBuffer(a)}}(J_,J_.exports)),J_.exports}var jz;function E_e(){if(jz)return II;jz=1;var e=lD().Buffer,t=e.isEncoding||function(x){switch(x=""+x,x&&x.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function n(x){if(!x)return"utf8";for(var w;;)switch(x){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return x;default:if(w)return;x=(""+x).toLowerCase(),w=!0}}function r(x){var w=n(x);if(typeof w!="string"&&(e.isEncoding===t||!t(x)))throw new Error("Unknown encoding: "+x);return w||x}II.StringDecoder=s;function s(x){this.encoding=r(x);var w;switch(this.encoding){case"utf16le":this.text=d,this.end=h,w=4;break;case"utf8":this.fillLast=l,w=4;break;case"base64":this.text=m,this.end=y,w=3;break;default:this.write=b,this.end=v;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=e.allocUnsafe(w)}s.prototype.write=function(x){if(x.length===0)return"";var w,_;if(this.lastNeed){if(w=this.fillLast(x),w===void 0)return"";_=this.lastNeed,this.lastNeed=0}else _=0;return _<x.length?w?w+this.text(x,_):this.text(x,_):w||""},s.prototype.end=u,s.prototype.text=c,s.prototype.fillLast=function(x){if(this.lastNeed<=x.length)return x.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);x.copy(this.lastChar,this.lastTotal-this.lastNeed,0,x.length),this.lastNeed-=x.length};function i(x){return x<=127?0:x>>5===6?2:x>>4===14?3:x>>3===30?4:x>>6===2?-1:-2}function a(x,w,_){var k=w.length-1;if(k<_)return 0;var C=i(w[k]);return C>=0?(C>0&&(x.lastNeed=C-1),C):--k<_||C===-2?0:(C=i(w[k]),C>=0?(C>0&&(x.lastNeed=C-2),C):--k<_||C===-2?0:(C=i(w[k]),C>=0?(C>0&&(C===2?C=0:x.lastNeed=C-3),C):0))}function o(x,w,_){if((w[0]&192)!==128)return x.lastNeed=0,"�";if(x.lastNeed>1&&w.length>1){if((w[1]&192)!==128)return x.lastNeed=1,"�";if(x.lastNeed>2&&w.length>2&&(w[2]&192)!==128)return x.lastNeed=2,"�"}}function l(x){var w=this.lastTotal-this.lastNeed,_=o(this,x);if(_!==void 0)return _;if(this.lastNeed<=x.length)return x.copy(this.lastChar,w,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);x.copy(this.lastChar,w,0,x.length),this.lastNeed-=x.length}function c(x,w){var _=a(this,x,w);if(!this.lastNeed)return x.toString("utf8",w);this.lastTotal=_;var k=x.length-(_-this.lastNeed);return x.copy(this.lastChar,0,k),x.toString("utf8",w,k)}function u(x){var w=x&&x.length?this.write(x):"";return this.lastNeed?w+"�":w}function d(x,w){if((x.length-w)%2===0){var _=x.toString("utf16le",w);if(_){var k=_.charCodeAt(_.length-1);if(k>=55296&&k<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=x[x.length-2],this.lastChar[1]=x[x.length-1],_.slice(0,-1)}return _}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=x[x.length-1],x.toString("utf16le",w,x.length-1)}function h(x){var w=x&&x.length?this.write(x):"";if(this.lastNeed){var _=this.lastTotal-this.lastNeed;return w+this.lastChar.toString("utf16le",0,_)}return w}function m(x,w){var _=(x.length-w)%3;return _===0?x.toString("base64",w):(this.lastNeed=3-_,this.lastTotal=3,_===1?this.lastChar[0]=x[x.length-1]:(this.lastChar[0]=x[x.length-2],this.lastChar[1]=x[x.length-1]),x.toString("base64",w,x.length-_))}function y(x){var w=x&&x.length?this.write(x):"";return this.lastNeed?w+this.lastChar.toString("base64",0,3-this.lastNeed):w}function b(x){return x.toString(this.encoding)}function v(x){return x&&x.length?this.write(x):""}return II}var MI,Pz;function EY(){if(Pz)return MI;Pz=1;const e=ag(),{PromisePrototypeThen:t,SymbolAsyncIterator:n,SymbolIterator:r}=ri(),{Buffer:s}=op(),{ERR_INVALID_ARG_TYPE:i,ERR_STREAM_NULL_VALUES:a}=Eo().codes;function o(l,c,u){let d;if(typeof c=="string"||c instanceof s)return new l({objectMode:!0,...u,read(){this.push(c),this.push(null)}});let h;if(c&&c[n])h=!0,d=c[n]();else if(c&&c[r])h=!1,d=c[r]();else throw new i("iterable",["Iterable"],c);const m=new l({objectMode:!0,highWaterMark:1,...u});let y=!1;m._read=function(){y||(y=!0,v())},m._destroy=function(x,w){t(b(x),()=>e.nextTick(w,x),_=>e.nextTick(w,_||x))};async function b(x){const w=x!=null,_=typeof d.throw=="function";if(w&&_){const{value:k,done:C}=await d.throw(x);if(await k,C)return}if(typeof d.return=="function"){const{value:k}=await d.return();await k}}async function v(){for(;;){try{const{value:x,done:w}=h?await d.next():d.next();if(w)m.push(null);else{const _=x&&typeof x.then=="function"?await x:x;if(_===null)throw y=!1,new a;if(m.push(_))continue;y=!1}}catch(x){m.destroy(x)}break}}return m}return MI=o,MI}var jI,Oz;function oT(){if(Oz)return jI;Oz=1;const e=ag(),{ArrayPrototypeIndexOf:t,NumberIsInteger:n,NumberIsNaN:r,NumberParseInt:s,ObjectDefineProperties:i,ObjectKeys:a,ObjectSetPrototypeOf:o,Promise:l,SafeSet:c,SymbolAsyncDispose:u,SymbolAsyncIterator:d,Symbol:h}=ri();jI=Re,Re.ReadableState=Be;const{EventEmitter:m}=sT(),{Stream:y,prependListener:b}=oD(),{Buffer:v}=op(),{addAbortSignal:x}=iT(),w=lp();let _=Wo().debuglog("stream",fe=>{_=fe});const k=k_e(),C=ob(),{getHighWaterMark:T,getDefaultHighWaterMark:A}=aT(),{aggregateTwoErrors:N,codes:{ERR_INVALID_ARG_TYPE:I,ERR_METHOD_NOT_IMPLEMENTED:j,ERR_OUT_OF_RANGE:L,ERR_STREAM_PUSH_AFTER_EOF:D,ERR_STREAM_UNSHIFT_AFTER_END_EVENT:H},AbortError:O}=Eo(),{validateObject:K}=D1(),U=h("kPaused"),{StringDecoder:W}=E_e(),B=EY();o(Re.prototype,y.prototype),o(Re,y);const ne=()=>{},{errorOrDestroy:V}=C,Q=1,ee=2,re=4,de=8,me=16,De=32,je=64,Te=128,_e=256,Ue=512,Qe=1024,We=2048,Pe=4096,Y=8192,ye=16384,Me=32768,ue=65536,oe=1<<17,se=1<<18;function Ie(fe){return{enumerable:!1,get(){return(this.state&fe)!==0},set(Z){Z?this.state|=fe:this.state&=~fe}}}i(Be.prototype,{objectMode:Ie(Q),ended:Ie(ee),endEmitted:Ie(re),reading:Ie(de),constructed:Ie(me),sync:Ie(De),needReadable:Ie(je),emittedReadable:Ie(Te),readableListening:Ie(_e),resumeScheduled:Ie(Ue),errorEmitted:Ie(Qe),emitClose:Ie(We),autoDestroy:Ie(Pe),destroyed:Ie(Y),closed:Ie(ye),closeEmitted:Ie(Me),multiAwaitDrain:Ie(ue),readingMore:Ie(oe),dataEmitted:Ie(se)});function Be(fe,Z,G){typeof G!="boolean"&&(G=Z instanceof cf()),this.state=We|Pe|me|De,fe&&fe.objectMode&&(this.state|=Q),G&&fe&&fe.readableObjectMode&&(this.state|=Q),this.highWaterMark=fe?T(this,fe,"readableHighWaterMark",G):A(!1),this.buffer=new k,this.length=0,this.pipes=[],this.flowing=null,this[U]=null,fe&&fe.emitClose===!1&&(this.state&=-2049),fe&&fe.autoDestroy===!1&&(this.state&=-4097),this.errored=null,this.defaultEncoding=fe&&fe.defaultEncoding||"utf8",this.awaitDrainWriters=null,this.decoder=null,this.encoding=null,fe&&fe.encoding&&(this.decoder=new W(fe.encoding),this.encoding=fe.encoding)}function Re(fe){if(!(this instanceof Re))return new Re(fe);const Z=this instanceof cf();this._readableState=new Be(fe,this,Z),fe&&(typeof fe.read=="function"&&(this._read=fe.read),typeof fe.destroy=="function"&&(this._destroy=fe.destroy),typeof fe.construct=="function"&&(this._construct=fe.construct),fe.signal&&!Z&&x(fe.signal,this)),y.call(this,fe),C.construct(this,()=>{this._readableState.needReadable&&F(this,this._readableState)})}Re.prototype.destroy=C.destroy,Re.prototype._undestroy=C.undestroy,Re.prototype._destroy=function(fe,Z){Z(fe)},Re.prototype[m.captureRejectionSymbol]=function(fe){this.destroy(fe)},Re.prototype[u]=function(){let fe;return this.destroyed||(fe=this.readableEnded?null:new O,this.destroy(fe)),new l((Z,G)=>w(this,J=>J&&J!==fe?G(J):Z(null)))},Re.prototype.push=function(fe,Z){return ct(this,fe,Z,!1)},Re.prototype.unshift=function(fe,Z){return ct(this,fe,Z,!0)};function ct(fe,Z,G,J){_("readableAddChunk",Z);const xe=fe._readableState;let Fe;if((xe.state&Q)===0&&(typeof Z=="string"?(G=G||xe.defaultEncoding,xe.encoding!==G&&(J&&xe.encoding?Z=v.from(Z,G).toString(xe.encoding):(Z=v.from(Z,G),G=""))):Z instanceof v?G="":y._isUint8Array(Z)?(Z=y._uint8ArrayToBuffer(Z),G=""):Z!=null&&(Fe=new I("chunk",["string","Buffer","Uint8Array"],Z))),Fe)V(fe,Fe);else if(Z===null)xe.state&=-9,Ft(fe,xe);else if((xe.state&Q)!==0||Z&&Z.length>0)if(J)if((xe.state&re)!==0)V(fe,new H);else{if(xe.destroyed||xe.errored)return!1;At(fe,xe,Z,!0)}else if(xe.ended)V(fe,new D);else{if(xe.destroyed||xe.errored)return!1;xe.state&=-9,xe.decoder&&!G?(Z=xe.decoder.write(Z),xe.objectMode||Z.length!==0?At(fe,xe,Z,!1):F(fe,xe)):At(fe,xe,Z,!1)}else J||(xe.state&=-9,F(fe,xe));return!xe.ended&&(xe.length<xe.highWaterMark||xe.length===0)}function At(fe,Z,G,J){Z.flowing&&Z.length===0&&!Z.sync&&fe.listenerCount("data")>0?((Z.state&ue)!==0?Z.awaitDrainWriters.clear():Z.awaitDrainWriters=null,Z.dataEmitted=!0,fe.emit("data",G)):(Z.length+=Z.objectMode?1:G.length,J?Z.buffer.unshift(G):Z.buffer.push(G),(Z.state&je)!==0&&Yt(fe)),F(fe,Z)}Re.prototype.isPaused=function(){const fe=this._readableState;return fe[U]===!0||fe.flowing===!1},Re.prototype.setEncoding=function(fe){const Z=new W(fe);this._readableState.decoder=Z,this._readableState.encoding=this._readableState.decoder.encoding;const G=this._readableState.buffer;let J="";for(const xe of G)J+=Z.write(xe);return G.clear(),J!==""&&G.push(J),this._readableState.length=J.length,this};const ut=1073741824;function Pt(fe){if(fe>ut)throw new L("size","<= 1GiB",fe);return fe--,fe|=fe>>>1,fe|=fe>>>2,fe|=fe>>>4,fe|=fe>>>8,fe|=fe>>>16,fe++,fe}function Ut(fe,Z){return fe<=0||Z.length===0&&Z.ended?0:(Z.state&Q)!==0?1:r(fe)?Z.flowing&&Z.length?Z.buffer.first().length:Z.length:fe<=Z.length?fe:Z.ended?Z.length:0}Re.prototype.read=function(fe){_("read",fe),fe===void 0?fe=NaN:n(fe)||(fe=s(fe,10));const Z=this._readableState,G=fe;if(fe>Z.highWaterMark&&(Z.highWaterMark=Pt(fe)),fe!==0&&(Z.state&=-129),fe===0&&Z.needReadable&&((Z.highWaterMark!==0?Z.length>=Z.highWaterMark:Z.length>0)||Z.ended))return _("read: emitReadable",Z.length,Z.ended),Z.length===0&&Z.ended?tt(this):Yt(this),null;if(fe=Ut(fe,Z),fe===0&&Z.ended)return Z.length===0&&tt(this),null;let J=(Z.state&je)!==0;if(_("need readable",J),(Z.length===0||Z.length-fe<Z.highWaterMark)&&(J=!0,_("length less than watermark",J)),Z.ended||Z.reading||Z.destroyed||Z.errored||!Z.constructed)J=!1,_("reading, ended or constructing",J);else if(J){_("do read"),Z.state|=de|De,Z.length===0&&(Z.state|=je);try{this._read(Z.highWaterMark)}catch(Fe){V(this,Fe)}Z.state&=-33,Z.reading||(fe=Ut(G,Z))}let xe;return fe>0?xe=qe(fe,Z):xe=null,xe===null?(Z.needReadable=Z.length<=Z.highWaterMark,fe=0):(Z.length-=fe,Z.multiAwaitDrain?Z.awaitDrainWriters.clear():Z.awaitDrainWriters=null),Z.length===0&&(Z.ended||(Z.needReadable=!0),G!==fe&&Z.ended&&tt(this)),xe!==null&&!Z.errorEmitted&&!Z.closeEmitted&&(Z.dataEmitted=!0,this.emit("data",xe)),xe};function Ft(fe,Z){if(_("onEofChunk"),!Z.ended){if(Z.decoder){const G=Z.decoder.end();G&&G.length&&(Z.buffer.push(G),Z.length+=Z.objectMode?1:G.length)}Z.ended=!0,Z.sync?Yt(fe):(Z.needReadable=!1,Z.emittedReadable=!0,we(fe))}}function Yt(fe){const Z=fe._readableState;_("emitReadable",Z.needReadable,Z.emittedReadable),Z.needReadable=!1,Z.emittedReadable||(_("emitReadable",Z.flowing),Z.emittedReadable=!0,e.nextTick(we,fe))}function we(fe){const Z=fe._readableState;_("emitReadable_",Z.destroyed,Z.length,Z.ended),!Z.destroyed&&!Z.errored&&(Z.length||Z.ended)&&(fe.emit("readable"),Z.emittedReadable=!1),Z.needReadable=!Z.flowing&&!Z.ended&&Z.length<=Z.highWaterMark,ft(fe)}function F(fe,Z){!Z.readingMore&&Z.constructed&&(Z.readingMore=!0,e.nextTick(X,fe,Z))}function X(fe,Z){for(;!Z.reading&&!Z.ended&&(Z.length<Z.highWaterMark||Z.flowing&&Z.length===0);){const G=Z.length;if(_("maybeReadMore read 0"),fe.read(0),G===Z.length)break}Z.readingMore=!1}Re.prototype._read=function(fe){throw new j("_read()")},Re.prototype.pipe=function(fe,Z){const G=this,J=this._readableState;J.pipes.length===1&&(J.multiAwaitDrain||(J.multiAwaitDrain=!0,J.awaitDrainWriters=new c(J.awaitDrainWriters?[J.awaitDrainWriters]:[]))),J.pipes.push(fe),_("pipe count=%d opts=%j",J.pipes.length,Z);const Fe=(!Z||Z.end!==!1)&&fe!==e.stdout&&fe!==e.stderr?wt:ss;J.endEmitted?e.nextTick(Fe):G.once("end",Fe),fe.on("unpipe",He);function He(kr,gn){_("onunpipe"),kr===G&&gn&&gn.hasUnpiped===!1&&(gn.hasUnpiped=!0,Zt())}function wt(){_("onend"),fe.end()}let Qt,Dn=!1;function Zt(){_("cleanup"),fe.removeListener("close",Mr),fe.removeListener("finish",rs),Qt&&fe.removeListener("drain",Qt),fe.removeListener("error",br),fe.removeListener("unpipe",He),G.removeListener("end",wt),G.removeListener("end",ss),G.removeListener("data",fn),Dn=!0,Qt&&J.awaitDrainWriters&&(!fe._writableState||fe._writableState.needDrain)&&Qt()}function rn(){Dn||(J.pipes.length===1&&J.pipes[0]===fe?(_("false write response, pause",0),J.awaitDrainWriters=fe,J.multiAwaitDrain=!1):J.pipes.length>1&&J.pipes.includes(fe)&&(_("false write response, pause",J.awaitDrainWriters.size),J.awaitDrainWriters.add(fe)),G.pause()),Qt||(Qt=be(G,fe),fe.on("drain",Qt))}G.on("data",fn);function fn(kr){_("ondata");const gn=fe.write(kr);_("dest.write",gn),gn===!1&&rn()}function br(kr){if(_("onerror",kr),ss(),fe.removeListener("error",br),fe.listenerCount("error")===0){const gn=fe._writableState||fe._readableState;gn&&!gn.errorEmitted?V(fe,kr):fe.emit("error",kr)}}b(fe,"error",br);function Mr(){fe.removeListener("finish",rs),ss()}fe.once("close",Mr);function rs(){_("onfinish"),fe.removeListener("close",Mr),ss()}fe.once("finish",rs);function ss(){_("unpipe"),G.unpipe(fe)}return fe.emit("pipe",G),fe.writableNeedDrain===!0?rn():J.flowing||(_("pipe resume"),G.resume()),fe};function be(fe,Z){return function(){const J=fe._readableState;J.awaitDrainWriters===Z?(_("pipeOnDrain",1),J.awaitDrainWriters=null):J.multiAwaitDrain&&(_("pipeOnDrain",J.awaitDrainWriters.size),J.awaitDrainWriters.delete(Z)),(!J.awaitDrainWriters||J.awaitDrainWriters.size===0)&&fe.listenerCount("data")&&fe.resume()}}Re.prototype.unpipe=function(fe){const Z=this._readableState,G={hasUnpiped:!1};if(Z.pipes.length===0)return this;if(!fe){const xe=Z.pipes;Z.pipes=[],this.pause();for(let Fe=0;Fe<xe.length;Fe++)xe[Fe].emit("unpipe",this,{hasUnpiped:!1});return this}const J=t(Z.pipes,fe);return J===-1?this:(Z.pipes.splice(J,1),Z.pipes.length===0&&this.pause(),fe.emit("unpipe",this,G),this)},Re.prototype.on=function(fe,Z){const G=y.prototype.on.call(this,fe,Z),J=this._readableState;return fe==="data"?(J.readableListening=this.listenerCount("readable")>0,J.flowing!==!1&&this.resume()):fe==="readable"&&!J.endEmitted&&!J.readableListening&&(J.readableListening=J.needReadable=!0,J.flowing=!1,J.emittedReadable=!1,_("on readable",J.length,J.reading),J.length?Yt(this):J.reading||e.nextTick(ge,this)),G},Re.prototype.addListener=Re.prototype.on,Re.prototype.removeListener=function(fe,Z){const G=y.prototype.removeListener.call(this,fe,Z);return fe==="readable"&&e.nextTick(Ee,this),G},Re.prototype.off=Re.prototype.removeListener,Re.prototype.removeAllListeners=function(fe){const Z=y.prototype.removeAllListeners.apply(this,arguments);return(fe==="readable"||fe===void 0)&&e.nextTick(Ee,this),Z};function Ee(fe){const Z=fe._readableState;Z.readableListening=fe.listenerCount("readable")>0,Z.resumeScheduled&&Z[U]===!1?Z.flowing=!0:fe.listenerCount("data")>0?fe.resume():Z.readableListening||(Z.flowing=null)}function ge(fe){_("readable nexttick read 0"),fe.read(0)}Re.prototype.resume=function(){const fe=this._readableState;return fe.flowing||(_("resume"),fe.flowing=!fe.readableListening,Ae(this,fe)),fe[U]=!1,this};function Ae(fe,Z){Z.resumeScheduled||(Z.resumeScheduled=!0,e.nextTick(le,fe,Z))}function le(fe,Z){_("resume",Z.reading),Z.reading||fe.read(0),Z.resumeScheduled=!1,fe.emit("resume"),ft(fe),Z.flowing&&!Z.reading&&fe.read(0)}Re.prototype.pause=function(){return _("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(_("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState[U]=!0,this};function ft(fe){const Z=fe._readableState;for(_("flow",Z.flowing);Z.flowing&&fe.read()!==null;);}Re.prototype.wrap=function(fe){let Z=!1;fe.on("data",J=>{!this.push(J)&&fe.pause&&(Z=!0,fe.pause())}),fe.on("end",()=>{this.push(null)}),fe.on("error",J=>{V(this,J)}),fe.on("close",()=>{this.destroy()}),fe.on("destroy",()=>{this.destroy()}),this._read=()=>{Z&&fe.resume&&(Z=!1,fe.resume())};const G=a(fe);for(let J=1;J<G.length;J++){const xe=G[J];this[xe]===void 0&&typeof fe[xe]=="function"&&(this[xe]=fe[xe].bind(fe))}return this},Re.prototype[d]=function(){return et(this)},Re.prototype.iterator=function(fe){return fe!==void 0&&K(fe,"options"),et(this,fe)};function et(fe,Z){typeof fe.read!="function"&&(fe=Re.wrap(fe,{objectMode:!0}));const G=$(fe,Z);return G.stream=fe,G}async function*$(fe,Z){let G=ne;function J(He){this===fe?(G(),G=ne):G=He}fe.on("readable",J);let xe;const Fe=w(fe,{writable:!1},He=>{xe=He?N(xe,He):null,G(),G=ne});try{for(;;){const He=fe.destroyed?null:fe.read();if(He!==null)yield He;else{if(xe)throw xe;if(xe===null)return;await new l(J)}}}catch(He){throw xe=N(xe,He),xe}finally{(xe||(Z==null?void 0:Z.destroyOnReturn)!==!1)&&(xe===void 0||fe._readableState.autoDestroy)?C.destroyer(fe,null):(fe.off("readable",J),Fe())}}i(Re.prototype,{readable:{__proto__:null,get(){const fe=this._readableState;return!!fe&&fe.readable!==!1&&!fe.destroyed&&!fe.errorEmitted&&!fe.endEmitted},set(fe){this._readableState&&(this._readableState.readable=!!fe)}},readableDidRead:{__proto__:null,enumerable:!1,get:function(){return this._readableState.dataEmitted}},readableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(this._readableState.readable!==!1&&(this._readableState.destroyed||this._readableState.errored)&&!this._readableState.endEmitted)}},readableHighWaterMark:{__proto__:null,enumerable:!1,get:function(){return this._readableState.highWaterMark}},readableBuffer:{__proto__:null,enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}},readableFlowing:{__proto__:null,enumerable:!1,get:function(){return this._readableState.flowing},set:function(fe){this._readableState&&(this._readableState.flowing=fe)}},readableLength:{__proto__:null,enumerable:!1,get(){return this._readableState.length}},readableObjectMode:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.objectMode:!1}},readableEncoding:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.encoding:null}},errored:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.errored:null}},closed:{__proto__:null,get(){return this._readableState?this._readableState.closed:!1}},destroyed:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.destroyed:!1},set(fe){this._readableState&&(this._readableState.destroyed=fe)}},readableEnded:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.endEmitted:!1}}}),i(Be.prototype,{pipesCount:{__proto__:null,get(){return this.pipes.length}},paused:{__proto__:null,get(){return this[U]!==!1},set(fe){this[U]=!!fe}}}),Re._fromList=qe;function qe(fe,Z){if(Z.length===0)return null;let G;return Z.objectMode?G=Z.buffer.shift():!fe||fe>=Z.length?(Z.decoder?G=Z.buffer.join(""):Z.buffer.length===1?G=Z.buffer.first():G=Z.buffer.concat(Z.length),Z.buffer.clear()):G=Z.buffer.consume(fe,Z.decoder),G}function tt(fe){const Z=fe._readableState;_("endReadable",Z.endEmitted),Z.endEmitted||(Z.ended=!0,e.nextTick(ve,Z,fe))}function ve(fe,Z){if(_("endReadableNT",fe.endEmitted,fe.length),!fe.errored&&!fe.closeEmitted&&!fe.endEmitted&&fe.length===0){if(fe.endEmitted=!0,Z.emit("end"),Z.writable&&Z.allowHalfOpen===!1)e.nextTick(Se,Z);else if(fe.autoDestroy){const G=Z._writableState;(!G||G.autoDestroy&&(G.finished||G.writable===!1))&&Z.destroy()}}}function Se(fe){fe.writable&&!fe.writableEnded&&!fe.destroyed&&fe.end()}Re.from=function(fe,Z){return B(Re,fe,Z)};let ze;function Ct(){return ze===void 0&&(ze={}),ze}return Re.fromWeb=function(fe,Z){return Ct().newStreamReadableFromReadableStream(fe,Z)},Re.toWeb=function(fe,Z){return Ct().newReadableStreamFromStreamReadable(fe,Z)},Re.wrap=function(fe,Z){var G,J;return new Re({objectMode:(G=(J=fe.readableObjectMode)!==null&&J!==void 0?J:fe.objectMode)!==null&&G!==void 0?G:!0,...Z,destroy(xe,Fe){C.destroyer(fe,xe),Fe(xe)}}).wrap(fe)},jI}var PI,Dz;function cD(){if(Dz)return PI;Dz=1;const e=ag(),{ArrayPrototypeSlice:t,Error:n,FunctionPrototypeSymbolHasInstance:r,ObjectDefineProperty:s,ObjectDefineProperties:i,ObjectSetPrototypeOf:a,StringPrototypeToLowerCase:o,Symbol:l,SymbolHasInstance:c}=ri();PI=K,K.WritableState=H;const{EventEmitter:u}=sT(),d=oD().Stream,{Buffer:h}=op(),m=ob(),{addAbortSignal:y}=iT(),{getHighWaterMark:b,getDefaultHighWaterMark:v}=aT(),{ERR_INVALID_ARG_TYPE:x,ERR_METHOD_NOT_IMPLEMENTED:w,ERR_MULTIPLE_CALLBACK:_,ERR_STREAM_CANNOT_PIPE:k,ERR_STREAM_DESTROYED:C,ERR_STREAM_ALREADY_FINISHED:T,ERR_STREAM_NULL_VALUES:A,ERR_STREAM_WRITE_AFTER_END:N,ERR_UNKNOWN_ENCODING:I}=Eo().codes,{errorOrDestroy:j}=m;a(K.prototype,d.prototype),a(K,d);function L(){}const D=l("kOnFinished");function H(Pe,Y,ye){typeof ye!="boolean"&&(ye=Y instanceof cf()),this.objectMode=!!(Pe&&Pe.objectMode),ye&&(this.objectMode=this.objectMode||!!(Pe&&Pe.writableObjectMode)),this.highWaterMark=Pe?b(this,Pe,"writableHighWaterMark",ye):v(!1),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;const Me=!!(Pe&&Pe.decodeStrings===!1);this.decodeStrings=!Me,this.defaultEncoding=Pe&&Pe.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=V.bind(void 0,Y),this.writecb=null,this.writelen=0,this.afterWriteTickInfo=null,O(this),this.pendingcb=0,this.constructed=!0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!Pe||Pe.emitClose!==!1,this.autoDestroy=!Pe||Pe.autoDestroy!==!1,this.errored=null,this.closed=!1,this.closeEmitted=!1,this[D]=[]}function O(Pe){Pe.buffered=[],Pe.bufferedIndex=0,Pe.allBuffers=!0,Pe.allNoop=!0}H.prototype.getBuffer=function(){return t(this.buffered,this.bufferedIndex)},s(H.prototype,"bufferedRequestCount",{__proto__:null,get(){return this.buffered.length-this.bufferedIndex}});function K(Pe){const Y=this instanceof cf();if(!Y&&!r(K,this))return new K(Pe);this._writableState=new H(Pe,this,Y),Pe&&(typeof Pe.write=="function"&&(this._write=Pe.write),typeof Pe.writev=="function"&&(this._writev=Pe.writev),typeof Pe.destroy=="function"&&(this._destroy=Pe.destroy),typeof Pe.final=="function"&&(this._final=Pe.final),typeof Pe.construct=="function"&&(this._construct=Pe.construct),Pe.signal&&y(Pe.signal,this)),d.call(this,Pe),m.construct(this,()=>{const ye=this._writableState;ye.writing||de(this,ye),Te(this,ye)})}s(K,c,{__proto__:null,value:function(Pe){return r(this,Pe)?!0:this!==K?!1:Pe&&Pe._writableState instanceof H}}),K.prototype.pipe=function(){j(this,new k)};function U(Pe,Y,ye,Me){const ue=Pe._writableState;if(typeof ye=="function")Me=ye,ye=ue.defaultEncoding;else{if(!ye)ye=ue.defaultEncoding;else if(ye!=="buffer"&&!h.isEncoding(ye))throw new I(ye);typeof Me!="function"&&(Me=L)}if(Y===null)throw new A;if(!ue.objectMode)if(typeof Y=="string")ue.decodeStrings!==!1&&(Y=h.from(Y,ye),ye="buffer");else if(Y instanceof h)ye="buffer";else if(d._isUint8Array(Y))Y=d._uint8ArrayToBuffer(Y),ye="buffer";else throw new x("chunk",["string","Buffer","Uint8Array"],Y);let oe;return ue.ending?oe=new N:ue.destroyed&&(oe=new C("write")),oe?(e.nextTick(Me,oe),j(Pe,oe,!0),oe):(ue.pendingcb++,W(Pe,ue,Y,ye,Me))}K.prototype.write=function(Pe,Y,ye){return U(this,Pe,Y,ye)===!0},K.prototype.cork=function(){this._writableState.corked++},K.prototype.uncork=function(){const Pe=this._writableState;Pe.corked&&(Pe.corked--,Pe.writing||de(this,Pe))},K.prototype.setDefaultEncoding=function(Y){if(typeof Y=="string"&&(Y=o(Y)),!h.isEncoding(Y))throw new I(Y);return this._writableState.defaultEncoding=Y,this};function W(Pe,Y,ye,Me,ue){const oe=Y.objectMode?1:ye.length;Y.length+=oe;const se=Y.length<Y.highWaterMark;return se||(Y.needDrain=!0),Y.writing||Y.corked||Y.errored||!Y.constructed?(Y.buffered.push({chunk:ye,encoding:Me,callback:ue}),Y.allBuffers&&Me!=="buffer"&&(Y.allBuffers=!1),Y.allNoop&&ue!==L&&(Y.allNoop=!1)):(Y.writelen=oe,Y.writecb=ue,Y.writing=!0,Y.sync=!0,Pe._write(ye,Me,Y.onwrite),Y.sync=!1),se&&!Y.errored&&!Y.destroyed}function B(Pe,Y,ye,Me,ue,oe,se){Y.writelen=Me,Y.writecb=se,Y.writing=!0,Y.sync=!0,Y.destroyed?Y.onwrite(new C("write")):ye?Pe._writev(ue,Y.onwrite):Pe._write(ue,oe,Y.onwrite),Y.sync=!1}function ne(Pe,Y,ye,Me){--Y.pendingcb,Me(ye),re(Y),j(Pe,ye)}function V(Pe,Y){const ye=Pe._writableState,Me=ye.sync,ue=ye.writecb;if(typeof ue!="function"){j(Pe,new _);return}ye.writing=!1,ye.writecb=null,ye.length-=ye.writelen,ye.writelen=0,Y?(Y.stack,ye.errored||(ye.errored=Y),Pe._readableState&&!Pe._readableState.errored&&(Pe._readableState.errored=Y),Me?e.nextTick(ne,Pe,ye,Y,ue):ne(Pe,ye,Y,ue)):(ye.buffered.length>ye.bufferedIndex&&de(Pe,ye),Me?ye.afterWriteTickInfo!==null&&ye.afterWriteTickInfo.cb===ue?ye.afterWriteTickInfo.count++:(ye.afterWriteTickInfo={count:1,cb:ue,stream:Pe,state:ye},e.nextTick(Q,ye.afterWriteTickInfo)):ee(Pe,ye,1,ue))}function Q({stream:Pe,state:Y,count:ye,cb:Me}){return Y.afterWriteTickInfo=null,ee(Pe,Y,ye,Me)}function ee(Pe,Y,ye,Me){for(!Y.ending&&!Pe.destroyed&&Y.length===0&&Y.needDrain&&(Y.needDrain=!1,Pe.emit("drain"));ye-- >0;)Y.pendingcb--,Me();Y.destroyed&&re(Y),Te(Pe,Y)}function re(Pe){if(Pe.writing)return;for(let ue=Pe.bufferedIndex;ue<Pe.buffered.length;++ue){var Y;const{chunk:oe,callback:se}=Pe.buffered[ue],Ie=Pe.objectMode?1:oe.length;Pe.length-=Ie,se((Y=Pe.errored)!==null&&Y!==void 0?Y:new C("write"))}const ye=Pe[D].splice(0);for(let ue=0;ue<ye.length;ue++){var Me;ye[ue]((Me=Pe.errored)!==null&&Me!==void 0?Me:new C("end"))}O(Pe)}function de(Pe,Y){if(Y.corked||Y.bufferProcessing||Y.destroyed||!Y.constructed)return;const{buffered:ye,bufferedIndex:Me,objectMode:ue}=Y,oe=ye.length-Me;if(!oe)return;let se=Me;if(Y.bufferProcessing=!0,oe>1&&Pe._writev){Y.pendingcb-=oe-1;const Ie=Y.allNoop?L:Re=>{for(let ct=se;ct<ye.length;++ct)ye[ct].callback(Re)},Be=Y.allNoop&&se===0?ye:t(ye,se);Be.allBuffers=Y.allBuffers,B(Pe,Y,!0,Y.length,Be,"",Ie),O(Y)}else{do{const{chunk:Ie,encoding:Be,callback:Re}=ye[se];ye[se++]=null;const ct=ue?1:Ie.length;B(Pe,Y,!1,ct,Ie,Be,Re)}while(se<ye.length&&!Y.writing);se===ye.length?O(Y):se>256?(ye.splice(0,se),Y.bufferedIndex=0):Y.bufferedIndex=se}Y.bufferProcessing=!1}K.prototype._write=function(Pe,Y,ye){if(this._writev)this._writev([{chunk:Pe,encoding:Y}],ye);else throw new w("_write()")},K.prototype._writev=null,K.prototype.end=function(Pe,Y,ye){const Me=this._writableState;typeof Pe=="function"?(ye=Pe,Pe=null,Y=null):typeof Y=="function"&&(ye=Y,Y=null);let ue;if(Pe!=null){const oe=U(this,Pe,Y);oe instanceof n&&(ue=oe)}return Me.corked&&(Me.corked=1,this.uncork()),ue||(!Me.errored&&!Me.ending?(Me.ending=!0,Te(this,Me,!0),Me.ended=!0):Me.finished?ue=new T("end"):Me.destroyed&&(ue=new C("end"))),typeof ye=="function"&&(ue||Me.finished?e.nextTick(ye,ue):Me[D].push(ye)),this};function me(Pe){return Pe.ending&&!Pe.destroyed&&Pe.constructed&&Pe.length===0&&!Pe.errored&&Pe.buffered.length===0&&!Pe.finished&&!Pe.writing&&!Pe.errorEmitted&&!Pe.closeEmitted}function De(Pe,Y){let ye=!1;function Me(ue){if(ye){j(Pe,ue??_());return}if(ye=!0,Y.pendingcb--,ue){const oe=Y[D].splice(0);for(let se=0;se<oe.length;se++)oe[se](ue);j(Pe,ue,Y.sync)}else me(Y)&&(Y.prefinished=!0,Pe.emit("prefinish"),Y.pendingcb++,e.nextTick(_e,Pe,Y))}Y.sync=!0,Y.pendingcb++;try{Pe._final(Me)}catch(ue){Me(ue)}Y.sync=!1}function je(Pe,Y){!Y.prefinished&&!Y.finalCalled&&(typeof Pe._final=="function"&&!Y.destroyed?(Y.finalCalled=!0,De(Pe,Y)):(Y.prefinished=!0,Pe.emit("prefinish")))}function Te(Pe,Y,ye){me(Y)&&(je(Pe,Y),Y.pendingcb===0&&(ye?(Y.pendingcb++,e.nextTick((Me,ue)=>{me(ue)?_e(Me,ue):ue.pendingcb--},Pe,Y)):me(Y)&&(Y.pendingcb++,_e(Pe,Y))))}function _e(Pe,Y){Y.pendingcb--,Y.finished=!0;const ye=Y[D].splice(0);for(let Me=0;Me<ye.length;Me++)ye[Me]();if(Pe.emit("finish"),Y.autoDestroy){const Me=Pe._readableState;(!Me||Me.autoDestroy&&(Me.endEmitted||Me.readable===!1))&&Pe.destroy()}}i(K.prototype,{closed:{__proto__:null,get(){return this._writableState?this._writableState.closed:!1}},destroyed:{__proto__:null,get(){return this._writableState?this._writableState.destroyed:!1},set(Pe){this._writableState&&(this._writableState.destroyed=Pe)}},writable:{__proto__:null,get(){const Pe=this._writableState;return!!Pe&&Pe.writable!==!1&&!Pe.destroyed&&!Pe.errored&&!Pe.ending&&!Pe.ended},set(Pe){this._writableState&&(this._writableState.writable=!!Pe)}},writableFinished:{__proto__:null,get(){return this._writableState?this._writableState.finished:!1}},writableObjectMode:{__proto__:null,get(){return this._writableState?this._writableState.objectMode:!1}},writableBuffer:{__proto__:null,get(){return this._writableState&&this._writableState.getBuffer()}},writableEnded:{__proto__:null,get(){return this._writableState?this._writableState.ending:!1}},writableNeedDrain:{__proto__:null,get(){const Pe=this._writableState;return Pe?!Pe.destroyed&&!Pe.ending&&Pe.needDrain:!1}},writableHighWaterMark:{__proto__:null,get(){return this._writableState&&this._writableState.highWaterMark}},writableCorked:{__proto__:null,get(){return this._writableState?this._writableState.corked:0}},writableLength:{__proto__:null,get(){return this._writableState&&this._writableState.length}},errored:{__proto__:null,enumerable:!1,get(){return this._writableState?this._writableState.errored:null}},writableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(this._writableState.writable!==!1&&(this._writableState.destroyed||this._writableState.errored)&&!this._writableState.finished)}}});const Ue=m.destroy;K.prototype.destroy=function(Pe,Y){const ye=this._writableState;return!ye.destroyed&&(ye.bufferedIndex<ye.buffered.length||ye[D].length)&&e.nextTick(re,ye),Ue.call(this,Pe,Y),this},K.prototype._undestroy=m.undestroy,K.prototype._destroy=function(Pe,Y){Y(Pe)},K.prototype[u.captureRejectionSymbol]=function(Pe){this.destroy(Pe)};let Qe;function We(){return Qe===void 0&&(Qe={}),Qe}return K.fromWeb=function(Pe,Y){return We().newStreamWritableFromWritableStream(Pe,Y)},K.toWeb=function(Pe){return We().newWritableStreamFromStreamWritable(Pe)},PI}var OI,Fz;function T_e(){if(Fz)return OI;Fz=1;const e=ag(),t=op(),{isReadable:n,isWritable:r,isIterable:s,isNodeStream:i,isReadableNodeStream:a,isWritableNodeStream:o,isDuplexNodeStream:l,isReadableStream:c,isWritableStream:u}=bf(),d=lp(),{AbortError:h,codes:{ERR_INVALID_ARG_TYPE:m,ERR_INVALID_RETURN_VALUE:y}}=Eo(),{destroyer:b}=ob(),v=cf(),x=oT(),w=cD(),{createDeferredPromise:_}=Wo(),k=EY(),C=globalThis.Blob||t.Blob,T=typeof C<"u"?function(H){return H instanceof C}:function(H){return!1},A=globalThis.AbortController||Sw().AbortController,{FunctionPrototypeCall:N}=ri();class I extends v{constructor(H){super(H),(H==null?void 0:H.readable)===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),(H==null?void 0:H.writable)===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)}}OI=function D(H,O){if(l(H))return H;if(a(H))return L({readable:H});if(o(H))return L({writable:H});if(i(H))return L({writable:!1,readable:!1});if(c(H))return L({readable:x.fromWeb(H)});if(u(H))return L({writable:w.fromWeb(H)});if(typeof H=="function"){const{value:U,write:W,final:B,destroy:ne}=j(H);if(s(U))return k(I,U,{objectMode:!0,write:W,final:B,destroy:ne});const V=U==null?void 0:U.then;if(typeof V=="function"){let Q;const ee=N(V,U,re=>{if(re!=null)throw new y("nully","body",re)},re=>{b(Q,re)});return Q=new I({objectMode:!0,readable:!1,write:W,final(re){B(async()=>{try{await ee,e.nextTick(re,null)}catch(de){e.nextTick(re,de)}})},destroy:ne})}throw new y("Iterable, AsyncIterable or AsyncFunction",O,U)}if(T(H))return D(H.arrayBuffer());if(s(H))return k(I,H,{objectMode:!0,writable:!1});if(c(H==null?void 0:H.readable)&&u(H==null?void 0:H.writable))return I.fromWeb(H);if(typeof(H==null?void 0:H.writable)=="object"||typeof(H==null?void 0:H.readable)=="object"){const U=H!=null&&H.readable?a(H==null?void 0:H.readable)?H==null?void 0:H.readable:D(H.readable):void 0,W=H!=null&&H.writable?o(H==null?void 0:H.writable)?H==null?void 0:H.writable:D(H.writable):void 0;return L({readable:U,writable:W})}const K=H==null?void 0:H.then;if(typeof K=="function"){let U;return N(K,H,W=>{W!=null&&U.push(W),U.push(null)},W=>{b(U,W)}),U=new I({objectMode:!0,writable:!1,read(){}})}throw new m(O,["Blob","ReadableStream","WritableStream","Stream","Iterable","AsyncIterable","Function","{ readable, writable } pair","Promise"],H)};function j(D){let{promise:H,resolve:O}=_();const K=new A,U=K.signal;return{value:D(async function*(){for(;;){const B=H;H=null;const{chunk:ne,done:V,cb:Q}=await B;if(e.nextTick(Q),V)return;if(U.aborted)throw new h(void 0,{cause:U.reason});({promise:H,resolve:O}=_()),yield ne}}(),{signal:U}),write(B,ne,V){const Q=O;O=null,Q({chunk:B,done:!1,cb:V})},final(B){const ne=O;O=null,ne({done:!0,cb:B})},destroy(B,ne){K.abort(),ne(B)}}}function L(D){const H=D.readable&&typeof D.readable.read!="function"?x.wrap(D.readable):D.readable,O=D.writable;let K=!!n(H),U=!!r(O),W,B,ne,V,Q;function ee(re){const de=V;V=null,de?de(re):re&&Q.destroy(re)}return Q=new I({readableObjectMode:!!(H!=null&&H.readableObjectMode),writableObjectMode:!!(O!=null&&O.writableObjectMode),readable:K,writable:U}),U&&(d(O,re=>{U=!1,re&&b(H,re),ee(re)}),Q._write=function(re,de,me){O.write(re,de)?me():W=me},Q._final=function(re){O.end(),B=re},O.on("drain",function(){if(W){const re=W;W=null,re()}}),O.on("finish",function(){if(B){const re=B;B=null,re()}})),K&&(d(H,re=>{K=!1,re&&b(H,re),ee(re)}),H.on("readable",function(){if(ne){const re=ne;ne=null,re()}}),H.on("end",function(){Q.push(null)}),Q._read=function(){for(;;){const re=H.read();if(re===null){ne=Q._read;return}if(!Q.push(re))return}}),Q._destroy=function(re,de){!re&&V!==null&&(re=new h),ne=null,W=null,B=null,V===null?de(re):(V=de,b(O,re),b(H,re))},Q}return OI}var DI,Lz;function cf(){if(Lz)return DI;Lz=1;const{ObjectDefineProperties:e,ObjectGetOwnPropertyDescriptor:t,ObjectKeys:n,ObjectSetPrototypeOf:r}=ri();DI=a;const s=oT(),i=cD();r(a.prototype,s.prototype),r(a,s);{const u=n(i.prototype);for(let d=0;d<u.length;d++){const h=u[d];a.prototype[h]||(a.prototype[h]=i.prototype[h])}}function a(u){if(!(this instanceof a))return new a(u);s.call(this,u),i.call(this,u),u?(this.allowHalfOpen=u.allowHalfOpen!==!1,u.readable===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),u.writable===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)):this.allowHalfOpen=!0}e(a.prototype,{writable:{__proto__:null,...t(i.prototype,"writable")},writableHighWaterMark:{__proto__:null,...t(i.prototype,"writableHighWaterMark")},writableObjectMode:{__proto__:null,...t(i.prototype,"writableObjectMode")},writableBuffer:{__proto__:null,...t(i.prototype,"writableBuffer")},writableLength:{__proto__:null,...t(i.prototype,"writableLength")},writableFinished:{__proto__:null,...t(i.prototype,"writableFinished")},writableCorked:{__proto__:null,...t(i.prototype,"writableCorked")},writableEnded:{__proto__:null,...t(i.prototype,"writableEnded")},writableNeedDrain:{__proto__:null,...t(i.prototype,"writableNeedDrain")},destroyed:{__proto__:null,get(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set(u){this._readableState&&this._writableState&&(this._readableState.destroyed=u,this._writableState.destroyed=u)}}});let o;function l(){return o===void 0&&(o={}),o}a.fromWeb=function(u,d){return l().newStreamDuplexFromReadableWritablePair(u,d)},a.toWeb=function(u){return l().newReadableWritablePairFromDuplex(u)};let c;return a.from=function(u){return c||(c=T_e()),c(u,"body")},DI}var FI,Bz;function TY(){if(Bz)return FI;Bz=1;const{ObjectSetPrototypeOf:e,Symbol:t}=ri();FI=a;const{ERR_METHOD_NOT_IMPLEMENTED:n}=Eo().codes,r=cf(),{getHighWaterMark:s}=aT();e(a.prototype,r.prototype),e(a,r);const i=t("kCallback");function a(c){if(!(this instanceof a))return new a(c);const u=c?s(this,c,"readableHighWaterMark",!0):null;u===0&&(c={...c,highWaterMark:null,readableHighWaterMark:u,writableHighWaterMark:c.writableHighWaterMark||0}),r.call(this,c),this._readableState.sync=!1,this[i]=null,c&&(typeof c.transform=="function"&&(this._transform=c.transform),typeof c.flush=="function"&&(this._flush=c.flush)),this.on("prefinish",l)}function o(c){typeof this._flush=="function"&&!this.destroyed?this._flush((u,d)=>{if(u){c?c(u):this.destroy(u);return}d!=null&&this.push(d),this.push(null),c&&c()}):(this.push(null),c&&c())}function l(){this._final!==o&&o.call(this)}return a.prototype._final=o,a.prototype._transform=function(c,u,d){throw new n("_transform()")},a.prototype._write=function(c,u,d){const h=this._readableState,m=this._writableState,y=h.length;this._transform(c,u,(b,v)=>{if(b){d(b);return}v!=null&&this.push(v),m.ended||y===h.length||h.length<h.highWaterMark?d():this[i]=d})},a.prototype._read=function(){if(this[i]){const c=this[i];this[i]=null,c()}},FI}var LI,$z;function AY(){if($z)return LI;$z=1;const{ObjectSetPrototypeOf:e}=ri();LI=n;const t=TY();e(n.prototype,t.prototype),e(n,t);function n(r){if(!(this instanceof n))return new n(r);t.call(this,r)}return n.prototype._transform=function(r,s,i){i(null,r)},LI}var BI,zz;function uD(){if(zz)return BI;zz=1;const e=ag(),{ArrayIsArray:t,Promise:n,SymbolAsyncIterator:r,SymbolDispose:s}=ri(),i=lp(),{once:a}=Wo(),o=ob(),l=cf(),{aggregateTwoErrors:c,codes:{ERR_INVALID_ARG_TYPE:u,ERR_INVALID_RETURN_VALUE:d,ERR_MISSING_ARGS:h,ERR_STREAM_DESTROYED:m,ERR_STREAM_PREMATURE_CLOSE:y},AbortError:b}=Eo(),{validateFunction:v,validateAbortSignal:x}=D1(),{isIterable:w,isReadable:_,isReadableNodeStream:k,isNodeStream:C,isTransformStream:T,isWebStream:A,isReadableStream:N,isReadableFinished:I}=bf(),j=globalThis.AbortController||Sw().AbortController;let L,D,H;function O(re,de,me){let De=!1;re.on("close",()=>{De=!0});const je=i(re,{readable:de,writable:me},Te=>{De=!Te});return{destroy:Te=>{De||(De=!0,o.destroyer(re,Te||new m("pipe")))},cleanup:je}}function K(re){return v(re[re.length-1],"streams[stream.length - 1]"),re.pop()}function U(re){if(w(re))return re;if(k(re))return W(re);throw new u("val",["Readable","Iterable","AsyncIterable"],re)}async function*W(re){D||(D=oT()),yield*D.prototype[r].call(re)}async function B(re,de,me,{end:De}){let je,Te=null;const _e=We=>{if(We&&(je=We),Te){const Pe=Te;Te=null,Pe()}},Ue=()=>new n((We,Pe)=>{je?Pe(je):Te=()=>{je?Pe(je):We()}});de.on("drain",_e);const Qe=i(de,{readable:!1},_e);try{de.writableNeedDrain&&await Ue();for await(const We of re)de.write(We)||await Ue();De&&(de.end(),await Ue()),me()}catch(We){me(je!==We?c(je,We):We)}finally{Qe(),de.off("drain",_e)}}async function ne(re,de,me,{end:De}){T(de)&&(de=de.writable);const je=de.getWriter();try{for await(const Te of re)await je.ready,je.write(Te).catch(()=>{});await je.ready,De&&await je.close(),me()}catch(Te){try{await je.abort(Te),me(Te)}catch(_e){me(_e)}}}function V(...re){return Q(re,a(K(re)))}function Q(re,de,me){if(re.length===1&&t(re[0])&&(re=re[0]),re.length<2)throw new h("streams");const De=new j,je=De.signal,Te=me==null?void 0:me.signal,_e=[];x(Te,"options.signal");function Ue(){ue(new b)}H=H||Wo().addAbortListener;let Qe;Te&&(Qe=H(Te,Ue));let We,Pe;const Y=[];let ye=0;function Me(Be){ue(Be,--ye===0)}function ue(Be,Re){var ct;if(Be&&(!We||We.code==="ERR_STREAM_PREMATURE_CLOSE")&&(We=Be),!(!We&&!Re)){for(;Y.length;)Y.shift()(We);(ct=Qe)===null||ct===void 0||ct[s](),De.abort(),Re&&(We||_e.forEach(At=>At()),e.nextTick(de,We,Pe))}}let oe;for(let Be=0;Be<re.length;Be++){const Re=re[Be],ct=Be<re.length-1,At=Be>0,ut=ct||(me==null?void 0:me.end)!==!1,Pt=Be===re.length-1;if(C(Re)){let Ut=function(Ft){Ft&&Ft.name!=="AbortError"&&Ft.code!=="ERR_STREAM_PREMATURE_CLOSE"&&Me(Ft)};if(ut){const{destroy:Ft,cleanup:Yt}=O(Re,ct,At);Y.push(Ft),_(Re)&&Pt&&_e.push(Yt)}Re.on("error",Ut),_(Re)&&Pt&&_e.push(()=>{Re.removeListener("error",Ut)})}if(Be===0)if(typeof Re=="function"){if(oe=Re({signal:je}),!w(oe))throw new d("Iterable, AsyncIterable or Stream","source",oe)}else w(Re)||k(Re)||T(Re)?oe=Re:oe=l.from(Re);else if(typeof Re=="function"){if(T(oe)){var se;oe=U((se=oe)===null||se===void 0?void 0:se.readable)}else oe=U(oe);if(oe=Re(oe,{signal:je}),ct){if(!w(oe,!0))throw new d("AsyncIterable",`transform[${Be-1}]`,oe)}else{var Ie;L||(L=AY());const Ut=new L({objectMode:!0}),Ft=(Ie=oe)===null||Ie===void 0?void 0:Ie.then;if(typeof Ft=="function")ye++,Ft.call(oe,F=>{Pe=F,F!=null&&Ut.write(F),ut&&Ut.end(),e.nextTick(Me)},F=>{Ut.destroy(F),e.nextTick(Me,F)});else if(w(oe,!0))ye++,B(oe,Ut,Me,{end:ut});else if(N(oe)||T(oe)){const F=oe.readable||oe;ye++,B(F,Ut,Me,{end:ut})}else throw new d("AsyncIterable or Promise","destination",oe);oe=Ut;const{destroy:Yt,cleanup:we}=O(oe,!1,!0);Y.push(Yt),Pt&&_e.push(we)}}else if(C(Re)){if(k(oe)){ye+=2;const Ut=ee(oe,Re,Me,{end:ut});_(Re)&&Pt&&_e.push(Ut)}else if(T(oe)||N(oe)){const Ut=oe.readable||oe;ye++,B(Ut,Re,Me,{end:ut})}else if(w(oe))ye++,B(oe,Re,Me,{end:ut});else throw new u("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],oe);oe=Re}else if(A(Re)){if(k(oe))ye++,ne(U(oe),Re,Me,{end:ut});else if(N(oe)||w(oe))ye++,ne(oe,Re,Me,{end:ut});else if(T(oe))ye++,ne(oe.readable,Re,Me,{end:ut});else throw new u("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],oe);oe=Re}else oe=l.from(Re)}return(je!=null&&je.aborted||Te!=null&&Te.aborted)&&e.nextTick(Ue),oe}function ee(re,de,me,{end:De}){let je=!1;if(de.on("close",()=>{je||me(new y)}),re.pipe(de,{end:!1}),De){let Te=function(){je=!0,de.end()};I(re)?e.nextTick(Te):re.once("end",Te)}else me();return i(re,{readable:!0,writable:!1},Te=>{const _e=re._readableState;Te&&Te.code==="ERR_STREAM_PREMATURE_CLOSE"&&_e&&_e.ended&&!_e.errored&&!_e.errorEmitted?re.once("end",me).once("error",me):me(Te)}),i(de,{readable:!1,writable:!0},me)}return BI={pipelineImpl:Q,pipeline:V},BI}var $I,Uz;function RY(){if(Uz)return $I;Uz=1;const{pipeline:e}=uD(),t=cf(),{destroyer:n}=ob(),{isNodeStream:r,isReadable:s,isWritable:i,isWebStream:a,isTransformStream:o,isWritableStream:l,isReadableStream:c}=bf(),{AbortError:u,codes:{ERR_INVALID_ARG_VALUE:d,ERR_MISSING_ARGS:h}}=Eo(),m=lp();return $I=function(...b){if(b.length===0)throw new h("streams");if(b.length===1)return t.from(b[0]);const v=[...b];if(typeof b[0]=="function"&&(b[0]=t.from(b[0])),typeof b[b.length-1]=="function"){const L=b.length-1;b[L]=t.from(b[L])}for(let L=0;L<b.length;++L)if(!(!r(b[L])&&!a(b[L]))){if(L<b.length-1&&!(s(b[L])||c(b[L])||o(b[L])))throw new d(`streams[${L}]`,v[L],"must be readable");if(L>0&&!(i(b[L])||l(b[L])||o(b[L])))throw new d(`streams[${L}]`,v[L],"must be writable")}let x,w,_,k,C;function T(L){const D=k;k=null,D?D(L):L?C.destroy(L):!j&&!I&&C.destroy()}const A=b[0],N=e(b,T),I=!!(i(A)||l(A)||o(A)),j=!!(s(N)||c(N)||o(N));if(C=new t({writableObjectMode:!!(A!=null&&A.writableObjectMode),readableObjectMode:!!(N!=null&&N.readableObjectMode),writable:I,readable:j}),I){if(r(A))C._write=function(D,H,O){A.write(D,H)?O():x=O},C._final=function(D){A.end(),w=D},A.on("drain",function(){if(x){const D=x;x=null,D()}});else if(a(A)){const H=(o(A)?A.writable:A).getWriter();C._write=async function(O,K,U){try{await H.ready,H.write(O).catch(()=>{}),U()}catch(W){U(W)}},C._final=async function(O){try{await H.ready,H.close().catch(()=>{}),w=O}catch(K){O(K)}}}const L=o(N)?N.readable:N;m(L,()=>{if(w){const D=w;w=null,D()}})}if(j){if(r(N))N.on("readable",function(){if(_){const L=_;_=null,L()}}),N.on("end",function(){C.push(null)}),C._read=function(){for(;;){const L=N.read();if(L===null){_=C._read;return}if(!C.push(L))return}};else if(a(N)){const D=(o(N)?N.readable:N).getReader();C._read=async function(){for(;;)try{const{value:H,done:O}=await D.read();if(!C.push(H))return;if(O){C.push(null);return}}catch{return}}}}return C._destroy=function(L,D){!L&&k!==null&&(L=new u),_=null,x=null,w=null,k===null?D(L):(k=D,r(N)&&n(N,L))},C},$I}var qz;function A_e(){if(qz)return Z_;qz=1;const e=globalThis.AbortController||Sw().AbortController,{codes:{ERR_INVALID_ARG_VALUE:t,ERR_INVALID_ARG_TYPE:n,ERR_MISSING_ARGS:r,ERR_OUT_OF_RANGE:s},AbortError:i}=Eo(),{validateAbortSignal:a,validateInteger:o,validateObject:l}=D1(),c=ri().Symbol("kWeak"),u=ri().Symbol("kResistStopPropagation"),{finished:d}=lp(),h=RY(),{addAbortSignalNoValidate:m}=iT(),{isWritable:y,isNodeStream:b}=bf(),{deprecate:v}=Wo(),{ArrayPrototypePush:x,Boolean:w,MathFloor:_,Number:k,NumberIsNaN:C,Promise:T,PromiseReject:A,PromiseResolve:N,PromisePrototypeThen:I,Symbol:j}=ri(),L=j("kEmpty"),D=j("kEof");function H(Te,_e){if(_e!=null&&l(_e,"options"),(_e==null?void 0:_e.signal)!=null&&a(_e.signal,"options.signal"),b(Te)&&!y(Te))throw new t("stream",Te,"must be writable");const Ue=h(this,Te);return _e!=null&&_e.signal&&m(_e.signal,Ue),Ue}function O(Te,_e){if(typeof Te!="function")throw new n("fn",["Function","AsyncFunction"],Te);_e!=null&&l(_e,"options"),(_e==null?void 0:_e.signal)!=null&&a(_e.signal,"options.signal");let Ue=1;(_e==null?void 0:_e.concurrency)!=null&&(Ue=_(_e.concurrency));let Qe=Ue-1;return(_e==null?void 0:_e.highWaterMark)!=null&&(Qe=_(_e.highWaterMark)),o(Ue,"options.concurrency",1),o(Qe,"options.highWaterMark",0),Qe+=Ue,(async function*(){const Pe=Wo().AbortSignalAny([_e==null?void 0:_e.signal].filter(w)),Y=this,ye=[],Me={signal:Pe};let ue,oe,se=!1,Ie=0;function Be(){se=!0,Re()}function Re(){Ie-=1,ct()}function ct(){oe&&!se&&Ie<Ue&&ye.length<Qe&&(oe(),oe=null)}async function At(){try{for await(let ut of Y){if(se)return;if(Pe.aborted)throw new i;try{if(ut=Te(ut,Me),ut===L)continue;ut=N(ut)}catch(Pt){ut=A(Pt)}Ie+=1,I(ut,Re,Be),ye.push(ut),ue&&(ue(),ue=null),!se&&(ye.length>=Qe||Ie>=Ue)&&await new T(Pt=>{oe=Pt})}ye.push(D)}catch(ut){const Pt=A(ut);I(Pt,Re,Be),ye.push(Pt)}finally{se=!0,ue&&(ue(),ue=null)}}At();try{for(;;){for(;ye.length>0;){const ut=await ye[0];if(ut===D)return;if(Pe.aborted)throw new i;ut!==L&&(yield ut),ye.shift(),ct()}await new T(ut=>{ue=ut})}}finally{se=!0,oe&&(oe(),oe=null)}}).call(this)}function K(Te=void 0){return Te!=null&&l(Te,"options"),(Te==null?void 0:Te.signal)!=null&&a(Te.signal,"options.signal"),(async function*(){let Ue=0;for await(const We of this){var Qe;if(Te!=null&&(Qe=Te.signal)!==null&&Qe!==void 0&&Qe.aborted)throw new i({cause:Te.signal.reason});yield[Ue++,We]}}).call(this)}async function U(Te,_e=void 0){for await(const Ue of V.call(this,Te,_e))return!0;return!1}async function W(Te,_e=void 0){if(typeof Te!="function")throw new n("fn",["Function","AsyncFunction"],Te);return!await U.call(this,async(...Ue)=>!await Te(...Ue),_e)}async function B(Te,_e){for await(const Ue of V.call(this,Te,_e))return Ue}async function ne(Te,_e){if(typeof Te!="function")throw new n("fn",["Function","AsyncFunction"],Te);async function Ue(Qe,We){return await Te(Qe,We),L}for await(const Qe of O.call(this,Ue,_e));}function V(Te,_e){if(typeof Te!="function")throw new n("fn",["Function","AsyncFunction"],Te);async function Ue(Qe,We){return await Te(Qe,We)?Qe:L}return O.call(this,Ue,_e)}class Q extends r{constructor(){super("reduce"),this.message="Reduce of an empty stream requires an initial value"}}async function ee(Te,_e,Ue){var Qe;if(typeof Te!="function")throw new n("reducer",["Function","AsyncFunction"],Te);Ue!=null&&l(Ue,"options"),(Ue==null?void 0:Ue.signal)!=null&&a(Ue.signal,"options.signal");let We=arguments.length>1;if(Ue!=null&&(Qe=Ue.signal)!==null&&Qe!==void 0&&Qe.aborted){const ue=new i(void 0,{cause:Ue.signal.reason});throw this.once("error",()=>{}),await d(this.destroy(ue)),ue}const Pe=new e,Y=Pe.signal;if(Ue!=null&&Ue.signal){const ue={once:!0,[c]:this,[u]:!0};Ue.signal.addEventListener("abort",()=>Pe.abort(),ue)}let ye=!1;try{for await(const ue of this){var Me;if(ye=!0,Ue!=null&&(Me=Ue.signal)!==null&&Me!==void 0&&Me.aborted)throw new i;We?_e=await Te(_e,ue,{signal:Y}):(_e=ue,We=!0)}if(!ye&&!We)throw new Q}finally{Pe.abort()}return _e}async function re(Te){Te!=null&&l(Te,"options"),(Te==null?void 0:Te.signal)!=null&&a(Te.signal,"options.signal");const _e=[];for await(const Qe of this){var Ue;if(Te!=null&&(Ue=Te.signal)!==null&&Ue!==void 0&&Ue.aborted)throw new i(void 0,{cause:Te.signal.reason});x(_e,Qe)}return _e}function de(Te,_e){const Ue=O.call(this,Te,_e);return(async function*(){for await(const We of Ue)yield*We}).call(this)}function me(Te){if(Te=k(Te),C(Te))return 0;if(Te<0)throw new s("number",">= 0",Te);return Te}function De(Te,_e=void 0){return _e!=null&&l(_e,"options"),(_e==null?void 0:_e.signal)!=null&&a(_e.signal,"options.signal"),Te=me(Te),(async function*(){var Qe;if(_e!=null&&(Qe=_e.signal)!==null&&Qe!==void 0&&Qe.aborted)throw new i;for await(const Pe of this){var We;if(_e!=null&&(We=_e.signal)!==null&&We!==void 0&&We.aborted)throw new i;Te--<=0&&(yield Pe)}}).call(this)}function je(Te,_e=void 0){return _e!=null&&l(_e,"options"),(_e==null?void 0:_e.signal)!=null&&a(_e.signal,"options.signal"),Te=me(Te),(async function*(){var Qe;if(_e!=null&&(Qe=_e.signal)!==null&&Qe!==void 0&&Qe.aborted)throw new i;for await(const Pe of this){var We;if(_e!=null&&(We=_e.signal)!==null&&We!==void 0&&We.aborted)throw new i;if(Te-- >0&&(yield Pe),Te<=0)return}}).call(this)}return Z_.streamReturningOperators={asIndexedPairs:v(K,"readable.asIndexedPairs will be removed in a future version."),drop:De,filter:V,flatMap:de,map:O,take:je,compose:H},Z_.promiseReturningOperators={every:W,forEach:ne,reduce:ee,toArray:re,some:U,find:B},Z_}var zI,Vz;function NY(){if(Vz)return zI;Vz=1;const{ArrayPrototypePop:e,Promise:t}=ri(),{isIterable:n,isNodeStream:r,isWebStream:s}=bf(),{pipelineImpl:i}=uD(),{finished:a}=lp();IY();function o(...l){return new t((c,u)=>{let d,h;const m=l[l.length-1];if(m&&typeof m=="object"&&!r(m)&&!n(m)&&!s(m)){const y=e(l);d=y.signal,h=y.end}i(l,(y,b)=>{y?u(y):c(b)},{signal:d,end:h})})}return zI={finished:a,pipeline:o},zI}var Wz;function IY(){if(Wz)return yI.exports;Wz=1;const{Buffer:e}=op(),{ObjectDefineProperty:t,ObjectKeys:n,ReflectApply:r}=ri(),{promisify:{custom:s}}=Wo(),{streamReturningOperators:i,promiseReturningOperators:a}=A_e(),{codes:{ERR_ILLEGAL_CONSTRUCTOR:o}}=Eo(),l=RY(),{setDefaultHighWaterMark:c,getDefaultHighWaterMark:u}=aT(),{pipeline:d}=uD(),{destroyer:h}=ob(),m=lp(),y=NY(),b=bf(),v=yI.exports=oD().Stream;v.isDestroyed=b.isDestroyed,v.isDisturbed=b.isDisturbed,v.isErrored=b.isErrored,v.isReadable=b.isReadable,v.isWritable=b.isWritable,v.Readable=oT();for(const w of n(i)){let k=function(...C){if(new.target)throw o();return v.Readable.from(r(_,this,C))};const _=i[w];t(k,"name",{__proto__:null,value:_.name}),t(k,"length",{__proto__:null,value:_.length}),t(v.Readable.prototype,w,{__proto__:null,value:k,enumerable:!1,configurable:!0,writable:!0})}for(const w of n(a)){let k=function(...C){if(new.target)throw o();return r(_,this,C)};const _=a[w];t(k,"name",{__proto__:null,value:_.name}),t(k,"length",{__proto__:null,value:_.length}),t(v.Readable.prototype,w,{__proto__:null,value:k,enumerable:!1,configurable:!0,writable:!0})}v.Writable=cD(),v.Duplex=cf(),v.Transform=TY(),v.PassThrough=AY(),v.pipeline=d;const{addAbortSignal:x}=iT();return v.addAbortSignal=x,v.finished=m,v.destroy=h,v.compose=l,v.setDefaultHighWaterMark=c,v.getDefaultHighWaterMark=u,t(v,"promises",{__proto__:null,configurable:!0,enumerable:!0,get(){return y}}),t(d,s,{__proto__:null,enumerable:!0,get(){return y.pipeline}}),t(m,s,{__proto__:null,enumerable:!0,get(){return y.finished}}),v.Stream=v,v._isUint8Array=function(_){return _ instanceof Uint8Array},v._uint8ArrayToBuffer=function(_){return e.from(_.buffer,_.byteOffset,_.byteLength)},yI.exports}var Hz;function R_e(){return Hz||(Hz=1,function(e){const t=IY(),n=NY(),r=t.Readable.destroy;e.exports=t.Readable,e.exports._uint8ArrayToBuffer=t._uint8ArrayToBuffer,e.exports._isUint8Array=t._isUint8Array,e.exports.isDisturbed=t.isDisturbed,e.exports.isErrored=t.isErrored,e.exports.isReadable=t.isReadable,e.exports.Readable=t.Readable,e.exports.Writable=t.Writable,e.exports.Duplex=t.Duplex,e.exports.Transform=t.Transform,e.exports.PassThrough=t.PassThrough,e.exports.addAbortSignal=t.addAbortSignal,e.exports.finished=t.finished,e.exports.destroy=t.destroy,e.exports.destroy=r,e.exports.pipeline=t.pipeline,e.exports.compose=t.compose,Object.defineProperty(t,"promises",{configurable:!0,enumerable:!0,get(){return n}}),e.exports.Stream=t.Stream,e.exports.default=e.exports}(gI)),gI.exports}var MY=R_e();class dD extends MY.Readable{constructor(t={},n){var r;super({...t,encoding:(r=t.encoding)!==null&&r!==void 0?r:void 0}),this.pending=!0,this._path="<unknown>",this._bytesRead=0,this.ready=Promise.resolve(n).then(s=>{this._path=s.path;const i=s.readableWebStream({start:t.start,end:t.end});this.reader=i.getReader(),this.pending=!1}).catch(s=>{this.destroy(s)})}async _read(){try{if(await this.ready,!this.reader)return;const{done:t,value:n}=await this.reader.read();if(t){this.push(null);return}this._bytesRead+=n.byteLength,this.push(n)}catch(t){this.destroy(new Xe(vt.EIO,t.toString()))}}close(t=()=>null){try{this.destroy(),this.emit("close"),t(null)}catch(n){t(new Xe(vt.EIO,n.toString()))}}get path(){return this._path}get bytesRead(){return this._bytesRead}wrap(t){return super.wrap(t),this}}class fD extends MY.Writable{constructor(t={},n){super(t),this.pending=!0,this._path="<unknown>",this._bytesWritten=0,this.ready=Promise.resolve(n).then(r=>{this._path=r.path;const s=r.writableWebStream({start:t.start});this.writer=s.getWriter(),this.pending=!1}).catch(r=>this.destroy(r))}async _write(t,n,r){if(await this.ready,!this.writer)return r(Ua(new Xe(vt.EAGAIN,"Underlying writable stream not ready",this._path)));if(n!="buffer")return r(Ua(new Xe(vt.ENOTSUP,"Unsupported encoding for stream",this._path)));const s=new Uint8Array(t.buffer,t.byteOffset,t.byteLength);try{await this.writer.write(s),this._bytesWritten+=t.byteLength,r()}catch(i){r(new Xe(vt.EIO,i.toString()))}}async _final(t){if(await this.ready,!this.writer)return t();try{await this.writer.close(),t()}catch(n){t(new Xe(vt.EIO,n.toString()))}}close(t=()=>null){try{this.destroy(),this.emit("close"),t(null)}catch(n){t(new Xe(vt.EIO,n.toString()))}}get path(){return this._path}get bytesWritten(){return this._bytesWritten}}var fc=function(e,t,n){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var r,s;if(n){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=t[Symbol.asyncDispose]}if(r===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=t[Symbol.dispose],n&&(s=r)}if(typeof r!="function")throw new TypeError("Object not disposable.");s&&(r=function(){try{s.call(this)}catch(i){return Promise.reject(i)}}),e.stack.push({value:t,dispose:r,async:n})}else n&&e.stack.push({async:!0});return t},hc=function(e){return function(t){function n(a){t.error=t.hasError?new e(a,t.error,"An error was suppressed during disposal."):a,t.hasError=!0}var r,s=0;function i(){for(;r=t.stack.pop();)try{if(!r.async&&s===1)return s=0,t.stack.push(r),Promise.resolve().then(i);if(r.dispose){var a=r.dispose.call(r.value);if(r.async)return s|=2,Promise.resolve(a).then(i,function(o){return n(o),i()})}else s|=1}catch(o){n(o)}if(s===1)return t.hasError?Promise.reject(t.error):Promise.resolve();if(t.hasError)throw t.error}return i()}}(typeof SuppressedError=="function"?SuppressedError:function(e,t,n){var r=new Error(n);return r.name="SuppressedError",r.error=e,r.suppressed=t,r});class Ha{get position(){return this.flag&Dm?this.inode.size:this._position}set position(t){this._position=t}constructor(t,n){this.context=t,this.fd=n,this._position=0,this.dirty=!1,this.closed=!1;const r=Ya(t,n);Object.assign(this,Xm(r,"path","fs","internalPath","flag","inode"))}get _isSync(){return!!(this.flag&tT||this.inode.flags&$o.Sync)}_emitChange(){Na(this.context,"change",this.path)}async chown(t,n){if(this.closed)throw Xe.With("EBADF",this.path,"chown");this.dirty=!0,uY(this.inode,t,n),this._isSync&&await this.sync(),this._emitChange()}async chmod(t){const n=ip(t,-1);if(n<0)throw new Xe(vt.EINVAL,"Invalid mode");if(this.closed)throw Xe.With("EBADF",this.path,"chmod");this.dirty=!0,this.inode.mode=this.inode.mode&(n>Es?-61441:Es)|n,(this._isSync||n>Es)&&await this.sync(),this._emitChange()}datasync(){return this.sync()}async sync(){if(this.closed)throw Xe.With("EBADF",this.path,"sync");this.dirty&&(this.fs.attributes.has("no_write")||await this.fs.touch(this.internalPath,this.inode),this.dirty=!1)}async truncate(t=0){if(this.closed)throw Xe.With("EBADF",this.path,"truncate");if(t<0)throw new Xe(vt.EINVAL);if(this.dirty=!0,!(this.flag&za||this.flag&Zd))throw new Xe(vt.EPERM,"File not opened with a writeable mode",this.path,"truncate");this.inode.mtimeMs=Date.now(),this.inode.size=t,this._isSync&&await this.sync(),this._emitChange()}async utimes(t,n){if(this.closed)throw Xe.With("EBADF",this.path,"utimes");this.dirty=!0,this.inode.atimeMs=tk(t),this.inode.mtimeMs=tk(n),this._isSync&&await this.sync(),this._emitChange()}async appendFile(t,n={}){const r=Xd(n,"utf8","a",420);if(!(Jd(r.flag)&Dm))throw new Xe(vt.EINVAL,"Flag passed to appendFile must allow for appending");if(typeof t!="string"&&!r.encoding)throw new Xe(vt.EINVAL,"Encoding not specified");const i=typeof t=="string"?Fs.from(t,r.encoding):t;await this._write(i,0,i.length),this._emitChange()}async _read(t,n=0,r=t.byteLength-n,s=this.position){if(this.closed)throw Xe.With("EBADF",this.path,"read");if(this.flag&za)throw new Xe(vt.EPERM,"File not opened with a readable mode");this.inode.flags&$o.NoAtime||(this.dirty=!0,this.inode.atimeMs=Date.now());let i=s+r;!vw(this.inode)&&!bw(this.inode)&&i>this.inode.size&&(i=s+Math.max(this.inode.size-s,0)),this._position=i;const a=new Uint8Array(t.buffer,t.byteOffset,t.byteLength);return await this.fs.read(this.internalPath,a.subarray(n,n+r),s,i),this._isSync&&await this.sync(),{bytesRead:i-s,buffer:t}}async read(t,n,r,s){typeof n=="object"&&n!=null&&(s=n.position,r=n.length,n=n.offset),!ArrayBuffer.isView(t)&&typeof t=="object"&&(s=t.position,r=t.length,n=t.offset,t=t.buffer);const i=Number.isSafeInteger(s)?s:this.position;return t||(t=new Uint8Array(this.inode.size)),n??(n=0),this._read(t,n,r??t.byteLength-n,i)}async readFile(t){const n=Xd(t,null,"r",292);if(Jd(n.flag)&za)throw new Xe(vt.EINVAL,"Flag passed must allow for reading",this.path,"readFile");const{size:s}=await this.stat(),{buffer:i}=await this._read(new Uint8Array(s),0,s,0),a=Fs.from(i);return n.encoding?a.toString(n.encoding):a}readableWebStream(t={}){if(this.closed)throw Xe.With("EBADF",this.path,"readableWebStream");return this.fs.streamRead(this.internalPath,t)}writableWebStream(t={}){if(this.closed)throw Xe.With("EBADF",this.path,"writableWebStream");if(this.inode.flags&$o.Immutable)throw new Xe(vt.EPERM,"File is immutable",this.path,"writableWebStream");return this.fs.streamWrite(this.internalPath,t)}readLines(t){if(this.closed||this.flag&za)throw Xe.With("EBADF",this.path,"readLines");return KSe({input:this.createReadStream(t),crlfDelay:1/0})}[Symbol.asyncDispose](){return this.close()}async stat(t){if(this.closed)throw Xe.With("EBADF",this.path,"stat");if(!hs(this.context,this.inode,Xi))throw Xe.With("EACCES",this.path,"stat");return t!=null&&t.bigint?new rg(this.inode):new yf(this.inode)}async _write(t,n=0,r=t.byteLength-n,s=this.position){if(this.closed)throw Xe.With("EBADF",this.path,"write");if(this.inode.flags&$o.Immutable)throw new Xe(vt.EPERM,"File is immutable",this.path,"write");if(!(this.flag&za||this.flag&Zd))throw new Xe(vt.EPERM,"File not opened with a writeable mode",this.path,"write");this.dirty=!0;const i=s+r,a=t.subarray(n,n+r);return!vw(this.inode)&&!bw(this.inode)&&i>this.inode.size&&(this.inode.size=i),this.inode.mtimeMs=Date.now(),this.inode.ctimeMs=Date.now(),this._position=s+a.byteLength,await this.fs.write(this.internalPath,a,s),this._isSync&&await this.sync(),a.byteLength}async write(t,n,r,s){let i,a,o;typeof n=="object"&&n!=null&&(r=n.length,s=n.position,n=n.offset),typeof t=="string"?(s=typeof n=="number"?n:null,a=0,i=Fs.from(t,typeof r=="string"?r:"utf8"),o=i.length):(i=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),a=n??0,o=typeof r=="number"?r:i.byteLength,s=typeof s=="number"?s:null),s??(s=this.position);const l=await this._write(i,a,o,s);return this._emitChange(),{buffer:t,bytesWritten:l}}async writeFile(t,n={}){const r=Xd(n,"utf8","w",420),s=Jd(r.flag);if(!(s&za||s&Zd))throw new Xe(vt.EINVAL,"Flag passed must allow for writing",this.path,"writeFile");if(typeof t!="string"&&!r.encoding)throw new Xe(vt.EINVAL,"Encoding not specified");const i=typeof t=="string"?Fs.from(t,r.encoding):t;await this._write(i,0,i.length,0),this._emitChange()}async close(){if(this.closed)throw Xe.With("EBADF",this.path,"close");await this.sync(),this.dispose(),hY(this.context,this.fd)}dispose(t){if(this.closed)throw Xe.With("EBADF",this.path,"dispose");if(this.dirty&&!t)throw Xe.With("EBUSY",this.path,"dispose");this.closed=!0}async writev(t,n){typeof n=="number"&&(this.position=n);let r=0;for(const s of t)r+=(await this.write(s)).bytesWritten;return{bytesWritten:r,buffers:t}}async readv(t,n){typeof n=="number"&&(this.position=n);let r=0;for(const s of t)r+=(await this.read(s)).bytesRead;return{bytesRead:r,buffers:t}}createReadStream(t={}){if(this.closed||this.flag&za)throw Xe.With("EBADF",this.path,"createReadStream");return new dD(t,this)}createWriteStream(t={}){if(this.closed)throw Xe.With("EBADF",this.path,"createWriteStream");if(this.inode.flags&$o.Immutable)throw new Xe(vt.EPERM,"File is immutable",this.path,"createWriteStream");return new fD(t,this)}}async function jY(e,t){e=$n(e),t=$n(t);const n=jr(e,this),r=jr(t,this);if(!(await lb.call(this,Xr(e))).hasAccess(ui,this))throw Xe.With("EACCES",e,"rename");try{if(n.mountPoint==r.mountPoint){await n.fs.rename(n.path,r.path),Na(this,"rename",e.toString()),Na(this,"change",t.toString());return}await dT.call(this,t,await uT(e)),await cT.call(this,e),Na(this,"rename",e.toString())}catch(s){throw ps(s,{[n.path]:e,[r.path]:t})}}async function F1(e){try{const{fs:t,path:n}=jr(await cp.call(this,e),this);return await t.exists(n)}catch(t){if(t instanceof Xe&&t.code=="ENOENT")return!1;throw t}}async function lb(e,t){e=$n(e);const{fs:n,path:r}=jr(await cp.call(this,e),this);try{const s=await n.stat(r);if(Ji&&!hs(this,s,Xi))throw Xe.With("EACCES",r,"stat");return t!=null&&t.bigint?new rg(s):new yf(s)}catch(s){throw ps(s,{[r]:e})}}async function lT(e,t){e=$n(e);const{fs:n,path:r}=jr(e,this);try{const s=await n.stat(r);if(Ji&&!hs(this,s,Xi))throw Xe.With("EACCES",r,"lstat");return t!=null&&t.bigint?new rg(s):new yf(s)}catch(s){throw ps(s,{[r]:e})}}async function PY(e,t=0){const n={stack:[],error:void 0,hasError:!1};try{await fc(n,await pc.call(this,e,"r+"),!0).truncate(t)}catch(r){n.error=r,n.hasError=!0}finally{const r=hc(n);r&&await r}}async function cT(e){e=$n(e);const{fs:t,path:n}=jr(e,this);try{if(Ji&&!hs(this,await t.stat(n),ui))throw Xe.With("EACCES",n,"unlink");await t.unlink(n),Na(this,"rename",e.toString())}catch(r){throw ps(r,{[n]:e})}}async function cb(e,t,n){var r;t=$n(t);const s=ip(n.mode,420),i=Jd(n.flag),{fullPath:a,fs:o,path:l,stats:c}=await ik(e,t.toString(),n.preserveSymlinks);if(!c){if(!(i&JE))throw Xe.With("ENOENT",a,"_open");const d=await o.stat(Xr(l));if(!hs(e,d,ui))throw Xe.With("EACCES",Xr(a),"_open");if(!Gc(d))throw Xe.With("ENOTDIR",Xr(a),"_open");const{euid:h,egid:m}=(r=e==null?void 0:e.credentials)!==null&&r!==void 0?r:Xc.credentials,y=await o.createFile(l,{mode:s,uid:d.mode&M1?d.uid:h,gid:d.mode&j1?d.gid:m});return new Ha(e,rk(new nk(e,t,o,l,i,y)))}if(!hs(e,c,pY(i)))throw Xe.With("EACCES",a,"_open");if(i&QE)throw Xe.With("EEXIST",a,"_open");const u=new Ha(e,rk(new nk(e,t,o,l,i,c)));return i&eT&&await u.truncate(0),u}async function pc(e,t="r",n=420){return await cb(this,e,{flag:t,mode:n})}async function uT(e,t){const n={stack:[],error:void 0,hasError:!1};try{const r=Xd(t,null,"r",292);return await fc(n,typeof e=="object"&&"fd"in e?e:await pc.call(this,e,r.flag,r.mode),!0).readFile(r)}catch(r){n.error=r,n.hasError=!0}finally{const r=hc(n);r&&await r}}async function dT(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{const s=Xd(n,"utf8","w+",420),i=fc(r,e instanceof Ha?e:await pc.call(this,e.toString(),s.flag,s.mode),!0),a=typeof t=="string"?t:t instanceof DataView?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t;if(typeof a!="string"&&!(a instanceof Uint8Array))throw new Xe(vt.EINVAL,'The "data" argument must be of type string or an instance of Buffer, TypedArray, or DataView. Received '+typeof t,i.path,"writeFile");await i.writeFile(a,s)}catch(s){r.error=s,r.hasError=!0}finally{const s=hc(r);s&&await s}}async function OY(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{const s=Xd(n,"utf8","a",420);if(!(Jd(s.flag)&Dm))throw new Xe(vt.EINVAL,"Flag passed to appendFile must allow for appending");if(typeof t!="string"&&!s.encoding)throw new Xe(vt.EINVAL,"Encoding not specified");const a=typeof t=="string"?Fs.from(t,s.encoding):new Uint8Array(t.buffer,t.byteOffset,t.byteLength);await fc(r,typeof e=="object"&&"fd"in e?e:await pc.call(this,e,s.flag,s.mode),!0).appendFile(a,s)}catch(s){r.error=s,r.hasError=!0}finally{const s=hc(r);s&&await s}}async function hD(e){e=await cp.call(this,e);const{fs:t,path:n}=jr(e,this);try{const r=await t.stat(n);if(!r)throw Xe.With("ENOENT",e,"rmdir");if(!Gc(r))throw Xe.With("ENOTDIR",n,"rmdir");if(Ji&&!hs(this,r,ui))throw Xe.With("EACCES",n,"rmdir");await t.rmdir(n),Na(this,"rename",e.toString())}catch(r){throw ps(r,{[n]:e})}}async function fT(e,t){var n,r;const{euid:s,egid:i}=(n=this===null||this===void 0?void 0:this.credentials)!==null&&n!==void 0?n:Xc.credentials;t=typeof t=="object"?t:{mode:t};const a=ip(t==null?void 0:t.mode,511);e=await cp.call(this,e);const{fs:o,path:l,root:c}=jr(e,this),u={[l]:e},d=async(h,m)=>{if(!hs(this,m,ui))throw Xe.With("EACCES",Xr(h),"mkdir");const y=await o.mkdir(h,{mode:a,uid:m.mode&M1?m.uid:s,gid:m.mode&j1?m.gid:i});return Na(this,"rename",h),y};try{if(!(t!=null&&t.recursive)){await d(l,await o.stat(Xr(l)));return}const h=[];for(let y=l,b=e;!await o.exists(y);y=Xr(y),b=Xr(b))h.unshift(y),u[y]=b;if(!h.length)return;const m=[await o.stat(Xr(h[0]))];for(const[y,b]of h.entries())m.push(await d(b,m[y]));return c.length==1?h[0]:(r=h[0])===null||r===void 0?void 0:r.slice(c.length)}catch(h){throw ps(h,u)}}async function og(e,t){t=typeof t=="object"?t:{encoding:t},e=await cp.call(this,e);const{fs:n,path:r}=jr(e,this),s=await n.stat(r).catch(l=>vs(ps(l,{[r]:e})));if(!s)throw Xe.With("ENOENT",e,"readdir");if(!hs(this,s,Xi))throw Xe.With("EACCES",e,"readdir");if(!Gc(s))throw Xe.With("ENOTDIR",e,"readdir");const i=await n.readdir(r).catch(l=>vs(ps(l,{[r]:e}))),a=[],o=async l=>{let c;if(!((t!=null&&t.recursive||t!=null&&t.withFileTypes)&&(c=await n.stat(os(r,l)).catch(u=>{if(u.code!="ENOENT")throw ps(u,{[r]:e})}),!c))&&(t!=null&&t.withFileTypes?a.push(new ww(l,c)):(t==null?void 0:t.encoding)=="buffer"?a.push(Fs.from(l)):a.push(l),!(!(t!=null&&t.recursive)||!Gc(c))))for(const u of await og.call(this,os(e,l),t))u instanceof ww?(u.path=os(l,u.path),a.push(u)):Fs.isBuffer(u)?a.push(Fs.from(os(l,BO(u)))):a.push(os(l,u))};return await Promise.all(i.map(o)),a}async function DY(e,t){e=$n(e),t=$n(t);const{fs:n,path:r}=jr(e,this),s=jr(t,this);if(n!=s.fs)throw Xe.With("EXDEV",t,"link");try{if(Ji&&!hs(this,await n.stat(Xr(r)),Xi))throw Xe.With("EACCES",Xr(r),"link");if(Ji&&!(await lb.call(this,Xr(t))).hasAccess(ui,this))throw Xe.With("EACCES",Xr(t),"link");if(Ji&&!hs(this,await n.stat(r),Xi))throw Xe.With("EACCES",r,"link");return await n.link(r,s.path)}catch(i){throw ps(i,{[s.path]:t,[r]:e})}}async function FY(e,t,n="file"){const r={stack:[],error:void 0,hasError:!1};try{if(!["file","dir","junction"].includes(n))throw new Xe(vt.EINVAL,"Invalid symlink type: "+n);if(t=$n(t),await F1.call(this,t))throw Xe.With("EEXIST",t,"symlink");const s=fc(r,await cb(this,t,{flag:"w+",mode:420,preserveSymlinks:!0}),!0);await s.writeFile($n(e,!0)),await s.chmod(gf)}catch(s){r.error=s,r.hasError=!0}finally{const s=hc(r);s&&await s}}async function sk(e,t){const n={stack:[],error:void 0,hasError:!1};try{const s=await fc(n,await cb(this,$n(e),{flag:"r",mode:420,preserveSymlinks:!0}),!0).readFile(),i=typeof t=="object"?t==null?void 0:t.encoding:t;return i=="buffer"?s:s.toString(i??"utf-8")}catch(r){n.error=r,n.hasError=!0}finally{const r=hc(n);r&&await r}}async function LY(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{await fc(r,await pc.call(this,e,"r+"),!0).chown(t,n)}catch(s){r.error=s,r.hasError=!0}finally{const s=hc(r);s&&await s}}async function BY(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{await fc(r,await cb(this,e,{flag:"r+",mode:420,preserveSymlinks:!0,allowDirectory:!0}),!0).chown(t,n)}catch(s){r.error=s,r.hasError=!0}finally{const s=hc(r);s&&await s}}async function $Y(e,t){const n={stack:[],error:void 0,hasError:!1};try{await fc(n,await pc.call(this,e,"r+"),!0).chmod(t)}catch(r){n.error=r,n.hasError=!0}finally{const r=hc(n);r&&await r}}async function zY(e,t){const n={stack:[],error:void 0,hasError:!1};try{await fc(n,await cb(this,e,{flag:"r+",mode:420,preserveSymlinks:!0,allowDirectory:!0}),!0).chmod(t)}catch(r){n.error=r,n.hasError=!0}finally{const r=hc(n);r&&await r}}async function pD(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{await fc(r,await pc.call(this,e,"r+"),!0).utimes(t,n)}catch(s){r.error=s,r.hasError=!0}finally{const s=hc(r);s&&await s}}async function UY(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{await fc(r,await cb(this,e,{flag:"r+",mode:420,preserveSymlinks:!0,allowDirectory:!0}),!0).utimes(new Date(t),new Date(n))}catch(s){r.error=s,r.hasError=!0}finally{const s=hc(r);s&&await s}}async function ik(e,t,n){if(n){const l=jr(t,e),c=await l.fs.stat(l.path).catch(()=>{});return{...l,fullPath:t,stats:c}}try{const l=jr(t,e),c=await l.fs.stat(l.path);if(!xy(c))return{...l,fullPath:t,stats:c};const u=lf.call(e,Xr(t),(await sk.call(e,t)).toString());return await ik(e,u)}catch{}const{base:r,dir:s}=vu(t),i=s=="/"?"/":await cp.call(e,s),a=os(i,r),o=jr(a,e);try{const l=await o.fs.stat(o.path);if(!xy(l))return{...o,fullPath:a,stats:l};const c=lf.call(e,i,(await sk.call(e,a)).toString());return await ik(e,c)}catch(l){if(l.code=="ENOENT")return{...o,fullPath:t};throw ps(l,{[o.path]:a})}}async function cp(e,t){var n;const r=typeof t=="string"?t:(n=t==null?void 0:t.encoding)!==null&&n!==void 0?n:"utf8";e=$n(e);const{fullPath:s}=await ik(this,e);if(r=="utf8"||r=="utf-8")return s;const i=Fs.from(s,"utf-8");return r=="buffer"?i:i.toString(r)}function N_e(e,t={}){const n=new bY(this,e.toString(),typeof t!="string"?t:{encoding:t}),r=[];let s=!1;n.on("change",(a,o)=>{var l;(l=r.shift())===null||l===void 0||l({value:{eventType:a,filename:o},done:!1})});function i(){s=!0,n.close();for(const a of r)a({value:null,done:s});return r.length=0,Promise.resolve({value:null,done:!0})}return{async next(){if(s)return Promise.resolve({value:null,done:s});const{promise:a,resolve:o}=Promise.withResolvers();return r.push(o),a},return:i,throw:i,async[Symbol.asyncDispose](){await i()},[Symbol.asyncIterator](){return this}}}async function qY(e,t=HO){if(!(await lb.call(this,e)).hasAccess(t,this))throw new Xe(vt.EACCES)}async function mD(e,t){e=$n(e);const n=await lT.call(this,e).catch(r=>{if(!(r.code=="ENOENT"&&(t!=null&&t.force)))throw r});if(n)switch(n.mode&Es){case Oi:if(t!=null&&t.recursive)for(const r of await og.call(this,e))await mD.call(this,os(e,r),t);await hD.call(this,e);break;case Bc:case gf:case eg:case tg:await cT.call(this,e);break;case ng:case Qm:default:throw new Xe(vt.EPERM,"File type not supported",e,"rm")}}async function VY(e,t){const n=typeof t=="object"?t==null?void 0:t.encoding:t||"utf8",s="/tmp/"+`${e}${Date.now()}-${Math.random().toString(36).slice(2)}`;return await fT.call(this,s),n=="buffer"?Fs.from(s):s}async function gD(e,t,n){if(e=$n(e),t=$n(t),n&&n&GO&&await F1.call(this,t))throw new Xe(vt.EEXIST,"Destination file already exists",t,"copyFile");await dT.call(this,t,await uT.call(this,e)),Na(this,"rename",t.toString())}function WY(e,t){return e=$n(e),Promise.resolve(new aD(e,this))}async function yD(e,t,n){e=$n(e),t=$n(t);const r=await lT.call(this,e);if(n!=null&&n.errorOnExist&&await F1.call(this,t))throw new Xe(vt.EEXIST,"Destination file or directory already exists",t,"cp");switch(r.mode&Es){case Oi:{if(!(n!=null&&n.recursive))throw new Xe(vt.EISDIR,e+" is a directory (not copied)",e,"cp");const[s]=await Promise.all([og.call(this,e,{withFileTypes:!0}),fT.call(this,t,{recursive:!0})]),i=async a=>{n.filter&&!n.filter(os(e,a.name),os(t,a.name))||await yD.call(this,os(e,a.name),os(t,a.name),n)};await Promise.all(s.map(i));break}case Bc:case gf:await gD.call(this,e,t);break;case eg:case tg:case ng:case Qm:default:throw new Xe(vt.EPERM,"File type not supported",e,"rm")}n!=null&&n.preserveTimestamps&&await pD.call(this,t,r.atime,r.mtime)}async function HY(e,t){e=$n(e);const{fs:n}=jr(e,this);return Promise.resolve(gY(n,t==null?void 0:t.bigint))}function GY(e,t){e=Array.isArray(e)?e:[e];const{cwd:n="/",withFileTypes:r=!1,exclude:s=()=>!1}=t||{},i=e.map(o=>(o=o.replace(/([.?+^$(){}|[\]/])/g,"$1").replace(/\*\*/g,".*").replace(/\*/g,"[^/]*").replace(/\?/g,"."),new RegExp(`^${o}$`)));async function*a(o){const l=await og(o,{withFileTypes:r,encoding:"utf8"});for(const c of l){const u=r?c.path:o+"/"+c;s(r?c:u)||((await lb(u)).isDirectory()&&i.some(d=>d.source.includes(".*"))&&(yield*a(u)),i.some(d=>d.test(u.replace(/^\/+/g,"")))&&(yield r?c:u.replace(/^\/+/g,"")))}}return a(n)}const I_e=Object.freeze(Object.defineProperty({__proto__:null,FileHandle:Ha,access:qY,appendFile:OY,chmod:$Y,chown:LY,constants:lY,copyFile:gD,cp:yD,exists:F1,glob:GY,lchmod:zY,lchown:BY,link:DY,lstat:lT,lutimes:UY,mkdir:fT,mkdtemp:VY,open:pc,opendir:WY,readFile:uT,readdir:og,readlink:sk,realpath:cp,rename:jY,rm:mD,rmdir:hD,stat:lb,statfs:HY,symlink:FY,truncate:PY,unlink:cT,utimes:pD,watch:N_e,writeFile:dT},Symbol.toStringTag,{value:"Module"})),yr=()=>{};async function M_e(e){const t=[];for await(const n of e)t.push(n);return t}function j_e(e,t,n=yr){jY.call(this,e,t).then(()=>n()).catch(n)}function P_e(e,t=yr){F1.call(this,e).then(t).catch(()=>t(!1))}function O_e(e,t,n=yr){n=typeof t=="function"?t:n,lb.call(this,e,typeof t!="function"?t:{}).then(r=>n(void 0,r)).catch(n)}function D_e(e,t,n=yr){n=typeof t=="function"?t:n,lT.call(this,e,typeof t!="function"?t:{}).then(r=>n(void 0,r)).catch(n)}function F_e(e,t=0,n=yr){n=typeof t=="function"?t:n;const r=typeof t=="number"?t:0;PY.call(this,e,r).then(()=>n()).catch(n)}function L_e(e,t=yr){cT.call(this,e).then(()=>t()).catch(t)}function B_e(e,t,n,r=yr){const s=ip(n,420);r=typeof n=="function"?n:r,pc.call(this,e,t,s).then(i=>r(void 0,i.fd)).catch(r)}function $_e(e,t,n=yr){n=typeof t=="function"?t:n,uT.call(this,e,typeof t=="function"?null:t).then(r=>n(void 0,r)).catch(n)}function z_e(e,t,n,r=yr){r=typeof n=="function"?n:r,dT.call(this,e,t,typeof n!="function"?n:null).then(()=>r(void 0)).catch(r)}function U_e(e,t,n,r=yr){const s=typeof n!="function"?n:void 0;r=typeof n=="function"?n:r,OY.call(this,e,t,s).then(()=>r()).catch(r)}function q_e(e,t,n=yr){n=typeof t=="function"?t:n,new Ha(this,e).stat().then(r=>n(void 0,typeof t=="object"&&(t!=null&&t.bigint)?new rg(r):r)).catch(n)}function V_e(e,t=yr){new Ha(this,e).close().then(()=>t()).catch(t)}function W_e(e,t,n=yr){const r=typeof t=="number"?t:0;n=typeof t=="function"?t:n;const s=new Ha(this,e);if(r<0)throw new Xe(vt.EINVAL);s.truncate(r).then(()=>n()).catch(n)}function H_e(e,t=yr){new Ha(this,e).sync().then(()=>t()).catch(t)}function G_e(e,t=yr){new Ha(this,e).datasync().then(()=>t()).catch(t)}function K_e(e,t,n,r,s,i=yr){let a,o,l,c,u;const d=new Ha(this,e);if(typeof t=="string"){switch(u="utf8",typeof n){case"function":i=n;break;case"number":c=n,u=typeof r=="string"?r:"utf8",i=typeof s=="function"?s:i;break;default:i=typeof r=="function"?r:typeof s=="function"?s:i,i(new Xe(vt.EINVAL,"Invalid arguments"));return}a=Fs.from(t),o=0,l=a.length;const h=i;d.write(a,o,l,c).then(({bytesWritten:m})=>h(void 0,m,a.toString(u))).catch(h)}else{a=Fs.from(t.buffer),o=n,l=r,c=typeof s=="number"?s:null;const h=typeof s=="function"?s:i;d.write(a,o,l,c).then(({bytesWritten:m})=>h(void 0,m,a)).catch(h)}}function Y_e(e,t,n,r,s,i=yr){new Ha(this,e).read(t,n,r,s).then(({bytesRead:a,buffer:o})=>i(void 0,a,o)).catch(i)}function Z_e(e,t,n,r=yr){new Ha(this,e).chown(t,n).then(()=>r()).catch(r)}function X_e(e,t,n){new Ha(this,e).chmod(t).then(()=>n()).catch(n)}function J_e(e,t,n,r=yr){new Ha(this,e).utimes(t,n).then(()=>r()).catch(r)}function Q_e(e,t=yr){hD.call(this,e).then(()=>t()).catch(t)}function eCe(e,t,n=yr){fT.call(this,e,t).then(()=>n()).catch(n)}function tCe(e,t,n=yr){n=typeof t=="function"?t:n;const r=typeof t!="function"?t:{};og.call(this,e,r).then(s=>n(void 0,s)).catch(n)}function nCe(e,t,n=yr){DY.call(this,e,t).then(()=>n()).catch(n)}function rCe(e,t,n,r=yr){const s=typeof n=="string"?n:"file";r=typeof n=="function"?n:r,FY.call(this,e,t,s).then(()=>r()).catch(r)}function sCe(e,t,n=yr){n=typeof t=="function"?t:n,sk.call(this,e).then(r=>n(void 0,r)).catch(n)}function iCe(e,t,n,r=yr){LY.call(this,e,t,n).then(()=>r()).catch(r)}function aCe(e,t,n,r=yr){BY.call(this,e,t,n).then(()=>r()).catch(r)}function oCe(e,t,n=yr){$Y.call(this,e,t).then(()=>n()).catch(n)}function lCe(e,t,n=yr){zY.call(this,e,t).then(()=>n()).catch(n)}function cCe(e,t,n,r=yr){pD.call(this,e,t,n).then(()=>r()).catch(r)}function uCe(e,t,n,r=yr){UY.call(this,e,t,n).then(()=>r()).catch(r)}function dCe(e,t,n=yr){n=typeof t=="function"?t:n,cp.call(this,e,typeof t=="function"?null:t).then(r=>n(void 0,r)).catch(n)}function fCe(e,t,n=yr){const r=typeof t=="number"?t:Xi;n=typeof t=="function"?t:n,qY.call(this,e,r).then(()=>n()).catch(n)}const R0=new Map;function hCe(e,t,n){const r=$n(e),s=typeof t!="function"?t:{};if(typeof t=="function"&&(n=t),!n)throw new Xe(vt.EINVAL,"No listener specified",e.toString(),"watchFile");if(R0.has(r)){const a=R0.get(r);a&&a.listeners.add(n);return}const i=new QSe(this,r,s);i.on("change",(a,o)=>{const l=R0.get(r);if(l)for(const c of l.listeners)c(a,o)}),R0.set(r,{watcher:i,listeners:new Set})}function pCe(e,t=yr){const n=$n(e),r=R0.get(n);r&&(t&&t!==yr?r.listeners.delete(t):r.listeners.clear(),r.listeners.size===0&&(r.watcher.stop(),R0.delete(n)))}function mCe(e,t,n){const r=new bY(this,$n(e),typeof t=="object"?t:{});return n=typeof t=="function"?t:n,r.on("change",n||yr),r}function gCe(e,t){t=typeof t=="object"?t:{encoding:t};const n=pc.call(this,e,"r",t==null?void 0:t.mode);return new dD({...t,autoClose:!0},n)}function yCe(e,t){t=typeof t=="object"?t:{encoding:t};const n=pc.call(this,e,"w",t==null?void 0:t.mode);return new fD(t,n)}function bCe(e,t,n=yr){n=typeof t=="function"?t:n,mD.call(this,e,typeof t=="function"?void 0:t).then(()=>n(void 0)).catch(n)}function vCe(e,t,n=yr){n=typeof t=="function"?t:n,VY.call(this,e,typeof t!="function"?t:null).then(r=>n(void 0,r)).catch(n)}function xCe(e,t,n,r=yr){r=typeof n=="function"?n:r,gD.call(this,e,t,typeof n=="function"?void 0:n).then(()=>r(void 0)).catch(r)}function wCe(e,t,n,r=yr){r=typeof n=="function"?n:r,new Ha(this,e).readv(t,typeof n=="function"?void 0:n).then(({buffers:s,bytesRead:i})=>r(void 0,i,s)).catch(r)}function SCe(e,t,n,r=yr){r=typeof n=="function"?n:r,new Ha(this,e).writev(t,typeof n=="function"?void 0:n).then(({buffers:s,bytesWritten:i})=>r(void 0,i,s)).catch(r)}function _Ce(e,t,n=yr){n=typeof t=="function"?t:n,WY.call(this,e,typeof t=="function"?void 0:t).then(r=>n(void 0,r)).catch(n)}function CCe(e,t,n,r=yr){r=typeof n=="function"?n:r,yD.call(this,e,t,typeof n=="function"?void 0:n).then(()=>r(void 0)).catch(r)}function kCe(e,t,n=yr){n=typeof t=="function"?t:n,HY.call(this,e,typeof t=="function"?void 0:t).then(r=>n(void 0,r)).catch(n)}async function ECe(e,t){const n=await pc.call(this,e.toString(),"r"),r=await n.readFile();return await n.close(),new Blob([r],t)}function TCe(e,t,n=yr){n=typeof t=="function"?t:n;const r=GY.call(this,e,typeof t=="function"?void 0:t);M_e(r).then(s=>{var i;return n(null,(i=s)!==null&&i!==void 0?i:[])}).catch(s=>n(s))}var Hp=function(e,t,n,r,s,i){function a(x){if(x!==void 0&&typeof x!="function")throw new TypeError("Function expected");return x}for(var o=r.kind,l=o==="getter"?"get":o==="setter"?"set":"value",c=!t&&e?r.static?e:e.prototype:null,u=t||(c?Object.getOwnPropertyDescriptor(c,r.name):{}),d,h=!1,m=n.length-1;m>=0;m--){var y={};for(var b in r)y[b]=b==="access"?{}:r[b];for(var b in r.access)y.access[b]=r.access[b];y.addInitializer=function(x){if(h)throw new TypeError("Cannot add initializers after decoration has completed");i.push(a(x||null))};var v=(0,n[m])(o==="accessor"?{get:u.get,set:u.set}:u[l],y);if(o==="accessor"){if(v===void 0)continue;if(v===null||typeof v!="object")throw new TypeError("Object expected");(d=a(v.get))&&(u.get=d),(d=a(v.set))&&(u.set=d),(d=a(v.init))&&s.unshift(d)}else(d=a(v))&&(o==="field"?s.unshift(d):u[l]=d)}c&&Object.defineProperty(c,r.name,u),h=!0},cl=function(e,t,n){for(var r=arguments.length>2,s=0;s<t.length;s++)n=r?t[s].call(e,n):t[s].call(e);return r?n:void 0},ACe=function(e,t,n){return typeof t=="symbol"&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:n?"".concat(n," ",t):t})},ak;(function(e){e[e.RealTime=1]="RealTime",e[e.PreAlloc=2]="PreAlloc",e[e.Immutable=8]="Immutable",e[e.Append=16]="Append",e[e.Sync=32]="Sync",e[e.NoAtime=64]="NoAtime",e[e.NoDump=128]="NoDump",e[e.RtInherit=256]="RtInherit",e[e.ProjInherit=512]="ProjInherit",e[e.NoSymlinks=1024]="NoSymlinks",e[e.ExtSize=2048]="ExtSize",e[e.ExtSzInherit=4096]="ExtSzInherit",e[e.NoDefrag=8192]="NoDefrag",e[e.FileStream=16384]="FileStream",e[e.Dax=32768]="Dax",e[e.CowExtSize=65536]="CowExtSize",e[e.HasAttr=2147483648]="HasAttr"})(ak||(ak={}));let KY=(()=>{var e,t,n,r,s;let i=[Jm()],a,o=[],l,c,u=[],d=[],h,m=[],y=[],b,v=[],x=[],w,_=[],k=[],C,T=[],A=[],N,I=[],j=[];return l=class{constructor(L=vs(new Xe(vt.EINVAL,"fsxattr must be initialized with an inode"))){this.xflags=cl(this,u,0),this.extsize=(cl(this,d),cl(this,m,0)),this.nextents=(cl(this,y),cl(this,v,0)),this.projid=(cl(this,x),cl(this,_,0)),this.cowextsize=(cl(this,k),cl(this,T,0)),this.pad=(cl(this,A),cl(this,I,[])),cl(this,j),this.extsize=L.size,this.nextents=1,this.projid=L.uid,this.cowextsize=L.size;for(const D of Object.keys($o))L.flags&$o[D]&&D in ak&&(this.xflags|=ak[D])}},ACe(l,"fsxattr"),(()=>{const L=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;c=[(e=nr).uint32.bind(e)],h=[(t=nr).uint32.bind(t)],b=[(n=nr).uint32.bind(n)],w=[(r=nr).uint32.bind(r)],C=[(s=nr).uint32.bind(s)],N=[nr.char(8)],Hp(null,null,c,{kind:"field",name:"xflags",static:!1,private:!1,access:{has:D=>"xflags"in D,get:D=>D.xflags,set:(D,H)=>{D.xflags=H}},metadata:L},u,d),Hp(null,null,h,{kind:"field",name:"extsize",static:!1,private:!1,access:{has:D=>"extsize"in D,get:D=>D.extsize,set:(D,H)=>{D.extsize=H}},metadata:L},m,y),Hp(null,null,b,{kind:"field",name:"nextents",static:!1,private:!1,access:{has:D=>"nextents"in D,get:D=>D.nextents,set:(D,H)=>{D.nextents=H}},metadata:L},v,x),Hp(null,null,w,{kind:"field",name:"projid",static:!1,private:!1,access:{has:D=>"projid"in D,get:D=>D.projid,set:(D,H)=>{D.projid=H}},metadata:L},_,k),Hp(null,null,C,{kind:"field",name:"cowextsize",static:!1,private:!1,access:{has:D=>"cowextsize"in D,get:D=>D.cowextsize,set:(D,H)=>{D.cowextsize=H}},metadata:L},T,A),Hp(null,null,N,{kind:"field",name:"pad",static:!1,private:!1,access:{has:D=>"pad"in D,get:D=>D.pad,set:(D,H)=>{D.pad=H}},metadata:L},I,j),Hp(null,a={value:l},i,{kind:"class",name:l.name,metadata:L},null,o),l=a.value,L&&Object.defineProperty(l,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:L}),cl(l,o)})(),l})();var qs;(function(e){e[e.GetFlags=2148034049]="GetFlags",e[e.SetFlags=1074292226]="SetFlags",e[e.GetVersion=2148038145]="GetVersion",e[e.SetVersion=1074296322]="SetVersion",e[e.Fiemap=3223348747]="Fiemap",e[e.GetXattr=2149341215]="GetXattr",e[e.SetXattr=1075599392]="SetXattr",e[e.GetLabel=2164298801]="GetLabel",e[e.SetLabel=1090556978]="SetLabel",e[e.GetUUID=2148603136]="GetUUID",e[e.GetSysfsPath=2155943169]="GetSysfsPath"})(qs||(qs={}));var jc;(function(e){e[e.GetFlags=2147771905]="GetFlags",e[e.SetFlags=1074030082]="SetFlags",e[e.GetVersion=2147776001]="GetVersion",e[e.SetVersion=1074034178]="SetVersion"})(jc||(jc={}));async function RCe(e,t,...n){e=$n(e);const{fs:r,path:s}=jr(e,this);try{const i=new Mi(await r.stat(s));switch(t){case qs.GetFlags:case jc.GetFlags:return i.flags;case qs.SetFlags:case jc.SetFlags:i.flags=n[0],await r.touch(s,i);return;case qs.GetVersion:case jc.GetVersion:return i.version;case qs.SetVersion:case jc.SetVersion:i.version=n[0],await r.touch(s,i);return;case qs.Fiemap:break;case qs.GetXattr:return new KY(i);case qs.SetXattr:break;case qs.GetLabel:return r.label;case qs.SetLabel:r.label=n[0];return;case qs.GetUUID:return r.uuid;case qs.GetSysfsPath:return`/sys/fs/${r.name}/${r.uuid}`}}catch(i){throw ps(i,{[s]:e})}throw new Xe(vt.ENOTSUP,"Unsupported command: "+t,e,"ioctl")}function NCe(e,t,...n){e=$n(e);const{fs:r,path:s}=jr(e,this);try{const i=new Mi(r.statSync(s));switch(t){case qs.GetFlags:case jc.GetFlags:return i.flags;case qs.SetFlags:case jc.SetFlags:i.flags=n[0],r.touchSync(s,i);return;case qs.GetVersion:case jc.GetVersion:return i.version;case qs.SetVersion:case jc.SetVersion:i.version=n[0],r.touchSync(s,i);return;case qs.Fiemap:break;case qs.GetXattr:return new KY(i);case qs.SetXattr:break;case qs.GetLabel:return r.label;case qs.SetLabel:r.label=n[0];return;case qs.GetUUID:return r.uuid;case qs.GetSysfsPath:return`/sys/fs/${r.name}/${r.uuid}`}}catch(i){throw ps(i,{[s]:e})}throw new Xe(vt.ENOTSUP,"Unsupported command: "+t,e,"ioctl")}const ICe=[];function ub(e,t,n,r){if(!t.startsWith("user.")&&!ICe.includes(t))throw new Xe(vt.EPERM,"Only attributes in the user namespace are supported",n,r)}async function MCe(e,t,n={}){var r;e=$n(e);const{fs:s,path:i}=jr(e,this);ub(this,t,e,"xattr.get");try{const a=await s.stat(i);if(Ji&&!hs(this,a,Xi))throw Xe.With("EACCES",i,"xattr.get");(r=a.attributes)!==null&&r!==void 0||(a.attributes=new $h);const o=a.attributes.get(t);if(!o)throw Xe.With("ENODATA",i,"xattr.get");const l=Fs.from(o.value);return n.encoding=="buffer"||!n.encoding?l:l.toString(n.encoding)}catch(a){throw ps(a,{[i]:e})}}function jCe(e,t,n={}){var r;e=$n(e),ub(this,t,e,"xattr.get");const{fs:s,path:i}=jr(e,this);try{const a=s.statSync(i);if(Ji&&!hs(this,a,Xi))throw Xe.With("EACCES",i,"xattr.get");(r=a.attributes)!==null&&r!==void 0||(a.attributes=new $h);const o=a.attributes.get(t);if(!o)throw Xe.With("ENODATA",i,"xattr.get");const l=Fs.from(o.value);return n.encoding=="buffer"||!n.encoding?l:l.toString(n.encoding)}catch(a){throw ps(a,{[i]:e})}}async function PCe(e,t,n,r={}){var s;e=$n(e);const{fs:i,path:a}=jr(e,this);ub(this,t,e,"xattr.set");try{const o=await i.stat(a);if(Ji&&!hs(this,o,ui))throw Xe.With("EACCES",a,"xattr.set");(s=o.attributes)!==null&&s!==void 0||(o.attributes=new $h);const l=o.attributes.get(t);if(r.create&&l)throw Xe.With("EEXIST",a,"xattr.set");if(r.replace&&!l)throw Xe.With("ENODATA",a,"xattr.set");o.attributes.set(t,Fs.from(n)),await i.touch(a,Xm(o,"attributes"))}catch(o){throw ps(o,{[a]:e})}}function OCe(e,t,n,r={}){var s;e=$n(e);const{fs:i,path:a}=jr(e,this);ub(this,t,e,"xattr.set");try{const o=i.statSync(a);if(Ji&&!hs(this,o,ui))throw Xe.With("EACCES",a,"xattr.set");(s=o.attributes)!==null&&s!==void 0||(o.attributes=new $h);const l=o.attributes.get(t);if(r.create&&l)throw Xe.With("EEXIST",a,"xattr.set");if(r.replace&&!l)throw Xe.With("ENODATA",a,"xattr.set");o.attributes.set(t,Fs.from(n)),i.touchSync(a,Xm(o,"attributes"))}catch(o){throw ps(o,{[a]:e})}}async function DCe(e,t){var n;e=$n(e);const{fs:r,path:s}=jr(e,this);ub(this,t,e,"xattr.remove");try{const i=await r.stat(s);if(Ji&&!hs(this,i,ui))throw Xe.With("EACCES",s,"xattr.remove");if((n=i.attributes)!==null&&n!==void 0||(i.attributes=new $h),!i.attributes.get(t))throw Xe.With("ENODATA",s,"xattr.remove");i.attributes.remove(t),await r.touch(s,Xm(i,"attributes"))}catch(i){throw ps(i,{[s]:e})}}function FCe(e,t){var n;e=$n(e);const{fs:r,path:s}=jr(e,this);ub(this,t,e,"xattr.remove");try{const i=r.statSync(s);if(Ji&&!hs(this,i,ui))throw Xe.With("EACCES",s,"xattr.remove");if((n=i.attributes)!==null&&n!==void 0||(i.attributes=new $h),!i.attributes.get(t))throw Xe.With("ENODATA",s,"xattr.remove");i.attributes.remove(t),r.touchSync(s,Xm(i,"attributes"))}catch(i){throw ps(i,{[s]:e})}}async function LCe(e){e=$n(e);const{fs:t,path:n}=jr(e,this);try{const r=await t.stat(n);return r.attributes?r.attributes.keys():[]}catch(r){throw ps(r,{[n]:e})}}function BCe(e){e=$n(e);const{fs:t,path:n}=jr(e,this);try{const r=t.statSync(n);return r.attributes?r.attributes.keys():[]}catch(r){throw ps(r,{[n]:e})}}const $Ce=Object.freeze(Object.defineProperty({__proto__:null,get:MCe,getSync:jCe,list:LCe,listSync:BCe,remove:DCe,removeSync:FCe,set:PCe,setSync:OCe},Symbol.toStringTag,{value:"Module"})),ya=Object.freeze(Object.defineProperty({__proto__:null,BigIntStatsFs:OSe,Dir:aD,Dirent:ww,get IOC(){return qs},get IOC32(){return jc},ReadStream:dD,Stats:yf,StatsFs:PSe,WriteStream:fD,access:fCe,accessSync:b_e,appendFile:U_e,appendFileSync:s_e,chmod:oCe,chmodSync:m_e,chown:iCe,chownSync:h_e,chroot:XSe,close:V_e,closeSync:ig,constants:lY,copyFile:xCe,copyFileSync:_Y,cp:CCe,cpSync:CY,createReadStream:gCe,createWriteStream:yCe,exists:P_e,existsSync:XO,fchmod:X_e,fchmodSync:rD,fchown:Z_e,fchownSync:nD,fdatasync:G_e,fdatasyncSync:l_e,fstat:q_e,fstatSync:i_e,fsync:H_e,fsyncSync:o_e,ftruncate:W_e,ftruncateSync:a_e,futimes:J_e,futimesSync:sD,glob:TCe,globSync:C_e,ioctl:RCe,ioctlSync:NCe,lchmod:lCe,lchmodSync:g_e,lchown:aCe,lchownSync:p_e,link:nCe,linkSync:d_e,lopenSync:rT,lstat:D_e,lstatSync:JO,lutimes:uCe,lutimesSync:y_e,mkdir:eCe,mkdirSync:iD,mkdtemp:vCe,mkdtempSync:v_e,mount:ZO,open:B_e,openAsBlob:ECe,openSync:nT,opendir:_Ce,opendirSync:S_e,promises:I_e,read:Y_e,readFile:$_e,readFileSync:eD,readSync:u_e,readdir:tCe,readdirSync:ab,readlink:sCe,readlinkSync:z3,readv:wCe,readvSync:x_e,realpath:dCe,realpathSync:ap,rename:j_e,renameSync:n_e,rm:bCe,rmSync:SY,rmdir:Q_e,rmdirSync:xY,stat:O_e,statSync:zh,statfs:kCe,statfsSync:__e,symlink:rCe,symlinkSync:f_e,truncate:F_e,truncateSync:r_e,umount:mY,unlink:L_e,unlinkSync:QO,unwatchFile:pCe,utimes:cCe,utimesSync:wY,watch:mCe,watchFile:hCe,write:K_e,writeFile:z_e,writeFileSync:tD,writeSync:c_e,writev:SCe,writevSync:w_e,xattr:$Ce},Symbol.toStringTag,{value:"Module"}));function Gz(e){return XK(e)||WO(e)||e instanceof YO}async function YY(e,t=0){if(typeof e!="object"||e==null)throw Bo(new Xe(vt.EINVAL,"Invalid options on mount configuration"));if(!Gz(e))throw Bo(new Xe(vt.EINVAL,"Invalid mount configuration"));if(e instanceof YO)return await e.ready(),e;WO(e)&&(e={backend:e});for(const[s,i]of Object.entries(e))if(s!="backend"&&Gz(i)){if(ZK("Resolving nested mount configuration: "+s),t>10)throw Bo(new Xe(vt.EINVAL,"Invalid configuration, too deep and possibly infinite"));e[s]=await YY(i,++t)}const{backend:n}=e;if(typeof n.isAvailable=="function"&&!await n.isAvailable(e))throw Bo(new Xe(vt.EPERM,"Backend not available: "+n.name));ySe(n,e);const r=await n.create(e);return e.disableAsyncCache&&r.attributes.set("no_async"),await r.ready(),r}async function zCe(e){if(!XK(e))throw new TypeError("Invalid single mount point configuration");const t=await YY(e);mY("/"),ZO("/",t)}const UCe=["delete"];Math.max(...UCe.map(e=>e.length));gSe("RPCPort",e=>typeof(e==null?void 0:e.postMessage)=="function");const ZY=new Uint32Array(256);for(let e=0;e<256;e++){let t=e;for(let n=0;n<8;n++)t=t&1?2197175160^t>>>1:t>>>1;ZY[e]=t}function qCe(e){let t=4294967295;for(let n=0;n<e.length;n++)t=t>>>8^ZY[(t^e[n])&255];return(t^4294967295)>>>0}var Us=function(e,t,n,r,s,i){function a(x){if(x!==void 0&&typeof x!="function")throw new TypeError("Function expected");return x}for(var o=r.kind,l=o==="getter"?"get":o==="setter"?"set":"value",c=!t&&e?r.static?e:e.prototype:null,u=t||(c?Object.getOwnPropertyDescriptor(c,r.name):{}),d,h=!1,m=n.length-1;m>=0;m--){var y={};for(var b in r)y[b]=b==="access"?{}:r[b];for(var b in r.access)y.access[b]=r.access[b];y.addInitializer=function(x){if(h)throw new TypeError("Cannot add initializers after decoration has completed");i.push(a(x||null))};var v=(0,n[m])(o==="accessor"?{get:u.get,set:u.set}:u[l],y);if(o==="accessor"){if(v===void 0)continue;if(v===null||typeof v!="object")throw new TypeError("Object expected");(d=a(v.get))&&(u.get=d),(d=a(v.set))&&(u.set=d),(d=a(v.init))&&s.unshift(d)}else(d=a(v))&&(o==="field"?s.unshift(d):u[l]=d)}c&&Object.defineProperty(c,r.name,u),h=!0},ur=function(e,t,n){for(var r=arguments.length>2,s=0;s<t.length;s++)n=r?t[s].call(e,n):t[s].call(e);return r?n:void 0},bD=function(e,t,n){return typeof t=="symbol"&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:n?"".concat(n," ",t):t})};let Kz=(()=>{var e,t,n,r;let s=[Jm()],i,a=[],o,l,c=[],u=[],d,h=[],m=[],y,b=[],v=[],x,w=[],_=[];return o=class{constructor(){this.id=ur(this,c,0),this.offset_=(ur(this,u),ur(this,h,0)),this.offset=(ur(this,m),ur(this,b,0)),this.size=(ur(this,v),ur(this,w,0)),ur(this,_)}},bD(o,"MetadataEntry"),(()=>{const k=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;l=[(e=nr).uint32.bind(e)],d=[(t=nr).uint32.bind(t)],y=[(n=nr).uint32.bind(n)],x=[(r=nr).uint32.bind(r)],Us(null,null,l,{kind:"field",name:"id",static:!1,private:!1,access:{has:C=>"id"in C,get:C=>C.id,set:(C,T)=>{C.id=T}},metadata:k},c,u),Us(null,null,d,{kind:"field",name:"offset_",static:!1,private:!1,access:{has:C=>"offset_"in C,get:C=>C.offset_,set:(C,T)=>{C.offset_=T}},metadata:k},h,m),Us(null,null,y,{kind:"field",name:"offset",static:!1,private:!1,access:{has:C=>"offset"in C,get:C=>C.offset,set:(C,T)=>{C.offset=T}},metadata:k},b,v),Us(null,null,x,{kind:"field",name:"size",static:!1,private:!1,access:{has:C=>"size"in C,get:C=>C.size,set:(C,T)=>{C.size=T}},metadata:k},w,_),Us(null,i={value:o},s,{kind:"class",name:o.name,metadata:k},null,a),o=i.value,k&&Object.defineProperty(o,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:k}),ur(o,a)})(),o})();const Yz=255;let Gp=(()=>{var e,t,n,r;let s=[Jm()],i,a=[],o,l,c=[],u=[],d,h=[],m=[],y,b=[],v=[],x,w=[],_=[],k,C=[],T=[];var A=o=class{constructor(N=vs(new Xe(vt.EINVAL,"Metadata block must be initialized with a superblock")),I=0){if(this.superblock=N,this.offset=I,this.checksum=ur(this,c,0),this.timestamp=(ur(this,u),ur(this,h,Date.now())),this.previous_offset_=(ur(this,m),ur(this,b,0)),this.previous_offset=(ur(this,v),ur(this,w,0)),this._previous=ur(this,_),this.entries=ur(this,C,Array.from({length:Yz},()=>new Kz)),ur(this,T),this.superblock=N,this.offset=I,!!I&&(ZE(this,N.store._buffer.subarray(I,I+Vs(A))),!XY(this)))throw XE(new Xe(vt.EIO,"SingleBuffer: Checksum mismatch for metadata block at 0x"+I.toString(16)))}get previous(){var N;if(this.previous_offset)return(N=this._previous)!==null&&N!==void 0||(this._previous=new A(this.superblock,this.previous_offset)),this._previous}};return bD(o,"MetadataBlock"),(()=>{const N=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;l=[(e=nr).uint32.bind(e)],d=[(t=nr).uint32.bind(t)],y=[(n=nr).uint32.bind(n)],x=[(r=nr).uint32.bind(r)],k=[yw(Kz,Yz)],Us(null,null,l,{kind:"field",name:"checksum",static:!1,private:!1,access:{has:I=>"checksum"in I,get:I=>I.checksum,set:(I,j)=>{I.checksum=j}},metadata:N},c,u),Us(null,null,d,{kind:"field",name:"timestamp",static:!1,private:!1,access:{has:I=>"timestamp"in I,get:I=>I.timestamp,set:(I,j)=>{I.timestamp=j}},metadata:N},h,m),Us(null,null,y,{kind:"field",name:"previous_offset_",static:!1,private:!1,access:{has:I=>"previous_offset_"in I,get:I=>I.previous_offset_,set:(I,j)=>{I.previous_offset_=j}},metadata:N},b,v),Us(null,null,x,{kind:"field",name:"previous_offset",static:!1,private:!1,access:{has:I=>"previous_offset"in I,get:I=>I.previous_offset,set:(I,j)=>{I.previous_offset=j}},metadata:N},w,_),Us(null,null,k,{kind:"field",name:"entries",static:!1,private:!1,access:{has:I=>"entries"in I,get:I=>I.entries,set:(I,j)=>{I.entries=j}},metadata:N},C,T),Us(null,i={value:o},s,{kind:"class",name:o.name,metadata:N},null,a),A=o=i.value,N&&Object.defineProperty(o,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:N}),ur(o,a)})(),A=o})();const Zz=2049864546;(()=>{var e,t,n,r,s,i,a,o,l,c,u;let d=[Jm()],h,m=[],y,b,v=[],x=[],w,_=[],k=[],C,T=[],A=[],N,I=[],j=[],L,D=[],H=[],O,K=[],U=[],W,B=[],ne=[],V,Q=[],ee=[],re,de=[],me=[],De,je=[],Te=[],_e,Ue=[],Qe=[],We,Pe=[],Y=[],ye,Me=[],ue=[];var oe=y=class{constructor(se=vs(new Xe(vt.EINVAL,"Super block must be initialized with a store"))){if(this.store=se,this.checksum=ur(this,v,0),this.magic=(ur(this,x),ur(this,_,Zz)),this.version=(ur(this,k),ur(this,T,1)),this.inode_format=(ur(this,A),ur(this,I,FSe)),this.flags=(ur(this,j),ur(this,D,0)),this.used_bytes=(ur(this,H),ur(this,K,BigInt(0))),this.total_bytes=(ur(this,U),ur(this,B,BigInt(0))),this.uuid=(ur(this,ne),ur(this,Q,BigInt(0))),this.metadata_block_size=(ur(this,ee),ur(this,de,Vs(Gp))),this.metadata_offset_=(ur(this,me),ur(this,je,0)),this.metadata_offset=(ur(this,Te),ur(this,Ue,0)),this.metadata=ur(this,Qe),this.label=ur(this,Pe,""),this._padding=(ur(this,Y),ur(this,Me,new Array(132).fill(0))),ur(this,ue),this.store=se,se._view.getUint32(eSe(oe,"magic"),!0)!=Zz){Ua("SingleBuffer: Invalid magic value, assuming this is a fresh super block"),this.metadata=new Gp(this),this.metadata.offset=Vs(oe),this.metadata_offset=this.metadata.offset,this.used_bytes=BigInt(Vs(oe)+Vs(Gp)),this.total_bytes=BigInt(se._buffer.byteLength),se._write(this),se._write(this.metadata);return}if(ZE(this,se._buffer.subarray(0,Vs(oe))),!XY(this))throw XE(new Xe(vt.EIO,"SingleBuffer: Checksum mismatch for super block!"));this.metadata=new Gp(this,this.metadata_offset)}rotateMetadata(){const se=new Gp(this);return se.offset=Number(this.used_bytes),se.previous_offset=this.metadata_offset,this.metadata=se,this.metadata_offset=se.offset,this.store._write(se),this.used_bytes+=BigInt(Vs(Gp)),this.store._write(this),se}isUnused(se,Ie){if(!Ie)return!0;if(se+Ie>this.total_bytes||se<Vs(oe))return!1;for(let Be=this.metadata;Be;Be=Be.previous){if(se<Be.offset+Vs(Gp)&&se+Ie>Be.offset)return!1;for(const Re of Be.entries)if(Re.offset&&(se>=Re.offset&&se<Re.offset+Re.size||se+Ie>Re.offset&&se+Ie<=Re.offset+Re.size||se<=Re.offset&&se+Ie>=Re.offset+Re.size))return!1}return!0}};return bD(y,"SuperBlock"),(()=>{const se=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;b=[(e=nr).uint32.bind(e)],w=[(t=nr).uint32.bind(t)],C=[(n=nr).uint16.bind(n)],N=[(r=nr).uint16.bind(r)],L=[(s=nr).uint32.bind(s)],O=[(i=nr).uint64.bind(i)],W=[(a=nr).uint64.bind(a)],V=[(o=nr).uint128.bind(o)],re=[(l=nr).uint32.bind(l)],De=[(c=nr).uint32.bind(c)],_e=[(u=nr).uint32.bind(u)],We=[nr.char(64)],ye=[nr.char(132)],Us(null,null,b,{kind:"field",name:"checksum",static:!1,private:!1,access:{has:Ie=>"checksum"in Ie,get:Ie=>Ie.checksum,set:(Ie,Be)=>{Ie.checksum=Be}},metadata:se},v,x),Us(null,null,w,{kind:"field",name:"magic",static:!1,private:!1,access:{has:Ie=>"magic"in Ie,get:Ie=>Ie.magic,set:(Ie,Be)=>{Ie.magic=Be}},metadata:se},_,k),Us(null,null,C,{kind:"field",name:"version",static:!1,private:!1,access:{has:Ie=>"version"in Ie,get:Ie=>Ie.version,set:(Ie,Be)=>{Ie.version=Be}},metadata:se},T,A),Us(null,null,N,{kind:"field",name:"inode_format",static:!1,private:!1,access:{has:Ie=>"inode_format"in Ie,get:Ie=>Ie.inode_format,set:(Ie,Be)=>{Ie.inode_format=Be}},metadata:se},I,j),Us(null,null,L,{kind:"field",name:"flags",static:!1,private:!1,access:{has:Ie=>"flags"in Ie,get:Ie=>Ie.flags,set:(Ie,Be)=>{Ie.flags=Be}},metadata:se},D,H),Us(null,null,O,{kind:"field",name:"used_bytes",static:!1,private:!1,access:{has:Ie=>"used_bytes"in Ie,get:Ie=>Ie.used_bytes,set:(Ie,Be)=>{Ie.used_bytes=Be}},metadata:se},K,U),Us(null,null,W,{kind:"field",name:"total_bytes",static:!1,private:!1,access:{has:Ie=>"total_bytes"in Ie,get:Ie=>Ie.total_bytes,set:(Ie,Be)=>{Ie.total_bytes=Be}},metadata:se},B,ne),Us(null,null,V,{kind:"field",name:"uuid",static:!1,private:!1,access:{has:Ie=>"uuid"in Ie,get:Ie=>Ie.uuid,set:(Ie,Be)=>{Ie.uuid=Be}},metadata:se},Q,ee),Us(null,null,re,{kind:"field",name:"metadata_block_size",static:!1,private:!1,access:{has:Ie=>"metadata_block_size"in Ie,get:Ie=>Ie.metadata_block_size,set:(Ie,Be)=>{Ie.metadata_block_size=Be}},metadata:se},de,me),Us(null,null,De,{kind:"field",name:"metadata_offset_",static:!1,private:!1,access:{has:Ie=>"metadata_offset_"in Ie,get:Ie=>Ie.metadata_offset_,set:(Ie,Be)=>{Ie.metadata_offset_=Be}},metadata:se},je,Te),Us(null,null,_e,{kind:"field",name:"metadata_offset",static:!1,private:!1,access:{has:Ie=>"metadata_offset"in Ie,get:Ie=>Ie.metadata_offset,set:(Ie,Be)=>{Ie.metadata_offset=Be}},metadata:se},Ue,Qe),Us(null,null,We,{kind:"field",name:"label",static:!1,private:!1,access:{has:Ie=>"label"in Ie,get:Ie=>Ie.label,set:(Ie,Be)=>{Ie.label=Be}},metadata:se},Pe,Y),Us(null,null,ye,{kind:"field",name:"_padding",static:!1,private:!1,access:{has:Ie=>"_padding"in Ie,get:Ie=>Ie._padding,set:(Ie,Be)=>{Ie._padding=Be}},metadata:se},Me,ue),Us(null,h={value:y},d,{kind:"class",name:y.name,metadata:se},null,m),oe=y=h.value,se&&Object.defineProperty(y,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:se}),ur(y,m)})(),oe=y})();function XY(e){const t=Ca(e),n=qCe(t.subarray(4));return e.checksum===n}globalThis.__zenfs__=ya;function VCe(e){switch(e.name){case"TypeMismatchError":return"EPERM";case"IndexSizeError":case"HierarchyRequestError":case"InvalidCharacterError":case"InvalidStateError":case"SyntaxError":case"NamespaceError":case"ConstraintError":case"VersionError":case"URLMismatchError":case"InvalidNodeTypeError":return"EINVAL";case"WrongDocumentError":return"EXDEV";case"NoModificationAllowedError":case"InvalidModificationError":case"InvalidAccessError":case"SecurityError":case"NotAllowedError":return"EACCES";case"NotFoundError":return"ENOENT";case"NotSupportedError":return"ENOTSUP";case"InUseAttributeError":return"EBUSY";case"NetworkError":return"ENETDOWN";case"AbortError":return"EINTR";case"QuotaExceededError":return"ENOSPC";case"TimeoutError":return"ETIMEDOUT";case"ReadOnlyError":return"EROFS";case"DataCloneError":case"EncodingError":case"NotReadableError":case"DataError":case"TransactionInactiveError":case"OperationError":case"UnknownError":default:return"EIO"}}function q3(e,t,n){if(e instanceof Xe)return e;const r=e instanceof DOMException?vt[VCe(e)]:vt.EIO,s=new Xe(r,e.message,t,n);return s.stack=e.stack,s.cause=e.cause,s}function N0(e){return new Promise((t,n)=>{e.onsuccess=()=>t(e.result),e.onerror=r=>{r.preventDefault(),n(q3(e.error))}})}class WCe extends $3{constructor(t,n){super(n),this.tx=t,this.store=n,this._idb=t.objectStore(n.name)}async keys(){return(await N0(this._idb.getAllKeys())).filter(t=>typeof t=="string").map(t=>Number(t))}async get(t){const n=await N0(this._idb.get(t.toString()));return n&&this._cached(t,{size:n.byteLength}).add(n,0),n}async set(t,n){this._cached(t,{size:n.byteLength}).add(n,0),await N0(this._idb.put(n,t.toString()))}remove(t){return this.store.cache.delete(t),N0(this._idb.delete(t.toString()))}async commit(){const{promise:t,resolve:n,reject:r}=Promise.withResolvers();return this.tx.oncomplete=()=>n(),this.tx.onerror=()=>r(q3(this.tx.error)),this.tx.commit(),t}async abort(){const{promise:t,resolve:n,reject:r}=Promise.withResolvers();return this.tx.onabort=()=>n(),this.tx.onerror=()=>r(q3(this.tx.error)),this.tx.abort(),t}}async function HCe(e,t=globalThis.indexedDB){const n=t.open(e);return n.onupgradeneeded=()=>{const r=n.result;r.objectStoreNames.contains(e)&&(Ua("Found unexpected object store: "+e),r.deleteObjectStore(e)),r.createObjectStore(e)},await N0(n)}class GCe{constructor(t){this.db=t,this.cache=new Map}sync(){return Promise.resolve()}get name(){return this.db.name}transaction(){const t=this.db.transaction(this.name,"readwrite");return new WCe(t,this)}}const KCe={name:"IndexedDB",options:{storeName:{type:"string",required:!1},idbFactory:{type:"object",required:!1}},async isAvailable({idbFactory:e=globalThis.indexedDB}){try{if(!(e instanceof IDBFactory))return!1;const t=e.open("__zenfs_test");return await N0(t),!0}catch{return!1}finally{e==null||e.deleteDatabase("__zenfs_test")}},async create(e){const t=await HCe(e.storeName||"zenfs",e.idbFactory),n=new GCe(t),r=new fY(n);if(e!=null&&e.disableAsyncCache)return VO("Async preloading disabled for IndexedDB"),r;const s=n.transaction();for(const i of await s.keys())await s.get(i);return r}},YCe=KCe,hn={vfsKeyChanged:"vfs.key.changed",nodesUpdated:"vfs.nodes.updated",selectionChanged:"vfs.selection.changed",loadingStateChanged:"vfs.loading.state.changed",fsInstanceChanged:"vfs.instance.changed",vfsEnabledChanged:"vfs.enabled.changed",fileWritten:"vfs.sdk.fileWritten",fileRead:"vfs.sdk.fileRead",fileDeleted:"vfs.sdk.fileDeleted",setVfsKeyRequest:"vfs.set.vfs.key.request",initializeVFSRequest:"vfs.initialize.vfs.request",fetchNodesRequest:"vfs.fetch.nodes.request",setCurrentPathRequest:"vfs.set.current.path.request",createDirectoryRequest:"vfs.create.directory.request",uploadFilesRequest:"vfs.upload.files.request",deleteNodesRequest:"vfs.delete.nodes.request",renameNodeRequest:"vfs.rename.node.request",downloadFileRequest:"vfs.download.file.request",selectFileRequest:"vfs.select.file.request",deselectFileRequest:"vfs.deselect.file.request",clearSelectionRequest:"vfs.clear.selection.request",setEnableVfsRequest:"vfs.set.enable.vfs.request"};function Q_(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var UI={exports:{}},Xz;function ZCe(){return Xz||(Xz=1,function(e,t){(function(n){e.exports=n()})(function(){return function n(r,s,i){function a(c,u){if(!s[c]){if(!r[c]){var d=typeof Q_=="function"&&Q_;if(!u&&d)return d(c,!0);if(o)return o(c,!0);var h=new Error("Cannot find module '"+c+"'");throw h.code="MODULE_NOT_FOUND",h}var m=s[c]={exports:{}};r[c][0].call(m.exports,function(y){var b=r[c][1][y];return a(b||y)},m,m.exports,n,r,s,i)}return s[c].exports}for(var o=typeof Q_=="function"&&Q_,l=0;l<i.length;l++)a(i[l]);return a}({1:[function(n,r,s){var i=n("./utils"),a=n("./support"),o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";s.encode=function(l){for(var c,u,d,h,m,y,b,v=[],x=0,w=l.length,_=w,k=i.getTypeOf(l)!=="string";x<l.length;)_=w-x,d=k?(c=l[x++],u=x<w?l[x++]:0,x<w?l[x++]:0):(c=l.charCodeAt(x++),u=x<w?l.charCodeAt(x++):0,x<w?l.charCodeAt(x++):0),h=c>>2,m=(3&c)<<4|u>>4,y=1<_?(15&u)<<2|d>>6:64,b=2<_?63&d:64,v.push(o.charAt(h)+o.charAt(m)+o.charAt(y)+o.charAt(b));return v.join("")},s.decode=function(l){var c,u,d,h,m,y,b=0,v=0,x="data:";if(l.substr(0,x.length)===x)throw new Error("Invalid base64 input, it looks like a data url.");var w,_=3*(l=l.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(l.charAt(l.length-1)===o.charAt(64)&&_--,l.charAt(l.length-2)===o.charAt(64)&&_--,_%1!=0)throw new Error("Invalid base64 input, bad content length.");for(w=a.uint8array?new Uint8Array(0|_):new Array(0|_);b<l.length;)c=o.indexOf(l.charAt(b++))<<2|(h=o.indexOf(l.charAt(b++)))>>4,u=(15&h)<<4|(m=o.indexOf(l.charAt(b++)))>>2,d=(3&m)<<6|(y=o.indexOf(l.charAt(b++))),w[v++]=c,m!==64&&(w[v++]=u),y!==64&&(w[v++]=d);return w}},{"./support":30,"./utils":32}],2:[function(n,r,s){var i=n("./external"),a=n("./stream/DataWorker"),o=n("./stream/Crc32Probe"),l=n("./stream/DataLengthProbe");function c(u,d,h,m,y){this.compressedSize=u,this.uncompressedSize=d,this.crc32=h,this.compression=m,this.compressedContent=y}c.prototype={getContentWorker:function(){var u=new a(i.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new l("data_length")),d=this;return u.on("end",function(){if(this.streamInfo.data_length!==d.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),u},getCompressedWorker:function(){return new a(i.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},c.createWorkerFrom=function(u,d,h){return u.pipe(new o).pipe(new l("uncompressedSize")).pipe(d.compressWorker(h)).pipe(new l("compressedSize")).withStreamInfo("compression",d)},r.exports=c},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(n,r,s){var i=n("./stream/GenericWorker");s.STORE={magic:"\0\0",compressWorker:function(){return new i("STORE compression")},uncompressWorker:function(){return new i("STORE decompression")}},s.DEFLATE=n("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(n,r,s){var i=n("./utils"),a=function(){for(var o,l=[],c=0;c<256;c++){o=c;for(var u=0;u<8;u++)o=1&o?3988292384^o>>>1:o>>>1;l[c]=o}return l}();r.exports=function(o,l){return o!==void 0&&o.length?i.getTypeOf(o)!=="string"?function(c,u,d,h){var m=a,y=h+d;c^=-1;for(var b=h;b<y;b++)c=c>>>8^m[255&(c^u[b])];return-1^c}(0|l,o,o.length,0):function(c,u,d,h){var m=a,y=h+d;c^=-1;for(var b=h;b<y;b++)c=c>>>8^m[255&(c^u.charCodeAt(b))];return-1^c}(0|l,o,o.length,0):0}},{"./utils":32}],5:[function(n,r,s){s.base64=!1,s.binary=!1,s.dir=!1,s.createFolders=!0,s.date=null,s.compression=null,s.compressionOptions=null,s.comment=null,s.unixPermissions=null,s.dosPermissions=null},{}],6:[function(n,r,s){var i=null;i=typeof Promise<"u"?Promise:n("lie"),r.exports={Promise:i}},{lie:37}],7:[function(n,r,s){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",a=n("pako"),o=n("./utils"),l=n("./stream/GenericWorker"),c=i?"uint8array":"array";function u(d,h){l.call(this,"FlateWorker/"+d),this._pako=null,this._pakoAction=d,this._pakoOptions=h,this.meta={}}s.magic="\b\0",o.inherits(u,l),u.prototype.processChunk=function(d){this.meta=d.meta,this._pako===null&&this._createPako(),this._pako.push(o.transformTo(c,d.data),!1)},u.prototype.flush=function(){l.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},u.prototype.cleanUp=function(){l.prototype.cleanUp.call(this),this._pako=null},u.prototype._createPako=function(){this._pako=new a[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var d=this;this._pako.onData=function(h){d.push({data:h,meta:d.meta})}},s.compressWorker=function(d){return new u("Deflate",d)},s.uncompressWorker=function(){return new u("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(n,r,s){function i(m,y){var b,v="";for(b=0;b<y;b++)v+=String.fromCharCode(255&m),m>>>=8;return v}function a(m,y,b,v,x,w){var _,k,C=m.file,T=m.compression,A=w!==c.utf8encode,N=o.transformTo("string",w(C.name)),I=o.transformTo("string",c.utf8encode(C.name)),j=C.comment,L=o.transformTo("string",w(j)),D=o.transformTo("string",c.utf8encode(j)),H=I.length!==C.name.length,O=D.length!==j.length,K="",U="",W="",B=C.dir,ne=C.date,V={crc32:0,compressedSize:0,uncompressedSize:0};y&&!b||(V.crc32=m.crc32,V.compressedSize=m.compressedSize,V.uncompressedSize=m.uncompressedSize);var Q=0;y&&(Q|=8),A||!H&&!O||(Q|=2048);var ee=0,re=0;B&&(ee|=16),x==="UNIX"?(re=798,ee|=function(me,De){var je=me;return me||(je=De?16893:33204),(65535&je)<<16}(C.unixPermissions,B)):(re=20,ee|=function(me){return 63&(me||0)}(C.dosPermissions)),_=ne.getUTCHours(),_<<=6,_|=ne.getUTCMinutes(),_<<=5,_|=ne.getUTCSeconds()/2,k=ne.getUTCFullYear()-1980,k<<=4,k|=ne.getUTCMonth()+1,k<<=5,k|=ne.getUTCDate(),H&&(U=i(1,1)+i(u(N),4)+I,K+="up"+i(U.length,2)+U),O&&(W=i(1,1)+i(u(L),4)+D,K+="uc"+i(W.length,2)+W);var de="";return de+=`
\0`,de+=i(Q,2),de+=T.magic,de+=i(_,2),de+=i(k,2),de+=i(V.crc32,4),de+=i(V.compressedSize,4),de+=i(V.uncompressedSize,4),de+=i(N.length,2),de+=i(K.length,2),{fileRecord:d.LOCAL_FILE_HEADER+de+N+K,dirRecord:d.CENTRAL_FILE_HEADER+i(re,2)+de+i(L.length,2)+"\0\0\0\0"+i(ee,4)+i(v,4)+N+K+L}}var o=n("../utils"),l=n("../stream/GenericWorker"),c=n("../utf8"),u=n("../crc32"),d=n("../signature");function h(m,y,b,v){l.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=y,this.zipPlatform=b,this.encodeFileName=v,this.streamFiles=m,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}o.inherits(h,l),h.prototype.push=function(m){var y=m.meta.percent||0,b=this.entriesCount,v=this._sources.length;this.accumulate?this.contentBuffer.push(m):(this.bytesWritten+=m.data.length,l.prototype.push.call(this,{data:m.data,meta:{currentFile:this.currentFile,percent:b?(y+100*(b-v-1))/b:100}}))},h.prototype.openedSource=function(m){this.currentSourceOffset=this.bytesWritten,this.currentFile=m.file.name;var y=this.streamFiles&&!m.file.dir;if(y){var b=a(m,y,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:b.fileRecord,meta:{percent:0}})}else this.accumulate=!0},h.prototype.closedSource=function(m){this.accumulate=!1;var y=this.streamFiles&&!m.file.dir,b=a(m,y,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(b.dirRecord),y)this.push({data:function(v){return d.DATA_DESCRIPTOR+i(v.crc32,4)+i(v.compressedSize,4)+i(v.uncompressedSize,4)}(m),meta:{percent:100}});else for(this.push({data:b.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},h.prototype.flush=function(){for(var m=this.bytesWritten,y=0;y<this.dirRecords.length;y++)this.push({data:this.dirRecords[y],meta:{percent:100}});var b=this.bytesWritten-m,v=function(x,w,_,k,C){var T=o.transformTo("string",C(k));return d.CENTRAL_DIRECTORY_END+"\0\0\0\0"+i(x,2)+i(x,2)+i(w,4)+i(_,4)+i(T.length,2)+T}(this.dirRecords.length,b,m,this.zipComment,this.encodeFileName);this.push({data:v,meta:{percent:100}})},h.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},h.prototype.registerPrevious=function(m){this._sources.push(m);var y=this;return m.on("data",function(b){y.processChunk(b)}),m.on("end",function(){y.closedSource(y.previous.streamInfo),y._sources.length?y.prepareNextSource():y.end()}),m.on("error",function(b){y.error(b)}),this},h.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},h.prototype.error=function(m){var y=this._sources;if(!l.prototype.error.call(this,m))return!1;for(var b=0;b<y.length;b++)try{y[b].error(m)}catch{}return!0},h.prototype.lock=function(){l.prototype.lock.call(this);for(var m=this._sources,y=0;y<m.length;y++)m[y].lock()},r.exports=h},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(n,r,s){var i=n("../compressions"),a=n("./ZipFileWorker");s.generateWorker=function(o,l,c){var u=new a(l.streamFiles,c,l.platform,l.encodeFileName),d=0;try{o.forEach(function(h,m){d++;var y=function(w,_){var k=w||_,C=i[k];if(!C)throw new Error(k+" is not a valid compression method !");return C}(m.options.compression,l.compression),b=m.options.compressionOptions||l.compressionOptions||{},v=m.dir,x=m.date;m._compressWorker(y,b).withStreamInfo("file",{name:h,dir:v,date:x,comment:m.comment||"",unixPermissions:m.unixPermissions,dosPermissions:m.dosPermissions}).pipe(u)}),u.entriesCount=d}catch(h){u.error(h)}return u}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(n,r,s){function i(){if(!(this instanceof i))return new i;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var a=new i;for(var o in this)typeof this[o]!="function"&&(a[o]=this[o]);return a}}(i.prototype=n("./object")).loadAsync=n("./load"),i.support=n("./support"),i.defaults=n("./defaults"),i.version="3.10.1",i.loadAsync=function(a,o){return new i().loadAsync(a,o)},i.external=n("./external"),r.exports=i},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(n,r,s){var i=n("./utils"),a=n("./external"),o=n("./utf8"),l=n("./zipEntries"),c=n("./stream/Crc32Probe"),u=n("./nodejsUtils");function d(h){return new a.Promise(function(m,y){var b=h.decompressed.getContentWorker().pipe(new c);b.on("error",function(v){y(v)}).on("end",function(){b.streamInfo.crc32!==h.decompressed.crc32?y(new Error("Corrupted zip : CRC32 mismatch")):m()}).resume()})}r.exports=function(h,m){var y=this;return m=i.extend(m||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:o.utf8decode}),u.isNode&&u.isStream(h)?a.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):i.prepareContent("the loaded zip file",h,!0,m.optimizedBinaryString,m.base64).then(function(b){var v=new l(m);return v.load(b),v}).then(function(b){var v=[a.Promise.resolve(b)],x=b.files;if(m.checkCRC32)for(var w=0;w<x.length;w++)v.push(d(x[w]));return a.Promise.all(v)}).then(function(b){for(var v=b.shift(),x=v.files,w=0;w<x.length;w++){var _=x[w],k=_.fileNameStr,C=i.resolve(_.fileNameStr);y.file(C,_.decompressed,{binary:!0,optimizedBinaryString:!0,date:_.date,dir:_.dir,comment:_.fileCommentStr.length?_.fileCommentStr:null,unixPermissions:_.unixPermissions,dosPermissions:_.dosPermissions,createFolders:m.createFolders}),_.dir||(y.file(C).unsafeOriginalName=k)}return v.zipComment.length&&(y.comment=v.zipComment),y})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(n,r,s){var i=n("../utils"),a=n("../stream/GenericWorker");function o(l,c){a.call(this,"Nodejs stream input adapter for "+l),this._upstreamEnded=!1,this._bindStream(c)}i.inherits(o,a),o.prototype._bindStream=function(l){var c=this;(this._stream=l).pause(),l.on("data",function(u){c.push({data:u,meta:{percent:0}})}).on("error",function(u){c.isPaused?this.generatedError=u:c.error(u)}).on("end",function(){c.isPaused?c._upstreamEnded=!0:c.end()})},o.prototype.pause=function(){return!!a.prototype.pause.call(this)&&(this._stream.pause(),!0)},o.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},r.exports=o},{"../stream/GenericWorker":28,"../utils":32}],13:[function(n,r,s){var i=n("readable-stream").Readable;function a(o,l,c){i.call(this,l),this._helper=o;var u=this;o.on("data",function(d,h){u.push(d)||u._helper.pause(),c&&c(h)}).on("error",function(d){u.emit("error",d)}).on("end",function(){u.push(null)})}n("../utils").inherits(a,i),a.prototype._read=function(){this._helper.resume()},r.exports=a},{"../utils":32,"readable-stream":16}],14:[function(n,r,s){r.exports={isNode:typeof un<"u",newBufferFrom:function(i,a){if(un.from&&un.from!==Uint8Array.from)return un.from(i,a);if(typeof i=="number")throw new Error('The "data" argument must not be a number');return new un(i,a)},allocBuffer:function(i){if(un.alloc)return un.alloc(i);var a=new un(i);return a.fill(0),a},isBuffer:function(i){return un.isBuffer(i)},isStream:function(i){return i&&typeof i.on=="function"&&typeof i.pause=="function"&&typeof i.resume=="function"}}},{}],15:[function(n,r,s){function i(C,T,A){var N,I=o.getTypeOf(T),j=o.extend(A||{},u);j.date=j.date||new Date,j.compression!==null&&(j.compression=j.compression.toUpperCase()),typeof j.unixPermissions=="string"&&(j.unixPermissions=parseInt(j.unixPermissions,8)),j.unixPermissions&&16384&j.unixPermissions&&(j.dir=!0),j.dosPermissions&&16&j.dosPermissions&&(j.dir=!0),j.dir&&(C=x(C)),j.createFolders&&(N=v(C))&&w.call(this,N,!0);var L=I==="string"&&j.binary===!1&&j.base64===!1;A&&A.binary!==void 0||(j.binary=!L),(T instanceof d&&T.uncompressedSize===0||j.dir||!T||T.length===0)&&(j.base64=!1,j.binary=!0,T="",j.compression="STORE",I="string");var D=null;D=T instanceof d||T instanceof l?T:y.isNode&&y.isStream(T)?new b(C,T):o.prepareContent(C,T,j.binary,j.optimizedBinaryString,j.base64);var H=new h(C,D,j);this.files[C]=H}var a=n("./utf8"),o=n("./utils"),l=n("./stream/GenericWorker"),c=n("./stream/StreamHelper"),u=n("./defaults"),d=n("./compressedObject"),h=n("./zipObject"),m=n("./generate"),y=n("./nodejsUtils"),b=n("./nodejs/NodejsStreamInputAdapter"),v=function(C){C.slice(-1)==="/"&&(C=C.substring(0,C.length-1));var T=C.lastIndexOf("/");return 0<T?C.substring(0,T):""},x=function(C){return C.slice(-1)!=="/"&&(C+="/"),C},w=function(C,T){return T=T!==void 0?T:u.createFolders,C=x(C),this.files[C]||i.call(this,C,null,{dir:!0,createFolders:T}),this.files[C]};function _(C){return Object.prototype.toString.call(C)==="[object RegExp]"}var k={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(C){var T,A,N;for(T in this.files)N=this.files[T],(A=T.slice(this.root.length,T.length))&&T.slice(0,this.root.length)===this.root&&C(A,N)},filter:function(C){var T=[];return this.forEach(function(A,N){C(A,N)&&T.push(N)}),T},file:function(C,T,A){if(arguments.length!==1)return C=this.root+C,i.call(this,C,T,A),this;if(_(C)){var N=C;return this.filter(function(j,L){return!L.dir&&N.test(j)})}var I=this.files[this.root+C];return I&&!I.dir?I:null},folder:function(C){if(!C)return this;if(_(C))return this.filter(function(I,j){return j.dir&&C.test(I)});var T=this.root+C,A=w.call(this,T),N=this.clone();return N.root=A.name,N},remove:function(C){C=this.root+C;var T=this.files[C];if(T||(C.slice(-1)!=="/"&&(C+="/"),T=this.files[C]),T&&!T.dir)delete this.files[C];else for(var A=this.filter(function(I,j){return j.name.slice(0,C.length)===C}),N=0;N<A.length;N++)delete this.files[A[N].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(C){var T,A={};try{if((A=o.extend(C||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:a.utf8encode})).type=A.type.toLowerCase(),A.compression=A.compression.toUpperCase(),A.type==="binarystring"&&(A.type="string"),!A.type)throw new Error("No output type specified.");o.checkSupport(A.type),A.platform!=="darwin"&&A.platform!=="freebsd"&&A.platform!=="linux"&&A.platform!=="sunos"||(A.platform="UNIX"),A.platform==="win32"&&(A.platform="DOS");var N=A.comment||this.comment||"";T=m.generateWorker(this,A,N)}catch(I){(T=new l("error")).error(I)}return new c(T,A.type||"string",A.mimeType)},generateAsync:function(C,T){return this.generateInternalStream(C).accumulate(T)},generateNodeStream:function(C,T){return(C=C||{}).type||(C.type="nodebuffer"),this.generateInternalStream(C).toNodejsStream(T)}};r.exports=k},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(n,r,s){r.exports=n("stream")},{stream:void 0}],17:[function(n,r,s){var i=n("./DataReader");function a(o){i.call(this,o);for(var l=0;l<this.data.length;l++)o[l]=255&o[l]}n("../utils").inherits(a,i),a.prototype.byteAt=function(o){return this.data[this.zero+o]},a.prototype.lastIndexOfSignature=function(o){for(var l=o.charCodeAt(0),c=o.charCodeAt(1),u=o.charCodeAt(2),d=o.charCodeAt(3),h=this.length-4;0<=h;--h)if(this.data[h]===l&&this.data[h+1]===c&&this.data[h+2]===u&&this.data[h+3]===d)return h-this.zero;return-1},a.prototype.readAndCheckSignature=function(o){var l=o.charCodeAt(0),c=o.charCodeAt(1),u=o.charCodeAt(2),d=o.charCodeAt(3),h=this.readData(4);return l===h[0]&&c===h[1]&&u===h[2]&&d===h[3]},a.prototype.readData=function(o){if(this.checkOffset(o),o===0)return[];var l=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},r.exports=a},{"../utils":32,"./DataReader":18}],18:[function(n,r,s){var i=n("../utils");function a(o){this.data=o,this.length=o.length,this.index=0,this.zero=0}a.prototype={checkOffset:function(o){this.checkIndex(this.index+o)},checkIndex:function(o){if(this.length<this.zero+o||o<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+o+"). Corrupted zip ?")},setIndex:function(o){this.checkIndex(o),this.index=o},skip:function(o){this.setIndex(this.index+o)},byteAt:function(){},readInt:function(o){var l,c=0;for(this.checkOffset(o),l=this.index+o-1;l>=this.index;l--)c=(c<<8)+this.byteAt(l);return this.index+=o,c},readString:function(o){return i.transformTo("string",this.readData(o))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var o=this.readInt(4);return new Date(Date.UTC(1980+(o>>25&127),(o>>21&15)-1,o>>16&31,o>>11&31,o>>5&63,(31&o)<<1))}},r.exports=a},{"../utils":32}],19:[function(n,r,s){var i=n("./Uint8ArrayReader");function a(o){i.call(this,o)}n("../utils").inherits(a,i),a.prototype.readData=function(o){this.checkOffset(o);var l=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},r.exports=a},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(n,r,s){var i=n("./DataReader");function a(o){i.call(this,o)}n("../utils").inherits(a,i),a.prototype.byteAt=function(o){return this.data.charCodeAt(this.zero+o)},a.prototype.lastIndexOfSignature=function(o){return this.data.lastIndexOf(o)-this.zero},a.prototype.readAndCheckSignature=function(o){return o===this.readData(4)},a.prototype.readData=function(o){this.checkOffset(o);var l=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},r.exports=a},{"../utils":32,"./DataReader":18}],21:[function(n,r,s){var i=n("./ArrayReader");function a(o){i.call(this,o)}n("../utils").inherits(a,i),a.prototype.readData=function(o){if(this.checkOffset(o),o===0)return new Uint8Array(0);var l=this.data.subarray(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},r.exports=a},{"../utils":32,"./ArrayReader":17}],22:[function(n,r,s){var i=n("../utils"),a=n("../support"),o=n("./ArrayReader"),l=n("./StringReader"),c=n("./NodeBufferReader"),u=n("./Uint8ArrayReader");r.exports=function(d){var h=i.getTypeOf(d);return i.checkSupport(h),h!=="string"||a.uint8array?h==="nodebuffer"?new c(d):a.uint8array?new u(i.transformTo("uint8array",d)):new o(i.transformTo("array",d)):new l(d)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(n,r,s){s.LOCAL_FILE_HEADER="PK",s.CENTRAL_FILE_HEADER="PK",s.CENTRAL_DIRECTORY_END="PK",s.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",s.ZIP64_CENTRAL_DIRECTORY_END="PK",s.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(n,r,s){var i=n("./GenericWorker"),a=n("../utils");function o(l){i.call(this,"ConvertWorker to "+l),this.destType=l}a.inherits(o,i),o.prototype.processChunk=function(l){this.push({data:a.transformTo(this.destType,l.data),meta:l.meta})},r.exports=o},{"../utils":32,"./GenericWorker":28}],25:[function(n,r,s){var i=n("./GenericWorker"),a=n("../crc32");function o(){i.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}n("../utils").inherits(o,i),o.prototype.processChunk=function(l){this.streamInfo.crc32=a(l.data,this.streamInfo.crc32||0),this.push(l)},r.exports=o},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(n,r,s){var i=n("../utils"),a=n("./GenericWorker");function o(l){a.call(this,"DataLengthProbe for "+l),this.propName=l,this.withStreamInfo(l,0)}i.inherits(o,a),o.prototype.processChunk=function(l){if(l){var c=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=c+l.data.length}a.prototype.processChunk.call(this,l)},r.exports=o},{"../utils":32,"./GenericWorker":28}],27:[function(n,r,s){var i=n("../utils"),a=n("./GenericWorker");function o(l){a.call(this,"DataWorker");var c=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,l.then(function(u){c.dataIsReady=!0,c.data=u,c.max=u&&u.length||0,c.type=i.getTypeOf(u),c.isPaused||c._tickAndRepeat()},function(u){c.error(u)})}i.inherits(o,a),o.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this.data=null},o.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,i.delay(this._tickAndRepeat,[],this)),!0)},o.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(i.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},o.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var l=null,c=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":l=this.data.substring(this.index,c);break;case"uint8array":l=this.data.subarray(this.index,c);break;case"array":case"nodebuffer":l=this.data.slice(this.index,c)}return this.index=c,this.push({data:l,meta:{percent:this.max?this.index/this.max*100:0}})},r.exports=o},{"../utils":32,"./GenericWorker":28}],28:[function(n,r,s){function i(a){this.name=a||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}i.prototype={push:function(a){this.emit("data",a)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(a){this.emit("error",a)}return!0},error:function(a){return!this.isFinished&&(this.isPaused?this.generatedError=a:(this.isFinished=!0,this.emit("error",a),this.previous&&this.previous.error(a),this.cleanUp()),!0)},on:function(a,o){return this._listeners[a].push(o),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(a,o){if(this._listeners[a])for(var l=0;l<this._listeners[a].length;l++)this._listeners[a][l].call(this,o)},pipe:function(a){return a.registerPrevious(this)},registerPrevious:function(a){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=a.streamInfo,this.mergeStreamInfo(),this.previous=a;var o=this;return a.on("data",function(l){o.processChunk(l)}),a.on("end",function(){o.end()}),a.on("error",function(l){o.error(l)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var a=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),a=!0),this.previous&&this.previous.resume(),!a},flush:function(){},processChunk:function(a){this.push(a)},withStreamInfo:function(a,o){return this.extraStreamInfo[a]=o,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var a in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,a)&&(this.streamInfo[a]=this.extraStreamInfo[a])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var a="Worker "+this.name;return this.previous?this.previous+" -> "+a:a}},r.exports=i},{}],29:[function(n,r,s){var i=n("../utils"),a=n("./ConvertWorker"),o=n("./GenericWorker"),l=n("../base64"),c=n("../support"),u=n("../external"),d=null;if(c.nodestream)try{d=n("../nodejs/NodejsStreamOutputAdapter")}catch{}function h(y,b){return new u.Promise(function(v,x){var w=[],_=y._internalType,k=y._outputType,C=y._mimeType;y.on("data",function(T,A){w.push(T),b&&b(A)}).on("error",function(T){w=[],x(T)}).on("end",function(){try{var T=function(A,N,I){switch(A){case"blob":return i.newBlob(i.transformTo("arraybuffer",N),I);case"base64":return l.encode(N);default:return i.transformTo(A,N)}}(k,function(A,N){var I,j=0,L=null,D=0;for(I=0;I<N.length;I++)D+=N[I].length;switch(A){case"string":return N.join("");case"array":return Array.prototype.concat.apply([],N);case"uint8array":for(L=new Uint8Array(D),I=0;I<N.length;I++)L.set(N[I],j),j+=N[I].length;return L;case"nodebuffer":return un.concat(N);default:throw new Error("concat : unsupported type '"+A+"'")}}(_,w),C);v(T)}catch(A){x(A)}w=[]}).resume()})}function m(y,b,v){var x=b;switch(b){case"blob":case"arraybuffer":x="uint8array";break;case"base64":x="string"}try{this._internalType=x,this._outputType=b,this._mimeType=v,i.checkSupport(x),this._worker=y.pipe(new a(x)),y.lock()}catch(w){this._worker=new o("error"),this._worker.error(w)}}m.prototype={accumulate:function(y){return h(this,y)},on:function(y,b){var v=this;return y==="data"?this._worker.on(y,function(x){b.call(v,x.data,x.meta)}):this._worker.on(y,function(){i.delay(b,arguments,v)}),this},resume:function(){return i.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(y){if(i.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new d(this,{objectMode:this._outputType!=="nodebuffer"},y)}},r.exports=m},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(n,r,s){if(s.base64=!0,s.array=!0,s.string=!0,s.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",s.nodebuffer=typeof un<"u",s.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")s.blob=!1;else{var i=new ArrayBuffer(0);try{s.blob=new Blob([i],{type:"application/zip"}).size===0}catch{try{var a=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);a.append(i),s.blob=a.getBlob("application/zip").size===0}catch{s.blob=!1}}}try{s.nodestream=!!n("readable-stream").Readable}catch{s.nodestream=!1}},{"readable-stream":16}],31:[function(n,r,s){for(var i=n("./utils"),a=n("./support"),o=n("./nodejsUtils"),l=n("./stream/GenericWorker"),c=new Array(256),u=0;u<256;u++)c[u]=252<=u?6:248<=u?5:240<=u?4:224<=u?3:192<=u?2:1;c[254]=c[254]=1;function d(){l.call(this,"utf-8 decode"),this.leftOver=null}function h(){l.call(this,"utf-8 encode")}s.utf8encode=function(m){return a.nodebuffer?o.newBufferFrom(m,"utf-8"):function(y){var b,v,x,w,_,k=y.length,C=0;for(w=0;w<k;w++)(64512&(v=y.charCodeAt(w)))==55296&&w+1<k&&(64512&(x=y.charCodeAt(w+1)))==56320&&(v=65536+(v-55296<<10)+(x-56320),w++),C+=v<128?1:v<2048?2:v<65536?3:4;for(b=a.uint8array?new Uint8Array(C):new Array(C),w=_=0;_<C;w++)(64512&(v=y.charCodeAt(w)))==55296&&w+1<k&&(64512&(x=y.charCodeAt(w+1)))==56320&&(v=65536+(v-55296<<10)+(x-56320),w++),v<128?b[_++]=v:(v<2048?b[_++]=192|v>>>6:(v<65536?b[_++]=224|v>>>12:(b[_++]=240|v>>>18,b[_++]=128|v>>>12&63),b[_++]=128|v>>>6&63),b[_++]=128|63&v);return b}(m)},s.utf8decode=function(m){return a.nodebuffer?i.transformTo("nodebuffer",m).toString("utf-8"):function(y){var b,v,x,w,_=y.length,k=new Array(2*_);for(b=v=0;b<_;)if((x=y[b++])<128)k[v++]=x;else if(4<(w=c[x]))k[v++]=65533,b+=w-1;else{for(x&=w===2?31:w===3?15:7;1<w&&b<_;)x=x<<6|63&y[b++],w--;1<w?k[v++]=65533:x<65536?k[v++]=x:(x-=65536,k[v++]=55296|x>>10&1023,k[v++]=56320|1023&x)}return k.length!==v&&(k.subarray?k=k.subarray(0,v):k.length=v),i.applyFromCharCode(k)}(m=i.transformTo(a.uint8array?"uint8array":"array",m))},i.inherits(d,l),d.prototype.processChunk=function(m){var y=i.transformTo(a.uint8array?"uint8array":"array",m.data);if(this.leftOver&&this.leftOver.length){if(a.uint8array){var b=y;(y=new Uint8Array(b.length+this.leftOver.length)).set(this.leftOver,0),y.set(b,this.leftOver.length)}else y=this.leftOver.concat(y);this.leftOver=null}var v=function(w,_){var k;for((_=_||w.length)>w.length&&(_=w.length),k=_-1;0<=k&&(192&w[k])==128;)k--;return k<0||k===0?_:k+c[w[k]]>_?k:_}(y),x=y;v!==y.length&&(a.uint8array?(x=y.subarray(0,v),this.leftOver=y.subarray(v,y.length)):(x=y.slice(0,v),this.leftOver=y.slice(v,y.length))),this.push({data:s.utf8decode(x),meta:m.meta})},d.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:s.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},s.Utf8DecodeWorker=d,i.inherits(h,l),h.prototype.processChunk=function(m){this.push({data:s.utf8encode(m.data),meta:m.meta})},s.Utf8EncodeWorker=h},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(n,r,s){var i=n("./support"),a=n("./base64"),o=n("./nodejsUtils"),l=n("./external");function c(b){return b}function u(b,v){for(var x=0;x<b.length;++x)v[x]=255&b.charCodeAt(x);return v}n("setimmediate"),s.newBlob=function(b,v){s.checkSupport("blob");try{return new Blob([b],{type:v})}catch{try{var x=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return x.append(b),x.getBlob(v)}catch{throw new Error("Bug : can't construct the Blob.")}}};var d={stringifyByChunk:function(b,v,x){var w=[],_=0,k=b.length;if(k<=x)return String.fromCharCode.apply(null,b);for(;_<k;)v==="array"||v==="nodebuffer"?w.push(String.fromCharCode.apply(null,b.slice(_,Math.min(_+x,k)))):w.push(String.fromCharCode.apply(null,b.subarray(_,Math.min(_+x,k)))),_+=x;return w.join("")},stringifyByChar:function(b){for(var v="",x=0;x<b.length;x++)v+=String.fromCharCode(b[x]);return v},applyCanBeUsed:{uint8array:function(){try{return i.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return i.nodebuffer&&String.fromCharCode.apply(null,o.allocBuffer(1)).length===1}catch{return!1}}()}};function h(b){var v=65536,x=s.getTypeOf(b),w=!0;if(x==="uint8array"?w=d.applyCanBeUsed.uint8array:x==="nodebuffer"&&(w=d.applyCanBeUsed.nodebuffer),w)for(;1<v;)try{return d.stringifyByChunk(b,x,v)}catch{v=Math.floor(v/2)}return d.stringifyByChar(b)}function m(b,v){for(var x=0;x<b.length;x++)v[x]=b[x];return v}s.applyFromCharCode=h;var y={};y.string={string:c,array:function(b){return u(b,new Array(b.length))},arraybuffer:function(b){return y.string.uint8array(b).buffer},uint8array:function(b){return u(b,new Uint8Array(b.length))},nodebuffer:function(b){return u(b,o.allocBuffer(b.length))}},y.array={string:h,array:c,arraybuffer:function(b){return new Uint8Array(b).buffer},uint8array:function(b){return new Uint8Array(b)},nodebuffer:function(b){return o.newBufferFrom(b)}},y.arraybuffer={string:function(b){return h(new Uint8Array(b))},array:function(b){return m(new Uint8Array(b),new Array(b.byteLength))},arraybuffer:c,uint8array:function(b){return new Uint8Array(b)},nodebuffer:function(b){return o.newBufferFrom(new Uint8Array(b))}},y.uint8array={string:h,array:function(b){return m(b,new Array(b.length))},arraybuffer:function(b){return b.buffer},uint8array:c,nodebuffer:function(b){return o.newBufferFrom(b)}},y.nodebuffer={string:h,array:function(b){return m(b,new Array(b.length))},arraybuffer:function(b){return y.nodebuffer.uint8array(b).buffer},uint8array:function(b){return m(b,new Uint8Array(b.length))},nodebuffer:c},s.transformTo=function(b,v){if(v=v||"",!b)return v;s.checkSupport(b);var x=s.getTypeOf(v);return y[x][b](v)},s.resolve=function(b){for(var v=b.split("/"),x=[],w=0;w<v.length;w++){var _=v[w];_==="."||_===""&&w!==0&&w!==v.length-1||(_===".."?x.pop():x.push(_))}return x.join("/")},s.getTypeOf=function(b){return typeof b=="string"?"string":Object.prototype.toString.call(b)==="[object Array]"?"array":i.nodebuffer&&o.isBuffer(b)?"nodebuffer":i.uint8array&&b instanceof Uint8Array?"uint8array":i.arraybuffer&&b instanceof ArrayBuffer?"arraybuffer":void 0},s.checkSupport=function(b){if(!i[b.toLowerCase()])throw new Error(b+" is not supported by this platform")},s.MAX_VALUE_16BITS=65535,s.MAX_VALUE_32BITS=-1,s.pretty=function(b){var v,x,w="";for(x=0;x<(b||"").length;x++)w+="\\x"+((v=b.charCodeAt(x))<16?"0":"")+v.toString(16).toUpperCase();return w},s.delay=function(b,v,x){setImmediate(function(){b.apply(x||null,v||[])})},s.inherits=function(b,v){function x(){}x.prototype=v.prototype,b.prototype=new x},s.extend=function(){var b,v,x={};for(b=0;b<arguments.length;b++)for(v in arguments[b])Object.prototype.hasOwnProperty.call(arguments[b],v)&&x[v]===void 0&&(x[v]=arguments[b][v]);return x},s.prepareContent=function(b,v,x,w,_){return l.Promise.resolve(v).then(function(k){return i.blob&&(k instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(k))!==-1)&&typeof FileReader<"u"?new l.Promise(function(C,T){var A=new FileReader;A.onload=function(N){C(N.target.result)},A.onerror=function(N){T(N.target.error)},A.readAsArrayBuffer(k)}):k}).then(function(k){var C=s.getTypeOf(k);return C?(C==="arraybuffer"?k=s.transformTo("uint8array",k):C==="string"&&(_?k=a.decode(k):x&&w!==!0&&(k=function(T){return u(T,i.uint8array?new Uint8Array(T.length):new Array(T.length))}(k))),k):l.Promise.reject(new Error("Can't read the data of '"+b+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(n,r,s){var i=n("./reader/readerFor"),a=n("./utils"),o=n("./signature"),l=n("./zipEntry"),c=n("./support");function u(d){this.files=[],this.loadOptions=d}u.prototype={checkSignature:function(d){if(!this.reader.readAndCheckSignature(d)){this.reader.index-=4;var h=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+a.pretty(h)+", expected "+a.pretty(d)+")")}},isSignature:function(d,h){var m=this.reader.index;this.reader.setIndex(d);var y=this.reader.readString(4)===h;return this.reader.setIndex(m),y},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var d=this.reader.readData(this.zipCommentLength),h=c.uint8array?"uint8array":"array",m=a.transformTo(h,d);this.zipComment=this.loadOptions.decodeFileName(m)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var d,h,m,y=this.zip64EndOfCentralSize-44;0<y;)d=this.reader.readInt(2),h=this.reader.readInt(4),m=this.reader.readData(h),this.zip64ExtensibleData[d]={id:d,length:h,value:m}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var d,h;for(d=0;d<this.files.length;d++)h=this.files[d],this.reader.setIndex(h.localHeaderOffset),this.checkSignature(o.LOCAL_FILE_HEADER),h.readLocalPart(this.reader),h.handleUTF8(),h.processAttributes()},readCentralDir:function(){var d;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(o.CENTRAL_FILE_HEADER);)(d=new l({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(d);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var d=this.reader.lastIndexOfSignature(o.CENTRAL_DIRECTORY_END);if(d<0)throw this.isSignature(0,o.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(d);var h=d;if(this.checkSignature(o.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===a.MAX_VALUE_16BITS||this.diskWithCentralDirStart===a.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===a.MAX_VALUE_16BITS||this.centralDirRecords===a.MAX_VALUE_16BITS||this.centralDirSize===a.MAX_VALUE_32BITS||this.centralDirOffset===a.MAX_VALUE_32BITS){if(this.zip64=!0,(d=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(d),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,o.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var m=this.centralDirOffset+this.centralDirSize;this.zip64&&(m+=20,m+=12+this.zip64EndOfCentralSize);var y=h-m;if(0<y)this.isSignature(h,o.CENTRAL_FILE_HEADER)||(this.reader.zero=y);else if(y<0)throw new Error("Corrupted zip: missing "+Math.abs(y)+" bytes.")},prepareReader:function(d){this.reader=i(d)},load:function(d){this.prepareReader(d),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},r.exports=u},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(n,r,s){var i=n("./reader/readerFor"),a=n("./utils"),o=n("./compressedObject"),l=n("./crc32"),c=n("./utf8"),u=n("./compressions"),d=n("./support");function h(m,y){this.options=m,this.loadOptions=y}h.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(m){var y,b;if(m.skip(22),this.fileNameLength=m.readInt(2),b=m.readInt(2),this.fileName=m.readData(this.fileNameLength),m.skip(b),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((y=function(v){for(var x in u)if(Object.prototype.hasOwnProperty.call(u,x)&&u[x].magic===v)return u[x];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+a.pretty(this.compressionMethod)+" unknown (inner file : "+a.transformTo("string",this.fileName)+")");this.decompressed=new o(this.compressedSize,this.uncompressedSize,this.crc32,y,m.readData(this.compressedSize))},readCentralPart:function(m){this.versionMadeBy=m.readInt(2),m.skip(2),this.bitFlag=m.readInt(2),this.compressionMethod=m.readString(2),this.date=m.readDate(),this.crc32=m.readInt(4),this.compressedSize=m.readInt(4),this.uncompressedSize=m.readInt(4);var y=m.readInt(2);if(this.extraFieldsLength=m.readInt(2),this.fileCommentLength=m.readInt(2),this.diskNumberStart=m.readInt(2),this.internalFileAttributes=m.readInt(2),this.externalFileAttributes=m.readInt(4),this.localHeaderOffset=m.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");m.skip(y),this.readExtraFields(m),this.parseZIP64ExtraField(m),this.fileComment=m.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var m=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),m==0&&(this.dosPermissions=63&this.externalFileAttributes),m==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var m=i(this.extraFields[1].value);this.uncompressedSize===a.MAX_VALUE_32BITS&&(this.uncompressedSize=m.readInt(8)),this.compressedSize===a.MAX_VALUE_32BITS&&(this.compressedSize=m.readInt(8)),this.localHeaderOffset===a.MAX_VALUE_32BITS&&(this.localHeaderOffset=m.readInt(8)),this.diskNumberStart===a.MAX_VALUE_32BITS&&(this.diskNumberStart=m.readInt(4))}},readExtraFields:function(m){var y,b,v,x=m.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});m.index+4<x;)y=m.readInt(2),b=m.readInt(2),v=m.readData(b),this.extraFields[y]={id:y,length:b,value:v};m.setIndex(x)},handleUTF8:function(){var m=d.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=c.utf8decode(this.fileName),this.fileCommentStr=c.utf8decode(this.fileComment);else{var y=this.findExtraFieldUnicodePath();if(y!==null)this.fileNameStr=y;else{var b=a.transformTo(m,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(b)}var v=this.findExtraFieldUnicodeComment();if(v!==null)this.fileCommentStr=v;else{var x=a.transformTo(m,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(x)}}},findExtraFieldUnicodePath:function(){var m=this.extraFields[28789];if(m){var y=i(m.value);return y.readInt(1)!==1||l(this.fileName)!==y.readInt(4)?null:c.utf8decode(y.readData(m.length-5))}return null},findExtraFieldUnicodeComment:function(){var m=this.extraFields[25461];if(m){var y=i(m.value);return y.readInt(1)!==1||l(this.fileComment)!==y.readInt(4)?null:c.utf8decode(y.readData(m.length-5))}return null}},r.exports=h},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(n,r,s){function i(y,b,v){this.name=y,this.dir=v.dir,this.date=v.date,this.comment=v.comment,this.unixPermissions=v.unixPermissions,this.dosPermissions=v.dosPermissions,this._data=b,this._dataBinary=v.binary,this.options={compression:v.compression,compressionOptions:v.compressionOptions}}var a=n("./stream/StreamHelper"),o=n("./stream/DataWorker"),l=n("./utf8"),c=n("./compressedObject"),u=n("./stream/GenericWorker");i.prototype={internalStream:function(y){var b=null,v="string";try{if(!y)throw new Error("No output type specified.");var x=(v=y.toLowerCase())==="string"||v==="text";v!=="binarystring"&&v!=="text"||(v="string"),b=this._decompressWorker();var w=!this._dataBinary;w&&!x&&(b=b.pipe(new l.Utf8EncodeWorker)),!w&&x&&(b=b.pipe(new l.Utf8DecodeWorker))}catch(_){(b=new u("error")).error(_)}return new a(b,v,"")},async:function(y,b){return this.internalStream(y).accumulate(b)},nodeStream:function(y,b){return this.internalStream(y||"nodebuffer").toNodejsStream(b)},_compressWorker:function(y,b){if(this._data instanceof c&&this._data.compression.magic===y.magic)return this._data.getCompressedWorker();var v=this._decompressWorker();return this._dataBinary||(v=v.pipe(new l.Utf8EncodeWorker)),c.createWorkerFrom(v,y,b)},_decompressWorker:function(){return this._data instanceof c?this._data.getContentWorker():this._data instanceof u?this._data:new o(this._data)}};for(var d=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],h=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},m=0;m<d.length;m++)i.prototype[d[m]]=h;r.exports=i},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(n,r,s){(function(i){var a,o,l=i.MutationObserver||i.WebKitMutationObserver;if(l){var c=0,u=new l(y),d=i.document.createTextNode("");u.observe(d,{characterData:!0}),a=function(){d.data=c=++c%2}}else if(i.setImmediate||i.MessageChannel===void 0)a="document"in i&&"onreadystatechange"in i.document.createElement("script")?function(){var b=i.document.createElement("script");b.onreadystatechange=function(){y(),b.onreadystatechange=null,b.parentNode.removeChild(b),b=null},i.document.documentElement.appendChild(b)}:function(){setTimeout(y,0)};else{var h=new i.MessageChannel;h.port1.onmessage=y,a=function(){h.port2.postMessage(0)}}var m=[];function y(){var b,v;o=!0;for(var x=m.length;x;){for(v=m,m=[],b=-1;++b<x;)v[b]();x=m.length}o=!1}r.exports=function(b){m.push(b)!==1||o||a()}}).call(this,typeof cm<"u"?cm:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(n,r,s){var i=n("immediate");function a(){}var o={},l=["REJECTED"],c=["FULFILLED"],u=["PENDING"];function d(x){if(typeof x!="function")throw new TypeError("resolver must be a function");this.state=u,this.queue=[],this.outcome=void 0,x!==a&&b(this,x)}function h(x,w,_){this.promise=x,typeof w=="function"&&(this.onFulfilled=w,this.callFulfilled=this.otherCallFulfilled),typeof _=="function"&&(this.onRejected=_,this.callRejected=this.otherCallRejected)}function m(x,w,_){i(function(){var k;try{k=w(_)}catch(C){return o.reject(x,C)}k===x?o.reject(x,new TypeError("Cannot resolve promise with itself")):o.resolve(x,k)})}function y(x){var w=x&&x.then;if(x&&(typeof x=="object"||typeof x=="function")&&typeof w=="function")return function(){w.apply(x,arguments)}}function b(x,w){var _=!1;function k(A){_||(_=!0,o.reject(x,A))}function C(A){_||(_=!0,o.resolve(x,A))}var T=v(function(){w(C,k)});T.status==="error"&&k(T.value)}function v(x,w){var _={};try{_.value=x(w),_.status="success"}catch(k){_.status="error",_.value=k}return _}(r.exports=d).prototype.finally=function(x){if(typeof x!="function")return this;var w=this.constructor;return this.then(function(_){return w.resolve(x()).then(function(){return _})},function(_){return w.resolve(x()).then(function(){throw _})})},d.prototype.catch=function(x){return this.then(null,x)},d.prototype.then=function(x,w){if(typeof x!="function"&&this.state===c||typeof w!="function"&&this.state===l)return this;var _=new this.constructor(a);return this.state!==u?m(_,this.state===c?x:w,this.outcome):this.queue.push(new h(_,x,w)),_},h.prototype.callFulfilled=function(x){o.resolve(this.promise,x)},h.prototype.otherCallFulfilled=function(x){m(this.promise,this.onFulfilled,x)},h.prototype.callRejected=function(x){o.reject(this.promise,x)},h.prototype.otherCallRejected=function(x){m(this.promise,this.onRejected,x)},o.resolve=function(x,w){var _=v(y,w);if(_.status==="error")return o.reject(x,_.value);var k=_.value;if(k)b(x,k);else{x.state=c,x.outcome=w;for(var C=-1,T=x.queue.length;++C<T;)x.queue[C].callFulfilled(w)}return x},o.reject=function(x,w){x.state=l,x.outcome=w;for(var _=-1,k=x.queue.length;++_<k;)x.queue[_].callRejected(w);return x},d.resolve=function(x){return x instanceof this?x:o.resolve(new this(a),x)},d.reject=function(x){var w=new this(a);return o.reject(w,x)},d.all=function(x){var w=this;if(Object.prototype.toString.call(x)!=="[object Array]")return this.reject(new TypeError("must be an array"));var _=x.length,k=!1;if(!_)return this.resolve([]);for(var C=new Array(_),T=0,A=-1,N=new this(a);++A<_;)I(x[A],A);return N;function I(j,L){w.resolve(j).then(function(D){C[L]=D,++T!==_||k||(k=!0,o.resolve(N,C))},function(D){k||(k=!0,o.reject(N,D))})}},d.race=function(x){var w=this;if(Object.prototype.toString.call(x)!=="[object Array]")return this.reject(new TypeError("must be an array"));var _=x.length,k=!1;if(!_)return this.resolve([]);for(var C=-1,T=new this(a);++C<_;)A=x[C],w.resolve(A).then(function(N){k||(k=!0,o.resolve(T,N))},function(N){k||(k=!0,o.reject(T,N))});var A;return T}},{immediate:36}],38:[function(n,r,s){var i={};(0,n("./lib/utils/common").assign)(i,n("./lib/deflate"),n("./lib/inflate"),n("./lib/zlib/constants")),r.exports=i},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(n,r,s){var i=n("./zlib/deflate"),a=n("./utils/common"),o=n("./utils/strings"),l=n("./zlib/messages"),c=n("./zlib/zstream"),u=Object.prototype.toString,d=0,h=-1,m=0,y=8;function b(x){if(!(this instanceof b))return new b(x);this.options=a.assign({level:h,method:y,chunkSize:16384,windowBits:15,memLevel:8,strategy:m,to:""},x||{});var w=this.options;w.raw&&0<w.windowBits?w.windowBits=-w.windowBits:w.gzip&&0<w.windowBits&&w.windowBits<16&&(w.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new c,this.strm.avail_out=0;var _=i.deflateInit2(this.strm,w.level,w.method,w.windowBits,w.memLevel,w.strategy);if(_!==d)throw new Error(l[_]);if(w.header&&i.deflateSetHeader(this.strm,w.header),w.dictionary){var k;if(k=typeof w.dictionary=="string"?o.string2buf(w.dictionary):u.call(w.dictionary)==="[object ArrayBuffer]"?new Uint8Array(w.dictionary):w.dictionary,(_=i.deflateSetDictionary(this.strm,k))!==d)throw new Error(l[_]);this._dict_set=!0}}function v(x,w){var _=new b(w);if(_.push(x,!0),_.err)throw _.msg||l[_.err];return _.result}b.prototype.push=function(x,w){var _,k,C=this.strm,T=this.options.chunkSize;if(this.ended)return!1;k=w===~~w?w:w===!0?4:0,typeof x=="string"?C.input=o.string2buf(x):u.call(x)==="[object ArrayBuffer]"?C.input=new Uint8Array(x):C.input=x,C.next_in=0,C.avail_in=C.input.length;do{if(C.avail_out===0&&(C.output=new a.Buf8(T),C.next_out=0,C.avail_out=T),(_=i.deflate(C,k))!==1&&_!==d)return this.onEnd(_),!(this.ended=!0);C.avail_out!==0&&(C.avail_in!==0||k!==4&&k!==2)||(this.options.to==="string"?this.onData(o.buf2binstring(a.shrinkBuf(C.output,C.next_out))):this.onData(a.shrinkBuf(C.output,C.next_out)))}while((0<C.avail_in||C.avail_out===0)&&_!==1);return k===4?(_=i.deflateEnd(this.strm),this.onEnd(_),this.ended=!0,_===d):k!==2||(this.onEnd(d),!(C.avail_out=0))},b.prototype.onData=function(x){this.chunks.push(x)},b.prototype.onEnd=function(x){x===d&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=x,this.msg=this.strm.msg},s.Deflate=b,s.deflate=v,s.deflateRaw=function(x,w){return(w=w||{}).raw=!0,v(x,w)},s.gzip=function(x,w){return(w=w||{}).gzip=!0,v(x,w)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(n,r,s){var i=n("./zlib/inflate"),a=n("./utils/common"),o=n("./utils/strings"),l=n("./zlib/constants"),c=n("./zlib/messages"),u=n("./zlib/zstream"),d=n("./zlib/gzheader"),h=Object.prototype.toString;function m(b){if(!(this instanceof m))return new m(b);this.options=a.assign({chunkSize:16384,windowBits:0,to:""},b||{});var v=this.options;v.raw&&0<=v.windowBits&&v.windowBits<16&&(v.windowBits=-v.windowBits,v.windowBits===0&&(v.windowBits=-15)),!(0<=v.windowBits&&v.windowBits<16)||b&&b.windowBits||(v.windowBits+=32),15<v.windowBits&&v.windowBits<48&&(15&v.windowBits)==0&&(v.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new u,this.strm.avail_out=0;var x=i.inflateInit2(this.strm,v.windowBits);if(x!==l.Z_OK)throw new Error(c[x]);this.header=new d,i.inflateGetHeader(this.strm,this.header)}function y(b,v){var x=new m(v);if(x.push(b,!0),x.err)throw x.msg||c[x.err];return x.result}m.prototype.push=function(b,v){var x,w,_,k,C,T,A=this.strm,N=this.options.chunkSize,I=this.options.dictionary,j=!1;if(this.ended)return!1;w=v===~~v?v:v===!0?l.Z_FINISH:l.Z_NO_FLUSH,typeof b=="string"?A.input=o.binstring2buf(b):h.call(b)==="[object ArrayBuffer]"?A.input=new Uint8Array(b):A.input=b,A.next_in=0,A.avail_in=A.input.length;do{if(A.avail_out===0&&(A.output=new a.Buf8(N),A.next_out=0,A.avail_out=N),(x=i.inflate(A,l.Z_NO_FLUSH))===l.Z_NEED_DICT&&I&&(T=typeof I=="string"?o.string2buf(I):h.call(I)==="[object ArrayBuffer]"?new Uint8Array(I):I,x=i.inflateSetDictionary(this.strm,T)),x===l.Z_BUF_ERROR&&j===!0&&(x=l.Z_OK,j=!1),x!==l.Z_STREAM_END&&x!==l.Z_OK)return this.onEnd(x),!(this.ended=!0);A.next_out&&(A.avail_out!==0&&x!==l.Z_STREAM_END&&(A.avail_in!==0||w!==l.Z_FINISH&&w!==l.Z_SYNC_FLUSH)||(this.options.to==="string"?(_=o.utf8border(A.output,A.next_out),k=A.next_out-_,C=o.buf2string(A.output,_),A.next_out=k,A.avail_out=N-k,k&&a.arraySet(A.output,A.output,_,k,0),this.onData(C)):this.onData(a.shrinkBuf(A.output,A.next_out)))),A.avail_in===0&&A.avail_out===0&&(j=!0)}while((0<A.avail_in||A.avail_out===0)&&x!==l.Z_STREAM_END);return x===l.Z_STREAM_END&&(w=l.Z_FINISH),w===l.Z_FINISH?(x=i.inflateEnd(this.strm),this.onEnd(x),this.ended=!0,x===l.Z_OK):w!==l.Z_SYNC_FLUSH||(this.onEnd(l.Z_OK),!(A.avail_out=0))},m.prototype.onData=function(b){this.chunks.push(b)},m.prototype.onEnd=function(b){b===l.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=b,this.msg=this.strm.msg},s.Inflate=m,s.inflate=y,s.inflateRaw=function(b,v){return(v=v||{}).raw=!0,y(b,v)},s.ungzip=y},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(n,r,s){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";s.assign=function(l){for(var c=Array.prototype.slice.call(arguments,1);c.length;){var u=c.shift();if(u){if(typeof u!="object")throw new TypeError(u+"must be non-object");for(var d in u)u.hasOwnProperty(d)&&(l[d]=u[d])}}return l},s.shrinkBuf=function(l,c){return l.length===c?l:l.subarray?l.subarray(0,c):(l.length=c,l)};var a={arraySet:function(l,c,u,d,h){if(c.subarray&&l.subarray)l.set(c.subarray(u,u+d),h);else for(var m=0;m<d;m++)l[h+m]=c[u+m]},flattenChunks:function(l){var c,u,d,h,m,y;for(c=d=0,u=l.length;c<u;c++)d+=l[c].length;for(y=new Uint8Array(d),c=h=0,u=l.length;c<u;c++)m=l[c],y.set(m,h),h+=m.length;return y}},o={arraySet:function(l,c,u,d,h){for(var m=0;m<d;m++)l[h+m]=c[u+m]},flattenChunks:function(l){return[].concat.apply([],l)}};s.setTyped=function(l){l?(s.Buf8=Uint8Array,s.Buf16=Uint16Array,s.Buf32=Int32Array,s.assign(s,a)):(s.Buf8=Array,s.Buf16=Array,s.Buf32=Array,s.assign(s,o))},s.setTyped(i)},{}],42:[function(n,r,s){var i=n("./common"),a=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch{a=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{o=!1}for(var l=new i.Buf8(256),c=0;c<256;c++)l[c]=252<=c?6:248<=c?5:240<=c?4:224<=c?3:192<=c?2:1;function u(d,h){if(h<65537&&(d.subarray&&o||!d.subarray&&a))return String.fromCharCode.apply(null,i.shrinkBuf(d,h));for(var m="",y=0;y<h;y++)m+=String.fromCharCode(d[y]);return m}l[254]=l[254]=1,s.string2buf=function(d){var h,m,y,b,v,x=d.length,w=0;for(b=0;b<x;b++)(64512&(m=d.charCodeAt(b)))==55296&&b+1<x&&(64512&(y=d.charCodeAt(b+1)))==56320&&(m=65536+(m-55296<<10)+(y-56320),b++),w+=m<128?1:m<2048?2:m<65536?3:4;for(h=new i.Buf8(w),b=v=0;v<w;b++)(64512&(m=d.charCodeAt(b)))==55296&&b+1<x&&(64512&(y=d.charCodeAt(b+1)))==56320&&(m=65536+(m-55296<<10)+(y-56320),b++),m<128?h[v++]=m:(m<2048?h[v++]=192|m>>>6:(m<65536?h[v++]=224|m>>>12:(h[v++]=240|m>>>18,h[v++]=128|m>>>12&63),h[v++]=128|m>>>6&63),h[v++]=128|63&m);return h},s.buf2binstring=function(d){return u(d,d.length)},s.binstring2buf=function(d){for(var h=new i.Buf8(d.length),m=0,y=h.length;m<y;m++)h[m]=d.charCodeAt(m);return h},s.buf2string=function(d,h){var m,y,b,v,x=h||d.length,w=new Array(2*x);for(m=y=0;m<x;)if((b=d[m++])<128)w[y++]=b;else if(4<(v=l[b]))w[y++]=65533,m+=v-1;else{for(b&=v===2?31:v===3?15:7;1<v&&m<x;)b=b<<6|63&d[m++],v--;1<v?w[y++]=65533:b<65536?w[y++]=b:(b-=65536,w[y++]=55296|b>>10&1023,w[y++]=56320|1023&b)}return u(w,y)},s.utf8border=function(d,h){var m;for((h=h||d.length)>d.length&&(h=d.length),m=h-1;0<=m&&(192&d[m])==128;)m--;return m<0||m===0?h:m+l[d[m]]>h?m:h}},{"./common":41}],43:[function(n,r,s){r.exports=function(i,a,o,l){for(var c=65535&i|0,u=i>>>16&65535|0,d=0;o!==0;){for(o-=d=2e3<o?2e3:o;u=u+(c=c+a[l++]|0)|0,--d;);c%=65521,u%=65521}return c|u<<16|0}},{}],44:[function(n,r,s){r.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(n,r,s){var i=function(){for(var a,o=[],l=0;l<256;l++){a=l;for(var c=0;c<8;c++)a=1&a?3988292384^a>>>1:a>>>1;o[l]=a}return o}();r.exports=function(a,o,l,c){var u=i,d=c+l;a^=-1;for(var h=c;h<d;h++)a=a>>>8^u[255&(a^o[h])];return-1^a}},{}],46:[function(n,r,s){var i,a=n("../utils/common"),o=n("./trees"),l=n("./adler32"),c=n("./crc32"),u=n("./messages"),d=0,h=4,m=0,y=-2,b=-1,v=4,x=2,w=8,_=9,k=286,C=30,T=19,A=2*k+1,N=15,I=3,j=258,L=j+I+1,D=42,H=113,O=1,K=2,U=3,W=4;function B(Y,ye){return Y.msg=u[ye],ye}function ne(Y){return(Y<<1)-(4<Y?9:0)}function V(Y){for(var ye=Y.length;0<=--ye;)Y[ye]=0}function Q(Y){var ye=Y.state,Me=ye.pending;Me>Y.avail_out&&(Me=Y.avail_out),Me!==0&&(a.arraySet(Y.output,ye.pending_buf,ye.pending_out,Me,Y.next_out),Y.next_out+=Me,ye.pending_out+=Me,Y.total_out+=Me,Y.avail_out-=Me,ye.pending-=Me,ye.pending===0&&(ye.pending_out=0))}function ee(Y,ye){o._tr_flush_block(Y,0<=Y.block_start?Y.block_start:-1,Y.strstart-Y.block_start,ye),Y.block_start=Y.strstart,Q(Y.strm)}function re(Y,ye){Y.pending_buf[Y.pending++]=ye}function de(Y,ye){Y.pending_buf[Y.pending++]=ye>>>8&255,Y.pending_buf[Y.pending++]=255&ye}function me(Y,ye){var Me,ue,oe=Y.max_chain_length,se=Y.strstart,Ie=Y.prev_length,Be=Y.nice_match,Re=Y.strstart>Y.w_size-L?Y.strstart-(Y.w_size-L):0,ct=Y.window,At=Y.w_mask,ut=Y.prev,Pt=Y.strstart+j,Ut=ct[se+Ie-1],Ft=ct[se+Ie];Y.prev_length>=Y.good_match&&(oe>>=2),Be>Y.lookahead&&(Be=Y.lookahead);do if(ct[(Me=ye)+Ie]===Ft&&ct[Me+Ie-1]===Ut&&ct[Me]===ct[se]&&ct[++Me]===ct[se+1]){se+=2,Me++;do;while(ct[++se]===ct[++Me]&&ct[++se]===ct[++Me]&&ct[++se]===ct[++Me]&&ct[++se]===ct[++Me]&&ct[++se]===ct[++Me]&&ct[++se]===ct[++Me]&&ct[++se]===ct[++Me]&&ct[++se]===ct[++Me]&&se<Pt);if(ue=j-(Pt-se),se=Pt-j,Ie<ue){if(Y.match_start=ye,Be<=(Ie=ue))break;Ut=ct[se+Ie-1],Ft=ct[se+Ie]}}while((ye=ut[ye&At])>Re&&--oe!=0);return Ie<=Y.lookahead?Ie:Y.lookahead}function De(Y){var ye,Me,ue,oe,se,Ie,Be,Re,ct,At,ut=Y.w_size;do{if(oe=Y.window_size-Y.lookahead-Y.strstart,Y.strstart>=ut+(ut-L)){for(a.arraySet(Y.window,Y.window,ut,ut,0),Y.match_start-=ut,Y.strstart-=ut,Y.block_start-=ut,ye=Me=Y.hash_size;ue=Y.head[--ye],Y.head[ye]=ut<=ue?ue-ut:0,--Me;);for(ye=Me=ut;ue=Y.prev[--ye],Y.prev[ye]=ut<=ue?ue-ut:0,--Me;);oe+=ut}if(Y.strm.avail_in===0)break;if(Ie=Y.strm,Be=Y.window,Re=Y.strstart+Y.lookahead,ct=oe,At=void 0,At=Ie.avail_in,ct<At&&(At=ct),Me=At===0?0:(Ie.avail_in-=At,a.arraySet(Be,Ie.input,Ie.next_in,At,Re),Ie.state.wrap===1?Ie.adler=l(Ie.adler,Be,At,Re):Ie.state.wrap===2&&(Ie.adler=c(Ie.adler,Be,At,Re)),Ie.next_in+=At,Ie.total_in+=At,At),Y.lookahead+=Me,Y.lookahead+Y.insert>=I)for(se=Y.strstart-Y.insert,Y.ins_h=Y.window[se],Y.ins_h=(Y.ins_h<<Y.hash_shift^Y.window[se+1])&Y.hash_mask;Y.insert&&(Y.ins_h=(Y.ins_h<<Y.hash_shift^Y.window[se+I-1])&Y.hash_mask,Y.prev[se&Y.w_mask]=Y.head[Y.ins_h],Y.head[Y.ins_h]=se,se++,Y.insert--,!(Y.lookahead+Y.insert<I)););}while(Y.lookahead<L&&Y.strm.avail_in!==0)}function je(Y,ye){for(var Me,ue;;){if(Y.lookahead<L){if(De(Y),Y.lookahead<L&&ye===d)return O;if(Y.lookahead===0)break}if(Me=0,Y.lookahead>=I&&(Y.ins_h=(Y.ins_h<<Y.hash_shift^Y.window[Y.strstart+I-1])&Y.hash_mask,Me=Y.prev[Y.strstart&Y.w_mask]=Y.head[Y.ins_h],Y.head[Y.ins_h]=Y.strstart),Me!==0&&Y.strstart-Me<=Y.w_size-L&&(Y.match_length=me(Y,Me)),Y.match_length>=I)if(ue=o._tr_tally(Y,Y.strstart-Y.match_start,Y.match_length-I),Y.lookahead-=Y.match_length,Y.match_length<=Y.max_lazy_match&&Y.lookahead>=I){for(Y.match_length--;Y.strstart++,Y.ins_h=(Y.ins_h<<Y.hash_shift^Y.window[Y.strstart+I-1])&Y.hash_mask,Me=Y.prev[Y.strstart&Y.w_mask]=Y.head[Y.ins_h],Y.head[Y.ins_h]=Y.strstart,--Y.match_length!=0;);Y.strstart++}else Y.strstart+=Y.match_length,Y.match_length=0,Y.ins_h=Y.window[Y.strstart],Y.ins_h=(Y.ins_h<<Y.hash_shift^Y.window[Y.strstart+1])&Y.hash_mask;else ue=o._tr_tally(Y,0,Y.window[Y.strstart]),Y.lookahead--,Y.strstart++;if(ue&&(ee(Y,!1),Y.strm.avail_out===0))return O}return Y.insert=Y.strstart<I-1?Y.strstart:I-1,ye===h?(ee(Y,!0),Y.strm.avail_out===0?U:W):Y.last_lit&&(ee(Y,!1),Y.strm.avail_out===0)?O:K}function Te(Y,ye){for(var Me,ue,oe;;){if(Y.lookahead<L){if(De(Y),Y.lookahead<L&&ye===d)return O;if(Y.lookahead===0)break}if(Me=0,Y.lookahead>=I&&(Y.ins_h=(Y.ins_h<<Y.hash_shift^Y.window[Y.strstart+I-1])&Y.hash_mask,Me=Y.prev[Y.strstart&Y.w_mask]=Y.head[Y.ins_h],Y.head[Y.ins_h]=Y.strstart),Y.prev_length=Y.match_length,Y.prev_match=Y.match_start,Y.match_length=I-1,Me!==0&&Y.prev_length<Y.max_lazy_match&&Y.strstart-Me<=Y.w_size-L&&(Y.match_length=me(Y,Me),Y.match_length<=5&&(Y.strategy===1||Y.match_length===I&&4096<Y.strstart-Y.match_start)&&(Y.match_length=I-1)),Y.prev_length>=I&&Y.match_length<=Y.prev_length){for(oe=Y.strstart+Y.lookahead-I,ue=o._tr_tally(Y,Y.strstart-1-Y.prev_match,Y.prev_length-I),Y.lookahead-=Y.prev_length-1,Y.prev_length-=2;++Y.strstart<=oe&&(Y.ins_h=(Y.ins_h<<Y.hash_shift^Y.window[Y.strstart+I-1])&Y.hash_mask,Me=Y.prev[Y.strstart&Y.w_mask]=Y.head[Y.ins_h],Y.head[Y.ins_h]=Y.strstart),--Y.prev_length!=0;);if(Y.match_available=0,Y.match_length=I-1,Y.strstart++,ue&&(ee(Y,!1),Y.strm.avail_out===0))return O}else if(Y.match_available){if((ue=o._tr_tally(Y,0,Y.window[Y.strstart-1]))&&ee(Y,!1),Y.strstart++,Y.lookahead--,Y.strm.avail_out===0)return O}else Y.match_available=1,Y.strstart++,Y.lookahead--}return Y.match_available&&(ue=o._tr_tally(Y,0,Y.window[Y.strstart-1]),Y.match_available=0),Y.insert=Y.strstart<I-1?Y.strstart:I-1,ye===h?(ee(Y,!0),Y.strm.avail_out===0?U:W):Y.last_lit&&(ee(Y,!1),Y.strm.avail_out===0)?O:K}function _e(Y,ye,Me,ue,oe){this.good_length=Y,this.max_lazy=ye,this.nice_length=Me,this.max_chain=ue,this.func=oe}function Ue(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=w,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new a.Buf16(2*A),this.dyn_dtree=new a.Buf16(2*(2*C+1)),this.bl_tree=new a.Buf16(2*(2*T+1)),V(this.dyn_ltree),V(this.dyn_dtree),V(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new a.Buf16(N+1),this.heap=new a.Buf16(2*k+1),V(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new a.Buf16(2*k+1),V(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Qe(Y){var ye;return Y&&Y.state?(Y.total_in=Y.total_out=0,Y.data_type=x,(ye=Y.state).pending=0,ye.pending_out=0,ye.wrap<0&&(ye.wrap=-ye.wrap),ye.status=ye.wrap?D:H,Y.adler=ye.wrap===2?0:1,ye.last_flush=d,o._tr_init(ye),m):B(Y,y)}function We(Y){var ye=Qe(Y);return ye===m&&function(Me){Me.window_size=2*Me.w_size,V(Me.head),Me.max_lazy_match=i[Me.level].max_lazy,Me.good_match=i[Me.level].good_length,Me.nice_match=i[Me.level].nice_length,Me.max_chain_length=i[Me.level].max_chain,Me.strstart=0,Me.block_start=0,Me.lookahead=0,Me.insert=0,Me.match_length=Me.prev_length=I-1,Me.match_available=0,Me.ins_h=0}(Y.state),ye}function Pe(Y,ye,Me,ue,oe,se){if(!Y)return y;var Ie=1;if(ye===b&&(ye=6),ue<0?(Ie=0,ue=-ue):15<ue&&(Ie=2,ue-=16),oe<1||_<oe||Me!==w||ue<8||15<ue||ye<0||9<ye||se<0||v<se)return B(Y,y);ue===8&&(ue=9);var Be=new Ue;return(Y.state=Be).strm=Y,Be.wrap=Ie,Be.gzhead=null,Be.w_bits=ue,Be.w_size=1<<Be.w_bits,Be.w_mask=Be.w_size-1,Be.hash_bits=oe+7,Be.hash_size=1<<Be.hash_bits,Be.hash_mask=Be.hash_size-1,Be.hash_shift=~~((Be.hash_bits+I-1)/I),Be.window=new a.Buf8(2*Be.w_size),Be.head=new a.Buf16(Be.hash_size),Be.prev=new a.Buf16(Be.w_size),Be.lit_bufsize=1<<oe+6,Be.pending_buf_size=4*Be.lit_bufsize,Be.pending_buf=new a.Buf8(Be.pending_buf_size),Be.d_buf=1*Be.lit_bufsize,Be.l_buf=3*Be.lit_bufsize,Be.level=ye,Be.strategy=se,Be.method=Me,We(Y)}i=[new _e(0,0,0,0,function(Y,ye){var Me=65535;for(Me>Y.pending_buf_size-5&&(Me=Y.pending_buf_size-5);;){if(Y.lookahead<=1){if(De(Y),Y.lookahead===0&&ye===d)return O;if(Y.lookahead===0)break}Y.strstart+=Y.lookahead,Y.lookahead=0;var ue=Y.block_start+Me;if((Y.strstart===0||Y.strstart>=ue)&&(Y.lookahead=Y.strstart-ue,Y.strstart=ue,ee(Y,!1),Y.strm.avail_out===0)||Y.strstart-Y.block_start>=Y.w_size-L&&(ee(Y,!1),Y.strm.avail_out===0))return O}return Y.insert=0,ye===h?(ee(Y,!0),Y.strm.avail_out===0?U:W):(Y.strstart>Y.block_start&&(ee(Y,!1),Y.strm.avail_out),O)}),new _e(4,4,8,4,je),new _e(4,5,16,8,je),new _e(4,6,32,32,je),new _e(4,4,16,16,Te),new _e(8,16,32,32,Te),new _e(8,16,128,128,Te),new _e(8,32,128,256,Te),new _e(32,128,258,1024,Te),new _e(32,258,258,4096,Te)],s.deflateInit=function(Y,ye){return Pe(Y,ye,w,15,8,0)},s.deflateInit2=Pe,s.deflateReset=We,s.deflateResetKeep=Qe,s.deflateSetHeader=function(Y,ye){return Y&&Y.state?Y.state.wrap!==2?y:(Y.state.gzhead=ye,m):y},s.deflate=function(Y,ye){var Me,ue,oe,se;if(!Y||!Y.state||5<ye||ye<0)return Y?B(Y,y):y;if(ue=Y.state,!Y.output||!Y.input&&Y.avail_in!==0||ue.status===666&&ye!==h)return B(Y,Y.avail_out===0?-5:y);if(ue.strm=Y,Me=ue.last_flush,ue.last_flush=ye,ue.status===D)if(ue.wrap===2)Y.adler=0,re(ue,31),re(ue,139),re(ue,8),ue.gzhead?(re(ue,(ue.gzhead.text?1:0)+(ue.gzhead.hcrc?2:0)+(ue.gzhead.extra?4:0)+(ue.gzhead.name?8:0)+(ue.gzhead.comment?16:0)),re(ue,255&ue.gzhead.time),re(ue,ue.gzhead.time>>8&255),re(ue,ue.gzhead.time>>16&255),re(ue,ue.gzhead.time>>24&255),re(ue,ue.level===9?2:2<=ue.strategy||ue.level<2?4:0),re(ue,255&ue.gzhead.os),ue.gzhead.extra&&ue.gzhead.extra.length&&(re(ue,255&ue.gzhead.extra.length),re(ue,ue.gzhead.extra.length>>8&255)),ue.gzhead.hcrc&&(Y.adler=c(Y.adler,ue.pending_buf,ue.pending,0)),ue.gzindex=0,ue.status=69):(re(ue,0),re(ue,0),re(ue,0),re(ue,0),re(ue,0),re(ue,ue.level===9?2:2<=ue.strategy||ue.level<2?4:0),re(ue,3),ue.status=H);else{var Ie=w+(ue.w_bits-8<<4)<<8;Ie|=(2<=ue.strategy||ue.level<2?0:ue.level<6?1:ue.level===6?2:3)<<6,ue.strstart!==0&&(Ie|=32),Ie+=31-Ie%31,ue.status=H,de(ue,Ie),ue.strstart!==0&&(de(ue,Y.adler>>>16),de(ue,65535&Y.adler)),Y.adler=1}if(ue.status===69)if(ue.gzhead.extra){for(oe=ue.pending;ue.gzindex<(65535&ue.gzhead.extra.length)&&(ue.pending!==ue.pending_buf_size||(ue.gzhead.hcrc&&ue.pending>oe&&(Y.adler=c(Y.adler,ue.pending_buf,ue.pending-oe,oe)),Q(Y),oe=ue.pending,ue.pending!==ue.pending_buf_size));)re(ue,255&ue.gzhead.extra[ue.gzindex]),ue.gzindex++;ue.gzhead.hcrc&&ue.pending>oe&&(Y.adler=c(Y.adler,ue.pending_buf,ue.pending-oe,oe)),ue.gzindex===ue.gzhead.extra.length&&(ue.gzindex=0,ue.status=73)}else ue.status=73;if(ue.status===73)if(ue.gzhead.name){oe=ue.pending;do{if(ue.pending===ue.pending_buf_size&&(ue.gzhead.hcrc&&ue.pending>oe&&(Y.adler=c(Y.adler,ue.pending_buf,ue.pending-oe,oe)),Q(Y),oe=ue.pending,ue.pending===ue.pending_buf_size)){se=1;break}se=ue.gzindex<ue.gzhead.name.length?255&ue.gzhead.name.charCodeAt(ue.gzindex++):0,re(ue,se)}while(se!==0);ue.gzhead.hcrc&&ue.pending>oe&&(Y.adler=c(Y.adler,ue.pending_buf,ue.pending-oe,oe)),se===0&&(ue.gzindex=0,ue.status=91)}else ue.status=91;if(ue.status===91)if(ue.gzhead.comment){oe=ue.pending;do{if(ue.pending===ue.pending_buf_size&&(ue.gzhead.hcrc&&ue.pending>oe&&(Y.adler=c(Y.adler,ue.pending_buf,ue.pending-oe,oe)),Q(Y),oe=ue.pending,ue.pending===ue.pending_buf_size)){se=1;break}se=ue.gzindex<ue.gzhead.comment.length?255&ue.gzhead.comment.charCodeAt(ue.gzindex++):0,re(ue,se)}while(se!==0);ue.gzhead.hcrc&&ue.pending>oe&&(Y.adler=c(Y.adler,ue.pending_buf,ue.pending-oe,oe)),se===0&&(ue.status=103)}else ue.status=103;if(ue.status===103&&(ue.gzhead.hcrc?(ue.pending+2>ue.pending_buf_size&&Q(Y),ue.pending+2<=ue.pending_buf_size&&(re(ue,255&Y.adler),re(ue,Y.adler>>8&255),Y.adler=0,ue.status=H)):ue.status=H),ue.pending!==0){if(Q(Y),Y.avail_out===0)return ue.last_flush=-1,m}else if(Y.avail_in===0&&ne(ye)<=ne(Me)&&ye!==h)return B(Y,-5);if(ue.status===666&&Y.avail_in!==0)return B(Y,-5);if(Y.avail_in!==0||ue.lookahead!==0||ye!==d&&ue.status!==666){var Be=ue.strategy===2?function(Re,ct){for(var At;;){if(Re.lookahead===0&&(De(Re),Re.lookahead===0)){if(ct===d)return O;break}if(Re.match_length=0,At=o._tr_tally(Re,0,Re.window[Re.strstart]),Re.lookahead--,Re.strstart++,At&&(ee(Re,!1),Re.strm.avail_out===0))return O}return Re.insert=0,ct===h?(ee(Re,!0),Re.strm.avail_out===0?U:W):Re.last_lit&&(ee(Re,!1),Re.strm.avail_out===0)?O:K}(ue,ye):ue.strategy===3?function(Re,ct){for(var At,ut,Pt,Ut,Ft=Re.window;;){if(Re.lookahead<=j){if(De(Re),Re.lookahead<=j&&ct===d)return O;if(Re.lookahead===0)break}if(Re.match_length=0,Re.lookahead>=I&&0<Re.strstart&&(ut=Ft[Pt=Re.strstart-1])===Ft[++Pt]&&ut===Ft[++Pt]&&ut===Ft[++Pt]){Ut=Re.strstart+j;do;while(ut===Ft[++Pt]&&ut===Ft[++Pt]&&ut===Ft[++Pt]&&ut===Ft[++Pt]&&ut===Ft[++Pt]&&ut===Ft[++Pt]&&ut===Ft[++Pt]&&ut===Ft[++Pt]&&Pt<Ut);Re.match_length=j-(Ut-Pt),Re.match_length>Re.lookahead&&(Re.match_length=Re.lookahead)}if(Re.match_length>=I?(At=o._tr_tally(Re,1,Re.match_length-I),Re.lookahead-=Re.match_length,Re.strstart+=Re.match_length,Re.match_length=0):(At=o._tr_tally(Re,0,Re.window[Re.strstart]),Re.lookahead--,Re.strstart++),At&&(ee(Re,!1),Re.strm.avail_out===0))return O}return Re.insert=0,ct===h?(ee(Re,!0),Re.strm.avail_out===0?U:W):Re.last_lit&&(ee(Re,!1),Re.strm.avail_out===0)?O:K}(ue,ye):i[ue.level].func(ue,ye);if(Be!==U&&Be!==W||(ue.status=666),Be===O||Be===U)return Y.avail_out===0&&(ue.last_flush=-1),m;if(Be===K&&(ye===1?o._tr_align(ue):ye!==5&&(o._tr_stored_block(ue,0,0,!1),ye===3&&(V(ue.head),ue.lookahead===0&&(ue.strstart=0,ue.block_start=0,ue.insert=0))),Q(Y),Y.avail_out===0))return ue.last_flush=-1,m}return ye!==h?m:ue.wrap<=0?1:(ue.wrap===2?(re(ue,255&Y.adler),re(ue,Y.adler>>8&255),re(ue,Y.adler>>16&255),re(ue,Y.adler>>24&255),re(ue,255&Y.total_in),re(ue,Y.total_in>>8&255),re(ue,Y.total_in>>16&255),re(ue,Y.total_in>>24&255)):(de(ue,Y.adler>>>16),de(ue,65535&Y.adler)),Q(Y),0<ue.wrap&&(ue.wrap=-ue.wrap),ue.pending!==0?m:1)},s.deflateEnd=function(Y){var ye;return Y&&Y.state?(ye=Y.state.status)!==D&&ye!==69&&ye!==73&&ye!==91&&ye!==103&&ye!==H&&ye!==666?B(Y,y):(Y.state=null,ye===H?B(Y,-3):m):y},s.deflateSetDictionary=function(Y,ye){var Me,ue,oe,se,Ie,Be,Re,ct,At=ye.length;if(!Y||!Y.state||(se=(Me=Y.state).wrap)===2||se===1&&Me.status!==D||Me.lookahead)return y;for(se===1&&(Y.adler=l(Y.adler,ye,At,0)),Me.wrap=0,At>=Me.w_size&&(se===0&&(V(Me.head),Me.strstart=0,Me.block_start=0,Me.insert=0),ct=new a.Buf8(Me.w_size),a.arraySet(ct,ye,At-Me.w_size,Me.w_size,0),ye=ct,At=Me.w_size),Ie=Y.avail_in,Be=Y.next_in,Re=Y.input,Y.avail_in=At,Y.next_in=0,Y.input=ye,De(Me);Me.lookahead>=I;){for(ue=Me.strstart,oe=Me.lookahead-(I-1);Me.ins_h=(Me.ins_h<<Me.hash_shift^Me.window[ue+I-1])&Me.hash_mask,Me.prev[ue&Me.w_mask]=Me.head[Me.ins_h],Me.head[Me.ins_h]=ue,ue++,--oe;);Me.strstart=ue,Me.lookahead=I-1,De(Me)}return Me.strstart+=Me.lookahead,Me.block_start=Me.strstart,Me.insert=Me.lookahead,Me.lookahead=0,Me.match_length=Me.prev_length=I-1,Me.match_available=0,Y.next_in=Be,Y.input=Re,Y.avail_in=Ie,Me.wrap=se,m},s.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(n,r,s){r.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(n,r,s){r.exports=function(i,a){var o,l,c,u,d,h,m,y,b,v,x,w,_,k,C,T,A,N,I,j,L,D,H,O,K;o=i.state,l=i.next_in,O=i.input,c=l+(i.avail_in-5),u=i.next_out,K=i.output,d=u-(a-i.avail_out),h=u+(i.avail_out-257),m=o.dmax,y=o.wsize,b=o.whave,v=o.wnext,x=o.window,w=o.hold,_=o.bits,k=o.lencode,C=o.distcode,T=(1<<o.lenbits)-1,A=(1<<o.distbits)-1;e:do{_<15&&(w+=O[l++]<<_,_+=8,w+=O[l++]<<_,_+=8),N=k[w&T];t:for(;;){if(w>>>=I=N>>>24,_-=I,(I=N>>>16&255)===0)K[u++]=65535&N;else{if(!(16&I)){if((64&I)==0){N=k[(65535&N)+(w&(1<<I)-1)];continue t}if(32&I){o.mode=12;break e}i.msg="invalid literal/length code",o.mode=30;break e}j=65535&N,(I&=15)&&(_<I&&(w+=O[l++]<<_,_+=8),j+=w&(1<<I)-1,w>>>=I,_-=I),_<15&&(w+=O[l++]<<_,_+=8,w+=O[l++]<<_,_+=8),N=C[w&A];n:for(;;){if(w>>>=I=N>>>24,_-=I,!(16&(I=N>>>16&255))){if((64&I)==0){N=C[(65535&N)+(w&(1<<I)-1)];continue n}i.msg="invalid distance code",o.mode=30;break e}if(L=65535&N,_<(I&=15)&&(w+=O[l++]<<_,(_+=8)<I&&(w+=O[l++]<<_,_+=8)),m<(L+=w&(1<<I)-1)){i.msg="invalid distance too far back",o.mode=30;break e}if(w>>>=I,_-=I,(I=u-d)<L){if(b<(I=L-I)&&o.sane){i.msg="invalid distance too far back",o.mode=30;break e}if(H=x,(D=0)===v){if(D+=y-I,I<j){for(j-=I;K[u++]=x[D++],--I;);D=u-L,H=K}}else if(v<I){if(D+=y+v-I,(I-=v)<j){for(j-=I;K[u++]=x[D++],--I;);if(D=0,v<j){for(j-=I=v;K[u++]=x[D++],--I;);D=u-L,H=K}}}else if(D+=v-I,I<j){for(j-=I;K[u++]=x[D++],--I;);D=u-L,H=K}for(;2<j;)K[u++]=H[D++],K[u++]=H[D++],K[u++]=H[D++],j-=3;j&&(K[u++]=H[D++],1<j&&(K[u++]=H[D++]))}else{for(D=u-L;K[u++]=K[D++],K[u++]=K[D++],K[u++]=K[D++],2<(j-=3););j&&(K[u++]=K[D++],1<j&&(K[u++]=K[D++]))}break}}break}}while(l<c&&u<h);l-=j=_>>3,w&=(1<<(_-=j<<3))-1,i.next_in=l,i.next_out=u,i.avail_in=l<c?c-l+5:5-(l-c),i.avail_out=u<h?h-u+257:257-(u-h),o.hold=w,o.bits=_}},{}],49:[function(n,r,s){var i=n("../utils/common"),a=n("./adler32"),o=n("./crc32"),l=n("./inffast"),c=n("./inftrees"),u=1,d=2,h=0,m=-2,y=1,b=852,v=592;function x(D){return(D>>>24&255)+(D>>>8&65280)+((65280&D)<<8)+((255&D)<<24)}function w(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new i.Buf16(320),this.work=new i.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function _(D){var H;return D&&D.state?(H=D.state,D.total_in=D.total_out=H.total=0,D.msg="",H.wrap&&(D.adler=1&H.wrap),H.mode=y,H.last=0,H.havedict=0,H.dmax=32768,H.head=null,H.hold=0,H.bits=0,H.lencode=H.lendyn=new i.Buf32(b),H.distcode=H.distdyn=new i.Buf32(v),H.sane=1,H.back=-1,h):m}function k(D){var H;return D&&D.state?((H=D.state).wsize=0,H.whave=0,H.wnext=0,_(D)):m}function C(D,H){var O,K;return D&&D.state?(K=D.state,H<0?(O=0,H=-H):(O=1+(H>>4),H<48&&(H&=15)),H&&(H<8||15<H)?m:(K.window!==null&&K.wbits!==H&&(K.window=null),K.wrap=O,K.wbits=H,k(D))):m}function T(D,H){var O,K;return D?(K=new w,(D.state=K).window=null,(O=C(D,H))!==h&&(D.state=null),O):m}var A,N,I=!0;function j(D){if(I){var H;for(A=new i.Buf32(512),N=new i.Buf32(32),H=0;H<144;)D.lens[H++]=8;for(;H<256;)D.lens[H++]=9;for(;H<280;)D.lens[H++]=7;for(;H<288;)D.lens[H++]=8;for(c(u,D.lens,0,288,A,0,D.work,{bits:9}),H=0;H<32;)D.lens[H++]=5;c(d,D.lens,0,32,N,0,D.work,{bits:5}),I=!1}D.lencode=A,D.lenbits=9,D.distcode=N,D.distbits=5}function L(D,H,O,K){var U,W=D.state;return W.window===null&&(W.wsize=1<<W.wbits,W.wnext=0,W.whave=0,W.window=new i.Buf8(W.wsize)),K>=W.wsize?(i.arraySet(W.window,H,O-W.wsize,W.wsize,0),W.wnext=0,W.whave=W.wsize):(K<(U=W.wsize-W.wnext)&&(U=K),i.arraySet(W.window,H,O-K,U,W.wnext),(K-=U)?(i.arraySet(W.window,H,O-K,K,0),W.wnext=K,W.whave=W.wsize):(W.wnext+=U,W.wnext===W.wsize&&(W.wnext=0),W.whave<W.wsize&&(W.whave+=U))),0}s.inflateReset=k,s.inflateReset2=C,s.inflateResetKeep=_,s.inflateInit=function(D){return T(D,15)},s.inflateInit2=T,s.inflate=function(D,H){var O,K,U,W,B,ne,V,Q,ee,re,de,me,De,je,Te,_e,Ue,Qe,We,Pe,Y,ye,Me,ue,oe=0,se=new i.Buf8(4),Ie=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!D||!D.state||!D.output||!D.input&&D.avail_in!==0)return m;(O=D.state).mode===12&&(O.mode=13),B=D.next_out,U=D.output,V=D.avail_out,W=D.next_in,K=D.input,ne=D.avail_in,Q=O.hold,ee=O.bits,re=ne,de=V,ye=h;e:for(;;)switch(O.mode){case y:if(O.wrap===0){O.mode=13;break}for(;ee<16;){if(ne===0)break e;ne--,Q+=K[W++]<<ee,ee+=8}if(2&O.wrap&&Q===35615){se[O.check=0]=255&Q,se[1]=Q>>>8&255,O.check=o(O.check,se,2,0),ee=Q=0,O.mode=2;break}if(O.flags=0,O.head&&(O.head.done=!1),!(1&O.wrap)||(((255&Q)<<8)+(Q>>8))%31){D.msg="incorrect header check",O.mode=30;break}if((15&Q)!=8){D.msg="unknown compression method",O.mode=30;break}if(ee-=4,Y=8+(15&(Q>>>=4)),O.wbits===0)O.wbits=Y;else if(Y>O.wbits){D.msg="invalid window size",O.mode=30;break}O.dmax=1<<Y,D.adler=O.check=1,O.mode=512&Q?10:12,ee=Q=0;break;case 2:for(;ee<16;){if(ne===0)break e;ne--,Q+=K[W++]<<ee,ee+=8}if(O.flags=Q,(255&O.flags)!=8){D.msg="unknown compression method",O.mode=30;break}if(57344&O.flags){D.msg="unknown header flags set",O.mode=30;break}O.head&&(O.head.text=Q>>8&1),512&O.flags&&(se[0]=255&Q,se[1]=Q>>>8&255,O.check=o(O.check,se,2,0)),ee=Q=0,O.mode=3;case 3:for(;ee<32;){if(ne===0)break e;ne--,Q+=K[W++]<<ee,ee+=8}O.head&&(O.head.time=Q),512&O.flags&&(se[0]=255&Q,se[1]=Q>>>8&255,se[2]=Q>>>16&255,se[3]=Q>>>24&255,O.check=o(O.check,se,4,0)),ee=Q=0,O.mode=4;case 4:for(;ee<16;){if(ne===0)break e;ne--,Q+=K[W++]<<ee,ee+=8}O.head&&(O.head.xflags=255&Q,O.head.os=Q>>8),512&O.flags&&(se[0]=255&Q,se[1]=Q>>>8&255,O.check=o(O.check,se,2,0)),ee=Q=0,O.mode=5;case 5:if(1024&O.flags){for(;ee<16;){if(ne===0)break e;ne--,Q+=K[W++]<<ee,ee+=8}O.length=Q,O.head&&(O.head.extra_len=Q),512&O.flags&&(se[0]=255&Q,se[1]=Q>>>8&255,O.check=o(O.check,se,2,0)),ee=Q=0}else O.head&&(O.head.extra=null);O.mode=6;case 6:if(1024&O.flags&&(ne<(me=O.length)&&(me=ne),me&&(O.head&&(Y=O.head.extra_len-O.length,O.head.extra||(O.head.extra=new Array(O.head.extra_len)),i.arraySet(O.head.extra,K,W,me,Y)),512&O.flags&&(O.check=o(O.check,K,me,W)),ne-=me,W+=me,O.length-=me),O.length))break e;O.length=0,O.mode=7;case 7:if(2048&O.flags){if(ne===0)break e;for(me=0;Y=K[W+me++],O.head&&Y&&O.length<65536&&(O.head.name+=String.fromCharCode(Y)),Y&&me<ne;);if(512&O.flags&&(O.check=o(O.check,K,me,W)),ne-=me,W+=me,Y)break e}else O.head&&(O.head.name=null);O.length=0,O.mode=8;case 8:if(4096&O.flags){if(ne===0)break e;for(me=0;Y=K[W+me++],O.head&&Y&&O.length<65536&&(O.head.comment+=String.fromCharCode(Y)),Y&&me<ne;);if(512&O.flags&&(O.check=o(O.check,K,me,W)),ne-=me,W+=me,Y)break e}else O.head&&(O.head.comment=null);O.mode=9;case 9:if(512&O.flags){for(;ee<16;){if(ne===0)break e;ne--,Q+=K[W++]<<ee,ee+=8}if(Q!==(65535&O.check)){D.msg="header crc mismatch",O.mode=30;break}ee=Q=0}O.head&&(O.head.hcrc=O.flags>>9&1,O.head.done=!0),D.adler=O.check=0,O.mode=12;break;case 10:for(;ee<32;){if(ne===0)break e;ne--,Q+=K[W++]<<ee,ee+=8}D.adler=O.check=x(Q),ee=Q=0,O.mode=11;case 11:if(O.havedict===0)return D.next_out=B,D.avail_out=V,D.next_in=W,D.avail_in=ne,O.hold=Q,O.bits=ee,2;D.adler=O.check=1,O.mode=12;case 12:if(H===5||H===6)break e;case 13:if(O.last){Q>>>=7&ee,ee-=7&ee,O.mode=27;break}for(;ee<3;){if(ne===0)break e;ne--,Q+=K[W++]<<ee,ee+=8}switch(O.last=1&Q,ee-=1,3&(Q>>>=1)){case 0:O.mode=14;break;case 1:if(j(O),O.mode=20,H!==6)break;Q>>>=2,ee-=2;break e;case 2:O.mode=17;break;case 3:D.msg="invalid block type",O.mode=30}Q>>>=2,ee-=2;break;case 14:for(Q>>>=7&ee,ee-=7&ee;ee<32;){if(ne===0)break e;ne--,Q+=K[W++]<<ee,ee+=8}if((65535&Q)!=(Q>>>16^65535)){D.msg="invalid stored block lengths",O.mode=30;break}if(O.length=65535&Q,ee=Q=0,O.mode=15,H===6)break e;case 15:O.mode=16;case 16:if(me=O.length){if(ne<me&&(me=ne),V<me&&(me=V),me===0)break e;i.arraySet(U,K,W,me,B),ne-=me,W+=me,V-=me,B+=me,O.length-=me;break}O.mode=12;break;case 17:for(;ee<14;){if(ne===0)break e;ne--,Q+=K[W++]<<ee,ee+=8}if(O.nlen=257+(31&Q),Q>>>=5,ee-=5,O.ndist=1+(31&Q),Q>>>=5,ee-=5,O.ncode=4+(15&Q),Q>>>=4,ee-=4,286<O.nlen||30<O.ndist){D.msg="too many length or distance symbols",O.mode=30;break}O.have=0,O.mode=18;case 18:for(;O.have<O.ncode;){for(;ee<3;){if(ne===0)break e;ne--,Q+=K[W++]<<ee,ee+=8}O.lens[Ie[O.have++]]=7&Q,Q>>>=3,ee-=3}for(;O.have<19;)O.lens[Ie[O.have++]]=0;if(O.lencode=O.lendyn,O.lenbits=7,Me={bits:O.lenbits},ye=c(0,O.lens,0,19,O.lencode,0,O.work,Me),O.lenbits=Me.bits,ye){D.msg="invalid code lengths set",O.mode=30;break}O.have=0,O.mode=19;case 19:for(;O.have<O.nlen+O.ndist;){for(;_e=(oe=O.lencode[Q&(1<<O.lenbits)-1])>>>16&255,Ue=65535&oe,!((Te=oe>>>24)<=ee);){if(ne===0)break e;ne--,Q+=K[W++]<<ee,ee+=8}if(Ue<16)Q>>>=Te,ee-=Te,O.lens[O.have++]=Ue;else{if(Ue===16){for(ue=Te+2;ee<ue;){if(ne===0)break e;ne--,Q+=K[W++]<<ee,ee+=8}if(Q>>>=Te,ee-=Te,O.have===0){D.msg="invalid bit length repeat",O.mode=30;break}Y=O.lens[O.have-1],me=3+(3&Q),Q>>>=2,ee-=2}else if(Ue===17){for(ue=Te+3;ee<ue;){if(ne===0)break e;ne--,Q+=K[W++]<<ee,ee+=8}ee-=Te,Y=0,me=3+(7&(Q>>>=Te)),Q>>>=3,ee-=3}else{for(ue=Te+7;ee<ue;){if(ne===0)break e;ne--,Q+=K[W++]<<ee,ee+=8}ee-=Te,Y=0,me=11+(127&(Q>>>=Te)),Q>>>=7,ee-=7}if(O.have+me>O.nlen+O.ndist){D.msg="invalid bit length repeat",O.mode=30;break}for(;me--;)O.lens[O.have++]=Y}}if(O.mode===30)break;if(O.lens[256]===0){D.msg="invalid code -- missing end-of-block",O.mode=30;break}if(O.lenbits=9,Me={bits:O.lenbits},ye=c(u,O.lens,0,O.nlen,O.lencode,0,O.work,Me),O.lenbits=Me.bits,ye){D.msg="invalid literal/lengths set",O.mode=30;break}if(O.distbits=6,O.distcode=O.distdyn,Me={bits:O.distbits},ye=c(d,O.lens,O.nlen,O.ndist,O.distcode,0,O.work,Me),O.distbits=Me.bits,ye){D.msg="invalid distances set",O.mode=30;break}if(O.mode=20,H===6)break e;case 20:O.mode=21;case 21:if(6<=ne&&258<=V){D.next_out=B,D.avail_out=V,D.next_in=W,D.avail_in=ne,O.hold=Q,O.bits=ee,l(D,de),B=D.next_out,U=D.output,V=D.avail_out,W=D.next_in,K=D.input,ne=D.avail_in,Q=O.hold,ee=O.bits,O.mode===12&&(O.back=-1);break}for(O.back=0;_e=(oe=O.lencode[Q&(1<<O.lenbits)-1])>>>16&255,Ue=65535&oe,!((Te=oe>>>24)<=ee);){if(ne===0)break e;ne--,Q+=K[W++]<<ee,ee+=8}if(_e&&(240&_e)==0){for(Qe=Te,We=_e,Pe=Ue;_e=(oe=O.lencode[Pe+((Q&(1<<Qe+We)-1)>>Qe)])>>>16&255,Ue=65535&oe,!(Qe+(Te=oe>>>24)<=ee);){if(ne===0)break e;ne--,Q+=K[W++]<<ee,ee+=8}Q>>>=Qe,ee-=Qe,O.back+=Qe}if(Q>>>=Te,ee-=Te,O.back+=Te,O.length=Ue,_e===0){O.mode=26;break}if(32&_e){O.back=-1,O.mode=12;break}if(64&_e){D.msg="invalid literal/length code",O.mode=30;break}O.extra=15&_e,O.mode=22;case 22:if(O.extra){for(ue=O.extra;ee<ue;){if(ne===0)break e;ne--,Q+=K[W++]<<ee,ee+=8}O.length+=Q&(1<<O.extra)-1,Q>>>=O.extra,ee-=O.extra,O.back+=O.extra}O.was=O.length,O.mode=23;case 23:for(;_e=(oe=O.distcode[Q&(1<<O.distbits)-1])>>>16&255,Ue=65535&oe,!((Te=oe>>>24)<=ee);){if(ne===0)break e;ne--,Q+=K[W++]<<ee,ee+=8}if((240&_e)==0){for(Qe=Te,We=_e,Pe=Ue;_e=(oe=O.distcode[Pe+((Q&(1<<Qe+We)-1)>>Qe)])>>>16&255,Ue=65535&oe,!(Qe+(Te=oe>>>24)<=ee);){if(ne===0)break e;ne--,Q+=K[W++]<<ee,ee+=8}Q>>>=Qe,ee-=Qe,O.back+=Qe}if(Q>>>=Te,ee-=Te,O.back+=Te,64&_e){D.msg="invalid distance code",O.mode=30;break}O.offset=Ue,O.extra=15&_e,O.mode=24;case 24:if(O.extra){for(ue=O.extra;ee<ue;){if(ne===0)break e;ne--,Q+=K[W++]<<ee,ee+=8}O.offset+=Q&(1<<O.extra)-1,Q>>>=O.extra,ee-=O.extra,O.back+=O.extra}if(O.offset>O.dmax){D.msg="invalid distance too far back",O.mode=30;break}O.mode=25;case 25:if(V===0)break e;if(me=de-V,O.offset>me){if((me=O.offset-me)>O.whave&&O.sane){D.msg="invalid distance too far back",O.mode=30;break}De=me>O.wnext?(me-=O.wnext,O.wsize-me):O.wnext-me,me>O.length&&(me=O.length),je=O.window}else je=U,De=B-O.offset,me=O.length;for(V<me&&(me=V),V-=me,O.length-=me;U[B++]=je[De++],--me;);O.length===0&&(O.mode=21);break;case 26:if(V===0)break e;U[B++]=O.length,V--,O.mode=21;break;case 27:if(O.wrap){for(;ee<32;){if(ne===0)break e;ne--,Q|=K[W++]<<ee,ee+=8}if(de-=V,D.total_out+=de,O.total+=de,de&&(D.adler=O.check=O.flags?o(O.check,U,de,B-de):a(O.check,U,de,B-de)),de=V,(O.flags?Q:x(Q))!==O.check){D.msg="incorrect data check",O.mode=30;break}ee=Q=0}O.mode=28;case 28:if(O.wrap&&O.flags){for(;ee<32;){if(ne===0)break e;ne--,Q+=K[W++]<<ee,ee+=8}if(Q!==(4294967295&O.total)){D.msg="incorrect length check",O.mode=30;break}ee=Q=0}O.mode=29;case 29:ye=1;break e;case 30:ye=-3;break e;case 31:return-4;case 32:default:return m}return D.next_out=B,D.avail_out=V,D.next_in=W,D.avail_in=ne,O.hold=Q,O.bits=ee,(O.wsize||de!==D.avail_out&&O.mode<30&&(O.mode<27||H!==4))&&L(D,D.output,D.next_out,de-D.avail_out)?(O.mode=31,-4):(re-=D.avail_in,de-=D.avail_out,D.total_in+=re,D.total_out+=de,O.total+=de,O.wrap&&de&&(D.adler=O.check=O.flags?o(O.check,U,de,D.next_out-de):a(O.check,U,de,D.next_out-de)),D.data_type=O.bits+(O.last?64:0)+(O.mode===12?128:0)+(O.mode===20||O.mode===15?256:0),(re==0&&de===0||H===4)&&ye===h&&(ye=-5),ye)},s.inflateEnd=function(D){if(!D||!D.state)return m;var H=D.state;return H.window&&(H.window=null),D.state=null,h},s.inflateGetHeader=function(D,H){var O;return D&&D.state?(2&(O=D.state).wrap)==0?m:((O.head=H).done=!1,h):m},s.inflateSetDictionary=function(D,H){var O,K=H.length;return D&&D.state?(O=D.state).wrap!==0&&O.mode!==11?m:O.mode===11&&a(1,H,K,0)!==O.check?-3:L(D,H,K,K)?(O.mode=31,-4):(O.havedict=1,h):m},s.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(n,r,s){var i=n("../utils/common"),a=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],o=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],l=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],c=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];r.exports=function(u,d,h,m,y,b,v,x){var w,_,k,C,T,A,N,I,j,L=x.bits,D=0,H=0,O=0,K=0,U=0,W=0,B=0,ne=0,V=0,Q=0,ee=null,re=0,de=new i.Buf16(16),me=new i.Buf16(16),De=null,je=0;for(D=0;D<=15;D++)de[D]=0;for(H=0;H<m;H++)de[d[h+H]]++;for(U=L,K=15;1<=K&&de[K]===0;K--);if(K<U&&(U=K),K===0)return y[b++]=20971520,y[b++]=20971520,x.bits=1,0;for(O=1;O<K&&de[O]===0;O++);for(U<O&&(U=O),D=ne=1;D<=15;D++)if(ne<<=1,(ne-=de[D])<0)return-1;if(0<ne&&(u===0||K!==1))return-1;for(me[1]=0,D=1;D<15;D++)me[D+1]=me[D]+de[D];for(H=0;H<m;H++)d[h+H]!==0&&(v[me[d[h+H]]++]=H);if(A=u===0?(ee=De=v,19):u===1?(ee=a,re-=257,De=o,je-=257,256):(ee=l,De=c,-1),D=O,T=b,B=H=Q=0,k=-1,C=(V=1<<(W=U))-1,u===1&&852<V||u===2&&592<V)return 1;for(;;){for(N=D-B,j=v[H]<A?(I=0,v[H]):v[H]>A?(I=De[je+v[H]],ee[re+v[H]]):(I=96,0),w=1<<D-B,O=_=1<<W;y[T+(Q>>B)+(_-=w)]=N<<24|I<<16|j|0,_!==0;);for(w=1<<D-1;Q&w;)w>>=1;if(w!==0?(Q&=w-1,Q+=w):Q=0,H++,--de[D]==0){if(D===K)break;D=d[h+v[H]]}if(U<D&&(Q&C)!==k){for(B===0&&(B=U),T+=O,ne=1<<(W=D-B);W+B<K&&!((ne-=de[W+B])<=0);)W++,ne<<=1;if(V+=1<<W,u===1&&852<V||u===2&&592<V)return 1;y[k=Q&C]=U<<24|W<<16|T-b|0}}return Q!==0&&(y[T+Q]=D-B<<24|64<<16|0),x.bits=U,0}},{"../utils/common":41}],51:[function(n,r,s){r.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(n,r,s){var i=n("../utils/common"),a=0,o=1;function l(oe){for(var se=oe.length;0<=--se;)oe[se]=0}var c=0,u=29,d=256,h=d+1+u,m=30,y=19,b=2*h+1,v=15,x=16,w=7,_=256,k=16,C=17,T=18,A=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],N=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],I=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],j=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],L=new Array(2*(h+2));l(L);var D=new Array(2*m);l(D);var H=new Array(512);l(H);var O=new Array(256);l(O);var K=new Array(u);l(K);var U,W,B,ne=new Array(m);function V(oe,se,Ie,Be,Re){this.static_tree=oe,this.extra_bits=se,this.extra_base=Ie,this.elems=Be,this.max_length=Re,this.has_stree=oe&&oe.length}function Q(oe,se){this.dyn_tree=oe,this.max_code=0,this.stat_desc=se}function ee(oe){return oe<256?H[oe]:H[256+(oe>>>7)]}function re(oe,se){oe.pending_buf[oe.pending++]=255&se,oe.pending_buf[oe.pending++]=se>>>8&255}function de(oe,se,Ie){oe.bi_valid>x-Ie?(oe.bi_buf|=se<<oe.bi_valid&65535,re(oe,oe.bi_buf),oe.bi_buf=se>>x-oe.bi_valid,oe.bi_valid+=Ie-x):(oe.bi_buf|=se<<oe.bi_valid&65535,oe.bi_valid+=Ie)}function me(oe,se,Ie){de(oe,Ie[2*se],Ie[2*se+1])}function De(oe,se){for(var Ie=0;Ie|=1&oe,oe>>>=1,Ie<<=1,0<--se;);return Ie>>>1}function je(oe,se,Ie){var Be,Re,ct=new Array(v+1),At=0;for(Be=1;Be<=v;Be++)ct[Be]=At=At+Ie[Be-1]<<1;for(Re=0;Re<=se;Re++){var ut=oe[2*Re+1];ut!==0&&(oe[2*Re]=De(ct[ut]++,ut))}}function Te(oe){var se;for(se=0;se<h;se++)oe.dyn_ltree[2*se]=0;for(se=0;se<m;se++)oe.dyn_dtree[2*se]=0;for(se=0;se<y;se++)oe.bl_tree[2*se]=0;oe.dyn_ltree[2*_]=1,oe.opt_len=oe.static_len=0,oe.last_lit=oe.matches=0}function _e(oe){8<oe.bi_valid?re(oe,oe.bi_buf):0<oe.bi_valid&&(oe.pending_buf[oe.pending++]=oe.bi_buf),oe.bi_buf=0,oe.bi_valid=0}function Ue(oe,se,Ie,Be){var Re=2*se,ct=2*Ie;return oe[Re]<oe[ct]||oe[Re]===oe[ct]&&Be[se]<=Be[Ie]}function Qe(oe,se,Ie){for(var Be=oe.heap[Ie],Re=Ie<<1;Re<=oe.heap_len&&(Re<oe.heap_len&&Ue(se,oe.heap[Re+1],oe.heap[Re],oe.depth)&&Re++,!Ue(se,Be,oe.heap[Re],oe.depth));)oe.heap[Ie]=oe.heap[Re],Ie=Re,Re<<=1;oe.heap[Ie]=Be}function We(oe,se,Ie){var Be,Re,ct,At,ut=0;if(oe.last_lit!==0)for(;Be=oe.pending_buf[oe.d_buf+2*ut]<<8|oe.pending_buf[oe.d_buf+2*ut+1],Re=oe.pending_buf[oe.l_buf+ut],ut++,Be===0?me(oe,Re,se):(me(oe,(ct=O[Re])+d+1,se),(At=A[ct])!==0&&de(oe,Re-=K[ct],At),me(oe,ct=ee(--Be),Ie),(At=N[ct])!==0&&de(oe,Be-=ne[ct],At)),ut<oe.last_lit;);me(oe,_,se)}function Pe(oe,se){var Ie,Be,Re,ct=se.dyn_tree,At=se.stat_desc.static_tree,ut=se.stat_desc.has_stree,Pt=se.stat_desc.elems,Ut=-1;for(oe.heap_len=0,oe.heap_max=b,Ie=0;Ie<Pt;Ie++)ct[2*Ie]!==0?(oe.heap[++oe.heap_len]=Ut=Ie,oe.depth[Ie]=0):ct[2*Ie+1]=0;for(;oe.heap_len<2;)ct[2*(Re=oe.heap[++oe.heap_len]=Ut<2?++Ut:0)]=1,oe.depth[Re]=0,oe.opt_len--,ut&&(oe.static_len-=At[2*Re+1]);for(se.max_code=Ut,Ie=oe.heap_len>>1;1<=Ie;Ie--)Qe(oe,ct,Ie);for(Re=Pt;Ie=oe.heap[1],oe.heap[1]=oe.heap[oe.heap_len--],Qe(oe,ct,1),Be=oe.heap[1],oe.heap[--oe.heap_max]=Ie,oe.heap[--oe.heap_max]=Be,ct[2*Re]=ct[2*Ie]+ct[2*Be],oe.depth[Re]=(oe.depth[Ie]>=oe.depth[Be]?oe.depth[Ie]:oe.depth[Be])+1,ct[2*Ie+1]=ct[2*Be+1]=Re,oe.heap[1]=Re++,Qe(oe,ct,1),2<=oe.heap_len;);oe.heap[--oe.heap_max]=oe.heap[1],function(Ft,Yt){var we,F,X,be,Ee,ge,Ae=Yt.dyn_tree,le=Yt.max_code,ft=Yt.stat_desc.static_tree,et=Yt.stat_desc.has_stree,$=Yt.stat_desc.extra_bits,qe=Yt.stat_desc.extra_base,tt=Yt.stat_desc.max_length,ve=0;for(be=0;be<=v;be++)Ft.bl_count[be]=0;for(Ae[2*Ft.heap[Ft.heap_max]+1]=0,we=Ft.heap_max+1;we<b;we++)tt<(be=Ae[2*Ae[2*(F=Ft.heap[we])+1]+1]+1)&&(be=tt,ve++),Ae[2*F+1]=be,le<F||(Ft.bl_count[be]++,Ee=0,qe<=F&&(Ee=$[F-qe]),ge=Ae[2*F],Ft.opt_len+=ge*(be+Ee),et&&(Ft.static_len+=ge*(ft[2*F+1]+Ee)));if(ve!==0){do{for(be=tt-1;Ft.bl_count[be]===0;)be--;Ft.bl_count[be]--,Ft.bl_count[be+1]+=2,Ft.bl_count[tt]--,ve-=2}while(0<ve);for(be=tt;be!==0;be--)for(F=Ft.bl_count[be];F!==0;)le<(X=Ft.heap[--we])||(Ae[2*X+1]!==be&&(Ft.opt_len+=(be-Ae[2*X+1])*Ae[2*X],Ae[2*X+1]=be),F--)}}(oe,se),je(ct,Ut,oe.bl_count)}function Y(oe,se,Ie){var Be,Re,ct=-1,At=se[1],ut=0,Pt=7,Ut=4;for(At===0&&(Pt=138,Ut=3),se[2*(Ie+1)+1]=65535,Be=0;Be<=Ie;Be++)Re=At,At=se[2*(Be+1)+1],++ut<Pt&&Re===At||(ut<Ut?oe.bl_tree[2*Re]+=ut:Re!==0?(Re!==ct&&oe.bl_tree[2*Re]++,oe.bl_tree[2*k]++):ut<=10?oe.bl_tree[2*C]++:oe.bl_tree[2*T]++,ct=Re,Ut=(ut=0)===At?(Pt=138,3):Re===At?(Pt=6,3):(Pt=7,4))}function ye(oe,se,Ie){var Be,Re,ct=-1,At=se[1],ut=0,Pt=7,Ut=4;for(At===0&&(Pt=138,Ut=3),Be=0;Be<=Ie;Be++)if(Re=At,At=se[2*(Be+1)+1],!(++ut<Pt&&Re===At)){if(ut<Ut)for(;me(oe,Re,oe.bl_tree),--ut!=0;);else Re!==0?(Re!==ct&&(me(oe,Re,oe.bl_tree),ut--),me(oe,k,oe.bl_tree),de(oe,ut-3,2)):ut<=10?(me(oe,C,oe.bl_tree),de(oe,ut-3,3)):(me(oe,T,oe.bl_tree),de(oe,ut-11,7));ct=Re,Ut=(ut=0)===At?(Pt=138,3):Re===At?(Pt=6,3):(Pt=7,4)}}l(ne);var Me=!1;function ue(oe,se,Ie,Be){de(oe,(c<<1)+(Be?1:0),3),function(Re,ct,At,ut){_e(Re),re(Re,At),re(Re,~At),i.arraySet(Re.pending_buf,Re.window,ct,At,Re.pending),Re.pending+=At}(oe,se,Ie)}s._tr_init=function(oe){Me||(function(){var se,Ie,Be,Re,ct,At=new Array(v+1);for(Re=Be=0;Re<u-1;Re++)for(K[Re]=Be,se=0;se<1<<A[Re];se++)O[Be++]=Re;for(O[Be-1]=Re,Re=ct=0;Re<16;Re++)for(ne[Re]=ct,se=0;se<1<<N[Re];se++)H[ct++]=Re;for(ct>>=7;Re<m;Re++)for(ne[Re]=ct<<7,se=0;se<1<<N[Re]-7;se++)H[256+ct++]=Re;for(Ie=0;Ie<=v;Ie++)At[Ie]=0;for(se=0;se<=143;)L[2*se+1]=8,se++,At[8]++;for(;se<=255;)L[2*se+1]=9,se++,At[9]++;for(;se<=279;)L[2*se+1]=7,se++,At[7]++;for(;se<=287;)L[2*se+1]=8,se++,At[8]++;for(je(L,h+1,At),se=0;se<m;se++)D[2*se+1]=5,D[2*se]=De(se,5);U=new V(L,A,d+1,h,v),W=new V(D,N,0,m,v),B=new V(new Array(0),I,0,y,w)}(),Me=!0),oe.l_desc=new Q(oe.dyn_ltree,U),oe.d_desc=new Q(oe.dyn_dtree,W),oe.bl_desc=new Q(oe.bl_tree,B),oe.bi_buf=0,oe.bi_valid=0,Te(oe)},s._tr_stored_block=ue,s._tr_flush_block=function(oe,se,Ie,Be){var Re,ct,At=0;0<oe.level?(oe.strm.data_type===2&&(oe.strm.data_type=function(ut){var Pt,Ut=4093624447;for(Pt=0;Pt<=31;Pt++,Ut>>>=1)if(1&Ut&&ut.dyn_ltree[2*Pt]!==0)return a;if(ut.dyn_ltree[18]!==0||ut.dyn_ltree[20]!==0||ut.dyn_ltree[26]!==0)return o;for(Pt=32;Pt<d;Pt++)if(ut.dyn_ltree[2*Pt]!==0)return o;return a}(oe)),Pe(oe,oe.l_desc),Pe(oe,oe.d_desc),At=function(ut){var Pt;for(Y(ut,ut.dyn_ltree,ut.l_desc.max_code),Y(ut,ut.dyn_dtree,ut.d_desc.max_code),Pe(ut,ut.bl_desc),Pt=y-1;3<=Pt&&ut.bl_tree[2*j[Pt]+1]===0;Pt--);return ut.opt_len+=3*(Pt+1)+5+5+4,Pt}(oe),Re=oe.opt_len+3+7>>>3,(ct=oe.static_len+3+7>>>3)<=Re&&(Re=ct)):Re=ct=Ie+5,Ie+4<=Re&&se!==-1?ue(oe,se,Ie,Be):oe.strategy===4||ct===Re?(de(oe,2+(Be?1:0),3),We(oe,L,D)):(de(oe,4+(Be?1:0),3),function(ut,Pt,Ut,Ft){var Yt;for(de(ut,Pt-257,5),de(ut,Ut-1,5),de(ut,Ft-4,4),Yt=0;Yt<Ft;Yt++)de(ut,ut.bl_tree[2*j[Yt]+1],3);ye(ut,ut.dyn_ltree,Pt-1),ye(ut,ut.dyn_dtree,Ut-1)}(oe,oe.l_desc.max_code+1,oe.d_desc.max_code+1,At+1),We(oe,oe.dyn_ltree,oe.dyn_dtree)),Te(oe),Be&&_e(oe)},s._tr_tally=function(oe,se,Ie){return oe.pending_buf[oe.d_buf+2*oe.last_lit]=se>>>8&255,oe.pending_buf[oe.d_buf+2*oe.last_lit+1]=255&se,oe.pending_buf[oe.l_buf+oe.last_lit]=255&Ie,oe.last_lit++,se===0?oe.dyn_ltree[2*Ie]++:(oe.matches++,se--,oe.dyn_ltree[2*(O[Ie]+d+1)]++,oe.dyn_dtree[2*ee(se)]++),oe.last_lit===oe.lit_bufsize-1},s._tr_align=function(oe){de(oe,2,3),me(oe,_,L),function(se){se.bi_valid===16?(re(se,se.bi_buf),se.bi_buf=0,se.bi_valid=0):8<=se.bi_valid&&(se.pending_buf[se.pending++]=255&se.bi_buf,se.bi_buf>>=8,se.bi_valid-=8)}(oe)}},{"../utils/common":41}],53:[function(n,r,s){r.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(n,r,s){(function(i){(function(a,o){if(!a.setImmediate){var l,c,u,d,h=1,m={},y=!1,b=a.document,v=Object.getPrototypeOf&&Object.getPrototypeOf(a);v=v&&v.setTimeout?v:a,l={}.toString.call(a.process)==="[object process]"?function(k){Di.nextTick(function(){w(k)})}:function(){if(a.postMessage&&!a.importScripts){var k=!0,C=a.onmessage;return a.onmessage=function(){k=!1},a.postMessage("","*"),a.onmessage=C,k}}()?(d="setImmediate$"+Math.random()+"$",a.addEventListener?a.addEventListener("message",_,!1):a.attachEvent("onmessage",_),function(k){a.postMessage(d+k,"*")}):a.MessageChannel?((u=new MessageChannel).port1.onmessage=function(k){w(k.data)},function(k){u.port2.postMessage(k)}):b&&"onreadystatechange"in b.createElement("script")?(c=b.documentElement,function(k){var C=b.createElement("script");C.onreadystatechange=function(){w(k),C.onreadystatechange=null,c.removeChild(C),C=null},c.appendChild(C)}):function(k){setTimeout(w,0,k)},v.setImmediate=function(k){typeof k!="function"&&(k=new Function(""+k));for(var C=new Array(arguments.length-1),T=0;T<C.length;T++)C[T]=arguments[T+1];var A={callback:k,args:C};return m[h]=A,l(h),h++},v.clearImmediate=x}function x(k){delete m[k]}function w(k){if(y)setTimeout(w,0,k);else{var C=m[k];if(C){y=!0;try{(function(T){var A=T.callback,N=T.args;switch(N.length){case 0:A();break;case 1:A(N[0]);break;case 2:A(N[0],N[1]);break;case 3:A(N[0],N[1],N[2]);break;default:A.apply(o,N)}})(C)}finally{x(k),y=!1}}}}function _(k){k.source===a&&typeof k.data=="string"&&k.data.indexOf(d)===0&&w(+k.data.slice(d.length))}})(typeof self>"u"?i===void 0?this:i:self)}).call(this,typeof cm<"u"?cm:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})}(UI)),UI.exports}var XCe=ZCe();const vD=ga(XCe),_w=(e,t=2)=>{if(e===0)return"0 Bytes";const n=1024,r=t<0?0:t,s=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],i=Math.floor(Math.log(e)/Math.log(n));return parseFloat((e/Math.pow(n,i)).toFixed(r))+" "+s[i]},qr=e=>{let t=e.replace(/\/+/g,"/");return t.startsWith("/")||(t="/"+t),t!=="/"&&t.endsWith("/")&&(t=t.slice(0,-1)),t},Wu=(...e)=>qr(e.map(t=>t.trim()).filter(Boolean).join("/")),hT=e=>{const t=qr(e);if(t==="/")return"/";const n=t.lastIndexOf("/");return n===-1||n===0?"/":t.substring(0,n)},xi=e=>{const t=qr(e);return t==="/"?"":t.substring(t.lastIndexOf("/")+1)},V3=(e,t)=>qr(e==="/"?`/${t}`:`${e}/${t}`);var qI,Jz;function JCe(){if(Jz)return qI;Jz=1;var e=function(t){if(t=t||{},this.Promise=t.Promise||Promise,this.queues=Object.create(null),this.domainReentrant=t.domainReentrant||!1,this.domainReentrant){if(typeof Di>"u"||typeof Di.domain>"u")throw new Error("Domain-reentrant locks require `process.domain` to exist. Please flip `opts.domainReentrant = false`, use a NodeJS version that still implements Domain, or install a browser polyfill.");this.domains=Object.create(null)}this.timeout=t.timeout||e.DEFAULT_TIMEOUT,this.maxOccupationTime=t.maxOccupationTime||e.DEFAULT_MAX_OCCUPATION_TIME,this.maxExecutionTime=t.maxExecutionTime||e.DEFAULT_MAX_EXECUTION_TIME,t.maxPending===1/0||Number.isInteger(t.maxPending)&&t.maxPending>=0?this.maxPending=t.maxPending:this.maxPending=e.DEFAULT_MAX_PENDING};return e.DEFAULT_TIMEOUT=0,e.DEFAULT_MAX_OCCUPATION_TIME=0,e.DEFAULT_MAX_EXECUTION_TIME=0,e.DEFAULT_MAX_PENDING=1e3,e.prototype.acquire=function(t,n,r,s){if(Array.isArray(t))return this._acquireBatch(t,n,r,s);if(typeof n!="function")throw new Error("You must pass a function to execute");var i=null,a=null,o=null;typeof r!="function"&&(s=r,r=null,o=new this.Promise(function(_,k){i=_,a=k})),s=s||{};var l=!1,c=null,u=null,d=null,h=this,m=function(_,k,C){u&&(clearTimeout(u),u=null),d&&(clearTimeout(d),d=null),_&&(h.queues[t]&&h.queues[t].length===0&&delete h.queues[t],h.domainReentrant&&delete h.domains[t]),l||(o?k?a(k):i(C):typeof r=="function"&&r(k,C),l=!0),_&&h.queues[t]&&h.queues[t].length>0&&h.queues[t].shift()()},y=function(_){if(l)return m(_);c&&(clearTimeout(c),c=null),h.domainReentrant&&_&&(h.domains[t]=Di.domain);var k=s.maxExecutionTime||h.maxExecutionTime;if(k&&(d=setTimeout(function(){h.queues[t]&&m(_,new Error("Maximum execution time is exceeded "+t))},k)),n.length===1){var C=!1;try{n(function(T,A){C||(C=!0,m(_,T,A))})}catch(T){C||(C=!0,m(_,T))}}else h._promiseTry(function(){return n()}).then(function(T){m(_,void 0,T)},function(T){m(_,T)})};h.domainReentrant&&Di.domain&&(y=Di.domain.bind(y));var b=s.maxPending||h.maxPending;if(!h.queues[t])h.queues[t]=[],y(!0);else if(h.domainReentrant&&Di.domain&&Di.domain===h.domains[t])y(!1);else if(h.queues[t].length>=b)m(!1,new Error("Too many pending tasks in queue "+t));else{var v=function(){y(!0)};s.skipQueue?h.queues[t].unshift(v):h.queues[t].push(v);var x=s.timeout||h.timeout;x&&(c=setTimeout(function(){c=null,m(!1,new Error("async-lock timed out in queue "+t))},x))}var w=s.maxOccupationTime||h.maxOccupationTime;if(w&&(u=setTimeout(function(){h.queues[t]&&m(!1,new Error("Maximum occupation time is exceeded in queue "+t))},w)),o)return o},e.prototype._acquireBatch=function(t,n,r,s){typeof r!="function"&&(s=r,r=null);var i=this,a=function(l,c){return function(u){i.acquire(l,c,u,s)}},o=t.reduceRight(function(l,c){return a(c,l)},n);if(typeof r=="function")o(r);else return new this.Promise(function(l,c){o.length===1?o(function(u,d){u?c(u):l(d)}):l(o())})},e.prototype.isBusy=function(t){return t?!!this.queues[t]:Object.keys(this.queues).length>0},e.prototype._promiseTry=function(t){try{return this.Promise.resolve(t())}catch(n){return this.Promise.reject(n)}},qI=e,qI}var VI,Qz;function QCe(){return Qz||(Qz=1,VI=JCe()),VI}var e2e=QCe();const Cw=ga(e2e);var eC={exports:{}},e9;function t2e(){return e9||(e9=1,typeof Object.create=="function"?eC.exports=function(t,n){n&&(t.super_=n,t.prototype=Object.create(n.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:eC.exports=function(t,n){if(n){t.super_=n;var r=function(){};r.prototype=n.prototype,t.prototype=new r,t.prototype.constructor=t}}),eC.exports}var WI,t9;function n2e(){if(t9)return WI;t9=1;var e=lD().Buffer;function t(n,r){this._block=e.alloc(n),this._finalSize=r,this._blockSize=n,this._len=0}return t.prototype.update=function(n,r){typeof n=="string"&&(r=r||"utf8",n=e.from(n,r));for(var s=this._block,i=this._blockSize,a=n.length,o=this._len,l=0;l<a;){for(var c=o%i,u=Math.min(a-l,i-c),d=0;d<u;d++)s[c+d]=n[l+d];o+=u,l+=u,o%i===0&&this._update(s)}return this._len+=a,this},t.prototype.digest=function(n){var r=this._len%this._blockSize;this._block[r]=128,this._block.fill(0,r+1),r>=this._finalSize&&(this._update(this._block),this._block.fill(0));var s=this._len*8;if(s<=4294967295)this._block.writeUInt32BE(s,this._blockSize-4);else{var i=(s&4294967295)>>>0,a=(s-i)/4294967296;this._block.writeUInt32BE(a,this._blockSize-8),this._block.writeUInt32BE(i,this._blockSize-4)}this._update(this._block);var o=this._hash();return n?o.toString(n):o},t.prototype._update=function(){throw new Error("_update must be implemented by subclass")},WI=t,WI}var HI,n9;function r2e(){if(n9)return HI;n9=1;var e=t2e(),t=n2e(),n=lD().Buffer,r=[1518500249,1859775393,-1894007588,-899497514],s=new Array(80);function i(){this.init(),this._w=s,t.call(this,64,56)}e(i,t),i.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this};function a(u){return u<<1|u>>>31}function o(u){return u<<5|u>>>27}function l(u){return u<<30|u>>>2}function c(u,d,h,m){return u===0?d&h|~d&m:u===2?d&h|d&m|h&m:d^h^m}return i.prototype._update=function(u){for(var d=this._w,h=this._a|0,m=this._b|0,y=this._c|0,b=this._d|0,v=this._e|0,x=0;x<16;++x)d[x]=u.readInt32BE(x*4);for(;x<80;++x)d[x]=a(d[x-3]^d[x-8]^d[x-14]^d[x-16]);for(var w=0;w<80;++w){var _=~~(w/20),k=o(h)+c(_,m,y,b)+v+d[w]+r[_]|0;v=b,b=y,y=l(m),m=h,h=k}this._a=h+this._a|0,this._b=m+this._b|0,this._c=y+this._c|0,this._d=b+this._d|0,this._e=v+this._e|0},i.prototype._hash=function(){var u=n.allocUnsafe(20);return u.writeInt32BE(this._a|0,0),u.writeInt32BE(this._b|0,4),u.writeInt32BE(this._c|0,8),u.writeInt32BE(this._d|0,12),u.writeInt32BE(this._e|0,16),u},HI=i,HI}var s2e=r2e();const JY=ga(s2e);var GI,r9;function i2e(){if(r9)return GI;r9=1;function e(s){if(typeof s!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(s))}function t(s,i){for(var a="",o=0,l=-1,c=0,u,d=0;d<=s.length;++d){if(d<s.length)u=s.charCodeAt(d);else{if(u===47)break;u=47}if(u===47){if(!(l===d-1||c===1))if(l!==d-1&&c===2){if(a.length<2||o!==2||a.charCodeAt(a.length-1)!==46||a.charCodeAt(a.length-2)!==46){if(a.length>2){var h=a.lastIndexOf("/");if(h!==a.length-1){h===-1?(a="",o=0):(a=a.slice(0,h),o=a.length-1-a.lastIndexOf("/")),l=d,c=0;continue}}else if(a.length===2||a.length===1){a="",o=0,l=d,c=0;continue}}i&&(a.length>0?a+="/..":a="..",o=2)}else a.length>0?a+="/"+s.slice(l+1,d):a=s.slice(l+1,d),o=d-l-1;l=d,c=0}else u===46&&c!==-1?++c:c=-1}return a}function n(s,i){var a=i.dir||i.root,o=i.base||(i.name||"")+(i.ext||"");return a?a===i.root?a+o:a+s+o:o}var r={resolve:function(){for(var i="",a=!1,o,l=arguments.length-1;l>=-1&&!a;l--){var c;l>=0?c=arguments[l]:(o===void 0&&(o=Di.cwd()),c=o),e(c),c.length!==0&&(i=c+"/"+i,a=c.charCodeAt(0)===47)}return i=t(i,!a),a?i.length>0?"/"+i:"/":i.length>0?i:"."},normalize:function(i){if(e(i),i.length===0)return".";var a=i.charCodeAt(0)===47,o=i.charCodeAt(i.length-1)===47;return i=t(i,!a),i.length===0&&!a&&(i="."),i.length>0&&o&&(i+="/"),a?"/"+i:i},isAbsolute:function(i){return e(i),i.length>0&&i.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var i,a=0;a<arguments.length;++a){var o=arguments[a];e(o),o.length>0&&(i===void 0?i=o:i+="/"+o)}return i===void 0?".":r.normalize(i)},relative:function(i,a){if(e(i),e(a),i===a||(i=r.resolve(i),a=r.resolve(a),i===a))return"";for(var o=1;o<i.length&&i.charCodeAt(o)===47;++o);for(var l=i.length,c=l-o,u=1;u<a.length&&a.charCodeAt(u)===47;++u);for(var d=a.length,h=d-u,m=c<h?c:h,y=-1,b=0;b<=m;++b){if(b===m){if(h>m){if(a.charCodeAt(u+b)===47)return a.slice(u+b+1);if(b===0)return a.slice(u+b)}else c>m&&(i.charCodeAt(o+b)===47?y=b:b===0&&(y=0));break}var v=i.charCodeAt(o+b),x=a.charCodeAt(u+b);if(v!==x)break;v===47&&(y=b)}var w="";for(b=o+y+1;b<=l;++b)(b===l||i.charCodeAt(b)===47)&&(w.length===0?w+="..":w+="/..");return w.length>0?w+a.slice(u+y):(u+=y,a.charCodeAt(u)===47&&++u,a.slice(u))},_makeLong:function(i){return i},dirname:function(i){if(e(i),i.length===0)return".";for(var a=i.charCodeAt(0),o=a===47,l=-1,c=!0,u=i.length-1;u>=1;--u)if(a=i.charCodeAt(u),a===47){if(!c){l=u;break}}else c=!1;return l===-1?o?"/":".":o&&l===1?"//":i.slice(0,l)},basename:function(i,a){if(a!==void 0&&typeof a!="string")throw new TypeError('"ext" argument must be a string');e(i);var o=0,l=-1,c=!0,u;if(a!==void 0&&a.length>0&&a.length<=i.length){if(a.length===i.length&&a===i)return"";var d=a.length-1,h=-1;for(u=i.length-1;u>=0;--u){var m=i.charCodeAt(u);if(m===47){if(!c){o=u+1;break}}else h===-1&&(c=!1,h=u+1),d>=0&&(m===a.charCodeAt(d)?--d===-1&&(l=u):(d=-1,l=h))}return o===l?l=h:l===-1&&(l=i.length),i.slice(o,l)}else{for(u=i.length-1;u>=0;--u)if(i.charCodeAt(u)===47){if(!c){o=u+1;break}}else l===-1&&(c=!1,l=u+1);return l===-1?"":i.slice(o,l)}},extname:function(i){e(i);for(var a=-1,o=0,l=-1,c=!0,u=0,d=i.length-1;d>=0;--d){var h=i.charCodeAt(d);if(h===47){if(!c){o=d+1;break}continue}l===-1&&(c=!1,l=d+1),h===46?a===-1?a=d:u!==1&&(u=1):a!==-1&&(u=-1)}return a===-1||l===-1||u===0||u===1&&a===l-1&&a===o+1?"":i.slice(a,l)},format:function(i){if(i===null||typeof i!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof i);return n("/",i)},parse:function(i){e(i);var a={root:"",dir:"",base:"",ext:"",name:""};if(i.length===0)return a;var o=i.charCodeAt(0),l=o===47,c;l?(a.root="/",c=1):c=0;for(var u=-1,d=0,h=-1,m=!0,y=i.length-1,b=0;y>=c;--y){if(o=i.charCodeAt(y),o===47){if(!m){d=y+1;break}continue}h===-1&&(m=!1,h=y+1),o===46?u===-1?u=y:b!==1&&(b=1):u!==-1&&(b=-1)}return u===-1||h===-1||b===0||b===1&&u===h-1&&u===d+1?h!==-1&&(d===0&&l?a.base=a.name=i.slice(1,h):a.base=a.name=i.slice(d,h)):(d===0&&l?(a.name=i.slice(1,u),a.base=i.slice(1,h)):(a.name=i.slice(d,u),a.base=i.slice(d,h)),a.ext=i.slice(u,h)),d>0?a.dir=i.slice(0,d-1):l&&(a.dir="/"),a},sep:"/",delimiter:":",win32:null,posix:null};return r.posix=r,GI=r,GI}var zt=i2e(),KI={};/*! crc32.js (C) 2014-present SheetJS -- http://sheetjs.com */var s9;function a2e(){return s9||(s9=1,function(e){(function(t){t(typeof DO_NOT_EXPORT_CRC>"u"?e:{})})(function(t){t.version="1.2.2";function n(){for(var N=0,I=new Array(256),j=0;j!=256;++j)N=j,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,I[j]=N;return typeof Int32Array<"u"?new Int32Array(I):I}var r=n();function s(N){var I=0,j=0,L=0,D=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(L=0;L!=256;++L)D[L]=N[L];for(L=0;L!=256;++L)for(j=N[L],I=256+L;I<4096;I+=256)j=D[I]=j>>>8^N[j&255];var H=[];for(L=1;L!=16;++L)H[L-1]=typeof Int32Array<"u"?D.subarray(L*256,L*256+256):D.slice(L*256,L*256+256);return H}var i=s(r),a=i[0],o=i[1],l=i[2],c=i[3],u=i[4],d=i[5],h=i[6],m=i[7],y=i[8],b=i[9],v=i[10],x=i[11],w=i[12],_=i[13],k=i[14];function C(N,I){for(var j=I^-1,L=0,D=N.length;L<D;)j=j>>>8^r[(j^N.charCodeAt(L++))&255];return~j}function T(N,I){for(var j=I^-1,L=N.length-15,D=0;D<L;)j=k[N[D++]^j&255]^_[N[D++]^j>>8&255]^w[N[D++]^j>>16&255]^x[N[D++]^j>>>24]^v[N[D++]]^b[N[D++]]^y[N[D++]]^m[N[D++]]^h[N[D++]]^d[N[D++]]^u[N[D++]]^c[N[D++]]^l[N[D++]]^o[N[D++]]^a[N[D++]]^r[N[D++]];for(L+=15;D<L;)j=j>>>8^r[(j^N[D++])&255];return~j}function A(N,I){for(var j=I^-1,L=0,D=N.length,H=0,O=0;L<D;)H=N.charCodeAt(L++),H<128?j=j>>>8^r[(j^H)&255]:H<2048?(j=j>>>8^r[(j^(192|H>>6&31))&255],j=j>>>8^r[(j^(128|H&63))&255]):H>=55296&&H<57344?(H=(H&1023)+64,O=N.charCodeAt(L++)&1023,j=j>>>8^r[(j^(240|H>>8&7))&255],j=j>>>8^r[(j^(128|H>>2&63))&255],j=j>>>8^r[(j^(128|O>>6&15|(H&3)<<4))&255],j=j>>>8^r[(j^(128|O&63))&255]):(j=j>>>8^r[(j^(224|H>>12&15))&255],j=j>>>8^r[(j^(128|H>>6&63))&255],j=j>>>8^r[(j^(128|H&63))&255]);return~j}t.table=r,t.bstr=C,t.buf=T,t.str=A})}(KI)),KI}var o2e=a2e();const l2e=ga(o2e);var YI={},i9;function up(){return i9||(i9=1,function(e){var t=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";function n(i,a){return Object.prototype.hasOwnProperty.call(i,a)}e.assign=function(i){for(var a=Array.prototype.slice.call(arguments,1);a.length;){var o=a.shift();if(o){if(typeof o!="object")throw new TypeError(o+"must be non-object");for(var l in o)n(o,l)&&(i[l]=o[l])}}return i},e.shrinkBuf=function(i,a){return i.length===a?i:i.subarray?i.subarray(0,a):(i.length=a,i)};var r={arraySet:function(i,a,o,l,c){if(a.subarray&&i.subarray){i.set(a.subarray(o,o+l),c);return}for(var u=0;u<l;u++)i[c+u]=a[o+u]},flattenChunks:function(i){var a,o,l,c,u,d;for(l=0,a=0,o=i.length;a<o;a++)l+=i[a].length;for(d=new Uint8Array(l),c=0,a=0,o=i.length;a<o;a++)u=i[a],d.set(u,c),c+=u.length;return d}},s={arraySet:function(i,a,o,l,c){for(var u=0;u<l;u++)i[c+u]=a[o+u]},flattenChunks:function(i){return[].concat.apply([],i)}};e.setTyped=function(i){i?(e.Buf8=Uint8Array,e.Buf16=Uint16Array,e.Buf32=Int32Array,e.assign(e,r)):(e.Buf8=Array,e.Buf16=Array,e.Buf32=Array,e.assign(e,s))},e.setTyped(t)}(YI)),YI}var u0={},Cc={},Kp={},a9;function c2e(){if(a9)return Kp;a9=1;var e=up(),t=4,n=0,r=1,s=2;function i(F){for(var X=F.length;--X>=0;)F[X]=0}var a=0,o=1,l=2,c=3,u=258,d=29,h=256,m=h+1+d,y=30,b=19,v=2*m+1,x=15,w=16,_=7,k=256,C=16,T=17,A=18,N=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],I=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],j=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],L=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],D=512,H=new Array((m+2)*2);i(H);var O=new Array(y*2);i(O);var K=new Array(D);i(K);var U=new Array(u-c+1);i(U);var W=new Array(d);i(W);var B=new Array(y);i(B);function ne(F,X,be,Ee,ge){this.static_tree=F,this.extra_bits=X,this.extra_base=be,this.elems=Ee,this.max_length=ge,this.has_stree=F&&F.length}var V,Q,ee;function re(F,X){this.dyn_tree=F,this.max_code=0,this.stat_desc=X}function de(F){return F<256?K[F]:K[256+(F>>>7)]}function me(F,X){F.pending_buf[F.pending++]=X&255,F.pending_buf[F.pending++]=X>>>8&255}function De(F,X,be){F.bi_valid>w-be?(F.bi_buf|=X<<F.bi_valid&65535,me(F,F.bi_buf),F.bi_buf=X>>w-F.bi_valid,F.bi_valid+=be-w):(F.bi_buf|=X<<F.bi_valid&65535,F.bi_valid+=be)}function je(F,X,be){De(F,be[X*2],be[X*2+1])}function Te(F,X){var be=0;do be|=F&1,F>>>=1,be<<=1;while(--X>0);return be>>>1}function _e(F){F.bi_valid===16?(me(F,F.bi_buf),F.bi_buf=0,F.bi_valid=0):F.bi_valid>=8&&(F.pending_buf[F.pending++]=F.bi_buf&255,F.bi_buf>>=8,F.bi_valid-=8)}function Ue(F,X){var be=X.dyn_tree,Ee=X.max_code,ge=X.stat_desc.static_tree,Ae=X.stat_desc.has_stree,le=X.stat_desc.extra_bits,ft=X.stat_desc.extra_base,et=X.stat_desc.max_length,$,qe,tt,ve,Se,ze,Ct=0;for(ve=0;ve<=x;ve++)F.bl_count[ve]=0;for(be[F.heap[F.heap_max]*2+1]=0,$=F.heap_max+1;$<v;$++)qe=F.heap[$],ve=be[be[qe*2+1]*2+1]+1,ve>et&&(ve=et,Ct++),be[qe*2+1]=ve,!(qe>Ee)&&(F.bl_count[ve]++,Se=0,qe>=ft&&(Se=le[qe-ft]),ze=be[qe*2],F.opt_len+=ze*(ve+Se),Ae&&(F.static_len+=ze*(ge[qe*2+1]+Se)));if(Ct!==0){do{for(ve=et-1;F.bl_count[ve]===0;)ve--;F.bl_count[ve]--,F.bl_count[ve+1]+=2,F.bl_count[et]--,Ct-=2}while(Ct>0);for(ve=et;ve!==0;ve--)for(qe=F.bl_count[ve];qe!==0;)tt=F.heap[--$],!(tt>Ee)&&(be[tt*2+1]!==ve&&(F.opt_len+=(ve-be[tt*2+1])*be[tt*2],be[tt*2+1]=ve),qe--)}}function Qe(F,X,be){var Ee=new Array(x+1),ge=0,Ae,le;for(Ae=1;Ae<=x;Ae++)Ee[Ae]=ge=ge+be[Ae-1]<<1;for(le=0;le<=X;le++){var ft=F[le*2+1];ft!==0&&(F[le*2]=Te(Ee[ft]++,ft))}}function We(){var F,X,be,Ee,ge,Ae=new Array(x+1);for(be=0,Ee=0;Ee<d-1;Ee++)for(W[Ee]=be,F=0;F<1<<N[Ee];F++)U[be++]=Ee;for(U[be-1]=Ee,ge=0,Ee=0;Ee<16;Ee++)for(B[Ee]=ge,F=0;F<1<<I[Ee];F++)K[ge++]=Ee;for(ge>>=7;Ee<y;Ee++)for(B[Ee]=ge<<7,F=0;F<1<<I[Ee]-7;F++)K[256+ge++]=Ee;for(X=0;X<=x;X++)Ae[X]=0;for(F=0;F<=143;)H[F*2+1]=8,F++,Ae[8]++;for(;F<=255;)H[F*2+1]=9,F++,Ae[9]++;for(;F<=279;)H[F*2+1]=7,F++,Ae[7]++;for(;F<=287;)H[F*2+1]=8,F++,Ae[8]++;for(Qe(H,m+1,Ae),F=0;F<y;F++)O[F*2+1]=5,O[F*2]=Te(F,5);V=new ne(H,N,h+1,m,x),Q=new ne(O,I,0,y,x),ee=new ne(new Array(0),j,0,b,_)}function Pe(F){var X;for(X=0;X<m;X++)F.dyn_ltree[X*2]=0;for(X=0;X<y;X++)F.dyn_dtree[X*2]=0;for(X=0;X<b;X++)F.bl_tree[X*2]=0;F.dyn_ltree[k*2]=1,F.opt_len=F.static_len=0,F.last_lit=F.matches=0}function Y(F){F.bi_valid>8?me(F,F.bi_buf):F.bi_valid>0&&(F.pending_buf[F.pending++]=F.bi_buf),F.bi_buf=0,F.bi_valid=0}function ye(F,X,be,Ee){Y(F),me(F,be),me(F,~be),e.arraySet(F.pending_buf,F.window,X,be,F.pending),F.pending+=be}function Me(F,X,be,Ee){var ge=X*2,Ae=be*2;return F[ge]<F[Ae]||F[ge]===F[Ae]&&Ee[X]<=Ee[be]}function ue(F,X,be){for(var Ee=F.heap[be],ge=be<<1;ge<=F.heap_len&&(ge<F.heap_len&&Me(X,F.heap[ge+1],F.heap[ge],F.depth)&&ge++,!Me(X,Ee,F.heap[ge],F.depth));)F.heap[be]=F.heap[ge],be=ge,ge<<=1;F.heap[be]=Ee}function oe(F,X,be){var Ee,ge,Ae=0,le,ft;if(F.last_lit!==0)do Ee=F.pending_buf[F.d_buf+Ae*2]<<8|F.pending_buf[F.d_buf+Ae*2+1],ge=F.pending_buf[F.l_buf+Ae],Ae++,Ee===0?je(F,ge,X):(le=U[ge],je(F,le+h+1,X),ft=N[le],ft!==0&&(ge-=W[le],De(F,ge,ft)),Ee--,le=de(Ee),je(F,le,be),ft=I[le],ft!==0&&(Ee-=B[le],De(F,Ee,ft)));while(Ae<F.last_lit);je(F,k,X)}function se(F,X){var be=X.dyn_tree,Ee=X.stat_desc.static_tree,ge=X.stat_desc.has_stree,Ae=X.stat_desc.elems,le,ft,et=-1,$;for(F.heap_len=0,F.heap_max=v,le=0;le<Ae;le++)be[le*2]!==0?(F.heap[++F.heap_len]=et=le,F.depth[le]=0):be[le*2+1]=0;for(;F.heap_len<2;)$=F.heap[++F.heap_len]=et<2?++et:0,be[$*2]=1,F.depth[$]=0,F.opt_len--,ge&&(F.static_len-=Ee[$*2+1]);for(X.max_code=et,le=F.heap_len>>1;le>=1;le--)ue(F,be,le);$=Ae;do le=F.heap[1],F.heap[1]=F.heap[F.heap_len--],ue(F,be,1),ft=F.heap[1],F.heap[--F.heap_max]=le,F.heap[--F.heap_max]=ft,be[$*2]=be[le*2]+be[ft*2],F.depth[$]=(F.depth[le]>=F.depth[ft]?F.depth[le]:F.depth[ft])+1,be[le*2+1]=be[ft*2+1]=$,F.heap[1]=$++,ue(F,be,1);while(F.heap_len>=2);F.heap[--F.heap_max]=F.heap[1],Ue(F,X),Qe(be,et,F.bl_count)}function Ie(F,X,be){var Ee,ge=-1,Ae,le=X[0*2+1],ft=0,et=7,$=4;for(le===0&&(et=138,$=3),X[(be+1)*2+1]=65535,Ee=0;Ee<=be;Ee++)Ae=le,le=X[(Ee+1)*2+1],!(++ft<et&&Ae===le)&&(ft<$?F.bl_tree[Ae*2]+=ft:Ae!==0?(Ae!==ge&&F.bl_tree[Ae*2]++,F.bl_tree[C*2]++):ft<=10?F.bl_tree[T*2]++:F.bl_tree[A*2]++,ft=0,ge=Ae,le===0?(et=138,$=3):Ae===le?(et=6,$=3):(et=7,$=4))}function Be(F,X,be){var Ee,ge=-1,Ae,le=X[0*2+1],ft=0,et=7,$=4;for(le===0&&(et=138,$=3),Ee=0;Ee<=be;Ee++)if(Ae=le,le=X[(Ee+1)*2+1],!(++ft<et&&Ae===le)){if(ft<$)do je(F,Ae,F.bl_tree);while(--ft!==0);else Ae!==0?(Ae!==ge&&(je(F,Ae,F.bl_tree),ft--),je(F,C,F.bl_tree),De(F,ft-3,2)):ft<=10?(je(F,T,F.bl_tree),De(F,ft-3,3)):(je(F,A,F.bl_tree),De(F,ft-11,7));ft=0,ge=Ae,le===0?(et=138,$=3):Ae===le?(et=6,$=3):(et=7,$=4)}}function Re(F){var X;for(Ie(F,F.dyn_ltree,F.l_desc.max_code),Ie(F,F.dyn_dtree,F.d_desc.max_code),se(F,F.bl_desc),X=b-1;X>=3&&F.bl_tree[L[X]*2+1]===0;X--);return F.opt_len+=3*(X+1)+5+5+4,X}function ct(F,X,be,Ee){var ge;for(De(F,X-257,5),De(F,be-1,5),De(F,Ee-4,4),ge=0;ge<Ee;ge++)De(F,F.bl_tree[L[ge]*2+1],3);Be(F,F.dyn_ltree,X-1),Be(F,F.dyn_dtree,be-1)}function At(F){var X=4093624447,be;for(be=0;be<=31;be++,X>>>=1)if(X&1&&F.dyn_ltree[be*2]!==0)return n;if(F.dyn_ltree[9*2]!==0||F.dyn_ltree[10*2]!==0||F.dyn_ltree[13*2]!==0)return r;for(be=32;be<h;be++)if(F.dyn_ltree[be*2]!==0)return r;return n}var ut=!1;function Pt(F){ut||(We(),ut=!0),F.l_desc=new re(F.dyn_ltree,V),F.d_desc=new re(F.dyn_dtree,Q),F.bl_desc=new re(F.bl_tree,ee),F.bi_buf=0,F.bi_valid=0,Pe(F)}function Ut(F,X,be,Ee){De(F,(a<<1)+(Ee?1:0),3),ye(F,X,be)}function Ft(F){De(F,o<<1,3),je(F,k,H),_e(F)}function Yt(F,X,be,Ee){var ge,Ae,le=0;F.level>0?(F.strm.data_type===s&&(F.strm.data_type=At(F)),se(F,F.l_desc),se(F,F.d_desc),le=Re(F),ge=F.opt_len+3+7>>>3,Ae=F.static_len+3+7>>>3,Ae<=ge&&(ge=Ae)):ge=Ae=be+5,be+4<=ge&&X!==-1?Ut(F,X,be,Ee):F.strategy===t||Ae===ge?(De(F,(o<<1)+(Ee?1:0),3),oe(F,H,O)):(De(F,(l<<1)+(Ee?1:0),3),ct(F,F.l_desc.max_code+1,F.d_desc.max_code+1,le+1),oe(F,F.dyn_ltree,F.dyn_dtree)),Pe(F),Ee&&Y(F)}function we(F,X,be){return F.pending_buf[F.d_buf+F.last_lit*2]=X>>>8&255,F.pending_buf[F.d_buf+F.last_lit*2+1]=X&255,F.pending_buf[F.l_buf+F.last_lit]=be&255,F.last_lit++,X===0?F.dyn_ltree[be*2]++:(F.matches++,X--,F.dyn_ltree[(U[be]+h+1)*2]++,F.dyn_dtree[de(X)*2]++),F.last_lit===F.lit_bufsize-1}return Kp._tr_init=Pt,Kp._tr_stored_block=Ut,Kp._tr_flush_block=Yt,Kp._tr_tally=we,Kp._tr_align=Ft,Kp}var ZI,o9;function QY(){if(o9)return ZI;o9=1;function e(t,n,r,s){for(var i=t&65535|0,a=t>>>16&65535|0,o=0;r!==0;){o=r>2e3?2e3:r,r-=o;do i=i+n[s++]|0,a=a+i|0;while(--o);i%=65521,a%=65521}return i|a<<16|0}return ZI=e,ZI}var XI,l9;function eZ(){if(l9)return XI;l9=1;function e(){for(var r,s=[],i=0;i<256;i++){r=i;for(var a=0;a<8;a++)r=r&1?3988292384^r>>>1:r>>>1;s[i]=r}return s}var t=e();function n(r,s,i,a){var o=t,l=a+i;r^=-1;for(var c=a;c<l;c++)r=r>>>8^o[(r^s[c])&255];return r^-1}return XI=n,XI}var JI,c9;function xD(){return c9||(c9=1,JI={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}),JI}var u9;function u2e(){if(u9)return Cc;u9=1;var e=up(),t=c2e(),n=QY(),r=eZ(),s=xD(),i=0,a=1,o=3,l=4,c=5,u=0,d=1,h=-2,m=-3,y=-5,b=-1,v=1,x=2,w=3,_=4,k=0,C=2,T=8,A=9,N=15,I=8,j=29,L=256,D=L+1+j,H=30,O=19,K=2*D+1,U=15,W=3,B=258,ne=B+W+1,V=32,Q=42,ee=69,re=73,de=91,me=103,De=113,je=666,Te=1,_e=2,Ue=3,Qe=4,We=3;function Pe($,qe){return $.msg=s[qe],qe}function Y($){return($<<1)-($>4?9:0)}function ye($){for(var qe=$.length;--qe>=0;)$[qe]=0}function Me($){var qe=$.state,tt=qe.pending;tt>$.avail_out&&(tt=$.avail_out),tt!==0&&(e.arraySet($.output,qe.pending_buf,qe.pending_out,tt,$.next_out),$.next_out+=tt,qe.pending_out+=tt,$.total_out+=tt,$.avail_out-=tt,qe.pending-=tt,qe.pending===0&&(qe.pending_out=0))}function ue($,qe){t._tr_flush_block($,$.block_start>=0?$.block_start:-1,$.strstart-$.block_start,qe),$.block_start=$.strstart,Me($.strm)}function oe($,qe){$.pending_buf[$.pending++]=qe}function se($,qe){$.pending_buf[$.pending++]=qe>>>8&255,$.pending_buf[$.pending++]=qe&255}function Ie($,qe,tt,ve){var Se=$.avail_in;return Se>ve&&(Se=ve),Se===0?0:($.avail_in-=Se,e.arraySet(qe,$.input,$.next_in,Se,tt),$.state.wrap===1?$.adler=n($.adler,qe,Se,tt):$.state.wrap===2&&($.adler=r($.adler,qe,Se,tt)),$.next_in+=Se,$.total_in+=Se,Se)}function Be($,qe){var tt=$.max_chain_length,ve=$.strstart,Se,ze,Ct=$.prev_length,fe=$.nice_match,Z=$.strstart>$.w_size-ne?$.strstart-($.w_size-ne):0,G=$.window,J=$.w_mask,xe=$.prev,Fe=$.strstart+B,He=G[ve+Ct-1],wt=G[ve+Ct];$.prev_length>=$.good_match&&(tt>>=2),fe>$.lookahead&&(fe=$.lookahead);do if(Se=qe,!(G[Se+Ct]!==wt||G[Se+Ct-1]!==He||G[Se]!==G[ve]||G[++Se]!==G[ve+1])){ve+=2,Se++;do;while(G[++ve]===G[++Se]&&G[++ve]===G[++Se]&&G[++ve]===G[++Se]&&G[++ve]===G[++Se]&&G[++ve]===G[++Se]&&G[++ve]===G[++Se]&&G[++ve]===G[++Se]&&G[++ve]===G[++Se]&&ve<Fe);if(ze=B-(Fe-ve),ve=Fe-B,ze>Ct){if($.match_start=qe,Ct=ze,ze>=fe)break;He=G[ve+Ct-1],wt=G[ve+Ct]}}while((qe=xe[qe&J])>Z&&--tt!==0);return Ct<=$.lookahead?Ct:$.lookahead}function Re($){var qe=$.w_size,tt,ve,Se,ze,Ct;do{if(ze=$.window_size-$.lookahead-$.strstart,$.strstart>=qe+(qe-ne)){e.arraySet($.window,$.window,qe,qe,0),$.match_start-=qe,$.strstart-=qe,$.block_start-=qe,ve=$.hash_size,tt=ve;do Se=$.head[--tt],$.head[tt]=Se>=qe?Se-qe:0;while(--ve);ve=qe,tt=ve;do Se=$.prev[--tt],$.prev[tt]=Se>=qe?Se-qe:0;while(--ve);ze+=qe}if($.strm.avail_in===0)break;if(ve=Ie($.strm,$.window,$.strstart+$.lookahead,ze),$.lookahead+=ve,$.lookahead+$.insert>=W)for(Ct=$.strstart-$.insert,$.ins_h=$.window[Ct],$.ins_h=($.ins_h<<$.hash_shift^$.window[Ct+1])&$.hash_mask;$.insert&&($.ins_h=($.ins_h<<$.hash_shift^$.window[Ct+W-1])&$.hash_mask,$.prev[Ct&$.w_mask]=$.head[$.ins_h],$.head[$.ins_h]=Ct,Ct++,$.insert--,!($.lookahead+$.insert<W)););}while($.lookahead<ne&&$.strm.avail_in!==0)}function ct($,qe){var tt=65535;for(tt>$.pending_buf_size-5&&(tt=$.pending_buf_size-5);;){if($.lookahead<=1){if(Re($),$.lookahead===0&&qe===i)return Te;if($.lookahead===0)break}$.strstart+=$.lookahead,$.lookahead=0;var ve=$.block_start+tt;if(($.strstart===0||$.strstart>=ve)&&($.lookahead=$.strstart-ve,$.strstart=ve,ue($,!1),$.strm.avail_out===0)||$.strstart-$.block_start>=$.w_size-ne&&(ue($,!1),$.strm.avail_out===0))return Te}return $.insert=0,qe===l?(ue($,!0),$.strm.avail_out===0?Ue:Qe):($.strstart>$.block_start&&(ue($,!1),$.strm.avail_out===0),Te)}function At($,qe){for(var tt,ve;;){if($.lookahead<ne){if(Re($),$.lookahead<ne&&qe===i)return Te;if($.lookahead===0)break}if(tt=0,$.lookahead>=W&&($.ins_h=($.ins_h<<$.hash_shift^$.window[$.strstart+W-1])&$.hash_mask,tt=$.prev[$.strstart&$.w_mask]=$.head[$.ins_h],$.head[$.ins_h]=$.strstart),tt!==0&&$.strstart-tt<=$.w_size-ne&&($.match_length=Be($,tt)),$.match_length>=W)if(ve=t._tr_tally($,$.strstart-$.match_start,$.match_length-W),$.lookahead-=$.match_length,$.match_length<=$.max_lazy_match&&$.lookahead>=W){$.match_length--;do $.strstart++,$.ins_h=($.ins_h<<$.hash_shift^$.window[$.strstart+W-1])&$.hash_mask,tt=$.prev[$.strstart&$.w_mask]=$.head[$.ins_h],$.head[$.ins_h]=$.strstart;while(--$.match_length!==0);$.strstart++}else $.strstart+=$.match_length,$.match_length=0,$.ins_h=$.window[$.strstart],$.ins_h=($.ins_h<<$.hash_shift^$.window[$.strstart+1])&$.hash_mask;else ve=t._tr_tally($,0,$.window[$.strstart]),$.lookahead--,$.strstart++;if(ve&&(ue($,!1),$.strm.avail_out===0))return Te}return $.insert=$.strstart<W-1?$.strstart:W-1,qe===l?(ue($,!0),$.strm.avail_out===0?Ue:Qe):$.last_lit&&(ue($,!1),$.strm.avail_out===0)?Te:_e}function ut($,qe){for(var tt,ve,Se;;){if($.lookahead<ne){if(Re($),$.lookahead<ne&&qe===i)return Te;if($.lookahead===0)break}if(tt=0,$.lookahead>=W&&($.ins_h=($.ins_h<<$.hash_shift^$.window[$.strstart+W-1])&$.hash_mask,tt=$.prev[$.strstart&$.w_mask]=$.head[$.ins_h],$.head[$.ins_h]=$.strstart),$.prev_length=$.match_length,$.prev_match=$.match_start,$.match_length=W-1,tt!==0&&$.prev_length<$.max_lazy_match&&$.strstart-tt<=$.w_size-ne&&($.match_length=Be($,tt),$.match_length<=5&&($.strategy===v||$.match_length===W&&$.strstart-$.match_start>4096)&&($.match_length=W-1)),$.prev_length>=W&&$.match_length<=$.prev_length){Se=$.strstart+$.lookahead-W,ve=t._tr_tally($,$.strstart-1-$.prev_match,$.prev_length-W),$.lookahead-=$.prev_length-1,$.prev_length-=2;do++$.strstart<=Se&&($.ins_h=($.ins_h<<$.hash_shift^$.window[$.strstart+W-1])&$.hash_mask,tt=$.prev[$.strstart&$.w_mask]=$.head[$.ins_h],$.head[$.ins_h]=$.strstart);while(--$.prev_length!==0);if($.match_available=0,$.match_length=W-1,$.strstart++,ve&&(ue($,!1),$.strm.avail_out===0))return Te}else if($.match_available){if(ve=t._tr_tally($,0,$.window[$.strstart-1]),ve&&ue($,!1),$.strstart++,$.lookahead--,$.strm.avail_out===0)return Te}else $.match_available=1,$.strstart++,$.lookahead--}return $.match_available&&(ve=t._tr_tally($,0,$.window[$.strstart-1]),$.match_available=0),$.insert=$.strstart<W-1?$.strstart:W-1,qe===l?(ue($,!0),$.strm.avail_out===0?Ue:Qe):$.last_lit&&(ue($,!1),$.strm.avail_out===0)?Te:_e}function Pt($,qe){for(var tt,ve,Se,ze,Ct=$.window;;){if($.lookahead<=B){if(Re($),$.lookahead<=B&&qe===i)return Te;if($.lookahead===0)break}if($.match_length=0,$.lookahead>=W&&$.strstart>0&&(Se=$.strstart-1,ve=Ct[Se],ve===Ct[++Se]&&ve===Ct[++Se]&&ve===Ct[++Se])){ze=$.strstart+B;do;while(ve===Ct[++Se]&&ve===Ct[++Se]&&ve===Ct[++Se]&&ve===Ct[++Se]&&ve===Ct[++Se]&&ve===Ct[++Se]&&ve===Ct[++Se]&&ve===Ct[++Se]&&Se<ze);$.match_length=B-(ze-Se),$.match_length>$.lookahead&&($.match_length=$.lookahead)}if($.match_length>=W?(tt=t._tr_tally($,1,$.match_length-W),$.lookahead-=$.match_length,$.strstart+=$.match_length,$.match_length=0):(tt=t._tr_tally($,0,$.window[$.strstart]),$.lookahead--,$.strstart++),tt&&(ue($,!1),$.strm.avail_out===0))return Te}return $.insert=0,qe===l?(ue($,!0),$.strm.avail_out===0?Ue:Qe):$.last_lit&&(ue($,!1),$.strm.avail_out===0)?Te:_e}function Ut($,qe){for(var tt;;){if($.lookahead===0&&(Re($),$.lookahead===0)){if(qe===i)return Te;break}if($.match_length=0,tt=t._tr_tally($,0,$.window[$.strstart]),$.lookahead--,$.strstart++,tt&&(ue($,!1),$.strm.avail_out===0))return Te}return $.insert=0,qe===l?(ue($,!0),$.strm.avail_out===0?Ue:Qe):$.last_lit&&(ue($,!1),$.strm.avail_out===0)?Te:_e}function Ft($,qe,tt,ve,Se){this.good_length=$,this.max_lazy=qe,this.nice_length=tt,this.max_chain=ve,this.func=Se}var Yt;Yt=[new Ft(0,0,0,0,ct),new Ft(4,4,8,4,At),new Ft(4,5,16,8,At),new Ft(4,6,32,32,At),new Ft(4,4,16,16,ut),new Ft(8,16,32,32,ut),new Ft(8,16,128,128,ut),new Ft(8,32,128,256,ut),new Ft(32,128,258,1024,ut),new Ft(32,258,258,4096,ut)];function we($){$.window_size=2*$.w_size,ye($.head),$.max_lazy_match=Yt[$.level].max_lazy,$.good_match=Yt[$.level].good_length,$.nice_match=Yt[$.level].nice_length,$.max_chain_length=Yt[$.level].max_chain,$.strstart=0,$.block_start=0,$.lookahead=0,$.insert=0,$.match_length=$.prev_length=W-1,$.match_available=0,$.ins_h=0}function F(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=T,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new e.Buf16(K*2),this.dyn_dtree=new e.Buf16((2*H+1)*2),this.bl_tree=new e.Buf16((2*O+1)*2),ye(this.dyn_ltree),ye(this.dyn_dtree),ye(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new e.Buf16(U+1),this.heap=new e.Buf16(2*D+1),ye(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new e.Buf16(2*D+1),ye(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function X($){var qe;return!$||!$.state?Pe($,h):($.total_in=$.total_out=0,$.data_type=C,qe=$.state,qe.pending=0,qe.pending_out=0,qe.wrap<0&&(qe.wrap=-qe.wrap),qe.status=qe.wrap?Q:De,$.adler=qe.wrap===2?0:1,qe.last_flush=i,t._tr_init(qe),u)}function be($){var qe=X($);return qe===u&&we($.state),qe}function Ee($,qe){return!$||!$.state||$.state.wrap!==2?h:($.state.gzhead=qe,u)}function ge($,qe,tt,ve,Se,ze){if(!$)return h;var Ct=1;if(qe===b&&(qe=6),ve<0?(Ct=0,ve=-ve):ve>15&&(Ct=2,ve-=16),Se<1||Se>A||tt!==T||ve<8||ve>15||qe<0||qe>9||ze<0||ze>_)return Pe($,h);ve===8&&(ve=9);var fe=new F;return $.state=fe,fe.strm=$,fe.wrap=Ct,fe.gzhead=null,fe.w_bits=ve,fe.w_size=1<<fe.w_bits,fe.w_mask=fe.w_size-1,fe.hash_bits=Se+7,fe.hash_size=1<<fe.hash_bits,fe.hash_mask=fe.hash_size-1,fe.hash_shift=~~((fe.hash_bits+W-1)/W),fe.window=new e.Buf8(fe.w_size*2),fe.head=new e.Buf16(fe.hash_size),fe.prev=new e.Buf16(fe.w_size),fe.lit_bufsize=1<<Se+6,fe.pending_buf_size=fe.lit_bufsize*4,fe.pending_buf=new e.Buf8(fe.pending_buf_size),fe.d_buf=1*fe.lit_bufsize,fe.l_buf=3*fe.lit_bufsize,fe.level=qe,fe.strategy=ze,fe.method=tt,be($)}function Ae($,qe){return ge($,qe,T,N,I,k)}function le($,qe){var tt,ve,Se,ze;if(!$||!$.state||qe>c||qe<0)return $?Pe($,h):h;if(ve=$.state,!$.output||!$.input&&$.avail_in!==0||ve.status===je&&qe!==l)return Pe($,$.avail_out===0?y:h);if(ve.strm=$,tt=ve.last_flush,ve.last_flush=qe,ve.status===Q)if(ve.wrap===2)$.adler=0,oe(ve,31),oe(ve,139),oe(ve,8),ve.gzhead?(oe(ve,(ve.gzhead.text?1:0)+(ve.gzhead.hcrc?2:0)+(ve.gzhead.extra?4:0)+(ve.gzhead.name?8:0)+(ve.gzhead.comment?16:0)),oe(ve,ve.gzhead.time&255),oe(ve,ve.gzhead.time>>8&255),oe(ve,ve.gzhead.time>>16&255),oe(ve,ve.gzhead.time>>24&255),oe(ve,ve.level===9?2:ve.strategy>=x||ve.level<2?4:0),oe(ve,ve.gzhead.os&255),ve.gzhead.extra&&ve.gzhead.extra.length&&(oe(ve,ve.gzhead.extra.length&255),oe(ve,ve.gzhead.extra.length>>8&255)),ve.gzhead.hcrc&&($.adler=r($.adler,ve.pending_buf,ve.pending,0)),ve.gzindex=0,ve.status=ee):(oe(ve,0),oe(ve,0),oe(ve,0),oe(ve,0),oe(ve,0),oe(ve,ve.level===9?2:ve.strategy>=x||ve.level<2?4:0),oe(ve,We),ve.status=De);else{var Ct=T+(ve.w_bits-8<<4)<<8,fe=-1;ve.strategy>=x||ve.level<2?fe=0:ve.level<6?fe=1:ve.level===6?fe=2:fe=3,Ct|=fe<<6,ve.strstart!==0&&(Ct|=V),Ct+=31-Ct%31,ve.status=De,se(ve,Ct),ve.strstart!==0&&(se(ve,$.adler>>>16),se(ve,$.adler&65535)),$.adler=1}if(ve.status===ee)if(ve.gzhead.extra){for(Se=ve.pending;ve.gzindex<(ve.gzhead.extra.length&65535)&&!(ve.pending===ve.pending_buf_size&&(ve.gzhead.hcrc&&ve.pending>Se&&($.adler=r($.adler,ve.pending_buf,ve.pending-Se,Se)),Me($),Se=ve.pending,ve.pending===ve.pending_buf_size));)oe(ve,ve.gzhead.extra[ve.gzindex]&255),ve.gzindex++;ve.gzhead.hcrc&&ve.pending>Se&&($.adler=r($.adler,ve.pending_buf,ve.pending-Se,Se)),ve.gzindex===ve.gzhead.extra.length&&(ve.gzindex=0,ve.status=re)}else ve.status=re;if(ve.status===re)if(ve.gzhead.name){Se=ve.pending;do{if(ve.pending===ve.pending_buf_size&&(ve.gzhead.hcrc&&ve.pending>Se&&($.adler=r($.adler,ve.pending_buf,ve.pending-Se,Se)),Me($),Se=ve.pending,ve.pending===ve.pending_buf_size)){ze=1;break}ve.gzindex<ve.gzhead.name.length?ze=ve.gzhead.name.charCodeAt(ve.gzindex++)&255:ze=0,oe(ve,ze)}while(ze!==0);ve.gzhead.hcrc&&ve.pending>Se&&($.adler=r($.adler,ve.pending_buf,ve.pending-Se,Se)),ze===0&&(ve.gzindex=0,ve.status=de)}else ve.status=de;if(ve.status===de)if(ve.gzhead.comment){Se=ve.pending;do{if(ve.pending===ve.pending_buf_size&&(ve.gzhead.hcrc&&ve.pending>Se&&($.adler=r($.adler,ve.pending_buf,ve.pending-Se,Se)),Me($),Se=ve.pending,ve.pending===ve.pending_buf_size)){ze=1;break}ve.gzindex<ve.gzhead.comment.length?ze=ve.gzhead.comment.charCodeAt(ve.gzindex++)&255:ze=0,oe(ve,ze)}while(ze!==0);ve.gzhead.hcrc&&ve.pending>Se&&($.adler=r($.adler,ve.pending_buf,ve.pending-Se,Se)),ze===0&&(ve.status=me)}else ve.status=me;if(ve.status===me&&(ve.gzhead.hcrc?(ve.pending+2>ve.pending_buf_size&&Me($),ve.pending+2<=ve.pending_buf_size&&(oe(ve,$.adler&255),oe(ve,$.adler>>8&255),$.adler=0,ve.status=De)):ve.status=De),ve.pending!==0){if(Me($),$.avail_out===0)return ve.last_flush=-1,u}else if($.avail_in===0&&Y(qe)<=Y(tt)&&qe!==l)return Pe($,y);if(ve.status===je&&$.avail_in!==0)return Pe($,y);if($.avail_in!==0||ve.lookahead!==0||qe!==i&&ve.status!==je){var Z=ve.strategy===x?Ut(ve,qe):ve.strategy===w?Pt(ve,qe):Yt[ve.level].func(ve,qe);if((Z===Ue||Z===Qe)&&(ve.status=je),Z===Te||Z===Ue)return $.avail_out===0&&(ve.last_flush=-1),u;if(Z===_e&&(qe===a?t._tr_align(ve):qe!==c&&(t._tr_stored_block(ve,0,0,!1),qe===o&&(ye(ve.head),ve.lookahead===0&&(ve.strstart=0,ve.block_start=0,ve.insert=0))),Me($),$.avail_out===0))return ve.last_flush=-1,u}return qe!==l?u:ve.wrap<=0?d:(ve.wrap===2?(oe(ve,$.adler&255),oe(ve,$.adler>>8&255),oe(ve,$.adler>>16&255),oe(ve,$.adler>>24&255),oe(ve,$.total_in&255),oe(ve,$.total_in>>8&255),oe(ve,$.total_in>>16&255),oe(ve,$.total_in>>24&255)):(se(ve,$.adler>>>16),se(ve,$.adler&65535)),Me($),ve.wrap>0&&(ve.wrap=-ve.wrap),ve.pending!==0?u:d)}function ft($){var qe;return!$||!$.state?h:(qe=$.state.status,qe!==Q&&qe!==ee&&qe!==re&&qe!==de&&qe!==me&&qe!==De&&qe!==je?Pe($,h):($.state=null,qe===De?Pe($,m):u))}function et($,qe){var tt=qe.length,ve,Se,ze,Ct,fe,Z,G,J;if(!$||!$.state||(ve=$.state,Ct=ve.wrap,Ct===2||Ct===1&&ve.status!==Q||ve.lookahead))return h;for(Ct===1&&($.adler=n($.adler,qe,tt,0)),ve.wrap=0,tt>=ve.w_size&&(Ct===0&&(ye(ve.head),ve.strstart=0,ve.block_start=0,ve.insert=0),J=new e.Buf8(ve.w_size),e.arraySet(J,qe,tt-ve.w_size,ve.w_size,0),qe=J,tt=ve.w_size),fe=$.avail_in,Z=$.next_in,G=$.input,$.avail_in=tt,$.next_in=0,$.input=qe,Re(ve);ve.lookahead>=W;){Se=ve.strstart,ze=ve.lookahead-(W-1);do ve.ins_h=(ve.ins_h<<ve.hash_shift^ve.window[Se+W-1])&ve.hash_mask,ve.prev[Se&ve.w_mask]=ve.head[ve.ins_h],ve.head[ve.ins_h]=Se,Se++;while(--ze);ve.strstart=Se,ve.lookahead=W-1,Re(ve)}return ve.strstart+=ve.lookahead,ve.block_start=ve.strstart,ve.insert=ve.lookahead,ve.lookahead=0,ve.match_length=ve.prev_length=W-1,ve.match_available=0,$.next_in=Z,$.input=G,$.avail_in=fe,ve.wrap=Ct,u}return Cc.deflateInit=Ae,Cc.deflateInit2=ge,Cc.deflateReset=be,Cc.deflateResetKeep=X,Cc.deflateSetHeader=Ee,Cc.deflate=le,Cc.deflateEnd=ft,Cc.deflateSetDictionary=et,Cc.deflateInfo="pako deflate (from Nodeca project)",Cc}var Yp={},d9;function tZ(){if(d9)return Yp;d9=1;var e=up(),t=!0,n=!0;try{String.fromCharCode.apply(null,[0])}catch{t=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{n=!1}for(var r=new e.Buf8(256),s=0;s<256;s++)r[s]=s>=252?6:s>=248?5:s>=240?4:s>=224?3:s>=192?2:1;r[254]=r[254]=1,Yp.string2buf=function(a){var o,l,c,u,d,h=a.length,m=0;for(u=0;u<h;u++)l=a.charCodeAt(u),(l&64512)===55296&&u+1<h&&(c=a.charCodeAt(u+1),(c&64512)===56320&&(l=65536+(l-55296<<10)+(c-56320),u++)),m+=l<128?1:l<2048?2:l<65536?3:4;for(o=new e.Buf8(m),d=0,u=0;d<m;u++)l=a.charCodeAt(u),(l&64512)===55296&&u+1<h&&(c=a.charCodeAt(u+1),(c&64512)===56320&&(l=65536+(l-55296<<10)+(c-56320),u++)),l<128?o[d++]=l:l<2048?(o[d++]=192|l>>>6,o[d++]=128|l&63):l<65536?(o[d++]=224|l>>>12,o[d++]=128|l>>>6&63,o[d++]=128|l&63):(o[d++]=240|l>>>18,o[d++]=128|l>>>12&63,o[d++]=128|l>>>6&63,o[d++]=128|l&63);return o};function i(a,o){if(o<65534&&(a.subarray&&n||!a.subarray&&t))return String.fromCharCode.apply(null,e.shrinkBuf(a,o));for(var l="",c=0;c<o;c++)l+=String.fromCharCode(a[c]);return l}return Yp.buf2binstring=function(a){return i(a,a.length)},Yp.binstring2buf=function(a){for(var o=new e.Buf8(a.length),l=0,c=o.length;l<c;l++)o[l]=a.charCodeAt(l);return o},Yp.buf2string=function(a,o){var l,c,u,d,h=o||a.length,m=new Array(h*2);for(c=0,l=0;l<h;){if(u=a[l++],u<128){m[c++]=u;continue}if(d=r[u],d>4){m[c++]=65533,l+=d-1;continue}for(u&=d===2?31:d===3?15:7;d>1&&l<h;)u=u<<6|a[l++]&63,d--;if(d>1){m[c++]=65533;continue}u<65536?m[c++]=u:(u-=65536,m[c++]=55296|u>>10&1023,m[c++]=56320|u&1023)}return i(m,c)},Yp.utf8border=function(a,o){var l;for(o=o||a.length,o>a.length&&(o=a.length),l=o-1;l>=0&&(a[l]&192)===128;)l--;return l<0||l===0?o:l+r[a[l]]>o?l:o},Yp}var QI,f9;function nZ(){if(f9)return QI;f9=1;function e(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}return QI=e,QI}var h9;function d2e(){if(h9)return u0;h9=1;var e=u2e(),t=up(),n=tZ(),r=xD(),s=nZ(),i=Object.prototype.toString,a=0,o=4,l=0,c=1,u=2,d=-1,h=0,m=8;function y(w){if(!(this instanceof y))return new y(w);this.options=t.assign({level:d,method:m,chunkSize:16384,windowBits:15,memLevel:8,strategy:h,to:""},w||{});var _=this.options;_.raw&&_.windowBits>0?_.windowBits=-_.windowBits:_.gzip&&_.windowBits>0&&_.windowBits<16&&(_.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new s,this.strm.avail_out=0;var k=e.deflateInit2(this.strm,_.level,_.method,_.windowBits,_.memLevel,_.strategy);if(k!==l)throw new Error(r[k]);if(_.header&&e.deflateSetHeader(this.strm,_.header),_.dictionary){var C;if(typeof _.dictionary=="string"?C=n.string2buf(_.dictionary):i.call(_.dictionary)==="[object ArrayBuffer]"?C=new Uint8Array(_.dictionary):C=_.dictionary,k=e.deflateSetDictionary(this.strm,C),k!==l)throw new Error(r[k]);this._dict_set=!0}}y.prototype.push=function(w,_){var k=this.strm,C=this.options.chunkSize,T,A;if(this.ended)return!1;A=_===~~_?_:_===!0?o:a,typeof w=="string"?k.input=n.string2buf(w):i.call(w)==="[object ArrayBuffer]"?k.input=new Uint8Array(w):k.input=w,k.next_in=0,k.avail_in=k.input.length;do{if(k.avail_out===0&&(k.output=new t.Buf8(C),k.next_out=0,k.avail_out=C),T=e.deflate(k,A),T!==c&&T!==l)return this.onEnd(T),this.ended=!0,!1;(k.avail_out===0||k.avail_in===0&&(A===o||A===u))&&(this.options.to==="string"?this.onData(n.buf2binstring(t.shrinkBuf(k.output,k.next_out))):this.onData(t.shrinkBuf(k.output,k.next_out)))}while((k.avail_in>0||k.avail_out===0)&&T!==c);return A===o?(T=e.deflateEnd(this.strm),this.onEnd(T),this.ended=!0,T===l):(A===u&&(this.onEnd(l),k.avail_out=0),!0)},y.prototype.onData=function(w){this.chunks.push(w)},y.prototype.onEnd=function(w){w===l&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=t.flattenChunks(this.chunks)),this.chunks=[],this.err=w,this.msg=this.strm.msg};function b(w,_){var k=new y(_);if(k.push(w,!0),k.err)throw k.msg||r[k.err];return k.result}function v(w,_){return _=_||{},_.raw=!0,b(w,_)}function x(w,_){return _=_||{},_.gzip=!0,b(w,_)}return u0.Deflate=y,u0.deflate=b,u0.deflateRaw=v,u0.gzip=x,u0}var d0={},$l={},eM,p9;function f2e(){if(p9)return eM;p9=1;var e=30,t=12;return eM=function(r,s){var i,a,o,l,c,u,d,h,m,y,b,v,x,w,_,k,C,T,A,N,I,j,L,D,H;i=r.state,a=r.next_in,D=r.input,o=a+(r.avail_in-5),l=r.next_out,H=r.output,c=l-(s-r.avail_out),u=l+(r.avail_out-257),d=i.dmax,h=i.wsize,m=i.whave,y=i.wnext,b=i.window,v=i.hold,x=i.bits,w=i.lencode,_=i.distcode,k=(1<<i.lenbits)-1,C=(1<<i.distbits)-1;e:do{x<15&&(v+=D[a++]<<x,x+=8,v+=D[a++]<<x,x+=8),T=w[v&k];t:for(;;){if(A=T>>>24,v>>>=A,x-=A,A=T>>>16&255,A===0)H[l++]=T&65535;else if(A&16){N=T&65535,A&=15,A&&(x<A&&(v+=D[a++]<<x,x+=8),N+=v&(1<<A)-1,v>>>=A,x-=A),x<15&&(v+=D[a++]<<x,x+=8,v+=D[a++]<<x,x+=8),T=_[v&C];n:for(;;){if(A=T>>>24,v>>>=A,x-=A,A=T>>>16&255,A&16){if(I=T&65535,A&=15,x<A&&(v+=D[a++]<<x,x+=8,x<A&&(v+=D[a++]<<x,x+=8)),I+=v&(1<<A)-1,I>d){r.msg="invalid distance too far back",i.mode=e;break e}if(v>>>=A,x-=A,A=l-c,I>A){if(A=I-A,A>m&&i.sane){r.msg="invalid distance too far back",i.mode=e;break e}if(j=0,L=b,y===0){if(j+=h-A,A<N){N-=A;do H[l++]=b[j++];while(--A);j=l-I,L=H}}else if(y<A){if(j+=h+y-A,A-=y,A<N){N-=A;do H[l++]=b[j++];while(--A);if(j=0,y<N){A=y,N-=A;do H[l++]=b[j++];while(--A);j=l-I,L=H}}}else if(j+=y-A,A<N){N-=A;do H[l++]=b[j++];while(--A);j=l-I,L=H}for(;N>2;)H[l++]=L[j++],H[l++]=L[j++],H[l++]=L[j++],N-=3;N&&(H[l++]=L[j++],N>1&&(H[l++]=L[j++]))}else{j=l-I;do H[l++]=H[j++],H[l++]=H[j++],H[l++]=H[j++],N-=3;while(N>2);N&&(H[l++]=H[j++],N>1&&(H[l++]=H[j++]))}}else if((A&64)===0){T=_[(T&65535)+(v&(1<<A)-1)];continue n}else{r.msg="invalid distance code",i.mode=e;break e}break}}else if((A&64)===0){T=w[(T&65535)+(v&(1<<A)-1)];continue t}else if(A&32){i.mode=t;break e}else{r.msg="invalid literal/length code",i.mode=e;break e}break}}while(a<o&&l<u);N=x>>3,a-=N,x-=N<<3,v&=(1<<x)-1,r.next_in=a,r.next_out=l,r.avail_in=a<o?5+(o-a):5-(a-o),r.avail_out=l<u?257+(u-l):257-(l-u),i.hold=v,i.bits=x},eM}var tM,m9;function h2e(){if(m9)return tM;m9=1;var e=up(),t=15,n=852,r=592,s=0,i=1,a=2,o=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],l=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],c=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],u=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];return tM=function(h,m,y,b,v,x,w,_){var k=_.bits,C=0,T=0,A=0,N=0,I=0,j=0,L=0,D=0,H=0,O=0,K,U,W,B,ne,V=null,Q=0,ee,re=new e.Buf16(t+1),de=new e.Buf16(t+1),me=null,De=0,je,Te,_e;for(C=0;C<=t;C++)re[C]=0;for(T=0;T<b;T++)re[m[y+T]]++;for(I=k,N=t;N>=1&&re[N]===0;N--);if(I>N&&(I=N),N===0)return v[x++]=1<<24|64<<16|0,v[x++]=1<<24|64<<16|0,_.bits=1,0;for(A=1;A<N&&re[A]===0;A++);for(I<A&&(I=A),D=1,C=1;C<=t;C++)if(D<<=1,D-=re[C],D<0)return-1;if(D>0&&(h===s||N!==1))return-1;for(de[1]=0,C=1;C<t;C++)de[C+1]=de[C]+re[C];for(T=0;T<b;T++)m[y+T]!==0&&(w[de[m[y+T]]++]=T);if(h===s?(V=me=w,ee=19):h===i?(V=o,Q-=257,me=l,De-=257,ee=256):(V=c,me=u,ee=-1),O=0,T=0,C=A,ne=x,j=I,L=0,W=-1,H=1<<I,B=H-1,h===i&&H>n||h===a&&H>r)return 1;for(;;){je=C-L,w[T]<ee?(Te=0,_e=w[T]):w[T]>ee?(Te=me[De+w[T]],_e=V[Q+w[T]]):(Te=96,_e=0),K=1<<C-L,U=1<<j,A=U;do U-=K,v[ne+(O>>L)+U]=je<<24|Te<<16|_e|0;while(U!==0);for(K=1<<C-1;O&K;)K>>=1;if(K!==0?(O&=K-1,O+=K):O=0,T++,--re[C]===0){if(C===N)break;C=m[y+w[T]]}if(C>I&&(O&B)!==W){for(L===0&&(L=I),ne+=A,j=C-L,D=1<<j;j+L<N&&(D-=re[j+L],!(D<=0));)j++,D<<=1;if(H+=1<<j,h===i&&H>n||h===a&&H>r)return 1;W=O&B,v[W]=I<<24|j<<16|ne-x|0}}return O!==0&&(v[ne+O]=C-L<<24|64<<16|0),_.bits=I,0},tM}var g9;function p2e(){if(g9)return $l;g9=1;var e=up(),t=QY(),n=eZ(),r=f2e(),s=h2e(),i=0,a=1,o=2,l=4,c=5,u=6,d=0,h=1,m=2,y=-2,b=-3,v=-4,x=-5,w=8,_=1,k=2,C=3,T=4,A=5,N=6,I=7,j=8,L=9,D=10,H=11,O=12,K=13,U=14,W=15,B=16,ne=17,V=18,Q=19,ee=20,re=21,de=22,me=23,De=24,je=25,Te=26,_e=27,Ue=28,Qe=29,We=30,Pe=31,Y=32,ye=852,Me=592,ue=15,oe=ue;function se(ge){return(ge>>>24&255)+(ge>>>8&65280)+((ge&65280)<<8)+((ge&255)<<24)}function Ie(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new e.Buf16(320),this.work=new e.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function Be(ge){var Ae;return!ge||!ge.state?y:(Ae=ge.state,ge.total_in=ge.total_out=Ae.total=0,ge.msg="",Ae.wrap&&(ge.adler=Ae.wrap&1),Ae.mode=_,Ae.last=0,Ae.havedict=0,Ae.dmax=32768,Ae.head=null,Ae.hold=0,Ae.bits=0,Ae.lencode=Ae.lendyn=new e.Buf32(ye),Ae.distcode=Ae.distdyn=new e.Buf32(Me),Ae.sane=1,Ae.back=-1,d)}function Re(ge){var Ae;return!ge||!ge.state?y:(Ae=ge.state,Ae.wsize=0,Ae.whave=0,Ae.wnext=0,Be(ge))}function ct(ge,Ae){var le,ft;return!ge||!ge.state||(ft=ge.state,Ae<0?(le=0,Ae=-Ae):(le=(Ae>>4)+1,Ae<48&&(Ae&=15)),Ae&&(Ae<8||Ae>15))?y:(ft.window!==null&&ft.wbits!==Ae&&(ft.window=null),ft.wrap=le,ft.wbits=Ae,Re(ge))}function At(ge,Ae){var le,ft;return ge?(ft=new Ie,ge.state=ft,ft.window=null,le=ct(ge,Ae),le!==d&&(ge.state=null),le):y}function ut(ge){return At(ge,oe)}var Pt=!0,Ut,Ft;function Yt(ge){if(Pt){var Ae;for(Ut=new e.Buf32(512),Ft=new e.Buf32(32),Ae=0;Ae<144;)ge.lens[Ae++]=8;for(;Ae<256;)ge.lens[Ae++]=9;for(;Ae<280;)ge.lens[Ae++]=7;for(;Ae<288;)ge.lens[Ae++]=8;for(s(a,ge.lens,0,288,Ut,0,ge.work,{bits:9}),Ae=0;Ae<32;)ge.lens[Ae++]=5;s(o,ge.lens,0,32,Ft,0,ge.work,{bits:5}),Pt=!1}ge.lencode=Ut,ge.lenbits=9,ge.distcode=Ft,ge.distbits=5}function we(ge,Ae,le,ft){var et,$=ge.state;return $.window===null&&($.wsize=1<<$.wbits,$.wnext=0,$.whave=0,$.window=new e.Buf8($.wsize)),ft>=$.wsize?(e.arraySet($.window,Ae,le-$.wsize,$.wsize,0),$.wnext=0,$.whave=$.wsize):(et=$.wsize-$.wnext,et>ft&&(et=ft),e.arraySet($.window,Ae,le-ft,et,$.wnext),ft-=et,ft?(e.arraySet($.window,Ae,le-ft,ft,0),$.wnext=ft,$.whave=$.wsize):($.wnext+=et,$.wnext===$.wsize&&($.wnext=0),$.whave<$.wsize&&($.whave+=et))),0}function F(ge,Ae){var le,ft,et,$,qe,tt,ve,Se,ze,Ct,fe,Z,G,J,xe=0,Fe,He,wt,Qt,Dn,Zt,rn,fn,br=new e.Buf8(4),Mr,rs,ss=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!ge||!ge.state||!ge.output||!ge.input&&ge.avail_in!==0)return y;le=ge.state,le.mode===O&&(le.mode=K),qe=ge.next_out,et=ge.output,ve=ge.avail_out,$=ge.next_in,ft=ge.input,tt=ge.avail_in,Se=le.hold,ze=le.bits,Ct=tt,fe=ve,fn=d;e:for(;;)switch(le.mode){case _:if(le.wrap===0){le.mode=K;break}for(;ze<16;){if(tt===0)break e;tt--,Se+=ft[$++]<<ze,ze+=8}if(le.wrap&2&&Se===35615){le.check=0,br[0]=Se&255,br[1]=Se>>>8&255,le.check=n(le.check,br,2,0),Se=0,ze=0,le.mode=k;break}if(le.flags=0,le.head&&(le.head.done=!1),!(le.wrap&1)||(((Se&255)<<8)+(Se>>8))%31){ge.msg="incorrect header check",le.mode=We;break}if((Se&15)!==w){ge.msg="unknown compression method",le.mode=We;break}if(Se>>>=4,ze-=4,rn=(Se&15)+8,le.wbits===0)le.wbits=rn;else if(rn>le.wbits){ge.msg="invalid window size",le.mode=We;break}le.dmax=1<<rn,ge.adler=le.check=1,le.mode=Se&512?D:O,Se=0,ze=0;break;case k:for(;ze<16;){if(tt===0)break e;tt--,Se+=ft[$++]<<ze,ze+=8}if(le.flags=Se,(le.flags&255)!==w){ge.msg="unknown compression method",le.mode=We;break}if(le.flags&57344){ge.msg="unknown header flags set",le.mode=We;break}le.head&&(le.head.text=Se>>8&1),le.flags&512&&(br[0]=Se&255,br[1]=Se>>>8&255,le.check=n(le.check,br,2,0)),Se=0,ze=0,le.mode=C;case C:for(;ze<32;){if(tt===0)break e;tt--,Se+=ft[$++]<<ze,ze+=8}le.head&&(le.head.time=Se),le.flags&512&&(br[0]=Se&255,br[1]=Se>>>8&255,br[2]=Se>>>16&255,br[3]=Se>>>24&255,le.check=n(le.check,br,4,0)),Se=0,ze=0,le.mode=T;case T:for(;ze<16;){if(tt===0)break e;tt--,Se+=ft[$++]<<ze,ze+=8}le.head&&(le.head.xflags=Se&255,le.head.os=Se>>8),le.flags&512&&(br[0]=Se&255,br[1]=Se>>>8&255,le.check=n(le.check,br,2,0)),Se=0,ze=0,le.mode=A;case A:if(le.flags&1024){for(;ze<16;){if(tt===0)break e;tt--,Se+=ft[$++]<<ze,ze+=8}le.length=Se,le.head&&(le.head.extra_len=Se),le.flags&512&&(br[0]=Se&255,br[1]=Se>>>8&255,le.check=n(le.check,br,2,0)),Se=0,ze=0}else le.head&&(le.head.extra=null);le.mode=N;case N:if(le.flags&1024&&(Z=le.length,Z>tt&&(Z=tt),Z&&(le.head&&(rn=le.head.extra_len-le.length,le.head.extra||(le.head.extra=new Array(le.head.extra_len)),e.arraySet(le.head.extra,ft,$,Z,rn)),le.flags&512&&(le.check=n(le.check,ft,Z,$)),tt-=Z,$+=Z,le.length-=Z),le.length))break e;le.length=0,le.mode=I;case I:if(le.flags&2048){if(tt===0)break e;Z=0;do rn=ft[$+Z++],le.head&&rn&&le.length<65536&&(le.head.name+=String.fromCharCode(rn));while(rn&&Z<tt);if(le.flags&512&&(le.check=n(le.check,ft,Z,$)),tt-=Z,$+=Z,rn)break e}else le.head&&(le.head.name=null);le.length=0,le.mode=j;case j:if(le.flags&4096){if(tt===0)break e;Z=0;do rn=ft[$+Z++],le.head&&rn&&le.length<65536&&(le.head.comment+=String.fromCharCode(rn));while(rn&&Z<tt);if(le.flags&512&&(le.check=n(le.check,ft,Z,$)),tt-=Z,$+=Z,rn)break e}else le.head&&(le.head.comment=null);le.mode=L;case L:if(le.flags&512){for(;ze<16;){if(tt===0)break e;tt--,Se+=ft[$++]<<ze,ze+=8}if(Se!==(le.check&65535)){ge.msg="header crc mismatch",le.mode=We;break}Se=0,ze=0}le.head&&(le.head.hcrc=le.flags>>9&1,le.head.done=!0),ge.adler=le.check=0,le.mode=O;break;case D:for(;ze<32;){if(tt===0)break e;tt--,Se+=ft[$++]<<ze,ze+=8}ge.adler=le.check=se(Se),Se=0,ze=0,le.mode=H;case H:if(le.havedict===0)return ge.next_out=qe,ge.avail_out=ve,ge.next_in=$,ge.avail_in=tt,le.hold=Se,le.bits=ze,m;ge.adler=le.check=1,le.mode=O;case O:if(Ae===c||Ae===u)break e;case K:if(le.last){Se>>>=ze&7,ze-=ze&7,le.mode=_e;break}for(;ze<3;){if(tt===0)break e;tt--,Se+=ft[$++]<<ze,ze+=8}switch(le.last=Se&1,Se>>>=1,ze-=1,Se&3){case 0:le.mode=U;break;case 1:if(Yt(le),le.mode=ee,Ae===u){Se>>>=2,ze-=2;break e}break;case 2:le.mode=ne;break;case 3:ge.msg="invalid block type",le.mode=We}Se>>>=2,ze-=2;break;case U:for(Se>>>=ze&7,ze-=ze&7;ze<32;){if(tt===0)break e;tt--,Se+=ft[$++]<<ze,ze+=8}if((Se&65535)!==(Se>>>16^65535)){ge.msg="invalid stored block lengths",le.mode=We;break}if(le.length=Se&65535,Se=0,ze=0,le.mode=W,Ae===u)break e;case W:le.mode=B;case B:if(Z=le.length,Z){if(Z>tt&&(Z=tt),Z>ve&&(Z=ve),Z===0)break e;e.arraySet(et,ft,$,Z,qe),tt-=Z,$+=Z,ve-=Z,qe+=Z,le.length-=Z;break}le.mode=O;break;case ne:for(;ze<14;){if(tt===0)break e;tt--,Se+=ft[$++]<<ze,ze+=8}if(le.nlen=(Se&31)+257,Se>>>=5,ze-=5,le.ndist=(Se&31)+1,Se>>>=5,ze-=5,le.ncode=(Se&15)+4,Se>>>=4,ze-=4,le.nlen>286||le.ndist>30){ge.msg="too many length or distance symbols",le.mode=We;break}le.have=0,le.mode=V;case V:for(;le.have<le.ncode;){for(;ze<3;){if(tt===0)break e;tt--,Se+=ft[$++]<<ze,ze+=8}le.lens[ss[le.have++]]=Se&7,Se>>>=3,ze-=3}for(;le.have<19;)le.lens[ss[le.have++]]=0;if(le.lencode=le.lendyn,le.lenbits=7,Mr={bits:le.lenbits},fn=s(i,le.lens,0,19,le.lencode,0,le.work,Mr),le.lenbits=Mr.bits,fn){ge.msg="invalid code lengths set",le.mode=We;break}le.have=0,le.mode=Q;case Q:for(;le.have<le.nlen+le.ndist;){for(;xe=le.lencode[Se&(1<<le.lenbits)-1],Fe=xe>>>24,He=xe>>>16&255,wt=xe&65535,!(Fe<=ze);){if(tt===0)break e;tt--,Se+=ft[$++]<<ze,ze+=8}if(wt<16)Se>>>=Fe,ze-=Fe,le.lens[le.have++]=wt;else{if(wt===16){for(rs=Fe+2;ze<rs;){if(tt===0)break e;tt--,Se+=ft[$++]<<ze,ze+=8}if(Se>>>=Fe,ze-=Fe,le.have===0){ge.msg="invalid bit length repeat",le.mode=We;break}rn=le.lens[le.have-1],Z=3+(Se&3),Se>>>=2,ze-=2}else if(wt===17){for(rs=Fe+3;ze<rs;){if(tt===0)break e;tt--,Se+=ft[$++]<<ze,ze+=8}Se>>>=Fe,ze-=Fe,rn=0,Z=3+(Se&7),Se>>>=3,ze-=3}else{for(rs=Fe+7;ze<rs;){if(tt===0)break e;tt--,Se+=ft[$++]<<ze,ze+=8}Se>>>=Fe,ze-=Fe,rn=0,Z=11+(Se&127),Se>>>=7,ze-=7}if(le.have+Z>le.nlen+le.ndist){ge.msg="invalid bit length repeat",le.mode=We;break}for(;Z--;)le.lens[le.have++]=rn}}if(le.mode===We)break;if(le.lens[256]===0){ge.msg="invalid code -- missing end-of-block",le.mode=We;break}if(le.lenbits=9,Mr={bits:le.lenbits},fn=s(a,le.lens,0,le.nlen,le.lencode,0,le.work,Mr),le.lenbits=Mr.bits,fn){ge.msg="invalid literal/lengths set",le.mode=We;break}if(le.distbits=6,le.distcode=le.distdyn,Mr={bits:le.distbits},fn=s(o,le.lens,le.nlen,le.ndist,le.distcode,0,le.work,Mr),le.distbits=Mr.bits,fn){ge.msg="invalid distances set",le.mode=We;break}if(le.mode=ee,Ae===u)break e;case ee:le.mode=re;case re:if(tt>=6&&ve>=258){ge.next_out=qe,ge.avail_out=ve,ge.next_in=$,ge.avail_in=tt,le.hold=Se,le.bits=ze,r(ge,fe),qe=ge.next_out,et=ge.output,ve=ge.avail_out,$=ge.next_in,ft=ge.input,tt=ge.avail_in,Se=le.hold,ze=le.bits,le.mode===O&&(le.back=-1);break}for(le.back=0;xe=le.lencode[Se&(1<<le.lenbits)-1],Fe=xe>>>24,He=xe>>>16&255,wt=xe&65535,!(Fe<=ze);){if(tt===0)break e;tt--,Se+=ft[$++]<<ze,ze+=8}if(He&&(He&240)===0){for(Qt=Fe,Dn=He,Zt=wt;xe=le.lencode[Zt+((Se&(1<<Qt+Dn)-1)>>Qt)],Fe=xe>>>24,He=xe>>>16&255,wt=xe&65535,!(Qt+Fe<=ze);){if(tt===0)break e;tt--,Se+=ft[$++]<<ze,ze+=8}Se>>>=Qt,ze-=Qt,le.back+=Qt}if(Se>>>=Fe,ze-=Fe,le.back+=Fe,le.length=wt,He===0){le.mode=Te;break}if(He&32){le.back=-1,le.mode=O;break}if(He&64){ge.msg="invalid literal/length code",le.mode=We;break}le.extra=He&15,le.mode=de;case de:if(le.extra){for(rs=le.extra;ze<rs;){if(tt===0)break e;tt--,Se+=ft[$++]<<ze,ze+=8}le.length+=Se&(1<<le.extra)-1,Se>>>=le.extra,ze-=le.extra,le.back+=le.extra}le.was=le.length,le.mode=me;case me:for(;xe=le.distcode[Se&(1<<le.distbits)-1],Fe=xe>>>24,He=xe>>>16&255,wt=xe&65535,!(Fe<=ze);){if(tt===0)break e;tt--,Se+=ft[$++]<<ze,ze+=8}if((He&240)===0){for(Qt=Fe,Dn=He,Zt=wt;xe=le.distcode[Zt+((Se&(1<<Qt+Dn)-1)>>Qt)],Fe=xe>>>24,He=xe>>>16&255,wt=xe&65535,!(Qt+Fe<=ze);){if(tt===0)break e;tt--,Se+=ft[$++]<<ze,ze+=8}Se>>>=Qt,ze-=Qt,le.back+=Qt}if(Se>>>=Fe,ze-=Fe,le.back+=Fe,He&64){ge.msg="invalid distance code",le.mode=We;break}le.offset=wt,le.extra=He&15,le.mode=De;case De:if(le.extra){for(rs=le.extra;ze<rs;){if(tt===0)break e;tt--,Se+=ft[$++]<<ze,ze+=8}le.offset+=Se&(1<<le.extra)-1,Se>>>=le.extra,ze-=le.extra,le.back+=le.extra}if(le.offset>le.dmax){ge.msg="invalid distance too far back",le.mode=We;break}le.mode=je;case je:if(ve===0)break e;if(Z=fe-ve,le.offset>Z){if(Z=le.offset-Z,Z>le.whave&&le.sane){ge.msg="invalid distance too far back",le.mode=We;break}Z>le.wnext?(Z-=le.wnext,G=le.wsize-Z):G=le.wnext-Z,Z>le.length&&(Z=le.length),J=le.window}else J=et,G=qe-le.offset,Z=le.length;Z>ve&&(Z=ve),ve-=Z,le.length-=Z;do et[qe++]=J[G++];while(--Z);le.length===0&&(le.mode=re);break;case Te:if(ve===0)break e;et[qe++]=le.length,ve--,le.mode=re;break;case _e:if(le.wrap){for(;ze<32;){if(tt===0)break e;tt--,Se|=ft[$++]<<ze,ze+=8}if(fe-=ve,ge.total_out+=fe,le.total+=fe,fe&&(ge.adler=le.check=le.flags?n(le.check,et,fe,qe-fe):t(le.check,et,fe,qe-fe)),fe=ve,(le.flags?Se:se(Se))!==le.check){ge.msg="incorrect data check",le.mode=We;break}Se=0,ze=0}le.mode=Ue;case Ue:if(le.wrap&&le.flags){for(;ze<32;){if(tt===0)break e;tt--,Se+=ft[$++]<<ze,ze+=8}if(Se!==(le.total&4294967295)){ge.msg="incorrect length check",le.mode=We;break}Se=0,ze=0}le.mode=Qe;case Qe:fn=h;break e;case We:fn=b;break e;case Pe:return v;case Y:default:return y}return ge.next_out=qe,ge.avail_out=ve,ge.next_in=$,ge.avail_in=tt,le.hold=Se,le.bits=ze,(le.wsize||fe!==ge.avail_out&&le.mode<We&&(le.mode<_e||Ae!==l))&&we(ge,ge.output,ge.next_out,fe-ge.avail_out),Ct-=ge.avail_in,fe-=ge.avail_out,ge.total_in+=Ct,ge.total_out+=fe,le.total+=fe,le.wrap&&fe&&(ge.adler=le.check=le.flags?n(le.check,et,fe,ge.next_out-fe):t(le.check,et,fe,ge.next_out-fe)),ge.data_type=le.bits+(le.last?64:0)+(le.mode===O?128:0)+(le.mode===ee||le.mode===W?256:0),(Ct===0&&fe===0||Ae===l)&&fn===d&&(fn=x),fn}function X(ge){if(!ge||!ge.state)return y;var Ae=ge.state;return Ae.window&&(Ae.window=null),ge.state=null,d}function be(ge,Ae){var le;return!ge||!ge.state||(le=ge.state,(le.wrap&2)===0)?y:(le.head=Ae,Ae.done=!1,d)}function Ee(ge,Ae){var le=Ae.length,ft,et,$;return!ge||!ge.state||(ft=ge.state,ft.wrap!==0&&ft.mode!==H)?y:ft.mode===H&&(et=1,et=t(et,Ae,le,0),et!==ft.check)?b:($=we(ge,Ae,le,le),$?(ft.mode=Pe,v):(ft.havedict=1,d))}return $l.inflateReset=Re,$l.inflateReset2=ct,$l.inflateResetKeep=Be,$l.inflateInit=ut,$l.inflateInit2=At,$l.inflate=F,$l.inflateEnd=X,$l.inflateGetHeader=be,$l.inflateSetDictionary=Ee,$l.inflateInfo="pako inflate (from Nodeca project)",$l}var nM,y9;function rZ(){return y9||(y9=1,nM={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}),nM}var rM,b9;function m2e(){if(b9)return rM;b9=1;function e(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}return rM=e,rM}var v9;function g2e(){if(v9)return d0;v9=1;var e=p2e(),t=up(),n=tZ(),r=rZ(),s=xD(),i=nZ(),a=m2e(),o=Object.prototype.toString;function l(d){if(!(this instanceof l))return new l(d);this.options=t.assign({chunkSize:16384,windowBits:0,to:""},d||{});var h=this.options;h.raw&&h.windowBits>=0&&h.windowBits<16&&(h.windowBits=-h.windowBits,h.windowBits===0&&(h.windowBits=-15)),h.windowBits>=0&&h.windowBits<16&&!(d&&d.windowBits)&&(h.windowBits+=32),h.windowBits>15&&h.windowBits<48&&(h.windowBits&15)===0&&(h.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new i,this.strm.avail_out=0;var m=e.inflateInit2(this.strm,h.windowBits);if(m!==r.Z_OK)throw new Error(s[m]);if(this.header=new a,e.inflateGetHeader(this.strm,this.header),h.dictionary&&(typeof h.dictionary=="string"?h.dictionary=n.string2buf(h.dictionary):o.call(h.dictionary)==="[object ArrayBuffer]"&&(h.dictionary=new Uint8Array(h.dictionary)),h.raw&&(m=e.inflateSetDictionary(this.strm,h.dictionary),m!==r.Z_OK)))throw new Error(s[m])}l.prototype.push=function(d,h){var m=this.strm,y=this.options.chunkSize,b=this.options.dictionary,v,x,w,_,k,C=!1;if(this.ended)return!1;x=h===~~h?h:h===!0?r.Z_FINISH:r.Z_NO_FLUSH,typeof d=="string"?m.input=n.binstring2buf(d):o.call(d)==="[object ArrayBuffer]"?m.input=new Uint8Array(d):m.input=d,m.next_in=0,m.avail_in=m.input.length;do{if(m.avail_out===0&&(m.output=new t.Buf8(y),m.next_out=0,m.avail_out=y),v=e.inflate(m,r.Z_NO_FLUSH),v===r.Z_NEED_DICT&&b&&(v=e.inflateSetDictionary(this.strm,b)),v===r.Z_BUF_ERROR&&C===!0&&(v=r.Z_OK,C=!1),v!==r.Z_STREAM_END&&v!==r.Z_OK)return this.onEnd(v),this.ended=!0,!1;m.next_out&&(m.avail_out===0||v===r.Z_STREAM_END||m.avail_in===0&&(x===r.Z_FINISH||x===r.Z_SYNC_FLUSH))&&(this.options.to==="string"?(w=n.utf8border(m.output,m.next_out),_=m.next_out-w,k=n.buf2string(m.output,w),m.next_out=_,m.avail_out=y-_,_&&t.arraySet(m.output,m.output,w,_,0),this.onData(k)):this.onData(t.shrinkBuf(m.output,m.next_out))),m.avail_in===0&&m.avail_out===0&&(C=!0)}while((m.avail_in>0||m.avail_out===0)&&v!==r.Z_STREAM_END);return v===r.Z_STREAM_END&&(x=r.Z_FINISH),x===r.Z_FINISH?(v=e.inflateEnd(this.strm),this.onEnd(v),this.ended=!0,v===r.Z_OK):(x===r.Z_SYNC_FLUSH&&(this.onEnd(r.Z_OK),m.avail_out=0),!0)},l.prototype.onData=function(d){this.chunks.push(d)},l.prototype.onEnd=function(d){d===r.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=t.flattenChunks(this.chunks)),this.chunks=[],this.err=d,this.msg=this.strm.msg};function c(d,h){var m=new l(h);if(m.push(d,!0),m.err)throw m.msg||s[m.err];return m.result}function u(d,h){return h=h||{},h.raw=!0,c(d,h)}return d0.Inflate=l,d0.inflate=c,d0.inflateRaw=u,d0.ungzip=c,d0}var sM,x9;function y2e(){if(x9)return sM;x9=1;var e=up().assign,t=d2e(),n=g2e(),r=rZ(),s={};return e(s,t,n,r),sM=s,sM}var b2e=y2e();const wD=ga(b2e);var iM,w9;function v2e(){if(w9)return iM;w9=1;const e=(t,n)=>function(...r){const s=n.promiseModule;return new s((i,a)=>{n.multiArgs?r.push((...o)=>{n.errorFirst?o[0]?a(o):(o.shift(),i(o)):i(o)}):n.errorFirst?r.push((o,l)=>{o?a(o):i(l)}):r.push(i),t.apply(this,r)})};return iM=(t,n)=>{n=Object.assign({exclude:[/.+(Sync|Stream)$/],errorFirst:!0,promiseModule:Promise},n);const r=typeof t;if(!(t!==null&&(r==="object"||r==="function")))throw new TypeError(`Expected \`input\` to be a \`Function\` or \`Object\`, got \`${t===null?"null":r}\``);const s=a=>{const o=l=>typeof l=="string"?a===l:l.test(a);return n.include?n.include.some(o):!n.exclude.some(o)};let i;r==="function"?i=function(...a){return n.excludeMain?t(...a):e(t,n).apply(this,a)}:i=Object.create(Object.getPrototypeOf(t));for(const a in t){const o=t[a];i[a]=typeof o=="function"&&s(a)?e(o,n):o}return i},iM}var x2e=v2e();const aM=ga(x2e);var oM,S9;function w2e(){if(S9)return oM;S9=1;var e={};function t(W){return Array.isArray(W)?W:[W]}const n="",r=" ",s="\\",i=/^\s+$/,a=/(?:[^\\]|^)\\$/,o=/^\\!/,l=/^\\#/,c=/\r?\n/g,u=/^\.*\/|^\.+$/,d="/";let h="node-ignore";typeof Symbol<"u"&&(h=Symbol.for("node-ignore"));const m=h,y=(W,B,ne)=>Object.defineProperty(W,B,{value:ne}),b=/([0-z])-([0-z])/g,v=()=>!1,x=W=>W.replace(b,(B,ne,V)=>ne.charCodeAt(0)<=V.charCodeAt(0)?B:n),w=W=>{const{length:B}=W;return W.slice(0,B-B%2)},_=[[/^\uFEFF/,()=>n],[/((?:\\\\)*?)(\\?\s+)$/,(W,B,ne)=>B+(ne.indexOf("\\")===0?r:n)],[/(\\+?)\s/g,(W,B)=>{const{length:ne}=B;return B.slice(0,ne-ne%2)+r}],[/[\\$.|*+(){^]/g,W=>`\\${W}`],[/(?!\\)\?/g,()=>"[^/]"],[/^\//,()=>"^"],[/\//g,()=>"\\/"],[/^\^*\\\*\\\*\\\//,()=>"^(?:.*\\/)?"],[/^(?=[^^])/,function(){return/\/(?!$)/.test(this)?"^":"(?:^|\\/)"}],[/\\\/\\\*\\\*(?=\\\/|$)/g,(W,B,ne)=>B+6<ne.length?"(?:\\/[^\\/]+)*":"\\/.+"],[/(^|[^\\]+)(\\\*)+(?=.+)/g,(W,B,ne)=>{const V=ne.replace(/\\\*/g,"[^\\/]*");return B+V}],[/\\\\\\(?=[$.|*+(){^])/g,()=>s],[/\\\\/g,()=>s],[/(\\)?\[([^\]/]*?)(\\*)($|\])/g,(W,B,ne,V,Q)=>B===s?`\\[${ne}${w(V)}${Q}`:Q==="]"&&V.length%2===0?`[${x(ne)}${V}]`:"[]"],[/(?:[^*])$/,W=>/\/$/.test(W)?`${W}$`:`${W}(?=$|\\/$)`],[/(\^|\\\/)?\\\*$/,(W,B)=>`${B?`${B}[^/]+`:"[^/]*"}(?=$|\\/$)`]],k=Object.create(null),C=(W,B)=>{let ne=k[W];return ne||(ne=_.reduce((V,[Q,ee])=>V.replace(Q,ee.bind(W)),W),k[W]=ne),B?new RegExp(ne,"i"):new RegExp(ne)},T=W=>typeof W=="string",A=W=>W&&T(W)&&!i.test(W)&&!a.test(W)&&W.indexOf("#")!==0,N=W=>W.split(c);class I{constructor(B,ne,V,Q){this.origin=B,this.pattern=ne,this.negative=V,this.regex=Q}}const j=(W,B)=>{const ne=W;let V=!1;W.indexOf("!")===0&&(V=!0,W=W.substr(1)),W=W.replace(o,"!").replace(l,"#");const Q=C(W,B);return new I(ne,W,V,Q)},L=(W,B)=>{throw new B(W)},D=(W,B,ne)=>T(W)?W?D.isNotRelative(W)?ne(`path should be a \`path.relative()\`d string, but got "${B}"`,RangeError):!0:ne("path must not be empty",TypeError):ne(`path must be a string, but got \`${B}\``,TypeError),H=W=>u.test(W);D.isNotRelative=H,D.convert=W=>W;class O{constructor({ignorecase:B=!0,ignoreCase:ne=B,allowRelativePaths:V=!1}={}){y(this,m,!0),this._rules=[],this._ignoreCase=ne,this._allowRelativePaths=V,this._initCache()}_initCache(){this._ignoreCache=Object.create(null),this._testCache=Object.create(null)}_addPattern(B){if(B&&B[m]){this._rules=this._rules.concat(B._rules),this._added=!0;return}if(A(B)){const ne=j(B,this._ignoreCase);this._added=!0,this._rules.push(ne)}}add(B){return this._added=!1,t(T(B)?N(B):B).forEach(this._addPattern,this),this._added&&this._initCache(),this}addPattern(B){return this.add(B)}_testOne(B,ne){let V=!1,Q=!1;return this._rules.forEach(ee=>{const{negative:re}=ee;if(Q===re&&V!==Q||re&&!V&&!Q&&!ne)return;ee.regex.test(B)&&(V=!re,Q=re)}),{ignored:V,unignored:Q}}_test(B,ne,V,Q){const ee=B&&D.convert(B);return D(ee,B,this._allowRelativePaths?v:L),this._t(ee,ne,V,Q)}_t(B,ne,V,Q){if(B in ne)return ne[B];if(Q||(Q=B.split(d)),Q.pop(),!Q.length)return ne[B]=this._testOne(B,V);const ee=this._t(Q.join(d)+d,ne,V,Q);return ne[B]=ee.ignored?ee:this._testOne(B,V)}ignores(B){return this._test(B,this._ignoreCache,!1).ignored}createFilter(){return B=>!this.ignores(B)}filter(B){return t(B).filter(this.createFilter())}test(B){return this._test(B,this._testCache,!0)}}const K=W=>new O(W),U=W=>D(W&&D.convert(W),W,v);if(K.isPathValid=U,K.default=K,oM=K,typeof Di<"u"&&(e&&e.IGNORE_TEST_WIN32||Di.platform==="win32")){const W=ne=>/^\\\\\?\\/.test(ne)||/["<>|\u0000-\u001F]+/u.test(ne)?ne:ne.replace(/\\/g,"/");D.convert=W;const B=/^[a-z]:\//i;D.isNotRelative=ne=>B.test(ne)||H(ne)}return oM}var S2e=w2e();const _2e=ga(S2e);var lM,_9;function C2e(){if(_9)return lM;_9=1;function e(r){return r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function t(r,s,i){return s=s instanceof RegExp?s:new RegExp(e(s),"g"),r.replace(s,i)}var n={clean:function(s){if(typeof s!="string")throw new Error("Expected a string, received: "+s);return s=t(s,"./","/"),s=t(s,"..","."),s=t(s," ","-"),s=t(s,/^[~^:?*\\\-]/g,""),s=t(s,/[~^:?*\\]/g,"-"),s=t(s,/[~^:?*\\\-]$/g,""),s=t(s,"@{","-"),s=t(s,/\.$/g,""),s=t(s,/\/$/g,""),s=t(s,/\.lock$/g,""),s}};return lM=n,lM}var k2e=C2e();const Ru=ga(k2e);var cM,C9;function E2e(){return C9||(C9=1,cM=function(e,t){var n=e,r=t,s=n.length,i=r.length,a=!1,o=null,l=s+1,c=[],u=[],d=[],h="",m=-1,y=0,b=1,v,x,w=function(){s>=i&&(v=n,x=s,n=r,r=v,s=i,i=x,a=!0,l=s+1)},_=function(A,N,I){return{x:A,y:N,k:I}},k=function(A,N){return{elem:A,t:N}},C=function(A,N,I){var j,L,D;for(N>I?j=c[A-1+l]:j=c[A+1+l],D=Math.max(N,I),L=D-A;L<s&&D<i&&n[L]===r[D];)++L,++D;return c[A+l]=u.length,u[u.length]=new _(L,D,j),D},T=function(A){var N,I,j;for(N=I=0,j=A.length-1;j>=0;--j)for(;N<A[j].x||I<A[j].y;)A[j].y-A[j].x>I-N?(a?d[d.length]=new k(r[I],m):d[d.length]=new k(r[I],b),++I):A[j].y-A[j].x<I-N?(a?d[d.length]=new k(n[N],b):d[d.length]=new k(n[N],m),++N):(d[d.length]=new k(n[N],y),h+=n[N],++N,++I)};return w(),{SES_DELETE:-1,SES_COMMON:0,SES_ADD:1,editdistance:function(){return o},getlcs:function(){return h},getses:function(){return d},compose:function(){var A,N,I,j,L,D,H,O;for(A=i-s,N=s+i+3,I={},H=0;H<N;++H)I[H]=-1,c[H]=-1;j=-1;do{for(++j,O=-j;O<=A-1;++O)I[O+l]=C(O,I[O-1+l]+1,I[O+1+l]);for(O=A+j;O>=A+1;--O)I[O+l]=C(O,I[O-1+l]+1,I[O+1+l]);I[A+l]=C(A,I[A-1+l]+1,I[A+1+l])}while(I[A+l]!==i);for(o=A+2*j,L=c[A+l],D=[];L!==-1;)D[D.length]=new _(u[L].x,u[L].y,null),L=u[L].k;T(D)}}}),cM}var uM,k9;function T2e(){if(k9)return uM;k9=1;var e=E2e();function t(i,a){var o=new e(i,a);o.compose();for(var l=o.getses(),c,u,d=i.length-1,h=a.length-1,m=l.length-1;m>=0;--m)l[m].t===o.SES_COMMON?(u?(u.chain={file1index:d,file2index:h,chain:null},u=u.chain):(c={file1index:d,file2index:h,chain:null},u=c),d--,h--):l[m].t===o.SES_DELETE?d--:l[m].t===o.SES_ADD&&h--;var y={file1index:-1,file2index:-1,chain:null};return u?(u.chain=y,c):y}function n(i,a){for(var o=[],l=i.length,c=a.length,u=t(i,a);u!==null;u=u.chain){var d=l-u.file1index-1,h=c-u.file2index-1;l=u.file1index,c=u.file2index,(d||h)&&o.push({file1:[l+1,d],file2:[c+1,h]})}return o.reverse(),o}function r(i,a,o){var l,c=n(a,i),u=n(a,o),d=[];function h(B,ne){d.push([B.file1[0],ne,B.file1[1],B.file2[0],B.file2[1]])}for(l=0;l<c.length;l++)h(c[l],0);for(l=0;l<u.length;l++)h(u[l],2);d.sort(function(B,ne){return B[0]-ne[0]});var m=[],y=0;function b(B){B>y&&(m.push([1,y,B-y]),y=B)}for(var v=0;v<d.length;v++){for(var x=v,w=d[v],_=w[0],k=_+w[2];v<d.length-1;){var C=d[v+1],T=C[0];if(T>k)break;k=Math.max(k,T+C[2]),v++}if(b(_),x==v)w[4]>0&&m.push([w[1],w[3],w[4]]);else{var A={0:[i.length,-1,a.length,-1],2:[o.length,-1,a.length,-1]};for(l=x;l<=v;l++){w=d[l];var N=w[1],I=A[N],j=w[0],L=j+w[2],D=w[3],H=D+w[4];I[0]=Math.min(D,I[0]),I[1]=Math.max(H,I[1]),I[2]=Math.min(j,I[2]),I[3]=Math.max(L,I[3])}var O=A[0][0]+(_-A[0][2]),K=A[0][1]+(k-A[0][3]),U=A[2][0]+(_-A[2][2]),W=A[2][1]+(k-A[2][3]);m.push([-1,O,K-O,_,k-_,U,W-U])}y=k}return b(a.length),m}function s(i,a,o){var l=[],c=[i,a,o],u=r(i,a,o),d=[];function h(){d.length&&l.push({ok:d}),d=[]}function m(w){for(var _=0;_<w.length;_++)d.push(w[_])}function y(w){if(w[2]!=w[6])return!0;for(var _=w[1],k=w[5],C=0;C<w[2];C++)if(i[C+_]!=o[C+k])return!0;return!1}for(var b=0;b<u.length;b++){var v=u[b],x=v[0];x==-1?y(v)?(h(),l.push({conflict:{a:i.slice(v[1],v[1]+v[2]),aIndex:v[1],o:a.slice(v[3],v[3]+v[4]),oIndex:v[3],b:o.slice(v[5],v[5]+v[6]),bIndex:v[5]}})):m(c[0].slice(v[1],v[1]+v[2])):m(c[x].slice(v[1],v[1]+v[2]))}return h(),l}return uM=s,uM}var A2e=T2e();const R2e=ga(A2e);class Qr extends Error{constructor(t){super(t),this.caller=""}toJSON(){return{code:this.code,data:this.data,caller:this.caller,message:this.message,stack:this.stack}}fromJSON(t){const n=new Qr(t.message);return n.code=t.code,n.data=t.data,n.caller=t.caller,n.stack=t.stack,n}get isIsomorphicGitError(){return!0}}class L1 extends Qr{constructor(t){super(`Modifying the index is not possible because you have unmerged files: ${t.toString}. Fix them up in the work tree, and then use 'git add/rm as appropriate to mark resolution and make a commit.`),this.code=this.name=L1.code,this.data={filepaths:t}}}L1.code="UnmergedPathsError";class xr extends Qr{constructor(t){super(`An internal error caused this command to fail. Please file a bug report at https://github.com/isomorphic-git/isomorphic-git/issues with this error message: ${t}`),this.code=this.name=xr.code,this.data={message:t}}}xr.code="InternalError";class db extends Qr{constructor(t){super(`The filepath "${t}" contains unsafe character sequences`),this.code=this.name=db.code,this.data={filepath:t}}}db.code="UnsafeFilepathError";class Eu{constructor(t){this.buffer=t,this._start=0}eof(){return this._start>=this.buffer.length}tell(){return this._start}seek(t){this._start=t}slice(t){const n=this.buffer.slice(this._start,this._start+t);return this._start+=t,n}toString(t,n){const r=this.buffer.toString(t,this._start,this._start+n);return this._start+=n,r}write(t,n,r){const s=this.buffer.write(t,this._start,n,r);return this._start+=n,s}copy(t,n,r){const s=t.copy(this.buffer,this._start,n,r);return this._start+=s,s}readUInt8(){const t=this.buffer.readUInt8(this._start);return this._start+=1,t}writeUInt8(t){const n=this.buffer.writeUInt8(t,this._start);return this._start+=1,n}readUInt16BE(){const t=this.buffer.readUInt16BE(this._start);return this._start+=2,t}writeUInt16BE(t){const n=this.buffer.writeUInt16BE(t,this._start);return this._start+=2,n}readUInt32BE(){const t=this.buffer.readUInt32BE(this._start);return this._start+=4,t}writeUInt32BE(t){const n=this.buffer.writeUInt32BE(t,this._start);return this._start+=4,n}}function pT(e,t){return-(e<t)||+(e>t)}function sZ(e,t){return pT(e.path,t.path)}function iZ(e){let t=e>0?e>>12:0;t!==4&&t!==8&&t!==10&&t!==14&&(t=8);let n=e&511;return n&73?n=493:n=420,t!==8&&(n=0),(t<<12)+n}const hu=2**32;function E9(e,t,n,r){if(e!==void 0&&t!==void 0)return[e,t];n===void 0&&(n=r.valueOf());const s=Math.floor(n/1e3),i=(n-s*1e3)*1e6;return[s,i]}function wy(e){const[t,n]=E9(e.ctimeSeconds,e.ctimeNanoseconds,e.ctimeMs,e.ctime),[r,s]=E9(e.mtimeSeconds,e.mtimeNanoseconds,e.mtimeMs,e.mtime);return{ctimeSeconds:t%hu,ctimeNanoseconds:n%hu,mtimeSeconds:r%hu,mtimeNanoseconds:s%hu,dev:e.dev%hu,ino:e.ino%hu,mode:iZ(e.mode%hu),uid:e.uid%hu,gid:e.gid%hu,size:e.size>-1?e.size%hu:0}}function N2e(e){let t="";for(const n of new Uint8Array(e))n<16&&(t+="0"),t+=n.toString(16);return t}let dM=null;async function uf(e){return dM===null&&(dM=await M2e()),dM?aZ(e):I2e(e)}function I2e(e){return new JY().update(e).digest("hex")}async function aZ(e){const t=await crypto.subtle.digest("SHA-1",e);return N2e(t)}async function M2e(){try{if(await aZ(new Uint8Array([]))==="da39a3ee5e6b4b0d3255bfef95601890afd80709")return!0}catch{}return!1}function j2e(e){return{assumeValid:!!(e&32768),extended:!!(e&16384),stage:(e&12288)>>12,nameLength:e&4095}}function P2e(e){const t=e.flags;return t.extended=!1,t.nameLength=Math.min(un.from(e.path).length,4095),(t.assumeValid?32768:0)+(t.extended?16384:0)+((t.stage&3)<<12)+(t.nameLength&4095)}class om{constructor(t,n){this._dirty=!1,this._unmergedPaths=n||new Set,this._entries=t||new Map}_addEntry(t){if(t.flags.stage===0)t.stages=[t],this._entries.set(t.path,t),this._unmergedPaths.delete(t.path);else{let n=this._entries.get(t.path);n||(this._entries.set(t.path,t),n=t),n.stages[t.flags.stage]=t,this._unmergedPaths.add(t.path)}}static async from(t){if(un.isBuffer(t))return om.fromBuffer(t);if(t===null)return new om(null);throw new xr("invalid type passed to GitIndex.from")}static async fromBuffer(t){if(t.length===0)throw new xr("Index file is empty (.git/index)");const n=new om,r=new Eu(t),s=r.toString("utf8",4);if(s!=="DIRC")throw new xr(`Invalid dircache magic file number: ${s}`);const i=await uf(t.slice(0,-20)),a=t.slice(-20).toString("hex");if(a!==i)throw new xr(`Invalid checksum in GitIndex buffer: expected ${a} but saw ${i}`);const o=r.readUInt32BE();if(o!==2)throw new xr(`Unsupported dircache version: ${o}`);const l=r.readUInt32BE();let c=0;for(;!r.eof()&&c<l;){const u={};u.ctimeSeconds=r.readUInt32BE(),u.ctimeNanoseconds=r.readUInt32BE(),u.mtimeSeconds=r.readUInt32BE(),u.mtimeNanoseconds=r.readUInt32BE(),u.dev=r.readUInt32BE(),u.ino=r.readUInt32BE(),u.mode=r.readUInt32BE(),u.uid=r.readUInt32BE(),u.gid=r.readUInt32BE(),u.size=r.readUInt32BE(),u.oid=r.slice(20).toString("hex");const d=r.readUInt16BE();u.flags=j2e(d);const h=t.indexOf(0,r.tell()+1)-r.tell();if(h<1)throw new xr(`Got a path length of: ${h}`);if(u.path=r.toString("utf8",h),u.path.includes("..\\")||u.path.includes("../"))throw new db(u.path);let m=8-(r.tell()-12)%8;for(m===0&&(m=8);m--;){const y=r.readUInt8();if(y!==0)throw new xr(`Expected 1-8 null characters but got '${y}' after ${u.path}`);if(r.eof())throw new xr("Unexpected end of file")}u.stages=[],n._addEntry(u),c++}return n}get unmergedPaths(){return[...this._unmergedPaths]}get entries(){return[...this._entries.values()].sort(sZ)}get entriesMap(){return this._entries}get entriesFlat(){return[...this.entries].flatMap(t=>t.stages.length>1?t.stages.filter(n=>n):t)}*[Symbol.iterator](){for(const t of this.entries)yield t}insert({filepath:t,stats:n,oid:r,stage:s=0}){n||(n={ctimeSeconds:0,ctimeNanoseconds:0,mtimeSeconds:0,mtimeNanoseconds:0,dev:0,ino:0,mode:0,uid:0,gid:0,size:0}),n=wy(n);const i=un.from(t),a={ctimeSeconds:n.ctimeSeconds,ctimeNanoseconds:n.ctimeNanoseconds,mtimeSeconds:n.mtimeSeconds,mtimeNanoseconds:n.mtimeNanoseconds,dev:n.dev,ino:n.ino,mode:n.mode||33188,uid:n.uid,gid:n.gid,size:n.size,path:t,oid:r,flags:{assumeValid:!1,extended:!1,stage:s,nameLength:i.length<4095?i.length:4095},stages:[]};this._addEntry(a),this._dirty=!0}delete({filepath:t}){if(this._entries.has(t))this._entries.delete(t);else for(const n of this._entries.keys())n.startsWith(t+"/")&&this._entries.delete(n);this._unmergedPaths.has(t)&&this._unmergedPaths.delete(t),this._dirty=!0}clear(){this._entries.clear(),this._dirty=!0}has({filepath:t}){return this._entries.has(t)}render(){return this.entries.map(t=>`${t.mode.toString(8)} ${t.oid}    ${t.path}`).join(`
`)}static async _entryToBuffer(t){const n=un.from(t.path),r=Math.ceil((62+n.length+1)/8)*8,s=un.alloc(r),i=new Eu(s),a=wy(t);return i.writeUInt32BE(a.ctimeSeconds),i.writeUInt32BE(a.ctimeNanoseconds),i.writeUInt32BE(a.mtimeSeconds),i.writeUInt32BE(a.mtimeNanoseconds),i.writeUInt32BE(a.dev),i.writeUInt32BE(a.ino),i.writeUInt32BE(a.mode),i.writeUInt32BE(a.uid),i.writeUInt32BE(a.gid),i.writeUInt32BE(a.size),i.write(t.oid,20,"hex"),i.writeUInt16BE(P2e(t)),i.write(t.path,n.length,"utf8"),s}async toObject(){const t=un.alloc(12),n=new Eu(t);n.write("DIRC",4,"utf8"),n.writeUInt32BE(2),n.writeUInt32BE(this.entriesFlat.length);let r=[];for(const o of this.entries)if(r.push(om._entryToBuffer(o)),o.stages.length>1)for(const l of o.stages)l&&l!==o&&r.push(om._entryToBuffer(l));r=await Promise.all(r);const s=un.concat(r),i=un.concat([t,s]),a=await uf(i);return un.concat([i,un.from(a,"hex")])}}function ok(e,t,n=!0,r=!0){const s=wy(e),i=wy(t);return n&&s.mode!==i.mode||s.mtimeSeconds!==i.mtimeSeconds||s.ctimeSeconds!==i.ctimeSeconds||s.uid!==i.uid||s.gid!==i.gid||r&&s.ino!==i.ino||s.size!==i.size}let fM=null;const hM=Symbol("IndexCache");function O2e(){return{map:new Map,stats:new Map}}async function D2e(e,t,n){const[r,s]=await Promise.all([e.lstat(t),e.read(t)]),i=await om.from(s);n.map.set(t,i),n.stats.set(t,r)}async function F2e(e,t,n){const r=n.stats.get(t);if(r===void 0)return!0;if(r===null)return!1;const s=await e.lstat(t);return s===null?!1:ok(r,s)}class ma{static async acquire({fs:t,gitdir:n,cache:r,allowUnmerged:s=!0},i){r[hM]||(r[hM]=O2e());const a=`${n}/index`;fM===null&&(fM=new Cw({maxPending:1/0}));let o,l=[];return await fM.acquire(a,async()=>{const c=r[hM];await F2e(t,a,c)&&await D2e(t,a,c);const u=c.map.get(a);if(l=u.unmergedPaths,l.length&&!s)throw new L1(l);if(o=await i(u),u._dirty){const d=await u.toObject();await t.write(a,d),c.stats.set(a,await t.lstat(a)),u._dirty=!1}}),o}}function lk(e){const t=Math.max(e.lastIndexOf("/"),e.lastIndexOf("\\"));return t>-1&&(e=e.slice(t+1)),e}function Sy(e){const t=Math.max(e.lastIndexOf("/"),e.lastIndexOf("\\"));return t===-1?".":t===0?"/":e.slice(0,t)}function oZ(e){const t=new Map,n=function(s){if(!t.has(s)){const i={type:"tree",fullpath:s,basename:lk(s),metadata:{},children:[]};t.set(s,i),i.parent=n(Sy(s)),i.parent&&i.parent!==i&&i.parent.children.push(i)}return t.get(s)},r=function(s,i){if(!t.has(s)){const a={type:"blob",fullpath:s,basename:lk(s),metadata:i,parent:n(Sy(s)),children:[]};a.parent&&a.parent.children.push(a),t.set(s,a)}return t.get(s)};n(".");for(const s of e)r(s.path,s);return t}function L2e(e){switch(e){case 16384:return"tree";case 33188:return"blob";case 33261:return"blob";case 40960:return"blob";case 57344:return"commit"}throw new xr(`Unexpected GitTree entry mode: ${e.toString(8)}`)}class B2e{constructor({fs:t,gitdir:n,cache:r}){this.treePromise=ma.acquire({fs:t,gitdir:n,cache:r},async function(i){return oZ(i.entries)});const s=this;this.ConstructEntry=class{constructor(a){this._fullpath=a,this._type=!1,this._mode=!1,this._stat=!1,this._oid=!1}async type(){return s.type(this)}async mode(){return s.mode(this)}async stat(){return s.stat(this)}async content(){return s.content(this)}async oid(){return s.oid(this)}}}async readdir(t){const n=t._fullpath,s=(await this.treePromise).get(n);if(!s||s.type==="blob")return null;if(s.type!=="tree")throw new Error(`ENOTDIR: not a directory, scandir '${n}'`);const i=s.children.map(a=>a.fullpath);return i.sort(pT),i}async type(t){return t._type===!1&&await t.stat(),t._type}async mode(t){return t._mode===!1&&await t.stat(),t._mode}async stat(t){if(t._stat===!1){const r=(await this.treePromise).get(t._fullpath);if(!r)throw new Error(`ENOENT: no such file or directory, lstat '${t._fullpath}'`);const s=r.type==="tree"?{}:wy(r.metadata);t._type=r.type==="tree"?"tree":L2e(s.mode),t._mode=s.mode,r.type==="tree"?t._stat=void 0:t._stat=s}return t._stat}async content(t){}async oid(t){if(t._oid===!1){const r=(await this.treePromise).get(t._fullpath);t._oid=r.metadata.oid}return t._oid}}const mT=Symbol("GitWalkSymbol");function fb(){const e=Object.create(null);return Object.defineProperty(e,mT,{value:function({fs:t,gitdir:n,cache:r}){return new B2e({fs:t,gitdir:n,cache:r})}}),Object.freeze(e),e}class Rs extends Qr{constructor(t){super(`Could not find ${t}.`),this.code=this.name=Rs.code,this.data={what:t}}}Rs.code="NotFoundError";class To extends Qr{constructor(t,n,r,s){super(`Object ${t} ${s?`at ${s}`:""}was anticipated to be a ${r} but it is a ${n}.`),this.code=this.name=To.code,this.data={oid:t,actual:n,expected:r,filepath:s}}}To.code="ObjectTypeError";class Uh extends Qr{constructor(t){super(`Expected a 40-char hex object id but saw "${t}".`),this.code=this.name=Uh.code,this.data={value:t}}}Uh.code="InvalidOidError";class B1 extends Qr{constructor(t){super(`Could not find a fetch refspec for remote "${t}". Make sure the config file has an entry like the following:
[remote "${t}"]
	fetch = +refs/heads/*:refs/remotes/origin/*
`),this.code=this.name=B1.code,this.data={remote:t}}}B1.code="NoRefspecError";class ck{constructor(t){if(this.refs=new Map,this.parsedConfig=[],t){let n=null;this.parsedConfig=t.trim().split(`
`).map(r=>{if(/^\s*#/.test(r))return{line:r,comment:!0};const s=r.indexOf(" ");if(r.startsWith("^")){const i=r.slice(1);return this.refs.set(n+"^{}",i),{line:r,ref:n,peeled:i}}else{const i=r.slice(0,s);return n=r.slice(s+1),this.refs.set(n,i),{line:r,ref:n,oid:i}}})}return this}static from(t){return new ck(t)}delete(t){this.parsedConfig=this.parsedConfig.filter(n=>n.ref!==t),this.refs.delete(t)}toString(){return this.parsedConfig.map(({line:t})=>t).join(`
`)+`
`}}class uk{constructor({remotePath:t,localPath:n,force:r,matchPrefix:s}){Object.assign(this,{remotePath:t,localPath:n,force:r,matchPrefix:s})}static from(t){const[n,r,s,i,a]=t.match(/^(\+?)(.*?)(\*?):(.*?)(\*?)$/).slice(1),o=n==="+",l=s==="*";if(l!==(a==="*"))throw new xr("Invalid refspec");return new uk({remotePath:r,localPath:i,force:o,matchPrefix:l})}translate(t){if(this.matchPrefix){if(t.startsWith(this.remotePath))return this.localPath+t.replace(this.remotePath,"")}else if(t===this.remotePath)return this.localPath;return null}reverseTranslate(t){if(this.matchPrefix){if(t.startsWith(this.localPath))return this.remotePath+t.replace(this.localPath,"")}else if(t===this.localPath)return this.remotePath;return null}}class SD{constructor(t=[]){this.rules=t}static from(t){const n=[];for(const r of t)n.push(uk.from(r));return new SD(n)}add(t){const n=uk.from(t);this.rules.push(n)}translate(t){const n=[];for(const r of this.rules)for(const s of t){const i=r.translate(s);i&&n.push([s,i])}return n}translateOne(t){let n=null;for(const r of this.rules){const s=r.translate(t);s&&(n=s)}return n}localNamespaces(){return this.rules.filter(t=>t.matchPrefix).map(t=>t.localPath.replace(/\/$/,""))}}function $2e(e,t){const n=e.replace(/\^\{\}$/,""),r=t.replace(/\^\{\}$/,""),s=-(n<r)||+(n>r);return s===0?e.endsWith("^{}")?1:-1:s}const z2e=e=>{if(typeof e=="number")return e;e=e.toLowerCase();let t=parseInt(e);return e.endsWith("k")&&(t*=1024),e.endsWith("m")&&(t*=1024*1024),e.endsWith("g")&&(t*=1024*1024*1024),t},Hv=e=>{if(typeof e=="boolean")return e;if(e=e.trim().toLowerCase(),e==="true"||e==="yes"||e==="on")return!0;if(e==="false"||e==="no"||e==="off")return!1;throw Error(`Expected 'true', 'false', 'yes', 'no', 'on', or 'off', but got ${e}`)},T9={core:{filemode:Hv,bare:Hv,logallrefupdates:Hv,symlinks:Hv,ignorecase:Hv,bigFileThreshold:z2e}},U2e=/^\[([A-Za-z0-9-.]+)(?: "(.*)")?\]$/,q2e=/^[A-Za-z0-9-.]+$/,V2e=/^([A-Za-z][A-Za-z-]*)(?: *= *(.*))?$/,W2e=/^[A-Za-z][A-Za-z-]*$/,H2e=/^(.*?)( *[#;].*)$/,G2e=e=>{const t=U2e.exec(e);if(t!=null){const[n,r]=t.slice(1);return[n,r]}return null},K2e=e=>{const t=V2e.exec(e);if(t!=null){const[n,r="true"]=t.slice(1),s=Y2e(r),i=Z2e(s);return[n,i]}return null},Y2e=e=>{const t=H2e.exec(e);if(t==null)return e;const[n,r]=t.slice(1);return A9(n)&&A9(r)?`${n}${r}`:n},A9=e=>(e.match(/(?:^|[^\\])"/g)||[]).length%2!==0,Z2e=e=>e.split("").reduce((t,n,r,s)=>{const i=n==='"'&&s[r-1]!=="\\",a=n==="\\"&&s[r+1]==='"';return i||a?t:t+n},""),R9=e=>e!=null?e.toLowerCase():null,W3=(e,t,n)=>[R9(e),t,R9(n)].filter(r=>r!=null).join("."),N9=e=>{const t=e.split("."),n=t.shift(),r=t.pop(),s=t.length?t.join("."):void 0;return{section:n,subsection:s,name:r,path:W3(n,s,r),sectionPath:W3(n,s,null),isSection:!!n}},X2e=(e,t)=>e.reduce((n,r,s)=>t(r)?s:n,-1);class _D{constructor(t){let n=null,r=null;this.parsedConfig=t?t.split(`
`).map(s=>{let i=null,a=null;const o=s.trim(),l=G2e(o),c=l!=null;if(c)[n,r]=l;else{const d=K2e(o);d!=null&&([i,a]=d)}const u=W3(n,r,i);return{line:s,isSection:c,section:n,subsection:r,name:i,value:a,path:u}}):[]}static from(t){return new _D(t)}async get(t,n=!1){const r=N9(t).path,s=this.parsedConfig.filter(i=>i.path===r).map(({section:i,name:a,value:o})=>{const l=T9[i]&&T9[i][a];return l?l(o):o});return n?s:s.pop()}async getall(t){return this.get(t,!0)}async getSubsections(t){return this.parsedConfig.filter(n=>n.isSection&&n.section===t).map(n=>n.subsection)}async deleteSection(t,n){this.parsedConfig=this.parsedConfig.filter(r=>!(r.section===t&&r.subsection===n))}async append(t,n){return this.set(t,n,!0)}async set(t,n,r=!1){const{section:s,subsection:i,name:a,path:o,sectionPath:l,isSection:c}=N9(t),u=X2e(this.parsedConfig,d=>d.path===o);if(n==null)u!==-1&&this.parsedConfig.splice(u,1);else if(u!==-1){const d=this.parsedConfig[u],h=Object.assign({},d,{name:a,value:n,modified:!0});r?this.parsedConfig.splice(u+1,0,h):this.parsedConfig[u]=h}else{const d=this.parsedConfig.findIndex(m=>m.path===l),h={section:s,subsection:i,name:a,value:n,modified:!0,path:o};if(q2e.test(s)&&W2e.test(a))if(d>=0)this.parsedConfig.splice(d+1,0,h);else{const m={isSection:c,section:s,subsection:i,modified:!0,path:l};this.parsedConfig.push(m,h)}}}toString(){return this.parsedConfig.map(({line:t,section:n,subsection:r,name:s,value:i,modified:a=!1})=>a?s!=null&&i!=null?typeof i=="string"&&/[#;]/.test(i)?`	${s} = "${i}"`:`	${s} = ${i}`:r!=null?`[${n} "${r}"]`:`[${n}]`:t).join(`
`)}}class $i{static async get({fs:t,gitdir:n}){const r=await t.read(`${n}/config`,{encoding:"utf8"});return _D.from(r)}static async save({fs:t,gitdir:n,config:r}){await t.write(`${n}/config`,r.toString(),{encoding:"utf8"})}}const tC=e=>[`${e}`,`refs/${e}`,`refs/tags/${e}`,`refs/heads/${e}`,`refs/remotes/${e}`,`refs/remotes/${e}/HEAD`],J2e=["config","description","index","shallow","commondir"];let pM;async function dh(e,t){return pM===void 0&&(pM=new Cw),pM.acquire(e,t)}class Kt{static async updateRemoteRefs({fs:t,gitdir:n,remote:r,refs:s,symrefs:i,tags:a,refspecs:o=void 0,prune:l=!1,pruneTags:c=!1}){for(const v of s.values())if(!v.match(/[0-9a-f]{40}/))throw new Uh(v);const u=await $i.get({fs:t,gitdir:n});if(!o){if(o=await u.getall(`remote.${r}.fetch`),o.length===0)throw new B1(r);o.unshift(`+HEAD:refs/remotes/${r}/HEAD`)}const d=SD.from(o),h=new Map;if(c){const v=await Kt.listRefs({fs:t,gitdir:n,filepath:"refs/tags"});await Kt.deleteRefs({fs:t,gitdir:n,refs:v.map(x=>`refs/tags/${x}`)})}if(a){for(const v of s.keys())if(v.startsWith("refs/tags")&&!v.endsWith("^{}")&&!await Kt.exists({fs:t,gitdir:n,ref:v})){const x=s.get(v);h.set(v,x)}}const m=d.translate([...s.keys()]);for(const[v,x]of m){const w=s.get(v);h.set(x,w)}const y=d.translate([...i.keys()]);for(const[v,x]of y){const w=i.get(v),_=d.translateOne(w);_&&h.set(x,`ref: ${_}`)}const b=[];if(l){for(const v of d.localNamespaces()){const x=(await Kt.listRefs({fs:t,gitdir:n,filepath:v})).map(w=>`${v}/${w}`);for(const w of x)h.has(w)||b.push(w)}b.length>0&&await Kt.deleteRefs({fs:t,gitdir:n,refs:b})}for(const[v,x]of h)await dh(v,async()=>t.write(zt.join(n,v),`${x.trim()}
`,"utf8"));return{pruned:b}}static async writeRef({fs:t,gitdir:n,ref:r,value:s}){if(!s.match(/[0-9a-f]{40}/))throw new Uh(s);await dh(r,async()=>t.write(zt.join(n,r),`${s.trim()}
`,"utf8"))}static async writeSymbolicRef({fs:t,gitdir:n,ref:r,value:s}){await dh(r,async()=>t.write(zt.join(n,r),`ref: ${s.trim()}
`,"utf8"))}static async deleteRef({fs:t,gitdir:n,ref:r}){return Kt.deleteRefs({fs:t,gitdir:n,refs:[r]})}static async deleteRefs({fs:t,gitdir:n,refs:r}){await Promise.all(r.map(o=>t.rm(zt.join(n,o))));let s=await dh("packed-refs",async()=>t.read(`${n}/packed-refs`,{encoding:"utf8"}));const i=ck.from(s),a=i.refs.size;for(const o of r)i.refs.has(o)&&i.delete(o);i.refs.size<a&&(s=i.toString(),await dh("packed-refs",async()=>t.write(`${n}/packed-refs`,s,{encoding:"utf8"})))}static async resolve({fs:t,gitdir:n,ref:r,depth:s=void 0}){if(s!==void 0&&(s--,s===-1))return r;if(r.startsWith("ref: "))return r=r.slice(5),Kt.resolve({fs:t,gitdir:n,ref:r,depth:s});if(r.length===40&&/[0-9a-f]{40}/.test(r))return r;const i=await Kt.packedRefs({fs:t,gitdir:n}),a=tC(r).filter(o=>!J2e.includes(o));for(const o of a){const l=await dh(o,async()=>await t.read(`${n}/${o}`,{encoding:"utf8"})||i.get(o));if(l)return Kt.resolve({fs:t,gitdir:n,ref:l.trim(),depth:s})}throw new Rs(r)}static async exists({fs:t,gitdir:n,ref:r}){try{return await Kt.expand({fs:t,gitdir:n,ref:r}),!0}catch{return!1}}static async expand({fs:t,gitdir:n,ref:r}){if(r.length===40&&/[0-9a-f]{40}/.test(r))return r;const s=await Kt.packedRefs({fs:t,gitdir:n}),i=tC(r);for(const a of i)if(await dh(a,async()=>t.exists(`${n}/${a}`))||s.has(a))return a;throw new Rs(r)}static async expandAgainstMap({ref:t,map:n}){const r=tC(t);for(const s of r)if(await n.has(s))return s;throw new Rs(t)}static resolveAgainstMap({ref:t,fullref:n=t,depth:r=void 0,map:s}){if(r!==void 0&&(r--,r===-1))return{fullref:n,oid:t};if(t.startsWith("ref: "))return t=t.slice(5),Kt.resolveAgainstMap({ref:t,fullref:n,depth:r,map:s});if(t.length===40&&/[0-9a-f]{40}/.test(t))return{fullref:n,oid:t};const i=tC(t);for(const a of i){const o=s.get(a);if(o)return Kt.resolveAgainstMap({ref:o.trim(),fullref:a,depth:r,map:s})}throw new Rs(t)}static async packedRefs({fs:t,gitdir:n}){const r=await dh("packed-refs",async()=>t.read(`${n}/packed-refs`,{encoding:"utf8"}));return ck.from(r).refs}static async listRefs({fs:t,gitdir:n,filepath:r}){const s=Kt.packedRefs({fs:t,gitdir:n});let i=null;try{i=await t.readdirDeep(`${n}/${r}`),i=i.map(a=>a.replace(`${n}/${r}/`,""))}catch{i=[]}for(let a of(await s).keys())a.startsWith(r)&&(a=a.replace(r+"/",""),i.includes(a)||i.push(a));return i.sort($2e),i}static async listBranches({fs:t,gitdir:n,remote:r}){return r?Kt.listRefs({fs:t,gitdir:n,filepath:`refs/remotes/${r}`}):Kt.listRefs({fs:t,gitdir:n,filepath:"refs/heads"})}static async listTags({fs:t,gitdir:n}){return(await Kt.listRefs({fs:t,gitdir:n,filepath:"refs/tags"})).filter(s=>!s.endsWith("^{}"))}}function Q2e(e,t){return pT(I9(e),I9(t))}function I9(e){return e.mode==="040000"?e.path+"/":e.path}function lZ(e){switch(e){case"040000":return"tree";case"100644":return"blob";case"100755":return"blob";case"120000":return"blob";case"160000":return"commit"}throw new xr(`Unexpected GitTree entry mode: ${e}`)}function eke(e){const t=[];let n=0;for(;n<e.length;){const r=e.indexOf(32,n);if(r===-1)throw new xr(`GitTree: Error parsing buffer at byte location ${n}: Could not find the next space character.`);const s=e.indexOf(0,n);if(s===-1)throw new xr(`GitTree: Error parsing buffer at byte location ${n}: Could not find the next null character.`);let i=e.slice(n,r).toString("utf8");i==="40000"&&(i="040000");const a=lZ(i),o=e.slice(r+1,s).toString("utf8");if(o.includes("\\")||o.includes("/"))throw new db(o);const l=e.slice(s+1,s+21).toString("hex");n=s+21,t.push({mode:i,path:o,oid:l,type:a})}return t}function tke(e){if(typeof e=="number"&&(e=e.toString(8)),e.match(/^0?4.*/))return"040000";if(e.match(/^1006.*/))return"100644";if(e.match(/^1007.*/))return"100755";if(e.match(/^120.*/))return"120000";if(e.match(/^160.*/))return"160000";throw new xr(`Could not understand file mode: ${e}`)}function nke(e){return!e.oid&&e.sha&&(e.oid=e.sha),e.mode=tke(e.mode),e.type||(e.type=lZ(e.mode)),e}class Ko{constructor(t){if(un.isBuffer(t))this._entries=eke(t);else if(Array.isArray(t))this._entries=t.map(nke);else throw new xr("invalid type passed to GitTree constructor");this._entries.sort(sZ)}static from(t){return new Ko(t)}render(){return this._entries.map(t=>`${t.mode} ${t.type} ${t.oid}    ${t.path}`).join(`
`)}toObject(){const t=[...this._entries];return t.sort(Q2e),un.concat(t.map(n=>{const r=un.from(n.mode.replace(/^0/,"")),s=un.from(" "),i=un.from(n.path,"utf8"),a=un.from([0]),o=un.from(n.oid,"hex");return un.concat([r,s,i,a,o])}))}entries(){return this._entries}*[Symbol.iterator](){for(const t of this._entries)yield t}}class hb{static wrap({type:t,object:n}){return un.concat([un.from(`${t} ${n.byteLength.toString()}\0`),un.from(n)])}static unwrap(t){const n=t.indexOf(32),r=t.indexOf(0),s=t.slice(0,n).toString("utf8"),i=t.slice(n+1,r).toString("utf8"),a=t.length-(r+1);if(parseInt(i)!==a)throw new xr(`Length mismatch: expected ${i} bytes but got ${a} instead.`);return{type:s,object:un.from(t.slice(r+1))}}}async function cZ({fs:e,gitdir:t,oid:n}){const r=`objects/${n.slice(0,2)}/${n.slice(2)}`,s=await e.read(`${t}/${r}`);return s?{object:s,format:"deflated",source:r}:null}function rke(e,t){const n=new Eu(e),r=M9(n);if(r!==t.byteLength)throw new xr(`applyDelta expected source buffer to be ${r} bytes but the provided buffer was ${t.length} bytes`);const s=M9(n);let i;const a=P9(n,t);if(a.byteLength===s)i=a;else{i=un.alloc(s);const o=new Eu(i);for(o.copy(a);!n.eof();)o.copy(P9(n,t));const l=o.tell();if(s!==l)throw new xr(`applyDelta expected target buffer to be ${s} bytes but the resulting buffer was ${l} bytes`)}return i}function M9(e){let t=0,n=0,r=null;do r=e.readUInt8(),t|=(r&127)<<n,n+=7;while(r&128);return t}function j9(e,t,n){let r=0,s=0;for(;n--;)t&1&&(r|=e.readUInt8()<<s),t>>=1,s+=8;return r}function P9(e,t){const n=e.readUInt8(),r=128,s=15,i=112;if(n&r){const a=j9(e,n&s,4);let o=j9(e,(n&i)>>4,3);return o===0&&(o=65536),t.slice(a,a+o)}else return e.slice(n)}function ske(e){let t=[e];return{next(){return Promise.resolve({done:t.length===0,value:t.pop()})},return(){return t=[],{}},[Symbol.asyncIterator](){return this}}}function uZ(e){return e[Symbol.asyncIterator]?e[Symbol.asyncIterator]():e[Symbol.iterator]?e[Symbol.iterator]():e.next?e:ske(e)}class dZ{constructor(t){if(typeof un>"u")throw new Error("Missing Buffer dependency");this.stream=uZ(t),this.buffer=null,this.cursor=0,this.undoCursor=0,this.started=!1,this._ended=!1,this._discardedBytes=0}eof(){return this._ended&&this.cursor===this.buffer.length}tell(){return this._discardedBytes+this.cursor}async byte(){if(!this.eof()&&(this.started||await this._init(),!(this.cursor===this.buffer.length&&(await this._loadnext(),this._ended))))return this._moveCursor(1),this.buffer[this.undoCursor]}async chunk(){if(!this.eof()&&(this.started||await this._init(),!(this.cursor===this.buffer.length&&(await this._loadnext(),this._ended))))return this._moveCursor(this.buffer.length),this.buffer.slice(this.undoCursor,this.cursor)}async read(t){if(!this.eof())return this.started||await this._init(),this.cursor+t>this.buffer.length&&(this._trim(),await this._accumulate(t)),this._moveCursor(t),this.buffer.slice(this.undoCursor,this.cursor)}async skip(t){this.eof()||(this.started||await this._init(),this.cursor+t>this.buffer.length&&(this._trim(),await this._accumulate(t)),this._moveCursor(t))}async undo(){this.cursor=this.undoCursor}async _next(){this.started=!0;let{done:t,value:n}=await this.stream.next();return t&&(this._ended=!0,!n)?un.alloc(0):(n&&(n=un.from(n)),n)}_trim(){this.buffer=this.buffer.slice(this.undoCursor),this.cursor-=this.undoCursor,this._discardedBytes+=this.undoCursor,this.undoCursor=0}_moveCursor(t){this.undoCursor=this.cursor,this.cursor+=t,this.cursor>this.buffer.length&&(this.cursor=this.buffer.length)}async _accumulate(t){if(this._ended)return;const n=[this.buffer];for(;this.cursor+t>ike(n);){const r=await this._next();if(this._ended)break;n.push(r)}this.buffer=un.concat(n)}async _loadnext(){this._discardedBytes+=this.buffer.length,this.undoCursor=0,this.cursor=0,this.buffer=await this._next()}async _init(){this.buffer=await this._next()}}function ike(e){return e.reduce((t,n)=>t+n.length,0)}async function ake(e,t){const n=new dZ(e);let r=await n.read(4);if(r=r.toString("utf8"),r!=="PACK")throw new xr(`Invalid PACK header '${r}'`);let s=await n.read(4);if(s=s.readUInt32BE(0),s!==2)throw new xr(`Invalid packfile version: ${s}`);let i=await n.read(4);if(i=i.readUInt32BE(0),!(i<1))for(;!n.eof()&&i--;){const a=n.tell(),{type:o,length:l,ofs:c,reference:u}=await oke(n),d=new wD.Inflate;for(;!d.result;){const h=await n.chunk();if(!h)break;if(d.push(h,!1),d.err)throw new xr(`Pako error: ${d.msg}`);if(d.result){if(d.result.length!==l)throw new xr("Inflated object size is different from that stated in packfile.");await n.undo(),await n.read(h.length-d.strm.avail_in);const m=n.tell();await t({data:d.result,type:o,num:i,offset:a,end:m,reference:u,ofs:c})}}}}async function oke(e){let t=await e.byte();const n=t>>4&7;let r=t&15;if(t&128){let a=4;do t=await e.byte(),r|=(t&127)<<a,a+=7;while(t&128)}let s,i;if(n===6){let a=0;s=0;const o=[];do t=await e.byte(),s|=(t&127)<<a,a+=7,o.push(t);while(t&128);i=un.from(o)}return n===7&&(i=await e.read(20)),{type:n,length:r,ofs:s,reference:i}}async function fZ(e){return wD.inflate(e)}function lke(e){const t=[];let n=0,r=0;do{n=e.readUInt8();const s=n&127;t.push(s),r=n&128}while(r);return t.reduce((s,i)=>s+1<<7|i,-1)}function cke(e,t){let n=t,r=4,s=null;do s=e.readUInt8(),n|=(s&127)<<r,r+=7;while(s&128);return n}class _y{constructor(t){Object.assign(this,t),this.offsetCache={}}static async fromIdx({idx:t,getExternalRefDelta:n}){const r=new Eu(t);if(r.slice(4).toString("hex")!=="ff744f63")return;const i=r.readUInt32BE();if(i!==2)throw new xr(`Unable to read version ${i} packfile IDX. (Only version 2 supported)`);if(t.byteLength>2048*1024*1024)throw new xr("To keep implementation simple, I haven't implemented the layer 5 feature needed to support packfiles > 2GB in size.");r.seek(r.tell()+4*255);const a=r.readUInt32BE(),o=[];for(let u=0;u<a;u++){const d=r.slice(20).toString("hex");o[u]=d}r.seek(r.tell()+4*a);const l=new Map;for(let u=0;u<a;u++)l.set(o[u],r.readUInt32BE());const c=r.slice(20).toString("hex");return new _y({hashes:o,crcs:{},offsets:l,packfileSha:c,getExternalRefDelta:n})}static async fromPack({pack:t,getExternalRefDelta:n,onProgress:r}){const s={1:"commit",2:"tree",3:"blob",4:"tag",6:"ofs-delta",7:"ref-delta"},i={},a=t.slice(-20).toString("hex"),o=[],l={},c=new Map;let u=null,d=null;await ake([t],async({data:v,type:x,reference:w,offset:_,num:k})=>{u===null&&(u=k);const C=Math.floor((u-k)*100/u);C!==d&&r&&await r({phase:"Receiving objects",loaded:u-k,total:u}),d=C,x=s[x],["commit","tree","blob","tag"].includes(x)?i[_]={type:x,offset:_}:x==="ofs-delta"?i[_]={type:x,offset:_}:x==="ref-delta"&&(i[_]={type:x,offset:_})});const h=Object.keys(i).map(Number);for(const[v,x]of h.entries()){const w=v+1===h.length?t.byteLength-20:h[v+1],_=i[x],k=l2e.buf(t.slice(x,w))>>>0;_.end=w,_.crc=k}const m=new _y({pack:Promise.resolve(t),packfileSha:a,crcs:l,hashes:o,offsets:c,getExternalRefDelta:n});d=null;let y=0;const b=[0,0,0,0,0,0,0,0,0,0,0,0];for(let v in i){v=Number(v);const x=Math.floor(y*100/u);x!==d&&r&&await r({phase:"Resolving deltas",loaded:y,total:u}),y++,d=x;const w=i[v];if(!w.oid)try{m.readDepth=0,m.externalReadDepth=0;const{type:_,object:k}=await m.readSlice({start:v});b[m.readDepth]+=1;const C=await uf(hb.wrap({type:_,object:k}));w.oid=C,o.push(C),c.set(C,v),l[C]=w.crc}catch{continue}}return o.sort(),m}async toBuffer(){const t=[],n=(c,u)=>{t.push(un.from(c,u))};n("ff744f63","hex"),n("00000002","hex");const r=new Eu(un.alloc(256*4));for(let c=0;c<256;c++){let u=0;for(const d of this.hashes)parseInt(d.slice(0,2),16)<=c&&u++;r.writeUInt32BE(u)}t.push(r.buffer);for(const c of this.hashes)n(c,"hex");const s=new Eu(un.alloc(this.hashes.length*4));for(const c of this.hashes)s.writeUInt32BE(this.crcs[c]);t.push(s.buffer);const i=new Eu(un.alloc(this.hashes.length*4));for(const c of this.hashes)i.writeUInt32BE(this.offsets.get(c));t.push(i.buffer),n(this.packfileSha,"hex");const a=un.concat(t),o=await uf(a),l=un.alloc(20);return l.write(o,"hex"),un.concat([a,l])}async load({pack:t}){this.pack=t}async unload(){this.pack=null}async read({oid:t}){if(!this.offsets.get(t)){if(this.getExternalRefDelta)return this.externalReadDepth++,this.getExternalRefDelta(t);throw new xr(`Could not read object ${t} from packfile`)}const n=this.offsets.get(t);return this.readSlice({start:n})}async readSlice({start:t}){if(this.offsetCache[t])return Object.assign({},this.offsetCache[t]);this.readDepth++;const n={16:"commit",32:"tree",48:"blob",64:"tag",96:"ofs_delta",112:"ref_delta"};if(!this.pack)throw new xr("Tried to read from a GitPackIndex with no packfile loaded into memory");const r=(await this.pack).slice(t),s=new Eu(r),i=s.readUInt8(),a=i&112;let o=n[a];if(o===void 0)throw new xr("Unrecognized type: 0b"+a.toString(2));const l=i&15;let c=l;i&128&&(c=cke(s,l));let d=null,h=null;if(o==="ofs_delta"){const y=lke(s),b=t-y;({object:d,type:o}=await this.readSlice({start:b}))}if(o==="ref_delta"){const y=s.slice(20).toString("hex");({object:d,type:o}=await this.read({oid:y}))}const m=r.slice(s.tell());if(h=un.from(await fZ(m)),h.byteLength!==c)throw new xr(`Packfile told us object would have length ${c} but it had length ${h.byteLength}`);return d&&(h=un.from(rke(h,d))),this.readDepth>3&&(this.offsetCache[t]={type:o,object:h}),{type:o,format:"content",object:h}}}const nC=Symbol("PackfileCache");async function uke({fs:e,filename:t,getExternalRefDelta:n,emitter:r,emitterPrefix:s}){const i=await e.read(t);return _y.fromIdx({idx:i,getExternalRefDelta:n})}function CD({fs:e,cache:t,filename:n,getExternalRefDelta:r,emitter:s,emitterPrefix:i}){t[nC]||(t[nC]=new Map);let a=t[nC].get(n);return a||(a=uke({fs:e,filename:n,getExternalRefDelta:r,emitter:s,emitterPrefix:i}),t[nC].set(n,a)),a}async function dke({fs:e,cache:t,gitdir:n,oid:r,format:s="content",getExternalRefDelta:i}){let a=await e.readdir(zt.join(n,"objects/pack"));a=a.filter(o=>o.endsWith(".idx"));for(const o of a){const l=`${n}/objects/pack/${o}`,c=await CD({fs:e,cache:t,filename:l,getExternalRefDelta:i});if(c.error)throw new xr(c.error);if(c.offsets.has(r)){if(!c.pack){const d=l.replace(/idx$/,"pack");c.pack=e.read(d)}const u=await c.read({oid:r,getExternalRefDelta:i});return u.format="content",u.source=`objects/pack/${o.replace(/idx$/,"pack")}`,u}}return null}async function Js({fs:e,cache:t,gitdir:n,oid:r,format:s="content"}){const i=u=>Js({fs:e,cache:t,gitdir:n,oid:u});let a;if(r==="4b825dc642cb6eb9a060e54bf8d69288fbee4904"&&(a={format:"wrapped",object:un.from("tree 0\0")}),a||(a=await cZ({fs:e,gitdir:n,oid:r})),!a){if(a=await dke({fs:e,cache:t,gitdir:n,oid:r,getExternalRefDelta:i}),!a)throw new Rs(r);return a}if(s==="deflated"||(a.format==="deflated"&&(a.object=un.from(await fZ(a.object)),a.format="wrapped"),s==="wrapped"))return a;const o=await uf(a.object);if(o!==r)throw new xr(`SHA check failed! Expected ${r}, computed ${o}`);const{object:l,type:c}=hb.unwrap(a.object);if(a.type=c,a.object=l,a.format="content",s==="content")return a;throw new xr(`invalid requested format "${s}"`)}class Jc extends Qr{constructor(t,n,r=!0){super(`Failed to create ${t} at ${n} because it already exists.${r?` (Hint: use 'force: true' parameter to overwrite existing ${t}.)`:""}`),this.code=this.name=Jc.code,this.data={noun:t,where:n,canForce:r}}}Jc.code="AlreadyExistsError";class $1 extends Qr{constructor(t,n,r){super(`Found multiple ${t} matching "${n}" (${r.join(", ")}). Use a longer abbreviation length to disambiguate them.`),this.code=this.name=$1.code,this.data={nouns:t,short:n,matches:r}}}$1.code="AmbiguousError";class z1 extends Qr{constructor(t){super(`Your local changes to the following files would be overwritten by checkout: ${t.join(", ")}`),this.code=this.name=z1.code,this.data={filepaths:t}}}z1.code="CheckoutConflictError";class U1 extends Qr{constructor(t,n){super(`Failed to checkout "${t}" because commit ${n} is not available locally. Do a git fetch to make the branch available locally.`),this.code=this.name=U1.code,this.data={ref:t,oid:n}}}U1.code="CommitNotFetchedError";class q1 extends Qr{constructor(){super("Empty response from git server."),this.code=this.name=q1.code,this.data={}}}q1.code="EmptyServerResponseError";class V1 extends Qr{constructor(){super("A simple fast-forward merge was not possible."),this.code=this.name=V1.code,this.data={}}}V1.code="FastForwardError";class W1 extends Qr{constructor(t,n){super(`One or more branches were not updated: ${t}`),this.code=this.name=W1.code,this.data={prettyDetails:t,result:n}}}W1.code="GitPushError";class Cy extends Qr{constructor(t,n,r){super(`HTTP Error: ${t} ${n}`),this.code=this.name=Cy.code,this.data={statusCode:t,statusMessage:n,response:r}}}Cy.code="HttpError";class qh extends Qr{constructor(t){let n="invalid filepath";t==="leading-slash"||t==="trailing-slash"?n='"filepath" parameter should not include leading or trailing directory separators because these can cause problems on some platforms.':t==="directory"&&(n='"filepath" should not be a directory.'),super(n),this.code=this.name=qh.code,this.data={reason:t}}}qh.code="InvalidFilepathError";class Kc extends Qr{constructor(t,n){super(`"${t}" would be an invalid git reference. (Hint: a valid alternative would be "${n}".)`),this.code=this.name=Kc.code,this.data={ref:t,suggestion:n}}}Kc.code="InvalidRefNameError";class H1 extends Qr{constructor(t){super(`Maximum search depth of ${t} exceeded.`),this.code=this.name=H1.code,this.data={depth:t}}}H1.code="MaxDepthError";class pb extends Qr{constructor(){super("Merges with conflicts are not supported yet."),this.code=this.name=pb.code,this.data={}}}pb.code="MergeNotSupportedError";class mb extends Qr{constructor(t,n,r,s){super(`Automatic merge failed with one or more merge conflicts in the following files: ${t.toString()}. Fix conflicts then commit the result.`),this.code=this.name=mb.code,this.data={filepaths:t,bothModified:n,deleteByUs:r,deleteByTheirs:s}}}mb.code="MergeConflictError";class Ga extends Qr{constructor(t){super(`No name was provided for ${t} in the argument or in the .git/config file.`),this.code=this.name=Ga.code,this.data={role:t}}}Ga.code="MissingNameError";class Ho extends Qr{constructor(t){super(`The function requires a "${t}" parameter but none was provided.`),this.code=this.name=Ho.code,this.data={parameter:t}}}Ho.code="MissingParameterError";class G1 extends Qr{constructor(t){super('There are multiple errors that were thrown by the method. Please refer to the "errors" property to see more'),this.code=this.name=G1.code,this.data={errors:t},this.errors=t}}G1.code="MultipleGitError";class lg extends Qr{constructor(t,n){super(`Expected "${t}" but received "${n}".`),this.code=this.name=lg.code,this.data={expected:t,actual:n}}}lg.code="ParseError";class ky extends Qr{constructor(t){let n="";t==="not-fast-forward"?n=" because it was not a simple fast-forward":t==="tag-exists"&&(n=" because tag already exists"),super(`Push rejected${n}. Use "force: true" to override.`),this.code=this.name=ky.code,this.data={reason:t}}}ky.code="PushRejectedError";class kh extends Qr{constructor(t,n){super(`Remote does not support the "${t}" so the "${n}" parameter cannot be used.`),this.code=this.name=kh.code,this.data={capability:t,parameter:n}}}kh.code="RemoteCapabilityError";class K1 extends Qr{constructor(t,n){super(`Remote did not reply using the "smart" HTTP protocol. Expected "001e# service=git-upload-pack" but received: ${t}`),this.code=this.name=K1.code,this.data={preview:t,response:n}}}K1.code="SmartHttpError";class Y1 extends Qr{constructor(t,n,r){super(`Git remote "${t}" uses an unrecognized transport protocol: "${n}"`),this.code=this.name=Y1.code,this.data={url:t,transport:n,suggestion:r}}}Y1.code="UnknownTransportError";class Z1 extends Qr{constructor(t){super(`Cannot parse remote URL: "${t}"`),this.code=this.name=Z1.code,this.data={url:t}}}Z1.code="UrlParseError";class gb extends Qr{constructor(){super("The operation was canceled."),this.code=this.name=gb.code,this.data={}}}gb.code="UserCanceledError";class X1 extends Qr{constructor(t){super(`Could not merge index: Entry for '${t}' is not up to date. Either reset the index entry to HEAD, or stage your unstaged changes.`),this.code=this.name=X1.code,this.data={filepath:t}}}X1.code="IndexResetError";class J1 extends Qr{constructor(t){super(`"${t}" does not point to any commit. You're maybe working on a repository with no commits yet. `),this.code=this.name=J1.code,this.data={ref:t}}}J1.code="NoCommitError";var fke=Object.freeze({__proto__:null,AlreadyExistsError:Jc,AmbiguousError:$1,CheckoutConflictError:z1,CommitNotFetchedError:U1,EmptyServerResponseError:q1,FastForwardError:V1,GitPushError:W1,HttpError:Cy,InternalError:xr,InvalidFilepathError:qh,InvalidOidError:Uh,InvalidRefNameError:Kc,MaxDepthError:H1,MergeNotSupportedError:pb,MergeConflictError:mb,MissingNameError:Ga,MissingParameterError:Ho,MultipleGitError:G1,NoRefspecError:B1,NotFoundError:Rs,ObjectTypeError:To,ParseError:lg,PushRejectedError:ky,RemoteCapabilityError:kh,SmartHttpError:K1,UnknownTransportError:Y1,UnsafeFilepathError:db,UrlParseError:Z1,UserCanceledError:gb,UnmergedPathsError:L1,IndexResetError:X1,NoCommitError:J1});function H3({name:e,email:t,timestamp:n,timezoneOffset:r}){return r=hke(r),`${e} <${t}> ${n} ${r}`}function hke(e){const t=pke(mke(e));e=Math.abs(e);const n=Math.floor(e/60);e-=n*60;let r=String(n),s=String(e);return r.length<2&&(r="0"+r),s.length<2&&(s="0"+s),(t===-1?"-":"+")+r+s}function pke(e){return Math.sign(e)||(Object.is(e,-0)?-1:1)}function mke(e){return e===0?e:-e}function $d(e){return e=e.replace(/\r/g,""),e=e.replace(/^\n+/,""),e=e.replace(/\n+$/,"")+`
`,e}function dk(e){const[,t,n,r,s]=e.match(/^(.*) <(.*)> (.*) (.*)$/);return{name:t,email:n,timestamp:Number(r),timezoneOffset:gke(s)}}function gke(e){let[,t,n,r]=e.match(/(\+|-)(\d\d)(\d\d)/);return r=(t==="+"?1:-1)*(Number(n)*60+Number(r)),yke(r)}function yke(e){return e===0?e:-e}class uo{constructor(t){if(typeof t=="string")this._tag=t;else if(un.isBuffer(t))this._tag=t.toString("utf8");else if(typeof t=="object")this._tag=uo.render(t);else throw new xr("invalid type passed to GitAnnotatedTag constructor")}static from(t){return new uo(t)}static render(t){return`object ${t.object}
type ${t.type}
tag ${t.tag}
tagger ${H3(t.tagger)}

${t.message}
${t.gpgsig?t.gpgsig:""}`}justHeaders(){return this._tag.slice(0,this._tag.indexOf(`

`))}message(){const t=this.withoutSignature();return t.slice(t.indexOf(`

`)+2)}parse(){return Object.assign(this.headers(),{message:this.message(),gpgsig:this.gpgsig()})}render(){return this._tag}headers(){const t=this.justHeaders().split(`
`),n=[];for(const s of t)s[0]===" "?n[n.length-1]+=`
`+s.slice(1):n.push(s);const r={};for(const s of n){const i=s.slice(0,s.indexOf(" ")),a=s.slice(s.indexOf(" ")+1);Array.isArray(r[i])?r[i].push(a):r[i]=a}return r.tagger&&(r.tagger=dk(r.tagger)),r.committer&&(r.committer=dk(r.committer)),r}withoutSignature(){const t=$d(this._tag);return t.indexOf(`
-----BEGIN PGP SIGNATURE-----`)===-1?t:t.slice(0,t.lastIndexOf(`
-----BEGIN PGP SIGNATURE-----`))}gpgsig(){if(this._tag.indexOf(`
-----BEGIN PGP SIGNATURE-----`)===-1)return;const t=this._tag.slice(this._tag.indexOf("-----BEGIN PGP SIGNATURE-----"),this._tag.indexOf("-----END PGP SIGNATURE-----")+27);return $d(t)}payload(){return this.withoutSignature()+`
`}toObject(){return un.from(this._tag,"utf8")}static async sign(t,n,r){const s=t.payload();let{signature:i}=await n({payload:s,secretKey:r});i=$d(i);const a=s+i;return uo.from(a)}}function mM(e){return e.trim().split(`
`).map(t=>" "+t).join(`
`)+`
`}function bke(e){return e.split(`
`).map(t=>t.replace(/^ /,"")).join(`
`)}class Xs{constructor(t){if(typeof t=="string")this._commit=t;else if(un.isBuffer(t))this._commit=t.toString("utf8");else if(typeof t=="object")this._commit=Xs.render(t);else throw new xr("invalid type passed to GitCommit constructor")}static fromPayloadSignature({payload:t,signature:n}){const r=Xs.justHeaders(t),s=Xs.justMessage(t),i=$d(r+`
gpgsig`+mM(n)+`
`+s);return new Xs(i)}static from(t){return new Xs(t)}toObject(){return un.from(this._commit,"utf8")}headers(){return this.parseHeaders()}message(){return Xs.justMessage(this._commit)}parse(){return Object.assign({message:this.message()},this.headers())}static justMessage(t){return $d(t.slice(t.indexOf(`

`)+2))}static justHeaders(t){return t.slice(0,t.indexOf(`

`))}parseHeaders(){const t=Xs.justHeaders(this._commit).split(`
`),n=[];for(const s of t)s[0]===" "?n[n.length-1]+=`
`+s.slice(1):n.push(s);const r={parent:[]};for(const s of n){const i=s.slice(0,s.indexOf(" ")),a=s.slice(s.indexOf(" ")+1);Array.isArray(r[i])?r[i].push(a):r[i]=a}return r.author&&(r.author=dk(r.author)),r.committer&&(r.committer=dk(r.committer)),r}static renderHeaders(t){let n="";if(t.tree?n+=`tree ${t.tree}
`:n+=`tree 4b825dc642cb6eb9a060e54bf8d69288fbee4904
`,t.parent){if(t.parent.length===void 0)throw new xr("commit 'parent' property should be an array");for(const i of t.parent)n+=`parent ${i}
`}const r=t.author;n+=`author ${H3(r)}
`;const s=t.committer||t.author;return n+=`committer ${H3(s)}
`,t.gpgsig&&(n+="gpgsig"+mM(t.gpgsig)),n}static render(t){return Xs.renderHeaders(t)+`
`+$d(t.message)}render(){return this._commit}withoutSignature(){const t=$d(this._commit);if(t.indexOf(`
gpgsig`)===-1)return t;const n=t.slice(0,t.indexOf(`
gpgsig`)),r=t.slice(t.indexOf(`-----END PGP SIGNATURE-----
`)+28);return $d(n+`
`+r)}isolateSignature(){const t=this._commit.slice(this._commit.indexOf("-----BEGIN PGP SIGNATURE-----"),this._commit.indexOf("-----END PGP SIGNATURE-----")+27);return bke(t)}static async sign(t,n,r){const s=t.withoutSignature(),i=Xs.justMessage(t._commit);let{signature:a}=await n({payload:s,secretKey:r});a=$d(a);const l=Xs.justHeaders(t._commit)+`
gpgsig`+mM(a)+`
`+i;return Xs.from(l)}}async function Ey({fs:e,cache:t,gitdir:n,oid:r}){if(r==="4b825dc642cb6eb9a060e54bf8d69288fbee4904")return{tree:Ko.from([]),oid:r};const{type:s,object:i}=await Js({fs:e,cache:t,gitdir:n,oid:r});if(s==="tag")return r=uo.from(i).parse().object,Ey({fs:e,cache:t,gitdir:n,oid:r});if(s==="commit")return r=Xs.from(i).parse().tree,Ey({fs:e,cache:t,gitdir:n,oid:r});if(s!=="tree")throw new To(r,s,"tree");return{tree:Ko.from(i),oid:r}}class vke{constructor({fs:t,gitdir:n,ref:r,cache:s}){this.fs=t,this.cache=s,this.gitdir=n,this.mapPromise=(async()=>{const a=new Map;let o;try{o=await Kt.resolve({fs:t,gitdir:n,ref:r})}catch(c){c instanceof Rs&&(o="4b825dc642cb6eb9a060e54bf8d69288fbee4904")}const l=await Ey({fs:t,cache:this.cache,gitdir:n,oid:o});return l.type="tree",l.mode="40000",a.set(".",l),a})();const i=this;this.ConstructEntry=class{constructor(o){this._fullpath=o,this._type=!1,this._mode=!1,this._stat=!1,this._content=!1,this._oid=!1}async type(){return i.type(this)}async mode(){return i.mode(this)}async stat(){return i.stat(this)}async content(){return i.content(this)}async oid(){return i.oid(this)}}}async readdir(t){const n=t._fullpath,{fs:r,cache:s,gitdir:i}=this,a=await this.mapPromise,o=a.get(n);if(!o)throw new Error(`No obj for ${n}`);const l=o.oid;if(!l)throw new Error(`No oid for obj ${JSON.stringify(o)}`);if(o.type!=="tree")return null;const{type:c,object:u}=await Js({fs:r,cache:s,gitdir:i,oid:l});if(c!==o.type)throw new To(l,c,o.type);const d=Ko.from(u);for(const h of d)a.set(zt.join(n,h.path),h);return d.entries().map(h=>zt.join(n,h.path))}async type(t){if(t._type===!1){const n=await this.mapPromise,{type:r}=n.get(t._fullpath);t._type=r}return t._type}async mode(t){if(t._mode===!1){const n=await this.mapPromise,{mode:r}=n.get(t._fullpath);t._mode=iZ(parseInt(r,8))}return t._mode}async stat(t){}async content(t){if(t._content===!1){const n=await this.mapPromise,{fs:r,cache:s,gitdir:i}=this,o=n.get(t._fullpath).oid,{type:l,object:c}=await Js({fs:r,cache:s,gitdir:i,oid:o});l!=="blob"?t._content=void 0:t._content=new Uint8Array(c)}return t._content}async oid(t){if(t._oid===!1){const r=(await this.mapPromise).get(t._fullpath);t._oid=r.oid}return t._oid}}function Jl({ref:e="HEAD"}={}){const t=Object.create(null);return Object.defineProperty(t,mT,{value:function({fs:n,gitdir:r,cache:s}){return new vke({fs:n,gitdir:r,ref:e,cache:s})}}),Object.freeze(t),t}class xke{constructor({fs:t,dir:n,gitdir:r,cache:s}){this.fs=t,this.cache=s,this.dir=n,this.gitdir=r,this.config=null;const i=this;this.ConstructEntry=class{constructor(o){this._fullpath=o,this._type=!1,this._mode=!1,this._stat=!1,this._content=!1,this._oid=!1}async type(){return i.type(this)}async mode(){return i.mode(this)}async stat(){return i.stat(this)}async content(){return i.content(this)}async oid(){return i.oid(this)}}}async readdir(t){const n=t._fullpath,{fs:r,dir:s}=this,i=await r.readdir(zt.join(s,n));return i===null?null:i.map(a=>zt.join(n,a))}async type(t){return t._type===!1&&await t.stat(),t._type}async mode(t){return t._mode===!1&&await t.stat(),t._mode}async stat(t){if(t._stat===!1){const{fs:n,dir:r}=this;let s=await n.lstat(`${r}/${t._fullpath}`);if(!s)throw new Error(`ENOENT: no such file or directory, lstat '${t._fullpath}'`);let i=s.isDirectory()?"tree":"blob";i==="blob"&&!s.isFile()&&!s.isSymbolicLink()&&(i="special"),t._type=i,s=wy(s),t._mode=s.mode,s.size===-1&&t._actualSize&&(s.size=t._actualSize),t._stat=s}return t._stat}async content(t){if(t._content===!1){const{fs:n,dir:r,gitdir:s}=this;if(await t.type()==="tree")t._content=void 0;else{const a=await(await this._getGitConfig(n,s)).get("core.autocrlf"),o=await n.read(`${r}/${t._fullpath}`,{autocrlf:a});t._actualSize=o.length,t._stat&&t._stat.size===-1&&(t._stat.size=t._actualSize),t._content=new Uint8Array(o)}}return t._content}async oid(t){if(t._oid===!1){const n=this,{fs:r,gitdir:s,cache:i}=this;let a;await ma.acquire({fs:r,gitdir:s,cache:i},async function(o){const l=o.entriesMap.get(t._fullpath),c=await t.stat(),d=await(await n._getGitConfig(r,s)).get("core.filemode"),h=typeof Di<"u"?Di.platform!=="win32":!0;if(!l||ok(c,l,d,h)){const m=await t.content();m===void 0?a=void 0:(a=await uf(hb.wrap({type:"blob",object:m})),l&&a===l.oid&&(!d||c.mode===l.mode)&&ok(c,l,d,h)&&o.insert({filepath:t._fullpath,stats:c,oid:a}))}else a=l.oid}),t._oid=a}return t._oid}async _getGitConfig(t,n){return this.config?this.config:(this.config=await $i.get({fs:t,gitdir:n}),this.config)}}function Q1(){const e=Object.create(null);return Object.defineProperty(e,mT,{value:function({fs:t,dir:n,gitdir:r,cache:s}){return new xke({fs:t,dir:n,gitdir:r,cache:s})}}),Object.freeze(e),e}function wke(e,t){const n=t-e;return Array.from({length:n},(r,s)=>e+s)}const hZ=typeof Array.prototype.flat>"u"?e=>e.reduce((t,n)=>t.concat(n),[]):e=>e.flat();class Ske{constructor(){this.value=null}consider(t){t!=null&&(this.value===null?this.value=t:t<this.value&&(this.value=t))}reset(){this.value=null}}function*_ke(e){const t=new Ske;let n;const r=[],s=e.length;for(let i=0;i<s;i++)r[i]=e[i].next().value,r[i]!==void 0&&t.consider(r[i]);if(t.value!==null)for(;;){const i=[];n=t.value,t.reset();for(let a=0;a<s;a++)r[a]!==void 0&&r[a]===n?(i[a]=r[a],r[a]=e[a].next().value):i[a]=null,r[a]!==void 0&&t.consider(r[a]);if(yield i,t.value===null)return}}async function Vh({fs:e,cache:t,dir:n,gitdir:r,trees:s,map:i=async(l,c)=>c,reduce:a=async(l,c)=>{const u=hZ(c);return l!==void 0&&u.unshift(l),u},iterate:o=(l,c)=>Promise.all([...c].map(l))}){const l=s.map(m=>m[mT]({fs:e,dir:n,gitdir:r,cache:t})),c=new Array(l.length).fill("."),u=wke(0,l.length),d=async m=>{u.map(v=>{const x=m[v];m[v]=x&&new l[v].ConstructEntry(x)});const b=(await Promise.all(u.map(v=>{const x=m[v];return x?l[v].readdir(x):[]}))).map(v=>(v===null?[]:v)[Symbol.iterator]());return{entries:m,children:_ke(b)}},h=async m=>{const{entries:y,children:b}=await d(m),v=y.find(w=>w&&w._fullpath)._fullpath,x=await i(v,y);if(x!==null){let w=await o(h,b);return w=w.filter(_=>_!==void 0),a(x,w)}};return h(c)}async function G3(e,t){const n=await e.readdir(t);n==null?await e.rm(t):n.length?await Promise.all(n.map(r=>{const s=zt.join(t,r);return e.lstat(s).then(i=>{if(i)return i.isDirectory()?G3(e,s):e.rm(s)})})).then(()=>e.rmdir(t)):await e.rmdir(t)}function Cke(e){return kke(e)&&O9(e.then)&&O9(e.catch)}function kke(e){return e&&typeof e=="object"}function O9(e){return typeof e=="function"}function D9(e){return Cke((n=>{try{return n.readFile().catch(r=>r)}catch(r){return r}})(e))}const F9=["readFile","writeFile","mkdir","rmdir","unlink","stat","lstat","readdir","readlink","symlink"];function L9(e,t){if(D9(t))for(const n of F9)e[`_${n}`]=t[n].bind(t);else for(const n of F9)e[`_${n}`]=aM(t[n].bind(t));D9(t)?t.rm?e._rm=t.rm.bind(t):t.rmdir.length>1?e._rm=t.rmdir.bind(t):e._rm=G3.bind(null,e):t.rm?e._rm=aM(t.rm.bind(t)):t.rmdir.length>2?e._rm=aM(t.rmdir.bind(t)):e._rm=G3.bind(null,e)}class An{constructor(t){if(typeof t._original_unwrapped_fs<"u")return t;const n=Object.getOwnPropertyDescriptor(t,"promises");n&&n.enumerable?L9(this,t.promises):L9(this,t),this._original_unwrapped_fs=t}async exists(t,n={}){try{return await this._stat(t),!0}catch(r){if(r.code==="ENOENT"||r.code==="ENOTDIR"||(r.code||"").includes("ENS"))return!1;throw console.log('Unhandled error in "FileSystem.exists()" function',r),r}}async read(t,n={}){try{let r=await this._readFile(t,n);if(n.autocrlf==="true")try{r=new TextDecoder("utf8",{fatal:!0}).decode(r),r=r.replace(/\r\n/g,`
`),r=new TextEncoder().encode(r)}catch{}return typeof r!="string"&&(r=un.from(r)),r}catch{return null}}async write(t,n,r={}){try{await this._writeFile(t,n,r);return}catch{await this.mkdir(Sy(t)),await this._writeFile(t,n,r)}}async mkdir(t,n=!1){try{await this._mkdir(t);return}catch(r){if(r===null||r.code==="EEXIST")return;if(n)throw r;if(r.code==="ENOENT"){const s=Sy(t);if(s==="."||s==="/"||s===t)throw r;await this.mkdir(s),await this.mkdir(t,!0)}}}async rm(t){try{await this._unlink(t)}catch(n){if(n.code!=="ENOENT")throw n}}async rmdir(t,n){try{n&&n.recursive?await this._rm(t,n):await this._rmdir(t)}catch(r){if(r.code!=="ENOENT")throw r}}async readdir(t){try{const n=await this._readdir(t);return n.sort(pT),n}catch(n){return n.code==="ENOTDIR"?null:[]}}async readdirDeep(t){const n=await this._readdir(t);return(await Promise.all(n.map(async s=>{const i=t+"/"+s;return(await this._stat(i)).isDirectory()?this.readdirDeep(i):i}))).reduce((s,i)=>s.concat(i),[])}async lstat(t){try{return await this._lstat(t)}catch(n){if(n.code==="ENOENT"||(n.code||"").includes("ENS"))return null;throw n}}async readlink(t,n={encoding:"buffer"}){try{const r=await this._readlink(t,n);return un.isBuffer(r)?r:un.from(r)}catch(r){if(r.code==="ENOENT"||(r.code||"").includes("ENS"))return null;throw r}}async writelink(t,n){return this._symlink(n.toString("utf8"),t)}}function dt(e,t){if(t===void 0)throw new Ho(e)}async function fk(e,t){return!e&&!t?!1:e&&!t||!e&&t?!0:!(await e.type()==="tree"&&await t.type()==="tree"||await e.type()===await t.type()&&await e.mode()===await t.mode()&&await e.oid()===await t.oid())}async function Eke({fs:e,dir:t,gitdir:n=zt.join(t,".git"),commit:r="HEAD",cache:s={}}){try{dt("fs",e),dt("dir",t),dt("gitdir",n);const i=new An(e),a=[Jl({ref:r}),Q1(),fb()];let o=[];await ma.acquire({fs:i,gitdir:n,cache:s},async function(c){o=c.unmergedPaths});const l=await Vh({fs:i,cache:s,dir:t,gitdir:n,trees:a,map:async function(c,[u,d,h]){const m=!await fk(d,h),y=o.includes(c),b=!await fk(h,u);if(m||y)return u?{path:c,mode:await u.mode(),oid:await u.oid(),type:await u.type(),content:await u.content()}:void 0;if(b)return!1;throw new X1(c)}});await ma.acquire({fs:i,gitdir:n,cache:s},async function(c){for(const u of l)if(u!==!1){if(!u){await i.rmdir(`${t}/${u.path}`,{recursive:!0}),c.delete({filepath:u.path});continue}if(u.type==="blob"){const d=new TextDecoder().decode(u.content);await i.write(`${t}/${u.path}`,d,{mode:u.mode}),c.insert({filepath:u.path,oid:u.oid,stage:0})}}})}catch(i){throw i.caller="git.abortMerge",i}}class yb{static async isIgnored({fs:t,dir:n,gitdir:r=zt.join(n,".git"),filepath:s}){if(lk(s)===".git")return!0;if(s===".")return!1;let i="";const a=zt.join(r,"info","exclude");await t.exists(a)&&(i=await t.read(a,"utf8"));const o=[{gitignore:zt.join(n,".gitignore"),filepath:s}],l=s.split("/").filter(Boolean);for(let u=1;u<l.length;u++){const d=l.slice(0,u).join("/"),h=l.slice(u).join("/");o.push({gitignore:zt.join(n,d,".gitignore"),filepath:h})}let c=!1;for(const u of o){let d;try{d=await t.read(u.gitignore,"utf8")}catch(y){if(y.code==="NOENT")continue}const h=_2e().add(i);h.add(d);const m=Sy(u.filepath);if(m!=="."&&h.ignores(m))return!0;c?c=!h.test(u.filepath).unignored:c=h.test(u.filepath).ignored}return c}}async function Tke({fs:e,gitdir:t,object:n,format:r,oid:s}){const i=`objects/${s.slice(0,2)}/${s.slice(2)}`,a=`${t}/${i}`;await e.exists(a)||await e.write(a,n)}let gM=null;async function pZ(e){return gM===null&&(gM=Rke()),gM?Ake(e):wD.deflate(e)}async function Ake(e){const t=new CompressionStream("deflate"),n=new Blob([e]).stream().pipeThrough(t);return new Uint8Array(await new Response(n).arrayBuffer())}function Rke(){try{return new CompressionStream("deflate").writable.close(),new Blob([]).stream().cancel(),!0}catch{return!1}}async function Jo({fs:e,gitdir:t,type:n,object:r,format:s="content",oid:i=void 0,dryRun:a=!1}){return s!=="deflated"&&(s!=="wrapped"&&(r=hb.wrap({type:n,object:r})),i=await uf(r),r=un.from(await pZ(r))),a||await Tke({fs:e,gitdir:t,object:r,format:"deflated",oid:i}),i}function mZ(e){let t;for(;~(t=e.indexOf(92));)e[t]=47;return e}async function Nke({fs:e,dir:t,gitdir:n=zt.join(t,".git"),filepath:r,cache:s={},force:i=!1,parallel:a=!0}){try{dt("fs",e),dt("dir",t),dt("gitdir",n),dt("filepath",r);const o=new An(e);await ma.acquire({fs:o,gitdir:n,cache:s},async l=>{const u=await(await $i.get({fs:o,gitdir:n})).get("core.autocrlf");return K3({dir:t,gitdir:n,fs:o,filepath:r,index:l,force:i,parallel:a,autocrlf:u})})}catch(o){throw o.caller="git.add",o}}async function K3({dir:e,gitdir:t,fs:n,filepath:r,index:s,force:i,parallel:a,autocrlf:o}){r=Array.isArray(r)?r:[r];const l=r.map(async h=>{if(!i&&await yb.isIgnored({fs:n,dir:e,gitdir:t,filepath:h}))return;const m=await n.lstat(zt.join(e,h));if(!m)throw new Rs(h);if(m.isDirectory()){const y=await n.readdir(zt.join(e,h));if(a){const b=y.map(v=>K3({dir:e,gitdir:t,fs:n,filepath:[zt.join(h,v)],index:s,force:i,parallel:a,autocrlf:o}));await Promise.all(b)}else for(const b of y)await K3({dir:e,gitdir:t,fs:n,filepath:[zt.join(h,b)],index:s,force:i,parallel:a,autocrlf:o})}else{const y=m.isSymbolicLink()?await n.readlink(zt.join(e,h)).then(mZ):await n.read(zt.join(e,h),{autocrlf:o});if(y===null)throw new Rs(h);const b=await Jo({fs:n,gitdir:t,type:"blob",object:y});s.insert({filepath:h,stats:m,oid:b})}}),c=await Promise.allSettled(l),u=c.filter(h=>h.status==="rejected").map(h=>h.reason);if(u.length>1)throw new G1(u);if(u.length===1)throw u[0];return c.filter(h=>h.status==="fulfilled"&&h.value).map(h=>h.value)}async function kw({fs:e,gitdir:t,path:n}){return(await $i.get({fs:e,gitdir:t})).get(n)}function gZ(e,...t){for(const n of t)if(n)for(const r of Object.keys(n)){const s=n[r];s!==void 0&&(e[r]=s)}return e}async function Wh({fs:e,gitdir:t,author:n,commit:r}){const s=Math.floor(Date.now()/1e3),i={name:await kw({fs:e,gitdir:t,path:"user.name"}),email:await kw({fs:e,gitdir:t,path:"user.email"})||"",timestamp:s,timezoneOffset:new Date(s*1e3).getTimezoneOffset()},a=gZ({},i,r?r.author:void 0,n);if(a.name!==void 0)return a}async function Ty({fs:e,gitdir:t,author:n,committer:r,commit:s}){const i=Math.floor(Date.now()/1e3),a={name:await kw({fs:e,gitdir:t,path:"user.name"}),email:await kw({fs:e,gitdir:t,path:"user.email"})||"",timestamp:i,timezoneOffset:new Date(i*1e3).getTimezoneOffset()},o=gZ({},a,s?s.committer:void 0,n,r);if(o.name!==void 0)return o}async function yZ({fs:e,cache:t,gitdir:n,oid:r}){const{type:s,object:i}=await Js({fs:e,cache:t,gitdir:n,oid:r});if(s==="tag")return r=uo.from(i).parse().object,yZ({fs:e,cache:t,gitdir:n,oid:r});if(s!=="commit")throw new To(r,s,"commit");return{commit:Xs.from(i),oid:r}}async function Ay({fs:e,cache:t,gitdir:n,oid:r}){const{commit:s,oid:i}=await yZ({fs:e,cache:t,gitdir:n,oid:r});return{oid:i,commit:s.parse(),payload:s.withoutSignature()}}async function gT({fs:e,cache:t,onSign:n,gitdir:r,message:s,author:i,committer:a,signingKey:o,amend:l=!1,dryRun:c=!1,noUpdateBranch:u=!1,ref:d,parent:h,tree:m}){let y=!1;d||(d=await Kt.resolve({fs:e,gitdir:r,ref:"HEAD",depth:2}));let b,v;try{b=await Kt.resolve({fs:e,gitdir:r,ref:d}),v=await Ay({fs:e,gitdir:r,oid:b,cache:{}})}catch{y=!0}if(l&&y)throw new J1(d);const x=l?await Wh({fs:e,gitdir:r,author:i,commit:v.commit}):await Wh({fs:e,gitdir:r,author:i});if(!x)throw new Ga("author");const w=l?await Ty({fs:e,gitdir:r,author:x,committer:a,commit:v.commit}):await Ty({fs:e,gitdir:r,author:x,committer:a});if(!w)throw new Ga("committer");return ma.acquire({fs:e,gitdir:r,cache:t,allowUnmerged:!1},async function(_){const C=oZ(_.entries).get(".");if(m||(m=await bZ({fs:e,gitdir:r,inode:C,dryRun:c})),h?h=await Promise.all(h.map(N=>Kt.resolve({fs:e,gitdir:r,ref:N}))):l?h=v.commit.parent:h=b?[b]:[],!s)if(l)s=v.commit.message;else throw new Ho("message");let T=Xs.from({tree:m,parent:h,author:x,committer:w,message:s});o&&(T=await Xs.sign(T,n,o));const A=await Jo({fs:e,gitdir:r,type:"commit",object:T.toObject(),dryRun:c});return!u&&!c&&await Kt.writeRef({fs:e,gitdir:r,ref:d,value:A}),A})}async function bZ({fs:e,gitdir:t,inode:n,dryRun:r}){const s=n.children;for(const l of s)l.type==="tree"&&(l.metadata.mode="040000",l.metadata.oid=await bZ({fs:e,gitdir:t,inode:l,dryRun:r}));const i=s.map(l=>({mode:l.metadata.mode,path:l.basename,oid:l.metadata.oid,type:l.type})),a=Ko.from(i);return await Jo({fs:e,gitdir:t,type:"tree",object:a.toObject(),dryRun:r})}async function eS({fs:e,cache:t,gitdir:n,oid:r,filepath:s}){if(s.startsWith("/"))throw new qh("leading-slash");if(s.endsWith("/"))throw new qh("trailing-slash");const i=r,a=await Ey({fs:e,cache:t,gitdir:n,oid:r}),o=a.tree;if(s==="")r=a.oid;else{const l=s.split("/");r=await vZ({fs:e,cache:t,gitdir:n,tree:o,pathArray:l,oid:i,filepath:s})}return r}async function vZ({fs:e,cache:t,gitdir:n,tree:r,pathArray:s,oid:i,filepath:a}){const o=s.shift();for(const l of r)if(l.path===o){if(s.length===0)return l.oid;{const{type:c,object:u}=await Js({fs:e,cache:t,gitdir:n,oid:l.oid});if(c!=="tree")throw new To(i,c,"tree",a);return r=Ko.from(u),vZ({fs:e,cache:t,gitdir:n,tree:r,pathArray:s,oid:i,filepath:a})}}throw new Rs(`file or directory found at "${i}:${a}"`)}async function bb({fs:e,cache:t,gitdir:n,oid:r,filepath:s=void 0}){s!==void 0&&(r=await eS({fs:e,cache:t,gitdir:n,oid:r,filepath:s}));const{tree:i,oid:a}=await Ey({fs:e,cache:t,gitdir:n,oid:r});return{oid:a,tree:i.entries()}}async function tS({fs:e,gitdir:t,tree:n}){const r=Ko.from(n).toObject();return await Jo({fs:e,gitdir:t,type:"tree",object:r,format:"content"})}async function Ike({fs:e,cache:t,onSign:n,gitdir:r,ref:s,oid:i,note:a,force:o,author:l,committer:c,signingKey:u}){let d;try{d=await Kt.resolve({gitdir:r,fs:e,ref:s})}catch(x){if(!(x instanceof Rs))throw x}let m=(await bb({fs:e,cache:t,gitdir:r,oid:d||"4b825dc642cb6eb9a060e54bf8d69288fbee4904"})).tree;if(o)m=m.filter(x=>x.path!==i);else for(const x of m)if(x.path===i)throw new Jc("note",i);typeof a=="string"&&(a=un.from(a,"utf8"));const y=await Jo({fs:e,gitdir:r,type:"blob",object:a,format:"content"});m.push({mode:"100644",path:i,oid:y,type:"blob"});const b=await tS({fs:e,gitdir:r,tree:m});return await gT({fs:e,cache:t,onSign:n,gitdir:r,ref:s,tree:b,parent:d&&[d],message:`Note added by 'isomorphic-git addNote'
`,author:l,committer:c,signingKey:u})}async function Mke({fs:e,onSign:t,dir:n,gitdir:r=zt.join(n,".git"),ref:s="refs/notes/commits",oid:i,note:a,force:o,author:l,committer:c,signingKey:u,cache:d={}}){try{dt("fs",e),dt("gitdir",r),dt("oid",i),dt("note",a),u&&dt("onSign",t);const h=new An(e),m=await Wh({fs:h,gitdir:r,author:l});if(!m)throw new Ga("author");const y=await Ty({fs:h,gitdir:r,author:m,committer:c});if(!y)throw new Ga("committer");return await Ike({fs:new An(h),cache:d,onSign:t,gitdir:r,ref:s,oid:i,note:a,force:o,author:m,committer:y,signingKey:u})}catch(h){throw h.caller="git.addNote",h}}async function xZ({fs:e,gitdir:t,remote:n,url:r,force:s}){if(n!==Ru.clean(n))throw new Kc(n,Ru.clean(n));const i=await $i.get({fs:e,gitdir:t});if(!s&&(await i.getSubsections("remote")).includes(n)&&r!==await i.get(`remote.${n}.url`))throw new Jc("remote",n);await i.set(`remote.${n}.url`,r),await i.set(`remote.${n}.fetch`,`+refs/heads/*:refs/remotes/${n}/*`),await $i.save({fs:e,gitdir:t,config:i})}async function jke({fs:e,dir:t,gitdir:n=zt.join(t,".git"),remote:r,url:s,force:i=!1}){try{return dt("fs",e),dt("gitdir",n),dt("remote",r),dt("url",s),await xZ({fs:new An(e),gitdir:n,remote:r,url:s,force:i})}catch(a){throw a.caller="git.addRemote",a}}async function Pke({fs:e,cache:t,onSign:n,gitdir:r,ref:s,tagger:i,message:a=s,gpgsig:o,object:l,signingKey:c,force:u=!1}){if(s=s.startsWith("refs/tags/")?s:`refs/tags/${s}`,!u&&await Kt.exists({fs:e,gitdir:r,ref:s}))throw new Jc("tag",s);const d=await Kt.resolve({fs:e,gitdir:r,ref:l||"HEAD"}),{type:h}=await Js({fs:e,cache:t,gitdir:r,oid:d});let m=uo.from({object:d,type:h,tag:s.replace("refs/tags/",""),tagger:i,message:a,gpgsig:o});c&&(m=await uo.sign(m,n,c));const y=await Jo({fs:e,gitdir:r,type:"tag",object:m.toObject()});await Kt.writeRef({fs:e,gitdir:r,ref:s,value:y})}async function Oke({fs:e,onSign:t,dir:n,gitdir:r=zt.join(n,".git"),ref:s,tagger:i,message:a=s,gpgsig:o,object:l,signingKey:c,force:u=!1,cache:d={}}){try{dt("fs",e),dt("gitdir",r),dt("ref",s),c&&dt("onSign",t);const h=new An(e),m=await Wh({fs:h,gitdir:r,author:i});if(!m)throw new Ga("tagger");return await Pke({fs:h,cache:d,onSign:t,gitdir:r,ref:s,tagger:m,message:a,gpgsig:o,object:l,signingKey:c,force:u})}catch(h){throw h.caller="git.annotatedTag",h}}async function Dke({fs:e,gitdir:t,ref:n,object:r,checkout:s=!1,force:i=!1}){if(n!==Ru.clean(n))throw new Kc(n,Ru.clean(n));const a=`refs/heads/${n}`;if(!i&&await Kt.exists({fs:e,gitdir:t,ref:a}))throw new Jc("branch",n,!1);let o;try{o=await Kt.resolve({fs:e,gitdir:t,ref:r||"HEAD"})}catch{}o&&await Kt.writeRef({fs:e,gitdir:t,ref:a,value:o}),s&&await Kt.writeSymbolicRef({fs:e,gitdir:t,ref:"HEAD",value:a})}async function Fke({fs:e,dir:t,gitdir:n=zt.join(t,".git"),ref:r,object:s,checkout:i=!1,force:a=!1}){try{return dt("fs",e),dt("gitdir",n),dt("ref",r),await Dke({fs:new An(e),gitdir:n,ref:r,object:s,checkout:i,force:a})}catch(o){throw o.caller="git.branch",o}}const wZ=(e,t)=>e==="."||t==null||t.length===0||t==="."?!0:t.length>=e.length?t.startsWith(e):e.startsWith(t);async function kD({fs:e,cache:t,onProgress:n,onPostCheckout:r,dir:s,gitdir:i,remote:a,ref:o,filepaths:l,noCheckout:c,noUpdateHead:u,dryRun:d,force:h,track:m=!0}){let y;if(r)try{y=await Kt.resolve({fs:e,gitdir:i,ref:"HEAD"})}catch{y="0000000000000000000000000000000000000000"}let b;try{b=await Kt.resolve({fs:e,gitdir:i,ref:o})}catch(v){if(o==="HEAD")throw v;const x=`${a}/${o}`;if(b=await Kt.resolve({fs:e,gitdir:i,ref:x}),m){const w=await $i.get({fs:e,gitdir:i});await w.set(`branch.${o}.remote`,a),await w.set(`branch.${o}.merge`,`refs/heads/${o}`),await $i.save({fs:e,gitdir:i,config:w})}await Kt.writeRef({fs:e,gitdir:i,ref:`refs/heads/${o}`,value:b})}if(!c){let v;try{v=await Lke({fs:e,cache:t,onProgress:n,dir:s,gitdir:i,ref:o,force:h,filepaths:l})}catch(C){throw C instanceof Rs&&C.data.what===b?new U1(o,b):C}const x=v.filter(([C])=>C==="conflict").map(([C,T])=>T);if(x.length>0)throw new z1(x);const w=v.filter(([C])=>C==="error").map(([C,T])=>T);if(w.length>0)throw new xr(w.join(", "));if(d){r&&await r({previousHead:y,newHead:b,type:l!=null&&l.length>0?"file":"branch"});return}let _=0;const k=v.length;await ma.acquire({fs:e,gitdir:i,cache:t},async function(C){await Promise.all(v.filter(([T])=>T==="delete"||T==="delete-index").map(async function([T,A]){const N=`${s}/${A}`;T==="delete"&&await e.rm(N),C.delete({filepath:A}),n&&await n({phase:"Updating workdir",loaded:++_,total:k})}))}),await ma.acquire({fs:e,gitdir:i,cache:t},async function(C){for(const[T,A]of v)if(T==="rmdir"||T==="rmdir-index"){const N=`${s}/${A}`;try{T==="rmdir-index"&&C.delete({filepath:A}),await e.rmdir(N),n&&await n({phase:"Updating workdir",loaded:++_,total:k})}catch(I){if(I.code==="ENOTEMPTY")console.log(`Did not delete ${A} because directory is not empty`);else throw I}}}),await Promise.all(v.filter(([C])=>C==="mkdir"||C==="mkdir-index").map(async function([C,T]){const A=`${s}/${T}`;await e.mkdir(A),n&&await n({phase:"Updating workdir",loaded:++_,total:k})})),await ma.acquire({fs:e,gitdir:i,cache:t},async function(C){await Promise.all(v.filter(([T])=>T==="create"||T==="create-index"||T==="update"||T==="mkdir-index").map(async function([T,A,N,I,j]){const L=`${s}/${A}`;try{if(T!=="create-index"&&T!=="mkdir-index"){const{object:H}=await Js({fs:e,cache:t,gitdir:i,oid:N});if(j&&await e.rm(L),I===33188)await e.write(L,H);else if(I===33261)await e.write(L,H,{mode:511});else if(I===40960)await e.writelink(L,H);else throw new xr(`Invalid mode 0o${I.toString(8)} detected in blob ${N}`)}const D=await e.lstat(L);I===33261&&(D.mode=493),T==="mkdir-index"&&(D.mode=57344),C.insert({filepath:A,stats:D,oid:N}),n&&await n({phase:"Updating workdir",loaded:++_,total:k})}catch(D){console.log(D)}}))}),r&&await r({previousHead:y,newHead:b,type:l!=null&&l.length>0?"file":"branch"})}if(!u){const v=await Kt.expand({fs:e,gitdir:i,ref:o});v.startsWith("refs/heads")?await Kt.writeSymbolicRef({fs:e,gitdir:i,ref:"HEAD",value:v}):await Kt.writeRef({fs:e,gitdir:i,ref:"HEAD",value:b})}}async function Lke({fs:e,cache:t,onProgress:n,dir:r,gitdir:s,ref:i,force:a,filepaths:o}){let l=0;return Vh({fs:e,cache:t,dir:r,gitdir:s,trees:[Jl({ref:i}),Q1(),fb()],map:async function(c,[u,d,h]){if(c===".")return;if(o&&!o.some(y=>wZ(c,y)))return null;switch(n&&await n({phase:"Analyzing workdir",loaded:++l}),[!!h,!!u,!!d].map(Number).join("")){case"000":return;case"001":return a&&o&&o.includes(c)?["delete",c]:void 0;case"010":switch(await u.type()){case"tree":return["mkdir",c];case"blob":return["create",c,await u.oid(),await u.mode()];case"commit":return["mkdir-index",c,await u.oid(),await u.mode()];default:return["error",`new entry Unhandled type ${await u.type()}`]}case"011":switch(`${await u.type()}-${await d.type()}`){case"tree-tree":return;case"tree-blob":case"blob-tree":return["conflict",c];case"blob-blob":return await u.oid()!==await d.oid()?a?["update",c,await u.oid(),await u.mode(),await u.mode()!==await d.mode()]:["conflict",c]:await u.mode()!==await d.mode()?a?["update",c,await u.oid(),await u.mode(),!0]:["conflict",c]:["create-index",c,await u.oid(),await u.mode()];case"commit-tree":return;case"commit-blob":return["conflict",c];default:return["error",`new entry Unhandled type ${u.type}`]}case"100":return["delete-index",c];case"101":switch(await h.type()){case"tree":return["rmdir",c];case"blob":return await h.oid()!==await d.oid()?a?["delete",c]:["conflict",c]:["delete",c];case"commit":return["rmdir-index",c];default:return["error",`delete entry Unhandled type ${await h.type()}`]}case"110":case"111":switch(`${await h.type()}-${await u.type()}`){case"tree-tree":return;case"blob-blob":{if(await h.oid()===await u.oid()&&await h.mode()===await u.mode()&&!a)return;if(d){if(await d.oid()!==await h.oid()&&await d.oid()!==await u.oid())return a?["update",c,await u.oid(),await u.mode(),await u.mode()!==await d.mode()]:["conflict",c]}else if(a)return["update",c,await u.oid(),await u.mode(),await u.mode()!==await h.mode()];return await u.mode()!==await h.mode()?["update",c,await u.oid(),await u.mode(),!0]:await u.oid()!==await h.oid()?["update",c,await u.oid(),await u.mode(),!1]:void 0}case"tree-blob":return["update-dir-to-blob",c,await u.oid()];case"blob-tree":return["update-blob-to-tree",c];case"commit-commit":return["mkdir-index",c,await u.oid(),await u.mode()];default:return["error",`update entry Unhandled type ${await h.type()}-${await u.type()}`]}}},reduce:async function(c,u){return u=hZ(u),c?c&&c[0]==="rmdir"?(u.push(c),u):(u.unshift(c),u):u}})}async function SZ({fs:e,onProgress:t,onPostCheckout:n,dir:r,gitdir:s=zt.join(r,".git"),remote:i="origin",ref:a,filepaths:o,noCheckout:l=!1,noUpdateHead:c=a===void 0,dryRun:u=!1,force:d=!1,track:h=!0,cache:m={}}){try{dt("fs",e),dt("dir",r),dt("gitdir",s);const y=a||"HEAD";return await kD({fs:new An(e),cache:m,onProgress:t,onPostCheckout:n,dir:r,gitdir:s,remote:i,ref:y,filepaths:o,noCheckout:l,noUpdateHead:c,dryRun:u,force:d,track:h})}catch(y){throw y.caller="git.checkout",y}}const Bke=new RegExp("^refs/(heads/|tags/|remotes/)?(.*)");function dm(e){const t=Bke.exec(e);return t?t[1]==="remotes/"&&e.endsWith("/HEAD")?t[2].slice(0,-5):t[2]:e}async function dp({fs:e,gitdir:t,fullname:n=!1,test:r=!1}){const s=await Kt.resolve({fs:e,gitdir:t,ref:"HEAD",depth:2});if(r)try{await Kt.resolve({fs:e,gitdir:t,ref:s})}catch{return}if(s.startsWith("refs/"))return n?s:dm(s)}function $ke(e){return e=e.replace(/^git@([^:]+):/,"https://$1/"),e=e.replace(/^ssh:\/\//,"https://"),e}function _Z({username:e="",password:t=""}){return`Basic ${un.from(`${e}:${t}`).toString("base64")}`}async function nS(e,t){const n=uZ(e);for(;;){const{value:r,done:s}=await n.next();if(r&&await t(r),s)break}n.return&&n.return()}async function hk(e){let t=0;const n=[];await nS(e,i=>{n.push(i),t+=i.byteLength});const r=new Uint8Array(t);let s=0;for(const i of n)r.set(i,s),s+=i.byteLength;return r}function B9(e){let t=e.match(/^https?:\/\/([^/]+)@/);if(t==null)return{url:e,auth:{}};t=t[1];const[n,r]=t.split(":");return e=e.replace(`${t}@`,""),{url:e,auth:{username:n,password:r}}}function Y3(e,t){const n=t.toString(16);return"0".repeat(e-n.length)+n}class bi{static flush(){return un.from("0000","utf8")}static delim(){return un.from("0001","utf8")}static encode(t){typeof t=="string"&&(t=un.from(t));const n=t.length+4,r=Y3(4,n);return un.concat([un.from(r,"utf8"),t])}static streamReader(t){const n=new dZ(t);return async function(){try{let s=await n.read(4);if(s==null)return!0;if(s=parseInt(s.toString("utf8"),16),s===0||s===1)return null;const i=await n.read(s-4);return i??!0}catch(s){return t.error=s,!0}}}}async function $9(e){const t={};let n;for(;n=await e(),n!==!0;){if(n===null)continue;n=n.toString("utf8").replace(/\n$/,"");const r=n.indexOf("=");if(r>-1){const s=n.slice(0,r),i=n.slice(r+1);t[s]=i}else t[n]=!0}return{protocolVersion:2,capabilities2:t}}async function z9(e,{service:t}){const n=new Set,r=new Map,s=new Map,i=bi.streamReader(e);let a=await i();for(;a===null;)a=await i();if(a===!0)throw new q1;if(a.includes("version 2"))return $9(i);if(a.toString("utf8").replace(/\n$/,"")!==`# service=${t}`)throw new lg(`# service=${t}\\n`,a.toString("utf8"));let o=await i();for(;o===null;)o=await i();if(o===!0)return{capabilities:n,refs:r,symrefs:s};if(o=o.toString("utf8"),o.includes("version 2"))return $9(i);const[l,c]=yM(o,"\0","\\x00");if(c.split(" ").map(u=>n.add(u)),l!=="0000000000000000000000000000000000000000 capabilities^{}"){const[u,d]=yM(l," "," ");for(r.set(d,u);;){const h=await i();if(h===!0)break;if(h!==null){const[m,y]=yM(h.toString("utf8")," "," ");r.set(y,m)}}}for(const u of n)if(u.startsWith("symref=")){const d=u.match(/symref=([^:]+):(.*)/);d.length===3&&s.set(d[1],d[2])}return{protocolVersion:1,capabilities:n,refs:r,symrefs:s}}function yM(e,t,n){const r=e.trim().split(t);if(r.length!==2)throw new lg(`Two strings separated by '${n}'`,e.toString("utf8"));return r}const U9=(e,t)=>e.endsWith("?")?`${e}${t}`:`${e}/${t.replace(/^https?:\/\//,"")}`,q9=(e,t)=>{(t.username||t.password)&&(e.Authorization=_Z(t)),t.headers&&Object.assign(e,t.headers)},bM=async e=>{try{const t=un.from(await hk(e.body)),n=t.toString("utf8");return{preview:n.length<256?n:n.slice(0,256)+"...",response:n,data:t}}catch{return{}}};class pk{static async capabilities(){return["discover","connect"]}static async discover({http:t,onProgress:n,onAuth:r,onAuthSuccess:s,onAuthFailure:i,corsProxy:a,service:o,url:l,headers:c,protocolVersion:u}){let{url:d,auth:h}=B9(l);const m=a?U9(a,d):d;(h.username||h.password)&&(c.Authorization=_Z(h)),u===2&&(c["Git-Protocol"]="version=2");let y,b,v=!1;do if(y=await t.request({onProgress:n,method:"GET",url:`${m}/info/refs?service=${o}`,headers:c}),b=!1,y.statusCode===401||y.statusCode===203){const x=v?i:r;if(x){if(h=await x(d,{...h,headers:{...c}}),h&&h.cancel)throw new gb;h&&(q9(c,h),v=!0,b=!0)}}else y.statusCode===200&&v&&s&&await s(d,h);while(b);if(y.statusCode!==200){const{response:x}=await bM(y);throw new Cy(y.statusCode,y.statusMessage,x)}if(y.headers["content-type"]===`application/x-${o}-advertisement`){const x=await z9(y.body,{service:o});return x.auth=h,x}else{const{preview:x,response:w,data:_}=await bM(y);try{const k=await z9([_],{service:o});return k.auth=h,k}catch{throw new K1(x,w)}}}static async connect({http:t,onProgress:n,corsProxy:r,service:s,url:i,auth:a,body:o,headers:l}){const c=B9(i);c&&(i=c.url),r&&(i=U9(r,i)),l["content-type"]=`application/x-${s}-request`,l.accept=`application/x-${s}-result`,q9(l,a);const u=await t.request({onProgress:n,method:"POST",url:`${i}/${s}`,body:o,headers:l});if(u.statusCode!==200){const{response:d}=bM(u);throw new Cy(u.statusCode,u.statusMessage,d)}return u}}function zke({url:e}){if(e.startsWith("git@"))return{transport:"ssh",address:e};const t=e.match(/(\w+)(:\/\/|::)(.*)/);if(t!==null){if(t[2]==="://")return{transport:t[1],address:t[0]};if(t[2]==="::")return{transport:t[1],address:t[3]}}}class yT{static getRemoteHelperFor({url:t}){const n=new Map;n.set("http",pk),n.set("https",pk);const r=zke({url:t});if(!r)throw new Z1(t);if(n.has(r.transport))return n.get(r.transport);throw new Y1(t,r.transport,r.transport==="ssh"?$ke(t):void 0)}}let Zp=null;class Ew{static async read({fs:t,gitdir:n}){Zp===null&&(Zp=new Cw);const r=zt.join(n,"shallow"),s=new Set;return await Zp.acquire(r,async function(){const i=await t.read(r,{encoding:"utf8"});if(i===null||i.trim()==="")return s;i.trim().split(`
`).map(a=>s.add(a))}),s}static async write({fs:t,gitdir:n,oids:r}){Zp===null&&(Zp=new Cw);const s=zt.join(n,"shallow");if(r.size>0){const i=[...r].join(`
`)+`
`;await Zp.acquire(s,async function(){await t.write(s,i,{encoding:"utf8"})})}else await Zp.acquire(s,async function(){await t.rm(s)})}}async function Uke({fs:e,gitdir:t,oid:n}){const r=`objects/${n.slice(0,2)}/${n.slice(2)}`;return e.exists(`${t}/${r}`)}async function qke({fs:e,cache:t,gitdir:n,oid:r,getExternalRefDelta:s}){let i=await e.readdir(zt.join(n,"objects/pack"));i=i.filter(a=>a.endsWith(".idx"));for(const a of i){const o=`${n}/objects/pack/${a}`,l=await CD({fs:e,cache:t,filename:o,getExternalRefDelta:s});if(l.error)throw new xr(l.error);if(l.offsets.has(r))return!0}return!1}async function V9({fs:e,cache:t,gitdir:n,oid:r,format:s="content"}){const i=o=>Js({fs:e,cache:t,gitdir:n,oid:o});let a=await Uke({fs:e,gitdir:n,oid:r});return a||(a=await qke({fs:e,cache:t,gitdir:n,oid:r,getExternalRefDelta:i})),a}function Vke(e){const s="5041434b"+"00000002"+"00000000";return e.slice(0,12).toString("hex")===s}function CZ(e,t){const n=e.map(r=>r.split("=",1)[0]);return t.filter(r=>{const s=r.split("=",1)[0];return n.includes(s)})}const bT={name:"isomorphic-git",version:"1.30.1",agent:"git/isomorphic-git@1.30.1"};class GC{constructor(){this._queue=[]}write(t){if(this._ended)throw Error("You cannot write to a FIFO that has already been ended!");if(this._waiting){const n=this._waiting;this._waiting=null,n({value:t})}else this._queue.push(t)}end(){if(this._ended=!0,this._waiting){const t=this._waiting;this._waiting=null,t({done:!0})}}destroy(t){this.error=t,this.end()}async next(){if(this._queue.length>0)return{value:this._queue.shift()};if(this._ended)return{done:!0};if(this._waiting)throw Error("You cannot call read until the previous call to read has returned!");return new Promise(t=>{this._waiting=t})}}function Wke(e){const t=e.indexOf("\r"),n=e.indexOf(`
`);return t===-1&&n===-1?-1:t===-1?n+1:n===-1?t+1:n===t+1?n+1:Math.min(t,n)+1}function kZ(e){const t=new GC;let n="";return(async()=>(await nS(e,r=>{for(r=r.toString("utf8"),n+=r;;){const s=Wke(n);if(s===-1)break;t.write(n.slice(0,s)),n=n.slice(s)}}),n.length>0&&t.write(n),t.end()))(),t}class EZ{static demux(t){const n=bi.streamReader(t),r=new GC,s=new GC,i=new GC,a=async function(){const o=await n();if(o===null)return a();if(o===!0){r.end(),i.end(),t.error?s.destroy(t.error):s.end();return}switch(o[0]){case 1:{s.write(o.slice(1));break}case 2:{i.write(o.slice(1));break}case 3:{const l=o.slice(1);i.write(l),r.end(),i.end(),s.destroy(new Error(l.toString("utf8")));return}default:r.write(o)}a()};return a(),{packetlines:r,packfile:s,progress:i}}}async function Hke(e){const{packetlines:t,packfile:n,progress:r}=EZ.demux(e),s=[],i=[],a=[];let o=!1,l=!1;return new Promise((c,u)=>{nS(t,d=>{const h=d.toString("utf8").trim();if(h.startsWith("shallow")){const m=h.slice(-41).trim();m.length!==40&&u(new Uh(m)),s.push(m)}else if(h.startsWith("unshallow")){const m=h.slice(-41).trim();m.length!==40&&u(new Uh(m)),i.push(m)}else if(h.startsWith("ACK")){const[,m,y]=h.split(" ");a.push({oid:m,status:y}),y||(l=!0)}else h.startsWith("NAK")?(o=!0,l=!0):(l=!0,o=!0);l&&(e.error?u(e.error):c({shallows:s,unshallows:i,acks:a,nak:o,packfile:n,progress:r}))}).finally(()=>{l||(e.error?u(e.error):c({shallows:s,unshallows:i,acks:a,nak:o,packfile:n,progress:r}))})})}function Gke({capabilities:e=[],wants:t=[],haves:n=[],shallows:r=[],depth:s=null,since:i=null,exclude:a=[]}){const o=[];t=[...new Set(t)];let l=` ${e.join(" ")}`;for(const c of t)o.push(bi.encode(`want ${c}${l}
`)),l="";for(const c of r)o.push(bi.encode(`shallow ${c}
`));s!==null&&o.push(bi.encode(`deepen ${s}
`)),i!==null&&o.push(bi.encode(`deepen-since ${Math.floor(i.valueOf()/1e3)}
`));for(const c of a)o.push(bi.encode(`deepen-not ${c}
`));o.push(bi.flush());for(const c of n)o.push(bi.encode(`have ${c}
`));return o.push(bi.encode(`done
`)),o}async function ED({fs:e,cache:t,http:n,onProgress:r,onMessage:s,onAuth:i,onAuthSuccess:a,onAuthFailure:o,gitdir:l,ref:c,remoteRef:u,remote:d,url:h,corsProxy:m,depth:y=null,since:b=null,exclude:v=[],relative:x=!1,tags:w=!1,singleBranch:_=!1,headers:k={},prune:C=!1,pruneTags:T=!1}){const A=c||await dp({fs:e,gitdir:l,test:!0}),N=await $i.get({fs:e,gitdir:l}),I=d||A&&await N.get(`branch.${A}.remote`)||"origin",j=h||await N.get(`remote.${I}.url`);if(typeof j>"u")throw new Ho("remote OR url");const L=u||A&&await N.get(`branch.${A}.merge`)||c||"HEAD";m===void 0&&(m=await N.get("http.corsProxy"));const D=yT.getRemoteHelperFor({url:j}),H=await D.discover({http:n,onAuth:i,onAuthSuccess:a,onAuthFailure:o,corsProxy:m,service:"git-upload-pack",url:j,headers:k,protocolVersion:1}),O=H.auth,K=H.refs;if(K.size===0)return{defaultBranch:null,fetchHead:null,fetchHeadDescription:null};if(y!==null&&!H.capabilities.has("shallow"))throw new kh("shallow","depth");if(b!==null&&!H.capabilities.has("deepen-since"))throw new kh("deepen-since","since");if(v.length>0&&!H.capabilities.has("deepen-not"))throw new kh("deepen-not","exclude");if(x===!0&&!H.capabilities.has("deepen-relative"))throw new kh("deepen-relative","relative");const{oid:U,fullref:W}=Kt.resolveAgainstMap({ref:L,map:K});for(const We of K.keys())We===W||We==="HEAD"||We.startsWith("refs/heads/")||w&&We.startsWith("refs/tags/")||K.delete(We);const B=CZ([...H.capabilities],["multi_ack_detailed","no-done","side-band-64k","ofs-delta",`agent=${bT.agent}`]);x&&B.push("deepen-relative");const ne=_?[U]:K.values(),V=_?[A]:await Kt.listRefs({fs:e,gitdir:l,filepath:"refs"});let Q=[];for(let We of V)try{We=await Kt.expand({fs:e,gitdir:l,ref:We});const Pe=await Kt.resolve({fs:e,gitdir:l,ref:We});await V9({fs:e,cache:t,gitdir:l,oid:Pe})&&Q.push(Pe)}catch{}Q=[...new Set(Q)];const ee=await Ew.read({fs:e,gitdir:l}),re=H.capabilities.has("shallow")?[...ee]:[],de=Gke({capabilities:B,wants:ne,haves:Q,shallows:re,depth:y,since:b,exclude:v}),me=un.from(await hk(de)),De=await D.connect({http:n,onProgress:r,corsProxy:m,service:"git-upload-pack",url:j,auth:O,body:[me],headers:k}),je=await Hke(De.body);De.headers&&(je.headers=De.headers);for(const We of je.shallows)if(!ee.has(We))try{const{object:Pe}=await Js({fs:e,cache:t,gitdir:l,oid:We}),Y=new Xs(Pe),ye=await Promise.all(Y.headers().parent.map(ue=>V9({fs:e,cache:t,gitdir:l,oid:ue})));ye.length===0||ye.every(ue=>ue)||ee.add(We)}catch{ee.add(We)}for(const We of je.unshallows)ee.delete(We);if(await Ew.write({fs:e,gitdir:l,oids:ee}),_){const We=new Map([[W,U]]),Pe=new Map;let Y=10,ye=W;for(;Y--;){const oe=H.symrefs.get(ye);if(oe===void 0)break;Pe.set(ye,oe),ye=oe}const Me=K.get(ye);Me&&We.set(ye,Me);const{pruned:ue}=await Kt.updateRemoteRefs({fs:e,gitdir:l,remote:I,refs:We,symrefs:Pe,tags:w,prune:C});C&&(je.pruned=ue)}else{const{pruned:We}=await Kt.updateRemoteRefs({fs:e,gitdir:l,remote:I,refs:K,symrefs:H.symrefs,tags:w,prune:C,pruneTags:T});C&&(je.pruned=We)}if(je.HEAD=H.symrefs.get("HEAD"),je.HEAD===void 0){const{oid:We}=Kt.resolveAgainstMap({ref:"HEAD",map:K});for(const[Pe,Y]of K.entries())if(Pe!=="HEAD"&&Y===We){je.HEAD=Pe;break}}const Te=W.startsWith("refs/tags")?"tag":"branch";if(je.FETCH_HEAD={oid:U,description:`${Te} '${dm(W)}' of ${j}`},r||s){const We=kZ(je.progress);nS(We,async Pe=>{if(s&&await s(Pe),r){const Y=Pe.match(/([^:]*).*\((\d+?)\/(\d+?)\)/);Y&&await r({phase:Y[1].trim(),loaded:parseInt(Y[2],10),total:parseInt(Y[3],10)})}})}const _e=un.from(await hk(je.packfile));if(De.body.error)throw De.body.error;const Ue=_e.slice(-20).toString("hex"),Qe={defaultBranch:je.HEAD,fetchHead:je.FETCH_HEAD.oid,fetchHeadDescription:je.FETCH_HEAD.description};if(je.headers&&(Qe.headers=je.headers),C&&(Qe.pruned=je.pruned),Ue!==""&&!Vke(_e)){Qe.packfile=`objects/pack/pack-${Ue}.pack`;const We=zt.join(l,Qe.packfile);await e.write(We,_e);const Pe=ye=>Js({fs:e,cache:t,gitdir:l,oid:ye}),Y=await _y.fromPack({pack:_e,getExternalRefDelta:Pe,onProgress:r});await e.write(We.replace(/\.pack$/,".idx"),await Y.toBuffer())}return Qe}async function TZ({fs:e,bare:t=!1,dir:n,gitdir:r=t?n:zt.join(n,".git"),defaultBranch:s="master"}){if(await e.exists(r+"/config"))return;let i=["hooks","info","objects/info","objects/pack","refs/heads","refs/tags"];i=i.map(a=>r+"/"+a);for(const a of i)await e.mkdir(a);await e.write(r+"/config",`[core]
	repositoryformatversion = 0
	filemode = false
	bare = ${t}
`+(t?"":`	logallrefupdates = true
`)+`	symlinks = false
	ignorecase = true
`),await e.write(r+"/HEAD",`ref: refs/heads/${s}
`)}async function Kke({fs:e,cache:t,http:n,onProgress:r,onMessage:s,onAuth:i,onAuthSuccess:a,onAuthFailure:o,onPostCheckout:l,dir:c,gitdir:u,url:d,corsProxy:h,ref:m,remote:y,depth:b,since:v,exclude:x,relative:w,singleBranch:_,noCheckout:k,noTags:C,headers:T}){try{if(await TZ({fs:e,gitdir:u}),await xZ({fs:e,gitdir:u,remote:y,url:d,force:!1}),h){const I=await $i.get({fs:e,gitdir:u});await I.set("http.corsProxy",h),await $i.save({fs:e,gitdir:u,config:I})}const{defaultBranch:A,fetchHead:N}=await ED({fs:e,cache:t,http:n,onProgress:r,onMessage:s,onAuth:i,onAuthSuccess:a,onAuthFailure:o,gitdir:u,ref:m,remote:y,corsProxy:h,depth:b,since:v,exclude:x,relative:w,singleBranch:_,headers:T,tags:!C});if(N===null)return;m=m||A,m=m.replace("refs/heads/",""),await kD({fs:e,cache:t,onProgress:r,onPostCheckout:l,dir:c,gitdir:u,ref:m,remote:y,noCheckout:k})}catch(A){throw await e.rmdir(u,{recursive:!0,maxRetries:10}).catch(()=>{}),A}}async function Yke({fs:e,http:t,onProgress:n,onMessage:r,onAuth:s,onAuthSuccess:i,onAuthFailure:a,onPostCheckout:o,dir:l,gitdir:c=zt.join(l,".git"),url:u,corsProxy:d=void 0,ref:h=void 0,remote:m="origin",depth:y=void 0,since:b=void 0,exclude:v=[],relative:x=!1,singleBranch:w=!1,noCheckout:_=!1,noTags:k=!1,headers:C={},cache:T={}}){try{return dt("fs",e),dt("http",t),dt("gitdir",c),_||dt("dir",l),dt("url",u),await Kke({fs:new An(e),cache:T,http:t,onProgress:n,onMessage:r,onAuth:s,onAuthSuccess:i,onAuthFailure:a,onPostCheckout:o,dir:l,gitdir:c,url:u,corsProxy:d,ref:h,remote:m,depth:y,since:b,exclude:v,relative:x,singleBranch:w,noCheckout:_,noTags:k,headers:C})}catch(A){throw A.caller="git.clone",A}}async function Zke({fs:e,onSign:t,dir:n,gitdir:r=zt.join(n,".git"),message:s,author:i,committer:a,signingKey:o,amend:l=!1,dryRun:c=!1,noUpdateBranch:u=!1,ref:d,parent:h,tree:m,cache:y={}}){try{dt("fs",e),l||dt("message",s),o&&dt("onSign",t);const b=new An(e);return await gT({fs:b,cache:y,onSign:t,gitdir:r,message:s,author:i,committer:a,signingKey:o,amend:l,dryRun:c,noUpdateBranch:u,ref:d,parent:h,tree:m})}catch(b){throw b.caller="git.commit",b}}async function Xke({fs:e,dir:t,gitdir:n=zt.join(t,".git"),fullname:r=!1,test:s=!1}){try{return dt("fs",e),dt("gitdir",n),await dp({fs:new An(e),gitdir:n,fullname:r,test:s})}catch(i){throw i.caller="git.currentBranch",i}}async function Jke({fs:e,gitdir:t,ref:n}){if(n=n.startsWith("refs/heads/")?n:`refs/heads/${n}`,!await Kt.exists({fs:e,gitdir:t,ref:n}))throw new Rs(n);const s=await Kt.expand({fs:e,gitdir:t,ref:n}),i=await dp({fs:e,gitdir:t,fullname:!0});if(s===i){const l=await Kt.resolve({fs:e,gitdir:t,ref:s});await Kt.writeRef({fs:e,gitdir:t,ref:"HEAD",value:l})}await Kt.deleteRef({fs:e,gitdir:t,ref:s});const a=dm(n),o=await $i.get({fs:e,gitdir:t});await o.deleteSection("branch",a),await $i.save({fs:e,gitdir:t,config:o})}async function Qke({fs:e,dir:t,gitdir:n=zt.join(t,".git"),ref:r}){try{return dt("fs",e),dt("ref",r),await Jke({fs:new An(e),gitdir:n,ref:r})}catch(s){throw s.caller="git.deleteBranch",s}}async function eEe({fs:e,dir:t,gitdir:n=zt.join(t,".git"),ref:r}){try{dt("fs",e),dt("ref",r),await Kt.deleteRef({fs:new An(e),gitdir:n,ref:r})}catch(s){throw s.caller="git.deleteRef",s}}async function tEe({fs:e,gitdir:t,remote:n}){const r=await $i.get({fs:e,gitdir:t});await r.deleteSection("remote",n),await $i.save({fs:e,gitdir:t,config:r})}async function nEe({fs:e,dir:t,gitdir:n=zt.join(t,".git"),remote:r}){try{return dt("fs",e),dt("remote",r),await tEe({fs:new An(e),gitdir:n,remote:r})}catch(s){throw s.caller="git.deleteRemote",s}}async function rEe({fs:e,gitdir:t,ref:n}){n=n.startsWith("refs/tags/")?n:`refs/tags/${n}`,await Kt.deleteRef({fs:e,gitdir:t,ref:n})}async function sEe({fs:e,dir:t,gitdir:n=zt.join(t,".git"),ref:r}){try{return dt("fs",e),dt("ref",r),await rEe({fs:new An(e),gitdir:n,ref:r})}catch(s){throw s.caller="git.deleteTag",s}}async function iEe({fs:e,gitdir:t,oid:n}){const r=n.slice(0,2);return(await e.readdir(`${t}/objects/${r}`)).map(i=>`${r}${i}`).filter(i=>i.startsWith(n))}async function aEe({fs:e,cache:t,gitdir:n,oid:r,getExternalRefDelta:s}){const i=[];let a=await e.readdir(zt.join(n,"objects/pack"));a=a.filter(o=>o.endsWith(".idx"));for(const o of a){const l=`${n}/objects/pack/${o}`,c=await CD({fs:e,cache:t,filename:l,getExternalRefDelta:s});if(c.error)throw new xr(c.error);for(const u of c.offsets.keys())u.startsWith(r)&&i.push(u)}return i}async function oEe({fs:e,cache:t,gitdir:n,oid:r}){const s=o=>Js({fs:e,cache:t,gitdir:n,oid:o}),i=await iEe({fs:e,gitdir:n,oid:r}),a=await aEe({fs:e,cache:t,gitdir:n,oid:r,getExternalRefDelta:s});for(const o of a)i.indexOf(o)===-1&&i.push(o);if(i.length===1)return i[0];throw i.length>1?new $1("oids",r,i):new Rs(`an object matching "${r}"`)}async function lEe({fs:e,dir:t,gitdir:n=zt.join(t,".git"),oid:r,cache:s={}}){try{return dt("fs",e),dt("gitdir",n),dt("oid",r),await oEe({fs:new An(e),cache:s,gitdir:n,oid:r})}catch(i){throw i.caller="git.expandOid",i}}async function cEe({fs:e,dir:t,gitdir:n=zt.join(t,".git"),ref:r}){try{return dt("fs",e),dt("gitdir",n),dt("ref",r),await Kt.expand({fs:new An(e),gitdir:n,ref:r})}catch(s){throw s.caller="git.expandRef",s}}async function TD({fs:e,cache:t,gitdir:n,oids:r}){const s={},i=r.length;let a=r.map((o,l)=>({index:l,oid:o}));for(;a.length;){const o=new Set;for(const{oid:c,index:u}of a)s[c]||(s[c]=new Set),s[c].add(u),s[c].size===i&&o.add(c);if(o.size>0)return[...o];const l=new Map;for(const{oid:c,index:u}of a)try{const{object:d}=await Js({fs:e,cache:t,gitdir:n,oid:c}),h=Xs.from(d),{parent:m}=h.parseHeaders();for(const y of m)(!s[y]||!s[y].has(u))&&l.set(y+":"+u,{oid:y,index:u})}catch{}a=Array.from(l.values())}return[]}const vM=/^.*(\r?\n|$)/gm;function uEe({branches:e,contents:t}){const n=e[1],r=e[2],s=t[0],i=t[1],a=t[2],o=i.match(vM),l=s.match(vM),c=a.match(vM),u=R2e(o,l,c),d=7;let h="",m=!0;for(const y of u)y.ok&&(h+=y.ok.join("")),y.conflict&&(m=!1,h+=`${"<".repeat(d)} ${n}
`,h+=y.conflict.a.join(""),h+=`${"=".repeat(d)}
`,h+=y.conflict.b.join(""),h+=`${">".repeat(d)} ${r}
`);return{cleanMerge:m,mergedText:h}}async function dEe({fs:e,cache:t,dir:n,gitdir:r=zt.join(n,".git"),index:s,ourOid:i,baseOid:a,theirOid:o,ourName:l="ours",baseName:c="base",theirName:u="theirs",dryRun:d=!1,abortOnConflict:h=!0,mergeDriver:m}){const y=Jl({ref:i}),b=Jl({ref:a}),v=Jl({ref:o}),x=[],w=[],_=[],k=[],C=await Vh({fs:e,cache:t,dir:n,gitdir:r,trees:[y,b,v],map:async function(T,[A,N,I]){const j=lk(T),L=await fk(A,N),D=await fk(I,N);switch(`${L}-${D}`){case"false-false":return{mode:await N.mode(),path:j,oid:await N.oid(),type:await N.type()};case"false-true":return I?{mode:await I.mode(),path:j,oid:await I.oid(),type:await I.type()}:void 0;case"true-false":return A?{mode:await A.mode(),path:j,oid:await A.oid(),type:await A.type()}:void 0;case"true-true":{if(A&&N&&I&&await A.type()==="blob"&&await N.type()==="blob"&&await I.type()==="blob")return fEe({fs:e,gitdir:r,path:j,ours:A,base:N,theirs:I,ourName:l,baseName:c,theirName:u,mergeDriver:m}).then(async H=>{if(H.cleanMerge)h||s.insert({filepath:T,oid:H.mergeResult.oid,stage:0});else if(x.push(T),w.push(T),!h){const O=await N.oid(),K=await A.oid(),U=await I.oid();s.delete({filepath:T}),s.insert({filepath:T,oid:O,stage:1}),s.insert({filepath:T,oid:K,stage:2}),s.insert({filepath:T,oid:U,stage:3})}return H.mergeResult});if(N&&!A&&I&&await N.type()==="blob"&&await I.type()==="blob"){if(x.push(T),_.push(T),!h){const H=await N.oid(),O=await I.oid();s.delete({filepath:T}),s.insert({filepath:T,oid:H,stage:1}),s.insert({filepath:T,oid:O,stage:3})}return{mode:await I.mode(),oid:await I.oid(),type:"blob",path:j}}if(N&&A&&!I&&await N.type()==="blob"&&await A.type()==="blob"){if(x.push(T),k.push(T),!h){const H=await N.oid(),O=await A.oid();s.delete({filepath:T}),s.insert({filepath:T,oid:H,stage:1}),s.insert({filepath:T,oid:O,stage:2})}return{mode:await A.mode(),oid:await A.oid(),type:"blob",path:j}}if(N&&!A&&!I&&await N.type()==="blob")return;throw new pb}}},reduce:x.length!==0&&(!n||h)?void 0:async(T,A)=>{const N=A.filter(Boolean);if(T&&!(T&&T.type==="tree"&&N.length===0)){if(N.length>0){const j=new Ko(N).toObject(),L=await Jo({fs:e,gitdir:r,type:"tree",object:j,dryRun:d});T.oid=L}return T}}});return x.length!==0?(n&&!h&&await Vh({fs:e,cache:t,dir:n,gitdir:r,trees:[Jl({ref:C.oid})],map:async function(T,[A]){const N=`${n}/${T}`;if(await A.type()==="blob"){const I=await A.mode(),j=new TextDecoder().decode(await A.content());await e.write(N,j,{mode:I})}return!0}}),new mb(x,w,_,k)):C.oid}async function fEe({fs:e,gitdir:t,path:n,ours:r,base:s,theirs:i,ourName:a,theirName:o,baseName:l,dryRun:c,mergeDriver:u=uEe}){const d="blob",h=await s.mode()===await r.mode()?await i.mode():await r.mode();if(await r.oid()===await i.oid())return{cleanMerge:!0,mergeResult:{mode:h,path:n,oid:await r.oid(),type:d}};if(await r.oid()===await s.oid())return{cleanMerge:!0,mergeResult:{mode:h,path:n,oid:await i.oid(),type:d}};if(await i.oid()===await s.oid())return{cleanMerge:!0,mergeResult:{mode:h,path:n,oid:await r.oid(),type:d}};const m=un.from(await r.content()).toString("utf8"),y=un.from(await s.content()).toString("utf8"),b=un.from(await i.content()).toString("utf8"),{mergedText:v,cleanMerge:x}=await u({branches:[l,a,o],contents:[y,m,b],path:n}),w=await Jo({fs:e,gitdir:t,type:"blob",object:un.from(v,"utf8"),dryRun:c});return{cleanMerge:x,mergeResult:{mode:h,path:n,oid:w,type:d}}}async function AZ({fs:e,cache:t,dir:n,gitdir:r,ours:s,theirs:i,fastForward:a=!0,fastForwardOnly:o=!1,dryRun:l=!1,noUpdateBranch:c=!1,abortOnConflict:u=!0,message:d,author:h,committer:m,signingKey:y,onSign:b,mergeDriver:v}){s===void 0&&(s=await dp({fs:e,gitdir:r,fullname:!0})),s=await Kt.expand({fs:e,gitdir:r,ref:s}),i=await Kt.expand({fs:e,gitdir:r,ref:i});const x=await Kt.resolve({fs:e,gitdir:r,ref:s}),w=await Kt.resolve({fs:e,gitdir:r,ref:i}),_=await TD({fs:e,cache:t,gitdir:r,oids:[x,w]});if(_.length!==1)throw new pb;const k=_[0];if(k===w)return{oid:x,alreadyMerged:!0};if(a&&k===x)return!l&&!c&&await Kt.writeRef({fs:e,gitdir:r,ref:s,value:w}),{oid:w,fastForward:!0};{if(o)throw new V1;const C=await ma.acquire({fs:e,gitdir:r,cache:t,allowUnmerged:!1},async A=>dEe({fs:e,cache:t,dir:n,gitdir:r,index:A,ourOid:x,theirOid:w,baseOid:k,ourName:dm(s),baseName:"base",theirName:dm(i),dryRun:l,abortOnConflict:u,mergeDriver:v}));if(C instanceof mb)throw C;return d||(d=`Merge branch '${dm(i)}' into ${dm(s)}`),{oid:await gT({fs:e,cache:t,gitdir:r,message:d,ref:s,tree:C,parent:[x,w],author:h,committer:m,signingKey:y,onSign:b,dryRun:l,noUpdateBranch:c}),tree:C,mergeCommit:!0}}}async function RZ({fs:e,cache:t,http:n,onProgress:r,onMessage:s,onAuth:i,onAuthSuccess:a,onAuthFailure:o,dir:l,gitdir:c,ref:u,url:d,remote:h,remoteRef:m,prune:y,pruneTags:b,fastForward:v,fastForwardOnly:x,corsProxy:w,singleBranch:_,headers:k,author:C,committer:T,signingKey:A}){try{if(!u){const j=await dp({fs:e,gitdir:c});if(!j)throw new Ho("ref");u=j}const{fetchHead:N,fetchHeadDescription:I}=await ED({fs:e,cache:t,http:n,onProgress:r,onMessage:s,onAuth:i,onAuthSuccess:a,onAuthFailure:o,gitdir:c,corsProxy:w,ref:u,url:d,remote:h,remoteRef:m,singleBranch:_,headers:k,prune:y,pruneTags:b});await AZ({fs:e,cache:t,gitdir:c,ours:u,theirs:N,fastForward:v,fastForwardOnly:x,message:`Merge ${I}`,author:C,committer:T,signingKey:A,dryRun:!1,noUpdateBranch:!1}),await kD({fs:e,cache:t,onProgress:r,dir:l,gitdir:c,ref:u,remote:h,noCheckout:!1})}catch(N){throw N.caller="git.pull",N}}async function hEe({fs:e,http:t,onProgress:n,onMessage:r,onAuth:s,onAuthSuccess:i,onAuthFailure:a,dir:o,gitdir:l=zt.join(o,".git"),ref:c,url:u,remote:d,remoteRef:h,corsProxy:m,singleBranch:y,headers:b={},cache:v={}}){try{dt("fs",e),dt("http",t),dt("gitdir",l);const x={name:"",email:"",timestamp:Date.now(),timezoneOffset:0};return await RZ({fs:new An(e),cache:v,http:t,onProgress:n,onMessage:r,onAuth:s,onAuthSuccess:i,onAuthFailure:a,dir:o,gitdir:l,ref:c,url:u,remote:d,remoteRef:h,fastForwardOnly:!0,corsProxy:m,singleBranch:y,headers:b,author:x,committer:x})}catch(x){throw x.caller="git.fastForward",x}}async function pEe({fs:e,http:t,onProgress:n,onMessage:r,onAuth:s,onAuthSuccess:i,onAuthFailure:a,dir:o,gitdir:l=zt.join(o,".git"),ref:c,remote:u,remoteRef:d,url:h,corsProxy:m,depth:y=null,since:b=null,exclude:v=[],relative:x=!1,tags:w=!1,singleBranch:_=!1,headers:k={},prune:C=!1,pruneTags:T=!1,cache:A={}}){try{return dt("fs",e),dt("http",t),dt("gitdir",l),await ED({fs:new An(e),cache:A,http:t,onProgress:n,onMessage:r,onAuth:s,onAuthSuccess:i,onAuthFailure:a,gitdir:l,ref:c,remote:u,remoteRef:d,url:h,corsProxy:m,depth:y,since:b,exclude:v,relative:x,tags:w,singleBranch:_,headers:k,prune:C,pruneTags:T})}catch(N){throw N.caller="git.fetch",N}}async function mEe({fs:e,dir:t,gitdir:n=zt.join(t,".git"),oids:r,cache:s={}}){try{return dt("fs",e),dt("gitdir",n),dt("oids",r),await TD({fs:new An(e),cache:s,gitdir:n,oids:r})}catch(i){throw i.caller="git.findMergeBase",i}}async function NZ({fs:e,filepath:t}){if(await e.exists(zt.join(t,".git")))return t;{const n=Sy(t);if(n===t)throw new Rs(`git root for ${t}`);return NZ({fs:e,filepath:n})}}async function gEe({fs:e,filepath:t}){try{return dt("fs",e),dt("filepath",t),await NZ({fs:new An(e),filepath:t})}catch(n){throw n.caller="git.findRoot",n}}async function yEe({fs:e,dir:t,gitdir:n=zt.join(t,".git"),path:r}){try{return dt("fs",e),dt("gitdir",n),dt("path",r),await kw({fs:new An(e),gitdir:n,path:r})}catch(s){throw s.caller="git.getConfig",s}}async function bEe({fs:e,gitdir:t,path:n}){return(await $i.get({fs:e,gitdir:t})).getall(n)}async function vEe({fs:e,dir:t,gitdir:n=zt.join(t,".git"),path:r}){try{return dt("fs",e),dt("gitdir",n),dt("path",r),await bEe({fs:new An(e),gitdir:n,path:r})}catch(s){throw s.caller="git.getConfigAll",s}}async function xEe({http:e,onAuth:t,onAuthSuccess:n,onAuthFailure:r,corsProxy:s,url:i,headers:a={},forPush:o=!1}){try{dt("http",e),dt("url",i);const c=await yT.getRemoteHelperFor({url:i}).discover({http:e,onAuth:t,onAuthSuccess:n,onAuthFailure:r,corsProxy:s,service:o?"git-receive-pack":"git-upload-pack",url:i,headers:a,protocolVersion:1}),u={capabilities:[...c.capabilities]};for(const[d,h]of c.refs){const m=d.split("/"),y=m.pop();let b=u;for(const v of m)b[v]=b[v]||{},b=b[v];b[y]=h}for(const[d,h]of c.symrefs){const m=d.split("/"),y=m.pop();let b=u;for(const v of m)b[v]=b[v]||{},b=b[v];b[y]=h}return u}catch(l){throw l.caller="git.getRemoteInfo",l}}function IZ(e,t,n,r){const s=[];for(const[i,a]of e.refs){if(t&&!i.startsWith(t))continue;if(i.endsWith("^{}")){if(r){const l=i.replace("^{}",""),c=s[s.length-1],u=c.ref===l?c:s.find(d=>d.ref===l);if(u===void 0)throw new Error("I did not expect this to happen");u.peeled=a}continue}const o={ref:i,oid:a};n&&e.symrefs.has(i)&&(o.target=e.symrefs.get(i)),s.push(o)}return s}async function wEe({http:e,onAuth:t,onAuthSuccess:n,onAuthFailure:r,corsProxy:s,url:i,headers:a={},forPush:o=!1,protocolVersion:l=2}){try{dt("http",e),dt("url",i);const u=await yT.getRemoteHelperFor({url:i}).discover({http:e,onAuth:t,onAuthSuccess:n,onAuthFailure:r,corsProxy:s,service:o?"git-receive-pack":"git-upload-pack",url:i,headers:a,protocolVersion:l});if(u.protocolVersion===2)return{protocolVersion:u.protocolVersion,capabilities:u.capabilities2};const d={};for(const h of u.capabilities){const[m,y]=h.split("=");y?d[m]=y:d[m]=!0}return{protocolVersion:1,capabilities:d,refs:IZ(u,void 0,!0,!0)}}catch(c){throw c.caller="git.getRemoteInfo2",c}}async function SEe({type:e,object:t,format:n="content",oid:r=void 0}){return n!=="deflated"&&(n!=="wrapped"&&(t=hb.wrap({type:e,object:t})),r=await uf(t)),{oid:r,object:t}}async function _Ee({object:e}){try{dt("object",e),typeof e=="string"?e=un.from(e,"utf8"):e=un.from(e);const t="blob",{oid:n,object:r}=await SEe({type:"blob",format:"content",object:e});return{oid:n,type:t,object:new Uint8Array(r),format:"wrapped"}}catch(t){throw t.caller="git.hashBlob",t}}async function CEe({fs:e,cache:t,onProgress:n,dir:r,gitdir:s,filepath:i}){try{i=zt.join(r,i);const a=await e.read(i),o=c=>Js({fs:e,cache:t,gitdir:s,oid:c}),l=await _y.fromPack({pack:a,getExternalRefDelta:o,onProgress:n});return await e.write(i.replace(/\.pack$/,".idx"),await l.toBuffer()),{oids:[...l.hashes]}}catch(a){throw a.caller="git.indexPack",a}}async function kEe({fs:e,onProgress:t,dir:n,gitdir:r=zt.join(n,".git"),filepath:s,cache:i={}}){try{return dt("fs",e),dt("dir",n),dt("gitdir",n),dt("filepath",s),await CEe({fs:new An(e),cache:i,onProgress:t,dir:n,gitdir:r,filepath:s})}catch(a){throw a.caller="git.indexPack",a}}async function EEe({fs:e,bare:t=!1,dir:n,gitdir:r=t?n:zt.join(n,".git"),defaultBranch:s="master"}){try{return dt("fs",e),dt("gitdir",r),t||dt("dir",n),await TZ({fs:new An(e),bare:t,dir:n,gitdir:r,defaultBranch:s})}catch(i){throw i.caller="git.init",i}}async function MZ({fs:e,cache:t,gitdir:n,oid:r,ancestor:s,depth:i}){const a=await Ew.read({fs:e,gitdir:n});if(!r)throw new Ho("oid");if(!s)throw new Ho("ancestor");if(r===s)return!1;const o=[r],l=new Set;let c=0;for(;o.length;){if(c++===i)throw new H1(i);const u=o.shift(),{type:d,object:h}=await Js({fs:e,cache:t,gitdir:n,oid:u});if(d!=="commit")throw new To(u,d,"commit");const m=Xs.from(h).parse();for(const y of m.parent)if(y===s)return!0;if(!a.has(u))for(const y of m.parent)l.has(y)||(o.push(y),l.add(y))}return!1}async function TEe({fs:e,dir:t,gitdir:n=zt.join(t,".git"),oid:r,ancestor:s,depth:i=-1,cache:a={}}){try{return dt("fs",e),dt("gitdir",n),dt("oid",r),dt("ancestor",s),await MZ({fs:new An(e),cache:a,gitdir:n,oid:r,ancestor:s,depth:i})}catch(o){throw o.caller="git.isDescendent",o}}async function AEe({fs:e,dir:t,gitdir:n=zt.join(t,".git"),filepath:r}){try{return dt("fs",e),dt("dir",t),dt("gitdir",n),dt("filepath",r),yb.isIgnored({fs:new An(e),dir:t,gitdir:n,filepath:r})}catch(s){throw s.caller="git.isIgnored",s}}async function REe({fs:e,dir:t,gitdir:n=zt.join(t,".git"),remote:r}){try{return dt("fs",e),dt("gitdir",n),Kt.listBranches({fs:new An(e),gitdir:n,remote:r})}catch(s){throw s.caller="git.listBranches",s}}async function NEe({fs:e,gitdir:t,ref:n,cache:r}){if(n){const s=await Kt.resolve({gitdir:t,fs:e,ref:n}),i=[];return await jZ({fs:e,cache:r,gitdir:t,oid:s,filenames:i,prefix:""}),i}else return ma.acquire({fs:e,gitdir:t,cache:r},async function(s){return s.entries.map(i=>i.path)})}async function jZ({fs:e,cache:t,gitdir:n,oid:r,filenames:s,prefix:i}){const{tree:a}=await bb({fs:e,cache:t,gitdir:n,oid:r});for(const o of a)o.type==="tree"?await jZ({fs:e,cache:t,gitdir:n,oid:o.oid,filenames:s,prefix:zt.join(i,o.path)}):s.push(zt.join(i,o.path))}async function IEe({fs:e,dir:t,gitdir:n=zt.join(t,".git"),ref:r,cache:s={}}){try{return dt("fs",e),dt("gitdir",n),await NEe({fs:new An(e),cache:s,gitdir:n,ref:r})}catch(i){throw i.caller="git.listFiles",i}}async function MEe({fs:e,cache:t,gitdir:n,ref:r}){let s;try{s=await Kt.resolve({gitdir:n,fs:e,ref:r})}catch(o){if(o instanceof Rs)return[]}return(await bb({fs:e,cache:t,gitdir:n,oid:s})).tree.map(o=>({target:o.path,note:o.oid}))}async function jEe({fs:e,dir:t,gitdir:n=zt.join(t,".git"),ref:r="refs/notes/commits",cache:s={}}){try{return dt("fs",e),dt("gitdir",n),dt("ref",r),await MEe({fs:new An(e),cache:s,gitdir:n,ref:r})}catch(i){throw i.caller="git.listNotes",i}}async function PEe({fs:e,dir:t,gitdir:n=zt.join(t,".git"),filepath:r}){try{return dt("fs",e),dt("gitdir",n),Kt.listRefs({fs:new An(e),gitdir:n,filepath:r})}catch(s){throw s.caller="git.listRefs",s}}async function OEe({fs:e,gitdir:t}){const n=await $i.get({fs:e,gitdir:t}),r=await n.getSubsections("remote");return Promise.all(r.map(async i=>{const a=await n.get(`remote.${i}.url`);return{remote:i,url:a}}))}async function DEe({fs:e,dir:t,gitdir:n=zt.join(t,".git")}){try{return dt("fs",e),dt("gitdir",n),await OEe({fs:new An(e),gitdir:n})}catch(r){throw r.caller="git.listRemotes",r}}async function FEe(e){const t=bi.streamReader(e),n=[];let r;for(;r=await t(),r!==!0;){if(r===null)continue;r=r.toString("utf8").replace(/\n$/,"");const[s,i,...a]=r.split(" "),o={ref:i,oid:s};for(const l of a){const[c,u]=l.split(":");c==="symref-target"?o.target=u:c==="peeled"&&(o.peeled=u)}n.push(o)}return n}async function LEe({prefix:e,symrefs:t,peelTags:n}){const r=[];return r.push(bi.encode(`command=ls-refs
`)),r.push(bi.encode(`agent=${bT.agent}
`)),(n||t||e)&&r.push(bi.delim()),n&&r.push(bi.encode("peel")),t&&r.push(bi.encode("symrefs")),e&&r.push(bi.encode(`ref-prefix ${e}`)),r.push(bi.flush()),r}async function BEe({http:e,onAuth:t,onAuthSuccess:n,onAuthFailure:r,corsProxy:s,url:i,headers:a={},forPush:o=!1,protocolVersion:l=2,prefix:c,symrefs:u,peelTags:d}){try{dt("http",e),dt("url",i);const h=await pk.discover({http:e,onAuth:t,onAuthSuccess:n,onAuthFailure:r,corsProxy:s,service:o?"git-receive-pack":"git-upload-pack",url:i,headers:a,protocolVersion:l});if(h.protocolVersion===1)return IZ(h,c,u,d);const m=await LEe({prefix:c,symrefs:u,peelTags:d}),y=await pk.connect({http:e,auth:h.auth,headers:a,corsProxy:s,service:o?"git-receive-pack":"git-upload-pack",url:i,body:m});return FEe(y.body)}catch(h){throw h.caller="git.listServerRefs",h}}async function $Ee({fs:e,dir:t,gitdir:n=zt.join(t,".git")}){try{return dt("fs",e),dt("gitdir",n),Kt.listTags({fs:new An(e),gitdir:n})}catch(r){throw r.caller="git.listTags",r}}function zEe(e,t){return e.committer.timestamp-t.committer.timestamp}const UEe="e69de29bb2d1d6434b8b29ae775ad8c2e48c5391";async function W9({fs:e,cache:t,gitdir:n,oid:r,fileId:s}){if(s===UEe)return;const i=r;let a;const o=await Ey({fs:e,cache:t,gitdir:n,oid:r}),l=o.tree;return s===o.oid?a=o.path:(a=await PZ({fs:e,cache:t,gitdir:n,tree:l,fileId:s,oid:i}),Array.isArray(a)&&(a.length===0?a=void 0:a.length===1&&(a=a[0]))),a}async function PZ({fs:e,cache:t,gitdir:n,tree:r,fileId:s,oid:i,filepaths:a=[],parentPath:o=""}){const l=r.entries().map(function(c){let u;return c.oid===s?(u=zt.join(o,c.path),a.push(u)):c.type==="tree"&&(u=Js({fs:e,cache:t,gitdir:n,oid:c.oid}).then(function({object:d}){return PZ({fs:e,cache:t,gitdir:n,tree:Ko.from(d),fileId:s,oid:i,filepaths:a,parentPath:zt.join(o,c.path)})})),u});return await Promise.all(l),a}async function qEe({fs:e,cache:t,gitdir:n,filepath:r,ref:s,depth:i,since:a,force:o,follow:l}){const c=typeof a>"u"?void 0:Math.floor(a.valueOf()/1e3),u=[],d=await Ew.read({fs:e,gitdir:n}),h=await Kt.resolve({fs:e,gitdir:n,ref:s}),m=[await Ay({fs:e,cache:t,gitdir:n,oid:h})];let y,b,v;function x(w){v&&r&&u.push(w)}for(;m.length>0;){const w=m.pop();if(c!==void 0&&w.commit.committer.timestamp<=c)break;if(r){let _;try{_=await eS({fs:e,cache:t,gitdir:n,oid:w.commit.tree,filepath:r}),b&&y!==_&&u.push(b),y=_,b=w,v=!0}catch(k){if(k instanceof Rs){let C=l&&y;if(C&&(C=await W9({fs:e,cache:t,gitdir:n,oid:w.commit.tree,fileId:y}),C))if(Array.isArray(C)){if(b){const T=await W9({fs:e,cache:t,gitdir:n,oid:b.commit.tree,fileId:y});if(Array.isArray(T))if(C=C.filter(A=>T.indexOf(A)===-1),C.length===1)C=C[0],r=C,b&&u.push(b);else{C=!1,b&&u.push(b);break}}}else r=C,b&&u.push(b);if(!C){if(v&&y&&(u.push(b),!o))break;if(!o&&!l)throw k}b=w,v=!1}else throw k}}else u.push(w);if(i!==void 0&&u.length===i){x(w);break}if(!d.has(w.oid))for(const _ of w.commit.parent){const k=await Ay({fs:e,cache:t,gitdir:n,oid:_});m.map(C=>C.oid).includes(k.oid)||m.push(k)}m.length===0&&x(w),m.sort((_,k)=>zEe(_.commit,k.commit))}return u}async function VEe({fs:e,dir:t,gitdir:n=zt.join(t,".git"),filepath:r,ref:s="HEAD",depth:i,since:a,force:o,follow:l,cache:c={}}){try{return dt("fs",e),dt("gitdir",n),dt("ref",s),await qEe({fs:new An(e),cache:c,gitdir:n,filepath:r,ref:s,depth:i,since:a,force:o,follow:l})}catch(u){throw u.caller="git.log",u}}async function WEe({fs:e,onSign:t,dir:n,gitdir:r=zt.join(n,".git"),ours:s,theirs:i,fastForward:a=!0,fastForwardOnly:o=!1,dryRun:l=!1,noUpdateBranch:c=!1,abortOnConflict:u=!0,message:d,author:h,committer:m,signingKey:y,cache:b={},mergeDriver:v}){try{dt("fs",e),y&&dt("onSign",t);const x=new An(e),w=await Wh({fs:x,gitdir:r,author:h});if(!w&&(!o||!a))throw new Ga("author");const _=await Ty({fs:x,gitdir:r,author:w,committer:m});if(!_&&(!o||!a))throw new Ga("committer");return await AZ({fs:x,cache:b,dir:n,gitdir:r,ours:s,theirs:i,fastForward:a,fastForwardOnly:o,dryRun:l,noUpdateBranch:c,abortOnConflict:u,message:d,author:w,committer:_,signingKey:y,onSign:t,mergeDriver:v})}catch(x){throw x.caller="git.merge",x}}const HEe={commit:16,tree:32,blob:48,tag:64,ofs_delta:96,ref_delta:112};async function OZ({fs:e,cache:t,dir:n,gitdir:r=zt.join(n,".git"),oids:s}){const i=new JY,a=[];function o(u,d){const h=un.from(u,d);a.push(h),i.update(h)}async function l({stype:u,object:d}){const h=HEe[u];let m=d.length,y=m>15?128:0;const b=m&15;m=m>>>4;let v=(y|h|b).toString(16);for(o(v,"hex");y;)y=m>127?128:0,v=y|m&127,o(Y3(2,v),"hex"),m=m>>>7;o(un.from(await pZ(d)))}o("PACK"),o("00000002","hex"),o(Y3(8,s.length),"hex");for(const u of s){const{type:d,object:h}=await Js({fs:e,cache:t,gitdir:r,oid:u});await l({object:h,stype:d})}const c=i.digest();return a.push(c),a}async function GEe({fs:e,cache:t,gitdir:n,oids:r,write:s}){const i=await OZ({fs:e,cache:t,gitdir:n,oids:r}),a=un.from(await hk(i)),l=`pack-${a.slice(-20).toString("hex")}.pack`;return s?(await e.write(zt.join(n,`objects/pack/${l}`),a),{filename:l}):{filename:l,packfile:new Uint8Array(a)}}async function KEe({fs:e,dir:t,gitdir:n=zt.join(t,".git"),oids:r,write:s=!1,cache:i={}}){try{return dt("fs",e),dt("gitdir",n),dt("oids",r),await GEe({fs:new An(e),cache:i,gitdir:n,oids:r,write:s})}catch(a){throw a.caller="git.packObjects",a}}async function YEe({fs:e,http:t,onProgress:n,onMessage:r,onAuth:s,onAuthSuccess:i,onAuthFailure:a,dir:o,gitdir:l=zt.join(o,".git"),ref:c,url:u,remote:d,remoteRef:h,prune:m=!1,pruneTags:y=!1,fastForward:b=!0,fastForwardOnly:v=!1,corsProxy:x,singleBranch:w,headers:_={},author:k,committer:C,signingKey:T,cache:A={}}){try{dt("fs",e),dt("gitdir",l);const N=new An(e),I=await Wh({fs:N,gitdir:l,author:k});if(!I)throw new Ga("author");const j=await Ty({fs:N,gitdir:l,author:I,committer:C});if(!j)throw new Ga("committer");return await RZ({fs:N,cache:A,http:t,onProgress:n,onMessage:r,onAuth:s,onAuthSuccess:i,onAuthFailure:a,dir:o,gitdir:l,ref:c,url:u,remote:d,remoteRef:h,fastForward:b,fastForwardOnly:v,corsProxy:x,singleBranch:w,headers:_,author:I,committer:j,signingKey:T,prune:m,pruneTags:y})}catch(N){throw N.caller="git.pull",N}}async function ZEe({fs:e,cache:t,dir:n,gitdir:r=zt.join(n,".git"),start:s,finish:i}){const a=await Ew.read({fs:e,gitdir:r}),o=new Set,l=new Set;for(const d of s)o.add(await Kt.resolve({fs:e,gitdir:r,ref:d}));for(const d of i)try{const h=await Kt.resolve({fs:e,gitdir:r,ref:d});l.add(h)}catch{}const c=new Set;async function u(d){c.add(d);const{type:h,object:m}=await Js({fs:e,cache:t,gitdir:r,oid:d});if(h==="tag"){const b=uo.from(m).headers().object;return u(b)}if(h!=="commit")throw new To(d,h,"commit");if(!a.has(d)){const b=Xs.from(m).headers().parent;for(d of b)!l.has(d)&&!c.has(d)&&await u(d)}}for(const d of o)await u(d);return c}async function xM({fs:e,cache:t,dir:n,gitdir:r=zt.join(n,".git"),oids:s}){const i=new Set;async function a(o){if(i.has(o))return;i.add(o);const{type:l,object:c}=await Js({fs:e,cache:t,gitdir:r,oid:o});if(l==="tag"){const d=uo.from(c).headers().object;await a(d)}else if(l==="commit"){const d=Xs.from(c).headers().tree;await a(d)}else if(l==="tree"){const u=Ko.from(c);for(const d of u)d.type==="blob"&&i.add(d.oid),d.type==="tree"&&await a(d.oid)}}for(const o of s)await a(o);return i}async function XEe(e){const t={};let n="";const r=bi.streamReader(e);let s=await r();for(;s!==!0;)s!==null&&(n+=s.toString("utf8")+`
`),s=await r();const i=n.toString("utf8").split(`
`);if(s=i.shift(),!s.startsWith("unpack "))throw new lg('unpack ok" or "unpack [error message]',s);t.ok=s==="unpack ok",t.ok||(t.error=s.slice(7)),t.refs={};for(const a of i){if(a.trim()==="")continue;const o=a.slice(0,2),l=a.slice(3);let c=l.indexOf(" ");c===-1&&(c=l.length);const u=l.slice(0,c),d=l.slice(c+1);t.refs[u]={ok:o==="ok",error:d}}return t}async function JEe({capabilities:e=[],triplets:t=[]}){const n=[];let r=`\0 ${e.join(" ")}`;for(const s of t)n.push(bi.encode(`${s.oldoid} ${s.oid} ${s.fullRef}${r}
`)),r="";return n.push(bi.flush()),n}async function QEe({fs:e,cache:t,http:n,onProgress:r,onMessage:s,onAuth:i,onAuthSuccess:a,onAuthFailure:o,onPrePush:l,gitdir:c,ref:u,remoteRef:d,remote:h,url:m,force:y=!1,delete:b=!1,corsProxy:v,headers:x={}}){const w=u||await dp({fs:e,gitdir:c});if(typeof w>"u")throw new Ho("ref");const _=await $i.get({fs:e,gitdir:c});h=h||await _.get(`branch.${w}.pushRemote`)||await _.get("remote.pushDefault")||await _.get(`branch.${w}.remote`)||"origin";const k=m||await _.get(`remote.${h}.pushurl`)||await _.get(`remote.${h}.url`);if(typeof k>"u")throw new Ho("remote OR url");const C=d||await _.get(`branch.${w}.merge`);if(typeof k>"u")throw new Ho("remoteRef");v===void 0&&(v=await _.get("http.corsProxy"));const T=await Kt.expand({fs:e,gitdir:c,ref:w}),A=b?"0000000000000000000000000000000000000000":await Kt.resolve({fs:e,gitdir:c,ref:T}),N=yT.getRemoteHelperFor({url:k}),I=await N.discover({http:n,onAuth:i,onAuthSuccess:a,onAuthFailure:o,corsProxy:v,service:"git-receive-pack",url:k,headers:x,protocolVersion:1}),j=I.auth;let L;if(!C)L=T;else try{L=await Kt.expandAgainstMap({ref:C,map:I.refs})}catch(ee){if(ee instanceof Rs)L=C.startsWith("refs/")?C:`refs/heads/${C}`;else throw ee}const D=I.refs.get(L)||"0000000000000000000000000000000000000000";if(l&&!await l({remote:h,url:k,localRef:{ref:b?"(delete)":T,oid:A},remoteRef:{ref:L,oid:D}}))throw new gb;const H=!I.capabilities.has("no-thin");let O=new Set;if(!b){const ee=[...I.refs.values()];let re=new Set;if(D!=="0000000000000000000000000000000000000000"){const de=await TD({fs:e,cache:t,gitdir:c,oids:[A,D]});for(const me of de)ee.push(me);H&&(re=await xM({fs:e,cache:t,gitdir:c,oids:de}))}if(!ee.includes(A)){const de=await ZEe({fs:e,cache:t,gitdir:c,start:[A],finish:ee});O=await xM({fs:e,cache:t,gitdir:c,oids:de})}if(H){try{const de=await Kt.resolve({fs:e,gitdir:c,ref:`refs/remotes/${h}/HEAD`,depth:2}),{oid:me}=await Kt.resolveAgainstMap({ref:de.replace(`refs/remotes/${h}/`,""),fullref:de,map:I.refs}),De=[me];for(const je of await xM({fs:e,cache:t,gitdir:c,oids:De}))re.add(je)}catch{}for(const de of re)O.delete(de)}if(A===D&&(y=!0),!y){if(T.startsWith("refs/tags")&&D!=="0000000000000000000000000000000000000000")throw new ky("tag-exists");if(A!=="0000000000000000000000000000000000000000"&&D!=="0000000000000000000000000000000000000000"&&!await MZ({fs:e,cache:t,gitdir:c,oid:A,ancestor:D,depth:-1}))throw new ky("not-fast-forward")}}const K=CZ([...I.capabilities],["report-status","side-band-64k",`agent=${bT.agent}`]),U=await JEe({capabilities:K,triplets:[{oldoid:D,oid:A,fullRef:L}]}),W=b?[]:await OZ({fs:e,cache:t,gitdir:c,oids:[...O]}),B=await N.connect({http:n,onProgress:r,corsProxy:v,service:"git-receive-pack",url:k,auth:j,headers:x,body:[...U,...W]}),{packfile:ne,progress:V}=await EZ.demux(B.body);if(s){const ee=kZ(V);nS(ee,async re=>{await s(re)})}const Q=await XEe(ne);if(B.headers&&(Q.headers=B.headers),h&&Q.ok&&Q.refs[L].ok&&!T.startsWith("refs/tags")){const ee=`refs/remotes/${h}/${L.replace("refs/heads","")}`;b?await Kt.deleteRef({fs:e,gitdir:c,ref:ee}):await Kt.writeRef({fs:e,gitdir:c,ref:ee,value:A})}if(Q.ok&&Object.values(Q.refs).every(ee=>ee.ok))return Q;{const ee=Object.entries(Q.refs).filter(([re,de])=>!de.ok).map(([re,de])=>`
  - ${re}: ${de.error}`).join("");throw new W1(ee,Q)}}async function eTe({fs:e,http:t,onProgress:n,onMessage:r,onAuth:s,onAuthSuccess:i,onAuthFailure:a,onPrePush:o,dir:l,gitdir:c=zt.join(l,".git"),ref:u,remoteRef:d,remote:h="origin",url:m,force:y=!1,delete:b=!1,corsProxy:v,headers:x={},cache:w={}}){try{return dt("fs",e),dt("http",t),dt("gitdir",c),await QEe({fs:new An(e),cache:w,http:t,onProgress:n,onMessage:r,onAuth:s,onAuthSuccess:i,onAuthFailure:a,onPrePush:o,gitdir:c,ref:u,remoteRef:d,remote:h,url:m,force:y,delete:b,corsProxy:v,headers:x})}catch(_){throw _.caller="git.push",_}}async function DZ({fs:e,cache:t,gitdir:n,oid:r}){const{type:s,object:i}=await Js({fs:e,cache:t,gitdir:n,oid:r});if(s==="tag")return r=uo.from(i).parse().object,DZ({fs:e,cache:t,gitdir:n,oid:r});if(s!=="blob")throw new To(r,s,"blob");return{oid:r,blob:new Uint8Array(i)}}async function FZ({fs:e,cache:t,gitdir:n,oid:r,filepath:s=void 0}){return s!==void 0&&(r=await eS({fs:e,cache:t,gitdir:n,oid:r,filepath:s})),await DZ({fs:e,cache:t,gitdir:n,oid:r})}async function tTe({fs:e,dir:t,gitdir:n=zt.join(t,".git"),oid:r,filepath:s,cache:i={}}){try{return dt("fs",e),dt("gitdir",n),dt("oid",r),await FZ({fs:new An(e),cache:i,gitdir:n,oid:r,filepath:s})}catch(a){throw a.caller="git.readBlob",a}}async function LZ({fs:e,dir:t,gitdir:n=zt.join(t,".git"),oid:r,cache:s={}}){try{return dt("fs",e),dt("gitdir",n),dt("oid",r),await Ay({fs:new An(e),cache:s,gitdir:n,oid:r})}catch(i){throw i.caller="git.readCommit",i}}async function nTe({fs:e,cache:t,gitdir:n,ref:r="refs/notes/commits",oid:s}){const i=await Kt.resolve({gitdir:n,fs:e,ref:r}),{blob:a}=await FZ({fs:e,cache:t,gitdir:n,oid:i,filepath:s});return a}async function rTe({fs:e,dir:t,gitdir:n=zt.join(t,".git"),ref:r="refs/notes/commits",oid:s,cache:i={}}){try{return dt("fs",e),dt("gitdir",n),dt("ref",r),dt("oid",s),await nTe({fs:new An(e),cache:i,gitdir:n,ref:r,oid:s})}catch(a){throw a.caller="git.readNote",a}}async function sTe({fs:e,dir:t,gitdir:n=zt.join(t,".git"),oid:r,format:s="parsed",filepath:i=void 0,encoding:a=void 0,cache:o={}}){try{dt("fs",e),dt("gitdir",n),dt("oid",r);const l=new An(e);i!==void 0&&(r=await eS({fs:l,cache:o,gitdir:n,oid:r,filepath:i}));const u=await Js({fs:l,cache:o,gitdir:n,oid:r,format:s==="parsed"?"content":s});if(u.oid=r,s==="parsed")switch(u.format="parsed",u.type){case"commit":u.object=Xs.from(u.object).parse();break;case"tree":u.object=Ko.from(u.object).entries();break;case"blob":a?u.object=u.object.toString(a):(u.object=new Uint8Array(u.object),u.format="content");break;case"tag":u.object=uo.from(u.object).parse();break;default:throw new To(u.oid,u.type,"blob|commit|tag|tree")}else(u.format==="deflated"||u.format==="wrapped")&&(u.type=u.format);return u}catch(l){throw l.caller="git.readObject",l}}async function iTe({fs:e,cache:t,gitdir:n,oid:r}){const{type:s,object:i}=await Js({fs:e,cache:t,gitdir:n,oid:r,format:"content"});if(s!=="tag")throw new To(r,s,"tag");const a=uo.from(i);return{oid:r,tag:a.parse(),payload:a.payload()}}async function aTe({fs:e,dir:t,gitdir:n=zt.join(t,".git"),oid:r,cache:s={}}){try{return dt("fs",e),dt("gitdir",n),dt("oid",r),await iTe({fs:new An(e),cache:s,gitdir:n,oid:r})}catch(i){throw i.caller="git.readTag",i}}async function oTe({fs:e,dir:t,gitdir:n=zt.join(t,".git"),oid:r,filepath:s=void 0,cache:i={}}){try{return dt("fs",e),dt("gitdir",n),dt("oid",r),await bb({fs:new An(e),cache:i,gitdir:n,oid:r,filepath:s})}catch(a){throw a.caller="git.readTree",a}}async function lTe({fs:e,dir:t,gitdir:n=zt.join(t,".git"),filepath:r,cache:s={}}){try{dt("fs",e),dt("gitdir",n),dt("filepath",r),await ma.acquire({fs:new An(e),gitdir:n,cache:s},async function(i){i.delete({filepath:r})})}catch(i){throw i.caller="git.remove",i}}async function cTe({fs:e,cache:t,onSign:n,gitdir:r,ref:s="refs/notes/commits",oid:i,author:a,committer:o,signingKey:l}){let c;try{c=await Kt.resolve({gitdir:r,fs:e,ref:s})}catch(y){if(!(y instanceof Rs))throw y}let d=(await bb({fs:e,gitdir:r,oid:c||"4b825dc642cb6eb9a060e54bf8d69288fbee4904"})).tree;d=d.filter(y=>y.path!==i);const h=await tS({fs:e,gitdir:r,tree:d});return await gT({fs:e,cache:t,onSign:n,gitdir:r,ref:s,tree:h,parent:c&&[c],message:`Note removed by 'isomorphic-git removeNote'
`,author:a,committer:o,signingKey:l})}async function uTe({fs:e,onSign:t,dir:n,gitdir:r=zt.join(n,".git"),ref:s="refs/notes/commits",oid:i,author:a,committer:o,signingKey:l,cache:c={}}){try{dt("fs",e),dt("gitdir",r),dt("oid",i);const u=new An(e),d=await Wh({fs:u,gitdir:r,author:a});if(!d)throw new Ga("author");const h=await Ty({fs:u,gitdir:r,author:d,committer:o});if(!h)throw new Ga("committer");return await cTe({fs:u,cache:c,onSign:t,gitdir:r,ref:s,oid:i,author:d,committer:h,signingKey:l})}catch(u){throw u.caller="git.removeNote",u}}async function dTe({fs:e,gitdir:t,oldref:n,ref:r,checkout:s=!1}){if(r!==Ru.clean(r))throw new Kc(r,Ru.clean(r));if(n!==Ru.clean(n))throw new Kc(n,Ru.clean(n));const i=`refs/heads/${n}`,a=`refs/heads/${r}`;if(await Kt.exists({fs:e,gitdir:t,ref:a}))throw new Jc("branch",r,!1);const l=await Kt.resolve({fs:e,gitdir:t,ref:i,depth:1});await Kt.writeRef({fs:e,gitdir:t,ref:a,value:l}),await Kt.deleteRef({fs:e,gitdir:t,ref:i});const u=await dp({fs:e,gitdir:t,fullname:!0})===i;(s||u)&&await Kt.writeSymbolicRef({fs:e,gitdir:t,ref:"HEAD",value:a})}async function fTe({fs:e,dir:t,gitdir:n=zt.join(t,".git"),ref:r,oldref:s,checkout:i=!1}){try{return dt("fs",e),dt("gitdir",n),dt("ref",r),dt("oldref",s),await dTe({fs:new An(e),gitdir:n,ref:r,oldref:s,checkout:i})}catch(a){throw a.caller="git.renameBranch",a}}async function BZ({gitdir:e,type:t,object:n}){return uf(hb.wrap({type:t,object:n}))}async function hTe({fs:e,dir:t,gitdir:n=zt.join(t,".git"),filepath:r,ref:s,cache:i={}}){try{dt("fs",e),dt("gitdir",n),dt("filepath",r);const a=new An(e);let o,l;try{o=await Kt.resolve({fs:a,gitdir:n,ref:s||"HEAD"})}catch(d){if(s)throw d}if(o)try{o=await eS({fs:a,cache:i,gitdir:n,oid:o,filepath:r})}catch{o=null}let c={ctime:new Date(0),mtime:new Date(0),dev:0,ino:0,mode:0,uid:0,gid:0,size:0};const u=t&&await a.read(zt.join(t,r));u&&(l=await BZ({gitdir:n,type:"blob",object:u}),o===l&&(c=await a.lstat(zt.join(t,r)))),await ma.acquire({fs:a,gitdir:n,cache:i},async function(d){d.delete({filepath:r}),o&&d.insert({filepath:r,stats:c,oid:o})})}catch(a){throw a.caller="git.reset",a}}async function pTe({fs:e,dir:t,gitdir:n=zt.join(t,".git"),ref:r,depth:s}){try{return dt("fs",e),dt("gitdir",n),dt("ref",r),await Kt.resolve({fs:new An(e),gitdir:n,ref:r,depth:s})}catch(i){throw i.caller="git.resolveRef",i}}async function mTe({fs:e,dir:t,gitdir:n=zt.join(t,".git"),path:r,value:s,append:i=!1}){try{dt("fs",e),dt("gitdir",n),dt("path",r);const a=new An(e),o=await $i.get({fs:a,gitdir:n});i?await o.append(r,s):await o.set(r,s),await $i.save({fs:a,gitdir:n,config:o})}catch(a){throw a.caller="git.setConfig",a}}async function $Z({fs:e,gitdir:t,commit:n}){const r=Xs.from(n).toObject();return await Jo({fs:e,gitdir:t,type:"commit",object:r,format:"content"})}class mk{static get timezoneOffsetForRefLogEntry(){const t=new Date().getTimezoneOffset(),n=Math.abs(Math.floor(t/60)),r=Math.abs(t%60).toString().padStart(2,"0");return`${t>0?"-":"+"}${n.toString().padStart(2,"0")}${r}`}static createStashReflogEntry(t,n,r){const s=t.name.replace(/\s/g,""),i="0000000000000000000000000000000000000000",a=Math.floor(Date.now()/1e3),o=mk.timezoneOffsetForRefLogEntry;return`${i} ${n} ${s} ${t.email} ${a} ${o}	${r}
`}static getStashReflogEntry(t,n=!1){return t.split(`
`).filter(i=>i).reverse().map((i,a)=>n?`stash@{${a}}: ${i.split("	")[1]}`:i)}}const gTe={stage:fb,workdir:Q1};let wM;async function Ry(e,t){return wM===void 0&&(wM=new Cw),wM.acquire(e,t)}async function yTe(e,t,n,r,s=null){const i=zt.join(n,r),a=await e.lstat(i);if(!a)throw new Rs(i);if(a.isDirectory())throw new xr(`${i}: file expected, but found directory`);const o=s?await cZ({fs:e,gitdir:t,oid:s}):void 0;let l=o?s:void 0;return o||await Ry({fs:e,gitdir:t,currentFilepath:i},async()=>{const c=a.isSymbolicLink()?await e.readlink(i).then(mZ):await e.read(i);if(c===null)throw new Rs(i);l=await Jo({fs:e,gitdir:t,type:"blob",object:c})}),l}async function bTe({fs:e,dir:t,gitdir:n,entries:r}){async function s(i){if(i.type==="tree"){if(!i.oid){const a=await Promise.all(i.children.map(s));i.oid=await tS({fs:e,gitdir:n,tree:a}),i.mode=16384}}else i.type==="blob"&&(i.oid=await yTe(e,n,t,i.path,i.oid),i.mode=33188);return i.path=i.path.split("/").pop(),i}return Promise.all(r.map(s))}async function H9({fs:e,dir:t,gitdir:n,treePair:r}){const s=r[1]==="stage",i=r.map(m=>typeof m=="string"?gTe[m]():m),a=[],u=await Vh({fs:e,cache:{},dir:t,gitdir:n,trees:i,map:async(m,[y,b])=>{if(!(m==="."||await yb.isIgnored({fs:e,dir:t,gitdir:n,filepath:m}))&&b)return(!y||await y.oid()!==await b.oid()&&await b.oid()!==void 0)&&a.push([y,b]),{mode:await b.mode(),path:m,oid:await b.oid(),type:await b.type()}},reduce:async(m,y)=>(y=y.filter(Boolean),m?(m.children=y,m):y.length>0?y:void 0),iterate:async(m,y)=>{const b=[];for(const v of y){const[x,w]=v;s?w&&(await e.exists(`${t}/${w.toString()}`)?b.push(v):a.push([null,w])):x&&(w?b.push(v):a.push([x,null]))}return b.length?Promise.all(b.map(m)):[]}});if(a.length===0||u.length===0)return null;const h=(await bTe({fs:e,dir:t,gitdir:n,entries:u})).filter(Boolean).map(m=>({mode:m.mode,path:m.path,oid:m.oid,type:m.type}));return tS({fs:e,gitdir:n,tree:h})}async function vTe({fs:e,dir:t,gitdir:n,stashCommit:r,parentCommit:s,wasStaged:i}){const a=[],o=[],l=await Vh({fs:e,cache:{},dir:t,gitdir:n,trees:[Jl({ref:s}),Jl({ref:r})],map:async(c,[u,d])=>{if(c==="."||await yb.isIgnored({fs:e,dir:t,gitdir:n,filepath:c}))return;const h=d?await d.type():await u.type();if(h!=="tree"&&h!=="blob")return;if(!d&&u){const y=h==="tree"?"rmdir":"rm";return h==="tree"&&a.push(c),h==="blob"&&i&&o.push({filepath:c,oid:await u.oid()}),{method:y,filepath:c}}const m=await d.oid();if(!u||await u.oid()!==m)return h==="tree"?{method:"mkdir",filepath:c}:(i&&o.push({filepath:c,oid:m,stats:await e.lstat(zt.join(t,c))}),{method:"write",filepath:c,oid:m})}});await Ry({fs:e,gitdir:n,dirRemoved:a,ops:l},async()=>{for(const c of l){const u=zt.join(t,c.filepath);switch(c.method){case"rmdir":await e.rmdir(u);break;case"mkdir":await e.mkdir(u);break;case"rm":await e.rm(u);break;case"write":if(!a.some(d=>u.startsWith(d))){const{object:d}=await Js({fs:e,cache:{},gitdir:n,oid:c.oid});await e.exists(u)&&await e.rm(u),await e.write(u,d)}break}}}),await ma.acquire({fs:e,gitdir:n,cache:{}},async c=>{o.forEach(({filepath:u,stats:d,oid:h})=>{c.insert({filepath:u,stats:d,oid:h})})})}class Qd{constructor({fs:t,dir:n,gitdir:r=zt.join(n,".git")}){Object.assign(this,{fs:t,dir:n,gitdir:r,_author:null})}static get refStash(){return"refs/stash"}static get refLogsStash(){return"logs/refs/stash"}get refStashPath(){return zt.join(this.gitdir,Qd.refStash)}get refLogsStashPath(){return zt.join(this.gitdir,Qd.refLogsStash)}async getAuthor(){if(!this._author&&(this._author=await Wh({fs:this.fs,gitdir:this.gitdir,author:{}}),!this._author))throw new Ga("author");return this._author}async getStashSHA(t,n){return await this.fs.exists(this.refStashPath)?(n||await this.readStashReflogs({parsed:!1}))[t].split(" ")[1]:null}async writeStashCommit({message:t,tree:n,parent:r}){return $Z({fs:this.fs,gitdir:this.gitdir,commit:{message:t,tree:n,parent:r,author:await this.getAuthor(),committer:await this.getAuthor()}})}async readStashCommit(t){const n=await this.readStashReflogs({parsed:!1});if(t!==0&&(t<0||t>n.length-1))throw new Kc(`stash@${t}`,"number that is in range of [0, num of stash pushed]");const r=await this.getStashSHA(t,n);return r?Ay({fs:this.fs,cache:{},gitdir:this.gitdir,oid:r}):{}}async writeStashRef(t){return Kt.writeRef({fs:this.fs,gitdir:this.gitdir,ref:Qd.refStash,value:t})}async writeStashReflogEntry({stashCommit:t,message:n}){const r=await this.getAuthor(),s=mk.createStashReflogEntry(r,t,n),i=this.refLogsStashPath;await Ry({filepath:i,entry:s},async()=>{const a=await this.fs.exists(i)?await this.fs.read(i,"utf8"):"";await this.fs.write(i,a+s,"utf8")})}async readStashReflogs({parsed:t=!1}){if(!await this.fs.exists(this.refLogsStashPath))return[];const r=(await this.fs.read(this.refLogsStashPath)).toString();return mk.getStashReflogEntry(r,t)}}async function xTe({fs:e,dir:t,gitdir:n,message:r=""}){const s=new Qd({fs:e,dir:t,gitdir:n});await s.getAuthor();const i=await dp({fs:e,gitdir:n,fullname:!1}),a=await Kt.resolve({fs:e,gitdir:n,ref:"HEAD"}),l=(await LZ({fs:e,dir:t,gitdir:n,oid:a})).commit.message,c=[a];let u=null,d=Jl({ref:"HEAD"});const h=await H9({fs:e,dir:t,gitdir:n,treePair:[Jl({ref:"HEAD"}),"stage"]});if(h){const v=await s.writeStashCommit({message:`stash-Index: WIP on ${i} - ${new Date().toISOString()}`,tree:h,parent:c});c.push(v),u=h,d=fb()}const m=await H9({fs:e,dir:t,gitdir:n,treePair:[d,"workdir"]});if(m){const v=await s.writeStashCommit({message:`stash-WorkDir: WIP on ${i} - ${new Date().toISOString()}`,tree:m,parent:[c[c.length-1]]});c.push(v),u=m}if(!u||!h&&!m)throw new Rs("changes, nothing to stash");const y=(r.trim()||`WIP on ${i}`)+`: ${a.substring(0,7)} ${l}`,b=await s.writeStashCommit({message:y,tree:u,parent:c});return await s.writeStashRef(b),await s.writeStashReflogEntry({stashCommit:b,message:y}),await SZ({fs:e,dir:t,gitdir:n,ref:i,track:!1,force:!0}),b}async function zZ({fs:e,dir:t,gitdir:n,refIdx:r=0}){const i=await new Qd({fs:e,dir:t,gitdir:n}).readStashCommit(r),{parent:a=null}=i.commit?i.commit:{};if(!(!a||!Array.isArray(a)))for(let o=0;o<a.length-1;o++){const c=(await Ay({fs:e,cache:{},gitdir:n,oid:a[o+1]})).commit.message.startsWith("stash-Index");await vTe({fs:e,dir:t,gitdir:n,stashCommit:a[o+1],parentCommit:a[o],wasStaged:c})}}async function UZ({fs:e,dir:t,gitdir:n,refIdx:r=0}){const s=new Qd({fs:e,dir:t,gitdir:n});if(!(await s.readStashCommit(r)).commit)return;const a=s.refStashPath;await Ry(a,async()=>{await e.exists(a)&&await e.rm(a)});const o=await s.readStashReflogs({parsed:!1});if(!o.length)return;o.splice(r,1);const l=s.refLogsStashPath;await Ry({reflogEntries:o,stashReflogPath:l,stashMgr:s},async()=>{if(o.length){await e.write(l,o.join(`
`),"utf8");const c=o[o.length-1].split(" ")[1];await s.writeStashRef(c)}else await e.rm(l)})}async function wTe({fs:e,dir:t,gitdir:n}){return new Qd({fs:e,dir:t,gitdir:n}).readStashReflogs({parsed:!0})}async function STe({fs:e,dir:t,gitdir:n}){const r=new Qd({fs:e,dir:t,gitdir:n}),s=[r.refStashPath,r.refLogsStashPath];await Ry(s,async()=>{await Promise.all(s.map(async i=>{if(await e.exists(i))return e.rm(i)}))})}async function _Te({fs:e,dir:t,gitdir:n,refIdx:r=0}){await zZ({fs:e,dir:t,gitdir:n,refIdx:r}),await UZ({fs:e,dir:t,gitdir:n,refIdx:r})}async function CTe({fs:e,dir:t,gitdir:n=zt.join(t,".git"),op:r="push",message:s="",refIdx:i=0}){dt("fs",e),dt("dir",t),dt("gitdir",n),dt("op",r);const a={push:xTe,apply:zZ,drop:UZ,list:wTe,clear:STe,pop:_Te},o=["apply","drop","pop"];try{const l=new An(e);["refs","logs","logs/refs"].map(d=>zt.join(n,d)).forEach(async d=>{await l.exists(d)||await l.mkdir(d)});const u=a[r];if(u){if(o.includes(r)&&i<0)throw new Kc(`stash@${i}`,"number that is in range of [0, num of stash pushed]");return await u({fs:l,dir:t,gitdir:n,message:s,refIdx:i})}throw new Error(`To be implemented: ${r}`)}catch(l){throw l.caller="git.stash",l}}async function kTe({fs:e,dir:t,gitdir:n=zt.join(t,".git"),filepath:r,cache:s={}}){try{dt("fs",e),dt("gitdir",n),dt("filepath",r);const i=new An(e);if(await yb.isIgnored({fs:i,gitdir:n,dir:t,filepath:r}))return"ignored";const o=await ETe({fs:i,cache:s,gitdir:n}),l=await qZ({fs:i,cache:s,gitdir:n,tree:o,path:r}),c=await ma.acquire({fs:i,gitdir:n,cache:s},async function(b){for(const v of b)if(v.path===r)return v;return null}),u=await i.lstat(zt.join(t,r)),d=l!==null,h=c!==null,m=u!==null,y=async()=>{if(h&&!ok(c,u))return c.oid;{const b=await i.read(zt.join(t,r)),v=await BZ({gitdir:n,type:"blob",object:b});return h&&c.oid===v&&u.size!==-1&&ma.acquire({fs:i,gitdir:n,cache:s},async function(x){x.insert({filepath:r,stats:u,oid:v})}),v}};if(!d&&!m&&!h)return"absent";if(!d&&!m&&h)return"*absent";if(!d&&m&&!h)return"*added";if(!d&&m&&h)return await y()===c.oid?"added":"*added";if(d&&!m&&!h)return"deleted";if(d&&!m&&h)return l===c.oid,"*deleted";if(d&&m&&!h)return await y()===l?"*undeleted":"*undeletemodified";if(d&&m&&h){const b=await y();return b===l?b===c.oid?"unmodified":"*unmodified":b===c.oid?"modified":"*modified"}}catch(i){throw i.caller="git.status",i}}async function qZ({fs:e,cache:t,gitdir:n,tree:r,path:s}){typeof s=="string"&&(s=s.split("/"));const i=s.shift();for(const a of r)if(a.path===i){if(s.length===0)return a.oid;const{type:o,object:l}=await Js({fs:e,cache:t,gitdir:n,oid:a.oid});if(o==="tree"){const c=Ko.from(l);return qZ({fs:e,cache:t,gitdir:n,tree:c,path:s})}if(o==="blob")throw new To(a.oid,o,"blob",s.join("/"))}return null}async function ETe({fs:e,cache:t,gitdir:n}){let r;try{r=await Kt.resolve({fs:e,gitdir:n,ref:"HEAD"})}catch(i){if(i instanceof Rs)return[]}const{tree:s}=await bb({fs:e,cache:t,gitdir:n,oid:r});return s}async function TTe({fs:e,dir:t,gitdir:n=zt.join(t,".git"),ref:r="HEAD",filepaths:s=["."],filter:i,cache:a={},ignored:o=!1}){try{dt("fs",e),dt("gitdir",n),dt("ref",r);const l=new An(e);return await Vh({fs:l,cache:a,dir:t,gitdir:n,trees:[Jl({ref:r}),Q1(),fb()],map:async function(c,[u,d,h]){if(!u&&!h&&d&&!o&&await yb.isIgnored({fs:l,dir:t,filepath:c})||!s.some(T=>wZ(c,T)))return null;if(i&&!i(c))return;const[m,y,b]=await Promise.all([u&&u.type(),d&&d.type(),h&&h.type()]),v=[m,y,b].includes("blob");if((m==="tree"||m==="special")&&!v)return;if(m==="commit")return null;if((y==="tree"||y==="special")&&!v)return;if(b==="commit")return null;if((b==="tree"||b==="special")&&!v)return;const x=m==="blob"?await u.oid():void 0,w=b==="blob"?await h.oid():void 0;let _;m!=="blob"&&y==="blob"&&b!=="blob"?_="42":y==="blob"&&(_=await d.oid());const k=[void 0,x,_,w],C=k.map(T=>k.indexOf(T));return C.shift(),[c,...C]}})}catch(l){throw l.caller="git.statusMatrix",l}}async function ATe({fs:e,dir:t,gitdir:n=zt.join(t,".git"),ref:r,object:s,force:i=!1}){try{dt("fs",e),dt("gitdir",n),dt("ref",r);const a=new An(e);if(r===void 0)throw new Ho("ref");r=r.startsWith("refs/tags/")?r:`refs/tags/${r}`;const o=await Kt.resolve({fs:a,gitdir:n,ref:s||"HEAD"});if(!i&&await Kt.exists({fs:a,gitdir:n,ref:r}))throw new Jc("tag",r);await Kt.writeRef({fs:a,gitdir:n,ref:r,value:o})}catch(a){throw a.caller="git.tag",a}}async function RTe({fs:e,dir:t,gitdir:n=zt.join(t,".git"),cache:r={},filepath:s,oid:i,mode:a,add:o,remove:l,force:c}){try{dt("fs",e),dt("gitdir",n),dt("filepath",s);const u=new An(e);if(l)return await ma.acquire({fs:u,gitdir:n,cache:r},async function(h){if(!c){const m=await u.lstat(zt.join(t,s));if(m){if(m.isDirectory())throw new qh("directory");return}}h.has({filepath:s})&&h.delete({filepath:s})});let d;if(!i){if(d=await u.lstat(zt.join(t,s)),!d)throw new Rs(`file at "${s}" on disk and "remove" not set`);if(d.isDirectory())throw new qh("directory")}return await ma.acquire({fs:u,gitdir:n,cache:r},async function(h){if(!o&&!h.has({filepath:s}))throw new Rs(`file at "${s}" in index and "add" not set`);let m;if(i)m={ctime:new Date(0),mtime:new Date(0),dev:0,ino:0,mode:a,uid:0,gid:0,size:0};else{m=d;const y=m.isSymbolicLink()?await u.readlink(zt.join(t,s)):await u.read(zt.join(t,s));i=await Jo({fs:u,gitdir:n,type:"blob",format:"content",object:y})}return h.insert({filepath:s,oid:i,stats:m}),i})}catch(u){throw u.caller="git.updateIndex",u}}function NTe(){try{return bT.version}catch(e){throw e.caller="git.version",e}}async function ITe({fs:e,dir:t,gitdir:n=zt.join(t,".git"),trees:r,map:s,reduce:i,iterate:a,cache:o={}}){try{return dt("fs",e),dt("gitdir",n),dt("trees",r),await Vh({fs:new An(e),cache:o,dir:t,gitdir:n,trees:r,map:s,reduce:i,iterate:a})}catch(l){throw l.caller="git.walk",l}}async function MTe({fs:e,dir:t,gitdir:n=zt.join(t,".git"),blob:r}){try{return dt("fs",e),dt("gitdir",n),dt("blob",r),await Jo({fs:new An(e),gitdir:n,type:"blob",object:r,format:"content"})}catch(s){throw s.caller="git.writeBlob",s}}async function jTe({fs:e,dir:t,gitdir:n=zt.join(t,".git"),commit:r}){try{return dt("fs",e),dt("gitdir",n),dt("commit",r),await $Z({fs:new An(e),gitdir:n,commit:r})}catch(s){throw s.caller="git.writeCommit",s}}async function PTe({fs:e,dir:t,gitdir:n=zt.join(t,".git"),type:r,object:s,format:i="parsed",oid:a,encoding:o=void 0}){try{const l=new An(e);if(i==="parsed"){switch(r){case"commit":s=Xs.from(s).toObject();break;case"tree":s=Ko.from(s).toObject();break;case"blob":s=un.from(s,o);break;case"tag":s=uo.from(s).toObject();break;default:throw new To(a||"",r,"blob|commit|tag|tree")}i="content"}return a=await Jo({fs:l,gitdir:n,type:r,object:s,oid:a,format:i}),a}catch(l){throw l.caller="git.writeObject",l}}async function OTe({fs:e,dir:t,gitdir:n=zt.join(t,".git"),ref:r,value:s,force:i=!1,symbolic:a=!1}){try{dt("fs",e),dt("gitdir",n),dt("ref",r),dt("value",s);const o=new An(e);if(r!==Ru.clean(r))throw new Kc(r,Ru.clean(r));if(!i&&await Kt.exists({fs:o,gitdir:n,ref:r}))throw new Jc("ref",r);a?await Kt.writeSymbolicRef({fs:o,gitdir:n,ref:r,value:s}):(s=await Kt.resolve({fs:o,gitdir:n,ref:s}),await Kt.writeRef({fs:o,gitdir:n,ref:r,value:s}))}catch(o){throw o.caller="git.writeRef",o}}async function DTe({fs:e,gitdir:t,tag:n}){const r=uo.from(n).toObject();return await Jo({fs:e,gitdir:t,type:"tag",object:r,format:"content"})}async function FTe({fs:e,dir:t,gitdir:n=zt.join(t,".git"),tag:r}){try{return dt("fs",e),dt("gitdir",n),dt("tag",r),await DTe({fs:new An(e),gitdir:n,tag:r})}catch(s){throw s.caller="git.writeTag",s}}async function LTe({fs:e,dir:t,gitdir:n=zt.join(t,".git"),tree:r}){try{return dt("fs",e),dt("gitdir",n),dt("tree",r),await tS({fs:new An(e),gitdir:n,tree:r})}catch(s){throw s.caller="git.writeTree",s}}var Yi={Errors:fke,STAGE:fb,TREE:Jl,WORKDIR:Q1,add:Nke,abortMerge:Eke,addNote:Mke,addRemote:jke,annotatedTag:Oke,branch:Fke,checkout:SZ,clone:Yke,commit:Zke,getConfig:yEe,getConfigAll:vEe,setConfig:mTe,currentBranch:Xke,deleteBranch:Qke,deleteRef:eEe,deleteRemote:nEe,deleteTag:sEe,expandOid:lEe,expandRef:cEe,fastForward:hEe,fetch:pEe,findMergeBase:mEe,findRoot:gEe,getRemoteInfo:xEe,getRemoteInfo2:wEe,hashBlob:_Ee,indexPack:kEe,init:EEe,isDescendent:TEe,isIgnored:AEe,listBranches:REe,listFiles:IEe,listNotes:jEe,listRefs:PEe,listRemotes:DEe,listServerRefs:BEe,listTags:$Ee,log:VEe,merge:WEe,packObjects:KEe,pull:YEe,push:eTe,readBlob:tTe,readCommit:LZ,readNote:rTe,readObject:sTe,readTag:aTe,readTree:oTe,remove:lTe,removeNote:uTe,renameBranch:fTe,resetIndex:hTe,updateIndex:RTe,resolveRef:pTe,status:kTe,statusMatrix:TTe,tag:ATe,version:NTe,walk:ITe,writeBlob:MTe,writeCommit:jTe,writeObject:PTe,writeRef:OTe,writeTag:FTe,writeTree:LTe,stash:CTe};function BTe(e){let t=[e];return{next(){return Promise.resolve({done:t.length===0,value:t.pop()})},return(){return t=[],{}},[Symbol.asyncIterator](){return this}}}function $Te(e){return e[Symbol.asyncIterator]?e[Symbol.asyncIterator]():e[Symbol.iterator]?e[Symbol.iterator]():e.next?e:BTe(e)}async function zTe(e,t){const n=$Te(e);for(;;){const{value:r,done:s}=await n.next();if(r&&await t(r),s)break}n.return&&n.return()}async function UTe(e){let t=0;const n=[];await zTe(e,i=>{n.push(i),t+=i.byteLength});const r=new Uint8Array(t);let s=0;for(const i of n)r.set(i,s),s+=i.byteLength;return r}function qTe(e){if(e[Symbol.asyncIterator])return e;const t=e.getReader();return{next(){return t.read()},return(){return t.releaseLock(),{}},[Symbol.asyncIterator](){return this}}}async function VTe({onProgress:e,url:t,method:n="GET",headers:r={},body:s}){s&&(s=await UTe(s));const i=await fetch(t,{method:n,headers:r,body:s}),a=i.body&&i.body.getReader?qTe(i.body):[new Uint8Array(await i.arrayBuffer())];r={};for(const[o,l]of i.headers.entries())r[o]=l;return{url:i.url,method:i.method,statusCode:i.status,statusMessage:i.statusText,body:a,headers:r}}var Tw={request:VTe};const Aw="https://cors.isomorphic-git.org",Ny=new Map,VZ=async(e,t)=>{const{gitUserName:n,gitUserEmail:r}=pr.getState();if(!n||!r)return ke.error("Git user name and email must be configured in Settings before committing."),!1;try{const s=await Yi.getConfig({fs:t,dir:e,path:"user.name"}).catch(()=>null),i=await Yi.getConfig({fs:t,dir:e,path:"user.email"}).catch(()=>null);return s!==n&&await Yi.setConfig({fs:t,dir:e,path:"user.name",value:n}),i!==r&&await Yi.setConfig({fs:t,dir:e,path:"user.email",value:r}),!0}catch(s){return console.error("[VFS Git Op] Error checking/setting Git config:",s),ke.error(`Failed to configure Git user: ${s instanceof Error?s.message:String(s)}`),!1}},Rw=async(e,t)=>{const n=new URL(e).origin;if(console.log(`[VFS Git Op] Auth requested for ${e}`),t!=null&&t.username&&(t!=null&&t.password))return console.log(`[VFS Git Op] Using stored credentials for ${e}`),{username:t.username,password:t.password,authScheme:"Basic"};const r=Ny.get(n);if(r!=null&&r.username&&(r!=null&&r.password))return console.log(`[VFS Git Op] Using session credentials for ${e}`),{username:r.username,password:r.password,authScheme:"Basic"};console.log(`[VFS Git Op] No stored or session credentials found for ${e}. Prompting user.`);const s=window.prompt(`Enter username for ${e}`);if(!s)return ke.error("Authentication cancelled: Username not provided."),null;const i=window.prompt(`Enter password or token for ${s}@${e}`);return i?(Ny.set(n,{username:s,password:i}),console.log(`[VFS Git Op] Stored prompted credentials in session for ${n}`),{username:s,password:i,authScheme:"Basic"}):(ke.error("Authentication cancelled: Password/token not provided."),null)},Nw=(e,t)=>{const n=new URL(e).origin;return console.error(`[VFS Git Op] Auth FAILED for ${e}`,t),Ny.has(n)&&(console.log(`[VFS Git Op] Clearing failed session credentials for ${n}`),Ny.delete(n)),null},Iw=(e,t)=>{console.log(`[VFS Git Op] Auth SUCCESS for ${e}`,t);const n=new URL(e).origin;!Ny.has(n)&&t.username&&t.password&&(Ny.set(n,{username:t.username,password:t.password}),console.log(`[VFS Git Op] Stored successful prompted credentials in session for ${n}`))},V0=e=>{if(e.name==="HttpError"&&e.data){const{statusCode:t,statusMessage:n,body:r}=e.data;let s="";if(r)try{const i=JSON.parse(r);s=i.message||i.error||JSON.stringify(i)}catch{s=r}return`HTTP ${t} ${n}${s?`: ${s}`:""}`}return e.name==="NotFoundError"?`Not Found: ${e.message}`:e.code==="CheckoutConflictError"?"Checkout conflict: Local changes would be overwritten.":e.code==="MergeConflictError"?"Merge conflict: Resolve conflicts manually.":e instanceof Error?e.message:String(e)},WTe=async(e,t)=>{const n=ya,r=qr(e),s=Wu(r,".git");try{return(await n.promises.stat(s)).isDirectory()}catch(i){return i instanceof Error&&i.code==="ENOENT"||console.error(`[VFS Git Op] Error checking for .git in ${r}:`,i),!1}},WZ=async(e,t,n,r,s)=>{var o;const i=(s==null?void 0:s.fsInstance)??ya,a=qr(e);console.log(`[VFS Git Op] Attempting to clone ${t} into ${a}`);try{let l=!1;try{await i.promises.stat(Wu(a,".git")),l=!0}catch(h){if(h.code!=="ENOENT")throw h}if(l)throw console.warn(`[VFS Git Op] Clone target ${a} already contains a .git directory.`),new Error(`Repository already cloned at ${a}.`);const c=hT(a);if(c!=="/")try{await i.promises.mkdir(c,{recursive:!0})}catch(h){if(h.code!=="EEXIST")throw h}let u=n;if(!u)try{if(u=(o=(await Yi.getRemoteInfo({http:Tw,url:t,corsProxy:Aw,onAuth:m=>Rw(m,r),onAuthFailure:Nw,onAuthSuccess:Iw})).HEAD)==null?void 0:o.replace("refs/heads/",""),!u)throw new Error("Could not determine default branch from remote.");console.log(`[VFS Git Op] No branch specified, using remote default: ${u}`)}catch(h){throw console.error("[VFS Git Op] Failed to get remote info to determine default branch:",h),new Error(`Failed to determine default branch: ${V0(h)}`)}await Yi.clone({fs:i,http:Tw,dir:a,corsProxy:Aw,url:t,ref:u,singleBranch:!0,depth:10,onAuth:h=>Rw(h,r),onAuthFailure:Nw,onAuthSuccess:Iw,onProgress:h=>{h.phase==="counting objects"&&h.total?console.log(`Clone progress: ${h.phase} ${h.loaded}/${h.total}`):h.phase==="receiving objects"&&h.total?console.log(`Clone progress: ${h.phase} ${h.loaded}/${h.total}`):console.log(`Clone progress: ${h.phase}`)}}),await i.promises.stat(Wu(a,".git"));const d=await Yi.currentBranch({fs:i,dir:a,fullname:!1}).catch(()=>null);d!==u&&(console.warn(`[VFS Git Op] Cloned repo HEAD is at ${d}, expected ${u}. Checking out...`),await Yi.checkout({fs:i,dir:a,ref:u})),ke.success(`Repository cloned successfully into ${a} (branch: ${u}).`),console.log(`[VFS Git Op] Clone successful for ${t}`)}catch(l){console.error(`[VFS Git Op] Git clone failed for ${t}:`,l);const c=V0(l);if(l instanceof Error&&l.message.includes("already cloned")||ke.error(`Git clone failed: ${c}`),!(l instanceof Error&&l.message.includes("already cloned")))try{console.log(`[VFS Git Op] Attempting cleanup of failed clone: ${a}`),await i.promises.rm(a,{recursive:!0,force:!0})}catch(u){console.warn("[VFS Git Op] Failed cleanup after clone error:",u)}throw l}},HZ=async(e,t)=>{const n=(t==null?void 0:t.fsInstance)??ya,r=qr(e);try{await Yi.init({fs:n,dir:r}),ke.success(`Initialized empty Git repository in "${xi(r)}"`)}catch(s){throw console.error(`[VFS Git Op] Git init failed for ${r}:`,s),ke.error(`Git init failed: ${s instanceof Error?s.message:String(s)}`),s}},AD=async(e,t,n)=>{const r=(n==null?void 0:n.fsInstance)??ya,s=qr(e);try{if(!await VZ(s,r))throw new Error("Git user configuration is missing or invalid.");if(await Yi.add({fs:r,dir:s,filepath:"."}),!(await Yi.statusMatrix({fs:r,dir:s})).some(([,,c])=>c!==0)){ke.info("No changes detected to commit.");return}const l=await Yi.commit({fs:r,dir:s,message:t,author:{name:pr.getState().gitUserName,email:pr.getState().gitUserEmail}});ke.success(`Changes committed: ${l.substring(0,7)}`)}catch(i){throw console.error(`[VFS Git Op] Git commit failed for ${s}:`,i),ke.error(`Git commit failed: ${i instanceof Error?i.message:String(i)}`),i}},vT=async(e,t,n,r)=>{const s=(r==null?void 0:r.fsInstance)??ya,i=qr(e);try{if(!await VZ(i,s))throw new Error("Git user configuration is missing or invalid.");if(!t)throw new Error("Branch name must be provided for pull operation.");console.log(`[VFS Git Op] Pulling branch ${t} for ${i}`);const o=await Yi.currentBranch({fs:s,dir:i,fullname:!1}).catch(()=>null);if(o!==t){console.log(`[VFS Git Op] Current branch is ${o}, switching to ${t} before pull...`);try{await Yi.checkout({fs:s,dir:i,ref:t})}catch(l){if(l.code==="NotFoundError"){console.log(`[VFS Git Op] Local branch ${t} not found. Attempting to fetch and create...`);try{await Yi.fetch({fs:s,http:Tw,dir:i,corsProxy:Aw,remote:"origin",ref:t,depth:1,singleBranch:!0,tags:!1,onAuth:c=>Rw(c,n),onAuthFailure:Nw,onAuthSuccess:Iw}),await Yi.branch({fs:s,dir:i,ref:t,checkout:!0}),console.log(`[VFS Git Op] Successfully created and checked out local branch ${t}.`)}catch(c){throw console.error(`[VFS Git Op] Failed to create local branch ${t} from remote:`,c),new Error(`Failed to switch to or create local branch "${t}": ${V0(c)}`)}}else throw console.error(`[VFS Git Op] Failed to checkout branch ${t}:`,l),new Error(`Failed to checkout branch "${t}": ${V0(l)}`)}}await Yi.pull({fs:s,http:Tw,dir:i,ref:t,singleBranch:!0,author:{name:pr.getState().gitUserName,email:pr.getState().gitUserEmail},corsProxy:Aw,onAuth:l=>Rw(l,n),onAuthFailure:Nw,onAuthSuccess:Iw}),ke.success(`Pulled changes successfully for "${xi(i)}"`),console.log(`[VFS Git Op] Pull successful for ${i}`)}catch(a){if(console.error(`[VFS Git Op] Git pull failed for ${i}:`,a),a instanceof Error&&a.message.toLowerCase().includes("already up-to-date")?ke.info(`Branch "${t}" is already up-to-date.`):ke.error(`Git pull failed: ${V0(a)}`),!(a instanceof Error&&a.message.toLowerCase().includes("already up-to-date")))throw a}},RD=async(e,t,n,r)=>{var a,o;const s=(r==null?void 0:r.fsInstance)??ya,i=qr(e);try{if(!t)throw new Error("Branch name must be provided for push operation.");console.log(`[VFS Git Op] Pushing local branch ${t} for ${i}`);const l=await Yi.push({fs:s,http:Tw,dir:i,corsProxy:Aw,ref:t,remote:"origin",remoteRef:`refs/heads/${t}`,force:!1,onAuth:c=>Rw(c,n),onAuthFailure:Nw,onAuthSuccess:Iw});if(l!=null&&l.ok)ke.success(`Pushed changes successfully for "${xi(i)}"`);else if((a=l==null?void 0:l.error)!=null&&a.includes("up-to-date"))ke.info(`Branch "${t}" already up-to-date on remote.`);else throw(o=l==null?void 0:l.error)!=null&&o.includes("rejected")?(ke.error(`Push rejected for "${xi(i)}". Pull changes first.`),new Error(l.error)):new Error((l==null?void 0:l.error)||"Push rejected by remote")}catch(l){throw console.error(`[VFS Git Op] Git push failed for ${i}:`,l),l instanceof Error&&l.message.includes("rejected")||ke.error(`Git push failed: ${V0(l)}`),l}},GZ=async(e,t)=>{const n=(t==null?void 0:t.fsInstance)??ya,r=qr(e);console.log(`[VFS Git Op] Git Status on ${r}`);try{const s=await Yi.statusMatrix({fs:n,dir:r});console.log("Git Status Matrix:",s);const i=s.map(([a,o,l,c])=>{let u="";return c===2&&(u+="INDEX_Modified "),c===3&&(u+="INDEX_Added "),o===0&&l===2?u+="WT_New":o===1&&l===2?u+="WT_Modified":o===1&&l===0?u+="WT_Deleted":o===1&&l===1&&c===0&&(u="Unmodified"),(!u||u==="INDEX_Unmodified ")&&(u=`h:${o} w:${l} s:${c}`),`${a}: ${u.trim()}`}).filter(a=>!a.endsWith("Unmodified")).join(`
`);ke.info(`Git Status for "${xi(r)}":
${i||"No changes"}`,{duration:15e3})}catch(s){throw console.error(`[VFS Git Op] Git status failed for ${r}:`,s),ke.error(`Git status failed: ${s instanceof Error?s.message:String(s)}`),s}},Fm=async(e,t)=>{const n=(t==null?void 0:t.fsInstance)??ya,r=qr(e);if(r!=="/")try{await n.promises.mkdir(r,{recursive:!0})}catch(s){if(s instanceof Error&&s.code==="EEXIST"){console.warn(`[VFS Op] Directory already exists or created concurrently: ${r}`);return}throw console.error(`[VFS Op] Failed to create directory ${r}:`,s),ke.error(`Error creating directory "${xi(r)}": ${s instanceof Error?s.message:String(s)}`),s}},HTe=async e=>{try{const t={backend:YCe,name:`litechat_vfs_${e}`};return await zCe(t),ya}catch(t){return console.error(`[VFS Op] Failed to initialize VFS for key "${e}":`,t),ke.error(`Failed to initialize filesystem "${e}": ${t instanceof Error?t.message:String(t)}`),null}},ND=async(e,t)=>{const n=(t==null?void 0:t.fsInstance)??ya,r=qr(e);try{try{await n.promises.stat(r)}catch(l){if(l.code==="ENOENT")return console.warn(`[VFS Op] Directory not found for listing, attempting creation: ${r}`),await Fm(r,{fsInstance:n}),[];throw l}const i=(await n.promises.readdir(r)).map(async l=>{const c=Wu(r,l);try{const u=await n.promises.stat(c);return{name:l,path:c,isDirectory:u.isDirectory(),size:u.size,lastModified:u.mtime}}catch(u){return console.error(`[VFS Op] Failed to stat ${c}:`,u),null}});return(await Promise.all(i)).filter(l=>l!==null)}catch(s){throw console.error(`[VFS Op] Failed to list directory ${r}:`,s),ke.error(`Error listing files: ${s instanceof Error?s.message:String(s)}`),s}},fp=async(e,t)=>{const n=(t==null?void 0:t.fsInstance)??ya,r=qr(e);try{const s=await n.promises.readFile(r);return Ce.emit(hn.fileRead,{path:r}),s}catch(s){throw console.error(`[VFS Op] Failed to read file ${r}:`,s),ke.error(`Error reading file "${xi(r)}": ${s instanceof Error?s.message:String(s)}`),s}},xT=async(e,t,n)=>{const r=(n==null?void 0:n.fsInstance)??ya,s=qr(e),i=hT(s);try{i!=="/"&&await Fm(i,{fsInstance:r}),await r.promises.writeFile(s,t),Ce.emit(hn.fileWritten,{path:s})}catch(a){throw a instanceof Error&&a.message.includes("Error creating directory")||(console.error(`[VFS Op] Failed to write file ${s}:`,a),ke.error(`Error writing file "${xi(s)}": ${a instanceof Error?a.message:String(a)}`)),a}},ID=async(e,t=!1,n)=>{const r=(n==null?void 0:n.fsInstance)??ya,s=qr(e);if(s==="/")throw ke.error("Cannot delete the root directory."),new Error("Cannot delete the root directory.");try{(await r.promises.stat(s)).isDirectory()?(await r.promises.rm(s,{recursive:t}),Ce.emit(hn.fileDeleted,{path:s})):(await r.promises.unlink(s),Ce.emit(hn.fileDeleted,{path:s})),ke.success(`"${xi(s)}" deleted.`)}catch(i){if(i instanceof Error&&i.code==="ENOENT"){console.warn(`[VFS Op] Item not found for deletion: ${s}`);return}throw console.error(`[VFS Op] Failed to delete ${s}:`,i),ke.error(`Error deleting "${xi(s)}": ${i instanceof Error?i.message:String(i)}`),i}},KZ=async(e,t)=>{await Fm(e,t)},GTe=async(e,t,n)=>{try{const r=await fp(e,n),s=new Blob([r]),i=URL.createObjectURL(s),a=document.createElement("a");a.href=i;const o=qr(e);a.download=t||xi(o),document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(i)}catch(r){console.error(`[VFS Op] Failed to initiate download for ${e}:`,r),r instanceof Error&&r.message.includes("Error reading file")||ke.error(`Download failed: ${r instanceof Error?r.message:String(r)}`)}},YZ=async(e,t,n)=>{const r=(n==null?void 0:n.fsInstance)??ya,s=qr(t);let i=0,a=0;const o=Array.from(e);try{await Fm(s,{fsInstance:r});for(const l of o){const c=Wu(s,l.name);try{const u=await l.arrayBuffer();await xT(c,new Uint8Array(u),{fsInstance:r}),i++}catch(u){a++,console.error(`[VFS Op] Failed to upload ${l.name}:`,u)}}}catch(l){a=o.length,console.error(`[VFS Op] Failed to prepare target directory ${s} for upload:`,l)}finally{a>0&&i>0?ke.warning(`Upload complete with issues. ${i} succeeded, ${a} failed.`):a===0&&i>0&&ke.success(`Successfully uploaded ${i} file(s) to ${s==="/"?"root":xi(s)}.`)}},KTe=async(e,t,n)=>{const r=ya;if(!e.name.toLowerCase().endsWith(".zip")){ke.error("Please select a valid ZIP file.");return}const s=qr(t);let i;try{await Fm(s,{fsInstance:r}),i=await vD.loadAsync(e);const a=Object.values(i.files),o=await Promise.allSettled(a.map(async d=>{const h=Wu(s,d.name);if(d.dir)await Fm(h,{fsInstance:r});else{const m=await d.async("uint8array");await xT(h,m,{fsInstance:r})}return{name:d.name,isDir:d.dir}}));let l=0,c=0,u=0;o.forEach(d=>{d.status==="fulfilled"&&d.value?d.value.isDir?c++:l++:d.status==="rejected"&&(u++,console.error("[VFS Op] ZIP Extraction item failed:",d.reason))}),u>0?ke.warning(`Finished extracting "${e.name}". ${l+c} items succeeded, ${u} failed.`):ke.success(`Successfully extracted ${l} files and ${c} folders from "${e.name}" to ${s==="/"?"root":xi(s)}.`)}catch(a){a instanceof Error&&a.message.includes("Error creating directory")||(console.error(`[VFS Op] Failed to extract zip ${e.name}:`,a),ke.error(`ZIP extraction failed: ${a instanceof Error?a.message:String(a)}`))}},G9=async(e,t="/",n)=>{const r=ya,s=new vD,i=qr(t),a=xi(i)||"root";try{try{if(!(await r.promises.stat(i)).isDirectory()){ke.error(`Cannot export: "${a}" is not a directory.`);return}}catch(h){h instanceof Error&&h.code==="ENOENT"?ke.error(`Cannot export: Path "${a}" not found.`):ke.error(`Cannot export: Error accessing path "${a}". ${h instanceof Error?h.message:String(h)}`);return}const o=async(h,m)=>{const y=await ND(h,{fsInstance:r});for(const b of y)if(b.isDirectory){if(b.name===".git")continue;const v=m.folder(b.name);if(v)await o(b.path,v);else throw new Error(`Failed to create subfolder ${b.name} in zip.`)}else{const v=await fp(b.path,{fsInstance:r});m.file(b.name,v)}};await o(i,s);const l=await s.generateAsync({type:"blob"}),c=URL.createObjectURL(l),u=document.createElement("a");u.href=c;const d=`vfs_${a}_export.zip`;u.download=e||d,document.body.appendChild(u),u.click(),document.body.removeChild(u),URL.revokeObjectURL(c),ke.success(`"${a}" exported as ${u.download}.`)}catch(o){console.error("[VFS Op] Failed to download all as zip:",o),o instanceof Error&&(o.message.includes("Error listing files")||o.message.includes("Error reading file")||o.message.includes("Cannot export"))||ke.error(`ZIP export failed: ${o instanceof Error?o.message:String(o)}`)}},ZZ=async(e,t,n)=>{const r=(n==null?void 0:n.fsInstance)??ya,s=qr(e),i=qr(t);if(s==="/"||i==="/")throw ke.error("Cannot rename the root directory."),new Error("Cannot rename the root directory.");if(s!==i)try{const a=hT(i);a!=="/"&&await Fm(a,{fsInstance:r}),await r.promises.rename(s,i),ke.success(`Renamed "${xi(s)}" to "${xi(i)}"`)}catch(a){throw a instanceof Error&&a.code==="ENOENT"?a.message.includes("Error creating directory")||ke.error(`Rename failed: Original item "${xi(s)}" not found.`):a instanceof Error&&a.code==="EEXIST"?ke.error(`Rename failed: An item named "${xi(i)}" already exists.`):a instanceof Error&&a.message.includes("Error creating directory")||ke.error(`Rename failed: ${a instanceof Error?a.message:String(a)}`),console.error(`[VFS Op] Failed to rename ${s} to ${i}:`,a),a}},YTe=1024*5,ZTe=(e,t)=>{try{const n=atob(e),r=new Array(n.length);for(let a=0;a<n.length;a++)r[a]=n.charCodeAt(a);const s=new Uint8Array(r),i=new Blob([s],{type:t});return URL.createObjectURL(i)}catch(n){return console.error("Error creating blob URL from base64:",n),null}},K9=e=>{let t=null;if(e.contentText!==void 0)t=new Blob([e.contentText],{type:e.type});else if(e.contentBase64!==void 0)try{const n=atob(e.contentBase64),r=new Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);const s=new Uint8Array(r);t=new Blob([s],{type:e.type})}catch(n){return console.error("Failed to reconstruct file from base64:",n),null}return t?new File([t],e.name,{type:e.type}):(console.error(`Failed to reconstruct file "${e.name}": No content found in metadata.`),null)},XZ=({fileMeta:e,onRemove:t,isReadOnly:n=!1})=>{const[r,s]=E.useState(null),[i,a]=E.useState(null),[o,l]=E.useState(!1),[c,u]=E.useState(!1),[d,h]=E.useState(!0),m=e.type||"application/octet-stream",y=ow(e.name,m),b=m.startsWith("image/"),v=m.startsWith("audio/"),x=m.startsWith("video/"),w=e.source==="vfs";E.useEffect(()=>{let I=null;return a(null),e.source==="direct"&&!y&&e.contentBase64?(I=ZTe(e.contentBase64,m),I||a("Failed to decode file content for preview."),s(I)):s(null),e.source==="direct"&&y&&e.contentText&&e.contentText.length>YTe?a(`Text file too large for preview (${(e.size/1024).toFixed(1)} KB).`):e.source==="direct"&&y&&e.contentText===void 0&&a("Text content missing from metadata."),()=>{I&&(URL.revokeObjectURL(I),s(null))}},[e.id,e.size,e.source,e.contentBase64,e.contentText,m,y]);const _=async()=>{if(e.source==="vfs"){ke.info("File is already in VFS.");return}const I=K9(e);if(!I){ke.error("Cannot add to VFS: Failed to reconstruct file data.");return}l(!0);try{await YZ([I],"/"),ke.success(`"${e.name}" added to VFS root.`)}catch(j){console.error("Failed to add file to VFS:",j),ke.error(`Failed to add "${e.name}" to VFS.`)}finally{l(!1)}},k=async()=>{u(!0);try{let I;if(e.source==="vfs"&&e.path){const D=await fp(e.path);I=new Blob([D],{type:m})}else{const D=K9(e);if(!D)throw new Error("Could not reconstruct file data.");I=D}const j=URL.createObjectURL(I),L=document.createElement("a");L.href=j,L.download=e.name,document.body.appendChild(L),L.click(),document.body.removeChild(L),URL.revokeObjectURL(j)}catch(I){console.error("Failed to download file:",I),ke.error(`Download failed: ${I instanceof Error?I.message:String(I)}`)}finally{u(!1)}},C=()=>h(I=>!I),T=()=>w?f.jsx(eO,{className:"h-5 w-5 text-cyan-500"}):y?f.jsx(c3,{className:"h-5 w-5 text-blue-500"}):b?f.jsx(Mh,{className:"h-5 w-5 text-purple-500"}):v?f.jsx(Mge,{className:"h-5 w-5 text-green-500"}):x?f.jsx(T0e,{className:"h-5 w-5 text-orange-500"}):f.jsx(Ume,{className:"h-5 w-5 text-muted-foreground"}),A=()=>w?f.jsx("p",{className:"p-2 text-xs text-muted-foreground italic",children:"VFS file attached. Content will be loaded when sent."}):i?f.jsxs("div",{className:"p-2 text-xs text-destructive flex items-center gap-1",children:[f.jsx(Sl,{className:"h-4 w-4"}),f.jsx("span",{children:i})]}):y&&e.contentText!==void 0?f.jsx(ib,{lang:m==="text/markdown"?"markdown":"text",code:e.contentText,filepath:e.name}):b&&r?f.jsx("img",{src:r,alt:e.name,className:"max-w-full max-h-64 object-contain rounded"}):v&&r?f.jsx("audio",{controls:!0,src:r,className:"w-full",children:"Your browser does not support the audio element."}):x&&r?f.jsx("video",{controls:!0,src:r,className:"max-w-full max-h-64 rounded",children:"Your browser does not support the video tag."}):f.jsx("p",{className:"p-2 text-xs text-muted-foreground italic",children:"Preview not available for this file type or content missing."}),N=E.useMemo(()=>{let I="File";return w?I="VFS File":y?I="Text":b?I="Image":v?I="Audio":x&&(I="Video"),`${I} (${_w(e.size)})`},[w,y,b,v,x,e.size]);return f.jsxs("div",{className:"border rounded-md overflow-hidden bg-card shadow-sm my-1",children:[f.jsxs("div",{className:"flex items-center justify-between p-2 border-b bg-muted/30",children:[f.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[T(),f.jsx("span",{className:"text-sm font-medium truncate",title:e.name,children:e.name}),f.jsxs("span",{className:"text-xs text-muted-foreground flex-shrink-0",children:["(",_w(e.size),")"]}),w&&e.path&&f.jsx(wr,{delayDuration:100,children:f.jsxs(Sr,{children:[f.jsx(_r,{asChild:!0,children:f.jsxs("span",{className:"text-xs text-cyan-400 truncate max-w-[100px]",children:["(VFS: ",e.path,")"]})}),f.jsx(Cr,{children:f.jsxs("p",{children:["From VFS: ",e.path]})})]})})]}),f.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[f.jsx(wr,{delayDuration:100,children:f.jsxs(Sr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(ot,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:k,disabled:c,"aria-label":"Download file",children:c?f.jsx(Hn,{className:"h-3.5 w-3.5 animate-spin"}):f.jsx(Fc,{className:"h-3.5 w-3.5"})})}),f.jsx(Cr,{children:"Download File"})]})}),f.jsx(wr,{delayDuration:100,children:f.jsxs(Sr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(ot,{variant:"ghost",size:"icon",className:"h-6 w-6 text-muted-foreground hover:text-foreground",onClick:C,"aria-label":d?"Unfold preview":"Fold preview",children:f.jsx(EE,{className:"h-3.5 w-3.5"})})}),f.jsx(Cr,{side:"top",children:d?"Unfold":"Fold"})]})}),!n&&t&&f.jsxs(f.Fragment,{children:[e.source==="direct"&&f.jsx(wr,{delayDuration:100,children:f.jsxs(Sr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(ot,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:_,disabled:o,"aria-label":"Add to VFS",children:o?f.jsx(Hn,{className:"h-3.5 w-3.5 animate-spin"}):f.jsx(J4,{className:"h-3.5 w-3.5"})})}),f.jsx(Cr,{children:"Add to VFS"})]})}),f.jsx(wr,{delayDuration:100,children:f.jsxs(Sr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(ot,{variant:"ghost",size:"icon",className:"h-6 w-6 text-destructive hover:text-destructive/80",onClick:()=>t(e.id),"aria-label":"Remove file",children:f.jsx(Si,{className:"h-3.5 w-3.5"})})}),f.jsx(Cr,{children:"Remove from Prompt"})]})})]})]})]}),d?f.jsx("div",{className:"p-2 text-xs text-muted-foreground italic cursor-pointer hover:bg-muted/20",onClick:C,children:N}):f.jsx("div",{className:Ye("p-2 max-h-80 overflow-y-auto"),children:A()})]})},JZ=6048e5,XTe=864e5,QZ=6e4,eX=36e5,rC=43200,Y9=1440,Z9=Symbol.for("constructDateFrom");function _i(e,t){return typeof e=="function"?e(t):e&&typeof e=="object"&&Z9 in e?e[Z9](t):e instanceof Date?new e.constructor(t):new Date(t)}function Wr(e,t){return _i(t||e,e)}function tX(e,t,n){const r=Wr(e,n==null?void 0:n.in);return isNaN(t)?_i(e,NaN):(t&&r.setDate(r.getDate()+t),r)}function nX(e,t,n){const r=Wr(e,n==null?void 0:n.in);if(isNaN(t))return _i(e,NaN);if(!t)return r;const s=r.getDate(),i=_i(e,r.getTime());i.setMonth(r.getMonth()+t+1,0);const a=i.getDate();return s>=a?i:(r.setFullYear(i.getFullYear(),i.getMonth(),s),r)}let JTe={};function vb(){return JTe}function Iy(e,t){var o,l,c,u;const n=vb(),r=(t==null?void 0:t.weekStartsOn)??((l=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:l.weekStartsOn)??n.weekStartsOn??((u=(c=n.locale)==null?void 0:c.options)==null?void 0:u.weekStartsOn)??0,s=Wr(e,t==null?void 0:t.in),i=s.getDay(),a=(i<r?7:0)+i-r;return s.setDate(s.getDate()-a),s.setHours(0,0,0,0),s}function Mw(e,t){return Iy(e,{...t,weekStartsOn:1})}function rX(e,t){const n=Wr(e,t==null?void 0:t.in),r=n.getFullYear(),s=_i(n,0);s.setFullYear(r+1,0,4),s.setHours(0,0,0,0);const i=Mw(s),a=_i(n,0);a.setFullYear(r,0,4),a.setHours(0,0,0,0);const o=Mw(a);return n.getTime()>=i.getTime()?r+1:n.getTime()>=o.getTime()?r:r-1}function gk(e){const t=Wr(e),n=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return n.setUTCFullYear(t.getFullYear()),+e-+n}function hp(e,...t){const n=_i.bind(null,e||t.find(r=>typeof r=="object"));return t.map(n)}function jw(e,t){const n=Wr(e,t==null?void 0:t.in);return n.setHours(0,0,0,0),n}function sX(e,t,n){const[r,s]=hp(n==null?void 0:n.in,e,t),i=jw(r),a=jw(s),o=+i-gk(i),l=+a-gk(a);return Math.round((o-l)/XTe)}function QTe(e,t){const n=rX(e,t),r=_i(e,0);return r.setFullYear(n,0,4),r.setHours(0,0,0,0),Mw(r)}function eAe(e,t,n){return tX(e,t*7,n)}function tAe(e,t,n){return nX(e,t*12,n)}function nAe(e,t){let n,r=t==null?void 0:t.in;return e.forEach(s=>{!r&&typeof s=="object"&&(r=_i.bind(null,s));const i=Wr(s,r);(!n||n<i||isNaN(+i))&&(n=i)}),_i(r,n||NaN)}function rAe(e,t){let n,r=t==null?void 0:t.in;return e.forEach(s=>{!r&&typeof s=="object"&&(r=_i.bind(null,s));const i=Wr(s,r);(!n||n>i||isNaN(+i))&&(n=i)}),_i(r,n||NaN)}function KC(e,t){const n=+Wr(e)-+Wr(t);return n<0?-1:n>0?1:n}function sAe(e){return _i(e,Date.now())}function iAe(e,t,n){const[r,s]=hp(n==null?void 0:n.in,e,t);return+jw(r)==+jw(s)}function iX(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function aAe(e){return!(!iX(e)&&typeof e!="number"||isNaN(+Wr(e)))}function aX(e,t,n){const[r,s]=hp(n==null?void 0:n.in,e,t),i=r.getFullYear()-s.getFullYear(),a=r.getMonth()-s.getMonth();return i*12+a}function oAe(e){return t=>{const r=(e?Math[e]:Math.trunc)(t);return r===0?0:r}}function lAe(e,t){return+Wr(e)-+Wr(t)}function cAe(e,t){const n=Wr(e,t==null?void 0:t.in);return n.setHours(23,59,59,999),n}function oX(e,t){const n=Wr(e,t==null?void 0:t.in),r=n.getMonth();return n.setFullYear(n.getFullYear(),r+1,0),n.setHours(23,59,59,999),n}function uAe(e,t){const n=Wr(e,t==null?void 0:t.in);return+cAe(n,t)==+oX(n,t)}function dAe(e,t,n){const[r,s,i]=hp(n==null?void 0:n.in,e,e,t),a=KC(s,i),o=Math.abs(aX(s,i));if(o<1)return 0;s.getMonth()===1&&s.getDate()>27&&s.setDate(30),s.setMonth(s.getMonth()-a*o);let l=KC(s,i)===-a;uAe(r)&&o===1&&KC(r,i)===1&&(l=!1);const c=a*(o-+l);return c===0?0:c}function fAe(e,t,n){const r=lAe(e,t)/1e3;return oAe(n==null?void 0:n.roundingMethod)(r)}function hAe(e,t){const[n,r]=hp(e,t.start,t.end);return{start:n,end:r}}function pAe(e,t){const{start:n,end:r}=hAe(t==null?void 0:t.in,e);let s=+n>+r;const i=s?+n:+r,a=s?r:n;a.setHours(0,0,0,0),a.setDate(1);let o=1;const l=[];for(;+a<=i;)l.push(_i(n,a)),a.setMonth(a.getMonth()+o);return s?l.reverse():l}function mAe(e,t){const n=Wr(e,t==null?void 0:t.in);return n.setDate(1),n.setHours(0,0,0,0),n}function gAe(e,t){const n=Wr(e,t==null?void 0:t.in),r=n.getFullYear();return n.setFullYear(r+1,0,0),n.setHours(23,59,59,999),n}function lX(e,t){const n=Wr(e,t==null?void 0:t.in);return n.setFullYear(n.getFullYear(),0,1),n.setHours(0,0,0,0),n}function cX(e,t){var o,l,c,u;const n=vb(),r=(t==null?void 0:t.weekStartsOn)??((l=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:l.weekStartsOn)??n.weekStartsOn??((u=(c=n.locale)==null?void 0:c.options)==null?void 0:u.weekStartsOn)??0,s=Wr(e,t==null?void 0:t.in),i=s.getDay(),a=(i<r?-7:0)+6-(i-r);return s.setDate(s.getDate()+a),s.setHours(23,59,59,999),s}function yAe(e,t){return cX(e,{...t,weekStartsOn:1})}const bAe={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},vAe=(e,t,n)=>{let r;const s=bAe[e];return typeof s=="string"?r=s:t===1?r=s.one:r=s.other.replace("{{count}}",t.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+r:r+" ago":r};function SM(e){return(t={})=>{const n=t.width?String(t.width):e.defaultWidth;return e.formats[n]||e.formats[e.defaultWidth]}}const xAe={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},wAe={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},SAe={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},_Ae={date:SM({formats:xAe,defaultWidth:"full"}),time:SM({formats:wAe,defaultWidth:"full"}),dateTime:SM({formats:SAe,defaultWidth:"full"})},CAe={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},kAe=(e,t,n,r)=>CAe[e];function Gv(e){return(t,n)=>{const r=n!=null&&n.context?String(n.context):"standalone";let s;if(r==="formatting"&&e.formattingValues){const a=e.defaultFormattingWidth||e.defaultWidth,o=n!=null&&n.width?String(n.width):a;s=e.formattingValues[o]||e.formattingValues[a]}else{const a=e.defaultWidth,o=n!=null&&n.width?String(n.width):e.defaultWidth;s=e.values[o]||e.values[a]}const i=e.argumentCallback?e.argumentCallback(t):t;return s[i]}}const EAe={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},TAe={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},AAe={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},RAe={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},NAe={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},IAe={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},MAe=(e,t)=>{const n=Number(e),r=n%100;if(r>20||r<10)switch(r%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},jAe={ordinalNumber:MAe,era:Gv({values:EAe,defaultWidth:"wide"}),quarter:Gv({values:TAe,defaultWidth:"wide",argumentCallback:e=>e-1}),month:Gv({values:AAe,defaultWidth:"wide"}),day:Gv({values:RAe,defaultWidth:"wide"}),dayPeriod:Gv({values:NAe,defaultWidth:"wide",formattingValues:IAe,defaultFormattingWidth:"wide"})};function Kv(e){return(t,n={})=>{const r=n.width,s=r&&e.matchPatterns[r]||e.matchPatterns[e.defaultMatchWidth],i=t.match(s);if(!i)return null;const a=i[0],o=r&&e.parsePatterns[r]||e.parsePatterns[e.defaultParseWidth],l=Array.isArray(o)?OAe(o,d=>d.test(a)):PAe(o,d=>d.test(a));let c;c=e.valueCallback?e.valueCallback(l):l,c=n.valueCallback?n.valueCallback(c):c;const u=t.slice(a.length);return{value:c,rest:u}}}function PAe(e,t){for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&t(e[n]))return n}function OAe(e,t){for(let n=0;n<e.length;n++)if(t(e[n]))return n}function DAe(e){return(t,n={})=>{const r=t.match(e.matchPattern);if(!r)return null;const s=r[0],i=t.match(e.parsePattern);if(!i)return null;let a=e.valueCallback?e.valueCallback(i[0]):i[0];a=n.valueCallback?n.valueCallback(a):a;const o=t.slice(s.length);return{value:a,rest:o}}}const FAe=/^(\d+)(th|st|nd|rd)?/i,LAe=/\d+/i,BAe={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},$Ae={any:[/^b/i,/^(a|c)/i]},zAe={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},UAe={any:[/1/i,/2/i,/3/i,/4/i]},qAe={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},VAe={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},WAe={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},HAe={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},GAe={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},KAe={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},YAe={ordinalNumber:DAe({matchPattern:FAe,parsePattern:LAe,valueCallback:e=>parseInt(e,10)}),era:Kv({matchPatterns:BAe,defaultMatchWidth:"wide",parsePatterns:$Ae,defaultParseWidth:"any"}),quarter:Kv({matchPatterns:zAe,defaultMatchWidth:"wide",parsePatterns:UAe,defaultParseWidth:"any",valueCallback:e=>e+1}),month:Kv({matchPatterns:qAe,defaultMatchWidth:"wide",parsePatterns:VAe,defaultParseWidth:"any"}),day:Kv({matchPatterns:WAe,defaultMatchWidth:"wide",parsePatterns:HAe,defaultParseWidth:"any"}),dayPeriod:Kv({matchPatterns:GAe,defaultMatchWidth:"any",parsePatterns:KAe,defaultParseWidth:"any"})},wT={code:"en-US",formatDistance:vAe,formatLong:_Ae,formatRelative:kAe,localize:jAe,match:YAe,options:{weekStartsOn:0,firstWeekContainsDate:1}};function ZAe(e,t){const n=Wr(e,t==null?void 0:t.in);return sX(n,lX(n))+1}function uX(e,t){const n=Wr(e,t==null?void 0:t.in),r=+Mw(n)-+QTe(n);return Math.round(r/JZ)+1}function dX(e,t){var u,d,h,m;const n=Wr(e,t==null?void 0:t.in),r=n.getFullYear(),s=vb(),i=(t==null?void 0:t.firstWeekContainsDate)??((d=(u=t==null?void 0:t.locale)==null?void 0:u.options)==null?void 0:d.firstWeekContainsDate)??s.firstWeekContainsDate??((m=(h=s.locale)==null?void 0:h.options)==null?void 0:m.firstWeekContainsDate)??1,a=_i((t==null?void 0:t.in)||e,0);a.setFullYear(r+1,0,i),a.setHours(0,0,0,0);const o=Iy(a,t),l=_i((t==null?void 0:t.in)||e,0);l.setFullYear(r,0,i),l.setHours(0,0,0,0);const c=Iy(l,t);return+n>=+o?r+1:+n>=+c?r:r-1}function XAe(e,t){var o,l,c,u;const n=vb(),r=(t==null?void 0:t.firstWeekContainsDate)??((l=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:l.firstWeekContainsDate)??n.firstWeekContainsDate??((u=(c=n.locale)==null?void 0:c.options)==null?void 0:u.firstWeekContainsDate)??1,s=dX(e,t),i=_i((t==null?void 0:t.in)||e,0);return i.setFullYear(s,0,r),i.setHours(0,0,0,0),Iy(i,t)}function fX(e,t){const n=Wr(e,t==null?void 0:t.in),r=+Iy(n,t)-+XAe(n,t);return Math.round(r/JZ)+1}function xs(e,t){const n=e<0?"-":"",r=Math.abs(e).toString().padStart(t,"0");return n+r}const fh={y(e,t){const n=e.getFullYear(),r=n>0?n:1-n;return xs(t==="yy"?r%100:r,t.length)},M(e,t){const n=e.getMonth();return t==="M"?String(n+1):xs(n+1,2)},d(e,t){return xs(e.getDate(),t.length)},a(e,t){const n=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];case"aaaa":default:return n==="am"?"a.m.":"p.m."}},h(e,t){return xs(e.getHours()%12||12,t.length)},H(e,t){return xs(e.getHours(),t.length)},m(e,t){return xs(e.getMinutes(),t.length)},s(e,t){return xs(e.getSeconds(),t.length)},S(e,t){const n=t.length,r=e.getMilliseconds(),s=Math.trunc(r*Math.pow(10,n-3));return xs(s,t.length)}},f0={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},X9={G:function(e,t,n){const r=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return n.era(r,{width:"abbreviated"});case"GGGGG":return n.era(r,{width:"narrow"});case"GGGG":default:return n.era(r,{width:"wide"})}},y:function(e,t,n){if(t==="yo"){const r=e.getFullYear(),s=r>0?r:1-r;return n.ordinalNumber(s,{unit:"year"})}return fh.y(e,t)},Y:function(e,t,n,r){const s=dX(e,r),i=s>0?s:1-s;if(t==="YY"){const a=i%100;return xs(a,2)}return t==="Yo"?n.ordinalNumber(i,{unit:"year"}):xs(i,t.length)},R:function(e,t){const n=rX(e);return xs(n,t.length)},u:function(e,t){const n=e.getFullYear();return xs(n,t.length)},Q:function(e,t,n){const r=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(r);case"QQ":return xs(r,2);case"Qo":return n.ordinalNumber(r,{unit:"quarter"});case"QQQ":return n.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(r,{width:"wide",context:"formatting"})}},q:function(e,t,n){const r=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(r);case"qq":return xs(r,2);case"qo":return n.ordinalNumber(r,{unit:"quarter"});case"qqq":return n.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(r,{width:"wide",context:"standalone"})}},M:function(e,t,n){const r=e.getMonth();switch(t){case"M":case"MM":return fh.M(e,t);case"Mo":return n.ordinalNumber(r+1,{unit:"month"});case"MMM":return n.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(r,{width:"wide",context:"formatting"})}},L:function(e,t,n){const r=e.getMonth();switch(t){case"L":return String(r+1);case"LL":return xs(r+1,2);case"Lo":return n.ordinalNumber(r+1,{unit:"month"});case"LLL":return n.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(r,{width:"wide",context:"standalone"})}},w:function(e,t,n,r){const s=fX(e,r);return t==="wo"?n.ordinalNumber(s,{unit:"week"}):xs(s,t.length)},I:function(e,t,n){const r=uX(e);return t==="Io"?n.ordinalNumber(r,{unit:"week"}):xs(r,t.length)},d:function(e,t,n){return t==="do"?n.ordinalNumber(e.getDate(),{unit:"date"}):fh.d(e,t)},D:function(e,t,n){const r=ZAe(e);return t==="Do"?n.ordinalNumber(r,{unit:"dayOfYear"}):xs(r,t.length)},E:function(e,t,n){const r=e.getDay();switch(t){case"E":case"EE":case"EEE":return n.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(r,{width:"short",context:"formatting"});case"EEEE":default:return n.day(r,{width:"wide",context:"formatting"})}},e:function(e,t,n,r){const s=e.getDay(),i=(s-r.weekStartsOn+8)%7||7;switch(t){case"e":return String(i);case"ee":return xs(i,2);case"eo":return n.ordinalNumber(i,{unit:"day"});case"eee":return n.day(s,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(s,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(s,{width:"short",context:"formatting"});case"eeee":default:return n.day(s,{width:"wide",context:"formatting"})}},c:function(e,t,n,r){const s=e.getDay(),i=(s-r.weekStartsOn+8)%7||7;switch(t){case"c":return String(i);case"cc":return xs(i,t.length);case"co":return n.ordinalNumber(i,{unit:"day"});case"ccc":return n.day(s,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(s,{width:"narrow",context:"standalone"});case"cccccc":return n.day(s,{width:"short",context:"standalone"});case"cccc":default:return n.day(s,{width:"wide",context:"standalone"})}},i:function(e,t,n){const r=e.getDay(),s=r===0?7:r;switch(t){case"i":return String(s);case"ii":return xs(s,t.length);case"io":return n.ordinalNumber(s,{unit:"day"});case"iii":return n.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(r,{width:"short",context:"formatting"});case"iiii":default:return n.day(r,{width:"wide",context:"formatting"})}},a:function(e,t,n){const s=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(s,{width:"wide",context:"formatting"})}},b:function(e,t,n){const r=e.getHours();let s;switch(r===12?s=f0.noon:r===0?s=f0.midnight:s=r/12>=1?"pm":"am",t){case"b":case"bb":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(s,{width:"wide",context:"formatting"})}},B:function(e,t,n){const r=e.getHours();let s;switch(r>=17?s=f0.evening:r>=12?s=f0.afternoon:r>=4?s=f0.morning:s=f0.night,t){case"B":case"BB":case"BBB":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(s,{width:"wide",context:"formatting"})}},h:function(e,t,n){if(t==="ho"){let r=e.getHours()%12;return r===0&&(r=12),n.ordinalNumber(r,{unit:"hour"})}return fh.h(e,t)},H:function(e,t,n){return t==="Ho"?n.ordinalNumber(e.getHours(),{unit:"hour"}):fh.H(e,t)},K:function(e,t,n){const r=e.getHours()%12;return t==="Ko"?n.ordinalNumber(r,{unit:"hour"}):xs(r,t.length)},k:function(e,t,n){let r=e.getHours();return r===0&&(r=24),t==="ko"?n.ordinalNumber(r,{unit:"hour"}):xs(r,t.length)},m:function(e,t,n){return t==="mo"?n.ordinalNumber(e.getMinutes(),{unit:"minute"}):fh.m(e,t)},s:function(e,t,n){return t==="so"?n.ordinalNumber(e.getSeconds(),{unit:"second"}):fh.s(e,t)},S:function(e,t){return fh.S(e,t)},X:function(e,t,n){const r=e.getTimezoneOffset();if(r===0)return"Z";switch(t){case"X":return Q9(r);case"XXXX":case"XX":return em(r);case"XXXXX":case"XXX":default:return em(r,":")}},x:function(e,t,n){const r=e.getTimezoneOffset();switch(t){case"x":return Q9(r);case"xxxx":case"xx":return em(r);case"xxxxx":case"xxx":default:return em(r,":")}},O:function(e,t,n){const r=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+J9(r,":");case"OOOO":default:return"GMT"+em(r,":")}},z:function(e,t,n){const r=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+J9(r,":");case"zzzz":default:return"GMT"+em(r,":")}},t:function(e,t,n){const r=Math.trunc(+e/1e3);return xs(r,t.length)},T:function(e,t,n){return xs(+e,t.length)}};function J9(e,t=""){const n=e>0?"-":"+",r=Math.abs(e),s=Math.trunc(r/60),i=r%60;return i===0?n+String(s):n+String(s)+t+xs(i,2)}function Q9(e,t){return e%60===0?(e>0?"-":"+")+xs(Math.abs(e)/60,2):em(e,t)}function em(e,t=""){const n=e>0?"-":"+",r=Math.abs(e),s=xs(Math.trunc(r/60),2),i=xs(r%60,2);return n+s+t+i}const e7=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},hX=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},JAe=(e,t)=>{const n=e.match(/(P+)(p+)?/)||[],r=n[1],s=n[2];if(!s)return e7(e,t);let i;switch(r){case"P":i=t.dateTime({width:"short"});break;case"PP":i=t.dateTime({width:"medium"});break;case"PPP":i=t.dateTime({width:"long"});break;case"PPPP":default:i=t.dateTime({width:"full"});break}return i.replace("{{date}}",e7(r,t)).replace("{{time}}",hX(s,t))},QAe={p:hX,P:JAe},eRe=/^D+$/,tRe=/^Y+$/,nRe=["D","DD","YY","YYYY"];function rRe(e){return eRe.test(e)}function sRe(e){return tRe.test(e)}function iRe(e,t,n){const r=aRe(e,t,n);if(console.warn(r),nRe.includes(e))throw new RangeError(r)}function aRe(e,t,n){const r=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${r} to the input \`${n}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const oRe=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,lRe=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,cRe=/^'([^]*?)'?$/,uRe=/''/g,dRe=/[a-zA-Z]/;function Vd(e,t,n){var u,d,h,m,y,b,v,x;const r=vb(),s=(n==null?void 0:n.locale)??r.locale??wT,i=(n==null?void 0:n.firstWeekContainsDate)??((d=(u=n==null?void 0:n.locale)==null?void 0:u.options)==null?void 0:d.firstWeekContainsDate)??r.firstWeekContainsDate??((m=(h=r.locale)==null?void 0:h.options)==null?void 0:m.firstWeekContainsDate)??1,a=(n==null?void 0:n.weekStartsOn)??((b=(y=n==null?void 0:n.locale)==null?void 0:y.options)==null?void 0:b.weekStartsOn)??r.weekStartsOn??((x=(v=r.locale)==null?void 0:v.options)==null?void 0:x.weekStartsOn)??0,o=Wr(e,n==null?void 0:n.in);if(!aAe(o))throw new RangeError("Invalid time value");let l=t.match(lRe).map(w=>{const _=w[0];if(_==="p"||_==="P"){const k=QAe[_];return k(w,s.formatLong)}return w}).join("").match(oRe).map(w=>{if(w==="''")return{isToken:!1,value:"'"};const _=w[0];if(_==="'")return{isToken:!1,value:fRe(w)};if(X9[_])return{isToken:!0,value:w};if(_.match(dRe))throw new RangeError("Format string contains an unescaped latin alphabet character `"+_+"`");return{isToken:!1,value:w}});s.localize.preprocessor&&(l=s.localize.preprocessor(o,l));const c={firstWeekContainsDate:i,weekStartsOn:a,locale:s};return l.map(w=>{if(!w.isToken)return w.value;const _=w.value;(!(n!=null&&n.useAdditionalWeekYearTokens)&&sRe(_)||!(n!=null&&n.useAdditionalDayOfYearTokens)&&rRe(_))&&iRe(_,t,String(e));const k=X9[_[0]];return k(o,_,s.localize,c)}).join("")}function fRe(e){const t=e.match(cRe);return t?t[1].replace(uRe,"'"):e}function hRe(e,t,n){const r=vb(),s=(n==null?void 0:n.locale)??r.locale??wT,i=2520,a=KC(e,t);if(isNaN(a))throw new RangeError("Invalid time value");const o=Object.assign({},n,{addSuffix:n==null?void 0:n.addSuffix,comparison:a}),[l,c]=hp(n==null?void 0:n.in,...a>0?[t,e]:[e,t]),u=fAe(c,l),d=(gk(c)-gk(l))/1e3,h=Math.round((u-d)/60);let m;if(h<2)return n!=null&&n.includeSeconds?u<5?s.formatDistance("lessThanXSeconds",5,o):u<10?s.formatDistance("lessThanXSeconds",10,o):u<20?s.formatDistance("lessThanXSeconds",20,o):u<40?s.formatDistance("halfAMinute",0,o):u<60?s.formatDistance("lessThanXMinutes",1,o):s.formatDistance("xMinutes",1,o):h===0?s.formatDistance("lessThanXMinutes",1,o):s.formatDistance("xMinutes",h,o);if(h<45)return s.formatDistance("xMinutes",h,o);if(h<90)return s.formatDistance("aboutXHours",1,o);if(h<Y9){const y=Math.round(h/60);return s.formatDistance("aboutXHours",y,o)}else{if(h<i)return s.formatDistance("xDays",1,o);if(h<rC){const y=Math.round(h/Y9);return s.formatDistance("xDays",y,o)}else if(h<rC*2)return m=Math.round(h/rC),s.formatDistance("aboutXMonths",m,o)}if(m=dAe(c,l),m<12){const y=Math.round(h/rC);return s.formatDistance("xMonths",y,o)}else{const y=m%12,b=Math.trunc(m/12);return y<3?s.formatDistance("aboutXYears",b,o):y<9?s.formatDistance("overXYears",b,o):s.formatDistance("almostXYears",b+1,o)}}function pX(e,t){return hRe(e,sAe(e),t)}function pRe(e,t){const n=Wr(e,t==null?void 0:t.in),r=n.getFullYear(),s=n.getMonth(),i=_i(n,0);return i.setFullYear(r,s+1,0),i.setHours(0,0,0,0),i.getDate()}function mRe(e,t){return Wr(e,t==null?void 0:t.in).getMonth()}function gRe(e,t){return Wr(e,t==null?void 0:t.in).getFullYear()}function yRe(e,t){return+Wr(e)>+Wr(t)}function bRe(e,t){return+Wr(e)<+Wr(t)}function vRe(e,t,n){const[r,s]=hp(n==null?void 0:n.in,e,t);return r.getFullYear()===s.getFullYear()&&r.getMonth()===s.getMonth()}function xRe(e,t,n){const[r,s]=hp(n==null?void 0:n.in,e,t);return r.getFullYear()===s.getFullYear()}function wRe(e,t){const n=()=>_i(t==null?void 0:t.in,NaN),s=kRe(e);let i;if(s.date){const c=ERe(s.date,2);i=TRe(c.restDateString,c.year)}if(!i||isNaN(+i))return n();const a=+i;let o=0,l;if(s.time&&(o=ARe(s.time),isNaN(o)))return n();if(s.timezone){if(l=RRe(s.timezone),isNaN(l))return n()}else{const c=new Date(a+o),u=Wr(0,t==null?void 0:t.in);return u.setFullYear(c.getUTCFullYear(),c.getUTCMonth(),c.getUTCDate()),u.setHours(c.getUTCHours(),c.getUTCMinutes(),c.getUTCSeconds(),c.getUTCMilliseconds()),u}return Wr(a+o+l,t==null?void 0:t.in)}const sC={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},SRe=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,_Re=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,CRe=/^([+-])(\d{2})(?::?(\d{2}))?$/;function kRe(e){const t={},n=e.split(sC.dateTimeDelimiter);let r;if(n.length>2)return t;if(/:/.test(n[0])?r=n[0]:(t.date=n[0],r=n[1],sC.timeZoneDelimiter.test(t.date)&&(t.date=e.split(sC.timeZoneDelimiter)[0],r=e.substr(t.date.length,e.length))),r){const s=sC.timezone.exec(r);s?(t.time=r.replace(s[1],""),t.timezone=s[1]):t.time=r}return t}function ERe(e,t){const n=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),r=e.match(n);if(!r)return{year:NaN,restDateString:""};const s=r[1]?parseInt(r[1]):null,i=r[2]?parseInt(r[2]):null;return{year:i===null?s:i*100,restDateString:e.slice((r[1]||r[2]).length)}}function TRe(e,t){if(t===null)return new Date(NaN);const n=e.match(SRe);if(!n)return new Date(NaN);const r=!!n[4],s=Yv(n[1]),i=Yv(n[2])-1,a=Yv(n[3]),o=Yv(n[4]),l=Yv(n[5])-1;if(r)return PRe(t,o,l)?NRe(t,o,l):new Date(NaN);{const c=new Date(0);return!MRe(t,i,a)||!jRe(t,s)?new Date(NaN):(c.setUTCFullYear(t,i,Math.max(s,a)),c)}}function Yv(e){return e?parseInt(e):1}function ARe(e){const t=e.match(_Re);if(!t)return NaN;const n=_M(t[1]),r=_M(t[2]),s=_M(t[3]);return ORe(n,r,s)?n*eX+r*QZ+s*1e3:NaN}function _M(e){return e&&parseFloat(e.replace(",","."))||0}function RRe(e){if(e==="Z")return 0;const t=e.match(CRe);if(!t)return 0;const n=t[1]==="+"?-1:1,r=parseInt(t[2]),s=t[3]&&parseInt(t[3])||0;return DRe(r,s)?n*(r*eX+s*QZ):NaN}function NRe(e,t,n){const r=new Date(0);r.setUTCFullYear(e,0,4);const s=r.getUTCDay()||7,i=(t-1)*7+n+1-s;return r.setUTCDate(r.getUTCDate()+i),r}const IRe=[31,null,31,30,31,30,31,31,30,31,30,31];function mX(e){return e%400===0||e%4===0&&e%100!==0}function MRe(e,t,n){return t>=0&&t<=11&&n>=1&&n<=(IRe[t]||(mX(e)?29:28))}function jRe(e,t){return t>=1&&t<=(mX(e)?366:365)}function PRe(e,t,n){return t>=1&&t<=53&&n>=0&&n<=6}function ORe(e,t,n){return e===24?t===0&&n===0:n>=0&&n<60&&t>=0&&t<60&&e>=0&&e<25}function DRe(e,t){return t>=0&&t<=59}function FRe(e,t,n){const r=Wr(e,n==null?void 0:n.in),s=r.getFullYear(),i=r.getDate(),a=_i(e,0);a.setFullYear(s,t,15),a.setHours(0,0,0,0);const o=pRe(a);return r.setMonth(t,Math.min(i,o)),r}function LRe(e,t,n){const r=Wr(e,n==null?void 0:n.in);return isNaN(+r)?_i(e,NaN):(r.setFullYear(t),r)}const Un=({tooltipText:e,icon:t,iconClassName:n,tooltipSide:r="top",onClick:s,disabled:i,variant:a="ghost",size:o="icon",className:l,"aria-label":c,...u})=>{const d=typeof t=="function";return f.jsx(wr,{delayDuration:100,children:f.jsxs(Sr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(ot,{variant:a,size:o,onClick:s,disabled:i,className:Ye("h-6 w-6",l),"aria-label":c??e,...u,children:d?f.jsx(t,{className:Ye("h-3.5 w-3.5",n)}):t})}),f.jsx(Cr,{side:r,children:f.jsx("p",{children:e})})]})})},t7={};function BRe(e){let t=t7[e];if(t)return t;t=t7[e]=[];for(let n=0;n<128;n++){const r=String.fromCharCode(n);t.push(r)}for(let n=0;n<e.length;n++){const r=e.charCodeAt(n);t[r]="%"+("0"+r.toString(16).toUpperCase()).slice(-2)}return t}function My(e,t){typeof t!="string"&&(t=My.defaultChars);const n=BRe(t);return e.replace(/(%[a-f0-9]{2})+/gi,function(r){let s="";for(let i=0,a=r.length;i<a;i+=3){const o=parseInt(r.slice(i+1,i+3),16);if(o<128){s+=n[o];continue}if((o&224)===192&&i+3<a){const l=parseInt(r.slice(i+4,i+6),16);if((l&192)===128){const c=o<<6&1984|l&63;c<128?s+="��":s+=String.fromCharCode(c),i+=3;continue}}if((o&240)===224&&i+6<a){const l=parseInt(r.slice(i+4,i+6),16),c=parseInt(r.slice(i+7,i+9),16);if((l&192)===128&&(c&192)===128){const u=o<<12&61440|l<<6&4032|c&63;u<2048||u>=55296&&u<=57343?s+="���":s+=String.fromCharCode(u),i+=6;continue}}if((o&248)===240&&i+9<a){const l=parseInt(r.slice(i+4,i+6),16),c=parseInt(r.slice(i+7,i+9),16),u=parseInt(r.slice(i+10,i+12),16);if((l&192)===128&&(c&192)===128&&(u&192)===128){let d=o<<18&1835008|l<<12&258048|c<<6&4032|u&63;d<65536||d>1114111?s+="����":(d-=65536,s+=String.fromCharCode(55296+(d>>10),56320+(d&1023))),i+=9;continue}}s+="�"}return s})}My.defaultChars=";/?:@&=+$,#";My.componentChars="";const n7={};function $Re(e){let t=n7[e];if(t)return t;t=n7[e]=[];for(let n=0;n<128;n++){const r=String.fromCharCode(n);/^[0-9a-z]$/i.test(r)?t.push(r):t.push("%"+("0"+n.toString(16).toUpperCase()).slice(-2))}for(let n=0;n<e.length;n++)t[e.charCodeAt(n)]=e[n];return t}function rS(e,t,n){typeof t!="string"&&(n=t,t=rS.defaultChars),typeof n>"u"&&(n=!0);const r=$Re(t);let s="";for(let i=0,a=e.length;i<a;i++){const o=e.charCodeAt(i);if(n&&o===37&&i+2<a&&/^[0-9a-f]{2}$/i.test(e.slice(i+1,i+3))){s+=e.slice(i,i+3),i+=2;continue}if(o<128){s+=r[o];continue}if(o>=55296&&o<=57343){if(o>=55296&&o<=56319&&i+1<a){const l=e.charCodeAt(i+1);if(l>=56320&&l<=57343){s+=encodeURIComponent(e[i]+e[i+1]),i++;continue}}s+="%EF%BF%BD";continue}s+=encodeURIComponent(e[i])}return s}rS.defaultChars=";/?:@&=+$,-_.!~*'()#";rS.componentChars="-_.!~*'()";function MD(e){let t="";return t+=e.protocol||"",t+=e.slashes?"//":"",t+=e.auth?e.auth+"@":"",e.hostname&&e.hostname.indexOf(":")!==-1?t+="["+e.hostname+"]":t+=e.hostname||"",t+=e.port?":"+e.port:"",t+=e.pathname||"",t+=e.search||"",t+=e.hash||"",t}function yk(){this.protocol=null,this.slashes=null,this.auth=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.pathname=null}const zRe=/^([a-z0-9.+-]+:)/i,URe=/:[0-9]*$/,qRe=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,VRe=["<",">",'"',"`"," ","\r",`
`,"	"],WRe=["{","}","|","\\","^","`"].concat(VRe),HRe=["'"].concat(WRe),r7=["%","/","?",";","#"].concat(HRe),s7=["/","?","#"],GRe=255,i7=/^[+a-z0-9A-Z_-]{0,63}$/,KRe=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,a7={javascript:!0,"javascript:":!0},o7={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0};function jD(e,t){if(e&&e instanceof yk)return e;const n=new yk;return n.parse(e,t),n}yk.prototype.parse=function(e,t){let n,r,s,i=e;if(i=i.trim(),!t&&e.split("#").length===1){const c=qRe.exec(i);if(c)return this.pathname=c[1],c[2]&&(this.search=c[2]),this}let a=zRe.exec(i);if(a&&(a=a[0],n=a.toLowerCase(),this.protocol=a,i=i.substr(a.length)),(t||a||i.match(/^\/\/[^@\/]+@[^@\/]+/))&&(s=i.substr(0,2)==="//",s&&!(a&&a7[a])&&(i=i.substr(2),this.slashes=!0)),!a7[a]&&(s||a&&!o7[a])){let c=-1;for(let y=0;y<s7.length;y++)r=i.indexOf(s7[y]),r!==-1&&(c===-1||r<c)&&(c=r);let u,d;c===-1?d=i.lastIndexOf("@"):d=i.lastIndexOf("@",c),d!==-1&&(u=i.slice(0,d),i=i.slice(d+1),this.auth=u),c=-1;for(let y=0;y<r7.length;y++)r=i.indexOf(r7[y]),r!==-1&&(c===-1||r<c)&&(c=r);c===-1&&(c=i.length),i[c-1]===":"&&c--;const h=i.slice(0,c);i=i.slice(c),this.parseHost(h),this.hostname=this.hostname||"";const m=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!m){const y=this.hostname.split(/\./);for(let b=0,v=y.length;b<v;b++){const x=y[b];if(x&&!x.match(i7)){let w="";for(let _=0,k=x.length;_<k;_++)x.charCodeAt(_)>127?w+="x":w+=x[_];if(!w.match(i7)){const _=y.slice(0,b),k=y.slice(b+1),C=x.match(KRe);C&&(_.push(C[1]),k.unshift(C[2])),k.length&&(i=k.join(".")+i),this.hostname=_.join(".");break}}}}this.hostname.length>GRe&&(this.hostname=""),m&&(this.hostname=this.hostname.substr(1,this.hostname.length-2))}const o=i.indexOf("#");o!==-1&&(this.hash=i.substr(o),i=i.slice(0,o));const l=i.indexOf("?");return l!==-1&&(this.search=i.substr(l),i=i.slice(0,l)),i&&(this.pathname=i),o7[n]&&this.hostname&&!this.pathname&&(this.pathname=""),this};yk.prototype.parseHost=function(e){let t=URe.exec(e);t&&(t=t[0],t!==":"&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)};const YRe=Object.freeze(Object.defineProperty({__proto__:null,decode:My,encode:rS,format:MD,parse:jD},Symbol.toStringTag,{value:"Module"})),gX=/[\0-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,yX=/[\0-\x1F\x7F-\x9F]/,ZRe=/[\xAD\u0600-\u0605\u061C\u06DD\u070F\u0890\u0891\u08E2\u180E\u200B-\u200F\u202A-\u202E\u2060-\u2064\u2066-\u206F\uFEFF\uFFF9-\uFFFB]|\uD804[\uDCBD\uDCCD]|\uD80D[\uDC30-\uDC3F]|\uD82F[\uDCA0-\uDCA3]|\uD834[\uDD73-\uDD7A]|\uDB40[\uDC01\uDC20-\uDC7F]/,PD=/[!-#%-\*,-\/:;\?@\[-\]_\{\}\xA1\xA7\xAB\xB6\xB7\xBB\xBF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061D-\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C77\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1B7D\u1B7E\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4F\u2E52-\u2E5D\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]|\uD800[\uDD00-\uDD02\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD803[\uDEAD\uDF55-\uDF59\uDF86-\uDF89]|\uD804[\uDC47-\uDC4D\uDCBB\uDCBC\uDCBE-\uDCC1\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC8\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9]|\uD805[\uDC4B-\uDC4F\uDC5A\uDC5B\uDC5D\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDE60-\uDE6C\uDEB9\uDF3C-\uDF3E]|\uD806[\uDC3B\uDD44-\uDD46\uDDE2\uDE3F-\uDE46\uDE9A-\uDE9C\uDE9E-\uDEA2\uDF00-\uDF09]|\uD807[\uDC41-\uDC45\uDC70\uDC71\uDEF7\uDEF8\uDF43-\uDF4F\uDFFF]|\uD809[\uDC70-\uDC74]|\uD80B[\uDFF1\uDFF2]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3B\uDF44]|\uD81B[\uDE97-\uDE9A\uDFE2]|\uD82F\uDC9F|\uD836[\uDE87-\uDE8B]|\uD83A[\uDD5E\uDD5F]/,bX=/[\$\+<->\^`\|~\xA2-\xA6\xA8\xA9\xAC\xAE-\xB1\xB4\xB8\xD7\xF7\u02C2-\u02C5\u02D2-\u02DF\u02E5-\u02EB\u02ED\u02EF-\u02FF\u0375\u0384\u0385\u03F6\u0482\u058D-\u058F\u0606-\u0608\u060B\u060E\u060F\u06DE\u06E9\u06FD\u06FE\u07F6\u07FE\u07FF\u0888\u09F2\u09F3\u09FA\u09FB\u0AF1\u0B70\u0BF3-\u0BFA\u0C7F\u0D4F\u0D79\u0E3F\u0F01-\u0F03\u0F13\u0F15-\u0F17\u0F1A-\u0F1F\u0F34\u0F36\u0F38\u0FBE-\u0FC5\u0FC7-\u0FCC\u0FCE\u0FCF\u0FD5-\u0FD8\u109E\u109F\u1390-\u1399\u166D\u17DB\u1940\u19DE-\u19FF\u1B61-\u1B6A\u1B74-\u1B7C\u1FBD\u1FBF-\u1FC1\u1FCD-\u1FCF\u1FDD-\u1FDF\u1FED-\u1FEF\u1FFD\u1FFE\u2044\u2052\u207A-\u207C\u208A-\u208C\u20A0-\u20C0\u2100\u2101\u2103-\u2106\u2108\u2109\u2114\u2116-\u2118\u211E-\u2123\u2125\u2127\u2129\u212E\u213A\u213B\u2140-\u2144\u214A-\u214D\u214F\u218A\u218B\u2190-\u2307\u230C-\u2328\u232B-\u2426\u2440-\u244A\u249C-\u24E9\u2500-\u2767\u2794-\u27C4\u27C7-\u27E5\u27F0-\u2982\u2999-\u29D7\u29DC-\u29FB\u29FE-\u2B73\u2B76-\u2B95\u2B97-\u2BFF\u2CE5-\u2CEA\u2E50\u2E51\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u2FFF\u3004\u3012\u3013\u3020\u3036\u3037\u303E\u303F\u309B\u309C\u3190\u3191\u3196-\u319F\u31C0-\u31E3\u31EF\u3200-\u321E\u322A-\u3247\u3250\u3260-\u327F\u328A-\u32B0\u32C0-\u33FF\u4DC0-\u4DFF\uA490-\uA4C6\uA700-\uA716\uA720\uA721\uA789\uA78A\uA828-\uA82B\uA836-\uA839\uAA77-\uAA79\uAB5B\uAB6A\uAB6B\uFB29\uFBB2-\uFBC2\uFD40-\uFD4F\uFDCF\uFDFC-\uFDFF\uFE62\uFE64-\uFE66\uFE69\uFF04\uFF0B\uFF1C-\uFF1E\uFF3E\uFF40\uFF5C\uFF5E\uFFE0-\uFFE6\uFFE8-\uFFEE\uFFFC\uFFFD]|\uD800[\uDD37-\uDD3F\uDD79-\uDD89\uDD8C-\uDD8E\uDD90-\uDD9C\uDDA0\uDDD0-\uDDFC]|\uD802[\uDC77\uDC78\uDEC8]|\uD805\uDF3F|\uD807[\uDFD5-\uDFF1]|\uD81A[\uDF3C-\uDF3F\uDF45]|\uD82F\uDC9C|\uD833[\uDF50-\uDFC3]|\uD834[\uDC00-\uDCF5\uDD00-\uDD26\uDD29-\uDD64\uDD6A-\uDD6C\uDD83\uDD84\uDD8C-\uDDA9\uDDAE-\uDDEA\uDE00-\uDE41\uDE45\uDF00-\uDF56]|\uD835[\uDEC1\uDEDB\uDEFB\uDF15\uDF35\uDF4F\uDF6F\uDF89\uDFA9\uDFC3]|\uD836[\uDC00-\uDDFF\uDE37-\uDE3A\uDE6D-\uDE74\uDE76-\uDE83\uDE85\uDE86]|\uD838[\uDD4F\uDEFF]|\uD83B[\uDCAC\uDCB0\uDD2E\uDEF0\uDEF1]|\uD83C[\uDC00-\uDC2B\uDC30-\uDC93\uDCA0-\uDCAE\uDCB1-\uDCBF\uDCC1-\uDCCF\uDCD1-\uDCF5\uDD0D-\uDDAD\uDDE6-\uDE02\uDE10-\uDE3B\uDE40-\uDE48\uDE50\uDE51\uDE60-\uDE65\uDF00-\uDFFF]|\uD83D[\uDC00-\uDED7\uDEDC-\uDEEC\uDEF0-\uDEFC\uDF00-\uDF76\uDF7B-\uDFD9\uDFE0-\uDFEB\uDFF0]|\uD83E[\uDC00-\uDC0B\uDC10-\uDC47\uDC50-\uDC59\uDC60-\uDC87\uDC90-\uDCAD\uDCB0\uDCB1\uDD00-\uDE53\uDE60-\uDE6D\uDE70-\uDE7C\uDE80-\uDE88\uDE90-\uDEBD\uDEBF-\uDEC5\uDECE-\uDEDB\uDEE0-\uDEE8\uDEF0-\uDEF8\uDF00-\uDF92\uDF94-\uDFCA]/,vX=/[ \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000]/,XRe=Object.freeze(Object.defineProperty({__proto__:null,Any:gX,Cc:yX,Cf:ZRe,P:PD,S:bX,Z:vX},Symbol.toStringTag,{value:"Module"})),JRe=new Uint16Array('ᵁ<Õıʊҝջאٵ۞ޢߖࠏ੊ઑඡ๭༉༦჊ረዡᐕᒝᓃᓟᔥ\0\0\0\0\0\0ᕫᛍᦍᰒᷝ὾⁠↰⊍⏀⏻⑂⠤⤒ⴈ⹈⿎〖㊺㘹㞬㣾㨨㩱㫠㬮ࠀEMabcfglmnoprstu\\bfms¦³¹ÈÏlig耻Æ䃆P耻&䀦cute耻Á䃁reve;䄂Āiyx}rc耻Â䃂;䐐r;쀀𝔄rave耻À䃀pha;䎑acr;䄀d;橓Āgp¡on;䄄f;쀀𝔸plyFunction;恡ing耻Å䃅Ācs¾Ãr;쀀𝒜ign;扔ilde耻Ã䃃ml耻Ä䃄ЀaceforsuåûþėĜĢħĪĀcrêòkslash;或Ŷöø;櫧ed;挆y;䐑ƀcrtąċĔause;戵noullis;愬a;䎒r;쀀𝔅pf;쀀𝔹eve;䋘còēmpeq;扎܀HOacdefhilorsuōőŖƀƞƢƵƷƺǜȕɳɸɾcy;䐧PY耻©䂩ƀcpyŝŢźute;䄆Ā;iŧŨ拒talDifferentialD;慅leys;愭ȀaeioƉƎƔƘron;䄌dil耻Ç䃇rc;䄈nint;戰ot;䄊ĀdnƧƭilla;䂸terDot;䂷òſi;䎧rcleȀDMPTǇǋǑǖot;抙inus;抖lus;投imes;抗oĀcsǢǸkwiseContourIntegral;戲eCurlyĀDQȃȏoubleQuote;思uote;怙ȀlnpuȞȨɇɕonĀ;eȥȦ户;橴ƀgitȯȶȺruent;扡nt;戯ourIntegral;戮ĀfrɌɎ;愂oduct;成nterClockwiseContourIntegral;戳oss;樯cr;쀀𝒞pĀ;Cʄʅ拓ap;才րDJSZacefiosʠʬʰʴʸˋ˗ˡ˦̳ҍĀ;oŹʥtrahd;椑cy;䐂cy;䐅cy;䐏ƀgrsʿ˄ˇger;怡r;憡hv;櫤Āayː˕ron;䄎;䐔lĀ;t˝˞戇a;䎔r;쀀𝔇Āaf˫̧Ācm˰̢riticalȀADGT̖̜̀̆cute;䂴oŴ̋̍;䋙bleAcute;䋝rave;䁠ilde;䋜ond;拄ferentialD;慆Ѱ̽\0\0\0͔͂\0Ѕf;쀀𝔻ƀ;DE͈͉͍䂨ot;惜qual;扐blèCDLRUVͣͲ΂ϏϢϸontourIntegraìȹoɴ͹\0\0ͻ»͉nArrow;懓Āeo·ΤftƀARTΐΖΡrrow;懐ightArrow;懔eåˊngĀLRΫτeftĀARγιrrow;柸ightArrow;柺ightArrow;柹ightĀATϘϞrrow;懒ee;抨pɁϩ\0\0ϯrrow;懑ownArrow;懕erticalBar;戥ǹABLRTaВЪаўѿͼrrowƀ;BUНОТ憓ar;椓pArrow;懵reve;䌑eft˒к\0ц\0ѐightVector;楐eeVector;楞ectorĀ;Bљњ憽ar;楖ightǔѧ\0ѱeeVector;楟ectorĀ;BѺѻ懁ar;楗eeĀ;A҆҇护rrow;憧ĀctҒҗr;쀀𝒟rok;䄐ࠀNTacdfglmopqstuxҽӀӄӋӞӢӧӮӵԡԯԶՒ՝ՠեG;䅊H耻Ð䃐cute耻É䃉ƀaiyӒӗӜron;䄚rc耻Ê䃊;䐭ot;䄖r;쀀𝔈rave耻È䃈ement;戈ĀapӺӾcr;䄒tyɓԆ\0\0ԒmallSquare;旻erySmallSquare;斫ĀgpԦԪon;䄘f;쀀𝔼silon;䎕uĀaiԼՉlĀ;TՂՃ橵ilde;扂librium;懌Āci՗՚r;愰m;橳a;䎗ml耻Ë䃋Āipժկsts;戃onentialE;慇ʀcfiosօֈ֍ֲ׌y;䐤r;쀀𝔉lledɓ֗\0\0֣mallSquare;旼erySmallSquare;斪Ͱֺ\0ֿ\0\0ׄf;쀀𝔽All;戀riertrf;愱cò׋؀JTabcdfgorstר׬ׯ׺؀ؒؖ؛؝أ٬ٲcy;䐃耻>䀾mmaĀ;d׷׸䎓;䏜reve;䄞ƀeiy؇،ؐdil;䄢rc;䄜;䐓ot;䄠r;쀀𝔊;拙pf;쀀𝔾eater̀EFGLSTصلَٖٛ٦qualĀ;Lؾؿ扥ess;招ullEqual;执reater;檢ess;扷lantEqual;橾ilde;扳cr;쀀𝒢;扫ЀAacfiosuڅڋږڛڞڪھۊRDcy;䐪Āctڐڔek;䋇;䁞irc;䄤r;愌lbertSpace;愋ǰگ\0ڲf;愍izontalLine;攀Āctۃۅòکrok;䄦mpńېۘownHumðįqual;扏܀EJOacdfgmnostuۺ۾܃܇܎ܚܞܡܨ݄ݸދޏޕcy;䐕lig;䄲cy;䐁cute耻Í䃍Āiyܓܘrc耻Î䃎;䐘ot;䄰r;愑rave耻Ì䃌ƀ;apܠܯܿĀcgܴܷr;䄪inaryI;慈lieóϝǴ݉\0ݢĀ;eݍݎ戬Āgrݓݘral;戫section;拂isibleĀCTݬݲomma;恣imes;恢ƀgptݿރވon;䄮f;쀀𝕀a;䎙cr;愐ilde;䄨ǫޚ\0ޞcy;䐆l耻Ï䃏ʀcfosuެ޷޼߂ߐĀiyޱ޵rc;䄴;䐙r;쀀𝔍pf;쀀𝕁ǣ߇\0ߌr;쀀𝒥rcy;䐈kcy;䐄΀HJacfosߤߨ߽߬߱ࠂࠈcy;䐥cy;䐌ppa;䎚Āey߶߻dil;䄶;䐚r;쀀𝔎pf;쀀𝕂cr;쀀𝒦րJTaceflmostࠥࠩࠬࡐࡣ঳সে্਷ੇcy;䐉耻<䀼ʀcmnpr࠷࠼ࡁࡄࡍute;䄹bda;䎛g;柪lacetrf;愒r;憞ƀaeyࡗ࡜ࡡron;䄽dil;䄻;䐛Āfsࡨ॰tԀACDFRTUVarࡾࢩࢱࣦ࣠ࣼयज़ΐ४Ānrࢃ࢏gleBracket;柨rowƀ;BR࢙࢚࢞憐ar;懤ightArrow;懆eiling;挈oǵࢷ\0ࣃbleBracket;柦nǔࣈ\0࣒eeVector;楡ectorĀ;Bࣛࣜ懃ar;楙loor;挊ightĀAV࣯ࣵrrow;憔ector;楎Āerँगeƀ;AVउऊऐ抣rrow;憤ector;楚iangleƀ;BEतथऩ抲ar;槏qual;抴pƀDTVषूौownVector;楑eeVector;楠ectorĀ;Bॖॗ憿ar;楘ectorĀ;B॥०憼ar;楒ightáΜs̀EFGLSTॾঋকঝঢভqualGreater;拚ullEqual;扦reater;扶ess;檡lantEqual;橽ilde;扲r;쀀𝔏Ā;eঽা拘ftarrow;懚idot;䄿ƀnpw৔ਖਛgȀLRlr৞৷ਂਐeftĀAR০৬rrow;柵ightArrow;柷ightArrow;柶eftĀarγਊightáοightáϊf;쀀𝕃erĀLRਢਬeftArrow;憙ightArrow;憘ƀchtਾੀੂòࡌ;憰rok;䅁;扪Ѐacefiosuਗ਼੝੠੷੼અઋ઎p;椅y;䐜Ādl੥੯iumSpace;恟lintrf;愳r;쀀𝔐nusPlus;戓pf;쀀𝕄cò੶;䎜ҀJacefostuણધભીଔଙඑ඗ඞcy;䐊cute;䅃ƀaey઴હાron;䅇dil;䅅;䐝ƀgswે૰଎ativeƀMTV૓૟૨ediumSpace;怋hiĀcn૦૘ë૙eryThiî૙tedĀGL૸ଆreaterGreateòٳessLesóੈLine;䀊r;쀀𝔑ȀBnptଢନଷ଺reak;恠BreakingSpace;䂠f;愕ڀ;CDEGHLNPRSTV୕ୖ୪୼஡௫ఄ౞಄ದ೘ൡඅ櫬Āou୛୤ngruent;扢pCap;扭oubleVerticalBar;戦ƀlqxஃஊ஛ement;戉ualĀ;Tஒஓ扠ilde;쀀≂̸ists;戄reater΀;EFGLSTஶஷ஽௉௓௘௥扯qual;扱ullEqual;쀀≧̸reater;쀀≫̸ess;批lantEqual;쀀⩾̸ilde;扵umpń௲௽ownHump;쀀≎̸qual;쀀≏̸eĀfsఊధtTriangleƀ;BEచఛడ拪ar;쀀⧏̸qual;括s̀;EGLSTవశ఼ౄోౘ扮qual;扰reater;扸ess;쀀≪̸lantEqual;쀀⩽̸ilde;扴estedĀGL౨౹reaterGreater;쀀⪢̸essLess;쀀⪡̸recedesƀ;ESಒಓಛ技qual;쀀⪯̸lantEqual;拠ĀeiಫಹverseElement;戌ghtTriangleƀ;BEೋೌ೒拫ar;쀀⧐̸qual;拭ĀquೝഌuareSuĀbp೨೹setĀ;E೰ೳ쀀⊏̸qual;拢ersetĀ;Eഃആ쀀⊐̸qual;拣ƀbcpഓതൎsetĀ;Eഛഞ쀀⊂⃒qual;抈ceedsȀ;ESTലള഻െ抁qual;쀀⪰̸lantEqual;拡ilde;쀀≿̸ersetĀ;E൘൛쀀⊃⃒qual;抉ildeȀ;EFT൮൯൵ൿ扁qual;扄ullEqual;扇ilde;扉erticalBar;戤cr;쀀𝒩ilde耻Ñ䃑;䎝܀Eacdfgmoprstuvලෂ෉෕ෛ෠෧෼ขภยา฿ไlig;䅒cute耻Ó䃓Āiy෎ීrc耻Ô䃔;䐞blac;䅐r;쀀𝔒rave耻Ò䃒ƀaei෮ෲ෶cr;䅌ga;䎩cron;䎟pf;쀀𝕆enCurlyĀDQฎบoubleQuote;怜uote;怘;橔Āclวฬr;쀀𝒪ash耻Ø䃘iŬื฼de耻Õ䃕es;樷ml耻Ö䃖erĀBP๋๠Āar๐๓r;怾acĀek๚๜;揞et;掴arenthesis;揜Ҁacfhilors๿ງຊຏຒດຝະ໼rtialD;戂y;䐟r;쀀𝔓i;䎦;䎠usMinus;䂱Āipຢອncareplanåڝf;愙Ȁ;eio຺ູ໠໤檻cedesȀ;EST່້໏໚扺qual;檯lantEqual;扼ilde;找me;怳Ādp໩໮uct;戏ortionĀ;aȥ໹l;戝Āci༁༆r;쀀𝒫;䎨ȀUfos༑༖༛༟OT耻"䀢r;쀀𝔔pf;愚cr;쀀𝒬؀BEacefhiorsu༾གྷཇའཱིྦྷྪྭ႖ႩႴႾarr;椐G耻®䂮ƀcnrཎནབute;䅔g;柫rĀ;tཛྷཝ憠l;椖ƀaeyཧཬཱron;䅘dil;䅖;䐠Ā;vླྀཹ愜erseĀEUྂྙĀlq྇ྎement;戋uilibrium;懋pEquilibrium;楯r»ཹo;䎡ghtЀACDFTUVa࿁࿫࿳ဢဨၛႇϘĀnr࿆࿒gleBracket;柩rowƀ;BL࿜࿝࿡憒ar;懥eftArrow;懄eiling;按oǵ࿹\0စbleBracket;柧nǔည\0နeeVector;楝ectorĀ;Bဝသ懂ar;楕loor;挋Āerိ၃eƀ;AVဵံြ抢rrow;憦ector;楛iangleƀ;BEၐၑၕ抳ar;槐qual;抵pƀDTVၣၮၸownVector;楏eeVector;楜ectorĀ;Bႂႃ憾ar;楔ectorĀ;B႑႒懀ar;楓Āpuႛ႞f;愝ndImplies;楰ightarrow;懛ĀchႹႼr;愛;憱leDelayed;槴ڀHOacfhimoqstuფჱჷჽᄙᄞᅑᅖᅡᅧᆵᆻᆿĀCcჩხHcy;䐩y;䐨FTcy;䐬cute;䅚ʀ;aeiyᄈᄉᄎᄓᄗ檼ron;䅠dil;䅞rc;䅜;䐡r;쀀𝔖ortȀDLRUᄪᄴᄾᅉownArrow»ОeftArrow»࢚ightArrow»࿝pArrow;憑gma;䎣allCircle;战pf;쀀𝕊ɲᅭ\0\0ᅰt;戚areȀ;ISUᅻᅼᆉᆯ斡ntersection;抓uĀbpᆏᆞsetĀ;Eᆗᆘ抏qual;抑ersetĀ;Eᆨᆩ抐qual;抒nion;抔cr;쀀𝒮ar;拆ȀbcmpᇈᇛሉላĀ;sᇍᇎ拐etĀ;Eᇍᇕqual;抆ĀchᇠህeedsȀ;ESTᇭᇮᇴᇿ扻qual;檰lantEqual;扽ilde;承Tháྌ;我ƀ;esሒሓሣ拑rsetĀ;Eሜም抃qual;抇et»ሓրHRSacfhiorsሾቄ቉ቕ቞ቱቶኟዂወዑORN耻Þ䃞ADE;愢ĀHc቎ቒcy;䐋y;䐦Ābuቚቜ;䀉;䎤ƀaeyብቪቯron;䅤dil;䅢;䐢r;쀀𝔗Āeiቻ኉ǲኀ\0ኇefore;戴a;䎘Ācn኎ኘkSpace;쀀  Space;怉ldeȀ;EFTካኬኲኼ戼qual;扃ullEqual;扅ilde;扈pf;쀀𝕋ipleDot;惛Āctዖዛr;쀀𝒯rok;䅦ૡዷጎጚጦ\0ጬጱ\0\0\0\0\0ጸጽ፷ᎅ\0᏿ᐄᐊᐐĀcrዻጁute耻Ú䃚rĀ;oጇገ憟cir;楉rǣጓ\0጖y;䐎ve;䅬Āiyጞጣrc耻Û䃛;䐣blac;䅰r;쀀𝔘rave耻Ù䃙acr;䅪Ādiፁ፩erĀBPፈ፝Āarፍፐr;䁟acĀekፗፙ;揟et;掵arenthesis;揝onĀ;P፰፱拃lus;抎Āgp፻፿on;䅲f;쀀𝕌ЀADETadps᎕ᎮᎸᏄϨᏒᏗᏳrrowƀ;BDᅐᎠᎤar;椒ownArrow;懅ownArrow;憕quilibrium;楮eeĀ;AᏋᏌ报rrow;憥ownáϳerĀLRᏞᏨeftArrow;憖ightArrow;憗iĀ;lᏹᏺ䏒on;䎥ing;䅮cr;쀀𝒰ilde;䅨ml耻Ü䃜ҀDbcdefosvᐧᐬᐰᐳᐾᒅᒊᒐᒖash;披ar;櫫y;䐒ashĀ;lᐻᐼ抩;櫦Āerᑃᑅ;拁ƀbtyᑌᑐᑺar;怖Ā;iᑏᑕcalȀBLSTᑡᑥᑪᑴar;戣ine;䁼eparator;杘ilde;所ThinSpace;怊r;쀀𝔙pf;쀀𝕍cr;쀀𝒱dash;抪ʀcefosᒧᒬᒱᒶᒼirc;䅴dge;拀r;쀀𝔚pf;쀀𝕎cr;쀀𝒲Ȁfiosᓋᓐᓒᓘr;쀀𝔛;䎞pf;쀀𝕏cr;쀀𝒳ҀAIUacfosuᓱᓵᓹᓽᔄᔏᔔᔚᔠcy;䐯cy;䐇cy;䐮cute耻Ý䃝Āiyᔉᔍrc;䅶;䐫r;쀀𝔜pf;쀀𝕐cr;쀀𝒴ml;䅸ЀHacdefosᔵᔹᔿᕋᕏᕝᕠᕤcy;䐖cute;䅹Āayᕄᕉron;䅽;䐗ot;䅻ǲᕔ\0ᕛoWidtè૙a;䎖r;愨pf;愤cr;쀀𝒵௡ᖃᖊᖐ\0ᖰᖶᖿ\0\0\0\0ᗆᗛᗫᙟ᙭\0ᚕ᚛ᚲᚹ\0ᚾcute耻á䃡reve;䄃̀;Ediuyᖜᖝᖡᖣᖨᖭ戾;쀀∾̳;房rc耻â䃢te肻´̆;䐰lig耻æ䃦Ā;r²ᖺ;쀀𝔞rave耻à䃠ĀepᗊᗖĀfpᗏᗔsym;愵èᗓha;䎱ĀapᗟcĀclᗤᗧr;䄁g;樿ɤᗰ\0\0ᘊʀ;adsvᗺᗻᗿᘁᘇ戧nd;橕;橜lope;橘;橚΀;elmrszᘘᘙᘛᘞᘿᙏᙙ戠;榤e»ᘙsdĀ;aᘥᘦ戡ѡᘰᘲᘴᘶᘸᘺᘼᘾ;榨;榩;榪;榫;榬;榭;榮;榯tĀ;vᙅᙆ戟bĀ;dᙌᙍ抾;榝Āptᙔᙗh;戢»¹arr;捼Āgpᙣᙧon;䄅f;쀀𝕒΀;Eaeiop዁ᙻᙽᚂᚄᚇᚊ;橰cir;橯;扊d;手s;䀧roxĀ;e዁ᚒñᚃing耻å䃥ƀctyᚡᚦᚨr;쀀𝒶;䀪mpĀ;e዁ᚯñʈilde耻ã䃣ml耻ä䃤Āciᛂᛈoninôɲnt;樑ࠀNabcdefiklnoprsu᛭ᛱᜰ᜼ᝃᝈ᝸᝽០៦ᠹᡐᜍ᤽᥈ᥰot;櫭Ācrᛶ᜞kȀcepsᜀᜅᜍᜓong;扌psilon;䏶rime;怵imĀ;e᜚᜛戽q;拍Ŷᜢᜦee;抽edĀ;gᜬᜭ挅e»ᜭrkĀ;t፜᜷brk;掶Āoyᜁᝁ;䐱quo;怞ʀcmprtᝓ᝛ᝡᝤᝨausĀ;eĊĉptyv;榰séᜌnoõēƀahwᝯ᝱ᝳ;䎲;愶een;扬r;쀀𝔟g΀costuvwឍឝឳេ៕៛៞ƀaiuបពរðݠrc;旯p»፱ƀdptឤឨឭot;樀lus;樁imes;樂ɱឹ\0\0ើcup;樆ar;昅riangleĀdu៍្own;施p;斳plus;樄eåᑄåᒭarow;植ƀako៭ᠦᠵĀcn៲ᠣkƀlst៺֫᠂ozenge;槫riangleȀ;dlr᠒᠓᠘᠝斴own;斾eft;旂ight;斸k;搣Ʊᠫ\0ᠳƲᠯ\0ᠱ;斒;斑4;斓ck;斈ĀeoᠾᡍĀ;qᡃᡆ쀀=⃥uiv;쀀≡⃥t;挐Ȁptwxᡙᡞᡧᡬf;쀀𝕓Ā;tᏋᡣom»Ꮜtie;拈؀DHUVbdhmptuvᢅᢖᢪᢻᣗᣛᣬ᣿ᤅᤊᤐᤡȀLRlrᢎᢐᢒᢔ;敗;敔;敖;敓ʀ;DUduᢡᢢᢤᢦᢨ敐;敦;敩;敤;敧ȀLRlrᢳᢵᢷᢹ;敝;敚;敜;教΀;HLRhlrᣊᣋᣍᣏᣑᣓᣕ救;敬;散;敠;敫;敢;敟ox;槉ȀLRlrᣤᣦᣨᣪ;敕;敒;攐;攌ʀ;DUduڽ᣷᣹᣻᣽;敥;敨;攬;攴inus;抟lus;択imes;抠ȀLRlrᤙᤛᤝ᤟;敛;敘;攘;攔΀;HLRhlrᤰᤱᤳᤵᤷ᤻᤹攂;敪;敡;敞;攼;攤;攜Āevģ᥂bar耻¦䂦Ȁceioᥑᥖᥚᥠr;쀀𝒷mi;恏mĀ;e᜚᜜lƀ;bhᥨᥩᥫ䁜;槅sub;柈Ŭᥴ᥾lĀ;e᥹᥺怢t»᥺pƀ;Eeįᦅᦇ;檮Ā;qۜۛೡᦧ\0᧨ᨑᨕᨲ\0ᨷᩐ\0\0᪴\0\0᫁\0\0ᬡᬮ᭍᭒\0᯽\0ᰌƀcpr᦭ᦲ᧝ute;䄇̀;abcdsᦿᧀᧄ᧊᧕᧙戩nd;橄rcup;橉Āau᧏᧒p;橋p;橇ot;橀;쀀∩︀Āeo᧢᧥t;恁îړȀaeiu᧰᧻ᨁᨅǰ᧵\0᧸s;橍on;䄍dil耻ç䃧rc;䄉psĀ;sᨌᨍ橌m;橐ot;䄋ƀdmnᨛᨠᨦil肻¸ƭptyv;榲t脀¢;eᨭᨮ䂢räƲr;쀀𝔠ƀceiᨽᩀᩍy;䑇ckĀ;mᩇᩈ朓ark»ᩈ;䏇r΀;Ecefms᩟᩠ᩢᩫ᪤᪪᪮旋;槃ƀ;elᩩᩪᩭ䋆q;扗eɡᩴ\0\0᪈rrowĀlr᩼᪁eft;憺ight;憻ʀRSacd᪒᪔᪖᪚᪟»ཇ;擈st;抛irc;抚ash;抝nint;樐id;櫯cir;槂ubsĀ;u᪻᪼晣it»᪼ˬ᫇᫔᫺\0ᬊonĀ;eᫍᫎ䀺Ā;qÇÆɭ᫙\0\0᫢aĀ;t᫞᫟䀬;䁀ƀ;fl᫨᫩᫫戁îᅠeĀmx᫱᫶ent»᫩eóɍǧ᫾\0ᬇĀ;dኻᬂot;橭nôɆƀfryᬐᬔᬗ;쀀𝕔oäɔ脀©;sŕᬝr;愗Āaoᬥᬩrr;憵ss;朗Ācuᬲᬷr;쀀𝒸Ābpᬼ᭄Ā;eᭁᭂ櫏;櫑Ā;eᭉᭊ櫐;櫒dot;拯΀delprvw᭠᭬᭷ᮂᮬᯔ᯹arrĀlr᭨᭪;椸;椵ɰ᭲\0\0᭵r;拞c;拟arrĀ;p᭿ᮀ憶;椽̀;bcdosᮏᮐᮖᮡᮥᮨ截rcap;橈Āauᮛᮞp;橆p;橊ot;抍r;橅;쀀∪︀Ȁalrv᮵ᮿᯞᯣrrĀ;mᮼᮽ憷;椼yƀevwᯇᯔᯘqɰᯎ\0\0ᯒreã᭳uã᭵ee;拎edge;拏en耻¤䂤earrowĀlrᯮ᯳eft»ᮀight»ᮽeäᯝĀciᰁᰇoninôǷnt;戱lcty;挭ঀAHabcdefhijlorstuwz᰸᰻᰿ᱝᱩᱵᲊᲞᲬᲷ᳻᳿ᴍᵻᶑᶫᶻ᷆᷍rò΁ar;楥Ȁglrs᱈ᱍ᱒᱔ger;怠eth;愸òᄳhĀ;vᱚᱛ怐»ऊūᱡᱧarow;椏aã̕Āayᱮᱳron;䄏;䐴ƀ;ao̲ᱼᲄĀgrʿᲁr;懊tseq;橷ƀglmᲑᲔᲘ耻°䂰ta;䎴ptyv;榱ĀirᲣᲨsht;楿;쀀𝔡arĀlrᲳᲵ»ࣜ»သʀaegsv᳂͸᳖᳜᳠mƀ;oș᳊᳔ndĀ;ș᳑uit;晦amma;䏝in;拲ƀ;io᳧᳨᳸䃷de脀÷;o᳧ᳰntimes;拇nø᳷cy;䑒cɯᴆ\0\0ᴊrn;挞op;挍ʀlptuwᴘᴝᴢᵉᵕlar;䀤f;쀀𝕕ʀ;emps̋ᴭᴷᴽᵂqĀ;d͒ᴳot;扑inus;戸lus;戔quare;抡blebarwedgåúnƀadhᄮᵝᵧownarrowóᲃarpoonĀlrᵲᵶefôᲴighôᲶŢᵿᶅkaro÷གɯᶊ\0\0ᶎrn;挟op;挌ƀcotᶘᶣᶦĀryᶝᶡ;쀀𝒹;䑕l;槶rok;䄑Ādrᶰᶴot;拱iĀ;fᶺ᠖斿Āah᷀᷃ròЩaòྦangle;榦Āci᷒ᷕy;䑟grarr;柿ऀDacdefglmnopqrstuxḁḉḙḸոḼṉṡṾấắẽỡἪἷὄ὎὚ĀDoḆᴴoôᲉĀcsḎḔute耻é䃩ter;橮ȀaioyḢḧḱḶron;䄛rĀ;cḭḮ扖耻ê䃪lon;払;䑍ot;䄗ĀDrṁṅot;扒;쀀𝔢ƀ;rsṐṑṗ檚ave耻è䃨Ā;dṜṝ檖ot;檘Ȁ;ilsṪṫṲṴ檙nters;揧;愓Ā;dṹṺ檕ot;檗ƀapsẅẉẗcr;䄓tyƀ;svẒẓẕ戅et»ẓpĀ1;ẝẤĳạả;怄;怅怃ĀgsẪẬ;䅋p;怂ĀgpẴẸon;䄙f;쀀𝕖ƀalsỄỎỒrĀ;sỊị拕l;槣us;橱iƀ;lvỚớở䎵on»ớ;䏵ȀcsuvỪỳἋἣĀioữḱrc»Ḯɩỹ\0\0ỻíՈantĀglἂἆtr»ṝess»Ṻƀaeiἒ἖Ἒls;䀽st;扟vĀ;DȵἠD;橸parsl;槥ĀDaἯἳot;打rr;楱ƀcdiἾὁỸr;愯oô͒ĀahὉὋ;䎷耻ð䃰Āmrὓὗl耻ë䃫o;悬ƀcipὡὤὧl;䀡sôծĀeoὬὴctatioîՙnentialåչৡᾒ\0ᾞ\0ᾡᾧ\0\0ῆῌ\0ΐ\0ῦῪ \0 ⁚llingdotseñṄy;䑄male;晀ƀilrᾭᾳ῁lig;耀ﬃɩᾹ\0\0᾽g;耀ﬀig;耀ﬄ;쀀𝔣lig;耀ﬁlig;쀀fjƀaltῙ῜ῡt;晭ig;耀ﬂns;斱of;䆒ǰ΅\0ῳf;쀀𝕗ĀakֿῷĀ;vῼ´拔;櫙artint;樍Āao‌⁕Ācs‑⁒α‚‰‸⁅⁈\0⁐β•‥‧‪‬\0‮耻½䂽;慓耻¼䂼;慕;慙;慛Ƴ‴\0‶;慔;慖ʴ‾⁁\0\0⁃耻¾䂾;慗;慜5;慘ƶ⁌\0⁎;慚;慝8;慞l;恄wn;挢cr;쀀𝒻ࢀEabcdefgijlnorstv₂₉₟₥₰₴⃰⃵⃺⃿℃ℒℸ̗ℾ⅒↞Ā;lٍ₇;檌ƀcmpₐₕ₝ute;䇵maĀ;dₜ᳚䎳;檆reve;䄟Āiy₪₮rc;䄝;䐳ot;䄡Ȁ;lqsؾق₽⃉ƀ;qsؾٌ⃄lanô٥Ȁ;cdl٥⃒⃥⃕c;檩otĀ;o⃜⃝檀Ā;l⃢⃣檂;檄Ā;e⃪⃭쀀⋛︀s;檔r;쀀𝔤Ā;gٳ؛mel;愷cy;䑓Ȁ;Eajٚℌℎℐ;檒;檥;檤ȀEaesℛℝ℩ℴ;扩pĀ;p℣ℤ檊rox»ℤĀ;q℮ℯ檈Ā;q℮ℛim;拧pf;쀀𝕘Āci⅃ⅆr;愊mƀ;el٫ⅎ⅐;檎;檐茀>;cdlqr׮ⅠⅪⅮⅳⅹĀciⅥⅧ;檧r;橺ot;拗Par;榕uest;橼ʀadelsↄⅪ←ٖ↛ǰ↉\0↎proø₞r;楸qĀlqؿ↖lesó₈ií٫Āen↣↭rtneqq;쀀≩︀Å↪ԀAabcefkosy⇄⇇⇱⇵⇺∘∝∯≨≽ròΠȀilmr⇐⇔⇗⇛rsðᒄf»․ilôکĀdr⇠⇤cy;䑊ƀ;cwࣴ⇫⇯ir;楈;憭ar;意irc;䄥ƀalr∁∎∓rtsĀ;u∉∊晥it»∊lip;怦con;抹r;쀀𝔥sĀew∣∩arow;椥arow;椦ʀamopr∺∾≃≞≣rr;懿tht;戻kĀlr≉≓eftarrow;憩ightarrow;憪f;쀀𝕙bar;怕ƀclt≯≴≸r;쀀𝒽asè⇴rok;䄧Ābp⊂⊇ull;恃hen»ᱛૡ⊣\0⊪\0⊸⋅⋎\0⋕⋳\0\0⋸⌢⍧⍢⍿\0⎆⎪⎴cute耻í䃭ƀ;iyݱ⊰⊵rc耻î䃮;䐸Ācx⊼⊿y;䐵cl耻¡䂡ĀfrΟ⋉;쀀𝔦rave耻ì䃬Ȁ;inoܾ⋝⋩⋮Āin⋢⋦nt;樌t;戭fin;槜ta;愩lig;䄳ƀaop⋾⌚⌝ƀcgt⌅⌈⌗r;䄫ƀelpܟ⌏⌓inåގarôܠh;䄱f;抷ed;䆵ʀ;cfotӴ⌬⌱⌽⍁are;愅inĀ;t⌸⌹戞ie;槝doô⌙ʀ;celpݗ⍌⍐⍛⍡al;抺Āgr⍕⍙eróᕣã⍍arhk;樗rod;樼Ȁcgpt⍯⍲⍶⍻y;䑑on;䄯f;쀀𝕚a;䎹uest耻¿䂿Āci⎊⎏r;쀀𝒾nʀ;EdsvӴ⎛⎝⎡ӳ;拹ot;拵Ā;v⎦⎧拴;拳Ā;iݷ⎮lde;䄩ǫ⎸\0⎼cy;䑖l耻ï䃯̀cfmosu⏌⏗⏜⏡⏧⏵Āiy⏑⏕rc;䄵;䐹r;쀀𝔧ath;䈷pf;쀀𝕛ǣ⏬\0⏱r;쀀𝒿rcy;䑘kcy;䑔Ѐacfghjos␋␖␢␧␭␱␵␻ppaĀ;v␓␔䎺;䏰Āey␛␠dil;䄷;䐺r;쀀𝔨reen;䄸cy;䑅cy;䑜pf;쀀𝕜cr;쀀𝓀஀ABEHabcdefghjlmnoprstuv⑰⒁⒆⒍⒑┎┽╚▀♎♞♥♹♽⚚⚲⛘❝❨➋⟀⠁⠒ƀart⑷⑺⑼rò৆òΕail;椛arr;椎Ā;gঔ⒋;檋ar;楢ॣ⒥\0⒪\0⒱\0\0\0\0\0⒵Ⓔ\0ⓆⓈⓍ\0⓹ute;䄺mptyv;榴raîࡌbda;䎻gƀ;dlࢎⓁⓃ;榑åࢎ;檅uo耻«䂫rЀ;bfhlpst࢙ⓞⓦⓩ⓫⓮⓱⓵Ā;f࢝ⓣs;椟s;椝ë≒p;憫l;椹im;楳l;憢ƀ;ae⓿─┄檫il;椙Ā;s┉┊檭;쀀⪭︀ƀabr┕┙┝rr;椌rk;杲Āak┢┬cĀek┨┪;䁻;䁛Āes┱┳;榋lĀdu┹┻;榏;榍Ȁaeuy╆╋╖╘ron;䄾Ādi═╔il;䄼ìࢰâ┩;䐻Ȁcqrs╣╦╭╽a;椶uoĀ;rนᝆĀdu╲╷har;楧shar;楋h;憲ʀ;fgqs▋▌উ◳◿扤tʀahlrt▘▤▷◂◨rrowĀ;t࢙□aé⓶arpoonĀdu▯▴own»њp»०eftarrows;懇ightƀahs◍◖◞rrowĀ;sࣴࢧarpoonó྘quigarro÷⇰hreetimes;拋ƀ;qs▋ও◺lanôবʀ;cdgsব☊☍☝☨c;檨otĀ;o☔☕橿Ā;r☚☛檁;檃Ā;e☢☥쀀⋚︀s;檓ʀadegs☳☹☽♉♋pproøⓆot;拖qĀgq♃♅ôউgtò⒌ôছiíলƀilr♕࣡♚sht;楼;쀀𝔩Ā;Eজ♣;檑š♩♶rĀdu▲♮Ā;l॥♳;楪lk;斄cy;䑙ʀ;achtੈ⚈⚋⚑⚖rò◁orneòᴈard;楫ri;旺Āio⚟⚤dot;䅀ustĀ;a⚬⚭掰che»⚭ȀEaes⚻⚽⛉⛔;扨pĀ;p⛃⛄檉rox»⛄Ā;q⛎⛏檇Ā;q⛎⚻im;拦Ѐabnoptwz⛩⛴⛷✚✯❁❇❐Ānr⛮⛱g;柬r;懽rëࣁgƀlmr⛿✍✔eftĀar০✇ightá৲apsto;柼ightá৽parrowĀlr✥✩efô⓭ight;憬ƀafl✶✹✽r;榅;쀀𝕝us;樭imes;樴š❋❏st;戗áፎƀ;ef❗❘᠀旊nge»❘arĀ;l❤❥䀨t;榓ʀachmt❳❶❼➅➇ròࢨorneòᶌarĀ;d྘➃;業;怎ri;抿̀achiqt➘➝ੀ➢➮➻quo;怹r;쀀𝓁mƀ;egল➪➬;檍;檏Ābu┪➳oĀ;rฟ➹;怚rok;䅂萀<;cdhilqrࠫ⟒☹⟜⟠⟥⟪⟰Āci⟗⟙;檦r;橹reå◲mes;拉arr;楶uest;橻ĀPi⟵⟹ar;榖ƀ;ef⠀भ᠛旃rĀdu⠇⠍shar;楊har;楦Āen⠗⠡rtneqq;쀀≨︀Å⠞܀Dacdefhilnopsu⡀⡅⢂⢎⢓⢠⢥⢨⣚⣢⣤ઃ⣳⤂Dot;戺Ȁclpr⡎⡒⡣⡽r耻¯䂯Āet⡗⡙;時Ā;e⡞⡟朠se»⡟Ā;sျ⡨toȀ;dluျ⡳⡷⡻owîҌefôएðᏑker;斮Āoy⢇⢌mma;権;䐼ash;怔asuredangle»ᘦr;쀀𝔪o;愧ƀcdn⢯⢴⣉ro耻µ䂵Ȁ;acdᑤ⢽⣀⣄sôᚧir;櫰ot肻·Ƶusƀ;bd⣒ᤃ⣓戒Ā;uᴼ⣘;横ţ⣞⣡p;櫛ò−ðઁĀdp⣩⣮els;抧f;쀀𝕞Āct⣸⣽r;쀀𝓂pos»ᖝƀ;lm⤉⤊⤍䎼timap;抸ఀGLRVabcdefghijlmoprstuvw⥂⥓⥾⦉⦘⧚⧩⨕⨚⩘⩝⪃⪕⪤⪨⬄⬇⭄⭿⮮ⰴⱧⱼ⳩Āgt⥇⥋;쀀⋙̸Ā;v⥐௏쀀≫⃒ƀelt⥚⥲⥶ftĀar⥡⥧rrow;懍ightarrow;懎;쀀⋘̸Ā;v⥻ే쀀≪⃒ightarrow;懏ĀDd⦎⦓ash;抯ash;抮ʀbcnpt⦣⦧⦬⦱⧌la»˞ute;䅄g;쀀∠⃒ʀ;Eiop඄⦼⧀⧅⧈;쀀⩰̸d;쀀≋̸s;䅉roø඄urĀ;a⧓⧔普lĀ;s⧓ସǳ⧟\0⧣p肻 ଷmpĀ;e௹ఀʀaeouy⧴⧾⨃⨐⨓ǰ⧹\0⧻;橃on;䅈dil;䅆ngĀ;dൾ⨊ot;쀀⩭̸p;橂;䐽ash;怓΀;Aadqsxஒ⨩⨭⨻⩁⩅⩐rr;懗rĀhr⨳⨶k;椤Ā;oᏲᏰot;쀀≐̸uiöୣĀei⩊⩎ar;椨í஘istĀ;s஠டr;쀀𝔫ȀEest௅⩦⩹⩼ƀ;qs஼⩭௡ƀ;qs஼௅⩴lanô௢ií௪Ā;rஶ⪁»ஷƀAap⪊⪍⪑rò⥱rr;憮ar;櫲ƀ;svྍ⪜ྌĀ;d⪡⪢拼;拺cy;䑚΀AEadest⪷⪺⪾⫂⫅⫶⫹rò⥦;쀀≦̸rr;憚r;急Ȁ;fqs఻⫎⫣⫯tĀar⫔⫙rro÷⫁ightarro÷⪐ƀ;qs఻⪺⫪lanôౕĀ;sౕ⫴»శiíౝĀ;rవ⫾iĀ;eచథiäඐĀpt⬌⬑f;쀀𝕟膀¬;in⬙⬚⬶䂬nȀ;Edvஉ⬤⬨⬮;쀀⋹̸ot;쀀⋵̸ǡஉ⬳⬵;拷;拶iĀ;vಸ⬼ǡಸ⭁⭃;拾;拽ƀaor⭋⭣⭩rȀ;ast୻⭕⭚⭟lleì୻l;쀀⫽⃥;쀀∂̸lint;樔ƀ;ceಒ⭰⭳uåಥĀ;cಘ⭸Ā;eಒ⭽ñಘȀAait⮈⮋⮝⮧rò⦈rrƀ;cw⮔⮕⮙憛;쀀⤳̸;쀀↝̸ghtarrow»⮕riĀ;eೋೖ΀chimpqu⮽⯍⯙⬄୸⯤⯯Ȁ;cerല⯆ഷ⯉uå൅;쀀𝓃ortɭ⬅\0\0⯖ará⭖mĀ;e൮⯟Ā;q൴൳suĀbp⯫⯭å೸åഋƀbcp⯶ⰑⰙȀ;Ees⯿ⰀഢⰄ抄;쀀⫅̸etĀ;eഛⰋqĀ;qണⰀcĀ;eലⰗñസȀ;EesⰢⰣൟⰧ抅;쀀⫆̸etĀ;e൘ⰮqĀ;qൠⰣȀgilrⰽⰿⱅⱇìௗlde耻ñ䃱çృiangleĀlrⱒⱜeftĀ;eచⱚñదightĀ;eೋⱥñ೗Ā;mⱬⱭ䎽ƀ;esⱴⱵⱹ䀣ro;愖p;怇ҀDHadgilrsⲏⲔⲙⲞⲣⲰⲶⳓⳣash;抭arr;椄p;쀀≍⃒ash;抬ĀetⲨⲬ;쀀≥⃒;쀀>⃒nfin;槞ƀAetⲽⳁⳅrr;椂;쀀≤⃒Ā;rⳊⳍ쀀<⃒ie;쀀⊴⃒ĀAtⳘⳜrr;椃rie;쀀⊵⃒im;쀀∼⃒ƀAan⳰⳴ⴂrr;懖rĀhr⳺⳽k;椣Ā;oᏧᏥear;椧ቓ᪕\0\0\0\0\0\0\0\0\0\0\0\0\0ⴭ\0ⴸⵈⵠⵥ⵲ⶄᬇ\0\0ⶍⶫ\0ⷈⷎ\0ⷜ⸙⸫⸾⹃Ācsⴱ᪗ute耻ó䃳ĀiyⴼⵅrĀ;c᪞ⵂ耻ô䃴;䐾ʀabios᪠ⵒⵗǈⵚlac;䅑v;樸old;榼lig;䅓Ācr⵩⵭ir;榿;쀀𝔬ͯ⵹\0\0⵼\0ⶂn;䋛ave耻ò䃲;槁Ābmⶈ෴ar;榵Ȁacitⶕ⶘ⶥⶨrò᪀Āir⶝ⶠr;榾oss;榻nå๒;槀ƀaeiⶱⶵⶹcr;䅍ga;䏉ƀcdnⷀⷅǍron;䎿;榶pf;쀀𝕠ƀaelⷔ⷗ǒr;榷rp;榹΀;adiosvⷪⷫⷮ⸈⸍⸐⸖戨rò᪆Ȁ;efmⷷⷸ⸂⸅橝rĀ;oⷾⷿ愴f»ⷿ耻ª䂪耻º䂺gof;抶r;橖lope;橗;橛ƀclo⸟⸡⸧ò⸁ash耻ø䃸l;折iŬⸯ⸴de耻õ䃵esĀ;aǛ⸺s;樶ml耻ö䃶bar;挽ૡ⹞\0⹽\0⺀⺝\0⺢⺹\0\0⻋ຜ\0⼓\0\0⼫⾼\0⿈rȀ;astЃ⹧⹲຅脀¶;l⹭⹮䂶leìЃɩ⹸\0\0⹻m;櫳;櫽y;䐿rʀcimpt⺋⺏⺓ᡥ⺗nt;䀥od;䀮il;怰enk;怱r;쀀𝔭ƀimo⺨⺰⺴Ā;v⺭⺮䏆;䏕maô੶ne;明ƀ;tv⺿⻀⻈䏀chfork»´;䏖Āau⻏⻟nĀck⻕⻝kĀ;h⇴⻛;愎ö⇴sҀ;abcdemst⻳⻴ᤈ⻹⻽⼄⼆⼊⼎䀫cir;樣ir;樢Āouᵀ⼂;樥;橲n肻±ຝim;樦wo;樧ƀipu⼙⼠⼥ntint;樕f;쀀𝕡nd耻£䂣Ԁ;Eaceinosu່⼿⽁⽄⽇⾁⾉⾒⽾⾶;檳p;檷uå໙Ā;c໎⽌̀;acens່⽙⽟⽦⽨⽾pproø⽃urlyeñ໙ñ໎ƀaes⽯⽶⽺pprox;檹qq;檵im;拨iíໟmeĀ;s⾈ຮ怲ƀEas⽸⾐⽺ð⽵ƀdfp໬⾙⾯ƀals⾠⾥⾪lar;挮ine;挒urf;挓Ā;t໻⾴ï໻rel;抰Āci⿀⿅r;쀀𝓅;䏈ncsp;怈̀fiopsu⿚⋢⿟⿥⿫⿱r;쀀𝔮pf;쀀𝕢rime;恗cr;쀀𝓆ƀaeo⿸〉〓tĀei⿾々rnionóڰnt;樖stĀ;e【】䀿ñἙô༔઀ABHabcdefhilmnoprstux぀けさすムㄎㄫㅇㅢㅲㆎ㈆㈕㈤㈩㉘㉮㉲㊐㊰㊷ƀartぇおがròႳòϝail;検aròᱥar;楤΀cdenqrtとふへみわゔヌĀeuねぱ;쀀∽̱te;䅕iãᅮmptyv;榳gȀ;del࿑らるろ;榒;榥å࿑uo耻»䂻rր;abcfhlpstw࿜ガクシスゼゾダッデナp;極Ā;f࿠ゴs;椠;椳s;椞ë≝ð✮l;楅im;楴l;憣;憝Āaiパフil;椚oĀ;nホボ戶aló༞ƀabrョリヮrò៥rk;杳ĀakンヽcĀekヹ・;䁽;䁝Āes㄂㄄;榌lĀduㄊㄌ;榎;榐Ȁaeuyㄗㄜㄧㄩron;䅙Ādiㄡㄥil;䅗ì࿲âヺ;䑀Ȁclqsㄴㄷㄽㅄa;椷dhar;楩uoĀ;rȎȍh;憳ƀacgㅎㅟངlȀ;ipsླྀㅘㅛႜnåႻarôྩt;断ƀilrㅩဣㅮsht;楽;쀀𝔯ĀaoㅷㆆrĀduㅽㅿ»ѻĀ;l႑ㆄ;楬Ā;vㆋㆌ䏁;䏱ƀgns㆕ㇹㇼht̀ahlrstㆤㆰ㇂㇘㇤㇮rrowĀ;t࿜ㆭaéトarpoonĀduㆻㆿowîㅾp»႒eftĀah㇊㇐rrowó࿪arpoonóՑightarrows;應quigarro÷ニhreetimes;拌g;䋚ingdotseñἲƀahm㈍㈐㈓rò࿪aòՑ;怏oustĀ;a㈞㈟掱che»㈟mid;櫮Ȁabpt㈲㈽㉀㉒Ānr㈷㈺g;柭r;懾rëဃƀafl㉇㉊㉎r;榆;쀀𝕣us;樮imes;樵Āap㉝㉧rĀ;g㉣㉤䀩t;榔olint;樒arò㇣Ȁachq㉻㊀Ⴜ㊅quo;怺r;쀀𝓇Ābu・㊊oĀ;rȔȓƀhir㊗㊛㊠reåㇸmes;拊iȀ;efl㊪ၙᠡ㊫方tri;槎luhar;楨;愞ൡ㋕㋛㋟㌬㌸㍱\0㍺㎤\0\0㏬㏰\0㐨㑈㑚㒭㒱㓊㓱\0㘖\0\0㘳cute;䅛quï➺Ԁ;Eaceinpsyᇭ㋳㋵㋿㌂㌋㌏㌟㌦㌩;檴ǰ㋺\0㋼;檸on;䅡uåᇾĀ;dᇳ㌇il;䅟rc;䅝ƀEas㌖㌘㌛;檶p;檺im;择olint;樓iíሄ;䑁otƀ;be㌴ᵇ㌵担;橦΀Aacmstx㍆㍊㍗㍛㍞㍣㍭rr;懘rĀhr㍐㍒ë∨Ā;oਸ਼਴t耻§䂧i;䀻war;椩mĀin㍩ðnuóñt;朶rĀ;o㍶⁕쀀𝔰Ȁacoy㎂㎆㎑㎠rp;景Āhy㎋㎏cy;䑉;䑈rtɭ㎙\0\0㎜iäᑤaraì⹯耻­䂭Āgm㎨㎴maƀ;fv㎱㎲㎲䏃;䏂Ѐ;deglnprካ㏅㏉㏎㏖㏞㏡㏦ot;橪Ā;q኱ኰĀ;E㏓㏔檞;檠Ā;E㏛㏜檝;檟e;扆lus;樤arr;楲aròᄽȀaeit㏸㐈㐏㐗Āls㏽㐄lsetmé㍪hp;樳parsl;槤Ādlᑣ㐔e;挣Ā;e㐜㐝檪Ā;s㐢㐣檬;쀀⪬︀ƀflp㐮㐳㑂tcy;䑌Ā;b㐸㐹䀯Ā;a㐾㐿槄r;挿f;쀀𝕤aĀdr㑍ЂesĀ;u㑔㑕晠it»㑕ƀcsu㑠㑹㒟Āau㑥㑯pĀ;sᆈ㑫;쀀⊓︀pĀ;sᆴ㑵;쀀⊔︀uĀbp㑿㒏ƀ;esᆗᆜ㒆etĀ;eᆗ㒍ñᆝƀ;esᆨᆭ㒖etĀ;eᆨ㒝ñᆮƀ;afᅻ㒦ְrť㒫ֱ»ᅼaròᅈȀcemt㒹㒾㓂㓅r;쀀𝓈tmîñiì㐕aræᆾĀar㓎㓕rĀ;f㓔ឿ昆Āan㓚㓭ightĀep㓣㓪psiloîỠhé⺯s»⡒ʀbcmnp㓻㕞ሉ㖋㖎Ҁ;Edemnprs㔎㔏㔑㔕㔞㔣㔬㔱㔶抂;櫅ot;檽Ā;dᇚ㔚ot;櫃ult;櫁ĀEe㔨㔪;櫋;把lus;檿arr;楹ƀeiu㔽㕒㕕tƀ;en㔎㕅㕋qĀ;qᇚ㔏eqĀ;q㔫㔨m;櫇Ābp㕚㕜;櫕;櫓c̀;acensᇭ㕬㕲㕹㕻㌦pproø㋺urlyeñᇾñᇳƀaes㖂㖈㌛pproø㌚qñ㌗g;晪ڀ123;Edehlmnps㖩㖬㖯ሜ㖲㖴㗀㗉㗕㗚㗟㗨㗭耻¹䂹耻²䂲耻³䂳;櫆Āos㖹㖼t;檾ub;櫘Ā;dሢ㗅ot;櫄sĀou㗏㗒l;柉b;櫗arr;楻ult;櫂ĀEe㗤㗦;櫌;抋lus;櫀ƀeiu㗴㘉㘌tƀ;enሜ㗼㘂qĀ;qሢ㖲eqĀ;q㗧㗤m;櫈Ābp㘑㘓;櫔;櫖ƀAan㘜㘠㘭rr;懙rĀhr㘦㘨ë∮Ā;oਫ਩war;椪lig耻ß䃟௡㙑㙝㙠ዎ㙳㙹\0㙾㛂\0\0\0\0\0㛛㜃\0㜉㝬\0\0\0㞇ɲ㙖\0\0㙛get;挖;䏄rë๟ƀaey㙦㙫㙰ron;䅥dil;䅣;䑂lrec;挕r;쀀𝔱Ȁeiko㚆㚝㚵㚼ǲ㚋\0㚑eĀ4fኄኁaƀ;sv㚘㚙㚛䎸ym;䏑Ācn㚢㚲kĀas㚨㚮pproø዁im»ኬsðኞĀas㚺㚮ð዁rn耻þ䃾Ǭ̟㛆⋧es膀×;bd㛏㛐㛘䃗Ā;aᤏ㛕r;樱;樰ƀeps㛡㛣㜀á⩍Ȁ;bcf҆㛬㛰㛴ot;挶ir;櫱Ā;o㛹㛼쀀𝕥rk;櫚á㍢rime;怴ƀaip㜏㜒㝤dåቈ΀adempst㜡㝍㝀㝑㝗㝜㝟ngleʀ;dlqr㜰㜱㜶㝀㝂斵own»ᶻeftĀ;e⠀㜾ñम;扜ightĀ;e㊪㝋ñၚot;旬inus;樺lus;樹b;槍ime;樻ezium;揢ƀcht㝲㝽㞁Āry㝷㝻;쀀𝓉;䑆cy;䑛rok;䅧Āio㞋㞎xô᝷headĀlr㞗㞠eftarro÷ࡏightarrow»ཝऀAHabcdfghlmoprstuw㟐㟓㟗㟤㟰㟼㠎㠜㠣㠴㡑㡝㡫㢩㣌㣒㣪㣶ròϭar;楣Ācr㟜㟢ute耻ú䃺òᅐrǣ㟪\0㟭y;䑞ve;䅭Āiy㟵㟺rc耻û䃻;䑃ƀabh㠃㠆㠋ròᎭlac;䅱aòᏃĀir㠓㠘sht;楾;쀀𝔲rave耻ù䃹š㠧㠱rĀlr㠬㠮»ॗ»ႃlk;斀Āct㠹㡍ɯ㠿\0\0㡊rnĀ;e㡅㡆挜r»㡆op;挏ri;旸Āal㡖㡚cr;䅫肻¨͉Āgp㡢㡦on;䅳f;쀀𝕦̀adhlsuᅋ㡸㡽፲㢑㢠ownáᎳarpoonĀlr㢈㢌efô㠭ighô㠯iƀ;hl㢙㢚㢜䏅»ᏺon»㢚parrows;懈ƀcit㢰㣄㣈ɯ㢶\0\0㣁rnĀ;e㢼㢽挝r»㢽op;挎ng;䅯ri;旹cr;쀀𝓊ƀdir㣙㣝㣢ot;拰lde;䅩iĀ;f㜰㣨»᠓Āam㣯㣲rò㢨l耻ü䃼angle;榧ހABDacdeflnoprsz㤜㤟㤩㤭㦵㦸㦽㧟㧤㧨㧳㧹㧽㨁㨠ròϷarĀ;v㤦㤧櫨;櫩asèϡĀnr㤲㤷grt;榜΀eknprst㓣㥆㥋㥒㥝㥤㦖appá␕othinçẖƀhir㓫⻈㥙opô⾵Ā;hᎷ㥢ïㆍĀiu㥩㥭gmá㎳Ābp㥲㦄setneqĀ;q㥽㦀쀀⊊︀;쀀⫋︀setneqĀ;q㦏㦒쀀⊋︀;쀀⫌︀Āhr㦛㦟etá㚜iangleĀlr㦪㦯eft»थight»ၑy;䐲ash»ံƀelr㧄㧒㧗ƀ;beⷪ㧋㧏ar;抻q;扚lip;拮Ābt㧜ᑨaòᑩr;쀀𝔳tré㦮suĀbp㧯㧱»ജ»൙pf;쀀𝕧roð໻tré㦴Ācu㨆㨋r;쀀𝓋Ābp㨐㨘nĀEe㦀㨖»㥾nĀEe㦒㨞»㦐igzag;榚΀cefoprs㨶㨻㩖㩛㩔㩡㩪irc;䅵Ādi㩀㩑Ābg㩅㩉ar;機eĀ;qᗺ㩏;扙erp;愘r;쀀𝔴pf;쀀𝕨Ā;eᑹ㩦atèᑹcr;쀀𝓌ૣណ㪇\0㪋\0㪐㪛\0\0㪝㪨㪫㪯\0\0㫃㫎\0㫘ៜ៟tré៑r;쀀𝔵ĀAa㪔㪗ròσrò৶;䎾ĀAa㪡㪤ròθrò৫að✓is;拻ƀdptឤ㪵㪾Āfl㪺ឩ;쀀𝕩imåឲĀAa㫇㫊ròώròਁĀcq㫒ីr;쀀𝓍Āpt៖㫜ré។Ѐacefiosu㫰㫽㬈㬌㬑㬕㬛㬡cĀuy㫶㫻te耻ý䃽;䑏Āiy㬂㬆rc;䅷;䑋n耻¥䂥r;쀀𝔶cy;䑗pf;쀀𝕪cr;쀀𝓎Ācm㬦㬩y;䑎l耻ÿ䃿Ԁacdefhiosw㭂㭈㭔㭘㭤㭩㭭㭴㭺㮀cute;䅺Āay㭍㭒ron;䅾;䐷ot;䅼Āet㭝㭡træᕟa;䎶r;쀀𝔷cy;䐶grarr;懝pf;쀀𝕫cr;쀀𝓏Ājn㮅㮇;怍j;怌'.split("").map(e=>e.charCodeAt(0))),QRe=new Uint16Array("Ȁaglq	\x1Bɭ\0\0p;䀦os;䀧t;䀾t;䀼uot;䀢".split("").map(e=>e.charCodeAt(0)));var CM;const eNe=new Map([[0,65533],[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]),tNe=(CM=String.fromCodePoint)!==null&&CM!==void 0?CM:function(e){let t="";return e>65535&&(e-=65536,t+=String.fromCharCode(e>>>10&1023|55296),e=56320|e&1023),t+=String.fromCharCode(e),t};function nNe(e){var t;return e>=55296&&e<=57343||e>1114111?65533:(t=eNe.get(e))!==null&&t!==void 0?t:e}var ha;(function(e){e[e.NUM=35]="NUM",e[e.SEMI=59]="SEMI",e[e.EQUALS=61]="EQUALS",e[e.ZERO=48]="ZERO",e[e.NINE=57]="NINE",e[e.LOWER_A=97]="LOWER_A",e[e.LOWER_F=102]="LOWER_F",e[e.LOWER_X=120]="LOWER_X",e[e.LOWER_Z=122]="LOWER_Z",e[e.UPPER_A=65]="UPPER_A",e[e.UPPER_F=70]="UPPER_F",e[e.UPPER_Z=90]="UPPER_Z"})(ha||(ha={}));const rNe=32;var Eh;(function(e){e[e.VALUE_LENGTH=49152]="VALUE_LENGTH",e[e.BRANCH_LENGTH=16256]="BRANCH_LENGTH",e[e.JUMP_TABLE=127]="JUMP_TABLE"})(Eh||(Eh={}));function Z3(e){return e>=ha.ZERO&&e<=ha.NINE}function sNe(e){return e>=ha.UPPER_A&&e<=ha.UPPER_F||e>=ha.LOWER_A&&e<=ha.LOWER_F}function iNe(e){return e>=ha.UPPER_A&&e<=ha.UPPER_Z||e>=ha.LOWER_A&&e<=ha.LOWER_Z||Z3(e)}function aNe(e){return e===ha.EQUALS||iNe(e)}var oa;(function(e){e[e.EntityStart=0]="EntityStart",e[e.NumericStart=1]="NumericStart",e[e.NumericDecimal=2]="NumericDecimal",e[e.NumericHex=3]="NumericHex",e[e.NamedEntity=4]="NamedEntity"})(oa||(oa={}));var _h;(function(e){e[e.Legacy=0]="Legacy",e[e.Strict=1]="Strict",e[e.Attribute=2]="Attribute"})(_h||(_h={}));class oNe{constructor(t,n,r){this.decodeTree=t,this.emitCodePoint=n,this.errors=r,this.state=oa.EntityStart,this.consumed=1,this.result=0,this.treeIndex=0,this.excess=1,this.decodeMode=_h.Strict}startEntity(t){this.decodeMode=t,this.state=oa.EntityStart,this.result=0,this.treeIndex=0,this.excess=1,this.consumed=1}write(t,n){switch(this.state){case oa.EntityStart:return t.charCodeAt(n)===ha.NUM?(this.state=oa.NumericStart,this.consumed+=1,this.stateNumericStart(t,n+1)):(this.state=oa.NamedEntity,this.stateNamedEntity(t,n));case oa.NumericStart:return this.stateNumericStart(t,n);case oa.NumericDecimal:return this.stateNumericDecimal(t,n);case oa.NumericHex:return this.stateNumericHex(t,n);case oa.NamedEntity:return this.stateNamedEntity(t,n)}}stateNumericStart(t,n){return n>=t.length?-1:(t.charCodeAt(n)|rNe)===ha.LOWER_X?(this.state=oa.NumericHex,this.consumed+=1,this.stateNumericHex(t,n+1)):(this.state=oa.NumericDecimal,this.stateNumericDecimal(t,n))}addToNumericResult(t,n,r,s){if(n!==r){const i=r-n;this.result=this.result*Math.pow(s,i)+parseInt(t.substr(n,i),s),this.consumed+=i}}stateNumericHex(t,n){const r=n;for(;n<t.length;){const s=t.charCodeAt(n);if(Z3(s)||sNe(s))n+=1;else return this.addToNumericResult(t,r,n,16),this.emitNumericEntity(s,3)}return this.addToNumericResult(t,r,n,16),-1}stateNumericDecimal(t,n){const r=n;for(;n<t.length;){const s=t.charCodeAt(n);if(Z3(s))n+=1;else return this.addToNumericResult(t,r,n,10),this.emitNumericEntity(s,2)}return this.addToNumericResult(t,r,n,10),-1}emitNumericEntity(t,n){var r;if(this.consumed<=n)return(r=this.errors)===null||r===void 0||r.absenceOfDigitsInNumericCharacterReference(this.consumed),0;if(t===ha.SEMI)this.consumed+=1;else if(this.decodeMode===_h.Strict)return 0;return this.emitCodePoint(nNe(this.result),this.consumed),this.errors&&(t!==ha.SEMI&&this.errors.missingSemicolonAfterCharacterReference(),this.errors.validateNumericCharacterReference(this.result)),this.consumed}stateNamedEntity(t,n){const{decodeTree:r}=this;let s=r[this.treeIndex],i=(s&Eh.VALUE_LENGTH)>>14;for(;n<t.length;n++,this.excess++){const a=t.charCodeAt(n);if(this.treeIndex=lNe(r,s,this.treeIndex+Math.max(1,i),a),this.treeIndex<0)return this.result===0||this.decodeMode===_h.Attribute&&(i===0||aNe(a))?0:this.emitNotTerminatedNamedEntity();if(s=r[this.treeIndex],i=(s&Eh.VALUE_LENGTH)>>14,i!==0){if(a===ha.SEMI)return this.emitNamedEntityData(this.treeIndex,i,this.consumed+this.excess);this.decodeMode!==_h.Strict&&(this.result=this.treeIndex,this.consumed+=this.excess,this.excess=0)}}return-1}emitNotTerminatedNamedEntity(){var t;const{result:n,decodeTree:r}=this,s=(r[n]&Eh.VALUE_LENGTH)>>14;return this.emitNamedEntityData(n,s,this.consumed),(t=this.errors)===null||t===void 0||t.missingSemicolonAfterCharacterReference(),this.consumed}emitNamedEntityData(t,n,r){const{decodeTree:s}=this;return this.emitCodePoint(n===1?s[t]&~Eh.VALUE_LENGTH:s[t+1],r),n===3&&this.emitCodePoint(s[t+2],r),r}end(){var t;switch(this.state){case oa.NamedEntity:return this.result!==0&&(this.decodeMode!==_h.Attribute||this.result===this.treeIndex)?this.emitNotTerminatedNamedEntity():0;case oa.NumericDecimal:return this.emitNumericEntity(0,2);case oa.NumericHex:return this.emitNumericEntity(0,3);case oa.NumericStart:return(t=this.errors)===null||t===void 0||t.absenceOfDigitsInNumericCharacterReference(this.consumed),0;case oa.EntityStart:return 0}}}function xX(e){let t="";const n=new oNe(e,r=>t+=tNe(r));return function(s,i){let a=0,o=0;for(;(o=s.indexOf("&",o))>=0;){t+=s.slice(a,o),n.startEntity(i);const c=n.write(s,o+1);if(c<0){a=o+n.end();break}a=o+c,o=c===0?a+1:a}const l=t+s.slice(a);return t="",l}}function lNe(e,t,n,r){const s=(t&Eh.BRANCH_LENGTH)>>7,i=t&Eh.JUMP_TABLE;if(s===0)return i!==0&&r===i?n:-1;if(i){const l=r-i;return l<0||l>=s?-1:e[n+l]-1}let a=n,o=a+s-1;for(;a<=o;){const l=a+o>>>1,c=e[l];if(c<r)a=l+1;else if(c>r)o=l-1;else return e[l+s]}return-1}const cNe=xX(JRe);xX(QRe);function wX(e,t=_h.Legacy){return cNe(e,t)}function uNe(e){return Object.prototype.toString.call(e)}function OD(e){return uNe(e)==="[object String]"}const dNe=Object.prototype.hasOwnProperty;function fNe(e,t){return dNe.call(e,t)}function ST(e){return Array.prototype.slice.call(arguments,1).forEach(function(n){if(n){if(typeof n!="object")throw new TypeError(n+"must be object");Object.keys(n).forEach(function(r){e[r]=n[r]})}}),e}function SX(e,t,n){return[].concat(e.slice(0,t),n,e.slice(t+1))}function DD(e){return!(e>=55296&&e<=57343||e>=64976&&e<=65007||(e&65535)===65535||(e&65535)===65534||e>=0&&e<=8||e===11||e>=14&&e<=31||e>=127&&e<=159||e>1114111)}function bk(e){if(e>65535){e-=65536;const t=55296+(e>>10),n=56320+(e&1023);return String.fromCharCode(t,n)}return String.fromCharCode(e)}const _X=/\\([!"#$%&'()*+,\-./:;<=>?@[\\\]^_`{|}~])/g,hNe=/&([a-z#][a-z0-9]{1,31});/gi,pNe=new RegExp(_X.source+"|"+hNe.source,"gi"),mNe=/^#((?:x[a-f0-9]{1,8}|[0-9]{1,8}))$/i;function gNe(e,t){if(t.charCodeAt(0)===35&&mNe.test(t)){const r=t[1].toLowerCase()==="x"?parseInt(t.slice(2),16):parseInt(t.slice(1),10);return DD(r)?bk(r):e}const n=wX(e);return n!==e?n:e}function yNe(e){return e.indexOf("\\")<0?e:e.replace(_X,"$1")}function jy(e){return e.indexOf("\\")<0&&e.indexOf("&")<0?e:e.replace(pNe,function(t,n,r){return n||gNe(t,r)})}const bNe=/[&<>"]/,vNe=/[&<>"]/g,xNe={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"};function wNe(e){return xNe[e]}function Hh(e){return bNe.test(e)?e.replace(vNe,wNe):e}const SNe=/[.?*+^$[\]\\(){}|-]/g;function _Ne(e){return e.replace(SNe,"\\$&")}function Ls(e){switch(e){case 9:case 32:return!0}return!1}function Pw(e){if(e>=8192&&e<=8202)return!0;switch(e){case 9:case 10:case 11:case 12:case 13:case 32:case 160:case 5760:case 8239:case 8287:case 12288:return!0}return!1}function Ow(e){return PD.test(e)||bX.test(e)}function Dw(e){switch(e){case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:case 41:case 42:case 43:case 44:case 45:case 46:case 47:case 58:case 59:case 60:case 61:case 62:case 63:case 64:case 91:case 92:case 93:case 94:case 95:case 96:case 123:case 124:case 125:case 126:return!0;default:return!1}}function _T(e){return e=e.trim().replace(/\s+/g," "),"ẞ".toLowerCase()==="Ṿ"&&(e=e.replace(/ẞ/g,"ß")),e.toLowerCase().toUpperCase()}const CNe={mdurl:YRe,ucmicro:XRe},kNe=Object.freeze(Object.defineProperty({__proto__:null,arrayReplaceAt:SX,assign:ST,escapeHtml:Hh,escapeRE:_Ne,fromCodePoint:bk,has:fNe,isMdAsciiPunct:Dw,isPunctChar:Ow,isSpace:Ls,isString:OD,isValidEntityCode:DD,isWhiteSpace:Pw,lib:CNe,normalizeReference:_T,unescapeAll:jy,unescapeMd:yNe},Symbol.toStringTag,{value:"Module"}));function ENe(e,t,n){let r,s,i,a;const o=e.posMax,l=e.pos;for(e.pos=t+1,r=1;e.pos<o;){if(i=e.src.charCodeAt(e.pos),i===93&&(r--,r===0)){s=!0;break}if(a=e.pos,e.md.inline.skipToken(e),i===91){if(a===e.pos-1)r++;else if(n)return e.pos=l,-1}}let c=-1;return s&&(c=e.pos),e.pos=l,c}function TNe(e,t,n){let r,s=t;const i={ok:!1,pos:0,str:""};if(e.charCodeAt(s)===60){for(s++;s<n;){if(r=e.charCodeAt(s),r===10||r===60)return i;if(r===62)return i.pos=s+1,i.str=jy(e.slice(t+1,s)),i.ok=!0,i;if(r===92&&s+1<n){s+=2;continue}s++}return i}let a=0;for(;s<n&&(r=e.charCodeAt(s),!(r===32||r<32||r===127));){if(r===92&&s+1<n){if(e.charCodeAt(s+1)===32)break;s+=2;continue}if(r===40&&(a++,a>32))return i;if(r===41){if(a===0)break;a--}s++}return t===s||a!==0||(i.str=jy(e.slice(t,s)),i.pos=s,i.ok=!0),i}function ANe(e,t,n,r){let s,i=t;const a={ok:!1,can_continue:!1,pos:0,str:"",marker:0};if(r)a.str=r.str,a.marker=r.marker;else{if(i>=n)return a;let o=e.charCodeAt(i);if(o!==34&&o!==39&&o!==40)return a;t++,i++,o===40&&(o=41),a.marker=o}for(;i<n;){if(s=e.charCodeAt(i),s===a.marker)return a.pos=i+1,a.str+=jy(e.slice(t,i)),a.ok=!0,a;if(s===40&&a.marker===41)return a;s===92&&i+1<n&&i++,i++}return a.can_continue=!0,a.str+=jy(e.slice(t,i)),a}const RNe=Object.freeze(Object.defineProperty({__proto__:null,parseLinkDestination:TNe,parseLinkLabel:ENe,parseLinkTitle:ANe},Symbol.toStringTag,{value:"Module"})),Xu={};Xu.code_inline=function(e,t,n,r,s){const i=e[t];return"<code"+s.renderAttrs(i)+">"+Hh(i.content)+"</code>"};Xu.code_block=function(e,t,n,r,s){const i=e[t];return"<pre"+s.renderAttrs(i)+"><code>"+Hh(e[t].content)+`</code></pre>
`};Xu.fence=function(e,t,n,r,s){const i=e[t],a=i.info?jy(i.info).trim():"";let o="",l="";if(a){const u=a.split(/(\s+)/g);o=u[0],l=u.slice(2).join("")}let c;if(n.highlight?c=n.highlight(i.content,o,l)||Hh(i.content):c=Hh(i.content),c.indexOf("<pre")===0)return c+`
`;if(a){const u=i.attrIndex("class"),d=i.attrs?i.attrs.slice():[];u<0?d.push(["class",n.langPrefix+o]):(d[u]=d[u].slice(),d[u][1]+=" "+n.langPrefix+o);const h={attrs:d};return`<pre><code${s.renderAttrs(h)}>${c}</code></pre>
`}return`<pre><code${s.renderAttrs(i)}>${c}</code></pre>
`};Xu.image=function(e,t,n,r,s){const i=e[t];return i.attrs[i.attrIndex("alt")][1]=s.renderInlineAsText(i.children,n,r),s.renderToken(e,t,n)};Xu.hardbreak=function(e,t,n){return n.xhtmlOut?`<br />
`:`<br>
`};Xu.softbreak=function(e,t,n){return n.breaks?n.xhtmlOut?`<br />
`:`<br>
`:`
`};Xu.text=function(e,t){return Hh(e[t].content)};Xu.html_block=function(e,t){return e[t].content};Xu.html_inline=function(e,t){return e[t].content};function xb(){this.rules=ST({},Xu)}xb.prototype.renderAttrs=function(t){let n,r,s;if(!t.attrs)return"";for(s="",n=0,r=t.attrs.length;n<r;n++)s+=" "+Hh(t.attrs[n][0])+'="'+Hh(t.attrs[n][1])+'"';return s};xb.prototype.renderToken=function(t,n,r){const s=t[n];let i="";if(s.hidden)return"";s.block&&s.nesting!==-1&&n&&t[n-1].hidden&&(i+=`
`),i+=(s.nesting===-1?"</":"<")+s.tag,i+=this.renderAttrs(s),s.nesting===0&&r.xhtmlOut&&(i+=" /");let a=!1;if(s.block&&(a=!0,s.nesting===1&&n+1<t.length)){const o=t[n+1];(o.type==="inline"||o.hidden||o.nesting===-1&&o.tag===s.tag)&&(a=!1)}return i+=a?`>
`:">",i};xb.prototype.renderInline=function(e,t,n){let r="";const s=this.rules;for(let i=0,a=e.length;i<a;i++){const o=e[i].type;typeof s[o]<"u"?r+=s[o](e,i,t,n,this):r+=this.renderToken(e,i,t)}return r};xb.prototype.renderInlineAsText=function(e,t,n){let r="";for(let s=0,i=e.length;s<i;s++)switch(e[s].type){case"text":r+=e[s].content;break;case"image":r+=this.renderInlineAsText(e[s].children,t,n);break;case"html_inline":case"html_block":r+=e[s].content;break;case"softbreak":case"hardbreak":r+=`
`;break}return r};xb.prototype.render=function(e,t,n){let r="";const s=this.rules;for(let i=0,a=e.length;i<a;i++){const o=e[i].type;o==="inline"?r+=this.renderInline(e[i].children,t,n):typeof s[o]<"u"?r+=s[o](e,i,t,n,this):r+=this.renderToken(e,i,t,n)}return r};function Yo(){this.__rules__=[],this.__cache__=null}Yo.prototype.__find__=function(e){for(let t=0;t<this.__rules__.length;t++)if(this.__rules__[t].name===e)return t;return-1};Yo.prototype.__compile__=function(){const e=this,t=[""];e.__rules__.forEach(function(n){n.enabled&&n.alt.forEach(function(r){t.indexOf(r)<0&&t.push(r)})}),e.__cache__={},t.forEach(function(n){e.__cache__[n]=[],e.__rules__.forEach(function(r){r.enabled&&(n&&r.alt.indexOf(n)<0||e.__cache__[n].push(r.fn))})})};Yo.prototype.at=function(e,t,n){const r=this.__find__(e),s=n||{};if(r===-1)throw new Error("Parser rule not found: "+e);this.__rules__[r].fn=t,this.__rules__[r].alt=s.alt||[],this.__cache__=null};Yo.prototype.before=function(e,t,n,r){const s=this.__find__(e),i=r||{};if(s===-1)throw new Error("Parser rule not found: "+e);this.__rules__.splice(s,0,{name:t,enabled:!0,fn:n,alt:i.alt||[]}),this.__cache__=null};Yo.prototype.after=function(e,t,n,r){const s=this.__find__(e),i=r||{};if(s===-1)throw new Error("Parser rule not found: "+e);this.__rules__.splice(s+1,0,{name:t,enabled:!0,fn:n,alt:i.alt||[]}),this.__cache__=null};Yo.prototype.push=function(e,t,n){const r=n||{};this.__rules__.push({name:e,enabled:!0,fn:t,alt:r.alt||[]}),this.__cache__=null};Yo.prototype.enable=function(e,t){Array.isArray(e)||(e=[e]);const n=[];return e.forEach(function(r){const s=this.__find__(r);if(s<0){if(t)return;throw new Error("Rules manager: invalid rule name "+r)}this.__rules__[s].enabled=!0,n.push(r)},this),this.__cache__=null,n};Yo.prototype.enableOnly=function(e,t){Array.isArray(e)||(e=[e]),this.__rules__.forEach(function(n){n.enabled=!1}),this.enable(e,t)};Yo.prototype.disable=function(e,t){Array.isArray(e)||(e=[e]);const n=[];return e.forEach(function(r){const s=this.__find__(r);if(s<0){if(t)return;throw new Error("Rules manager: invalid rule name "+r)}this.__rules__[s].enabled=!1,n.push(r)},this),this.__cache__=null,n};Yo.prototype.getRules=function(e){return this.__cache__===null&&this.__compile__(),this.__cache__[e]||[]};function Qc(e,t,n){this.type=e,this.tag=t,this.attrs=null,this.map=null,this.nesting=n,this.level=0,this.children=null,this.content="",this.markup="",this.info="",this.meta=null,this.block=!1,this.hidden=!1}Qc.prototype.attrIndex=function(t){if(!this.attrs)return-1;const n=this.attrs;for(let r=0,s=n.length;r<s;r++)if(n[r][0]===t)return r;return-1};Qc.prototype.attrPush=function(t){this.attrs?this.attrs.push(t):this.attrs=[t]};Qc.prototype.attrSet=function(t,n){const r=this.attrIndex(t),s=[t,n];r<0?this.attrPush(s):this.attrs[r]=s};Qc.prototype.attrGet=function(t){const n=this.attrIndex(t);let r=null;return n>=0&&(r=this.attrs[n][1]),r};Qc.prototype.attrJoin=function(t,n){const r=this.attrIndex(t);r<0?this.attrPush([t,n]):this.attrs[r][1]=this.attrs[r][1]+" "+n};function CX(e,t,n){this.src=e,this.env=n,this.tokens=[],this.inlineMode=!1,this.md=t}CX.prototype.Token=Qc;const NNe=/\r\n?|\n/g,INe=/\0/g;function MNe(e){let t;t=e.src.replace(NNe,`
`),t=t.replace(INe,"�"),e.src=t}function jNe(e){let t;e.inlineMode?(t=new e.Token("inline","",0),t.content=e.src,t.map=[0,1],t.children=[],e.tokens.push(t)):e.md.block.parse(e.src,e.md,e.env,e.tokens)}function PNe(e){const t=e.tokens;for(let n=0,r=t.length;n<r;n++){const s=t[n];s.type==="inline"&&e.md.inline.parse(s.content,e.md,e.env,s.children)}}function ONe(e){return/^<a[>\s]/i.test(e)}function DNe(e){return/^<\/a\s*>/i.test(e)}function FNe(e){const t=e.tokens;if(e.md.options.linkify)for(let n=0,r=t.length;n<r;n++){if(t[n].type!=="inline"||!e.md.linkify.pretest(t[n].content))continue;let s=t[n].children,i=0;for(let a=s.length-1;a>=0;a--){const o=s[a];if(o.type==="link_close"){for(a--;s[a].level!==o.level&&s[a].type!=="link_open";)a--;continue}if(o.type==="html_inline"&&(ONe(o.content)&&i>0&&i--,DNe(o.content)&&i++),!(i>0)&&o.type==="text"&&e.md.linkify.test(o.content)){const l=o.content;let c=e.md.linkify.match(l);const u=[];let d=o.level,h=0;c.length>0&&c[0].index===0&&a>0&&s[a-1].type==="text_special"&&(c=c.slice(1));for(let m=0;m<c.length;m++){const y=c[m].url,b=e.md.normalizeLink(y);if(!e.md.validateLink(b))continue;let v=c[m].text;c[m].schema?c[m].schema==="mailto:"&&!/^mailto:/i.test(v)?v=e.md.normalizeLinkText("mailto:"+v).replace(/^mailto:/,""):v=e.md.normalizeLinkText(v):v=e.md.normalizeLinkText("http://"+v).replace(/^http:\/\//,"");const x=c[m].index;if(x>h){const C=new e.Token("text","",0);C.content=l.slice(h,x),C.level=d,u.push(C)}const w=new e.Token("link_open","a",1);w.attrs=[["href",b]],w.level=d++,w.markup="linkify",w.info="auto",u.push(w);const _=new e.Token("text","",0);_.content=v,_.level=d,u.push(_);const k=new e.Token("link_close","a",-1);k.level=--d,k.markup="linkify",k.info="auto",u.push(k),h=c[m].lastIndex}if(h<l.length){const m=new e.Token("text","",0);m.content=l.slice(h),m.level=d,u.push(m)}t[n].children=s=SX(s,a,u)}}}}const kX=/\+-|\.\.|\?\?\?\?|!!!!|,,|--/,LNe=/\((c|tm|r)\)/i,BNe=/\((c|tm|r)\)/ig,$Ne={c:"©",r:"®",tm:"™"};function zNe(e,t){return $Ne[t.toLowerCase()]}function UNe(e){let t=0;for(let n=e.length-1;n>=0;n--){const r=e[n];r.type==="text"&&!t&&(r.content=r.content.replace(BNe,zNe)),r.type==="link_open"&&r.info==="auto"&&t--,r.type==="link_close"&&r.info==="auto"&&t++}}function qNe(e){let t=0;for(let n=e.length-1;n>=0;n--){const r=e[n];r.type==="text"&&!t&&kX.test(r.content)&&(r.content=r.content.replace(/\+-/g,"±").replace(/\.{2,}/g,"…").replace(/([?!])…/g,"$1..").replace(/([?!]){4,}/g,"$1$1$1").replace(/,{2,}/g,",").replace(/(^|[^-])---(?=[^-]|$)/mg,"$1—").replace(/(^|\s)--(?=\s|$)/mg,"$1–").replace(/(^|[^-\s])--(?=[^-\s]|$)/mg,"$1–")),r.type==="link_open"&&r.info==="auto"&&t--,r.type==="link_close"&&r.info==="auto"&&t++}}function VNe(e){let t;if(e.md.options.typographer)for(t=e.tokens.length-1;t>=0;t--)e.tokens[t].type==="inline"&&(LNe.test(e.tokens[t].content)&&UNe(e.tokens[t].children),kX.test(e.tokens[t].content)&&qNe(e.tokens[t].children))}const WNe=/['"]/,l7=/['"]/g,c7="’";function iC(e,t,n){return e.slice(0,t)+n+e.slice(t+1)}function HNe(e,t){let n;const r=[];for(let s=0;s<e.length;s++){const i=e[s],a=e[s].level;for(n=r.length-1;n>=0&&!(r[n].level<=a);n--);if(r.length=n+1,i.type!=="text")continue;let o=i.content,l=0,c=o.length;e:for(;l<c;){l7.lastIndex=l;const u=l7.exec(o);if(!u)break;let d=!0,h=!0;l=u.index+1;const m=u[0]==="'";let y=32;if(u.index-1>=0)y=o.charCodeAt(u.index-1);else for(n=s-1;n>=0&&!(e[n].type==="softbreak"||e[n].type==="hardbreak");n--)if(e[n].content){y=e[n].content.charCodeAt(e[n].content.length-1);break}let b=32;if(l<c)b=o.charCodeAt(l);else for(n=s+1;n<e.length&&!(e[n].type==="softbreak"||e[n].type==="hardbreak");n++)if(e[n].content){b=e[n].content.charCodeAt(0);break}const v=Dw(y)||Ow(String.fromCharCode(y)),x=Dw(b)||Ow(String.fromCharCode(b)),w=Pw(y),_=Pw(b);if(_?d=!1:x&&(w||v||(d=!1)),w?h=!1:v&&(_||x||(h=!1)),b===34&&u[0]==='"'&&y>=48&&y<=57&&(h=d=!1),d&&h&&(d=v,h=x),!d&&!h){m&&(i.content=iC(i.content,u.index,c7));continue}if(h)for(n=r.length-1;n>=0;n--){let k=r[n];if(r[n].level<a)break;if(k.single===m&&r[n].level===a){k=r[n];let C,T;m?(C=t.md.options.quotes[2],T=t.md.options.quotes[3]):(C=t.md.options.quotes[0],T=t.md.options.quotes[1]),i.content=iC(i.content,u.index,T),e[k.token].content=iC(e[k.token].content,k.pos,C),l+=T.length-1,k.token===s&&(l+=C.length-1),o=i.content,c=o.length,r.length=n;continue e}}d?r.push({token:s,pos:u.index,single:m,level:a}):h&&m&&(i.content=iC(i.content,u.index,c7))}}}function GNe(e){if(e.md.options.typographer)for(let t=e.tokens.length-1;t>=0;t--)e.tokens[t].type!=="inline"||!WNe.test(e.tokens[t].content)||HNe(e.tokens[t].children,e)}function KNe(e){let t,n;const r=e.tokens,s=r.length;for(let i=0;i<s;i++){if(r[i].type!=="inline")continue;const a=r[i].children,o=a.length;for(t=0;t<o;t++)a[t].type==="text_special"&&(a[t].type="text");for(t=n=0;t<o;t++)a[t].type==="text"&&t+1<o&&a[t+1].type==="text"?a[t+1].content=a[t].content+a[t+1].content:(t!==n&&(a[n]=a[t]),n++);t!==n&&(a.length=n)}}const kM=[["normalize",MNe],["block",jNe],["inline",PNe],["linkify",FNe],["replacements",VNe],["smartquotes",GNe],["text_join",KNe]];function FD(){this.ruler=new Yo;for(let e=0;e<kM.length;e++)this.ruler.push(kM[e][0],kM[e][1])}FD.prototype.process=function(e){const t=this.ruler.getRules("");for(let n=0,r=t.length;n<r;n++)t[n](e)};FD.prototype.State=CX;function Ju(e,t,n,r){this.src=e,this.md=t,this.env=n,this.tokens=r,this.bMarks=[],this.eMarks=[],this.tShift=[],this.sCount=[],this.bsCount=[],this.blkIndent=0,this.line=0,this.lineMax=0,this.tight=!1,this.ddIndent=-1,this.listIndent=-1,this.parentType="root",this.level=0;const s=this.src;for(let i=0,a=0,o=0,l=0,c=s.length,u=!1;a<c;a++){const d=s.charCodeAt(a);if(!u)if(Ls(d)){o++,d===9?l+=4-l%4:l++;continue}else u=!0;(d===10||a===c-1)&&(d!==10&&a++,this.bMarks.push(i),this.eMarks.push(a),this.tShift.push(o),this.sCount.push(l),this.bsCount.push(0),u=!1,o=0,l=0,i=a+1)}this.bMarks.push(s.length),this.eMarks.push(s.length),this.tShift.push(0),this.sCount.push(0),this.bsCount.push(0),this.lineMax=this.bMarks.length-1}Ju.prototype.push=function(e,t,n){const r=new Qc(e,t,n);return r.block=!0,n<0&&this.level--,r.level=this.level,n>0&&this.level++,this.tokens.push(r),r};Ju.prototype.isEmpty=function(t){return this.bMarks[t]+this.tShift[t]>=this.eMarks[t]};Ju.prototype.skipEmptyLines=function(t){for(let n=this.lineMax;t<n&&!(this.bMarks[t]+this.tShift[t]<this.eMarks[t]);t++);return t};Ju.prototype.skipSpaces=function(t){for(let n=this.src.length;t<n;t++){const r=this.src.charCodeAt(t);if(!Ls(r))break}return t};Ju.prototype.skipSpacesBack=function(t,n){if(t<=n)return t;for(;t>n;)if(!Ls(this.src.charCodeAt(--t)))return t+1;return t};Ju.prototype.skipChars=function(t,n){for(let r=this.src.length;t<r&&this.src.charCodeAt(t)===n;t++);return t};Ju.prototype.skipCharsBack=function(t,n,r){if(t<=r)return t;for(;t>r;)if(n!==this.src.charCodeAt(--t))return t+1;return t};Ju.prototype.getLines=function(t,n,r,s){if(t>=n)return"";const i=new Array(n-t);for(let a=0,o=t;o<n;o++,a++){let l=0;const c=this.bMarks[o];let u=c,d;for(o+1<n||s?d=this.eMarks[o]+1:d=this.eMarks[o];u<d&&l<r;){const h=this.src.charCodeAt(u);if(Ls(h))h===9?l+=4-(l+this.bsCount[o])%4:l++;else if(u-c<this.tShift[o])l++;else break;u++}l>r?i[a]=new Array(l-r+1).join(" ")+this.src.slice(u,d):i[a]=this.src.slice(u,d)}return i.join("")};Ju.prototype.Token=Qc;const YNe=65536;function EM(e,t){const n=e.bMarks[t]+e.tShift[t],r=e.eMarks[t];return e.src.slice(n,r)}function u7(e){const t=[],n=e.length;let r=0,s=e.charCodeAt(r),i=!1,a=0,o="";for(;r<n;)s===124&&(i?(o+=e.substring(a,r-1),a=r):(t.push(o+e.substring(a,r)),o="",a=r+1)),i=s===92,r++,s=e.charCodeAt(r);return t.push(o+e.substring(a)),t}function ZNe(e,t,n,r){if(t+2>n)return!1;let s=t+1;if(e.sCount[s]<e.blkIndent||e.sCount[s]-e.blkIndent>=4)return!1;let i=e.bMarks[s]+e.tShift[s];if(i>=e.eMarks[s])return!1;const a=e.src.charCodeAt(i++);if(a!==124&&a!==45&&a!==58||i>=e.eMarks[s])return!1;const o=e.src.charCodeAt(i++);if(o!==124&&o!==45&&o!==58&&!Ls(o)||a===45&&Ls(o))return!1;for(;i<e.eMarks[s];){const k=e.src.charCodeAt(i);if(k!==124&&k!==45&&k!==58&&!Ls(k))return!1;i++}let l=EM(e,t+1),c=l.split("|");const u=[];for(let k=0;k<c.length;k++){const C=c[k].trim();if(!C){if(k===0||k===c.length-1)continue;return!1}if(!/^:?-+:?$/.test(C))return!1;C.charCodeAt(C.length-1)===58?u.push(C.charCodeAt(0)===58?"center":"right"):C.charCodeAt(0)===58?u.push("left"):u.push("")}if(l=EM(e,t).trim(),l.indexOf("|")===-1||e.sCount[t]-e.blkIndent>=4)return!1;c=u7(l),c.length&&c[0]===""&&c.shift(),c.length&&c[c.length-1]===""&&c.pop();const d=c.length;if(d===0||d!==u.length)return!1;if(r)return!0;const h=e.parentType;e.parentType="table";const m=e.md.block.ruler.getRules("blockquote"),y=e.push("table_open","table",1),b=[t,0];y.map=b;const v=e.push("thead_open","thead",1);v.map=[t,t+1];const x=e.push("tr_open","tr",1);x.map=[t,t+1];for(let k=0;k<c.length;k++){const C=e.push("th_open","th",1);u[k]&&(C.attrs=[["style","text-align:"+u[k]]]);const T=e.push("inline","",0);T.content=c[k].trim(),T.children=[],e.push("th_close","th",-1)}e.push("tr_close","tr",-1),e.push("thead_close","thead",-1);let w,_=0;for(s=t+2;s<n&&!(e.sCount[s]<e.blkIndent);s++){let k=!1;for(let T=0,A=m.length;T<A;T++)if(m[T](e,s,n,!0)){k=!0;break}if(k||(l=EM(e,s).trim(),!l)||e.sCount[s]-e.blkIndent>=4||(c=u7(l),c.length&&c[0]===""&&c.shift(),c.length&&c[c.length-1]===""&&c.pop(),_+=d-c.length,_>YNe))break;if(s===t+2){const T=e.push("tbody_open","tbody",1);T.map=w=[t+2,0]}const C=e.push("tr_open","tr",1);C.map=[s,s+1];for(let T=0;T<d;T++){const A=e.push("td_open","td",1);u[T]&&(A.attrs=[["style","text-align:"+u[T]]]);const N=e.push("inline","",0);N.content=c[T]?c[T].trim():"",N.children=[],e.push("td_close","td",-1)}e.push("tr_close","tr",-1)}return w&&(e.push("tbody_close","tbody",-1),w[1]=s),e.push("table_close","table",-1),b[1]=s,e.parentType=h,e.line=s,!0}function XNe(e,t,n){if(e.sCount[t]-e.blkIndent<4)return!1;let r=t+1,s=r;for(;r<n;){if(e.isEmpty(r)){r++;continue}if(e.sCount[r]-e.blkIndent>=4){r++,s=r;continue}break}e.line=s;const i=e.push("code_block","code",0);return i.content=e.getLines(t,s,4+e.blkIndent,!1)+`
`,i.map=[t,e.line],!0}function JNe(e,t,n,r){let s=e.bMarks[t]+e.tShift[t],i=e.eMarks[t];if(e.sCount[t]-e.blkIndent>=4||s+3>i)return!1;const a=e.src.charCodeAt(s);if(a!==126&&a!==96)return!1;let o=s;s=e.skipChars(s,a);let l=s-o;if(l<3)return!1;const c=e.src.slice(o,s),u=e.src.slice(s,i);if(a===96&&u.indexOf(String.fromCharCode(a))>=0)return!1;if(r)return!0;let d=t,h=!1;for(;d++,!(d>=n||(s=o=e.bMarks[d]+e.tShift[d],i=e.eMarks[d],s<i&&e.sCount[d]<e.blkIndent));)if(e.src.charCodeAt(s)===a&&!(e.sCount[d]-e.blkIndent>=4)&&(s=e.skipChars(s,a),!(s-o<l)&&(s=e.skipSpaces(s),!(s<i)))){h=!0;break}l=e.sCount[t],e.line=d+(h?1:0);const m=e.push("fence","code",0);return m.info=u,m.content=e.getLines(t+1,d,l,!0),m.markup=c,m.map=[t,e.line],!0}function QNe(e,t,n,r){let s=e.bMarks[t]+e.tShift[t],i=e.eMarks[t];const a=e.lineMax;if(e.sCount[t]-e.blkIndent>=4||e.src.charCodeAt(s)!==62)return!1;if(r)return!0;const o=[],l=[],c=[],u=[],d=e.md.block.ruler.getRules("blockquote"),h=e.parentType;e.parentType="blockquote";let m=!1,y;for(y=t;y<n;y++){const _=e.sCount[y]<e.blkIndent;if(s=e.bMarks[y]+e.tShift[y],i=e.eMarks[y],s>=i)break;if(e.src.charCodeAt(s++)===62&&!_){let C=e.sCount[y]+1,T,A;e.src.charCodeAt(s)===32?(s++,C++,A=!1,T=!0):e.src.charCodeAt(s)===9?(T=!0,(e.bsCount[y]+C)%4===3?(s++,C++,A=!1):A=!0):T=!1;let N=C;for(o.push(e.bMarks[y]),e.bMarks[y]=s;s<i;){const I=e.src.charCodeAt(s);if(Ls(I))I===9?N+=4-(N+e.bsCount[y]+(A?1:0))%4:N++;else break;s++}m=s>=i,l.push(e.bsCount[y]),e.bsCount[y]=e.sCount[y]+1+(T?1:0),c.push(e.sCount[y]),e.sCount[y]=N-C,u.push(e.tShift[y]),e.tShift[y]=s-e.bMarks[y];continue}if(m)break;let k=!1;for(let C=0,T=d.length;C<T;C++)if(d[C](e,y,n,!0)){k=!0;break}if(k){e.lineMax=y,e.blkIndent!==0&&(o.push(e.bMarks[y]),l.push(e.bsCount[y]),u.push(e.tShift[y]),c.push(e.sCount[y]),e.sCount[y]-=e.blkIndent);break}o.push(e.bMarks[y]),l.push(e.bsCount[y]),u.push(e.tShift[y]),c.push(e.sCount[y]),e.sCount[y]=-1}const b=e.blkIndent;e.blkIndent=0;const v=e.push("blockquote_open","blockquote",1);v.markup=">";const x=[t,0];v.map=x,e.md.block.tokenize(e,t,y);const w=e.push("blockquote_close","blockquote",-1);w.markup=">",e.lineMax=a,e.parentType=h,x[1]=e.line;for(let _=0;_<u.length;_++)e.bMarks[_+t]=o[_],e.tShift[_+t]=u[_],e.sCount[_+t]=c[_],e.bsCount[_+t]=l[_];return e.blkIndent=b,!0}function eIe(e,t,n,r){const s=e.eMarks[t];if(e.sCount[t]-e.blkIndent>=4)return!1;let i=e.bMarks[t]+e.tShift[t];const a=e.src.charCodeAt(i++);if(a!==42&&a!==45&&a!==95)return!1;let o=1;for(;i<s;){const c=e.src.charCodeAt(i++);if(c!==a&&!Ls(c))return!1;c===a&&o++}if(o<3)return!1;if(r)return!0;e.line=t+1;const l=e.push("hr","hr",0);return l.map=[t,e.line],l.markup=Array(o+1).join(String.fromCharCode(a)),!0}function d7(e,t){const n=e.eMarks[t];let r=e.bMarks[t]+e.tShift[t];const s=e.src.charCodeAt(r++);if(s!==42&&s!==45&&s!==43)return-1;if(r<n){const i=e.src.charCodeAt(r);if(!Ls(i))return-1}return r}function f7(e,t){const n=e.bMarks[t]+e.tShift[t],r=e.eMarks[t];let s=n;if(s+1>=r)return-1;let i=e.src.charCodeAt(s++);if(i<48||i>57)return-1;for(;;){if(s>=r)return-1;if(i=e.src.charCodeAt(s++),i>=48&&i<=57){if(s-n>=10)return-1;continue}if(i===41||i===46)break;return-1}return s<r&&(i=e.src.charCodeAt(s),!Ls(i))?-1:s}function tIe(e,t){const n=e.level+2;for(let r=t+2,s=e.tokens.length-2;r<s;r++)e.tokens[r].level===n&&e.tokens[r].type==="paragraph_open"&&(e.tokens[r+2].hidden=!0,e.tokens[r].hidden=!0,r+=2)}function nIe(e,t,n,r){let s,i,a,o,l=t,c=!0;if(e.sCount[l]-e.blkIndent>=4||e.listIndent>=0&&e.sCount[l]-e.listIndent>=4&&e.sCount[l]<e.blkIndent)return!1;let u=!1;r&&e.parentType==="paragraph"&&e.sCount[l]>=e.blkIndent&&(u=!0);let d,h,m;if((m=f7(e,l))>=0){if(d=!0,a=e.bMarks[l]+e.tShift[l],h=Number(e.src.slice(a,m-1)),u&&h!==1)return!1}else if((m=d7(e,l))>=0)d=!1;else return!1;if(u&&e.skipSpaces(m)>=e.eMarks[l])return!1;if(r)return!0;const y=e.src.charCodeAt(m-1),b=e.tokens.length;d?(o=e.push("ordered_list_open","ol",1),h!==1&&(o.attrs=[["start",h]])):o=e.push("bullet_list_open","ul",1);const v=[l,0];o.map=v,o.markup=String.fromCharCode(y);let x=!1;const w=e.md.block.ruler.getRules("list"),_=e.parentType;for(e.parentType="list";l<n;){i=m,s=e.eMarks[l];const k=e.sCount[l]+m-(e.bMarks[l]+e.tShift[l]);let C=k;for(;i<s;){const K=e.src.charCodeAt(i);if(K===9)C+=4-(C+e.bsCount[l])%4;else if(K===32)C++;else break;i++}const T=i;let A;T>=s?A=1:A=C-k,A>4&&(A=1);const N=k+A;o=e.push("list_item_open","li",1),o.markup=String.fromCharCode(y);const I=[l,0];o.map=I,d&&(o.info=e.src.slice(a,m-1));const j=e.tight,L=e.tShift[l],D=e.sCount[l],H=e.listIndent;if(e.listIndent=e.blkIndent,e.blkIndent=N,e.tight=!0,e.tShift[l]=T-e.bMarks[l],e.sCount[l]=C,T>=s&&e.isEmpty(l+1)?e.line=Math.min(e.line+2,n):e.md.block.tokenize(e,l,n,!0),(!e.tight||x)&&(c=!1),x=e.line-l>1&&e.isEmpty(e.line-1),e.blkIndent=e.listIndent,e.listIndent=H,e.tShift[l]=L,e.sCount[l]=D,e.tight=j,o=e.push("list_item_close","li",-1),o.markup=String.fromCharCode(y),l=e.line,I[1]=l,l>=n||e.sCount[l]<e.blkIndent||e.sCount[l]-e.blkIndent>=4)break;let O=!1;for(let K=0,U=w.length;K<U;K++)if(w[K](e,l,n,!0)){O=!0;break}if(O)break;if(d){if(m=f7(e,l),m<0)break;a=e.bMarks[l]+e.tShift[l]}else if(m=d7(e,l),m<0)break;if(y!==e.src.charCodeAt(m-1))break}return d?o=e.push("ordered_list_close","ol",-1):o=e.push("bullet_list_close","ul",-1),o.markup=String.fromCharCode(y),v[1]=l,e.line=l,e.parentType=_,c&&tIe(e,b),!0}function rIe(e,t,n,r){let s=e.bMarks[t]+e.tShift[t],i=e.eMarks[t],a=t+1;if(e.sCount[t]-e.blkIndent>=4||e.src.charCodeAt(s)!==91)return!1;function o(w){const _=e.lineMax;if(w>=_||e.isEmpty(w))return null;let k=!1;if(e.sCount[w]-e.blkIndent>3&&(k=!0),e.sCount[w]<0&&(k=!0),!k){const A=e.md.block.ruler.getRules("reference"),N=e.parentType;e.parentType="reference";let I=!1;for(let j=0,L=A.length;j<L;j++)if(A[j](e,w,_,!0)){I=!0;break}if(e.parentType=N,I)return null}const C=e.bMarks[w]+e.tShift[w],T=e.eMarks[w];return e.src.slice(C,T+1)}let l=e.src.slice(s,i+1);i=l.length;let c=-1;for(s=1;s<i;s++){const w=l.charCodeAt(s);if(w===91)return!1;if(w===93){c=s;break}else if(w===10){const _=o(a);_!==null&&(l+=_,i=l.length,a++)}else if(w===92&&(s++,s<i&&l.charCodeAt(s)===10)){const _=o(a);_!==null&&(l+=_,i=l.length,a++)}}if(c<0||l.charCodeAt(c+1)!==58)return!1;for(s=c+2;s<i;s++){const w=l.charCodeAt(s);if(w===10){const _=o(a);_!==null&&(l+=_,i=l.length,a++)}else if(!Ls(w))break}const u=e.md.helpers.parseLinkDestination(l,s,i);if(!u.ok)return!1;const d=e.md.normalizeLink(u.str);if(!e.md.validateLink(d))return!1;s=u.pos;const h=s,m=a,y=s;for(;s<i;s++){const w=l.charCodeAt(s);if(w===10){const _=o(a);_!==null&&(l+=_,i=l.length,a++)}else if(!Ls(w))break}let b=e.md.helpers.parseLinkTitle(l,s,i);for(;b.can_continue;){const w=o(a);if(w===null)break;l+=w,s=i,i=l.length,a++,b=e.md.helpers.parseLinkTitle(l,s,i,b)}let v;for(s<i&&y!==s&&b.ok?(v=b.str,s=b.pos):(v="",s=h,a=m);s<i;){const w=l.charCodeAt(s);if(!Ls(w))break;s++}if(s<i&&l.charCodeAt(s)!==10&&v)for(v="",s=h,a=m;s<i;){const w=l.charCodeAt(s);if(!Ls(w))break;s++}if(s<i&&l.charCodeAt(s)!==10)return!1;const x=_T(l.slice(1,c));return x?(r||(typeof e.env.references>"u"&&(e.env.references={}),typeof e.env.references[x]>"u"&&(e.env.references[x]={title:v,href:d}),e.line=a),!0):!1}const sIe=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],iIe="[a-zA-Z_:][a-zA-Z0-9:._-]*",aIe="[^\"'=<>`\\x00-\\x20]+",oIe="'[^']*'",lIe='"[^"]*"',cIe="(?:"+aIe+"|"+oIe+"|"+lIe+")",uIe="(?:\\s+"+iIe+"(?:\\s*=\\s*"+cIe+")?)",EX="<[A-Za-z][A-Za-z0-9\\-]*"+uIe+"*\\s*\\/?>",TX="<\\/[A-Za-z][A-Za-z0-9\\-]*\\s*>",dIe="<!---?>|<!--(?:[^-]|-[^-]|--[^>])*-->",fIe="<[?][\\s\\S]*?[?]>",hIe="<![A-Za-z][^>]*>",pIe="<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",mIe=new RegExp("^(?:"+EX+"|"+TX+"|"+dIe+"|"+fIe+"|"+hIe+"|"+pIe+")"),gIe=new RegExp("^(?:"+EX+"|"+TX+")"),h0=[[/^<(script|pre|style|textarea)(?=(\s|>|$))/i,/<\/(script|pre|style|textarea)>/i,!0],[/^<!--/,/-->/,!0],[/^<\?/,/\?>/,!0],[/^<![A-Z]/,/>/,!0],[/^<!\[CDATA\[/,/\]\]>/,!0],[new RegExp("^</?("+sIe.join("|")+")(?=(\\s|/?>|$))","i"),/^$/,!0],[new RegExp(gIe.source+"\\s*$"),/^$/,!1]];function yIe(e,t,n,r){let s=e.bMarks[t]+e.tShift[t],i=e.eMarks[t];if(e.sCount[t]-e.blkIndent>=4||!e.md.options.html||e.src.charCodeAt(s)!==60)return!1;let a=e.src.slice(s,i),o=0;for(;o<h0.length&&!h0[o][0].test(a);o++);if(o===h0.length)return!1;if(r)return h0[o][2];let l=t+1;if(!h0[o][1].test(a)){for(;l<n&&!(e.sCount[l]<e.blkIndent);l++)if(s=e.bMarks[l]+e.tShift[l],i=e.eMarks[l],a=e.src.slice(s,i),h0[o][1].test(a)){a.length!==0&&l++;break}}e.line=l;const c=e.push("html_block","",0);return c.map=[t,l],c.content=e.getLines(t,l,e.blkIndent,!0),!0}function bIe(e,t,n,r){let s=e.bMarks[t]+e.tShift[t],i=e.eMarks[t];if(e.sCount[t]-e.blkIndent>=4)return!1;let a=e.src.charCodeAt(s);if(a!==35||s>=i)return!1;let o=1;for(a=e.src.charCodeAt(++s);a===35&&s<i&&o<=6;)o++,a=e.src.charCodeAt(++s);if(o>6||s<i&&!Ls(a))return!1;if(r)return!0;i=e.skipSpacesBack(i,s);const l=e.skipCharsBack(i,35,s);l>s&&Ls(e.src.charCodeAt(l-1))&&(i=l),e.line=t+1;const c=e.push("heading_open","h"+String(o),1);c.markup="########".slice(0,o),c.map=[t,e.line];const u=e.push("inline","",0);u.content=e.src.slice(s,i).trim(),u.map=[t,e.line],u.children=[];const d=e.push("heading_close","h"+String(o),-1);return d.markup="########".slice(0,o),!0}function vIe(e,t,n){const r=e.md.block.ruler.getRules("paragraph");if(e.sCount[t]-e.blkIndent>=4)return!1;const s=e.parentType;e.parentType="paragraph";let i=0,a,o=t+1;for(;o<n&&!e.isEmpty(o);o++){if(e.sCount[o]-e.blkIndent>3)continue;if(e.sCount[o]>=e.blkIndent){let m=e.bMarks[o]+e.tShift[o];const y=e.eMarks[o];if(m<y&&(a=e.src.charCodeAt(m),(a===45||a===61)&&(m=e.skipChars(m,a),m=e.skipSpaces(m),m>=y))){i=a===61?1:2;break}}if(e.sCount[o]<0)continue;let h=!1;for(let m=0,y=r.length;m<y;m++)if(r[m](e,o,n,!0)){h=!0;break}if(h)break}if(!i)return!1;const l=e.getLines(t,o,e.blkIndent,!1).trim();e.line=o+1;const c=e.push("heading_open","h"+String(i),1);c.markup=String.fromCharCode(a),c.map=[t,e.line];const u=e.push("inline","",0);u.content=l,u.map=[t,e.line-1],u.children=[];const d=e.push("heading_close","h"+String(i),-1);return d.markup=String.fromCharCode(a),e.parentType=s,!0}function xIe(e,t,n){const r=e.md.block.ruler.getRules("paragraph"),s=e.parentType;let i=t+1;for(e.parentType="paragraph";i<n&&!e.isEmpty(i);i++){if(e.sCount[i]-e.blkIndent>3||e.sCount[i]<0)continue;let c=!1;for(let u=0,d=r.length;u<d;u++)if(r[u](e,i,n,!0)){c=!0;break}if(c)break}const a=e.getLines(t,i,e.blkIndent,!1).trim();e.line=i;const o=e.push("paragraph_open","p",1);o.map=[t,e.line];const l=e.push("inline","",0);return l.content=a,l.map=[t,e.line],l.children=[],e.push("paragraph_close","p",-1),e.parentType=s,!0}const aC=[["table",ZNe,["paragraph","reference"]],["code",XNe],["fence",JNe,["paragraph","reference","blockquote","list"]],["blockquote",QNe,["paragraph","reference","blockquote","list"]],["hr",eIe,["paragraph","reference","blockquote","list"]],["list",nIe,["paragraph","reference","blockquote"]],["reference",rIe],["html_block",yIe,["paragraph","reference","blockquote"]],["heading",bIe,["paragraph","reference","blockquote"]],["lheading",vIe],["paragraph",xIe]];function CT(){this.ruler=new Yo;for(let e=0;e<aC.length;e++)this.ruler.push(aC[e][0],aC[e][1],{alt:(aC[e][2]||[]).slice()})}CT.prototype.tokenize=function(e,t,n){const r=this.ruler.getRules(""),s=r.length,i=e.md.options.maxNesting;let a=t,o=!1;for(;a<n&&(e.line=a=e.skipEmptyLines(a),!(a>=n||e.sCount[a]<e.blkIndent));){if(e.level>=i){e.line=n;break}const l=e.line;let c=!1;for(let u=0;u<s;u++)if(c=r[u](e,a,n,!1),c){if(l>=e.line)throw new Error("block rule didn't increment state.line");break}if(!c)throw new Error("none of the block rules matched");e.tight=!o,e.isEmpty(e.line-1)&&(o=!0),a=e.line,a<n&&e.isEmpty(a)&&(o=!0,a++,e.line=a)}};CT.prototype.parse=function(e,t,n,r){if(!e)return;const s=new this.State(e,t,n,r);this.tokenize(s,s.line,s.lineMax)};CT.prototype.State=Ju;function sS(e,t,n,r){this.src=e,this.env=n,this.md=t,this.tokens=r,this.tokens_meta=Array(r.length),this.pos=0,this.posMax=this.src.length,this.level=0,this.pending="",this.pendingLevel=0,this.cache={},this.delimiters=[],this._prev_delimiters=[],this.backticks={},this.backticksScanned=!1,this.linkLevel=0}sS.prototype.pushPending=function(){const e=new Qc("text","",0);return e.content=this.pending,e.level=this.pendingLevel,this.tokens.push(e),this.pending="",e};sS.prototype.push=function(e,t,n){this.pending&&this.pushPending();const r=new Qc(e,t,n);let s=null;return n<0&&(this.level--,this.delimiters=this._prev_delimiters.pop()),r.level=this.level,n>0&&(this.level++,this._prev_delimiters.push(this.delimiters),this.delimiters=[],s={delimiters:this.delimiters}),this.pendingLevel=this.level,this.tokens.push(r),this.tokens_meta.push(s),r};sS.prototype.scanDelims=function(e,t){const n=this.posMax,r=this.src.charCodeAt(e),s=e>0?this.src.charCodeAt(e-1):32;let i=e;for(;i<n&&this.src.charCodeAt(i)===r;)i++;const a=i-e,o=i<n?this.src.charCodeAt(i):32,l=Dw(s)||Ow(String.fromCharCode(s)),c=Dw(o)||Ow(String.fromCharCode(o)),u=Pw(s),d=Pw(o),h=!d&&(!c||u||l),m=!u&&(!l||d||c);return{can_open:h&&(t||!m||l),can_close:m&&(t||!h||c),length:a}};sS.prototype.Token=Qc;function wIe(e){switch(e){case 10:case 33:case 35:case 36:case 37:case 38:case 42:case 43:case 45:case 58:case 60:case 61:case 62:case 64:case 91:case 92:case 93:case 94:case 95:case 96:case 123:case 125:case 126:return!0;default:return!1}}function SIe(e,t){let n=e.pos;for(;n<e.posMax&&!wIe(e.src.charCodeAt(n));)n++;return n===e.pos?!1:(t||(e.pending+=e.src.slice(e.pos,n)),e.pos=n,!0)}const _Ie=/(?:^|[^a-z0-9.+-])([a-z][a-z0-9.+-]*)$/i;function CIe(e,t){if(!e.md.options.linkify||e.linkLevel>0)return!1;const n=e.pos,r=e.posMax;if(n+3>r||e.src.charCodeAt(n)!==58||e.src.charCodeAt(n+1)!==47||e.src.charCodeAt(n+2)!==47)return!1;const s=e.pending.match(_Ie);if(!s)return!1;const i=s[1],a=e.md.linkify.matchAtStart(e.src.slice(n-i.length));if(!a)return!1;let o=a.url;if(o.length<=i.length)return!1;o=o.replace(/\*+$/,"");const l=e.md.normalizeLink(o);if(!e.md.validateLink(l))return!1;if(!t){e.pending=e.pending.slice(0,-i.length);const c=e.push("link_open","a",1);c.attrs=[["href",l]],c.markup="linkify",c.info="auto";const u=e.push("text","",0);u.content=e.md.normalizeLinkText(o);const d=e.push("link_close","a",-1);d.markup="linkify",d.info="auto"}return e.pos+=o.length-i.length,!0}function kIe(e,t){let n=e.pos;if(e.src.charCodeAt(n)!==10)return!1;const r=e.pending.length-1,s=e.posMax;if(!t)if(r>=0&&e.pending.charCodeAt(r)===32)if(r>=1&&e.pending.charCodeAt(r-1)===32){let i=r-1;for(;i>=1&&e.pending.charCodeAt(i-1)===32;)i--;e.pending=e.pending.slice(0,i),e.push("hardbreak","br",0)}else e.pending=e.pending.slice(0,-1),e.push("softbreak","br",0);else e.push("softbreak","br",0);for(n++;n<s&&Ls(e.src.charCodeAt(n));)n++;return e.pos=n,!0}const LD=[];for(let e=0;e<256;e++)LD.push(0);"\\!\"#$%&'()*+,./:;<=>?@[]^_`{|}~-".split("").forEach(function(e){LD[e.charCodeAt(0)]=1});function EIe(e,t){let n=e.pos;const r=e.posMax;if(e.src.charCodeAt(n)!==92||(n++,n>=r))return!1;let s=e.src.charCodeAt(n);if(s===10){for(t||e.push("hardbreak","br",0),n++;n<r&&(s=e.src.charCodeAt(n),!!Ls(s));)n++;return e.pos=n,!0}let i=e.src[n];if(s>=55296&&s<=56319&&n+1<r){const o=e.src.charCodeAt(n+1);o>=56320&&o<=57343&&(i+=e.src[n+1],n++)}const a="\\"+i;if(!t){const o=e.push("text_special","",0);s<256&&LD[s]!==0?o.content=i:o.content=a,o.markup=a,o.info="escape"}return e.pos=n+1,!0}function TIe(e,t){let n=e.pos;if(e.src.charCodeAt(n)!==96)return!1;const s=n;n++;const i=e.posMax;for(;n<i&&e.src.charCodeAt(n)===96;)n++;const a=e.src.slice(s,n),o=a.length;if(e.backticksScanned&&(e.backticks[o]||0)<=s)return t||(e.pending+=a),e.pos+=o,!0;let l=n,c;for(;(c=e.src.indexOf("`",l))!==-1;){for(l=c+1;l<i&&e.src.charCodeAt(l)===96;)l++;const u=l-c;if(u===o){if(!t){const d=e.push("code_inline","code",0);d.markup=a,d.content=e.src.slice(n,c).replace(/\n/g," ").replace(/^ (.+) $/,"$1")}return e.pos=l,!0}e.backticks[u]=c}return e.backticksScanned=!0,t||(e.pending+=a),e.pos+=o,!0}function AIe(e,t){const n=e.pos,r=e.src.charCodeAt(n);if(t||r!==126)return!1;const s=e.scanDelims(e.pos,!0);let i=s.length;const a=String.fromCharCode(r);if(i<2)return!1;let o;i%2&&(o=e.push("text","",0),o.content=a,i--);for(let l=0;l<i;l+=2)o=e.push("text","",0),o.content=a+a,e.delimiters.push({marker:r,length:0,token:e.tokens.length-1,end:-1,open:s.can_open,close:s.can_close});return e.pos+=s.length,!0}function h7(e,t){let n;const r=[],s=t.length;for(let i=0;i<s;i++){const a=t[i];if(a.marker!==126||a.end===-1)continue;const o=t[a.end];n=e.tokens[a.token],n.type="s_open",n.tag="s",n.nesting=1,n.markup="~~",n.content="",n=e.tokens[o.token],n.type="s_close",n.tag="s",n.nesting=-1,n.markup="~~",n.content="",e.tokens[o.token-1].type==="text"&&e.tokens[o.token-1].content==="~"&&r.push(o.token-1)}for(;r.length;){const i=r.pop();let a=i+1;for(;a<e.tokens.length&&e.tokens[a].type==="s_close";)a++;a--,i!==a&&(n=e.tokens[a],e.tokens[a]=e.tokens[i],e.tokens[i]=n)}}function RIe(e){const t=e.tokens_meta,n=e.tokens_meta.length;h7(e,e.delimiters);for(let r=0;r<n;r++)t[r]&&t[r].delimiters&&h7(e,t[r].delimiters)}const AX={tokenize:AIe,postProcess:RIe};function NIe(e,t){const n=e.pos,r=e.src.charCodeAt(n);if(t||r!==95&&r!==42)return!1;const s=e.scanDelims(e.pos,r===42);for(let i=0;i<s.length;i++){const a=e.push("text","",0);a.content=String.fromCharCode(r),e.delimiters.push({marker:r,length:s.length,token:e.tokens.length-1,end:-1,open:s.can_open,close:s.can_close})}return e.pos+=s.length,!0}function p7(e,t){const n=t.length;for(let r=n-1;r>=0;r--){const s=t[r];if(s.marker!==95&&s.marker!==42||s.end===-1)continue;const i=t[s.end],a=r>0&&t[r-1].end===s.end+1&&t[r-1].marker===s.marker&&t[r-1].token===s.token-1&&t[s.end+1].token===i.token+1,o=String.fromCharCode(s.marker),l=e.tokens[s.token];l.type=a?"strong_open":"em_open",l.tag=a?"strong":"em",l.nesting=1,l.markup=a?o+o:o,l.content="";const c=e.tokens[i.token];c.type=a?"strong_close":"em_close",c.tag=a?"strong":"em",c.nesting=-1,c.markup=a?o+o:o,c.content="",a&&(e.tokens[t[r-1].token].content="",e.tokens[t[s.end+1].token].content="",r--)}}function IIe(e){const t=e.tokens_meta,n=e.tokens_meta.length;p7(e,e.delimiters);for(let r=0;r<n;r++)t[r]&&t[r].delimiters&&p7(e,t[r].delimiters)}const RX={tokenize:NIe,postProcess:IIe};function MIe(e,t){let n,r,s,i,a="",o="",l=e.pos,c=!0;if(e.src.charCodeAt(e.pos)!==91)return!1;const u=e.pos,d=e.posMax,h=e.pos+1,m=e.md.helpers.parseLinkLabel(e,e.pos,!0);if(m<0)return!1;let y=m+1;if(y<d&&e.src.charCodeAt(y)===40){for(c=!1,y++;y<d&&(n=e.src.charCodeAt(y),!(!Ls(n)&&n!==10));y++);if(y>=d)return!1;if(l=y,s=e.md.helpers.parseLinkDestination(e.src,y,e.posMax),s.ok){for(a=e.md.normalizeLink(s.str),e.md.validateLink(a)?y=s.pos:a="",l=y;y<d&&(n=e.src.charCodeAt(y),!(!Ls(n)&&n!==10));y++);if(s=e.md.helpers.parseLinkTitle(e.src,y,e.posMax),y<d&&l!==y&&s.ok)for(o=s.str,y=s.pos;y<d&&(n=e.src.charCodeAt(y),!(!Ls(n)&&n!==10));y++);}(y>=d||e.src.charCodeAt(y)!==41)&&(c=!0),y++}if(c){if(typeof e.env.references>"u")return!1;if(y<d&&e.src.charCodeAt(y)===91?(l=y+1,y=e.md.helpers.parseLinkLabel(e,y),y>=0?r=e.src.slice(l,y++):y=m+1):y=m+1,r||(r=e.src.slice(h,m)),i=e.env.references[_T(r)],!i)return e.pos=u,!1;a=i.href,o=i.title}if(!t){e.pos=h,e.posMax=m;const b=e.push("link_open","a",1),v=[["href",a]];b.attrs=v,o&&v.push(["title",o]),e.linkLevel++,e.md.inline.tokenize(e),e.linkLevel--,e.push("link_close","a",-1)}return e.pos=y,e.posMax=d,!0}function jIe(e,t){let n,r,s,i,a,o,l,c,u="";const d=e.pos,h=e.posMax;if(e.src.charCodeAt(e.pos)!==33||e.src.charCodeAt(e.pos+1)!==91)return!1;const m=e.pos+2,y=e.md.helpers.parseLinkLabel(e,e.pos+1,!1);if(y<0)return!1;if(i=y+1,i<h&&e.src.charCodeAt(i)===40){for(i++;i<h&&(n=e.src.charCodeAt(i),!(!Ls(n)&&n!==10));i++);if(i>=h)return!1;for(c=i,o=e.md.helpers.parseLinkDestination(e.src,i,e.posMax),o.ok&&(u=e.md.normalizeLink(o.str),e.md.validateLink(u)?i=o.pos:u=""),c=i;i<h&&(n=e.src.charCodeAt(i),!(!Ls(n)&&n!==10));i++);if(o=e.md.helpers.parseLinkTitle(e.src,i,e.posMax),i<h&&c!==i&&o.ok)for(l=o.str,i=o.pos;i<h&&(n=e.src.charCodeAt(i),!(!Ls(n)&&n!==10));i++);else l="";if(i>=h||e.src.charCodeAt(i)!==41)return e.pos=d,!1;i++}else{if(typeof e.env.references>"u")return!1;if(i<h&&e.src.charCodeAt(i)===91?(c=i+1,i=e.md.helpers.parseLinkLabel(e,i),i>=0?s=e.src.slice(c,i++):i=y+1):i=y+1,s||(s=e.src.slice(m,y)),a=e.env.references[_T(s)],!a)return e.pos=d,!1;u=a.href,l=a.title}if(!t){r=e.src.slice(m,y);const b=[];e.md.inline.parse(r,e.md,e.env,b);const v=e.push("image","img",0),x=[["src",u],["alt",""]];v.attrs=x,v.children=b,v.content=r,l&&x.push(["title",l])}return e.pos=i,e.posMax=h,!0}const PIe=/^([a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*)$/,OIe=/^([a-zA-Z][a-zA-Z0-9+.-]{1,31}):([^<>\x00-\x20]*)$/;function DIe(e,t){let n=e.pos;if(e.src.charCodeAt(n)!==60)return!1;const r=e.pos,s=e.posMax;for(;;){if(++n>=s)return!1;const a=e.src.charCodeAt(n);if(a===60)return!1;if(a===62)break}const i=e.src.slice(r+1,n);if(OIe.test(i)){const a=e.md.normalizeLink(i);if(!e.md.validateLink(a))return!1;if(!t){const o=e.push("link_open","a",1);o.attrs=[["href",a]],o.markup="autolink",o.info="auto";const l=e.push("text","",0);l.content=e.md.normalizeLinkText(i);const c=e.push("link_close","a",-1);c.markup="autolink",c.info="auto"}return e.pos+=i.length+2,!0}if(PIe.test(i)){const a=e.md.normalizeLink("mailto:"+i);if(!e.md.validateLink(a))return!1;if(!t){const o=e.push("link_open","a",1);o.attrs=[["href",a]],o.markup="autolink",o.info="auto";const l=e.push("text","",0);l.content=e.md.normalizeLinkText(i);const c=e.push("link_close","a",-1);c.markup="autolink",c.info="auto"}return e.pos+=i.length+2,!0}return!1}function FIe(e){return/^<a[>\s]/i.test(e)}function LIe(e){return/^<\/a\s*>/i.test(e)}function BIe(e){const t=e|32;return t>=97&&t<=122}function $Ie(e,t){if(!e.md.options.html)return!1;const n=e.posMax,r=e.pos;if(e.src.charCodeAt(r)!==60||r+2>=n)return!1;const s=e.src.charCodeAt(r+1);if(s!==33&&s!==63&&s!==47&&!BIe(s))return!1;const i=e.src.slice(r).match(mIe);if(!i)return!1;if(!t){const a=e.push("html_inline","",0);a.content=i[0],FIe(a.content)&&e.linkLevel++,LIe(a.content)&&e.linkLevel--}return e.pos+=i[0].length,!0}const zIe=/^&#((?:x[a-f0-9]{1,6}|[0-9]{1,7}));/i,UIe=/^&([a-z][a-z0-9]{1,31});/i;function qIe(e,t){const n=e.pos,r=e.posMax;if(e.src.charCodeAt(n)!==38||n+1>=r)return!1;if(e.src.charCodeAt(n+1)===35){const i=e.src.slice(n).match(zIe);if(i){if(!t){const a=i[1][0].toLowerCase()==="x"?parseInt(i[1].slice(1),16):parseInt(i[1],10),o=e.push("text_special","",0);o.content=DD(a)?bk(a):bk(65533),o.markup=i[0],o.info="entity"}return e.pos+=i[0].length,!0}}else{const i=e.src.slice(n).match(UIe);if(i){const a=wX(i[0]);if(a!==i[0]){if(!t){const o=e.push("text_special","",0);o.content=a,o.markup=i[0],o.info="entity"}return e.pos+=i[0].length,!0}}}return!1}function m7(e){const t={},n=e.length;if(!n)return;let r=0,s=-2;const i=[];for(let a=0;a<n;a++){const o=e[a];if(i.push(0),(e[r].marker!==o.marker||s!==o.token-1)&&(r=a),s=o.token,o.length=o.length||0,!o.close)continue;t.hasOwnProperty(o.marker)||(t[o.marker]=[-1,-1,-1,-1,-1,-1]);const l=t[o.marker][(o.open?3:0)+o.length%3];let c=r-i[r]-1,u=c;for(;c>l;c-=i[c]+1){const d=e[c];if(d.marker===o.marker&&d.open&&d.end<0){let h=!1;if((d.close||o.open)&&(d.length+o.length)%3===0&&(d.length%3!==0||o.length%3!==0)&&(h=!0),!h){const m=c>0&&!e[c-1].open?i[c-1]+1:0;i[a]=a-c+m,i[c]=m,o.open=!1,d.end=a,d.close=!1,u=-1,s=-2;break}}}u!==-1&&(t[o.marker][(o.open?3:0)+(o.length||0)%3]=u)}}function VIe(e){const t=e.tokens_meta,n=e.tokens_meta.length;m7(e.delimiters);for(let r=0;r<n;r++)t[r]&&t[r].delimiters&&m7(t[r].delimiters)}function WIe(e){let t,n,r=0;const s=e.tokens,i=e.tokens.length;for(t=n=0;t<i;t++)s[t].nesting<0&&r--,s[t].level=r,s[t].nesting>0&&r++,s[t].type==="text"&&t+1<i&&s[t+1].type==="text"?s[t+1].content=s[t].content+s[t+1].content:(t!==n&&(s[n]=s[t]),n++);t!==n&&(s.length=n)}const TM=[["text",SIe],["linkify",CIe],["newline",kIe],["escape",EIe],["backticks",TIe],["strikethrough",AX.tokenize],["emphasis",RX.tokenize],["link",MIe],["image",jIe],["autolink",DIe],["html_inline",$Ie],["entity",qIe]],AM=[["balance_pairs",VIe],["strikethrough",AX.postProcess],["emphasis",RX.postProcess],["fragments_join",WIe]];function iS(){this.ruler=new Yo;for(let e=0;e<TM.length;e++)this.ruler.push(TM[e][0],TM[e][1]);this.ruler2=new Yo;for(let e=0;e<AM.length;e++)this.ruler2.push(AM[e][0],AM[e][1])}iS.prototype.skipToken=function(e){const t=e.pos,n=this.ruler.getRules(""),r=n.length,s=e.md.options.maxNesting,i=e.cache;if(typeof i[t]<"u"){e.pos=i[t];return}let a=!1;if(e.level<s){for(let o=0;o<r;o++)if(e.level++,a=n[o](e,!0),e.level--,a){if(t>=e.pos)throw new Error("inline rule didn't increment state.pos");break}}else e.pos=e.posMax;a||e.pos++,i[t]=e.pos};iS.prototype.tokenize=function(e){const t=this.ruler.getRules(""),n=t.length,r=e.posMax,s=e.md.options.maxNesting;for(;e.pos<r;){const i=e.pos;let a=!1;if(e.level<s){for(let o=0;o<n;o++)if(a=t[o](e,!1),a){if(i>=e.pos)throw new Error("inline rule didn't increment state.pos");break}}if(a){if(e.pos>=r)break;continue}e.pending+=e.src[e.pos++]}e.pending&&e.pushPending()};iS.prototype.parse=function(e,t,n,r){const s=new this.State(e,t,n,r);this.tokenize(s);const i=this.ruler2.getRules(""),a=i.length;for(let o=0;o<a;o++)i[o](s)};iS.prototype.State=sS;function HIe(e){const t={};e=e||{},t.src_Any=gX.source,t.src_Cc=yX.source,t.src_Z=vX.source,t.src_P=PD.source,t.src_ZPCc=[t.src_Z,t.src_P,t.src_Cc].join("|"),t.src_ZCc=[t.src_Z,t.src_Cc].join("|");const n="[><｜]";return t.src_pseudo_letter="(?:(?!"+n+"|"+t.src_ZPCc+")"+t.src_Any+")",t.src_ip4="(?:(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)",t.src_auth="(?:(?:(?!"+t.src_ZCc+"|[@/\\[\\]()]).)+@)?",t.src_port="(?::(?:6(?:[0-4]\\d{3}|5(?:[0-4]\\d{2}|5(?:[0-2]\\d|3[0-5])))|[1-5]?\\d{1,4}))?",t.src_host_terminator="(?=$|"+n+"|"+t.src_ZPCc+")(?!"+(e["---"]?"-(?!--)|":"-|")+"_|:\\d|\\.-|\\.(?!$|"+t.src_ZPCc+"))",t.src_path="(?:[/?#](?:(?!"+t.src_ZCc+"|"+n+`|[()[\\]{}.,"'?!\\-;]).|\\[(?:(?!`+t.src_ZCc+"|\\]).)*\\]|\\((?:(?!"+t.src_ZCc+"|[)]).)*\\)|\\{(?:(?!"+t.src_ZCc+'|[}]).)*\\}|\\"(?:(?!'+t.src_ZCc+`|["]).)+\\"|\\'(?:(?!`+t.src_ZCc+"|[']).)+\\'|\\'(?="+t.src_pseudo_letter+"|[-])|\\.{2,}[a-zA-Z0-9%/&]|\\.(?!"+t.src_ZCc+"|[.]|$)|"+(e["---"]?"\\-(?!--(?:[^-]|$))(?:-*)|":"\\-+|")+",(?!"+t.src_ZCc+"|$)|;(?!"+t.src_ZCc+"|$)|\\!+(?!"+t.src_ZCc+"|[!]|$)|\\?(?!"+t.src_ZCc+"|[?]|$))+|\\/)?",t.src_email_name='[\\-;:&=\\+\\$,\\.a-zA-Z0-9_][\\-;:&=\\+\\$,\\"\\.a-zA-Z0-9_]*',t.src_xn="xn--[a-z0-9\\-]{1,59}",t.src_domain_root="(?:"+t.src_xn+"|"+t.src_pseudo_letter+"{1,63})",t.src_domain="(?:"+t.src_xn+"|(?:"+t.src_pseudo_letter+")|(?:"+t.src_pseudo_letter+"(?:-|"+t.src_pseudo_letter+"){0,61}"+t.src_pseudo_letter+"))",t.src_host="(?:(?:(?:(?:"+t.src_domain+")\\.)*"+t.src_domain+"))",t.tpl_host_fuzzy="(?:"+t.src_ip4+"|(?:(?:(?:"+t.src_domain+")\\.)+(?:%TLDS%)))",t.tpl_host_no_ip_fuzzy="(?:(?:(?:"+t.src_domain+")\\.)+(?:%TLDS%))",t.src_host_strict=t.src_host+t.src_host_terminator,t.tpl_host_fuzzy_strict=t.tpl_host_fuzzy+t.src_host_terminator,t.src_host_port_strict=t.src_host+t.src_port+t.src_host_terminator,t.tpl_host_port_fuzzy_strict=t.tpl_host_fuzzy+t.src_port+t.src_host_terminator,t.tpl_host_port_no_ip_fuzzy_strict=t.tpl_host_no_ip_fuzzy+t.src_port+t.src_host_terminator,t.tpl_host_fuzzy_test="localhost|www\\.|\\.\\d{1,3}\\.|(?:\\.(?:%TLDS%)(?:"+t.src_ZPCc+"|>|$))",t.tpl_email_fuzzy="(^|"+n+'|"|\\(|'+t.src_ZCc+")("+t.src_email_name+"@"+t.tpl_host_fuzzy_strict+")",t.tpl_link_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|｜]|"+t.src_ZPCc+"))((?![$+<=>^`|｜])"+t.tpl_host_port_fuzzy_strict+t.src_path+")",t.tpl_link_no_ip_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|｜]|"+t.src_ZPCc+"))((?![$+<=>^`|｜])"+t.tpl_host_port_no_ip_fuzzy_strict+t.src_path+")",t}function X3(e){return Array.prototype.slice.call(arguments,1).forEach(function(n){n&&Object.keys(n).forEach(function(r){e[r]=n[r]})}),e}function kT(e){return Object.prototype.toString.call(e)}function GIe(e){return kT(e)==="[object String]"}function KIe(e){return kT(e)==="[object Object]"}function YIe(e){return kT(e)==="[object RegExp]"}function g7(e){return kT(e)==="[object Function]"}function ZIe(e){return e.replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}const NX={fuzzyLink:!0,fuzzyEmail:!0,fuzzyIP:!1};function XIe(e){return Object.keys(e||{}).reduce(function(t,n){return t||NX.hasOwnProperty(n)},!1)}const JIe={"http:":{validate:function(e,t,n){const r=e.slice(t);return n.re.http||(n.re.http=new RegExp("^\\/\\/"+n.re.src_auth+n.re.src_host_port_strict+n.re.src_path,"i")),n.re.http.test(r)?r.match(n.re.http)[0].length:0}},"https:":"http:","ftp:":"http:","//":{validate:function(e,t,n){const r=e.slice(t);return n.re.no_http||(n.re.no_http=new RegExp("^"+n.re.src_auth+"(?:localhost|(?:(?:"+n.re.src_domain+")\\.)+"+n.re.src_domain_root+")"+n.re.src_port+n.re.src_host_terminator+n.re.src_path,"i")),n.re.no_http.test(r)?t>=3&&e[t-3]===":"||t>=3&&e[t-3]==="/"?0:r.match(n.re.no_http)[0].length:0}},"mailto:":{validate:function(e,t,n){const r=e.slice(t);return n.re.mailto||(n.re.mailto=new RegExp("^"+n.re.src_email_name+"@"+n.re.src_host_strict,"i")),n.re.mailto.test(r)?r.match(n.re.mailto)[0].length:0}}},QIe="a[cdefgilmnoqrstuwxz]|b[abdefghijmnorstvwyz]|c[acdfghiklmnoruvwxyz]|d[ejkmoz]|e[cegrstu]|f[ijkmor]|g[abdefghilmnpqrstuwy]|h[kmnrtu]|i[delmnoqrst]|j[emop]|k[eghimnprwyz]|l[abcikrstuvy]|m[acdeghklmnopqrstuvwxyz]|n[acefgilopruz]|om|p[aefghklmnrstwy]|qa|r[eosuw]|s[abcdeghijklmnortuvxyz]|t[cdfghjklmnortvwz]|u[agksyz]|v[aceginu]|w[fs]|y[et]|z[amw]",eMe="biz|com|edu|gov|net|org|pro|web|xxx|aero|asia|coop|info|museum|name|shop|рф".split("|");function tMe(e){e.__index__=-1,e.__text_cache__=""}function nMe(e){return function(t,n){const r=t.slice(n);return e.test(r)?r.match(e)[0].length:0}}function y7(){return function(e,t){t.normalize(e)}}function vk(e){const t=e.re=HIe(e.__opts__),n=e.__tlds__.slice();e.onCompile(),e.__tlds_replaced__||n.push(QIe),n.push(t.src_xn),t.src_tlds=n.join("|");function r(o){return o.replace("%TLDS%",t.src_tlds)}t.email_fuzzy=RegExp(r(t.tpl_email_fuzzy),"i"),t.link_fuzzy=RegExp(r(t.tpl_link_fuzzy),"i"),t.link_no_ip_fuzzy=RegExp(r(t.tpl_link_no_ip_fuzzy),"i"),t.host_fuzzy_test=RegExp(r(t.tpl_host_fuzzy_test),"i");const s=[];e.__compiled__={};function i(o,l){throw new Error('(LinkifyIt) Invalid schema "'+o+'": '+l)}Object.keys(e.__schemas__).forEach(function(o){const l=e.__schemas__[o];if(l===null)return;const c={validate:null,link:null};if(e.__compiled__[o]=c,KIe(l)){YIe(l.validate)?c.validate=nMe(l.validate):g7(l.validate)?c.validate=l.validate:i(o,l),g7(l.normalize)?c.normalize=l.normalize:l.normalize?i(o,l):c.normalize=y7();return}if(GIe(l)){s.push(o);return}i(o,l)}),s.forEach(function(o){e.__compiled__[e.__schemas__[o]]&&(e.__compiled__[o].validate=e.__compiled__[e.__schemas__[o]].validate,e.__compiled__[o].normalize=e.__compiled__[e.__schemas__[o]].normalize)}),e.__compiled__[""]={validate:null,normalize:y7()};const a=Object.keys(e.__compiled__).filter(function(o){return o.length>0&&e.__compiled__[o]}).map(ZIe).join("|");e.re.schema_test=RegExp("(^|(?!_)(?:[><｜]|"+t.src_ZPCc+"))("+a+")","i"),e.re.schema_search=RegExp("(^|(?!_)(?:[><｜]|"+t.src_ZPCc+"))("+a+")","ig"),e.re.schema_at_start=RegExp("^"+e.re.schema_search.source,"i"),e.re.pretest=RegExp("("+e.re.schema_test.source+")|("+e.re.host_fuzzy_test.source+")|@","i"),tMe(e)}function rMe(e,t){const n=e.__index__,r=e.__last_index__,s=e.__text_cache__.slice(n,r);this.schema=e.__schema__.toLowerCase(),this.index=n+t,this.lastIndex=r+t,this.raw=s,this.text=s,this.url=s}function J3(e,t){const n=new rMe(e,t);return e.__compiled__[n.schema].normalize(n,e),n}function Cl(e,t){if(!(this instanceof Cl))return new Cl(e,t);t||XIe(e)&&(t=e,e={}),this.__opts__=X3({},NX,t),this.__index__=-1,this.__last_index__=-1,this.__schema__="",this.__text_cache__="",this.__schemas__=X3({},JIe,e),this.__compiled__={},this.__tlds__=eMe,this.__tlds_replaced__=!1,this.re={},vk(this)}Cl.prototype.add=function(t,n){return this.__schemas__[t]=n,vk(this),this};Cl.prototype.set=function(t){return this.__opts__=X3(this.__opts__,t),this};Cl.prototype.test=function(t){if(this.__text_cache__=t,this.__index__=-1,!t.length)return!1;let n,r,s,i,a,o,l,c,u;if(this.re.schema_test.test(t)){for(l=this.re.schema_search,l.lastIndex=0;(n=l.exec(t))!==null;)if(i=this.testSchemaAt(t,n[2],l.lastIndex),i){this.__schema__=n[2],this.__index__=n.index+n[1].length,this.__last_index__=n.index+n[0].length+i;break}}return this.__opts__.fuzzyLink&&this.__compiled__["http:"]&&(c=t.search(this.re.host_fuzzy_test),c>=0&&(this.__index__<0||c<this.__index__)&&(r=t.match(this.__opts__.fuzzyIP?this.re.link_fuzzy:this.re.link_no_ip_fuzzy))!==null&&(a=r.index+r[1].length,(this.__index__<0||a<this.__index__)&&(this.__schema__="",this.__index__=a,this.__last_index__=r.index+r[0].length))),this.__opts__.fuzzyEmail&&this.__compiled__["mailto:"]&&(u=t.indexOf("@"),u>=0&&(s=t.match(this.re.email_fuzzy))!==null&&(a=s.index+s[1].length,o=s.index+s[0].length,(this.__index__<0||a<this.__index__||a===this.__index__&&o>this.__last_index__)&&(this.__schema__="mailto:",this.__index__=a,this.__last_index__=o))),this.__index__>=0};Cl.prototype.pretest=function(t){return this.re.pretest.test(t)};Cl.prototype.testSchemaAt=function(t,n,r){return this.__compiled__[n.toLowerCase()]?this.__compiled__[n.toLowerCase()].validate(t,r,this):0};Cl.prototype.match=function(t){const n=[];let r=0;this.__index__>=0&&this.__text_cache__===t&&(n.push(J3(this,r)),r=this.__last_index__);let s=r?t.slice(r):t;for(;this.test(s);)n.push(J3(this,r)),s=s.slice(this.__last_index__),r+=this.__last_index__;return n.length?n:null};Cl.prototype.matchAtStart=function(t){if(this.__text_cache__=t,this.__index__=-1,!t.length)return null;const n=this.re.schema_at_start.exec(t);if(!n)return null;const r=this.testSchemaAt(t,n[2],n[0].length);return r?(this.__schema__=n[2],this.__index__=n.index+n[1].length,this.__last_index__=n.index+n[0].length+r,J3(this,0)):null};Cl.prototype.tlds=function(t,n){return t=Array.isArray(t)?t:[t],n?(this.__tlds__=this.__tlds__.concat(t).sort().filter(function(r,s,i){return r!==i[s-1]}).reverse(),vk(this),this):(this.__tlds__=t.slice(),this.__tlds_replaced__=!0,vk(this),this)};Cl.prototype.normalize=function(t){t.schema||(t.url="http://"+t.url),t.schema==="mailto:"&&!/^mailto:/i.test(t.url)&&(t.url="mailto:"+t.url)};Cl.prototype.onCompile=function(){};const W0=2147483647,Nu=36,BD=1,Fw=26,sMe=38,iMe=700,IX=72,MX=128,jX="-",aMe=/^xn--/,oMe=/[^\0-\x7F]/,lMe=/[\x2E\u3002\uFF0E\uFF61]/g,cMe={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},RM=Nu-BD,Iu=Math.floor,NM=String.fromCharCode;function vh(e){throw new RangeError(cMe[e])}function uMe(e,t){const n=[];let r=e.length;for(;r--;)n[r]=t(e[r]);return n}function PX(e,t){const n=e.split("@");let r="";n.length>1&&(r=n[0]+"@",e=n[1]),e=e.replace(lMe,".");const s=e.split("."),i=uMe(s,t).join(".");return r+i}function OX(e){const t=[];let n=0;const r=e.length;for(;n<r;){const s=e.charCodeAt(n++);if(s>=55296&&s<=56319&&n<r){const i=e.charCodeAt(n++);(i&64512)==56320?t.push(((s&1023)<<10)+(i&1023)+65536):(t.push(s),n--)}else t.push(s)}return t}const dMe=e=>String.fromCodePoint(...e),fMe=function(e){return e>=48&&e<58?26+(e-48):e>=65&&e<91?e-65:e>=97&&e<123?e-97:Nu},b7=function(e,t){return e+22+75*(e<26)-((t!=0)<<5)},DX=function(e,t,n){let r=0;for(e=n?Iu(e/iMe):e>>1,e+=Iu(e/t);e>RM*Fw>>1;r+=Nu)e=Iu(e/RM);return Iu(r+(RM+1)*e/(e+sMe))},FX=function(e){const t=[],n=e.length;let r=0,s=MX,i=IX,a=e.lastIndexOf(jX);a<0&&(a=0);for(let o=0;o<a;++o)e.charCodeAt(o)>=128&&vh("not-basic"),t.push(e.charCodeAt(o));for(let o=a>0?a+1:0;o<n;){const l=r;for(let u=1,d=Nu;;d+=Nu){o>=n&&vh("invalid-input");const h=fMe(e.charCodeAt(o++));h>=Nu&&vh("invalid-input"),h>Iu((W0-r)/u)&&vh("overflow"),r+=h*u;const m=d<=i?BD:d>=i+Fw?Fw:d-i;if(h<m)break;const y=Nu-m;u>Iu(W0/y)&&vh("overflow"),u*=y}const c=t.length+1;i=DX(r-l,c,l==0),Iu(r/c)>W0-s&&vh("overflow"),s+=Iu(r/c),r%=c,t.splice(r++,0,s)}return String.fromCodePoint(...t)},LX=function(e){const t=[];e=OX(e);const n=e.length;let r=MX,s=0,i=IX;for(const l of e)l<128&&t.push(NM(l));const a=t.length;let o=a;for(a&&t.push(jX);o<n;){let l=W0;for(const u of e)u>=r&&u<l&&(l=u);const c=o+1;l-r>Iu((W0-s)/c)&&vh("overflow"),s+=(l-r)*c,r=l;for(const u of e)if(u<r&&++s>W0&&vh("overflow"),u===r){let d=s;for(let h=Nu;;h+=Nu){const m=h<=i?BD:h>=i+Fw?Fw:h-i;if(d<m)break;const y=d-m,b=Nu-m;t.push(NM(b7(m+y%b,0))),d=Iu(y/b)}t.push(NM(b7(d,0))),i=DX(s,c,o===a),s=0,++o}++s,++r}return t.join("")},hMe=function(e){return PX(e,function(t){return aMe.test(t)?FX(t.slice(4).toLowerCase()):t})},pMe=function(e){return PX(e,function(t){return oMe.test(t)?"xn--"+LX(t):t})},BX={version:"2.3.1",ucs2:{decode:OX,encode:dMe},decode:FX,encode:LX,toASCII:pMe,toUnicode:hMe},mMe={options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"“”‘’",highlight:null,maxNesting:100},components:{core:{},block:{},inline:{}}},gMe={options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"“”‘’",highlight:null,maxNesting:20},components:{core:{rules:["normalize","block","inline","text_join"]},block:{rules:["paragraph"]},inline:{rules:["text"],rules2:["balance_pairs","fragments_join"]}}},yMe={options:{html:!0,xhtmlOut:!0,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"“”‘’",highlight:null,maxNesting:20},components:{core:{rules:["normalize","block","inline","text_join"]},block:{rules:["blockquote","code","fence","heading","hr","html_block","lheading","list","reference","paragraph"]},inline:{rules:["autolink","backticks","emphasis","entity","escape","html_inline","image","link","newline","text"],rules2:["balance_pairs","emphasis","fragments_join"]}}},bMe={default:mMe,zero:gMe,commonmark:yMe},vMe=/^(vbscript|javascript|file|data):/,xMe=/^data:image\/(gif|png|jpeg|webp);/;function wMe(e){const t=e.trim().toLowerCase();return vMe.test(t)?xMe.test(t):!0}const $X=["http:","https:","mailto:"];function SMe(e){const t=jD(e,!0);if(t.hostname&&(!t.protocol||$X.indexOf(t.protocol)>=0))try{t.hostname=BX.toASCII(t.hostname)}catch{}return rS(MD(t))}function _Me(e){const t=jD(e,!0);if(t.hostname&&(!t.protocol||$X.indexOf(t.protocol)>=0))try{t.hostname=BX.toUnicode(t.hostname)}catch{}return My(MD(t),My.defaultChars+"%")}function Zo(e,t){if(!(this instanceof Zo))return new Zo(e,t);t||OD(e)||(t=e||{},e="default"),this.inline=new iS,this.block=new CT,this.core=new FD,this.renderer=new xb,this.linkify=new Cl,this.validateLink=wMe,this.normalizeLink=SMe,this.normalizeLinkText=_Me,this.utils=kNe,this.helpers=ST({},RNe),this.options={},this.configure(e),t&&this.set(t)}Zo.prototype.set=function(e){return ST(this.options,e),this};Zo.prototype.configure=function(e){const t=this;if(OD(e)){const n=e;if(e=bMe[n],!e)throw new Error('Wrong `markdown-it` preset "'+n+'", check name')}if(!e)throw new Error("Wrong `markdown-it` preset, can't be empty");return e.options&&t.set(e.options),e.components&&Object.keys(e.components).forEach(function(n){e.components[n].rules&&t[n].ruler.enableOnly(e.components[n].rules),e.components[n].rules2&&t[n].ruler2.enableOnly(e.components[n].rules2)}),this};Zo.prototype.enable=function(e,t){let n=[];Array.isArray(e)||(e=[e]),["core","block","inline"].forEach(function(s){n=n.concat(this[s].ruler.enable(e,!0))},this),n=n.concat(this.inline.ruler2.enable(e,!0));const r=e.filter(function(s){return n.indexOf(s)<0});if(r.length&&!t)throw new Error("MarkdownIt. Failed to enable unknown rule(s): "+r);return this};Zo.prototype.disable=function(e,t){let n=[];Array.isArray(e)||(e=[e]),["core","block","inline"].forEach(function(s){n=n.concat(this[s].ruler.disable(e,!0))},this),n=n.concat(this.inline.ruler2.disable(e,!0));const r=e.filter(function(s){return n.indexOf(s)<0});if(r.length&&!t)throw new Error("MarkdownIt. Failed to disable unknown rule(s): "+r);return this};Zo.prototype.use=function(e){const t=[this].concat(Array.prototype.slice.call(arguments,1));return e.apply(e,t),this};Zo.prototype.parse=function(e,t){if(typeof e!="string")throw new Error("Input data should be a String");const n=new this.core.State(e,this,t);return this.core.process(n),n.tokens};Zo.prototype.render=function(e,t){return t=t||{},this.renderer.render(this.parse(e,t),this.options,t)};Zo.prototype.parseInline=function(e,t){const n=new this.core.State(e,this,t);return n.inlineMode=!0,this.core.process(n),n.tokens};Zo.prototype.renderInline=function(e,t){return t=t||{},this.renderer.render(this.parseInline(e,t),this.options,t)};const IM=new Zo({html:!1,linkify:!0,breaks:!0});function ET(e){return E.useMemo(()=>{var n;if(!e)return[];try{const r=IM.parse(e,{}),s=[];let i="",a=0;for(;a<r.length;){const o=r[a];if(o.type==="fence"){i&&(s.push(i),i="");const l=((n=o.info)==null?void 0:n.trim())||"";let c,u;if(l.includes(":")){const[d,...h]=l.split(":");c=d||void 0,u=h.join(":")||void 0}else c=l.split(" ")[0]||void 0;s.push({type:"block",lang:c,code:o.content,filepath:u}),a++}else{const l=[];for(;a<r.length&&r[a].type!=="fence";)l.push(r[a]),a++;l.length>0&&(i+=IM.renderer.render(l,IM.options,{}))}}return i&&s.push(i),s}catch(r){return console.error("Markdown parsing error:",r),[`<pre>${String(e??"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}</pre>`]}},[e])}const CMe=({markdownContent:e,interactionId:t})=>{const n=ET(e);return e!=null&&e.trim()?f.jsx("div",{className:"overflow-wrap-anywhere",children:n.map((r,s)=>typeof r=="string"?f.jsx("div",{className:"markdown-content",dangerouslySetInnerHTML:{__html:r}},`html-${s}`):r.type==="block"?f.jsx(ib,{lang:r.lang,code:r.code,filepath:r.filepath,interactionId:t},`block-${s}`):null)}):null},Lw=Ve.memo(({turnData:e,timestamp:t,className:n,isAssistantComplete:r=!0,interactionId:s})=>{var v,x;const i=pr(w=>w.foldUserMessagesOnCompletion),[a,o]=E.useState(r&&i),[l,c]=E.useState(!1);E.useEffect(()=>{r&&i&&o(!0)},[r,i]);const u=t?pX(new Date(t),{addSuffix:!0}):"Sending...",d=((v=e.metadata)==null?void 0:v.attachedFiles)&&e.metadata.attachedFiles.length>0,h=e.content&&e.content.trim().length>0,m=E.useCallback(()=>o(w=>!w),[]),y=E.useCallback(async()=>{if(e.content)try{await navigator.clipboard.writeText(e.content),c(!0),ke.success("User prompt copied!"),setTimeout(()=>c(!1),1500)}catch(w){ke.error("Failed to copy prompt."),console.error("Clipboard copy failed:",w)}},[e.content]),b=E.useMemo(()=>{var _;let w="";return h&&(w+=`"${e.content.substring(0,50)}${e.content.length>50?"...":""}"`),h&&d&&(w+=" + "),d&&(w+=`${(_=e.metadata.attachedFiles)==null?void 0:_.length} file(s)`),w||"[Empty Prompt]"},[h,d,e.content,e.metadata]);return f.jsxs("div",{className:Ye("user-prompt relative group/user overflow-wrap-anywhere",n),children:[f.jsxs("div",{className:Ye("flex flex-col sm:flex-row justify-between items-start mb-2 sticky top-0 bg-card/80 backdrop-blur-sm z-10 p-1 -m-1 rounded-t"),children:[f.jsxs("div",{className:"flex items-center gap-1 mb-1 sm:mb-0",children:[f.jsx(C0e,{className:"h-4 w-4 text-primary flex-shrink-0"}),f.jsx("span",{className:"text-xs font-semibold text-primary mr-1",children:"User"}),f.jsxs("div",{className:"flex items-center gap-0.5 opacity-0 group-hover/user:opacity-100 focus-within:opacity-100 transition-opacity",children:[h&&f.jsx(Un,{tooltipText:"Copy Prompt",onClick:y,"aria-label":"Copy user prompt",icon:l?f.jsx(bo,{className:"text-green-500"}):f.jsx(TE,{}),className:"h-5 w-5"}),(h||d)&&f.jsx(Un,{tooltipText:a?"Unfold":"Fold",onClick:m,"aria-label":a?"Unfold prompt":"Fold prompt",icon:a?f.jsx(uc,{}):f.jsx(tp,{}),iconClassName:"h-3.5 w-3.5",className:"h-5 w-5"})]})]}),f.jsx("div",{className:"flex items-center flex-shrink-0 self-end sm:self-start",children:f.jsx("span",{className:"text-xs text-muted-foreground",children:u})})]}),!a&&f.jsxs(f.Fragment,{children:[d&&f.jsx("div",{className:"mb-2 space-y-1",children:(x=e.metadata.attachedFiles)==null?void 0:x.map(w=>f.jsx(XZ,{fileMeta:w,isReadOnly:!0},w.id))}),f.jsx(CMe,{markdownContent:e.content,interactionId:s})]}),a&&f.jsx("div",{className:"text-xs text-muted-foreground italic cursor-pointer hover:bg-muted/20 p-1 rounded",onClick:m,children:b})]})});Lw.displayName="UserPromptDisplay";const kMe=(e,t,n,r)=>typeof e=="string"?e.trim()?f.jsx("div",{className:"markdown-content",dangerouslySetInnerHTML:{__html:e}},`html-${t}`):null:e.type==="block"?f.jsx(ib,{lang:e.lang,code:e.code,filepath:e.filepath,isStreaming:n,interactionId:r},`block-${t}`):null,EMe=({interactionId:e,markdownContent:t,isStreaming:n=!1,className:r})=>{const{enableStreamingMarkdown:s}=pr(mn(h=>({enableStreamingMarkdown:h.enableStreamingMarkdown}))),i=ET(s?t:null),a=Bi(mn(h=>Object.values(h.canvasControls))),o=E.useCallback((h,m)=>a.filter(y=>y.type==="tool-call-step"&&y.targetSlot===h&&y.renderer).map(y=>y.renderer?f.jsx(Ve.Fragment,{children:y.renderer(m)},y.id):null).filter(Boolean),[a]),{toolCallStrings:l,toolResultStrings:c}=nn(mn(h=>{var y,b;const m=h.interactions.find(v=>v.id===e);return{toolCallStrings:(y=m==null?void 0:m.metadata)==null?void 0:y.toolCalls,toolResultStrings:(b=m==null?void 0:m.metadata)==null?void 0:b.toolResults}})),u=E.useMemo(()=>{if(!l)return[];try{const h=l.map(y=>JSON.parse(y)),m=(c==null?void 0:c.map(y=>JSON.parse(y)))??[];return h.map(y=>{const b=m.find(v=>v.toolCallId===y.toolCallId);return{call:y,result:b}})}catch(h){return console.error("[StreamingContentView] Error parsing tool call/result strings:",h),[]}},[l,c]),d=E.useMemo(()=>s?i.map((h,m)=>kMe(h,m,n&&m===i.length-1,e)).filter(Boolean):[],[s,i,n,e]);return!s&&!t&&u.length===0?n?f.jsx("div",{className:Ye("text-muted-foreground italic",r),children:"Generating response..."}):null:f.jsxs("div",{className:Ye("streaming-content-view overflow-wrap-anywhere",r),children:[u.map(({call:h,result:m},y)=>{const b={interactionId:e,toolCall:h,toolResult:m,canvasContextType:"tool-call-step"};return f.jsx(Ve.Fragment,{children:o("tool-call-content",b)},`tool-step-${h.toolCallId||y}`)}),s?d:t?f.jsx("div",{className:"markdown-content",dangerouslySetInnerHTML:{__html:new Zo().render(t)}}):null]})},TMe=({onStop:e,className:t,size:n="icon",variant:r="ghost","aria-label":s="Stop Generation"})=>f.jsx(Un,{tooltipText:"Stop",onClick:e,"aria-label":s,icon:f.jsx(f0e,{}),variant:r,size:n,className:t}),AMe="modulepreload",RMe=function(e){return"/"+e},v7={},Fr=function(t,n,r){let s=Promise.resolve();if(n&&n.length>0){let a=function(c){return Promise.all(c.map(u=>Promise.resolve(u).then(d=>({status:"fulfilled",value:d}),d=>({status:"rejected",reason:d}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));s=a(n.map(c=>{if(c=RMe(c),c in v7)return;v7[c]=!0;const u=c.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${d}`))return;const h=document.createElement("link");if(h.rel=u?"stylesheet":AMe,u||(h.as="script"),h.crossOrigin="",h.href=c,l&&h.setAttribute("nonce",l),document.head.appendChild(h),u)return new Promise((m,y)=>{h.addEventListener("load",m),h.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return s.then(a=>{for(const o of a||[])o.status==="rejected"&&i(o.reason);return t().catch(i)})},NMe=Symbol("Let zodToJsonSchema decide on which parser to use"),x7={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",allowedAdditionalProperties:!0,rejectedAdditionalProperties:!1,definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"},IMe=e=>typeof e=="string"?{...x7,name:e}:{...x7,...e},MMe=e=>{const t=IMe(e),n=t.name!==void 0?[...t.basePath,t.definitionPath,t.name]:t.basePath;return{...t,currentPath:n,propertyPath:void 0,seen:new Map(Object.entries(t.definitions).map(([r,s])=>[s._def,{def:s._def,path:[...t.basePath,t.definitionPath,r],jsonSchema:void 0}]))}};function zX(e,t,n,r){r!=null&&r.errorMessages&&n&&(e.errorMessage={...e.errorMessage,[t]:n})}function Ss(e,t,n,r,s){e[t]=n,zX(e,t,r,s)}function jMe(){return{}}function PMe(e,t){var r,s,i;const n={type:"array"};return(r=e.type)!=null&&r._def&&((i=(s=e.type)==null?void 0:s._def)==null?void 0:i.typeName)!==tn.ZodAny&&(n.items=cs(e.type._def,{...t,currentPath:[...t.currentPath,"items"]})),e.minLength&&Ss(n,"minItems",e.minLength.value,e.minLength.message,t),e.maxLength&&Ss(n,"maxItems",e.maxLength.value,e.maxLength.message,t),e.exactLength&&(Ss(n,"minItems",e.exactLength.value,e.exactLength.message,t),Ss(n,"maxItems",e.exactLength.value,e.exactLength.message,t)),n}function OMe(e,t){const n={type:"integer",format:"int64"};if(!e.checks)return n;for(const r of e.checks)switch(r.kind){case"min":t.target==="jsonSchema7"?r.inclusive?Ss(n,"minimum",r.value,r.message,t):Ss(n,"exclusiveMinimum",r.value,r.message,t):(r.inclusive||(n.exclusiveMinimum=!0),Ss(n,"minimum",r.value,r.message,t));break;case"max":t.target==="jsonSchema7"?r.inclusive?Ss(n,"maximum",r.value,r.message,t):Ss(n,"exclusiveMaximum",r.value,r.message,t):(r.inclusive||(n.exclusiveMaximum=!0),Ss(n,"maximum",r.value,r.message,t));break;case"multipleOf":Ss(n,"multipleOf",r.value,r.message,t);break}return n}function DMe(){return{type:"boolean"}}function UX(e,t){return cs(e.type._def,t)}const FMe=(e,t)=>cs(e.innerType._def,t);function qX(e,t,n){const r=n??t.dateStrategy;if(Array.isArray(r))return{anyOf:r.map((s,i)=>qX(e,t,s))};switch(r){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return LMe(e,t)}}const LMe=(e,t)=>{const n={type:"integer",format:"unix-time"};if(t.target==="openApi3")return n;for(const r of e.checks)switch(r.kind){case"min":Ss(n,"minimum",r.value,r.message,t);break;case"max":Ss(n,"maximum",r.value,r.message,t);break}return n};function BMe(e,t){return{...cs(e.innerType._def,t),default:e.defaultValue()}}function $Me(e,t){return t.effectStrategy==="input"?cs(e.schema._def,t):{}}function zMe(e){return{type:"string",enum:Array.from(e.values)}}const UMe=e=>"type"in e&&e.type==="string"?!1:"allOf"in e;function qMe(e,t){const n=[cs(e.left._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),cs(e.right._def,{...t,currentPath:[...t.currentPath,"allOf","1"]})].filter(i=>!!i);let r=t.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0;const s=[];return n.forEach(i=>{if(UMe(i))s.push(...i.allOf),i.unevaluatedProperties===void 0&&(r=void 0);else{let a=i;if("additionalProperties"in i&&i.additionalProperties===!1){const{additionalProperties:o,...l}=i;a=l}else r=void 0;s.push(a)}}),s.length?{allOf:s,...r}:void 0}function VMe(e,t){const n=typeof e.value;return n!=="bigint"&&n!=="number"&&n!=="boolean"&&n!=="string"?{type:Array.isArray(e.value)?"array":"object"}:t.target==="openApi3"?{type:n==="bigint"?"integer":n,enum:[e.value]}:{type:n==="bigint"?"integer":n,const:e.value}}let MM;const kc={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(MM===void 0&&(MM=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),MM),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv4Cidr:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,ipv6Cidr:/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,base64url:/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/,jwt:/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/};function VX(e,t){const n={type:"string"};if(e.checks)for(const r of e.checks)switch(r.kind){case"min":Ss(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,r.value):r.value,r.message,t);break;case"max":Ss(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,r.value):r.value,r.message,t);break;case"email":switch(t.emailStrategy){case"format:email":Ec(n,"email",r.message,t);break;case"format:idn-email":Ec(n,"idn-email",r.message,t);break;case"pattern:zod":ro(n,kc.email,r.message,t);break}break;case"url":Ec(n,"uri",r.message,t);break;case"uuid":Ec(n,"uuid",r.message,t);break;case"regex":ro(n,r.regex,r.message,t);break;case"cuid":ro(n,kc.cuid,r.message,t);break;case"cuid2":ro(n,kc.cuid2,r.message,t);break;case"startsWith":ro(n,RegExp(`^${jM(r.value,t)}`),r.message,t);break;case"endsWith":ro(n,RegExp(`${jM(r.value,t)}$`),r.message,t);break;case"datetime":Ec(n,"date-time",r.message,t);break;case"date":Ec(n,"date",r.message,t);break;case"time":Ec(n,"time",r.message,t);break;case"duration":Ec(n,"duration",r.message,t);break;case"length":Ss(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,r.value):r.value,r.message,t),Ss(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,r.value):r.value,r.message,t);break;case"includes":{ro(n,RegExp(jM(r.value,t)),r.message,t);break}case"ip":{r.version!=="v6"&&Ec(n,"ipv4",r.message,t),r.version!=="v4"&&Ec(n,"ipv6",r.message,t);break}case"base64url":ro(n,kc.base64url,r.message,t);break;case"jwt":ro(n,kc.jwt,r.message,t);break;case"cidr":{r.version!=="v6"&&ro(n,kc.ipv4Cidr,r.message,t),r.version!=="v4"&&ro(n,kc.ipv6Cidr,r.message,t);break}case"emoji":ro(n,kc.emoji(),r.message,t);break;case"ulid":{ro(n,kc.ulid,r.message,t);break}case"base64":{switch(t.base64Strategy){case"format:binary":{Ec(n,"binary",r.message,t);break}case"contentEncoding:base64":{Ss(n,"contentEncoding","base64",r.message,t);break}case"pattern:zod":{ro(n,kc.base64,r.message,t);break}}break}case"nanoid":ro(n,kc.nanoid,r.message,t)}return n}function jM(e,t){return t.patternStrategy==="escape"?HMe(e):e}const WMe=new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function HMe(e){let t="";for(let n=0;n<e.length;n++)WMe.has(e[n])||(t+="\\"),t+=e[n];return t}function Ec(e,t,n,r){var s;e.format||(s=e.anyOf)!=null&&s.some(i=>i.format)?(e.anyOf||(e.anyOf=[]),e.format&&(e.anyOf.push({format:e.format,...e.errorMessage&&r.errorMessages&&{errorMessage:{format:e.errorMessage.format}}}),delete e.format,e.errorMessage&&(delete e.errorMessage.format,Object.keys(e.errorMessage).length===0&&delete e.errorMessage)),e.anyOf.push({format:t,...n&&r.errorMessages&&{errorMessage:{format:n}}})):Ss(e,"format",t,n,r)}function ro(e,t,n,r){var s;e.pattern||(s=e.allOf)!=null&&s.some(i=>i.pattern)?(e.allOf||(e.allOf=[]),e.pattern&&(e.allOf.push({pattern:e.pattern,...e.errorMessage&&r.errorMessages&&{errorMessage:{pattern:e.errorMessage.pattern}}}),delete e.pattern,e.errorMessage&&(delete e.errorMessage.pattern,Object.keys(e.errorMessage).length===0&&delete e.errorMessage)),e.allOf.push({pattern:w7(t,r),...n&&r.errorMessages&&{errorMessage:{pattern:n}}})):Ss(e,"pattern",w7(t,r),n,r)}function w7(e,t){var l;if(!t.applyRegexFlags||!e.flags)return e.source;const n={i:e.flags.includes("i"),m:e.flags.includes("m"),s:e.flags.includes("s")},r=n.i?e.source.toLowerCase():e.source;let s="",i=!1,a=!1,o=!1;for(let c=0;c<r.length;c++){if(i){s+=r[c],i=!1;continue}if(n.i){if(a){if(r[c].match(/[a-z]/)){o?(s+=r[c],s+=`${r[c-2]}-${r[c]}`.toUpperCase(),o=!1):r[c+1]==="-"&&((l=r[c+2])!=null&&l.match(/[a-z]/))?(s+=r[c],o=!0):s+=`${r[c]}${r[c].toUpperCase()}`;continue}}else if(r[c].match(/[a-z]/)){s+=`[${r[c]}${r[c].toUpperCase()}]`;continue}}if(n.m){if(r[c]==="^"){s+=`(^|(?<=[\r
]))`;continue}else if(r[c]==="$"){s+=`($|(?=[\r
]))`;continue}}if(n.s&&r[c]==="."){s+=a?`${r[c]}\r
`:`[${r[c]}\r
]`;continue}s+=r[c],r[c]==="\\"?i=!0:a&&r[c]==="]"?a=!1:!a&&r[c]==="["&&(a=!0)}try{new RegExp(s)}catch{return console.warn(`Could not convert regex pattern at ${t.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),e.source}return s}function WX(e,t){var r,s,i,a,o,l;if(t.target==="openAi"&&console.warn("Warning: OpenAI may not support records in schemas! Try an array of key-value pairs instead."),t.target==="openApi3"&&((r=e.keyType)==null?void 0:r._def.typeName)===tn.ZodEnum)return{type:"object",required:e.keyType._def.values,properties:e.keyType._def.values.reduce((c,u)=>({...c,[u]:cs(e.valueType._def,{...t,currentPath:[...t.currentPath,"properties",u]})??{}}),{}),additionalProperties:t.rejectedAdditionalProperties};const n={type:"object",additionalProperties:cs(e.valueType._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??t.allowedAdditionalProperties};if(t.target==="openApi3")return n;if(((s=e.keyType)==null?void 0:s._def.typeName)===tn.ZodString&&((i=e.keyType._def.checks)!=null&&i.length)){const{type:c,...u}=VX(e.keyType._def,t);return{...n,propertyNames:u}}else{if(((a=e.keyType)==null?void 0:a._def.typeName)===tn.ZodEnum)return{...n,propertyNames:{enum:e.keyType._def.values}};if(((o=e.keyType)==null?void 0:o._def.typeName)===tn.ZodBranded&&e.keyType._def.type._def.typeName===tn.ZodString&&((l=e.keyType._def.type._def.checks)!=null&&l.length)){const{type:c,...u}=UX(e.keyType._def,t);return{...n,propertyNames:u}}}return n}function GMe(e,t){if(t.mapStrategy==="record")return WX(e,t);const n=cs(e.keyType._def,{...t,currentPath:[...t.currentPath,"items","items","0"]})||{},r=cs(e.valueType._def,{...t,currentPath:[...t.currentPath,"items","items","1"]})||{};return{type:"array",maxItems:125,items:{type:"array",items:[n,r],minItems:2,maxItems:2}}}function KMe(e){const t=e.values,r=Object.keys(e.values).filter(i=>typeof t[t[i]]!="number").map(i=>t[i]),s=Array.from(new Set(r.map(i=>typeof i)));return{type:s.length===1?s[0]==="string"?"string":"number":["string","number"],enum:r}}function YMe(){return{not:{}}}function ZMe(e){return e.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}const xk={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function XMe(e,t){if(t.target==="openApi3")return S7(e,t);const n=e.options instanceof Map?Array.from(e.options.values()):e.options;if(n.every(r=>r._def.typeName in xk&&(!r._def.checks||!r._def.checks.length))){const r=n.reduce((s,i)=>{const a=xk[i._def.typeName];return a&&!s.includes(a)?[...s,a]:s},[]);return{type:r.length>1?r:r[0]}}else if(n.every(r=>r._def.typeName==="ZodLiteral"&&!r.description)){const r=n.reduce((s,i)=>{const a=typeof i._def.value;switch(a){case"string":case"number":case"boolean":return[...s,a];case"bigint":return[...s,"integer"];case"object":if(i._def.value===null)return[...s,"null"];case"symbol":case"undefined":case"function":default:return s}},[]);if(r.length===n.length){const s=r.filter((i,a,o)=>o.indexOf(i)===a);return{type:s.length>1?s:s[0],enum:n.reduce((i,a)=>i.includes(a._def.value)?i:[...i,a._def.value],[])}}}else if(n.every(r=>r._def.typeName==="ZodEnum"))return{type:"string",enum:n.reduce((r,s)=>[...r,...s._def.values.filter(i=>!r.includes(i))],[])};return S7(e,t)}const S7=(e,t)=>{const n=(e.options instanceof Map?Array.from(e.options.values()):e.options).map((r,s)=>cs(r._def,{...t,currentPath:[...t.currentPath,"anyOf",`${s}`]})).filter(r=>!!r&&(!t.strictUnions||typeof r=="object"&&Object.keys(r).length>0));return n.length?{anyOf:n}:void 0};function JMe(e,t){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(e.innerType._def.typeName)&&(!e.innerType._def.checks||!e.innerType._def.checks.length))return t.target==="openApi3"?{type:xk[e.innerType._def.typeName],nullable:!0}:{type:[xk[e.innerType._def.typeName],"null"]};if(t.target==="openApi3"){const r=cs(e.innerType._def,{...t,currentPath:[...t.currentPath]});return r&&"$ref"in r?{allOf:[r],nullable:!0}:r&&{...r,nullable:!0}}const n=cs(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","0"]});return n&&{anyOf:[n,{type:"null"}]}}function QMe(e,t){const n={type:"number"};if(!e.checks)return n;for(const r of e.checks)switch(r.kind){case"int":n.type="integer",zX(n,"type",r.message,t);break;case"min":t.target==="jsonSchema7"?r.inclusive?Ss(n,"minimum",r.value,r.message,t):Ss(n,"exclusiveMinimum",r.value,r.message,t):(r.inclusive||(n.exclusiveMinimum=!0),Ss(n,"minimum",r.value,r.message,t));break;case"max":t.target==="jsonSchema7"?r.inclusive?Ss(n,"maximum",r.value,r.message,t):Ss(n,"exclusiveMaximum",r.value,r.message,t):(r.inclusive||(n.exclusiveMaximum=!0),Ss(n,"maximum",r.value,r.message,t));break;case"multipleOf":Ss(n,"multipleOf",r.value,r.message,t);break}return n}function eje(e,t){const n=t.target==="openAi",r={type:"object",properties:{}},s=[],i=e.shape();for(const o in i){let l=i[o];if(l===void 0||l._def===void 0)continue;let c=nje(l);c&&n&&(l instanceof Pu&&(l=l._def.innerType),l.isNullable()||(l=l.nullable()),c=!1);const u=cs(l._def,{...t,currentPath:[...t.currentPath,"properties",o],propertyPath:[...t.currentPath,"properties",o]});u!==void 0&&(r.properties[o]=u,c||s.push(o))}s.length&&(r.required=s);const a=tje(e,t);return a!==void 0&&(r.additionalProperties=a),r}function tje(e,t){if(e.catchall._def.typeName!=="ZodNever")return cs(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]});switch(e.unknownKeys){case"passthrough":return t.allowedAdditionalProperties;case"strict":return t.rejectedAdditionalProperties;case"strip":return t.removeAdditionalStrategy==="strict"?t.allowedAdditionalProperties:t.rejectedAdditionalProperties}}function nje(e){try{return e.isOptional()}catch{return!0}}const rje=(e,t)=>{var r;if(t.currentPath.toString()===((r=t.propertyPath)==null?void 0:r.toString()))return cs(e.innerType._def,t);const n=cs(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","1"]});return n?{anyOf:[{not:{}},n]}:{}},sje=(e,t)=>{if(t.pipeStrategy==="input")return cs(e.in._def,t);if(t.pipeStrategy==="output")return cs(e.out._def,t);const n=cs(e.in._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),r=cs(e.out._def,{...t,currentPath:[...t.currentPath,"allOf",n?"1":"0"]});return{allOf:[n,r].filter(s=>s!==void 0)}};function ije(e,t){return cs(e.type._def,t)}function aje(e,t){const r={type:"array",uniqueItems:!0,items:cs(e.valueType._def,{...t,currentPath:[...t.currentPath,"items"]})};return e.minSize&&Ss(r,"minItems",e.minSize.value,e.minSize.message,t),e.maxSize&&Ss(r,"maxItems",e.maxSize.value,e.maxSize.message,t),r}function oje(e,t){return e.rest?{type:"array",minItems:e.items.length,items:e.items.map((n,r)=>cs(n._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[]),additionalItems:cs(e.rest._def,{...t,currentPath:[...t.currentPath,"additionalItems"]})}:{type:"array",minItems:e.items.length,maxItems:e.items.length,items:e.items.map((n,r)=>cs(n._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[])}}function lje(){return{not:{}}}function cje(){return{}}const uje=(e,t)=>cs(e.innerType._def,t),dje=(e,t,n)=>{switch(t){case tn.ZodString:return VX(e,n);case tn.ZodNumber:return QMe(e,n);case tn.ZodObject:return eje(e,n);case tn.ZodBigInt:return OMe(e,n);case tn.ZodBoolean:return DMe();case tn.ZodDate:return qX(e,n);case tn.ZodUndefined:return lje();case tn.ZodNull:return ZMe(n);case tn.ZodArray:return PMe(e,n);case tn.ZodUnion:case tn.ZodDiscriminatedUnion:return XMe(e,n);case tn.ZodIntersection:return qMe(e,n);case tn.ZodTuple:return oje(e,n);case tn.ZodRecord:return WX(e,n);case tn.ZodLiteral:return VMe(e,n);case tn.ZodEnum:return zMe(e);case tn.ZodNativeEnum:return KMe(e);case tn.ZodNullable:return JMe(e,n);case tn.ZodOptional:return rje(e,n);case tn.ZodMap:return GMe(e,n);case tn.ZodSet:return aje(e,n);case tn.ZodLazy:return()=>e.getter()._def;case tn.ZodPromise:return ije(e,n);case tn.ZodNaN:case tn.ZodNever:return YMe();case tn.ZodEffects:return $Me(e,n);case tn.ZodAny:return jMe();case tn.ZodUnknown:return cje();case tn.ZodDefault:return BMe(e,n);case tn.ZodBranded:return UX(e,n);case tn.ZodReadonly:return uje(e,n);case tn.ZodCatch:return FMe(e,n);case tn.ZodPipeline:return sje(e,n);case tn.ZodFunction:case tn.ZodVoid:case tn.ZodSymbol:return;default:return(r=>{})()}};function cs(e,t,n=!1){var o;const r=t.seen.get(e);if(t.override){const l=(o=t.override)==null?void 0:o.call(t,e,t,r,n);if(l!==NMe)return l}if(r&&!n){const l=fje(r,t);if(l!==void 0)return l}const s={def:e,path:t.currentPath,jsonSchema:void 0};t.seen.set(e,s);const i=dje(e,e.typeName,t),a=typeof i=="function"?cs(i(),t):i;if(a&&pje(e,t,a),t.postProcess){const l=t.postProcess(a,e,t);return s.jsonSchema=a,l}return s.jsonSchema=a,a}const fje=(e,t)=>{switch(t.$refStrategy){case"root":return{$ref:e.path.join("/")};case"relative":return{$ref:hje(t.currentPath,e.path)};case"none":case"seen":return e.path.length<t.currentPath.length&&e.path.every((n,r)=>t.currentPath[r]===n)?(console.warn(`Recursive reference detected at ${t.currentPath.join("/")}! Defaulting to any`),{}):t.$refStrategy==="seen"?{}:void 0}},hje=(e,t)=>{let n=0;for(;n<e.length&&n<t.length&&e[n]===t[n];n++);return[(e.length-n).toString(),...t.slice(n)].join("/")},pje=(e,t,n)=>(e.description&&(n.description=e.description,t.markdownDescription&&(n.markdownDescription=e.description)),n),mje=(e,t)=>{const n=MMe(t),r=typeof t=="object"&&t.definitions?Object.entries(t.definitions).reduce((l,[c,u])=>({...l,[c]:cs(u._def,{...n,currentPath:[...n.basePath,n.definitionPath,c]},!0)??{}}),{}):void 0,s=typeof t=="string"?t:(t==null?void 0:t.nameStrategy)==="title"||t==null?void 0:t.name,i=cs(e._def,s===void 0?n:{...n,currentPath:[...n.basePath,n.definitionPath,s]},!1)??{},a=typeof t=="object"&&t.name!==void 0&&t.nameStrategy==="title"?t.name:void 0;a!==void 0&&(i.title=a);const o=s===void 0?r?{...i,[n.definitionPath]:r}:i:{$ref:[...n.$refStrategy==="relative"?[]:n.basePath,n.definitionPath,s].join("/"),[n.definitionPath]:{...r,[s]:i}};return n.target==="jsonSchema7"?o.$schema="http://json-schema.org/draft-07/schema#":(n.target==="jsonSchema2019-09"||n.target==="openAi")&&(o.$schema="https://json-schema.org/draft/2019-09/schema#"),n.target==="openAi"&&("anyOf"in o||"oneOf"in o||"allOf"in o||"type"in o&&Array.isArray(o.type))&&console.warn("Warning: OpenAI may not support schemas with unions as roots! Try wrapping it in an object property."),o};var Bw={code:"0",name:"text",parse:e=>{if(typeof e!="string")throw new Error('"text" parts expect a string value.');return{type:"text",value:e}}},$w={code:"3",name:"error",parse:e=>{if(typeof e!="string")throw new Error('"error" parts expect a string value.');return{type:"error",value:e}}},zw={code:"4",name:"assistant_message",parse:e=>{if(e==null||typeof e!="object"||!("id"in e)||!("role"in e)||!("content"in e)||typeof e.id!="string"||typeof e.role!="string"||e.role!=="assistant"||!Array.isArray(e.content)||!e.content.every(t=>t!=null&&typeof t=="object"&&"type"in t&&t.type==="text"&&"text"in t&&t.text!=null&&typeof t.text=="object"&&"value"in t.text&&typeof t.text.value=="string"))throw new Error('"assistant_message" parts expect an object with an "id", "role", and "content" property.');return{type:"assistant_message",value:e}}},Uw={code:"5",name:"assistant_control_data",parse:e=>{if(e==null||typeof e!="object"||!("threadId"in e)||!("messageId"in e)||typeof e.threadId!="string"||typeof e.messageId!="string")throw new Error('"assistant_control_data" parts expect an object with a "threadId" and "messageId" property.');return{type:"assistant_control_data",value:{threadId:e.threadId,messageId:e.messageId}}}},qw={code:"6",name:"data_message",parse:e=>{if(e==null||typeof e!="object"||!("role"in e)||!("data"in e)||typeof e.role!="string"||e.role!=="data")throw new Error('"data_message" parts expect an object with a "role" and "data" property.');return{type:"data_message",value:e}}},gje=[Bw,$w,zw,Uw,qw];Bw.code+"",$w.code+"",zw.code+"",Uw.code+"",qw.code+"";Bw.name+"",Bw.code,$w.name+"",$w.code,zw.name+"",zw.code,Uw.name+"",Uw.code,qw.name+"",qw.code;gje.map(e=>e.code);function yje(e){const t=["ROOT"];let n=-1,r=null;function s(l,c,u){switch(l){case'"':{n=c,t.pop(),t.push(u),t.push("INSIDE_STRING");break}case"f":case"t":case"n":{n=c,r=c,t.pop(),t.push(u),t.push("INSIDE_LITERAL");break}case"-":{t.pop(),t.push(u),t.push("INSIDE_NUMBER");break}case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":{n=c,t.pop(),t.push(u),t.push("INSIDE_NUMBER");break}case"{":{n=c,t.pop(),t.push(u),t.push("INSIDE_OBJECT_START");break}case"[":{n=c,t.pop(),t.push(u),t.push("INSIDE_ARRAY_START");break}}}function i(l,c){switch(l){case",":{t.pop(),t.push("INSIDE_OBJECT_AFTER_COMMA");break}case"}":{n=c,t.pop();break}}}function a(l,c){switch(l){case",":{t.pop(),t.push("INSIDE_ARRAY_AFTER_COMMA");break}case"]":{n=c,t.pop();break}}}for(let l=0;l<e.length;l++){const c=e[l];switch(t[t.length-1]){case"ROOT":s(c,l,"FINISH");break;case"INSIDE_OBJECT_START":{switch(c){case'"':{t.pop(),t.push("INSIDE_OBJECT_KEY");break}case"}":{n=l,t.pop();break}}break}case"INSIDE_OBJECT_AFTER_COMMA":{switch(c){case'"':{t.pop(),t.push("INSIDE_OBJECT_KEY");break}}break}case"INSIDE_OBJECT_KEY":{switch(c){case'"':{t.pop(),t.push("INSIDE_OBJECT_AFTER_KEY");break}}break}case"INSIDE_OBJECT_AFTER_KEY":{switch(c){case":":{t.pop(),t.push("INSIDE_OBJECT_BEFORE_VALUE");break}}break}case"INSIDE_OBJECT_BEFORE_VALUE":{s(c,l,"INSIDE_OBJECT_AFTER_VALUE");break}case"INSIDE_OBJECT_AFTER_VALUE":{i(c,l);break}case"INSIDE_STRING":{switch(c){case'"':{t.pop(),n=l;break}case"\\":{t.push("INSIDE_STRING_ESCAPE");break}default:n=l}break}case"INSIDE_ARRAY_START":{switch(c){case"]":{n=l,t.pop();break}default:{n=l,s(c,l,"INSIDE_ARRAY_AFTER_VALUE");break}}break}case"INSIDE_ARRAY_AFTER_VALUE":{switch(c){case",":{t.pop(),t.push("INSIDE_ARRAY_AFTER_COMMA");break}case"]":{n=l,t.pop();break}default:{n=l;break}}break}case"INSIDE_ARRAY_AFTER_COMMA":{s(c,l,"INSIDE_ARRAY_AFTER_VALUE");break}case"INSIDE_STRING_ESCAPE":{t.pop(),n=l;break}case"INSIDE_NUMBER":{switch(c){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":{n=l;break}case"e":case"E":case"-":case".":break;case",":{t.pop(),t[t.length-1]==="INSIDE_ARRAY_AFTER_VALUE"&&a(c,l),t[t.length-1]==="INSIDE_OBJECT_AFTER_VALUE"&&i(c,l);break}case"}":{t.pop(),t[t.length-1]==="INSIDE_OBJECT_AFTER_VALUE"&&i(c,l);break}case"]":{t.pop(),t[t.length-1]==="INSIDE_ARRAY_AFTER_VALUE"&&a(c,l);break}default:{t.pop();break}}break}case"INSIDE_LITERAL":{const d=e.substring(r,l+1);!"false".startsWith(d)&&!"true".startsWith(d)&&!"null".startsWith(d)?(t.pop(),t[t.length-1]==="INSIDE_OBJECT_AFTER_VALUE"?i(c,l):t[t.length-1]==="INSIDE_ARRAY_AFTER_VALUE"&&a(c,l)):n=l;break}}}let o=e.slice(0,n+1);for(let l=t.length-1;l>=0;l--)switch(t[l]){case"INSIDE_STRING":{o+='"';break}case"INSIDE_OBJECT_KEY":case"INSIDE_OBJECT_AFTER_KEY":case"INSIDE_OBJECT_AFTER_COMMA":case"INSIDE_OBJECT_START":case"INSIDE_OBJECT_BEFORE_VALUE":case"INSIDE_OBJECT_AFTER_VALUE":{o+="}";break}case"INSIDE_ARRAY_START":case"INSIDE_ARRAY_AFTER_COMMA":case"INSIDE_ARRAY_AFTER_VALUE":{o+="]";break}case"INSIDE_LITERAL":{const u=e.substring(r,e.length);"true".startsWith(u)?o+="true".slice(u.length):"false".startsWith(u)?o+="false".slice(u.length):"null".startsWith(u)&&(o+="null".slice(u.length))}}return o}function bje(e){if(e===void 0)return{value:void 0,state:"undefined-input"};let t=Nm({text:e});return t.success?{value:t.value,state:"successful-parse"}:(t=Nm({text:yje(e)}),t.success?{value:t.value,state:"repaired-parse"}:{value:void 0,state:"failed-parse"})}var vje={code:"0",name:"text",parse:e=>{if(typeof e!="string")throw new Error('"text" parts expect a string value.');return{type:"text",value:e}}},xje={code:"2",name:"data",parse:e=>{if(!Array.isArray(e))throw new Error('"data" parts expect an array value.');return{type:"data",value:e}}},wje={code:"3",name:"error",parse:e=>{if(typeof e!="string")throw new Error('"error" parts expect a string value.');return{type:"error",value:e}}},Sje={code:"8",name:"message_annotations",parse:e=>{if(!Array.isArray(e))throw new Error('"message_annotations" parts expect an array value.');return{type:"message_annotations",value:e}}},_je={code:"9",name:"tool_call",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("toolName"in e)||typeof e.toolName!="string"||!("args"in e)||typeof e.args!="object")throw new Error('"tool_call" parts expect an object with a "toolCallId", "toolName", and "args" property.');return{type:"tool_call",value:e}}},Cje={code:"a",name:"tool_result",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("result"in e))throw new Error('"tool_result" parts expect an object with a "toolCallId" and a "result" property.');return{type:"tool_result",value:e}}},kje={code:"b",name:"tool_call_streaming_start",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("toolName"in e)||typeof e.toolName!="string")throw new Error('"tool_call_streaming_start" parts expect an object with a "toolCallId" and "toolName" property.');return{type:"tool_call_streaming_start",value:e}}},Eje={code:"c",name:"tool_call_delta",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("argsTextDelta"in e)||typeof e.argsTextDelta!="string")throw new Error('"tool_call_delta" parts expect an object with a "toolCallId" and "argsTextDelta" property.');return{type:"tool_call_delta",value:e}}},Tje={code:"d",name:"finish_message",parse:e=>{if(e==null||typeof e!="object"||!("finishReason"in e)||typeof e.finishReason!="string")throw new Error('"finish_message" parts expect an object with a "finishReason" property.');const t={finishReason:e.finishReason};return"usage"in e&&e.usage!=null&&typeof e.usage=="object"&&"promptTokens"in e.usage&&"completionTokens"in e.usage&&(t.usage={promptTokens:typeof e.usage.promptTokens=="number"?e.usage.promptTokens:Number.NaN,completionTokens:typeof e.usage.completionTokens=="number"?e.usage.completionTokens:Number.NaN}),{type:"finish_message",value:t}}},Aje={code:"e",name:"finish_step",parse:e=>{if(e==null||typeof e!="object"||!("finishReason"in e)||typeof e.finishReason!="string")throw new Error('"finish_step" parts expect an object with a "finishReason" property.');const t={finishReason:e.finishReason,isContinued:!1};return"usage"in e&&e.usage!=null&&typeof e.usage=="object"&&"promptTokens"in e.usage&&"completionTokens"in e.usage&&(t.usage={promptTokens:typeof e.usage.promptTokens=="number"?e.usage.promptTokens:Number.NaN,completionTokens:typeof e.usage.completionTokens=="number"?e.usage.completionTokens:Number.NaN}),"isContinued"in e&&typeof e.isContinued=="boolean"&&(t.isContinued=e.isContinued),{type:"finish_step",value:t}}},Rje={code:"f",name:"start_step",parse:e=>{if(e==null||typeof e!="object"||!("messageId"in e)||typeof e.messageId!="string")throw new Error('"start_step" parts expect an object with an "id" property.');return{type:"start_step",value:{messageId:e.messageId}}}},Nje={code:"g",name:"reasoning",parse:e=>{if(typeof e!="string")throw new Error('"reasoning" parts expect a string value.');return{type:"reasoning",value:e}}},Ije={code:"h",name:"source",parse:e=>{if(e==null||typeof e!="object")throw new Error('"source" parts expect a Source object.');return{type:"source",value:e}}},Mje={code:"i",name:"redacted_reasoning",parse:e=>{if(e==null||typeof e!="object"||!("data"in e)||typeof e.data!="string")throw new Error('"redacted_reasoning" parts expect an object with a "data" property.');return{type:"redacted_reasoning",value:{data:e.data}}}},jje={code:"j",name:"reasoning_signature",parse:e=>{if(e==null||typeof e!="object"||!("signature"in e)||typeof e.signature!="string")throw new Error('"reasoning_signature" parts expect an object with a "signature" property.');return{type:"reasoning_signature",value:{signature:e.signature}}}},Pje={code:"k",name:"file",parse:e=>{if(e==null||typeof e!="object"||!("data"in e)||typeof e.data!="string"||!("mimeType"in e)||typeof e.mimeType!="string")throw new Error('"file" parts expect an object with a "data" and "mimeType" property.');return{type:"file",value:e}}},TT=[vje,xje,wje,Sje,_je,Cje,kje,Eje,Tje,Aje,Rje,Nje,Ije,Mje,jje,Pje];Object.fromEntries(TT.map(e=>[e.code,e]));Object.fromEntries(TT.map(e=>[e.name,e.code]));TT.map(e=>e.code);function Da(e,t){const n=TT.find(r=>r.name===e);if(!n)throw new Error(`Invalid stream part type: ${e}`);return`${n.code}:${JSON.stringify(t)}
`}function Oje(e,t){var n;const r=(n=void 0)!=null?n:!1;return HX(mje(e,{$refStrategy:r?"root":"none",target:"jsonSchema7"}),{validate:s=>{const i=e.safeParse(s);return i.success?{success:!0,value:i.data}:{success:!1,error:i.error}}})}var Q3=Symbol.for("vercel.ai.schema");function HX(e,{validate:t}={}){return{[Q3]:!0,_type:void 0,[T2]:!0,jsonSchema:e,validate:t}}function Dje(e){return typeof e=="object"&&e!==null&&Q3 in e&&e[Q3]===!0&&"jsonSchema"in e&&"validate"in e}function AT(e){return Dje(e)?e:Oje(e)}const I0=globalThis||void 0||self;var Fje=typeof globalThis=="object"?globalThis:typeof self=="object"?self:typeof window=="object"?window:typeof I0=="object"?I0:{},fm="1.9.0",_7=/^(\d+)\.(\d+)\.(\d+)(-(.+))?$/;function Lje(e){var t=new Set([e]),n=new Set,r=e.match(_7);if(!r)return function(){return!1};var s={major:+r[1],minor:+r[2],patch:+r[3],prerelease:r[4]};if(s.prerelease!=null)return function(l){return l===e};function i(o){return n.add(o),!1}function a(o){return t.add(o),!0}return function(l){if(t.has(l))return!0;if(n.has(l))return!1;var c=l.match(_7);if(!c)return i(l);var u={major:+c[1],minor:+c[2],patch:+c[3],prerelease:c[4]};return u.prerelease!=null||s.major!==u.major?i(l):s.major===0?s.minor===u.minor&&s.patch<=u.patch?a(l):i(l):s.minor<=u.minor?a(l):i(l)}}var Bje=Lje(fm),$je=fm.split(".")[0],Vw=Symbol.for("opentelemetry.js.api."+$je),Ww=Fje;function $D(e,t,n,r){var s;r===void 0&&(r=!1);var i=Ww[Vw]=(s=Ww[Vw])!==null&&s!==void 0?s:{version:fm};if(!r&&i[e]){var a=new Error("@opentelemetry/api: Attempted duplicate registration of API: "+e);return n.error(a.stack||a.message),!1}if(i.version!==fm){var a=new Error("@opentelemetry/api: Registration of version v"+i.version+" for "+e+" does not match previously registered API v"+fm);return n.error(a.stack||a.message),!1}return i[e]=t,n.debug("@opentelemetry/api: Registered a global for "+e+" v"+fm+"."),!0}function Hw(e){var t,n,r=(t=Ww[Vw])===null||t===void 0?void 0:t.version;if(!(!r||!Bje(r)))return(n=Ww[Vw])===null||n===void 0?void 0:n[e]}function zD(e,t){t.debug("@opentelemetry/api: Unregistering a global for "+e+" v"+fm+".");var n=Ww[Vw];n&&delete n[e]}var zje=function(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),s,i=[],a;try{for(;(t===void 0||t-- >0)&&!(s=r.next()).done;)i.push(s.value)}catch(o){a={error:o}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(a)throw a.error}}return i},Uje=function(e,t,n){if(n||arguments.length===2)for(var r=0,s=t.length,i;r<s;r++)(i||!(r in t))&&(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))},qje=function(){function e(t){this._namespace=t.namespace||"DiagComponentLogger"}return e.prototype.debug=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return Zv("debug",this._namespace,t)},e.prototype.error=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return Zv("error",this._namespace,t)},e.prototype.info=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return Zv("info",this._namespace,t)},e.prototype.warn=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return Zv("warn",this._namespace,t)},e.prototype.verbose=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return Zv("verbose",this._namespace,t)},e}();function Zv(e,t,n){var r=Hw("diag");if(r)return n.unshift(t),r[e].apply(r,Uje([],zje(n),!1))}var fl;(function(e){e[e.NONE=0]="NONE",e[e.ERROR=30]="ERROR",e[e.WARN=50]="WARN",e[e.INFO=60]="INFO",e[e.DEBUG=70]="DEBUG",e[e.VERBOSE=80]="VERBOSE",e[e.ALL=9999]="ALL"})(fl||(fl={}));function Vje(e,t){e<fl.NONE?e=fl.NONE:e>fl.ALL&&(e=fl.ALL),t=t||{};function n(r,s){var i=t[r];return typeof i=="function"&&e>=s?i.bind(t):function(){}}return{error:n("error",fl.ERROR),warn:n("warn",fl.WARN),info:n("info",fl.INFO),debug:n("debug",fl.DEBUG),verbose:n("verbose",fl.VERBOSE)}}var Wje=function(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),s,i=[],a;try{for(;(t===void 0||t-- >0)&&!(s=r.next()).done;)i.push(s.value)}catch(o){a={error:o}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(a)throw a.error}}return i},Hje=function(e,t,n){if(n||arguments.length===2)for(var r=0,s=t.length,i;r<s;r++)(i||!(r in t))&&(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))},Gje="diag",wk=function(){function e(){function t(s){return function(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];var o=Hw("diag");if(o)return o[s].apply(o,Hje([],Wje(i),!1))}}var n=this,r=function(s,i){var a,o,l;if(i===void 0&&(i={logLevel:fl.INFO}),s===n){var c=new Error("Cannot use diag as the logger for itself. Please use a DiagLogger implementation like ConsoleDiagLogger or a custom implementation");return n.error((a=c.stack)!==null&&a!==void 0?a:c.message),!1}typeof i=="number"&&(i={logLevel:i});var u=Hw("diag"),d=Vje((o=i.logLevel)!==null&&o!==void 0?o:fl.INFO,s);if(u&&!i.suppressOverrideMessage){var h=(l=new Error().stack)!==null&&l!==void 0?l:"<failed to generate stacktrace>";u.warn("Current logger will be overwritten from "+h),d.warn("Current logger will overwrite one already registered from "+h)}return $D("diag",d,n,!0)};n.setLogger=r,n.disable=function(){zD(Gje,n)},n.createComponentLogger=function(s){return new qje(s)},n.verbose=t("verbose"),n.debug=t("debug"),n.info=t("info"),n.warn=t("warn"),n.error=t("error")}return e.instance=function(){return this._instance||(this._instance=new e),this._instance},e}();function Kje(e){return Symbol.for(e)}var Yje=function(){function e(t){var n=this;n._currentContext=t?new Map(t):new Map,n.getValue=function(r){return n._currentContext.get(r)},n.setValue=function(r,s){var i=new e(n._currentContext);return i._currentContext.set(r,s),i},n.deleteValue=function(r){var s=new e(n._currentContext);return s._currentContext.delete(r),s}}return e}(),Zje=new Yje,Xje=function(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),s,i=[],a;try{for(;(t===void 0||t-- >0)&&!(s=r.next()).done;)i.push(s.value)}catch(o){a={error:o}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(a)throw a.error}}return i},Jje=function(e,t,n){if(n||arguments.length===2)for(var r=0,s=t.length,i;r<s;r++)(i||!(r in t))&&(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))},Qje=function(){function e(){}return e.prototype.active=function(){return Zje},e.prototype.with=function(t,n,r){for(var s=[],i=3;i<arguments.length;i++)s[i-3]=arguments[i];return n.call.apply(n,Jje([r],Xje(s),!1))},e.prototype.bind=function(t,n){return n},e.prototype.enable=function(){return this},e.prototype.disable=function(){return this},e}(),e3e=function(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),s,i=[],a;try{for(;(t===void 0||t-- >0)&&!(s=r.next()).done;)i.push(s.value)}catch(o){a={error:o}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(a)throw a.error}}return i},t3e=function(e,t,n){if(n||arguments.length===2)for(var r=0,s=t.length,i;r<s;r++)(i||!(r in t))&&(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))},PM="context",n3e=new Qje,GX=function(){function e(){}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalContextManager=function(t){return $D(PM,t,wk.instance())},e.prototype.active=function(){return this._getContextManager().active()},e.prototype.with=function(t,n,r){for(var s,i=[],a=3;a<arguments.length;a++)i[a-3]=arguments[a];return(s=this._getContextManager()).with.apply(s,t3e([t,n,r],e3e(i),!1))},e.prototype.bind=function(t,n){return this._getContextManager().bind(t,n)},e.prototype._getContextManager=function(){return Hw(PM)||n3e},e.prototype.disable=function(){this._getContextManager().disable(),zD(PM,wk.instance())},e}(),eP;(function(e){e[e.NONE=0]="NONE",e[e.SAMPLED=1]="SAMPLED"})(eP||(eP={}));var KX="0000000000000000",YX="00000000000000000000000000000000",r3e={traceId:YX,spanId:KX,traceFlags:eP.NONE},Fx=function(){function e(t){t===void 0&&(t=r3e),this._spanContext=t}return e.prototype.spanContext=function(){return this._spanContext},e.prototype.setAttribute=function(t,n){return this},e.prototype.setAttributes=function(t){return this},e.prototype.addEvent=function(t,n){return this},e.prototype.addLink=function(t){return this},e.prototype.addLinks=function(t){return this},e.prototype.setStatus=function(t){return this},e.prototype.updateName=function(t){return this},e.prototype.end=function(t){},e.prototype.isRecording=function(){return!1},e.prototype.recordException=function(t,n){},e}(),UD=Kje("OpenTelemetry Context Key SPAN");function qD(e){return e.getValue(UD)||void 0}function s3e(){return qD(GX.getInstance().active())}function VD(e,t){return e.setValue(UD,t)}function i3e(e){return e.deleteValue(UD)}function a3e(e,t){return VD(e,new Fx(t))}function ZX(e){var t;return(t=qD(e))===null||t===void 0?void 0:t.spanContext()}var o3e=/^([0-9a-f]{32})$/i,l3e=/^[0-9a-f]{16}$/i;function c3e(e){return o3e.test(e)&&e!==YX}function u3e(e){return l3e.test(e)&&e!==KX}function XX(e){return c3e(e.traceId)&&u3e(e.spanId)}function d3e(e){return new Fx(e)}var OM=GX.getInstance(),JX=function(){function e(){}return e.prototype.startSpan=function(t,n,r){r===void 0&&(r=OM.active());var s=!!(n!=null&&n.root);if(s)return new Fx;var i=r&&ZX(r);return f3e(i)&&XX(i)?new Fx(i):new Fx},e.prototype.startActiveSpan=function(t,n,r,s){var i,a,o;if(!(arguments.length<2)){arguments.length===2?o=n:arguments.length===3?(i=n,o=r):(i=n,a=r,o=s);var l=a??OM.active(),c=this.startSpan(t,i,l),u=VD(l,c);return OM.with(u,o,void 0,c)}},e}();function f3e(e){return typeof e=="object"&&typeof e.spanId=="string"&&typeof e.traceId=="string"&&typeof e.traceFlags=="number"}var h3e=new JX,p3e=function(){function e(t,n,r,s){this._provider=t,this.name=n,this.version=r,this.options=s}return e.prototype.startSpan=function(t,n,r){return this._getTracer().startSpan(t,n,r)},e.prototype.startActiveSpan=function(t,n,r,s){var i=this._getTracer();return Reflect.apply(i.startActiveSpan,i,arguments)},e.prototype._getTracer=function(){if(this._delegate)return this._delegate;var t=this._provider.getDelegateTracer(this.name,this.version,this.options);return t?(this._delegate=t,this._delegate):h3e},e}(),m3e=function(){function e(){}return e.prototype.getTracer=function(t,n,r){return new JX},e}(),g3e=new m3e,C7=function(){function e(){}return e.prototype.getTracer=function(t,n,r){var s;return(s=this.getDelegateTracer(t,n,r))!==null&&s!==void 0?s:new p3e(this,t,n,r)},e.prototype.getDelegate=function(){var t;return(t=this._delegate)!==null&&t!==void 0?t:g3e},e.prototype.setDelegate=function(t){this._delegate=t},e.prototype.getDelegateTracer=function(t,n,r){var s;return(s=this._delegate)===null||s===void 0?void 0:s.getTracer(t,n,r)},e}(),Sk;(function(e){e[e.UNSET=0]="UNSET",e[e.OK=1]="OK",e[e.ERROR=2]="ERROR"})(Sk||(Sk={}));var DM="trace",y3e=function(){function e(){this._proxyTracerProvider=new C7,this.wrapSpanContext=d3e,this.isSpanContextValid=XX,this.deleteSpan=i3e,this.getSpan=qD,this.getActiveSpan=s3e,this.getSpanContext=ZX,this.setSpan=VD,this.setSpanContext=a3e}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalTracerProvider=function(t){var n=$D(DM,this._proxyTracerProvider,wk.instance());return n&&this._proxyTracerProvider.setDelegate(t),n},e.prototype.getTracerProvider=function(){return Hw(DM)||this._proxyTracerProvider},e.prototype.getTracer=function(t,n){return this.getTracerProvider().getTracer(t,n)},e.prototype.disable=function(){zD(DM,wk.instance()),this._proxyTracerProvider=new C7},e}(),b3e=y3e.getInstance(),v3e=Object.defineProperty,WD=(e,t)=>{for(var n in t)v3e(e,n,{get:t[n],enumerable:!0})};function _k(e,{contentType:t,dataStreamVersion:n}){const r=new Headers(e??{});return r.has("Content-Type")||r.set("Content-Type",t),n!==void 0&&r.set("X-Vercel-AI-Data-Stream",n),r}function k7(e,{contentType:t,dataStreamVersion:n}){const r={};if(e!=null)for(const[s,i]of Object.entries(e))r[s]=i;return r["Content-Type"]==null&&(r["Content-Type"]=t),n!==void 0&&(r["X-Vercel-AI-Data-Stream"]=n),r}function E7({response:e,status:t,statusText:n,headers:r,stream:s}){e.writeHead(t??200,n,r);const i=s.getReader();(async()=>{try{for(;;){const{done:o,value:l}=await i.read();if(o)break;e.write(l)}}catch(o){throw o}finally{e.end()}})()}var QX="AI_InvalidArgumentError",eJ=`vercel.ai.error.${QX}`,x3e=Symbol.for(eJ),tJ,Nc=class extends sr{constructor({parameter:e,value:t,message:n}){super({name:QX,message:`Invalid argument for parameter ${e}: ${n}`}),this[tJ]=!0,this.parameter=e,this.value=t}static isInstance(e){return sr.hasMarker(e,eJ)}};tJ=x3e;var nJ="AI_RetryError",rJ=`vercel.ai.error.${nJ}`,w3e=Symbol.for(rJ),sJ,T7=class extends sr{constructor({message:e,reason:t,errors:n}){super({name:nJ,message:e}),this[sJ]=!0,this.reason=t,this.errors=n,this.lastError=n[n.length-1]}static isInstance(e){return sr.hasMarker(e,rJ)}};sJ=w3e;var S3e=({maxRetries:e=2,initialDelayInMs:t=2e3,backoffFactor:n=2}={})=>async r=>iJ(r,{maxRetries:e,delayInMs:t,backoffFactor:n});async function iJ(e,{maxRetries:t,delayInMs:n,backoffFactor:r},s=[]){try{return await e()}catch(i){if(qC(i)||t===0)throw i;const a=nbe(i),o=[...s,i],l=o.length;if(l>t)throw new T7({message:`Failed after ${l} attempts. Last error: ${a}`,reason:"maxRetriesExceeded",errors:o});if(i instanceof Error&&Xl.isInstance(i)&&i.isRetryable===!0&&l<=t)return await ebe(n),iJ(e,{maxRetries:t,delayInMs:r*n,backoffFactor:r},o);throw l===1?i:new T7({message:`Failed after ${l} attempts with non-retryable error: '${a}'`,reason:"errorNotRetryable",errors:o})}}function _3e({maxRetries:e}){if(e!=null){if(!Number.isInteger(e))throw new Nc({parameter:"maxRetries",value:e,message:"maxRetries must be an integer"});if(e<0)throw new Nc({parameter:"maxRetries",value:e,message:"maxRetries must be >= 0"})}const t=e??2;return{maxRetries:t,retry:S3e({maxRetries:t})}}function tP({operationId:e,telemetry:t}){return{"operation.name":`${e}${(t==null?void 0:t.functionId)!=null?` ${t.functionId}`:""}`,"resource.name":t==null?void 0:t.functionId,"ai.operationId":e,"ai.telemetry.functionId":t==null?void 0:t.functionId}}function C3e({model:e,settings:t,telemetry:n,headers:r}){var s;return{"ai.model.provider":e.provider,"ai.model.id":e.modelId,...Object.entries(t).reduce((i,[a,o])=>(i[`ai.settings.${a}`]=o,i),{}),...Object.entries((s=n==null?void 0:n.metadata)!=null?s:{}).reduce((i,[a,o])=>(i[`ai.telemetry.metadata.${a}`]=o,i),{}),...Object.entries(r??{}).reduce((i,[a,o])=>(o!==void 0&&(i[`ai.request.headers.${a}`]=o),i),{})}}var k3e={startSpan(){return oC},startActiveSpan(e,t,n,r){if(typeof t=="function")return t(oC);if(typeof n=="function")return n(oC);if(typeof r=="function")return r(oC)}},oC={spanContext(){return E3e},setAttribute(){return this},setAttributes(){return this},addEvent(){return this},addLink(){return this},addLinks(){return this},setStatus(){return this},updateName(){return this},end(){return this},isRecording(){return!1},recordException(){return this}},E3e={traceId:"",spanId:"",traceFlags:0};function T3e({isEnabled:e=!1,tracer:t}={}){return e?t||b3e.getTracer("ai"):k3e}function nP({name:e,tracer:t,attributes:n,fn:r,endWhenDone:s=!0}){return t.startActiveSpan(e,{attributes:n},async i=>{try{const a=await r(i);return s&&i.end(),a}catch(a){try{a instanceof Error?(i.recordException({name:a.name,message:a.message,stack:a.stack}),i.setStatus({code:Sk.ERROR,message:a.message})):i.setStatus({code:Sk.ERROR})}finally{i.end()}throw a}})}function M0({telemetry:e,attributes:t}){return(e==null?void 0:e.isEnabled)!==!0?{}:Object.entries(t).reduce((n,[r,s])=>{if(s===void 0)return n;if(typeof s=="object"&&"input"in s&&typeof s.input=="function"){if((e==null?void 0:e.recordInputs)===!1)return n;const i=s.input();return i===void 0?n:{...n,[r]:i}}if(typeof s=="object"&&"output"in s&&typeof s.output=="function"){if((e==null?void 0:e.recordOutputs)===!1)return n;const i=s.output();return i===void 0?n:{...n,[r]:i}}return{...n,[r]:s}},{})}var A3e=class{constructor({data:e,mimeType:t}){const n=e instanceof Uint8Array;this.base64Data=n?void 0:e,this.uint8ArrayData=n?e:void 0,this.mimeType=t}get base64(){return this.base64Data==null&&(this.base64Data=zu(this.uint8ArrayData)),this.base64Data}get uint8Array(){return this.uint8ArrayData==null&&(this.uint8ArrayData=LE(this.base64Data)),this.uint8ArrayData}},R3e=class extends A3e{constructor(e){super(e),this.type="file"}},N3e=[{mimeType:"image/gif",bytesPrefix:[71,73,70],base64Prefix:"R0lG"},{mimeType:"image/png",bytesPrefix:[137,80,78,71],base64Prefix:"iVBORw"},{mimeType:"image/jpeg",bytesPrefix:[255,216],base64Prefix:"/9j/"},{mimeType:"image/webp",bytesPrefix:[82,73,70,70],base64Prefix:"UklGRg"},{mimeType:"image/bmp",bytesPrefix:[66,77],base64Prefix:"Qk"},{mimeType:"image/tiff",bytesPrefix:[73,73,42,0],base64Prefix:"SUkqAA"},{mimeType:"image/tiff",bytesPrefix:[77,77,0,42],base64Prefix:"TU0AKg"},{mimeType:"image/avif",bytesPrefix:[0,0,0,32,102,116,121,112,97,118,105,102],base64Prefix:"AAAAIGZ0eXBhdmlm"},{mimeType:"image/heic",bytesPrefix:[0,0,0,32,102,116,121,112,104,101,105,99],base64Prefix:"AAAAIGZ0eXBoZWlj"}],I3e=e=>{const t=typeof e=="string"?LE(e):e,n=(t[6]&127)<<21|(t[7]&127)<<14|(t[8]&127)<<7|t[9]&127;return t.slice(n+10)};function M3e(e){return typeof e=="string"&&e.startsWith("SUQz")||typeof e!="string"&&e.length>10&&e[0]===73&&e[1]===68&&e[2]===51?I3e(e):e}function j3e({data:e,signatures:t}){const n=M3e(e);for(const r of t)if(typeof n=="string"?n.startsWith(r.base64Prefix):n.length>=r.bytesPrefix.length&&r.bytesPrefix.every((s,i)=>n[i]===s))return r.mimeType}var aJ="AI_NoObjectGeneratedError",oJ=`vercel.ai.error.${aJ}`,P3e=Symbol.for(oJ),lJ,A7=class extends sr{constructor({message:e="No object generated.",cause:t,text:n,response:r,usage:s,finishReason:i}){super({name:aJ,message:e,cause:t}),this[lJ]=!0,this.text=n,this.response=r,this.usage=s,this.finishReason=i}static isInstance(e){return sr.hasMarker(e,oJ)}};lJ=P3e;var cJ="AI_DownloadError",uJ=`vercel.ai.error.${cJ}`,O3e=Symbol.for(uJ),dJ,FM=class extends sr{constructor({url:e,statusCode:t,statusText:n,cause:r,message:s=r==null?`Failed to download ${e}: ${t} ${n}`:`Failed to download ${e}: ${r}`}){super({name:cJ,message:s,cause:r}),this[dJ]=!0,this.url=e,this.statusCode=t,this.statusText=n}static isInstance(e){return sr.hasMarker(e,uJ)}};dJ=O3e;async function D3e({url:e}){var t;const n=e.toString();try{const r=await fetch(n);if(!r.ok)throw new FM({url:n,statusCode:r.status,statusText:r.statusText});return{data:new Uint8Array(await r.arrayBuffer()),mimeType:(t=r.headers.get("content-type"))!=null?t:void 0}}catch(r){throw FM.isInstance(r)?r:new FM({url:n,cause:r})}}var fJ="AI_InvalidDataContentError",hJ=`vercel.ai.error.${fJ}`,F3e=Symbol.for(hJ),pJ,R7=class extends sr{constructor({content:e,cause:t,message:n=`Invalid data content. Expected a base64 string, Uint8Array, ArrayBuffer, or Buffer, but got ${typeof e}.`}){super({name:fJ,message:n,cause:t}),this[pJ]=!0,this.content=e}static isInstance(e){return sr.hasMarker(e,hJ)}};pJ=F3e;var mJ=ms([$e(),B2(Uint8Array),B2(ArrayBuffer),qG(e=>{var t,n;return(n=(t=globalThis.Buffer)==null?void 0:t.isBuffer(e))!=null?n:!1},{message:"Must be a Buffer"})]);function HD(e){return typeof e=="string"?e:e instanceof ArrayBuffer?zu(new Uint8Array(e)):zu(e)}function Ck(e){if(e instanceof Uint8Array)return e;if(typeof e=="string")try{return LE(e)}catch(t){throw new R7({message:"Invalid data content. Content string is not a base64-encoded media.",content:e,cause:t})}if(e instanceof ArrayBuffer)return new Uint8Array(e);throw new R7({content:e})}function L3e(e){try{return new TextDecoder().decode(e)}catch{throw new Error("Error decoding Uint8Array to text")}}var gJ="AI_InvalidMessageRoleError",yJ=`vercel.ai.error.${gJ}`,B3e=Symbol.for(yJ),bJ,$3e=class extends sr{constructor({role:e,message:t=`Invalid message role: '${e}'. Must be one of: "system", "user", "assistant", "tool".`}){super({name:gJ,message:t}),this[bJ]=!0,this.role=e}static isInstance(e){return sr.hasMarker(e,yJ)}};bJ=B3e;function z3e(e){try{const[t,n]=e.split(",");return{mimeType:t.split(";")[0].split(":")[1],base64Content:n}}catch{return{mimeType:void 0,base64Content:void 0}}}async function U3e({prompt:e,modelSupportsImageUrls:t=!0,modelSupportsUrl:n=()=>!1,downloadImplementation:r=D3e}){const s=await V3e(e.messages,r,t,n);return[...e.system!=null?[{role:"system",content:e.system}]:[],...e.messages.map(i=>q3e(i,s))]}function q3e(e,t){var n,r,s,i,a,o;const l=e.role;switch(l){case"system":return{role:"system",content:e.content,providerMetadata:(n=e.providerOptions)!=null?n:e.experimental_providerMetadata};case"user":return typeof e.content=="string"?{role:"user",content:[{type:"text",text:e.content}],providerMetadata:(r=e.providerOptions)!=null?r:e.experimental_providerMetadata}:{role:"user",content:e.content.map(c=>W3e(c,t)).filter(c=>c.type!=="text"||c.text!==""),providerMetadata:(s=e.providerOptions)!=null?s:e.experimental_providerMetadata};case"assistant":return typeof e.content=="string"?{role:"assistant",content:[{type:"text",text:e.content}],providerMetadata:(i=e.providerOptions)!=null?i:e.experimental_providerMetadata}:{role:"assistant",content:e.content.filter(c=>c.type!=="text"||c.text!=="").map(c=>{var u;const d=(u=c.providerOptions)!=null?u:c.experimental_providerMetadata;switch(c.type){case"file":return{type:"file",data:c.data instanceof URL?c.data:HD(c.data),filename:c.filename,mimeType:c.mimeType,providerMetadata:d};case"reasoning":return{type:"reasoning",text:c.text,signature:c.signature,providerMetadata:d};case"redacted-reasoning":return{type:"redacted-reasoning",data:c.data,providerMetadata:d};case"text":return{type:"text",text:c.text,providerMetadata:d};case"tool-call":return{type:"tool-call",toolCallId:c.toolCallId,toolName:c.toolName,args:c.args,providerMetadata:d}}}),providerMetadata:(a=e.providerOptions)!=null?a:e.experimental_providerMetadata};case"tool":return{role:"tool",content:e.content.map(c=>{var u;return{type:"tool-result",toolCallId:c.toolCallId,toolName:c.toolName,result:c.result,content:c.experimental_content,isError:c.isError,providerMetadata:(u=c.providerOptions)!=null?u:c.experimental_providerMetadata}}),providerMetadata:(o=e.providerOptions)!=null?o:e.experimental_providerMetadata};default:{const c=l;throw new $3e({role:c})}}}async function V3e(e,t,n,r){const s=e.filter(a=>a.role==="user").map(a=>a.content).filter(a=>Array.isArray(a)).flat().filter(a=>a.type==="image"||a.type==="file").filter(a=>!(a.type==="image"&&n===!0)).map(a=>a.type==="image"?a.image:a.data).map(a=>typeof a=="string"&&(a.startsWith("http:")||a.startsWith("https:"))?new URL(a):a).filter(a=>a instanceof URL).filter(a=>!r(a)),i=await Promise.all(s.map(async a=>({url:a,data:await t({url:a})})));return Object.fromEntries(i.map(({url:a,data:o})=>[a.toString(),o]))}function W3e(e,t){var n,r,s,i;if(e.type==="text")return{type:"text",text:e.text,providerMetadata:(n=e.providerOptions)!=null?n:e.experimental_providerMetadata};let a=e.mimeType,o,l,c;const u=e.type;switch(u){case"image":o=e.image;break;case"file":o=e.data;break;default:throw new Error(`Unsupported part type: ${u}`)}try{l=typeof o=="string"?new URL(o):o}catch{l=o}if(l instanceof URL)if(l.protocol==="data:"){const{mimeType:d,base64Content:h}=z3e(l.toString());if(d==null||h==null)throw new Error(`Invalid data URL format in part ${u}`);a=d,c=Ck(h)}else{const d=t[l.toString()];d?(c=d.data,a??(a=d.mimeType)):c=l}else c=Ck(l);switch(u){case"image":return c instanceof Uint8Array&&(a=(r=j3e({data:c,signatures:N3e}))!=null?r:a),{type:"image",image:c,mimeType:a,providerMetadata:(s=e.providerOptions)!=null?s:e.experimental_providerMetadata};case"file":{if(a==null)throw new Error("Mime type is missing for file part");return{type:"file",data:c instanceof Uint8Array?HD(c):c,filename:e.filename,mimeType:a,providerMetadata:(i=e.providerOptions)!=null?i:e.experimental_providerMetadata}}}}function H3e({maxTokens:e,temperature:t,topP:n,topK:r,presencePenalty:s,frequencyPenalty:i,stopSequences:a,seed:o}){if(e!=null){if(!Number.isInteger(e))throw new Nc({parameter:"maxTokens",value:e,message:"maxTokens must be an integer"});if(e<1)throw new Nc({parameter:"maxTokens",value:e,message:"maxTokens must be >= 1"})}if(t!=null&&typeof t!="number")throw new Nc({parameter:"temperature",value:t,message:"temperature must be a number"});if(n!=null&&typeof n!="number")throw new Nc({parameter:"topP",value:n,message:"topP must be a number"});if(r!=null&&typeof r!="number")throw new Nc({parameter:"topK",value:r,message:"topK must be a number"});if(s!=null&&typeof s!="number")throw new Nc({parameter:"presencePenalty",value:s,message:"presencePenalty must be a number"});if(i!=null&&typeof i!="number")throw new Nc({parameter:"frequencyPenalty",value:i,message:"frequencyPenalty must be a number"});if(o!=null&&!Number.isInteger(o))throw new Nc({parameter:"seed",value:o,message:"seed must be an integer"});return{maxTokens:e,temperature:t??0,topP:n,topK:r,presencePenalty:s,frequencyPenalty:i,stopSequences:a!=null&&a.length>0?a:void 0,seed:o}}function N7(e){var t,n,r;const s=[];for(const i of e){let a;try{a=new URL(i.url)}catch{throw new Error(`Invalid URL: ${i.url}`)}switch(a.protocol){case"http:":case"https:":{if((t=i.contentType)!=null&&t.startsWith("image/"))s.push({type:"image",image:a});else{if(!i.contentType)throw new Error("If the attachment is not an image, it must specify a content type");s.push({type:"file",data:a,mimeType:i.contentType})}break}case"data:":{let o,l,c;try{[o,l]=i.url.split(","),c=o.split(";")[0].split(":")[1]}catch{throw new Error(`Error processing data URL: ${i.url}`)}if(c==null||l==null)throw new Error(`Invalid data URL format: ${i.url}`);if((n=i.contentType)!=null&&n.startsWith("image/"))s.push({type:"image",image:Ck(l)});else if((r=i.contentType)!=null&&r.startsWith("text/"))s.push({type:"text",text:L3e(Ck(l))});else{if(!i.contentType)throw new Error("If the attachment is not an image or text, it must specify a content type");s.push({type:"file",data:l,mimeType:i.contentType})}break}default:throw new Error(`Unsupported URL protocol: ${a.protocol}`)}}return s}var vJ="AI_MessageConversionError",xJ=`vercel.ai.error.${vJ}`,G3e=Symbol.for(xJ),wJ,LM=class extends sr{constructor({originalMessage:e,message:t}){super({name:vJ,message:t}),this[wJ]=!0,this.originalMessage=e}static isInstance(e){return sr.hasMarker(e,xJ)}};wJ=G3e;function K3e(e,t){var n,r;const s=(n=t==null?void 0:t.tools)!=null?n:{},i=[];for(let a=0;a<e.length;a++){const o=e[a],l=a===e.length-1,{role:c,content:u,experimental_attachments:d}=o;switch(c){case"system":{i.push({role:"system",content:u});break}case"user":{if(o.parts==null)i.push({role:"user",content:d?[{type:"text",text:u},...N7(d)]:u});else{const h=o.parts.filter(m=>m.type==="text").map(m=>({type:"text",text:m.text}));i.push({role:"user",content:d?[...h,...N7(d)]:h})}break}case"assistant":{if(o.parts!=null){let y=function(){const w=[];for(const k of x)switch(k.type){case"file":case"text":{w.push(k);break}case"reasoning":{for(const C of k.details)switch(C.type){case"text":w.push({type:"reasoning",text:C.text,signature:C.signature});break;case"redacted":w.push({type:"redacted-reasoning",data:C.data});break}break}case"tool-invocation":w.push({type:"tool-call",toolCallId:k.toolInvocation.toolCallId,toolName:k.toolInvocation.toolName,args:k.toolInvocation.args});break;default:{const C=k;throw new Error(`Unsupported part: ${C}`)}}i.push({role:"assistant",content:w});const _=x.filter(k=>k.type==="tool-invocation").map(k=>k.toolInvocation);_.length>0&&i.push({role:"tool",content:_.map(k=>{if(!("result"in k))throw new LM({originalMessage:o,message:"ToolInvocation must have a result: "+JSON.stringify(k)});const{toolCallId:C,toolName:T,result:A}=k,N=s[T];return(N==null?void 0:N.experimental_toToolResultContent)!=null?{type:"tool-result",toolCallId:C,toolName:T,result:N.experimental_toToolResultContent(A),experimental_content:N.experimental_toToolResultContent(A)}:{type:"tool-result",toolCallId:C,toolName:T,result:A}})}),x=[],v=!1,b++},b=0,v=!1,x=[];for(const w of o.parts)switch(w.type){case"text":{v&&y(),x.push(w);break}case"file":case"reasoning":{x.push(w);break}case"tool-invocation":{((r=w.toolInvocation.step)!=null?r:0)!==b&&y(),x.push(w),v=!0;break}}y();break}const h=o.toolInvocations;if(h==null||h.length===0){i.push({role:"assistant",content:u});break}const m=h.reduce((y,b)=>{var v;return Math.max(y,(v=b.step)!=null?v:0)},0);for(let y=0;y<=m;y++){const b=h.filter(v=>{var x;return((x=v.step)!=null?x:0)===y});b.length!==0&&(i.push({role:"assistant",content:[...l&&u&&y===0?[{type:"text",text:u}]:[],...b.map(({toolCallId:v,toolName:x,args:w})=>({type:"tool-call",toolCallId:v,toolName:x,args:w}))]}),i.push({role:"tool",content:b.map(v=>{if(!("result"in v))throw new LM({originalMessage:o,message:"ToolInvocation must have a result: "+JSON.stringify(v)});const{toolCallId:x,toolName:w,result:_}=v,k=s[w];return(k==null?void 0:k.experimental_toToolResultContent)!=null?{type:"tool-result",toolCallId:x,toolName:w,result:k.experimental_toToolResultContent(_),experimental_content:k.experimental_toToolResultContent(_)}:{type:"tool-result",toolCallId:x,toolName:w,result:_}})}))}u&&!l&&i.push({role:"assistant",content:u});break}case"data":break;default:{const h=c;throw new LM({originalMessage:o,message:`Unsupported role: ${h}`})}}}return i}var rP=Ube(()=>ms([zbe(),$e(),Tt(),Qn(),Dh($e(),rP),cn(rP)])),di=Dh($e(),Dh($e(),rP)),Y3e=cn(ms([Ke({type:Mn("text"),text:$e()}),Ke({type:Mn("image"),data:$e(),mimeType:$e().optional()})])),SJ=Ke({type:Mn("text"),text:$e(),providerOptions:di.optional(),experimental_providerMetadata:di.optional()}),Z3e=Ke({type:Mn("image"),image:ms([mJ,B2(URL)]),mimeType:$e().optional(),providerOptions:di.optional(),experimental_providerMetadata:di.optional()}),_J=Ke({type:Mn("file"),data:ms([mJ,B2(URL)]),filename:$e().optional(),mimeType:$e(),providerOptions:di.optional(),experimental_providerMetadata:di.optional()}),X3e=Ke({type:Mn("reasoning"),text:$e(),providerOptions:di.optional(),experimental_providerMetadata:di.optional()}),J3e=Ke({type:Mn("redacted-reasoning"),data:$e(),providerOptions:di.optional(),experimental_providerMetadata:di.optional()}),Q3e=Ke({type:Mn("tool-call"),toolCallId:$e(),toolName:$e(),args:nb(),providerOptions:di.optional(),experimental_providerMetadata:di.optional()}),ePe=Ke({type:Mn("tool-result"),toolCallId:$e(),toolName:$e(),result:nb(),content:Y3e.optional(),isError:Qn().optional(),providerOptions:di.optional(),experimental_providerMetadata:di.optional()}),tPe=Ke({role:Mn("system"),content:$e(),providerOptions:di.optional(),experimental_providerMetadata:di.optional()}),nPe=Ke({role:Mn("user"),content:ms([$e(),cn(ms([SJ,Z3e,_J]))]),providerOptions:di.optional(),experimental_providerMetadata:di.optional()}),rPe=Ke({role:Mn("assistant"),content:ms([$e(),cn(ms([SJ,_J,X3e,J3e,Q3e]))]),providerOptions:di.optional(),experimental_providerMetadata:di.optional()}),sPe=Ke({role:Mn("tool"),content:cn(ePe),providerOptions:di.optional(),experimental_providerMetadata:di.optional()}),iPe=ms([tPe,nPe,rPe,sPe]);function aPe({prompt:e,tools:t}){if(e.prompt==null&&e.messages==null)throw new Ic({prompt:e,message:"prompt or messages must be defined"});if(e.prompt!=null&&e.messages!=null)throw new Ic({prompt:e,message:"prompt and messages cannot be defined at the same time"});if(e.system!=null&&typeof e.system!="string")throw new Ic({prompt:e,message:"system must be a string"});if(e.prompt!=null){if(typeof e.prompt!="string")throw new Ic({prompt:e,message:"prompt must be a string"});return{type:"prompt",system:e.system,messages:[{role:"user",content:e.prompt}]}}if(e.messages!=null){const r=oPe(e.messages)==="ui-messages"?K3e(e.messages,{tools:t}):e.messages;if(r.length===0)throw new Ic({prompt:e,message:"messages must not be empty"});const s=tb({value:r,schema:cn(iPe)});if(!s.success)throw new Ic({prompt:e,message:["message must be a CoreMessage or a UI message",`Validation error: ${s.error.message}`].join(`
`),cause:s.error});return{type:"messages",messages:r,system:e.system}}throw new Error("unreachable")}function oPe(e){if(!Array.isArray(e))throw new Ic({prompt:e,message:["messages must be an array of CoreMessage or UIMessage",`Received non-array value: ${JSON.stringify(e)}`].join(`
`),cause:e});if(e.length===0)return"messages";const t=e.map(lPe);if(t.some(r=>r==="has-ui-specific-parts"))return"ui-messages";const n=t.findIndex(r=>r!=="has-core-specific-parts"&&r!=="message");if(n===-1)return"messages";throw new Ic({prompt:e,message:["messages must be an array of CoreMessage or UIMessage",`Received message of type: "${t[n]}" at index ${n}`,`messages[${n}]: ${JSON.stringify(e[n])}`].join(`
`),cause:e})}function lPe(e){return typeof e=="object"&&e!==null&&(e.role==="function"||e.role==="data"||"toolInvocations"in e||"parts"in e||"experimental_attachments"in e)?"has-ui-specific-parts":typeof e=="object"&&e!==null&&"content"in e&&(Array.isArray(e.content)||"experimental_providerMetadata"in e||"providerOptions"in e)?"has-core-specific-parts":typeof e=="object"&&e!==null&&"role"in e&&"content"in e&&typeof e.content=="string"&&["system","user","assistant","tool"].includes(e.role)?"message":"other"}function cPe({promptTokens:e,completionTokens:t}){return{promptTokens:e,completionTokens:t,totalTokens:e+t}}function uPe(e,t){return{promptTokens:e.promptTokens+t.promptTokens,completionTokens:e.completionTokens+t.completionTokens,totalTokens:e.totalTokens+t.totalTokens}}var dPe="JSON schema:",fPe="You MUST answer with a JSON object that matches the JSON schema above.",hPe="You MUST answer with JSON.";function pPe({prompt:e,schema:t,schemaPrefix:n=t!=null?dPe:void 0,schemaSuffix:r=t!=null?fPe:hPe}){return[e!=null&&e.length>0?e:void 0,e!=null&&e.length>0?"":void 0,n,t!=null?JSON.stringify(t):void 0,r].filter(s=>s!=null).join(`
`)}function BM(e){const t=e.pipeThrough(new TransformStream);return t[Symbol.asyncIterator]=()=>{const n=t.getReader();return{async next(){const{done:r,value:s}=await n.read();return r?{done:!0,value:void 0}:{done:!1,value:s}}}},t}function mPe(e){const t=e.map(n=>({...n,content:typeof n.content=="string"?n.content:n.content.map(gPe)}));return JSON.stringify(t)}function gPe(e){return e.type==="image"?{...e,image:e.image instanceof Uint8Array?HD(e.image):e.image}:e}Ym({prefix:"aiobj",size:24});var jo=class{constructor(){this.status={type:"pending"},this._resolve=void 0,this._reject=void 0}get value(){return this.promise?this.promise:(this.promise=new Promise((e,t)=>{this.status.type==="resolved"?e(this.status.value):this.status.type==="rejected"&&t(this.status.error),this._resolve=e,this._reject=t}),this.promise)}resolve(e){var t;this.status={type:"resolved",value:e},this.promise&&((t=this._resolve)==null||t.call(this,e))}reject(e){var t;this.status={type:"rejected",error:e},this.promise&&((t=this._reject)==null||t.call(this,e))}};function I7(){let e,t;return{promise:new Promise((r,s)=>{e=r,t=s}),resolve:e,reject:t}}function yPe(){let e=[],t=null,n=!1,r=I7();const s=async()=>{if(n&&e.length===0){t==null||t.close();return}if(e.length===0)return r=I7(),await r.promise,s();try{const{value:i,done:a}=await e[0].read();a?(e.shift(),e.length>0?await s():n&&(t==null||t.close())):t==null||t.enqueue(i)}catch(i){t==null||t.error(i),e.shift(),n&&e.length===0&&(t==null||t.close())}};return{stream:new ReadableStream({start(i){t=i},pull:s,async cancel(){for(const i of e)await i.cancel();e=[],n=!0}}),addStream:i=>{if(n)throw new Error("Cannot add inner stream: outer stream is closed");e.push(i.getReader()),r.resolve()},close:()=>{n=!0,r.resolve(),e.length===0&&(t==null||t.close())},terminate:()=>{n=!0,r.resolve(),e.forEach(i=>i.cancel()),e=[],t==null||t.close()}}}function bPe(){var e,t;return(t=(e=globalThis==null?void 0:globalThis.performance)==null?void 0:e.now())!=null?t:Date.now()}Ym({prefix:"aiobj",size:24});var CJ="AI_NoOutputSpecifiedError",kJ=`vercel.ai.error.${CJ}`,vPe=Symbol.for(kJ),EJ,xPe=class extends sr{constructor({message:e="No output specified."}={}){super({name:CJ,message:e}),this[EJ]=!0}static isInstance(e){return sr.hasMarker(e,kJ)}};EJ=vPe;var TJ="AI_ToolExecutionError",AJ=`vercel.ai.error.${TJ}`,wPe=Symbol.for(AJ),RJ,SPe=class extends sr{constructor({toolArgs:e,toolName:t,toolCallId:n,cause:r,message:s=`Error executing tool ${t}: ${T1(r)}`}){super({name:TJ,message:s,cause:r}),this[RJ]=!0,this.toolArgs=e,this.toolName=t,this.toolCallId=n}static isInstance(e){return sr.hasMarker(e,AJ)}};RJ=wPe;function _Pe(e){return e!=null&&Object.keys(e).length>0}function CPe({tools:e,toolChoice:t,activeTools:n}){return _Pe(e)?{tools:(n!=null?Object.entries(e).filter(([s])=>n.includes(s)):Object.entries(e)).map(([s,i])=>{const a=i.type;switch(a){case void 0:case"function":return{type:"function",name:s,description:i.description,parameters:AT(i.parameters).jsonSchema};case"provider-defined":return{type:"provider-defined",name:s,id:i.id,args:i.args};default:{const o=a;throw new Error(`Unsupported tool type: ${o}`)}}}),toolChoice:t==null?{type:"auto"}:typeof t=="string"?{type:t}:{type:"tool",toolName:t.toolName}}:{tools:void 0,toolChoice:void 0}}var kPe=/^([\s\S]*?)(\s+)(\S*)$/;function EPe(e){const t=e.match(kPe);return t?{prefix:t[1],whitespace:t[2],suffix:t[3]}:void 0}var NJ="AI_InvalidToolArgumentsError",IJ=`vercel.ai.error.${NJ}`,TPe=Symbol.for(IJ),MJ,jJ=class extends sr{constructor({toolArgs:e,toolName:t,cause:n,message:r=`Invalid arguments for tool ${t}: ${T1(n)}`}){super({name:NJ,message:r,cause:n}),this[MJ]=!0,this.toolArgs=e,this.toolName=t}static isInstance(e){return sr.hasMarker(e,IJ)}};MJ=TPe;var PJ="AI_NoSuchToolError",OJ=`vercel.ai.error.${PJ}`,APe=Symbol.for(OJ),DJ,sP=class extends sr{constructor({toolName:e,availableTools:t=void 0,message:n=`Model tried to call unavailable tool '${e}'. ${t===void 0?"No tools are available.":`Available tools: ${t.join(", ")}.`}`}){super({name:PJ,message:n}),this[DJ]=!0,this.toolName=e,this.availableTools=t}static isInstance(e){return sr.hasMarker(e,OJ)}};DJ=APe;var FJ="AI_ToolCallRepairError",LJ=`vercel.ai.error.${FJ}`,RPe=Symbol.for(LJ),BJ,NPe=class extends sr{constructor({cause:e,originalError:t,message:n=`Error repairing tool call: ${T1(e)}`}){super({name:FJ,message:n,cause:e}),this[BJ]=!0,this.originalError=t}static isInstance(e){return sr.hasMarker(e,LJ)}};BJ=RPe;async function IPe({toolCall:e,tools:t,repairToolCall:n,system:r,messages:s}){if(t==null)throw new sP({toolName:e.toolName});try{return await M7({toolCall:e,tools:t})}catch(i){if(n==null||!(sP.isInstance(i)||jJ.isInstance(i)))throw i;let a=null;try{a=await n({toolCall:e,tools:t,parameterSchema:({toolName:o})=>AT(t[o].parameters).jsonSchema,system:r,messages:s,error:i})}catch(o){throw new NPe({cause:o,originalError:i})}if(a==null)throw i;return await M7({toolCall:a,tools:t})}}async function M7({toolCall:e,tools:t}){const n=e.toolName,r=t[n];if(r==null)throw new sP({toolName:e.toolName,availableTools:Object.keys(t)});const s=AT(r.parameters),i=e.args.trim()===""?tb({value:{},schema:s}):Nm({text:e.args,schema:s});if(i.success===!1)throw new jJ({toolName:n,toolArgs:e.args,cause:i.error});return{type:"tool-call",toolCallId:e.toolCallId,toolName:n,args:i.value}}function MPe(e){const t=e.filter(n=>n.type==="text").map(n=>n.text).join("");return t.length>0?t:void 0}function j7({text:e="",files:t,reasoning:n,tools:r,toolCalls:s,toolResults:i,messageId:a,generateMessageId:o}){const l=[],c=[];return n.length>0&&c.push(...n.map(u=>u.type==="text"?{...u,type:"reasoning"}:{...u,type:"redacted-reasoning"})),t.length>0&&c.push(...t.map(u=>({type:"file",data:u.base64,mimeType:u.mimeType}))),e.length>0&&c.push({type:"text",text:e}),s.length>0&&c.push(...s),c.length>0&&l.push({role:"assistant",content:c,id:a}),i.length>0&&l.push({role:"tool",id:o(),content:i.map(u=>{const d=r[u.toolName];return(d==null?void 0:d.experimental_toToolResultContent)!=null?{type:"tool-result",toolCallId:u.toolCallId,toolName:u.toolName,result:d.experimental_toToolResultContent(u.result),experimental_content:d.experimental_toToolResultContent(u.result)}:{type:"tool-result",toolCallId:u.toolCallId,toolName:u.toolName,result:u.result}})}),l}Ym({prefix:"aitxt",size:24});Ym({prefix:"msg",size:24});var jPe={};WD(jPe,{object:()=>BPe,text:()=>LPe});var $J="AI_InvalidStreamPartError",zJ=`vercel.ai.error.${$J}`,PPe=Symbol.for(zJ),UJ,OPe=class extends sr{constructor({chunk:e,message:t}){super({name:$J,message:t}),this[UJ]=!0,this.chunk=e}static isInstance(e){return sr.hasMarker(e,zJ)}};UJ=PPe;var DPe="AI_MCPClientError",qJ=`vercel.ai.error.${DPe}`,FPe=Symbol.for(qJ),VJ,ca=class extends sr{constructor({name:e="MCPClientError",message:t,cause:n}){super({name:e,message:t,cause:n}),this[VJ]=!0}static isInstance(e){return sr.hasMarker(e,qJ)}};VJ=FPe;var LPe=()=>({type:"text",responseFormat:()=>({type:"text"}),injectIntoSystemPrompt({system:e}){return e},parsePartial({text:e}){return{partial:e}},parseOutput({text:e}){return e}}),BPe=({schema:e})=>{const t=AT(e);return{type:"object",responseFormat:({model:n})=>({type:"json",schema:n.supportsStructuredOutputs?t.jsonSchema:void 0}),injectIntoSystemPrompt({system:n,model:r}){return r.supportsStructuredOutputs?n:pPe({prompt:n,schema:t.jsonSchema})},parsePartial({text:n}){const r=bje(n);switch(r.state){case"failed-parse":case"undefined-input":return;case"repaired-parse":case"successful-parse":return{partial:r.value};default:{const s=r.state;throw new Error(`Unsupported parse state: ${s}`)}}},parseOutput({text:n},r){const s=Nm({text:n});if(!s.success)throw new A7({message:"No object generated: could not parse the response.",cause:s.error,text:n,response:r.response,usage:r.usage,finishReason:r.finishReason});const i=tb({value:s.value,schema:t});if(!i.success)throw new A7({message:"No object generated: response did not match schema.",cause:i.error,text:n,response:r.response,usage:r.usage,finishReason:r.finishReason});return i.value}}};function $Pe(e){return e===void 0?[]:Array.isArray(e)?e:[e]}async function zPe({stream:e,onError:t}){const n=e.getReader();try{for(;;){const{done:r}=await n.read();if(r)break}}catch(r){t==null||t(r)}finally{n.releaseLock()}}function GD(e,t){const n=e.getReader(),r=t.getReader();let s,i,a=!1,o=!1;async function l(u){try{s==null&&(s=n.read());const d=await s;s=void 0,d.done?u.close():u.enqueue(d.value)}catch(d){u.error(d)}}async function c(u){try{i==null&&(i=r.read());const d=await i;i=void 0,d.done?u.close():u.enqueue(d.value)}catch(d){u.error(d)}}return new ReadableStream({async pull(u){try{if(a){await c(u);return}if(o){await l(u);return}s==null&&(s=n.read()),i==null&&(i=r.read());const{result:d,reader:h}=await Promise.race([s.then(m=>({result:m,reader:n})),i.then(m=>({result:m,reader:r}))]);d.done||u.enqueue(d.value),h===n?(s=void 0,d.done&&(await c(u),a=!0)):(i=void 0,d.done&&(o=!0,await l(u)))}catch(d){u.error(d)}},cancel(){n.cancel(),r.cancel()}})}function UPe({tools:e,generatorStream:t,toolCallStreaming:n,tracer:r,telemetry:s,system:i,messages:a,abortSignal:o,repairToolCall:l}){let c=null;const u=new ReadableStream({start(x){c=x}}),d={},h=new Set;let m=!1,y;function b(){m&&h.size===0&&(y!=null&&c.enqueue(y),c.close())}const v=new TransformStream({async transform(x,w){const _=x.type;switch(_){case"text-delta":case"reasoning":case"reasoning-signature":case"redacted-reasoning":case"source":case"response-metadata":case"error":{w.enqueue(x);break}case"file":{w.enqueue(new R3e({data:x.data,mimeType:x.mimeType}));break}case"tool-call-delta":{n&&(d[x.toolCallId]||(w.enqueue({type:"tool-call-streaming-start",toolCallId:x.toolCallId,toolName:x.toolName}),d[x.toolCallId]=!0),w.enqueue({type:"tool-call-delta",toolCallId:x.toolCallId,toolName:x.toolName,argsTextDelta:x.argsTextDelta}));break}case"tool-call":{try{const k=await IPe({toolCall:x,tools:e,repairToolCall:l,system:i,messages:a});w.enqueue(k);const C=e[k.toolName];if(C.execute!=null){const T=fa();h.add(T),nP({name:"ai.toolCall",attributes:M0({telemetry:s,attributes:{...tP({operationId:"ai.toolCall",telemetry:s}),"ai.toolCall.name":k.toolName,"ai.toolCall.id":k.toolCallId,"ai.toolCall.args":{output:()=>JSON.stringify(k.args)}}}),tracer:r,fn:async A=>C.execute(k.args,{toolCallId:k.toolCallId,messages:a,abortSignal:o}).then(N=>{c.enqueue({...k,type:"tool-result",result:N}),h.delete(T),b();try{A.setAttributes(M0({telemetry:s,attributes:{"ai.toolCall.result":{output:()=>JSON.stringify(N)}}}))}catch{}},N=>{c.enqueue({type:"error",error:new SPe({toolCallId:k.toolCallId,toolName:k.toolName,toolArgs:k.args,cause:N})}),h.delete(T),b()})})}}catch(k){c.enqueue({type:"error",error:k})}break}case"finish":{y={type:"finish",finishReason:x.finishReason,logprobs:x.logprobs,usage:cPe(x.usage),experimental_providerMetadata:x.providerMetadata};break}default:{const k=_;throw new Error(`Unhandled chunk type: ${k}`)}}},flush(){m=!0,b()}});return new ReadableStream({async start(x){return Promise.all([t.pipeThrough(v).pipeTo(new WritableStream({write(w){x.enqueue(w)},close(){}})),u.pipeTo(new WritableStream({write(w){x.enqueue(w)},close(){x.close()}}))])}})}var qPe=Ym({prefix:"aitxt",size:24}),VPe=Ym({prefix:"msg",size:24});function WPe({model:e,tools:t,toolChoice:n,system:r,prompt:s,messages:i,maxRetries:a,abortSignal:o,headers:l,maxSteps:c=1,experimental_generateMessageId:u=VPe,experimental_output:d,experimental_continueSteps:h=!1,experimental_telemetry:m,experimental_providerMetadata:y,providerOptions:b=y,experimental_toolCallStreaming:v=!1,toolCallStreaming:x=v,experimental_activeTools:w,experimental_repairToolCall:_,experimental_transform:k,onChunk:C,onError:T,onFinish:A,onStepFinish:N,_internal:{now:I=bPe,generateId:j=qPe,currentDate:L=()=>new Date}={},...D}){return new GPe({model:e,telemetry:m,headers:l,settings:D,maxRetries:a,abortSignal:o,system:r,prompt:s,messages:i,tools:t,toolChoice:n,toolCallStreaming:x,transforms:$Pe(k),activeTools:w,repairToolCall:_,maxSteps:c,output:d,continueSteps:h,providerOptions:b,onChunk:C,onError:T,onFinish:A,onStepFinish:N,now:I,currentDate:L,generateId:j,generateMessageId:u})}function HPe(e){if(!e)return new TransformStream({transform(i,a){a.enqueue({part:i,partialOutput:void 0})}});let t="",n="",r="";function s({controller:i,partialOutput:a=void 0}){i.enqueue({part:{type:"text-delta",textDelta:n},partialOutput:a}),n=""}return new TransformStream({transform(i,a){if(i.type==="step-finish"&&s({controller:a}),i.type!=="text-delta"){a.enqueue({part:i,partialOutput:void 0});return}t+=i.textDelta,n+=i.textDelta;const o=e.parsePartial({text:t});if(o!=null){const l=JSON.stringify(o.partial);l!==r&&(s({controller:a,partialOutput:o.partial}),r=l)}},flush(i){n.length>0&&s({controller:i})}})}var GPe=class{constructor({model:e,telemetry:t,headers:n,settings:r,maxRetries:s,abortSignal:i,system:a,prompt:o,messages:l,tools:c,toolChoice:u,toolCallStreaming:d,transforms:h,activeTools:m,repairToolCall:y,maxSteps:b,output:v,continueSteps:x,providerOptions:w,now:_,currentDate:k,generateId:C,generateMessageId:T,onChunk:A,onError:N,onFinish:I,onStepFinish:j}){this.warningsPromise=new jo,this.usagePromise=new jo,this.finishReasonPromise=new jo,this.providerMetadataPromise=new jo,this.textPromise=new jo,this.reasoningPromise=new jo,this.reasoningDetailsPromise=new jo,this.sourcesPromise=new jo,this.filesPromise=new jo,this.toolCallsPromise=new jo,this.toolResultsPromise=new jo,this.requestPromise=new jo,this.responsePromise=new jo,this.stepsPromise=new jo;var L;if(b<1)throw new Nc({parameter:"maxSteps",value:b,message:"maxSteps must be at least 1"});this.output=v;let D="",H="",O="",K=[],U=[],W,B=[];const ne=[],V={id:C(),timestamp:k(),modelId:e.modelId,messages:[]};let Q=[],ee=[],re,de,me="initial";const De=[];let je;const Te=new TransformStream({async transform(ue,oe){oe.enqueue(ue);const{part:se}=ue;if((se.type==="text-delta"||se.type==="reasoning"||se.type==="source"||se.type==="tool-call"||se.type==="tool-result"||se.type==="tool-call-streaming-start"||se.type==="tool-call-delta")&&await(A==null?void 0:A({chunk:se})),se.type==="error"&&await(N==null?void 0:N({error:se.error})),se.type==="text-delta"&&(D+=se.textDelta,H+=se.textDelta,O+=se.textDelta),se.type==="reasoning"&&(W==null?(W={type:"text",text:se.textDelta},K.push(W)):W.text+=se.textDelta),se.type==="reasoning-signature"){if(W==null)throw new sr({name:"InvalidStreamPart",message:"reasoning-signature without reasoning"});W.signature=se.signature,W=void 0}if(se.type==="redacted-reasoning"&&K.push({type:"redacted",data:se.data}),se.type==="file"&&U.push(se),se.type==="source"&&(ne.push(se.source),B.push(se.source)),se.type==="tool-call"&&Q.push(se),se.type==="tool-result"&&ee.push(se),se.type==="step-finish"){const Ie=j7({text:H,files:U,reasoning:K,tools:c??{},toolCalls:Q,toolResults:ee,messageId:se.messageId,generateMessageId:T}),Be=De.length;let Re="done";Be+1<b&&(x&&se.finishReason==="length"&&Q.length===0?Re="continue":Q.length>0&&ee.length===Q.length&&(Re="tool-result"));const ct={stepType:me,text:D,reasoning:MPe(K),reasoningDetails:K,files:U,sources:B,toolCalls:Q,toolResults:ee,finishReason:se.finishReason,usage:se.usage,warnings:se.warnings,logprobs:se.logprobs,request:se.request,response:{...se.response,messages:[...V.messages,...Ie]},providerMetadata:se.experimental_providerMetadata,experimental_providerMetadata:se.experimental_providerMetadata,isContinued:se.isContinued};await(j==null?void 0:j(ct)),De.push(ct),Q=[],ee=[],D="",B=[],K=[],U=[],W=void 0,Re!=="done"&&(me=Re),Re!=="continue"&&(V.messages.push(...Ie),H="")}se.type==="finish"&&(V.id=se.response.id,V.timestamp=se.response.timestamp,V.modelId=se.response.modelId,V.headers=se.response.headers,de=se.usage,re=se.finishReason)},async flush(ue){var oe;try{if(De.length===0)return;const se=De[De.length-1];Me.warningsPromise.resolve(se.warnings),Me.requestPromise.resolve(se.request),Me.responsePromise.resolve(se.response),Me.toolCallsPromise.resolve(se.toolCalls),Me.toolResultsPromise.resolve(se.toolResults),Me.providerMetadataPromise.resolve(se.experimental_providerMetadata),Me.reasoningPromise.resolve(se.reasoning),Me.reasoningDetailsPromise.resolve(se.reasoningDetails);const Ie=re??"unknown",Be=de??{completionTokens:NaN,promptTokens:NaN,totalTokens:NaN};Me.finishReasonPromise.resolve(Ie),Me.usagePromise.resolve(Be),Me.textPromise.resolve(O),Me.sourcesPromise.resolve(ne),Me.filesPromise.resolve(se.files),Me.stepsPromise.resolve(De),await(I==null?void 0:I({finishReason:Ie,logprobs:void 0,usage:Be,text:O,reasoning:se.reasoning,reasoningDetails:se.reasoningDetails,files:se.files,sources:se.sources,toolCalls:se.toolCalls,toolResults:se.toolResults,request:(oe=se.request)!=null?oe:{},response:se.response,warnings:se.warnings,providerMetadata:se.providerMetadata,experimental_providerMetadata:se.experimental_providerMetadata,steps:De})),je.setAttributes(M0({telemetry:t,attributes:{"ai.response.finishReason":Ie,"ai.response.text":{output:()=>O},"ai.response.toolCalls":{output:()=>{var Re;return(Re=se.toolCalls)!=null&&Re.length?JSON.stringify(se.toolCalls):void 0}},"ai.usage.promptTokens":Be.promptTokens,"ai.usage.completionTokens":Be.completionTokens}}))}catch(se){ue.error(se)}finally{je.end()}}}),_e=yPe();this.addStream=_e.addStream,this.closeStream=_e.close;let Ue=_e.stream;for(const ue of h)Ue=Ue.pipeThrough(ue({tools:c,stopStream(){_e.terminate()}}));this.baseStream=Ue.pipeThrough(HPe(v)).pipeThrough(Te);const{maxRetries:Qe,retry:We}=_3e({maxRetries:s}),Pe=T3e(t),Y=C3e({model:e,telemetry:t,headers:n,settings:{...r,maxRetries:Qe}}),ye=aPe({prompt:{system:(L=v==null?void 0:v.injectIntoSystemPrompt({system:a,model:e}))!=null?L:a,prompt:o,messages:l},tools:c}),Me=this;nP({name:"ai.streamText",attributes:M0({telemetry:t,attributes:{...tP({operationId:"ai.streamText",telemetry:t}),...Y,"ai.prompt":{input:()=>JSON.stringify({system:a,prompt:o,messages:l})},"ai.settings.maxSteps":b}}),tracer:Pe,endWhenDone:!1,fn:async ue=>{je=ue;async function oe({currentStep:se,responseMessages:Ie,usage:Be,stepType:Re,previousStepText:ct,hasLeadingWhitespace:At,messageId:ut}){var Pt;const Ut=Ie.length===0?ye.type:"messages",Ft=[...ye.messages,...Ie],Yt=await U3e({prompt:{type:Ut,system:ye.system,messages:Ft},modelSupportsImageUrls:e.supportsImageUrls,modelSupportsUrl:(Pt=e.supportsUrl)==null?void 0:Pt.bind(e)}),we={type:"regular",...CPe({tools:c,toolChoice:u,activeTools:m})},{result:{stream:F,warnings:X,rawResponse:be,request:Ee},doStreamSpan:ge,startTimestampMs:Ae}=await We(()=>nP({name:"ai.streamText.doStream",attributes:M0({telemetry:t,attributes:{...tP({operationId:"ai.streamText.doStream",telemetry:t}),...Y,"ai.prompt.format":{input:()=>Ut},"ai.prompt.messages":{input:()=>mPe(Yt)},"ai.prompt.tools":{input:()=>{var Zt;return(Zt=we.tools)==null?void 0:Zt.map(rn=>JSON.stringify(rn))}},"ai.prompt.toolChoice":{input:()=>we.toolChoice!=null?JSON.stringify(we.toolChoice):void 0},"gen_ai.system":e.provider,"gen_ai.request.model":e.modelId,"gen_ai.request.frequency_penalty":r.frequencyPenalty,"gen_ai.request.max_tokens":r.maxTokens,"gen_ai.request.presence_penalty":r.presencePenalty,"gen_ai.request.stop_sequences":r.stopSequences,"gen_ai.request.temperature":r.temperature,"gen_ai.request.top_k":r.topK,"gen_ai.request.top_p":r.topP}}),tracer:Pe,endWhenDone:!1,fn:async Zt=>({startTimestampMs:_(),doStreamSpan:Zt,result:await e.doStream({mode:we,...H3e(r),inputFormat:Ut,responseFormat:v==null?void 0:v.responseFormat({model:e}),prompt:Yt,providerMetadata:w,abortSignal:i,headers:n})})})),le=UPe({tools:c,generatorStream:F,toolCallStreaming:d,tracer:Pe,telemetry:t,system:a,messages:Ft,repairToolCall:y,abortSignal:i}),ft=Ee??{},et=[],$=[],qe=[],tt=[];let ve,Se="unknown",ze={promptTokens:0,completionTokens:0,totalTokens:0},Ct,fe=!0,Z="",G=Re==="continue"?ct:"",J,xe={id:C(),timestamp:k(),modelId:e.modelId},Fe="",He=!1,wt=!0,Qt=!1;async function Dn({controller:Zt,chunk:rn}){Zt.enqueue(rn),Z+=rn.textDelta,G+=rn.textDelta,He=!0,Qt=rn.textDelta.trimEnd()!==rn.textDelta}Me.addStream(le.pipeThrough(new TransformStream({async transform(Zt,rn){var fn,br,Mr;if(fe){const ss=_()-Ae;fe=!1,ge.addEvent("ai.stream.firstChunk",{"ai.response.msToFirstChunk":ss}),ge.setAttributes({"ai.response.msToFirstChunk":ss}),rn.enqueue({type:"step-start",messageId:ut,request:ft,warnings:X??[]})}if(Zt.type==="text-delta"&&Zt.textDelta.length===0)return;const rs=Zt.type;switch(rs){case"text-delta":{if(x){const ss=wt&&At?Zt.textDelta.trimStart():Zt.textDelta;if(ss.length===0)break;wt=!1,Fe+=ss;const kr=EPe(Fe);kr!=null&&(Fe=kr.suffix,await Dn({controller:rn,chunk:{type:"text-delta",textDelta:kr.prefix+kr.whitespace}}))}else await Dn({controller:rn,chunk:Zt});break}case"reasoning":{rn.enqueue(Zt),ve==null?(ve={type:"text",text:Zt.textDelta},qe.push(ve)):ve.text+=Zt.textDelta;break}case"reasoning-signature":{if(rn.enqueue(Zt),ve==null)throw new OPe({chunk:Zt,message:"reasoning-signature without reasoning"});ve.signature=Zt.signature,ve=void 0;break}case"redacted-reasoning":{rn.enqueue(Zt),qe.push({type:"redacted",data:Zt.data});break}case"tool-call":{rn.enqueue(Zt),et.push(Zt);break}case"tool-result":{rn.enqueue(Zt),$.push(Zt);break}case"response-metadata":{xe={id:(fn=Zt.id)!=null?fn:xe.id,timestamp:(br=Zt.timestamp)!=null?br:xe.timestamp,modelId:(Mr=Zt.modelId)!=null?Mr:xe.modelId};break}case"finish":{ze=Zt.usage,Se=Zt.finishReason,Ct=Zt.experimental_providerMetadata,J=Zt.logprobs;const ss=_()-Ae;ge.addEvent("ai.stream.finish"),ge.setAttributes({"ai.response.msToFinish":ss,"ai.response.avgCompletionTokensPerSecond":1e3*ze.completionTokens/ss});break}case"file":{tt.push(Zt),rn.enqueue(Zt);break}case"source":case"tool-call-streaming-start":case"tool-call-delta":{rn.enqueue(Zt);break}case"error":{rn.enqueue(Zt),Se="error";break}default:{const ss=rs;throw new Error(`Unknown chunk type: ${ss}`)}}},async flush(Zt){const rn=et.length>0?JSON.stringify(et):void 0;let fn="done";se+1<b&&(x&&Se==="length"&&et.length===0?fn="continue":et.length>0&&$.length===et.length&&(fn="tool-result")),x&&Fe.length>0&&(fn!=="continue"||Re==="continue"&&!He)&&(await Dn({controller:Zt,chunk:{type:"text-delta",textDelta:Fe}}),Fe="");try{ge.setAttributes(M0({telemetry:t,attributes:{"ai.response.finishReason":Se,"ai.response.text":{output:()=>Z},"ai.response.toolCalls":{output:()=>rn},"ai.response.id":xe.id,"ai.response.model":xe.modelId,"ai.response.timestamp":xe.timestamp.toISOString(),"ai.usage.promptTokens":ze.promptTokens,"ai.usage.completionTokens":ze.completionTokens,"gen_ai.response.finish_reasons":[Se],"gen_ai.response.id":xe.id,"gen_ai.response.model":xe.modelId,"gen_ai.usage.input_tokens":ze.promptTokens,"gen_ai.usage.output_tokens":ze.completionTokens}}))}catch{}finally{ge.end()}Zt.enqueue({type:"step-finish",finishReason:Se,usage:ze,providerMetadata:Ct,experimental_providerMetadata:Ct,logprobs:J,request:ft,response:{...xe,headers:be==null?void 0:be.headers},warnings:X,isContinued:fn==="continue",messageId:ut});const br=uPe(Be,ze);if(fn==="done")Zt.enqueue({type:"finish",finishReason:Se,usage:br,providerMetadata:Ct,experimental_providerMetadata:Ct,logprobs:J,response:{...xe,headers:be==null?void 0:be.headers}}),Me.closeStream();else{if(Re==="continue"){const Mr=Ie[Ie.length-1];typeof Mr.content=="string"?Mr.content+=Z:Mr.content.push({text:Z,type:"text"})}else Ie.push(...j7({text:Z,files:tt,reasoning:qe,tools:c??{},toolCalls:et,toolResults:$,messageId:ut,generateMessageId:T}));await oe({currentStep:se+1,responseMessages:Ie,usage:br,stepType:fn,previousStepText:G,hasLeadingWhitespace:Qt,messageId:fn==="continue"?ut:T()})}}})))}await oe({currentStep:0,responseMessages:[],usage:{promptTokens:0,completionTokens:0,totalTokens:0},previousStepText:"",stepType:"initial",hasLeadingWhitespace:!1,messageId:T()})}}).catch(ue=>{Me.addStream(new ReadableStream({start(oe){oe.enqueue({type:"error",error:ue}),oe.close()}})),Me.closeStream()})}get warnings(){return this.warningsPromise.value}get usage(){return this.usagePromise.value}get finishReason(){return this.finishReasonPromise.value}get experimental_providerMetadata(){return this.providerMetadataPromise.value}get providerMetadata(){return this.providerMetadataPromise.value}get text(){return this.textPromise.value}get reasoning(){return this.reasoningPromise.value}get reasoningDetails(){return this.reasoningDetailsPromise.value}get sources(){return this.sourcesPromise.value}get files(){return this.filesPromise.value}get toolCalls(){return this.toolCallsPromise.value}get toolResults(){return this.toolResultsPromise.value}get request(){return this.requestPromise.value}get response(){return this.responsePromise.value}get steps(){return this.stepsPromise.value}teeStream(){const[e,t]=this.baseStream.tee();return this.baseStream=t,e}get textStream(){return BM(this.teeStream().pipeThrough(new TransformStream({transform({part:e},t){e.type==="text-delta"&&t.enqueue(e.textDelta)}})))}get fullStream(){return BM(this.teeStream().pipeThrough(new TransformStream({transform({part:e},t){t.enqueue(e)}})))}async consumeStream(e){var t;try{await zPe({stream:this.fullStream,onError:e==null?void 0:e.onError})}catch(n){(t=e==null?void 0:e.onError)==null||t.call(e,n)}}get experimental_partialOutputStream(){if(this.output==null)throw new xPe;return BM(this.teeStream().pipeThrough(new TransformStream({transform({partialOutput:e},t){e!=null&&t.enqueue(e)}})))}toDataStreamInternal({getErrorMessage:e=()=>"An error occurred.",sendUsage:t=!0,sendReasoning:n=!1,sendSources:r=!1,experimental_sendFinish:s=!0}){return this.fullStream.pipeThrough(new TransformStream({transform:async(i,a)=>{const o=i.type;switch(o){case"text-delta":{a.enqueue(Da("text",i.textDelta));break}case"reasoning":{n&&a.enqueue(Da("reasoning",i.textDelta));break}case"redacted-reasoning":{n&&a.enqueue(Da("redacted_reasoning",{data:i.data}));break}case"reasoning-signature":{n&&a.enqueue(Da("reasoning_signature",{signature:i.signature}));break}case"file":{a.enqueue(Da("file",{mimeType:i.mimeType,data:i.base64}));break}case"source":{r&&a.enqueue(Da("source",i.source));break}case"tool-call-streaming-start":{a.enqueue(Da("tool_call_streaming_start",{toolCallId:i.toolCallId,toolName:i.toolName}));break}case"tool-call-delta":{a.enqueue(Da("tool_call_delta",{toolCallId:i.toolCallId,argsTextDelta:i.argsTextDelta}));break}case"tool-call":{a.enqueue(Da("tool_call",{toolCallId:i.toolCallId,toolName:i.toolName,args:i.args}));break}case"tool-result":{a.enqueue(Da("tool_result",{toolCallId:i.toolCallId,result:i.result}));break}case"error":{a.enqueue(Da("error",e(i.error)));break}case"step-start":{a.enqueue(Da("start_step",{messageId:i.messageId}));break}case"step-finish":{a.enqueue(Da("finish_step",{finishReason:i.finishReason,usage:t?{promptTokens:i.usage.promptTokens,completionTokens:i.usage.completionTokens}:void 0,isContinued:i.isContinued}));break}case"finish":{s&&a.enqueue(Da("finish_message",{finishReason:i.finishReason,usage:t?{promptTokens:i.usage.promptTokens,completionTokens:i.usage.completionTokens}:void 0}));break}default:{const l=o;throw new Error(`Unknown chunk type: ${l}`)}}}}))}pipeDataStreamToResponse(e,{status:t,statusText:n,headers:r,data:s,getErrorMessage:i,sendUsage:a,sendReasoning:o,sendSources:l,experimental_sendFinish:c}={}){E7({response:e,status:t,statusText:n,headers:k7(r,{contentType:"text/plain; charset=utf-8",dataStreamVersion:"v1"}),stream:this.toDataStream({data:s,getErrorMessage:i,sendUsage:a,sendReasoning:o,sendSources:l,experimental_sendFinish:c})})}pipeTextStreamToResponse(e,t){E7({response:e,status:t==null?void 0:t.status,statusText:t==null?void 0:t.statusText,headers:k7(t==null?void 0:t.headers,{contentType:"text/plain; charset=utf-8"}),stream:this.textStream.pipeThrough(new TextEncoderStream)})}toDataStream(e){const t=this.toDataStreamInternal({getErrorMessage:e==null?void 0:e.getErrorMessage,sendUsage:e==null?void 0:e.sendUsage,sendReasoning:e==null?void 0:e.sendReasoning,sendSources:e==null?void 0:e.sendSources,experimental_sendFinish:e==null?void 0:e.experimental_sendFinish}).pipeThrough(new TextEncoderStream);return e!=null&&e.data?GD(e==null?void 0:e.data.stream,t):t}mergeIntoDataStream(e,t){e.merge(this.toDataStreamInternal({getErrorMessage:e.onError,sendUsage:t==null?void 0:t.sendUsage,sendReasoning:t==null?void 0:t.sendReasoning,sendSources:t==null?void 0:t.sendSources,experimental_sendFinish:t==null?void 0:t.experimental_sendFinish}))}toDataStreamResponse({headers:e,status:t,statusText:n,data:r,getErrorMessage:s,sendUsage:i,sendReasoning:a,sendSources:o,experimental_sendFinish:l}={}){return new Response(this.toDataStream({data:r,getErrorMessage:s,sendUsage:i,sendReasoning:a,sendSources:o,experimental_sendFinish:l}),{status:t,statusText:n,headers:_k(e,{contentType:"text/plain; charset=utf-8",dataStreamVersion:"v1"})})}toTextStreamResponse(e){var t;return new Response(this.textStream.pipeThrough(new TextEncoderStream),{status:(t=e==null?void 0:e.status)!=null?t:200,headers:_k(e==null?void 0:e.headers,{contentType:"text/plain; charset=utf-8"})})}};var WJ="2024-11-05",KPe=[WJ,"2024-10-07"],YPe=Ke({name:$e(),version:$e()}).passthrough(),KD=Ke({_meta:ua(Ke({}).passthrough())}).passthrough(),Gw=KD,ZPe=Ke({method:$e(),params:ua(KD)}),XPe=Ke({experimental:ua(Ke({}).passthrough()),logging:ua(Ke({}).passthrough()),prompts:ua(Ke({listChanged:ua(Qn())}).passthrough()),resources:ua(Ke({subscribe:ua(Qn()),listChanged:ua(Qn())}).passthrough()),tools:ua(Ke({listChanged:ua(Qn())}).passthrough())}).passthrough(),JPe=Gw.extend({protocolVersion:$e(),capabilities:XPe,serverInfo:YPe,instructions:ua($e())}),QPe=Gw.extend({nextCursor:ua($e())}),e4e=Ke({name:$e(),description:ua($e()),inputSchema:Ke({type:Mn("object"),properties:ua(Ke({}).passthrough())}).passthrough()}).passthrough(),t4e=QPe.extend({tools:cn(e4e)}),n4e=Ke({type:Mn("text"),text:$e()}).passthrough(),r4e=Ke({type:Mn("image"),data:$e().base64(),mimeType:$e()}).passthrough(),HJ=Ke({uri:$e(),mimeType:ua($e())}).passthrough(),s4e=HJ.extend({text:$e()}),i4e=HJ.extend({blob:$e().base64()}),a4e=Ke({type:Mn("resource"),resource:ms([s4e,i4e])}).passthrough(),o4e=Gw.extend({content:cn(ms([n4e,r4e,a4e])),isError:Qn().default(!1).optional()}).or(Gw.extend({toolResult:nb()})),RT="2.0",l4e=Ke({jsonrpc:Mn(RT),id:ms([$e(),Tt().int()])}).merge(ZPe).strict(),c4e=Ke({jsonrpc:Mn(RT),id:ms([$e(),Tt().int()]),result:Gw}).strict(),u4e=Ke({jsonrpc:Mn(RT),id:ms([$e(),Tt().int()]),error:Ke({code:Tt().int(),message:$e(),data:ua(nb())})}).strict(),d4e=Ke({jsonrpc:Mn(RT)}).merge(Ke({method:$e(),params:ua(KD)})).strict(),f4e=ms([l4e,d4e,c4e,u4e]),h4e=class{constructor({url:e,headers:t}){this.connected=!1,this.url=new URL(e),this.headers=t}async start(){return new Promise((e,t)=>{if(this.connected)return e();this.abortController=new AbortController,(async()=>{var r,s,i;try{const a=new Headers(this.headers);a.set("Accept","text/event-stream");const o=await fetch(this.url.href,{headers:a,signal:(r=this.abortController)==null?void 0:r.signal});if(!o.ok||!o.body){const d=new ca({message:`MCP SSE Transport Error: ${o.status} ${o.statusText}`});return(s=this.onerror)==null||s.call(this,d),t(d)}const c=o.body.pipeThrough(new TextDecoderStream).pipeThrough(FG()).getReader(),u=async()=>{var d,h,m;try{for(;;){const{done:y,value:b}=await c.read();if(y){if(this.connected)throw this.connected=!1,new ca({message:"MCP SSE Transport Error: Connection closed unexpectedly"});return}const{event:v,data:x}=b;if(v==="endpoint"){if(this.endpoint=new URL(x,this.url),this.endpoint.origin!==this.url.origin)throw new ca({message:`MCP SSE Transport Error: Endpoint origin does not match connection origin: ${this.endpoint.origin}`});this.connected=!0,e()}else if(v==="message")try{const w=f4e.parse(JSON.parse(x));(d=this.onmessage)==null||d.call(this,w)}catch(w){const _=new ca({message:"MCP SSE Transport Error: Failed to parse message",cause:w});(h=this.onerror)==null||h.call(this,_)}}}catch(y){if(y instanceof Error&&y.name==="AbortError")return;(m=this.onerror)==null||m.call(this,y),t(y)}};this.sseConnection={close:()=>c.cancel()},u()}catch(a){if(a instanceof Error&&a.name==="AbortError")return;(i=this.onerror)==null||i.call(this,a),t(a)}})()})}async close(){var e,t,n;this.connected=!1,(e=this.sseConnection)==null||e.close(),(t=this.abortController)==null||t.abort(),(n=this.onclose)==null||n.call(this)}async send(e){var t,n,r;if(!this.endpoint||!this.connected)throw new ca({message:"MCP SSE Transport Error: Not connected"});try{const s=new Headers(this.headers);s.set("Content-Type","application/json");const i={method:"POST",headers:s,body:JSON.stringify(e),signal:(t=this.abortController)==null?void 0:t.signal},a=await fetch(this.endpoint,i);if(!a.ok){const o=await a.text().catch(()=>null),l=new ca({message:`MCP SSE Transport Error: POSTing to endpoint (HTTP ${a.status}): ${o}`});(n=this.onerror)==null||n.call(this,l);return}}catch(s){(r=this.onerror)==null||r.call(this,s);return}}};function p4e(e){if(e.type!=="sse")throw new ca({message:"Unsupported or invalid transport configuration. If you are using a custom transport, make sure it implements the MCPTransport interface."});return new h4e(e)}function m4e(e){return"start"in e&&typeof e.start=="function"&&"send"in e&&typeof e.send=="function"&&"close"in e&&typeof e.close=="function"}var g4e="1.0.0";async function P7(e){const t=new y4e(e);return await t.init(),t}var y4e=class{constructor({transport:e,name:t="ai-sdk-mcp-client",onUncaughtError:n}){this.requestMessageId=0,this.responseHandlers=new Map,this.serverCapabilities={},this.isClosed=!0,this.onUncaughtError=n,m4e(e)?this.transport=e:this.transport=p4e(e),this.transport.onclose=()=>this.onClose(),this.transport.onerror=r=>this.onError(r),this.transport.onmessage=r=>{if("method"in r){this.onError(new ca({message:"Unsupported message type"}));return}this.onResponse(r)},this.clientInfo={name:t,version:g4e}}async init(){try{await this.transport.start(),this.isClosed=!1;const e=await this.request({request:{method:"initialize",params:{protocolVersion:WJ,capabilities:{},clientInfo:this.clientInfo}},resultSchema:JPe});if(e===void 0)throw new ca({message:"Server sent invalid initialize result"});if(!KPe.includes(e.protocolVersion))throw new ca({message:`Server's protocol version is not supported: ${e.protocolVersion}`});return this.serverCapabilities=e.capabilities,await this.notification({method:"notifications/initialized"}),this}catch(e){throw await this.close(),e}}async close(){var e;this.isClosed||(await((e=this.transport)==null?void 0:e.close()),this.onClose())}assertCapability(e){switch(e){case"initialize":break;case"tools/list":case"tools/call":if(!this.serverCapabilities.tools)throw new ca({message:"Server does not support tools"});break;default:throw new ca({message:`Unsupported method: ${e}`})}}async request({request:e,resultSchema:t,options:n}){return new Promise((r,s)=>{if(this.isClosed)return s(new ca({message:"Attempted to send a request from a closed client"}));this.assertCapability(e.method);const i=n==null?void 0:n.signal;i==null||i.throwIfAborted();const a=this.requestMessageId++,o={...e,jsonrpc:"2.0",id:a},l=()=>{this.responseHandlers.delete(a)};this.responseHandlers.set(a,c=>{if(i!=null&&i.aborted)return s(new ca({message:"Request was aborted",cause:i.reason}));if(c instanceof Error)return s(c);try{const u=t.parse(c.result);r(u)}catch(u){const d=new ca({message:"Failed to parse server response",cause:u});s(d)}}),this.transport.send(o).catch(c=>{l(),s(c)})})}async listTools({params:e,options:t}={}){try{return this.request({request:{method:"tools/list",params:e},resultSchema:t4e,options:t})}catch(n){throw n}}async callTool({name:e,args:t,options:n}){try{return this.request({request:{method:"tools/call",params:{name:e,arguments:t}},resultSchema:o4e,options:{signal:n==null?void 0:n.abortSignal}})}catch(r){throw r}}async notification(e){const t={...e,jsonrpc:"2.0"};await this.transport.send(t)}async tools({schemas:e="automatic"}={}){var t;const n={};try{const r=await this.listTools();for(const{name:s,description:i,inputSchema:a}of r.tools){if(e!=="automatic"&&!(s in e))continue;const o=e==="automatic"?HX({...a,properties:(t=a.properties)!=null?t:{},additionalProperties:!1}):e[s].parameters,l=this,c={description:i,parameters:o,execute:async(u,d)=>{var h;return(h=d==null?void 0:d.abortSignal)==null||h.throwIfAborted(),l.callTool({name:s,args:u,options:d})}};n[s]=c}return n}catch(r){throw r}}onClose(){if(this.isClosed)return;this.isClosed=!0;const e=new ca({message:"Connection closed"});for(const t of this.responseHandlers.values())t(e);this.responseHandlers.clear()}onError(e){this.onUncaughtError&&this.onUncaughtError(e)}onResponse(e){const t=Number(e.id),n=this.responseHandlers.get(t);if(n===void 0)throw new ca({message:`Protocol error: Received a response for an unknown message ID: ${JSON.stringify(e)}`});this.responseHandlers.delete(t),n("result"in e?e:new ca({message:e.error.message,cause:e.error}))}},b4e={};WD(b4e,{mergeIntoDataStream:()=>w4e,toDataStream:()=>v4e,toDataStreamResponse:()=>x4e});function GJ(e={}){const t=new TextEncoder;let n="";return new TransformStream({async start(){e.onStart&&await e.onStart()},async transform(r,s){s.enqueue(t.encode(r)),n+=r,e.onToken&&await e.onToken(r),e.onText&&typeof r=="string"&&await e.onText(r)},async flush(){e.onCompletion&&await e.onCompletion(n),e.onFinal&&await e.onFinal(n)}})}function YD(e,t){return e.pipeThrough(new TransformStream({transform:async(n,r)=>{var s;if(typeof n=="string"){r.enqueue(n);return}if("event"in n){n.event==="on_chat_model_stream"&&O7((s=n.data)==null?void 0:s.chunk,r);return}O7(n,r)}})).pipeThrough(GJ(t)).pipeThrough(new TextDecoderStream).pipeThrough(new TransformStream({transform:async(n,r)=>{r.enqueue(Da("text",n))}}))}function v4e(e,t){return YD(e,t).pipeThrough(new TextEncoderStream)}function x4e(e,t){var n;const r=YD(e,t==null?void 0:t.callbacks).pipeThrough(new TextEncoderStream),s=t==null?void 0:t.data,i=t==null?void 0:t.init,a=s?GD(s.stream,r):r;return new Response(a,{status:(n=i==null?void 0:i.status)!=null?n:200,statusText:i==null?void 0:i.statusText,headers:_k(i==null?void 0:i.headers,{contentType:"text/plain; charset=utf-8",dataStreamVersion:"v1"})})}function w4e(e,t){t.dataStream.merge(YD(e,t.callbacks))}function O7(e,t){if(typeof e.content=="string")t.enqueue(e.content);else{const n=e.content;for(const r of n)r.type==="text"&&t.enqueue(r.text)}}var S4e={};WD(S4e,{mergeIntoDataStream:()=>k4e,toDataStream:()=>_4e,toDataStreamResponse:()=>C4e});function ZD(e,t){const n=E4e();return Qye(e[Symbol.asyncIterator]()).pipeThrough(new TransformStream({async transform(r,s){s.enqueue(n(r.delta))}})).pipeThrough(GJ(t)).pipeThrough(new TextDecoderStream).pipeThrough(new TransformStream({transform:async(r,s)=>{s.enqueue(Da("text",r))}}))}function _4e(e,t){return ZD(e,t).pipeThrough(new TextEncoderStream)}function C4e(e,t={}){var n;const{init:r,data:s,callbacks:i}=t,a=ZD(e,i).pipeThrough(new TextEncoderStream),o=s?GD(s.stream,a):a;return new Response(o,{status:(n=r==null?void 0:r.status)!=null?n:200,statusText:r==null?void 0:r.statusText,headers:_k(r==null?void 0:r.headers,{contentType:"text/plain; charset=utf-8",dataStreamVersion:"v1"})})}function k4e(e,t){t.dataStream.merge(ZD(e,t.callbacks))}function E4e(){let e=!0;return t=>(e&&(t=t.trimStart(),t&&(e=!1)),t)}class T4e{static async executeInteraction(t,n,r){let s,i=!1,a=null,o,l,c;try{s=await WPe(n);for await(const u of s.fullStream){if(n.abortSignal.aborted){console.log(`[AIService] Stream ${t} aborted by signal.`);break}switch(u.type){case"text-delta":r.onChunk(u.textDelta);break;case"reasoning":r.onReasoningChunk(u.textDelta);break;case"tool-call":r.onToolCall(u);break;case"tool-result":r.onToolResult(u);break;case"step-start":r.onStepStart&&r.onStepStart({messageId:u.messageId,request:u.request,warnings:u.warnings||[]}),console.log(`[AIService] Step started for ${t} - Message ID: ${u.messageId}`);break;case"step-finish":r.onStepFinish&&r.onStepFinish({finishReason:u.finishReason,usage:u.usage,isContinued:u.isContinued||!1,warnings:u.warnings||[]}),console.log(`[AIService] Step finished for ${t} - Reason: ${u.finishReason}, Continued: ${u.isContinued}`);break;case"finish":i=!0,a=u.finishReason,o=u.usage,l=u.providerMetadata;break;case"error":r.onError(new Error(`AI Stream Error Part: ${u.error instanceof Error?u.error.message:u.error}`));return;default:console.warn(`[AIService] Received unexpected stream part type: ${u.type} for ${t}`,u);break}}s!=null&&s.reasoning?(c=await s.reasoning,console.log(`[AIService] Extracted final reasoning for ${t}`)):console.log(`[AIService] No final reasoning found in stream result for ${t}.`),!n.abortSignal.aborted&&i?r.onFinish({finishReason:a,usage:o,providerMetadata:l,reasoning:c}):!n.abortSignal.aborted&&!i&&(console.warn(`[AIService] Stream ${t} ended without a 'finish' part.`),r.onError(new Error("Stream ended unexpectedly without a finish signal.")))}catch(u){console.error(`[AIService] Error during streamText call for ${t}:`,u),u instanceof Error&&u.name==="AbortError"||r.onError(u instanceof Error?u:new Error(String(u)))}finally{console.log(`[AIService] Stream processing finished for ${t}.`)}}}const A4e=".litechat/conversations",KJ="/synced_repos";async function R4e(e,t,n,r=!1){n(t.id,"syncing");const s=qr(`${KJ}/${t.id}`),i={username:t.username,password:t.password},a=t.branch||"main";try{let o=!1;try{await e.promises.stat(Wu(s,".git")),o=!0}catch(l){if(l.code==="ENOENT")o=!1;else throw l}o?(r||ke.info(`Pulling latest changes for "${t.name}"...`),await vT(s,a,i,{fsInstance:e}),r||ke.success(`Repository "${t.name}" synced successfully.`),n(t.id,"idle")):(r||ke.info(`Cloning repository "${t.name}"...`),await WZ(s,t.remoteUrl,a,i,{fsInstance:e}),r||ke.success(`Repository "${t.name}" cloned successfully.`),n(t.id,"idle"))}catch(o){console.error(`Failed to initialize/sync repository ${t.name}:`,o),n(t.id,"error")}}async function N4e(e,t,n,r,s,i,a,o=!1){var h,m;r(t.id,"syncing");const l=qr(`${KJ}/${n.id}`),c=Wu(l,A4e,`${t.id}.json`),u={username:n.username,password:n.password},d=n.branch||"main";try{try{await e.promises.stat(Wu(l,".git"))}catch(w){if(w.code==="ENOENT"){ke.error(`Repository "${n.name}" not found locally. Please clone/sync it from Settings first.`),r(t.id,"error","Repo not cloned");return}throw w}o||ke.info(`Pulling latest changes for "${n.name}"...`),await vT(l,d,u,{fsInstance:e});let y=null,b=null;try{const w=await fp(c,{fsInstance:e}),_=new TextDecoder().decode(w);y=JSON.parse(_),b=(h=y==null?void 0:y.conversation)!=null&&h.updatedAt?new Date(y.conversation.updatedAt).getTime():null,isNaN(b??NaN)&&(b=null)}catch(w){w.code==="ENOENT"?console.log(`Conversation file ${c} not found in repo. Will push local version.`):(console.error(`Failed to read or parse remote conversation file: ${w.message}`),ke.warning(`Could not read remote version of conversation: ${w.message}`))}const v=t.updatedAt.getTime(),x=((m=t.lastSyncedAt)==null?void 0:m.getTime())??0;if(!y||v>(b??0)||v>x&&v>=(b??0)){o||ke.info("Local changes detected. Pushing to remote...");const w=await yt.loadInteractionsForConversation(t.id),{lastSyncedAt:_,...k}=t,C=JSON.stringify({conversation:k,interactions:w},null,2);await xT(c,C,{fsInstance:e}),await AD(l,`Sync conversation: ${t.title} (${t.id})`,{fsInstance:e}),await RD(l,d,u,{fsInstance:e}),await s(t.id,{lastSyncedAt:new Date}),r(t.id,"idle"),o||ke.success("Conversation synced successfully (pushed).")}else if(b&&b>v){o||ke.info("Remote changes detected. Updating local conversation...");const w={...y.conversation,createdAt:new Date(y.conversation.createdAt),updatedAt:new Date(y.conversation.updatedAt),lastSyncedAt:new Date};await yt.saveConversation(w),await yt.deleteInteractionsForConversation(t.id);const _=y.interactions.map(k=>yt.saveInteraction({...k,conversationId:t.id,startedAt:k.startedAt?new Date(k.startedAt):null,endedAt:k.endedAt?new Date(k.endedAt):null}));await Promise.all(_),i()===t.id&&a()==="conversation"&&await nn.getState().loadInteractions(t.id),r(t.id,"idle"),o||ke.success("Conversation synced successfully (pulled).")}else o||ke.info("Conversation already up-to-date."),await s(t.id,{lastSyncedAt:new Date}),r(t.id,"idle")}catch(y){console.error(`Sync failed for conversation ${t.id}:`,y),r(t.id,"error",y.message)}}const Ta={loaded:"project.loaded",added:"project.added",updated:"project.updated",deleted:"project.deleted",loadingStateChanged:"project.loading.state.changed",loadProjectsRequest:"project.load.projects.request",addProjectRequest:"project.add.project.request",updateProjectRequest:"project.update.project.request",deleteProjectRequest:"project.delete.project.request"},tr={conversationsLoaded:"conversation.conversations.loaded",selectedItemChanged:"conversation.selected.item.changed",conversationAdded:"conversation.added",conversationUpdated:"conversation.updated",conversationDeleted:"conversation.deleted",conversationSyncStatusChanged:"conversation.sync.status.changed",syncReposLoaded:"conversation.sync.repos.loaded",syncRepoChanged:"conversation.sync.repo.changed",syncRepoInitStatusChanged:"conversation.sync.repo.init.status.changed",loadingStateChanged:"conversation.loading.state.changed",loadConversationsRequest:"conversation.load.conversations.request",addConversationRequest:"conversation.add.conversation.request",updateConversationRequest:"conversation.update.conversation.request",deleteConversationRequest:"conversation.delete.conversation.request",selectItemRequest:"conversation.select.item.request",importConversationRequest:"conversation.import.conversation.request",exportConversationRequest:"conversation.export.conversation.request",exportProjectRequest:"conversation.export.project.request",exportAllConversationsRequest:"conversation.export.all.conversations.request",loadSyncReposRequest:"conversation.load.sync.repos.request",addSyncRepoRequest:"conversation.add.sync.repo.request",updateSyncRepoRequest:"conversation.update.sync.repo.request",deleteSyncRepoRequest:"conversation.delete.sync.repo.request",linkConversationToRepoRequest:"conversation.link.conversation.to.repo.request",syncConversationRequest:"conversation.sync.conversation.request",initializeOrSyncRepoRequest:"conversation.initialize.or.sync.repo.request",updateCurrentConversationToolSettingsRequest:"conversation.update.current.conversation.tool.settings.request"},Va=Co(ko((e,t)=>({projects:[],isLoading:!1,error:null,loadProjects:async()=>{e({isLoading:!0,error:null});try{const n=await yt.loadProjects();e({projects:n,isLoading:!1}),Ce.emit(Ta.loaded,{projects:n})}catch(n){console.error("ProjectStore: Error loading projects",n),e({error:"Failed to load projects",isLoading:!1}),Ce.emit(Ta.loadingStateChanged,{isLoading:!1,error:"Failed to load projects"})}},addProject:async n=>{var l;const r=Nr(),s=new Date,i=n.parentId?((l=t().getProjectById(n.parentId))==null?void 0:l.path)??"/":"/",a=qr(`${i}/${n.name.replace(/\s+/g,"-").toLowerCase()}-${r.substring(0,4)}`),o={id:r,path:a,createdAt:s,updatedAt:s,name:n.name,parentId:n.parentId??null,systemPrompt:n.systemPrompt??null,modelId:n.modelId??null,temperature:n.temperature??null,maxTokens:n.maxTokens??null,topP:n.topP??null,topK:n.topK??null,presencePenalty:n.presencePenalty??null,frequencyPenalty:n.frequencyPenalty??null,defaultTagIds:n.defaultTagIds??null,defaultRuleIds:n.defaultRuleIds??null,metadata:n.metadata??{}};try{return await yt.saveProject(o),e(c=>{c.projects.unshift(o),c.projects.sort((u,d)=>d.updatedAt.getTime()-u.updatedAt.getTime())}),Ce.emit(Ta.added,{project:o}),r}catch(c){throw console.error("ProjectStore: Error adding project",c),e({error:"Failed to save new project"}),c}},updateProject:async(n,r)=>{var a;const s=t().getProjectById(n);if(!s){console.warn(`ProjectStore: Project ${n} not found for update.`);return}const i={...s,...r,updatedAt:new Date};if(r.name&&r.name!==s.name){const o=s.parentId?((a=t().getProjectById(s.parentId))==null?void 0:a.path)??"/":"/";i.path=qr(`${o}/${r.name.replace(/\s+/g,"-").toLowerCase()}-${n.substring(0,4)}`)}try{await yt.saveProject(i),e(o=>{const l=o.projects.findIndex(c=>c.id===n);l!==-1&&(o.projects[l]=i,o.projects.sort((c,u)=>u.updatedAt.getTime()-c.updatedAt.getTime()))}),Ce.emit(Ta.updated,{projectId:n,updates:i})}catch(o){throw console.error("ProjectStore: Error updating project",o),e({error:"Failed to save project update"}),o}},deleteProject:async n=>{const r=t().projects.find(a=>a.id===n);if(!r)return;const s=new Set,i=a=>{s.add(a),t().projects.filter(o=>o.parentId===a).forEach(o=>i(o.id))};i(n);try{await yt.deleteProject(n),e(a=>({projects:a.projects.filter(o=>!s.has(o.id))})),Ce.emit(tr.loadConversationsRequest,void 0),Ce.emit(Ta.deleted,{projectId:n}),ke.success(`Project "${r.name}" and its contents deleted.`)}catch(a){throw console.error("ProjectStore: Error deleting project",a),e({error:"Failed to delete project"}),a}},getProjectById:n=>{if(n)return t().projects.find(r=>r.id===n)},getTopLevelProjectId:n=>{if(!n)return null;let r=t().getProjectById(n);if(!r)return null;for(;r.parentId;){const s=t().getProjectById(r.parentId);if(!s)break;r=s}return r.id},getEffectiveProjectSettings:n=>{const r=pr.getState(),s=Gn.getState().selectedModelId,i={systemPrompt:r.globalSystemPrompt,modelId:s,temperature:r.temperature,maxTokens:r.maxTokens,topP:r.topP,topK:r.topK,presencePenalty:r.presencePenalty,frequencyPenalty:r.frequencyPenalty,defaultTagIds:null,defaultRuleIds:null};if(!n)return i;const a=t().getProjectById(n);if(!a)return i;const o=a.parentId?t().getEffectiveProjectSettings(a.parentId):i;return{systemPrompt:a.systemPrompt!==null&&a.systemPrompt!==void 0?a.systemPrompt:o.systemPrompt,modelId:a.modelId!==null&&a.modelId!==void 0?a.modelId:o.modelId,temperature:a.temperature!==null&&a.temperature!==void 0?a.temperature:o.temperature,maxTokens:a.maxTokens!==null&&a.maxTokens!==void 0?a.maxTokens:o.maxTokens,topP:a.topP!==null&&a.topP!==void 0?a.topP:o.topP,topK:a.topK!==null&&a.topK!==void 0?a.topK:o.topK,presencePenalty:a.presencePenalty!==null&&a.presencePenalty!==void 0?a.presencePenalty:o.presencePenalty,frequencyPenalty:a.frequencyPenalty!==null&&a.frequencyPenalty!==void 0?a.frequencyPenalty:o.frequencyPenalty,defaultTagIds:a.defaultTagIds!==null&&a.defaultTagIds!==void 0?a.defaultTagIds:o.defaultTagIds,defaultRuleIds:a.defaultRuleIds!==null&&a.defaultRuleIds!==void 0?a.defaultRuleIds:o.defaultRuleIds}},getRegisteredActionHandlers:()=>{const n="projectStore",r=t(),s=i=>async a=>{await i(a)};return[{eventName:Ta.loadProjectsRequest,handler:r.loadProjects,storeId:n},{eventName:Ta.addProjectRequest,handler:s(r.addProject),storeId:n},{eventName:Ta.updateProjectRequest,handler:i=>r.updateProject(i.id,i.updates),storeId:n},{eventName:Ta.deleteProjectRequest,handler:i=>r.deleteProject(i.id),storeId:n}]}}))),Xp=(e,t)=>{const n=URL.createObjectURL(e),r=document.createElement("a");r.href=n,r.download=t,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(n)},I4e=(e,t)=>{let n=`# ${e.title}

`;return n+=`*Conversation ID: ${e.id}*
`,n+=`*Created: ${Vd(e.createdAt,"yyyy-MM-dd HH:mm:ss")}*
`,n+=`*Last Updated: ${Vd(e.updatedAt,"yyyy-MM-dd HH:mm:ss")}*
`,e.projectId&&(n+=`*Project ID: ${e.projectId}*
`),n+=`
---

`,t.filter(r=>r.type==="message.user_assistant").sort((r,s)=>r.index-s.index).forEach(r=>{var s,i,a,o,l,c,u,d;((s=r.prompt)!=null&&s.content||(o=(a=(i=r.prompt)==null?void 0:i.metadata)==null?void 0:a.attachedFiles)!=null&&o.length)&&(n+=`## User (Index: ${r.index})

`,(l=r.prompt.metadata)!=null&&l.attachedFiles&&r.prompt.metadata.attachedFiles.length>0&&(n+=`**Attached Files:**
`,r.prompt.metadata.attachedFiles.forEach(h=>{n+=`- ${h.name} (${h.type}, ${_w(h.size)}) ${h.source==="vfs"?`(VFS: ${h.path})`:"(Direct Upload)"}
`}),n+=`
`),r.prompt.content&&(n+=`${r.prompt.content}

`)),r.response&&(n+=`## Assistant (Index: ${r.index})

`,(c=r.metadata)!=null&&c.modelId&&(n+=`*Model: ${r.metadata.modelId}*

`),typeof r.response=="string"?n+=`${r.response}

`:(n+="```json\n",n+=`${JSON.stringify(r.response,null,2)}
`,n+="```\n\n"),((u=r.metadata)!=null&&u.promptTokens||(d=r.metadata)!=null&&d.completionTokens)&&(n+=`*Tokens: ${r.metadata.promptTokens??"?"} (prompt) / ${r.metadata.completionTokens??"?"} (completion)*

`)),n+=`---

`}),n};class j0{static async importConversation(t,n,r){try{const s=await t.text(),i=JSON.parse(s);if(!i||typeof i!="object"||!i.conversation||!Array.isArray(i.interactions))throw new Error("Invalid import file format. Expected { conversation: {}, interactions: [] }.");const a=i.conversation,o=i.interactions;if(!a.id||!a.title||!a.createdAt||!a.updatedAt)throw new Error("Invalid conversation data in import file.");const l=await n({title:a.title||"Imported Chat",metadata:a.metadata,projectId:null,syncRepoId:null,lastSyncedAt:null}),c=o.map(u=>yt.saveInteraction({...u,conversationId:l,id:Nr()}));await Promise.all(c),await r(l,"conversation"),ke.success("Conversation imported successfully.")}catch(s){throw console.error("ImportExportService: Error importing conversation",s),ke.error(`Import failed: ${s instanceof Error?s.message:String(s)}`),s}}static async exportConversation(t,n){try{const r=jn.getState().getConversationById(t);if(!r)throw new Error("Conversation not found.");const s=await yt.loadInteractionsForConversation(t);let i,a;const o=r.title.replace(/[^a-z0-9]/gi,"_").toLowerCase()||"conversation";if(n==="json"){const c=JSON.stringify({conversation:r,interactions:s},null,2);i=new Blob([c],{type:"application/json"}),a=`litechat_conversation_${o}_${t.substring(0,6)}.json`}else if(n==="md"){const l=I4e(r,s);i=new Blob([l],{type:"text/markdown"}),a=`litechat_conversation_${o}_${t.substring(0,6)}.md`}else throw new Error("Invalid export format specified.");Xp(i,a),ke.success(`Conversation exported as ${n.toUpperCase()}.`)}catch(r){throw console.error("ImportExportService: Error exporting conversation",r),ke.error(`Export failed: ${r instanceof Error?r.message:String(r)}`),r}}static async exportProject(t){try{const{projects:n,getProjectById:r}=Va.getState(),{conversations:s}=jn.getState(),i=r(t);if(!i)throw new Error("Project not found.");const a=async h=>{const m=n.find(x=>x.id===h);if(!m)throw new Error(`Project ${h} not found in state.`);const y=n.filter(x=>x.parentId===h),b=s.filter(x=>x.projectId===h),v=[];for(const x of y)v.push(await a(x.id));for(const x of b){const w=await yt.loadInteractionsForConversation(x.id);v.push({conversation:x,interactions:w})}return{project:m,children:v}},o=await a(t),l=JSON.stringify(o,null,2),c=new Blob([l],{type:"application/json"}),d=`litechat_project_${i.name.replace(/[^a-z0-9]/gi,"_").toLowerCase()||"project"}_${t.substring(0,6)}.json`;Xp(c,d),ke.success(`Project "${i.name}" exported.`)}catch(n){throw console.error("ImportExportService: Error exporting project",n),ke.error(`Project export failed: ${n instanceof Error?n.message:String(n)}`),n}}static async exportAllConversations(){try{const t=jn.getState().conversations,n=[];for(const a of t){const o=await yt.loadInteractionsForConversation(a.id);n.push({conversation:a,interactions:o})}const r=JSON.stringify(n,null,2),s=new Blob([r],{type:"application/json"}),i=`litechat_all_conversations_export_${new Date().toISOString().split("T")[0]}.json`;Xp(s,i),ke.success("All conversations exported.")}catch(t){throw console.error("ImportExportService: Error exporting conversations",t),ke.error(`Export failed: ${t instanceof Error?t.message:String(t)}`),t}}static async exportFullConfiguration(t){try{const n=await yt.getAllDataForExport(t),r=JSON.stringify(n,null,2),s=new Blob([r],{type:"application/json"}),a=`litechat_full_config_${Vd(new Date,"yyyy-MM-dd_HH-mm-ss")}.json`;Xp(s,a),ke.success("Full configuration exported successfully.")}catch(n){throw console.error("ImportExportService: Error exporting full configuration",n),ke.error(`Export failed: ${n instanceof Error?n.message:String(n)}`),n}}static async exportPromptTemplates(){try{const n=(await yt.loadPromptTemplates()).filter(l=>!l.type||l.type==="prompt"),r={version:1,exportedAt:new Date().toISOString(),promptTemplates:n},s=JSON.stringify(r,null,2),i=new Blob([s],{type:"application/json"}),o=`litechat_prompt_templates_${Vd(new Date,"yyyy-MM-dd_HH-mm-ss")}.json`;Xp(i,o),ke.success(`Exported ${n.length} prompt templates.`)}catch(t){throw console.error("ImportExportService: Error exporting prompt templates",t),ke.error(`Export failed: ${t instanceof Error?t.message:String(t)}`),t}}static async exportAgents(){try{const t=await yt.loadPromptTemplates(),n=t.filter(u=>u.type==="agent"),r=n.map(u=>u.id),s=t.filter(u=>u.type==="task"&&u.parentId&&r.includes(u.parentId)),i={version:1,exportedAt:new Date().toISOString(),agents:[...n,...s]},a=JSON.stringify(i,null,2),o=new Blob([a],{type:"application/json"}),c=`litechat_agents_${Vd(new Date,"yyyy-MM-dd_HH-mm-ss")}.json`;Xp(o,c),ke.success(`Exported ${n.length} agents with ${s.length} tasks.`)}catch(t){throw console.error("ImportExportService: Error exporting agents",t),ke.error(`Export failed: ${t instanceof Error?t.message:String(t)}`),t}}static async exportMcpServers(){try{const t=await yt.loadSetting("mcpServers",[]),n={version:1,exportedAt:new Date().toISOString(),mcpServers:t},r=JSON.stringify(n,null,2),s=new Blob([r],{type:"application/json"}),a=`litechat_mcp_servers_${Vd(new Date,"yyyy-MM-dd_HH-mm-ss")}.json`;Xp(s,a),ke.success(`Exported ${t.length} MCP server configurations.`)}catch(t){throw console.error("ImportExportService: Error exporting MCP servers",t),ke.error(`Export failed: ${t instanceof Error?t.message:String(t)}`),t}}static async importFullConfiguration(t,n){try{const r=await t.text(),s=JSON.parse(r);if(!s||typeof s!="object"||!s.version)throw new Error("Invalid import file format. Missing version or basic structure.");await yt.importAllData(s,n),ke.success("Configuration imported successfully. Reloading application..."),setTimeout(()=>window.location.reload(),1500)}catch(r){throw console.error("ImportExportService: Error importing full configuration",r),ke.error(`Full import failed: ${r instanceof Error?r.message:String(r)}`),r}}static async importPromptTemplates(t){try{const n=await t.text(),r=JSON.parse(n);if(!r||typeof r!="object"||!r.promptTemplates||!Array.isArray(r.promptTemplates))throw new Error("Invalid prompt templates file format.");let s=0;for(const i of r.promptTemplates)try{await yt.savePromptTemplate({...i,id:i.id||Nr(),createdAt:i.createdAt?new Date(i.createdAt):new Date,updatedAt:new Date}),s++}catch(a){console.warn(`Failed to import template ${i.name}:`,a)}ke.success(`Imported ${s} prompt templates.`)}catch(n){throw console.error("ImportExportService: Error importing prompt templates",n),ke.error(`Import failed: ${n instanceof Error?n.message:String(n)}`),n}}static async importAgents(t){try{const n=await t.text(),r=JSON.parse(n);if(!r||typeof r!="object"||!r.agents||!Array.isArray(r.agents))throw new Error("Invalid agents file format.");let s=0,i=0;for(const a of r.agents)try{await yt.savePromptTemplate({...a,id:a.id||Nr(),createdAt:a.createdAt?new Date(a.createdAt):new Date,updatedAt:new Date}),a.type==="agent"?s++:a.type==="task"&&i++}catch(o){console.warn(`Failed to import ${a.type} ${a.name}:`,o)}ke.success(`Imported ${s} agents with ${i} tasks.`)}catch(n){throw console.error("ImportExportService: Error importing agents",n),ke.error(`Import failed: ${n instanceof Error?n.message:String(n)}`),n}}static async importMcpServers(t){try{const n=await t.text(),r=JSON.parse(n);if(!r||typeof r!="object"||!r.mcpServers||!Array.isArray(r.mcpServers))throw new Error("Invalid MCP servers file format.");await yt.saveSetting("mcpServers",r.mcpServers),ke.success(`Imported ${r.mcpServers.length} MCP server configurations.`)}catch(n){throw console.error("ImportExportService: Error importing MCP servers",n),ke.error(`Import failed: ${n instanceof Error?n.message:String(n)}`),n}}}const pu="sync_repos",ds={repoChanged:"sync.repo.changed",repoInitStatusChanged:"sync.repo.init.status.changed",bulkSyncStarted:"sync.bulk.sync.started",bulkSyncProgress:"sync.bulk.sync.progress",bulkSyncCompleted:"sync.bulk.sync.completed",bulkSyncFailed:"sync.bulk.sync.failed"},ti=Co(ko((e,t)=>({nodes:{},childrenMap:{"":[]},rootId:null,currentParentId:null,selectedFileIds:new Set,loading:!1,operationLoading:!1,error:null,fs:null,enableVfs:!0,vfsKey:null,configuredVfsKey:null,initializingKey:null,_setLoading:n=>{e(r=>{r.loading=n,n&&(r.error=null)}),Ce.emit(hn.loadingStateChanged,{isLoading:t().loading,operationLoading:t().operationLoading,error:t().error})},_setOperationLoading:n=>{e(r=>{r.operationLoading=n}),Ce.emit(hn.loadingStateChanged,{isLoading:t().loading,operationLoading:t().operationLoading,error:t().error})},_setError:n=>{e(r=>{r.error=n,r.loading=!1,r.operationLoading=!1,r.initializingKey=null,n&&ke.error(`VFS Error: ${n}`)}),Ce.emit(hn.loadingStateChanged,{isLoading:t().loading,operationLoading:t().operationLoading,error:t().error})},_addNodes:n=>{e(r=>{const s={};n.forEach(i=>{r.nodes[i.id]=i;const a=i.parentId??r.rootId??"";s[a]||(s[a]=r.childrenMap[a]?[...r.childrenMap[a]]:[]),s[a].includes(i.id)||s[a].push(i.id)});for(const i in s)(!r.childrenMap[i]||JSON.stringify(r.childrenMap[i].sort())!==JSON.stringify(s[i].sort()))&&(r.childrenMap[i]=s[i])}),Ce.emit(hn.nodesUpdated,{vfsKey:t().vfsKey,nodes:t().nodes,childrenMap:t().childrenMap})},_updateNode:(n,r)=>{e(s=>{s.nodes[n]&&Object.assign(s.nodes[n],r)}),Ce.emit(hn.nodesUpdated,{vfsKey:t().vfsKey,nodes:t().nodes,childrenMap:t().childrenMap})},_removeNodes:n=>{e(r=>{n.forEach(s=>{const i=r.nodes[s];if(i){const a=i.parentId??r.rootId??"";if(r.childrenMap[a]&&(r.childrenMap[a]=r.childrenMap[a].filter(o=>o!==s)),delete r.nodes[s],r.selectedFileIds.delete(s),i.type==="folder"){const o=Object.values(r.nodes).filter(l=>l.parentId===s).map(l=>l.id);o.length>0&&t()._removeNodes(o),delete r.childrenMap[s]}}})}),Ce.emit(hn.nodesUpdated,{vfsKey:t().vfsKey,nodes:t().nodes,childrenMap:t().childrenMap}),Ce.emit(hn.selectionChanged,{selectedFileIds:Array.from(t().selectedFileIds)})},_setFsInstance:n=>{e({fs:n}),Ce.emit(hn.fsInstanceChanged,{fsInstance:n})},_setEnableVfs:n=>{console.log(`[VfsStore] Setting global enableVfs to: ${n}`),e({enableVfs:n}),Ce.emit(hn.vfsEnabledChanged,{enabled:n}),n||(e({fs:null,configuredVfsKey:null,vfsKey:null,rootId:null,currentParentId:null,nodes:{},childrenMap:{"":[]},error:null,loading:!1,operationLoading:!1,initializingKey:null}),Ce.emit(hn.vfsKeyChanged,{vfsKey:null,configuredVfsKey:null}))},_setConfiguredVfsKey:n=>{e({configuredVfsKey:n}),Ce.emit(hn.vfsKeyChanged,{vfsKey:t().vfsKey,configuredVfsKey:n})},setVfsKey:n=>{if(n!==null){const r=t().vfsKey,s=t().configuredVfsKey;if(n===r){n&&n!==s&&!t().initializingKey&&t().initializeVFS(n).catch(i=>{console.error(`[VfsStore] Error during re-initialization trigger for ${n}:`,i)});return}console.log(`[VfsStore] setVfsKey: Changing desired key from ${r} to ${n}. Configured: ${s}`),e({vfsKey:n}),e({fs:null,configuredVfsKey:null,rootId:null,currentParentId:null,nodes:{},childrenMap:{"":[]},error:null,loading:!1,operationLoading:!1,selectedFileIds:new Set,initializingKey:null}),Ce.emit(hn.vfsKeyChanged,{vfsKey:n,configuredVfsKey:null}),n!==null&&t().initializeVFS(n).catch(i=>{console.error(`[VfsStore] Error during initialization trigger for ${n}:`,i)})}},initializeVFS:async(n,r)=>{let s,i;if(typeof n=="object"&&n!==null&&"vfsKey"in n)console.warn("[VfsStore] initializeVFS called with a single object payload. Correcting. Input:",JSON.parse(JSON.stringify(n))),s=String(n.vfsKey),i=n.options;else if(typeof n=="string")s=n,i=r;else{const h=`[VfsStore] initializeVFS called with invalid vfsKey type. Type: ${typeof n}, Value: "${String(n)}". Aborting.`;throw console.error(h,n),new Error("VFS key must be a string and cannot be empty.")}if(!s||s.trim()===""){const h=`[VfsStore] initializeVFS: Derived vfsKey is empty or invalid. Original param: ${String(n)}, Derived key: "${s}". Aborting.`;throw console.error(h,{originalVfsKeyParam:n,originalOptionsParam:r}),new Error("VFS key cannot be empty after processing.")}const a=(i==null?void 0:i.force)===!0;if(t().initializingKey===s){const h=`Initialization skipped for "${s}". Already actively initializing this exact key.`;return console.warn(`[VfsStore] ${h}`),new Promise((m,y)=>{const b=setInterval(()=>{const v=t();v.initializingKey!==s&&(clearInterval(b),v.configuredVfsKey===s&&v.fs?m(v.fs):y(new Error(`VFS initialization for "${s}" failed or was interrupted`)))},100);setTimeout(()=>{clearInterval(b),y(new Error(`Timeout waiting for VFS "${s}" initialization to complete`))},1e4)})}if(t().configuredVfsKey===s&&t().fs)return a||e({loading:!1}),t().fs;if(!a){if(t().vfsKey!==s){const h=`UI Initialization aborted for "${s}". Desired key is now "${t().vfsKey}".`;throw console.warn(`[VfsStore] ${h}`),new Error(h)}if(t().initializingKey!==null&&t().initializingKey!==s){const h=`UI Initialization skipped for "${s}". Already initializing a different key "${t().initializingKey}".`;throw console.warn(`[VfsStore] ${h}`),new Error(h)}}const{_setLoading:o,_setError:l,_addNodes:c,_setFsInstance:u,_setConfiguredVfsKey:d}=t();console.log(`[VfsStore] Initializing VFS with key: ${s} (Forced: ${a})`),e({initializingKey:s}),a||(o(!0),l(null));try{const h=await HTe(s);if(!h)throw new Error("Filesystem backend initialization failed.");if(!a&&t().vfsKey!==s){const b=`UI Initialization for key "${s}" completed, but desired key changed to "${t().vfsKey}". Discarding result.`;throw console.warn(`[VfsStore] ${b}`),e({initializingKey:null,loading:!1}),new Error(b)}if(a)return u(h),d(s),e({initializingKey:null}),Ce.emit(hn.loadingStateChanged,{isLoading:!1,operationLoading:!1,error:null}),h;u(h),d(s),console.log(`[VfsStore] UI VFS instance configured for key: ${s}`);const m="vfs-root";let y=t().nodes[m];try{await h.promises.stat("/")}catch(b){if(b.code==="ENOENT")console.warn("[VfsStore] Root directory '/' not found, will be created implicitly.");else throw b}if(!y||y.path!=="/"){const b=Date.now();y={id:m,parentId:null,name:"",path:"/",type:"folder",createdAt:b,lastModified:b},c([y])}return e(b=>{b.rootId=y.id,b.currentParentId=y.id}),await t().fetchNodes(y.id),h}catch(h){const m=`Failed to initialize VFS (${s}): ${h instanceof Error?h.message:String(h)}`;throw console.error(`[VfsStore DEBUG] Error in initializeVFS catch block: ${m}`,h),t().initializingKey===s&&(l(m),a||(u(null),d(null))),new Error(m)}finally{t().initializingKey===s&&(e({initializingKey:null}),a||e({loading:!1}))}},fetchNodes:async(n=null)=>{const{_setLoading:r,_setError:s,_addNodes:i,fs:a,nodes:o,rootId:l,configuredVfsKey:c,vfsKey:u,initializingKey:d}=t();if(!a||c!==u||d){console.warn(`[VfsStore] fetchNodes skipped. Ready: ${!!a}, Match: ${c===u}, Init: ${d}`);return}r(!0);try{const h=n?o[n]:o[l||""],m=h?h.path:"/",y=await ND(m,{fsInstance:a}),b=n??l??"",v=new Set(y.map(C=>C.path)),_=(t().childrenMap[b]||[]).map(C=>t().nodes[C]).filter(Boolean).filter(C=>!v.has(C.path)).map(C=>C.id);_.length>0&&t()._removeNodes(_);const k=y.map(C=>{const T=Object.values(t().nodes).find(N=>N.path===C.path),A=Date.now();return{id:(T==null?void 0:T.id)||Nr(),parentId:n,name:C.name,path:C.path,type:C.isDirectory?"folder":"file",size:C.size,createdAt:(T==null?void 0:T.createdAt)??A,lastModified:C.lastModified.getTime(),mimeType:C.isDirectory?void 0:C.mimeType}});k.length>0&&i(k),e(C=>{const T=k.map(A=>A.id);(!C.childrenMap[b]||JSON.stringify(C.childrenMap[b].sort())!==JSON.stringify(T.sort()))&&(C.childrenMap[b]=T)})}catch(h){console.error("Failed to fetch VFS nodes:",h),s("Failed to load directory contents.")}finally{r(!1)}},findNodeByPath:n=>{const r=qr(n);if(t().vfsKey===t().configuredVfsKey){if(r==="/"){const s=t().rootId;return s?t().nodes[s]:void 0}return Object.values(t().nodes).find(s=>s.path===r)}},setCurrentPath:async n=>{const{findNodeByPath:r,fetchNodes:s,rootId:i,fs:a}=t();if(!a||t().vfsKey!==t().configuredVfsKey)return;const o=qr(n),l=r(o);l&&l.type==="folder"?(e(c=>{c.currentParentId=l.id}),t().childrenMap[l.id]||await s(l.id)):o==="/"&&i?(e(c=>{c.currentParentId=i}),t().childrenMap[i]||await s(i)):console.warn(`Path not found or not a directory: ${n}`)},createDirectory:async(n,r)=>{const{_setOperationLoading:s,_setError:i,fs:a,nodes:o,rootId:l,_addNodes:c,configuredVfsKey:u,vfsKey:d}=t();if(!a||u!==d){i("Filesystem not ready.");return}if(!r.trim()){i("Directory name cannot be empty.");return}s(!0);try{const h=n?o[n]:o[l||""],m=h?h.path:"/",y=V3(m,r.trim());try{throw await a.promises.stat(y),new Error(`"${r.trim()}" already exists.`)}catch(w){if(w.code!=="ENOENT")throw w}await KZ(y,{fsInstance:a});const b=Date.now(),x={id:Nr(),parentId:n,name:r.trim(),path:y,type:"folder",createdAt:b,lastModified:b};c([x])}catch(h){console.error("Failed to create directory:",h),i(h.message||"Failed to create directory.")}finally{s(!1)}},uploadFiles:async(n,r)=>{const{_setOperationLoading:s,_setError:i,fs:a,nodes:o,rootId:l,configuredVfsKey:c,vfsKey:u}=t();if(!a||c!==u){i("Filesystem not ready.");return}s(!0);try{const d=n?o[n]:o[l||""],h=d?d.path:"/";await YZ(Array.from(r),h,{fsInstance:a}),await t().fetchNodes(n)}catch(d){console.error("Failed to upload files:",d),i("Failed to upload one or more files.")}finally{s(!1)}},deleteNodes:async n=>{const{_setOperationLoading:r,_setError:s,_removeNodes:i,fs:a,configuredVfsKey:o,vfsKey:l}=t();if(!a||o!==l){s("Filesystem not ready.");return}r(!0);try{const c=n.map(u=>t().nodes[u]).filter(Boolean);for(const u of c)await ID(u.path,u.type==="folder",{fsInstance:a});i(n)}catch(c){console.error("Failed to delete nodes:",c),s("Failed to delete one or more items."),await t().fetchNodes(t().currentParentId)}finally{r(!1)}},renameNode:async(n,r)=>{const{_setOperationLoading:s,_setError:i,_updateNode:a,nodes:o,fs:l,rootId:c,configuredVfsKey:u,vfsKey:d}=t();if(!l||u!==d){i("Filesystem not ready.");return}if(!r.trim()){i("Name cannot be empty.");return}const h=o[n];if(!h){i("Item not found.");return}if(h.name!==r.trim()){s(!0);try{const m=h.parentId?o[h.parentId]:o[c||""],y=m?m.path:"/",b=V3(y,r.trim());try{throw await l.promises.stat(b),new Error(`"${r.trim()}" already exists.`)}catch(x){if(x.code!=="ENOENT")throw x}await ZZ(h.path,b,{fsInstance:l});const v={name:r.trim(),path:b,lastModified:Date.now()};a(n,v)}catch(m){console.error("Failed to rename item:",m),i(m.message||"Failed to rename item.")}finally{s(!1)}}},downloadFile:async n=>{const{nodes:r,fs:s,_setError:i,configuredVfsKey:a,vfsKey:o}=t();if(!s||a!==o)return i("Filesystem not ready."),null;const l=r[n];if(!l||l.type!=="file")return i("File not found."),null;try{const c=await fp(l.path,{fsInstance:s}),u=l.mimeType||"application/octet-stream",d=new Blob([c],{type:u});return{name:l.name,blob:d}}catch(c){return console.error("Failed to download file:",c),i("Failed to retrieve file content."),null}},selectFile:n=>{e(r=>{r.selectedFileIds.add(n)}),Ce.emit(hn.selectionChanged,{selectedFileIds:Array.from(t().selectedFileIds)})},deselectFile:n=>{e(r=>{r.selectedFileIds.delete(n)}),Ce.emit(hn.selectionChanged,{selectedFileIds:Array.from(t().selectedFileIds)})},clearSelection:()=>{e(n=>{n.selectedFileIds.clear()}),Ce.emit(hn.selectionChanged,{selectedFileIds:[]})},resetStuckInitialization:()=>{console.warn("[VfsStore] Force resetting stuck initialization state"),e({initializingKey:null,loading:!1,operationLoading:!1,error:null})},getRegisteredActionHandlers:()=>{const n="vfsStore",r=t(),s=i=>async a=>{await i(a)};return[{eventName:hn.setVfsKeyRequest,handler:i=>r.setVfsKey(i.key),storeId:n},{eventName:hn.initializeVFSRequest,handler:async i=>{await r.initializeVFS(i.vfsKey,i.options)},storeId:n},{eventName:hn.fetchNodesRequest,handler:i=>r.fetchNodes(i.parentId),storeId:n},{eventName:hn.setCurrentPathRequest,handler:i=>r.setCurrentPath(i.path),storeId:n},{eventName:hn.createDirectoryRequest,handler:i=>r.createDirectory(i.parentId,i.name),storeId:n},{eventName:hn.uploadFilesRequest,handler:i=>r.uploadFiles(i.parentId,i.files),storeId:n},{eventName:hn.deleteNodesRequest,handler:i=>r.deleteNodes(i.ids),storeId:n},{eventName:hn.renameNodeRequest,handler:i=>r.renameNode(i.id,i.newName),storeId:n},{eventName:hn.downloadFileRequest,handler:s(r.downloadFile),storeId:n},{eventName:hn.selectFileRequest,handler:i=>r.selectFile(i.fileId),storeId:n},{eventName:hn.deselectFileRequest,handler:i=>r.deselectFile(i.fileId),storeId:n},{eventName:hn.clearSelectionRequest,handler:r.clearSelection,storeId:n},{eventName:hn.setEnableVfsRequest,handler:i=>r._setEnableVfs(i.enabled),storeId:n}]}}))),M4e="/synced_repos",jn=Co(ko((e,t)=>({conversations:[],selectedItemId:null,selectedItemType:null,syncRepos:[],conversationSyncStatus:{},repoInitializationStatus:{},isLoading:!1,error:null,_ensureSyncVfsReady:async()=>(console.log("[ConversationStore] Ensuring Sync VFS is ready..."),ti.getState().initializingKey===pu&&(console.warn("[ConversationStore] VFS appears stuck in initializing state, resetting..."),ti.getState().resetStuckInitialization()),new Promise((r,s)=>{let i=null;const a=()=>{Ce.off(hn.fsInstanceChanged,o),Ce.off(hn.loadingStateChanged,l),i&&(clearTimeout(i),i=null)},o=u=>{ti.getState().configuredVfsKey===pu&&u.fsInstance&&(console.log(`[ConversationStore] Sync VFS ready via fsInstanceChanged for key ${pu}.`),a(),r(u.fsInstance))},l=u=>{const d=ti.getState();d.configuredVfsKey===pu&&(u.error?(console.error(`[ConversationStore] Sync VFS initialization error for key ${pu}: ${u.error}`),a(),s(new Error(u.error))):!u.isLoading&&!u.operationLoading&&d.fs&&(console.log(`[ConversationStore] Sync VFS ready via loadingStateChanged for key ${pu}.`),a(),r(d.fs)))};Ce.on(hn.fsInstanceChanged,o),Ce.on(hn.loadingStateChanged,l);const c=ti.getState();if(c.configuredVfsKey===pu&&c.fs&&!c.loading&&!c.operationLoading&&!c.error){console.log(`[ConversationStore] Sync VFS already ready for key ${pu}.`),a(),r(c.fs);return}i=setTimeout(()=>{const u=`Timeout waiting for Sync VFS (${pu}) to become ready.`;console.error(`[ConversationStore] ${u}`),a(),s(new Error(u))},3e4),Ce.emit(hn.initializeVFSRequest,{vfsKey:pu,options:{force:!0}})})),loadConversations:async()=>{e({isLoading:!0,error:null});try{const[n,r]=await Promise.all([yt.loadConversations(),yt.loadSyncRepos()]),s={};n.forEach(i=>{if(i.syncRepoId){const a=i.lastSyncedAt instanceof Date?i.lastSyncedAt.getTime():null,o=i.updatedAt instanceof Date?i.updatedAt.getTime():null;a?o&&o>a?s[i.id]="needs-sync":s[i.id]="idle":s[i.id]="needs-sync"}else s[i.id]="idle"}),e({conversations:n,syncRepos:r,conversationSyncStatus:s,repoInitializationStatus:{},isLoading:!1}),Ce.emit(tr.conversationsLoaded,{conversations:n}),Ce.emit(tr.syncReposLoaded,{repos:r})}catch(n){console.error("ConversationStore: Error loading conversations",n),e({error:"Failed load conversations",isLoading:!1}),Ce.emit(tr.loadingStateChanged,{isLoading:!1,error:"Failed load conversations"})}},addConversation:async n=>{const r=Nr(),s=new Date,i={id:r,createdAt:s,updatedAt:s,title:n.title,projectId:n.projectId??null,metadata:{...n.metadata??{},enabledTools:[],toolMaxStepsOverride:null},syncRepoId:n.syncRepoId??null,lastSyncedAt:n.lastSyncedAt??null};let a=!1;try{const o=JSON.stringify(i);return await yt.saveConversation(JSON.parse(o)),a=!0,e(l=>{l.conversations.some(c=>c.id===i.id)||(l.conversations.unshift(i),l.conversationSyncStatus[r]=i.syncRepoId?"needs-sync":"idle")}),Ce.emit(tr.conversationAdded,{conversation:i}),r}catch(o){throw console.error("ConversationStore: Error adding conversation",o),a&&e(l=>({error:"Failed to save new conversation to state",conversations:l.conversations.filter(c=>c.id!==r),conversationSyncStatus:Object.fromEntries(Object.entries(l.conversationSyncStatus).filter(([c])=>c!==r))})),o}},updateConversation:async(n,r)=>{const s=t().getConversationById(n);if(!s){console.warn(`ConversationStore: Conversation ${n} not found for update.`);return}e(a=>{const o=a.conversations.findIndex(l=>l.id===n);if(o!==-1){const l=a.conversations[o].metadata??{},c=r.metadata??{},u={...l,...c};Object.assign(a.conversations[o],{...r,metadata:u,updatedAt:new Date});const d=["title","metadata","projectId"].some(y=>y in r),h=a.conversations[o].lastSyncedAt instanceof Date?a.conversations[o].lastSyncedAt.getTime():null,m=a.conversations[o].updatedAt.getTime();"syncRepoId"in r?a.conversationSyncStatus[n]=r.syncRepoId?"needs-sync":"idle":d&&a.conversations[o].syncRepoId&&a.conversationSyncStatus[n]==="idle"&&(!h||m>h)&&(a.conversationSyncStatus[n]="needs-sync")}});const i=t().getConversationById(n);if(i)try{const a=JSON.parse(JSON.stringify(i));await yt.saveConversation(a),Ce.emit(tr.conversationUpdated,{conversationId:n,updates:r})}catch(a){throw console.error("ConversationStore: Error updating conversation",a),e(o=>{const l=o.conversations.findIndex(c=>c.id===n);if(l!==-1){o.conversations[l]=s;const c=s.lastSyncedAt instanceof Date?s.lastSyncedAt.getTime():null,u=s.updatedAt.getTime();o.conversationSyncStatus[n]=s.syncRepoId&&c&&u<=c?"idle":s.syncRepoId?"needs-sync":"idle"}o.error="Failed to save conversation update"}),a}else console.error("ConversationStore: Failed to retrieve updated conversation state after update."),e(a=>{const o=a.conversations.findIndex(l=>l.id===n);if(o!==-1){a.conversations[o]=s;const l=s.lastSyncedAt instanceof Date?s.lastSyncedAt.getTime():null,c=s.updatedAt.getTime();a.conversationSyncStatus[n]=s.syncRepoId&&l&&c<=l?"idle":s.syncRepoId?"needs-sync":"idle"}a.error="Failed to save conversation update (state error)"})},deleteConversation:async n=>{const r=t().selectedItemId,s=t().selectedItemType,i=t().conversations.find(a=>a.id===n);if(i){e(a=>({conversations:a.conversations.filter(o=>o.id!==n),selectedItemId:r===n&&s==="conversation"?null:r,selectedItemType:r===n&&s==="conversation"?null:s,conversationSyncStatus:Object.fromEntries(Object.entries(a.conversationSyncStatus).filter(([o])=>o!==n))}));try{await yt.deleteConversation(n),await yt.deleteInteractionsForConversation(n),Ce.emit(tr.conversationDeleted,{conversationId:n}),r===n&&s==="conversation"&&(Ce.emit(xn.setCurrentConversationIdRequest,{id:null}),Ce.emit(tr.selectedItemChanged,{itemId:null,itemType:null}))}catch(a){throw console.error("ConversationStore: Error deleting conversation",a),e(o=>{if(i){o.conversations.push(i);const l=i.lastSyncedAt instanceof Date?i.lastSyncedAt.getTime():null,c=i.updatedAt.getTime();o.conversationSyncStatus[n]=i.syncRepoId&&l&&c<=l?"idle":i.syncRepoId?"needs-sync":"idle"}r===n&&s==="conversation"&&(o.selectedItemId=n,o.selectedItemType="conversation"),o.error="Failed to delete conversation"}),a}}},selectItem:async(n,r)=>{const s=t().selectedItemId,i=t().selectedItemType;if(s===n&&i===r)return;console.log(`ConversationStore: Selecting item. ID: ${n}, Type: ${r}. Previous: ${s} (${i})`);const a=r==="conversation"?n:null;a&&(Ce.emit(xn.setCurrentConversationIdRequest,{id:a}),Ce.emit(xn.loadInteractionsRequest,{conversationId:a})),e({selectedItemId:n,selectedItemType:r}),Ce.emit(tr.selectedItemChanged,{itemId:n,itemType:r})},importConversation:async n=>{await j0.importConversation(n,t().addConversation,t().selectItem)},exportConversation:async(n,r)=>{await j0.exportConversation(n,r)},exportProject:async n=>{await j0.exportProject(n)},exportAllConversations:async()=>{await j0.exportAllConversations()},loadSyncRepos:async()=>{if(!t().isLoading){e({isLoading:!0,error:null});try{const n=await yt.loadSyncRepos();e({syncRepos:n,isLoading:!1}),Ce.emit(tr.syncReposLoaded,{repos:n})}catch(n){console.error("ConversationStore: Error loading sync repos",n),e({error:"Failed load sync repositories",isLoading:!1}),Ce.emit(tr.loadingStateChanged,{isLoading:!1,error:"Failed load sync repositories"})}}},addSyncRepo:async n=>{const r=Nr(),s=new Date,i={id:r,createdAt:s,updatedAt:s,name:n.name,remoteUrl:n.remoteUrl,branch:n.branch||"main",username:n.username??null,password:n.password??null};e(a=>{a.syncRepos.push(i)});try{const a=t().syncRepos.find(o=>o.id===r);if(a){const o=JSON.parse(JSON.stringify(a));await yt.saveSyncRepo(o),Ce.emit(ds.repoChanged,{repoId:r,action:"added"})}else throw new Error("Failed to retrieve newly added sync repo state");ke.success(`Sync repository "${i.name}" added.`);try{await t().initializeOrSyncRepo(r)}catch(o){console.warn(`Failed to automatically initialize repository "${i.name}":`,o),ke.warning(`Repository "${i.name}" added but initialization failed. You can manually sync it later.`)}return r}catch(a){throw console.error("ConversationStore: Error adding sync repo",a),e(o=>({error:"Failed to save sync repository",syncRepos:o.syncRepos.filter(l=>l.id!==r)})),a}},updateSyncRepo:async(n,r)=>{const s=t().syncRepos.find(a=>a.id===n);if(!s){console.warn(`ConversationStore: SyncRepo ${n} not found.`);return}e(a=>{const o=a.syncRepos.findIndex(l=>l.id===n);o!==-1&&Object.assign(a.syncRepos[o],{...r,branch:r.branch||a.syncRepos[o].branch||"main",updatedAt:new Date})});const i=t().syncRepos.find(a=>a.id===n);if(i)try{const a=JSON.parse(JSON.stringify(i));await yt.saveSyncRepo(a),Ce.emit(ds.repoChanged,{repoId:n,action:"updated"}),ke.success(`Sync repository "${i.name}" updated.`)}catch(a){throw console.error("ConversationStore: Error updating sync repo",a),e(o=>{const l=o.syncRepos.findIndex(c=>c.id===n);l!==-1&&(o.syncRepos[l]=s),o.error="Failed to save sync repository update"}),a}else console.error("ConversationStore: Failed to retrieve updated sync repo state after update."),e(a=>{const o=a.syncRepos.findIndex(l=>l.id===n);o!==-1&&(a.syncRepos[o]=s),a.error="Failed to save sync repository update (state error)"})},deleteSyncRepo:async n=>{const r=t().syncRepos.find(s=>s.id===n);if(r)try{let s;try{s=await t()._ensureSyncVfsReady()}catch(a){throw console.error("ConversationStore: Failed to initialize sync VFS for deletion",a),ke.error("Failed to initialize filesystem for deletion. Repository not deleted."),a}await yt.deleteSyncRepo(n);const i=qr(`${M4e}/${n}`);try{await ID(i,!0,{fsInstance:s}),console.log(`[ConversationStore] Successfully deleted VFS directory: ${i}`)}catch(a){console.error(`[ConversationStore] Failed to delete VFS directory ${i}:`,a),a.code!=="ENOENT"&&console.warn(`Could not remove local sync folder for "${r.name}": ${a.message}`)}e(a=>({syncRepos:a.syncRepos.filter(o=>o.id!==n),repoInitializationStatus:Object.fromEntries(Object.entries(a.repoInitializationStatus).filter(([o])=>o!==n))})),Ce.emit(ds.repoChanged,{repoId:n,action:"deleted"}),ke.success(`Sync repository "${r.name}" deleted.`)}catch(s){throw console.error("ConversationStore: Error deleting sync repo",s),e(i=>{i.error="Failed to delete sync repository"}),s}},linkConversationToRepo:async(n,r)=>{await t().updateConversation(n,{syncRepoId:r,lastSyncedAt:null}),t()._setConversationSyncStatus(n,r?"needs-sync":"idle"),ke.info(`Conversation ${r?"linked to":"unlinked from"} sync repository.`)},_setConversationSyncStatus:(n,r,s=null)=>{e(i=>{i.conversationSyncStatus[n]=r,r==="error"&&s&&console.error(`Sync error for ${n}: ${s}`)}),Ce.emit(tr.conversationSyncStatusChanged,{conversationId:n,status:r})},_setRepoInitializationStatus:(n,r)=>{e(s=>{s.repoInitializationStatus[n]=r}),Ce.emit(ds.repoInitStatusChanged,{repoId:n,status:r})},initializeOrSyncRepo:async(n,r=!1)=>{const s=t().syncRepos.find(a=>a.id===n);if(!s){r||ke.error("Sync repsitory configuration not found.");return}let i;try{i=await t()._ensureSyncVfsReady()}catch{t()._setRepoInitializationStatus(n,"error");return}await R4e(i,s,t()._setRepoInitializationStatus,r)},syncConversation:async(n,r=!1)=>{const s=t().getConversationById(n);if(!s){r||ke.error("Conversation not found for syncing.");return}if(!s.syncRepoId){r||ke.info("Conversation not linked to a sync repository.");return}const i=t().syncRepos.find(l=>l.id===s.syncRepoId);if(!i){r||ke.error("Sync repository configuration not found."),t()._setConversationSyncStatus(n,"error","Repo not found");return}let a;try{a=await t()._ensureSyncVfsReady()}catch{t()._setConversationSyncStatus(n,"error","Filesystem not ready");return}await N4e(a,s,i,t()._setConversationSyncStatus,t().updateConversation,()=>t().selectedItemId,()=>t().selectedItemType,r);const o=t().getConversationById(n);o&&e(l=>{const c=l.conversations.findIndex(u=>u.id===n);c!==-1&&(l.conversations[c]=o)})},getConversationById:n=>{if(n)return t().conversations.find(r=>r.id===n)},syncAllConversations:async()=>{const{BulkSyncService:n}=await Fr(async()=>{const{BulkSyncService:r}=await Promise.resolve().then(()=>Z0);return{BulkSyncService:r}},void 0);await n.syncAll({syncRepos:!1,syncConversations:!0,continueOnError:!0,maxConcurrent:3})},syncPendingConversations:async()=>{const{BulkSyncService:n}=await Fr(async()=>{const{BulkSyncService:r}=await Promise.resolve().then(()=>Z0);return{BulkSyncService:r}},void 0);await n.syncPendingConversations()},initializeAllRepositories:async()=>{const{BulkSyncService:n}=await Fr(async()=>{const{BulkSyncService:r}=await Promise.resolve().then(()=>Z0);return{BulkSyncService:r}},void 0);await n.initializeAllRepositories()},updateCurrentConversationToolSettings:async n=>{const{selectedItemId:r,selectedItemType:s,updateConversation:i}=t();if(s!=="conversation"||!r){console.warn("Cannot update tool settings: No conversation selected.");return}const a=t().getConversationById(r);if(!a){console.warn("Cannot update tool settings: Selected conversation not found.");return}const o=a.metadata??{},l={...o};n.enabledTools!==void 0&&(l.enabledTools=n.enabledTools),n.toolMaxStepsOverride!==void 0&&(l.toolMaxStepsOverride=n.toolMaxStepsOverride),(JSON.stringify(l)!==JSON.stringify(o)||!a.metadata)&&await i(r,{metadata:l})},_unlinkConversationsFromProjects:n=>{const r=new Set(n);e(s=>{s.conversations=s.conversations.map(i=>i.projectId&&r.has(i.projectId)?{...i,projectId:null}:i)})},getRegisteredActionHandlers:()=>{const n="conversationStore",r=t(),s=i=>async a=>{await i(a)};return[{eventName:tr.loadConversationsRequest,handler:r.loadConversations,storeId:n},{eventName:tr.addConversationRequest,handler:s(r.addConversation),storeId:n},{eventName:tr.updateConversationRequest,handler:i=>r.updateConversation(i.id,i.updates),storeId:n},{eventName:tr.deleteConversationRequest,handler:i=>r.deleteConversation(i.id),storeId:n},{eventName:tr.selectItemRequest,handler:i=>r.selectItem(i.id,i.type),storeId:n},{eventName:tr.importConversationRequest,handler:i=>r.importConversation(i.file),storeId:n},{eventName:tr.exportConversationRequest,handler:i=>r.exportConversation(i.conversationId,i.format),storeId:n},{eventName:tr.exportProjectRequest,handler:i=>r.exportProject(i.projectId),storeId:n},{eventName:tr.exportAllConversationsRequest,handler:r.exportAllConversations,storeId:n},{eventName:tr.loadSyncReposRequest,handler:r.loadSyncRepos,storeId:n},{eventName:tr.addSyncRepoRequest,handler:s(r.addSyncRepo),storeId:n},{eventName:tr.updateSyncRepoRequest,handler:i=>r.updateSyncRepo(i.id,i.updates),storeId:n},{eventName:tr.deleteSyncRepoRequest,handler:i=>r.deleteSyncRepo(i.id),storeId:n},{eventName:tr.linkConversationToRepoRequest,handler:i=>r.linkConversationToRepo(i.conversationId,i.repoId),storeId:n},{eventName:tr.syncConversationRequest,handler:i=>r.syncConversation(i.conversationId),storeId:n},{eventName:tr.initializeOrSyncRepoRequest,handler:i=>r.initializeOrSyncRepo(i.repoId),storeId:n},{eventName:tr.updateCurrentConversationToolSettingsRequest,handler:i=>r.updateCurrentConversationToolSettings(i),storeId:n}]}}))),Gi={copyInteractionResponseRequest:"canvas.interaction.copy.response.request",regenerateInteractionRequest:"canvas.interaction.regenerate.request",regenerateInteractionWithModelRequest:"canvas.interaction.regenerate.with.model.request",forkConversationRequest:"canvas.interaction.fork.conversation.request",forkConversationWithModelRequest:"canvas.interaction.fork.conversation.with.model.request",forkConversationCompactRequest:"canvas.interaction.fork.conversation.compact.request",raceInteractionRequest:"canvas.interaction.race.request",editResponseRequest:"canvas.interaction.edit.response.request",copyCodeBlockRequest:"canvas.codeblock.copy.request",editCodeBlockRequest:"canvas.codeblock.edit.request"},xh={async submitPrompt(e){var j,L,D,H,O,K;console.log("[ConversationService] submitPrompt called",e);const t=nn.getState(),n=Va.getState(),r=co.getState(),s=jn.getState(),i=pr.getState(),a=t.currentConversationId;if(!a){ke.error("Cannot submit prompt: No active conversation."),console.error("[ConversationService] submitPrompt failed: No conversationId.");return}const o=s.getConversationById(a),l=(o==null?void 0:o.projectId)??null,c=n.getEffectiveProjectSettings(l),d=t.interactions.filter(U=>U.conversationId===a).length===0&&i.autoTitleEnabled&&((j=e.metadata)==null?void 0:j.autoTitleEnabledForTurn)===!0&&i.autoTitleModelId,m=t.interactions.filter(U=>U.parentId===null&&U.status==="COMPLETED").sort((U,W)=>U.index-W.index).map(U=>{var W;if(U.type==="message.assistant_regen"&&((W=U.metadata)!=null&&W.regeneratedFromId)){const B=t.interactions.find(ne=>ne.id===U.metadata.regeneratedFromId);if(B&&B.prompt&&B.type==="message.user_assistant")return{...U,prompt:B.prompt,type:"message.user_assistant"}}return U.type==="message.user_assistant"&&U.prompt?U:null}).filter(Boolean),y=Ox(m);let b=e.content;const v=[],x=((L=e.metadata)==null?void 0:L.effectiveRulesContent)??[],w=x.filter(U=>U.type==="system").map(U=>U.content),_=x.filter(U=>U.type==="before").map(U=>U.content),k=x.filter(U=>U.type==="after").map(U=>U.content);_.length>0&&(b=`${_.join(`
`)}

${b}`),k.length>0&&(b=`${b}

    ${k.join(`
`)}`),b&&v.push({type:"text",text:b});const C=((D=e.metadata)==null?void 0:D.attachedFiles)??[];if(C.length>0){const U=await this._processFilesForPrompt(C,a);v.unshift(...U)}v.length>0?y.push({role:"user",content:v}):console.warn("[ConversationService] No user text or file content found in turnData. Submitting without user message.");let A=((H=e.metadata)==null?void 0:H.turnSystemPrompt)??c.systemPrompt??void 0;w.length>0&&(A=`${A?`${A}

        `:""}${w.join(`
`)}`);const N={temperature:r.temperature,max_tokens:r.maxTokens,top_p:r.topP,top_k:r.topK,presence_penalty:r.presencePenalty,frequency_penalty:r.frequencyPenalty,...e.parameters??{}};Object.keys(N).forEach(U=>{(N[U]===null||N[U]===void 0)&&delete N[U]});const I={system:A,messages:y,parameters:N,metadata:{...(({turnSystemPrompt:U,activeTagIds:W,activeRuleIds:B,effectiveRulesContent:ne,autoTitleEnabledForTurn:V,...Q})=>({...Q,effectivelyAppliedTagIds:W,effectivelyAppliedRuleIds:B}))(e.metadata??{}),modelId:r.modelId??void 0,attachedFiles:(O=e.metadata.attachedFiles)==null?void 0:O.map(({contentBase64:U,contentText:W,...B})=>B)}};try{const U=bl.startInteraction(I,a,e);if(d){console.log("[ConversationService] Triggering asynchronous title generation.");const W=(((K=e.metadata)==null?void 0:K.effectiveRulesContent)??[]).map(B=>({id:B.sourceRuleId||Nr(),name:B.sourceRuleId?`Rule ${B.sourceRuleId.substring(0,4)}`:"Context Rule",content:B.content,type:B.type,createdAt:new Date,updatedAt:new Date}));this.generateConversationTitle(a,e,W).catch(B=>{console.error("[ConversationService] Background title generation failed:",B)})}await U}catch(U){throw console.error("[ConversationService] Error starting interaction:",U),ke.error(`Failed to start interaction: ${U instanceof Error?U.message:String(U)}`),U}},async generateConversationTitle(e,t,n){var o,l;const r=pr.getState();if(!r.autoTitleModelId){console.warn("[ConversationService] Auto-title generation skipped: No model selected in settings.");return}let s=t.content;if(s.length>r.autoTitlePromptMaxLength&&(s=s.substring(0,r.autoTitlePromptMaxLength)+"..."),r.autoTitleIncludeFiles&&((l=(o=t.metadata)==null?void 0:o.attachedFiles)!=null&&l.length)){const c=t.metadata.attachedFiles.map(u=>u.name).join(", ");s+=`

[Attached files: ${c}]`}if(r.autoTitleIncludeRules&&n.length>0){const c=n.map(u=>u.name).join(", ");s+=`

[Active rules: ${c}]`}const i={system:"Generate a concise, descriptive title (max 8-10 words) for the following user prompt. Output ONLY the title text, nothing else.",messages:[{role:"user",content:s}],parameters:{temperature:.5,max_tokens:20},metadata:{modelId:r.autoTitleModelId,isTitleGeneration:!0},tools:void 0,toolChoice:"none"},a={id:Nr(),content:`[Generate title based on: ${t.content.substring(0,50)}...]`,parameters:i.parameters,metadata:{...i.metadata,originalTurnId:t.id}};try{await bl.startInteraction(i,e,a,"conversation.title_generation")}catch(c){console.error("[ConversationService] Error starting title generation interaction:",c)}},async regenerateInteraction(e){var D,H,O,K;console.log(`[ConversationService] regenerateInteraction called for ID: ${e}`);const t=nn.getState(),n=Va.getState(),r=co.getState(),s=jn.getState(),i=t.interactions.find(U=>U.id===e);if(console.log("[ConversationService] Target interaction for regen:",JSON.parse(JSON.stringify(i))),!i||!i.prompt){ke.error("Cannot regenerate: Original interaction data missing.");return}const a=null,o=i.index,l=i.prompt,c=i.conversationId,u=s.getConversationById(c),d=(u==null?void 0:u.projectId)??null,h=n.getEffectiveProjectSettings(d),m=i.index,y=t.interactions.filter(U=>U.conversationId===c&&U.index<m&&U.status==="COMPLETED"&&U.type==="message.user_assistant"&&U.parentId===null).sort((U,W)=>U.index-W.index),b=Ox(y);let v=l.content;const x=[],w=((D=l.metadata)==null?void 0:D.effectiveRulesContent)??[],_=w.filter(U=>U.type==="system").map(U=>U.content),k=w.filter(U=>U.type==="before").map(U=>U.content),C=w.filter(U=>U.type==="after").map(U=>U.content);k.length>0&&(v=`${k.join(`
`)}

${v}`),C.length>0&&(v=`${v}

    ${C.join(`
`)}`),v&&x.push({type:"text",text:v});const T=((H=l.metadata)==null?void 0:H.attachedFiles)??[];if(T.length>0){const U=await this._processFilesForPrompt(T,c);x.unshift(...U)}x.length>0?b.push({role:"user",content:x}):console.warn("[ConversationService] No user text or file content found in original turnData for regeneration.");let N=((O=l.metadata)==null?void 0:O.turnSystemPrompt)??h.systemPrompt??void 0;_.length>0&&(N=`${N?`${N}

        `:""}${_.join(`
`)}`);const I={temperature:r.temperature,max_tokens:r.maxTokens,top_p:r.topP,top_k:r.topK,presence_penalty:r.presencePenalty,frequency_penalty:r.frequencyPenalty,...l.parameters??{}};Object.keys(I).forEach(U=>{(I[U]===null||I[U]===void 0)&&delete I[U]});const j={system:N,messages:b,parameters:I,metadata:{...(({turnSystemPrompt:U,activeTagIds:W,activeRuleIds:B,effectiveRulesContent:ne,autoTitleEnabledForTurn:V,...Q})=>({...Q,effectivelyAppliedTagIds:W,effectivelyAppliedRuleIds:B}))(l.metadata??{}),modelId:r.modelId??void 0,regeneratedFromId:e,attachedFiles:T.map(({contentBase64:U,contentText:W,...B})=>B)}};let L=null;try{if(L=await bl.startInteraction(j,c,l,"message.assistant_regen"),!L)throw new Error("Failed to create new interaction for regeneration.");const U={};let W=!1;L.index!==o&&(U.index=o,W=!0),L.parentId!==a&&(U.parentId=a,W=!0);let B=L;W&&(t._updateInteractionInState(L.id,U),B={...L,...U},await yt.saveInteraction(B)),console.log("[ConversationService] New active interaction state after potential updates:",JSON.parse(JSON.stringify(B)));const ne=[];let V=i;for(;V;){ne.push(V);const ee=(K=V.metadata)==null?void 0:K.regeneratedFromId;ee?V=t.interactions.find(re=>re.id===ee):V=null}const Q=ne.sort((ee,re)=>{var De,je;const de=((De=ee.startedAt)==null?void 0:De.getTime())??0,me=((je=re.startedAt)==null?void 0:je.getTime())??0;return de-me});for(let ee=0;ee<Q.length;ee++){const re=Q[ee],de={parentId:B.id,index:ee};console.log(`[ConversationService] Updating old version ${re.id} to be child of ${B.id} with childIndex ${ee}`,JSON.parse(JSON.stringify(de))),t._updateInteractionInState(re.id,de),await yt.saveInteraction({...re,...de})}}catch(U){throw console.error("[ConversationService] Error during regeneration process:",U),ke.error(`Failed to regenerate response: ${U instanceof Error?U.message:String(U)}`),U}},_pendingForks:new Set,_pendingCompactForks:new Set,async forkConversation(e){if(console.log(`[ConversationService] forkConversation called for ID: ${e}`),this._pendingForks.has(e)){console.warn(`[ConversationService] Fork already in progress for ${e}`),ke.info("Fork already in progress for this interaction.");return}this._pendingForks.add(e);try{const t=nn.getState(),n=jn.getState(),r=t.interactions.find(l=>l.id===e);if(!r){ke.error("Cannot fork: Interaction not found.");return}const s=n.getConversationById(r.conversationId);if(!s){ke.error("Cannot fork: Original conversation not found.");return}const i=t.interactions.filter(l=>l.conversationId===r.conversationId&&l.index<=r.index&&l.parentId===null&&(l.type==="message.user_assistant"||l.type==="message.assistant_regen")).sort((l,c)=>l.index-c.index),a=`Fork: ${s.title}`,o=await n.addConversation({title:a,projectId:s.projectId,metadata:s.metadata});for(let l=0;l<i.length;l++){const c=i[l],u={...c,id:Nr(),conversationId:o,index:l,parentId:null,startedAt:new Date,endedAt:c.endedAt?new Date:null,metadata:{...c.metadata,forkedFromId:c.id}};await yt.saveInteraction(u)}await n.selectItem(o,"conversation"),Ce.emit(an.focusInputRequest,void 0),ke.success(`Conversation forked successfully: "${a}"`)}catch(t){throw console.error("[ConversationService] Error during fork process:",t),ke.error(`Failed to fork conversation: ${t instanceof Error?t.message:String(t)}`),t}finally{this._pendingForks.delete(e)}},async forkConversationCompact(e,t){if(console.log(`[ConversationService] forkConversationCompact called for ID: ${e} with model: ${t}`),this._pendingCompactForks.has(e)){console.warn(`[ConversationService] Compact fork already in progress for ${e}`),ke.info("Compact fork already in progress for this interaction.");return}this._pendingCompactForks.add(e);try{const n=nn.getState(),r=jn.getState(),s=pr.getState(),i=n.interactions.find(T=>T.id===e);if(!i){ke.error("Cannot fork compact: Interaction not found.");return}const a=r.getConversationById(i.conversationId);if(!a){ke.error("Cannot fork compact: Original conversation not found.");return}const o=n.interactions.filter(T=>T.conversationId===i.conversationId&&T.index<=i.index&&T.parentId===null&&(T.type==="message.user_assistant"||T.type==="message.assistant_regen")).sort((T,A)=>T.index-A.index),l=Ox(o),c=T=>typeof T=="string"?T:Array.isArray(T)?T.map(A=>A.type==="text"?A.text:A.type==="image"?"[Image attached]":`[${A.type||"Content"} attached]`).join(" "):typeof T=="object"&&T!==null?"text"in T&&typeof T.text=="string"?T.text:"[Non-text content]":String(T),u=l.map(T=>`**${T.role.toUpperCase()}:** ${c(T.content)}`).join(`

`),d=s.forkCompactPrompt,m=d?`${d}

Here is our conversation history to summarize:

${u}`:`Please provide a comprehensive but concise summary of our previous conversation. Include:
1. The main topics discussed
2. Key decisions or conclusions reached
3. Important context that would be needed to continue the conversation
4. Any specific technical details, code, or data that were mentioned

Keep the summary detailed enough that we can seamlessly continue our discussion, but compact enough to be efficient.

Here is our conversation history to summarize:

${u}`,y=s.forkCompactModelId||t,b={system:"You are an expert at creating comprehensive conversation summaries. Provide a detailed but concise summary that captures all important context and information needed to continue the conversation seamlessly.",messages:[{role:"user",content:m}],parameters:{temperature:.3,max_tokens:2e3},metadata:{modelId:y,isCompactGeneration:!0},tools:void 0,toolChoice:"none"},v=`Compact: ${a.title}`,x=await r.addConversation({title:v,projectId:a.projectId,metadata:a.metadata}),w=`Please provide a comprehensive summary of our previous conversation titled "${a.title}". Include the main topics, key decisions, and important context needed to continue seamlessly.`,_={id:Nr(),conversationId:x,type:"message.user_assistant",prompt:{id:Nr(),content:w,parameters:{},metadata:{isResumeMessage:!0,originalConversationId:i.conversationId,compactedFromInteractionId:e}},response:"Compacting...",status:"STREAMING",startedAt:new Date,endedAt:null,metadata:{isResumeMessage:!0,originalConversationId:i.conversationId,compactedFromInteractionId:e,isCompactingInProgress:!0},index:0,parentId:null};await yt.saveInteraction(_),nn.getState()._addInteractionToState(_),await r.selectItem(x,"conversation"),await new Promise(T=>{const A=N=>{N.conversationId===x&&(Ce.off(xn.loaded,A),T())};Ce.on(xn.loaded,A),setTimeout(()=>{Ce.off(xn.loaded,A),T()},2e3)});const C={id:Nr(),content:`[Internal compact generation for conversation ${e}]`,parameters:b.parameters,metadata:{...b.metadata,originalConversationId:i.conversationId,compactedFromInteractionId:e,targetUserInteractionId:_.id,targetConversationId:x}};await bl.startInteraction(b,x,C,"conversation.compact"),Ce.emit(an.focusInputRequest,void 0),ke.success(`Conversation compacted and forked: "${v}"`)}catch(n){throw console.error("[ConversationService] Error during compact fork process:",n),ke.error(`Failed to fork and compact conversation: ${n instanceof Error?n.message:String(n)}`),n}finally{this._pendingCompactForks.delete(e)}},async _processFilesForPrompt(e,t){const n=[],r=e.filter(i=>i.source==="vfs");let s;if(r.length>0){const i=jn.getState().getConversationById(t),a=(i==null?void 0:i.projectId)??"orphan";try{s=await this._ensureVfsReady(a)}catch{ke.error(`Filesystem unavailable for key ${a}. VFS files cannot be processed.`),r.forEach(l=>{n.push({type:"text",text:`[Skipped VFS file: ${l.name} - Filesystem unavailable]`})}),s=void 0}}for(const i of e){let a=null;try{if(i.source==="direct")a=H$(i);else if(i.source==="vfs"&&s&&i.path){console.log(`[ConversationService] Fetching VFS file: ${i.path}`);const o=await fp(i.path,{fsInstance:s});a=H$({...i,contentBytes:o})}else if(i.source==="vfs"&&!s)continue;a&&n.push(a)}catch(o){console.error(`[ConversationService] Error processing file ${i.name}:`,o),n.push({type:"text",text:`[Error processing file: ${i.name}]`})}}return n},async _ensureVfsReady(e){return console.log(`[ConversationService] Ensuring VFS ready for key "${e}"...`),new Promise((t,n)=>{const r=o=>{ti.getState().configuredVfsKey===e&&(i(),t(o.fsInstance))},s=o=>{if(ti.getState().configuredVfsKey===e&&!o.isLoading&&!o.operationLoading)if(o.error)i(),n(new Error(o.error));else{const l=ti.getState().fs;l&&(i(),t(l))}},i=()=>{Ce.off(hn.fsInstanceChanged,r),Ce.off(hn.loadingStateChanged,s)};Ce.on(hn.fsInstanceChanged,r),Ce.on(hn.loadingStateChanged,s);const a=ti.getState();if(a.configuredVfsKey===e&&a.fs&&!a.loading&&!a.operationLoading&&!a.error){i(),t(a.fs);return}if(a.configuredVfsKey===e&&a.error&&!a.loading&&!a.operationLoading){i(),n(new Error(a.error));return}Ce.emit(hn.initializeVFSRequest,{vfsKey:e,options:{force:!0}})})}},bl={_activeControllers:new Map,_streamingToolData:new Map,_firstChunkTimestamps:new Map,_interactionStartTimes:new Map,_pendingRegenerations:new Set,initializeCanvasEventHandlers(){Ce.on(Gi.copyInteractionResponseRequest,async e=>{const{interactionId:t}=e,n=nn.getState().interactions.find(s=>s.id===t);if(!n){ke.error(`Copy failed: Interaction ${t} not found.`),console.warn(`[InteractionService] Copy request for unknown interaction ${t}`);return}const r=n.response??"";if(typeof r!="string"||r.trim()===""){ke.info("No response content to copy.");return}try{await navigator.clipboard.writeText(r),ke.success("Response copied!")}catch(s){ke.error("Failed to copy response."),console.error("[InteractionService] Error copying response:",s)}}),Ce.on(Gi.regenerateInteractionRequest,async e=>{const{interactionId:t}=e;if(console.log(`[InteractionService] Received regenerateInteractionRequest for ${t}`),this._pendingRegenerations.has(t)){console.warn(`[InteractionService] Regeneration already pending for ${t}. Ignoring request.`);return}const n=nn.getState().interactions.find(o=>o.id===t);if(!n){ke.error(`Regeneration failed: Interaction ${t} not found.`),console.warn(`[InteractionService] Regeneration request for unknown interaction ${t}`);return}const r=nn.getState();if(r.status==="streaming"){ke.info("Cannot regenerate while another response is streaming.");return}const i=r.interactions.filter(o=>o.conversationId===n.conversationId&&o.parentId===null&&(o.type==="message.user_assistant"||o.type==="message.assistant_regen")).sort((o,l)=>o.index-l.index),a=i.length>0?i[i.length-1]:null;if((a==null?void 0:a.id)!==t){ke.info("Can only regenerate the last response in the conversation.");return}try{this._pendingRegenerations.add(t),await xh.regenerateInteraction(t)}catch(o){ke.error(`Failed to regenerate response: ${String(o)}`),console.error(`[InteractionService] Error regenerating interaction ${t}:`,o)}finally{this._pendingRegenerations.delete(t)}}),Ce.on(Gi.regenerateInteractionWithModelRequest,async e=>{const{interactionId:t,modelId:n}=e;if(this._pendingRegenerations.has(t)){console.warn(`[InteractionService] Regeneration already pending for ${t}. Ignoring request.`);return}const r=nn.getState().interactions.find(l=>l.id===t);if(!r){ke.error(`Regeneration failed: Interaction ${t} not found.`),console.warn(`[InteractionService] Regeneration request for unknown interaction ${t}`);return}const s=nn.getState();if(s.status==="streaming"){ke.info("Cannot regenerate while another response is streaming.");return}const a=s.interactions.filter(l=>l.conversationId===r.conversationId&&l.parentId===null&&(l.type==="message.user_assistant"||l.type==="message.assistant_regen")).sort((l,c)=>l.index-c.index),o=a.length>0?a[a.length-1]:null;if((o==null?void 0:o.id)!==t){ke.info("Can only regenerate the last response in the conversation.");return}try{this._pendingRegenerations.add(t);const l=co.getState(),c=l.modelId;console.log(`[InteractionService] Temporarily setting model to ${n} for regeneration`),l.setModelId(n);try{await xh.regenerateInteraction(t)}finally{console.log(`[InteractionService] Restoring original model ${c}`),l.setModelId(c)}}catch(l){ke.error(`Failed to regenerate response: ${String(l)}`),console.error(`[InteractionService] Error regenerating interaction ${t}:`,l)}finally{this._pendingRegenerations.delete(t)}}),Ce.on(Gi.raceInteractionRequest,async e=>{const{interactionId:t,modelIds:n,staggerMs:r}=e,s=nn.getState().interactions.find(c=>c.id===t);if(!s){ke.error(`Race failed: Interaction ${t} not found.`),console.warn(`[InteractionService] Race request for unknown interaction ${t}`);return}const i=nn.getState();if(i.status==="streaming"){ke.info("Cannot start race while another response is streaming.");return}const o=i.interactions.filter(c=>c.conversationId===s.conversationId&&c.parentId===null&&(c.type==="message.user_assistant"||c.type==="message.assistant_regen")).sort((c,u)=>c.index-u.index),l=o.length>0?o[o.length-1]:null;if((l==null?void 0:l.id)!==t){ke.info("Can only race from the last response in the conversation.");return}if(n.length<2){ke.error("Need at least 2 models to race");return}try{const c=co.getState(),u=c.modelId;console.log(`[InteractionService] Starting race with ${n.length} models`),ke.info(`Starting race with ${n.length} models...`);const d=n.map((b,v)=>new Promise(x=>{setTimeout(async()=>{try{c.setModelId(b),await xh.regenerateInteraction(t),x({success:!0,modelId:b,index:v})}catch(w){console.error(`[InteractionService] Race participant ${v+1} failed:`,w),x({success:!1,modelId:b,index:v,error:w})}},v*r)})),h=await Promise.all(d);c.setModelId(u);const m=h.filter(b=>b.success).length,y=h.length-m;m>0?ke.success(`Race completed! ${m} models responded${y>0?`, ${y} failed`:""}`):ke.error(`Race failed: All ${n.length} models failed to respond`)}catch(c){ke.error(`Race failed: ${String(c)}`),console.error("[InteractionService] Error during race:",c)}}),Ce.on(Gi.forkConversationRequest,async e=>{const{interactionId:t}=e;if(console.log(`[InteractionService] Received forkConversationRequest for ${t}`),!nn.getState().interactions.find(i=>i.id===t)){ke.error(`Fork failed: Interaction ${t} not found.`),console.warn(`[InteractionService] Fork request for unknown interaction ${t}`);return}if(nn.getState().status==="streaming"){ke.info("Cannot fork while another response is streaming.");return}try{await xh.forkConversation(t)}catch(i){ke.error(`Failed to fork conversation: ${String(i)}`),console.error(`[InteractionService] Error forking conversation ${t}:`,i)}}),Ce.on(Gi.forkConversationWithModelRequest,async e=>{const{interactionId:t,modelId:n}=e;if(console.log(`[InteractionService] Received forkConversationWithModelRequest for ${t} with model ${n}`),!nn.getState().interactions.find(a=>a.id===t)){ke.error(`Fork failed: Interaction ${t} not found.`),console.warn(`[InteractionService] Fork request for unknown interaction ${t}`);return}if(nn.getState().status==="streaming"){ke.info("Cannot fork while another response is streaming.");return}try{console.log(`[InteractionService] Creating fork conversation first, then setting model to ${n}`),await xh.forkConversation(t),await new Promise(a=>requestAnimationFrame(a)),console.log(`[InteractionService] Setting global model to ${n} for the new forked conversation`),Ce.emit(Vn.selectModelRequest,{modelId:n})}catch(a){ke.error(`Failed to fork conversation: ${String(a)}`),console.error(`[InteractionService] Error forking conversation ${t}:`,a)}}),Ce.on(Gi.forkConversationCompactRequest,async e=>{const{interactionId:t,modelId:n}=e;if(console.log(`[InteractionService] Received forkConversationCompactRequest for ${t} with model ${n}`),!nn.getState().interactions.find(a=>a.id===t)){ke.error(`Fork compact failed: Interaction ${t} not found.`),console.warn(`[InteractionService] Fork compact request for unknown interaction ${t}`);return}if(nn.getState().status==="streaming"){ke.info("Cannot fork compact while another response is streaming.");return}try{console.log(`[InteractionService] Creating compact fork conversation with model ${n}`),await xh.forkConversationCompact(t,n)}catch(a){ke.error(`Failed to fork and compact conversation: ${String(a)}`),console.error(`[InteractionService] Error forking and compacting conversation ${t}:`,a)}}),Ce.on(Gi.copyCodeBlockRequest,async e=>{const{content:t,interactionId:n,codeBlockId:r,language:s}=e;if(!t||t.trim()===""){ke.info("No code to copy.");return}try{await navigator.clipboard.writeText(t),ke.success(`Code block ${s?`(${s}) `:""}copied!`),console.log(`[InteractionService] Code block copied. InteractionID: ${n}, CodeBlockID: ${r}, Language: ${s}`)}catch(i){ke.error("Failed to copy code block."),console.error("[InteractionService] Error copying code block:",i)}})},async startInteraction(e,t,n,r="message.user_assistant"){var O,K,U,W,B,ne,V,Q,ee,re,de,me,De,je;console.log(`[InteractionService] startInteraction called (Type: ${r})`,e,t,n);const s=await Y2(gy.INTERACTION_BEFORE_START,{prompt:e,conversationId:t});if(s===!1)return console.log("[InteractionService] Interaction start cancelled by middleware."),null;const i=s&&typeof s=="object"?s.prompt:e,a=n.id||Nr(),o=new AbortController;this._activeControllers.set(a,o),this._streamingToolData.set(a,{calls:[],results:[]}),this._firstChunkTimestamps.delete(a),this._interactionStartTimes.delete(a);const l=nn.getState(),u=l.interactions.filter(Te=>Te.conversationId===t),d=r==="conversation.title_generation"||r==="conversation.compact"?-1:u.reduce((Te,_e)=>Math.max(Te,_e.index),-1)+1,h=null,m=performance.now();this._interactionStartTimes.set(a,m);const y={id:a,conversationId:t,startedAt:new Date,endedAt:null,type:r,status:"STREAMING",prompt:{...n},response:null,index:d,parentId:h,metadata:{...n.metadata||{},...i.metadata||{},toolCalls:[],toolResults:[],reasoning:void 0}};r!=="conversation.title_generation"&&r!=="conversation.compact"?(l._addInteractionToState(y),l._addStreamingId(a)):(l._addInteractionToState(y),l._addStreamingId(a),console.log(`[InteractionService] Added ${r} interaction ${a} to state.`)),yt.saveInteraction({...y}).catch(Te=>{console.error(`[InteractionService] Failed initial persistence for ${a}`,Te)}),Ce.emit(xn.started,{interactionId:a,conversationId:t,type:y.type});const b=(O=i.metadata)==null?void 0:O.modelId;if(!b)return await this._finalizeInteraction(a,"ERROR",new Error("No model ID specified in prompt metadata."),r),null;const{providerId:v,modelId:x}=Ql(b);if(!v||!x)return await this._finalizeInteraction(a,"ERROR",new Error(`Invalid combined model ID format: ${b}`),r),null;const w=Gn.getState().dbProviderConfigs.find(Te=>Te.id===v);if(!w)return await this._finalizeInteraction(a,"ERROR",new Error(`Provider configuration not found for ID: ${v}`),r),null;const _=Gn.getState().getApiKeyForProvider(v),k=mO(w,x,_);if(!k)return await this._finalizeInteraction(a,"ERROR",new Error(`Failed to instantiate model instance ${b} from provider ${w.name}`),r),null;console.log(`[InteractionService] Using model instance for ${b}`);const C=r!=="conversation.title_generation"&&r!=="conversation.compact"?(((K=i.metadata)==null?void 0:K.enabledTools)??[]).reduce((Te,_e)=>{if(_e.startsWith("mcp_")){const Ue=globalThis.mcpToolsModuleInstance;if(Ue&&Ue.mcpClients){const Qe=_e.substring(4).split("_");if(Qe.length>=2){const We=Qe[0],Pe=Qe.slice(1).join("_");for(const[,Y]of Ue.mcpClients)if(Y.name===We&&Y.tools[Pe]){const ye=Bi.getState().getRegisteredTools(),Me=`mcp_${We}_${Pe}`,ue=ye[Me];if(ue&&ue.definition){const oe={description:ue.definition.description,parameters:ue.definition.parameters,execute:async se=>{if(ue.implementation)return await ue.implementation(se,W$());throw console.error(`[InteractionService] MCP tool ${Pe} has no implementation`),new Error(`MCP tool ${Pe} has no implementation`)}};Te[_e]=oe}else console.warn(`[InteractionService] MCP tool ${Me} not found in control registry`);break}}}}else{const Qe=Bi.getState().getRegisteredTools()[_e];if(Qe&&Qe.implementation){const We={description:Qe.definition.description,parameters:Qe.definition.parameters,execute:async Pe=>{const Y=nn.getState().currentConversationId,ye=Y?jn.getState().getConversationById(Y):null;let Me;ye&&ye.projectId?typeof ye.projectId=="string"?Me=ye.projectId:(console.warn(`[InteractionService] conversation.projectId for conversation ${Y} is not a string (type: ${typeof ye.projectId}). Defaulting VFS key to "orphan". Value:`,ye.projectId),Me="orphan"):Me="orphan";let ue;try{if(Ce.emit(hn.initializeVFSRequest,{vfsKey:Me,options:{force:!0}}),await new Promise(oe=>setTimeout(oe,100)),ue=ti.getState().fs,ti.getState().configuredVfsKey!==Me||!ue)throw new Error(`Filesystem for key "${Me}" not ready after request.`)}catch(oe){throw new Error(`Filesystem error: ${oe.message}`)}try{const oe=W$(),se=Qe.definition.parameters.parse(Pe),Ie=Qe.implementation,Be={...oe,fsInstance:ue};return await Ie(se,Be)}catch(oe){throw oe instanceof Vc?new Error(`Invalid arguments: ${oe.errors.map(se=>`${se.path.join(".")} (${se.message})`).join(", ")}`):new Error(oe instanceof Error?oe.message:String(oe))}}};Te[_e]=We}}return Te},{}):void 0,{getSelectedModel:T}=Gn.getState(),A=T(),N=((W=(U=A==null?void 0:A.metadata)==null?void 0:U.supported_parameters)==null?void 0:W.includes("tools"))??!1,I=(((B=i.metadata)==null?void 0:B.enabledTools)??[]).filter(Te=>Te.startsWith("mcp_")).length,j=(((ne=i.metadata)==null?void 0:ne.enabledTools)??[]).filter(Te=>!Te.startsWith("mcp_")).length;!N&&(I>0||j>0)&&console.warn(`[InteractionService] Model ${(A==null?void 0:A.name)||"unknown"} does not support tools. Ignoring ${I+j} enabled tools.`);const L=((V=i.parameters)==null?void 0:V.maxSteps)??pr.getState().toolMaxSteps,D={model:k,messages:i.messages,abortSignal:o.signal,system:i.system,temperature:(Q=i.parameters)==null?void 0:Q.temperature,maxTokens:(ee=i.parameters)==null?void 0:ee.max_tokens,topP:(re=i.parameters)==null?void 0:re.top_p,topK:(de=i.parameters)==null?void 0:de.top_k,presencePenalty:(me=i.parameters)==null?void 0:me.presence_penalty,frequencyPenalty:(De=i.parameters)==null?void 0:De.frequency_penalty,maxSteps:L,...N&&C&&Object.keys(C).length>0&&{tools:C},...((je=i.parameters)==null?void 0:je.providerOptions)&&{providerOptions:i.parameters.providerOptions},...N&&i.toolChoice&&{toolChoice:i.toolChoice}},H={onChunk:Te=>this._handleChunk(a,Te),onReasoningChunk:Te=>this._handleReasoningChunk(a,Te),onToolCall:Te=>this._handleToolCall(a,Te),onToolResult:Te=>this._handleToolResult(a,Te),onFinish:Te=>this._handleFinish(a,Te,r).catch(_e=>{console.error(`[InteractionService] Error in finish handler for ${a}:`,_e)}),onError:Te=>this._handleError(a,Te,r).catch(_e=>{console.error(`[InteractionService] Error in error handler for ${a}:`,_e)})};return console.log(`[InteractionService] Calling AIService.executeInteraction for ${a}`),T4e.executeInteraction(a,D,H).catch(Te=>{console.error(`[InteractionService] Error during AIService.executeInteraction for ${a}:`,Te);const _e=nn.getState().interactions.find(Ue=>Ue.id===a);_e&&_e.status==="STREAMING"&&this._finalizeInteraction(a,"ERROR",Te instanceof Error?Te:new Error(String(Te)),r).catch(Ue=>{console.error("[InteractionService] Error during finalization after execution error:",Ue)})}),y},abortInteraction(e){console.log(`[InteractionService] Aborting interaction ${e}`);const t=this._activeControllers.get(e);if(t&&!t.signal.aborted)t.abort(),ke.info("Interaction cancelled.");else{console.warn(`[InteractionService] No active controller found or already aborted for ${e}.`);const n=nn.getState(),r=n.interactions.find(s=>s.id===e);n.streamingInteractionIds.includes(e)&&(console.warn(`[InteractionService] Forcing cleanup for potentially stuck interaction ${e}`),this._finalizeInteraction(e,"CANCELLED",new Error("Interaction aborted manually (controller missing)"),(r==null?void 0:r.type)??"message.user_assistant").catch(s=>{console.error("[InteractionService] Error during forced finalization:",s)}))}},async _handleChunk(e,t){this._firstChunkTimestamps.has(e)||this._firstChunkTimestamps.set(e,performance.now());const n={interactionId:e,chunk:t},r=await Y2(gy.INTERACTION_PROCESS_CHUNK,n);if(r!==!1){const s=r&&typeof r=="object"&&"chunk"in r?r.chunk:t;nn.getState().appendInteractionResponseChunk(e,s),Ce.emit(xn.streamChunk,{interactionId:e,chunk:s})}},_handleReasoningChunk(e,t){nn.getState().appendReasoningChunk(e,t)},_handleToolCall(e,t){try{const n=JSON.stringify(t),r=this._streamingToolData.get(e)||{calls:[],results:[]};r.calls.push(n),this._streamingToolData.set(e,r),nn.getState()._updateInteractionInState(e,{metadata:{toolCalls:[...r.calls]}})}catch(n){console.error(`[InteractionService] Failed to process tool call for ${e}:`,n)}},_handleToolResult(e,t){try{const n=JSON.stringify(t),r=this._streamingToolData.get(e)||{calls:[],results:[]};r.results.push(n),this._streamingToolData.set(e,r),nn.getState()._updateInteractionInState(e,{metadata:{toolResults:[...r.results]}})}catch(n){console.error(`[InteractionService] Failed to process tool result for ${e}:`,n)}},async _handleFinish(e,t,n){console.log(`[InteractionService] Finishing interaction ${e} (Type: ${n}). Reason: ${t.finishReason}`),await this._finalizeInteraction(e,"COMPLETED",void 0,n,t)},async _handleError(e,t,n){console.error(`[InteractionService] Handling error for interaction ${e} (Type: ${n}):`,t);const r=t.name==="AbortError";await this._finalizeInteraction(e,r?"CANCELLED":"ERROR",r?void 0:t,n)},async _finalizeInteraction(e,t,n,r="message.user_assistant",s){var C,T,A,N,I;const i=nn.getState(),a=i.interactions.find(j=>j.id===e);if(!a||a.status!=="STREAMING"&&r!=="conversation.title_generation"&&r!=="conversation.compact"){console.warn(`[InteractionService] Interaction ${e} already finalized or not found. Skipping finalization with status ${t}.`),this._activeControllers.delete(e),this._streamingToolData.delete(e),this._interactionStartTimes.delete(e),this._firstChunkTimestamps.delete(e);return}const o=i.activeStreamBuffers[e]??"",l=i.activeReasoningBuffers[e]??"",c=this._streamingToolData.get(e)||{calls:[],results:[]},u=(a==null?void 0:a.metadata)||{};console.log(`[InteractionService] Finalizing ${e}. Buffered Content Length: ${o.length}, Reasoning Length: ${l.length}`);const d=performance.now(),h=this._interactionStartTimes.get(e),m=this._firstChunkTimestamps.get(e),y=h?Math.round(d-h):void 0,b=h&&m?Math.round(m-h):void 0,v=(s==null?void 0:s.reasoning)??l,x={status:t,endedAt:new Date,response:o||null,metadata:{...u,...(s==null?void 0:s.usage)&&{promptTokens:s.usage.promptTokens,completionTokens:s.usage.completionTokens,totalTokens:s.usage.totalTokens},...(s==null?void 0:s.providerMetadata)&&{providerMetadata:s.providerMetadata},toolCalls:c.calls,toolResults:c.results,reasoning:v||void 0,timeToFirstToken:b,generationTime:y,...(t==="ERROR"||t==="WARNING"||t==="CANCELLED")&&{error:(n==null?void 0:n.message)??"Interaction ended unexpectedly."}}};if(r==="conversation.title_generation"&&t==="COMPLETED"&&x.response&&typeof x.response=="string"){const j=x.response.trim().replace(/^"|"$/g,"");a&&j&&Ce.emit(tr.updateConversationRequest,{id:a.conversationId,updates:{title:j}})}if(r==="prompt.enhance"&&t==="COMPLETED"&&x.response&&typeof x.response=="string"){const j=x.response.trim();if(j){const{PromptEnhancementService:L}=await Fr(async()=>{const{PromptEnhancementService:D}=await Promise.resolve().then(()=>KHe);return{PromptEnhancementService:D}},void 0);await L.handleEnhancementCompletion(e,j)}}if(r==="conversation.compact"&&t==="COMPLETED"&&x.response&&typeof x.response=="string"){const j=x.response.trim(),L=(C=a==null?void 0:a.metadata)==null?void 0:C.targetUserInteractionId,D=(T=a==null?void 0:a.metadata)==null?void 0:T.targetConversationId,H=(A=a==null?void 0:a.metadata)==null?void 0:A.combineSourceInteractionId;if((N=a==null?void 0:a.metadata)!=null&&N.isCombineGeneration&&H){console.log(`[InteractionService] Combine completion handler triggered for ${e} targeting ${H}`);try{const O=nn.getState(),K=O.interactions.find(U=>{var W,B;return U.parentId===H&&((W=U.metadata)==null?void 0:W.isCombineGeneration)===!0&&((B=U.metadata)==null?void 0:B.isCompactingInProgress)===!0});if(K){const U={...K.metadata,isCompactingInProgress:!1,combineGeneratedAt:new Date().toISOString()};O._updateInteractionInState(K.id,{response:j,status:"COMPLETED",endedAt:new Date,metadata:U});const W=O.interactions.find(B=>B.id===K.id);W&&await yt.saveInteraction(W),Ce.emit(xn.updated,{interactionId:K.id,updates:{response:j,status:"COMPLETED",endedAt:new Date,metadata:U}}),O._removeStreamingId(K.id)}}catch(O){console.error("[InteractionService] Error updating combine interaction:",O)}}else if(j&&L&&D)try{await jn.getState().selectItem(D,"conversation");const K=nn.getState();K.currentConversationId!==D&&await K.loadInteractions(D);const U=K.interactions.find(B=>B.id===L);if(!U)throw new Error(`Target interaction ${L} not found after loading conversation ${D}`);const W={...U,response:j,status:"COMPLETED",endedAt:new Date,metadata:{...U.metadata,isCompactingInProgress:!1,isRaceCombining:!1,compactGeneratedAt:new Date().toISOString(),combinedResponse:(I=U.metadata)!=null&&I.isRaceCombining?!0:void 0}};await yt.saveInteraction(W),K._updateInteractionInState(L,{response:j,status:"COMPLETED",endedAt:new Date,metadata:W.metadata}),Ce.emit(xn.updated,{interactionId:L,updates:{response:j,status:"COMPLETED",endedAt:new Date,metadata:W.metadata}}),K._removeStreamingId(L)}catch(O){console.error(`[InteractionService] Error updating user interaction ${L} with compact summary:`,O);try{await jn.getState().selectItem(D,"conversation");const U=nn.getState(),W=U.interactions.find(V=>V.id===L),B={response:"Error generating compact summary. Please try again.",status:"ERROR",endedAt:new Date,metadata:{...(W==null?void 0:W.metadata)||{},isCompactingInProgress:!1,compactError:O instanceof Error?O.message:String(O)}};U._updateInteractionInState(L,B),Ce.emit(xn.updated,{interactionId:L,updates:B}),U._removeStreamingId(L);const ne=U.interactions.find(V=>V.id===L);ne&&await yt.saveInteraction(ne)}catch(K){console.error(`[InteractionService] Fallback update also failed for ${L}:`,K)}}}i._updateInteractionInState(e,x),i._removeStreamingId(e);const w=nn.getState().interactions.find(j=>j.id===e);w?yt.saveInteraction({...w}).catch(j=>{console.error(`[InteractionService] Failed final persistence for ${e}`,j)}):console.error(`[InteractionService] CRITICAL - Could not find final state for interaction ${e} to persist.`);let _=[],k=[];try{_=c.calls.map(j=>JSON.parse(j)),k=c.results.map(j=>JSON.parse(j))}catch(j){console.error("[InteractionService] Failed to parse tool strings for event emitter:",j)}Ce.emit(xn.completed,{interaction:w,interactionId:e,status:t,error:n==null?void 0:n.message,toolCalls:_,toolResults:k}),this._activeControllers.delete(e),this._streamingToolData.delete(e),this._interactionStartTimes.delete(e),this._firstChunkTimestamps.delete(e)}},kk=Ve.memo(({interactionId:e,className:t,renderSlot:n,showPrompt:r=!0})=>{var O;const{interaction:s,interactionStatus:i}=nn(mn(K=>{const U=K.interactions.find(W=>W.id===e);return{interaction:U,interactionStatus:U==null?void 0:U.status}})),a=pr(K=>K.streamingRenderFPS),[o,l]=E.useState(""),[c,u]=E.useState(""),[d,h]=E.useState(!0),[m,y]=E.useState(!1),b=E.useRef(null),v=E.useRef(0),x=E.useRef(null);E.useEffect(()=>{const K=1e3/a;let U=!0;const W=B=>{if(!U)return;if(nn.getState().streamingInteractionIds.includes(e)){if(B-v.current>=K){const V=nn.getState().activeStreamBuffers[e]??"",Q=nn.getState().activeReasoningBuffers[e]??"";l(V),u(Q),v.current=B}b.current=requestAnimationFrame(W)}else{const V=nn.getState().activeStreamBuffers[e]??"",Q=nn.getState().activeReasoningBuffers[e]??"";l(V),u(Q),b.current=null}};return b.current=requestAnimationFrame(W),()=>{U=!1,b.current&&(cancelAnimationFrame(b.current),b.current=null)}},[e,a]),E.useEffect(()=>{if(i&&i!=="STREAMING"){const K=nn.getState().activeStreamBuffers[e]??"",U=nn.getState().activeReasoningBuffers[e]??"";l(K),u(U),b.current&&(cancelAnimationFrame(b.current),b.current=null)}},[i,e]);const{dbProviderConfigs:w,getAllAvailableModelDefsForProvider:_}=Gn(mn(K=>({dbProviderConfigs:K.dbProviderConfigs,getAllAvailableModelDefsForProvider:K.getAllAvailableModelDefsForProvider}))),k=E.useMemo(()=>{var ee;const K=(ee=s==null?void 0:s.metadata)==null?void 0:ee.modelId;if(!K)return"Loading Model...";const{providerId:U,modelId:W}=Ql(K);if(!U||!W)return K;const B=w.find(re=>re.id===U),ne=(B==null?void 0:B.name)??U,Q=_(U).find(re=>re.id===W);return`${(Q==null?void 0:Q.name)??W} (${ne})`},[(O=s==null?void 0:s.metadata)==null?void 0:O.modelId,w,_]),C=E.useCallback(()=>h(K=>!K),[]),T=E.useCallback(()=>{y(!1)},[]),A=E.useCallback(()=>{y(!0)},[]),N=E.useCallback(()=>{m?T():A()},[m,T,A]);if(!s)return r?f.jsxs("div",{className:Ye("group/card relative rounded-lg border border-primary/30 bg-card p-4 shadow-sm animate-pulse",t),children:[f.jsx("div",{className:"h-8 bg-muted rounded w-3/4 mb-4"}),f.jsxs("div",{className:"mt-3 pt-3 border-t border-border/50",children:[f.jsxs("div",{className:"flex justify-between items-center mb-2",children:[f.jsx("span",{className:"text-xs font-medium text-muted-foreground",children:"Assistant (Loading...)"}),f.jsx("span",{className:"text-xs text-muted-foreground",children:"Streaming..."})]}),f.jsxs("div",{className:"space-y-2 mt-2",children:[f.jsx("div",{className:"h-4 bg-muted rounded w-full"}),f.jsx("div",{className:"h-4 bg-muted rounded w-5/6"}),f.jsx("div",{className:"h-4 bg-muted rounded w-full"})]})]})]}):f.jsxs("div",{className:Ye("group/card relative rounded-lg border border-primary/30 bg-card p-4 shadow-sm animate-pulse",t),children:[f.jsxs("div",{className:"flex justify-between items-center mb-2",children:[f.jsx("span",{className:"text-xs font-medium text-muted-foreground",children:"Assistant (Loading...)"}),f.jsx("span",{className:"text-xs text-muted-foreground",children:"Streaming..."})]}),f.jsxs("div",{className:"space-y-2 mt-2",children:[f.jsx("div",{className:"h-4 bg-muted rounded w-full"}),f.jsx("div",{className:"h-4 bg-muted rounded w-5/6"}),f.jsx("div",{className:"h-4 bg-muted rounded w-full"})]})]});const I=()=>{bl.abortInteraction(e)},j=n==null?void 0:n("header-actions",s,{isFolded:m,toggleFold:N}),L=n==null?void 0:n("actions",s),D=n==null?void 0:n("content",s),H=n==null?void 0:n("menu",s);return f.jsxs("div",{ref:x,className:Ye("group/card relative rounded-lg border bg-card p-3 md:p-4 shadow-sm transition-colors",i==="ERROR"?"border-destructive/50 bg-destructive/5":i==="STREAMING"?"border-primary/30":"border-border",t),children:[r&&s.prompt&&f.jsx(Lw,{turnData:s.prompt,timestamp:s.startedAt,isAssistantComplete:!1,interactionId:s.id}),f.jsxs("div",{className:Ye("relative group/assistant",r&&s.prompt?"mt-3 pt-3 border-t border-border/50":""),children:[H,f.jsxs("div",{className:Ye("flex flex-col sm:flex-row justify-between items-start mb-2 sticky top-0 bg-card/80 backdrop-blur-sm z-[var(--z-sticky)] p-1 -m-1 rounded-t"),children:[f.jsxs("div",{className:"flex items-start gap-1 min-w-0 mb-1 sm:mb-0",children:[f.jsx(Em,{className:"h-4 w-4 text-secondary flex-shrink-0 mt-0.5"}),f.jsx("div",{className:"flex flex-col min-w-0",children:f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsxs("span",{className:"text-xs font-semibold text-secondary truncate mr-1",children:["Assistant (",k,")"]}),f.jsx("div",{className:"flex items-center gap-0.5 opacity-0 group-hover/assistant:opacity-100 focus-within:opacity-100 transition-opacity",children:j})]})})]}),f.jsx("div",{className:"flex items-start flex-shrink-0 gap-1 self-end sm:self-start",children:f.jsx("span",{className:"text-xs text-muted-foreground mt-0.5",children:"Streaming..."})})]}),!m&&f.jsxs(f.Fragment,{children:[D,c&&f.jsxs("div",{className:"my-2 p-2 border border-blue-500/30 bg-blue-500/10 rounded-md text-xs",children:[f.jsxs("div",{className:"flex items-center justify-between mb-1 cursor-pointer group/reasoning",onClick:C,children:[f.jsxs("span",{className:"font-semibold text-blue-700 dark:text-blue-300 flex items-center gap-1",children:[f.jsx(Qy,{className:"h-3.5 w-3.5"})," Reasoning (Streaming)"]}),f.jsx("div",{className:"flex items-center opacity-0 group-hover/reasoning:opacity-100 focus-within:opacity-100 transition-opacity",children:f.jsx(Un,{tooltipText:d?"Show Reasoning":"Hide Reasoning",onClick:K=>{K.stopPropagation(),C()},"aria-label":d?"Show reasoning":"Hide reasoning",icon:d?f.jsx(uc,{}):f.jsx(tp,{}),iconClassName:"h-3 w-3",className:"h-5 w-5 text-muted-foreground"})})]}),!d&&f.jsx("pre",{className:"whitespace-pre-wrap text-xs font-mono p-2 bg-background/30 rounded mt-1 overflow-wrap-anywhere",children:c})]}),f.jsx(EMe,{interactionId:e,markdownContent:o,isStreaming:!0})]}),m&&f.jsxs("div",{className:"text-xs text-muted-foreground italic cursor-pointer hover:bg-muted/20 p-1 rounded",onClick:N,children:[c?"[Reasoning] ":"",o&&typeof o=="string"?`"${o.substring(0,80)}${o.length>80?"...":""}"`:"[Streaming...]"]})]}),f.jsxs("div",{className:Ye("absolute bottom-1 left-1 md:bottom-2 md:left-2 flex items-center space-x-0.5 md:space-x-1 opacity-0 group-hover/card:opacity-100 transition-opacity duration-200","bg-card/80 backdrop-blur-sm p-0.5 md:p-1 rounded-md shadow-md z-[var(--z-sticky)]"),children:[L,f.jsx(TMe,{onStop:I,"aria-label":"Stop Generation"})]})]})});kk.displayName="StreamingInteractionCard";const D7=e=>e===void 0?"?":e<1e3?`${e}ms`:`${(e/1e3).toFixed(2)}s`,j4e=({type:e})=>{switch(e){case"message.workflow_step":return f.jsx(R0e,{className:"h-4 w-4 text-secondary flex-shrink-0 mt-0.5"});default:return f.jsx(Em,{className:"h-4 w-4 text-secondary flex-shrink-0 mt-0.5"})}},P4e=({interactionType:e,displayModelName:t,timeAgo:n,promptTokens:r,completionTokens:s,timeToFirstToken:i,generationTime:a,headerActionsSlot:o})=>{const l=r!==void 0&&s!==void 0?r+s:void 0;return f.jsxs("div",{className:Ye("flex flex-col sm:flex-row justify-between items-start mb-2 sticky top-0 bg-card/80 backdrop-blur-sm z-[var(--z-sticky)] p-1 -m-1 rounded-t"),children:[f.jsxs("div",{className:"flex items-start gap-1 min-w-0 mb-1 sm:mb-0",children:[f.jsx(j4e,{type:e}),f.jsxs("div",{className:"flex flex-col min-w-0",children:[f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsxs("span",{className:"text-xs font-semibold text-secondary truncate mr-1",children:["Assistant (",t,")"]}),f.jsx("div",{className:"flex items-center gap-0.5 opacity-0 group-hover/assistant:opacity-100 focus-within:opacity-100 transition-opacity",children:o})]}),f.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground mt-0.5 flex-wrap",children:[l!==void 0&&f.jsx(wr,{delayDuration:100,children:f.jsxs(Sr,{children:[f.jsxs(_r,{className:"flex items-center gap-0.5 cursor-default",children:[f.jsx(Tme,{className:"h-3 w-3"}),f.jsx("span",{children:l.toLocaleString()})]}),f.jsxs(Cr,{side:"bottom",children:["Tokens: ",r??"?"," (Prompt) +"," ",s??"?"," (Completion) = ",l]})]})}),i!==void 0&&f.jsx(wr,{delayDuration:100,children:f.jsxs(Sr,{children:[f.jsxs(_r,{className:"flex items-center gap-0.5 cursor-default",children:[f.jsx(j0e,{className:"h-3 w-3"}),f.jsx("span",{children:D7(i)})]}),f.jsx(Cr,{side:"bottom",children:"Time to First Token"})]})}),a!==void 0&&f.jsx(wr,{delayDuration:100,children:f.jsxs(Sr,{children:[f.jsxs(_r,{className:"flex items-center gap-0.5 cursor-default",children:[f.jsx(wme,{className:"h-3 w-3"}),f.jsx("span",{children:D7(a)})]}),f.jsx(Cr,{side:"bottom",children:"Total Generation Time"})]})})]})]})]}),f.jsx("div",{className:"flex items-start flex-shrink-0 gap-1 self-end sm:self-start",children:f.jsx("span",{className:"text-xs text-muted-foreground mt-0.5",children:n})})]})},O4e=({markdownContent:e,interactionId:t})=>{const n=ET(e);return e!=null&&e.trim()?f.jsx("div",{className:"overflow-wrap-anywhere",children:n.map((r,s)=>typeof r=="string"?f.jsx("div",{className:"markdown-content",dangerouslySetInnerHTML:{__html:r}},`html-${s}`):r.type==="block"?f.jsx(ib,{lang:r.lang,code:r.code,filepath:r.filepath,interactionId:t},`block-${s}`):null)}):null},D4e=({interactionId:e,response:t,toolCalls:n,toolResults:r,reasoning:s,isError:i,errorMessage:a,isFolded:o,toggleFold:l})=>{const[c,u]=E.useState(!0),[d,h]=E.useState(!1),m=Bi(mn(C=>Object.values(C.canvasControls))),y=E.useCallback((C,T)=>m.filter(A=>A.type==="tool-call-step"&&A.targetSlot===C&&A.renderer).map(A=>A.renderer?f.jsx(Ve.Fragment,{children:A.renderer(T)},A.id):null).filter(Boolean),[m]),b=E.useMemo(()=>{if(!n)return[];const C=n.map(A=>JSON.parse(A)),T=(r==null?void 0:r.map(A=>JSON.parse(A)))??[];return C.map(A=>{const N=T.find(I=>I.toolCallId===A.toolCallId);return{call:A,result:N}})},[n,r]),v=E.useCallback(()=>u(C=>!C),[]),x=E.useCallback(async()=>{if(s)try{await navigator.clipboard.writeText(s),h(!0),ke.success("Reasoning copied!"),setTimeout(()=>h(!1),1500)}catch(C){ke.error("Failed to copy reasoning."),console.error("Clipboard copy failed for reasoning:",C)}},[s]),w=!!s,_=t&&(typeof t!="string"||t.trim().length>0),k=b&&b.length>0;return o?f.jsxs("div",{className:"text-xs text-muted-foreground italic cursor-pointer hover:bg-muted/20 p-1 rounded",onClick:l,children:[w?"[Reasoning] ":"",k?`[${b==null?void 0:b.length} Tool Call(s)] `:"",_&&typeof t=="string"?`"${t.substring(0,80)}${t.length>80?"...":""}"`:k||w?"":"[No text response]"]}):f.jsxs(f.Fragment,{children:[i&&a&&f.jsxs("div",{className:"mb-2 rounded border border-destructive bg-destructive/10 p-2 text-xs text-destructive-foreground",children:[f.jsx("p",{className:"font-semibold",children:"Error:"}),f.jsx("p",{children:a})]}),w&&f.jsxs("div",{className:"my-2 p-2 border border-blue-500/30 bg-blue-500/10 rounded-md text-xs",children:[f.jsxs("div",{className:"flex items-center justify-between mb-1 cursor-pointer group/reasoning",onClick:v,children:[f.jsxs("span",{className:"font-semibold text-blue-700 dark:text-blue-300 flex items-center gap-1",children:[f.jsx(Qy,{className:"h-3.5 w-3.5"})," Reasoning"]}),f.jsxs("div",{className:"flex items-center opacity-0 group-hover/reasoning:opacity-100 focus-within:opacity-100 transition-opacity",children:[f.jsx(Un,{tooltipText:"Copy Reasoning",onClick:C=>{C.stopPropagation(),x()},"aria-label":"Copy reasoning",icon:d?f.jsx(bo,{className:"text-green-500"}):f.jsx(TE,{}),className:"h-5 w-5 text-muted-foreground"}),f.jsx(Un,{tooltipText:c?"Show Reasoning":"Hide Reasoning",onClick:C=>{C.stopPropagation(),v()},"aria-label":c?"Show reasoning":"Hide reasoning",icon:c?f.jsx(uc,{}):f.jsx(tp,{}),iconClassName:"h-3 w-3",className:"h-5 w-5 text-muted-foreground"})]})]}),!c&&f.jsx("pre",{className:"whitespace-pre-wrap text-xs font-mono p-2 bg-background/30 rounded mt-1 overflow-wrap-anywhere",children:s})]}),b.map(({call:C,result:T},A)=>{const N={interactionId:e,toolCall:C,toolResult:T,canvasContextType:"tool-call-step"};return f.jsx(Ve.Fragment,{children:y("tool-call-content",N)},`tool-step-${C.toolCallId||A}`)}),_&&typeof t=="string"&&f.jsx(O4e,{markdownContent:t,interactionId:e}),!_&&!k&&!w&&!i&&f.jsx("div",{className:"text-xs text-muted-foreground italic p-1",children:"[No text response]"})]})},ws={startRequest:"workflow.start.request",runNextStepRequest:"workflow.runNextStep.request",resumeRequest:"workflow.resume.request",cancelRequest:"workflow.cancel.request",started:"workflow.started",paused:"workflow.paused",resumed:"workflow.resumed",stepCompleted:"workflow.step.completed",completed:"workflow.completed",error:"workflow.error"},H0=Co(ko((e,t)=>({activeRun:null,pausePayload:null,_handleWorkflowStarted:n=>{e(r=>{r.activeRun=n,r.pausePayload=null})},_updateRun:(n,r,s)=>{e(i=>{i.activeRun&&i.activeRun.runId===n&&(i.activeRun.status=r,s&&s(i.activeRun))})},_handleStepCompleted:(n,r,s)=>{t()._updateRun(n,"RUNNING",i=>{console.log(`[WorkflowStore] Step completed: ${r}, incrementing currentStepIndex from ${i.currentStepIndex} to ${i.currentStepIndex+1}`),i.stepOutputs[r]=s,i.currentStepIndex+=1})},_handleWorkflowPaused:n=>{t()._updateRun(n.runId,"PAUSED"),e({pausePayload:n})},_handleWorkflowResumed:n=>{t()._updateRun(n,"RUNNING"),e({pausePayload:null})},_handleWorkflowCompleted:n=>{t()._updateRun(n,"COMPLETED",r=>{r.completedAt=new Date().toISOString()}),setTimeout(()=>e({activeRun:null,pausePayload:null}),5e3)},_handleWorkflowError:(n,r)=>{t()._updateRun(n,"ERROR",s=>{s.error=r,s.completedAt=new Date().toISOString()}),e({pausePayload:null})},_handleWorkflowCancelled:n=>{var r;((r=t().activeRun)==null?void 0:r.runId)===n&&e({activeRun:null,pausePayload:null})},getRegisteredActionHandlers:()=>{const n=t();return[{eventName:ws.started,handler:r=>n._handleWorkflowStarted(r.run),storeId:"WorkflowStore"},{eventName:ws.stepCompleted,handler:r=>n._handleStepCompleted(r.runId,r.stepId,r.output),storeId:"WorkflowStore"},{eventName:ws.paused,handler:r=>n._handleWorkflowPaused(r),storeId:"WorkflowStore"},{eventName:ws.resumed,handler:r=>n._handleWorkflowResumed(r.runId),storeId:"WorkflowStore"},{eventName:ws.completed,handler:r=>n._handleWorkflowCompleted(r.runId),storeId:"WorkflowStore"},{eventName:ws.error,handler:r=>n._handleWorkflowError(r.runId,r.error),storeId:"WorkflowStore"},{eventName:ws.cancelRequest,handler:r=>n._handleWorkflowCancelled(r.runId),storeId:"WorkflowStore"}]}})));function Ci({className:e,...t}){return f.jsx("textarea",{"data-slot":"textarea",className:Ye("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),...t})}var F4e=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],L4e=F4e.reduce((e,t)=>{const n=$u(`Primitive.${t}`),r=E.forwardRef((s,i)=>{const{asChild:a,...o}=s,l=a?n:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),f.jsx(l,{...o,ref:i})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{}),B4e="Label",YJ=E.forwardRef((e,t)=>f.jsx(L4e.label,{...e,ref:t,onMouseDown:n=>{var s;n.target.closest("button, input, select, textarea")||((s=e.onMouseDown)==null||s.call(e,n),!n.defaultPrevented&&n.detail>1&&n.preventDefault())}}));YJ.displayName=B4e;var $4e=YJ;function Nt({className:e,...t}){return f.jsx($4e,{"data-slot":"label",className:Ye("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",e),...t})}const z4e=({run:e})=>{const[t,n]=E.useState(()=>{if(!e)return"";try{return JSON.stringify(e.stepOutputs,null,2)}catch{return""}});if(!e)return null;const r=e.template.steps[e.currentStepIndex],s=()=>{let i=t;try{i=JSON.parse(t)}catch{}Ce.emit(ws.resumeRequest,{runId:e.runId,resumeData:i})};return f.jsxs("div",{className:"p-4 border-t space-y-3",children:[f.jsx("h3",{className:"font-semibold text-base",children:"Action Required"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:r.instructionsForHuman||"Please review the data below and click Continue."}),f.jsxs("div",{className:"space-y-1",children:[f.jsx(Nt,{htmlFor:`hitl-data-${e.runId}`,children:"Data (edit if needed)"}),f.jsx(Ci,{id:`hitl-data-${e.runId}`,value:t,onChange:i=>n(i.target.value),rows:8,className:"font-mono text-xs"})]}),f.jsxs("div",{className:"flex justify-end gap-2",children:[f.jsx(ot,{variant:"outline",onClick:()=>Ce.emit(ws.cancelRequest,{runId:e.runId}),children:"Cancel Workflow"}),f.jsx(ot,{onClick:s,children:"Continue"})]})]})},U4e=Y4("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function XD({className:e,variant:t,...n}){return f.jsx("div",{"data-slot":"alert",role:"alert",className:Ye(U4e({variant:t}),e),...n})}function JD({className:e,...t}){return f.jsx("div",{"data-slot":"alert-title",className:Ye("col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight",e),...t})}function QD({className:e,...t}){return f.jsx("div",{"data-slot":"alert-description",className:Ye("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",e),...t})}var q4e=E.createContext(void 0);function cg(e){const t=E.useContext(q4e);return e||t||"ltr"}function Kw(e,[t,n]){return Math.min(n,Math.max(t,e))}function V4e(e,t){return E.useReducer((n,r)=>t[n][r]??n,e)}var eF="ScrollArea",[ZJ,Ift]=Ei(eF),[W4e,mc]=ZJ(eF),XJ=E.forwardRef((e,t)=>{const{__scopeScrollArea:n,type:r="hover",dir:s,scrollHideDelay:i=600,...a}=e,[o,l]=E.useState(null),[c,u]=E.useState(null),[d,h]=E.useState(null),[m,y]=E.useState(null),[b,v]=E.useState(null),[x,w]=E.useState(0),[_,k]=E.useState(0),[C,T]=E.useState(!1),[A,N]=E.useState(!1),I=Tn(t,L=>l(L)),j=cg(s);return f.jsx(W4e,{scope:n,type:r,dir:j,scrollHideDelay:i,scrollArea:o,viewport:c,onViewportChange:u,content:d,onContentChange:h,scrollbarX:m,onScrollbarXChange:y,scrollbarXEnabled:C,onScrollbarXEnabledChange:T,scrollbarY:b,onScrollbarYChange:v,scrollbarYEnabled:A,onScrollbarYEnabledChange:N,onCornerWidthChange:w,onCornerHeightChange:k,children:f.jsx(Kn.div,{dir:j,...a,ref:I,style:{position:"relative","--radix-scroll-area-corner-width":x+"px","--radix-scroll-area-corner-height":_+"px",...e.style}})})});XJ.displayName=eF;var JJ="ScrollAreaViewport",QJ=E.forwardRef((e,t)=>{const{__scopeScrollArea:n,children:r,nonce:s,...i}=e,a=mc(JJ,n),o=E.useRef(null),l=Tn(t,o,a.onViewportChange);return f.jsxs(f.Fragment,{children:[f.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:s}),f.jsx(Kn.div,{"data-radix-scroll-area-viewport":"",...i,ref:l,style:{overflowX:a.scrollbarXEnabled?"scroll":"hidden",overflowY:a.scrollbarYEnabled?"scroll":"hidden",...e.style},children:f.jsx("div",{ref:a.onContentChange,style:{minWidth:"100%",display:"table"},children:r})})]})});QJ.displayName=JJ;var Qu="ScrollAreaScrollbar",eQ=E.forwardRef((e,t)=>{const{forceMount:n,...r}=e,s=mc(Qu,e.__scopeScrollArea),{onScrollbarXEnabledChange:i,onScrollbarYEnabledChange:a}=s,o=e.orientation==="horizontal";return E.useEffect(()=>(o?i(!0):a(!0),()=>{o?i(!1):a(!1)}),[o,i,a]),s.type==="hover"?f.jsx(H4e,{...r,ref:t,forceMount:n}):s.type==="scroll"?f.jsx(G4e,{...r,ref:t,forceMount:n}):s.type==="auto"?f.jsx(tQ,{...r,ref:t,forceMount:n}):s.type==="always"?f.jsx(tF,{...r,ref:t}):null});eQ.displayName=Qu;var H4e=E.forwardRef((e,t)=>{const{forceMount:n,...r}=e,s=mc(Qu,e.__scopeScrollArea),[i,a]=E.useState(!1);return E.useEffect(()=>{const o=s.scrollArea;let l=0;if(o){const c=()=>{window.clearTimeout(l),a(!0)},u=()=>{l=window.setTimeout(()=>a(!1),s.scrollHideDelay)};return o.addEventListener("pointerenter",c),o.addEventListener("pointerleave",u),()=>{window.clearTimeout(l),o.removeEventListener("pointerenter",c),o.removeEventListener("pointerleave",u)}}},[s.scrollArea,s.scrollHideDelay]),f.jsx(ea,{present:n||i,children:f.jsx(tQ,{"data-state":i?"visible":"hidden",...r,ref:t})})}),G4e=E.forwardRef((e,t)=>{const{forceMount:n,...r}=e,s=mc(Qu,e.__scopeScrollArea),i=e.orientation==="horizontal",a=IT(()=>l("SCROLL_END"),100),[o,l]=V4e("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return E.useEffect(()=>{if(o==="idle"){const c=window.setTimeout(()=>l("HIDE"),s.scrollHideDelay);return()=>window.clearTimeout(c)}},[o,s.scrollHideDelay,l]),E.useEffect(()=>{const c=s.viewport,u=i?"scrollLeft":"scrollTop";if(c){let d=c[u];const h=()=>{const m=c[u];d!==m&&(l("SCROLL"),a()),d=m};return c.addEventListener("scroll",h),()=>c.removeEventListener("scroll",h)}},[s.viewport,i,l,a]),f.jsx(ea,{present:n||o!=="hidden",children:f.jsx(tF,{"data-state":o==="hidden"?"hidden":"visible",...r,ref:t,onPointerEnter:Wt(e.onPointerEnter,()=>l("POINTER_ENTER")),onPointerLeave:Wt(e.onPointerLeave,()=>l("POINTER_LEAVE"))})})}),tQ=E.forwardRef((e,t)=>{const n=mc(Qu,e.__scopeScrollArea),{forceMount:r,...s}=e,[i,a]=E.useState(!1),o=e.orientation==="horizontal",l=IT(()=>{if(n.viewport){const c=n.viewport.offsetWidth<n.viewport.scrollWidth,u=n.viewport.offsetHeight<n.viewport.scrollHeight;a(o?c:u)}},10);return Py(n.viewport,l),Py(n.content,l),f.jsx(ea,{present:r||i,children:f.jsx(tF,{"data-state":i?"visible":"hidden",...s,ref:t})})}),tF=E.forwardRef((e,t)=>{const{orientation:n="vertical",...r}=e,s=mc(Qu,e.__scopeScrollArea),i=E.useRef(null),a=E.useRef(0),[o,l]=E.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),c=aQ(o.viewport,o.content),u={...r,sizes:o,onSizesChange:l,hasThumb:c>0&&c<1,onThumbChange:h=>i.current=h,onThumbPointerUp:()=>a.current=0,onThumbPointerDown:h=>a.current=h};function d(h,m){return Q4e(h,a.current,o,m)}return n==="horizontal"?f.jsx(K4e,{...u,ref:t,onThumbPositionChange:()=>{if(s.viewport&&i.current){const h=s.viewport.scrollLeft,m=F7(h,o,s.dir);i.current.style.transform=`translate3d(${m}px, 0, 0)`}},onWheelScroll:h=>{s.viewport&&(s.viewport.scrollLeft=h)},onDragScroll:h=>{s.viewport&&(s.viewport.scrollLeft=d(h,s.dir))}}):n==="vertical"?f.jsx(Y4e,{...u,ref:t,onThumbPositionChange:()=>{if(s.viewport&&i.current){const h=s.viewport.scrollTop,m=F7(h,o);i.current.style.transform=`translate3d(0, ${m}px, 0)`}},onWheelScroll:h=>{s.viewport&&(s.viewport.scrollTop=h)},onDragScroll:h=>{s.viewport&&(s.viewport.scrollTop=d(h))}}):null}),K4e=E.forwardRef((e,t)=>{const{sizes:n,onSizesChange:r,...s}=e,i=mc(Qu,e.__scopeScrollArea),[a,o]=E.useState(),l=E.useRef(null),c=Tn(t,l,i.onScrollbarXChange);return E.useEffect(()=>{l.current&&o(getComputedStyle(l.current))},[l]),f.jsx(rQ,{"data-orientation":"horizontal",...s,ref:c,sizes:n,style:{bottom:0,left:i.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:i.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":NT(n)+"px",...e.style},onThumbPointerDown:u=>e.onThumbPointerDown(u.x),onDragScroll:u=>e.onDragScroll(u.x),onWheelScroll:(u,d)=>{if(i.viewport){const h=i.viewport.scrollLeft+u.deltaX;e.onWheelScroll(h),lQ(h,d)&&u.preventDefault()}},onResize:()=>{l.current&&i.viewport&&a&&r({content:i.viewport.scrollWidth,viewport:i.viewport.offsetWidth,scrollbar:{size:l.current.clientWidth,paddingStart:Tk(a.paddingLeft),paddingEnd:Tk(a.paddingRight)}})}})}),Y4e=E.forwardRef((e,t)=>{const{sizes:n,onSizesChange:r,...s}=e,i=mc(Qu,e.__scopeScrollArea),[a,o]=E.useState(),l=E.useRef(null),c=Tn(t,l,i.onScrollbarYChange);return E.useEffect(()=>{l.current&&o(getComputedStyle(l.current))},[l]),f.jsx(rQ,{"data-orientation":"vertical",...s,ref:c,sizes:n,style:{top:0,right:i.dir==="ltr"?0:void 0,left:i.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":NT(n)+"px",...e.style},onThumbPointerDown:u=>e.onThumbPointerDown(u.y),onDragScroll:u=>e.onDragScroll(u.y),onWheelScroll:(u,d)=>{if(i.viewport){const h=i.viewport.scrollTop+u.deltaY;e.onWheelScroll(h),lQ(h,d)&&u.preventDefault()}},onResize:()=>{l.current&&i.viewport&&a&&r({content:i.viewport.scrollHeight,viewport:i.viewport.offsetHeight,scrollbar:{size:l.current.clientHeight,paddingStart:Tk(a.paddingTop),paddingEnd:Tk(a.paddingBottom)}})}})}),[Z4e,nQ]=ZJ(Qu),rQ=E.forwardRef((e,t)=>{const{__scopeScrollArea:n,sizes:r,hasThumb:s,onThumbChange:i,onThumbPointerUp:a,onThumbPointerDown:o,onThumbPositionChange:l,onDragScroll:c,onWheelScroll:u,onResize:d,...h}=e,m=mc(Qu,n),[y,b]=E.useState(null),v=Tn(t,I=>b(I)),x=E.useRef(null),w=E.useRef(""),_=m.viewport,k=r.content-r.viewport,C=Ts(u),T=Ts(l),A=IT(d,10);function N(I){if(x.current){const j=I.clientX-x.current.left,L=I.clientY-x.current.top;c({x:j,y:L})}}return E.useEffect(()=>{const I=j=>{const L=j.target;(y==null?void 0:y.contains(L))&&C(j,k)};return document.addEventListener("wheel",I,{passive:!1}),()=>document.removeEventListener("wheel",I,{passive:!1})},[_,y,k,C]),E.useEffect(T,[r,T]),Py(y,A),Py(m.content,A),f.jsx(Z4e,{scope:n,scrollbar:y,hasThumb:s,onThumbChange:Ts(i),onThumbPointerUp:Ts(a),onThumbPositionChange:T,onThumbPointerDown:Ts(o),children:f.jsx(Kn.div,{...h,ref:v,style:{position:"absolute",...h.style},onPointerDown:Wt(e.onPointerDown,I=>{I.button===0&&(I.target.setPointerCapture(I.pointerId),x.current=y.getBoundingClientRect(),w.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",m.viewport&&(m.viewport.style.scrollBehavior="auto"),N(I))}),onPointerMove:Wt(e.onPointerMove,N),onPointerUp:Wt(e.onPointerUp,I=>{const j=I.target;j.hasPointerCapture(I.pointerId)&&j.releasePointerCapture(I.pointerId),document.body.style.webkitUserSelect=w.current,m.viewport&&(m.viewport.style.scrollBehavior=""),x.current=null})})})}),Ek="ScrollAreaThumb",sQ=E.forwardRef((e,t)=>{const{forceMount:n,...r}=e,s=nQ(Ek,e.__scopeScrollArea);return f.jsx(ea,{present:n||s.hasThumb,children:f.jsx(X4e,{ref:t,...r})})}),X4e=E.forwardRef((e,t)=>{const{__scopeScrollArea:n,style:r,...s}=e,i=mc(Ek,n),a=nQ(Ek,n),{onThumbPositionChange:o}=a,l=Tn(t,d=>a.onThumbChange(d)),c=E.useRef(void 0),u=IT(()=>{c.current&&(c.current(),c.current=void 0)},100);return E.useEffect(()=>{const d=i.viewport;if(d){const h=()=>{if(u(),!c.current){const m=eOe(d,o);c.current=m,o()}};return o(),d.addEventListener("scroll",h),()=>d.removeEventListener("scroll",h)}},[i.viewport,u,o]),f.jsx(Kn.div,{"data-state":a.hasThumb?"visible":"hidden",...s,ref:l,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...r},onPointerDownCapture:Wt(e.onPointerDownCapture,d=>{const m=d.target.getBoundingClientRect(),y=d.clientX-m.left,b=d.clientY-m.top;a.onThumbPointerDown({x:y,y:b})}),onPointerUp:Wt(e.onPointerUp,a.onThumbPointerUp)})});sQ.displayName=Ek;var nF="ScrollAreaCorner",iQ=E.forwardRef((e,t)=>{const n=mc(nF,e.__scopeScrollArea),r=!!(n.scrollbarX&&n.scrollbarY);return n.type!=="scroll"&&r?f.jsx(J4e,{...e,ref:t}):null});iQ.displayName=nF;var J4e=E.forwardRef((e,t)=>{const{__scopeScrollArea:n,...r}=e,s=mc(nF,n),[i,a]=E.useState(0),[o,l]=E.useState(0),c=!!(i&&o);return Py(s.scrollbarX,()=>{var d;const u=((d=s.scrollbarX)==null?void 0:d.offsetHeight)||0;s.onCornerHeightChange(u),l(u)}),Py(s.scrollbarY,()=>{var d;const u=((d=s.scrollbarY)==null?void 0:d.offsetWidth)||0;s.onCornerWidthChange(u),a(u)}),c?f.jsx(Kn.div,{...r,ref:t,style:{width:i,height:o,position:"absolute",right:s.dir==="ltr"?0:void 0,left:s.dir==="rtl"?0:void 0,bottom:0,...e.style}}):null});function Tk(e){return e?parseInt(e,10):0}function aQ(e,t){const n=e/t;return isNaN(n)?0:n}function NT(e){const t=aQ(e.viewport,e.content),n=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,r=(e.scrollbar.size-n)*t;return Math.max(r,18)}function Q4e(e,t,n,r="ltr"){const s=NT(n),i=s/2,a=t||i,o=s-a,l=n.scrollbar.paddingStart+a,c=n.scrollbar.size-n.scrollbar.paddingEnd-o,u=n.content-n.viewport,d=r==="ltr"?[0,u]:[u*-1,0];return oQ([l,c],d)(e)}function F7(e,t,n="ltr"){const r=NT(t),s=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,i=t.scrollbar.size-s,a=t.content-t.viewport,o=i-r,l=n==="ltr"?[0,a]:[a*-1,0],c=Kw(e,l);return oQ([0,a],[0,o])(c)}function oQ(e,t){return n=>{if(e[0]===e[1]||t[0]===t[1])return t[0];const r=(t[1]-t[0])/(e[1]-e[0]);return t[0]+r*(n-e[0])}}function lQ(e,t){return e>0&&e<t}var eOe=(e,t=()=>{})=>{let n={left:e.scrollLeft,top:e.scrollTop},r=0;return function s(){const i={left:e.scrollLeft,top:e.scrollTop},a=n.left!==i.left,o=n.top!==i.top;(a||o)&&t(),n=i,r=window.requestAnimationFrame(s)}(),()=>window.cancelAnimationFrame(r)};function IT(e,t){const n=Ts(e),r=E.useRef(0);return E.useEffect(()=>()=>window.clearTimeout(r.current),[]),E.useCallback(()=>{window.clearTimeout(r.current),r.current=window.setTimeout(n,t)},[n,t])}function Py(e,t){const n=Ts(t);ii(()=>{let r=0;if(e){const s=new ResizeObserver(()=>{cancelAnimationFrame(r),r=window.requestAnimationFrame(n)});return s.observe(e),()=>{window.cancelAnimationFrame(r),s.unobserve(e)}}},[e,n])}var tOe=XJ,nOe=QJ,rOe=iQ;function Xo({className:e,children:t,...n}){return f.jsxs(tOe,{"data-slot":"scroll-area",className:Ye("relative",e),...n,children:[f.jsx(nOe,{"data-slot":"scroll-area-viewport",className:"focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1",children:t}),f.jsx(sOe,{}),f.jsx(rOe,{})]})}function sOe({className:e,orientation:t="vertical",...n}){return f.jsx(eQ,{"data-slot":"scroll-area-scrollbar",orientation:t,className:Ye("flex touch-none p-px transition-colors select-none",t==="vertical"&&"h-full w-2.5 border-l border-l-transparent",t==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent",e),...n,children:f.jsx(sQ,{"data-slot":"scroll-area-thumb",className:"bg-border relative flex-1 rounded-full"})})}const G0=new WeakMap,YC=new WeakMap,Ak={current:[]};let $M=!1,Lx=0;const px=new Set,lC=new Map;function cQ(e){const t=Array.from(e).sort((n,r)=>n instanceof ef&&n.options.deps.includes(r)?1:r instanceof ef&&r.options.deps.includes(n)?-1:0);for(const n of t){if(Ak.current.includes(n))continue;Ak.current.push(n),n.recompute();const r=YC.get(n);if(r)for(const s of r){const i=G0.get(s);i&&cQ(i)}}}function iOe(e){e.listeners.forEach(t=>t({prevVal:e.prevState,currentVal:e.state}))}function aOe(e){e.listeners.forEach(t=>t({prevVal:e.prevState,currentVal:e.state}))}function uQ(e){if(Lx>0&&!lC.has(e)&&lC.set(e,e.prevState),px.add(e),!(Lx>0)&&!$M)try{for($M=!0;px.size>0;){const t=Array.from(px);px.clear();for(const n of t){const r=lC.get(n)??n.prevState;n.prevState=r,iOe(n)}for(const n of t){const r=G0.get(n);r&&(Ak.current.push(n),cQ(r))}for(const n of t){const r=G0.get(n);if(r)for(const s of r)aOe(s)}}}finally{$M=!1,Ak.current=[],lC.clear()}}function gu(e){Lx++;try{e()}finally{if(Lx--,Lx===0){const t=Array.from(px)[0];t&&uQ(t)}}}function oOe(e){return typeof e=="function"}class iP{constructor(t,n){this.listeners=new Set,this.subscribe=r=>{var s,i;this.listeners.add(r);const a=(i=(s=this.options)==null?void 0:s.onSubscribe)==null?void 0:i.call(s,r,this);return()=>{this.listeners.delete(r),a==null||a()}},this.prevState=t,this.state=t,this.options=n}setState(t){var n,r,s;this.prevState=this.state,(n=this.options)!=null&&n.updateFn?this.state=this.options.updateFn(this.prevState)(t):oOe(t)?this.state=t(this.prevState):this.state=t,(s=(r=this.options)==null?void 0:r.onUpdate)==null||s.call(r),uQ(this)}}class ef{constructor(t){this.listeners=new Set,this._subscriptions=[],this.lastSeenDepValues=[],this.getDepVals=()=>{const n=[],r=[];for(const s of this.options.deps)n.push(s.prevState),r.push(s.state);return this.lastSeenDepValues=r,{prevDepVals:n,currDepVals:r,prevVal:this.prevState??void 0}},this.recompute=()=>{var n,r;this.prevState=this.state;const{prevDepVals:s,currDepVals:i,prevVal:a}=this.getDepVals();this.state=this.options.fn({prevDepVals:s,currDepVals:i,prevVal:a}),(r=(n=this.options).onUpdate)==null||r.call(n)},this.checkIfRecalculationNeededDeeply=()=>{for(const i of this.options.deps)i instanceof ef&&i.checkIfRecalculationNeededDeeply();let n=!1;const r=this.lastSeenDepValues,{currDepVals:s}=this.getDepVals();for(let i=0;i<s.length;i++)if(s[i]!==r[i]){n=!0;break}n&&this.recompute()},this.mount=()=>(this.registerOnGraph(),this.checkIfRecalculationNeededDeeply(),()=>{this.unregisterFromGraph();for(const n of this._subscriptions)n()}),this.subscribe=n=>{var r,s;this.listeners.add(n);const i=(s=(r=this.options).onSubscribe)==null?void 0:s.call(r,n,this);return()=>{this.listeners.delete(n),i==null||i()}},this.options=t,this.state=t.fn({prevDepVals:void 0,prevVal:void 0,currDepVals:this.getDepVals().currDepVals})}registerOnGraph(t=this.options.deps){for(const n of t)if(n instanceof ef)n.registerOnGraph(),this.registerOnGraph(n.options.deps);else if(n instanceof iP){let r=G0.get(n);r||(r=new Set,G0.set(n,r)),r.add(this);let s=YC.get(this);s||(s=new Set,YC.set(this,s)),s.add(n)}}unregisterFromGraph(t=this.options.deps){for(const n of t)if(n instanceof ef)this.unregisterFromGraph(n.options.deps);else if(n instanceof iP){const r=G0.get(n);r&&r.delete(this);const s=YC.get(this);s&&s.delete(n)}}}function MT(e,t){return typeof e=="function"?e(t):e}function mx(e,t){return rF(t).reduce((r,s)=>{if(r===null)return null;if(typeof r<"u")return r[s]},e)}function cC(e,t,n){const r=rF(t);function s(i){if(!r.length)return MT(n,i);const a=r.shift();if(typeof a=="string"||typeof a=="number"&&!Array.isArray(i))return typeof i=="object"?(i===null&&(i={}),{...i,[a]:s(i[a])}):{[a]:s()};if(Array.isArray(i)&&typeof a=="number"){const o=i.slice(0,a);return[...o.length?o:new Array(a),s(i[a]),...i.slice(a+1)]}return[...new Array(a),s()]}return s(e)}function lOe(e,t){const n=rF(t);function r(s){if(!s)return;if(n.length===1){const a=n[0];if(Array.isArray(s)&&typeof a=="number")return s.filter((c,u)=>u!==a);const{[a]:o,...l}=s;return l}const i=n.shift();if(typeof i=="string"&&typeof s=="object")return{...s,[i]:r(s[i])};if(typeof i=="number"&&Array.isArray(s)){if(i>=s.length)return s;const a=s.slice(0,i);return[...a.length?a:new Array(i),r(s[i]),...s.slice(i+1)]}throw new Error("It seems we have created an infinite loop in deleteBy. ")}return r(e)}const cOe=/^(\d+)$/gm,uOe=/\.(\d+)(?=\.)/gm,dOe=/^(\d+)\./gm,fOe=/\.(\d+$)/gm,hOe=/\.{2,}/gm,aP="__int__",uC=`${aP}$1`;function rF(e){if(Array.isArray(e))return[...e];if(typeof e!="string")throw new Error("Path must be a string.");return e.replace(/(^\[)|]/gm,"").replace(/\[/g,".").replace(cOe,uC).replace(uOe,`.${uC}.`).replace(dOe,`${uC}.`).replace(fOe,`.${uC}`).replace(hOe,".").split(".").map(t=>t.indexOf(aP)===0?parseInt(t.substring(aP.length),10):t)}function pOe(e){return!(Array.isArray(e)&&e.length===0)}function oP(e,t){const{asyncDebounceMs:n}=t,{onChangeAsync:r,onBlurAsync:s,onSubmitAsync:i,onBlurAsyncDebounceMs:a,onChangeAsyncDebounceMs:o}=t.validators||{},l=n??0,c={cause:"change",validate:r,debounceMs:o??l},u={cause:"blur",validate:s,debounceMs:a??l},d={cause:"submit",validate:i,debounceMs:0},h=m=>({...m,debounceMs:0});switch(e){case"submit":return[h(c),h(u),d];case"blur":return[u];case"change":return[c];case"server":default:return[]}}function lP(e,t){const{onChange:n,onBlur:r,onSubmit:s,onMount:i}=t.validators||{},a={cause:"change",validate:n},o={cause:"blur",validate:r},l={cause:"submit",validate:s},c={cause:"mount",validate:i},u={cause:"server",validate:()=>{}};switch(e){case"mount":return[c];case"submit":return[a,o,l,u];case"server":return[u];case"blur":return[o,u];case"change":default:return[a,u]}}const cP=e=>!!e&&typeof e=="object"&&"fields"in e;function _0(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[s,i]of e)if(!t.has(s)||!Object.is(i,t.get(s)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const s of e)if(!t.has(s))return!1;return!0}const n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(const s of n)if(!r.includes(s)||!_0(e[s],t[s]))return!1;return!0}const L7=({newFormValidatorError:e,isPreviousErrorFromFormValidator:t,previousErrorValue:n})=>e?{newErrorValue:e,newSource:"form"}:t?{newErrorValue:void 0,newSource:void 0}:n?{newErrorValue:n,newSource:"field"}:{newErrorValue:void 0,newSource:void 0},B7=({formLevelError:e,fieldLevelError:t})=>t?{newErrorValue:t,newSource:"field"}:e?{newErrorValue:e,newSource:"form"}:{newErrorValue:void 0,newSource:void 0};function mOe(e){const t=new Map;for(const n of e){const r=[...n.path??[]].map(s=>{const i=typeof s=="object"?s.key:s;return typeof i=="number"?`[${i}]`:i}).join(".").replace(/\.\[/g,"[");t.set(r,(t.get(r)??[]).concat(n))}return Object.fromEntries(t)}const $7=e=>{const t=mOe(e);return{form:t,fields:t}},K0={validate({value:e,validationSource:t},n){const r=n["~standard"].validate(e);if(r instanceof Promise)throw new Error("async function passed to sync validator");if(r.issues)return t==="field"?r.issues:$7(r.issues)},async validateAsync({value:e,validationSource:t},n){const r=await n["~standard"].validate(e);if(r.issues)return t==="field"?r.issues:$7(r.issues)}},dQ=e=>!!e&&"~standard"in e,Rk={isValidating:!1,isTouched:!1,isBlurred:!1,isDirty:!1,isPristine:!0,isValid:!0,isDefaultValue:!0,errors:[],errorMap:{},errorSourceMap:{}};function dC(e){function t(d,h,m,y){const b=r(d,h,m,y);({insert:()=>o(b,d,h),remove:()=>l(b),swap:()=>y!==void 0&&u(b,d,h,y),move:()=>y!==void 0&&c(b,d,h,y)})[m]()}function n(d,h){return`${d}[${h}]`}function r(d,h,m,y){const b=[n(d,h)];if(m==="swap")b.push(n(d,y));else if(m==="move"){const[v,x]=[Math.min(h,y),Math.max(h,y)];for(let w=v;w<=x;w++)b.push(n(d,w))}else{const v=e.getFieldValue(d),x=Array.isArray(v)?v.length:0;for(let w=h+1;w<x;w++)b.push(n(d,w))}return Object.keys(e.fieldInfo).filter(v=>b.some(x=>v.startsWith(x)))}function s(d,h){return d.replace(/\[(\d+)\]/,(m,y)=>{const b=parseInt(y,10);return`[${h==="up"?b+1:Math.max(0,b-1)}]`})}function i(d,h){(h==="up"?d:[...d].reverse()).forEach(y=>{const b=s(y.toString(),h),v=e.getFieldMeta(b);v?e.setFieldMeta(y,v):e.setFieldMeta(y,a())})}const a=()=>Rk,o=(d,h,m)=>{i(d,"down"),d.forEach(y=>{y.toString().startsWith(n(h,m))&&e.setFieldMeta(y,a())})},l=d=>{i(d,"up")},c=(d,h,m,y)=>{const b=new Map(Object.keys(e.fieldInfo).filter(v=>v.startsWith(n(h,m))).map(v=>[v,e.getFieldMeta(v)]));i(d,m<y?"up":"down"),Object.keys(e.fieldInfo).filter(v=>v.startsWith(n(h,y))).forEach(v=>{const x=v.replace(n(h,y),n(h,m)),w=b.get(x);w&&e.setFieldMeta(v,w)})},u=(d,h,m,y)=>{d.forEach(b=>{if(!b.toString().startsWith(n(h,m)))return;const v=b.toString().replace(n(h,m),n(h,y)),[x,w]=[e.getFieldMeta(b),e.getFieldMeta(v)];x&&e.setFieldMeta(v,x),w&&e.setFieldMeta(b,w)})};return{handleArrayFieldMetaShift:t}}function zM(e){return{values:e.values??{},errorMap:e.errorMap??{},fieldMetaBase:e.fieldMetaBase??{},isSubmitted:e.isSubmitted??!1,isSubmitting:e.isSubmitting??!1,isValidating:e.isValidating??!1,submissionAttempts:e.submissionAttempts??0,isSubmitSuccessful:e.isSubmitSuccessful??!1,validationMetaMap:e.validationMetaMap??{onChange:void 0,onBlur:void 0,onSubmit:void 0,onMount:void 0,onServer:void 0}}}class gOe{constructor(t){var n;this.options={},this.fieldInfo={},this.prevTransformArray=[],this.mount=()=>{var r,s;const i=this.fieldMetaDerived.mount(),a=this.store.mount(),o=()=>{i(),a()};(s=(r=this.options.listeners)==null?void 0:r.onMount)==null||s.call(r,{formApi:this});const{onMount:l}=this.options.validators||{};return l&&this.validateSync("mount"),o},this.update=r=>{var s,i;if(!r)return;const a=this.options;this.options=r;const o=!!((i=(s=r.transform)==null?void 0:s.deps)!=null&&i.some((u,d)=>u!==this.prevTransformArray[d])),l=r.defaultValues&&!_0(r.defaultValues,a.defaultValues)&&!this.state.isTouched,c=!_0(r.defaultState,a.defaultState)&&!this.state.isTouched;!l&&!c&&!o||gu(()=>{this.baseStore.setState(()=>zM(Object.assign({},this.state,c?r.defaultState:{},l?{values:r.defaultValues}:{},o?{_force_re_eval:!this.state._force_re_eval}:{})))})},this.reset=(r,s)=>{const{fieldMeta:i}=this.state,a=this.resetFieldMeta(i);r&&!(s!=null&&s.keepDefaultValues)&&(this.options={...this.options,defaultValues:r}),this.baseStore.setState(()=>{var o;return zM({...this.options.defaultState,values:r??this.options.defaultValues??((o=this.options.defaultState)==null?void 0:o.values),fieldMetaBase:a})})},this.validateAllFields=async r=>{const s=[];return gu(()=>{Object.values(this.fieldInfo).forEach(a=>{if(!a.instance)return;const o=a.instance;s.push(Promise.resolve().then(()=>o.validate(r,{skipFormValidation:!0}))),a.instance.state.meta.isTouched||a.instance.setMeta(l=>({...l,isTouched:!0}))})}),(await Promise.all(s)).flat()},this.validateArrayFieldsStartingFrom=async(r,s,i)=>{const a=this.getFieldValue(r),o=Array.isArray(a)?Math.max(a.length-1,0):null,l=[`${r}[${s}]`];for(let h=s+1;h<=(o??0);h++)l.push(`${r}[${h}]`);const c=Object.keys(this.fieldInfo).filter(h=>l.some(m=>h.startsWith(m))),u=[];return gu(()=>{c.forEach(h=>{u.push(Promise.resolve().then(()=>this.validateField(h,i)))})}),(await Promise.all(u)).flat()},this.validateField=(r,s)=>{var i;const a=(i=this.fieldInfo[r])==null?void 0:i.instance;return a?(a.state.meta.isTouched||a.setMeta(o=>({...o,isTouched:!0})),a.validate(s)):[]},this.validateSync=r=>{const s=lP(r,this.options);let i=!1;const a={};return gu(()=>{var o,l;for(const u of s){if(!u.validate)continue;const d=this.runValidator({validate:u.validate,value:{value:this.state.values,formApi:this,validationSource:"form"},type:"validate"}),{formError:h,fieldErrors:m}=ZC(d),y=fC(u.cause);for(const b of Object.keys(this.state.fieldMeta)){const v=this.getFieldMeta(b);if(!v)continue;const{errorMap:x,errorSourceMap:w}=v,_=m==null?void 0:m[b],{newErrorValue:k,newSource:C}=L7({newFormValidatorError:_,isPreviousErrorFromFormValidator:(w==null?void 0:w[y])==="form",previousErrorValue:x==null?void 0:x[y]});C==="form"&&(a[b]={...a[b],[y]:_}),(x==null?void 0:x[y])!==k&&this.setFieldMeta(b,T=>({...T,errorMap:{...T.errorMap,[y]:k},errorSourceMap:{...T.errorSourceMap,[y]:C}}))}((o=this.state.errorMap)==null?void 0:o[y])!==h&&this.baseStore.setState(b=>({...b,errorMap:{...b.errorMap,[y]:h}})),(h||m)&&(i=!0)}const c=fC("submit");(l=this.state.errorMap)!=null&&l[c]&&r!=="submit"&&!i&&this.baseStore.setState(u=>({...u,errorMap:{...u.errorMap,[c]:void 0}}))}),{hasErrored:i,fieldsErrorMap:a}},this.validateAsync=async r=>{const s=oP(r,this.options);this.state.isFormValidating||this.baseStore.setState(c=>({...c,isFormValidating:!0}));const i=[];let a;for(const c of s){if(!c.validate)continue;const u=fC(c.cause),d=this.state.validationMetaMap[u];d==null||d.lastAbortController.abort();const h=new AbortController;this.state.validationMetaMap[u]={lastAbortController:h},i.push(new Promise(async m=>{let y;try{y=await new Promise((w,_)=>{setTimeout(async()=>{if(h.signal.aborted)return w(void 0);try{w(await this.runValidator({validate:c.validate,value:{value:this.state.values,formApi:this,validationSource:"form",signal:h.signal},type:"validateAsync"}))}catch(k){_(k)}},c.debounceMs)})}catch(w){y=w}const{formError:b,fieldErrors:v}=ZC(y);v&&(a=a?{...a,...v}:v);const x=fC(c.cause);for(const w of Object.keys(this.state.fieldMeta)){const _=this.getFieldMeta(w);if(!_)continue;const{errorMap:k,errorSourceMap:C}=_,T=a==null?void 0:a[w],{newErrorValue:A,newSource:N}=L7({newFormValidatorError:T,isPreviousErrorFromFormValidator:(C==null?void 0:C[x])==="form",previousErrorValue:k==null?void 0:k[x]});(k==null?void 0:k[x])!==A&&this.setFieldMeta(w,I=>({...I,errorMap:{...I.errorMap,[x]:A},errorSourceMap:{...I.errorSourceMap,[x]:N}}))}this.baseStore.setState(w=>({...w,errorMap:{...w.errorMap,[x]:b}})),m(a?{fieldErrors:a,errorMapKey:x}:void 0)}))}let o=[];const l={};if(i.length){o=await Promise.all(i);for(const c of o)if(c!=null&&c.fieldErrors){const{errorMapKey:u}=c;for(const[d,h]of Object.entries(c.fieldErrors)){const y={...l[d]||{},[u]:h};l[d]=y}}}return this.baseStore.setState(c=>({...c,isFormValidating:!1})),l},this.validate=r=>{const{hasErrored:s,fieldsErrorMap:i}=this.validateSync(r);return s&&!this.options.asyncAlways?i:this.validateAsync(r)},this.getFieldValue=r=>mx(this.state.values,r),this.getFieldMeta=r=>this.state.fieldMeta[r],this.getFieldInfo=r=>{var s;return(s=this.fieldInfo)[r]||(s[r]={instance:null,validationMetaMap:{onChange:void 0,onBlur:void 0,onSubmit:void 0,onMount:void 0,onServer:void 0}})},this.setFieldMeta=(r,s)=>{this.baseStore.setState(i=>({...i,fieldMetaBase:{...i.fieldMetaBase,[r]:MT(s,i.fieldMetaBase[r])}}))},this.resetFieldMeta=r=>Object.keys(r).reduce((s,i)=>{const a=i;return s[a]=Rk,s},{}),this.setFieldValue=(r,s,i)=>{const a=(i==null?void 0:i.dontUpdateMeta)??!1;gu(()=>{a||this.setFieldMeta(r,o=>({...o,isTouched:!0,isDirty:!0,errorMap:{...o==null?void 0:o.errorMap,onMount:void 0}})),this.baseStore.setState(o=>({...o,values:cC(o.values,r,s)}))})},this.deleteField=r=>{const i=[...Object.keys(this.fieldInfo).filter(a=>{const o=r.toString();return a!==o&&a.startsWith(o)}),r];this.baseStore.setState(a=>{const o={...a};return i.forEach(l=>{o.values=lOe(o.values,l),delete this.fieldInfo[l],delete o.fieldMetaBase[l]}),o})},this.pushFieldValue=(r,s,i)=>{this.setFieldValue(r,a=>[...Array.isArray(a)?a:[],s],i),this.validateField(r,"change")},this.insertFieldValue=async(r,s,i,a)=>{this.setFieldValue(r,o=>[...o.slice(0,s),i,...o.slice(s)],a),await this.validateField(r,"change"),dC(this).handleArrayFieldMetaShift(r,s,"insert"),await this.validateArrayFieldsStartingFrom(r,s,"change")},this.replaceFieldValue=async(r,s,i,a)=>{this.setFieldValue(r,o=>o.map((l,c)=>c===s?i:l),a),await this.validateField(r,"change"),await this.validateArrayFieldsStartingFrom(r,s,"change")},this.removeFieldValue=async(r,s,i)=>{const a=this.getFieldValue(r),o=Array.isArray(a)?Math.max(a.length-1,0):null;if(this.setFieldValue(r,l=>l.filter((c,u)=>u!==s),i),dC(this).handleArrayFieldMetaShift(r,s,"remove"),o!==null){const l=`${r}[${o}]`;this.deleteField(l)}await this.validateField(r,"change"),await this.validateArrayFieldsStartingFrom(r,s,"change")},this.swapFieldValues=(r,s,i,a)=>{this.setFieldValue(r,o=>{const l=o[s],c=o[i];return cC(cC(o,`${s}`,c),`${i}`,l)},a),dC(this).handleArrayFieldMetaShift(r,s,"swap",i),this.validateField(r,"change"),this.validateField(`${r}[${s}]`,"change"),this.validateField(`${r}[${i}]`,"change")},this.moveFieldValues=(r,s,i,a)=>{this.setFieldValue(r,o=>{const l=[...o];return l.splice(i,0,l.splice(s,1)[0]),l},a),dC(this).handleArrayFieldMetaShift(r,s,"move",i),this.validateField(r,"change"),this.validateField(`${r}[${s}]`,"change"),this.validateField(`${r}[${i}]`,"change")},this.clearFieldValues=(r,s)=>{const i=this.getFieldValue(r),a=Array.isArray(i)?Math.max(i.length-1,0):null;if(this.setFieldValue(r,[],s),a!==null)for(let o=0;o<=a;o++){const l=`${r}[${o}]`;this.deleteField(l)}this.validateField(r,"change")},this.resetField=r=>{this.baseStore.setState(s=>({...s,fieldMetaBase:{...s.fieldMetaBase,[r]:Rk},values:this.options.defaultValues?cC(s.values,r,mx(this.options.defaultValues,r)):s.values}))},this.getAllErrors=()=>({form:{errors:this.state.errors,errorMap:this.state.errorMap},fields:Object.entries(this.state.fieldMeta).reduce((r,[s,i])=>(Object.keys(i).length&&i.errors.length&&(r[s]={errors:i.errors,errorMap:i.errorMap}),r),{})}),this.parseValuesWithSchema=r=>K0.validate({value:this.state.values,validationSource:"form"},r),this.parseValuesWithSchemaAsync=r=>K0.validateAsync({value:this.state.values,validationSource:"form"},r),this.baseStore=new iP(zM({...t==null?void 0:t.defaultState,values:(t==null?void 0:t.defaultValues)??((n=t==null?void 0:t.defaultState)==null?void 0:n.values)})),this.fieldMetaDerived=new ef({deps:[this.baseStore],fn:({prevDepVals:r,currDepVals:s,prevVal:i})=>{var a,o,l;const c=i,u=r==null?void 0:r[0],d=s[0];let h=0;const m={};for(const y of Object.keys(d.fieldMetaBase)){const b=d.fieldMetaBase[y],v=u==null?void 0:u.fieldMetaBase[y],x=c==null?void 0:c[y],w=mx(d.values,y);let _=x==null?void 0:x.errors;if(!v||b.errorMap!==v.errorMap){_=Object.values(b.errorMap??{}).filter(N=>N!==void 0);const A=(a=this.getFieldInfo(y))==null?void 0:a.instance;A&&!A.options.disableErrorFlat&&(_=_==null?void 0:_.flat(1))}const k=!pOe(_??[]),C=!b.isDirty,T=_0(w,mx(this.options.defaultValues,y))||_0(w,(l=(o=this.getFieldInfo(y))==null?void 0:o.instance)==null?void 0:l.options.defaultValue);if(x&&x.isPristine===C&&x.isValid===k&&x.isDefaultValue===T&&x.errors===_&&b===v){m[y]=x,h++;continue}m[y]={...b,errors:_,isPristine:C,isValid:k,isDefaultValue:T}}return Object.keys(d.fieldMetaBase).length&&c&&h===Object.keys(d.fieldMetaBase).length?c:m}}),this.store=new ef({deps:[this.baseStore,this.fieldMetaDerived],fn:({prevDepVals:r,currDepVals:s,prevVal:i})=>{var a,o,l,c;const u=i,d=r==null?void 0:r[0],h=s[0],m=s[1],y=Object.values(m).filter(Boolean),b=y.some(B=>B.isValidating),v=y.every(B=>B.isValid),x=y.some(B=>B.isTouched),w=y.some(B=>B.isBlurred),_=y.every(B=>B.isDefaultValue),k=x&&((a=h.errorMap)==null?void 0:a.onMount),C=y.some(B=>B.isDirty),T=!C,A=!!((o=h.errorMap)!=null&&o.onMount||y.some(B=>{var ne;return(ne=B==null?void 0:B.errorMap)==null?void 0:ne.onMount})),N=!!b;let I=(u==null?void 0:u.errors)??[];(!d||h.errorMap!==d.errorMap)&&(I=Object.values(h.errorMap).reduce((B,ne)=>ne===void 0?B:ne&&cP(ne)?(B.push(ne.form),B):(B.push(ne),B),[]));const j=I.length===0,L=v&&j,D=this.options.canSubmitWhenInvalid??!1,H=h.submissionAttempts===0&&!x&&!A||!N&&!h.isSubmitting&&L||D;let O=h.errorMap;if(k&&(I=I.filter(B=>B!==h.errorMap.onMount),O=Object.assign(O,{onMount:void 0})),u&&d&&u.errorMap===O&&u.fieldMeta===this.fieldMetaDerived.state&&u.errors===I&&u.isFieldsValidating===b&&u.isFieldsValid===v&&u.isFormValid===j&&u.isValid===L&&u.canSubmit===H&&u.isTouched===x&&u.isBlurred===w&&u.isPristine===T&&u.isDefaultValue===_&&u.isDirty===C&&_0(d,h))return u;let K={...h,errorMap:O,fieldMeta:this.fieldMetaDerived.state,errors:I,isFieldsValidating:b,isFieldsValid:v,isFormValid:j,isValid:L,canSubmit:H,isTouched:x,isBlurred:w,isPristine:T,isDefaultValue:_,isDirty:C};const U=((l=this.options.transform)==null?void 0:l.deps)??[];if(U.length!==this.prevTransformArray.length||U.some((B,ne)=>B!==this.prevTransformArray[ne])){const B=Object.assign({},this,{state:K});(c=this.options.transform)==null||c.fn(B),K=B.state,this.prevTransformArray=U}return K}}),this.handleSubmit=this.handleSubmit.bind(this),this.update(t||{})}get state(){return this.store.state}runValidator(t){return dQ(t.validate)?K0[t.type](t.value,t.validate):t.validate(t.value)}async handleSubmit(t){var n,r,s,i,a,o,l,c;if(this.baseStore.setState(d=>({...d,isSubmitted:!1,submissionAttempts:d.submissionAttempts+1,isSubmitSuccessful:!1})),gu(()=>{Object.values(this.fieldInfo).forEach(d=>{d.instance&&(d.instance.state.meta.isTouched||d.instance.setMeta(h=>({...h,isTouched:!0})))})}),!this.state.canSubmit)return;this.baseStore.setState(d=>({...d,isSubmitting:!0}));const u=()=>{this.baseStore.setState(d=>({...d,isSubmitting:!1}))};if(await this.validateAllFields("submit"),!this.state.isFieldsValid){u(),(r=(n=this.options).onSubmitInvalid)==null||r.call(n,{value:this.state.values,formApi:this});return}if(await this.validate("submit"),!this.state.isValid){u(),(i=(s=this.options).onSubmitInvalid)==null||i.call(s,{value:this.state.values,formApi:this});return}gu(()=>{Object.values(this.fieldInfo).forEach(d=>{var h,m,y;(y=(m=(h=d.instance)==null?void 0:h.options.listeners)==null?void 0:m.onSubmit)==null||y.call(m,{value:d.instance.state.value,fieldApi:d.instance})})}),(o=(a=this.options.listeners)==null?void 0:a.onSubmit)==null||o.call(a,{formApi:this});try{await((c=(l=this.options).onSubmit)==null?void 0:c.call(l,{value:this.state.values,formApi:this,meta:t??this.options.onSubmitMeta})),gu(()=>{this.baseStore.setState(d=>({...d,isSubmitted:!0,isSubmitSuccessful:!0})),u()})}catch(d){throw this.baseStore.setState(h=>({...h,isSubmitSuccessful:!1})),u(),d}}setErrorMap(t){gu(()=>{Object.entries(t).forEach(([n,r])=>{const s=n;if(cP(r)){const{formError:i,fieldErrors:a}=ZC(r);for(const o of Object.keys(this.fieldInfo))this.getFieldMeta(o)&&this.setFieldMeta(o,c=>({...c,errorMap:{...c.errorMap,[s]:a==null?void 0:a[o]},errorSourceMap:{...c.errorSourceMap,[s]:"form"}}));this.baseStore.setState(o=>({...o,errorMap:{...o.errorMap,[s]:i}}))}else this.baseStore.setState(i=>({...i,errorMap:{...i.errorMap,[s]:r}}))})})}}function ZC(e){if(e){if(cP(e)){const t=ZC(e.form).formError,n=e.fields;return{formError:t,fieldErrors:n}}return{formError:e}}return{formError:void 0}}function fC(e){switch(e){case"submit":return"onSubmit";case"blur":return"onBlur";case"mount":return"onMount";case"server":return"onServer";case"change":default:return"onChange"}}class yOe{constructor(t){this.options={},this.mount=()=>{var n,r;const s=this.store.mount();this.options.defaultValue!==void 0&&this.form.setFieldValue(this.name,this.options.defaultValue,{dontUpdateMeta:!0});const i=this.getInfo();i.instance=this,this.update(this.options);const{onMount:a}=this.options.validators||{};if(a){const o=this.runValidator({validate:a,value:{value:this.state.value,fieldApi:this,validationSource:"field"},type:"validate"});o&&this.setMeta(l=>({...l,errorMap:{...l==null?void 0:l.errorMap,onMount:o},errorSourceMap:{...l==null?void 0:l.errorSourceMap,onMount:"field"}}))}return(r=(n=this.options.listeners)==null?void 0:n.onMount)==null||r.call(n,{value:this.state.value,fieldApi:this}),s},this.update=n=>{this.options=n;const r=this.name!==n.name;if(this.name=n.name,this.state.value===void 0){const s=mx(n.form.options.defaultValues,n.name),i=n.defaultValue??s;r?this.setValue(a=>a||i,{dontUpdateMeta:!0}):i!==void 0&&this.setValue(i,{dontUpdateMeta:!0})}this.form.getFieldMeta(this.name)===void 0&&this.setMeta(this.state.meta)},this.getValue=()=>this.form.getFieldValue(this.name),this.setValue=(n,r)=>{this.form.setFieldValue(this.name,n,r),this.triggerOnChangeListener(),this.validate("change")},this.getMeta=()=>this.store.state.meta,this.setMeta=n=>this.form.setFieldMeta(this.name,n),this.getInfo=()=>this.form.getFieldInfo(this.name),this.pushValue=(n,r)=>{this.form.pushFieldValue(this.name,n,r),this.triggerOnChangeListener()},this.insertValue=(n,r,s)=>{this.form.insertFieldValue(this.name,n,r,s),this.triggerOnChangeListener()},this.replaceValue=(n,r,s)=>{this.form.replaceFieldValue(this.name,n,r,s),this.triggerOnChangeListener()},this.removeValue=(n,r)=>{this.form.removeFieldValue(this.name,n,r),this.triggerOnChangeListener()},this.swapValues=(n,r,s)=>{this.form.swapFieldValues(this.name,n,r,s),this.triggerOnChangeListener()},this.moveValue=(n,r,s)=>{this.form.moveFieldValues(this.name,n,r,s),this.triggerOnChangeListener()},this.clearValues=n=>{this.form.clearFieldValues(this.name,n),this.triggerOnChangeListener()},this.getLinkedFields=n=>{const r=Object.values(this.form.fieldInfo),s=[];for(const i of r){if(!i.instance)continue;const{onChangeListenTo:a,onBlurListenTo:o}=i.instance.options.validators||{};n==="change"&&(a!=null&&a.includes(this.name))&&s.push(i.instance),n==="blur"&&(o!=null&&o.includes(this.name))&&s.push(i.instance)}return s},this.validateSync=(n,r)=>{var s;const i=lP(n,this.options),o=this.getLinkedFields(n).reduce((u,d)=>{const h=lP(n,d.options);return h.forEach(m=>{m.field=d}),u.concat(h)},[]);let l=!1;gu(()=>{const u=(d,h)=>{var m;const y=hC(h.cause),b=h.validate?z7(d.runValidator({validate:h.validate,value:{value:d.store.state.value,validationSource:"field",fieldApi:d},type:"validate"})):void 0,v=r[y],{newErrorValue:x,newSource:w}=B7({formLevelError:v,fieldLevelError:b});((m=d.state.meta.errorMap)==null?void 0:m[y])!==x&&d.setMeta(_=>({..._,errorMap:{..._.errorMap,[y]:x},errorSourceMap:{..._.errorSourceMap,[y]:w}})),x&&(l=!0)};for(const d of i)u(this,d);for(const d of o)d.validate&&u(d.field,d)});const c=hC("submit");return(s=this.state.meta.errorMap)!=null&&s[c]&&n!=="submit"&&!l&&this.setMeta(u=>({...u,errorMap:{...u.errorMap,[c]:void 0},errorSourceMap:{...u.errorSourceMap,[c]:void 0}})),{hasErrored:l}},this.validateAsync=async(n,r)=>{const s=oP(n,this.options),i=await r,a=this.getLinkedFields(n),o=a.reduce((h,m)=>{const y=oP(n,m.options);return y.forEach(b=>{b.field=m}),h.concat(y)},[]);this.state.meta.isValidating||this.setMeta(h=>({...h,isValidating:!0}));for(const h of a)h.setMeta(m=>({...m,isValidating:!0}));const l=[],c=[],u=(h,m,y)=>{const b=hC(m.cause),v=h.getInfo().validationMetaMap[b];v==null||v.lastAbortController.abort();const x=new AbortController;this.getInfo().validationMetaMap[b]={lastAbortController:x},y.push(new Promise(async w=>{var _;let k;try{k=await new Promise((I,j)=>{this.timeoutIds.validations[m.cause]&&clearTimeout(this.timeoutIds.validations[m.cause]),this.timeoutIds.validations[m.cause]=setTimeout(async()=>{if(x.signal.aborted)return I(void 0);try{I(await this.runValidator({validate:m.validate,value:{value:h.store.state.value,fieldApi:h,signal:x.signal,validationSource:"field"},type:"validateAsync"}))}catch(L){j(L)}},m.debounceMs)})}catch(I){k=I}if(x.signal.aborted)return w(void 0);const C=z7(k),T=(_=i[this.name])==null?void 0:_[b],{newErrorValue:A,newSource:N}=B7({formLevelError:T,fieldLevelError:C});h.setMeta(I=>({...I,errorMap:{...I==null?void 0:I.errorMap,[b]:A},errorSourceMap:{...I.errorSourceMap,[b]:N}})),w(A)}))};for(const h of s)h.validate&&u(this,h,l);for(const h of o)h.validate&&u(h.field,h,c);let d=[];(l.length||c.length)&&(d=await Promise.all(l),await Promise.all(c)),this.setMeta(h=>({...h,isValidating:!1}));for(const h of a)h.setMeta(m=>({...m,isValidating:!1}));return d.filter(Boolean)},this.validate=(n,r)=>{var s;if(!this.state.meta.isTouched)return[];const{fieldsErrorMap:i}=r!=null&&r.skipFormValidation?{fieldsErrorMap:{}}:this.form.validateSync(n),{hasErrored:a}=this.validateSync(n,i[this.name]??{});if(a&&!this.options.asyncAlways)return(s=this.getInfo().validationMetaMap[hC(n)])==null||s.lastAbortController.abort(),this.state.meta.errors;const o=r!=null&&r.skipFormValidation?Promise.resolve({}):this.form.validateAsync(n);return this.validateAsync(n,o)},this.handleChange=n=>{this.setValue(n)},this.handleBlur=()=>{this.state.meta.isTouched||(this.setMeta(r=>({...r,isTouched:!0})),this.validate("change")),this.state.meta.isBlurred||this.setMeta(r=>({...r,isBlurred:!0})),this.validate("blur"),this.triggerOnBlurListener()},this.parseValueWithSchema=n=>K0.validate({value:this.state.value,validationSource:"field"},n),this.parseValueWithSchemaAsync=n=>K0.validateAsync({value:this.state.value,validationSource:"field"},n),this.form=t.form,this.name=t.name,this.timeoutIds={validations:{},listeners:{},formListeners:{}},this.store=new ef({deps:[this.form.store],fn:()=>{const n=this.form.getFieldValue(this.name),r=this.form.getFieldMeta(this.name)??{...Rk,...t.defaultMeta};return{value:n,meta:r}}}),this.options=t}get state(){return this.store.state}runValidator(t){return dQ(t.validate)?K0[t.type](t.value,t.validate):t.validate(t.value)}setErrorMap(t){this.setMeta(n=>({...n,errorMap:{...n.errorMap,...t}}))}triggerOnBlurListener(){var t,n,r,s,i,a;const o=(t=this.form.options.listeners)==null?void 0:t.onBlurDebounceMs;o&&o>0?(this.timeoutIds.formListeners.blur&&clearTimeout(this.timeoutIds.formListeners.blur),this.timeoutIds.formListeners.blur=setTimeout(()=>{var c,u;(u=(c=this.form.options.listeners)==null?void 0:c.onBlur)==null||u.call(c,{formApi:this.form,fieldApi:this})},o)):(r=(n=this.form.options.listeners)==null?void 0:n.onBlur)==null||r.call(n,{formApi:this.form,fieldApi:this});const l=(s=this.options.listeners)==null?void 0:s.onBlurDebounceMs;l&&l>0?(this.timeoutIds.listeners.blur&&clearTimeout(this.timeoutIds.listeners.blur),this.timeoutIds.listeners.blur=setTimeout(()=>{var c,u;(u=(c=this.options.listeners)==null?void 0:c.onBlur)==null||u.call(c,{value:this.state.value,fieldApi:this})},l)):(a=(i=this.options.listeners)==null?void 0:i.onBlur)==null||a.call(i,{value:this.state.value,fieldApi:this})}triggerOnChangeListener(){var t,n,r,s,i,a;const o=(t=this.form.options.listeners)==null?void 0:t.onChangeDebounceMs;o&&o>0?(this.timeoutIds.formListeners.blur&&clearTimeout(this.timeoutIds.formListeners.blur),this.timeoutIds.formListeners.blur=setTimeout(()=>{var c,u;(u=(c=this.form.options.listeners)==null?void 0:c.onChange)==null||u.call(c,{formApi:this.form,fieldApi:this})},o)):(r=(n=this.form.options.listeners)==null?void 0:n.onChange)==null||r.call(n,{formApi:this.form,fieldApi:this});const l=(s=this.options.listeners)==null?void 0:s.onChangeDebounceMs;l&&l>0?(this.timeoutIds.listeners.change&&clearTimeout(this.timeoutIds.listeners.change),this.timeoutIds.listeners.change=setTimeout(()=>{var c,u;(u=(c=this.options.listeners)==null?void 0:c.onChange)==null||u.call(c,{value:this.state.value,fieldApi:this})},l)):(a=(i=this.options.listeners)==null?void 0:i.onChange)==null||a.call(i,{value:this.state.value,fieldApi:this})}}function z7(e){if(e)return e}function hC(e){switch(e){case"submit":return"onSubmit";case"blur":return"onBlur";case"mount":return"onMount";case"server":return"onServer";case"change":default:return"onChange"}}var UM={exports:{}},qM={},VM={exports:{}},WM={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var U7;function bOe(){if(U7)return WM;U7=1;var e=Zy();function t(d,h){return d===h&&(d!==0||1/d===1/h)||d!==d&&h!==h}var n=typeof Object.is=="function"?Object.is:t,r=e.useState,s=e.useEffect,i=e.useLayoutEffect,a=e.useDebugValue;function o(d,h){var m=h(),y=r({inst:{value:m,getSnapshot:h}}),b=y[0].inst,v=y[1];return i(function(){b.value=m,b.getSnapshot=h,l(b)&&v({inst:b})},[d,m,h]),s(function(){return l(b)&&v({inst:b}),d(function(){l(b)&&v({inst:b})})},[d]),a(m),m}function l(d){var h=d.getSnapshot;d=d.value;try{var m=h();return!n(d,m)}catch{return!0}}function c(d,h){return h()}var u=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?c:o;return WM.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:u,WM}var q7;function vOe(){return q7||(q7=1,VM.exports=bOe()),VM.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var V7;function xOe(){if(V7)return qM;V7=1;var e=Zy(),t=vOe();function n(c,u){return c===u&&(c!==0||1/c===1/u)||c!==c&&u!==u}var r=typeof Object.is=="function"?Object.is:n,s=t.useSyncExternalStore,i=e.useRef,a=e.useEffect,o=e.useMemo,l=e.useDebugValue;return qM.useSyncExternalStoreWithSelector=function(c,u,d,h,m){var y=i(null);if(y.current===null){var b={hasValue:!1,value:null};y.current=b}else b=y.current;y=o(function(){function x(T){if(!w){if(w=!0,_=T,T=h(T),m!==void 0&&b.hasValue){var A=b.value;if(m(A,T))return k=A}return k=T}if(A=k,r(_,T))return A;var N=h(T);return m!==void 0&&m(A,N)?(_=T,A):(_=T,k=N)}var w=!1,_,k,C=d===void 0?null:d;return[function(){return x(u())},C===null?void 0:function(){return x(C())}]},[u,d,h,m]);var v=s(c,y[0],y[1]);return a(function(){b.hasValue=!0,b.value=v},[v]),l(v),v},qM}var W7;function wOe(){return W7||(W7=1,UM.exports=xOe()),UM.exports}var SOe=wOe();function sF(e,t=n=>n){return SOe.useSyncExternalStoreWithSelector(e.subscribe,()=>e.state,()=>e.state,t,_Oe)}function _Oe(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[r,s]of e)if(!t.has(r)||!Object.is(s,t.get(r)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const r of e)if(!t.has(r))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(let r=0;r<n.length;r++)if(!Object.prototype.hasOwnProperty.call(t,n[r])||!Object.is(e[n[r]],t[n[r]]))return!1;return!0}const Nk=typeof window<"u"?E.useLayoutEffect:E.useEffect;function COe(e){const[t]=E.useState(()=>{const r=new yOe({...e,form:e.form,name:e.name});return r.Field=fQ,r});return Nk(t.mount,[t]),Nk(()=>{t.update(e)}),sF(t.store,e.mode==="array"?n=>[n.meta,Object.keys(n.value??[]).length]:void 0),t}const fQ=({children:e,...t})=>{const n=COe(t),r=E.useMemo(()=>MT(e,n),[e,n,n.state.value,n.state.meta]);return f.jsx(f.Fragment,{children:r})};function kOe({form:e,selector:t,children:n}){const r=sF(e.store,t);return MT(n,r)}function ai(e){const[t]=E.useState(()=>{const n=new gOe(e),r=n;return r.Field=function(i){return f.jsx(fQ,{...i,form:n})},r.Subscribe=s=>f.jsx(kOe,{form:n,selector:s.selector,children:s.children}),r});return Nk(t.mount,[]),sF(t.store,n=>n.isSubmitting),Nk(()=>{t.update(e)}),t}var iF="Progress",aF=100,[EOe,Mft]=Ei(iF),[TOe,AOe]=EOe(iF),hQ=E.forwardRef((e,t)=>{const{__scopeProgress:n,value:r=null,max:s,getValueLabel:i=ROe,...a}=e;(s||s===0)&&!H7(s)&&console.error(NOe(`${s}`,"Progress"));const o=H7(s)?s:aF;r!==null&&!G7(r,o)&&console.error(IOe(`${r}`,"Progress"));const l=G7(r,o)?r:null,c=Ik(l)?i(l,o):void 0;return f.jsx(TOe,{scope:n,value:l,max:o,children:f.jsx(Kn.div,{"aria-valuemax":o,"aria-valuemin":0,"aria-valuenow":Ik(l)?l:void 0,"aria-valuetext":c,role:"progressbar","data-state":gQ(l,o),"data-value":l??void 0,"data-max":o,...a,ref:t})})});hQ.displayName=iF;var pQ="ProgressIndicator",mQ=E.forwardRef((e,t)=>{const{__scopeProgress:n,...r}=e,s=AOe(pQ,n);return f.jsx(Kn.div,{"data-state":gQ(s.value,s.max),"data-value":s.value??void 0,"data-max":s.max,...r,ref:t})});mQ.displayName=pQ;function ROe(e,t){return`${Math.round(e/t*100)}%`}function gQ(e,t){return e==null?"indeterminate":e===t?"complete":"loading"}function Ik(e){return typeof e=="number"}function H7(e){return Ik(e)&&!isNaN(e)&&e>0}function G7(e,t){return Ik(e)&&!isNaN(e)&&e<=t&&e>=0}function NOe(e,t){return`Invalid prop \`max\` of value \`${e}\` supplied to \`${t}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${aF}\`.`}function IOe(e,t){return`Invalid prop \`value\` of value \`${e}\` supplied to \`${t}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${aF} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var yQ=hQ,MOe=mQ;const Oy=E.forwardRef(({className:e,value:t,...n},r)=>f.jsx(yQ,{ref:r,className:Ye("relative h-4 w-full overflow-hidden rounded-full bg-secondary",e),...n,children:f.jsx(MOe,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(t||0)}%)`}})}));Oy.displayName=yQ.displayName;function vn({className:e,type:t,...n}){return f.jsx("input",{type:t,"data-slot":"input",className:Ye("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",e),...n})}const gx=({fieldApi:e,label:t,description:n,placeholder:r,inputClassName:s,labelClassName:i,wrapperClassName:a,type:o="text"})=>{const{name:l,state:c,handleChange:u,handleBlur:d}=e,h=c.value,m=y=>{u(y.target.value)};return f.jsxs("div",{className:Ye("space-y-1.5",a),children:[t&&f.jsx(Nt,{htmlFor:l,className:Ye("text-sm font-medium",i),children:t}),n&&f.jsx("p",{className:"text-xs text-muted-foreground",children:n}),f.jsx(vn,{id:l,name:l,type:o,value:h==null?"":String(h),onBlur:d,onChange:m,placeholder:r,className:Ye(s,c.meta.errors.length?"border-destructive":""),disabled:e.form.state.isSubmitting}),c.meta.isTouched&&c.meta.errors.length>0&&f.jsx("div",{className:"text-xs text-destructive pt-1",children:c.meta.errors.map((y,b)=>f.jsx("p",{children:typeof y=="string"?y:(y==null?void 0:y.message)||"Invalid"},b))})]})},jOe=({fieldApi:e,label:t,placeholder:n,description:r,rows:s=3,inputClassName:i,labelClassName:a,wrapperClassName:o})=>f.jsxs("div",{className:Ye("space-y-1.5",o),children:[t&&f.jsx(Nt,{htmlFor:e.name,className:Ye("text-sm font-medium",a),children:t}),r&&f.jsx("p",{className:"text-xs text-muted-foreground",children:r}),f.jsx(Ci,{id:e.name,name:e.name,value:e.state.value||"",onBlur:e.handleBlur,onChange:l=>e.handleChange(l.target.value),placeholder:n,rows:s,className:Ye(i,e.state.meta.errors.length?"border-destructive":""),disabled:e.form.state.isSubmitting}),e.state.meta.isTouched&&e.state.meta.errors.length>0&&f.jsx("div",{className:"text-xs text-destructive pt-1",children:e.state.meta.errors.map((l,c)=>f.jsx("p",{children:String(l)},c))})]});function POe(e){const t=e+"CollectionProvider",[n,r]=Ei(t),[s,i]=n(t,{collectionRef:{current:null},itemMap:new Map}),a=b=>{const{scope:v,children:x}=b,w=Ve.useRef(null),_=Ve.useRef(new Map).current;return f.jsx(s,{scope:v,itemMap:_,collectionRef:w,children:x})};a.displayName=t;const o=e+"CollectionSlot",l=$u(o),c=Ve.forwardRef((b,v)=>{const{scope:x,children:w}=b,_=i(o,x),k=Tn(v,_.collectionRef);return f.jsx(l,{ref:k,children:w})});c.displayName=o;const u=e+"CollectionItemSlot",d="data-radix-collection-item",h=$u(u),m=Ve.forwardRef((b,v)=>{const{scope:x,children:w,..._}=b,k=Ve.useRef(null),C=Tn(v,k),T=i(u,x);return Ve.useEffect(()=>(T.itemMap.set(k,{ref:k,..._}),()=>void T.itemMap.delete(k))),f.jsx(h,{[d]:"",ref:C,children:w})});m.displayName=u;function y(b){const v=i(e+"CollectionConsumer",b);return Ve.useCallback(()=>{const w=v.collectionRef.current;if(!w)return[];const _=Array.from(w.querySelectorAll(`[${d}]`));return Array.from(v.itemMap.values()).sort((T,A)=>_.indexOf(T.ref.current)-_.indexOf(A.ref.current))},[v.collectionRef,v.itemMap])}return[{Provider:a,Slot:c,ItemSlot:m},y,r]}var OOe=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Ti=OOe.reduce((e,t)=>{const n=$u(`Primitive.${t}`),r=E.forwardRef((s,i)=>{const{asChild:a,...o}=s,l=a?n:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),f.jsx(l,{...o,ref:i})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{});function DOe(e,t){e&&yl.flushSync(()=>e.dispatchEvent(t))}var FOe="DismissableLayer",uP="dismissableLayer.update",LOe="dismissableLayer.pointerDownOutside",BOe="dismissableLayer.focusOutside",K7,bQ=E.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),vQ=E.forwardRef((e,t)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:s,onFocusOutside:i,onInteractOutside:a,onDismiss:o,...l}=e,c=E.useContext(bQ),[u,d]=E.useState(null),h=(u==null?void 0:u.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,m]=E.useState({}),y=Tn(t,A=>d(A)),b=Array.from(c.layers),[v]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),x=b.indexOf(v),w=u?b.indexOf(u):-1,_=c.layersWithOutsidePointerEventsDisabled.size>0,k=w>=x,C=UOe(A=>{const N=A.target,I=[...c.branches].some(j=>j.contains(N));!k||I||(s==null||s(A),a==null||a(A),A.defaultPrevented||o==null||o())},h),T=qOe(A=>{const N=A.target;[...c.branches].some(j=>j.contains(N))||(i==null||i(A),a==null||a(A),A.defaultPrevented||o==null||o())},h);return gO(A=>{w===c.layers.size-1&&(r==null||r(A),!A.defaultPrevented&&o&&(A.preventDefault(),o()))},h),E.useEffect(()=>{if(u)return n&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(K7=h.body.style.pointerEvents,h.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(u)),c.layers.add(u),Y7(),()=>{n&&c.layersWithOutsidePointerEventsDisabled.size===1&&(h.body.style.pointerEvents=K7)}},[u,h,n,c]),E.useEffect(()=>()=>{u&&(c.layers.delete(u),c.layersWithOutsidePointerEventsDisabled.delete(u),Y7())},[u,c]),E.useEffect(()=>{const A=()=>m({});return document.addEventListener(uP,A),()=>document.removeEventListener(uP,A)},[]),f.jsx(Ti.div,{...l,ref:y,style:{pointerEvents:_?k?"auto":"none":void 0,...e.style},onFocusCapture:Wt(e.onFocusCapture,T.onFocusCapture),onBlurCapture:Wt(e.onBlurCapture,T.onBlurCapture),onPointerDownCapture:Wt(e.onPointerDownCapture,C.onPointerDownCapture)})});vQ.displayName=FOe;var $Oe="DismissableLayerBranch",zOe=E.forwardRef((e,t)=>{const n=E.useContext(bQ),r=E.useRef(null),s=Tn(t,r);return E.useEffect(()=>{const i=r.current;if(i)return n.branches.add(i),()=>{n.branches.delete(i)}},[n.branches]),f.jsx(Ti.div,{...e,ref:s})});zOe.displayName=$Oe;function UOe(e,t=globalThis==null?void 0:globalThis.document){const n=Ts(e),r=E.useRef(!1),s=E.useRef(()=>{});return E.useEffect(()=>{const i=o=>{if(o.target&&!r.current){let l=function(){xQ(LOe,n,c,{discrete:!0})};const c={originalEvent:o};o.pointerType==="touch"?(t.removeEventListener("click",s.current),s.current=l,t.addEventListener("click",s.current,{once:!0})):l()}else t.removeEventListener("click",s.current);r.current=!1},a=window.setTimeout(()=>{t.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(a),t.removeEventListener("pointerdown",i),t.removeEventListener("click",s.current)}},[t,n]),{onPointerDownCapture:()=>r.current=!0}}function qOe(e,t=globalThis==null?void 0:globalThis.document){const n=Ts(e),r=E.useRef(!1);return E.useEffect(()=>{const s=i=>{i.target&&!r.current&&xQ(BOe,n,{originalEvent:i},{discrete:!1})};return t.addEventListener("focusin",s),()=>t.removeEventListener("focusin",s)},[t,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function Y7(){const e=new CustomEvent(uP);document.dispatchEvent(e)}function xQ(e,t,n,{discrete:r}){const s=n.originalEvent.target,i=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&s.addEventListener(e,t,{once:!0}),r?DOe(s,i):s.dispatchEvent(i)}var HM=0;function jT(){E.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??Z7()),document.body.insertAdjacentElement("beforeend",e[1]??Z7()),HM++,()=>{HM===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),HM--}},[])}function Z7(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var GM="focusScope.autoFocusOnMount",KM="focusScope.autoFocusOnUnmount",X7={bubbles:!1,cancelable:!0},VOe="FocusScope",wQ=E.forwardRef((e,t)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:s,onUnmountAutoFocus:i,...a}=e,[o,l]=E.useState(null),c=Ts(s),u=Ts(i),d=E.useRef(null),h=Tn(t,b=>l(b)),m=E.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;E.useEffect(()=>{if(r){let b=function(_){if(m.paused||!o)return;const k=_.target;o.contains(k)?d.current=k:hh(d.current,{select:!0})},v=function(_){if(m.paused||!o)return;const k=_.relatedTarget;k!==null&&(o.contains(k)||hh(d.current,{select:!0}))},x=function(_){if(document.activeElement===document.body)for(const C of _)C.removedNodes.length>0&&hh(o)};document.addEventListener("focusin",b),document.addEventListener("focusout",v);const w=new MutationObserver(x);return o&&w.observe(o,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",b),document.removeEventListener("focusout",v),w.disconnect()}}},[r,o,m.paused]),E.useEffect(()=>{if(o){Q7.add(m);const b=document.activeElement;if(!o.contains(b)){const x=new CustomEvent(GM,X7);o.addEventListener(GM,c),o.dispatchEvent(x),x.defaultPrevented||(WOe(ZOe(SQ(o)),{select:!0}),document.activeElement===b&&hh(o))}return()=>{o.removeEventListener(GM,c),setTimeout(()=>{const x=new CustomEvent(KM,X7);o.addEventListener(KM,u),o.dispatchEvent(x),x.defaultPrevented||hh(b??document.body,{select:!0}),o.removeEventListener(KM,u),Q7.remove(m)},0)}}},[o,c,u,m]);const y=E.useCallback(b=>{if(!n&&!r||m.paused)return;const v=b.key==="Tab"&&!b.altKey&&!b.ctrlKey&&!b.metaKey,x=document.activeElement;if(v&&x){const w=b.currentTarget,[_,k]=HOe(w);_&&k?!b.shiftKey&&x===k?(b.preventDefault(),n&&hh(_,{select:!0})):b.shiftKey&&x===_&&(b.preventDefault(),n&&hh(k,{select:!0})):x===w&&b.preventDefault()}},[n,r,m.paused]);return f.jsx(Ti.div,{tabIndex:-1,...a,ref:h,onKeyDown:y})});wQ.displayName=VOe;function WOe(e,{select:t=!1}={}){const n=document.activeElement;for(const r of e)if(hh(r,{select:t}),document.activeElement!==n)return}function HOe(e){const t=SQ(e),n=J7(t,e),r=J7(t.reverse(),e);return[n,r]}function SQ(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const s=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||s?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function J7(e,t){for(const n of e)if(!GOe(n,{upTo:t}))return n}function GOe(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function KOe(e){return e instanceof HTMLInputElement&&"select"in e}function hh(e,{select:t=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&KOe(e)&&t&&e.select()}}var Q7=YOe();function YOe(){let e=[];return{add(t){const n=e[0];t!==n&&(n==null||n.pause()),e=eU(e,t),e.unshift(t)},remove(t){var n;e=eU(e,t),(n=e[0])==null||n.resume()}}}function eU(e,t){const n=[...e],r=n.indexOf(t);return r!==-1&&n.splice(r,1),n}function ZOe(e){return e.filter(t=>t.tagName!=="A")}var XOe="Arrow",_Q=E.forwardRef((e,t)=>{const{children:n,width:r=10,height:s=5,...i}=e;return f.jsx(Ti.svg,{...i,ref:t,width:r,height:s,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?n:f.jsx("polygon",{points:"0,0 30,0 15,10"})})});_Q.displayName=XOe;var JOe=_Q,oF="Popper",[CQ,kQ]=Ei(oF),[QOe,EQ]=CQ(oF),TQ=e=>{const{__scopePopper:t,children:n}=e,[r,s]=E.useState(null);return f.jsx(QOe,{scope:t,anchor:r,onAnchorChange:s,children:n})};TQ.displayName=oF;var AQ="PopperAnchor",RQ=E.forwardRef((e,t)=>{const{__scopePopper:n,virtualRef:r,...s}=e,i=EQ(AQ,n),a=E.useRef(null),o=Tn(t,a);return E.useEffect(()=>{i.onAnchorChange((r==null?void 0:r.current)||a.current)}),r?null:f.jsx(Ti.div,{...s,ref:o})});RQ.displayName=AQ;var lF="PopperContent",[eDe,tDe]=CQ(lF),NQ=E.forwardRef((e,t)=>{var je,Te,_e,Ue,Qe,We;const{__scopePopper:n,side:r="bottom",sideOffset:s=0,align:i="center",alignOffset:a=0,arrowPadding:o=0,avoidCollisions:l=!0,collisionBoundary:c=[],collisionPadding:u=0,sticky:d="partial",hideWhenDetached:h=!1,updatePositionStrategy:m="optimized",onPlaced:y,...b}=e,v=EQ(lF,n),[x,w]=E.useState(null),_=Tn(t,Pe=>w(Pe)),[k,C]=E.useState(null),T=Zm(k),A=(T==null?void 0:T.width)??0,N=(T==null?void 0:T.height)??0,I=r+(i!=="center"?"-"+i:""),j=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},L=Array.isArray(c)?c:[c],D=L.length>0,H={padding:j,boundary:L.filter(rDe),altBoundary:D},{refs:O,floatingStyles:K,placement:U,isPositioned:W,middlewareData:B}=kO({strategy:"fixed",placement:I,whileElementsMounted:(...Pe)=>CO(...Pe,{animationFrame:m==="always"}),elements:{reference:v.anchor},middleware:[EO({mainAxis:s+N,alignmentAxis:a}),l&&TO({mainAxis:!0,crossAxis:!1,limiter:d==="partial"?AO():void 0,...H}),l&&RO({...H}),NO({...H,apply:({elements:Pe,rects:Y,availableWidth:ye,availableHeight:Me})=>{const{width:ue,height:oe}=Y.reference,se=Pe.floating.style;se.setProperty("--radix-popper-available-width",`${ye}px`),se.setProperty("--radix-popper-available-height",`${Me}px`),se.setProperty("--radix-popper-anchor-width",`${ue}px`),se.setProperty("--radix-popper-anchor-height",`${oe}px`)}}),k&&MO({element:k,padding:o}),sDe({arrowWidth:A,arrowHeight:N}),h&&IO({strategy:"referenceHidden",...H})]}),[ne,V]=jQ(U),Q=Ts(y);ii(()=>{W&&(Q==null||Q())},[W,Q]);const ee=(je=B.arrow)==null?void 0:je.x,re=(Te=B.arrow)==null?void 0:Te.y,de=((_e=B.arrow)==null?void 0:_e.centerOffset)!==0,[me,De]=E.useState();return ii(()=>{x&&De(window.getComputedStyle(x).zIndex)},[x]),f.jsx("div",{ref:O.setFloating,"data-radix-popper-content-wrapper":"",style:{...K,transform:W?K.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:me,"--radix-popper-transform-origin":[(Ue=B.transformOrigin)==null?void 0:Ue.x,(Qe=B.transformOrigin)==null?void 0:Qe.y].join(" "),...((We=B.hide)==null?void 0:We.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:f.jsx(eDe,{scope:n,placedSide:ne,onArrowChange:C,arrowX:ee,arrowY:re,shouldHideArrow:de,children:f.jsx(Ti.div,{"data-side":ne,"data-align":V,...b,ref:_,style:{...b.style,animation:W?void 0:"none"}})})})});NQ.displayName=lF;var IQ="PopperArrow",nDe={top:"bottom",right:"left",bottom:"top",left:"right"},MQ=E.forwardRef(function(t,n){const{__scopePopper:r,...s}=t,i=tDe(IQ,r),a=nDe[i.placedSide];return f.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[a]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:f.jsx(JOe,{...s,ref:n,style:{...s.style,display:"block"}})})});MQ.displayName=IQ;function rDe(e){return e!==null}var sDe=e=>({name:"transformOrigin",options:e,fn(t){var v,x,w;const{placement:n,rects:r,middlewareData:s}=t,a=((v=s.arrow)==null?void 0:v.centerOffset)!==0,o=a?0:e.arrowWidth,l=a?0:e.arrowHeight,[c,u]=jQ(n),d={start:"0%",center:"50%",end:"100%"}[u],h=(((x=s.arrow)==null?void 0:x.x)??0)+o/2,m=(((w=s.arrow)==null?void 0:w.y)??0)+l/2;let y="",b="";return c==="bottom"?(y=a?d:`${h}px`,b=`${-l}px`):c==="top"?(y=a?d:`${h}px`,b=`${r.floating.height+l}px`):c==="right"?(y=`${-l}px`,b=a?d:`${m}px`):c==="left"&&(y=`${r.floating.width+l}px`,b=a?d:`${m}px`),{data:{x:y,y:b}}}});function jQ(e){const[t,n="center"]=e.split("-");return[t,n]}var iDe=TQ,aDe=RQ,oDe=NQ,lDe=MQ,cDe="Portal",PQ=E.forwardRef((e,t)=>{var o;const{container:n,...r}=e,[s,i]=E.useState(!1);ii(()=>i(!0),[]);const a=n||s&&((o=globalThis==null?void 0:globalThis.document)==null?void 0:o.body);return a?PE.createPortal(f.jsx(Ti.div,{...r,ref:t}),a):null});PQ.displayName=cDe;function aS(e){const t=E.useRef({value:e,previous:e});return E.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var OQ=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),uDe="VisuallyHidden",dDe=E.forwardRef((e,t)=>f.jsx(Ti.span,{...e,ref:t,style:{...OQ,...e.style}}));dDe.displayName=uDe;var fDe=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},p0=new WeakMap,pC=new WeakMap,mC={},YM=0,DQ=function(e){return e&&(e.host||DQ(e.parentNode))},hDe=function(e,t){return t.map(function(n){if(e.contains(n))return n;var r=DQ(n);return r&&e.contains(r)?r:(console.error("aria-hidden",n,"in not contained inside",e,". Doing nothing"),null)}).filter(function(n){return!!n})},pDe=function(e,t,n,r){var s=hDe(t,Array.isArray(e)?e:[e]);mC[n]||(mC[n]=new WeakMap);var i=mC[n],a=[],o=new Set,l=new Set(s),c=function(d){!d||o.has(d)||(o.add(d),c(d.parentNode))};s.forEach(c);var u=function(d){!d||l.has(d)||Array.prototype.forEach.call(d.children,function(h){if(o.has(h))u(h);else try{var m=h.getAttribute(r),y=m!==null&&m!=="false",b=(p0.get(h)||0)+1,v=(i.get(h)||0)+1;p0.set(h,b),i.set(h,v),a.push(h),b===1&&y&&pC.set(h,!0),v===1&&h.setAttribute(n,"true"),y||h.setAttribute(r,"true")}catch(x){console.error("aria-hidden: cannot operate on ",h,x)}})};return u(t),o.clear(),YM++,function(){a.forEach(function(d){var h=p0.get(d)-1,m=i.get(d)-1;p0.set(d,h),i.set(d,m),h||(pC.has(d)||d.removeAttribute(r),pC.delete(d)),m||d.removeAttribute(n)}),YM--,YM||(p0=new WeakMap,p0=new WeakMap,pC=new WeakMap,mC={})}},PT=function(e,t,n){n===void 0&&(n="data-aria-hidden");var r=Array.from(Array.isArray(e)?e:[e]),s=fDe(e);return s?(r.push.apply(r,Array.from(s.querySelectorAll("[aria-live]"))),pDe(r,s,n,"aria-hidden")):function(){return null}},Tu=function(){return Tu=Object.assign||function(t){for(var n,r=1,s=arguments.length;r<s;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},Tu.apply(this,arguments)};function FQ(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(e);s<r.length;s++)t.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(n[r[s]]=e[r[s]]);return n}function mDe(e,t,n){if(n||arguments.length===2)for(var r=0,s=t.length,i;r<s;r++)(i||!(r in t))&&(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))}var XC="right-scroll-bar-position",JC="width-before-scroll-bar",gDe="with-scroll-bars-hidden",yDe="--removed-body-scroll-bar-size";function ZM(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function bDe(e,t){var n=E.useState(function(){return{value:e,callback:t,facade:{get current(){return n.value},set current(r){var s=n.value;s!==r&&(n.value=r,n.callback(r,s))}}}})[0];return n.callback=t,n.facade}var vDe=typeof window<"u"?E.useLayoutEffect:E.useEffect,tU=new WeakMap;function xDe(e,t){var n=bDe(null,function(r){return e.forEach(function(s){return ZM(s,r)})});return vDe(function(){var r=tU.get(n);if(r){var s=new Set(r),i=new Set(e),a=n.current;s.forEach(function(o){i.has(o)||ZM(o,null)}),i.forEach(function(o){s.has(o)||ZM(o,a)})}tU.set(n,e)},[e]),n}function wDe(e){return e}function SDe(e,t){t===void 0&&(t=wDe);var n=[],r=!1,s={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:e},useMedium:function(i){var a=t(i,r);return n.push(a),function(){n=n.filter(function(o){return o!==a})}},assignSyncMedium:function(i){for(r=!0;n.length;){var a=n;n=[],a.forEach(i)}n={push:function(o){return i(o)},filter:function(){return n}}},assignMedium:function(i){r=!0;var a=[];if(n.length){var o=n;n=[],o.forEach(i),a=n}var l=function(){var u=a;a=[],u.forEach(i)},c=function(){return Promise.resolve().then(l)};c(),n={push:function(u){a.push(u),c()},filter:function(u){return a=a.filter(u),n}}}};return s}function _De(e){e===void 0&&(e={});var t=SDe(null);return t.options=Tu({async:!0,ssr:!1},e),t}var LQ=function(e){var t=e.sideCar,n=FQ(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=t.read();if(!r)throw new Error("Sidecar medium not found");return E.createElement(r,Tu({},n))};LQ.isSideCarExport=!0;function CDe(e,t){return e.useMedium(t),LQ}var BQ=_De(),XM=function(){},OT=E.forwardRef(function(e,t){var n=E.useRef(null),r=E.useState({onScrollCapture:XM,onWheelCapture:XM,onTouchMoveCapture:XM}),s=r[0],i=r[1],a=e.forwardProps,o=e.children,l=e.className,c=e.removeScrollBar,u=e.enabled,d=e.shards,h=e.sideCar,m=e.noIsolation,y=e.inert,b=e.allowPinchZoom,v=e.as,x=v===void 0?"div":v,w=e.gapMode,_=FQ(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),k=h,C=xDe([n,t]),T=Tu(Tu({},_),s);return E.createElement(E.Fragment,null,u&&E.createElement(k,{sideCar:BQ,removeScrollBar:c,shards:d,noIsolation:m,inert:y,setCallbacks:i,allowPinchZoom:!!b,lockRef:n,gapMode:w}),a?E.cloneElement(E.Children.only(o),Tu(Tu({},T),{ref:C})):E.createElement(x,Tu({},T,{className:l,ref:C}),o))});OT.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};OT.classNames={fullWidth:JC,zeroRight:XC};var kDe=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function EDe(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=kDe();return t&&e.setAttribute("nonce",t),e}function TDe(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function ADe(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var RDe=function(){var e=0,t=null;return{add:function(n){e==0&&(t=EDe())&&(TDe(t,n),ADe(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},NDe=function(){var e=RDe();return function(t,n){E.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&n])}},$Q=function(){var e=NDe(),t=function(n){var r=n.styles,s=n.dynamic;return e(r,s),null};return t},IDe={left:0,top:0,right:0,gap:0},JM=function(e){return parseInt(e||"",10)||0},MDe=function(e){var t=window.getComputedStyle(document.body),n=t[e==="padding"?"paddingLeft":"marginLeft"],r=t[e==="padding"?"paddingTop":"marginTop"],s=t[e==="padding"?"paddingRight":"marginRight"];return[JM(n),JM(r),JM(s)]},jDe=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return IDe;var t=MDe(e),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,r-n+t[2]-t[0])}},PDe=$Q(),Y0="data-scroll-locked",ODe=function(e,t,n,r){var s=e.left,i=e.top,a=e.right,o=e.gap;return n===void 0&&(n="margin"),`
  .`.concat(gDe,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(o,"px ").concat(r,`;
  }
  body[`).concat(Y0,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(r,";"),n==="margin"&&`
    padding-left: `.concat(s,`px;
    padding-top: `).concat(i,`px;
    padding-right: `).concat(a,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(o,"px ").concat(r,`;
    `),n==="padding"&&"padding-right: ".concat(o,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(XC,` {
    right: `).concat(o,"px ").concat(r,`;
  }
  
  .`).concat(JC,` {
    margin-right: `).concat(o,"px ").concat(r,`;
  }
  
  .`).concat(XC," .").concat(XC,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(JC," .").concat(JC,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(Y0,`] {
    `).concat(yDe,": ").concat(o,`px;
  }
`)},nU=function(){var e=parseInt(document.body.getAttribute(Y0)||"0",10);return isFinite(e)?e:0},DDe=function(){E.useEffect(function(){return document.body.setAttribute(Y0,(nU()+1).toString()),function(){var e=nU()-1;e<=0?document.body.removeAttribute(Y0):document.body.setAttribute(Y0,e.toString())}},[])},FDe=function(e){var t=e.noRelative,n=e.noImportant,r=e.gapMode,s=r===void 0?"margin":r;DDe();var i=E.useMemo(function(){return jDe(s)},[s]);return E.createElement(PDe,{styles:ODe(i,!t,s,n?"":"!important")})},dP=!1;if(typeof window<"u")try{var gC=Object.defineProperty({},"passive",{get:function(){return dP=!0,!0}});window.addEventListener("test",gC,gC),window.removeEventListener("test",gC,gC)}catch{dP=!1}var m0=dP?{passive:!1}:!1,LDe=function(e){return e.tagName==="TEXTAREA"},zQ=function(e,t){if(!(e instanceof Element))return!1;var n=window.getComputedStyle(e);return n[t]!=="hidden"&&!(n.overflowY===n.overflowX&&!LDe(e)&&n[t]==="visible")},BDe=function(e){return zQ(e,"overflowY")},$De=function(e){return zQ(e,"overflowX")},rU=function(e,t){var n=t.ownerDocument,r=t;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var s=UQ(e,r);if(s){var i=qQ(e,r),a=i[1],o=i[2];if(a>o)return!0}r=r.parentNode}while(r&&r!==n.body);return!1},zDe=function(e){var t=e.scrollTop,n=e.scrollHeight,r=e.clientHeight;return[t,n,r]},UDe=function(e){var t=e.scrollLeft,n=e.scrollWidth,r=e.clientWidth;return[t,n,r]},UQ=function(e,t){return e==="v"?BDe(t):$De(t)},qQ=function(e,t){return e==="v"?zDe(t):UDe(t)},qDe=function(e,t){return e==="h"&&t==="rtl"?-1:1},VDe=function(e,t,n,r,s){var i=qDe(e,window.getComputedStyle(t).direction),a=i*r,o=n.target,l=t.contains(o),c=!1,u=a>0,d=0,h=0;do{var m=qQ(e,o),y=m[0],b=m[1],v=m[2],x=b-v-i*y;(y||x)&&UQ(e,o)&&(d+=x,h+=y),o instanceof ShadowRoot?o=o.host:o=o.parentNode}while(!l&&o!==document.body||l&&(t.contains(o)||t===o));return(u&&Math.abs(d)<1||!u&&Math.abs(h)<1)&&(c=!0),c},yC=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},sU=function(e){return[e.deltaX,e.deltaY]},iU=function(e){return e&&"current"in e?e.current:e},WDe=function(e,t){return e[0]===t[0]&&e[1]===t[1]},HDe=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},GDe=0,g0=[];function KDe(e){var t=E.useRef([]),n=E.useRef([0,0]),r=E.useRef(),s=E.useState(GDe++)[0],i=E.useState($Q)[0],a=E.useRef(e);E.useEffect(function(){a.current=e},[e]),E.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(s));var b=mDe([e.lockRef.current],(e.shards||[]).map(iU),!0).filter(Boolean);return b.forEach(function(v){return v.classList.add("allow-interactivity-".concat(s))}),function(){document.body.classList.remove("block-interactivity-".concat(s)),b.forEach(function(v){return v.classList.remove("allow-interactivity-".concat(s))})}}},[e.inert,e.lockRef.current,e.shards]);var o=E.useCallback(function(b,v){if("touches"in b&&b.touches.length===2||b.type==="wheel"&&b.ctrlKey)return!a.current.allowPinchZoom;var x=yC(b),w=n.current,_="deltaX"in b?b.deltaX:w[0]-x[0],k="deltaY"in b?b.deltaY:w[1]-x[1],C,T=b.target,A=Math.abs(_)>Math.abs(k)?"h":"v";if("touches"in b&&A==="h"&&T.type==="range")return!1;var N=rU(A,T);if(!N)return!0;if(N?C=A:(C=A==="v"?"h":"v",N=rU(A,T)),!N)return!1;if(!r.current&&"changedTouches"in b&&(_||k)&&(r.current=C),!C)return!0;var I=r.current||C;return VDe(I,v,b,I==="h"?_:k)},[]),l=E.useCallback(function(b){var v=b;if(!(!g0.length||g0[g0.length-1]!==i)){var x="deltaY"in v?sU(v):yC(v),w=t.current.filter(function(C){return C.name===v.type&&(C.target===v.target||v.target===C.shadowParent)&&WDe(C.delta,x)})[0];if(w&&w.should){v.cancelable&&v.preventDefault();return}if(!w){var _=(a.current.shards||[]).map(iU).filter(Boolean).filter(function(C){return C.contains(v.target)}),k=_.length>0?o(v,_[0]):!a.current.noIsolation;k&&v.cancelable&&v.preventDefault()}}},[]),c=E.useCallback(function(b,v,x,w){var _={name:b,delta:v,target:x,should:w,shadowParent:YDe(x)};t.current.push(_),setTimeout(function(){t.current=t.current.filter(function(k){return k!==_})},1)},[]),u=E.useCallback(function(b){n.current=yC(b),r.current=void 0},[]),d=E.useCallback(function(b){c(b.type,sU(b),b.target,o(b,e.lockRef.current))},[]),h=E.useCallback(function(b){c(b.type,yC(b),b.target,o(b,e.lockRef.current))},[]);E.useEffect(function(){return g0.push(i),e.setCallbacks({onScrollCapture:d,onWheelCapture:d,onTouchMoveCapture:h}),document.addEventListener("wheel",l,m0),document.addEventListener("touchmove",l,m0),document.addEventListener("touchstart",u,m0),function(){g0=g0.filter(function(b){return b!==i}),document.removeEventListener("wheel",l,m0),document.removeEventListener("touchmove",l,m0),document.removeEventListener("touchstart",u,m0)}},[]);var m=e.removeScrollBar,y=e.inert;return E.createElement(E.Fragment,null,y?E.createElement(i,{styles:HDe(s)}):null,m?E.createElement(FDe,{gapMode:e.gapMode}):null)}function YDe(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const ZDe=CDe(BQ,KDe);var oS=E.forwardRef(function(e,t){return E.createElement(OT,Tu({},e,{ref:t,sideCar:ZDe}))});oS.classNames=OT.classNames;var XDe=[" ","Enter","ArrowUp","ArrowDown"],JDe=[" ","Enter"],Lm="Select",[DT,FT,QDe]=POe(Lm),[wb,jft]=Ei(Lm,[QDe,kQ]),LT=kQ(),[eFe,pp]=wb(Lm),[tFe,nFe]=wb(Lm),VQ=e=>{const{__scopeSelect:t,children:n,open:r,defaultOpen:s,onOpenChange:i,value:a,defaultValue:o,onValueChange:l,dir:c,name:u,autoComplete:d,disabled:h,required:m,form:y}=e,b=LT(t),[v,x]=E.useState(null),[w,_]=E.useState(null),[k,C]=E.useState(!1),T=cg(c),[A,N]=rc({prop:r,defaultProp:s??!1,onChange:i,caller:Lm}),[I,j]=rc({prop:a,defaultProp:o,onChange:l,caller:Lm}),L=E.useRef(null),D=v?y||!!v.closest("form"):!0,[H,O]=E.useState(new Set),K=Array.from(H).map(U=>U.props.value).join(";");return f.jsx(iDe,{...b,children:f.jsxs(eFe,{required:m,scope:t,trigger:v,onTriggerChange:x,valueNode:w,onValueNodeChange:_,valueNodeHasChildren:k,onValueNodeHasChildrenChange:C,contentId:pa(),value:I,onValueChange:j,open:A,onOpenChange:N,dir:T,triggerPointerDownPosRef:L,disabled:h,children:[f.jsx(DT.Provider,{scope:t,children:f.jsx(tFe,{scope:e.__scopeSelect,onNativeOptionAdd:E.useCallback(U=>{O(W=>new Set(W).add(U))},[]),onNativeOptionRemove:E.useCallback(U=>{O(W=>{const B=new Set(W);return B.delete(U),B})},[]),children:n})}),D?f.jsxs(fee,{"aria-hidden":!0,required:m,tabIndex:-1,name:u,autoComplete:d,value:I,onChange:U=>j(U.target.value),disabled:h,form:y,children:[I===void 0?f.jsx("option",{value:""}):null,Array.from(H)]},K):null]})})};VQ.displayName=Lm;var WQ="SelectTrigger",HQ=E.forwardRef((e,t)=>{const{__scopeSelect:n,disabled:r=!1,...s}=e,i=LT(n),a=pp(WQ,n),o=a.disabled||r,l=Tn(t,a.onTriggerChange),c=FT(n),u=E.useRef("touch"),[d,h,m]=pee(b=>{const v=c().filter(_=>!_.disabled),x=v.find(_=>_.value===a.value),w=mee(v,b,x);w!==void 0&&a.onValueChange(w.value)}),y=b=>{o||(a.onOpenChange(!0),m()),b&&(a.triggerPointerDownPosRef.current={x:Math.round(b.pageX),y:Math.round(b.pageY)})};return f.jsx(aDe,{asChild:!0,...i,children:f.jsx(Ti.button,{type:"button",role:"combobox","aria-controls":a.contentId,"aria-expanded":a.open,"aria-required":a.required,"aria-autocomplete":"none",dir:a.dir,"data-state":a.open?"open":"closed",disabled:o,"data-disabled":o?"":void 0,"data-placeholder":hee(a.value)?"":void 0,...s,ref:l,onClick:Wt(s.onClick,b=>{b.currentTarget.focus(),u.current!=="mouse"&&y(b)}),onPointerDown:Wt(s.onPointerDown,b=>{u.current=b.pointerType;const v=b.target;v.hasPointerCapture(b.pointerId)&&v.releasePointerCapture(b.pointerId),b.button===0&&b.ctrlKey===!1&&b.pointerType==="mouse"&&(y(b),b.preventDefault())}),onKeyDown:Wt(s.onKeyDown,b=>{const v=d.current!=="";!(b.ctrlKey||b.altKey||b.metaKey)&&b.key.length===1&&h(b.key),!(v&&b.key===" ")&&XDe.includes(b.key)&&(y(),b.preventDefault())})})})});HQ.displayName=WQ;var GQ="SelectValue",KQ=E.forwardRef((e,t)=>{const{__scopeSelect:n,className:r,style:s,children:i,placeholder:a="",...o}=e,l=pp(GQ,n),{onValueNodeHasChildrenChange:c}=l,u=i!==void 0,d=Tn(t,l.onValueNodeChange);return ii(()=>{c(u)},[c,u]),f.jsx(Ti.span,{...o,ref:d,style:{pointerEvents:"none"},children:hee(l.value)?f.jsx(f.Fragment,{children:a}):i})});KQ.displayName=GQ;var rFe="SelectIcon",YQ=E.forwardRef((e,t)=>{const{__scopeSelect:n,children:r,...s}=e;return f.jsx(Ti.span,{"aria-hidden":!0,...s,ref:t,children:r||"▼"})});YQ.displayName=rFe;var sFe="SelectPortal",ZQ=e=>f.jsx(PQ,{asChild:!0,...e});ZQ.displayName=sFe;var Bm="SelectContent",XQ=E.forwardRef((e,t)=>{const n=pp(Bm,e.__scopeSelect),[r,s]=E.useState();if(ii(()=>{s(new DocumentFragment)},[]),!n.open){const i=r;return i?yl.createPortal(f.jsx(JQ,{scope:e.__scopeSelect,children:f.jsx(DT.Slot,{scope:e.__scopeSelect,children:f.jsx("div",{children:e.children})})}),i):null}return f.jsx(QQ,{...e,ref:t})});XQ.displayName=Bm;var Tc=10,[JQ,mp]=wb(Bm),iFe="SelectContentImpl",aFe=$u("SelectContent.RemoveScroll"),QQ=E.forwardRef((e,t)=>{const{__scopeSelect:n,position:r="item-aligned",onCloseAutoFocus:s,onEscapeKeyDown:i,onPointerDownOutside:a,side:o,sideOffset:l,align:c,alignOffset:u,arrowPadding:d,collisionBoundary:h,collisionPadding:m,sticky:y,hideWhenDetached:b,avoidCollisions:v,...x}=e,w=pp(Bm,n),[_,k]=E.useState(null),[C,T]=E.useState(null),A=Tn(t,je=>k(je)),[N,I]=E.useState(null),[j,L]=E.useState(null),D=FT(n),[H,O]=E.useState(!1),K=E.useRef(!1);E.useEffect(()=>{if(_)return PT(_)},[_]),jT();const U=E.useCallback(je=>{const[Te,..._e]=D().map(We=>We.ref.current),[Ue]=_e.slice(-1),Qe=document.activeElement;for(const We of je)if(We===Qe||(We==null||We.scrollIntoView({block:"nearest"}),We===Te&&C&&(C.scrollTop=0),We===Ue&&C&&(C.scrollTop=C.scrollHeight),We==null||We.focus(),document.activeElement!==Qe))return},[D,C]),W=E.useCallback(()=>U([N,_]),[U,N,_]);E.useEffect(()=>{H&&W()},[H,W]);const{onOpenChange:B,triggerPointerDownPosRef:ne}=w;E.useEffect(()=>{if(_){let je={x:0,y:0};const Te=Ue=>{var Qe,We;je={x:Math.abs(Math.round(Ue.pageX)-(((Qe=ne.current)==null?void 0:Qe.x)??0)),y:Math.abs(Math.round(Ue.pageY)-(((We=ne.current)==null?void 0:We.y)??0))}},_e=Ue=>{je.x<=10&&je.y<=10?Ue.preventDefault():_.contains(Ue.target)||B(!1),document.removeEventListener("pointermove",Te),ne.current=null};return ne.current!==null&&(document.addEventListener("pointermove",Te),document.addEventListener("pointerup",_e,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",Te),document.removeEventListener("pointerup",_e,{capture:!0})}}},[_,B,ne]),E.useEffect(()=>{const je=()=>B(!1);return window.addEventListener("blur",je),window.addEventListener("resize",je),()=>{window.removeEventListener("blur",je),window.removeEventListener("resize",je)}},[B]);const[V,Q]=pee(je=>{const Te=D().filter(Qe=>!Qe.disabled),_e=Te.find(Qe=>Qe.ref.current===document.activeElement),Ue=mee(Te,je,_e);Ue&&setTimeout(()=>Ue.ref.current.focus())}),ee=E.useCallback((je,Te,_e)=>{const Ue=!K.current&&!_e;(w.value!==void 0&&w.value===Te||Ue)&&(I(je),Ue&&(K.current=!0))},[w.value]),re=E.useCallback(()=>_==null?void 0:_.focus(),[_]),de=E.useCallback((je,Te,_e)=>{const Ue=!K.current&&!_e;(w.value!==void 0&&w.value===Te||Ue)&&L(je)},[w.value]),me=r==="popper"?fP:eee,De=me===fP?{side:o,sideOffset:l,align:c,alignOffset:u,arrowPadding:d,collisionBoundary:h,collisionPadding:m,sticky:y,hideWhenDetached:b,avoidCollisions:v}:{};return f.jsx(JQ,{scope:n,content:_,viewport:C,onViewportChange:T,itemRefCallback:ee,selectedItem:N,onItemLeave:re,itemTextRefCallback:de,focusSelectedItem:W,selectedItemText:j,position:r,isPositioned:H,searchRef:V,children:f.jsx(oS,{as:aFe,allowPinchZoom:!0,children:f.jsx(wQ,{asChild:!0,trapped:w.open,onMountAutoFocus:je=>{je.preventDefault()},onUnmountAutoFocus:Wt(s,je=>{var Te;(Te=w.trigger)==null||Te.focus({preventScroll:!0}),je.preventDefault()}),children:f.jsx(vQ,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:i,onPointerDownOutside:a,onFocusOutside:je=>je.preventDefault(),onDismiss:()=>w.onOpenChange(!1),children:f.jsx(me,{role:"listbox",id:w.contentId,"data-state":w.open?"open":"closed",dir:w.dir,onContextMenu:je=>je.preventDefault(),...x,...De,onPlaced:()=>O(!0),ref:A,style:{display:"flex",flexDirection:"column",outline:"none",...x.style},onKeyDown:Wt(x.onKeyDown,je=>{const Te=je.ctrlKey||je.altKey||je.metaKey;if(je.key==="Tab"&&je.preventDefault(),!Te&&je.key.length===1&&Q(je.key),["ArrowUp","ArrowDown","Home","End"].includes(je.key)){let Ue=D().filter(Qe=>!Qe.disabled).map(Qe=>Qe.ref.current);if(["ArrowUp","End"].includes(je.key)&&(Ue=Ue.slice().reverse()),["ArrowUp","ArrowDown"].includes(je.key)){const Qe=je.target,We=Ue.indexOf(Qe);Ue=Ue.slice(We+1)}setTimeout(()=>U(Ue)),je.preventDefault()}})})})})})})});QQ.displayName=iFe;var oFe="SelectItemAlignedPosition",eee=E.forwardRef((e,t)=>{const{__scopeSelect:n,onPlaced:r,...s}=e,i=pp(Bm,n),a=mp(Bm,n),[o,l]=E.useState(null),[c,u]=E.useState(null),d=Tn(t,A=>u(A)),h=FT(n),m=E.useRef(!1),y=E.useRef(!0),{viewport:b,selectedItem:v,selectedItemText:x,focusSelectedItem:w}=a,_=E.useCallback(()=>{if(i.trigger&&i.valueNode&&o&&c&&b&&v&&x){const A=i.trigger.getBoundingClientRect(),N=c.getBoundingClientRect(),I=i.valueNode.getBoundingClientRect(),j=x.getBoundingClientRect();if(i.dir!=="rtl"){const Qe=j.left-N.left,We=I.left-Qe,Pe=A.left-We,Y=A.width+Pe,ye=Math.max(Y,N.width),Me=window.innerWidth-Tc,ue=Kw(We,[Tc,Math.max(Tc,Me-ye)]);o.style.minWidth=Y+"px",o.style.left=ue+"px"}else{const Qe=N.right-j.right,We=window.innerWidth-I.right-Qe,Pe=window.innerWidth-A.right-We,Y=A.width+Pe,ye=Math.max(Y,N.width),Me=window.innerWidth-Tc,ue=Kw(We,[Tc,Math.max(Tc,Me-ye)]);o.style.minWidth=Y+"px",o.style.right=ue+"px"}const L=h(),D=window.innerHeight-Tc*2,H=b.scrollHeight,O=window.getComputedStyle(c),K=parseInt(O.borderTopWidth,10),U=parseInt(O.paddingTop,10),W=parseInt(O.borderBottomWidth,10),B=parseInt(O.paddingBottom,10),ne=K+U+H+B+W,V=Math.min(v.offsetHeight*5,ne),Q=window.getComputedStyle(b),ee=parseInt(Q.paddingTop,10),re=parseInt(Q.paddingBottom,10),de=A.top+A.height/2-Tc,me=D-de,De=v.offsetHeight/2,je=v.offsetTop+De,Te=K+U+je,_e=ne-Te;if(Te<=de){const Qe=L.length>0&&v===L[L.length-1].ref.current;o.style.bottom="0px";const We=c.clientHeight-b.offsetTop-b.offsetHeight,Pe=Math.max(me,De+(Qe?re:0)+We+W),Y=Te+Pe;o.style.height=Y+"px"}else{const Qe=L.length>0&&v===L[0].ref.current;o.style.top="0px";const Pe=Math.max(de,K+b.offsetTop+(Qe?ee:0)+De)+_e;o.style.height=Pe+"px",b.scrollTop=Te-de+b.offsetTop}o.style.margin=`${Tc}px 0`,o.style.minHeight=V+"px",o.style.maxHeight=D+"px",r==null||r(),requestAnimationFrame(()=>m.current=!0)}},[h,i.trigger,i.valueNode,o,c,b,v,x,i.dir,r]);ii(()=>_(),[_]);const[k,C]=E.useState();ii(()=>{c&&C(window.getComputedStyle(c).zIndex)},[c]);const T=E.useCallback(A=>{A&&y.current===!0&&(_(),w==null||w(),y.current=!1)},[_,w]);return f.jsx(cFe,{scope:n,contentWrapper:o,shouldExpandOnScrollRef:m,onScrollButtonChange:T,children:f.jsx("div",{ref:l,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:k},children:f.jsx(Ti.div,{...s,ref:d,style:{boxSizing:"border-box",maxHeight:"100%",...s.style}})})})});eee.displayName=oFe;var lFe="SelectPopperPosition",fP=E.forwardRef((e,t)=>{const{__scopeSelect:n,align:r="start",collisionPadding:s=Tc,...i}=e,a=LT(n);return f.jsx(oDe,{...a,...i,ref:t,align:r,collisionPadding:s,style:{boxSizing:"border-box",...i.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});fP.displayName=lFe;var[cFe,cF]=wb(Bm,{}),hP="SelectViewport",tee=E.forwardRef((e,t)=>{const{__scopeSelect:n,nonce:r,...s}=e,i=mp(hP,n),a=cF(hP,n),o=Tn(t,i.onViewportChange),l=E.useRef(0);return f.jsxs(f.Fragment,{children:[f.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:r}),f.jsx(DT.Slot,{scope:n,children:f.jsx(Ti.div,{"data-radix-select-viewport":"",role:"presentation",...s,ref:o,style:{position:"relative",flex:1,overflow:"hidden auto",...s.style},onScroll:Wt(s.onScroll,c=>{const u=c.currentTarget,{contentWrapper:d,shouldExpandOnScrollRef:h}=a;if(h!=null&&h.current&&d){const m=Math.abs(l.current-u.scrollTop);if(m>0){const y=window.innerHeight-Tc*2,b=parseFloat(d.style.minHeight),v=parseFloat(d.style.height),x=Math.max(b,v);if(x<y){const w=x+m,_=Math.min(y,w),k=w-_;d.style.height=_+"px",d.style.bottom==="0px"&&(u.scrollTop=k>0?k:0,d.style.justifyContent="flex-end")}}}l.current=u.scrollTop})})})]})});tee.displayName=hP;var nee="SelectGroup",[uFe,dFe]=wb(nee),fFe=E.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,s=pa();return f.jsx(uFe,{scope:n,id:s,children:f.jsx(Ti.div,{role:"group","aria-labelledby":s,...r,ref:t})})});fFe.displayName=nee;var ree="SelectLabel",hFe=E.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,s=dFe(ree,n);return f.jsx(Ti.div,{id:s.id,...r,ref:t})});hFe.displayName=ree;var Mk="SelectItem",[pFe,see]=wb(Mk),iee=E.forwardRef((e,t)=>{const{__scopeSelect:n,value:r,disabled:s=!1,textValue:i,...a}=e,o=pp(Mk,n),l=mp(Mk,n),c=o.value===r,[u,d]=E.useState(i??""),[h,m]=E.useState(!1),y=Tn(t,w=>{var _;return(_=l.itemRefCallback)==null?void 0:_.call(l,w,r,s)}),b=pa(),v=E.useRef("touch"),x=()=>{s||(o.onValueChange(r),o.onOpenChange(!1))};if(r==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return f.jsx(pFe,{scope:n,value:r,disabled:s,textId:b,isSelected:c,onItemTextChange:E.useCallback(w=>{d(_=>_||((w==null?void 0:w.textContent)??"").trim())},[]),children:f.jsx(DT.ItemSlot,{scope:n,value:r,disabled:s,textValue:u,children:f.jsx(Ti.div,{role:"option","aria-labelledby":b,"data-highlighted":h?"":void 0,"aria-selected":c&&h,"data-state":c?"checked":"unchecked","aria-disabled":s||void 0,"data-disabled":s?"":void 0,tabIndex:s?void 0:-1,...a,ref:y,onFocus:Wt(a.onFocus,()=>m(!0)),onBlur:Wt(a.onBlur,()=>m(!1)),onClick:Wt(a.onClick,()=>{v.current!=="mouse"&&x()}),onPointerUp:Wt(a.onPointerUp,()=>{v.current==="mouse"&&x()}),onPointerDown:Wt(a.onPointerDown,w=>{v.current=w.pointerType}),onPointerMove:Wt(a.onPointerMove,w=>{var _;v.current=w.pointerType,s?(_=l.onItemLeave)==null||_.call(l):v.current==="mouse"&&w.currentTarget.focus({preventScroll:!0})}),onPointerLeave:Wt(a.onPointerLeave,w=>{var _;w.currentTarget===document.activeElement&&((_=l.onItemLeave)==null||_.call(l))}),onKeyDown:Wt(a.onKeyDown,w=>{var k;((k=l.searchRef)==null?void 0:k.current)!==""&&w.key===" "||(JDe.includes(w.key)&&x(),w.key===" "&&w.preventDefault())})})})})});iee.displayName=Mk;var yx="SelectItemText",aee=E.forwardRef((e,t)=>{const{__scopeSelect:n,className:r,style:s,...i}=e,a=pp(yx,n),o=mp(yx,n),l=see(yx,n),c=nFe(yx,n),[u,d]=E.useState(null),h=Tn(t,x=>d(x),l.onItemTextChange,x=>{var w;return(w=o.itemTextRefCallback)==null?void 0:w.call(o,x,l.value,l.disabled)}),m=u==null?void 0:u.textContent,y=E.useMemo(()=>f.jsx("option",{value:l.value,disabled:l.disabled,children:m},l.value),[l.disabled,l.value,m]),{onNativeOptionAdd:b,onNativeOptionRemove:v}=c;return ii(()=>(b(y),()=>v(y)),[b,v,y]),f.jsxs(f.Fragment,{children:[f.jsx(Ti.span,{id:l.textId,...i,ref:h}),l.isSelected&&a.valueNode&&!a.valueNodeHasChildren?yl.createPortal(i.children,a.valueNode):null]})});aee.displayName=yx;var oee="SelectItemIndicator",lee=E.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e;return see(oee,n).isSelected?f.jsx(Ti.span,{"aria-hidden":!0,...r,ref:t}):null});lee.displayName=oee;var pP="SelectScrollUpButton",cee=E.forwardRef((e,t)=>{const n=mp(pP,e.__scopeSelect),r=cF(pP,e.__scopeSelect),[s,i]=E.useState(!1),a=Tn(t,r.onScrollButtonChange);return ii(()=>{if(n.viewport&&n.isPositioned){let o=function(){const c=l.scrollTop>0;i(c)};const l=n.viewport;return o(),l.addEventListener("scroll",o),()=>l.removeEventListener("scroll",o)}},[n.viewport,n.isPositioned]),s?f.jsx(dee,{...e,ref:a,onAutoScroll:()=>{const{viewport:o,selectedItem:l}=n;o&&l&&(o.scrollTop=o.scrollTop-l.offsetHeight)}}):null});cee.displayName=pP;var mP="SelectScrollDownButton",uee=E.forwardRef((e,t)=>{const n=mp(mP,e.__scopeSelect),r=cF(mP,e.__scopeSelect),[s,i]=E.useState(!1),a=Tn(t,r.onScrollButtonChange);return ii(()=>{if(n.viewport&&n.isPositioned){let o=function(){const c=l.scrollHeight-l.clientHeight,u=Math.ceil(l.scrollTop)<c;i(u)};const l=n.viewport;return o(),l.addEventListener("scroll",o),()=>l.removeEventListener("scroll",o)}},[n.viewport,n.isPositioned]),s?f.jsx(dee,{...e,ref:a,onAutoScroll:()=>{const{viewport:o,selectedItem:l}=n;o&&l&&(o.scrollTop=o.scrollTop+l.offsetHeight)}}):null});uee.displayName=mP;var dee=E.forwardRef((e,t)=>{const{__scopeSelect:n,onAutoScroll:r,...s}=e,i=mp("SelectScrollButton",n),a=E.useRef(null),o=FT(n),l=E.useCallback(()=>{a.current!==null&&(window.clearInterval(a.current),a.current=null)},[]);return E.useEffect(()=>()=>l(),[l]),ii(()=>{var u;const c=o().find(d=>d.ref.current===document.activeElement);(u=c==null?void 0:c.ref.current)==null||u.scrollIntoView({block:"nearest"})},[o]),f.jsx(Ti.div,{"aria-hidden":!0,...s,ref:t,style:{flexShrink:0,...s.style},onPointerDown:Wt(s.onPointerDown,()=>{a.current===null&&(a.current=window.setInterval(r,50))}),onPointerMove:Wt(s.onPointerMove,()=>{var c;(c=i.onItemLeave)==null||c.call(i),a.current===null&&(a.current=window.setInterval(r,50))}),onPointerLeave:Wt(s.onPointerLeave,()=>{l()})})}),mFe="SelectSeparator",gFe=E.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e;return f.jsx(Ti.div,{"aria-hidden":!0,...r,ref:t})});gFe.displayName=mFe;var gP="SelectArrow",yFe=E.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,s=LT(n),i=pp(gP,n),a=mp(gP,n);return i.open&&a.position==="popper"?f.jsx(lDe,{...s,...r,ref:t}):null});yFe.displayName=gP;var bFe="SelectBubbleInput",fee=E.forwardRef(({__scopeSelect:e,value:t,...n},r)=>{const s=E.useRef(null),i=Tn(r,s),a=aS(t);return E.useEffect(()=>{const o=s.current;if(!o)return;const l=window.HTMLSelectElement.prototype,u=Object.getOwnPropertyDescriptor(l,"value").set;if(a!==t&&u){const d=new Event("change",{bubbles:!0});u.call(o,t),o.dispatchEvent(d)}},[a,t]),f.jsx(Ti.select,{...n,style:{...OQ,...n.style},ref:i,defaultValue:t})});fee.displayName=bFe;function hee(e){return e===""||e===void 0}function pee(e){const t=Ts(e),n=E.useRef(""),r=E.useRef(0),s=E.useCallback(a=>{const o=n.current+a;t(o),function l(c){n.current=c,window.clearTimeout(r.current),c!==""&&(r.current=window.setTimeout(()=>l(""),1e3))}(o)},[t]),i=E.useCallback(()=>{n.current="",window.clearTimeout(r.current)},[]);return E.useEffect(()=>()=>window.clearTimeout(r.current),[]),[n,s,i]}function mee(e,t,n){const s=t.length>1&&Array.from(t).every(c=>c===t[0])?t[0]:t,i=n?e.indexOf(n):-1;let a=vFe(e,Math.max(i,0));s.length===1&&(a=a.filter(c=>c!==n));const l=a.find(c=>c.textValue.toLowerCase().startsWith(s.toLowerCase()));return l!==n?l:void 0}function vFe(e,t){return e.map((n,r)=>e[(t+r)%e.length])}var xFe=VQ,wFe=HQ,SFe=KQ,_Fe=YQ,CFe=ZQ,kFe=XQ,EFe=tee,TFe=iee,AFe=aee,RFe=lee,NFe=cee,IFe=uee;function sc({...e}){return f.jsx(xFe,{"data-slot":"select",...e})}function ic({...e}){return f.jsx(SFe,{"data-slot":"select-value",...e})}function ac({className:e,size:t="default",children:n,...r}){return f.jsxs(wFe,{"data-slot":"select-trigger","data-size":t,className:Ye("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...r,children:[n,f.jsx(_Fe,{asChild:!0,children:f.jsx(uc,{className:"size-4 opacity-50"})})]})}function oc({className:e,children:t,position:n="popper",...r}){return f.jsx(CFe,{children:f.jsxs(kFe,{"data-slot":"select-content",className:Ye("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md",n==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:n,...r,children:[f.jsx(MFe,{}),f.jsx(EFe,{className:Ye("p-1",n==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:t}),f.jsx(jFe,{})]})})}function wi({className:e,children:t,...n}){return f.jsxs(TFe,{"data-slot":"select-item",className:Ye("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",e),...n,children:[f.jsx("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:f.jsx(RFe,{children:f.jsx(bo,{className:"size-4"})})}),f.jsx(AFe,{children:t})]})}function MFe({className:e,...t}){return f.jsx(NFe,{"data-slot":"select-scroll-up-button",className:Ye("flex cursor-default items-center justify-center py-1",e),...t,children:f.jsx(tp,{className:"size-4"})})}function jFe({className:e,...t}){return f.jsx(IFe,{"data-slot":"select-scroll-down-button",className:Ye("flex cursor-default items-center justify-center py-1",e),...t,children:f.jsx(uc,{className:"size-4"})})}const PFe=({fieldApi:e,label:t,placeholder:n,description:r,options:s=[],inputClassName:i,labelClassName:a,wrapperClassName:o})=>f.jsxs("div",{className:Ye("space-y-1.5",o),children:[t&&f.jsx(Nt,{htmlFor:e.name+"-trigger",className:Ye("text-sm font-medium",a),children:t}),r&&f.jsx("p",{className:"text-xs text-muted-foreground",children:r}),f.jsxs(sc,{value:e.state.value||"",onValueChange:l=>e.handleChange(l),disabled:e.form.state.isSubmitting,children:[f.jsx(ac,{id:e.name+"-trigger",onBlur:e.handleBlur,className:Ye(i,e.state.meta.errors.length?"border-destructive":""),children:f.jsx(ic,{placeholder:n||"Select an option"})}),f.jsx(oc,{children:s.map((l,c)=>{const u=typeof l=="string"?l:l.value,d=typeof l=="string"?l:l.label;return f.jsx(wi,{value:u,children:d},u+c)})})]}),e.state.meta.isTouched&&e.state.meta.errors.length>0&&f.jsx("div",{className:"text-xs text-destructive pt-1",children:e.state.meta.errors.map((l,c)=>f.jsx("p",{children:String(l)},c))})]});var OFe=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],uF=OFe.reduce((e,t)=>{const n=$u(`Primitive.${t}`),r=E.forwardRef((s,i)=>{const{asChild:a,...o}=s,l=a?n:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),f.jsx(l,{...o,ref:i})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{}),BT="Checkbox",[DFe,Pft]=Ei(BT),[FFe,dF]=DFe(BT);function LFe(e){const{__scopeCheckbox:t,checked:n,children:r,defaultChecked:s,disabled:i,form:a,name:o,onCheckedChange:l,required:c,value:u="on",internal_do_not_use_render:d}=e,[h,m]=rc({prop:n,defaultProp:s??!1,onChange:l,caller:BT}),[y,b]=E.useState(null),[v,x]=E.useState(null),w=E.useRef(!1),_=y?!!a||!!y.closest("form"):!0,k={checked:h,disabled:i,setChecked:m,control:y,setControl:b,name:o,form:a,value:u,hasConsumerStoppedPropagationRef:w,required:c,defaultChecked:Rh(s)?!1:s,isFormControl:_,bubbleInput:v,setBubbleInput:x};return f.jsx(FFe,{scope:t,...k,children:BFe(d)?d(k):r})}var gee="CheckboxTrigger",yee=E.forwardRef(({__scopeCheckbox:e,onKeyDown:t,onClick:n,...r},s)=>{const{control:i,value:a,disabled:o,checked:l,required:c,setControl:u,setChecked:d,hasConsumerStoppedPropagationRef:h,isFormControl:m,bubbleInput:y}=dF(gee,e),b=Tn(s,u),v=E.useRef(l);return E.useEffect(()=>{const x=i==null?void 0:i.form;if(x){const w=()=>d(v.current);return x.addEventListener("reset",w),()=>x.removeEventListener("reset",w)}},[i,d]),f.jsx(uF.button,{type:"button",role:"checkbox","aria-checked":Rh(l)?"mixed":l,"aria-required":c,"data-state":_ee(l),"data-disabled":o?"":void 0,disabled:o,value:a,...r,ref:b,onKeyDown:Wt(t,x=>{x.key==="Enter"&&x.preventDefault()}),onClick:Wt(n,x=>{d(w=>Rh(w)?!0:!w),y&&m&&(h.current=x.isPropagationStopped(),h.current||x.stopPropagation())})})});yee.displayName=gee;var bee=E.forwardRef((e,t)=>{const{__scopeCheckbox:n,name:r,checked:s,defaultChecked:i,required:a,disabled:o,value:l,onCheckedChange:c,form:u,...d}=e;return f.jsx(LFe,{__scopeCheckbox:n,checked:s,defaultChecked:i,disabled:o,required:a,onCheckedChange:c,name:r,form:u,value:l,internal_do_not_use_render:({isFormControl:h})=>f.jsxs(f.Fragment,{children:[f.jsx(yee,{...d,ref:t,__scopeCheckbox:n}),h&&f.jsx(See,{__scopeCheckbox:n})]})})});bee.displayName=BT;var vee="CheckboxIndicator",xee=E.forwardRef((e,t)=>{const{__scopeCheckbox:n,forceMount:r,...s}=e,i=dF(vee,n);return f.jsx(ea,{present:r||Rh(i.checked)||i.checked===!0,children:f.jsx(uF.span,{"data-state":_ee(i.checked),"data-disabled":i.disabled?"":void 0,...s,ref:t,style:{pointerEvents:"none",...e.style}})})});xee.displayName=vee;var wee="CheckboxBubbleInput",See=E.forwardRef(({__scopeCheckbox:e,...t},n)=>{const{control:r,hasConsumerStoppedPropagationRef:s,checked:i,defaultChecked:a,required:o,disabled:l,name:c,value:u,form:d,bubbleInput:h,setBubbleInput:m}=dF(wee,e),y=Tn(n,m),b=aS(i),v=Zm(r);E.useEffect(()=>{const w=h;if(!w)return;const _=window.HTMLInputElement.prototype,C=Object.getOwnPropertyDescriptor(_,"checked").set,T=!s.current;if(b!==i&&C){const A=new Event("click",{bubbles:T});w.indeterminate=Rh(i),C.call(w,Rh(i)?!1:i),w.dispatchEvent(A)}},[h,b,i,s]);const x=E.useRef(Rh(i)?!1:i);return f.jsx(uF.input,{type:"checkbox","aria-hidden":!0,defaultChecked:a??x.current,required:o,disabled:l,name:c,value:u,form:d,...t,tabIndex:-1,ref:y,style:{...t.style,...v,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});See.displayName=wee;function BFe(e){return typeof e=="function"}function Rh(e){return e==="indeterminate"}function _ee(e){return Rh(e)?"indeterminate":e?"checked":"unchecked"}function Yc({className:e,...t}){return f.jsx(bee,{"data-slot":"checkbox",className:Ye("peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",e),...t,children:f.jsx(xee,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:f.jsx(bo,{className:"size-3.5"})})})}const $Fe=({fieldApi:e,label:t,description:n,labelClassName:r,wrapperClassName:s})=>f.jsxs("div",{className:Ye("space-y-1.5",s),children:[f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(Yc,{id:e.name,checked:!!e.state.value,onCheckedChange:i=>e.handleChange(!!i),onBlur:e.handleBlur,disabled:e.form.state.isSubmitting,"aria-describedby":n?`${e.name}-description`:void 0}),t&&f.jsx(Nt,{htmlFor:e.name,className:Ye("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",r),children:t})]}),n&&f.jsx("p",{id:`${e.name}-description`,className:"text-xs text-muted-foreground",children:n}),e.state.meta.isTouched&&e.state.meta.errors.length>0&&f.jsx("div",{className:"text-xs text-destructive pt-1",children:e.state.meta.errors.map((i,a)=>f.jsx("p",{children:String(i)},a))})]});var zFe=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Cee=zFe.reduce((e,t)=>{const n=$u(`Primitive.${t}`),r=E.forwardRef((s,i)=>{const{asChild:a,...o}=s,l=a?n:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),f.jsx(l,{...o,ref:i})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{}),$T="Switch",[UFe,Oft]=Ei($T),[qFe,VFe]=UFe($T),kee=E.forwardRef((e,t)=>{const{__scopeSwitch:n,name:r,checked:s,defaultChecked:i,required:a,disabled:o,value:l="on",onCheckedChange:c,form:u,...d}=e,[h,m]=E.useState(null),y=Tn(t,_=>m(_)),b=E.useRef(!1),v=h?u||!!h.closest("form"):!0,[x,w]=rc({prop:s,defaultProp:i??!1,onChange:c,caller:$T});return f.jsxs(qFe,{scope:n,checked:x,disabled:o,children:[f.jsx(Cee.button,{type:"button",role:"switch","aria-checked":x,"aria-required":a,"data-state":Ree(x),"data-disabled":o?"":void 0,disabled:o,value:l,...d,ref:y,onClick:Wt(e.onClick,_=>{w(k=>!k),v&&(b.current=_.isPropagationStopped(),b.current||_.stopPropagation())})}),v&&f.jsx(Aee,{control:h,bubbles:!b.current,name:r,value:l,checked:x,required:a,disabled:o,form:u,style:{transform:"translateX(-100%)"}})]})});kee.displayName=$T;var Eee="SwitchThumb",Tee=E.forwardRef((e,t)=>{const{__scopeSwitch:n,...r}=e,s=VFe(Eee,n);return f.jsx(Cee.span,{"data-state":Ree(s.checked),"data-disabled":s.disabled?"":void 0,...r,ref:t})});Tee.displayName=Eee;var WFe="SwitchBubbleInput",Aee=E.forwardRef(({__scopeSwitch:e,control:t,checked:n,bubbles:r=!0,...s},i)=>{const a=E.useRef(null),o=Tn(a,i),l=aS(n),c=Zm(t);return E.useEffect(()=>{const u=a.current;if(!u)return;const d=window.HTMLInputElement.prototype,m=Object.getOwnPropertyDescriptor(d,"checked").set;if(l!==n&&m){const y=new Event("click",{bubbles:r});m.call(u,n),u.dispatchEvent(y)}},[l,n,r]),f.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:n,...s,tabIndex:-1,ref:o,style:{...s.style,...c,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});Aee.displayName=WFe;function Ree(e){return e?"checked":"unchecked"}var HFe=kee,GFe=Tee;function fo({className:e,...t}){return f.jsx(HFe,{"data-slot":"switch",className:Ye("peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",e),...t,children:f.jsx(GFe,{"data-slot":"switch-thumb",className:Ye("bg-background dark:data-[state=unchecked]:bg-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0")})})}const KFe=({fieldApi:e,label:t,description:n,labelClassName:r,wrapperClassName:s})=>f.jsxs("div",{className:Ye("space-y-1.5",s),children:[f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(fo,{id:e.name,checked:!!e.state.value,onCheckedChange:i=>e.handleChange(i),onBlur:e.handleBlur,disabled:e.form.state.isSubmitting,"aria-describedby":n?`${e.name}-description`:void 0}),t&&f.jsx(Nt,{htmlFor:e.name,className:Ye("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",r),children:t})]}),n&&f.jsx("p",{id:`${e.name}-description`,className:"text-xs text-muted-foreground",children:n}),e.state.meta.isTouched&&e.state.meta.errors.length>0&&f.jsx("div",{className:"text-xs text-destructive pt-1",children:e.state.meta.errors.map((i,a)=>f.jsx("p",{children:String(i)},a))})]}),YFe=({fieldApi:e,label:t,description:n,placeholder:r,inputClassName:s,labelClassName:i,wrapperClassName:a,min:o,max:l,step:c})=>{const{name:u,state:d,handleChange:h,handleBlur:m}=e,y=d.value,b=x=>{const w=x.target.value;if(w==="")h(void 0);else{const _=parseFloat(w);h(isNaN(_)?w:_)}};let v="";return(typeof y=="number"||typeof y=="string")&&(v=y),f.jsxs("div",{className:Ye("space-y-1.5",a),children:[t&&f.jsx(Nt,{htmlFor:u,className:Ye("text-sm font-medium",i),children:t}),n&&f.jsx("p",{className:"text-xs text-muted-foreground",children:n}),f.jsx(vn,{id:u,name:u,type:"number",value:v,onBlur:m,onChange:b,placeholder:r,min:o,max:l,step:c,className:Ye(s,d.meta.errors.length?"border-destructive":""),disabled:e.form.state.isSubmitting}),d.meta.isTouched&&d.meta.errors.length>0&&f.jsx("div",{className:"text-xs text-destructive pt-1",children:d.meta.errors.map((x,w)=>f.jsx("p",{children:typeof x=="string"?x:(x==null?void 0:x.message)||"Invalid"},w))})]})},QM={},bx={};function Bx(e,t){try{const r=(QM[e]||(QM[e]=new Intl.DateTimeFormat("en-GB",{timeZone:e,hour:"numeric",timeZoneName:"longOffset"}).format))(t).split("GMT")[1]||"";return r in bx?bx[r]:aU(r,r.split(":"))}catch{if(e in bx)return bx[e];const n=e==null?void 0:e.match(ZFe);return n?aU(e,n.slice(1)):NaN}}const ZFe=/([+-]\d\d):?(\d\d)?/;function aU(e,t){const n=+t[0],r=+(t[1]||0);return bx[e]=n>0?n*60+r:n*60-r}class Mu extends Date{constructor(...t){super(),t.length>1&&typeof t[t.length-1]=="string"&&(this.timeZone=t.pop()),this.internal=new Date,isNaN(Bx(this.timeZone,this))?this.setTime(NaN):t.length?typeof t[0]=="number"&&(t.length===1||t.length===2&&typeof t[1]!="number")?this.setTime(t[0]):typeof t[0]=="string"?this.setTime(+new Date(t[0])):t[0]instanceof Date?this.setTime(+t[0]):(this.setTime(+new Date(...t)),Nee(this),yP(this)):this.setTime(Date.now())}static tz(t,...n){return n.length?new Mu(...n,t):new Mu(Date.now(),t)}withTimeZone(t){return new Mu(+this,t)}getTimezoneOffset(){return-Bx(this.timeZone,this)}setTime(t){return Date.prototype.setTime.apply(this,arguments),yP(this),+this}[Symbol.for("constructDateFrom")](t){return new Mu(+new Date(t),this.timeZone)}}const oU=/^(get|set)(?!UTC)/;Object.getOwnPropertyNames(Date.prototype).forEach(e=>{if(!oU.test(e))return;const t=e.replace(oU,"$1UTC");Mu.prototype[t]&&(e.startsWith("get")?Mu.prototype[e]=function(){return this.internal[t]()}:(Mu.prototype[e]=function(){return Date.prototype[t].apply(this.internal,arguments),XFe(this),+this},Mu.prototype[t]=function(){return Date.prototype[t].apply(this,arguments),yP(this),+this}))});function yP(e){e.internal.setTime(+e),e.internal.setUTCMinutes(e.internal.getUTCMinutes()-e.getTimezoneOffset())}function XFe(e){Date.prototype.setFullYear.call(e,e.internal.getUTCFullYear(),e.internal.getUTCMonth(),e.internal.getUTCDate()),Date.prototype.setHours.call(e,e.internal.getUTCHours(),e.internal.getUTCMinutes(),e.internal.getUTCSeconds(),e.internal.getUTCMilliseconds()),Nee(e)}function Nee(e){const t=Bx(e.timeZone,e),n=new Date(+e);n.setUTCHours(n.getUTCHours()-1);const r=-new Date(+e).getTimezoneOffset(),s=-new Date(+n).getTimezoneOffset(),i=r-s,a=Date.prototype.getHours.apply(e)!==e.internal.getUTCHours();i&&a&&e.internal.setUTCMinutes(e.internal.getUTCMinutes()+i);const o=r-t;o&&Date.prototype.setUTCMinutes.call(e,Date.prototype.getUTCMinutes.call(e)+o);const l=Bx(e.timeZone,e),u=-new Date(+e).getTimezoneOffset()-l,d=l!==t,h=u-o;if(d&&h){Date.prototype.setUTCMinutes.call(e,Date.prototype.getUTCMinutes.call(e)+h);const m=Bx(e.timeZone,e),y=l-m;y&&(e.internal.setUTCMinutes(e.internal.getUTCMinutes()+y),Date.prototype.setUTCMinutes.call(e,Date.prototype.getUTCMinutes.call(e)+y))}}class $a extends Mu{static tz(t,...n){return n.length?new $a(...n,t):new $a(Date.now(),t)}toISOString(){const[t,n,r]=this.tzComponents(),s=`${t}${n}:${r}`;return this.internal.toISOString().slice(0,-1)+s}toString(){return`${this.toDateString()} ${this.toTimeString()}`}toDateString(){const[t,n,r,s]=this.internal.toUTCString().split(" ");return`${t==null?void 0:t.slice(0,-1)} ${r} ${n} ${s}`}toTimeString(){const t=this.internal.toUTCString().split(" ")[4],[n,r,s]=this.tzComponents();return`${t} GMT${n}${r}${s} (${JFe(this.timeZone,this)})`}toLocaleString(t,n){return Date.prototype.toLocaleString.call(this,t,{...n,timeZone:(n==null?void 0:n.timeZone)||this.timeZone})}toLocaleDateString(t,n){return Date.prototype.toLocaleDateString.call(this,t,{...n,timeZone:(n==null?void 0:n.timeZone)||this.timeZone})}toLocaleTimeString(t,n){return Date.prototype.toLocaleTimeString.call(this,t,{...n,timeZone:(n==null?void 0:n.timeZone)||this.timeZone})}tzComponents(){const t=this.getTimezoneOffset(),n=t>0?"-":"+",r=String(Math.floor(Math.abs(t)/60)).padStart(2,"0"),s=String(Math.abs(t)%60).padStart(2,"0");return[n,r,s]}withTimeZone(t){return new $a(+this,t)}[Symbol.for("constructDateFrom")](t){return new $a(+new Date(t),this.timeZone)}}function JFe(e,t){return new Intl.DateTimeFormat("en-GB",{timeZone:e,timeZoneName:"long"}).format(t).slice(12)}var zn;(function(e){e.Root="root",e.Chevron="chevron",e.Day="day",e.DayButton="day_button",e.CaptionLabel="caption_label",e.Dropdowns="dropdowns",e.Dropdown="dropdown",e.DropdownRoot="dropdown_root",e.Footer="footer",e.MonthGrid="month_grid",e.MonthCaption="month_caption",e.MonthsDropdown="months_dropdown",e.Month="month",e.Months="months",e.Nav="nav",e.NextMonthButton="button_next",e.PreviousMonthButton="button_previous",e.Week="week",e.Weeks="weeks",e.Weekday="weekday",e.Weekdays="weekdays",e.WeekNumber="week_number",e.WeekNumberHeader="week_number_header",e.YearsDropdown="years_dropdown"})(zn||(zn={}));var ei;(function(e){e.disabled="disabled",e.hidden="hidden",e.outside="outside",e.focused="focused",e.today="today"})(ei||(ei={}));var Pc;(function(e){e.range_end="range_end",e.range_middle="range_middle",e.range_start="range_start",e.selected="selected"})(Pc||(Pc={}));var hl;(function(e){e.weeks_before_enter="weeks_before_enter",e.weeks_before_exit="weeks_before_exit",e.weeks_after_enter="weeks_after_enter",e.weeks_after_exit="weeks_after_exit",e.caption_after_enter="caption_after_enter",e.caption_after_exit="caption_after_exit",e.caption_before_enter="caption_before_enter",e.caption_before_exit="caption_before_exit"})(hl||(hl={}));const lU=5,QFe=4;function e6e(e,t){const n=t.startOfMonth(e),r=n.getDay()>0?n.getDay():7,s=t.addDays(e,-r+1),i=t.addDays(s,lU*7-1);return t.getMonth(e)===t.getMonth(i)?lU:QFe}function Iee(e,t){const n=t.startOfMonth(e),r=n.getDay();return r===1?n:r===0?t.addDays(n,-1*6):t.addDays(n,-1*(r-1))}function t6e(e,t){const n=Iee(e,t),r=e6e(e,t);return t.addDays(n,r*7-1)}class vf{constructor(t,n){this.Date=Date,this.today=()=>{var r;return(r=this.overrides)!=null&&r.today?this.overrides.today():this.options.timeZone?$a.tz(this.options.timeZone):new this.Date},this.newDate=(r,s,i)=>{var a;return(a=this.overrides)!=null&&a.newDate?this.overrides.newDate(r,s,i):this.options.timeZone?new $a(r,s,i,this.options.timeZone):new Date(r,s,i)},this.addDays=(r,s)=>{var i;return(i=this.overrides)!=null&&i.addDays?this.overrides.addDays(r,s):tX(r,s)},this.addMonths=(r,s)=>{var i;return(i=this.overrides)!=null&&i.addMonths?this.overrides.addMonths(r,s):nX(r,s)},this.addWeeks=(r,s)=>{var i;return(i=this.overrides)!=null&&i.addWeeks?this.overrides.addWeeks(r,s):eAe(r,s)},this.addYears=(r,s)=>{var i;return(i=this.overrides)!=null&&i.addYears?this.overrides.addYears(r,s):tAe(r,s)},this.differenceInCalendarDays=(r,s)=>{var i;return(i=this.overrides)!=null&&i.differenceInCalendarDays?this.overrides.differenceInCalendarDays(r,s):sX(r,s)},this.differenceInCalendarMonths=(r,s)=>{var i;return(i=this.overrides)!=null&&i.differenceInCalendarMonths?this.overrides.differenceInCalendarMonths(r,s):aX(r,s)},this.eachMonthOfInterval=r=>{var s;return(s=this.overrides)!=null&&s.eachMonthOfInterval?this.overrides.eachMonthOfInterval(r):pAe(r)},this.endOfBroadcastWeek=r=>{var s;return(s=this.overrides)!=null&&s.endOfBroadcastWeek?this.overrides.endOfBroadcastWeek(r):t6e(r,this)},this.endOfISOWeek=r=>{var s;return(s=this.overrides)!=null&&s.endOfISOWeek?this.overrides.endOfISOWeek(r):yAe(r)},this.endOfMonth=r=>{var s;return(s=this.overrides)!=null&&s.endOfMonth?this.overrides.endOfMonth(r):oX(r)},this.endOfWeek=(r,s)=>{var i;return(i=this.overrides)!=null&&i.endOfWeek?this.overrides.endOfWeek(r,s):cX(r,this.options)},this.endOfYear=r=>{var s;return(s=this.overrides)!=null&&s.endOfYear?this.overrides.endOfYear(r):gAe(r)},this.format=(r,s,i)=>{var o;const a=(o=this.overrides)!=null&&o.format?this.overrides.format(r,s,this.options):Vd(r,s,this.options);return this.options.numerals&&this.options.numerals!=="latn"?this.replaceDigits(a):a},this.getISOWeek=r=>{var s;return(s=this.overrides)!=null&&s.getISOWeek?this.overrides.getISOWeek(r):uX(r)},this.getMonth=(r,s)=>{var i;return(i=this.overrides)!=null&&i.getMonth?this.overrides.getMonth(r,this.options):mRe(r,this.options)},this.getYear=(r,s)=>{var i;return(i=this.overrides)!=null&&i.getYear?this.overrides.getYear(r,this.options):gRe(r,this.options)},this.getWeek=(r,s)=>{var i;return(i=this.overrides)!=null&&i.getWeek?this.overrides.getWeek(r,this.options):fX(r,this.options)},this.isAfter=(r,s)=>{var i;return(i=this.overrides)!=null&&i.isAfter?this.overrides.isAfter(r,s):yRe(r,s)},this.isBefore=(r,s)=>{var i;return(i=this.overrides)!=null&&i.isBefore?this.overrides.isBefore(r,s):bRe(r,s)},this.isDate=r=>{var s;return(s=this.overrides)!=null&&s.isDate?this.overrides.isDate(r):iX(r)},this.isSameDay=(r,s)=>{var i;return(i=this.overrides)!=null&&i.isSameDay?this.overrides.isSameDay(r,s):iAe(r,s)},this.isSameMonth=(r,s)=>{var i;return(i=this.overrides)!=null&&i.isSameMonth?this.overrides.isSameMonth(r,s):vRe(r,s)},this.isSameYear=(r,s)=>{var i;return(i=this.overrides)!=null&&i.isSameYear?this.overrides.isSameYear(r,s):xRe(r,s)},this.max=r=>{var s;return(s=this.overrides)!=null&&s.max?this.overrides.max(r):nAe(r)},this.min=r=>{var s;return(s=this.overrides)!=null&&s.min?this.overrides.min(r):rAe(r)},this.setMonth=(r,s)=>{var i;return(i=this.overrides)!=null&&i.setMonth?this.overrides.setMonth(r,s):FRe(r,s)},this.setYear=(r,s)=>{var i;return(i=this.overrides)!=null&&i.setYear?this.overrides.setYear(r,s):LRe(r,s)},this.startOfBroadcastWeek=(r,s)=>{var i;return(i=this.overrides)!=null&&i.startOfBroadcastWeek?this.overrides.startOfBroadcastWeek(r,this):Iee(r,this)},this.startOfDay=r=>{var s;return(s=this.overrides)!=null&&s.startOfDay?this.overrides.startOfDay(r):jw(r)},this.startOfISOWeek=r=>{var s;return(s=this.overrides)!=null&&s.startOfISOWeek?this.overrides.startOfISOWeek(r):Mw(r)},this.startOfMonth=r=>{var s;return(s=this.overrides)!=null&&s.startOfMonth?this.overrides.startOfMonth(r):mAe(r)},this.startOfWeek=(r,s)=>{var i;return(i=this.overrides)!=null&&i.startOfWeek?this.overrides.startOfWeek(r,this.options):Iy(r,this.options)},this.startOfYear=r=>{var s;return(s=this.overrides)!=null&&s.startOfYear?this.overrides.startOfYear(r):lX(r)},this.options={locale:wT,...t},this.overrides=n}getDigitMap(){const{numerals:t="latn"}=this.options,n=new Intl.NumberFormat("en-US",{numberingSystem:t}),r={};for(let s=0;s<10;s++)r[s.toString()]=n.format(s);return r}replaceDigits(t){const n=this.getDigitMap();return t.replace(/\d/g,r=>n[r]||r)}formatNumber(t){return this.replaceDigits(t.toString())}}const ed=new vf;class Mee{constructor(t,n,r=ed){this.date=t,this.displayMonth=n,this.outside=!!(n&&!r.isSameMonth(t,n)),this.dateLib=r}isEqualTo(t){return this.dateLib.isSameDay(t.date,this.date)&&this.dateLib.isSameMonth(t.displayMonth,this.displayMonth)}}class n6e{constructor(t,n){this.date=t,this.weeks=n}}class r6e{constructor(t,n){this.days=n,this.weekNumber=t}}function Wd(e,t,n=!1,r=ed){let{from:s,to:i}=e;const{differenceInCalendarDays:a,isSameDay:o}=r;return s&&i?(a(i,s)<0&&([s,i]=[i,s]),a(t,s)>=(n?1:0)&&a(i,t)>=(n?1:0)):!n&&i?o(i,t):!n&&s?o(s,t):!1}function jee(e){return!!(e&&typeof e=="object"&&"before"in e&&"after"in e)}function fF(e){return!!(e&&typeof e=="object"&&"from"in e)}function Pee(e){return!!(e&&typeof e=="object"&&"after"in e)}function Oee(e){return!!(e&&typeof e=="object"&&"before"in e)}function Dee(e){return!!(e&&typeof e=="object"&&"dayOfWeek"in e)}function Fee(e,t){return Array.isArray(e)&&e.every(t.isDate)}function Hd(e,t,n=ed){const r=Array.isArray(t)?t:[t],{isSameDay:s,differenceInCalendarDays:i,isAfter:a}=n;return r.some(o=>{if(typeof o=="boolean")return o;if(n.isDate(o))return s(e,o);if(Fee(o,n))return o.includes(e);if(fF(o))return Wd(o,e,!1,n);if(Dee(o))return Array.isArray(o.dayOfWeek)?o.dayOfWeek.includes(e.getDay()):o.dayOfWeek===e.getDay();if(jee(o)){const l=i(o.before,e),c=i(o.after,e),u=l>0,d=c<0;return a(o.before,o.after)?d&&u:u||d}return Pee(o)?i(e,o.after)>0:Oee(o)?i(o.before,e)>0:typeof o=="function"?o(e):!1})}function s6e(e,t,n){const{disabled:r,hidden:s,modifiers:i,showOutsideDays:a,broadcastCalendar:o,today:l}=t,{isSameDay:c,isSameMonth:u,startOfMonth:d,isBefore:h,endOfMonth:m,isAfter:y}=n,b=t.startMonth&&d(t.startMonth),v=t.endMonth&&m(t.endMonth),x={[ei.focused]:[],[ei.outside]:[],[ei.disabled]:[],[ei.hidden]:[],[ei.today]:[]},w={};for(const _ of e){const{date:k,displayMonth:C}=_,T=!!(C&&!u(k,C)),A=!!(b&&h(k,b)),N=!!(v&&y(k,v)),I=!!(r&&Hd(k,r,n)),j=!!(s&&Hd(k,s,n))||A||N||!o&&!a&&T||o&&a===!1&&T,L=c(k,l??n.today());T&&x.outside.push(_),I&&x.disabled.push(_),j&&x.hidden.push(_),L&&x.today.push(_),i&&Object.keys(i).forEach(D=>{const H=i==null?void 0:i[D];H&&Hd(k,H,n)&&(w[D]?w[D].push(_):w[D]=[_])})}return _=>{const k={[ei.focused]:!1,[ei.disabled]:!1,[ei.hidden]:!1,[ei.outside]:!1,[ei.today]:!1},C={};for(const T in x){const A=x[T];k[T]=A.some(N=>N===_)}for(const T in w)C[T]=w[T].some(A=>A===_);return{...k,...C}}}function i6e(e,t,n={}){return Object.entries(e).filter(([,s])=>s===!0).reduce((s,[i])=>(n[i]?s.push(n[i]):t[ei[i]]?s.push(t[ei[i]]):t[Pc[i]]&&s.push(t[Pc[i]]),s),[t[zn.Day]])}function a6e(e){return Ve.createElement("button",{...e})}function o6e(e){return Ve.createElement("span",{...e})}function l6e(e){const{size:t=24,orientation:n="left",className:r}=e;return Ve.createElement("svg",{className:r,width:t,height:t,viewBox:"0 0 24 24"},n==="up"&&Ve.createElement("polygon",{points:"6.77 17 12.5 11.43 18.24 17 20 15.28 12.5 8 5 15.28"}),n==="down"&&Ve.createElement("polygon",{points:"6.77 8 12.5 13.57 18.24 8 20 9.72 12.5 17 5 9.72"}),n==="left"&&Ve.createElement("polygon",{points:"16 18.112 9.81111111 12 16 5.87733333 14.0888889 4 6 12 14.0888889 20"}),n==="right"&&Ve.createElement("polygon",{points:"8 18.112 14.18888889 12 8 5.87733333 9.91111111 4 18 12 9.91111111 20"}))}function c6e(e){const{day:t,modifiers:n,...r}=e;return Ve.createElement("td",{...r})}function u6e(e){const{day:t,modifiers:n,...r}=e,s=Ve.useRef(null);return Ve.useEffect(()=>{var i;n.focused&&((i=s.current)==null||i.focus())},[n.focused]),Ve.createElement("button",{ref:s,...r})}function d6e(e){const{options:t,className:n,components:r,classNames:s,...i}=e,a=[s[zn.Dropdown],n].join(" "),o=t==null?void 0:t.find(({value:l})=>l===i.value);return Ve.createElement("span",{"data-disabled":i.disabled,className:s[zn.DropdownRoot]},Ve.createElement(r.Select,{className:a,...i},t==null?void 0:t.map(({value:l,label:c,disabled:u})=>Ve.createElement(r.Option,{key:l,value:l,disabled:u},c))),Ve.createElement("span",{className:s[zn.CaptionLabel],"aria-hidden":!0},o==null?void 0:o.label,Ve.createElement(r.Chevron,{orientation:"down",size:18,className:s[zn.Chevron]})))}function f6e(e){return Ve.createElement("div",{...e})}function h6e(e){return Ve.createElement("div",{...e})}function p6e(e){const{calendarMonth:t,displayIndex:n,...r}=e;return Ve.createElement("div",{...r},e.children)}function m6e(e){const{calendarMonth:t,displayIndex:n,...r}=e;return Ve.createElement("div",{...r})}function g6e(e){return Ve.createElement("table",{...e})}function y6e(e){return Ve.createElement("div",{...e})}const Lee=E.createContext(void 0);function lS(){const e=E.useContext(Lee);if(e===void 0)throw new Error("useDayPicker() must be used within a custom component.");return e}function b6e(e){const{components:t}=lS();return Ve.createElement(t.Dropdown,{...e})}function v6e(e){const{onPreviousClick:t,onNextClick:n,previousMonth:r,nextMonth:s,...i}=e,{components:a,classNames:o,labels:{labelPrevious:l,labelNext:c}}=lS(),u=E.useCallback(h=>{s&&(n==null||n(h))},[s,n]),d=E.useCallback(h=>{r&&(t==null||t(h))},[r,t]);return Ve.createElement("nav",{...i},Ve.createElement(a.PreviousMonthButton,{type:"button",className:o[zn.PreviousMonthButton],tabIndex:r?void 0:-1,"aria-disabled":r?void 0:!0,"aria-label":l(r),onClick:d},Ve.createElement(a.Chevron,{disabled:r?void 0:!0,className:o[zn.Chevron],orientation:"left"})),Ve.createElement(a.NextMonthButton,{type:"button",className:o[zn.NextMonthButton],tabIndex:s?void 0:-1,"aria-disabled":s?void 0:!0,"aria-label":c(s),onClick:u},Ve.createElement(a.Chevron,{disabled:s?void 0:!0,orientation:"right",className:o[zn.Chevron]})))}function x6e(e){const{components:t}=lS();return Ve.createElement(t.Button,{...e})}function w6e(e){return Ve.createElement("option",{...e})}function S6e(e){const{components:t}=lS();return Ve.createElement(t.Button,{...e})}function _6e(e){const{rootRef:t,...n}=e;return Ve.createElement("div",{...n,ref:t})}function C6e(e){return Ve.createElement("select",{...e})}function k6e(e){const{week:t,...n}=e;return Ve.createElement("tr",{...n})}function E6e(e){return Ve.createElement("th",{...e})}function T6e(e){return Ve.createElement("thead",{"aria-hidden":!0},Ve.createElement("tr",{...e}))}function A6e(e){const{week:t,...n}=e;return Ve.createElement("th",{...n})}function R6e(e){return Ve.createElement("th",{...e})}function N6e(e){return Ve.createElement("tbody",{...e})}function I6e(e){const{components:t}=lS();return Ve.createElement(t.Dropdown,{...e})}const M6e=Object.freeze(Object.defineProperty({__proto__:null,Button:a6e,CaptionLabel:o6e,Chevron:l6e,Day:c6e,DayButton:u6e,Dropdown:d6e,DropdownNav:f6e,Footer:h6e,Month:p6e,MonthCaption:m6e,MonthGrid:g6e,Months:y6e,MonthsDropdown:b6e,Nav:v6e,NextMonthButton:x6e,Option:w6e,PreviousMonthButton:S6e,Root:_6e,Select:C6e,Week:k6e,WeekNumber:A6e,WeekNumberHeader:R6e,Weekday:E6e,Weekdays:T6e,Weeks:N6e,YearsDropdown:I6e},Symbol.toStringTag,{value:"Module"}));function j6e(e){return{...M6e,...e}}function P6e(e){const t={"data-mode":e.mode??void 0,"data-required":"required"in e?e.required:void 0,"data-multiple-months":e.numberOfMonths&&e.numberOfMonths>1||void 0,"data-week-numbers":e.showWeekNumber||void 0,"data-broadcast-calendar":e.broadcastCalendar||void 0,"data-nav-layout":e.navLayout||void 0};return Object.entries(e).forEach(([n,r])=>{n.startsWith("data-")&&(t[n]=r)}),t}function hF(){const e={};for(const t in zn)e[zn[t]]=`rdp-${zn[t]}`;for(const t in ei)e[ei[t]]=`rdp-${ei[t]}`;for(const t in Pc)e[Pc[t]]=`rdp-${Pc[t]}`;for(const t in hl)e[hl[t]]=`rdp-${hl[t]}`;return e}function Bee(e,t,n){return(n??new vf(t)).format(e,"LLLL y")}const O6e=Bee;function D6e(e,t,n){return(n??new vf(t)).format(e,"d")}function F6e(e,t=ed){return t.format(e,"LLLL")}function L6e(e,t=ed){return e<10?t.formatNumber(`0${e.toLocaleString()}`):t.formatNumber(`${e.toLocaleString()}`)}function B6e(){return""}function $6e(e,t,n){return(n??new vf(t)).format(e,"cccccc")}function $ee(e,t=ed){return t.format(e,"yyyy")}const z6e=$ee,U6e=Object.freeze(Object.defineProperty({__proto__:null,formatCaption:Bee,formatDay:D6e,formatMonthCaption:O6e,formatMonthDropdown:F6e,formatWeekNumber:L6e,formatWeekNumberHeader:B6e,formatWeekdayName:$6e,formatYearCaption:z6e,formatYearDropdown:$ee},Symbol.toStringTag,{value:"Module"}));function q6e(e){return e!=null&&e.formatMonthCaption&&!e.formatCaption&&(e.formatCaption=e.formatMonthCaption),e!=null&&e.formatYearCaption&&!e.formatYearDropdown&&(e.formatYearDropdown=e.formatYearCaption),{...U6e,...e}}function V6e(e,t,n,r,s){const{startOfMonth:i,startOfYear:a,endOfYear:o,eachMonthOfInterval:l,getMonth:c}=s;return l({start:a(e),end:o(e)}).map(h=>{const m=r.formatMonthDropdown(h,s),y=c(h),b=t&&h<i(t)||n&&h>i(n)||!1;return{value:y,label:m,disabled:b}})}function W6e(e,t={},n={}){let r={...t==null?void 0:t[zn.Day]};return Object.entries(e).filter(([,s])=>s===!0).forEach(([s])=>{r={...r,...n==null?void 0:n[s]}}),r}function H6e(e,t,n){const r=e.today(),s=t?e.startOfISOWeek(r):e.startOfWeek(r),i=[];for(let a=0;a<7;a++){const o=e.addDays(s,a);i.push(o)}return i}function G6e(e,t,n,r){if(!e||!t)return;const{startOfYear:s,endOfYear:i,addYears:a,getYear:o,isBefore:l,isSameYear:c}=r,u=s(e),d=i(t),h=[];let m=u;for(;l(m,d)||c(m,d);)h.push(m),m=a(m,1);return h.map(y=>{const b=n.formatYearDropdown(y,r);return{value:o(y),label:b,disabled:!1}})}function zee(e,t,n){return(n??new vf(t)).format(e,"LLLL y")}const K6e=zee;function Y6e(e,t,n,r){let s=(r??new vf(n)).format(e,"PPPP");return t!=null&&t.today&&(s=`Today, ${s}`),s}function Uee(e,t,n,r){let s=(r??new vf(n)).format(e,"PPPP");return t.today&&(s=`Today, ${s}`),t.selected&&(s=`${s}, selected`),s}const Z6e=Uee;function X6e(){return""}function J6e(e){return"Choose the Month"}function Q6e(e){return"Go to the Next Month"}function e5e(e){return"Go to the Previous Month"}function t5e(e,t,n){return(n??new vf(t)).format(e,"cccc")}function n5e(e,t){return`Week ${e}`}function r5e(e){return"Week Number"}function s5e(e){return"Choose the Year"}const i5e=Object.freeze(Object.defineProperty({__proto__:null,labelCaption:K6e,labelDay:Z6e,labelDayButton:Uee,labelGrid:zee,labelGridcell:Y6e,labelMonthDropdown:J6e,labelNav:X6e,labelNext:Q6e,labelPrevious:e5e,labelWeekNumber:n5e,labelWeekNumberHeader:r5e,labelWeekday:t5e,labelYearDropdown:s5e},Symbol.toStringTag,{value:"Module"})),cS=e=>e instanceof HTMLElement?e:null,ej=e=>[...e.querySelectorAll("[data-animated-month]")??[]],a5e=e=>cS(e.querySelector("[data-animated-month]")),tj=e=>cS(e.querySelector("[data-animated-caption]")),nj=e=>cS(e.querySelector("[data-animated-weeks]")),o5e=e=>cS(e.querySelector("[data-animated-nav]")),l5e=e=>cS(e.querySelector("[data-animated-weekdays]"));function c5e(e,t,{classNames:n,months:r,focused:s,dateLib:i}){const a=E.useRef(null),o=E.useRef(r),l=E.useRef(!1);E.useLayoutEffect(()=>{const c=o.current;if(o.current=r,!t||!e.current||!(e.current instanceof HTMLElement)||r.length===0||c.length===0||r.length!==c.length)return;const u=i.isSameMonth(r[0].date,c[0].date),d=i.isAfter(r[0].date,c[0].date),h=d?n[hl.caption_after_enter]:n[hl.caption_before_enter],m=d?n[hl.weeks_after_enter]:n[hl.weeks_before_enter],y=a.current,b=e.current.cloneNode(!0);if(b instanceof HTMLElement?(ej(b).forEach(_=>{if(!(_ instanceof HTMLElement))return;const k=a5e(_);k&&_.contains(k)&&_.removeChild(k);const C=tj(_);C&&C.classList.remove(h);const T=nj(_);T&&T.classList.remove(m)}),a.current=b):a.current=null,l.current||u||s)return;const v=y instanceof HTMLElement?ej(y):[],x=ej(e.current);if(x&&x.every(w=>w instanceof HTMLElement)&&v&&v.every(w=>w instanceof HTMLElement)){l.current=!0,e.current.style.isolation="isolate";const w=o5e(e.current);w&&(w.style.zIndex="1"),x.forEach((_,k)=>{const C=v[k];if(!C)return;_.style.position="relative",_.style.overflow="hidden";const T=tj(_);T&&T.classList.add(h);const A=nj(_);A&&A.classList.add(m);const N=()=>{l.current=!1,e.current&&(e.current.style.isolation=""),w&&(w.style.zIndex=""),T&&T.classList.remove(h),A&&A.classList.remove(m),_.style.position="",_.style.overflow="",_.contains(C)&&_.removeChild(C)};C.style.pointerEvents="none",C.style.position="absolute",C.style.overflow="hidden",C.setAttribute("aria-hidden","true");const I=l5e(C);I&&(I.style.opacity="0");const j=tj(C);j&&(j.classList.add(d?n[hl.caption_before_exit]:n[hl.caption_after_exit]),j.addEventListener("animationend",N));const L=nj(C);L&&L.classList.add(d?n[hl.weeks_before_exit]:n[hl.weeks_after_exit]),_.insertBefore(C,_.firstChild)})}})}function u5e(e,t,n,r){const s=e[0],i=e[e.length-1],{ISOWeek:a,fixedWeeks:o,broadcastCalendar:l}=n??{},{addDays:c,differenceInCalendarDays:u,differenceInCalendarMonths:d,endOfBroadcastWeek:h,endOfISOWeek:m,endOfMonth:y,endOfWeek:b,isAfter:v,startOfBroadcastWeek:x,startOfISOWeek:w,startOfWeek:_}=r,k=l?x(s,r):a?w(s):_(s),C=l?h(i):a?m(y(i)):b(y(i)),T=u(C,k),A=d(i,s)+1,N=[];for(let L=0;L<=T;L++){const D=c(k,L);if(t&&v(D,t))break;N.push(D)}const j=(l?35:42)*A;if(o&&N.length<j){const L=j-N.length;for(let D=0;D<L;D++){const H=c(N[N.length-1],1);N.push(H)}}return N}function d5e(e){const t=[];return e.reduce((n,r)=>{const s=r.weeks.reduce((i,a)=>[...i,...a.days],t);return[...n,...s]},t)}function f5e(e,t,n,r){const{numberOfMonths:s=1}=n,i=[];for(let a=0;a<s;a++){const o=r.addMonths(e,a);if(t&&o>t)break;i.push(o)}return i}function cU(e,t){const{month:n,defaultMonth:r,today:s=t.today(),numberOfMonths:i=1,endMonth:a,startMonth:o}=e;let l=n||r||s;const{differenceInCalendarMonths:c,addMonths:u,startOfMonth:d}=t;if(a&&c(a,l)<0){const h=-1*(i-1);l=u(a,h)}return o&&c(l,o)<0&&(l=o),d(l)}function h5e(e,t,n,r){const{addDays:s,endOfBroadcastWeek:i,endOfISOWeek:a,endOfMonth:o,endOfWeek:l,getISOWeek:c,getWeek:u,startOfBroadcastWeek:d,startOfISOWeek:h,startOfWeek:m}=r,y=e.reduce((b,v)=>{const x=n.broadcastCalendar?d(v,r):n.ISOWeek?h(v):m(v),w=n.broadcastCalendar?i(v):n.ISOWeek?a(o(v)):l(o(v)),_=t.filter(A=>A>=x&&A<=w),k=n.broadcastCalendar?35:42;if(n.fixedWeeks&&_.length<k){const A=t.filter(N=>{const I=k-_.length;return N>w&&N<=s(w,I)});_.push(...A)}const C=_.reduce((A,N)=>{const I=n.ISOWeek?c(N):u(N),j=A.find(D=>D.weekNumber===I),L=new Mee(N,v,r);return j?j.days.push(L):A.push(new r6e(I,[L])),A},[]),T=new n6e(v,C);return b.push(T),b},[]);return n.reverseMonths?y.reverse():y}function p5e(e,t){let{startMonth:n,endMonth:r}=e;const{startOfYear:s,startOfDay:i,startOfMonth:a,endOfMonth:o,addYears:l,endOfYear:c,newDate:u,today:d}=t,{fromYear:h,toYear:m,fromMonth:y,toMonth:b}=e;!n&&y&&(n=y),!n&&h&&(n=t.newDate(h,0,1)),!r&&b&&(r=b),!r&&m&&(r=u(m,11,31));const v=e.captionLayout==="dropdown"||e.captionLayout==="dropdown-years";return n?n=a(n):h?n=u(h,0,1):!n&&v&&(n=s(l(e.today??d(),-100))),r?r=o(r):m?r=u(m,11,31):!r&&v&&(r=c(e.today??d())),[n&&i(n),r&&i(r)]}function m5e(e,t,n,r){if(n.disableNavigation)return;const{pagedNavigation:s,numberOfMonths:i=1}=n,{startOfMonth:a,addMonths:o,differenceInCalendarMonths:l}=r,c=s?i:1,u=a(e);if(!t)return o(u,c);if(!(l(t,e)<i))return o(u,c)}function g5e(e,t,n,r){if(n.disableNavigation)return;const{pagedNavigation:s,numberOfMonths:i}=n,{startOfMonth:a,addMonths:o,differenceInCalendarMonths:l}=r,c=s?i??1:1,u=a(e);if(!t)return o(u,-c);if(!(l(u,t)<=0))return o(u,-c)}function y5e(e){const t=[];return e.reduce((n,r)=>[...n,...r.weeks],t)}function zT(e,t){const[n,r]=E.useState(e);return[t===void 0?n:t,r]}function b5e(e,t){const[n,r]=p5e(e,t),{startOfMonth:s,endOfMonth:i}=t,a=cU(e,t),[o,l]=zT(a,e.month?a:void 0);E.useEffect(()=>{const T=cU(e,t);l(T)},[e.timeZone]);const c=f5e(o,r,e,t),u=u5e(c,e.endMonth?i(e.endMonth):void 0,e,t),d=h5e(c,u,e,t),h=y5e(d),m=d5e(d),y=g5e(o,n,e,t),b=m5e(o,r,e,t),{disableNavigation:v,onMonthChange:x}=e,w=T=>h.some(A=>A.days.some(N=>N.isEqualTo(T))),_=T=>{if(v)return;let A=s(T);n&&A<s(n)&&(A=s(n)),r&&A>s(r)&&(A=s(r)),l(A),x==null||x(A)};return{months:d,weeks:h,days:m,navStart:n,navEnd:r,previousMonth:y,nextMonth:b,goToMonth:_,goToDay:T=>{w(T)||_(T.date)}}}var xu;(function(e){e[e.Today=0]="Today",e[e.Selected=1]="Selected",e[e.LastFocused=2]="LastFocused",e[e.FocusedModifier=3]="FocusedModifier"})(xu||(xu={}));function uU(e){return!e[ei.disabled]&&!e[ei.hidden]&&!e[ei.outside]}function v5e(e,t,n,r){let s,i=-1;for(const a of e){const o=t(a);uU(o)&&(o[ei.focused]&&i<xu.FocusedModifier?(s=a,i=xu.FocusedModifier):r!=null&&r.isEqualTo(a)&&i<xu.LastFocused?(s=a,i=xu.LastFocused):n(a.date)&&i<xu.Selected?(s=a,i=xu.Selected):o[ei.today]&&i<xu.Today&&(s=a,i=xu.Today))}return s||(s=e.find(a=>uU(t(a)))),s}function x5e(e,t,n,r,s,i,a){const{ISOWeek:o,broadcastCalendar:l}=i,{addDays:c,addMonths:u,addWeeks:d,addYears:h,endOfBroadcastWeek:m,endOfISOWeek:y,endOfWeek:b,max:v,min:x,startOfBroadcastWeek:w,startOfISOWeek:_,startOfWeek:k}=a;let T={day:c,week:d,month:u,year:h,startOfWeek:A=>l?w(A,a):o?_(A):k(A),endOfWeek:A=>l?m(A):o?y(A):b(A)}[e](n,t==="after"?1:-1);return t==="before"&&r?T=v([r,T]):t==="after"&&s&&(T=x([s,T])),T}function qee(e,t,n,r,s,i,a,o=0){if(o>365)return;const l=x5e(e,t,n.date,r,s,i,a),c=!!(i.disabled&&Hd(l,i.disabled,a)),u=!!(i.hidden&&Hd(l,i.hidden,a)),d=l,h=new Mee(l,d,a);return!c&&!u?h:qee(e,t,h,r,s,i,a,o+1)}function w5e(e,t,n,r,s){const{autoFocus:i}=e,[a,o]=E.useState(),l=v5e(t.days,n,r||(()=>!1),a),[c,u]=E.useState(i?l:void 0);return{isFocusTarget:b=>!!(l!=null&&l.isEqualTo(b)),setFocused:u,focused:c,blur:()=>{o(c),u(void 0)},moveFocus:(b,v)=>{if(!c)return;const x=qee(b,v,c,t.navStart,t.navEnd,e,s);x&&(t.goToDay(x),u(x))}}}function S5e(e,t){const{selected:n,required:r,onSelect:s}=e,[i,a]=zT(n,s?n:void 0),o=s?n:i,{isSameDay:l}=t,c=m=>(o==null?void 0:o.some(y=>l(y,m)))??!1,{min:u,max:d}=e;return{selected:o,select:(m,y,b)=>{let v=[...o??[]];if(c(m)){if((o==null?void 0:o.length)===u||r&&(o==null?void 0:o.length)===1)return;v=o==null?void 0:o.filter(x=>!l(x,m))}else(o==null?void 0:o.length)===d?v=[m]:v=[...v,m];return s||a(v),s==null||s(v,m,y,b),v},isSelected:c}}function _5e(e,t,n=0,r=0,s=!1,i=ed){const{from:a,to:o}=t||{},{isSameDay:l,isAfter:c,isBefore:u}=i;let d;if(!a&&!o)d={from:e,to:n>0?void 0:e};else if(a&&!o)l(a,e)?s?d={from:a,to:void 0}:d=void 0:u(e,a)?d={from:e,to:a}:d={from:a,to:e};else if(a&&o)if(l(a,e)&&l(o,e))s?d={from:a,to:o}:d=void 0;else if(l(a,e))d={from:a,to:n>0?void 0:e};else if(l(o,e))d={from:e,to:n>0?void 0:e};else if(u(e,a))d={from:e,to:o};else if(c(e,a))d={from:a,to:e};else if(c(e,o))d={from:a,to:e};else throw new Error("Invalid range");if(d!=null&&d.from&&(d!=null&&d.to)){const h=i.differenceInCalendarDays(d.to,d.from);r>0&&h>r?d={from:e,to:void 0}:n>1&&h<n&&(d={from:e,to:void 0})}return d}function C5e(e,t,n=ed){const r=Array.isArray(t)?t:[t];let s=e.from;const i=n.differenceInCalendarDays(e.to,e.from),a=Math.min(i,6);for(let o=0;o<=a;o++){if(r.includes(s.getDay()))return!0;s=n.addDays(s,1)}return!1}function dU(e,t,n=ed){return Wd(e,t.from,!1,n)||Wd(e,t.to,!1,n)||Wd(t,e.from,!1,n)||Wd(t,e.to,!1,n)}function k5e(e,t,n=ed){const r=Array.isArray(t)?t:[t];if(r.filter(o=>typeof o!="function").some(o=>typeof o=="boolean"?o:n.isDate(o)?Wd(e,o,!1,n):Fee(o,n)?o.some(l=>Wd(e,l,!1,n)):fF(o)?o.from&&o.to?dU(e,{from:o.from,to:o.to},n):!1:Dee(o)?C5e(e,o.dayOfWeek,n):jee(o)?n.isAfter(o.before,o.after)?dU(e,{from:n.addDays(o.after,1),to:n.addDays(o.before,-1)},n):Hd(e.from,o,n)||Hd(e.to,o,n):Pee(o)||Oee(o)?Hd(e.from,o,n)||Hd(e.to,o,n):!1))return!0;const a=r.filter(o=>typeof o=="function");if(a.length){let o=e.from;const l=n.differenceInCalendarDays(e.to,e.from);for(let c=0;c<=l;c++){if(a.some(u=>u(o)))return!0;o=n.addDays(o,1)}}return!1}function E5e(e,t){const{disabled:n,excludeDisabled:r,selected:s,required:i,onSelect:a}=e,[o,l]=zT(s,a?s:void 0),c=a?s:o;return{selected:c,select:(h,m,y)=>{const{min:b,max:v}=e,x=h?_5e(h,c,b,v,i,t):void 0;return r&&n&&(x!=null&&x.from)&&x.to&&k5e({from:x.from,to:x.to},n,t)&&(x.from=h,x.to=void 0),a||l(x),a==null||a(x,h,m,y),x},isSelected:h=>c&&Wd(c,h,!1,t)}}function T5e(e,t){const{selected:n,required:r,onSelect:s}=e,[i,a]=zT(n,s?n:void 0),o=s?n:i,{isSameDay:l}=t;return{selected:o,select:(d,h,m)=>{let y=d;return!r&&o&&o&&l(d,o)&&(y=void 0),s||a(y),s==null||s(y,d,h,m),y},isSelected:d=>o?l(o,d):!1}}function A5e(e,t){const n=T5e(e,t),r=S5e(e,t),s=E5e(e,t);switch(e.mode){case"single":return n;case"multiple":return r;case"range":return s;default:return}}function R5e(e){var ft;let t=e;t.timeZone&&(t={...e},t.today&&(t.today=new $a(t.today,t.timeZone)),t.month&&(t.month=new $a(t.month,t.timeZone)),t.defaultMonth&&(t.defaultMonth=new $a(t.defaultMonth,t.timeZone)),t.startMonth&&(t.startMonth=new $a(t.startMonth,t.timeZone)),t.endMonth&&(t.endMonth=new $a(t.endMonth,t.timeZone)),t.mode==="single"&&t.selected?t.selected=new $a(t.selected,t.timeZone):t.mode==="multiple"&&t.selected?t.selected=(ft=t.selected)==null?void 0:ft.map(et=>new $a(et,t.timeZone)):t.mode==="range"&&t.selected&&(t.selected={from:t.selected.from?new $a(t.selected.from,t.timeZone):void 0,to:t.selected.to?new $a(t.selected.to,t.timeZone):void 0}));const{components:n,formatters:r,labels:s,dateLib:i,locale:a,classNames:o}=E.useMemo(()=>{const et={...wT,...t.locale};return{dateLib:new vf({locale:et,weekStartsOn:t.broadcastCalendar?1:t.weekStartsOn,firstWeekContainsDate:t.firstWeekContainsDate,useAdditionalWeekYearTokens:t.useAdditionalWeekYearTokens,useAdditionalDayOfYearTokens:t.useAdditionalDayOfYearTokens,timeZone:t.timeZone,numerals:t.numerals},t.dateLib),components:j6e(t.components),formatters:q6e(t.formatters),labels:{...i5e,...t.labels},locale:et,classNames:{...hF(),...t.classNames}}},[t.locale,t.broadcastCalendar,t.weekStartsOn,t.firstWeekContainsDate,t.useAdditionalWeekYearTokens,t.useAdditionalDayOfYearTokens,t.timeZone,t.numerals,t.dateLib,t.components,t.formatters,t.labels,t.classNames]),{captionLayout:l,mode:c,navLayout:u,numberOfMonths:d=1,onDayBlur:h,onDayClick:m,onDayFocus:y,onDayKeyDown:b,onDayMouseEnter:v,onDayMouseLeave:x,onNextClick:w,onPrevClick:_,showWeekNumber:k,styles:C}=t,{formatCaption:T,formatDay:A,formatMonthDropdown:N,formatWeekNumber:I,formatWeekNumberHeader:j,formatWeekdayName:L,formatYearDropdown:D}=r,H=b5e(t,i),{days:O,months:K,navStart:U,navEnd:W,previousMonth:B,nextMonth:ne,goToMonth:V}=H,Q=s6e(O,t,i),{isSelected:ee,select:re,selected:de}=A5e(t,i)??{},{blur:me,focused:De,isFocusTarget:je,moveFocus:Te,setFocused:_e}=w5e(t,H,Q,ee??(()=>!1),i),{labelDayButton:Ue,labelGridcell:Qe,labelGrid:We,labelMonthDropdown:Pe,labelNav:Y,labelPrevious:ye,labelNext:Me,labelWeekday:ue,labelWeekNumber:oe,labelWeekNumberHeader:se,labelYearDropdown:Ie}=s,Be=E.useMemo(()=>H6e(i,t.ISOWeek),[i,t.ISOWeek]),Re=c!==void 0||m!==void 0,ct=E.useCallback(()=>{B&&(V(B),_==null||_(B))},[B,V,_]),At=E.useCallback(()=>{ne&&(V(ne),w==null||w(ne))},[V,ne,w]),ut=E.useCallback((et,$)=>qe=>{qe.preventDefault(),qe.stopPropagation(),_e(et),re==null||re(et.date,$,qe),m==null||m(et.date,$,qe)},[re,m,_e]),Pt=E.useCallback((et,$)=>qe=>{_e(et),y==null||y(et.date,$,qe)},[y,_e]),Ut=E.useCallback((et,$)=>qe=>{me(),h==null||h(et.date,$,qe)},[me,h]),Ft=E.useCallback((et,$)=>qe=>{const tt={ArrowLeft:["day",t.dir==="rtl"?"after":"before"],ArrowRight:["day",t.dir==="rtl"?"before":"after"],ArrowDown:["week","after"],ArrowUp:["week","before"],PageUp:[qe.shiftKey?"year":"month","before"],PageDown:[qe.shiftKey?"year":"month","after"],Home:["startOfWeek","before"],End:["endOfWeek","after"]};if(tt[qe.key]){qe.preventDefault(),qe.stopPropagation();const[ve,Se]=tt[qe.key];Te(ve,Se)}b==null||b(et.date,$,qe)},[Te,b,t.dir]),Yt=E.useCallback((et,$)=>qe=>{v==null||v(et.date,$,qe)},[v]),we=E.useCallback((et,$)=>qe=>{x==null||x(et.date,$,qe)},[x]),F=E.useCallback(et=>$=>{const qe=Number($.target.value),tt=i.setMonth(i.startOfMonth(et),qe);V(tt)},[i,V]),X=E.useCallback(et=>$=>{const qe=Number($.target.value),tt=i.setYear(i.startOfMonth(et),qe);V(tt)},[i,V]),{className:be,style:Ee}=E.useMemo(()=>({className:[o[zn.Root],t.className].filter(Boolean).join(" "),style:{...C==null?void 0:C[zn.Root],...t.style}}),[o,t.className,t.style,C]),ge=P6e(t),Ae=E.useRef(null);c5e(Ae,!!t.animate,{classNames:o,months:K,focused:De,dateLib:i});const le={dayPickerProps:t,selected:de,select:re,isSelected:ee,months:K,nextMonth:ne,previousMonth:B,goToMonth:V,getModifiers:Q,components:n,classNames:o,styles:C,labels:s,formatters:r};return Ve.createElement(Lee.Provider,{value:le},Ve.createElement(n.Root,{rootRef:t.animate?Ae:void 0,className:be,style:Ee,dir:t.dir,id:t.id,lang:t.lang,nonce:t.nonce,title:t.title,role:t.role,"aria-label":t["aria-label"],...ge},Ve.createElement(n.Months,{className:o[zn.Months],style:C==null?void 0:C[zn.Months]},!t.hideNavigation&&!u&&Ve.createElement(n.Nav,{"data-animated-nav":t.animate?"true":void 0,className:o[zn.Nav],style:C==null?void 0:C[zn.Nav],"aria-label":Y(),onPreviousClick:ct,onNextClick:At,previousMonth:B,nextMonth:ne}),K.map((et,$)=>{const qe=V6e(et.date,U,W,r,i),tt=G6e(U,W,r,i);return Ve.createElement(n.Month,{"data-animated-month":t.animate?"true":void 0,className:o[zn.Month],style:C==null?void 0:C[zn.Month],key:$,displayIndex:$,calendarMonth:et},u==="around"&&!t.hideNavigation&&$===0&&Ve.createElement(n.PreviousMonthButton,{type:"button",className:o[zn.PreviousMonthButton],tabIndex:B?void 0:-1,"aria-disabled":B?void 0:!0,"aria-label":ye(B),onClick:ct,"data-animated-button":t.animate?"true":void 0},Ve.createElement(n.Chevron,{disabled:B?void 0:!0,className:o[zn.Chevron],orientation:t.dir==="rtl"?"right":"left"})),Ve.createElement(n.MonthCaption,{"data-animated-caption":t.animate?"true":void 0,className:o[zn.MonthCaption],style:C==null?void 0:C[zn.MonthCaption],calendarMonth:et,displayIndex:$},l!=null&&l.startsWith("dropdown")?Ve.createElement(n.DropdownNav,{className:o[zn.Dropdowns],style:C==null?void 0:C[zn.Dropdowns]},l==="dropdown"||l==="dropdown-months"?Ve.createElement(n.MonthsDropdown,{className:o[zn.MonthsDropdown],"aria-label":Pe(),classNames:o,components:n,disabled:!!t.disableNavigation,onChange:F(et.date),options:qe,style:C==null?void 0:C[zn.Dropdown],value:i.getMonth(et.date)}):Ve.createElement("span",null,N(et.date,i)),l==="dropdown"||l==="dropdown-years"?Ve.createElement(n.YearsDropdown,{className:o[zn.YearsDropdown],"aria-label":Ie(i.options),classNames:o,components:n,disabled:!!t.disableNavigation,onChange:X(et.date),options:tt,style:C==null?void 0:C[zn.Dropdown],value:i.getYear(et.date)}):Ve.createElement("span",null,D(et.date,i)),Ve.createElement("span",{role:"status","aria-live":"polite",style:{border:0,clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"absolute",width:"1px",whiteSpace:"nowrap",wordWrap:"normal"}},T(et.date,i.options,i))):Ve.createElement(n.CaptionLabel,{className:o[zn.CaptionLabel],role:"status","aria-live":"polite"},T(et.date,i.options,i))),u==="around"&&!t.hideNavigation&&$===d-1&&Ve.createElement(n.NextMonthButton,{type:"button",className:o[zn.NextMonthButton],tabIndex:ne?void 0:-1,"aria-disabled":ne?void 0:!0,"aria-label":Me(ne),onClick:At,"data-animated-button":t.animate?"true":void 0},Ve.createElement(n.Chevron,{disabled:ne?void 0:!0,className:o[zn.Chevron],orientation:t.dir==="rtl"?"left":"right"})),$===d-1&&u==="after"&&!t.hideNavigation&&Ve.createElement(n.Nav,{"data-animated-nav":t.animate?"true":void 0,className:o[zn.Nav],style:C==null?void 0:C[zn.Nav],"aria-label":Y(),onPreviousClick:ct,onNextClick:At,previousMonth:B,nextMonth:ne}),Ve.createElement(n.MonthGrid,{role:"grid","aria-multiselectable":c==="multiple"||c==="range","aria-label":We(et.date,i.options,i)||void 0,className:o[zn.MonthGrid],style:C==null?void 0:C[zn.MonthGrid]},!t.hideWeekdays&&Ve.createElement(n.Weekdays,{"data-animated-weekdays":t.animate?"true":void 0,className:o[zn.Weekdays],style:C==null?void 0:C[zn.Weekdays]},k&&Ve.createElement(n.WeekNumberHeader,{"aria-label":se(i.options),className:o[zn.WeekNumberHeader],style:C==null?void 0:C[zn.WeekNumberHeader],scope:"col"},j()),Be.map((ve,Se)=>Ve.createElement(n.Weekday,{"aria-label":ue(ve,i.options,i),className:o[zn.Weekday],key:Se,style:C==null?void 0:C[zn.Weekday],scope:"col"},L(ve,i.options,i)))),Ve.createElement(n.Weeks,{"data-animated-weeks":t.animate?"true":void 0,className:o[zn.Weeks],style:C==null?void 0:C[zn.Weeks]},et.weeks.map((ve,Se)=>Ve.createElement(n.Week,{className:o[zn.Week],key:ve.weekNumber,style:C==null?void 0:C[zn.Week],week:ve},k&&Ve.createElement(n.WeekNumber,{week:ve,style:C==null?void 0:C[zn.WeekNumber],"aria-label":oe(ve.weekNumber,{locale:a}),className:o[zn.WeekNumber],scope:"row",role:"rowheader"},I(ve.weekNumber,i)),ve.days.map(ze=>{const{date:Ct}=ze,fe=Q(ze);if(fe[ei.focused]=!fe.hidden&&!!(De!=null&&De.isEqualTo(ze)),fe[Pc.selected]=(ee==null?void 0:ee(Ct))||fe.selected,fF(de)){const{from:xe,to:Fe}=de;fe[Pc.range_start]=!!(xe&&Fe&&i.isSameDay(Ct,xe)),fe[Pc.range_end]=!!(xe&&Fe&&i.isSameDay(Ct,Fe)),fe[Pc.range_middle]=Wd(de,Ct,!0,i)}const Z=W6e(fe,C,t.modifiersStyles),G=i6e(fe,o,t.modifiersClassNames),J=!Re&&!fe.hidden?Qe(Ct,fe,i.options,i):void 0;return Ve.createElement(n.Day,{key:`${i.format(Ct,"yyyy-MM-dd")}_${i.format(ze.displayMonth,"yyyy-MM")}`,day:ze,modifiers:fe,className:G.join(" "),style:Z,role:"gridcell","aria-selected":fe.selected||void 0,"aria-label":J,"data-day":i.format(Ct,"yyyy-MM-dd"),"data-month":ze.outside?i.format(Ct,"yyyy-MM"):void 0,"data-selected":fe.selected||void 0,"data-disabled":fe.disabled||void 0,"data-hidden":fe.hidden||void 0,"data-outside":ze.outside||void 0,"data-focused":fe.focused||void 0,"data-today":fe.today||void 0},!fe.hidden&&Re?Ve.createElement(n.DayButton,{className:o[zn.DayButton],style:C==null?void 0:C[zn.DayButton],type:"button",day:ze,modifiers:fe,disabled:fe.disabled||void 0,tabIndex:je(ze)?0:-1,"aria-label":Ue(Ct,fe,i.options,i),onClick:ut(ze,fe),onBlur:Ut(ze,fe),onFocus:Pt(ze,fe),onKeyDown:Ft(ze,fe),onMouseEnter:Yt(ze,fe),onMouseLeave:we(ze,fe)},A(Ct,i.options,i)):!fe.hidden&&A(ze.date,i.options,i))}))))))})),t.footer&&Ve.createElement(n.Footer,{className:o[zn.Footer],style:C==null?void 0:C[zn.Footer],role:"status","aria-live":"polite"},t.footer)))}function N5e({className:e,classNames:t,showOutsideDays:n=!0,captionLayout:r="label",buttonVariant:s="ghost",formatters:i,components:a,...o}){const l=hF();return f.jsx(R5e,{showOutsideDays:n,className:Ye("bg-background group/calendar p-3 [--cell-size:--spacing(8)] [[data-slot=card-content]_&]:bg-transparent [[data-slot=popover-content]_&]:bg-transparent",String.raw`rtl:**:[.rdp-button\_next>svg]:rotate-180`,String.raw`rtl:**:[.rdp-button\_previous>svg]:rotate-180`,e),captionLayout:r,formatters:{formatMonthDropdown:c=>c.toLocaleString("default",{month:"short"}),...i},classNames:{root:Ye("w-fit",l.root),months:Ye("flex gap-4 flex-col md:flex-row relative",l.months),month:Ye("flex flex-col w-full gap-4",l.month),nav:Ye("flex items-center gap-1 w-full absolute top-0 inset-x-0 justify-between",l.nav),button_previous:Ye(o3({variant:s}),"size-(--cell-size) aria-disabled:opacity-50 p-0 select-none",l.button_previous),button_next:Ye(o3({variant:s}),"size-(--cell-size) aria-disabled:opacity-50 p-0 select-none",l.button_next),month_caption:Ye("flex items-center justify-center h-(--cell-size) w-full px-(--cell-size)",l.month_caption),dropdowns:Ye("w-full flex items-center text-sm font-medium justify-center h-(--cell-size) gap-1.5",l.dropdowns),dropdown_root:Ye("relative has-focus:border-ring border border-input shadow-xs has-focus:ring-ring/50 has-focus:ring-[3px] rounded-md",l.dropdown_root),dropdown:Ye("absolute inset-0 opacity-0",l.dropdown),caption_label:Ye("select-none font-medium",r==="label"?"text-sm":"rounded-md pl-2 pr-1 flex items-center gap-1 text-sm h-8 [&>svg]:text-muted-foreground [&>svg]:size-3.5",l.caption_label),table:"w-full border-collapse",weekdays:Ye("flex",l.weekdays),weekday:Ye("text-muted-foreground rounded-md flex-1 font-normal text-[0.8rem] select-none",l.weekday),week:Ye("flex w-full mt-2",l.week),week_number_header:Ye("select-none w-(--cell-size)",l.week_number_header),week_number:Ye("text-[0.8rem] select-none text-muted-foreground",l.week_number),day:Ye("relative w-full h-full p-0 text-center [&:first-child[data-selected=true]_button]:rounded-l-md [&:last-child[data-selected=true]_button]:rounded-r-md group/day aspect-square select-none",l.day),range_start:Ye("rounded-l-md bg-accent",l.range_start),range_middle:Ye("rounded-none",l.range_middle),range_end:Ye("rounded-r-md bg-accent",l.range_end),today:Ye("bg-accent text-accent-foreground rounded-md data-[selected=true]:rounded-none",l.today),outside:Ye("text-muted-foreground aria-selected:text-muted-foreground",l.outside),disabled:Ye("text-muted-foreground opacity-50",l.disabled),hidden:Ye("invisible",l.hidden),...t},components:{Root:({className:c,rootRef:u,...d})=>f.jsx("div",{"data-slot":"calendar",ref:u,className:Ye(c),...d}),Chevron:({className:c,orientation:u,...d})=>u==="left"?f.jsx(ime,{className:Ye("size-4",c),...d}):u==="right"?f.jsx(X4,{className:Ye("size-4",c),...d}):f.jsx(uc,{className:Ye("size-4",c),...d}),DayButton:I5e,WeekNumber:({children:c,...u})=>f.jsx("td",{...u,children:f.jsx("div",{className:"flex size-(--cell-size) items-center justify-center text-center",children:c})}),...a},...o})}function I5e({className:e,day:t,modifiers:n,...r}){const s=hF(),i=E.useRef(null);return E.useEffect(()=>{var a;n.focused&&((a=i.current)==null||a.focus())},[n.focused]),f.jsx(ot,{ref:i,variant:"ghost",size:"icon","data-day":t.date.toLocaleDateString(),"data-selected-single":n.selected&&!n.range_start&&!n.range_end&&!n.range_middle,"data-range-start":n.range_start,"data-range-end":n.range_end,"data-range-middle":n.range_middle,className:Ye("data-[selected-single=true]:bg-primary data-[selected-single=true]:text-primary-foreground data-[range-middle=true]:bg-accent data-[range-middle=true]:text-accent-foreground data-[range-start=true]:bg-primary data-[range-start=true]:text-primary-foreground data-[range-end=true]:bg-primary data-[range-end=true]:text-primary-foreground group-data-[focused=true]/day:border-ring group-data-[focused=true]/day:ring-ring/50 dark:hover:text-accent-foreground flex aspect-square size-auto w-full min-w-(--cell-size) flex-col gap-1 leading-none font-normal group-data-[focused=true]/day:relative group-data-[focused=true]/day:z-10 group-data-[focused=true]/day:ring-[3px] data-[range-end=true]:rounded-md data-[range-end=true]:rounded-r-md data-[range-middle=true]:rounded-none data-[range-start=true]:rounded-md data-[range-start=true]:rounded-l-md [&>span]:text-xs [&>span]:opacity-70",s.day,e),...r})}var M5e=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],xf=M5e.reduce((e,t)=>{const n=$u(`Primitive.${t}`),r=E.forwardRef((s,i)=>{const{asChild:a,...o}=s,l=a?n:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),f.jsx(l,{...o,ref:i})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{});function j5e(e,t){e&&yl.flushSync(()=>e.dispatchEvent(t))}var P5e="DismissableLayer",bP="dismissableLayer.update",O5e="dismissableLayer.pointerDownOutside",D5e="dismissableLayer.focusOutside",fU,Vee=E.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Wee=E.forwardRef((e,t)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:s,onFocusOutside:i,onInteractOutside:a,onDismiss:o,...l}=e,c=E.useContext(Vee),[u,d]=E.useState(null),h=(u==null?void 0:u.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,m]=E.useState({}),y=Tn(t,A=>d(A)),b=Array.from(c.layers),[v]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),x=b.indexOf(v),w=u?b.indexOf(u):-1,_=c.layersWithOutsidePointerEventsDisabled.size>0,k=w>=x,C=B5e(A=>{const N=A.target,I=[...c.branches].some(j=>j.contains(N));!k||I||(s==null||s(A),a==null||a(A),A.defaultPrevented||o==null||o())},h),T=$5e(A=>{const N=A.target;[...c.branches].some(j=>j.contains(N))||(i==null||i(A),a==null||a(A),A.defaultPrevented||o==null||o())},h);return gO(A=>{w===c.layers.size-1&&(r==null||r(A),!A.defaultPrevented&&o&&(A.preventDefault(),o()))},h),E.useEffect(()=>{if(u)return n&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(fU=h.body.style.pointerEvents,h.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(u)),c.layers.add(u),hU(),()=>{n&&c.layersWithOutsidePointerEventsDisabled.size===1&&(h.body.style.pointerEvents=fU)}},[u,h,n,c]),E.useEffect(()=>()=>{u&&(c.layers.delete(u),c.layersWithOutsidePointerEventsDisabled.delete(u),hU())},[u,c]),E.useEffect(()=>{const A=()=>m({});return document.addEventListener(bP,A),()=>document.removeEventListener(bP,A)},[]),f.jsx(xf.div,{...l,ref:y,style:{pointerEvents:_?k?"auto":"none":void 0,...e.style},onFocusCapture:Wt(e.onFocusCapture,T.onFocusCapture),onBlurCapture:Wt(e.onBlurCapture,T.onBlurCapture),onPointerDownCapture:Wt(e.onPointerDownCapture,C.onPointerDownCapture)})});Wee.displayName=P5e;var F5e="DismissableLayerBranch",L5e=E.forwardRef((e,t)=>{const n=E.useContext(Vee),r=E.useRef(null),s=Tn(t,r);return E.useEffect(()=>{const i=r.current;if(i)return n.branches.add(i),()=>{n.branches.delete(i)}},[n.branches]),f.jsx(xf.div,{...e,ref:s})});L5e.displayName=F5e;function B5e(e,t=globalThis==null?void 0:globalThis.document){const n=Ts(e),r=E.useRef(!1),s=E.useRef(()=>{});return E.useEffect(()=>{const i=o=>{if(o.target&&!r.current){let l=function(){Hee(O5e,n,c,{discrete:!0})};const c={originalEvent:o};o.pointerType==="touch"?(t.removeEventListener("click",s.current),s.current=l,t.addEventListener("click",s.current,{once:!0})):l()}else t.removeEventListener("click",s.current);r.current=!1},a=window.setTimeout(()=>{t.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(a),t.removeEventListener("pointerdown",i),t.removeEventListener("click",s.current)}},[t,n]),{onPointerDownCapture:()=>r.current=!0}}function $5e(e,t=globalThis==null?void 0:globalThis.document){const n=Ts(e),r=E.useRef(!1);return E.useEffect(()=>{const s=i=>{i.target&&!r.current&&Hee(D5e,n,{originalEvent:i},{discrete:!1})};return t.addEventListener("focusin",s),()=>t.removeEventListener("focusin",s)},[t,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function hU(){const e=new CustomEvent(bP);document.dispatchEvent(e)}function Hee(e,t,n,{discrete:r}){const s=n.originalEvent.target,i=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&s.addEventListener(e,t,{once:!0}),r?j5e(s,i):s.dispatchEvent(i)}var rj="focusScope.autoFocusOnMount",sj="focusScope.autoFocusOnUnmount",pU={bubbles:!1,cancelable:!0},z5e="FocusScope",Gee=E.forwardRef((e,t)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:s,onUnmountAutoFocus:i,...a}=e,[o,l]=E.useState(null),c=Ts(s),u=Ts(i),d=E.useRef(null),h=Tn(t,b=>l(b)),m=E.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;E.useEffect(()=>{if(r){let b=function(_){if(m.paused||!o)return;const k=_.target;o.contains(k)?d.current=k:ph(d.current,{select:!0})},v=function(_){if(m.paused||!o)return;const k=_.relatedTarget;k!==null&&(o.contains(k)||ph(d.current,{select:!0}))},x=function(_){if(document.activeElement===document.body)for(const C of _)C.removedNodes.length>0&&ph(o)};document.addEventListener("focusin",b),document.addEventListener("focusout",v);const w=new MutationObserver(x);return o&&w.observe(o,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",b),document.removeEventListener("focusout",v),w.disconnect()}}},[r,o,m.paused]),E.useEffect(()=>{if(o){gU.add(m);const b=document.activeElement;if(!o.contains(b)){const x=new CustomEvent(rj,pU);o.addEventListener(rj,c),o.dispatchEvent(x),x.defaultPrevented||(U5e(G5e(Kee(o)),{select:!0}),document.activeElement===b&&ph(o))}return()=>{o.removeEventListener(rj,c),setTimeout(()=>{const x=new CustomEvent(sj,pU);o.addEventListener(sj,u),o.dispatchEvent(x),x.defaultPrevented||ph(b??document.body,{select:!0}),o.removeEventListener(sj,u),gU.remove(m)},0)}}},[o,c,u,m]);const y=E.useCallback(b=>{if(!n&&!r||m.paused)return;const v=b.key==="Tab"&&!b.altKey&&!b.ctrlKey&&!b.metaKey,x=document.activeElement;if(v&&x){const w=b.currentTarget,[_,k]=q5e(w);_&&k?!b.shiftKey&&x===k?(b.preventDefault(),n&&ph(_,{select:!0})):b.shiftKey&&x===_&&(b.preventDefault(),n&&ph(k,{select:!0})):x===w&&b.preventDefault()}},[n,r,m.paused]);return f.jsx(xf.div,{tabIndex:-1,...a,ref:h,onKeyDown:y})});Gee.displayName=z5e;function U5e(e,{select:t=!1}={}){const n=document.activeElement;for(const r of e)if(ph(r,{select:t}),document.activeElement!==n)return}function q5e(e){const t=Kee(e),n=mU(t,e),r=mU(t.reverse(),e);return[n,r]}function Kee(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const s=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||s?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function mU(e,t){for(const n of e)if(!V5e(n,{upTo:t}))return n}function V5e(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function W5e(e){return e instanceof HTMLInputElement&&"select"in e}function ph(e,{select:t=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&W5e(e)&&t&&e.select()}}var gU=H5e();function H5e(){let e=[];return{add(t){const n=e[0];t!==n&&(n==null||n.pause()),e=yU(e,t),e.unshift(t)},remove(t){var n;e=yU(e,t),(n=e[0])==null||n.resume()}}}function yU(e,t){const n=[...e],r=n.indexOf(t);return r!==-1&&n.splice(r,1),n}function G5e(e){return e.filter(t=>t.tagName!=="A")}var K5e="Arrow",Yee=E.forwardRef((e,t)=>{const{children:n,width:r=10,height:s=5,...i}=e;return f.jsx(xf.svg,{...i,ref:t,width:r,height:s,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?n:f.jsx("polygon",{points:"0,0 30,0 15,10"})})});Yee.displayName=K5e;var Y5e=Yee,pF="Popper",[Zee,Xee]=Ei(pF),[Z5e,Jee]=Zee(pF),Qee=e=>{const{__scopePopper:t,children:n}=e,[r,s]=E.useState(null);return f.jsx(Z5e,{scope:t,anchor:r,onAnchorChange:s,children:n})};Qee.displayName=pF;var ete="PopperAnchor",tte=E.forwardRef((e,t)=>{const{__scopePopper:n,virtualRef:r,...s}=e,i=Jee(ete,n),a=E.useRef(null),o=Tn(t,a);return E.useEffect(()=>{i.onAnchorChange((r==null?void 0:r.current)||a.current)}),r?null:f.jsx(xf.div,{...s,ref:o})});tte.displayName=ete;var mF="PopperContent",[X5e,J5e]=Zee(mF),nte=E.forwardRef((e,t)=>{var je,Te,_e,Ue,Qe,We;const{__scopePopper:n,side:r="bottom",sideOffset:s=0,align:i="center",alignOffset:a=0,arrowPadding:o=0,avoidCollisions:l=!0,collisionBoundary:c=[],collisionPadding:u=0,sticky:d="partial",hideWhenDetached:h=!1,updatePositionStrategy:m="optimized",onPlaced:y,...b}=e,v=Jee(mF,n),[x,w]=E.useState(null),_=Tn(t,Pe=>w(Pe)),[k,C]=E.useState(null),T=Zm(k),A=(T==null?void 0:T.width)??0,N=(T==null?void 0:T.height)??0,I=r+(i!=="center"?"-"+i:""),j=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},L=Array.isArray(c)?c:[c],D=L.length>0,H={padding:j,boundary:L.filter(e8e),altBoundary:D},{refs:O,floatingStyles:K,placement:U,isPositioned:W,middlewareData:B}=kO({strategy:"fixed",placement:I,whileElementsMounted:(...Pe)=>CO(...Pe,{animationFrame:m==="always"}),elements:{reference:v.anchor},middleware:[EO({mainAxis:s+N,alignmentAxis:a}),l&&TO({mainAxis:!0,crossAxis:!1,limiter:d==="partial"?AO():void 0,...H}),l&&RO({...H}),NO({...H,apply:({elements:Pe,rects:Y,availableWidth:ye,availableHeight:Me})=>{const{width:ue,height:oe}=Y.reference,se=Pe.floating.style;se.setProperty("--radix-popper-available-width",`${ye}px`),se.setProperty("--radix-popper-available-height",`${Me}px`),se.setProperty("--radix-popper-anchor-width",`${ue}px`),se.setProperty("--radix-popper-anchor-height",`${oe}px`)}}),k&&MO({element:k,padding:o}),t8e({arrowWidth:A,arrowHeight:N}),h&&IO({strategy:"referenceHidden",...H})]}),[ne,V]=ite(U),Q=Ts(y);ii(()=>{W&&(Q==null||Q())},[W,Q]);const ee=(je=B.arrow)==null?void 0:je.x,re=(Te=B.arrow)==null?void 0:Te.y,de=((_e=B.arrow)==null?void 0:_e.centerOffset)!==0,[me,De]=E.useState();return ii(()=>{x&&De(window.getComputedStyle(x).zIndex)},[x]),f.jsx("div",{ref:O.setFloating,"data-radix-popper-content-wrapper":"",style:{...K,transform:W?K.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:me,"--radix-popper-transform-origin":[(Ue=B.transformOrigin)==null?void 0:Ue.x,(Qe=B.transformOrigin)==null?void 0:Qe.y].join(" "),...((We=B.hide)==null?void 0:We.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:f.jsx(X5e,{scope:n,placedSide:ne,onArrowChange:C,arrowX:ee,arrowY:re,shouldHideArrow:de,children:f.jsx(xf.div,{"data-side":ne,"data-align":V,...b,ref:_,style:{...b.style,animation:W?void 0:"none"}})})})});nte.displayName=mF;var rte="PopperArrow",Q5e={top:"bottom",right:"left",bottom:"top",left:"right"},ste=E.forwardRef(function(t,n){const{__scopePopper:r,...s}=t,i=J5e(rte,r),a=Q5e[i.placedSide];return f.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[a]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:f.jsx(Y5e,{...s,ref:n,style:{...s.style,display:"block"}})})});ste.displayName=rte;function e8e(e){return e!==null}var t8e=e=>({name:"transformOrigin",options:e,fn(t){var v,x,w;const{placement:n,rects:r,middlewareData:s}=t,a=((v=s.arrow)==null?void 0:v.centerOffset)!==0,o=a?0:e.arrowWidth,l=a?0:e.arrowHeight,[c,u]=ite(n),d={start:"0%",center:"50%",end:"100%"}[u],h=(((x=s.arrow)==null?void 0:x.x)??0)+o/2,m=(((w=s.arrow)==null?void 0:w.y)??0)+l/2;let y="",b="";return c==="bottom"?(y=a?d:`${h}px`,b=`${-l}px`):c==="top"?(y=a?d:`${h}px`,b=`${r.floating.height+l}px`):c==="right"?(y=`${-l}px`,b=a?d:`${m}px`):c==="left"&&(y=`${r.floating.width+l}px`,b=a?d:`${m}px`),{data:{x:y,y:b}}}});function ite(e){const[t,n="center"]=e.split("-");return[t,n]}var n8e=Qee,ate=tte,r8e=nte,s8e=ste,i8e="Portal",ote=E.forwardRef((e,t)=>{var o;const{container:n,...r}=e,[s,i]=E.useState(!1);ii(()=>i(!0),[]);const a=n||s&&((o=globalThis==null?void 0:globalThis.document)==null?void 0:o.body);return a?PE.createPortal(f.jsx(xf.div,{...r,ref:t}),a):null});ote.displayName=i8e;var UT="Popover",[lte,Dft]=Ei(UT,[Xee]),uS=Xee(),[a8e,gp]=lte(UT),cte=e=>{const{__scopePopover:t,children:n,open:r,defaultOpen:s,onOpenChange:i,modal:a=!1}=e,o=uS(t),l=E.useRef(null),[c,u]=E.useState(!1),[d,h]=rc({prop:r,defaultProp:s??!1,onChange:i,caller:UT});return f.jsx(n8e,{...o,children:f.jsx(a8e,{scope:t,contentId:pa(),triggerRef:l,open:d,onOpenChange:h,onOpenToggle:E.useCallback(()=>h(m=>!m),[h]),hasCustomAnchor:c,onCustomAnchorAdd:E.useCallback(()=>u(!0),[]),onCustomAnchorRemove:E.useCallback(()=>u(!1),[]),modal:a,children:n})})};cte.displayName=UT;var ute="PopoverAnchor",o8e=E.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,s=gp(ute,n),i=uS(n),{onCustomAnchorAdd:a,onCustomAnchorRemove:o}=s;return E.useEffect(()=>(a(),()=>o()),[a,o]),f.jsx(ate,{...i,...r,ref:t})});o8e.displayName=ute;var dte="PopoverTrigger",fte=E.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,s=gp(dte,n),i=uS(n),a=Tn(t,s.triggerRef),o=f.jsx(xf.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":yte(s.open),...r,ref:a,onClick:Wt(e.onClick,s.onOpenToggle)});return s.hasCustomAnchor?o:f.jsx(ate,{asChild:!0,...i,children:o})});fte.displayName=dte;var gF="PopoverPortal",[l8e,c8e]=lte(gF,{forceMount:void 0}),hte=e=>{const{__scopePopover:t,forceMount:n,children:r,container:s}=e,i=gp(gF,t);return f.jsx(l8e,{scope:t,forceMount:n,children:f.jsx(ea,{present:n||i.open,children:f.jsx(ote,{asChild:!0,container:s,children:r})})})};hte.displayName=gF;var Dy="PopoverContent",pte=E.forwardRef((e,t)=>{const n=c8e(Dy,e.__scopePopover),{forceMount:r=n.forceMount,...s}=e,i=gp(Dy,e.__scopePopover);return f.jsx(ea,{present:r||i.open,children:i.modal?f.jsx(d8e,{...s,ref:t}):f.jsx(f8e,{...s,ref:t})})});pte.displayName=Dy;var u8e=$u("PopoverContent.RemoveScroll"),d8e=E.forwardRef((e,t)=>{const n=gp(Dy,e.__scopePopover),r=E.useRef(null),s=Tn(t,r),i=E.useRef(!1);return E.useEffect(()=>{const a=r.current;if(a)return PT(a)},[]),f.jsx(oS,{as:u8e,allowPinchZoom:!0,children:f.jsx(mte,{...e,ref:s,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Wt(e.onCloseAutoFocus,a=>{var o;a.preventDefault(),i.current||(o=n.triggerRef.current)==null||o.focus()}),onPointerDownOutside:Wt(e.onPointerDownOutside,a=>{const o=a.detail.originalEvent,l=o.button===0&&o.ctrlKey===!0,c=o.button===2||l;i.current=c},{checkForDefaultPrevented:!1}),onFocusOutside:Wt(e.onFocusOutside,a=>a.preventDefault(),{checkForDefaultPrevented:!1})})})}),f8e=E.forwardRef((e,t)=>{const n=gp(Dy,e.__scopePopover),r=E.useRef(!1),s=E.useRef(!1);return f.jsx(mte,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var a,o;(a=e.onCloseAutoFocus)==null||a.call(e,i),i.defaultPrevented||(r.current||(o=n.triggerRef.current)==null||o.focus(),i.preventDefault()),r.current=!1,s.current=!1},onInteractOutside:i=>{var l,c;(l=e.onInteractOutside)==null||l.call(e,i),i.defaultPrevented||(r.current=!0,i.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const a=i.target;((c=n.triggerRef.current)==null?void 0:c.contains(a))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&s.current&&i.preventDefault()}})}),mte=E.forwardRef((e,t)=>{const{__scopePopover:n,trapFocus:r,onOpenAutoFocus:s,onCloseAutoFocus:i,disableOutsidePointerEvents:a,onEscapeKeyDown:o,onPointerDownOutside:l,onFocusOutside:c,onInteractOutside:u,...d}=e,h=gp(Dy,n),m=uS(n);return jT(),f.jsx(Gee,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:s,onUnmountAutoFocus:i,children:f.jsx(Wee,{asChild:!0,disableOutsidePointerEvents:a,onInteractOutside:u,onEscapeKeyDown:o,onPointerDownOutside:l,onFocusOutside:c,onDismiss:()=>h.onOpenChange(!1),children:f.jsx(r8e,{"data-state":yte(h.open),role:"dialog",id:h.contentId,...m,...d,ref:t,style:{...d.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),gte="PopoverClose",h8e=E.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,s=gp(gte,n);return f.jsx(xf.button,{type:"button",...r,ref:t,onClick:Wt(e.onClick,()=>s.onOpenChange(!1))})});h8e.displayName=gte;var p8e="PopoverArrow",m8e=E.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,s=uS(n);return f.jsx(s8e,{...s,...r,ref:t})});m8e.displayName=p8e;function yte(e){return e?"open":"closed"}var g8e=cte,y8e=fte,b8e=hte,v8e=pte;function gc({...e}){return f.jsx(g8e,{"data-slot":"popover",...e})}function yc({...e}){return f.jsx(y8e,{"data-slot":"popover-trigger",...e})}function bc({className:e,align:t="center",sideOffset:n=4,...r}){return f.jsx(b8e,{children:f.jsx(v8e,{"data-slot":"popover-content",align:t,sideOffset:n,className:Ye("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-72 origin-(--radix-popover-content-transform-origin) rounded-md border p-4 shadow-md outline-hidden",e),...r})})}const x8e=({fieldApi:e,label:t,placeholder:n="Pick a date",description:r,inputClassName:s,labelClassName:i,wrapperClassName:a})=>{const[o,l]=Ve.useState(!1),c=e.state.value?e.state.value instanceof Date?e.state.value:typeof e.state.value=="string"?wRe(e.state.value):void 0:void 0,u=d=>{e.handleChange(d),e.handleBlur(),l(!1)};return f.jsxs("div",{className:Ye("space-y-1.5",a),children:[t&&f.jsx(Nt,{htmlFor:e.name+"-trigger",className:Ye("text-sm font-medium",i),children:t}),r&&f.jsx("p",{className:"text-xs text-muted-foreground",children:r}),f.jsxs(gc,{open:o,onOpenChange:l,children:[f.jsx(yc,{asChild:!0,children:f.jsxs(ot,{id:e.name+"-trigger",variant:"outline",className:Ye("w-full justify-start text-left font-normal",!c&&"text-muted-foreground",s,e.state.meta.errors.length?"border-destructive":""),disabled:e.form.state.isSubmitting,onBlur:e.handleBlur,children:[f.jsx(Qpe,{className:"mr-2 h-4 w-4"}),c?Vd(c,"PPP"):f.jsx("span",{children:n})]})}),f.jsx(bc,{className:"w-auto p-0",children:f.jsx(N5e,{mode:"single",selected:c,onSelect:u,initialFocus:!0,disabled:e.form.state.isSubmitting})})]}),e.state.meta.isTouched&&e.state.meta.errors.length>0&&f.jsx("div",{className:"text-xs text-destructive pt-1",children:e.state.meta.errors.map((d,h)=>f.jsx("p",{children:String(d)},h))})]})};function bU(e){const t=w8e(e),n=E.forwardRef((r,s)=>{const{children:i,...a}=r,o=E.Children.toArray(i),l=o.find(_8e);if(l){const c=l.props.children,u=o.map(d=>d===l?E.Children.count(c)>1?E.Children.only(null):E.isValidElement(c)?c.props.children:null:d);return f.jsx(t,{...a,ref:s,children:E.isValidElement(c)?E.cloneElement(c,void 0,u):null})}return f.jsx(t,{...a,ref:s,children:i})});return n.displayName=`${e}.Slot`,n}function w8e(e){const t=E.forwardRef((n,r)=>{const{children:s,...i}=n;if(E.isValidElement(s)){const a=k8e(s),o=C8e(i,s.props);return s.type!==E.Fragment&&(o.ref=r?wl(r,a):a),E.cloneElement(s,o)}return E.Children.count(s)>1?E.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var S8e=Symbol("radix.slottable");function _8e(e){return E.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===S8e}function C8e(e,t){const n={...t};for(const r in t){const s=e[r],i=t[r];/^on[A-Z]/.test(r)?s&&i?n[r]=(...o)=>{i(...o),s(...o)}:s&&(n[r]=s):r==="style"?n[r]={...s,...i}:r==="className"&&(n[r]=[s,i].filter(Boolean).join(" "))}return{...e,...n}}function k8e(e){var r,s;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(s=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:s.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}function yF(e){const t=e+"CollectionProvider",[n,r]=Ei(t),[s,i]=n(t,{collectionRef:{current:null},itemMap:new Map}),a=b=>{const{scope:v,children:x}=b,w=Ve.useRef(null),_=Ve.useRef(new Map).current;return f.jsx(s,{scope:v,itemMap:_,collectionRef:w,children:x})};a.displayName=t;const o=e+"CollectionSlot",l=bU(o),c=Ve.forwardRef((b,v)=>{const{scope:x,children:w}=b,_=i(o,x),k=Tn(v,_.collectionRef);return f.jsx(l,{ref:k,children:w})});c.displayName=o;const u=e+"CollectionItemSlot",d="data-radix-collection-item",h=bU(u),m=Ve.forwardRef((b,v)=>{const{scope:x,children:w,..._}=b,k=Ve.useRef(null),C=Tn(v,k),T=i(u,x);return Ve.useEffect(()=>(T.itemMap.set(k,{ref:k,..._}),()=>void T.itemMap.delete(k))),f.jsx(h,{[d]:"",ref:C,children:w})});m.displayName=u;function y(b){const v=i(e+"CollectionConsumer",b);return Ve.useCallback(()=>{const w=v.collectionRef.current;if(!w)return[];const _=Array.from(w.querySelectorAll(`[${d}]`));return Array.from(v.itemMap.values()).sort((T,A)=>_.indexOf(T.ref.current)-_.indexOf(A.ref.current))},[v.collectionRef,v.itemMap])}return[{Provider:a,Slot:c,ItemSlot:m},y,r]}var bte=["PageUp","PageDown"],vte=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],xte={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},Sb="Slider",[vP,E8e,T8e]=yF(Sb),[wte,Fft]=Ei(Sb,[T8e]),[A8e,qT]=wte(Sb),Ste=E.forwardRef((e,t)=>{const{name:n,min:r=0,max:s=100,step:i=1,orientation:a="horizontal",disabled:o=!1,minStepsBetweenThumbs:l=0,defaultValue:c=[r],value:u,onValueChange:d=()=>{},onValueCommit:h=()=>{},inverted:m=!1,form:y,...b}=e,v=E.useRef(new Set),x=E.useRef(0),_=a==="horizontal"?R8e:N8e,[k=[],C]=rc({prop:u,defaultProp:c,onChange:L=>{var H;(H=[...v.current][x.current])==null||H.focus(),d(L)}}),T=E.useRef(k);function A(L){const D=O8e(k,L);j(L,D)}function N(L){j(L,x.current)}function I(){const L=T.current[x.current];k[x.current]!==L&&h(k)}function j(L,D,{commit:H}={commit:!1}){const O=B8e(i),K=$8e(Math.round((L-r)/i)*i+r,O),U=Kw(K,[r,s]);C((W=[])=>{const B=j8e(W,U,D);if(L8e(B,l*i)){x.current=B.indexOf(U);const ne=String(B)!==String(W);return ne&&H&&h(B),ne?B:W}else return W})}return f.jsx(A8e,{scope:e.__scopeSlider,name:n,disabled:o,min:r,max:s,valueIndexToChangeRef:x,thumbs:v.current,values:k,orientation:a,form:y,children:f.jsx(vP.Provider,{scope:e.__scopeSlider,children:f.jsx(vP.Slot,{scope:e.__scopeSlider,children:f.jsx(_,{"aria-disabled":o,"data-disabled":o?"":void 0,...b,ref:t,onPointerDown:Wt(b.onPointerDown,()=>{o||(T.current=k)}),min:r,max:s,inverted:m,onSlideStart:o?void 0:A,onSlideMove:o?void 0:N,onSlideEnd:o?void 0:I,onHomeKeyDown:()=>!o&&j(r,0,{commit:!0}),onEndKeyDown:()=>!o&&j(s,k.length-1,{commit:!0}),onStepKeyDown:({event:L,direction:D})=>{if(!o){const K=bte.includes(L.key)||L.shiftKey&&vte.includes(L.key)?10:1,U=x.current,W=k[U],B=i*K*D;j(W+B,U,{commit:!0})}}})})})})});Ste.displayName=Sb;var[_te,Cte]=wte(Sb,{startEdge:"left",endEdge:"right",size:"width",direction:1}),R8e=E.forwardRef((e,t)=>{const{min:n,max:r,dir:s,inverted:i,onSlideStart:a,onSlideMove:o,onSlideEnd:l,onStepKeyDown:c,...u}=e,[d,h]=E.useState(null),m=Tn(t,_=>h(_)),y=E.useRef(void 0),b=cg(s),v=b==="ltr",x=v&&!i||!v&&i;function w(_){const k=y.current||d.getBoundingClientRect(),C=[0,k.width],A=bF(C,x?[n,r]:[r,n]);return y.current=k,A(_-k.left)}return f.jsx(_te,{scope:e.__scopeSlider,startEdge:x?"left":"right",endEdge:x?"right":"left",direction:x?1:-1,size:"width",children:f.jsx(kte,{dir:b,"data-orientation":"horizontal",...u,ref:m,style:{...u.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:_=>{const k=w(_.clientX);a==null||a(k)},onSlideMove:_=>{const k=w(_.clientX);o==null||o(k)},onSlideEnd:()=>{y.current=void 0,l==null||l()},onStepKeyDown:_=>{const C=xte[x?"from-left":"from-right"].includes(_.key);c==null||c({event:_,direction:C?-1:1})}})})}),N8e=E.forwardRef((e,t)=>{const{min:n,max:r,inverted:s,onSlideStart:i,onSlideMove:a,onSlideEnd:o,onStepKeyDown:l,...c}=e,u=E.useRef(null),d=Tn(t,u),h=E.useRef(void 0),m=!s;function y(b){const v=h.current||u.current.getBoundingClientRect(),x=[0,v.height],_=bF(x,m?[r,n]:[n,r]);return h.current=v,_(b-v.top)}return f.jsx(_te,{scope:e.__scopeSlider,startEdge:m?"bottom":"top",endEdge:m?"top":"bottom",size:"height",direction:m?1:-1,children:f.jsx(kte,{"data-orientation":"vertical",...c,ref:d,style:{...c.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:b=>{const v=y(b.clientY);i==null||i(v)},onSlideMove:b=>{const v=y(b.clientY);a==null||a(v)},onSlideEnd:()=>{h.current=void 0,o==null||o()},onStepKeyDown:b=>{const x=xte[m?"from-bottom":"from-top"].includes(b.key);l==null||l({event:b,direction:x?-1:1})}})})}),kte=E.forwardRef((e,t)=>{const{__scopeSlider:n,onSlideStart:r,onSlideMove:s,onSlideEnd:i,onHomeKeyDown:a,onEndKeyDown:o,onStepKeyDown:l,...c}=e,u=qT(Sb,n);return f.jsx(Kn.span,{...c,ref:t,onKeyDown:Wt(e.onKeyDown,d=>{d.key==="Home"?(a(d),d.preventDefault()):d.key==="End"?(o(d),d.preventDefault()):bte.concat(vte).includes(d.key)&&(l(d),d.preventDefault())}),onPointerDown:Wt(e.onPointerDown,d=>{const h=d.target;h.setPointerCapture(d.pointerId),d.preventDefault(),u.thumbs.has(h)?h.focus():r(d)}),onPointerMove:Wt(e.onPointerMove,d=>{d.target.hasPointerCapture(d.pointerId)&&s(d)}),onPointerUp:Wt(e.onPointerUp,d=>{const h=d.target;h.hasPointerCapture(d.pointerId)&&(h.releasePointerCapture(d.pointerId),i(d))})})}),Ete="SliderTrack",Tte=E.forwardRef((e,t)=>{const{__scopeSlider:n,...r}=e,s=qT(Ete,n);return f.jsx(Kn.span,{"data-disabled":s.disabled?"":void 0,"data-orientation":s.orientation,...r,ref:t})});Tte.displayName=Ete;var xP="SliderRange",Ate=E.forwardRef((e,t)=>{const{__scopeSlider:n,...r}=e,s=qT(xP,n),i=Cte(xP,n),a=E.useRef(null),o=Tn(t,a),l=s.values.length,c=s.values.map(h=>Ite(h,s.min,s.max)),u=l>1?Math.min(...c):0,d=100-Math.max(...c);return f.jsx(Kn.span,{"data-orientation":s.orientation,"data-disabled":s.disabled?"":void 0,...r,ref:o,style:{...e.style,[i.startEdge]:u+"%",[i.endEdge]:d+"%"}})});Ate.displayName=xP;var wP="SliderThumb",Rte=E.forwardRef((e,t)=>{const n=E8e(e.__scopeSlider),[r,s]=E.useState(null),i=Tn(t,o=>s(o)),a=E.useMemo(()=>r?n().findIndex(o=>o.ref.current===r):-1,[n,r]);return f.jsx(I8e,{...e,ref:i,index:a})}),I8e=E.forwardRef((e,t)=>{const{__scopeSlider:n,index:r,name:s,...i}=e,a=qT(wP,n),o=Cte(wP,n),[l,c]=E.useState(null),u=Tn(t,w=>c(w)),d=l?a.form||!!l.closest("form"):!0,h=Zm(l),m=a.values[r],y=m===void 0?0:Ite(m,a.min,a.max),b=P8e(r,a.values.length),v=h==null?void 0:h[o.size],x=v?D8e(v,y,o.direction):0;return E.useEffect(()=>{if(l)return a.thumbs.add(l),()=>{a.thumbs.delete(l)}},[l,a.thumbs]),f.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[o.startEdge]:`calc(${y}% + ${x}px)`},children:[f.jsx(vP.ItemSlot,{scope:e.__scopeSlider,children:f.jsx(Kn.span,{role:"slider","aria-label":e["aria-label"]||b,"aria-valuemin":a.min,"aria-valuenow":m,"aria-valuemax":a.max,"aria-orientation":a.orientation,"data-orientation":a.orientation,"data-disabled":a.disabled?"":void 0,tabIndex:a.disabled?void 0:0,...i,ref:u,style:m===void 0?{display:"none"}:e.style,onFocus:Wt(e.onFocus,()=>{a.valueIndexToChangeRef.current=r})})}),d&&f.jsx(Nte,{name:s??(a.name?a.name+(a.values.length>1?"[]":""):void 0),form:a.form,value:m},r)]})});Rte.displayName=wP;var M8e="RadioBubbleInput",Nte=E.forwardRef(({__scopeSlider:e,value:t,...n},r)=>{const s=E.useRef(null),i=Tn(s,r),a=aS(t);return E.useEffect(()=>{const o=s.current;if(!o)return;const l=window.HTMLInputElement.prototype,u=Object.getOwnPropertyDescriptor(l,"value").set;if(a!==t&&u){const d=new Event("input",{bubbles:!0});u.call(o,t),o.dispatchEvent(d)}},[a,t]),f.jsx(Kn.input,{style:{display:"none"},...n,ref:i,defaultValue:t})});Nte.displayName=M8e;function j8e(e=[],t,n){const r=[...e];return r[n]=t,r.sort((s,i)=>s-i)}function Ite(e,t,n){const i=100/(n-t)*(e-t);return Kw(i,[0,100])}function P8e(e,t){return t>2?`Value ${e+1} of ${t}`:t===2?["Minimum","Maximum"][e]:void 0}function O8e(e,t){if(e.length===1)return 0;const n=e.map(s=>Math.abs(s-t)),r=Math.min(...n);return n.indexOf(r)}function D8e(e,t,n){const r=e/2,i=bF([0,50],[0,r]);return(r-i(t)*n)*n}function F8e(e){return e.slice(0,-1).map((t,n)=>e[n+1]-t)}function L8e(e,t){if(t>0){const n=F8e(e);return Math.min(...n)>=t}return!0}function bF(e,t){return n=>{if(e[0]===e[1]||t[0]===t[1])return t[0];const r=(t[1]-t[0])/(e[1]-e[0]);return t[0]+r*(n-e[0])}}function B8e(e){return(String(e).split(".")[1]||"").length}function $8e(e,t){const n=Math.pow(10,t);return Math.round(e*n)/n}var z8e=Ste,U8e=Tte,q8e=Ate,V8e=Rte;function P0({className:e,defaultValue:t,value:n,min:r=0,max:s=100,...i}){const a=E.useMemo(()=>Array.isArray(n)?n:Array.isArray(t)?t:[r,s],[n,t,r,s]);return f.jsxs(z8e,{"data-slot":"slider",defaultValue:t,value:n,min:r,max:s,className:Ye("relative flex w-full touch-none items-center select-none data-[disabled]:opacity-50 data-[orientation=vertical]:h-full data-[orientation=vertical]:min-h-44 data-[orientation=vertical]:w-auto data-[orientation=vertical]:flex-col",e),...i,children:[f.jsx(U8e,{"data-slot":"slider-track",className:Ye("bg-muted relative grow overflow-hidden rounded-full data-[orientation=horizontal]:h-1.5 data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-1.5"),children:f.jsx(q8e,{"data-slot":"slider-range",className:Ye("bg-primary absolute data-[orientation=horizontal]:h-full data-[orientation=vertical]:w-full")})}),Array.from({length:a.length},(o,l)=>f.jsx(V8e,{"data-slot":"slider-thumb",className:"border-primary bg-background ring-ring/50 block size-4 shrink-0 rounded-full border shadow-sm transition-[color,box-shadow] hover:ring-4 focus-visible:ring-4 focus-visible:outline-hidden disabled:pointer-events-none disabled:opacity-50"},l))]})}const W8e=({fieldApi:e,label:t,description:n,min:r=0,max:s=100,step:i=1,valueLabelPrefix:a="",valueLabelSuffix:o="",valueDisplayPrecision:l=0,showRawValue:c=!1,wrapperClassName:u,inputClassName:d,labelClassName:h})=>{const{name:m,state:y,handleChange:b,handleBlur:v}=e,x=typeof y.value=="number"?y.value:r,w=x.toFixed(l);return f.jsxs("div",{className:Ye("space-y-1.5",u),children:[t&&f.jsxs(Nt,{htmlFor:m,className:Ye("text-sm font-medium",h),children:[t," (",a,w,o,")",c&&f.jsxs("span",{className:"text-xs text-muted-foreground ml-2",children:["(Raw: ",y.value,")"]})]}),n&&f.jsx("p",{className:"text-xs text-muted-foreground",children:n}),f.jsx(P0,{id:m,name:m,value:[x],onValueChange:_=>b(_[0]),onBlur:v,disabled:e.form.state.isSubmitting,min:r,max:s,step:i,className:Ye(d,y.meta.errors.length?"border-destructive":"")}),y.meta.isTouched&&y.meta.errors.length>0&&f.jsx("div",{className:"text-xs text-destructive pt-1",children:y.meta.errors.map((_,k)=>f.jsx("p",{children:typeof _=="string"?_:(_==null?void 0:_.message)||"Invalid"},k))})]})},H8e=({fieldApi:e,label:t,accept:n,className:r,wrapperClassName:s,description:i})=>{const{name:a,state:o,handleChange:l,handleBlur:c}=e,u=o.value,d=y=>{var v;const b=((v=y.target.files)==null?void 0:v[0])??null;l(b),c()},h=()=>{l(null);const y=document.getElementById(a);y&&(y.value=""),c()},m=()=>{const y=document.getElementById(a);y==null||y.click()};return f.jsxs("div",{className:Ye("space-y-1.5",s),children:[t&&f.jsx(Nt,{className:"text-sm font-medium cursor-pointer",onClick:m,children:t}),i&&f.jsx("p",{className:"text-xs text-muted-foreground",children:i}),f.jsx(vn,{id:a,name:a,type:"file",accept:n,onChange:d,className:"hidden"}),u?f.jsxs("div",{className:"flex items-center justify-between p-2.5 border rounded-lg bg-muted/40 shadow-sm hover:shadow-md transition-shadow",children:[f.jsxs("div",{className:"flex items-center gap-2 text-sm overflow-hidden",children:[f.jsx(RE,{className:"h-5 w-5 text-primary shrink-0"}),f.jsx("span",{className:"truncate",title:u.name,children:u.name}),f.jsxs("span",{className:"text-xs text-muted-foreground whitespace-nowrap",children:["(",(u.size/1024).toFixed(1)," KB)"]})]}),f.jsx(ot,{type:"button",variant:"ghost",size:"icon",onClick:h,className:"h-7 w-7 text-destructive hover:bg-destructive/10 shrink-0","aria-label":"Remove file",children:f.jsx(Si,{className:"h-4 w-4"})})]}):f.jsxs("button",{type:"button",onClick:m,className:Ye("w-full flex flex-col items-center justify-center p-4 border-2 border-dashed rounded-lg hover:border-primary transition-colors cursor-pointer bg-background hover:bg-muted/50",r,o.meta.errors.length?"border-destructive hover:border-destructive":"border-muted-foreground/50"),children:[f.jsx(J4,{className:"h-8 w-8 text-muted-foreground mb-2"}),f.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Click or drag and drop a file"}),n&&f.jsxs("span",{className:"text-xs text-muted-foreground/80 mt-1",children:["Accepted types: ",n]})]}),o.meta.isTouched&&o.meta.errors.length>0&&f.jsx("div",{className:"text-xs text-destructive pt-1",children:o.meta.errors.map((y,b)=>f.jsx("p",{children:typeof y=="string"?y:(y==null?void 0:y.message)||"Invalid"},b))})]})},G8e={text:gx,email:gx,password:gx,url:gx,textarea:jOe,select:PFe,checkbox:$Fe,switch:KFe,number:YFe,date:x8e,slider:W8e,file:H8e},K8e=({value:e,currentPage:t,totalPages:n,className:r})=>f.jsxs("div",{className:Ye("space-y-2",r),children:[f.jsxs("div",{className:"flex justify-between text-sm text-muted-foreground",children:[f.jsxs("span",{children:["Step ",t," of ",n]}),f.jsxs("span",{children:[Math.round(e),"%"]})]}),f.jsx(Oy,{value:e,className:"h-2"})]}),Y8e=({children:e,title:t,description:n})=>f.jsxs("div",{className:"space-y-6",children:[(t||n)&&f.jsxs("div",{className:"space-y-2",children:[t&&f.jsx("h3",{className:"text-lg font-semibold",children:t}),n&&f.jsx("p",{className:"text-muted-foreground",children:n})]}),f.jsx("div",{className:"space-y-4",children:e})]});function ug(e){const{fields:t=[],schema:n,submitLabel:r="Submit",nextLabel:s="Next",previousLabel:i="Previous",formClassName:a,fieldClassName:o,pages:l=[],progress:c,defaultComponents:u={},globalWrapper:d,formOptions:h,onPageChange:m,autoSubmitOnChange:y=!1,autoSubmitDebounceMs:b=1e3,disabled:v=!1,loading:x=!1,resetOnSubmitSuccess:w=!1,showSubmitButton:_=!0}=e,[k,C]=E.useState(1),T={...G8e,...u},A=E.useMemo(()=>{const V={};return t.forEach(Q=>{const ee=Q.page||1;V[ee]||(V[ee]=[]),V[ee].push(Q)}),V},[t]),N=Math.max(...Object.keys(A).map(Number),1),I=N>1,j=I?(k-1)/(N-1)*100:100,L={...h,...n&&{validators:{onChange:n,...h==null?void 0:h.validators}},...w&&(h==null?void 0:h.onSubmit)&&{onSubmit:async V=>{try{const Q=await h.onSubmit(V);return D.reset(),Q}catch(Q){throw Q}}}},D=ai(L);Ve.useEffect(()=>{const V=[];let Q,ee;if(h!=null&&h.onChange||y){const re=D.store.subscribe(()=>{const de=D,me=de.state.values;h!=null&&h.onChange&&de.state.isValid&&(clearTimeout(ee),ee=setTimeout(()=>{h.onChange({value:me,formApi:de})},300)),y&&!v&&!x&&(clearTimeout(Q),Q=setTimeout(()=>{D.state.canSubmit&&D.handleSubmit()},b))});V.push(re)}return V.push(()=>{clearTimeout(Q),clearTimeout(ee)}),()=>{V.forEach(re=>re())}},[D,y,b,v,x]);const H=()=>A[k]||[],O=()=>l.find(V=>V.page===k),K=()=>{if(k<N){const V=k+1;C(V),m==null||m(V,"next")}},U=()=>{if(k>1){const V=k-1;C(V),m==null||m(V,"previous")}},W=k===N,B=k===1;return{form:D,Form:({className:V,children:Q,onSubmit:ee})=>{const re=_e=>{_e.preventDefault(),_e.stopPropagation(),ee?ee(_e):W?D.handleSubmit():K()},de=Ye("space-y-6",a,V),me=_e=>{const{name:Ue,type:Qe,label:We,placeholder:Pe,description:Y,options:ye,min:Me,max:ue,step:oe,accept:se,multiple:Ie,component:Be,wrapper:Re,conditional:ct,validation:At}=_e;return f.jsx(D.Field,{name:Ue,validators:At?{onChange:At}:void 0,children:ut=>{const Pt=ut.form.state.values;if(ct&&!ct(Pt))return null;const Ut={fieldApi:ut,label:We,placeholder:Pe,description:Y,wrapperClassName:o,min:Me,max:ue,step:oe,accept:se,multiple:Ie,disabled:v||x||ut.form.state.isSubmitting},Ft=Be||T[Qe]||gx,Yt=Qe==="select"?{...Ut,options:ye||[]}:{...Ut,type:["text","email","password","url"].includes(Qe)?Qe:void 0},we=f.jsx(Ft,{...Yt}),F=Re||d;return F?f.jsx(F,{field:_e,children:we}):we}},Ue)},De=()=>{const _e=H(),Ue=O(),Qe=_e.map(Pe=>me(Pe)).filter(Boolean),We=(Ue==null?void 0:Ue.component)||Y8e;return f.jsx(We,{title:Ue==null?void 0:Ue.title,description:Ue==null?void 0:Ue.description,page:k,totalPages:N,children:Qe})},je=()=>{if(!I||!c)return null;const _e=c.component||K8e;return f.jsx(_e,{value:j,currentPage:k,totalPages:N,className:c.className})},Te=()=>_?I?f.jsx(D.Subscribe,{selector:_e=>({canSubmit:_e.canSubmit,isSubmitting:_e.isSubmitting}),children:_e=>{const{canSubmit:Ue,isSubmitting:Qe}=_e;return f.jsxs("div",{className:"flex justify-between gap-4",children:[f.jsx(ot,{type:"button",variant:"outline",onClick:U,disabled:B||v||x,className:B?"invisible":"",children:i}),f.jsx(ot,{type:"submit",disabled:(!Ue||Qe||v||x)&&W,className:"flex-1 max-w-xs",children:x&&W?"Loading...":Qe&&W?"Submitting...":W?r:s})]})}}):f.jsx(D.Subscribe,{selector:_e=>({canSubmit:_e.canSubmit,isSubmitting:_e.isSubmitting}),children:_e=>{const{canSubmit:Ue,isSubmitting:Qe}=_e;return f.jsx(ot,{type:"submit",disabled:!Ue||Qe||v||x,className:"w-full",children:x?"Loading...":Qe?"Submitting...":r})}}):null;return f.jsx("form",{onSubmit:re,className:de,children:Q||f.jsxs(f.Fragment,{children:[je(),De(),Te()]})})},currentPage:k,totalPages:N,goToNextPage:K,goToPreviousPage:U,setCurrentPage:C,isFirstPage:B,isLastPage:W,progressValue:j}}const Z8e=Ke({correctedJson:$e().min(2,"JSON cannot be empty.").refine(e=>{try{return JSON.parse(e),!0}catch{return!1}},{message:"Must be a valid JSON string."})}),X8e=({runId:e,rawAssistantResponse:t})=>{const n=[{name:"correctedJson",type:"textarea",label:"Corrected JSON Data",placeholder:'{ "key": "value", "another_key": 123 }',description:"Enter the valid JSON that should have been produced by the assistant."}];let r="";try{t&&(r=JSON.stringify(JSON.parse(t),null,2))}catch{r=t||""}const{Form:s}=ug({fields:n,schema:Z8e,submitLabel:"Resume Workflow",formOptions:{defaultValues:{correctedJson:r},onSubmit:({value:i})=>{Ce.emit(ws.resumeRequest,{runId:e,resumeData:JSON.parse(i.correctedJson)})}}});return f.jsxs("div",{className:"p-4 border-l-4 border-yellow-500 bg-yellow-500/10 rounded-r-lg space-y-4",children:[f.jsxs(XD,{children:[f.jsx(wge,{className:"h-4 w-4"}),f.jsx(JD,{children:"Action Required: Correct Data"}),f.jsx(QD,{children:"The workflow paused because it couldn't automatically extract structured data. Please review the raw response below and provide the correct data in JSON format."})]}),t&&f.jsxs("div",{className:"space-y-2",children:[f.jsx(Nt,{className:"font-semibold",children:"Raw Assistant Response (from last attempt)"}),f.jsx(Xo,{className:"h-48 border rounded-md bg-background p-3",children:f.jsx("pre",{className:"text-sm whitespace-pre-wrap",children:t})})]}),f.jsx(s,{})]})},J8e=({interaction:e})=>{const{activeRun:t,pausePayload:n}=H0(d=>({activeRun:d.activeRun,pausePayload:d.pausePayload}));if(!t||t.mainInteractionId!==e.id)return null;const r=t.template.name||"Workflow",s=t.status,i=t.currentStepIndex,a=t.template.steps.length;let o=Hn,l=`${r}: Initializing...`,c="text-muted-foreground";switch(s){case"RUNNING":case"STREAMING":o=Hn,l=`${r}: Running step ${i+1} of ${a}...`,c="text-blue-500";break;case"PAUSED":(n==null?void 0:n.pauseReason)==="data-correction"?(o=YB,l=`${r}: Paused - Awaiting data correction`,c="text-yellow-500"):(o=YB,l=`${r}: Paused - Awaiting your input`,c="text-yellow-500");break;case"COMPLETED":o=C1,l=`${r}: Completed successfully.`,c="text-green-500";break;case"ERROR":o=l3,l=`${r}: Failed.`,c="text-red-500";break;case"CANCELLED":o=l3,l=`${r}: Cancelled.`,c="text-muted-foreground";break}const u=()=>s!=="PAUSED"||!n?null:n.pauseReason==="data-correction"?f.jsx(X8e,{runId:n.runId,step:n.step,rawAssistantResponse:n.rawAssistantResponse}):n.pauseReason==="human-in-the-loop"?f.jsx(z4e,{run:t}):null;return f.jsxs("div",{className:"p-4 space-y-4",children:[f.jsxs("div",{className:`flex items-center gap-3 font-semibold text-lg ${c}`,children:[f.jsx(o,{className:`h-6 w-6 ${s==="RUNNING"||s==="STREAMING"?"animate-spin":""}`}),f.jsx("h2",{children:l})]}),u(),s==="ERROR"&&(t==null?void 0:t.error)&&f.jsxs("div",{className:"p-3 bg-destructive/10 border border-destructive/20 rounded-md text-destructive text-sm",children:[f.jsx("strong",{children:"Error:"})," ",t.error]})]})},SP=Ve.memo(({interaction:e,className:t,renderSlot:n,showPrompt:r=!0})=>{var j,L,D,H,O,K,U,W,B,ne,V,Q;const[s,i]=E.useState(!1),a=E.useRef(null),o=E.useCallback(()=>{i(!1)},[]),l=E.useCallback(()=>{i(!0)},[]),c=E.useCallback(()=>{s?o():l()},[s,o,l]),{dbProviderConfigs:u,getAllAvailableModelDefsForProvider:d}=Gn(mn(ee=>({dbProviderConfigs:ee.dbProviderConfigs,getAllAvailableModelDefsForProvider:ee.getAllAvailableModelDefsForProvider}))),h=e.endedAt?pX(new Date(e.endedAt),{addSuffix:!0}):"Processing...",m=E.useMemo(()=>{var _e;const ee=(_e=e.metadata)==null?void 0:_e.modelId;if(!ee)return"Unknown Model";const{providerId:re,modelId:de}=Ql(ee);if(!re||!de)return ee;const me=u.find(Ue=>Ue.id===re),De=(me==null?void 0:me.name)??re,Te=d(re).find(Ue=>Ue.id===de);return`${(Te==null?void 0:Te.name)??de} (${De})`},[(j=e.metadata)==null?void 0:j.modelId,u,d]),y=e.status==="COMPLETED",b=y||e.status==="ERROR",v=e.status==="ERROR",x=e.response&&(typeof e.response!="string"||e.response.trim().length>0),w=((L=e.metadata)==null?void 0:L.toolCalls)&&e.metadata.toolCalls.length>0,_=((D=e.metadata)==null?void 0:D.toolResults)&&e.metadata.toolResults.length>0,k=!!((H=e.metadata)!=null&&H.reasoning),C=x||w||_||k,T=n==null?void 0:n("header-actions",e,{isFolded:s,toggleFold:c}),A=n==null?void 0:n("actions",e),N=n==null?void 0:n("content",e),I=n==null?void 0:n("menu",e);return e.type==="workflow.run"?f.jsxs("div",{ref:a,className:Ye("group/card relative rounded-lg border bg-card p-3 md:p-4 shadow-sm","overflow-wrap-anywhere",v?"border-destructive/50 bg-destructive/5":"border-border",t),children:[r&&e.prompt&&f.jsx(Lw,{turnData:e.prompt,timestamp:e.startedAt,isAssistantComplete:y,interactionId:e.id}),f.jsx("div",{className:Ye("relative group/assistant",r&&e.prompt?"mt-3 pt-3 border-t border-border/50":""),children:f.jsx(J8e,{interaction:e})})]}):f.jsxs("div",{ref:a,className:Ye("group/card relative rounded-lg border bg-card p-3 md:p-4 shadow-sm transition-colors hover:bg-muted/50","overflow-wrap-anywhere",v?"border-destructive/50 bg-destructive/5":"border-border",t),children:[r&&e.prompt&&f.jsx(Lw,{turnData:e.prompt,timestamp:e.startedAt,isAssistantComplete:y,interactionId:e.id}),f.jsxs("div",{className:Ye("relative group/assistant",r&&e.prompt?"mt-3 pt-3 border-t border-border/50":""),children:[I,f.jsx(P4e,{interactionType:e.type,displayModelName:m,timeAgo:h,isFolded:s,toggleFold:c,canFold:C,promptTokens:(O=e.metadata)==null?void 0:O.promptTokens,completionTokens:(K=e.metadata)==null?void 0:K.completionTokens,timeToFirstToken:(U=e.metadata)==null?void 0:U.timeToFirstToken,generationTime:(W=e.metadata)==null?void 0:W.generationTime,headerActionsSlot:T&&T.length>0?f.jsx(f.Fragment,{children:T}):void 0}),N,f.jsx(D4e,{interactionId:e.id,response:e.response,toolCalls:(B=e.metadata)==null?void 0:B.toolCalls,toolResults:(ne=e.metadata)==null?void 0:ne.toolResults,reasoning:(V=e.metadata)==null?void 0:V.reasoning,isError:v,errorMessage:(Q=e.metadata)==null?void 0:Q.error,isFolded:s,toggleFold:c})]}),b&&A&&A.length>0&&f.jsx("div",{className:Ye("absolute bottom-1 left-1 md:bottom-2 md:left-2 flex items-center space-x-0.5 md:space-x-1 opacity-0 group-hover/card:opacity-100 transition-opacity duration-200","bg-card/80 backdrop-blur-sm p-0.5 md:p-1 rounded-md shadow-md z-[var(--z-sticky)]"),children:A})]})});SP.displayName="InteractionCard";const Q8e=({interactionGroup:e,renderSlot:t,activeStreamingInteractionId:n})=>{const[r,s]=E.useState(0);if(!e||e.length===0)return null;if(e.length===1){const a=e[0];return f.jsxs("div",{className:"tab-content pt-0",children:[" ",a.id===n&&a.status==="STREAMING"?f.jsx(kk,{interactionId:a.id,renderSlot:t,showPrompt:!1},a.id):f.jsx(SP,{interaction:a,renderSlot:t,showPrompt:!1},a.id)]})}const i=e[r];return f.jsxs("div",{className:"response-tabs-container flex flex-col",children:[f.jsxs("div",{className:"tabs-header flex border-b mb-1",children:[" ",e.map((a,o)=>{const l=()=>{var c,u,d;return o===0?(c=a.metadata)!=null&&c.editedResponse?f.jsx(GB,{className:"h-3.5 w-3.5 mr-1 flex-shrink-0"}):f.jsx(GB,{className:"h-3.5 w-3.5 mr-1 flex-shrink-0"}):(u=a.metadata)!=null&&u.raceTab?f.jsx(VH,{className:"h-3.5 w-3.5 mr-1 flex-shrink-0"}):(d=a.metadata)!=null&&d.originalVersion?f.jsx(nO,{className:"h-3.5 w-3.5 mr-1 flex-shrink-0"}):f.jsx(hge,{className:"h-3.5 w-3.5 mr-1 flex-shrink-0"})};return f.jsxs(ot,{variant:"ghost",size:"sm",onClick:()=>s(o),className:`mr-0.5 rounded-b-none flex items-center px-2 py-1 text-xs font-medium hover:bg-muted/50 focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-0 transition-colors duration-150 ease-in-out                 ${r===o?"border-b-2 border-primary text-primary":"border-b-2 border-transparent text-muted-foreground hover:text-foreground"}`,children:[l(),o+1," "]},a.id)})]}),f.jsxs("div",{className:"tab-content pt-1",children:[" ",i&&(i.id===n&&i.status==="STREAMING"?f.jsx(kk,{interactionId:i.id,renderSlot:t,showPrompt:!1},i.id):f.jsx(SP,{interaction:i,renderSlot:t,showPrompt:!1},i.id))]})]})};function Gr({className:e,...t}){return f.jsx("div",{"data-slot":"skeleton",className:Ye("bg-accent animate-pulse rounded-md",e),...t})}const eLe=e=>{const{size:t=24,color:n="currentColor",...r}=e;return f.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:t,height:t,viewBox:"0 0 512 512",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",...r,children:[f.jsx("g",{transform:"translate(0.000000,512.000000) scale(0.100000,-0.100000)",fill:n,stroke:"none",children:f.jsx("path",{d:`M2310 5053 c-1035 -101 -1883 -794 -2159 -1764 -55 -194 -79 -338
-91 -552 -18 -323 20 -620 117 -907 92 -272 238 -543 404 -747 33 -39 59 -75
59 -78 0 -4 -49 -129 -109 -279 -252 -624 -251 -621 -196 -676 57 -56 73 -53
351 58 137 55 349 143 472 195 l223 95 77 -38 c221 -109 437 -179 680 -219
132 -23 411 -44 475 -37 23 3 85 8 137 11 404 26 806 168 1180 417 282 188
571 489 759 792 400 642 467 1498 174 2216 -179 439 -495 826 -888 1088 -361
239 -743 378 -1165 422 -88 9 -419 11 -500 3z m404 -463 c-1 -30 -17 -128 -36
-217 l-34 -163 137 0 c128 0 139 -1 149 -20 11 -21 4 -44 -22 -72 -7 -7 -68
-75 -135 -150 l-123 -136 0 -175 0 -175 238 -4 c265 -5 329 -16 469 -82 220
-105 414 -311 486 -519 l24 -68 86 -4 c129 -7 195 -43 236 -130 20 -42 21 -61
21 -300 0 -240 -1 -258 -21 -297 -46 -90 -115 -127 -235 -128 l-82 0 -11 -47
c-17 -66 -71 -179 -119 -250 -108 -159 -276 -293 -452 -361 -174 -66 -251 -72
-830 -63 l-475 8 -89 27 c-303 91 -554 328 -650 614 l-23 67 -89 5 c-98 6
-131 20 -180 72 -63 66 -64 72 -64 354 0 240 1 261 21 301 40 84 105 119 232
129 l84 7 32 80 c84 215 291 424 513 519 126 53 225 68 466 68 l212 0 0 268 0
267 -126 -3 c-108 -3 -129 -1 -145 14 -10 9 -19 25 -19 35 0 9 111 146 246
304 234 273 247 286 277 283 32 -3 32 -3 31 -58z`})}),f.jsxs("g",{transform:"translate(165, 220) scale(2.5)",children:[f.jsx("path",{d:"M4 12h16",stroke:n,strokeWidth:"4"}),f.jsx("path",{d:"M12 5v16",stroke:n,strokeWidth:"4"})]}),f.jsxs("g",{transform:"translate(290, 220) scale(2.5)",children:[f.jsx("path",{d:"M4 12h16",stroke:n,strokeWidth:"4"}),f.jsx("path",{d:"M12 5v16",stroke:n,strokeWidth:"4"})]}),f.jsx("g",{transform:"translate(0.000000,512.000000) scale(0.100000,-0.100000)",fill:n,stroke:"none",children:f.jsx("path",{d:`M2147 1999 c-26 -15 -48 -65 -41 -94 15 -61 181 -167 304 -196 30 -7
100 -12 155 -12 81 1 115 6 178 27 135 45 247 133 249 194 2 60 -48 103 -104
88 -13 -3 -50 -25 -83 -50 -85 -64 -172 -90 -280 -84 -92 6 -165 35 -259 103
-49 35 -86 43 -119 24z`})})]})};function ho({className:e,...t}){return f.jsx("div",{"data-slot":"card",className:Ye("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",e),...t})}function po({className:e,...t}){return f.jsx("div",{"data-slot":"card-header",className:Ye("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",e),...t})}function mo({className:e,...t}){return f.jsx("div",{"data-slot":"card-title",className:Ye("leading-none font-semibold",e),...t})}function $c({className:e,...t}){return f.jsx("div",{"data-slot":"card-description",className:Ye("text-muted-foreground text-sm",e),...t})}function go({className:e,...t}){return f.jsx("div",{"data-slot":"card-content",className:Ye("px-6",e),...t})}function Mte({className:e,...t}){return f.jsx("div",{"data-slot":"card-footer",className:Ye("flex items-center px-6 [.border-t]:pt-6",e),...t})}const Tr={sidebarVisibilityChanged:"ui.sidebar.visibility.changed",chatControlPanelVisibilityChanged:"ui.chat.control.panel.visibility.changed",promptControlPanelVisibilityChanged:"ui.prompt.control.panel.visibility.changed",globalLoadingChanged:"ui.global.loading.changed",globalErrorChanged:"ui.global.error.changed",focusInputFlagChanged:"ui.focus.input.flag.changed",modalStateChanged:"ui.modal.state.changed",toggleSidebarRequest:"ui.toggle.sidebar.request",toggleChatControlPanelRequest:"ui.toggle.chat.control.panel.request",togglePromptControlPanelRequest:"ui.toggle.prompt.control.panel.request",setGlobalLoadingRequest:"ui.set.global.loading.request",setGlobalErrorRequest:"ui.set.global.error.request",setFocusInputFlagRequest:"ui.set.focus.input.flag.request",openModalRequest:"ui.modal.open.request",closeModalRequest:"ui.modal.close.request",contextChanged:"ui.legacy.contextChanged"},tLe=({title:e,description:t,icon:n,onClick:r})=>f.jsxs(ho,{className:"hover:border-primary/50 hover:bg-muted/30 transition-all cursor-pointer group",onClick:r,children:[f.jsxs(po,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[f.jsxs(mo,{className:"text-sm font-medium flex items-center gap-2",children:[n," ",e]}),f.jsx($pe,{className:"h-4 w-4 text-muted-foreground group-hover:translate-x-1 transition-transform"})]}),f.jsx(go,{children:f.jsx("p",{className:"text-xs text-muted-foreground",children:t})})]}),jte=()=>{const e=(r,s)=>{Ce.emit(Tr.openModalRequest,{modalId:"settingsModal",initialTab:r,initialSubTab:s})},t=()=>{Ce.emit(Tr.openModalRequest,{modalId:"core-vfs-modal-panel"})},n=[{title:"Configure Theme",description:"Customize colors, fonts, and code block appearance.",icon:f.jsx(cy,{className:"h-4 w-4 text-purple-500"}),onClick:()=>e("theme")},{title:"Manage Rules & Tags",description:"Define reusable prompt snippets and organize them.",icon:f.jsx(d3,{className:"h-4 w-4 text-blue-500"}),onClick:()=>e("rules-tags")},{title:"Add Files",description:"Upload or manage files in the virtual filesystem.",icon:f.jsx(eO,{className:"h-4 w-4 text-cyan-500"}),onClick:t},{title:"Add Provider",description:"Connect to AI services like OpenAI, Ollama, etc.",icon:f.jsx(uy,{className:"h-4 w-4 text-green-500"}),onClick:()=>e("providers","providers-config")},{title:"Add API Key",description:"Store API keys securely in your browser.",icon:f.jsx(nw,{className:"h-4 w-4 text-amber-500"}),onClick:()=>e("providers","api-keys")},{title:"Setup Git Sync",description:"Configure repositories to sync conversations with Git.",icon:f.jsx(qc,{className:"h-4 w-4 text-orange-500"}),onClick:()=>e("git")}];return f.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 max-w-4xl w-full pt-4",children:n.map(r=>f.jsx(tLe,{title:r.title,description:r.description,icon:r.icon,onClick:r.onClick},r.title))})},vU=()=>f.jsxs("div",{className:"flex h-full flex-col items-center justify-center text-center p-4",children:[f.jsx(eLe,{className:"h-16 w-16 text-muted-foreground mb-4"}),f.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Start Chatting"}),f.jsx("p",{className:"text-muted-foreground max-w-md mb-8",children:"Select an existing conversation or project from the sidebar, or click the '+' button to start a new chat. You can also explore these setup options:"}),f.jsx(jte,{})]}),vF=E.createContext({});function xF(e){const t=E.useRef(null);return t.current===null&&(t.current=e()),t.current}const wF=typeof window<"u",Pte=wF?E.useLayoutEffect:E.useEffect,VT=E.createContext(null),SF=E.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});class nLe extends E.Component{getSnapshotBeforeUpdate(t){const n=this.props.childRef.current;if(n&&t.isPresent&&!this.props.isPresent){const r=n.offsetParent,s=r instanceof HTMLElement&&r.offsetWidth||0,i=this.props.sizeRef.current;i.height=n.offsetHeight||0,i.width=n.offsetWidth||0,i.top=n.offsetTop,i.left=n.offsetLeft,i.right=s-i.width-i.left}return null}componentDidUpdate(){}render(){return this.props.children}}function rLe({children:e,isPresent:t,anchorX:n}){const r=E.useId(),s=E.useRef(null),i=E.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:a}=E.useContext(SF);return E.useInsertionEffect(()=>{const{width:o,height:l,top:c,left:u,right:d}=i.current;if(t||!s.current||!o||!l)return;const h=n==="left"?`left: ${u}`:`right: ${d}`;s.current.dataset.motionPopId=r;const m=document.createElement("style");return a&&(m.nonce=a),document.head.appendChild(m),m.sheet&&m.sheet.insertRule(`
          [data-motion-pop-id="${r}"] {
            position: absolute !important;
            width: ${o}px !important;
            height: ${l}px !important;
            ${h}px !important;
            top: ${c}px !important;
          }
        `),()=>{document.head.contains(m)&&document.head.removeChild(m)}},[t]),f.jsx(nLe,{isPresent:t,childRef:s,sizeRef:i,children:E.cloneElement(e,{ref:s})})}const sLe=({children:e,initial:t,isPresent:n,onExitComplete:r,custom:s,presenceAffectsLayout:i,mode:a,anchorX:o})=>{const l=xF(iLe),c=E.useId();let u=!0,d=E.useMemo(()=>(u=!1,{id:c,initial:t,isPresent:n,custom:s,onExitComplete:h=>{l.set(h,!0);for(const m of l.values())if(!m)return;r&&r()},register:h=>(l.set(h,!1),()=>l.delete(h))}),[n,l,r]);return i&&u&&(d={...d}),E.useMemo(()=>{l.forEach((h,m)=>l.set(m,!1))},[n]),E.useEffect(()=>{!n&&!l.size&&r&&r()},[n]),a==="popLayout"&&(e=f.jsx(rLe,{isPresent:n,anchorX:o,children:e})),f.jsx(VT.Provider,{value:d,children:e})};function iLe(){return new Map}function Ote(e=!0){const t=E.useContext(VT);if(t===null)return[!0,null];const{isPresent:n,onExitComplete:r,register:s}=t,i=E.useId();E.useEffect(()=>{if(e)return s(i)},[e]);const a=E.useCallback(()=>e&&r&&r(i),[i,r,e]);return!n&&r?[!1,a]:[!0]}const bC=e=>e.key||"";function xU(e){const t=[];return E.Children.forEach(e,n=>{E.isValidElement(n)&&t.push(n)}),t}const aLe=({children:e,custom:t,initial:n=!0,onExitComplete:r,presenceAffectsLayout:s=!0,mode:i="sync",propagate:a=!1,anchorX:o="left"})=>{const[l,c]=Ote(a),u=E.useMemo(()=>xU(e),[e]),d=a&&!l?[]:u.map(bC),h=E.useRef(!0),m=E.useRef(u),y=xF(()=>new Map),[b,v]=E.useState(u),[x,w]=E.useState(u);Pte(()=>{h.current=!1,m.current=u;for(let C=0;C<x.length;C++){const T=bC(x[C]);d.includes(T)?y.delete(T):y.get(T)!==!0&&y.set(T,!1)}},[x,d.length,d.join("-")]);const _=[];if(u!==b){let C=[...u];for(let T=0;T<x.length;T++){const A=x[T],N=bC(A);d.includes(N)||(C.splice(T,0,A),_.push(A))}return i==="wait"&&_.length&&(C=_),w(xU(C)),v(u),null}const{forceRender:k}=E.useContext(vF);return f.jsx(f.Fragment,{children:x.map(C=>{const T=bC(C),A=a&&!l?!1:u===x||d.includes(T),N=()=>{if(y.has(T))y.set(T,!0);else return;let I=!0;y.forEach(j=>{j||(I=!1)}),I&&(k==null||k(),w(m.current),a&&(c==null||c()),r&&r())};return f.jsx(sLe,{isPresent:A,initial:!h.current||n?void 0:!1,custom:t,presenceAffectsLayout:s,mode:i,onExitComplete:A?void 0:N,anchorX:o,children:C},T)})})},vC=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"],wU={value:null};function oLe(e,t){let n=new Set,r=new Set,s=!1,i=!1;const a=new WeakSet;let o={delta:0,timestamp:0,isProcessing:!1},l=0;function c(d){a.has(d)&&(u.schedule(d),e()),l++,d(o)}const u={schedule:(d,h=!1,m=!1)=>{const b=m&&s?n:r;return h&&a.add(d),b.has(d)||b.add(d),d},cancel:d=>{r.delete(d),a.delete(d)},process:d=>{if(o=d,s){i=!0;return}s=!0,[n,r]=[r,n],n.forEach(c),t&&wU.value&&wU.value.frameloop[t].push(l),l=0,n.clear(),s=!1,i&&(i=!1,u.process(d))}};return u}const df={},lLe=40;function Dte(e,t){let n=!1,r=!0;const s={delta:0,timestamp:0,isProcessing:!1},i=()=>n=!0,a=vC.reduce((_,k)=>(_[k]=oLe(i,t?k:void 0),_),{}),{setup:o,read:l,resolveKeyframes:c,preUpdate:u,update:d,preRender:h,render:m,postRender:y}=a,b=()=>{const _=df.useManualTiming?s.timestamp:performance.now();n=!1,df.useManualTiming||(s.delta=r?1e3/60:Math.max(Math.min(_-s.timestamp,lLe),1)),s.timestamp=_,s.isProcessing=!0,o.process(s),l.process(s),c.process(s),u.process(s),d.process(s),h.process(s),m.process(s),y.process(s),s.isProcessing=!1,n&&t&&(r=!1,e(b))},v=()=>{n=!0,r=!0,s.isProcessing||e(b)};return{schedule:vC.reduce((_,k)=>{const C=a[k];return _[k]=(T,A=!1,N=!1)=>(n||v(),C.schedule(T,A,N)),_},{}),cancel:_=>{for(let k=0;k<vC.length;k++)a[vC[k]].cancel(_)},state:s,steps:a}}const ec=e=>e,{schedule:si,cancel:Gh,state:Ea,steps:ij}=Dte(typeof requestAnimationFrame<"u"?requestAnimationFrame:ec,!0),Fte=E.createContext({strict:!1}),SU={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Fy={};for(const e in SU)Fy[e]={isEnabled:t=>SU[e].some(n=>!!t[n])};function cLe(e){for(const t in e)Fy[t]={...Fy[t],...e[t]}}const uLe=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function jk(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||uLe.has(e)}let Lte=e=>!jk(e);function dLe(e){e&&(Lte=t=>t.startsWith("on")?!jk(t):e(t))}try{dLe(require("@emotion/is-prop-valid").default)}catch{}function fLe(e,t,n){const r={};for(const s in e)s==="values"&&typeof e.values=="object"||(Lte(s)||n===!0&&jk(s)||!t&&!jk(s)||e.draggable&&s.startsWith("onDrag"))&&(r[s]=e[s]);return r}function hLe(e){if(typeof Proxy>"u")return e;const t=new Map,n=(...r)=>e(...r);return new Proxy(n,{get:(r,s)=>s==="create"?e:(t.has(s)||t.set(s,e(s)),t.get(s))})}const WT=E.createContext({});function HT(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}function Yw(e){return typeof e=="string"||Array.isArray(e)}const _F=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],CF=["initial",..._F];function GT(e){return HT(e.animate)||CF.some(t=>Yw(e[t]))}function Bte(e){return!!(GT(e)||e.variants)}function pLe(e,t){if(GT(e)){const{initial:n,animate:r}=e;return{initial:n===!1||Yw(n)?n:void 0,animate:Yw(r)?r:void 0}}return e.inherit!==!1?t:{}}function mLe(e){const{initial:t,animate:n}=pLe(e,E.useContext(WT));return E.useMemo(()=>({initial:t,animate:n}),[_U(t),_U(n)])}function _U(e){return Array.isArray(e)?e.join(" "):e}const gLe=Symbol.for("motionComponentSymbol");function O0(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function yLe(e,t,n){return E.useCallback(r=>{r&&e.onMount&&e.onMount(r),t&&(r?t.mount(r):t.unmount()),n&&(typeof n=="function"?n(r):O0(n)&&(n.current=r))},[t])}const kF=e=>e.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),bLe="framerAppearId",$te="data-"+kF(bLe),zte=E.createContext({}),{schedule:EF}=Dte(queueMicrotask,!1);function vLe(e,t,n,r,s){var b,v;const{visualElement:i}=E.useContext(WT),a=E.useContext(Fte),o=E.useContext(VT),l=E.useContext(SF).reducedMotion,c=E.useRef(null);r=r||a.renderer,!c.current&&r&&(c.current=r(e,{visualState:t,parent:i,props:n,presenceContext:o,blockInitialAnimation:o?o.initial===!1:!1,reducedMotionConfig:l}));const u=c.current,d=E.useContext(zte);u&&!u.projection&&s&&(u.type==="html"||u.type==="svg")&&xLe(c.current,n,s,d);const h=E.useRef(!1);E.useInsertionEffect(()=>{u&&h.current&&u.update(n,o)});const m=n[$te],y=E.useRef(!!m&&!((b=window.MotionHandoffIsComplete)!=null&&b.call(window,m))&&((v=window.MotionHasOptimisedAnimation)==null?void 0:v.call(window,m)));return Pte(()=>{u&&(h.current=!0,window.MotionIsMounted=!0,u.updateFeatures(),EF.render(u.render),y.current&&u.animationState&&u.animationState.animateChanges())}),E.useEffect(()=>{u&&(!y.current&&u.animationState&&u.animationState.animateChanges(),y.current&&(queueMicrotask(()=>{var x;(x=window.MotionHandoffMarkAsComplete)==null||x.call(window,m)}),y.current=!1))}),u}function xLe(e,t,n,r){const{layoutId:s,layout:i,drag:a,dragConstraints:o,layoutScroll:l,layoutRoot:c,layoutCrossfade:u}=t;e.projection=new n(e.latestValues,t["data-framer-portal-id"]?void 0:Ute(e.parent)),e.projection.setOptions({layoutId:s,layout:i,alwaysMeasureLayout:!!a||o&&O0(o),visualElement:e,animationType:typeof i=="string"?i:"both",initialPromotionConfig:r,crossfade:u,layoutScroll:l,layoutRoot:c})}function Ute(e){if(e)return e.options.allowProjection!==!1?e.projection:Ute(e.parent)}let TF=()=>{};function wLe({preloadedFeatures:e,createVisualElement:t,useRender:n,useVisualState:r,Component:s}){e&&cLe(e);function i(o,l){let c;const u={...E.useContext(SF),...o,layoutId:SLe(o)},{isStatic:d}=u,h=mLe(o),m=r(o,d);if(!d&&wF){_Le();const y=CLe(u);c=y.MeasureLayout,h.visualElement=vLe(s,m,u,t,y.ProjectionNode)}return f.jsxs(WT.Provider,{value:h,children:[c&&h.visualElement?f.jsx(c,{visualElement:h.visualElement,...u}):null,n(s,o,yLe(m,h.visualElement,l),m,d,h.visualElement)]})}i.displayName=`motion.${typeof s=="string"?s:`create(${s.displayName??s.name??""})`}`;const a=E.forwardRef(i);return a[gLe]=s,a}function SLe({layoutId:e}){const t=E.useContext(vF).id;return t&&e!==void 0?t+"-"+e:e}function _Le(e,t){E.useContext(Fte).strict}function CLe(e){const{drag:t,layout:n}=Fy;if(!t&&!n)return{};const r={...t,...n};return{MeasureLayout:t!=null&&t.isEnabled(e)||n!=null&&n.isEnabled(e)?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}const qte=e=>t=>typeof t=="string"&&t.startsWith(e),AF=qte("--"),kLe=qte("var(--"),RF=e=>kLe(e)?ELe.test(e.split("/*")[0].trim()):!1,ELe=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,Zw={};function TLe(e){for(const t in e)Zw[t]=e[t],AF(t)&&(Zw[t].isCSSVariable=!0)}const _b=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Cb=new Set(_b);function Vte(e,{layout:t,layoutId:n}){return Cb.has(e)||e.startsWith("origin")||(t||n!==void 0)&&(!!Zw[e]||e==="opacity")}const qa=e=>!!(e&&e.getVelocity),Wte=(e,t)=>t&&typeof e=="number"?t.transform(e):e,ff=(e,t,n)=>n>t?t:n<e?e:n,kb={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},Xw={...kb,transform:e=>ff(0,1,e)},xC={...kb,default:1},CU={...kb,transform:Math.round},dS=e=>({test:t=>typeof t=="string"&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),mh=dS("deg"),Du=dS("%"),cr=dS("px"),ALe=dS("vh"),RLe=dS("vw"),kU={...Du,parse:e=>Du.parse(e)/100,transform:e=>Du.transform(e*100)},NLe={rotate:mh,rotateX:mh,rotateY:mh,rotateZ:mh,scale:xC,scaleX:xC,scaleY:xC,scaleZ:xC,skew:mh,skewX:mh,skewY:mh,distance:cr,translateX:cr,translateY:cr,translateZ:cr,x:cr,y:cr,z:cr,perspective:cr,transformPerspective:cr,opacity:Xw,originX:kU,originY:kU,originZ:cr},NF={borderWidth:cr,borderTopWidth:cr,borderRightWidth:cr,borderBottomWidth:cr,borderLeftWidth:cr,borderRadius:cr,radius:cr,borderTopLeftRadius:cr,borderTopRightRadius:cr,borderBottomRightRadius:cr,borderBottomLeftRadius:cr,width:cr,maxWidth:cr,height:cr,maxHeight:cr,top:cr,right:cr,bottom:cr,left:cr,padding:cr,paddingTop:cr,paddingRight:cr,paddingBottom:cr,paddingLeft:cr,margin:cr,marginTop:cr,marginRight:cr,marginBottom:cr,marginLeft:cr,backgroundPositionX:cr,backgroundPositionY:cr,...NLe,zIndex:CU,fillOpacity:Xw,strokeOpacity:Xw,numOctaves:CU},ILe={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},MLe=_b.length;function jLe(e,t,n){let r="",s=!0;for(let i=0;i<MLe;i++){const a=_b[i],o=e[a];if(o===void 0)continue;let l=!0;if(typeof o=="number"?l=o===(a.startsWith("scale")?1:0):l=parseFloat(o)===0,!l||n){const c=Wte(o,NF[a]);if(!l){s=!1;const u=ILe[a]||a;r+=`${u}(${c}) `}n&&(t[a]=c)}}return r=r.trim(),n?r=n(t,s?"":r):s&&(r="none"),r}function IF(e,t,n){const{style:r,vars:s,transformOrigin:i}=e;let a=!1,o=!1;for(const l in t){const c=t[l];if(Cb.has(l)){a=!0;continue}else if(AF(l)){s[l]=c;continue}else{const u=Wte(c,NF[l]);l.startsWith("origin")?(o=!0,i[l]=u):r[l]=u}}if(t.transform||(a||n?r.transform=jLe(t,e.transform,n):r.transform&&(r.transform="none")),o){const{originX:l="50%",originY:c="50%",originZ:u=0}=i;r.transformOrigin=`${l} ${c} ${u}`}}const MF=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function Hte(e,t,n){for(const r in t)!qa(t[r])&&!Vte(r,n)&&(e[r]=t[r])}function PLe({transformTemplate:e},t){return E.useMemo(()=>{const n=MF();return IF(n,t,e),Object.assign({},n.vars,n.style)},[t])}function OLe(e,t){const n=e.style||{},r={};return Hte(r,n,e),Object.assign(r,PLe(e,t)),r}function DLe(e,t){const n={},r=OLe(e,t);return e.drag&&e.dragListener!==!1&&(n.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(n.tabIndex=0),n.style=r,n}const FLe=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function jF(e){return typeof e!="string"||e.includes("-")?!1:!!(FLe.indexOf(e)>-1||/[A-Z]/u.test(e))}const LLe={offset:"stroke-dashoffset",array:"stroke-dasharray"},BLe={offset:"strokeDashoffset",array:"strokeDasharray"};function $Le(e,t,n=1,r=0,s=!0){e.pathLength=1;const i=s?LLe:BLe;e[i.offset]=cr.transform(-r);const a=cr.transform(t),o=cr.transform(n);e[i.array]=`${a} ${o}`}function Gte(e,{attrX:t,attrY:n,attrScale:r,pathLength:s,pathSpacing:i=1,pathOffset:a=0,...o},l,c,u){if(IF(e,o,c),l){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:d,style:h}=e;d.transform&&(h.transform=d.transform,delete d.transform),(h.transform||d.transformOrigin)&&(h.transformOrigin=d.transformOrigin??"50% 50%",delete d.transformOrigin),h.transform&&(h.transformBox=(u==null?void 0:u.transformBox)??"fill-box",delete d.transformBox),t!==void 0&&(d.x=t),n!==void 0&&(d.y=n),r!==void 0&&(d.scale=r),s!==void 0&&$Le(d,s,i,a,!1)}const Kte=()=>({...MF(),attrs:{}}),Yte=e=>typeof e=="string"&&e.toLowerCase()==="svg";function zLe(e,t,n,r){const s=E.useMemo(()=>{const i=Kte();return Gte(i,t,Yte(r),e.transformTemplate,e.style),{...i.attrs,style:{...i.style}}},[t]);if(e.style){const i={};Hte(i,e.style,e),s.style={...i,...s.style}}return s}function ULe(e=!1){return(n,r,s,{latestValues:i},a)=>{const l=(jF(n)?zLe:DLe)(r,i,a,n),c=fLe(r,typeof n=="string",e),u=n!==E.Fragment?{...c,...l,ref:s}:{},{children:d}=r,h=E.useMemo(()=>qa(d)?d.get():d,[d]);return E.createElement(n,{...u,children:h})}}function EU(e){const t=[{},{}];return e==null||e.values.forEach((n,r)=>{t[0][r]=n.get(),t[1][r]=n.getVelocity()}),t}function PF(e,t,n,r){if(typeof t=="function"){const[s,i]=EU(r);t=t(n!==void 0?n:e.custom,s,i)}if(typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"){const[s,i]=EU(r);t=t(n!==void 0?n:e.custom,s,i)}return t}function QC(e){return qa(e)?e.get():e}function qLe({scrapeMotionValuesFromProps:e,createRenderState:t},n,r,s){return{latestValues:VLe(n,r,s,e),renderState:t()}}const Zte=e=>(t,n)=>{const r=E.useContext(WT),s=E.useContext(VT),i=()=>qLe(e,t,r,s);return n?i():xF(i)};function VLe(e,t,n,r){const s={},i=r(e,{});for(const h in i)s[h]=QC(i[h]);let{initial:a,animate:o}=e;const l=GT(e),c=Bte(e);t&&c&&!l&&e.inherit!==!1&&(a===void 0&&(a=t.initial),o===void 0&&(o=t.animate));let u=n?n.initial===!1:!1;u=u||a===!1;const d=u?o:a;if(d&&typeof d!="boolean"&&!HT(d)){const h=Array.isArray(d)?d:[d];for(let m=0;m<h.length;m++){const y=PF(e,h[m]);if(y){const{transitionEnd:b,transition:v,...x}=y;for(const w in x){let _=x[w];if(Array.isArray(_)){const k=u?_.length-1:0;_=_[k]}_!==null&&(s[w]=_)}for(const w in b)s[w]=b[w]}}}return s}function OF(e,t,n){var i;const{style:r}=e,s={};for(const a in r)(qa(r[a])||t.style&&qa(t.style[a])||Vte(a,e)||((i=n==null?void 0:n.getValue(a))==null?void 0:i.liveStyle)!==void 0)&&(s[a]=r[a]);return s}const WLe={useVisualState:Zte({scrapeMotionValuesFromProps:OF,createRenderState:MF})};function Xte(e,t,n){const r=OF(e,t,n);for(const s in e)if(qa(e[s])||qa(t[s])){const i=_b.indexOf(s)!==-1?"attr"+s.charAt(0).toUpperCase()+s.substring(1):s;r[i]=e[s]}return r}const HLe={useVisualState:Zte({scrapeMotionValuesFromProps:Xte,createRenderState:Kte})};function GLe(e,t){return function(r,{forwardMotionProps:s}={forwardMotionProps:!1}){const a={...jF(r)?HLe:WLe,preloadedFeatures:e,useRender:ULe(s),createVisualElement:t,Component:r};return wLe(a)}}function Jw(e,t,n){const r=e.getProps();return PF(r,t,n!==void 0?n:r.custom,e)}const _P=e=>Array.isArray(e);let e2;function KLe(){e2=void 0}const Uo={now:()=>(e2===void 0&&Uo.set(Ea.isProcessing||df.useManualTiming?Ea.timestamp:performance.now()),e2),set:e=>{e2=e,queueMicrotask(KLe)}};function DF(e,t){e.indexOf(t)===-1&&e.push(t)}function FF(e,t){const n=e.indexOf(t);n>-1&&e.splice(n,1)}class LF{constructor(){this.subscriptions=[]}add(t){return DF(this.subscriptions,t),()=>FF(this.subscriptions,t)}notify(t,n,r){const s=this.subscriptions.length;if(s)if(s===1)this.subscriptions[0](t,n,r);else for(let i=0;i<s;i++){const a=this.subscriptions[i];a&&a(t,n,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function Jte(e,t){return t?e*(1e3/t):0}const TU=30,YLe=e=>!isNaN(parseFloat(e));class ZLe{constructor(t,n={}){this.version="__VERSION__",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(r,s=!0)=>{var a,o;const i=Uo.now();this.updatedAt!==i&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(r),this.current!==this.prev&&((a=this.events.change)==null||a.notify(this.current)),s&&((o=this.events.renderRequest)==null||o.notify(this.current))},this.hasAnimated=!1,this.setCurrent(t),this.owner=n.owner}setCurrent(t){this.current=t,this.updatedAt=Uo.now(),this.canTrackVelocity===null&&t!==void 0&&(this.canTrackVelocity=YLe(this.current))}setPrevFrameValue(t=this.current){this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,n){this.events[t]||(this.events[t]=new LF);const r=this.events[t].add(n);return t==="change"?()=>{r(),si.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,n){this.passiveEffect=t,this.stopPassiveEffect=n}set(t,n=!0){!n||!this.passiveEffect?this.updateAndNotify(t,n):this.passiveEffect(t,this.updateAndNotify)}setWithVelocity(t,n,r){this.set(n),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-r}jump(t,n=!0){this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,n&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const t=Uo.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||t-this.updatedAt>TU)return 0;const n=Math.min(this.updatedAt-this.prevUpdatedAt,TU);return Jte(parseFloat(this.current)-parseFloat(this.prevFrameValue),n)}start(t){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=t(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var t;(t=this.events.destroy)==null||t.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Qw(e,t){return new ZLe(e,t)}function XLe(e,t,n){e.hasValue(t)?e.getValue(t).set(n):e.addValue(t,Qw(n))}function JLe(e){return _P(e)?e[e.length-1]||0:e}function QLe(e,t){const n=Jw(e,t);let{transitionEnd:r={},transition:s={},...i}=n||{};i={...i,...r};for(const a in i){const o=JLe(i[a]);XLe(e,a,o)}}function eBe(e){return!!(qa(e)&&e.add)}function CP(e,t){const n=e.getValue("willChange");if(eBe(n))return n.add(t);if(!n&&df.WillChange){const r=new df.WillChange("auto");e.addValue("willChange",r),r.add(t)}}function Qte(e){return e.props[$te]}const tBe=e=>e!==null;function nBe(e,{repeat:t,repeatType:n="loop"},r){const s=e.filter(tBe),i=t&&n!=="loop"&&t%2===1?0:s.length-1;return s[i]}const rBe={type:"spring",stiffness:500,damping:25,restSpeed:10},sBe=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),iBe={type:"keyframes",duration:.8},aBe={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},oBe=(e,{keyframes:t})=>t.length>2?iBe:Cb.has(e)?e.startsWith("scale")?sBe(t[1]):rBe:aBe;function lBe({when:e,delay:t,delayChildren:n,staggerChildren:r,staggerDirection:s,repeat:i,repeatType:a,repeatDelay:o,from:l,elapsed:c,...u}){return!!Object.keys(u).length}function BF(e,t){return(e==null?void 0:e[t])??(e==null?void 0:e.default)??e}const Fu=e=>e*1e3,Lu=e=>e/1e3,$x=e=>Math.round(e*1e5)/1e5,$F=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function cBe(e){return e==null}const uBe=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,zF=(e,t)=>n=>!!(typeof n=="string"&&uBe.test(n)&&n.startsWith(e)||t&&!cBe(n)&&Object.prototype.hasOwnProperty.call(n,t)),ene=(e,t,n)=>r=>{if(typeof r!="string")return r;const[s,i,a,o]=r.match($F);return{[e]:parseFloat(s),[t]:parseFloat(i),[n]:parseFloat(a),alpha:o!==void 0?parseFloat(o):1}},dBe=e=>ff(0,255,e),aj={...kb,transform:e=>Math.round(dBe(e))},hm={test:zF("rgb","red"),parse:ene("red","green","blue"),transform:({red:e,green:t,blue:n,alpha:r=1})=>"rgba("+aj.transform(e)+", "+aj.transform(t)+", "+aj.transform(n)+", "+$x(Xw.transform(r))+")"};function fBe(e){let t="",n="",r="",s="";return e.length>5?(t=e.substring(1,3),n=e.substring(3,5),r=e.substring(5,7),s=e.substring(7,9)):(t=e.substring(1,2),n=e.substring(2,3),r=e.substring(3,4),s=e.substring(4,5),t+=t,n+=n,r+=r,s+=s),{red:parseInt(t,16),green:parseInt(n,16),blue:parseInt(r,16),alpha:s?parseInt(s,16)/255:1}}const kP={test:zF("#"),parse:fBe,transform:hm.transform},D0={test:zF("hsl","hue"),parse:ene("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:n,alpha:r=1})=>"hsla("+Math.round(e)+", "+Du.transform($x(t))+", "+Du.transform($x(n))+", "+$x(Xw.transform(r))+")"},Ba={test:e=>hm.test(e)||kP.test(e)||D0.test(e),parse:e=>hm.test(e)?hm.parse(e):D0.test(e)?D0.parse(e):kP.parse(e),transform:e=>typeof e=="string"?e:e.hasOwnProperty("red")?hm.transform(e):D0.transform(e)},hBe=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function pBe(e){var t,n;return isNaN(e)&&typeof e=="string"&&(((t=e.match($F))==null?void 0:t.length)||0)+(((n=e.match(hBe))==null?void 0:n.length)||0)>0}const tne="number",nne="color",mBe="var",gBe="var(",AU="${}",yBe=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function e1(e){const t=e.toString(),n=[],r={color:[],number:[],var:[]},s=[];let i=0;const o=t.replace(yBe,l=>(Ba.test(l)?(r.color.push(i),s.push(nne),n.push(Ba.parse(l))):l.startsWith(gBe)?(r.var.push(i),s.push(mBe),n.push(l)):(r.number.push(i),s.push(tne),n.push(parseFloat(l))),++i,AU)).split(AU);return{values:n,split:o,indexes:r,types:s}}function rne(e){return e1(e).values}function sne(e){const{split:t,types:n}=e1(e),r=t.length;return s=>{let i="";for(let a=0;a<r;a++)if(i+=t[a],s[a]!==void 0){const o=n[a];o===tne?i+=$x(s[a]):o===nne?i+=Ba.transform(s[a]):i+=s[a]}return i}}const bBe=e=>typeof e=="number"?0:e;function vBe(e){const t=rne(e);return sne(e)(t.map(bBe))}const Kh={test:pBe,parse:rne,createTransformer:sne,getAnimatableNone:vBe};function oj(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+(t-e)*6*n:n<1/2?t:n<2/3?e+(t-e)*(2/3-n)*6:e}function xBe({hue:e,saturation:t,lightness:n,alpha:r}){e/=360,t/=100,n/=100;let s=0,i=0,a=0;if(!t)s=i=a=n;else{const o=n<.5?n*(1+t):n+t-n*t,l=2*n-o;s=oj(l,o,e+1/3),i=oj(l,o,e),a=oj(l,o,e-1/3)}return{red:Math.round(s*255),green:Math.round(i*255),blue:Math.round(a*255),alpha:r}}function Pk(e,t){return n=>n>0?t:e}const ni=(e,t,n)=>e+(t-e)*n,lj=(e,t,n)=>{const r=e*e,s=n*(t*t-r)+r;return s<0?0:Math.sqrt(s)},wBe=[kP,hm,D0],SBe=e=>wBe.find(t=>t.test(e));function RU(e){const t=SBe(e);if(!t)return!1;let n=t.parse(e);return t===D0&&(n=xBe(n)),n}const NU=(e,t)=>{const n=RU(e),r=RU(t);if(!n||!r)return Pk(e,t);const s={...n};return i=>(s.red=lj(n.red,r.red,i),s.green=lj(n.green,r.green,i),s.blue=lj(n.blue,r.blue,i),s.alpha=ni(n.alpha,r.alpha,i),hm.transform(s))},EP=new Set(["none","hidden"]);function _Be(e,t){return EP.has(e)?n=>n<=0?e:t:n=>n>=1?t:e}const CBe=(e,t)=>n=>t(e(n)),fS=(...e)=>e.reduce(CBe);function kBe(e,t){return n=>ni(e,t,n)}function UF(e){return typeof e=="number"?kBe:typeof e=="string"?RF(e)?Pk:Ba.test(e)?NU:ABe:Array.isArray(e)?ine:typeof e=="object"?Ba.test(e)?NU:EBe:Pk}function ine(e,t){const n=[...e],r=n.length,s=e.map((i,a)=>UF(i)(i,t[a]));return i=>{for(let a=0;a<r;a++)n[a]=s[a](i);return n}}function EBe(e,t){const n={...e,...t},r={};for(const s in n)e[s]!==void 0&&t[s]!==void 0&&(r[s]=UF(e[s])(e[s],t[s]));return s=>{for(const i in r)n[i]=r[i](s);return n}}function TBe(e,t){const n=[],r={color:0,var:0,number:0};for(let s=0;s<t.values.length;s++){const i=t.types[s],a=e.indexes[i][r[i]],o=e.values[a]??0;n[s]=o,r[i]++}return n}const ABe=(e,t)=>{const n=Kh.createTransformer(t),r=e1(e),s=e1(t);return r.indexes.var.length===s.indexes.var.length&&r.indexes.color.length===s.indexes.color.length&&r.indexes.number.length>=s.indexes.number.length?EP.has(e)&&!s.values.length||EP.has(t)&&!r.values.length?_Be(e,t):fS(ine(TBe(r,s),s.values),n):Pk(e,t)};function ane(e,t,n){return typeof e=="number"&&typeof t=="number"&&typeof n=="number"?ni(e,t,n):UF(e)(e,t)}const RBe=e=>{const t=({timestamp:n})=>e(n);return{start:()=>si.update(t,!0),stop:()=>Gh(t),now:()=>Ea.isProcessing?Ea.timestamp:Uo.now()}},one=(e,t,n=10)=>{let r="";const s=Math.max(Math.round(t/n),2);for(let i=0;i<s;i++)r+=e(i/(s-1))+", ";return`linear(${r.substring(0,r.length-2)})`},Ok=2e4;function qF(e){let t=0;const n=50;let r=e.next(t);for(;!r.done&&t<Ok;)t+=n,r=e.next(t);return t>=Ok?1/0:t}function NBe(e,t=100,n){const r=n({...e,keyframes:[0,t]}),s=Math.min(qF(r),Ok);return{type:"keyframes",ease:i=>r.next(s*i).value/t,duration:Lu(s)}}const IBe=5;function lne(e,t,n){const r=Math.max(t-IBe,0);return Jte(n-e(r),t-r)}const ci={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},IU=.001;function MBe({duration:e=ci.duration,bounce:t=ci.bounce,velocity:n=ci.velocity,mass:r=ci.mass}){let s,i,a=1-t;a=ff(ci.minDamping,ci.maxDamping,a),e=ff(ci.minDuration,ci.maxDuration,Lu(e)),a<1?(s=c=>{const u=c*a,d=u*e,h=u-n,m=TP(c,a),y=Math.exp(-d);return IU-h/m*y},i=c=>{const d=c*a*e,h=d*n+n,m=Math.pow(a,2)*Math.pow(c,2)*e,y=Math.exp(-d),b=TP(Math.pow(c,2),a);return(-s(c)+IU>0?-1:1)*((h-m)*y)/b}):(s=c=>{const u=Math.exp(-c*e),d=(c-n)*e+1;return-.001+u*d},i=c=>{const u=Math.exp(-c*e),d=(n-c)*(e*e);return u*d});const o=5/e,l=PBe(s,i,o);if(e=Fu(e),isNaN(l))return{stiffness:ci.stiffness,damping:ci.damping,duration:e};{const c=Math.pow(l,2)*r;return{stiffness:c,damping:a*2*Math.sqrt(r*c),duration:e}}}const jBe=12;function PBe(e,t,n){let r=n;for(let s=1;s<jBe;s++)r=r-e(r)/t(r);return r}function TP(e,t){return e*Math.sqrt(1-t*t)}const OBe=["duration","bounce"],DBe=["stiffness","damping","mass"];function MU(e,t){return t.some(n=>e[n]!==void 0)}function FBe(e){let t={velocity:ci.velocity,stiffness:ci.stiffness,damping:ci.damping,mass:ci.mass,isResolvedFromDuration:!1,...e};if(!MU(e,DBe)&&MU(e,OBe))if(e.visualDuration){const n=e.visualDuration,r=2*Math.PI/(n*1.2),s=r*r,i=2*ff(.05,1,1-(e.bounce||0))*Math.sqrt(s);t={...t,mass:ci.mass,stiffness:s,damping:i}}else{const n=MBe(e);t={...t,...n,mass:ci.mass},t.isResolvedFromDuration=!0}return t}function Dk(e=ci.visualDuration,t=ci.bounce){const n=typeof e!="object"?{visualDuration:e,keyframes:[0,1],bounce:t}:e;let{restSpeed:r,restDelta:s}=n;const i=n.keyframes[0],a=n.keyframes[n.keyframes.length-1],o={done:!1,value:i},{stiffness:l,damping:c,mass:u,duration:d,velocity:h,isResolvedFromDuration:m}=FBe({...n,velocity:-Lu(n.velocity||0)}),y=h||0,b=c/(2*Math.sqrt(l*u)),v=a-i,x=Lu(Math.sqrt(l/u)),w=Math.abs(v)<5;r||(r=w?ci.restSpeed.granular:ci.restSpeed.default),s||(s=w?ci.restDelta.granular:ci.restDelta.default);let _;if(b<1){const C=TP(x,b);_=T=>{const A=Math.exp(-b*x*T);return a-A*((y+b*x*v)/C*Math.sin(C*T)+v*Math.cos(C*T))}}else if(b===1)_=C=>a-Math.exp(-x*C)*(v+(y+x*v)*C);else{const C=x*Math.sqrt(b*b-1);_=T=>{const A=Math.exp(-b*x*T),N=Math.min(C*T,300);return a-A*((y+b*x*v)*Math.sinh(N)+C*v*Math.cosh(N))/C}}const k={calculatedDuration:m&&d||null,next:C=>{const T=_(C);if(m)o.done=C>=d;else{let A=C===0?y:0;b<1&&(A=C===0?Fu(y):lne(_,C,T));const N=Math.abs(A)<=r,I=Math.abs(a-T)<=s;o.done=N&&I}return o.value=o.done?a:T,o},toString:()=>{const C=Math.min(qF(k),Ok),T=one(A=>k.next(C*A).value,C,30);return C+"ms "+T},toTransition:()=>{}};return k}Dk.applyToOptions=e=>{const t=NBe(e,100,Dk);return e.ease=t.ease,e.duration=Fu(t.duration),e.type="keyframes",e};function AP({keyframes:e,velocity:t=0,power:n=.8,timeConstant:r=325,bounceDamping:s=10,bounceStiffness:i=500,modifyTarget:a,min:o,max:l,restDelta:c=.5,restSpeed:u}){const d=e[0],h={done:!1,value:d},m=N=>o!==void 0&&N<o||l!==void 0&&N>l,y=N=>o===void 0?l:l===void 0||Math.abs(o-N)<Math.abs(l-N)?o:l;let b=n*t;const v=d+b,x=a===void 0?v:a(v);x!==v&&(b=x-d);const w=N=>-b*Math.exp(-N/r),_=N=>x+w(N),k=N=>{const I=w(N),j=_(N);h.done=Math.abs(I)<=c,h.value=h.done?x:j};let C,T;const A=N=>{m(h.value)&&(C=N,T=Dk({keyframes:[h.value,y(h.value)],velocity:lne(_,N,h.value),damping:s,stiffness:i,restDelta:c,restSpeed:u}))};return A(0),{calculatedDuration:null,next:N=>{let I=!1;return!T&&C===void 0&&(I=!0,k(N),A(N)),C!==void 0&&N>=C?T.next(N-C):(!I&&k(N),h)}}}const t1=(e,t,n)=>{const r=t-e;return r===0?1:(n-e)/r};function LBe(e,t,n){const r=[],s=n||df.mix||ane,i=e.length-1;for(let a=0;a<i;a++){let o=s(e[a],e[a+1]);if(t){const l=Array.isArray(t)?t[a]||ec:t;o=fS(l,o)}r.push(o)}return r}function BBe(e,t,{clamp:n=!0,ease:r,mixer:s}={}){const i=e.length;if(TF(i===t.length),i===1)return()=>t[0];if(i===2&&t[0]===t[1])return()=>t[1];const a=e[0]===e[1];e[0]>e[i-1]&&(e=[...e].reverse(),t=[...t].reverse());const o=LBe(t,r,s),l=o.length,c=u=>{if(a&&u<e[0])return t[0];let d=0;if(l>1)for(;d<e.length-2&&!(u<e[d+1]);d++);const h=t1(e[d],e[d+1],u);return o[d](h)};return n?u=>c(ff(e[0],e[i-1],u)):c}function $Be(e,t){const n=e[e.length-1];for(let r=1;r<=t;r++){const s=t1(0,t,r);e.push(ni(n,1,s))}}function zBe(e){const t=[0];return $Be(t,e.length-1),t}function UBe(e,t){return e.map(n=>n*t)}const cne=(e,t,n)=>(((1-3*n+3*t)*e+(3*n-6*t))*e+3*t)*e,qBe=1e-7,VBe=12;function WBe(e,t,n,r,s){let i,a,o=0;do a=t+(n-t)/2,i=cne(a,r,s)-e,i>0?n=a:t=a;while(Math.abs(i)>qBe&&++o<VBe);return a}function hS(e,t,n,r){if(e===t&&n===r)return ec;const s=i=>WBe(i,0,1,e,n);return i=>i===0||i===1?i:cne(s(i),t,r)}const HBe=hS(.42,0,1,1),GBe=hS(0,0,.58,1),une=hS(.42,0,.58,1),KBe=e=>Array.isArray(e)&&typeof e[0]!="number",dne=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,fne=e=>t=>1-e(1-t),hne=hS(.33,1.53,.69,.99),VF=fne(hne),pne=dne(VF),mne=e=>(e*=2)<1?.5*VF(e):.5*(2-Math.pow(2,-10*(e-1))),WF=e=>1-Math.sin(Math.acos(e)),gne=fne(WF),yne=dne(WF),bne=e=>Array.isArray(e)&&typeof e[0]=="number",YBe={linear:ec,easeIn:HBe,easeInOut:une,easeOut:GBe,circIn:WF,circInOut:yne,circOut:gne,backIn:VF,backInOut:pne,backOut:hne,anticipate:mne},ZBe=e=>typeof e=="string",jU=e=>{if(bne(e)){TF(e.length===4);const[t,n,r,s]=e;return hS(t,n,r,s)}else if(ZBe(e))return YBe[e];return e};function XBe(e,t){return e.map(()=>t||une).splice(0,e.length-1)}function zx({duration:e=300,keyframes:t,times:n,ease:r="easeInOut"}){const s=KBe(r)?r.map(jU):jU(r),i={done:!1,value:t[0]},a=UBe(n&&n.length===t.length?n:zBe(t),e),o=BBe(a,t,{ease:Array.isArray(s)?s:XBe(t,s)});return{calculatedDuration:e,next:l=>(i.value=o(l),i.done=l>=e,i)}}const JBe=e=>e!==null;function HF(e,{repeat:t,repeatType:n="loop"},r,s=1){const i=e.filter(JBe),o=s<0||t&&n!=="loop"&&t%2===1?0:i.length-1;return!o||r===void 0?i[o]:r}const QBe={decay:AP,inertia:AP,tween:zx,keyframes:zx,spring:Dk};function vne(e){typeof e.type=="string"&&(e.type=QBe[e.type])}class GF{constructor(){this.count=0,this.updateFinished()}get finished(){return this._finished}updateFinished(){this.count++,this._finished=new Promise(t=>{this.resolve=t})}notifyFinished(){this.resolve()}then(t,n){return this.finished.then(t,n)}}const e$e=e=>e/100;class xne extends GF{constructor(t){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{const{motionValue:n}=this.options;if(n&&n.updatedAt!==Uo.now()&&this.tick(Uo.now()),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:r}=this.options;r&&r()},this.options=t,this.initAnimation(),this.play(),t.autoplay===!1&&this.pause()}initAnimation(){const{options:t}=this;vne(t);const{type:n=zx,repeat:r=0,repeatDelay:s=0,repeatType:i,velocity:a=0}=t;let{keyframes:o}=t;const l=n||zx;l!==zx&&typeof o[0]!="number"&&(this.mixKeyframes=fS(e$e,ane(o[0],o[1])),o=[0,100]);const c=l({...t,keyframes:o});i==="mirror"&&(this.mirroredGenerator=l({...t,keyframes:[...o].reverse(),velocity:-a})),c.calculatedDuration===null&&(c.calculatedDuration=qF(c));const{calculatedDuration:u}=c;this.calculatedDuration=u,this.resolvedDuration=u+s,this.totalDuration=this.resolvedDuration*(r+1)-s,this.generator=c}updateTime(t){const n=Math.round(t-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=n}tick(t,n=!1){const{generator:r,totalDuration:s,mixKeyframes:i,mirroredGenerator:a,resolvedDuration:o,calculatedDuration:l}=this;if(this.startTime===null)return r.next(0);const{delay:c=0,keyframes:u,repeat:d,repeatType:h,repeatDelay:m,type:y,onUpdate:b,finalKeyframe:v}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-s/this.speed,this.startTime)),n?this.currentTime=t:this.updateTime(t);const x=this.currentTime-c*(this.playbackSpeed>=0?1:-1),w=this.playbackSpeed>=0?x<0:x>s;this.currentTime=Math.max(x,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=s);let _=this.currentTime,k=r;if(d){const N=Math.min(this.currentTime,s)/o;let I=Math.floor(N),j=N%1;!j&&N>=1&&(j=1),j===1&&I--,I=Math.min(I,d+1),!!(I%2)&&(h==="reverse"?(j=1-j,m&&(j-=m/o)):h==="mirror"&&(k=a)),_=ff(0,1,j)*o}const C=w?{done:!1,value:u[0]}:k.next(_);i&&(C.value=i(C.value));let{done:T}=C;!w&&l!==null&&(T=this.playbackSpeed>=0?this.currentTime>=s:this.currentTime<=0);const A=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&T);return A&&y!==AP&&(C.value=HF(u,this.options,v,this.speed)),b&&b(C.value),A&&this.finish(),C}then(t,n){return this.finished.then(t,n)}get duration(){return Lu(this.calculatedDuration)}get time(){return Lu(this.currentTime)}set time(t){t=Fu(t),this.currentTime=t,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.playbackSpeed)}get speed(){return this.playbackSpeed}set speed(t){this.updateTime(Uo.now());const n=this.playbackSpeed!==t;this.playbackSpeed=t,n&&(this.time=Lu(this.currentTime))}play(){if(this.isStopped)return;const{driver:t=RBe,onPlay:n,startTime:r}=this.options;this.driver||(this.driver=t(i=>this.tick(i))),n&&n();const s=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=s):this.holdTime!==null?this.startTime=s-this.holdTime:this.startTime||(this.startTime=r??s),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(Uo.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:t}=this.options;t&&t()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown()}teardown(){this.notifyFinished(),this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}attachTimeline(t){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),t.observe(this)}}function t$e(e){for(let t=1;t<e.length;t++)e[t]??(e[t]=e[t-1])}const pm=e=>e*180/Math.PI,RP=e=>{const t=pm(Math.atan2(e[1],e[0]));return NP(t)},n$e={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:e=>(Math.abs(e[0])+Math.abs(e[3]))/2,rotate:RP,rotateZ:RP,skewX:e=>pm(Math.atan(e[1])),skewY:e=>pm(Math.atan(e[2])),skew:e=>(Math.abs(e[1])+Math.abs(e[2]))/2},NP=e=>(e=e%360,e<0&&(e+=360),e),PU=RP,OU=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),DU=e=>Math.sqrt(e[4]*e[4]+e[5]*e[5]),r$e={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:OU,scaleY:DU,scale:e=>(OU(e)+DU(e))/2,rotateX:e=>NP(pm(Math.atan2(e[6],e[5]))),rotateY:e=>NP(pm(Math.atan2(-e[2],e[0]))),rotateZ:PU,rotate:PU,skewX:e=>pm(Math.atan(e[4])),skewY:e=>pm(Math.atan(e[1])),skew:e=>(Math.abs(e[1])+Math.abs(e[4]))/2};function FU(e){return e.includes("scale")?1:0}function IP(e,t){if(!e||e==="none")return FU(t);const n=e.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let r,s;if(n)r=r$e,s=n;else{const o=e.match(/^matrix\(([-\d.e\s,]+)\)$/u);r=n$e,s=o}if(!s)return FU(t);const i=r[t],a=s[1].split(",").map(i$e);return typeof i=="function"?i(a):a[i]}const s$e=(e,t)=>{const{transform:n="none"}=getComputedStyle(e);return IP(n,t)};function i$e(e){return parseFloat(e.trim())}const LU=e=>e===kb||e===cr,a$e=new Set(["x","y","z"]),o$e=_b.filter(e=>!a$e.has(e));function l$e(e){const t=[];return o$e.forEach(n=>{const r=e.getValue(n);r!==void 0&&(t.push([n,r.get()]),r.set(n.startsWith("scale")?1:0))}),t}const Sm={width:({x:e},{paddingLeft:t="0",paddingRight:n="0"})=>e.max-e.min-parseFloat(t)-parseFloat(n),height:({y:e},{paddingTop:t="0",paddingBottom:n="0"})=>e.max-e.min-parseFloat(t)-parseFloat(n),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:(e,{transform:t})=>IP(t,"x"),y:(e,{transform:t})=>IP(t,"y")};Sm.translateX=Sm.x;Sm.translateY=Sm.y;const _m=new Set;let MP=!1,jP=!1,PP=!1;function wne(){if(jP){const e=Array.from(_m).filter(r=>r.needsMeasurement),t=new Set(e.map(r=>r.element)),n=new Map;t.forEach(r=>{const s=l$e(r);s.length&&(n.set(r,s),r.render())}),e.forEach(r=>r.measureInitialState()),t.forEach(r=>{r.render();const s=n.get(r);s&&s.forEach(([i,a])=>{var o;(o=r.getValue(i))==null||o.set(a)})}),e.forEach(r=>r.measureEndState()),e.forEach(r=>{r.suspendedScrollY!==void 0&&window.scrollTo(0,r.suspendedScrollY)})}jP=!1,MP=!1,_m.forEach(e=>e.complete(PP)),_m.clear()}function Sne(){_m.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(jP=!0)})}function c$e(){PP=!0,Sne(),wne(),PP=!1}class KF{constructor(t,n,r,s,i,a=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...t],this.onComplete=n,this.name=r,this.motionValue=s,this.element=i,this.isAsync=a}scheduleResolve(){this.isScheduled=!0,this.isAsync?(_m.add(this),MP||(MP=!0,si.read(Sne),si.resolveKeyframes(wne))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:t,name:n,element:r,motionValue:s}=this;if(t[0]===null){const i=s==null?void 0:s.get(),a=t[t.length-1];if(i!==void 0)t[0]=i;else if(r&&n){const o=r.readValue(n,a);o!=null&&(t[0]=o)}t[0]===void 0&&(t[0]=a),s&&i===void 0&&s.set(t[0])}t$e(t)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(t=!1){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,t),_m.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,_m.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const u$e=e=>e.startsWith("--");function d$e(e,t,n){u$e(t)?e.style.setProperty(t,n):e.style[t]=n}function YF(e){let t;return()=>(t===void 0&&(t=e()),t)}const f$e=YF(()=>window.ScrollTimeline!==void 0),h$e={};function p$e(e,t){const n=YF(e);return()=>h$e[t]??n()}const _ne=p$e(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),vx=([e,t,n,r])=>`cubic-bezier(${e}, ${t}, ${n}, ${r})`,BU={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:vx([0,.65,.55,1]),circOut:vx([.55,0,1,.45]),backIn:vx([.31,.01,.66,-.59]),backOut:vx([.33,1.53,.69,.99])};function Cne(e,t){if(e)return typeof e=="function"?_ne()?one(e,t):"ease-out":bne(e)?vx(e):Array.isArray(e)?e.map(n=>Cne(n,t)||BU.easeOut):BU[e]}function m$e(e,t,n,{delay:r=0,duration:s=300,repeat:i=0,repeatType:a="loop",ease:o="easeOut",times:l}={},c=void 0){const u={[t]:n};l&&(u.offset=l);const d=Cne(o,s);Array.isArray(d)&&(u.easing=d);const h={delay:r,duration:s,easing:Array.isArray(d)?"linear":d,fill:"both",iterations:i+1,direction:a==="reverse"?"alternate":"normal"};return c&&(h.pseudoElement=c),e.animate(u,h)}function kne(e){return typeof e=="function"&&"applyToOptions"in e}function g$e({type:e,...t}){return kne(e)&&_ne()?e.applyToOptions(t):(t.duration??(t.duration=300),t.ease??(t.ease="easeOut"),t)}class y$e extends GF{constructor(t){if(super(),this.finishedTime=null,this.isStopped=!1,!t)return;const{element:n,name:r,keyframes:s,pseudoElement:i,allowFlatten:a=!1,finalKeyframe:o,onComplete:l}=t;this.isPseudoElement=!!i,this.allowFlatten=a,this.options=t,TF(typeof t.type!="string");const c=g$e(t);this.animation=m$e(n,r,s,c,i),c.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!i){const u=HF(s,this.options,o,this.speed);this.updateMotionValue?this.updateMotionValue(u):d$e(n,r,u),this.animation.cancel()}l==null||l(),this.notifyFinished()},this.animation.oncancel=()=>this.notifyFinished()}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){var t,n;(n=(t=this.animation).finish)==null||n.call(t)}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:t}=this;t==="idle"||t==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var t,n;this.isPseudoElement||(n=(t=this.animation).commitStyles)==null||n.call(t)}get duration(){var n,r;const t=((r=(n=this.animation.effect)==null?void 0:n.getComputedTiming)==null?void 0:r.call(n).duration)||0;return Lu(Number(t))}get time(){return Lu(Number(this.animation.currentTime)||0)}set time(t){this.finishedTime=null,this.animation.currentTime=Fu(t)}get speed(){return this.animation.playbackRate}set speed(t){t<0&&(this.finishedTime=null),this.animation.playbackRate=t}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(t){this.animation.startTime=t}attachTimeline({timeline:t,observe:n}){var r;return this.allowFlatten&&((r=this.animation.effect)==null||r.updateTiming({easing:"linear"})),this.animation.onfinish=null,t&&f$e()?(this.animation.timeline=t,ec):n(this)}}const Ene={anticipate:mne,backInOut:pne,circInOut:yne};function b$e(e){return e in Ene}function v$e(e){typeof e.ease=="string"&&b$e(e.ease)&&(e.ease=Ene[e.ease])}const $U=10;class x$e extends y$e{constructor(t){v$e(t),vne(t),super(t),t.startTime&&(this.startTime=t.startTime),this.options=t}updateMotionValue(t){const{motionValue:n,onUpdate:r,onComplete:s,element:i,...a}=this.options;if(!n)return;if(t!==void 0){n.set(t);return}const o=new xne({...a,autoplay:!1}),l=Fu(this.finishedTime??this.time);n.setWithVelocity(o.sample(l-$U).value,o.sample(l).value,$U),o.stop()}}const zU=(e,t)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(Kh.test(e)||e==="0")&&!e.startsWith("url("));function w$e(e){const t=e[0];if(e.length===1)return!0;for(let n=0;n<e.length;n++)if(e[n]!==t)return!0}function S$e(e,t,n,r){const s=e[0];if(s===null)return!1;if(t==="display"||t==="visibility")return!0;const i=e[e.length-1],a=zU(s,t),o=zU(i,t);return!a||!o?!1:w$e(e)||(n==="spring"||kne(n))&&r}const _$e=new Set(["opacity","clipPath","filter","transform"]),C$e=YF(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function k$e(e){const{motionValue:t,name:n,repeatDelay:r,repeatType:s,damping:i,type:a}=e;if(!t||!t.owner||!(t.owner.current instanceof HTMLElement))return!1;const{onUpdate:o,transformTemplate:l}=t.owner.getProps();return C$e()&&n&&_$e.has(n)&&(n!=="transform"||!l)&&!o&&!r&&s!=="mirror"&&i!==0&&a!=="inertia"}const E$e=40;class T$e extends GF{constructor({autoplay:t=!0,delay:n=0,type:r="keyframes",repeat:s=0,repeatDelay:i=0,repeatType:a="loop",keyframes:o,name:l,motionValue:c,element:u,...d}){var y;super(),this.stop=()=>{var b,v;this._animation?(this._animation.stop(),(b=this.stopTimeline)==null||b.call(this)):(v=this.keyframeResolver)==null||v.cancel()},this.createdAt=Uo.now();const h={autoplay:t,delay:n,type:r,repeat:s,repeatDelay:i,repeatType:a,name:l,motionValue:c,element:u,...d},m=(u==null?void 0:u.KeyframeResolver)||KF;this.keyframeResolver=new m(o,(b,v,x)=>this.onKeyframesResolved(b,v,h,!x),l,c,u),(y=this.keyframeResolver)==null||y.scheduleResolve()}onKeyframesResolved(t,n,r,s){this.keyframeResolver=void 0;const{name:i,type:a,velocity:o,delay:l,isHandoff:c,onUpdate:u}=r;this.resolvedAt=Uo.now(),S$e(t,i,a,o)||((df.instantAnimations||!l)&&(u==null||u(HF(t,r,n))),t[0]=t[t.length-1],r.duration=0,r.repeat=0);const h={startTime:s?this.resolvedAt?this.resolvedAt-this.createdAt>E$e?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:n,...r,keyframes:t},m=!c&&k$e(h)?new x$e({...h,element:h.motionValue.owner.current}):new xne(h);m.finished.then(()=>this.notifyFinished()).catch(ec),this.pendingTimeline&&(this.stopTimeline=m.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=m}get finished(){return this._animation?this.animation.finished:this._finished}then(t,n){return this.finished.finally(t).then(()=>{})}get animation(){return this._animation||c$e(),this._animation}get duration(){return this.animation.duration}get time(){return this.animation.time}set time(t){this.animation.time=t}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(t){this.animation.speed=t}get startTime(){return this.animation.startTime}attachTimeline(t){return this._animation?this.stopTimeline=this.animation.attachTimeline(t):this.pendingTimeline=t,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this.animation.cancel()}}const ZF=(e,t,n,r={},s,i)=>a=>{const o=BF(r,e)||{},l=o.delay||r.delay||0;let{elapsed:c=0}=r;c=c-Fu(l);const u={keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:t.getVelocity(),...o,delay:-c,onUpdate:h=>{t.set(h),o.onUpdate&&o.onUpdate(h)},onComplete:()=>{a(),o.onComplete&&o.onComplete()},name:e,motionValue:t,element:i?void 0:s};lBe(o)||Object.assign(u,oBe(e,u)),u.duration&&(u.duration=Fu(u.duration)),u.repeatDelay&&(u.repeatDelay=Fu(u.repeatDelay)),u.from!==void 0&&(u.keyframes[0]=u.from);let d=!1;if((u.type===!1||u.duration===0&&!u.repeatDelay)&&(u.duration=0,u.delay===0&&(d=!0)),(df.instantAnimations||df.skipAnimations)&&(d=!0,u.duration=0,u.delay=0),u.allowFlatten=!o.type&&!o.ease,d&&!i&&t.get()!==void 0){const h=nBe(u.keyframes,o);if(h!==void 0){si.update(()=>{u.onUpdate(h),u.onComplete()});return}}return new T$e(u)},Tne=new Set(["width","height","top","left","right","bottom",..._b]);function A$e({protectedKeys:e,needsAnimating:t},n){const r=e.hasOwnProperty(n)&&t[n]!==!0;return t[n]=!1,r}function Ane(e,t,{delay:n=0,transitionOverride:r,type:s}={}){let{transition:i=e.getDefaultTransition(),transitionEnd:a,...o}=t;r&&(i=r);const l=[],c=s&&e.animationState&&e.animationState.getState()[s];for(const u in o){const d=e.getValue(u,e.latestValues[u]??null),h=o[u];if(h===void 0||c&&A$e(c,u))continue;const m={delay:n,...BF(i||{},u)},y=d.get();if(y!==void 0&&!d.isAnimating&&!Array.isArray(h)&&h===y&&!m.velocity)continue;let b=!1;if(window.MotionHandoffAnimation){const x=Qte(e);if(x){const w=window.MotionHandoffAnimation(x,u,si);w!==null&&(m.startTime=w,b=!0)}}CP(e,u),d.start(ZF(u,d,h,e.shouldReduceMotion&&Tne.has(u)?{type:!1}:m,e,b));const v=d.animation;v&&l.push(v)}return a&&Promise.all(l).then(()=>{si.update(()=>{a&&QLe(e,a)})}),l}function OP(e,t,n={}){var l;const r=Jw(e,t,n.type==="exit"?(l=e.presenceContext)==null?void 0:l.custom:void 0);let{transition:s=e.getDefaultTransition()||{}}=r||{};n.transitionOverride&&(s=n.transitionOverride);const i=r?()=>Promise.all(Ane(e,r,n)):()=>Promise.resolve(),a=e.variantChildren&&e.variantChildren.size?(c=0)=>{const{delayChildren:u=0,staggerChildren:d,staggerDirection:h}=s;return R$e(e,t,u+c,d,h,n)}:()=>Promise.resolve(),{when:o}=s;if(o){const[c,u]=o==="beforeChildren"?[i,a]:[a,i];return c().then(()=>u())}else return Promise.all([i(),a(n.delay)])}function R$e(e,t,n=0,r=0,s=1,i){const a=[],o=(e.variantChildren.size-1)*r,l=s===1?(c=0)=>c*r:(c=0)=>o-c*r;return Array.from(e.variantChildren).sort(N$e).forEach((c,u)=>{c.notify("AnimationStart",t),a.push(OP(c,t,{...i,delay:n+l(u)}).then(()=>c.notify("AnimationComplete",t)))}),Promise.all(a)}function N$e(e,t){return e.sortNodePosition(t)}function I$e(e,t,n={}){e.notify("AnimationStart",t);let r;if(Array.isArray(t)){const s=t.map(i=>OP(e,i,n));r=Promise.all(s)}else if(typeof t=="string")r=OP(e,t,n);else{const s=typeof t=="function"?Jw(e,t,n.custom):t;r=Promise.all(Ane(e,s,n))}return r.then(()=>{e.notify("AnimationComplete",t)})}function Rne(e,t){if(!Array.isArray(t))return!1;const n=t.length;if(n!==e.length)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}const M$e=CF.length;function Nne(e){if(!e)return;if(!e.isControllingVariants){const n=e.parent?Nne(e.parent)||{}:{};return e.props.initial!==void 0&&(n.initial=e.props.initial),n}const t={};for(let n=0;n<M$e;n++){const r=CF[n],s=e.props[r];(Yw(s)||s===!1)&&(t[r]=s)}return t}const j$e=[..._F].reverse(),P$e=_F.length;function O$e(e){return t=>Promise.all(t.map(({animation:n,options:r})=>I$e(e,n,r)))}function D$e(e){let t=O$e(e),n=UU(),r=!0;const s=l=>(c,u)=>{var h;const d=Jw(e,u,l==="exit"?(h=e.presenceContext)==null?void 0:h.custom:void 0);if(d){const{transition:m,transitionEnd:y,...b}=d;c={...c,...b,...y}}return c};function i(l){t=l(e)}function a(l){const{props:c}=e,u=Nne(e.parent)||{},d=[],h=new Set;let m={},y=1/0;for(let v=0;v<P$e;v++){const x=j$e[v],w=n[x],_=c[x]!==void 0?c[x]:u[x],k=Yw(_),C=x===l?w.isActive:null;C===!1&&(y=v);let T=_===u[x]&&_!==c[x]&&k;if(T&&r&&e.manuallyAnimateOnMount&&(T=!1),w.protectedKeys={...m},!w.isActive&&C===null||!_&&!w.prevProp||HT(_)||typeof _=="boolean")continue;const A=F$e(w.prevProp,_);let N=A||x===l&&w.isActive&&!T&&k||v>y&&k,I=!1;const j=Array.isArray(_)?_:[_];let L=j.reduce(s(x),{});C===!1&&(L={});const{prevResolvedValues:D={}}=w,H={...D,...L},O=W=>{N=!0,h.has(W)&&(I=!0,h.delete(W)),w.needsAnimating[W]=!0;const B=e.getValue(W);B&&(B.liveStyle=!1)};for(const W in H){const B=L[W],ne=D[W];if(m.hasOwnProperty(W))continue;let V=!1;_P(B)&&_P(ne)?V=!Rne(B,ne):V=B!==ne,V?B!=null?O(W):h.add(W):B!==void 0&&h.has(W)?O(W):w.protectedKeys[W]=!0}w.prevProp=_,w.prevResolvedValues=L,w.isActive&&(m={...m,...L}),r&&e.blockInitialAnimation&&(N=!1),N&&(!(T&&A)||I)&&d.push(...j.map(W=>({animation:W,options:{type:x}})))}if(h.size){const v={};if(typeof c.initial!="boolean"){const x=Jw(e,Array.isArray(c.initial)?c.initial[0]:c.initial);x&&x.transition&&(v.transition=x.transition)}h.forEach(x=>{const w=e.getBaseTarget(x),_=e.getValue(x);_&&(_.liveStyle=!0),v[x]=w??null}),d.push({animation:v})}let b=!!d.length;return r&&(c.initial===!1||c.initial===c.animate)&&!e.manuallyAnimateOnMount&&(b=!1),r=!1,b?t(d):Promise.resolve()}function o(l,c){var d;if(n[l].isActive===c)return Promise.resolve();(d=e.variantChildren)==null||d.forEach(h=>{var m;return(m=h.animationState)==null?void 0:m.setActive(l,c)}),n[l].isActive=c;const u=a(l);for(const h in n)n[h].protectedKeys={};return u}return{animateChanges:a,setActive:o,setAnimateFunction:i,getState:()=>n,reset:()=>{n=UU(),r=!0}}}function F$e(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!Rne(t,e):!1}function Jp(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function UU(){return{animate:Jp(!0),whileInView:Jp(),whileHover:Jp(),whileTap:Jp(),whileDrag:Jp(),whileFocus:Jp(),exit:Jp()}}class yp{constructor(t){this.isMounted=!1,this.node=t}update(){}}class L$e extends yp{constructor(t){super(t),t.animationState||(t.animationState=D$e(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();HT(t)&&(this.unmountControls=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:n}=this.node.prevProps||{};t!==n&&this.updateAnimationControlsSubscription()}unmount(){var t;this.node.animationState.reset(),(t=this.unmountControls)==null||t.call(this)}}let B$e=0;class $$e extends yp{constructor(){super(...arguments),this.id=B$e++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:n}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===r)return;const s=this.node.animationState.setActive("exit",!t);n&&!t&&s.then(()=>{n(this.id)})}mount(){const{register:t,onExitComplete:n}=this.node.presenceContext||{};n&&n(this.id),t&&(this.unmount=t(this.id))}unmount(){}}const z$e={animation:{Feature:L$e},exit:{Feature:$$e}};function n1(e,t,n,r={passive:!0}){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n)}const XF=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1;function pS(e){return{point:{x:e.pageX,y:e.pageY}}}const U$e=e=>t=>XF(t)&&e(t,pS(t));function Ux(e,t,n,r){return n1(e,t,U$e(n),r)}function Ine({top:e,left:t,right:n,bottom:r}){return{x:{min:t,max:n},y:{min:e,max:r}}}function q$e({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function V$e(e,t){if(!t)return e;const n=t({x:e.left,y:e.top}),r=t({x:e.right,y:e.bottom});return{top:n.y,left:n.x,bottom:r.y,right:r.x}}const Mne=1e-4,W$e=1-Mne,H$e=1+Mne,jne=.01,G$e=0-jne,K$e=0+jne;function io(e){return e.max-e.min}function Y$e(e,t,n){return Math.abs(e-t)<=n}function qU(e,t,n,r=.5){e.origin=r,e.originPoint=ni(t.min,t.max,e.origin),e.scale=io(n)/io(t),e.translate=ni(n.min,n.max,e.origin)-e.originPoint,(e.scale>=W$e&&e.scale<=H$e||isNaN(e.scale))&&(e.scale=1),(e.translate>=G$e&&e.translate<=K$e||isNaN(e.translate))&&(e.translate=0)}function qx(e,t,n,r){qU(e.x,t.x,n.x,r?r.originX:void 0),qU(e.y,t.y,n.y,r?r.originY:void 0)}function VU(e,t,n){e.min=n.min+t.min,e.max=e.min+io(t)}function Z$e(e,t,n){VU(e.x,t.x,n.x),VU(e.y,t.y,n.y)}function WU(e,t,n){e.min=t.min-n.min,e.max=e.min+io(t)}function Vx(e,t,n){WU(e.x,t.x,n.x),WU(e.y,t.y,n.y)}const HU=()=>({translate:0,scale:1,origin:0,originPoint:0}),F0=()=>({x:HU(),y:HU()}),GU=()=>({min:0,max:0}),yi=()=>({x:GU(),y:GU()});function Wl(e){return[e("x"),e("y")]}function cj(e){return e===void 0||e===1}function DP({scale:e,scaleX:t,scaleY:n}){return!cj(e)||!cj(t)||!cj(n)}function tm(e){return DP(e)||Pne(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function Pne(e){return KU(e.x)||KU(e.y)}function KU(e){return e&&e!=="0%"}function Fk(e,t,n){const r=e-n,s=t*r;return n+s}function YU(e,t,n,r,s){return s!==void 0&&(e=Fk(e,s,r)),Fk(e,n,r)+t}function FP(e,t=0,n=1,r,s){e.min=YU(e.min,t,n,r,s),e.max=YU(e.max,t,n,r,s)}function One(e,{x:t,y:n}){FP(e.x,t.translate,t.scale,t.originPoint),FP(e.y,n.translate,n.scale,n.originPoint)}const ZU=.999999999999,XU=1.0000000000001;function X$e(e,t,n,r=!1){const s=n.length;if(!s)return;t.x=t.y=1;let i,a;for(let o=0;o<s;o++){i=n[o],a=i.projectionDelta;const{visualElement:l}=i.options;l&&l.props.style&&l.props.style.display==="contents"||(r&&i.options.layoutScroll&&i.scroll&&i!==i.root&&B0(e,{x:-i.scroll.offset.x,y:-i.scroll.offset.y}),a&&(t.x*=a.x.scale,t.y*=a.y.scale,One(e,a)),r&&tm(i.latestValues)&&B0(e,i.latestValues))}t.x<XU&&t.x>ZU&&(t.x=1),t.y<XU&&t.y>ZU&&(t.y=1)}function L0(e,t){e.min=e.min+t,e.max=e.max+t}function JU(e,t,n,r,s=.5){const i=ni(e.min,e.max,s);FP(e,t,n,i,r)}function B0(e,t){JU(e.x,t.x,t.scaleX,t.scale,t.originX),JU(e.y,t.y,t.scaleY,t.scale,t.originY)}function Dne(e,t){return Ine(V$e(e.getBoundingClientRect(),t))}function J$e(e,t,n){const r=Dne(e,n),{scroll:s}=t;return s&&(L0(r.x,s.offset.x),L0(r.y,s.offset.y)),r}const Fne=({current:e})=>e?e.ownerDocument.defaultView:null,QU=(e,t)=>Math.abs(e-t);function Q$e(e,t){const n=QU(e.x,t.x),r=QU(e.y,t.y);return Math.sqrt(n**2+r**2)}class Lne{constructor(t,n,{transformPagePoint:r,contextWindow:s,dragSnapToOrigin:i=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const d=dj(this.lastMoveEventInfo,this.history),h=this.startEvent!==null,m=Q$e(d.offset,{x:0,y:0})>=3;if(!h&&!m)return;const{point:y}=d,{timestamp:b}=Ea;this.history.push({...y,timestamp:b});const{onStart:v,onMove:x}=this.handlers;h||(v&&v(this.lastMoveEvent,d),this.startEvent=this.lastMoveEvent),x&&x(this.lastMoveEvent,d)},this.handlePointerMove=(d,h)=>{this.lastMoveEvent=d,this.lastMoveEventInfo=uj(h,this.transformPagePoint),si.update(this.updatePoint,!0)},this.handlePointerUp=(d,h)=>{this.end();const{onEnd:m,onSessionEnd:y,resumeAnimation:b}=this.handlers;if(this.dragSnapToOrigin&&b&&b(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const v=dj(d.type==="pointercancel"?this.lastMoveEventInfo:uj(h,this.transformPagePoint),this.history);this.startEvent&&m&&m(d,v),y&&y(d,v)},!XF(t))return;this.dragSnapToOrigin=i,this.handlers=n,this.transformPagePoint=r,this.contextWindow=s||window;const a=pS(t),o=uj(a,this.transformPagePoint),{point:l}=o,{timestamp:c}=Ea;this.history=[{...l,timestamp:c}];const{onSessionStart:u}=n;u&&u(t,dj(o,this.history)),this.removeListeners=fS(Ux(this.contextWindow,"pointermove",this.handlePointerMove),Ux(this.contextWindow,"pointerup",this.handlePointerUp),Ux(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),Gh(this.updatePoint)}}function uj(e,t){return t?{point:t(e.point)}:e}function eq(e,t){return{x:e.x-t.x,y:e.y-t.y}}function dj({point:e},t){return{point:e,delta:eq(e,Bne(t)),offset:eq(e,eze(t)),velocity:tze(t,.1)}}function eze(e){return e[0]}function Bne(e){return e[e.length-1]}function tze(e,t){if(e.length<2)return{x:0,y:0};let n=e.length-1,r=null;const s=Bne(e);for(;n>=0&&(r=e[n],!(s.timestamp-r.timestamp>Fu(t)));)n--;if(!r)return{x:0,y:0};const i=Lu(s.timestamp-r.timestamp);if(i===0)return{x:0,y:0};const a={x:(s.x-r.x)/i,y:(s.y-r.y)/i};return a.x===1/0&&(a.x=0),a.y===1/0&&(a.y=0),a}function nze(e,{min:t,max:n},r){return t!==void 0&&e<t?e=r?ni(t,e,r.min):Math.max(e,t):n!==void 0&&e>n&&(e=r?ni(n,e,r.max):Math.min(e,n)),e}function tq(e,t,n){return{min:t!==void 0?e.min+t:void 0,max:n!==void 0?e.max+n-(e.max-e.min):void 0}}function rze(e,{top:t,left:n,bottom:r,right:s}){return{x:tq(e.x,n,s),y:tq(e.y,t,r)}}function nq(e,t){let n=t.min-e.min,r=t.max-e.max;return t.max-t.min<e.max-e.min&&([n,r]=[r,n]),{min:n,max:r}}function sze(e,t){return{x:nq(e.x,t.x),y:nq(e.y,t.y)}}function ize(e,t){let n=.5;const r=io(e),s=io(t);return s>r?n=t1(t.min,t.max-r,e.min):r>s&&(n=t1(e.min,e.max-s,t.min)),ff(0,1,n)}function aze(e,t){const n={};return t.min!==void 0&&(n.min=t.min-e.min),t.max!==void 0&&(n.max=t.max-e.min),n}const LP=.35;function oze(e=LP){return e===!1?e=0:e===!0&&(e=LP),{x:rq(e,"left","right"),y:rq(e,"top","bottom")}}function rq(e,t,n){return{min:sq(e,t),max:sq(e,n)}}function sq(e,t){return typeof e=="number"?e:e[t]||0}const Ac={x:!1,y:!1};function $ne(){return Ac.x||Ac.y}function lze(e){return e==="x"||e==="y"?Ac[e]?null:(Ac[e]=!0,()=>{Ac[e]=!1}):Ac.x||Ac.y?null:(Ac.x=Ac.y=!0,()=>{Ac.x=Ac.y=!1})}const cze=new WeakMap;class uze{constructor(t){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=yi(),this.visualElement=t}start(t,{snapToCursor:n=!1}={}){const{presenceContext:r}=this.visualElement;if(r&&r.isPresent===!1)return;const s=u=>{const{dragSnapToOrigin:d}=this.getProps();d?this.pauseAnimation():this.stopAnimation(),n&&this.snapToCursor(pS(u).point)},i=(u,d)=>{const{drag:h,dragPropagation:m,onDragStart:y}=this.getProps();if(h&&!m&&(this.openDragLock&&this.openDragLock(),this.openDragLock=lze(h),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Wl(v=>{let x=this.getAxisMotionValue(v).get()||0;if(Du.test(x)){const{projection:w}=this.visualElement;if(w&&w.layout){const _=w.layout.layoutBox[v];_&&(x=io(_)*(parseFloat(x)/100))}}this.originPoint[v]=x}),y&&si.postRender(()=>y(u,d)),CP(this.visualElement,"transform");const{animationState:b}=this.visualElement;b&&b.setActive("whileDrag",!0)},a=(u,d)=>{const{dragPropagation:h,dragDirectionLock:m,onDirectionLock:y,onDrag:b}=this.getProps();if(!h&&!this.openDragLock)return;const{offset:v}=d;if(m&&this.currentDirection===null){this.currentDirection=dze(v),this.currentDirection!==null&&y&&y(this.currentDirection);return}this.updateAxis("x",d.point,v),this.updateAxis("y",d.point,v),this.visualElement.render(),b&&b(u,d)},o=(u,d)=>this.stop(u,d),l=()=>Wl(u=>{var d;return this.getAnimationState(u)==="paused"&&((d=this.getAxisMotionValue(u).animation)==null?void 0:d.play())}),{dragSnapToOrigin:c}=this.getProps();this.panSession=new Lne(t,{onSessionStart:s,onStart:i,onMove:a,onSessionEnd:o,resumeAnimation:l},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:c,contextWindow:Fne(this.visualElement)})}stop(t,n){const r=this.isDragging;if(this.cancel(),!r)return;const{velocity:s}=n;this.startAnimation(s);const{onDragEnd:i}=this.getProps();i&&si.postRender(()=>i(t,n))}cancel(){this.isDragging=!1;const{projection:t,animationState:n}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(t,n,r){const{drag:s}=this.getProps();if(!r||!wC(t,s,this.currentDirection))return;const i=this.getAxisMotionValue(t);let a=this.originPoint[t]+r[t];this.constraints&&this.constraints[t]&&(a=nze(a,this.constraints[t],this.elastic[t])),i.set(a)}resolveConstraints(){var i;const{dragConstraints:t,dragElastic:n}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(i=this.visualElement.projection)==null?void 0:i.layout,s=this.constraints;t&&O0(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&r?this.constraints=rze(r.layoutBox,t):this.constraints=!1,this.elastic=oze(n),s!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&Wl(a=>{this.constraints!==!1&&this.getAxisMotionValue(a)&&(this.constraints[a]=aze(r.layoutBox[a],this.constraints[a]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:n}=this.getProps();if(!t||!O0(t))return!1;const r=t.current,{projection:s}=this.visualElement;if(!s||!s.layout)return!1;const i=J$e(r,s.root,this.visualElement.getTransformPagePoint());let a=sze(s.layout.layoutBox,i);if(n){const o=n(q$e(a));this.hasMutatedConstraints=!!o,o&&(a=Ine(o))}return a}startAnimation(t){const{drag:n,dragMomentum:r,dragElastic:s,dragTransition:i,dragSnapToOrigin:a,onDragTransitionEnd:o}=this.getProps(),l=this.constraints||{},c=Wl(u=>{if(!wC(u,n,this.currentDirection))return;let d=l&&l[u]||{};a&&(d={min:0,max:0});const h=s?200:1e6,m=s?40:1e7,y={type:"inertia",velocity:r?t[u]:0,bounceStiffness:h,bounceDamping:m,timeConstant:750,restDelta:1,restSpeed:10,...i,...d};return this.startAxisValueAnimation(u,y)});return Promise.all(c).then(o)}startAxisValueAnimation(t,n){const r=this.getAxisMotionValue(t);return CP(this.visualElement,t),r.start(ZF(t,r,0,n,this.visualElement,!1))}stopAnimation(){Wl(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){Wl(t=>{var n;return(n=this.getAxisMotionValue(t).animation)==null?void 0:n.pause()})}getAnimationState(t){var n;return(n=this.getAxisMotionValue(t).animation)==null?void 0:n.state}getAxisMotionValue(t){const n=`_drag${t.toUpperCase()}`,r=this.visualElement.getProps(),s=r[n];return s||this.visualElement.getValue(t,(r.initial?r.initial[t]:void 0)||0)}snapToCursor(t){Wl(n=>{const{drag:r}=this.getProps();if(!wC(n,r,this.currentDirection))return;const{projection:s}=this.visualElement,i=this.getAxisMotionValue(n);if(s&&s.layout){const{min:a,max:o}=s.layout.layoutBox[n];i.set(t[n]-ni(a,o,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:n}=this.getProps(),{projection:r}=this.visualElement;if(!O0(n)||!r||!this.constraints)return;this.stopAnimation();const s={x:0,y:0};Wl(a=>{const o=this.getAxisMotionValue(a);if(o&&this.constraints!==!1){const l=o.get();s[a]=ize({min:l,max:l},this.constraints[a])}});const{transformTemplate:i}=this.visualElement.getProps();this.visualElement.current.style.transform=i?i({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),Wl(a=>{if(!wC(a,t,null))return;const o=this.getAxisMotionValue(a),{min:l,max:c}=this.constraints[a];o.set(ni(l,c,s[a]))})}addListeners(){if(!this.visualElement.current)return;cze.set(this.visualElement,this);const t=this.visualElement.current,n=Ux(t,"pointerdown",l=>{const{drag:c,dragListener:u=!0}=this.getProps();c&&u&&this.start(l)}),r=()=>{const{dragConstraints:l}=this.getProps();O0(l)&&l.current&&(this.constraints=this.resolveRefConstraints())},{projection:s}=this.visualElement,i=s.addEventListener("measure",r);s&&!s.layout&&(s.root&&s.root.updateScroll(),s.updateLayout()),si.read(r);const a=n1(window,"resize",()=>this.scalePositionWithinConstraints()),o=s.addEventListener("didUpdate",({delta:l,hasLayoutChanged:c})=>{this.isDragging&&c&&(Wl(u=>{const d=this.getAxisMotionValue(u);d&&(this.originPoint[u]+=l[u].translate,d.set(d.get()+l[u].translate))}),this.visualElement.render())});return()=>{a(),n(),i(),o&&o()}}getProps(){const t=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:r=!1,dragPropagation:s=!1,dragConstraints:i=!1,dragElastic:a=LP,dragMomentum:o=!0}=t;return{...t,drag:n,dragDirectionLock:r,dragPropagation:s,dragConstraints:i,dragElastic:a,dragMomentum:o}}}function wC(e,t,n){return(t===!0||t===e)&&(n===null||n===e)}function dze(e,t=10){let n=null;return Math.abs(e.y)>t?n="y":Math.abs(e.x)>t&&(n="x"),n}class fze extends yp{constructor(t){super(t),this.removeGroupControls=ec,this.removeListeners=ec,this.controls=new uze(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||ec}unmount(){this.removeGroupControls(),this.removeListeners()}}const iq=e=>(t,n)=>{e&&si.postRender(()=>e(t,n))};class hze extends yp{constructor(){super(...arguments),this.removePointerDownListener=ec}onPointerDown(t){this.session=new Lne(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:Fne(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:n,onPan:r,onPanEnd:s}=this.node.getProps();return{onSessionStart:iq(t),onStart:iq(n),onMove:r,onEnd:(i,a)=>{delete this.session,s&&si.postRender(()=>s(i,a))}}}mount(){this.removePointerDownListener=Ux(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const t2={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function aq(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const Xv={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(cr.test(e))e=parseFloat(e);else return e;const n=aq(e,t.target.x),r=aq(e,t.target.y);return`${n}% ${r}%`}},pze={correct:(e,{treeScale:t,projectionDelta:n})=>{const r=e,s=Kh.parse(e);if(s.length>5)return r;const i=Kh.createTransformer(e),a=typeof s[0]!="number"?1:0,o=n.x.scale*t.x,l=n.y.scale*t.y;s[0+a]/=o,s[1+a]/=l;const c=ni(o,l,.5);return typeof s[2+a]=="number"&&(s[2+a]/=c),typeof s[3+a]=="number"&&(s[3+a]/=c),i(s)}};class mze extends E.Component{componentDidMount(){const{visualElement:t,layoutGroup:n,switchLayoutGroup:r,layoutId:s}=this.props,{projection:i}=t;TLe(gze),i&&(n.group&&n.group.add(i),r&&r.register&&s&&r.register(i),i.root.didUpdate(),i.addEventListener("animationComplete",()=>{this.safeToRemove()}),i.setOptions({...i.options,onExitComplete:()=>this.safeToRemove()})),t2.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:n,visualElement:r,drag:s,isPresent:i}=this.props,{projection:a}=r;return a&&(a.isPresent=i,s||t.layoutDependency!==n||n===void 0||t.isPresent!==i?a.willUpdate():this.safeToRemove(),t.isPresent!==i&&(i?a.promote():a.relegate()||si.postRender(()=>{const o=a.getStack();(!o||!o.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),EF.postRender(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:n,switchLayoutGroup:r}=this.props,{projection:s}=t;s&&(s.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(s),r&&r.deregister&&r.deregister(s))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function zne(e){const[t,n]=Ote(),r=E.useContext(vF);return f.jsx(mze,{...e,layoutGroup:r,switchLayoutGroup:E.useContext(zte),isPresent:t,safeToRemove:n})}const gze={borderRadius:{...Xv,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Xv,borderTopRightRadius:Xv,borderBottomLeftRadius:Xv,borderBottomRightRadius:Xv,boxShadow:pze};function yze(e,t,n){const r=qa(e)?e:Qw(e);return r.start(ZF("",r,t,n)),r.animation}function bze(e){return e instanceof SVGElement&&e.tagName!=="svg"}const vze=(e,t)=>e.depth-t.depth;class xze{constructor(){this.children=[],this.isDirty=!1}add(t){DF(this.children,t),this.isDirty=!0}remove(t){FF(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(vze),this.isDirty=!1,this.children.forEach(t)}}function wze(e,t){const n=Uo.now(),r=({timestamp:s})=>{const i=s-n;i>=t&&(Gh(r),e(i-t))};return si.setup(r,!0),()=>Gh(r)}const Une=["TopLeft","TopRight","BottomLeft","BottomRight"],Sze=Une.length,oq=e=>typeof e=="string"?parseFloat(e):e,lq=e=>typeof e=="number"||cr.test(e);function _ze(e,t,n,r,s,i){s?(e.opacity=ni(0,n.opacity??1,Cze(r)),e.opacityExit=ni(t.opacity??1,0,kze(r))):i&&(e.opacity=ni(t.opacity??1,n.opacity??1,r));for(let a=0;a<Sze;a++){const o=`border${Une[a]}Radius`;let l=cq(t,o),c=cq(n,o);if(l===void 0&&c===void 0)continue;l||(l=0),c||(c=0),l===0||c===0||lq(l)===lq(c)?(e[o]=Math.max(ni(oq(l),oq(c),r),0),(Du.test(c)||Du.test(l))&&(e[o]+="%")):e[o]=c}(t.rotate||n.rotate)&&(e.rotate=ni(t.rotate||0,n.rotate||0,r))}function cq(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const Cze=qne(0,.5,gne),kze=qne(.5,.95,ec);function qne(e,t,n){return r=>r<e?0:r>t?1:n(t1(e,t,r))}function uq(e,t){e.min=t.min,e.max=t.max}function zl(e,t){uq(e.x,t.x),uq(e.y,t.y)}function dq(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}function fq(e,t,n,r,s){return e-=t,e=Fk(e,1/n,r),s!==void 0&&(e=Fk(e,1/s,r)),e}function Eze(e,t=0,n=1,r=.5,s,i=e,a=e){if(Du.test(t)&&(t=parseFloat(t),t=ni(a.min,a.max,t/100)-a.min),typeof t!="number")return;let o=ni(i.min,i.max,r);e===i&&(o-=t),e.min=fq(e.min,t,n,o,s),e.max=fq(e.max,t,n,o,s)}function hq(e,t,[n,r,s],i,a){Eze(e,t[n],t[r],t[s],t.scale,i,a)}const Tze=["x","scaleX","originX"],Aze=["y","scaleY","originY"];function pq(e,t,n,r){hq(e.x,t,Tze,n?n.x:void 0,r?r.x:void 0),hq(e.y,t,Aze,n?n.y:void 0,r?r.y:void 0)}function mq(e){return e.translate===0&&e.scale===1}function Vne(e){return mq(e.x)&&mq(e.y)}function gq(e,t){return e.min===t.min&&e.max===t.max}function Rze(e,t){return gq(e.x,t.x)&&gq(e.y,t.y)}function yq(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function Wne(e,t){return yq(e.x,t.x)&&yq(e.y,t.y)}function bq(e){return io(e.x)/io(e.y)}function vq(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}class Nze{constructor(){this.members=[]}add(t){DF(this.members,t),t.scheduleRender()}remove(t){if(FF(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(t){const n=this.members.findIndex(s=>t===s);if(n===0)return!1;let r;for(let s=n;s>=0;s--){const i=this.members[s];if(i.isPresent!==!1){r=i;break}}return r?(this.promote(r),!0):!1}promote(t,n){const r=this.lead;if(t!==r&&(this.prevLead=r,this.lead=t,t.show(),r)){r.instance&&r.scheduleRender(),t.scheduleRender(),t.resumeFrom=r,n&&(t.resumeFrom.preserveOpacity=!0),r.snapshot&&(t.snapshot=r.snapshot,t.snapshot.latestValues=r.animationValues||r.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:s}=t.options;s===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:n,resumingFrom:r}=t;n.onExitComplete&&n.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function Ize(e,t,n){let r="";const s=e.x.translate/t.x,i=e.y.translate/t.y,a=(n==null?void 0:n.z)||0;if((s||i||a)&&(r=`translate3d(${s}px, ${i}px, ${a}px) `),(t.x!==1||t.y!==1)&&(r+=`scale(${1/t.x}, ${1/t.y}) `),n){const{transformPerspective:c,rotate:u,rotateX:d,rotateY:h,skewX:m,skewY:y}=n;c&&(r=`perspective(${c}px) ${r}`),u&&(r+=`rotate(${u}deg) `),d&&(r+=`rotateX(${d}deg) `),h&&(r+=`rotateY(${h}deg) `),m&&(r+=`skewX(${m}deg) `),y&&(r+=`skewY(${y}deg) `)}const o=e.x.scale*t.x,l=e.y.scale*t.y;return(o!==1||l!==1)&&(r+=`scale(${o}, ${l})`),r||"none"}const fj=["","X","Y","Z"],Mze={visibility:"hidden"},xq=1e3;let jze=0;function hj(e,t,n,r){const{latestValues:s}=t;s[e]&&(n[e]=s[e],t.setStaticValue(e,0),r&&(r[e]=0))}function Hne(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:t}=e.options;if(!t)return;const n=Qte(t);if(window.MotionHasOptimisedAnimation(n,"transform")){const{layout:s,layoutId:i}=e.options;window.MotionCancelOptimisedAnimation(n,"transform",si,!(s||i))}const{parent:r}=e;r&&!r.hasCheckedOptimisedAppear&&Hne(r)}function Gne({attachResizeListener:e,defaultParent:t,measureScroll:n,checkIsScrollRoot:r,resetTransform:s}){return class{constructor(a={},o=t==null?void 0:t()){this.id=jze++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(Dze),this.nodes.forEach(zze),this.nodes.forEach(Uze),this.nodes.forEach(Fze)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=a,this.root=o?o.root||o:this,this.path=o?[...o.path,o]:[],this.parent=o,this.depth=o?o.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new xze)}addEventListener(a,o){return this.eventHandlers.has(a)||this.eventHandlers.set(a,new LF),this.eventHandlers.get(a).add(o)}notifyListeners(a,...o){const l=this.eventHandlers.get(a);l&&l.notify(...o)}hasListeners(a){return this.eventHandlers.has(a)}mount(a){if(this.instance)return;this.isSVG=bze(a),this.instance=a;const{layoutId:o,layout:l,visualElement:c}=this.options;if(c&&!c.current&&c.mount(a),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(l||o)&&(this.isLayoutDirty=!0),e){let u;const d=()=>this.root.updateBlockedByResize=!1;e(a,()=>{this.root.updateBlockedByResize=!0,u&&u(),u=wze(d,250),t2.hasAnimatedSinceResize&&(t2.hasAnimatedSinceResize=!1,this.nodes.forEach(Sq))})}o&&this.root.registerSharedNode(o,this),this.options.animate!==!1&&c&&(o||l)&&this.addEventListener("didUpdate",({delta:u,hasLayoutChanged:d,hasRelativeLayoutChanged:h,layout:m})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const y=this.options.transition||c.getDefaultTransition()||Gze,{onLayoutAnimationStart:b,onLayoutAnimationComplete:v}=c.getProps(),x=!this.targetLayout||!Wne(this.targetLayout,m),w=!d&&h;if(this.options.layoutRoot||this.resumeFrom||w||d&&(x||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(u,w);const _={...BF(y,"layout"),onPlay:b,onComplete:v};(c.shouldReduceMotion||this.options.layoutRoot)&&(_.delay=0,_.type=!1),this.startAnimation(_)}else d||Sq(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=m})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const a=this.getStack();a&&a.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),Gh(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(qze),this.animationId++)}getTransformTemplate(){const{visualElement:a}=this.options;return a&&a.getProps().transformTemplate}willUpdate(a=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&Hne(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let u=0;u<this.path.length;u++){const d=this.path[u];d.shouldResetTransform=!0,d.updateScroll("snapshot"),d.options.layoutRoot&&d.willUpdate(!1)}const{layoutId:o,layout:l}=this.options;if(o===void 0&&!l)return;const c=this.getTransformTemplate();this.prevTransformTemplateValue=c?c(this.latestValues,""):void 0,this.updateSnapshot(),a&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(wq);return}this.isUpdating||this.nodes.forEach(Bze),this.isUpdating=!1,this.nodes.forEach($ze),this.nodes.forEach(Pze),this.nodes.forEach(Oze),this.clearAllSnapshots();const o=Uo.now();Ea.delta=ff(0,1e3/60,o-Ea.timestamp),Ea.timestamp=o,Ea.isProcessing=!0,ij.update.process(Ea),ij.preRender.process(Ea),ij.render.process(Ea),Ea.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,EF.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(Lze),this.sharedNodes.forEach(Vze)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,si.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){si.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!io(this.snapshot.measuredBox.x)&&!io(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const a=this.layout;this.layout=this.measure(!1),this.layoutCorrected=yi(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:o}=this.options;o&&o.notify("LayoutMeasure",this.layout.layoutBox,a?a.layoutBox:void 0)}updateScroll(a="measure"){let o=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===a&&(o=!1),o&&this.instance){const l=r(this.instance);this.scroll={animationId:this.root.animationId,phase:a,isRoot:l,offset:n(this.instance),wasRoot:this.scroll?this.scroll.isRoot:l}}}resetTransform(){if(!s)return;const a=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,o=this.projectionDelta&&!Vne(this.projectionDelta),l=this.getTransformTemplate(),c=l?l(this.latestValues,""):void 0,u=c!==this.prevTransformTemplateValue;a&&this.instance&&(o||tm(this.latestValues)||u)&&(s(this.instance,c),this.shouldResetTransform=!1,this.scheduleRender())}measure(a=!0){const o=this.measurePageBox();let l=this.removeElementScroll(o);return a&&(l=this.removeTransform(l)),Kze(l),{animationId:this.root.animationId,measuredBox:o,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){var c;const{visualElement:a}=this.options;if(!a)return yi();const o=a.measureViewportBox();if(!(((c=this.scroll)==null?void 0:c.wasRoot)||this.path.some(Yze))){const{scroll:u}=this.root;u&&(L0(o.x,u.offset.x),L0(o.y,u.offset.y))}return o}removeElementScroll(a){var l;const o=yi();if(zl(o,a),(l=this.scroll)!=null&&l.wasRoot)return o;for(let c=0;c<this.path.length;c++){const u=this.path[c],{scroll:d,options:h}=u;u!==this.root&&d&&h.layoutScroll&&(d.wasRoot&&zl(o,a),L0(o.x,d.offset.x),L0(o.y,d.offset.y))}return o}applyTransform(a,o=!1){const l=yi();zl(l,a);for(let c=0;c<this.path.length;c++){const u=this.path[c];!o&&u.options.layoutScroll&&u.scroll&&u!==u.root&&B0(l,{x:-u.scroll.offset.x,y:-u.scroll.offset.y}),tm(u.latestValues)&&B0(l,u.latestValues)}return tm(this.latestValues)&&B0(l,this.latestValues),l}removeTransform(a){const o=yi();zl(o,a);for(let l=0;l<this.path.length;l++){const c=this.path[l];if(!c.instance||!tm(c.latestValues))continue;DP(c.latestValues)&&c.updateSnapshot();const u=yi(),d=c.measurePageBox();zl(u,d),pq(o,c.latestValues,c.snapshot?c.snapshot.layoutBox:void 0,u)}return tm(this.latestValues)&&pq(o,this.latestValues),o}setTargetDelta(a){this.targetDelta=a,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(a){this.options={...this.options,...a,crossfade:a.crossfade!==void 0?a.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Ea.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(a=!1){var h;const o=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=o.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=o.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=o.isSharedProjectionDirty);const l=!!this.resumingFrom||this!==o;if(!(a||l&&this.isSharedProjectionDirty||this.isProjectionDirty||(h=this.parent)!=null&&h.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:u,layoutId:d}=this.options;if(!(!this.layout||!(u||d))){if(this.resolvedRelativeTargetAt=Ea.timestamp,!this.targetDelta&&!this.relativeTarget){const m=this.getClosestProjectingParent();m&&m.layout&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=yi(),this.relativeTargetOrigin=yi(),Vx(this.relativeTargetOrigin,this.layout.layoutBox,m.layout.layoutBox),zl(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=yi(),this.targetWithTransforms=yi()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),Z$e(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):zl(this.target,this.layout.layoutBox),One(this.target,this.targetDelta)):zl(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const m=this.getClosestProjectingParent();m&&!!m.resumingFrom==!!this.resumingFrom&&!m.options.layoutScroll&&m.target&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=yi(),this.relativeTargetOrigin=yi(),Vx(this.relativeTargetOrigin,this.target,m.target),zl(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||DP(this.parent.latestValues)||Pne(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var y;const a=this.getLead(),o=!!this.resumingFrom||this!==a;let l=!0;if((this.isProjectionDirty||(y=this.parent)!=null&&y.isProjectionDirty)&&(l=!1),o&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(l=!1),this.resolvedRelativeTargetAt===Ea.timestamp&&(l=!1),l)return;const{layout:c,layoutId:u}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(c||u))return;zl(this.layoutCorrected,this.layout.layoutBox);const d=this.treeScale.x,h=this.treeScale.y;X$e(this.layoutCorrected,this.treeScale,this.path,o),a.layout&&!a.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(a.target=a.layout.layoutBox,a.targetWithTransforms=yi());const{target:m}=a;if(!m){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(dq(this.prevProjectionDelta.x,this.projectionDelta.x),dq(this.prevProjectionDelta.y,this.projectionDelta.y)),qx(this.projectionDelta,this.layoutCorrected,m,this.latestValues),(this.treeScale.x!==d||this.treeScale.y!==h||!vq(this.projectionDelta.x,this.prevProjectionDelta.x)||!vq(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",m))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(a=!0){var o;if((o=this.options.visualElement)==null||o.scheduleRender(),a){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=F0(),this.projectionDelta=F0(),this.projectionDeltaWithTransform=F0()}setAnimationOrigin(a,o=!1){const l=this.snapshot,c=l?l.latestValues:{},u={...this.latestValues},d=F0();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!o;const h=yi(),m=l?l.source:void 0,y=this.layout?this.layout.source:void 0,b=m!==y,v=this.getStack(),x=!v||v.members.length<=1,w=!!(b&&!x&&this.options.crossfade===!0&&!this.path.some(Hze));this.animationProgress=0;let _;this.mixTargetDelta=k=>{const C=k/1e3;_q(d.x,a.x,C),_q(d.y,a.y,C),this.setTargetDelta(d),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Vx(h,this.layout.layoutBox,this.relativeParent.layout.layoutBox),Wze(this.relativeTarget,this.relativeTargetOrigin,h,C),_&&Rze(this.relativeTarget,_)&&(this.isProjectionDirty=!1),_||(_=yi()),zl(_,this.relativeTarget)),b&&(this.animationValues=u,_ze(u,c,this.latestValues,C,w,x)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=C},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(a){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(Gh(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=si.update(()=>{t2.hasAnimatedSinceResize=!0,this.currentAnimation=yze(0,xq,{...a,onUpdate:o=>{this.mixTargetDelta(o),a.onUpdate&&a.onUpdate(o)},onStop:()=>{},onComplete:()=>{a.onComplete&&a.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const a=this.getStack();a&&a.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(xq),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const a=this.getLead();let{targetWithTransforms:o,target:l,layout:c,latestValues:u}=a;if(!(!o||!l||!c)){if(this!==a&&this.layout&&c&&Kne(this.options.animationType,this.layout.layoutBox,c.layoutBox)){l=this.target||yi();const d=io(this.layout.layoutBox.x);l.x.min=a.target.x.min,l.x.max=l.x.min+d;const h=io(this.layout.layoutBox.y);l.y.min=a.target.y.min,l.y.max=l.y.min+h}zl(o,l),B0(o,u),qx(this.projectionDeltaWithTransform,this.layoutCorrected,o,u)}}registerSharedNode(a,o){this.sharedNodes.has(a)||this.sharedNodes.set(a,new Nze),this.sharedNodes.get(a).add(o);const c=o.options.initialPromotionConfig;o.promote({transition:c?c.transition:void 0,preserveFollowOpacity:c&&c.shouldPreserveFollowOpacity?c.shouldPreserveFollowOpacity(o):void 0})}isLead(){const a=this.getStack();return a?a.lead===this:!0}getLead(){var o;const{layoutId:a}=this.options;return a?((o=this.getStack())==null?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:a}=this.options;return a?(o=this.getStack())==null?void 0:o.prevLead:void 0}getStack(){const{layoutId:a}=this.options;if(a)return this.root.sharedNodes.get(a)}promote({needsReset:a,transition:o,preserveFollowOpacity:l}={}){const c=this.getStack();c&&c.promote(this,l),a&&(this.projectionDelta=void 0,this.needsReset=!0),o&&this.setOptions({transition:o})}relegate(){const a=this.getStack();return a?a.relegate(this):!1}resetSkewAndRotation(){const{visualElement:a}=this.options;if(!a)return;let o=!1;const{latestValues:l}=a;if((l.z||l.rotate||l.rotateX||l.rotateY||l.rotateZ||l.skewX||l.skewY)&&(o=!0),!o)return;const c={};l.z&&hj("z",a,c,this.animationValues);for(let u=0;u<fj.length;u++)hj(`rotate${fj[u]}`,a,c,this.animationValues),hj(`skew${fj[u]}`,a,c,this.animationValues);a.render();for(const u in c)a.setStaticValue(u,c[u]),this.animationValues&&(this.animationValues[u]=c[u]);a.scheduleRender()}getProjectionStyles(a){if(!this.instance||this.isSVG)return;if(!this.isVisible)return Mze;const o={visibility:""},l=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,o.opacity="",o.pointerEvents=QC(a==null?void 0:a.pointerEvents)||"",o.transform=l?l(this.latestValues,""):"none",o;const c=this.getLead();if(!this.projectionDelta||!this.layout||!c.target){const m={};return this.options.layoutId&&(m.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,m.pointerEvents=QC(a==null?void 0:a.pointerEvents)||""),this.hasProjected&&!tm(this.latestValues)&&(m.transform=l?l({},""):"none",this.hasProjected=!1),m}const u=c.animationValues||c.latestValues;this.applyTransformsToTarget(),o.transform=Ize(this.projectionDeltaWithTransform,this.treeScale,u),l&&(o.transform=l(u,o.transform));const{x:d,y:h}=this.projectionDelta;o.transformOrigin=`${d.origin*100}% ${h.origin*100}% 0`,c.animationValues?o.opacity=c===this?u.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:u.opacityExit:o.opacity=c===this?u.opacity!==void 0?u.opacity:"":u.opacityExit!==void 0?u.opacityExit:0;for(const m in Zw){if(u[m]===void 0)continue;const{correct:y,applyTo:b,isCSSVariable:v}=Zw[m],x=o.transform==="none"?u[m]:y(u[m],c);if(b){const w=b.length;for(let _=0;_<w;_++)o[b[_]]=x}else v?this.options.visualElement.renderState.vars[m]=x:o[m]=x}return this.options.layoutId&&(o.pointerEvents=c===this?QC(a==null?void 0:a.pointerEvents)||"":"none"),o}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(a=>{var o;return(o=a.currentAnimation)==null?void 0:o.stop()}),this.root.nodes.forEach(wq),this.root.sharedNodes.clear()}}}function Pze(e){e.updateLayout()}function Oze(e){var n;const t=((n=e.resumeFrom)==null?void 0:n.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&t&&e.hasListeners("didUpdate")){const{layoutBox:r,measuredBox:s}=e.layout,{animationType:i}=e.options,a=t.source!==e.layout.source;i==="size"?Wl(d=>{const h=a?t.measuredBox[d]:t.layoutBox[d],m=io(h);h.min=r[d].min,h.max=h.min+m}):Kne(i,t.layoutBox,r)&&Wl(d=>{const h=a?t.measuredBox[d]:t.layoutBox[d],m=io(r[d]);h.max=h.min+m,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[d].max=e.relativeTarget[d].min+m)});const o=F0();qx(o,r,t.layoutBox);const l=F0();a?qx(l,e.applyTransform(s,!0),t.measuredBox):qx(l,r,t.layoutBox);const c=!Vne(o);let u=!1;if(!e.resumeFrom){const d=e.getClosestProjectingParent();if(d&&!d.resumeFrom){const{snapshot:h,layout:m}=d;if(h&&m){const y=yi();Vx(y,t.layoutBox,h.layoutBox);const b=yi();Vx(b,r,m.layoutBox),Wne(y,b)||(u=!0),d.options.layoutRoot&&(e.relativeTarget=b,e.relativeTargetOrigin=y,e.relativeParent=d)}}}e.notifyListeners("didUpdate",{layout:r,snapshot:t,delta:l,layoutDelta:o,hasLayoutChanged:c,hasRelativeLayoutChanged:u})}else if(e.isLead()){const{onExitComplete:r}=e.options;r&&r()}e.options.transition=void 0}function Dze(e){e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function Fze(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function Lze(e){e.clearSnapshot()}function wq(e){e.clearMeasurements()}function Bze(e){e.isLayoutDirty=!1}function $ze(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function Sq(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function zze(e){e.resolveTargetDelta()}function Uze(e){e.calcProjection()}function qze(e){e.resetSkewAndRotation()}function Vze(e){e.removeLeadSnapshot()}function _q(e,t,n){e.translate=ni(t.translate,0,n),e.scale=ni(t.scale,1,n),e.origin=t.origin,e.originPoint=t.originPoint}function Cq(e,t,n,r){e.min=ni(t.min,n.min,r),e.max=ni(t.max,n.max,r)}function Wze(e,t,n,r){Cq(e.x,t.x,n.x,r),Cq(e.y,t.y,n.y,r)}function Hze(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const Gze={duration:.45,ease:[.4,0,.1,1]},kq=e=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),Eq=kq("applewebkit/")&&!kq("chrome/")?Math.round:ec;function Tq(e){e.min=Eq(e.min),e.max=Eq(e.max)}function Kze(e){Tq(e.x),Tq(e.y)}function Kne(e,t,n){return e==="position"||e==="preserve-aspect"&&!Y$e(bq(t),bq(n),.2)}function Yze(e){var t;return e!==e.root&&((t=e.scroll)==null?void 0:t.wasRoot)}const Zze=Gne({attachResizeListener:(e,t)=>n1(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),pj={current:void 0},Yne=Gne({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!pj.current){const e=new Zze({});e.mount(window),e.setOptions({layoutScroll:!0}),pj.current=e}return pj.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),Xze={pan:{Feature:hze},drag:{Feature:fze,ProjectionNode:Yne,MeasureLayout:zne}};function Jze(e,t,n){if(e instanceof EventTarget)return[e];if(typeof e=="string"){let r=document;const s=(n==null?void 0:n[e])??r.querySelectorAll(e);return s?Array.from(s):[]}return Array.from(e)}function Zne(e,t){const n=Jze(e),r=new AbortController,s={passive:!0,...t,signal:r.signal};return[n,s,()=>r.abort()]}function Aq(e){return!(e.pointerType==="touch"||$ne())}function Qze(e,t,n={}){const[r,s,i]=Zne(e,n),a=o=>{if(!Aq(o))return;const{target:l}=o,c=t(l,o);if(typeof c!="function"||!l)return;const u=d=>{Aq(d)&&(c(d),l.removeEventListener("pointerleave",u))};l.addEventListener("pointerleave",u,s)};return r.forEach(o=>{o.addEventListener("pointerenter",a,s)}),i}function Rq(e,t,n){const{props:r}=e;e.animationState&&r.whileHover&&e.animationState.setActive("whileHover",n==="Start");const s="onHover"+n,i=r[s];i&&si.postRender(()=>i(t,pS(t)))}class e9e extends yp{mount(){const{current:t}=this.node;t&&(this.unmount=Qze(t,(n,r)=>(Rq(this.node,r,"Start"),s=>Rq(this.node,s,"End"))))}unmount(){}}class t9e extends yp{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=fS(n1(this.node.current,"focus",()=>this.onFocus()),n1(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}const Xne=(e,t)=>t?e===t?!0:Xne(e,t.parentElement):!1,n9e=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function r9e(e){return n9e.has(e.tagName)||e.tabIndex!==-1}const xx=new WeakSet;function Nq(e){return t=>{t.key==="Enter"&&e(t)}}function mj(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}const s9e=(e,t)=>{const n=e.currentTarget;if(!n)return;const r=Nq(()=>{if(xx.has(n))return;mj(n,"down");const s=Nq(()=>{mj(n,"up")}),i=()=>mj(n,"cancel");n.addEventListener("keyup",s,t),n.addEventListener("blur",i,t)});n.addEventListener("keydown",r,t),n.addEventListener("blur",()=>n.removeEventListener("keydown",r),t)};function Iq(e){return XF(e)&&!$ne()}function i9e(e,t,n={}){const[r,s,i]=Zne(e,n),a=o=>{const l=o.currentTarget;if(!Iq(o)||xx.has(l))return;xx.add(l);const c=t(l,o),u=(m,y)=>{window.removeEventListener("pointerup",d),window.removeEventListener("pointercancel",h),!(!Iq(m)||!xx.has(l))&&(xx.delete(l),typeof c=="function"&&c(m,{success:y}))},d=m=>{u(m,l===window||l===document||n.useGlobalTarget||Xne(l,m.target))},h=m=>{u(m,!1)};window.addEventListener("pointerup",d,s),window.addEventListener("pointercancel",h,s)};return r.forEach(o=>{(n.useGlobalTarget?window:o).addEventListener("pointerdown",a,s),o instanceof HTMLElement&&(o.addEventListener("focus",c=>s9e(c,s)),!r9e(o)&&!o.hasAttribute("tabindex")&&(o.tabIndex=0))}),i}function Mq(e,t,n){const{props:r}=e;if(e.current instanceof HTMLButtonElement&&e.current.disabled)return;e.animationState&&r.whileTap&&e.animationState.setActive("whileTap",n==="Start");const s="onTap"+(n==="End"?"":n),i=r[s];i&&si.postRender(()=>i(t,pS(t)))}class a9e extends yp{mount(){const{current:t}=this.node;t&&(this.unmount=i9e(t,(n,r)=>(Mq(this.node,r,"Start"),(s,{success:i})=>Mq(this.node,s,i?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const BP=new WeakMap,gj=new WeakMap,o9e=e=>{const t=BP.get(e.target);t&&t(e)},l9e=e=>{e.forEach(o9e)};function c9e({root:e,...t}){const n=e||document;gj.has(n)||gj.set(n,{});const r=gj.get(n),s=JSON.stringify(t);return r[s]||(r[s]=new IntersectionObserver(l9e,{root:e,...t})),r[s]}function u9e(e,t,n){const r=c9e(t);return BP.set(e,n),r.observe(e),()=>{BP.delete(e),r.unobserve(e)}}const d9e={some:0,all:1};class f9e extends yp{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:n,margin:r,amount:s="some",once:i}=t,a={root:n?n.current:void 0,rootMargin:r,threshold:typeof s=="number"?s:d9e[s]},o=l=>{const{isIntersecting:c}=l;if(this.isInView===c||(this.isInView=c,i&&!c&&this.hasEnteredView))return;c&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",c);const{onViewportEnter:u,onViewportLeave:d}=this.node.getProps(),h=c?u:d;h&&h(l)};return u9e(this.node.current,a,o)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:n}=this.node;["amount","margin","root"].some(h9e(t,n))&&this.startObserver()}unmount(){}}function h9e({viewport:e={}},{viewport:t={}}={}){return n=>e[n]!==t[n]}const p9e={inView:{Feature:f9e},tap:{Feature:a9e},focus:{Feature:t9e},hover:{Feature:e9e}},m9e={layout:{ProjectionNode:Yne,MeasureLayout:zne}},$P={current:null},Jne={current:!1};function g9e(){if(Jne.current=!0,!!wF)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>$P.current=e.matches;e.addListener(t),t()}else $P.current=!1}const y9e=new WeakMap;function b9e(e,t,n){for(const r in t){const s=t[r],i=n[r];if(qa(s))e.addValue(r,s);else if(qa(i))e.addValue(r,Qw(s,{owner:e}));else if(i!==s)if(e.hasValue(r)){const a=e.getValue(r);a.liveStyle===!0?a.jump(s):a.hasAnimated||a.set(s)}else{const a=e.getStaticValue(r);e.addValue(r,Qw(a!==void 0?a:s,{owner:e}))}}for(const r in n)t[r]===void 0&&e.removeValue(r);return t}const Qne=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e),ere=e=>/^0[^.\s]+$/u.test(e),v9e={test:e=>e==="auto",parse:e=>e},tre=e=>t=>t.test(e),nre=[kb,cr,Du,mh,RLe,ALe,v9e],jq=e=>nre.find(tre(e)),x9e=[...nre,Ba,Kh],w9e=e=>x9e.find(tre(e)),S9e=new Set(["brightness","contrast","saturate","opacity"]);function _9e(e){const[t,n]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[r]=n.match($F)||[];if(!r)return e;const s=n.replace(r,"");let i=S9e.has(t)?1:0;return r!==n&&(i*=100),t+"("+i+s+")"}const C9e=/\b([a-z-]*)\(.*?\)/gu,zP={...Kh,getAnimatableNone:e=>{const t=e.match(C9e);return t?t.map(_9e).join(" "):e}},k9e={...NF,color:Ba,backgroundColor:Ba,outlineColor:Ba,fill:Ba,stroke:Ba,borderColor:Ba,borderTopColor:Ba,borderRightColor:Ba,borderBottomColor:Ba,borderLeftColor:Ba,filter:zP,WebkitFilter:zP},rre=e=>k9e[e];function sre(e,t){let n=rre(e);return n!==zP&&(n=Kh),n.getAnimatableNone?n.getAnimatableNone(t):void 0}const Pq=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class E9e{scrapeMotionValuesFromProps(t,n,r){return{}}constructor({parent:t,props:n,presenceContext:r,reducedMotionConfig:s,blockInitialAnimation:i,visualState:a},o={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=KF,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const h=Uo.now();this.renderScheduledAt<h&&(this.renderScheduledAt=h,si.render(this.render,!1,!0))};const{latestValues:l,renderState:c}=a;this.latestValues=l,this.baseTarget={...l},this.initialValues=n.initial?{...l}:{},this.renderState=c,this.parent=t,this.props=n,this.presenceContext=r,this.depth=t?t.depth+1:0,this.reducedMotionConfig=s,this.options=o,this.blockInitialAnimation=!!i,this.isControllingVariants=GT(n),this.isVariantNode=Bte(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:u,...d}=this.scrapeMotionValuesFromProps(n,{},this);for(const h in d){const m=d[h];l[h]!==void 0&&qa(m)&&m.set(l[h],!1)}}mount(t){this.current=t,y9e.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((n,r)=>this.bindToMotionValue(r,n)),Jne.current||g9e(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:$P.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),Gh(this.notifyUpdate),Gh(this.render),this.valueSubscriptions.forEach(t=>t()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const t in this.events)this.events[t].clear();for(const t in this.features){const n=this.features[t];n&&(n.unmount(),n.isMounted=!1)}this.current=null}bindToMotionValue(t,n){this.valueSubscriptions.has(t)&&this.valueSubscriptions.get(t)();const r=Cb.has(t);r&&this.onBindTransform&&this.onBindTransform();const s=n.on("change",o=>{this.latestValues[t]=o,this.props.onUpdate&&si.preRender(this.notifyUpdate),r&&this.projection&&(this.projection.isTransformDirty=!0)}),i=n.on("renderRequest",this.scheduleRender);let a;window.MotionCheckAppearSync&&(a=window.MotionCheckAppearSync(this,t,n)),this.valueSubscriptions.set(t,()=>{s(),i(),a&&a(),n.owner&&n.stop()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}updateFeatures(){let t="animation";for(t in Fy){const n=Fy[t];if(!n)continue;const{isEnabled:r,Feature:s}=n;if(!this.features[t]&&s&&r(this.props)&&(this.features[t]=new s(this)),this.features[t]){const i=this.features[t];i.isMounted?i.update():(i.mount(),i.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):yi()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,n){this.latestValues[t]=n}update(t,n){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let r=0;r<Pq.length;r++){const s=Pq[r];this.propEventSubscriptions[s]&&(this.propEventSubscriptions[s](),delete this.propEventSubscriptions[s]);const i="on"+s,a=t[i];a&&(this.propEventSubscriptions[s]=this.on(s,a))}this.prevMotionValues=b9e(this,this.scrapeMotionValuesFromProps(t,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(t){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(t),()=>n.variantChildren.delete(t)}addValue(t,n){const r=this.values.get(t);n!==r&&(r&&this.removeValue(t),this.bindToMotionValue(t,n),this.values.set(t,n),this.latestValues[t]=n.get())}removeValue(t){this.values.delete(t);const n=this.valueSubscriptions.get(t);n&&(n(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,n){if(this.props.values&&this.props.values[t])return this.props.values[t];let r=this.values.get(t);return r===void 0&&n!==void 0&&(r=Qw(n===null?void 0:n,{owner:this}),this.addValue(t,r)),r}readValue(t,n){let r=this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:this.getBaseTargetFromProps(this.props,t)??this.readValueFromInstance(this.current,t,this.options);return r!=null&&(typeof r=="string"&&(Qne(r)||ere(r))?r=parseFloat(r):!w9e(r)&&Kh.test(n)&&(r=sre(t,n)),this.setBaseTarget(t,qa(r)?r.get():r)),qa(r)?r.get():r}setBaseTarget(t,n){this.baseTarget[t]=n}getBaseTarget(t){var i;const{initial:n}=this.props;let r;if(typeof n=="string"||typeof n=="object"){const a=PF(this.props,n,(i=this.presenceContext)==null?void 0:i.custom);a&&(r=a[t])}if(n&&r!==void 0)return r;const s=this.getBaseTargetFromProps(this.props,t);return s!==void 0&&!qa(s)?s:this.initialValues[t]!==void 0&&r===void 0?void 0:this.baseTarget[t]}on(t,n){return this.events[t]||(this.events[t]=new LF),this.events[t].add(n)}notify(t,...n){this.events[t]&&this.events[t].notify(...n)}}const T9e=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function A9e(e){const t=T9e.exec(e);if(!t)return[,];const[,n,r,s]=t;return[`--${n??r}`,s]}function ire(e,t,n=1){const[r,s]=A9e(e);if(!r)return;const i=window.getComputedStyle(t).getPropertyValue(r);if(i){const a=i.trim();return Qne(a)?parseFloat(a):a}return RF(s)?ire(s,t,n+1):s}function R9e(e){return typeof e=="number"?e===0:e!==null?e==="none"||e==="0"||ere(e):!0}const N9e=new Set(["auto","none","0"]);function I9e(e,t,n){let r=0,s;for(;r<e.length&&!s;){const i=e[r];typeof i=="string"&&!N9e.has(i)&&e1(i).values.length&&(s=e[r]),r++}if(s&&n)for(const i of t)e[i]=sre(n,s)}class M9e extends KF{constructor(t,n,r,s,i){super(t,n,r,s,i,!0)}readKeyframes(){const{unresolvedKeyframes:t,element:n,name:r}=this;if(!n||!n.current)return;super.readKeyframes();for(let l=0;l<t.length;l++){let c=t[l];if(typeof c=="string"&&(c=c.trim(),RF(c))){const u=ire(c,n.current);u!==void 0&&(t[l]=u),l===t.length-1&&(this.finalKeyframe=c)}}if(this.resolveNoneKeyframes(),!Tne.has(r)||t.length!==2)return;const[s,i]=t,a=jq(s),o=jq(i);if(a!==o)if(LU(a)&&LU(o))for(let l=0;l<t.length;l++){const c=t[l];typeof c=="string"&&(t[l]=parseFloat(c))}else Sm[r]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:t,name:n}=this,r=[];for(let s=0;s<t.length;s++)(t[s]===null||R9e(t[s]))&&r.push(s);r.length&&I9e(t,r,n)}measureInitialState(){const{element:t,unresolvedKeyframes:n,name:r}=this;if(!t||!t.current)return;r==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Sm[r](t.measureViewportBox(),window.getComputedStyle(t.current)),n[0]=this.measuredOrigin;const s=n[n.length-1];s!==void 0&&t.getValue(r,s).jump(s,!1)}measureEndState(){var o;const{element:t,name:n,unresolvedKeyframes:r}=this;if(!t||!t.current)return;const s=t.getValue(n);s&&s.jump(this.measuredOrigin,!1);const i=r.length-1,a=r[i];r[i]=Sm[n](t.measureViewportBox(),window.getComputedStyle(t.current)),a!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=a),(o=this.removedTransforms)!=null&&o.length&&this.removedTransforms.forEach(([l,c])=>{t.getValue(l).set(c)}),this.resolveNoneKeyframes()}}class are extends E9e{constructor(){super(...arguments),this.KeyframeResolver=M9e}sortInstanceNodePosition(t,n){return t.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(t,n){return t.style?t.style[n]:void 0}removeValueFromRenderState(t,{vars:n,style:r}){delete n[t],delete r[t]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;qa(t)&&(this.childSubscription=t.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}}function ore(e,{style:t,vars:n},r,s){Object.assign(e.style,t,s&&s.getProjectionStyles(r));for(const i in n)e.style.setProperty(i,n[i])}function j9e(e){return window.getComputedStyle(e)}class P9e extends are{constructor(){super(...arguments),this.type="html",this.renderInstance=ore}readValueFromInstance(t,n){if(Cb.has(n))return s$e(t,n);{const r=j9e(t),s=(AF(n)?r.getPropertyValue(n):r[n])||0;return typeof s=="string"?s.trim():s}}measureInstanceViewportBox(t,{transformPagePoint:n}){return Dne(t,n)}build(t,n,r){IF(t,n,r.transformTemplate)}scrapeMotionValuesFromProps(t,n,r){return OF(t,n,r)}}const lre=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function O9e(e,t,n,r){ore(e,t,void 0,r);for(const s in t.attrs)e.setAttribute(lre.has(s)?s:kF(s),t.attrs[s])}class D9e extends are{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=yi}getBaseTargetFromProps(t,n){return t[n]}readValueFromInstance(t,n){if(Cb.has(n)){const r=rre(n);return r&&r.default||0}return n=lre.has(n)?n:kF(n),t.getAttribute(n)}scrapeMotionValuesFromProps(t,n,r){return Xte(t,n,r)}build(t,n,r){Gte(t,n,this.isSVGTag,r.transformTemplate,r.style)}renderInstance(t,n,r,s){O9e(t,n,r,s)}mount(t){this.isSVGTag=Yte(t.tagName),super.mount(t)}}const F9e=(e,t)=>jF(e)?new D9e(t):new P9e(t,{allowProjection:e!==E.Fragment}),L9e=GLe({...z$e,...p9e,...Xze,...m9e},F9e),Cu=hLe(L9e),Li=({field:e,className:t})=>e.state.meta.isTouched&&e.state.meta.errors.length>0?f.jsx("em",{className:`text-xs text-destructive mt-1 block ${t||""}`,children:e.state.meta.errors.map(r=>typeof r=="string"?r:typeof r=="object"&&r!==null&&"message"in r&&typeof r.message=="string"?r.message:(console.warn("[GlobalFieldMetaMessages] Encountered an unexpected error structure:",r),"Validation error")).join(", ")}):null,B9e=Lo.map(e=>e.value),SC=Ke({keyName:$e().min(1,"Key Name is required."),providerType:El(B9e,{errorMap:()=>({message:"Provider Type is required."})}),keyValue:$e().min(1,"API Key Value is required.")}),cre=({initialProviderType:e=null,initialName:t="",initialValue:n="",onSave:r,onCancel:s,disabled:i=!1,className:a})=>{const o=E.useRef(null),l=ai({defaultValues:{keyName:t,providerType:e,keyValue:n},validators:{onChangeAsync:SC,onChangeAsyncDebounceMs:500},onSubmit:async({value:u})=>{await r(u.keyName,u.providerType,u.keyValue)}});E.useEffect(()=>{l.reset({keyName:t,providerType:e,keyValue:n})},[t,n,e,l]);const c=(u,d)=>{var b,v;if(!u)return;const h=(b=Lo.find(x=>x.value===u))==null?void 0:b.label,m=l.getFieldValue("providerType"),y=(v=Lo.find(x=>x.value===m))==null?void 0:v.label;h&&(!(d!=null&&d.trim())||d===y)&&l.setFieldValue("keyName",h),requestAnimationFrame(()=>{var x;(x=o.current)==null||x.focus()})};return f.jsxs("form",{onSubmit:u=>{u.preventDefault(),u.stopPropagation(),l.handleSubmit()},className:Ye("space-y-6",a),children:[f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[f.jsx(l.Field,{name:"providerType",validators:{onChange:SC.shape.providerType},children:u=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(Nt,{htmlFor:u.name,children:"Provider Type"}),f.jsxs(sc,{value:u.state.value??"",onValueChange:d=>{const h=d;u.handleChange(h),u.handleBlur(),c(h,l.getFieldValue("keyName"))},disabled:i||l.state.isSubmitting,children:[f.jsx(ac,{id:u.name,children:f.jsx(ic,{placeholder:"Select Provider Type"})}),f.jsx(oc,{children:Lo.map(d=>f.jsx(wi,{value:d.value,children:d.label},d.value))})]}),f.jsx(Li,{field:u})]})}),f.jsx(l.Field,{name:"keyName",validators:{onChange:SC.shape.keyName},children:u=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(Nt,{htmlFor:u.name,children:"Key Name"}),f.jsx(vn,{id:u.name,value:u.state.value??"",onChange:d=>u.handleChange(d.target.value),onBlur:u.handleBlur,placeholder:"e.g., My OpenAI Key",disabled:i||l.state.isSubmitting}),f.jsx(Li,{field:u})]})}),f.jsx(l.Field,{name:"keyValue",validators:{onChange:SC.shape.keyValue},children:u=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(Nt,{htmlFor:u.name,children:"API Key Value"}),f.jsx(vn,{ref:o,id:u.name,type:"password",value:u.state.value??"",onChange:d=>u.handleChange(d.target.value),onBlur:u.handleBlur,placeholder:"Enter your API key",disabled:i||l.state.isSubmitting,autoComplete:"new-password"}),f.jsx(Li,{field:u})]})})]}),f.jsxs("div",{className:"flex justify-end space-x-2 pt-2",children:[f.jsxs(ot,{variant:"ghost",size:"sm",onClick:s,disabled:i||l.state.isSubmitting,type:"button",children:[f.jsx(Si,{className:"h-4 w-4 mr-1"})," Cancel"]}),f.jsx(l.Subscribe,{selector:u=>[u.canSubmit,u.isSubmitting,u.isValidating,u.isValid],children:([u,d,h,m])=>f.jsxs(ot,{type:"submit",size:"sm",disabled:i||!u||d||h||!m,children:[(d||h)&&f.jsx(Hn,{className:"h-4 w-4 mr-1 animate-spin"}),f.jsx(Yu,{className:"h-4 w-4 mr-1"}),d||h?"Saving...":"Save API Key"]})})]})]})},$9e=({className:e,label:t,selectedKeyId:n,onKeySelected:r,apiKeys:s,disabled:i=!1})=>{var c;const a=u=>{r(u==="none"?null:u)},o=(c=s.find(u=>u.id===n))==null?void 0:c.name,l=n?o||`Key ID: ${n.substring(0,6)}...`:"None";return f.jsxs(sc,{value:n??"none",onValueChange:a,disabled:i||s.length===0,children:[f.jsx(ac,{className:Ye("w-full h-9 text-sm bg-background border-border text-foreground",e),"aria-label":t||"Select API Key",children:f.jsx(ic,{asChild:!0,children:f.jsxs("div",{className:"flex items-center overflow-hidden",children:[f.jsx(nw,{className:"h-3 w-3 mr-1.5 text-muted-foreground flex-shrink-0"}),f.jsxs("span",{className:"truncate flex-grow text-left",children:[t&&f.jsxs("span",{className:"mr-1",children:[t,":"]}),s.length===0?f.jsx("span",{className:"text-muted-foreground",children:"No keys available"}):l]})]})})}),f.jsxs(oc,{className:"bg-popover border-border text-popover-foreground",children:[f.jsx(wi,{value:"none",children:f.jsx("span",{className:"text-muted-foreground",children:"None"})}),s.map(u=>f.jsx(wi,{value:u.id,children:u.name||`Key ID: ${u.id.substring(0,6)}...`},u.id))]})]})};function r1({form:e,name:t,label:n,type:r="text",placeholder:s,disabled:i,wrapperClassName:a,className:o,...l}){return f.jsx(e.Field,{name:t,children:c=>{const u=typeof c.state.value=="string"||typeof c.state.value=="number"?String(c.state.value):"";return f.jsxs("div",{className:Ye("space-y-1.5",a),children:[f.jsx(Nt,{htmlFor:c.name,className:"text-sm",children:n}),f.jsx(vn,{id:c.name,name:c.name,type:r,value:u,onBlur:c.handleBlur,onChange:d=>c.handleChange(d.target.value),placeholder:s,disabled:i??c.form.state.isSubmitting,className:Ye(o,c.state.meta.errors.length?"border-destructive":""),...l}),f.jsx(Li,{field:c})]})}})}function Wx({form:e,name:t,label:n,options:r,placeholder:s,disabled:i,wrapperClassName:a,triggerClassName:o,contentClassName:l,...c}){return f.jsx(e.Field,{name:t,children:u=>{const d=u.state.value!==null&&u.state.value!==void 0?String(u.state.value):"";return f.jsxs("div",{className:Ye("space-y-1.5",a),children:[f.jsx(Nt,{htmlFor:u.name,className:"text-sm",children:n}),f.jsxs(sc,{value:d,onValueChange:h=>u.handleChange(h),disabled:i??u.form.state.isSubmitting,...c,children:[f.jsx(ac,{id:u.name,onBlur:u.handleBlur,className:Ye(o,u.state.meta.errors.length?"border-destructive":""),children:f.jsx(ic,{placeholder:s})}),f.jsx(oc,{className:l,children:r.map(h=>f.jsx(wi,{value:String(h.value),disabled:h.disabled,children:h.label},h.value))})]}),f.jsx(Li,{field:u})]})}})}function lm({form:e,name:t,label:n,description:r,disabled:s,wrapperClassName:i,className:a,labelClassName:o,...l}){return f.jsx(e.Field,{name:t,children:c=>{const u=typeof c.state.value=="boolean"?c.state.value:!1;return f.jsxs("div",{className:Ye("space-y-1.5",i),children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx(Nt,{htmlFor:c.name,className:Ye("text-sm font-medium leading-none cursor-pointer",o),children:n}),f.jsx(fo,{id:c.name,name:c.name,checked:u,onCheckedChange:d=>c.handleChange(d),onBlur:c.handleBlur,disabled:s??c.form.state.isSubmitting,className:Ye(a,c.state.meta.errors.length?"border-destructive":""),...l})]}),r&&f.jsx("p",{className:"text-xs text-muted-foreground pt-1",children:r}),f.jsx(Li,{field:c})]})}})}const z9e=Lo.map(e=>e.value),U9e=Ke({name:$e().min(1,"Provider Name is required."),type:El(z9e,{errorMap:()=>({message:"Provider Type is required."})}),isEnabled:Qn(),apiKeyId:$e().nullable(),baseURL:$e().url().nullable().or(Mn("")),autoFetchModels:Qn()}).refine(e=>K2(e.type)?!(!e.baseURL||e.baseURL.trim()===""):!0,{message:"Base URL is required and must be a valid URL for this provider type.",path:["baseURL"]}).refine(e=>my(e.type)?!!e.apiKeyId:!0,{message:"API Key is required for this provider type.",path:["apiKeyId"]}),q9e=Lo.map(e=>({value:e.value,label:e.label})),ure=({initialData:e,onSubmit:t,onChange:n,onCancel:r,apiKeys:s,isSavingExt:i=!1,disabled:a=!1,className:o})=>{var v;const l=ai({defaultValues:{name:(e==null?void 0:e.name)||"",type:(e==null?void 0:e.type)||((v=Lo[0])==null?void 0:v.value),isEnabled:(e==null?void 0:e.isEnabled)??!0,apiKeyId:(e==null?void 0:e.apiKeyId)||null,baseURL:(e==null?void 0:e.baseURL)||null,autoFetchModels:(e==null?void 0:e.autoFetchModels)??!1},validators:{onChangeAsync:U9e,onChangeAsyncDebounceMs:500},onSubmit:async({value:x})=>{const w={...x,baseURL:(x.baseURL===null||typeof x.baseURL=="string"&&x.baseURL.trim()==="")&&!K2(x.type)?null:x.baseURL};await t(w)}}),c=E.useRef(l.state.values);E.useEffect(()=>{const x=l.store.subscribe(()=>{const w=l.state.values,_=c.current;if(n&&_)for(const k in w){const C=k;w[C]!==_[C]&&n(C,w[C])}c.current={...w}});return l.state.values!==c.current&&(c.current=l.state.values),x},[l,n]),E.useEffect(()=>{var _,k;const x=(e==null?void 0:e.type)||((_=Lo[0])==null?void 0:_.value),w={name:(e==null?void 0:e.name)||((k=Lo.find(C=>C.value===x))==null?void 0:k.label)||"",type:x,isEnabled:(e==null?void 0:e.isEnabled)??!0,apiKeyId:(e==null?void 0:e.apiKeyId)||null,baseURL:(e==null?void 0:e.baseURL)||null,autoFetchModels:(e==null?void 0:e.autoFetchModels)??wm(x)};l.reset(w),c.current=w},[e]);const u=l.state.values.type,d=my(u??null),h=K2(u??null),m=wm(u??null),y=E.useCallback(x=>{var _,k;if(!x)return;const w=l.state.values.type;if(x!==w){l.setFieldValue("apiKeyId",null),l.setFieldValue("baseURL",null),l.setFieldValue("autoFetchModels",wm(x));const C=(_=Lo.find(N=>N.value===x))==null?void 0:_.label,T=(k=Lo.find(N=>N.value===w))==null?void 0:k.label,A=l.state.values.name;C&&(!(A!=null&&A.trim())||A===T)&&l.setFieldValue("name",C)}},[l]);E.useEffect(()=>{const x=l.state.values.type;x!==void 0&&y(x)},[l.state.values.type,y]);const b=(s||[]).filter(x=>!u||x.providerId===u);return f.jsxs("form",{onSubmit:x=>{x.preventDefault(),x.stopPropagation(),l.handleSubmit()},className:Ye("space-y-4 border rounded-md p-4 bg-card shadow-sm",o),children:[f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-4 gap-y-3",children:[f.jsx(Wx,{form:l,name:"type",label:"Provider Type",options:q9e,disabled:a||i,placeholder:"Select Type",wrapperClassName:"md:col-span-1"}),f.jsx(r1,{form:l,name:"name",label:"Provider Name",placeholder:"e.g., My Ollama",disabled:a||i,"aria-label":"Provider Name",wrapperClassName:"md:col-span-1"}),d&&f.jsx(l.Field,{name:"apiKeyId",children:x=>f.jsxs("div",{className:"space-y-1.5 md:col-span-2",children:[f.jsx(Nt,{htmlFor:`${x.name}-trigger`,children:"API Key"})," ",f.jsx($9e,{selectedKeyId:x.state.value??null,onKeySelected:w=>{x.handleChange(w),x.handleBlur()},apiKeys:b,disabled:a||i||!u}),f.jsx(Li,{field:x})]})}),h&&f.jsx(r1,{form:l,name:"baseURL",label:"Base URL",placeholder:"e.g., http://localhost:11434",type:"url",disabled:a||i||!u,wrapperClassName:"md:col-span-2"}),m&&f.jsx(lm,{form:l,name:"autoFetchModels",label:"Auto-Fetch Models",description:"Automatically fetch and update the list of available models from this provider.",disabled:a||i||!u,wrapperClassName:"md:col-span-2"}),f.jsx(lm,{form:l,name:"isEnabled",label:"Enable Provider",description:"Allow this provider to be used for generating responses.",disabled:a||i,wrapperClassName:"md:col-span-2"})]}),f.jsxs("div",{className:"flex justify-end space-x-2 pt-2",children:[f.jsxs(ot,{variant:"ghost",size:"sm",onClick:r,disabled:a||i,type:"button",children:[f.jsx(Si,{className:"h-4 w-4 mr-1"})," Cancel"]}),f.jsx(l.Subscribe,{selector:x=>[x.canSubmit,x.isSubmitting,x.isValidating,x.isValid],children:([x,w,_,k])=>f.jsxs(ot,{type:"submit",size:"sm",disabled:a||i||!x||w||!k||_,children:[(i||w||_)&&f.jsx(Hn,{className:"h-4 w-4 mr-1 animate-spin"}),f.jsx(Yu,{className:"h-4 w-4 mr-1"})," ",i||w||_?"Saving...":e!=null&&e.name?"Save Changes":"Add Provider"]})})]})]})},dre=({apiKeys:e,onAddProvider:t,onCancel:n,initialType:r="openai",initialName:s="",initialApiKeyId:i=null})=>{const[a,o]=E.useState(!1),[l,c]=E.useState({name:s,type:r,isEnabled:!0,apiKeyId:i,baseURL:null,autoFetchModels:wm(r)});E.useEffect(()=>{c(h=>({...h,name:s||h.name||"",type:r||h.type||null,apiKeyId:i||h.apiKeyId||null,autoFetchModels:!1}))},[s,r,i]);const u=E.useCallback((h,m)=>new Promise(y=>{c(b=>{var w,_;const v={...b,[h]:m},x=b.name||"";if(h==="type"){const k=m,C=(w=Lo.find(A=>A.value===b.type))==null?void 0:w.label;v.apiKeyId=null,v.baseURL=null,v.autoFetchModels=k?wm(k):!1;const T=(_=Lo.find(A=>A.value===k))==null?void 0:_.label;if(T&&(!x.trim()||x===C)&&(v.name=T),k&&my(k)){const A=(e||[]).filter(N=>N.providerId===k);A.length>0&&(v.apiKeyId=A[0].id)}}return v}),y(void 0)}),[e]),d=E.useCallback(async()=>{var h,m;if(!((h=l.name)!=null&&h.trim())||!l.type){ke.error("Provider Name and Type are required.");return}o(!0);try{const y=l.type,b=l.autoFetchModels??wm(y),v={name:l.name.trim(),type:y,isEnabled:l.isEnabled??!0,apiKeyId:l.apiKeyId??null,baseURL:((m=l.baseURL)==null?void 0:m.trim())||null,enabledModels:null,autoFetchModels:b,fetchedModels:null,modelsLastFetchedAt:null};await t(v),n()}catch(y){console.error("Failed to add provider (from form component):",y)}finally{o(!1)}},[l,t,n]);return f.jsxs("div",{className:"border border-primary rounded-md p-4 space-y-3 bg-card shadow-lg flex-shrink-0",children:[f.jsx("h4",{className:"font-semibold text-card-foreground",children:"Add New Provider"}),f.jsx(ure,{initialData:l,onSubmit:d,onCancel:n,onChange:u,apiKeys:e,disabled:a})]})},zd=Ve.forwardRef(({className:e,href:t,children:n,...r},s)=>f.jsx("a",{ref:s,href:t,target:"_blank",rel:"noopener noreferrer",className:Ye("font-medium text-primary underline-offset-4 hover:underline focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...r,children:n}));zd.displayName="Lnk";const V9e=e=>{const{size:t=24,color:n="currentColor",...r}=e;return f.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:t,height:t,viewBox:"0 0 512 512",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",...r,children:[f.jsx("g",{transform:"translate(0.000000,512.000000) scale(0.100000,-0.100000)",fill:n,stroke:"none",children:f.jsx("path",{d:`M2310 5053 c-1035 -101 -1883 -794 -2159 -1764 -55 -194 -79 -338
-91 -552 -18 -323 20 -620 117 -907 92 -272 238 -543 404 -747 33 -39 59 -75
59 -78 0 -4 -49 -129 -109 -279 -252 -624 -251 -621 -196 -676 57 -56 73 -53
351 58 137 55 349 143 472 195 l223 95 77 -38 c221 -109 437 -179 680 -219
132 -23 411 -44 475 -37 23 3 85 8 137 11 404 26 806 168 1180 417 282 188
571 489 759 792 400 642 467 1498 174 2216 -179 439 -495 826 -888 1088 -361
239 -743 378 -1165 422 -88 9 -419 11 -500 3z m404 -463 c-1 -30 -17 -128 -36
-217 l-34 -163 137 0 c128 0 139 -1 149 -20 11 -21 4 -44 -22 -72 -7 -7 -68
-75 -135 -150 l-123 -136 0 -175 0 -175 238 -4 c265 -5 329 -16 469 -82 220
-105 414 -311 486 -519 l24 -68 86 -4 c129 -7 195 -43 236 -130 20 -42 21 -61
21 -300 0 -240 -1 -258 -21 -297 -46 -90 -115 -127 -235 -128 l-82 0 -11 -47
c-17 -66 -71 -179 -119 -250 -108 -159 -276 -293 -452 -361 -174 -66 -251 -72
-830 -63 l-475 8 -89 27 c-303 91 -554 328 -650 614 l-23 67 -89 5 c-98 6
-131 20 -180 72 -63 66 -64 72 -64 354 0 240 1 261 21 301 40 84 105 119 232
129 l84 7 32 80 c84 215 291 424 513 519 126 53 225 68 466 68 l212 0 0 268 0
267 -126 -3 c-108 -3 -129 -1 -145 14 -10 9 -19 25 -19 35 0 9 111 146 246
304 234 273 247 286 277 283 32 -3 32 -3 31 -58z`})}),f.jsxs("g",{transform:"translate(165, 220) scale(2.5)",children:[f.jsx("path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",fill:"none",stroke:n,strokeWidth:"4"}),f.jsx("circle",{cx:"12",cy:"12",r:"3",fill:"none",stroke:n,strokeWidth:"4"})]}),f.jsxs("g",{transform:"translate(290, 220) scale(2.5)",children:[f.jsx("path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",fill:"none",stroke:n,strokeWidth:"4"}),f.jsx("circle",{cx:"12",cy:"12",r:"3",fill:"none",stroke:n,strokeWidth:"4"})]}),f.jsx("g",{transform:"translate(0.000000,512.000000) scale(0.100000,-0.100000)",fill:n,stroke:"none",children:f.jsx("path",{d:`M2147 1999 c-26 -15 -48 -65 -41 -94 15 -61 181 -167 304 -196 30 -7
100 -12 155 -12 81 1 115 6 178 27 135 45 247 133 249 194 2 60 -48 103 -104
88 -13 -3 -50 -25 -83 -50 -85 -64 -172 -90 -280 -84 -92 6 -165 35 -259 103
-49 35 -86 43 -119 24z`})})]})},W9e=Y4("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function as({className:e,variant:t,asChild:n=!1,...r}){const s=n?wH:"span";return f.jsx(s,{"data-slot":"badge",className:Ye(W9e({variant:t}),e),...r})}const H9e=()=>{const[e,t]=E.useState(!1);E.useEffect(()=>{t(!0)},[]);const n={hidden:{opacity:0},show:{opacity:1,transition:{staggerChildren:.2,delayChildren:.3}}},r={hidden:{opacity:0,y:20},show:{opacity:1,y:0,transition:{duration:.5}}},s=[{word:"LiteChat",color:"bg-gradient-to-tr from-lime-500 via-amber-400 to-red-600 bg-clip-text text-transparent"},{word:"library",color:"text-emerald-500"},{word:"browser",color:"text-violet-500"},{word:"local",color:"text-amber-500"},{word:"remote",color:"text-sky-500"},{word:"providers",color:"text-purple-500"},{word:" AI ",color:"bg-gradient-to-b from-amber-300 to-rose-700 bg-clip-text text-transparent"},{word:"Open Source",color:"bg-gradient-to-r from-lime-500 to-yellow-500 bg-clip-text text-transparent"}],i=o=>{let l=[o];return s.forEach(({word:c,color:u})=>{l=l.reduce((d,h)=>typeof h!="string"?(d.push(h),d):(h.split(new RegExp(`(${c})`,"gi")).forEach((y,b)=>{y.toLowerCase()===c.toLowerCase()?d.push(f.jsx("span",{className:`${u} font-medium`,children:y},`${y}-${b}`)):d.push(y)}),d),[])}),l=l.reduce((c,u,d)=>{if(typeof u!="string")return c.push(u),c;const h=/(\([^)]*\))/g;return u.split(h).forEach((y,b)=>{h.test(y)?c.push(f.jsx("span",{className:"text-sm text-muted",children:y},`paren-${d}-${b}`)):c.push(y)}),c},[]),l},a=["Oh, hey?! Hi there!! How are you doing!?","Nice of you to pop by to checkout LiteChat!","What'd you mean you don't know what LiteChat is? Oh Boy hey, you in for a treat!","To start with, it's an(other) AI chat app (yes...shocker, right ?) and it's Open Source ! ","But, it is also an extensible library, so you can go on and create your own, AI chat app! With your own functionnalities !","(are AI chat apps the new JS frameworks?)","And cause I might be a wee bit on the reluctant side when it comes to parting with my coins, it doesn't require no servers! It all stays in your browser.","(that means I couldn't snoop on what you do here, even if I wanted to!)","While able to run LLM both local (did I tell you I ain't liking throwing coins out?) and from remote providers","(but sometimes you have to :(..)","To cap things off, there is no fancy/crazy tech involved, I just glued bricks together with AI","(kids call it vibing apparently ^^)","Enough of this interminable babble! Go setup your future chat to prompt your brains out!"];return f.jsxs(Cu.div,{className:"text-center max-w-4xl mx-auto space-y-3 my-6",initial:"hidden",animate:e?"show":"hidden",variants:n,children:[f.jsx("div",{className:"flex justify-center mb-4",children:f.jsxs(as,{variant:"outline",className:"px-3 py-1 bg-black/5 dark:bg-white/10 backdrop-blur-sm border-none",children:[f.jsx(HH,{className:"w-4 h-4 mr-2 text-yellow-500"}),f.jsx("span",{className:"text-sm",children:"Welcome to your future AI chat"})]})}),a.map((o,l)=>f.jsx(Cu.p,{className:`text-sm md:text-base ${l===0?"font-medium":""} leading-relaxed`,variants:r,children:i(o)},l)),f.jsxs(Cu.div,{variants:r,className:"pt-2",children:[f.jsx(as,{className:"bg-gradient-to-r from-violet-600 to-primary border-none",children:"No server required!"}),f.jsx(as,{className:"ml-2 bg-gradient-to-r from-amber-500 to-emerald-500 border-none",children:"100% in-browser"})]})]})};function y0(e,t,n){let r=n.initialDeps??[],s;function i(){var a,o,l,c;let u;n.key&&((a=n.debug)!=null&&a.call(n))&&(u=Date.now());const d=e();if(!(d.length!==r.length||d.some((y,b)=>r[b]!==y)))return s;r=d;let m;if(n.key&&((o=n.debug)!=null&&o.call(n))&&(m=Date.now()),s=t(...d),n.key&&((l=n.debug)!=null&&l.call(n))){const y=Math.round((Date.now()-u)*100)/100,b=Math.round((Date.now()-m)*100)/100,v=b/16,x=(w,_)=>{for(w=String(w);w.length<_;)w=" "+w;return w};console.info(`%c⏱ ${x(b,5)} /${x(y,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*v,120))}deg 100% 31%);`,n==null?void 0:n.key)}return(c=n==null?void 0:n.onChange)==null||c.call(n,s),s}return i.updateDeps=a=>{r=a},i}function yj(e,t){if(e===void 0)throw new Error("Unexpected undefined");return e}const G9e=(e,t)=>Math.abs(e-t)<=1,K9e=(e,t,n)=>{let r;return function(...s){e.clearTimeout(r),r=e.setTimeout(()=>t.apply(this,s),n)}},Oq=e=>{const{offsetWidth:t,offsetHeight:n}=e;return{width:t,height:n}},Y9e=e=>e,Z9e=e=>{const t=Math.max(e.startIndex-e.overscan,0),n=Math.min(e.endIndex+e.overscan,e.count-1),r=[];for(let s=t;s<=n;s++)r.push(s);return r},X9e=(e,t)=>{const n=e.scrollElement;if(!n)return;const r=e.targetWindow;if(!r)return;const s=a=>{const{width:o,height:l}=a;t({width:Math.round(o),height:Math.round(l)})};if(s(Oq(n)),!r.ResizeObserver)return()=>{};const i=new r.ResizeObserver(a=>{const o=()=>{const l=a[0];if(l!=null&&l.borderBoxSize){const c=l.borderBoxSize[0];if(c){s({width:c.inlineSize,height:c.blockSize});return}}s(Oq(n))};e.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(o):o()});return i.observe(n,{box:"border-box"}),()=>{i.unobserve(n)}},Dq={passive:!0},Fq=typeof window>"u"?!0:"onscrollend"in window,J9e=(e,t)=>{const n=e.scrollElement;if(!n)return;const r=e.targetWindow;if(!r)return;let s=0;const i=e.options.useScrollendEvent&&Fq?()=>{}:K9e(r,()=>{t(s,!1)},e.options.isScrollingResetDelay),a=u=>()=>{const{horizontal:d,isRtl:h}=e.options;s=d?n.scrollLeft*(h&&-1||1):n.scrollTop,i(),t(s,u)},o=a(!0),l=a(!1);l(),n.addEventListener("scroll",o,Dq);const c=e.options.useScrollendEvent&&Fq;return c&&n.addEventListener("scrollend",l,Dq),()=>{n.removeEventListener("scroll",o),c&&n.removeEventListener("scrollend",l)}},Q9e=(e,t,n)=>{if(t!=null&&t.borderBoxSize){const r=t.borderBoxSize[0];if(r)return Math.round(r[n.options.horizontal?"inlineSize":"blockSize"])}return e[n.options.horizontal?"offsetWidth":"offsetHeight"]},e7e=(e,{adjustments:t=0,behavior:n},r)=>{var s,i;const a=e+t;(i=(s=r.scrollElement)==null?void 0:s.scrollTo)==null||i.call(s,{[r.options.horizontal?"left":"top"]:a,behavior:n})};class t7e{constructor(t){this.unsubs=[],this.scrollElement=null,this.targetWindow=null,this.isScrolling=!1,this.scrollToIndexTimeoutId=null,this.measurementsCache=[],this.itemSizeCache=new Map,this.pendingMeasuredCacheIndexes=[],this.scrollRect=null,this.scrollOffset=null,this.scrollDirection=null,this.scrollAdjustments=0,this.elementsCache=new Map,this.observer=(()=>{let n=null;const r=()=>n||(!this.targetWindow||!this.targetWindow.ResizeObserver?null:n=new this.targetWindow.ResizeObserver(s=>{s.forEach(i=>{const a=()=>{this._measureElement(i.target,i)};this.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(a):a()})}));return{disconnect:()=>{var s;(s=r())==null||s.disconnect(),n=null},observe:s=>{var i;return(i=r())==null?void 0:i.observe(s,{box:"border-box"})},unobserve:s=>{var i;return(i=r())==null?void 0:i.unobserve(s)}}})(),this.range=null,this.setOptions=n=>{Object.entries(n).forEach(([r,s])=>{typeof s>"u"&&delete n[r]}),this.options={debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:Y9e,rangeExtractor:Z9e,onChange:()=>{},measureElement:Q9e,initialRect:{width:0,height:0},scrollMargin:0,gap:0,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1,isScrollingResetDelay:150,enabled:!0,isRtl:!1,useScrollendEvent:!1,useAnimationFrameWithResizeObserver:!1,...n}},this.notify=n=>{var r,s;(s=(r=this.options).onChange)==null||s.call(r,this,n)},this.maybeNotify=y0(()=>(this.calculateRange(),[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]),n=>{this.notify(n)},{key:!1,debug:()=>this.options.debug,initialDeps:[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]}),this.cleanup=()=>{this.unsubs.filter(Boolean).forEach(n=>n()),this.unsubs=[],this.observer.disconnect(),this.scrollElement=null,this.targetWindow=null},this._didMount=()=>()=>{this.cleanup()},this._willUpdate=()=>{var n;const r=this.options.enabled?this.options.getScrollElement():null;if(this.scrollElement!==r){if(this.cleanup(),!r){this.maybeNotify();return}this.scrollElement=r,this.scrollElement&&"ownerDocument"in this.scrollElement?this.targetWindow=this.scrollElement.ownerDocument.defaultView:this.targetWindow=((n=this.scrollElement)==null?void 0:n.window)??null,this.elementsCache.forEach(s=>{this.observer.observe(s)}),this._scrollToOffset(this.getScrollOffset(),{adjustments:void 0,behavior:void 0}),this.unsubs.push(this.options.observeElementRect(this,s=>{this.scrollRect=s,this.maybeNotify()})),this.unsubs.push(this.options.observeElementOffset(this,(s,i)=>{this.scrollAdjustments=0,this.scrollDirection=i?this.getScrollOffset()<s?"forward":"backward":null,this.scrollOffset=s,this.isScrolling=i,this.maybeNotify()}))}},this.getSize=()=>this.options.enabled?(this.scrollRect=this.scrollRect??this.options.initialRect,this.scrollRect[this.options.horizontal?"width":"height"]):(this.scrollRect=null,0),this.getScrollOffset=()=>this.options.enabled?(this.scrollOffset=this.scrollOffset??(typeof this.options.initialOffset=="function"?this.options.initialOffset():this.options.initialOffset),this.scrollOffset):(this.scrollOffset=null,0),this.getFurthestMeasurement=(n,r)=>{const s=new Map,i=new Map;for(let a=r-1;a>=0;a--){const o=n[a];if(s.has(o.lane))continue;const l=i.get(o.lane);if(l==null||o.end>l.end?i.set(o.lane,o):o.end<l.end&&s.set(o.lane,!0),s.size===this.options.lanes)break}return i.size===this.options.lanes?Array.from(i.values()).sort((a,o)=>a.end===o.end?a.index-o.index:a.end-o.end)[0]:void 0},this.getMeasurementOptions=y0(()=>[this.options.count,this.options.paddingStart,this.options.scrollMargin,this.options.getItemKey,this.options.enabled],(n,r,s,i,a)=>(this.pendingMeasuredCacheIndexes=[],{count:n,paddingStart:r,scrollMargin:s,getItemKey:i,enabled:a}),{key:!1}),this.getMeasurements=y0(()=>[this.getMeasurementOptions(),this.itemSizeCache],({count:n,paddingStart:r,scrollMargin:s,getItemKey:i,enabled:a},o)=>{if(!a)return this.measurementsCache=[],this.itemSizeCache.clear(),[];this.measurementsCache.length===0&&(this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach(u=>{this.itemSizeCache.set(u.key,u.size)}));const l=this.pendingMeasuredCacheIndexes.length>0?Math.min(...this.pendingMeasuredCacheIndexes):0;this.pendingMeasuredCacheIndexes=[];const c=this.measurementsCache.slice(0,l);for(let u=l;u<n;u++){const d=i(u),h=this.options.lanes===1?c[u-1]:this.getFurthestMeasurement(c,u),m=h?h.end+this.options.gap:r+s,y=o.get(d),b=typeof y=="number"?y:this.options.estimateSize(u),v=m+b,x=h?h.lane:u%this.options.lanes;c[u]={index:u,start:m,size:b,end:v,key:d,lane:x}}return this.measurementsCache=c,c},{key:!1,debug:()=>this.options.debug}),this.calculateRange=y0(()=>[this.getMeasurements(),this.getSize(),this.getScrollOffset(),this.options.lanes],(n,r,s,i)=>this.range=n.length>0&&r>0?n7e({measurements:n,outerSize:r,scrollOffset:s,lanes:i}):null,{key:!1,debug:()=>this.options.debug}),this.getVirtualIndexes=y0(()=>{let n=null,r=null;const s=this.calculateRange();return s&&(n=s.startIndex,r=s.endIndex),this.maybeNotify.updateDeps([this.isScrolling,n,r]),[this.options.rangeExtractor,this.options.overscan,this.options.count,n,r]},(n,r,s,i,a)=>i===null||a===null?[]:n({startIndex:i,endIndex:a,overscan:r,count:s}),{key:!1,debug:()=>this.options.debug}),this.indexFromElement=n=>{const r=this.options.indexAttribute,s=n.getAttribute(r);return s?parseInt(s,10):(console.warn(`Missing attribute name '${r}={index}' on measured element.`),-1)},this._measureElement=(n,r)=>{const s=this.indexFromElement(n),i=this.measurementsCache[s];if(!i)return;const a=i.key,o=this.elementsCache.get(a);o!==n&&(o&&this.observer.unobserve(o),this.observer.observe(n),this.elementsCache.set(a,n)),n.isConnected&&this.resizeItem(s,this.options.measureElement(n,r,this))},this.resizeItem=(n,r)=>{const s=this.measurementsCache[n];if(!s)return;const i=this.itemSizeCache.get(s.key)??s.size,a=r-i;a!==0&&((this.shouldAdjustScrollPositionOnItemSizeChange!==void 0?this.shouldAdjustScrollPositionOnItemSizeChange(s,a,this):s.start<this.getScrollOffset()+this.scrollAdjustments)&&this._scrollToOffset(this.getScrollOffset(),{adjustments:this.scrollAdjustments+=a,behavior:void 0}),this.pendingMeasuredCacheIndexes.push(s.index),this.itemSizeCache=new Map(this.itemSizeCache.set(s.key,r)),this.notify(!1))},this.measureElement=n=>{if(!n){this.elementsCache.forEach((r,s)=>{r.isConnected||(this.observer.unobserve(r),this.elementsCache.delete(s))});return}this._measureElement(n,void 0)},this.getVirtualItems=y0(()=>[this.getVirtualIndexes(),this.getMeasurements()],(n,r)=>{const s=[];for(let i=0,a=n.length;i<a;i++){const o=n[i],l=r[o];s.push(l)}return s},{key:!1,debug:()=>this.options.debug}),this.getVirtualItemForOffset=n=>{const r=this.getMeasurements();if(r.length!==0)return yj(r[fre(0,r.length-1,s=>yj(r[s]).start,n)])},this.getOffsetForAlignment=(n,r,s=0)=>{const i=this.getSize(),a=this.getScrollOffset();r==="auto"&&(r=n>=a+i?"end":"start"),r==="center"?n+=(s-i)/2:r==="end"&&(n-=i);const o=this.getTotalSize()-i;return Math.max(Math.min(o,n),0)},this.getOffsetForIndex=(n,r="auto")=>{n=Math.max(0,Math.min(n,this.options.count-1));const s=this.measurementsCache[n];if(!s)return;const i=this.getSize(),a=this.getScrollOffset();if(r==="auto")if(s.end>=a+i-this.options.scrollPaddingEnd)r="end";else if(s.start<=a+this.options.scrollPaddingStart)r="start";else return[a,r];const o=r==="end"?s.end+this.options.scrollPaddingEnd:s.start-this.options.scrollPaddingStart;return[this.getOffsetForAlignment(o,r,s.size),r]},this.isDynamicMode=()=>this.elementsCache.size>0,this.cancelScrollToIndex=()=>{this.scrollToIndexTimeoutId!==null&&this.targetWindow&&(this.targetWindow.clearTimeout(this.scrollToIndexTimeoutId),this.scrollToIndexTimeoutId=null)},this.scrollToOffset=(n,{align:r="start",behavior:s}={})=>{this.cancelScrollToIndex(),s==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getOffsetForAlignment(n,r),{adjustments:void 0,behavior:s})},this.scrollToIndex=(n,{align:r="auto",behavior:s}={})=>{n=Math.max(0,Math.min(n,this.options.count-1)),this.cancelScrollToIndex(),s==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size.");const i=this.getOffsetForIndex(n,r);if(!i)return;const[a,o]=i;this._scrollToOffset(a,{adjustments:void 0,behavior:s}),s!=="smooth"&&this.isDynamicMode()&&this.targetWindow&&(this.scrollToIndexTimeoutId=this.targetWindow.setTimeout(()=>{if(this.scrollToIndexTimeoutId=null,this.elementsCache.has(this.options.getItemKey(n))){const[c]=yj(this.getOffsetForIndex(n,o)),u=this.getScrollOffset();G9e(c,u)||this.scrollToIndex(n,{align:o,behavior:s})}else this.scrollToIndex(n,{align:o,behavior:s})}))},this.scrollBy=(n,{behavior:r}={})=>{this.cancelScrollToIndex(),r==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getScrollOffset()+n,{adjustments:void 0,behavior:r})},this.getTotalSize=()=>{var n;const r=this.getMeasurements();let s;if(r.length===0)s=this.options.paddingStart;else if(this.options.lanes===1)s=((n=r[r.length-1])==null?void 0:n.end)??0;else{const i=Array(this.options.lanes).fill(null);let a=r.length-1;for(;a>=0&&i.some(o=>o===null);){const o=r[a];i[o.lane]===null&&(i[o.lane]=o.end),a--}s=Math.max(...i.filter(o=>o!==null))}return Math.max(s-this.options.scrollMargin+this.options.paddingEnd,0)},this._scrollToOffset=(n,{adjustments:r,behavior:s})=>{this.options.scrollToFn(n,{behavior:s,adjustments:r},this)},this.measure=()=>{this.itemSizeCache=new Map,this.notify(!1)},this.setOptions(t)}}const fre=(e,t,n,r)=>{for(;e<=t;){const s=(e+t)/2|0,i=n(s);if(i<r)e=s+1;else if(i>r)t=s-1;else return s}return e>0?e-1:0};function n7e({measurements:e,outerSize:t,scrollOffset:n,lanes:r}){const s=e.length-1,i=l=>e[l].start;if(e.length<=r)return{startIndex:0,endIndex:s};let a=fre(0,s,i,n),o=a;if(r===1)for(;o<s&&e[o].end<n+t;)o++;else if(r>1){const l=Array(r).fill(0);for(;o<s&&l.some(u=>u<n+t);){const u=e[o];l[u.lane]=u.end,o++}const c=Array(r).fill(n+t);for(;a>=0&&c.some(u=>u>=n);){const u=e[a];c[u.lane]=u.start,a--}a=Math.max(0,a-a%r),o=Math.min(s,o+(r-1-o%r))}return{startIndex:a,endIndex:o}}const Lq=typeof document<"u"?E.useLayoutEffect:E.useEffect;function r7e(e){const t=E.useReducer(()=>({}),{})[1],n={...e,onChange:(s,i)=>{var a;i?yl.flushSync(t):t(),(a=e.onChange)==null||a.call(e,s,i)}},[r]=E.useState(()=>new t7e(n));return r.setOptions(n),Lq(()=>r._didMount(),[]),Lq(()=>r._willUpdate()),r}function JF(e){return r7e({observeElementRect:X9e,observeElementOffset:J9e,scrollToFn:e7e,...e})}const QF=({currentCapabilityFilters:e,onCapabilityFilterChange:t,currentSelectedProviders:n,onProviderFilterChange:r,currentEnabledFilter:s,onEnabledFilterChange:i,currentMinInputPrice:a,currentMaxInputPrice:o,currentMinOutputPrice:l,currentMaxOutputPrice:c,onPriceFilterChange:u,allProviders:d,showCapabilityFilters:h=!0,showProviderFilter:m=!1,showStatusFilter:y=!1,showPriceFilters:b=!1,disabled:v=!1,totalActiveFilters:x})=>{const[w,_]=E.useState(!1),k=E.useCallback(A=>{t({...e,[A]:!e[A]})},[e,t]),C=E.useCallback((A,N)=>{if(!n||!r)return;const I=new Set(n);N?I.add(A):I.delete(A),r(I)},[n,r]),T=E.useCallback((A,N)=>{if(!u)return;u(A==="minInput"?N:a??"",A==="maxInput"?N:o??"",A==="minOutput"?N:l??"",A==="maxOutput"?N:c??"")},[u,a,o,l,c]);return f.jsxs(gc,{open:w,onOpenChange:_,children:[f.jsx(yc,{asChild:!0,children:f.jsxs(ot,{variant:"outline",size:"sm",className:"h-9 px-3 relative",disabled:v,children:[f.jsx(ege,{className:"h-4 w-4 mr-1"}),"Filters",x>0&&f.jsx("span",{className:"absolute -top-1 -right-1 inline-flex items-center justify-center px-1.5 py-0.5 text-xs font-semibold leading-none text-white bg-primary rounded-full",children:x})]})}),f.jsxs(bc,{className:"p-4 space-y-4 w-72 bg-popover shadow-lg relative",style:{zIndex:9999,pointerEvents:"auto"},onMouseDown:A=>A.preventDefault(),onClick:A=>A.stopPropagation(),onPointerDown:A=>A.stopPropagation(),onPointerDownCapture:A=>A.stopPropagation(),align:"end",children:[y&&s!==void 0&&i&&f.jsxs("div",{className:"space-y-2",onClick:A=>A.stopPropagation(),children:[f.jsx(Nt,{className:"text-xs font-semibold",children:"Status"}),f.jsxs("div",{className:"flex gap-1",children:[f.jsx(ot,{variant:s==="all"?"secondary":"outline",size:"sm",onClick:A=>{A.stopPropagation(),i("all")},children:"All"}),f.jsxs(ot,{variant:s==="enabled"?"secondary":"outline",size:"sm",onClick:A=>{A.stopPropagation(),i("enabled")},children:[f.jsx(bo,{className:"h-3 w-3 mr-1"})," Enabled"]}),f.jsxs(ot,{variant:s==="disabled"?"secondary":"outline",size:"sm",onClick:A=>{A.stopPropagation(),i("disabled")},children:[f.jsx(Hpe,{className:"h-3 w-3 mr-1"})," Disabled"]})]})]}),m&&n&&d&&r&&f.jsxs("div",{onClick:A=>A.stopPropagation(),children:[f.jsx(Nt,{className:"text-xs px-2 font-semibold block mb-1",children:"Providers"}),f.jsx(Xo,{className:"h-32 border rounded-md p-1",children:d.map(A=>f.jsxs("div",{className:"flex items-center space-x-2 p-1.5 rounded hover:bg-muted",children:[f.jsx(Yc,{id:`filter-provider-${A.id}`,checked:n.has(A.id),onCheckedChange:N=>{C(A.id,!!N)}}),f.jsxs(Nt,{htmlFor:`filter-provider-${A.id}`,className:"text-sm font-normal cursor-pointer",children:[A.name," (",A.type,")"]})]},A.id))})]}),h&&f.jsxs("div",{className:"space-y-2",onClick:A=>A.stopPropagation(),children:[f.jsx(Nt,{className:"text-xs font-semibold",children:"Capabilities"}),f.jsxs("div",{className:"flex flex-wrap gap-1",children:[f.jsx(Un,{tooltipText:"Reasoning","aria-label":"Reasoning",icon:f.jsx(Qy,{}),onClick:A=>{A.stopPropagation(),k("reasoning")},variant:e.reasoning?"secondary":"outline",className:Ye(e.reasoning&&"text-primary")}),f.jsx(Un,{tooltipText:"Web Search","aria-label":"Web Search",icon:f.jsx(vo,{}),onClick:A=>{A.stopPropagation(),k("webSearch")},variant:e.webSearch?"secondary":"outline",className:Ye(e.webSearch&&"text-primary")}),f.jsx(Un,{tooltipText:"Tools","aria-label":"Tools",icon:f.jsx(Am,{}),onClick:A=>{A.stopPropagation(),k("tools")},variant:e.tools?"secondary":"outline",className:Ye(e.tools&&"text-primary")}),f.jsx(Un,{tooltipText:"Multimodal","aria-label":"Multimodal",icon:f.jsx(Mh,{}),onClick:A=>{A.stopPropagation(),k("multimodal")},variant:e.multimodal?"secondary":"outline",className:Ye(e.multimodal&&"text-primary")})]})]}),b&&a!==void 0&&u&&f.jsxs("div",{className:"space-y-2",onClick:A=>A.stopPropagation(),children:[f.jsxs(Nt,{className:"text-xs font-semibold flex items-center gap-1",children:[f.jsx(Ime,{className:"h-3 w-3"})," Price Range ($ / 1M Tokens)"]}),f.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[f.jsx(vn,{type:"number",min:"0",step:"0.01",placeholder:"Min Input",value:a,onChange:A=>{A.stopPropagation(),T("minInput",A.target.value)},className:"h-8 text-xs"}),f.jsx(vn,{type:"number",min:"0",step:"0.01",placeholder:"Max Input",value:o,onChange:A=>{A.stopPropagation(),T("maxInput",A.target.value)},className:"h-8 text-xs"}),f.jsx(vn,{type:"number",min:"0",step:"0.01",placeholder:"Min Output",value:l,onChange:A=>{A.stopPropagation(),T("minOutput",A.target.value)},className:"h-8 text-xs"}),f.jsx(vn,{type:"number",min:"0",step:"0.01",placeholder:"Max Output",value:c,onChange:A=>{A.stopPropagation(),T("maxOutput",A.target.value)},className:"h-8 text-xs"})]})]})]})]})},Bq=e=>{if(!e)return null;const t=parseFloat(e);return isNaN(t)?null:t/1e6},e6=({providerId:e,allAvailableModels:t,enabledModelIds:n,onToggleModel:r,isLoading:s=!1,disabled:i=!1,listHeightClass:a="h-[26rem]",onModelClick:o})=>{const[l,c]=E.useState(null),u=E.useCallback(K=>{if(K){const U=K.querySelector("[data-radix-scroll-area-viewport]");if(U)c(U);else{const W=new MutationObserver(()=>{const B=K.querySelector("[data-radix-scroll-area-viewport]");B&&(c(B),W.disconnect())});return W.observe(K,{childList:!0,subtree:!0}),()=>W.disconnect()}}else c(null)},[]),[d,h]=E.useState(""),[m,y]=E.useState("all"),[b,v]=E.useState({reasoning:!1,webSearch:!1,tools:!1,multimodal:!1}),[x,w]=E.useState(""),[_,k]=E.useState(""),[C,T]=E.useState(""),[A,N]=E.useState(""),I=E.useMemo(()=>{let K=[...t];if(m==="enabled"?K=K.filter(me=>n.has(me.id)):m==="disabled"&&(K=K.filter(me=>!n.has(me.id))),d.trim()){const me=d.toLowerCase();K=K.filter(De=>De.name.toLowerCase().includes(me)||De.id.toLowerCase().includes(me))}const U=Object.entries(b).filter(([,me])=>me).map(([me])=>me);U.length>0&&(K=K.filter(me=>{var Te;const De=new Set(me.supported_parameters??[]),je=new Set(((Te=me.architecture)==null?void 0:Te.input_modalities)??[]);return U.every(_e=>{switch(_e){case"reasoning":return De.has("reasoning");case"webSearch":return De.has("web_search")||De.has("web_search_options");case"tools":return De.has("tools");case"multimodal":return Array.from(je).some(Ue=>Ue!=="text");default:return!0}})}));const W=parseFloat(x),B=parseFloat(_),ne=parseFloat(C),V=parseFloat(A),Q=!isNaN(W),ee=!isNaN(B),re=!isNaN(ne),de=!isNaN(V);return(Q||ee||re||de)&&(K=K.filter(me=>{var ye,Me;const De=Bq((ye=me.pricing)==null?void 0:ye.prompt),je=Bq((Me=me.pricing)==null?void 0:Me.completion),Te=Q?W/1e6:-1/0,_e=ee?B/1e6:1/0,Ue=re?ne/1e6:-1/0,Qe=de?V/1e6:1/0,We=De!==null&&De>=Te&&De<=_e,Pe=je!==null&&je>=Ue&&je<=Qe;let Y=!0;return(Q||ee)&&Y&&(Y=We),(re||de)&&Y&&(Y=Pe),Y})),K},[t,d,m,n,b,x,_,C,A]),j=JF({count:I.length,getScrollElement:()=>l,estimateSize:()=>40,overscan:10}),L=E.useCallback(K=>{v(K)},[]),D=E.useCallback(K=>{y(K)},[]),H=E.useCallback((K,U,W,B)=>{w(K),k(U),T(W),N(B)},[]),O=E.useMemo(()=>(m!=="all"?1:0)+Object.values(b).filter(Boolean).length+(x||_||C||A?1:0),[m,b,x,_,C,A]);return s?f.jsxs("div",{className:Ye("space-y-2",a),children:[f.jsx("div",{className:"h-8 w-full bg-muted rounded animate-pulse"}),f.jsx("div",{className:"h-8 w-full bg-muted rounded animate-pulse"}),f.jsx("div",{className:"h-8 w-full bg-muted rounded animate-pulse"})]}):t.length===0?f.jsx("p",{className:"text-sm text-muted-foreground italic pt-2",children:"No models available for this provider. Try fetching models."}):f.jsxs("div",{className:"space-y-2 flex flex-col h-full",children:[f.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[f.jsxs("div",{className:"relative flex-grow",children:[f.jsx(vo,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),f.jsx(vn,{value:d,onChange:K=>h(K.target.value),placeholder:"Filter models by name...",className:"pl-8 h-9 w-full text-xs",type:"text",disabled:i})]}),f.jsx(QF,{currentCapabilityFilters:b,onCapabilityFilterChange:L,currentEnabledFilter:m,onEnabledFilterChange:D,currentMinInputPrice:x,currentMaxInputPrice:_,currentMinOutputPrice:C,currentMaxOutputPrice:A,onPriceFilterChange:H,showStatusFilter:!0,showCapabilityFilters:!0,showPriceFilters:!0,disabled:i,totalActiveFilters:O})]}),f.jsxs(Xo,{className:Ye("w-full rounded-md border border-border p-1 bg-background/50 flex-grow",a),ref:u,children:[l&&f.jsx("div",{style:{height:`${j.getTotalSize()}px`,width:"100%",position:"relative"},children:I.length===0&&!s?f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4 absolute inset-0 flex items-center justify-center",children:"No models match the current filters."}):j.getVirtualItems().map(K=>{const U=I[K.index];return U?f.jsxs("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:`${K.size}px`,transform:`translateY(${K.start}px)`},className:"flex items-center justify-between space-x-2 p-1.5 rounded hover:bg-muted/50",children:[f.jsx(fo,{id:`enable-model-${e}-${U.id}`,checked:n.has(U.id),onCheckedChange:W=>r(U.id,W),disabled:i,"aria-label":`Enable model ${U.name||U.id}`,className:"flex-shrink-0",onClick:W=>W.stopPropagation()}),f.jsx(Nt,{htmlFor:`enable-model-${e}-${U.id}`,className:"text-sm font-normal text-card-foreground flex-grow cursor-pointer truncate pl-2",title:U.name||U.id,onClick:o?()=>o(U.id):void 0,children:U.name||U.id})]},U.id):null})}),!l&&!s&&f.jsx("div",{className:"flex items-center justify-center h-full text-muted-foreground",children:"Initializing list..."})]})]})},s7e=({stepNumber:e,title:t,description:n,isComplete:r,isActive:s,openOnComplete:i=!1,contentClassName:a="",icon:o,children:l})=>{const[c,u]=E.useState(!1);return E.useEffect(()=>{u(s||r&&i)},[s,r,i]),f.jsxs(ho,{className:`border border-border/40 bg-card/50 backdrop-blur-sm shadow-lg ${r?"border-l-4 border-l-green-500/70":s?"border-l-4 border-l-primary/70":""}`,children:[f.jsx(po,{className:"pb-2",children:f.jsxs("div",{className:"flex items-center space-x-3",children:[f.jsx("div",{className:`flex h-8 w-8 shrink-0 items-center justify-center rounded-full ${r?"bg-green-500/20 text-green-500":s?"bg-primary/20 text-primary":"bg-muted text-muted-foreground"}`,children:r?f.jsx(C1,{className:"h-5 w-5"}):f.jsx("div",{className:"flex items-center justify-center",children:o})}),f.jsxs("div",{className:"flex-1",children:[f.jsxs("div",{className:"flex items-center justify-between cursor-pointer",onClick:()=>u(!c),children:[f.jsxs(mo,{className:"text-base",children:[f.jsxs("span",{className:"opacity-60 mr-2",children:[e,"."]}),t]}),f.jsx("button",{className:`p-1 rounded-full transition-all ${c?"rotate-90":""} hover:bg-muted/60`,children:f.jsx(X4,{className:"h-4 w-4"})})]}),!c&&f.jsx($c,{className:"text-xs mt-1",children:typeof n=="string"?n.substring(0,60)+(n.length>60?"...":""):"Click to expand"})]})]})}),f.jsx(aLe,{children:c&&f.jsx(Cu.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},className:"overflow-hidden",children:f.jsxs(go,{className:"pt-2",children:[typeof n=="string"?f.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:n}):f.jsx("div",{className:"text-sm text-muted-foreground mb-4",children:n}),f.jsx("div",{className:a,children:l})]})})})]})},i7e=()=>{const{apiKeys:e,addApiKey:t,providers:n,addProviderConfig:r,updateProviderConfig:s,getAllAvailableModelDefsForProvider:i,isLoading:a,enableApiKeyManagement:o}=Gn(mn(re=>({apiKeys:re.dbApiKeys,addApiKey:re.addApiKey,providers:re.dbProviderConfigs,addProviderConfig:re.addProviderConfig,updateProviderConfig:re.updateProviderConfig,getAllAvailableModelDefsForProvider:re.getAllAvailableModelDefsForProvider,isLoading:re.isLoading,enableApiKeyManagement:re.enableApiKeyManagement}))),{addConversation:l,selectItem:c}=jn(mn(re=>({addConversation:re.addConversation,selectItem:re.selectItem}))),[u,d]=E.useState(!1),[h,m]=E.useState(!1),[y,b]=E.useState(!1),[v,x]=E.useState(!1),[w,_]=E.useState(!1),k=E.useMemo(()=>!o||e.length>0,[o,e]),C=E.useMemo(()=>n.length>0,[n]),T=E.useMemo(()=>n.some(re=>re.isEnabled&&re.enabledModels&&re.enabledModels.length>0),[n]),A=E.useMemo(()=>{const re=[...n].sort((de,me)=>me.createdAt.getTime()-de.createdAt.getTime());return re.length>0?re[0]:null},[n]),N=E.useMemo(()=>A?i(A.id):[],[A,i]),I=E.useMemo(()=>new Set((A==null?void 0:A.enabledModels)??[]),[A]),{initialProviderTypeForForm:j,initialProviderNameForForm:L,initialApiKeyIdForForm:D}=E.useMemo(()=>{var re;if(C)return{type:void 0,name:void 0,keyId:void 0};if(e.length>0){const me=[...e].sort((De,je)=>je.createdAt.getTime()-De.createdAt.getTime()).find(De=>my(De.providerId));if(me){const De=me.providerId,je=((re=Lo.find(Te=>Te.value===De))==null?void 0:re.label)||De;return{initialProviderTypeForForm:De,initialProviderNameForForm:je,initialApiKeyIdForForm:me.id}}}return{initialProviderTypeForForm:void 0,initialProviderNameForForm:void 0,initialApiKeyIdForForm:void 0}},[e,C]),H=E.useCallback(async(re,de,me)=>{d(!0);try{await t(re,de,me),ke.success("API key added successfully!")}finally{d(!1)}},[t]),O=E.useCallback(async re=>{m(!0);try{const de={...re,apiKeyId:re.apiKeyId??(my(re.type)?D??null:null)},me=await r(de);return ke.success("Provider added successfully!"),me}finally{m(!1)}},[r,D]),K=E.useCallback(async(re,de)=>{if(!A)return;x(!0);const me=new Set(A.enabledModels??[]);de?me.add(re):me.delete(re);const De=Array.from(me);try{await s(A.id,{enabledModels:De}),ke.success(de?"Model enabled successfully!":"Model disabled successfully!")}catch(je){ke.error("Failed to update model status."),console.error("Failed to save model toggle:",je)}finally{x(!1)}},[A,s]),U=E.useCallback(async()=>{b(!0),_(!0);try{await new Promise(de=>setTimeout(de,800));const re=await l({title:"New Chat"});await c(re,"conversation"),ke.success("Welcome to your first chat!")}catch(re){ke.error("Failed to start your first chat."),console.error("Failed to start first chat:",re),b(!1),_(!1)}},[l,c]),W=()=>{Ce.emit(Tr.openModalRequest,{modalId:"settingsModal",initialTab:"providers"})},B=[k,C,T].filter(Boolean).length,ne=o?3:2,V=B/ne*100,Q=[...o?[{id:"api-key",title:"Add API Key",description:f.jsxs("div",{className:"space-y-2",children:[f.jsxs("p",{children:["To use providers like"," ",f.jsx(zd,{href:"https://platform.openai.com/api-keys",className:"text-blue-500 hover:text-blue-700 transition-colors",children:"OpenAI"}),","," ",f.jsx(zd,{href:"https://aistudio.google.com/app/apikey",className:"text-green-600 hover:text-green-700 transition-colors",children:"Google"}),","," ",f.jsx(zd,{href:"https://console.anthropic.com/settings/keys",className:"text-purple-500 hover:text-purple-700 transition-colors",children:"Anthropic (Claude)"}),", or"," ",f.jsx(zd,{href:"https://openrouter.ai/keys",className:"text-orange-500 hover:text-orange-700 transition-colors",children:"OpenRouter"})," ","or any OpenAI API compatible provider, add an API key. Keys are stored securely in your browser."]}),f.jsxs("p",{children:['If you want truly local AI, "no internet required", you can setup'," ",f.jsx(zd,{href:"https://www.ollama.com/",className:"text-teal-500 hover:text-teal-700 transition-colors",children:"Ollama"})," ","or,"," ",f.jsx(zd,{href:"https://lmstudio.ai/",className:"text-indigo-500 hover:text-indigo-700 transition-colors",children:"LMStudio"})," ","(or any other local LLM solution with an OpenAI compatible API). These typically don't require API keys so see you in step 2."]})]}),isComplete:k,content:f.jsx(cre,{onSave:H,onCancel:()=>{},disabled:u,className:"border-none shadow-none p-0",initialProviderType:j}),icon:f.jsx(nw,{className:"h-4 w-4"})}]:[],{id:"add-provider",title:"Add AI Provider",description:f.jsxs("div",{className:"space-y-2",children:[f.jsx("p",{children:"Connect to an AI provider you configured the key for..."}),f.jsx("p",{children:"This might look redundant, but it allows you to have multiple keys for the same provider (personal, professional, etc.)"})]}),isComplete:C,content:f.jsx(dre,{apiKeys:e,onAddProvider:O,onCancel:()=>{},initialType:j,initialName:L,initialApiKeyId:D}),icon:f.jsx(uy,{className:"h-4 w-4"})},{id:"enable-models",title:"Enable Models",description:f.jsxs("div",{className:"space-y-2",children:[f.jsxs("p",{children:["Enable models for the provider you just added (",f.jsx("span",{className:"font-medium text-primary",children:(A==null?void 0:A.name)||"..."}),")."]}),f.jsx("p",{children:"Enabling specific models improves the UI by reducing clutter and choice paralysis. You can enable more later in Settings."}),f.jsx("p",{children:"And just like before, you can choose to activate a model for a certain combination of key/provider!"})]}),isComplete:T,content:A?f.jsx("div",{className:"bg-card/40 rounded-lg p-3 border border-border/30 shadow-inner",children:f.jsx(e6,{providerId:A.id,allAvailableModels:N,enabledModelIds:I,onToggleModel:K,isLoading:a||v,listHeightClass:"h-[26rem]"})}):f.jsxs("p",{className:"text-sm text-muted-foreground italic flex items-center",children:[f.jsx(Sl,{className:"h-4 w-4 mr-2 text-amber-500"}),"Add a provider in Step ",o?"2":"1"," first."]}),icon:f.jsx(Qy,{className:"h-4 w-4"})},{id:"start-chat",title:"Start Chatting",description:"You're all set! Click below to start your first chat.",isComplete:!1,content:f.jsxs("div",{children:[w&&f.jsx(Cu.div,{initial:{opacity:0},animate:{opacity:1},className:"mb-4",children:f.jsx(Oy,{value:y?void 0:100,className:"h-2"})}),f.jsxs(ot,{onClick:U,disabled:y||!T,className:"w-full bg-gradient-to-r from-indigo-500 to-primary hover:opacity-90 transition-all",children:[f.jsx(Age,{className:"mr-2 h-4 w-4"}),y?"Launching...":"Start First Chat"]}),f.jsx(jte,{})]}),contentClassName:"p-4",icon:f.jsx(Xge,{className:"h-4 w-4"})}],ee=Q.findIndex(re=>!re.isComplete);return a?f.jsx("div",{className:"flex h-full flex-col items-center justify-center p-4 space-y-4 max-w-4xl mx-auto w-full",children:f.jsxs(Cu.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},className:"w-full",children:[f.jsx(Gr,{className:"h-12 w-1/2 mx-auto mb-6"}),f.jsx(Gr,{className:"h-8 w-3/4 mx-auto mb-2"}),f.jsx(Gr,{className:"h-4 w-1/2 mx-auto mb-8"}),f.jsx(Gr,{className:"h-20 w-full mb-6"}),f.jsx(Gr,{className:"h-20 w-full mb-6"}),f.jsx(Gr,{className:"h-20 w-full"})]})}):f.jsx("div",{className:"flex h-full flex-col items-center justify-start p-4 bg-gradient-to-b from-background to-background/80",children:f.jsxs("div",{className:"w-full max-w-4xl space-y-6 pt-8",children:[f.jsxs("div",{className:"text-center mb-8",children:[f.jsx(Cu.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{type:"spring",stiffness:500,damping:30},children:f.jsxs("div",{className:"relative mx-auto w-16 h-16 mb-4",children:[f.jsx("div",{className:"absolute inset-0 bg-primary/20 rounded-full blur-xl"}),f.jsx("div",{className:"relative bg-gradient-to-br from-primary to-indigo-600 p-3 rounded-full",children:f.jsx(V9e,{className:"h-10 w-10 text-white"})})]})}),f.jsx("h2",{className:"text-3xl font-bold mb-3 bg-gradient-to-r from-primary to-indigo-500 bg-clip-text text-transparent",children:"Welcome to LiteChat"}),f.jsx(H9e,{})]}),f.jsxs(Cu.div,{className:"space-y-4",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[f.jsx(wr,{children:f.jsxs(Sr,{children:[f.jsx(_r,{asChild:!0,children:f.jsxs("div",{className:"mt-6 bg-card/40 backdrop-blur-sm border border-border/30 rounded-xl p-3 w-3/4 mx-auto",children:[f.jsx(Oy,{value:V,className:"h-1.5"}),f.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["Setup Progress: ",Math.round(V),"%"]})]})}),f.jsx(Cr,{children:f.jsxs("p",{children:["Steps completed: ",B," of ",ne]})})]})}),Q.map((re,de)=>{const me=de===ee;return f.jsx(Cu.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:de*.1,duration:.3},children:f.jsx(s7e,{stepNumber:de+1,title:re.title,description:re.description,isComplete:re.id!=="start-chat"&&re.isComplete,isActive:me,openOnComplete:re.id==="enable-models",contentClassName:re.id==="add-provider"||re.id==="api-key"?"p-0 border-none shadow-none bg-transparent":re.contentClassName,icon:re.icon,children:re.content})},re.id)})]}),!a&&!C&&ee===-1&&f.jsxs(Cu.div,{className:"text-center mt-6 p-4 bg-red-500/10 rounded-lg border border-red-500/30",initial:{opacity:0},animate:{opacity:1},transition:{delay:.5},children:[f.jsx(Sl,{className:"h-8 w-8 text-red-500 mx-auto mb-2"}),f.jsx("p",{className:"text-sm mb-3",children:"Configuration issue detected. Please review provider settings."}),f.jsx(ot,{variant:"outline",size:"sm",onClick:W,className:"border-red-500/50 hover:bg-red-500/20 transition-colors",children:"Open Provider Settings"})]})]})})},_C=["conversation.title_generation","conversation.compact"],a7e=({conversationId:e,interactions:t,status:n,className:r})=>{const s=E.useRef(null),i=E.useRef(null),[a,o]=E.useState(!1),l=E.useRef(null),c=nn(O=>O.streamingInteractionIds),{chatMaxWidth:u,autoScrollInterval:d,enableAutoScrollOnStream:h}=pr(mn(O=>({chatMaxWidth:O.chatMaxWidth,autoScrollInterval:O.autoScrollInterval,enableAutoScrollOnStream:O.enableAutoScrollOnStream}))),m=pr(O=>O.setEnableAutoScrollOnStream),y=E.useMemo(()=>O=>({isLoading:O.isLoading}),[]),b=E.useMemo(()=>O=>({conversationCount:O.conversations.length,isConversationLoading:O.isLoading}),[]),{isLoading:v}=Gn(mn(y)),{conversationCount:x,isConversationLoading:w}=jn(mn(b)),{projectCount:_,isProjectLoading:k}=Va(mn(O=>({projectCount:O.projects.length,isProjectLoading:O.isLoading}))),C=E.useMemo(()=>v||w||k?!1:x===0&&_===0,[x,_,v,w,k]),T=E.useMemo(()=>t.filter(U=>U.parentId===null&&!_C.includes(U.type)).sort((U,W)=>U.index-W.index).map(U=>{const W=t.filter(B=>B.parentId===U.id&&!_C.includes(B.type)).sort((B,ne)=>B.index-ne.index);return[U,...W]}),[t]),A=Bi(mn(O=>Object.values(O.canvasControls))),N=E.useCallback((O,K,U,W)=>A.filter(ne=>{const V=ne.type===O,Q=ne.targetSlot===K,ee=!!ne.renderer;return V&&Q&&ee}).map(ne=>{if(ne.renderer){const Q={...{interaction:U,interactionId:U==null?void 0:U.id,responseContent:typeof(U==null?void 0:U.response)=="string"?U.response:void 0,canvasContextType:O},...W};return f.jsx(Ve.Fragment,{children:ne.renderer(Q)},ne.id)}return null}).filter(Boolean),[A]),I=(O="smooth")=>{if(i.current){i.current.scrollTo({top:i.current.scrollHeight,behavior:O});return}if(s.current){const K=s.current.querySelector("[data-radix-scroll-area-viewport]");if(K){i.current=K,K.scrollTo({top:K.scrollHeight,behavior:O});return}}s.current&&s.current.scrollTo({top:s.current.scrollHeight,behavior:O})};E.useEffect(()=>{if(i.current){const{scrollHeight:O,clientHeight:K,scrollTop:U}=i.current;(O-K<=U+150||n!=="streaming")&&requestAnimationFrame(()=>{I(n==="streaming"?"smooth":"auto")})}},[T.length,n,c]),E.useEffect(()=>(n==="streaming"&&h?(l.current&&clearInterval(l.current),l.current=setInterval(()=>{I("smooth")},d)):l.current&&(clearInterval(l.current),l.current=null),()=>{l.current&&clearInterval(l.current)}),[n,d,h]),E.useEffect(()=>{const O=i.current;if(!O)return;const K=()=>{if(!i.current)return;const{scrollHeight:U,clientHeight:W,scrollTop:B}=i.current,ne=B<U-W-W*.5;o(ne)};return O.addEventListener("scroll",K,{passive:!0}),K(),()=>{i.current&&i.current.removeEventListener("scroll",K)}},[]),E.useEffect(()=>{if(s.current){const O=s.current.querySelector("[data-radix-scroll-area-viewport]");O&&(i.current=O)}},[]);const j=E.useMemo(()=>{const O=[];return[...t].sort((W,B)=>{var ne,V;return W.index!==B.index?W.index-B.index:W.parentId===null&&B.parentId!==null?-1:W.parentId!==null&&B.parentId===null?1:W.parentId!==null&&B.parentId!==null&&W.parentId===B.parentId?W.index-B.index:(((ne=W.startedAt)==null?void 0:ne.getTime())??0)-(((V=B.startedAt)==null?void 0:V.getTime())??0)}).filter(W=>W.parentId===null&&!_C.includes(W.type)).forEach(W=>{var Q,ee;let B=null;if(W.type==="message.user_assistant"&&W.prompt)B=W.prompt;else if(W.type==="message.workflow_step"&&W.prompt)B=W.prompt;else if(W.type==="message.assistant_regen"&&((Q=W.metadata)!=null&&Q.regeneratedFromId)){let re,de=W;const me=new Set;for(;de&&!me.has(de.id);){if(me.add(de.id),de.type==="message.user_assistant"&&de.prompt){re=de;break}if((ee=de.metadata)!=null&&ee.regeneratedFromId)de=t.find(De=>De.id===de.metadata.regeneratedFromId);else break}re?B=re.prompt:W.prompt?B=W.prompt:console.warn(`[ChatCanvas] Could not reliably find user prompt for active interaction ${W.id} of type ${W.type}. Displaying turn without prompt.`)}if(B)O.push(f.jsx(Lw,{turnData:B,timestamp:W.startedAt,isAssistantComplete:W.status==="COMPLETED"||W.status==="ERROR",interactionId:W.id},`prompt-${W.id}`));else if(W.type!=="message.user_assistant"&&W.type!=="message.assistant_regen"&&W.type!=="message.workflow_step"){console.log("[ChatCanvas] Skipping active interaction on spine due to no user prompt and non-standard type:",W.id,W.type);return}const ne=t.filter(re=>re.parentId===W.id&&!_C.includes(re.type)).sort((re,de)=>re.index-de.index),V=[W,...ne];V.length>0&&O.push(f.jsx(Q8e,{interactionGroup:V,renderSlot:(re,de,me)=>N("interaction",re,de,me),activeStreamingInteractionId:c.find(re=>V.some(de=>de.id===re))},`tabs-${W.id}`))}),O},[t,N,c]),L=E.useMemo(()=>c.filter(O=>!t.some(K=>K.id===O)).map(O=>f.jsx(kk,{interactionId:O,renderSlot:(K,U,W)=>N("interaction",K,U,W)},`${O}-streaming-new`)),[c,t,N]),D=()=>v||w||k?f.jsxs("div",{className:"space-y-4 p-2 md:p-4",children:[f.jsx(Gr,{className:"h-24 w-full"}),f.jsx(Gr,{className:"h-32 w-full"}),f.jsx(Gr,{className:"h-20 w-full"})]}):e?T.length===0&&n!=="streaming"&&c.length===0?f.jsx(vU,{}):f.jsxs("div",{className:"space-y-4 p-2 md:p-4 break-words",children:[j,L]}):f.jsx(vU,{}),H=u||"max-w-7xl";return f.jsx("div",{className:Ye("flex-grow relative",r),children:C?f.jsx(Xo,{className:"h-full w-full",children:f.jsx("div",{className:Ye("mx-auto w-full",H),children:f.jsx(i7e,{})})}):f.jsxs(f.Fragment,{children:[f.jsx(Xo,{className:"h-full w-full",ref:s,children:f.jsx("div",{className:Ye("mx-auto w-full",H),children:D()})}),a&&f.jsx(wr,{delayDuration:100,children:f.jsxs(Sr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(ot,{variant:"outline",size:"icon",className:"absolute bottom-4 right-4 z-[var(--z-sticky)] h-8 w-8 rounded-full shadow-md bg-background/80 backdrop-blur-sm hover:bg-muted",onClick:()=>I(),"aria-label":"Scroll to bottom",children:f.jsx(DH,{className:"h-4 w-4"})})}),f.jsx(Cr,{side:"left",children:"Scroll to Bottom"})]})}),n==="streaming"&&f.jsx(wr,{delayDuration:100,children:f.jsxs(Sr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(ot,{variant:"outline",size:"icon",className:"absolute bottom-4 right-14 z-[var(--z-sticky)] h-8 w-8 rounded-full shadow-md bg-background/80 backdrop-blur-sm hover:bg-muted",onClick:()=>m(!h),"aria-label":h?"Disable follow stream":"Enable follow stream",children:h?f.jsx(zge,{className:"h-4 w-4"}):f.jsx(WH,{className:"h-4 w-4"})})}),f.jsx(Cr,{side:"left",children:h?"Stop Following Stream":"Follow Stream"})]})})]})})},o7e=Ve.memo(a7e),b0=({controls:e,panelId:t,renderMode:n="full",className:r})=>{const s=e.filter(i=>(i.panel??"main")===t&&(i.show?i.show():!0));return s.length===0?null:f.jsx("div",{className:Ye(r),children:s.map(i=>{const a=n==="icon"?i.iconRenderer:i.renderer;return f.jsx(Ve.Fragment,{children:a?a():null},i.id)})})},s1=Co(ko((e,t)=>({isChatControlPanelOpen:{},isPromptControlPanelOpen:{},isSidebarCollapsed:!1,globalLoading:!1,globalError:null,focusInputOnNextRender:!1,toggleChatControlPanel:(n,r)=>{const s=t().isChatControlPanelOpen[n]??!1,i=r??!s;s!==i&&(e(a=>{a.isChatControlPanelOpen[n]=i}),Ce.emit(Tr.chatControlPanelVisibilityChanged,{panelId:n,isOpen:i}))},togglePromptControlPanel:(n,r)=>{const s=t().isPromptControlPanelOpen[n]??!1,i=r??!s;s!==i&&(e(a=>{a.isPromptControlPanelOpen[n]=i}),Ce.emit(Tr.promptControlPanelVisibilityChanged,{controlId:n,isOpen:i}))},toggleSidebar:n=>{const r=t().isSidebarCollapsed,s=n??!r;r!==s&&(e({isSidebarCollapsed:s}),Ce.emit(Tr.sidebarVisibilityChanged,{isCollapsed:s}))},setGlobalLoading:n=>{t().globalLoading!==n&&(e({globalLoading:n}),Ce.emit(Tr.globalLoadingChanged,{loading:n}))},setGlobalError:n=>{t().globalError!==n&&(e({globalError:n}),Ce.emit(Tr.globalErrorChanged,{error:n}))},setFocusInputFlag:n=>{t().focusInputOnNextRender!==n&&(e({focusInputOnNextRender:n}),Ce.emit(Tr.focusInputFlagChanged,{focus:n}))},getRegisteredActionHandlers:()=>{const n="uiStateStore",r=t();return[{eventName:Tr.toggleSidebarRequest,handler:s=>r.toggleSidebar(s==null?void 0:s.isCollapsed),storeId:n},{eventName:Tr.toggleChatControlPanelRequest,handler:s=>r.toggleChatControlPanel(s.panelId,s.isOpen),storeId:n},{eventName:Tr.togglePromptControlPanelRequest,handler:s=>r.togglePromptControlPanel(s.controlId,s.isOpen),storeId:n},{eventName:Tr.setGlobalLoadingRequest,handler:s=>r.setGlobalLoading(s.loading),storeId:n},{eventName:Tr.setGlobalErrorRequest,handler:s=>r.setGlobalError(s.error),storeId:n},{eventName:Tr.setFocusInputFlagRequest,handler:s=>r.setFocusInputFlag(s.focus),storeId:n}]}})));var l7e=(e,t,n,r,s,i,a,o)=>{let l=document.documentElement,c=["light","dark"];function u(m){(Array.isArray(e)?e:[e]).forEach(y=>{let b=y==="class",v=b&&i?s.map(x=>i[x]||x):s;b?(l.classList.remove(...v),l.classList.add(i&&i[m]?i[m]:m)):l.setAttribute(y,m)}),d(m)}function d(m){o&&c.includes(m)&&(l.style.colorScheme=m)}function h(){return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}if(r)u(r);else try{let m=localStorage.getItem(t)||n,y=a&&m==="system"?h():m;u(y)}catch{}},c7e=E.createContext(void 0),u7e={setTheme:e=>{},themes:[]},d7e=()=>{var e;return(e=E.useContext(c7e))!=null?e:u7e};E.memo(({forcedTheme:e,storageKey:t,attribute:n,enableSystem:r,enableColorScheme:s,defaultTheme:i,value:a,themes:o,nonce:l,scriptProps:c})=>{let u=JSON.stringify([n,t,i,e,o,a,r,s]).slice(1,-1);return E.createElement("script",{...c,suppressHydrationWarning:!0,nonce:typeof window>"u"?l:"",dangerouslySetInnerHTML:{__html:`(${l7e.toString()})(${u})`}})});const f7e=({...e})=>{const{theme:t="system"}=d7e();return f.jsx(Tye,{theme:t,className:"toaster group",style:{"--normal-bg":"var(--popover)","--normal-text":"var(--popover-foreground)","--normal-border":"var(--border)"},...e})},hre=E.memo(E.forwardRef(({initialValue:e="",onSubmit:t,disabled:n,placeholder:r="Type message... (Shift+Enter for new line)",className:s,onValueChange:i,...a},o)=>{const l=E.useRef(null),[c,u]=E.useState(e);E.useImperativeHandle(o,()=>({getValue:()=>c,setValue:m=>{u(m),i&&i(m),Ce.emit(an.inputChanged,{value:m}),requestAnimationFrame(()=>{const y=l.current;y&&(y.style.height="auto",y.style.height=`${y.scrollHeight}px`,y.style.overflowY=y.scrollHeight>250?"auto":"hidden")})},focus:()=>{var m;return(m=l.current)==null?void 0:m.focus()},clearValue:()=>{u(""),i&&i(""),Ce.emit(an.inputChanged,{value:""}),requestAnimationFrame(()=>{const m=l.current;m&&(m.style.height="auto",m.style.height=`${m.scrollHeight}px`,m.style.overflowY="hidden")})}}));const d=m=>{var y;if(m.key==="Enter"&&!m.shiftKey&&!n){m.preventDefault();const b=Ph.getState().attachedFilesMetadata.length>0;(c.trim().length>0||b)&&(t(),(y=o==null?void 0:o.current)==null||y.clearValue())}},h=m=>{const y=m.target.value;u(y),i&&i(y),Ce.emit(an.inputChanged,{value:y})};return E.useEffect(()=>{const m=l.current;if(m){m.style.height="auto";const y=m.scrollHeight,b=250;m.style.height=`${Math.min(y,b)}px`,m.style.overflowY=y>b?"auto":"hidden"}},[c]),E.useEffect(()=>{e!==c&&(u(e),i&&i(e))},[e,i]),E.useEffect(()=>{const m=y=>{u(y.text),i&&i(y.text),Ce.emit(an.inputChanged,{value:y.text}),requestAnimationFrame(()=>{const b=l.current;b&&(b.style.height="auto",b.style.height=`${b.scrollHeight}px`,b.style.overflowY=b.scrollHeight>250?"auto":"hidden")})};return Ce.on(an.setInputTextRequest,m),()=>{Ce.off(an.setInputTextRequest,m)}},[i]),f.jsx(Ci,{ref:l,value:c,onChange:h,onKeyDown:d,disabled:n,placeholder:r,rows:1,className:Ye("w-full p-3 border rounded bg-input text-foreground resize-none focus:ring-2 focus:ring-primary outline-none disabled:opacity-50 overflow-y-auto","min-h-[40px] max-h-[250px]",s),"aria-label":"Chat input",...a})}));hre.displayName="InputArea";const ji={dbModsLoaded:"mod.db.mods.loaded",loadedInstancesChanged:"mod.loaded.instances.changed",settingsTabsChanged:"mod.settings.tabs.changed",loadingStateChanged:"mod.loading.state.changed",modLoaded:"mod.sdk.loaded",modError:"mod.sdk.error",loadDbModsRequest:"mod.load.db.mods.request",addDbModRequest:"mod.add.db.mod.request",updateDbModRequest:"mod.update.db.mod.request",deleteDbModRequest:"mod.delete.db.mod.request"},Yh=Co(ko((e,t)=>({dbMods:[],loadedMods:[],modSettingsTabs:[],isLoading:!1,error:null,loadDbMods:async()=>{e({isLoading:!0,error:null});try{const n=await yt.loadMods();e({dbMods:n,isLoading:!1}),Ce.emit(ji.dbModsLoaded,{dbMods:n})}catch(n){const r="Failed to load mods";console.error("ModStore: Error loading mods",n),e({error:r,isLoading:!1}),Ce.emit(ji.loadingStateChanged,{isLoading:!1,error:r}),ke.error(r)}},addDbMod:async n=>{const r=Nr(),s={id:r,createdAt:new Date,...n,loadOrder:n.loadOrder??Date.now()};e(i=>{i.dbMods.push(s),i.dbMods.sort((a,o)=>a.loadOrder-o.loadOrder)});try{return await yt.saveMod(s),ke.success(`Mod "${s.name}" added.`),Ce.emit(ji.dbModsLoaded,{dbMods:t().dbMods}),r}catch(i){const a="Failed to save new mod";throw console.error("ModStore: Error adding mod",i),e(o=>{o.dbMods=o.dbMods.filter(l=>l.id!==r),o.error=a}),Ce.emit(ji.loadingStateChanged,{isLoading:t().isLoading,error:a}),ke.error(a),i}},updateDbMod:async(n,r)=>{let s,i=-1;e(o=>{i=o.dbMods.findIndex(l=>l.id===n),i!==-1?(s={...o.dbMods[i]},o.dbMods[i]={...o.dbMods[i],...r},r.loadOrder!==void 0&&o.dbMods.sort((l,c)=>l.loadOrder-c.loadOrder)):console.warn(`ModStore: Mod ${n} not found for update.`)});const a=i!==-1?t().dbMods[i]:void 0;if(a)try{await yt.saveMod(a),ke.success(`Mod "${a.name}" updated.`),Ce.emit(ji.dbModsLoaded,{dbMods:t().dbMods})}catch(o){const l="Failed to save mod update";throw console.error("ModStore: Error updating mod",o),e(c=>{const u=c.dbMods.findIndex(d=>d.id===n);u!==-1&&s&&(c.dbMods[u]=s,c.dbMods.sort((d,h)=>d.loadOrder-h.loadOrder)),c.error=l}),Ce.emit(ji.loadingStateChanged,{isLoading:t().isLoading,error:l}),ke.error(l),o}},deleteDbMod:async n=>{const r=t().dbMods.find(i=>i.id===n);if(!r){console.warn(`ModStore: Mod ${n} not found for deletion.`);return}const s=r.name;e(i=>({dbMods:i.dbMods.filter(a=>a.id!==n)}));try{await yt.deleteMod(n),ke.success(`Mod "${s}" deleted.`),Ce.emit(ji.dbModsLoaded,{dbMods:t().dbMods})}catch(i){const a="Failed to delete mod";throw console.error("ModStore: Error deleting mod",i),e(o=>{o.dbMods.push(r),o.dbMods.sort((l,c)=>l.loadOrder-c.loadOrder),o.error=a}),Ce.emit(ji.loadingStateChanged,{isLoading:t().isLoading,error:a}),ke.error(a),i}},setLoadedMods:n=>{e({loadedMods:n}),Ce.emit(ji.loadedInstancesChanged,{loadedMods:n})},_addSettingsTab:n=>{e(r=>{if(!r.modSettingsTabs.some(s=>s.id===n.id))r.modSettingsTabs.push(n),r.modSettingsTabs.sort((s,i)=>(s.order??999)-(i.order??999));else{console.warn(`ModStore: Settings tab with ID "${n.id}" already registered. Overwriting.`);const s=r.modSettingsTabs.findIndex(i=>i.id===n.id);r.modSettingsTabs[s]=n,r.modSettingsTabs.sort((i,a)=>(i.order??999)-(a.order??999))}}),Ce.emit(ji.settingsTabsChanged,{tabs:t().modSettingsTabs})},_removeSettingsTab:n=>{e(r=>{r.modSettingsTabs=r.modSettingsTabs.filter(s=>s.id!==n)}),Ce.emit(ji.settingsTabsChanged,{tabs:t().modSettingsTabs})},getRegisteredActionHandlers:()=>{const n="modStore",r=t(),s=i=>async a=>{await i(a)};return[{eventName:ji.loadDbModsRequest,handler:r.loadDbMods,storeId:n},{eventName:ji.addDbModRequest,handler:s(r.addDbMod),storeId:n},{eventName:ji.updateDbModRequest,handler:i=>r.updateDbMod(i.id,i.changes),storeId:n},{eventName:ji.deleteDbModRequest,handler:i=>r.deleteDbMod(i.id),storeId:n}]}}))),bp={loaded:"app.loaded",errorBoundaryTriggered:"app.error.boundary.triggered",initializationPhaseCompleted:"app.initialization.phase.completed"};function UP(e){const t=e.id,n=e.name;return{modId:t,modName:n,registerPromptControl:s=>(Ce.emit(Ur.registerPromptControlRequest,{control:s}),()=>Ce.emit(Ur.unregisterPromptControlRequest,{id:s.id})),registerChatControl:s=>{const i={...s,status:s.status??(()=>"ready")};return Ce.emit(Ur.registerChatControlRequest,{control:i}),()=>Ce.emit(Ur.unregisterChatControlRequest,{id:s.id})},registerCanvasControl:s=>(Ce.emit(Ur.registerCanvasControlRequest,{control:s}),()=>Ce.emit(Ur.unregisterCanvasControlRequest,{id:s.id})),registerBlockRenderer:s=>(Ce.emit(A0.registerBlockRendererRequest,{renderer:s}),()=>Ce.emit(A0.unregisterBlockRendererRequest,{id:s.id})),registerTool:(s,i,a)=>(console.log(`[${n}] Registering tool: ${s}`),Ce.emit(Ur.registerToolRequest,{modId:t,toolName:s,definition:i,implementation:a}),()=>Ce.emit(Ur.unregisterToolRequest,{toolName:s})),on:(s,i)=>(Ce.on(s,i),()=>Ce.off(s,i)),emit:(s,i)=>{Ce.emit(s,i)},addMiddleware:(s,i)=>(Ce.emit(Ur.registerMiddlewareRequest,{hookName:s,modId:t,callback:i}),()=>Ce.emit(Ur.unregisterMiddlewareRequest,{hookName:s,modId:t,callback:i})),registerSettingsTab:s=>(Yh.getState()._addSettingsTab(s),()=>Yh.getState()._removeSettingsTab(s.id)),getContextSnapshot:()=>{const s=nn.getState(),i=jn.getState(),a=pr.getState(),o=Gn.getState(),{providerId:l}=Ql(o.selectedModelId),c=i.selectedItemType==="conversation"?i.selectedItemId:null;return Object.freeze({selectedConversationId:c,interactions:Object.freeze(s.currentConversationId===c?s.interactions.map(u=>Object.freeze({...u})):[]),isStreaming:s.status==="streaming",selectedProviderId:l,selectedModelId:o.selectedModelId,activeSystemPrompt:a.globalSystemPrompt,temperature:a.temperature,maxTokens:a.maxTokens,theme:a.theme,gitUserName:a.gitUserName,gitUserEmail:a.gitUserEmail})},showToast:(s,i)=>{ke[s](`[Mod: ${n}] ${i}`)},log:(s,...i)=>{console[s](`[Mod: ${n}]`,...i)},registerModalProvider:(s,i)=>(Ce.emit(Ur.registerModalProviderRequest,{modalId:s,provider:i}),()=>Ce.emit(Ur.unregisterModalProviderRequest,{modalId:s})),getVfsInstance:async s=>ti.getState().initializeVFS(s,{force:!0})}}async function h7e(e){const t=e.filter(r=>r.enabled),n=await Promise.all(t.map(async r=>{let s=r.scriptContent,i=null,a=null;try{if(i=UP(r),r.sourceUrl){console.log(`[ModLoader] Fetching script for ${r.name} from ${r.sourceUrl}`);try{const c=await fetch(r.sourceUrl);if(!c.ok)throw new Error(`Failed to fetch mod script: ${c.status} ${c.statusText}`);s=await c.text(),console.log(`[ModLoader] Successfully fetched script for ${r.name}`)}catch(c){throw console.error(`[ModLoader] Error fetching script from ${r.sourceUrl}:`,c),c}}if(!s)throw new Error("Mod script content is empty.");new Function("modApi",s)(i),console.log(`[ModLoader] Successfully executed script for ${r.name}`)}catch(l){a=l instanceof Error?l:String(l),console.error(`[ModLoader] Error loading mod "${r.name}":`,l),ke.error(`Error loading mod "${r.name}": ${a instanceof Error?a.message:a}`)}i||(i=UP(r));const o={id:r.id,name:r.name,api:i,error:a};return Ce.emit(o.error?ji.modError:ji.modLoaded,{id:r.id,name:r.name,error:o.error??"unknown error"}),o}));return Ce.emit(bp.loaded,void 0),console.log(`[ModLoader] Finished processing ${n.length} mods.`),n}const vr={dataLoaded:"rules.data.loaded",ruleSaved:"rules.rule.saved",ruleDeleted:"rules.rule.deleted",tagSaved:"rules.tag.saved",tagDeleted:"rules.tag.deleted",linkSaved:"rules.link.saved",linkDeleted:"rules.link.deleted",loadingStateChanged:"rules.loading.state.changed",loadRulesAndTagsRequest:"rules.load.rules.and.tags.request",addRuleRequest:"rules.add.rule.request",updateRuleRequest:"rules.update.rule.request",deleteRuleRequest:"rules.delete.rule.request",addTagRequest:"rules.add.tag.request",updateTagRequest:"rules.update.tag.request",deleteTagRequest:"rules.delete.tag.request",linkTagToRuleRequest:"rules.link.tag.to.rule.request",unlinkTagFromRuleRequest:"rules.unlink.tag.from.rule.request"},$q=null;class p7e{static async applyBundledConfig(t){{console.log("[BundledConfig] No bundled user configuration found, skipping...");return}}static hasBundledConfig(){return $q!==null}static getBundledConfig(){return $q}}class i1{static async syncAll(t={}){const n={syncRepos:!0,syncConversations:!0,continueOnError:!0,maxConcurrent:3,...t};if(this.isRunning){ke.warning("Bulk sync already in progress");return}this.isRunning=!0,this.abortController=new AbortController;const r=jn.getState(),s=r.syncRepos,i=r.conversations.filter(o=>o.syncRepoId),a={totalRepos:n.syncRepos?s.length:0,completedRepos:0,totalConversations:n.syncConversations?i.length:0,completedConversations:0,currentOperation:"Starting bulk sync...",errors:[]};try{Ce.emit(ds.bulkSyncStarted,{progress:a}),ke.info(`Starting bulk sync: ${s.length} repositories, ${i.length} conversations`),n.syncRepos&&s.length>0&&await this.syncRepositoriesInBatches(s,n,a),n.syncConversations&&i.length>0&&await this.syncConversationsInBatches(i,n,a);const o=a.errors.length>0;Ce.emit(ds.bulkSyncCompleted,{progress:a,success:!o}),o?(ke.warning(`Bulk sync completed with ${a.errors.length} errors. Check console for details.`),console.warn("Bulk sync errors:",a.errors)):ke.success("Bulk sync completed successfully!")}catch(o){console.error("Bulk sync failed:",o),ke.error(`Bulk sync failed: ${o instanceof Error?o.message:"Unknown error"}`),Ce.emit(ds.bulkSyncFailed,{progress:a,error:String(o)})}finally{this.isRunning=!1,this.abortController=null}}static async syncPendingConversations(){const t=jn.getState(),n=t.conversations.filter(r=>{const s=t.conversationSyncStatus[r.id];return r.syncRepoId&&s==="needs-sync"});if(n.length===0){ke.info("No conversations need syncing");return}ke.info(`Syncing ${n.length} pending conversations...`),await this.syncAll({syncRepos:!1,syncConversations:!0,continueOnError:!0,maxConcurrent:2})}static async initializeAllRepositories(){const n=jn.getState().syncRepos;if(n.length===0){ke.info("No repositories configured");return}ke.info(`Initializing ${n.length} repositories...`),await this.syncAll({syncRepos:!0,syncConversations:!1,continueOnError:!0,maxConcurrent:2})}static abort(){this.isRunning&&this.abortController&&(this.abortController.abort(),ke.info("Bulk sync operation cancelled"))}static isActive(){return this.isRunning}static async syncRepositoriesInBatches(t,n,r){var i;r.currentOperation="Initializing repositories...",Ce.emit(ds.bulkSyncProgress,{progress:r});const s=this.createBatches(t,n.maxConcurrent);for(const a of s){if((i=this.abortController)!=null&&i.signal.aborted)throw new Error("Operation cancelled");const o=a.map(async l=>{try{r.currentOperation=`Syncing repository: ${l.name}`,Ce.emit(ds.bulkSyncProgress,{progress:r}),await jn.getState().initializeOrSyncRepo(l.id,!0),r.completedRepos++}catch(c){const u=c instanceof Error?c.message:String(c);if(r.errors.push({type:"repo",id:l.id,error:u}),console.error(`Failed to sync repository ${l.name}:`,c),!n.continueOnError)throw c}});await Promise.all(o),Ce.emit(ds.bulkSyncProgress,{progress:r})}}static async syncConversationsInBatches(t,n,r){var i;r.currentOperation="Syncing conversations...",Ce.emit(ds.bulkSyncProgress,{progress:r});const s=this.createBatches(t,n.maxConcurrent);for(const a of s){if((i=this.abortController)!=null&&i.signal.aborted)throw new Error("Operation cancelled");const o=a.map(async l=>{try{r.currentOperation=`Syncing conversation: ${l.title}`,Ce.emit(ds.bulkSyncProgress,{progress:r}),await jn.getState().syncConversation(l.id,!0),r.completedConversations++}catch(c){const u=c instanceof Error?c.message:String(c);if(r.errors.push({type:"conversation",id:l.id,error:u}),console.error(`Failed to sync conversation ${l.title}:`,c),!n.continueOnError)throw c}});await Promise.all(o),Ce.emit(ds.bulkSyncProgress,{progress:r})}}static createBatches(t,n){const r=[];for(let s=0;s<t.length;s+=n)r.push(t.slice(s,s+n));return r}}ce(i1,"isRunning",!1),ce(i1,"abortController",null);const Z0=Object.freeze(Object.defineProperty({__proto__:null,BulkSyncService:i1},Symbol.toStringTag,{value:"Module"}));class pre{static async runStartupSync(){if(!this.hasRunStartupSync){this.hasRunStartupSync=!0;try{const t=jn.getState(),n=pr.getState();await new Promise(o=>setTimeout(o,1e3));const r=t.syncRepos,s=t.conversations.filter(o=>o.syncRepoId);if(r.length===0){console.log("[StartupSync] No repositories configured, skipping startup sync");return}console.log(`[StartupSync] Found ${r.length} repositories and ${s.length} synced conversations`);const i=r.filter(o=>{const l=t.repoInitializationStatus[o.id];return!l||l==="error"});i.length>0&&n.autoInitializeReposOnStartup?(console.log(`[StartupSync] Initializing ${i.length} repositories in background`),setTimeout(async()=>{try{await i1.syncAll({syncRepos:!0,syncConversations:!1,continueOnError:!0,maxConcurrent:1})}catch(o){console.warn("[StartupSync] Background repo initialization failed:",o)}},2e3)):i.length>0&&console.log(`[StartupSync] Found ${i.length} uninitialized repositories, but auto-initialization is disabled`);const a=s.filter(o=>t.conversationSyncStatus[o.id]==="needs-sync");a.length>0&&n.autoSyncOnStreamComplete&&(console.log(`[StartupSync] Found ${a.length} conversations pending sync`),setTimeout(async()=>{try{await i1.syncPendingConversations()}catch(o){console.warn("[StartupSync] Background conversation sync failed:",o)}},5e3))}catch(t){console.error("[StartupSync] Startup sync failed:",t)}}}static reset(){this.hasRunStartupSync=!1}}ce(pre,"hasRunStartupSync",!1);function m7e(e){const t=new Map(e.map(a=>[a.id,a])),n=new Set,r=new Set,s=[];function i(a){if(n.has(a.id))return!0;if(r.has(a.id))return console.error(`[Init] Circular dependency detected involving module: ${a.id}`),ke.error("Initialization Error: Circular dependency in controls."),!1;r.add(a.id);for(const o of a.dependencies??[]){const l=t.get(o);if(!l)return console.error(`[Init] Missing dependency "${o}" for module "${a.id}"`),ke.error(`Initialization Error: Missing dependency "${o}" for "${a.id}".`),r.delete(a.id),!1;if(!i(l))return r.delete(a.id),!1}return r.delete(a.id),n.add(a.id),s.push(a),!0}for(const a of e)if(!n.has(a.id)&&!i(a))return null;return s}async function g7e(e,t){console.log("[Init] Core Data: Applying bundled configuration..."),await p7e.applyBundledConfig(),console.log("[Init] Core Data: Requesting loads..."),t.emit(on.loadSettingsRequest,void 0),t.emit(Vn.loadInitialDataRequest,void 0),t.emit(vr.loadRulesAndTagsRequest,void 0),t.emit(tr.loadConversationsRequest,void 0),t.emit(Ta.loadProjectsRequest,void 0),await new Promise(n=>{let r=!1,s=!1,i=!1,a=!1,o=!1;const l=()=>{r&&s&&i&&a&&o&&n()},c=t.on(on.loaded,()=>{r=!0,c(),l()}),u=t.on(Vn.initialDataLoaded,()=>{s=!0,u(),l()}),d=t.on(vr.dataLoaded,()=>{i=!0,d(),l()}),h=t.on(tr.conversationsLoaded,()=>{a=!0,h(),l()}),m=t.on(Ta.loaded,()=>{o=!0,m(),l()})}),Ce.emit(bp.initializationPhaseCompleted,{phase:"coreData"}),console.log("[Init] Core Data: Loaded (or load requested)."),setTimeout(()=>{pre.runStartupSync().catch(n=>{console.warn("[Init] Startup sync failed:",n)})},1e3)}async function y7e(e,t){console.log("[Init] Control Modules: Instantiation & Dependency Resolution START");const n=e.map(s=>new s),r=m7e(n);if(!r)throw console.error("[Init] Control Modules: Dependency resolution FAILED."),new Error("Failed to resolve control module dependency order.");console.log(`[Init] Control Modules: Dependency order resolved (${r.length} modules):`,r.map(s=>s.id)),console.log("[Init] Control Modules: Instantiation & Dependency Resolution COMPLETE"),console.log("[Init] Control Modules: Initialization START");for(const s of r)try{await s.initialize(t)}catch(i){console.error(`[Init] Error initializing module "${s.id}":`,i),ke.error(`Module Init Error (${s.id}): ${i instanceof Error?i.message:String(i)}`)}return Ce.emit(bp.initializationPhaseCompleted,{phase:"controlModulesInit"}),console.log("[Init] Control Modules: Initialization COMPLETE."),r}function b7e(e,t){console.log("[Init] Control Modules: Registration START");for(const n of e)try{n.register(t)}catch(r){console.error(`[Init] Error registering module "${n.id}":`,r),ke.error(`Module Registration Error (${n.id}): ${r instanceof Error?r.message:String(r)}`)}Ce.emit(bp.initializationPhaseCompleted,{phase:"controlModulesRegister"}),console.log("[Init] Control Modules: Registration COMPLETE.")}async function v7e(e,t){console.log("[Init] External Mods: Loading DB records..."),t.emit(ji.loadDbModsRequest,void 0),await new Promise(s=>{const i=t.on(ji.dbModsLoaded,()=>{i(),s()})});const n=Yh.getState().dbMods;console.log(`[Init] External Mods: Processing ${n.length} mods...`);const r=await h7e(n);Yh.getState().setLoadedMods(r),Ce.emit(bp.initializationPhaseCompleted,{phase:"externalMods"}),console.log(`[Init] External Mods: ${r.length} mods processed.`)}function x7e(e,t){var a;console.log("[Init] Core UI States: Initializing...");const n=e.selectedItemId,r=e.selectedItemType,s=r==="project"?n:r==="conversation"?((a=e.getConversationById(n))==null?void 0:a.projectId)??null:null,i=e.getEffectiveProjectSettings(s);t.emit(an.initializePromptStateRequest,{effectiveSettings:i}),Ce.emit(bp.initializationPhaseCompleted,{phase:"uiStateSync"}),console.log("[Init] Core UI States: Initial prompt state synchronization requested.")}async function w7e(e,t){console.log("[Init] LiteChat Full Initialization START"),bl.initializeCanvasEventHandlers();const n={requestLoadSettings:()=>t.emit(on.loadSettingsRequest,void 0),requestLoadProviderData:()=>t.emit(Vn.loadInitialDataRequest,void 0),requestLoadRulesAndTags:()=>t.emit(vr.loadRulesAndTagsRequest,void 0),requestLoadConversations:()=>t.emit(tr.loadConversationsRequest,void 0),requestLoadProjects:()=>t.emit(Ta.loadProjectsRequest,void 0),requestLoadDbMods:()=>t.emit(ji.loadDbModsRequest,void 0),setLoadedMods:Yh.getState().setLoadedMods,getConversationById:jn.getState().getConversationById,getEffectiveProjectSettings:Va.getState().getEffectiveProjectSettings,initializePromptState:co.getState().initializePromptState,selectedItemId:jn.getState().selectedItemId,selectedItemType:jn.getState().selectedItemType};let r=[];try{await g7e(n,t),r=await y7e(e,t),b7e(r,t),await v7e(n,t),x7e(n,t),Ce.emit(bp.initializationPhaseCompleted,{phase:"all"}),console.log("LiteChat: Full initialization sequence COMPLETE.")}catch(s){throw console.error("LiteChat: Full initialization sequence FAILED:",s),ke.error(`Initialization sequence failed: ${s instanceof Error?s.message:String(s)}`),s1.getState().setGlobalError("Initialization sequence failed."),s}return r}const mre=Co(ko((e,t)=>({rules:[],tags:[],tagRuleLinks:[],isLoading:!1,error:null,loadRulesAndTags:async()=>{e({isLoading:!0,error:null});try{const[n,r,s]=await Promise.all([yt.loadRules(),yt.loadTags(),yt.loadTagRuleLinks()]);e({rules:n,tags:r,tagRuleLinks:s,isLoading:!1}),Ce.emit(vr.dataLoaded,{rules:n,tags:r,links:s})}catch(n){console.error("RulesStore: Error loading rules and tags",n),e({error:"Failed load rules/tags",isLoading:!1}),ke.error("Failed to load rules and tags."),Ce.emit(vr.loadingStateChanged,{isLoading:!1,error:"Failed load rules/tags"})}},addRule:async n=>{const r=Nr(),s=new Date,i={id:r,createdAt:s,updatedAt:s,...n};e(a=>{a.rules.push(i),a.rules.sort((o,l)=>o.name.localeCompare(l.name))});try{await yt.saveRule(i),ke.success(`Rule "${i.name}" added.`),Ce.emit(vr.ruleSaved,{rule:i});const{rules:a,tags:o,tagRuleLinks:l}=t();return Ce.emit(vr.dataLoaded,{rules:[...a],tags:[...o],links:[...l]}),r}catch(a){throw console.error("RulesStore: Error adding rule",a),e(o=>({error:"Failed to save new rule",rules:o.rules.filter(l=>l.id!==r)})),ke.error("Failed to save new rule."),a}},updateRule:async(n,r)=>{const s=t().rules.find(a=>a.id===n);if(!s)throw ke.error("Rule not found for update."),new Error("Rule not found");const i={...s,...r,updatedAt:new Date};e(a=>{const o=a.rules.findIndex(l=>l.id===n);o!==-1&&(a.rules[o]=i,a.rules.sort((l,c)=>l.name.localeCompare(c.name)))});try{await yt.saveRule(i),ke.success(`Rule "${i.name}" updated.`),Ce.emit(vr.ruleSaved,{rule:i});const{rules:a,tags:o,tagRuleLinks:l}=t();Ce.emit(vr.dataLoaded,{rules:[...a],tags:[...o],links:[...l]})}catch(a){throw console.error("RulesStore: Error updating rule",a),e(o=>{const l=o.rules.findIndex(c=>c.id===n);l!==-1&&(o.rules[l]=s,o.rules.sort((c,u)=>c.name.localeCompare(u.name))),o.error="Failed to save rule update"}),ke.error("Failed to save rule update."),a}},deleteRule:async n=>{const r=t().rules.find(a=>a.id===n);if(!r)throw ke.error("Rule not found for deletion."),new Error("Rule not found");const s=[...t().tagRuleLinks.filter(a=>a.ruleId===n)],i={...r};e(a=>{a.rules=a.rules.filter(o=>o.id!==n),a.tagRuleLinks=a.tagRuleLinks.filter(o=>o.ruleId!==n)});try{await yt.deleteRule(n),ke.success(`Rule "${r.name}" deleted.`),Ce.emit(vr.ruleDeleted,{ruleId:n});const{rules:a,tags:o,tagRuleLinks:l}=t();Ce.emit(vr.dataLoaded,{rules:[...a],tags:[...o],links:[...l]})}catch(a){throw console.error("RulesStore: Error deleting rule",a),e(o=>{o.rules.find(l=>l.id===i.id)||(o.rules.push(i),o.rules.sort((l,c)=>l.name.localeCompare(c.name))),s.forEach(l=>{o.tagRuleLinks.find(c=>c.tagId===l.tagId&&c.ruleId===l.ruleId)||o.tagRuleLinks.push(l)}),o.error="Failed to delete rule"}),ke.error("Failed to delete rule."),a}},addTag:async n=>{const r=Nr(),s=new Date,i={id:r,createdAt:s,updatedAt:s,...n};e(a=>{a.tags.push(i),a.tags.sort((o,l)=>o.name.localeCompare(l.name))});try{await yt.saveTag(i),ke.success(`Tag "${i.name}" added.`),Ce.emit(vr.tagSaved,{tag:i});const{rules:a,tags:o,tagRuleLinks:l}=t();return Ce.emit(vr.dataLoaded,{rules:[...a],tags:[...o],links:[...l]}),r}catch(a){throw console.error("RulesStore: Error adding tag",a),e(o=>({error:"Failed to save new tag",tags:o.tags.filter(l=>l.id!==r)})),ke.error("Failed to save new tag."),a}},updateTag:async(n,r)=>{const s=t().tags.find(a=>a.id===n);if(!s)throw ke.error("Tag not found for update."),new Error("Tag not found");const i={...s,...r,updatedAt:new Date};e(a=>{const o=a.tags.findIndex(l=>l.id===n);o!==-1&&(a.tags[o]=i,a.tags.sort((l,c)=>l.name.localeCompare(c.name)))});try{await yt.saveTag(i),ke.success(`Tag "${i.name}" updated.`),Ce.emit(vr.tagSaved,{tag:i});const{rules:a,tags:o,tagRuleLinks:l}=t();Ce.emit(vr.dataLoaded,{rules:[...a],tags:[...o],links:[...l]})}catch(a){throw console.error("RulesStore: Error updating tag",a),e(o=>{const l=o.tags.findIndex(c=>c.id===n);l!==-1&&(o.tags[l]=s,o.tags.sort((c,u)=>c.name.localeCompare(u.name))),o.error="Failed to save tag update"}),ke.error("Failed to save tag update."),a}},deleteTag:async n=>{const r=t().tags.find(a=>a.id===n);if(!r)throw ke.error("Tag not found for deletion."),new Error("Tag not found");const s={...r},i=[...t().tagRuleLinks.filter(a=>a.tagId===n)];e(a=>{a.tags=a.tags.filter(o=>o.id!==n),a.tagRuleLinks=a.tagRuleLinks.filter(o=>o.tagId!==n)});try{await yt.deleteTag(n),ke.success(`Tag "${r.name}" deleted.`),Ce.emit(vr.tagDeleted,{tagId:n});const{rules:a,tags:o,tagRuleLinks:l}=t();Ce.emit(vr.dataLoaded,{rules:[...a],tags:[...o],links:[...l]})}catch(a){throw console.error("RulesStore: Error deleting tag",a),e(o=>{o.tags.find(l=>l.id===s.id)||(o.tags.push(s),o.tags.sort((l,c)=>l.name.localeCompare(c.name))),i.forEach(l=>{o.tagRuleLinks.find(c=>c.tagId===l.tagId&&c.ruleId===l.ruleId)||o.tagRuleLinks.push(l)}),o.error="Failed to delete tag"}),ke.error("Failed to delete tag."),a}},linkTagToRule:async(n,r)=>{const s=`${n}-${r}`;if(t().tagRuleLinks.some(a=>a.id===s)){ke.info("Link already exists.");return}const i={id:s,tagId:n,ruleId:r};e(a=>{a.tagRuleLinks.push(i)});try{await yt.saveTagRuleLink(i),ke.success("Tag linked to rule."),vr.linkSaved&&Ce.emit(vr.linkSaved,{link:i});const{rules:a,tags:o,tagRuleLinks:l}=t();Ce.emit(vr.dataLoaded,{rules:[...a],tags:[...o],links:[...l]})}catch(a){throw console.error("RulesStore: Error linking tag to rule",a),e(o=>{o.tagRuleLinks=o.tagRuleLinks.filter(l=>l.id!==s),o.error="Failed to link tag to rule"}),ke.error("Failed to link tag to rule."),a}},unlinkTagFromRule:async(n,r)=>{const s=`${n}-${r}`,i=t().tagRuleLinks.find(a=>a.id===s);i||ke.info("Link not found for unlinking."),e(a=>{a.tagRuleLinks=a.tagRuleLinks.filter(o=>o.id!==s)});try{await yt.deleteTagRuleLink(s),ke.success("Tag unlinked from rule."),vr.linkDeleted&&Ce.emit(vr.linkDeleted,{linkId:s});const{rules:a,tags:o,tagRuleLinks:l}=t();Ce.emit(vr.dataLoaded,{rules:[...a],tags:[...o],links:[...l]})}catch(a){throw console.error("RulesStore: Error unlinking tag from rule",a),i&&e(o=>{o.tagRuleLinks.some(l=>l.id===i.id)||o.tagRuleLinks.push(i),o.error="Failed to unlink tag from rule"}),ke.error("Failed to unlink tag from rule."),a}},getRulesForTag:n=>{const r=t(),s=new Set(r.tagRuleLinks.filter(i=>i.tagId===n).map(i=>i.ruleId));return r.rules.filter(i=>s.has(i.id))},getTagsForRule:n=>{const r=t(),s=new Set(r.tagRuleLinks.filter(i=>i.ruleId===n).map(i=>i.tagId));return r.tags.filter(i=>s.has(i.id))},getRuleById:n=>t().rules.find(r=>r.id===n),getTagById:n=>t().tags.find(r=>r.id===n),getRulesByIds:n=>{const r=new Set(n);return t().rules.filter(s=>r.has(s.id))},getRegisteredActionHandlers:()=>{const n="rulesStore",r=t(),s=i=>async a=>{await i(a)};return[{eventName:vr.loadRulesAndTagsRequest,handler:r.loadRulesAndTags,storeId:n},{eventName:vr.addRuleRequest,handler:s(r.addRule),storeId:n},{eventName:vr.updateRuleRequest,handler:i=>r.updateRule(i.id,i.updates),storeId:n},{eventName:vr.deleteRuleRequest,handler:i=>r.deleteRule(i.id),storeId:n},{eventName:vr.addTagRequest,handler:s(r.addTag),storeId:n},{eventName:vr.updateTagRequest,handler:i=>r.updateTag(i.id,i.updates),storeId:n},{eventName:vr.deleteTagRequest,handler:i=>r.deleteTag(i.id),storeId:n},{eventName:vr.linkTagToRuleRequest,handler:i=>r.linkTagToRule(i.tagId,i.ruleId),storeId:n},{eventName:vr.unlinkTagFromRuleRequest,handler:i=>r.unlinkTagFromRule(i.tagId,i.ruleId),storeId:n}]}}))),Aa={promptTemplatesChanged:"prompt-template.prompts.changed",promptTemplateAdded:"prompt-template.added",promptTemplateUpdated:"prompt-template.updated",promptTemplateDeleted:"prompt-template.deleted",loadPromptTemplatesRequest:"prompt-template.load.request",addPromptTemplateRequest:"prompt-template.add.request",updatePromptTemplateRequest:"prompt-template.update.request",deletePromptTemplateRequest:"prompt-template.delete.request",selectPromptTemplateRequest:"prompt-template.select.request",compilePromptTemplateRequest:"prompt-template.compile.request"};function KT(e,t){if(e==null)return e;switch(t){case"number":const n=parseFloat(e);return isNaN(n)?void 0:n;case"boolean":return String(e).toLowerCase()==="true";case"array":if(Array.isArray(e))return e;try{const r=JSON.parse(e);return Array.isArray(r)?r:[String(e)]}catch{return String(e).split(",").map(r=>r.trim())}case"string":default:return String(e)}}function S7e(e,t){return e.replace(/\{\{\s*([\w_.-]+)\s*\}\}/g,(n,r)=>{const s=t[r];return s==null?n:Array.isArray(s)?s.map(i=>i===null?"null":typeof i=="object"?JSON.stringify(i):String(i)).join(", "):typeof s=="object"?JSON.stringify(s):String(s)})}async function t6(e,t){const n=e.variables||[],r={...t};for(const o of n){let l=r[o.name];if(l==null&&o.default!==void 0&&(l=KT(o.default,o.type),r[o.name]=l),o.required){if(l==null||l==="")throw new Error(`Required variable "${o.name}" is missing or empty.`);if(Array.isArray(l)&&l.length===0)throw new Error(`Required variable "${o.name}" cannot be an empty array.`)}}const s=S7e(e.prompt,r),i=e.tools||[],a=e.rules||[];return{content:s,selectedTools:i,selectedRules:a}}const gl=Co(ko((e,t)=>({promptTemplates:[],loading:!1,error:null,loadPromptTemplates:async()=>{e(n=>{n.loading=!0,n.error=null});try{const n=await yt.loadPromptTemplates();e(r=>{r.promptTemplates=n,r.loading=!1}),Ce.emit(Aa.promptTemplatesChanged,{promptTemplates:n})}catch(n){const r=n instanceof Error?n.message:"Failed to load prompt templates";e(s=>{s.error=r,s.loading=!1}),ke.error(r)}},addPromptTemplate:async n=>{const r={id:Nr(),createdAt:new Date,updatedAt:new Date,...n};e(s=>{s.promptTemplates.push(r)});try{return await yt.savePromptTemplate(r),Ce.emit(Aa.promptTemplateAdded,{promptTemplate:r}),ke.success("Prompt template created successfully"),r.id}catch(s){e(a=>{a.promptTemplates=a.promptTemplates.filter(o=>o.id!==r.id)});const i=s instanceof Error?s.message:"Failed to create prompt template";throw e(a=>{a.error=i}),ke.error(i),s}},updatePromptTemplate:async(n,r)=>{const s=t().promptTemplates.find(a=>a.id===n);if(!s){ke.error("Prompt template not found");return}const i={...s,...r,updatedAt:new Date};e(a=>{const o=a.promptTemplates.findIndex(l=>l.id===n);o!==-1&&(a.promptTemplates[o]=i)});try{await yt.savePromptTemplate(i),Ce.emit(Aa.promptTemplateUpdated,{promptTemplate:i}),ke.success("Prompt template updated successfully")}catch(a){e(l=>{const c=l.promptTemplates.findIndex(u=>u.id===n);c!==-1&&(l.promptTemplates[c]=s)});const o=a instanceof Error?a.message:"Failed to update prompt template";throw e(l=>{l.error=o}),ke.error(o),a}},deletePromptTemplate:async n=>{const r=t().promptTemplates.find(s=>s.id===n);if(!r){ke.error("Prompt template not found");return}e(s=>{s.promptTemplates=s.promptTemplates.filter(i=>i.id!==n)});try{await yt.deletePromptTemplate(n),Ce.emit(Aa.promptTemplateDeleted,{id:n}),ke.success("Prompt template deleted successfully")}catch(s){e(a=>{a.promptTemplates.push(r)});const i=s instanceof Error?s.message:"Failed to delete prompt template";throw e(a=>{a.error=i}),ke.error(i),s}},compilePromptTemplate:async(n,r)=>{const s=t().promptTemplates.find(i=>i.id===n);if(!s)throw new Error("Template not found");try{return await t6(s,r)}catch(i){const a=i instanceof Error?i.message:"Failed to compile prompt template";throw ke.error(a),i}},getTemplatesByType:n=>t().promptTemplates.filter(r=>(r.type||"prompt")===n),getAgents:()=>t().promptTemplates.filter(n=>(n.type||"prompt")==="agent"),getTasksForAgent:n=>t().promptTemplates.filter(r=>(r.type||"prompt")==="task"&&r.parentId===n),getAvailableFollowUps:(n,r)=>{const s=t().promptTemplates,i=s.find(a=>a.id===n);return r==="task"&&(i!=null&&i.parentId)?s.filter(a=>(a.type||"prompt")==="task"&&a.parentId===i.parentId&&a.id!==n):s.filter(a=>(a.type||"prompt")==="prompt"&&a.id!==n)},getRegisteredActionHandlers:()=>{const n=t();return[{eventName:Aa.loadPromptTemplatesRequest,handler:()=>n.loadPromptTemplates(),storeId:"promptTemplateStore"},{eventName:Aa.addPromptTemplateRequest,handler:async r=>{await n.addPromptTemplate(r.promptTemplate)},storeId:"promptTemplateStore"},{eventName:Aa.updatePromptTemplateRequest,handler:r=>n.updatePromptTemplate(r.id,r.updates),storeId:"promptTemplateStore"},{eventName:Aa.deletePromptTemplateRequest,handler:r=>n.deletePromptTemplate(r.id),storeId:"promptTemplateStore"},{eventName:Aa.compilePromptTemplateRequest,handler:async r=>{await n.compilePromptTemplate(r.templateId,r.formData)},storeId:"promptTemplateStore"}]}}))),Er={serversChanged:"mcp.servers.changed",serverAdded:"mcp.server.added",serverUpdated:"mcp.server.updated",serverDeleted:"mcp.server.deleted",serverConnectionChanged:"mcp.server.connection.changed",toolsChanged:"mcp.tools.changed",retryAttemptsChanged:"mcp.retry.attempts.changed",retryDelayChanged:"mcp.retry.delay.changed",connectionTimeoutChanged:"mcp.connection.timeout.changed",maxResponseSizeChanged:"mcp.max.response.size.changed",bridgeConfigChanged:"mcp.bridge.config.changed",beforeToolCall:"mcp.tool.before.call",afterToolCall:"mcp.tool.after.call",toolCallFailed:"mcp.tool.call.failed",beforeToolExecution:"mcp.tool.before.execution",toolDiscovered:"mcp.tool.discovered",toolRegistered:"mcp.tool.registered",toolUnregistered:"mcp.tool.unregistered",setServersRequest:"mcp.set.servers.request",addServerRequest:"mcp.add.server.request",updateServerRequest:"mcp.update.server.request",deleteServerRequest:"mcp.delete.server.request",connectServerRequest:"mcp.connect.server.request",disconnectServerRequest:"mcp.disconnect.server.request",refreshToolsRequest:"mcp.refresh.tools.request",loadMcpStateRequest:"mcp.load.state.request",resetMcpStateRequest:"mcp.reset.state.request",setRetryAttemptsRequest:"mcp.set.retry.attempts.request",setRetryDelayRequest:"mcp.set.retry.delay.request",setConnectionTimeoutRequest:"mcp.set.connection.timeout.request",setMaxResponseSizeRequest:"mcp.set.max.response.size.request"},wx=3,Sx=2e3,_x=1e4,Cx=128e3,_7e={servers:[],serverStatuses:{},loading:!1,error:null,retryAttempts:wx,retryDelay:Sx,connectionTimeout:_x,maxResponseSize:Cx,bridgeConfig:{}},pl=Co(ko((e,t)=>({..._7e,setServers:n=>{e(r=>{r.servers=n,r.error=null}),yt.saveSetting("mcpServers",n).catch(r=>{console.error("Failed to persist MCP servers:",r)}),Ce.emit(Er.serversChanged,{servers:n})},addServer:n=>{const r={...n,id:`mcp_${Date.now()}_${Math.random().toString(36).substr(2,9)}`};e(i=>{i.servers.push(r),i.error=null});const s=t().servers;yt.saveSetting("mcpServers",s).catch(i=>{console.error("Failed to persist MCP servers:",i)}),Ce.emit(Er.serverAdded,{server:r}),Ce.emit(Er.serversChanged,{servers:s})},updateServer:(n,r)=>{let s=null;if(e(i=>{const a=i.servers.findIndex(o=>o.id===n);a!==-1&&(i.servers[a]={...i.servers[a],...r},s=i.servers[a],i.error=null)}),s){const i=t().servers;yt.saveSetting("mcpServers",i).catch(a=>{console.error("Failed to persist MCP servers:",a)}),Ce.emit(Er.serverUpdated,{server:s}),Ce.emit(Er.serversChanged,{servers:i})}},deleteServer:n=>{e(s=>{s.servers=s.servers.filter(i=>i.id!==n),delete s.serverStatuses[n],s.error=null});const r=t().servers;yt.saveSetting("mcpServers",r).catch(s=>{console.error("Failed to persist MCP servers:",s)}),Ce.emit(Er.serverDeleted,{serverId:n}),Ce.emit(Er.serversChanged,{servers:r})},setServerStatus:n=>{e(r=>{r.serverStatuses[n.serverId]=n}),Ce.emit(Er.serverConnectionChanged,{serverId:n.serverId,connected:n.connected,error:n.error}),n.tools.length>0&&Ce.emit(Er.toolsChanged,{serverId:n.serverId,tools:n.tools})},clearServerStatus:n=>{e(r=>{delete r.serverStatuses[n]}),Ce.emit(Er.serverConnectionChanged,{serverId:n,connected:!1})},setRetryAttempts:n=>{const r=Math.max(0,Math.min(10,n));e(s=>{s.retryAttempts=r}),yt.saveSetting("mcpRetryAttempts",r).catch(s=>{console.error("Failed to persist MCP retry attempts:",s)}),Ce.emit(Er.retryAttemptsChanged,{attempts:r})},setRetryDelay:n=>{const r=Math.max(500,Math.min(3e4,n));e(s=>{s.retryDelay=r}),yt.saveSetting("mcpRetryDelay",r).catch(s=>{console.error("Failed to persist MCP retry delay:",s)}),Ce.emit(Er.retryDelayChanged,{delay:r})},setConnectionTimeout:n=>{const r=Math.max(1e3,Math.min(6e4,n));e(s=>{s.connectionTimeout=r}),yt.saveSetting("mcpConnectionTimeout",r).catch(s=>{console.error("Failed to persist MCP connection timeout:",s)}),Ce.emit(Er.connectionTimeoutChanged,{timeout:r})},setMaxResponseSize:n=>{const r=Math.max(1e3,Math.min(1e7,n));e(s=>{s.maxResponseSize=r}),yt.saveSetting("mcpMaxResponseSize",r).catch(s=>{console.error("Failed to persist MCP max response size:",s)}),Ce.emit(Er.maxResponseSizeChanged,{size:r})},setBridgeConfig:n=>{e(r=>{r.bridgeConfig={...n}}),yt.saveSetting("mcpBridgeConfig",n).catch(r=>{console.error("Failed to persist MCP bridge config:",r)}),Ce.emit(Er.bridgeConfigChanged,{config:n})},setLoading:n=>{e(r=>{r.loading=n})},setError:n=>{e(r=>{r.error=n})},loadMcpState:async()=>{try{e(l=>{l.loading=!0,l.error=null});const[n,r,s,i,a,o]=await Promise.all([yt.loadSetting("mcpServers",[]),yt.loadSetting("mcpRetryAttempts",wx),yt.loadSetting("mcpRetryDelay",Sx),yt.loadSetting("mcpConnectionTimeout",_x),yt.loadSetting("mcpMaxResponseSize",Cx),yt.loadSetting("mcpBridgeConfig",{})]);e(l=>{l.servers=n||[],l.retryAttempts=r,l.retryDelay=s,l.connectionTimeout=i,l.maxResponseSize=a,l.bridgeConfig=o||{},l.loading=!1}),Ce.emit(Er.serversChanged,{servers:n||[]}),Ce.emit(Er.retryAttemptsChanged,{attempts:r}),Ce.emit(Er.retryDelayChanged,{delay:s}),Ce.emit(Er.connectionTimeoutChanged,{timeout:i}),Ce.emit(Er.maxResponseSizeChanged,{size:a}),Ce.emit(Er.bridgeConfigChanged,{config:o||{}})}catch(n){console.error("Failed to load MCP state:",n),e(r=>{r.error=n.message||"Failed to load MCP state",r.loading=!1})}},resetMcpState:()=>{e(n=>{n.servers=[],n.serverStatuses={},n.retryAttempts=wx,n.retryDelay=Sx,n.connectionTimeout=_x,n.maxResponseSize=Cx,n.bridgeConfig={},n.loading=!1,n.error=null}),Promise.all([yt.saveSetting("mcpServers",[]),yt.saveSetting("mcpRetryAttempts",wx),yt.saveSetting("mcpRetryDelay",Sx),yt.saveSetting("mcpConnectionTimeout",_x),yt.saveSetting("mcpMaxResponseSize",Cx)]).catch(n=>{console.error("Failed to clear MCP settings from storage:",n)}),Ce.emit(Er.serversChanged,{servers:[]}),Ce.emit(Er.retryAttemptsChanged,{attempts:wx}),Ce.emit(Er.retryDelayChanged,{delay:Sx}),Ce.emit(Er.connectionTimeoutChanged,{timeout:_x}),Ce.emit(Er.maxResponseSizeChanged,{size:Cx})},getRegisteredActionHandlers:()=>{const n=t();return[{eventName:Er.setServersRequest,handler:r=>n.setServers(r.servers),storeId:"mcpStore"},{eventName:Er.addServerRequest,handler:r=>n.addServer(r.server),storeId:"mcpStore"},{eventName:Er.updateServerRequest,handler:r=>n.updateServer(r.id,r.updates),storeId:"mcpStore"},{eventName:Er.deleteServerRequest,handler:r=>n.deleteServer(r.id),storeId:"mcpStore"},{eventName:Er.setRetryAttemptsRequest,handler:r=>n.setRetryAttempts(r.attempts),storeId:"mcpStore"},{eventName:Er.setRetryDelayRequest,handler:r=>n.setRetryDelay(r.delay),storeId:"mcpStore"},{eventName:Er.setConnectionTimeoutRequest,handler:r=>n.setConnectionTimeout(r.timeout),storeId:"mcpStore"},{eventName:Er.setMaxResponseSizeRequest,handler:r=>n.setMaxResponseSize(r.size),storeId:"mcpStore"},{eventName:Er.loadMcpStateRequest,handler:()=>n.loadMcpState(),storeId:"mcpStore"},{eventName:Er.resetMcpStateRequest,handler:()=>n.resetMcpState(),storeId:"mcpStore"}]},exportProxyConfig:()=>t().servers.map(r=>({id:r.id,name:r.name,url:r.url,enabled:r.enabled}))}))),C7e=[pr,Gn,mre,jn,Va,nn,Ph,co,Yh,s1,ti,Bi,gl,pl,H0];class gre{static initialize(){if(this.isInitialized){console.warn("[Coordinator] Already initialized. Skipping re-initialization.");return}console.log("[Coordinator] Initializing dynamic event listeners for action requests...");const t=[];C7e.forEach(n=>{const r=n.getState();if(r&&typeof r.getRegisteredActionHandlers=="function")try{const s=r.getRegisteredActionHandlers();Array.isArray(s)?t.push(...s):console.warn(`[Coordinator] getRegisteredActionHandlers for store did not return an array. Store ID: ${r.id||"Unknown"}`)}catch(s){console.error("[Coordinator] Error calling getRegisteredActionHandlers for a store:",s)}}),t.length===0?console.warn("[Coordinator] No action handlers were registered by any store."):t.forEach(n=>{n&&n.eventName&&typeof n.handler=="function"?Ce.on(n.eventName,n.handler):console.error("[Coordinator] Invalid action handler structure encountered:",n)}),this.isInitialized=!0,console.log(`[Coordinator] Dynamic event listeners initialized. Total handlers: ${t.length}.`)}}ce(gre,"isInitialized",!1);const k7e=()=>{const[e,t]=E.useState({}),n=Bi(r=>r.modalProviders);return E.useEffect(()=>{const r=i=>{t(a=>({...a,[i.modalId]:{...i,isOpen:!0}})),Ce.emit(Tr.modalStateChanged,{...i,isOpen:!0})},s=i=>{t(a=>{const o={...a};return o[i.modalId]&&(o[i.modalId].isOpen=!1),o}),Ce.emit(Tr.modalStateChanged,{modalId:i.modalId,isOpen:!1})};return Ce.on(Tr.openModalRequest,r),Ce.on(Tr.closeModalRequest,s),()=>{Ce.off(Tr.openModalRequest,r),Ce.off(Tr.closeModalRequest,s)}},[]),f.jsx(f.Fragment,{children:Object.entries(e).map(([r,s])=>{if(!s.isOpen)return null;const i=n[r];if(!i)return console.warn(`[ModalManager] No provider for modalId: ${r}`),null;const a={isOpen:!0,onClose:()=>Ce.emit(Tr.closeModalRequest,{modalId:r}),modalProps:s.modalProps,targetId:s.targetId,initialTab:s.initialTab,initialSubTab:s.initialSubTab};return f.jsx(i,{...a},r)})})},Hi={isInitialized:!1,activeWorkflowConfig:null,initialize:()=>{Hi.isInitialized||(Ce.on(ws.startRequest,Hi.handleWorkflowStartRequest),Ce.on(xn.completed,Hi.handleInteractionCompleted),Ce.on(ws.stepCompleted,Hi.handleStepCompleted),Ce.on(ws.resumeRequest,Hi.handleWorkflowResumeRequest),Hi.isInitialized=!0,console.log("[WorkflowService] Initialized - workflows start immediately on request."))},_resolveJsonPath:(e,t)=>{t.startsWith("$.")&&(t=t.substring(2));try{return t.split(".").reduce((n,r)=>{var s;if(n!=null){if(r.includes("[")&&r.includes("]")){const[i,a]=r.split("["),o=parseInt(a.replace("]",""));return(s=n[i])==null?void 0:s[o]}return n[r]}},e)}catch(n){console.warn(`[WorkflowService] JSONPath resolution failed for ${t}:`,n);return}},_compileStepPrompt:async(e,t,n)=>{if(!e.templateId)throw new Error(`Step ${e.name} has no templateId specified`);const{promptTemplates:r}=gl.getState(),s=r.find(l=>l.id===e.templateId);if(!s)throw new Error(`Template ${e.templateId} not found for step ${e.name}`);const i=n===0?"trigger":`step${n-1}`,o=t[i]||{};return console.log(`[WorkflowService] Compiling template "${s.name}" for step "${e.name}" with data:`,o),await t6(s,o)},_parseStepOutput:(e,t)=>{var n,r;if(!t.structuredOutput)return e.response||"No output";if((r=(n=e.metadata)==null?void 0:n.toolCalls)!=null&&r.length)try{const s=JSON.parse(e.metadata.toolCalls[0]);if(s.toolName==="structured_output"||s.name==="structured_output")return s.arguments||s.args}catch{}try{const s=/```json\s*([\s\S]*?)\s*```/,i=(e.response??"").match(s);return i!=null&&i[1]?JSON.parse(i[1]):JSON.parse(e.response??"{}")}catch{throw new Error("Could not parse structured output from response")}},handleWorkflowStartRequest:async e=>{var a,o;console.log("[WorkflowService] Workflow start request received",e);const{template:t,initialPrompt:n,conversationId:r}=e;if(!r)return;console.log("[WorkflowService] Template details:",{name:t.name,stepsCount:((a=t.steps)==null?void 0:a.length)||0,steps:((o=t.steps)==null?void 0:o.map(l=>({id:l.id,name:l.name,type:l.type,templateId:l.templateId})))||[]}),console.log("[WorkflowService] Starting workflow immediately with initial prompt");const s={id:Nr(),content:n,parameters:{},metadata:{modelId:co.getState().modelId||void 0}},{promptObject:i}=await Hi.buildCompletePromptObject(r,n,s);await Hi.handleWorkflowConversion(i,r,{template:t,initialPrompt:n,conversationId:r})},handleWorkflowConversion:async(e,t,n)=>{var r;try{const{template:s}=n;if(!s.steps||s.steps.length===0)throw new Error("Workflow template has no steps");const i=nn.getState(),a=e.messages[e.messages.length-1];if(!a||a.role!=="user")throw new Error("Could not find user message in prompt");let o="";typeof a.content=="string"?o=a.content:Array.isArray(a.content)&&(o=a.content.filter(b=>b.type==="text").map(b=>b.text).join(""));const l={id:"",content:o,parameters:e.parameters||{},metadata:{...e.metadata,modelId:((r=e.metadata)==null?void 0:r.modelId)||""}},c=Nr(),u=Nr(),h=i.interactions.filter(b=>b.conversationId===t).reduce((b,v)=>Math.max(b,v.index),-1)+1,m={id:c,conversationId:t,type:"message.user_assistant",prompt:{id:c,content:o,parameters:{},metadata:{isWorkflowRun:!0,workflowName:s.name,workflowTemplateId:s.id,workflowRunId:u}},response:null,status:"STREAMING",startedAt:new Date,endedAt:null,metadata:{isWorkflowRun:!0,workflowName:s.name,workflowTemplateId:s.id,workflowRunId:u,toolCalls:[],toolResults:[]},index:h,parentId:null};i._addInteractionToState(m),i._addStreamingId(m.id),i.setActiveStreamBuffer(m.id,`🚀 **${s.name}**

Workflow starting with ${s.steps.length} step${s.steps.length>1?"s":""}...`),await yt.saveInteraction(m),Ce.emit(xn.added,{interaction:m}),Ce.emit(xn.started,{interactionId:m.id,conversationId:m.conversationId,type:m.type});const y={runId:u,conversationId:t,mainInteractionId:c,template:s,status:"RUNNING",currentStepIndex:-1,stepOutputs:{},startedAt:new Date().toISOString()};await Hi.createTriggerStep(m,y,l),Ce.emit(ws.started,{run:y})}catch(s){console.error("[WorkflowService] Error during workflow conversion:",s)}},createTriggerStep:async(e,t,n)=>{try{const r=t.template.steps[0],s={...n.parameters};if(r!=null&&r.templateId){const{promptTemplates:l}=gl.getState(),c=l.find(u=>u.id===r.templateId);if(c&&c.variables&&c.variables.length>0){const{schema:u}=Hi._createStructuredOutputSchema(c.variables);s.structured_output=u,console.log(`[WorkflowService] Trigger step will output structured data for step "${r.name}" variables:`,c.variables.map(d=>d.name))}}else r!=null&&r.structuredOutput&&(s.structured_output=r.structuredOutput.jsonSchema,console.log(`[WorkflowService] Trigger step will output structured data for next step: ${r.name}`));const i={...n,id:Nr(),parameters:s,metadata:{...n.metadata,isWorkflowStep:!0,workflowRunId:t.runId,workflowStepId:"trigger",workflowMainInteractionId:e.id,workflowTab:!0,workflowStepIndex:0}};if(r!=null&&r.templateId&&s.structured_output){const l=jn.getState(),c=Va.getState(),u=l.getConversationById(t.conversationId),d=(u==null?void 0:u.projectId)??null,m=c.getEffectiveProjectSettings(d).systemPrompt||"You are a helpful AI assistant.",{promptTemplates:y}=gl.getState(),b=y.find(v=>v.id===r.templateId);if(b&&b.variables&&b.variables.length>0){const{specification:v}=Hi._createStructuredOutputSchema(b.variables);i.metadata.turnSystemPrompt=`${m}

You are part of a workflow system. ${v}`}else i.metadata.turnSystemPrompt=`${m}

You are part of a workflow system. You ABSOLUTELY MUST respect the following output format when answering to not break the workflow:

${JSON.stringify(s.structured_output,null,2)}`}console.log(`[WorkflowService] Creating trigger step as child tab for run ${t.runId}`);const{promptObject:a}=await Hi.buildCompletePromptObject(t.conversationId,n.content,i),o=await bl.startInteraction(a,t.conversationId,i,"message.user_assistant");if(o){const l={parentId:e.id,index:0};nn.getState()._updateInteractionInState(o.id,l),await yt.saveInteraction({...o,...l}),console.log(`[WorkflowService] Trigger step created as child ${o.id} of main ${e.id}`)}}catch(r){console.error("[WorkflowService] Error creating trigger step:",r)}},createWorkflowStep:async(e,t)=>{var n,r,s,i;try{const a=e.template.steps[t];if(!a)throw new Error(`Step at index ${t} not found`);const o=a.name||`Step ${t+1}`;console.log(`[WorkflowService] Creating step "${o}" as child tab for run ${e.runId}`);const l=nn.getState();if(l.appendStreamBuffer(e.mainInteractionId,`

---
▶️ **Executing: ${o}**`),a.type==="human-in-the-loop"){l.appendStreamBuffer(e.mainInteractionId,`
⏸️ **Paused:** ${a.instructionsForHuman||"Requires human input."}`),l._updateInteractionInState(e.mainInteractionId,{status:"AWAITING_INPUT"}),l._removeStreamingId(e.mainInteractionId),Ce.emit(ws.paused,{runId:e.runId,step:a,pauseReason:"human-in-the-loop",dataForReview:e.stepOutputs});return}const c=await Hi._compileStepPrompt(a,e.stepOutputs,t),u=a.modelId??co.getState().modelId;if(!u)throw new Error(`Could not determine a valid AI model ID for step "${o}".`);console.log(`[WorkflowService] Step "${o}" configuration:`,{modelId:u,hasStructuredOutput:!!a.structuredOutput,structuredOutputSchema:(n=a.structuredOutput)==null?void 0:n.schema,enabledTools:((r=c.selectedTools)==null?void 0:r.length)||0,selectedRules:((s=c.selectedRules)==null?void 0:s.length)||0});const d=t+1,h=e.template.steps[d],m={};if(h!=null&&h.templateId){const{promptTemplates:x}=gl.getState(),w=x.find(_=>_.id===h.templateId);if(w&&w.variables&&w.variables.length>0){const{schema:_,specification:k}=Hi._createStructuredOutputSchema(w.variables);m.structured_output=_,console.log(`[WorkflowService] Step "${o}" will output structured data for next step "${h.name}" variables:`,w.variables.map(C=>C.name)),m.outputSpecification=k}}else h!=null&&h.structuredOutput&&(m.structured_output=h.structuredOutput.jsonSchema,console.log(`[WorkflowService] Step "${o}" will output structured data for next step: ${h.name}`));const y={id:Nr(),content:c.content,parameters:m,metadata:{isWorkflowStep:!0,workflowRunId:e.runId,workflowStepId:a.id,workflowMainInteractionId:e.mainInteractionId,workflowTab:!0,workflowStepIndex:t+1,modelId:u,enabledTools:c.selectedTools,effectiveRulesContent:(i=c.selectedRules)==null?void 0:i.map(x=>({sourceRuleId:x,content:"/* Rule content will be resolved */",type:"before"}))}};if(m.structured_output){const{promptTemplates:x}=gl.getState(),w=x.find(_=>_.id===a.templateId);if(w){const _=jn.getState(),k=Va.getState(),C=_.getConversationById(e.conversationId),T=(C==null?void 0:C.projectId)??null,N=k.getEffectiveProjectSettings(T).systemPrompt||"You are a helpful AI assistant.",I=w.prompt||"",j=I?`${N}

${I}`:N;m.outputSpecification?y.metadata.turnSystemPrompt=`${j}

You are part of a workflow system. ${m.outputSpecification}`:y.metadata.turnSystemPrompt=`${j}

You are part of a workflow system. You ABSOLUTELY MUST respect the following output format when answering to not break the workflow:

${JSON.stringify(m.structured_output,null,2)}`}}const{promptObject:b}=await Hi.buildCompletePromptObject(e.conversationId,c.content,y),v=await bl.startInteraction(b,e.conversationId,y,"message.assistant_regen");if(v){const x={parentId:e.mainInteractionId,index:t+1};l._updateInteractionInState(v.id,x),await yt.saveInteraction({...v,...x}),console.log(`[WorkflowService] Step "${o}" created as child ${v.id} of main ${e.mainInteractionId}`)}}catch(a){console.error(`[WorkflowService] Error creating step ${t}:`,a);const o=a instanceof Error?a.message:String(a),l=nn.getState(),c={response:`❌ **Workflow Error**

Failed to create step ${t+1}: ${o}`,status:"ERROR",endedAt:new Date};l._updateInteractionInState(e.mainInteractionId,c),l._removeStreamingId(e.mainInteractionId);const u=l.interactions.find(d=>d.id===e.mainInteractionId);u&&yt.saveInteraction({...u,...c}).catch(console.error),Ce.emit(ws.error,{runId:e.runId,error:o})}},handleInteractionCompleted:e=>{var n;const{interaction:t}=e;!((n=t==null?void 0:t.metadata)!=null&&n.isWorkflowStep)||!t.metadata.workflowRunId||setTimeout(()=>{const{workflowRunId:r,workflowStepId:s}=t.metadata;console.log(`[WorkflowService] Step completed for run: ${r}, step: ${s}, status: ${e.status}`);const i=H0.getState().activeRun;if(!i||i.runId!==r){console.warn(`[WorkflowService] Mismatched or no active run for ${r}`);return}if(e.status==="ERROR"||e.status==="CANCELLED"){const c=`Step failed with status ${e.status}. ${t.response||""}`;console.error(`[WorkflowService] Step error for run ${i.runId}:`,c),nn.getState().appendStreamBuffer(i.mainInteractionId,`
❌ **Error:** ${c}`),Ce.emit(ws.error,{runId:i.runId,error:c});return}if(s==="trigger"){let c;try{const u={structuredOutput:{jsonSchema:{}}};c=Hi._parseStepOutput(t,u)}catch(u){console.warn("[WorkflowService] Trigger step structured output parsing failed:",u),c=t.response??"No output"}nn.getState().appendStreamBuffer(i.mainInteractionId,`
✔️ **Finished: Initial User Prompt**`),Ce.emit(ws.stepCompleted,{runId:i.runId,stepId:"trigger",output:c});return}const a=i.template.steps.find(c=>c.id===s);if(!a){console.error(`[WorkflowService] Could not find step ${s} in template`);return}let o;try{o=Hi._parseStepOutput(t,a)}catch{Ce.emit(ws.paused,{runId:i.runId,step:a,pauseReason:"data-correction",rawAssistantResponse:t.response});return}const l=a.name||"Unnamed Step";nn.getState().appendStreamBuffer(i.mainInteractionId,`
✔️ **Finished: ${l}**`),Ce.emit(ws.stepCompleted,{runId:i.runId,stepId:s,output:o})},100)},handleStepCompleted:e=>{const{runId:t,stepId:n}=e;setTimeout(()=>{var s;const r=H0.getState().activeRun;if(!r||r.runId!==t||r.status!=="RUNNING"){console.log("[WorkflowService] Step completion ignored - no active run or status changed");return}if(console.log(`[WorkflowService] Step completed: ${n}, currentStepIndex: ${r.currentStepIndex}, totalSteps: ${r.template.steps.length}`),r.currentStepIndex>=r.template.steps.length){const i=nn.getState(),a=i.interactions.find(d=>d.id===r.mainInteractionId),o=((s=a==null?void 0:a.prompt)==null?void 0:s.content)||"No input";let l=`# ${r.template.name}

`;l+=`**Original Input:** ${o}

`,l+=`---

`,Object.entries(r.stepOutputs).forEach(([d,h],m)=>{var y;if(d==="trigger")l+=`## Initial Processing

`;else{const b=m-1,v=((y=r.template.steps[b])==null?void 0:y.name)||`Step ${b+1}`;l+=`## ${v}

`}typeof h=="object"&&h!==null?Object.entries(h).forEach(([b,v])=>{l+=`**${b}:** ${v}

`}):l+=`${h}

`,l+=`---

`}),l+="✅ **Workflow completed successfully**";const c={response:l,status:"COMPLETED",endedAt:new Date};i._updateInteractionInState(r.mainInteractionId,c),i._removeStreamingId(r.mainInteractionId);const u=i.interactions.find(d=>d.id===r.mainInteractionId);u&&yt.saveInteraction({...u,...c}).catch(console.error),Ce.emit(ws.completed,{runId:r.runId,finalOutput:r.stepOutputs}),console.log(`[WorkflowService] Workflow completed: ${t}`);return}console.log(`[WorkflowService] Creating current step ${r.currentStepIndex} for run ${t}`),Hi.createWorkflowStep(r,r.currentStepIndex)},0)},handleWorkflowResumeRequest:async e=>{console.log("[WorkflowService] Workflow resume request received",e);const{runId:t,resumeData:n}=e,r=H0.getState().activeRun;if(!r||r.runId!==t){console.warn(`[WorkflowService] Cannot resume run ${t}, not active`);return}const s=r.template.steps[r.currentStepIndex];if(!s){console.error(`[WorkflowService] Cannot resume, no step at index ${r.currentStepIndex}`);return}Ce.emit(ws.stepCompleted,{runId:r.runId,stepId:s.id,output:n})},async buildCompletePromptObject(e,t,n){const r=nn.getState(),s=Va.getState(),i=co.getState(),a=jn.getState(),o=Bi.getState(),l=a.getConversationById(e),c=(l==null?void 0:l.projectId)??null,u=s.getEffectiveProjectSettings(c),d=Object.values(o.promptControls);let h={},m={...n.metadata};for(const I of d){if(I.getParameters){const j=await I.getParameters();j&&(h={...h,...j})}if(I.getMetadata){const j=await I.getMetadata();j&&(m={...m,...j})}}const b=r.interactions.filter(I=>I.conversationId===e&&I.parentId===null&&I.status==="COMPLETED").sort((I,j)=>I.index-j.index).map(I=>{var j;if(I.type==="message.assistant_regen"&&((j=I.metadata)!=null&&j.regeneratedFromId)){const L=r.interactions.find(D=>D.id===I.metadata.regeneratedFromId);if(L&&L.prompt&&L.type==="message.user_assistant")return{...I,prompt:L.prompt,type:"message.user_assistant"}}return I.type==="message.user_assistant"&&I.prompt?I:null}).filter(Boolean),v=Ox(b);v.push({role:"user",content:t});let w=(m==null?void 0:m.turnSystemPrompt)??u.systemPrompt??void 0;const k=((m==null?void 0:m.effectiveRulesContent)??[]).filter(I=>I.type==="system").map(I=>I.content);k.length>0&&(w=`${w?`${w}

`:""}${k.join(`
`)}`);const C={temperature:i.temperature,max_tokens:i.maxTokens,top_p:i.topP,top_k:i.topK,presence_penalty:i.presencePenalty,frequency_penalty:i.frequencyPenalty,...h,...n.parameters??{}};console.log("[WorkflowService] Building prompt parameters:",{promptStateParams:{temperature:i.temperature,max_tokens:i.maxTokens},controlParams:h,baseTurnParams:n.parameters,finalParams:C}),Object.keys(C).forEach(I=>{(C[I]===null||C[I]===void 0)&&delete C[I]});const T={...m,modelId:m.modelId||i.modelId||void 0},A={...n,content:t,parameters:C,metadata:T};return{promptObject:{system:w,messages:v,parameters:C,metadata:T},turnData:A}},_createStructuredOutputSchema:e=>{const t={type:"object",properties:{},required:[],additionalProperties:!1};e.forEach(s=>{t.properties[s.name]={type:s.type==="number"?"number":"string",description:s.description||`The ${s.name} value`},s.required&&t.required.push(s.name)});const n=e.reduce((s,i)=>{const a=i.type==="number"?42:`"your ${i.name} here"`;return s[i.name]=a,s},{}),r=`You must respond with a JSON object containing the actual values (not schema definitions). 

Expected format:
${JSON.stringify(n,null,2)}

Required fields: ${t.required.join(", ")}
${e.map(s=>`- ${s.name}: ${s.description||`The ${s.name} value`}`).join(`
`)}

IMPORTANT: Provide the actual values, not schema definitions with "type" and "description" fields.
IMPORTANT: Keep your response as they would be in normal condition you can use all of LiteChat capabilities, do not shorten or simplify the response but make sure to provide a valid json output.`;return{schema:t,specification:r}}};let zq=[],Uq=null,Id=!1;const E7e=({controls:e=[]})=>{const[t,n]=E.useState(!0),[r,s]=E.useState(!1),i=E.useRef(null),a=E.useRef(null),{selectedItemId:o,selectedItemType:l,getConversationById:c}=jn(mn(I=>({selectedItemId:I.selectedItemId,selectedItemType:I.selectedItemType,getConversationById:I.getConversationById}))),{getEffectiveProjectSettings:u}=Va(mn(I=>({getEffectiveProjectSettings:I.getEffectiveProjectSettings}))),{interactions:d,status:h}=nn(mn(I=>({interactions:I.interactions,status:I.status}))),{globalError:m,isSidebarCollapsed:y,isChatControlPanelOpen:b}=s1(mn(I=>({globalError:I.globalError,isSidebarCollapsed:I.isSidebarCollapsed,isChatControlPanelOpen:I.isChatControlPanelOpen}))),v=Bi(mn(I=>Object.values(I.chatControls))),x=E.useMemo(()=>v.filter(I=>(I.panel??"main")==="sidebar"&&(I.show?I.show():!0)),[v]),w=E.useMemo(()=>v.filter(I=>I.panel==="sidebar-footer"&&(I.show?I.show():!0)),[v]),_=E.useMemo(()=>v.filter(I=>I.panel==="header"&&(I.show?I.show():!0)),[v]),k=E.useCallback(()=>{s(I=>!I)},[]);E.useEffect(()=>{r&&o&&(l==="conversation"||l==="project")&&s(!1)},[o,l]),E.useEffect(()=>{a.current||(a.current=UP({id:"core-litechat-app",name:"LiteChat App Core"}));const I=a.current;gre.initialize(),Hi.initialize(),Uq||(Uq=(async()=>{if(Id){n(!1);return}n(!0);try{zq=await w7e(e,I),Id=!0}catch(L){console.error("[LiteChat] App: Top-level initialization error:",L),Id=!1}finally{n(!1)}})().then(()=>zq))},[e]);const C=E.useRef({itemId:null,itemType:null,effectiveSettingsString:""});E.useEffect(()=>{if(t||!Id||!a.current)return;const I=a.current,j={itemId:o,itemType:l};let L=null;if(l==="project")L=o;else if(l==="conversation"&&o){const O=c(o);L=(O==null?void 0:O.projectId)??null}const D=u(L),H=JSON.stringify(D);(j.itemId!==C.current.itemId||j.itemType!==C.current.itemType||H!==C.current.effectiveSettingsString)&&(I.emit(an.initializePromptStateRequest,{effectiveSettings:D}),I.emit(Tr.contextChanged,{selectedItemId:o,selectedItemType:l}),C.current={...j,effectiveSettingsString:H})},[o,l,c,u,t,Id]),E.useEffect(()=>{if(t||!Id||!a.current)return;const I=a.current,j=()=>{let K=null;if(l==="project")K=o;else if(l==="conversation"&&o){const W=c(o);K=(W==null?void 0:W.projectId)??null}const U=u(K);I.emit(an.initializePromptStateRequest,{effectiveSettings:U})},L=I.on(on.loaded,j),D=I.on(Ta.updated,j),H=I.on(on.globalSystemPromptChanged,j),O=I.on(on.temperatureChanged,j);return()=>{L(),D(),H(),O()}},[o,l,c,u,t,Id]),E.useEffect(()=>{if(t||!Id||!a.current)return;const I=a.current;let j=null;if(b["core-vfs-modal-panel"]||l==="project")if(l==="project")j=o;else if(l==="conversation"){const H=c(o);j=(H==null?void 0:H.projectId)??"orphan"}else j="orphan";else if(l==="conversation"){const H=c(o);j=(H==null?void 0:H.projectId)??"orphan"}let D=null;typeof j=="string"?D=j:j===null?D=null:(console.warn(`[LiteChatVFS] Calculated VFS key was not a string or null. Type: ${typeof j}, Value:`,j,"Defaulting to 'orphan'."),D="orphan"),ti.getState().vfsKey!==D&&I.emit(hn.setVfsKeyRequest,{key:D})},[o,l,c,t,Id,b]);const T=async I=>{const j=jn.getState(),L=await j.addConversation(I);return console.log("New conversation ID:",L),await j.selectItem(L,"conversation"),console.log("conv selected:",L),L},A=E.useCallback(async I=>{var H;if(!a.current){ke.error("Application core not ready. Please try again.");return}const j=jn.getState();let L=j.selectedItemType==="conversation"?j.selectedItemId:null;const D=j.selectedItemType==="project"?j.selectedItemId:j.selectedItemType==="conversation"?((H=j.getConversationById(j.selectedItemId))==null?void 0:H.projectId)??null:null;if(!L)try{L=await T({title:"New Chat",projectId:D}),console.log("New conversation ID 2:",L)}catch(O){console.error("[LiteChat] App: Failed to create new conversation",O),ke.error("Failed to start new chat.");return}try{const O=co.getState(),K={...I,metadata:{...I.metadata,modelId:O.modelId}};await xh.submitPrompt(K)}catch(O){console.error("[LiteChat] App: Error submitting prompt:",O),ke.error("Failed to send message.")}},[]),N=l==="conversation"?o:null;return t?f.jsx("div",{className:"flex items-center justify-center h-screen w-screen bg-background text-foreground",children:f.jsxs("div",{className:"flex flex-col items-center gap-4",children:[f.jsx(Hn,{className:"h-12 w-12 animate-spin text-primary"}),f.jsx("p",{className:"text-lg text-muted-foreground",children:"Initializing LiteChat..."})]})}):f.jsxs(f.Fragment,{children:[f.jsx(k7e,{}),f.jsxs("div",{className:"flex h-full w-full border border-border rounded-lg overflow-hidden bg-background text-foreground",children:[f.jsxs("div",{className:Ye("hidden md:flex flex-col border-r border-border bg-card","transition-[width] duration-300 ease-in-out","flex-shrink-0 overflow-hidden",y?"w-16":"w-64"),children:[f.jsxs("div",{className:"flex-grow overflow-y-auto overflow-x-hidden",children:[f.jsx("div",{className:Ye(y?"hidden":"block"),children:f.jsx(b0,{controls:x,panelId:"sidebar",renderMode:"full",className:"h-full"})}),f.jsx("div",{className:Ye(y?"block":"hidden"),children:f.jsx(b0,{controls:x,panelId:"sidebar",renderMode:"icon",className:"flex flex-col items-center gap-2 p-2"})})]}),f.jsx("div",{className:Ye("flex-shrink-0 border-t border-border p-2",y?"flex flex-col items-center gap-2":"flex items-center justify-center"),children:f.jsx(b0,{controls:w,panelId:"sidebar-footer",renderMode:y?"icon":"full",className:Ye("flex",y?"flex-col gap-2 items-center":"items-center gap-1 justify-center")})})]}),r&&f.jsxs("div",{className:"md:hidden fixed inset-0 z-[var(--z-sidebar)] flex",children:[f.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm animate-fadeIn",onClick:k}),f.jsxs("div",{className:"relative w-4/5 max-w-sm bg-card border-r border-border h-full flex flex-col animate-slideInFromLeft shadow-2xl",children:[f.jsxs("div",{className:"sticky top-0 z-[var(--z-sticky)] flex justify-between items-center p-4 border-b border-border bg-card",children:[f.jsx("h2",{className:"font-semibold text-card-foreground",children:"LiteChat Menu"}),f.jsx("button",{onClick:k,className:"p-2 rounded-md hover:bg-muted text-card-foreground touch-manipulation","aria-label":"Close menu",style:{minHeight:"44px",minWidth:"44px"},children:f.jsx(Si,{className:"h-5 w-5"})})]}),f.jsx("div",{className:"flex-grow overflow-y-auto overflow-x-hidden bg-card",children:x.length>0?f.jsx(b0,{controls:x,panelId:"sidebar",renderMode:"full",className:"h-full"}):f.jsxs("div",{className:"p-4 text-center text-muted-foreground",children:[f.jsx("p",{className:"text-sm",children:"Loading menu..."}),f.jsx("p",{className:"text-xs mt-2",children:"Please wait while the application initializes."})]})}),f.jsx("div",{className:"flex-shrink-0 border-t border-border p-4 bg-card",children:w.length>0?f.jsx(b0,{controls:w,panelId:"sidebar-footer",renderMode:"full",className:"flex items-center justify-between"}):f.jsx("div",{className:"text-center text-muted-foreground text-xs",children:"Footer controls loading..."})})]})]}),f.jsxs("div",{className:"flex flex-col flex-grow min-w-0",children:[f.jsxs("div",{className:"flex items-center justify-between p-2 border-b border-border bg-card flex-shrink-0",children:[f.jsx("button",{className:Ye("md:hidden p-3 rounded-md hover:bg-muted active:bg-muted/80 transition-colors touch-manipulation",r&&"bg-muted"),onClick:k,"aria-label":r?"Close menu":"Open menu",style:{minHeight:"44px",minWidth:"44px"},children:r?f.jsx(Si,{className:"h-6 w-6"}):f.jsx(Ege,{className:"h-6 w-6"})}),f.jsx(b0,{controls:_,panelId:"header",className:"flex items-center justify-end gap-1 flex-grow"})]}),f.jsx(o7e,{conversationId:N,interactions:d,status:h,className:"flex-grow overflow-y-hidden"}),m&&f.jsxs("div",{className:"p-2 bg-destructive text-destructive-foreground text-sm text-center",children:["Error: ",m]}),f.jsx(Kxe,{InputAreaRenderer:hre,onSubmit:A,className:"border-t border-border bg-card flex-shrink-0",inputAreaRef:i,selectedItemId:o,selectedItemType:l})]})]}),f.jsx(f7e,{richColors:!0,position:"bottom-right",closeButton:!0})]})},T7e="prism-theme-link",A7e="prism-default-light-theme-link",R7e="prism-default-dark-theme-link",N7e="https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-material-light.min.css",I7e="https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-vsc-dark-plus.min.css",bj=e=>{let t=document.getElementById(e);return t||(t=document.createElement("link"),t.id=e,t.rel="stylesheet",document.head.appendChild(t)),t},M7e=()=>{const{prismThemeUrl:e,theme:t}=pr(mn(s=>({prismThemeUrl:s.prismThemeUrl,theme:s.theme}))),n=E.useMemo(()=>typeof window>"u"?"light":window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light",[]),r=E.useMemo(()=>{const s=t==="system"?n:t;return s==="dark"||s==="TijuDark"?"dark":"light"},[t,n]);return E.useEffect(()=>{if(typeof window>"u")return;const s=bj(A7e),i=bj(R7e),a=bj(T7e);return s.disabled=!0,i.disabled=!0,a.disabled=!0,s.href=N7e,i.href=I7e,e?(a.href=e,a.disabled=!1):r==="dark"?i.disabled=!1:s.disabled=!1,()=>{}},[e,r]),null},vj=e=>e.replace(/([a-z0-9]|(?=[A-Z]))([A-Z])/g,"$1-$2").toLowerCase(),xj=["background","foreground","card","cardForeground","popover","popoverForeground","primary","primaryForeground","secondary","secondaryForeground","muted","mutedForeground","accent","accentForeground","destructive","destructiveForeground","border","input","ring","chart1","chart2","chart3","chart4","chart5","sidebar","sidebarForeground","sidebarPrimary","sidebarPrimaryForeground","sidebarAccent","sidebarAccentForeground","sidebarBorder","sidebarRing"],j7e=()=>{const{theme:e,customFontFamily:t,customFontSize:n,customThemeColors:r}=pr(mn(s=>({theme:s.theme,customFontFamily:s.customFontFamily,customFontSize:s.customFontSize,customThemeColors:s.customThemeColors})));return E.useEffect(()=>{const s=document.body,i=document.documentElement;s.classList.remove("light","dark","TijuLight","TijuDark","custom"),xj.forEach(a=>{i.style.removeProperty(`--${vj(a)}`)}),i.style.removeProperty("--custom-font-family"),i.style.removeProperty("--custom-font-size"),e==="light"?s.classList.add("light"):e==="dark"?s.classList.add("dark"):e==="TijuLight"?s.classList.add("TijuLight"):e==="TijuDark"?s.classList.add("TijuDark"):e==="custom"?(s.classList.add("custom"),t?i.style.setProperty("--custom-font-family",t):i.style.removeProperty("--custom-font-family"),n?i.style.setProperty("--custom-font-size",`${n}px`):i.style.removeProperty("--custom-font-size"),r&&Object.entries(r).forEach(([a,o])=>{if(o&&xj.includes(a)){const l=`--${vj(a)}`;i.style.setProperty(l,o)}else if(xj.includes(a)){const l=`--${vj(a)}`;i.style.removeProperty(l)}})):window.matchMedia("(prefers-color-scheme: dark)").matches?s.classList.add("dark"):s.classList.add("light")},[e,t,n,r]),null},P7e=e=>{const{size:t=24,color:n="currentColor",...r}=e;return f.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:t,height:t,viewBox:"0 0 512 512",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",...r,children:[f.jsx("g",{transform:"translate(0.000000,512.000000) scale(0.100000,-0.100000)",fill:n,stroke:"none",children:f.jsx("path",{d:`M2310 5053 c-1035 -101 -1883 -794 -2159 -1764 -55 -194 -79 -338
-91 -552 -18 -323 20 -620 117 -907 92 -272 238 -543 404 -747 33 -39 59 -75
59 -78 0 -4 -49 -129 -109 -279 -252 -624 -251 -621 -196 -676 57 -56 73 -53
351 58 137 55 349 143 472 195 l223 95 77 -38 c221 -109 437 -179 680 -219
132 -23 411 -44 475 -37 23 3 85 8 137 11 404 26 806 168 1180 417 282 188
571 489 759 792 400 642 467 1498 174 2216 -179 439 -495 826 -888 1088 -361
239 -743 378 -1165 422 -88 9 -419 11 -500 3z m404 -463 c-1 -30 -17 -128 -36
-217 l-34 -163 137 0 c128 0 139 -1 149 -20 11 -21 4 -44 -22 -72 -7 -7 -68
-75 -135 -150 l-123 -136 0 -175 0 -175 238 -4 c265 -5 329 -16 469 -82 220
-105 414 -311 486 -519 l24 -68 86 -4 c129 -7 195 -43 236 -130 20 -42 21 -61
21 -300 0 -240 -1 -258 -21 -297 -46 -90 -115 -127 -235 -128 l-82 0 -11 -47
c-17 -66 -71 -179 -119 -250 -108 -159 -276 -293 -452 -361 -174 -66 -251 -72
-830 -63 l-475 8 -89 27 c-303 91 -554 328 -650 614 l-23 67 -89 5 c-98 6
-131 20 -180 72 -63 66 -64 72 -64 354 0 240 1 261 21 301 40 84 105 119 232
129 l84 7 32 80 c84 215 291 424 513 519 126 53 225 68 466 68 l212 0 0 268 0
267 -126 -3 c-108 -3 -129 -1 -145 14 -10 9 -19 25 -19 35 0 9 111 146 246
304 234 273 247 286 277 283 32 -3 32 -3 31 -58z`})}),f.jsxs("g",{transform:"translate(165, 220) scale(2.5)",children:[f.jsx("path",{d:"M5 5l14 14",stroke:n,strokeWidth:"4"}),f.jsx("path",{d:"M18 5l-14 14",stroke:n,strokeWidth:"4"})]}),f.jsxs("g",{transform:"translate(290, 220) scale(2.5)",children:[f.jsx("path",{d:"M5 5l14 14",stroke:n,strokeWidth:"4"}),f.jsx("path",{d:"M18 5l-14 14",stroke:n,strokeWidth:"4"})]}),f.jsx("g",{transform:"translate(0.000000,512.000000) scale(0.100000,-0.100000)",fill:n,stroke:"none",children:f.jsx("path",{d:`M2147 1750 c-26 15 -48 65 -41 94
             15 61 181 167 304 196
             30 7 100 12 155 12
             81 -1 115 -6 178 -27
             135 -45 247 -133 249 -194
             2 -60 -48 -103 -104 -88
             -13 3 -50 25 -83 50
             -85 64 -172 90 -280 84
             -92 -6 -165 -35 -259 -103
             -49 -35 -86 -43 -119 -24z`})})]})},qq="0.1.0-dev",Vq="https://github.com/DimitriGilbert/LiteChat",Wq=({textToCopy:e,label:t,className:n})=>{const[r,s]=E.useState(!1),i=async()=>{try{await navigator.clipboard.writeText(e),s(!0),ke.success(`${t} copied to clipboard!`),setTimeout(()=>s(!1),2e3)}catch(a){ke.error(`Failed to copy ${t.toLowerCase()}.`),console.error(`Clipboard copy failed for ${t}:`,a)}};return f.jsxs(ot,{variant:"outline",onClick:i,className:n,children:[r?f.jsx(bo,{className:"mr-2 h-4 w-4 text-green-500"}):f.jsx(Rme,{className:"mr-2 h-4 w-4"}),r?"Copied!":`Copy ${t}`]})};class O7e extends E.Component{constructor(){super(...arguments);ce(this,"state",{hasError:!1,error:null,errorInfo:null});ce(this,"handleReportOnGitHub",async()=>{const n=this.generateErrorReport(!0);try{await navigator.clipboard.writeText(n),ke.success("Error report copied to clipboard. Paste it into the GitHub issue body.");const r=`${Vq}/issues/new?title=${encodeURIComponent(this.getGitHubIssueTitle())}`;window.open(r,"_blank","noopener,noreferrer")}catch(r){ke.error("Failed to copy error report. Please copy manually."),console.error("Clipboard copy failed for GitHub report:",r);const s=`${Vq}/issues/new?title=${encodeURIComponent(this.getGitHubIssueTitle())}`;window.open(s,"_blank","noopener,noreferrer")}})}static getDerivedStateFromError(n){return{hasError:!0,error:n,errorInfo:null}}componentDidCatch(n,r){console.error("Uncaught error:",n,r),this.setState({errorInfo:r})}getGitHubIssueTitle(){var i;const{error:n,errorInfo:r}=this.state;let s="Crash Report: ";if(r!=null&&r.componentStack){const a=(i=r.componentStack.trim().split(/\s+at\s+/)[1])==null?void 0:i.split(" ")[0];a&&(s+=`Error in <${a}> - `)}return s+=(n==null?void 0:n.message.substring(0,70))??"Unknown Error",n&&n.message.length>70&&(s+="..."),s}generateErrorReport(n=!1){const{error:r,errorInfo:s}=this.state,i=`
`,a=n?"```":"";let o=`## LiteChat Error Report${i}${i}`;return o+=`**Version:** ${qq}${i}`,o+=`**Timestamp:** ${new Date().toISOString()}${i}`,o+=`**User Agent:** ${typeof navigator<"u"?navigator.userAgent:"N/A"}${i}${i}`,r?o+=`**Error Message:**${i}${a}${i}${r.message}${i}${a}${i}${i}`:o+=`**Error Message:** Unknown Error${i}${i}`,s!=null&&s.componentStack&&(o+=`**Component Stack:**${i}${a}text${i}${s.componentStack.trim()}${i}${a}${i}${i}`),r!=null&&r.stack&&(o+=`**Error Stack Trace:**${i}${a}text${i}${r.stack.trim()}${i}${a}${i}${i}`),o+=`**Steps to Reproduce (Please Describe):**${i}1. ...${i}2. ...${i}${i}`,o+=`**Expected Behavior:**${i}...${i}${i}`,o+=`**Actual Behavior:**${i}...${i}`,o}generateAIPrompt(){var i,a;const{error:n,errorInfo:r}=this.state;return`I encountered an error in a React application (LiteChat v${qq}). Please help me debug it.

Error Message:
\`\`\`
${(n==null?void 0:n.message)??"Unknown Error"}
\`\`\`

Component Stack (if available):
\`\`\`
${((i=r==null?void 0:r.componentStack)==null?void 0:i.trim())??"Not available"}
\`\`\`

Error Stack Trace (if available):
\`\`\`
${((a=n==null?void 0:n.stack)==null?void 0:a.trim())??"Not available"}
\`\`\`

Based on this information, what are the likely causes and potential solutions? Focus on React-specific issues if the component stack is present.`}render(){var n;return this.state.hasError?this.props.fallback?this.props.fallback:f.jsx("div",{role:"alert",className:"flex flex-col items-center justify-center h-screen w-screen p-4 bg-background text-foreground z-[9999]",children:f.jsxs("div",{className:"max-w-2xl w-full border border-destructive bg-destructive/10 rounded-lg p-6 text-center shadow-lg",children:[f.jsx(P7e,{className:"h-24 w-24 text-destructive mx-auto mb-4"}),f.jsx("h1",{className:"text-2xl font-semibold text-destructive mb-2",children:"Oops! Something went wrong."}),f.jsx("p",{className:"text-destructive/90 mb-4",children:"LiteChat encountered an unexpected error. Please try refreshing the page. If the problem persists, consider reporting the issue. Copy the details and paste them into the GitHub issue."}),f.jsx("pre",{className:"text-left text-xs bg-destructive/10 border border-destructive/30 rounded p-3 max-h-32 overflow-auto mb-4 font-mono text-destructive/80",children:((n=this.state.error)==null?void 0:n.message)??"Unknown Error"}),f.jsxs("div",{className:"flex flex-wrap justify-center gap-2",children:[f.jsx(ot,{variant:"destructive",onClick:()=>window.location.reload(),children:"Refresh Page"}),f.jsx(Wq,{textToCopy:this.generateErrorReport(),label:"Details"}),f.jsx(Wq,{textToCopy:this.generateAIPrompt(),label:"AI Debug Prompt"}),f.jsxs(ot,{variant:"outline",onClick:this.handleReportOnGitHub,children:[f.jsx(AE,{className:"mr-2 h-4 w-4"})," Report on GitHub"]})]})]})}):this.props.children}}const yre=(e,t)=>{if(!t)return null;let n=qc,r="text-muted-foreground/70",s=`Linked to ${t}`;switch(e){case"syncing":n=Hn,r="animate-spin text-blue-500",s=`Syncing with ${t}...`;break;case"error":n=Sl,r="text-destructive",s=`Sync error with ${t}`;break;case"needs-sync":n=rO,r="text-orange-500",s=`Needs sync with ${t}`;break;case"idle":n=C1,r="text-green-500",s=`Synced with ${t}`;break;default:n=qc,r="text-muted-foreground/70",s=`Linked to ${t} (Status: ${e??"Unknown"})`;break}return f.jsx(wr,{delayDuration:100,children:f.jsxs(Sr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(n,{className:Ye("h-3 w-3 ml-1 flex-shrink-0",r)})}),f.jsx(Cr,{side:"right",children:s})]})})},bre=E.memo(({item:e,level:t,selectedItemId:n,conversationSyncStatus:r,repoNameMap:s,onSelectItem:i,onDeleteConversation:a,onDeleteProject:o,onExportConversation:l,onExportProject:c,expandedProjects:u,toggleProjectExpansion:d,editingItemId:h,editingItemType:m,handleStartEditing:y,handleSaveEdit:b,handleCancelEdit:v,isSavingEdit:x,originalNameToCompare:w})=>{const _=e.id===n,k=e.itemType==="project",C=e.id===h&&e.itemType===m,[T,A]=E.useState(k?e.name:e.title),N=E.useRef(null),[I,j]=E.useState(!1);E.useEffect(()=>{if(C){const je=k?e.name:e.title;A(je),requestAnimationFrame(()=>{var Te,_e;(Te=N.current)==null||Te.focus(),(_e=N.current)==null||_e.select()})}},[C,e,k]),E.useEffect(()=>{if(!C){const je=k?e.name:e.title;T!==je&&A(je)}},[k?e.name:e.title,C,T,k]);const L=k&&u.has(e.id),D=k,H=!k&&e.syncRepoId?r[e.id]:void 0,O=!k&&e.syncRepoId?s.get(e.syncRepoId):void 0,K=!k&&O?yre(H,O):null,U=je=>{je.stopPropagation(),Ce.emit(Tr.openModalRequest,{modalId:"projectSettingsModal",targetId:e.id})},W=()=>{C||(k&&d(e.id),i(e.id,e.itemType))},B=je=>{je.stopPropagation(),k?window.confirm(`Delete project "${e.name}" and ALL its contents (sub-projects and conversations)? This cannot be undone.`)&&o(e.id,je):a(e.id,je)},ne=je=>{je.stopPropagation(),y(e)},V=()=>{A(w),v(e.itemType==="project"&&w==="New Project")},Q=async()=>{if(x)return;const je=T.trim();await b(e.id,e.itemType,je)},ee=()=>{var _e;if(x)return;const je=T.trim(),Te=e.itemType==="project"&&w==="New Project";if(!je){w!=="New Project"?(ke.error("Name cannot be empty."),A(w),(_e=N.current)==null||_e.focus()):V();return}je!==w||Te?Q():V()},re=je=>{je.key==="Enter"?(je.preventDefault(),Q()):je.key==="Escape"&&(je.preventDefault(),V())},de=k?e.name:e.title,me=x?Hn:bo,De=x?"h-3 w-3 animate-spin":"h-3 w-3";return f.jsxs("li",{className:Ye("relative flex justify-between items-center group p-1.5 text-xs rounded","border border-transparent",!C&&"hover:bg-muted/50 hover:text-primary/80",_&&!C?"bg-primary/10 text-primary font-medium border-primary dark:bg-primary/20 dark:border-primary/70":"",C&&"bg-muted ring-1 ring-primary",!C&&"cursor-pointer"),style:{paddingLeft:`${.375+t*.75}rem`},onClick:W,title:C?"":de,children:[f.jsxs("div",{className:"flex items-center min-w-0 gap-1 flex-grow mr-1",children:[D&&f.jsx("span",{className:"flex-shrink-0 w-3 cursor-pointer p-0.5 -ml-0.5",onClick:je=>{je.stopPropagation(),d(e.id)},children:L?f.jsx(uc,{className:"h-3 w-3 text-muted-foreground"}):f.jsx(X4,{className:"h-3 w-3 text-muted-foreground"})}),!D&&f.jsx("span",{className:"w-3 flex-shrink-0"}),k?f.jsx(Ih,{className:"h-3.5 w-3.5 text-yellow-500 flex-shrink-0"}):f.jsx(u3,{className:"h-3.5 w-3.5 text-blue-400 flex-shrink-0"}),C?f.jsx(vn,{ref:N,value:T,onChange:je=>A(je.target.value),onKeyDown:re,onBlur:ee,className:"h-6 px-1 py-0 text-xs flex-grow min-w-0",onClick:je=>je.stopPropagation(),disabled:x}):f.jsx("span",{className:"truncate min-w-0 flex-1",children:de}),K]}),f.jsx("div",{className:Ye("items-center flex-shrink-0 ml-1",C||I?"flex":"hidden group-hover:flex transition-all duration-150"),onClick:je=>je.stopPropagation(),children:C?f.jsxs(f.Fragment,{children:[f.jsx(Un,{tooltipText:"Save (Enter)",onClick:je=>{je.stopPropagation(),Q()},disabled:x||!T.trim(),"aria-label":"Save changes",icon:f.jsx(me,{}),iconClassName:De,className:"h-5 w-5 text-green-500 hover:text-green-600"}),f.jsx(Un,{tooltipText:"Cancel (Esc)",onClick:je=>{je.stopPropagation(),V()},disabled:x,"aria-label":"Cancel edit",icon:f.jsx(Si,{}),className:"h-5 w-5 text-muted-foreground hover:text-foreground"})]}):f.jsxs(f.Fragment,{children:[k&&f.jsx(Un,{tooltipText:"Project Settings",onClick:U,"aria-label":`Settings for ${de}`,icon:f.jsx(kme,{}),className:"h-5 w-5 text-muted-foreground hover:text-foreground"}),f.jsx(Un,{tooltipText:"Edit",onClick:ne,"aria-label":`Edit ${de}`,icon:f.jsx(k1,{}),className:"h-5 w-5 text-muted-foreground hover:text-foreground"}),k?f.jsx(Un,{tooltipText:"Export Project (JSON)",onClick:je=>c(e.id,je),"aria-label":`Export project ${de}`,icon:f.jsx($me,{}),className:"h-5 w-5 text-muted-foreground hover:text-foreground"}):f.jsxs(gc,{open:I,onOpenChange:j,children:[f.jsx(yc,{asChild:!0,children:f.jsx(Un,{tooltipText:"Export Conversation","aria-label":`Export ${de}`,icon:f.jsx(Fc,{}),className:"h-5 w-5 text-muted-foreground hover:text-foreground"})}),f.jsx(bc,{className:"w-auto p-0.5",onClick:je=>je.stopPropagation(),children:f.jsxs("div",{className:"flex gap-0.5",children:[f.jsx(ot,{variant:"ghost",size:"sm",className:"h-5 px-1.5 text-xs",onClick:je=>{l(e.id,"json",je),j(!1)},children:"JSON"}),f.jsx(ot,{variant:"ghost",size:"sm",className:"h-5 px-1.5 text-xs",onClick:je=>{l(e.id,"md",je),j(!1)},children:"MD"})]})})]}),f.jsx(Un,{tooltipText:"Delete",onClick:B,"aria-label":`Delete ${de}`,icon:f.jsx(Vo,{}),className:"h-5 w-5 text-destructive hover:text-destructive/80"})]})})]})});bre.displayName="ConversationItemRenderer";function D7e({updateProject:e,updateConversation:t,deleteProject:n}){const[r,s]=E.useState(null),[i,a]=E.useState(null),[o,l]=E.useState(""),[c,u]=E.useState(!1),d=E.useCallback(y=>{s(y.id),a(y.itemType);const b=y.itemType==="project"?y.name:y.title;l(b),u(!1)},[]),h=E.useCallback(y=>{const b=r,v=y??(i==="project"&&o==="New Project");s(null),a(null),l(""),u(!1),v&&b&&n(b).catch(x=>{console.error("Failed to delete new project on cancel:",x),ke.error("Failed to clean up cancelled new project.")})},[r,i,o,n]),m=E.useCallback(async(y,b,v)=>{if(y!==r||b!==i||c)return;const x=v==null?void 0:v.trim();if(!x){ke.error("Name cannot be empty.");return}if(x===o&&!(b==="project"&&o==="New Project")){h();return}u(!0);try{b==="project"?await e(y,{name:x}):await t(y,{title:x}),ke.success("Item renamed successfully."),s(null),a(null),l("")}catch(_){console.error("Failed to save item name:",_),ke.error(`Failed to rename item: ${_ instanceof Error?_.message:String(_)}`)}finally{u(!1)}},[r,i,c,e,t,h,o]);return{editingItemId:r,editingItemType:i,isSavingEdit:c,handleStartEditing:d,handleSaveEdit:m,handleCancelEdit:h,originalNameToCompare:o}}const vre=(e,t,n,r,s,i,a,o,l)=>{if(!n)return!0;const c=`${t}-${e}`;if(l[c]!==void 0)return l[c];let u=!1;{const d=i.get(e);if(d)if(d.name.toLowerCase().includes(n))u=!0;else{const h=o.get(e)||[],m=a.get(e)||[];for(const y of m)if(y.title.toLowerCase().includes(n)){u=!0;break}if(!u){for(const y of h)if(vre(y.id,"project",n,r,s,i,a,o,l)){u=!0;break}}}}return l[c]=u,u},F7e=({module:e})=>{const t=E.useRef(null),n=E.useRef(null),[r,s]=E.useState(!1),[,i]=E.useState({});E.useEffect(()=>(e.setNotifyCallback(()=>i({})),e.isLoading&&!jn.getState().isLoading&&!Va.getState().isLoading&&e.setIsLoading(!1),()=>e.setNotifyCallback(null)),[e]),E.useEffect(()=>{const ye=t.current;if(ye){const Me=ye.querySelector("[data-radix-scroll-area-viewport]");if(Me&&n.current!==Me?(n.current=Me,r||s(!0),i({})):!Me&&n.current&&(n.current=null,s(!1)),!n.current){const ue=new MutationObserver(()=>{const oe=ye.querySelector("[data-radix-scroll-area-viewport]");oe&&n.current!==oe&&(n.current=oe,s(!0),i({}),ue.disconnect())});return ue.observe(ye,{childList:!0,subtree:!0}),()=>ue.disconnect()}}},[t.current,r]);const{selectedItemId:a,selectedItemType:o,conversations:l,syncRepos:c,conversationSyncStatus:u,selectItem:d,addConversation:h,updateConversation:m,deleteConversation:y,exportConversation:b,exportProject:v,getConversationById:x}=jn(mn(ye=>({selectedItemId:ye.selectedItemId,selectedItemType:ye.selectedItemType,conversations:ye.conversations,syncRepos:ye.syncRepos,conversationSyncStatus:ye.conversationSyncStatus,selectItem:ye.selectItem,addConversation:ye.addConversation,updateConversation:ye.updateConversation,deleteConversation:ye.deleteConversation,exportConversation:ye.exportConversation,exportProject:ye.exportProject,getConversationById:ye.getConversationById}))),{projects:w,addProject:_,updateProject:k,deleteProject:C,getProjectById:T}=Va(mn(ye=>({projects:ye.projects,addProject:ye.addProject,updateProject:ye.updateProject,deleteProject:ye.deleteProject,getProjectById:ye.getProjectById}))),A=e.isLoading,[N,I]=Ve.useState(new Set),[j,L]=E.useState(""),D=D7e({updateProject:k,updateConversation:m,deleteProject:C}),{editingItemId:H,editingItemType:O,isSavingEdit:K,handleStartEditing:U,handleSaveEdit:W,handleCancelEdit:B,originalNameToCompare:ne}=D,V=E.useCallback(ye=>{I(Me=>{const ue=new Set(Me);return ue.has(ye)?ue.delete(ye):ue.add(ye),ue})},[]),Q=E.useCallback(()=>{if(o==="project")return a;if(o==="conversation"&&a){const ye=x(a);return(ye==null?void 0:ye.projectId)??null}return null},[a,o,x]),ee=E.useCallback(async()=>{if(!H)try{const ye=Q(),Me=await h({title:"New Chat",projectId:ye});d(Me,"conversation")}catch(ye){console.error("Failed to create new chat:",ye),ke.error("Failed to create new chat.")}},[H,Q,h,d]),re=E.useCallback(async()=>{if(!H)try{const ye=Q(),Me=await _({name:"New Project",parentId:ye});d(Me,"project"),ye&&I(ue=>new Set(ue).add(ye)),setTimeout(()=>{const ue=T(Me);ue&&U({...ue,itemType:"project"})},50)}catch(ye){console.error("Failed to create new project:",ye)}},[H,Q,_,d,T,U]),de=E.useCallback((ye,Me)=>{ye===H&&Me===O||(H&&(ye!==H||Me!==O)&&B(),(ye!==a||Me!==o)&&d(ye,Me))},[H,O,a,o,B,d]),me=E.useCallback((ye,Me)=>{Me.stopPropagation(),window.confirm("Delete this conversation? This cannot be undone.")&&y(ye).catch(ue=>{console.error("Failed to delete conversation:",ue),ke.error("Failed to delete conversation.")})},[y]),De=E.useCallback((ye,Me)=>{Me.stopPropagation(),C(ye).catch(ue=>{console.error("Failed to delete project:",ue),ke.error("Failed to delete project.")})},[C]),je=E.useCallback(async(ye,Me,ue)=>{ue.stopPropagation();try{await b(ye,Me)}catch(oe){console.error(`Failed to export conversation as ${Me}:`,oe)}},[b]),Te=E.useCallback(async(ye,Me)=>{Me.stopPropagation();try{await v(ye)}catch(ue){console.error("Failed to export project:",ue)}},[v]),_e=E.useMemo(()=>new Map((c||[]).map(ye=>[ye.id,ye.name])),[c]),{projectsById:Ue,conversationsByProjectId:Qe,projectsByParentId:We}=E.useMemo(()=>{const ye=new Map(w.map(oe=>[oe.id,oe])),Me=new Map;l.forEach(oe=>{const se=oe.projectId??null;Me.has(se)||Me.set(se,[]),Me.get(se).push(oe)});const ue=new Map;return w.forEach(oe=>{const se=oe.parentId??null;ue.has(se)||ue.set(se,[]),ue.get(se).push(oe)}),{projectsById:ye,conversationsByProjectId:Me,projectsByParentId:ue}},[w,l]),Pe=E.useMemo(()=>{const ye=[],Me=j.toLowerCase(),ue={};function oe(se,Ie){const Be=(We.get(se)||[]).filter(At=>vre(At.id,"project",Me,w,l,Ue,Qe,We,ue)),Re=(Qe.get(se)||[]).filter(At=>At.title.toLowerCase().includes(Me)),ct=[...Be,...Re];ct.sort((At,ut)=>new Date(ut.updatedAt).getTime()-new Date(At.updatedAt).getTime()),ct.forEach(At=>{"path"in At?(ye.push({id:`project-${At.id}`,originalId:At.id,type:"project",level:Ie,data:At,updatedAt:At.updatedAt}),N.has(At.id)&&oe(At.id,Ie+1)):ye.push({id:`conversation-${At.id}`,originalId:At.id,type:"conversation",level:Ie,data:At,updatedAt:At.updatedAt})})}return oe(null,0),ye},[w,l,j,N,Ue,Qe,We]),Y=JF({count:Pe.length,getScrollElement:()=>n.current,estimateSize:()=>30,overscan:10});return f.jsxs("div",{className:"p-2 border-r border-[--border] bg-card text-card-foreground h-full flex flex-col",children:[f.jsxs("div",{className:"flex justify-between items-center mb-2 flex-shrink-0 px-1",children:[f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx("h3",{className:"text-sm font-semibold",children:"LiteChat"}),f.jsx(zd,{href:"https://github.com/DimitriGilbert/LiteChat",target:"_blank",rel:"noopener noreferrer","aria-label":"GitHub Repository",children:f.jsx(ot,{size:"sm",variant:"ghost",className:"h-4 w-4 p-0",children:f.jsx(oge,{className:"h-4 w-4"})})}),f.jsx(zd,{href:"release/latest.zip",download:"LiteChat.zip","aria-label":"Download LiteChat",children:f.jsx(ot,{size:"sm",variant:"ghost",className:"h-4 w-4 p-0",children:f.jsx(Fc,{className:"h-4 w-4"})})})]}),f.jsxs("div",{className:"flex items-center",children:[f.jsx(wr,{delayDuration:100,children:f.jsxs(Sr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(ot,{size:"sm",variant:"ghost",onClick:re,"aria-label":"New Project",disabled:A||!!H,className:"h-7 w-7 p-0",children:f.jsx($H,{className:"h-4 w-4"})})}),f.jsx(Cr,{side:"bottom",children:"New Project"})]})}),f.jsx(wr,{delayDuration:100,children:f.jsxs(Sr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(ot,{size:"sm",variant:"ghost",onClick:ee,"aria-label":"New Chat",disabled:A||!!H,className:"h-7 w-7 p-0",children:f.jsx(nc,{className:"h-4 w-4"})})}),f.jsx(Cr,{side:"bottom",children:"New Chat"})]})})]})]}),f.jsxs("div",{className:"relative mb-2 px-1 flex-shrink-0",children:[f.jsx(vo,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),f.jsx(vn,{type:"search",placeholder:"Filter...",value:j,onChange:ye=>L(ye.target.value),className:"h-8 text-xs pl-8",disabled:A})]}),f.jsxs(Xo,{className:"flex-grow",ref:t,children:[A&&Pe.length===0?f.jsxs("div",{className:"space-y-1 p-1",children:[f.jsx("div",{className:"h-8 w-full bg-muted rounded animate-pulse"}),f.jsx("div",{className:"h-8 w-full bg-muted rounded animate-pulse"}),f.jsx("div",{className:"h-8 w-full bg-muted rounded animate-pulse"})]}):!A&&Pe.length===0?f.jsx("p",{className:"text-xs text-muted-foreground p-2 text-center",children:j.trim()!==""?"No items match your filter.":"Workspace is empty."}):r&&f.jsx("div",{style:{height:`${Y.getTotalSize()}px`,width:"100%",position:"relative"},children:Y.getVirtualItems().map(ye=>{const Me=Pe[ye.index];if(!Me)return null;const ue={...Me.data,itemType:Me.type};return f.jsx("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:`${ye.size}px`,transform:`translateY(${ye.start}px)`},className:"px-1",children:f.jsx(bre,{item:ue,level:Me.level,selectedItemId:a,conversationSyncStatus:u,repoNameMap:_e,onSelectItem:()=>de(Me.originalId,Me.type),onDeleteConversation:me,onDeleteProject:De,onExportConversation:je,onExportProject:Te,expandedProjects:N,toggleProjectExpansion:V,editingItemId:H,editingItemType:O,handleStartEditing:U,handleSaveEdit:W,handleCancelEdit:B,isSavingEdit:K,originalNameToCompare:ne})},Me.id)})}),!r&&!A&&f.jsx("div",{className:"flex items-center justify-center h-full text-muted-foreground",children:"Initializing list..."})]})]})},L7e=({module:e})=>{const{selectedItemType:t}=jn(mn(r=>({selectedItemType:r.selectedItemType})));return e.isLoading?f.jsx(Hn,{className:"h-5 w-5 animate-spin text-muted-foreground"}):t==="project"?f.jsx(Ih,{className:"h-5 w-5 text-primary"}):t==="conversation"?f.jsx(qB,{className:"h-5 w-5 text-primary"}):f.jsx(qB,{className:"h-5 w-5 text-muted-foreground"})};class B7e{constructor(){ce(this,"id","core-conversation-list");ce(this,"unregisterCallback",null);ce(this,"eventUnsubscribers",[]);ce(this,"isLoading",!0);ce(this,"conversationsLoading",!0);ce(this,"projectsLoading",!0);ce(this,"notifyComponentUpdate",null);ce(this,"setIsLoading",t=>{var n;this.isLoading!==t&&(this.isLoading=t,(n=this.notifyComponentUpdate)==null||n.call(this))});ce(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){this.conversationsLoading=jn.getState().isLoading,this.projectsLoading=Va.getState().isLoading,this.updateCombinedLoadingState(),t.emit(tr.loadConversationsRequest,void 0),t.emit(Ta.loadProjectsRequest,void 0);const n=t.on(tr.conversationsLoaded,()=>{this.conversationsLoading=!1,this.updateCombinedLoadingState()}),r=t.on(Ta.loaded,()=>{this.projectsLoading=!1,this.updateCombinedLoadingState()}),s=t.on(tr.loadingStateChanged,a=>{a.isLoading!==this.conversationsLoading&&(this.conversationsLoading=a.isLoading,this.updateCombinedLoadingState())}),i=t.on(Ta.loadingStateChanged,a=>{a.isLoading!==this.projectsLoading&&(this.projectsLoading=a.isLoading,this.updateCombinedLoadingState())});this.eventUnsubscribers.push(n,r,s,i)}updateCombinedLoadingState(){var n;const t=this.conversationsLoading||this.projectsLoading;this.isLoading!==t&&(this.isLoading=t,(n=this.notifyComponentUpdate)==null||n.call(this))}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Module "${this.id}" already registered. Skipping.`);return}this.unregisterCallback=t.registerChatControl({id:this.id,panel:"sidebar",status:()=>this.isLoading?"loading":"ready",renderer:()=>Ve.createElement(F7e,{module:this}),iconRenderer:()=>Ve.createElement(L7e,{module:this}),show:()=>!0})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,console.log(`[${this.id}] Destroyed.`)}}const Hq=({module:e})=>{const t=(n,r)=>{e.openSettingsModal(n,r)};return f.jsx(wr,{delayDuration:100,children:f.jsxs(Sr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(ot,{variant:"ghost",size:"icon",onClick:()=>t(),className:"h-8 w-8","aria-label":"Open Settings",children:f.jsx(jh,{className:"h-4 w-4"})})}),f.jsx(Cr,{side:"top",children:"Settings"})]})})};var wj="focusScope.autoFocusOnMount",Sj="focusScope.autoFocusOnUnmount",Gq={bubbles:!1,cancelable:!0},$7e="FocusScope",n6=E.forwardRef((e,t)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:s,onUnmountAutoFocus:i,...a}=e,[o,l]=E.useState(null),c=Ts(s),u=Ts(i),d=E.useRef(null),h=Tn(t,b=>l(b)),m=E.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;E.useEffect(()=>{if(r){let b=function(_){if(m.paused||!o)return;const k=_.target;o.contains(k)?d.current=k:gh(d.current,{select:!0})},v=function(_){if(m.paused||!o)return;const k=_.relatedTarget;k!==null&&(o.contains(k)||gh(d.current,{select:!0}))},x=function(_){if(document.activeElement===document.body)for(const C of _)C.removedNodes.length>0&&gh(o)};document.addEventListener("focusin",b),document.addEventListener("focusout",v);const w=new MutationObserver(x);return o&&w.observe(o,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",b),document.removeEventListener("focusout",v),w.disconnect()}}},[r,o,m.paused]),E.useEffect(()=>{if(o){Yq.add(m);const b=document.activeElement;if(!o.contains(b)){const x=new CustomEvent(wj,Gq);o.addEventListener(wj,c),o.dispatchEvent(x),x.defaultPrevented||(z7e(H7e(xre(o)),{select:!0}),document.activeElement===b&&gh(o))}return()=>{o.removeEventListener(wj,c),setTimeout(()=>{const x=new CustomEvent(Sj,Gq);o.addEventListener(Sj,u),o.dispatchEvent(x),x.defaultPrevented||gh(b??document.body,{select:!0}),o.removeEventListener(Sj,u),Yq.remove(m)},0)}}},[o,c,u,m]);const y=E.useCallback(b=>{if(!n&&!r||m.paused)return;const v=b.key==="Tab"&&!b.altKey&&!b.ctrlKey&&!b.metaKey,x=document.activeElement;if(v&&x){const w=b.currentTarget,[_,k]=U7e(w);_&&k?!b.shiftKey&&x===k?(b.preventDefault(),n&&gh(_,{select:!0})):b.shiftKey&&x===_&&(b.preventDefault(),n&&gh(k,{select:!0})):x===w&&b.preventDefault()}},[n,r,m.paused]);return f.jsx(Kn.div,{tabIndex:-1,...a,ref:h,onKeyDown:y})});n6.displayName=$7e;function z7e(e,{select:t=!1}={}){const n=document.activeElement;for(const r of e)if(gh(r,{select:t}),document.activeElement!==n)return}function U7e(e){const t=xre(e),n=Kq(t,e),r=Kq(t.reverse(),e);return[n,r]}function xre(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const s=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||s?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function Kq(e,t){for(const n of e)if(!q7e(n,{upTo:t}))return n}function q7e(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function V7e(e){return e instanceof HTMLInputElement&&"select"in e}function gh(e,{select:t=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&V7e(e)&&t&&e.select()}}var Yq=W7e();function W7e(){let e=[];return{add(t){const n=e[0];t!==n&&(n==null||n.pause()),e=Zq(e,t),e.unshift(t)},remove(t){var n;e=Zq(e,t),(n=e[0])==null||n.resume()}}}function Zq(e,t){const n=[...e],r=n.indexOf(t);return r!==-1&&n.splice(r,1),n}function H7e(e){return e.filter(t=>t.tagName!=="A")}function G7e(e){const t=K7e(e),n=E.forwardRef((r,s)=>{const{children:i,...a}=r,o=E.Children.toArray(i),l=o.find(Z7e);if(l){const c=l.props.children,u=o.map(d=>d===l?E.Children.count(c)>1?E.Children.only(null):E.isValidElement(c)?c.props.children:null:d);return f.jsx(t,{...a,ref:s,children:E.isValidElement(c)?E.cloneElement(c,void 0,u):null})}return f.jsx(t,{...a,ref:s,children:i})});return n.displayName=`${e}.Slot`,n}function K7e(e){const t=E.forwardRef((n,r)=>{const{children:s,...i}=n;if(E.isValidElement(s)){const a=J7e(s),o=X7e(i,s.props);return s.type!==E.Fragment&&(o.ref=r?wl(r,a):a),E.cloneElement(s,o)}return E.Children.count(s)>1?E.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var Y7e=Symbol("radix.slottable");function Z7e(e){return E.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===Y7e}function X7e(e,t){const n={...t};for(const r in t){const s=e[r],i=t[r];/^on[A-Z]/.test(r)?s&&i?n[r]=(...o)=>{i(...o),s(...o)}:s&&(n[r]=s):r==="style"?n[r]={...s,...i}:r==="className"&&(n[r]=[s,i].filter(Boolean).join(" "))}return{...e,...n}}function J7e(e){var r,s;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(s=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:s.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var YT="Dialog",[wre,Bft]=Ei(YT),[Q7e,eu]=wre(YT),Sre=e=>{const{__scopeDialog:t,children:n,open:r,defaultOpen:s,onOpenChange:i,modal:a=!0}=e,o=E.useRef(null),l=E.useRef(null),[c,u]=rc({prop:r,defaultProp:s??!1,onChange:i,caller:YT});return f.jsx(Q7e,{scope:t,triggerRef:o,contentRef:l,contentId:pa(),titleId:pa(),descriptionId:pa(),open:c,onOpenChange:u,onOpenToggle:E.useCallback(()=>u(d=>!d),[u]),modal:a,children:n})};Sre.displayName=YT;var _re="DialogTrigger",eUe=E.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,s=eu(_re,n),i=Tn(t,s.triggerRef);return f.jsx(Kn.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":i6(s.open),...r,ref:i,onClick:Wt(e.onClick,s.onOpenToggle)})});eUe.displayName=_re;var r6="DialogPortal",[tUe,Cre]=wre(r6,{forceMount:void 0}),kre=e=>{const{__scopeDialog:t,forceMount:n,children:r,container:s}=e,i=eu(r6,t);return f.jsx(tUe,{scope:t,forceMount:n,children:E.Children.map(r,a=>f.jsx(ea,{present:n||i.open,children:f.jsx(HE,{asChild:!0,container:s,children:a})}))})};kre.displayName=r6;var Lk="DialogOverlay",Ere=E.forwardRef((e,t)=>{const n=Cre(Lk,e.__scopeDialog),{forceMount:r=n.forceMount,...s}=e,i=eu(Lk,e.__scopeDialog);return i.modal?f.jsx(ea,{present:r||i.open,children:f.jsx(rUe,{...s,ref:t})}):null});Ere.displayName=Lk;var nUe=G7e("DialogOverlay.RemoveScroll"),rUe=E.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,s=eu(Lk,n);return f.jsx(oS,{as:nUe,allowPinchZoom:!0,shards:[s.contentRef],children:f.jsx(Kn.div,{"data-state":i6(s.open),...r,ref:t,style:{pointerEvents:"auto",...r.style}})})}),$m="DialogContent",Tre=E.forwardRef((e,t)=>{const n=Cre($m,e.__scopeDialog),{forceMount:r=n.forceMount,...s}=e,i=eu($m,e.__scopeDialog);return f.jsx(ea,{present:r||i.open,children:i.modal?f.jsx(sUe,{...s,ref:t}):f.jsx(iUe,{...s,ref:t})})});Tre.displayName=$m;var sUe=E.forwardRef((e,t)=>{const n=eu($m,e.__scopeDialog),r=E.useRef(null),s=Tn(t,n.contentRef,r);return E.useEffect(()=>{const i=r.current;if(i)return PT(i)},[]),f.jsx(Are,{...e,ref:s,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Wt(e.onCloseAutoFocus,i=>{var a;i.preventDefault(),(a=n.triggerRef.current)==null||a.focus()}),onPointerDownOutside:Wt(e.onPointerDownOutside,i=>{const a=i.detail.originalEvent,o=a.button===0&&a.ctrlKey===!0;(a.button===2||o)&&i.preventDefault()}),onFocusOutside:Wt(e.onFocusOutside,i=>i.preventDefault())})}),iUe=E.forwardRef((e,t)=>{const n=eu($m,e.__scopeDialog),r=E.useRef(!1),s=E.useRef(!1);return f.jsx(Are,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var a,o;(a=e.onCloseAutoFocus)==null||a.call(e,i),i.defaultPrevented||(r.current||(o=n.triggerRef.current)==null||o.focus(),i.preventDefault()),r.current=!1,s.current=!1},onInteractOutside:i=>{var l,c;(l=e.onInteractOutside)==null||l.call(e,i),i.defaultPrevented||(r.current=!0,i.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const a=i.target;((c=n.triggerRef.current)==null?void 0:c.contains(a))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&s.current&&i.preventDefault()}})}),Are=E.forwardRef((e,t)=>{const{__scopeDialog:n,trapFocus:r,onOpenAutoFocus:s,onCloseAutoFocus:i,...a}=e,o=eu($m,n),l=E.useRef(null),c=Tn(t,l);return jT(),f.jsxs(f.Fragment,{children:[f.jsx(n6,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:s,onUnmountAutoFocus:i,children:f.jsx(zE,{role:"dialog",id:o.contentId,"aria-describedby":o.descriptionId,"aria-labelledby":o.titleId,"data-state":i6(o.open),...a,ref:c,onDismiss:()=>o.onOpenChange(!1)})}),f.jsxs(f.Fragment,{children:[f.jsx(aUe,{titleId:o.titleId}),f.jsx(lUe,{contentRef:l,descriptionId:o.descriptionId})]})]})}),s6="DialogTitle",Rre=E.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,s=eu(s6,n);return f.jsx(Kn.h2,{id:s.titleId,...r,ref:t})});Rre.displayName=s6;var Nre="DialogDescription",Ire=E.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,s=eu(Nre,n);return f.jsx(Kn.p,{id:s.descriptionId,...r,ref:t})});Ire.displayName=Nre;var Mre="DialogClose",jre=E.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,s=eu(Mre,n);return f.jsx(Kn.button,{type:"button",...r,ref:t,onClick:Wt(e.onClick,()=>s.onOpenChange(!1))})});jre.displayName=Mre;function i6(e){return e?"open":"closed"}var Pre="DialogTitleWarning",[$ft,Ore]=Yxe(Pre,{contentName:$m,titleName:s6,docsSlug:"dialog"}),aUe=({titleId:e})=>{const t=Ore(Pre),n=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return E.useEffect(()=>{e&&(document.getElementById(e)||console.error(n))},[n,e]),null},oUe="DialogDescriptionWarning",lUe=({contentRef:e,descriptionId:t})=>{const r=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${Ore(oUe).contentName}}.`;return E.useEffect(()=>{var i;const s=(i=e.current)==null?void 0:i.getAttribute("aria-describedby");t&&s&&(document.getElementById(t)||console.warn(r))},[r,e,t]),null},Dre=Sre,Fre=kre,Lre=Ere,Bre=Tre,cUe=Rre,uUe=Ire,$re=jre;function td({...e}){return f.jsx(Dre,{"data-slot":"dialog",...e})}function dUe({...e}){return f.jsx(Fre,{"data-slot":"dialog-portal",...e})}function fUe({...e}){return f.jsx($re,{"data-slot":"dialog-close",...e})}function hUe({className:e,...t}){return f.jsx(Lre,{"data-slot":"dialog-overlay",className:Ye("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",e),...t})}function nd({className:e,children:t,...n}){return f.jsxs(dUe,{"data-slot":"dialog-portal",children:[f.jsx(hUe,{}),f.jsxs(Bre,{"data-slot":"dialog-content",className:Ye("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",e),...n,children:[t,f.jsxs($re,{className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[f.jsx(Si,{}),f.jsx("span",{className:"sr-only",children:"Close"})]})]})]})}function rd({className:e,...t}){return f.jsx("div",{"data-slot":"dialog-header",className:Ye("flex flex-col gap-2 text-center sm:text-left",e),...t})}function dg({className:e,...t}){return f.jsx("div",{"data-slot":"dialog-footer",className:Ye("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",e),...t})}function sd({className:e,...t}){return f.jsx(cUe,{"data-slot":"dialog-title",className:Ye("text-lg leading-none font-semibold",e),...t})}function wf({className:e,...t}){return f.jsx(uUe,{"data-slot":"dialog-description",className:Ye("text-muted-foreground text-sm",e),...t})}var _j="rovingFocusGroup.onEntryFocus",pUe={bubbles:!1,cancelable:!0},mS="RovingFocusGroup",[qP,zre,mUe]=yF(mS),[gUe,Eb]=Ei(mS,[mUe]),[yUe,bUe]=gUe(mS),Ure=E.forwardRef((e,t)=>f.jsx(qP.Provider,{scope:e.__scopeRovingFocusGroup,children:f.jsx(qP.Slot,{scope:e.__scopeRovingFocusGroup,children:f.jsx(vUe,{...e,ref:t})})}));Ure.displayName=mS;var vUe=E.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,orientation:r,loop:s=!1,dir:i,currentTabStopId:a,defaultCurrentTabStopId:o,onCurrentTabStopIdChange:l,onEntryFocus:c,preventScrollOnEntryFocus:u=!1,...d}=e,h=E.useRef(null),m=Tn(t,h),y=cg(i),[b,v]=rc({prop:a,defaultProp:o??null,onChange:l,caller:mS}),[x,w]=E.useState(!1),_=Ts(c),k=zre(n),C=E.useRef(!1),[T,A]=E.useState(0);return E.useEffect(()=>{const N=h.current;if(N)return N.addEventListener(_j,_),()=>N.removeEventListener(_j,_)},[_]),f.jsx(yUe,{scope:n,orientation:r,dir:y,loop:s,currentTabStopId:b,onItemFocus:E.useCallback(N=>v(N),[v]),onItemShiftTab:E.useCallback(()=>w(!0),[]),onFocusableItemAdd:E.useCallback(()=>A(N=>N+1),[]),onFocusableItemRemove:E.useCallback(()=>A(N=>N-1),[]),children:f.jsx(Kn.div,{tabIndex:x||T===0?-1:0,"data-orientation":r,...d,ref:m,style:{outline:"none",...e.style},onMouseDown:Wt(e.onMouseDown,()=>{C.current=!0}),onFocus:Wt(e.onFocus,N=>{const I=!C.current;if(N.target===N.currentTarget&&I&&!x){const j=new CustomEvent(_j,pUe);if(N.currentTarget.dispatchEvent(j),!j.defaultPrevented){const L=k().filter(U=>U.focusable),D=L.find(U=>U.active),H=L.find(U=>U.id===b),K=[D,H,...L].filter(Boolean).map(U=>U.ref.current);Wre(K,u)}}C.current=!1}),onBlur:Wt(e.onBlur,()=>w(!1))})})}),qre="RovingFocusGroupItem",Vre=E.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,focusable:r=!0,active:s=!1,tabStopId:i,children:a,...o}=e,l=pa(),c=i||l,u=bUe(qre,n),d=u.currentTabStopId===c,h=zre(n),{onFocusableItemAdd:m,onFocusableItemRemove:y,currentTabStopId:b}=u;return E.useEffect(()=>{if(r)return m(),()=>y()},[r,m,y]),f.jsx(qP.ItemSlot,{scope:n,id:c,focusable:r,active:s,children:f.jsx(Kn.span,{tabIndex:d?0:-1,"data-orientation":u.orientation,...o,ref:t,onMouseDown:Wt(e.onMouseDown,v=>{r?u.onItemFocus(c):v.preventDefault()}),onFocus:Wt(e.onFocus,()=>u.onItemFocus(c)),onKeyDown:Wt(e.onKeyDown,v=>{if(v.key==="Tab"&&v.shiftKey){u.onItemShiftTab();return}if(v.target!==v.currentTarget)return;const x=SUe(v,u.orientation,u.dir);if(x!==void 0){if(v.metaKey||v.ctrlKey||v.altKey||v.shiftKey)return;v.preventDefault();let _=h().filter(k=>k.focusable).map(k=>k.ref.current);if(x==="last")_.reverse();else if(x==="prev"||x==="next"){x==="prev"&&_.reverse();const k=_.indexOf(v.currentTarget);_=u.loop?_Ue(_,k+1):_.slice(k+1)}setTimeout(()=>Wre(_))}}),children:typeof a=="function"?a({isCurrentTabStop:d,hasTabStop:b!=null}):a})})});Vre.displayName=qre;var xUe={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function wUe(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function SUe(e,t,n){const r=wUe(e.key,n);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return xUe[r]}function Wre(e,t=!1){const n=document.activeElement;for(const r of e)if(r===n||(r.focus({preventScroll:t}),document.activeElement!==n))return}function _Ue(e,t){return e.map((n,r)=>e[(t+r)%e.length])}var a6=Ure,o6=Vre,ZT="Tabs",[CUe,zft]=Ei(ZT,[Eb]),Hre=Eb(),[kUe,l6]=CUe(ZT),Gre=E.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,onValueChange:s,defaultValue:i,orientation:a="horizontal",dir:o,activationMode:l="automatic",...c}=e,u=cg(o),[d,h]=rc({prop:r,onChange:s,defaultProp:i??"",caller:ZT});return f.jsx(kUe,{scope:n,baseId:pa(),value:d,onValueChange:h,orientation:a,dir:u,activationMode:l,children:f.jsx(Kn.div,{dir:u,"data-orientation":a,...c,ref:t})})});Gre.displayName=ZT;var Kre="TabsList",Yre=E.forwardRef((e,t)=>{const{__scopeTabs:n,loop:r=!0,...s}=e,i=l6(Kre,n),a=Hre(n);return f.jsx(a6,{asChild:!0,...a,orientation:i.orientation,dir:i.dir,loop:r,children:f.jsx(Kn.div,{role:"tablist","aria-orientation":i.orientation,...s,ref:t})})});Yre.displayName=Kre;var Zre="TabsTrigger",Xre=E.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,disabled:s=!1,...i}=e,a=l6(Zre,n),o=Hre(n),l=ese(a.baseId,r),c=tse(a.baseId,r),u=r===a.value;return f.jsx(o6,{asChild:!0,...o,focusable:!s,active:u,children:f.jsx(Kn.button,{type:"button",role:"tab","aria-selected":u,"aria-controls":c,"data-state":u?"active":"inactive","data-disabled":s?"":void 0,disabled:s,id:l,...i,ref:t,onMouseDown:Wt(e.onMouseDown,d=>{!s&&d.button===0&&d.ctrlKey===!1?a.onValueChange(r):d.preventDefault()}),onKeyDown:Wt(e.onKeyDown,d=>{[" ","Enter"].includes(d.key)&&a.onValueChange(r)}),onFocus:Wt(e.onFocus,()=>{const d=a.activationMode!=="manual";!u&&!s&&d&&a.onValueChange(r)})})})});Xre.displayName=Zre;var Jre="TabsContent",Qre=E.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,forceMount:s,children:i,...a}=e,o=l6(Jre,n),l=ese(o.baseId,r),c=tse(o.baseId,r),u=r===o.value,d=E.useRef(u);return E.useEffect(()=>{const h=requestAnimationFrame(()=>d.current=!1);return()=>cancelAnimationFrame(h)},[]),f.jsx(ea,{present:s||u,children:({present:h})=>f.jsx(Kn.div,{"data-state":u?"active":"inactive","data-orientation":o.orientation,role:"tabpanel","aria-labelledby":l,hidden:!h,id:c,tabIndex:0,...a,ref:t,style:{...e.style,animationDuration:d.current?"0s":void 0},children:h&&i})})});Qre.displayName=Jre;function ese(e,t){return`${e}-trigger-${t}`}function tse(e,t){return`${e}-content-${t}`}var EUe=Gre,TUe=Yre,AUe=Xre,RUe=Qre;function NUe({className:e,...t}){return f.jsx(EUe,{"data-slot":"tabs",className:Ye("flex flex-col gap-2",e),...t})}function IUe({className:e,...t}){return f.jsx(TUe,{"data-slot":"tabs-list",className:Ye("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",e),...t})}function MUe({className:e,...t}){return f.jsx(AUe,{"data-slot":"tabs-trigger",className:Ye("data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...t})}function jUe({className:e,...t}){return f.jsx(RUe,{"data-slot":"tabs-content",className:Ye("flex-1 outline-none",e),...t})}const Tl=({tabs:e,defaultValue:t,initialValue:n,onValueChange:r,className:s,listClassName:i,contentContainerClassName:a,scrollable:o})=>{var m;const[l,c]=E.useState(n??t??((m=e[0])==null?void 0:m.value));E.useEffect(()=>{n!==void 0&&n!==l&&c(n)},[n,l]);const u=y=>{c(y),r&&r(y)},d=Ye("px-1 py-0.25 text-xs sm:px-3 sm:py-1.5 sm:text-sm font-medium rounded-md","text-muted-foreground","border border-transparent","focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2","data-[state=active]:bg-primary/10 data-[state=active]:text-primary","data-[state=active]:border-primary","dark:data-[state=active]:bg-primary/20 dark:data-[state=active]:text-primary","dark:data-[state=active]:border-primary/70","hover:bg-muted/50 hover:text-primary/80"),h=({children:y})=>{const v=Ye(o?"flex-grow overflow-y-auto pb-2 sm:pb-6 pr-1 sm:pr-2 -mr-1 sm:-mr-2":"flex-grow pb-2 sm:pb-6 pr-1 sm:pr-2 -mr-1 sm:-mr-2",a);return o?f.jsx(Xo,{className:v,children:y}):f.jsx("div",{className:v,children:y})};return f.jsxs(NUe,{value:l,onValueChange:u,defaultValue:t,className:Ye("flex flex-col h-full",s),children:[f.jsx(IUe,{className:Ye("flex-shrink-0 sticky top-0 bg-background z-[var(--z-sticky)] flex-wrap h-auto justify-start border-b gap-0.5 sm:gap-1 p-0.5 sm:p-1 px-2 sm:px-6",i),children:e.map(y=>f.jsx(MUe,{value:y.value,disabled:y.disabled,className:d,children:y.label},y.value))}),f.jsx(h,{children:e.map(y=>f.jsx(jUe,{value:y.value,className:"data-[state=inactive]:hidden h-full [transform:translateZ(0)]",children:y.content},y.value))})]})},nse=E.memo(({isOpen:e,onClose:t,initialTab:n})=>{const{modSettingsTabs:r}=Yh(mn(u=>({modSettingsTabs:u.modSettingsTabs||[]}))),s=E.useMemo(()=>[...r.map(h=>{const m=h.component;return{value:h.id,label:h.title,content:f.jsx(m,{}),order:h.order??999}})].sort((h,m)=>(h.order??999)-(m.order??999)),[r]),i=E.useCallback(()=>s.length>0?s[0].value:"general",[s]),[a,o]=E.useState(i());E.useEffect(()=>{if(e){let u=i();n&&s.some(d=>d.value===n)?u=n:n&&(console.warn(`[SettingsModal] Initial tab "${n}" not found. Defaulting to "${u}".`),ke.error(`Settings tab "${n}" not found. Opening default tab.`)),o(u)}},[e,n,s,i]);const l=u=>{u||t()},c=u=>{o(u)};return f.jsx(td,{open:e,onOpenChange:l,children:f.jsxs(nd,{className:Ye("min-w-[95vw] h-[95vh] flex flex-col p-0"),children:[f.jsxs(rd,{className:"p-4 md:p-6 pb-2 md:pb-4 flex-shrink-0",children:[f.jsx(sd,{children:"Settings"}),f.jsx(wf,{children:"Manage application settings, AI behavior, API keys, providers, and data."})]}),s.length>0?f.jsx(Tl,{tabs:s,initialValue:a,onValueChange:c,className:"flex-grow overflow-hidden px-4 md:px-6",listClassName:"-mx-4 md:-mx-6 px-2 md:px-6 py-1 md:py-0",contentContainerClassName:"flex-grow pb-4 md:pb-6",scrollable:!0},a):f.jsx("div",{className:"flex-grow flex items-center justify-center text-muted-foreground p-4",children:"No settings tabs available or still loading. Check console for module registration errors."}),f.jsx(dg,{className:"flex-shrink-0 border-t p-4 md:p-6 pt-3 md:pt-4 mt-auto",children:f.jsx(ot,{variant:"outline",onClick:()=>l(!1),children:"Close"})})]})})});nse.displayName="SettingsModalComponent";const PUe=nse;class OUe{constructor(){ce(this,"id","core-settings-trigger");ce(this,"modalId","settingsModal");ce(this,"unregisterChatControlCallback",null);ce(this,"unregisterModalProviderCallback",null);ce(this,"modApiRef",null);ce(this,"openSettingsModal",(t,n)=>{var r;(r=this.modApiRef)==null||r.emit(Tr.openModalRequest,{modalId:this.modalId,initialTab:t||"general",initialSubTab:n})});ce(this,"closeSettingsModal",()=>{var t;(t=this.modApiRef)==null||t.emit(Tr.closeModalRequest,{modalId:this.modalId})})}async initialize(t){this.modApiRef=t}register(t){if(this.modApiRef=t,this.unregisterChatControlCallback&&this.unregisterModalProviderCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterChatControlCallback||(this.unregisterChatControlCallback=t.registerChatControl({id:this.id,panel:"sidebar-footer",status:()=>"ready",renderer:()=>Ve.createElement(Hq,{module:this}),iconRenderer:()=>Ve.createElement(Hq,{module:this}),show:()=>!0})),this.unregisterModalProviderCallback||(this.unregisterModalProviderCallback=t.registerModalProvider(this.modalId,n=>Ve.createElement(PUe,{isOpen:n.isOpen,onClose:n.onClose,initialTab:n.initialTab,initialSubTab:n.initialSubTab})))}destroy(){this.unregisterChatControlCallback&&(this.unregisterChatControlCallback(),this.unregisterChatControlCallback=null),this.unregisterModalProviderCallback&&(this.unregisterModalProviderCallback(),this.unregisterModalProviderCallback=null),this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const DUe=({module:e})=>{const[,t]=E.useState({});E.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const n=e.getIsSidebarCollapsed();return f.jsx(wr,{delayDuration:100,children:f.jsxs(Sr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(ot,{variant:"ghost",size:"icon",onClick:()=>e.toggleSidebar(),className:"h-8 w-8","aria-label":n?"Expand Sidebar":"Collapse Sidebar",children:n?f.jsx(Lge,{className:"h-4 w-4"}):f.jsx(Dge,{className:"h-4 w-4"})})}),f.jsx(Cr,{side:"top",children:n?"Expand Sidebar":"Collapse Sidebar"})]})})};class FUe{constructor(){ce(this,"id","core-sidebar-toggle");ce(this,"unregisterCallback",null);ce(this,"notifyComponentUpdate",null);ce(this,"modApiRef",null);ce(this,"getIsSidebarCollapsed",()=>s1.getState().isSidebarCollapsed);ce(this,"toggleSidebar",t=>{var s,i;const n=s1.getState().isSidebarCollapsed,r=t??!n;n!==r&&((s=this.modApiRef)==null||s.emit(Tr.toggleSidebarRequest,{isCollapsed:r}),(i=this.notifyComponentUpdate)==null||i.call(this))});ce(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){this.modApiRef=t}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}const n=()=>Ve.createElement(DUe,{module:this});this.unregisterCallback=t.registerChatControl({id:this.id,panel:"sidebar-footer",status:()=>"ready",renderer:n,iconRenderer:n,show:()=>!0})}destroy(){this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}function Ly({form:e,name:t,label:n,placeholder:r,disabled:s,wrapperClassName:i,allowNull:a=!1,min:o,max:l,step:c,className:u,onBlurInput:d,...h}){return f.jsx(e.Field,{name:t,children:m=>{const y=x=>{const w=x.target.value;if(w===""&&a)m.handleChange(null);else{const _=parseFloat(w);isNaN(_)?w===""&&!a&&m.handleChange(w):m.handleChange(_)}},b=typeof m.state.value=="number"?m.state.value.toString():(m.state.value===null&&a,""),v=x=>{m.handleBlur(),d&&d(x)};return f.jsxs("div",{className:Ye("space-y-1.5",i),children:[" ",f.jsx(Nt,{htmlFor:m.name,className:"text-sm",children:n}),f.jsx(vn,{id:m.name,name:m.name,type:"number",value:b,onBlur:v,onChange:y,placeholder:r,disabled:s??m.form.state.isSubmitting,min:o,max:l,step:c,className:Ye(u,m.state.meta.errors.length?"border-destructive":""),...h}),f.jsx(Li,{field:m})]})}})}function Oc({form:e,name:t,label:n,valueLabelPrefix:r="",valueLabelSuffix:s="",valueDisplayPrecision:i=2,showRawValue:a=!1,disabled:o,wrapperClassName:l,className:c,min:u,max:d,step:h,...m}){return f.jsx(e.Field,{name:t,children:y=>{const b=typeof y.state.value=="number"?y.state.value:u??0,v=b.toFixed(i);return f.jsxs("div",{className:Ye("space-y-1.5",l),children:[f.jsxs(Nt,{htmlFor:y.name,className:"text-sm",children:[n," (",r,v,s,")",a&&f.jsxs("span",{className:"text-xs text-muted-foreground ml-2",children:["(Raw: ",y.state.value,")"]})]}),f.jsx(P0,{id:y.name,name:y.name,value:[b],onValueChange:x=>y.handleChange(x[0]),onBlur:y.handleBlur,disabled:o??y.form.state.isSubmitting,min:u,max:d,step:h,className:Ye(c,y.state.meta.errors.length?"border-destructive":""),...m}),f.jsx(Li,{field:y})]})}})}const LUe=Ke({temperature:Tt().min(0).max(1),topP:Tt().min(0).max(1),maxTokens:Tt().min(1).nullable(),topK:Tt().min(1).nullable(),presencePenalty:Tt().min(-2).max(2),frequencyPenalty:Tt().min(-2).max(2)}),BUe=({module:e,className:t})=>{const n=ai({defaultValues:{temperature:e.temperature??e.defaultTemperature??.7,topP:e.topP??e.defaultTopP??1,maxTokens:e.maxTokens??e.defaultMaxTokens??null,topK:e.topK??e.defaultTopK??null,presencePenalty:e.presencePenalty??e.defaultPresencePenalty??0,frequencyPenalty:e.frequencyPenalty??e.defaultFrequencyPenalty??0},validators:{onChangeAsync:LUe,onChangeAsyncDebounceMs:500}});E.useEffect(()=>{n.reset({temperature:e.temperature??e.defaultTemperature??.7,topP:e.topP??e.defaultTopP??1,maxTokens:e.maxTokens??e.defaultMaxTokens??null,topK:e.topK??e.defaultTopK??null,presencePenalty:e.presencePenalty??e.defaultPresencePenalty??0,frequencyPenalty:e.frequencyPenalty??e.defaultFrequencyPenalty??0})},[e.temperature,e.defaultTemperature,e.topP,e.defaultTopP,e.maxTokens,e.defaultMaxTokens,e.topK,e.defaultTopK,e.presencePenalty,e.defaultPresencePenalty,e.frequencyPenalty,e.defaultFrequencyPenalty]);const[,r]=Ve.useState({});E.useEffect(()=>{const u=()=>r({});return e.setNotifyCallback(u),()=>e.setNotifyCallback(null)},[e]);const s=E.useCallback((u,d,h)=>{var m;((m=n.getFieldMeta(u))==null?void 0:m.errors.length)===0&&d(h)},[n,e]),i=E.useCallback((u,d)=>{var h;if(((h=n.getFieldMeta(u))==null?void 0:h.errors.length)===0){const m=n.getFieldValue(u);d(m)}},[n,e]),a=E.useCallback((u,d,h)=>{n.setFieldValue(u,h),d(null)},[n,e]),o=e.supportedParams,l=e.defaultTemperature!==void 0||e.defaultTopP!==void 0||e.defaultMaxTokens!==void 0||e.defaultTopK!==void 0||e.defaultPresencePenalty!==void 0||e.defaultFrequencyPenalty!==void 0,c=(u,d,h,m,y="N/A")=>{var b;return!l||m===void 0?null:f.jsxs(ot,{variant:"link",size:"sm",className:"text-xs h-auto p-0 mt-1 text-muted-foreground",onClick:()=>a(u,h,m??null),disabled:d===null,children:["Use Default (",((b=m==null?void 0:m.toFixed)==null?void 0:b.call(m,2))??y,")"]})};return f.jsxs("div",{className:Ye("space-y-4 p-4",t),children:[o.has("temperature")&&f.jsxs("div",{className:"space-y-0.5",children:[" ",f.jsx(Oc,{form:n,name:"temperature",label:"Temperature",min:0,max:1,step:.01,valueDisplayPrecision:2,onValueCommit:u=>s("temperature",e.setTemperature,u[0]),wrapperClassName:"text-xs"}),c("temperature",e.temperature,e.setTemperature,e.defaultTemperature,"0.70")]}),o.has("top_p")&&f.jsxs("div",{className:"space-y-0.5",children:[f.jsx(Oc,{form:n,name:"topP",label:"Top P",min:0,max:1,step:.01,valueDisplayPrecision:2,onValueCommit:u=>s("topP",e.setTopP,u[0]),wrapperClassName:"text-xs"}),c("topP",e.topP,e.setTopP,e.defaultTopP,"1.00")]}),f.jsxs("div",{className:"grid grid-cols-2 gap-4 items-start",children:[" ",o.has("max_tokens")&&f.jsxs("div",{className:"space-y-0.5",children:[f.jsx(Ly,{form:n,name:"maxTokens",label:"Max Tokens",placeholder:`Default: ${e.defaultMaxTokens??"None"}`,min:1,allowNull:!0,onBlurInput:()=>i("maxTokens",e.setMaxTokens),className:"h-8 text-xs",wrapperClassName:"text-xs"}),c("maxTokens",e.maxTokens,e.setMaxTokens,e.defaultMaxTokens,"None")]}),o.has("top_k")&&f.jsxs("div",{className:"space-y-0.5",children:[f.jsx(Ly,{form:n,name:"topK",label:"Top K",placeholder:`Default: ${e.defaultTopK??"None"}`,min:1,allowNull:!0,onBlurInput:()=>i("topK",e.setTopK),className:"h-8 text-xs",wrapperClassName:"text-xs"}),c("topK",e.topK,e.setTopK,e.defaultTopK,"None")]})]}),o.has("presence_penalty")&&f.jsxs("div",{className:"space-y-0.5",children:[f.jsx(Oc,{form:n,name:"presencePenalty",label:"Presence Penalty",min:-2,max:2,step:.01,valueDisplayPrecision:2,onValueCommit:u=>s("presencePenalty",e.setPresencePenalty,u[0]),wrapperClassName:"text-xs"}),c("presencePenalty",e.presencePenalty,e.setPresencePenalty,e.defaultPresencePenalty,"0.00")]}),o.has("frequency_penalty")&&f.jsxs("div",{className:"space-y-0.5",children:[f.jsx(Oc,{form:n,name:"frequencyPenalty",label:"Frequency Penalty",min:-2,max:2,step:.01,valueDisplayPrecision:2,onValueCommit:u=>s("frequencyPenalty",e.setFrequencyPenalty,u[0]),wrapperClassName:"text-xs"}),c("frequencyPenalty",e.frequencyPenalty,e.setFrequencyPenalty,e.defaultFrequencyPenalty,"0.00")]})]})},$Ue=({module:e})=>{const[,t]=E.useState({});E.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const n=e.getIsStreaming();return e.getIsVisible()?f.jsxs(gc,{children:[f.jsx(wr,{delayDuration:100,children:f.jsxs(Sr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(yc,{asChild:!0,children:f.jsx(ot,{variant:"ghost",size:"icon",className:"h-8 w-8",disabled:n,"aria-label":"Adjust Advanced Parameters",children:f.jsx(o0e,{className:"h-4 w-4"})})})}),f.jsx(Cr,{side:"top",children:"Advanced Parameters"})]})}),f.jsx(bc,{className:"w-auto p-0",align:"start",children:f.jsx(BUe,{module:e})})]}):null};class zUe{constructor(){ce(this,"id","core-parameters");ce(this,"unregisterCallback",null);ce(this,"eventUnsubscribers",[]);ce(this,"modApiRef",null);ce(this,"temperature",null);ce(this,"topP",null);ce(this,"maxTokens",null);ce(this,"topK",null);ce(this,"presencePenalty",null);ce(this,"frequencyPenalty",null);ce(this,"defaultTemperature",null);ce(this,"defaultTopP",null);ce(this,"defaultMaxTokens",null);ce(this,"defaultTopK",null);ce(this,"defaultPresencePenalty",null);ce(this,"defaultFrequencyPenalty",null);ce(this,"isStreaming",!1);ce(this,"isVisible",!0);ce(this,"supportedParams",new Set);ce(this,"notifyComponentUpdate",null);ce(this,"getIsStreaming",()=>this.isStreaming);ce(this,"getIsVisible",()=>this.isVisible);ce(this,"setTemperature",t=>{var n,r;this.temperature=t,(n=this.modApiRef)==null||n.emit(an.setTemperatureRequest,{value:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});ce(this,"setTopP",t=>{var n,r;this.topP=t,(n=this.modApiRef)==null||n.emit(an.setTopPRequest,{value:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});ce(this,"setMaxTokens",t=>{var n,r;this.maxTokens=t,(n=this.modApiRef)==null||n.emit(an.setMaxTokensRequest,{value:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});ce(this,"setTopK",t=>{var n,r;this.topK=t,(n=this.modApiRef)==null||n.emit(an.setTopKRequest,{value:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});ce(this,"setPresencePenalty",t=>{var n,r;this.presencePenalty=t,(n=this.modApiRef)==null||n.emit(an.setPresencePenaltyRequest,{value:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});ce(this,"setFrequencyPenalty",t=>{var n,r;this.frequencyPenalty=t,(n=this.modApiRef)==null||n.emit(an.setFrequencyPenaltyRequest,{value:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});ce(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){this.modApiRef=t,this.loadInitialState(),this.updateSupportedParams();const n=t.on(xn.statusChanged,a=>{var o;typeof a=="object"&&a&&"status"in a&&this.isStreaming!==(a.status==="streaming")&&(this.isStreaming=a.status==="streaming",(o=this.notifyComponentUpdate)==null||o.call(this))}),r=t.on(Vn.selectedModelChanged,()=>{var a;this.updateSupportedParams(),this.updateVisibility(),(a=this.notifyComponentUpdate)==null||a.call(this)}),s=t.on(on.enableAdvancedSettingsChanged,()=>{var a;this.updateVisibility(),(a=this.notifyComponentUpdate)==null||a.call(this)}),i=t.on(an.parameterChanged,a=>{var o;if(typeof a=="object"&&a&&"params"in a){const l=a.params;let c=!1;"temperature"in l&&this.temperature!==l.temperature&&(this.temperature=l.temperature??null,c=!0),"topP"in l&&this.topP!==l.topP&&(this.topP=l.topP??null,c=!0),"maxTokens"in l&&this.maxTokens!==l.maxTokens&&(this.maxTokens=l.maxTokens??null,c=!0),"topK"in l&&this.topK!==l.topK&&(this.topK=l.topK??null,c=!0),"presencePenalty"in l&&this.presencePenalty!==l.presencePenalty&&(this.presencePenalty=l.presencePenalty??null,c=!0),"frequencyPenalty"in l&&this.frequencyPenalty!==l.frequencyPenalty&&(this.frequencyPenalty=l.frequencyPenalty??null,c=!0),c&&((o=this.notifyComponentUpdate)==null||o.call(this))}});this.eventUnsubscribers.push(n,r,s,i)}loadInitialState(){const t=pr.getState(),n=co.getState();this.isStreaming=nn.getState().status==="streaming",this.temperature=n.temperature,this.topP=n.topP,this.maxTokens=n.maxTokens,this.topK=n.topK,this.presencePenalty=n.presencePenalty,this.frequencyPenalty=n.frequencyPenalty,this.defaultTemperature=t.temperature,this.defaultTopP=t.topP,this.defaultMaxTokens=t.maxTokens,this.defaultTopK=t.topK,this.defaultPresencePenalty=t.presencePenalty,this.defaultFrequencyPenalty=t.frequencyPenalty,this.updateVisibility()}updateSupportedParams(){var o;const t=Gn.getState();if(!t.selectedModelId){this.supportedParams=new Set;return}const{providerId:n,modelId:r}=Ql(t.selectedModelId);if(!n||!r){this.supportedParams=new Set;return}const s=t.dbProviderConfigs.find(l=>l.id===n);if(!s){this.supportedParams=new Set;return}const i=t.dbApiKeys.find(l=>l.id===s.apiKeyId),a=sK(s,r,i==null?void 0:i.value);this.supportedParams=new Set(((o=a==null?void 0:a.metadata)==null?void 0:o.supported_parameters)??[])}updateVisibility(){const r=pr.getState().enableAdvancedSettings&&["temperature","top_p","max_tokens","top_k","presence_penalty","frequency_penalty"].some(s=>this.supportedParams.has(s));this.isVisible!==r&&(this.isVisible=r)}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>Ve.createElement($Ue,{module:this}),getParameters:()=>{const n={},r=(s,i)=>{i!==null&&(n[s]=i)};return r("temperature",this.temperature),r("top_p",this.topP),r("max_tokens",this.maxTokens),r("top_k",this.topK),r("presence_penalty",this.presencePenalty),r("frequency_penalty",this.frequencyPenalty),Object.keys(n).length>0?n:void 0}})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const UUe=({module:e})=>{const t=E.useRef(null),[,n]=E.useState({});E.useEffect(()=>(e.setNotifyCallback(()=>n({})),()=>e.setNotifyCallback(null)),[e]);const r=e.getIsStreaming(),s=e.getModelSupportsNonText(),i=E.useCallback(async l=>{const c=l.target.files;if(c){for(const u of Array.from(c))try{let d={};const h=e.isLikelyTextFile(u.name,u.type),m=u.type.startsWith("image/");if(h)d.contentText=await u.text();else if(m&&s){const y=new FileReader,b=new Promise((x,w)=>{y.onload=()=>x(y.result),y.onerror=_=>w(_)});y.readAsDataURL(u);const v=await b;v&&v.includes(",")&&(d.contentBase64=v.split(",")[1])}e.onFileAdd({source:"direct",name:u.name,type:u.type||"application/octet-stream",size:u.size,...d})}catch(d){console.error(`Error processing file ${u.name}:`,d),ke.error(`Failed to process file "${u.name}": ${d instanceof Error?d.message:String(d)}`)}l.target&&(l.target.value="")}},[e,s]),a=()=>{var l;(l=t.current)==null||l.click()},o=s?"Attach Files (Text, Images, etc.)":"Attach Text Files";return f.jsxs(f.Fragment,{children:[f.jsx("input",{type:"file",ref:t,onChange:i,multiple:!0,className:"hidden",disabled:r}),f.jsx(wr,{delayDuration:100,children:f.jsxs(Sr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(ot,{type:"button",variant:"ghost",size:"icon",onClick:a,disabled:r,className:"h-8 w-8","aria-label":o,children:f.jsx(RE,{className:"h-4 w-4"})})}),f.jsx(Cr,{side:"top",children:o})]})})]})},qUe=({module:e})=>{const[,t]=E.useState({}),n=e.getAttachedFiles(),r=e.getIsStreaming();return E.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]),n.length===0?null:f.jsx("div",{className:Ye("max-h-40 overflow-y-auto pr-1","flex flex-wrap gap-1"),children:n.map(s=>f.jsx(XZ,{fileMeta:s,onRemove:e.onFileRemove,isReadOnly:r},s.id))})},rse=20,VUe=rse*1024*1024;class WUe{constructor(){ce(this,"id","core-file-attachment");ce(this,"unregisterCallback",null);ce(this,"eventUnsubscribers",[]);ce(this,"modApiRef",null);ce(this,"isStreaming",!1);ce(this,"modelSupportsNonText",!0);ce(this,"attachedFiles",[]);ce(this,"notifyComponentUpdate",null);ce(this,"getIsStreaming",()=>this.isStreaming);ce(this,"getModelSupportsNonText",()=>this.modelSupportsNonText);ce(this,"getAttachedFiles",()=>this.attachedFiles);ce(this,"isLikelyTextFile",(t,n)=>ow(t,n));ce(this,"onFileAdd",t=>{var r;if(t.size>VUe){ke.error(`File "${t.name}" exceeds the ${rse}MB limit.`);return}if(!ow(t.name,t.type)&&!this.modelSupportsNonText){ke.warning(`File "${t.name}" (${t.type}) cannot be uploaded. The current model only supports text input.`);return}(r=this.modApiRef)==null||r.emit(Yl.addAttachedFileRequest,t)});ce(this,"onFileRemove",t=>{var n;(n=this.modApiRef)==null||n.emit(Yl.removeAttachedFileRequest,{attachmentId:t})});ce(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){var i;this.modApiRef=t,this.isStreaming=nn.getState().status==="streaming",this.attachedFiles=Ph.getState().attachedFilesMetadata,this.updateModelSupport(),(i=this.notifyComponentUpdate)==null||i.call(this);const n=t.on(xn.statusChanged,a=>{var o;typeof a=="object"&&a&&"status"in a&&this.isStreaming!==(a.status==="streaming")&&(this.isStreaming=a.status==="streaming",(o=this.notifyComponentUpdate)==null||o.call(this))}),r=t.on(Vn.selectedModelChanged,()=>{var a;this.updateModelSupport(),(a=this.notifyComponentUpdate)==null||a.call(this)}),s=t.on(Yl.attachedFilesChanged,a=>{var o;typeof a=="object"&&a&&"files"in a&&JSON.stringify(this.attachedFiles)!==JSON.stringify(a.files)&&(this.attachedFiles=a.files,(o=this.notifyComponentUpdate)==null||o.call(this))});this.eventUnsubscribers.push(n,r,s)}updateModelSupport(){var i,a;const{getSelectedModel:t}=Gn.getState(),n=t(),r=(a=(i=n==null?void 0:n.metadata)==null?void 0:i.architecture)==null?void 0:a.input_modalities,s=!r||r.some(o=>o!=="text");this.modelSupportsNonText!==s&&(this.modelSupportsNonText=s)}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,triggerRenderer:()=>Ve.createElement(UUe,{module:this}),renderer:()=>Ve.createElement(qUe,{module:this})})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const HUe=({module:e})=>{const[,t]=E.useState({});E.useEffect(()=>{if(e&&typeof e.setNotifyTriggerUpdate=="function")return e.setNotifyTriggerUpdate(()=>t({})),()=>{e&&typeof e.setNotifyTriggerUpdate=="function"&&e.setNotifyTriggerUpdate(null)}},[e]);const n=e&&typeof e.getIsVfsModalOpen=="function"?e.getIsVfsModalOpen():!1,r=e&&typeof e.getSelectedFileIdsCount=="function"?e.getSelectedFileIdsCount():0,s=e&&typeof e.getEnableVfs=="function"?e.getEnableVfs():!1,i=Ph.getState().addAttachedFile,a=()=>{const o=ti.getState().selectedFileIds;if(o.size===0){ke.info("No files selected in VFS to attach.");return}let l=0;const c=e.getVfsNodes();o.forEach(u=>{const d=c[u];d&&d.type==="file"&&(i({source:"vfs",name:d.name,type:d.mimeType||"application/octet-stream",size:d.size,path:d.path}),l++)}),l>0?(ke.success(`Attached ${l} file(s) from VFS to the next prompt.`),typeof e.clearVfsSelection=="function"&&e.clearVfsSelection(),e.toggleVfsModal):ke.warning("No valid files were selected to attach.")};return s?f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx(wr,{delayDuration:100,children:f.jsxs(Sr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(ot,{variant:"ghost",size:"icon",className:Ye("h-8 w-8",n&&"bg-muted text-primary"),onClick:()=>e&&typeof e.toggleVfsModal=="function"&&e.toggleVfsModal(),"aria-label":"Toggle Virtual File System",children:f.jsx(eO,{className:"h-4 w-4"})})}),f.jsx(Cr,{side:"top",children:"Virtual Filesystem"})]})}),r>0&&f.jsx(wr,{delayDuration:100,children:f.jsxs(Sr,{children:[f.jsx(_r,{asChild:!0,children:f.jsxs(ot,{variant:"secondary",size:"sm",className:"h-8 animate-fadeIn px-2",onClick:a,"aria-label":`Attach ${r} selected VFS file(s)`,children:[f.jsx(RE,{className:"h-4 w-4 mr-1"}),"Attach (",r,")"]})}),f.jsx(Cr,{side:"top",children:"Attach selected VFS files to prompt"})]})})]}):null};function Sf({className:e,...t}){return f.jsx("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:f.jsx("table",{"data-slot":"table",className:Ye("w-full caption-bottom text-sm",e),...t})})}function vp({className:e,...t}){return f.jsx("thead",{"data-slot":"table-header",className:Ye("[&_tr]:border-b",e),...t})}function _f({className:e,...t}){return f.jsx("tbody",{"data-slot":"table-body",className:Ye("[&_tr:last-child]:border-0",e),...t})}function As({className:e,...t}){return f.jsx("tr",{"data-slot":"table-row",className:Ye("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",e),...t})}function Rr({className:e,...t}){return f.jsx("th",{"data-slot":"table-head",className:Ye("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...t})}function Bn({className:e,...t}){return f.jsx("td",{"data-slot":"table-cell",className:Ye("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...t})}function GUe({className:e,...t}){return f.jsx("caption",{"data-slot":"table-caption",className:Ye("text-muted-foreground mt-4 text-sm",e),...t})}const sse=({newFolderName:e,setNewFolderName:t,handleCreateFolder:n,cancelCreatingFolder:r,newFolderInputRef:s,isOperationLoading:i,isMobile:a=!1})=>{const o=l=>{l.key==="Enter"?n():l.key==="Escape"&&r()};return a?f.jsxs("div",{className:"flex items-center gap-2 p-1",children:[f.jsx(Ih,{className:"h-5 w-5 text-yellow-400 flex-shrink-0"}),f.jsx(vn,{ref:s,value:e,onChange:l=>t(l.target.value),onBlur:n,onKeyDown:o,className:"h-7 px-2 py-1 text-sm bg-input border-border focus:ring-1 focus:ring-primary flex-grow",placeholder:"New folder name",disabled:i}),f.jsxs("div",{className:"flex items-center gap-0.5 flex-shrink-0",children:[f.jsx(ot,{variant:"ghost",size:"icon",className:"h-7 w-7 text-green-500 hover:text-green-400",onClick:n,"aria-label":"Create folder",disabled:i||!e.trim(),children:i?f.jsx(Hn,{className:"h-4 w-4 animate-spin"}):f.jsx(bo,{className:"h-4 w-4"})}),f.jsx(ot,{variant:"ghost",size:"icon",className:"h-7 w-7 text-muted-foreground hover:text-foreground",onClick:r,"aria-label":"Cancel create folder",disabled:i,children:f.jsx(Si,{className:"h-4 w-4"})})]})]}):f.jsxs(As,{className:"bg-muted/30",children:[f.jsx(Bn,{className:"px-2 py-1"}),f.jsx(Bn,{className:"px-2 py-1",children:f.jsx(Ih,{className:"h-5 w-5 text-yellow-400"})}),f.jsx(Bn,{className:"py-1 px-2",colSpan:3,children:f.jsx(vn,{ref:s,value:e,onChange:l=>t(l.target.value),onBlur:n,onKeyDown:o,className:"h-7 px-2 py-1 text-sm bg-input border-border focus:ring-1 focus:ring-primary w-full",placeholder:"New folder name",disabled:i})}),f.jsx(Bn,{className:"text-right pr-4 py-1",children:f.jsxs("div",{className:"flex items-center justify-end gap-0.5",children:[f.jsx(wr,{delayDuration:100,children:f.jsxs(Sr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(ot,{variant:"ghost",size:"icon",className:"h-6 w-6 text-green-500 hover:text-green-400",onClick:n,"aria-label":"Create folder",disabled:i||!e.trim(),children:i?f.jsx(Hn,{className:"h-4 w-4 animate-spin"}):f.jsx(bo,{className:"h-4 w-4"})})}),f.jsx(Cr,{side:"top",children:"Create (Enter)"})]})}),f.jsx(wr,{delayDuration:100,children:f.jsxs(Sr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(ot,{variant:"ghost",size:"icon",className:"h-6 w-6 text-muted-foreground hover:text-foreground",onClick:r,"aria-label":"Cancel create folder",disabled:i,children:f.jsx(Si,{className:"h-4 w-4"})})}),f.jsx(Cr,{side:"top",children:"Cancel (Esc)"})]})})]})})]})};function KUe(e){const t=YUe(e),n=E.forwardRef((r,s)=>{const{children:i,...a}=r,o=E.Children.toArray(i),l=o.find(XUe);if(l){const c=l.props.children,u=o.map(d=>d===l?E.Children.count(c)>1?E.Children.only(null):E.isValidElement(c)?c.props.children:null:d);return f.jsx(t,{...a,ref:s,children:E.isValidElement(c)?E.cloneElement(c,void 0,u):null})}return f.jsx(t,{...a,ref:s,children:i})});return n.displayName=`${e}.Slot`,n}function YUe(e){const t=E.forwardRef((n,r)=>{const{children:s,...i}=n;if(E.isValidElement(s)){const a=QUe(s),o=JUe(i,s.props);return s.type!==E.Fragment&&(o.ref=r?wl(r,a):a),E.cloneElement(s,o)}return E.Children.count(s)>1?E.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var ZUe=Symbol("radix.slottable");function XUe(e){return E.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===ZUe}function JUe(e,t){const n={...t};for(const r in t){const s=e[r],i=t[r];/^on[A-Z]/.test(r)?s&&i?n[r]=(...o)=>{i(...o),s(...o)}:s&&(n[r]=s):r==="style"?n[r]={...s,...i}:r==="className"&&(n[r]=[s,i].filter(Boolean).join(" "))}return{...e,...n}}function QUe(e){var r,s;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(s=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:s.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var VP=["Enter"," "],eqe=["ArrowDown","PageUp","Home"],ise=["ArrowUp","PageDown","End"],tqe=[...eqe,...ise],nqe={ltr:[...VP,"ArrowRight"],rtl:[...VP,"ArrowLeft"]},rqe={ltr:["ArrowLeft"],rtl:["ArrowRight"]},gS="Menu",[a1,sqe,iqe]=yF(gS),[fg,XT]=Ei(gS,[iqe,WE,Eb]),JT=WE(),ase=Eb(),[aqe,hg]=fg(gS),[oqe,yS]=fg(gS),ose=e=>{const{__scopeMenu:t,open:n=!1,children:r,dir:s,onOpenChange:i,modal:a=!0}=e,o=JT(t),[l,c]=E.useState(null),u=E.useRef(!1),d=Ts(i),h=cg(s);return E.useEffect(()=>{const m=()=>{u.current=!0,document.addEventListener("pointerdown",y,{capture:!0,once:!0}),document.addEventListener("pointermove",y,{capture:!0,once:!0})},y=()=>u.current=!1;return document.addEventListener("keydown",m,{capture:!0}),()=>{document.removeEventListener("keydown",m,{capture:!0}),document.removeEventListener("pointerdown",y,{capture:!0}),document.removeEventListener("pointermove",y,{capture:!0})}},[]),f.jsx(RK,{...o,children:f.jsx(aqe,{scope:t,open:n,onOpenChange:d,content:l,onContentChange:c,children:f.jsx(oqe,{scope:t,onClose:E.useCallback(()=>d(!1),[d]),isUsingKeyboardRef:u,dir:h,modal:a,children:r})})})};ose.displayName=gS;var lqe="MenuAnchor",c6=E.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e,s=JT(n);return f.jsx(NK,{...s,...r,ref:t})});c6.displayName=lqe;var u6="MenuPortal",[cqe,lse]=fg(u6,{forceMount:void 0}),cse=e=>{const{__scopeMenu:t,forceMount:n,children:r,container:s}=e,i=hg(u6,t);return f.jsx(cqe,{scope:t,forceMount:n,children:f.jsx(ea,{present:n||i.open,children:f.jsx(HE,{asChild:!0,container:s,children:r})})})};cse.displayName=u6;var tc="MenuContent",[uqe,d6]=fg(tc),use=E.forwardRef((e,t)=>{const n=lse(tc,e.__scopeMenu),{forceMount:r=n.forceMount,...s}=e,i=hg(tc,e.__scopeMenu),a=yS(tc,e.__scopeMenu);return f.jsx(a1.Provider,{scope:e.__scopeMenu,children:f.jsx(ea,{present:r||i.open,children:f.jsx(a1.Slot,{scope:e.__scopeMenu,children:a.modal?f.jsx(dqe,{...s,ref:t}):f.jsx(fqe,{...s,ref:t})})})})}),dqe=E.forwardRef((e,t)=>{const n=hg(tc,e.__scopeMenu),r=E.useRef(null),s=Tn(t,r);return E.useEffect(()=>{const i=r.current;if(i)return PT(i)},[]),f.jsx(f6,{...e,ref:s,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:Wt(e.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)})}),fqe=E.forwardRef((e,t)=>{const n=hg(tc,e.__scopeMenu);return f.jsx(f6,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)})}),hqe=KUe("MenuContent.ScrollLock"),f6=E.forwardRef((e,t)=>{const{__scopeMenu:n,loop:r=!1,trapFocus:s,onOpenAutoFocus:i,onCloseAutoFocus:a,disableOutsidePointerEvents:o,onEntryFocus:l,onEscapeKeyDown:c,onPointerDownOutside:u,onFocusOutside:d,onInteractOutside:h,onDismiss:m,disableOutsideScroll:y,...b}=e,v=hg(tc,n),x=yS(tc,n),w=JT(n),_=ase(n),k=sqe(n),[C,T]=E.useState(null),A=E.useRef(null),N=Tn(t,A,v.onContentChange),I=E.useRef(0),j=E.useRef(""),L=E.useRef(0),D=E.useRef(null),H=E.useRef("right"),O=E.useRef(0),K=y?oS:E.Fragment,U=y?{as:hqe,allowPinchZoom:!0}:void 0,W=ne=>{var je,Te;const V=j.current+ne,Q=k().filter(_e=>!_e.disabled),ee=document.activeElement,re=(je=Q.find(_e=>_e.ref.current===ee))==null?void 0:je.textValue,de=Q.map(_e=>_e.textValue),me=kqe(de,V,re),De=(Te=Q.find(_e=>_e.textValue===me))==null?void 0:Te.ref.current;(function _e(Ue){j.current=Ue,window.clearTimeout(I.current),Ue!==""&&(I.current=window.setTimeout(()=>_e(""),1e3))})(V),De&&setTimeout(()=>De.focus())};E.useEffect(()=>()=>window.clearTimeout(I.current),[]),jT();const B=E.useCallback(ne=>{var Q,ee;return H.current===((Q=D.current)==null?void 0:Q.side)&&Tqe(ne,(ee=D.current)==null?void 0:ee.area)},[]);return f.jsx(uqe,{scope:n,searchRef:j,onItemEnter:E.useCallback(ne=>{B(ne)&&ne.preventDefault()},[B]),onItemLeave:E.useCallback(ne=>{var V;B(ne)||((V=A.current)==null||V.focus(),T(null))},[B]),onTriggerLeave:E.useCallback(ne=>{B(ne)&&ne.preventDefault()},[B]),pointerGraceTimerRef:L,onPointerGraceIntentChange:E.useCallback(ne=>{D.current=ne},[]),children:f.jsx(K,{...U,children:f.jsx(n6,{asChild:!0,trapped:s,onMountAutoFocus:Wt(i,ne=>{var V;ne.preventDefault(),(V=A.current)==null||V.focus({preventScroll:!0})}),onUnmountAutoFocus:a,children:f.jsx(zE,{asChild:!0,disableOutsidePointerEvents:o,onEscapeKeyDown:c,onPointerDownOutside:u,onFocusOutside:d,onInteractOutside:h,onDismiss:m,children:f.jsx(a6,{asChild:!0,..._,dir:x.dir,orientation:"vertical",loop:r,currentTabStopId:C,onCurrentTabStopIdChange:T,onEntryFocus:Wt(l,ne=>{x.isUsingKeyboardRef.current||ne.preventDefault()}),preventScrollOnEntryFocus:!0,children:f.jsx(IK,{role:"menu","aria-orientation":"vertical","data-state":Ese(v.open),"data-radix-menu-content":"",dir:x.dir,...w,...b,ref:N,style:{outline:"none",...b.style},onKeyDown:Wt(b.onKeyDown,ne=>{const Q=ne.target.closest("[data-radix-menu-content]")===ne.currentTarget,ee=ne.ctrlKey||ne.altKey||ne.metaKey,re=ne.key.length===1;Q&&(ne.key==="Tab"&&ne.preventDefault(),!ee&&re&&W(ne.key));const de=A.current;if(ne.target!==de||!tqe.includes(ne.key))return;ne.preventDefault();const De=k().filter(je=>!je.disabled).map(je=>je.ref.current);ise.includes(ne.key)&&De.reverse(),_qe(De)}),onBlur:Wt(e.onBlur,ne=>{ne.currentTarget.contains(ne.target)||(window.clearTimeout(I.current),j.current="")}),onPointerMove:Wt(e.onPointerMove,o1(ne=>{const V=ne.target,Q=O.current!==ne.clientX;if(ne.currentTarget.contains(V)&&Q){const ee=ne.clientX>O.current?"right":"left";H.current=ee,O.current=ne.clientX}}))})})})})})})});use.displayName=tc;var pqe="MenuGroup",h6=E.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return f.jsx(Kn.div,{role:"group",...r,ref:t})});h6.displayName=pqe;var mqe="MenuLabel",dse=E.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return f.jsx(Kn.div,{...r,ref:t})});dse.displayName=mqe;var Bk="MenuItem",Xq="menu.itemSelect",QT=E.forwardRef((e,t)=>{const{disabled:n=!1,onSelect:r,...s}=e,i=E.useRef(null),a=yS(Bk,e.__scopeMenu),o=d6(Bk,e.__scopeMenu),l=Tn(t,i),c=E.useRef(!1),u=()=>{const d=i.current;if(!n&&d){const h=new CustomEvent(Xq,{bubbles:!0,cancelable:!0});d.addEventListener(Xq,m=>r==null?void 0:r(m),{once:!0}),aK(d,h),h.defaultPrevented?c.current=!1:a.onClose()}};return f.jsx(fse,{...s,ref:l,disabled:n,onClick:Wt(e.onClick,u),onPointerDown:d=>{var h;(h=e.onPointerDown)==null||h.call(e,d),c.current=!0},onPointerUp:Wt(e.onPointerUp,d=>{var h;c.current||(h=d.currentTarget)==null||h.click()}),onKeyDown:Wt(e.onKeyDown,d=>{const h=o.searchRef.current!=="";n||h&&d.key===" "||VP.includes(d.key)&&(d.currentTarget.click(),d.preventDefault())})})});QT.displayName=Bk;var fse=E.forwardRef((e,t)=>{const{__scopeMenu:n,disabled:r=!1,textValue:s,...i}=e,a=d6(Bk,n),o=ase(n),l=E.useRef(null),c=Tn(t,l),[u,d]=E.useState(!1),[h,m]=E.useState("");return E.useEffect(()=>{const y=l.current;y&&m((y.textContent??"").trim())},[i.children]),f.jsx(a1.ItemSlot,{scope:n,disabled:r,textValue:s??h,children:f.jsx(o6,{asChild:!0,...o,focusable:!r,children:f.jsx(Kn.div,{role:"menuitem","data-highlighted":u?"":void 0,"aria-disabled":r||void 0,"data-disabled":r?"":void 0,...i,ref:c,onPointerMove:Wt(e.onPointerMove,o1(y=>{r?a.onItemLeave(y):(a.onItemEnter(y),y.defaultPrevented||y.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:Wt(e.onPointerLeave,o1(y=>a.onItemLeave(y))),onFocus:Wt(e.onFocus,()=>d(!0)),onBlur:Wt(e.onBlur,()=>d(!1))})})})}),gqe="MenuCheckboxItem",hse=E.forwardRef((e,t)=>{const{checked:n=!1,onCheckedChange:r,...s}=e;return f.jsx(bse,{scope:e.__scopeMenu,checked:n,children:f.jsx(QT,{role:"menuitemcheckbox","aria-checked":$k(n)?"mixed":n,...s,ref:t,"data-state":m6(n),onSelect:Wt(s.onSelect,()=>r==null?void 0:r($k(n)?!0:!n),{checkForDefaultPrevented:!1})})})});hse.displayName=gqe;var pse="MenuRadioGroup",[yqe,bqe]=fg(pse,{value:void 0,onValueChange:()=>{}}),mse=E.forwardRef((e,t)=>{const{value:n,onValueChange:r,...s}=e,i=Ts(r);return f.jsx(yqe,{scope:e.__scopeMenu,value:n,onValueChange:i,children:f.jsx(h6,{...s,ref:t})})});mse.displayName=pse;var gse="MenuRadioItem",yse=E.forwardRef((e,t)=>{const{value:n,...r}=e,s=bqe(gse,e.__scopeMenu),i=n===s.value;return f.jsx(bse,{scope:e.__scopeMenu,checked:i,children:f.jsx(QT,{role:"menuitemradio","aria-checked":i,...r,ref:t,"data-state":m6(i),onSelect:Wt(r.onSelect,()=>{var a;return(a=s.onValueChange)==null?void 0:a.call(s,n)},{checkForDefaultPrevented:!1})})})});yse.displayName=gse;var p6="MenuItemIndicator",[bse,vqe]=fg(p6,{checked:!1}),vse=E.forwardRef((e,t)=>{const{__scopeMenu:n,forceMount:r,...s}=e,i=vqe(p6,n);return f.jsx(ea,{present:r||$k(i.checked)||i.checked===!0,children:f.jsx(Kn.span,{...s,ref:t,"data-state":m6(i.checked)})})});vse.displayName=p6;var xqe="MenuSeparator",xse=E.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return f.jsx(Kn.div,{role:"separator","aria-orientation":"horizontal",...r,ref:t})});xse.displayName=xqe;var wqe="MenuArrow",wse=E.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e,s=JT(n);return f.jsx(MK,{...s,...r,ref:t})});wse.displayName=wqe;var Sqe="MenuSub",[Uft,Sse]=fg(Sqe),kx="MenuSubTrigger",_se=E.forwardRef((e,t)=>{const n=hg(kx,e.__scopeMenu),r=yS(kx,e.__scopeMenu),s=Sse(kx,e.__scopeMenu),i=d6(kx,e.__scopeMenu),a=E.useRef(null),{pointerGraceTimerRef:o,onPointerGraceIntentChange:l}=i,c={__scopeMenu:e.__scopeMenu},u=E.useCallback(()=>{a.current&&window.clearTimeout(a.current),a.current=null},[]);return E.useEffect(()=>u,[u]),E.useEffect(()=>{const d=o.current;return()=>{window.clearTimeout(d),l(null)}},[o,l]),f.jsx(c6,{asChild:!0,...c,children:f.jsx(fse,{id:s.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":s.contentId,"data-state":Ese(n.open),...e,ref:wl(t,s.onTriggerChange),onClick:d=>{var h;(h=e.onClick)==null||h.call(e,d),!(e.disabled||d.defaultPrevented)&&(d.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:Wt(e.onPointerMove,o1(d=>{i.onItemEnter(d),!d.defaultPrevented&&!e.disabled&&!n.open&&!a.current&&(i.onPointerGraceIntentChange(null),a.current=window.setTimeout(()=>{n.onOpenChange(!0),u()},100))})),onPointerLeave:Wt(e.onPointerLeave,o1(d=>{var m,y;u();const h=(m=n.content)==null?void 0:m.getBoundingClientRect();if(h){const b=(y=n.content)==null?void 0:y.dataset.side,v=b==="right",x=v?-5:5,w=h[v?"left":"right"],_=h[v?"right":"left"];i.onPointerGraceIntentChange({area:[{x:d.clientX+x,y:d.clientY},{x:w,y:h.top},{x:_,y:h.top},{x:_,y:h.bottom},{x:w,y:h.bottom}],side:b}),window.clearTimeout(o.current),o.current=window.setTimeout(()=>i.onPointerGraceIntentChange(null),300)}else{if(i.onTriggerLeave(d),d.defaultPrevented)return;i.onPointerGraceIntentChange(null)}})),onKeyDown:Wt(e.onKeyDown,d=>{var m;const h=i.searchRef.current!=="";e.disabled||h&&d.key===" "||nqe[r.dir].includes(d.key)&&(n.onOpenChange(!0),(m=n.content)==null||m.focus(),d.preventDefault())})})})});_se.displayName=kx;var Cse="MenuSubContent",kse=E.forwardRef((e,t)=>{const n=lse(tc,e.__scopeMenu),{forceMount:r=n.forceMount,...s}=e,i=hg(tc,e.__scopeMenu),a=yS(tc,e.__scopeMenu),o=Sse(Cse,e.__scopeMenu),l=E.useRef(null),c=Tn(t,l);return f.jsx(a1.Provider,{scope:e.__scopeMenu,children:f.jsx(ea,{present:r||i.open,children:f.jsx(a1.Slot,{scope:e.__scopeMenu,children:f.jsx(f6,{id:o.contentId,"aria-labelledby":o.triggerId,...s,ref:c,align:"start",side:a.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:u=>{var d;a.isUsingKeyboardRef.current&&((d=l.current)==null||d.focus()),u.preventDefault()},onCloseAutoFocus:u=>u.preventDefault(),onFocusOutside:Wt(e.onFocusOutside,u=>{u.target!==o.trigger&&i.onOpenChange(!1)}),onEscapeKeyDown:Wt(e.onEscapeKeyDown,u=>{a.onClose(),u.preventDefault()}),onKeyDown:Wt(e.onKeyDown,u=>{var m;const d=u.currentTarget.contains(u.target),h=rqe[a.dir].includes(u.key);d&&h&&(i.onOpenChange(!1),(m=o.trigger)==null||m.focus(),u.preventDefault())})})})})})});kse.displayName=Cse;function Ese(e){return e?"open":"closed"}function $k(e){return e==="indeterminate"}function m6(e){return $k(e)?"indeterminate":e?"checked":"unchecked"}function _qe(e){const t=document.activeElement;for(const n of e)if(n===t||(n.focus(),document.activeElement!==t))return}function Cqe(e,t){return e.map((n,r)=>e[(t+r)%e.length])}function kqe(e,t,n){const s=t.length>1&&Array.from(t).every(c=>c===t[0])?t[0]:t,i=n?e.indexOf(n):-1;let a=Cqe(e,Math.max(i,0));s.length===1&&(a=a.filter(c=>c!==n));const l=a.find(c=>c.toLowerCase().startsWith(s.toLowerCase()));return l!==n?l:void 0}function Eqe(e,t){const{x:n,y:r}=e;let s=!1;for(let i=0,a=t.length-1;i<t.length;a=i++){const o=t[i],l=t[a],c=o.x,u=o.y,d=l.x,h=l.y;u>r!=h>r&&n<(d-c)*(r-u)/(h-u)+c&&(s=!s)}return s}function Tqe(e,t){if(!t)return!1;const n={x:e.clientX,y:e.clientY};return Eqe(n,t)}function o1(e){return t=>t.pointerType==="mouse"?e(t):void 0}var Tse=ose,Ase=c6,Rse=cse,Nse=use,Ise=h6,Mse=dse,jse=QT,Pse=hse,Ose=mse,Dse=yse,Fse=vse,Lse=xse,Bse=wse,$se=_se,zse=kse,g6="ContextMenu",[Aqe,qft]=Ei(g6,[XT]),Ao=XT(),[Rqe,Use]=Aqe(g6),qse=e=>{const{__scopeContextMenu:t,children:n,onOpenChange:r,dir:s,modal:i=!0}=e,[a,o]=E.useState(!1),l=Ao(t),c=Ts(r),u=E.useCallback(d=>{o(d),c(d)},[c]);return f.jsx(Rqe,{scope:t,open:a,onOpenChange:u,modal:i,children:f.jsx(Tse,{...l,dir:s,open:a,onOpenChange:u,modal:i,children:n})})};qse.displayName=g6;var Vse="ContextMenuTrigger",Wse=E.forwardRef((e,t)=>{const{__scopeContextMenu:n,disabled:r=!1,...s}=e,i=Use(Vse,n),a=Ao(n),o=E.useRef({x:0,y:0}),l=E.useRef({getBoundingClientRect:()=>DOMRect.fromRect({width:0,height:0,...o.current})}),c=E.useRef(0),u=E.useCallback(()=>window.clearTimeout(c.current),[]),d=h=>{o.current={x:h.clientX,y:h.clientY},i.onOpenChange(!0)};return E.useEffect(()=>u,[u]),E.useEffect(()=>void(r&&u()),[r,u]),f.jsxs(f.Fragment,{children:[f.jsx(Ase,{...a,virtualRef:l}),f.jsx(Kn.span,{"data-state":i.open?"open":"closed","data-disabled":r?"":void 0,...s,ref:t,style:{WebkitTouchCallout:"none",...e.style},onContextMenu:r?e.onContextMenu:Wt(e.onContextMenu,h=>{u(),d(h),h.preventDefault()}),onPointerDown:r?e.onPointerDown:Wt(e.onPointerDown,CC(h=>{u(),c.current=window.setTimeout(()=>d(h),700)})),onPointerMove:r?e.onPointerMove:Wt(e.onPointerMove,CC(u)),onPointerCancel:r?e.onPointerCancel:Wt(e.onPointerCancel,CC(u)),onPointerUp:r?e.onPointerUp:Wt(e.onPointerUp,CC(u))})]})});Wse.displayName=Vse;var Nqe="ContextMenuPortal",Hse=e=>{const{__scopeContextMenu:t,...n}=e,r=Ao(t);return f.jsx(Rse,{...r,...n})};Hse.displayName=Nqe;var Gse="ContextMenuContent",Kse=E.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=Use(Gse,n),i=Ao(n),a=E.useRef(!1);return f.jsx(Nse,{...i,...r,ref:t,side:"right",sideOffset:2,align:"start",onCloseAutoFocus:o=>{var l;(l=e.onCloseAutoFocus)==null||l.call(e,o),!o.defaultPrevented&&a.current&&o.preventDefault(),a.current=!1},onInteractOutside:o=>{var l;(l=e.onInteractOutside)==null||l.call(e,o),!o.defaultPrevented&&!s.modal&&(a.current=!0)},style:{...e.style,"--radix-context-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-context-menu-content-available-width":"var(--radix-popper-available-width)","--radix-context-menu-content-available-height":"var(--radix-popper-available-height)","--radix-context-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-context-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});Kse.displayName=Gse;var Iqe="ContextMenuGroup",Mqe=E.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=Ao(n);return f.jsx(Ise,{...s,...r,ref:t})});Mqe.displayName=Iqe;var jqe="ContextMenuLabel",Pqe=E.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=Ao(n);return f.jsx(Mse,{...s,...r,ref:t})});Pqe.displayName=jqe;var Oqe="ContextMenuItem",Yse=E.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=Ao(n);return f.jsx(jse,{...s,...r,ref:t})});Yse.displayName=Oqe;var Dqe="ContextMenuCheckboxItem",Fqe=E.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=Ao(n);return f.jsx(Pse,{...s,...r,ref:t})});Fqe.displayName=Dqe;var Lqe="ContextMenuRadioGroup",Bqe=E.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=Ao(n);return f.jsx(Ose,{...s,...r,ref:t})});Bqe.displayName=Lqe;var $qe="ContextMenuRadioItem",zqe=E.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=Ao(n);return f.jsx(Dse,{...s,...r,ref:t})});zqe.displayName=$qe;var Uqe="ContextMenuItemIndicator",qqe=E.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=Ao(n);return f.jsx(Fse,{...s,...r,ref:t})});qqe.displayName=Uqe;var Vqe="ContextMenuSeparator",Zse=E.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=Ao(n);return f.jsx(Lse,{...s,...r,ref:t})});Zse.displayName=Vqe;var Wqe="ContextMenuArrow",Hqe=E.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=Ao(n);return f.jsx(Bse,{...s,...r,ref:t})});Hqe.displayName=Wqe;var Gqe="ContextMenuSubTrigger",Kqe=E.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=Ao(n);return f.jsx($se,{...s,...r,ref:t})});Kqe.displayName=Gqe;var Yqe="ContextMenuSubContent",Zqe=E.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=Ao(n);return f.jsx(zse,{...s,...r,ref:t,style:{...e.style,"--radix-context-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-context-menu-content-available-width":"var(--radix-popper-available-width)","--radix-context-menu-content-available-height":"var(--radix-popper-available-height)","--radix-context-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-context-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});Zqe.displayName=Yqe;function CC(e){return t=>t.pointerType!=="mouse"?e(t):void 0}var Xqe=qse,Jqe=Wse,Qqe=Hse,eVe=Kse,tVe=Yse,nVe=Zse;function Jq({...e}){return f.jsx(Xqe,{"data-slot":"context-menu",...e})}function Qq({...e}){return f.jsx(Jqe,{"data-slot":"context-menu-trigger",...e})}function eV({className:e,...t}){return f.jsx(Qqe,{children:f.jsx(eVe,{"data-slot":"context-menu-content",className:Ye("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-context-menu-content-available-height) min-w-[8rem] origin-(--radix-context-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",e),...t})})}function ul({className:e,inset:t,variant:n="default",...r}){return f.jsx(tVe,{"data-slot":"context-menu-item","data-inset":t,"data-variant":n,className:Ye("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...r})}function tV({className:e,...t}){return f.jsx(nVe,{"data-slot":"context-menu-separator",className:Ye("bg-border -mx-1 my-1 h-px",e),...t})}const rVe=({entry:e,isEditingThis:t,isChecked:n,isGitRepo:r,newName:s,isOperationLoading:i,creatingFolder:a,handleNavigate:o,handleCheckboxChange:l,startEditing:c,cancelEditing:u,handleRename:d,handleDownload:h,handleDelete:m,setNewName:y,renameInputRef:b,handleGitInit:v,handleGitPull:x,handleGitCommit:w,handleGitPush:_,handleGitStatus:k})=>{const C=e.type==="folder",T=L=>{L.target.closest('input[type="checkbox"], button, input[type="text"], [data-radix-context-menu-trigger]')||t||i||(C?o(e):l(!n,e.id))},A=L=>{L.key==="Enter"?d():L.key==="Escape"&&u()},N=C?r?BH:Ih:LH,I=C?r?"text-green-400":"text-yellow-400":"text-blue-400",j=f.jsxs(As,{className:Ye("group hover:bg-muted/50",t&&"bg-muted ring-1 ring-primary",i&&"opacity-70 cursor-not-allowed",!C&&"cursor-pointer"),onClick:T,onDoubleClick:()=>!i&&!t&&o(e),children:[f.jsx(Bn,{className:"px-2 py-1",children:f.jsx(Yc,{checked:n,onCheckedChange:L=>l(!!L,e.id),"aria-label":`Select ${e.name}`,className:"border-border data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",disabled:i||C})}),f.jsx(Bn,{className:"px-2 py-1",children:f.jsx(N,{className:Ye("h-5 w-5",I)})}),f.jsx(Bn,{className:"py-1 px-2",children:t?f.jsx(vn,{ref:b,value:s,onChange:L=>y(L.target.value),onBlur:d,onKeyDown:A,className:"h-7 px-2 py-1 text-sm bg-input border-border focus:ring-1 focus:ring-primary w-full",onClick:L=>L.stopPropagation(),disabled:i}):f.jsx("span",{className:Ye("truncate",C&&"cursor-pointer hover:underline"),title:e.name,onClick:L=>{C&&(L.stopPropagation(),o(e))},children:e.name})}),f.jsx(Bn,{className:"text-right py-1 px-2 text-xs text-muted-foreground",children:e.type==="file"&&e.size!==void 0?_w(e.size):""}),f.jsx(Bn,{className:"text-right text-xs text-muted-foreground py-1 px-2",children:new Date(e.lastModified).toLocaleString()}),f.jsx(Bn,{className:"text-right pr-4 py-1",children:f.jsx("div",{className:Ye("flex items-center justify-end gap-0.5 opacity-0 group-hover:opacity-100 focus-within:opacity-100 transition-opacity",t&&"opacity-100",i&&"opacity-30"),children:t?f.jsxs(f.Fragment,{children:[f.jsx(Un,{tooltipText:"Save (Enter)",onClick:L=>{L.stopPropagation(),d()},"aria-label":"Save name",disabled:i||!s.trim(),icon:i?f.jsx(Hn,{className:"h-4 w-4 animate-spin"}):f.jsx(bo,{}),className:"h-6 w-6 text-green-500 hover:text-green-400"}),f.jsx(Un,{tooltipText:"Cancel (Esc)",onClick:L=>{L.stopPropagation(),u()},"aria-label":"Cancel edit",disabled:i,icon:f.jsx(Si,{}),className:"h-6 w-6 text-muted-foreground hover:text-foreground"})]}):f.jsxs(f.Fragment,{children:[f.jsx(Un,{tooltipText:"Rename",onClick:L=>{L.stopPropagation(),c(e)},"aria-label":"Rename",disabled:i||a,icon:f.jsx(Ah,{}),className:"h-6 w-6 text-muted-foreground hover:text-foreground"}),f.jsx(Un,{tooltipText:C?"Download folder (.zip)":"Download file",onClick:L=>{L.stopPropagation(),h(e)},"aria-label":C?"Download folder as ZIP":"Download file",disabled:i,icon:f.jsx(Fc,{}),className:"h-6 w-6 text-muted-foreground hover:text-foreground"}),f.jsx(Un,{tooltipText:"Delete",onClick:L=>{L.stopPropagation(),m(e)},"aria-label":`Delete ${C?"folder":"file"}`,disabled:i,icon:f.jsx(Vo,{}),className:"h-6 w-6 text-destructive hover:text-destructive/80"})]})})})]},e.id);return C?f.jsxs(Jq,{children:[f.jsx(Qq,{disabled:t||i,asChild:!0,children:j}),f.jsxs(eV,{children:[f.jsx(ul,{onSelect:()=>o(e),disabled:t||i,children:"Open Folder"}),f.jsx(tV,{}),r?f.jsxs(f.Fragment,{children:[f.jsxs(ul,{onSelect:()=>x(e.path),disabled:i,children:[f.jsx(qH,{className:"mr-2 h-4 w-4"}),"Git Pull"]}),f.jsxs(ul,{onSelect:()=>w(e.path),disabled:i,children:[f.jsx(zH,{className:"mr-2 h-4 w-4"}),"Git Commit..."]}),f.jsxs(ul,{onSelect:()=>_(e.path),disabled:i,children:[f.jsx(Q4,{className:"mr-2 h-4 w-4"}),"Git Push"]}),f.jsxs(ul,{onSelect:()=>k(e.path),disabled:i,children:[f.jsx(tO,{className:"mr-2 h-4 w-4"}),"Git Status"]})]}):f.jsxs(ul,{onSelect:()=>v(e.path),disabled:i,children:[f.jsx(qc,{className:"mr-2 h-4 w-4"}),"Initialize Git Repository"]}),f.jsx(tV,{}),f.jsxs(ul,{onSelect:()=>c(e),disabled:i,children:[f.jsx(Ah,{className:"mr-2 h-4 w-4"}),"Rename"]}),f.jsxs(ul,{onSelect:()=>h(e),disabled:i,children:[f.jsx(Fc,{className:"mr-2 h-4 w-4"}),"Download as ZIP"]}),f.jsxs(ul,{className:"text-red-600 focus:text-red-600 focus:bg-red-100 dark:focus:bg-red-900/20",onSelect:()=>m(e),disabled:i,children:[f.jsx(Vo,{className:"mr-2 h-4 w-4"}),"Delete Folder"]})]})]},e.id):f.jsxs(Jq,{children:[f.jsx(Qq,{disabled:t||i,asChild:!0,children:j}),f.jsxs(eV,{children:[f.jsxs(ul,{onSelect:()=>l(!n,e.id),disabled:i,children:[n?"Deselect":"Select"," File"]}),f.jsxs(ul,{onSelect:()=>c(e),disabled:i,children:[f.jsx(Ah,{className:"mr-2 h-4 w-4"}),"Rename"]}),f.jsxs(ul,{onSelect:()=>h(e),disabled:i,children:[f.jsx(Fc,{className:"mr-2 h-4 w-4"}),"Download File"]}),f.jsxs(ul,{className:"text-red-600 focus:text-red-600 focus:bg-red-100 dark:focus:bg-red-900/20",onSelect:()=>m(e),disabled:i,children:[f.jsx(Vo,{className:"mr-2 h-4 w-4"}),"Delete File"]})]})]},e.id)},sVe=({entries:e,editingPath:t,newName:n,creatingFolder:r,newFolderName:s,selectedFileIds:i,isOperationLoading:a,handleNavigate:o,handleCheckboxChange:l,startEditing:c,cancelEditing:u,handleRename:d,cancelCreatingFolder:h,handleCreateFolder:m,handleDownload:y,handleDelete:b,setNewName:v,setNewFolderName:x,renameInputRef:w,newFolderInputRef:_,gitRepoStatus:k,handleGitInit:C,handleGitPull:T,handleGitCommit:A,handleGitPush:N,handleGitStatus:I})=>{const j=E.useMemo(()=>e,[e]);return a&&e.length===0&&!r?f.jsx("div",{className:"flex items-center justify-center h-full text-muted-foreground",children:"Loading..."}):f.jsx("div",{className:"relative h-full",children:f.jsxs(Sf,{className:"w-full text-sm",children:[f.jsx(vp,{className:"sticky top-0 bg-card z-[var(--z-sticky)]",children:f.jsxs(As,{className:"hover:bg-card",children:[f.jsx(Rr,{className:"w-[40px] px-2"}),f.jsx(Rr,{className:"w-[40px] px-2"}),f.jsx(Rr,{children:"Name"}),f.jsx(Rr,{className:"w-[100px] text-right",children:"Size"}),f.jsx(Rr,{className:"w-[150px] text-right",children:"Modified"}),f.jsx(Rr,{className:"w-[100px] text-right pr-4",children:"Actions"})]})}),f.jsxs(_f,{children:[r&&f.jsx(sse,{newFolderName:s,setNewFolderName:x,handleCreateFolder:m,cancelCreatingFolder:h,newFolderInputRef:_,isOperationLoading:a}),j.map(L=>{const D=t===L.path,H=i.has(L.id),O=k[L.path]??!1;return f.jsx(rVe,{entry:L,isEditingThis:D,isChecked:H,isGitRepo:O,newName:D?n:"",isOperationLoading:a,creatingFolder:r,handleNavigate:o,handleCheckboxChange:l,startEditing:c,cancelEditing:u,handleRename:d,handleDownload:y,handleDelete:b,setNewName:v,renameInputRef:w,handleGitInit:C,handleGitPull:T,handleGitCommit:A,handleGitPush:N,handleGitStatus:I},L.id)}),e.length===0&&!r&&!a&&f.jsx(As,{children:f.jsx(Bn,{colSpan:6,className:"h-24 text-center text-muted-foreground",children:"Folder is empty"})})]})]})})},iVe=({currentPath:e,isAnyLoading:t,isOperationLoading:n,entries:r,editingPath:s,creatingFolder:i,handleNavigateHome:a,handleNavigateUp:o,handleRefresh:l,startCreatingFolder:c,handleUploadClick:u,handleFolderUploadClick:d,handleArchiveUploadClick:h,handleDownloadAll:m,handleCloneClick:y,fileInputRef:b,folderInputRef:v,archiveInputRef:x,handleFileChange:w,handleArchiveChange:_})=>f.jsxs(f.Fragment,{children:[f.jsx("input",{type:"file",ref:b,onChange:w,className:"hidden",multiple:!0,disabled:t}),f.jsx("input",{type:"file",ref:v,onChange:w,className:"hidden",webkitdirectory:"true",mozdirectory:"true",directory:"true",disabled:t}),f.jsx("input",{type:"file",ref:x,onChange:_,className:"hidden",accept:".zip",disabled:t}),f.jsxs("div",{className:"flex items-center gap-1 p-2 border-b border-border flex-shrink-0 flex-wrap",children:[f.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[f.jsx(ot,{variant:"ghost",size:"icon",onClick:k=>{k.preventDefault(),k.stopPropagation(),a()},disabled:e==="/"||t,title:"Go to root directory",className:"h-8 w-8",type:"button",children:f.jsx(mge,{className:"h-4 w-4"})}),f.jsx(ot,{variant:"ghost",size:"icon",onClick:k=>{k.preventDefault(),k.stopPropagation(),o()},disabled:e==="/"||t,title:"Go up one level",className:"h-8 w-8",type:"button",children:f.jsx(Xme,{className:"h-4 w-4"})}),f.jsx("span",{className:"text-sm font-mono text-muted-foreground truncate flex-shrink min-w-0 px-2 py-1 rounded bg-muted/50 max-w-[150px] sm:max-w-xs md:max-w-sm lg:max-w-md",title:e,children:e})]}),f.jsx("div",{className:"flex-grow"}),f.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0 flex-wrap justify-end",children:[" ",f.jsx(ot,{variant:"ghost",size:"icon",onClick:k=>{k.preventDefault(),k.stopPropagation(),l()},disabled:t,title:"Refresh current directory",className:"h-8 w-8",type:"button",children:n?f.jsx(Hn,{className:"h-4 w-4 animate-spin"}):f.jsx(Tm,{className:"h-4 w-4"})}),f.jsxs(ot,{variant:"outline",size:"sm",onClick:k=>{k.preventDefault(),k.stopPropagation(),c()},disabled:t||i||!!s,className:"h-8",title:"Create New Folder",type:"button",children:[n&&i?f.jsx(Hn,{className:"h-4 w-4 mr-1 animate-spin"}):f.jsx($H,{className:"h-4 w-4 mr-1"}),f.jsx("span",{className:"hidden sm:inline",children:"Folder"})," "]}),f.jsxs(ot,{variant:"outline",size:"sm",onClick:k=>{k.preventDefault(),k.stopPropagation(),u()},disabled:t,className:"h-8",title:"Upload Files",type:"button",children:[n?f.jsx(Hn,{className:"h-4 w-4 mr-1 animate-spin"}):f.jsx(J4,{className:"h-4 w-4 mr-1"}),f.jsx("span",{className:"hidden sm:inline",children:"Files"})," "]}),f.jsxs(ot,{variant:"outline",size:"sm",onClick:k=>{k.preventDefault(),k.stopPropagation(),d()},disabled:t,className:"h-8",title:"Upload Folder",type:"button",children:[n?f.jsx(Hn,{className:"h-4 w-4 mr-1 animate-spin"}):f.jsx(Ih,{className:"h-4 w-4 mr-1"}),f.jsx("span",{className:"hidden sm:inline",children:"Folder"})," "]}),f.jsxs(ot,{variant:"outline",size:"sm",onClick:k=>{k.preventDefault(),k.stopPropagation(),h()},disabled:t,className:"h-8",title:"Upload & Extract ZIP",type:"button",children:[n?f.jsx(Hn,{className:"h-4 w-4 mr-1 animate-spin"}):f.jsx(Dme,{className:"h-4 w-4 mr-1"}),f.jsx("span",{className:"hidden sm:inline",children:"ZIP"})," "]}),f.jsxs(ot,{variant:"outline",size:"sm",onClick:k=>{k.preventDefault(),k.stopPropagation(),y()},disabled:t,className:"h-8",title:"Clone Git Repository",type:"button",children:[n?f.jsx(Hn,{className:"h-4 w-4 mr-1 animate-spin"}):f.jsx(qc,{className:"h-4 w-4 mr-1"}),f.jsx("span",{className:"hidden sm:inline",children:"Clone"})," "]}),f.jsxs(ot,{variant:"outline",size:"sm",onClick:k=>{k.preventDefault(),k.stopPropagation(),m()},disabled:t||r.length===0,className:"h-8",title:"Download Current Directory as ZIP",type:"button",children:[n?f.jsx(Hn,{className:"h-4 w-4 mr-1 animate-spin"}):f.jsx(OH,{className:"h-4 w-4 mr-1"}),f.jsx("span",{className:"hidden sm:inline",children:"Export"})," "]})]})]})]}),Xse=({isOpen:e,onOpenChange:t,title:n,description:r,children:s,submitLabel:i="Submit",onSubmit:a,isSubmitting:o,submitDisabled:l=!1,className:c,contentClassName:u})=>{const d=async h=>{h==null||h.preventDefault(),!(o||l)&&await a()};return f.jsx(td,{open:e,onOpenChange:t,children:f.jsxs(nd,{className:Ye(c),children:[f.jsxs(rd,{children:[f.jsx(sd,{children:n}),r&&f.jsx(wf,{children:r})]}),f.jsx("div",{className:Ye("py-4",u),children:s}),f.jsxs(dg,{children:[f.jsx(fUe,{asChild:!0,children:f.jsx(ot,{variant:"outline",disabled:o,children:"Cancel"})}),f.jsxs(ot,{onClick:d,disabled:o||l,children:[o&&f.jsx(Hn,{className:"mr-2 h-4 w-4 animate-spin"}),o?"Submitting...":i]})]})]})})},aVe=({isOpen:e,onOpenChange:t,cloneRepoUrl:n,setCloneRepoUrl:r,cloneBranch:s,setCloneBranch:i,isCloning:a,onSubmitClone:o,currentPath:l})=>f.jsx(Xse,{isOpen:e,onOpenChange:t,title:"Clone Git Repository",description:f.jsxs(f.Fragment,{children:["Enter the repository URL. It will be cloned into a new folder named after the repository within ",f.jsx("code",{children:l}),"."]}),submitLabel:"Clone",onSubmit:o,isSubmitting:a,submitDisabled:!n.trim(),children:f.jsxs("div",{className:"grid gap-4",children:[f.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[f.jsx(Nt,{htmlFor:"clone-url",className:"text-right",children:"URL"}),f.jsx(vn,{id:"clone-url",value:n,onChange:c=>r(c.target.value),className:"col-span-3",placeholder:"https://github.com/user/repo.git",disabled:a})]}),f.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[f.jsx(Nt,{htmlFor:"clone-branch",className:"text-right",children:"Branch"}),f.jsx(vn,{id:"clone-branch",value:s,onChange:c=>i(c.target.value),className:"col-span-3",placeholder:"main (default)",disabled:a})]})]})}),oVe=({isOpen:e,onOpenChange:t,commitPath:n,commitMessage:r,setCommitMessage:s,isCommitting:i,onSubmitCommit:a})=>f.jsx(Xse,{isOpen:e,onOpenChange:t,title:"Commit Changes",description:f.jsxs(f.Fragment,{children:["Enter a commit message for the changes in ",f.jsx("code",{children:n}),". All current changes in this directory will be staged and committed."]}),submitLabel:"Commit",onSubmit:a,isSubmitting:i,submitDisabled:!r.trim(),children:f.jsx("div",{className:"grid gap-4",children:f.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[f.jsx(Nt,{htmlFor:"commit-msg",className:"text-right",children:"Message"}),f.jsx(vn,{id:"commit-msg",value:r,onChange:o=>s(o.target.value),className:"col-span-3",placeholder:"e.g., Add feature X",disabled:i})]})})});var eA="DropdownMenu",[lVe,Vft]=Ei(eA,[XT]),Ro=XT(),[cVe,Jse]=lVe(eA),Qse=e=>{const{__scopeDropdownMenu:t,children:n,dir:r,open:s,defaultOpen:i,onOpenChange:a,modal:o=!0}=e,l=Ro(t),c=E.useRef(null),[u,d]=rc({prop:s,defaultProp:i??!1,onChange:a,caller:eA});return f.jsx(cVe,{scope:t,triggerId:pa(),triggerRef:c,contentId:pa(),open:u,onOpenChange:d,onOpenToggle:E.useCallback(()=>d(h=>!h),[d]),modal:o,children:f.jsx(Tse,{...l,open:u,onOpenChange:d,dir:r,modal:o,children:n})})};Qse.displayName=eA;var eie="DropdownMenuTrigger",tie=E.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,disabled:r=!1,...s}=e,i=Jse(eie,n),a=Ro(n);return f.jsx(Ase,{asChild:!0,...a,children:f.jsx(Kn.button,{type:"button",id:i.triggerId,"aria-haspopup":"menu","aria-expanded":i.open,"aria-controls":i.open?i.contentId:void 0,"data-state":i.open?"open":"closed","data-disabled":r?"":void 0,disabled:r,...s,ref:wl(t,i.triggerRef),onPointerDown:Wt(e.onPointerDown,o=>{!r&&o.button===0&&o.ctrlKey===!1&&(i.onOpenToggle(),i.open||o.preventDefault())}),onKeyDown:Wt(e.onKeyDown,o=>{r||(["Enter"," "].includes(o.key)&&i.onOpenToggle(),o.key==="ArrowDown"&&i.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(o.key)&&o.preventDefault())})})})});tie.displayName=eie;var uVe="DropdownMenuPortal",nie=e=>{const{__scopeDropdownMenu:t,...n}=e,r=Ro(t);return f.jsx(Rse,{...r,...n})};nie.displayName=uVe;var rie="DropdownMenuContent",sie=E.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=Jse(rie,n),i=Ro(n),a=E.useRef(!1);return f.jsx(Nse,{id:s.contentId,"aria-labelledby":s.triggerId,...i,...r,ref:t,onCloseAutoFocus:Wt(e.onCloseAutoFocus,o=>{var l;a.current||(l=s.triggerRef.current)==null||l.focus(),a.current=!1,o.preventDefault()}),onInteractOutside:Wt(e.onInteractOutside,o=>{const l=o.detail.originalEvent,c=l.button===0&&l.ctrlKey===!0,u=l.button===2||c;(!s.modal||u)&&(a.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});sie.displayName=rie;var dVe="DropdownMenuGroup",fVe=E.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=Ro(n);return f.jsx(Ise,{...s,...r,ref:t})});fVe.displayName=dVe;var hVe="DropdownMenuLabel",pVe=E.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=Ro(n);return f.jsx(Mse,{...s,...r,ref:t})});pVe.displayName=hVe;var mVe="DropdownMenuItem",iie=E.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=Ro(n);return f.jsx(jse,{...s,...r,ref:t})});iie.displayName=mVe;var gVe="DropdownMenuCheckboxItem",yVe=E.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=Ro(n);return f.jsx(Pse,{...s,...r,ref:t})});yVe.displayName=gVe;var bVe="DropdownMenuRadioGroup",vVe=E.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=Ro(n);return f.jsx(Ose,{...s,...r,ref:t})});vVe.displayName=bVe;var xVe="DropdownMenuRadioItem",wVe=E.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=Ro(n);return f.jsx(Dse,{...s,...r,ref:t})});wVe.displayName=xVe;var SVe="DropdownMenuItemIndicator",_Ve=E.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=Ro(n);return f.jsx(Fse,{...s,...r,ref:t})});_Ve.displayName=SVe;var CVe="DropdownMenuSeparator",aie=E.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=Ro(n);return f.jsx(Lse,{...s,...r,ref:t})});aie.displayName=CVe;var kVe="DropdownMenuArrow",EVe=E.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=Ro(n);return f.jsx(Bse,{...s,...r,ref:t})});EVe.displayName=kVe;var TVe="DropdownMenuSubTrigger",AVe=E.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=Ro(n);return f.jsx($se,{...s,...r,ref:t})});AVe.displayName=TVe;var RVe="DropdownMenuSubContent",NVe=E.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=Ro(n);return f.jsx(zse,{...s,...r,ref:t,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});NVe.displayName=RVe;var IVe=Qse,MVe=tie,jVe=nie,PVe=sie,OVe=iie,DVe=aie;function FVe({...e}){return f.jsx(IVe,{"data-slot":"dropdown-menu",...e})}function LVe({...e}){return f.jsx(MVe,{"data-slot":"dropdown-menu-trigger",...e})}function BVe({className:e,sideOffset:t=4,...n}){return f.jsx(jVe,{children:f.jsx(PVe,{"data-slot":"dropdown-menu-content",sideOffset:t,className:Ye("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-dropdown-menu-content-available-height) min-w-[8rem] origin-(--radix-dropdown-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",e),...n})})}function mu({className:e,inset:t,variant:n="default",...r}){return f.jsx(OVe,{"data-slot":"dropdown-menu-item","data-inset":t,"data-variant":n,className:Ye("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...r})}function nV({className:e,...t}){return f.jsx(DVe,{"data-slot":"dropdown-menu-separator",className:Ye("bg-border -mx-1 my-1 h-px",e),...t})}const $Ve=({entries:e,editingPath:t,newName:n,creatingFolder:r,newFolderName:s,selectedFileIds:i,isOperationLoading:a,handleNavigate:o,handleCheckboxChange:l,startEditing:c,cancelEditing:u,handleRename:d,cancelCreatingFolder:h,handleCreateFolder:m,handleDownload:y,handleDelete:b,setNewName:v,setNewFolderName:x,renameInputRef:w,newFolderInputRef:_,gitRepoStatus:k,handleGitInit:C,handleGitPull:T,handleGitCommit:A,handleGitPush:N,handleGitStatus:I})=>{const j=L=>{L.key==="Enter"?d():L.key==="Escape"&&u()};return a&&e.length===0&&!r?f.jsx("div",{className:"flex items-center justify-center h-full text-muted-foreground p-4",children:"Loading..."}):f.jsxs("div",{className:"p-2 space-y-1",children:[r&&f.jsx("div",{className:"border rounded-md p-2 bg-muted/30",children:f.jsx(sse,{newFolderName:s,setNewFolderName:x,handleCreateFolder:m,cancelCreatingFolder:h,newFolderInputRef:_,isOperationLoading:a,isMobile:!0})}),e.map(L=>{const D=t===L.path,H=i.has(L.id),O=k[L.path]??!1,K=L.type==="folder",U=K?O?BH:Ih:LH,W=K?O?"text-green-400":"text-yellow-400":"text-blue-400";return f.jsxs("div",{className:Ye("flex items-center justify-between p-2 border rounded-md",D&&"bg-muted ring-1 ring-primary",a&&"opacity-70 cursor-not-allowed",!D&&"hover:bg-muted/50",!D&&"cursor-pointer"),onClick:()=>{D||a||(K?o(L):l(!H,L.id))},children:[f.jsxs("div",{className:"flex items-center gap-2 flex-grow min-w-0",children:[!K&&f.jsx(Yc,{checked:H,onCheckedChange:B=>l(!!B,L.id),"aria-label":`Select ${L.name}`,className:"border-border data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground flex-shrink-0",disabled:a,onClick:B=>B.stopPropagation()}),K&&f.jsx("div",{className:"w-6 flex-shrink-0"}),f.jsx(U,{className:Ye("h-5 w-5 flex-shrink-0",W)}),f.jsxs("div",{className:"flex flex-col min-w-0 flex-grow",children:[D?f.jsx(vn,{ref:w,value:n,onChange:B=>v(B.target.value),onBlur:d,onKeyDown:j,className:"h-7 px-2 py-1 text-sm bg-input border-border focus:ring-1 focus:ring-primary w-full",onClick:B=>B.stopPropagation(),disabled:a}):f.jsx("span",{className:"text-sm font-medium truncate",title:L.name,children:L.name}),f.jsx("span",{className:"text-xs text-muted-foreground",children:L.type==="file"&&L.size!==void 0?_w(L.size):L.type==="folder"?O?"Git Repository":"Folder":""})]})]}),f.jsx("div",{className:"flex items-center flex-shrink-0 ml-2",children:D?f.jsxs(f.Fragment,{children:[f.jsx(ot,{variant:"ghost",size:"icon",className:"h-7 w-7 text-green-500 hover:text-green-600",onClick:B=>{B.stopPropagation(),d()},disabled:a||!n.trim(),"aria-label":"Save name",children:a?f.jsx(Hn,{className:"h-4 w-4 animate-spin"}):f.jsx(bo,{className:"h-4 w-4"})}),f.jsx(ot,{variant:"ghost",size:"icon",className:"h-7 w-7 text-muted-foreground hover:text-foreground",onClick:B=>{B.stopPropagation(),u()},disabled:a,"aria-label":"Cancel edit",children:f.jsx(Si,{className:"h-4 w-4"})})]}):f.jsxs(FVe,{children:[f.jsx(LVe,{asChild:!0,children:f.jsx(ot,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:B=>B.stopPropagation(),disabled:a,"aria-label":"More actions",children:f.jsx(Pme,{className:"h-4 w-4"})})}),f.jsxs(BVe,{align:"end",onClick:B=>B.stopPropagation(),children:[K&&f.jsx(mu,{onSelect:()=>o(L),children:"Open Folder"}),!K&&f.jsxs(mu,{onSelect:()=>l(!H,L.id),children:[H?"Deselect":"Select"," File"]}),f.jsxs(mu,{onSelect:()=>c(L),children:[f.jsx(Ah,{className:"mr-2 h-4 w-4"})," Rename"]}),f.jsxs(mu,{onSelect:()=>y(L),children:[f.jsx(Fc,{className:"mr-2 h-4 w-4"})," Download"," ",K?"as ZIP":""]}),K&&f.jsx(nV,{}),K&&O&&f.jsxs(f.Fragment,{children:[f.jsxs(mu,{onSelect:()=>T(L.path),children:[f.jsx(qH,{className:"mr-2 h-4 w-4"})," Git Pull"]}),f.jsxs(mu,{onSelect:()=>A(L.path),children:[f.jsx(zH,{className:"mr-2 h-4 w-4"})," Git Commit..."]}),f.jsxs(mu,{onSelect:()=>N(L.path),children:[f.jsx(Q4,{className:"mr-2 h-4 w-4"})," Git Push"]}),f.jsxs(mu,{onSelect:()=>I(L.path),children:[f.jsx(tO,{className:"mr-2 h-4 w-4"})," Git Status"]})]}),K&&!O&&f.jsxs(mu,{onSelect:()=>C(L.path),children:[f.jsx(qc,{className:"mr-2 h-4 w-4"})," Initialize Git Repo"]}),f.jsx(nV,{}),f.jsxs(mu,{className:"text-red-600 focus:text-red-600",onSelect:()=>b(L),children:[f.jsx(Vo,{className:"mr-2 h-4 w-4"})," Delete"]})]})]})})]},L.id)}),e.length===0&&!r&&!a&&f.jsx("div",{className:"p-4 text-center text-sm text-muted-foreground",children:"Folder is empty"})]})},y6=E.memo(()=>{const{nodes:e,childrenMap:t,currentParentId:n,loading:r,operationLoading:s,error:i,rootId:a,selectedFileIds:o,vfsKey:l,configuredVfsKey:c,initializingKey:u}=ti(mn(Se=>({nodes:Se.nodes,childrenMap:Se.childrenMap,currentParentId:Se.currentParentId,selectedFileIds:Se.selectedFileIds,loading:Se.loading,operationLoading:Se.operationLoading,error:Se.error,rootId:Se.rootId,vfsKey:Se.vfsKey,configuredVfsKey:Se.configuredVfsKey,initializingKey:Se.initializingKey}))),[d,h]=E.useState(""),[m,y]=E.useState(null),[b,v]=E.useState(!1),[x,w]=E.useState(""),[_,k]=E.useState({}),[C,T]=E.useState(!1),[A,N]=E.useState(""),[I,j]=E.useState(""),[L,D]=E.useState(!1),[H,O]=E.useState(!1),[K,U]=E.useState(null),[W,B]=E.useState(""),[ne,V]=E.useState(!1),[Q,ee]=E.useState({}),re=E.useRef(null),de=E.useRef(null),me=E.useRef(null),De=E.useRef(null),je=E.useRef(null),Te=n?e[n]:null,_e=Te?Te.path:"/",Qe=(t[n||a||""]||[]).map(Se=>e[Se]).filter(Se=>!!Se).sort((Se,ze)=>Se.type==="folder"&&ze.type==="file"?-1:Se.type==="file"&&ze.type==="folder"?1:Se.name.localeCompare(ze.name)),We=E.useMemo(()=>Qe.filter(Se=>Se.type==="folder").map(Se=>Se.path),[Qe]),Pe=r||u!==null||l!==c,Y=s||L||ne||Object.values(Q).some(Boolean);E.useEffect(()=>{n!==null&&!t[n]&&!Pe&&c===l?Ce.emit(hn.fetchNodesRequest,{parentId:n}):n===null&&a&&!t[a]&&!Pe&&c===l&&Ce.emit(hn.fetchNodesRequest,{parentId:a})},[n,t,a,Pe,c,l]),E.useEffect(()=>{var Se,ze;m&&((Se=De.current)==null||Se.focus(),(ze=De.current)==null||ze.select())},[m]),E.useEffect(()=>{var Se;b&&((Se=je.current)==null||Se.focus())},[b]),E.useEffect(()=>{(async()=>{if(Pe||We.length===0)return;const ze={};let Ct=!1;for(const fe of We)try{const Z=await WTe(fe);_[fe]!==Z&&(ze[fe]=Z,Ct=!0)}catch(Z){console.error(`Error checking git status for ${fe}:`,Z),_[fe]!==!1&&(ze[fe]=!1,Ct=!0)}Ct&&k(fe=>({...fe,...ze}))})()},[We,Pe,_]);const ye=E.useCallback(async(Se,ze,Ct)=>{if(!(Y||Pe)){Ct!==!1&&Ce.emit(hn.loadingStateChanged,{isLoading:r,operationLoading:!0,error:null});try{Ce.emit(Se,ze)}catch(fe){console.error("[FileManager Operation Error]:",fe),Ce.emit(hn.loadingStateChanged,{isLoading:r,operationLoading:s,error:fe instanceof Error?fe.message:String(fe)})}finally{Ct!==!1&&Ce.emit(hn.loadingStateChanged,{isLoading:r,operationLoading:!1,error:i})}}},[Y,Pe,r,s,i]),Me=E.useCallback(Se=>{Y||Pe||m||Se.type==="folder"&&ye(hn.setCurrentPathRequest,{path:Se.path},!1)},[Y,Pe,m,ye]),ue=E.useCallback(()=>{if(Y||Pe||_e==="/")return;const Se=hT(_e);ye(hn.setCurrentPathRequest,{path:Se},!1)},[Y,Pe,_e,ye]),oe=E.useCallback(()=>{Y||Pe||_e==="/"||ye(hn.setCurrentPathRequest,{path:"/"},!1)},[Y,Pe,_e,ye]),se=E.useCallback(()=>{Pe||ye(hn.fetchNodesRequest,{parentId:n},!1)},[ye,n,Pe]),Ie=E.useCallback((Se,ze)=>{const Ct=e[ze];Ct&&Ct.type==="file"?Se?Ce.emit(hn.selectFileRequest,{fileId:ze}):Ce.emit(hn.deselectFileRequest,{fileId:ze}):Ct&&Ct.type==="folder"&&ke.info("Folders cannot be attached to the prompt.")},[e]),Be=E.useCallback(Se=>{Y||Pe||b||(y(Se.path),h(Se.name),v(!1))},[Y,Pe,b]),Re=E.useCallback(()=>{y(null),h("")},[]),ct=E.useCallback(async()=>{if(!m||!d.trim()){Re();return}const Se=Object.values(e).find(ze=>ze.path===m);Se&&Se.name!==d.trim()&&await ye(hn.renameNodeRequest,{id:Se.id,newName:d.trim()}),Re()},[m,d,e,Re,ye]),At=E.useCallback(()=>{Y||Pe||m||(v(!0),w(""),y(null))},[Y,Pe,m]),ut=E.useCallback(()=>{v(!1),w("")},[]),Pt=E.useCallback(async()=>{if(!x.trim()){ut();return}await ye(hn.createDirectoryRequest,{parentId:n,name:x.trim()}),ut()},[x,n,ut,ye]),Ut=()=>{var Se;return(Se=re.current)==null?void 0:Se.click()},Ft=()=>{var Se;return(Se=de.current)==null?void 0:Se.click()},Yt=()=>{var Se;return(Se=me.current)==null?void 0:Se.click()},we=E.useCallback(async Se=>{const ze=Se.target.files;ze&&ze.length>0&&(await ye(hn.uploadFilesRequest,{parentId:n,files:ze}),Se.target&&(Se.target.value=""))},[n,ye]),F=E.useCallback(async Se=>{var Ct;const ze=(Ct=Se.target.files)==null?void 0:Ct[0];if(ze){Ce.emit(hn.loadingStateChanged,{isLoading:r,operationLoading:!0,error:null});try{await KTe(ze,_e),Ce.emit(hn.fetchNodesRequest,{parentId:n})}catch(fe){console.error("Archive upload error:",fe)}finally{Ce.emit(hn.loadingStateChanged,{isLoading:r,operationLoading:!1,error:i}),Se.target&&(Se.target.value="")}}},[_e,n,r,i]),X=E.useCallback(async Se=>{window.confirm(`Delete ${Se.type} "${Se.name}"?${Se.type==="folder"?`

WARNING: This will delete all contents inside`:""}`)&&await ye(hn.deleteNodesRequest,{ids:[Se.id]})},[ye]),be=E.useCallback(async Se=>{Ce.emit(hn.loadingStateChanged,{isLoading:r,operationLoading:!0,error:null});try{Se.type==="file"?await GTe(Se.path):await G9(`${Se.name}.zip`,Se.path)}catch(ze){console.error("Download error:",ze)}finally{Ce.emit(hn.loadingStateChanged,{isLoading:r,operationLoading:!1,error:i})}},[r,i]),Ee=E.useCallback(async()=>{if(Qe.length!==0){Ce.emit(hn.loadingStateChanged,{isLoading:r,operationLoading:!0,error:null});try{const Se=xi(_e)||"root";await G9(`${Se}_export.zip`,_e)}catch(Se){console.error("Download all error:",Se)}finally{Ce.emit(hn.loadingStateChanged,{isLoading:r,operationLoading:!1,error:i})}}},[_e,Qe.length,r,i]),ge=E.useCallback(async(Se,ze)=>{if(!(Q[Se]||Pe||s)){ee(Ct=>({...Ct,[Se]:!0})),Ce.emit(hn.loadingStateChanged,{isLoading:r,operationLoading:s,error:null});try{await ze()}catch(Ct){console.error(`[FileManager Git Op Error @ ${Se}]:`,Ct)}finally{ee(Ct=>({...Ct,[Se]:!1}))}}},[Q,Pe,s,r]),Ae=E.useCallback(Se=>{ge(Se,async()=>{await HZ(Se),k(ze=>({...ze,[Se]:!0}))})},[ge]),le=E.useCallback(Se=>{ke.info("Pulling default branch (auth not implemented yet)..."),ge(Se,()=>vT(Se,"main"))},[ge]),ft=E.useCallback(Se=>{U(Se),B(""),O(!0)},[]),et=E.useCallback(Se=>{ke.info("Pushing default branch (auth not implemented yet)..."),ge(Se,()=>RD(Se,"main"))},[ge]),$=E.useCallback(Se=>{ge(Se,()=>GZ(Se))},[ge]),qe=E.useCallback(()=>{N(""),j(""),T(!0)},[]),tt=E.useCallback(async()=>{if(!A.trim()){ke.error("Repository URL cannot be empty.");return}D(!0),Ce.emit(hn.loadingStateChanged,{isLoading:r,operationLoading:s,error:null});try{const Se=xi(A.trim().replace(/\.git$/,""))||"cloned_repo",ze=V3(_e,Se);await WZ(ze,A.trim(),I.trim()||void 0),T(!1),Ce.emit(hn.fetchNodesRequest,{parentId:n})}catch{}finally{D(!1)}},[A,I,_e,n,r,s]),ve=E.useCallback(async()=>{if(!K||!W.trim()){ke.error("Commit message cannot be empty.");return}V(!0),Ce.emit(hn.loadingStateChanged,{isLoading:r,operationLoading:s,error:null});try{await AD(K,W.trim()),O(!1)}catch{}finally{V(!1)}},[K,W,r,s]);return Pe?f.jsxs("div",{className:"flex h-full flex-col items-center justify-center bg-card text-muted-foreground p-4",children:[f.jsx(Hn,{className:"h-8 w-8 animate-spin mb-2"}),f.jsx("p",{children:u?`Initializing filesystem: ${u}`:"Loading filesystem..."}),i&&f.jsxs("p",{className:"text-destructive mt-2",children:["Error: ",i]})]}):i&&!Pe?f.jsxs("div",{className:"flex h-full flex-col items-center justify-center bg-card text-destructive p-4",children:[f.jsxs("p",{children:["Error loading filesystem: ",i]}),f.jsx(ot,{variant:"outline",size:"sm",onClick:()=>Ce.emit(hn.initializeVFSRequest,{vfsKey:l||"default_fallback_key"}),className:"mt-2",children:"Retry"})]}):f.jsxs("div",{className:Ye("flex h-full flex-col bg-card text-card-foreground"),children:[f.jsx(iVe,{currentPath:_e,isAnyLoading:Y||Pe,isOperationLoading:s,entries:Qe,editingPath:m,creatingFolder:b,handleNavigateHome:oe,handleNavigateUp:ue,handleRefresh:se,startCreatingFolder:At,handleUploadClick:Ut,handleFolderUploadClick:Ft,handleArchiveUploadClick:Yt,handleDownloadAll:Ee,handleCloneClick:qe,fileInputRef:re,folderInputRef:de,archiveInputRef:me,handleFileChange:we,handleArchiveChange:F}),f.jsx("div",{className:"flex-grow overflow-auto hidden md:block",children:f.jsx(sVe,{entries:Qe,editingPath:m,newName:d,creatingFolder:b,newFolderName:x,selectedFileIds:o,isOperationLoading:Y,handleNavigate:Me,handleCheckboxChange:Ie,startEditing:Be,cancelEditing:Re,handleRename:ct,cancelCreatingFolder:ut,handleCreateFolder:Pt,handleDownload:be,handleDelete:X,setNewName:h,setNewFolderName:w,renameInputRef:De,newFolderInputRef:je,gitRepoStatus:_,handleGitInit:Ae,handleGitPull:le,handleGitCommit:ft,handleGitPush:et,handleGitStatus:$})}),f.jsx("div",{className:"flex-grow overflow-auto block md:hidden",children:f.jsx($Ve,{entries:Qe,editingPath:m,newName:d,creatingFolder:b,newFolderName:x,selectedFileIds:o,isOperationLoading:Y,handleNavigate:Me,handleCheckboxChange:Ie,startEditing:Be,cancelEditing:Re,handleRename:ct,cancelCreatingFolder:ut,handleCreateFolder:Pt,handleDownload:be,handleDelete:X,setNewName:h,setNewFolderName:w,renameInputRef:De,newFolderInputRef:je,gitRepoStatus:_,handleGitInit:Ae,handleGitPull:le,handleGitCommit:ft,handleGitPush:et,handleGitStatus:$})}),f.jsx(aVe,{isOpen:C,onOpenChange:T,cloneRepoUrl:A,setCloneRepoUrl:N,cloneBranch:I,setCloneBranch:j,isCloning:L,onSubmitClone:tt,currentPath:_e}),f.jsx(oVe,{isOpen:H,onOpenChange:O,commitPath:K,commitMessage:W,setCommitMessage:B,isCommitting:ne,onSubmitCommit:ve})]})});y6.displayName="FileManager";const zVe=({vfsKey:e,selectedItemType:t})=>e==="orphan"?f.jsxs("div",{className:"flex items-center gap-2 text-xs text-blue-300 bg-blue-900/40 px-2 py-1 rounded mb-1",children:[f.jsx(ZB,{className:"h-4 w-4"}),f.jsxs("span",{children:[f.jsx("b",{children:"Shared VFS:"})," All chats ",f.jsx("i",{children:"not"})," in a project share this filesystem."]})]}):e&&t==="conversation"?f.jsxs("div",{className:"flex items-center gap-2 text-xs text-blue-300 bg-blue-900/40 px-2 py-1 rounded mb-1",children:[f.jsx(ZB,{className:"h-4 w-4"}),f.jsxs("span",{children:[f.jsx("b",{children:"Project-shared VFS:"})," All chats in this project share this filesystem."]})]}):e&&t==="project"?f.jsxs("div",{className:"flex items-center gap-2 text-xs text-blue-300 bg-blue-900/40 px-2 py-1 rounded mb-1",children:[f.jsx(Ih,{className:"h-4 w-4"}),f.jsxs("span",{children:[f.jsx("b",{children:"Project VFS:"})," Filesystem for this project and all its chats."]})]}):null,UVe=({module:e,isOpen:t,onClose:n})=>{const[r,s]=E.useState(e.getSelectedFileIdsCount()),[i,a]=E.useState(null);E.useEffect(()=>{const u=h=>{s(h.selectedFileIds.length)},d=h=>{a(h.itemType)};return Ce.on(hn.selectionChanged,u),Ce.on(tr.selectedItemChanged,d),()=>{Ce.off(hn.selectionChanged,u),Ce.off(tr.selectedItemChanged,d)}},[]);const o=ti.getState().vfsKey,l=()=>{const u=ti.getState().selectedFileIds,d=e.getVfsNodes();if(u.size===0){ke.info("No files selected in VFS to attach.");return}let h=0;u.forEach(m=>{const y=d[m];y&&y.type==="file"&&(Ce.emit(Yl.addAttachedFileRequest,{source:"vfs",name:y.name,type:y.mimeType||"application/octet-stream",size:y.size,path:y.path}),h++)}),h>0?(ke.success(`Attached ${h} file(s) from VFS to the next prompt.`),e.clearVfsSelection(),n()):ke.warning("No valid files were selected to attach.")},c=()=>{e.clearVfsSelection(),n()};return f.jsx(td,{open:t,onOpenChange:u=>!u&&c(),children:f.jsxs(nd,{className:"sm:max-w-[90vw] md:max-w-[80vw] lg:max-w-[70vw] w-[90vw] h-[80vh] min-h-[500px] max-h-[90vh] flex flex-col p-0 gap-0",children:[f.jsxs(rd,{className:"p-4 pb-2 border-b flex-shrink-0",children:[f.jsx(sd,{children:"Virtual Filesystem"}),f.jsx(wf,{children:"Manage files associated with the current context. Select files to attach them to your next prompt."}),f.jsx(zVe,{vfsKey:o,selectedItemType:i})]}),f.jsx("div",{className:"flex-grow overflow-hidden",children:f.jsx(y6,{})}),f.jsxs(dg,{className:"p-4 pt-2 border-t flex-shrink-0",children:[f.jsx(ot,{variant:"outline",onClick:c,children:"Close"}),f.jsxs(ot,{onClick:l,disabled:r===0,children:[f.jsx(RE,{className:"h-4 w-4 mr-2"}),"Attach Selected (",r,")"]})]})]})})};class qVe{constructor(){ce(this,"id","core-vfs");ce(this,"modalId","core-vfs-modal-panel");ce(this,"unregisterCallbacks",[]);ce(this,"eventUnsubscribers",[]);ce(this,"modApiRef",null);ce(this,"notifyTriggerUpdate",null);ce(this,"isModalOpenByManager",!1);ce(this,"getEnableVfs",()=>ti.getState().enableVfs);ce(this,"getIsVfsModalOpen",()=>this.isModalOpenByManager);ce(this,"getSelectedFileIdsCount",()=>ti.getState().selectedFileIds.size);ce(this,"toggleVfsModal",()=>{var t,n;this.isModalOpenByManager?(t=this.modApiRef)==null||t.emit(Tr.closeModalRequest,{modalId:this.modalId}):(n=this.modApiRef)==null||n.emit(Tr.openModalRequest,{modalId:this.modalId})});ce(this,"clearVfsSelection",()=>{var t;(t=this.modApiRef)==null||t.emit(hn.clearSelectionRequest,void 0)});ce(this,"getVfsNodes",()=>ti.getState().nodes);ce(this,"setNotifyTriggerUpdate",t=>{this.notifyTriggerUpdate=t})}async initialize(t){this.modApiRef=t,this.updateVfsKeyBasedOnContext();const n=t.on(Tr.contextChanged,()=>{var s;this.updateVfsKeyBasedOnContext(),(s=this.notifyTriggerUpdate)==null||s.call(this)}),r=t.on(Tr.modalStateChanged,s=>{var i;if(s.modalId===this.modalId){const a=s.isOpen;this.isModalOpenByManager!==a&&(this.isModalOpenByManager=a,(i=this.notifyTriggerUpdate)==null||i.call(this),a&&this.updateVfsKeyBasedOnContext())}});this.eventUnsubscribers.push(n,r)}updateVfsKeyBasedOnContext(){var i;const{selectedItemId:t,selectedItemType:n}=jn.getState(),r=ti.getState().vfsKey;let s=null;if(this.isModalOpenByManager)if(n==="project")s=t;else if(n==="conversation"){const a=jn.getState().getConversationById(t);s=(a==null?void 0:a.projectId)??"orphan"}else s="orphan";else if(n==="project")s=t;else if(n==="conversation"){const a=jn.getState().getConversationById(t);s=(a==null?void 0:a.projectId)??"orphan"}else s="orphan";r!==s&&(console.log(`[${this.id}] Updating VFS key from "${r}" to "${s}"`),(i=this.modApiRef)==null||i.emit(hn.setVfsKeyRequest,{key:s}))}register(t){if(this.modApiRef=t,this.unregisterCallbacks.length>0){console.warn(`[${this.id}] Already registered. Skipping.`);return}const n=t.registerPromptControl({id:"core-vfs-prompt-trigger",triggerRenderer:()=>Ve.createElement(HUe,{module:this})});this.unregisterCallbacks.push(n);const r=t.registerModalProvider(this.modalId,s=>Ve.createElement(UVe,{module:this,...s}));this.unregisterCallbacks.push(r)}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallbacks.forEach(t=>t()),this.unregisterCallbacks=[],this.notifyTriggerUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const VVe=({module:e})=>{const[,t]=E.useState({});E.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const n=e.selectedItemId,r=e.selectedItemType,s=e.syncRepos,i=e.conversationSyncStatus,a=e.isStreaming,[o,l]=E.useState(null),[c,u]=E.useState("idle"),[d,h]=E.useState(!1),[m,y]=E.useState(!1);E.useEffect(()=>{if(r==="conversation"&&n){const T=e.getConversationById(n);l((T==null?void 0:T.syncRepoId)??null),u(i[n]??"idle")}else l(null),u("idle")},[n,r,i,e]);const b=Ve.useMemo(()=>new Map(s.map(T=>[T.id,T.name])),[s]),v=o?b.get(o):void 0,x=E.useCallback(async T=>{if(!n||r!=="conversation")return;h(!0);const A=T==="none"?null:T;await e.linkConversationToRepo(n,A),h(!1)},[n,r,e]),w=E.useCallback(async()=>{!n||!o||(y(!0),await e.syncConversation(n),y(!1))},[n,o,e]),_=yre(c,v),k=!o||m||d||a||c==="syncing";return r==="conversation"&&s.length>0?f.jsxs(gc,{children:[f.jsx(wr,{delayDuration:100,children:f.jsxs(Sr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(yc,{asChild:!0,children:f.jsx(ot,{variant:o?"secondary":"ghost",size:"icon",className:"h-8 w-8",disabled:a||d||m,"aria-label":"Configure Git Sync",children:c==="syncing"||m||d?f.jsx(Hn,{className:"h-4 w-4 animate-spin"}):f.jsx(qc,{className:"h-4 w-4"})})})}),f.jsx(Cr,{side:"top",children:o?`Sync Status: ${c}`:"Link to Sync Repo"})]})}),f.jsxs(bc,{className:"w-64 p-4 space-y-3",align:"start",children:[f.jsx(Nt,{htmlFor:"sync-repo-select",className:"text-sm font-medium",children:"Link to Repository"}),f.jsxs(sc,{value:o??"none",onValueChange:x,disabled:d||m||a,children:[f.jsx(ac,{id:"sync-repo-select",className:"w-full h-9",children:f.jsx(ic,{placeholder:"Select repository..."})}),f.jsxs(oc,{children:[f.jsx(wi,{value:"none",children:f.jsx("span",{className:"text-muted-foreground",children:"None"})}),s.map(T=>f.jsx(wi,{value:T.id,children:T.name},T.id))]})]}),f.jsxs("div",{className:"flex items-center justify-between pt-2",children:[f.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:["Status: ",_||"Not Linked"]}),f.jsxs(ot,{size:"sm",variant:"outline",onClick:w,disabled:k,className:"h-8",children:[m||c==="syncing"?f.jsx(Hn,{className:"h-4 w-4 mr-1 animate-spin"}):f.jsx(Q4,{className:"h-4 w-4 mr-1"}),"Sync Now"]})]})]})]}):null},Ex=({title:e,description:t,children:n,className:r,titleClassName:s,descriptionClassName:i,contentClassName:a})=>f.jsxs("div",{className:Ye("space-y-2",r),children:[f.jsxs("div",{children:[f.jsx("h3",{className:Ye("text-lg font-medium",s),children:e}),t&&f.jsx("p",{className:Ye("text-sm text-muted-foreground",i),children:t})]}),f.jsx("div",{className:Ye(a),children:n})]}),WVe=Ke({gitUserName:$e().min(1,"User name cannot be empty."),gitUserEmail:$e().email("Invalid email address.")});function rV({field:e}){return f.jsx(f.Fragment,{children:e.state.meta.isTouched&&e.state.meta.errors.length>0?f.jsx("em",{className:"text-xs text-destructive mt-1 block",children:e.state.meta.errors.map(t=>typeof t=="string"?t:typeof t=="object"&&t!==null&&"message"in t&&typeof t.message=="string"?t.message:(console.warn("FieldMetaMessages encountered an unexpected error object:",t),"Invalid input")).join(", ")}):null})}const HVe=()=>{const{gitUserName:e,setGitUserName:t,gitUserEmail:n,setGitUserEmail:r}=pr(mn(i=>({gitUserName:i.gitUserName,setGitUserName:i.setGitUserName,gitUserEmail:i.gitUserEmail,setGitUserEmail:i.setGitUserEmail}))),s=ai({defaultValues:{gitUserName:e??"",gitUserEmail:n??""},validators:{onChange:WVe},onSubmit:async({value:i})=>{try{t(i.gitUserName),r(i.gitUserEmail),ke.success("Git user configuration updated!")}catch(a){ke.error("Failed to update Git configuration."),console.error("Error submitting Git config form:",a)}}});return E.useEffect(()=>{s.reset({gitUserName:e??"",gitUserEmail:n??""})},[e,n,s]),f.jsx("div",{className:"space-y-4 p-1",children:f.jsx(Ex,{title:"Git User Configuration",description:"Set your user name and email for Git commits made within the VFS. This is required for committing changes.",contentClassName:"rounded-lg border p-3 shadow-sm bg-card",children:f.jsxs("form",{onSubmit:i=>{i.preventDefault(),i.stopPropagation(),s.handleSubmit()},className:"space-y-3",children:[f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[f.jsx(s.Field,{name:"gitUserName",children:i=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(Nt,{htmlFor:i.name,children:"Git User Name"}),f.jsx(vn,{id:i.name,value:i.state.value,onBlur:i.handleBlur,onChange:a=>i.handleChange(a.target.value),placeholder:"Your Name",className:i.state.meta.errors.length?"border-destructive":""}),f.jsx(rV,{field:i})]})}),f.jsx(s.Field,{name:"gitUserEmail",children:i=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(Nt,{htmlFor:i.name,children:"Git User Email"}),f.jsx(vn,{id:i.name,type:"email",value:i.state.value,onBlur:i.handleBlur,onChange:a=>i.handleChange(a.target.value),placeholder:"your.email@example.com",className:i.state.meta.errors.length?"border-destructive":""}),f.jsx(rV,{field:i})]})})]}),f.jsx("div",{className:"flex justify-end pt-2",children:f.jsx(s.Subscribe,{selector:i=>[i.canSubmit,i.isSubmitting,i.isValidating,i.isValid],children:([i,a,o,l])=>f.jsx(ot,{type:"submit",size:"sm",disabled:!i||a||o||!l,children:a?"Saving...":o?"Validating...":"Save Git Config"})})})]})})})},GVe=Ve.memo(HVe);var KVe="Separator",sV="horizontal",YVe=["horizontal","vertical"],oie=E.forwardRef((e,t)=>{const{decorative:n,orientation:r=sV,...s}=e,i=ZVe(r)?r:sV,o=n?{role:"none"}:{"aria-orientation":i==="vertical"?i:void 0,role:"separator"};return f.jsx(Kn.div,{"data-orientation":i,...o,...s,ref:t})});oie.displayName=KVe;function ZVe(e){return YVe.includes(e)}var XVe=oie;function zm({className:e,orientation:t="horizontal",decorative:n=!0,...r}){return f.jsx(XVe,{"data-slot":"separator-root",decorative:n,orientation:t,className:Ye("bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px",e),...r})}const JVe=({onSyncAll:e,onSyncPending:t,onInitializeRepos:n,onAbortSync:r,isRunning:s=!1,totalRepos:i,totalConversations:a,pendingConversations:o})=>{const[l,c]=E.useState(null),[u,d]=E.useState(!1);E.useEffect(()=>{const _=A=>{A&&A.progress&&(c(A.progress),d(!0))},k=A=>{A&&A.progress&&c(A.progress)},C=A=>{A&&A.progress&&(c(A.progress),setTimeout(()=>{c(null),d(!1)},2e3))},T=A=>{A&&A.progress&&(c(A.progress),setTimeout(()=>{c(null),d(!1)},5e3))};return Ce.on(ds.bulkSyncStarted,_),Ce.on(ds.bulkSyncProgress,k),Ce.on(ds.bulkSyncCompleted,C),Ce.on(ds.bulkSyncFailed,T),()=>{Ce.off(ds.bulkSyncStarted,_),Ce.off(ds.bulkSyncProgress,k),Ce.off(ds.bulkSyncCompleted,C),Ce.off(ds.bulkSyncFailed,T)}},[]);const h=s||u,m=l?l.completedRepos/Math.max(l.totalRepos,1)*100:0,y=l?l.completedConversations/Math.max(l.totalConversations,1)*100:0,b=async()=>{d(!0);try{await e()}catch(_){console.error("Sync all failed:",_),d(!1)}},v=async()=>{d(!0);try{await t()}catch(_){console.error("Sync pending failed:",_),d(!1)}},x=async()=>{d(!0);try{await n()}catch(_){console.error("Initialize repos failed:",_),d(!1)}},w=async()=>{try{await r()}catch(_){console.error("Abort sync failed:",_)}};return f.jsxs(ho,{className:"w-full",children:[f.jsxs(po,{className:"pb-3",children:[f.jsxs(mo,{className:"flex items-center gap-2",children:[f.jsx(qc,{className:"h-5 w-5"}),"Bulk Git Sync"]}),f.jsx($c,{children:"Manage synchronization across all repositories and conversations"})]}),f.jsxs(go,{className:"space-y-4",children:[f.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"font-medium text-lg",children:i}),f.jsx("div",{className:"text-muted-foreground",children:"Repositories"})]}),f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"font-medium text-lg",children:a}),f.jsx("div",{className:"text-muted-foreground",children:"Total Conversations"})]}),f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:Ye("font-medium text-lg",o>0?"text-orange-600":"text-green-600"),children:o}),f.jsx("div",{className:"text-muted-foreground",children:"Pending Sync"})]})]}),f.jsx(zm,{}),l&&f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{className:"flex items-center justify-between text-sm",children:[f.jsx("span",{className:"font-medium",children:"Current Operation"}),f.jsx(as,{variant:l.errors.length>0?"destructive":"default",children:l.errors.length>0?"Errors":"Running"})]}),f.jsx("div",{className:"text-sm text-muted-foreground bg-muted p-2 rounded",children:l.currentOperation}),l.totalRepos>0&&f.jsxs("div",{className:"space-y-2",children:[f.jsxs("div",{className:"flex justify-between text-sm",children:[f.jsx("span",{children:"Repository Progress"}),f.jsxs("span",{children:[l.completedRepos,"/",l.totalRepos]})]}),f.jsx(Oy,{value:m,className:"h-2"})]}),l.totalConversations>0&&f.jsxs("div",{className:"space-y-2",children:[f.jsxs("div",{className:"flex justify-between text-sm",children:[f.jsx("span",{children:"Conversation Progress"}),f.jsxs("span",{children:[l.completedConversations,"/",l.totalConversations]})]}),f.jsx(Oy,{value:y,className:"h-2"})]}),l.errors.length>0&&f.jsxs("div",{className:"mt-2",children:[f.jsxs("div",{className:"flex items-center gap-2 text-sm text-destructive mb-2",children:[f.jsx(Sl,{className:"h-4 w-4"}),l.errors.length," Error",l.errors.length!==1?"s":""]}),f.jsxs("div",{className:"max-h-24 overflow-y-auto space-y-1",children:[l.errors.slice(0,5).map((_,k)=>f.jsxs("div",{className:"text-xs text-muted-foreground bg-destructive/10 p-2 rounded",children:[f.jsxs("span",{className:"font-medium",children:[_.type,":"]})," ",_.error]},k)),l.errors.length>5&&f.jsxs("div",{className:"text-xs text-muted-foreground",children:["...and ",l.errors.length-5," more errors"]})]})]})]}),f.jsx(zm,{}),f.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[f.jsx(wr,{children:f.jsxs(Sr,{children:[f.jsx(_r,{asChild:!0,children:f.jsxs(ot,{onClick:x,disabled:h||i===0,variant:"outline",size:"sm",className:"w-full",children:[f.jsx(Fc,{className:"h-4 w-4 mr-1"}),"Clone Repos"]})}),f.jsx(Cr,{children:"Initialize/clone all configured repositories"})]})}),f.jsx(wr,{children:f.jsxs(Sr,{children:[f.jsx(_r,{asChild:!0,children:f.jsxs(ot,{onClick:v,disabled:h||o===0,variant:"outline",size:"sm",className:"w-full",children:[f.jsx(GH,{className:"h-4 w-4 mr-1"}),"Sync Pending"]})}),f.jsx(Cr,{children:"Sync only conversations that need syncing"})]})}),f.jsx(wr,{children:f.jsxs(Sr,{children:[f.jsx(_r,{asChild:!0,children:f.jsxs(ot,{onClick:b,disabled:h||i===0&&a===0,size:"sm",className:"w-full",children:[f.jsx(Tm,{className:Ye("h-4 w-4 mr-1",h&&"animate-spin")}),"Sync All"]})}),f.jsx(Cr,{children:"Sync all repositories and conversations"})]})}),f.jsxs(ot,{onClick:w,disabled:!h,variant:"destructive",size:"sm",className:"w-full",children:[f.jsx(gme,{className:"h-4 w-4 mr-1"}),"Stop"]})]})]})]})},QVe=Ke({name:$e().min(1,"Repository Name is required."),remoteUrl:$e().min(1,"Remote URL is required.").url("Invalid URL format (e.g., https://github.com/user/repo.git)"),branch:$e().min(1,"Branch name is required (e.g., main)."),username:$e().nullable().optional(),password:$e().nullable().optional()}),kC={name:"",remoteUrl:"",branch:"main",username:null,password:null},eWe=()=>{const{syncRepos:e,addSyncRepo:t,updateSyncRepo:n,repoInitializationStatus:r,isLoading:s}=jn(mn(k=>({syncRepos:k.syncRepos,addSyncRepo:k.addSyncRepo,updateSyncRepo:k.updateSyncRepo,repoInitializationStatus:k.repoInitializationStatus,isLoading:k.isLoading}))),{autoSyncOnStreamComplete:i,setAutoSyncOnStreamComplete:a}=pr(mn(k=>({autoSyncOnStreamComplete:k.autoSyncOnStreamComplete,setAutoSyncOnStreamComplete:k.setAutoSyncOnStreamComplete}))),[o,l]=E.useState(!1),[c,u]=E.useState(null),[d,h]=E.useState({});E.useEffect(()=>{const k=C=>{C&&C.action==="deleted"&&C.repoId&&h(T=>({...T,[C.repoId]:!1}))};return Ce.on(ds.repoChanged,k),()=>Ce.off(ds.repoChanged,k)},[]);const m=ai({defaultValues:kC,validators:{onChangeAsync:QVe,onChangeAsyncDebounceMs:500},onSubmit:async({value:k})=>{var C,T,A,N;if(!((C=k.name)!=null&&C.trim())||!((T=k.remoteUrl)!=null&&T.trim())){ke.error("Repository Name and Remote URL are required.");return}try{const I={name:k.name.trim(),remoteUrl:k.remoteUrl.trim(),branch:((A=k.branch)==null?void 0:A.trim())||"main",username:((N=k.username)==null?void 0:N.trim())||null,password:k.password||null};c?await n(c,I):await t(I),y()}catch(I){console.error("Failed to save sync repo:",I)}}}),y=E.useCallback(()=>{m.reset(kC),l(!1),u(null)},[m]);E.useEffect(()=>{if(c){const k=e.find(C=>C.id===c);k?(m.reset({name:k.name,remoteUrl:k.remoteUrl,branch:k.branch||"main",username:k.username??null,password:k.password??null}),l(!1)):y()}else o||m.reset(kC)},[c,e,m,o,y]);const b=k=>{u(k.id),l(!1)},v=E.useCallback((k,C)=>{if(window.confirm(`Are you sure you want to delete the sync repository "${C}"? This will unlink it from any conversations and remove the local copy.`)){h(T=>({...T,[k]:!0}));try{Ce.emit(tr.deleteSyncRepoRequest,{id:k}),c===k&&y()}catch(T){console.error("Failed to delete sync repo:",T),h(A=>({...A,[k]:!1}))}}},[c,y]),x=E.useCallback(k=>{Ce.emit(tr.initializeOrSyncRepoRequest,{repoId:k})},[]),w=()=>{u(null),m.reset(kC),l(!0)},_=()=>f.jsxs("form",{onSubmit:k=>{k.preventDefault(),k.stopPropagation(),m.handleSubmit()},className:"border rounded-md p-4 space-y-3 bg-card shadow-md mb-4",children:[f.jsx("h4",{className:"font-semibold text-card-foreground",children:c?"Edit Sync Repository":"Add New Sync Repository"}),f.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[f.jsx(m.Field,{name:"name",children:k=>f.jsxs("div",{className:"sm:col-span-1 space-y-1.5",children:[f.jsx(Nt,{htmlFor:k.name,children:"Name"}),f.jsx(vn,{id:k.name,value:k.state.value??"",onChange:C=>k.handleChange(C.target.value),onBlur:k.handleBlur,placeholder:"e.g., My Backup",disabled:m.state.isSubmitting}),f.jsx(Li,{field:k})]})}),f.jsx(m.Field,{name:"remoteUrl",children:k=>f.jsxs("div",{className:"sm:col-span-2 space-y-1.5",children:[f.jsx(Nt,{htmlFor:k.name,children:"Remote URL (HTTPS)"}),f.jsx(vn,{id:k.name,type:"url",value:k.state.value??"",onChange:C=>k.handleChange(C.target.value),onBlur:k.handleBlur,placeholder:"https://github.com/user/repo.git",disabled:m.state.isSubmitting}),f.jsx(Li,{field:k})]})}),f.jsx(m.Field,{name:"branch",children:k=>f.jsxs("div",{className:"sm:col-span-1 space-y-1.5",children:[f.jsx(Nt,{htmlFor:k.name,children:"Branch"}),f.jsx(vn,{id:k.name,value:k.state.value??"",onChange:C=>k.handleChange(C.target.value),onBlur:k.handleBlur,placeholder:"main",disabled:m.state.isSubmitting}),f.jsx(Li,{field:k})]})})]}),f.jsxs("div",{className:"pt-2",children:[f.jsx(Nt,{className:"text-sm font-medium",children:"Authentication (Optional - Basic Auth/Token)"}),f.jsxs(XD,{variant:"destructive",className:"mt-2 mb-3",children:[f.jsx(rO,{className:"h-4 w-4"}),f.jsx(JD,{children:"Security Warning"}),f.jsx(QD,{className:"text-xs",children:"Storing credentials directly is insecure. Use a Personal Access Token (PAT) as the password if possible. Credentials are required only for private repositories."})]}),f.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[f.jsx(m.Field,{name:"username",children:k=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(Nt,{htmlFor:k.name,children:"Username"}),f.jsx(vn,{id:k.name,value:k.state.value??"",onChange:C=>k.handleChange(C.target.value),onBlur:k.handleBlur,placeholder:"Git Username (Optional)",disabled:m.state.isSubmitting,autoComplete:"off"}),f.jsx(Li,{field:k})]})}),f.jsx(m.Field,{name:"password",children:k=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(Nt,{htmlFor:k.name,children:"Password / Token"}),f.jsx(vn,{id:k.name,type:"password",value:k.state.value??"",onChange:C=>k.handleChange(C.target.value),onBlur:k.handleBlur,placeholder:"Password or PAT (Optional)",disabled:m.state.isSubmitting,autoComplete:"new-password"}),f.jsx(Li,{field:k})]})})]})]}),f.jsxs("div",{className:"flex justify-end space-x-2 pt-2",children:[f.jsxs(ot,{variant:"ghost",size:"sm",onClick:y,disabled:m.state.isSubmitting,type:"button",children:[f.jsx(Si,{className:"h-4 w-4 mr-1"})," Cancel"]}),f.jsx(m.Subscribe,{selector:k=>[k.canSubmit,k.isSubmitting,k.isValidating,k.isValid],children:([k,C,T,A])=>f.jsxs(ot,{variant:"secondary",size:"sm",type:"submit",disabled:C||!k||!A||T,children:[(C||T)&&f.jsx(Hn,{className:"h-4 w-4 mr-1 animate-spin"}),f.jsx(Yu,{className:"h-4 w-4 mr-1"})," ",C||T?"Saving...":"Save Repository"]})})]})]});return f.jsxs("div",{className:"space-y-6 p-1",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"text-lg font-medium",children:"Sync Repositories"}),f.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Configure remote Git repositories to synchronize conversations. Link conversations to a repo using the sync control in the chat input area. Use the 'Sync/Clone' button to initialize the local copy or pull updates."}),f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg bg-card",children:[f.jsxs("div",{className:"space-y-1",children:[f.jsx(Nt,{htmlFor:"auto-sync-toggle",className:"text-sm font-medium",children:"Auto-sync after stream completion"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Automatically sync conversations with linked repositories when a message stream completes"})]}),f.jsx(fo,{id:"auto-sync-toggle",checked:i,onCheckedChange:a})]}),f.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg bg-card",children:[f.jsxs("div",{className:"space-y-1",children:[f.jsx(Nt,{htmlFor:"auto-init-repos-toggle",className:"text-sm font-medium",children:"Auto-initialize repositories on startup"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Automatically clone/initialize configured repositories when the app starts (off by default)"})]}),f.jsx(fo,{id:"auto-init-repos-toggle",checked:pr(k=>k.autoInitializeReposOnStartup),onCheckedChange:pr.getState().setAutoInitializeReposOnStartup})]})]}),e.length>0&&f.jsx(JVe,{onSyncAll:async()=>{await jn.getState().syncAllConversations()},onSyncPending:async()=>{await jn.getState().syncPendingConversations()},onInitializeRepos:async()=>{await jn.getState().initializeAllRepositories()},onAbortSync:async()=>{const{BulkSyncService:k}=await Fr(async()=>{const{BulkSyncService:C}=await Promise.resolve().then(()=>Z0);return{BulkSyncService:C}},void 0);k.abort()},totalRepos:e.length,totalConversations:jn.getState().conversations.filter(k=>k.syncRepoId).length,pendingConversations:jn.getState().conversations.filter(k=>{const C=jn.getState().conversationSyncStatus[k.id];return k.syncRepoId&&C==="needs-sync"}).length})]}),!o&&!c&&f.jsxs(ot,{onClick:w,variant:"outline",className:"w-full mb-4",disabled:s,children:[f.jsx(nc,{className:"h-4 w-4 mr-1"})," Add Sync Repository"]}),(o||c)&&_(),f.jsxs("div",{children:[f.jsx("h4",{className:"text-md font-medium mb-2",children:"Configured Repositories"}),s&&!o&&!c?f.jsxs("div",{className:"space-y-2",children:[f.jsx(Gr,{className:"h-10 w-full"}),f.jsx(Gr,{className:"h-10 w-full"}),f.jsx(Gr,{className:"h-10 w-full"})]}):e.length===0&&!o&&!c?f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No sync repositories configured yet."}):f.jsx("div",{className:"border rounded-md overflow-x-auto",children:f.jsxs(Sf,{children:[f.jsx(vp,{children:f.jsxs(As,{children:[f.jsx(Rr,{children:"Name"}),f.jsx(Rr,{className:"hidden md:table-cell",children:"Remote URL"}),f.jsx(Rr,{className:"hidden lg:table-cell",children:"Branch"}),f.jsx(Rr,{className:"hidden lg:table-cell",children:"Auth"}),f.jsx(Rr,{className:"text-right",children:"Actions"})]})}),f.jsx(_f,{children:e.map(k=>{const C=d[k.id],T=c===k.id,A=!!k.username||!!k.password,N=r[k.id]||"idle",I=N==="syncing",j=C||m.state.isSubmitting||!!c||I;let L=null,D="Initialize/Sync Repository";return N==="syncing"?(L=f.jsx(Hn,{className:"h-4 w-4 animate-spin mr-1"}),D="Initializing/Syncing..."):N==="idle"?(L=f.jsx(C1,{className:"h-4 w-4 text-green-500 mr-1"}),D="Sync Successful / Ready"):N==="error"?(L=f.jsx(Sl,{className:"h-4 w-4 text-destructive mr-1"}),D="Sync Failed"):L=f.jsx(Tm,{className:"h-4 w-4 mr-1"}),f.jsxs(As,{className:Ye(T?"bg-muted/50":"",j&&!T?"opacity-70":""),children:[f.jsx(Bn,{className:"font-medium truncate max-w-[100px] sm:max-w-xs",children:k.name}),f.jsx(Bn,{className:"text-xs truncate max-w-[100px] sm:max-w-xs hidden md:table-cell",children:k.remoteUrl}),f.jsx(Bn,{className:"hidden lg:table-cell",children:k.branch||"main"}),f.jsx(Bn,{className:"text-xs hidden lg:table-cell",children:A?"Configured":"None"}),f.jsxs(Bn,{className:"text-right space-x-1",children:[f.jsx(Un,{tooltipText:D,onClick:()=>x(k.id),"aria-label":`Initialize or Sync repo ${k.name}`,disabled:j,icon:L,variant:"outline",className:"h-8 w-8"}),f.jsx(Un,{tooltipText:"Edit",onClick:()=>b(k),"aria-label":`Edit repo ${k.name}`,disabled:j,icon:f.jsx(k1,{}),className:"h-8 w-8"}),f.jsx(Un,{tooltipText:"Delete",onClick:()=>v(k.id,k.name),"aria-label":`Delete repo ${k.name}`,disabled:j,icon:C?f.jsx(Hn,{className:"h-4 w-4 animate-spin"}):f.jsx(Vo,{}),className:"text-destructive hover:text-destructive/80 h-8 w-8"})]})]},k.id)})})]})})]})]})},tWe=Ve.memo(eWe),nWe=()=>{const e=E.useMemo(()=>[{value:"config",label:"User Config",content:f.jsx(GVe,{})},{value:"sync",label:"Sync Repositories",content:f.jsx(tWe,{})}],[]);return f.jsx(Tl,{tabs:e,defaultValue:"config",className:"h-full",listClassName:"bg-muted/50 rounded-md",contentContainerClassName:"mt-4"})},rWe=Ve.memo(nWe);class sWe{constructor(){ce(this,"id","core-git-sync");ce(this,"unregisterPromptControlCallback",null);ce(this,"unregisterSettingsTabCallback",null);ce(this,"eventUnsubscribers",[]);ce(this,"modApiRef",null);ce(this,"selectedItemId",null);ce(this,"selectedItemType",null);ce(this,"syncRepos",[]);ce(this,"conversationSyncStatus",{});ce(this,"isStreaming",!1);ce(this,"autoSyncEnabled",!1);ce(this,"isBulkSyncing",!1);ce(this,"bulkSyncProgress",null);ce(this,"notifyComponentUpdate",null);ce(this,"linkConversationToRepo",(t,n)=>{var r;(r=this.modApiRef)==null||r.emit(tr.linkConversationToRepoRequest,{conversationId:t,repoId:n})});ce(this,"syncConversation",t=>{var n;(n=this.modApiRef)==null||n.emit(tr.syncConversationRequest,{conversationId:t})});ce(this,"getConversationById",t=>jn.getState().getConversationById(t));ce(this,"syncAllConversations",async()=>{await jn.getState().syncAllConversations()});ce(this,"syncPendingConversations",async()=>{await jn.getState().syncPendingConversations()});ce(this,"initializeAllRepositories",async()=>{await jn.getState().initializeAllRepositories()});ce(this,"abortBulkSync",async()=>{const{BulkSyncService:t}=await Fr(async()=>{const{BulkSyncService:n}=await Promise.resolve().then(()=>Z0);return{BulkSyncService:n}},void 0);t.abort()});ce(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){this.modApiRef=t,this.loadInitialState();const n=t.on(Tr.contextChanged,m=>{var y;this.selectedItemId=m.selectedItemId,this.selectedItemType=m.selectedItemType,(y=this.notifyComponentUpdate)==null||y.call(this)}),r=t.on(ds.repoChanged,()=>{var m;this.syncRepos=jn.getState().syncRepos,(m=this.notifyComponentUpdate)==null||m.call(this)}),s=t.on(tr.conversationSyncStatusChanged,m=>{var y;typeof m=="object"&&m&&"conversationId"in m&&"status"in m&&(this.conversationSyncStatus={...this.conversationSyncStatus,[m.conversationId]:m.status},(y=this.notifyComponentUpdate)==null||y.call(this))}),i=t.on(xn.statusChanged,m=>{var y;typeof m=="object"&&m&&"status"in m&&(this.isStreaming=m.status==="streaming",(y=this.notifyComponentUpdate)==null||y.call(this))}),a=t.on(xn.completed,async m=>{typeof m=="object"&&m&&"interactionId"in m&&"status"in m&&m.status==="COMPLETED"&&this.autoSyncEnabled&&await this.handleAutoSync()}),o=t.on(on.autoSyncOnStreamCompleteChanged,m=>{var y;typeof m=="object"&&m&&"enabled"in m&&(this.autoSyncEnabled=m.enabled,(y=this.notifyComponentUpdate)==null||y.call(this))}),l=t.on(ds.bulkSyncStarted,m=>{var y;typeof m=="object"&&m&&"progress"in m&&(this.isBulkSyncing=!0,this.bulkSyncProgress=m.progress,(y=this.notifyComponentUpdate)==null||y.call(this))}),c=t.on(ds.bulkSyncProgress,m=>{var y;typeof m=="object"&&m&&"progress"in m&&(this.bulkSyncProgress=m.progress,(y=this.notifyComponentUpdate)==null||y.call(this))}),u=t.on(ds.bulkSyncCompleted,m=>{var y;typeof m=="object"&&m&&"progress"in m&&(this.isBulkSyncing=!1,this.bulkSyncProgress=null,(y=this.notifyComponentUpdate)==null||y.call(this))}),d=t.on(ds.bulkSyncFailed,m=>{var y;typeof m=="object"&&m&&"progress"in m&&(this.isBulkSyncing=!1,this.bulkSyncProgress=null,(y=this.notifyComponentUpdate)==null||y.call(this))}),h=t.on(tr.conversationUpdated,m=>{var y;typeof m=="object"&&m&&"conversationId"in m&&"updates"in m&&m.conversationId===this.selectedItemId&&m.updates.syncRepoId!==void 0&&(this.loadInitialState(),(y=this.notifyComponentUpdate)==null||y.call(this))});this.eventUnsubscribers.push(n,r,s,i,a,o,l,c,u,d,h)}loadInitialState(){const t=jn.getState();this.selectedItemId=t.selectedItemId,this.selectedItemType=t.selectedItemType,this.syncRepos=t.syncRepos,this.conversationSyncStatus=t.conversationSyncStatus,this.isStreaming=nn.getState().status==="streaming",this.autoSyncEnabled=pr.getState().autoSyncOnStreamComplete}async handleAutoSync(){if(!this.selectedItemId||this.selectedItemType!=="conversation")return;const t=this.getConversationById(this.selectedItemId);if(!(t!=null&&t.syncRepoId))return;const n=this.conversationSyncStatus[this.selectedItemId];if(!(n==="syncing"||n==="idle")){console.log(`[GitSyncControlModule] Auto-syncing conversation ${this.selectedItemId}`);try{await this.syncConversation(this.selectedItemId)}catch(r){console.error("[GitSyncControlModule] Auto-sync failed:",r)}}}register(t){this.modApiRef=t,this.unregisterPromptControlCallback||(this.unregisterPromptControlCallback=t.registerPromptControl({id:this.id,triggerRenderer:()=>Ve.createElement(VVe,{module:this})})),this.unregisterSettingsTabCallback||(this.unregisterSettingsTabCallback=t.registerSettingsTab({id:"git",title:"Git",component:rWe,order:60}))}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterPromptControlCallback&&(this.unregisterPromptControlCallback(),this.unregisterPromptControlCallback=null),this.unregisterSettingsTabCallback&&(this.unregisterSettingsTabCallback(),this.unregisterSettingsTabCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const iWe=({module:e})=>{const[,t]=E.useState({});E.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const{syncRepos:n,repoInitializationStatus:r}=jn(mn(c=>({syncRepos:c.syncRepos,repoInitializationStatus:c.repoInitializationStatus}))),s=()=>{e.syncAllRepos()},i=c=>{e.syncRepo(c)},a=e.isSyncing,o=n.length>0,l=Object.values(r).some(c=>c==="syncing");return f.jsx(wr,{delayDuration:100,children:f.jsxs(gc,{children:[f.jsxs(Sr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(yc,{asChild:!0,children:f.jsx(ot,{variant:"ghost",size:"icon",className:"h-8 w-8",disabled:!o,"aria-label":"Manual Git Sync",children:a||l?f.jsx(Hn,{className:"h-4 w-4 animate-spin"}):f.jsx(qc,{className:"h-4 w-4"})})})}),f.jsx(Cr,{side:"top",children:o?"Manual Git Sync":"No sync repositories configured"})]}),f.jsx(bc,{className:"w-80 p-4",align:"start",children:f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("h4",{className:"font-semibold text-sm",children:"Git Sync Repositories"}),f.jsxs(ot,{variant:"outline",size:"sm",onClick:s,disabled:!o||a||l,className:"h-8",children:[a||l?f.jsx(Hn,{className:"h-3 w-3 mr-1 animate-spin"}):f.jsx(Tm,{className:"h-3 w-3 mr-1"}),"Sync All"]})]}),o?f.jsx("div",{className:"space-y-2",children:n.map(c=>{const u=r[c.id]||"idle",d=u==="syncing";return f.jsxs("div",{className:Ye("flex items-center justify-between p-3 border rounded-lg","bg-card hover:bg-muted/50 transition-colors"),children:[f.jsxs("div",{className:"min-w-0 flex-1",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("span",{className:"text-sm font-medium truncate",children:c.name}),f.jsx(as,{variant:u==="idle"?"secondary":u==="syncing"?"default":u==="error"?"destructive":"outline",className:"text-xs",children:u==="idle"?"Ready":u==="syncing"?"Syncing":u==="error"?"Error":"Unknown"})]}),f.jsx("p",{className:"text-xs text-muted-foreground truncate",children:c.branch||"main"})]}),f.jsx(ot,{variant:"ghost",size:"sm",onClick:()=>i(c.id),disabled:d||a,className:"h-8 w-8 p-0",children:d?f.jsx(Hn,{className:"h-3 w-3 animate-spin"}):f.jsx(Tm,{className:"h-3 w-3"})})]},c.id)})}):f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No sync repositories configured. Go to Settings → Git → Sync Repositories to add one."})]})})]})})};class aWe{constructor(){ce(this,"id","core-manual-git-sync-sidebar");ce(this,"unregisterCallback",null);ce(this,"eventUnsubscribers",[]);ce(this,"modApiRef",null);ce(this,"syncRepos",[]);ce(this,"repoInitializationStatus",{});ce(this,"isSyncing",!1);ce(this,"notifyComponentUpdate",null);ce(this,"syncAllRepos",async()=>{var t,n;if(!(this.isSyncing||this.syncRepos.length===0)){this.isSyncing=!0,(t=this.notifyComponentUpdate)==null||t.call(this);try{console.log("[ManualSyncSidebarControlModule] Starting bulk sync for all repositories and conversations");const{BulkSyncService:r}=await Fr(async()=>{const{BulkSyncService:s}=await Promise.resolve().then(()=>Z0);return{BulkSyncService:s}},void 0);await r.syncAll({syncRepos:!0,syncConversations:!0,continueOnError:!0,maxConcurrent:3}),console.log("[ManualSyncSidebarControlModule] Completed bulk sync")}catch(r){console.error("[ManualSyncSidebarControlModule] Error in bulk sync:",r)}finally{this.isSyncing=!1,(n=this.notifyComponentUpdate)==null||n.call(this)}}});ce(this,"syncRepo",async t=>{var r;const n=this.syncRepos.find(s=>s.id===t);if(!n){console.warn(`[ManualSyncSidebarControlModule] Repository ${t} not found`);return}console.log(`[ManualSyncSidebarControlModule] Starting sync for repository: ${n.name}`),(r=this.modApiRef)==null||r.emit(tr.initializeOrSyncRepoRequest,{repoId:t})});ce(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){this.modApiRef=t,this.loadInitialState();const n=t.on(ds.repoChanged,()=>{var i;this.syncRepos=jn.getState().syncRepos,(i=this.notifyComponentUpdate)==null||i.call(this)}),r=t.on(ds.repoInitStatusChanged,i=>{var a;typeof i=="object"&&i&&"repoId"in i&&"status"in i&&(this.repoInitializationStatus={...this.repoInitializationStatus,[i.repoId]:i.status},(a=this.notifyComponentUpdate)==null||a.call(this))}),s=t.on(tr.syncReposLoaded,()=>{var i;this.loadInitialState(),(i=this.notifyComponentUpdate)==null||i.call(this)});this.eventUnsubscribers.push(n,r,s)}loadInitialState(){const t=jn.getState();this.syncRepos=t.syncRepos,this.repoInitializationStatus=t.repoInitializationStatus}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}const n=()=>Ve.createElement(iWe,{module:this});this.unregisterCallback=t.registerChatControl({id:this.id,panel:"sidebar-footer",status:()=>"ready",renderer:n,iconRenderer:n,show:()=>!0})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const oWe=Ke({path:$e().optional().describe("The directory path to list within the VFS. Defaults to the current directory if omitted.")}),lWe=Ke({path:$e().describe("The path of the file to read within the VFS."),encoding:El(["utf-8","base64"]).optional().default("utf-8").describe("Encoding for reading the file (utf-8 or base64).")}),cWe=Ke({path:$e().describe("The path where the file should be written."),content:$e().describe("The content to write to the file."),encoding:El(["utf-8","base64"]).optional().default("utf-8").describe("Encoding of the provided content (utf-8 or base64).")}),uWe=Ke({path:$e().describe("The path of the file or directory to delete."),recursive:Qn().optional().default(!1).describe("Whether to delete directories recursively.")}),dWe=Ke({path:$e().describe("The path of the directory to create (including parents).")}),fWe=Ke({oldPath:$e().describe("The current path of the item to rename."),newName:$e().describe("The new name for the item.")});class hWe{constructor(){ce(this,"id","core-vfs-tools");ce(this,"unregisterCallbacks",[])}async initialize(t){console.log(`[${this.id}] Initialized.`)}register(t){if(this.unregisterCallbacks.length>0){console.warn(`[${this.id}] Already registered. Skipping.`);return}console.log(`[${this.id}] Registering Core VFS Tools...`);const n={description:"List files and directories in a specified VFS path, or the current path if none is given.",parameters:oWe};this.unregisterCallbacks.push(t.registerTool("vfsListFiles",n,async({path:l},c)=>{const u=c==null?void 0:c.fsInstance;if(!u)return{success:!1,error:"Filesystem instance not available in context."};const d=qr(l||"/");try{const h=await ND(d,{fsInstance:u});return{success:!0,path:d,entries:h.map(m=>({name:m.name,type:m.isDirectory?"folder":"file",size:m.size,lastModified:m.lastModified.toISOString()}))}}catch(h){return{success:!1,path:d,error:h.message}}}));const r={description:"Read the content of a file from the VFS.",parameters:lWe};this.unregisterCallbacks.push(t.registerTool("vfsReadFile",r,async({path:l,encoding:c},u)=>{const d=u==null?void 0:u.fsInstance;if(!d)return{success:!1,error:"Filesystem instance not available in context."};const h=qr(l);try{const m=await fp(h,{fsInstance:d});let y;return c==="base64"?y=btoa(String.fromCharCode(...m)):y=new TextDecoder().decode(m),{success:!0,path:h,content:y,encoding:c}}catch(m){return{success:!1,path:h,error:m.message}}}));const s={description:"Write content to a file in the VFS.",parameters:cWe};this.unregisterCallbacks.push(t.registerTool("vfsWriteFile",s,async({path:l,content:c,encoding:u},d)=>{const h=d==null?void 0:d.fsInstance;if(!h)return{success:!1,error:"Filesystem instance not available in context."};const m=qr(l);try{let y;if(u==="base64"){const b=atob(c),v=b.length,x=new Uint8Array(v);for(let w=0;w<v;w++)x[w]=b.charCodeAt(w);y=x}else y=c;return await xT(m,y,{fsInstance:h}),{success:!0,path:m}}catch(y){return{success:!1,path:m,error:y.message}}}));const i={description:"Delete a file or directory from the VFS.",parameters:uWe};this.unregisterCallbacks.push(t.registerTool("vfsDelete",i,async({path:l,recursive:c},u)=>{const d=u==null?void 0:u.fsInstance;if(!d)return{success:!1,error:"Filesystem instance not available in context."};const h=qr(l);try{return await ID(h,c,{fsInstance:d}),{success:!0,path:h}}catch(m){return{success:!1,path:h,error:m.message}}}));const a={description:"Create a directory (including parents) in the VFS.",parameters:dWe};this.unregisterCallbacks.push(t.registerTool("vfsCreateDirectory",a,async({path:l},c)=>{const u=c==null?void 0:c.fsInstance;if(!u)return{success:!1,error:"Filesystem instance not available in context."};const d=qr(l);try{return await KZ(d,{fsInstance:u}),{success:!0,path:d}}catch(h){return{success:!1,path:d,error:h.message}}}));const o={description:"Rename a file or directory in the VFS.",parameters:fWe};this.unregisterCallbacks.push(t.registerTool("vfsRename",o,async({oldPath:l,newName:c},u)=>{const d=u==null?void 0:u.fsInstance;if(!d)return{success:!1,error:"Filesystem instance not available in context."};const h=qr(l),m=qr(h.substring(0,h.lastIndexOf("/"))||"/"),y=Wu(m,c);try{return await ZZ(h,y,{fsInstance:d}),{success:!0,oldPath:h,newPath:y}}catch(b){return{success:!1,oldPath:h,newName:c,error:b.message}}})),console.log(`[${this.id}] Core VFS Tools Registered.`)}destroy(){this.unregisterCallbacks.forEach(t=>t()),this.unregisterCallbacks=[],console.log(`[${this.id}] Destroyed.`)}}const pWe=Ke({path:$e().describe("The directory path within the VFS to initialize as a Git repository.")}),mWe=Ke({path:$e().describe("The directory path of the Git repository within the VFS to commit."),message:$e().describe("The commit message.")}),gWe=Ke({path:$e().describe("The directory path of the Git repository within the VFS to pull from."),branch:$e().optional().describe("The branch name to pull.")}),yWe=Ke({path:$e().describe("The directory path of the Git repository within the VFS to push."),branch:$e().optional().describe("The branch name to push.")}),bWe=Ke({path:$e().describe("The directory path of the Git repository within the VFS to check status.")});class vWe{constructor(){ce(this,"id","core-git-tools");ce(this,"unregisterCallbacks",[])}async initialize(t){}register(t){if(this.unregisterCallbacks.length>0){console.warn(`[${this.id}] Already registered. Skipping.`);return}const n={description:"Initialize an empty Git repository in a VFS directory.",parameters:pWe};this.unregisterCallbacks.push(t.registerTool("gitInit",n,async({path:o},l)=>{const c=l==null?void 0:l.fsInstance;if(!c)return{success:!1,error:"Filesystem instance not available in context."};try{return await HZ(o,{fsInstance:c}),{success:!0,message:`Repository initialized at ${o}`}}catch(u){return{success:!1,error:u.message}}}));const r={description:"Stage all changes and commit them in a VFS Git repository.",parameters:mWe};this.unregisterCallbacks.push(t.registerTool("gitCommit",r,async({path:o,message:l},c)=>{const u=c==null?void 0:c.fsInstance;if(!u)return{success:!1,error:"Filesystem instance not available in context."};const d=pr.getState();if(!d.gitUserName||!d.gitUserEmail)return{success:!1,error:"Git user name and email not configured in settings. Cannot commit."};try{return await AD(o,l,{fsInstance:u}),{success:!0,message:`Changes committed in ${o}`}}catch(h){return{success:!1,error:h.message}}}));const s={description:"Pull changes from the remote repository for the specified branch.",parameters:gWe};this.unregisterCallbacks.push(t.registerTool("gitPull",s,async({path:o,branch:l},c)=>{const u=c==null?void 0:c.fsInstance;if(!u)return{success:!1,error:"Filesystem instance not available in context."};try{return await vT(o,l||"main",void 0,{fsInstance:u}),{success:!0,message:`Pulled changes for ${o}`}}catch(d){return{success:!1,error:d.message}}}));const i={description:"Push committed changes from the local branch to the remote repository.",parameters:yWe};this.unregisterCallbacks.push(t.registerTool("gitPush",i,async({path:o,branch:l},c)=>{const u=c==null?void 0:c.fsInstance;if(!u)return{success:!1,error:"Filesystem instance not available in context."};try{return await RD(o,l||"main",void 0,{fsInstance:u}),{success:!0,message:`Pushed changes for ${o}`}}catch(d){return{success:!1,error:d.message}}}));const a={description:"Get the Git status for a VFS repository.",parameters:bWe};this.unregisterCallbacks.push(t.registerTool("gitStatus",a,async({path:o},l)=>{const c=l==null?void 0:l.fsInstance;if(!c)return{success:!1,error:"Filesystem instance not available in context."};try{return await GZ(o,{fsInstance:c}),{success:!0,message:`Status checked for ${o}`}}catch(u){return{success:!1,error:u.message}}}))}destroy(){this.unregisterCallbacks.forEach(t=>t()),this.unregisterCallbacks=[],console.log(`[${this.id}] Destroyed.`)}}class xWe{constructor(){ce(this,"id","core-mcp-tools");ce(this,"unregisterCallbacks",[]);ce(this,"mcpToolUnregisterCallbacks",[]);ce(this,"mcpClients",new Map);ce(this,"modApi");ce(this,"connectionAttempts",new Map);ce(this,"retryTimeouts",new Map)}async initialize(t){this.modApi=t,globalThis.mcpToolsModuleInstance=this,Ce.emit(Er.loadMcpStateRequest,void 0),this.setupEventListeners(),await this.initializeMcpClients()}register(t){}destroy(){this.retryTimeouts.forEach(t=>{clearTimeout(t)}),this.retryTimeouts.clear(),this.connectionAttempts.clear(),this.mcpClients.forEach(t=>{try{t.client&&typeof t.client.disconnect=="function"&&t.client.disconnect()}catch(n){console.error(`[${this.id}] Error disconnecting MCP client ${t.id}:`,n)}}),this.mcpClients.clear(),this.unregisterCallbacks.forEach(t=>t()),this.unregisterCallbacks=[],this.mcpToolUnregisterCallbacks.forEach(t=>t()),this.mcpToolUnregisterCallbacks=[]}setupEventListeners(){const t=n=>{this.initializeMcpClients().catch(r=>{console.error(`[${this.id}] Error reinitializing MCP clients:`,r)})};Ce.on(Er.serversChanged,t),this.unregisterCallbacks.push(()=>{Ce.off(Er.serversChanged,t)})}getRetryConfig(){const t=pl.getState();return{maxAttempts:t.retryAttempts,baseDelay:t.retryDelay,timeout:t.connectionTimeout}}async initializeMcpClients(){try{const n=pl.getState().servers.filter(r=>r.enabled);this.connectionAttempts.clear(),this.retryTimeouts.forEach(r=>{clearTimeout(r)}),this.retryTimeouts.clear(),this.mcpClients.forEach(r=>{try{r.client&&typeof r.client.disconnect=="function"&&r.client.disconnect()}catch(s){console.error(`[${this.id}] Error disconnecting existing MCP client ${r.id}:`,s)}}),this.mcpClients.clear(),this.mcpToolUnregisterCallbacks.forEach(r=>r()),this.mcpToolUnregisterCallbacks=[];for(const r of n)this.connectToMcpServerWithRetry(r)}catch(t){console.error(`[${this.id}] Error initializing MCP clients:`,t),ke.error("Failed to initialize MCP clients",{description:t instanceof Error?t.message:"Unknown error occurred"})}}async connectToMcpServerWithRetry(t){const n=this.getRetryConfig(),r=this.connectionAttempts.get(t.id)||0;try{await this.connectToMcpServer(t),this.connectionAttempts.delete(t.id);const s=this.retryTimeouts.get(t.id);s&&(clearTimeout(s),this.retryTimeouts.delete(t.id)),ke.success(`Connected to MCP server: ${t.name}`,{description:"Successfully connected and loaded tools"})}catch(s){if(console.error(`[${this.id}] Failed to connect to MCP server ${t.name} (attempt ${r+1}):`,s),pl.getState().setServerStatus({serverId:t.id,connected:!1,error:s instanceof Error?s.message:"Connection failed",lastConnected:void 0,toolCount:0,tools:[]}),r<n.maxAttempts){this.connectionAttempts.set(t.id,r+1);const a=r+1,o=n.baseDelay*Math.pow(1.5,r),l=setTimeout(()=>{this.retryTimeouts.delete(t.id),this.connectToMcpServerWithRetry(t)},o);this.retryTimeouts.set(t.id,l),ke.warning(`MCP server connection failed: ${t.name}`,{description:`Retrying in ${Math.round(o/1e3)}s (attempt ${a+1}/${n.maxAttempts+1})`})}else{this.connectionAttempts.delete(t.id);const a=s instanceof Error?s.message:"Connection failed";ke.error(`Failed to connect to MCP server: ${t.name}`,{description:`All ${n.maxAttempts+1} connection attempts failed. ${a}`,duration:1e4}),console.error(`[${this.id}] All retry attempts exhausted for MCP server ${t.name}`)}}}async connectToMcpServer(t){const n=this.getRetryConfig();try{let r,s="streamable-http";if(t.url.startsWith("stdio://"))r=await this.connectWithStdioTransport(t),s="stdio";else{const i=new Promise((a,o)=>{setTimeout(()=>{o(new Error(`Connection timeout after ${n.timeout}ms`))},n.timeout)});try{r=await Promise.race([this.connectWithStreamableHttp(t),i]),s="streamable-http"}catch{r=await Promise.race([this.connectWithSseTransport(t),i]),s="sse"}}await this.handleSuccessfulConnection(t,r,s)}catch(r){let s=r;throw r instanceof Error&&(r.message.includes("Bridge service not healthy")||r.message.includes("stdio bridge connection failed")?s=new Error("Stdio MCP server requires LiteChat MCP Bridge. Please install and start the bridge service: npm install -g litechat-mcp-bridge && litechat-mcp-bridge"):r.message.includes("fetch")?s=new Error(`Network error: Unable to reach MCP server at ${t.url}. Please check if the server is running and accessible.`):r.message.includes("timeout")?s=new Error(`Connection timeout: MCP server at ${t.url} did not respond within ${n.timeout}ms.`):r.message.includes("401")||r.message.includes("403")?s=new Error(`Authentication error: Invalid credentials for MCP server at ${t.url}.`):r.message.includes("404")?s=new Error(`Server not found: MCP server endpoint ${t.url} does not exist.`):r.message.includes("500")&&(s=new Error(`Server error: MCP server at ${t.url} returned an internal server error.`))),console.error(`[${this.id}] Failed to connect to MCP server ${t.name}:`,s),s}}async connectWithStreamableHttp(t){const n=this.createStreamableHttpTransport(t);return P7({transport:n})}async getBridgeUrl(){const n=pl.getState().bridgeConfig||{};if(n.url)return n.url;if(n.host||n.port){const r=n.host||"localhost",s=n.port||3001;return`http://${r}:${s}`}return"http://localhost:3001"}async connectWithStdioTransport(t){var o;if(!t.url.startsWith("stdio://"))throw new Error("Not a stdio server configuration");const n=new URL(t.url),r=n.hostname||n.pathname.replace("//",""),s=n.searchParams.get("args")||"";if(!r)throw new Error("stdio:// URL must specify a command (e.g., stdio://npx?args=-y,@modelcontextprotocol/server-filesystem,.)");const i=await this.getBridgeUrl(),a=`${r}-${Date.now()}`;try{const l=new URLSearchParams;l.set("command",r),s&&l.set("args",s);const c=`${i}/servers/${a}/mcp?${l.toString()}`,u=await fetch(c,{method:"POST",headers:{"Content-Type":"application/json",...t.headers||{}},body:JSON.stringify({jsonrpc:"2.0",id:1,method:"tools/list",params:{}})});if(!u.ok)throw new Error(`Failed to get tools: ${u.status} ${u.statusText}`);const d=await u.json();if(d.error)throw new Error(`Tools request failed: ${d.error.message}`);let h=0;return{tools:((o=d.result)==null?void 0:o.tools)||[],serverEndpoint:c,callTool:async m=>{const y=`${Date.now()}_${++h}`,b=await fetch(c,{method:"POST",headers:{"Content-Type":"application/json",...t.headers||{}},body:JSON.stringify({jsonrpc:"2.0",id:y,method:"tools/call",params:{name:m.name,arguments:m.arguments}})});if(!b.ok)throw new Error(`Tool call failed: ${b.status} ${b.statusText}`);const v=await b.json();if(v.error)throw new Error(`Tool execution failed: ${v.error.message}`);return v.result}}}catch(l){throw new Error(`Bridge connection failed: ${l instanceof Error?l.message:l}. Ensure bridge is running with: npm run mcp-proxy. Command: ${r}, Args: ${s||"none"}`)}}async connectWithSseTransport(t){return P7({transport:{type:"sse",url:t.url,headers:t.headers||{}}})}createStreamableHttpTransport(t){let n=null,r=!1;return{async start(){const s=await fetch(t.url,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json, text/event-stream",Origin:window.location.origin,...t.headers},body:JSON.stringify({jsonrpc:"2.0",id:`init_${Date.now()}`,method:"initialize",params:{protocolVersion:"2025-03-26",capabilities:{tools:{}},clientInfo:{name:"LiteChat",version:"1.0.0"}}})});if(!s.ok)throw new Error(`HTTP ${s.status}: ${s.statusText}`);n=s.headers.get("Mcp-Session-Id");const i=await s.json();if(i.error)throw new Error(`MCP Initialize Error: ${i.error.message}`);const a=await fetch(t.url,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json",Origin:window.location.origin,...n&&{"Mcp-Session-Id":n},...t.headers},body:JSON.stringify({jsonrpc:"2.0",method:"initialized",params:{}})});if(!a.ok)throw new Error(`Failed to send initialized notification: ${a.status}`);r=!0},async send(s){var o,l;if(!r)throw new Error("Transport not connected");const i=await fetch(t.url,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json, text/event-stream",Origin:window.location.origin,...n&&{"Mcp-Session-Id":n},...t.headers},body:JSON.stringify(s)});if(!i.ok)throw i.status===404&&n?(n=null,r=!1,new Error("Session expired, reinitializing connection")):new Error(`HTTP ${i.status}: ${i.statusText}`);const a=i.headers.get("Content-Type")||"";if(a.includes("text/event-stream"))(o=i.body)==null||o.getReader();else if(a.includes("application/json")){const c=await i.json();(l=this.onmessage)==null||l.call(this,c)}},async close(){var s;if(n)try{await fetch(t.url,{method:"DELETE",headers:{Origin:window.location.origin,"Mcp-Session-Id":n,...t.headers}})}catch{}r=!1,n=null,(s=this.onclose)==null||s.call(this)},onclose:void 0,onerror:void 0,onmessage:void 0}}async handleSuccessfulConnection(t,n,r){let s;try{if(n.tools&&Array.isArray(n.tools))s={},n.tools.forEach(l=>{s[l.name]={description:l.description,parameters:l.inputSchema}});else throw console.error(`[${this.id}] Bridge client missing tools array:`,n),new Error("Bridge client missing tools array")}catch(l){throw console.error(`[${this.id}] Failed to retrieve tools from ${t.name}:`,l),console.error(`[${this.id}] Error stack:`,l instanceof Error?l.stack:"No stack trace available"),l}const i={id:t.id,name:t.name,client:n,tools:s,transport:r};this.mcpClients.set(t.id,i),i.tools=s,this.modApi&&Object.entries(s).forEach(([l,c])=>{const u=`mcp_${t.name}_${l}`,d=c;let h;if(d.parameters&&typeof d.parameters=="object"&&d.parameters.properties){const v={},x=d.parameters.required||[];for(const[w,_]of Object.entries(d.parameters.properties)){let k;switch(_.type){case"string":k=$e();break;case"number":k=Tt();break;case"boolean":k=Qn();break;case"array":k=cn(sf());break;case"object":k=Ke({}).passthrough();break;default:k=sf()}_.description&&(k=k.describe(_.description)),x.includes(w)||(k=k.optional()),v[w]=k}h=Ke(v)}else h=Ke({});const m={description:d.description||`MCP tool ${l} from ${t.name}`,parameters:h},y=async v=>{const x=await i.client.callTool({name:l,arguments:v});return x&&x.content?Array.isArray(x.content)?x.content.map(_=>_.type==="text"?_.text:_.type==="image"?`[Image: ${_.mimeType||"unknown format"}]`:JSON.stringify(_)).join(`
`):typeof x.content=="string"?x.content:JSON.stringify(x.content):JSON.stringify(x)},b=this.modApi.registerTool(u,m,y);this.mcpToolUnregisterCallbacks.push(b),Ce.emit(Er.toolDiscovered,{toolName:l,serverId:t.id,serverName:t.name,toolDefinition:d})}),pl.getState().setServerStatus({serverId:t.id,connected:!0,error:void 0,lastConnected:new Date,toolCount:Object.keys(s).length,tools:Object.keys(s)});const o={"streamable-http":"Streamable HTTP (latest)",sse:"SSE (legacy)",stdio:"Stdio (local bridge)"};ke.success(`Connected to MCP server: ${t.name}`,{description:`Using ${o[r]} transport with ${Object.keys(s).length} tools`})}retryServerConnection(t){const r=pl.getState().servers.find(a=>a.id===t);if(!r){console.error(`[${this.id}] Server with ID ${t} not found`);return}if(!r.enabled)return;this.connectionAttempts.delete(t);const s=this.retryTimeouts.get(t);s&&(clearTimeout(s),this.retryTimeouts.delete(t));const i=this.mcpClients.get(t);if(i){try{i.client&&typeof i.client.disconnect=="function"&&i.client.disconnect()}catch(a){console.error(`[${this.id}] Error disconnecting existing client for ${r.name}:`,a)}this.mcpClients.delete(t)}this.connectToMcpServerWithRetry(r)}getConnectionStatus(){const t={},n=pl.getState();return n.servers.forEach(r=>{const s=n.serverStatuses[r.id];t[r.id]={connected:(s==null?void 0:s.connected)||!1,error:s==null?void 0:s.error,toolCount:(s==null?void 0:s.toolCount)||0}}),t}registerMcpToolWithAI(t,n){const r=this.mcpClients.get(t);if(!r)return console.error(`[${this.id}] No MCP client found for server ${t}`),()=>{};const s=r.tools[n];if(!s)return console.error(`[${this.id}] Tool ${n} not found in server ${r.name}`),()=>{};if(!this.modApi)return console.error(`[${this.id}] ModApi not available for tool registration`),()=>{};const i=`mcp_${r.name}_${n}`;try{const a={description:s.description||`MCP tool ${n} from ${r.name}`,parameters:s.parameters||Ke({})},o=async c=>{const u=await r.client.callTool({name:n,arguments:c});let d="";u&&u.content?Array.isArray(u.content)?d=u.content.map(m=>m.type==="text"?m.text:m.type==="image"?`[Image: ${m.mimeType||"unknown format"}]`:JSON.stringify(m)).join(`
`):typeof u.content=="string"?d=u.content:d=JSON.stringify(u.content):d=JSON.stringify(u);const{maxResponseSize:h}=pl.getState();return d.length>h&&(d=d.substring(0,h)+`

[... response truncated due to size ...]`),d},l=this.modApi.registerTool(i,a,o);return this.mcpToolUnregisterCallbacks.push(l),Ce.emit(Er.toolRegistered,{toolName:n,serverId:r.id,serverName:r.name,prefixedToolName:i}),l}catch(a){return console.error(`[${this.id}] Error registering MCP tool ${n} with AI SDK:`,a),()=>{}}}unregisterMcpToolFromAI(t,n){const r=this.mcpClients.get(t);if(!r){console.error(`[${this.id}] No MCP client found for server ${t}`);return}const s=`mcp_${r.name}_${n}`;Ce.emit(Er.toolUnregistered,{toolName:n,serverId:r.id,prefixedToolName:s})}}const wWe=(e,t=80)=>e.length<=t?e:e.slice(0,t).trim()+"...",lie=({enabledTools:e,onToggleTool:t,onToggleAll:n,disabled:r=!1,className:s,maxSteps:i,onMaxStepsChange:a,globalDefaultMaxSteps:o=5,showMaxSteps:l=!1,disabledMessage:c})=>{const u=Bi(x=>x.tools),[d,h]=E.useState(""),m=E.useMemo(()=>Object.entries(u).map(([x,{definition:w,modId:_}])=>({name:x,description:w.description??"No description provided.",modId:_})).sort((x,w)=>x.name.localeCompare(w.name)),[u]),y=E.useMemo(()=>{const x=d.trim().toLowerCase();return x?m.filter(w=>w.name.toLowerCase().includes(x)||w.description.toLowerCase().includes(x)||w.modId.toLowerCase().includes(x)):m},[m,d]),b=E.useCallback(x=>{if(!a)return;const w=x.target.value;if(w===""){a(null);return}const _=parseInt(w,10);if(isNaN(_))a(null);else{const k=Math.max(1,Math.min(20,_));a(k)}},[a]),v=i===null?"":String(i);return f.jsxs("div",{className:Ye("p-4 max-w-2xl space-y-3",s),children:[f.jsx("h4",{className:"text-sm font-medium",children:"Available Tools"}),f.jsxs("div",{className:"relative",children:[f.jsx(vo,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),f.jsx(vn,{type:"search",placeholder:"Filter tools...",value:d,onChange:x=>h(x.target.value),className:"pl-8 h-9",disabled:r})]}),f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsxs(Nt,{className:"text-xs text-muted-foreground",children:[y.length," tools shown (",e.size," enabled)"]}),f.jsxs("div",{className:"space-x-2",children:[f.jsx(ot,{variant:"outline",size:"sm",onClick:()=>n(!0,m.map(x=>x.name)),disabled:r||m.length===0,children:"Enable All"}),f.jsx(ot,{variant:"outline",size:"sm",onClick:()=>n(!1,m.map(x=>x.name)),disabled:r||m.length===0||e.size===0,children:"Disable All"})]})]}),f.jsx("div",{className:"border rounded-md bg-background/50",children:r&&c?f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:c}):m.length===0?f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No tools registered."}):y.length===0?f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No tools match filter."}):f.jsx(Xo,{className:"h-96 w-full",children:f.jsx("div",{className:"p-2 space-y-1",children:y.map(x=>f.jsxs("div",{className:"flex items-center justify-between p-1.5 rounded hover:bg-muted",children:[f.jsx(fo,{id:`tool-switch-${x.name}`,checked:e.has(x.name),onCheckedChange:w=>t(x.name,w),className:"flex-shrink-0",disabled:r}),f.jsxs("div",{className:"flex-grow pl-2 space-y-0.5",children:[f.jsx(Nt,{htmlFor:`tool-switch-${x.name}`,className:Ye("block text-sm font-medium",r?"cursor-not-allowed":"cursor-pointer"),children:x.name}),f.jsxs(Sr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx("span",{className:"block text-xs text-muted-foreground break-words cursor-help",children:wWe(x.description)})}),f.jsx(Cr,{side:"bottom",className:"max-w-sm",children:f.jsxs("div",{className:"space-y-1",children:[f.jsx("div",{className:"font-medium",children:x.name}),f.jsxs("div",{className:"text-xs opacity-90",children:["From: ",x.modId]}),f.jsx("div",{className:"text-xs",children:x.description})]})})]})]})]},x.name))})})}),l&&f.jsxs("div",{className:"pt-2",children:[f.jsx(Nt,{htmlFor:"local-max-steps",className:"text-xs font-medium",children:"Max Tool Steps (This Turn)"}),f.jsx(vn,{id:"local-max-steps",type:"number",min:"1",max:"20",step:"1",value:v,onChange:b,className:"w-20 h-8 text-xs mt-1",placeholder:String(o),disabled:r}),f.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Overrides the global setting for the next message only (1-20). Leave blank to use default."})]})]})},SWe=({module:e,popoverMaxSteps:t,setPopoverMaxSteps:n,className:r})=>{const s=e.getEnabledTools(),i=e.getSelectedItemId(),a=e.getSelectedItemType(),o=e.getGlobalDefaultMaxSteps(),l=E.useCallback((h,m)=>{e.setEnabledTools(y=>{const b=new Set(y);return m?b.add(h):b.delete(h),b})},[e]),c=E.useCallback((h,m)=>{e.setEnabledTools(()=>h?new Set(m):new Set)},[e]),u=a!=="conversation"||!i;return f.jsx(lie,{enabledTools:s,onToggleTool:l,onToggleAll:c,disabled:u,className:r,maxSteps:t,onMaxStepsChange:n,globalDefaultMaxSteps:o,showMaxSteps:!0,disabledMessage:"Select a conversation to manage tools."})},_We=({module:e})=>{const[,t]=E.useState({});E.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const[n,r]=E.useState(!1),[s,i]=E.useState(e.getMaxStepsOverride()),a=e.getEnabledTools(),o=e.getMaxStepsOverride(),l=e.getIsStreaming(),c=e.getIsVisible();E.useEffect(()=>{i(e.getMaxStepsOverride())},[e.getMaxStepsOverride()]);const u=m=>{r(m),!m&&s!==e.getMaxStepsOverride()&&e.setMaxStepsOverride(s)},d=a.size>0||o!==null,h=l;return c?f.jsxs(gc,{open:n,onOpenChange:u,children:[f.jsx(wr,{delayDuration:100,children:f.jsxs(Sr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(yc,{asChild:!0,children:f.jsx(ot,{variant:d?"secondary":"ghost",size:"icon",className:"h-8 w-8",disabled:h,"aria-label":"Configure Tools",children:f.jsx(Am,{className:"h-4 w-4"})})})}),f.jsx(Cr,{side:"top",children:`Tools (${a.size} enabled)`})]})}),f.jsx(bc,{className:"w-auto p-0",align:"start",children:f.jsx(SWe,{module:e,popoverMaxSteps:s,setPopoverMaxSteps:i})})]}):null};class CWe{constructor(){ce(this,"id","core-tool-selector");ce(this,"unregisterCallback",null);ce(this,"eventUnsubscribers",[]);ce(this,"transientEnabledTools",new Set);ce(this,"transientMaxStepsOverride",null);ce(this,"isStreaming",!1);ce(this,"isVisible",!0);ce(this,"selectedItemId",null);ce(this,"selectedItemType",null);ce(this,"allToolsCount",0);ce(this,"globalDefaultMaxSteps",5);ce(this,"notifyComponentUpdate",null);ce(this,"getEnabledTools",()=>this.transientEnabledTools);ce(this,"getMaxStepsOverride",()=>this.transientMaxStepsOverride);ce(this,"getIsStreaming",()=>this.isStreaming);ce(this,"getIsVisible",()=>this.isVisible);ce(this,"getSelectedItemId",()=>this.selectedItemId);ce(this,"getSelectedItemType",()=>this.selectedItemType);ce(this,"getAllToolsCount",()=>this.allToolsCount);ce(this,"getGlobalDefaultMaxSteps",()=>this.globalDefaultMaxSteps);ce(this,"setEnabledTools",t=>{var n;this.transientEnabledTools=t(this.transientEnabledTools),(n=this.notifyComponentUpdate)==null||n.call(this)});ce(this,"setMaxStepsOverride",t=>{var n;this.transientMaxStepsOverride=t,(n=this.notifyComponentUpdate)==null||n.call(this)});ce(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){var o;this.loadInitialState(),this.updateVisibility(),(o=this.notifyComponentUpdate)==null||o.call(this);const n=t.on(xn.statusChanged,l=>{var c;typeof l=="object"&&l&&"status"in l&&this.isStreaming!==(l.status==="streaming")&&(this.isStreaming=l.status==="streaming",(c=this.notifyComponentUpdate)==null||c.call(this))}),r=t.on(Vn.selectedModelChanged,()=>{var l;this.updateVisibility(),(l=this.notifyComponentUpdate)==null||l.call(this)}),s=t.on(Tr.contextChanged,l=>{var c;this.selectedItemId=l.selectedItemId,this.selectedItemType=l.selectedItemType,this.updateVisibility(),(c=this.notifyComponentUpdate)==null||c.call(this)}),i=t.on(on.toolMaxStepsChanged,l=>{var c;typeof l=="object"&&l&&"steps"in l&&(this.globalDefaultMaxSteps=l.steps,(c=this.notifyComponentUpdate)==null||c.call(this))}),a=t.on(Ur.toolsChanged,l=>{var c;if(l&&typeof l.tools=="object"){const u=Object.keys(l.tools).length;this.allToolsCount!==u&&(this.allToolsCount=u,this.updateVisibility(),(c=this.notifyComponentUpdate)==null||c.call(this))}});this.eventUnsubscribers.push(n,r,s,i,a)}loadInitialState(){this.isStreaming=nn.getState().status==="streaming",this.selectedItemId=jn.getState().selectedItemId,this.selectedItemType=jn.getState().selectedItemType,this.allToolsCount=Object.keys(Bi.getState().tools).length,this.globalDefaultMaxSteps=pr.getState().toolMaxSteps}updateVisibility(){var a,o;const{getSelectedModel:t}=Gn.getState(),n=t(),r=this.allToolsCount>0,s=((o=(a=n==null?void 0:n.metadata)==null?void 0:a.supported_parameters)==null?void 0:o.includes("tools"))??!1,i=r&&s;this.isVisible!==i&&(this.isVisible=i)}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,triggerRenderer:()=>Ve.createElement(_We,{module:this}),getMetadata:()=>{if(this.transientEnabledTools.size>0||this.transientMaxStepsOverride!==null)return{enabledTools:Array.from(this.transientEnabledTools),...this.transientMaxStepsOverride!==null&&{maxSteps:this.transientMaxStepsOverride}}},clearOnSubmit:()=>{var r;let n=!1;this.transientEnabledTools.size>0&&(this.transientEnabledTools=new Set,n=!0),this.transientMaxStepsOverride!==null&&(this.transientMaxStepsOverride=null,n=!0),n&&((r=this.notifyComponentUpdate)==null||r.call(this))}})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,console.log(`[${this.id}] Destroyed.`)}}var iV=1,kWe=.9,EWe=.8,TWe=.17,Cj=.1,kj=.999,AWe=.9999,RWe=.99,NWe=/[\\\/_+.#"@\[\(\{&]/,IWe=/[\\\/_+.#"@\[\(\{&]/g,MWe=/[\s-]/,cie=/[\s-]/g;function WP(e,t,n,r,s,i,a){if(i===t.length)return s===e.length?iV:RWe;var o=`${s},${i}`;if(a[o]!==void 0)return a[o];for(var l=r.charAt(i),c=n.indexOf(l,s),u=0,d,h,m,y;c>=0;)d=WP(e,t,n,r,c+1,i+1,a),d>u&&(c===s?d*=iV:NWe.test(e.charAt(c-1))?(d*=EWe,m=e.slice(s,c-1).match(IWe),m&&s>0&&(d*=Math.pow(kj,m.length))):MWe.test(e.charAt(c-1))?(d*=kWe,y=e.slice(s,c-1).match(cie),y&&s>0&&(d*=Math.pow(kj,y.length))):(d*=TWe,s>0&&(d*=Math.pow(kj,c-s))),e.charAt(c)!==t.charAt(i)&&(d*=AWe)),(d<Cj&&n.charAt(c-1)===r.charAt(i+1)||r.charAt(i+1)===r.charAt(i)&&n.charAt(c-1)!==r.charAt(i))&&(h=WP(e,t,n,r,c+1,i+2,a),h*Cj>d&&(d=h*Cj)),d>u&&(u=d),c=n.indexOf(l,c+1);return a[o]=u,u}function aV(e){return e.toLowerCase().replace(cie," ")}function jWe(e,t,n){return e=n&&n.length>0?`${e+" "+n.join(" ")}`:e,WP(e,t,aV(e),aV(t),0,0,{})}var Jv='[cmdk-group=""]',Ej='[cmdk-group-items=""]',PWe='[cmdk-group-heading=""]',uie='[cmdk-item=""]',oV=`${uie}:not([aria-disabled="true"])`,HP="cmdk-item-select",C0="data-value",OWe=(e,t,n)=>jWe(e,t,n),die=E.createContext(void 0),bS=()=>E.useContext(die),fie=E.createContext(void 0),b6=()=>E.useContext(fie),hie=E.createContext(void 0),pie=E.forwardRef((e,t)=>{let n=k0(()=>{var ee,re;return{search:"",value:(re=(ee=e.value)!=null?ee:e.defaultValue)!=null?re:"",selectedItemId:void 0,filtered:{count:0,items:new Map,groups:new Set}}}),r=k0(()=>new Set),s=k0(()=>new Map),i=k0(()=>new Map),a=k0(()=>new Set),o=mie(e),{label:l,children:c,value:u,onValueChange:d,filter:h,shouldFilter:m,loop:y,disablePointerSelection:b=!1,vimBindings:v=!0,...x}=e,w=pa(),_=pa(),k=pa(),C=E.useRef(null),T=HWe();Um(()=>{if(u!==void 0){let ee=u.trim();n.current.value=ee,A.emit()}},[u]),Um(()=>{T(6,H)},[]);let A=E.useMemo(()=>({subscribe:ee=>(a.current.add(ee),()=>a.current.delete(ee)),snapshot:()=>n.current,setState:(ee,re,de)=>{var me,De,je,Te;if(!Object.is(n.current[ee],re)){if(n.current[ee]=re,ee==="search")D(),j(),T(1,L);else if(ee==="value"){if(document.activeElement.hasAttribute("cmdk-input")||document.activeElement.hasAttribute("cmdk-root")){let _e=document.getElementById(k);_e?_e.focus():(me=document.getElementById(w))==null||me.focus()}if(T(7,()=>{var _e;n.current.selectedItemId=(_e=O())==null?void 0:_e.id,A.emit()}),de||T(5,H),((De=o.current)==null?void 0:De.value)!==void 0){let _e=re??"";(Te=(je=o.current).onValueChange)==null||Te.call(je,_e);return}}A.emit()}},emit:()=>{a.current.forEach(ee=>ee())}}),[]),N=E.useMemo(()=>({value:(ee,re,de)=>{var me;re!==((me=i.current.get(ee))==null?void 0:me.value)&&(i.current.set(ee,{value:re,keywords:de}),n.current.filtered.items.set(ee,I(re,de)),T(2,()=>{j(),A.emit()}))},item:(ee,re)=>(r.current.add(ee),re&&(s.current.has(re)?s.current.get(re).add(ee):s.current.set(re,new Set([ee]))),T(3,()=>{D(),j(),n.current.value||L(),A.emit()}),()=>{i.current.delete(ee),r.current.delete(ee),n.current.filtered.items.delete(ee);let de=O();T(4,()=>{D(),(de==null?void 0:de.getAttribute("id"))===ee&&L(),A.emit()})}),group:ee=>(s.current.has(ee)||s.current.set(ee,new Set),()=>{i.current.delete(ee),s.current.delete(ee)}),filter:()=>o.current.shouldFilter,label:l||e["aria-label"],getDisablePointerSelection:()=>o.current.disablePointerSelection,listId:w,inputId:k,labelId:_,listInnerRef:C}),[]);function I(ee,re){var de,me;let De=(me=(de=o.current)==null?void 0:de.filter)!=null?me:OWe;return ee?De(ee,n.current.search,re):0}function j(){if(!n.current.search||o.current.shouldFilter===!1)return;let ee=n.current.filtered.items,re=[];n.current.filtered.groups.forEach(me=>{let De=s.current.get(me),je=0;De.forEach(Te=>{let _e=ee.get(Te);je=Math.max(_e,je)}),re.push([me,je])});let de=C.current;K().sort((me,De)=>{var je,Te;let _e=me.getAttribute("id"),Ue=De.getAttribute("id");return((je=ee.get(Ue))!=null?je:0)-((Te=ee.get(_e))!=null?Te:0)}).forEach(me=>{let De=me.closest(Ej);De?De.appendChild(me.parentElement===De?me:me.closest(`${Ej} > *`)):de.appendChild(me.parentElement===de?me:me.closest(`${Ej} > *`))}),re.sort((me,De)=>De[1]-me[1]).forEach(me=>{var De;let je=(De=C.current)==null?void 0:De.querySelector(`${Jv}[${C0}="${encodeURIComponent(me[0])}"]`);je==null||je.parentElement.appendChild(je)})}function L(){let ee=K().find(de=>de.getAttribute("aria-disabled")!=="true"),re=ee==null?void 0:ee.getAttribute(C0);A.setState("value",re||void 0)}function D(){var ee,re,de,me;if(!n.current.search||o.current.shouldFilter===!1){n.current.filtered.count=r.current.size;return}n.current.filtered.groups=new Set;let De=0;for(let je of r.current){let Te=(re=(ee=i.current.get(je))==null?void 0:ee.value)!=null?re:"",_e=(me=(de=i.current.get(je))==null?void 0:de.keywords)!=null?me:[],Ue=I(Te,_e);n.current.filtered.items.set(je,Ue),Ue>0&&De++}for(let[je,Te]of s.current)for(let _e of Te)if(n.current.filtered.items.get(_e)>0){n.current.filtered.groups.add(je);break}n.current.filtered.count=De}function H(){var ee,re,de;let me=O();me&&(((ee=me.parentElement)==null?void 0:ee.firstChild)===me&&((de=(re=me.closest(Jv))==null?void 0:re.querySelector(PWe))==null||de.scrollIntoView({block:"nearest"})),me.scrollIntoView({block:"nearest"}))}function O(){var ee;return(ee=C.current)==null?void 0:ee.querySelector(`${uie}[aria-selected="true"]`)}function K(){var ee;return Array.from(((ee=C.current)==null?void 0:ee.querySelectorAll(oV))||[])}function U(ee){let re=K()[ee];re&&A.setState("value",re.getAttribute(C0))}function W(ee){var re;let de=O(),me=K(),De=me.findIndex(Te=>Te===de),je=me[De+ee];(re=o.current)!=null&&re.loop&&(je=De+ee<0?me[me.length-1]:De+ee===me.length?me[0]:me[De+ee]),je&&A.setState("value",je.getAttribute(C0))}function B(ee){let re=O(),de=re==null?void 0:re.closest(Jv),me;for(;de&&!me;)de=ee>0?VWe(de,Jv):WWe(de,Jv),me=de==null?void 0:de.querySelector(oV);me?A.setState("value",me.getAttribute(C0)):W(ee)}let ne=()=>U(K().length-1),V=ee=>{ee.preventDefault(),ee.metaKey?ne():ee.altKey?B(1):W(1)},Q=ee=>{ee.preventDefault(),ee.metaKey?U(0):ee.altKey?B(-1):W(-1)};return E.createElement(Kn.div,{ref:t,tabIndex:-1,...x,"cmdk-root":"",onKeyDown:ee=>{var re;(re=x.onKeyDown)==null||re.call(x,ee);let de=ee.nativeEvent.isComposing||ee.keyCode===229;if(!(ee.defaultPrevented||de))switch(ee.key){case"n":case"j":{v&&ee.ctrlKey&&V(ee);break}case"ArrowDown":{V(ee);break}case"p":case"k":{v&&ee.ctrlKey&&Q(ee);break}case"ArrowUp":{Q(ee);break}case"Home":{ee.preventDefault(),U(0);break}case"End":{ee.preventDefault(),ne();break}case"Enter":{ee.preventDefault();let me=O();if(me){let De=new Event(HP);me.dispatchEvent(De)}}}}},E.createElement("label",{"cmdk-label":"",htmlFor:N.inputId,id:N.labelId,style:KWe},l),tA(e,ee=>E.createElement(fie.Provider,{value:A},E.createElement(die.Provider,{value:N},ee))))}),DWe=E.forwardRef((e,t)=>{var n,r;let s=pa(),i=E.useRef(null),a=E.useContext(hie),o=bS(),l=mie(e),c=(r=(n=l.current)==null?void 0:n.forceMount)!=null?r:a==null?void 0:a.forceMount;Um(()=>{if(!c)return o.item(s,a==null?void 0:a.id)},[c]);let u=gie(s,i,[e.value,e.children,i],e.keywords),d=b6(),h=Zh(T=>T.value&&T.value===u.current),m=Zh(T=>c||o.filter()===!1?!0:T.search?T.filtered.items.get(s)>0:!0);E.useEffect(()=>{let T=i.current;if(!(!T||e.disabled))return T.addEventListener(HP,y),()=>T.removeEventListener(HP,y)},[m,e.onSelect,e.disabled]);function y(){var T,A;b(),(A=(T=l.current).onSelect)==null||A.call(T,u.current)}function b(){d.setState("value",u.current,!0)}if(!m)return null;let{disabled:v,value:x,onSelect:w,forceMount:_,keywords:k,...C}=e;return E.createElement(Kn.div,{ref:wl(i,t),...C,id:s,"cmdk-item":"",role:"option","aria-disabled":!!v,"aria-selected":!!h,"data-disabled":!!v,"data-selected":!!h,onPointerMove:v||o.getDisablePointerSelection()?void 0:b,onClick:v?void 0:y},e.children)}),FWe=E.forwardRef((e,t)=>{let{heading:n,children:r,forceMount:s,...i}=e,a=pa(),o=E.useRef(null),l=E.useRef(null),c=pa(),u=bS(),d=Zh(m=>s||u.filter()===!1?!0:m.search?m.filtered.groups.has(a):!0);Um(()=>u.group(a),[]),gie(a,o,[e.value,e.heading,l]);let h=E.useMemo(()=>({id:a,forceMount:s}),[s]);return E.createElement(Kn.div,{ref:wl(o,t),...i,"cmdk-group":"",role:"presentation",hidden:d?void 0:!0},n&&E.createElement("div",{ref:l,"cmdk-group-heading":"","aria-hidden":!0,id:c},n),tA(e,m=>E.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":n?c:void 0},E.createElement(hie.Provider,{value:h},m))))}),LWe=E.forwardRef((e,t)=>{let{alwaysRender:n,...r}=e,s=E.useRef(null),i=Zh(a=>!a.search);return!n&&!i?null:E.createElement(Kn.div,{ref:wl(s,t),...r,"cmdk-separator":"",role:"separator"})}),BWe=E.forwardRef((e,t)=>{let{onValueChange:n,...r}=e,s=e.value!=null,i=b6(),a=Zh(c=>c.search),o=Zh(c=>c.selectedItemId),l=bS();return E.useEffect(()=>{e.value!=null&&i.setState("search",e.value)},[e.value]),E.createElement(Kn.input,{ref:t,...r,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":l.listId,"aria-labelledby":l.labelId,"aria-activedescendant":o,id:l.inputId,type:"text",value:s?e.value:a,onChange:c=>{s||i.setState("search",c.target.value),n==null||n(c.target.value)}})}),$We=E.forwardRef((e,t)=>{let{children:n,label:r="Suggestions",...s}=e,i=E.useRef(null),a=E.useRef(null),o=Zh(c=>c.selectedItemId),l=bS();return E.useEffect(()=>{if(a.current&&i.current){let c=a.current,u=i.current,d,h=new ResizeObserver(()=>{d=requestAnimationFrame(()=>{let m=c.offsetHeight;u.style.setProperty("--cmdk-list-height",m.toFixed(1)+"px")})});return h.observe(c),()=>{cancelAnimationFrame(d),h.unobserve(c)}}},[]),E.createElement(Kn.div,{ref:wl(i,t),...s,"cmdk-list":"",role:"listbox",tabIndex:-1,"aria-activedescendant":o,"aria-label":r,id:l.listId},tA(e,c=>E.createElement("div",{ref:wl(a,l.listInnerRef),"cmdk-list-sizer":""},c)))}),zWe=E.forwardRef((e,t)=>{let{open:n,onOpenChange:r,overlayClassName:s,contentClassName:i,container:a,...o}=e;return E.createElement(Dre,{open:n,onOpenChange:r},E.createElement(Fre,{container:a},E.createElement(Lre,{"cmdk-overlay":"",className:s}),E.createElement(Bre,{"aria-label":e.label,"cmdk-dialog":"",className:i},E.createElement(pie,{ref:t,...o}))))}),UWe=E.forwardRef((e,t)=>Zh(n=>n.filtered.count===0)?E.createElement(Kn.div,{ref:t,...e,"cmdk-empty":"",role:"presentation"}):null),qWe=E.forwardRef((e,t)=>{let{progress:n,children:r,label:s="Loading...",...i}=e;return E.createElement(Kn.div,{ref:t,...i,"cmdk-loading":"",role:"progressbar","aria-valuenow":n,"aria-valuemin":0,"aria-valuemax":100,"aria-label":s},tA(e,a=>E.createElement("div",{"aria-hidden":!0},a)))}),Tb=Object.assign(pie,{List:$We,Item:DWe,Input:BWe,Group:FWe,Separator:LWe,Dialog:zWe,Empty:UWe,Loading:qWe});function VWe(e,t){let n=e.nextElementSibling;for(;n;){if(n.matches(t))return n;n=n.nextElementSibling}}function WWe(e,t){let n=e.previousElementSibling;for(;n;){if(n.matches(t))return n;n=n.previousElementSibling}}function mie(e){let t=E.useRef(e);return Um(()=>{t.current=e}),t}var Um=typeof window>"u"?E.useEffect:E.useLayoutEffect;function k0(e){let t=E.useRef();return t.current===void 0&&(t.current=e()),t}function Zh(e){let t=b6(),n=()=>e(t.snapshot());return E.useSyncExternalStore(t.subscribe,n,n)}function gie(e,t,n,r=[]){let s=E.useRef(),i=bS();return Um(()=>{var a;let o=(()=>{var c;for(let u of n){if(typeof u=="string")return u.trim();if(typeof u=="object"&&"current"in u)return u.current?(c=u.current.textContent)==null?void 0:c.trim():s.current}})(),l=r.map(c=>c.trim());i.value(e,o,l),(a=t.current)==null||a.setAttribute(C0,o),s.current=o}),s}var HWe=()=>{let[e,t]=E.useState(),n=k0(()=>new Map);return Um(()=>{n.current.forEach(r=>r()),n.current=new Map},[e]),(r,s)=>{n.current.set(r,s),t({})}};function GWe(e){let t=e.type;return typeof t=="function"?t(e.props):"render"in t?t.render(e.props):e}function tA({asChild:e,children:t},n){return e&&E.isValidElement(t)?E.cloneElement(GWe(t),{ref:t.ref},n(t.props.children)):n(t)}var KWe={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};function YWe({className:e,...t}){return f.jsx(Tb,{"data-slot":"command",className:Ye("bg-popover text-popover-foreground flex h-full w-full flex-col overflow-hidden rounded-md",e),...t})}function ZWe({className:e,...t}){return f.jsxs("div",{"data-slot":"command-input-wrapper",className:"flex h-9 items-center gap-2 border-b px-3",children:[f.jsx(vo,{className:"size-4 shrink-0 opacity-50"}),f.jsx(Tb.Input,{"data-slot":"command-input",className:Ye("placeholder:text-muted-foreground flex h-10 w-full rounded-md bg-transparent py-3 text-sm outline-hidden disabled:cursor-not-allowed disabled:opacity-50",e),...t})]})}function XWe({className:e,...t}){return f.jsx(Tb.List,{"data-slot":"command-list",className:Ye("max-h-[300px] scroll-py-1 overflow-x-hidden overflow-y-auto",e),...t})}function JWe({...e}){return f.jsx(Tb.Empty,{"data-slot":"command-empty",className:"py-6 text-center text-sm",...e})}function QWe({className:e,...t}){return f.jsx(Tb.Group,{"data-slot":"command-group",className:Ye("text-foreground [&_[cmdk-group-heading]]:text-muted-foreground overflow-hidden p-1 [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium",e),...t})}function eHe({className:e,...t}){return f.jsx(Tb.Item,{"data-slot":"command-item",className:Ye("data-[selected=true]:bg-accent data-[selected=true]:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled=true]:pointer-events-none data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...t})}const xp=({models:e,value:t,onChange:n,className:r,disabled:s,isLoading:i})=>{const[a,o]=E.useState(!1),[l,c]=E.useState(""),[u,d]=E.useState({reasoning:!1,webSearch:!1,tools:!1,multimodal:!1,imageGeneration:!1}),h=E.useMemo(()=>{let w=e;if(l.trim()){const k=l.toLowerCase();w=e.filter(C=>C.name.toLowerCase().includes(k)||C.providerName.toLowerCase().includes(k)||C.id.toLowerCase().includes(k))}const _=Object.entries(u).filter(([,k])=>k).map(([k])=>k);return _.length===0?w:w.filter(k=>{var N,I,j;const C=new Set(((N=k.metadataSummary)==null?void 0:N.supported_parameters)??[]),T=new Set(((I=k.metadataSummary)==null?void 0:I.input_modalities)??[]),A=new Set(((j=k.metadataSummary)==null?void 0:j.output_modalities)??[]);return _.every(L=>{switch(L){case"reasoning":return C.has("reasoning");case"webSearch":return C.has("web_search")||C.has("web_search_options");case"tools":return C.has("tools");case"multimodal":return Array.from(T).some(D=>D!=="text");case"imageGeneration":return A.has("image");default:return!0}})})},[e,l,u]),m=E.useMemo(()=>e.find(w=>w.id===t),[e,t]),y=E.useCallback(w=>{const _=w===t?null:w;n==null||n(_),o(!1),c("")},[t,n]),b=w=>{d(_=>({..._,[w]:!_[w]}))};if(i)return f.jsx(Gr,{className:Ye("h-9 w-[250px]",r)});const x=Object.values(u).filter(Boolean).length;return f.jsxs(gc,{open:a,onOpenChange:o,children:[f.jsx(yc,{asChild:!0,children:f.jsxs(ot,{variant:"outline",role:"combobox","aria-expanded":a,disabled:s||e.length===0,className:Ye("w-auto justify-between h-9 text-sm font-normal relative",r),children:[f.jsx("span",{className:"truncate max-w-[200px] sm:max-w-[300px]",children:m?`${m.name} (${m.providerName})`:"Select Model..."}),f.jsx(EE,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"}),x>0&&f.jsx("span",{className:"absolute -top-1 -right-1 inline-flex items-center justify-center px-1.5 py-0.5 text-xs font-semibold leading-none text-white bg-primary rounded-full",children:x})]})}),f.jsx(bc,{className:"w-[--radix-popover-trigger-width] p-0",style:{maxHeight:"min(40vh, 400px)",overflow:"hidden",zIndex:9999,pointerEvents:"auto"},onMouseDown:w=>w.preventDefault(),onClick:w=>w.stopPropagation(),onPointerDown:w=>w.stopPropagation(),onPointerDownCapture:w=>w.stopPropagation(),children:f.jsxs(YWe,{shouldFilter:!1,children:[f.jsxs("div",{className:"flex items-center border-b px-3",children:[f.jsx(vo,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),f.jsx(ZWe,{placeholder:"Search model...",value:l,onValueChange:c,className:"flex h-10 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50 border-0 focus-visible:ring-0 focus-visible:ring-offset-0"}),f.jsxs("div",{className:"flex items-center gap-0.5 ml-auto pl-2",children:[f.jsx(ot,{variant:u.reasoning?"secondary":"ghost",size:"sm",className:Ye("h-7 w-7 p-0",u.reasoning&&"text-primary"),onClick:()=>b("reasoning"),title:"Filter: Reasoning","aria-label":"Filter by reasoning capability",children:f.jsx(v2,{className:"h-4 w-4"})}),f.jsx(ot,{variant:u.webSearch?"secondary":"ghost",size:"sm",className:Ye("h-7 w-7 p-0",u.webSearch&&"text-primary"),onClick:()=>b("webSearch"),title:"Filter: Web Search","aria-label":"Filter by web search capability",children:f.jsx(x2,{className:"h-4 w-4"})}),f.jsx(ot,{variant:u.tools?"secondary":"ghost",size:"sm",className:Ye("h-7 w-7 p-0",u.tools&&"text-primary"),onClick:()=>b("tools"),title:"Filter: Tools","aria-label":"Filter by tool usage capability",children:f.jsx(Am,{className:"h-4 w-4"})}),f.jsx(ot,{variant:u.multimodal?"secondary":"ghost",size:"sm",className:Ye("h-7 w-7 p-0",u.multimodal&&"text-primary"),onClick:()=>b("multimodal"),title:"Filter: Multimodal","aria-label":"Filter by multimodal capability",children:f.jsx(Mh,{className:"h-4 w-4"})}),f.jsx(ot,{variant:u.imageGeneration?"secondary":"ghost",size:"sm",className:Ye("h-7 w-7 p-0",u.imageGeneration&&"text-primary"),onClick:()=>b("imageGeneration"),title:"Filter: Image Generation","aria-label":"Filter by image generation capability",children:f.jsx(cy,{className:"h-4 w-4"})})]})]}),f.jsxs(XWe,{className:"max-h-[calc(min(40vh,400px)-70px)] overflow-y-auto",children:[f.jsx(JWe,{children:x>0?"No models match all active filters.":e.length===0?"No models available.":"No model found."}),f.jsx(QWe,{children:h.map(w=>{var _,k,C,T,A,N,I,j,L,D,H,O;return f.jsx(eHe,{value:w.id,onSelect:y,className:"flex items-center",children:f.jsxs("div",{className:"flex-1 truncate flex justify-between items-center",children:[f.jsxs("div",{children:[f.jsx("div",{className:"text-sm font-medium",children:w.name}),f.jsx("div",{className:"text-xs text-muted-foreground",children:w.providerName})]}),f.jsxs("div",{className:"flex gap-1 ml-2",children:[((k=(_=w.metadataSummary)==null?void 0:_.supported_parameters)==null?void 0:k.includes("reasoning"))&&f.jsx(v2,{className:"h-3.5 w-3.5 text-purple-500"}),(((T=(C=w.metadataSummary)==null?void 0:C.supported_parameters)==null?void 0:T.includes("web_search"))||((N=(A=w.metadataSummary)==null?void 0:A.supported_parameters)==null?void 0:N.includes("web_search_options")))&&f.jsx(x2,{className:"h-3.5 w-3.5 text-blue-500"}),((j=(I=w.metadataSummary)==null?void 0:I.supported_parameters)==null?void 0:j.includes("tools"))&&f.jsx(Am,{className:"h-3.5 w-3.5 text-orange-500"}),((D=(L=w.metadataSummary)==null?void 0:L.input_modalities)==null?void 0:D.some(K=>K!=="text"))&&f.jsx(Mh,{className:"h-3.5 w-3.5 text-green-500"}),((O=(H=w.metadataSummary)==null?void 0:H.output_modalities)==null?void 0:O.includes("image"))&&f.jsx(cy,{className:"h-3.5 w-3.5 text-pink-500"})]})]})},w.id)})})]})]})})]})},Tj=Ke({systemPrompt:$e().nullable(),modelId:$e().nullable()}),tHe=({initialSystemPrompt:e,initialModelId:t,onSave:n,effectiveSystemPrompt:r,effectiveModelId:s,isParentSaving:i=!1})=>{var u;const{getAvailableModelListItems:a}=Gn(mn(d=>({getAvailableModelListItems:d.getAvailableModelListItems}))),o=a(),l=((u=o.find(d=>d.id===s))==null?void 0:u.name)||s,c=ai({defaultValues:{systemPrompt:e??null,modelId:t??null},validators:{onChangeAsync:Tj,onChangeAsyncDebounceMs:500},onSubmit:async({value:d})=>{await n({systemPrompt:d.systemPrompt,modelId:d.modelId})}});return E.useEffect(()=>{c.reset({systemPrompt:e??null,modelId:t??null})},[e,t,c]),f.jsxs("form",{onSubmit:d=>{d.preventDefault(),d.stopPropagation(),c.handleSubmit()},className:"space-y-6",children:[f.jsx(c.Field,{name:"systemPrompt",validators:{onChange:Tj.shape.systemPrompt},children:d=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(Nt,{htmlFor:`${d.name}-textarea`,children:"System Prompt (Overrides Parent/Global)"}),f.jsx(Ci,{id:`${d.name}-textarea`,placeholder:`Inherited: ${(r==null?void 0:r.substring(0,100))||"Default"}${r&&r.length>100?"...":""}`,value:d.state.value??"",onChange:h=>d.handleChange(h.target.value),onBlur:d.handleBlur,rows:6,disabled:c.state.isSubmitting||i,className:"mt-1"}),f.jsx(Li,{field:d}),f.jsx(ot,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>c.setFieldValue("systemPrompt",null),disabled:c.state.isSubmitting||i||d.state.value===null,type:"button",children:"Use Inherited/Default"})]})}),f.jsx(c.Field,{name:"modelId",validators:{onChange:Tj.shape.modelId},children:d=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(Nt,{children:"Default Model (Overrides Parent/Global)"}),f.jsx(xp,{models:o,value:d.state.value,onChange:h=>{d.handleChange(h),d.handleBlur()},disabled:c.state.isSubmitting||i,className:"w-full mt-1"}),f.jsx(Li,{field:d}),f.jsxs(ot,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>c.setFieldValue("modelId",null),disabled:c.state.isSubmitting||i||d.state.value===null,type:"button",children:["Use Inherited/Default (",l||"Global Default",")"]})]})}),f.jsx("div",{className:"flex justify-end pt-2",children:f.jsx(c.Subscribe,{selector:d=>[d.canSubmit,d.isSubmitting,d.isValidating,d.isValid],children:([d,h,m,y])=>f.jsxs(ot,{type:"submit",size:"sm",disabled:i||!d||h||m||!y,children:[(h||m)&&f.jsx(Hn,{className:"h-4 w-4 mr-1 animate-spin"}),f.jsx(Yu,{className:"h-4 w-4 mr-1"}),h||m?"Saving...":"Save Prompt Settings"]})})})]})};function v0({field:e}){return e.state.meta.isTouched&&e.state.meta.errors.length>0?f.jsx("em",{className:"text-xs text-destructive pt-1 block",children:e.state.meta.errors.join(", ")}):null}const nHe=({form:e,isSaving:t,effectiveTemperature:n,effectiveMaxTokens:r,effectiveTopP:s,effectiveTopK:i,effectivePresencePenalty:a,effectiveFrequencyPenalty:o})=>f.jsxs("div",{className:"space-y-4",children:[f.jsx(e.Field,{name:"temperature",children:l=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsxs(Nt,{htmlFor:l.name,className:"text-xs",children:["Temperature (",(l.state.value??n??.7).toFixed(2),")"]}),f.jsx(P0,{id:l.name,min:0,max:1,step:.01,value:[l.state.value??n??.7],onValueChange:c=>l.handleChange(c[0]),onBlur:l.handleBlur,disabled:t}),f.jsxs(ot,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>l.handleChange(null),disabled:t||l.state.value===null,children:["Use Inherited/Default (",(n==null?void 0:n.toFixed(2))??"N/A",")"]}),f.jsx(v0,{field:l})]})}),f.jsx(e.Field,{name:"topP",children:l=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsxs(Nt,{htmlFor:l.name,className:"text-xs",children:["Top P (",(l.state.value??s??1).toFixed(2),")"]}),f.jsx(P0,{id:l.name,min:0,max:1,step:.01,value:[l.state.value??s??1],onValueChange:c=>l.handleChange(c[0]),onBlur:l.handleBlur,disabled:t}),f.jsxs(ot,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>l.handleChange(null),disabled:t||l.state.value===null,children:["Use Inherited/Default (",(s==null?void 0:s.toFixed(2))??"N/A",")"]}),f.jsx(v0,{field:l})]})}),f.jsxs("div",{className:"grid grid-cols-2 gap-4 items-end",children:[f.jsx(e.Field,{name:"maxTokens",children:l=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(Nt,{htmlFor:l.name,className:"text-xs",children:"Max Tokens"}),f.jsx(vn,{id:l.name,type:"number",placeholder:`Inherited: ${r??"Default"}`,value:l.state.value??"",onChange:c=>l.handleChange(c.target.value===""?null:parseInt(c.target.value,10)),onBlur:l.handleBlur,min:"1",className:"h-8 text-xs",disabled:t}),f.jsx(ot,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>l.handleChange(null),disabled:t||l.state.value===null,children:"Use Inherited/Default"}),f.jsx(v0,{field:l})]})}),f.jsx(e.Field,{name:"topK",children:l=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(Nt,{htmlFor:l.name,className:"text-xs",children:"Top K"}),f.jsx(vn,{id:l.name,type:"number",placeholder:`Inherited: ${i??"Default"}`,value:l.state.value??"",onChange:c=>l.handleChange(c.target.value===""?null:parseInt(c.target.value,10)),onBlur:l.handleBlur,min:"1",className:"h-8 text-xs",disabled:t}),f.jsx(ot,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>l.handleChange(null),disabled:t||l.state.value===null,children:"Use Inherited/Default"}),f.jsx(v0,{field:l})]})})]}),f.jsx(e.Field,{name:"presencePenalty",children:l=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsxs(Nt,{htmlFor:l.name,className:"text-xs",children:["Presence Penalty (",(l.state.value??a??0).toFixed(2),")"]}),f.jsx(P0,{id:l.name,min:-2,max:2,step:.01,value:[l.state.value??a??0],onValueChange:c=>l.handleChange(c[0]),onBlur:l.handleBlur,disabled:t}),f.jsxs(ot,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>l.handleChange(null),disabled:t||l.state.value===null,children:["Use Inherited/Default (",(a==null?void 0:a.toFixed(2))??"N/A",")"]}),f.jsx(v0,{field:l})]})}),f.jsx(e.Field,{name:"frequencyPenalty",children:l=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsxs(Nt,{htmlFor:l.name,className:"text-xs",children:["Frequency Penalty (",(l.state.value??o??0).toFixed(2),")"]}),f.jsx(P0,{id:l.name,min:-2,max:2,step:.01,value:[l.state.value??o??0],onValueChange:c=>l.handleChange(c[0]),onBlur:l.handleBlur,disabled:t}),f.jsxs(ot,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>l.handleChange(null),disabled:t||l.state.value===null,children:["Use Inherited/Default (",(o==null?void 0:o.toFixed(2))??"N/A",")"]}),f.jsx(v0,{field:l})]})})]}),lV=Ke({syncRepoId:$e().nullable()}),rHe=({initialSyncRepoId:e,onSave:t,effectiveSyncRepoId:n,syncRepos:r,isParentSaving:s=!1})=>{var o;const i=((o=r.find(l=>l.id===n))==null?void 0:o.name)??"None",a=ai({defaultValues:{syncRepoId:e??null},validators:{onChangeAsync:lV,onChangeAsyncDebounceMs:500},onSubmit:async({value:l})=>{await t(l)}});return E.useEffect(()=>{a.reset({syncRepoId:e??null})},[e,a]),f.jsxs("form",{onSubmit:l=>{l.preventDefault(),l.stopPropagation(),a.handleSubmit()},className:"space-y-6",children:[f.jsx(a.Field,{name:"syncRepoId",validators:{onChange:lV.shape.syncRepoId},children:l=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(Nt,{htmlFor:l.name,children:"Sync Repository (Overrides Parent/Global)"}),f.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Link this project to a sync repository. All new conversations created within this project will automatically inherit this link."}),f.jsxs(sc,{value:l.state.value??"none",onValueChange:c=>{l.handleChange(c==="none"?null:c),l.handleBlur()},disabled:a.state.isSubmitting||s||r.length===0,children:[f.jsx(ac,{id:l.name,children:f.jsx(ic,{placeholder:r.length===0?"No sync repos configured":`Inherited: ${i}`})}),f.jsxs(oc,{children:[f.jsx(wi,{value:"none",children:f.jsxs("span",{className:"text-muted-foreground",children:["Use Inherited/Default (",i,")"]})}),r.map(c=>f.jsx(wi,{value:c.id,children:c.name},c.id))]})]}),f.jsx(Li,{field:l}),f.jsx(ot,{variant:"link",size:"sm",className:"text-xs h-auto p-0 mt-1 text-muted-foreground",onClick:()=>a.setFieldValue("syncRepoId",null),disabled:a.state.isSubmitting||s||l.state.value===null,type:"button",children:"Use Inherited/Default"})]})}),f.jsx("div",{className:"flex justify-end pt-2",children:f.jsx(a.Subscribe,{selector:l=>[l.canSubmit,l.isSubmitting,l.isValidating,l.isValid],children:([l,c,u,d])=>f.jsxs(ot,{type:"submit",size:"sm",disabled:s||!l||c||u||!d||r.length===0,children:[(c||u)&&f.jsx(Hn,{className:"h-4 w-4 mr-1 animate-spin"}),f.jsx(Yu,{className:"h-4 w-4 mr-1"}),c||u?"Saving...":"Save Sync Settings"]})})})]})},sHe=({projectId:e})=>{const t=E.useMemo(()=>[{value:"manage",label:"Manage Files",content:f.jsx("div",{className:"flex-grow border rounded-md overflow-hidden h-full",children:e?f.jsx(y6,{}):f.jsx("div",{className:"p-4 text-center text-muted-foreground",children:"Invalid Project ID. Cannot load filesystem."})})},{value:"settings",label:"Settings",content:f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx(Nt,{children:"Project Filesystem Info"}),f.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"Each project has its own dedicated Virtual File System (VFS)."}),f.jsxs("div",{className:"p-3 border rounded bg-muted/30 text-sm mb-2 break-all",children:[" ",f.jsxs("p",{children:[f.jsx("span",{className:"font-medium",children:"Project ID (VFS Key):"})," ",f.jsx("code",{className:"text-xs",children:e||"N/A"})]})]})]}),f.jsxs("div",{className:"border-t pt-4 border-destructive/50 mt-4 flex-shrink-0",children:[f.jsx(Nt,{className:"text-destructive",children:"Danger Zone"}),f.jsx("p",{className:"text-xs text-destructive/90 mb-2",children:"Clearing the VFS will permanently delete all files stored specifically for this project. This cannot be undone."})]})]})}],[e]);return f.jsx(Tl,{tabs:t,defaultValue:"manage",className:"h-full flex flex-col",listClassName:Ye("bg-muted/50 rounded-md","flex-wrap justify-start h-auto","p-1 gap-1"),contentContainerClassName:"mt-3 flex-grow flex flex-col overflow-y-auto"})},iHe=({allRules:e,selectedRuleIds:t,onSelectionChange:n,disabled:r=!1})=>{const[s,i]=E.useState(""),a=E.useMemo(()=>{const o=s.toLowerCase();return o?e.filter(l=>l.name.toLowerCase().includes(o)||l.content.toLowerCase().includes(o)||l.type.toLowerCase().includes(o)):e},[e,s]);return f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{className:"relative",children:[f.jsx(vo,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),f.jsx(vn,{type:"search",placeholder:"Filter rules...",value:s,onChange:o=>i(o.target.value),className:"pl-8 h-9",disabled:r})]}),f.jsx(Xo,{className:"h-48 border rounded-md p-2 bg-background/50",children:a.length===0?f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:e.length===0?"No rules defined globally.":"No rules match filter."}):f.jsx("div",{className:"space-y-1",children:a.map(o=>f.jsx("div",{className:"flex items-start justify-between p-1.5 rounded hover:bg-muted",children:f.jsxs("div",{className:"flex items-center space-x-2 flex-grow mr-2",children:[f.jsx(Yc,{id:`project-default-rule-${o.id}`,checked:t.has(o.id),onCheckedChange:l=>n(o.id,!!l),className:"mt-0.5",disabled:r}),f.jsxs(Nt,{htmlFor:`project-default-rule-${o.id}`,className:"text-sm font-normal cursor-pointer space-y-0.5",children:[f.jsx("span",{className:"block font-medium",children:o.name}),f.jsxs("span",{className:"block text-xs text-muted-foreground",children:["Type: ",o.type]}),f.jsxs("span",{className:"block text-xs text-muted-foreground truncate max-w-xs",children:["Content: ",o.content]})]})]})},o.id))})})]})},aHe=({defaultRuleIds:e,setDefaultRuleIds:t,isSaving:n,allRules:r})=>{const s=E.useMemo(()=>new Set(e??[]),[e]),i=E.useCallback((a,o)=>{const l=new Set(s);o?l.add(a):l.delete(a);const c=Array.from(l);t(c.length>0?c:null)},[s,t]);return f.jsxs("div",{className:"space-y-4",children:[f.jsx(Nt,{children:"Default Rules for this Project"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Select rules that will be automatically applied to new conversations within this project. These can be overridden per-conversation or per-turn."}),f.jsx(iHe,{allRules:r,selectedRuleIds:s,onSelectionChange:i,disabled:n})]})},oHe=({allTags:e,selectedTagIds:t,onSelectionChange:n,disabled:r=!1,getRulesForTag:s})=>{const[i,a]=E.useState(""),o=E.useMemo(()=>{const l=i.toLowerCase();return l?e.filter(c=>{var u;return c.name.toLowerCase().includes(l)||((u=c.description)==null?void 0:u.toLowerCase().includes(l))}):e},[e,i]);return f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{className:"relative",children:[f.jsx(vo,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),f.jsx(vn,{type:"search",placeholder:"Filter tags...",value:i,onChange:l=>a(l.target.value),className:"pl-8 h-9",disabled:r})]}),f.jsx(Xo,{className:"h-48 border rounded-md p-2 bg-background/50",children:o.length===0?f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:e.length===0?"No tags defined globally.":"No tags match filter."}):f.jsx("div",{className:"space-y-1",children:o.map(l=>{const c=s(l.id);return f.jsx("div",{className:"flex items-start justify-between p-1.5 rounded hover:bg-muted",children:f.jsxs("div",{className:"flex items-center space-x-2 flex-grow mr-2",children:[f.jsx(Yc,{id:`project-default-tag-${l.id}`,checked:t.has(l.id),onCheckedChange:u=>n(l.id,!!u),className:"mt-0.5",disabled:r}),f.jsxs(Nt,{htmlFor:`project-default-tag-${l.id}`,className:"text-sm font-normal cursor-pointer space-y-0.5",children:[f.jsx("span",{className:"block font-medium",children:l.name}),l.description&&f.jsx("span",{className:"block text-xs text-muted-foreground",children:l.description}),c.length>0&&f.jsxs("span",{className:"block text-xs text-blue-500 dark:text-blue-400",children:["Includes: ",c.map(u=>u.name).join(", ")]})]})]})},l.id)})})})]})},lHe=({defaultTagIds:e,setDefaultTagIds:t,isSaving:n,allTags:r,getRulesForTag:s})=>{const i=E.useMemo(()=>new Set(e??[]),[e]),a=E.useCallback((o,l)=>{const c=new Set(i);l?c.add(o):c.delete(o);const u=Array.from(c);t(u.length>0?u:null)},[i,t]);return f.jsxs("div",{className:"space-y-4",children:[f.jsx(Nt,{children:"Default Tags for this Project"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Select tags whose rules will be automatically applied to new conversations within this project. These can be overridden per-conversation or per-turn."}),f.jsx(oHe,{allTags:r,selectedTagIds:i,onSelectionChange:a,disabled:n,getRulesForTag:s})]})},cHe=Ke({temperature:Tt().min(0).max(1),topP:Tt().min(0).max(1),maxTokens:Tt().min(1).nullable(),topK:Tt().min(1).nullable(),presencePenalty:Tt().min(-2).max(2),frequencyPenalty:Tt().min(-2).max(2)}),uHe=({isOpen:e,onClose:t,projectId:n,module:r})=>{const{getProjectById:s,updateProject:i}=Va(mn(U=>({getProjectById:U.getProjectById,updateProject:U.updateProject}))),a=Va(U=>U.getEffectiveProjectSettings),o=jn(U=>U.syncRepos),l=pr(mn(U=>({globalSystemPrompt:U.globalSystemPrompt,temperature:U.temperature,maxTokens:U.maxTokens,topP:U.topP,topK:U.topK,presencePenalty:U.presencePenalty,frequencyPenalty:U.frequencyPenalty}))),c=Gn(U=>U.selectedModelId),u=ti(U=>U.setVfsKey),[d,h]=E.useState(null),[m,y]=E.useState(null),[b,v]=E.useState(null),[x,w]=E.useState(null),[_,k]=E.useState(null),[C,T]=E.useState(!1),[A,N]=E.useState("prompt"),{project:I,effectiveSettings:j}=E.useMemo(()=>{const U=n?s(n):null,W=n?a(n):null;return{project:U,effectiveSettings:W}},[n,s,a]),L=ai({defaultValues:{temperature:(I==null?void 0:I.temperature)??.7,topP:(I==null?void 0:I.topP)??1,maxTokens:(I==null?void 0:I.maxTokens)??null,topK:(I==null?void 0:I.topK)??null,presencePenalty:(I==null?void 0:I.presencePenalty)??0,frequencyPenalty:(I==null?void 0:I.presencePenalty)??0},validators:{onChangeAsync:cHe,onChangeAsyncDebounceMs:500}}),D=E.useCallback(U=>{var B;if(!U)return null;const W=s(U);return W?((B=W.metadata)==null?void 0:B.syncRepoId)!==void 0?W.metadata.syncRepoId:D(W.parentId):null},[s]),H=n?D(n):null;E.useEffect(()=>{var U;e&&n&&I&&j?(u(n),h(I.systemPrompt??null),y(I.modelId??null),v(((U=I.metadata)==null?void 0:U.syncRepoId)??null),w(I.defaultTagIds??null),k(I.defaultRuleIds??null),L.reset({temperature:I.temperature??.7,topP:I.topP??1,maxTokens:I.maxTokens??null,topK:I.topK??null,presencePenalty:I.presencePenalty??0,frequencyPenalty:I.frequencyPenalty??0}),N("prompt")):e||(u(null),h(null),y(null),v(null),w(null),k(null),L.reset({temperature:.7,topP:1,maxTokens:null,topK:null,presencePenalty:0,frequencyPenalty:0}))},[e,n,I,j,u,L]);const O=async()=>{if(!(!n||!I)){T(!0);try{const U=I.parentId?a(I.parentId):{systemPrompt:l.globalSystemPrompt,modelId:c,temperature:l.temperature,maxTokens:l.maxTokens,topP:l.topP,topK:l.topK,presencePenalty:l.presencePenalty,frequencyPenalty:l.frequencyPenalty,defaultTagIds:null,defaultRuleIds:null},W=I.parentId?D(I.parentId):null,B={},ne={...I.metadata??{}},V=L.state.values;d!==U.systemPrompt?B.systemPrompt=d:B.systemPrompt=void 0,m!==U.modelId?B.modelId=m:B.modelId=void 0,V.temperature!==U.temperature?B.temperature=V.temperature:B.temperature=void 0,V.maxTokens!==U.maxTokens?B.maxTokens=V.maxTokens:B.maxTokens=void 0,V.topP!==U.topP?B.topP=V.topP:B.topP=void 0,V.topK!==U.topK?B.topK=V.topK:B.topK=void 0,V.presencePenalty!==U.presencePenalty?B.presencePenalty=V.presencePenalty:B.presencePenalty=void 0,V.frequencyPenalty!==U.frequencyPenalty?B.frequencyPenalty=V.frequencyPenalty:B.frequencyPenalty=void 0,b!==W?ne.syncRepoId=b:delete ne.syncRepoId,JSON.stringify(x)!==JSON.stringify(U.defaultTagIds)?B.defaultTagIds=x:B.defaultTagIds=void 0,JSON.stringify(_)!==JSON.stringify(U.defaultRuleIds)?B.defaultRuleIds=_:B.defaultRuleIds=void 0,B.metadata=ne,await i(n,B),ke.success(`Project "${I.name}" settings updated.`),t()}catch(U){ke.error("Failed to save project settings."),console.error("Failed to save project settings:",U)}finally{T(!1)}}},K=E.useMemo(()=>[{value:"prompt",label:"Prompt & Model",content:f.jsx(tHe,{initialSystemPrompt:d,initialModelId:m,onSave:({systemPrompt:U,modelId:W})=>{h(U),y(W)},effectiveSystemPrompt:(j==null?void 0:j.systemPrompt)??l.globalSystemPrompt,effectiveModelId:(j==null?void 0:j.modelId)??c,isParentSaving:C})},{value:"params",label:"Parameters",content:f.jsx(nHe,{form:L,effectiveTemperature:(j==null?void 0:j.temperature)??l.temperature,effectiveMaxTokens:(j==null?void 0:j.maxTokens)??l.maxTokens,effectiveTopP:(j==null?void 0:j.topP)??l.topP??1,effectiveTopK:(j==null?void 0:j.topK)??l.topK,effectivePresencePenalty:(j==null?void 0:j.presencePenalty)??l.presencePenalty??0,effectiveFrequencyPenalty:(j==null?void 0:j.frequencyPenalty)??l.frequencyPenalty??0,isSaving:C})},{value:"rules-tags",label:"Rules & Tags",content:f.jsxs("div",{className:"space-y-6",children:[f.jsx(aHe,{defaultRuleIds:_,setDefaultRuleIds:k,isSaving:C,allRules:r.getAllRules()}),f.jsx(lHe,{defaultTagIds:x,setDefaultTagIds:w,isSaving:C,allTags:r.getAllTags(),getRulesForTag:r.getRulesForTag})]})},{value:"sync",label:"Sync",content:f.jsx(rHe,{initialSyncRepoId:b,onSave:({syncRepoId:U})=>{v(U)},effectiveSyncRepoId:H,syncRepos:o,isParentSaving:C})},{value:"vfs",label:"Filesystem",content:f.jsx(sHe,{projectId:n,projectName:(I==null?void 0:I.name)??null,isSaving:C})}],[d,m,b,x,_,L,j,l,c,C,H,o,n,I==null?void 0:I.name,r]);return f.jsx(td,{open:e,onOpenChange:t,children:f.jsxs(nd,{className:Ye("w-[95vw] h-[85vh] flex flex-col p-0","sm:w-[90vw] sm:max-w-[800px]","md:h-[75vh]","min-h-[500px] max-h-[90vh]"),children:[f.jsxs(rd,{className:"p-4 md:p-6 pb-2 md:pb-4 flex-shrink-0",children:[f.jsxs(sd,{children:["Project Settings: ",I==null?void 0:I.name]}),f.jsx(wf,{children:"Configure default settings for this project. Settings inherit from parent projects or global defaults if not set here."})]}),f.jsx(Tl,{tabs:K,initialValue:A,onValueChange:N,className:"flex-grow overflow-hidden px-4 md:px-6",listClassName:"-mx-4 md:-mx-6 px-2 md:px-6 py-1 md:py-0",contentContainerClassName:"pb-4 md:pb-6 overflow-y-auto",scrollable:!1}),f.jsxs(dg,{className:"flex-shrink-0 border-t p-4 md:p-6 pt-3 md:pt-4 mt-auto",children:[f.jsx(ot,{variant:"outline",onClick:t,disabled:C,children:"Cancel"}),f.jsxs(ot,{onClick:O,disabled:C,children:[C&&f.jsx(Hn,{className:"mr-2 h-4 w-4 animate-spin"}),"Save Project Settings"]})]})]})})};class dHe{constructor(){ce(this,"id","core-project-settings");ce(this,"modalId","projectSettingsModal");ce(this,"unregisterModalProviderCallback",null);ce(this,"modApiRef",null);ce(this,"eventUnsubscribers",[]);ce(this,"allRules",[]);ce(this,"allTags",[]);ce(this,"tagRuleLinks",[]);ce(this,"getAllRules",()=>this.allRules);ce(this,"getAllTags",()=>this.allTags);ce(this,"getRulesForTag",t=>{const n=new Set(this.tagRuleLinks.filter(r=>r.tagId===t).map(r=>r.ruleId));return this.allRules.filter(r=>n.has(r.id))});ce(this,"openModal",(t,n)=>{var r;(r=this.modApiRef)==null||r.emit(Tr.openModalRequest,{modalId:this.modalId,targetId:t,initialTab:n})});ce(this,"closeModal",()=>{var t;(t=this.modApiRef)==null||t.emit(Tr.closeModalRequest,{modalId:this.modalId})})}async initialize(t){this.modApiRef=t;const n=t.on(vr.dataLoaded,r=>{r&&(this.allRules=r.rules||[],this.allTags=r.tags||[],this.tagRuleLinks=(r.links||[]).map(s=>({tagId:s.tagId,ruleId:s.ruleId})))});this.eventUnsubscribers.push(n),t.emit(vr.loadRulesAndTagsRequest,void 0),console.log(`[${this.id}] Initialized.`)}register(t){if(this.modApiRef=t,this.unregisterModalProviderCallback){console.warn(`[${this.id}] Modal provider already registered. Skipping.`);return}this.unregisterModalProviderCallback=t.registerModalProvider(this.modalId,n=>Ve.createElement(uHe,{isOpen:n.isOpen,onClose:n.onClose,projectId:n.targetId||null,module:this})),console.log(`[${this.id}] Modal provider registered for ${this.modalId}.`)}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterModalProviderCallback&&(this.unregisterModalProviderCallback(),this.unregisterModalProviderCallback=null),this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const v6=Ve.memo(({module:e,value:t,onChange:n,className:r,disabled:s})=>{const[,i]=E.useState({});E.useEffect(()=>{if(e)return e.setNotifyCallback(()=>i({})),()=>e.setNotifyCallback(null)},[e]);const a=!!e,o=a?e.selectedModelId:t,l=a?e.isStreaming:s,c=a?e.isLoadingProviders:!1,u=a?e.globallyEnabledModels:Gn(h=>h.getGloballyEnabledModelDefinitions()),d=E.useCallback(h=>{a&&e?e.handleSelectionChange(h):n&&n(h)},[a,e,n]);return f.jsx(xp,{models:u,value:o,onChange:d,className:r,disabled:l,isLoading:c})});v6.displayName="GlobalModelSelector";class fHe{constructor(){ce(this,"id","core-global-model-selector");ce(this,"unregisterCallback",null);ce(this,"eventUnsubscribers",[]);ce(this,"modApiRef",null);ce(this,"selectedModelId",null);ce(this,"isStreaming",!1);ce(this,"isLoadingProviders",!0);ce(this,"globallyEnabledModels",[]);ce(this,"notifyComponentUpdate",null);ce(this,"handleSelectionChange",t=>{var n,r;(n=this.modApiRef)==null||n.emit(Vn.selectModelRequest,{modelId:t}),(r=this.modApiRef)==null||r.emit(an.setModelIdRequest,{id:t})});ce(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){this.modApiRef=t;const n=Gn.getState();this.isLoadingProviders=n.isLoading,this.selectedModelId=n.selectedModelId,this.isStreaming=nn.getState().status==="streaming",this.isLoadingProviders||(this.globallyEnabledModels=n.getGloballyEnabledModelDefinitions());const r=t.on(xn.statusChanged,o=>{var l;if(typeof o=="object"&&o&&"status"in o){const c=o.status==="streaming";this.isStreaming!==c&&(this.isStreaming=c,(l=this.notifyComponentUpdate)==null||l.call(this))}}),s=t.on(Vn.selectedModelChanged,o=>{var l,c;typeof o=="object"&&o&&"modelId"in o&&this.selectedModelId!==o.modelId&&(this.selectedModelId=o.modelId,(l=this.modApiRef)==null||l.emit(an.setModelIdRequest,{id:o.modelId}),(c=this.notifyComponentUpdate)==null||c.call(this))}),i=t.on(Vn.globallyEnabledModelsUpdated,o=>{var d,h;let l=!1;JSON.stringify(this.globallyEnabledModels)!==JSON.stringify(o.models)&&(this.globallyEnabledModels=o.models,l=!0);const c=Gn.getState().isLoading;this.isLoadingProviders!==c&&(this.isLoadingProviders=c,l=!0);const u=Gn.getState().selectedModelId;this.selectedModelId!==u&&(this.selectedModelId=u,(d=this.modApiRef)==null||d.emit(an.setModelIdRequest,{id:this.selectedModelId}),l=!0),l&&((h=this.notifyComponentUpdate)==null||h.call(this))}),a=t.on(Vn.initialDataLoaded,()=>{var u,d;const o=Gn.getState();let l=!1;this.isLoadingProviders!==o.isLoading&&(this.isLoadingProviders=o.isLoading,l=!0),this.selectedModelId!==o.selectedModelId&&(this.selectedModelId=o.selectedModelId,(u=this.modApiRef)==null||u.emit(an.setModelIdRequest,{id:this.selectedModelId}),l=!0);const c=o.getGloballyEnabledModelDefinitions();JSON.stringify(this.globallyEnabledModels)!==JSON.stringify(c)&&(this.globallyEnabledModels=c,l=!0),l&&((d=this.notifyComponentUpdate)==null||d.call(this))});this.eventUnsubscribers.push(r,s,i,a)}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>this.isLoadingProviders?"loading":"ready",triggerRenderer:()=>Ve.createElement(v6,{module:this})})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const hHe=({module:e})=>{const[,t]=E.useState({});E.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const[n,r]=E.useState(!1),[s,i]=E.useState(e.getTurnSystemPrompt()),a=e.getEffectiveSystemPrompt(),o=e.getIsStreaming(),l=e.getTurnSystemPrompt();E.useEffect(()=>{n&&i(e.getTurnSystemPrompt())},[n,e]);const c=E.useCallback(()=>{e.setTurnSystemPrompt(s.trim()),r(!1)},[s,e]),u=E.useCallback(()=>{i(""),e.setTurnSystemPrompt(""),r(!1)},[e]),d=m=>{m&&i(e.getTurnSystemPrompt()),r(m)},h=l.trim().length>0;return f.jsxs(gc,{open:n,onOpenChange:d,children:[f.jsx(wr,{delayDuration:100,children:f.jsxs(Sr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(yc,{asChild:!0,children:f.jsx(ot,{variant:h?"secondary":"ghost",size:"icon",className:"h-8 w-8",disabled:o,"aria-label":"Set System Prompt for Next Turn",children:f.jsx(g0e,{className:"h-4 w-4"})})})}),f.jsx(Cr,{side:"top",children:h?"System Prompt Override Active":"Set System Prompt (Next Turn)"})]})}),f.jsxs(bc,{className:"w-80 p-4 space-y-3",align:"start",children:[f.jsx(Nt,{htmlFor:"turn-system-prompt",children:"System Prompt (Overrides Project/Global for Next Turn)"}),f.jsx(Ci,{id:"turn-system-prompt",placeholder:`Inherited: ${(a==null?void 0:a.substring(0,50))||"Default"}${a&&a.length>50?"...":""}`,value:s,onChange:m=>i(m.target.value),rows:5,className:"text-sm"}),f.jsxs("div",{className:"flex justify-between",children:[f.jsx(ot,{variant:"outline",size:"sm",onClick:u,disabled:!s.trim(),children:"Clear Override"}),f.jsx(ot,{size:"sm",onClick:c,children:"Set for Next Turn"})]})]})]})};class pHe{constructor(){ce(this,"id","core-system-prompt");ce(this,"unregisterCallback",null);ce(this,"eventUnsubscribers",[]);ce(this,"modApiRef",null);ce(this,"turnSystemPromptValue","");ce(this,"effectiveSystemPrompt",null);ce(this,"isStreaming",!1);ce(this,"notifyComponentUpdate",null);ce(this,"getTurnSystemPrompt",()=>this.turnSystemPromptValue);ce(this,"getEffectiveSystemPrompt",()=>this.effectiveSystemPrompt);ce(this,"getIsStreaming",()=>this.isStreaming);ce(this,"setTurnSystemPrompt",t=>{var n;this.turnSystemPromptValue!==t&&(this.turnSystemPromptValue=t,(n=this.notifyComponentUpdate)==null||n.call(this))});ce(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){this.modApiRef=t,this.isStreaming=nn.getState().status==="streaming",this.updateEffectivePrompt();const n=t.on(xn.statusChanged,a=>{var o;typeof a=="object"&&a&&"status"in a&&this.isStreaming!==(a.status==="streaming")&&(this.isStreaming=a.status==="streaming",(o=this.notifyComponentUpdate)==null||o.call(this))}),r=t.on(Tr.contextChanged,()=>{var a;this.updateEffectivePrompt(),(a=this.notifyComponentUpdate)==null||a.call(this)}),s=t.on(Ta.updated,()=>{var a;this.updateEffectivePrompt(),(a=this.notifyComponentUpdate)==null||a.call(this)}),i=t.on(on.globalSystemPromptChanged,()=>{var a;this.updateEffectivePrompt(),(a=this.notifyComponentUpdate)==null||a.call(this)});this.eventUnsubscribers.push(n,r,s,i)}updateEffectivePrompt(){var a;const t=jn.getState(),n=Va.getState(),r=pr.getState(),s=t.selectedItemType==="project"?t.selectedItemId:t.selectedItemType==="conversation"?((a=t.getConversationById(t.selectedItemId))==null?void 0:a.projectId)??null:null,i=n.getEffectiveProjectSettings(s).systemPrompt??r.globalSystemPrompt;this.effectiveSystemPrompt!==i&&(this.effectiveSystemPrompt=i)}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>Ve.createElement(hHe,{module:this}),getMetadata:()=>{const n=this.turnSystemPromptValue.trim();return n?{turnSystemPrompt:n}:void 0},clearOnSubmit:()=>{var n;this.turnSystemPromptValue!==""&&(this.turnSystemPromptValue="",(n=this.notifyComponentUpdate)==null||n.call(this))}})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const mHe=({module:e})=>{const[,t]=E.useState({});E.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const n=e.getStructuredOutputJson(),[r,s]=E.useState(!1),[i,a]=E.useState(n??""),[o,l]=E.useState(""),[c,u]=E.useState([]),d=E.useCallback(()=>{try{JSON.parse(i),e.setStructuredOutputJson(i.trim()||null),s(!1),ke.success("Structured output applied for next turn.")}catch{ke.error("Invalid JSON format.")}},[i,e]),h=E.useCallback(()=>{a(""),e.setStructuredOutputJson(null),s(!1),ke.info("Structured output cleared.")},[e]),m=E.useCallback(()=>{if(!o.trim()){ke.error("Please provide a name to save to the library.");return}try{JSON.parse(i);const w={id:Date.now().toString(),name:o.trim(),json:i};u(_=>[..._,w]),l(""),ke.success(`"${w.name}" saved to library.`)}catch{ke.error("Cannot save invalid JSON to library.")}},[i,o]),y=E.useCallback(w=>{a(w.json),e.setStructuredOutputJson(w.json),s(!1),ke.success(`Loaded "${w.name}" from library.`)},[e]),b=E.useCallback(w=>{u(_=>_.filter(k=>k.id!==w)),ke.info("Item removed from library.")},[]);E.useEffect(()=>{r&&a(e.getStructuredOutputJson()??"")},[r,e]);const v=[{value:"entry",label:"Entry",content:f.jsxs("div",{className:"space-y-3 p-1",children:[f.jsx(Nt,{htmlFor:"structured-output-entry",children:"JSON Output Schema"}),f.jsx(Ci,{id:"structured-output-entry",placeholder:'e.g., {"type": "object", "properties": {"name": {"type": "string"}}}',value:i,onChange:w=>a(w.target.value),rows:8,className:"font-mono text-xs"}),f.jsxs("div",{className:"flex justify-between items-end gap-2",children:[f.jsxs("div",{className:"flex-grow space-y-1",children:[f.jsx(Nt,{htmlFor:"structured-output-name",className:"text-xs",children:"Save to Library (Optional Name)"}),f.jsx(vn,{id:"structured-output-name",value:o,onChange:w=>l(w.target.value),placeholder:"Schema Name",className:"h-8 text-xs"})]}),f.jsxs(ot,{size:"sm",variant:"outline",onClick:m,disabled:!o.trim()||!i.trim(),className:"h-8",children:[f.jsx(Yu,{className:"h-3.5 w-3.5 mr-1"})," Save"]})]}),f.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[f.jsx(ot,{variant:"outline",size:"sm",onClick:h,disabled:!n,children:"Clear Applied Schema"}),f.jsx(ot,{size:"sm",onClick:d,disabled:!i,children:"Apply for Next Turn"})]})]})},{value:"library",label:"Library",content:f.jsx("div",{className:"space-y-2 p-1",children:c.length===0?f.jsx("p",{className:"text-xs text-muted-foreground text-center py-4",children:"No saved schemas yet."}):c.map(w=>f.jsxs("div",{className:"flex items-center justify-between p-2 border rounded hover:bg-muted/50",children:[f.jsx("span",{className:"text-sm font-medium truncate flex-grow mr-2",children:w.name}),f.jsxs("div",{className:"flex gap-1 flex-shrink-0",children:[f.jsx(ot,{size:"sm",variant:"outline",onClick:()=>y(w),className:"h-7 px-2 text-xs",children:"Use"}),f.jsx(ot,{size:"icon",variant:"ghost",onClick:()=>b(w.id),className:"h-7 w-7 text-destructive",children:f.jsx(Vo,{className:"h-3.5 w-3.5"})})]})]},w.id))})}],x=!!n;return f.jsxs(gc,{open:r,onOpenChange:s,children:[f.jsx(wr,{delayDuration:100,children:f.jsxs(Sr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(yc,{asChild:!0,children:f.jsx(ot,{variant:x?"secondary":"ghost",size:"icon",className:"h-8 w-8","aria-label":"Set Structured Output",children:f.jsx(AE,{className:"h-4 w-4"})})})}),f.jsx(Cr,{side:"top",children:x?"Structured Output Active":"Set Structured Output (JSON Schema)"})]})}),f.jsx(bc,{className:"w-[450px] p-0",align:"start",children:f.jsx(Tl,{tabs:v,defaultValue:"entry"})})]})},gHe=({module:e})=>{const[,t]=E.useState({});return E.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]),e.getIsVisible()?f.jsx(mHe,{module:e}):null};class yHe{constructor(){ce(this,"id","core-structured-output");ce(this,"unregisterCallback",null);ce(this,"eventUnsubscribers",[]);ce(this,"modApiRef",null);ce(this,"structuredOutputJson",null);ce(this,"isVisible",!0);ce(this,"notifyComponentUpdate",null);ce(this,"getStructuredOutputJson",()=>this.structuredOutputJson);ce(this,"getIsVisible",()=>this.isVisible);ce(this,"setStructuredOutputJson",t=>{var n,r;this.structuredOutputJson=t,(n=this.modApiRef)==null||n.emit(an.setStructuredOutputJsonRequest,{json:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});ce(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){var s;this.modApiRef=t,this.structuredOutputJson=co.getState().structuredOutputJson,this.updateVisibility(),(s=this.notifyComponentUpdate)==null||s.call(this);const n=t.on(Vn.selectedModelChanged,()=>{var i;this.updateVisibility(),(i=this.notifyComponentUpdate)==null||i.call(this)}),r=t.on(an.parameterChanged,i=>{var a;if(typeof i=="object"&&i&&"params"in i){const o=i.params;"structuredOutputJson"in o&&this.structuredOutputJson!==(o.structuredOutputJson??null)&&(this.structuredOutputJson=o.structuredOutputJson??null,(a=this.notifyComponentUpdate)==null||a.call(this))}});this.eventUnsubscribers.push(n,r)}updateVisibility(){var i;const{getSelectedModel:t}=Gn.getState(),n=t(),r=(i=n==null?void 0:n.metadata)==null?void 0:i.supported_parameters,s=Array.isArray(r)&&r.includes("structured_output");this.isVisible!==s&&(this.isVisible=s)}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>Ve.createElement(gHe,{module:this}),getParameters:()=>{if(this.structuredOutputJson)try{return{structured_output:JSON.parse(this.structuredOutputJson)}}catch(n){console.error("Invalid JSON in structured output state:",n);return}},clearOnSubmit:()=>{var n;(n=this.modApiRef)==null||n.emit(an.setStructuredOutputJsonRequest,{json:null})}})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const bHe=({module:e})=>{const[,t]=E.useState({});E.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const n=e.contextLength,r=e.getEstimatedInputTokens(),s=e.getTotalEstimatedTokens(),i=e.getContextPercentage(),a=e.historyTokens,o=e.selectedModelId,l=E.useMemo(()=>i>85?"text-red-600 dark:text-red-500":i>70?"text-orange-500 dark:text-orange-400":i>40?"text-yellow-500 dark:text-yellow-400":"text-green-600 dark:text-green-500",[i]);if(!(o!==null&&n>0))return null;const u=`Context: ~${s.toLocaleString()} / ${n.toLocaleString()} tokens (${i}%) [History: ${a}, Input: ${r}]`;return f.jsx(wr,{delayDuration:100,children:f.jsxs(Sr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx("div",{className:"flex items-center justify-center h-8 w-8 px-2",children:f.jsx(FH,{className:Ye("h-3 w-3 fill-current",l)})})}),f.jsx(Cr,{side:"top",children:u})]})})},yie=4,vHe=e=>{let t=0;return e.forEach(n=>{var r,s,i,a;(r=n.prompt)!=null&&r.content&&(t+=new TextEncoder().encode(n.prompt.content).length),(a=(i=(s=n.prompt)==null?void 0:s.metadata)==null?void 0:i.attachedFiles)==null||a.forEach(o=>{t+=o.size}),n.response&&typeof n.response=="string"&&(t+=new TextEncoder().encode(n.response).length)}),Math.ceil(t/yie)};class xHe{constructor(){ce(this,"id","core-usage-display");ce(this,"unregisterCallback",null);ce(this,"eventUnsubscribers",[]);ce(this,"currentInputText","");ce(this,"historyTokens",0);ce(this,"attachedFiles",[]);ce(this,"selectedModelId",null);ce(this,"contextLength",0);ce(this,"notifyComponentUpdate",null);ce(this,"getEstimatedInputTokens",()=>{const t=new TextEncoder().encode(this.currentInputText).length,n=this.attachedFiles.reduce((r,s)=>r+s.size,0);return Math.ceil((t+n)/yie)});ce(this,"getTotalEstimatedTokens",()=>this.historyTokens+this.getEstimatedInputTokens());ce(this,"getContextPercentage",()=>this.contextLength?Math.min(100,Math.round(this.getTotalEstimatedTokens()/this.contextLength*100)):0);ce(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){this.loadInitialState(),this.updateContextLength();const n=t.on(an.inputChanged,o=>{var l;typeof o=="object"&&o&&"value"in o&&(this.currentInputText=o.value,(l=this.notifyComponentUpdate)==null||l.call(this))}),r=t.on(Yl.attachedFilesChanged,o=>{var l;typeof o=="object"&&o&&"files"in o&&(this.attachedFiles=o.files,(l=this.notifyComponentUpdate)==null||l.call(this))}),s=t.on(Vn.selectedModelChanged,o=>{var l;typeof o=="object"&&o&&"modelId"in o&&(this.selectedModelId=o.modelId,this.updateContextLength(),(l=this.notifyComponentUpdate)==null||l.call(this))}),i=t.on(xn.completed,()=>{var o;this.updateHistoryTokens(),(o=this.notifyComponentUpdate)==null||o.call(this)}),a=t.on(Tr.contextChanged,()=>{var o;this.updateHistoryTokens(),(o=this.notifyComponentUpdate)==null||o.call(this)});this.eventUnsubscribers.push(n,r,s,i,a),console.log(`[${this.id}] Initialized.`)}loadInitialState(){const t=Ph.getState(),n=Gn.getState();this.attachedFiles=t.attachedFilesMetadata,this.selectedModelId=n.selectedModelId,this.updateHistoryTokens()}updateHistoryTokens(){const t=nn.getState();if(t.currentConversationId){const n=t.interactions.filter(r=>r.status==="COMPLETED");this.historyTokens=vHe(n)}else this.historyTokens=0}updateContextLength(){var c;if(!this.selectedModelId){this.contextLength=0;return}const{dbProviderConfigs:t,dbApiKeys:n}=Gn.getState(),{providerId:r,modelId:s}=Ql(this.selectedModelId);if(!r||!s){this.contextLength=0;return}const i=t.find(u=>u.id===r);if(!i){this.contextLength=0;return}const a=n.find(u=>u.id===i.apiKeyId),o=sK(i,s,a==null?void 0:a.value),l=o==null?void 0:o.metadata;this.contextLength=((c=l==null?void 0:l.top_provider)==null?void 0:c.context_length)??(l==null?void 0:l.context_length)??0}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>Ve.createElement(bHe,{module:this})}),console.log(`[${this.id}] Registered.`)}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,console.log(`[${this.id}] Destroyed.`)}}const wHe=({module:e})=>{const[,t]=E.useState({});E.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const n=e.getReasoningEnabled(),r=e.getIsStreaming(),s=e.getIsVisible(),i=n===!0,a=E.useCallback(()=>{const o=i?null:!0;e.setReasoningEnabled(o)},[i,e]);return s?f.jsx(wr,{delayDuration:100,children:f.jsxs(Sr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(ot,{variant:i?"secondary":"ghost",size:"icon",className:"h-8 w-8",onClick:a,disabled:r,"aria-label":i?"Disable Reasoning for Next Turn":"Enable Reasoning for Next Turn",children:f.jsx(Qy,{className:Ye("h-4 w-4",i?"text-primary":"text-muted-foreground")})})}),f.jsx(Cr,{side:"top",children:i?"Reasoning Enabled (Click to Disable)":"Reasoning Disabled (Click to Enable)"})]})}):null};class SHe{constructor(){ce(this,"id","core-reasoning");ce(this,"unregisterCallback",null);ce(this,"eventUnsubscribers",[]);ce(this,"modApiRef",null);ce(this,"reasoningEnabled",null);ce(this,"isStreaming",!1);ce(this,"isVisible",!0);ce(this,"notifyComponentUpdate",null);ce(this,"getReasoningEnabled",()=>this.reasoningEnabled);ce(this,"getIsStreaming",()=>this.isStreaming);ce(this,"getIsVisible",()=>this.isVisible);ce(this,"setReasoningEnabled",t=>{var n,r;this.reasoningEnabled=t,(n=this.modApiRef)==null||n.emit(an.setReasoningEnabledRequest,{enabled:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});ce(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){var i;this.modApiRef=t,this.reasoningEnabled=co.getState().reasoningEnabled,this.isStreaming=nn.getState().status==="streaming",this.updateVisibility(),(i=this.notifyComponentUpdate)==null||i.call(this);const n=t.on(xn.statusChanged,a=>{var o;typeof a=="object"&&a&&"status"in a&&this.isStreaming!==(a.status==="streaming")&&(this.isStreaming=a.status==="streaming",(o=this.notifyComponentUpdate)==null||o.call(this))}),r=t.on(Vn.selectedModelChanged,()=>{var a;this.updateVisibility(),(a=this.notifyComponentUpdate)==null||a.call(this)}),s=t.on(an.parameterChanged,a=>{var o;if(typeof a=="object"&&a&&"params"in a){const l=a.params;"reasoningEnabled"in l&&this.reasoningEnabled!==l.reasoningEnabled&&(this.reasoningEnabled=l.reasoningEnabled??null,(o=this.notifyComponentUpdate)==null||o.call(this))}});this.eventUnsubscribers.push(n,r,s)}updateVisibility(){var s,i;const{getSelectedModel:t}=Gn.getState(),n=t(),r=((i=(s=n==null?void 0:n.metadata)==null?void 0:s.supported_parameters)==null?void 0:i.includes("reasoning"))??!1;this.isVisible!==r&&(this.isVisible=r)}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>Ve.createElement(wHe,{module:this}),getMetadata:()=>this.reasoningEnabled===!0?{reasoningEnabled:!0}:void 0,clearOnSubmit:()=>{var n;(n=this.modApiRef)==null||n.emit(an.setReasoningEnabledRequest,{enabled:null})}})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const _He=({module:e})=>{const[,t]=E.useState({});E.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const n=e.getWebSearchEnabled(),r=e.getIsStreaming(),s=e.getIsVisible(),i=n===!0,a=E.useCallback(()=>{const o=i?null:!0;e.setWebSearchEnabled(o)},[i,e]);return s?f.jsx(wr,{delayDuration:100,children:f.jsxs(Sr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(ot,{variant:i?"secondary":"ghost",size:"icon",className:"h-8 w-8",onClick:a,disabled:r,"aria-label":i?"Disable Web Search for Next Turn":"Enable Web Search for Next Turn",children:f.jsx(vo,{className:Ye("h-4 w-4",i?"text-primary":"text-muted-foreground")})})}),f.jsx(Cr,{side:"top",children:i?"Web Search Enabled (Click to Disable)":"Web Search Disabled (Click to Enable)"})]})}):null};class CHe{constructor(){ce(this,"id","core-web-search");ce(this,"unregisterCallback",null);ce(this,"eventUnsubscribers",[]);ce(this,"modApiRef",null);ce(this,"webSearchEnabled",null);ce(this,"isStreaming",!1);ce(this,"isVisible",!0);ce(this,"notifyComponentUpdate",null);ce(this,"getWebSearchEnabled",()=>this.webSearchEnabled);ce(this,"getIsStreaming",()=>this.isStreaming);ce(this,"getIsVisible",()=>this.isVisible);ce(this,"setWebSearchEnabled",t=>{var n,r;this.webSearchEnabled=t,(n=this.modApiRef)==null||n.emit(an.setWebSearchEnabledRequest,{enabled:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});ce(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){var i;this.modApiRef=t,this.webSearchEnabled=co.getState().webSearchEnabled,this.isStreaming=nn.getState().status==="streaming",this.updateVisibility(),(i=this.notifyComponentUpdate)==null||i.call(this);const n=t.on(xn.statusChanged,a=>{var o;typeof a=="object"&&a&&"status"in a&&this.isStreaming!==(a.status==="streaming")&&(this.isStreaming=a.status==="streaming",(o=this.notifyComponentUpdate)==null||o.call(this))}),r=t.on(Vn.selectedModelChanged,()=>{var a;this.updateVisibility(),(a=this.notifyComponentUpdate)==null||a.call(this)}),s=t.on(an.parameterChanged,a=>{var o;if(typeof a=="object"&&a&&"params"in a){const l=a.params;"webSearchEnabled"in l&&this.webSearchEnabled!==l.webSearchEnabled&&(this.webSearchEnabled=l.webSearchEnabled??null,(o=this.notifyComponentUpdate)==null||o.call(this))}});this.eventUnsubscribers.push(n,r,s)}updateVisibility(){var i;const{getSelectedModel:t}=Gn.getState(),n=t(),r=((i=n==null?void 0:n.metadata)==null?void 0:i.supported_parameters)??[],s=r.includes("web_search")||r.includes("web_search_options");this.isVisible!==s&&(this.isVisible=s)}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>Ve.createElement(_He,{module:this}),getParameters:()=>this.webSearchEnabled===!0?{web_search:!0}:void 0,clearOnSubmit:()=>{var n;(n=this.modApiRef)==null||n.emit(an.setWebSearchEnabledRequest,{enabled:null})}})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const bie=({activeTagIds:e,activeRuleIds:t,onToggleTag:n,onToggleRule:r,allRules:s,allTags:i,getRulesForTag:a})=>{const[o,l]=E.useState(""),[c,u]=E.useState(""),d=E.useMemo(()=>{const _=o.toLowerCase();return _?i.filter(k=>{var C;return k.name.toLowerCase().includes(_)||((C=k.description)==null?void 0:C.toLowerCase().includes(_))}):i},[i,o]),h=E.useMemo(()=>{const _=c.toLowerCase();return _?s.filter(k=>k.name.toLowerCase().includes(_)||k.content.toLowerCase().includes(_)||k.type.toLowerCase().includes(_)):s},[s,c]),m=E.useCallback((_,k)=>{n(_,k)},[n]),y=E.useCallback((_,k)=>{r(_,k)},[r]),b=()=>{Ce.emit(Tr.openModalRequest,{modalId:"settingsModal",initialTab:"rules-tags"})},v=()=>f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsxs("div",{className:"relative flex-grow",children:[f.jsx(vo,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),f.jsx(vn,{type:"search",placeholder:"Filter tags...",value:o,onChange:_=>l(_.target.value),className:"pl-8 h-9"})]}),f.jsxs(ot,{variant:"outline",size:"sm",onClick:b,className:"h-9 px-3",title:"Open Rules Settings",children:[f.jsx(jh,{className:"h-4 w-4 mr-1"}),"Manage"]})]}),f.jsx("div",{className:"border rounded-md p-2 bg-background/50",children:d.length===0?f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:i.length===0?"No tags defined.":"No tags match filter."}):f.jsx("div",{className:"space-y-1",children:d.map(_=>{const k=a(_.id);return f.jsx("div",{className:"flex items-start justify-between p-1.5 rounded hover:bg-muted",children:f.jsxs("div",{className:"flex items-center space-x-2 flex-grow mr-2",children:[f.jsx(Yc,{id:`tag-activate-${_.id}`,checked:e.has(_.id),onCheckedChange:C=>m(_.id,!!C),className:"mt-0.5"}),f.jsxs(Nt,{htmlFor:`tag-activate-${_.id}`,className:"text-sm font-normal cursor-pointer space-y-0.5",children:[f.jsx("span",{className:"block font-medium",children:_.name}),_.description&&f.jsx("span",{className:"block text-xs text-muted-foreground",children:_.description}),k.length>0&&f.jsxs("span",{className:"block text-xs text-blue-500 dark:text-blue-400",children:["Includes: ",k.map(C=>C.name).join(", ")]})]})]})},_.id)})})})]}),w=[{value:"rules",label:"Activate Rules",content:f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsxs("div",{className:"relative flex-grow",children:[f.jsx(vo,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),f.jsx(vn,{type:"search",placeholder:"Filter rules...",value:c,onChange:_=>u(_.target.value),className:"pl-8 h-9"})]}),f.jsxs(ot,{variant:"outline",size:"sm",onClick:b,className:"h-9 px-3",title:"Open Rules Settings",children:[f.jsx(jh,{className:"h-4 w-4 mr-1"}),"Manage"]})]}),f.jsx("div",{className:"border rounded-md p-2 bg-background/50",children:h.length===0?f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:s.length===0?"No rules defined.":"No rules match filter."}):f.jsx("div",{className:"space-y-1",children:h.map(_=>f.jsx("div",{className:"flex items-start justify-between p-1.5 rounded hover:bg-muted",children:f.jsxs("div",{className:"flex items-center space-x-2 flex-grow mr-2",children:[f.jsx(Yc,{id:`rule-activate-${_.id}`,checked:t.has(_.id),onCheckedChange:k=>y(_.id,!!k),className:"mt-0.5"}),f.jsxs(Nt,{htmlFor:`rule-activate-${_.id}`,className:"text-sm font-normal cursor-pointer space-y-0.5",children:[f.jsx("span",{className:"block font-medium",children:_.name}),f.jsxs("span",{className:"block text-xs text-muted-foreground",children:["Type: ",_.type]}),f.jsxs("span",{className:"block text-xs text-muted-foreground truncate max-w-xs",children:["Content: ",_.content]})]})]})},_.id))})})]})},{value:"tags",label:"Activate Tags",content:v()}];return f.jsx("div",{className:"p-0 max-w-lg",children:f.jsx(Tl,{tabs:w,defaultValue:"rules",scrollable:!1})})},kHe=({module:e})=>{const[,t]=E.useState({});E.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const[n,r]=E.useState(!1),s=e.getActiveTagIds(),i=e.getActiveRuleIds(),a=e.getIsStreaming(),o=e.getHasRulesOrTags(),l=e.getAllRules(),c=e.getAllTags(),u=e.getRulesForTag,d=E.useCallback((v,x)=>{e.setActiveTagIds(w=>{const _=new Set(w);return x?_.add(v):_.delete(v),_})},[e]),h=E.useCallback((v,x)=>{e.setActiveRuleIds(w=>{const _=new Set(w);return x?_.add(v):_.delete(v),_})},[e]),m=()=>{o?r(v=>!v):e.handleTriggerClick()&&r(!1)},y=s.size>0||i.size>0,b=a;return f.jsxs(gc,{open:n,onOpenChange:r,children:[f.jsx(wr,{delayDuration:100,children:f.jsxs(Sr,{children:[f.jsx(_r,{asChild:!0,children:o?f.jsx(yc,{asChild:!0,children:f.jsx(ot,{variant:y?"secondary":"ghost",size:"icon",className:"h-8 w-8",disabled:b,"aria-label":"Configure Rules & Tags for Next Turn",onClick:m,children:f.jsx(HB,{className:"h-4 w-4"})})}):f.jsx(ot,{variant:"ghost",size:"icon",className:"h-8 w-8",disabled:b,"aria-label":"Add Rules & Tags (Opens Settings)",onClick:m,children:f.jsx(HB,{className:"h-4 w-4"})})}),f.jsx(Cr,{side:"top",children:o?y?`Rules/Tags Active (${s.size} tags, ${i.size} rules)`:"Activate Rules/Tags (Next Turn)":"Add Rules/Tags (Opens Settings)"})]})}),o&&f.jsx(bc,{className:"w-auto p-0",align:"start",children:f.jsx(bie,{activeTagIds:s,activeRuleIds:i,onToggleTag:d,onToggleRule:h,allRules:l,allTags:c,getRulesForTag:u})})]})};function EHe({form:e,name:t,label:n,description:r,placeholder:s,disabled:i,wrapperClassName:a,className:o,rows:l,...c}){return f.jsx(e.Field,{name:t,children:u=>{const d=typeof u.state.value=="string"||typeof u.state.value=="number"?String(u.state.value):"";return f.jsxs("div",{className:Ye("space-y-1.5",a),children:[f.jsx(Nt,{htmlFor:u.name,className:"text-sm",children:n}),r&&f.jsx("p",{className:"text-xs text-muted-foreground",children:r}),f.jsx(Ci,{id:u.name,name:u.name,value:d,onBlur:u.handleBlur,onChange:h=>u.handleChange(h.target.value),placeholder:s,disabled:i??u.form.state.isSubmitting,rows:l,className:Ye(o,u.state.meta.errors.length?"border-destructive":""),...c}),f.jsx(Li,{field:u})]})}})}const THe=Ke({name:$e().min(1,"Rule Name is required."),content:$e().min(1,"Rule Content is required."),type:El(["system","before","after"],{errorMap:()=>({message:"Rule Type is required."})})}),AHe=[{value:"system",label:"System Prompt"},{value:"before",label:"Before User Prompt"},{value:"after",label:"After User Prompt"}],RHe=({initialData:e,isSavingExt:t,onSave:n,onCancel:r})=>{const s=ai({defaultValues:{name:(e==null?void 0:e.name)||"",content:(e==null?void 0:e.content)||"",type:(e==null?void 0:e.type)||"before"},validators:{onChangeAsync:THe,onChangeAsyncDebounceMs:500},onSubmit:async({value:i})=>{await n({name:i.name.trim(),content:i.content.trim(),type:i.type})}});return E.useEffect(()=>{s.reset({name:(e==null?void 0:e.name)||"",content:(e==null?void 0:e.content)||"",type:(e==null?void 0:e.type)||"before"})},[e,s]),f.jsxs("form",{onSubmit:i=>{i.preventDefault(),i.stopPropagation(),s.handleSubmit()},className:"space-y-4 border rounded-md p-4 bg-card shadow-md",children:[f.jsx("h4",{className:"font-semibold text-card-foreground",children:e!=null&&e.id?"Edit Rule":"Add New Rule"}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[f.jsx(r1,{form:s,name:"name",label:"Rule Name",placeholder:"e.g., Always respond in JSON",required:!0,disabled:t,wrapperClassName:"md:col-span-2"}),f.jsx(Wx,{form:s,name:"type",label:"Rule Type",options:AHe,placeholder:"Select Type",disabled:t})]}),f.jsx(EHe,{form:s,name:"content",label:"Rule Content",placeholder:"Enter the rule text to be injected...",required:!0,rows:4,disabled:t,className:"font-mono text-xs"}),f.jsxs("div",{className:"flex justify-end space-x-2 pt-2",children:[f.jsxs(ot,{variant:"ghost",size:"sm",onClick:r,disabled:t,type:"button",children:[f.jsx(Si,{className:"h-4 w-4 mr-1"})," Cancel"]}),f.jsx(s.Subscribe,{selector:i=>[i.canSubmit,i.isSubmitting,i.isValidating,i.isValid],children:([i,a,o,l])=>f.jsxs(ot,{variant:"secondary",size:"sm",type:"submit",disabled:t||!i||a||!l||o,children:[(t||a||o)&&f.jsx(Hn,{className:"h-4 w-4 mr-1 animate-spin"}),f.jsx(Yu,{className:"h-4 w-4 mr-1"})," ",t||a||o?"Saving...":"Save Rule"]})})]})]})},NHe=({rules:e,isLoading:t,isDeleting:n,onEdit:r,onDelete:s})=>{const i=a=>{window.confirm(`Are you sure you want to delete the rule "${a.name}"? This will also remove it from any tags.`)&&s(a.id,a.name)};return f.jsx("div",{className:"border rounded-md overflow-hidden",children:f.jsxs(Sf,{children:[f.jsx(vp,{children:f.jsxs(As,{children:[f.jsx(Rr,{children:"Name"}),f.jsx(Rr,{children:"Type"}),f.jsx(Rr,{children:"Content Preview"}),f.jsx(Rr,{className:"text-right",children:"Actions"})]})}),f.jsx(_f,{children:t?f.jsxs(f.Fragment,{children:[f.jsx(As,{children:f.jsx(Bn,{colSpan:4,children:f.jsx(Gr,{className:"h-10 w-full"})})}),f.jsx(As,{children:f.jsx(Bn,{colSpan:4,children:f.jsx(Gr,{className:"h-10 w-full"})})})]}):e.length===0?f.jsx(As,{children:f.jsx(Bn,{colSpan:4,className:"h-24 text-center text-muted-foreground",children:"No rules defined yet."})}):e.map(a=>{const o=n[a.id];return f.jsxs(As,{children:[f.jsx(Bn,{className:"font-medium",children:a.name}),f.jsx(Bn,{className:"capitalize",children:a.type}),f.jsx(Bn,{className:"text-xs text-muted-foreground truncate max-w-xs",children:a.content}),f.jsxs(Bn,{className:"text-right space-x-1",children:[f.jsx(Un,{tooltipText:"Edit Rule",onClick:()=>r(a),disabled:o,icon:f.jsx(k1,{}),className:"h-8 w-8","aria-label":`Edit rule ${a.name}`}),f.jsx(Un,{tooltipText:"Delete Rule",onClick:()=>i(a),disabled:o,icon:o?f.jsx(Hn,{className:"h-4 w-4 animate-spin"}):f.jsx(Vo,{}),className:"text-destructive hover:text-destructive/80 h-8 w-8","aria-label":`Delete rule ${a.name}`})]})]},a.id)})})]})})},IHe=({module:e})=>{const[,t]=E.useState(Date.now()),n=e.getAllRules(),r=e.getIsLoadingRules(),[s,i]=E.useState(!1),[a,o]=E.useState(null),[l,c]=E.useState(!1),[u,d]=E.useState({});E.useEffect(()=>(e.setNotifySettingsCallback(()=>t(Date.now())),()=>{e.setNotifySettingsCallback(null)}),[e]);const h=()=>{o(null),i(!0)},m=x=>{o(x),i(!0)},y=E.useCallback(()=>{i(!1),o(null),c(!1)},[]),b=E.useCallback(async x=>{c(!0);try{a?e.updateRule(a.id,x):e.addRule(x),y()}catch{}finally{c(!1)}},[e,a,y]),v=E.useCallback(async x=>{d(w=>({...w,[x]:!0}));try{e.deleteRule(x),(a==null?void 0:a.id)===x&&y()}catch{}finally{d(w=>({...w,[x]:!1}))}},[e,a,y]);return f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"text-lg font-semibold text-card-foreground",children:"Manage Rules"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Create reusable text snippets (rules) that can be automatically injected into prompts based on assigned tags. Rules can modify the system prompt, or be added before/after the user's input."})]}),!s&&f.jsxs(ot,{onClick:h,variant:"outline",className:"w-full",disabled:r,children:[f.jsx(nc,{className:"h-4 w-4 mr-1"})," Add New Rule"]}),s&&f.jsx(RHe,{initialData:a??void 0,isSavingExt:l,onSave:b,onCancel:y}),f.jsxs("div",{className:"pt-4",children:[f.jsx("h4",{className:"text-md font-medium mb-2",children:"Existing Rules"}),f.jsx(NHe,{rules:n,isLoading:r,isDeleting:u,onEdit:m,onDelete:v})]})]})},Aj=Ke({name:$e().min(1,"Tag Name is required."),description:$e().nullable()}),MHe=({initialData:e,isParentSaving:t=!1,onSave:n,onCancel:r})=>{const s=ai({defaultValues:{name:(e==null?void 0:e.name)||"",description:(e==null?void 0:e.description)||null},validators:{onChangeAsync:Aj,onChangeAsyncDebounceMs:500},onSubmit:async({value:i})=>{var a;await n({name:i.name.trim(),description:((a=i.description)==null?void 0:a.trim())||null})}});return E.useEffect(()=>{s.reset({name:(e==null?void 0:e.name)||"",description:(e==null?void 0:e.description)||null})},[e,s]),f.jsxs("form",{onSubmit:i=>{i.preventDefault(),i.stopPropagation(),s.handleSubmit()},className:"space-y-4 border rounded-md p-4 bg-card shadow-md",children:[f.jsx("h4",{className:"font-semibold text-card-foreground",children:e!=null&&e.id?"Edit Tag":"Add New Tag"}),f.jsx(s.Field,{name:"name",validators:{onChange:Aj.shape.name},children:i=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(Nt,{htmlFor:i.name,children:"Tag Name"}),f.jsx(vn,{id:i.name,value:i.state.value??"",onChange:a=>i.handleChange(a.target.value),onBlur:i.handleBlur,placeholder:"e.g., Code Generation, Summarization",disabled:s.state.isSubmitting||t}),f.jsx(Li,{field:i})]})}),f.jsx(s.Field,{name:"description",validators:{onChange:Aj.shape.description},children:i=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(Nt,{htmlFor:i.name,children:"Description (Optional)"}),f.jsx(Ci,{id:i.name,value:i.state.value??"",onChange:a=>i.handleChange(a.target.value),onBlur:i.handleBlur,placeholder:"Describe when to use this tag...",rows:2,disabled:s.state.isSubmitting||t}),f.jsx(Li,{field:i})]})}),f.jsxs("div",{className:"flex justify-end space-x-2 pt-2",children:[f.jsxs(ot,{variant:"ghost",size:"sm",onClick:r,disabled:s.state.isSubmitting||t,type:"button",children:[f.jsx(Si,{className:"h-4 w-4 mr-1"})," Cancel"]}),f.jsx(s.Subscribe,{selector:i=>[i.canSubmit,i.isSubmitting,i.isValidating,i.isValid],children:([i,a,o,l])=>f.jsxs(ot,{variant:"secondary",size:"sm",type:"submit",disabled:t||!i||a||o||!l,children:[(a||o)&&f.jsx(Hn,{className:"h-4 w-4 mr-1 animate-spin"}),f.jsx(Yu,{className:"h-4 w-4 mr-1"})," ",a||o?"Saving...":"Save Tag"]})})]})]})},jHe=({tags:e,rulesByTagId:t,isLoading:n,isDeleting:r,onEdit:s,onDelete:i})=>{const a=o=>{window.confirm(`Are you sure you want to delete the tag "${o.name}"? This will remove it from all rules.`)&&i(o.id,o.name)};return f.jsx("div",{className:"border rounded-md overflow-hidden",children:f.jsxs(Sf,{children:[f.jsx(vp,{children:f.jsxs(As,{children:[f.jsx(Rr,{children:"Name"}),f.jsx(Rr,{children:"Description"}),f.jsx(Rr,{children:"Linked Rules"}),f.jsx(Rr,{className:"text-right",children:"Actions"})]})}),f.jsx(_f,{children:n?f.jsxs(f.Fragment,{children:[f.jsx(As,{children:f.jsx(Bn,{colSpan:4,children:f.jsx(Gr,{className:"h-10 w-full"})})}),f.jsx(As,{children:f.jsx(Bn,{colSpan:4,children:f.jsx(Gr,{className:"h-10 w-full"})})})]}):e.length===0?f.jsx(As,{children:f.jsx(Bn,{colSpan:4,className:"h-24 text-center text-muted-foreground",children:"No tags defined yet."})}):e.map(o=>{const l=r[o.id],c=t.get(o.id)||[];return f.jsxs(As,{children:[f.jsx(Bn,{className:"font-medium",children:o.name}),f.jsx(Bn,{className:"text-xs text-muted-foreground truncate max-w-xs",children:o.description||"-"}),f.jsx(Bn,{className:"text-xs",children:c.length>0?c.map(u=>u.name).join(", "):"None"}),f.jsxs(Bn,{className:"text-right space-x-1",children:[f.jsx(Un,{tooltipText:"Edit Tag & Rules",onClick:()=>s(o),disabled:l,icon:f.jsx(k1,{}),className:"h-8 w-8","aria-label":`Edit tag ${o.name}`}),f.jsx(Un,{tooltipText:"Delete Tag",onClick:()=>a(o),disabled:l,icon:l?f.jsx(Hn,{className:"h-4 w-4 animate-spin"}):f.jsx(Vo,{}),className:"text-destructive hover:text-destructive/80 h-8 w-8","aria-label":`Delete tag ${o.name}`})]})]},o.id)})})]})})},PHe=({tag:e,allRules:t,linkedRuleIds:n,onLinkChange:r,disabled:s=!1})=>{const[i,a]=E.useState(!1),[o,l]=E.useState(""),c=E.useRef(null);E.useEffect(()=>{const b=v=>{c.current&&!c.current.contains(v.target)&&a(!1)};return document.addEventListener("mousedown",b),()=>{document.removeEventListener("mousedown",b)}},[]);const u=E.useMemo(()=>[...t].sort((b,v)=>b.name.localeCompare(v.name)),[t]),d=E.useMemo(()=>{const b=o.toLowerCase();return b?u.filter(v=>v.name.toLowerCase().includes(b)||v.content.toLowerCase().includes(b)||v.type.toLowerCase().includes(b)):u},[u,o]),h=E.useCallback(b=>{const v=n.has(b);r(e.id,b,!v),l("")},[n,r,e.id]),m=E.useCallback((b,v)=>{v.stopPropagation(),r(e.id,b,!1)},[r,e.id]),y=E.useMemo(()=>u.filter(b=>n.has(b.id)),[u,n]);return f.jsxs("div",{className:"space-y-3",children:[f.jsxs(Nt,{className:"font-medium",children:['Associated Rules for "',e.name,'"']}),f.jsxs("div",{className:"relative",ref:c,children:[f.jsxs(ot,{variant:"outline",role:"combobox","aria-expanded":i,className:"w-full justify-between h-9",disabled:s||t.length===0,onClick:()=>a(!i),children:[f.jsx("span",{className:"truncate",children:y.length>0?`${y.length} rule(s) selected`:"Select rules..."}),f.jsx(EE,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]}),i&&f.jsxs("div",{className:"absolute top-full left-0 right-0 z-[var(--z-popover)] mt-1 rounded-md border bg-popover text-popover-foreground shadow-md",children:[f.jsx("div",{className:"p-2",children:f.jsx(vn,{placeholder:"Search rules...",value:o,onChange:b=>l(b.target.value),className:"h-8"})}),f.jsx("div",{className:"max-h-48 overflow-auto",children:d.length===0?f.jsx("div",{className:"px-2 py-1.5 text-sm text-muted-foreground",children:t.length===0?"No rules defined.":"No rules found."}):d.map(b=>{const v=n.has(b.id);return f.jsxs("div",{onClick:()=>h(b.id),className:"relative flex cursor-pointer select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none hover:bg-accent hover:text-accent-foreground",children:[f.jsx(bo,{className:Ye("mr-2 h-4 w-4",v?"opacity-100":"opacity-0")}),f.jsx("span",{className:"truncate",children:b.name}),f.jsxs("span",{className:"ml-2 text-xs text-muted-foreground",children:["(",b.type,")"]})]},b.id)})})]})]}),y.length>0&&f.jsx("div",{className:"flex flex-wrap gap-1 pt-2",children:y.map(b=>f.jsxs(as,{variant:"secondary",className:"flex items-center gap-1",children:[f.jsx("span",{className:"truncate",children:b.name}),f.jsx(ot,{variant:"ghost",size:"icon",className:"h-4 w-4 p-0 text-muted-foreground hover:text-destructive hover:bg-transparent",onClick:v=>m(b.id,v),disabled:s,"aria-label":`Unlink rule ${b.name}`,children:f.jsx(Si,{className:"h-3 w-3"})})]},b.id))})]})},OHe=({module:e})=>{const[,t]=E.useState(Date.now()),n=e.getAllTags(),r=e.getAllRules(),s=e.getTagRuleLinks(),i=e.getRulesForTag,a=e.getIsLoadingRules(),[o,l]=E.useState(!1),[c,u]=E.useState(null),[d,h]=E.useState(!1),[m,y]=E.useState({});E.useEffect(()=>(e.setNotifySettingsCallback(()=>t(Date.now())),()=>{e.setNotifySettingsCallback(null)}),[e]);const b=()=>{u(null),l(!0)},v=A=>{u(A),l(!0)},x=E.useCallback(()=>{l(!1),u(null),h(!1)},[]),w=E.useCallback(async A=>{h(!0);try{c?e.updateTag(c.id,A):e.addTag(A),c||x()}catch{}finally{h(!1)}},[e,c,x]),_=E.useCallback(async A=>{y(N=>({...N,[A]:!0}));try{e.deleteTag(A),(c==null?void 0:c.id)===A&&x()}catch{}finally{y(N=>({...N,[A]:!1}))}},[e,c,x]),k=E.useCallback(async(A,N,I)=>{try{I?e.linkTagToRule(A,N):e.unlinkTagFromRule(A,N)}catch{}},[e]),C=E.useMemo(()=>{const A=new Map;return n.forEach(N=>{A.set(N.id,i(N.id))}),A},[n,i]),T=E.useMemo(()=>c?new Set(s.filter(A=>A.tagId===c.id).map(A=>A.ruleId)):new Set,[c,s]);return f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"text-lg font-semibold text-card-foreground",children:"Manage Tags"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Create tags to group related rules. You can activate tags before sending a prompt to apply their associated rules."})]}),!o&&f.jsxs(ot,{onClick:b,variant:"outline",className:"w-full",disabled:a,children:[f.jsx(nc,{className:"h-4 w-4 mr-1"})," Add New Tag"]}),o&&f.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[f.jsx(MHe,{initialData:c??void 0,isParentSaving:d,onSave:w,onCancel:x}),c&&f.jsx(PHe,{tag:c,allRules:r,linkedRuleIds:T,onLinkChange:k,disabled:d})]}),f.jsx(zm,{}),f.jsxs("div",{className:"pt-4",children:[f.jsx("h4",{className:"text-md font-medium mb-2",children:"Existing Tags"}),f.jsx(jHe,{tags:n,rulesByTagId:C,isLoading:a,isDeleting:m,onEdit:v,onDelete:_})]})]})},DHe=({module:e})=>{const[,t]=E.useState({});E.useEffect(()=>(e.setNotifySettingsCallback(()=>t({})),()=>e.setNotifySettingsCallback(null)),[e]);const n=E.useMemo(()=>[{value:"rules",label:"Rules",content:f.jsx(IHe,{module:e})},{value:"tags",label:"Tags",content:f.jsx(OHe,{module:e})}],[e]);return f.jsx(Tl,{tabs:n,defaultValue:"rules",className:"h-full",listClassName:"bg-muted/50 rounded-md",contentContainerClassName:"mt-4"})};class FHe{constructor(){ce(this,"id","core-rules-tags");ce(this,"unregisterPromptControlCallback",null);ce(this,"unregisterSettingsTabCallback",null);ce(this,"eventUnsubscribers",[]);ce(this,"modApiRef",null);ce(this,"allRules",[]);ce(this,"allTags",[]);ce(this,"tagRuleLinks",[]);ce(this,"transientActiveTagIds",new Set);ce(this,"transientActiveRuleIds",new Set);ce(this,"isStreaming",!1);ce(this,"hasRulesOrTags",!1);ce(this,"isLoadingRules",!0);ce(this,"notifyComponentUpdate",null);ce(this,"notifySettingsComponentUpdate",null);ce(this,"getAllRules",()=>this.allRules);ce(this,"getAllTags",()=>this.allTags);ce(this,"getTagRuleLinks",()=>this.tagRuleLinks);ce(this,"getRulesForTag",t=>{const n=new Set(this.tagRuleLinks.filter(r=>r.tagId===t).map(r=>r.ruleId));return this.allRules.filter(r=>n.has(r.id))});ce(this,"getRuleById",t=>this.allRules.find(n=>n.id===t));ce(this,"getTagById",t=>this.allTags.find(n=>n.id===t));ce(this,"getRulesByIds",t=>{const n=new Set(t);return this.allRules.filter(r=>n.has(r.id))});ce(this,"addRule",t=>{var n;(n=this.modApiRef)==null||n.emit(vr.addRuleRequest,t)});ce(this,"updateRule",(t,n)=>{var r;(r=this.modApiRef)==null||r.emit(vr.updateRuleRequest,{id:t,updates:n})});ce(this,"deleteRule",t=>{var n;(n=this.modApiRef)==null||n.emit(vr.deleteRuleRequest,{id:t})});ce(this,"addTag",t=>{var n;(n=this.modApiRef)==null||n.emit(vr.addTagRequest,t)});ce(this,"updateTag",(t,n)=>{var r;(r=this.modApiRef)==null||r.emit(vr.updateTagRequest,{id:t,updates:n})});ce(this,"deleteTag",t=>{var n;(n=this.modApiRef)==null||n.emit(vr.deleteTagRequest,{id:t})});ce(this,"linkTagToRule",(t,n)=>{var r;(r=this.modApiRef)==null||r.emit(vr.linkTagToRuleRequest,{tagId:t,ruleId:n})});ce(this,"unlinkTagFromRule",(t,n)=>{var r;(r=this.modApiRef)==null||r.emit(vr.unlinkTagFromRuleRequest,{tagId:t,ruleId:n})});ce(this,"handleTriggerClick",()=>!this.hasRulesOrTags&&this.modApiRef?(this.modApiRef.emit(Tr.openModalRequest,{modalId:"settingsModal",initialTab:"rules-tags"}),!0):!1);ce(this,"getIsStreaming",()=>this.isStreaming);ce(this,"getHasRulesOrTags",()=>this.hasRulesOrTags);ce(this,"getIsLoadingRules",()=>this.isLoadingRules);ce(this,"getActiveTagIds",()=>this.transientActiveTagIds);ce(this,"getActiveRuleIds",()=>this.transientActiveRuleIds);ce(this,"setActiveTagIds",t=>{var n;this.transientActiveTagIds=t(this.transientActiveTagIds),(n=this.notifyComponentUpdate)==null||n.call(this)});ce(this,"setActiveRuleIds",t=>{var n;this.transientActiveRuleIds=t(this.transientActiveRuleIds),(n=this.notifyComponentUpdate)==null||n.call(this)});ce(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t});ce(this,"setNotifySettingsCallback",t=>{this.notifySettingsComponentUpdate=t})}async initialize(t){this.modApiRef=t,this.isStreaming=t.getContextSnapshot().isStreaming,t.emit(vr.loadRulesAndTagsRequest,void 0);const n=t.on(xn.statusChanged,s=>{var i;typeof s=="object"&&s&&"status"in s&&this.isStreaming!==(s.status==="streaming")&&(this.isStreaming=s.status==="streaming",(i=this.notifyComponentUpdate)==null||i.call(this))}),r=t.on(vr.dataLoaded,s=>{var i,a;s&&(this.allRules=s.rules||[],this.allTags=s.tags||[],this.tagRuleLinks=(s.links||[]).map(o=>({tagId:o.tagId,ruleId:o.ruleId}))),this.updateHasRulesOrTags(),this.isLoadingRules=!1,(i=this.notifyComponentUpdate)==null||i.call(this),(a=this.notifySettingsComponentUpdate)==null||a.call(this)});this.eventUnsubscribers.push(n,r)}updateHasRulesOrTags(){const t=this.allRules.length>0||this.allTags.length>0;this.hasRulesOrTags!==t&&(this.hasRulesOrTags=t)}register(t){this.modApiRef=t,this.unregisterPromptControlCallback||(this.unregisterPromptControlCallback=t.registerPromptControl({id:this.id,status:()=>this.isLoadingRules?"loading":"ready",triggerRenderer:()=>Ve.createElement(kHe,{module:this}),getMetadata:()=>{const n=Array.from(this.transientActiveTagIds),r=Array.from(this.transientActiveRuleIds),s=[],i=new Set(r);if(n.forEach(a=>{this.getRulesForTag(a).forEach(o=>i.add(o.id))}),i.forEach(a=>{const o=this.getRuleById(a);o&&s.push({type:o.type,content:o.content,sourceRuleId:o.id})}),n.length>0||r.length>0||s.length>0)return{activeTagIds:n,activeRuleIds:r,effectiveRulesContent:s}},clearOnSubmit:()=>{var r;let n=!1;this.transientActiveTagIds.size>0&&(this.transientActiveTagIds=new Set,n=!0),this.transientActiveRuleIds.size>0&&(this.transientActiveRuleIds=new Set,n=!0),n&&((r=this.notifyComponentUpdate)==null||r.call(this))}})),this.unregisterSettingsTabCallback||(this.unregisterSettingsTabCallback=t.registerSettingsTab({id:"rules-tags",title:"Rules & Tags",component:()=>Ve.createElement(DHe,{module:this}),order:50}))}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterPromptControlCallback&&(this.unregisterPromptControlCallback(),this.unregisterPromptControlCallback=null),this.unregisterSettingsTabCallback&&(this.unregisterSettingsTabCallback(),this.unregisterSettingsTabCallback=null),this.notifyComponentUpdate=null,this.notifySettingsComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const LHe=({module:e})=>{const[,t]=E.useState({});E.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const n=e.getTurnEnabled(),r=e.getIsStreaming(),s=e.getGlobalAutoTitleEnabled()&&e.getIsFirstInteraction(),i=E.useCallback(()=>{const a=!n;e.setTurnEnabled(a)},[n,e]);return s?f.jsx(wr,{delayDuration:100,children:f.jsxs(Sr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(ot,{variant:n?"secondary":"ghost",size:"icon",className:"h-8 w-8",onClick:i,disabled:r,"aria-label":n?"Disable Auto-Title for this Chat":"Enable Auto-Title for this Chat",children:f.jsx(tme,{className:Ye("h-4 w-4",n?"text-primary":"text-muted-foreground")})})}),f.jsx(Cr,{side:"top",children:n?"Auto-Title Enabled (Click to Disable)":"Auto-Title Disabled (Click to Enable)"})]})}):null};class BHe{constructor(){ce(this,"id","core-auto-title");ce(this,"unregisterCallback",null);ce(this,"eventUnsubscribers",[]);ce(this,"turnAutoTitleEnabled",!1);ce(this,"isStreaming",!1);ce(this,"isFirstInteraction",!1);ce(this,"globalAutoTitleEnabled",!0);ce(this,"notifyComponentUpdate",null);ce(this,"getTurnEnabled",()=>this.turnAutoTitleEnabled);ce(this,"getIsStreaming",()=>this.isStreaming);ce(this,"getIsFirstInteraction",()=>this.isFirstInteraction);ce(this,"getGlobalAutoTitleEnabled",()=>this.globalAutoTitleEnabled);ce(this,"setTurnEnabled",t=>{var n;this.turnAutoTitleEnabled!==t&&(this.turnAutoTitleEnabled=t,(n=this.notifyComponentUpdate)==null||n.call(this))});ce(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){var a;this.turnAutoTitleEnabled=!1,this.isStreaming=nn.getState().status==="streaming",this.globalAutoTitleEnabled=pr.getState().autoTitleEnabled,this.checkFirstInteraction(),(a=this.notifyComponentUpdate)==null||a.call(this);const n=t.on(xn.statusChanged,o=>{var l;typeof o=="object"&&o&&"status"in o&&this.isStreaming!==(o.status==="streaming")&&(this.isStreaming=o.status==="streaming",(l=this.notifyComponentUpdate)==null||l.call(this))}),r=t.on(Tr.contextChanged,()=>{var l;const o=this.isFirstInteraction;this.checkFirstInteraction(),o!==this.isFirstInteraction&&((l=this.notifyComponentUpdate)==null||l.call(this))}),s=t.on(xn.completed,()=>{var l;const o=this.isFirstInteraction;this.checkFirstInteraction(),o!==this.isFirstInteraction&&((l=this.notifyComponentUpdate)==null||l.call(this))}),i=t.on(on.autoTitleEnabledChanged,o=>{var l;typeof o=="object"&&o&&"enabled"in o&&this.globalAutoTitleEnabled!==o.enabled&&(this.globalAutoTitleEnabled=o.enabled,(l=this.notifyComponentUpdate)==null||l.call(this))});this.eventUnsubscribers.push(n,r,s,i)}checkFirstInteraction(){const t=nn.getState(),n=t.currentConversationId===null||t.interactions.filter(r=>r.conversationId===t.currentConversationId).length===0;this.isFirstInteraction!==n&&(this.isFirstInteraction=n,!n&&this.turnAutoTitleEnabled&&(this.turnAutoTitleEnabled=!1))}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}const n=()=>Ve.createElement(LHe,{module:this});this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:n,getMetadata:()=>this.turnAutoTitleEnabled?{autoTitleEnabledForTurn:!0}:void 0,clearOnSubmit:()=>{var r;this.turnAutoTitleEnabled&&(this.turnAutoTitleEnabled=!1,(r=this.notifyComponentUpdate)==null||r.call(this))}})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,console.log(`[${this.id}] Destroyed.`)}}function $He(){const e=new URLSearchParams(window.location.search),t=e.get("q")??void 0,n=e.get("m")??void 0,r=e.getAll("vfs").filter(Boolean),s=e.get("s")??"1";return{query:t,modelId:n,vfsFiles:r.length>0?r:void 0,submit:s}}class zHe{constructor(){ce(this,"id","core-url-parameters");ce(this,"modApiRef",null)}async initialize(t){this.modApiRef=t,console.log(`[${this.id}] Initializing...`),t.on(bp.initializationPhaseCompleted,n=>{n.phase==="all"&&this.processUrlParameters().catch(r=>{console.error(`[${this.id}] Error processing URL parameters:`,r),ke.error("Failed to process URL parameters.")})}),console.log(`[${this.id}] Initialized, awaiting full app load.`)}register(t){}destroy(){this.modApiRef=null}async processUrlParameters(){var r,s;if(!this.modApiRef){console.warn(`[${this.id}] ModAPI not available, cannot process URL parameters.`);return}const t=this.modApiRef,n=$He();if(!(!n.query&&!n.modelId&&!((r=n.vfsFiles)!=null&&r.length))){ke.info("Processing parameters from URL...");try{const i=await new Promise((a,o)=>{const l=t.on(tr.conversationAdded,c=>{c.conversation.title.startsWith("From URL:")&&(l(),a(c.conversation.id))});setTimeout(()=>{l(),o(new Error("Timeout waiting for conversation creation event."))},5e3),t.emit(tr.addConversationRequest,{title:n.query?`From URL: ${n.query.substring(0,30)}...`:"From URL Parameters"})});if(t.emit(tr.selectItemRequest,{id:i,type:"conversation"}),n.modelId){const a=Gn.getState().getAvailableModelListItems();let o=null;const l=n.modelId.toLowerCase();if(n.modelId.includes(":")){const c=a.find(u=>u.id===n.modelId);c&&(o=c.id)}if(!o){const c=a.find(u=>u.name.toLowerCase()===l);c&&(o=c.id)}if(!o){const c=a.find(u=>u.name.toLowerCase().startsWith(l));c&&(o=c.id)}if(!o){const c=a.find(u=>{const d=u.id.toLowerCase().split("/");return d.length>1&&d[1].startsWith(l)});c&&(o=c.id)}if(o){t.emit(an.setModelIdRequest,{id:o}),t.emit(Vn.selectModelRequest,{modelId:o});const c=a.find(u=>u.id===o);ke.success(`Model set to: ${c==null?void 0:c.name} (${c==null?void 0:c.providerName})`)}else ke.warning(`Model matching "${n.modelId}" not found or not enabled. Using default.`)}if(n.vfsFiles&&n.vfsFiles.length>0){const a="orphan";let o;try{if(o=await t.getVfsInstance(a),!o)throw new Error("Failed to get VFS instance via ModAPI.")}catch(l){ke.error(`Failed to initialize VFS for URL files: ${l instanceof Error?l.message:String(l)}`)}if(o)for(const l of n.vfsFiles)try{const c=await fp(l,{fsInstance:o}),u=await o.promises.stat(l),d=xi(l),h="application/octet-stream",m=ow(d,h);let y={};if(m)y.contentText=new TextDecoder().decode(c);else{let b="";const v=c.byteLength;for(let x=0;x<v;x++)b+=String.fromCharCode(c[x]);y.contentBase64=window.btoa(b)}t.emit(Yl.addAttachedFileRequest,{source:"vfs",name:d,type:h,size:u.size,path:l,...y}),ke.success(`Attached VFS file: ${d}`)}catch(c){c.code==="ENOENT"?ke.warning(`VFS file not found: ${l}`):ke.warning(`Failed to attach VFS file "${l}": ${c.message}`),console.error(`Error processing VFS file ${l}:`,c)}}if(n.query)if(n.submit==="0")t.emit(an.inputChanged,{value:n.query}),ke.info("Query from URL loaded into input area."),window.history.replaceState({},document.title,window.location.pathname);else{let a={},o={};const l=Ph.getState().attachedFilesMetadata;l.length>0&&(o.attachedFiles=[...l]);let c={id:Nr(),content:n.query,parameters:a,metadata:o};t.emit(an.submitted,{turnData:c});const u=await Y2(gy.PROMPT_TURN_FINALIZE,{turnData:c});if(u===!1){ke.warning("Prompt submission from URL cancelled by middleware.");return}const d=u&&typeof u=="object"?u.turnData:c;await xh.submitPrompt(d),window.history.replaceState({},document.title,window.location.pathname)}else(n.modelId||(s=n.vfsFiles)!=null&&s.length)&&(ke.info("Model and/or VFS files from URL applied. Type your message."),window.history.replaceState({},document.title,window.location.pathname))}catch(i){ke.error(`Failed to process URL parameters: ${i instanceof Error?i.message:String(i)}`),console.error("Error processing URL parameters:",i)}}}}const UHe=({module:e})=>{const[t,n]=E.useState(!1),[,r]=E.useState({});E.useEffect(()=>(e.setNotifyCallback(()=>r({})),()=>e.setNotifyCallback(null)),[e]),E.useEffect(()=>{const o=e.getImageGenerationEnabled();n(o===!0)},[e]);const s=e.getIsVisible(),i=e.getIsStreaming(),a=E.useCallback(()=>{const o=!t;e.setImageGenerationEnabled(o?!0:null),n(o)},[t,e]);return s?f.jsx(wr,{delayDuration:100,children:f.jsxs(Sr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(ot,{variant:t?"secondary":"ghost",size:"icon",onClick:a,disabled:i,className:"h-8 w-8","aria-label":t?"Disable Image Generation for Next Turn":"Enable Image Generation for Next Turn",children:f.jsx(cy,{className:Ye("h-4 w-4",t?"text-primary":"text-muted-foreground")})})}),f.jsx(Cr,{side:"top",children:t?"Image Generation Enabled (Click to Disable)":"Image Generation Disabled (Click to Enable)"})]})}):null};class qHe{constructor(){ce(this,"id","core-image-generation");ce(this,"modApiRef",null);ce(this,"isImageGenerationEnabled",null);ce(this,"unregisterCallback",null);ce(this,"notifyComponentUpdate",null);ce(this,"eventUnsubscribers",[]);ce(this,"isVisible",!1);ce(this,"isStreaming",!1);ce(this,"getImageGenerationEnabled",()=>this.isImageGenerationEnabled);ce(this,"getIsVisible",()=>this.isVisible);ce(this,"getIsStreaming",()=>this.isStreaming);ce(this,"setImageGenerationEnabled",t=>{var n,r;this.isImageGenerationEnabled=t,(n=this.modApiRef)==null||n.emit(an.setImageGenerationEnabledRequest,{enabled:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});ce(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){this.modApiRef=t,this.isImageGenerationEnabled=null,this.isStreaming=nn.getState().status==="streaming",this.updateVisibility();const n=t.on(Vn.selectedModelChanged,()=>{var s;this.updateVisibility(),(s=this.notifyComponentUpdate)==null||s.call(this)}),r=t.on(xn.statusChanged,s=>{var i;typeof s=="object"&&s&&"status"in s&&this.isStreaming!==(s.status==="streaming")&&(this.isStreaming=s.status==="streaming",(i=this.notifyComponentUpdate)==null||i.call(this))});this.eventUnsubscribers.push(n,r),console.log(`[${this.id}] Initialized.`)}updateVisibility(){var i,a;const{getSelectedModel:t}=Gn.getState(),n=t(),s=(((a=(i=n==null?void 0:n.metadata)==null?void 0:i.architecture)==null?void 0:a.output_modalities)??[]).includes("image");this.isVisible!==s&&(this.isVisible=s)}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>Ve.createElement(UHe,{module:this}),getMetadata:()=>this.isImageGenerationEnabled===!0?{imageGenerationEnabled:!0}:void 0,clearOnSubmit:()=>{var s;(s=this.modApiRef)==null||s.emit(an.setImageGenerationEnabledRequest,{enabled:null})}});const n=s=>{var i;s.enabled!==this.isImageGenerationEnabled&&(this.isImageGenerationEnabled=s.enabled,(i=this.notifyComponentUpdate)==null||i.call(this))},r=this.modApiRef.on(an.setImageGenerationEnabledRequest,n);this.eventUnsubscribers.push(r),console.log(`[${this.id}] Registered successfully`)}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const VHe=({module:e})=>{const[t,n]=E.useState(!1),[r,s]=E.useState([]),[i,a]=E.useState(250),[o,l]=E.useState(120),[c,u]=E.useState(!1),[d,h]=E.useState(null),[m,y]=E.useState(`You are a helpful assistant that analyzes and combines multiple AI model responses. Below are responses from different models to the same prompt. Please provide a comprehensive combined response that incorporates the best insights from each model while maintaining coherence and accuracy.

Please analyze the responses and provide a single, well-structured answer that combines their strengths.`),[b,v]=E.useState(""),[x,w]=E.useState({reasoning:!1,webSearch:!1,tools:!1,multimodal:!1,imageGeneration:!1}),[,_]=E.useState({}),{status:k}=nn(mn(K=>({status:K.status})));E.useEffect(()=>{if(e)return e.setNotifyCallback(()=>_({})),()=>e.setNotifyCallback(null)},[e]);const C=E.useMemo(()=>{let K=e.globallyEnabledModels;if(b.trim()){const W=b.toLowerCase();K=e.globallyEnabledModels.filter(B=>B.name.toLowerCase().includes(W)||B.providerName.toLowerCase().includes(W)||B.id.toLowerCase().includes(W))}const U=Object.entries(x).filter(([,W])=>W).map(([W])=>W);return U.length===0?K:K.filter(W=>{var Q,ee,re;const B=new Set(((Q=W.metadataSummary)==null?void 0:Q.supported_parameters)??[]),ne=new Set(((ee=W.metadataSummary)==null?void 0:ee.input_modalities)??[]),V=new Set(((re=W.metadataSummary)==null?void 0:re.output_modalities)??[]);return U.every(de=>{switch(de){case"reasoning":return B.has("reasoning");case"webSearch":return B.has("web_search")||B.has("web_search_options");case"tools":return B.has("tools");case"multimodal":return Array.from(ne).some(me=>me!=="text");case"imageGeneration":return V.has("image");default:return!0}})})},[e.globallyEnabledModels,b,x]),T=K=>{w(U=>({...U,[K]:!U[K]}))},N=Object.values(x).filter(Boolean).length,I=(K,U)=>{s(W=>U?[...W,K]:W.filter(B=>B!==K))},j=()=>{if(r.length<1){ke.error("Please select at least 1 model to race");return}if(c&&!d){ke.error("Please select a model for combining");return}e.setRaceMode(!0,{modelIds:r,staggerMs:i,raceTimeoutSec:o,combineEnabled:c,combineModelId:d||void 0,combinePrompt:m}),n(!1),ke.info(`Race mode enabled! Send your prompt to race ${r.length} models.`),s([]),a(250),l(120),v(""),w({reasoning:!1,webSearch:!1,tools:!1,multimodal:!1,imageGeneration:!1}),u(!1),h(null),y(`You are a helpful assistant that analyzes and combines multiple AI model responses. Below are responses from different models to the same prompt. Please provide a comprehensive combined response that incorporates the best insights from each model while maintaining coherence and accuracy.

Please analyze the responses and provide a single, well-structured answer that combines their strengths.`)},L=()=>{e.setRaceMode(!1),ke.info("Race mode disabled")},D=K=>{if(K.stopPropagation(),e.isRaceModeActive){L();return}if(k==="streaming"){ke.info("Cannot start race while another response is streaming");return}if(e.globallyEnabledModels.length<2){ke.info("Need at least 2 models enabled to race");return}n(!0)},H=k!=="streaming"&&e.globallyEnabledModels.length>=2,O=()=>e.isRaceModeActive?"Race mode active - click to cancel, or send your prompt to race models":k==="streaming"?"Cannot race while streaming":e.globallyEnabledModels.length<2?`Need at least 2 models enabled to race (currently have ${e.globallyEnabledModels.length})`:"Race multiple models with your prompt";return f.jsxs(f.Fragment,{children:[f.jsx(Un,{tooltipText:O(),onClick:D,"aria-label":"Race Multiple Models Against Each Other",disabled:!H,icon:f.jsx(VH,{}),className:`h-5 w-5 md:h-6 md:w-6 ${e.isRaceModeActive?"bg-primary text-primary-foreground":""}`}),f.jsx(td,{open:t,onOpenChange:n,children:f.jsxs(nd,{className:"min-w-[85vw] max min-h-[75vh] flex flex-col p-4",children:[f.jsxs(rd,{children:[f.jsx(sd,{children:"Race Models"}),f.jsx(wf,{children:'Select multiple models to race against each other. After clicking "Enable Race Mode", send your prompt and all selected models will respond.'})]}),f.jsxs("div",{className:"space-y-4",children:[f.jsx("div",{className:"space-y-2",children:f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsxs("div",{className:"relative flex-grow",children:[f.jsx(vo,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),f.jsx(vn,{type:"search",placeholder:"Search models...",value:b,onChange:K=>v(K.target.value),className:"pl-8 h-9"})]}),f.jsxs("div",{className:"flex items-center gap-0.5",children:[f.jsx(ot,{variant:x.reasoning?"secondary":"ghost",size:"sm",className:Ye("h-7 w-7 p-0",x.reasoning&&"text-primary"),onClick:()=>T("reasoning"),title:"Filter: Reasoning","aria-label":"Filter by reasoning capability",children:f.jsx(v2,{className:"h-4 w-4"})}),f.jsx(ot,{variant:x.webSearch?"secondary":"ghost",size:"sm",className:Ye("h-7 w-7 p-0",x.webSearch&&"text-primary"),onClick:()=>T("webSearch"),title:"Filter: Web Search","aria-label":"Filter by web search capability",children:f.jsx(x2,{className:"h-4 w-4"})}),f.jsx(ot,{variant:x.tools?"secondary":"ghost",size:"sm",className:Ye("h-7 w-7 p-0",x.tools&&"text-primary"),onClick:()=>T("tools"),title:"Filter: Tools","aria-label":"Filter by tool usage capability",children:f.jsx(Am,{className:"h-4 w-4"})}),f.jsx(ot,{variant:x.multimodal?"secondary":"ghost",size:"sm",className:Ye("h-7 w-7 p-0",x.multimodal&&"text-primary"),onClick:()=>T("multimodal"),title:"Filter: Multimodal","aria-label":"Filter by multimodal capability",children:f.jsx(Mh,{className:"h-4 w-4"})}),f.jsx(ot,{variant:x.imageGeneration?"secondary":"ghost",size:"sm",className:Ye("h-7 w-7 p-0",x.imageGeneration&&"text-primary"),onClick:()=>T("imageGeneration"),title:"Filter: Image Generation","aria-label":"Filter by image generation capability",children:f.jsx(cy,{className:"h-4 w-4"})})]}),N>0&&f.jsx("span",{className:"inline-flex items-center justify-center px-1.5 py-0.5 text-xs font-semibold leading-none text-white bg-primary rounded-full",children:N})]})}),f.jsxs("div",{className:"space-y-2",children:[f.jsxs(Nt,{children:["Select Models to Race (",r.length," selected)"]}),f.jsx(Xo,{className:"h-48 w-full border rounded-md p-3",children:f.jsx("div",{className:"space-y-2",children:C.length===0?f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:N>0?"No models match all active filters.":e.globallyEnabledModels.length===0?"No models available.":"No models match search."}):C.map(K=>{var U,W,B,ne,V,Q,ee,re,de,me,De,je;return f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(Yc,{id:`model-${K.id}`,checked:r.includes(K.id),onCheckedChange:Te=>I(K.id,Te===!0)}),f.jsxs(Nt,{htmlFor:`model-${K.id}`,className:"text-sm cursor-pointer flex-1 min-w-0 flex justify-between items-center",children:[f.jsxs("div",{className:"truncate",children:[f.jsx("span",{className:"font-medium",children:K.name}),f.jsxs("span",{className:"text-muted-foreground ml-2",children:["(",K.providerName,")"]})]}),f.jsxs("div",{className:"flex gap-1 ml-2",children:[((W=(U=K.metadataSummary)==null?void 0:U.supported_parameters)==null?void 0:W.includes("reasoning"))&&f.jsx(v2,{className:"h-3.5 w-3.5 text-purple-500"}),(((ne=(B=K.metadataSummary)==null?void 0:B.supported_parameters)==null?void 0:ne.includes("web_search"))||((Q=(V=K.metadataSummary)==null?void 0:V.supported_parameters)==null?void 0:Q.includes("web_search_options")))&&f.jsx(x2,{className:"h-3.5 w-3.5 text-blue-500"}),((re=(ee=K.metadataSummary)==null?void 0:ee.supported_parameters)==null?void 0:re.includes("tools"))&&f.jsx(Am,{className:"h-3.5 w-3.5 text-orange-500"}),((me=(de=K.metadataSummary)==null?void 0:de.input_modalities)==null?void 0:me.some(Te=>Te!=="text"))&&f.jsx(Mh,{className:"h-3.5 w-3.5 text-green-500"}),((je=(De=K.metadataSummary)==null?void 0:De.output_modalities)==null?void 0:je.includes("image"))&&f.jsx(cy,{className:"h-3.5 w-3.5 text-pink-500"})]})]})]},K.id)})})})]}),f.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsx(Nt,{htmlFor:"stagger-ms",children:"Stagger (ms)"}),f.jsx(vn,{id:"stagger-ms",type:"number",value:i,onChange:K=>a(parseInt(K.target.value,10)),className:"mt-1"})]}),f.jsxs("div",{children:[f.jsx(Nt,{htmlFor:"race-timeout",children:"Timeout (s)"}),f.jsx(vn,{id:"race-timeout",type:"number",value:o,onChange:K=>l(parseInt(K.target.value,10)||120),className:"mt-1"})]})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx(Nt,{htmlFor:"combine-switch",children:"Combine Models"}),f.jsx(fo,{id:"combine-switch",checked:c,onCheckedChange:K=>u(K)})]}),c&&f.jsxs("div",{className:"space-y-2",children:[f.jsx(Nt,{htmlFor:"combine-model-selector",children:"Combine with Model"}),f.jsx(xp,{models:e.globallyEnabledModels,value:d,onChange:K=>h(K),isLoading:e.isLoadingProviders})]}),c&&f.jsxs("div",{className:"space-y-2",children:[f.jsx(Nt,{htmlFor:"combine-prompt",children:"Combine Prompt"}),f.jsx(Ci,{id:"combine-prompt",value:m,onChange:K=>y(K.target.value),placeholder:"Enter a prompt to combine models",className:"w-full"})]})]}),f.jsxs(dg,{children:[f.jsx(ot,{variant:"outline",onClick:()=>n(!1),children:"Cancel"}),f.jsx(ot,{onClick:j,disabled:r.length<1||e.isLoadingProviders,children:"Enable Race Mode"})]})]})})]})};class WHe{constructor(){ce(this,"id","race-prompt-control");ce(this,"eventUnsubscribers",[]);ce(this,"modApi",null);ce(this,"notifyComponentUpdate",null);ce(this,"isRaceMode",!1);ce(this,"raceConfig",{modelIds:[],staggerMs:250,raceTimeoutSec:120,combineEnabled:!1});ce(this,"globallyEnabledModels",[]);ce(this,"isLoadingProviders",!1)}async initialize(t){this.modApi=t;const n=Gn.getState();this.globallyEnabledModels=n.getGloballyEnabledModelDefinitions(),this.isLoadingProviders=n.isLoading;const r=t.on(Vn.globallyEnabledModelsUpdated,a=>{var o;this.globallyEnabledModels=a.models,(o=this.notifyComponentUpdate)==null||o.call(this)}),s=t.on(Vn.initialDataLoaded,a=>{var o;a.globallyEnabledModels&&(this.globallyEnabledModels=a.globallyEnabledModels,this.isLoadingProviders=!1,(o=this.notifyComponentUpdate)==null||o.call(this))}),i=t.addMiddleware(gy.INTERACTION_BEFORE_START,a=>{if(this.isRaceMode){const o={...this.raceConfig};return this.setRaceMode(!1),this.handleRaceConversion(a.prompt,a.conversationId,o),!1}return a});this.eventUnsubscribers.push(r,s,i)}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.notifyComponentUpdate=null,this.modApi=null}setNotifyCallback(t){this.notifyComponentUpdate=t}setRaceMode(t,n){var r;this.isRaceMode=t,t&&n?this.raceConfig={...n,raceTimeoutSec:n.raceTimeoutSec||120}:this.raceConfig={modelIds:[],staggerMs:250,raceTimeoutSec:120,combineEnabled:!1},(r=this.notifyComponentUpdate)==null||r.call(this)}get isRaceModeActive(){return this.isRaceMode}async handleRaceConversion(t,n,r){var s,i;try{const{modelIds:a,staggerMs:o,combineEnabled:l,combineModelId:c}=r;if(a.length===0)throw new Error("No additional models selected for race");if(l&&!c)throw new Error("Combine model not selected");const u=nn.getState(),d=t.messages[t.messages.length-1];if(!d||d.role!=="user")throw new Error("Could not find user message in prompt");let h="";typeof d.content=="string"?h=d.content:Array.isArray(d.content)&&(h=d.content.filter(b=>b.type==="text").map(b=>b.text).join(""));const m={id:"",content:h,parameters:t.parameters||{},metadata:{...t.metadata,modelId:((s=t.metadata)==null?void 0:s.modelId)||""}},y=(i=t.metadata)==null?void 0:i.modelId;if(!y)throw new Error("No model ID available in prompt metadata");if(l){const{nanoid:b}=await Fr(async()=>{const{nanoid:j}=await Promise.resolve().then(()=>NN);return{nanoid:j}},void 0),v=b(),x={...m,id:v,metadata:{...m.metadata,modelId:c,isRaceCombining:!0,raceParticipantCount:a.length+1,raceConfig:r}},_=u.interactions.filter(j=>j.conversationId===n).reduce((j,L)=>Math.max(j,L.index),-1)+1,k={id:v,conversationId:n,type:"message.user_assistant",prompt:{...x},response:null,status:"STREAMING",startedAt:new Date,endedAt:null,metadata:{...x.metadata,isRaceCombining:!0,raceParticipantCount:a.length+1,toolCalls:[],toolResults:[]},index:_,parentId:null};u._addInteractionToState(k),u._addStreamingId(k.id),u.setActiveStreamBuffer(k.id,"🏁 Starting race with "+(a.length+1)+` models...

⏳ Collecting responses for combination...`),await yt.saveInteraction(k),Ce.emit(xn.added,{interaction:k}),Ce.emit(xn.started,{interactionId:k.id,conversationId:k.conversationId,type:k.type});const T=[y,...a].map((j,L)=>new Promise(D=>{setTimeout(async()=>{try{const H=b(),O={...m,id:H,metadata:{...m.metadata,modelId:j,raceTab:!0,raceParticipantIndex:L+1,raceMainInteractionId:k.id}},K={...t,metadata:{...t.metadata,modelId:j}},U=await bl.startInteraction(K,n,O,"message.assistant_regen");if(U){const W={parentId:k.id,index:L+1};u._updateInteractionInState(U.id,W),await yt.saveInteraction({...U,...W})}D({interaction:U,modelId:j})}catch(H){console.error(`[RacePromptControlModule] Error creating child interaction for ${j}:`,H),D({interaction:null,modelId:j})}},L*o)})),I=(await Promise.all(T)).filter(j=>j.interaction!==null).map(j=>j.interaction.id);await this.waitForRaceCompletion(k.id,I,r.raceTimeoutSec)}else{const{nanoid:b}=await Fr(async()=>{const{nanoid:T}=await Promise.resolve().then(()=>NN);return{nanoid:T}},void 0),v=b(),x={...m,id:v,metadata:{...m.metadata,modelId:y,raceTab:!0,raceParticipantIndex:1,raceMainInteractionId:v}},w=await bl.startInteraction(t,n,x,"message.user_assistant");if(!w)throw new Error("Could not create main race interaction");const _=a.map((T,A)=>new Promise(N=>{setTimeout(async()=>{try{const I=b(),j={...m,id:I,metadata:{...m.metadata,modelId:T,raceTab:!0,raceParticipantIndex:A+2,raceMainInteractionId:w.id}},L={...t,metadata:{...t.metadata,modelId:T}},D=await bl.startInteraction(L,n,j,"message.assistant_regen");if(D){const H={parentId:w.id,index:A+1};u._updateInteractionInState(D.id,H),await yt.saveInteraction({...D,...H})}N({interaction:D,modelId:T})}catch(I){console.error(`[RacePromptControlModule] Error creating child interaction for ${T}:`,I),N({interaction:null,modelId:T})}},A*o)})),C=(await Promise.all(_)).filter(T=>T.interaction!==null);ke.success(`Race started! Original model + ${C.length} additional race models responding in tabs.`)}}catch(a){ke.error(`Race conversion failed: ${String(a)}`),console.error("[RacePromptControlModule] Error during race conversion:",a)}}async waitForRaceCompletion(t,n,r=120){return new Promise(s=>{let i=0;const a=n.length;let o=null;const l=()=>{o&&(clearTimeout(o),o=null),Ce.off(xn.completed,c)},c=u=>{if(n.includes(u.interactionId)&&(u.status==="COMPLETED"||u.status==="ERROR")){i++;const d=nn.getState(),h=`🏁 Race progress: ${i}/${a} models completed

⏳ ${i===a?"Combining responses...":"Waiting for remaining responses..."}`;d.setActiveStreamBuffer(t,h);const m={metadata:{isRaceCombining:!0,raceCompletedCount:i,raceParticipantCount:a}};d._updateInteractionInState(t,m),i===a&&(l(),this.startCombineProcess(t,n),s())}};Ce.on(xn.completed,c),o=setTimeout(()=>{console.warn(`[RacePromptControlModule] Race timed out for main interaction ${t}.`),l();const u=nn.getState(),d=`❌ Race timed out. Only ${i}/${a} models responded within ${r} seconds.`;u.setActiveStreamBuffer(t,d),u._updateInteractionInState(t,{status:"ERROR",endedAt:new Date,metadata:{isRaceCombining:!1,combineError:"Race timed out"}}),u._removeStreamingId(t),s()},r*1e3)})}async startCombineProcess(t,n){var r;try{const s=nn.getState(),i=s.interactions.find(v=>v.id===t),a=(r=i==null?void 0:i.metadata)==null?void 0:r.raceConfig,{combineModelId:o,combinePrompt:l}=a||{};if(!o)throw new Error("Combine model not configured");const c=s.currentConversationId;if(!c)throw new Error("No current conversation ID available for combine process");const u=n.map((v,x)=>{var T;const w=s.interactions.find(A=>A.id===v),_=((T=w==null?void 0:w.metadata)==null?void 0:T.modelId)||`Model ${x+1}`,k=(w==null?void 0:w.response)||"No response",C=(w==null?void 0:w.status)||"UNKNOWN";return`**${_}** (${C}):
${k}`}).join(`

---

`),m={system:"You are an expert at analyzing and synthesizing multiple AI responses into comprehensive, unified answers.",messages:[{role:"user",content:`${l||`Please analyze and combine the following AI responses to provide a comprehensive, well-structured answer. 

Take the best insights from each response, resolve any contradictions, and present a unified, clear, and complete answer. If responses differ significantly, explain the different perspectives and provide your reasoned conclusion.

Focus on accuracy, completeness, and clarity in your combined response.`}

Here are the responses to combine:

${u}`}],parameters:{temperature:.3,max_tokens:4e3},metadata:{modelId:o,isCompactGeneration:!0}},{nanoid:y}=await Fr(async()=>{const{nanoid:v}=await Promise.resolve().then(()=>NN);return{nanoid:v}},void 0),b={id:y(),content:`[Internal combine generation for race interaction ${t}]`,parameters:m.parameters,metadata:{modelId:o,targetUserInteractionId:t,targetConversationId:c}};await bl.startInteraction(m,c,b,"conversation.compact")}catch(s){const i=nn.getState();i._updateInteractionInState(t,{response:`❌ Failed to combine responses: ${String(s)}`,status:"ERROR",endedAt:new Date,metadata:{isRaceCombining:!1,combineError:String(s)}}),i._removeStreamingId(t)}}register(t){t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>Ve.createElement(VHe,{module:this})})}}const HHe=Ke({selectedModelId:$e().min(1,"Please select a model"),originalPrompt:$e().min(1,"Please enter a prompt to enhance"),customSystemPrompt:$e().optional()}),GHe=({module:e})=>{const[t,n]=E.useState(!1),[r,s]=E.useState("setup"),[,i]=E.useState({}),[a,o]=E.useState(!1),[l,c]=E.useState(""),[u,d]=E.useState(null),{status:h}=nn(mn(C=>({status:C.status})));E.useEffect(()=>{if(e)return e.setNotifyCallback(()=>i({})),()=>e.setNotifyCallback(null)},[e]),E.useEffect(()=>{const C=()=>{o(!0),d(null)},T=N=>{o(!1),c(N.enhancedPrompt),s("result"),ke.success("Prompt enhancement completed!")},A=N=>{o(!1),d(N.error),ke.error(`Enhancement failed: ${N.error}`)};return Ce.on(an.enhancementStarted,C),Ce.on(an.enhancementCompleted,T),Ce.on(an.enhancementFailed,A),()=>{Ce.off(an.enhancementStarted,C),Ce.off(an.enhancementCompleted,T),Ce.off(an.enhancementFailed,A)}},[]);const m=({fieldApi:C,label:T})=>f.jsxs("div",{className:"space-y-2",children:[f.jsx(Nt,{htmlFor:"model-selector",children:T}),f.jsx(xp,{models:e.globallyEnabledModels,value:C.state.value,onChange:C.handleChange,isLoading:e.isLoadingProviders,className:"w-full"}),C.state.meta.isTouched&&C.state.meta.errors.length>0&&f.jsx("div",{className:"text-xs text-destructive pt-1",children:C.state.meta.errors.map((A,N)=>f.jsx("p",{children:String(A)},N))})]}),{Form:y}=ug({schema:HHe,fields:[{name:"selectedModelId",type:"custom",label:"Select Enhancement Model",component:m},{name:"originalPrompt",type:"textarea",label:"Original Prompt",placeholder:"Enter the prompt you want to enhance...",description:"This will be enhanced using AI"},{name:"customSystemPrompt",type:"textarea",label:"Custom System Prompt (Optional)",placeholder:"Leave empty to use default prompt engineering instructions...",description:"Custom instructions for how to enhance the prompt"}],defaultComponents:{custom:m},submitLabel:a?"Enhancing...":"Enhance Prompt",formOptions:{defaultValues:{selectedModelId:"",originalPrompt:e.currentPromptText,customSystemPrompt:""},onSubmit:async({value:C})=>{var T;if(!C.selectedModelId){ke.error("Please select a model");return}if(!C.originalPrompt.trim()){ke.error("Please enter a prompt to enhance");return}Ce.emit(an.enhancePromptRequest,{prompt:C.originalPrompt.trim(),modelId:C.selectedModelId,systemPrompt:((T=C.customSystemPrompt)==null?void 0:T.trim())||void 0})}}}),b=()=>{Ce.emit(an.setInputTextRequest,{text:l}),n(!1),ke.success("Enhanced prompt applied!"),v()},v=()=>{s("setup"),o(!1),c(""),d(null)},x=C=>{if(C.stopPropagation(),h==="streaming"){ke.info("Cannot enhance prompt while another response is streaming");return}if(e.globallyEnabledModels.length===0){ke.info("No models available for prompt enhancement");return}n(!0)},w=h!=="streaming"&&e.globallyEnabledModels.length>0,_=()=>h==="streaming"?"Cannot enhance prompt while streaming":e.globallyEnabledModels.length===0?"No models available for enhancement":"Improve your prompt with AI assistance",k=[{value:"setup",label:"Setup",content:f.jsx("div",{className:"space-y-4",children:f.jsx(y,{})})},{value:"result",label:"Result",content:f.jsx("div",{className:"space-y-4",children:u?f.jsx("div",{className:"p-4 bg-destructive/10 border border-destructive/20 rounded-lg",children:f.jsxs("p",{className:"text-sm text-destructive",children:["Enhancement failed: ",u]})}):l?f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"space-y-2",children:[f.jsx(Nt,{children:"Enhanced Prompt"}),f.jsx("div",{className:"p-3 bg-primary/5 border border-primary/20 rounded-lg text-sm",children:l})]}),f.jsx(ot,{onClick:b,className:"w-full",children:"Use Enhanced Prompt"})]}):f.jsx("div",{className:"text-center text-muted-foreground py-8",children:a?"Enhancing your prompt...":"No enhancement result yet. Run the enhancement first."})})}];return f.jsxs(f.Fragment,{children:[f.jsx(Un,{tooltipText:_(),onClick:x,"aria-label":"Improve Prompt with AI",disabled:!w,icon:f.jsx(HH,{}),className:"h-5 w-5 md:h-6 md:w-6"}),f.jsx(td,{open:t,onOpenChange:n,children:f.jsxs(nd,{className:"!w-[80vw] !h-[85vh] !max-w-none flex flex-col p-4",children:[f.jsxs(rd,{children:[f.jsx(sd,{children:"Improve Prompt"}),f.jsx(wf,{children:"Use AI to enhance your prompt for better results. Select a model and optionally customize the enhancement instructions."})]}),f.jsx("div",{className:"flex-1 min-h-0",children:f.jsx(Tl,{tabs:k,initialValue:r,onValueChange:s,scrollable:!1})})]})})]})};class vie{static initialize(){Ce.on(an.enhancePromptRequest,async t=>{await this.handlePromptEnhancement(t)})}static async handlePromptEnhancement(t){try{const{prompt:n,modelId:r,systemPrompt:s}=t,i=nn.getState(),a=i.currentConversationId;if(!a){ke.error("No active conversation for prompt enhancement");return}const o=Nr();Ce.emit(an.enhancementStarted,{interactionId:o,originalPrompt:n});const l=i.interactions.filter(v=>v.conversationId===a&&v.status==="COMPLETED"&&v.type==="message.user_assistant"&&v.parentId===null).sort((v,x)=>v.index-x.index),c=Ox(l),d=s||`You are an expert prompt engineer. Your task is to improve and enhance the given user prompt to make it more effective, specific, and likely to produce better results from AI models.

Please analyze the user's prompt and enhance it by:
1. Making it more specific and detailed
2. Adding relevant context or constraints if helpful
3. Improving clarity and structure
4. Suggesting better formatting if needed
5. Maintaining the original intent and requirements

Return ONLY the enhanced prompt without any explanations, comments, or additional text.`,h={role:"user",content:[{type:"text",text:`Please enhance this prompt:

${n}`}]},m={system:d,messages:[...c,h],parameters:{temperature:.3,max_tokens:1e3},metadata:{modelId:r,isPromptEnhancement:!0}},y={id:o,content:`Enhance prompt: ${n}`,parameters:{temperature:.3,max_tokens:1e3},metadata:{modelId:r,isPromptEnhancement:!0,originalPrompt:n}};if(!await bl.startInteraction(m,a,y,"prompt.enhance"))throw new Error("Failed to create prompt enhancement interaction");ke.info("Enhancing your prompt...")}catch(n){const r=n instanceof Error?n.message:String(n);console.error("[PromptEnhancementService] Error during prompt enhancement:",n),Ce.emit(an.enhancementFailed,{interactionId:"unknown",error:r}),ke.error(`Prompt enhancement failed: ${r}`)}}static async handleEnhancementCompletion(t,n){try{Ce.emit(an.enhancementCompleted,{interactionId:t,enhancedPrompt:n}),ke.success("Prompt enhanced successfully!")}catch(r){console.error("[PromptEnhancementService] Error handling enhancement completion:",r)}}}const KHe=Object.freeze(Object.defineProperty({__proto__:null,PromptEnhancementService:vie},Symbol.toStringTag,{value:"Module"}));class YHe{constructor(){ce(this,"id","improve-prompt-control");ce(this,"eventUnsubscribers",[]);ce(this,"modApi",null);ce(this,"notifyComponentUpdate",null);ce(this,"globallyEnabledModels",[]);ce(this,"isLoadingProviders",!1);ce(this,"currentPromptText","")}async initialize(t){this.modApi=t,vie.initialize();const n=Gn.getState();this.isLoadingProviders=n.isLoading,this.globallyEnabledModels=n.getGloballyEnabledModelDefinitions();const r=t.on(Vn.globallyEnabledModelsUpdated,o=>{var u;let l=!1;JSON.stringify(this.globallyEnabledModels)!==JSON.stringify(o.models)&&(this.globallyEnabledModels=o.models,l=!0);const c=Gn.getState().isLoading;this.isLoadingProviders!==c&&(this.isLoadingProviders=c,l=!0),l&&((u=this.notifyComponentUpdate)==null||u.call(this))}),s=t.on(Vn.initialDataLoaded,()=>{var u;const o=Gn.getState();let l=!1;this.isLoadingProviders!==o.isLoading&&(this.isLoadingProviders=o.isLoading,l=!0);const c=o.getGloballyEnabledModelDefinitions();JSON.stringify(this.globallyEnabledModels)!==JSON.stringify(c)&&(this.globallyEnabledModels=c,l=!0),l&&((u=this.notifyComponentUpdate)==null||u.call(this))}),i=t.on(an.inputTextStateChanged,o=>{this.currentPromptText=o.value}),a=t.on(an.inputChanged,o=>{this.currentPromptText=o.value});this.eventUnsubscribers.push(r,s,i,a)}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.notifyComponentUpdate=null,this.modApi=null}setNotifyCallback(t){this.notifyComponentUpdate=t}getCurrentPromptText(){return this.currentPromptText}register(t){t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>Ve.createElement(GHe,{module:this})})}}function ZHe({templates:e,onSelect:t}){const[n,r]=E.useState(""),s=e.filter(a=>a.name.toLowerCase().includes(n.toLowerCase())||a.description.toLowerCase().includes(n.toLowerCase())||a.tags.some(o=>o.toLowerCase().includes(n.toLowerCase()))),i=()=>{Ce.emit(Tr.openModalRequest,{modalId:"settingsModal",initialTab:"assistant",initialSubTab:"prompts"})};return f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsxs("div",{className:"flex-grow",children:[f.jsx(Nt,{htmlFor:"search",children:"Search Templates"}),f.jsx(vn,{id:"search",placeholder:"Search by name, description, or tags...",value:n,onChange:a=>r(a.target.value)})]}),f.jsx("div",{className:"pt-6",children:f.jsxs(ot,{variant:"outline",size:"sm",onClick:i,className:"h-9 px-3",title:"Open Template Settings",children:[f.jsx(jh,{className:"h-4 w-4 mr-1"}),"Manage"]})})]}),f.jsx("div",{className:"grid gap-3",children:s.length===0?f.jsx("div",{className:"text-center py-8 text-muted-foreground",children:n?"No templates match your search.":"No templates available."}):s.map(a=>f.jsxs(ho,{className:"cursor-pointer hover:bg-muted/50 transition-colors",onClick:()=>t(a),children:[f.jsx(po,{className:"pb-3",children:f.jsxs("div",{className:"flex items-start justify-between",children:[f.jsxs("div",{children:[f.jsx(mo,{className:"text-sm",children:a.name}),f.jsx($c,{className:"text-xs",children:a.description})]}),a.isPublic&&f.jsx(as,{variant:"default",className:"text-xs",children:"Public"})]})}),f.jsx(go,{className:"pt-0",children:f.jsxs("div",{className:"flex flex-wrap gap-1",children:[a.tags.map(o=>f.jsx(as,{variant:"outline",className:"text-xs",children:o},o)),a.variables.length>0&&f.jsxs(as,{variant:"secondary",className:"text-xs",children:[a.variables.length," variables"]}),a.tools&&a.tools.length>0&&f.jsxs(as,{variant:"secondary",className:"text-xs",children:[a.tools.length," tools"]}),a.rules&&a.rules.length>0&&f.jsxs(as,{variant:"secondary",className:"text-xs",children:[a.rules.length," rules"]})]})})]},a.id))})]})}function XHe({template:e,onSubmit:t,onBack:n,previewElementRef:r,onCompile:s}){const i=e.variables.map(l=>({name:l.name,type:l.type==="boolean"?"switch":l.type==="number"?"number":l.type==="array"?"textarea":"text",label:l.name,placeholder:l.default!=null?String(l.default):`Enter ${l.name}`,description:l.description||l.instructions,required:l.required})),a=e.variables.reduce((l,c)=>(c.default!==void 0&&(l[c.name]=KT(c.default,c.type)),l),{}),{Form:o}=ug({fields:i,submitLabel:"Proompt !",formOptions:{defaultValues:a,onSubmit:async({value:l})=>{t(l)},onChange:async({value:l})=>{await s(l)}}});return f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx(ot,{variant:"outline",size:"sm",onClick:n,children:"← Back"}),f.jsxs("div",{children:[f.jsx("h3",{className:"font-medium",children:e.name}),f.jsx("p",{className:"text-sm text-muted-foreground",children:e.description})]})]}),f.jsxs("div",{className:"md:flex md:space-x-4",children:[f.jsx("div",{className:"md:w-1/2 border rounded-lg p-4",children:e.variables.length===0?f.jsxs("div",{className:"text-center",children:[f.jsx("p",{className:"text-muted-foreground",children:"This template has no variables defined. The template will be applied as-is."}),f.jsx(ot,{onClick:()=>t({}),className:"mt-3",children:"Proompt !"})]}):f.jsxs(f.Fragment,{children:[f.jsx(Nt,{className:"text-sm font-medium mb-4 block",children:"Template Variables"}),f.jsx(o,{})]})}),f.jsxs("div",{className:"md:w-1/2 border rounded-lg p-4",children:[f.jsx(Nt,{className:"text-sm font-medium",children:"Live Preview"}),f.jsx("div",{ref:r,className:"mt-2 p-3 bg-muted rounded text-sm font-mono whitespace-pre-wrap max-h-64 overflow-y-auto",children:e.prompt})]})]})]})}const JHe=({module:e})=>{const[t,n]=E.useState(!1),[r,s]=E.useState(null),i=E.useRef(null),{loadPromptTemplates:a,getTemplatesByType:o}=gl(mn(m=>({loadPromptTemplates:m.loadPromptTemplates,getTemplatesByType:m.getTemplatesByType}))),l=o("prompt");E.useEffect(()=>{t&&a()},[t,a]);const c=m=>{s(m),i.current&&(i.current.textContent=m.prompt)},u=async m=>{if(r)try{await e.applyTemplate(r.id,m),n(!1),s(null),ke.success("Template applied to input area!")}catch(y){console.error("Failed to Proompt :",y),ke.error("Failed to Proompt !")}},d=()=>{s(null)},h=async m=>{if(!(!r||!i.current))try{const y=await e.compileTemplate(r.id,m);i.current.textContent=y.content}catch(y){i.current.textContent=`Error: ${y instanceof Error?y.message:"Compilation failed"}`}};return f.jsxs(f.Fragment,{children:[f.jsx(ot,{variant:"ghost",size:"sm",onClick:()=>n(!0),className:"h-8 w-8 p-0",title:"Open Prompt Library",children:f.jsx(Kpe,{className:"h-4 w-4"})}),f.jsx(td,{open:t,onOpenChange:n,children:f.jsxs(nd,{className:"!w-[80vw] !h-[85vh] !max-w-none flex flex-col",children:[f.jsxs(rd,{children:[f.jsx(sd,{children:r?"Fill Template Variables":"Prompt Library"}),f.jsx(wf,{children:r?"Provide values for the template variables below.":"Select a prompt template to use. Templates can include dynamic variables, auto-select tools, and rules."})]}),f.jsx("div",{className:"flex-1 overflow-hidden",children:r?f.jsx(XHe,{template:r,onSubmit:u,onBack:d,module:e,previewElementRef:i,onCompile:h}):f.jsx(ZHe,{templates:l,onSelect:c})})]})})]})};class QHe{constructor(){ce(this,"id","core-prompt-library");ce(this,"unregisterCallback",null);ce(this,"eventUnsubscribers",[]);ce(this,"notifyComponentUpdate",null);ce(this,"isStreaming",!1);ce(this,"modApiRef",null);ce(this,"getIsStreaming",()=>this.isStreaming);ce(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t});ce(this,"compileTemplate",async(t,n)=>{const{compilePromptTemplate:r}=gl.getState();return await r(t,n)});ce(this,"applyTemplate",async(t,n)=>{var s;const r=await this.compileTemplate(t,n);(s=this.modApiRef)==null||s.emit(an.setInputTextRequest,{text:r.content})})}async initialize(t){this.modApiRef=t,this.isStreaming=nn.getState().status==="streaming";const n=t.on(xn.statusChanged,r=>{var s;typeof r=="object"&&r&&"status"in r&&this.isStreaming!==(r.status==="streaming")&&(this.isStreaming=r.status==="streaming",(s=this.notifyComponentUpdate)==null||s.call(this))});this.eventUnsubscribers.push(n)}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>Ve.createElement(JHe,{module:this})})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),console.log(`[${this.id}] Destroyed.`)}}const eGe=e=>{const{size:t=24,color:n="currentColor",...r}=e;return f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t,height:t,viewBox:"0 0 512 512",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",...r,children:f.jsxs("g",{transform:"translate(0.000000,512.000000) scale(0.100000,-0.100000)",fill:n,stroke:"none",children:[f.jsx("path",{d:`M2310 5053 c-1035 -101 -1883 -794 -2159 -1764 -55 -194 -79 -338
-91 -552 -18 -323 20 -620 117 -907 92 -272 238 -543 404 -747 33 -39 59 -75
59 -78 0 -4 -49 -129 -109 -279 -252 -624 -251 -621 -196 -676 57 -56 73 -53
351 58 137 55 349 143 472 195 l223 95 77 -38 c221 -109 437 -179 680 -219
132 -23 411 -44 475 -37 23 3 85 8 137 11 404 26 806 168 1180 417 282 188
571 489 759 792 400 642 467 1498 174 2216 -179 439 -495 826 -888 1088 -361
239 -743 378 -1165 422 -88 9 -419 11 -500 3z m404 -463 c-1 -30 -17 -128 -36
-217 l-34 -163 137 0 c128 0 139 -1 149 -20 11 -21 4 -44 -22 -72 -7 -7 -68
-75 -135 -150 l-123 -136 0 -175 0 -175 238 -4 c265 -5 329 -16 469 -82 220
-105 414 -311 486 -519 l24 -68 86 -4 c129 -7 195 -43 236 -130 20 -42 21 -61
21 -300 0 -240 -1 -258 -21 -297 -46 -90 -115 -127 -235 -128 l-82 0 -11 -47
c-17 -66 -71 -179 -119 -250 -108 -159 -276 -293 -452 -361 -174 -66 -251 -72
-830 -63 l-475 8 -89 27 c-303 91 -554 328 -650 614 l-23 67 -89 5 c-98 6
-131 20 -180 72 -63 66 -64 72 -64 354 0 240 1 261 21 301 40 84 105 119 232
129 l84 7 32 80 c84 215 291 424 513 519 126 53 225 68 466 68 l212 0 0 268 0
267 -126 -3 c-108 -3 -129 -1 -145 14 -10 9 -19 25 -19 35 0 9 111 146 246
304 234 273 247 286 277 283 32 -3 32 -3 31 -58z`}),f.jsx("path",{d:`M1854 2726 c-92 -40 -150 -139 -141 -239 21 -237 343 -298 446 -84
59 123 -10 287 -138 325 -51 16 -128 15 -167 -2z`}),f.jsx("path",{d:`M3053 2719 c-81 -40 -133 -121 -133 -205 0 -102 47 -180 134 -220 95
-44 193 -27 268 47 78 78 94 181 44 278 -21 38 -76 88 -118 105 -54 23 -144
20 -195 -5z`}),f.jsx("path",{d:`M2147 1999 c-26 -15 -48 -65 -41 -94 15 -61 181 -167 304 -196 30 -7
100 -12 155 -12 81 1 115 6 178 27 135 45 247 133 249 194 2 60 -48 103 -104
88 -13 -3 -50 -25 -83 -50 -85 -64 -172 -90 -280 -84 -92 6 -165 35 -259 103
-49 35 -86 43 -119 24z`})]})})};function tGe({agents:e,onUseAgent:t,onClearAgent:n,hasActiveAgent:r,currentAgentName:s,module:i}){const[a,o]=E.useState(""),l=e.filter(u=>u.name.toLowerCase().includes(a.toLowerCase())||u.description.toLowerCase().includes(a.toLowerCase())||u.tags.some(d=>d.toLowerCase().includes(a.toLowerCase()))),c=()=>{Ce.emit(Tr.openModalRequest,{modalId:"settingsModal",initialTab:"assistant",initialSubTab:"agents"})};return f.jsxs("div",{className:"space-y-4",children:[r&&f.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(Em,{className:"h-4 w-4 text-primary"}),f.jsxs("span",{className:"text-sm font-medium",children:["Active Agent: ",s]})]}),f.jsx(ot,{variant:"outline",size:"sm",onClick:n,children:"Clear Agent"})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsxs("div",{className:"flex-grow",children:[f.jsx(Nt,{htmlFor:"search",children:"Search Agents"}),f.jsx(vn,{id:"search",placeholder:"Search by name, description, or tags...",value:a,onChange:u=>o(u.target.value)})]}),f.jsx("div",{className:"pt-6",children:f.jsxs(ot,{variant:"outline",size:"sm",onClick:c,className:"h-9 px-3",title:"Open Agent Settings",children:[f.jsx(jh,{className:"h-4 w-4 mr-1"}),"Manage"]})})]}),f.jsx("div",{className:"grid gap-3",children:l.length===0?f.jsx("div",{className:"text-center py-8 text-muted-foreground",children:a?"No agents match your search.":"No agents available."}):l.map(u=>{const d=i.getTasksForAgent(u.id);return f.jsxs(ho,{className:"hover:bg-muted/50 transition-colors",children:[f.jsx(po,{className:"pb-3",children:f.jsxs("div",{className:"flex items-start justify-between",children:[f.jsxs("div",{children:[f.jsxs(mo,{className:"text-sm flex items-center gap-2",children:[f.jsx(Em,{className:"h-4 w-4"}),u.name]}),f.jsx($c,{className:"text-xs",children:u.description})]}),u.isPublic&&f.jsx(as,{variant:"default",className:"text-xs",children:"Public"})]})}),f.jsxs(go,{className:"pt-0 space-y-3",children:[f.jsxs("div",{className:"flex flex-wrap gap-1",children:[f.jsxs(as,{variant:"secondary",className:"text-xs",children:[d.length," tasks"]}),u.tags.map(h=>f.jsx(as,{variant:"outline",className:"text-xs",children:h},h)),u.variables.length>0&&f.jsxs(as,{variant:"secondary",className:"text-xs",children:[u.variables.length," variables"]}),u.tools&&u.tools.length>0&&f.jsxs(as,{variant:"secondary",className:"text-xs",children:[u.tools.length," tools"]}),u.rules&&u.rules.length>0&&f.jsxs(as,{variant:"secondary",className:"text-xs",children:[u.rules.length," rules"]})]}),f.jsx(ot,{size:"sm",onClick:()=>t(u),className:"w-full",children:"Use Agent"})]})]},u.id)})})]})}function nGe({agent:e,onChange:t,previewElementRef:n,onCompile:r}){const s=e.variables.map(o=>({name:o.name,type:o.type==="boolean"?"switch":o.type==="number"?"number":o.type==="array"?"textarea":"text",label:o.name,placeholder:o.default!=null?String(o.default):`Enter ${o.name}`,description:o.description||o.instructions,required:o.required})),i=e.variables.reduce((o,l)=>(l.default!==void 0&&(o[l.name]=KT(l.default,l.type)),o),{}),{Form:a}=ug({fields:s,submitLabel:"",formOptions:{defaultValues:i,onSubmit:async()=>{},onChange:async({value:o})=>{t(o),await r(o)}}});return E.useEffect(()=>{n.current&&(n.current.textContent=e.prompt)},[e.prompt,n]),f.jsxs("div",{className:"md:flex md:space-x-4",children:[f.jsx("div",{className:"md:w-1/2 border rounded-lg p-4",children:e.variables.length===0?f.jsx("div",{className:"text-center",children:f.jsx("p",{className:"text-muted-foreground",children:"This agent has no variables defined. The agent will be applied as-is."})}):f.jsxs(f.Fragment,{children:[f.jsx(Nt,{className:"text-sm font-medium mb-4 block",children:"Agent Configuration"}),f.jsx(a,{})]})}),f.jsxs("div",{className:"md:w-1/2 border rounded-lg p-4",children:[f.jsx(Nt,{className:"text-sm font-medium",children:"System Prompt Preview"}),f.jsx("div",{ref:n,className:"mt-2 p-3 bg-muted rounded text-sm font-mono whitespace-pre-wrap max-h-64 overflow-y-auto"})]})]})}function rGe({task:e,onChange:t,previewElementRef:n,onCompile:r}){const s=e.variables.map(o=>({name:o.name,type:o.type==="boolean"?"switch":o.type==="number"?"number":o.type==="array"?"textarea":"text",label:o.name,placeholder:o.default!=null?String(o.default):`Enter ${o.name}`,description:o.description||o.instructions,required:o.required})),i=e.variables.reduce((o,l)=>(l.default!==void 0&&(o[l.name]=KT(l.default,l.type)),o),{}),{Form:a}=ug({fields:s,submitLabel:"",formOptions:{defaultValues:i,onSubmit:async()=>{},onChange:async({value:o})=>{t(o),await r(o)}}});return E.useEffect(()=>{n.current&&(n.current.textContent=e.prompt)},[e.prompt,n]),f.jsxs("div",{className:"md:flex md:space-x-4",children:[f.jsx("div",{className:"md:w-1/2 border rounded-lg p-4",children:e.variables.length===0?f.jsx("div",{className:"text-center",children:f.jsx("p",{className:"text-muted-foreground",children:"This task has no variables defined. The task will be executed as-is."})}):f.jsxs(f.Fragment,{children:[f.jsx(Nt,{className:"text-sm font-medium mb-4 block",children:"Task Configuration"}),f.jsx(a,{})]})}),f.jsxs("div",{className:"md:w-1/2 border rounded-lg p-4",children:[f.jsx(Nt,{className:"text-sm font-medium",children:"Task Prompt Preview"}),f.jsx("div",{ref:n,className:"mt-2 p-3 bg-muted rounded text-sm font-mono whitespace-pre-wrap max-h-64 overflow-y-auto"})]})]})}function sGe({agent:e,tasks:t,onSubmit:n,onBack:r,previewElementRef:s,onCompile:i,autoClearEnabled:a,onAutoClearChange:o,module:l}){const[c,u]=E.useState(""),[d,h]=E.useState({}),[m,y]=E.useState({}),b=E.useRef(null),v=t.find(A=>A.id===c),x=A=>{h(A)},w=A=>{y(A)},_=A=>{u(A),y({})},k=()=>{v?n(d,v,m):n(d)},C=async A=>{if(s.current)try{await i(A)}catch(N){s.current&&(s.current.textContent=`Error: ${N instanceof Error?N.message:"Compilation failed"}`)}},T=async A=>{if(!(!v||!b.current))try{const N=await l.compileTaskTemplate(v.id,A);b.current.textContent=N.content}catch(N){b.current.textContent=`Error: ${N instanceof Error?N.message:"Compilation failed"}`}};return f.jsxs("div",{className:"flex flex-col h-full",children:[f.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[f.jsxs(ot,{variant:"ghost",size:"sm",onClick:r,children:[f.jsx(Lpe,{className:"h-4 w-4 mr-1"}),"Back to Agents"]}),f.jsx("div",{className:"flex-1"}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(Nt,{htmlFor:"auto-clear",className:"text-sm",children:"Auto-clear after use"}),f.jsx(fo,{id:"auto-clear",checked:a,onCheckedChange:o})]})]}),t.length>0&&f.jsxs(ho,{className:"mb-4",children:[f.jsxs(po,{children:[f.jsx(mo,{className:"text-lg",children:"Task Selection (Optional)"}),f.jsx($c,{children:"Choose a task to execute with this agent, or leave empty to use the agent alone."})]}),f.jsx(go,{children:f.jsxs("div",{children:[f.jsx(Nt,{htmlFor:"task-select",children:"Select Task"}),f.jsxs("div",{className:"flex gap-2",children:[f.jsxs(sc,{value:c,onValueChange:_,children:[f.jsx(ac,{className:"flex-1",children:f.jsx(ic,{placeholder:"Select a task (optional)"})}),f.jsx(oc,{children:t.map(A=>f.jsx(wi,{value:A.id,children:A.name},A.id))})]}),c&&f.jsx(ot,{variant:"outline",size:"sm",onClick:()=>u(""),children:"Clear"})]})]})})]}),f.jsxs("div",{className:"flex-1 overflow-auto space-y-4",children:[f.jsxs(ho,{children:[f.jsxs(po,{children:[f.jsx(mo,{className:"text-lg",children:"Agent Configuration"}),f.jsxs($c,{children:["Configure the system prompt and settings for ",e.name]})]}),f.jsx(go,{children:f.jsx(nGe,{agent:e,onChange:x,previewElementRef:s,onCompile:C})})]}),v&&f.jsxs(ho,{children:[f.jsxs(po,{children:[f.jsx(mo,{className:"text-lg",children:"Task Configuration"}),f.jsxs($c,{children:["Configure the task prompt for ",v.name]})]}),f.jsx(go,{children:f.jsx(rGe,{task:v,onChange:w,previewElementRef:b,onCompile:T})})]}),f.jsx("div",{className:"flex justify-end pt-4",children:f.jsxs(ot,{onClick:k,size:"lg",children:["Use Agent ",v?`with ${v.name}`:""]})})]})]})}const iGe=({module:e})=>{const[t,n]=E.useState(!1),[r,s]=E.useState(null),[i,a]=E.useState(!1),[o,l]=E.useState(0),c=E.useRef(null);E.useEffect(()=>{const C=()=>{l(T=>T+1)};return e.setNotifyCallback(C),()=>{e.setNotifyCallback(null)}},[e]),E.useEffect(()=>{t&&e.loadPromptTemplates()},[t,e]);const u=e.getAgents(),d=e.hasActiveAgent(),h=e.getCurrentAgentId(),m=h?u.find(C=>C.id===h):null;E.useEffect(()=>{},[o]);const y=C=>{s(C),a(!0)},b=async(C,T,A)=>{var N;if(r)try{T&&A?(await e.applyAgentWithTask(r.id,T.id,C,A),ke.success(`Agent "${r.name}" applied with task "${T.name}"!`)):(await e.applyAgent(r.id,C),ke.success(`Agent "${r.name}" applied!`)),e.getAutoClearEnabled()&&((N=e.clearOnSubmit)==null||N.call(e)),n(!1),s(null),a(!1)}catch(I){console.error("Failed to apply agent:",I),ke.error("Failed to apply agent!")}},v=()=>{s(null),a(!1)},x=()=>{var C;(C=e.clearOnSubmit)==null||C.call(e),ke.success("Agent cleared!")},w=async C=>{if(!(!r||!c.current))try{const T=await e.compileTemplate(r.id,C);c.current.textContent=T.content}catch(T){c.current.textContent=`Error: ${T instanceof Error?T.message:"Compilation failed"}`}},_=()=>i&&r?`Configure ${r.name}`:"Select Agent",k=()=>i&&r?"Configure the agent and optionally select a task to execute.":"Select an AI agent to work with. Each agent has specialized capabilities and tasks.";return f.jsxs(f.Fragment,{children:[f.jsx(ot,{variant:d?"secondary":"ghost",size:"sm",onClick:()=>n(!0),className:"h-8 w-8 p-0",title:d?`Active Agent: ${(m==null?void 0:m.name)||"Unknown"}`:"Select Agent",children:f.jsx(eGe,{className:"h-4 w-4"})}),f.jsx(td,{open:t,onOpenChange:n,children:f.jsxs(nd,{className:"!w-[80vw] !h-[85vh] !max-w-none flex flex-col",children:[f.jsxs(rd,{children:[f.jsx(sd,{children:_()}),f.jsx(wf,{children:k()})]}),f.jsx("div",{className:"flex-1 overflow-hidden",children:i&&r?f.jsx(sGe,{agent:r,tasks:e.getTasksForAgent(r.id),onSubmit:b,onBack:v,previewElementRef:c,onCompile:w,autoClearEnabled:e.getAutoClearEnabled(),onAutoClearChange:e.setAutoClearEnabled,module:e}):f.jsx(tGe,{agents:u,onUseAgent:y,onClearAgent:x,hasActiveAgent:d,currentAgentName:m==null?void 0:m.name,module:e})})]})})]})};class aGe{constructor(){ce(this,"id","agent-control");ce(this,"unregisterPromptControlCallback",null);ce(this,"unregisterCallback");ce(this,"eventUnsubscribers",[]);ce(this,"modApiRef",null);ce(this,"allTemplates",[]);ce(this,"isLoadingTemplates",!0);ce(this,"notifyComponentUpdate",null);ce(this,"currentAgentId",null);ce(this,"currentAgentSystemPrompt",null);ce(this,"autoClearEnabled",!1);ce(this,"getAllTemplates",()=>this.allTemplates);ce(this,"getAgents",()=>this.allTemplates.filter(t=>(t.type||"prompt")==="agent"));ce(this,"getTasksForAgent",t=>this.allTemplates.filter(n=>(n.type||"prompt")==="task"&&n.parentId===t));ce(this,"getIsLoadingTemplates",()=>this.isLoadingTemplates);ce(this,"compileTemplate",async(t,n)=>{const{compilePromptTemplate:r}=gl.getState();return await r(t,n)});ce(this,"compileTaskTemplate",async(t,n)=>{const{compilePromptTemplate:r}=gl.getState();return await r(t,n)});ce(this,"applyTemplate",async(t,n)=>{var s;const r=await this.compileTemplate(t,n);(s=this.modApiRef)==null||s.emit(an.setInputTextRequest,{text:r.content}),r.selectedTools&&r.selectedTools.length>0,r.selectedRules&&r.selectedRules.length>0});ce(this,"applyAgent",async(t,n)=>{var s;const r=await this.compileTemplate(t,n);this.currentAgentId=t,this.currentAgentSystemPrompt=r.content,(s=this.notifyComponentUpdate)==null||s.call(this),r.selectedTools&&r.selectedTools.length>0,r.selectedRules&&r.selectedRules.length>0});ce(this,"applyAgentWithTask",async(t,n,r,s)=>{var a;await this.applyAgent(t,r);const i=await this.compileTemplate(n,s);(a=this.modApiRef)==null||a.emit(an.setInputTextRequest,{text:i.content}),i.selectedTools&&i.selectedTools.length>0,i.selectedRules&&i.selectedRules.length>0});ce(this,"getCurrentAgentId",()=>this.currentAgentId);ce(this,"getCurrentAgentSystemPrompt",()=>this.currentAgentSystemPrompt);ce(this,"hasActiveAgent",()=>this.currentAgentId!==null);ce(this,"getAutoClearEnabled",()=>this.autoClearEnabled);ce(this,"setAutoClearEnabled",t=>{this.autoClearEnabled=t});ce(this,"clearOnSubmit",()=>{var t;this.currentAgentId=null,this.currentAgentSystemPrompt=null,(t=this.notifyComponentUpdate)==null||t.call(this)});ce(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t});ce(this,"loadPromptTemplates",()=>{var t;(t=this.modApiRef)==null||t.emit(Aa.loadPromptTemplatesRequest,{})})}async initialize(t){this.modApiRef=t,t.emit(Aa.loadPromptTemplatesRequest,{});const n=t.on(Aa.promptTemplatesChanged,a=>{var o;a!=null&&a.promptTemplates&&(this.allTemplates=a.promptTemplates,this.isLoadingTemplates=!1,(o=this.notifyComponentUpdate)==null||o.call(this))}),r=t.on(Aa.promptTemplateAdded,a=>{var o;a!=null&&a.promptTemplate&&(this.allTemplates=[...this.allTemplates,a.promptTemplate],(o=this.notifyComponentUpdate)==null||o.call(this))}),s=t.on(Aa.promptTemplateUpdated,a=>{var o;if(a!=null&&a.promptTemplate){const l=this.allTemplates.findIndex(c=>c.id===a.promptTemplate.id);l!==-1&&(this.allTemplates[l]=a.promptTemplate,(o=this.notifyComponentUpdate)==null||o.call(this))}}),i=t.on(Aa.promptTemplateDeleted,a=>{var o;a!=null&&a.id&&(this.allTemplates=this.allTemplates.filter(l=>l.id!==a.id),(o=this.notifyComponentUpdate)==null||o.call(this))});this.eventUnsubscribers.push(n,r,s,i)}register(t){this.modApiRef=t,this.unregisterPromptControlCallback||(this.unregisterPromptControlCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>Ve.createElement(iGe,{module:this}),getMetadata:()=>{if(this.currentAgentSystemPrompt)return{turnSystemPrompt:this.currentAgentSystemPrompt}},clearOnSubmit:()=>{var n;this.autoClearEnabled&&(this.currentAgentId=null,this.currentAgentSystemPrompt=null,(n=this.notifyComponentUpdate)==null||n.call(this))}}))}destroy(t){this.eventUnsubscribers.forEach(n=>n()),this.eventUnsubscribers=[],this.unregisterPromptControlCallback&&(this.unregisterPromptControlCallback(),this.unregisterPromptControlCallback=null),this.modApiRef=null,this.notifyComponentUpdate=null,this.unregisterCallback&&this.unregisterCallback()}}const oGe=({step:e,onChange:t,promptTemplates:n,agentTasks:r,models:s})=>{const i=e.type==="prompt"?n:e.type==="agent-task"?r:[],a=o=>{t({...e,templateId:o,prompt:void 0,structuredOutput:void 0})};return f.jsxs("div",{className:"p-4 border rounded-lg space-y-3 bg-muted/20",children:[f.jsxs("div",{className:"space-y-1",children:[f.jsx(Nt,{htmlFor:`step-name-${e.id}`,children:"Step Name"}),f.jsx(vn,{id:`step-name-${e.id}`,value:e.name,onChange:o=>t({...e,name:o.target.value})})]}),f.jsxs("div",{className:"space-y-1",children:[f.jsx(Nt,{children:"Model"}),f.jsx(xp,{value:e.modelId,onChange:o=>t({...e,modelId:o||void 0}),models:s,className:"w-full"})]}),f.jsxs("div",{className:"space-y-1",children:[f.jsx(Nt,{htmlFor:`step-type-${e.id}`,children:"Step Type"}),f.jsxs(sc,{value:e.type,onValueChange:o=>t({...e,type:o,templateId:void 0,prompt:void 0,structuredOutput:void 0}),children:[f.jsx(ac,{id:`step-type-${e.id}`,children:f.jsx(ic,{placeholder:"Select step type"})}),f.jsxs(oc,{children:[f.jsx(wi,{value:"prompt",children:"AI Prompt (from Template)"}),f.jsx(wi,{value:"agent-task",children:"Agent Task (from Template)"}),f.jsx(wi,{value:"human-in-the-loop",children:"Human in the Loop"})]})]})]}),(e.type==="prompt"||e.type==="agent-task")&&f.jsxs("div",{className:"space-y-1",children:[f.jsx(Nt,{htmlFor:`step-template-${e.id}`,children:"Template"}),f.jsxs(sc,{value:e.templateId||"",onValueChange:a,children:[f.jsx(ac,{id:`step-template-${e.id}`,children:f.jsx(ic,{placeholder:"Select a template"})}),f.jsx(oc,{children:i.map(o=>f.jsx(wi,{value:o.id,children:e.type==="agent-task"?o.prefixedName:o.name},o.id))})]})]}),e.type==="human-in-the-loop"&&f.jsxs("div",{className:"space-y-1",children:[f.jsx(Nt,{htmlFor:`step-instructions-${e.id}`,children:"Instructions for Human"}),f.jsx(vn,{id:`step-instructions-${e.id}`,value:e.instructionsForHuman||"",onChange:o=>t({...e,instructionsForHuman:o.target.value}),placeholder:"e.g., 'Review and approve the summary.'"})]})]})};var x6="Radio",[lGe,xie]=Ei(x6),[cGe,uGe]=lGe(x6),wie=E.forwardRef((e,t)=>{const{__scopeRadio:n,name:r,checked:s=!1,required:i,disabled:a,value:o="on",onCheck:l,form:c,...u}=e,[d,h]=E.useState(null),m=Tn(t,v=>h(v)),y=E.useRef(!1),b=d?c||!!d.closest("form"):!0;return f.jsxs(cGe,{scope:n,checked:s,disabled:a,children:[f.jsx(Kn.button,{type:"button",role:"radio","aria-checked":s,"data-state":kie(s),"data-disabled":a?"":void 0,disabled:a,value:o,...u,ref:m,onClick:Wt(e.onClick,v=>{s||l==null||l(),b&&(y.current=v.isPropagationStopped(),y.current||v.stopPropagation())})}),b&&f.jsx(Cie,{control:d,bubbles:!y.current,name:r,value:o,checked:s,required:i,disabled:a,form:c,style:{transform:"translateX(-100%)"}})]})});wie.displayName=x6;var Sie="RadioIndicator",_ie=E.forwardRef((e,t)=>{const{__scopeRadio:n,forceMount:r,...s}=e,i=uGe(Sie,n);return f.jsx(ea,{present:r||i.checked,children:f.jsx(Kn.span,{"data-state":kie(i.checked),"data-disabled":i.disabled?"":void 0,...s,ref:t})})});_ie.displayName=Sie;var dGe="RadioBubbleInput",Cie=E.forwardRef(({__scopeRadio:e,control:t,checked:n,bubbles:r=!0,...s},i)=>{const a=E.useRef(null),o=Tn(a,i),l=aS(n),c=Zm(t);return E.useEffect(()=>{const u=a.current;if(!u)return;const d=window.HTMLInputElement.prototype,m=Object.getOwnPropertyDescriptor(d,"checked").set;if(l!==n&&m){const y=new Event("click",{bubbles:r});m.call(u,n),u.dispatchEvent(y)}},[l,n,r]),f.jsx(Kn.input,{type:"radio","aria-hidden":!0,defaultChecked:n,...s,tabIndex:-1,ref:o,style:{...s.style,...c,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});Cie.displayName=dGe;function kie(e){return e?"checked":"unchecked"}var fGe=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],nA="RadioGroup",[hGe,Wft]=Ei(nA,[Eb,xie]),Eie=Eb(),Tie=xie(),[pGe,mGe]=hGe(nA),Aie=E.forwardRef((e,t)=>{const{__scopeRadioGroup:n,name:r,defaultValue:s,value:i,required:a=!1,disabled:o=!1,orientation:l,dir:c,loop:u=!0,onValueChange:d,...h}=e,m=Eie(n),y=cg(c),[b,v]=rc({prop:i,defaultProp:s??"",onChange:d,caller:nA});return f.jsx(pGe,{scope:n,name:r,required:a,disabled:o,value:b,onValueChange:v,children:f.jsx(a6,{asChild:!0,...m,orientation:l,dir:y,loop:u,children:f.jsx(Kn.div,{role:"radiogroup","aria-required":a,"aria-orientation":l,"data-disabled":o?"":void 0,dir:y,...h,ref:t})})})});Aie.displayName=nA;var Rie="RadioGroupItem",Nie=E.forwardRef((e,t)=>{const{__scopeRadioGroup:n,disabled:r,...s}=e,i=mGe(Rie,n),a=i.disabled||r,o=Eie(n),l=Tie(n),c=E.useRef(null),u=Tn(t,c),d=i.value===s.value,h=E.useRef(!1);return E.useEffect(()=>{const m=b=>{fGe.includes(b.key)&&(h.current=!0)},y=()=>h.current=!1;return document.addEventListener("keydown",m),document.addEventListener("keyup",y),()=>{document.removeEventListener("keydown",m),document.removeEventListener("keyup",y)}},[]),f.jsx(o6,{asChild:!0,...o,focusable:!a,active:d,children:f.jsx(wie,{disabled:a,required:i.required,checked:d,...l,...s,name:i.name,ref:u,onCheck:()=>i.onValueChange(s.value),onKeyDown:Wt(m=>{m.key==="Enter"&&m.preventDefault()}),onFocus:Wt(s.onFocus,()=>{var m;h.current&&((m=c.current)==null||m.click())})})})});Nie.displayName=Rie;var gGe="RadioGroupIndicator",Iie=E.forwardRef((e,t)=>{const{__scopeRadioGroup:n,...r}=e,s=Tie(n);return f.jsx(_ie,{...s,...r,ref:t})});Iie.displayName=gGe;var yGe=Aie,bGe=Nie,vGe=Iie;function xGe({className:e,...t}){return f.jsx(yGe,{"data-slot":"radio-group",className:Ye("grid gap-3",e),...t})}function Rj({className:e,...t}){return f.jsx(bGe,{"data-slot":"radio-group-item",className:Ye("border-input text-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 aspect-square size-4 shrink-0 rounded-full border shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",e),...t,children:f.jsx(vGe,{"data-slot":"radio-group-indicator",className:"relative flex items-center justify-center",children:f.jsx(FH,{className:"fill-primary absolute top-1/2 left-1/2 size-2 -translate-x-1/2 -translate-y-1/2"})})})}const wGe=({module:e})=>{const[t,n]=E.useState(!1),[r,s]=E.useState({id:"",name:"My New Workflow",description:"A workflow for processing things.",steps:[],createdAt:"",updatedAt:""}),[i,a]=E.useState("custom"),[o,l]=E.useState(""),[c,u]=E.useState(null),[,d]=E.useState(0),h=e.getPromptTemplates(),m=e.getAgentTasks(),y=e.getAllTemplates(),b=e.getModels(),v=nn(j=>j.status==="streaming");E.useEffect(()=>{const j=()=>d(L=>L+1);return e.setNotifyCallback(j),()=>{e.setNotifyCallback(null)}},[e]);const x=E.useMemo(()=>c?y.find(j=>j.id===c):null,[c,y]),w=E.useMemo(()=>x?x.variables.map(j=>({name:j.name,type:j.type||"text",label:j.name,placeholder:j.description,description:j.instructions,required:j.required})):[],[x]),{form:_,Form:k}=ug({fields:w,formOptions:{defaultValues:{}},showSubmitButton:!1,formClassName:"space-y-4 mt-4 border-t pt-4"}),C=async()=>{if(i==="custom"){if(!o){ke.error("Custom prompt cannot be empty.");return}e.startWorkflow(r,o),n(!1)}else if(x)try{const j=_.state.values,L=await t6(x,j);e.startWorkflow(r,L.content),n(!1)}catch(j){const L=j instanceof Error?j.message:"Invalid input";ke.error(`Trigger error: ${L}`)}},T=()=>{const j={id:`step_${Date.now()}_${r.steps.length}`,name:`Step ${r.steps.length+1}`,type:"prompt"};s(L=>({...L,steps:[...L.steps,j]}))},A=j=>{s(L=>({...L,steps:L.steps.map(D=>D.id===j.id?j:D)}))},N=i==="custom"&&!o||i!=="custom"&&!c||r.steps.length===0,I=i==="template"?h:m;return f.jsxs(f.Fragment,{children:[f.jsx(Un,{tooltipText:"Open Workflow Builder",onClick:()=>n(!0),"aria-label":"Open Workflow Builder",disabled:v,icon:f.jsx(Em,{}),className:"h-5 w-5 md:h-6 md:w-6"}),f.jsx(td,{open:t,onOpenChange:n,children:f.jsxs(nd,{className:"min-w-[85vw] min-h-[75vh] flex flex-col p-4",children:[f.jsxs(rd,{children:[f.jsx(sd,{children:"Workflow Builder"}),f.jsx(wf,{children:"Configure a trigger and a sequence of automated steps."})]}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 flex-grow overflow-hidden",children:[f.jsxs("div",{className:"flex flex-col gap-4",children:[f.jsxs("div",{className:"space-y-2",children:[f.jsx(Nt,{htmlFor:"wf-name",children:"Workflow Name"}),f.jsx(vn,{id:"wf-name",value:r.name,onChange:j=>s(L=>({...L,name:j.target.value}))})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx(Nt,{htmlFor:"wf-desc",children:"Description"}),f.jsx(Ci,{id:"wf-desc",value:r.description,onChange:j=>s(L=>({...L,description:j.target.value})),rows:3})]}),f.jsxs("div",{className:"border rounded-md p-3 flex-grow flex flex-col space-y-4",children:[f.jsx(Nt,{className:"font-semibold",children:"Trigger / Initial Message"}),f.jsxs(xGe,{value:i,onValueChange:j=>{a(j),u(null)},children:[f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(Rj,{value:"custom",id:"r-custom"}),f.jsx(Nt,{htmlFor:"r-custom",children:"Custom Prompt"})]}),f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(Rj,{value:"template",id:"r-template"}),f.jsx(Nt,{htmlFor:"r-template",children:"Prompt from Template"})]}),f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(Rj,{value:"task",id:"r-task"}),f.jsx(Nt,{htmlFor:"r-task",children:"Agent Task"})]})]}),i==="custom"&&f.jsx(Ci,{value:o,onChange:j=>l(j.target.value),placeholder:"Enter the first message to start the workflow...",className:"flex-grow"}),(i==="template"||i==="task")&&f.jsxs("div",{className:"space-y-2",children:[f.jsxs(sc,{value:c||"",onValueChange:u,children:[f.jsx(ac,{children:f.jsx(ic,{placeholder:`Select a ${i}...`})}),f.jsx(oc,{children:I.map(j=>f.jsx(wi,{value:j.id,children:i==="task"?j.prefixedName:j.name},j.id))})]}),x&&f.jsx(k,{})]})]})]}),f.jsxs("div",{className:"flex flex-col gap-4 overflow-hidden",children:[f.jsxs(Nt,{children:["Subsequent Steps (",r.steps.length,")"]}),f.jsx(Xo,{className:"border rounded-md p-3 flex-grow",children:f.jsxs("div",{className:"space-y-4",children:[r.steps.map(j=>f.jsx(oGe,{step:j,onChange:A,promptTemplates:h,agentTasks:m,models:b},j.id)),r.steps.length===0&&f.jsx("div",{className:"text-center text-muted-foreground py-8",children:"No subsequent steps. Add one to create a sequence."}),f.jsxs(ot,{size:"sm",onClick:T,className:"w-full mt-4",children:[f.jsx(nc,{className:"h-4 w-4 mr-2"})," Add Step"]})]})})]})]}),f.jsxs(dg,{children:[f.jsx(ot,{variant:"outline",onClick:()=>n(!1),children:"Cancel"}),f.jsx(ot,{onClick:C,type:"button",disabled:N,children:"Run Workflow"})]})]})})]})};class SGe{constructor(){ce(this,"id","core-workflow-control");ce(this,"modApi",null);ce(this,"eventUnsubscribers",[]);ce(this,"notifyComponentUpdate",null);ce(this,"globallyEnabledModels",[]);ce(this,"isLoadingProviders",!1);ce(this,"allTemplates",[])}async initialize(t){this.modApi=t;const n=Gn.getState();this.globallyEnabledModels=n.getGloballyEnabledModelDefinitions(),this.isLoadingProviders=n.isLoading,this.allTemplates=gl.getState().promptTemplates;const r=t.on(Vn.globallyEnabledModelsUpdated,a=>{var o;this.globallyEnabledModels=a.models,(o=this.notifyComponentUpdate)==null||o.call(this)}),s=t.on(Vn.initialDataLoaded,a=>{var o;a.globallyEnabledModels&&(this.globallyEnabledModels=a.globallyEnabledModels,this.isLoadingProviders=!1,(o=this.notifyComponentUpdate)==null||o.call(this))}),i=t.on(Aa.promptTemplatesChanged,a=>{var o;a!=null&&a.promptTemplates&&(this.allTemplates=a.promptTemplates,(o=this.notifyComponentUpdate)==null||o.call(this))});this.eventUnsubscribers.push(r,s,i),t.emit(Aa.loadPromptTemplatesRequest,{})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.notifyComponentUpdate=null,this.modApi=null}setNotifyCallback(t){this.notifyComponentUpdate=t}getPromptTemplates(){return this.allTemplates.filter(t=>(t.type||"prompt")==="prompt")}getAgentTasks(){const t=this.allTemplates.filter(r=>r.type==="agent"),n=new Map(t.map(r=>[r.id,r.name]));return this.allTemplates.filter(r=>r.type==="task"&&r.parentId).map(r=>({...r,prefixedName:`${n.get(r.parentId)||"Unknown Agent"}: ${r.name}`}))}getAllTemplates(){return this.allTemplates}getModels(){return this.globallyEnabledModels}getGlobalModel(){return Gn.getState().getSelectedModel()}startWorkflow(t,n){var s;const r=nn.getState().currentConversationId;if(!r){ke.error("Cannot start workflow: No active conversation selected."),console.error("[WorkflowControlModule] startWorkflow called without an active conversation.");return}(s=this.modApi)==null||s.emit(ws.startRequest,{template:t,initialPrompt:n,conversationId:r}),ke.success(`Workflow "${t.name}" started with ${t.steps.length} steps!`)}register(t){this.modApi=t,t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>Ve.createElement(wGe,{module:this})})}}const _Ge=({module:e})=>{const{activeRun:t,pausePayload:n}=H0(mn(d=>({activeRun:d.activeRun,pausePayload:d.pausePayload}))),[r,s]=E.useState("");if(!t||t.status!=="PAUSED"||!n)return null;const{step:i,pauseReason:a,rawAssistantResponse:o}=n,l=()=>{let d=r;if(a==="data-correction")try{d=JSON.parse(r)}catch{ke.error("Invalid JSON. Please correct the data before resuming.");return}e.resumeWorkflow(t.runId,d)},c=()=>{e.cancelWorkflow(t.runId)},u=o?(()=>{try{return JSON.stringify(JSON.parse(o),null,2)}catch{return o}})():"";return f.jsxs(ho,{className:"m-4",children:[f.jsxs(po,{className:"pb-2",children:[f.jsxs(mo,{className:"flex items-center gap-2 text-sm",children:[f.jsx(Sl,{className:"h-4 w-4 text-orange-500"}),"Workflow Paused"]}),f.jsxs($c,{className:"text-xs",children:['Step "',(i==null?void 0:i.name)||"Unknown",'" requires your input to continue.']})]}),f.jsxs(go,{className:"py-2",children:[a==="data-correction"&&f.jsxs("div",{className:"space-y-2",children:[f.jsx("p",{className:"text-xs text-muted-foreground",children:"Review and correct the data before continuing:"}),f.jsx(Ci,{value:r||u,onChange:d=>s(d.target.value),className:"text-xs font-mono",rows:6,placeholder:"Enter corrected data..."})]}),a==="human-in-the-loop"&&f.jsxs("div",{className:"space-y-2",children:[f.jsx("p",{className:"text-xs text-muted-foreground",children:"Provide input to continue the workflow:"}),f.jsx(Ci,{value:r,onChange:d=>s(d.target.value),className:"text-xs",rows:3,placeholder:"Enter your input..."})]})]}),f.jsxs(Mte,{className:"pt-2 gap-2",children:[f.jsxs(ot,{size:"sm",onClick:l,className:"flex-1",disabled:a==="human-in-the-loop"&&!r.trim(),children:[f.jsx(WH,{className:"h-3 w-3 mr-1"}),"Resume"]}),f.jsxs(ot,{size:"sm",variant:"outline",onClick:c,className:"flex-1",children:[f.jsx(Si,{className:"h-3 w-3 mr-1"}),"Cancel"]})]})]})};class CGe{constructor(){ce(this,"id","core-workflow-display");ce(this,"modApi",null);ce(this,"unregisterCallback",null);ce(this,"eventUnsubscribers",[])}async initialize(t){this.modApi=t;const n=t.on(ws.paused,()=>{}),r=t.on(ws.resumed,()=>{}),s=t.on(ws.completed,()=>{}),i=t.on(ws.error,()=>{});this.eventUnsubscribers.push(n,r,s,i)}resumeWorkflow(t,n){var r;(r=this.modApi)==null||r.emit(ws.resumeRequest,{runId:t,resumeData:n})}cancelWorkflow(t){var n;(n=this.modApi)==null||n.emit(ws.cancelRequest,{runId:t})}register(t){this.modApi=t,this.unregisterCallback=t.registerChatControl({id:this.id,panel:"sidebar-footer",renderer:()=>Ve.createElement(_Ge,{module:this})})}destroy(){var t;this.eventUnsubscribers.forEach(n=>n()),this.eventUnsubscribers=[],(t=this.unregisterCallback)==null||t.call(this),this.modApi=null}}const kGe=Ke({enableStreamingMarkdown:Qn(),enableStreamingCodeBlockParsing:Qn(),foldStreamingCodeBlocks:Qn(),foldUserMessagesOnCompletion:Qn(),enableAutoScrollOnStream:Qn(),streamingRenderFPS:Tt().min(3,"Min 3 FPS").max(60,"Max 60 FPS"),autoScrollInterval:Tt().min(50,"Min 50ms").max(5e3,"Max 5000ms")}),EGe=()=>{const e=pr(mn(s=>({setEnableStreamingMarkdown:s.setEnableStreamingMarkdown,setEnableStreamingCodeBlockParsing:s.setEnableStreamingCodeBlockParsing,setFoldStreamingCodeBlocks:s.setFoldStreamingCodeBlocks,setFoldUserMessagesOnCompletion:s.setFoldUserMessagesOnCompletion,setStreamingRenderFPS:s.setStreamingRenderFPS,setAutoScrollInterval:s.setAutoScrollInterval,setEnableAutoScrollOnStream:s.setEnableAutoScrollOnStream,resetGeneralSettings:s.resetGeneralSettings}))),t=pr(mn(s=>({enableStreamingMarkdown:s.enableStreamingMarkdown,enableStreamingCodeBlockParsing:s.enableStreamingCodeBlockParsing,foldStreamingCodeBlocks:s.foldStreamingCodeBlocks,foldUserMessagesOnCompletion:s.foldUserMessagesOnCompletion,streamingRenderFPS:s.streamingRenderFPS,autoScrollInterval:s.autoScrollInterval,enableAutoScrollOnStream:s.enableAutoScrollOnStream}))),n=ai({defaultValues:{enableStreamingMarkdown:t.enableStreamingMarkdown??!0,enableStreamingCodeBlockParsing:t.enableStreamingCodeBlockParsing??!0,foldStreamingCodeBlocks:t.foldStreamingCodeBlocks??!1,foldUserMessagesOnCompletion:t.foldUserMessagesOnCompletion??!1,enableAutoScrollOnStream:t.enableAutoScrollOnStream??!0,streamingRenderFPS:t.streamingRenderFPS??15,autoScrollInterval:t.autoScrollInterval??1e3},validators:{onChangeAsync:kGe,onChangeAsyncDebounceMs:500},onSubmit:async({value:s})=>{e.setEnableStreamingMarkdown(s.enableStreamingMarkdown),e.setEnableStreamingCodeBlockParsing(s.enableStreamingCodeBlockParsing),e.setFoldStreamingCodeBlocks(s.foldStreamingCodeBlocks),e.setFoldUserMessagesOnCompletion(s.foldUserMessagesOnCompletion),e.setEnableAutoScrollOnStream(s.enableAutoScrollOnStream),e.setStreamingRenderFPS(s.streamingRenderFPS),e.setAutoScrollInterval(s.autoScrollInterval)}});E.useEffect(()=>{n.reset({enableStreamingMarkdown:t.enableStreamingMarkdown??!0,enableStreamingCodeBlockParsing:t.enableStreamingCodeBlockParsing??!0,foldStreamingCodeBlocks:t.foldStreamingCodeBlocks??!1,foldUserMessagesOnCompletion:t.foldUserMessagesOnCompletion??!1,enableAutoScrollOnStream:t.enableAutoScrollOnStream??!0,streamingRenderFPS:t.streamingRenderFPS??15,autoScrollInterval:t.autoScrollInterval??1e3})},[t.enableStreamingMarkdown,t.enableStreamingCodeBlockParsing,t.foldStreamingCodeBlocks,t.foldUserMessagesOnCompletion,t.enableAutoScrollOnStream,t.streamingRenderFPS,t.autoScrollInterval,n]);const r=()=>{window.confirm("Are you sure you want to reset Streaming & Display settings to their defaults?")&&e.resetGeneralSettings()};return f.jsxs("form",{onSubmit:s=>{s.preventDefault(),s.stopPropagation(),n.handleSubmit()},className:"p-1 space-y-4",children:[f.jsxs("div",{className:"space-y-3",children:[f.jsx("h3",{className:"text-lg font-medium",children:"Streaming & Display"}),f.jsx(lm,{form:n,name:"enableStreamingMarkdown",label:"Parse Markdown While Streaming",description:"Render Markdown formatting as the response arrives (may impact performance slightly)."}),f.jsx(lm,{form:n,name:"enableStreamingCodeBlockParsing",label:"Use Full Code Blocks While Streaming",description:"Use the syntax-highlighting component for code blocks during streaming."}),f.jsx(lm,{form:n,name:"foldStreamingCodeBlocks",label:"Fold Code Blocks by Default During Streaming",description:"Automatically collapse code blocks as they stream in. Useful for long code outputs."}),f.jsx(lm,{form:n,name:"foldUserMessagesOnCompletion",label:"Fold User Messages After Response",description:"Automatically collapse the user's prompt message once the assistant finishes responding."}),f.jsx(lm,{form:n,name:"enableAutoScrollOnStream",label:"Auto-Scroll While Streaming",description:"Automatically scroll to the bottom as new content arrives."}),f.jsxs("div",{className:"rounded-lg border p-3 shadow-sm space-y-2",children:[f.jsx(Oc,{form:n,name:"streamingRenderFPS",label:"Streaming Update Rate",min:3,max:60,step:1,valueLabelSuffix:" FPS"}),f.jsx(Ly,{form:n,name:"streamingRenderFPS",label:"FPS Input",min:3,max:60,step:1,className:"w-24 h-8 text-xs ml-auto","aria-label":"Streaming Render FPS Value"}),f.jsx("p",{className:Ye("text-sm text-muted-foreground"),children:"Controls how frequently the UI updates during streaming (3-60 FPS)."})]}),f.jsxs("div",{className:"rounded-lg border p-3 shadow-sm space-y-2",children:[f.jsx(Oc,{form:n,name:"autoScrollInterval",label:"Auto-Scroll Interval",min:50,max:5e3,step:50,valueLabelSuffix:" ms",disabled:!n.state.values.enableAutoScrollOnStream}),f.jsx(Ly,{form:n,name:"autoScrollInterval",label:"Interval Input (ms)",min:50,max:5e3,step:50,className:"w-24 h-8 text-xs ml-auto",disabled:!n.state.values.enableAutoScrollOnStream,"aria-label":"Auto Scroll Interval Value"}),f.jsx("p",{className:Ye("text-sm text-muted-foreground"),children:"How often to scroll to the bottom during streaming (50-5000 ms)."})]})]}),f.jsx(zm,{}),f.jsx("div",{className:"flex items-center justify-between pt-3",children:f.jsx(n.Subscribe,{children:s=>{const i=s.canSubmit,a=s.isSubmitting,o=s.isValidating,l=s.isValid;return f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(ot,{type:"submit",size:"sm",disabled:!i||a||o||!l,children:a?"Saving...":o?"Validating...":"Save Changes"}),f.jsxs(ot,{variant:"outline",size:"sm",onClick:r,type:"button",children:[f.jsx(E1,{className:"mr-2 h-4 w-4"}),"Reset General Settings"]})]})}})})]})},TGe=Ve.memo(EGe);class AGe{constructor(){ce(this,"id","core-settings-general");ce(this,"unregisterCallback",null)}async initialize(t){}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerSettingsTab({id:"general",title:"General",component:TGe,order:10})}destroy(){this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),console.log(`[${this.id}] Destroyed.`)}}const RGe=({label:e,colorKey:t,value:n,onChange:r})=>{const[s,i]=E.useState(n??"");E.useEffect(()=>{i(n??"")},[n]);const a=()=>{r(t,s.trim()||null)},o=l=>{i(l.target.value)};return f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(Nt,{htmlFor:`color-${t}`,className:"text-xs w-28 shrink-0",children:e}),f.jsx(vn,{id:`color-${t}`,type:"text",value:s,onChange:o,onBlur:a,className:"h-8 text-xs flex-grow",placeholder:"e.g., #ffffff or oklch(0.5 0.2 180)"}),f.jsx(vn,{type:"color",value:s!=null&&s.startsWith("#")?s:"#000000",onChange:l=>{i(l.target.value),r(t,l.target.value)},className:"h-8 w-10 p-1 border-none cursor-pointer bg-transparent","aria-label":`Pick ${e} color`})]})},NGe=[{label:"Default Light",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-material-light.min.css"},{label:"A11y Dark",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-a11y-dark.min.css"},{label:"Atom Dark",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-atom-dark.min.css"},{label:"Atelier Sulphurpool Light",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-base16-ateliersulphurpool.light.min.css"},{label:"CB",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-cb.min.css"},{label:"Coldark Cold",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-coldark-cold.min.css"},{label:"Coldark Dark",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-coldark-dark.min.css"},{label:"Coy (No Shadow)",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-coy-without-shadows.min.css"},{label:"Darcula",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-darcula.min.css"},{label:"Dracula",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-dracula.min.css"},{label:"Duotone Dark",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-duotone-dark.min.css"},{label:"Duotone Earth",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-duotone-earth.min.css"},{label:"Duotone Forest",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-duotone-forest.min.css"},{label:"Duotone Light",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-duotone-light.min.css"},{label:"Duotone Sea",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-duotone-sea.min.css"},{label:"Duotone Space",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-duotone-space.min.css"},{label:"GH Colors",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-ghcolors.min.css"},{label:"Gruvbox Dark",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-gruvbox-dark.min.css"},{label:"Gruvbox Light",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-gruvbox-light.min.css"},{label:"Holi",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-holi-theme.min.css"},{label:"Hopscotch",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-hopscotch.min.css"},{label:"Lucario",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-lucario.min.css"},{label:"Material Dark",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-material-dark.min.css"},{label:"Material Oceanic",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-material-oceanic.min.css"},{label:"Night Owl",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-night-owl.min.css"},{label:"Nord",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-nord.min.css"},{label:"One Dark",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-one-dark.min.css"},{label:"One Light",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-one-light.min.css"},{label:"Pojoaque",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-pojoaque.min.css"},{label:"Shades of Purple",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-shades-of-purple.min.css"},{label:"Solarized Dark Atom",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-solarized-dark-atom.min.css"},{label:"Synthwave '84",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-synthwave84.min.css"},{label:"VS",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-vs.min.css"},{label:"VSC Dark Plus",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-vsc-dark-plus.min.css"},{label:"Xonokai",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-xonokai.min.css"},{label:"Z-Touch",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-z-touch.min.css"}],IGe=El(["system","light","dark","TijuLight","TijuDark","custom"]),MGe=Ke({theme:IGe,prismThemeUrl:$e(),customFontFamily:$e(),customFontSize:Tt().min(12).max(20),chatMaxWidth:$e(),customThemeColors:Dh($e(),$e().nullable())}),jGe=()=>{const e=pr(mn(a=>({setTheme:a.setTheme,setPrismThemeUrl:a.setPrismThemeUrl,setCustomFontFamily:a.setCustomFontFamily,setCustomFontSize:a.setCustomFontSize,setChatMaxWidth:a.setChatMaxWidth,setCustomThemeColor:a.setCustomThemeColor,resetThemeSettings:a.resetThemeSettings}))),t=pr(mn(a=>({theme:a.theme,prismThemeUrl:a.prismThemeUrl,customFontFamily:a.customFontFamily,customFontSize:a.customFontSize,chatMaxWidth:a.chatMaxWidth,_rawCustomThemeColors:a.customThemeColors}))),n=ai({defaultValues:{theme:t.theme??"system",prismThemeUrl:t.prismThemeUrl??"",customFontFamily:t.customFontFamily??"",customFontSize:t.customFontSize??16,chatMaxWidth:t.chatMaxWidth??"max-w-7xl",customThemeColors:t._rawCustomThemeColors??{}},onSubmit:async({value:a})=>{e.setTheme(a.theme),e.setPrismThemeUrl(a.prismThemeUrl||null),e.setCustomFontFamily(a.customFontFamily),e.setCustomFontSize(a.customFontSize),e.setChatMaxWidth(a.chatMaxWidth),a.customThemeColors&&Object.entries(a.customThemeColors).forEach(([o,l])=>{e.setCustomThemeColor(o,l)})},validators:{onChangeAsync:MGe,onChangeAsyncDebounceMs:300}});E.useEffect(()=>{n.reset({theme:t.theme??"system",prismThemeUrl:t.prismThemeUrl??"",customFontFamily:t.customFontFamily??"",customFontSize:t.customFontSize??16,chatMaxWidth:t.chatMaxWidth??"max-w-7xl",customThemeColors:t._rawCustomThemeColors??{}})},[t.theme,t.prismThemeUrl,t.customFontFamily,t.customFontSize,t.chatMaxWidth,t._rawCustomThemeColors]);const r=()=>{window.confirm("Are you sure you want to reset all Theme settings to their defaults?")&&e.resetThemeSettings()},s=[{value:"max-w-3xl",label:"Very Small"},{value:"max-w-4xl",label:"Small"},{value:"max-w-5xl",label:"Medium"},{value:"max-w-6xl",label:"Large"},{value:"max-w-7xl",label:"Very Large"},{value:"max-w-full",label:"Full Width"}],i=[{key:"background",label:"Background"},{key:"foreground",label:"Foreground"},{key:"card",label:"Card BG"},{key:"cardForeground",label:"Card FG"},{key:"popover",label:"Popover BG"},{key:"popoverForeground",label:"Popover FG"},{key:"primary",label:"Primary"},{key:"primaryForeground",label:"Primary FG"},{key:"secondary",label:"Secondary"},{key:"secondaryForeground",label:"Secondary FG"},{key:"muted",label:"Muted BG"},{key:"mutedForeground",label:"Muted FG"},{key:"accent",label:"Accent"},{key:"accentForeground",label:"Accent FG"},{key:"destructive",label:"Destructive"},{key:"destructiveForeground",label:"Destructive FG"},{key:"border",label:"Border"},{key:"input",label:"Input BG"},{key:"ring",label:"Ring (Focus)"},{key:"sidebar",label:"Sidebar BG"},{key:"sidebarForeground",label:"Sidebar FG"},{key:"sidebarPrimary",label:"Sidebar Primary"},{key:"sidebarPrimaryForeground",label:"Sidebar Primary FG"},{key:"sidebarAccent",label:"Sidebar Accent"},{key:"sidebarAccentForeground",label:"Sidebar Accent FG"},{key:"sidebarBorder",label:"Sidebar Border"},{key:"sidebarRing",label:"Sidebar Ring"},{key:"chart1",label:"Chart 1"},{key:"chart2",label:"Chart 2"},{key:"chart3",label:"Chart 3"},{key:"chart4",label:"Chart 4"},{key:"chart5",label:"Chart 5"}];return f.jsxs("form",{onSubmit:a=>{a.preventDefault(),a.stopPropagation(),n.handleSubmit()},className:"space-y-4 p-1",children:[f.jsx(Ex,{title:"Base Theme",description:"Select the overall look and feel.",contentClassName:"rounded-lg border p-3 shadow-sm bg-card",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx(Nt,{htmlFor:"theme-select",className:"font-medium",children:"Theme"}),f.jsx(Wx,{form:n,name:"theme",label:"Theme",options:[{value:"light",label:"Default Light"},{value:"dark",label:"Default Dark"},{value:"system",label:"System"},{value:"TijuLight",label:"Tiju Light"},{value:"TijuDark",label:"Tiju Dark"},{value:"custom",label:"User Custom"}],triggerClassName:"w-[180px]"})]})}),f.jsxs(Ex,{title:"Font & Layout",description:"Customize typography and content width.",contentClassName:"rounded-lg border p-3 shadow-sm bg-card space-y-3",children:[f.jsxs("div",{children:[f.jsx(r1,{form:n,name:"customFontFamily",label:"Custom Font Family",placeholder:"e.g., 'Inter', sans-serif (Leave blank for default)",className:"mt-1"}),f.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Applies only when 'User Custom' theme is selected. Ensure the font is available (system or web font)."})]}),f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(Oc,{form:n,name:"customFontSize",label:`Base Font Size (${n.getFieldValue("customFontSize")}px)`,min:12,max:20,step:1,className:"mt-1"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Applies only when 'User Custom' theme is selected. Affects base text size (Default: 16px)."})]}),f.jsxs("div",{children:[f.jsx(Wx,{form:n,name:"chatMaxWidth",label:"Chat Content Max Width",options:s,triggerClassName:"w-full mt-1"}),f.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Controls the maximum width of the main chat message area."})]})]}),f.jsxs(Ex,{title:"Code Block Theme",description:"Customize syntax highlighting appearance.",contentClassName:"rounded-lg border p-3 shadow-sm bg-card space-y-3",children:[f.jsx(Wx,{form:n,name:"prismThemeUrl",label:"Code Block Theme",options:NGe,triggerClassName:"w-full"}),f.jsx(r1,{form:n,name:"prismThemeUrl",label:"Or paste custom theme URL here...",placeholder:"Or paste custom theme URL here...",type:"url",className:"mt-1"}),f.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Select a preset theme or paste a URL to a PrismJS CSS file. Leave blank or select 'Default' to use themes matching light/dark mode."})]}),n.getFieldValue("theme")==="custom"&&f.jsx(Ex,{title:"Custom Theme Colors",description:"Define custom colors. Use valid CSS color values (hex, rgb, oklch, etc.). Leave blank to use default light/dark theme colors.",contentClassName:"rounded-lg border p-3 shadow-sm bg-card",children:f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-4 gap-y-2",children:i.map(({key:a,label:o})=>{var l;return f.jsx(RGe,{label:o,colorKey:a,value:(l=n.getFieldValue("customThemeColors"))==null?void 0:l[a],onChange:(c,u)=>n.setFieldValue(`customThemeColors.${c}`,u===null?"":u)},a)})})}),f.jsx(zm,{}),f.jsxs("div",{className:"flex justify-between pt-3",children:[f.jsxs(ot,{variant:"outline",size:"sm",onClick:r,type:"button",children:[f.jsx(E1,{className:"mr-2 h-4 w-4"}),"Reset Theme Settings"]}),f.jsx(ot,{type:"submit",size:"sm",className:"bg-primary text-primary-foreground hover:bg-primary/90",children:"Apply Theme Settings"})]})]})},PGe=Ve.memo(jGe);class OGe{constructor(){ce(this,"id","core-settings-theme");ce(this,"unregisterCallback",null)}async initialize(t){}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerSettingsTab({id:"theme",title:"Theme",component:PGe,order:20})}destroy(){this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),console.log(`[${this.id}] Destroyed.`)}}const DGe=({provider:e,apiKeys:t,onEdit:n,onDelete:r,onFetchModels:s,onUpdate:i,fetchStatus:a,isDeleting:o,allAvailableModelsForView:l})=>{var N,I;const[c,u]=E.useState(!0),d=my(e.type),h=K2(e.type),m=wm(e.type),y=a==="fetching"||o,b=o||a==="fetching",v=o||a==="fetching",x=E.useMemo(()=>new Set(e.enabledModels??[]),[e.enabledModels]),w=e.apiKeyId?t.some(j=>j.id===e.apiKeyId):!1,_=d&&!w,k=E.useCallback(async(j,L)=>{const D=new Set(e.enabledModels??[]);L?D.add(j):D.delete(j);const H=Array.from(D);try{await i(e.id,{enabledModels:H})}catch(O){ke.error("Failed to update model status."),console.error("Failed to save model toggle:",O)}},[e.enabledModels,e.id,i]),C=()=>u(j=>!j),T=((N=e.enabledModels)==null?void 0:N.length)??0,A=l.length;return f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center space-x-3 min-w-0",children:[f.jsx(wr,{delayDuration:100,children:f.jsxs(Sr,{children:[f.jsx(_r,{children:f.jsx("span",{className:Ye("h-2.5 w-2.5 rounded-full flex-shrink-0 block",a==="error"?"bg-destructive animate-pulse":e.isEnabled?"bg-green-500":"bg-muted-foreground")})}),f.jsx(Cr,{side:"top",children:a==="error"?"Error fetching models":e.isEnabled?"Enabled":"Disabled"})]})}),f.jsx("h3",{className:"font-semibold text-lg text-card-foreground truncate",children:e.name}),f.jsxs("span",{className:"text-sm text-muted-foreground flex-shrink-0",children:["(",e.type,")"]}),_&&f.jsx(wr,{delayDuration:100,children:f.jsxs(Sr,{children:[f.jsx(_r,{children:f.jsx(Sl,{className:"h-4 w-4 text-amber-500 flex-shrink-0"})}),f.jsx(Cr,{side:"top",children:f.jsx("p",{children:"API Key required but none linked/found."})})]})})]}),f.jsxs("div",{className:"flex items-center space-x-1 flex-shrink-0",children:[f.jsx(Un,{tooltipText:"Edit",onClick:n,disabled:b,"aria-label":"Edit provider",icon:f.jsx(k1,{}),className:"h-8 w-8"}),f.jsx(Un,{tooltipText:"Delete",onClick:r,disabled:v,className:"text-destructive hover:text-destructive/80 h-8 w-8","aria-label":"Delete provider",icon:o?f.jsx(Hn,{className:"h-4 w-4 animate-spin"}):f.jsx(Vo,{})})]})]}),f.jsxs("div",{className:"text-sm text-muted-foreground mt-1 space-y-1 pl-5",children:[d&&f.jsxs("div",{children:["API Key:"," ",e.apiKeyId?w?f.jsx("span",{className:"text-green-400",children:((I=t.find(j=>j.id===e.apiKeyId))==null?void 0:I.name)||"Linked (Unnamed Key)"}):f.jsx("span",{className:"text-destructive",children:"Linked Key Missing!"}):f.jsx("span",{className:"text-amber-400",children:"Not Linked"})]}),h&&f.jsxs("div",{children:["Base URL: ",e.baseURL||"Not Set"]}),f.jsxs("div",{children:["Auto-fetch Models:"," ",e.autoFetchModels?f.jsx("span",{className:"text-green-400",children:"Enabled"}):f.jsx("span",{className:"text-muted-foreground/80",children:"Disabled"}),e.fetchedModels&&f.jsxs("span",{className:"text-xs text-muted-foreground/80 ml-2",children:["(Last fetched:"," ",e.modelsLastFetchedAt?new Date(e.modelsLastFetchedAt).toLocaleString():"Never",")"]})]}),m&&f.jsx("div",{className:"pt-1",children:f.jsxs(ot,{variant:"outline",size:"sm",onClick:s,disabled:y,className:"text-xs h-7 px-2",children:[a==="fetching"&&f.jsx(Hn,{className:"h-3 w-3 mr-1 animate-spin"}),a==="success"&&f.jsx(bo,{className:"h-3 w-3 mr-1 text-green-500"}),a==="error"&&f.jsx(Sl,{className:"h-3 w-3 mr-1 text-destructive"}),a==="idle"&&f.jsx(Tm,{className:"h-3 w-3 mr-1"}),a==="fetching"?"Fetching...":a==="error"?"Fetch Failed":"Fetch Models Now"]})})]}),f.jsxs("div",{className:"space-y-1 pt-2",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("span",{className:"font-medium text-card-foreground text-sm",children:["Model Enablement (",T," / ",A," enabled)"]}),f.jsx(Un,{tooltipText:c?"Show Models":"Hide Models",onClick:C,"aria-label":c?"Show model list":"Hide model list",icon:c?f.jsx(uc,{}):f.jsx(tp,{}),className:"h-6 w-6"})]}),!c&&f.jsx(e6,{providerId:e.id,allAvailableModels:l,enabledModelIds:x,onToggleModel:k,isLoading:a==="fetching",disabled:o,listHeightClass:"h-[26rem]"})]})]})},FGe=Ve.memo(DGe),LGe=({providerId:e,editData:t,apiKeys:n,allAvailableModels:r,isSaving:s,onCancel:i,onSave:a,onChange:o})=>{const l=E.useMemo(()=>new Set(t.enabledModels??[]),[t.enabledModels]),c=E.useCallback((d,h)=>{const m=new Set(t.enabledModels??[]);h?m.add(d):m.delete(d);const y=Array.from(m);o("enabledModels",y)},[t.enabledModels,o]),u=E.useCallback((d,h)=>new Promise(m=>{o(d,h),m(void 0)}),[o]);return f.jsx("div",{className:"space-y-4",children:f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[f.jsxs("div",{className:"space-y-3",children:[f.jsx("h4",{className:"text-md font-semibold text-card-foreground mb-2",children:"Basic Configuration"}),f.jsx(ure,{initialData:t,onChange:u,onSubmit:a,onCancel:i,apiKeys:n,disabled:s})]}),f.jsxs("div",{className:"space-y-3",children:[f.jsx("h4",{className:"text-md font-semibold text-card-foreground",children:"Model Enablement"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Toggle models on/off for global use. Changes will be saved with the form."}),f.jsx(e6,{providerId:e,allAvailableModels:r,enabledModelIds:l,onToggleModel:c,disabled:s,listHeightClass:"h-[calc(100%-8rem)]"})]})]})})},BGe=Ve.memo(LGe),$Ge=({provider:e,apiKeys:t,onUpdate:n,onDelete:r,onFetchModels:s,fetchStatus:i,onSelectModelForDetails:a})=>{const[o,l]=E.useState(!1),[c,u]=E.useState(!1),[d,h]=E.useState(!1),[m,y]=E.useState({name:"placeholder"}),b=Gn(I=>I.getAllAvailableModelDefsForProvider),[v,x]=E.useState([]),w=E.useMemo(()=>[...b(e.id)].sort((j,L)=>(j.name||j.id).localeCompare(L.name||L.id)),[e.id,b]);E.useEffect(()=>{if(o){const I=b(e.id);x([...I].sort((j,L)=>(j.name||j.id).localeCompare(L.name||L.id))),y({name:e.name,type:e.type,isEnabled:e.isEnabled,apiKeyId:e.apiKeyId,baseURL:e.baseURL,enabledModels:e.enabledModels??[],autoFetchModels:e.autoFetchModels})}else x([])},[o,e.id,e.name,e.type,e.isEnabled,e.apiKeyId,e.baseURL,e.enabledModels,e.autoFetchModels,b]);const _=()=>l(!0),k=()=>{l(!1),y({}),u(!1)},C=E.useCallback(async()=>{u(!0);try{const I=m.enabledModels&&m.enabledModels.length>0?m.enabledModels:null,j={name:m.name,type:m.type,isEnabled:m.isEnabled,apiKeyId:m.apiKeyId,baseURL:m.baseURL,autoFetchModels:m.autoFetchModels,enabledModels:I};Object.keys(j).forEach(L=>{j[L]===void 0&&delete j[L]}),await n(e.id,j),l(!1),y({}),ke.success(`Provider "${j.name||e.name}" updated.`)}catch(I){console.error("Failed to save provider update:",I),ke.error("Failed to save provider configuration.")}finally{u(!1)}},[m,n,e.id,e.name]),T=E.useCallback((I,j)=>{y(L=>({...L,[I]:j}))},[]),A=E.useCallback(async()=>{if(window.confirm(`Delete provider "${e.name}"?`)){h(!0);try{await r(e.id)}catch(I){console.error("Failed to delete provider:",I),h(!1)}}},[r,e.id,e.name]),N=E.useCallback(async()=>{if(await s(e.id),o){const I=b(e.id);x([...I].sort((j,L)=>(j.name||j.id).localeCompare(L.name||L.id)))}},[s,e.id,o,b]);return f.jsx("div",{className:"border border-border p-4 space-y-3 bg-card rounded-md shadow-sm",children:o?f.jsx(BGe,{providerId:e.id,editData:m,apiKeys:t,allAvailableModels:v,isSaving:c,onCancel:k,onSave:C,onChange:T}):f.jsx(FGe,{provider:e,apiKeys:t,onEdit:_,onDelete:A,onFetchModels:N,onUpdate:n,fetchStatus:i,isDeleting:d,onSelectModelForDetails:a,allAvailableModelsForView:w})})},zGe=Ve.memo($Ge);function UGe(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return E.useMemo(()=>r=>{t.forEach(s=>s(r))},t)}const rA=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Ab(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function w6(e){return"nodeType"in e}function Qo(e){var t,n;return e?Ab(e)?e:w6(e)&&(t=(n=e.ownerDocument)==null?void 0:n.defaultView)!=null?t:window:window}function S6(e){const{Document:t}=Qo(e);return e instanceof t}function vS(e){return Ab(e)?!1:e instanceof Qo(e).HTMLElement}function Mie(e){return e instanceof Qo(e).SVGElement}function Rb(e){return e?Ab(e)?e.document:w6(e)?S6(e)?e:vS(e)||Mie(e)?e.ownerDocument:document:document:document}const Hu=rA?E.useLayoutEffect:E.useEffect;function _6(e){const t=E.useRef(e);return Hu(()=>{t.current=e}),E.useCallback(function(){for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return t.current==null?void 0:t.current(...r)},[])}function qGe(){const e=E.useRef(null),t=E.useCallback((r,s)=>{e.current=setInterval(r,s)},[]),n=E.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,n]}function l1(e,t){t===void 0&&(t=[e]);const n=E.useRef(e);return Hu(()=>{n.current!==e&&(n.current=e)},t),n}function xS(e,t){const n=E.useRef();return E.useMemo(()=>{const r=e(n.current);return n.current=r,r},[...t])}function zk(e){const t=_6(e),n=E.useRef(null),r=E.useCallback(s=>{s!==n.current&&(t==null||t(s,n.current)),n.current=s},[]);return[n,r]}function GP(e){const t=E.useRef();return E.useEffect(()=>{t.current=e},[e]),t.current}let Nj={};function wS(e,t){return E.useMemo(()=>{if(t)return t;const n=Nj[e]==null?0:Nj[e]+1;return Nj[e]=n,e+"-"+n},[e,t])}function jie(e){return function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),s=1;s<n;s++)r[s-1]=arguments[s];return r.reduce((i,a)=>{const o=Object.entries(a);for(const[l,c]of o){const u=i[l];u!=null&&(i[l]=u+e*c)}return i},{...t})}}const X0=jie(1),c1=jie(-1);function VGe(e){return"clientX"in e&&"clientY"in e}function C6(e){if(!e)return!1;const{KeyboardEvent:t}=Qo(e.target);return t&&e instanceof t}function WGe(e){if(!e)return!1;const{TouchEvent:t}=Qo(e.target);return t&&e instanceof t}function KP(e){if(WGe(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:n}=e.touches[0];return{x:t,y:n}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:n}=e.changedTouches[0];return{x:t,y:n}}}return VGe(e)?{x:e.clientX,y:e.clientY}:null}const u1=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:n}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:n}=e;return"scaleX("+t+") scaleY("+n+")"}},Transform:{toString(e){if(e)return[u1.Translate.toString(e),u1.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:n,easing:r}=e;return t+" "+n+"ms "+r}}}),cV="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function HGe(e){return e.matches(cV)?e:e.querySelector(cV)}const GGe={display:"none"};function KGe(e){let{id:t,value:n}=e;return Ve.createElement("div",{id:t,style:GGe},n)}function YGe(e){let{id:t,announcement:n,ariaLiveType:r="assertive"}=e;const s={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return Ve.createElement("div",{id:t,style:s,role:"status","aria-live":r,"aria-atomic":!0},n)}function ZGe(){const[e,t]=E.useState("");return{announce:E.useCallback(r=>{r!=null&&t(r)},[]),announcement:e}}const Pie=E.createContext(null);function XGe(e){const t=E.useContext(Pie);E.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function JGe(){const[e]=E.useState(()=>new Set),t=E.useCallback(r=>(e.add(r),()=>e.delete(r)),[e]);return[E.useCallback(r=>{let{type:s,event:i}=r;e.forEach(a=>{var o;return(o=a[s])==null?void 0:o.call(a,i)})},[e]),t]}const QGe={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},eKe={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was moved over droppable area "+n.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was dropped over droppable area "+n.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function tKe(e){let{announcements:t=eKe,container:n,hiddenTextDescribedById:r,screenReaderInstructions:s=QGe}=e;const{announce:i,announcement:a}=ZGe(),o=wS("DndLiveRegion"),[l,c]=E.useState(!1);if(E.useEffect(()=>{c(!0)},[]),XGe(E.useMemo(()=>({onDragStart(d){let{active:h}=d;i(t.onDragStart({active:h}))},onDragMove(d){let{active:h,over:m}=d;t.onDragMove&&i(t.onDragMove({active:h,over:m}))},onDragOver(d){let{active:h,over:m}=d;i(t.onDragOver({active:h,over:m}))},onDragEnd(d){let{active:h,over:m}=d;i(t.onDragEnd({active:h,over:m}))},onDragCancel(d){let{active:h,over:m}=d;i(t.onDragCancel({active:h,over:m}))}}),[i,t])),!l)return null;const u=Ve.createElement(Ve.Fragment,null,Ve.createElement(KGe,{id:r,value:s.draggable}),Ve.createElement(YGe,{id:o,announcement:a}));return n?yl.createPortal(u,n):u}var Ki;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(Ki||(Ki={}));function Uk(){}function uV(e,t){return E.useMemo(()=>({sensor:e,options:t??{}}),[e,t])}function nKe(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return E.useMemo(()=>[...t].filter(r=>r!=null),[...t])}const Zc=Object.freeze({x:0,y:0});function Oie(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function Die(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return n-r}function rKe(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return r-n}function dV(e){let{left:t,top:n,height:r,width:s}=e;return[{x:t,y:n},{x:t+s,y:n},{x:t,y:n+r},{x:t+s,y:n+r}]}function Fie(e,t){if(!e||e.length===0)return null;const[n]=e;return n[t]}function fV(e,t,n){return t===void 0&&(t=e.left),n===void 0&&(n=e.top),{x:t+e.width*.5,y:n+e.height*.5}}const sKe=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const s=fV(t,t.left,t.top),i=[];for(const a of r){const{id:o}=a,l=n.get(o);if(l){const c=Oie(fV(l),s);i.push({id:o,data:{droppableContainer:a,value:c}})}}return i.sort(Die)},iKe=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const s=dV(t),i=[];for(const a of r){const{id:o}=a,l=n.get(o);if(l){const c=dV(l),u=s.reduce((h,m,y)=>h+Oie(c[y],m),0),d=Number((u/4).toFixed(4));i.push({id:o,data:{droppableContainer:a,value:d}})}}return i.sort(Die)};function aKe(e,t){const n=Math.max(t.top,e.top),r=Math.max(t.left,e.left),s=Math.min(t.left+t.width,e.left+e.width),i=Math.min(t.top+t.height,e.top+e.height),a=s-r,o=i-n;if(r<s&&n<i){const l=t.width*t.height,c=e.width*e.height,u=a*o,d=u/(l+c-u);return Number(d.toFixed(4))}return 0}const oKe=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const s=[];for(const i of r){const{id:a}=i,o=n.get(a);if(o){const l=aKe(o,t);l>0&&s.push({id:a,data:{droppableContainer:i,value:l}})}}return s.sort(rKe)};function lKe(e,t,n){return{...e,scaleX:t&&n?t.width/n.width:1,scaleY:t&&n?t.height/n.height:1}}function Lie(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:Zc}function cKe(e){return function(n){for(var r=arguments.length,s=new Array(r>1?r-1:0),i=1;i<r;i++)s[i-1]=arguments[i];return s.reduce((a,o)=>({...a,top:a.top+e*o.y,bottom:a.bottom+e*o.y,left:a.left+e*o.x,right:a.right+e*o.x}),{...n})}}const uKe=cKe(1);function dKe(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function fKe(e,t,n){const r=dKe(t);if(!r)return e;const{scaleX:s,scaleY:i,x:a,y:o}=r,l=e.left-a-(1-s)*parseFloat(n),c=e.top-o-(1-i)*parseFloat(n.slice(n.indexOf(" ")+1)),u=s?e.width/s:e.width,d=i?e.height/i:e.height;return{width:u,height:d,top:c,right:l+u,bottom:c+d,left:l}}const hKe={ignoreTransform:!1};function Nb(e,t){t===void 0&&(t=hKe);let n=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:c,transformOrigin:u}=Qo(e).getComputedStyle(e);c&&(n=fKe(n,c,u))}const{top:r,left:s,width:i,height:a,bottom:o,right:l}=n;return{top:r,left:s,width:i,height:a,bottom:o,right:l}}function hV(e){return Nb(e,{ignoreTransform:!0})}function pKe(e){const t=e.innerWidth,n=e.innerHeight;return{top:0,left:0,right:t,bottom:n,width:t,height:n}}function mKe(e,t){return t===void 0&&(t=Qo(e).getComputedStyle(e)),t.position==="fixed"}function gKe(e,t){t===void 0&&(t=Qo(e).getComputedStyle(e));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(s=>{const i=t[s];return typeof i=="string"?n.test(i):!1})}function sA(e,t){const n=[];function r(s){if(t!=null&&n.length>=t||!s)return n;if(S6(s)&&s.scrollingElement!=null&&!n.includes(s.scrollingElement))return n.push(s.scrollingElement),n;if(!vS(s)||Mie(s)||n.includes(s))return n;const i=Qo(e).getComputedStyle(s);return s!==e&&gKe(s,i)&&n.push(s),mKe(s,i)?n:r(s.parentNode)}return e?r(e):n}function Bie(e){const[t]=sA(e,1);return t??null}function Ij(e){return!rA||!e?null:Ab(e)?e:w6(e)?S6(e)||e===Rb(e).scrollingElement?window:vS(e)?e:null:null}function $ie(e){return Ab(e)?e.scrollX:e.scrollLeft}function zie(e){return Ab(e)?e.scrollY:e.scrollTop}function YP(e){return{x:$ie(e),y:zie(e)}}var da;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(da||(da={}));function Uie(e){return!rA||!e?!1:e===document.scrollingElement}function qie(e){const t={x:0,y:0},n=Uie(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},r={x:e.scrollWidth-n.width,y:e.scrollHeight-n.height},s=e.scrollTop<=t.y,i=e.scrollLeft<=t.x,a=e.scrollTop>=r.y,o=e.scrollLeft>=r.x;return{isTop:s,isLeft:i,isBottom:a,isRight:o,maxScroll:r,minScroll:t}}const yKe={x:.2,y:.2};function bKe(e,t,n,r,s){let{top:i,left:a,right:o,bottom:l}=n;r===void 0&&(r=10),s===void 0&&(s=yKe);const{isTop:c,isBottom:u,isLeft:d,isRight:h}=qie(e),m={x:0,y:0},y={x:0,y:0},b={height:t.height*s.y,width:t.width*s.x};return!c&&i<=t.top+b.height?(m.y=da.Backward,y.y=r*Math.abs((t.top+b.height-i)/b.height)):!u&&l>=t.bottom-b.height&&(m.y=da.Forward,y.y=r*Math.abs((t.bottom-b.height-l)/b.height)),!h&&o>=t.right-b.width?(m.x=da.Forward,y.x=r*Math.abs((t.right-b.width-o)/b.width)):!d&&a<=t.left+b.width&&(m.x=da.Backward,y.x=r*Math.abs((t.left+b.width-a)/b.width)),{direction:m,speed:y}}function vKe(e){if(e===document.scrollingElement){const{innerWidth:i,innerHeight:a}=window;return{top:0,left:0,right:i,bottom:a,width:i,height:a}}const{top:t,left:n,right:r,bottom:s}=e.getBoundingClientRect();return{top:t,left:n,right:r,bottom:s,width:e.clientWidth,height:e.clientHeight}}function Vie(e){return e.reduce((t,n)=>X0(t,YP(n)),Zc)}function xKe(e){return e.reduce((t,n)=>t+$ie(n),0)}function wKe(e){return e.reduce((t,n)=>t+zie(n),0)}function SKe(e,t){if(t===void 0&&(t=Nb),!e)return;const{top:n,left:r,bottom:s,right:i}=t(e);Bie(e)&&(s<=0||i<=0||n>=window.innerHeight||r>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const _Ke=[["x",["left","right"],xKe],["y",["top","bottom"],wKe]];class k6{constructor(t,n){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const r=sA(n),s=Vie(r);this.rect={...t},this.width=t.width,this.height=t.height;for(const[i,a,o]of _Ke)for(const l of a)Object.defineProperty(this,l,{get:()=>{const c=o(r),u=s[i]-c;return this.rect[l]+u},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class Hx{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(n=>{var r;return(r=this.target)==null?void 0:r.removeEventListener(...n)})},this.target=t}add(t,n,r){var s;(s=this.target)==null||s.addEventListener(t,n,r),this.listeners.push([t,n,r])}}function CKe(e){const{EventTarget:t}=Qo(e);return e instanceof t?e:Rb(e)}function Mj(e,t){const n=Math.abs(e.x),r=Math.abs(e.y);return typeof t=="number"?Math.sqrt(n**2+r**2)>t:"x"in t&&"y"in t?n>t.x&&r>t.y:"x"in t?n>t.x:"y"in t?r>t.y:!1}var Kl;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(Kl||(Kl={}));function pV(e){e.preventDefault()}function kKe(e){e.stopPropagation()}var Hr;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(Hr||(Hr={}));const Wie={start:[Hr.Space,Hr.Enter],cancel:[Hr.Esc],end:[Hr.Space,Hr.Enter,Hr.Tab]},EKe=(e,t)=>{let{currentCoordinates:n}=t;switch(e.code){case Hr.Right:return{...n,x:n.x+25};case Hr.Left:return{...n,x:n.x-25};case Hr.Down:return{...n,y:n.y+25};case Hr.Up:return{...n,y:n.y-25}}};class E6{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:n}}=t;this.props=t,this.listeners=new Hx(Rb(n)),this.windowListeners=new Hx(Qo(n)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(Kl.Resize,this.handleCancel),this.windowListeners.add(Kl.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(Kl.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:n}=this.props,r=t.node.current;r&&SKe(r),n(Zc)}handleKeyDown(t){if(C6(t)){const{active:n,context:r,options:s}=this.props,{keyboardCodes:i=Wie,coordinateGetter:a=EKe,scrollBehavior:o="smooth"}=s,{code:l}=t;if(i.end.includes(l)){this.handleEnd(t);return}if(i.cancel.includes(l)){this.handleCancel(t);return}const{collisionRect:c}=r.current,u=c?{x:c.left,y:c.top}:Zc;this.referenceCoordinates||(this.referenceCoordinates=u);const d=a(t,{active:n,context:r.current,currentCoordinates:u});if(d){const h=c1(d,u),m={x:0,y:0},{scrollableAncestors:y}=r.current;for(const b of y){const v=t.code,{isTop:x,isRight:w,isLeft:_,isBottom:k,maxScroll:C,minScroll:T}=qie(b),A=vKe(b),N={x:Math.min(v===Hr.Right?A.right-A.width/2:A.right,Math.max(v===Hr.Right?A.left:A.left+A.width/2,d.x)),y:Math.min(v===Hr.Down?A.bottom-A.height/2:A.bottom,Math.max(v===Hr.Down?A.top:A.top+A.height/2,d.y))},I=v===Hr.Right&&!w||v===Hr.Left&&!_,j=v===Hr.Down&&!k||v===Hr.Up&&!x;if(I&&N.x!==d.x){const L=b.scrollLeft+h.x,D=v===Hr.Right&&L<=C.x||v===Hr.Left&&L>=T.x;if(D&&!h.y){b.scrollTo({left:L,behavior:o});return}D?m.x=b.scrollLeft-L:m.x=v===Hr.Right?b.scrollLeft-C.x:b.scrollLeft-T.x,m.x&&b.scrollBy({left:-m.x,behavior:o});break}else if(j&&N.y!==d.y){const L=b.scrollTop+h.y,D=v===Hr.Down&&L<=C.y||v===Hr.Up&&L>=T.y;if(D&&!h.x){b.scrollTo({top:L,behavior:o});return}D?m.y=b.scrollTop-L:m.y=v===Hr.Down?b.scrollTop-C.y:b.scrollTop-T.y,m.y&&b.scrollBy({top:-m.y,behavior:o});break}}this.handleMove(t,X0(c1(d,this.referenceCoordinates),m))}}}handleMove(t,n){const{onMove:r}=this.props;t.preventDefault(),r(n)}handleEnd(t){const{onEnd:n}=this.props;t.preventDefault(),this.detach(),n()}handleCancel(t){const{onCancel:n}=this.props;t.preventDefault(),this.detach(),n()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}E6.activators=[{eventName:"onKeyDown",handler:(e,t,n)=>{let{keyboardCodes:r=Wie,onActivation:s}=t,{active:i}=n;const{code:a}=e.nativeEvent;if(r.start.includes(a)){const o=i.activatorNode.current;return o&&e.target!==o?!1:(e.preventDefault(),s==null||s({event:e.nativeEvent}),!0)}return!1}}];function mV(e){return!!(e&&"distance"in e)}function gV(e){return!!(e&&"delay"in e)}class T6{constructor(t,n,r){var s;r===void 0&&(r=CKe(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=n;const{event:i}=t,{target:a}=i;this.props=t,this.events=n,this.document=Rb(a),this.documentListeners=new Hx(this.document),this.listeners=new Hx(r),this.windowListeners=new Hx(Qo(a)),this.initialCoordinates=(s=KP(i))!=null?s:Zc,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:n,bypassActivationConstraint:r}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(Kl.Resize,this.handleCancel),this.windowListeners.add(Kl.DragStart,pV),this.windowListeners.add(Kl.VisibilityChange,this.handleCancel),this.windowListeners.add(Kl.ContextMenu,pV),this.documentListeners.add(Kl.Keydown,this.handleKeydown),n){if(r!=null&&r({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(gV(n)){this.timeoutId=setTimeout(this.handleStart,n.delay),this.handlePending(n);return}if(mV(n)){this.handlePending(n);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,n){const{active:r,onPending:s}=this.props;s(r,t,this.initialCoordinates,n)}handleStart(){const{initialCoordinates:t}=this,{onStart:n}=this.props;t&&(this.activated=!0,this.documentListeners.add(Kl.Click,kKe,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(Kl.SelectionChange,this.removeTextSelection),n(t))}handleMove(t){var n;const{activated:r,initialCoordinates:s,props:i}=this,{onMove:a,options:{activationConstraint:o}}=i;if(!s)return;const l=(n=KP(t))!=null?n:Zc,c=c1(s,l);if(!r&&o){if(mV(o)){if(o.tolerance!=null&&Mj(c,o.tolerance))return this.handleCancel();if(Mj(c,o.distance))return this.handleStart()}if(gV(o)&&Mj(c,o.tolerance))return this.handleCancel();this.handlePending(o,c);return}t.cancelable&&t.preventDefault(),a(l)}handleEnd(){const{onAbort:t,onEnd:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleCancel(){const{onAbort:t,onCancel:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleKeydown(t){t.code===Hr.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const TKe={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class A6 extends T6{constructor(t){const{event:n}=t,r=Rb(n.target);super(t,TKe,r)}}A6.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return!n.isPrimary||n.button!==0?!1:(r==null||r({event:n}),!0)}}];const AKe={move:{name:"mousemove"},end:{name:"mouseup"}};var ZP;(function(e){e[e.RightClick=2]="RightClick"})(ZP||(ZP={}));class RKe extends T6{constructor(t){super(t,AKe,Rb(t.event.target))}}RKe.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return n.button===ZP.RightClick?!1:(r==null||r({event:n}),!0)}}];const jj={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class NKe extends T6{constructor(t){super(t,jj)}static setup(){return window.addEventListener(jj.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(jj.move.name,t)};function t(){}}}NKe.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;const{touches:s}=n;return s.length>1?!1:(r==null||r({event:n}),!0)}}];var Gx;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(Gx||(Gx={}));var qk;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(qk||(qk={}));function IKe(e){let{acceleration:t,activator:n=Gx.Pointer,canScroll:r,draggingRect:s,enabled:i,interval:a=5,order:o=qk.TreeOrder,pointerCoordinates:l,scrollableAncestors:c,scrollableAncestorRects:u,delta:d,threshold:h}=e;const m=jKe({delta:d,disabled:!i}),[y,b]=qGe(),v=E.useRef({x:0,y:0}),x=E.useRef({x:0,y:0}),w=E.useMemo(()=>{switch(n){case Gx.Pointer:return l?{top:l.y,bottom:l.y,left:l.x,right:l.x}:null;case Gx.DraggableRect:return s}},[n,s,l]),_=E.useRef(null),k=E.useCallback(()=>{const T=_.current;if(!T)return;const A=v.current.x*x.current.x,N=v.current.y*x.current.y;T.scrollBy(A,N)},[]),C=E.useMemo(()=>o===qk.TreeOrder?[...c].reverse():c,[o,c]);E.useEffect(()=>{if(!i||!c.length||!w){b();return}for(const T of C){if((r==null?void 0:r(T))===!1)continue;const A=c.indexOf(T),N=u[A];if(!N)continue;const{direction:I,speed:j}=bKe(T,N,w,t,h);for(const L of["x","y"])m[L][I[L]]||(j[L]=0,I[L]=0);if(j.x>0||j.y>0){b(),_.current=T,y(k,a),v.current=j,x.current=I;return}}v.current={x:0,y:0},x.current={x:0,y:0},b()},[t,k,r,b,i,a,JSON.stringify(w),JSON.stringify(m),y,c,C,u,JSON.stringify(h)])}const MKe={x:{[da.Backward]:!1,[da.Forward]:!1},y:{[da.Backward]:!1,[da.Forward]:!1}};function jKe(e){let{delta:t,disabled:n}=e;const r=GP(t);return xS(s=>{if(n||!r||!s)return MKe;const i={x:Math.sign(t.x-r.x),y:Math.sign(t.y-r.y)};return{x:{[da.Backward]:s.x[da.Backward]||i.x===-1,[da.Forward]:s.x[da.Forward]||i.x===1},y:{[da.Backward]:s.y[da.Backward]||i.y===-1,[da.Forward]:s.y[da.Forward]||i.y===1}}},[n,t,r])}function PKe(e,t){const n=t!=null?e.get(t):void 0,r=n?n.node.current:null;return xS(s=>{var i;return t==null?null:(i=r??s)!=null?i:null},[r,t])}function OKe(e,t){return E.useMemo(()=>e.reduce((n,r)=>{const{sensor:s}=r,i=s.activators.map(a=>({eventName:a.eventName,handler:t(a.handler,r)}));return[...n,...i]},[]),[e,t])}var d1;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(d1||(d1={}));var XP;(function(e){e.Optimized="optimized"})(XP||(XP={}));const yV=new Map;function DKe(e,t){let{dragging:n,dependencies:r,config:s}=t;const[i,a]=E.useState(null),{frequency:o,measure:l,strategy:c}=s,u=E.useRef(e),d=v(),h=l1(d),m=E.useCallback(function(x){x===void 0&&(x=[]),!h.current&&a(w=>w===null?x:w.concat(x.filter(_=>!w.includes(_))))},[h]),y=E.useRef(null),b=xS(x=>{if(d&&!n)return yV;if(!x||x===yV||u.current!==e||i!=null){const w=new Map;for(let _ of e){if(!_)continue;if(i&&i.length>0&&!i.includes(_.id)&&_.rect.current){w.set(_.id,_.rect.current);continue}const k=_.node.current,C=k?new k6(l(k),k):null;_.rect.current=C,C&&w.set(_.id,C)}return w}return x},[e,i,n,d,l]);return E.useEffect(()=>{u.current=e},[e]),E.useEffect(()=>{d||m()},[n,d]),E.useEffect(()=>{i&&i.length>0&&a(null)},[JSON.stringify(i)]),E.useEffect(()=>{d||typeof o!="number"||y.current!==null||(y.current=setTimeout(()=>{m(),y.current=null},o))},[o,d,m,...r]),{droppableRects:b,measureDroppableContainers:m,measuringScheduled:i!=null};function v(){switch(c){case d1.Always:return!1;case d1.BeforeDragging:return n;default:return!n}}}function Hie(e,t){return xS(n=>e?n||(typeof t=="function"?t(e):e):null,[t,e])}function FKe(e,t){return Hie(e,t)}function LKe(e){let{callback:t,disabled:n}=e;const r=_6(t),s=E.useMemo(()=>{if(n||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:i}=window;return new i(r)},[r,n]);return E.useEffect(()=>()=>s==null?void 0:s.disconnect(),[s]),s}function iA(e){let{callback:t,disabled:n}=e;const r=_6(t),s=E.useMemo(()=>{if(n||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:i}=window;return new i(r)},[n]);return E.useEffect(()=>()=>s==null?void 0:s.disconnect(),[s]),s}function BKe(e){return new k6(Nb(e),e)}function bV(e,t,n){t===void 0&&(t=BKe);const[r,s]=E.useState(null);function i(){s(l=>{if(!e)return null;if(e.isConnected===!1){var c;return(c=l??n)!=null?c:null}const u=t(e);return JSON.stringify(l)===JSON.stringify(u)?l:u})}const a=LKe({callback(l){if(e)for(const c of l){const{type:u,target:d}=c;if(u==="childList"&&d instanceof HTMLElement&&d.contains(e)){i();break}}}}),o=iA({callback:i});return Hu(()=>{i(),e?(o==null||o.observe(e),a==null||a.observe(document.body,{childList:!0,subtree:!0})):(o==null||o.disconnect(),a==null||a.disconnect())},[e]),r}function $Ke(e){const t=Hie(e);return Lie(e,t)}const vV=[];function zKe(e){const t=E.useRef(e),n=xS(r=>e?r&&r!==vV&&e&&t.current&&e.parentNode===t.current.parentNode?r:sA(e):vV,[e]);return E.useEffect(()=>{t.current=e},[e]),n}function UKe(e){const[t,n]=E.useState(null),r=E.useRef(e),s=E.useCallback(i=>{const a=Ij(i.target);a&&n(o=>o?(o.set(a,YP(a)),new Map(o)):null)},[]);return E.useEffect(()=>{const i=r.current;if(e!==i){a(i);const o=e.map(l=>{const c=Ij(l);return c?(c.addEventListener("scroll",s,{passive:!0}),[c,YP(c)]):null}).filter(l=>l!=null);n(o.length?new Map(o):null),r.current=e}return()=>{a(e),a(i)};function a(o){o.forEach(l=>{const c=Ij(l);c==null||c.removeEventListener("scroll",s)})}},[s,e]),E.useMemo(()=>e.length?t?Array.from(t.values()).reduce((i,a)=>X0(i,a),Zc):Vie(e):Zc,[e,t])}function xV(e,t){t===void 0&&(t=[]);const n=E.useRef(null);return E.useEffect(()=>{n.current=null},t),E.useEffect(()=>{const r=e!==Zc;r&&!n.current&&(n.current=e),!r&&n.current&&(n.current=null)},[e]),n.current?c1(e,n.current):Zc}function qKe(e){E.useEffect(()=>{if(!rA)return;const t=e.map(n=>{let{sensor:r}=n;return r.setup==null?void 0:r.setup()});return()=>{for(const n of t)n==null||n()}},e.map(t=>{let{sensor:n}=t;return n}))}function VKe(e,t){return E.useMemo(()=>e.reduce((n,r)=>{let{eventName:s,handler:i}=r;return n[s]=a=>{i(a,t)},n},{}),[e,t])}function Gie(e){return E.useMemo(()=>e?pKe(e):null,[e])}const wV=[];function WKe(e,t){t===void 0&&(t=Nb);const[n]=e,r=Gie(n?Qo(n):null),[s,i]=E.useState(wV);function a(){i(()=>e.length?e.map(l=>Uie(l)?r:new k6(t(l),l)):wV)}const o=iA({callback:a});return Hu(()=>{o==null||o.disconnect(),a(),e.forEach(l=>o==null?void 0:o.observe(l))},[e]),s}function HKe(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return vS(t)?t:e}function GKe(e){let{measure:t}=e;const[n,r]=E.useState(null),s=E.useCallback(c=>{for(const{target:u}of c)if(vS(u)){r(d=>{const h=t(u);return d?{...d,width:h.width,height:h.height}:h});break}},[t]),i=iA({callback:s}),a=E.useCallback(c=>{const u=HKe(c);i==null||i.disconnect(),u&&(i==null||i.observe(u)),r(u?t(u):null)},[t,i]),[o,l]=zk(a);return E.useMemo(()=>({nodeRef:o,rect:n,setRef:l}),[n,o,l])}const KKe=[{sensor:A6,options:{}},{sensor:E6,options:{}}],YKe={current:{}},n2={draggable:{measure:hV},droppable:{measure:hV,strategy:d1.WhileDragging,frequency:XP.Optimized},dragOverlay:{measure:Nb}};class Kx extends Map{get(t){var n;return t!=null&&(n=super.get(t))!=null?n:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:n}=t;return!n})}getNodeFor(t){var n,r;return(n=(r=this.get(t))==null?void 0:r.node.current)!=null?n:void 0}}const ZKe={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new Kx,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:Uk},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:n2,measureDroppableContainers:Uk,windowRect:null,measuringScheduled:!1},XKe={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:Uk,draggableNodes:new Map,over:null,measureDroppableContainers:Uk},aA=E.createContext(XKe),Kie=E.createContext(ZKe);function JKe(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new Kx}}}function QKe(e,t){switch(t.type){case Ki.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case Ki.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case Ki.DragEnd:case Ki.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case Ki.RegisterDroppable:{const{element:n}=t,{id:r}=n,s=new Kx(e.droppable.containers);return s.set(r,n),{...e,droppable:{...e.droppable,containers:s}}}case Ki.SetDroppableDisabled:{const{id:n,key:r,disabled:s}=t,i=e.droppable.containers.get(n);if(!i||r!==i.key)return e;const a=new Kx(e.droppable.containers);return a.set(n,{...i,disabled:s}),{...e,droppable:{...e.droppable,containers:a}}}case Ki.UnregisterDroppable:{const{id:n,key:r}=t,s=e.droppable.containers.get(n);if(!s||r!==s.key)return e;const i=new Kx(e.droppable.containers);return i.delete(n),{...e,droppable:{...e.droppable,containers:i}}}default:return e}}function eYe(e){let{disabled:t}=e;const{active:n,activatorEvent:r,draggableNodes:s}=E.useContext(aA),i=GP(r),a=GP(n==null?void 0:n.id);return E.useEffect(()=>{if(!t&&!r&&i&&a!=null){if(!C6(i)||document.activeElement===i.target)return;const o=s.get(a);if(!o)return;const{activatorNode:l,node:c}=o;if(!l.current&&!c.current)return;requestAnimationFrame(()=>{for(const u of[l.current,c.current]){if(!u)continue;const d=HGe(u);if(d){d.focus();break}}})}},[r,t,s,a,i]),null}function tYe(e,t){let{transform:n,...r}=t;return e!=null&&e.length?e.reduce((s,i)=>i({transform:s,...r}),n):n}function nYe(e){return E.useMemo(()=>({draggable:{...n2.draggable,...e==null?void 0:e.draggable},droppable:{...n2.droppable,...e==null?void 0:e.droppable},dragOverlay:{...n2.dragOverlay,...e==null?void 0:e.dragOverlay}}),[e==null?void 0:e.draggable,e==null?void 0:e.droppable,e==null?void 0:e.dragOverlay])}function rYe(e){let{activeNode:t,measure:n,initialRect:r,config:s=!0}=e;const i=E.useRef(!1),{x:a,y:o}=typeof s=="boolean"?{x:s,y:s}:s;Hu(()=>{if(!a&&!o||!t){i.current=!1;return}if(i.current||!r)return;const c=t==null?void 0:t.node.current;if(!c||c.isConnected===!1)return;const u=n(c),d=Lie(u,r);if(a||(d.x=0),o||(d.y=0),i.current=!0,Math.abs(d.x)>0||Math.abs(d.y)>0){const h=Bie(c);h&&h.scrollBy({top:d.y,left:d.x})}},[t,a,o,r,n])}const Yie=E.createContext({...Zc,scaleX:1,scaleY:1});var wh;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(wh||(wh={}));const sYe=E.memo(function(t){var n,r,s,i;let{id:a,accessibility:o,autoScroll:l=!0,children:c,sensors:u=KKe,collisionDetection:d=oKe,measuring:h,modifiers:m,...y}=t;const b=E.useReducer(QKe,void 0,JKe),[v,x]=b,[w,_]=JGe(),[k,C]=E.useState(wh.Uninitialized),T=k===wh.Initialized,{draggable:{active:A,nodes:N,translate:I},droppable:{containers:j}}=v,L=A!=null?N.get(A):null,D=E.useRef({initial:null,translated:null}),H=E.useMemo(()=>{var tt;return A!=null?{id:A,data:(tt=L==null?void 0:L.data)!=null?tt:YKe,rect:D}:null},[A,L]),O=E.useRef(null),[K,U]=E.useState(null),[W,B]=E.useState(null),ne=l1(y,Object.values(y)),V=wS("DndDescribedBy",a),Q=E.useMemo(()=>j.getEnabled(),[j]),ee=nYe(h),{droppableRects:re,measureDroppableContainers:de,measuringScheduled:me}=DKe(Q,{dragging:T,dependencies:[I.x,I.y],config:ee.droppable}),De=PKe(N,A),je=E.useMemo(()=>W?KP(W):null,[W]),Te=qe(),_e=FKe(De,ee.draggable.measure);rYe({activeNode:A!=null?N.get(A):null,config:Te.layoutShiftCompensation,initialRect:_e,measure:ee.draggable.measure});const Ue=bV(De,ee.draggable.measure,_e),Qe=bV(De?De.parentElement:null),We=E.useRef({activatorEvent:null,active:null,activeNode:De,collisionRect:null,collisions:null,droppableRects:re,draggableNodes:N,draggingNode:null,draggingNodeRect:null,droppableContainers:j,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),Pe=j.getNodeFor((n=We.current.over)==null?void 0:n.id),Y=GKe({measure:ee.dragOverlay.measure}),ye=(r=Y.nodeRef.current)!=null?r:De,Me=T?(s=Y.rect)!=null?s:Ue:null,ue=!!(Y.nodeRef.current&&Y.rect),oe=$Ke(ue?null:Ue),se=Gie(ye?Qo(ye):null),Ie=zKe(T?Pe??De:null),Be=WKe(Ie),Re=tYe(m,{transform:{x:I.x-oe.x,y:I.y-oe.y,scaleX:1,scaleY:1},activatorEvent:W,active:H,activeNodeRect:Ue,containerNodeRect:Qe,draggingNodeRect:Me,over:We.current.over,overlayNodeRect:Y.rect,scrollableAncestors:Ie,scrollableAncestorRects:Be,windowRect:se}),ct=je?X0(je,I):null,At=UKe(Ie),ut=xV(At),Pt=xV(At,[Ue]),Ut=X0(Re,ut),Ft=Me?uKe(Me,Re):null,Yt=H&&Ft?d({active:H,collisionRect:Ft,droppableRects:re,droppableContainers:Q,pointerCoordinates:ct}):null,we=Fie(Yt,"id"),[F,X]=E.useState(null),be=ue?Re:X0(Re,Pt),Ee=lKe(be,(i=F==null?void 0:F.rect)!=null?i:null,Ue),ge=E.useRef(null),Ae=E.useCallback((tt,ve)=>{let{sensor:Se,options:ze}=ve;if(O.current==null)return;const Ct=N.get(O.current);if(!Ct)return;const fe=tt.nativeEvent,Z=new Se({active:O.current,activeNode:Ct,event:fe,options:ze,context:We,onAbort(J){if(!N.get(J))return;const{onDragAbort:Fe}=ne.current,He={id:J};Fe==null||Fe(He),w({type:"onDragAbort",event:He})},onPending(J,xe,Fe,He){if(!N.get(J))return;const{onDragPending:Qt}=ne.current,Dn={id:J,constraint:xe,initialCoordinates:Fe,offset:He};Qt==null||Qt(Dn),w({type:"onDragPending",event:Dn})},onStart(J){const xe=O.current;if(xe==null)return;const Fe=N.get(xe);if(!Fe)return;const{onDragStart:He}=ne.current,wt={activatorEvent:fe,active:{id:xe,data:Fe.data,rect:D}};yl.unstable_batchedUpdates(()=>{He==null||He(wt),C(wh.Initializing),x({type:Ki.DragStart,initialCoordinates:J,active:xe}),w({type:"onDragStart",event:wt}),U(ge.current),B(fe)})},onMove(J){x({type:Ki.DragMove,coordinates:J})},onEnd:G(Ki.DragEnd),onCancel:G(Ki.DragCancel)});ge.current=Z;function G(J){return async function(){const{active:Fe,collisions:He,over:wt,scrollAdjustedTranslate:Qt}=We.current;let Dn=null;if(Fe&&Qt){const{cancelDrop:Zt}=ne.current;Dn={activatorEvent:fe,active:Fe,collisions:He,delta:Qt,over:wt},J===Ki.DragEnd&&typeof Zt=="function"&&await Promise.resolve(Zt(Dn))&&(J=Ki.DragCancel)}O.current=null,yl.unstable_batchedUpdates(()=>{x({type:J}),C(wh.Uninitialized),X(null),U(null),B(null),ge.current=null;const Zt=J===Ki.DragEnd?"onDragEnd":"onDragCancel";if(Dn){const rn=ne.current[Zt];rn==null||rn(Dn),w({type:Zt,event:Dn})}})}}},[N]),le=E.useCallback((tt,ve)=>(Se,ze)=>{const Ct=Se.nativeEvent,fe=N.get(ze);if(O.current!==null||!fe||Ct.dndKit||Ct.defaultPrevented)return;const Z={active:fe};tt(Se,ve.options,Z)===!0&&(Ct.dndKit={capturedBy:ve.sensor},O.current=ze,Ae(Se,ve))},[N,Ae]),ft=OKe(u,le);qKe(u),Hu(()=>{Ue&&k===wh.Initializing&&C(wh.Initialized)},[Ue,k]),E.useEffect(()=>{const{onDragMove:tt}=ne.current,{active:ve,activatorEvent:Se,collisions:ze,over:Ct}=We.current;if(!ve||!Se)return;const fe={active:ve,activatorEvent:Se,collisions:ze,delta:{x:Ut.x,y:Ut.y},over:Ct};yl.unstable_batchedUpdates(()=>{tt==null||tt(fe),w({type:"onDragMove",event:fe})})},[Ut.x,Ut.y]),E.useEffect(()=>{const{active:tt,activatorEvent:ve,collisions:Se,droppableContainers:ze,scrollAdjustedTranslate:Ct}=We.current;if(!tt||O.current==null||!ve||!Ct)return;const{onDragOver:fe}=ne.current,Z=ze.get(we),G=Z&&Z.rect.current?{id:Z.id,rect:Z.rect.current,data:Z.data,disabled:Z.disabled}:null,J={active:tt,activatorEvent:ve,collisions:Se,delta:{x:Ct.x,y:Ct.y},over:G};yl.unstable_batchedUpdates(()=>{X(G),fe==null||fe(J),w({type:"onDragOver",event:J})})},[we]),Hu(()=>{We.current={activatorEvent:W,active:H,activeNode:De,collisionRect:Ft,collisions:Yt,droppableRects:re,draggableNodes:N,draggingNode:ye,draggingNodeRect:Me,droppableContainers:j,over:F,scrollableAncestors:Ie,scrollAdjustedTranslate:Ut},D.current={initial:Me,translated:Ft}},[H,De,Yt,Ft,N,ye,Me,re,j,F,Ie,Ut]),IKe({...Te,delta:I,draggingRect:Ft,pointerCoordinates:ct,scrollableAncestors:Ie,scrollableAncestorRects:Be});const et=E.useMemo(()=>({active:H,activeNode:De,activeNodeRect:Ue,activatorEvent:W,collisions:Yt,containerNodeRect:Qe,dragOverlay:Y,draggableNodes:N,droppableContainers:j,droppableRects:re,over:F,measureDroppableContainers:de,scrollableAncestors:Ie,scrollableAncestorRects:Be,measuringConfiguration:ee,measuringScheduled:me,windowRect:se}),[H,De,Ue,W,Yt,Qe,Y,N,j,re,F,de,Ie,Be,ee,me,se]),$=E.useMemo(()=>({activatorEvent:W,activators:ft,active:H,activeNodeRect:Ue,ariaDescribedById:{draggable:V},dispatch:x,draggableNodes:N,over:F,measureDroppableContainers:de}),[W,ft,H,Ue,x,V,N,F,de]);return Ve.createElement(Pie.Provider,{value:_},Ve.createElement(aA.Provider,{value:$},Ve.createElement(Kie.Provider,{value:et},Ve.createElement(Yie.Provider,{value:Ee},c)),Ve.createElement(eYe,{disabled:(o==null?void 0:o.restoreFocus)===!1})),Ve.createElement(tKe,{...o,hiddenTextDescribedById:V}));function qe(){const tt=(K==null?void 0:K.autoScrollEnabled)===!1,ve=typeof l=="object"?l.enabled===!1:l===!1,Se=T&&!tt&&!ve;return typeof l=="object"?{...l,enabled:Se}:{enabled:Se}}}),iYe=E.createContext(null),SV="button",aYe="Draggable";function oYe(e){let{id:t,data:n,disabled:r=!1,attributes:s}=e;const i=wS(aYe),{activators:a,activatorEvent:o,active:l,activeNodeRect:c,ariaDescribedById:u,draggableNodes:d,over:h}=E.useContext(aA),{role:m=SV,roleDescription:y="draggable",tabIndex:b=0}=s??{},v=(l==null?void 0:l.id)===t,x=E.useContext(v?Yie:iYe),[w,_]=zk(),[k,C]=zk(),T=VKe(a,t),A=l1(n);Hu(()=>(d.set(t,{id:t,key:i,node:w,activatorNode:k,data:A}),()=>{const I=d.get(t);I&&I.key===i&&d.delete(t)}),[d,t]);const N=E.useMemo(()=>({role:m,tabIndex:b,"aria-disabled":r,"aria-pressed":v&&m===SV?!0:void 0,"aria-roledescription":y,"aria-describedby":u.draggable}),[r,m,b,v,y,u.draggable]);return{active:l,activatorEvent:o,activeNodeRect:c,attributes:N,isDragging:v,listeners:r?void 0:T,node:w,over:h,setNodeRef:_,setActivatorNodeRef:C,transform:x}}function lYe(){return E.useContext(Kie)}const cYe="Droppable",uYe={timeout:25};function dYe(e){let{data:t,disabled:n=!1,id:r,resizeObserverConfig:s}=e;const i=wS(cYe),{active:a,dispatch:o,over:l,measureDroppableContainers:c}=E.useContext(aA),u=E.useRef({disabled:n}),d=E.useRef(!1),h=E.useRef(null),m=E.useRef(null),{disabled:y,updateMeasurementsFor:b,timeout:v}={...uYe,...s},x=l1(b??r),w=E.useCallback(()=>{if(!d.current){d.current=!0;return}m.current!=null&&clearTimeout(m.current),m.current=setTimeout(()=>{c(Array.isArray(x.current)?x.current:[x.current]),m.current=null},v)},[v]),_=iA({callback:w,disabled:y||!a}),k=E.useCallback((N,I)=>{_&&(I&&(_.unobserve(I),d.current=!1),N&&_.observe(N))},[_]),[C,T]=zk(k),A=l1(t);return E.useEffect(()=>{!_||!C.current||(_.disconnect(),d.current=!1,_.observe(C.current))},[C,_]),E.useEffect(()=>(o({type:Ki.RegisterDroppable,element:{id:r,key:i,disabled:n,node:C,rect:h,data:A}}),()=>o({type:Ki.UnregisterDroppable,key:i,id:r})),[r]),E.useEffect(()=>{n!==u.current.disabled&&(o({type:Ki.SetDroppableDisabled,id:r,key:i,disabled:n}),u.current.disabled=n)},[r,i,n,o]),{active:a,rect:h,isOver:(l==null?void 0:l.id)===r,node:C,over:l,setNodeRef:T}}function Yx(e,t,n){const r=e.slice();return r.splice(n<0?r.length+n:n,0,r.splice(t,1)[0]),r}function fYe(e,t){return e.reduce((n,r,s)=>{const i=t.get(r);return i&&(n[s]=i),n},Array(e.length))}function EC(e){return e!==null&&e>=0}function hYe(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function pYe(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const Zie=e=>{let{rects:t,activeIndex:n,overIndex:r,index:s}=e;const i=Yx(t,r,n),a=t[s],o=i[s];return!o||!a?null:{x:o.left-a.left,y:o.top-a.top,scaleX:o.width/a.width,scaleY:o.height/a.height}},TC={scaleX:1,scaleY:1},mYe=e=>{var t;let{activeIndex:n,activeNodeRect:r,index:s,rects:i,overIndex:a}=e;const o=(t=i[n])!=null?t:r;if(!o)return null;if(s===n){const c=i[a];return c?{x:0,y:n<a?c.top+c.height-(o.top+o.height):c.top-o.top,...TC}:null}const l=gYe(i,s,n);return s>n&&s<=a?{x:0,y:-o.height-l,...TC}:s<n&&s>=a?{x:0,y:o.height+l,...TC}:{x:0,y:0,...TC}};function gYe(e,t,n){const r=e[t],s=e[t-1],i=e[t+1];return r?n<t?s?r.top-(s.top+s.height):i?i.top-(r.top+r.height):0:i?i.top-(r.top+r.height):s?r.top-(s.top+s.height):0:0}const Xie="Sortable",Jie=Ve.createContext({activeIndex:-1,containerId:Xie,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:Zie,disabled:{draggable:!1,droppable:!1}});function yYe(e){let{children:t,id:n,items:r,strategy:s=Zie,disabled:i=!1}=e;const{active:a,dragOverlay:o,droppableRects:l,over:c,measureDroppableContainers:u}=lYe(),d=wS(Xie,n),h=o.rect!==null,m=E.useMemo(()=>r.map(T=>typeof T=="object"&&"id"in T?T.id:T),[r]),y=a!=null,b=a?m.indexOf(a.id):-1,v=c?m.indexOf(c.id):-1,x=E.useRef(m),w=!hYe(m,x.current),_=v!==-1&&b===-1||w,k=pYe(i);Hu(()=>{w&&y&&u(m)},[w,m,y,u]),E.useEffect(()=>{x.current=m},[m]);const C=E.useMemo(()=>({activeIndex:b,containerId:d,disabled:k,disableTransforms:_,items:m,overIndex:v,useDragOverlay:h,sortedRects:fYe(m,l),strategy:s}),[b,d,k.draggable,k.droppable,_,m,v,l,h,s]);return Ve.createElement(Jie.Provider,{value:C},t)}const bYe=e=>{let{id:t,items:n,activeIndex:r,overIndex:s}=e;return Yx(n,r,s).indexOf(t)},vYe=e=>{let{containerId:t,isSorting:n,wasDragging:r,index:s,items:i,newIndex:a,previousItems:o,previousContainerId:l,transition:c}=e;return!c||!r||o!==i&&s===a?!1:n?!0:a!==s&&t===l},xYe={duration:200,easing:"ease"},Qie="transform",wYe=u1.Transition.toString({property:Qie,duration:0,easing:"linear"}),SYe={roleDescription:"sortable"};function _Ye(e){let{disabled:t,index:n,node:r,rect:s}=e;const[i,a]=E.useState(null),o=E.useRef(n);return Hu(()=>{if(!t&&n!==o.current&&r.current){const l=s.current;if(l){const c=Nb(r.current,{ignoreTransform:!0}),u={x:l.left-c.left,y:l.top-c.top,scaleX:l.width/c.width,scaleY:l.height/c.height};(u.x||u.y)&&a(u)}}n!==o.current&&(o.current=n)},[t,n,r,s]),E.useEffect(()=>{i&&a(null)},[i]),i}function CYe(e){let{animateLayoutChanges:t=vYe,attributes:n,disabled:r,data:s,getNewIndex:i=bYe,id:a,strategy:o,resizeObserverConfig:l,transition:c=xYe}=e;const{items:u,containerId:d,activeIndex:h,disabled:m,disableTransforms:y,sortedRects:b,overIndex:v,useDragOverlay:x,strategy:w}=E.useContext(Jie),_=kYe(r,m),k=u.indexOf(a),C=E.useMemo(()=>({sortable:{containerId:d,index:k,items:u},...s}),[d,s,k,u]),T=E.useMemo(()=>u.slice(u.indexOf(a)),[u,a]),{rect:A,node:N,isOver:I,setNodeRef:j}=dYe({id:a,data:C,disabled:_.droppable,resizeObserverConfig:{updateMeasurementsFor:T,...l}}),{active:L,activatorEvent:D,activeNodeRect:H,attributes:O,setNodeRef:K,listeners:U,isDragging:W,over:B,setActivatorNodeRef:ne,transform:V}=oYe({id:a,data:C,attributes:{...SYe,...n},disabled:_.draggable}),Q=UGe(j,K),ee=!!L,re=ee&&!y&&EC(h)&&EC(v),de=!x&&W,me=de&&re?V:null,je=re?me??(o??w)({rects:b,activeNodeRect:H,activeIndex:h,overIndex:v,index:k}):null,Te=EC(h)&&EC(v)?i({id:a,items:u,activeIndex:h,overIndex:v}):k,_e=L==null?void 0:L.id,Ue=E.useRef({activeId:_e,items:u,newIndex:Te,containerId:d}),Qe=u!==Ue.current.items,We=t({active:L,containerId:d,isDragging:W,isSorting:ee,id:a,index:k,items:u,newIndex:Ue.current.newIndex,previousItems:Ue.current.items,previousContainerId:Ue.current.containerId,transition:c,wasDragging:Ue.current.activeId!=null}),Pe=_Ye({disabled:!We,index:k,node:N,rect:A});return E.useEffect(()=>{ee&&Ue.current.newIndex!==Te&&(Ue.current.newIndex=Te),d!==Ue.current.containerId&&(Ue.current.containerId=d),u!==Ue.current.items&&(Ue.current.items=u)},[ee,Te,d,u]),E.useEffect(()=>{if(_e===Ue.current.activeId)return;if(_e!=null&&Ue.current.activeId==null){Ue.current.activeId=_e;return}const ye=setTimeout(()=>{Ue.current.activeId=_e},50);return()=>clearTimeout(ye)},[_e]),{active:L,activeIndex:h,attributes:O,data:C,rect:A,index:k,newIndex:Te,items:u,isOver:I,isSorting:ee,isDragging:W,listeners:U,node:N,overIndex:v,over:B,setNodeRef:Q,setActivatorNodeRef:ne,setDroppableNodeRef:j,setDraggableNodeRef:K,transform:Pe??je,transition:Y()};function Y(){if(Pe||Qe&&Ue.current.newIndex===k)return wYe;if(!(de&&!C6(D)||!c)&&(ee||We))return u1.Transition.toString({...c,property:Qie})}}function kYe(e,t){var n,r;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(n=e==null?void 0:e.draggable)!=null?n:t.draggable,droppable:(r=e==null?void 0:e.droppable)!=null?r:t.droppable}}function Vk(e){if(!e)return!1;const t=e.data.current;return!!(t&&"sortable"in t&&typeof t.sortable=="object"&&"containerId"in t.sortable&&"items"in t.sortable&&"index"in t.sortable)}const EYe=[Hr.Down,Hr.Right,Hr.Up,Hr.Left],TYe=(e,t)=>{let{context:{active:n,collisionRect:r,droppableRects:s,droppableContainers:i,over:a,scrollableAncestors:o}}=t;if(EYe.includes(e.code)){if(e.preventDefault(),!n||!r)return;const l=[];i.getEnabled().forEach(d=>{if(!d||d!=null&&d.disabled)return;const h=s.get(d.id);if(h)switch(e.code){case Hr.Down:r.top<h.top&&l.push(d);break;case Hr.Up:r.top>h.top&&l.push(d);break;case Hr.Left:r.left>h.left&&l.push(d);break;case Hr.Right:r.left<h.left&&l.push(d);break}});const c=iKe({collisionRect:r,droppableRects:s,droppableContainers:l});let u=Fie(c,"id");if(u===(a==null?void 0:a.id)&&c.length>1&&(u=c[1].id),u!=null){const d=i.get(n.id),h=i.get(u),m=h?s.get(h.id):null,y=h==null?void 0:h.node.current;if(y&&m&&d&&h){const v=sA(y).some((T,A)=>o[A]!==T),x=eae(d,h),w=AYe(d,h),_=v||!x?{x:0,y:0}:{x:w?r.width-m.width:0,y:w?r.height-m.height:0},k={x:m.left,y:m.top};return _.x&&_.y?k:c1(k,_)}}}};function eae(e,t){return!Vk(e)||!Vk(t)?!1:e.data.current.sortable.containerId===t.data.current.sortable.containerId}function AYe(e,t){return!Vk(e)||!Vk(t)||!eae(e,t)?!1:e.data.current.sortable.index<t.data.current.sortable.index}const RYe=({id:e,modelDetails:t,buttonsDisabled:n,onMoveToTop:r,onMoveUp:s,onMoveDown:i,isFirst:a,isLast:o})=>{var C,T,A;const{attributes:l,listeners:c,setNodeRef:u,transform:d,transition:h,isDragging:m}=CYe({id:e,disabled:!1}),y={transform:u1.Transform.toString(d),transition:h,zIndex:m?10:void 0},b=new Set(((C=t.metadataSummary)==null?void 0:C.supported_parameters)??[]),v=new Set(((T=t.metadataSummary)==null?void 0:T.input_modalities)??[]),x=b.has("reasoning"),w=b.has("web_search")||b.has("web_search_options"),_=b.has("tools"),k=Array.from(v).some(N=>N!=="text");return f.jsxs("div",{ref:u,style:y,className:Ye("flex items-center space-x-2 p-2 rounded border border-transparent bg-muted/50 hover:bg-muted mb-1",m&&"shadow-lg border-primary bg-card","cursor-grab active:cursor-grabbing"),"aria-label":`Drag to reorder model ${t.name}`,children:[f.jsx("button",{...l,...c,type:"button",className:Ye("p-1 flex-shrink-0","hover:text-foreground"),"aria-hidden":"true",tabIndex:-1,children:f.jsx(uge,{className:"h-5 w-5 text-muted-foreground"})}),f.jsxs("div",{className:"flex-grow min-w-0",children:[f.jsxs(Nt,{className:Ye("text-sm font-normal text-foreground flex-grow truncate pointer-events-none"),children:[t.name," ",f.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",t.providerName,")"]})]}),f.jsxs("div",{className:"flex items-center gap-1 mt-0.5",children:[x&&f.jsx(Qy,{className:"h-3 w-3 text-blue-500"}),w&&f.jsx(vo,{className:"h-3 w-3 text-green-500"}),_&&f.jsx(Am,{className:"h-3 w-3 text-orange-500"}),k&&f.jsx(Mh,{className:"h-3 w-3 text-purple-500"})]})]}),f.jsxs("div",{className:"flex items-center gap-0.5 ml-auto flex-shrink-0",children:[((A=t.metadataSummary)==null?void 0:A.description)&&f.jsx(wr,{delayDuration:100,children:f.jsxs(Sr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx("span",{className:"p-1 text-muted-foreground hover:text-foreground cursor-default","aria-label":"Model information",children:f.jsx(tO,{className:"h-4 w-4"})})}),f.jsx(Cr,{side:"top",align:"end",className:"max-w-xs break-words",children:f.jsx("p",{children:t.metadataSummary.description})})]})}),f.jsx(Un,{tooltipText:"Move to Top",onClick:()=>r(e),disabled:a||n,icon:f.jsx(ume,{}),className:"h-6 w-6"}),f.jsx(Un,{tooltipText:"Move Up",onClick:()=>s(e),disabled:a||n,icon:f.jsx(Upe,{}),className:"h-6 w-6"}),f.jsx(Un,{tooltipText:"Move Down",onClick:()=>i(e),disabled:o||n,icon:f.jsx(DH,{}),className:"h-6 w-6"})]})]})},NYe=({setGlobalModelSortOrderFromModule:e})=>{const{dbProviderConfigs:t,globalModelSortOrder:n,isLoading:r,getAvailableModelListItems:s}=Gn(mn(_=>({dbProviderConfigs:_.dbProviderConfigs,globalModelSortOrder:_.globalModelSortOrder,isLoading:_.isLoading,getAvailableModelListItems:_.getAvailableModelListItems}))),[i,a]=E.useState(""),[o,l]=E.useState(()=>new Set(t.map(_=>_.id))),[c,u]=E.useState({reasoning:!1,webSearch:!1,tools:!1,multimodal:!1});E.useEffect(()=>{l(new Set(t.map(_=>_.id)))},[t]);const d=E.useMemo(()=>{const _=s(),k=new Map(_.map(I=>[I.id,I])),C=new Set;t.forEach(I=>{I.isEnabled&&I.enabledModels&&I.enabledModels.forEach(j=>{C.add(Px(I.id,j))})});const T=_.filter(I=>C.has(I.id)),A=[],N=new Set;return n.forEach(I=>{if(C.has(I)){const j=k.get(I);j&&!N.has(I)&&(A.push(j),N.add(I))}}),T.forEach(I=>{N.has(I.id)||A.push(I)}),A},[t,n,s]),h=E.useMemo(()=>{let _=d;if(o.size!==t.length&&(_=_.filter(C=>o.has(C.providerId))),i.trim()){const C=i.toLowerCase();_=_.filter(T=>T.name.toLowerCase().includes(C)||T.providerName.toLowerCase().includes(C)||T.id.toLowerCase().includes(C))}const k=Object.entries(c).filter(([,C])=>C).map(([C])=>C);return k.length>0&&(_=_.filter(C=>{var N,I;const T=new Set(((N=C.metadataSummary)==null?void 0:N.supported_parameters)??[]),A=new Set(((I=C.metadataSummary)==null?void 0:I.input_modalities)??[]);return k.every(j=>{switch(j){case"reasoning":return T.has("reasoning");case"webSearch":return T.has("web_search")||T.has("web_search_options");case"tools":return T.has("tools");case"multimodal":return Array.from(A).some(L=>L!=="text");default:return!0}})})),_},[d,i,o,t.length,c]),m=E.useMemo(()=>i.trim().length>0||o.size!==t.length||Object.values(c).some(Boolean),[i,o,t.length,c]),y=E.useMemo(()=>{const _=o.size!==t.length?1:0,k=Object.values(c).filter(Boolean).length;return _+k},[o,t.length,c]),b=E.useMemo(()=>h.map(_=>_.id),[h]),v=E.useCallback(_=>{const{active:k,over:C}=_;if(C&&k.id!==C.id){const T=d.map(L=>L.id),A=k.id,N=C.id,I=T.indexOf(A),j=T.indexOf(N);if(I!==-1&&j!==-1){const L=Yx(T,I,j);e(L)}else console.warn("DND: Could not find dragged items in the full model order. This might happen if the underlying list changed during drag or items are filtered out.")}},[d,e]),x=E.useCallback((_,k)=>{if(m)return;const C=d.map(N=>N.id),T=C.indexOf(_);if(T===-1)return;let A;if(k==="top"){if(T===0)return;const N=C.splice(T,1)[0];C.unshift(N),A=C}else if(k==="up"){if(T===0)return;A=Yx(C,T,T-1)}else{if(T===C.length-1)return;A=Yx(C,T,T+1)}e(A)},[d,e,m]),w=nKe(uV(A6),uV(E6,{coordinateGetter:TYe}));return r?f.jsxs("div",{className:"space-y-4 border border-border rounded-lg p-4 bg-card shadow-sm",children:[f.jsx(Gr,{className:"h-8 w-1/3"}),f.jsx(Gr,{className:"h-6 w-1/2"}),f.jsx(Gr,{className:"h-64 w-full"})]}):f.jsxs("div",{className:"space-y-4 border border-border rounded-lg p-4 bg-card shadow-sm",children:[f.jsx("h3",{className:"text-lg font-semibold text-card-foreground",children:"Global Model Order"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Drag and drop the globally enabled models to define their display order. Filtering affects the view below. Move buttons (up/down/top) are disabled when filters are active."}),f.jsx(zm,{}),f.jsxs("div",{className:"space-y-3",children:[f.jsx(Nt,{className:"text-base font-medium text-card-foreground",children:"Enabled & Ordered Models"}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsxs("div",{className:"relative flex-grow",children:[f.jsx(vo,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),f.jsx(vn,{type:"search",placeholder:"Filter models by name or provider...",value:i,onChange:_=>a(_.target.value),className:"pl-8 w-full h-9",disabled:r})]}),f.jsx(QF,{currentCapabilityFilters:c,onCapabilityFilterChange:u,currentSelectedProviders:o,onProviderFilterChange:l,allProviders:t,showProviderFilter:!0,showCapabilityFilters:!0,disabled:r||t.length===0,totalActiveFilters:y})]}),f.jsx("div",{className:"w-full rounded-md border border-border p-3 bg-background/50",children:h.length>0?f.jsx(sYe,{sensors:w,collisionDetection:sKe,onDragEnd:v,children:f.jsx(yYe,{items:b,strategy:mYe,children:h.map(_=>f.jsx(RYe,{id:_.id,modelDetails:_,onMoveToTop:()=>x(_.id,"top"),onMoveUp:()=>x(_.id,"up"),onMoveDown:()=>x(_.id,"down"),isFirst:d.findIndex(k=>k.id===_.id)===0,isLast:d.findIndex(k=>k.id===_.id)===d.length-1,buttonsDisabled:m},_.id))})}):f.jsx("div",{className:"flex items-center justify-center h-full text-sm text-muted-foreground",children:m?"No models match your filters.":"No models enabled globally. Enable models within provider configurations."})})]})]})},AC=e=>{if(!e)return"N/A";const t=parseFloat(e);return isNaN(t)?"N/A":`$${(t/1e3).toFixed(4)} / 1K tokens`},Ul=(e,t,n=!1,r="secondary")=>t==null||String(t).trim()===""?null:f.jsxs(As,{children:[f.jsx(Bn,{className:"font-medium text-xs w-1/3 py-1.5 px-3",children:e}),f.jsx(Bn,{className:"text-xs py-1.5 px-3 break-all",children:n?f.jsx(as,{variant:r,className:"text-xs",children:String(t)}):Array.isArray(t)?f.jsx("div",{className:"flex flex-wrap gap-1",children:t.map((s,i)=>f.jsx(as,{variant:"outline",className:"text-xs",children:String(s)},i))}):String(t)})]}),IYe=({modelId:e})=>{var m,y,b,v,x,w,_,k,C,T,A,N;const{createAiModelConfig:t,dbProviderConfigs:n,dbApiKeys:r,updateProviderConfig:s,isLoading:i}=Gn(mn(I=>({createAiModelConfig:I.createAiModelConfig,dbProviderConfigs:I.dbProviderConfigs,dbApiKeys:I.dbApiKeys,updateProviderConfig:I.updateProviderConfig,isLoading:I.isLoading}))),a=E.useMemo(()=>{if(!e)return;const{providerId:I,modelId:j}=Ql(e);if(!I||!j)return;const L=n.find(H=>H.id===I);if(!L)return;const D=r.find(H=>H.id===L.apiKeyId);return t(L,j,D==null?void 0:D.value)},[e,n,r,t]),o=a==null?void 0:a.metadata,l=E.useCallback(async()=>{if(!a||!e)return;const{providerId:I,modelId:j}=Ql(e);if(!I||!j)return;const L=n.find(K=>K.id===I);if(!L){ke.error("Provider configuration not found.");return}const D=new Set(L.enabledModels??[]),H=D.has(j);H?D.delete(j):D.add(j);const O=Array.from(D);try{await s(L.id,{enabledModels:O}),ke.success(`Model "${a.name}" ${H?"disabled":"enabled"}.`)}catch{ke.error("Failed to update model status.")}},[a,e,n,s]);if(i)return f.jsxs("div",{className:"space-y-4 p-1 h-full flex flex-col",children:[f.jsx(Gr,{className:"h-8 w-3/4 flex-shrink-0"}),f.jsx(Gr,{className:"h-4 w-1/2 flex-shrink-0"}),f.jsxs("div",{className:"flex-grow space-y-2",children:[f.jsx(Gr,{className:"h-10 w-full"}),f.jsx(Gr,{className:"h-10 w-full"}),f.jsx(Gr,{className:"h-10 w-full"}),f.jsx(Gr,{className:"h-10 w-full"})]})]});if(!e)return f.jsxs("div",{className:"p-4 text-center text-muted-foreground h-full flex flex-col items-center justify-center",children:[f.jsx(Sl,{className:"mx-auto h-10 w-10 mb-2 text-amber-500"}),f.jsx("p",{className:"text-sm",children:'No model selected. Click a model in the "Configuration" or "Browse Models" tab to view its details.'})]});if(!a||!o)return f.jsxs("div",{className:"p-4 text-center text-destructive h-full flex flex-col items-center justify-center",children:[f.jsx(Sl,{className:"mx-auto h-10 w-10 mb-2"}),f.jsxs("p",{className:"text-sm",children:["Details not available for model: ",e,". It might be misconfigured or no longer available."]})]});const{providerId:c,modelId:u}=Ql(e),d=n.find(I=>I.id===c),h=u!=null&&(d==null?void 0:d.isEnabled)&&((m=d==null?void 0:d.enabledModels)==null?void 0:m.includes(u))===!0;return f.jsxs("div",{className:"space-y-4 p-1 h-full flex flex-col",children:[f.jsxs("div",{className:"flex items-center justify-between flex-shrink-0",children:[f.jsxs("h4",{className:"text-lg font-semibold text-card-foreground truncate",children:[a.name,f.jsxs("span",{className:"text-sm text-muted-foreground ml-2",children:["(",a.providerName,")"]})]}),f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(Nt,{htmlFor:`enable-details-${u}`,className:"text-xs",children:h?"Enabled":"Disabled"}),f.jsx(fo,{id:`enable-details-${u}`,checked:h,onCheckedChange:l,disabled:!(d!=null&&d.isEnabled),"aria-label":`Enable model ${a.name}`})]})]}),o.description&&f.jsx("p",{className:"text-xs text-muted-foreground flex-shrink-0",children:o.description}),f.jsx(Xo,{className:"flex-grow border rounded-md bg-background/30",children:f.jsxs(Sf,{children:[f.jsxs(GUe,{className:"py-2 text-xs",children:["Model ID: ",o.id]}),f.jsxs(_f,{children:[Ul("Context Length",((y=o.top_provider)==null?void 0:y.context_length)??o.context_length),Ul("Max Completion Tokens",(b=o.top_provider)==null?void 0:b.max_completion_tokens),Ul("Input Modalities",(v=o.architecture)==null?void 0:v.input_modalities),Ul("Output Modalities",(x=o.architecture)==null?void 0:x.output_modalities),Ul("Tokenizer",(w=o.architecture)==null?void 0:w.tokenizer,!0),Ul("Instruct Type",(_=o.architecture)==null?void 0:_.instruct_type,!0),Ul("Pricing (Prompt)",AC((k=o.pricing)==null?void 0:k.prompt)),Ul("Pricing (Completion)",AC((C=o.pricing)==null?void 0:C.completion)),Ul("Pricing (Image)",AC((T=o.pricing)==null?void 0:T.image)),Ul("Pricing (Request)",AC((A=o.pricing)==null?void 0:A.request)),Ul("Supported Parameters",o.supported_parameters),Ul("Moderated",(N=o.top_provider)!=null&&N.is_moderated?f.jsx(C1,{className:"h-4 w-4 text-green-500"}):"No")]})]})})]})},MYe=()=>{const{apiKeys:e,addApiKey:t,deleteApiKey:n,isLoading:r}=Gn(mn(h=>({apiKeys:h.dbApiKeys,addApiKey:h.addApiKey,deleteApiKey:h.deleteApiKey,isLoading:h.isLoading}))),[s,i]=E.useState(!1),[a,o]=E.useState(!1),[l,c]=E.useState({}),u=E.useCallback(async(h,m,y)=>{o(!0);try{await t(h,m,y),i(!1)}catch(b){console.error("Failed to add API key (from component):",b)}finally{o(!1)}},[t]),d=E.useCallback(async(h,m)=>{if(window.confirm(`Are you sure you want to delete the API key "${m}"? This will unlink it from any providers using it.`)){c(y=>({...y,[h]:!0}));try{await n(h)}catch(y){console.error("Failed to delete API key (from component):",y)}finally{c(y=>({...y,[h]:!1}))}}},[n]);return f.jsxs("div",{className:"space-y-6 p-1",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"text-lg font-medium",children:"API Key Management"}),f.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Manage API keys for different providers. Keys are stored securely in your browser's local storage and never sent to any server other than the intended AI provider."})]}),!s&&f.jsxs(ot,{onClick:()=>i(!0),variant:"outline",className:"w-full mb-4",disabled:r,children:[f.jsx(nc,{className:"h-4 w-4 mr-1"})," Add New API Key"]}),s&&f.jsxs("div",{className:"border rounded-md p-4 space-y-3 bg-card shadow-md mb-4",children:[f.jsx("h4",{className:"font-semibold text-card-foreground",children:"Add New Key"}),f.jsx(cre,{onSave:u,onCancel:()=>i(!1),disabled:a})]}),f.jsxs("div",{children:[f.jsx("h4",{className:"text-md font-medium mb-2",children:"Stored API Keys"}),r&&!s?f.jsxs("div",{className:"space-y-2",children:[f.jsx(Gr,{className:"h-10 w-full"}),f.jsx(Gr,{className:"h-10 w-full"})]}):(e||[]).length===0&&!s?f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No API keys stored yet."}):f.jsx("div",{className:"border rounded-md overflow-hidden",children:f.jsxs(Sf,{children:[f.jsx(vp,{children:f.jsxs(As,{children:[f.jsx(Rr,{children:"Name"}),f.jsx(Rr,{children:"Provider Type"}),f.jsx(Rr,{children:"Created"}),f.jsx(Rr,{className:"text-right",children:"Actions"})]})}),f.jsx(_f,{children:(e||[]).map(h=>{const m=l[h.id];return f.jsxs(As,{className:m?"opacity-50":"",children:[f.jsx(Bn,{className:"font-medium",children:h.name||"Unnamed Key"}),f.jsx(Bn,{children:h.providerId||"Unknown"}),f.jsx(Bn,{className:"text-xs text-muted-foreground",children:Vd(new Date(h.createdAt),"PPp")}),f.jsx(Bn,{className:"text-right",children:f.jsx(Un,{tooltipText:"Delete Key",onClick:()=>d(h.id,h.name||"Unnamed Key"),disabled:m,"aria-label":`Delete key ${h.name||"Unnamed Key"}`,icon:m?f.jsx(Hn,{className:"h-4 w-4 animate-spin"}):f.jsx(Vo,{}),className:"text-destructive hover:text-destructive/80 h-8 w-8"})})]},h.id)})})]})})]})]})},jYe=Ve.memo(MYe),PYe=({onSelectModelForDetails:e})=>{const[t,n]=E.useState(null),[r,s]=E.useState(null),i=E.useCallback(C=>{if(C){n(C);const T=C.querySelector("[data-radix-scroll-area-viewport]");if(T)s(T);else{const A=new MutationObserver(()=>{const N=C.querySelector("[data-radix-scroll-area-viewport]");N&&(s(N),A.disconnect())});return A.observe(C,{childList:!0,subtree:!0}),()=>A.disconnect()}}else n(null),s(null)},[]),{getAvailableModelListItems:a,isLoading:o,dbProviderConfigs:l}=Gn(mn(C=>({getAvailableModelListItems:C.getAvailableModelListItems,isLoading:C.isLoading,dbProviderConfigs:C.dbProviderConfigs}))),[c,u]=E.useState(""),[d,h]=E.useState(()=>new Set(l.map(C=>C.id))),[m,y]=E.useState({reasoning:!1,webSearch:!1,tools:!1,multimodal:!1}),b=E.useMemo(()=>a(),[a]);E.useEffect(()=>{h(new Set(l.map(C=>C.id)))},[l]);const v=E.useMemo(()=>{let C=b;if(d.size!==l.length&&(C=C.filter(A=>d.has(A.providerId))),c.trim()){const A=c.toLowerCase();C=C.filter(N=>N.name.toLowerCase().includes(A)||N.providerName.toLowerCase().includes(A)||N.id.toLowerCase().includes(A))}const T=Object.entries(m).filter(([,A])=>A).map(([A])=>A);return T.length>0&&(C=C.filter(A=>{var j,L;const N=new Set(((j=A.metadataSummary)==null?void 0:j.supported_parameters)??[]),I=new Set(((L=A.metadataSummary)==null?void 0:L.input_modalities)??[]);return T.every(D=>{switch(D){case"reasoning":return N.has("reasoning");case"webSearch":return N.has("web_search")||N.has("web_search_options");case"tools":return N.has("tools");case"multimodal":return Array.from(I).some(H=>H!=="text");default:return!0}})})),C.sort((A,N)=>{const I=A.providerName.localeCompare(N.providerName);return I!==0?I:A.name.localeCompare(N.name)})},[b,c,d,l.length,m]),x=JF({count:v.length,getScrollElement:()=>r,estimateSize:()=>48,overscan:10}),w=E.useCallback(C=>{e(C)},[e]),_=E.useCallback(C=>{y(C)},[]),k=E.useMemo(()=>(d.size!==l.length?1:0)+Object.values(m).filter(Boolean).length,[d,l.length,m]);return o?f.jsxs("div",{className:"space-y-2 h-full flex flex-col",children:[f.jsx(Gr,{className:"h-9 w-full flex-shrink-0"}),f.jsx(Gr,{className:"h-full w-full flex-grow"})]}):f.jsxs("div",{className:"space-y-3 h-full flex flex-col",children:[f.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[f.jsxs("div",{className:"relative flex-grow",children:[f.jsx(vo,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),f.jsx(vn,{type:"search",placeholder:"Filter models by name or provider...",value:c,onChange:C=>u(C.target.value),className:"pl-8 w-full h-9",disabled:o})]}),f.jsx(QF,{currentCapabilityFilters:m,onCapabilityFilterChange:_,currentSelectedProviders:d,onProviderFilterChange:h,allProviders:l,showProviderFilter:!0,showCapabilityFilters:!0,disabled:o||l.length===0,totalActiveFilters:k})]}),f.jsxs(Xo,{className:"flex-grow border rounded-md bg-background/50 h-[calc(15*2.5rem+2px)]",ref:i,children:[r&&f.jsx("div",{style:{height:`${x.getTotalSize()}px`,width:"100%",position:"relative"},children:v.length===0&&!o?f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4 absolute inset-0 flex items-center justify-center",children:"No models match your filters."}):x.getVirtualItems().map(C=>{var A;const T=v[C.index];return T?f.jsx("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:`${C.size}px`,transform:`translateY(${C.start}px)`},className:"p-1",children:f.jsx(wr,{delayDuration:300,children:f.jsxs(Sr,{children:[f.jsx(_r,{asChild:!0,children:f.jsxs("button",{className:"w-full text-left p-1.5 rounded hover:bg-muted/50 flex flex-col",onClick:()=>w(T.id),children:[f.jsx("span",{className:"text-sm font-medium truncate",children:T.name}),f.jsx("span",{className:"text-xs text-muted-foreground truncate",children:T.providerName})]})}),((A=T.metadataSummary)==null?void 0:A.description)&&f.jsx(Cr,{side:"bottom",align:"start",className:"max-w-xs",children:f.jsx("p",{children:T.metadataSummary.description})})]})})},T.id):null})}),!r&&!o&&f.jsx("div",{className:"flex items-center justify-center h-full text-muted-foreground",children:"Initializing list..."})]})]})},OYe=({onSelectModelForDetails:e})=>{const{addDbProviderConfig:t,updateDbProviderConfig:n,deleteDbProviderConfig:r,fetchModels:s,providerFetchStatus:i,dbProviderConfigs:a,apiKeys:o,isLoading:l}=Gn(mn(b=>({addDbProviderConfig:b.addProviderConfig,updateDbProviderConfig:b.updateProviderConfig,deleteDbProviderConfig:b.deleteProviderConfig,fetchModels:b.fetchModels,providerFetchStatus:b.providerFetchStatus,dbProviderConfigs:b.dbProviderConfigs,apiKeys:b.dbApiKeys,isLoading:b.isLoading}))),[c,u]=E.useState(!1),d=()=>u(!0),h=E.useCallback(()=>u(!1),[]),m=E.useCallback(async b=>{await s(b)},[s]),y=E.useMemo(()=>a||[],[a]);return f.jsxs("div",{className:"space-y-6 h-full flex flex-col",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"text-lg font-semibold text-card-foreground",children:"Provider Configuration"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Add, remove, or configure connections to AI providers. Enable models within each provider's edit section. Click a model name to view its details."})]}),f.jsx("div",{className:"flex-shrink-0",children:c?f.jsx(dre,{apiKeys:o||[],onAddProvider:t,onCancel:h}):f.jsxs(ot,{onClick:d,variant:"outline",className:"w-full",disabled:l,children:[f.jsx(nc,{className:"h-4 w-4 mr-1"})," Add Provider Configuration"]})}),f.jsx("div",{className:"flex-grow border-t border-border pt-4 mt-4 overflow-y-auto",children:f.jsxs("div",{className:"space-y-2",children:[l&&!c?f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:[f.jsx(Gr,{className:"h-24 w-full"}),f.jsx(Gr,{className:"h-24 w-full"}),f.jsx(Gr,{className:"h-24 w-full"})]}):f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:y.map(b=>f.jsx(zGe,{provider:b,apiKeys:o||[],onUpdate:n,onDelete:r,onFetchModels:m,fetchStatus:i[b.id]||"idle",onSelectModelForDetails:e},b.id))}),!l&&y.length===0&&!c&&f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:'No providers configured yet. Click "Add Provider Configuration" above.'})]})})]})},DYe=({setGlobalModelSortOrderFromModule:e})=>{const{selectedModelForDetails:t,setSelectedModelForDetails:n}=Gn(mn(o=>({selectedModelForDetails:o._selectedModelForDetails,setSelectedModelForDetails:o.setSelectedModelForDetails}))),[r,s]=E.useState("providers-config"),i=E.useCallback(o=>{n(o),o&&s("providers-details-current")},[n,s]),a=E.useMemo(()=>[{value:"providers-config",label:"Configuration",content:f.jsx(OYe,{onSelectModelForDetails:i})},{value:"providers-order",label:"Model Order",content:f.jsx(NYe,{setGlobalModelSortOrderFromModule:e})},{value:"api-keys",label:"API Keys",content:f.jsx(jYe,{})},{value:"providers-details-current",label:"Selected Model",content:f.jsx(IYe,{modelId:t})},{value:"providers-browse-all",label:"Browse Models",content:f.jsx(PYe,{onSelectModelForDetails:i}),scrollable:!1}],[t,i,e]);return f.jsx(Tl,{tabs:a,initialValue:r,onValueChange:s,className:"h-full",listClassName:"bg-muted/50 rounded-md",contentContainerClassName:"mt-4"})},FYe=Ve.memo(DYe);class LYe{constructor(){ce(this,"id","core-provider-settings");ce(this,"modApiRef",null);ce(this,"eventUnsubscribers",[]);ce(this,"setGlobalModelSortOrderFromModule",t=>{var n;(n=this.modApiRef)==null||n.emit(Vn.setGlobalModelSortOrderRequest,{ids:t})})}async initialize(t){this.modApiRef=t}register(t){this.modApiRef=t,t.registerSettingsTab({id:"providers",title:"Providers & Models",order:20,component:()=>Ve.createElement(FYe,{setGlobalModelSortOrderFromModule:this.setGlobalModelSortOrderFromModule})})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.modApiRef=null}}const BYe=Ke({globalSystemPrompt:$e()});function $Ye({field:e}){return f.jsx(f.Fragment,{children:e.state.meta.isTouched&&e.state.meta.errors.length>0?f.jsx("em",{className:"text-xs text-destructive mt-1 block",children:e.state.meta.errors.join(", ")}):null})}const zYe=()=>{const{globalSystemPrompt:e,setGlobalSystemPrompt:t}=pr(mn(r=>({globalSystemPrompt:r.globalSystemPrompt,setGlobalSystemPrompt:r.setGlobalSystemPrompt}))),n=ai({defaultValues:{globalSystemPrompt:e??""},validators:{onChangeAsync:BYe,onChangeAsyncDebounceMs:500},onSubmit:async({value:r})=>{try{t(r.globalSystemPrompt),ke.success("Global system prompt updated!")}catch(s){ke.error("Failed to update prompt. Please try again."),console.error("Error submitting assistant prompt form:",s)}}});return E.useEffect(()=>{n.state.values.globalSystemPrompt!==(e??"")&&n.reset({globalSystemPrompt:e??""})},[e,n]),f.jsxs("form",{onSubmit:r=>{r.preventDefault(),r.stopPropagation(),n.handleSubmit()},className:"space-y-3",children:[f.jsx("div",{children:f.jsx(n.Field,{name:"globalSystemPrompt",children:r=>f.jsxs(f.Fragment,{children:[f.jsx(Nt,{htmlFor:r.name,className:"text-sm mb-1 block",children:"Global System Prompt"}),f.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"Default instructions for the assistant. Can be overridden per-project."}),f.jsx(Ci,{id:r.name,placeholder:"Enter default system instructions for the assistant...",value:r.state.value,onBlur:r.handleBlur,onChange:s=>r.handleChange(s.target.value),rows:6,className:r.state.meta.errors.length?"border-destructive":""}),f.jsx($Ye,{field:r})]})})}),f.jsx("div",{className:"flex justify-end pt-2",children:f.jsx(n.Subscribe,{selector:r=>[r.canSubmit,r.isSubmitting,r.isValidating,r.isValid],children:([r,s,i,a])=>f.jsx(ot,{type:"submit",size:"sm",disabled:!r||s||i||!a,children:s?"Saving...":i?"Validating...":"Save Prompt"})})})]})},UYe=Ke({temperature:Tt().min(0).max(1),topP:Tt().min(0).max(1),maxTokens:Tt().min(1).nullable(),topK:Tt().min(1).nullable(),presencePenalty:Tt().min(-2).max(2),frequencyPenalty:Tt().min(-2).max(2)}),qYe=()=>{const e=pr(mn(n=>({temperature:n.temperature,setTemperature:n.setTemperature,topP:n.topP,setTopP:n.setTopP,maxTokens:n.maxTokens,setMaxTokens:n.setMaxTokens,topK:n.topK,setTopK:n.setTopK,presencePenalty:n.presencePenalty,setPresencePenalty:n.setPresencePenalty,frequencyPenalty:n.frequencyPenalty,setFrequencyPenalty:n.setFrequencyPenalty}))),t=ai({defaultValues:{temperature:e.temperature??.7,topP:e.topP??1,maxTokens:e.maxTokens??null,topK:e.topK??null,presencePenalty:e.presencePenalty??0,frequencyPenalty:e.frequencyPenalty??0},validators:{onChangeAsync:UYe,onChangeAsyncDebounceMs:500},onSubmit:async({value:n})=>{try{e.setTemperature(n.temperature),e.setTopP(n.topP),e.setMaxTokens(n.maxTokens??null),e.setTopK(n.topK??null),e.setPresencePenalty(n.presencePenalty),e.setFrequencyPenalty(n.frequencyPenalty),ke.success("Assistant parameters updated!")}catch(r){ke.error("Failed to update parameters."),console.error("Error submitting parameters form:",r)}}});return E.useEffect(()=>{t.reset({temperature:e.temperature??.7,topP:e.topP??1,maxTokens:e.maxTokens??null,topK:e.topK??null,presencePenalty:e.presencePenalty??0,frequencyPenalty:e.frequencyPenalty??0})},[e.temperature,e.topP,e.maxTokens,e.topK,e.presencePenalty,e.frequencyPenalty,t]),f.jsxs("form",{onSubmit:n=>{n.preventDefault(),n.stopPropagation(),t.handleSubmit()},className:"space-y-4",children:[f.jsx("p",{className:"text-xs text-muted-foreground mb-3",children:"Set the default global values for AI parameters. These can be overridden per-project or per-prompt turn."}),f.jsx(Oc,{form:t,name:"temperature",label:"Temperature",min:0,max:1,step:.01,valueDisplayPrecision:2,wrapperClassName:"space-y-1.5"}),f.jsx(Oc,{form:t,name:"topP",label:"Top P",min:0,max:1,step:.01,valueDisplayPrecision:2,wrapperClassName:"space-y-1.5"}),f.jsxs("div",{className:"grid grid-cols-2 gap-4 items-end",children:[f.jsx(Ly,{form:t,name:"maxTokens",label:"Max Tokens",placeholder:"Default (None)",min:1,className:"h-9 text-sm",allowNull:!0,wrapperClassName:"space-y-1.5"}),f.jsx(Ly,{form:t,name:"topK",label:"Top K",placeholder:"Default (None)",min:1,className:"h-9 text-sm",allowNull:!0,wrapperClassName:"space-y-1.5"})]}),f.jsx(Oc,{form:t,name:"presencePenalty",label:"Presence Penalty",min:-2,max:2,step:.01,valueDisplayPrecision:2,wrapperClassName:"space-y-1.5"}),f.jsx(Oc,{form:t,name:"frequencyPenalty",label:"Frequency Penalty",min:-2,max:2,step:.01,valueDisplayPrecision:2,wrapperClassName:"space-y-1.5"}),f.jsxs("div",{className:"flex justify-end space-x-2",children:[f.jsx(ot,{type:"button",variant:"ghost",onClick:()=>t.reset(),disabled:!t.state.isDirty,children:"Reset"}),f.jsx(t.Subscribe,{selector:n=>[n.canSubmit,n.isSubmitting],children:([n,r])=>f.jsx(ot,{type:"submit",disabled:!n||r,children:r?"Saving...":"Save Changes"})})]})]})},VYe=Ke({toolMaxSteps:Tt({required_error:"Max steps is required",invalid_type_error:"Max steps must be a number"}).min(1,"Must be at least 1").max(20,"Cannot exceed 20")});function WYe({field:e}){return f.jsx(f.Fragment,{children:e.state.meta.isTouched&&e.state.meta.errors.length>0?f.jsx("em",{className:"text-xs text-destructive mt-1 block",children:e.state.meta.errors.join(", ")}):null})}const HYe=()=>{const{toolMaxSteps:e,setToolMaxSteps:t}=pr(mn(r=>({toolMaxSteps:r.toolMaxSteps,setToolMaxSteps:r.setToolMaxSteps}))),n=ai({defaultValues:{toolMaxSteps:e??5},validators:{onChangeAsync:VYe,onChangeAsyncDebounceMs:500},onSubmit:async({value:r})=>{try{t(r.toolMaxSteps),ke.success("Tool settings updated!")}catch(s){ke.error("Failed to update tool settings."),console.error("Error submitting tool settings form:",s)}}});return E.useEffect(()=>{n.state.values.toolMaxSteps!==(e??5)&&n.reset({toolMaxSteps:e??5})},[e,n]),f.jsxs("form",{onSubmit:r=>{r.preventDefault(),r.stopPropagation(),n.handleSubmit()},className:"space-y-3",children:[f.jsx(n.Field,{name:"toolMaxSteps",children:r=>f.jsxs("div",{children:[f.jsx(Nt,{htmlFor:r.name,className:"text-sm mb-1 block",children:"Maximum Tool Steps per Turn"}),f.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"Limits the number of sequential tool calls the AI can make before generating a final response (1-20). Higher values allow more complex tasks but increase latency and cost. (Default: 5)"}),f.jsx(vn,{id:r.name,type:"number",min:1,max:20,step:1,value:r.state.value,onBlur:r.handleBlur,onChange:s=>{const i=s.target.valueAsNumber;isNaN(i)?s.target.value===""&&r.handleChange(void 0):r.handleChange(i)},className:`w-24 ${r.state.meta.errors.length?"border-destructive":""}`}),f.jsx(WYe,{field:r})]})}),f.jsx("div",{className:"flex justify-end pt-2",children:f.jsx(n.Subscribe,{selector:r=>[r.canSubmit,r.isSubmitting,r.isValidating,r.isValid],children:([r,s,i,a])=>f.jsx(ot,{type:"submit",size:"sm",disabled:!r||s||i||!a,children:s?"Saving...":i?"Validating...":"Save Tool Settings"})})})]})},GYe=Ke({autoTitleEnabled:Qn(),autoTitleModelId:$e().nullable(),autoTitlePromptMaxLength:Tt().min(100).max(4e3),autoTitleIncludeFiles:Qn(),autoTitleIncludeRules:Qn()});function Qv({field:e}){return f.jsx(f.Fragment,{children:e.state.meta.isTouched&&e.state.meta.errors.length>0?f.jsx("em",{className:"text-xs text-destructive mt-1 block",children:e.state.meta.errors.join(", ")}):null})}const KYe=()=>{const e=pr(mn(n=>({autoTitleEnabled:n.autoTitleEnabled,setAutoTitleEnabled:n.setAutoTitleEnabled,autoTitleModelId:n.autoTitleModelId,setAutoTitleModelId:n.setAutoTitleModelId,autoTitlePromptMaxLength:n.autoTitlePromptMaxLength,setAutoTitlePromptMaxLength:n.setAutoTitlePromptMaxLength,autoTitleIncludeFiles:n.autoTitleIncludeFiles,setAutoTitleIncludeFiles:n.setAutoTitleIncludeFiles,autoTitleIncludeRules:n.autoTitleIncludeRules,setAutoTitleIncludeRules:n.setAutoTitleIncludeRules}))),t=ai({defaultValues:{autoTitleEnabled:e.autoTitleEnabled??!1,autoTitleModelId:e.autoTitleModelId??null,autoTitlePromptMaxLength:e.autoTitlePromptMaxLength??768,autoTitleIncludeFiles:e.autoTitleIncludeFiles??!1,autoTitleIncludeRules:e.autoTitleIncludeRules??!1},validators:{onChangeAsync:GYe,onChangeAsyncDebounceMs:500},onSubmit:async({value:n})=>{try{e.setAutoTitleEnabled(n.autoTitleEnabled),e.setAutoTitleModelId(n.autoTitleModelId??null),e.setAutoTitlePromptMaxLength(n.autoTitlePromptMaxLength),e.setAutoTitleIncludeFiles(n.autoTitleIncludeFiles),e.setAutoTitleIncludeRules(n.autoTitleIncludeRules),ke.success("Auto-title settings updated!")}catch(r){ke.error("Failed to update auto-title settings."),console.error("Error submitting auto-title settings form:",r)}}});return E.useEffect(()=>{t.reset({autoTitleEnabled:e.autoTitleEnabled??!1,autoTitleModelId:e.autoTitleModelId??null,autoTitlePromptMaxLength:e.autoTitlePromptMaxLength??768,autoTitleIncludeFiles:e.autoTitleIncludeFiles??!1,autoTitleIncludeRules:e.autoTitleIncludeRules??!1})},[e.autoTitleEnabled,e.autoTitleModelId,e.autoTitlePromptMaxLength,e.autoTitleIncludeFiles,e.autoTitleIncludeRules,t]),f.jsxs("form",{onSubmit:n=>{n.preventDefault(),n.stopPropagation(),t.handleSubmit()},className:"space-y-3",children:[f.jsx(t.Field,{name:"autoTitleEnabled",children:n=>f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(fo,{id:n.name,checked:n.state.value,onCheckedChange:n.handleChange,onBlur:n.handleBlur,"aria-labelledby":`${n.name}-label`}),f.jsx(Nt,{id:`${n.name}-label`,htmlFor:n.name,children:"Enable Auto-Title Generation"}),f.jsx(Qv,{field:n})]})}),t.state.values.autoTitleEnabled&&f.jsxs("div",{className:"space-y-3 pl-6 border-l-2 border-muted",children:[f.jsx(t.Field,{name:"autoTitleModelId",children:n=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(Nt,{htmlFor:n.name,children:"Model for Title Generation"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Choose which model to use for generating conversation titles. Uses global default model if not specified."}),f.jsx(v6,{value:n.state.value,onChange:r=>n.handleChange(r),className:"w-full"}),f.jsx(Qv,{field:n})]})}),f.jsx(t.Field,{name:"autoTitlePromptMaxLength",children:n=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(Nt,{htmlFor:n.name,children:"Conversation Content Length Limit"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Maximum characters from conversation to include in title generation prompt (100-4000)."}),f.jsx(vn,{id:n.name,type:"number",min:100,max:4e3,step:1,value:n.state.value,onBlur:n.handleBlur,onChange:r=>{const s=r.target.valueAsNumber;isNaN(s)||n.handleChange(s)},className:`w-32 ${n.state.meta.errors.length?"border-destructive":""}`}),f.jsx(Qv,{field:n})]})}),f.jsx(t.Field,{name:"autoTitleIncludeFiles",children:n=>f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(fo,{id:n.name,checked:n.state.value,onCheckedChange:n.handleChange,onBlur:n.handleBlur,"aria-labelledby":`${n.name}-label`}),f.jsx(Nt,{id:`${n.name}-label`,htmlFor:n.name,children:"Include file context in title prompt"}),f.jsx(Qv,{field:n})]})}),f.jsx(t.Field,{name:"autoTitleIncludeRules",children:n=>f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(fo,{id:n.name,checked:n.state.value,onCheckedChange:n.handleChange,onBlur:n.handleBlur,"aria-labelledby":`${n.name}-label`}),f.jsx(Nt,{id:`${n.name}-label`,htmlFor:n.name,children:"Include active rules in title prompt"}),f.jsx(Qv,{field:n})]})})]}),f.jsx("div",{className:"flex justify-end pt-2",children:f.jsx(t.Subscribe,{selector:n=>[n.canSubmit,n.isSubmitting,n.isValidating,n.isValid],children:([n,r,s,i])=>f.jsx(ot,{type:"submit",size:"sm",disabled:!n||r||s||!i,children:r?"Saving...":s?"Validating...":"Save Title Settings"})})})]})},YYe=({selectedTools:e,onToolsChange:t,className:n,disabled:r=!1,maxSteps:s,onMaxStepsChange:i,globalDefaultMaxSteps:a=5,showMaxSteps:o=!1})=>{const l=E.useMemo(()=>new Set(e),[e]),c=E.useCallback((d,h)=>{const m=h?[...e,d]:e.filter(y=>y!==d);t(m)},[e,t]),u=E.useCallback((d,h)=>{t(d?h:[])},[t]);return f.jsx(lie,{enabledTools:l,onToggleTool:c,onToggleAll:u,disabled:r,className:n,maxSteps:s,onMaxStepsChange:i,globalDefaultMaxSteps:a,showMaxSteps:o})},ZYe=({variables:e,onVariablesChange:t,templateId:n})=>{const[r,s]=E.useState({name:"",description:"",type:"string",required:!1,default:"",instructions:""});E.useEffect(()=>{s({name:"",description:"",type:"string",required:!1,default:"",instructions:""})},[n]),E.useEffect(()=>()=>{s({name:"",description:"",type:"string",required:!1,default:"",instructions:""})},[]);const i=()=>{r.name&&(t([...e,{...r}]),s({name:"",description:"",type:"string",required:!1,default:"",instructions:""}))},a=o=>{t(e.filter((l,c)=>c!==o))};return f.jsx("div",{className:"space-y-4",children:f.jsxs("div",{children:[f.jsx(Nt,{className:"text-base font-medium",children:"Variables"}),f.jsxs("div",{className:"space-y-3 mt-2",children:[e.map((o,l)=>f.jsxs("div",{className:"p-3 border rounded-lg space-y-2",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("h4",{className:"font-medium",children:o.name}),f.jsx(ot,{variant:"ghost",size:"sm",onClick:()=>a(l),children:f.jsx(Si,{className:"h-4 w-4"})})]}),f.jsx("p",{className:"text-sm text-muted-foreground",children:o.description}),f.jsxs("div",{className:"flex gap-2 text-xs",children:[f.jsx(as,{variant:o.required?"default":"secondary",children:o.required?"Required":"Optional"}),f.jsx(as,{variant:"outline",children:o.type}),o.default&&f.jsxs(as,{variant:"outline",children:["Default: ",o.default]})]})]},`${o.name}-${l}`)),f.jsxs("div",{className:"p-3 border-2 border-dashed rounded-lg space-y-3",children:[f.jsx(Nt,{children:"Add New Variable"}),f.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[f.jsxs("div",{children:[f.jsx(Nt,{children:"Name"}),f.jsx(vn,{value:r.name,onChange:o=>s(l=>({...l,name:o.target.value})),placeholder:"Variable name"})]}),f.jsxs("div",{children:[f.jsx(Nt,{children:"Type"}),f.jsxs(sc,{value:r.type,onValueChange:o=>s(l=>({...l,type:o})),children:[f.jsx(ac,{children:f.jsx(ic,{})}),f.jsxs(oc,{children:[f.jsx(wi,{value:"string",children:"String"}),f.jsx(wi,{value:"number",children:"Number"}),f.jsx(wi,{value:"boolean",children:"Boolean"}),f.jsx(wi,{value:"array",children:"Array"})]})]},`new-variable-type-${n||"new"}`)]})]}),f.jsxs("div",{children:[f.jsx(Nt,{children:"Description"}),f.jsx(vn,{value:r.description,onChange:o=>s(l=>({...l,description:o.target.value})),placeholder:"Describe this variable"})]}),f.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[f.jsxs("div",{children:[f.jsx(Nt,{children:"Default Value"}),f.jsx(vn,{value:r.default,onChange:o=>s(l=>({...l,default:o.target.value})),placeholder:"Default value (optional)"})]}),f.jsxs("div",{className:"flex items-center space-x-2 pt-6",children:[f.jsx(Yc,{checked:r.required,onCheckedChange:o=>s(l=>({...l,required:!!o}))}),f.jsx(Nt,{children:"Required"})]})]}),f.jsxs(ot,{type:"button",onClick:i,className:"w-full",children:[f.jsx(nc,{className:"h-4 w-4 mr-2"}),"Add Variable"]})]})]})]})})},XYe=({selectedFollowUps:e,onFollowUpsChange:t,followUpOptions:n,templateId:r})=>{const[s,i]=E.useState(!1),[a,o]=E.useState(""),l=E.useRef(null),c=n.filter(m=>m.id!==r&&!e.includes(m.id)),u=c.filter(m=>m.name.toLowerCase().includes(a.toLowerCase())||m.description.toLowerCase().includes(a.toLowerCase())),d=m=>{m&&!e.includes(m)&&(t([...e,m]),o(""),i(!1))};E.useEffect(()=>{const m=y=>{l.current&&!l.current.contains(y.target)&&i(!1)};return document.addEventListener("mousedown",m),()=>{document.removeEventListener("mousedown",m)}},[]);const h=m=>{t(e.filter(y=>y!==m))};return f.jsx("div",{className:"space-y-4",children:f.jsxs("div",{children:[f.jsx(Nt,{className:"text-base font-medium",children:"Follow-up Templates"}),f.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Select templates that can be suggested as follow-ups after this template is used."}),f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{className:"space-y-2",children:[f.jsx(Nt,{className:"text-sm font-medium",children:"Selected Follow-ups:"}),e.length===0?f.jsx("p",{className:"text-sm text-muted-foreground",children:"No follow-ups selected yet."}):f.jsx("div",{className:"flex flex-wrap gap-2",children:e.map(m=>{const y=n.find(b=>b.id===m);return y?f.jsxs(as,{variant:"secondary",className:"flex items-center gap-1",children:[y.name,f.jsx(ot,{variant:"ghost",size:"sm",className:"h-4 w-4 p-0 hover:bg-destructive hover:text-destructive-foreground",onClick:()=>h(m),children:f.jsx(Si,{className:"h-3 w-3"})})]},m):f.jsxs(as,{variant:"destructive",className:"flex items-center gap-1",children:["Unknown Template (",m,")",f.jsx(ot,{variant:"ghost",size:"sm",className:"h-4 w-4 p-0 hover:bg-destructive hover:text-destructive-foreground",onClick:()=>h(m),children:f.jsx(Si,{className:"h-3 w-3"})})]},m)})})]}),c.length>0&&f.jsxs("div",{className:"relative",ref:l,children:[f.jsx(Nt,{className:"text-sm",children:"Add Follow-up Template:"}),f.jsxs("div",{className:"relative",children:[f.jsxs("div",{className:"flex h-9 w-full items-center justify-between rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm cursor-pointer hover:bg-accent",onClick:()=>i(!s),children:[f.jsx("span",{className:"text-muted-foreground",children:a||"Select a template to add as follow-up"}),f.jsx(uc,{className:"h-4 w-4 opacity-50"})]}),s&&f.jsxs("div",{className:"absolute top-full left-0 right-0 mt-1 max-h-60 overflow-auto rounded-md border bg-popover text-popover-foreground shadow-md",style:{position:"relative",zIndex:"var(--z-popover)"},children:[f.jsx("div",{className:"p-2",children:f.jsx(vn,{placeholder:"Search templates...",value:a,onChange:m=>o(m.target.value),className:"h-8"})}),f.jsx("div",{className:"max-h-48 overflow-auto",children:u.length===0?f.jsx("div",{className:"px-2 py-1.5 text-sm text-muted-foreground",children:"No templates found."}):u.map(m=>f.jsxs("div",{className:"relative flex cursor-pointer select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none hover:bg-accent hover:text-accent-foreground",onClick:()=>d(m.id),children:[m.name," - ",m.description]},m.id))})]})]})]}),c.length===0&&e.length===0&&f.jsx("p",{className:"text-sm text-muted-foreground",children:"No templates available for follow-ups. Create more templates first."}),c.length===0&&e.length>0&&f.jsx("p",{className:"text-sm text-muted-foreground",children:"All available templates have been selected as follow-ups."})]})]})})},JYe=()=>{const e=Ke({name:$e().min(1,"Name is required"),description:$e(),variables:cn(Ke({name:$e().min(1,"Variable name is required"),description:$e(),type:El(["string","number","boolean","array"]),required:Qn(),default:$e().optional(),instructions:$e().optional()})),prompt:$e().min(1,"Prompt content is required"),tags:cn($e()),tools:cn($e()),rules:cn($e()),followUps:cn($e())});return async({value:t})=>{try{await e.parseAsync(t)}catch(n){return n instanceof Vc?n.formErrors.fieldErrors:{root:"Validation failed"}}}},$0=({template:e,onSubmit:t,onSuccess:n,type:r,showFollowUps:s=!1,showMaxSteps:i=!1,followUpOptions:a=[],additionalActions:o})=>{const[l,c]=E.useState(null),{rules:u,tags:d,tagRuleLinks:h,loadRulesAndTags:m}=mre(mn(w=>({rules:w.rules,tags:w.tags,tagRuleLinks:w.tagRuleLinks,loadRulesAndTags:w.loadRulesAndTags})));E.useEffect(()=>{m()},[m]);const y=ai({defaultValues:{name:(e==null?void 0:e.name)||"",description:(e==null?void 0:e.description)||"",variables:(e==null?void 0:e.variables)||[],prompt:(e==null?void 0:e.prompt)||"",tags:(e==null?void 0:e.tags)||[],tools:(e==null?void 0:e.tools)||[],rules:(e==null?void 0:e.rules)||[],followUps:(e==null?void 0:e.followUps)||[]},validators:{onChangeAsync:JYe(),onChangeAsyncDebounceMs:500},onSubmit:async({value:w})=>{t(w),n()}}),b=w=>{const _=h.filter(k=>k.tagId===w).map(k=>k.ruleId);return u.filter(k=>_.includes(k.id))},v=()=>{switch(r){case"agent":return"Agent";case"task":return"Task";default:return"Template"}},x=()=>{switch(r){case"agent":return"Agent Prompt";case"task":return"Task Prompt";default:return"Prompt Template"}};return f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"font-medium",children:e?`Edit ${v()}`:`New ${v()}`}),f.jsx("p",{className:"text-sm text-muted-foreground",children:e?`Update your ${r}`:`Create a new ${r}${r==="prompt"?" template with variables":""}`})]}),f.jsxs("form",{onSubmit:w=>{w.preventDefault(),w.stopPropagation(),y.handleSubmit()},className:"space-y-6",children:[f.jsxs("div",{className:"space-y-4",children:[f.jsx(y.Field,{name:"name",children:w=>f.jsxs("div",{children:[f.jsxs(Nt,{htmlFor:w.name,children:[v()," Name"]}),f.jsx(vn,{id:w.name,value:w.state.value,onChange:_=>w.handleChange(_.target.value),onBlur:w.handleBlur,placeholder:`Enter ${r} name`}),w.state.meta.errors&&w.state.meta.errors.length>0&&f.jsx("p",{className:"text-xs text-destructive mt-1",children:w.state.meta.errors[0]||"Invalid input"})]})}),f.jsx(y.Field,{name:"description",children:w=>f.jsxs("div",{children:[f.jsx(Nt,{htmlFor:w.name,children:"Description"}),f.jsx(Ci,{id:w.name,value:w.state.value,onChange:_=>w.handleChange(_.target.value),onBlur:w.handleBlur,placeholder:`Describe what this ${r} does`,rows:3})]})}),f.jsx(y.Field,{name:"prompt",children:w=>f.jsxs("div",{children:[f.jsx(Nt,{htmlFor:w.name,children:x()}),f.jsx(Ci,{id:w.name,value:w.state.value,onChange:_=>w.handleChange(_.target.value),onBlur:w.handleBlur,placeholder:`Enter your ${r} prompt using {{ variable_name }} syntax`,rows:6,className:"font-mono"}),f.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["Use double curly braces to reference variables:"," ","{{ variable_name }}"]}),w.state.meta.errors&&w.state.meta.errors.length>0&&f.jsx("p",{className:"text-xs text-destructive mt-1",children:w.state.meta.errors[0]||"Invalid input"})]})})]}),f.jsx(y.Field,{name:"variables",children:w=>f.jsx(ZYe,{variables:w.state.value,onVariablesChange:_=>w.handleChange(_),templateId:e==null?void 0:e.id})}),s&&f.jsx(y.Field,{name:"followUps",children:w=>f.jsx(XYe,{selectedFollowUps:w.state.value||[],onFollowUpsChange:_=>w.handleChange(_),followUpOptions:a,templateId:e==null?void 0:e.id})}),f.jsx("div",{className:"space-y-4",children:f.jsxs("div",{children:[f.jsx(Nt,{className:"text-base font-medium",children:"Auto-select Tools"}),f.jsxs("p",{className:"text-sm text-muted-foreground mb-4",children:["Choose tools that will be automatically enabled when this ",r,"is applied."]}),f.jsx(y.Field,{name:"tools",children:w=>f.jsx(YYe,{selectedTools:w.state.value,onToolsChange:_=>w.handleChange(_),className:"p-0 max-w-none",maxSteps:l,onMaxStepsChange:c,showMaxSteps:i})})]})}),f.jsx("div",{className:"space-y-4",children:f.jsxs("div",{children:[f.jsx(Nt,{className:"text-base font-medium",children:"Auto-select Rules & Tags"}),f.jsxs("p",{className:"text-sm text-muted-foreground mb-4",children:["Choose rules and tags that will be automatically enabled when this",r," is applied."]}),f.jsx(bie,{activeTagIds:new Set(y.getFieldValue("tags")),activeRuleIds:new Set(y.getFieldValue("rules")),onToggleTag:(w,_)=>{const k=y.getFieldValue("tags");_?y.setFieldValue("tags",[...k,w]):y.setFieldValue("tags",k.filter(C=>C!==w))},onToggleRule:(w,_)=>{const k=y.getFieldValue("rules");_?y.setFieldValue("rules",[...k,w]):y.setFieldValue("rules",k.filter(C=>C!==w))},allRules:u,allTags:d,getRulesForTag:b})]})}),f.jsxs("div",{className:"flex gap-3 pt-4 border-t",children:[f.jsxs(ot,{type:"submit",className:"flex-1",children:[f.jsx(Yu,{className:"h-4 w-4 mr-2"}),e?`Update ${v()}`:`Create ${v()}`]}),o]})]})]})},JP=({templates:e,onEdit:t,onDelete:n,type:r,emptyMessage:s,additionalActions:i,getTaskCount:a})=>{const o=()=>{switch(r){case"agent":return"Agents";case"task":return"Tasks";default:return"Templates"}},l=()=>{switch(r){case"agent":return"Manage your AI agents and their associated tasks";case"task":return"Manage tasks for this agent";default:return"Manage your reusable prompt templates with dynamic variables"}},c=()=>{if(s)return s;switch(r){case"agent":return"No Agents Yet";case"task":return"No Tasks Yet";default:return"No Templates Yet"}},u=()=>{switch(r){case"agent":return'Use the "New Agent" tab to create your first agent';case"task":return"Create tasks to define what this agent can do";default:return'Use the "New Template" tab to create your first template'}};return f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"font-medium",children:o()}),f.jsx("p",{className:"text-sm text-muted-foreground",children:l()})]}),e.length===0?f.jsxs("div",{className:"text-center py-12 border-2 border-dashed rounded-lg",children:[f.jsx("h4",{className:"font-medium text-muted-foreground",children:c()}),f.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:u()})]}):f.jsxs(Sf,{children:[f.jsx(vp,{children:f.jsxs(As,{children:[f.jsx(Rr,{children:"Name"}),f.jsx(Rr,{children:"Description"}),f.jsx(Rr,{children:"Variables"}),r==="agent"&&f.jsx(Rr,{children:"Tasks"}),(r==="prompt"||r==="task")&&f.jsx(Rr,{children:"Follow-ups"}),f.jsx(Rr,{children:"Tools"}),f.jsx(Rr,{children:"Rules/Tags"}),f.jsx(Rr,{className:"text-right",children:"Actions"})]})}),f.jsx(_f,{children:e.map(d=>{var h,m,y,b;return f.jsxs(As,{children:[f.jsx(Bn,{className:"font-medium",children:d.name}),f.jsx(Bn,{className:"max-w-xs truncate",children:d.description}),f.jsx(Bn,{children:f.jsx(as,{variant:"secondary",children:d.variables.length})}),r==="agent"&&f.jsx(Bn,{children:f.jsx(as,{variant:"secondary",children:a?a(d.id):0})}),(r==="prompt"||r==="task")&&f.jsx(Bn,{children:f.jsx(as,{variant:"secondary",children:((h=d.followUps)==null?void 0:h.length)||0})}),f.jsx(Bn,{children:f.jsx(as,{variant:"secondary",children:((m=d.tools)==null?void 0:m.length)||0})}),f.jsx(Bn,{children:f.jsxs("div",{className:"flex gap-1",children:[f.jsxs(as,{variant:"secondary",children:[((y=d.tags)==null?void 0:y.length)||0," tags"]}),f.jsxs(as,{variant:"secondary",children:[((b=d.rules)==null?void 0:b.length)||0," rules"]})]})}),f.jsx(Bn,{className:"text-right",children:f.jsxs("div",{className:"flex gap-2 justify-end",children:[i&&i(d),f.jsx(ot,{variant:"ghost",size:"sm",onClick:()=>t(d),title:`Edit ${r}`,children:f.jsx(Ah,{className:"h-4 w-4"})}),f.jsx(ot,{variant:"ghost",size:"sm",onClick:()=>n(d.id),title:`Delete ${r}`,children:f.jsx(Vo,{className:"h-4 w-4"})})]})})]},d.id)})})]})]})},QYe=()=>{const[e,t]=E.useState("templates"),[n,r]=E.useState(),{loadPromptTemplates:s,addPromptTemplate:i,updatePromptTemplate:a,deletePromptTemplate:o,getTemplatesByType:l}=gl(mn(v=>({loadPromptTemplates:v.loadPromptTemplates,addPromptTemplate:v.addPromptTemplate,updatePromptTemplate:v.updatePromptTemplate,deletePromptTemplate:v.deletePromptTemplate,getTemplatesByType:v.getTemplatesByType}))),c=l("prompt");E.useEffect(()=>{s()},[s]);const u=async v=>{await i({...v,type:"prompt",isPublic:!1})},d=async v=>{n&&await a(n.id,v)},h=async v=>{confirm("Are you sure you want to delete this template?")&&await o(v)},m=v=>{r(v),t("edit")},y=()=>{t("templates"),r(void 0)},b=[{value:"templates",label:"Templates",content:f.jsx(JP,{templates:c,onEdit:m,onDelete:h,type:"prompt"})},{value:"new",label:"New Template",content:f.jsx($0,{onSubmit:u,onSuccess:y,type:"prompt",showFollowUps:!0,followUpOptions:c},"new-template-form")}];return n&&b.push({value:"edit",label:`Edit: ${n.name}`,content:f.jsx($0,{template:n,onSubmit:d,onSuccess:y,type:"prompt",showFollowUps:!0,followUpOptions:c},`edit-template-form-${n.id}`)}),f.jsx(Tl,{tabs:b,initialValue:e,onValueChange:t,defaultValue:"templates",contentContainerClassName:"pb-2 sm:pb-6 pr-1 sm:pr-2 -mr-1 sm:-mr-2",scrollable:!1})},eZe=()=>{const[e,t]=E.useState("agents"),[n,r]=E.useState(),[s,i]=E.useState(),[a,o]=E.useState(),{loadPromptTemplates:l,addPromptTemplate:c,updatePromptTemplate:u,deletePromptTemplate:d,getAgents:h,getTasksForAgent:m}=gl(mn(O=>({loadPromptTemplates:O.loadPromptTemplates,addPromptTemplate:O.addPromptTemplate,updatePromptTemplate:O.updatePromptTemplate,deletePromptTemplate:O.deletePromptTemplate,getAgents:O.getAgents,getTasksForAgent:O.getTasksForAgent})));E.useEffect(()=>{l()},[l]);const y=h(),b=s?m(s.id):[],v=async O=>{await c({...O,type:"agent",isPublic:!1})},x=async O=>{n&&await u(n.id,O)},w=async O=>{if(confirm("Are you sure you want to delete this agent and all its tasks?")){const K=m(O);for(const U of K)await d(U.id);await d(O)}},_=async O=>{s&&await c({...O,type:"task",parentId:s.id,isPublic:!1})},k=async O=>{!a||!s||await u(a.id,{...O,parentId:s.id})},C=async O=>{confirm("Are you sure you want to delete this task?")&&await d(O)},T=O=>{r(O),t("edit-agent")},A=O=>{i(O),t("manage-tasks")},N=O=>{o(O),t("edit-task")},I=()=>{o(void 0),t("new-task")},j=()=>{t("agents"),r(void 0),i(void 0),o(void 0)},L=()=>{t("agents"),i(void 0),o(void 0)},D=()=>{t("manage-tasks"),o(void 0)},H=[{value:"agents",label:"Agents",content:f.jsx(JP,{templates:y,onEdit:T,onDelete:w,type:"agent",getTaskCount:O=>m(O).length,additionalActions:O=>f.jsxs(ot,{variant:"ghost",size:"sm",onClick:()=>A(O),title:"Manage Tasks",children:[f.jsx(Ah,{className:"h-4 w-4"}),"Tasks"]})})},{value:"new-agent",label:"New Agent",content:f.jsx($0,{onSubmit:v,onSuccess:j,type:"agent",showFollowUps:!1,showMaxSteps:!0},"new-agent-form")}];return n&&H.push({value:"edit-agent",label:`Edit: ${n.name}`,content:f.jsx($0,{template:n,onSubmit:x,onSuccess:j,type:"agent",showFollowUps:!1,showMaxSteps:!0,additionalActions:f.jsxs(ot,{type:"button",variant:"outline",onClick:()=>A(n),className:"flex items-center gap-2",children:[f.jsx(Ah,{className:"h-4 w-4"}),"Tasks (",m(n.id).length,")"]})},`edit-agent-form-${n.id}`)}),s&&H.push({value:"manage-tasks",label:`Tasks: ${s.name}`,content:f.jsxs("div",{className:"space-y-4",children:[f.jsx("div",{className:"flex items-center gap-2",children:f.jsx(ot,{variant:"outline",onClick:L,children:"← Back to Agents"})}),f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsxs("h3",{className:"font-medium",children:["Tasks for ",s.name]}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Manage tasks for this agent"})]}),f.jsxs(ot,{onClick:I,children:[f.jsx(nc,{className:"h-4 w-4 mr-2"}),"New Task"]})]}),f.jsx(JP,{templates:b,onEdit:N,onDelete:C,type:"task",emptyMessage:"No Tasks Yet"})]})}),s&&e==="new-task"&&H.push({value:"new-task",label:"New Task",content:f.jsxs("div",{className:"space-y-4",children:[f.jsx("div",{className:"flex items-center gap-2",children:f.jsx(ot,{variant:"outline",onClick:D,children:"← Back to Tasks"})}),f.jsx($0,{onSubmit:_,onSuccess:D,type:"task",showFollowUps:!0,followUpOptions:b,showMaxSteps:!0},`new-task-form-${s.id}`)]})}),a&&s&&H.push({value:"edit-task",label:`Edit: ${a.name}`,content:f.jsxs("div",{className:"space-y-4",children:[f.jsx("div",{className:"flex items-center gap-2",children:f.jsx(ot,{variant:"outline",onClick:D,children:"← Back to Tasks"})}),f.jsx($0,{template:a,onSubmit:k,onSuccess:D,type:"task",showFollowUps:!0,followUpOptions:b.filter(O=>O.id!==a.id),showMaxSteps:!0},`edit-task-form-${a.id}`)]})}),f.jsx(Tl,{tabs:H,initialValue:e,onValueChange:t,defaultValue:"agents",contentContainerClassName:"pb-2 sm:pb-6 pr-1 sm:pr-2 -mr-1 sm:-mr-2",scrollable:!1})},tZe=Ke({name:$e().min(1,"Name is required"),url:$e().url("Must be a valid URL"),description:$e(),headers:$e(),enabled:Qn()}),nZe=Ke({retryAttempts:Tt().min(0,"Min 0 attempts").max(10,"Max 10 attempts"),retryDelay:Tt().min(500,"Min 500ms").max(3e4,"Max 30000ms"),connectionTimeout:Tt().min(1e3,"Min 1000ms").max(6e4,"Max 60000ms"),maxResponseSize:Tt().min(1e3,"Min 1KB").max(1e7,"Max 10MB")});function Dc({field:e}){return f.jsx(f.Fragment,{children:e.state.meta.isTouched&&e.state.meta.errors.length>0?f.jsx("em",{className:"text-xs text-destructive mt-1 block",children:e.state.meta.errors.join(", ")}):null})}function rZe(){const{bridgeConfig:e,setBridgeConfig:t}=pl(mn(s=>({bridgeConfig:s.bridgeConfig,setBridgeConfig:s.setBridgeConfig}))),n=ai({defaultValues:{url:e.url||"",host:e.host||"",port:e.port||void 0},onSubmit:async({value:s})=>{t({url:s.url||void 0,host:s.host||void 0,port:s.port})}});E.useEffect(()=>{n.reset({url:e.url||"",host:e.host||"",port:e.port||void 0})},[e,n]);const r=()=>{window.confirm("Reset bridge configuration to defaults?")&&t({})};return f.jsxs("form",{onSubmit:s=>{s.preventDefault(),s.stopPropagation(),n.handleSubmit()},className:"space-y-6",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"font-medium",children:"Dynamic MCP Bridge Configuration"}),f.jsxs("p",{className:"text-sm text-muted-foreground",children:["Configure where LiteChat looks for the dynamic MCP bridge service (required for stdio:// servers). Start the bridge with: ",f.jsx("code",{className:"bg-muted px-1 rounded",children:"npm run mcp-proxy"})]})]}),f.jsxs(ho,{children:[f.jsxs(po,{children:[f.jsxs(mo,{className:"text-base flex items-center",children:[f.jsx(jh,{className:"mr-2 h-4 w-4"}),"Bridge Location"]}),f.jsx($c,{children:"Specify where your dynamic MCP bridge is running (default: localhost:3001)"})]}),f.jsxs(go,{className:"space-y-4",children:[f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[f.jsx(n.Field,{name:"url",children:s=>f.jsxs("div",{className:"space-y-2",children:[f.jsx(Nt,{htmlFor:s.name,children:"Full Bridge URL (highest priority)"}),f.jsx(vn,{id:s.name,value:s.state.value,onChange:i=>s.handleChange(i.target.value),onBlur:s.handleBlur,placeholder:"http://192.168.1.100:3001"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Complete URL where the dynamic MCP bridge is running"}),f.jsx(Dc,{field:s})]})}),f.jsxs("div",{className:"space-y-2",children:[f.jsx(Nt,{children:"Or configure Host + Port"}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx(n.Field,{name:"host",children:s=>f.jsxs("div",{className:"flex-1",children:[f.jsx(vn,{value:s.state.value,onChange:i=>s.handleChange(i.target.value),onBlur:s.handleBlur,placeholder:"localhost"}),f.jsx(Dc,{field:s})]})}),f.jsx(n.Field,{name:"port",children:s=>f.jsxs("div",{className:"w-20",children:[f.jsx(vn,{type:"number",value:s.state.value||"",onChange:i=>s.handleChange(parseInt(i.target.value)||void 0),onBlur:s.handleBlur,placeholder:"3001"}),f.jsx(Dc,{field:s})]})})]}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Host and port (uses HTTP by default)"})]})]}),f.jsxs("div",{className:"text-sm text-muted-foreground bg-muted/50 p-3 rounded-md",children:[f.jsx("p",{className:"font-medium mb-1",children:"Bridge Detection Priority:"}),f.jsxs("ol",{className:"list-decimal list-inside space-y-1 text-xs",children:[f.jsx("li",{children:"Full URL (if specified above)"}),f.jsx("li",{children:"Host + Port combination (if specified above)"}),f.jsx("li",{children:"Auto-detection fallback: localhost:3001"})]}),f.jsx("p",{className:"mt-2 text-xs",children:"Leave empty for auto-detection. For remote bridge, use full URL or configure host binding."})]})]})]}),f.jsxs(ho,{children:[f.jsx(po,{children:f.jsx(mo,{className:"text-base",children:"Bridge Setup Instructions"})}),f.jsx(go,{className:"space-y-3",children:f.jsxs("div",{className:"text-sm space-y-2",children:[f.jsx("p",{className:"font-medium",children:"To use stdio MCP servers, install and run the bridge:"}),f.jsxs("div",{className:"bg-muted p-3 rounded font-mono text-xs",children:[f.jsx("p",{children:"# Start the bridge (from LiteChat project directory)"}),f.jsx("p",{children:"node bin/mcp-bridge.js"}),f.jsx("p",{}),f.jsx("p",{children:"# Or with custom settings"}),f.jsx("p",{children:"node bin/mcp-bridge.js --host 0.0.0.0 --port 3001"})]})]})})]}),f.jsx("div",{className:"flex items-center justify-between pt-3 border-t",children:f.jsx(n.Subscribe,{children:s=>f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(ot,{type:"submit",size:"sm",disabled:!s.canSubmit||s.isSubmitting||s.isValidating||!s.isValid,children:s.isSubmitting?"Saving...":s.isValidating?"Validating...":"Save Bridge Config"}),f.jsxs(ot,{variant:"outline",size:"sm",onClick:r,type:"button",children:[f.jsx(E1,{className:"mr-2 h-4 w-4"}),"Reset"]})]})})})]})}function sZe(){const{retryAttempts:e,retryDelay:t,connectionTimeout:n,maxResponseSize:r,setRetryAttempts:s,setRetryDelay:i,setConnectionTimeout:a,setMaxResponseSize:o}=pl(mn(u=>({retryAttempts:u.retryAttempts,retryDelay:u.retryDelay,connectionTimeout:u.connectionTimeout,maxResponseSize:u.maxResponseSize,setRetryAttempts:u.setRetryAttempts,setRetryDelay:u.setRetryDelay,setConnectionTimeout:u.setConnectionTimeout,setMaxResponseSize:u.setMaxResponseSize}))),l=ai({defaultValues:{retryAttempts:e,retryDelay:t,connectionTimeout:n,maxResponseSize:r},validators:{onChangeAsync:nZe,onChangeAsyncDebounceMs:500},onSubmit:async({value:u})=>{s(u.retryAttempts),i(u.retryDelay),a(u.connectionTimeout),o(u.maxResponseSize)}});E.useEffect(()=>{l.reset({retryAttempts:e,retryDelay:t,connectionTimeout:n,maxResponseSize:r})},[e,t,n,r,l]);const c=()=>{window.confirm("Reset connection settings to defaults?")&&(s(3),i(2e3),a(1e4),o(128e3))};return f.jsxs("form",{onSubmit:u=>{u.preventDefault(),u.stopPropagation(),l.handleSubmit()},className:"space-y-6",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"font-medium",children:"Connection Settings"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Configure retry behavior and timeouts for MCP server connections"})]}),f.jsxs(ho,{children:[f.jsxs(po,{children:[f.jsx(mo,{className:"text-base",children:"Retry Configuration"}),f.jsx($c,{children:"How LiteChat handles failed connections"})]}),f.jsx(go,{className:"space-y-4",children:f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[f.jsx(l.Field,{name:"retryAttempts",children:u=>f.jsxs("div",{className:"space-y-2",children:[f.jsx(Nt,{htmlFor:u.name,children:"Retry Attempts"}),f.jsx(vn,{id:u.name,type:"number",min:"0",max:"10",value:u.state.value,onChange:d=>u.handleChange(parseInt(d.target.value)||0),onBlur:u.handleBlur,placeholder:"3"}),f.jsx(Dc,{field:u}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Number of retry attempts (0-10)"})]})}),f.jsx(l.Field,{name:"retryDelay",children:u=>f.jsxs("div",{className:"space-y-2",children:[f.jsx(Nt,{htmlFor:u.name,children:"Retry Delay (ms)"}),f.jsx(vn,{id:u.name,type:"number",min:"500",max:"30000",step:"500",value:u.state.value,onChange:d=>u.handleChange(parseInt(d.target.value)||2e3),onBlur:u.handleBlur,placeholder:"2000"}),f.jsx(Dc,{field:u}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Initial delay between retries (500-30000ms)"})]})}),f.jsx(l.Field,{name:"connectionTimeout",children:u=>f.jsxs("div",{className:"space-y-2",children:[f.jsx(Nt,{htmlFor:u.name,children:"Connection Timeout (ms)"}),f.jsx(vn,{id:u.name,type:"number",min:"1000",max:"60000",step:"1000",value:u.state.value,onChange:d=>u.handleChange(parseInt(d.target.value)||1e4),onBlur:u.handleBlur,placeholder:"10000"}),f.jsx(Dc,{field:u}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Connection timeout (1000-60000ms)"})]})}),f.jsx(l.Field,{name:"maxResponseSize",children:u=>f.jsxs("div",{className:"space-y-2",children:[f.jsx(Nt,{htmlFor:u.name,children:"Max Response Size (bytes)"}),f.jsx(vn,{id:u.name,type:"number",min:"1000",max:"10000000",step:"1000",value:u.state.value,onChange:d=>u.handleChange(parseInt(d.target.value)||128e3),onBlur:u.handleBlur,placeholder:"128000"}),f.jsx(Dc,{field:u}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Max tool response size (1KB-10MB)"})]})})]})})]}),f.jsxs(ho,{children:[f.jsx(po,{children:f.jsx(mo,{className:"text-base",children:"How It Works"})}),f.jsx(go,{children:f.jsx("div",{className:"text-sm text-muted-foreground bg-muted/50 p-3 rounded-md",children:f.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[f.jsx("li",{children:"Failed connections will be retried automatically with exponential backoff"}),f.jsx("li",{children:"Toast notifications will show connection status and retry progress"}),f.jsx("li",{children:"Servers that fail all retry attempts will be marked as disconnected"}),f.jsx("li",{children:"You can manually retry connections from the server cards in the Servers tab"}),f.jsxs("li",{children:[f.jsx("strong",{children:"Max Response Size:"})," Tool responses larger than this limit will be automatically truncated to prevent API errors"]})]})})})]}),f.jsx("div",{className:"flex items-center justify-between pt-3 border-t",children:f.jsx(l.Subscribe,{children:u=>f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(ot,{type:"submit",size:"sm",disabled:!u.canSubmit||u.isSubmitting||u.isValidating||!u.isValid,children:u.isSubmitting?"Saving...":u.isValidating?"Validating...":"Save Connection Settings"}),f.jsxs(ot,{variant:"outline",size:"sm",onClick:c,type:"button",children:[f.jsx(E1,{className:"mr-2 h-4 w-4"}),"Reset"]})]})})})]})}function _V({server:e,onSubmit:t,onCancel:n}){const r=ai({defaultValues:{name:(e==null?void 0:e.name)||"",url:(e==null?void 0:e.url)||"",description:(e==null?void 0:e.description)||"",headers:e!=null&&e.headers?JSON.stringify(e.headers,null,2):"",enabled:(e==null?void 0:e.enabled)??!0},validators:{onChangeAsync:tZe,onChangeAsyncDebounceMs:500},onSubmit:async({value:s})=>{t(s)}});return E.useEffect(()=>{r.reset({name:(e==null?void 0:e.name)||"",url:(e==null?void 0:e.url)||"",description:(e==null?void 0:e.description)||"",headers:e!=null&&e.headers?JSON.stringify(e.headers,null,2):"",enabled:(e==null?void 0:e.enabled)??!0})},[e,r]),f.jsxs("form",{onSubmit:s=>{s.preventDefault(),s.stopPropagation(),r.handleSubmit()},className:"space-y-6",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"text-lg font-medium",children:e?"Edit MCP Server":"Add New MCP Server"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:e?"Modify the server configuration below.":"Configure a new MCP server to connect to."})]}),f.jsxs(ho,{children:[f.jsx(po,{children:f.jsxs(mo,{className:"text-base flex items-center",children:[f.jsx(uy,{className:"mr-2 h-4 w-4"}),"Server Details"]})}),f.jsxs(go,{className:"space-y-4",children:[f.jsx(r.Field,{name:"name",children:s=>f.jsxs("div",{className:"space-y-2",children:[f.jsx(Nt,{htmlFor:s.name,children:"Server Name"}),f.jsx(vn,{id:s.name,value:s.state.value,onChange:i=>s.handleChange(i.target.value),onBlur:s.handleBlur,placeholder:"My MCP Server"}),f.jsx(Dc,{field:s})]})}),f.jsx(r.Field,{name:"url",children:s=>f.jsxs("div",{className:"space-y-2",children:[f.jsx(Nt,{htmlFor:s.name,children:"Server URL"}),f.jsx(vn,{id:s.name,value:s.state.value,onChange:i=>s.handleChange(i.target.value),onBlur:s.handleBlur,placeholder:"https://api.example.com/mcp or stdio://npx?args=-y,@modelcontextprotocol/server-filesystem,."}),f.jsx(Dc,{field:s}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"HTTP/HTTPS URLs for remote servers, or stdio://command?args=arg1,arg2 for dynamic bridge servers"})]})}),f.jsx(r.Field,{name:"description",children:s=>f.jsxs("div",{className:"space-y-2",children:[f.jsx(Nt,{htmlFor:s.name,children:"Description (Optional)"}),f.jsx(Ci,{id:s.name,value:s.state.value,onChange:i=>s.handleChange(i.target.value),onBlur:s.handleBlur,placeholder:"Brief description of this server's purpose",rows:2}),f.jsx(Dc,{field:s})]})}),f.jsx(r.Field,{name:"headers",children:s=>f.jsxs("div",{className:"space-y-2",children:[f.jsx(Nt,{htmlFor:s.name,children:"Authentication Headers (Optional)"}),f.jsx(Ci,{id:s.name,value:s.state.value,onChange:i=>s.handleChange(i.target.value),onBlur:s.handleBlur,placeholder:'{"Authorization": "Bearer your-token-here"}',rows:3}),f.jsx(Dc,{field:s}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"JSON object with authentication headers (not applicable for stdio servers)"})]})}),f.jsx(r.Field,{name:"enabled",children:s=>f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(fo,{id:s.name,checked:s.state.value,onCheckedChange:s.handleChange}),f.jsx(Nt,{htmlFor:s.name,children:"Enable this server"})]})})]}),f.jsxs(Mte,{className:"flex gap-2",children:[f.jsx(r.Subscribe,{selector:s=>[s.canSubmit,s.isSubmitting],children:([s,i])=>f.jsx(ot,{type:"submit",disabled:!s||i,children:i?e?"Updating...":"Adding...":e?"Update Server":"Add Server"})}),f.jsx(ot,{type:"button",variant:"outline",onClick:n,children:"Cancel"})]})]})]})}function iZe({onNewServer:e,onEditServer:t}){const{servers:n,deleteServer:r,updateServer:s}=pl(mn(o=>({servers:o.servers,deleteServer:o.deleteServer,updateServer:o.updateServer}))),i=o=>{window.confirm("Are you sure you want to delete this MCP server?")&&r(o)},a=o=>{s(o.id,{enabled:!o.enabled})};return f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"font-medium",children:"MCP Servers"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Manage your Model Context Protocol servers"})]}),f.jsxs(ot,{onClick:e,children:[f.jsx(nc,{className:"mr-2 h-4 w-4"}),"Add Server"]})]}),n.length===0?f.jsxs("div",{className:"text-center py-12 border-2 border-dashed rounded-lg",children:[f.jsx(uy,{className:"h-12 w-12 text-muted-foreground mb-4 mx-auto"}),f.jsx("h4",{className:"font-medium text-muted-foreground",children:"No MCP Servers"}),f.jsx("p",{className:"text-sm text-muted-foreground mt-1 mb-4",children:"Add HTTP-based MCP servers to extend LiteChat with additional tools and capabilities"}),f.jsxs(ot,{onClick:e,children:[f.jsx(nc,{className:"mr-2 h-4 w-4"}),"Add Your First Server"]})]}):f.jsxs(Sf,{children:[f.jsx(vp,{children:f.jsxs(As,{children:[f.jsx(Rr,{children:"Name"}),f.jsx(Rr,{children:"URL"}),f.jsx(Rr,{children:"Status"}),f.jsx(Rr,{children:"Description"}),f.jsx(Rr,{className:"text-right",children:"Actions"})]})}),f.jsx(_f,{children:n.map(o=>f.jsxs(As,{children:[f.jsx(Bn,{className:"font-medium",children:o.name}),f.jsx(Bn,{className:"max-w-xs truncate font-mono text-xs",children:o.url}),f.jsx(Bn,{children:f.jsx(as,{variant:o.enabled?"default":"secondary",children:o.enabled?f.jsxs(f.Fragment,{children:[f.jsx(hme,{className:"mr-1 h-3 w-3"}),"Enabled"]}):f.jsxs(f.Fragment,{children:[f.jsx(l3,{className:"mr-1 h-3 w-3"}),"Disabled"]})})}),f.jsx(Bn,{className:"max-w-xs truncate",children:o.description||"—"}),f.jsx(Bn,{className:"text-right",children:f.jsxs("div",{className:"flex gap-2 justify-end",children:[f.jsx(fo,{checked:o.enabled,onCheckedChange:()=>a(o),className:"scale-75"}),f.jsx(ot,{variant:"ghost",size:"sm",onClick:()=>t(o),children:f.jsx(Ah,{className:"h-4 w-4"})}),f.jsx(ot,{variant:"ghost",size:"sm",onClick:()=>i(o.id),children:f.jsx(v0e,{className:"h-4 w-4"})})]})})]},o.id))})]})]})}const aZe=()=>{const[e,t]=E.useState("servers"),[n,r]=E.useState(),{addServer:s,updateServer:i}=pl(mn(h=>({addServer:h.addServer,updateServer:h.updateServer}))),a=async h=>{try{const m=h.headers?JSON.parse(h.headers):void 0;s({name:h.name,url:h.url,description:h.description,headers:m,enabled:h.enabled}),t("servers")}catch(m){console.error("Invalid headers JSON:",m),ke.error("Invalid JSON in headers field")}},o=async h=>{if(n)try{const m=h.headers?JSON.parse(h.headers):void 0;i(n.id,{name:h.name,url:h.url,description:h.description,headers:m,enabled:h.enabled}),t("servers"),r(void 0)}catch(m){console.error("Invalid headers JSON:",m),ke.error("Invalid JSON in headers field")}},l=()=>{r(void 0),t("new")},c=h=>{r(h),t("edit")},u=()=>{t("servers"),r(void 0)},d=[{value:"servers",label:"Servers",content:f.jsx(iZe,{onNewServer:l,onEditServer:c})},{value:"bridge",label:"Bridge Config",content:f.jsx(rZe,{})},{value:"connection",label:"Connection",content:f.jsx(sZe,{})},{value:"new",label:"Add Server",content:f.jsx(_V,{onSubmit:a,onCancel:u},"new-server-form")}];return n&&d.push({value:"edit",label:`Edit: ${n.name}`,content:f.jsx(_V,{server:n,onSubmit:o,onCancel:u},`edit-server-form-${n.id}`)}),f.jsx(Tl,{tabs:d,initialValue:e,onValueChange:t,defaultValue:"servers",contentContainerClassName:"pb-2 sm:pb-6 pr-1 sm:pr-2 -mr-1 sm:-mr-2",scrollable:!1})},RC=`Please provide a detailed but concise summary of our conversation so far. Include:

1. **Main Topics**: Key subjects we've discussed
2. **Important Decisions**: Any conclusions or agreements reached  
3. **Action Items**: Tasks or next steps identified
4. **Context**: Essential background information for continuing our discussion
5. **Current Status**: Where we left off and what we were working on

Keep the summary comprehensive enough that someone could understand the full context and continue our conversation seamlessly, but concise enough to be easily digestible. Focus on actionable information and key insights rather than verbose details.`,oZe=()=>{const[e,t]=E.useState(!1),[n,r]=E.useState(""),[s,i]=E.useState(null),{forkCompactPrompt:a,forkCompactModelId:o,setForkCompactPrompt:l,setForkCompactModelId:c}=pr(mn(y=>({forkCompactPrompt:y.forkCompactPrompt,forkCompactModelId:y.forkCompactModelId,setForkCompactPrompt:y.setForkCompactPrompt,setForkCompactModelId:y.setForkCompactModelId}))),{globallyEnabledModels:u}=Gn(mn(y=>({globallyEnabledModels:y.getGloballyEnabledModelDefinitions()})));E.useEffect(()=>{r(a||RC),i(o)},[a,o]);const d=async()=>{t(!0);try{l(n),c(s),ke.success("Fork Compact settings saved!")}catch(y){console.error("Failed to save fork compact settings:",y),ke.error("Failed to save settings")}finally{t(!1)}},h=()=>{confirm("Reset Fork Compact settings to defaults?")&&(r(RC),i(null),l(RC),c(null),ke.success("Fork Compact settings reset to defaults"))},m=n!==(a||RC)||s!==o;return f.jsx("div",{className:"space-y-6",children:f.jsxs(ho,{children:[f.jsxs(po,{children:[f.jsx(mo,{children:"Fork Compact Configuration"}),f.jsx($c,{children:"Configure the model and prompt used when creating compact conversation summaries. Fork Compact creates a new conversation with a summary of the current conversation history."})]}),f.jsxs(go,{className:"space-y-4",children:[f.jsxs("div",{className:"space-y-2",children:[f.jsx(Nt,{htmlFor:"fork-compact-model",children:"Default Model"}),f.jsxs(sc,{value:s||"__default__",onValueChange:y=>i(y==="__default__"?null:y),children:[f.jsx(ac,{children:f.jsx(ic,{placeholder:"Use conversation's current model"})}),f.jsxs(oc,{children:[f.jsx(wi,{value:"__default__",children:"Use conversation's current model"}),u.map(y=>f.jsxs(wi,{value:y.id,children:[y.name," (",y.providerName,")"]},y.id))]})]}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Leave empty to use the same model as the current conversation. Select a specific model to always use that model for compact summaries."})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx(Nt,{htmlFor:"fork-compact-prompt",children:"Compact Summary Prompt"}),f.jsx(Ci,{id:"fork-compact-prompt",value:n,onChange:y=>r(y.target.value),placeholder:"Enter the prompt for generating compact summaries...",className:"min-h-[200px] font-mono text-sm"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"This prompt will be sent to the AI along with the conversation history to generate a compact summary. The summary will become the first assistant message in the new forked conversation."})]}),f.jsxs("div",{className:"flex items-center justify-between pt-4",children:[f.jsxs(ot,{variant:"outline",size:"sm",onClick:h,disabled:e,children:[f.jsx(E1,{className:"mr-2 h-4 w-4"}),"Reset to Default"]}),f.jsx(ot,{onClick:d,disabled:!m||e,children:e?"Saving...":"Save Changes"})]})]})]})})},lZe=()=>{const e=E.useMemo(()=>[{value:"prompt",label:"System Prompt",content:f.jsx(zYe,{})},{value:"parameters",label:"Parameters",content:f.jsx(qYe,{})},{value:"tools",label:"Tools",content:f.jsx(HYe,{})},{value:"mcp",label:"MCP",content:f.jsx(aZe,{})},{value:"titles",label:"Auto-Titles",content:f.jsx(KYe,{})},{value:"fork-compact",label:"Fork Compact",content:f.jsx(oZe,{})},{value:"prompts",label:"Prompts",content:f.jsx(QYe,{})},{value:"agents",label:"Agents",content:f.jsx(eZe,{})}],[]);return f.jsx("div",{className:"space-y-4 p-1 h-full flex flex-col",children:f.jsx(Tl,{tabs:e,defaultValue:"prompt",className:"flex-grow",listClassName:"bg-muted/50 rounded-md",contentContainerClassName:"mt-3",scrollable:!1})})},cZe=Ve.memo(lZe);class uZe{constructor(){ce(this,"id","core-settings-assistant");ce(this,"unregisterCallback",null);ce(this,"modApiRef",null);ce(this,"eventUnsubscribers",[]);ce(this,"isVisible",!1)}async initialize(t){this.modApiRef=t,this.isVisible=pr.getState().enableAdvancedSettings;const n=t.on(on.enableAdvancedSettingsChanged,r=>{typeof r=="object"&&r&&"enabled"in r&&this.isVisible!==r.enabled&&(this.isVisible=r.enabled,this.reregisterTab())});this.eventUnsubscribers.push(n)}reregisterTab(){this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.modApiRef&&this.register(this.modApiRef)}register(t){this.modApiRef=t,this.isVisible?this.unregisterCallback||(this.unregisterCallback=t.registerSettingsTab({id:"assistant",title:"Assistant",component:cZe,order:40})):this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null)}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const dZe=Ke({importSettings:Qn(),importApiKeys:Qn(),importProviderConfigs:Qn(),importProjects:Qn(),importConversations:Qn(),importRulesAndTags:Qn(),importMods:Qn(),importSyncRepos:Qn(),importMcpServers:Qn(),importPromptTemplates:Qn(),importAgents:Qn()}),fZe=Ke({importSettings:Qn(),importApiKeys:Qn(),importProviderConfigs:Qn(),importProjects:Qn(),importConversations:Qn(),importRulesAndTags:Qn(),importMods:Qn(),importSyncRepos:Qn(),importMcpServers:Qn(),importPromptTemplates:Qn(),importAgents:Qn()}),hZe=()=>{const{importConversation:e,exportAllConversations:t}=jn(mn(N=>({importConversation:N.importConversation,exportAllConversations:N.exportAllConversations}))),n=E.useRef(null),r=E.useRef(null),[s,i]=E.useState(!1),[a,o]=E.useState(!1),[l,c]=E.useState(!1),[u,d]=E.useState(!1),[h,m]=E.useState(!1),y=ai({defaultValues:{importSettings:!0,importApiKeys:!0,importProviderConfigs:!0,importProjects:!0,importConversations:!0,importRulesAndTags:!0,importMods:!0,importSyncRepos:!0,importMcpServers:!0,importPromptTemplates:!0,importAgents:!0},validators:{onChange:dZe}}),b=ai({defaultValues:{importSettings:!0,importApiKeys:!0,importProviderConfigs:!0,importProjects:!0,importConversations:!0,importRulesAndTags:!0,importMods:!0,importSyncRepos:!0,importMcpServers:!0,importPromptTemplates:!0,importAgents:!0},validators:{onChange:fZe}}),v=()=>{var N;(N=n.current)==null||N.click()},x=()=>{var N;(N=r.current)==null||N.click()},w=E.useCallback(async N=>{var j;const I=(j=N.target.files)==null?void 0:j[0];if(I){i(!0);try{await e(I)}catch(L){console.error("Import failed (from component):",L)}finally{n.current&&(n.current.value=""),i(!1)}}},[e]),_=E.useCallback(async N=>{var j;const I=(j=N.target.files)==null?void 0:j[0];if(I){if(!window.confirm("Importing this file will OVERWRITE existing data for the selected categories. Are you sure you want to proceed?")){r.current&&(r.current.value="");return}m(!0);try{await j0.importFullConfiguration(I,y.state.values)}catch(L){console.error("Full import failed (from component):",L)}finally{r.current&&(r.current.value=""),m(!1)}}},[y]),k=E.useCallback(async()=>{o(!0);try{await t()}catch(N){console.error("Export all failed (from component):",N)}finally{o(!1)}},[t]),C=E.useCallback(async()=>{d(!0);try{await j0.exportFullConfiguration(b.state.values)}catch(N){console.error("Full export failed (from component):",N)}finally{d(!1)}},[b]),T=E.useCallback(async()=>{if(window.confirm(`🚨 ARE YOU ABSOLUTELY SURE? 🚨

This will permanently delete ALL conversations, messages, mods, settings, providers, and stored API keys from your browser. This action cannot be undone.`)&&window.confirm(`SECOND CONFIRMATION:

Really delete everything? Consider exporting first.`)){c(!0);try{await yt.clearAllData(),ke.success("All local data cleared. Reloading the application..."),setTimeout(()=>window.location.reload(),1500)}catch(N){const I="Failed to clear all data";console.error(I,N),ke.error(`${I}: ${N instanceof Error?N.message:String(N)}`),c(!1)}}},[]),A=(N,I,j,L,D,H)=>{const O=`${H}-${I}-checkbox`;return f.jsx(N.Field,{name:I,children:K=>f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(Yc,{id:O,checked:K.state.value,onCheckedChange:U=>K.handleChange(!!U),disabled:D}),f.jsxs(Nt,{htmlFor:O,className:"text-sm font-normal flex items-center gap-1.5",children:[f.jsx(L,{className:"h-4 w-4 text-muted-foreground"})," ",j]})]})},I)};return f.jsxs("div",{className:"space-y-4 p-1",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"text-lg font-medium mb-2",children:"Single Conversation"}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[f.jsxs("div",{className:"border p-3 rounded-md space-y-2",children:[f.jsx(Nt,{className:"font-semibold",children:"Import Conversation"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Import a previously exported single conversation (.json file)."}),f.jsx("input",{type:"file",ref:n,onChange:w,accept:".json",className:"hidden",id:"import-file-input",disabled:s}),f.jsxs(ot,{onClick:v,variant:"outline",size:"sm",disabled:s,children:[s?f.jsx(Hn,{className:"mr-2 h-4 w-4 animate-spin"}):f.jsx(GH,{className:"mr-2 h-4 w-4"}),s?"Importing...":"Select File..."]})]}),f.jsxs("div",{className:"border p-3 rounded-md space-y-2",children:[f.jsx(Nt,{className:"font-semibold",children:"Export All Conversations"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Export all conversations and messages into a single JSON file."}),f.jsxs(ot,{onClick:k,variant:"outline",size:"sm",disabled:a,children:[a?f.jsx(Hn,{className:"mr-2 h-4 w-4 animate-spin"}):f.jsx(Fc,{className:"mr-2 h-4 w-4"}),a?"Exporting...":"Export All Chats"]})]})]})]}),f.jsx(zm,{}),f.jsxs("div",{children:[f.jsx("h3",{className:"text-lg font-medium mb-2",children:"Full Configuration Backup"}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[f.jsxs("div",{className:"border p-3 rounded-md space-y-3",children:[f.jsx(Nt,{className:"font-semibold",children:"Import Full Configuration"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Import settings, providers, keys, projects, conversations, etc., from a backup file. Select which data types to restore."}),f.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-2 pt-2",children:[A(y,"importSettings","Settings",jh,h,"import"),A(y,"importApiKeys","API Keys",nw,h,"import"),A(y,"importProviderConfigs","Providers",uy,h,"import"),A(y,"importProjects","Projects",UB,h,"import"),A(y,"importConversations","Conversations",u3,h,"import"),A(y,"importRulesAndTags","Rules & Tags",d3,h,"import"),A(y,"importMods","Mods",WB,h,"import"),A(y,"importSyncRepos","Sync Repos",qc,h,"import"),A(y,"importMcpServers","MCP Servers",VB,h,"import"),A(y,"importPromptTemplates","Prompt Templates",c3,h,"import"),A(y,"importAgents","Agents",Em,h,"import")]}),f.jsx("input",{type:"file",ref:r,onChange:_,accept:".json",className:"hidden",id:"full-import-file-input",disabled:h}),f.jsxs(ot,{onClick:x,variant:"outline",size:"sm",disabled:h,children:[h?f.jsx(Hn,{className:"mr-2 h-4 w-4 animate-spin"}):f.jsx(Wme,{className:"mr-2 h-4 w-4"}),h?"Importing...":"Select Backup File..."]})]}),f.jsxs("div",{className:"border p-3 rounded-md space-y-3",children:[f.jsx(Nt,{className:"font-semibold",children:"Export Full Configuration"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Export all settings, providers, keys, projects, conversations, rules, tags, mods, etc., into a single backup file. Select which data types to include."}),f.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-2 pt-2",children:[A(b,"importSettings","Settings",jh,u,"export"),A(b,"importApiKeys","API Keys",nw,u,"export"),A(b,"importProviderConfigs","Providers",uy,u,"export"),A(b,"importProjects","Projects",UB,u,"export"),A(b,"importConversations","Conversations",u3,u,"export"),A(b,"importRulesAndTags","Rules & Tags",d3,u,"export"),A(b,"importMods","Mods",WB,u,"export"),A(b,"importSyncRepos","Sync Repos",qc,u,"export"),A(b,"importMcpServers","MCP Servers",VB,u,"export"),A(b,"importPromptTemplates","Prompt Templates",c3,u,"export"),A(b,"importAgents","Agents",Em,u,"export")]}),f.jsxs(ot,{onClick:C,variant:"secondary",size:"sm",disabled:u,children:[u?f.jsx(Hn,{className:"mr-2 h-4 w-4 animate-spin"}):f.jsx(Lme,{className:"mr-2 h-4 w-4"}),u?"Exporting...":"Export Configuration"]})]})]})]}),f.jsxs("div",{className:"border-t pt-6 border-destructive/50",children:[f.jsx("h3",{className:"text-lg font-medium text-destructive mb-2",children:"Danger Zone"}),f.jsx("p",{className:"text-sm text-destructive/90 mb-3",children:"Be very careful with these actions. Data loss may be permanent."}),f.jsxs(ot,{onClick:T,variant:"destructive",disabled:l,children:[l?f.jsx(Hn,{className:"mr-2 h-4 w-4 animate-spin"}):f.jsx(Vo,{className:"mr-2 h-4 w-4"}),l?"Clearing Data...":"Clear All Local Data (Conversations, Keys, Settings, etc.)"]})]})]})},pZe=Ve.memo(hZe);class mZe{constructor(){ce(this,"id","core-settings-data");ce(this,"unregisterCallback",null)}async initialize(t){}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerSettingsTab({id:"data",title:"Data",component:pZe,order:70})}destroy(){this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),console.log(`[${this.id}] Destroyed.`)}}const gZe=()=>{const{loadedMods:e,addDbMod:t,updateDbMod:n,deleteDbMod:r,dbMods:s,isLoading:i}=Yh(mn(T=>({loadedMods:T.loadedMods,addDbMod:T.addDbMod,updateDbMod:T.updateDbMod,deleteDbMod:T.deleteDbMod,dbMods:T.dbMods,isLoading:T.isLoading}))),[a,o]=E.useState(""),[l,c]=E.useState(""),[u,d]=E.useState(""),[h,m]=E.useState(!1),[y,b]=E.useState({}),[v,x]=E.useState({}),w=E.useCallback(async()=>{if(!a.trim()){ke.error("Mod name cannot be empty.");return}if(!l.trim()&&!u.trim()){ke.error("Either Mod URL or Script Content must be provided.");return}if(l.trim()&&u.trim()){ke.error("Provide either a Mod URL or Script Content, not both.");return}m(!0);try{const T={name:a.trim(),sourceUrl:l.trim()||null,scriptContent:u.trim()||null,enabled:!0,loadOrder:((s==null?void 0:s.length)??1)*10};await t(T),o(""),c(""),d(""),ke.info("Mod added. Reload required for changes to take effect.")}catch(T){console.error("Failed to add mod (from component):",T)}finally{m(!1)}},[a,l,u,t,s==null?void 0:s.length]),_=E.useCallback(async T=>{b(A=>({...A,[T.id]:!0}));try{await n(T.id,{enabled:!T.enabled}),ke.info(`Mod "${T.name}" ${T.enabled?"disabled":"enabled"}. Reload required for changes to take effect.`)}catch(A){console.error("Failed to update mod (from component):",A)}finally{b(A=>({...A,[T.id]:!1}))}},[n]),k=E.useCallback(async T=>{if(window.confirm(`Are you sure you want to delete the mod "${T.name}"? This cannot be undone.`)){x(A=>({...A,[T.id]:!0}));try{await r(T.id),ke.info("Mod deleted. Reload required for changes to take effect.")}catch(A){console.error("Failed to delete mod (from component):",A)}finally{x(A=>({...A,[T.id]:!1}))}}},[r]),C=E.useCallback(T=>{const A=e.find(I=>I.id===T);if(A)if(A.error){const I=A.error instanceof Error?A.error.message:String(A.error);return{status:"Error",error:A.error,tooltip:I}}else return{status:"Loaded"};const N=(s||[]).find(I=>I.id===T);return N?N.enabled?{status:"Load Pending (Reload Required)"}:{status:"Disabled"}:{status:"Unknown"}},[e,s]);return f.jsxs("div",{className:"space-y-6 p-1",children:[f.jsxs(XD,{variant:"destructive",className:"border-destructive/50",children:[f.jsx(rO,{className:"h-4 w-4"}),f.jsx(JD,{children:"Security Warning"}),f.jsx(QD,{children:"Running mods from untrusted sources can compromise your security and privacy. Mods execute arbitrary JavaScript code within LiteChat and can potentially access sensitive data like API keys stored in the browser or interact with external services. Only install mods you trust. LiteChat is not responsible for any damage caused by mods."})]}),f.jsxs("div",{className:"space-y-4 rounded-md border p-4",children:[f.jsx("h3",{className:"text-lg font-medium",children:"Add New Mod"}),f.jsxs("div",{className:"space-y-2",children:[f.jsx(Nt,{htmlFor:"mod-name",children:"Mod Name"}),f.jsx(vn,{id:"mod-name",value:a,onChange:T=>o(T.target.value),placeholder:"My Awesome Mod",disabled:h})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx(Nt,{htmlFor:"mod-url",children:"Source URL (Optional)"}),f.jsx(vn,{id:"mod-url",type:"url",value:l,onChange:T=>c(T.target.value),placeholder:"https://example.com/my-mod.js",disabled:h||!!u.trim()})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx(Nt,{htmlFor:"mod-script",children:"Script Content (Optional)"}),f.jsx(Ci,{id:"mod-script",value:u,onChange:T=>d(T.target.value),placeholder:`/* Paste your mod script here */
// Example: modApi.log('log', 'My Mod Loaded!');`,className:"min-h-[100px] font-mono text-xs",disabled:h||!!l.trim()})]}),f.jsxs(ot,{onClick:w,disabled:h,children:[h&&f.jsx(Hn,{className:"mr-2 h-4 w-4 animate-spin"}),h?"Adding...":"Add Mod"]})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx("h3",{className:"text-lg font-medium",children:"Installed Mods"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Enable or disable mods below. A page reload is required for changes to fully take effect."}),f.jsx("div",{className:"rounded-md border",children:f.jsx(wr,{delayDuration:100,children:f.jsxs(Sf,{children:[f.jsx(vp,{children:f.jsxs(As,{children:[f.jsx(Rr,{children:"Name"}),f.jsx(Rr,{children:"Source"}),f.jsx(Rr,{children:"Status"}),f.jsx(Rr,{className:"text-center",children:"Enabled"}),f.jsx(Rr,{className:"text-right",children:"Actions"})]})}),f.jsx(_f,{children:i?f.jsxs(f.Fragment,{children:[f.jsx(As,{children:f.jsx(Bn,{colSpan:5,children:f.jsx(Gr,{className:"h-10 w-full"})})}),f.jsx(As,{children:f.jsx(Bn,{colSpan:5,children:f.jsx(Gr,{className:"h-10 w-full"})})})]}):(s||[]).length===0?f.jsx(As,{children:f.jsx(Bn,{colSpan:5,className:"h-24 text-center",children:"No mods installed yet."})}):(s||[]).map(T=>{const{status:A,error:N,tooltip:I}=C(T.id),j=T.sourceUrl?new URL(T.sourceUrl).hostname:"Direct Script",L=y[T.id],D=v[T.id],H=L||D,O=A==="Error";return f.jsxs(As,{children:[f.jsx(Bn,{className:"font-medium",children:T.name}),f.jsx(Bn,{className:"text-muted-foreground",children:j}),f.jsxs(Bn,{children:[f.jsxs(Sr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx("span",{className:O?"text-destructive font-semibold cursor-help":"",children:A})}),I&&f.jsx(Cr,{className:"max-w-xs break-words",children:f.jsx("p",{children:I})})]}),O&&N&&f.jsx("p",{className:"text-xs text-destructive truncate",children:N instanceof Error?N.message:String(N)})]}),f.jsxs(Bn,{className:"text-center",children:[f.jsx(fo,{checked:T.enabled??!1,onCheckedChange:()=>_(T),disabled:H,"aria-label":`Enable ${T.name}`}),L&&f.jsx(Hn,{className:"h-4 w-4 animate-spin inline-block ml-2"})]}),f.jsx(Bn,{className:"text-right",children:f.jsx(ot,{variant:"ghost",size:"icon",onClick:()=>k(T),disabled:H,"aria-label":`Delete ${T.name}`,className:"text-destructive hover:text-destructive/80",children:D?f.jsx(Hn,{className:"h-4 w-4 animate-spin"}):f.jsx(Vo,{className:"h-4 w-4"})})})]},T.id)})})]})})})]})]})},yZe=Ve.memo(gZe);class bZe{constructor(){ce(this,"id","core-settings-mods");ce(this,"unregisterCallback",null)}async initialize(t){}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerSettingsTab({id:"mods",title:"Mods",component:yZe,order:80})}destroy(){this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),console.log(`[${this.id}] Destroyed.`)}}const vZe=({interactionId:e,contentToCopy:t,disabled:n})=>{const[r]=E.useState(!1),s=E.useCallback(async i=>{if(i.stopPropagation(),n||!t){ke.info("No content to copy or action disabled.");return}Ce.emit(Gi.copyInteractionResponseRequest,{interactionId:e})},[e,t,n]);return f.jsx(Un,{tooltipText:"Copy",onClick:s,"aria-label":"Copy content",disabled:n||!t,icon:r?f.jsx(bo,{className:"text-green-500"}):f.jsx(TE,{}),className:"h-5 w-5"})};class xZe{constructor(){ce(this,"id","core-canvas-copy-action")}async initialize(t){}register(t){t.registerCanvasControl({id:this.id,type:"interaction",targetSlot:"header-actions",renderer:n=>n.interactionId?Ve.createElement(vZe,{interactionId:n.interactionId,contentToCopy:n.responseContent??"",disabled:!n.responseContent||n.responseContent.trim()===""}):(console.warn("CopyActionControlModule: interactionId is missing in context for an interaction control."),null)})}destroy(t){}}const wZe=({interactionId:e,disabled:t})=>{const n=r=>{if(r.stopPropagation(),t){ke.info("Regeneration is currently disabled.");return}Ce.emit(Gi.regenerateInteractionRequest,{interactionId:e})};return f.jsx(Un,{tooltipText:"Regenerate",onClick:n,"aria-label":"Regenerate Response",disabled:t,icon:f.jsx(Tm,{}),className:"h-5 w-5 md:h-6 md:w-6"})};class SZe{constructor(){ce(this,"id","core-canvas-regenerate-action")}async initialize(t){}register(t){t.registerCanvasControl({id:this.id,type:"interaction",targetSlot:"actions",renderer:n=>{if(!n.interactionId||!n.interaction)return null;const r=n.interaction,s=nn.getState(),i=s.status,a=s.interactions.filter(u=>u.conversationId===r.conversationId&&u.parentId===null&&(u.type==="message.user_assistant"||u.type==="message.assistant_regen"));a.sort((u,d)=>u.index-d.index);const o=a.length>0?a[a.length-1]:null,l=(o==null?void 0:o.id)===r.id,c=l&&(r.status==="COMPLETED"||r.status==="ERROR")&&i!=="streaming";return l?Ve.createElement(wZe,{interactionId:r.id,disabled:!c}):null}})}destroy(t){}}const _Ze=({module:e,interactionId:t,disabled:n})=>{const[r,s]=E.useState(!1),[,i]=E.useState({});E.useEffect(()=>{if(e)return e.setNotifyCallback(()=>i({})),()=>e.setNotifyCallback(null)},[e]);const a=l=>{if(!l){s(!1);return}s(!1),Ce.emit(Gi.regenerateInteractionWithModelRequest,{interactionId:t,modelId:l})},o=l=>{if(l.stopPropagation(),n){ke.info("Regeneration is currently disabled.");return}s(!r)};return r?f.jsx("div",{className:"relative",children:f.jsx(xp,{models:e.globallyEnabledModels,value:null,onChange:a,isLoading:e.isLoadingProviders})}):f.jsx(Un,{tooltipText:"Regenerate with Model",onClick:o,"aria-label":"Regenerate Response with Model Selection",disabled:n,icon:f.jsx(_ge,{}),className:"h-5 w-5 md:h-6 md:w-6"})};class CZe{constructor(){ce(this,"id","core-canvas-regenerate-with-model-action");ce(this,"eventUnsubscribers",[]);ce(this,"notifyComponentUpdate",null);ce(this,"globallyEnabledModels",[]);ce(this,"isLoadingProviders",!0)}async initialize(t){const n=Gn.getState();this.isLoadingProviders=n.isLoading,this.globallyEnabledModels=n.getGloballyEnabledModelDefinitions();const r=t.on(Vn.globallyEnabledModelsUpdated,a=>{var c;let o=!1;JSON.stringify(this.globallyEnabledModels)!==JSON.stringify(a.models)&&(this.globallyEnabledModels=a.models,o=!0);const l=Gn.getState().isLoading;this.isLoadingProviders!==l&&(this.isLoadingProviders=l,o=!0),o&&((c=this.notifyComponentUpdate)==null||c.call(this))}),s=t.on(Vn.initialDataLoaded,()=>{var c;const a=Gn.getState();let o=!1;this.isLoadingProviders!==a.isLoading&&(this.isLoadingProviders=a.isLoading,o=!0);const l=a.getGloballyEnabledModelDefinitions();JSON.stringify(this.globallyEnabledModels)!==JSON.stringify(l)&&(this.globallyEnabledModels=l,o=!0),o&&((c=this.notifyComponentUpdate)==null||c.call(this))}),i=t.on(xn.statusChanged,()=>{var a;(a=this.notifyComponentUpdate)==null||a.call(this)});this.eventUnsubscribers.push(r,s,i)}setNotifyCallback(t){this.notifyComponentUpdate=t}register(t){t.registerCanvasControl({id:this.id,type:"interaction",targetSlot:"actions",renderer:n=>{if(!n.interactionId||!n.interaction)return null;const r=n.interaction,s=nn.getState(),i=s.status,a=s.interactions.filter(u=>u.conversationId===r.conversationId&&u.parentId===null&&(u.type==="message.user_assistant"||u.type==="message.assistant_regen"));a.sort((u,d)=>u.index-d.index);const o=a.length>0?a[a.length-1]:null,l=(o==null?void 0:o.id)===r.id,c=l&&(r.status==="COMPLETED"||r.status==="ERROR")&&i!=="streaming";return l?Ve.createElement(_Ze,{module:this,interactionId:r.id,disabled:!c}):null}})}async cleanup(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.notifyComponentUpdate=null}async destroy(){await this.cleanup()}}const kZe=({interactionId:e,disabled:t})=>{const n=r=>{if(r.stopPropagation(),t){ke.info("Fork is currently disabled.");return}Ce.emit(Gi.forkConversationRequest,{interactionId:e})};return f.jsx(Un,{tooltipText:"Fork",onClick:n,"aria-label":"Fork Conversation",disabled:t,icon:f.jsx(UH,{}),className:"h-5 w-5 md:h-6 md:w-6"})};class EZe{constructor(){ce(this,"id","core-canvas-fork-action")}async initialize(t){}register(t){t.registerCanvasControl({id:this.id,type:"interaction",targetSlot:"actions",renderer:n=>{if(!n.interactionId||!n.interaction)return null;const r=n.interaction,s=nn.getState(),i=s.status,a=s.interactions.filter(u=>u.conversationId===r.conversationId&&u.parentId===null&&(u.type==="message.user_assistant"||u.type==="message.assistant_regen"));a.sort((u,d)=>u.index-d.index);const o=a.length>0?a[a.length-1]:null;if((o==null?void 0:o.id)===r.id)return null;const c=(r.status==="COMPLETED"||r.status==="ERROR")&&i!=="streaming";return Ve.createElement(kZe,{interactionId:r.id,disabled:!c})}})}destroy(t){}}const TZe=({module:e,interactionId:t,disabled:n})=>{const[r,s]=E.useState(!1),[,i]=E.useState({});E.useEffect(()=>{if(e)return e.setNotifyCallback(()=>i({})),()=>e.setNotifyCallback(null)},[e]);const a=l=>{if(!l){s(!1);return}s(!1),Ce.emit(Gi.forkConversationWithModelRequest,{interactionId:t,modelId:l})},o=l=>{if(l.stopPropagation(),n){ke.info("Fork is currently disabled.");return}s(!r)};return r?f.jsx("div",{className:"relative",children:f.jsx(xp,{models:e.globallyEnabledModels,value:null,onChange:a,isLoading:e.isLoadingProviders})}):f.jsx(Un,{tooltipText:"Fork with",onClick:o,"aria-label":"Fork Conversation with Model Selection",disabled:n,icon:f.jsxs("div",{className:"relative",children:[f.jsx(UH,{className:"h-4 w-4"}),f.jsx(nc,{className:"absolute -top-1 -right-1 h-2 w-2"})]}),className:"h-5 w-5 md:h-6 md:w-6"})};class AZe{constructor(){ce(this,"id","core-canvas-fork-with-model-action");ce(this,"eventUnsubscribers",[]);ce(this,"notifyComponentUpdate",null);ce(this,"globallyEnabledModels",[]);ce(this,"isLoadingProviders",!0)}async initialize(t){const n=Gn.getState();this.isLoadingProviders=n.isLoading,this.globallyEnabledModels=n.getGloballyEnabledModelDefinitions();const r=t.on(Vn.globallyEnabledModelsUpdated,a=>{var c;let o=!1;JSON.stringify(this.globallyEnabledModels)!==JSON.stringify(a.models)&&(this.globallyEnabledModels=a.models,o=!0);const l=Gn.getState().isLoading;this.isLoadingProviders!==l&&(this.isLoadingProviders=l,o=!0),o&&((c=this.notifyComponentUpdate)==null||c.call(this))}),s=t.on(Vn.initialDataLoaded,()=>{var c;const a=Gn.getState();let o=!1;this.isLoadingProviders!==a.isLoading&&(this.isLoadingProviders=a.isLoading,o=!0);const l=a.getGloballyEnabledModelDefinitions();JSON.stringify(this.globallyEnabledModels)!==JSON.stringify(l)&&(this.globallyEnabledModels=l,o=!0),o&&((c=this.notifyComponentUpdate)==null||c.call(this))}),i=t.on(xn.statusChanged,()=>{var a;(a=this.notifyComponentUpdate)==null||a.call(this)});this.eventUnsubscribers.push(r,s,i)}setNotifyCallback(t){this.notifyComponentUpdate=t}register(t){t.registerCanvasControl({id:this.id,type:"interaction",targetSlot:"actions",renderer:n=>{if(!n.interactionId||!n.interaction)return null;const r=n.interaction,s=nn.getState(),i=s.status,a=s.interactions.filter(u=>u.conversationId===r.conversationId&&u.parentId===null&&(u.type==="message.user_assistant"||u.type==="message.assistant_regen"));a.sort((u,d)=>u.index-d.index);const o=a.length>0?a[a.length-1]:null;if((o==null?void 0:o.id)===r.id)return null;const c=(r.status==="COMPLETED"||r.status==="ERROR")&&i!=="streaming";return Ve.createElement(TZe,{module:this,interactionId:r.id,disabled:!c})}})}async cleanup(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.notifyComponentUpdate=null}async destroy(){await this.cleanup()}}const RZe=({module:e,interactionId:t,disabled:n})=>{const[r,s]=E.useState(!1),[,i]=E.useState({});E.useEffect(()=>{if(e)return e.setNotifyCallback(()=>i({})),()=>e.setNotifyCallback(null)},[e]);const a=l=>{if(!l){s(!1);return}s(!1),Ce.emit(Gi.forkConversationCompactRequest,{interactionId:t,modelId:l})},o=l=>{if(l.stopPropagation(),n){ke.info("Fork compact is currently disabled.");return}s(!r)};return r?f.jsx("div",{className:"relative",children:f.jsx(xp,{models:e.globallyEnabledModels,value:null,onChange:a,isLoading:e.isLoadingProviders})}):f.jsx(Un,{tooltipText:"Summarize",onClick:o,"aria-label":"Fork Conversation with Compact Summary",disabled:n,icon:f.jsx(Vpe,{className:"h-4 w-4"}),className:"h-5 w-5 md:h-6 md:w-6"})};class NZe{constructor(){ce(this,"id","core-canvas-fork-compact-action");ce(this,"eventUnsubscribers",[]);ce(this,"notifyComponentUpdate",null);ce(this,"globallyEnabledModels",[]);ce(this,"isLoadingProviders",!0)}async initialize(t){const n=Gn.getState();this.isLoadingProviders=n.isLoading,this.globallyEnabledModels=n.getGloballyEnabledModelDefinitions();const r=t.on(Vn.globallyEnabledModelsUpdated,a=>{var c;let o=!1;JSON.stringify(this.globallyEnabledModels)!==JSON.stringify(a.models)&&(this.globallyEnabledModels=a.models,o=!0);const l=Gn.getState().isLoading;this.isLoadingProviders!==l&&(this.isLoadingProviders=l,o=!0),o&&((c=this.notifyComponentUpdate)==null||c.call(this))}),s=t.on(Vn.initialDataLoaded,()=>{var c;const a=Gn.getState();let o=!1;this.isLoadingProviders!==a.isLoading&&(this.isLoadingProviders=a.isLoading,o=!0);const l=a.getGloballyEnabledModelDefinitions();JSON.stringify(this.globallyEnabledModels)!==JSON.stringify(l)&&(this.globallyEnabledModels=l,o=!0),o&&((c=this.notifyComponentUpdate)==null||c.call(this))}),i=t.on(xn.statusChanged,()=>{var a;(a=this.notifyComponentUpdate)==null||a.call(this)});this.eventUnsubscribers.push(r,s,i)}setNotifyCallback(t){this.notifyComponentUpdate=t}register(t){t.registerCanvasControl({id:this.id,type:"interaction",targetSlot:"actions",renderer:n=>{if(!n.interactionId||!n.interaction)return null;const r=n.interaction,i=nn.getState().status,a=(r.status==="COMPLETED"||r.status==="ERROR")&&i!=="streaming";return Ve.createElement(RZe,{module:this,interactionId:r.id,disabled:!a})}})}async cleanup(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.notifyComponentUpdate=null}async destroy(){await this.cleanup()}}const IZe=({interactionId:e,currentRating:t})=>{const[n,r]=E.useState(!1),s=c=>{const u=c===t?null:c;Ce.emit(xn.rateInteractionRequest,{interactionId:e,rating:u}),r(!1)},i=Array.from({length:11},(c,u)=>u-5);let a="text-muted-foreground",o="",l="hover:text-foreground";return t!=null&&(t<0?(a="text-red-500",o="fill-red-500"):t===0?(a="text-gray-500",o="fill-gray-500"):(a="text-green-500",o="fill-green-500")),f.jsxs(gc,{open:n,onOpenChange:r,children:[f.jsx(yc,{asChild:!0,children:f.jsx(Un,{tooltipText:t!=null?`Rating: ${t}`:"Rate response",onClick:()=>r(!n),"aria-label":"Rate response",icon:f.jsx(KB,{className:Ye(o,t!=null?"fill-current":"fill-none")}),variant:"ghost",className:Ye("h-4 w-4 md:h-5 md:w-5 p-0",a,l)})}),f.jsx(bc,{className:"w-80 p-4",align:"start",children:f.jsxs("div",{className:"space-y-3",children:[f.jsx("div",{className:"text-sm font-medium",children:"Rate this response"}),f.jsx("div",{className:"grid grid-cols-11 gap-1",children:i.map(c=>{let u="";c===-5?u="Terrible":c===-4?u="Very Bad":c===-3?u="Bad":c===-2?u="Poor":c===-1?u="Below Average":c===0?u="Neutral":c===1?u="Above Average":c===2?u="Good":c===3?u="Very Good":c===4?u="Excellent":c===5&&(u="Perfect");let d="text-muted-foreground",h="hover:text-foreground",m="";c<0?(h="hover:text-red-500",t===c&&(d="text-red-500",m="fill-red-500")):c===0?(h="hover:text-gray-500",t===c&&(d="text-gray-500",m="fill-gray-500")):(h="hover:text-green-500",t===c&&(d="text-green-500",m="fill-green-500"));const y=t===c?"bg-muted":"";return f.jsx(Un,{tooltipText:`${c}: ${u}`,onClick:()=>s(c),"aria-label":`Rate response as ${u} (${c})`,icon:f.jsx(KB,{className:Ye(m,t===c?"fill-current":"fill-none")}),variant:"ghost",className:Ye("h-6 w-6 p-0",d,h,y)},c)})}),f.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[f.jsx("span",{children:"-5 (Terrible)"}),f.jsx("span",{children:"0 (Neutral)"}),f.jsx("span",{children:"+5 (Perfect)"})]}),t!=null&&f.jsx("div",{className:"pt-2 border-t",children:f.jsx("button",{onClick:()=>s(null),className:"text-xs text-muted-foreground hover:text-foreground",children:"Clear rating"})})]})})]})};class MZe{constructor(){ce(this,"id","core-canvas-rating-action")}async initialize(t){}register(t){t.registerCanvasControl({id:this.id,type:"interaction",targetSlot:"actions",renderer:n=>!n.interactionId||!n.interaction?null:Ve.createElement(IZe,{interactionId:n.interactionId,currentRating:n.interaction.rating})})}destroy(t){}}const jZe=({interactionId:e,response:t,disabled:n})=>{const[r,s]=E.useState(!1),[i,a]=E.useState(""),o=u=>{if(u.stopPropagation(),n){ke.info("Response editing is currently disabled.");return}a(t||""),s(!0)},l=()=>{if(i.trim()===""){ke.error("Response cannot be empty");return}Ce.emit(Gi.editResponseRequest,{interactionId:e,newContent:i.trim()}),s(!1),ke.success("Response edited successfully")},c=()=>{s(!1),a("")};return f.jsxs(f.Fragment,{children:[f.jsx(Un,{tooltipText:"Edit Response",onClick:o,"aria-label":"Edit Assistant Response",disabled:n,icon:f.jsx(nO,{}),className:"h-5 max-w-7xl md:h-6 md:max-w-6xl"}),f.jsx(td,{open:r,onOpenChange:s,children:f.jsxs(nd,{className:"!w-[80vw] !h-[85vh] !max-w-none flex flex-col",children:[f.jsx(rd,{children:f.jsx(sd,{children:"Edit Assistant Response"})}),f.jsx("div",{className:"flex-1 space-y-4 overflow-hidden",children:f.jsxs("div",{className:"space-y-2 h-full",children:[f.jsx(Nt,{htmlFor:"response-edit",children:"Response Content"}),f.jsx(Ci,{id:"response-edit",value:i,onChange:u=>a(u.target.value),placeholder:"Edit the assistant's response...",className:"min-h-[60vh] h-full resize-none text-sm leading-relaxed"})]})}),f.jsxs(dg,{className:"flex-shrink-0",children:[f.jsx(ot,{variant:"outline",onClick:c,children:"Cancel"}),f.jsx(ot,{onClick:l,children:"Save Changes"})]})]})})]})};class PZe{constructor(){ce(this,"id","core-canvas-edit-response-action");ce(this,"eventUnsubscribers",[])}async initialize(t){const n=t.on(Gi.editResponseRequest,async r=>{await this.handleResponseEdit(r.interactionId,r.newContent)});this.eventUnsubscribers.push(n)}async handleResponseEdit(t,n){var r;try{const s=nn.getState(),i=s.interactions.find(y=>y.id===t);if(!i)throw new Error("Original interaction not found");if(i.status!=="COMPLETED")throw new Error("Can only edit completed interactions");const a=Nr(),o={...i,id:a,response:n,parentId:null,index:i.index,metadata:{...i.metadata,editedResponse:!0,editedFromId:i.id},endedAt:new Date};s._addInteractionToState(o);const l=s.interactions.filter(y=>y.parentId===i.id),c=[];let u=i;for(;u;){c.push(u);const y=(r=u.metadata)==null?void 0:r.editedFromId;y?u=s.interactions.find(b=>b.id===y):u=void 0}const d=c.sort((y,b)=>{var w,_;const v=((w=y.startedAt)==null?void 0:w.getTime())??0,x=((_=b.startedAt)==null?void 0:_.getTime())??0;return v-x}),h=d.map(async(y,b)=>{const v={parentId:a,index:b,metadata:{...y.metadata,originalVersion:b===0}};return console.log(`[EditResponseControlModule] Updating version ${y.id} to be child of ${a} with childIndex ${b}`),s._updateInteractionInState(y.id,v),yt.saveInteraction({...y,...v})}),m=l.map(async y=>{const b={parentId:a,index:d.length+y.index};return s._updateInteractionInState(y.id,b),yt.saveInteraction({...y,...b})});await Promise.all([yt.saveInteraction(o),...h,...m]),console.log(`[EditResponseControlModule] Response edited successfully. Original: ${t}, Edited: ${a}`)}catch(s){throw console.error("[EditResponseControlModule] Failed to edit response:",s),s}}register(t){t.registerCanvasControl({id:this.id,type:"interaction",targetSlot:"actions",renderer:n=>{if(!n.interactionId||!n.interaction)return null;const r=n.interaction,i=nn.getState().status,a=r.status==="COMPLETED"&&r.response&&typeof r.response=="string"&&i!=="streaming"&&(r.type==="message.user_assistant"||r.type==="message.assistant_regen");return a?Ve.createElement(jZe,{interactionId:r.id,response:r.response,disabled:!a}):null}})}async cleanup(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[]}async destroy(){await this.cleanup()}}var Po={},CV;function OZe(){if(CV)return Po;CV=1;var e=Po&&Po.__assign||function(){return e=Object.assign||function(C){for(var T,A=1,N=arguments.length;A<N;A++){T=arguments[A];for(var I in T)Object.prototype.hasOwnProperty.call(T,I)&&(C[I]=T[I])}return C},e.apply(this,arguments)},t=Po&&Po.__createBinding||(Object.create?function(C,T,A,N){N===void 0&&(N=A);var I=Object.getOwnPropertyDescriptor(T,A);(!I||("get"in I?!T.__esModule:I.writable||I.configurable))&&(I={enumerable:!0,get:function(){return T[A]}}),Object.defineProperty(C,N,I)}:function(C,T,A,N){N===void 0&&(N=A),C[N]=T[A]}),n=Po&&Po.__setModuleDefault||(Object.create?function(C,T){Object.defineProperty(C,"default",{enumerable:!0,value:T})}:function(C,T){C.default=T}),r=Po&&Po.__importStar||function(C){if(C&&C.__esModule)return C;var T={};if(C!=null)for(var A in C)A!=="default"&&Object.prototype.hasOwnProperty.call(C,A)&&t(T,C,A);return n(T,C),T},s=Po&&Po.__rest||function(C,T){var A={};for(var N in C)Object.prototype.hasOwnProperty.call(C,N)&&T.indexOf(N)<0&&(A[N]=C[N]);if(C!=null&&typeof Object.getOwnPropertySymbols=="function")for(var I=0,N=Object.getOwnPropertySymbols(C);I<N.length;I++)T.indexOf(N[I])<0&&Object.prototype.propertyIsEnumerable.call(C,N[I])&&(A[N[I]]=C[N[I]]);return A};Object.defineProperty(Po,"__esModule",{value:!0});var i=r(Zy()),a=89,o=90,l=77,c=57,u=219,d=222,h=192,m=100,y=3e3,b=typeof window<"u"&&"navigator"in window&&/Win/i.test(navigator.platform),v=typeof window<"u"&&"navigator"in window&&/(Mac|iPhone|iPod|iPad)/i.test(navigator.platform),x="npm__react-simple-code-editor__textarea",w=`
/**
 * Reset the text fill color so that placeholder is visible
 */
.`.concat(x,`:empty {
  -webkit-text-fill-color: inherit !important;
}

/**
 * Hack to apply on some CSS on IE10 and IE11
 */
@media all and (-ms-high-contrast: none), (-ms-high-contrast: active) {
  /**
    * IE doesn't support '-webkit-text-fill-color'
    * So we use 'color: transparent' to make the text transparent on IE
    * Unlike other browsers, it doesn't affect caret color in IE
    */
  .`).concat(x,` {
    color: transparent !important;
  }

  .`).concat(x,`::selection {
    background-color: #accef7 !important;
    color: transparent !important;
  }
}
`),_=i.forwardRef(function(T,A){var N=T.autoFocus,I=T.disabled,j=T.form,L=T.highlight,D=T.ignoreTabKey,H=D===void 0?!1:D,O=T.insertSpaces,K=O===void 0?!0:O,U=T.maxLength,W=T.minLength,B=T.name,ne=T.onBlur,V=T.onClick,Q=T.onFocus,ee=T.onKeyDown,re=T.onKeyUp,de=T.onValueChange,me=T.padding,De=me===void 0?0:me,je=T.placeholder,Te=T.preClassName,_e=T.readOnly,Ue=T.required,Qe=T.style,We=T.tabSize,Pe=We===void 0?2:We,Y=T.textareaClassName,ye=T.textareaId,Me=T.value,ue=s(T,["autoFocus","disabled","form","highlight","ignoreTabKey","insertSpaces","maxLength","minLength","name","onBlur","onClick","onFocus","onKeyDown","onKeyUp","onValueChange","padding","placeholder","preClassName","readOnly","required","style","tabSize","textareaClassName","textareaId","value"]),oe=i.useRef({stack:[],offset:-1}),se=i.useRef(null),Ie=i.useState(!0),Be=Ie[0],Re=Ie[1],ct={paddingTop:typeof De=="object"?De.top:De,paddingRight:typeof De=="object"?De.right:De,paddingBottom:typeof De=="object"?De.bottom:De,paddingLeft:typeof De=="object"?De.left:De},At=L(Me),ut=function(Ee,ge){return Ee.substring(0,ge).split(`
`)},Pt=i.useCallback(function(Ee,ge){var Ae,le,ft;ge===void 0&&(ge=!1);var et=oe.current,$=et.stack,qe=et.offset;if($.length&&qe>-1){oe.current.stack=$.slice(0,qe+1);var tt=oe.current.stack.length;if(tt>m){var ve=tt-m;oe.current.stack=$.slice(ve,tt),oe.current.offset=Math.max(oe.current.offset-ve,0)}}var Se=Date.now();if(ge){var ze=oe.current.stack[oe.current.offset];if(ze&&Se-ze.timestamp<y){var Ct=/[^a-z0-9]([a-z0-9]+)$/i,fe=(Ae=ut(ze.value,ze.selectionStart).pop())===null||Ae===void 0?void 0:Ae.match(Ct),Z=(le=ut(Ee.value,Ee.selectionStart).pop())===null||le===void 0?void 0:le.match(Ct);if(fe!=null&&fe[1]&&(!((ft=Z==null?void 0:Z[1])===null||ft===void 0)&&ft.startsWith(fe[1]))){oe.current.stack[oe.current.offset]=e(e({},Ee),{timestamp:Se});return}}}oe.current.stack.push(e(e({},Ee),{timestamp:Se})),oe.current.offset++},[]),Ut=i.useCallback(function(){var Ee=se.current;if(Ee){var ge=Ee.value,Ae=Ee.selectionStart,le=Ee.selectionEnd;Pt({value:ge,selectionStart:Ae,selectionEnd:le})}},[Pt]),Ft=function(Ee){var ge=se.current;ge&&(ge.value=Ee.value,ge.selectionStart=Ee.selectionStart,ge.selectionEnd=Ee.selectionEnd,de==null||de(Ee.value))},Yt=function(Ee){var ge=se.current,Ae=oe.current.stack[oe.current.offset];Ae&&ge&&(oe.current.stack[oe.current.offset]=e(e({},Ae),{selectionStart:ge.selectionStart,selectionEnd:ge.selectionEnd})),Pt(Ee),Ft(Ee)},we=function(){var Ee=oe.current,ge=Ee.stack,Ae=Ee.offset,le=ge[Ae-1];le&&(Ft(le),oe.current.offset=Math.max(Ae-1,0))},F=function(){var Ee=oe.current,ge=Ee.stack,Ae=Ee.offset,le=ge[Ae+1];le&&(Ft(le),oe.current.offset=Math.min(Ae+1,ge.length-1))},X=function(Ee){if(!(ee&&(ee(Ee),Ee.defaultPrevented))){Ee.key==="Escape"&&Ee.currentTarget.blur();var ge=Ee.currentTarget,Ae=ge.value,le=ge.selectionStart,ft=ge.selectionEnd,et=(K?" ":"	").repeat(Pe);if(Ee.key==="Tab"&&!H&&Be)if(Ee.preventDefault(),Ee.shiftKey){var $=ut(Ae,le),qe=$.length-1,tt=ut(Ae,ft).length-1,ve=Ae.split(`
`).map(function(wt,Qt){return Qt>=qe&&Qt<=tt&&wt.startsWith(et)?wt.substring(et.length):wt}).join(`
`);if(Ae!==ve){var Se=$[qe];Yt({value:ve,selectionStart:Se!=null&&Se.startsWith(et)?le-et.length:le,selectionEnd:ft-(Ae.length-ve.length)})}}else if(le!==ft){var $=ut(Ae,le),ze=$.length-1,Ct=ut(Ae,ft).length-1,Se=$[ze];Yt({value:Ae.split(`
`).map(function(Dn,Zt){return Zt>=ze&&Zt<=Ct?et+Dn:Dn}).join(`
`),selectionStart:Se&&/\S/.test(Se)?le+et.length:le,selectionEnd:ft+et.length*(Ct-ze+1)})}else{var fe=le+et.length;Yt({value:Ae.substring(0,le)+et+Ae.substring(ft),selectionStart:fe,selectionEnd:fe})}else if(Ee.key==="Backspace"){var Z=le!==ft,G=Ae.substring(0,le);if(G.endsWith(et)&&!Z){Ee.preventDefault();var fe=le-et.length;Yt({value:Ae.substring(0,le-et.length)+Ae.substring(ft),selectionStart:fe,selectionEnd:fe})}}else if(Ee.key==="Enter"){if(le===ft){var J=ut(Ae,le).pop(),xe=J==null?void 0:J.match(/^\s+/);if(xe!=null&&xe[0]){Ee.preventDefault();var Fe=`
`+xe[0],fe=le+Fe.length;Yt({value:Ae.substring(0,le)+Fe+Ae.substring(ft),selectionStart:fe,selectionEnd:fe})}}}else if(Ee.keyCode===c||Ee.keyCode===u||Ee.keyCode===d||Ee.keyCode===h){var He=void 0;Ee.keyCode===c&&Ee.shiftKey?He=["(",")"]:Ee.keyCode===u?Ee.shiftKey?He=["{","}"]:He=["[","]"]:Ee.keyCode===d?Ee.shiftKey?He=['"','"']:He=["'","'"]:Ee.keyCode===h&&!Ee.shiftKey&&(He=["`","`"]),le!==ft&&He&&(Ee.preventDefault(),Yt({value:Ae.substring(0,le)+He[0]+Ae.substring(le,ft)+He[1]+Ae.substring(ft),selectionStart:le,selectionEnd:ft+2}))}else(v?Ee.metaKey&&Ee.keyCode===o:Ee.ctrlKey&&Ee.keyCode===o)&&!Ee.shiftKey&&!Ee.altKey?(Ee.preventDefault(),we()):(v?Ee.metaKey&&Ee.keyCode===o&&Ee.shiftKey:b?Ee.ctrlKey&&Ee.keyCode===a:Ee.ctrlKey&&Ee.keyCode===o&&Ee.shiftKey)&&!Ee.altKey?(Ee.preventDefault(),F()):Ee.keyCode===l&&Ee.ctrlKey&&(!v||Ee.shiftKey)&&(Ee.preventDefault(),Re(function(wt){return!wt}))}},be=function(Ee){var ge=Ee.currentTarget,Ae=ge.value,le=ge.selectionStart,ft=ge.selectionEnd;Pt({value:Ae,selectionStart:le,selectionEnd:ft},!0),de(Ae)};return i.useEffect(function(){Ut()},[Ut]),i.useImperativeHandle(A,function(){return{get session(){return{history:oe.current}},set session(Ee){oe.current=Ee.history}}},[]),i.createElement("div",e({},ue,{style:e(e({},k.container),Qe)}),i.createElement("pre",e({className:Te,"aria-hidden":"true",style:e(e(e({},k.editor),k.highlight),ct)},typeof At=="string"?{dangerouslySetInnerHTML:{__html:At+"<br />"}}:{children:At})),i.createElement("textarea",{ref:function(Ee){return se.current=Ee},style:e(e(e({},k.editor),k.textarea),ct),className:x+(Y?" ".concat(Y):""),id:ye,value:Me,onChange:be,onKeyDown:X,onClick:V,onKeyUp:re,onFocus:Q,onBlur:ne,disabled:I,form:j,maxLength:U,minLength:W,name:B,placeholder:je,readOnly:_e,required:Ue,autoFocus:N,autoCapitalize:"off",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"data-gramm":!1}),i.createElement("style",{dangerouslySetInnerHTML:{__html:w}}))}),k={container:{position:"relative",textAlign:"left",boxSizing:"border-box",padding:0,overflow:"hidden"},textarea:{position:"absolute",top:0,left:0,height:"100%",width:"100%",resize:"none",color:"inherit",overflow:"hidden",MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",WebkitTextFillColor:"transparent"},highlight:{position:"relative",pointerEvents:"none"},editor:{margin:0,border:0,background:"none",boxSizing:"inherit",display:"inherit",fontFamily:"inherit",fontSize:"inherit",fontStyle:"inherit",fontVariantLigatures:"inherit",fontWeight:"inherit",letterSpacing:"inherit",lineHeight:"inherit",tabSize:"inherit",textIndent:"inherit",textRendering:"inherit",textTransform:"inherit",whiteSpace:"pre-wrap",wordBreak:"keep-all",overflowWrap:"break-word"}};return Po.default=_,Po}var DZe=OZe();const FZe=ga(DZe);var Pj={exports:{}},kV;function LZe(){return kV||(kV=1,function(e){var t=typeof window<"u"?window:typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope?self:{};/**
 * Prism: Lightweight, robust, elegant syntax highlighting
 *
 * @license MIT <https://opensource.org/licenses/MIT>
 * @author Lea Verou <https://lea.verou.me>
 * @namespace
 * @public
 */var n=function(r){var s=/(?:^|\s)lang(?:uage)?-([\w-]+)(?=\s|$)/i,i=0,a={},o={manual:r.Prism&&r.Prism.manual,disableWorkerMessageHandler:r.Prism&&r.Prism.disableWorkerMessageHandler,util:{encode:function w(_){return _ instanceof l?new l(_.type,w(_.content),_.alias):Array.isArray(_)?_.map(w):_.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ")},type:function(w){return Object.prototype.toString.call(w).slice(8,-1)},objId:function(w){return w.__id||Object.defineProperty(w,"__id",{value:++i}),w.__id},clone:function w(_,k){k=k||{};var C,T;switch(o.util.type(_)){case"Object":if(T=o.util.objId(_),k[T])return k[T];C={},k[T]=C;for(var A in _)_.hasOwnProperty(A)&&(C[A]=w(_[A],k));return C;case"Array":return T=o.util.objId(_),k[T]?k[T]:(C=[],k[T]=C,_.forEach(function(N,I){C[I]=w(N,k)}),C);default:return _}},getLanguage:function(w){for(;w;){var _=s.exec(w.className);if(_)return _[1].toLowerCase();w=w.parentElement}return"none"},setLanguage:function(w,_){w.className=w.className.replace(RegExp(s,"gi"),""),w.classList.add("language-"+_)},currentScript:function(){if(typeof document>"u")return null;if(document.currentScript&&document.currentScript.tagName==="SCRIPT")return document.currentScript;try{throw new Error}catch(C){var w=(/at [^(\r\n]*\((.*):[^:]+:[^:]+\)$/i.exec(C.stack)||[])[1];if(w){var _=document.getElementsByTagName("script");for(var k in _)if(_[k].src==w)return _[k]}return null}},isActive:function(w,_,k){for(var C="no-"+_;w;){var T=w.classList;if(T.contains(_))return!0;if(T.contains(C))return!1;w=w.parentElement}return!!k}},languages:{plain:a,plaintext:a,text:a,txt:a,extend:function(w,_){var k=o.util.clone(o.languages[w]);for(var C in _)k[C]=_[C];return k},insertBefore:function(w,_,k,C){C=C||o.languages;var T=C[w],A={};for(var N in T)if(T.hasOwnProperty(N)){if(N==_)for(var I in k)k.hasOwnProperty(I)&&(A[I]=k[I]);k.hasOwnProperty(N)||(A[N]=T[N])}var j=C[w];return C[w]=A,o.languages.DFS(o.languages,function(L,D){D===j&&L!=w&&(this[L]=A)}),A},DFS:function w(_,k,C,T){T=T||{};var A=o.util.objId;for(var N in _)if(_.hasOwnProperty(N)){k.call(_,N,_[N],C||N);var I=_[N],j=o.util.type(I);j==="Object"&&!T[A(I)]?(T[A(I)]=!0,w(I,k,null,T)):j==="Array"&&!T[A(I)]&&(T[A(I)]=!0,w(I,k,N,T))}}},plugins:{},highlightAll:function(w,_){o.highlightAllUnder(document,w,_)},highlightAllUnder:function(w,_,k){var C={callback:k,container:w,selector:'code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'};o.hooks.run("before-highlightall",C),C.elements=Array.prototype.slice.apply(C.container.querySelectorAll(C.selector)),o.hooks.run("before-all-elements-highlight",C);for(var T=0,A;A=C.elements[T++];)o.highlightElement(A,_===!0,C.callback)},highlightElement:function(w,_,k){var C=o.util.getLanguage(w),T=o.languages[C];o.util.setLanguage(w,C);var A=w.parentElement;A&&A.nodeName.toLowerCase()==="pre"&&o.util.setLanguage(A,C);var N=w.textContent,I={element:w,language:C,grammar:T,code:N};function j(D){I.highlightedCode=D,o.hooks.run("before-insert",I),I.element.innerHTML=I.highlightedCode,o.hooks.run("after-highlight",I),o.hooks.run("complete",I),k&&k.call(I.element)}if(o.hooks.run("before-sanity-check",I),A=I.element.parentElement,A&&A.nodeName.toLowerCase()==="pre"&&!A.hasAttribute("tabindex")&&A.setAttribute("tabindex","0"),!I.code){o.hooks.run("complete",I),k&&k.call(I.element);return}if(o.hooks.run("before-highlight",I),!I.grammar){j(o.util.encode(I.code));return}if(_&&r.Worker){var L=new Worker(o.filename);L.onmessage=function(D){j(D.data)},L.postMessage(JSON.stringify({language:I.language,code:I.code,immediateClose:!0}))}else j(o.highlight(I.code,I.grammar,I.language))},highlight:function(w,_,k){var C={code:w,grammar:_,language:k};if(o.hooks.run("before-tokenize",C),!C.grammar)throw new Error('The language "'+C.language+'" has no grammar.');return C.tokens=o.tokenize(C.code,C.grammar),o.hooks.run("after-tokenize",C),l.stringify(o.util.encode(C.tokens),C.language)},tokenize:function(w,_){var k=_.rest;if(k){for(var C in k)_[C]=k[C];delete _.rest}var T=new d;return h(T,T.head,w),u(w,T,_,T.head,0),y(T)},hooks:{all:{},add:function(w,_){var k=o.hooks.all;k[w]=k[w]||[],k[w].push(_)},run:function(w,_){var k=o.hooks.all[w];if(!(!k||!k.length))for(var C=0,T;T=k[C++];)T(_)}},Token:l};r.Prism=o;function l(w,_,k,C){this.type=w,this.content=_,this.alias=k,this.length=(C||"").length|0}l.stringify=function w(_,k){if(typeof _=="string")return _;if(Array.isArray(_)){var C="";return _.forEach(function(j){C+=w(j,k)}),C}var T={type:_.type,content:w(_.content,k),tag:"span",classes:["token",_.type],attributes:{},language:k},A=_.alias;A&&(Array.isArray(A)?Array.prototype.push.apply(T.classes,A):T.classes.push(A)),o.hooks.run("wrap",T);var N="";for(var I in T.attributes)N+=" "+I+'="'+(T.attributes[I]||"").replace(/"/g,"&quot;")+'"';return"<"+T.tag+' class="'+T.classes.join(" ")+'"'+N+">"+T.content+"</"+T.tag+">"};function c(w,_,k,C){w.lastIndex=_;var T=w.exec(k);if(T&&C&&T[1]){var A=T[1].length;T.index+=A,T[0]=T[0].slice(A)}return T}function u(w,_,k,C,T,A){for(var N in k)if(!(!k.hasOwnProperty(N)||!k[N])){var I=k[N];I=Array.isArray(I)?I:[I];for(var j=0;j<I.length;++j){if(A&&A.cause==N+","+j)return;var L=I[j],D=L.inside,H=!!L.lookbehind,O=!!L.greedy,K=L.alias;if(O&&!L.pattern.global){var U=L.pattern.toString().match(/[imsuy]*$/)[0];L.pattern=RegExp(L.pattern.source,U+"g")}for(var W=L.pattern||L,B=C.next,ne=T;B!==_.tail&&!(A&&ne>=A.reach);ne+=B.value.length,B=B.next){var V=B.value;if(_.length>w.length)return;if(!(V instanceof l)){var Q=1,ee;if(O){if(ee=c(W,ne,w,H),!ee||ee.index>=w.length)break;var De=ee.index,re=ee.index+ee[0].length,de=ne;for(de+=B.value.length;De>=de;)B=B.next,de+=B.value.length;if(de-=B.value.length,ne=de,B.value instanceof l)continue;for(var me=B;me!==_.tail&&(de<re||typeof me.value=="string");me=me.next)Q++,de+=me.value.length;Q--,V=w.slice(ne,de),ee.index-=ne}else if(ee=c(W,0,V,H),!ee)continue;var De=ee.index,je=ee[0],Te=V.slice(0,De),_e=V.slice(De+je.length),Ue=ne+V.length;A&&Ue>A.reach&&(A.reach=Ue);var Qe=B.prev;Te&&(Qe=h(_,Qe,Te),ne+=Te.length),m(_,Qe,Q);var We=new l(N,D?o.tokenize(je,D):je,K,je);if(B=h(_,Qe,We),_e&&h(_,B,_e),Q>1){var Pe={cause:N+","+j,reach:Ue};u(w,_,k,B.prev,ne,Pe),A&&Pe.reach>A.reach&&(A.reach=Pe.reach)}}}}}}function d(){var w={value:null,prev:null,next:null},_={value:null,prev:w,next:null};w.next=_,this.head=w,this.tail=_,this.length=0}function h(w,_,k){var C=_.next,T={value:k,prev:_,next:C};return _.next=T,C.prev=T,w.length++,T}function m(w,_,k){for(var C=_.next,T=0;T<k&&C!==w.tail;T++)C=C.next;_.next=C,C.prev=_,w.length-=T}function y(w){for(var _=[],k=w.head.next;k!==w.tail;)_.push(k.value),k=k.next;return _}if(!r.document)return r.addEventListener&&(o.disableWorkerMessageHandler||r.addEventListener("message",function(w){var _=JSON.parse(w.data),k=_.language,C=_.code,T=_.immediateClose;r.postMessage(o.highlight(C,o.languages[k],k)),T&&r.close()},!1)),o;var b=o.util.currentScript();b&&(o.filename=b.src,b.hasAttribute("data-manual")&&(o.manual=!0));function v(){o.manual||o.highlightAll()}if(!o.manual){var x=document.readyState;x==="loading"||x==="interactive"&&b&&b.defer?document.addEventListener("DOMContentLoaded",v):window.requestAnimationFrame?window.requestAnimationFrame(v):window.setTimeout(v,16)}return o}(t);e.exports&&(e.exports=n),typeof cm<"u"&&(cm.Prism=n),n.languages.markup={comment:{pattern:/<!--(?:(?!<!--)[\s\S])*?-->/,greedy:!0},prolog:{pattern:/<\?[\s\S]+?\?>/,greedy:!0},doctype:{pattern:/<!DOCTYPE(?:[^>"'[\]]|"[^"]*"|'[^']*')+(?:\[(?:[^<"'\]]|"[^"]*"|'[^']*'|<(?!!--)|<!--(?:[^-]|-(?!->))*-->)*\]\s*)?>/i,greedy:!0,inside:{"internal-subset":{pattern:/(^[^\[]*\[)[\s\S]+(?=\]>$)/,lookbehind:!0,greedy:!0,inside:null},string:{pattern:/"[^"]*"|'[^']*'/,greedy:!0},punctuation:/^<!|>$|[[\]]/,"doctype-tag":/^DOCTYPE/i,name:/[^\s<>'"]+/}},cdata:{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,greedy:!0},tag:{pattern:/<\/?(?!\d)[^\s>\/=$<%]+(?:\s(?:\s*[^\s>\/=]+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))|(?=[\s/>])))+)?\s*\/?>/,greedy:!0,inside:{tag:{pattern:/^<\/?[^\s>\/]+/,inside:{punctuation:/^<\/?/,namespace:/^[^\s>\/:]+:/}},"special-attr":[],"attr-value":{pattern:/=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+)/,inside:{punctuation:[{pattern:/^=/,alias:"attr-equals"},{pattern:/^(\s*)["']|["']$/,lookbehind:!0}]}},punctuation:/\/?>/,"attr-name":{pattern:/[^\s>\/]+/,inside:{namespace:/^[^\s>\/:]+:/}}}},entity:[{pattern:/&[\da-z]{1,8};/i,alias:"named-entity"},/&#x?[\da-f]{1,8};/i]},n.languages.markup.tag.inside["attr-value"].inside.entity=n.languages.markup.entity,n.languages.markup.doctype.inside["internal-subset"].inside=n.languages.markup,n.hooks.add("wrap",function(r){r.type==="entity"&&(r.attributes.title=r.content.replace(/&amp;/,"&"))}),Object.defineProperty(n.languages.markup.tag,"addInlined",{value:function(s,i){var a={};a["language-"+i]={pattern:/(^<!\[CDATA\[)[\s\S]+?(?=\]\]>$)/i,lookbehind:!0,inside:n.languages[i]},a.cdata=/^<!\[CDATA\[|\]\]>$/i;var o={"included-cdata":{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,inside:a}};o["language-"+i]={pattern:/[\s\S]+/,inside:n.languages[i]};var l={};l[s]={pattern:RegExp(/(<__[^>]*>)(?:<!\[CDATA\[(?:[^\]]|\](?!\]>))*\]\]>|(?!<!\[CDATA\[)[\s\S])*?(?=<\/__>)/.source.replace(/__/g,function(){return s}),"i"),lookbehind:!0,greedy:!0,inside:o},n.languages.insertBefore("markup","cdata",l)}}),Object.defineProperty(n.languages.markup.tag,"addAttribute",{value:function(r,s){n.languages.markup.tag.inside["special-attr"].push({pattern:RegExp(/(^|["'\s])/.source+"(?:"+r+")"+/\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))/.source,"i"),lookbehind:!0,inside:{"attr-name":/^[^\s=]+/,"attr-value":{pattern:/=[\s\S]+/,inside:{value:{pattern:/(^=\s*(["']|(?!["'])))\S[\s\S]*(?=\2$)/,lookbehind:!0,alias:[s,"language-"+s],inside:n.languages[s]},punctuation:[{pattern:/^=/,alias:"attr-equals"},/"|'/]}}}})}}),n.languages.html=n.languages.markup,n.languages.mathml=n.languages.markup,n.languages.svg=n.languages.markup,n.languages.xml=n.languages.extend("markup",{}),n.languages.ssml=n.languages.xml,n.languages.atom=n.languages.xml,n.languages.rss=n.languages.xml,function(r){var s=/(?:"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n])*')/;r.languages.css={comment:/\/\*[\s\S]*?\*\//,atrule:{pattern:RegExp("@[\\w-](?:"+/[^;{\s"']|\s+(?!\s)/.source+"|"+s.source+")*?"+/(?:;|(?=\s*\{))/.source),inside:{rule:/^@[\w-]+/,"selector-function-argument":{pattern:/(\bselector\s*\(\s*(?![\s)]))(?:[^()\s]|\s+(?![\s)])|\((?:[^()]|\([^()]*\))*\))+(?=\s*\))/,lookbehind:!0,alias:"selector"},keyword:{pattern:/(^|[^\w-])(?:and|not|only|or)(?![\w-])/,lookbehind:!0}}},url:{pattern:RegExp("\\burl\\((?:"+s.source+"|"+/(?:[^\\\r\n()"']|\\[\s\S])*/.source+")\\)","i"),greedy:!0,inside:{function:/^url/i,punctuation:/^\(|\)$/,string:{pattern:RegExp("^"+s.source+"$"),alias:"url"}}},selector:{pattern:RegExp(`(^|[{}\\s])[^{}\\s](?:[^{};"'\\s]|\\s+(?![\\s{])|`+s.source+")*(?=\\s*\\{)"),lookbehind:!0},string:{pattern:s,greedy:!0},property:{pattern:/(^|[^-\w\xA0-\uFFFF])(?!\s)[-_a-z\xA0-\uFFFF](?:(?!\s)[-\w\xA0-\uFFFF])*(?=\s*:)/i,lookbehind:!0},important:/!important\b/i,function:{pattern:/(^|[^-a-z0-9])[-a-z0-9]+(?=\()/i,lookbehind:!0},punctuation:/[(){};:,]/},r.languages.css.atrule.inside.rest=r.languages.css;var i=r.languages.markup;i&&(i.tag.addInlined("style","css"),i.tag.addAttribute("style","css"))}(n),n.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\s\S]*?(?:\*\/|$)/,lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|trait)\s+|\bcatch\s+\()[\w.\\]+/i,lookbehind:!0,inside:{punctuation:/[.\\]/}},keyword:/\b(?:break|catch|continue|do|else|finally|for|function|if|in|instanceof|new|null|return|throw|try|while)\b/,boolean:/\b(?:false|true)\b/,function:/\b\w+(?=\()/,number:/\b0x[\da-f]+\b|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?/i,operator:/[<>]=?|[!=]=?=?|--?|\+\+?|&&?|\|\|?|[?*/~^%]/,punctuation:/[{}[\];(),.:]/},n.languages.javascript=n.languages.extend("clike",{"class-name":[n.languages.clike["class-name"],{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$A-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\.(?:constructor|prototype))/,lookbehind:!0}],keyword:[{pattern:/((?:^|\})\s*)catch\b/,lookbehind:!0},{pattern:/(^|[^.]|\.\.\.\s*)\b(?:as|assert(?=\s*\{)|async(?=\s*(?:function\b|\(|[$\w\xA0-\uFFFF]|$))|await|break|case|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally(?=\s*(?:\{|$))|for|from(?=\s*(?:['"]|$))|function|(?:get|set)(?=\s*(?:[#\[$\w\xA0-\uFFFF]|$))|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)\b/,lookbehind:!0}],function:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*(?:\.\s*(?:apply|bind|call)\s*)?\()/,number:{pattern:RegExp(/(^|[^\w$])/.source+"(?:"+(/NaN|Infinity/.source+"|"+/0[bB][01]+(?:_[01]+)*n?/.source+"|"+/0[oO][0-7]+(?:_[0-7]+)*n?/.source+"|"+/0[xX][\dA-Fa-f]+(?:_[\dA-Fa-f]+)*n?/.source+"|"+/\d+(?:_\d+)*n/.source+"|"+/(?:\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\.\d+(?:_\d+)*)(?:[Ee][+-]?\d+(?:_\d+)*)?/.source)+")"+/(?![\w$])/.source),lookbehind:!0},operator:/--|\+\+|\*\*=?|=>|&&=?|\|\|=?|[!=]==|<<=?|>>>?=?|[-+*/%&|^!=<>]=?|\.{3}|\?\?=?|\?\.?|[~:]/}),n.languages.javascript["class-name"][0].pattern=/(\b(?:class|extends|implements|instanceof|interface|new)\s+)[\w.\\]+/,n.languages.insertBefore("javascript","keyword",{regex:{pattern:RegExp(/((?:^|[^$\w\xA0-\uFFFF."'\])\s]|\b(?:return|yield))\s*)/.source+/\//.source+"(?:"+/(?:\[(?:[^\]\\\r\n]|\\.)*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}/.source+"|"+/(?:\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.)*\])*\])*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}v[dgimyus]{0,7}/.source+")"+/(?=(?:\s|\/\*(?:[^*]|\*(?!\/))*\*\/)*(?:$|[\r\n,.;:})\]]|\/\/))/.source),lookbehind:!0,greedy:!0,inside:{"regex-source":{pattern:/^(\/)[\s\S]+(?=\/[a-z]*$)/,lookbehind:!0,alias:"language-regex",inside:n.languages.regex},"regex-delimiter":/^\/|\/$/,"regex-flags":/^[a-z]+$/}},"function-variable":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*[=:]\s*(?:async\s*)?(?:\bfunction\b|(?:\((?:[^()]|\([^()]*\))*\)|(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)\s*=>))/,alias:"function"},parameter:[{pattern:/(function(?:\s+(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)?\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\))/,lookbehind:!0,inside:n.languages.javascript},{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$a-z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*=>)/i,lookbehind:!0,inside:n.languages.javascript},{pattern:/(\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*=>)/,lookbehind:!0,inside:n.languages.javascript},{pattern:/((?:\b|\s|^)(?!(?:as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)(?![$\w\xA0-\uFFFF]))(?:(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*)\(\s*|\]\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*\{)/,lookbehind:!0,inside:n.languages.javascript}],constant:/\b[A-Z](?:[A-Z_]|\dx?)*\b/}),n.languages.insertBefore("javascript","string",{hashbang:{pattern:/^#!.*/,greedy:!0,alias:"comment"},"template-string":{pattern:/`(?:\\[\s\S]|\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}|(?!\$\{)[^\\`])*`/,greedy:!0,inside:{"template-punctuation":{pattern:/^`|`$/,alias:"string"},interpolation:{pattern:/((?:^|[^\\])(?:\\{2})*)\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}/,lookbehind:!0,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:"punctuation"},rest:n.languages.javascript}},string:/[\s\S]+/}},"string-property":{pattern:/((?:^|[,{])[ \t]*)(["'])(?:\\(?:\r\n|[\s\S])|(?!\2)[^\\\r\n])*\2(?=\s*:)/m,lookbehind:!0,greedy:!0,alias:"property"}}),n.languages.insertBefore("javascript","operator",{"literal-property":{pattern:/((?:^|[,{])[ \t]*)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*:)/m,lookbehind:!0,alias:"property"}}),n.languages.markup&&(n.languages.markup.tag.addInlined("script","javascript"),n.languages.markup.tag.addAttribute(/on(?:abort|blur|change|click|composition(?:end|start|update)|dblclick|error|focus(?:in|out)?|key(?:down|up)|load|mouse(?:down|enter|leave|move|out|over|up)|reset|resize|scroll|select|slotchange|submit|unload|wheel)/.source,"javascript")),n.languages.js=n.languages.javascript,function(){if(typeof n>"u"||typeof document>"u")return;Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector);var r="Loading…",s=function(b,v){return"✖ Error "+b+" while fetching file: "+v},i="✖ Error: File does not exist or is empty",a={js:"javascript",py:"python",rb:"ruby",ps1:"powershell",psm1:"powershell",sh:"bash",bat:"batch",h:"c",tex:"latex"},o="data-src-status",l="loading",c="loaded",u="failed",d="pre[data-src]:not(["+o+'="'+c+'"]):not(['+o+'="'+l+'"])';function h(b,v,x){var w=new XMLHttpRequest;w.open("GET",b,!0),w.onreadystatechange=function(){w.readyState==4&&(w.status<400&&w.responseText?v(w.responseText):w.status>=400?x(s(w.status,w.statusText)):x(i))},w.send(null)}function m(b){var v=/^\s*(\d+)\s*(?:(,)\s*(?:(\d+)\s*)?)?$/.exec(b||"");if(v){var x=Number(v[1]),w=v[2],_=v[3];return w?_?[x,Number(_)]:[x,void 0]:[x,x]}}n.hooks.add("before-highlightall",function(b){b.selector+=", "+d}),n.hooks.add("before-sanity-check",function(b){var v=b.element;if(v.matches(d)){b.code="",v.setAttribute(o,l);var x=v.appendChild(document.createElement("CODE"));x.textContent=r;var w=v.getAttribute("data-src"),_=b.language;if(_==="none"){var k=(/\.(\w+)$/.exec(w)||[,"none"])[1];_=a[k]||k}n.util.setLanguage(x,_),n.util.setLanguage(v,_);var C=n.plugins.autoloader;C&&C.loadLanguages(_),h(w,function(T){v.setAttribute(o,c);var A=m(v.getAttribute("data-range"));if(A){var N=T.split(/\r\n?|\n/g),I=A[0],j=A[1]==null?N.length:A[1];I<0&&(I+=N.length),I=Math.max(0,Math.min(I-1,N.length)),j<0&&(j+=N.length),j=Math.max(0,Math.min(j,N.length)),T=N.slice(I,j).join(`
`),v.hasAttribute("data-start")||v.setAttribute("data-start",String(I+1))}x.textContent=T,n.highlightElement(x)},function(T){v.setAttribute(o,u),x.textContent=T})}}),n.plugins.fileHighlight={highlight:function(v){for(var x=(v||document).querySelectorAll(d),w=0,_;_=x[w++];)n.highlightElement(_)}};var y=!1;n.fileHighlight=function(){y||(console.warn("Prism.fileHighlight is deprecated. Use `Prism.plugins.fileHighlight.highlight` instead."),y=!0),n.plugins.fileHighlight.highlight.apply(this,arguments)}}()}(Pj)),Pj.exports}var BZe=LZe();const Ys=ga(BZe);var EV={},TV;function $Ze(){return TV||(TV=1,function(e){e.languages.typescript=e.languages.extend("javascript",{"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|type)\s+)(?!keyof\b)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?:\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>)?/,lookbehind:!0,greedy:!0,inside:null},builtin:/\b(?:Array|Function|Promise|any|boolean|console|never|number|string|symbol|unknown)\b/}),e.languages.typescript.keyword.push(/\b(?:abstract|declare|is|keyof|readonly|require)\b/,/\b(?:asserts|infer|interface|module|namespace|type)\b(?=\s*(?:[{_$a-zA-Z\xA0-\uFFFF]|$))/,/\btype\b(?=\s*(?:[\{*]|$))/),delete e.languages.typescript.parameter,delete e.languages.typescript["literal-property"];var t=e.languages.extend("typescript",{});delete t["class-name"],e.languages.typescript["class-name"].inside=t,e.languages.insertBefore("typescript","function",{decorator:{pattern:/@[$\w\xA0-\uFFFF]+/,inside:{at:{pattern:/^@/,alias:"operator"},function:/^[\s\S]+/}},"generic-function":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>(?=\s*\()/,greedy:!0,inside:{function:/^#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*/,generic:{pattern:/<[\s\S]+/,alias:"class-name",inside:t}}}}),e.languages.ts=e.languages.typescript}(Prism)),EV}$Ze();var AV={},RV;function zZe(){return RV||(RV=1,Prism.languages.python={comment:{pattern:/(^|[^\\])#.*/,lookbehind:!0,greedy:!0},"string-interpolation":{pattern:/(?:f|fr|rf)(?:("""|''')[\s\S]*?\1|("|')(?:\\.|(?!\2)[^\\\r\n])*\2)/i,greedy:!0,inside:{interpolation:{pattern:/((?:^|[^{])(?:\{\{)*)\{(?!\{)(?:[^{}]|\{(?!\{)(?:[^{}]|\{(?!\{)(?:[^{}])+\})+\})+\}/,lookbehind:!0,inside:{"format-spec":{pattern:/(:)[^:(){}]+(?=\}$)/,lookbehind:!0},"conversion-option":{pattern:/![sra](?=[:}]$)/,alias:"punctuation"},rest:null}},string:/[\s\S]+/}},"triple-quoted-string":{pattern:/(?:[rub]|br|rb)?("""|''')[\s\S]*?\1/i,greedy:!0,alias:"string"},string:{pattern:/(?:[rub]|br|rb)?("|')(?:\\.|(?!\1)[^\\\r\n])*\1/i,greedy:!0},function:{pattern:/((?:^|\s)def[ \t]+)[a-zA-Z_]\w*(?=\s*\()/g,lookbehind:!0},"class-name":{pattern:/(\bclass\s+)\w+/i,lookbehind:!0},decorator:{pattern:/(^[\t ]*)@\w+(?:\.\w+)*/m,lookbehind:!0,alias:["annotation","punctuation"],inside:{punctuation:/\./}},keyword:/\b(?:_(?=\s*:)|and|as|assert|async|await|break|case|class|continue|def|del|elif|else|except|exec|finally|for|from|global|if|import|in|is|lambda|match|nonlocal|not|or|pass|print|raise|return|try|while|with|yield)\b/,builtin:/\b(?:__import__|abs|all|any|apply|ascii|basestring|bin|bool|buffer|bytearray|bytes|callable|chr|classmethod|cmp|coerce|compile|complex|delattr|dict|dir|divmod|enumerate|eval|execfile|file|filter|float|format|frozenset|getattr|globals|hasattr|hash|help|hex|id|input|int|intern|isinstance|issubclass|iter|len|list|locals|long|map|max|memoryview|min|next|object|oct|open|ord|pow|property|range|raw_input|reduce|reload|repr|reversed|round|set|setattr|slice|sorted|staticmethod|str|sum|super|tuple|type|unichr|unicode|vars|xrange|zip)\b/,boolean:/\b(?:False|None|True)\b/,number:/\b0(?:b(?:_?[01])+|o(?:_?[0-7])+|x(?:_?[a-f0-9])+)\b|(?:\b\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\B\.\d+(?:_\d+)*)(?:e[+-]?\d+(?:_\d+)*)?j?(?!\w)/i,operator:/[-+%=]=?|!=|:=|\*\*?=?|\/\/?=?|<[<=>]?|>[=>]?|[&|^~]/,punctuation:/[{}[\];(),.:]/},Prism.languages.python["string-interpolation"].inside.interpolation.inside.rest=Prism.languages.python,Prism.languages.py=Prism.languages.python),AV}zZe();(function(e){var t="\\b(?:BASH|BASHOPTS|BASH_ALIASES|BASH_ARGC|BASH_ARGV|BASH_CMDS|BASH_COMPLETION_COMPAT_DIR|BASH_LINENO|BASH_REMATCH|BASH_SOURCE|BASH_VERSINFO|BASH_VERSION|COLORTERM|COLUMNS|COMP_WORDBREAKS|DBUS_SESSION_BUS_ADDRESS|DEFAULTS_PATH|DESKTOP_SESSION|DIRSTACK|DISPLAY|EUID|GDMSESSION|GDM_LANG|GNOME_KEYRING_CONTROL|GNOME_KEYRING_PID|GPG_AGENT_INFO|GROUPS|HISTCONTROL|HISTFILE|HISTFILESIZE|HISTSIZE|HOME|HOSTNAME|HOSTTYPE|IFS|INSTANCE|JOB|LANG|LANGUAGE|LC_ADDRESS|LC_ALL|LC_IDENTIFICATION|LC_MEASUREMENT|LC_MONETARY|LC_NAME|LC_NUMERIC|LC_PAPER|LC_TELEPHONE|LC_TIME|LESSCLOSE|LESSOPEN|LINES|LOGNAME|LS_COLORS|MACHTYPE|MAILCHECK|MANDATORY_PATH|NO_AT_BRIDGE|OLDPWD|OPTERR|OPTIND|ORBIT_SOCKETDIR|OSTYPE|PAPERSIZE|PATH|PIPESTATUS|PPID|PS1|PS2|PS3|PS4|PWD|RANDOM|REPLY|SECONDS|SELINUX_INIT|SESSION|SESSIONTYPE|SESSION_MANAGER|SHELL|SHELLOPTS|SHLVL|SSH_AUTH_SOCK|TERM|UID|UPSTART_EVENTS|UPSTART_INSTANCE|UPSTART_JOB|UPSTART_SESSION|USER|WINDOWID|XAUTHORITY|XDG_CONFIG_DIRS|XDG_CURRENT_DESKTOP|XDG_DATA_DIRS|XDG_GREETER_DATA_DIR|XDG_MENU_PREFIX|XDG_RUNTIME_DIR|XDG_SEAT|XDG_SEAT_PATH|XDG_SESSION_DESKTOP|XDG_SESSION_ID|XDG_SESSION_PATH|XDG_SESSION_TYPE|XDG_VTNR|XMODIFIERS)\\b",n={pattern:/(^(["']?)\w+\2)[ \t]+\S.*/,lookbehind:!0,alias:"punctuation",inside:null},r={bash:n,environment:{pattern:RegExp("\\$"+t),alias:"constant"},variable:[{pattern:/\$?\(\([\s\S]+?\)\)/,greedy:!0,inside:{variable:[{pattern:/(^\$\(\([\s\S]+)\)\)/,lookbehind:!0},/^\$\(\(/],number:/\b0x[\dA-Fa-f]+\b|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:[Ee]-?\d+)?/,operator:/--|\+\+|\*\*=?|<<=?|>>=?|&&|\|\||[=!+\-*/%<>^&|]=?|[?~:]/,punctuation:/\(\(?|\)\)?|,|;/}},{pattern:/\$\((?:\([^)]+\)|[^()])+\)|`[^`]+`/,greedy:!0,inside:{variable:/^\$\(|^`|\)$|`$/}},{pattern:/\$\{[^}]+\}/,greedy:!0,inside:{operator:/:[-=?+]?|[!\/]|##?|%%?|\^\^?|,,?/,punctuation:/[\[\]]/,environment:{pattern:RegExp("(\\{)"+t),lookbehind:!0,alias:"constant"}}},/\$(?:\w+|[#?*!@$])/],entity:/\\(?:[abceEfnrtv\\"]|O?[0-7]{1,3}|U[0-9a-fA-F]{8}|u[0-9a-fA-F]{4}|x[0-9a-fA-F]{1,2})/};e.languages.bash={shebang:{pattern:/^#!\s*\/.*/,alias:"important"},comment:{pattern:/(^|[^"{\\$])#.*/,lookbehind:!0},"function-name":[{pattern:/(\bfunction\s+)[\w-]+(?=(?:\s*\(?:\s*\))?\s*\{)/,lookbehind:!0,alias:"function"},{pattern:/\b[\w-]+(?=\s*\(\s*\)\s*\{)/,alias:"function"}],"for-or-select":{pattern:/(\b(?:for|select)\s+)\w+(?=\s+in\s)/,alias:"variable",lookbehind:!0},"assign-left":{pattern:/(^|[\s;|&]|[<>]\()\w+(?:\.\w+)*(?=\+?=)/,inside:{environment:{pattern:RegExp("(^|[\\s;|&]|[<>]\\()"+t),lookbehind:!0,alias:"constant"}},alias:"variable",lookbehind:!0},parameter:{pattern:/(^|\s)-{1,2}(?:\w+:[+-]?)?\w+(?:\.\w+)*(?=[=\s]|$)/,alias:"variable",lookbehind:!0},string:[{pattern:/((?:^|[^<])<<-?\s*)(\w+)\s[\s\S]*?(?:\r?\n|\r)\2/,lookbehind:!0,greedy:!0,inside:r},{pattern:/((?:^|[^<])<<-?\s*)(["'])(\w+)\2\s[\s\S]*?(?:\r?\n|\r)\3/,lookbehind:!0,greedy:!0,inside:{bash:n}},{pattern:/(^|[^\\](?:\\\\)*)"(?:\\[\s\S]|\$\([^)]+\)|\$(?!\()|`[^`]+`|[^"\\`$])*"/,lookbehind:!0,greedy:!0,inside:r},{pattern:/(^|[^$\\])'[^']*'/,lookbehind:!0,greedy:!0},{pattern:/\$'(?:[^'\\]|\\[\s\S])*'/,greedy:!0,inside:{entity:r.entity}}],environment:{pattern:RegExp("\\$?"+t),alias:"constant"},variable:r.variable,function:{pattern:/(^|[\s;|&]|[<>]\()(?:add|apropos|apt|apt-cache|apt-get|aptitude|aspell|automysqlbackup|awk|basename|bash|bc|bconsole|bg|bzip2|cal|cargo|cat|cfdisk|chgrp|chkconfig|chmod|chown|chroot|cksum|clear|cmp|column|comm|composer|cp|cron|crontab|csplit|curl|cut|date|dc|dd|ddrescue|debootstrap|df|diff|diff3|dig|dir|dircolors|dirname|dirs|dmesg|docker|docker-compose|du|egrep|eject|env|ethtool|expand|expect|expr|fdformat|fdisk|fg|fgrep|file|find|fmt|fold|format|free|fsck|ftp|fuser|gawk|git|gparted|grep|groupadd|groupdel|groupmod|groups|grub-mkconfig|gzip|halt|head|hg|history|host|hostname|htop|iconv|id|ifconfig|ifdown|ifup|import|install|ip|java|jobs|join|kill|killall|less|link|ln|locate|logname|logrotate|look|lpc|lpr|lprint|lprintd|lprintq|lprm|ls|lsof|lynx|make|man|mc|mdadm|mkconfig|mkdir|mke2fs|mkfifo|mkfs|mkisofs|mknod|mkswap|mmv|more|most|mount|mtools|mtr|mutt|mv|nano|nc|netstat|nice|nl|node|nohup|notify-send|npm|nslookup|op|open|parted|passwd|paste|pathchk|ping|pkill|pnpm|podman|podman-compose|popd|pr|printcap|printenv|ps|pushd|pv|quota|quotacheck|quotactl|ram|rar|rcp|reboot|remsync|rename|renice|rev|rm|rmdir|rpm|rsync|scp|screen|sdiff|sed|sendmail|seq|service|sftp|sh|shellcheck|shuf|shutdown|sleep|slocate|sort|split|ssh|stat|strace|su|sudo|sum|suspend|swapon|sync|sysctl|tac|tail|tar|tee|time|timeout|top|touch|tr|traceroute|tsort|tty|umount|uname|unexpand|uniq|units|unrar|unshar|unzip|update-grub|uptime|useradd|userdel|usermod|users|uudecode|uuencode|v|vcpkg|vdir|vi|vim|virsh|vmstat|wait|watch|wc|wget|whereis|which|who|whoami|write|xargs|xdg-open|yarn|yes|zenity|zip|zsh|zypper)(?=$|[)\s;|&])/,lookbehind:!0},keyword:{pattern:/(^|[\s;|&]|[<>]\()(?:case|do|done|elif|else|esac|fi|for|function|if|in|select|then|until|while)(?=$|[)\s;|&])/,lookbehind:!0},builtin:{pattern:/(^|[\s;|&]|[<>]\()(?:\.|:|alias|bind|break|builtin|caller|cd|command|continue|declare|echo|enable|eval|exec|exit|export|getopts|hash|help|let|local|logout|mapfile|printf|pwd|read|readarray|readonly|return|set|shift|shopt|source|test|times|trap|type|typeset|ulimit|umask|unalias|unset)(?=$|[)\s;|&])/,lookbehind:!0,alias:"class-name"},boolean:{pattern:/(^|[\s;|&]|[<>]\()(?:false|true)(?=$|[)\s;|&])/,lookbehind:!0},"file-descriptor":{pattern:/\B&\d\b/,alias:"important"},operator:{pattern:/\d?<>|>\||\+=|=[=~]?|!=?|<<[<-]?|[&\d]?>>|\d[<>]&?|[<>][&=]?|&[>&]?|\|[&|]?/,inside:{"file-descriptor":{pattern:/^\d/,alias:"important"}}},punctuation:/\$?\(\(?|\)\)?|\.\.|[{}[\];\\]/,number:{pattern:/(^|\s)(?:[1-9]\d*|0)(?:[.,]\d+)?\b/,lookbehind:!0}},n.inside=e.languages.bash;for(var s=["comment","function-name","for-or-select","assign-left","parameter","string","environment","function","keyword","builtin","boolean","file-descriptor","operator","punctuation","number"],i=r.variable[1].inside,a=0;a<s.length;a++)i[s[a]]=e.languages.bash[s[a]];e.languages.sh=e.languages.bash,e.languages.shell=e.languages.bash})(Prism);Prism.languages.json={property:{pattern:/(^|[^\\])"(?:\\.|[^\\"\r\n])*"(?=\s*:)/,lookbehind:!0,greedy:!0},string:{pattern:/(^|[^\\])"(?:\\.|[^\\"\r\n])*"(?!\s*:)/,lookbehind:!0,greedy:!0},comment:{pattern:/\/\/.*|\/\*[\s\S]*?(?:\*\/|$)/,greedy:!0},number:/-?\b\d+(?:\.\d+)?(?:e[+-]?\d+)?\b/i,punctuation:/[{}[\],]/,operator:/:/,boolean:/\b(?:false|true)\b/,null:{pattern:/\bnull\b/,alias:"keyword"}};Prism.languages.webmanifest=Prism.languages.json;(function(e){var t=/(?:\\.|[^\\\n\r]|(?:\n|\r\n?)(?![\r\n]))/.source;function n(u){return u=u.replace(/<inner>/g,function(){return t}),RegExp(/((?:^|[^\\])(?:\\{2})*)/.source+"(?:"+u+")")}var r=/(?:\\.|``(?:[^`\r\n]|`(?!`))+``|`[^`\r\n]+`|[^\\|\r\n`])+/.source,s=/\|?__(?:\|__)+\|?(?:(?:\n|\r\n?)|(?![\s\S]))/.source.replace(/__/g,function(){return r}),i=/\|?[ \t]*:?-{3,}:?[ \t]*(?:\|[ \t]*:?-{3,}:?[ \t]*)+\|?(?:\n|\r\n?)/.source;e.languages.markdown=e.languages.extend("markup",{}),e.languages.insertBefore("markdown","prolog",{"front-matter-block":{pattern:/(^(?:\s*[\r\n])?)---(?!.)[\s\S]*?[\r\n]---(?!.)/,lookbehind:!0,greedy:!0,inside:{punctuation:/^---|---$/,"front-matter":{pattern:/\S+(?:\s+\S+)*/,alias:["yaml","language-yaml"],inside:e.languages.yaml}}},blockquote:{pattern:/^>(?:[\t ]*>)*/m,alias:"punctuation"},table:{pattern:RegExp("^"+s+i+"(?:"+s+")*","m"),inside:{"table-data-rows":{pattern:RegExp("^("+s+i+")(?:"+s+")*$"),lookbehind:!0,inside:{"table-data":{pattern:RegExp(r),inside:e.languages.markdown},punctuation:/\|/}},"table-line":{pattern:RegExp("^("+s+")"+i+"$"),lookbehind:!0,inside:{punctuation:/\||:?-{3,}:?/}},"table-header-row":{pattern:RegExp("^"+s+"$"),inside:{"table-header":{pattern:RegExp(r),alias:"important",inside:e.languages.markdown},punctuation:/\|/}}}},code:[{pattern:/((?:^|\n)[ \t]*\n|(?:^|\r\n?)[ \t]*\r\n?)(?: {4}|\t).+(?:(?:\n|\r\n?)(?: {4}|\t).+)*/,lookbehind:!0,alias:"keyword"},{pattern:/^```[\s\S]*?^```$/m,greedy:!0,inside:{"code-block":{pattern:/^(```.*(?:\n|\r\n?))[\s\S]+?(?=(?:\n|\r\n?)^```$)/m,lookbehind:!0},"code-language":{pattern:/^(```).+/,lookbehind:!0},punctuation:/```/}}],title:[{pattern:/\S.*(?:\n|\r\n?)(?:==+|--+)(?=[ \t]*$)/m,alias:"important",inside:{punctuation:/==+$|--+$/}},{pattern:/(^\s*)#.+/m,lookbehind:!0,alias:"important",inside:{punctuation:/^#+|#+$/}}],hr:{pattern:/(^\s*)([*-])(?:[\t ]*\2){2,}(?=\s*$)/m,lookbehind:!0,alias:"punctuation"},list:{pattern:/(^\s*)(?:[*+-]|\d+\.)(?=[\t ].)/m,lookbehind:!0,alias:"punctuation"},"url-reference":{pattern:/!?\[[^\]]+\]:[\t ]+(?:\S+|<(?:\\.|[^>\\])+>)(?:[\t ]+(?:"(?:\\.|[^"\\])*"|'(?:\\.|[^'\\])*'|\((?:\\.|[^)\\])*\)))?/,inside:{variable:{pattern:/^(!?\[)[^\]]+/,lookbehind:!0},string:/(?:"(?:\\.|[^"\\])*"|'(?:\\.|[^'\\])*'|\((?:\\.|[^)\\])*\))$/,punctuation:/^[\[\]!:]|[<>]/},alias:"url"},bold:{pattern:n(/\b__(?:(?!_)<inner>|_(?:(?!_)<inner>)+_)+__\b|\*\*(?:(?!\*)<inner>|\*(?:(?!\*)<inner>)+\*)+\*\*/.source),lookbehind:!0,greedy:!0,inside:{content:{pattern:/(^..)[\s\S]+(?=..$)/,lookbehind:!0,inside:{}},punctuation:/\*\*|__/}},italic:{pattern:n(/\b_(?:(?!_)<inner>|__(?:(?!_)<inner>)+__)+_\b|\*(?:(?!\*)<inner>|\*\*(?:(?!\*)<inner>)+\*\*)+\*/.source),lookbehind:!0,greedy:!0,inside:{content:{pattern:/(^.)[\s\S]+(?=.$)/,lookbehind:!0,inside:{}},punctuation:/[*_]/}},strike:{pattern:n(/(~~?)(?:(?!~)<inner>)+\2/.source),lookbehind:!0,greedy:!0,inside:{content:{pattern:/(^~~?)[\s\S]+(?=\1$)/,lookbehind:!0,inside:{}},punctuation:/~~?/}},"code-snippet":{pattern:/(^|[^\\`])(?:``[^`\r\n]+(?:`[^`\r\n]+)*``(?!`)|`[^`\r\n]+`(?!`))/,lookbehind:!0,greedy:!0,alias:["code","keyword"]},url:{pattern:n(/!?\[(?:(?!\])<inner>)+\](?:\([^\s)]+(?:[\t ]+"(?:\\.|[^"\\])*")?\)|[ \t]?\[(?:(?!\])<inner>)+\])/.source),lookbehind:!0,greedy:!0,inside:{operator:/^!/,content:{pattern:/(^\[)[^\]]+(?=\])/,lookbehind:!0,inside:{}},variable:{pattern:/(^\][ \t]?\[)[^\]]+(?=\]$)/,lookbehind:!0},url:{pattern:/(^\]\()[^\s)]+/,lookbehind:!0},string:{pattern:/(^[ \t]+)"(?:\\.|[^"\\])*"(?=\)$)/,lookbehind:!0}}}}),["url","bold","italic","strike"].forEach(function(u){["url","bold","italic","strike","code-snippet"].forEach(function(d){u!==d&&(e.languages.markdown[u].inside.content.inside[d]=e.languages.markdown[d])})}),e.hooks.add("after-tokenize",function(u){if(u.language!=="markdown"&&u.language!=="md")return;function d(h){if(!(!h||typeof h=="string"))for(var m=0,y=h.length;m<y;m++){var b=h[m];if(b.type!=="code"){d(b.content);continue}var v=b.content[1],x=b.content[3];if(v&&x&&v.type==="code-language"&&x.type==="code-block"&&typeof v.content=="string"){var w=v.content.replace(/\b#/g,"sharp").replace(/\b\+\+/g,"pp");w=(/[a-z][\w-]*/i.exec(w)||[""])[0].toLowerCase();var _="language-"+w;x.alias?typeof x.alias=="string"?x.alias=[x.alias,_]:x.alias.push(_):x.alias=[_]}}}d(u.tokens)}),e.hooks.add("wrap",function(u){if(u.type==="code-block"){for(var d="",h=0,m=u.classes.length;h<m;h++){var y=u.classes[h],b=/language-(.+)/.exec(y);if(b){d=b[1];break}}var v=e.languages[d];if(v)u.content=e.highlight(c(u.content),v,d);else if(d&&d!=="none"&&e.plugins.autoloader){var x="md-"+new Date().valueOf()+"-"+Math.floor(Math.random()*1e16);u.attributes.id=x,e.plugins.autoloader.loadLanguages(d,function(){var w=document.getElementById(x);w&&(w.innerHTML=e.highlight(w.textContent,e.languages[d],d))})}}});var a=RegExp(e.languages.markup.tag.pattern.source,"gi"),o={amp:"&",lt:"<",gt:">",quot:'"'},l=String.fromCodePoint||String.fromCharCode;function c(u){var d=u.replace(a,"");return d=d.replace(/&(\w{1,8}|#x?[\da-f]{1,8});/gi,function(h,m){if(m=m.toLowerCase(),m[0]==="#"){var y;return m[1]==="x"?y=parseInt(m.slice(2),16):y=Number(m.slice(1)),l(y)}else{var b=o[m];return b||h}}),d}e.languages.md=e.languages.markdown})(Prism);(function(e){e.languages.diff={coord:[/^(?:\*{3}|-{3}|\+{3}).*$/m,/^@@.*@@$/m,/^\d.*$/m]};var t={"deleted-sign":"-","deleted-arrow":"<","inserted-sign":"+","inserted-arrow":">",unchanged:" ",diff:"!"};Object.keys(t).forEach(function(n){var r=t[n],s=[];/^\w+$/.test(n)||s.push(/\w+/.exec(n)[0]),n==="diff"&&s.push("bold"),e.languages.diff[n]={pattern:RegExp("^(?:["+r+`].*(?:\r
?|
|(?![\\s\\S])))+`,"m"),alias:s,inside:{line:{pattern:/(.)(?=[\s\S]).*(?:\r\n?|\n)?/,lookbehind:!0},prefix:{pattern:/[\s\S]/,alias:/\w+/.exec(n)[0]}}}}),Object.defineProperty(e.languages.diff,"PREFIXES",{value:t})})(Prism);Prism.languages.go=Prism.languages.extend("clike",{string:{pattern:/(^|[^\\])"(?:\\.|[^"\\\r\n])*"|`[^`]*`/,lookbehind:!0,greedy:!0},keyword:/\b(?:break|case|chan|const|continue|default|defer|else|fallthrough|for|func|go(?:to)?|if|import|interface|map|package|range|return|select|struct|switch|type|var)\b/,boolean:/\b(?:_|false|iota|nil|true)\b/,number:[/\b0(?:b[01_]+|o[0-7_]+)i?\b/i,/\b0x(?:[a-f\d_]+(?:\.[a-f\d_]*)?|\.[a-f\d_]+)(?:p[+-]?\d+(?:_\d+)*)?i?(?!\w)/i,/(?:\b\d[\d_]*(?:\.[\d_]*)?|\B\.\d[\d_]*)(?:e[+-]?[\d_]+)?i?(?!\w)/i],operator:/[*\/%^!=]=?|\+[=+]?|-[=-]?|\|[=|]?|&(?:=|&|\^=?)?|>(?:>=?|=)?|<(?:<=?|=|-)?|:=|\.\.\./,builtin:/\b(?:append|bool|byte|cap|close|complex|complex(?:64|128)|copy|delete|error|float(?:32|64)|u?int(?:8|16|32|64)?|imag|len|make|new|panic|print(?:ln)?|real|recover|rune|string|uintptr)\b/});Prism.languages.insertBefore("go","string",{char:{pattern:/'(?:\\.|[^'\\\r\n]){0,10}'/,greedy:!0}});delete Prism.languages.go["class-name"];(function(e){var t=/[*&][^\s[\]{},]+/,n=/!(?:<[\w\-%#;/?:@&=+$,.!~*'()[\]]+>|(?:[a-zA-Z\d-]*!)?[\w\-%#;/?:@&=+$.~*'()]+)?/,r="(?:"+n.source+"(?:[ 	]+"+t.source+")?|"+t.source+"(?:[ 	]+"+n.source+")?)",s=/(?:[^\s\x00-\x08\x0e-\x1f!"#%&'*,\-:>?@[\]`{|}\x7f-\x84\x86-\x9f\ud800-\udfff\ufffe\uffff]|[?:-]<PLAIN>)(?:[ \t]*(?:(?![#:])<PLAIN>|:<PLAIN>))*/.source.replace(/<PLAIN>/g,function(){return/[^\s\x00-\x08\x0e-\x1f,[\]{}\x7f-\x84\x86-\x9f\ud800-\udfff\ufffe\uffff]/.source}),i=/"(?:[^"\\\r\n]|\\.)*"|'(?:[^'\\\r\n]|\\.)*'/.source;function a(o,l){l=(l||"").replace(/m/g,"")+"m";var c=/([:\-,[{]\s*(?:\s<<prop>>[ \t]+)?)(?:<<value>>)(?=[ \t]*(?:$|,|\]|\}|(?:[\r\n]\s*)?#))/.source.replace(/<<prop>>/g,function(){return r}).replace(/<<value>>/g,function(){return o});return RegExp(c,l)}e.languages.yaml={scalar:{pattern:RegExp(/([\-:]\s*(?:\s<<prop>>[ \t]+)?[|>])[ \t]*(?:((?:\r?\n|\r)[ \t]+)\S[^\r\n]*(?:\2[^\r\n]+)*)/.source.replace(/<<prop>>/g,function(){return r})),lookbehind:!0,alias:"string"},comment:/#.*/,key:{pattern:RegExp(/((?:^|[:\-,[{\r\n?])[ \t]*(?:<<prop>>[ \t]+)?)<<key>>(?=\s*:\s)/.source.replace(/<<prop>>/g,function(){return r}).replace(/<<key>>/g,function(){return"(?:"+s+"|"+i+")"})),lookbehind:!0,greedy:!0,alias:"atrule"},directive:{pattern:/(^[ \t]*)%.+/m,lookbehind:!0,alias:"important"},datetime:{pattern:a(/\d{4}-\d\d?-\d\d?(?:[tT]|[ \t]+)\d\d?:\d{2}:\d{2}(?:\.\d*)?(?:[ \t]*(?:Z|[-+]\d\d?(?::\d{2})?))?|\d{4}-\d{2}-\d{2}|\d\d?:\d{2}(?::\d{2}(?:\.\d*)?)?/.source),lookbehind:!0,alias:"number"},boolean:{pattern:a(/false|true/.source,"i"),lookbehind:!0,alias:"important"},null:{pattern:a(/null|~/.source,"i"),lookbehind:!0,alias:"important"},string:{pattern:a(i),lookbehind:!0,greedy:!0},number:{pattern:a(/[+-]?(?:0x[\da-f]+|0o[0-7]+|(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?|\.inf|\.nan)/.source,"i"),lookbehind:!0},tag:n,important:t,punctuation:/---|[:[\]{}\-,|>?]|\.\.\./},e.languages.yml=e.languages.yaml})(Prism);var NV={},IV;function UZe(){return IV||(IV=1,function(e){for(var t=/\/\*(?:[^*/]|\*(?!\/)|\/(?!\*)|<self>)*\*\//.source,n=0;n<2;n++)t=t.replace(/<self>/g,function(){return t});t=t.replace(/<self>/g,function(){return/[^\s\S]/.source}),e.languages.rust={comment:[{pattern:RegExp(/(^|[^\\])/.source+t),lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/b?"(?:\\[\s\S]|[^\\"])*"|b?r(#*)"(?:[^"]|"(?!\1))*"\1/,greedy:!0},char:{pattern:/b?'(?:\\(?:x[0-7][\da-fA-F]|u\{(?:[\da-fA-F]_*){1,6}\}|.)|[^\\\r\n\t'])'/,greedy:!0},attribute:{pattern:/#!?\[(?:[^\[\]"]|"(?:\\[\s\S]|[^\\"])*")*\]/,greedy:!0,alias:"attr-name",inside:{string:null}},"closure-params":{pattern:/([=(,:]\s*|\bmove\s*)\|[^|]*\||\|[^|]*\|(?=\s*(?:\{|->))/,lookbehind:!0,greedy:!0,inside:{"closure-punctuation":{pattern:/^\||\|$/,alias:"punctuation"},rest:null}},"lifetime-annotation":{pattern:/'\w+/,alias:"symbol"},"fragment-specifier":{pattern:/(\$\w+:)[a-z]+/,lookbehind:!0,alias:"punctuation"},variable:/\$\w+/,"function-definition":{pattern:/(\bfn\s+)\w+/,lookbehind:!0,alias:"function"},"type-definition":{pattern:/(\b(?:enum|struct|trait|type|union)\s+)\w+/,lookbehind:!0,alias:"class-name"},"module-declaration":[{pattern:/(\b(?:crate|mod)\s+)[a-z][a-z_\d]*/,lookbehind:!0,alias:"namespace"},{pattern:/(\b(?:crate|self|super)\s*)::\s*[a-z][a-z_\d]*\b(?:\s*::(?:\s*[a-z][a-z_\d]*\s*::)*)?/,lookbehind:!0,alias:"namespace",inside:{punctuation:/::/}}],keyword:[/\b(?:Self|abstract|as|async|await|become|box|break|const|continue|crate|do|dyn|else|enum|extern|final|fn|for|if|impl|in|let|loop|macro|match|mod|move|mut|override|priv|pub|ref|return|self|static|struct|super|trait|try|type|typeof|union|unsafe|unsized|use|virtual|where|while|yield)\b/,/\b(?:bool|char|f(?:32|64)|[ui](?:8|16|32|64|128|size)|str)\b/],function:/\b[a-z_]\w*(?=\s*(?:::\s*<|\())/,macro:{pattern:/\b\w+!/,alias:"property"},constant:/\b[A-Z_][A-Z_\d]+\b/,"class-name":/\b[A-Z]\w*\b/,namespace:{pattern:/(?:\b[a-z][a-z_\d]*\s*::\s*)*\b[a-z][a-z_\d]*\s*::(?!\s*<)/,inside:{punctuation:/::/}},number:/\b(?:0x[\dA-Fa-f](?:_?[\dA-Fa-f])*|0o[0-7](?:_?[0-7])*|0b[01](?:_?[01])*|(?:(?:\d(?:_?\d)*)?\.)?\d(?:_?\d)*(?:[Ee][+-]?\d+)?)(?:_?(?:f32|f64|[iu](?:8|16|32|64|size)?))?\b/,boolean:/\b(?:false|true)\b/,punctuation:/->|\.\.=|\.{1,3}|::|[{}[\];(),:]/,operator:/[-+*\/%!^]=?|=[=>]?|&[&=]?|\|[|=]?|<<?=?|>>?=?|[@?]/},e.languages.rust["closure-params"].inside.rest=e.languages.rust,e.languages.rust.attribute.inside.string=e.languages.rust.string}(Prism)),NV}UZe();Prism.languages.sql={comment:{pattern:/(^|[^\\])(?:\/\*[\s\S]*?\*\/|(?:--|\/\/|#).*)/,lookbehind:!0},variable:[{pattern:/@(["'`])(?:\\[\s\S]|(?!\1)[^\\])+\1/,greedy:!0},/@[\w.$]+/],string:{pattern:/(^|[^@\\])("|')(?:\\[\s\S]|(?!\2)[^\\]|\2\2)*\2/,greedy:!0,lookbehind:!0},identifier:{pattern:/(^|[^@\\])`(?:\\[\s\S]|[^`\\]|``)*`/,greedy:!0,lookbehind:!0,inside:{punctuation:/^`|`$/}},function:/\b(?:AVG|COUNT|FIRST|FORMAT|LAST|LCASE|LEN|MAX|MID|MIN|MOD|NOW|ROUND|SUM|UCASE)(?=\s*\()/i,keyword:/\b(?:ACTION|ADD|AFTER|ALGORITHM|ALL|ALTER|ANALYZE|ANY|APPLY|AS|ASC|AUTHORIZATION|AUTO_INCREMENT|BACKUP|BDB|BEGIN|BERKELEYDB|BIGINT|BINARY|BIT|BLOB|BOOL|BOOLEAN|BREAK|BROWSE|BTREE|BULK|BY|CALL|CASCADED?|CASE|CHAIN|CHAR(?:ACTER|SET)?|CHECK(?:POINT)?|CLOSE|CLUSTERED|COALESCE|COLLATE|COLUMNS?|COMMENT|COMMIT(?:TED)?|COMPUTE|CONNECT|CONSISTENT|CONSTRAINT|CONTAINS(?:TABLE)?|CONTINUE|CONVERT|CREATE|CROSS|CURRENT(?:_DATE|_TIME|_TIMESTAMP|_USER)?|CURSOR|CYCLE|DATA(?:BASES?)?|DATE(?:TIME)?|DAY|DBCC|DEALLOCATE|DEC|DECIMAL|DECLARE|DEFAULT|DEFINER|DELAYED|DELETE|DELIMITERS?|DENY|DESC|DESCRIBE|DETERMINISTIC|DISABLE|DISCARD|DISK|DISTINCT|DISTINCTROW|DISTRIBUTED|DO|DOUBLE|DROP|DUMMY|DUMP(?:FILE)?|DUPLICATE|ELSE(?:IF)?|ENABLE|ENCLOSED|END|ENGINE|ENUM|ERRLVL|ERRORS|ESCAPED?|EXCEPT|EXEC(?:UTE)?|EXISTS|EXIT|EXPLAIN|EXTENDED|FETCH|FIELDS|FILE|FILLFACTOR|FIRST|FIXED|FLOAT|FOLLOWING|FOR(?: EACH ROW)?|FORCE|FOREIGN|FREETEXT(?:TABLE)?|FROM|FULL|FUNCTION|GEOMETRY(?:COLLECTION)?|GLOBAL|GOTO|GRANT|GROUP|HANDLER|HASH|HAVING|HOLDLOCK|HOUR|IDENTITY(?:COL|_INSERT)?|IF|IGNORE|IMPORT|INDEX|INFILE|INNER|INNODB|INOUT|INSERT|INT|INTEGER|INTERSECT|INTERVAL|INTO|INVOKER|ISOLATION|ITERATE|JOIN|KEYS?|KILL|LANGUAGE|LAST|LEAVE|LEFT|LEVEL|LIMIT|LINENO|LINES|LINESTRING|LOAD|LOCAL|LOCK|LONG(?:BLOB|TEXT)|LOOP|MATCH(?:ED)?|MEDIUM(?:BLOB|INT|TEXT)|MERGE|MIDDLEINT|MINUTE|MODE|MODIFIES|MODIFY|MONTH|MULTI(?:LINESTRING|POINT|POLYGON)|NATIONAL|NATURAL|NCHAR|NEXT|NO|NONCLUSTERED|NULLIF|NUMERIC|OFF?|OFFSETS?|ON|OPEN(?:DATASOURCE|QUERY|ROWSET)?|OPTIMIZE|OPTION(?:ALLY)?|ORDER|OUT(?:ER|FILE)?|OVER|PARTIAL|PARTITION|PERCENT|PIVOT|PLAN|POINT|POLYGON|PRECEDING|PRECISION|PREPARE|PREV|PRIMARY|PRINT|PRIVILEGES|PROC(?:EDURE)?|PUBLIC|PURGE|QUICK|RAISERROR|READS?|REAL|RECONFIGURE|REFERENCES|RELEASE|RENAME|REPEAT(?:ABLE)?|REPLACE|REPLICATION|REQUIRE|RESIGNAL|RESTORE|RESTRICT|RETURN(?:ING|S)?|REVOKE|RIGHT|ROLLBACK|ROUTINE|ROW(?:COUNT|GUIDCOL|S)?|RTREE|RULE|SAVE(?:POINT)?|SCHEMA|SECOND|SELECT|SERIAL(?:IZABLE)?|SESSION(?:_USER)?|SET(?:USER)?|SHARE|SHOW|SHUTDOWN|SIMPLE|SMALLINT|SNAPSHOT|SOME|SONAME|SQL|START(?:ING)?|STATISTICS|STATUS|STRIPED|SYSTEM_USER|TABLES?|TABLESPACE|TEMP(?:ORARY|TABLE)?|TERMINATED|TEXT(?:SIZE)?|THEN|TIME(?:STAMP)?|TINY(?:BLOB|INT|TEXT)|TOP?|TRAN(?:SACTIONS?)?|TRIGGER|TRUNCATE|TSEQUAL|TYPES?|UNBOUNDED|UNCOMMITTED|UNDEFINED|UNION|UNIQUE|UNLOCK|UNPIVOT|UNSIGNED|UPDATE(?:TEXT)?|USAGE|USE|USER|USING|VALUES?|VAR(?:BINARY|CHAR|CHARACTER|YING)|VIEW|WAITFOR|WARNINGS|WHEN|WHERE|WHILE|WITH(?: ROLLUP|IN)?|WORK|WRITE(?:TEXT)?|YEAR)\b/i,boolean:/\b(?:FALSE|NULL|TRUE)\b/i,number:/\b0x[\da-f]+\b|\b\d+(?:\.\d*)?|\B\.\d+\b/i,operator:/[-+*\/=%^~]|&&?|\|\|?|!=?|<(?:=>?|<|>)?|>[>=]?|\b(?:AND|BETWEEN|DIV|ILIKE|IN|IS|LIKE|NOT|OR|REGEXP|RLIKE|SOUNDS LIKE|XOR)\b/i,punctuation:/[;[\]()`,.]/};const qZe=({interactionId:e,codeBlockId:t,language:n,originalContent:r,editedContent:s,filepath:i,disabled:a,onEditModeChange:o})=>{const[l,c]=E.useState(!1),u=E.useCallback(y=>{if(y.stopPropagation(),a||!r||!e||!t){ke.info("Code editing is currently disabled.");return}c(!0),o==null||o(!0)},[a,r,e,t,o]),d=E.useCallback(()=>{if(!e||!t){ke.error("Missing interaction or code block ID");return}if(s.trim()===""){ke.error("Code cannot be empty");return}Ce.emit(Gi.editCodeBlockRequest,{interactionId:e,codeBlockId:t,language:n,filepath:i,originalContent:r,newContent:s}),c(!1),o==null||o(!1),ke.success("Code block edited successfully")},[e,t,n,i,r,s,o]),h=E.useCallback(()=>{c(!1),o==null||o(!1)},[o]);return r&&r.trim().length>0&&e&&t?l?f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsxs(ot,{size:"sm",onClick:d,className:"h-6 px-2 text-xs",children:[f.jsx(Yu,{className:"h-3 w-3 mr-1"}),"Save"]}),f.jsxs(ot,{size:"sm",variant:"outline",onClick:h,className:"h-6 px-2 text-xs",children:[f.jsx(Si,{className:"h-3 w-3 mr-1"}),"Cancel"]})]}):f.jsx(Un,{tooltipText:"Edit Code",onClick:u,"aria-label":"Edit code block",disabled:a||!r||!e||!t,icon:f.jsx(nO,{}),iconClassName:"h-3.5 w-3.5",className:"h-6 w-6 text-muted-foreground hover:text-foreground"}):null},VZe=({code:e,language:t,onChange:n})=>{const r=E.useCallback(i=>i?{javascript:Ys.languages.javascript,js:Ys.languages.javascript,typescript:Ys.languages.typescript,ts:Ys.languages.typescript,python:Ys.languages.python,py:Ys.languages.python,bash:Ys.languages.bash,sh:Ys.languages.bash,json:Ys.languages.json,markdown:Ys.languages.markdown,md:Ys.languages.markdown,diff:Ys.languages.diff,go:Ys.languages.go,yaml:Ys.languages.yaml,yml:Ys.languages.yaml,rust:Ys.languages.rust,rs:Ys.languages.rust,sql:Ys.languages.sql}[i.toLowerCase()]||Ys.languages.plaintext||Ys.languages.text:Ys.languages.plaintext||Ys.languages.text,[]),s=E.useCallback(i=>{try{const a=r(t);return Ys.highlight(i,a,t||"text")}catch(a){return console.error("Syntax highlighting error:",a),i}},[t,r]);return f.jsx(FZe,{value:e,onValueChange:n,highlight:s,padding:16,tabSize:2,insertSpaces:!0,style:{fontFamily:'"Fira Code", "Fira Mono", "Consolas", "Monaco", monospace',fontSize:14,lineHeight:1.5,minHeight:"100px",backgroundColor:"transparent",outline:"none"}})},WZe=new Zo({html:!1,linkify:!0,breaks:!0});class HZe{constructor(){ce(this,"id","core-canvas-edit-codeblock-action");ce(this,"eventUnsubscribers",[])}async initialize(t){const n=t.on(Gi.editCodeBlockRequest,async r=>{await this.handleCodeBlockEdit(r.interactionId,r.codeBlockId,r.language,r.filepath,r.originalContent,r.newContent)});this.eventUnsubscribers.push(n)}parseMarkdownForCodeBlocks(t){var n,r,s;if(!t)return[];try{const i=WZe.parse(t,{}),a=[];for(const o of i)if(o.type==="fence"){const l=((n=o.info)==null?void 0:n.trim())||"";let c,u;if(l.includes(":")){const[m,...y]=l.split(":");c=m||void 0,u=y.join(":")||void 0}else c=l.split(" ")[0]||void 0;const d=((r=o.map)==null?void 0:r[0])||0,h=((s=o.map)==null?void 0:s[1])||0;a.push({type:"block",lang:c,code:o.content,filepath:u,startPos:d,endPos:h})}return a}catch(i){return console.error("Markdown parsing error:",i),[]}}findCodeBlockByContent(t,n,r,s){const i=this.parseMarkdownForCodeBlocks(t);for(let a=0;a<i.length;a++){const o=i[a];if(o.code===n&&o.lang===r&&o.filepath===s)return a}for(let a=0;a<i.length;a++)if(i[a].code===n)return a;return-1}replaceCodeBlockInMarkdown(t,n,r,s,i){const a=t.split(`
`),o=this.parseMarkdownForCodeBlocks(t);if(n<0||n>=o.length)throw new Error(`Code block index ${n} not found`);const l=o[n],c=l.startPos,u=l.endPos,d=s||"",h=i?`:${i}`:"",m=[`\`\`\`${d}${h}`,...r.split(`
`),"```"];return[...a.slice(0,c),...m,...a.slice(u)].join(`
`)}async handleCodeBlockEdit(t,n,r,s,i,a){var o;try{const l=nn.getState(),c=l.interactions.find(k=>k.id===t);if(!c)throw new Error("Original interaction not found");if(c.status!=="COMPLETED")throw new Error("Can only edit completed interactions");if(!c.response||typeof c.response!="string")throw new Error("Invalid response content");const u=this.findCodeBlockByContent(c.response,i||"",r,s);if(u===-1)throw new Error("Code block not found in response");const d=this.replaceCodeBlockInMarkdown(c.response,u,a||"",r,s),h=Nr(),m={...c,id:h,response:d,parentId:null,index:c.index,metadata:{...c.metadata,editedResponse:!0,editedFromId:c.id,editedCodeBlock:{codeBlockId:n,language:r,filepath:s,originalContent:i,newContent:a}},endedAt:new Date};l._addInteractionToState(m);const y=l.interactions.filter(k=>k.parentId===c.id),b=[];let v=c;for(;v;){b.push(v);const k=(o=v.metadata)==null?void 0:o.editedFromId;k?v=l.interactions.find(C=>C.id===k):v=void 0}const x=b.sort((k,C)=>{var N,I;const T=((N=k.startedAt)==null?void 0:N.getTime())??0,A=((I=C.startedAt)==null?void 0:I.getTime())??0;return T-A}),w=x.map(async(k,C)=>{const T={parentId:h,index:C,metadata:{...k.metadata,originalVersion:C===0}};return l._updateInteractionInState(k.id,T),yt.saveInteraction({...k,...T})}),_=y.map(async k=>{const C={parentId:h,index:x.length+k.index};return l._updateInteractionInState(k.id,C),yt.saveInteraction({...k,...C})});await Promise.all([yt.saveInteraction(m),...w,..._])}catch(l){throw console.error("[EditCodeBlockControlModule] Failed to edit code block:",l),l}}register(t){t.registerCanvasControl({id:this.id,type:"codeblock",targetSlot:"codeblock-header-actions",renderer:n=>{if(!n.codeBlockContent||!n.interactionId)return null;const r=nn.getState(),s=r.status,i=r.interactions.find(l=>l.id===n.interactionId),a=i&&i.status==="COMPLETED"&&i.response&&typeof i.response=="string"&&s!=="streaming"&&(i.type==="message.user_assistant"||i.type==="message.assistant_regen")&&n.codeBlockContent&&n.codeBlockContent.trim().length>0;if(!a)return null;const o=n.blockId||`fallback-${Date.now()}`;return Ve.createElement(qZe,{interactionId:n.interactionId,codeBlockId:o,language:n.codeBlockLang,filepath:n.codeBlockFilepath,originalContent:n.codeBlockContent||"",editedContent:n.codeBlockEditedContent||n.codeBlockContent||"",disabled:!a,onEditModeChange:n.onEditModeChange})}})}async cleanup(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[]}async destroy(){await this.cleanup()}}const GZe=({isFolded:e,toggleFold:t,canFold:n})=>{if(!n)return null;const r=s=>{s.stopPropagation(),t()};return f.jsx(Un,{tooltipText:e?"Unfold":"Fold",onClick:r,"aria-label":e?"Unfold response":"Fold response",icon:e?f.jsx(uc,{}):f.jsx(tp,{}),iconClassName:"h-3.5 w-3.5",className:"h-5 w-5"})};class KZe{constructor(){ce(this,"id","core-canvas-fold-interaction")}async initialize(t){}register(t){t.registerCanvasControl({id:this.id,type:"interaction",targetSlot:"header-actions",renderer:n=>!n.toggleFold||n.isFolded===void 0?null:Ve.createElement(GZe,{isFolded:n.isFolded,toggleFold:n.toggleFold,canFold:!0})})}destroy(t){}}const YZe=({context:e})=>{const t=ET(e.responseContent||""),n=E.useMemo(()=>{const s=[];return t.forEach(i=>{if(typeof i=="object"&&i.type==="block"){const a=i;a.filepath&&a.filepath.trim()&&s.push({filepath:a.filepath,code:a.code,lang:a.lang})}}),s},[t]),r=E.useCallback(async()=>{var s;if(n.length===0){ke.info("No code blocks with filepaths found to download");return}try{const i=new vD,a=new Set;n.forEach(({filepath:h,code:m})=>{const y=h.replace(/^[\/\\]+/,"").replace(/\\/g,"/"),b=y.split("/");if(b.length>1)for(let w=1;w<b.length;w++){const _=b.slice(0,w).join("/");a.has(_)||(i.folder(_),a.add(_))}let v=y,x=1;for(;i.file(v);){const w=y.lastIndexOf(".");if(w>0){const _=y.substring(0,w),k=y.substring(w);v=`${_}_${x}${k}`}else v=`${y}_${x}`;x++}i.file(v,m)});const o=await i.generateAsync({type:"blob",compression:"DEFLATE",compressionOptions:{level:6}}),l=URL.createObjectURL(o),c=document.createElement("a");c.href=l;const u=new Date().toISOString().slice(0,19).replace(/[:.]/g,"-"),d=((s=e.interactionId)==null?void 0:s.slice(0,8))||"unknown";c.download=`codeblocks_${d}_${u}.zip`,document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL(l),ke.success(`Downloaded ${n.length} code files as ZIP`)}catch(i){console.error("ZIP download failed:",i),ke.error("Failed to create ZIP file")}},[n,e.interactionId]);return n.length===0?null:f.jsx(Un,{tooltipText:`Download ${n.length} code files as ZIP`,onClick:r,"aria-label":"Download code blocks as ZIP file",icon:f.jsx(OH,{}),iconClassName:"h-4 w-4",className:"h-6 w-6 text-muted-foreground hover:text-foreground"})};class ZZe{constructor(){ce(this,"id","core-interaction-zip-download")}async initialize(t){}register(t){t.registerCanvasControl({id:this.id,type:"interaction",targetSlot:"header-actions",renderer:n=>!n.interactionId||!n.responseContent?null:Ve.createElement(YZe,{context:n})})}destroy(t){}}const XZe=({interactionId:e,codeBlockId:t,language:n,codeToCopy:r,disabled:s})=>{const[i,a]=E.useState(!1),o=E.useCallback(async l=>{l.stopPropagation(),!(s||!r)&&(Ce.emit(Gi.copyCodeBlockRequest,{interactionId:e,codeBlockId:t,language:n,content:r}),a(!0),setTimeout(()=>a(!1),1500))},[e,t,n,r,s]);return f.jsx(Un,{tooltipText:"Copy Code",onClick:o,"aria-label":"Copy code block",disabled:s||!r,icon:i?f.jsx(bo,{className:"text-green-500"}):f.jsx(TE,{}),className:"h-6 w-6 text-muted-foreground hover:text-foreground"})};class JZe{constructor(){ce(this,"id","core-codeblock-copy")}async initialize(t){}register(t){t.registerCanvasControl({id:this.id,type:"codeblock",targetSlot:"codeblock-header-actions",renderer:n=>Ve.createElement(XZe,{interactionId:n.interactionId,codeBlockId:n.codeBlockId,language:n.codeBlockLang,codeToCopy:n.codeBlockContent??"",disabled:!n.codeBlockContent||n.codeBlockContent.trim()===""})})}destroy(t){}}const QZe=({isFolded:e,toggleFold:t})=>{const n=r=>{r.stopPropagation(),t()};return f.jsx(Un,{tooltipText:e?"Unfold Code":"Fold Code",onClick:n,"aria-label":e?"Unfold code block":"Fold code block",icon:f.jsx(EE,{}),iconClassName:"h-3.5 w-3.5",className:"h-6 w-6 text-muted-foreground hover:text-foreground"})};class eXe{constructor(){ce(this,"id","core-codeblock-fold")}async initialize(t){}register(t){t.registerCanvasControl({id:this.id,type:"codeblock",targetSlot:"codeblock-header-actions",renderer:n=>n.toggleFold===void 0||n.isFolded===void 0?null:Ve.createElement(QZe,{isFolded:n.isFolded,toggleFold:n.toggleFold})})}destroy(t){}}const tXe=({interactionId:e,codeBlockId:t,language:n,codeToDownload:r,filepath:s,disabled:i})=>{const a=E.useCallback(l=>{if(l.stopPropagation(),!(i||!r))try{let c;if(s){const m=s.split("/");c=m[m.length-1]}else c=`code${nXe(n)}`;const u=new Blob([r],{type:"text/plain"}),d=URL.createObjectURL(u),h=document.createElement("a");h.href=d,h.download=c,document.body.appendChild(h),h.click(),document.body.removeChild(h),URL.revokeObjectURL(d),ke.success(`Downloaded ${c}`)}catch(c){console.error("Download failed:",c),ke.error("Failed to download file")}},[e,t,n,r,s,i]);return s||r&&r.trim().length>1e3?f.jsx(Un,{tooltipText:"Download File",onClick:a,"aria-label":"Download code as file",disabled:i||!r,icon:f.jsx(Fc,{}),iconClassName:"h-3.5 w-3.5",className:"h-6 w-6 text-muted-foreground hover:text-foreground"}):null};function nXe(e){return e&&{javascript:".js",js:".js",typescript:".ts",ts:".ts",tsx:".tsx",jsx:".jsx",python:".py",py:".py",java:".java",c:".c",cpp:".cpp",cxx:".cxx",cc:".cc","c++":".cpp",csharp:".cs",cs:".cs",php:".php",ruby:".rb",rb:".rb",go:".go",rust:".rs",rs:".rs",swift:".swift",kotlin:".kt",kt:".kt",scala:".scala",html:".html",css:".css",scss:".scss",sass:".sass",less:".less",json:".json",xml:".xml",yaml:".yaml",yml:".yml",toml:".toml",ini:".ini",conf:".conf",config:".config",sh:".sh",bash:".sh",zsh:".zsh",fish:".fish",powershell:".ps1",ps1:".ps1",bat:".bat",cmd:".cmd",sql:".sql",r:".r",matlab:".m",octave:".m",lua:".lua",perl:".pl",vim:".vim",dockerfile:"Dockerfile",makefile:"Makefile",markdown:".md",md:".md",tex:".tex",latex:".tex"}[e.toLowerCase()]||".txt"}class rXe{constructor(){ce(this,"id","core-codeblock-download")}async initialize(t){}register(t){t.registerCanvasControl({id:this.id,type:"codeblock",targetSlot:"codeblock-header-actions",renderer:n=>Ve.createElement(tXe,{interactionId:n.interactionId,codeBlockId:n.codeBlockId,language:n.codeBlockLang,codeToDownload:n.codeBlockContent??"",filepath:n.codeBlockFilepath,disabled:!n.codeBlockContent||n.codeBlockContent.trim()===""})})}destroy(t){}}const sXe=({toolCall:e})=>{const[t,n]=E.useState(!0),r=()=>n(i=>!i),s=E.useMemo(()=>{try{return JSON.stringify(e.args,null,2)}catch{return String(e.args)}},[e.args]);return f.jsxs("div",{className:"my-2 p-2 border border-amber-500/30 bg-amber-500/10 rounded-md text-xs",children:[f.jsxs("div",{className:"flex items-center justify-between mb-1",children:[f.jsxs("span",{className:"font-semibold text-amber-700 dark:text-amber-300",children:["Tool Call: ",f.jsx("code",{className:"font-mono",children:e.toolName})]}),f.jsx(Un,{tooltipText:t?"Show Args":"Hide Args",onClick:r,"aria-label":t?"Show arguments":"Hide arguments",icon:t?f.jsx(uc,{}):f.jsx(tp,{}),iconClassName:"h-3 w-3",className:"h-5 w-5 text-muted-foreground"})]}),!t&&f.jsx(ib,{lang:"json",code:s})]})},iXe=({toolResult:e})=>{const[t,n]=E.useState(!0),r=()=>n(a=>!a),s=E.useMemo(()=>{try{return typeof e.result=="object"&&e.result!==null&&e.result._isError===!0?`Error: ${e.result.error}`:JSON.stringify(e.result,null,2)}catch{return String(e.result)}},[e.result]),i=typeof e.result=="object"&&e.result!==null&&e.result._isError===!0;return f.jsxs("div",{className:Ye("my-2 p-2 border rounded-md text-xs",i?"border-destructive/30 bg-destructive/10":"border-green-500/30 bg-green-500/10"),children:[f.jsxs("div",{className:"flex items-center justify-between mb-1",children:[f.jsxs("span",{className:Ye("font-semibold",i?"text-destructive":"text-green-700 dark:text-green-300"),children:["Tool Result: ",f.jsx("code",{className:"font-mono",children:e.toolName})]}),f.jsx(Un,{tooltipText:t?"Show Result":"Hide Result",onClick:r,"aria-label":t?"Show result":"Hide result",icon:t?f.jsx(uc,{}):f.jsx(tp,{}),iconClassName:"h-3 w-3",className:"h-5 w-5 text-muted-foreground"})]}),!t&&f.jsx(ib,{lang:i?"text":"json",code:s})]})},aXe=({interactionId:e,toolCall:t,toolResult:n})=>f.jsxs("div",{className:"tool-call-step my-1","data-interaction-id":e,"data-tool-call-id":t.toolCallId,children:[f.jsx(sXe,{toolCall:t}),n&&f.jsx(iXe,{toolResult:n})]});class oXe{constructor(){ce(this,"id","core-tool-call-step-display")}async initialize(t){}register(t){t.registerCanvasControl({id:this.id,type:"tool-call-step",targetSlot:"tool-call-content",renderer:n=>!n.interactionId||!n.toolCall?(console.warn("[ToolCallStepControlModule] Missing interactionId or toolCall in context"),null):Ve.createElement(aXe,{interactionId:n.interactionId,toolCall:n.toolCall,toolResult:n.toolResult})})}destroy(t){}}const lXe=({lang:e,code:t,filepath:n,isStreaming:r=!1,interactionId:s,blockId:i})=>{const{foldStreamingCodeBlocks:a}=pr(mn(C=>({foldStreamingCodeBlocks:C.foldStreamingCodeBlocks}))),[o,l]=E.useState(r?a:!1),[c,u]=E.useState(!1),[d,h]=E.useState(t);E.useEffect(()=>{c||h(t)},[t,c]);const m=E.useRef(null),y=Bi(mn(C=>Object.values(C.canvasControls))),b=E.useCallback((C,T,A,N,I,j)=>y.filter(L=>L.type==="codeblock"&&L.targetSlot===C&&L.renderer).map(L=>{if(L.renderer){const D={codeBlockContent:T,codeBlockEditedContent:d,codeBlockLang:A,codeBlockFilepath:N,isFolded:I,toggleFold:j,canvasContextType:"codeblock",interactionId:s,blockId:i,onEditModeChange:u};return f.jsx(Ve.Fragment,{children:L.renderer(D)},L.id)}return null}).filter(Boolean),[y,d,s,u]),v=E.useCallback(()=>{if(m.current&&t)try{m.current.style.whiteSpace!=="pre-wrap"&&(m.current.style.whiteSpace="pre-wrap"),m.current.textContent=t,Ys.highlightElement(m.current)}catch(C){console.error("Prism highlight error:",C),m.current.textContent=t}else m.current&&(m.current.textContent="")},[t]);E.useEffect(()=>{o||v()},[t,e,o,v]);const x=()=>{const C=o;l(T=>!T),C&&setTimeout(v,0)},w=e?`language-${e}`:"language-plaintext",_=E.useMemo(()=>t?t.split(`
`).slice(0,3).join(`
`):"",[t]),k=b("codeblock-header-actions",t,e,n,o,x);return f.jsxs("div",{className:"code-block-container group/codeblock my-4 max-w-full",children:[f.jsxs("div",{className:"code-block-header sticky top-0 z-[var(--z-sticky)] flex items-center justify-between px-3 py-2 border border-b-0 border-border bg-muted/50 rounded-t-lg",children:[f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx("div",{className:"text-sm font-medium",children:e?e.toUpperCase():"CODE"}),n&&f.jsx("div",{className:"text-xs text-muted-foreground font-mono",children:n}),f.jsx("div",{className:"flex items-center gap-0.5 opacity-0 group-hover/codeblock:opacity-100 focus-within:opacity-100 transition-opacity",children:k})]}),f.jsx("div",{})]}),!o&&!c&&f.jsx("div",{className:"overflow-hidden w-full",children:f.jsx("pre",{className:"overflow-x-auto w-full relative overflow-wrap-anywhere border border-border rounded-b-lg bg-muted/20",children:f.jsx("code",{ref:m,className:w+" block p-4 font-mono text-sm leading-relaxed"})})}),!o&&c&&f.jsx("div",{className:"overflow-hidden w-full border border-border rounded-b-lg bg-muted/20",children:f.jsx(VZe,{code:d,language:e,onChange:h})}),o&&f.jsx("div",{className:"folded-content-preview p-4 cursor-pointer w-full box-border border border-t-0 border-border rounded-b-lg bg-muted/10 hover:bg-muted/20 transition-colors",onClick:x,children:f.jsx("pre",{className:"whitespace-pre-wrap break-words text-muted-foreground font-mono text-sm",children:_})})]})},R6=E.memo(lXe);class cXe{constructor(){ce(this,"id","core-block-renderer-code");ce(this,"unregisterCallback")}async initialize(){}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}const n={id:this.id,supportedLanguages:void 0,priority:0,renderer:r=>Ve.createElement(R6,{lang:r.lang,code:r.code,filepath:r.filepath,isStreaming:r.isStreaming,interactionId:r.interactionId,blockId:r.blockId})};this.unregisterCallback=t.registerBlockRenderer(n)}destroy(){this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=void 0)}}var r2={exports:{}},uXe=r2.exports,MV;function dXe(){return MV||(MV=1,function(e,t){(function(n,r){e.exports=r()})(uXe,function(){var n=1e3,r=6e4,s=36e5,i="millisecond",a="second",o="minute",l="hour",c="day",u="week",d="month",h="quarter",m="year",y="date",b="Invalid Date",v=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,x=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,w={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(O){var K=["th","st","nd","rd"],U=O%100;return"["+O+(K[(U-20)%10]||K[U]||K[0])+"]"}},_=function(O,K,U){var W=String(O);return!W||W.length>=K?O:""+Array(K+1-W.length).join(U)+O},k={s:_,z:function(O){var K=-O.utcOffset(),U=Math.abs(K),W=Math.floor(U/60),B=U%60;return(K<=0?"+":"-")+_(W,2,"0")+":"+_(B,2,"0")},m:function O(K,U){if(K.date()<U.date())return-O(U,K);var W=12*(U.year()-K.year())+(U.month()-K.month()),B=K.clone().add(W,d),ne=U-B<0,V=K.clone().add(W+(ne?-1:1),d);return+(-(W+(U-B)/(ne?B-V:V-B))||0)},a:function(O){return O<0?Math.ceil(O)||0:Math.floor(O)},p:function(O){return{M:d,y:m,w:u,d:c,D:y,h:l,m:o,s:a,ms:i,Q:h}[O]||String(O||"").toLowerCase().replace(/s$/,"")},u:function(O){return O===void 0}},C="en",T={};T[C]=w;var A="$isDayjsObject",N=function(O){return O instanceof D||!(!O||!O[A])},I=function O(K,U,W){var B;if(!K)return C;if(typeof K=="string"){var ne=K.toLowerCase();T[ne]&&(B=ne),U&&(T[ne]=U,B=ne);var V=K.split("-");if(!B&&V.length>1)return O(V[0])}else{var Q=K.name;T[Q]=K,B=Q}return!W&&B&&(C=B),B||!W&&C},j=function(O,K){if(N(O))return O.clone();var U=typeof K=="object"?K:{};return U.date=O,U.args=arguments,new D(U)},L=k;L.l=I,L.i=N,L.w=function(O,K){return j(O,{locale:K.$L,utc:K.$u,x:K.$x,$offset:K.$offset})};var D=function(){function O(U){this.$L=I(U.locale,null,!0),this.parse(U),this.$x=this.$x||U.x||{},this[A]=!0}var K=O.prototype;return K.parse=function(U){this.$d=function(W){var B=W.date,ne=W.utc;if(B===null)return new Date(NaN);if(L.u(B))return new Date;if(B instanceof Date)return new Date(B);if(typeof B=="string"&&!/Z$/i.test(B)){var V=B.match(v);if(V){var Q=V[2]-1||0,ee=(V[7]||"0").substring(0,3);return ne?new Date(Date.UTC(V[1],Q,V[3]||1,V[4]||0,V[5]||0,V[6]||0,ee)):new Date(V[1],Q,V[3]||1,V[4]||0,V[5]||0,V[6]||0,ee)}}return new Date(B)}(U),this.init()},K.init=function(){var U=this.$d;this.$y=U.getFullYear(),this.$M=U.getMonth(),this.$D=U.getDate(),this.$W=U.getDay(),this.$H=U.getHours(),this.$m=U.getMinutes(),this.$s=U.getSeconds(),this.$ms=U.getMilliseconds()},K.$utils=function(){return L},K.isValid=function(){return this.$d.toString()!==b},K.isSame=function(U,W){var B=j(U);return this.startOf(W)<=B&&B<=this.endOf(W)},K.isAfter=function(U,W){return j(U)<this.startOf(W)},K.isBefore=function(U,W){return this.endOf(W)<j(U)},K.$g=function(U,W,B){return L.u(U)?this[W]:this.set(B,U)},K.unix=function(){return Math.floor(this.valueOf()/1e3)},K.valueOf=function(){return this.$d.getTime()},K.startOf=function(U,W){var B=this,ne=!!L.u(W)||W,V=L.p(U),Q=function(_e,Ue){var Qe=L.w(B.$u?Date.UTC(B.$y,Ue,_e):new Date(B.$y,Ue,_e),B);return ne?Qe:Qe.endOf(c)},ee=function(_e,Ue){return L.w(B.toDate()[_e].apply(B.toDate("s"),(ne?[0,0,0,0]:[23,59,59,999]).slice(Ue)),B)},re=this.$W,de=this.$M,me=this.$D,De="set"+(this.$u?"UTC":"");switch(V){case m:return ne?Q(1,0):Q(31,11);case d:return ne?Q(1,de):Q(0,de+1);case u:var je=this.$locale().weekStart||0,Te=(re<je?re+7:re)-je;return Q(ne?me-Te:me+(6-Te),de);case c:case y:return ee(De+"Hours",0);case l:return ee(De+"Minutes",1);case o:return ee(De+"Seconds",2);case a:return ee(De+"Milliseconds",3);default:return this.clone()}},K.endOf=function(U){return this.startOf(U,!1)},K.$set=function(U,W){var B,ne=L.p(U),V="set"+(this.$u?"UTC":""),Q=(B={},B[c]=V+"Date",B[y]=V+"Date",B[d]=V+"Month",B[m]=V+"FullYear",B[l]=V+"Hours",B[o]=V+"Minutes",B[a]=V+"Seconds",B[i]=V+"Milliseconds",B)[ne],ee=ne===c?this.$D+(W-this.$W):W;if(ne===d||ne===m){var re=this.clone().set(y,1);re.$d[Q](ee),re.init(),this.$d=re.set(y,Math.min(this.$D,re.daysInMonth())).$d}else Q&&this.$d[Q](ee);return this.init(),this},K.set=function(U,W){return this.clone().$set(U,W)},K.get=function(U){return this[L.p(U)]()},K.add=function(U,W){var B,ne=this;U=Number(U);var V=L.p(W),Q=function(de){var me=j(ne);return L.w(me.date(me.date()+Math.round(de*U)),ne)};if(V===d)return this.set(d,this.$M+U);if(V===m)return this.set(m,this.$y+U);if(V===c)return Q(1);if(V===u)return Q(7);var ee=(B={},B[o]=r,B[l]=s,B[a]=n,B)[V]||1,re=this.$d.getTime()+U*ee;return L.w(re,this)},K.subtract=function(U,W){return this.add(-1*U,W)},K.format=function(U){var W=this,B=this.$locale();if(!this.isValid())return B.invalidDate||b;var ne=U||"YYYY-MM-DDTHH:mm:ssZ",V=L.z(this),Q=this.$H,ee=this.$m,re=this.$M,de=B.weekdays,me=B.months,De=B.meridiem,je=function(Ue,Qe,We,Pe){return Ue&&(Ue[Qe]||Ue(W,ne))||We[Qe].slice(0,Pe)},Te=function(Ue){return L.s(Q%12||12,Ue,"0")},_e=De||function(Ue,Qe,We){var Pe=Ue<12?"AM":"PM";return We?Pe.toLowerCase():Pe};return ne.replace(x,function(Ue,Qe){return Qe||function(We){switch(We){case"YY":return String(W.$y).slice(-2);case"YYYY":return L.s(W.$y,4,"0");case"M":return re+1;case"MM":return L.s(re+1,2,"0");case"MMM":return je(B.monthsShort,re,me,3);case"MMMM":return je(me,re);case"D":return W.$D;case"DD":return L.s(W.$D,2,"0");case"d":return String(W.$W);case"dd":return je(B.weekdaysMin,W.$W,de,2);case"ddd":return je(B.weekdaysShort,W.$W,de,3);case"dddd":return de[W.$W];case"H":return String(Q);case"HH":return L.s(Q,2,"0");case"h":return Te(1);case"hh":return Te(2);case"a":return _e(Q,ee,!0);case"A":return _e(Q,ee,!1);case"m":return String(ee);case"mm":return L.s(ee,2,"0");case"s":return String(W.$s);case"ss":return L.s(W.$s,2,"0");case"SSS":return L.s(W.$ms,3,"0");case"Z":return V}return null}(Ue)||V.replace(":","")})},K.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},K.diff=function(U,W,B){var ne,V=this,Q=L.p(W),ee=j(U),re=(ee.utcOffset()-this.utcOffset())*r,de=this-ee,me=function(){return L.m(V,ee)};switch(Q){case m:ne=me()/12;break;case d:ne=me();break;case h:ne=me()/3;break;case u:ne=(de-re)/6048e5;break;case c:ne=(de-re)/864e5;break;case l:ne=de/s;break;case o:ne=de/r;break;case a:ne=de/n;break;default:ne=de}return B?ne:L.a(ne)},K.daysInMonth=function(){return this.endOf(d).$D},K.$locale=function(){return T[this.$L]},K.locale=function(U,W){if(!U)return this.$L;var B=this.clone(),ne=I(U,W,!0);return ne&&(B.$L=ne),B},K.clone=function(){return L.w(this.$d,this)},K.toDate=function(){return new Date(this.valueOf())},K.toJSON=function(){return this.isValid()?this.toISOString():null},K.toISOString=function(){return this.$d.toISOString()},K.toString=function(){return this.$d.toUTCString()},O}(),H=D.prototype;return j.prototype=H,[["$ms",i],["$s",a],["$m",o],["$H",l],["$W",c],["$M",d],["$y",m],["$D",y]].forEach(function(O){H[O[1]]=function(K){return this.$g(K,O[0],O[1])}}),j.extend=function(O,K){return O.$i||(O(K,D,j),O.$i=!0),j},j.locale=I,j.isDayjs=N,j.unix=function(O){return j(1e3*O)},j.en=T[C],j.Ls=T,j.p={},j})}(r2)),r2.exports}var fXe=dXe();const hXe=ga(fXe),s2={min:{r:0,g:0,b:0,s:0,l:0,a:0},max:{r:255,g:255,b:255,h:360,s:100,l:100,a:1},clamp:{r:e=>e>=255?255:e<0?0:e,g:e=>e>=255?255:e<0?0:e,b:e=>e>=255?255:e<0?0:e,h:e=>e%360,s:e=>e>=100?100:e<0?0:e,l:e=>e>=100?100:e<0?0:e,a:e=>e>=1?1:e<0?0:e},toLinear:e=>{const t=e/255;return e>.03928?Math.pow((t+.055)/1.055,2.4):t/12.92},hue2rgb:(e,t,n)=>(n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+(t-e)*6*n:n<1/2?t:n<2/3?e+(t-e)*(2/3-n)*6:e),hsl2rgb:({h:e,s:t,l:n},r)=>{if(!t)return n*2.55;e/=360,t/=100,n/=100;const s=n<.5?n*(1+t):n+t-n*t,i=2*n-s;switch(r){case"r":return s2.hue2rgb(i,s,e+1/3)*255;case"g":return s2.hue2rgb(i,s,e)*255;case"b":return s2.hue2rgb(i,s,e-1/3)*255}},rgb2hsl:({r:e,g:t,b:n},r)=>{e/=255,t/=255,n/=255;const s=Math.max(e,t,n),i=Math.min(e,t,n),a=(s+i)/2;if(r==="l")return a*100;if(s===i)return 0;const o=s-i,l=a>.5?o/(2-s-i):o/(s+i);if(r==="s")return l*100;switch(s){case e:return((t-n)/o+(t<n?6:0))*60;case t:return((n-e)/o+2)*60;case n:return((e-t)/o+4)*60;default:return-1}}},pXe={clamp:(e,t,n)=>t>n?Math.min(t,Math.max(n,e)):Math.min(n,Math.max(t,e)),round:e=>Math.round(e*1e10)/1e10},mXe={dec2hex:e=>{const t=Math.round(e).toString(16);return t.length>1?t:`0${t}`}},dr={channel:s2,lang:pXe,unit:mXe},yh={};for(let e=0;e<=255;e++)yh[e]=dr.unit.dec2hex(e);const Fa={ALL:0,RGB:1,HSL:2};class gXe{constructor(){this.type=Fa.ALL}get(){return this.type}set(t){if(this.type&&this.type!==t)throw new Error("Cannot change both RGB and HSL channels at the same time");this.type=t}reset(){this.type=Fa.ALL}is(t){return this.type===t}}class yXe{constructor(t,n){this.color=n,this.changed=!1,this.data=t,this.type=new gXe}set(t,n){return this.color=n,this.changed=!1,this.data=t,this.type.type=Fa.ALL,this}_ensureHSL(){const t=this.data,{h:n,s:r,l:s}=t;n===void 0&&(t.h=dr.channel.rgb2hsl(t,"h")),r===void 0&&(t.s=dr.channel.rgb2hsl(t,"s")),s===void 0&&(t.l=dr.channel.rgb2hsl(t,"l"))}_ensureRGB(){const t=this.data,{r:n,g:r,b:s}=t;n===void 0&&(t.r=dr.channel.hsl2rgb(t,"r")),r===void 0&&(t.g=dr.channel.hsl2rgb(t,"g")),s===void 0&&(t.b=dr.channel.hsl2rgb(t,"b"))}get r(){const t=this.data,n=t.r;return!this.type.is(Fa.HSL)&&n!==void 0?n:(this._ensureHSL(),dr.channel.hsl2rgb(t,"r"))}get g(){const t=this.data,n=t.g;return!this.type.is(Fa.HSL)&&n!==void 0?n:(this._ensureHSL(),dr.channel.hsl2rgb(t,"g"))}get b(){const t=this.data,n=t.b;return!this.type.is(Fa.HSL)&&n!==void 0?n:(this._ensureHSL(),dr.channel.hsl2rgb(t,"b"))}get h(){const t=this.data,n=t.h;return!this.type.is(Fa.RGB)&&n!==void 0?n:(this._ensureRGB(),dr.channel.rgb2hsl(t,"h"))}get s(){const t=this.data,n=t.s;return!this.type.is(Fa.RGB)&&n!==void 0?n:(this._ensureRGB(),dr.channel.rgb2hsl(t,"s"))}get l(){const t=this.data,n=t.l;return!this.type.is(Fa.RGB)&&n!==void 0?n:(this._ensureRGB(),dr.channel.rgb2hsl(t,"l"))}get a(){return this.data.a}set r(t){this.type.set(Fa.RGB),this.changed=!0,this.data.r=t}set g(t){this.type.set(Fa.RGB),this.changed=!0,this.data.g=t}set b(t){this.type.set(Fa.RGB),this.changed=!0,this.data.b=t}set h(t){this.type.set(Fa.HSL),this.changed=!0,this.data.h=t}set s(t){this.type.set(Fa.HSL),this.changed=!0,this.data.s=t}set l(t){this.type.set(Fa.HSL),this.changed=!0,this.data.l=t}set a(t){this.changed=!0,this.data.a=t}}const oA=new yXe({r:0,g:0,b:0,a:0},"transparent"),J0={re:/^#((?:[a-f0-9]{2}){2,4}|[a-f0-9]{3})$/i,parse:e=>{if(e.charCodeAt(0)!==35)return;const t=e.match(J0.re);if(!t)return;const n=t[1],r=parseInt(n,16),s=n.length,i=s%4===0,a=s>4,o=a?1:17,l=a?8:4,c=i?0:-1,u=a?255:15;return oA.set({r:(r>>l*(c+3)&u)*o,g:(r>>l*(c+2)&u)*o,b:(r>>l*(c+1)&u)*o,a:i?(r&u)*o/255:1},e)},stringify:e=>{const{r:t,g:n,b:r,a:s}=e;return s<1?`#${yh[Math.round(t)]}${yh[Math.round(n)]}${yh[Math.round(r)]}${yh[Math.round(s*255)]}`:`#${yh[Math.round(t)]}${yh[Math.round(n)]}${yh[Math.round(r)]}`}},mm={re:/^hsla?\(\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e-?\d+)?(?:deg|grad|rad|turn)?)\s*?(?:,|\s)\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e-?\d+)?%)\s*?(?:,|\s)\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e-?\d+)?%)(?:\s*?(?:,|\/)\s*?\+?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e-?\d+)?(%)?))?\s*?\)$/i,hueRe:/^(.+?)(deg|grad|rad|turn)$/i,_hue2deg:e=>{const t=e.match(mm.hueRe);if(t){const[,n,r]=t;switch(r){case"grad":return dr.channel.clamp.h(parseFloat(n)*.9);case"rad":return dr.channel.clamp.h(parseFloat(n)*180/Math.PI);case"turn":return dr.channel.clamp.h(parseFloat(n)*360)}}return dr.channel.clamp.h(parseFloat(e))},parse:e=>{const t=e.charCodeAt(0);if(t!==104&&t!==72)return;const n=e.match(mm.re);if(!n)return;const[,r,s,i,a,o]=n;return oA.set({h:mm._hue2deg(r),s:dr.channel.clamp.s(parseFloat(s)),l:dr.channel.clamp.l(parseFloat(i)),a:a?dr.channel.clamp.a(o?parseFloat(a)/100:parseFloat(a)):1},e)},stringify:e=>{const{h:t,s:n,l:r,a:s}=e;return s<1?`hsla(${dr.lang.round(t)}, ${dr.lang.round(n)}%, ${dr.lang.round(r)}%, ${s})`:`hsl(${dr.lang.round(t)}, ${dr.lang.round(n)}%, ${dr.lang.round(r)}%)`}},Zx={colors:{aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyanaqua:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",transparent:"#00000000",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},parse:e=>{e=e.toLowerCase();const t=Zx.colors[e];if(t)return J0.parse(t)},stringify:e=>{const t=J0.stringify(e);for(const n in Zx.colors)if(Zx.colors[n]===t)return n}},Tx={re:/^rgba?\(\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e\d+)?(%?))\s*?(?:,|\s)\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e\d+)?(%?))\s*?(?:,|\s)\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e\d+)?(%?))(?:\s*?(?:,|\/)\s*?\+?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e\d+)?(%?)))?\s*?\)$/i,parse:e=>{const t=e.charCodeAt(0);if(t!==114&&t!==82)return;const n=e.match(Tx.re);if(!n)return;const[,r,s,i,a,o,l,c,u]=n;return oA.set({r:dr.channel.clamp.r(s?parseFloat(r)*2.55:parseFloat(r)),g:dr.channel.clamp.g(a?parseFloat(i)*2.55:parseFloat(i)),b:dr.channel.clamp.b(l?parseFloat(o)*2.55:parseFloat(o)),a:c?dr.channel.clamp.a(u?parseFloat(c)/100:parseFloat(c)):1},e)},stringify:e=>{const{r:t,g:n,b:r,a:s}=e;return s<1?`rgba(${dr.lang.round(t)}, ${dr.lang.round(n)}, ${dr.lang.round(r)}, ${dr.lang.round(s)})`:`rgb(${dr.lang.round(t)}, ${dr.lang.round(n)}, ${dr.lang.round(r)})`}},Gu={format:{keyword:Zx,hex:J0,rgb:Tx,rgba:Tx,hsl:mm,hsla:mm},parse:e=>{if(typeof e!="string")return e;const t=J0.parse(e)||Tx.parse(e)||mm.parse(e)||Zx.parse(e);if(t)return t;throw new Error(`Unsupported color format: "${e}"`)},stringify:e=>!e.changed&&e.color?e.color:e.type.is(Fa.HSL)||e.data.r===void 0?mm.stringify(e):e.a<1||!Number.isInteger(e.r)||!Number.isInteger(e.g)||!Number.isInteger(e.b)?Tx.stringify(e):J0.stringify(e)},tae=(e,t)=>{const n=Gu.parse(e);for(const r in t)n[r]=dr.channel.clamp[r](t[r]);return Gu.stringify(n)},Xx=(e,t,n=0,r=1)=>{if(typeof e!="number")return tae(e,{a:t});const s=oA.set({r:dr.channel.clamp.r(e),g:dr.channel.clamp.g(t),b:dr.channel.clamp.b(n),a:dr.channel.clamp.a(r)});return Gu.stringify(s)},bXe=e=>{const{r:t,g:n,b:r}=Gu.parse(e),s=.2126*dr.channel.toLinear(t)+.7152*dr.channel.toLinear(n)+.0722*dr.channel.toLinear(r);return dr.lang.round(s)},vXe=e=>bXe(e)>=.5,SS=e=>!vXe(e),nae=(e,t,n)=>{const r=Gu.parse(e),s=r[t],i=dr.channel.clamp[t](s+n);return s!==i&&(r[t]=i),Gu.stringify(r)},kn=(e,t)=>nae(e,"l",t),Wn=(e,t)=>nae(e,"l",-t),xt=(e,t)=>{const n=Gu.parse(e),r={};for(const s in t)t[s]&&(r[s]=n[s]+t[s]);return tae(e,r)},xXe=(e,t,n=50)=>{const{r,g:s,b:i,a}=Gu.parse(e),{r:o,g:l,b:c,a:u}=Gu.parse(t),d=n/100,h=d*2-1,m=a-u,b=((h*m===-1?h:(h+m)/(1+h*m))+1)/2,v=1-b,x=r*b+o*v,w=s*b+l*v,_=i*b+c*v,k=a*d+u*(1-d);return Xx(x,w,_,k)},dn=(e,t=100)=>{const n=Gu.parse(e);return n.r=255-n.r,n.g=255-n.g,n.b=255-n.b,xXe(n,e,t)};/*! @license DOMPurify 3.2.6 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.6/LICENSE */const{entries:rae,setPrototypeOf:jV,isFrozen:wXe,getPrototypeOf:SXe,getOwnPropertyDescriptor:_Xe}=Object;let{freeze:So,seal:lc,create:sae}=Object,{apply:QP,construct:e4}=typeof Reflect<"u"&&Reflect;So||(So=function(t){return t});lc||(lc=function(t){return t});QP||(QP=function(t,n,r){return t.apply(n,r)});e4||(e4=function(t,n){return new t(...n)});const NC=_o(Array.prototype.forEach),CXe=_o(Array.prototype.lastIndexOf),PV=_o(Array.prototype.pop),ex=_o(Array.prototype.push),kXe=_o(Array.prototype.splice),i2=_o(String.prototype.toLowerCase),Oj=_o(String.prototype.toString),OV=_o(String.prototype.match),tx=_o(String.prototype.replace),EXe=_o(String.prototype.indexOf),TXe=_o(String.prototype.trim),Rc=_o(Object.prototype.hasOwnProperty),so=_o(RegExp.prototype.test),nx=AXe(TypeError);function _o(e){return function(t){t instanceof RegExp&&(t.lastIndex=0);for(var n=arguments.length,r=new Array(n>1?n-1:0),s=1;s<n;s++)r[s-1]=arguments[s];return QP(e,t,r)}}function AXe(e){return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e4(e,n)}}function zr(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:i2;jV&&jV(e,null);let r=t.length;for(;r--;){let s=t[r];if(typeof s=="string"){const i=n(s);i!==s&&(wXe(t)||(t[r]=i),s=i)}e[s]=!0}return e}function RXe(e){for(let t=0;t<e.length;t++)Rc(e,t)||(e[t]=null);return e}function Dd(e){const t=sae(null);for(const[n,r]of rae(e))Rc(e,n)&&(Array.isArray(r)?t[n]=RXe(r):r&&typeof r=="object"&&r.constructor===Object?t[n]=Dd(r):t[n]=r);return t}function rx(e,t){for(;e!==null;){const r=_Xe(e,t);if(r){if(r.get)return _o(r.get);if(typeof r.value=="function")return _o(r.value)}e=SXe(e)}function n(){return null}return n}const DV=So(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Dj=So(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Fj=So(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),NXe=So(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Lj=So(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),IXe=So(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),FV=So(["#text"]),LV=So(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),Bj=So(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),BV=So(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),IC=So(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),MXe=lc(/\{\{[\w\W]*|[\w\W]*\}\}/gm),jXe=lc(/<%[\w\W]*|[\w\W]*%>/gm),PXe=lc(/\$\{[\w\W]*/gm),OXe=lc(/^data-[\-\w.\u00B7-\uFFFF]+$/),DXe=lc(/^aria-[\-\w]+$/),iae=lc(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),FXe=lc(/^(?:\w+script|data):/i),LXe=lc(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),aae=lc(/^html$/i),BXe=lc(/^[a-z][.\w]*(-[.\w]+)+$/i);var $V=Object.freeze({__proto__:null,ARIA_ATTR:DXe,ATTR_WHITESPACE:LXe,CUSTOM_ELEMENT:BXe,DATA_ATTR:OXe,DOCTYPE_NAME:aae,ERB_EXPR:jXe,IS_ALLOWED_URI:iae,IS_SCRIPT_OR_DATA:FXe,MUSTACHE_EXPR:MXe,TMPLIT_EXPR:PXe});const sx={element:1,text:3,progressingInstruction:7,comment:8,document:9},$Xe=function(){return typeof window>"u"?null:window},zXe=function(t,n){if(typeof t!="object"||typeof t.createPolicy!="function")return null;let r=null;const s="data-tt-policy-suffix";n&&n.hasAttribute(s)&&(r=n.getAttribute(s));const i="dompurify"+(r?"#"+r:"");try{return t.createPolicy(i,{createHTML(a){return a},createScriptURL(a){return a}})}catch{return console.warn("TrustedTypes policy "+i+" could not be created."),null}},zV=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function oae(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:$Xe();const t=gn=>oae(gn);if(t.version="3.2.6",t.removed=[],!e||!e.document||e.document.nodeType!==sx.document||!e.Element)return t.isSupported=!1,t;let{document:n}=e;const r=n,s=r.currentScript,{DocumentFragment:i,HTMLTemplateElement:a,Node:o,Element:l,NodeFilter:c,NamedNodeMap:u=e.NamedNodeMap||e.MozNamedAttrMap,HTMLFormElement:d,DOMParser:h,trustedTypes:m}=e,y=l.prototype,b=rx(y,"cloneNode"),v=rx(y,"remove"),x=rx(y,"nextSibling"),w=rx(y,"childNodes"),_=rx(y,"parentNode");if(typeof a=="function"){const gn=n.createElement("template");gn.content&&gn.content.ownerDocument&&(n=gn.content.ownerDocument)}let k,C="";const{implementation:T,createNodeIterator:A,createDocumentFragment:N,getElementsByTagName:I}=n,{importNode:j}=r;let L=zV();t.isSupported=typeof rae=="function"&&typeof _=="function"&&T&&T.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:D,ERB_EXPR:H,TMPLIT_EXPR:O,DATA_ATTR:K,ARIA_ATTR:U,IS_SCRIPT_OR_DATA:W,ATTR_WHITESPACE:B,CUSTOM_ELEMENT:ne}=$V;let{IS_ALLOWED_URI:V}=$V,Q=null;const ee=zr({},[...DV,...Dj,...Fj,...Lj,...FV]);let re=null;const de=zr({},[...LV,...Bj,...BV,...IC]);let me=Object.seal(sae(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),De=null,je=null,Te=!0,_e=!0,Ue=!1,Qe=!0,We=!1,Pe=!0,Y=!1,ye=!1,Me=!1,ue=!1,oe=!1,se=!1,Ie=!0,Be=!1;const Re="user-content-";let ct=!0,At=!1,ut={},Pt=null;const Ut=zr({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Ft=null;const Yt=zr({},["audio","video","img","source","image","track"]);let we=null;const F=zr({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),X="http://www.w3.org/1998/Math/MathML",be="http://www.w3.org/2000/svg",Ee="http://www.w3.org/1999/xhtml";let ge=Ee,Ae=!1,le=null;const ft=zr({},[X,be,Ee],Oj);let et=zr({},["mi","mo","mn","ms","mtext"]),$=zr({},["annotation-xml"]);const qe=zr({},["title","style","font","a","script"]);let tt=null;const ve=["application/xhtml+xml","text/html"],Se="text/html";let ze=null,Ct=null;const fe=n.createElement("form"),Z=function(nt){return nt instanceof RegExp||nt instanceof Function},G=function(){let nt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(Ct&&Ct===nt)){if((!nt||typeof nt!="object")&&(nt={}),nt=Dd(nt),tt=ve.indexOf(nt.PARSER_MEDIA_TYPE)===-1?Se:nt.PARSER_MEDIA_TYPE,ze=tt==="application/xhtml+xml"?Oj:i2,Q=Rc(nt,"ALLOWED_TAGS")?zr({},nt.ALLOWED_TAGS,ze):ee,re=Rc(nt,"ALLOWED_ATTR")?zr({},nt.ALLOWED_ATTR,ze):de,le=Rc(nt,"ALLOWED_NAMESPACES")?zr({},nt.ALLOWED_NAMESPACES,Oj):ft,we=Rc(nt,"ADD_URI_SAFE_ATTR")?zr(Dd(F),nt.ADD_URI_SAFE_ATTR,ze):F,Ft=Rc(nt,"ADD_DATA_URI_TAGS")?zr(Dd(Yt),nt.ADD_DATA_URI_TAGS,ze):Yt,Pt=Rc(nt,"FORBID_CONTENTS")?zr({},nt.FORBID_CONTENTS,ze):Ut,De=Rc(nt,"FORBID_TAGS")?zr({},nt.FORBID_TAGS,ze):Dd({}),je=Rc(nt,"FORBID_ATTR")?zr({},nt.FORBID_ATTR,ze):Dd({}),ut=Rc(nt,"USE_PROFILES")?nt.USE_PROFILES:!1,Te=nt.ALLOW_ARIA_ATTR!==!1,_e=nt.ALLOW_DATA_ATTR!==!1,Ue=nt.ALLOW_UNKNOWN_PROTOCOLS||!1,Qe=nt.ALLOW_SELF_CLOSE_IN_ATTR!==!1,We=nt.SAFE_FOR_TEMPLATES||!1,Pe=nt.SAFE_FOR_XML!==!1,Y=nt.WHOLE_DOCUMENT||!1,ue=nt.RETURN_DOM||!1,oe=nt.RETURN_DOM_FRAGMENT||!1,se=nt.RETURN_TRUSTED_TYPE||!1,Me=nt.FORCE_BODY||!1,Ie=nt.SANITIZE_DOM!==!1,Be=nt.SANITIZE_NAMED_PROPS||!1,ct=nt.KEEP_CONTENT!==!1,At=nt.IN_PLACE||!1,V=nt.ALLOWED_URI_REGEXP||iae,ge=nt.NAMESPACE||Ee,et=nt.MATHML_TEXT_INTEGRATION_POINTS||et,$=nt.HTML_INTEGRATION_POINTS||$,me=nt.CUSTOM_ELEMENT_HANDLING||{},nt.CUSTOM_ELEMENT_HANDLING&&Z(nt.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(me.tagNameCheck=nt.CUSTOM_ELEMENT_HANDLING.tagNameCheck),nt.CUSTOM_ELEMENT_HANDLING&&Z(nt.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(me.attributeNameCheck=nt.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),nt.CUSTOM_ELEMENT_HANDLING&&typeof nt.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(me.allowCustomizedBuiltInElements=nt.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),We&&(_e=!1),oe&&(ue=!0),ut&&(Q=zr({},FV),re=[],ut.html===!0&&(zr(Q,DV),zr(re,LV)),ut.svg===!0&&(zr(Q,Dj),zr(re,Bj),zr(re,IC)),ut.svgFilters===!0&&(zr(Q,Fj),zr(re,Bj),zr(re,IC)),ut.mathMl===!0&&(zr(Q,Lj),zr(re,BV),zr(re,IC))),nt.ADD_TAGS&&(Q===ee&&(Q=Dd(Q)),zr(Q,nt.ADD_TAGS,ze)),nt.ADD_ATTR&&(re===de&&(re=Dd(re)),zr(re,nt.ADD_ATTR,ze)),nt.ADD_URI_SAFE_ATTR&&zr(we,nt.ADD_URI_SAFE_ATTR,ze),nt.FORBID_CONTENTS&&(Pt===Ut&&(Pt=Dd(Pt)),zr(Pt,nt.FORBID_CONTENTS,ze)),ct&&(Q["#text"]=!0),Y&&zr(Q,["html","head","body"]),Q.table&&(zr(Q,["tbody"]),delete De.tbody),nt.TRUSTED_TYPES_POLICY){if(typeof nt.TRUSTED_TYPES_POLICY.createHTML!="function")throw nx('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof nt.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw nx('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');k=nt.TRUSTED_TYPES_POLICY,C=k.createHTML("")}else k===void 0&&(k=zXe(m,s)),k!==null&&typeof C=="string"&&(C=k.createHTML(""));So&&So(nt),Ct=nt}},J=zr({},[...Dj,...Fj,...NXe]),xe=zr({},[...Lj,...IXe]),Fe=function(nt){let Vt=_(nt);(!Vt||!Vt.tagName)&&(Vt={namespaceURI:ge,tagName:"template"});const yn=i2(nt.tagName),ar=i2(Vt.tagName);return le[nt.namespaceURI]?nt.namespaceURI===be?Vt.namespaceURI===Ee?yn==="svg":Vt.namespaceURI===X?yn==="svg"&&(ar==="annotation-xml"||et[ar]):!!J[yn]:nt.namespaceURI===X?Vt.namespaceURI===Ee?yn==="math":Vt.namespaceURI===be?yn==="math"&&$[ar]:!!xe[yn]:nt.namespaceURI===Ee?Vt.namespaceURI===be&&!$[ar]||Vt.namespaceURI===X&&!et[ar]?!1:!xe[yn]&&(qe[yn]||!J[yn]):!!(tt==="application/xhtml+xml"&&le[nt.namespaceURI]):!1},He=function(nt){ex(t.removed,{element:nt});try{_(nt).removeChild(nt)}catch{v(nt)}},wt=function(nt,Vt){try{ex(t.removed,{attribute:Vt.getAttributeNode(nt),from:Vt})}catch{ex(t.removed,{attribute:null,from:Vt})}if(Vt.removeAttribute(nt),nt==="is")if(ue||oe)try{He(Vt)}catch{}else try{Vt.setAttribute(nt,"")}catch{}},Qt=function(nt){let Vt=null,yn=null;if(Me)nt="<remove></remove>"+nt;else{const ts=OV(nt,/^[\r\n\t ]+/);yn=ts&&ts[0]}tt==="application/xhtml+xml"&&ge===Ee&&(nt='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+nt+"</body></html>");const ar=k?k.createHTML(nt):nt;if(ge===Ee)try{Vt=new h().parseFromString(ar,tt)}catch{}if(!Vt||!Vt.documentElement){Vt=T.createDocument(ge,"template",null);try{Vt.documentElement.innerHTML=Ae?C:ar}catch{}}const Ns=Vt.body||Vt.documentElement;return nt&&yn&&Ns.insertBefore(n.createTextNode(yn),Ns.childNodes[0]||null),ge===Ee?I.call(Vt,Y?"html":"body")[0]:Y?Vt.documentElement:Ns},Dn=function(nt){return A.call(nt.ownerDocument||nt,nt,c.SHOW_ELEMENT|c.SHOW_COMMENT|c.SHOW_TEXT|c.SHOW_PROCESSING_INSTRUCTION|c.SHOW_CDATA_SECTION,null)},Zt=function(nt){return nt instanceof d&&(typeof nt.nodeName!="string"||typeof nt.textContent!="string"||typeof nt.removeChild!="function"||!(nt.attributes instanceof u)||typeof nt.removeAttribute!="function"||typeof nt.setAttribute!="function"||typeof nt.namespaceURI!="string"||typeof nt.insertBefore!="function"||typeof nt.hasChildNodes!="function")},rn=function(nt){return typeof o=="function"&&nt instanceof o};function fn(gn,nt,Vt){NC(gn,yn=>{yn.call(t,nt,Vt,Ct)})}const br=function(nt){let Vt=null;if(fn(L.beforeSanitizeElements,nt,null),Zt(nt))return He(nt),!0;const yn=ze(nt.nodeName);if(fn(L.uponSanitizeElement,nt,{tagName:yn,allowedTags:Q}),Pe&&nt.hasChildNodes()&&!rn(nt.firstElementChild)&&so(/<[/\w!]/g,nt.innerHTML)&&so(/<[/\w!]/g,nt.textContent)||nt.nodeType===sx.progressingInstruction||Pe&&nt.nodeType===sx.comment&&so(/<[/\w]/g,nt.data))return He(nt),!0;if(!Q[yn]||De[yn]){if(!De[yn]&&rs(yn)&&(me.tagNameCheck instanceof RegExp&&so(me.tagNameCheck,yn)||me.tagNameCheck instanceof Function&&me.tagNameCheck(yn)))return!1;if(ct&&!Pt[yn]){const ar=_(nt)||nt.parentNode,Ns=w(nt)||nt.childNodes;if(Ns&&ar){const ts=Ns.length;for(let zi=ts-1;zi>=0;--zi){const fi=b(Ns[zi],!0);fi.__removalCount=(nt.__removalCount||0)+1,ar.insertBefore(fi,x(nt))}}}return He(nt),!0}return nt instanceof l&&!Fe(nt)||(yn==="noscript"||yn==="noembed"||yn==="noframes")&&so(/<\/no(script|embed|frames)/i,nt.innerHTML)?(He(nt),!0):(We&&nt.nodeType===sx.text&&(Vt=nt.textContent,NC([D,H,O],ar=>{Vt=tx(Vt,ar," ")}),nt.textContent!==Vt&&(ex(t.removed,{element:nt.cloneNode()}),nt.textContent=Vt)),fn(L.afterSanitizeElements,nt,null),!1)},Mr=function(nt,Vt,yn){if(Ie&&(Vt==="id"||Vt==="name")&&(yn in n||yn in fe))return!1;if(!(_e&&!je[Vt]&&so(K,Vt))){if(!(Te&&so(U,Vt))){if(!re[Vt]||je[Vt]){if(!(rs(nt)&&(me.tagNameCheck instanceof RegExp&&so(me.tagNameCheck,nt)||me.tagNameCheck instanceof Function&&me.tagNameCheck(nt))&&(me.attributeNameCheck instanceof RegExp&&so(me.attributeNameCheck,Vt)||me.attributeNameCheck instanceof Function&&me.attributeNameCheck(Vt))||Vt==="is"&&me.allowCustomizedBuiltInElements&&(me.tagNameCheck instanceof RegExp&&so(me.tagNameCheck,yn)||me.tagNameCheck instanceof Function&&me.tagNameCheck(yn))))return!1}else if(!we[Vt]){if(!so(V,tx(yn,B,""))){if(!((Vt==="src"||Vt==="xlink:href"||Vt==="href")&&nt!=="script"&&EXe(yn,"data:")===0&&Ft[nt])){if(!(Ue&&!so(W,tx(yn,B,"")))){if(yn)return!1}}}}}}return!0},rs=function(nt){return nt!=="annotation-xml"&&OV(nt,ne)},ss=function(nt){fn(L.beforeSanitizeAttributes,nt,null);const{attributes:Vt}=nt;if(!Vt||Zt(nt))return;const yn={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:re,forceKeepAttr:void 0};let ar=Vt.length;for(;ar--;){const Ns=Vt[ar],{name:ts,namespaceURI:zi,value:fi}=Ns,Xa=ze(ts),ba=fi;let Gs=ts==="value"?ba:TXe(ba);if(yn.attrName=Xa,yn.attrValue=Gs,yn.keepAttr=!0,yn.forceKeepAttr=void 0,fn(L.uponSanitizeAttribute,nt,yn),Gs=yn.attrValue,Be&&(Xa==="id"||Xa==="name")&&(wt(ts,nt),Gs=Re+Gs),Pe&&so(/((--!?|])>)|<\/(style|title)/i,Gs)){wt(ts,nt);continue}if(yn.forceKeepAttr)continue;if(!yn.keepAttr){wt(ts,nt);continue}if(!Qe&&so(/\/>/i,Gs)){wt(ts,nt);continue}We&&NC([D,H,O],Al=>{Gs=tx(Gs,Al," ")});const el=ze(nt.nodeName);if(!Mr(el,Xa,Gs)){wt(ts,nt);continue}if(k&&typeof m=="object"&&typeof m.getAttributeType=="function"&&!zi)switch(m.getAttributeType(el,Xa)){case"TrustedHTML":{Gs=k.createHTML(Gs);break}case"TrustedScriptURL":{Gs=k.createScriptURL(Gs);break}}if(Gs!==ba)try{zi?nt.setAttributeNS(zi,ts,Gs):nt.setAttribute(ts,Gs),Zt(nt)?He(nt):PV(t.removed)}catch{wt(ts,nt)}}fn(L.afterSanitizeAttributes,nt,null)},kr=function gn(nt){let Vt=null;const yn=Dn(nt);for(fn(L.beforeSanitizeShadowDOM,nt,null);Vt=yn.nextNode();)fn(L.uponSanitizeShadowNode,Vt,null),br(Vt),ss(Vt),Vt.content instanceof i&&gn(Vt.content);fn(L.afterSanitizeShadowDOM,nt,null)};return t.sanitize=function(gn){let nt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Vt=null,yn=null,ar=null,Ns=null;if(Ae=!gn,Ae&&(gn="<!-->"),typeof gn!="string"&&!rn(gn))if(typeof gn.toString=="function"){if(gn=gn.toString(),typeof gn!="string")throw nx("dirty is not a string, aborting")}else throw nx("toString is not a function");if(!t.isSupported)return gn;if(ye||G(nt),t.removed=[],typeof gn=="string"&&(At=!1),At){if(gn.nodeName){const fi=ze(gn.nodeName);if(!Q[fi]||De[fi])throw nx("root node is forbidden and cannot be sanitized in-place")}}else if(gn instanceof o)Vt=Qt("<!---->"),yn=Vt.ownerDocument.importNode(gn,!0),yn.nodeType===sx.element&&yn.nodeName==="BODY"||yn.nodeName==="HTML"?Vt=yn:Vt.appendChild(yn);else{if(!ue&&!We&&!Y&&gn.indexOf("<")===-1)return k&&se?k.createHTML(gn):gn;if(Vt=Qt(gn),!Vt)return ue?null:se?C:""}Vt&&Me&&He(Vt.firstChild);const ts=Dn(At?gn:Vt);for(;ar=ts.nextNode();)br(ar),ss(ar),ar.content instanceof i&&kr(ar.content);if(At)return gn;if(ue){if(oe)for(Ns=N.call(Vt.ownerDocument);Vt.firstChild;)Ns.appendChild(Vt.firstChild);else Ns=Vt;return(re.shadowroot||re.shadowrootmode)&&(Ns=j.call(r,Ns,!0)),Ns}let zi=Y?Vt.outerHTML:Vt.innerHTML;return Y&&Q["!doctype"]&&Vt.ownerDocument&&Vt.ownerDocument.doctype&&Vt.ownerDocument.doctype.name&&so(aae,Vt.ownerDocument.doctype.name)&&(zi="<!DOCTYPE "+Vt.ownerDocument.doctype.name+`>
`+zi),We&&NC([D,H,O],fi=>{zi=tx(zi,fi," ")}),k&&se?k.createHTML(zi):zi},t.setConfig=function(){let gn=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};G(gn),ye=!0},t.clearConfig=function(){Ct=null,ye=!1},t.isValidAttribute=function(gn,nt,Vt){Ct||G({});const yn=ze(gn),ar=ze(nt);return Mr(yn,ar,Vt)},t.addHook=function(gn,nt){typeof nt=="function"&&ex(L[gn],nt)},t.removeHook=function(gn,nt){if(nt!==void 0){const Vt=CXe(L[gn],nt);return Vt===-1?void 0:kXe(L[gn],Vt,1)[0]}return PV(L[gn])},t.removeHooks=function(gn){L[gn]=[]},t.removeAllHooks=function(){L=zV()},t}var By=oae(),lae=Object.defineProperty,ie=(e,t)=>lae(e,"name",{value:t,configurable:!0}),UXe=(e,t)=>{for(var n in t)lae(e,n,{get:t[n],enumerable:!0})},Md={trace:0,debug:1,info:2,warn:3,error:4,fatal:5},qt={trace:ie((...e)=>{},"trace"),debug:ie((...e)=>{},"debug"),info:ie((...e)=>{},"info"),warn:ie((...e)=>{},"warn"),error:ie((...e)=>{},"error"),fatal:ie((...e)=>{},"fatal")},N6=ie(function(e="fatal"){let t=Md.fatal;typeof e=="string"?e.toLowerCase()in Md&&(t=Md[e]):typeof e=="number"&&(t=e),qt.trace=()=>{},qt.debug=()=>{},qt.info=()=>{},qt.warn=()=>{},qt.error=()=>{},qt.fatal=()=>{},t<=Md.fatal&&(qt.fatal=console.error?console.error.bind(console,ql("FATAL"),"color: orange"):console.log.bind(console,"\x1B[35m",ql("FATAL"))),t<=Md.error&&(qt.error=console.error?console.error.bind(console,ql("ERROR"),"color: orange"):console.log.bind(console,"\x1B[31m",ql("ERROR"))),t<=Md.warn&&(qt.warn=console.warn?console.warn.bind(console,ql("WARN"),"color: orange"):console.log.bind(console,"\x1B[33m",ql("WARN"))),t<=Md.info&&(qt.info=console.info?console.info.bind(console,ql("INFO"),"color: lightblue"):console.log.bind(console,"\x1B[34m",ql("INFO"))),t<=Md.debug&&(qt.debug=console.debug?console.debug.bind(console,ql("DEBUG"),"color: lightgreen"):console.log.bind(console,"\x1B[32m",ql("DEBUG"))),t<=Md.trace&&(qt.trace=console.debug?console.debug.bind(console,ql("TRACE"),"color: lightgreen"):console.log.bind(console,"\x1B[32m",ql("TRACE")))},"setLogLevel"),ql=ie(e=>`%c${hXe().format("ss.SSS")} : ${e} : `,"format"),cae=/^-{3}\s*[\n\r](.*?)[\n\r]-{3}\s*[\n\r]+/s,Jx=/%{2}{\s*(?:(\w+)\s*:|(\w+))\s*(?:(\w+)|((?:(?!}%{2}).|\r?\n)*))?\s*(?:}%{2})?/gi,qXe=/\s*%%.*\n/gm,ty,uae=(ty=class extends Error{constructor(t){super(t),this.name="UnknownDiagramError"}},ie(ty,"UnknownDiagramError"),ty),$y={},I6=ie(function(e,t){e=e.replace(cae,"").replace(Jx,"").replace(qXe,`
`);for(const[n,{detector:r}]of Object.entries($y))if(r(e,t))return n;throw new uae(`No diagram type detected matching given configuration for text: ${e}`)},"detectType"),dae=ie((...e)=>{for(const{id:t,detector:n,loader:r}of e)fae(t,n,r)},"registerLazyLoadedDiagrams"),fae=ie((e,t,n)=>{$y[e]&&qt.warn(`Detector with key ${e} already exists. Overwriting.`),$y[e]={detector:t,loader:n},qt.debug(`Detector with key ${e} added${n?" with loader":""}`)},"addDetector"),VXe=ie(e=>$y[e].loader,"getDiagramLoader"),t4=ie((e,t,{depth:n=2,clobber:r=!1}={})=>{const s={depth:n,clobber:r};return Array.isArray(t)&&!Array.isArray(e)?(t.forEach(i=>t4(e,i,s)),e):Array.isArray(t)&&Array.isArray(e)?(t.forEach(i=>{e.includes(i)||e.push(i)}),e):e===void 0||n<=0?e!=null&&typeof e=="object"&&typeof t=="object"?Object.assign(e,t):t:(t!==void 0&&typeof e=="object"&&typeof t=="object"&&Object.keys(t).forEach(i=>{typeof t[i]=="object"&&(e[i]===void 0||typeof e[i]=="object")?(e[i]===void 0&&(e[i]=Array.isArray(t[i])?[]:{}),e[i]=t4(e[i],t[i],{depth:n-1,clobber:r})):(r||typeof e[i]!="object"&&typeof t[i]!="object")&&(e[i]=t[i])}),e)},"assignWithDepth"),Ra=t4,lA="#ffffff",cA="#f2f2f2",ao=ie((e,t)=>t?xt(e,{s:-40,l:10}):xt(e,{s:-40,l:-10}),"mkBorder"),ny,WXe=(ny=class{constructor(){this.background="#f4f4f4",this.primaryColor="#fff4dd",this.noteBkgColor="#fff5ad",this.noteTextColor="#333",this.THEME_COLOR_LIMIT=12,this.fontFamily='"trebuchet ms", verdana, arial, sans-serif',this.fontSize="16px"}updateColors(){var n,r,s,i,a,o,l,c,u,d,h,m,y,b,v,x,w,_,k,C,T;if(this.primaryTextColor=this.primaryTextColor||(this.darkMode?"#eee":"#333"),this.secondaryColor=this.secondaryColor||xt(this.primaryColor,{h:-120}),this.tertiaryColor=this.tertiaryColor||xt(this.primaryColor,{h:180,l:5}),this.primaryBorderColor=this.primaryBorderColor||ao(this.primaryColor,this.darkMode),this.secondaryBorderColor=this.secondaryBorderColor||ao(this.secondaryColor,this.darkMode),this.tertiaryBorderColor=this.tertiaryBorderColor||ao(this.tertiaryColor,this.darkMode),this.noteBorderColor=this.noteBorderColor||ao(this.noteBkgColor,this.darkMode),this.noteBkgColor=this.noteBkgColor||"#fff5ad",this.noteTextColor=this.noteTextColor||"#333",this.secondaryTextColor=this.secondaryTextColor||dn(this.secondaryColor),this.tertiaryTextColor=this.tertiaryTextColor||dn(this.tertiaryColor),this.lineColor=this.lineColor||dn(this.background),this.arrowheadColor=this.arrowheadColor||dn(this.background),this.textColor=this.textColor||this.primaryTextColor,this.border2=this.border2||this.tertiaryBorderColor,this.nodeBkg=this.nodeBkg||this.primaryColor,this.mainBkg=this.mainBkg||this.primaryColor,this.nodeBorder=this.nodeBorder||this.primaryBorderColor,this.clusterBkg=this.clusterBkg||this.tertiaryColor,this.clusterBorder=this.clusterBorder||this.tertiaryBorderColor,this.defaultLinkColor=this.defaultLinkColor||this.lineColor,this.titleColor=this.titleColor||this.tertiaryTextColor,this.edgeLabelBackground=this.edgeLabelBackground||(this.darkMode?Wn(this.secondaryColor,30):this.secondaryColor),this.nodeTextColor=this.nodeTextColor||this.primaryTextColor,this.actorBorder=this.actorBorder||this.primaryBorderColor,this.actorBkg=this.actorBkg||this.mainBkg,this.actorTextColor=this.actorTextColor||this.primaryTextColor,this.actorLineColor=this.actorLineColor||this.actorBorder,this.labelBoxBkgColor=this.labelBoxBkgColor||this.actorBkg,this.signalColor=this.signalColor||this.textColor,this.signalTextColor=this.signalTextColor||this.textColor,this.labelBoxBorderColor=this.labelBoxBorderColor||this.actorBorder,this.labelTextColor=this.labelTextColor||this.actorTextColor,this.loopTextColor=this.loopTextColor||this.actorTextColor,this.activationBorderColor=this.activationBorderColor||Wn(this.secondaryColor,10),this.activationBkgColor=this.activationBkgColor||this.secondaryColor,this.sequenceNumberColor=this.sequenceNumberColor||dn(this.lineColor),this.sectionBkgColor=this.sectionBkgColor||this.tertiaryColor,this.altSectionBkgColor=this.altSectionBkgColor||"white",this.sectionBkgColor=this.sectionBkgColor||this.secondaryColor,this.sectionBkgColor2=this.sectionBkgColor2||this.primaryColor,this.excludeBkgColor=this.excludeBkgColor||"#eeeeee",this.taskBorderColor=this.taskBorderColor||this.primaryBorderColor,this.taskBkgColor=this.taskBkgColor||this.primaryColor,this.activeTaskBorderColor=this.activeTaskBorderColor||this.primaryColor,this.activeTaskBkgColor=this.activeTaskBkgColor||kn(this.primaryColor,23),this.gridColor=this.gridColor||"lightgrey",this.doneTaskBkgColor=this.doneTaskBkgColor||"lightgrey",this.doneTaskBorderColor=this.doneTaskBorderColor||"grey",this.critBorderColor=this.critBorderColor||"#ff8888",this.critBkgColor=this.critBkgColor||"red",this.todayLineColor=this.todayLineColor||"red",this.taskTextColor=this.taskTextColor||this.textColor,this.taskTextOutsideColor=this.taskTextOutsideColor||this.textColor,this.taskTextLightColor=this.taskTextLightColor||this.textColor,this.taskTextColor=this.taskTextColor||this.primaryTextColor,this.taskTextDarkColor=this.taskTextDarkColor||this.textColor,this.taskTextClickableColor=this.taskTextClickableColor||"#003163",this.personBorder=this.personBorder||this.primaryBorderColor,this.personBkg=this.personBkg||this.mainBkg,this.darkMode?(this.rowOdd=this.rowOdd||Wn(this.mainBkg,5)||"#ffffff",this.rowEven=this.rowEven||Wn(this.mainBkg,10)):(this.rowOdd=this.rowOdd||kn(this.mainBkg,75)||"#ffffff",this.rowEven=this.rowEven||kn(this.mainBkg,5)),this.transitionColor=this.transitionColor||this.lineColor,this.transitionLabelColor=this.transitionLabelColor||this.textColor,this.stateLabelColor=this.stateLabelColor||this.stateBkg||this.primaryTextColor,this.stateBkg=this.stateBkg||this.mainBkg,this.labelBackgroundColor=this.labelBackgroundColor||this.stateBkg,this.compositeBackground=this.compositeBackground||this.background||this.tertiaryColor,this.altBackground=this.altBackground||this.tertiaryColor,this.compositeTitleBackground=this.compositeTitleBackground||this.mainBkg,this.compositeBorder=this.compositeBorder||this.nodeBorder,this.innerEndBackground=this.nodeBorder,this.errorBkgColor=this.errorBkgColor||this.tertiaryColor,this.errorTextColor=this.errorTextColor||this.tertiaryTextColor,this.transitionColor=this.transitionColor||this.lineColor,this.specialStateColor=this.lineColor,this.cScale0=this.cScale0||this.primaryColor,this.cScale1=this.cScale1||this.secondaryColor,this.cScale2=this.cScale2||this.tertiaryColor,this.cScale3=this.cScale3||xt(this.primaryColor,{h:30}),this.cScale4=this.cScale4||xt(this.primaryColor,{h:60}),this.cScale5=this.cScale5||xt(this.primaryColor,{h:90}),this.cScale6=this.cScale6||xt(this.primaryColor,{h:120}),this.cScale7=this.cScale7||xt(this.primaryColor,{h:150}),this.cScale8=this.cScale8||xt(this.primaryColor,{h:210,l:150}),this.cScale9=this.cScale9||xt(this.primaryColor,{h:270}),this.cScale10=this.cScale10||xt(this.primaryColor,{h:300}),this.cScale11=this.cScale11||xt(this.primaryColor,{h:330}),this.darkMode)for(let A=0;A<this.THEME_COLOR_LIMIT;A++)this["cScale"+A]=Wn(this["cScale"+A],75);else for(let A=0;A<this.THEME_COLOR_LIMIT;A++)this["cScale"+A]=Wn(this["cScale"+A],25);for(let A=0;A<this.THEME_COLOR_LIMIT;A++)this["cScaleInv"+A]=this["cScaleInv"+A]||dn(this["cScale"+A]);for(let A=0;A<this.THEME_COLOR_LIMIT;A++)this.darkMode?this["cScalePeer"+A]=this["cScalePeer"+A]||kn(this["cScale"+A],10):this["cScalePeer"+A]=this["cScalePeer"+A]||Wn(this["cScale"+A],10);this.scaleLabelColor=this.scaleLabelColor||this.labelTextColor;for(let A=0;A<this.THEME_COLOR_LIMIT;A++)this["cScaleLabel"+A]=this["cScaleLabel"+A]||this.scaleLabelColor;const t=this.darkMode?-4:-1;for(let A=0;A<5;A++)this["surface"+A]=this["surface"+A]||xt(this.mainBkg,{h:180,s:-15,l:t*(5+A*3)}),this["surfacePeer"+A]=this["surfacePeer"+A]||xt(this.mainBkg,{h:180,s:-15,l:t*(8+A*3)});this.classText=this.classText||this.textColor,this.fillType0=this.fillType0||this.primaryColor,this.fillType1=this.fillType1||this.secondaryColor,this.fillType2=this.fillType2||xt(this.primaryColor,{h:64}),this.fillType3=this.fillType3||xt(this.secondaryColor,{h:64}),this.fillType4=this.fillType4||xt(this.primaryColor,{h:-64}),this.fillType5=this.fillType5||xt(this.secondaryColor,{h:-64}),this.fillType6=this.fillType6||xt(this.primaryColor,{h:128}),this.fillType7=this.fillType7||xt(this.secondaryColor,{h:128}),this.pie1=this.pie1||this.primaryColor,this.pie2=this.pie2||this.secondaryColor,this.pie3=this.pie3||this.tertiaryColor,this.pie4=this.pie4||xt(this.primaryColor,{l:-10}),this.pie5=this.pie5||xt(this.secondaryColor,{l:-10}),this.pie6=this.pie6||xt(this.tertiaryColor,{l:-10}),this.pie7=this.pie7||xt(this.primaryColor,{h:60,l:-10}),this.pie8=this.pie8||xt(this.primaryColor,{h:-60,l:-10}),this.pie9=this.pie9||xt(this.primaryColor,{h:120,l:0}),this.pie10=this.pie10||xt(this.primaryColor,{h:60,l:-20}),this.pie11=this.pie11||xt(this.primaryColor,{h:-60,l:-20}),this.pie12=this.pie12||xt(this.primaryColor,{h:120,l:-10}),this.pieTitleTextSize=this.pieTitleTextSize||"25px",this.pieTitleTextColor=this.pieTitleTextColor||this.taskTextDarkColor,this.pieSectionTextSize=this.pieSectionTextSize||"17px",this.pieSectionTextColor=this.pieSectionTextColor||this.textColor,this.pieLegendTextSize=this.pieLegendTextSize||"17px",this.pieLegendTextColor=this.pieLegendTextColor||this.taskTextDarkColor,this.pieStrokeColor=this.pieStrokeColor||"black",this.pieStrokeWidth=this.pieStrokeWidth||"2px",this.pieOuterStrokeWidth=this.pieOuterStrokeWidth||"2px",this.pieOuterStrokeColor=this.pieOuterStrokeColor||"black",this.pieOpacity=this.pieOpacity||"0.7",this.radar={axisColor:((n=this.radar)==null?void 0:n.axisColor)||this.lineColor,axisStrokeWidth:((r=this.radar)==null?void 0:r.axisStrokeWidth)||2,axisLabelFontSize:((s=this.radar)==null?void 0:s.axisLabelFontSize)||12,curveOpacity:((i=this.radar)==null?void 0:i.curveOpacity)||.5,curveStrokeWidth:((a=this.radar)==null?void 0:a.curveStrokeWidth)||2,graticuleColor:((o=this.radar)==null?void 0:o.graticuleColor)||"#DEDEDE",graticuleStrokeWidth:((l=this.radar)==null?void 0:l.graticuleStrokeWidth)||1,graticuleOpacity:((c=this.radar)==null?void 0:c.graticuleOpacity)||.3,legendBoxSize:((u=this.radar)==null?void 0:u.legendBoxSize)||12,legendFontSize:((d=this.radar)==null?void 0:d.legendFontSize)||12},this.archEdgeColor=this.archEdgeColor||"#777",this.archEdgeArrowColor=this.archEdgeArrowColor||"#777",this.archEdgeWidth=this.archEdgeWidth||"3",this.archGroupBorderColor=this.archGroupBorderColor||"#000",this.archGroupBorderWidth=this.archGroupBorderWidth||"2px",this.quadrant1Fill=this.quadrant1Fill||this.primaryColor,this.quadrant2Fill=this.quadrant2Fill||xt(this.primaryColor,{r:5,g:5,b:5}),this.quadrant3Fill=this.quadrant3Fill||xt(this.primaryColor,{r:10,g:10,b:10}),this.quadrant4Fill=this.quadrant4Fill||xt(this.primaryColor,{r:15,g:15,b:15}),this.quadrant1TextFill=this.quadrant1TextFill||this.primaryTextColor,this.quadrant2TextFill=this.quadrant2TextFill||xt(this.primaryTextColor,{r:-5,g:-5,b:-5}),this.quadrant3TextFill=this.quadrant3TextFill||xt(this.primaryTextColor,{r:-10,g:-10,b:-10}),this.quadrant4TextFill=this.quadrant4TextFill||xt(this.primaryTextColor,{r:-15,g:-15,b:-15}),this.quadrantPointFill=this.quadrantPointFill||SS(this.quadrant1Fill)?kn(this.quadrant1Fill):Wn(this.quadrant1Fill),this.quadrantPointTextFill=this.quadrantPointTextFill||this.primaryTextColor,this.quadrantXAxisTextFill=this.quadrantXAxisTextFill||this.primaryTextColor,this.quadrantYAxisTextFill=this.quadrantYAxisTextFill||this.primaryTextColor,this.quadrantInternalBorderStrokeFill=this.quadrantInternalBorderStrokeFill||this.primaryBorderColor,this.quadrantExternalBorderStrokeFill=this.quadrantExternalBorderStrokeFill||this.primaryBorderColor,this.quadrantTitleFill=this.quadrantTitleFill||this.primaryTextColor,this.xyChart={backgroundColor:((h=this.xyChart)==null?void 0:h.backgroundColor)||this.background,titleColor:((m=this.xyChart)==null?void 0:m.titleColor)||this.primaryTextColor,xAxisTitleColor:((y=this.xyChart)==null?void 0:y.xAxisTitleColor)||this.primaryTextColor,xAxisLabelColor:((b=this.xyChart)==null?void 0:b.xAxisLabelColor)||this.primaryTextColor,xAxisTickColor:((v=this.xyChart)==null?void 0:v.xAxisTickColor)||this.primaryTextColor,xAxisLineColor:((x=this.xyChart)==null?void 0:x.xAxisLineColor)||this.primaryTextColor,yAxisTitleColor:((w=this.xyChart)==null?void 0:w.yAxisTitleColor)||this.primaryTextColor,yAxisLabelColor:((_=this.xyChart)==null?void 0:_.yAxisLabelColor)||this.primaryTextColor,yAxisTickColor:((k=this.xyChart)==null?void 0:k.yAxisTickColor)||this.primaryTextColor,yAxisLineColor:((C=this.xyChart)==null?void 0:C.yAxisLineColor)||this.primaryTextColor,plotColorPalette:((T=this.xyChart)==null?void 0:T.plotColorPalette)||"#FFF4DD,#FFD8B1,#FFA07A,#ECEFF1,#D6DBDF,#C3E0A8,#FFB6A4,#FFD74D,#738FA7,#FFFFF0"},this.requirementBackground=this.requirementBackground||this.primaryColor,this.requirementBorderColor=this.requirementBorderColor||this.primaryBorderColor,this.requirementBorderSize=this.requirementBorderSize||"1",this.requirementTextColor=this.requirementTextColor||this.primaryTextColor,this.relationColor=this.relationColor||this.lineColor,this.relationLabelBackground=this.relationLabelBackground||(this.darkMode?Wn(this.secondaryColor,30):this.secondaryColor),this.relationLabelColor=this.relationLabelColor||this.actorTextColor,this.git0=this.git0||this.primaryColor,this.git1=this.git1||this.secondaryColor,this.git2=this.git2||this.tertiaryColor,this.git3=this.git3||xt(this.primaryColor,{h:-30}),this.git4=this.git4||xt(this.primaryColor,{h:-60}),this.git5=this.git5||xt(this.primaryColor,{h:-90}),this.git6=this.git6||xt(this.primaryColor,{h:60}),this.git7=this.git7||xt(this.primaryColor,{h:120}),this.darkMode?(this.git0=kn(this.git0,25),this.git1=kn(this.git1,25),this.git2=kn(this.git2,25),this.git3=kn(this.git3,25),this.git4=kn(this.git4,25),this.git5=kn(this.git5,25),this.git6=kn(this.git6,25),this.git7=kn(this.git7,25)):(this.git0=Wn(this.git0,25),this.git1=Wn(this.git1,25),this.git2=Wn(this.git2,25),this.git3=Wn(this.git3,25),this.git4=Wn(this.git4,25),this.git5=Wn(this.git5,25),this.git6=Wn(this.git6,25),this.git7=Wn(this.git7,25)),this.gitInv0=this.gitInv0||dn(this.git0),this.gitInv1=this.gitInv1||dn(this.git1),this.gitInv2=this.gitInv2||dn(this.git2),this.gitInv3=this.gitInv3||dn(this.git3),this.gitInv4=this.gitInv4||dn(this.git4),this.gitInv5=this.gitInv5||dn(this.git5),this.gitInv6=this.gitInv6||dn(this.git6),this.gitInv7=this.gitInv7||dn(this.git7),this.branchLabelColor=this.branchLabelColor||(this.darkMode?"black":this.labelTextColor),this.gitBranchLabel0=this.gitBranchLabel0||this.branchLabelColor,this.gitBranchLabel1=this.gitBranchLabel1||this.branchLabelColor,this.gitBranchLabel2=this.gitBranchLabel2||this.branchLabelColor,this.gitBranchLabel3=this.gitBranchLabel3||this.branchLabelColor,this.gitBranchLabel4=this.gitBranchLabel4||this.branchLabelColor,this.gitBranchLabel5=this.gitBranchLabel5||this.branchLabelColor,this.gitBranchLabel6=this.gitBranchLabel6||this.branchLabelColor,this.gitBranchLabel7=this.gitBranchLabel7||this.branchLabelColor,this.tagLabelColor=this.tagLabelColor||this.primaryTextColor,this.tagLabelBackground=this.tagLabelBackground||this.primaryColor,this.tagLabelBorder=this.tagBorder||this.primaryBorderColor,this.tagLabelFontSize=this.tagLabelFontSize||"10px",this.commitLabelColor=this.commitLabelColor||this.secondaryTextColor,this.commitLabelBackground=this.commitLabelBackground||this.secondaryColor,this.commitLabelFontSize=this.commitLabelFontSize||"10px",this.attributeBackgroundColorOdd=this.attributeBackgroundColorOdd||lA,this.attributeBackgroundColorEven=this.attributeBackgroundColorEven||cA}calculate(t){if(typeof t!="object"){this.updateColors();return}const n=Object.keys(t);n.forEach(r=>{this[r]=t[r]}),this.updateColors(),n.forEach(r=>{this[r]=t[r]})}},ie(ny,"Theme"),ny),HXe=ie(e=>{const t=new WXe;return t.calculate(e),t},"getThemeVariables"),ry,GXe=(ry=class{constructor(){this.background="#333",this.primaryColor="#1f2020",this.secondaryColor=kn(this.primaryColor,16),this.tertiaryColor=xt(this.primaryColor,{h:-160}),this.primaryBorderColor=dn(this.background),this.secondaryBorderColor=ao(this.secondaryColor,this.darkMode),this.tertiaryBorderColor=ao(this.tertiaryColor,this.darkMode),this.primaryTextColor=dn(this.primaryColor),this.secondaryTextColor=dn(this.secondaryColor),this.tertiaryTextColor=dn(this.tertiaryColor),this.lineColor=dn(this.background),this.textColor=dn(this.background),this.mainBkg="#1f2020",this.secondBkg="calculated",this.mainContrastColor="lightgrey",this.darkTextColor=kn(dn("#323D47"),10),this.lineColor="calculated",this.border1="#ccc",this.border2=Xx(255,255,255,.25),this.arrowheadColor="calculated",this.fontFamily='"trebuchet ms", verdana, arial, sans-serif',this.fontSize="16px",this.labelBackground="#181818",this.textColor="#ccc",this.THEME_COLOR_LIMIT=12,this.nodeBkg="calculated",this.nodeBorder="calculated",this.clusterBkg="calculated",this.clusterBorder="calculated",this.defaultLinkColor="calculated",this.titleColor="#F9FFFE",this.edgeLabelBackground="calculated",this.actorBorder="calculated",this.actorBkg="calculated",this.actorTextColor="calculated",this.actorLineColor="calculated",this.signalColor="calculated",this.signalTextColor="calculated",this.labelBoxBkgColor="calculated",this.labelBoxBorderColor="calculated",this.labelTextColor="calculated",this.loopTextColor="calculated",this.noteBorderColor="calculated",this.noteBkgColor="#fff5ad",this.noteTextColor="calculated",this.activationBorderColor="calculated",this.activationBkgColor="calculated",this.sequenceNumberColor="black",this.sectionBkgColor=Wn("#EAE8D9",30),this.altSectionBkgColor="calculated",this.sectionBkgColor2="#EAE8D9",this.excludeBkgColor=Wn(this.sectionBkgColor,10),this.taskBorderColor=Xx(255,255,255,70),this.taskBkgColor="calculated",this.taskTextColor="calculated",this.taskTextLightColor="calculated",this.taskTextOutsideColor="calculated",this.taskTextClickableColor="#003163",this.activeTaskBorderColor=Xx(255,255,255,50),this.activeTaskBkgColor="#81B1DB",this.gridColor="calculated",this.doneTaskBkgColor="calculated",this.doneTaskBorderColor="grey",this.critBorderColor="#E83737",this.critBkgColor="#E83737",this.taskTextDarkColor="calculated",this.todayLineColor="#DB5757",this.personBorder=this.primaryBorderColor,this.personBkg=this.mainBkg,this.archEdgeColor="calculated",this.archEdgeArrowColor="calculated",this.archEdgeWidth="3",this.archGroupBorderColor=this.primaryBorderColor,this.archGroupBorderWidth="2px",this.rowOdd=this.rowOdd||kn(this.mainBkg,5)||"#ffffff",this.rowEven=this.rowEven||Wn(this.mainBkg,10),this.labelColor="calculated",this.errorBkgColor="#a44141",this.errorTextColor="#ddd"}updateColors(){var t,n,r,s,i,a,o,l,c,u,d,h,m,y,b,v,x,w,_,k,C;this.secondBkg=kn(this.mainBkg,16),this.lineColor=this.mainContrastColor,this.arrowheadColor=this.mainContrastColor,this.nodeBkg=this.mainBkg,this.nodeBorder=this.border1,this.clusterBkg=this.secondBkg,this.clusterBorder=this.border2,this.defaultLinkColor=this.lineColor,this.edgeLabelBackground=kn(this.labelBackground,25),this.actorBorder=this.border1,this.actorBkg=this.mainBkg,this.actorTextColor=this.mainContrastColor,this.actorLineColor=this.actorBorder,this.signalColor=this.mainContrastColor,this.signalTextColor=this.mainContrastColor,this.labelBoxBkgColor=this.actorBkg,this.labelBoxBorderColor=this.actorBorder,this.labelTextColor=this.mainContrastColor,this.loopTextColor=this.mainContrastColor,this.noteBorderColor=this.secondaryBorderColor,this.noteBkgColor=this.secondBkg,this.noteTextColor=this.secondaryTextColor,this.activationBorderColor=this.border1,this.activationBkgColor=this.secondBkg,this.altSectionBkgColor=this.background,this.taskBkgColor=kn(this.mainBkg,23),this.taskTextColor=this.darkTextColor,this.taskTextLightColor=this.mainContrastColor,this.taskTextOutsideColor=this.taskTextLightColor,this.gridColor=this.mainContrastColor,this.doneTaskBkgColor=this.mainContrastColor,this.taskTextDarkColor=this.darkTextColor,this.archEdgeColor=this.lineColor,this.archEdgeArrowColor=this.lineColor,this.transitionColor=this.transitionColor||this.lineColor,this.transitionLabelColor=this.transitionLabelColor||this.textColor,this.stateLabelColor=this.stateLabelColor||this.stateBkg||this.primaryTextColor,this.stateBkg=this.stateBkg||this.mainBkg,this.labelBackgroundColor=this.labelBackgroundColor||this.stateBkg,this.compositeBackground=this.compositeBackground||this.background||this.tertiaryColor,this.altBackground=this.altBackground||"#555",this.compositeTitleBackground=this.compositeTitleBackground||this.mainBkg,this.compositeBorder=this.compositeBorder||this.nodeBorder,this.innerEndBackground=this.primaryBorderColor,this.specialStateColor="#f4f4f4",this.errorBkgColor=this.errorBkgColor||this.tertiaryColor,this.errorTextColor=this.errorTextColor||this.tertiaryTextColor,this.fillType0=this.primaryColor,this.fillType1=this.secondaryColor,this.fillType2=xt(this.primaryColor,{h:64}),this.fillType3=xt(this.secondaryColor,{h:64}),this.fillType4=xt(this.primaryColor,{h:-64}),this.fillType5=xt(this.secondaryColor,{h:-64}),this.fillType6=xt(this.primaryColor,{h:128}),this.fillType7=xt(this.secondaryColor,{h:128}),this.cScale1=this.cScale1||"#0b0000",this.cScale2=this.cScale2||"#4d1037",this.cScale3=this.cScale3||"#3f5258",this.cScale4=this.cScale4||"#4f2f1b",this.cScale5=this.cScale5||"#6e0a0a",this.cScale6=this.cScale6||"#3b0048",this.cScale7=this.cScale7||"#995a01",this.cScale8=this.cScale8||"#154706",this.cScale9=this.cScale9||"#161722",this.cScale10=this.cScale10||"#00296f",this.cScale11=this.cScale11||"#01629c",this.cScale12=this.cScale12||"#010029",this.cScale0=this.cScale0||this.primaryColor,this.cScale1=this.cScale1||this.secondaryColor,this.cScale2=this.cScale2||this.tertiaryColor,this.cScale3=this.cScale3||xt(this.primaryColor,{h:30}),this.cScale4=this.cScale4||xt(this.primaryColor,{h:60}),this.cScale5=this.cScale5||xt(this.primaryColor,{h:90}),this.cScale6=this.cScale6||xt(this.primaryColor,{h:120}),this.cScale7=this.cScale7||xt(this.primaryColor,{h:150}),this.cScale8=this.cScale8||xt(this.primaryColor,{h:210}),this.cScale9=this.cScale9||xt(this.primaryColor,{h:270}),this.cScale10=this.cScale10||xt(this.primaryColor,{h:300}),this.cScale11=this.cScale11||xt(this.primaryColor,{h:330});for(let T=0;T<this.THEME_COLOR_LIMIT;T++)this["cScaleInv"+T]=this["cScaleInv"+T]||dn(this["cScale"+T]);for(let T=0;T<this.THEME_COLOR_LIMIT;T++)this["cScalePeer"+T]=this["cScalePeer"+T]||kn(this["cScale"+T],10);for(let T=0;T<5;T++)this["surface"+T]=this["surface"+T]||xt(this.mainBkg,{h:30,s:-30,l:-(-10+T*4)}),this["surfacePeer"+T]=this["surfacePeer"+T]||xt(this.mainBkg,{h:30,s:-30,l:-(-7+T*4)});this.scaleLabelColor=this.scaleLabelColor||(this.darkMode?"black":this.labelTextColor);for(let T=0;T<this.THEME_COLOR_LIMIT;T++)this["cScaleLabel"+T]=this["cScaleLabel"+T]||this.scaleLabelColor;for(let T=0;T<this.THEME_COLOR_LIMIT;T++)this["pie"+T]=this["cScale"+T];this.pieTitleTextSize=this.pieTitleTextSize||"25px",this.pieTitleTextColor=this.pieTitleTextColor||this.taskTextDarkColor,this.pieSectionTextSize=this.pieSectionTextSize||"17px",this.pieSectionTextColor=this.pieSectionTextColor||this.textColor,this.pieLegendTextSize=this.pieLegendTextSize||"17px",this.pieLegendTextColor=this.pieLegendTextColor||this.taskTextDarkColor,this.pieStrokeColor=this.pieStrokeColor||"black",this.pieStrokeWidth=this.pieStrokeWidth||"2px",this.pieOuterStrokeWidth=this.pieOuterStrokeWidth||"2px",this.pieOuterStrokeColor=this.pieOuterStrokeColor||"black",this.pieOpacity=this.pieOpacity||"0.7",this.quadrant1Fill=this.quadrant1Fill||this.primaryColor,this.quadrant2Fill=this.quadrant2Fill||xt(this.primaryColor,{r:5,g:5,b:5}),this.quadrant3Fill=this.quadrant3Fill||xt(this.primaryColor,{r:10,g:10,b:10}),this.quadrant4Fill=this.quadrant4Fill||xt(this.primaryColor,{r:15,g:15,b:15}),this.quadrant1TextFill=this.quadrant1TextFill||this.primaryTextColor,this.quadrant2TextFill=this.quadrant2TextFill||xt(this.primaryTextColor,{r:-5,g:-5,b:-5}),this.quadrant3TextFill=this.quadrant3TextFill||xt(this.primaryTextColor,{r:-10,g:-10,b:-10}),this.quadrant4TextFill=this.quadrant4TextFill||xt(this.primaryTextColor,{r:-15,g:-15,b:-15}),this.quadrantPointFill=this.quadrantPointFill||SS(this.quadrant1Fill)?kn(this.quadrant1Fill):Wn(this.quadrant1Fill),this.quadrantPointTextFill=this.quadrantPointTextFill||this.primaryTextColor,this.quadrantXAxisTextFill=this.quadrantXAxisTextFill||this.primaryTextColor,this.quadrantYAxisTextFill=this.quadrantYAxisTextFill||this.primaryTextColor,this.quadrantInternalBorderStrokeFill=this.quadrantInternalBorderStrokeFill||this.primaryBorderColor,this.quadrantExternalBorderStrokeFill=this.quadrantExternalBorderStrokeFill||this.primaryBorderColor,this.quadrantTitleFill=this.quadrantTitleFill||this.primaryTextColor,this.xyChart={backgroundColor:((t=this.xyChart)==null?void 0:t.backgroundColor)||this.background,titleColor:((n=this.xyChart)==null?void 0:n.titleColor)||this.primaryTextColor,xAxisTitleColor:((r=this.xyChart)==null?void 0:r.xAxisTitleColor)||this.primaryTextColor,xAxisLabelColor:((s=this.xyChart)==null?void 0:s.xAxisLabelColor)||this.primaryTextColor,xAxisTickColor:((i=this.xyChart)==null?void 0:i.xAxisTickColor)||this.primaryTextColor,xAxisLineColor:((a=this.xyChart)==null?void 0:a.xAxisLineColor)||this.primaryTextColor,yAxisTitleColor:((o=this.xyChart)==null?void 0:o.yAxisTitleColor)||this.primaryTextColor,yAxisLabelColor:((l=this.xyChart)==null?void 0:l.yAxisLabelColor)||this.primaryTextColor,yAxisTickColor:((c=this.xyChart)==null?void 0:c.yAxisTickColor)||this.primaryTextColor,yAxisLineColor:((u=this.xyChart)==null?void 0:u.yAxisLineColor)||this.primaryTextColor,plotColorPalette:((d=this.xyChart)==null?void 0:d.plotColorPalette)||"#3498db,#2ecc71,#e74c3c,#f1c40f,#bdc3c7,#ffffff,#34495e,#9b59b6,#1abc9c,#e67e22"},this.packet={startByteColor:this.primaryTextColor,endByteColor:this.primaryTextColor,labelColor:this.primaryTextColor,titleColor:this.primaryTextColor,blockStrokeColor:this.primaryTextColor,blockFillColor:this.background},this.radar={axisColor:((h=this.radar)==null?void 0:h.axisColor)||this.lineColor,axisStrokeWidth:((m=this.radar)==null?void 0:m.axisStrokeWidth)||2,axisLabelFontSize:((y=this.radar)==null?void 0:y.axisLabelFontSize)||12,curveOpacity:((b=this.radar)==null?void 0:b.curveOpacity)||.5,curveStrokeWidth:((v=this.radar)==null?void 0:v.curveStrokeWidth)||2,graticuleColor:((x=this.radar)==null?void 0:x.graticuleColor)||"#DEDEDE",graticuleStrokeWidth:((w=this.radar)==null?void 0:w.graticuleStrokeWidth)||1,graticuleOpacity:((_=this.radar)==null?void 0:_.graticuleOpacity)||.3,legendBoxSize:((k=this.radar)==null?void 0:k.legendBoxSize)||12,legendFontSize:((C=this.radar)==null?void 0:C.legendFontSize)||12},this.classText=this.primaryTextColor,this.requirementBackground=this.requirementBackground||this.primaryColor,this.requirementBorderColor=this.requirementBorderColor||this.primaryBorderColor,this.requirementBorderSize=this.requirementBorderSize||"1",this.requirementTextColor=this.requirementTextColor||this.primaryTextColor,this.relationColor=this.relationColor||this.lineColor,this.relationLabelBackground=this.relationLabelBackground||(this.darkMode?Wn(this.secondaryColor,30):this.secondaryColor),this.relationLabelColor=this.relationLabelColor||this.actorTextColor,this.git0=kn(this.secondaryColor,20),this.git1=kn(this.pie2||this.secondaryColor,20),this.git2=kn(this.pie3||this.tertiaryColor,20),this.git3=kn(this.pie4||xt(this.primaryColor,{h:-30}),20),this.git4=kn(this.pie5||xt(this.primaryColor,{h:-60}),20),this.git5=kn(this.pie6||xt(this.primaryColor,{h:-90}),10),this.git6=kn(this.pie7||xt(this.primaryColor,{h:60}),10),this.git7=kn(this.pie8||xt(this.primaryColor,{h:120}),20),this.gitInv0=this.gitInv0||dn(this.git0),this.gitInv1=this.gitInv1||dn(this.git1),this.gitInv2=this.gitInv2||dn(this.git2),this.gitInv3=this.gitInv3||dn(this.git3),this.gitInv4=this.gitInv4||dn(this.git4),this.gitInv5=this.gitInv5||dn(this.git5),this.gitInv6=this.gitInv6||dn(this.git6),this.gitInv7=this.gitInv7||dn(this.git7),this.gitBranchLabel0=this.gitBranchLabel0||dn(this.labelTextColor),this.gitBranchLabel1=this.gitBranchLabel1||this.labelTextColor,this.gitBranchLabel2=this.gitBranchLabel2||this.labelTextColor,this.gitBranchLabel3=this.gitBranchLabel3||dn(this.labelTextColor),this.gitBranchLabel4=this.gitBranchLabel4||this.labelTextColor,this.gitBranchLabel5=this.gitBranchLabel5||this.labelTextColor,this.gitBranchLabel6=this.gitBranchLabel6||this.labelTextColor,this.gitBranchLabel7=this.gitBranchLabel7||this.labelTextColor,this.tagLabelColor=this.tagLabelColor||this.primaryTextColor,this.tagLabelBackground=this.tagLabelBackground||this.primaryColor,this.tagLabelBorder=this.tagBorder||this.primaryBorderColor,this.tagLabelFontSize=this.tagLabelFontSize||"10px",this.commitLabelColor=this.commitLabelColor||this.secondaryTextColor,this.commitLabelBackground=this.commitLabelBackground||this.secondaryColor,this.commitLabelFontSize=this.commitLabelFontSize||"10px",this.attributeBackgroundColorOdd=this.attributeBackgroundColorOdd||kn(this.background,12),this.attributeBackgroundColorEven=this.attributeBackgroundColorEven||kn(this.background,2),this.nodeBorder=this.nodeBorder||"#999"}calculate(t){if(typeof t!="object"){this.updateColors();return}const n=Object.keys(t);n.forEach(r=>{this[r]=t[r]}),this.updateColors(),n.forEach(r=>{this[r]=t[r]})}},ie(ry,"Theme"),ry),KXe=ie(e=>{const t=new GXe;return t.calculate(e),t},"getThemeVariables"),sy,YXe=(sy=class{constructor(){this.background="#f4f4f4",this.primaryColor="#ECECFF",this.secondaryColor=xt(this.primaryColor,{h:120}),this.secondaryColor="#ffffde",this.tertiaryColor=xt(this.primaryColor,{h:-160}),this.primaryBorderColor=ao(this.primaryColor,this.darkMode),this.secondaryBorderColor=ao(this.secondaryColor,this.darkMode),this.tertiaryBorderColor=ao(this.tertiaryColor,this.darkMode),this.primaryTextColor=dn(this.primaryColor),this.secondaryTextColor=dn(this.secondaryColor),this.tertiaryTextColor=dn(this.tertiaryColor),this.lineColor=dn(this.background),this.textColor=dn(this.background),this.background="white",this.mainBkg="#ECECFF",this.secondBkg="#ffffde",this.lineColor="#333333",this.border1="#9370DB",this.border2="#aaaa33",this.arrowheadColor="#333333",this.fontFamily='"trebuchet ms", verdana, arial, sans-serif',this.fontSize="16px",this.labelBackground="rgba(232,232,232, 0.8)",this.textColor="#333",this.THEME_COLOR_LIMIT=12,this.nodeBkg="calculated",this.nodeBorder="calculated",this.clusterBkg="calculated",this.clusterBorder="calculated",this.defaultLinkColor="calculated",this.titleColor="calculated",this.edgeLabelBackground="calculated",this.actorBorder="calculated",this.actorBkg="calculated",this.actorTextColor="black",this.actorLineColor="calculated",this.signalColor="calculated",this.signalTextColor="calculated",this.labelBoxBkgColor="calculated",this.labelBoxBorderColor="calculated",this.labelTextColor="calculated",this.loopTextColor="calculated",this.noteBorderColor="calculated",this.noteBkgColor="#fff5ad",this.noteTextColor="calculated",this.activationBorderColor="#666",this.activationBkgColor="#f4f4f4",this.sequenceNumberColor="white",this.sectionBkgColor="calculated",this.altSectionBkgColor="calculated",this.sectionBkgColor2="calculated",this.excludeBkgColor="#eeeeee",this.taskBorderColor="calculated",this.taskBkgColor="calculated",this.taskTextLightColor="calculated",this.taskTextColor=this.taskTextLightColor,this.taskTextDarkColor="calculated",this.taskTextOutsideColor=this.taskTextDarkColor,this.taskTextClickableColor="calculated",this.activeTaskBorderColor="calculated",this.activeTaskBkgColor="calculated",this.gridColor="calculated",this.doneTaskBkgColor="calculated",this.doneTaskBorderColor="calculated",this.critBorderColor="calculated",this.critBkgColor="calculated",this.todayLineColor="calculated",this.sectionBkgColor=Xx(102,102,255,.49),this.altSectionBkgColor="white",this.sectionBkgColor2="#fff400",this.taskBorderColor="#534fbc",this.taskBkgColor="#8a90dd",this.taskTextLightColor="white",this.taskTextColor="calculated",this.taskTextDarkColor="black",this.taskTextOutsideColor="calculated",this.taskTextClickableColor="#003163",this.activeTaskBorderColor="#534fbc",this.activeTaskBkgColor="#bfc7ff",this.gridColor="lightgrey",this.doneTaskBkgColor="lightgrey",this.doneTaskBorderColor="grey",this.critBorderColor="#ff8888",this.critBkgColor="red",this.todayLineColor="red",this.personBorder=this.primaryBorderColor,this.personBkg=this.mainBkg,this.archEdgeColor="calculated",this.archEdgeArrowColor="calculated",this.archEdgeWidth="3",this.archGroupBorderColor=this.primaryBorderColor,this.archGroupBorderWidth="2px",this.rowOdd="calculated",this.rowEven="calculated",this.labelColor="black",this.errorBkgColor="#552222",this.errorTextColor="#552222",this.updateColors()}updateColors(){var t,n,r,s,i,a,o,l,c,u,d,h,m,y,b,v,x,w,_,k,C;this.cScale0=this.cScale0||this.primaryColor,this.cScale1=this.cScale1||this.secondaryColor,this.cScale2=this.cScale2||this.tertiaryColor,this.cScale3=this.cScale3||xt(this.primaryColor,{h:30}),this.cScale4=this.cScale4||xt(this.primaryColor,{h:60}),this.cScale5=this.cScale5||xt(this.primaryColor,{h:90}),this.cScale6=this.cScale6||xt(this.primaryColor,{h:120}),this.cScale7=this.cScale7||xt(this.primaryColor,{h:150}),this.cScale8=this.cScale8||xt(this.primaryColor,{h:210}),this.cScale9=this.cScale9||xt(this.primaryColor,{h:270}),this.cScale10=this.cScale10||xt(this.primaryColor,{h:300}),this.cScale11=this.cScale11||xt(this.primaryColor,{h:330}),this.cScalePeer1=this.cScalePeer1||Wn(this.secondaryColor,45),this.cScalePeer2=this.cScalePeer2||Wn(this.tertiaryColor,40);for(let T=0;T<this.THEME_COLOR_LIMIT;T++)this["cScale"+T]=Wn(this["cScale"+T],10),this["cScalePeer"+T]=this["cScalePeer"+T]||Wn(this["cScale"+T],25);for(let T=0;T<this.THEME_COLOR_LIMIT;T++)this["cScaleInv"+T]=this["cScaleInv"+T]||xt(this["cScale"+T],{h:180});for(let T=0;T<5;T++)this["surface"+T]=this["surface"+T]||xt(this.mainBkg,{h:30,l:-(5+T*5)}),this["surfacePeer"+T]=this["surfacePeer"+T]||xt(this.mainBkg,{h:30,l:-(7+T*5)});if(this.scaleLabelColor=this.scaleLabelColor!=="calculated"&&this.scaleLabelColor?this.scaleLabelColor:this.labelTextColor,this.labelTextColor!=="calculated"){this.cScaleLabel0=this.cScaleLabel0||dn(this.labelTextColor),this.cScaleLabel3=this.cScaleLabel3||dn(this.labelTextColor);for(let T=0;T<this.THEME_COLOR_LIMIT;T++)this["cScaleLabel"+T]=this["cScaleLabel"+T]||this.labelTextColor}this.nodeBkg=this.mainBkg,this.nodeBorder=this.border1,this.clusterBkg=this.secondBkg,this.clusterBorder=this.border2,this.defaultLinkColor=this.lineColor,this.titleColor=this.textColor,this.edgeLabelBackground=this.labelBackground,this.actorBorder=kn(this.border1,23),this.actorBkg=this.mainBkg,this.labelBoxBkgColor=this.actorBkg,this.signalColor=this.textColor,this.signalTextColor=this.textColor,this.labelBoxBorderColor=this.actorBorder,this.labelTextColor=this.actorTextColor,this.loopTextColor=this.actorTextColor,this.noteBorderColor=this.border2,this.noteTextColor=this.actorTextColor,this.actorLineColor=this.actorBorder,this.taskTextColor=this.taskTextLightColor,this.taskTextOutsideColor=this.taskTextDarkColor,this.archEdgeColor=this.lineColor,this.archEdgeArrowColor=this.lineColor,this.rowOdd=this.rowOdd||kn(this.primaryColor,75)||"#ffffff",this.rowEven=this.rowEven||kn(this.primaryColor,1),this.transitionColor=this.transitionColor||this.lineColor,this.transitionLabelColor=this.transitionLabelColor||this.textColor,this.stateLabelColor=this.stateLabelColor||this.stateBkg||this.primaryTextColor,this.stateBkg=this.stateBkg||this.mainBkg,this.labelBackgroundColor=this.labelBackgroundColor||this.stateBkg,this.compositeBackground=this.compositeBackground||this.background||this.tertiaryColor,this.altBackground=this.altBackground||"#f0f0f0",this.compositeTitleBackground=this.compositeTitleBackground||this.mainBkg,this.compositeBorder=this.compositeBorder||this.nodeBorder,this.innerEndBackground=this.nodeBorder,this.specialStateColor=this.lineColor,this.errorBkgColor=this.errorBkgColor||this.tertiaryColor,this.errorTextColor=this.errorTextColor||this.tertiaryTextColor,this.transitionColor=this.transitionColor||this.lineColor,this.classText=this.primaryTextColor,this.fillType0=this.primaryColor,this.fillType1=this.secondaryColor,this.fillType2=xt(this.primaryColor,{h:64}),this.fillType3=xt(this.secondaryColor,{h:64}),this.fillType4=xt(this.primaryColor,{h:-64}),this.fillType5=xt(this.secondaryColor,{h:-64}),this.fillType6=xt(this.primaryColor,{h:128}),this.fillType7=xt(this.secondaryColor,{h:128}),this.pie1=this.pie1||this.primaryColor,this.pie2=this.pie2||this.secondaryColor,this.pie3=this.pie3||xt(this.tertiaryColor,{l:-40}),this.pie4=this.pie4||xt(this.primaryColor,{l:-10}),this.pie5=this.pie5||xt(this.secondaryColor,{l:-30}),this.pie6=this.pie6||xt(this.tertiaryColor,{l:-20}),this.pie7=this.pie7||xt(this.primaryColor,{h:60,l:-20}),this.pie8=this.pie8||xt(this.primaryColor,{h:-60,l:-40}),this.pie9=this.pie9||xt(this.primaryColor,{h:120,l:-40}),this.pie10=this.pie10||xt(this.primaryColor,{h:60,l:-40}),this.pie11=this.pie11||xt(this.primaryColor,{h:-90,l:-40}),this.pie12=this.pie12||xt(this.primaryColor,{h:120,l:-30}),this.pieTitleTextSize=this.pieTitleTextSize||"25px",this.pieTitleTextColor=this.pieTitleTextColor||this.taskTextDarkColor,this.pieSectionTextSize=this.pieSectionTextSize||"17px",this.pieSectionTextColor=this.pieSectionTextColor||this.textColor,this.pieLegendTextSize=this.pieLegendTextSize||"17px",this.pieLegendTextColor=this.pieLegendTextColor||this.taskTextDarkColor,this.pieStrokeColor=this.pieStrokeColor||"black",this.pieStrokeWidth=this.pieStrokeWidth||"2px",this.pieOuterStrokeWidth=this.pieOuterStrokeWidth||"2px",this.pieOuterStrokeColor=this.pieOuterStrokeColor||"black",this.pieOpacity=this.pieOpacity||"0.7",this.quadrant1Fill=this.quadrant1Fill||this.primaryColor,this.quadrant2Fill=this.quadrant2Fill||xt(this.primaryColor,{r:5,g:5,b:5}),this.quadrant3Fill=this.quadrant3Fill||xt(this.primaryColor,{r:10,g:10,b:10}),this.quadrant4Fill=this.quadrant4Fill||xt(this.primaryColor,{r:15,g:15,b:15}),this.quadrant1TextFill=this.quadrant1TextFill||this.primaryTextColor,this.quadrant2TextFill=this.quadrant2TextFill||xt(this.primaryTextColor,{r:-5,g:-5,b:-5}),this.quadrant3TextFill=this.quadrant3TextFill||xt(this.primaryTextColor,{r:-10,g:-10,b:-10}),this.quadrant4TextFill=this.quadrant4TextFill||xt(this.primaryTextColor,{r:-15,g:-15,b:-15}),this.quadrantPointFill=this.quadrantPointFill||SS(this.quadrant1Fill)?kn(this.quadrant1Fill):Wn(this.quadrant1Fill),this.quadrantPointTextFill=this.quadrantPointTextFill||this.primaryTextColor,this.quadrantXAxisTextFill=this.quadrantXAxisTextFill||this.primaryTextColor,this.quadrantYAxisTextFill=this.quadrantYAxisTextFill||this.primaryTextColor,this.quadrantInternalBorderStrokeFill=this.quadrantInternalBorderStrokeFill||this.primaryBorderColor,this.quadrantExternalBorderStrokeFill=this.quadrantExternalBorderStrokeFill||this.primaryBorderColor,this.quadrantTitleFill=this.quadrantTitleFill||this.primaryTextColor,this.radar={axisColor:((t=this.radar)==null?void 0:t.axisColor)||this.lineColor,axisStrokeWidth:((n=this.radar)==null?void 0:n.axisStrokeWidth)||2,axisLabelFontSize:((r=this.radar)==null?void 0:r.axisLabelFontSize)||12,curveOpacity:((s=this.radar)==null?void 0:s.curveOpacity)||.5,curveStrokeWidth:((i=this.radar)==null?void 0:i.curveStrokeWidth)||2,graticuleColor:((a=this.radar)==null?void 0:a.graticuleColor)||"#DEDEDE",graticuleStrokeWidth:((o=this.radar)==null?void 0:o.graticuleStrokeWidth)||1,graticuleOpacity:((l=this.radar)==null?void 0:l.graticuleOpacity)||.3,legendBoxSize:((c=this.radar)==null?void 0:c.legendBoxSize)||12,legendFontSize:((u=this.radar)==null?void 0:u.legendFontSize)||12},this.xyChart={backgroundColor:((d=this.xyChart)==null?void 0:d.backgroundColor)||this.background,titleColor:((h=this.xyChart)==null?void 0:h.titleColor)||this.primaryTextColor,xAxisTitleColor:((m=this.xyChart)==null?void 0:m.xAxisTitleColor)||this.primaryTextColor,xAxisLabelColor:((y=this.xyChart)==null?void 0:y.xAxisLabelColor)||this.primaryTextColor,xAxisTickColor:((b=this.xyChart)==null?void 0:b.xAxisTickColor)||this.primaryTextColor,xAxisLineColor:((v=this.xyChart)==null?void 0:v.xAxisLineColor)||this.primaryTextColor,yAxisTitleColor:((x=this.xyChart)==null?void 0:x.yAxisTitleColor)||this.primaryTextColor,yAxisLabelColor:((w=this.xyChart)==null?void 0:w.yAxisLabelColor)||this.primaryTextColor,yAxisTickColor:((_=this.xyChart)==null?void 0:_.yAxisTickColor)||this.primaryTextColor,yAxisLineColor:((k=this.xyChart)==null?void 0:k.yAxisLineColor)||this.primaryTextColor,plotColorPalette:((C=this.xyChart)==null?void 0:C.plotColorPalette)||"#ECECFF,#8493A6,#FFC3A0,#DCDDE1,#B8E994,#D1A36F,#C3CDE6,#FFB6C1,#496078,#F8F3E3"},this.requirementBackground=this.requirementBackground||this.primaryColor,this.requirementBorderColor=this.requirementBorderColor||this.primaryBorderColor,this.requirementBorderSize=this.requirementBorderSize||"1",this.requirementTextColor=this.requirementTextColor||this.primaryTextColor,this.relationColor=this.relationColor||this.lineColor,this.relationLabelBackground=this.relationLabelBackground||this.labelBackground,this.relationLabelColor=this.relationLabelColor||this.actorTextColor,this.git0=this.git0||this.primaryColor,this.git1=this.git1||this.secondaryColor,this.git2=this.git2||this.tertiaryColor,this.git3=this.git3||xt(this.primaryColor,{h:-30}),this.git4=this.git4||xt(this.primaryColor,{h:-60}),this.git5=this.git5||xt(this.primaryColor,{h:-90}),this.git6=this.git6||xt(this.primaryColor,{h:60}),this.git7=this.git7||xt(this.primaryColor,{h:120}),this.darkMode?(this.git0=kn(this.git0,25),this.git1=kn(this.git1,25),this.git2=kn(this.git2,25),this.git3=kn(this.git3,25),this.git4=kn(this.git4,25),this.git5=kn(this.git5,25),this.git6=kn(this.git6,25),this.git7=kn(this.git7,25)):(this.git0=Wn(this.git0,25),this.git1=Wn(this.git1,25),this.git2=Wn(this.git2,25),this.git3=Wn(this.git3,25),this.git4=Wn(this.git4,25),this.git5=Wn(this.git5,25),this.git6=Wn(this.git6,25),this.git7=Wn(this.git7,25)),this.gitInv0=this.gitInv0||Wn(dn(this.git0),25),this.gitInv1=this.gitInv1||dn(this.git1),this.gitInv2=this.gitInv2||dn(this.git2),this.gitInv3=this.gitInv3||dn(this.git3),this.gitInv4=this.gitInv4||dn(this.git4),this.gitInv5=this.gitInv5||dn(this.git5),this.gitInv6=this.gitInv6||dn(this.git6),this.gitInv7=this.gitInv7||dn(this.git7),this.gitBranchLabel0=this.gitBranchLabel0||dn(this.labelTextColor),this.gitBranchLabel1=this.gitBranchLabel1||this.labelTextColor,this.gitBranchLabel2=this.gitBranchLabel2||this.labelTextColor,this.gitBranchLabel3=this.gitBranchLabel3||dn(this.labelTextColor),this.gitBranchLabel4=this.gitBranchLabel4||this.labelTextColor,this.gitBranchLabel5=this.gitBranchLabel5||this.labelTextColor,this.gitBranchLabel6=this.gitBranchLabel6||this.labelTextColor,this.gitBranchLabel7=this.gitBranchLabel7||this.labelTextColor,this.tagLabelColor=this.tagLabelColor||this.primaryTextColor,this.tagLabelBackground=this.tagLabelBackground||this.primaryColor,this.tagLabelBorder=this.tagBorder||this.primaryBorderColor,this.tagLabelFontSize=this.tagLabelFontSize||"10px",this.commitLabelColor=this.commitLabelColor||this.secondaryTextColor,this.commitLabelBackground=this.commitLabelBackground||this.secondaryColor,this.commitLabelFontSize=this.commitLabelFontSize||"10px",this.attributeBackgroundColorOdd=this.attributeBackgroundColorOdd||lA,this.attributeBackgroundColorEven=this.attributeBackgroundColorEven||cA}calculate(t){if(Object.keys(this).forEach(r=>{this[r]==="calculated"&&(this[r]=void 0)}),typeof t!="object"){this.updateColors();return}const n=Object.keys(t);n.forEach(r=>{this[r]=t[r]}),this.updateColors(),n.forEach(r=>{this[r]=t[r]})}},ie(sy,"Theme"),sy),ZXe=ie(e=>{const t=new YXe;return t.calculate(e),t},"getThemeVariables"),iy,XXe=(iy=class{constructor(){this.background="#f4f4f4",this.primaryColor="#cde498",this.secondaryColor="#cdffb2",this.background="white",this.mainBkg="#cde498",this.secondBkg="#cdffb2",this.lineColor="green",this.border1="#13540c",this.border2="#6eaa49",this.arrowheadColor="green",this.fontFamily='"trebuchet ms", verdana, arial, sans-serif',this.fontSize="16px",this.tertiaryColor=kn("#cde498",10),this.primaryBorderColor=ao(this.primaryColor,this.darkMode),this.secondaryBorderColor=ao(this.secondaryColor,this.darkMode),this.tertiaryBorderColor=ao(this.tertiaryColor,this.darkMode),this.primaryTextColor=dn(this.primaryColor),this.secondaryTextColor=dn(this.secondaryColor),this.tertiaryTextColor=dn(this.primaryColor),this.lineColor=dn(this.background),this.textColor=dn(this.background),this.THEME_COLOR_LIMIT=12,this.nodeBkg="calculated",this.nodeBorder="calculated",this.clusterBkg="calculated",this.clusterBorder="calculated",this.defaultLinkColor="calculated",this.titleColor="#333",this.edgeLabelBackground="#e8e8e8",this.actorBorder="calculated",this.actorBkg="calculated",this.actorTextColor="black",this.actorLineColor="calculated",this.signalColor="#333",this.signalTextColor="#333",this.labelBoxBkgColor="calculated",this.labelBoxBorderColor="#326932",this.labelTextColor="calculated",this.loopTextColor="calculated",this.noteBorderColor="calculated",this.noteBkgColor="#fff5ad",this.noteTextColor="calculated",this.activationBorderColor="#666",this.activationBkgColor="#f4f4f4",this.sequenceNumberColor="white",this.sectionBkgColor="#6eaa49",this.altSectionBkgColor="white",this.sectionBkgColor2="#6eaa49",this.excludeBkgColor="#eeeeee",this.taskBorderColor="calculated",this.taskBkgColor="#487e3a",this.taskTextLightColor="white",this.taskTextColor="calculated",this.taskTextDarkColor="black",this.taskTextOutsideColor="calculated",this.taskTextClickableColor="#003163",this.activeTaskBorderColor="calculated",this.activeTaskBkgColor="calculated",this.gridColor="lightgrey",this.doneTaskBkgColor="lightgrey",this.doneTaskBorderColor="grey",this.critBorderColor="#ff8888",this.critBkgColor="red",this.todayLineColor="red",this.personBorder=this.primaryBorderColor,this.personBkg=this.mainBkg,this.archEdgeColor="calculated",this.archEdgeArrowColor="calculated",this.archEdgeWidth="3",this.archGroupBorderColor=this.primaryBorderColor,this.archGroupBorderWidth="2px",this.labelColor="black",this.errorBkgColor="#552222",this.errorTextColor="#552222"}updateColors(){var t,n,r,s,i,a,o,l,c,u,d,h,m,y,b,v,x,w,_,k,C;this.actorBorder=Wn(this.mainBkg,20),this.actorBkg=this.mainBkg,this.labelBoxBkgColor=this.actorBkg,this.labelTextColor=this.actorTextColor,this.loopTextColor=this.actorTextColor,this.noteBorderColor=this.border2,this.noteTextColor=this.actorTextColor,this.actorLineColor=this.actorBorder,this.cScale0=this.cScale0||this.primaryColor,this.cScale1=this.cScale1||this.secondaryColor,this.cScale2=this.cScale2||this.tertiaryColor,this.cScale3=this.cScale3||xt(this.primaryColor,{h:30}),this.cScale4=this.cScale4||xt(this.primaryColor,{h:60}),this.cScale5=this.cScale5||xt(this.primaryColor,{h:90}),this.cScale6=this.cScale6||xt(this.primaryColor,{h:120}),this.cScale7=this.cScale7||xt(this.primaryColor,{h:150}),this.cScale8=this.cScale8||xt(this.primaryColor,{h:210}),this.cScale9=this.cScale9||xt(this.primaryColor,{h:270}),this.cScale10=this.cScale10||xt(this.primaryColor,{h:300}),this.cScale11=this.cScale11||xt(this.primaryColor,{h:330}),this.cScalePeer1=this.cScalePeer1||Wn(this.secondaryColor,45),this.cScalePeer2=this.cScalePeer2||Wn(this.tertiaryColor,40);for(let T=0;T<this.THEME_COLOR_LIMIT;T++)this["cScale"+T]=Wn(this["cScale"+T],10),this["cScalePeer"+T]=this["cScalePeer"+T]||Wn(this["cScale"+T],25);for(let T=0;T<this.THEME_COLOR_LIMIT;T++)this["cScaleInv"+T]=this["cScaleInv"+T]||xt(this["cScale"+T],{h:180});this.scaleLabelColor=this.scaleLabelColor!=="calculated"&&this.scaleLabelColor?this.scaleLabelColor:this.labelTextColor;for(let T=0;T<this.THEME_COLOR_LIMIT;T++)this["cScaleLabel"+T]=this["cScaleLabel"+T]||this.scaleLabelColor;for(let T=0;T<5;T++)this["surface"+T]=this["surface"+T]||xt(this.mainBkg,{h:30,s:-30,l:-(5+T*5)}),this["surfacePeer"+T]=this["surfacePeer"+T]||xt(this.mainBkg,{h:30,s:-30,l:-(8+T*5)});this.nodeBkg=this.mainBkg,this.nodeBorder=this.border1,this.clusterBkg=this.secondBkg,this.clusterBorder=this.border2,this.defaultLinkColor=this.lineColor,this.taskBorderColor=this.border1,this.taskTextColor=this.taskTextLightColor,this.taskTextOutsideColor=this.taskTextDarkColor,this.activeTaskBorderColor=this.taskBorderColor,this.activeTaskBkgColor=this.mainBkg,this.archEdgeColor=this.lineColor,this.archEdgeArrowColor=this.lineColor,this.rowOdd=this.rowOdd||kn(this.mainBkg,75)||"#ffffff",this.rowEven=this.rowEven||kn(this.mainBkg,20),this.transitionColor=this.transitionColor||this.lineColor,this.transitionLabelColor=this.transitionLabelColor||this.textColor,this.stateLabelColor=this.stateLabelColor||this.stateBkg||this.primaryTextColor,this.stateBkg=this.stateBkg||this.mainBkg,this.labelBackgroundColor=this.labelBackgroundColor||this.stateBkg,this.compositeBackground=this.compositeBackground||this.background||this.tertiaryColor,this.altBackground=this.altBackground||"#f0f0f0",this.compositeTitleBackground=this.compositeTitleBackground||this.mainBkg,this.compositeBorder=this.compositeBorder||this.nodeBorder,this.innerEndBackground=this.primaryBorderColor,this.specialStateColor=this.lineColor,this.errorBkgColor=this.errorBkgColor||this.tertiaryColor,this.errorTextColor=this.errorTextColor||this.tertiaryTextColor,this.transitionColor=this.transitionColor||this.lineColor,this.classText=this.primaryTextColor,this.fillType0=this.primaryColor,this.fillType1=this.secondaryColor,this.fillType2=xt(this.primaryColor,{h:64}),this.fillType3=xt(this.secondaryColor,{h:64}),this.fillType4=xt(this.primaryColor,{h:-64}),this.fillType5=xt(this.secondaryColor,{h:-64}),this.fillType6=xt(this.primaryColor,{h:128}),this.fillType7=xt(this.secondaryColor,{h:128}),this.pie1=this.pie1||this.primaryColor,this.pie2=this.pie2||this.secondaryColor,this.pie3=this.pie3||this.tertiaryColor,this.pie4=this.pie4||xt(this.primaryColor,{l:-30}),this.pie5=this.pie5||xt(this.secondaryColor,{l:-30}),this.pie6=this.pie6||xt(this.tertiaryColor,{h:40,l:-40}),this.pie7=this.pie7||xt(this.primaryColor,{h:60,l:-10}),this.pie8=this.pie8||xt(this.primaryColor,{h:-60,l:-10}),this.pie9=this.pie9||xt(this.primaryColor,{h:120,l:0}),this.pie10=this.pie10||xt(this.primaryColor,{h:60,l:-50}),this.pie11=this.pie11||xt(this.primaryColor,{h:-60,l:-50}),this.pie12=this.pie12||xt(this.primaryColor,{h:120,l:-50}),this.pieTitleTextSize=this.pieTitleTextSize||"25px",this.pieTitleTextColor=this.pieTitleTextColor||this.taskTextDarkColor,this.pieSectionTextSize=this.pieSectionTextSize||"17px",this.pieSectionTextColor=this.pieSectionTextColor||this.textColor,this.pieLegendTextSize=this.pieLegendTextSize||"17px",this.pieLegendTextColor=this.pieLegendTextColor||this.taskTextDarkColor,this.pieStrokeColor=this.pieStrokeColor||"black",this.pieStrokeWidth=this.pieStrokeWidth||"2px",this.pieOuterStrokeWidth=this.pieOuterStrokeWidth||"2px",this.pieOuterStrokeColor=this.pieOuterStrokeColor||"black",this.pieOpacity=this.pieOpacity||"0.7",this.quadrant1Fill=this.quadrant1Fill||this.primaryColor,this.quadrant2Fill=this.quadrant2Fill||xt(this.primaryColor,{r:5,g:5,b:5}),this.quadrant3Fill=this.quadrant3Fill||xt(this.primaryColor,{r:10,g:10,b:10}),this.quadrant4Fill=this.quadrant4Fill||xt(this.primaryColor,{r:15,g:15,b:15}),this.quadrant1TextFill=this.quadrant1TextFill||this.primaryTextColor,this.quadrant2TextFill=this.quadrant2TextFill||xt(this.primaryTextColor,{r:-5,g:-5,b:-5}),this.quadrant3TextFill=this.quadrant3TextFill||xt(this.primaryTextColor,{r:-10,g:-10,b:-10}),this.quadrant4TextFill=this.quadrant4TextFill||xt(this.primaryTextColor,{r:-15,g:-15,b:-15}),this.quadrantPointFill=this.quadrantPointFill||SS(this.quadrant1Fill)?kn(this.quadrant1Fill):Wn(this.quadrant1Fill),this.quadrantPointTextFill=this.quadrantPointTextFill||this.primaryTextColor,this.quadrantXAxisTextFill=this.quadrantXAxisTextFill||this.primaryTextColor,this.quadrantYAxisTextFill=this.quadrantYAxisTextFill||this.primaryTextColor,this.quadrantInternalBorderStrokeFill=this.quadrantInternalBorderStrokeFill||this.primaryBorderColor,this.quadrantExternalBorderStrokeFill=this.quadrantExternalBorderStrokeFill||this.primaryBorderColor,this.quadrantTitleFill=this.quadrantTitleFill||this.primaryTextColor,this.packet={startByteColor:this.primaryTextColor,endByteColor:this.primaryTextColor,labelColor:this.primaryTextColor,titleColor:this.primaryTextColor,blockStrokeColor:this.primaryTextColor,blockFillColor:this.mainBkg},this.radar={axisColor:((t=this.radar)==null?void 0:t.axisColor)||this.lineColor,axisStrokeWidth:((n=this.radar)==null?void 0:n.axisStrokeWidth)||2,axisLabelFontSize:((r=this.radar)==null?void 0:r.axisLabelFontSize)||12,curveOpacity:((s=this.radar)==null?void 0:s.curveOpacity)||.5,curveStrokeWidth:((i=this.radar)==null?void 0:i.curveStrokeWidth)||2,graticuleColor:((a=this.radar)==null?void 0:a.graticuleColor)||"#DEDEDE",graticuleStrokeWidth:((o=this.radar)==null?void 0:o.graticuleStrokeWidth)||1,graticuleOpacity:((l=this.radar)==null?void 0:l.graticuleOpacity)||.3,legendBoxSize:((c=this.radar)==null?void 0:c.legendBoxSize)||12,legendFontSize:((u=this.radar)==null?void 0:u.legendFontSize)||12},this.xyChart={backgroundColor:((d=this.xyChart)==null?void 0:d.backgroundColor)||this.background,titleColor:((h=this.xyChart)==null?void 0:h.titleColor)||this.primaryTextColor,xAxisTitleColor:((m=this.xyChart)==null?void 0:m.xAxisTitleColor)||this.primaryTextColor,xAxisLabelColor:((y=this.xyChart)==null?void 0:y.xAxisLabelColor)||this.primaryTextColor,xAxisTickColor:((b=this.xyChart)==null?void 0:b.xAxisTickColor)||this.primaryTextColor,xAxisLineColor:((v=this.xyChart)==null?void 0:v.xAxisLineColor)||this.primaryTextColor,yAxisTitleColor:((x=this.xyChart)==null?void 0:x.yAxisTitleColor)||this.primaryTextColor,yAxisLabelColor:((w=this.xyChart)==null?void 0:w.yAxisLabelColor)||this.primaryTextColor,yAxisTickColor:((_=this.xyChart)==null?void 0:_.yAxisTickColor)||this.primaryTextColor,yAxisLineColor:((k=this.xyChart)==null?void 0:k.yAxisLineColor)||this.primaryTextColor,plotColorPalette:((C=this.xyChart)==null?void 0:C.plotColorPalette)||"#CDE498,#FF6B6B,#A0D2DB,#D7BDE2,#F0F0F0,#FFC3A0,#7FD8BE,#FF9A8B,#FAF3E0,#FFF176"},this.requirementBackground=this.requirementBackground||this.primaryColor,this.requirementBorderColor=this.requirementBorderColor||this.primaryBorderColor,this.requirementBorderSize=this.requirementBorderSize||"1",this.requirementTextColor=this.requirementTextColor||this.primaryTextColor,this.relationColor=this.relationColor||this.lineColor,this.relationLabelBackground=this.relationLabelBackground||this.edgeLabelBackground,this.relationLabelColor=this.relationLabelColor||this.actorTextColor,this.git0=this.git0||this.primaryColor,this.git1=this.git1||this.secondaryColor,this.git2=this.git2||this.tertiaryColor,this.git3=this.git3||xt(this.primaryColor,{h:-30}),this.git4=this.git4||xt(this.primaryColor,{h:-60}),this.git5=this.git5||xt(this.primaryColor,{h:-90}),this.git6=this.git6||xt(this.primaryColor,{h:60}),this.git7=this.git7||xt(this.primaryColor,{h:120}),this.darkMode?(this.git0=kn(this.git0,25),this.git1=kn(this.git1,25),this.git2=kn(this.git2,25),this.git3=kn(this.git3,25),this.git4=kn(this.git4,25),this.git5=kn(this.git5,25),this.git6=kn(this.git6,25),this.git7=kn(this.git7,25)):(this.git0=Wn(this.git0,25),this.git1=Wn(this.git1,25),this.git2=Wn(this.git2,25),this.git3=Wn(this.git3,25),this.git4=Wn(this.git4,25),this.git5=Wn(this.git5,25),this.git6=Wn(this.git6,25),this.git7=Wn(this.git7,25)),this.gitInv0=this.gitInv0||dn(this.git0),this.gitInv1=this.gitInv1||dn(this.git1),this.gitInv2=this.gitInv2||dn(this.git2),this.gitInv3=this.gitInv3||dn(this.git3),this.gitInv4=this.gitInv4||dn(this.git4),this.gitInv5=this.gitInv5||dn(this.git5),this.gitInv6=this.gitInv6||dn(this.git6),this.gitInv7=this.gitInv7||dn(this.git7),this.gitBranchLabel0=this.gitBranchLabel0||dn(this.labelTextColor),this.gitBranchLabel1=this.gitBranchLabel1||this.labelTextColor,this.gitBranchLabel2=this.gitBranchLabel2||this.labelTextColor,this.gitBranchLabel3=this.gitBranchLabel3||dn(this.labelTextColor),this.gitBranchLabel4=this.gitBranchLabel4||this.labelTextColor,this.gitBranchLabel5=this.gitBranchLabel5||this.labelTextColor,this.gitBranchLabel6=this.gitBranchLabel6||this.labelTextColor,this.gitBranchLabel7=this.gitBranchLabel7||this.labelTextColor,this.tagLabelColor=this.tagLabelColor||this.primaryTextColor,this.tagLabelBackground=this.tagLabelBackground||this.primaryColor,this.tagLabelBorder=this.tagBorder||this.primaryBorderColor,this.tagLabelFontSize=this.tagLabelFontSize||"10px",this.commitLabelColor=this.commitLabelColor||this.secondaryTextColor,this.commitLabelBackground=this.commitLabelBackground||this.secondaryColor,this.commitLabelFontSize=this.commitLabelFontSize||"10px",this.attributeBackgroundColorOdd=this.attributeBackgroundColorOdd||lA,this.attributeBackgroundColorEven=this.attributeBackgroundColorEven||cA}calculate(t){if(typeof t!="object"){this.updateColors();return}const n=Object.keys(t);n.forEach(r=>{this[r]=t[r]}),this.updateColors(),n.forEach(r=>{this[r]=t[r]})}},ie(iy,"Theme"),iy),JXe=ie(e=>{const t=new XXe;return t.calculate(e),t},"getThemeVariables"),ay,QXe=(ay=class{constructor(){this.primaryColor="#eee",this.contrast="#707070",this.secondaryColor=kn(this.contrast,55),this.background="#ffffff",this.tertiaryColor=xt(this.primaryColor,{h:-160}),this.primaryBorderColor=ao(this.primaryColor,this.darkMode),this.secondaryBorderColor=ao(this.secondaryColor,this.darkMode),this.tertiaryBorderColor=ao(this.tertiaryColor,this.darkMode),this.primaryTextColor=dn(this.primaryColor),this.secondaryTextColor=dn(this.secondaryColor),this.tertiaryTextColor=dn(this.tertiaryColor),this.lineColor=dn(this.background),this.textColor=dn(this.background),this.mainBkg="#eee",this.secondBkg="calculated",this.lineColor="#666",this.border1="#999",this.border2="calculated",this.note="#ffa",this.text="#333",this.critical="#d42",this.done="#bbb",this.arrowheadColor="#333333",this.fontFamily='"trebuchet ms", verdana, arial, sans-serif',this.fontSize="16px",this.THEME_COLOR_LIMIT=12,this.nodeBkg="calculated",this.nodeBorder="calculated",this.clusterBkg="calculated",this.clusterBorder="calculated",this.defaultLinkColor="calculated",this.titleColor="calculated",this.edgeLabelBackground="white",this.actorBorder="calculated",this.actorBkg="calculated",this.actorTextColor="calculated",this.actorLineColor=this.actorBorder,this.signalColor="calculated",this.signalTextColor="calculated",this.labelBoxBkgColor="calculated",this.labelBoxBorderColor="calculated",this.labelTextColor="calculated",this.loopTextColor="calculated",this.noteBorderColor="calculated",this.noteBkgColor="calculated",this.noteTextColor="calculated",this.activationBorderColor="#666",this.activationBkgColor="#f4f4f4",this.sequenceNumberColor="white",this.sectionBkgColor="calculated",this.altSectionBkgColor="white",this.sectionBkgColor2="calculated",this.excludeBkgColor="#eeeeee",this.taskBorderColor="calculated",this.taskBkgColor="calculated",this.taskTextLightColor="white",this.taskTextColor="calculated",this.taskTextDarkColor="calculated",this.taskTextOutsideColor="calculated",this.taskTextClickableColor="#003163",this.activeTaskBorderColor="calculated",this.activeTaskBkgColor="calculated",this.gridColor="calculated",this.doneTaskBkgColor="calculated",this.doneTaskBorderColor="calculated",this.critBkgColor="calculated",this.critBorderColor="calculated",this.todayLineColor="calculated",this.personBorder=this.primaryBorderColor,this.personBkg=this.mainBkg,this.archEdgeColor="calculated",this.archEdgeArrowColor="calculated",this.archEdgeWidth="3",this.archGroupBorderColor=this.primaryBorderColor,this.archGroupBorderWidth="2px",this.rowOdd=this.rowOdd||kn(this.mainBkg,75)||"#ffffff",this.rowEven=this.rowEven||"#f4f4f4",this.labelColor="black",this.errorBkgColor="#552222",this.errorTextColor="#552222"}updateColors(){var t,n,r,s,i,a,o,l,c,u,d,h,m,y,b,v,x,w,_,k,C;this.secondBkg=kn(this.contrast,55),this.border2=this.contrast,this.actorBorder=kn(this.border1,23),this.actorBkg=this.mainBkg,this.actorTextColor=this.text,this.actorLineColor=this.actorBorder,this.signalColor=this.text,this.signalTextColor=this.text,this.labelBoxBkgColor=this.actorBkg,this.labelBoxBorderColor=this.actorBorder,this.labelTextColor=this.text,this.loopTextColor=this.text,this.noteBorderColor="#999",this.noteBkgColor="#666",this.noteTextColor="#fff",this.cScale0=this.cScale0||"#555",this.cScale1=this.cScale1||"#F4F4F4",this.cScale2=this.cScale2||"#555",this.cScale3=this.cScale3||"#BBB",this.cScale4=this.cScale4||"#777",this.cScale5=this.cScale5||"#999",this.cScale6=this.cScale6||"#DDD",this.cScale7=this.cScale7||"#FFF",this.cScale8=this.cScale8||"#DDD",this.cScale9=this.cScale9||"#BBB",this.cScale10=this.cScale10||"#999",this.cScale11=this.cScale11||"#777";for(let T=0;T<this.THEME_COLOR_LIMIT;T++)this["cScaleInv"+T]=this["cScaleInv"+T]||dn(this["cScale"+T]);for(let T=0;T<this.THEME_COLOR_LIMIT;T++)this.darkMode?this["cScalePeer"+T]=this["cScalePeer"+T]||kn(this["cScale"+T],10):this["cScalePeer"+T]=this["cScalePeer"+T]||Wn(this["cScale"+T],10);this.scaleLabelColor=this.scaleLabelColor||(this.darkMode?"black":this.labelTextColor),this.cScaleLabel0=this.cScaleLabel0||this.cScale1,this.cScaleLabel2=this.cScaleLabel2||this.cScale1;for(let T=0;T<this.THEME_COLOR_LIMIT;T++)this["cScaleLabel"+T]=this["cScaleLabel"+T]||this.scaleLabelColor;for(let T=0;T<5;T++)this["surface"+T]=this["surface"+T]||xt(this.mainBkg,{l:-(5+T*5)}),this["surfacePeer"+T]=this["surfacePeer"+T]||xt(this.mainBkg,{l:-(8+T*5)});this.nodeBkg=this.mainBkg,this.nodeBorder=this.border1,this.clusterBkg=this.secondBkg,this.clusterBorder=this.border2,this.defaultLinkColor=this.lineColor,this.titleColor=this.text,this.sectionBkgColor=kn(this.contrast,30),this.sectionBkgColor2=kn(this.contrast,30),this.taskBorderColor=Wn(this.contrast,10),this.taskBkgColor=this.contrast,this.taskTextColor=this.taskTextLightColor,this.taskTextDarkColor=this.text,this.taskTextOutsideColor=this.taskTextDarkColor,this.activeTaskBorderColor=this.taskBorderColor,this.activeTaskBkgColor=this.mainBkg,this.gridColor=kn(this.border1,30),this.doneTaskBkgColor=this.done,this.doneTaskBorderColor=this.lineColor,this.critBkgColor=this.critical,this.critBorderColor=Wn(this.critBkgColor,10),this.todayLineColor=this.critBkgColor,this.archEdgeColor=this.lineColor,this.archEdgeArrowColor=this.lineColor,this.transitionColor=this.transitionColor||"#000",this.transitionLabelColor=this.transitionLabelColor||this.textColor,this.stateLabelColor=this.stateLabelColor||this.stateBkg||this.primaryTextColor,this.stateBkg=this.stateBkg||this.mainBkg,this.labelBackgroundColor=this.labelBackgroundColor||this.stateBkg,this.compositeBackground=this.compositeBackground||this.background||this.tertiaryColor,this.altBackground=this.altBackground||"#f4f4f4",this.compositeTitleBackground=this.compositeTitleBackground||this.mainBkg,this.stateBorder=this.stateBorder||"#000",this.innerEndBackground=this.primaryBorderColor,this.specialStateColor="#222",this.errorBkgColor=this.errorBkgColor||this.tertiaryColor,this.errorTextColor=this.errorTextColor||this.tertiaryTextColor,this.classText=this.primaryTextColor,this.fillType0=this.primaryColor,this.fillType1=this.secondaryColor,this.fillType2=xt(this.primaryColor,{h:64}),this.fillType3=xt(this.secondaryColor,{h:64}),this.fillType4=xt(this.primaryColor,{h:-64}),this.fillType5=xt(this.secondaryColor,{h:-64}),this.fillType6=xt(this.primaryColor,{h:128}),this.fillType7=xt(this.secondaryColor,{h:128});for(let T=0;T<this.THEME_COLOR_LIMIT;T++)this["pie"+T]=this["cScale"+T];this.pie12=this.pie0,this.pieTitleTextSize=this.pieTitleTextSize||"25px",this.pieTitleTextColor=this.pieTitleTextColor||this.taskTextDarkColor,this.pieSectionTextSize=this.pieSectionTextSize||"17px",this.pieSectionTextColor=this.pieSectionTextColor||this.textColor,this.pieLegendTextSize=this.pieLegendTextSize||"17px",this.pieLegendTextColor=this.pieLegendTextColor||this.taskTextDarkColor,this.pieStrokeColor=this.pieStrokeColor||"black",this.pieStrokeWidth=this.pieStrokeWidth||"2px",this.pieOuterStrokeWidth=this.pieOuterStrokeWidth||"2px",this.pieOuterStrokeColor=this.pieOuterStrokeColor||"black",this.pieOpacity=this.pieOpacity||"0.7",this.quadrant1Fill=this.quadrant1Fill||this.primaryColor,this.quadrant2Fill=this.quadrant2Fill||xt(this.primaryColor,{r:5,g:5,b:5}),this.quadrant3Fill=this.quadrant3Fill||xt(this.primaryColor,{r:10,g:10,b:10}),this.quadrant4Fill=this.quadrant4Fill||xt(this.primaryColor,{r:15,g:15,b:15}),this.quadrant1TextFill=this.quadrant1TextFill||this.primaryTextColor,this.quadrant2TextFill=this.quadrant2TextFill||xt(this.primaryTextColor,{r:-5,g:-5,b:-5}),this.quadrant3TextFill=this.quadrant3TextFill||xt(this.primaryTextColor,{r:-10,g:-10,b:-10}),this.quadrant4TextFill=this.quadrant4TextFill||xt(this.primaryTextColor,{r:-15,g:-15,b:-15}),this.quadrantPointFill=this.quadrantPointFill||SS(this.quadrant1Fill)?kn(this.quadrant1Fill):Wn(this.quadrant1Fill),this.quadrantPointTextFill=this.quadrantPointTextFill||this.primaryTextColor,this.quadrantXAxisTextFill=this.quadrantXAxisTextFill||this.primaryTextColor,this.quadrantYAxisTextFill=this.quadrantYAxisTextFill||this.primaryTextColor,this.quadrantInternalBorderStrokeFill=this.quadrantInternalBorderStrokeFill||this.primaryBorderColor,this.quadrantExternalBorderStrokeFill=this.quadrantExternalBorderStrokeFill||this.primaryBorderColor,this.quadrantTitleFill=this.quadrantTitleFill||this.primaryTextColor,this.xyChart={backgroundColor:((t=this.xyChart)==null?void 0:t.backgroundColor)||this.background,titleColor:((n=this.xyChart)==null?void 0:n.titleColor)||this.primaryTextColor,xAxisTitleColor:((r=this.xyChart)==null?void 0:r.xAxisTitleColor)||this.primaryTextColor,xAxisLabelColor:((s=this.xyChart)==null?void 0:s.xAxisLabelColor)||this.primaryTextColor,xAxisTickColor:((i=this.xyChart)==null?void 0:i.xAxisTickColor)||this.primaryTextColor,xAxisLineColor:((a=this.xyChart)==null?void 0:a.xAxisLineColor)||this.primaryTextColor,yAxisTitleColor:((o=this.xyChart)==null?void 0:o.yAxisTitleColor)||this.primaryTextColor,yAxisLabelColor:((l=this.xyChart)==null?void 0:l.yAxisLabelColor)||this.primaryTextColor,yAxisTickColor:((c=this.xyChart)==null?void 0:c.yAxisTickColor)||this.primaryTextColor,yAxisLineColor:((u=this.xyChart)==null?void 0:u.yAxisLineColor)||this.primaryTextColor,plotColorPalette:((d=this.xyChart)==null?void 0:d.plotColorPalette)||"#EEE,#6BB8E4,#8ACB88,#C7ACD6,#E8DCC2,#FFB2A8,#FFF380,#7E8D91,#FFD8B1,#FAF3E0"},this.radar={axisColor:((h=this.radar)==null?void 0:h.axisColor)||this.lineColor,axisStrokeWidth:((m=this.radar)==null?void 0:m.axisStrokeWidth)||2,axisLabelFontSize:((y=this.radar)==null?void 0:y.axisLabelFontSize)||12,curveOpacity:((b=this.radar)==null?void 0:b.curveOpacity)||.5,curveStrokeWidth:((v=this.radar)==null?void 0:v.curveStrokeWidth)||2,graticuleColor:((x=this.radar)==null?void 0:x.graticuleColor)||"#DEDEDE",graticuleStrokeWidth:((w=this.radar)==null?void 0:w.graticuleStrokeWidth)||1,graticuleOpacity:((_=this.radar)==null?void 0:_.graticuleOpacity)||.3,legendBoxSize:((k=this.radar)==null?void 0:k.legendBoxSize)||12,legendFontSize:((C=this.radar)==null?void 0:C.legendFontSize)||12},this.requirementBackground=this.requirementBackground||this.primaryColor,this.requirementBorderColor=this.requirementBorderColor||this.primaryBorderColor,this.requirementBorderSize=this.requirementBorderSize||"1",this.requirementTextColor=this.requirementTextColor||this.primaryTextColor,this.relationColor=this.relationColor||this.lineColor,this.relationLabelBackground=this.relationLabelBackground||this.edgeLabelBackground,this.relationLabelColor=this.relationLabelColor||this.actorTextColor,this.git0=Wn(this.pie1,25)||this.primaryColor,this.git1=this.pie2||this.secondaryColor,this.git2=this.pie3||this.tertiaryColor,this.git3=this.pie4||xt(this.primaryColor,{h:-30}),this.git4=this.pie5||xt(this.primaryColor,{h:-60}),this.git5=this.pie6||xt(this.primaryColor,{h:-90}),this.git6=this.pie7||xt(this.primaryColor,{h:60}),this.git7=this.pie8||xt(this.primaryColor,{h:120}),this.gitInv0=this.gitInv0||dn(this.git0),this.gitInv1=this.gitInv1||dn(this.git1),this.gitInv2=this.gitInv2||dn(this.git2),this.gitInv3=this.gitInv3||dn(this.git3),this.gitInv4=this.gitInv4||dn(this.git4),this.gitInv5=this.gitInv5||dn(this.git5),this.gitInv6=this.gitInv6||dn(this.git6),this.gitInv7=this.gitInv7||dn(this.git7),this.branchLabelColor=this.branchLabelColor||this.labelTextColor,this.gitBranchLabel0=this.branchLabelColor,this.gitBranchLabel1="white",this.gitBranchLabel2=this.branchLabelColor,this.gitBranchLabel3="white",this.gitBranchLabel4=this.branchLabelColor,this.gitBranchLabel5=this.branchLabelColor,this.gitBranchLabel6=this.branchLabelColor,this.gitBranchLabel7=this.branchLabelColor,this.tagLabelColor=this.tagLabelColor||this.primaryTextColor,this.tagLabelBackground=this.tagLabelBackground||this.primaryColor,this.tagLabelBorder=this.tagBorder||this.primaryBorderColor,this.tagLabelFontSize=this.tagLabelFontSize||"10px",this.commitLabelColor=this.commitLabelColor||this.secondaryTextColor,this.commitLabelBackground=this.commitLabelBackground||this.secondaryColor,this.commitLabelFontSize=this.commitLabelFontSize||"10px",this.attributeBackgroundColorOdd=this.attributeBackgroundColorOdd||lA,this.attributeBackgroundColorEven=this.attributeBackgroundColorEven||cA}calculate(t){if(typeof t!="object"){this.updateColors();return}const n=Object.keys(t);n.forEach(r=>{this[r]=t[r]}),this.updateColors(),n.forEach(r=>{this[r]=t[r]})}},ie(ay,"Theme"),ay),eJe=ie(e=>{const t=new QXe;return t.calculate(e),t},"getThemeVariables"),tf={base:{getThemeVariables:HXe},dark:{getThemeVariables:KXe},default:{getThemeVariables:ZXe},forest:{getThemeVariables:JXe},neutral:{getThemeVariables:eJe}},jd={flowchart:{useMaxWidth:!0,titleTopMargin:25,subGraphTitleMargin:{top:0,bottom:0},diagramPadding:8,htmlLabels:!0,nodeSpacing:50,rankSpacing:50,curve:"basis",padding:15,defaultRenderer:"dagre-wrapper",wrappingWidth:200},sequence:{useMaxWidth:!0,hideUnusedParticipants:!1,activationWidth:10,diagramMarginX:50,diagramMarginY:10,actorMargin:50,width:150,height:65,boxMargin:10,boxTextMargin:5,noteMargin:10,messageMargin:35,messageAlign:"center",mirrorActors:!0,forceMenus:!1,bottomMarginAdj:1,rightAngles:!1,showSequenceNumbers:!1,actorFontSize:14,actorFontFamily:'"Open Sans", sans-serif',actorFontWeight:400,noteFontSize:14,noteFontFamily:'"trebuchet ms", verdana, arial, sans-serif',noteFontWeight:400,noteAlign:"center",messageFontSize:16,messageFontFamily:'"trebuchet ms", verdana, arial, sans-serif',messageFontWeight:400,wrap:!1,wrapPadding:10,labelBoxWidth:50,labelBoxHeight:20},gantt:{useMaxWidth:!0,titleTopMargin:25,barHeight:20,barGap:4,topPadding:50,rightPadding:75,leftPadding:75,gridLineStartPadding:35,fontSize:11,sectionFontSize:11,numberSectionStyles:4,axisFormat:"%Y-%m-%d",topAxis:!1,displayMode:"",weekday:"sunday"},journey:{useMaxWidth:!0,diagramMarginX:50,diagramMarginY:10,leftMargin:150,width:150,height:50,boxMargin:10,boxTextMargin:5,noteMargin:10,messageMargin:35,messageAlign:"center",bottomMarginAdj:1,rightAngles:!1,taskFontSize:14,taskFontFamily:'"Open Sans", sans-serif',taskMargin:50,activationWidth:10,textPlacement:"fo",actorColours:["#8FBC8F","#7CFC00","#00FFFF","#20B2AA","#B0E0E6","#FFFFE0"],sectionFills:["#191970","#8B008B","#4B0082","#2F4F4F","#800000","#8B4513","#00008B"],sectionColours:["#fff"]},class:{useMaxWidth:!0,titleTopMargin:25,arrowMarkerAbsolute:!1,dividerMargin:10,padding:5,textHeight:10,defaultRenderer:"dagre-wrapper",htmlLabels:!1,hideEmptyMembersBox:!1},state:{useMaxWidth:!0,titleTopMargin:25,dividerMargin:10,sizeUnit:5,padding:8,textHeight:10,titleShift:-15,noteMargin:10,forkWidth:70,forkHeight:7,miniPadding:2,fontSizeFactor:5.02,fontSize:24,labelHeight:16,edgeLengthFactor:"20",compositTitleSize:35,radius:5,defaultRenderer:"dagre-wrapper"},er:{useMaxWidth:!0,titleTopMargin:25,diagramPadding:20,layoutDirection:"TB",minEntityWidth:100,minEntityHeight:75,entityPadding:15,nodeSpacing:140,rankSpacing:80,stroke:"gray",fill:"honeydew",fontSize:12},pie:{useMaxWidth:!0,textPosition:.75},quadrantChart:{useMaxWidth:!0,chartWidth:500,chartHeight:500,titleFontSize:20,titlePadding:10,quadrantPadding:5,xAxisLabelPadding:5,yAxisLabelPadding:5,xAxisLabelFontSize:16,yAxisLabelFontSize:16,quadrantLabelFontSize:16,quadrantTextTopPadding:5,pointTextPadding:5,pointLabelFontSize:12,pointRadius:5,xAxisPosition:"top",yAxisPosition:"left",quadrantInternalBorderStrokeWidth:1,quadrantExternalBorderStrokeWidth:2},xyChart:{useMaxWidth:!0,width:700,height:500,titleFontSize:20,titlePadding:10,showTitle:!0,xAxis:{$ref:"#/$defs/XYChartAxisConfig",showLabel:!0,labelFontSize:14,labelPadding:5,showTitle:!0,titleFontSize:16,titlePadding:5,showTick:!0,tickLength:5,tickWidth:2,showAxisLine:!0,axisLineWidth:2},yAxis:{$ref:"#/$defs/XYChartAxisConfig",showLabel:!0,labelFontSize:14,labelPadding:5,showTitle:!0,titleFontSize:16,titlePadding:5,showTick:!0,tickLength:5,tickWidth:2,showAxisLine:!0,axisLineWidth:2},chartOrientation:"vertical",plotReservedSpacePercent:50},requirement:{useMaxWidth:!0,rect_fill:"#f9f9f9",text_color:"#333",rect_border_size:"0.5px",rect_border_color:"#bbb",rect_min_width:200,rect_min_height:200,fontSize:14,rect_padding:10,line_height:20},mindmap:{useMaxWidth:!0,padding:10,maxNodeWidth:200},kanban:{useMaxWidth:!0,padding:8,sectionWidth:200,ticketBaseUrl:""},timeline:{useMaxWidth:!0,diagramMarginX:50,diagramMarginY:10,leftMargin:150,width:150,height:50,boxMargin:10,boxTextMargin:5,noteMargin:10,messageMargin:35,messageAlign:"center",bottomMarginAdj:1,rightAngles:!1,taskFontSize:14,taskFontFamily:'"Open Sans", sans-serif',taskMargin:50,activationWidth:10,textPlacement:"fo",actorColours:["#8FBC8F","#7CFC00","#00FFFF","#20B2AA","#B0E0E6","#FFFFE0"],sectionFills:["#191970","#8B008B","#4B0082","#2F4F4F","#800000","#8B4513","#00008B"],sectionColours:["#fff"],disableMulticolor:!1},gitGraph:{useMaxWidth:!0,titleTopMargin:25,diagramPadding:8,nodeLabel:{width:75,height:100,x:-25,y:0},mainBranchName:"main",mainBranchOrder:0,showCommitLabel:!0,showBranches:!0,rotateCommitLabel:!0,parallelCommits:!1,arrowMarkerAbsolute:!1},c4:{useMaxWidth:!0,diagramMarginX:50,diagramMarginY:10,c4ShapeMargin:50,c4ShapePadding:20,width:216,height:60,boxMargin:10,c4ShapeInRow:4,nextLinePaddingX:0,c4BoundaryInRow:2,personFontSize:14,personFontFamily:'"Open Sans", sans-serif',personFontWeight:"normal",external_personFontSize:14,external_personFontFamily:'"Open Sans", sans-serif',external_personFontWeight:"normal",systemFontSize:14,systemFontFamily:'"Open Sans", sans-serif',systemFontWeight:"normal",external_systemFontSize:14,external_systemFontFamily:'"Open Sans", sans-serif',external_systemFontWeight:"normal",system_dbFontSize:14,system_dbFontFamily:'"Open Sans", sans-serif',system_dbFontWeight:"normal",external_system_dbFontSize:14,external_system_dbFontFamily:'"Open Sans", sans-serif',external_system_dbFontWeight:"normal",system_queueFontSize:14,system_queueFontFamily:'"Open Sans", sans-serif',system_queueFontWeight:"normal",external_system_queueFontSize:14,external_system_queueFontFamily:'"Open Sans", sans-serif',external_system_queueFontWeight:"normal",boundaryFontSize:14,boundaryFontFamily:'"Open Sans", sans-serif',boundaryFontWeight:"normal",messageFontSize:12,messageFontFamily:'"Open Sans", sans-serif',messageFontWeight:"normal",containerFontSize:14,containerFontFamily:'"Open Sans", sans-serif',containerFontWeight:"normal",external_containerFontSize:14,external_containerFontFamily:'"Open Sans", sans-serif',external_containerFontWeight:"normal",container_dbFontSize:14,container_dbFontFamily:'"Open Sans", sans-serif',container_dbFontWeight:"normal",external_container_dbFontSize:14,external_container_dbFontFamily:'"Open Sans", sans-serif',external_container_dbFontWeight:"normal",container_queueFontSize:14,container_queueFontFamily:'"Open Sans", sans-serif',container_queueFontWeight:"normal",external_container_queueFontSize:14,external_container_queueFontFamily:'"Open Sans", sans-serif',external_container_queueFontWeight:"normal",componentFontSize:14,componentFontFamily:'"Open Sans", sans-serif',componentFontWeight:"normal",external_componentFontSize:14,external_componentFontFamily:'"Open Sans", sans-serif',external_componentFontWeight:"normal",component_dbFontSize:14,component_dbFontFamily:'"Open Sans", sans-serif',component_dbFontWeight:"normal",external_component_dbFontSize:14,external_component_dbFontFamily:'"Open Sans", sans-serif',external_component_dbFontWeight:"normal",component_queueFontSize:14,component_queueFontFamily:'"Open Sans", sans-serif',component_queueFontWeight:"normal",external_component_queueFontSize:14,external_component_queueFontFamily:'"Open Sans", sans-serif',external_component_queueFontWeight:"normal",wrap:!0,wrapPadding:10,person_bg_color:"#08427B",person_border_color:"#073B6F",external_person_bg_color:"#686868",external_person_border_color:"#8A8A8A",system_bg_color:"#1168BD",system_border_color:"#3C7FC0",system_db_bg_color:"#1168BD",system_db_border_color:"#3C7FC0",system_queue_bg_color:"#1168BD",system_queue_border_color:"#3C7FC0",external_system_bg_color:"#999999",external_system_border_color:"#8A8A8A",external_system_db_bg_color:"#999999",external_system_db_border_color:"#8A8A8A",external_system_queue_bg_color:"#999999",external_system_queue_border_color:"#8A8A8A",container_bg_color:"#438DD5",container_border_color:"#3C7FC0",container_db_bg_color:"#438DD5",container_db_border_color:"#3C7FC0",container_queue_bg_color:"#438DD5",container_queue_border_color:"#3C7FC0",external_container_bg_color:"#B3B3B3",external_container_border_color:"#A6A6A6",external_container_db_bg_color:"#B3B3B3",external_container_db_border_color:"#A6A6A6",external_container_queue_bg_color:"#B3B3B3",external_container_queue_border_color:"#A6A6A6",component_bg_color:"#85BBF0",component_border_color:"#78A8D8",component_db_bg_color:"#85BBF0",component_db_border_color:"#78A8D8",component_queue_bg_color:"#85BBF0",component_queue_border_color:"#78A8D8",external_component_bg_color:"#CCCCCC",external_component_border_color:"#BFBFBF",external_component_db_bg_color:"#CCCCCC",external_component_db_border_color:"#BFBFBF",external_component_queue_bg_color:"#CCCCCC",external_component_queue_border_color:"#BFBFBF"},sankey:{useMaxWidth:!0,width:600,height:400,linkColor:"gradient",nodeAlignment:"justify",showValues:!0,prefix:"",suffix:""},block:{useMaxWidth:!0,padding:8},packet:{useMaxWidth:!0,rowHeight:32,bitWidth:32,bitsPerRow:32,showBits:!0,paddingX:5,paddingY:5},architecture:{useMaxWidth:!0,padding:40,iconSize:80,fontSize:16},radar:{useMaxWidth:!0,width:600,height:600,marginTop:50,marginRight:50,marginBottom:50,marginLeft:50,axisScaleFactor:1,axisLabelFactor:1.05,curveTension:.17},theme:"default",look:"classic",handDrawnSeed:0,layout:"dagre",maxTextSize:5e4,maxEdges:500,darkMode:!1,fontFamily:'"trebuchet ms", verdana, arial, sans-serif;',logLevel:5,securityLevel:"strict",startOnLoad:!0,arrowMarkerAbsolute:!1,secure:["secure","securityLevel","startOnLoad","maxTextSize","suppressErrorRendering","maxEdges"],legacyMathML:!1,forceLegacyMathML:!1,deterministicIds:!1,fontSize:16,markdownAutoWrap:!0,suppressErrorRendering:!1},hae={...jd,deterministicIDSeed:void 0,elk:{mergeEdges:!1,nodePlacementStrategy:"BRANDES_KOEPF"},themeCSS:void 0,themeVariables:tf.default.getThemeVariables(),sequence:{...jd.sequence,messageFont:ie(function(){return{fontFamily:this.messageFontFamily,fontSize:this.messageFontSize,fontWeight:this.messageFontWeight}},"messageFont"),noteFont:ie(function(){return{fontFamily:this.noteFontFamily,fontSize:this.noteFontSize,fontWeight:this.noteFontWeight}},"noteFont"),actorFont:ie(function(){return{fontFamily:this.actorFontFamily,fontSize:this.actorFontSize,fontWeight:this.actorFontWeight}},"actorFont")},class:{hideEmptyMembersBox:!1},gantt:{...jd.gantt,tickInterval:void 0,useWidth:void 0},c4:{...jd.c4,useWidth:void 0,personFont:ie(function(){return{fontFamily:this.personFontFamily,fontSize:this.personFontSize,fontWeight:this.personFontWeight}},"personFont"),external_personFont:ie(function(){return{fontFamily:this.external_personFontFamily,fontSize:this.external_personFontSize,fontWeight:this.external_personFontWeight}},"external_personFont"),systemFont:ie(function(){return{fontFamily:this.systemFontFamily,fontSize:this.systemFontSize,fontWeight:this.systemFontWeight}},"systemFont"),external_systemFont:ie(function(){return{fontFamily:this.external_systemFontFamily,fontSize:this.external_systemFontSize,fontWeight:this.external_systemFontWeight}},"external_systemFont"),system_dbFont:ie(function(){return{fontFamily:this.system_dbFontFamily,fontSize:this.system_dbFontSize,fontWeight:this.system_dbFontWeight}},"system_dbFont"),external_system_dbFont:ie(function(){return{fontFamily:this.external_system_dbFontFamily,fontSize:this.external_system_dbFontSize,fontWeight:this.external_system_dbFontWeight}},"external_system_dbFont"),system_queueFont:ie(function(){return{fontFamily:this.system_queueFontFamily,fontSize:this.system_queueFontSize,fontWeight:this.system_queueFontWeight}},"system_queueFont"),external_system_queueFont:ie(function(){return{fontFamily:this.external_system_queueFontFamily,fontSize:this.external_system_queueFontSize,fontWeight:this.external_system_queueFontWeight}},"external_system_queueFont"),containerFont:ie(function(){return{fontFamily:this.containerFontFamily,fontSize:this.containerFontSize,fontWeight:this.containerFontWeight}},"containerFont"),external_containerFont:ie(function(){return{fontFamily:this.external_containerFontFamily,fontSize:this.external_containerFontSize,fontWeight:this.external_containerFontWeight}},"external_containerFont"),container_dbFont:ie(function(){return{fontFamily:this.container_dbFontFamily,fontSize:this.container_dbFontSize,fontWeight:this.container_dbFontWeight}},"container_dbFont"),external_container_dbFont:ie(function(){return{fontFamily:this.external_container_dbFontFamily,fontSize:this.external_container_dbFontSize,fontWeight:this.external_container_dbFontWeight}},"external_container_dbFont"),container_queueFont:ie(function(){return{fontFamily:this.container_queueFontFamily,fontSize:this.container_queueFontSize,fontWeight:this.container_queueFontWeight}},"container_queueFont"),external_container_queueFont:ie(function(){return{fontFamily:this.external_container_queueFontFamily,fontSize:this.external_container_queueFontSize,fontWeight:this.external_container_queueFontWeight}},"external_container_queueFont"),componentFont:ie(function(){return{fontFamily:this.componentFontFamily,fontSize:this.componentFontSize,fontWeight:this.componentFontWeight}},"componentFont"),external_componentFont:ie(function(){return{fontFamily:this.external_componentFontFamily,fontSize:this.external_componentFontSize,fontWeight:this.external_componentFontWeight}},"external_componentFont"),component_dbFont:ie(function(){return{fontFamily:this.component_dbFontFamily,fontSize:this.component_dbFontSize,fontWeight:this.component_dbFontWeight}},"component_dbFont"),external_component_dbFont:ie(function(){return{fontFamily:this.external_component_dbFontFamily,fontSize:this.external_component_dbFontSize,fontWeight:this.external_component_dbFontWeight}},"external_component_dbFont"),component_queueFont:ie(function(){return{fontFamily:this.component_queueFontFamily,fontSize:this.component_queueFontSize,fontWeight:this.component_queueFontWeight}},"component_queueFont"),external_component_queueFont:ie(function(){return{fontFamily:this.external_component_queueFontFamily,fontSize:this.external_component_queueFontSize,fontWeight:this.external_component_queueFontWeight}},"external_component_queueFont"),boundaryFont:ie(function(){return{fontFamily:this.boundaryFontFamily,fontSize:this.boundaryFontSize,fontWeight:this.boundaryFontWeight}},"boundaryFont"),messageFont:ie(function(){return{fontFamily:this.messageFontFamily,fontSize:this.messageFontSize,fontWeight:this.messageFontWeight}},"messageFont")},pie:{...jd.pie,useWidth:984},xyChart:{...jd.xyChart,useWidth:void 0},requirement:{...jd.requirement,useWidth:void 0},packet:{...jd.packet},radar:{...jd.radar}},pae=ie((e,t="")=>Object.keys(e).reduce((n,r)=>Array.isArray(e[r])?n:typeof e[r]=="object"&&e[r]!==null?[...n,t+r,...pae(e[r],"")]:[...n,t+r],[]),"keyify"),tJe=new Set(pae(hae,"")),mae=hae,Wk=ie(e=>{if(qt.debug("sanitizeDirective called with",e),!(typeof e!="object"||e==null)){if(Array.isArray(e)){e.forEach(t=>Wk(t));return}for(const t of Object.keys(e)){if(qt.debug("Checking key",t),t.startsWith("__")||t.includes("proto")||t.includes("constr")||!tJe.has(t)||e[t]==null){qt.debug("sanitize deleting key: ",t),delete e[t];continue}if(typeof e[t]=="object"){qt.debug("sanitizing object",t),Wk(e[t]);continue}const n=["themeCSS","fontFamily","altFontFamily"];for(const r of n)t.includes(r)&&(qt.debug("sanitizing css option",t),e[t]=nJe(e[t]))}if(e.themeVariables)for(const t of Object.keys(e.themeVariables)){const n=e.themeVariables[t];n!=null&&n.match&&!n.match(/^[\d "#%(),.;A-Za-z]+$/)&&(e.themeVariables[t]="")}qt.debug("After sanitization",e)}},"sanitizeDirective"),nJe=ie(e=>{let t=0,n=0;for(const r of e){if(t<n)return"{ /* ERROR: Unbalanced CSS */ }";r==="{"?t++:r==="}"&&n++}return t!==n?"{ /* ERROR: Unbalanced CSS */ }":e},"sanitizeCss"),zy=Object.freeze(mae),Fo=Ra({},zy),gae,Uy=[],Qx=Ra({},zy),uA=ie((e,t)=>{let n=Ra({},e),r={};for(const s of t)vae(s),r=Ra(r,s);if(n=Ra(n,r),r.theme&&r.theme in tf){const s=Ra({},gae),i=Ra(s.themeVariables||{},r.themeVariables);n.theme&&n.theme in tf&&(n.themeVariables=tf[n.theme].getThemeVariables(i))}return Qx=n,xae(Qx),Qx},"updateCurrentConfig"),rJe=ie(e=>(Fo=Ra({},zy),Fo=Ra(Fo,e),e.theme&&tf[e.theme]&&(Fo.themeVariables=tf[e.theme].getThemeVariables(e.themeVariables)),uA(Fo,Uy),Fo),"setSiteConfig"),sJe=ie(e=>{gae=Ra({},e)},"saveConfigFromInitialize"),iJe=ie(e=>(Fo=Ra(Fo,e),uA(Fo,Uy),Fo),"updateSiteConfig"),yae=ie(()=>Ra({},Fo),"getSiteConfig"),bae=ie(e=>(xae(e),Ra(Qx,e),Go()),"setConfig"),Go=ie(()=>Ra({},Qx),"getConfig"),vae=ie(e=>{e&&(["secure",...Fo.secure??[]].forEach(t=>{Object.hasOwn(e,t)&&(qt.debug(`Denied attempt to modify a secure key ${t}`,e[t]),delete e[t])}),Object.keys(e).forEach(t=>{t.startsWith("__")&&delete e[t]}),Object.keys(e).forEach(t=>{typeof e[t]=="string"&&(e[t].includes("<")||e[t].includes(">")||e[t].includes("url(data:"))&&delete e[t],typeof e[t]=="object"&&vae(e[t])}))},"sanitize"),aJe=ie(e=>{var t;Wk(e),e.fontFamily&&!((t=e.themeVariables)!=null&&t.fontFamily)&&(e.themeVariables={...e.themeVariables,fontFamily:e.fontFamily}),Uy.push(e),uA(Fo,Uy)},"addDirective"),Hk=ie((e=Fo)=>{Uy=[],uA(e,Uy)},"reset"),oJe={LAZY_LOAD_DEPRECATED:"The configuration options lazyLoadedDiagrams and loadExternalDiagramsAtStartup are deprecated. Please use registerExternalDiagrams instead."},UV={},lJe=ie(e=>{UV[e]||(qt.warn(oJe[e]),UV[e]=!0)},"issueWarning"),xae=ie(e=>{e&&(e.lazyLoadedDiagrams||e.loadExternalDiagramsAtStartup)&&lJe("LAZY_LOAD_DEPRECATED")},"checkConfig"),_S=/<br\s*\/?>/gi,cJe=ie(e=>e?_ae(e).replace(/\\n/g,"#br#").split("#br#"):[""],"getRows"),uJe=(()=>{let e=!1;return()=>{e||(wae(),e=!0)}})();function wae(){const e="data-temp-href-target";By.addHook("beforeSanitizeAttributes",t=>{t instanceof Element&&t.tagName==="A"&&t.hasAttribute("target")&&t.setAttribute(e,t.getAttribute("target")??"")}),By.addHook("afterSanitizeAttributes",t=>{t instanceof Element&&t.tagName==="A"&&t.hasAttribute(e)&&(t.setAttribute("target",t.getAttribute(e)??""),t.removeAttribute(e),t.getAttribute("target")==="_blank"&&t.setAttribute("rel","noopener"))})}ie(wae,"setupDompurifyHooks");var Sae=ie(e=>(uJe(),By.sanitize(e)),"removeScript"),qV=ie((e,t)=>{var n;if(((n=t.flowchart)==null?void 0:n.htmlLabels)!==!1){const r=t.securityLevel;r==="antiscript"||r==="strict"?e=Sae(e):r!=="loose"&&(e=_ae(e),e=e.replace(/</g,"&lt;").replace(/>/g,"&gt;"),e=e.replace(/=/g,"&equals;"),e=pJe(e))}return e},"sanitizeMore"),qm=ie((e,t)=>e&&(t.dompurifyConfig?e=By.sanitize(qV(e,t),t.dompurifyConfig).toString():e=By.sanitize(qV(e,t),{FORBID_TAGS:["style"]}).toString(),e),"sanitizeText"),dJe=ie((e,t)=>typeof e=="string"?qm(e,t):e.flat().map(n=>qm(n,t)),"sanitizeTextOrArray"),fJe=ie(e=>_S.test(e),"hasBreaks"),hJe=ie(e=>e.split(_S),"splitBreaks"),pJe=ie(e=>e.replace(/#br#/g,"<br/>"),"placeholderToBreak"),_ae=ie(e=>e.replace(_S,"#br#"),"breakToPlaceholder"),mJe=ie(e=>{let t="";return e&&(t=window.location.protocol+"//"+window.location.host+window.location.pathname+window.location.search,t=t.replaceAll(/\(/g,"\\("),t=t.replaceAll(/\)/g,"\\)")),t},"getUrl"),Qi=ie(e=>!(e===!1||["false","null","0"].includes(String(e).trim().toLowerCase())),"evaluate"),gJe=ie(function(...e){const t=e.filter(n=>!isNaN(n));return Math.max(...t)},"getMax"),yJe=ie(function(...e){const t=e.filter(n=>!isNaN(n));return Math.min(...t)},"getMin"),VV=ie(function(e){const t=e.split(/(,)/),n=[];for(let r=0;r<t.length;r++){let s=t[r];if(s===","&&r>0&&r+1<t.length){const i=t[r-1],a=t[r+1];bJe(i,a)&&(s=i+","+a,r++,n.pop())}n.push(vJe(s))}return n.join("")},"parseGenericTypes"),n4=ie((e,t)=>Math.max(0,e.split(t).length-1),"countOccurrence"),bJe=ie((e,t)=>{const n=n4(e,"~"),r=n4(t,"~");return n===1&&r===1},"shouldCombineSets"),vJe=ie(e=>{const t=n4(e,"~");let n=!1;if(t<=1)return e;t%2!==0&&e.startsWith("~")&&(e=e.substring(1),n=!0);const r=[...e];let s=r.indexOf("~"),i=r.lastIndexOf("~");for(;s!==-1&&i!==-1&&s!==i;)r[s]="<",r[i]=">",s=r.indexOf("~"),i=r.lastIndexOf("~");return n&&r.unshift("~"),r.join("")},"processSet"),WV=ie(()=>window.MathMLElement!==void 0,"isMathMLSupported"),r4=/\$\$(.*)\$\$/g,qy=ie(e=>{var t;return(((t=e.match(r4))==null?void 0:t.length)??0)>0},"hasKatex"),Hft=ie(async(e,t)=>{e=await M6(e,t);const n=document.createElement("div");n.innerHTML=e,n.id="katex-temp",n.style.visibility="hidden",n.style.position="absolute",n.style.top="0";const r=document.querySelector("body");r==null||r.insertAdjacentElement("beforeend",n);const s={width:n.clientWidth,height:n.clientHeight};return n.remove(),s},"calculateMathMLDimensions"),M6=ie(async(e,t)=>{if(!qy(e))return e;if(!(WV()||t.legacyMathML||t.forceLegacyMathML))return e.replace(r4,"MathML is unsupported in this environment.");const{default:n}=await Fr(async()=>{const{default:s}=await import("./katex-ChWnQ-fc.js");return{default:s}},[]),r=t.forceLegacyMathML||!WV()&&t.legacyMathML?"htmlAndMathml":"mathml";return e.split(_S).map(s=>qy(s)?`<div style="display: flex; align-items: center; justify-content: center; white-space: nowrap;">${s}</div>`:`<div>${s}</div>`).join("").replace(r4,(s,i)=>n.renderToString(i,{throwOnError:!0,displayMode:!0,output:r}).replace(/\n/g," ").replace(/<annotation.*<\/annotation>/g,""))},"renderKatex"),Ib={getRows:cJe,sanitizeText:qm,sanitizeTextOrArray:dJe,hasBreaks:fJe,splitBreaks:hJe,lineBreakRegex:_S,removeScript:Sae,getUrl:mJe,evaluate:Qi,getMax:gJe,getMin:yJe},xJe=ie(function(e,t){for(let n of t)e.attr(n[0],n[1])},"d3Attrs"),wJe=ie(function(e,t,n){let r=new Map;return n?(r.set("width","100%"),r.set("style",`max-width: ${t}px;`)):(r.set("height",e),r.set("width",t)),r},"calculateSvgSizeAttrs"),Cae=ie(function(e,t,n,r){const s=wJe(t,n,r);xJe(e,s)},"configureSvgSize"),SJe=ie(function(e,t,n,r){const s=t.node().getBBox(),i=s.width,a=s.height;qt.info(`SVG bounds: ${i}x${a}`,s);let o=0,l=0;qt.info(`Graph bounds: ${o}x${l}`,e),o=i+n*2,l=a+n*2,qt.info(`Calculated bounds: ${o}x${l}`),Cae(t,l,o,r);const c=`${s.x-n} ${s.y-n} ${s.width+2*n} ${s.height+2*n}`;t.attr("viewBox",c)},"setupGraphViewbox"),a2={},_Je=ie((e,t,n)=>{let r="";return e in a2&&a2[e]?r=a2[e](n):qt.warn(`No theme found for ${e}`),` & {
    font-family: ${n.fontFamily};
    font-size: ${n.fontSize};
    fill: ${n.textColor}
  }
  @keyframes edge-animation-frame {
    from {
      stroke-dashoffset: 0;
    }
  }
  @keyframes dash {
    to {
      stroke-dashoffset: 0;
    }
  }
  & .edge-animation-slow {
    stroke-dasharray: 9,5 !important;
    stroke-dashoffset: 900;
    animation: dash 50s linear infinite;
    stroke-linecap: round;
  }
  & .edge-animation-fast {
    stroke-dasharray: 9,5 !important;
    stroke-dashoffset: 900;
    animation: dash 20s linear infinite;
    stroke-linecap: round;
  }
  /* Classes common for multiple diagrams */

  & .error-icon {
    fill: ${n.errorBkgColor};
  }
  & .error-text {
    fill: ${n.errorTextColor};
    stroke: ${n.errorTextColor};
  }

  & .edge-thickness-normal {
    stroke-width: 1px;
  }
  & .edge-thickness-thick {
    stroke-width: 3.5px
  }
  & .edge-pattern-solid {
    stroke-dasharray: 0;
  }
  & .edge-thickness-invisible {
    stroke-width: 0;
    fill: none;
  }
  & .edge-pattern-dashed{
    stroke-dasharray: 3;
  }
  .edge-pattern-dotted {
    stroke-dasharray: 2;
  }

  & .marker {
    fill: ${n.lineColor};
    stroke: ${n.lineColor};
  }
  & .marker.cross {
    stroke: ${n.lineColor};
  }

  & svg {
    font-family: ${n.fontFamily};
    font-size: ${n.fontSize};
  }
   & p {
    margin: 0
   }

  ${r}

  ${t}
`},"getStyles"),CJe=ie((e,t)=>{t!==void 0&&(a2[e]=t)},"addStylesForDiagram"),kJe=_Je,kae={};UXe(kae,{clear:()=>EJe,getAccDescription:()=>NJe,getAccTitle:()=>AJe,getDiagramTitle:()=>MJe,setAccDescription:()=>RJe,setAccTitle:()=>TJe,setDiagramTitle:()=>IJe});var j6="",P6="",O6="",D6=ie(e=>qm(e,Go()),"sanitizeText"),EJe=ie(()=>{j6="",O6="",P6=""},"clear"),TJe=ie(e=>{j6=D6(e).replace(/^\s+/g,"")},"setAccTitle"),AJe=ie(()=>j6,"getAccTitle"),RJe=ie(e=>{O6=D6(e).replace(/\n\s+/g,`
`)},"setAccDescription"),NJe=ie(()=>O6,"getAccDescription"),IJe=ie(e=>{P6=D6(e)},"setDiagramTitle"),MJe=ie(()=>P6,"getDiagramTitle"),HV=qt,jJe=N6,ls=Go,Gft=bae,Kft=zy,F6=ie(e=>qm(e,ls()),"sanitizeText"),PJe=SJe,OJe=ie(()=>kae,"getCommonDb"),Gk={},Kk=ie((e,t,n)=>{var r;Gk[e]&&HV.warn(`Diagram with id ${e} already registered. Overwriting.`),Gk[e]=t,n&&fae(e,n),CJe(e,t.styles),(r=t.injectUtils)==null||r.call(t,HV,jJe,ls,F6,PJe,OJe(),()=>{})},"registerDiagram"),s4=ie(e=>{if(e in Gk)return Gk[e];throw new DJe(e)},"getDiagram"),oy,DJe=(oy=class extends Error{constructor(t){super(`Diagram ${t} not found.`)}},ie(oy,"DiagramNotFoundError"),oy);function L6(e){return typeof e>"u"||e===null}ie(L6,"isNothing");function Eae(e){return typeof e=="object"&&e!==null}ie(Eae,"isObject");function Tae(e){return Array.isArray(e)?e:L6(e)?[]:[e]}ie(Tae,"toArray");function Aae(e,t){var n,r,s,i;if(t)for(i=Object.keys(t),n=0,r=i.length;n<r;n+=1)s=i[n],e[s]=t[s];return e}ie(Aae,"extend");function Rae(e,t){var n="",r;for(r=0;r<t;r+=1)n+=e;return n}ie(Rae,"repeat");function Nae(e){return e===0&&Number.NEGATIVE_INFINITY===1/e}ie(Nae,"isNegativeZero");var FJe=L6,LJe=Eae,BJe=Tae,$Je=Rae,zJe=Nae,UJe=Aae,Zi={isNothing:FJe,isObject:LJe,toArray:BJe,repeat:$Je,isNegativeZero:zJe,extend:UJe};function B6(e,t){var n="",r=e.reason||"(unknown reason)";return e.mark?(e.mark.name&&(n+='in "'+e.mark.name+'" '),n+="("+(e.mark.line+1)+":"+(e.mark.column+1)+")",!t&&e.mark.snippet&&(n+=`

`+e.mark.snippet),r+" "+n):r}ie(B6,"formatError");function Vy(e,t){Error.call(this),this.name="YAMLException",this.reason=e,this.mark=t,this.message=B6(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack||""}ie(Vy,"YAMLException$1");Vy.prototype=Object.create(Error.prototype);Vy.prototype.constructor=Vy;Vy.prototype.toString=ie(function(t){return this.name+": "+B6(this,t)},"toString");var zo=Vy;function o2(e,t,n,r,s){var i="",a="",o=Math.floor(s/2)-1;return r-t>o&&(i=" ... ",t=r-o+i.length),n-r>o&&(a=" ...",n=r+o-a.length),{str:i+e.slice(t,n).replace(/\t/g,"→")+a,pos:r-t+i.length}}ie(o2,"getLine");function l2(e,t){return Zi.repeat(" ",t-e.length)+e}ie(l2,"padStart");function Iae(e,t){if(t=Object.create(t||null),!e.buffer)return null;t.maxLength||(t.maxLength=79),typeof t.indent!="number"&&(t.indent=1),typeof t.linesBefore!="number"&&(t.linesBefore=3),typeof t.linesAfter!="number"&&(t.linesAfter=2);for(var n=/\r?\n|\r|\0/g,r=[0],s=[],i,a=-1;i=n.exec(e.buffer);)s.push(i.index),r.push(i.index+i[0].length),e.position<=i.index&&a<0&&(a=r.length-2);a<0&&(a=r.length-1);var o="",l,c,u=Math.min(e.line+t.linesAfter,s.length).toString().length,d=t.maxLength-(t.indent+u+3);for(l=1;l<=t.linesBefore&&!(a-l<0);l++)c=o2(e.buffer,r[a-l],s[a-l],e.position-(r[a]-r[a-l]),d),o=Zi.repeat(" ",t.indent)+l2((e.line-l+1).toString(),u)+" | "+c.str+`
`+o;for(c=o2(e.buffer,r[a],s[a],e.position,d),o+=Zi.repeat(" ",t.indent)+l2((e.line+1).toString(),u)+" | "+c.str+`
`,o+=Zi.repeat("-",t.indent+u+3+c.pos)+`^
`,l=1;l<=t.linesAfter&&!(a+l>=s.length);l++)c=o2(e.buffer,r[a+l],s[a+l],e.position-(r[a]-r[a+l]),d),o+=Zi.repeat(" ",t.indent)+l2((e.line+l+1).toString(),u)+" | "+c.str+`
`;return o.replace(/\n$/,"")}ie(Iae,"makeSnippet");var qJe=Iae,VJe=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],WJe=["scalar","sequence","mapping"];function Mae(e){var t={};return e!==null&&Object.keys(e).forEach(function(n){e[n].forEach(function(r){t[String(r)]=n})}),t}ie(Mae,"compileStyleAliases");function jae(e,t){if(t=t||{},Object.keys(t).forEach(function(n){if(VJe.indexOf(n)===-1)throw new zo('Unknown option "'+n+'" is met in definition of "'+e+'" YAML type.')}),this.options=t,this.tag=e,this.kind=t.kind||null,this.resolve=t.resolve||function(){return!0},this.construct=t.construct||function(n){return n},this.instanceOf=t.instanceOf||null,this.predicate=t.predicate||null,this.represent=t.represent||null,this.representName=t.representName||null,this.defaultStyle=t.defaultStyle||null,this.multi=t.multi||!1,this.styleAliases=Mae(t.styleAliases||null),WJe.indexOf(this.kind)===-1)throw new zo('Unknown kind "'+this.kind+'" is specified for "'+e+'" YAML type.')}ie(jae,"Type$1");var Wa=jae;function i4(e,t){var n=[];return e[t].forEach(function(r){var s=n.length;n.forEach(function(i,a){i.tag===r.tag&&i.kind===r.kind&&i.multi===r.multi&&(s=a)}),n[s]=r}),n}ie(i4,"compileList");function Pae(){var e={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}},t,n;function r(s){s.multi?(e.multi[s.kind].push(s),e.multi.fallback.push(s)):e[s.kind][s.tag]=e.fallback[s.tag]=s}for(ie(r,"collectType"),t=0,n=arguments.length;t<n;t+=1)arguments[t].forEach(r);return e}ie(Pae,"compileMap");function Yk(e){return this.extend(e)}ie(Yk,"Schema$1");Yk.prototype.extend=ie(function(t){var n=[],r=[];if(t instanceof Wa)r.push(t);else if(Array.isArray(t))r=r.concat(t);else if(t&&(Array.isArray(t.implicit)||Array.isArray(t.explicit)))t.implicit&&(n=n.concat(t.implicit)),t.explicit&&(r=r.concat(t.explicit));else throw new zo("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");n.forEach(function(i){if(!(i instanceof Wa))throw new zo("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(i.loadKind&&i.loadKind!=="scalar")throw new zo("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(i.multi)throw new zo("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")}),r.forEach(function(i){if(!(i instanceof Wa))throw new zo("Specified list of YAML types (or a single Type object) contains a non-Type object.")});var s=Object.create(Yk.prototype);return s.implicit=(this.implicit||[]).concat(n),s.explicit=(this.explicit||[]).concat(r),s.compiledImplicit=i4(s,"implicit"),s.compiledExplicit=i4(s,"explicit"),s.compiledTypeMap=Pae(s.compiledImplicit,s.compiledExplicit),s},"extend");var HJe=Yk,GJe=new Wa("tag:yaml.org,2002:str",{kind:"scalar",construct:ie(function(e){return e!==null?e:""},"construct")}),KJe=new Wa("tag:yaml.org,2002:seq",{kind:"sequence",construct:ie(function(e){return e!==null?e:[]},"construct")}),YJe=new Wa("tag:yaml.org,2002:map",{kind:"mapping",construct:ie(function(e){return e!==null?e:{}},"construct")}),ZJe=new HJe({explicit:[GJe,KJe,YJe]});function Oae(e){if(e===null)return!0;var t=e.length;return t===1&&e==="~"||t===4&&(e==="null"||e==="Null"||e==="NULL")}ie(Oae,"resolveYamlNull");function Dae(){return null}ie(Dae,"constructYamlNull");function Fae(e){return e===null}ie(Fae,"isNull");var XJe=new Wa("tag:yaml.org,2002:null",{kind:"scalar",resolve:Oae,construct:Dae,predicate:Fae,represent:{canonical:ie(function(){return"~"},"canonical"),lowercase:ie(function(){return"null"},"lowercase"),uppercase:ie(function(){return"NULL"},"uppercase"),camelcase:ie(function(){return"Null"},"camelcase"),empty:ie(function(){return""},"empty")},defaultStyle:"lowercase"});function Lae(e){if(e===null)return!1;var t=e.length;return t===4&&(e==="true"||e==="True"||e==="TRUE")||t===5&&(e==="false"||e==="False"||e==="FALSE")}ie(Lae,"resolveYamlBoolean");function Bae(e){return e==="true"||e==="True"||e==="TRUE"}ie(Bae,"constructYamlBoolean");function $ae(e){return Object.prototype.toString.call(e)==="[object Boolean]"}ie($ae,"isBoolean");var JJe=new Wa("tag:yaml.org,2002:bool",{kind:"scalar",resolve:Lae,construct:Bae,predicate:$ae,represent:{lowercase:ie(function(e){return e?"true":"false"},"lowercase"),uppercase:ie(function(e){return e?"TRUE":"FALSE"},"uppercase"),camelcase:ie(function(e){return e?"True":"False"},"camelcase")},defaultStyle:"lowercase"});function zae(e){return 48<=e&&e<=57||65<=e&&e<=70||97<=e&&e<=102}ie(zae,"isHexCode");function Uae(e){return 48<=e&&e<=55}ie(Uae,"isOctCode");function qae(e){return 48<=e&&e<=57}ie(qae,"isDecCode");function Vae(e){if(e===null)return!1;var t=e.length,n=0,r=!1,s;if(!t)return!1;if(s=e[n],(s==="-"||s==="+")&&(s=e[++n]),s==="0"){if(n+1===t)return!0;if(s=e[++n],s==="b"){for(n++;n<t;n++)if(s=e[n],s!=="_"){if(s!=="0"&&s!=="1")return!1;r=!0}return r&&s!=="_"}if(s==="x"){for(n++;n<t;n++)if(s=e[n],s!=="_"){if(!zae(e.charCodeAt(n)))return!1;r=!0}return r&&s!=="_"}if(s==="o"){for(n++;n<t;n++)if(s=e[n],s!=="_"){if(!Uae(e.charCodeAt(n)))return!1;r=!0}return r&&s!=="_"}}if(s==="_")return!1;for(;n<t;n++)if(s=e[n],s!=="_"){if(!qae(e.charCodeAt(n)))return!1;r=!0}return!(!r||s==="_")}ie(Vae,"resolveYamlInteger");function Wae(e){var t=e,n=1,r;if(t.indexOf("_")!==-1&&(t=t.replace(/_/g,"")),r=t[0],(r==="-"||r==="+")&&(r==="-"&&(n=-1),t=t.slice(1),r=t[0]),t==="0")return 0;if(r==="0"){if(t[1]==="b")return n*parseInt(t.slice(2),2);if(t[1]==="x")return n*parseInt(t.slice(2),16);if(t[1]==="o")return n*parseInt(t.slice(2),8)}return n*parseInt(t,10)}ie(Wae,"constructYamlInteger");function Hae(e){return Object.prototype.toString.call(e)==="[object Number]"&&e%1===0&&!Zi.isNegativeZero(e)}ie(Hae,"isInteger");var QJe=new Wa("tag:yaml.org,2002:int",{kind:"scalar",resolve:Vae,construct:Wae,predicate:Hae,represent:{binary:ie(function(e){return e>=0?"0b"+e.toString(2):"-0b"+e.toString(2).slice(1)},"binary"),octal:ie(function(e){return e>=0?"0o"+e.toString(8):"-0o"+e.toString(8).slice(1)},"octal"),decimal:ie(function(e){return e.toString(10)},"decimal"),hexadecimal:ie(function(e){return e>=0?"0x"+e.toString(16).toUpperCase():"-0x"+e.toString(16).toUpperCase().slice(1)},"hexadecimal")},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),eQe=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$");function Gae(e){return!(e===null||!eQe.test(e)||e[e.length-1]==="_")}ie(Gae,"resolveYamlFloat");function Kae(e){var t,n;return t=e.replace(/_/g,"").toLowerCase(),n=t[0]==="-"?-1:1,"+-".indexOf(t[0])>=0&&(t=t.slice(1)),t===".inf"?n===1?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:t===".nan"?NaN:n*parseFloat(t,10)}ie(Kae,"constructYamlFloat");var tQe=/^[-+]?[0-9]+e/;function Yae(e,t){var n;if(isNaN(e))switch(t){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===e)switch(t){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===e)switch(t){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(Zi.isNegativeZero(e))return"-0.0";return n=e.toString(10),tQe.test(n)?n.replace("e",".e"):n}ie(Yae,"representYamlFloat");function Zae(e){return Object.prototype.toString.call(e)==="[object Number]"&&(e%1!==0||Zi.isNegativeZero(e))}ie(Zae,"isFloat");var nQe=new Wa("tag:yaml.org,2002:float",{kind:"scalar",resolve:Gae,construct:Kae,predicate:Zae,represent:Yae,defaultStyle:"lowercase"}),Xae=ZJe.extend({implicit:[XJe,JJe,QJe,nQe]}),rQe=Xae,Jae=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),Qae=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$");function eoe(e){return e===null?!1:Jae.exec(e)!==null||Qae.exec(e)!==null}ie(eoe,"resolveYamlTimestamp");function toe(e){var t,n,r,s,i,a,o,l=0,c=null,u,d,h;if(t=Jae.exec(e),t===null&&(t=Qae.exec(e)),t===null)throw new Error("Date resolve error");if(n=+t[1],r=+t[2]-1,s=+t[3],!t[4])return new Date(Date.UTC(n,r,s));if(i=+t[4],a=+t[5],o=+t[6],t[7]){for(l=t[7].slice(0,3);l.length<3;)l+="0";l=+l}return t[9]&&(u=+t[10],d=+(t[11]||0),c=(u*60+d)*6e4,t[9]==="-"&&(c=-c)),h=new Date(Date.UTC(n,r,s,i,a,o,l)),c&&h.setTime(h.getTime()-c),h}ie(toe,"constructYamlTimestamp");function noe(e){return e.toISOString()}ie(noe,"representYamlTimestamp");var sQe=new Wa("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:eoe,construct:toe,instanceOf:Date,represent:noe});function roe(e){return e==="<<"||e===null}ie(roe,"resolveYamlMerge");var iQe=new Wa("tag:yaml.org,2002:merge",{kind:"scalar",resolve:roe}),$6=`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=
\r`;function soe(e){if(e===null)return!1;var t,n,r=0,s=e.length,i=$6;for(n=0;n<s;n++)if(t=i.indexOf(e.charAt(n)),!(t>64)){if(t<0)return!1;r+=6}return r%8===0}ie(soe,"resolveYamlBinary");function ioe(e){var t,n,r=e.replace(/[\r\n=]/g,""),s=r.length,i=$6,a=0,o=[];for(t=0;t<s;t++)t%4===0&&t&&(o.push(a>>16&255),o.push(a>>8&255),o.push(a&255)),a=a<<6|i.indexOf(r.charAt(t));return n=s%4*6,n===0?(o.push(a>>16&255),o.push(a>>8&255),o.push(a&255)):n===18?(o.push(a>>10&255),o.push(a>>2&255)):n===12&&o.push(a>>4&255),new Uint8Array(o)}ie(ioe,"constructYamlBinary");function aoe(e){var t="",n=0,r,s,i=e.length,a=$6;for(r=0;r<i;r++)r%3===0&&r&&(t+=a[n>>18&63],t+=a[n>>12&63],t+=a[n>>6&63],t+=a[n&63]),n=(n<<8)+e[r];return s=i%3,s===0?(t+=a[n>>18&63],t+=a[n>>12&63],t+=a[n>>6&63],t+=a[n&63]):s===2?(t+=a[n>>10&63],t+=a[n>>4&63],t+=a[n<<2&63],t+=a[64]):s===1&&(t+=a[n>>2&63],t+=a[n<<4&63],t+=a[64],t+=a[64]),t}ie(aoe,"representYamlBinary");function ooe(e){return Object.prototype.toString.call(e)==="[object Uint8Array]"}ie(ooe,"isBinary");var aQe=new Wa("tag:yaml.org,2002:binary",{kind:"scalar",resolve:soe,construct:ioe,predicate:ooe,represent:aoe}),oQe=Object.prototype.hasOwnProperty,lQe=Object.prototype.toString;function loe(e){if(e===null)return!0;var t=[],n,r,s,i,a,o=e;for(n=0,r=o.length;n<r;n+=1){if(s=o[n],a=!1,lQe.call(s)!=="[object Object]")return!1;for(i in s)if(oQe.call(s,i))if(!a)a=!0;else return!1;if(!a)return!1;if(t.indexOf(i)===-1)t.push(i);else return!1}return!0}ie(loe,"resolveYamlOmap");function coe(e){return e!==null?e:[]}ie(coe,"constructYamlOmap");var cQe=new Wa("tag:yaml.org,2002:omap",{kind:"sequence",resolve:loe,construct:coe}),uQe=Object.prototype.toString;function uoe(e){if(e===null)return!0;var t,n,r,s,i,a=e;for(i=new Array(a.length),t=0,n=a.length;t<n;t+=1){if(r=a[t],uQe.call(r)!=="[object Object]"||(s=Object.keys(r),s.length!==1))return!1;i[t]=[s[0],r[s[0]]]}return!0}ie(uoe,"resolveYamlPairs");function doe(e){if(e===null)return[];var t,n,r,s,i,a=e;for(i=new Array(a.length),t=0,n=a.length;t<n;t+=1)r=a[t],s=Object.keys(r),i[t]=[s[0],r[s[0]]];return i}ie(doe,"constructYamlPairs");var dQe=new Wa("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:uoe,construct:doe}),fQe=Object.prototype.hasOwnProperty;function foe(e){if(e===null)return!0;var t,n=e;for(t in n)if(fQe.call(n,t)&&n[t]!==null)return!1;return!0}ie(foe,"resolveYamlSet");function hoe(e){return e!==null?e:{}}ie(hoe,"constructYamlSet");var hQe=new Wa("tag:yaml.org,2002:set",{kind:"mapping",resolve:foe,construct:hoe}),poe=rQe.extend({implicit:[sQe,iQe],explicit:[aQe,cQe,dQe,hQe]}),Xh=Object.prototype.hasOwnProperty,Zk=1,moe=2,goe=3,Xk=4,$j=1,pQe=2,GV=3,mQe=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,gQe=/[\x85\u2028\u2029]/,yQe=/[,\[\]\{\}]/,yoe=/^(?:!|!!|![a-z\-]+!)$/i,boe=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function a4(e){return Object.prototype.toString.call(e)}ie(a4,"_class");function zc(e){return e===10||e===13}ie(zc,"is_EOL");function Nh(e){return e===9||e===32}ie(Nh,"is_WHITE_SPACE");function oo(e){return e===9||e===32||e===10||e===13}ie(oo,"is_WS_OR_EOL");function gm(e){return e===44||e===91||e===93||e===123||e===125}ie(gm,"is_FLOW_INDICATOR");function voe(e){var t;return 48<=e&&e<=57?e-48:(t=e|32,97<=t&&t<=102?t-97+10:-1)}ie(voe,"fromHexCode");function xoe(e){return e===120?2:e===117?4:e===85?8:0}ie(xoe,"escapedHexLen");function woe(e){return 48<=e&&e<=57?e-48:-1}ie(woe,"fromDecimalCode");function o4(e){return e===48?"\0":e===97?"\x07":e===98?"\b":e===116||e===9?"	":e===110?`
`:e===118?"\v":e===102?"\f":e===114?"\r":e===101?"\x1B":e===32?" ":e===34?'"':e===47?"/":e===92?"\\":e===78?"":e===95?" ":e===76?"\u2028":e===80?"\u2029":""}ie(o4,"simpleEscapeSequence");function Soe(e){return e<=65535?String.fromCharCode(e):String.fromCharCode((e-65536>>10)+55296,(e-65536&1023)+56320)}ie(Soe,"charFromCodepoint");var _oe=new Array(256),Coe=new Array(256);for(Qp=0;Qp<256;Qp++)_oe[Qp]=o4(Qp)?1:0,Coe[Qp]=o4(Qp);var Qp;function koe(e,t){this.input=e,this.filename=t.filename||null,this.schema=t.schema||poe,this.onWarning=t.onWarning||null,this.legacy=t.legacy||!1,this.json=t.json||!1,this.listener=t.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=e.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}ie(koe,"State$1");function z6(e,t){var n={name:e.filename,buffer:e.input.slice(0,-1),position:e.position,line:e.line,column:e.position-e.lineStart};return n.snippet=qJe(n),new zo(t,n)}ie(z6,"generateError");function Ln(e,t){throw z6(e,t)}ie(Ln,"throwError");function f1(e,t){e.onWarning&&e.onWarning.call(null,z6(e,t))}ie(f1,"throwWarning");var KV={YAML:ie(function(t,n,r){var s,i,a;t.version!==null&&Ln(t,"duplication of %YAML directive"),r.length!==1&&Ln(t,"YAML directive accepts exactly one argument"),s=/^([0-9]+)\.([0-9]+)$/.exec(r[0]),s===null&&Ln(t,"ill-formed argument of the YAML directive"),i=parseInt(s[1],10),a=parseInt(s[2],10),i!==1&&Ln(t,"unacceptable YAML version of the document"),t.version=r[0],t.checkLineBreaks=a<2,a!==1&&a!==2&&f1(t,"unsupported YAML version of the document")},"handleYamlDirective"),TAG:ie(function(t,n,r){var s,i;r.length!==2&&Ln(t,"TAG directive accepts exactly two arguments"),s=r[0],i=r[1],yoe.test(s)||Ln(t,"ill-formed tag handle (first argument) of the TAG directive"),Xh.call(t.tagMap,s)&&Ln(t,'there is a previously declared suffix for "'+s+'" tag handle'),boe.test(i)||Ln(t,"ill-formed tag prefix (second argument) of the TAG directive");try{i=decodeURIComponent(i)}catch{Ln(t,"tag prefix is malformed: "+i)}t.tagMap[s]=i},"handleTagDirective")};function nf(e,t,n,r){var s,i,a,o;if(t<n){if(o=e.input.slice(t,n),r)for(s=0,i=o.length;s<i;s+=1)a=o.charCodeAt(s),a===9||32<=a&&a<=1114111||Ln(e,"expected valid JSON character");else mQe.test(o)&&Ln(e,"the stream contains non-printable characters");e.result+=o}}ie(nf,"captureSegment");function l4(e,t,n,r){var s,i,a,o;for(Zi.isObject(n)||Ln(e,"cannot merge mappings; the provided source object is unacceptable"),s=Object.keys(n),a=0,o=s.length;a<o;a+=1)i=s[a],Xh.call(t,i)||(t[i]=n[i],r[i]=!0)}ie(l4,"mergeMappings");function ym(e,t,n,r,s,i,a,o,l){var c,u;if(Array.isArray(s))for(s=Array.prototype.slice.call(s),c=0,u=s.length;c<u;c+=1)Array.isArray(s[c])&&Ln(e,"nested arrays are not supported inside keys"),typeof s=="object"&&a4(s[c])==="[object Object]"&&(s[c]="[object Object]");if(typeof s=="object"&&a4(s)==="[object Object]"&&(s="[object Object]"),s=String(s),t===null&&(t={}),r==="tag:yaml.org,2002:merge")if(Array.isArray(i))for(c=0,u=i.length;c<u;c+=1)l4(e,t,i[c],n);else l4(e,t,i,n);else!e.json&&!Xh.call(n,s)&&Xh.call(t,s)&&(e.line=a||e.line,e.lineStart=o||e.lineStart,e.position=l||e.position,Ln(e,"duplicated mapping key")),s==="__proto__"?Object.defineProperty(t,s,{configurable:!0,enumerable:!0,writable:!0,value:i}):t[s]=i,delete n[s];return t}ie(ym,"storeMappingPair");function dA(e){var t;t=e.input.charCodeAt(e.position),t===10?e.position++:t===13?(e.position++,e.input.charCodeAt(e.position)===10&&e.position++):Ln(e,"a line break is expected"),e.line+=1,e.lineStart=e.position,e.firstTabInLine=-1}ie(dA,"readLineBreak");function vi(e,t,n){for(var r=0,s=e.input.charCodeAt(e.position);s!==0;){for(;Nh(s);)s===9&&e.firstTabInLine===-1&&(e.firstTabInLine=e.position),s=e.input.charCodeAt(++e.position);if(t&&s===35)do s=e.input.charCodeAt(++e.position);while(s!==10&&s!==13&&s!==0);if(zc(s))for(dA(e),s=e.input.charCodeAt(e.position),r++,e.lineIndent=0;s===32;)e.lineIndent++,s=e.input.charCodeAt(++e.position);else break}return n!==-1&&r!==0&&e.lineIndent<n&&f1(e,"deficient indentation"),r}ie(vi,"skipSeparationSpace");function CS(e){var t=e.position,n;return n=e.input.charCodeAt(t),!!((n===45||n===46)&&n===e.input.charCodeAt(t+1)&&n===e.input.charCodeAt(t+2)&&(t+=3,n=e.input.charCodeAt(t),n===0||oo(n)))}ie(CS,"testDocumentSeparator");function fA(e,t){t===1?e.result+=" ":t>1&&(e.result+=Zi.repeat(`
`,t-1))}ie(fA,"writeFoldedLines");function Eoe(e,t,n){var r,s,i,a,o,l,c,u,d=e.kind,h=e.result,m;if(m=e.input.charCodeAt(e.position),oo(m)||gm(m)||m===35||m===38||m===42||m===33||m===124||m===62||m===39||m===34||m===37||m===64||m===96||(m===63||m===45)&&(s=e.input.charCodeAt(e.position+1),oo(s)||n&&gm(s)))return!1;for(e.kind="scalar",e.result="",i=a=e.position,o=!1;m!==0;){if(m===58){if(s=e.input.charCodeAt(e.position+1),oo(s)||n&&gm(s))break}else if(m===35){if(r=e.input.charCodeAt(e.position-1),oo(r))break}else{if(e.position===e.lineStart&&CS(e)||n&&gm(m))break;if(zc(m))if(l=e.line,c=e.lineStart,u=e.lineIndent,vi(e,!1,-1),e.lineIndent>=t){o=!0,m=e.input.charCodeAt(e.position);continue}else{e.position=a,e.line=l,e.lineStart=c,e.lineIndent=u;break}}o&&(nf(e,i,a,!1),fA(e,e.line-l),i=a=e.position,o=!1),Nh(m)||(a=e.position+1),m=e.input.charCodeAt(++e.position)}return nf(e,i,a,!1),e.result?!0:(e.kind=d,e.result=h,!1)}ie(Eoe,"readPlainScalar");function Toe(e,t){var n,r,s;if(n=e.input.charCodeAt(e.position),n!==39)return!1;for(e.kind="scalar",e.result="",e.position++,r=s=e.position;(n=e.input.charCodeAt(e.position))!==0;)if(n===39)if(nf(e,r,e.position,!0),n=e.input.charCodeAt(++e.position),n===39)r=e.position,e.position++,s=e.position;else return!0;else zc(n)?(nf(e,r,s,!0),fA(e,vi(e,!1,t)),r=s=e.position):e.position===e.lineStart&&CS(e)?Ln(e,"unexpected end of the document within a single quoted scalar"):(e.position++,s=e.position);Ln(e,"unexpected end of the stream within a single quoted scalar")}ie(Toe,"readSingleQuotedScalar");function Aoe(e,t){var n,r,s,i,a,o;if(o=e.input.charCodeAt(e.position),o!==34)return!1;for(e.kind="scalar",e.result="",e.position++,n=r=e.position;(o=e.input.charCodeAt(e.position))!==0;){if(o===34)return nf(e,n,e.position,!0),e.position++,!0;if(o===92){if(nf(e,n,e.position,!0),o=e.input.charCodeAt(++e.position),zc(o))vi(e,!1,t);else if(o<256&&_oe[o])e.result+=Coe[o],e.position++;else if((a=xoe(o))>0){for(s=a,i=0;s>0;s--)o=e.input.charCodeAt(++e.position),(a=voe(o))>=0?i=(i<<4)+a:Ln(e,"expected hexadecimal character");e.result+=Soe(i),e.position++}else Ln(e,"unknown escape sequence");n=r=e.position}else zc(o)?(nf(e,n,r,!0),fA(e,vi(e,!1,t)),n=r=e.position):e.position===e.lineStart&&CS(e)?Ln(e,"unexpected end of the document within a double quoted scalar"):(e.position++,r=e.position)}Ln(e,"unexpected end of the stream within a double quoted scalar")}ie(Aoe,"readDoubleQuotedScalar");function Roe(e,t){var n=!0,r,s,i,a=e.tag,o,l=e.anchor,c,u,d,h,m,y=Object.create(null),b,v,x,w;if(w=e.input.charCodeAt(e.position),w===91)u=93,m=!1,o=[];else if(w===123)u=125,m=!0,o={};else return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=o),w=e.input.charCodeAt(++e.position);w!==0;){if(vi(e,!0,t),w=e.input.charCodeAt(e.position),w===u)return e.position++,e.tag=a,e.anchor=l,e.kind=m?"mapping":"sequence",e.result=o,!0;n?w===44&&Ln(e,"expected the node content, but found ','"):Ln(e,"missed comma between flow collection entries"),v=b=x=null,d=h=!1,w===63&&(c=e.input.charCodeAt(e.position+1),oo(c)&&(d=h=!0,e.position++,vi(e,!0,t))),r=e.line,s=e.lineStart,i=e.position,Vm(e,t,Zk,!1,!0),v=e.tag,b=e.result,vi(e,!0,t),w=e.input.charCodeAt(e.position),(h||e.line===r)&&w===58&&(d=!0,w=e.input.charCodeAt(++e.position),vi(e,!0,t),Vm(e,t,Zk,!1,!0),x=e.result),m?ym(e,o,y,v,b,x,r,s,i):d?o.push(ym(e,null,y,v,b,x,r,s,i)):o.push(b),vi(e,!0,t),w=e.input.charCodeAt(e.position),w===44?(n=!0,w=e.input.charCodeAt(++e.position)):n=!1}Ln(e,"unexpected end of the stream within a flow collection")}ie(Roe,"readFlowCollection");function Noe(e,t){var n,r,s=$j,i=!1,a=!1,o=t,l=0,c=!1,u,d;if(d=e.input.charCodeAt(e.position),d===124)r=!1;else if(d===62)r=!0;else return!1;for(e.kind="scalar",e.result="";d!==0;)if(d=e.input.charCodeAt(++e.position),d===43||d===45)$j===s?s=d===43?GV:pQe:Ln(e,"repeat of a chomping mode identifier");else if((u=woe(d))>=0)u===0?Ln(e,"bad explicit indentation width of a block scalar; it cannot be less than one"):a?Ln(e,"repeat of an indentation width identifier"):(o=t+u-1,a=!0);else break;if(Nh(d)){do d=e.input.charCodeAt(++e.position);while(Nh(d));if(d===35)do d=e.input.charCodeAt(++e.position);while(!zc(d)&&d!==0)}for(;d!==0;){for(dA(e),e.lineIndent=0,d=e.input.charCodeAt(e.position);(!a||e.lineIndent<o)&&d===32;)e.lineIndent++,d=e.input.charCodeAt(++e.position);if(!a&&e.lineIndent>o&&(o=e.lineIndent),zc(d)){l++;continue}if(e.lineIndent<o){s===GV?e.result+=Zi.repeat(`
`,i?1+l:l):s===$j&&i&&(e.result+=`
`);break}for(r?Nh(d)?(c=!0,e.result+=Zi.repeat(`
`,i?1+l:l)):c?(c=!1,e.result+=Zi.repeat(`
`,l+1)):l===0?i&&(e.result+=" "):e.result+=Zi.repeat(`
`,l):e.result+=Zi.repeat(`
`,i?1+l:l),i=!0,a=!0,l=0,n=e.position;!zc(d)&&d!==0;)d=e.input.charCodeAt(++e.position);nf(e,n,e.position,!1)}return!0}ie(Noe,"readBlockScalar");function c4(e,t){var n,r=e.tag,s=e.anchor,i=[],a,o=!1,l;if(e.firstTabInLine!==-1)return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=i),l=e.input.charCodeAt(e.position);l!==0&&(e.firstTabInLine!==-1&&(e.position=e.firstTabInLine,Ln(e,"tab characters must not be used in indentation")),!(l!==45||(a=e.input.charCodeAt(e.position+1),!oo(a))));){if(o=!0,e.position++,vi(e,!0,-1)&&e.lineIndent<=t){i.push(null),l=e.input.charCodeAt(e.position);continue}if(n=e.line,Vm(e,t,goe,!1,!0),i.push(e.result),vi(e,!0,-1),l=e.input.charCodeAt(e.position),(e.line===n||e.lineIndent>t)&&l!==0)Ln(e,"bad indentation of a sequence entry");else if(e.lineIndent<t)break}return o?(e.tag=r,e.anchor=s,e.kind="sequence",e.result=i,!0):!1}ie(c4,"readBlockSequence");function Ioe(e,t,n){var r,s,i,a,o,l,c=e.tag,u=e.anchor,d={},h=Object.create(null),m=null,y=null,b=null,v=!1,x=!1,w;if(e.firstTabInLine!==-1)return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=d),w=e.input.charCodeAt(e.position);w!==0;){if(!v&&e.firstTabInLine!==-1&&(e.position=e.firstTabInLine,Ln(e,"tab characters must not be used in indentation")),r=e.input.charCodeAt(e.position+1),i=e.line,(w===63||w===58)&&oo(r))w===63?(v&&(ym(e,d,h,m,y,null,a,o,l),m=y=b=null),x=!0,v=!0,s=!0):v?(v=!1,s=!0):Ln(e,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),e.position+=1,w=r;else{if(a=e.line,o=e.lineStart,l=e.position,!Vm(e,n,moe,!1,!0))break;if(e.line===i){for(w=e.input.charCodeAt(e.position);Nh(w);)w=e.input.charCodeAt(++e.position);if(w===58)w=e.input.charCodeAt(++e.position),oo(w)||Ln(e,"a whitespace character is expected after the key-value separator within a block mapping"),v&&(ym(e,d,h,m,y,null,a,o,l),m=y=b=null),x=!0,v=!1,s=!1,m=e.tag,y=e.result;else if(x)Ln(e,"can not read an implicit mapping pair; a colon is missed");else return e.tag=c,e.anchor=u,!0}else if(x)Ln(e,"can not read a block mapping entry; a multiline key may not be an implicit key");else return e.tag=c,e.anchor=u,!0}if((e.line===i||e.lineIndent>t)&&(v&&(a=e.line,o=e.lineStart,l=e.position),Vm(e,t,Xk,!0,s)&&(v?y=e.result:b=e.result),v||(ym(e,d,h,m,y,b,a,o,l),m=y=b=null),vi(e,!0,-1),w=e.input.charCodeAt(e.position)),(e.line===i||e.lineIndent>t)&&w!==0)Ln(e,"bad indentation of a mapping entry");else if(e.lineIndent<t)break}return v&&ym(e,d,h,m,y,null,a,o,l),x&&(e.tag=c,e.anchor=u,e.kind="mapping",e.result=d),x}ie(Ioe,"readBlockMapping");function Moe(e){var t,n=!1,r=!1,s,i,a;if(a=e.input.charCodeAt(e.position),a!==33)return!1;if(e.tag!==null&&Ln(e,"duplication of a tag property"),a=e.input.charCodeAt(++e.position),a===60?(n=!0,a=e.input.charCodeAt(++e.position)):a===33?(r=!0,s="!!",a=e.input.charCodeAt(++e.position)):s="!",t=e.position,n){do a=e.input.charCodeAt(++e.position);while(a!==0&&a!==62);e.position<e.length?(i=e.input.slice(t,e.position),a=e.input.charCodeAt(++e.position)):Ln(e,"unexpected end of the stream within a verbatim tag")}else{for(;a!==0&&!oo(a);)a===33&&(r?Ln(e,"tag suffix cannot contain exclamation marks"):(s=e.input.slice(t-1,e.position+1),yoe.test(s)||Ln(e,"named tag handle cannot contain such characters"),r=!0,t=e.position+1)),a=e.input.charCodeAt(++e.position);i=e.input.slice(t,e.position),yQe.test(i)&&Ln(e,"tag suffix cannot contain flow indicator characters")}i&&!boe.test(i)&&Ln(e,"tag name cannot contain such characters: "+i);try{i=decodeURIComponent(i)}catch{Ln(e,"tag name is malformed: "+i)}return n?e.tag=i:Xh.call(e.tagMap,s)?e.tag=e.tagMap[s]+i:s==="!"?e.tag="!"+i:s==="!!"?e.tag="tag:yaml.org,2002:"+i:Ln(e,'undeclared tag handle "'+s+'"'),!0}ie(Moe,"readTagProperty");function joe(e){var t,n;if(n=e.input.charCodeAt(e.position),n!==38)return!1;for(e.anchor!==null&&Ln(e,"duplication of an anchor property"),n=e.input.charCodeAt(++e.position),t=e.position;n!==0&&!oo(n)&&!gm(n);)n=e.input.charCodeAt(++e.position);return e.position===t&&Ln(e,"name of an anchor node must contain at least one character"),e.anchor=e.input.slice(t,e.position),!0}ie(joe,"readAnchorProperty");function Poe(e){var t,n,r;if(r=e.input.charCodeAt(e.position),r!==42)return!1;for(r=e.input.charCodeAt(++e.position),t=e.position;r!==0&&!oo(r)&&!gm(r);)r=e.input.charCodeAt(++e.position);return e.position===t&&Ln(e,"name of an alias node must contain at least one character"),n=e.input.slice(t,e.position),Xh.call(e.anchorMap,n)||Ln(e,'unidentified alias "'+n+'"'),e.result=e.anchorMap[n],vi(e,!0,-1),!0}ie(Poe,"readAlias");function Vm(e,t,n,r,s){var i,a,o,l=1,c=!1,u=!1,d,h,m,y,b,v;if(e.listener!==null&&e.listener("open",e),e.tag=null,e.anchor=null,e.kind=null,e.result=null,i=a=o=Xk===n||goe===n,r&&vi(e,!0,-1)&&(c=!0,e.lineIndent>t?l=1:e.lineIndent===t?l=0:e.lineIndent<t&&(l=-1)),l===1)for(;Moe(e)||joe(e);)vi(e,!0,-1)?(c=!0,o=i,e.lineIndent>t?l=1:e.lineIndent===t?l=0:e.lineIndent<t&&(l=-1)):o=!1;if(o&&(o=c||s),(l===1||Xk===n)&&(Zk===n||moe===n?b=t:b=t+1,v=e.position-e.lineStart,l===1?o&&(c4(e,v)||Ioe(e,v,b))||Roe(e,b)?u=!0:(a&&Noe(e,b)||Toe(e,b)||Aoe(e,b)?u=!0:Poe(e)?(u=!0,(e.tag!==null||e.anchor!==null)&&Ln(e,"alias node should not have any properties")):Eoe(e,b,Zk===n)&&(u=!0,e.tag===null&&(e.tag="?")),e.anchor!==null&&(e.anchorMap[e.anchor]=e.result)):l===0&&(u=o&&c4(e,v))),e.tag===null)e.anchor!==null&&(e.anchorMap[e.anchor]=e.result);else if(e.tag==="?"){for(e.result!==null&&e.kind!=="scalar"&&Ln(e,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+e.kind+'"'),d=0,h=e.implicitTypes.length;d<h;d+=1)if(y=e.implicitTypes[d],y.resolve(e.result)){e.result=y.construct(e.result),e.tag=y.tag,e.anchor!==null&&(e.anchorMap[e.anchor]=e.result);break}}else if(e.tag!=="!"){if(Xh.call(e.typeMap[e.kind||"fallback"],e.tag))y=e.typeMap[e.kind||"fallback"][e.tag];else for(y=null,m=e.typeMap.multi[e.kind||"fallback"],d=0,h=m.length;d<h;d+=1)if(e.tag.slice(0,m[d].tag.length)===m[d].tag){y=m[d];break}y||Ln(e,"unknown tag !<"+e.tag+">"),e.result!==null&&y.kind!==e.kind&&Ln(e,"unacceptable node kind for !<"+e.tag+'> tag; it should be "'+y.kind+'", not "'+e.kind+'"'),y.resolve(e.result,e.tag)?(e.result=y.construct(e.result,e.tag),e.anchor!==null&&(e.anchorMap[e.anchor]=e.result)):Ln(e,"cannot resolve a node with !<"+e.tag+"> explicit tag")}return e.listener!==null&&e.listener("close",e),e.tag!==null||e.anchor!==null||u}ie(Vm,"composeNode");function Ooe(e){var t=e.position,n,r,s,i=!1,a;for(e.version=null,e.checkLineBreaks=e.legacy,e.tagMap=Object.create(null),e.anchorMap=Object.create(null);(a=e.input.charCodeAt(e.position))!==0&&(vi(e,!0,-1),a=e.input.charCodeAt(e.position),!(e.lineIndent>0||a!==37));){for(i=!0,a=e.input.charCodeAt(++e.position),n=e.position;a!==0&&!oo(a);)a=e.input.charCodeAt(++e.position);for(r=e.input.slice(n,e.position),s=[],r.length<1&&Ln(e,"directive name must not be less than one character in length");a!==0;){for(;Nh(a);)a=e.input.charCodeAt(++e.position);if(a===35){do a=e.input.charCodeAt(++e.position);while(a!==0&&!zc(a));break}if(zc(a))break;for(n=e.position;a!==0&&!oo(a);)a=e.input.charCodeAt(++e.position);s.push(e.input.slice(n,e.position))}a!==0&&dA(e),Xh.call(KV,r)?KV[r](e,r,s):f1(e,'unknown document directive "'+r+'"')}if(vi(e,!0,-1),e.lineIndent===0&&e.input.charCodeAt(e.position)===45&&e.input.charCodeAt(e.position+1)===45&&e.input.charCodeAt(e.position+2)===45?(e.position+=3,vi(e,!0,-1)):i&&Ln(e,"directives end mark is expected"),Vm(e,e.lineIndent-1,Xk,!1,!0),vi(e,!0,-1),e.checkLineBreaks&&gQe.test(e.input.slice(t,e.position))&&f1(e,"non-ASCII line breaks are interpreted as content"),e.documents.push(e.result),e.position===e.lineStart&&CS(e)){e.input.charCodeAt(e.position)===46&&(e.position+=3,vi(e,!0,-1));return}if(e.position<e.length-1)Ln(e,"end of the stream or a document separator is expected");else return}ie(Ooe,"readDocument");function U6(e,t){e=String(e),t=t||{},e.length!==0&&(e.charCodeAt(e.length-1)!==10&&e.charCodeAt(e.length-1)!==13&&(e+=`
`),e.charCodeAt(0)===65279&&(e=e.slice(1)));var n=new koe(e,t),r=e.indexOf("\0");for(r!==-1&&(n.position=r,Ln(n,"null byte is not allowed in input")),n.input+="\0";n.input.charCodeAt(n.position)===32;)n.lineIndent+=1,n.position+=1;for(;n.position<n.length-1;)Ooe(n);return n.documents}ie(U6,"loadDocuments");function bQe(e,t,n){t!==null&&typeof t=="object"&&typeof n>"u"&&(n=t,t=null);var r=U6(e,n);if(typeof t!="function")return r;for(var s=0,i=r.length;s<i;s+=1)t(r[s])}ie(bQe,"loadAll$1");function Doe(e,t){var n=U6(e,t);if(n.length!==0){if(n.length===1)return n[0];throw new zo("expected a single document in the stream, but found more")}}ie(Doe,"load$1");var vQe=Doe,xQe={load:vQe},Foe=Object.prototype.toString,Loe=Object.prototype.hasOwnProperty,q6=65279,wQe=9,h1=10,SQe=13,_Qe=32,CQe=33,kQe=34,u4=35,EQe=37,TQe=38,AQe=39,RQe=42,Boe=44,NQe=45,Jk=58,IQe=61,MQe=62,jQe=63,PQe=64,$oe=91,zoe=93,OQe=96,Uoe=123,DQe=124,qoe=125,Za={};Za[0]="\\0";Za[7]="\\a";Za[8]="\\b";Za[9]="\\t";Za[10]="\\n";Za[11]="\\v";Za[12]="\\f";Za[13]="\\r";Za[27]="\\e";Za[34]='\\"';Za[92]="\\\\";Za[133]="\\N";Za[160]="\\_";Za[8232]="\\L";Za[8233]="\\P";var FQe=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"],LQe=/^[-+]?[0-9_]+(?::[0-9_]+)+(?:\.[0-9_]*)?$/;function Voe(e,t){var n,r,s,i,a,o,l;if(t===null)return{};for(n={},r=Object.keys(t),s=0,i=r.length;s<i;s+=1)a=r[s],o=String(t[a]),a.slice(0,2)==="!!"&&(a="tag:yaml.org,2002:"+a.slice(2)),l=e.compiledTypeMap.fallback[a],l&&Loe.call(l.styleAliases,o)&&(o=l.styleAliases[o]),n[a]=o;return n}ie(Voe,"compileStyleMap");function Woe(e){var t,n,r;if(t=e.toString(16).toUpperCase(),e<=255)n="x",r=2;else if(e<=65535)n="u",r=4;else if(e<=4294967295)n="U",r=8;else throw new zo("code point within a string may not be greater than 0xFFFFFFFF");return"\\"+n+Zi.repeat("0",r-t.length)+t}ie(Woe,"encodeHex");var BQe=1,p1=2;function Hoe(e){this.schema=e.schema||poe,this.indent=Math.max(1,e.indent||2),this.noArrayIndent=e.noArrayIndent||!1,this.skipInvalid=e.skipInvalid||!1,this.flowLevel=Zi.isNothing(e.flowLevel)?-1:e.flowLevel,this.styleMap=Voe(this.schema,e.styles||null),this.sortKeys=e.sortKeys||!1,this.lineWidth=e.lineWidth||80,this.noRefs=e.noRefs||!1,this.noCompatMode=e.noCompatMode||!1,this.condenseFlow=e.condenseFlow||!1,this.quotingType=e.quotingType==='"'?p1:BQe,this.forceQuotes=e.forceQuotes||!1,this.replacer=typeof e.replacer=="function"?e.replacer:null,this.implicitTypes=this.schema.compiledImplicit,this.explicitTypes=this.schema.compiledExplicit,this.tag=null,this.result="",this.duplicates=[],this.usedDuplicates=null}ie(Hoe,"State");function d4(e,t){for(var n=Zi.repeat(" ",t),r=0,s=-1,i="",a,o=e.length;r<o;)s=e.indexOf(`
`,r),s===-1?(a=e.slice(r),r=o):(a=e.slice(r,s+1),r=s+1),a.length&&a!==`
`&&(i+=n),i+=a;return i}ie(d4,"indentString");function Qk(e,t){return`
`+Zi.repeat(" ",e.indent*t)}ie(Qk,"generateNextLine");function Goe(e,t){var n,r,s;for(n=0,r=e.implicitTypes.length;n<r;n+=1)if(s=e.implicitTypes[n],s.resolve(t))return!0;return!1}ie(Goe,"testImplicitResolving");function m1(e){return e===_Qe||e===wQe}ie(m1,"isWhitespace");function Wy(e){return 32<=e&&e<=126||161<=e&&e<=55295&&e!==8232&&e!==8233||57344<=e&&e<=65533&&e!==q6||65536<=e&&e<=1114111}ie(Wy,"isPrintable");function f4(e){return Wy(e)&&e!==q6&&e!==SQe&&e!==h1}ie(f4,"isNsCharOrWhitespace");function h4(e,t,n){var r=f4(e),s=r&&!m1(e);return(n?r:r&&e!==Boe&&e!==$oe&&e!==zoe&&e!==Uoe&&e!==qoe)&&e!==u4&&!(t===Jk&&!s)||f4(t)&&!m1(t)&&e===u4||t===Jk&&s}ie(h4,"isPlainSafe");function Koe(e){return Wy(e)&&e!==q6&&!m1(e)&&e!==NQe&&e!==jQe&&e!==Jk&&e!==Boe&&e!==$oe&&e!==zoe&&e!==Uoe&&e!==qoe&&e!==u4&&e!==TQe&&e!==RQe&&e!==CQe&&e!==DQe&&e!==IQe&&e!==MQe&&e!==AQe&&e!==kQe&&e!==EQe&&e!==PQe&&e!==OQe}ie(Koe,"isPlainSafeFirst");function Yoe(e){return!m1(e)&&e!==Jk}ie(Yoe,"isPlainSafeLast");function z0(e,t){var n=e.charCodeAt(t),r;return n>=55296&&n<=56319&&t+1<e.length&&(r=e.charCodeAt(t+1),r>=56320&&r<=57343)?(n-55296)*1024+r-56320+65536:n}ie(z0,"codePointAt");function V6(e){var t=/^\n* /;return t.test(e)}ie(V6,"needIndentIndicator");var Zoe=1,p4=2,Xoe=3,Joe=4,E0=5;function Qoe(e,t,n,r,s,i,a,o){var l,c=0,u=null,d=!1,h=!1,m=r!==-1,y=-1,b=Koe(z0(e,0))&&Yoe(z0(e,e.length-1));if(t||a)for(l=0;l<e.length;c>=65536?l+=2:l++){if(c=z0(e,l),!Wy(c))return E0;b=b&&h4(c,u,o),u=c}else{for(l=0;l<e.length;c>=65536?l+=2:l++){if(c=z0(e,l),c===h1)d=!0,m&&(h=h||l-y-1>r&&e[y+1]!==" ",y=l);else if(!Wy(c))return E0;b=b&&h4(c,u,o),u=c}h=h||m&&l-y-1>r&&e[y+1]!==" "}return!d&&!h?b&&!a&&!s(e)?Zoe:i===p1?E0:p4:n>9&&V6(e)?E0:a?i===p1?E0:p4:h?Joe:Xoe}ie(Qoe,"chooseScalarStyle");function ele(e,t,n,r,s){e.dump=function(){if(t.length===0)return e.quotingType===p1?'""':"''";if(!e.noCompatMode&&(FQe.indexOf(t)!==-1||LQe.test(t)))return e.quotingType===p1?'"'+t+'"':"'"+t+"'";var i=e.indent*Math.max(1,n),a=e.lineWidth===-1?-1:Math.max(Math.min(e.lineWidth,40),e.lineWidth-i),o=r||e.flowLevel>-1&&n>=e.flowLevel;function l(c){return Goe(e,c)}switch(ie(l,"testAmbiguity"),Qoe(t,o,e.indent,a,l,e.quotingType,e.forceQuotes&&!r,s)){case Zoe:return t;case p4:return"'"+t.replace(/'/g,"''")+"'";case Xoe:return"|"+m4(t,e.indent)+g4(d4(t,i));case Joe:return">"+m4(t,e.indent)+g4(d4(tle(t,a),i));case E0:return'"'+nle(t)+'"';default:throw new zo("impossible error: invalid scalar style")}}()}ie(ele,"writeScalar");function m4(e,t){var n=V6(e)?String(t):"",r=e[e.length-1]===`
`,s=r&&(e[e.length-2]===`
`||e===`
`),i=s?"+":r?"":"-";return n+i+`
`}ie(m4,"blockHeader");function g4(e){return e[e.length-1]===`
`?e.slice(0,-1):e}ie(g4,"dropEndingNewline");function tle(e,t){for(var n=/(\n+)([^\n]*)/g,r=function(){var c=e.indexOf(`
`);return c=c!==-1?c:e.length,n.lastIndex=c,y4(e.slice(0,c),t)}(),s=e[0]===`
`||e[0]===" ",i,a;a=n.exec(e);){var o=a[1],l=a[2];i=l[0]===" ",r+=o+(!s&&!i&&l!==""?`
`:"")+y4(l,t),s=i}return r}ie(tle,"foldString");function y4(e,t){if(e===""||e[0]===" ")return e;for(var n=/ [^ ]/g,r,s=0,i,a=0,o=0,l="";r=n.exec(e);)o=r.index,o-s>t&&(i=a>s?a:o,l+=`
`+e.slice(s,i),s=i+1),a=o;return l+=`
`,e.length-s>t&&a>s?l+=e.slice(s,a)+`
`+e.slice(a+1):l+=e.slice(s),l.slice(1)}ie(y4,"foldLine");function nle(e){for(var t="",n=0,r,s=0;s<e.length;n>=65536?s+=2:s++)n=z0(e,s),r=Za[n],!r&&Wy(n)?(t+=e[s],n>=65536&&(t+=e[s+1])):t+=r||Woe(n);return t}ie(nle,"escapeString");function rle(e,t,n){var r="",s=e.tag,i,a,o;for(i=0,a=n.length;i<a;i+=1)o=n[i],e.replacer&&(o=e.replacer.call(n,String(i),o)),(Ku(e,t,o,!1,!1)||typeof o>"u"&&Ku(e,t,null,!1,!1))&&(r!==""&&(r+=","+(e.condenseFlow?"":" ")),r+=e.dump);e.tag=s,e.dump="["+r+"]"}ie(rle,"writeFlowSequence");function b4(e,t,n,r){var s="",i=e.tag,a,o,l;for(a=0,o=n.length;a<o;a+=1)l=n[a],e.replacer&&(l=e.replacer.call(n,String(a),l)),(Ku(e,t+1,l,!0,!0,!1,!0)||typeof l>"u"&&Ku(e,t+1,null,!0,!0,!1,!0))&&((!r||s!=="")&&(s+=Qk(e,t)),e.dump&&h1===e.dump.charCodeAt(0)?s+="-":s+="- ",s+=e.dump);e.tag=i,e.dump=s||"[]"}ie(b4,"writeBlockSequence");function sle(e,t,n){var r="",s=e.tag,i=Object.keys(n),a,o,l,c,u;for(a=0,o=i.length;a<o;a+=1)u="",r!==""&&(u+=", "),e.condenseFlow&&(u+='"'),l=i[a],c=n[l],e.replacer&&(c=e.replacer.call(n,l,c)),Ku(e,t,l,!1,!1)&&(e.dump.length>1024&&(u+="? "),u+=e.dump+(e.condenseFlow?'"':"")+":"+(e.condenseFlow?"":" "),Ku(e,t,c,!1,!1)&&(u+=e.dump,r+=u));e.tag=s,e.dump="{"+r+"}"}ie(sle,"writeFlowMapping");function ile(e,t,n,r){var s="",i=e.tag,a=Object.keys(n),o,l,c,u,d,h;if(e.sortKeys===!0)a.sort();else if(typeof e.sortKeys=="function")a.sort(e.sortKeys);else if(e.sortKeys)throw new zo("sortKeys must be a boolean or a function");for(o=0,l=a.length;o<l;o+=1)h="",(!r||s!=="")&&(h+=Qk(e,t)),c=a[o],u=n[c],e.replacer&&(u=e.replacer.call(n,c,u)),Ku(e,t+1,c,!0,!0,!0)&&(d=e.tag!==null&&e.tag!=="?"||e.dump&&e.dump.length>1024,d&&(e.dump&&h1===e.dump.charCodeAt(0)?h+="?":h+="? "),h+=e.dump,d&&(h+=Qk(e,t)),Ku(e,t+1,u,!0,d)&&(e.dump&&h1===e.dump.charCodeAt(0)?h+=":":h+=": ",h+=e.dump,s+=h));e.tag=i,e.dump=s||"{}"}ie(ile,"writeBlockMapping");function v4(e,t,n){var r,s,i,a,o,l;for(s=n?e.explicitTypes:e.implicitTypes,i=0,a=s.length;i<a;i+=1)if(o=s[i],(o.instanceOf||o.predicate)&&(!o.instanceOf||typeof t=="object"&&t instanceof o.instanceOf)&&(!o.predicate||o.predicate(t))){if(n?o.multi&&o.representName?e.tag=o.representName(t):e.tag=o.tag:e.tag="?",o.represent){if(l=e.styleMap[o.tag]||o.defaultStyle,Foe.call(o.represent)==="[object Function]")r=o.represent(t,l);else if(Loe.call(o.represent,l))r=o.represent[l](t,l);else throw new zo("!<"+o.tag+'> tag resolver accepts not "'+l+'" style');e.dump=r}return!0}return!1}ie(v4,"detectType");function Ku(e,t,n,r,s,i,a){e.tag=null,e.dump=n,v4(e,n,!1)||v4(e,n,!0);var o=Foe.call(e.dump),l=r,c;r&&(r=e.flowLevel<0||e.flowLevel>t);var u=o==="[object Object]"||o==="[object Array]",d,h;if(u&&(d=e.duplicates.indexOf(n),h=d!==-1),(e.tag!==null&&e.tag!=="?"||h||e.indent!==2&&t>0)&&(s=!1),h&&e.usedDuplicates[d])e.dump="*ref_"+d;else{if(u&&h&&!e.usedDuplicates[d]&&(e.usedDuplicates[d]=!0),o==="[object Object]")r&&Object.keys(e.dump).length!==0?(ile(e,t,e.dump,s),h&&(e.dump="&ref_"+d+e.dump)):(sle(e,t,e.dump),h&&(e.dump="&ref_"+d+" "+e.dump));else if(o==="[object Array]")r&&e.dump.length!==0?(e.noArrayIndent&&!a&&t>0?b4(e,t-1,e.dump,s):b4(e,t,e.dump,s),h&&(e.dump="&ref_"+d+e.dump)):(rle(e,t,e.dump),h&&(e.dump="&ref_"+d+" "+e.dump));else if(o==="[object String]")e.tag!=="?"&&ele(e,e.dump,t,i,l);else{if(o==="[object Undefined]")return!1;if(e.skipInvalid)return!1;throw new zo("unacceptable kind of an object to dump "+o)}e.tag!==null&&e.tag!=="?"&&(c=encodeURI(e.tag[0]==="!"?e.tag.slice(1):e.tag).replace(/!/g,"%21"),e.tag[0]==="!"?c="!"+c:c.slice(0,18)==="tag:yaml.org,2002:"?c="!!"+c.slice(18):c="!<"+c+">",e.dump=c+" "+e.dump)}return!0}ie(Ku,"writeNode");function ale(e,t){var n=[],r=[],s,i;for(eE(e,n,r),s=0,i=r.length;s<i;s+=1)t.duplicates.push(n[r[s]]);t.usedDuplicates=new Array(i)}ie(ale,"getDuplicateReferences");function eE(e,t,n){var r,s,i;if(e!==null&&typeof e=="object")if(s=t.indexOf(e),s!==-1)n.indexOf(s)===-1&&n.push(s);else if(t.push(e),Array.isArray(e))for(s=0,i=e.length;s<i;s+=1)eE(e[s],t,n);else for(r=Object.keys(e),s=0,i=r.length;s<i;s+=1)eE(e[r[s]],t,n)}ie(eE,"inspectNode");function $Qe(e,t){t=t||{};var n=new Hoe(t);n.noRefs||ale(e,n);var r=e;return n.replacer&&(r=n.replacer.call({"":r},"",r)),Ku(n,0,r,!0,!0)?n.dump+`
`:""}ie($Qe,"dump$1");function zQe(e,t){return function(){throw new Error("Function yaml."+e+" is removed in js-yaml 4. Use yaml."+t+" instead, which is now safe by default.")}}ie(zQe,"renamed");var UQe=Xae,qQe=xQe.load;/*! Bundled license information:

js-yaml/dist/js-yaml.mjs:
  (*! js-yaml 4.1.0 https://github.com/nodeca/js-yaml @license MIT *)
*/var Vl={aggregation:18,extension:18,composition:18,dependency:6,lollipop:13.5,arrow_point:4};function Ax(e,t){if(e===void 0||t===void 0)return{angle:0,deltaX:0,deltaY:0};e=Zs(e),t=Zs(t);const[n,r]=[e.x,e.y],[s,i]=[t.x,t.y],a=s-n,o=i-r;return{angle:Math.atan(o/a),deltaX:a,deltaY:o}}ie(Ax,"calculateDeltaAndAngle");var Zs=ie(e=>Array.isArray(e)?{x:e[0],y:e[1]}:e,"pointTransformer"),VQe=ie(e=>({x:ie(function(t,n,r){let s=0;const i=Zs(r[0]).x<Zs(r[r.length-1]).x?"left":"right";if(n===0&&Object.hasOwn(Vl,e.arrowTypeStart)){const{angle:m,deltaX:y}=Ax(r[0],r[1]);s=Vl[e.arrowTypeStart]*Math.cos(m)*(y>=0?1:-1)}else if(n===r.length-1&&Object.hasOwn(Vl,e.arrowTypeEnd)){const{angle:m,deltaX:y}=Ax(r[r.length-1],r[r.length-2]);s=Vl[e.arrowTypeEnd]*Math.cos(m)*(y>=0?1:-1)}const a=Math.abs(Zs(t).x-Zs(r[r.length-1]).x),o=Math.abs(Zs(t).y-Zs(r[r.length-1]).y),l=Math.abs(Zs(t).x-Zs(r[0]).x),c=Math.abs(Zs(t).y-Zs(r[0]).y),u=Vl[e.arrowTypeStart],d=Vl[e.arrowTypeEnd],h=1;if(a<d&&a>0&&o<d){let m=d+h-a;m*=i==="right"?-1:1,s-=m}if(l<u&&l>0&&c<u){let m=u+h-l;m*=i==="right"?-1:1,s+=m}return Zs(t).x+s},"x"),y:ie(function(t,n,r){let s=0;const i=Zs(r[0]).y<Zs(r[r.length-1]).y?"down":"up";if(n===0&&Object.hasOwn(Vl,e.arrowTypeStart)){const{angle:m,deltaY:y}=Ax(r[0],r[1]);s=Vl[e.arrowTypeStart]*Math.abs(Math.sin(m))*(y>=0?1:-1)}else if(n===r.length-1&&Object.hasOwn(Vl,e.arrowTypeEnd)){const{angle:m,deltaY:y}=Ax(r[r.length-1],r[r.length-2]);s=Vl[e.arrowTypeEnd]*Math.abs(Math.sin(m))*(y>=0?1:-1)}const a=Math.abs(Zs(t).y-Zs(r[r.length-1]).y),o=Math.abs(Zs(t).x-Zs(r[r.length-1]).x),l=Math.abs(Zs(t).y-Zs(r[0]).y),c=Math.abs(Zs(t).x-Zs(r[0]).x),u=Vl[e.arrowTypeStart],d=Vl[e.arrowTypeEnd],h=1;if(a<d&&a>0&&o<d){let m=d+h-a;m*=i==="up"?-1:1,s-=m}if(l<u&&l>0&&c<u){let m=u+h-l;m*=i==="up"?-1:1,s+=m}return Zs(t).y+s},"y")}),"getLineFunctionsWithOffset"),W6=ie(({flowchart:e})=>{var s,i;const t=((s=e==null?void 0:e.subGraphTitleMargin)==null?void 0:s.top)??0,n=((i=e==null?void 0:e.subGraphTitleMargin)==null?void 0:i.bottom)??0,r=t+n;return{subGraphTitleTopMargin:t,subGraphTitleBottomMargin:n,subGraphTitleTotalMargin:r}},"getSubGraphTitleMargins");const WQe=Object.freeze({left:0,top:0,width:16,height:16}),tE=Object.freeze({rotate:0,vFlip:!1,hFlip:!1}),ole=Object.freeze({...WQe,...tE}),HQe=Object.freeze({...ole,body:"",hidden:!1}),GQe=Object.freeze({width:null,height:null}),KQe=Object.freeze({...GQe,...tE}),YQe=(e,t,n,r="")=>{const s=e.split(":");if(e.slice(0,1)==="@"){if(s.length<2||s.length>3)return null;r=s.shift().slice(1)}if(s.length>3||!s.length)return null;if(s.length>1){const o=s.pop(),l=s.pop(),c={provider:s.length>0?s[0]:r,prefix:l,name:o};return zj(c)?c:null}const i=s[0],a=i.split("-");if(a.length>1){const o={provider:r,prefix:a.shift(),name:a.join("-")};return zj(o)?o:null}if(n&&r===""){const o={provider:r,prefix:"",name:i};return zj(o,n)?o:null}return null},zj=(e,t)=>e?!!((t&&e.prefix===""||e.prefix)&&e.name):!1;function ZQe(e,t){const n={};!e.hFlip!=!t.hFlip&&(n.hFlip=!0),!e.vFlip!=!t.vFlip&&(n.vFlip=!0);const r=((e.rotate||0)+(t.rotate||0))%4;return r&&(n.rotate=r),n}function YV(e,t){const n=ZQe(e,t);for(const r in HQe)r in tE?r in e&&!(r in n)&&(n[r]=tE[r]):r in t?n[r]=t[r]:r in e&&(n[r]=e[r]);return n}function XQe(e,t){const n=e.icons,r=e.aliases||Object.create(null),s=Object.create(null);function i(a){if(n[a])return s[a]=[];if(!(a in s)){s[a]=null;const o=r[a]&&r[a].parent,l=o&&i(o);l&&(s[a]=[o].concat(l))}return s[a]}return(t||Object.keys(n).concat(Object.keys(r))).forEach(i),s}function ZV(e,t,n){const r=e.icons,s=e.aliases||Object.create(null);let i={};function a(o){i=YV(r[o]||s[o],i)}return a(t),n.forEach(a),YV(e,i)}function JQe(e,t){if(e.icons[t])return ZV(e,t,[]);const n=XQe(e,[t])[t];return n?ZV(e,t,n):null}const QQe=/(-?[0-9.]*[0-9]+[0-9.]*)/g,eet=/^-?[0-9.]*[0-9]+[0-9.]*$/g;function XV(e,t,n){if(t===1)return e;if(n=n||100,typeof e=="number")return Math.ceil(e*t*n)/n;if(typeof e!="string")return e;const r=e.split(QQe);if(r===null||!r.length)return e;const s=[];let i=r.shift(),a=eet.test(i);for(;;){if(a){const o=parseFloat(i);isNaN(o)?s.push(i):s.push(Math.ceil(o*t*n)/n)}else s.push(i);if(i=r.shift(),i===void 0)return s.join("");a=!a}}function tet(e,t="defs"){let n="";const r=e.indexOf("<"+t);for(;r>=0;){const s=e.indexOf(">",r),i=e.indexOf("</"+t);if(s===-1||i===-1)break;const a=e.indexOf(">",i);if(a===-1)break;n+=e.slice(s+1,i).trim(),e=e.slice(0,r).trim()+e.slice(a+1)}return{defs:n,content:e}}function net(e,t){return e?"<defs>"+e+"</defs>"+t:t}function ret(e,t,n){const r=tet(e);return net(r.defs,t+r.content+n)}const set=e=>e==="unset"||e==="undefined"||e==="none";function iet(e,t){const n={...ole,...e},r={...KQe,...t},s={left:n.left,top:n.top,width:n.width,height:n.height};let i=n.body;[n,r].forEach(b=>{const v=[],x=b.hFlip,w=b.vFlip;let _=b.rotate;x?w?_+=2:(v.push("translate("+(s.width+s.left).toString()+" "+(0-s.top).toString()+")"),v.push("scale(-1 1)"),s.top=s.left=0):w&&(v.push("translate("+(0-s.left).toString()+" "+(s.height+s.top).toString()+")"),v.push("scale(1 -1)"),s.top=s.left=0);let k;switch(_<0&&(_-=Math.floor(_/4)*4),_=_%4,_){case 1:k=s.height/2+s.top,v.unshift("rotate(90 "+k.toString()+" "+k.toString()+")");break;case 2:v.unshift("rotate(180 "+(s.width/2+s.left).toString()+" "+(s.height/2+s.top).toString()+")");break;case 3:k=s.width/2+s.left,v.unshift("rotate(-90 "+k.toString()+" "+k.toString()+")");break}_%2===1&&(s.left!==s.top&&(k=s.left,s.left=s.top,s.top=k),s.width!==s.height&&(k=s.width,s.width=s.height,s.height=k)),v.length&&(i=ret(i,'<g transform="'+v.join(" ")+'">',"</g>"))});const a=r.width,o=r.height,l=s.width,c=s.height;let u,d;a===null?(d=o===null?"1em":o==="auto"?c:o,u=XV(d,l/c)):(u=a==="auto"?l:a,d=o===null?XV(u,c/l):o==="auto"?c:o);const h={},m=(b,v)=>{set(v)||(h[b]=v.toString())};m("width",u),m("height",d);const y=[s.left,s.top,l,c];return h.viewBox=y.join(" "),{attributes:h,viewBox:y,body:i}}const aet=/\sid="(\S+)"/g,oet="IconifyId"+Date.now().toString(16)+(Math.random()*16777216|0).toString(16);let cet=0;function uet(e,t=oet){const n=[];let r;for(;r=aet.exec(e);)n.push(r[1]);if(!n.length)return e;const s="suffix"+(Math.random()*16777216|Date.now()).toString(16);return n.forEach(i=>{const a=typeof t=="function"?t(i):t+(cet++).toString(),o=i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");e=e.replace(new RegExp('([#;"])('+o+')([")]|\\.[a-z])',"g"),"$1"+a+s+"$3")}),e=e.replace(new RegExp(s,"g"),""),e}function det(e,t){let n=e.indexOf("xlink:")===-1?"":' xmlns:xlink="http://www.w3.org/1999/xlink"';for(const r in t)n+=" "+r+'="'+t[r]+'"';return'<svg xmlns="http://www.w3.org/2000/svg"'+n+">"+e+"</svg>"}var fet={body:'<g><rect width="80" height="80" style="fill: #087ebf; stroke-width: 0px;"/><text transform="translate(21.16 64.67)" style="fill: #fff; font-family: ArialMT, Arial; font-size: 67.75px;"><tspan x="0" y="0">?</tspan></text></g>',height:80,width:80},x4=new Map,lle=new Map,het=ie(e=>{for(const t of e){if(!t.name)throw new Error('Invalid icon loader. Must have a "name" property with non-empty string value.');if(qt.debug("Registering icon pack:",t.name),"loader"in t)lle.set(t.name,t.loader);else if("icons"in t)x4.set(t.name,t.icons);else throw qt.error("Invalid icon loader:",t),new Error('Invalid icon loader. Must have either "icons" or "loader" property.')}},"registerIconPacks"),pet=ie(async(e,t)=>{const n=YQe(e,!0,t!==void 0);if(!n)throw new Error(`Invalid icon name: ${e}`);const r=n.prefix||t;if(!r)throw new Error(`Icon name must contain a prefix: ${e}`);let s=x4.get(r);if(!s){const a=lle.get(r);if(!a)throw new Error(`Icon set not found: ${n.prefix}`);try{s={...await a(),prefix:r},x4.set(r,s)}catch(o){throw qt.error(o),new Error(`Failed to load icon set: ${n.prefix}`)}}const i=JQe(s,n.name);if(!i)throw new Error(`Icon not found: ${e}`);return i},"getRegisteredIconData"),hA=ie(async(e,t)=>{let n;try{n=await pet(e,t==null?void 0:t.fallbackPrefix)}catch(i){qt.error(i),n=fet}const r=iet(n,t);return det(uet(r.body),r.attributes)},"getIconSVG"),ix={},Wi={},JV;function met(){return JV||(JV=1,Object.defineProperty(Wi,"__esModule",{value:!0}),Wi.BLANK_URL=Wi.relativeFirstCharacters=Wi.whitespaceEscapeCharsRegex=Wi.urlSchemeRegex=Wi.ctrlCharactersRegex=Wi.htmlCtrlEntityRegex=Wi.htmlEntitiesRegex=Wi.invalidProtocolRegex=void 0,Wi.invalidProtocolRegex=/^([^\w]*)(javascript|data|vbscript)/im,Wi.htmlEntitiesRegex=/&#(\w+)(^\w|;)?/g,Wi.htmlCtrlEntityRegex=/&(newline|tab);/gi,Wi.ctrlCharactersRegex=/[\u0000-\u001F\u007F-\u009F\u2000-\u200D\uFEFF]/gim,Wi.urlSchemeRegex=/^.+(:|&colon;)/gim,Wi.whitespaceEscapeCharsRegex=/(\\|%5[cC])((%(6[eE]|72|74))|[nrt])/g,Wi.relativeFirstCharacters=[".","/"],Wi.BLANK_URL="about:blank"),Wi}var QV;function get(){if(QV)return ix;QV=1,Object.defineProperty(ix,"__esModule",{value:!0}),ix.sanitizeUrl=void 0;var e=met();function t(a){return e.relativeFirstCharacters.indexOf(a[0])>-1}function n(a){var o=a.replace(e.ctrlCharactersRegex,"");return o.replace(e.htmlEntitiesRegex,function(l,c){return String.fromCharCode(c)})}function r(a){return URL.canParse(a)}function s(a){try{return decodeURIComponent(a)}catch{return a}}function i(a){if(!a)return e.BLANK_URL;var o,l=s(a.trim());do l=n(l).replace(e.htmlCtrlEntityRegex,"").replace(e.ctrlCharactersRegex,"").replace(e.whitespaceEscapeCharsRegex,"").trim(),l=s(l),o=l.match(e.ctrlCharactersRegex)||l.match(e.htmlEntitiesRegex)||l.match(e.htmlCtrlEntityRegex)||l.match(e.whitespaceEscapeCharsRegex);while(o&&o.length>0);var c=l;if(!c)return e.BLANK_URL;if(t(c))return c;var u=c.trimStart(),d=u.match(e.urlSchemeRegex);if(!d)return c;var h=d[0].toLowerCase().trim();if(e.invalidProtocolRegex.test(h))return e.BLANK_URL;var m=u.replace(/\\/g,"/");if(h==="mailto:"||h.includes("://"))return m;if(h==="http:"||h==="https:"){if(!r(m))return e.BLANK_URL;var y=new URL(m);return y.protocol=y.protocol.toLowerCase(),y.hostname=y.hostname.toLowerCase(),y.toString()}return m}return ix.sanitizeUrl=i,ix}var yet=get(),bet={value:()=>{}};function cle(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new c2(n)}function c2(e){this._=e}function vet(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",s=n.indexOf(".");if(s>=0&&(r=n.slice(s+1),n=n.slice(0,s)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}c2.prototype=cle.prototype={constructor:c2,on:function(e,t){var n=this._,r=vet(e+"",n),s,i=-1,a=r.length;if(arguments.length<2){for(;++i<a;)if((s=(e=r[i]).type)&&(s=xet(n[s],e.name)))return s;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++i<a;)if(s=(e=r[i]).type)n[s]=eW(n[s],e.name,t);else if(t==null)for(s in n)n[s]=eW(n[s],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new c2(e)},call:function(e,t){if((s=arguments.length-2)>0)for(var n=new Array(s),r=0,s,i;r<s;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(i=this._[e],r=0,s=i.length;r<s;++r)i[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],s=0,i=r.length;s<i;++s)r[s].value.apply(t,n)}};function xet(e,t){for(var n=0,r=e.length,s;n<r;++n)if((s=e[n]).name===t)return s.value}function eW(e,t,n){for(var r=0,s=e.length;r<s;++r)if(e[r].name===t){e[r]=bet,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var w4="http://www.w3.org/1999/xhtml";const tW={svg:"http://www.w3.org/2000/svg",xhtml:w4,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function pA(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),tW.hasOwnProperty(t)?{space:tW[t],local:e}:e}function wet(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===w4&&t.documentElement.namespaceURI===w4?t.createElement(e):t.createElementNS(n,e)}}function _et(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function ule(e){var t=pA(e);return(t.local?_et:wet)(t)}function Cet(){}function H6(e){return e==null?Cet:function(){return this.querySelector(e)}}function ket(e){typeof e!="function"&&(e=H6(e));for(var t=this._groups,n=t.length,r=new Array(n),s=0;s<n;++s)for(var i=t[s],a=i.length,o=r[s]=new Array(a),l,c,u=0;u<a;++u)(l=i[u])&&(c=e.call(l,l.__data__,u,i))&&("__data__"in l&&(c.__data__=l.__data__),o[u]=c);return new kl(r,this._parents)}function Eet(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function Tet(){return[]}function dle(e){return e==null?Tet:function(){return this.querySelectorAll(e)}}function Aet(e){return function(){return Eet(e.apply(this,arguments))}}function Ret(e){typeof e=="function"?e=Aet(e):e=dle(e);for(var t=this._groups,n=t.length,r=[],s=[],i=0;i<n;++i)for(var a=t[i],o=a.length,l,c=0;c<o;++c)(l=a[c])&&(r.push(e.call(l,l.__data__,c,a)),s.push(l));return new kl(r,s)}function fle(e){return function(){return this.matches(e)}}function hle(e){return function(t){return t.matches(e)}}var Net=Array.prototype.find;function Iet(e){return function(){return Net.call(this.children,e)}}function Met(){return this.firstElementChild}function jet(e){return this.select(e==null?Met:Iet(typeof e=="function"?e:hle(e)))}var Pet=Array.prototype.filter;function Oet(){return Array.from(this.children)}function Det(e){return function(){return Pet.call(this.children,e)}}function Fet(e){return this.selectAll(e==null?Oet:Det(typeof e=="function"?e:hle(e)))}function Let(e){typeof e!="function"&&(e=fle(e));for(var t=this._groups,n=t.length,r=new Array(n),s=0;s<n;++s)for(var i=t[s],a=i.length,o=r[s]=[],l,c=0;c<a;++c)(l=i[c])&&e.call(l,l.__data__,c,i)&&o.push(l);return new kl(r,this._parents)}function ple(e){return new Array(e.length)}function Bet(){return new kl(this._enter||this._groups.map(ple),this._parents)}function nE(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}nE.prototype={constructor:nE,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function $et(e){return function(){return e}}function zet(e,t,n,r,s,i){for(var a=0,o,l=t.length,c=i.length;a<c;++a)(o=t[a])?(o.__data__=i[a],r[a]=o):n[a]=new nE(e,i[a]);for(;a<l;++a)(o=t[a])&&(s[a]=o)}function Uet(e,t,n,r,s,i,a){var o,l,c=new Map,u=t.length,d=i.length,h=new Array(u),m;for(o=0;o<u;++o)(l=t[o])&&(h[o]=m=a.call(l,l.__data__,o,t)+"",c.has(m)?s[o]=l:c.set(m,l));for(o=0;o<d;++o)m=a.call(e,i[o],o,i)+"",(l=c.get(m))?(r[o]=l,l.__data__=i[o],c.delete(m)):n[o]=new nE(e,i[o]);for(o=0;o<u;++o)(l=t[o])&&c.get(h[o])===l&&(s[o]=l)}function qet(e){return e.__data__}function Vet(e,t){if(!arguments.length)return Array.from(this,qet);var n=t?Uet:zet,r=this._parents,s=this._groups;typeof e!="function"&&(e=$et(e));for(var i=s.length,a=new Array(i),o=new Array(i),l=new Array(i),c=0;c<i;++c){var u=r[c],d=s[c],h=d.length,m=Wet(e.call(u,u&&u.__data__,c,r)),y=m.length,b=o[c]=new Array(y),v=a[c]=new Array(y),x=l[c]=new Array(h);n(u,d,b,v,x,m,t);for(var w=0,_=0,k,C;w<y;++w)if(k=b[w]){for(w>=_&&(_=w+1);!(C=v[_])&&++_<y;);k._next=C||null}}return a=new kl(a,r),a._enter=o,a._exit=l,a}function Wet(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Het(){return new kl(this._exit||this._groups.map(ple),this._parents)}function Get(e,t,n){var r=this.enter(),s=this,i=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),t!=null&&(s=t(s),s&&(s=s.selection())),n==null?i.remove():n(i),r&&s?r.merge(s).order():s}function Ket(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,s=n.length,i=r.length,a=Math.min(s,i),o=new Array(s),l=0;l<a;++l)for(var c=n[l],u=r[l],d=c.length,h=o[l]=new Array(d),m,y=0;y<d;++y)(m=c[y]||u[y])&&(h[y]=m);for(;l<s;++l)o[l]=n[l];return new kl(o,this._parents)}function Yet(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],s=r.length-1,i=r[s],a;--s>=0;)(a=r[s])&&(i&&a.compareDocumentPosition(i)^4&&i.parentNode.insertBefore(a,i),i=a);return this}function Zet(e){e||(e=Xet);function t(d,h){return d&&h?e(d.__data__,h.__data__):!d-!h}for(var n=this._groups,r=n.length,s=new Array(r),i=0;i<r;++i){for(var a=n[i],o=a.length,l=s[i]=new Array(o),c,u=0;u<o;++u)(c=a[u])&&(l[u]=c);l.sort(t)}return new kl(s,this._parents).order()}function Xet(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function Jet(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function Qet(){return Array.from(this)}function ett(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],s=0,i=r.length;s<i;++s){var a=r[s];if(a)return a}return null}function ttt(){let e=0;for(const t of this)++e;return e}function ntt(){return!this.node()}function rtt(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var s=t[n],i=0,a=s.length,o;i<a;++i)(o=s[i])&&e.call(o,o.__data__,i,s);return this}function stt(e){return function(){this.removeAttribute(e)}}function itt(e){return function(){this.removeAttributeNS(e.space,e.local)}}function att(e,t){return function(){this.setAttribute(e,t)}}function ott(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function ltt(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function ctt(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function utt(e,t){var n=pA(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?itt:stt:typeof t=="function"?n.local?ctt:ltt:n.local?ott:att)(n,t))}function mle(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function dtt(e){return function(){this.style.removeProperty(e)}}function ftt(e,t,n){return function(){this.style.setProperty(e,t,n)}}function htt(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function ptt(e,t,n){return arguments.length>1?this.each((t==null?dtt:typeof t=="function"?htt:ftt)(e,t,n??"")):Hy(this.node(),e)}function Hy(e,t){return e.style.getPropertyValue(t)||mle(e).getComputedStyle(e,null).getPropertyValue(t)}function mtt(e){return function(){delete this[e]}}function gtt(e,t){return function(){this[e]=t}}function ytt(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function btt(e,t){return arguments.length>1?this.each((t==null?mtt:typeof t=="function"?ytt:gtt)(e,t)):this.node()[e]}function gle(e){return e.trim().split(/^|\s+/)}function G6(e){return e.classList||new yle(e)}function yle(e){this._node=e,this._names=gle(e.getAttribute("class")||"")}yle.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function ble(e,t){for(var n=G6(e),r=-1,s=t.length;++r<s;)n.add(t[r])}function vle(e,t){for(var n=G6(e),r=-1,s=t.length;++r<s;)n.remove(t[r])}function vtt(e){return function(){ble(this,e)}}function xtt(e){return function(){vle(this,e)}}function wtt(e,t){return function(){(t.apply(this,arguments)?ble:vle)(this,e)}}function Stt(e,t){var n=gle(e+"");if(arguments.length<2){for(var r=G6(this.node()),s=-1,i=n.length;++s<i;)if(!r.contains(n[s]))return!1;return!0}return this.each((typeof t=="function"?wtt:t?vtt:xtt)(n,t))}function _tt(){this.textContent=""}function Ctt(e){return function(){this.textContent=e}}function ktt(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function Ett(e){return arguments.length?this.each(e==null?_tt:(typeof e=="function"?ktt:Ctt)(e)):this.node().textContent}function Ttt(){this.innerHTML=""}function Att(e){return function(){this.innerHTML=e}}function Rtt(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function Ntt(e){return arguments.length?this.each(e==null?Ttt:(typeof e=="function"?Rtt:Att)(e)):this.node().innerHTML}function Itt(){this.nextSibling&&this.parentNode.appendChild(this)}function Mtt(){return this.each(Itt)}function jtt(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Ptt(){return this.each(jtt)}function Ott(e){var t=typeof e=="function"?e:ule(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function Dtt(){return null}function Ftt(e,t){var n=typeof e=="function"?e:ule(e),r=t==null?Dtt:typeof t=="function"?t:H6(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function Ltt(){var e=this.parentNode;e&&e.removeChild(this)}function Btt(){return this.each(Ltt)}function $tt(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function ztt(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Utt(e){return this.select(e?ztt:$tt)}function qtt(e){return arguments.length?this.property("__data__",e):this.node().__data__}function Vtt(e){return function(t){e.call(this,t,this.__data__)}}function Wtt(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function Htt(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,s=t.length,i;n<s;++n)i=t[n],(!e.type||i.type===e.type)&&i.name===e.name?this.removeEventListener(i.type,i.listener,i.options):t[++r]=i;++r?t.length=r:delete this.__on}}}function Gtt(e,t,n){return function(){var r=this.__on,s,i=Vtt(t);if(r){for(var a=0,o=r.length;a<o;++a)if((s=r[a]).type===e.type&&s.name===e.name){this.removeEventListener(s.type,s.listener,s.options),this.addEventListener(s.type,s.listener=i,s.options=n),s.value=t;return}}this.addEventListener(e.type,i,n),s={type:e.type,name:e.name,value:t,listener:i,options:n},r?r.push(s):this.__on=[s]}}function Ktt(e,t,n){var r=Wtt(e+""),s,i=r.length,a;if(arguments.length<2){var o=this.node().__on;if(o){for(var l=0,c=o.length,u;l<c;++l)for(s=0,u=o[l];s<i;++s)if((a=r[s]).type===u.type&&a.name===u.name)return u.value}return}for(o=t?Gtt:Htt,s=0;s<i;++s)this.each(o(r[s],t,n));return this}function xle(e,t,n){var r=mle(e),s=r.CustomEvent;typeof s=="function"?s=new s(t,n):(s=r.document.createEvent("Event"),n?(s.initEvent(t,n.bubbles,n.cancelable),s.detail=n.detail):s.initEvent(t,!1,!1)),e.dispatchEvent(s)}function Ytt(e,t){return function(){return xle(this,e,t)}}function Ztt(e,t){return function(){return xle(this,e,t.apply(this,arguments))}}function Xtt(e,t){return this.each((typeof t=="function"?Ztt:Ytt)(e,t))}function*Jtt(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],s=0,i=r.length,a;s<i;++s)(a=r[s])&&(yield a)}var wle=[null];function kl(e,t){this._groups=e,this._parents=t}function kS(){return new kl([[document.documentElement]],wle)}function Qtt(){return this}kl.prototype=kS.prototype={constructor:kl,select:ket,selectAll:Ret,selectChild:jet,selectChildren:Fet,filter:Let,data:Vet,enter:Bet,exit:Het,join:Get,merge:Ket,selection:Qtt,order:Yet,sort:Zet,call:Jet,nodes:Qet,node:ett,size:ttt,empty:ntt,each:rtt,attr:utt,style:ptt,property:btt,classed:Stt,text:Ett,html:Ntt,raise:Mtt,lower:Ptt,append:Ott,insert:Ftt,remove:Btt,clone:Utt,datum:qtt,on:Ktt,dispatch:Xtt,[Symbol.iterator]:Jtt};function Zr(e){return typeof e=="string"?new kl([[document.querySelector(e)]],[document.documentElement]):new kl([[e]],wle)}function K6(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function Sle(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function ES(){}var g1=.7,rE=1/g1,Q0="\\s*([+-]?\\d+)\\s*",y1="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Bu="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",ent=/^#([0-9a-f]{3,8})$/,tnt=new RegExp(`^rgb\\(${Q0},${Q0},${Q0}\\)$`),nnt=new RegExp(`^rgb\\(${Bu},${Bu},${Bu}\\)$`),rnt=new RegExp(`^rgba\\(${Q0},${Q0},${Q0},${y1}\\)$`),snt=new RegExp(`^rgba\\(${Bu},${Bu},${Bu},${y1}\\)$`),int=new RegExp(`^hsl\\(${y1},${Bu},${Bu}\\)$`),ant=new RegExp(`^hsla\\(${y1},${Bu},${Bu},${y1}\\)$`),nW={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};K6(ES,b1,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:rW,formatHex:rW,formatHex8:ont,formatHsl:lnt,formatRgb:sW,toString:sW});function rW(){return this.rgb().formatHex()}function ont(){return this.rgb().formatHex8()}function lnt(){return _le(this).formatHsl()}function sW(){return this.rgb().formatRgb()}function b1(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=ent.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?iW(t):n===3?new qo(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?MC(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?MC(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=tnt.exec(e))?new qo(t[1],t[2],t[3],1):(t=nnt.exec(e))?new qo(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=rnt.exec(e))?MC(t[1],t[2],t[3],t[4]):(t=snt.exec(e))?MC(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=int.exec(e))?lW(t[1],t[2]/100,t[3]/100,1):(t=ant.exec(e))?lW(t[1],t[2]/100,t[3]/100,t[4]):nW.hasOwnProperty(e)?iW(nW[e]):e==="transparent"?new qo(NaN,NaN,NaN,0):null}function iW(e){return new qo(e>>16&255,e>>8&255,e&255,1)}function MC(e,t,n,r){return r<=0&&(e=t=n=NaN),new qo(e,t,n,r)}function cnt(e){return e instanceof ES||(e=b1(e)),e?(e=e.rgb(),new qo(e.r,e.g,e.b,e.opacity)):new qo}function S4(e,t,n,r){return arguments.length===1?cnt(e):new qo(e,t,n,r??1)}function qo(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}K6(qo,S4,Sle(ES,{brighter(e){return e=e==null?rE:Math.pow(rE,e),new qo(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?g1:Math.pow(g1,e),new qo(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new qo(Cm(this.r),Cm(this.g),Cm(this.b),sE(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:aW,formatHex:aW,formatHex8:unt,formatRgb:oW,toString:oW}));function aW(){return`#${bm(this.r)}${bm(this.g)}${bm(this.b)}`}function unt(){return`#${bm(this.r)}${bm(this.g)}${bm(this.b)}${bm((isNaN(this.opacity)?1:this.opacity)*255)}`}function oW(){const e=sE(this.opacity);return`${e===1?"rgb(":"rgba("}${Cm(this.r)}, ${Cm(this.g)}, ${Cm(this.b)}${e===1?")":`, ${e})`}`}function sE(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Cm(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function bm(e){return e=Cm(e),(e<16?"0":"")+e.toString(16)}function lW(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Mc(e,t,n,r)}function _le(e){if(e instanceof Mc)return new Mc(e.h,e.s,e.l,e.opacity);if(e instanceof ES||(e=b1(e)),!e)return new Mc;if(e instanceof Mc)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,s=Math.min(t,n,r),i=Math.max(t,n,r),a=NaN,o=i-s,l=(i+s)/2;return o?(t===i?a=(n-r)/o+(n<r)*6:n===i?a=(r-t)/o+2:a=(t-n)/o+4,o/=l<.5?i+s:2-i-s,a*=60):o=l>0&&l<1?0:a,new Mc(a,o,l,e.opacity)}function dnt(e,t,n,r){return arguments.length===1?_le(e):new Mc(e,t,n,r??1)}function Mc(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}K6(Mc,dnt,Sle(ES,{brighter(e){return e=e==null?rE:Math.pow(rE,e),new Mc(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?g1:Math.pow(g1,e),new Mc(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,s=2*n-r;return new qo(Uj(e>=240?e-240:e+120,s,r),Uj(e,s,r),Uj(e<120?e+240:e-120,s,r),this.opacity)},clamp(){return new Mc(cW(this.h),jC(this.s),jC(this.l),sE(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=sE(this.opacity);return`${e===1?"hsl(":"hsla("}${cW(this.h)}, ${jC(this.s)*100}%, ${jC(this.l)*100}%${e===1?")":`, ${e})`}`}}));function cW(e){return e=(e||0)%360,e<0?e+360:e}function jC(e){return Math.max(0,Math.min(1,e||0))}function Uj(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const Y6=e=>()=>e;function Cle(e,t){return function(n){return e+n*t}}function fnt(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function Yft(e,t){var n=t-e;return n?Cle(e,n>180||n<-180?n-360*Math.round(n/360):n):Y6(isNaN(e)?t:e)}function hnt(e){return(e=+e)==1?kle:function(t,n){return n-t?fnt(t,n,e):Y6(isNaN(t)?n:t)}}function kle(e,t){var n=t-e;return n?Cle(e,n):Y6(isNaN(e)?t:e)}const uW=function e(t){var n=hnt(t);function r(s,i){var a=n((s=S4(s)).r,(i=S4(i)).r),o=n(s.g,i.g),l=n(s.b,i.b),c=kle(s.opacity,i.opacity);return function(u){return s.r=a(u),s.g=o(u),s.b=l(u),s.opacity=c(u),s+""}}return r.gamma=e,r}(1);function Sh(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var _4=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,qj=new RegExp(_4.source,"g");function pnt(e){return function(){return e}}function mnt(e){return function(t){return e(t)+""}}function gnt(e,t){var n=_4.lastIndex=qj.lastIndex=0,r,s,i,a=-1,o=[],l=[];for(e=e+"",t=t+"";(r=_4.exec(e))&&(s=qj.exec(t));)(i=s.index)>n&&(i=t.slice(n,i),o[a]?o[a]+=i:o[++a]=i),(r=r[0])===(s=s[0])?o[a]?o[a]+=s:o[++a]=s:(o[++a]=null,l.push({i:a,x:Sh(r,s)})),n=qj.lastIndex;return n<t.length&&(i=t.slice(n),o[a]?o[a]+=i:o[++a]=i),o.length<2?l[0]?mnt(l[0].x):pnt(t):(t=l.length,function(c){for(var u=0,d;u<t;++u)o[(d=l[u]).i]=d.x(c);return o.join("")})}var dW=180/Math.PI,C4={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Ele(e,t,n,r,s,i){var a,o,l;return(a=Math.sqrt(e*e+t*t))&&(e/=a,t/=a),(l=e*n+t*r)&&(n-=e*l,r-=t*l),(o=Math.sqrt(n*n+r*r))&&(n/=o,r/=o,l/=o),e*r<t*n&&(e=-e,t=-t,l=-l,a=-a),{translateX:s,translateY:i,rotate:Math.atan2(t,e)*dW,skewX:Math.atan(l)*dW,scaleX:a,scaleY:o}}var PC;function ynt(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?C4:Ele(t.a,t.b,t.c,t.d,t.e,t.f)}function bnt(e){return e==null||(PC||(PC=document.createElementNS("http://www.w3.org/2000/svg","g")),PC.setAttribute("transform",e),!(e=PC.transform.baseVal.consolidate()))?C4:(e=e.matrix,Ele(e.a,e.b,e.c,e.d,e.e,e.f))}function Tle(e,t,n,r){function s(c){return c.length?c.pop()+" ":""}function i(c,u,d,h,m,y){if(c!==d||u!==h){var b=m.push("translate(",null,t,null,n);y.push({i:b-4,x:Sh(c,d)},{i:b-2,x:Sh(u,h)})}else(d||h)&&m.push("translate("+d+t+h+n)}function a(c,u,d,h){c!==u?(c-u>180?u+=360:u-c>180&&(c+=360),h.push({i:d.push(s(d)+"rotate(",null,r)-2,x:Sh(c,u)})):u&&d.push(s(d)+"rotate("+u+r)}function o(c,u,d,h){c!==u?h.push({i:d.push(s(d)+"skewX(",null,r)-2,x:Sh(c,u)}):u&&d.push(s(d)+"skewX("+u+r)}function l(c,u,d,h,m,y){if(c!==d||u!==h){var b=m.push(s(m)+"scale(",null,",",null,")");y.push({i:b-4,x:Sh(c,d)},{i:b-2,x:Sh(u,h)})}else(d!==1||h!==1)&&m.push(s(m)+"scale("+d+","+h+")")}return function(c,u){var d=[],h=[];return c=e(c),u=e(u),i(c.translateX,c.translateY,u.translateX,u.translateY,d,h),a(c.rotate,u.rotate,d,h),o(c.skewX,u.skewX,d,h),l(c.scaleX,c.scaleY,u.scaleX,u.scaleY,d,h),c=u=null,function(m){for(var y=-1,b=h.length,v;++y<b;)d[(v=h[y]).i]=v.x(m);return d.join("")}}}var vnt=Tle(ynt,"px, ","px)","deg)"),xnt=Tle(bnt,", ",")",")"),Gy=0,Rx=0,ax=0,Ale=1e3,iE,Nx,aE=0,Wm=0,mA=0,v1=typeof performance=="object"&&performance.now?performance:Date,Rle=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Z6(){return Wm||(Rle(wnt),Wm=v1.now()+mA)}function wnt(){Wm=0}function oE(){this._call=this._time=this._next=null}oE.prototype=Nle.prototype={constructor:oE,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?Z6():+n)+(t==null?0:+t),!this._next&&Nx!==this&&(Nx?Nx._next=this:iE=this,Nx=this),this._call=e,this._time=n,k4()},stop:function(){this._call&&(this._call=null,this._time=1/0,k4())}};function Nle(e,t,n){var r=new oE;return r.restart(e,t,n),r}function Snt(){Z6(),++Gy;for(var e=iE,t;e;)(t=Wm-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Gy}function fW(){Wm=(aE=v1.now())+mA,Gy=Rx=0;try{Snt()}finally{Gy=0,Cnt(),Wm=0}}function _nt(){var e=v1.now(),t=e-aE;t>Ale&&(mA-=t,aE=e)}function Cnt(){for(var e,t=iE,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:iE=n);Nx=e,k4(r)}function k4(e){if(!Gy){Rx&&(Rx=clearTimeout(Rx));var t=e-Wm;t>24?(e<1/0&&(Rx=setTimeout(fW,e-v1.now()-mA)),ax&&(ax=clearInterval(ax))):(ax||(aE=v1.now(),ax=setInterval(_nt,Ale)),Gy=1,Rle(fW))}}function hW(e,t,n){var r=new oE;return t=t==null?0:+t,r.restart(s=>{r.stop(),e(s+t)},t,n),r}var knt=cle("start","end","cancel","interrupt"),Ent=[],Ile=0,pW=1,E4=2,u2=3,mW=4,T4=5,d2=6;function gA(e,t,n,r,s,i){var a=e.__transition;if(!a)e.__transition={};else if(n in a)return;Tnt(e,n,{name:t,index:r,group:s,on:knt,tween:Ent,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:Ile})}function X6(e,t){var n=tu(e,t);if(n.state>Ile)throw new Error("too late; already scheduled");return n}function id(e,t){var n=tu(e,t);if(n.state>u2)throw new Error("too late; already running");return n}function tu(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function Tnt(e,t,n){var r=e.__transition,s;r[t]=n,n.timer=Nle(i,0,n.time);function i(c){n.state=pW,n.timer.restart(a,n.delay,n.time),n.delay<=c&&a(c-n.delay)}function a(c){var u,d,h,m;if(n.state!==pW)return l();for(u in r)if(m=r[u],m.name===n.name){if(m.state===u2)return hW(a);m.state===mW?(m.state=d2,m.timer.stop(),m.on.call("interrupt",e,e.__data__,m.index,m.group),delete r[u]):+u<t&&(m.state=d2,m.timer.stop(),m.on.call("cancel",e,e.__data__,m.index,m.group),delete r[u])}if(hW(function(){n.state===u2&&(n.state=mW,n.timer.restart(o,n.delay,n.time),o(c))}),n.state=E4,n.on.call("start",e,e.__data__,n.index,n.group),n.state===E4){for(n.state=u2,s=new Array(h=n.tween.length),u=0,d=-1;u<h;++u)(m=n.tween[u].value.call(e,e.__data__,n.index,n.group))&&(s[++d]=m);s.length=d+1}}function o(c){for(var u=c<n.duration?n.ease.call(null,c/n.duration):(n.timer.restart(l),n.state=T4,1),d=-1,h=s.length;++d<h;)s[d].call(e,u);n.state===T4&&(n.on.call("end",e,e.__data__,n.index,n.group),l())}function l(){n.state=d2,n.timer.stop(),delete r[t];for(var c in r)return;delete e.__transition}}function Ant(e,t){var n=e.__transition,r,s,i=!0,a;if(n){t=t==null?null:t+"";for(a in n){if((r=n[a]).name!==t){i=!1;continue}s=r.state>E4&&r.state<T4,r.state=d2,r.timer.stop(),r.on.call(s?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[a]}i&&delete e.__transition}}function Rnt(e){return this.each(function(){Ant(this,e)})}function Nnt(e,t){var n,r;return function(){var s=id(this,e),i=s.tween;if(i!==n){r=n=i;for(var a=0,o=r.length;a<o;++a)if(r[a].name===t){r=r.slice(),r.splice(a,1);break}}s.tween=r}}function Int(e,t,n){var r,s;if(typeof n!="function")throw new Error;return function(){var i=id(this,e),a=i.tween;if(a!==r){s=(r=a).slice();for(var o={name:t,value:n},l=0,c=s.length;l<c;++l)if(s[l].name===t){s[l]=o;break}l===c&&s.push(o)}i.tween=s}}function Mnt(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=tu(this.node(),n).tween,s=0,i=r.length,a;s<i;++s)if((a=r[s]).name===e)return a.value;return null}return this.each((t==null?Nnt:Int)(n,e,t))}function J6(e,t,n){var r=e._id;return e.each(function(){var s=id(this,r);(s.value||(s.value={}))[t]=n.apply(this,arguments)}),function(s){return tu(s,r).value[t]}}function Mle(e,t){var n;return(typeof t=="number"?Sh:t instanceof b1?uW:(n=b1(t))?(t=n,uW):gnt)(e,t)}function jnt(e){return function(){this.removeAttribute(e)}}function Pnt(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Ont(e,t,n){var r,s=n+"",i;return function(){var a=this.getAttribute(e);return a===s?null:a===r?i:i=t(r=a,n)}}function Dnt(e,t,n){var r,s=n+"",i;return function(){var a=this.getAttributeNS(e.space,e.local);return a===s?null:a===r?i:i=t(r=a,n)}}function Fnt(e,t,n){var r,s,i;return function(){var a,o=n(this),l;return o==null?void this.removeAttribute(e):(a=this.getAttribute(e),l=o+"",a===l?null:a===r&&l===s?i:(s=l,i=t(r=a,o)))}}function Lnt(e,t,n){var r,s,i;return function(){var a,o=n(this),l;return o==null?void this.removeAttributeNS(e.space,e.local):(a=this.getAttributeNS(e.space,e.local),l=o+"",a===l?null:a===r&&l===s?i:(s=l,i=t(r=a,o)))}}function Bnt(e,t){var n=pA(e),r=n==="transform"?xnt:Mle;return this.attrTween(e,typeof t=="function"?(n.local?Lnt:Fnt)(n,r,J6(this,"attr."+e,t)):t==null?(n.local?Pnt:jnt)(n):(n.local?Dnt:Ont)(n,r,t))}function $nt(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function znt(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function Unt(e,t){var n,r;function s(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&znt(e,i)),n}return s._value=t,s}function qnt(e,t){var n,r;function s(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&$nt(e,i)),n}return s._value=t,s}function Vnt(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=pA(e);return this.tween(n,(r.local?Unt:qnt)(r,t))}function Wnt(e,t){return function(){X6(this,e).delay=+t.apply(this,arguments)}}function Hnt(e,t){return t=+t,function(){X6(this,e).delay=t}}function Gnt(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Wnt:Hnt)(t,e)):tu(this.node(),t).delay}function Knt(e,t){return function(){id(this,e).duration=+t.apply(this,arguments)}}function Ynt(e,t){return t=+t,function(){id(this,e).duration=t}}function Znt(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Knt:Ynt)(t,e)):tu(this.node(),t).duration}function Xnt(e,t){if(typeof t!="function")throw new Error;return function(){id(this,e).ease=t}}function Jnt(e){var t=this._id;return arguments.length?this.each(Xnt(t,e)):tu(this.node(),t).ease}function Qnt(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;id(this,e).ease=n}}function ert(e){if(typeof e!="function")throw new Error;return this.each(Qnt(this._id,e))}function trt(e){typeof e!="function"&&(e=fle(e));for(var t=this._groups,n=t.length,r=new Array(n),s=0;s<n;++s)for(var i=t[s],a=i.length,o=r[s]=[],l,c=0;c<a;++c)(l=i[c])&&e.call(l,l.__data__,c,i)&&o.push(l);return new hf(r,this._parents,this._name,this._id)}function nrt(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,s=n.length,i=Math.min(r,s),a=new Array(r),o=0;o<i;++o)for(var l=t[o],c=n[o],u=l.length,d=a[o]=new Array(u),h,m=0;m<u;++m)(h=l[m]||c[m])&&(d[m]=h);for(;o<r;++o)a[o]=t[o];return new hf(a,this._parents,this._name,this._id)}function rrt(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function srt(e,t,n){var r,s,i=rrt(t)?X6:id;return function(){var a=i(this,e),o=a.on;o!==r&&(s=(r=o).copy()).on(t,n),a.on=s}}function irt(e,t){var n=this._id;return arguments.length<2?tu(this.node(),n).on.on(e):this.each(srt(n,e,t))}function art(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function ort(){return this.on("end.remove",art(this._id))}function lrt(e){var t=this._name,n=this._id;typeof e!="function"&&(e=H6(e));for(var r=this._groups,s=r.length,i=new Array(s),a=0;a<s;++a)for(var o=r[a],l=o.length,c=i[a]=new Array(l),u,d,h=0;h<l;++h)(u=o[h])&&(d=e.call(u,u.__data__,h,o))&&("__data__"in u&&(d.__data__=u.__data__),c[h]=d,gA(c[h],t,n,h,c,tu(u,n)));return new hf(i,this._parents,t,n)}function crt(e){var t=this._name,n=this._id;typeof e!="function"&&(e=dle(e));for(var r=this._groups,s=r.length,i=[],a=[],o=0;o<s;++o)for(var l=r[o],c=l.length,u,d=0;d<c;++d)if(u=l[d]){for(var h=e.call(u,u.__data__,d,l),m,y=tu(u,n),b=0,v=h.length;b<v;++b)(m=h[b])&&gA(m,t,n,b,h,y);i.push(h),a.push(u)}return new hf(i,a,t,n)}var urt=kS.prototype.constructor;function drt(){return new urt(this._groups,this._parents)}function frt(e,t){var n,r,s;return function(){var i=Hy(this,e),a=(this.style.removeProperty(e),Hy(this,e));return i===a?null:i===n&&a===r?s:s=t(n=i,r=a)}}function jle(e){return function(){this.style.removeProperty(e)}}function hrt(e,t,n){var r,s=n+"",i;return function(){var a=Hy(this,e);return a===s?null:a===r?i:i=t(r=a,n)}}function prt(e,t,n){var r,s,i;return function(){var a=Hy(this,e),o=n(this),l=o+"";return o==null&&(l=o=(this.style.removeProperty(e),Hy(this,e))),a===l?null:a===r&&l===s?i:(s=l,i=t(r=a,o))}}function mrt(e,t){var n,r,s,i="style."+t,a="end."+i,o;return function(){var l=id(this,e),c=l.on,u=l.value[i]==null?o||(o=jle(t)):void 0;(c!==n||s!==u)&&(r=(n=c).copy()).on(a,s=u),l.on=r}}function grt(e,t,n){var r=(e+="")=="transform"?vnt:Mle;return t==null?this.styleTween(e,frt(e,r)).on("end.style."+e,jle(e)):typeof t=="function"?this.styleTween(e,prt(e,r,J6(this,"style."+e,t))).each(mrt(this._id,e)):this.styleTween(e,hrt(e,r,t),n).on("end.style."+e,null)}function yrt(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function brt(e,t,n){var r,s;function i(){var a=t.apply(this,arguments);return a!==s&&(r=(s=a)&&yrt(e,a,n)),r}return i._value=t,i}function vrt(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,brt(e,t,n??""))}function xrt(e){return function(){this.textContent=e}}function wrt(e){return function(){var t=e(this);this.textContent=t??""}}function Srt(e){return this.tween("text",typeof e=="function"?wrt(J6(this,"text",e)):xrt(e==null?"":e+""))}function _rt(e){return function(t){this.textContent=e.call(this,t)}}function Crt(e){var t,n;function r(){var s=e.apply(this,arguments);return s!==n&&(t=(n=s)&&_rt(s)),t}return r._value=e,r}function krt(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,Crt(e))}function Ert(){for(var e=this._name,t=this._id,n=Ple(),r=this._groups,s=r.length,i=0;i<s;++i)for(var a=r[i],o=a.length,l,c=0;c<o;++c)if(l=a[c]){var u=tu(l,t);gA(l,e,n,c,a,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new hf(r,this._parents,e,n)}function Trt(){var e,t,n=this,r=n._id,s=n.size();return new Promise(function(i,a){var o={value:a},l={value:function(){--s===0&&i()}};n.each(function(){var c=id(this,r),u=c.on;u!==e&&(t=(e=u).copy(),t._.cancel.push(o),t._.interrupt.push(o),t._.end.push(l)),c.on=t}),s===0&&i()})}var Art=0;function hf(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function Ple(){return++Art}var Pd=kS.prototype;hf.prototype={constructor:hf,select:lrt,selectAll:crt,selectChild:Pd.selectChild,selectChildren:Pd.selectChildren,filter:trt,merge:nrt,selection:drt,transition:Ert,call:Pd.call,nodes:Pd.nodes,node:Pd.node,size:Pd.size,empty:Pd.empty,each:Pd.each,on:irt,attr:Bnt,attrTween:Vnt,style:grt,styleTween:vrt,text:Srt,textTween:krt,remove:ort,tween:Mnt,delay:Gnt,duration:Znt,ease:Jnt,easeVarying:ert,end:Trt,[Symbol.iterator]:Pd[Symbol.iterator]};function Rrt(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var Nrt={time:null,delay:0,duration:250,ease:Rrt};function Irt(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function Mrt(e){var t,n;e instanceof hf?(t=e._id,e=e._name):(t=Ple(),(n=Nrt).time=Z6(),e=e==null?null:e+"");for(var r=this._groups,s=r.length,i=0;i<s;++i)for(var a=r[i],o=a.length,l,c=0;c<o;++c)(l=a[c])&&gA(l,e,t,c,a,n||Irt(l,t));return new hf(r,this._parents,e,t)}kS.prototype.interrupt=Rnt;kS.prototype.transition=Mrt;const A4=Math.PI,R4=2*A4,nm=1e-6,jrt=R4-nm;function Ole(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function Prt(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return Ole;const n=10**t;return function(r){this._+=r[0];for(let s=1,i=r.length;s<i;++s)this._+=Math.round(arguments[s]*n)/n+r[s]}}class Ort{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?Ole:Prt(t)}moveTo(t,n){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,n){this._append`L${this._x1=+t},${this._y1=+n}`}quadraticCurveTo(t,n,r,s){this._append`Q${+t},${+n},${this._x1=+r},${this._y1=+s}`}bezierCurveTo(t,n,r,s,i,a){this._append`C${+t},${+n},${+r},${+s},${this._x1=+i},${this._y1=+a}`}arcTo(t,n,r,s,i){if(t=+t,n=+n,r=+r,s=+s,i=+i,i<0)throw new Error(`negative radius: ${i}`);let a=this._x1,o=this._y1,l=r-t,c=s-n,u=a-t,d=o-n,h=u*u+d*d;if(this._x1===null)this._append`M${this._x1=t},${this._y1=n}`;else if(h>nm)if(!(Math.abs(d*l-c*u)>nm)||!i)this._append`L${this._x1=t},${this._y1=n}`;else{let m=r-a,y=s-o,b=l*l+c*c,v=m*m+y*y,x=Math.sqrt(b),w=Math.sqrt(h),_=i*Math.tan((A4-Math.acos((b+h-v)/(2*x*w)))/2),k=_/w,C=_/x;Math.abs(k-1)>nm&&this._append`L${t+k*u},${n+k*d}`,this._append`A${i},${i},0,0,${+(d*m>u*y)},${this._x1=t+C*l},${this._y1=n+C*c}`}}arc(t,n,r,s,i,a){if(t=+t,n=+n,r=+r,a=!!a,r<0)throw new Error(`negative radius: ${r}`);let o=r*Math.cos(s),l=r*Math.sin(s),c=t+o,u=n+l,d=1^a,h=a?s-i:i-s;this._x1===null?this._append`M${c},${u}`:(Math.abs(this._x1-c)>nm||Math.abs(this._y1-u)>nm)&&this._append`L${c},${u}`,r&&(h<0&&(h=h%R4+R4),h>jrt?this._append`A${r},${r},0,1,${d},${t-o},${n-l}A${r},${r},0,1,${d},${this._x1=c},${this._y1=u}`:h>nm&&this._append`A${r},${r},0,${+(h>=A4)},${d},${this._x1=t+r*Math.cos(i)},${this._y1=n+r*Math.sin(i)}`)}rect(t,n,r,s){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${r=+r}v${+s}h${-r}Z`}toString(){return this._}}function x0(e){return function(){return e}}const Zft=Math.abs,Xft=Math.atan2,Jft=Math.cos,Qft=Math.max,eht=Math.min,tht=Math.sin,nht=Math.sqrt,gW=1e-12,Q6=Math.PI,yW=Q6/2,rht=2*Q6;function sht(e){return e>1?0:e<-1?Q6:Math.acos(e)}function iht(e){return e>=1?yW:e<=-1?-yW:Math.asin(e)}function Drt(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(n==null)t=null;else{const r=Math.floor(n);if(!(r>=0))throw new RangeError(`invalid digits: ${n}`);t=r}return e},()=>new Ort(t)}function Frt(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Dle(e){this._context=e}Dle.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function lE(e){return new Dle(e)}function Lrt(e){return e[0]}function Brt(e){return e[1]}function $rt(e,t){var n=x0(!0),r=null,s=lE,i=null,a=Drt(o);e=typeof e=="function"?e:e===void 0?Lrt:x0(e),t=typeof t=="function"?t:t===void 0?Brt:x0(t);function o(l){var c,u=(l=Frt(l)).length,d,h=!1,m;for(r==null&&(i=s(m=a())),c=0;c<=u;++c)!(c<u&&n(d=l[c],c,l))===h&&((h=!h)?i.lineStart():i.lineEnd()),h&&i.point(+e(d,c,l),+t(d,c,l));if(m)return i=null,m+""||null}return o.x=function(l){return arguments.length?(e=typeof l=="function"?l:x0(+l),o):e},o.y=function(l){return arguments.length?(t=typeof l=="function"?l:x0(+l),o):t},o.defined=function(l){return arguments.length?(n=typeof l=="function"?l:x0(!!l),o):n},o.curve=function(l){return arguments.length?(s=l,r!=null&&(i=s(r)),o):s},o.context=function(l){return arguments.length?(l==null?r=i=null:i=s(r=l),o):r},o}class Fle{constructor(t,n){this._context=t,this._x=n}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,n){switch(t=+t,n=+n,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,n,t,n):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+n)/2,t,this._y0,t,n);break}}this._x0=t,this._y0=n}}function Lle(e){return new Fle(e,!0)}function Ble(e){return new Fle(e,!1)}function Jh(){}function cE(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function yA(e){this._context=e}yA.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:cE(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:cE(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function f2(e){return new yA(e)}function $le(e){this._context=e}$le.prototype={areaStart:Jh,areaEnd:Jh,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:cE(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function zrt(e){return new $le(e)}function zle(e){this._context=e}zle.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:cE(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Urt(e){return new zle(e)}function Ule(e,t){this._basis=new yA(e),this._beta=t}Ule.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var r=e[0],s=t[0],i=e[n]-r,a=t[n]-s,o=-1,l;++o<=n;)l=o/n,this._basis.point(this._beta*e[o]+(1-this._beta)*(r+l*i),this._beta*t[o]+(1-this._beta)*(s+l*a));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};const qrt=function e(t){function n(r){return t===1?new yA(r):new Ule(r,t)}return n.beta=function(r){return e(+r)},n}(.85);function uE(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function e5(e,t){this._context=e,this._k=(1-t)/6}e5.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:uE(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:uE(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const qle=function e(t){function n(r){return new e5(r,t)}return n.tension=function(r){return e(+r)},n}(0);function t5(e,t){this._context=e,this._k=(1-t)/6}t5.prototype={areaStart:Jh,areaEnd:Jh,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:uE(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const Vrt=function e(t){function n(r){return new t5(r,t)}return n.tension=function(r){return e(+r)},n}(0);function n5(e,t){this._context=e,this._k=(1-t)/6}n5.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:uE(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const Wrt=function e(t){function n(r){return new n5(r,t)}return n.tension=function(r){return e(+r)},n}(0);function r5(e,t,n){var r=e._x1,s=e._y1,i=e._x2,a=e._y2;if(e._l01_a>gW){var o=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,l=3*e._l01_a*(e._l01_a+e._l12_a);r=(r*o-e._x0*e._l12_2a+e._x2*e._l01_2a)/l,s=(s*o-e._y0*e._l12_2a+e._y2*e._l01_2a)/l}if(e._l23_a>gW){var c=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,u=3*e._l23_a*(e._l23_a+e._l12_a);i=(i*c+e._x1*e._l23_2a-t*e._l12_2a)/u,a=(a*c+e._y1*e._l23_2a-n*e._l12_2a)/u}e._context.bezierCurveTo(r,s,i,a,e._x2,e._y2)}function Vle(e,t){this._context=e,this._alpha=t}Vle.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:r5(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const Wle=function e(t){function n(r){return t?new Vle(r,t):new e5(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function Hle(e,t){this._context=e,this._alpha=t}Hle.prototype={areaStart:Jh,areaEnd:Jh,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:r5(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const Hrt=function e(t){function n(r){return t?new Hle(r,t):new t5(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function Gle(e,t){this._context=e,this._alpha=t}Gle.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:r5(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const Grt=function e(t){function n(r){return t?new Gle(r,t):new n5(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function Kle(e){this._context=e}Kle.prototype={areaStart:Jh,areaEnd:Jh,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function Krt(e){return new Kle(e)}function bW(e){return e<0?-1:1}function vW(e,t,n){var r=e._x1-e._x0,s=t-e._x1,i=(e._y1-e._y0)/(r||s<0&&-0),a=(n-e._y1)/(s||r<0&&-0),o=(i*s+a*r)/(r+s);return(bW(i)+bW(a))*Math.min(Math.abs(i),Math.abs(a),.5*Math.abs(o))||0}function xW(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function Vj(e,t,n){var r=e._x0,s=e._y0,i=e._x1,a=e._y1,o=(i-r)/3;e._context.bezierCurveTo(r+o,s+o*t,i-o,a-o*n,i,a)}function dE(e){this._context=e}dE.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Vj(this,this._t0,xW(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,Vj(this,xW(this,n=vW(this,e,t)),n);break;default:Vj(this,this._t0,n=vW(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function Yle(e){this._context=new Zle(e)}(Yle.prototype=Object.create(dE.prototype)).point=function(e,t){dE.prototype.point.call(this,t,e)};function Zle(e){this._context=e}Zle.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,s,i){this._context.bezierCurveTo(t,e,r,n,i,s)}};function Xle(e){return new dE(e)}function Jle(e){return new Yle(e)}function Qle(e){this._context=e}Qle.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var r=wW(e),s=wW(t),i=0,a=1;a<n;++i,++a)this._context.bezierCurveTo(r[0][i],s[0][i],r[1][i],s[1][i],e[a],t[a]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function wW(e){var t,n=e.length-1,r,s=new Array(n),i=new Array(n),a=new Array(n);for(s[0]=0,i[0]=2,a[0]=e[0]+2*e[1],t=1;t<n-1;++t)s[t]=1,i[t]=4,a[t]=4*e[t]+2*e[t+1];for(s[n-1]=2,i[n-1]=7,a[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)r=s[t]/i[t-1],i[t]-=r,a[t]-=r*a[t-1];for(s[n-1]=a[n-1]/i[n-1],t=n-2;t>=0;--t)s[t]=(a[t]-s[t+1])/i[t];for(i[n-1]=(e[n]+s[n-1])/2,t=0;t<n-1;++t)i[t]=2*e[t+1]-s[t+1];return[s,i]}function ece(e){return new Qle(e)}function bA(e,t){this._context=e,this._t=t}bA.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function tce(e){return new bA(e,.5)}function nce(e){return new bA(e,0)}function rce(e){return new bA(e,1)}function Ix(e,t,n){this.k=e,this.x=t,this.y=n}Ix.prototype={constructor:Ix,scale:function(e){return e===1?this:new Ix(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new Ix(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};Ix.prototype;var sce=typeof I0=="object"&&I0&&I0.Object===Object&&I0,Yrt=typeof self=="object"&&self&&self.Object===Object&&self,ad=sce||Yrt||Function("return this")(),fE=ad.Symbol,ice=Object.prototype,Zrt=ice.hasOwnProperty,Xrt=ice.toString,ox=fE?fE.toStringTag:void 0;function Jrt(e){var t=Zrt.call(e,ox),n=e[ox];try{e[ox]=void 0;var r=!0}catch{}var s=Xrt.call(e);return r&&(t?e[ox]=n:delete e[ox]),s}var Qrt=Object.prototype,est=Qrt.toString;function tst(e){return est.call(e)}var nst="[object Null]",rst="[object Undefined]",SW=fE?fE.toStringTag:void 0;function Mb(e){return e==null?e===void 0?rst:nst:SW&&SW in Object(e)?Jrt(e):tst(e)}function pg(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var sst="[object AsyncFunction]",ist="[object Function]",ast="[object GeneratorFunction]",ost="[object Proxy]";function s5(e){if(!pg(e))return!1;var t=Mb(e);return t==ist||t==ast||t==sst||t==ost}var Wj=ad["__core-js_shared__"],_W=function(){var e=/[^.]+$/.exec(Wj&&Wj.keys&&Wj.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function lst(e){return!!_W&&_W in e}var cst=Function.prototype,ust=cst.toString;function mg(e){if(e!=null){try{return ust.call(e)}catch{}try{return e+""}catch{}}return""}var dst=/[\\^$.*+?()[\]{}|]/g,fst=/^\[object .+?Constructor\]$/,hst=Function.prototype,pst=Object.prototype,mst=hst.toString,gst=pst.hasOwnProperty,yst=RegExp("^"+mst.call(gst).replace(dst,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function bst(e){if(!pg(e)||lst(e))return!1;var t=s5(e)?yst:fst;return t.test(mg(e))}function vst(e,t){return e==null?void 0:e[t]}function gg(e,t){var n=vst(e,t);return bst(n)?n:void 0}var x1=gg(Object,"create");function xst(){this.__data__=x1?x1(null):{},this.size=0}function wst(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var Sst="__lodash_hash_undefined__",_st=Object.prototype,Cst=_st.hasOwnProperty;function kst(e){var t=this.__data__;if(x1){var n=t[e];return n===Sst?void 0:n}return Cst.call(t,e)?t[e]:void 0}var Est=Object.prototype,Tst=Est.hasOwnProperty;function Ast(e){var t=this.__data__;return x1?t[e]!==void 0:Tst.call(t,e)}var Rst="__lodash_hash_undefined__";function Nst(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=x1&&t===void 0?Rst:t,this}function Hm(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}Hm.prototype.clear=xst;Hm.prototype.delete=wst;Hm.prototype.get=kst;Hm.prototype.has=Ast;Hm.prototype.set=Nst;function Ist(){this.__data__=[],this.size=0}function vA(e,t){return e===t||e!==e&&t!==t}function xA(e,t){for(var n=e.length;n--;)if(vA(e[n][0],t))return n;return-1}var Mst=Array.prototype,jst=Mst.splice;function Pst(e){var t=this.__data__,n=xA(t,e);if(n<0)return!1;var r=t.length-1;return n==r?t.pop():jst.call(t,n,1),--this.size,!0}function Ost(e){var t=this.__data__,n=xA(t,e);return n<0?void 0:t[n][1]}function Dst(e){return xA(this.__data__,e)>-1}function Fst(e,t){var n=this.__data__,r=xA(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this}function Cf(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}Cf.prototype.clear=Ist;Cf.prototype.delete=Pst;Cf.prototype.get=Ost;Cf.prototype.has=Dst;Cf.prototype.set=Fst;var w1=gg(ad,"Map");function Lst(){this.size=0,this.__data__={hash:new Hm,map:new(w1||Cf),string:new Hm}}function Bst(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function wA(e,t){var n=e.__data__;return Bst(t)?n[typeof t=="string"?"string":"hash"]:n.map}function $st(e){var t=wA(this,e).delete(e);return this.size-=t?1:0,t}function zst(e){return wA(this,e).get(e)}function Ust(e){return wA(this,e).has(e)}function qst(e,t){var n=wA(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this}function wp(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}wp.prototype.clear=Lst;wp.prototype.delete=$st;wp.prototype.get=zst;wp.prototype.has=Ust;wp.prototype.set=qst;var Vst="Expected a function";function TS(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(Vst);var n=function(){var r=arguments,s=t?t.apply(this,r):r[0],i=n.cache;if(i.has(s))return i.get(s);var a=e.apply(this,r);return n.cache=i.set(s,a)||i,a};return n.cache=new(TS.Cache||wp),n}TS.Cache=wp;function Wst(){this.__data__=new Cf,this.size=0}function Hst(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}function Gst(e){return this.__data__.get(e)}function Kst(e){return this.__data__.has(e)}var Yst=200;function Zst(e,t){var n=this.__data__;if(n instanceof Cf){var r=n.__data__;if(!w1||r.length<Yst-1)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new wp(r)}return n.set(e,t),this.size=n.size,this}function jb(e){var t=this.__data__=new Cf(e);this.size=t.size}jb.prototype.clear=Wst;jb.prototype.delete=Hst;jb.prototype.get=Gst;jb.prototype.has=Kst;jb.prototype.set=Zst;var hE=function(){try{var e=gg(Object,"defineProperty");return e({},"",{}),e}catch{}}();function i5(e,t,n){t=="__proto__"&&hE?hE(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function N4(e,t,n){(n!==void 0&&!vA(e[t],n)||n===void 0&&!(t in e))&&i5(e,t,n)}function Xst(e){return function(t,n,r){for(var s=-1,i=Object(t),a=r(t),o=a.length;o--;){var l=a[++s];if(n(i[l],l,i)===!1)break}return t}}var Jst=Xst(),ace=typeof exports=="object"&&exports&&!exports.nodeType&&exports,CW=ace&&typeof module=="object"&&module&&!module.nodeType&&module,Qst=CW&&CW.exports===ace,kW=Qst?ad.Buffer:void 0,EW=kW?kW.allocUnsafe:void 0;function eit(e,t){if(t)return e.slice();var n=e.length,r=EW?EW(n):new e.constructor(n);return e.copy(r),r}var TW=ad.Uint8Array;function tit(e){var t=new e.constructor(e.byteLength);return new TW(t).set(new TW(e)),t}function nit(e,t){var n=t?tit(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function rit(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}var AW=Object.create,sit=function(){function e(){}return function(t){if(!pg(t))return{};if(AW)return AW(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();function oce(e,t){return function(n){return e(t(n))}}var lce=oce(Object.getPrototypeOf,Object),iit=Object.prototype;function SA(e){var t=e&&e.constructor,n=typeof t=="function"&&t.prototype||iit;return e===n}function ait(e){return typeof e.constructor=="function"&&!SA(e)?sit(lce(e)):{}}function AS(e){return e!=null&&typeof e=="object"}var oit="[object Arguments]";function RW(e){return AS(e)&&Mb(e)==oit}var cce=Object.prototype,lit=cce.hasOwnProperty,cit=cce.propertyIsEnumerable,pE=RW(function(){return arguments}())?RW:function(e){return AS(e)&&lit.call(e,"callee")&&!cit.call(e,"callee")},mE=Array.isArray,uit=9007199254740991;function uce(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=uit}function _A(e){return e!=null&&uce(e.length)&&!s5(e)}function dit(e){return AS(e)&&_A(e)}function fit(){return!1}var dce=typeof exports=="object"&&exports&&!exports.nodeType&&exports,NW=dce&&typeof module=="object"&&module&&!module.nodeType&&module,hit=NW&&NW.exports===dce,IW=hit?ad.Buffer:void 0,pit=IW?IW.isBuffer:void 0,a5=pit||fit,mit="[object Object]",git=Function.prototype,yit=Object.prototype,fce=git.toString,bit=yit.hasOwnProperty,vit=fce.call(Object);function xit(e){if(!AS(e)||Mb(e)!=mit)return!1;var t=lce(e);if(t===null)return!0;var n=bit.call(t,"constructor")&&t.constructor;return typeof n=="function"&&n instanceof n&&fce.call(n)==vit}var wit="[object Arguments]",Sit="[object Array]",_it="[object Boolean]",Cit="[object Date]",kit="[object Error]",Eit="[object Function]",Tit="[object Map]",Ait="[object Number]",Rit="[object Object]",Nit="[object RegExp]",Iit="[object Set]",Mit="[object String]",jit="[object WeakMap]",Pit="[object ArrayBuffer]",Oit="[object DataView]",Dit="[object Float32Array]",Fit="[object Float64Array]",Lit="[object Int8Array]",Bit="[object Int16Array]",$it="[object Int32Array]",zit="[object Uint8Array]",Uit="[object Uint8ClampedArray]",qit="[object Uint16Array]",Vit="[object Uint32Array]",zs={};zs[Dit]=zs[Fit]=zs[Lit]=zs[Bit]=zs[$it]=zs[zit]=zs[Uit]=zs[qit]=zs[Vit]=!0;zs[wit]=zs[Sit]=zs[Pit]=zs[_it]=zs[Oit]=zs[Cit]=zs[kit]=zs[Eit]=zs[Tit]=zs[Ait]=zs[Rit]=zs[Nit]=zs[Iit]=zs[Mit]=zs[jit]=!1;function Wit(e){return AS(e)&&uce(e.length)&&!!zs[Mb(e)]}function Hit(e){return function(t){return e(t)}}var hce=typeof exports=="object"&&exports&&!exports.nodeType&&exports,ew=hce&&typeof module=="object"&&module&&!module.nodeType&&module,Git=ew&&ew.exports===hce,Hj=Git&&sce.process,MW=function(){try{var e=ew&&ew.require&&ew.require("util").types;return e||Hj&&Hj.binding&&Hj.binding("util")}catch{}}(),jW=MW&&MW.isTypedArray,o5=jW?Hit(jW):Wit;function I4(e,t){if(!(t==="constructor"&&typeof e[t]=="function")&&t!="__proto__")return e[t]}var Kit=Object.prototype,Yit=Kit.hasOwnProperty;function Zit(e,t,n){var r=e[t];(!(Yit.call(e,t)&&vA(r,n))||n===void 0&&!(t in e))&&i5(e,t,n)}function Xit(e,t,n,r){var s=!n;n||(n={});for(var i=-1,a=t.length;++i<a;){var o=t[i],l=void 0;l===void 0&&(l=e[o]),s?i5(n,o,l):Zit(n,o,l)}return n}function Jit(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}var Qit=9007199254740991,eat=/^(?:0|[1-9]\d*)$/;function pce(e,t){var n=typeof e;return t=t??Qit,!!t&&(n=="number"||n!="symbol"&&eat.test(e))&&e>-1&&e%1==0&&e<t}var tat=Object.prototype,nat=tat.hasOwnProperty;function rat(e,t){var n=mE(e),r=!n&&pE(e),s=!n&&!r&&a5(e),i=!n&&!r&&!s&&o5(e),a=n||r||s||i,o=a?Jit(e.length,String):[],l=o.length;for(var c in e)(t||nat.call(e,c))&&!(a&&(c=="length"||s&&(c=="offset"||c=="parent")||i&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||pce(c,l)))&&o.push(c);return o}function sat(e){var t=[];if(e!=null)for(var n in Object(e))t.push(n);return t}var iat=Object.prototype,aat=iat.hasOwnProperty;function oat(e){if(!pg(e))return sat(e);var t=SA(e),n=[];for(var r in e)r=="constructor"&&(t||!aat.call(e,r))||n.push(r);return n}function mce(e){return _A(e)?rat(e,!0):oat(e)}function lat(e){return Xit(e,mce(e))}function cat(e,t,n,r,s,i,a){var o=I4(e,n),l=I4(t,n),c=a.get(l);if(c){N4(e,n,c);return}var u=i?i(o,l,n+"",e,t,a):void 0,d=u===void 0;if(d){var h=mE(l),m=!h&&a5(l),y=!h&&!m&&o5(l);u=l,h||m||y?mE(o)?u=o:dit(o)?u=rit(o):m?(d=!1,u=eit(l,!0)):y?(d=!1,u=nit(l,!0)):u=[]:xit(l)||pE(l)?(u=o,pE(o)?u=lat(o):(!pg(o)||s5(o))&&(u=ait(l))):d=!1}d&&(a.set(l,u),s(u,l,r,i,a),a.delete(l)),N4(e,n,u)}function gce(e,t,n,r,s){e!==t&&Jst(t,function(i,a){if(s||(s=new jb),pg(i))cat(e,t,a,n,gce,r,s);else{var o=r?r(I4(e,a),i,a+"",e,t,s):void 0;o===void 0&&(o=i),N4(e,a,o)}},mce)}function yce(e){return e}function uat(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}var PW=Math.max;function dat(e,t,n){return t=PW(t===void 0?e.length-1:t,0),function(){for(var r=arguments,s=-1,i=PW(r.length-t,0),a=Array(i);++s<i;)a[s]=r[t+s];s=-1;for(var o=Array(t+1);++s<t;)o[s]=r[s];return o[t]=n(a),uat(e,this,o)}}function fat(e){return function(){return e}}var hat=hE?function(e,t){return hE(e,"toString",{configurable:!0,enumerable:!1,value:fat(t),writable:!0})}:yce,pat=800,mat=16,gat=Date.now;function yat(e){var t=0,n=0;return function(){var r=gat(),s=mat-(r-n);if(n=r,s>0){if(++t>=pat)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var bat=yat(hat);function vat(e,t){return bat(dat(e,t,yce),e+"")}function xat(e,t,n){if(!pg(n))return!1;var r=typeof t;return(r=="number"?_A(n)&&pce(t,n.length):r=="string"&&t in n)?vA(n[t],e):!1}function wat(e){return vat(function(t,n){var r=-1,s=n.length,i=s>1?n[s-1]:void 0,a=s>2?n[2]:void 0;for(i=e.length>3&&typeof i=="function"?(s--,i):void 0,a&&xat(n[0],n[1],a)&&(i=s<3?void 0:i,s=1),t=Object(t);++r<s;){var o=n[r];o&&e(t,o,r,i)}return t})}var Sat=wat(function(e,t,n){gce(e,t,n)}),_at="​",Cat={curveBasis:f2,curveBasisClosed:zrt,curveBasisOpen:Urt,curveBumpX:Lle,curveBumpY:Ble,curveBundle:qrt,curveCardinalClosed:Vrt,curveCardinalOpen:Wrt,curveCardinal:qle,curveCatmullRomClosed:Hrt,curveCatmullRomOpen:Grt,curveCatmullRom:Wle,curveLinear:lE,curveLinearClosed:Krt,curveMonotoneX:Xle,curveMonotoneY:Jle,curveNatural:ece,curveStep:tce,curveStepAfter:rce,curveStepBefore:nce},kat=/\s*(?:(\w+)(?=:):|(\w+))\s*(?:(\w+)|((?:(?!}%{2}).|\r?\n)*))?\s*(?:}%{2})?/gi,Eat=ie(function(e,t){const n=bce(e,/(?:init\b)|(?:initialize\b)/);let r={};if(Array.isArray(n)){const a=n.map(o=>o.args);Wk(a),r=Ra(r,[...a])}else r=n.args;if(!r)return;let s=I6(e,t);const i="config";return r[i]!==void 0&&(s==="flowchart-v2"&&(s="flowchart"),r[s]=r[i],delete r[i]),r},"detectInit"),bce=ie(function(e,t=null){var n,r;try{const s=new RegExp(`[%]{2}(?![{]${kat.source})(?=[}][%]{2}).*
`,"ig");e=e.trim().replace(s,"").replace(/'/gm,'"'),qt.debug(`Detecting diagram directive${t!==null?" type:"+t:""} based on the text:${e}`);let i;const a=[];for(;(i=Jx.exec(e))!==null;)if(i.index===Jx.lastIndex&&Jx.lastIndex++,i&&!t||t&&((n=i[1])!=null&&n.match(t))||t&&((r=i[2])!=null&&r.match(t))){const o=i[1]?i[1]:i[2],l=i[3]?i[3].trim():i[4]?JSON.parse(i[4].trim()):null;a.push({type:o,args:l})}return a.length===0?{type:e,args:null}:a.length===1?a[0]:a}catch(s){return qt.error(`ERROR: ${s.message} - Unable to parse directive type: '${t}' based on the text: '${e}'`),{type:void 0,args:null}}},"detectDirective"),Tat=ie(function(e){return e.replace(Jx,"")},"removeDirectives"),Aat=ie(function(e,t){for(const[n,r]of t.entries())if(r.match(e))return n;return-1},"isSubstringInArray");function l5(e,t){if(!e)return t;const n=`curve${e.charAt(0).toUpperCase()+e.slice(1)}`;return Cat[n]??t}ie(l5,"interpolateToCurve");function vce(e,t){const n=e.trim();if(n)return t.securityLevel!=="loose"?yet.sanitizeUrl(n):n}ie(vce,"formatUrl");var Rat=ie((e,...t)=>{const n=e.split("."),r=n.length-1,s=n[r];let i=window;for(let a=0;a<r;a++)if(i=i[n[a]],!i){qt.error(`Function name: ${e} not found in window`);return}i[s](...t)},"runFunc");function c5(e,t){return!e||!t?0:Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}ie(c5,"distance");function xce(e){let t,n=0;e.forEach(s=>{n+=c5(s,t),t=s});const r=n/2;return u5(e,r)}ie(xce,"traverseEdge");function wce(e){return e.length===1?e[0]:xce(e)}ie(wce,"calcLabelPosition");var OW=ie((e,t=2)=>{const n=Math.pow(10,t);return Math.round(e*n)/n},"roundNumber"),u5=ie((e,t)=>{let n,r=t;for(const s of e){if(n){const i=c5(s,n);if(i===0)return n;if(i<r)r-=i;else{const a=r/i;if(a<=0)return n;if(a>=1)return{x:s.x,y:s.y};if(a>0&&a<1)return{x:OW((1-a)*n.x+a*s.x,5),y:OW((1-a)*n.y+a*s.y,5)}}}n=s}throw new Error("Could not find a suitable point for the given distance")},"calculatePoint"),Nat=ie((e,t,n)=>{qt.info(`our points ${JSON.stringify(t)}`),t[0]!==n&&(t=t.reverse());const s=u5(t,25),i=e?10:5,a=Math.atan2(t[0].y-s.y,t[0].x-s.x),o={x:0,y:0};return o.x=Math.sin(a)*i+(t[0].x+s.x)/2,o.y=-Math.cos(a)*i+(t[0].y+s.y)/2,o},"calcCardinalityPosition");function Sce(e,t,n){const r=structuredClone(n);qt.info("our points",r),t!=="start_left"&&t!=="start_right"&&r.reverse();const s=25+e,i=u5(r,s),a=10+e*.5,o=Math.atan2(r[0].y-i.y,r[0].x-i.x),l={x:0,y:0};return t==="start_left"?(l.x=Math.sin(o+Math.PI)*a+(r[0].x+i.x)/2,l.y=-Math.cos(o+Math.PI)*a+(r[0].y+i.y)/2):t==="end_right"?(l.x=Math.sin(o-Math.PI)*a+(r[0].x+i.x)/2-5,l.y=-Math.cos(o-Math.PI)*a+(r[0].y+i.y)/2-5):t==="end_left"?(l.x=Math.sin(o)*a+(r[0].x+i.x)/2-5,l.y=-Math.cos(o)*a+(r[0].y+i.y)/2-5):(l.x=Math.sin(o)*a+(r[0].x+i.x)/2,l.y=-Math.cos(o)*a+(r[0].y+i.y)/2),l}ie(Sce,"calcTerminalLabelPosition");function _ce(e){let t="",n="";for(const r of e)r!==void 0&&(r.startsWith("color:")||r.startsWith("text-align:")?n=n+r+";":t=t+r+";");return{style:t,labelStyle:n}}ie(_ce,"getStylesFromArray");var DW=0,Iat=ie(()=>(DW++,"id-"+Math.random().toString(36).substr(2,12)+"-"+DW),"generateId");function Cce(e){let t="";const n="0123456789abcdef",r=n.length;for(let s=0;s<e;s++)t+=n.charAt(Math.floor(Math.random()*r));return t}ie(Cce,"makeRandomHex");var Mat=ie(e=>Cce(e.length),"random"),jat=ie(function(){return{x:0,y:0,fill:void 0,anchor:"start",style:"#666",width:100,height:100,textMargin:0,rx:0,ry:0,valign:void 0,text:""}},"getTextObj"),Pat=ie(function(e,t){const n=t.text.replace(Ib.lineBreakRegex," "),[,r]=CA(t.fontSize),s=e.append("text");s.attr("x",t.x),s.attr("y",t.y),s.style("text-anchor",t.anchor),s.style("font-family",t.fontFamily),s.style("font-size",r),s.style("font-weight",t.fontWeight),s.attr("fill",t.fill),t.class!==void 0&&s.attr("class",t.class);const i=s.append("tspan");return i.attr("x",t.x+t.textMargin*2),i.attr("fill",t.fill),i.text(n),s},"drawSimpleText"),Oat=TS((e,t,n)=>{if(!e||(n=Object.assign({fontSize:12,fontWeight:400,fontFamily:"Arial",joinWith:"<br/>"},n),Ib.lineBreakRegex.test(e)))return e;const r=e.split(" ").filter(Boolean),s=[];let i="";return r.forEach((a,o)=>{const l=pf(`${a} `,n),c=pf(i,n);if(l>t){const{hyphenatedStrings:h,remainingWord:m}=Dat(a,t,"-",n);s.push(i,...h),i=m}else c+l>=t?(s.push(i),i=a):i=[i,a].filter(Boolean).join(" ");o+1===r.length&&s.push(i)}),s.filter(a=>a!=="").join(n.joinWith)},(e,t,n)=>`${e}${t}${n.fontSize}${n.fontWeight}${n.fontFamily}${n.joinWith}`),Dat=TS((e,t,n="-",r)=>{r=Object.assign({fontSize:12,fontWeight:400,fontFamily:"Arial",margin:0},r);const s=[...e],i=[];let a="";return s.forEach((o,l)=>{const c=`${a}${o}`;if(pf(c,r)>=t){const d=l+1,h=s.length===d,m=`${c}${n}`;i.push(h?c:m),a=""}else a=c}),{hyphenatedStrings:i,remainingWord:a}},(e,t,n="-",r)=>`${e}${t}${n}${r.fontSize}${r.fontWeight}${r.fontFamily}`);function kce(e,t){return d5(e,t).height}ie(kce,"calculateTextHeight");function pf(e,t){return d5(e,t).width}ie(pf,"calculateTextWidth");var d5=TS((e,t)=>{const{fontSize:n=12,fontFamily:r="Arial",fontWeight:s=400}=t;if(!e)return{width:0,height:0};const[,i]=CA(n),a=["sans-serif",r],o=e.split(Ib.lineBreakRegex),l=[],c=Zr("body");if(!c.remove)return{width:0,height:0,lineHeight:0};const u=c.append("svg");for(const h of a){let m=0;const y={width:0,height:0,lineHeight:0};for(const b of o){const v=jat();v.text=b||_at;const x=Pat(u,v).style("font-size",i).style("font-weight",s).style("font-family",h),w=(x._groups||x)[0][0].getBBox();if(w.width===0&&w.height===0)throw new Error("svg element not in render tree");y.width=Math.round(Math.max(y.width,w.width)),m=Math.round(w.height),y.height+=m,y.lineHeight=Math.round(Math.max(y.lineHeight,m))}l.push(y)}u.remove();const d=isNaN(l[1].height)||isNaN(l[1].width)||isNaN(l[1].lineHeight)||l[0].height>l[1].height&&l[0].width>l[1].width&&l[0].lineHeight>l[1].lineHeight?0:1;return l[d]},(e,t)=>`${e}${t.fontSize}${t.fontWeight}${t.fontFamily}`),ly,Fat=(ly=class{constructor(t=!1,n){this.count=0,this.count=n?n.length:0,this.next=t?()=>this.count++:()=>Date.now()}},ie(ly,"InitIDGenerator"),ly),OC,Lat=ie(function(e){return OC=OC||document.createElement("div"),e=escape(e).replace(/%26/g,"&").replace(/%23/g,"#").replace(/%3B/g,";"),OC.innerHTML=e,unescape(OC.textContent)},"entityDecode");function f5(e){return"str"in e}ie(f5,"isDetailedError");var Bat=ie((e,t,n,r)=>{var i;if(!r)return;const s=(i=e.node())==null?void 0:i.getBBox();s&&e.append("text").text(r).attr("text-anchor","middle").attr("x",s.x+s.width/2).attr("y",-n).attr("class",t)},"insertTitle"),CA=ie(e=>{if(typeof e=="number")return[e,e+"px"];const t=parseInt(e??"",10);return Number.isNaN(t)?[void 0,void 0]:e===String(t)?[t,e+"px"]:[t,e]},"parseFontSize");function h5(e,t){return Sat({},e,t)}ie(h5,"cleanAndMerge");var Au={assignWithDepth:Ra,wrapLabel:Oat,calculateTextHeight:kce,calculateTextWidth:pf,calculateTextDimensions:d5,cleanAndMerge:h5,detectInit:Eat,detectDirective:bce,isSubstringInArray:Aat,interpolateToCurve:l5,calcLabelPosition:wce,calcCardinalityPosition:Nat,calcTerminalLabelPosition:Sce,formatUrl:vce,getStylesFromArray:_ce,generateId:Iat,random:Mat,runFunc:Rat,entityDecode:Lat,insertTitle:Bat,parseFontSize:CA,InitIDGenerator:Fat},$at=ie(function(e){let t=e;return t=t.replace(/style.*:\S*#.*;/g,function(n){return n.substring(0,n.length-1)}),t=t.replace(/classDef.*:\S*#.*;/g,function(n){return n.substring(0,n.length-1)}),t=t.replace(/#\w+;/g,function(n){const r=n.substring(1,n.length-1);return/^\+?\d+$/.test(r)?"ﬂ°°"+r+"¶ß":"ﬂ°"+r+"¶ß"}),t},"encodeEntities"),yg=ie(function(e){return e.replace(/ﬂ°°/g,"&#").replace(/ﬂ°/g,"&").replace(/¶ß/g,";")},"decodeEntities"),aht=ie((e,t,{counter:n=0,prefix:r,suffix:s},i)=>i||`${r?`${r}_`:""}${e}_${t}_${n}${s?`_${s}`:""}`,"getEdgeId");function yo(e){return e??null}ie(yo,"handleUndefinedAttr");function p5(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var bg=p5();function Ece(e){bg=e}var tw={exec:()=>null};function gs(e,t=""){let n=typeof e=="string"?e:e.source;const r={replace:(s,i)=>{let a=typeof i=="string"?i:i.source;return a=a.replace(lo.caret,"$1"),n=n.replace(s,a),r},getRegex:()=>new RegExp(n,t)};return r}var lo={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] /,listReplaceTask:/^\[[ xX]\] +/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:e=>new RegExp(`^( {0,3}${e})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}#`),htmlBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}<(?:[a-z].*>|!--)`,"i")},zat=/^(?:[ \t]*(?:\n|$))+/,Uat=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,qat=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,RS=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,Vat=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,m5=/(?:[*+-]|\d{1,9}[.)])/,Tce=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,Ace=gs(Tce).replace(/bull/g,m5).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),Wat=gs(Tce).replace(/bull/g,m5).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),g5=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,Hat=/^[^\n]+/,y5=/(?!\s*\])(?:\\.|[^\[\]\\])+/,Gat=gs(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",y5).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),Kat=gs(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,m5).getRegex(),kA="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",b5=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,Yat=gs("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",b5).replace("tag",kA).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Rce=gs(g5).replace("hr",RS).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",kA).getRegex(),Zat=gs(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",Rce).getRegex(),v5={blockquote:Zat,code:Uat,def:Gat,fences:qat,heading:Vat,hr:RS,html:Yat,lheading:Ace,list:Kat,newline:zat,paragraph:Rce,table:tw,text:Hat},FW=gs("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",RS).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",kA).getRegex(),Xat={...v5,lheading:Wat,table:FW,paragraph:gs(g5).replace("hr",RS).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",FW).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",kA).getRegex()},Jat={...v5,html:gs(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",b5).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:tw,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:gs(g5).replace("hr",RS).replace("heading",` *#{1,6} *[^
]`).replace("lheading",Ace).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},Qat=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,eot=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,Nce=/^( {2,}|\\)\n(?!\s*$)/,tot=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,EA=/[\p{P}\p{S}]/u,x5=/[\s\p{P}\p{S}]/u,Ice=/[^\s\p{P}\p{S}]/u,not=gs(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,x5).getRegex(),Mce=/(?!~)[\p{P}\p{S}]/u,rot=/(?!~)[\s\p{P}\p{S}]/u,sot=/(?:[^\s\p{P}\p{S}]|~)/u,iot=/\[[^[\]]*?\]\((?:\\.|[^\\\(\)]|\((?:\\.|[^\\\(\)])*\))*\)|`[^`]*?`|<[^<>]*?>/g,jce=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,aot=gs(jce,"u").replace(/punct/g,EA).getRegex(),oot=gs(jce,"u").replace(/punct/g,Mce).getRegex(),Pce="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",lot=gs(Pce,"gu").replace(/notPunctSpace/g,Ice).replace(/punctSpace/g,x5).replace(/punct/g,EA).getRegex(),cot=gs(Pce,"gu").replace(/notPunctSpace/g,sot).replace(/punctSpace/g,rot).replace(/punct/g,Mce).getRegex(),uot=gs("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,Ice).replace(/punctSpace/g,x5).replace(/punct/g,EA).getRegex(),dot=gs(/\\(punct)/,"gu").replace(/punct/g,EA).getRegex(),fot=gs(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),hot=gs(b5).replace("(?:-->|$)","-->").getRegex(),pot=gs("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",hot).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),gE=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,mot=gs(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",gE).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),Oce=gs(/^!?\[(label)\]\[(ref)\]/).replace("label",gE).replace("ref",y5).getRegex(),Dce=gs(/^!?\[(ref)\](?:\[\])?/).replace("ref",y5).getRegex(),got=gs("reflink|nolink(?!\\()","g").replace("reflink",Oce).replace("nolink",Dce).getRegex(),w5={_backpedal:tw,anyPunctuation:dot,autolink:fot,blockSkip:iot,br:Nce,code:eot,del:tw,emStrongLDelim:aot,emStrongRDelimAst:lot,emStrongRDelimUnd:uot,escape:Qat,link:mot,nolink:Dce,punctuation:not,reflink:Oce,reflinkSearch:got,tag:pot,text:tot,url:tw},yot={...w5,link:gs(/^!?\[(label)\]\((.*?)\)/).replace("label",gE).getRegex(),reflink:gs(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",gE).getRegex()},M4={...w5,emStrongRDelimAst:cot,emStrongLDelim:oot,url:gs(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\.|[^\\])*?(?:\\.|[^\s~\\]))\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},bot={...M4,br:gs(Nce).replace("{2,}","*").getRegex(),text:gs(M4.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},DC={normal:v5,gfm:Xat,pedantic:Jat},lx={normal:w5,gfm:M4,breaks:bot,pedantic:yot},vot={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},LW=e=>vot[e];function yu(e,t){if(t){if(lo.escapeTest.test(e))return e.replace(lo.escapeReplace,LW)}else if(lo.escapeTestNoEncode.test(e))return e.replace(lo.escapeReplaceNoEncode,LW);return e}function BW(e){try{e=encodeURI(e).replace(lo.percentDecode,"%")}catch{return null}return e}function $W(e,t){var i;const n=e.replace(lo.findPipe,(a,o,l)=>{let c=!1,u=o;for(;--u>=0&&l[u]==="\\";)c=!c;return c?"|":" |"}),r=n.split(lo.splitPipe);let s=0;if(r[0].trim()||r.shift(),r.length>0&&!((i=r.at(-1))!=null&&i.trim())&&r.pop(),t)if(r.length>t)r.splice(t);else for(;r.length<t;)r.push("");for(;s<r.length;s++)r[s]=r[s].trim().replace(lo.slashPipe,"|");return r}function cx(e,t,n){const r=e.length;if(r===0)return"";let s=0;for(;s<r&&e.charAt(r-s-1)===t;)s++;return e.slice(0,r-s)}function xot(e,t){if(e.indexOf(t[1])===-1)return-1;let n=0;for(let r=0;r<e.length;r++)if(e[r]==="\\")r++;else if(e[r]===t[0])n++;else if(e[r]===t[1]&&(n--,n<0))return r;return n>0?-2:-1}function zW(e,t,n,r,s){const i=t.href,a=t.title||null,o=e[1].replace(s.other.outputLinkReplace,"$1");r.state.inLink=!0;const l={type:e[0].charAt(0)==="!"?"image":"link",raw:n,href:i,title:a,text:o,tokens:r.inlineTokens(o)};return r.state.inLink=!1,l}function wot(e,t,n){const r=e.match(n.other.indentCodeCompensation);if(r===null)return t;const s=r[1];return t.split(`
`).map(i=>{const a=i.match(n.other.beginningSpace);if(a===null)return i;const[o]=a;return o.length>=s.length?i.slice(s.length):i}).join(`
`)}var yE=class{constructor(e){ce(this,"options");ce(this,"rules");ce(this,"lexer");this.options=e||bg}space(e){const t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){const t=this.rules.block.code.exec(e);if(t){const n=t[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?n:cx(n,`
`)}}}fences(e){const t=this.rules.block.fences.exec(e);if(t){const n=t[0],r=wot(n,t[3]||"",this.rules);return{type:"code",raw:n,lang:t[2]?t[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):t[2],text:r}}}heading(e){const t=this.rules.block.heading.exec(e);if(t){let n=t[2].trim();if(this.rules.other.endingHash.test(n)){const r=cx(n,"#");(this.options.pedantic||!r||this.rules.other.endingSpaceChar.test(r))&&(n=r.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:n,tokens:this.lexer.inline(n)}}}hr(e){const t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:cx(t[0],`
`)}}blockquote(e){const t=this.rules.block.blockquote.exec(e);if(t){let n=cx(t[0],`
`).split(`
`),r="",s="";const i=[];for(;n.length>0;){let a=!1;const o=[];let l;for(l=0;l<n.length;l++)if(this.rules.other.blockquoteStart.test(n[l]))o.push(n[l]),a=!0;else if(!a)o.push(n[l]);else break;n=n.slice(l);const c=o.join(`
`),u=c.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");r=r?`${r}
${c}`:c,s=s?`${s}
${u}`:u;const d=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(u,i,!0),this.lexer.state.top=d,n.length===0)break;const h=i.at(-1);if((h==null?void 0:h.type)==="code")break;if((h==null?void 0:h.type)==="blockquote"){const m=h,y=m.raw+`
`+n.join(`
`),b=this.blockquote(y);i[i.length-1]=b,r=r.substring(0,r.length-m.raw.length)+b.raw,s=s.substring(0,s.length-m.text.length)+b.text;break}else if((h==null?void 0:h.type)==="list"){const m=h,y=m.raw+`
`+n.join(`
`),b=this.list(y);i[i.length-1]=b,r=r.substring(0,r.length-h.raw.length)+b.raw,s=s.substring(0,s.length-m.raw.length)+b.raw,n=y.substring(i.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:r,tokens:i,text:s}}}list(e){let t=this.rules.block.list.exec(e);if(t){let n=t[1].trim();const r=n.length>1,s={type:"list",raw:"",ordered:r,start:r?+n.slice(0,-1):"",loose:!1,items:[]};n=r?`\\d{1,9}\\${n.slice(-1)}`:`\\${n}`,this.options.pedantic&&(n=r?n:"[*+-]");const i=this.rules.other.listItemRegex(n);let a=!1;for(;e;){let l=!1,c="",u="";if(!(t=i.exec(e))||this.rules.block.hr.test(e))break;c=t[0],e=e.substring(c.length);let d=t[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,x=>" ".repeat(3*x.length)),h=e.split(`
`,1)[0],m=!d.trim(),y=0;if(this.options.pedantic?(y=2,u=d.trimStart()):m?y=t[1].length+1:(y=t[2].search(this.rules.other.nonSpaceChar),y=y>4?1:y,u=d.slice(y),y+=t[1].length),m&&this.rules.other.blankLine.test(h)&&(c+=h+`
`,e=e.substring(h.length+1),l=!0),!l){const x=this.rules.other.nextBulletRegex(y),w=this.rules.other.hrRegex(y),_=this.rules.other.fencesBeginRegex(y),k=this.rules.other.headingBeginRegex(y),C=this.rules.other.htmlBeginRegex(y);for(;e;){const T=e.split(`
`,1)[0];let A;if(h=T,this.options.pedantic?(h=h.replace(this.rules.other.listReplaceNesting,"  "),A=h):A=h.replace(this.rules.other.tabCharGlobal,"    "),_.test(h)||k.test(h)||C.test(h)||x.test(h)||w.test(h))break;if(A.search(this.rules.other.nonSpaceChar)>=y||!h.trim())u+=`
`+A.slice(y);else{if(m||d.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||_.test(d)||k.test(d)||w.test(d))break;u+=`
`+h}!m&&!h.trim()&&(m=!0),c+=T+`
`,e=e.substring(T.length+1),d=A.slice(y)}}s.loose||(a?s.loose=!0:this.rules.other.doubleBlankLine.test(c)&&(a=!0));let b=null,v;this.options.gfm&&(b=this.rules.other.listIsTask.exec(u),b&&(v=b[0]!=="[ ] ",u=u.replace(this.rules.other.listReplaceTask,""))),s.items.push({type:"list_item",raw:c,task:!!b,checked:v,loose:!1,text:u,tokens:[]}),s.raw+=c}const o=s.items.at(-1);if(o)o.raw=o.raw.trimEnd(),o.text=o.text.trimEnd();else return;s.raw=s.raw.trimEnd();for(let l=0;l<s.items.length;l++)if(this.lexer.state.top=!1,s.items[l].tokens=this.lexer.blockTokens(s.items[l].text,[]),!s.loose){const c=s.items[l].tokens.filter(d=>d.type==="space"),u=c.length>0&&c.some(d=>this.rules.other.anyLine.test(d.raw));s.loose=u}if(s.loose)for(let l=0;l<s.items.length;l++)s.items[l].loose=!0;return s}}html(e){const t=this.rules.block.html.exec(e);if(t)return{type:"html",block:!0,raw:t[0],pre:t[1]==="pre"||t[1]==="script"||t[1]==="style",text:t[0]}}def(e){const t=this.rules.block.def.exec(e);if(t){const n=t[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),r=t[2]?t[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",s=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):t[3];return{type:"def",tag:n,raw:t[0],href:r,title:s}}}table(e){var a;const t=this.rules.block.table.exec(e);if(!t||!this.rules.other.tableDelimiter.test(t[2]))return;const n=$W(t[1]),r=t[2].replace(this.rules.other.tableAlignChars,"").split("|"),s=(a=t[3])!=null&&a.trim()?t[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],i={type:"table",raw:t[0],header:[],align:[],rows:[]};if(n.length===r.length){for(const o of r)this.rules.other.tableAlignRight.test(o)?i.align.push("right"):this.rules.other.tableAlignCenter.test(o)?i.align.push("center"):this.rules.other.tableAlignLeft.test(o)?i.align.push("left"):i.align.push(null);for(let o=0;o<n.length;o++)i.header.push({text:n[o],tokens:this.lexer.inline(n[o]),header:!0,align:i.align[o]});for(const o of s)i.rows.push($W(o,i.header.length).map((l,c)=>({text:l,tokens:this.lexer.inline(l),header:!1,align:i.align[c]})));return i}}lheading(e){const t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:t[2].charAt(0)==="="?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){const t=this.rules.block.paragraph.exec(e);if(t){const n=t[1].charAt(t[1].length-1)===`
`?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:n,tokens:this.lexer.inline(n)}}}text(e){const t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){const t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:t[1]}}tag(e){const t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&this.rules.other.startATag.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:t[0]}}link(e){const t=this.rules.inline.link.exec(e);if(t){const n=t[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(n)){if(!this.rules.other.endAngleBracket.test(n))return;const i=cx(n.slice(0,-1),"\\");if((n.length-i.length)%2===0)return}else{const i=xot(t[2],"()");if(i===-2)return;if(i>-1){const o=(t[0].indexOf("!")===0?5:4)+t[1].length+i;t[2]=t[2].substring(0,i),t[0]=t[0].substring(0,o).trim(),t[3]=""}}let r=t[2],s="";if(this.options.pedantic){const i=this.rules.other.pedanticHrefTitle.exec(r);i&&(r=i[1],s=i[3])}else s=t[3]?t[3].slice(1,-1):"";return r=r.trim(),this.rules.other.startAngleBracket.test(r)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(n)?r=r.slice(1):r=r.slice(1,-1)),zW(t,{href:r&&r.replace(this.rules.inline.anyPunctuation,"$1"),title:s&&s.replace(this.rules.inline.anyPunctuation,"$1")},t[0],this.lexer,this.rules)}}reflink(e,t){let n;if((n=this.rules.inline.reflink.exec(e))||(n=this.rules.inline.nolink.exec(e))){const r=(n[2]||n[1]).replace(this.rules.other.multipleSpaceGlobal," "),s=t[r.toLowerCase()];if(!s){const i=n[0].charAt(0);return{type:"text",raw:i,text:i}}return zW(n,s,n[0],this.lexer,this.rules)}}emStrong(e,t,n=""){let r=this.rules.inline.emStrongLDelim.exec(e);if(!r||r[3]&&n.match(this.rules.other.unicodeAlphaNumeric))return;if(!(r[1]||r[2]||"")||!n||this.rules.inline.punctuation.exec(n)){const i=[...r[0]].length-1;let a,o,l=i,c=0;const u=r[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(u.lastIndex=0,t=t.slice(-1*e.length+i);(r=u.exec(t))!=null;){if(a=r[1]||r[2]||r[3]||r[4]||r[5]||r[6],!a)continue;if(o=[...a].length,r[3]||r[4]){l+=o;continue}else if((r[5]||r[6])&&i%3&&!((i+o)%3)){c+=o;continue}if(l-=o,l>0)continue;o=Math.min(o,o+l+c);const d=[...r[0]][0].length,h=e.slice(0,i+r.index+d+o);if(Math.min(i,o)%2){const y=h.slice(1,-1);return{type:"em",raw:h,text:y,tokens:this.lexer.inlineTokens(y)}}const m=h.slice(2,-2);return{type:"strong",raw:h,text:m,tokens:this.lexer.inlineTokens(m)}}}}codespan(e){const t=this.rules.inline.code.exec(e);if(t){let n=t[2].replace(this.rules.other.newLineCharGlobal," ");const r=this.rules.other.nonSpaceChar.test(n),s=this.rules.other.startingSpaceChar.test(n)&&this.rules.other.endingSpaceChar.test(n);return r&&s&&(n=n.substring(1,n.length-1)),{type:"codespan",raw:t[0],text:n}}}br(e){const t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){const t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e){const t=this.rules.inline.autolink.exec(e);if(t){let n,r;return t[2]==="@"?(n=t[1],r="mailto:"+n):(n=t[1],r=n),{type:"link",raw:t[0],text:n,href:r,tokens:[{type:"text",raw:n,text:n}]}}}url(e){var n;let t;if(t=this.rules.inline.url.exec(e)){let r,s;if(t[2]==="@")r=t[0],s="mailto:"+r;else{let i;do i=t[0],t[0]=((n=this.rules.inline._backpedal.exec(t[0]))==null?void 0:n[0])??"";while(i!==t[0]);r=t[0],t[1]==="www."?s="http://"+t[0]:s=t[0]}return{type:"link",raw:t[0],text:r,href:s,tokens:[{type:"text",raw:r,text:r}]}}}inlineText(e){const t=this.rules.inline.text.exec(e);if(t){const n=this.lexer.state.inRawBlock;return{type:"text",raw:t[0],text:t[0],escaped:n}}}},Gd=class j4{constructor(t){ce(this,"tokens");ce(this,"options");ce(this,"state");ce(this,"tokenizer");ce(this,"inlineQueue");this.tokens=[],this.tokens.links=Object.create(null),this.options=t||bg,this.options.tokenizer=this.options.tokenizer||new yE,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const n={other:lo,block:DC.normal,inline:lx.normal};this.options.pedantic?(n.block=DC.pedantic,n.inline=lx.pedantic):this.options.gfm&&(n.block=DC.gfm,this.options.breaks?n.inline=lx.breaks:n.inline=lx.gfm),this.tokenizer.rules=n}static get rules(){return{block:DC,inline:lx}}static lex(t,n){return new j4(n).lex(t)}static lexInline(t,n){return new j4(n).inlineTokens(t)}lex(t){t=t.replace(lo.carriageReturn,`
`),this.blockTokens(t,this.tokens);for(let n=0;n<this.inlineQueue.length;n++){const r=this.inlineQueue[n];this.inlineTokens(r.src,r.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(t,n=[],r=!1){var s,i,a;for(this.options.pedantic&&(t=t.replace(lo.tabCharGlobal,"    ").replace(lo.spaceLine,""));t;){let o;if((i=(s=this.options.extensions)==null?void 0:s.block)!=null&&i.some(c=>(o=c.call({lexer:this},t,n))?(t=t.substring(o.raw.length),n.push(o),!0):!1))continue;if(o=this.tokenizer.space(t)){t=t.substring(o.raw.length);const c=n.at(-1);o.raw.length===1&&c!==void 0?c.raw+=`
`:n.push(o);continue}if(o=this.tokenizer.code(t)){t=t.substring(o.raw.length);const c=n.at(-1);(c==null?void 0:c.type)==="paragraph"||(c==null?void 0:c.type)==="text"?(c.raw+=`
`+o.raw,c.text+=`
`+o.text,this.inlineQueue.at(-1).src=c.text):n.push(o);continue}if(o=this.tokenizer.fences(t)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.heading(t)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.hr(t)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.blockquote(t)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.list(t)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.html(t)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.def(t)){t=t.substring(o.raw.length);const c=n.at(-1);(c==null?void 0:c.type)==="paragraph"||(c==null?void 0:c.type)==="text"?(c.raw+=`
`+o.raw,c.text+=`
`+o.raw,this.inlineQueue.at(-1).src=c.text):this.tokens.links[o.tag]||(this.tokens.links[o.tag]={href:o.href,title:o.title});continue}if(o=this.tokenizer.table(t)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.lheading(t)){t=t.substring(o.raw.length),n.push(o);continue}let l=t;if((a=this.options.extensions)!=null&&a.startBlock){let c=1/0;const u=t.slice(1);let d;this.options.extensions.startBlock.forEach(h=>{d=h.call({lexer:this},u),typeof d=="number"&&d>=0&&(c=Math.min(c,d))}),c<1/0&&c>=0&&(l=t.substring(0,c+1))}if(this.state.top&&(o=this.tokenizer.paragraph(l))){const c=n.at(-1);r&&(c==null?void 0:c.type)==="paragraph"?(c.raw+=`
`+o.raw,c.text+=`
`+o.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=c.text):n.push(o),r=l.length!==t.length,t=t.substring(o.raw.length);continue}if(o=this.tokenizer.text(t)){t=t.substring(o.raw.length);const c=n.at(-1);(c==null?void 0:c.type)==="text"?(c.raw+=`
`+o.raw,c.text+=`
`+o.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=c.text):n.push(o);continue}if(t){const c="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(c);break}else throw new Error(c)}}return this.state.top=!0,n}inline(t,n=[]){return this.inlineQueue.push({src:t,tokens:n}),n}inlineTokens(t,n=[]){var o,l,c;let r=t,s=null;if(this.tokens.links){const u=Object.keys(this.tokens.links);if(u.length>0)for(;(s=this.tokenizer.rules.inline.reflinkSearch.exec(r))!=null;)u.includes(s[0].slice(s[0].lastIndexOf("[")+1,-1))&&(r=r.slice(0,s.index)+"["+"a".repeat(s[0].length-2)+"]"+r.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(s=this.tokenizer.rules.inline.anyPunctuation.exec(r))!=null;)r=r.slice(0,s.index)+"++"+r.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;(s=this.tokenizer.rules.inline.blockSkip.exec(r))!=null;)r=r.slice(0,s.index)+"["+"a".repeat(s[0].length-2)+"]"+r.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);let i=!1,a="";for(;t;){i||(a=""),i=!1;let u;if((l=(o=this.options.extensions)==null?void 0:o.inline)!=null&&l.some(h=>(u=h.call({lexer:this},t,n))?(t=t.substring(u.raw.length),n.push(u),!0):!1))continue;if(u=this.tokenizer.escape(t)){t=t.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.tag(t)){t=t.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.link(t)){t=t.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.reflink(t,this.tokens.links)){t=t.substring(u.raw.length);const h=n.at(-1);u.type==="text"&&(h==null?void 0:h.type)==="text"?(h.raw+=u.raw,h.text+=u.text):n.push(u);continue}if(u=this.tokenizer.emStrong(t,r,a)){t=t.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.codespan(t)){t=t.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.br(t)){t=t.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.del(t)){t=t.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.autolink(t)){t=t.substring(u.raw.length),n.push(u);continue}if(!this.state.inLink&&(u=this.tokenizer.url(t))){t=t.substring(u.raw.length),n.push(u);continue}let d=t;if((c=this.options.extensions)!=null&&c.startInline){let h=1/0;const m=t.slice(1);let y;this.options.extensions.startInline.forEach(b=>{y=b.call({lexer:this},m),typeof y=="number"&&y>=0&&(h=Math.min(h,y))}),h<1/0&&h>=0&&(d=t.substring(0,h+1))}if(u=this.tokenizer.inlineText(d)){t=t.substring(u.raw.length),u.raw.slice(-1)!=="_"&&(a=u.raw.slice(-1)),i=!0;const h=n.at(-1);(h==null?void 0:h.type)==="text"?(h.raw+=u.raw,h.text+=u.text):n.push(u);continue}if(t){const h="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(h);break}else throw new Error(h)}}return n}},bE=class{constructor(e){ce(this,"options");ce(this,"parser");this.options=e||bg}space(e){return""}code({text:e,lang:t,escaped:n}){var i;const r=(i=(t||"").match(lo.notSpaceStart))==null?void 0:i[0],s=e.replace(lo.endingNewline,"")+`
`;return r?'<pre><code class="language-'+yu(r)+'">'+(n?s:yu(s,!0))+`</code></pre>
`:"<pre><code>"+(n?s:yu(s,!0))+`</code></pre>
`}blockquote({tokens:e}){return`<blockquote>
${this.parser.parse(e)}</blockquote>
`}html({text:e}){return e}heading({tokens:e,depth:t}){return`<h${t}>${this.parser.parseInline(e)}</h${t}>
`}hr(e){return`<hr>
`}list(e){const t=e.ordered,n=e.start;let r="";for(let a=0;a<e.items.length;a++){const o=e.items[a];r+=this.listitem(o)}const s=t?"ol":"ul",i=t&&n!==1?' start="'+n+'"':"";return"<"+s+i+`>
`+r+"</"+s+`>
`}listitem(e){var n;let t="";if(e.task){const r=this.checkbox({checked:!!e.checked});e.loose?((n=e.tokens[0])==null?void 0:n.type)==="paragraph"?(e.tokens[0].text=r+" "+e.tokens[0].text,e.tokens[0].tokens&&e.tokens[0].tokens.length>0&&e.tokens[0].tokens[0].type==="text"&&(e.tokens[0].tokens[0].text=r+" "+yu(e.tokens[0].tokens[0].text),e.tokens[0].tokens[0].escaped=!0)):e.tokens.unshift({type:"text",raw:r+" ",text:r+" ",escaped:!0}):t+=r+" "}return t+=this.parser.parse(e.tokens,!!e.loose),`<li>${t}</li>
`}checkbox({checked:e}){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:e}){return`<p>${this.parser.parseInline(e)}</p>
`}table(e){let t="",n="";for(let s=0;s<e.header.length;s++)n+=this.tablecell(e.header[s]);t+=this.tablerow({text:n});let r="";for(let s=0;s<e.rows.length;s++){const i=e.rows[s];n="";for(let a=0;a<i.length;a++)n+=this.tablecell(i[a]);r+=this.tablerow({text:n})}return r&&(r=`<tbody>${r}</tbody>`),`<table>
<thead>
`+t+`</thead>
`+r+`</table>
`}tablerow({text:e}){return`<tr>
${e}</tr>
`}tablecell(e){const t=this.parser.parseInline(e.tokens),n=e.header?"th":"td";return(e.align?`<${n} align="${e.align}">`:`<${n}>`)+t+`</${n}>
`}strong({tokens:e}){return`<strong>${this.parser.parseInline(e)}</strong>`}em({tokens:e}){return`<em>${this.parser.parseInline(e)}</em>`}codespan({text:e}){return`<code>${yu(e,!0)}</code>`}br(e){return"<br>"}del({tokens:e}){return`<del>${this.parser.parseInline(e)}</del>`}link({href:e,title:t,tokens:n}){const r=this.parser.parseInline(n),s=BW(e);if(s===null)return r;e=s;let i='<a href="'+e+'"';return t&&(i+=' title="'+yu(t)+'"'),i+=">"+r+"</a>",i}image({href:e,title:t,text:n,tokens:r}){r&&(n=this.parser.parseInline(r,this.parser.textRenderer));const s=BW(e);if(s===null)return yu(n);e=s;let i=`<img src="${e}" alt="${n}"`;return t&&(i+=` title="${yu(t)}"`),i+=">",i}text(e){return"tokens"in e&&e.tokens?this.parser.parseInline(e.tokens):"escaped"in e&&e.escaped?e.text:yu(e.text)}},S5=class{strong({text:e}){return e}em({text:e}){return e}codespan({text:e}){return e}del({text:e}){return e}html({text:e}){return e}text({text:e}){return e}link({text:e}){return""+e}image({text:e}){return""+e}br(){return""}},Kd=class P4{constructor(t){ce(this,"options");ce(this,"renderer");ce(this,"textRenderer");this.options=t||bg,this.options.renderer=this.options.renderer||new bE,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new S5}static parse(t,n){return new P4(n).parse(t)}static parseInline(t,n){return new P4(n).parseInline(t)}parse(t,n=!0){var s,i;let r="";for(let a=0;a<t.length;a++){const o=t[a];if((i=(s=this.options.extensions)==null?void 0:s.renderers)!=null&&i[o.type]){const c=o,u=this.options.extensions.renderers[c.type].call({parser:this},c);if(u!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(c.type)){r+=u||"";continue}}const l=o;switch(l.type){case"space":{r+=this.renderer.space(l);continue}case"hr":{r+=this.renderer.hr(l);continue}case"heading":{r+=this.renderer.heading(l);continue}case"code":{r+=this.renderer.code(l);continue}case"table":{r+=this.renderer.table(l);continue}case"blockquote":{r+=this.renderer.blockquote(l);continue}case"list":{r+=this.renderer.list(l);continue}case"html":{r+=this.renderer.html(l);continue}case"paragraph":{r+=this.renderer.paragraph(l);continue}case"text":{let c=l,u=this.renderer.text(c);for(;a+1<t.length&&t[a+1].type==="text";)c=t[++a],u+=`
`+this.renderer.text(c);n?r+=this.renderer.paragraph({type:"paragraph",raw:u,text:u,tokens:[{type:"text",raw:u,text:u,escaped:!0}]}):r+=u;continue}default:{const c='Token with "'+l.type+'" type was not found.';if(this.options.silent)return console.error(c),"";throw new Error(c)}}}return r}parseInline(t,n=this.renderer){var s,i;let r="";for(let a=0;a<t.length;a++){const o=t[a];if((i=(s=this.options.extensions)==null?void 0:s.renderers)!=null&&i[o.type]){const c=this.options.extensions.renderers[o.type].call({parser:this},o);if(c!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(o.type)){r+=c||"";continue}}const l=o;switch(l.type){case"escape":{r+=n.text(l);break}case"html":{r+=n.html(l);break}case"link":{r+=n.link(l);break}case"image":{r+=n.image(l);break}case"strong":{r+=n.strong(l);break}case"em":{r+=n.em(l);break}case"codespan":{r+=n.codespan(l);break}case"br":{r+=n.br(l);break}case"del":{r+=n.del(l);break}case"text":{r+=n.text(l);break}default:{const c='Token with "'+l.type+'" type was not found.';if(this.options.silent)return console.error(c),"";throw new Error(c)}}}return r}},t3,h2=(t3=class{constructor(e){ce(this,"options");ce(this,"block");this.options=e||bg}preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}provideLexer(){return this.block?Gd.lex:Gd.lexInline}provideParser(){return this.block?Kd.parse:Kd.parseInline}},ce(t3,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens"])),t3),Sot=class{constructor(...e){ce(this,"defaults",p5());ce(this,"options",this.setOptions);ce(this,"parse",this.parseMarkdown(!0));ce(this,"parseInline",this.parseMarkdown(!1));ce(this,"Parser",Kd);ce(this,"Renderer",bE);ce(this,"TextRenderer",S5);ce(this,"Lexer",Gd);ce(this,"Tokenizer",yE);ce(this,"Hooks",h2);this.use(...e)}walkTokens(e,t){var r,s;let n=[];for(const i of e)switch(n=n.concat(t.call(this,i)),i.type){case"table":{const a=i;for(const o of a.header)n=n.concat(this.walkTokens(o.tokens,t));for(const o of a.rows)for(const l of o)n=n.concat(this.walkTokens(l.tokens,t));break}case"list":{const a=i;n=n.concat(this.walkTokens(a.items,t));break}default:{const a=i;(s=(r=this.defaults.extensions)==null?void 0:r.childTokens)!=null&&s[a.type]?this.defaults.extensions.childTokens[a.type].forEach(o=>{const l=a[o].flat(1/0);n=n.concat(this.walkTokens(l,t))}):a.tokens&&(n=n.concat(this.walkTokens(a.tokens,t)))}}return n}use(...e){const t=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach(n=>{const r={...n};if(r.async=this.defaults.async||r.async||!1,n.extensions&&(n.extensions.forEach(s=>{if(!s.name)throw new Error("extension name required");if("renderer"in s){const i=t.renderers[s.name];i?t.renderers[s.name]=function(...a){let o=s.renderer.apply(this,a);return o===!1&&(o=i.apply(this,a)),o}:t.renderers[s.name]=s.renderer}if("tokenizer"in s){if(!s.level||s.level!=="block"&&s.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");const i=t[s.level];i?i.unshift(s.tokenizer):t[s.level]=[s.tokenizer],s.start&&(s.level==="block"?t.startBlock?t.startBlock.push(s.start):t.startBlock=[s.start]:s.level==="inline"&&(t.startInline?t.startInline.push(s.start):t.startInline=[s.start]))}"childTokens"in s&&s.childTokens&&(t.childTokens[s.name]=s.childTokens)}),r.extensions=t),n.renderer){const s=this.defaults.renderer||new bE(this.defaults);for(const i in n.renderer){if(!(i in s))throw new Error(`renderer '${i}' does not exist`);if(["options","parser"].includes(i))continue;const a=i,o=n.renderer[a],l=s[a];s[a]=(...c)=>{let u=o.apply(s,c);return u===!1&&(u=l.apply(s,c)),u||""}}r.renderer=s}if(n.tokenizer){const s=this.defaults.tokenizer||new yE(this.defaults);for(const i in n.tokenizer){if(!(i in s))throw new Error(`tokenizer '${i}' does not exist`);if(["options","rules","lexer"].includes(i))continue;const a=i,o=n.tokenizer[a],l=s[a];s[a]=(...c)=>{let u=o.apply(s,c);return u===!1&&(u=l.apply(s,c)),u}}r.tokenizer=s}if(n.hooks){const s=this.defaults.hooks||new h2;for(const i in n.hooks){if(!(i in s))throw new Error(`hook '${i}' does not exist`);if(["options","block"].includes(i))continue;const a=i,o=n.hooks[a],l=s[a];h2.passThroughHooks.has(i)?s[a]=c=>{if(this.defaults.async)return Promise.resolve(o.call(s,c)).then(d=>l.call(s,d));const u=o.call(s,c);return l.call(s,u)}:s[a]=(...c)=>{let u=o.apply(s,c);return u===!1&&(u=l.apply(s,c)),u}}r.hooks=s}if(n.walkTokens){const s=this.defaults.walkTokens,i=n.walkTokens;r.walkTokens=function(a){let o=[];return o.push(i.call(this,a)),s&&(o=o.concat(s.call(this,a))),o}}this.defaults={...this.defaults,...r}}),this}setOptions(e){return this.defaults={...this.defaults,...e},this}lexer(e,t){return Gd.lex(e,t??this.defaults)}parser(e,t){return Kd.parse(e,t??this.defaults)}parseMarkdown(e){return(n,r)=>{const s={...r},i={...this.defaults,...s},a=this.onError(!!i.silent,!!i.async);if(this.defaults.async===!0&&s.async===!1)return a(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof n>"u"||n===null)return a(new Error("marked(): input parameter is undefined or null"));if(typeof n!="string")return a(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(n)+", string expected"));i.hooks&&(i.hooks.options=i,i.hooks.block=e);const o=i.hooks?i.hooks.provideLexer():e?Gd.lex:Gd.lexInline,l=i.hooks?i.hooks.provideParser():e?Kd.parse:Kd.parseInline;if(i.async)return Promise.resolve(i.hooks?i.hooks.preprocess(n):n).then(c=>o(c,i)).then(c=>i.hooks?i.hooks.processAllTokens(c):c).then(c=>i.walkTokens?Promise.all(this.walkTokens(c,i.walkTokens)).then(()=>c):c).then(c=>l(c,i)).then(c=>i.hooks?i.hooks.postprocess(c):c).catch(a);try{i.hooks&&(n=i.hooks.preprocess(n));let c=o(n,i);i.hooks&&(c=i.hooks.processAllTokens(c)),i.walkTokens&&this.walkTokens(c,i.walkTokens);let u=l(c,i);return i.hooks&&(u=i.hooks.postprocess(u)),u}catch(c){return a(c)}}}onError(e,t){return n=>{if(n.message+=`
Please report this to https://github.com/markedjs/marked.`,e){const r="<p>An error occurred:</p><pre>"+yu(n.message+"",!0)+"</pre>";return t?Promise.resolve(r):r}if(t)return Promise.reject(n);throw n}}},Gm=new Sot;function fs(e,t){return Gm.parse(e,t)}fs.options=fs.setOptions=function(e){return Gm.setOptions(e),fs.defaults=Gm.defaults,Ece(fs.defaults),fs};fs.getDefaults=p5;fs.defaults=bg;fs.use=function(...e){return Gm.use(...e),fs.defaults=Gm.defaults,Ece(fs.defaults),fs};fs.walkTokens=function(e,t){return Gm.walkTokens(e,t)};fs.parseInline=Gm.parseInline;fs.Parser=Kd;fs.parser=Kd.parse;fs.Renderer=bE;fs.TextRenderer=S5;fs.Lexer=Gd;fs.lexer=Gd.lex;fs.Tokenizer=yE;fs.Hooks=h2;fs.parse=fs;fs.options;fs.setOptions;fs.use;fs.walkTokens;fs.parseInline;Kd.parse;Gd.lex;function Fce(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=Array.from(typeof e=="string"?[e]:e);r[r.length-1]=r[r.length-1].replace(/\r?\n([\t ]*)$/,"");var s=r.reduce(function(o,l){var c=l.match(/\n([\t ]+|(?!\s).)/g);return c?o.concat(c.map(function(u){var d,h;return(h=(d=u.match(/[\t ]/g))===null||d===void 0?void 0:d.length)!==null&&h!==void 0?h:0})):o},[]);if(s.length){var i=new RegExp(`
[	 ]{`+Math.min.apply(Math,s)+"}","g");r=r.map(function(o){return o.replace(i,`
`)})}r[0]=r[0].replace(/^\r?\n/,"");var a=r[0];return t.forEach(function(o,l){var c=a.match(/(?:^|\n)( *)$/),u=c?c[1]:"",d=o;typeof o=="string"&&o.includes(`
`)&&(d=String(o).split(`
`).map(function(h,m){return m===0?h:""+u+h}).join(`
`)),a+=d+r[l+1]}),a}function Lce(e,{markdownAutoWrap:t}){const r=e.replace(/<br\/>/g,`
`).replace(/\n{2,}/g,`
`),s=Fce(r);return t===!1?s.replace(/ /g,"&nbsp;"):s}ie(Lce,"preprocessMarkdown");function Bce(e,t={}){const n=Lce(e,t),r=fs.lexer(n),s=[[]];let i=0;function a(o,l="normal"){o.type==="text"?o.text.split(`
`).forEach((u,d)=>{d!==0&&(i++,s.push([])),u.split(" ").forEach(h=>{h=h.replace(/&#39;/g,"'"),h&&s[i].push({content:h,type:l})})}):o.type==="strong"||o.type==="em"?o.tokens.forEach(c=>{a(c,o.type)}):o.type==="html"&&s[i].push({content:o.text,type:"normal"})}return ie(a,"processNode"),r.forEach(o=>{var l;o.type==="paragraph"?(l=o.tokens)==null||l.forEach(c=>{a(c)}):o.type==="html"&&s[i].push({content:o.text,type:"normal"})}),s}ie(Bce,"markdownToLines");function $ce(e,{markdownAutoWrap:t}={}){const n=fs.lexer(e);function r(s){var i,a,o;return s.type==="text"?t===!1?s.text.replace(/\n */g,"<br/>").replace(/ /g,"&nbsp;"):s.text.replace(/\n */g,"<br/>"):s.type==="strong"?`<strong>${(i=s.tokens)==null?void 0:i.map(r).join("")}</strong>`:s.type==="em"?`<em>${(a=s.tokens)==null?void 0:a.map(r).join("")}</em>`:s.type==="paragraph"?`<p>${(o=s.tokens)==null?void 0:o.map(r).join("")}</p>`:s.type==="space"?"":s.type==="html"?`${s.text}`:s.type==="escape"?s.text:`Unsupported markdown: ${s.type}`}return ie(r,"output"),n.map(r).join("")}ie($ce,"markdownToHTML");function zce(e){return Intl.Segmenter?[...new Intl.Segmenter().segment(e)].map(t=>t.segment):[...e]}ie(zce,"splitTextToChars");function Uce(e,t){const n=zce(t.content);return _5(e,[],n,t.type)}ie(Uce,"splitWordToFitWidth");function _5(e,t,n,r){if(n.length===0)return[{content:t.join(""),type:r},{content:"",type:r}];const[s,...i]=n,a=[...t,s];return e([{content:a.join(""),type:r}])?_5(e,a,i,r):(t.length===0&&s&&(t.push(s),n.shift()),[{content:t.join(""),type:r},{content:n.join(""),type:r}])}ie(_5,"splitWordToFitWidthRecursion");function qce(e,t){if(e.some(({content:n})=>n.includes(`
`)))throw new Error("splitLineToFitWidth does not support newlines in the line");return vE(e,t)}ie(qce,"splitLineToFitWidth");function vE(e,t,n=[],r=[]){if(e.length===0)return r.length>0&&n.push(r),n.length>0?n:[];let s="";e[0].content===" "&&(s=" ",e.shift());const i=e.shift()??{content:" ",type:"normal"},a=[...r];if(s!==""&&a.push({content:s,type:"normal"}),a.push(i),t(a))return vE(e,t,n,a);if(r.length>0)n.push(r),e.unshift(i);else if(i.content){const[o,l]=Uce(t,i);n.push([o]),l.content&&e.unshift(l)}return vE(e,t,n)}ie(vE,"splitLineToFitWidthRecursion");function O4(e,t){t&&e.attr("style",t)}ie(O4,"applyStyle");async function Vce(e,t,n,r,s=!1){const i=e.append("foreignObject");i.attr("width",`${10*n}px`),i.attr("height",`${10*n}px`);const a=i.append("xhtml:div");let o=t.label;t.label&&qy(t.label)&&(o=await M6(t.label.replace(Ib.lineBreakRegex,`
`),ls()));const l=t.isNode?"nodeLabel":"edgeLabel",c=a.append("span");c.html(o),O4(c,t.labelStyle),c.attr("class",`${l} ${r}`),O4(a,t.labelStyle),a.style("display","table-cell"),a.style("white-space","nowrap"),a.style("line-height","1.5"),a.style("max-width",n+"px"),a.style("text-align","center"),a.attr("xmlns","http://www.w3.org/1999/xhtml"),s&&a.attr("class","labelBkg");let u=a.node().getBoundingClientRect();return u.width===n&&(a.style("display","table"),a.style("white-space","break-spaces"),a.style("width",n+"px"),u=a.node().getBoundingClientRect()),i.node()}ie(Vce,"addHtmlSpan");function TA(e,t,n){return e.append("tspan").attr("class","text-outer-tspan").attr("x",0).attr("y",t*n-.1+"em").attr("dy",n+"em")}ie(TA,"createTspan");function Wce(e,t,n){const r=e.append("text"),s=TA(r,1,t);AA(s,n);const i=s.node().getComputedTextLength();return r.remove(),i}ie(Wce,"computeWidthOfText");function _ot(e,t,n){var a;const r=e.append("text"),s=TA(r,1,t);AA(s,[{content:n,type:"normal"}]);const i=(a=s.node())==null?void 0:a.getBoundingClientRect();return i&&r.remove(),i}ie(_ot,"computeDimensionOfText");function Hce(e,t,n,r=!1){const i=t.append("g"),a=i.insert("rect").attr("class","background").attr("style","stroke: none"),o=i.append("text").attr("y","-10.1");let l=0;for(const c of n){const u=ie(h=>Wce(i,1.1,h)<=e,"checkWidth"),d=u(c)?[c]:qce(c,u);for(const h of d){const m=TA(o,l,1.1);AA(m,h),l++}}if(r){const c=o.node().getBBox(),u=2;return a.attr("x",c.x-u).attr("y",c.y-u).attr("width",c.width+2*u).attr("height",c.height+2*u),i.node()}else return o.node()}ie(Hce,"createFormattedText");function AA(e,t){e.text(""),t.forEach((n,r)=>{const s=e.append("tspan").attr("font-style",n.type==="em"?"italic":"normal").attr("class","text-inner-tspan").attr("font-weight",n.type==="strong"?"bold":"normal");r===0?s.text(n.content):s.text(" "+n.content)})}ie(AA,"updateTextContentAndStyles");function Gce(e){return e.replace(/fa[bklrs]?:fa-[\w-]+/g,t=>`<i class='${t.replace(":"," ")}'></i>`)}ie(Gce,"replaceIconSubstring");var Sp=ie(async(e,t="",{style:n="",isTitle:r=!1,classes:s="",useHtmlLabels:i=!0,isNode:a=!0,width:o=200,addSvgBackground:l=!1}={},c)=>{if(qt.debug("XYZ createText",t,n,r,s,i,a,"addSvgBackground: ",l),i){const u=$ce(t,c),d=Gce(yg(u)),h=t.replace(/\\\\/g,"\\"),m={isNode:a,label:qy(t)?h:d,labelStyle:n.replace("fill:","color:")};return await Vce(e,m,o,s,l)}else{const u=t.replace(/<br\s*\/?>/g,"<br/>"),d=Bce(u.replace("<br>","<br/>"),c),h=Hce(o,e,d,t?l:!1);if(a){/stroke:/.exec(n)&&(n=n.replace("stroke:","lineColor:"));const m=n.replace(/stroke:[^;]+;?/g,"").replace(/stroke-width:[^;]+;?/g,"").replace(/fill:[^;]+;?/g,"").replace(/color:/g,"fill:");Zr(h).attr("style",m)}else{const m=n.replace(/stroke:[^;]+;?/g,"").replace(/stroke-width:[^;]+;?/g,"").replace(/fill:[^;]+;?/g,"").replace(/background:/g,"fill:");Zr(h).select("rect").attr("style",m.replace(/background:/g,"fill:"));const y=n.replace(/stroke:[^;]+;?/g,"").replace(/stroke-width:[^;]+;?/g,"").replace(/fill:[^;]+;?/g,"").replace(/color:/g,"fill:");Zr(h).select("text").attr("style",y)}return h}},"createText");function Gj(e,t,n){if(e&&e.length){const[r,s]=t,i=Math.PI/180*n,a=Math.cos(i),o=Math.sin(i);for(const l of e){const[c,u]=l;l[0]=(c-r)*a-(u-s)*o+r,l[1]=(c-r)*o+(u-s)*a+s}}}function Cot(e,t){return e[0]===t[0]&&e[1]===t[1]}function kot(e,t,n,r=1){const s=n,i=Math.max(t,.1),a=e[0]&&e[0][0]&&typeof e[0][0]=="number"?[e]:e,o=[0,0];if(s)for(const c of a)Gj(c,o,s);const l=function(c,u,d){const h=[];for(const w of c){const _=[...w];Cot(_[0],_[_.length-1])||_.push([_[0][0],_[0][1]]),_.length>2&&h.push(_)}const m=[];u=Math.max(u,.1);const y=[];for(const w of h)for(let _=0;_<w.length-1;_++){const k=w[_],C=w[_+1];if(k[1]!==C[1]){const T=Math.min(k[1],C[1]);y.push({ymin:T,ymax:Math.max(k[1],C[1]),x:T===k[1]?k[0]:C[0],islope:(C[0]-k[0])/(C[1]-k[1])})}}if(y.sort((w,_)=>w.ymin<_.ymin?-1:w.ymin>_.ymin?1:w.x<_.x?-1:w.x>_.x?1:w.ymax===_.ymax?0:(w.ymax-_.ymax)/Math.abs(w.ymax-_.ymax)),!y.length)return m;let b=[],v=y[0].ymin,x=0;for(;b.length||y.length;){if(y.length){let w=-1;for(let _=0;_<y.length&&!(y[_].ymin>v);_++)w=_;y.splice(0,w+1).forEach(_=>{b.push({s:v,edge:_})})}if(b=b.filter(w=>!(w.edge.ymax<=v)),b.sort((w,_)=>w.edge.x===_.edge.x?0:(w.edge.x-_.edge.x)/Math.abs(w.edge.x-_.edge.x)),(d!==1||x%u==0)&&b.length>1)for(let w=0;w<b.length;w+=2){const _=w+1;if(_>=b.length)break;const k=b[w].edge,C=b[_].edge;m.push([[Math.round(k.x),v],[Math.round(C.x),v]])}v+=d,b.forEach(w=>{w.edge.x=w.edge.x+d*w.edge.islope}),x++}return m}(a,i,r);if(s){for(const c of a)Gj(c,o,-s);(function(c,u,d){const h=[];c.forEach(m=>h.push(...m)),Gj(h,u,d)})(l,o,-s)}return l}function NS(e,t){var n;const r=t.hachureAngle+90;let s=t.hachureGap;s<0&&(s=4*t.strokeWidth),s=Math.round(Math.max(s,.1));let i=1;return t.roughness>=1&&(((n=t.randomizer)===null||n===void 0?void 0:n.next())||Math.random())>.7&&(i=s),kot(e,s,r,i||1)}class C5{constructor(t){this.helper=t}fillPolygons(t,n){return this._fillPolygons(t,n)}_fillPolygons(t,n){const r=NS(t,n);return{type:"fillSketch",ops:this.renderLines(r,n)}}renderLines(t,n){const r=[];for(const s of t)r.push(...this.helper.doubleLineOps(s[0][0],s[0][1],s[1][0],s[1][1],n));return r}}function RA(e){const t=e[0],n=e[1];return Math.sqrt(Math.pow(t[0]-n[0],2)+Math.pow(t[1]-n[1],2))}class Eot extends C5{fillPolygons(t,n){let r=n.hachureGap;r<0&&(r=4*n.strokeWidth),r=Math.max(r,.1);const s=NS(t,Object.assign({},n,{hachureGap:r})),i=Math.PI/180*n.hachureAngle,a=[],o=.5*r*Math.cos(i),l=.5*r*Math.sin(i);for(const[c,u]of s)RA([c,u])&&a.push([[c[0]-o,c[1]+l],[...u]],[[c[0]+o,c[1]-l],[...u]]);return{type:"fillSketch",ops:this.renderLines(a,n)}}}class Tot extends C5{fillPolygons(t,n){const r=this._fillPolygons(t,n),s=Object.assign({},n,{hachureAngle:n.hachureAngle+90}),i=this._fillPolygons(t,s);return r.ops=r.ops.concat(i.ops),r}}class Aot{constructor(t){this.helper=t}fillPolygons(t,n){const r=NS(t,n=Object.assign({},n,{hachureAngle:0}));return this.dotsOnLines(r,n)}dotsOnLines(t,n){const r=[];let s=n.hachureGap;s<0&&(s=4*n.strokeWidth),s=Math.max(s,.1);let i=n.fillWeight;i<0&&(i=n.strokeWidth/2);const a=s/4;for(const o of t){const l=RA(o),c=l/s,u=Math.ceil(c)-1,d=l-u*s,h=(o[0][0]+o[1][0])/2-s/4,m=Math.min(o[0][1],o[1][1]);for(let y=0;y<u;y++){const b=m+d+y*s,v=h-a+2*Math.random()*a,x=b-a+2*Math.random()*a,w=this.helper.ellipse(v,x,i,i,n);r.push(...w.ops)}}return{type:"fillSketch",ops:r}}}class Rot{constructor(t){this.helper=t}fillPolygons(t,n){const r=NS(t,n);return{type:"fillSketch",ops:this.dashedLine(r,n)}}dashedLine(t,n){const r=n.dashOffset<0?n.hachureGap<0?4*n.strokeWidth:n.hachureGap:n.dashOffset,s=n.dashGap<0?n.hachureGap<0?4*n.strokeWidth:n.hachureGap:n.dashGap,i=[];return t.forEach(a=>{const o=RA(a),l=Math.floor(o/(r+s)),c=(o+s-l*(r+s))/2;let u=a[0],d=a[1];u[0]>d[0]&&(u=a[1],d=a[0]);const h=Math.atan((d[1]-u[1])/(d[0]-u[0]));for(let m=0;m<l;m++){const y=m*(r+s),b=y+r,v=[u[0]+y*Math.cos(h)+c*Math.cos(h),u[1]+y*Math.sin(h)+c*Math.sin(h)],x=[u[0]+b*Math.cos(h)+c*Math.cos(h),u[1]+b*Math.sin(h)+c*Math.sin(h)];i.push(...this.helper.doubleLineOps(v[0],v[1],x[0],x[1],n))}}),i}}class Not{constructor(t){this.helper=t}fillPolygons(t,n){const r=n.hachureGap<0?4*n.strokeWidth:n.hachureGap,s=n.zigzagOffset<0?r:n.zigzagOffset,i=NS(t,n=Object.assign({},n,{hachureGap:r+s}));return{type:"fillSketch",ops:this.zigzagLines(i,s,n)}}zigzagLines(t,n,r){const s=[];return t.forEach(i=>{const a=RA(i),o=Math.round(a/(2*n));let l=i[0],c=i[1];l[0]>c[0]&&(l=i[1],c=i[0]);const u=Math.atan((c[1]-l[1])/(c[0]-l[0]));for(let d=0;d<o;d++){const h=2*d*n,m=2*(d+1)*n,y=Math.sqrt(2*Math.pow(n,2)),b=[l[0]+h*Math.cos(u),l[1]+h*Math.sin(u)],v=[l[0]+m*Math.cos(u),l[1]+m*Math.sin(u)],x=[b[0]+y*Math.cos(u+Math.PI/4),b[1]+y*Math.sin(u+Math.PI/4)];s.push(...this.helper.doubleLineOps(b[0],b[1],x[0],x[1],r),...this.helper.doubleLineOps(x[0],x[1],v[0],v[1],r))}}),s}}const Oo={};class Iot{constructor(t){this.seed=t}next(){return this.seed?(2**31-1&(this.seed=Math.imul(48271,this.seed)))/2**31:Math.random()}}const Mot=0,Kj=1,UW=2,FC={A:7,a:7,C:6,c:6,H:1,h:1,L:2,l:2,M:2,m:2,Q:4,q:4,S:4,s:4,T:2,t:2,V:1,v:1,Z:0,z:0};function Yj(e,t){return e.type===t}function k5(e){const t=[],n=function(a){const o=new Array;for(;a!=="";)if(a.match(/^([ \t\r\n,]+)/))a=a.substr(RegExp.$1.length);else if(a.match(/^([aAcChHlLmMqQsStTvVzZ])/))o[o.length]={type:Mot,text:RegExp.$1},a=a.substr(RegExp.$1.length);else{if(!a.match(/^(([-+]?[0-9]+(\.[0-9]*)?|[-+]?\.[0-9]+)([eE][-+]?[0-9]+)?)/))return[];o[o.length]={type:Kj,text:`${parseFloat(RegExp.$1)}`},a=a.substr(RegExp.$1.length)}return o[o.length]={type:UW,text:""},o}(e);let r="BOD",s=0,i=n[s];for(;!Yj(i,UW);){let a=0;const o=[];if(r==="BOD"){if(i.text!=="M"&&i.text!=="m")return k5("M0,0"+e);s++,a=FC[i.text],r=i.text}else Yj(i,Kj)?a=FC[r]:(s++,a=FC[i.text],r=i.text);if(!(s+a<n.length))throw new Error("Path data ended short");for(let l=s;l<s+a;l++){const c=n[l];if(!Yj(c,Kj))throw new Error("Param not a number: "+r+","+c.text);o[o.length]=+c.text}if(typeof FC[r]!="number")throw new Error("Bad segment: "+r);{const l={key:r,data:o};t.push(l),s+=a,i=n[s],r==="M"&&(r="L"),r==="m"&&(r="l")}}return t}function Kce(e){let t=0,n=0,r=0,s=0;const i=[];for(const{key:a,data:o}of e)switch(a){case"M":i.push({key:"M",data:[...o]}),[t,n]=o,[r,s]=o;break;case"m":t+=o[0],n+=o[1],i.push({key:"M",data:[t,n]}),r=t,s=n;break;case"L":i.push({key:"L",data:[...o]}),[t,n]=o;break;case"l":t+=o[0],n+=o[1],i.push({key:"L",data:[t,n]});break;case"C":i.push({key:"C",data:[...o]}),t=o[4],n=o[5];break;case"c":{const l=o.map((c,u)=>u%2?c+n:c+t);i.push({key:"C",data:l}),t=l[4],n=l[5];break}case"Q":i.push({key:"Q",data:[...o]}),t=o[2],n=o[3];break;case"q":{const l=o.map((c,u)=>u%2?c+n:c+t);i.push({key:"Q",data:l}),t=l[2],n=l[3];break}case"A":i.push({key:"A",data:[...o]}),t=o[5],n=o[6];break;case"a":t+=o[5],n+=o[6],i.push({key:"A",data:[o[0],o[1],o[2],o[3],o[4],t,n]});break;case"H":i.push({key:"H",data:[...o]}),t=o[0];break;case"h":t+=o[0],i.push({key:"H",data:[t]});break;case"V":i.push({key:"V",data:[...o]}),n=o[0];break;case"v":n+=o[0],i.push({key:"V",data:[n]});break;case"S":i.push({key:"S",data:[...o]}),t=o[2],n=o[3];break;case"s":{const l=o.map((c,u)=>u%2?c+n:c+t);i.push({key:"S",data:l}),t=l[2],n=l[3];break}case"T":i.push({key:"T",data:[...o]}),t=o[0],n=o[1];break;case"t":t+=o[0],n+=o[1],i.push({key:"T",data:[t,n]});break;case"Z":case"z":i.push({key:"Z",data:[]}),t=r,n=s}return i}function Yce(e){const t=[];let n="",r=0,s=0,i=0,a=0,o=0,l=0;for(const{key:c,data:u}of e){switch(c){case"M":t.push({key:"M",data:[...u]}),[r,s]=u,[i,a]=u;break;case"C":t.push({key:"C",data:[...u]}),r=u[4],s=u[5],o=u[2],l=u[3];break;case"L":t.push({key:"L",data:[...u]}),[r,s]=u;break;case"H":r=u[0],t.push({key:"L",data:[r,s]});break;case"V":s=u[0],t.push({key:"L",data:[r,s]});break;case"S":{let d=0,h=0;n==="C"||n==="S"?(d=r+(r-o),h=s+(s-l)):(d=r,h=s),t.push({key:"C",data:[d,h,...u]}),o=u[0],l=u[1],r=u[2],s=u[3];break}case"T":{const[d,h]=u;let m=0,y=0;n==="Q"||n==="T"?(m=r+(r-o),y=s+(s-l)):(m=r,y=s);const b=r+2*(m-r)/3,v=s+2*(y-s)/3,x=d+2*(m-d)/3,w=h+2*(y-h)/3;t.push({key:"C",data:[b,v,x,w,d,h]}),o=m,l=y,r=d,s=h;break}case"Q":{const[d,h,m,y]=u,b=r+2*(d-r)/3,v=s+2*(h-s)/3,x=m+2*(d-m)/3,w=y+2*(h-y)/3;t.push({key:"C",data:[b,v,x,w,m,y]}),o=d,l=h,r=m,s=y;break}case"A":{const d=Math.abs(u[0]),h=Math.abs(u[1]),m=u[2],y=u[3],b=u[4],v=u[5],x=u[6];d===0||h===0?(t.push({key:"C",data:[r,s,v,x,v,x]}),r=v,s=x):(r!==v||s!==x)&&(Zce(r,s,v,x,d,h,m,y,b).forEach(function(w){t.push({key:"C",data:w})}),r=v,s=x);break}case"Z":t.push({key:"Z",data:[]}),r=i,s=a}n=c}return t}function ux(e,t,n){return[e*Math.cos(n)-t*Math.sin(n),e*Math.sin(n)+t*Math.cos(n)]}function Zce(e,t,n,r,s,i,a,o,l,c){const u=(d=a,Math.PI*d/180);var d;let h=[],m=0,y=0,b=0,v=0;if(c)[m,y,b,v]=c;else{[e,t]=ux(e,t,-u),[n,r]=ux(n,r,-u);const H=(e-n)/2,O=(t-r)/2;let K=H*H/(s*s)+O*O/(i*i);K>1&&(K=Math.sqrt(K),s*=K,i*=K);const U=s*s,W=i*i,B=U*W-U*O*O-W*H*H,ne=U*O*O+W*H*H,V=(o===l?-1:1)*Math.sqrt(Math.abs(B/ne));b=V*s*O/i+(e+n)/2,v=V*-i*H/s+(t+r)/2,m=Math.asin(parseFloat(((t-v)/i).toFixed(9))),y=Math.asin(parseFloat(((r-v)/i).toFixed(9))),e<b&&(m=Math.PI-m),n<b&&(y=Math.PI-y),m<0&&(m=2*Math.PI+m),y<0&&(y=2*Math.PI+y),l&&m>y&&(m-=2*Math.PI),!l&&y>m&&(y-=2*Math.PI)}let x=y-m;if(Math.abs(x)>120*Math.PI/180){const H=y,O=n,K=r;y=l&&y>m?m+120*Math.PI/180*1:m+120*Math.PI/180*-1,h=Zce(n=b+s*Math.cos(y),r=v+i*Math.sin(y),O,K,s,i,a,0,l,[y,H,b,v])}x=y-m;const w=Math.cos(m),_=Math.sin(m),k=Math.cos(y),C=Math.sin(y),T=Math.tan(x/4),A=4/3*s*T,N=4/3*i*T,I=[e,t],j=[e+A*_,t-N*w],L=[n+A*C,r-N*k],D=[n,r];if(j[0]=2*I[0]-j[0],j[1]=2*I[1]-j[1],c)return[j,L,D].concat(h);{h=[j,L,D].concat(h);const H=[];for(let O=0;O<h.length;O+=3){const K=ux(h[O][0],h[O][1],u),U=ux(h[O+1][0],h[O+1][1],u),W=ux(h[O+2][0],h[O+2][1],u);H.push([K[0],K[1],U[0],U[1],W[0],W[1]])}return H}}const jot={randOffset:function(e,t){return rr(e,t)},randOffsetWithRange:function(e,t,n){return xE(e,t,n)},ellipse:function(e,t,n,r,s){const i=Jce(n,r,s);return D4(e,t,s,i).opset},doubleLineOps:function(e,t,n,r,s){return Qh(e,t,n,r,s,!0)}};function Xce(e,t,n,r,s){return{type:"path",ops:Qh(e,t,n,r,s)}}function p2(e,t,n){const r=(e||[]).length;if(r>2){const s=[];for(let i=0;i<r-1;i++)s.push(...Qh(e[i][0],e[i][1],e[i+1][0],e[i+1][1],n));return t&&s.push(...Qh(e[r-1][0],e[r-1][1],e[0][0],e[0][1],n)),{type:"path",ops:s}}return r===2?Xce(e[0][0],e[0][1],e[1][0],e[1][1],n):{type:"path",ops:[]}}function Pot(e,t,n,r,s){return function(i,a){return p2(i,!0,a)}([[e,t],[e+n,t],[e+n,t+r],[e,t+r]],s)}function qW(e,t){if(e.length){const n=typeof e[0][0]=="number"?[e]:e,r=LC(n[0],1*(1+.2*t.roughness),t),s=t.disableMultiStroke?[]:LC(n[0],1.5*(1+.22*t.roughness),HW(t));for(let i=1;i<n.length;i++){const a=n[i];if(a.length){const o=LC(a,1*(1+.2*t.roughness),t),l=t.disableMultiStroke?[]:LC(a,1.5*(1+.22*t.roughness),HW(t));for(const c of o)c.op!=="move"&&r.push(c);for(const c of l)c.op!=="move"&&s.push(c)}}return{type:"path",ops:r.concat(s)}}return{type:"path",ops:[]}}function Jce(e,t,n){const r=Math.sqrt(2*Math.PI*Math.sqrt((Math.pow(e/2,2)+Math.pow(t/2,2))/2)),s=Math.ceil(Math.max(n.curveStepCount,n.curveStepCount/Math.sqrt(200)*r)),i=2*Math.PI/s;let a=Math.abs(e/2),o=Math.abs(t/2);const l=1-n.curveFitting;return a+=rr(a*l,n),o+=rr(o*l,n),{increment:i,rx:a,ry:o}}function D4(e,t,n,r){const[s,i]=GW(r.increment,e,t,r.rx,r.ry,1,r.increment*xE(.1,xE(.4,1,n),n),n);let a=wE(s,null,n);if(!n.disableMultiStroke&&n.roughness!==0){const[o]=GW(r.increment,e,t,r.rx,r.ry,1.5,0,n),l=wE(o,null,n);a=a.concat(l)}return{estimatedPoints:i,opset:{type:"path",ops:a}}}function VW(e,t,n,r,s,i,a,o,l){const c=e,u=t;let d=Math.abs(n/2),h=Math.abs(r/2);d+=rr(.01*d,l),h+=rr(.01*h,l);let m=s,y=i;for(;m<0;)m+=2*Math.PI,y+=2*Math.PI;y-m>2*Math.PI&&(m=0,y=2*Math.PI);const b=2*Math.PI/l.curveStepCount,v=Math.min(b/2,(y-m)/2),x=KW(v,c,u,d,h,m,y,1,l);if(!l.disableMultiStroke){const w=KW(v,c,u,d,h,m,y,1.5,l);x.push(...w)}return a&&(o?x.push(...Qh(c,u,c+d*Math.cos(m),u+h*Math.sin(m),l),...Qh(c,u,c+d*Math.cos(y),u+h*Math.sin(y),l)):x.push({op:"lineTo",data:[c,u]},{op:"lineTo",data:[c+d*Math.cos(m),u+h*Math.sin(m)]})),{type:"path",ops:x}}function WW(e,t){const n=Yce(Kce(k5(e))),r=[];let s=[0,0],i=[0,0];for(const{key:a,data:o}of n)switch(a){case"M":i=[o[0],o[1]],s=[o[0],o[1]];break;case"L":r.push(...Qh(i[0],i[1],o[0],o[1],t)),i=[o[0],o[1]];break;case"C":{const[l,c,u,d,h,m]=o;r.push(...Oot(l,c,u,d,h,m,i,t)),i=[h,m];break}case"Z":r.push(...Qh(i[0],i[1],s[0],s[1],t)),i=[s[0],s[1]]}return{type:"path",ops:r}}function Zj(e,t){const n=[];for(const r of e)if(r.length){const s=t.maxRandomnessOffset||0,i=r.length;if(i>2){n.push({op:"move",data:[r[0][0]+rr(s,t),r[0][1]+rr(s,t)]});for(let a=1;a<i;a++)n.push({op:"lineTo",data:[r[a][0]+rr(s,t),r[a][1]+rr(s,t)]})}}return{type:"fillPath",ops:n}}function w0(e,t){return function(n,r){let s=n.fillStyle||"hachure";if(!Oo[s])switch(s){case"zigzag":Oo[s]||(Oo[s]=new Eot(r));break;case"cross-hatch":Oo[s]||(Oo[s]=new Tot(r));break;case"dots":Oo[s]||(Oo[s]=new Aot(r));break;case"dashed":Oo[s]||(Oo[s]=new Rot(r));break;case"zigzag-line":Oo[s]||(Oo[s]=new Not(r));break;default:s="hachure",Oo[s]||(Oo[s]=new C5(r))}return Oo[s]}(t,jot).fillPolygons(e,t)}function HW(e){const t=Object.assign({},e);return t.randomizer=void 0,e.seed&&(t.seed=e.seed+1),t}function Qce(e){return e.randomizer||(e.randomizer=new Iot(e.seed||0)),e.randomizer.next()}function xE(e,t,n,r=1){return n.roughness*r*(Qce(n)*(t-e)+e)}function rr(e,t,n=1){return xE(-e,e,t,n)}function Qh(e,t,n,r,s,i=!1){const a=i?s.disableMultiStrokeFill:s.disableMultiStroke,o=F4(e,t,n,r,s,!0,!1);if(a)return o;const l=F4(e,t,n,r,s,!0,!0);return o.concat(l)}function F4(e,t,n,r,s,i,a){const o=Math.pow(e-n,2)+Math.pow(t-r,2),l=Math.sqrt(o);let c=1;c=l<200?1:l>500?.4:-.0016668*l+1.233334;let u=s.maxRandomnessOffset||0;u*u*100>o&&(u=l/10);const d=u/2,h=.2+.2*Qce(s);let m=s.bowing*s.maxRandomnessOffset*(r-t)/200,y=s.bowing*s.maxRandomnessOffset*(e-n)/200;m=rr(m,s,c),y=rr(y,s,c);const b=[],v=()=>rr(d,s,c),x=()=>rr(u,s,c),w=s.preserveVertices;return a?b.push({op:"move",data:[e+(w?0:v()),t+(w?0:v())]}):b.push({op:"move",data:[e+(w?0:rr(u,s,c)),t+(w?0:rr(u,s,c))]}),a?b.push({op:"bcurveTo",data:[m+e+(n-e)*h+v(),y+t+(r-t)*h+v(),m+e+2*(n-e)*h+v(),y+t+2*(r-t)*h+v(),n+(w?0:v()),r+(w?0:v())]}):b.push({op:"bcurveTo",data:[m+e+(n-e)*h+x(),y+t+(r-t)*h+x(),m+e+2*(n-e)*h+x(),y+t+2*(r-t)*h+x(),n+(w?0:x()),r+(w?0:x())]}),b}function LC(e,t,n){if(!e.length)return[];const r=[];r.push([e[0][0]+rr(t,n),e[0][1]+rr(t,n)]),r.push([e[0][0]+rr(t,n),e[0][1]+rr(t,n)]);for(let s=1;s<e.length;s++)r.push([e[s][0]+rr(t,n),e[s][1]+rr(t,n)]),s===e.length-1&&r.push([e[s][0]+rr(t,n),e[s][1]+rr(t,n)]);return wE(r,null,n)}function wE(e,t,n){const r=e.length,s=[];if(r>3){const i=[],a=1-n.curveTightness;s.push({op:"move",data:[e[1][0],e[1][1]]});for(let o=1;o+2<r;o++){const l=e[o];i[0]=[l[0],l[1]],i[1]=[l[0]+(a*e[o+1][0]-a*e[o-1][0])/6,l[1]+(a*e[o+1][1]-a*e[o-1][1])/6],i[2]=[e[o+1][0]+(a*e[o][0]-a*e[o+2][0])/6,e[o+1][1]+(a*e[o][1]-a*e[o+2][1])/6],i[3]=[e[o+1][0],e[o+1][1]],s.push({op:"bcurveTo",data:[i[1][0],i[1][1],i[2][0],i[2][1],i[3][0],i[3][1]]})}}else r===3?(s.push({op:"move",data:[e[1][0],e[1][1]]}),s.push({op:"bcurveTo",data:[e[1][0],e[1][1],e[2][0],e[2][1],e[2][0],e[2][1]]})):r===2&&s.push(...F4(e[0][0],e[0][1],e[1][0],e[1][1],n,!0,!0));return s}function GW(e,t,n,r,s,i,a,o){const l=[],c=[];if(o.roughness===0){e/=4,c.push([t+r*Math.cos(-e),n+s*Math.sin(-e)]);for(let u=0;u<=2*Math.PI;u+=e){const d=[t+r*Math.cos(u),n+s*Math.sin(u)];l.push(d),c.push(d)}c.push([t+r*Math.cos(0),n+s*Math.sin(0)]),c.push([t+r*Math.cos(e),n+s*Math.sin(e)])}else{const u=rr(.5,o)-Math.PI/2;c.push([rr(i,o)+t+.9*r*Math.cos(u-e),rr(i,o)+n+.9*s*Math.sin(u-e)]);const d=2*Math.PI+u-.01;for(let h=u;h<d;h+=e){const m=[rr(i,o)+t+r*Math.cos(h),rr(i,o)+n+s*Math.sin(h)];l.push(m),c.push(m)}c.push([rr(i,o)+t+r*Math.cos(u+2*Math.PI+.5*a),rr(i,o)+n+s*Math.sin(u+2*Math.PI+.5*a)]),c.push([rr(i,o)+t+.98*r*Math.cos(u+a),rr(i,o)+n+.98*s*Math.sin(u+a)]),c.push([rr(i,o)+t+.9*r*Math.cos(u+.5*a),rr(i,o)+n+.9*s*Math.sin(u+.5*a)])}return[c,l]}function KW(e,t,n,r,s,i,a,o,l){const c=i+rr(.1,l),u=[];u.push([rr(o,l)+t+.9*r*Math.cos(c-e),rr(o,l)+n+.9*s*Math.sin(c-e)]);for(let d=c;d<=a;d+=e)u.push([rr(o,l)+t+r*Math.cos(d),rr(o,l)+n+s*Math.sin(d)]);return u.push([t+r*Math.cos(a),n+s*Math.sin(a)]),u.push([t+r*Math.cos(a),n+s*Math.sin(a)]),wE(u,null,l)}function Oot(e,t,n,r,s,i,a,o){const l=[],c=[o.maxRandomnessOffset||1,(o.maxRandomnessOffset||1)+.3];let u=[0,0];const d=o.disableMultiStroke?1:2,h=o.preserveVertices;for(let m=0;m<d;m++)m===0?l.push({op:"move",data:[a[0],a[1]]}):l.push({op:"move",data:[a[0]+(h?0:rr(c[0],o)),a[1]+(h?0:rr(c[0],o))]}),u=h?[s,i]:[s+rr(c[m],o),i+rr(c[m],o)],l.push({op:"bcurveTo",data:[e+rr(c[m],o),t+rr(c[m],o),n+rr(c[m],o),r+rr(c[m],o),u[0],u[1]]});return l}function dx(e){return[...e]}function YW(e,t=0){const n=e.length;if(n<3)throw new Error("A curve must have at least three points.");const r=[];if(n===3)r.push(dx(e[0]),dx(e[1]),dx(e[2]),dx(e[2]));else{const s=[];s.push(e[0],e[0]);for(let o=1;o<e.length;o++)s.push(e[o]),o===e.length-1&&s.push(e[o]);const i=[],a=1-t;r.push(dx(s[0]));for(let o=1;o+2<s.length;o++){const l=s[o];i[0]=[l[0],l[1]],i[1]=[l[0]+(a*s[o+1][0]-a*s[o-1][0])/6,l[1]+(a*s[o+1][1]-a*s[o-1][1])/6],i[2]=[s[o+1][0]+(a*s[o][0]-a*s[o+2][0])/6,s[o+1][1]+(a*s[o][1]-a*s[o+2][1])/6],i[3]=[s[o+1][0],s[o+1][1]],r.push(i[1],i[2],i[3])}}return r}function m2(e,t){return Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2)}function Dot(e,t,n){const r=m2(t,n);if(r===0)return m2(e,t);let s=((e[0]-t[0])*(n[0]-t[0])+(e[1]-t[1])*(n[1]-t[1]))/r;return s=Math.max(0,Math.min(1,s)),m2(e,rm(t,n,s))}function rm(e,t,n){return[e[0]+(t[0]-e[0])*n,e[1]+(t[1]-e[1])*n]}function L4(e,t,n,r){const s=r||[];if(function(o,l){const c=o[l+0],u=o[l+1],d=o[l+2],h=o[l+3];let m=3*u[0]-2*c[0]-h[0];m*=m;let y=3*u[1]-2*c[1]-h[1];y*=y;let b=3*d[0]-2*h[0]-c[0];b*=b;let v=3*d[1]-2*h[1]-c[1];return v*=v,m<b&&(m=b),y<v&&(y=v),m+y}(e,t)<n){const o=e[t+0];s.length?(i=s[s.length-1],a=o,Math.sqrt(m2(i,a))>1&&s.push(o)):s.push(o),s.push(e[t+3])}else{const l=e[t+0],c=e[t+1],u=e[t+2],d=e[t+3],h=rm(l,c,.5),m=rm(c,u,.5),y=rm(u,d,.5),b=rm(h,m,.5),v=rm(m,y,.5),x=rm(b,v,.5);L4([l,h,b,x],0,n,s),L4([x,v,y,d],0,n,s)}var i,a;return s}function Fot(e,t){return SE(e,0,e.length,t)}function SE(e,t,n,r,s){const i=s||[],a=e[t],o=e[n-1];let l=0,c=1;for(let u=t+1;u<n-1;++u){const d=Dot(e[u],a,o);d>l&&(l=d,c=u)}return Math.sqrt(l)>r?(SE(e,t,c+1,r,i),SE(e,c,n,r,i)):(i.length||i.push(a),i.push(o)),i}function Xj(e,t=.15,n){const r=[],s=(e.length-1)/3;for(let i=0;i<s;i++)L4(e,3*i,t,r);return n&&n>0?SE(r,0,r.length,n):r}const dl="none";class _E{constructor(t){this.defaultOptions={maxRandomnessOffset:2,roughness:1,bowing:1,stroke:"#000",strokeWidth:1,curveTightness:0,curveFitting:.95,curveStepCount:9,fillStyle:"hachure",fillWeight:-1,hachureAngle:-41,hachureGap:-1,dashOffset:-1,dashGap:-1,zigzagOffset:-1,seed:0,disableMultiStroke:!1,disableMultiStrokeFill:!1,preserveVertices:!1,fillShapeRoughnessGain:.8},this.config=t||{},this.config.options&&(this.defaultOptions=this._o(this.config.options))}static newSeed(){return Math.floor(Math.random()*2**31)}_o(t){return t?Object.assign({},this.defaultOptions,t):this.defaultOptions}_d(t,n,r){return{shape:t,sets:n||[],options:r||this.defaultOptions}}line(t,n,r,s,i){const a=this._o(i);return this._d("line",[Xce(t,n,r,s,a)],a)}rectangle(t,n,r,s,i){const a=this._o(i),o=[],l=Pot(t,n,r,s,a);if(a.fill){const c=[[t,n],[t+r,n],[t+r,n+s],[t,n+s]];a.fillStyle==="solid"?o.push(Zj([c],a)):o.push(w0([c],a))}return a.stroke!==dl&&o.push(l),this._d("rectangle",o,a)}ellipse(t,n,r,s,i){const a=this._o(i),o=[],l=Jce(r,s,a),c=D4(t,n,a,l);if(a.fill)if(a.fillStyle==="solid"){const u=D4(t,n,a,l).opset;u.type="fillPath",o.push(u)}else o.push(w0([c.estimatedPoints],a));return a.stroke!==dl&&o.push(c.opset),this._d("ellipse",o,a)}circle(t,n,r,s){const i=this.ellipse(t,n,r,r,s);return i.shape="circle",i}linearPath(t,n){const r=this._o(n);return this._d("linearPath",[p2(t,!1,r)],r)}arc(t,n,r,s,i,a,o=!1,l){const c=this._o(l),u=[],d=VW(t,n,r,s,i,a,o,!0,c);if(o&&c.fill)if(c.fillStyle==="solid"){const h=Object.assign({},c);h.disableMultiStroke=!0;const m=VW(t,n,r,s,i,a,!0,!1,h);m.type="fillPath",u.push(m)}else u.push(function(h,m,y,b,v,x,w){const _=h,k=m;let C=Math.abs(y/2),T=Math.abs(b/2);C+=rr(.01*C,w),T+=rr(.01*T,w);let A=v,N=x;for(;A<0;)A+=2*Math.PI,N+=2*Math.PI;N-A>2*Math.PI&&(A=0,N=2*Math.PI);const I=(N-A)/w.curveStepCount,j=[];for(let L=A;L<=N;L+=I)j.push([_+C*Math.cos(L),k+T*Math.sin(L)]);return j.push([_+C*Math.cos(N),k+T*Math.sin(N)]),j.push([_,k]),w0([j],w)}(t,n,r,s,i,a,c));return c.stroke!==dl&&u.push(d),this._d("arc",u,c)}curve(t,n){const r=this._o(n),s=[],i=qW(t,r);if(r.fill&&r.fill!==dl)if(r.fillStyle==="solid"){const a=qW(t,Object.assign(Object.assign({},r),{disableMultiStroke:!0,roughness:r.roughness?r.roughness+r.fillShapeRoughnessGain:0}));s.push({type:"fillPath",ops:this._mergedShape(a.ops)})}else{const a=[],o=t;if(o.length){const l=typeof o[0][0]=="number"?[o]:o;for(const c of l)c.length<3?a.push(...c):c.length===3?a.push(...Xj(YW([c[0],c[0],c[1],c[2]]),10,(1+r.roughness)/2)):a.push(...Xj(YW(c),10,(1+r.roughness)/2))}a.length&&s.push(w0([a],r))}return r.stroke!==dl&&s.push(i),this._d("curve",s,r)}polygon(t,n){const r=this._o(n),s=[],i=p2(t,!0,r);return r.fill&&(r.fillStyle==="solid"?s.push(Zj([t],r)):s.push(w0([t],r))),r.stroke!==dl&&s.push(i),this._d("polygon",s,r)}path(t,n){const r=this._o(n),s=[];if(!t)return this._d("path",s,r);t=(t||"").replace(/\n/g," ").replace(/(-\s)/g,"-").replace("/(ss)/g"," ");const i=r.fill&&r.fill!=="transparent"&&r.fill!==dl,a=r.stroke!==dl,o=!!(r.simplification&&r.simplification<1),l=function(u,d,h){const m=Yce(Kce(k5(u))),y=[];let b=[],v=[0,0],x=[];const w=()=>{x.length>=4&&b.push(...Xj(x,d)),x=[]},_=()=>{w(),b.length&&(y.push(b),b=[])};for(const{key:C,data:T}of m)switch(C){case"M":_(),v=[T[0],T[1]],b.push(v);break;case"L":w(),b.push([T[0],T[1]]);break;case"C":if(!x.length){const A=b.length?b[b.length-1]:v;x.push([A[0],A[1]])}x.push([T[0],T[1]]),x.push([T[2],T[3]]),x.push([T[4],T[5]]);break;case"Z":w(),b.push([v[0],v[1]])}if(_(),!h)return y;const k=[];for(const C of y){const T=Fot(C,h);T.length&&k.push(T)}return k}(t,1,o?4-4*(r.simplification||1):(1+r.roughness)/2),c=WW(t,r);if(i)if(r.fillStyle==="solid")if(l.length===1){const u=WW(t,Object.assign(Object.assign({},r),{disableMultiStroke:!0,roughness:r.roughness?r.roughness+r.fillShapeRoughnessGain:0}));s.push({type:"fillPath",ops:this._mergedShape(u.ops)})}else s.push(Zj(l,r));else s.push(w0(l,r));return a&&(o?l.forEach(u=>{s.push(p2(u,!1,r))}):s.push(c)),this._d("path",s,r)}opsToPath(t,n){let r="";for(const s of t.ops){const i=typeof n=="number"&&n>=0?s.data.map(a=>+a.toFixed(n)):s.data;switch(s.op){case"move":r+=`M${i[0]} ${i[1]} `;break;case"bcurveTo":r+=`C${i[0]} ${i[1]}, ${i[2]} ${i[3]}, ${i[4]} ${i[5]} `;break;case"lineTo":r+=`L${i[0]} ${i[1]} `}}return r.trim()}toPaths(t){const n=t.sets||[],r=t.options||this.defaultOptions,s=[];for(const i of n){let a=null;switch(i.type){case"path":a={d:this.opsToPath(i),stroke:r.stroke,strokeWidth:r.strokeWidth,fill:dl};break;case"fillPath":a={d:this.opsToPath(i),stroke:dl,strokeWidth:0,fill:r.fill||dl};break;case"fillSketch":a=this.fillSketch(i,r)}a&&s.push(a)}return s}fillSketch(t,n){let r=n.fillWeight;return r<0&&(r=n.strokeWidth/2),{d:this.opsToPath(t),stroke:n.fill||dl,strokeWidth:r,fill:dl}}_mergedShape(t){return t.filter((n,r)=>r===0||n.op!=="move")}}class Lot{constructor(t,n){this.canvas=t,this.ctx=this.canvas.getContext("2d"),this.gen=new _E(n)}draw(t){const n=t.sets||[],r=t.options||this.getDefaultOptions(),s=this.ctx,i=t.options.fixedDecimalPlaceDigits;for(const a of n)switch(a.type){case"path":s.save(),s.strokeStyle=r.stroke==="none"?"transparent":r.stroke,s.lineWidth=r.strokeWidth,r.strokeLineDash&&s.setLineDash(r.strokeLineDash),r.strokeLineDashOffset&&(s.lineDashOffset=r.strokeLineDashOffset),this._drawToContext(s,a,i),s.restore();break;case"fillPath":{s.save(),s.fillStyle=r.fill||"";const o=t.shape==="curve"||t.shape==="polygon"||t.shape==="path"?"evenodd":"nonzero";this._drawToContext(s,a,i,o),s.restore();break}case"fillSketch":this.fillSketch(s,a,r)}}fillSketch(t,n,r){let s=r.fillWeight;s<0&&(s=r.strokeWidth/2),t.save(),r.fillLineDash&&t.setLineDash(r.fillLineDash),r.fillLineDashOffset&&(t.lineDashOffset=r.fillLineDashOffset),t.strokeStyle=r.fill||"",t.lineWidth=s,this._drawToContext(t,n,r.fixedDecimalPlaceDigits),t.restore()}_drawToContext(t,n,r,s="nonzero"){t.beginPath();for(const i of n.ops){const a=typeof r=="number"&&r>=0?i.data.map(o=>+o.toFixed(r)):i.data;switch(i.op){case"move":t.moveTo(a[0],a[1]);break;case"bcurveTo":t.bezierCurveTo(a[0],a[1],a[2],a[3],a[4],a[5]);break;case"lineTo":t.lineTo(a[0],a[1])}}n.type==="fillPath"?t.fill(s):t.stroke()}get generator(){return this.gen}getDefaultOptions(){return this.gen.defaultOptions}line(t,n,r,s,i){const a=this.gen.line(t,n,r,s,i);return this.draw(a),a}rectangle(t,n,r,s,i){const a=this.gen.rectangle(t,n,r,s,i);return this.draw(a),a}ellipse(t,n,r,s,i){const a=this.gen.ellipse(t,n,r,s,i);return this.draw(a),a}circle(t,n,r,s){const i=this.gen.circle(t,n,r,s);return this.draw(i),i}linearPath(t,n){const r=this.gen.linearPath(t,n);return this.draw(r),r}polygon(t,n){const r=this.gen.polygon(t,n);return this.draw(r),r}arc(t,n,r,s,i,a,o=!1,l){const c=this.gen.arc(t,n,r,s,i,a,o,l);return this.draw(c),c}curve(t,n){const r=this.gen.curve(t,n);return this.draw(r),r}path(t,n){const r=this.gen.path(t,n);return this.draw(r),r}}const BC="http://www.w3.org/2000/svg";class Bot{constructor(t,n){this.svg=t,this.gen=new _E(n)}draw(t){const n=t.sets||[],r=t.options||this.getDefaultOptions(),s=this.svg.ownerDocument||window.document,i=s.createElementNS(BC,"g"),a=t.options.fixedDecimalPlaceDigits;for(const o of n){let l=null;switch(o.type){case"path":l=s.createElementNS(BC,"path"),l.setAttribute("d",this.opsToPath(o,a)),l.setAttribute("stroke",r.stroke),l.setAttribute("stroke-width",r.strokeWidth+""),l.setAttribute("fill","none"),r.strokeLineDash&&l.setAttribute("stroke-dasharray",r.strokeLineDash.join(" ").trim()),r.strokeLineDashOffset&&l.setAttribute("stroke-dashoffset",`${r.strokeLineDashOffset}`);break;case"fillPath":l=s.createElementNS(BC,"path"),l.setAttribute("d",this.opsToPath(o,a)),l.setAttribute("stroke","none"),l.setAttribute("stroke-width","0"),l.setAttribute("fill",r.fill||""),t.shape!=="curve"&&t.shape!=="polygon"||l.setAttribute("fill-rule","evenodd");break;case"fillSketch":l=this.fillSketch(s,o,r)}l&&i.appendChild(l)}return i}fillSketch(t,n,r){let s=r.fillWeight;s<0&&(s=r.strokeWidth/2);const i=t.createElementNS(BC,"path");return i.setAttribute("d",this.opsToPath(n,r.fixedDecimalPlaceDigits)),i.setAttribute("stroke",r.fill||""),i.setAttribute("stroke-width",s+""),i.setAttribute("fill","none"),r.fillLineDash&&i.setAttribute("stroke-dasharray",r.fillLineDash.join(" ").trim()),r.fillLineDashOffset&&i.setAttribute("stroke-dashoffset",`${r.fillLineDashOffset}`),i}get generator(){return this.gen}getDefaultOptions(){return this.gen.defaultOptions}opsToPath(t,n){return this.gen.opsToPath(t,n)}line(t,n,r,s,i){const a=this.gen.line(t,n,r,s,i);return this.draw(a)}rectangle(t,n,r,s,i){const a=this.gen.rectangle(t,n,r,s,i);return this.draw(a)}ellipse(t,n,r,s,i){const a=this.gen.ellipse(t,n,r,s,i);return this.draw(a)}circle(t,n,r,s){const i=this.gen.circle(t,n,r,s);return this.draw(i)}linearPath(t,n){const r=this.gen.linearPath(t,n);return this.draw(r)}polygon(t,n){const r=this.gen.polygon(t,n);return this.draw(r)}arc(t,n,r,s,i,a,o=!1,l){const c=this.gen.arc(t,n,r,s,i,a,o,l);return this.draw(c)}curve(t,n){const r=this.gen.curve(t,n);return this.draw(r)}path(t,n){const r=this.gen.path(t,n);return this.draw(r)}}var Rn={canvas:(e,t)=>new Lot(e,t),svg:(e,t)=>new Bot(e,t),generator:e=>new _E(e),newSeed:()=>_E.newSeed()},hr=ie(async(e,t,n)=>{var d,h;let r;const s=t.useHtmlLabels||Qi((d=ls())==null?void 0:d.htmlLabels);n?r=n:r="node default";const i=e.insert("g").attr("class",r).attr("id",t.domId||t.id),a=i.insert("g").attr("class","label").attr("style",yo(t.labelStyle));let o;t.label===void 0?o="":o=typeof t.label=="string"?t.label:t.label[0];const l=await Sp(a,qm(yg(o),ls()),{useHtmlLabels:s,width:t.width||((h=ls().flowchart)==null?void 0:h.wrappingWidth),cssClasses:"markdown-node-label",style:t.labelStyle,addSvgBackground:!!t.icon||!!t.img});let c=l.getBBox();const u=((t==null?void 0:t.padding)??0)/2;if(s){const m=l.children[0],y=Zr(l),b=m.getElementsByTagName("img");if(b){const v=o.replace(/<img[^>]*>/g,"").trim()==="";await Promise.all([...b].map(x=>new Promise(w=>{function _(){if(x.style.display="flex",x.style.flexDirection="column",v){const k=ls().fontSize?ls().fontSize:window.getComputedStyle(document.body).fontSize,C=5,[T=mae.fontSize]=CA(k),A=T*C+"px";x.style.minWidth=A,x.style.maxWidth=A}else x.style.width="100%";w(x)}ie(_,"setupImage"),setTimeout(()=>{x.complete&&_()}),x.addEventListener("error",_),x.addEventListener("load",_)})))}c=m.getBoundingClientRect(),y.attr("width",c.width),y.attr("height",c.height)}return s?a.attr("transform","translate("+-c.width/2+", "+-c.height/2+")"):a.attr("transform","translate(0, "+-c.height/2+")"),t.centerLabel&&a.attr("transform","translate("+-c.width/2+", "+-c.height/2+")"),a.insert("rect",":first-child"),{shapeSvg:i,bbox:c,halfPadding:u,label:a}},"labelHelper"),Jj=ie(async(e,t,n)=>{var l,c,u,d,h,m;const r=n.useHtmlLabels||Qi((c=(l=ls())==null?void 0:l.flowchart)==null?void 0:c.htmlLabels),s=e.insert("g").attr("class","label").attr("style",n.labelStyle||""),i=await Sp(s,qm(yg(t),ls()),{useHtmlLabels:r,width:n.width||((d=(u=ls())==null?void 0:u.flowchart)==null?void 0:d.wrappingWidth),style:n.labelStyle,addSvgBackground:!!n.icon||!!n.img});let a=i.getBBox();const o=n.padding/2;if(Qi((m=(h=ls())==null?void 0:h.flowchart)==null?void 0:m.htmlLabels)){const y=i.children[0],b=Zr(i);a=y.getBoundingClientRect(),b.attr("width",a.width),b.attr("height",a.height)}return r?s.attr("transform","translate("+-a.width/2+", "+-a.height/2+")"):s.attr("transform","translate(0, "+-a.height/2+")"),n.centerLabel&&s.attr("transform","translate("+-a.width/2+", "+-a.height/2+")"),s.insert("rect",":first-child"),{shapeSvg:e,bbox:a,halfPadding:o,label:s}},"insertLabel"),Pn=ie((e,t)=>{const n=t.node().getBBox();e.width=n.width,e.height=n.height},"updateNodeBounds"),ir=ie((e,t)=>(e.look==="handDrawn"?"rough-node":"node")+" "+e.cssClasses+" "+(t||""),"getNodeClasses");function Jr(e){const t=e.map((n,r)=>`${r===0?"M":"L"}${n.x},${n.y}`);return t.push("Z"),t.join(" ")}ie(Jr,"createPathFromPoints");function ep(e,t,n,r,s,i){const a=[],l=n-e,c=r-t,u=l/i,d=2*Math.PI/u,h=t+c/2;for(let m=0;m<=50;m++){const y=m/50,b=e+y*l,v=h+s*Math.sin(d*(b-e));a.push({x:b,y:v})}return a}ie(ep,"generateFullSineWavePoints");function E5(e,t,n,r,s,i){const a=[],o=s*Math.PI/180,u=(i*Math.PI/180-o)/(r-1);for(let d=0;d<r;d++){const h=o+d*u,m=e+n*Math.cos(h),y=t+n*Math.sin(h);a.push({x:-m,y:-y})}return a}ie(E5,"generateCirclePoints");var $ot=ie((e,t)=>{var n=e.x,r=e.y,s=t.x-n,i=t.y-r,a=e.width/2,o=e.height/2,l,c;return Math.abs(i)*a>Math.abs(s)*o?(i<0&&(o=-o),l=i===0?0:o*s/i,c=o):(s<0&&(a=-a),l=a,c=s===0?0:a*i/s),{x:n+l,y:r+c}},"intersectRect"),Pb=$ot;function eue(e,t){t&&e.attr("style",t)}ie(eue,"applyStyle");async function tue(e){const t=Zr(document.createElementNS("http://www.w3.org/2000/svg","foreignObject")),n=t.append("xhtml:div");let r=e.label;e.label&&qy(e.label)&&(r=await M6(e.label.replace(Ib.lineBreakRegex,`
`),ls()));const s=e.isNode?"nodeLabel":"edgeLabel";return n.html('<span class="'+s+'" '+(e.labelStyle?'style="'+e.labelStyle+'"':"")+">"+r+"</span>"),eue(n,e.labelStyle),n.style("display","inline-block"),n.style("padding-right","1px"),n.style("white-space","nowrap"),n.attr("xmlns","http://www.w3.org/1999/xhtml"),t.node()}ie(tue,"addHtmlLabel");var zot=ie(async(e,t,n,r)=>{let s=e||"";if(typeof s=="object"&&(s=s[0]),Qi(ls().flowchart.htmlLabels)){s=s.replace(/\\n|\n/g,"<br />"),qt.info("vertexText"+s);const i={isNode:r,label:yg(s).replace(/fa[blrs]?:fa-[\w-]+/g,o=>`<i class='${o.replace(":"," ")}'></i>`),labelStyle:t&&t.replace("fill:","color:")};return await tue(i)}else{const i=document.createElementNS("http://www.w3.org/2000/svg","text");i.setAttribute("style",t.replace("color:","fill:"));let a=[];typeof s=="string"?a=s.split(/\\n|\n|<br\s*\/?>/gi):Array.isArray(s)?a=s:a=[];for(const o of a){const l=document.createElementNS("http://www.w3.org/2000/svg","tspan");l.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),l.setAttribute("dy","1em"),l.setAttribute("x","0"),n?l.setAttribute("class","title-row"):l.setAttribute("class","row"),l.textContent=o.trim(),i.appendChild(l)}return i}},"createLabel"),vm=zot,kf=ie((e,t,n,r,s)=>["M",e+s,t,"H",e+n-s,"A",s,s,0,0,1,e+n,t+s,"V",t+r-s,"A",s,s,0,0,1,e+n-s,t+r,"H",e+s,"A",s,s,0,0,1,e,t+r-s,"V",t+s,"A",s,s,0,0,1,e+s,t,"Z"].join(" "),"createRoundedRectPathD"),Uot=ie(e=>{const{handDrawnSeed:t}=ls();return{fill:e,hachureAngle:120,hachureGap:4,fillWeight:2,roughness:.7,stroke:e,seed:t}},"solidStateFill"),Ob=ie(e=>{const t=qot([...e.cssCompiledStyles||[],...e.cssStyles||[]]);return{stylesMap:t,stylesArray:[...t]}},"compileStyles"),qot=ie(e=>{const t=new Map;return e.forEach(n=>{const[r,s]=n.split(":");t.set(r.trim(),s==null?void 0:s.trim())}),t},"styles2Map"),nue=ie(e=>e==="color"||e==="font-size"||e==="font-family"||e==="font-weight"||e==="font-style"||e==="text-decoration"||e==="text-align"||e==="text-transform"||e==="line-height"||e==="letter-spacing"||e==="word-spacing"||e==="text-shadow"||e==="text-overflow"||e==="white-space"||e==="word-wrap"||e==="word-break"||e==="overflow-wrap"||e==="hyphens","isLabelStyle"),On=ie(e=>{const{stylesArray:t}=Ob(e),n=[],r=[],s=[],i=[];return t.forEach(a=>{const o=a[0];nue(o)?n.push(a.join(":")+" !important"):(r.push(a.join(":")+" !important"),o.includes("stroke")&&s.push(a.join(":")+" !important"),o==="fill"&&i.push(a.join(":")+" !important"))}),{labelStyles:n.join(";"),nodeStyles:r.join(";"),stylesArray:t,borderStyles:s,backgroundStyles:i}},"styles2String"),In=ie((e,t)=>{var l;const{themeVariables:n,handDrawnSeed:r}=ls(),{nodeBorder:s,mainBkg:i}=n,{stylesMap:a}=Ob(e);return Object.assign({roughness:.7,fill:a.get("fill")||i,fillStyle:"hachure",fillWeight:4,hachureGap:5.2,stroke:a.get("stroke")||s,seed:r,strokeWidth:((l=a.get("stroke-width"))==null?void 0:l.replace("px",""))||1.3,fillLineDash:[0,0]},t)},"userNodeOverrides"),rue=ie(async(e,t)=>{qt.info("Creating subgraph rect for ",t.id,t);const n=ls(),{themeVariables:r,handDrawnSeed:s}=n,{clusterBkg:i,clusterBorder:a}=r,{labelStyles:o,nodeStyles:l,borderStyles:c,backgroundStyles:u}=On(t),d=e.insert("g").attr("class","cluster "+t.cssClasses).attr("id",t.id).attr("data-look",t.look),h=Qi(n.flowchart.htmlLabels),m=d.insert("g").attr("class","cluster-label "),y=await Sp(m,t.label,{style:t.labelStyle,useHtmlLabels:h,isNode:!0});let b=y.getBBox();if(Qi(n.flowchart.htmlLabels)){const A=y.children[0],N=Zr(y);b=A.getBoundingClientRect(),N.attr("width",b.width),N.attr("height",b.height)}const v=t.width<=b.width+t.padding?b.width+t.padding:t.width;t.width<=b.width+t.padding?t.diff=(v-t.width)/2-t.padding:t.diff=-t.padding;const x=t.height,w=t.x-v/2,_=t.y-x/2;qt.trace("Data ",t,JSON.stringify(t));let k;if(t.look==="handDrawn"){const A=Rn.svg(d),N=In(t,{roughness:.7,fill:i,stroke:a,fillWeight:3,seed:s}),I=A.path(kf(w,_,v,x,0),N);k=d.insert(()=>(qt.debug("Rough node insert CXC",I),I),":first-child"),k.select("path:nth-child(2)").attr("style",c.join(";")),k.select("path").attr("style",u.join(";").replace("fill","stroke"))}else k=d.insert("rect",":first-child"),k.attr("style",l).attr("rx",t.rx).attr("ry",t.ry).attr("x",w).attr("y",_).attr("width",v).attr("height",x);const{subGraphTitleTopMargin:C}=W6(n);if(m.attr("transform",`translate(${t.x-b.width/2}, ${t.y-t.height/2+C})`),o){const A=m.select("span");A&&A.attr("style",o)}const T=k.node().getBBox();return t.offsetX=0,t.width=T.width,t.height=T.height,t.offsetY=b.height-t.padding/2,t.intersect=function(A){return Pb(t,A)},{cluster:d,labelBBox:b}},"rect"),Vot=ie((e,t)=>{const n=e.insert("g").attr("class","note-cluster").attr("id",t.id),r=n.insert("rect",":first-child"),s=0*t.padding,i=s/2;r.attr("rx",t.rx).attr("ry",t.ry).attr("x",t.x-t.width/2-i).attr("y",t.y-t.height/2-i).attr("width",t.width+s).attr("height",t.height+s).attr("fill","none");const a=r.node().getBBox();return t.width=a.width,t.height=a.height,t.intersect=function(o){return Pb(t,o)},{cluster:n,labelBBox:{width:0,height:0}}},"noteGroup"),Wot=ie(async(e,t)=>{const n=ls(),{themeVariables:r,handDrawnSeed:s}=n,{altBackground:i,compositeBackground:a,compositeTitleBackground:o,nodeBorder:l}=r,c=e.insert("g").attr("class",t.cssClasses).attr("id",t.id).attr("data-id",t.id).attr("data-look",t.look),u=c.insert("g",":first-child"),d=c.insert("g").attr("class","cluster-label");let h=c.append("rect");const m=d.node().appendChild(await vm(t.label,t.labelStyle,void 0,!0));let y=m.getBBox();if(Qi(n.flowchart.htmlLabels)){const I=m.children[0],j=Zr(m);y=I.getBoundingClientRect(),j.attr("width",y.width),j.attr("height",y.height)}const b=0*t.padding,v=b/2,x=(t.width<=y.width+t.padding?y.width+t.padding:t.width)+b;t.width<=y.width+t.padding?t.diff=(x-t.width)/2-t.padding:t.diff=-t.padding;const w=t.height+b,_=t.height+b-y.height-6,k=t.x-x/2,C=t.y-w/2;t.width=x;const T=t.y-t.height/2-v+y.height+2;let A;if(t.look==="handDrawn"){const I=t.cssClasses.includes("statediagram-cluster-alt"),j=Rn.svg(c),L=t.rx||t.ry?j.path(kf(k,C,x,w,10),{roughness:.7,fill:o,fillStyle:"solid",stroke:l,seed:s}):j.rectangle(k,C,x,w,{seed:s});A=c.insert(()=>L,":first-child");const D=j.rectangle(k,T,x,_,{fill:I?i:a,fillStyle:I?"hachure":"solid",stroke:l,seed:s});A=c.insert(()=>L,":first-child"),h=c.insert(()=>D)}else A=u.insert("rect",":first-child"),A.attr("class","outer").attr("x",k).attr("y",C).attr("width",x).attr("height",w).attr("data-look",t.look),h.attr("class","inner").attr("x",k).attr("y",T).attr("width",x).attr("height",_);d.attr("transform",`translate(${t.x-y.width/2}, ${C+1-(Qi(n.flowchart.htmlLabels)?0:3)})`);const N=A.node().getBBox();return t.height=N.height,t.offsetX=0,t.offsetY=y.height-t.padding/2,t.labelBBox=y,t.intersect=function(I){return Pb(t,I)},{cluster:c,labelBBox:y}},"roundedWithTitle"),Hot=ie(async(e,t)=>{qt.info("Creating subgraph rect for ",t.id,t);const n=ls(),{themeVariables:r,handDrawnSeed:s}=n,{clusterBkg:i,clusterBorder:a}=r,{labelStyles:o,nodeStyles:l,borderStyles:c,backgroundStyles:u}=On(t),d=e.insert("g").attr("class","cluster "+t.cssClasses).attr("id",t.id).attr("data-look",t.look),h=Qi(n.flowchart.htmlLabels),m=d.insert("g").attr("class","cluster-label "),y=await Sp(m,t.label,{style:t.labelStyle,useHtmlLabels:h,isNode:!0,width:t.width});let b=y.getBBox();if(Qi(n.flowchart.htmlLabels)){const A=y.children[0],N=Zr(y);b=A.getBoundingClientRect(),N.attr("width",b.width),N.attr("height",b.height)}const v=t.width<=b.width+t.padding?b.width+t.padding:t.width;t.width<=b.width+t.padding?t.diff=(v-t.width)/2-t.padding:t.diff=-t.padding;const x=t.height,w=t.x-v/2,_=t.y-x/2;qt.trace("Data ",t,JSON.stringify(t));let k;if(t.look==="handDrawn"){const A=Rn.svg(d),N=In(t,{roughness:.7,fill:i,stroke:a,fillWeight:4,seed:s}),I=A.path(kf(w,_,v,x,t.rx),N);k=d.insert(()=>(qt.debug("Rough node insert CXC",I),I),":first-child"),k.select("path:nth-child(2)").attr("style",c.join(";")),k.select("path").attr("style",u.join(";").replace("fill","stroke"))}else k=d.insert("rect",":first-child"),k.attr("style",l).attr("rx",t.rx).attr("ry",t.ry).attr("x",w).attr("y",_).attr("width",v).attr("height",x);const{subGraphTitleTopMargin:C}=W6(n);if(m.attr("transform",`translate(${t.x-b.width/2}, ${t.y-t.height/2+C})`),o){const A=m.select("span");A&&A.attr("style",o)}const T=k.node().getBBox();return t.offsetX=0,t.width=T.width,t.height=T.height,t.offsetY=b.height-t.padding/2,t.intersect=function(A){return Pb(t,A)},{cluster:d,labelBBox:b}},"kanbanSection"),Got=ie((e,t)=>{const n=ls(),{themeVariables:r,handDrawnSeed:s}=n,{nodeBorder:i}=r,a=e.insert("g").attr("class",t.cssClasses).attr("id",t.id).attr("data-look",t.look),o=a.insert("g",":first-child"),l=0*t.padding,c=t.width+l;t.diff=-t.padding;const u=t.height+l,d=t.x-c/2,h=t.y-u/2;t.width=c;let m;if(t.look==="handDrawn"){const v=Rn.svg(a).rectangle(d,h,c,u,{fill:"lightgrey",roughness:.5,strokeLineDash:[5],stroke:i,seed:s});m=a.insert(()=>v,":first-child")}else m=o.insert("rect",":first-child"),m.attr("class","divider").attr("x",d).attr("y",h).attr("width",c).attr("height",u).attr("data-look",t.look);const y=m.node().getBBox();return t.height=y.height,t.offsetX=0,t.offsetY=0,t.intersect=function(b){return Pb(t,b)},{cluster:a,labelBBox:{}}},"divider"),Kot=rue,Yot={rect:rue,squareRect:Kot,roundedWithTitle:Wot,noteGroup:Vot,divider:Got,kanbanSection:Hot},sue=new Map,Zot=ie(async(e,t)=>{const n=t.shape||"rect",r=await Yot[n](e,t);return sue.set(t.id,r),r},"insertCluster"),oht=ie(()=>{sue=new Map},"clear");function iue(e,t){return e.intersect(t)}ie(iue,"intersectNode");var Xot=iue;function aue(e,t,n,r){var s=e.x,i=e.y,a=s-r.x,o=i-r.y,l=Math.sqrt(t*t*o*o+n*n*a*a),c=Math.abs(t*n*a/l);r.x<s&&(c=-c);var u=Math.abs(t*n*o/l);return r.y<i&&(u=-u),{x:s+c,y:i+u}}ie(aue,"intersectEllipse");var oue=aue;function lue(e,t,n){return oue(e,t,t,n)}ie(lue,"intersectCircle");var Jot=lue;function cue(e,t,n,r){var s,i,a,o,l,c,u,d,h,m,y,b,v,x,w;if(s=t.y-e.y,a=e.x-t.x,l=t.x*e.y-e.x*t.y,h=s*n.x+a*n.y+l,m=s*r.x+a*r.y+l,!(h!==0&&m!==0&&B4(h,m))&&(i=r.y-n.y,o=n.x-r.x,c=r.x*n.y-n.x*r.y,u=i*e.x+o*e.y+c,d=i*t.x+o*t.y+c,!(u!==0&&d!==0&&B4(u,d))&&(y=s*o-i*a,y!==0)))return b=Math.abs(y/2),v=a*c-o*l,x=v<0?(v-b)/y:(v+b)/y,v=i*l-s*c,w=v<0?(v-b)/y:(v+b)/y,{x,y:w}}ie(cue,"intersectLine");function B4(e,t){return e*t>0}ie(B4,"sameSign");var Qot=cue;function uue(e,t,n){let r=e.x,s=e.y,i=[],a=Number.POSITIVE_INFINITY,o=Number.POSITIVE_INFINITY;typeof t.forEach=="function"?t.forEach(function(u){a=Math.min(a,u.x),o=Math.min(o,u.y)}):(a=Math.min(a,t.x),o=Math.min(o,t.y));let l=r-e.width/2-a,c=s-e.height/2-o;for(let u=0;u<t.length;u++){let d=t[u],h=t[u<t.length-1?u+1:0],m=Qot(e,n,{x:l+d.x,y:c+d.y},{x:l+h.x,y:c+h.y});m&&i.push(m)}return i.length?(i.length>1&&i.sort(function(u,d){let h=u.x-n.x,m=u.y-n.y,y=Math.sqrt(h*h+m*m),b=d.x-n.x,v=d.y-n.y,x=Math.sqrt(b*b+v*v);return y<x?-1:y===x?0:1}),i[0]):e}ie(uue,"intersectPolygon");var elt=uue,En={node:Xot,circle:Jot,ellipse:oue,polygon:elt,rect:Pb};function due(e,t){const{labelStyles:n}=On(t);t.labelStyle=n;const r=ir(t);let s=r;r||(s="anchor");const i=e.insert("g").attr("class",s).attr("id",t.domId||t.id),a=1,{cssStyles:o}=t,l=Rn.svg(i),c=In(t,{fill:"black",stroke:"none",fillStyle:"solid"});t.look!=="handDrawn"&&(c.roughness=0);const u=l.circle(0,0,a*2,c),d=i.insert(()=>u,":first-child");return d.attr("class","anchor").attr("style",yo(o)),Pn(t,d),t.intersect=function(h){return qt.info("Circle intersect",t,a,h),En.circle(t,a,h)},i}ie(due,"anchor");function $4(e,t,n,r,s,i,a){const l=(e+n)/2,c=(t+r)/2,u=Math.atan2(r-t,n-e),d=(n-e)/2,h=(r-t)/2,m=d/s,y=h/i,b=Math.sqrt(m**2+y**2);if(b>1)throw new Error("The given radii are too small to create an arc between the points.");const v=Math.sqrt(1-b**2),x=l+v*i*Math.sin(u)*(a?-1:1),w=c-v*s*Math.cos(u)*(a?-1:1),_=Math.atan2((t-w)/i,(e-x)/s);let C=Math.atan2((r-w)/i,(n-x)/s)-_;a&&C<0&&(C+=2*Math.PI),!a&&C>0&&(C-=2*Math.PI);const T=[];for(let A=0;A<20;A++){const N=A/19,I=_+N*C,j=x+s*Math.cos(I),L=w+i*Math.sin(I);T.push({x:j,y:L})}return T}ie($4,"generateArcPoints");async function fue(e,t){const{labelStyles:n,nodeStyles:r}=On(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await hr(e,t,ir(t)),a=i.width+t.padding+20,o=i.height+t.padding,l=o/2,c=l/(2.5+o/50),{cssStyles:u}=t,d=[{x:a/2,y:-o/2},{x:-a/2,y:-o/2},...$4(-a/2,-o/2,-a/2,o/2,c,l,!1),{x:a/2,y:o/2},...$4(a/2,o/2,a/2,-o/2,c,l,!0)],h=Rn.svg(s),m=In(t,{});t.look!=="handDrawn"&&(m.roughness=0,m.fillStyle="solid");const y=Jr(d),b=h.path(y,m),v=s.insert(()=>b,":first-child");return v.attr("class","basic label-container"),u&&t.look!=="handDrawn"&&v.selectAll("path").attr("style",u),r&&t.look!=="handDrawn"&&v.selectAll("path").attr("style",r),v.attr("transform",`translate(${c/2}, 0)`),Pn(t,v),t.intersect=function(x){return En.polygon(t,d,x)},s}ie(fue,"bowTieRect");function Ef(e,t,n,r){return e.insert("polygon",":first-child").attr("points",r.map(function(s){return s.x+","+s.y}).join(" ")).attr("class","label-container").attr("transform","translate("+-t/2+","+n/2+")")}ie(Ef,"insertPolygonShape");async function hue(e,t){const{labelStyles:n,nodeStyles:r}=On(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await hr(e,t,ir(t)),a=i.height+t.padding,o=12,l=i.width+t.padding+o,c=0,u=l,d=-a,h=0,m=[{x:c+o,y:d},{x:u,y:d},{x:u,y:h},{x:c,y:h},{x:c,y:d+o},{x:c+o,y:d}];let y;const{cssStyles:b}=t;if(t.look==="handDrawn"){const v=Rn.svg(s),x=In(t,{}),w=Jr(m),_=v.path(w,x);y=s.insert(()=>_,":first-child").attr("transform",`translate(${-l/2}, ${a/2})`),b&&y.attr("style",b)}else y=Ef(s,l,a,m);return r&&y.attr("style",r),Pn(t,y),t.intersect=function(v){return En.polygon(t,m,v)},s}ie(hue,"card");function pue(e,t){const{nodeStyles:n}=On(t);t.label="";const r=e.insert("g").attr("class",ir(t)).attr("id",t.domId??t.id),{cssStyles:s}=t,i=Math.max(28,t.width??0),a=[{x:0,y:i/2},{x:i/2,y:0},{x:0,y:-i/2},{x:-i/2,y:0}],o=Rn.svg(r),l=In(t,{});t.look!=="handDrawn"&&(l.roughness=0,l.fillStyle="solid");const c=Jr(a),u=o.path(c,l),d=r.insert(()=>u,":first-child");return s&&t.look!=="handDrawn"&&d.selectAll("path").attr("style",s),n&&t.look!=="handDrawn"&&d.selectAll("path").attr("style",n),t.width=28,t.height=28,t.intersect=function(h){return En.polygon(t,a,h)},r}ie(pue,"choice");async function mue(e,t){const{labelStyles:n,nodeStyles:r}=On(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,halfPadding:a}=await hr(e,t,ir(t)),o=i.width/2+a;let l;const{cssStyles:c}=t;if(t.look==="handDrawn"){const u=Rn.svg(s),d=In(t,{}),h=u.circle(0,0,o*2,d);l=s.insert(()=>h,":first-child"),l.attr("class","basic label-container").attr("style",yo(c))}else l=s.insert("circle",":first-child").attr("class","basic label-container").attr("style",r).attr("r",o).attr("cx",0).attr("cy",0);return Pn(t,l),t.intersect=function(u){return qt.info("Circle intersect",t,o,u),En.circle(t,o,u)},s}ie(mue,"circle");function gue(e){const t=Math.cos(Math.PI/4),n=Math.sin(Math.PI/4),r=e*2,s={x:r/2*t,y:r/2*n},i={x:-(r/2)*t,y:r/2*n},a={x:-(r/2)*t,y:-(r/2)*n},o={x:r/2*t,y:-(r/2)*n};return`M ${i.x},${i.y} L ${o.x},${o.y}
                   M ${s.x},${s.y} L ${a.x},${a.y}`}ie(gue,"createLine");function yue(e,t){const{labelStyles:n,nodeStyles:r}=On(t);t.labelStyle=n,t.label="";const s=e.insert("g").attr("class",ir(t)).attr("id",t.domId??t.id),i=Math.max(30,(t==null?void 0:t.width)??0),{cssStyles:a}=t,o=Rn.svg(s),l=In(t,{});t.look!=="handDrawn"&&(l.roughness=0,l.fillStyle="solid");const c=o.circle(0,0,i*2,l),u=gue(i),d=o.path(u,l),h=s.insert(()=>c,":first-child");return h.insert(()=>d),a&&t.look!=="handDrawn"&&h.selectAll("path").attr("style",a),r&&t.look!=="handDrawn"&&h.selectAll("path").attr("style",r),Pn(t,h),t.intersect=function(m){return qt.info("crossedCircle intersect",t,{radius:i,point:m}),En.circle(t,i,m)},s}ie(yue,"crossedCircle");function Fd(e,t,n,r=100,s=0,i=180){const a=[],o=s*Math.PI/180,u=(i*Math.PI/180-o)/(r-1);for(let d=0;d<r;d++){const h=o+d*u,m=e+n*Math.cos(h),y=t+n*Math.sin(h);a.push({x:-m,y:-y})}return a}ie(Fd,"generateCirclePoints");async function bue(e,t){const{labelStyles:n,nodeStyles:r}=On(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await hr(e,t,ir(t)),o=i.width+(t.padding??0),l=i.height+(t.padding??0),c=Math.max(5,l*.1),{cssStyles:u}=t,d=[...Fd(o/2,-l/2,c,30,-90,0),{x:-o/2-c,y:c},...Fd(o/2+c*2,-c,c,20,-180,-270),...Fd(o/2+c*2,c,c,20,-90,-180),{x:-o/2-c,y:-l/2},...Fd(o/2,l/2,c,20,0,90)],h=[{x:o/2,y:-l/2-c},{x:-o/2,y:-l/2-c},...Fd(o/2,-l/2,c,20,-90,0),{x:-o/2-c,y:-c},...Fd(o/2+o*.1,-c,c,20,-180,-270),...Fd(o/2+o*.1,c,c,20,-90,-180),{x:-o/2-c,y:l/2},...Fd(o/2,l/2,c,20,0,90),{x:-o/2,y:l/2+c},{x:o/2,y:l/2+c}],m=Rn.svg(s),y=In(t,{fill:"none"});t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");const v=Jr(d).replace("Z",""),x=m.path(v,y),w=Jr(h),_=m.path(w,{...y}),k=s.insert("g",":first-child");return k.insert(()=>_,":first-child").attr("stroke-opacity",0),k.insert(()=>x,":first-child"),k.attr("class","text"),u&&t.look!=="handDrawn"&&k.selectAll("path").attr("style",u),r&&t.look!=="handDrawn"&&k.selectAll("path").attr("style",r),k.attr("transform",`translate(${c}, 0)`),a.attr("transform",`translate(${-o/2+c-(i.x-(i.left??0))},${-l/2+(t.padding??0)/2-(i.y-(i.top??0))})`),Pn(t,k),t.intersect=function(C){return En.polygon(t,h,C)},s}ie(bue,"curlyBraceLeft");function Ld(e,t,n,r=100,s=0,i=180){const a=[],o=s*Math.PI/180,u=(i*Math.PI/180-o)/(r-1);for(let d=0;d<r;d++){const h=o+d*u,m=e+n*Math.cos(h),y=t+n*Math.sin(h);a.push({x:m,y})}return a}ie(Ld,"generateCirclePoints");async function vue(e,t){const{labelStyles:n,nodeStyles:r}=On(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await hr(e,t,ir(t)),o=i.width+(t.padding??0),l=i.height+(t.padding??0),c=Math.max(5,l*.1),{cssStyles:u}=t,d=[...Ld(o/2,-l/2,c,20,-90,0),{x:o/2+c,y:-c},...Ld(o/2+c*2,-c,c,20,-180,-270),...Ld(o/2+c*2,c,c,20,-90,-180),{x:o/2+c,y:l/2},...Ld(o/2,l/2,c,20,0,90)],h=[{x:-o/2,y:-l/2-c},{x:o/2,y:-l/2-c},...Ld(o/2,-l/2,c,20,-90,0),{x:o/2+c,y:-c},...Ld(o/2+c*2,-c,c,20,-180,-270),...Ld(o/2+c*2,c,c,20,-90,-180),{x:o/2+c,y:l/2},...Ld(o/2,l/2,c,20,0,90),{x:o/2,y:l/2+c},{x:-o/2,y:l/2+c}],m=Rn.svg(s),y=In(t,{fill:"none"});t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");const v=Jr(d).replace("Z",""),x=m.path(v,y),w=Jr(h),_=m.path(w,{...y}),k=s.insert("g",":first-child");return k.insert(()=>_,":first-child").attr("stroke-opacity",0),k.insert(()=>x,":first-child"),k.attr("class","text"),u&&t.look!=="handDrawn"&&k.selectAll("path").attr("style",u),r&&t.look!=="handDrawn"&&k.selectAll("path").attr("style",r),k.attr("transform",`translate(${-c}, 0)`),a.attr("transform",`translate(${-o/2+(t.padding??0)/2-(i.x-(i.left??0))},${-l/2+(t.padding??0)/2-(i.y-(i.top??0))})`),Pn(t,k),t.intersect=function(C){return En.polygon(t,h,C)},s}ie(vue,"curlyBraceRight");function _a(e,t,n,r=100,s=0,i=180){const a=[],o=s*Math.PI/180,u=(i*Math.PI/180-o)/(r-1);for(let d=0;d<r;d++){const h=o+d*u,m=e+n*Math.cos(h),y=t+n*Math.sin(h);a.push({x:-m,y:-y})}return a}ie(_a,"generateCirclePoints");async function xue(e,t){const{labelStyles:n,nodeStyles:r}=On(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await hr(e,t,ir(t)),o=i.width+(t.padding??0),l=i.height+(t.padding??0),c=Math.max(5,l*.1),{cssStyles:u}=t,d=[..._a(o/2,-l/2,c,30,-90,0),{x:-o/2-c,y:c},..._a(o/2+c*2,-c,c,20,-180,-270),..._a(o/2+c*2,c,c,20,-90,-180),{x:-o/2-c,y:-l/2},..._a(o/2,l/2,c,20,0,90)],h=[..._a(-o/2+c+c/2,-l/2,c,20,-90,-180),{x:o/2-c/2,y:c},..._a(-o/2-c/2,-c,c,20,0,90),..._a(-o/2-c/2,c,c,20,-90,0),{x:o/2-c/2,y:-c},..._a(-o/2+c+c/2,l/2,c,30,-180,-270)],m=[{x:o/2,y:-l/2-c},{x:-o/2,y:-l/2-c},..._a(o/2,-l/2,c,20,-90,0),{x:-o/2-c,y:-c},..._a(o/2+c*2,-c,c,20,-180,-270),..._a(o/2+c*2,c,c,20,-90,-180),{x:-o/2-c,y:l/2},..._a(o/2,l/2,c,20,0,90),{x:-o/2,y:l/2+c},{x:o/2-c-c/2,y:l/2+c},..._a(-o/2+c+c/2,-l/2,c,20,-90,-180),{x:o/2-c/2,y:c},..._a(-o/2-c/2,-c,c,20,0,90),..._a(-o/2-c/2,c,c,20,-90,0),{x:o/2-c/2,y:-c},..._a(-o/2+c+c/2,l/2,c,30,-180,-270)],y=Rn.svg(s),b=In(t,{fill:"none"});t.look!=="handDrawn"&&(b.roughness=0,b.fillStyle="solid");const x=Jr(d).replace("Z",""),w=y.path(x,b),k=Jr(h).replace("Z",""),C=y.path(k,b),T=Jr(m),A=y.path(T,{...b}),N=s.insert("g",":first-child");return N.insert(()=>A,":first-child").attr("stroke-opacity",0),N.insert(()=>w,":first-child"),N.insert(()=>C,":first-child"),N.attr("class","text"),u&&t.look!=="handDrawn"&&N.selectAll("path").attr("style",u),r&&t.look!=="handDrawn"&&N.selectAll("path").attr("style",r),N.attr("transform",`translate(${c-c/4}, 0)`),a.attr("transform",`translate(${-o/2+(t.padding??0)/2-(i.x-(i.left??0))},${-l/2+(t.padding??0)/2-(i.y-(i.top??0))})`),Pn(t,N),t.intersect=function(I){return En.polygon(t,m,I)},s}ie(xue,"curlyBraces");async function wue(e,t){const{labelStyles:n,nodeStyles:r}=On(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await hr(e,t,ir(t)),a=80,o=20,l=Math.max(a,(i.width+(t.padding??0)*2)*1.25,(t==null?void 0:t.width)??0),c=Math.max(o,i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),u=c/2,{cssStyles:d}=t,h=Rn.svg(s),m=In(t,{});t.look!=="handDrawn"&&(m.roughness=0,m.fillStyle="solid");const y=l,b=c,v=y-u,x=b/4,w=[{x:v,y:0},{x,y:0},{x:0,y:b/2},{x,y:b},{x:v,y:b},...E5(-v,-b/2,u,50,270,90)],_=Jr(w),k=h.path(_,m),C=s.insert(()=>k,":first-child");return C.attr("class","basic label-container"),d&&t.look!=="handDrawn"&&C.selectChildren("path").attr("style",d),r&&t.look!=="handDrawn"&&C.selectChildren("path").attr("style",r),C.attr("transform",`translate(${-l/2}, ${-c/2})`),Pn(t,C),t.intersect=function(T){return En.polygon(t,w,T)},s}ie(wue,"curvedTrapezoid");var tlt=ie((e,t,n,r,s,i)=>[`M${e},${t+i}`,`a${s},${i} 0,0,0 ${n},0`,`a${s},${i} 0,0,0 ${-n},0`,`l0,${r}`,`a${s},${i} 0,0,0 ${n},0`,`l0,${-r}`].join(" "),"createCylinderPathD"),nlt=ie((e,t,n,r,s,i)=>[`M${e},${t+i}`,`M${e+n},${t+i}`,`a${s},${i} 0,0,0 ${-n},0`,`l0,${r}`,`a${s},${i} 0,0,0 ${n},0`,`l0,${-r}`].join(" "),"createOuterCylinderPathD"),rlt=ie((e,t,n,r,s,i)=>[`M${e-n/2},${-r/2}`,`a${s},${i} 0,0,0 ${n},0`].join(" "),"createInnerCylinderPathD");async function Sue(e,t){const{labelStyles:n,nodeStyles:r}=On(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await hr(e,t,ir(t)),o=Math.max(i.width+t.padding,t.width??0),l=o/2,c=l/(2.5+o/50),u=Math.max(i.height+c+t.padding,t.height??0);let d;const{cssStyles:h}=t;if(t.look==="handDrawn"){const m=Rn.svg(s),y=nlt(0,0,o,u,l,c),b=rlt(0,c,o,u,l,c),v=m.path(y,In(t,{})),x=m.path(b,In(t,{fill:"none"}));d=s.insert(()=>x,":first-child"),d=s.insert(()=>v,":first-child"),d.attr("class","basic label-container"),h&&d.attr("style",h)}else{const m=tlt(0,0,o,u,l,c);d=s.insert("path",":first-child").attr("d",m).attr("class","basic label-container").attr("style",yo(h)).attr("style",r)}return d.attr("label-offset-y",c),d.attr("transform",`translate(${-o/2}, ${-(u/2+c)})`),Pn(t,d),a.attr("transform",`translate(${-(i.width/2)-(i.x-(i.left??0))}, ${-(i.height/2)+(t.padding??0)/1.5-(i.y-(i.top??0))})`),t.intersect=function(m){const y=En.rect(t,m),b=y.x-(t.x??0);if(l!=0&&(Math.abs(b)<(t.width??0)/2||Math.abs(b)==(t.width??0)/2&&Math.abs(y.y-(t.y??0))>(t.height??0)/2-c)){let v=c*c*(1-b*b/(l*l));v>0&&(v=Math.sqrt(v)),v=c-v,m.y-(t.y??0)>0&&(v=-v),y.y+=v}return y},s}ie(Sue,"cylinder");async function _ue(e,t){const{labelStyles:n,nodeStyles:r}=On(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await hr(e,t,ir(t)),o=i.width+t.padding,l=i.height+t.padding,c=l*.2,u=-o/2,d=-l/2-c/2,{cssStyles:h}=t,m=Rn.svg(s),y=In(t,{});t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");const b=[{x:u,y:d+c},{x:-u,y:d+c},{x:-u,y:-d},{x:u,y:-d},{x:u,y:d},{x:-u,y:d},{x:-u,y:d+c}],v=m.polygon(b.map(w=>[w.x,w.y]),y),x=s.insert(()=>v,":first-child");return x.attr("class","basic label-container"),h&&t.look!=="handDrawn"&&x.selectAll("path").attr("style",h),r&&t.look!=="handDrawn"&&x.selectAll("path").attr("style",r),a.attr("transform",`translate(${u+(t.padding??0)/2-(i.x-(i.left??0))}, ${d+c+(t.padding??0)/2-(i.y-(i.top??0))})`),Pn(t,x),t.intersect=function(w){return En.rect(t,w)},s}ie(_ue,"dividedRectangle");async function Cue(e,t){var h,m;const{labelStyles:n,nodeStyles:r}=On(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,halfPadding:a}=await hr(e,t,ir(t)),l=i.width/2+a+5,c=i.width/2+a;let u;const{cssStyles:d}=t;if(t.look==="handDrawn"){const y=Rn.svg(s),b=In(t,{roughness:.2,strokeWidth:2.5}),v=In(t,{roughness:.2,strokeWidth:1.5}),x=y.circle(0,0,l*2,b),w=y.circle(0,0,c*2,v);u=s.insert("g",":first-child"),u.attr("class",yo(t.cssClasses)).attr("style",yo(d)),(h=u.node())==null||h.appendChild(x),(m=u.node())==null||m.appendChild(w)}else{u=s.insert("g",":first-child");const y=u.insert("circle",":first-child"),b=u.insert("circle");u.attr("class","basic label-container").attr("style",r),y.attr("class","outer-circle").attr("style",r).attr("r",l).attr("cx",0).attr("cy",0),b.attr("class","inner-circle").attr("style",r).attr("r",c).attr("cx",0).attr("cy",0)}return Pn(t,u),t.intersect=function(y){return qt.info("DoubleCircle intersect",t,l,y),En.circle(t,l,y)},s}ie(Cue,"doublecircle");function kue(e,t,{config:{themeVariables:n}}){const{labelStyles:r,nodeStyles:s}=On(t);t.label="",t.labelStyle=r;const i=e.insert("g").attr("class",ir(t)).attr("id",t.domId??t.id),a=7,{cssStyles:o}=t,l=Rn.svg(i),{nodeBorder:c}=n,u=In(t,{fillStyle:"solid"});t.look!=="handDrawn"&&(u.roughness=0);const d=l.circle(0,0,a*2,u),h=i.insert(()=>d,":first-child");return h.selectAll("path").attr("style",`fill: ${c} !important;`),o&&o.length>0&&t.look!=="handDrawn"&&h.selectAll("path").attr("style",o),s&&t.look!=="handDrawn"&&h.selectAll("path").attr("style",s),Pn(t,h),t.intersect=function(m){return qt.info("filledCircle intersect",t,{radius:a,point:m}),En.circle(t,a,m)},i}ie(kue,"filledCircle");async function Eue(e,t){const{labelStyles:n,nodeStyles:r}=On(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await hr(e,t,ir(t)),o=i.width+(t.padding??0),l=o+i.height,c=o+i.height,u=[{x:0,y:-l},{x:c,y:-l},{x:c/2,y:0}],{cssStyles:d}=t,h=Rn.svg(s),m=In(t,{});t.look!=="handDrawn"&&(m.roughness=0,m.fillStyle="solid");const y=Jr(u),b=h.path(y,m),v=s.insert(()=>b,":first-child").attr("transform",`translate(${-l/2}, ${l/2})`);return d&&t.look!=="handDrawn"&&v.selectChildren("path").attr("style",d),r&&t.look!=="handDrawn"&&v.selectChildren("path").attr("style",r),t.width=o,t.height=l,Pn(t,v),a.attr("transform",`translate(${-i.width/2-(i.x-(i.left??0))}, ${-l/2+(t.padding??0)/2+(i.y-(i.top??0))})`),t.intersect=function(x){return qt.info("Triangle intersect",t,u,x),En.polygon(t,u,x)},s}ie(Eue,"flippedTriangle");function Tue(e,t,{dir:n,config:{state:r,themeVariables:s}}){const{nodeStyles:i}=On(t);t.label="";const a=e.insert("g").attr("class",ir(t)).attr("id",t.domId??t.id),{cssStyles:o}=t;let l=Math.max(70,(t==null?void 0:t.width)??0),c=Math.max(10,(t==null?void 0:t.height)??0);n==="LR"&&(l=Math.max(10,(t==null?void 0:t.width)??0),c=Math.max(70,(t==null?void 0:t.height)??0));const u=-1*l/2,d=-1*c/2,h=Rn.svg(a),m=In(t,{stroke:s.lineColor,fill:s.lineColor});t.look!=="handDrawn"&&(m.roughness=0,m.fillStyle="solid");const y=h.rectangle(u,d,l,c,m),b=a.insert(()=>y,":first-child");o&&t.look!=="handDrawn"&&b.selectAll("path").attr("style",o),i&&t.look!=="handDrawn"&&b.selectAll("path").attr("style",i),Pn(t,b);const v=(r==null?void 0:r.padding)??0;return t.width&&t.height&&(t.width+=v/2||0,t.height+=v/2||0),t.intersect=function(x){return En.rect(t,x)},a}ie(Tue,"forkJoin");async function Aue(e,t){const{labelStyles:n,nodeStyles:r}=On(t);t.labelStyle=n;const s=80,i=50,{shapeSvg:a,bbox:o}=await hr(e,t,ir(t)),l=Math.max(s,o.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),c=Math.max(i,o.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),u=c/2,{cssStyles:d}=t,h=Rn.svg(a),m=In(t,{});t.look!=="handDrawn"&&(m.roughness=0,m.fillStyle="solid");const y=[{x:-l/2,y:-c/2},{x:l/2-u,y:-c/2},...E5(-l/2+u,0,u,50,90,270),{x:l/2-u,y:c/2},{x:-l/2,y:c/2}],b=Jr(y),v=h.path(b,m),x=a.insert(()=>v,":first-child");return x.attr("class","basic label-container"),d&&t.look!=="handDrawn"&&x.selectChildren("path").attr("style",d),r&&t.look!=="handDrawn"&&x.selectChildren("path").attr("style",r),Pn(t,x),t.intersect=function(w){return qt.info("Pill intersect",t,{radius:u,point:w}),En.polygon(t,y,w)},a}ie(Aue,"halfRoundedRectangle");var slt=ie((e,t,n,r,s)=>[`M${e+s},${t}`,`L${e+n-s},${t}`,`L${e+n},${t-r/2}`,`L${e+n-s},${t-r}`,`L${e+s},${t-r}`,`L${e},${t-r/2}`,"Z"].join(" "),"createHexagonPathD");async function Rue(e,t){const{labelStyles:n,nodeStyles:r}=On(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await hr(e,t,ir(t)),a=4,o=i.height+t.padding,l=o/a,c=i.width+2*l+t.padding,u=[{x:l,y:0},{x:c-l,y:0},{x:c,y:-o/2},{x:c-l,y:-o},{x:l,y:-o},{x:0,y:-o/2}];let d;const{cssStyles:h}=t;if(t.look==="handDrawn"){const m=Rn.svg(s),y=In(t,{}),b=slt(0,0,c,o,l),v=m.path(b,y);d=s.insert(()=>v,":first-child").attr("transform",`translate(${-c/2}, ${o/2})`),h&&d.attr("style",h)}else d=Ef(s,c,o,u);return r&&d.attr("style",r),t.width=c,t.height=o,Pn(t,d),t.intersect=function(m){return En.polygon(t,u,m)},s}ie(Rue,"hexagon");async function Nue(e,t){const{labelStyles:n,nodeStyles:r}=On(t);t.label="",t.labelStyle=n;const{shapeSvg:s}=await hr(e,t,ir(t)),i=Math.max(30,(t==null?void 0:t.width)??0),a=Math.max(30,(t==null?void 0:t.height)??0),{cssStyles:o}=t,l=Rn.svg(s),c=In(t,{});t.look!=="handDrawn"&&(c.roughness=0,c.fillStyle="solid");const u=[{x:0,y:0},{x:i,y:0},{x:0,y:a},{x:i,y:a}],d=Jr(u),h=l.path(d,c),m=s.insert(()=>h,":first-child");return m.attr("class","basic label-container"),o&&t.look!=="handDrawn"&&m.selectChildren("path").attr("style",o),r&&t.look!=="handDrawn"&&m.selectChildren("path").attr("style",r),m.attr("transform",`translate(${-i/2}, ${-a/2})`),Pn(t,m),t.intersect=function(y){return qt.info("Pill intersect",t,{points:u}),En.polygon(t,u,y)},s}ie(Nue,"hourglass");async function Iue(e,t,{config:{themeVariables:n,flowchart:r}}){const{labelStyles:s}=On(t);t.labelStyle=s;const i=t.assetHeight??48,a=t.assetWidth??48,o=Math.max(i,a),l=r==null?void 0:r.wrappingWidth;t.width=Math.max(o,l??0);const{shapeSvg:c,bbox:u,label:d}=await hr(e,t,"icon-shape default"),h=t.pos==="t",m=o,y=o,{nodeBorder:b}=n,{stylesMap:v}=Ob(t),x=-y/2,w=-m/2,_=t.label?8:0,k=Rn.svg(c),C=In(t,{stroke:"none",fill:"none"});t.look!=="handDrawn"&&(C.roughness=0,C.fillStyle="solid");const T=k.rectangle(x,w,y,m,C),A=Math.max(y,u.width),N=m+u.height+_,I=k.rectangle(-A/2,-N/2,A,N,{...C,fill:"transparent",stroke:"none"}),j=c.insert(()=>T,":first-child"),L=c.insert(()=>I);if(t.icon){const D=c.append("g");D.html(`<g>${await hA(t.icon,{height:o,width:o,fallbackPrefix:""})}</g>`);const H=D.node().getBBox(),O=H.width,K=H.height,U=H.x,W=H.y;D.attr("transform",`translate(${-O/2-U},${h?u.height/2+_/2-K/2-W:-u.height/2-_/2-K/2-W})`),D.attr("style",`color: ${v.get("stroke")??b};`)}return d.attr("transform",`translate(${-u.width/2-(u.x-(u.left??0))},${h?-N/2:N/2-u.height})`),j.attr("transform",`translate(0,${h?u.height/2+_/2:-u.height/2-_/2})`),Pn(t,L),t.intersect=function(D){if(qt.info("iconSquare intersect",t,D),!t.label)return En.rect(t,D);const H=t.x??0,O=t.y??0,K=t.height??0;let U=[];return h?U=[{x:H-u.width/2,y:O-K/2},{x:H+u.width/2,y:O-K/2},{x:H+u.width/2,y:O-K/2+u.height+_},{x:H+y/2,y:O-K/2+u.height+_},{x:H+y/2,y:O+K/2},{x:H-y/2,y:O+K/2},{x:H-y/2,y:O-K/2+u.height+_},{x:H-u.width/2,y:O-K/2+u.height+_}]:U=[{x:H-y/2,y:O-K/2},{x:H+y/2,y:O-K/2},{x:H+y/2,y:O-K/2+m},{x:H+u.width/2,y:O-K/2+m},{x:H+u.width/2/2,y:O+K/2},{x:H-u.width/2,y:O+K/2},{x:H-u.width/2,y:O-K/2+m},{x:H-y/2,y:O-K/2+m}],En.polygon(t,U,D)},c}ie(Iue,"icon");async function Mue(e,t,{config:{themeVariables:n,flowchart:r}}){const{labelStyles:s}=On(t);t.labelStyle=s;const i=t.assetHeight??48,a=t.assetWidth??48,o=Math.max(i,a),l=r==null?void 0:r.wrappingWidth;t.width=Math.max(o,l??0);const{shapeSvg:c,bbox:u,label:d}=await hr(e,t,"icon-shape default"),h=20,m=t.label?8:0,y=t.pos==="t",{nodeBorder:b,mainBkg:v}=n,{stylesMap:x}=Ob(t),w=Rn.svg(c),_=In(t,{});t.look!=="handDrawn"&&(_.roughness=0,_.fillStyle="solid");const k=x.get("fill");_.stroke=k??v;const C=c.append("g");t.icon&&C.html(`<g>${await hA(t.icon,{height:o,width:o,fallbackPrefix:""})}</g>`);const T=C.node().getBBox(),A=T.width,N=T.height,I=T.x,j=T.y,L=Math.max(A,N)*Math.SQRT2+h*2,D=w.circle(0,0,L,_),H=Math.max(L,u.width),O=L+u.height+m,K=w.rectangle(-H/2,-O/2,H,O,{..._,fill:"transparent",stroke:"none"}),U=c.insert(()=>D,":first-child"),W=c.insert(()=>K);return C.attr("transform",`translate(${-A/2-I},${y?u.height/2+m/2-N/2-j:-u.height/2-m/2-N/2-j})`),C.attr("style",`color: ${x.get("stroke")??b};`),d.attr("transform",`translate(${-u.width/2-(u.x-(u.left??0))},${y?-O/2:O/2-u.height})`),U.attr("transform",`translate(0,${y?u.height/2+m/2:-u.height/2-m/2})`),Pn(t,W),t.intersect=function(B){return qt.info("iconSquare intersect",t,B),En.rect(t,B)},c}ie(Mue,"iconCircle");async function jue(e,t,{config:{themeVariables:n,flowchart:r}}){const{labelStyles:s}=On(t);t.labelStyle=s;const i=t.assetHeight??48,a=t.assetWidth??48,o=Math.max(i,a),l=r==null?void 0:r.wrappingWidth;t.width=Math.max(o,l??0);const{shapeSvg:c,bbox:u,halfPadding:d,label:h}=await hr(e,t,"icon-shape default"),m=t.pos==="t",y=o+d*2,b=o+d*2,{nodeBorder:v,mainBkg:x}=n,{stylesMap:w}=Ob(t),_=-b/2,k=-y/2,C=t.label?8:0,T=Rn.svg(c),A=In(t,{});t.look!=="handDrawn"&&(A.roughness=0,A.fillStyle="solid");const N=w.get("fill");A.stroke=N??x;const I=T.path(kf(_,k,b,y,5),A),j=Math.max(b,u.width),L=y+u.height+C,D=T.rectangle(-j/2,-L/2,j,L,{...A,fill:"transparent",stroke:"none"}),H=c.insert(()=>I,":first-child").attr("class","icon-shape2"),O=c.insert(()=>D);if(t.icon){const K=c.append("g");K.html(`<g>${await hA(t.icon,{height:o,width:o,fallbackPrefix:""})}</g>`);const U=K.node().getBBox(),W=U.width,B=U.height,ne=U.x,V=U.y;K.attr("transform",`translate(${-W/2-ne},${m?u.height/2+C/2-B/2-V:-u.height/2-C/2-B/2-V})`),K.attr("style",`color: ${w.get("stroke")??v};`)}return h.attr("transform",`translate(${-u.width/2-(u.x-(u.left??0))},${m?-L/2:L/2-u.height})`),H.attr("transform",`translate(0,${m?u.height/2+C/2:-u.height/2-C/2})`),Pn(t,O),t.intersect=function(K){if(qt.info("iconSquare intersect",t,K),!t.label)return En.rect(t,K);const U=t.x??0,W=t.y??0,B=t.height??0;let ne=[];return m?ne=[{x:U-u.width/2,y:W-B/2},{x:U+u.width/2,y:W-B/2},{x:U+u.width/2,y:W-B/2+u.height+C},{x:U+b/2,y:W-B/2+u.height+C},{x:U+b/2,y:W+B/2},{x:U-b/2,y:W+B/2},{x:U-b/2,y:W-B/2+u.height+C},{x:U-u.width/2,y:W-B/2+u.height+C}]:ne=[{x:U-b/2,y:W-B/2},{x:U+b/2,y:W-B/2},{x:U+b/2,y:W-B/2+y},{x:U+u.width/2,y:W-B/2+y},{x:U+u.width/2/2,y:W+B/2},{x:U-u.width/2,y:W+B/2},{x:U-u.width/2,y:W-B/2+y},{x:U-b/2,y:W-B/2+y}],En.polygon(t,ne,K)},c}ie(jue,"iconRounded");async function Pue(e,t,{config:{themeVariables:n,flowchart:r}}){const{labelStyles:s}=On(t);t.labelStyle=s;const i=t.assetHeight??48,a=t.assetWidth??48,o=Math.max(i,a),l=r==null?void 0:r.wrappingWidth;t.width=Math.max(o,l??0);const{shapeSvg:c,bbox:u,halfPadding:d,label:h}=await hr(e,t,"icon-shape default"),m=t.pos==="t",y=o+d*2,b=o+d*2,{nodeBorder:v,mainBkg:x}=n,{stylesMap:w}=Ob(t),_=-b/2,k=-y/2,C=t.label?8:0,T=Rn.svg(c),A=In(t,{});t.look!=="handDrawn"&&(A.roughness=0,A.fillStyle="solid");const N=w.get("fill");A.stroke=N??x;const I=T.path(kf(_,k,b,y,.1),A),j=Math.max(b,u.width),L=y+u.height+C,D=T.rectangle(-j/2,-L/2,j,L,{...A,fill:"transparent",stroke:"none"}),H=c.insert(()=>I,":first-child"),O=c.insert(()=>D);if(t.icon){const K=c.append("g");K.html(`<g>${await hA(t.icon,{height:o,width:o,fallbackPrefix:""})}</g>`);const U=K.node().getBBox(),W=U.width,B=U.height,ne=U.x,V=U.y;K.attr("transform",`translate(${-W/2-ne},${m?u.height/2+C/2-B/2-V:-u.height/2-C/2-B/2-V})`),K.attr("style",`color: ${w.get("stroke")??v};`)}return h.attr("transform",`translate(${-u.width/2-(u.x-(u.left??0))},${m?-L/2:L/2-u.height})`),H.attr("transform",`translate(0,${m?u.height/2+C/2:-u.height/2-C/2})`),Pn(t,O),t.intersect=function(K){if(qt.info("iconSquare intersect",t,K),!t.label)return En.rect(t,K);const U=t.x??0,W=t.y??0,B=t.height??0;let ne=[];return m?ne=[{x:U-u.width/2,y:W-B/2},{x:U+u.width/2,y:W-B/2},{x:U+u.width/2,y:W-B/2+u.height+C},{x:U+b/2,y:W-B/2+u.height+C},{x:U+b/2,y:W+B/2},{x:U-b/2,y:W+B/2},{x:U-b/2,y:W-B/2+u.height+C},{x:U-u.width/2,y:W-B/2+u.height+C}]:ne=[{x:U-b/2,y:W-B/2},{x:U+b/2,y:W-B/2},{x:U+b/2,y:W-B/2+y},{x:U+u.width/2,y:W-B/2+y},{x:U+u.width/2/2,y:W+B/2},{x:U-u.width/2,y:W+B/2},{x:U-u.width/2,y:W-B/2+y},{x:U-b/2,y:W-B/2+y}],En.polygon(t,ne,K)},c}ie(Pue,"iconSquare");async function Oue(e,t,{config:{flowchart:n}}){const r=new Image;r.src=(t==null?void 0:t.img)??"",await r.decode();const s=Number(r.naturalWidth.toString().replace("px","")),i=Number(r.naturalHeight.toString().replace("px",""));t.imageAspectRatio=s/i;const{labelStyles:a}=On(t);t.labelStyle=a;const o=n==null?void 0:n.wrappingWidth;t.defaultWidth=n==null?void 0:n.wrappingWidth;const l=Math.max(t.label?o??0:0,(t==null?void 0:t.assetWidth)??s),c=t.constraint==="on"&&t!=null&&t.assetHeight?t.assetHeight*t.imageAspectRatio:l,u=t.constraint==="on"?c/t.imageAspectRatio:(t==null?void 0:t.assetHeight)??i;t.width=Math.max(c,o??0);const{shapeSvg:d,bbox:h,label:m}=await hr(e,t,"image-shape default"),y=t.pos==="t",b=-c/2,v=-u/2,x=t.label?8:0,w=Rn.svg(d),_=In(t,{});t.look!=="handDrawn"&&(_.roughness=0,_.fillStyle="solid");const k=w.rectangle(b,v,c,u,_),C=Math.max(c,h.width),T=u+h.height+x,A=w.rectangle(-C/2,-T/2,C,T,{..._,fill:"none",stroke:"none"}),N=d.insert(()=>k,":first-child"),I=d.insert(()=>A);if(t.img){const j=d.append("image");j.attr("href",t.img),j.attr("width",c),j.attr("height",u),j.attr("preserveAspectRatio","none"),j.attr("transform",`translate(${-c/2},${y?T/2-u:-T/2})`)}return m.attr("transform",`translate(${-h.width/2-(h.x-(h.left??0))},${y?-u/2-h.height/2-x/2:u/2-h.height/2+x/2})`),N.attr("transform",`translate(0,${y?h.height/2+x/2:-h.height/2-x/2})`),Pn(t,I),t.intersect=function(j){if(qt.info("iconSquare intersect",t,j),!t.label)return En.rect(t,j);const L=t.x??0,D=t.y??0,H=t.height??0;let O=[];return y?O=[{x:L-h.width/2,y:D-H/2},{x:L+h.width/2,y:D-H/2},{x:L+h.width/2,y:D-H/2+h.height+x},{x:L+c/2,y:D-H/2+h.height+x},{x:L+c/2,y:D+H/2},{x:L-c/2,y:D+H/2},{x:L-c/2,y:D-H/2+h.height+x},{x:L-h.width/2,y:D-H/2+h.height+x}]:O=[{x:L-c/2,y:D-H/2},{x:L+c/2,y:D-H/2},{x:L+c/2,y:D-H/2+u},{x:L+h.width/2,y:D-H/2+u},{x:L+h.width/2/2,y:D+H/2},{x:L-h.width/2,y:D+H/2},{x:L-h.width/2,y:D-H/2+u},{x:L-c/2,y:D-H/2+u}],En.polygon(t,O,j)},d}ie(Oue,"imageSquare");async function Due(e,t){const{labelStyles:n,nodeStyles:r}=On(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await hr(e,t,ir(t)),a=Math.max(i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),o=Math.max(i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),l=[{x:0,y:0},{x:a,y:0},{x:a+3*o/6,y:-o},{x:-3*o/6,y:-o}];let c;const{cssStyles:u}=t;if(t.look==="handDrawn"){const d=Rn.svg(s),h=In(t,{}),m=Jr(l),y=d.path(m,h);c=s.insert(()=>y,":first-child").attr("transform",`translate(${-a/2}, ${o/2})`),u&&c.attr("style",u)}else c=Ef(s,a,o,l);return r&&c.attr("style",r),t.width=a,t.height=o,Pn(t,c),t.intersect=function(d){return En.polygon(t,l,d)},s}ie(Due,"inv_trapezoid");async function IS(e,t,n){const{labelStyles:r,nodeStyles:s}=On(t);t.labelStyle=r;const{shapeSvg:i,bbox:a}=await hr(e,t,ir(t)),o=Math.max(a.width+n.labelPaddingX*2,(t==null?void 0:t.width)||0),l=Math.max(a.height+n.labelPaddingY*2,(t==null?void 0:t.height)||0),c=-o/2,u=-l/2;let d,{rx:h,ry:m}=t;const{cssStyles:y}=t;if(n!=null&&n.rx&&n.ry&&(h=n.rx,m=n.ry),t.look==="handDrawn"){const b=Rn.svg(i),v=In(t,{}),x=h||m?b.path(kf(c,u,o,l,h||0),v):b.rectangle(c,u,o,l,v);d=i.insert(()=>x,":first-child"),d.attr("class","basic label-container").attr("style",yo(y))}else d=i.insert("rect",":first-child"),d.attr("class","basic label-container").attr("style",s).attr("rx",yo(h)).attr("ry",yo(m)).attr("x",c).attr("y",u).attr("width",o).attr("height",l);return Pn(t,d),t.intersect=function(b){return En.rect(t,b)},i}ie(IS,"drawRect");async function Fue(e,t){const{shapeSvg:n,bbox:r,label:s}=await hr(e,t,"label"),i=n.insert("rect",":first-child");return i.attr("width",.1).attr("height",.1),n.attr("class","label edgeLabel"),s.attr("transform",`translate(${-(r.width/2)-(r.x-(r.left??0))}, ${-(r.height/2)-(r.y-(r.top??0))})`),Pn(t,i),t.intersect=function(l){return En.rect(t,l)},n}ie(Fue,"labelRect");async function Lue(e,t){const{labelStyles:n,nodeStyles:r}=On(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await hr(e,t,ir(t)),a=Math.max(i.width+(t.padding??0),(t==null?void 0:t.width)??0),o=Math.max(i.height+(t.padding??0),(t==null?void 0:t.height)??0),l=[{x:0,y:0},{x:a+3*o/6,y:0},{x:a,y:-o},{x:-(3*o)/6,y:-o}];let c;const{cssStyles:u}=t;if(t.look==="handDrawn"){const d=Rn.svg(s),h=In(t,{}),m=Jr(l),y=d.path(m,h);c=s.insert(()=>y,":first-child").attr("transform",`translate(${-a/2}, ${o/2})`),u&&c.attr("style",u)}else c=Ef(s,a,o,l);return r&&c.attr("style",r),t.width=a,t.height=o,Pn(t,c),t.intersect=function(d){return En.polygon(t,l,d)},s}ie(Lue,"lean_left");async function Bue(e,t){const{labelStyles:n,nodeStyles:r}=On(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await hr(e,t,ir(t)),a=Math.max(i.width+(t.padding??0),(t==null?void 0:t.width)??0),o=Math.max(i.height+(t.padding??0),(t==null?void 0:t.height)??0),l=[{x:-3*o/6,y:0},{x:a,y:0},{x:a+3*o/6,y:-o},{x:0,y:-o}];let c;const{cssStyles:u}=t;if(t.look==="handDrawn"){const d=Rn.svg(s),h=In(t,{}),m=Jr(l),y=d.path(m,h);c=s.insert(()=>y,":first-child").attr("transform",`translate(${-a/2}, ${o/2})`),u&&c.attr("style",u)}else c=Ef(s,a,o,l);return r&&c.attr("style",r),t.width=a,t.height=o,Pn(t,c),t.intersect=function(d){return En.polygon(t,l,d)},s}ie(Bue,"lean_right");function $ue(e,t){const{labelStyles:n,nodeStyles:r}=On(t);t.label="",t.labelStyle=n;const s=e.insert("g").attr("class",ir(t)).attr("id",t.domId??t.id),{cssStyles:i}=t,a=Math.max(35,(t==null?void 0:t.width)??0),o=Math.max(35,(t==null?void 0:t.height)??0),l=7,c=[{x:a,y:0},{x:0,y:o+l/2},{x:a-2*l,y:o+l/2},{x:0,y:2*o},{x:a,y:o-l/2},{x:2*l,y:o-l/2}],u=Rn.svg(s),d=In(t,{});t.look!=="handDrawn"&&(d.roughness=0,d.fillStyle="solid");const h=Jr(c),m=u.path(h,d),y=s.insert(()=>m,":first-child");return i&&t.look!=="handDrawn"&&y.selectAll("path").attr("style",i),r&&t.look!=="handDrawn"&&y.selectAll("path").attr("style",r),y.attr("transform",`translate(-${a/2},${-o})`),Pn(t,y),t.intersect=function(b){return qt.info("lightningBolt intersect",t,b),En.polygon(t,c,b)},s}ie($ue,"lightningBolt");var ilt=ie((e,t,n,r,s,i,a)=>[`M${e},${t+i}`,`a${s},${i} 0,0,0 ${n},0`,`a${s},${i} 0,0,0 ${-n},0`,`l0,${r}`,`a${s},${i} 0,0,0 ${n},0`,`l0,${-r}`,`M${e},${t+i+a}`,`a${s},${i} 0,0,0 ${n},0`].join(" "),"createCylinderPathD"),alt=ie((e,t,n,r,s,i,a)=>[`M${e},${t+i}`,`M${e+n},${t+i}`,`a${s},${i} 0,0,0 ${-n},0`,`l0,${r}`,`a${s},${i} 0,0,0 ${n},0`,`l0,${-r}`,`M${e},${t+i+a}`,`a${s},${i} 0,0,0 ${n},0`].join(" "),"createOuterCylinderPathD"),olt=ie((e,t,n,r,s,i)=>[`M${e-n/2},${-r/2}`,`a${s},${i} 0,0,0 ${n},0`].join(" "),"createInnerCylinderPathD");async function zue(e,t){const{labelStyles:n,nodeStyles:r}=On(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await hr(e,t,ir(t)),o=Math.max(i.width+(t.padding??0),t.width??0),l=o/2,c=l/(2.5+o/50),u=Math.max(i.height+c+(t.padding??0),t.height??0),d=u*.1;let h;const{cssStyles:m}=t;if(t.look==="handDrawn"){const y=Rn.svg(s),b=alt(0,0,o,u,l,c,d),v=olt(0,c,o,u,l,c),x=In(t,{}),w=y.path(b,x),_=y.path(v,x);s.insert(()=>_,":first-child").attr("class","line"),h=s.insert(()=>w,":first-child"),h.attr("class","basic label-container"),m&&h.attr("style",m)}else{const y=ilt(0,0,o,u,l,c,d);h=s.insert("path",":first-child").attr("d",y).attr("class","basic label-container").attr("style",yo(m)).attr("style",r)}return h.attr("label-offset-y",c),h.attr("transform",`translate(${-o/2}, ${-(u/2+c)})`),Pn(t,h),a.attr("transform",`translate(${-(i.width/2)-(i.x-(i.left??0))}, ${-(i.height/2)+c-(i.y-(i.top??0))})`),t.intersect=function(y){const b=En.rect(t,y),v=b.x-(t.x??0);if(l!=0&&(Math.abs(v)<(t.width??0)/2||Math.abs(v)==(t.width??0)/2&&Math.abs(b.y-(t.y??0))>(t.height??0)/2-c)){let x=c*c*(1-v*v/(l*l));x>0&&(x=Math.sqrt(x)),x=c-x,y.y-(t.y??0)>0&&(x=-x),b.y+=x}return b},s}ie(zue,"linedCylinder");async function Uue(e,t){const{labelStyles:n,nodeStyles:r}=On(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await hr(e,t,ir(t)),o=Math.max(i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),l=Math.max(i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),c=l/4,u=l+c,{cssStyles:d}=t,h=Rn.svg(s),m=In(t,{});t.look!=="handDrawn"&&(m.roughness=0,m.fillStyle="solid");const y=[{x:-o/2-o/2*.1,y:-u/2},{x:-o/2-o/2*.1,y:u/2},...ep(-o/2-o/2*.1,u/2,o/2+o/2*.1,u/2,c,.8),{x:o/2+o/2*.1,y:-u/2},{x:-o/2-o/2*.1,y:-u/2},{x:-o/2,y:-u/2},{x:-o/2,y:u/2*1.1},{x:-o/2,y:-u/2}],b=h.polygon(y.map(x=>[x.x,x.y]),m),v=s.insert(()=>b,":first-child");return v.attr("class","basic label-container"),d&&t.look!=="handDrawn"&&v.selectAll("path").attr("style",d),r&&t.look!=="handDrawn"&&v.selectAll("path").attr("style",r),v.attr("transform",`translate(0,${-c/2})`),a.attr("transform",`translate(${-o/2+(t.padding??0)+o/2*.1/2-(i.x-(i.left??0))},${-l/2+(t.padding??0)-c/2-(i.y-(i.top??0))})`),Pn(t,v),t.intersect=function(x){return En.polygon(t,y,x)},s}ie(Uue,"linedWaveEdgedRect");async function que(e,t){const{labelStyles:n,nodeStyles:r}=On(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await hr(e,t,ir(t)),o=Math.max(i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),l=Math.max(i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),c=5,u=-o/2,d=-l/2,{cssStyles:h}=t,m=Rn.svg(s),y=In(t,{}),b=[{x:u-c,y:d+c},{x:u-c,y:d+l+c},{x:u+o-c,y:d+l+c},{x:u+o-c,y:d+l},{x:u+o,y:d+l},{x:u+o,y:d+l-c},{x:u+o+c,y:d+l-c},{x:u+o+c,y:d-c},{x:u+c,y:d-c},{x:u+c,y:d},{x:u,y:d},{x:u,y:d+c}],v=[{x:u,y:d+c},{x:u+o-c,y:d+c},{x:u+o-c,y:d+l},{x:u+o,y:d+l},{x:u+o,y:d},{x:u,y:d}];t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");const x=Jr(b),w=m.path(x,y),_=Jr(v),k=m.path(_,{...y,fill:"none"}),C=s.insert(()=>k,":first-child");return C.insert(()=>w,":first-child"),C.attr("class","basic label-container"),h&&t.look!=="handDrawn"&&C.selectAll("path").attr("style",h),r&&t.look!=="handDrawn"&&C.selectAll("path").attr("style",r),a.attr("transform",`translate(${-(i.width/2)-c-(i.x-(i.left??0))}, ${-(i.height/2)+c-(i.y-(i.top??0))})`),Pn(t,C),t.intersect=function(T){return En.polygon(t,b,T)},s}ie(que,"multiRect");async function Vue(e,t){const{labelStyles:n,nodeStyles:r}=On(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await hr(e,t,ir(t)),o=Math.max(i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),l=Math.max(i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),c=l/4,u=l+c,d=-o/2,h=-u/2,m=5,{cssStyles:y}=t,b=ep(d-m,h+u+m,d+o-m,h+u+m,c,.8),v=b==null?void 0:b[b.length-1],x=[{x:d-m,y:h+m},{x:d-m,y:h+u+m},...b,{x:d+o-m,y:v.y-m},{x:d+o,y:v.y-m},{x:d+o,y:v.y-2*m},{x:d+o+m,y:v.y-2*m},{x:d+o+m,y:h-m},{x:d+m,y:h-m},{x:d+m,y:h},{x:d,y:h},{x:d,y:h+m}],w=[{x:d,y:h+m},{x:d+o-m,y:h+m},{x:d+o-m,y:v.y-m},{x:d+o,y:v.y-m},{x:d+o,y:h},{x:d,y:h}],_=Rn.svg(s),k=In(t,{});t.look!=="handDrawn"&&(k.roughness=0,k.fillStyle="solid");const C=Jr(x),T=_.path(C,k),A=Jr(w),N=_.path(A,k),I=s.insert(()=>T,":first-child");return I.insert(()=>N),I.attr("class","basic label-container"),y&&t.look!=="handDrawn"&&I.selectAll("path").attr("style",y),r&&t.look!=="handDrawn"&&I.selectAll("path").attr("style",r),I.attr("transform",`translate(0,${-c/2})`),a.attr("transform",`translate(${-(i.width/2)-m-(i.x-(i.left??0))}, ${-(i.height/2)+m-c/2-(i.y-(i.top??0))})`),Pn(t,I),t.intersect=function(j){return En.polygon(t,x,j)},s}ie(Vue,"multiWaveEdgedRectangle");async function Wue(e,t,{config:{themeVariables:n}}){var x;const{labelStyles:r,nodeStyles:s}=On(t);t.labelStyle=r,t.useHtmlLabels||((x=Go().flowchart)==null?void 0:x.htmlLabels)!==!1||(t.centerLabel=!0);const{shapeSvg:a,bbox:o}=await hr(e,t,ir(t)),l=Math.max(o.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),c=Math.max(o.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),u=-l/2,d=-c/2,{cssStyles:h}=t,m=Rn.svg(a),y=In(t,{fill:n.noteBkgColor,stroke:n.noteBorderColor});t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");const b=m.rectangle(u,d,l,c,y),v=a.insert(()=>b,":first-child");return v.attr("class","basic label-container"),h&&t.look!=="handDrawn"&&v.selectAll("path").attr("style",h),s&&t.look!=="handDrawn"&&v.selectAll("path").attr("style",s),Pn(t,v),t.intersect=function(w){return En.rect(t,w)},a}ie(Wue,"note");var llt=ie((e,t,n)=>[`M${e+n/2},${t}`,`L${e+n},${t-n/2}`,`L${e+n/2},${t-n}`,`L${e},${t-n/2}`,"Z"].join(" "),"createDecisionBoxPathD");async function Hue(e,t){const{labelStyles:n,nodeStyles:r}=On(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await hr(e,t,ir(t)),a=i.width+t.padding,o=i.height+t.padding,l=a+o,c=[{x:l/2,y:0},{x:l,y:-l/2},{x:l/2,y:-l},{x:0,y:-l/2}];let u;const{cssStyles:d}=t;if(t.look==="handDrawn"){const h=Rn.svg(s),m=In(t,{}),y=llt(0,0,l),b=h.path(y,m);u=s.insert(()=>b,":first-child").attr("transform",`translate(${-l/2}, ${l/2})`),d&&u.attr("style",d)}else u=Ef(s,l,l,c);return r&&u.attr("style",r),Pn(t,u),t.intersect=function(h){return qt.debug(`APA12 Intersect called SPLIT
point:`,h,`
node:
`,t,`
res:`,En.polygon(t,c,h)),En.polygon(t,c,h)},s}ie(Hue,"question");async function Gue(e,t){const{labelStyles:n,nodeStyles:r}=On(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await hr(e,t,ir(t)),o=Math.max(i.width+(t.padding??0),(t==null?void 0:t.width)??0),l=Math.max(i.height+(t.padding??0),(t==null?void 0:t.height)??0),c=-o/2,u=-l/2,d=u/2,h=[{x:c+d,y:u},{x:c,y:0},{x:c+d,y:-u},{x:-c,y:-u},{x:-c,y:u}],{cssStyles:m}=t,y=Rn.svg(s),b=In(t,{});t.look!=="handDrawn"&&(b.roughness=0,b.fillStyle="solid");const v=Jr(h),x=y.path(v,b),w=s.insert(()=>x,":first-child");return w.attr("class","basic label-container"),m&&t.look!=="handDrawn"&&w.selectAll("path").attr("style",m),r&&t.look!=="handDrawn"&&w.selectAll("path").attr("style",r),w.attr("transform",`translate(${-d/2},0)`),a.attr("transform",`translate(${-d/2-i.width/2-(i.x-(i.left??0))}, ${-(i.height/2)-(i.y-(i.top??0))})`),Pn(t,w),t.intersect=function(_){return En.polygon(t,h,_)},s}ie(Gue,"rect_left_inv_arrow");async function Kue(e,t){var N,I;const{labelStyles:n,nodeStyles:r}=On(t);t.labelStyle=n;let s;t.cssClasses?s="node "+t.cssClasses:s="node default";const i=e.insert("g").attr("class",s).attr("id",t.domId||t.id),a=i.insert("g"),o=i.insert("g").attr("class","label").attr("style",r),l=t.description,c=t.label,u=o.node().appendChild(await vm(c,t.labelStyle,!0,!0));let d={width:0,height:0};if(Qi((I=(N=ls())==null?void 0:N.flowchart)==null?void 0:I.htmlLabels)){const j=u.children[0],L=Zr(u);d=j.getBoundingClientRect(),L.attr("width",d.width),L.attr("height",d.height)}qt.info("Text 2",l);const h=l||[],m=u.getBBox(),y=o.node().appendChild(await vm(h.join?h.join("<br/>"):h,t.labelStyle,!0,!0)),b=y.children[0],v=Zr(y);d=b.getBoundingClientRect(),v.attr("width",d.width),v.attr("height",d.height);const x=(t.padding||0)/2;Zr(y).attr("transform","translate( "+(d.width>m.width?0:(m.width-d.width)/2)+", "+(m.height+x+5)+")"),Zr(u).attr("transform","translate( "+(d.width<m.width?0:-(m.width-d.width)/2)+", 0)"),d=o.node().getBBox(),o.attr("transform","translate("+-d.width/2+", "+(-d.height/2-x+3)+")");const w=d.width+(t.padding||0),_=d.height+(t.padding||0),k=-d.width/2-x,C=-d.height/2-x;let T,A;if(t.look==="handDrawn"){const j=Rn.svg(i),L=In(t,{}),D=j.path(kf(k,C,w,_,t.rx||0),L),H=j.line(-d.width/2-x,-d.height/2-x+m.height+x,d.width/2+x,-d.height/2-x+m.height+x,L);A=i.insert(()=>(qt.debug("Rough node insert CXC",D),H),":first-child"),T=i.insert(()=>(qt.debug("Rough node insert CXC",D),D),":first-child")}else T=a.insert("rect",":first-child"),A=a.insert("line"),T.attr("class","outer title-state").attr("style",r).attr("x",-d.width/2-x).attr("y",-d.height/2-x).attr("width",d.width+(t.padding||0)).attr("height",d.height+(t.padding||0)),A.attr("class","divider").attr("x1",-d.width/2-x).attr("x2",d.width/2+x).attr("y1",-d.height/2-x+m.height+x).attr("y2",-d.height/2-x+m.height+x);return Pn(t,T),t.intersect=function(j){return En.rect(t,j)},i}ie(Kue,"rectWithTitle");async function Yue(e,t){const n={rx:5,ry:5,labelPaddingX:((t==null?void 0:t.padding)||0)*1,labelPaddingY:((t==null?void 0:t.padding)||0)*1};return IS(e,t,n)}ie(Yue,"roundedRect");async function Zue(e,t){const{labelStyles:n,nodeStyles:r}=On(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await hr(e,t,ir(t)),o=(t==null?void 0:t.padding)??0,l=Math.max(i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),c=Math.max(i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),u=-i.width/2-o,d=-i.height/2-o,{cssStyles:h}=t,m=Rn.svg(s),y=In(t,{});t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");const b=[{x:u,y:d},{x:u+l+8,y:d},{x:u+l+8,y:d+c},{x:u-8,y:d+c},{x:u-8,y:d},{x:u,y:d},{x:u,y:d+c}],v=m.polygon(b.map(w=>[w.x,w.y]),y),x=s.insert(()=>v,":first-child");return x.attr("class","basic label-container").attr("style",yo(h)),r&&t.look!=="handDrawn"&&x.selectAll("path").attr("style",r),h&&t.look!=="handDrawn"&&x.selectAll("path").attr("style",r),a.attr("transform",`translate(${-l/2+4+(t.padding??0)-(i.x-(i.left??0))},${-c/2+(t.padding??0)-(i.y-(i.top??0))})`),Pn(t,x),t.intersect=function(w){return En.rect(t,w)},s}ie(Zue,"shadedProcess");async function Xue(e,t){const{labelStyles:n,nodeStyles:r}=On(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await hr(e,t,ir(t)),o=Math.max(i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),l=Math.max(i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),c=-o/2,u=-l/2,{cssStyles:d}=t,h=Rn.svg(s),m=In(t,{});t.look!=="handDrawn"&&(m.roughness=0,m.fillStyle="solid");const y=[{x:c,y:u},{x:c,y:u+l},{x:c+o,y:u+l},{x:c+o,y:u-l/2}],b=Jr(y),v=h.path(b,m),x=s.insert(()=>v,":first-child");return x.attr("class","basic label-container"),d&&t.look!=="handDrawn"&&x.selectChildren("path").attr("style",d),r&&t.look!=="handDrawn"&&x.selectChildren("path").attr("style",r),x.attr("transform",`translate(0, ${l/4})`),a.attr("transform",`translate(${-o/2+(t.padding??0)-(i.x-(i.left??0))}, ${-l/4+(t.padding??0)-(i.y-(i.top??0))})`),Pn(t,x),t.intersect=function(w){return En.polygon(t,y,w)},s}ie(Xue,"slopedRect");async function Jue(e,t){const n={rx:0,ry:0,labelPaddingX:((t==null?void 0:t.padding)||0)*2,labelPaddingY:((t==null?void 0:t.padding)||0)*1};return IS(e,t,n)}ie(Jue,"squareRect");async function Que(e,t){const{labelStyles:n,nodeStyles:r}=On(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await hr(e,t,ir(t)),a=i.height+t.padding,o=i.width+a/4+t.padding;let l;const{cssStyles:c}=t;if(t.look==="handDrawn"){const u=Rn.svg(s),d=In(t,{}),h=kf(-o/2,-a/2,o,a,a/2),m=u.path(h,d);l=s.insert(()=>m,":first-child"),l.attr("class","basic label-container").attr("style",yo(c))}else l=s.insert("rect",":first-child"),l.attr("class","basic label-container").attr("style",r).attr("rx",a/2).attr("ry",a/2).attr("x",-o/2).attr("y",-a/2).attr("width",o).attr("height",a);return Pn(t,l),t.intersect=function(u){return En.rect(t,u)},s}ie(Que,"stadium");async function ede(e,t){return IS(e,t,{rx:5,ry:5})}ie(ede,"state");function tde(e,t,{config:{themeVariables:n}}){const{labelStyles:r,nodeStyles:s}=On(t);t.labelStyle=r;const{cssStyles:i}=t,{lineColor:a,stateBorder:o,nodeBorder:l}=n,c=e.insert("g").attr("class","node default").attr("id",t.domId||t.id),u=Rn.svg(c),d=In(t,{});t.look!=="handDrawn"&&(d.roughness=0,d.fillStyle="solid");const h=u.circle(0,0,14,{...d,stroke:a,strokeWidth:2}),m=o??l,y=u.circle(0,0,5,{...d,fill:m,stroke:m,strokeWidth:2,fillStyle:"solid"}),b=c.insert(()=>h,":first-child");return b.insert(()=>y),i&&b.selectAll("path").attr("style",i),s&&b.selectAll("path").attr("style",s),Pn(t,b),t.intersect=function(v){return En.circle(t,7,v)},c}ie(tde,"stateEnd");function nde(e,t,{config:{themeVariables:n}}){const{lineColor:r}=n,s=e.insert("g").attr("class","node default").attr("id",t.domId||t.id);let i;if(t.look==="handDrawn"){const o=Rn.svg(s).circle(0,0,14,Uot(r));i=s.insert(()=>o),i.attr("class","state-start").attr("r",7).attr("width",14).attr("height",14)}else i=s.insert("circle",":first-child"),i.attr("class","state-start").attr("r",7).attr("width",14).attr("height",14);return Pn(t,i),t.intersect=function(a){return En.circle(t,7,a)},s}ie(nde,"stateStart");async function rde(e,t){const{labelStyles:n,nodeStyles:r}=On(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await hr(e,t,ir(t)),a=((t==null?void 0:t.padding)||0)/2,o=i.width+t.padding,l=i.height+t.padding,c=-i.width/2-a,u=-i.height/2-a,d=[{x:0,y:0},{x:o,y:0},{x:o,y:-l},{x:0,y:-l},{x:0,y:0},{x:-8,y:0},{x:o+8,y:0},{x:o+8,y:-l},{x:-8,y:-l},{x:-8,y:0}];if(t.look==="handDrawn"){const h=Rn.svg(s),m=In(t,{}),y=h.rectangle(c-8,u,o+16,l,m),b=h.line(c,u,c,u+l,m),v=h.line(c+o,u,c+o,u+l,m);s.insert(()=>b,":first-child"),s.insert(()=>v,":first-child");const x=s.insert(()=>y,":first-child"),{cssStyles:w}=t;x.attr("class","basic label-container").attr("style",yo(w)),Pn(t,x)}else{const h=Ef(s,o,l,d);r&&h.attr("style",r),Pn(t,h)}return t.intersect=function(h){return En.polygon(t,d,h)},s}ie(rde,"subroutine");async function sde(e,t){const{labelStyles:n,nodeStyles:r}=On(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await hr(e,t,ir(t)),a=Math.max(i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),o=Math.max(i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),l=-a/2,c=-o/2,u=.2*o,d=.2*o,{cssStyles:h}=t,m=Rn.svg(s),y=In(t,{}),b=[{x:l-u/2,y:c},{x:l+a+u/2,y:c},{x:l+a+u/2,y:c+o},{x:l-u/2,y:c+o}],v=[{x:l+a-u/2,y:c+o},{x:l+a+u/2,y:c+o},{x:l+a+u/2,y:c+o-d}];t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");const x=Jr(b),w=m.path(x,y),_=Jr(v),k=m.path(_,{...y,fillStyle:"solid"}),C=s.insert(()=>k,":first-child");return C.insert(()=>w,":first-child"),C.attr("class","basic label-container"),h&&t.look!=="handDrawn"&&C.selectAll("path").attr("style",h),r&&t.look!=="handDrawn"&&C.selectAll("path").attr("style",r),Pn(t,C),t.intersect=function(T){return En.polygon(t,b,T)},s}ie(sde,"taggedRect");async function ide(e,t){const{labelStyles:n,nodeStyles:r}=On(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await hr(e,t,ir(t)),o=Math.max(i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),l=Math.max(i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),c=l/4,u=.2*o,d=.2*l,h=l+c,{cssStyles:m}=t,y=Rn.svg(s),b=In(t,{});t.look!=="handDrawn"&&(b.roughness=0,b.fillStyle="solid");const v=[{x:-o/2-o/2*.1,y:h/2},...ep(-o/2-o/2*.1,h/2,o/2+o/2*.1,h/2,c,.8),{x:o/2+o/2*.1,y:-h/2},{x:-o/2-o/2*.1,y:-h/2}],x=-o/2+o/2*.1,w=-h/2-d*.4,_=[{x:x+o-u,y:(w+l)*1.4},{x:x+o,y:w+l-d},{x:x+o,y:(w+l)*.9},...ep(x+o,(w+l)*1.3,x+o-u,(w+l)*1.5,-l*.03,.5)],k=Jr(v),C=y.path(k,b),T=Jr(_),A=y.path(T,{...b,fillStyle:"solid"}),N=s.insert(()=>A,":first-child");return N.insert(()=>C,":first-child"),N.attr("class","basic label-container"),m&&t.look!=="handDrawn"&&N.selectAll("path").attr("style",m),r&&t.look!=="handDrawn"&&N.selectAll("path").attr("style",r),N.attr("transform",`translate(0,${-c/2})`),a.attr("transform",`translate(${-o/2+(t.padding??0)-(i.x-(i.left??0))},${-l/2+(t.padding??0)-c/2-(i.y-(i.top??0))})`),Pn(t,N),t.intersect=function(I){return En.polygon(t,v,I)},s}ie(ide,"taggedWaveEdgedRectangle");async function ade(e,t){const{labelStyles:n,nodeStyles:r}=On(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await hr(e,t,ir(t)),a=Math.max(i.width+t.padding,(t==null?void 0:t.width)||0),o=Math.max(i.height+t.padding,(t==null?void 0:t.height)||0),l=-a/2,c=-o/2,u=s.insert("rect",":first-child");return u.attr("class","text").attr("style",r).attr("rx",0).attr("ry",0).attr("x",l).attr("y",c).attr("width",a).attr("height",o),Pn(t,u),t.intersect=function(d){return En.rect(t,d)},s}ie(ade,"text");var clt=ie((e,t,n,r,s,i)=>`M${e},${t}
    a${s},${i} 0,0,1 0,${-r}
    l${n},0
    a${s},${i} 0,0,1 0,${r}
    M${n},${-r}
    a${s},${i} 0,0,0 0,${r}
    l${-n},0`,"createCylinderPathD"),ult=ie((e,t,n,r,s,i)=>[`M${e},${t}`,`M${e+n},${t}`,`a${s},${i} 0,0,0 0,${-r}`,`l${-n},0`,`a${s},${i} 0,0,0 0,${r}`,`l${n},0`].join(" "),"createOuterCylinderPathD"),dlt=ie((e,t,n,r,s,i)=>[`M${e+n/2},${-r/2}`,`a${s},${i} 0,0,0 0,${r}`].join(" "),"createInnerCylinderPathD");async function ode(e,t){const{labelStyles:n,nodeStyles:r}=On(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a,halfPadding:o}=await hr(e,t,ir(t)),l=t.look==="neo"?o*2:o,c=i.height+l,u=c/2,d=u/(2.5+c/50),h=i.width+d+l,{cssStyles:m}=t;let y;if(t.look==="handDrawn"){const b=Rn.svg(s),v=ult(0,0,h,c,d,u),x=dlt(0,0,h,c,d,u),w=b.path(v,In(t,{})),_=b.path(x,In(t,{fill:"none"}));y=s.insert(()=>_,":first-child"),y=s.insert(()=>w,":first-child"),y.attr("class","basic label-container"),m&&y.attr("style",m)}else{const b=clt(0,0,h,c,d,u);y=s.insert("path",":first-child").attr("d",b).attr("class","basic label-container").attr("style",yo(m)).attr("style",r),y.attr("class","basic label-container"),m&&y.selectAll("path").attr("style",m),r&&y.selectAll("path").attr("style",r)}return y.attr("label-offset-x",d),y.attr("transform",`translate(${-h/2}, ${c/2} )`),a.attr("transform",`translate(${-(i.width/2)-d-(i.x-(i.left??0))}, ${-(i.height/2)-(i.y-(i.top??0))})`),Pn(t,y),t.intersect=function(b){const v=En.rect(t,b),x=v.y-(t.y??0);if(u!=0&&(Math.abs(x)<(t.height??0)/2||Math.abs(x)==(t.height??0)/2&&Math.abs(v.x-(t.x??0))>(t.width??0)/2-d)){let w=d*d*(1-x*x/(u*u));w!=0&&(w=Math.sqrt(Math.abs(w))),w=d-w,b.x-(t.x??0)>0&&(w=-w),v.x+=w}return v},s}ie(ode,"tiltedCylinder");async function lde(e,t){const{labelStyles:n,nodeStyles:r}=On(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await hr(e,t,ir(t)),a=i.width+t.padding,o=i.height+t.padding,l=[{x:-3*o/6,y:0},{x:a+3*o/6,y:0},{x:a,y:-o},{x:0,y:-o}];let c;const{cssStyles:u}=t;if(t.look==="handDrawn"){const d=Rn.svg(s),h=In(t,{}),m=Jr(l),y=d.path(m,h);c=s.insert(()=>y,":first-child").attr("transform",`translate(${-a/2}, ${o/2})`),u&&c.attr("style",u)}else c=Ef(s,a,o,l);return r&&c.attr("style",r),t.width=a,t.height=o,Pn(t,c),t.intersect=function(d){return En.polygon(t,l,d)},s}ie(lde,"trapezoid");async function cde(e,t){const{labelStyles:n,nodeStyles:r}=On(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await hr(e,t,ir(t)),a=60,o=20,l=Math.max(a,i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),c=Math.max(o,i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),{cssStyles:u}=t,d=Rn.svg(s),h=In(t,{});t.look!=="handDrawn"&&(h.roughness=0,h.fillStyle="solid");const m=[{x:-l/2*.8,y:-c/2},{x:l/2*.8,y:-c/2},{x:l/2,y:-c/2*.6},{x:l/2,y:c/2},{x:-l/2,y:c/2},{x:-l/2,y:-c/2*.6}],y=Jr(m),b=d.path(y,h),v=s.insert(()=>b,":first-child");return v.attr("class","basic label-container"),u&&t.look!=="handDrawn"&&v.selectChildren("path").attr("style",u),r&&t.look!=="handDrawn"&&v.selectChildren("path").attr("style",r),Pn(t,v),t.intersect=function(x){return En.polygon(t,m,x)},s}ie(cde,"trapezoidalPentagon");async function ude(e,t){var w;const{labelStyles:n,nodeStyles:r}=On(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await hr(e,t,ir(t)),o=Qi((w=ls().flowchart)==null?void 0:w.htmlLabels),l=i.width+(t.padding??0),c=l+i.height,u=l+i.height,d=[{x:0,y:0},{x:u,y:0},{x:u/2,y:-c}],{cssStyles:h}=t,m=Rn.svg(s),y=In(t,{});t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");const b=Jr(d),v=m.path(b,y),x=s.insert(()=>v,":first-child").attr("transform",`translate(${-c/2}, ${c/2})`);return h&&t.look!=="handDrawn"&&x.selectChildren("path").attr("style",h),r&&t.look!=="handDrawn"&&x.selectChildren("path").attr("style",r),t.width=l,t.height=c,Pn(t,x),a.attr("transform",`translate(${-i.width/2-(i.x-(i.left??0))}, ${c/2-(i.height+(t.padding??0)/(o?2:1)-(i.y-(i.top??0)))})`),t.intersect=function(_){return qt.info("Triangle intersect",t,d,_),En.polygon(t,d,_)},s}ie(ude,"triangle");async function dde(e,t){const{labelStyles:n,nodeStyles:r}=On(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await hr(e,t,ir(t)),o=Math.max(i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),l=Math.max(i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),c=l/8,u=l+c,{cssStyles:d}=t,m=70-o,y=m>0?m/2:0,b=Rn.svg(s),v=In(t,{});t.look!=="handDrawn"&&(v.roughness=0,v.fillStyle="solid");const x=[{x:-o/2-y,y:u/2},...ep(-o/2-y,u/2,o/2+y,u/2,c,.8),{x:o/2+y,y:-u/2},{x:-o/2-y,y:-u/2}],w=Jr(x),_=b.path(w,v),k=s.insert(()=>_,":first-child");return k.attr("class","basic label-container"),d&&t.look!=="handDrawn"&&k.selectAll("path").attr("style",d),r&&t.look!=="handDrawn"&&k.selectAll("path").attr("style",r),k.attr("transform",`translate(0,${-c/2})`),a.attr("transform",`translate(${-o/2+(t.padding??0)-(i.x-(i.left??0))},${-l/2+(t.padding??0)-c-(i.y-(i.top??0))})`),Pn(t,k),t.intersect=function(C){return En.polygon(t,x,C)},s}ie(dde,"waveEdgedRectangle");async function fde(e,t){const{labelStyles:n,nodeStyles:r}=On(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await hr(e,t,ir(t)),a=100,o=50,l=Math.max(i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),c=Math.max(i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),u=l/c;let d=l,h=c;d>h*u?h=d/u:d=h*u,d=Math.max(d,a),h=Math.max(h,o);const m=Math.min(h*.2,h/4),y=h+m*2,{cssStyles:b}=t,v=Rn.svg(s),x=In(t,{});t.look!=="handDrawn"&&(x.roughness=0,x.fillStyle="solid");const w=[{x:-d/2,y:y/2},...ep(-d/2,y/2,d/2,y/2,m,1),{x:d/2,y:-y/2},...ep(d/2,-y/2,-d/2,-y/2,m,-1)],_=Jr(w),k=v.path(_,x),C=s.insert(()=>k,":first-child");return C.attr("class","basic label-container"),b&&t.look!=="handDrawn"&&C.selectAll("path").attr("style",b),r&&t.look!=="handDrawn"&&C.selectAll("path").attr("style",r),Pn(t,C),t.intersect=function(T){return En.polygon(t,w,T)},s}ie(fde,"waveRectangle");async function hde(e,t){const{labelStyles:n,nodeStyles:r}=On(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await hr(e,t,ir(t)),o=Math.max(i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),l=Math.max(i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),c=5,u=-o/2,d=-l/2,{cssStyles:h}=t,m=Rn.svg(s),y=In(t,{}),b=[{x:u-c,y:d-c},{x:u-c,y:d+l},{x:u+o,y:d+l},{x:u+o,y:d-c}],v=`M${u-c},${d-c} L${u+o},${d-c} L${u+o},${d+l} L${u-c},${d+l} L${u-c},${d-c}
                M${u-c},${d} L${u+o},${d}
                M${u},${d-c} L${u},${d+l}`;t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");const x=m.path(v,y),w=s.insert(()=>x,":first-child");return w.attr("transform",`translate(${c/2}, ${c/2})`),w.attr("class","basic label-container"),h&&t.look!=="handDrawn"&&w.selectAll("path").attr("style",h),r&&t.look!=="handDrawn"&&w.selectAll("path").attr("style",r),a.attr("transform",`translate(${-(i.width/2)+c/2-(i.x-(i.left??0))}, ${-(i.height/2)+c/2-(i.y-(i.top??0))})`),Pn(t,w),t.intersect=function(_){return En.polygon(t,b,_)},s}ie(hde,"windowPane");async function T5(e,t){var ne,V,Q;const n=t;if(n.alias&&(t.label=n.alias),t.look==="handDrawn"){const{themeVariables:ee}=Go(),{background:re}=ee,de={...t,id:t.id+"-background",look:"default",cssStyles:["stroke: none",`fill: ${re}`]};await T5(e,de)}const r=Go();t.useHtmlLabels=r.htmlLabels;let s=((ne=r.er)==null?void 0:ne.diagramPadding)??10,i=((V=r.er)==null?void 0:V.entityPadding)??6;const{cssStyles:a}=t,{labelStyles:o}=On(t);if(n.attributes.length===0&&t.label){const ee={rx:0,ry:0,labelPaddingX:s,labelPaddingY:s*1.5};pf(t.label,r)+ee.labelPaddingX*2<r.er.minEntityWidth&&(t.width=r.er.minEntityWidth);const re=await IS(e,t,ee);if(!Qi(r.htmlLabels)){const de=re.select("text"),me=(Q=de.node())==null?void 0:Q.getBBox();de.attr("transform",`translate(${-me.width/2}, 0)`)}return re}r.htmlLabels||(s*=1.25,i*=1.25);let l=ir(t);l||(l="node default");const c=e.insert("g").attr("class",l).attr("id",t.domId||t.id),u=await T0(c,t.label??"",r,0,0,["name"],o);u.height+=i;let d=0;const h=[];let m=0,y=0,b=0,v=0,x=!0,w=!0;for(const ee of n.attributes){const re=await T0(c,ee.type,r,0,d,["attribute-type"],o);m=Math.max(m,re.width+s);const de=await T0(c,ee.name,r,0,d,["attribute-name"],o);y=Math.max(y,de.width+s);const me=await T0(c,ee.keys.join(),r,0,d,["attribute-keys"],o);b=Math.max(b,me.width+s);const De=await T0(c,ee.comment,r,0,d,["attribute-comment"],o);v=Math.max(v,De.width+s),d+=Math.max(re.height,de.height,me.height,De.height)+i,h.push(d)}h.pop();let _=4;b<=s&&(x=!1,b=0,_--),v<=s&&(w=!1,v=0,_--);const k=c.node().getBBox();if(u.width+s*2-(m+y+b+v)>0){const ee=u.width+s*2-(m+y+b+v);m+=ee/_,y+=ee/_,b>0&&(b+=ee/_),v>0&&(v+=ee/_)}const C=m+y+b+v,T=Rn.svg(c),A=In(t,{});t.look!=="handDrawn"&&(A.roughness=0,A.fillStyle="solid");const N=Math.max(k.width+s*2,(t==null?void 0:t.width)||0,C),I=Math.max(k.height+(h[0]||d)+i,(t==null?void 0:t.height)||0),j=-N/2,L=-I/2;c.selectAll("g:not(:first-child)").each((ee,re,de)=>{const me=Zr(de[re]),De=me.attr("transform");let je=0,Te=0;if(De){const Ue=RegExp(/translate\(([^,]+),([^)]+)\)/).exec(De);Ue&&(je=parseFloat(Ue[1]),Te=parseFloat(Ue[2]),me.attr("class").includes("attribute-name")?je+=m:me.attr("class").includes("attribute-keys")?je+=m+y:me.attr("class").includes("attribute-comment")&&(je+=m+y+b))}me.attr("transform",`translate(${j+s/2+je}, ${Te+L+u.height+i/2})`)}),c.select(".name").attr("transform","translate("+-u.width/2+", "+(L+i/2)+")");const D=T.rectangle(j,L,N,I,A),H=c.insert(()=>D,":first-child").attr("style",a.join("")),{themeVariables:O}=Go(),{rowEven:K,rowOdd:U,nodeBorder:W}=O;h.push(0);for(const[ee,re]of h.entries()){if(ee===0&&h.length>1)continue;const de=ee%2===0&&re!==0,me=T.rectangle(j,u.height+L+re,N,u.height,{...A,fill:de?K:U,stroke:W});c.insert(()=>me,"g.label").attr("style",a.join("")).attr("class",`row-rect-${ee%2===0?"even":"odd"}`)}let B=T.line(j,u.height+L,N+j,u.height+L,A);c.insert(()=>B).attr("class","divider"),B=T.line(m+j,u.height+L,m+j,I+L,A),c.insert(()=>B).attr("class","divider"),x&&(B=T.line(m+y+j,u.height+L,m+y+j,I+L,A),c.insert(()=>B).attr("class","divider")),w&&(B=T.line(m+y+b+j,u.height+L,m+y+b+j,I+L,A),c.insert(()=>B).attr("class","divider"));for(const ee of h)B=T.line(j,u.height+L+ee,N+j,u.height+L+ee,A),c.insert(()=>B).attr("class","divider");return Pn(t,H),t.intersect=function(ee){return En.rect(t,ee)},c}ie(T5,"erBox");async function T0(e,t,n,r=0,s=0,i=[],a=""){const o=e.insert("g").attr("class",`label ${i.join(" ")}`).attr("transform",`translate(${r}, ${s})`).attr("style",a);t!==VV(t)&&(t=VV(t),t=t.replaceAll("<","&lt;").replaceAll(">","&gt;"));const l=o.node().appendChild(await Sp(o,t,{width:pf(t,n)+100,style:a,useHtmlLabels:n.htmlLabels},n));if(t.includes("&lt;")||t.includes("&gt;")){let u=l.children[0];for(u.textContent=u.textContent.replaceAll("&lt;","<").replaceAll("&gt;",">");u.childNodes[0];)u=u.childNodes[0],u.textContent=u.textContent.replaceAll("&lt;","<").replaceAll("&gt;",">")}let c=l.getBBox();if(Qi(n.htmlLabels)){const u=l.children[0];u.style.textAlign="start";const d=Zr(l);c=u.getBoundingClientRect(),d.attr("width",c.width),d.attr("height",c.height)}return c}ie(T0,"addText");async function pde(e,t,n,r,s=n.class.padding??12){const i=r?0:3,a=e.insert("g").attr("class",ir(t)).attr("id",t.domId||t.id);let o=null,l=null,c=null,u=null,d=0,h=0,m=0;if(o=a.insert("g").attr("class","annotation-group text"),t.annotations.length>0){const w=t.annotations[0];await Mx(o,{text:`«${w}»`},0),d=o.node().getBBox().height}l=a.insert("g").attr("class","label-group text"),await Mx(l,t,0,["font-weight: bolder"]);const y=l.node().getBBox();h=y.height,c=a.insert("g").attr("class","members-group text");let b=0;for(const w of t.members){const _=await Mx(c,w,b,[w.parseClassifier()]);b+=_+i}m=c.node().getBBox().height,m<=0&&(m=s/2),u=a.insert("g").attr("class","methods-group text");let v=0;for(const w of t.methods){const _=await Mx(u,w,v,[w.parseClassifier()]);v+=_+i}let x=a.node().getBBox();if(o!==null){const w=o.node().getBBox();o.attr("transform",`translate(${-w.width/2})`)}return l.attr("transform",`translate(${-y.width/2}, ${d})`),x=a.node().getBBox(),c.attr("transform",`translate(0, ${d+h+s*2})`),x=a.node().getBBox(),u.attr("transform",`translate(0, ${d+h+(m?m+s*4:s*2)})`),x=a.node().getBBox(),{shapeSvg:a,bbox:x}}ie(pde,"textHelper");async function Mx(e,t,n,r=[]){const s=e.insert("g").attr("class","label").attr("style",r.join("; ")),i=Go();let a="useHtmlLabels"in t?t.useHtmlLabels:Qi(i.htmlLabels)??!0,o="";"text"in t?o=t.text:o=t.label,!a&&o.startsWith("\\")&&(o=o.substring(1)),qy(o)&&(a=!0);const l=await Sp(s,F6(yg(o)),{width:pf(o,i)+50,classes:"markdown-node-label",useHtmlLabels:a},i);let c,u=1;if(a){const d=l.children[0],h=Zr(l);u=d.innerHTML.split("<br>").length,d.innerHTML.includes("</math>")&&(u+=d.innerHTML.split("<mrow>").length-1);const m=d.getElementsByTagName("img");if(m){const y=o.replace(/<img[^>]*>/g,"").trim()==="";await Promise.all([...m].map(b=>new Promise(v=>{function x(){var w;if(b.style.display="flex",b.style.flexDirection="column",y){const _=((w=i.fontSize)==null?void 0:w.toString())??window.getComputedStyle(document.body).fontSize,C=parseInt(_,10)*5+"px";b.style.minWidth=C,b.style.maxWidth=C}else b.style.width="100%";v(b)}ie(x,"setupImage"),setTimeout(()=>{b.complete&&x()}),b.addEventListener("error",x),b.addEventListener("load",x)})))}c=d.getBoundingClientRect(),h.attr("width",c.width),h.attr("height",c.height)}else{r.includes("font-weight: bolder")&&Zr(l).selectAll("tspan").attr("font-weight",""),u=l.children.length;const d=l.children[0];(l.textContent===""||l.textContent.includes("&gt"))&&(d.textContent=o[0]+o.substring(1).replaceAll("&gt;",">").replaceAll("&lt;","<").trim(),o[1]===" "&&(d.textContent=d.textContent[0]+" "+d.textContent.substring(1))),d.textContent==="undefined"&&(d.textContent=""),c=l.getBBox()}return s.attr("transform","translate(0,"+(-c.height/(2*u)+n)+")"),c.height}ie(Mx,"addText");async function mde(e,t){var I,j;const n=ls(),r=n.class.padding??12,s=r,i=t.useHtmlLabels??Qi(n.htmlLabels)??!0,a=t;a.annotations=a.annotations??[],a.members=a.members??[],a.methods=a.methods??[];const{shapeSvg:o,bbox:l}=await pde(e,t,n,i,s),{labelStyles:c,nodeStyles:u}=On(t);t.labelStyle=c,t.cssStyles=a.styles||"";const d=((I=a.styles)==null?void 0:I.join(";"))||u||"";t.cssStyles||(t.cssStyles=d.replaceAll("!important","").split(";"));const h=a.members.length===0&&a.methods.length===0&&!((j=n.class)!=null&&j.hideEmptyMembersBox),m=Rn.svg(o),y=In(t,{});t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");const b=l.width;let v=l.height;a.members.length===0&&a.methods.length===0?v+=s:a.members.length>0&&a.methods.length===0&&(v+=s*2);const x=-b/2,w=-v/2,_=m.rectangle(x-r,w-r-(h?r:a.members.length===0&&a.methods.length===0?-r/2:0),b+2*r,v+2*r+(h?r*2:a.members.length===0&&a.methods.length===0?-r:0),y),k=o.insert(()=>_,":first-child");k.attr("class","basic label-container");const C=k.node().getBBox();o.selectAll(".text").each((L,D,H)=>{var ne;const O=Zr(H[D]),K=O.attr("transform");let U=0;if(K){const Q=RegExp(/translate\(([^,]+),([^)]+)\)/).exec(K);Q&&(U=parseFloat(Q[2]))}let W=U+w+r-(h?r:a.members.length===0&&a.methods.length===0?-r/2:0);i||(W-=4);let B=x;(O.attr("class").includes("label-group")||O.attr("class").includes("annotation-group"))&&(B=-((ne=O.node())==null?void 0:ne.getBBox().width)/2||0,o.selectAll("text").each(function(V,Q,ee){window.getComputedStyle(ee[Q]).textAnchor==="middle"&&(B=0)})),O.attr("transform",`translate(${B}, ${W})`)});const T=o.select(".annotation-group").node().getBBox().height-(h?r/2:0)||0,A=o.select(".label-group").node().getBBox().height-(h?r/2:0)||0,N=o.select(".members-group").node().getBBox().height-(h?r/2:0)||0;if(a.members.length>0||a.methods.length>0||h){const L=m.line(C.x,T+A+w+r,C.x+C.width,T+A+w+r,y);o.insert(()=>L).attr("class","divider").attr("style",d)}if(h||a.members.length>0||a.methods.length>0){const L=m.line(C.x,T+A+N+w+s*2+r,C.x+C.width,T+A+N+w+r+s*2,y);o.insert(()=>L).attr("class","divider").attr("style",d)}if(a.look!=="handDrawn"&&o.selectAll("path").attr("style",d),k.select(":nth-child(2)").attr("style",d),o.selectAll(".divider").select("path").attr("style",d),t.labelStyle?o.selectAll("span").attr("style",t.labelStyle):o.selectAll("span").attr("style",d),!i){const L=RegExp(/color\s*:\s*([^;]*)/),D=L.exec(d);if(D){const H=D[0].replace("color","fill");o.selectAll("tspan").attr("style",H)}else if(c){const H=L.exec(c);if(H){const O=H[0].replace("color","fill");o.selectAll("tspan").attr("style",O)}}}return Pn(t,k),t.intersect=function(L){return En.rect(t,L)},o}ie(mde,"classBox");async function gde(e,t){var T,A;const{labelStyles:n,nodeStyles:r}=On(t);t.labelStyle=n;const s=t,i=t,a=20,o=20,l="verifyMethod"in t,c=ir(t),u=e.insert("g").attr("class",c).attr("id",t.domId??t.id);let d;l?d=await bu(u,`&lt;&lt;${s.type}&gt;&gt;`,0,t.labelStyle):d=await bu(u,"&lt;&lt;Element&gt;&gt;",0,t.labelStyle);let h=d;const m=await bu(u,s.name,h,t.labelStyle+"; font-weight: bold;");if(h+=m+o,l){const N=await bu(u,`${s.requirementId?`Id: ${s.requirementId}`:""}`,h,t.labelStyle);h+=N;const I=await bu(u,`${s.text?`Text: ${s.text}`:""}`,h,t.labelStyle);h+=I;const j=await bu(u,`${s.risk?`Risk: ${s.risk}`:""}`,h,t.labelStyle);h+=j,await bu(u,`${s.verifyMethod?`Verification: ${s.verifyMethod}`:""}`,h,t.labelStyle)}else{const N=await bu(u,`${i.type?`Type: ${i.type}`:""}`,h,t.labelStyle);h+=N,await bu(u,`${i.docRef?`Doc Ref: ${i.docRef}`:""}`,h,t.labelStyle)}const y=(((T=u.node())==null?void 0:T.getBBox().width)??200)+a,b=(((A=u.node())==null?void 0:A.getBBox().height)??200)+a,v=-y/2,x=-b/2,w=Rn.svg(u),_=In(t,{});t.look!=="handDrawn"&&(_.roughness=0,_.fillStyle="solid");const k=w.rectangle(v,x,y,b,_),C=u.insert(()=>k,":first-child");if(C.attr("class","basic label-container").attr("style",r),u.selectAll(".label").each((N,I,j)=>{const L=Zr(j[I]),D=L.attr("transform");let H=0,O=0;if(D){const B=RegExp(/translate\(([^,]+),([^)]+)\)/).exec(D);B&&(H=parseFloat(B[1]),O=parseFloat(B[2]))}const K=O-b/2;let U=v+a/2;(I===0||I===1)&&(U=H),L.attr("transform",`translate(${U}, ${K+a})`)}),h>d+m+o){const N=w.line(v,x+d+m+o,v+y,x+d+m+o,_);u.insert(()=>N).attr("style",r)}return Pn(t,C),t.intersect=function(N){return En.rect(t,N)},u}ie(gde,"requirementBox");async function bu(e,t,n,r=""){if(t==="")return 0;const s=e.insert("g").attr("class","label").attr("style",r),i=ls(),a=i.htmlLabels??!0,o=await Sp(s,F6(yg(t)),{width:pf(t,i)+50,classes:"markdown-node-label",useHtmlLabels:a,style:r},i);let l;if(a){const c=o.children[0],u=Zr(o);l=c.getBoundingClientRect(),u.attr("width",l.width),u.attr("height",l.height)}else{const c=o.children[0];for(const u of c.children)u.textContent=u.textContent.replaceAll("&gt;",">").replaceAll("&lt;","<"),r&&u.setAttribute("style",r);l=o.getBBox(),l.height+=6}return s.attr("transform",`translate(${-l.width/2},${-l.height/2+n})`),l.height}ie(bu,"addText");var flt=ie(e=>{switch(e){case"Very High":return"red";case"High":return"orange";case"Medium":return null;case"Low":return"blue";case"Very Low":return"lightblue"}},"colorFromPriority");async function yde(e,t,{config:n}){var D,H;const{labelStyles:r,nodeStyles:s}=On(t);t.labelStyle=r||"";const i=10,a=t.width;t.width=(t.width??200)-10;const{shapeSvg:o,bbox:l,label:c}=await hr(e,t,ir(t)),u=t.padding||10;let d="",h;"ticket"in t&&t.ticket&&((D=n==null?void 0:n.kanban)!=null&&D.ticketBaseUrl)&&(d=(H=n==null?void 0:n.kanban)==null?void 0:H.ticketBaseUrl.replace("#TICKET#",t.ticket),h=o.insert("svg:a",":first-child").attr("class","kanban-ticket-link").attr("xlink:href",d).attr("target","_blank"));const m={useHtmlLabels:t.useHtmlLabels,labelStyle:t.labelStyle||"",width:t.width,img:t.img,padding:t.padding||8,centerLabel:!1};let y,b;h?{label:y,bbox:b}=await Jj(h,"ticket"in t&&t.ticket||"",m):{label:y,bbox:b}=await Jj(o,"ticket"in t&&t.ticket||"",m);const{label:v,bbox:x}=await Jj(o,"assigned"in t&&t.assigned||"",m);t.width=a;const w=10,_=(t==null?void 0:t.width)||0,k=Math.max(b.height,x.height)/2,C=Math.max(l.height+w*2,(t==null?void 0:t.height)||0)+k,T=-_/2,A=-C/2;c.attr("transform","translate("+(u-_/2)+", "+(-k-l.height/2)+")"),y.attr("transform","translate("+(u-_/2)+", "+(-k+l.height/2)+")"),v.attr("transform","translate("+(u+_/2-x.width-2*i)+", "+(-k+l.height/2)+")");let N;const{rx:I,ry:j}=t,{cssStyles:L}=t;if(t.look==="handDrawn"){const O=Rn.svg(o),K=In(t,{}),U=I||j?O.path(kf(T,A,_,C,I||0),K):O.rectangle(T,A,_,C,K);N=o.insert(()=>U,":first-child"),N.attr("class","basic label-container").attr("style",L||null)}else{N=o.insert("rect",":first-child"),N.attr("class","basic label-container __APA__").attr("style",s).attr("rx",I??5).attr("ry",j??5).attr("x",T).attr("y",A).attr("width",_).attr("height",C);const O="priority"in t&&t.priority;if(O){const K=o.append("line"),U=T+2,W=A+Math.floor((I??0)/2),B=A+C-Math.floor((I??0)/2);K.attr("x1",U).attr("y1",W).attr("x2",U).attr("y2",B).attr("stroke-width","4").attr("stroke",flt(O))}}return Pn(t,N),t.height=C,t.intersect=function(O){return En.rect(t,O)},o}ie(yde,"kanbanItem");var hlt=[{semanticName:"Process",name:"Rectangle",shortName:"rect",description:"Standard process shape",aliases:["proc","process","rectangle"],internalAliases:["squareRect"],handler:Jue},{semanticName:"Event",name:"Rounded Rectangle",shortName:"rounded",description:"Represents an event",aliases:["event"],internalAliases:["roundedRect"],handler:Yue},{semanticName:"Terminal Point",name:"Stadium",shortName:"stadium",description:"Terminal point",aliases:["terminal","pill"],handler:Que},{semanticName:"Subprocess",name:"Framed Rectangle",shortName:"fr-rect",description:"Subprocess",aliases:["subprocess","subproc","framed-rectangle","subroutine"],handler:rde},{semanticName:"Database",name:"Cylinder",shortName:"cyl",description:"Database storage",aliases:["db","database","cylinder"],handler:Sue},{semanticName:"Start",name:"Circle",shortName:"circle",description:"Starting point",aliases:["circ"],handler:mue},{semanticName:"Decision",name:"Diamond",shortName:"diam",description:"Decision-making step",aliases:["decision","diamond","question"],handler:Hue},{semanticName:"Prepare Conditional",name:"Hexagon",shortName:"hex",description:"Preparation or condition step",aliases:["hexagon","prepare"],handler:Rue},{semanticName:"Data Input/Output",name:"Lean Right",shortName:"lean-r",description:"Represents input or output",aliases:["lean-right","in-out"],internalAliases:["lean_right"],handler:Bue},{semanticName:"Data Input/Output",name:"Lean Left",shortName:"lean-l",description:"Represents output or input",aliases:["lean-left","out-in"],internalAliases:["lean_left"],handler:Lue},{semanticName:"Priority Action",name:"Trapezoid Base Bottom",shortName:"trap-b",description:"Priority action",aliases:["priority","trapezoid-bottom","trapezoid"],handler:lde},{semanticName:"Manual Operation",name:"Trapezoid Base Top",shortName:"trap-t",description:"Represents a manual task",aliases:["manual","trapezoid-top","inv-trapezoid"],internalAliases:["inv_trapezoid"],handler:Due},{semanticName:"Stop",name:"Double Circle",shortName:"dbl-circ",description:"Represents a stop point",aliases:["double-circle"],internalAliases:["doublecircle"],handler:Cue},{semanticName:"Text Block",name:"Text Block",shortName:"text",description:"Text block",handler:ade},{semanticName:"Card",name:"Notched Rectangle",shortName:"notch-rect",description:"Represents a card",aliases:["card","notched-rectangle"],handler:hue},{semanticName:"Lined/Shaded Process",name:"Lined Rectangle",shortName:"lin-rect",description:"Lined process shape",aliases:["lined-rectangle","lined-process","lin-proc","shaded-process"],handler:Zue},{semanticName:"Start",name:"Small Circle",shortName:"sm-circ",description:"Small starting point",aliases:["start","small-circle"],internalAliases:["stateStart"],handler:nde},{semanticName:"Stop",name:"Framed Circle",shortName:"fr-circ",description:"Stop point",aliases:["stop","framed-circle"],internalAliases:["stateEnd"],handler:tde},{semanticName:"Fork/Join",name:"Filled Rectangle",shortName:"fork",description:"Fork or join in process flow",aliases:["join"],internalAliases:["forkJoin"],handler:Tue},{semanticName:"Collate",name:"Hourglass",shortName:"hourglass",description:"Represents a collate operation",aliases:["hourglass","collate"],handler:Nue},{semanticName:"Comment",name:"Curly Brace",shortName:"brace",description:"Adds a comment",aliases:["comment","brace-l"],handler:bue},{semanticName:"Comment Right",name:"Curly Brace",shortName:"brace-r",description:"Adds a comment",handler:vue},{semanticName:"Comment with braces on both sides",name:"Curly Braces",shortName:"braces",description:"Adds a comment",handler:xue},{semanticName:"Com Link",name:"Lightning Bolt",shortName:"bolt",description:"Communication link",aliases:["com-link","lightning-bolt"],handler:$ue},{semanticName:"Document",name:"Document",shortName:"doc",description:"Represents a document",aliases:["doc","document"],handler:dde},{semanticName:"Delay",name:"Half-Rounded Rectangle",shortName:"delay",description:"Represents a delay",aliases:["half-rounded-rectangle"],handler:Aue},{semanticName:"Direct Access Storage",name:"Horizontal Cylinder",shortName:"h-cyl",description:"Direct access storage",aliases:["das","horizontal-cylinder"],handler:ode},{semanticName:"Disk Storage",name:"Lined Cylinder",shortName:"lin-cyl",description:"Disk storage",aliases:["disk","lined-cylinder"],handler:zue},{semanticName:"Display",name:"Curved Trapezoid",shortName:"curv-trap",description:"Represents a display",aliases:["curved-trapezoid","display"],handler:wue},{semanticName:"Divided Process",name:"Divided Rectangle",shortName:"div-rect",description:"Divided process shape",aliases:["div-proc","divided-rectangle","divided-process"],handler:_ue},{semanticName:"Extract",name:"Triangle",shortName:"tri",description:"Extraction process",aliases:["extract","triangle"],handler:ude},{semanticName:"Internal Storage",name:"Window Pane",shortName:"win-pane",description:"Internal storage",aliases:["internal-storage","window-pane"],handler:hde},{semanticName:"Junction",name:"Filled Circle",shortName:"f-circ",description:"Junction point",aliases:["junction","filled-circle"],handler:kue},{semanticName:"Loop Limit",name:"Trapezoidal Pentagon",shortName:"notch-pent",description:"Loop limit step",aliases:["loop-limit","notched-pentagon"],handler:cde},{semanticName:"Manual File",name:"Flipped Triangle",shortName:"flip-tri",description:"Manual file operation",aliases:["manual-file","flipped-triangle"],handler:Eue},{semanticName:"Manual Input",name:"Sloped Rectangle",shortName:"sl-rect",description:"Manual input step",aliases:["manual-input","sloped-rectangle"],handler:Xue},{semanticName:"Multi-Document",name:"Stacked Document",shortName:"docs",description:"Multiple documents",aliases:["documents","st-doc","stacked-document"],handler:Vue},{semanticName:"Multi-Process",name:"Stacked Rectangle",shortName:"st-rect",description:"Multiple processes",aliases:["procs","processes","stacked-rectangle"],handler:que},{semanticName:"Stored Data",name:"Bow Tie Rectangle",shortName:"bow-rect",description:"Stored data",aliases:["stored-data","bow-tie-rectangle"],handler:fue},{semanticName:"Summary",name:"Crossed Circle",shortName:"cross-circ",description:"Summary",aliases:["summary","crossed-circle"],handler:yue},{semanticName:"Tagged Document",name:"Tagged Document",shortName:"tag-doc",description:"Tagged document",aliases:["tag-doc","tagged-document"],handler:ide},{semanticName:"Tagged Process",name:"Tagged Rectangle",shortName:"tag-rect",description:"Tagged process",aliases:["tagged-rectangle","tag-proc","tagged-process"],handler:sde},{semanticName:"Paper Tape",name:"Flag",shortName:"flag",description:"Paper tape",aliases:["paper-tape"],handler:fde},{semanticName:"Odd",name:"Odd",shortName:"odd",description:"Odd shape",internalAliases:["rect_left_inv_arrow"],handler:Gue},{semanticName:"Lined Document",name:"Lined Document",shortName:"lin-doc",description:"Lined document",aliases:["lined-document"],handler:Uue}],plt=ie(()=>{const t=[...Object.entries({state:ede,choice:pue,note:Wue,rectWithTitle:Kue,labelRect:Fue,iconSquare:Pue,iconCircle:Mue,icon:Iue,iconRounded:jue,imageSquare:Oue,anchor:due,kanbanItem:yde,classBox:mde,erBox:T5,requirementBox:gde}),...hlt.flatMap(n=>[n.shortName,..."aliases"in n?n.aliases:[],..."internalAliases"in n?n.internalAliases:[]].map(s=>[s,n.handler]))];return Object.fromEntries(t)},"generateShapeMap"),bde=plt();function mlt(e){return e in bde}ie(mlt,"isValidShape");var NA=new Map;async function vde(e,t,n){let r,s;t.shape==="rect"&&(t.rx&&t.ry?t.shape="roundedRect":t.shape="squareRect");const i=t.shape?bde[t.shape]:void 0;if(!i)throw new Error(`No such shape: ${t.shape}. Please check your syntax.`);if(t.link){let a;n.config.securityLevel==="sandbox"?a="_top":t.linkTarget&&(a=t.linkTarget||"_blank"),r=e.insert("svg:a").attr("xlink:href",t.link).attr("target",a??null),s=await i(r,t,n)}else s=await i(e,t,n),r=s;return t.tooltip&&s.attr("title",t.tooltip),NA.set(t.id,r),t.haveCallback&&r.attr("class",r.attr("class")+" clickable"),r}ie(vde,"insertNode");var lht=ie((e,t)=>{NA.set(t.id,e)},"setNodeElem"),cht=ie(()=>{NA.clear()},"clear"),uht=ie(e=>{const t=NA.get(e.id);qt.trace("Transforming node",e.diff,e,"translate("+(e.x-e.width/2-5)+", "+e.width/2+")");const n=8,r=e.diff||0;return e.clusterNode?t.attr("transform","translate("+(e.x+r-e.width/2)+", "+(e.y-e.height/2-n)+")"):t.attr("transform","translate("+e.x+", "+e.y+")"),r},"positionNode"),glt=ie((e,t,n,r,s,i)=>{t.arrowTypeStart&&ZW(e,"start",t.arrowTypeStart,n,r,s,i),t.arrowTypeEnd&&ZW(e,"end",t.arrowTypeEnd,n,r,s,i)},"addEdgeMarkers"),ylt={arrow_cross:{type:"cross",fill:!1},arrow_point:{type:"point",fill:!0},arrow_barb:{type:"barb",fill:!0},arrow_circle:{type:"circle",fill:!1},aggregation:{type:"aggregation",fill:!1},extension:{type:"extension",fill:!1},composition:{type:"composition",fill:!0},dependency:{type:"dependency",fill:!0},lollipop:{type:"lollipop",fill:!1},only_one:{type:"onlyOne",fill:!1},zero_or_one:{type:"zeroOrOne",fill:!1},one_or_more:{type:"oneOrMore",fill:!1},zero_or_more:{type:"zeroOrMore",fill:!1},requirement_arrow:{type:"requirement_arrow",fill:!1},requirement_contains:{type:"requirement_contains",fill:!1}},ZW=ie((e,t,n,r,s,i,a)=>{var d;const o=ylt[n];if(!o){qt.warn(`Unknown arrow type: ${n}`);return}const l=o.type,u=`${s}_${i}-${l}${t==="start"?"Start":"End"}`;if(a&&a.trim()!==""){const h=a.replace(/[^\dA-Za-z]/g,"_"),m=`${u}_${h}`;if(!document.getElementById(m)){const y=document.getElementById(u);if(y){const b=y.cloneNode(!0);b.id=m,b.querySelectorAll("path, circle, line").forEach(x=>{x.setAttribute("stroke",a),o.fill&&x.setAttribute("fill",a)}),(d=y.parentNode)==null||d.appendChild(b)}}e.attr(`marker-${t}`,`url(${r}#${m})`)}else e.attr(`marker-${t}`,`url(${r}#${u})`)},"addEdgeMarker"),CE=new Map,ka=new Map,dht=ie(()=>{CE.clear(),ka.clear()},"clear"),fx=ie(e=>e?e.reduce((n,r)=>n+";"+r,""):"","getLabelStyles"),blt=ie(async(e,t)=>{let n=Qi(ls().flowchart.htmlLabels);const r=await Sp(e,t.label,{style:fx(t.labelStyle),useHtmlLabels:n,addSvgBackground:!0,isNode:!1});qt.info("abc82",t,t.labelType);const s=e.insert("g").attr("class","edgeLabel"),i=s.insert("g").attr("class","label");i.node().appendChild(r);let a=r.getBBox();if(n){const l=r.children[0],c=Zr(r);a=l.getBoundingClientRect(),c.attr("width",a.width),c.attr("height",a.height)}i.attr("transform","translate("+-a.width/2+", "+-a.height/2+")"),CE.set(t.id,s),t.width=a.width,t.height=a.height;let o;if(t.startLabelLeft){const l=await vm(t.startLabelLeft,fx(t.labelStyle)),c=e.insert("g").attr("class","edgeTerminals"),u=c.insert("g").attr("class","inner");o=u.node().appendChild(l);const d=l.getBBox();u.attr("transform","translate("+-d.width/2+", "+-d.height/2+")"),ka.get(t.id)||ka.set(t.id,{}),ka.get(t.id).startLeft=c,jx(o,t.startLabelLeft)}if(t.startLabelRight){const l=await vm(t.startLabelRight,fx(t.labelStyle)),c=e.insert("g").attr("class","edgeTerminals"),u=c.insert("g").attr("class","inner");o=c.node().appendChild(l),u.node().appendChild(l);const d=l.getBBox();u.attr("transform","translate("+-d.width/2+", "+-d.height/2+")"),ka.get(t.id)||ka.set(t.id,{}),ka.get(t.id).startRight=c,jx(o,t.startLabelRight)}if(t.endLabelLeft){const l=await vm(t.endLabelLeft,fx(t.labelStyle)),c=e.insert("g").attr("class","edgeTerminals"),u=c.insert("g").attr("class","inner");o=u.node().appendChild(l);const d=l.getBBox();u.attr("transform","translate("+-d.width/2+", "+-d.height/2+")"),c.node().appendChild(l),ka.get(t.id)||ka.set(t.id,{}),ka.get(t.id).endLeft=c,jx(o,t.endLabelLeft)}if(t.endLabelRight){const l=await vm(t.endLabelRight,fx(t.labelStyle)),c=e.insert("g").attr("class","edgeTerminals"),u=c.insert("g").attr("class","inner");o=u.node().appendChild(l);const d=l.getBBox();u.attr("transform","translate("+-d.width/2+", "+-d.height/2+")"),c.node().appendChild(l),ka.get(t.id)||ka.set(t.id,{}),ka.get(t.id).endRight=c,jx(o,t.endLabelRight)}return r},"insertEdgeLabel");function jx(e,t){ls().flowchart.htmlLabels&&e&&(e.style.width=t.length*9+"px",e.style.height="12px")}ie(jx,"setTerminalWidth");var vlt=ie((e,t)=>{qt.debug("Moving label abc88 ",e.id,e.label,CE.get(e.id),t);let n=t.updatedPath?t.updatedPath:t.originalPath;const r=ls(),{subGraphTitleTotalMargin:s}=W6(r);if(e.label){const i=CE.get(e.id);let a=e.x,o=e.y;if(n){const l=Au.calcLabelPosition(n);qt.debug("Moving label "+e.label+" from (",a,",",o,") to (",l.x,",",l.y,") abc88"),t.updatedPath&&(a=l.x,o=l.y)}i.attr("transform",`translate(${a}, ${o+s/2})`)}if(e.startLabelLeft){const i=ka.get(e.id).startLeft;let a=e.x,o=e.y;if(n){const l=Au.calcTerminalLabelPosition(e.arrowTypeStart?10:0,"start_left",n);a=l.x,o=l.y}i.attr("transform",`translate(${a}, ${o})`)}if(e.startLabelRight){const i=ka.get(e.id).startRight;let a=e.x,o=e.y;if(n){const l=Au.calcTerminalLabelPosition(e.arrowTypeStart?10:0,"start_right",n);a=l.x,o=l.y}i.attr("transform",`translate(${a}, ${o})`)}if(e.endLabelLeft){const i=ka.get(e.id).endLeft;let a=e.x,o=e.y;if(n){const l=Au.calcTerminalLabelPosition(e.arrowTypeEnd?10:0,"end_left",n);a=l.x,o=l.y}i.attr("transform",`translate(${a}, ${o})`)}if(e.endLabelRight){const i=ka.get(e.id).endRight;let a=e.x,o=e.y;if(n){const l=Au.calcTerminalLabelPosition(e.arrowTypeEnd?10:0,"end_right",n);a=l.x,o=l.y}i.attr("transform",`translate(${a}, ${o})`)}},"positionEdgeLabel"),xlt=ie((e,t)=>{const n=e.x,r=e.y,s=Math.abs(t.x-n),i=Math.abs(t.y-r),a=e.width/2,o=e.height/2;return s>=a||i>=o},"outsideNode"),wlt=ie((e,t,n)=>{qt.debug(`intersection calc abc89:
  outsidePoint: ${JSON.stringify(t)}
  insidePoint : ${JSON.stringify(n)}
  node        : x:${e.x} y:${e.y} w:${e.width} h:${e.height}`);const r=e.x,s=e.y,i=Math.abs(r-n.x),a=e.width/2;let o=n.x<t.x?a-i:a+i;const l=e.height/2,c=Math.abs(t.y-n.y),u=Math.abs(t.x-n.x);if(Math.abs(s-t.y)*a>Math.abs(r-t.x)*l){let d=n.y<t.y?t.y-l-s:s-l-t.y;o=u*d/c;const h={x:n.x<t.x?n.x+o:n.x-u+o,y:n.y<t.y?n.y+c-d:n.y-c+d};return o===0&&(h.x=t.x,h.y=t.y),u===0&&(h.x=t.x),c===0&&(h.y=t.y),qt.debug(`abc89 top/bottom calc, Q ${c}, q ${d}, R ${u}, r ${o}`,h),h}else{n.x<t.x?o=t.x-a-r:o=r-a-t.x;let d=c*o/u,h=n.x<t.x?n.x+u-o:n.x-u+o,m=n.y<t.y?n.y+d:n.y-d;return qt.debug(`sides calc abc89, Q ${c}, q ${d}, R ${u}, r ${o}`,{_x:h,_y:m}),o===0&&(h=t.x,m=t.y),u===0&&(h=t.x),c===0&&(m=t.y),{x:h,y:m}}},"intersection"),XW=ie((e,t)=>{qt.warn("abc88 cutPathAtIntersect",e,t);let n=[],r=e[0],s=!1;return e.forEach(i=>{if(qt.info("abc88 checking point",i,t),!xlt(t,i)&&!s){const a=wlt(t,r,i);qt.debug("abc88 inside",i,r,a),qt.debug("abc88 intersection",a,t);let o=!1;n.forEach(l=>{o=o||l.x===a.x&&l.y===a.y}),n.some(l=>l.x===a.x&&l.y===a.y)?qt.warn("abc88 no intersect",a,n):n.push(a),s=!0}else qt.warn("abc88 outside",i,r),r=i,s||n.push(i)}),qt.debug("returning points",n),n},"cutPathAtIntersect");function xde(e){const t=[],n=[];for(let r=1;r<e.length-1;r++){const s=e[r-1],i=e[r],a=e[r+1];(s.x===i.x&&i.y===a.y&&Math.abs(i.x-a.x)>5&&Math.abs(i.y-s.y)>5||s.y===i.y&&i.x===a.x&&Math.abs(i.x-s.x)>5&&Math.abs(i.y-a.y)>5)&&(t.push(i),n.push(r))}return{cornerPoints:t,cornerPointPositions:n}}ie(xde,"extractCornerPoints");var JW=ie(function(e,t,n){const r=t.x-e.x,s=t.y-e.y,i=Math.sqrt(r*r+s*s),a=n/i;return{x:t.x-a*r,y:t.y-a*s}},"findAdjacentPoint"),Slt=ie(function(e){const{cornerPointPositions:t}=xde(e),n=[];for(let r=0;r<e.length;r++)if(t.includes(r)){const s=e[r-1],i=e[r+1],a=e[r],o=JW(s,a,5),l=JW(i,a,5),c=l.x-o.x,u=l.y-o.y;n.push(o);const d=Math.sqrt(2)*2;let h={x:a.x,y:a.y};if(Math.abs(i.x-s.x)>10&&Math.abs(i.y-s.y)>=10){qt.debug("Corner point fixing",Math.abs(i.x-s.x),Math.abs(i.y-s.y));const m=5;a.x===o.x?h={x:c<0?o.x-m+d:o.x+m-d,y:u<0?o.y-d:o.y+d}:h={x:c<0?o.x-d:o.x+d,y:u<0?o.y-m+d:o.y+m-d}}else qt.debug("Corner point skipping fixing",Math.abs(i.x-s.x),Math.abs(i.y-s.y));n.push(h,l)}else n.push(e[r]);return n},"fixCorners"),_lt=ie(function(e,t,n,r,s,i,a){var I;const{handDrawnSeed:o}=ls();let l=t.points,c=!1;const u=s;var d=i;const h=[];for(const j in t.cssCompiledStyles)nue(j)||h.push(t.cssCompiledStyles[j]);d.intersect&&u.intersect&&(l=l.slice(1,t.points.length-1),l.unshift(u.intersect(l[0])),qt.debug("Last point APA12",t.start,"-->",t.end,l[l.length-1],d,d.intersect(l[l.length-1])),l.push(d.intersect(l[l.length-1]))),t.toCluster&&(qt.info("to cluster abc88",n.get(t.toCluster)),l=XW(t.points,n.get(t.toCluster).node),c=!0),t.fromCluster&&(qt.debug("from cluster abc88",n.get(t.fromCluster),JSON.stringify(l,null,2)),l=XW(l.reverse(),n.get(t.fromCluster).node).reverse(),c=!0);let m=l.filter(j=>!Number.isNaN(j.y));m=Slt(m);let y=f2;switch(y=lE,t.curve){case"linear":y=lE;break;case"basis":y=f2;break;case"cardinal":y=qle;break;case"bumpX":y=Lle;break;case"bumpY":y=Ble;break;case"catmullRom":y=Wle;break;case"monotoneX":y=Xle;break;case"monotoneY":y=Jle;break;case"natural":y=ece;break;case"step":y=tce;break;case"stepAfter":y=rce;break;case"stepBefore":y=nce;break;default:y=f2}const{x:b,y:v}=VQe(t),x=$rt().x(b).y(v).curve(y);let w;switch(t.thickness){case"normal":w="edge-thickness-normal";break;case"thick":w="edge-thickness-thick";break;case"invisible":w="edge-thickness-invisible";break;default:w="edge-thickness-normal"}switch(t.pattern){case"solid":w+=" edge-pattern-solid";break;case"dotted":w+=" edge-pattern-dotted";break;case"dashed":w+=" edge-pattern-dashed";break;default:w+=" edge-pattern-solid"}let _,k=x(m);const C=Array.isArray(t.style)?t.style:[t.style];let T=C.find(j=>j==null?void 0:j.startsWith("stroke:"));if(t.look==="handDrawn"){const j=Rn.svg(e);Object.assign([],m);const L=j.path(k,{roughness:.3,seed:o});w+=" transition",_=Zr(L).select("path").attr("id",t.id).attr("class"," "+w+(t.classes?" "+t.classes:"")).attr("style",C?C.reduce((H,O)=>H+";"+O,""):"");let D=_.attr("d");_.attr("d",D),e.node().appendChild(_.node())}else{const j=h.join(";"),L=C?C.reduce((O,K)=>O+K+";",""):"";let D="";t.animate&&(D=" edge-animation-fast"),t.animation&&(D=" edge-animation-"+t.animation);const H=j?j+";"+L+";":L;_=e.append("path").attr("d",k).attr("id",t.id).attr("class"," "+w+(t.classes?" "+t.classes:"")+(D??"")).attr("style",H),T=(I=H.match(/stroke:([^;]+)/))==null?void 0:I[1]}let A="";(ls().flowchart.arrowMarkerAbsolute||ls().state.arrowMarkerAbsolute)&&(A=window.location.protocol+"//"+window.location.host+window.location.pathname+window.location.search,A=A.replace(/\(/g,"\\(").replace(/\)/g,"\\)")),qt.info("arrowTypeStart",t.arrowTypeStart),qt.info("arrowTypeEnd",t.arrowTypeEnd),glt(_,t,A,a,r,T);let N={};return c&&(N.updatedPath=l),N.originalPath=t.points,N},"insertEdge"),Clt=ie((e,t,n,r)=>{t.forEach(s=>{$lt[s](e,n,r)})},"insertMarkers"),klt=ie((e,t,n)=>{qt.trace("Making markers for ",n),e.append("defs").append("marker").attr("id",n+"_"+t+"-extensionStart").attr("class","marker extension "+t).attr("refX",18).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 1,7 L18,13 V 1 Z"),e.append("defs").append("marker").attr("id",n+"_"+t+"-extensionEnd").attr("class","marker extension "+t).attr("refX",1).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 1,1 V 13 L18,7 Z")},"extension"),Elt=ie((e,t,n)=>{e.append("defs").append("marker").attr("id",n+"_"+t+"-compositionStart").attr("class","marker composition "+t).attr("refX",18).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z"),e.append("defs").append("marker").attr("id",n+"_"+t+"-compositionEnd").attr("class","marker composition "+t).attr("refX",1).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z")},"composition"),Tlt=ie((e,t,n)=>{e.append("defs").append("marker").attr("id",n+"_"+t+"-aggregationStart").attr("class","marker aggregation "+t).attr("refX",18).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z"),e.append("defs").append("marker").attr("id",n+"_"+t+"-aggregationEnd").attr("class","marker aggregation "+t).attr("refX",1).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z")},"aggregation"),Alt=ie((e,t,n)=>{e.append("defs").append("marker").attr("id",n+"_"+t+"-dependencyStart").attr("class","marker dependency "+t).attr("refX",6).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 5,7 L9,13 L1,7 L9,1 Z"),e.append("defs").append("marker").attr("id",n+"_"+t+"-dependencyEnd").attr("class","marker dependency "+t).attr("refX",13).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L14,7 L9,1 Z")},"dependency"),Rlt=ie((e,t,n)=>{e.append("defs").append("marker").attr("id",n+"_"+t+"-lollipopStart").attr("class","marker lollipop "+t).attr("refX",13).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("circle").attr("stroke","black").attr("fill","transparent").attr("cx",7).attr("cy",7).attr("r",6),e.append("defs").append("marker").attr("id",n+"_"+t+"-lollipopEnd").attr("class","marker lollipop "+t).attr("refX",1).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("circle").attr("stroke","black").attr("fill","transparent").attr("cx",7).attr("cy",7).attr("r",6)},"lollipop"),Nlt=ie((e,t,n)=>{e.append("marker").attr("id",n+"_"+t+"-pointEnd").attr("class","marker "+t).attr("viewBox","0 0 10 10").attr("refX",5).attr("refY",5).attr("markerUnits","userSpaceOnUse").attr("markerWidth",8).attr("markerHeight",8).attr("orient","auto").append("path").attr("d","M 0 0 L 10 5 L 0 10 z").attr("class","arrowMarkerPath").style("stroke-width",1).style("stroke-dasharray","1,0"),e.append("marker").attr("id",n+"_"+t+"-pointStart").attr("class","marker "+t).attr("viewBox","0 0 10 10").attr("refX",4.5).attr("refY",5).attr("markerUnits","userSpaceOnUse").attr("markerWidth",8).attr("markerHeight",8).attr("orient","auto").append("path").attr("d","M 0 5 L 10 10 L 10 0 z").attr("class","arrowMarkerPath").style("stroke-width",1).style("stroke-dasharray","1,0")},"point"),Ilt=ie((e,t,n)=>{e.append("marker").attr("id",n+"_"+t+"-circleEnd").attr("class","marker "+t).attr("viewBox","0 0 10 10").attr("refX",11).attr("refY",5).attr("markerUnits","userSpaceOnUse").attr("markerWidth",11).attr("markerHeight",11).attr("orient","auto").append("circle").attr("cx","5").attr("cy","5").attr("r","5").attr("class","arrowMarkerPath").style("stroke-width",1).style("stroke-dasharray","1,0"),e.append("marker").attr("id",n+"_"+t+"-circleStart").attr("class","marker "+t).attr("viewBox","0 0 10 10").attr("refX",-1).attr("refY",5).attr("markerUnits","userSpaceOnUse").attr("markerWidth",11).attr("markerHeight",11).attr("orient","auto").append("circle").attr("cx","5").attr("cy","5").attr("r","5").attr("class","arrowMarkerPath").style("stroke-width",1).style("stroke-dasharray","1,0")},"circle"),Mlt=ie((e,t,n)=>{e.append("marker").attr("id",n+"_"+t+"-crossEnd").attr("class","marker cross "+t).attr("viewBox","0 0 11 11").attr("refX",12).attr("refY",5.2).attr("markerUnits","userSpaceOnUse").attr("markerWidth",11).attr("markerHeight",11).attr("orient","auto").append("path").attr("d","M 1,1 l 9,9 M 10,1 l -9,9").attr("class","arrowMarkerPath").style("stroke-width",2).style("stroke-dasharray","1,0"),e.append("marker").attr("id",n+"_"+t+"-crossStart").attr("class","marker cross "+t).attr("viewBox","0 0 11 11").attr("refX",-1).attr("refY",5.2).attr("markerUnits","userSpaceOnUse").attr("markerWidth",11).attr("markerHeight",11).attr("orient","auto").append("path").attr("d","M 1,1 l 9,9 M 10,1 l -9,9").attr("class","arrowMarkerPath").style("stroke-width",2).style("stroke-dasharray","1,0")},"cross"),jlt=ie((e,t,n)=>{e.append("defs").append("marker").attr("id",n+"_"+t+"-barbEnd").attr("refX",19).attr("refY",7).attr("markerWidth",20).attr("markerHeight",14).attr("markerUnits","userSpaceOnUse").attr("orient","auto").append("path").attr("d","M 19,7 L9,13 L14,7 L9,1 Z")},"barb"),Plt=ie((e,t,n)=>{e.append("defs").append("marker").attr("id",n+"_"+t+"-onlyOneStart").attr("class","marker onlyOne "+t).attr("refX",0).attr("refY",9).attr("markerWidth",18).attr("markerHeight",18).attr("orient","auto").append("path").attr("d","M9,0 L9,18 M15,0 L15,18"),e.append("defs").append("marker").attr("id",n+"_"+t+"-onlyOneEnd").attr("class","marker onlyOne "+t).attr("refX",18).attr("refY",9).attr("markerWidth",18).attr("markerHeight",18).attr("orient","auto").append("path").attr("d","M3,0 L3,18 M9,0 L9,18")},"only_one"),Olt=ie((e,t,n)=>{const r=e.append("defs").append("marker").attr("id",n+"_"+t+"-zeroOrOneStart").attr("class","marker zeroOrOne "+t).attr("refX",0).attr("refY",9).attr("markerWidth",30).attr("markerHeight",18).attr("orient","auto");r.append("circle").attr("fill","white").attr("cx",21).attr("cy",9).attr("r",6),r.append("path").attr("d","M9,0 L9,18");const s=e.append("defs").append("marker").attr("id",n+"_"+t+"-zeroOrOneEnd").attr("class","marker zeroOrOne "+t).attr("refX",30).attr("refY",9).attr("markerWidth",30).attr("markerHeight",18).attr("orient","auto");s.append("circle").attr("fill","white").attr("cx",9).attr("cy",9).attr("r",6),s.append("path").attr("d","M21,0 L21,18")},"zero_or_one"),Dlt=ie((e,t,n)=>{e.append("defs").append("marker").attr("id",n+"_"+t+"-oneOrMoreStart").attr("class","marker oneOrMore "+t).attr("refX",18).attr("refY",18).attr("markerWidth",45).attr("markerHeight",36).attr("orient","auto").append("path").attr("d","M0,18 Q 18,0 36,18 Q 18,36 0,18 M42,9 L42,27"),e.append("defs").append("marker").attr("id",n+"_"+t+"-oneOrMoreEnd").attr("class","marker oneOrMore "+t).attr("refX",27).attr("refY",18).attr("markerWidth",45).attr("markerHeight",36).attr("orient","auto").append("path").attr("d","M3,9 L3,27 M9,18 Q27,0 45,18 Q27,36 9,18")},"one_or_more"),Flt=ie((e,t,n)=>{const r=e.append("defs").append("marker").attr("id",n+"_"+t+"-zeroOrMoreStart").attr("class","marker zeroOrMore "+t).attr("refX",18).attr("refY",18).attr("markerWidth",57).attr("markerHeight",36).attr("orient","auto");r.append("circle").attr("fill","white").attr("cx",48).attr("cy",18).attr("r",6),r.append("path").attr("d","M0,18 Q18,0 36,18 Q18,36 0,18");const s=e.append("defs").append("marker").attr("id",n+"_"+t+"-zeroOrMoreEnd").attr("class","marker zeroOrMore "+t).attr("refX",39).attr("refY",18).attr("markerWidth",57).attr("markerHeight",36).attr("orient","auto");s.append("circle").attr("fill","white").attr("cx",9).attr("cy",18).attr("r",6),s.append("path").attr("d","M21,18 Q39,0 57,18 Q39,36 21,18")},"zero_or_more"),Llt=ie((e,t,n)=>{e.append("defs").append("marker").attr("id",n+"_"+t+"-requirement_arrowEnd").attr("refX",20).attr("refY",10).attr("markerWidth",20).attr("markerHeight",20).attr("orient","auto").append("path").attr("d",`M0,0
      L20,10
      M20,10
      L0,20`)},"requirement_arrow"),Blt=ie((e,t,n)=>{const r=e.append("defs").append("marker").attr("id",n+"_"+t+"-requirement_containsStart").attr("refX",0).attr("refY",10).attr("markerWidth",20).attr("markerHeight",20).attr("orient","auto").append("g");r.append("circle").attr("cx",10).attr("cy",10).attr("r",9).attr("fill","none"),r.append("line").attr("x1",1).attr("x2",19).attr("y1",10).attr("y2",10),r.append("line").attr("y1",1).attr("y2",19).attr("x1",10).attr("x2",10)},"requirement_contains"),$lt={extension:klt,composition:Elt,aggregation:Tlt,dependency:Alt,lollipop:Rlt,point:Nlt,circle:Ilt,cross:Mlt,barb:jlt,only_one:Plt,zero_or_one:Olt,one_or_more:Dlt,zero_or_more:Flt,requirement_arrow:Llt,requirement_contains:Blt},zlt=Clt,Ult={common:Ib,getConfig:Go,insertCluster:Zot,insertEdge:_lt,insertEdgeLabel:blt,insertMarkers:zlt,insertNode:vde,interpolateToCurve:l5,labelHelper:hr,log:qt,positionEdgeLabel:vlt},S1={},wde=ie(e=>{for(const t of e)S1[t.name]=t},"registerLayoutLoaders"),qlt=ie(()=>{wde([{name:"dagre",loader:ie(async()=>await Fr(()=>import("./dagre-OKDRZEBW-CBBoKnMw.js"),__vite__mapDeps([0,1,2,3,4,5])),"loader")}])},"registerDefaultLayoutLoaders");qlt();var fht=ie(async(e,t)=>{if(!(e.layoutAlgorithm in S1))throw new Error(`Unknown layout algorithm: ${e.layoutAlgorithm}`);const n=S1[e.layoutAlgorithm];return(await n.loader()).render(e,t,Ult,{algorithm:n.algorithm})},"render"),hht=ie((e="",{fallback:t="dagre"}={})=>{if(e in S1)return e;if(t in S1)return qt.warn(`Layout algorithm ${e} is not registered. Using ${t} as fallback.`),t;throw new Error(`Both layout algorithms ${e} and ${t} are not registered.`)},"getRegisteredLayoutAlgorithm"),QW={name:"mermaid",version:"11.6.0",description:"Markdown-ish syntax for generating flowcharts, mindmaps, sequence diagrams, class diagrams, gantt charts, git graphs and more.",type:"module",module:"./dist/mermaid.core.mjs",types:"./dist/mermaid.d.ts",exports:{".":{types:"./dist/mermaid.d.ts",import:"./dist/mermaid.core.mjs",default:"./dist/mermaid.core.mjs"},"./*":"./*"},keywords:["diagram","markdown","flowchart","sequence diagram","gantt","class diagram","git graph","mindmap","packet diagram","c4 diagram","er diagram","pie chart","pie diagram","quadrant chart","requirement diagram","graph"],scripts:{clean:"rimraf dist",dev:"pnpm -w dev","docs:code":"typedoc src/defaultConfig.ts src/config.ts src/mermaid.ts && prettier --write ./src/docs/config/setup","docs:build":"rimraf ../../docs && pnpm docs:code && pnpm docs:spellcheck && tsx scripts/docs.cli.mts","docs:verify":"pnpm docs:code && pnpm docs:spellcheck && tsx scripts/docs.cli.mts --verify","docs:pre:vitepress":"pnpm --filter ./src/docs prefetch && rimraf src/vitepress && pnpm docs:code && tsx scripts/docs.cli.mts --vitepress && pnpm --filter ./src/vitepress install --no-frozen-lockfile --ignore-scripts","docs:build:vitepress":"pnpm docs:pre:vitepress && (cd src/vitepress && pnpm run build) && cpy --flat src/docs/landing/ ./src/vitepress/.vitepress/dist/landing","docs:dev":'pnpm docs:pre:vitepress && concurrently "pnpm --filter ./src/vitepress dev" "tsx scripts/docs.cli.mts --watch --vitepress"',"docs:dev:docker":'pnpm docs:pre:vitepress && concurrently "pnpm --filter ./src/vitepress dev:docker" "tsx scripts/docs.cli.mts --watch --vitepress"',"docs:serve":"pnpm docs:build:vitepress && vitepress serve src/vitepress","docs:spellcheck":'cspell "src/docs/**/*.md"',"docs:release-version":"tsx scripts/update-release-version.mts","docs:verify-version":"tsx scripts/update-release-version.mts --verify","types:build-config":"tsx scripts/create-types-from-json-schema.mts","types:verify-config":"tsx scripts/create-types-from-json-schema.mts --verify",checkCircle:"npx madge --circular ./src",prepublishOnly:"pnpm docs:verify-version"},repository:{type:"git",url:"https://github.com/mermaid-js/mermaid"},author:"Knut Sveidqvist",license:"MIT",standard:{ignore:["**/parser/*.js","dist/**/*.js","cypress/**/*.js"],globals:["page"]},dependencies:{"@braintree/sanitize-url":"^7.0.4","@iconify/utils":"^2.1.33","@mermaid-js/parser":"workspace:^","@types/d3":"^7.4.3",cytoscape:"^3.29.3","cytoscape-cose-bilkent":"^4.1.0","cytoscape-fcose":"^2.2.0",d3:"^7.9.0","d3-sankey":"^0.12.3","dagre-d3-es":"7.0.11",dayjs:"^1.11.13",dompurify:"^3.2.4",katex:"^0.16.9",khroma:"^2.1.0","lodash-es":"^4.17.21",marked:"^15.0.7",roughjs:"^4.6.6",stylis:"^4.3.6","ts-dedent":"^2.2.0",uuid:"^11.1.0"},devDependencies:{"@adobe/jsonschema2md":"^8.0.2","@iconify/types":"^2.0.0","@types/cytoscape":"^3.21.9","@types/cytoscape-fcose":"^2.2.4","@types/d3-sankey":"^0.12.4","@types/d3-scale":"^4.0.9","@types/d3-scale-chromatic":"^3.1.0","@types/d3-selection":"^3.0.11","@types/d3-shape":"^3.1.7","@types/jsdom":"^21.1.7","@types/katex":"^0.16.7","@types/lodash-es":"^4.17.12","@types/micromatch":"^4.0.9","@types/stylis":"^4.2.7","@types/uuid":"^10.0.0",ajv:"^8.17.1",chokidar:"^4.0.3",concurrently:"^9.1.2","csstree-validator":"^4.0.1",globby:"^14.0.2",jison:"^0.4.18","js-base64":"^3.7.7",jsdom:"^26.0.0","json-schema-to-typescript":"^15.0.4",micromatch:"^4.0.8","path-browserify":"^1.0.1",prettier:"^3.5.2",remark:"^15.0.1","remark-frontmatter":"^5.0.0","remark-gfm":"^4.0.1",rimraf:"^6.0.1","start-server-and-test":"^2.0.10","type-fest":"^4.35.0",typedoc:"^0.27.8","typedoc-plugin-markdown":"^4.4.2",typescript:"~5.7.3","unist-util-flatmap":"^1.0.0","unist-util-visit":"^5.0.0",vitepress:"^1.0.2","vitepress-plugin-search":"1.0.4-alpha.22"},files:["dist/","README.md"],publishConfig:{access:"public"}},Vlt=ie(e=>{var s;const{securityLevel:t}=ls();let n=Zr("body");if(t==="sandbox"){const a=((s=Zr(`#i${e}`).node())==null?void 0:s.contentDocument)??document;n=Zr(a.body)}return n.select(`#${e}`)},"selectSvgElement"),Sde="comm",_de="rule",Cde="decl",Wlt="@import",Hlt="@namespace",Glt="@keyframes",Klt="@layer",kde=Math.abs,A5=String.fromCharCode;function Ede(e){return e.trim()}function g2(e,t,n){return e.replace(t,n)}function Ylt(e,t,n){return e.indexOf(t,n)}function ey(e,t){return e.charCodeAt(t)|0}function Ky(e,t,n){return e.slice(t,n)}function _u(e){return e.length}function Zlt(e){return e.length}function $C(e,t){return t.push(e),e}var IA=1,Yy=1,Tde=0,cc=0,Fi=0,Db="";function R5(e,t,n,r,s,i,a,o){return{value:e,root:t,parent:n,type:r,props:s,children:i,line:IA,column:Yy,length:a,return:"",siblings:o}}function Xlt(){return Fi}function Jlt(){return Fi=cc>0?ey(Db,--cc):0,Yy--,Fi===10&&(Yy=1,IA--),Fi}function Uc(){return Fi=cc<Tde?ey(Db,cc++):0,Yy++,Fi===10&&(Yy=1,IA++),Fi}function Th(){return ey(Db,cc)}function y2(){return cc}function MA(e,t){return Ky(Db,e,t)}function _1(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function Qlt(e){return IA=Yy=1,Tde=_u(Db=e),cc=0,[]}function ect(e){return Db="",e}function Qj(e){return Ede(MA(cc-1,z4(e===91?e+2:e===40?e+1:e)))}function tct(e){for(;(Fi=Th())&&Fi<33;)Uc();return _1(e)>2||_1(Fi)>3?"":" "}function nct(e,t){for(;--t&&Uc()&&!(Fi<48||Fi>102||Fi>57&&Fi<65||Fi>70&&Fi<97););return MA(e,y2()+(t<6&&Th()==32&&Uc()==32))}function z4(e){for(;Uc();)switch(Fi){case e:return cc;case 34:case 39:e!==34&&e!==39&&z4(Fi);break;case 40:e===41&&z4(e);break;case 92:Uc();break}return cc}function rct(e,t){for(;Uc()&&e+Fi!==57;)if(e+Fi===84&&Th()===47)break;return"/*"+MA(t,cc-1)+"*"+A5(e===47?e:Uc())}function sct(e){for(;!_1(Th());)Uc();return MA(e,cc)}function ict(e){return ect(b2("",null,null,null,[""],e=Qlt(e),0,[0],e))}function b2(e,t,n,r,s,i,a,o,l){for(var c=0,u=0,d=a,h=0,m=0,y=0,b=1,v=1,x=1,w=0,_="",k=s,C=i,T=r,A=_;v;)switch(y=w,w=Uc()){case 40:if(y!=108&&ey(A,d-1)==58){Ylt(A+=g2(Qj(w),"&","&\f"),"&\f",kde(c?o[c-1]:0))!=-1&&(x=-1);break}case 34:case 39:case 91:A+=Qj(w);break;case 9:case 10:case 13:case 32:A+=tct(y);break;case 92:A+=nct(y2()-1,7);continue;case 47:switch(Th()){case 42:case 47:$C(act(rct(Uc(),y2()),t,n,l),l),(_1(y||1)==5||_1(Th()||1)==5)&&_u(A)&&Ky(A,-1,void 0)!==" "&&(A+=" ");break;default:A+="/"}break;case 123*b:o[c++]=_u(A)*x;case 125*b:case 59:case 0:switch(w){case 0:case 125:v=0;case 59+u:x==-1&&(A=g2(A,/\f/g,"")),m>0&&(_u(A)-d||b===0&&y===47)&&$C(m>32?tH(A+";",r,n,d-1,l):tH(g2(A," ","")+";",r,n,d-2,l),l);break;case 59:A+=";";default:if($C(T=eH(A,t,n,c,u,s,o,_,k=[],C=[],d,i),i),w===123)if(u===0)b2(A,t,T,T,k,i,d,o,C);else{switch(h){case 99:if(ey(A,3)===110)break;case 108:if(ey(A,2)===97)break;default:u=0;case 100:case 109:case 115:}u?b2(e,T,T,r&&$C(eH(e,T,T,0,0,s,o,_,s,k=[],d,C),C),s,C,d,o,r?k:C):b2(A,T,T,T,[""],C,0,o,C)}}c=u=m=0,b=x=1,_=A="",d=a;break;case 58:d=1+_u(A),m=y;default:if(b<1){if(w==123)--b;else if(w==125&&b++==0&&Jlt()==125)continue}switch(A+=A5(w),w*b){case 38:x=u>0?1:(A+="\f",-1);break;case 44:o[c++]=(_u(A)-1)*x,x=1;break;case 64:Th()===45&&(A+=Qj(Uc())),h=Th(),u=d=_u(_=A+=sct(y2())),w++;break;case 45:y===45&&_u(A)==2&&(b=0)}}return i}function eH(e,t,n,r,s,i,a,o,l,c,u,d){for(var h=s-1,m=s===0?i:[""],y=Zlt(m),b=0,v=0,x=0;b<r;++b)for(var w=0,_=Ky(e,h+1,h=kde(v=a[b])),k=e;w<y;++w)(k=Ede(v>0?m[w]+" "+_:g2(_,/&\f/g,m[w])))&&(l[x++]=k);return R5(e,t,n,s===0?_de:o,l,c,u,d)}function act(e,t,n,r){return R5(e,t,n,Sde,A5(Xlt()),Ky(e,2,-2),0,r)}function tH(e,t,n,r,s){return R5(e,t,n,Cde,Ky(e,0,r),Ky(e,r+1,-1),r,s)}function U4(e,t){for(var n="",r=0;r<e.length;r++)n+=t(e[r],r,e,t)||"";return n}function oct(e,t,n,r){switch(e.type){case Klt:if(e.children.length)break;case Wlt:case Hlt:case Cde:return e.return=e.return||e.value;case Sde:return"";case Glt:return e.return=e.value+"{"+U4(e.children,r)+"}";case _de:if(!_u(e.value=e.props.join(",")))return""}return _u(n=U4(e.children,r))?e.return=e.value+"{"+n+"}":""}var lct=oce(Object.keys,Object),cct=Object.prototype,uct=cct.hasOwnProperty;function dct(e){if(!SA(e))return lct(e);var t=[];for(var n in Object(e))uct.call(e,n)&&n!="constructor"&&t.push(n);return t}var q4=gg(ad,"DataView"),V4=gg(ad,"Promise"),W4=gg(ad,"Set"),H4=gg(ad,"WeakMap"),nH="[object Map]",fct="[object Object]",rH="[object Promise]",sH="[object Set]",iH="[object WeakMap]",aH="[object DataView]",hct=mg(q4),pct=mg(w1),mct=mg(V4),gct=mg(W4),yct=mg(H4),sm=Mb;(q4&&sm(new q4(new ArrayBuffer(1)))!=aH||w1&&sm(new w1)!=nH||V4&&sm(V4.resolve())!=rH||W4&&sm(new W4)!=sH||H4&&sm(new H4)!=iH)&&(sm=function(e){var t=Mb(e),n=t==fct?e.constructor:void 0,r=n?mg(n):"";if(r)switch(r){case hct:return aH;case pct:return nH;case mct:return rH;case gct:return sH;case yct:return iH}return t});var bct="[object Map]",vct="[object Set]",xct=Object.prototype,wct=xct.hasOwnProperty;function oH(e){if(e==null)return!0;if(_A(e)&&(mE(e)||typeof e=="string"||typeof e.splice=="function"||a5(e)||o5(e)||pE(e)))return!e.length;var t=sm(e);if(t==bct||t==vct)return!e.size;if(SA(e))return!dct(e).length;for(var n in e)if(wct.call(e,n))return!1;return!0}var Ade="c4",Sct=ie(e=>/^\s*C4Context|C4Container|C4Component|C4Dynamic|C4Deployment/.test(e),"detector"),_ct=ie(async()=>{const{diagram:e}=await Fr(async()=>{const{diagram:t}=await import("./c4Diagram-VJAJSXHY-BW9LcBI6.js");return{diagram:t}},__vite__mapDeps([6,7]));return{id:Ade,diagram:e}},"loader"),Cct={id:Ade,detector:Sct,loader:_ct},kct=Cct,Rde="flowchart",Ect=ie((e,t)=>{var n,r;return((n=t==null?void 0:t.flowchart)==null?void 0:n.defaultRenderer)==="dagre-wrapper"||((r=t==null?void 0:t.flowchart)==null?void 0:r.defaultRenderer)==="elk"?!1:/^\s*graph/.test(e)},"detector"),Tct=ie(async()=>{const{diagram:e}=await Fr(async()=>{const{diagram:t}=await import("./flowDiagram-4HSFHLVR-BEU4pOJ5.js");return{diagram:t}},__vite__mapDeps([8,9,10]));return{id:Rde,diagram:e}},"loader"),Act={id:Rde,detector:Ect,loader:Tct},Rct=Act,Nde="flowchart-v2",Nct=ie((e,t)=>{var n,r,s;return((n=t==null?void 0:t.flowchart)==null?void 0:n.defaultRenderer)==="dagre-d3"?!1:(((r=t==null?void 0:t.flowchart)==null?void 0:r.defaultRenderer)==="elk"&&(t.layout="elk"),/^\s*graph/.test(e)&&((s=t==null?void 0:t.flowchart)==null?void 0:s.defaultRenderer)==="dagre-wrapper"?!0:/^\s*flowchart/.test(e))},"detector"),Ict=ie(async()=>{const{diagram:e}=await Fr(async()=>{const{diagram:t}=await import("./flowDiagram-4HSFHLVR-BEU4pOJ5.js");return{diagram:t}},__vite__mapDeps([8,9,10]));return{id:Nde,diagram:e}},"loader"),Mct={id:Nde,detector:Nct,loader:Ict},jct=Mct,Ide="er",Pct=ie(e=>/^\s*erDiagram/.test(e),"detector"),Oct=ie(async()=>{const{diagram:e}=await Fr(async()=>{const{diagram:t}=await import("./erDiagram-Q7BY3M3F-C7BmkNxh.js");return{diagram:t}},__vite__mapDeps([11,9,10]));return{id:Ide,diagram:e}},"loader"),Dct={id:Ide,detector:Pct,loader:Oct},Fct=Dct,Mde="gitGraph",Lct=ie(e=>/^\s*gitGraph/.test(e),"detector"),Bct=ie(async()=>{const{diagram:e}=await Fr(async()=>{const{diagram:t}=await import("./gitGraphDiagram-7IBYFJ6S-I9vGv3ZN.js");return{diagram:t}},__vite__mapDeps([12,13,14,15,2,4,5]));return{id:Mde,diagram:e}},"loader"),$ct={id:Mde,detector:Lct,loader:Bct},zct=$ct,jde="gantt",Uct=ie(e=>/^\s*gantt/.test(e),"detector"),qct=ie(async()=>{const{diagram:e}=await Fr(async()=>{const{diagram:t}=await import("./ganttDiagram-APWFNJXF-CSECoJ7y.js");return{diagram:t}},__vite__mapDeps([16,17,18]));return{id:jde,diagram:e}},"loader"),Vct={id:jde,detector:Uct,loader:qct},Wct=Vct,Pde="info",Hct=ie(e=>/^\s*info/.test(e),"detector"),Gct=ie(async()=>{const{diagram:e}=await Fr(async()=>{const{diagram:t}=await import("./infoDiagram-PH2N3AL5-FbNNtBDj.js");return{diagram:t}},__vite__mapDeps([19,15,2,4,5]));return{id:Pde,diagram:e}},"loader"),Kct={id:Pde,detector:Hct,loader:Gct},Ode="pie",Yct=ie(e=>/^\s*pie/.test(e),"detector"),Zct=ie(async()=>{const{diagram:e}=await Fr(async()=>{const{diagram:t}=await import("./pieDiagram-IB7DONF6-DcRBIKhM.js");return{diagram:t}},__vite__mapDeps([20,13,15,2,4,5,21,22,18]));return{id:Ode,diagram:e}},"loader"),Xct={id:Ode,detector:Yct,loader:Zct},Dde="quadrantChart",Jct=ie(e=>/^\s*quadrantChart/.test(e),"detector"),Qct=ie(async()=>{const{diagram:e}=await Fr(async()=>{const{diagram:t}=await import("./quadrantDiagram-7GDLP6J5-BwVdjH6H.js");return{diagram:t}},__vite__mapDeps([23,17,18]));return{id:Dde,diagram:e}},"loader"),eut={id:Dde,detector:Jct,loader:Qct},tut=eut,Fde="xychart",nut=ie(e=>/^\s*xychart-beta/.test(e),"detector"),rut=ie(async()=>{const{diagram:e}=await Fr(async()=>{const{diagram:t}=await import("./xychartDiagram-VJFVF3MP-w9swyRw2.js");return{diagram:t}},__vite__mapDeps([24,18,22,17]));return{id:Fde,diagram:e}},"loader"),sut={id:Fde,detector:nut,loader:rut},iut=sut,Lde="requirement",aut=ie(e=>/^\s*requirement(Diagram)?/.test(e),"detector"),out=ie(async()=>{const{diagram:e}=await Fr(async()=>{const{diagram:t}=await import("./requirementDiagram-KVF5MWMF-gL4siWGK.js");return{diagram:t}},__vite__mapDeps([25,9]));return{id:Lde,diagram:e}},"loader"),lut={id:Lde,detector:aut,loader:out},cut=lut,Bde="sequence",uut=ie(e=>/^\s*sequenceDiagram/.test(e),"detector"),dut=ie(async()=>{const{diagram:e}=await Fr(async()=>{const{diagram:t}=await import("./sequenceDiagram-X6HHIX6F-qQVa0kQ5.js");return{diagram:t}},__vite__mapDeps([26,7,14]));return{id:Bde,diagram:e}},"loader"),fut={id:Bde,detector:uut,loader:dut},hut=fut,$de="class",put=ie((e,t)=>{var n;return((n=t==null?void 0:t.class)==null?void 0:n.defaultRenderer)==="dagre-wrapper"?!1:/^\s*classDiagram/.test(e)},"detector"),mut=ie(async()=>{const{diagram:e}=await Fr(async()=>{const{diagram:t}=await import("./classDiagram-GIVACNV2-DntLRIBO.js");return{diagram:t}},__vite__mapDeps([27,28,9]));return{id:$de,diagram:e}},"loader"),gut={id:$de,detector:put,loader:mut},yut=gut,zde="classDiagram",but=ie((e,t)=>{var n;return/^\s*classDiagram/.test(e)&&((n=t==null?void 0:t.class)==null?void 0:n.defaultRenderer)==="dagre-wrapper"?!0:/^\s*classDiagram-v2/.test(e)},"detector"),vut=ie(async()=>{const{diagram:e}=await Fr(async()=>{const{diagram:t}=await import("./classDiagram-v2-COTLJTTW-DntLRIBO.js");return{diagram:t}},__vite__mapDeps([29,28,9]));return{id:zde,diagram:e}},"loader"),xut={id:zde,detector:but,loader:vut},wut=xut,Ude="state",Sut=ie((e,t)=>{var n;return((n=t==null?void 0:t.state)==null?void 0:n.defaultRenderer)==="dagre-wrapper"?!1:/^\s*stateDiagram/.test(e)},"detector"),_ut=ie(async()=>{const{diagram:e}=await Fr(async()=>{const{diagram:t}=await import("./stateDiagram-DGXRK772-CXTZSSzY.js");return{diagram:t}},__vite__mapDeps([30,31,9,1,2,3,4]));return{id:Ude,diagram:e}},"loader"),Cut={id:Ude,detector:Sut,loader:_ut},kut=Cut,qde="stateDiagram",Eut=ie((e,t)=>{var n;return!!(/^\s*stateDiagram-v2/.test(e)||/^\s*stateDiagram/.test(e)&&((n=t==null?void 0:t.state)==null?void 0:n.defaultRenderer)==="dagre-wrapper")},"detector"),Tut=ie(async()=>{const{diagram:e}=await Fr(async()=>{const{diagram:t}=await import("./stateDiagram-v2-YXO3MK2T-CDfRCE0L.js");return{diagram:t}},__vite__mapDeps([32,31,9]));return{id:qde,diagram:e}},"loader"),Aut={id:qde,detector:Eut,loader:Tut},Rut=Aut,Vde="journey",Nut=ie(e=>/^\s*journey/.test(e),"detector"),Iut=ie(async()=>{const{diagram:e}=await Fr(async()=>{const{diagram:t}=await import("./journeyDiagram-U35MCT3I-Cqkeyu5_.js");return{diagram:t}},__vite__mapDeps([33,7,21]));return{id:Vde,diagram:e}},"loader"),Mut={id:Vde,detector:Nut,loader:Iut},jut=Mut,Put=ie((e,t,n)=>{qt.debug(`rendering svg for syntax error
`);const r=Vlt(t),s=r.append("g");r.attr("viewBox","0 0 2412 512"),Cae(r,100,512,!0),s.append("path").attr("class","error-icon").attr("d","m411.313,123.313c6.25-6.25 6.25-16.375 0-22.625s-16.375-6.25-22.625,0l-32,32-9.375,9.375-20.688-20.688c-12.484-12.5-32.766-12.5-45.25,0l-16,16c-1.261,1.261-2.304,2.648-3.31,4.051-21.739-8.561-45.324-13.426-70.065-13.426-105.867,0-192,86.133-192,192s86.133,192 192,192 192-86.133 192-192c0-24.741-4.864-48.327-13.426-70.065 1.402-1.007 2.79-2.049 4.051-3.31l16-16c12.5-12.492 12.5-32.758 0-45.25l-20.688-20.688 9.375-9.375 32.001-31.999zm-219.313,100.687c-52.938,0-96,43.063-96,96 0,8.836-7.164,16-16,16s-16-7.164-16-16c0-70.578 57.422-128 128-128 8.836,0 16,7.164 16,16s-7.164,16-16,16z"),s.append("path").attr("class","error-icon").attr("d","m459.02,148.98c-6.25-6.25-16.375-6.25-22.625,0s-6.25,16.375 0,22.625l16,16c3.125,3.125 7.219,4.688 11.313,4.688 4.094,0 8.188-1.563 11.313-4.688 6.25-6.25 6.25-16.375 0-22.625l-16.001-16z"),s.append("path").attr("class","error-icon").attr("d","m340.395,75.605c3.125,3.125 7.219,4.688 11.313,4.688 4.094,0 8.188-1.563 11.313-4.688 6.25-6.25 6.25-16.375 0-22.625l-16-16c-6.25-6.25-16.375-6.25-22.625,0s-6.25,16.375 0,22.625l15.999,16z"),s.append("path").attr("class","error-icon").attr("d","m400,64c8.844,0 16-7.164 16-16v-32c0-8.836-7.156-16-16-16-8.844,0-16,7.164-16,16v32c0,8.836 7.156,16 16,16z"),s.append("path").attr("class","error-icon").attr("d","m496,96.586h-32c-8.844,0-16,7.164-16,16 0,8.836 7.156,16 16,16h32c8.844,0 16-7.164 16-16 0-8.836-7.156-16-16-16z"),s.append("path").attr("class","error-icon").attr("d","m436.98,75.605c3.125,3.125 7.219,4.688 11.313,4.688 4.094,0 8.188-1.563 11.313-4.688l32-32c6.25-6.25 6.25-16.375 0-22.625s-16.375-6.25-22.625,0l-32,32c-6.251,6.25-6.251,16.375-0.001,22.625z"),s.append("text").attr("class","error-text").attr("x",1440).attr("y",250).attr("font-size","150px").style("text-anchor","middle").text("Syntax error in text"),s.append("text").attr("class","error-text").attr("x",1250).attr("y",400).attr("font-size","100px").style("text-anchor","middle").text(`mermaid version ${n}`)},"draw"),Wde={draw:Put},Out=Wde,Dut={db:{},renderer:Wde,parser:{parse:ie(()=>{},"parse")}},Fut=Dut,Hde="flowchart-elk",Lut=ie((e,t={})=>{var n;return/^\s*flowchart-elk/.test(e)||/^\s*flowchart|graph/.test(e)&&((n=t==null?void 0:t.flowchart)==null?void 0:n.defaultRenderer)==="elk"?(t.layout="elk",!0):!1},"detector"),But=ie(async()=>{const{diagram:e}=await Fr(async()=>{const{diagram:t}=await import("./flowDiagram-4HSFHLVR-BEU4pOJ5.js");return{diagram:t}},__vite__mapDeps([8,9,10]));return{id:Hde,diagram:e}},"loader"),$ut={id:Hde,detector:Lut,loader:But},zut=$ut,Gde="timeline",Uut=ie(e=>/^\s*timeline/.test(e),"detector"),qut=ie(async()=>{const{diagram:e}=await Fr(async()=>{const{diagram:t}=await import("./timeline-definition-BDJGKUSR-DsCIzaY8.js");return{diagram:t}},__vite__mapDeps([34,21]));return{id:Gde,diagram:e}},"loader"),Vut={id:Gde,detector:Uut,loader:qut},Wut=Vut,Kde="mindmap",Hut=ie(e=>/^\s*mindmap/.test(e),"detector"),Gut=ie(async()=>{const{diagram:e}=await Fr(async()=>{const{diagram:t}=await import("./mindmap-definition-ALO5MXBD-lQ8UUZk1.js");return{diagram:t}},__vite__mapDeps([35,36]));return{id:Kde,diagram:e}},"loader"),Kut={id:Kde,detector:Hut,loader:Gut},Yut=Kut,Yde="kanban",Zut=ie(e=>/^\s*kanban/.test(e),"detector"),Xut=ie(async()=>{const{diagram:e}=await Fr(async()=>{const{diagram:t}=await import("./kanban-definition-NDS4AKOZ-J0kloUsT.js");return{diagram:t}},[]);return{id:Yde,diagram:e}},"loader"),Jut={id:Yde,detector:Zut,loader:Xut},Qut=Jut,Zde="sankey",edt=ie(e=>/^\s*sankey-beta/.test(e),"detector"),tdt=ie(async()=>{const{diagram:e}=await Fr(async()=>{const{diagram:t}=await import("./sankeyDiagram-QLVOVGJD-aOaimDEW.js");return{diagram:t}},__vite__mapDeps([37,22,18]));return{id:Zde,diagram:e}},"loader"),ndt={id:Zde,detector:edt,loader:tdt},rdt=ndt,Xde="packet",sdt=ie(e=>/^\s*packet-beta/.test(e),"detector"),idt=ie(async()=>{const{diagram:e}=await Fr(async()=>{const{diagram:t}=await import("./diagram-VNBRO52H-Cj43Pxrz.js");return{diagram:t}},__vite__mapDeps([38,13,15,2,4,5]));return{id:Xde,diagram:e}},"loader"),adt={id:Xde,detector:sdt,loader:idt},Jde="radar",odt=ie(e=>/^\s*radar-beta/.test(e),"detector"),ldt=ie(async()=>{const{diagram:e}=await Fr(async()=>{const{diagram:t}=await import("./diagram-SSKATNLV-BfgSKhnp.js");return{diagram:t}},__vite__mapDeps([39,13,15,2,4,5]));return{id:Jde,diagram:e}},"loader"),cdt={id:Jde,detector:odt,loader:ldt},Qde="block",udt=ie(e=>/^\s*block-beta/.test(e),"detector"),ddt=ie(async()=>{const{diagram:e}=await Fr(async()=>{const{diagram:t}=await import("./blockDiagram-JOT3LUYC-D6qkrzE8.js");return{diagram:t}},__vite__mapDeps([40,5,2,1,10]));return{id:Qde,diagram:e}},"loader"),fdt={id:Qde,detector:udt,loader:ddt},hdt=fdt,efe="architecture",pdt=ie(e=>/^\s*architecture/.test(e),"detector"),mdt=ie(async()=>{const{diagram:e}=await Fr(async()=>{const{diagram:t}=await import("./architectureDiagram-IEHRJDOE-DnhRXVCc.js");return{diagram:t}},__vite__mapDeps([41,13,14,15,2,4,5,36]));return{id:efe,diagram:e}},"loader"),gdt={id:efe,detector:pdt,loader:mdt},ydt=gdt,lH=!1,jA=ie(()=>{lH||(lH=!0,Kk("error",Fut,e=>e.toLowerCase().trim()==="error"),Kk("---",{db:{clear:ie(()=>{},"clear")},styles:{},renderer:{draw:ie(()=>{},"draw")},parser:{parse:ie(()=>{throw new Error("Diagrams beginning with --- are not valid. If you were trying to use a YAML front-matter, please ensure that you've correctly opened and closed the YAML front-matter with un-indented `---` blocks")},"parse")},init:ie(()=>null,"init")},e=>e.toLowerCase().trimStart().startsWith("---")),dae(kct,Qut,wut,yut,Fct,Wct,Kct,Xct,cut,hut,zut,jct,Rct,Yut,Wut,zct,Rut,kut,jut,tut,rdt,adt,iut,hdt,ydt,cdt))},"addDiagrams"),bdt=ie(async()=>{qt.debug("Loading registered diagrams");const t=(await Promise.allSettled(Object.entries($y).map(async([n,{detector:r,loader:s}])=>{if(s)try{s4(n)}catch{try{const{diagram:i,id:a}=await s();Kk(a,i,r)}catch(i){throw qt.error(`Failed to load external diagram with key ${n}. Removing from detectors.`),delete $y[n],i}}}))).filter(n=>n.status==="rejected");if(t.length>0){qt.error(`Failed to load ${t.length} external diagrams`);for(const n of t)qt.error(n);throw new Error(`Failed to load ${t.length} external diagrams`)}},"loadRegisteredDiagrams"),vdt="graphics-document document";function tfe(e,t){e.attr("role",vdt),t!==""&&e.attr("aria-roledescription",t)}ie(tfe,"setA11yDiagramInfo");function nfe(e,t,n,r){if(e.insert!==void 0){if(n){const s=`chart-desc-${r}`;e.attr("aria-describedby",s),e.insert("desc",":first-child").attr("id",s).text(n)}if(t){const s=`chart-title-${r}`;e.attr("aria-labelledby",s),e.insert("title",":first-child").attr("id",s).text(t)}}}ie(nfe,"addSVGa11yTitleDescription");var km,G4=(km=class{constructor(t,n,r,s,i){this.type=t,this.text=n,this.db=r,this.parser=s,this.renderer=i}static async fromText(t,n={}){var c,u;const r=Go(),s=I6(t,r);t=$at(t)+`
`;try{s4(s)}catch{const d=VXe(s);if(!d)throw new uae(`Diagram ${s} not found.`);const{id:h,diagram:m}=await d();Kk(h,m)}const{db:i,parser:a,renderer:o,init:l}=s4(s);return a.parser&&(a.parser.yy=i),(c=i.clear)==null||c.call(i),l==null||l(r),n.title&&((u=i.setDiagramTitle)==null||u.call(i,n.title)),await a.parse(t),new km(s,t,i,a,o)}async render(t,n){await this.renderer.draw(this.text,t,n,this)}getParser(){return this.parser}getType(){return this.type}},ie(km,"Diagram"),km),cH=[],xdt=ie(()=>{cH.forEach(e=>{e()}),cH=[]},"attachFunctions"),wdt=ie(e=>e.replace(/^\s*%%(?!{)[^\n]+\n?/gm,"").trimStart(),"cleanupComments");function rfe(e){const t=e.match(cae);if(!t)return{text:e,metadata:{}};let n=qQe(t[1],{schema:UQe})??{};n=typeof n=="object"&&!Array.isArray(n)?n:{};const r={};return n.displayMode&&(r.displayMode=n.displayMode.toString()),n.title&&(r.title=n.title.toString()),n.config&&(r.config=n.config),{text:e.slice(t[0].length),metadata:r}}ie(rfe,"extractFrontMatter");var Sdt=ie(e=>e.replace(/\r\n?/g,`
`).replace(/<(\w+)([^>]*)>/g,(t,n,r)=>"<"+n+r.replace(/="([^"]*)"/g,"='$1'")+">"),"cleanupText"),_dt=ie(e=>{const{text:t,metadata:n}=rfe(e),{displayMode:r,title:s,config:i={}}=n;return r&&(i.gantt||(i.gantt={}),i.gantt.displayMode=r),{title:s,config:i,text:t}},"processFrontmatter"),Cdt=ie(e=>{const t=Au.detectInit(e)??{},n=Au.detectDirective(e,"wrap");return Array.isArray(n)?t.wrap=n.some(({type:r})=>r==="wrap"):(n==null?void 0:n.type)==="wrap"&&(t.wrap=!0),{text:Tat(e),directive:t}},"processDirectives");function N5(e){const t=Sdt(e),n=_dt(t),r=Cdt(n.text),s=h5(n.config,r.directive);return e=wdt(r.text),{code:e,title:n.title,config:s}}ie(N5,"preprocessDiagram");function sfe(e){const t=new TextEncoder().encode(e),n=Array.from(t,r=>String.fromCodePoint(r)).join("");return btoa(n)}ie(sfe,"toBase64");var kdt=5e4,Edt="graph TB;a[Maximum text size in diagram exceeded];style a fill:#faa",Tdt="sandbox",Adt="loose",Rdt="http://www.w3.org/2000/svg",Ndt="http://www.w3.org/1999/xlink",Idt="http://www.w3.org/1999/xhtml",Mdt="100%",jdt="100%",Pdt="border:0;margin:0;",Odt="margin:0",Ddt="allow-top-navigation-by-user-activation allow-popups",Fdt='The "iframe" tag is not supported by your browser.',Ldt=["foreignobject"],Bdt=["dominant-baseline"];function I5(e){const t=N5(e);return Hk(),aJe(t.config??{}),t}ie(I5,"processAndSetConfigs");async function ife(e,t){jA();try{const{code:n,config:r}=I5(e);return{diagramType:(await ofe(n)).type,config:r}}catch(n){if(t!=null&&t.suppressErrors)return!1;throw n}}ie(ife,"parse");var uH=ie((e,t,n=[])=>`
.${e} ${t} { ${n.join(" !important; ")} !important; }`,"cssImportantStyles"),$dt=ie((e,t=new Map)=>{var r;let n="";if(e.themeCSS!==void 0&&(n+=`
${e.themeCSS}`),e.fontFamily!==void 0&&(n+=`
:root { --mermaid-font-family: ${e.fontFamily}}`),e.altFontFamily!==void 0&&(n+=`
:root { --mermaid-alt-font-family: ${e.altFontFamily}}`),t instanceof Map){const o=e.htmlLabels??((r=e.flowchart)==null?void 0:r.htmlLabels)?["> *","span"]:["rect","polygon","ellipse","circle","path"];t.forEach(l=>{oH(l.styles)||o.forEach(c=>{n+=uH(l.id,c,l.styles)}),oH(l.textStyles)||(n+=uH(l.id,"tspan",((l==null?void 0:l.textStyles)||[]).map(c=>c.replace("color","fill"))))})}return n},"createCssStyles"),zdt=ie((e,t,n,r)=>{const s=$dt(e,n),i=kJe(t,s,e.themeVariables);return U4(ict(`${r}{${i}}`),oct)},"createUserStyles"),Udt=ie((e="",t,n)=>{let r=e;return!n&&!t&&(r=r.replace(/marker-end="url\([\d+./:=?A-Za-z-]*?#/g,'marker-end="url(#')),r=yg(r),r=r.replace(/<br>/g,"<br/>"),r},"cleanUpSvgCode"),qdt=ie((e="",t)=>{var s,i;const n=(i=(s=t==null?void 0:t.viewBox)==null?void 0:s.baseVal)!=null&&i.height?t.viewBox.baseVal.height+"px":jdt,r=sfe(`<body style="${Odt}">${e}</body>`);return`<iframe style="width:${Mdt};height:${n};${Pdt}" src="data:text/html;charset=UTF-8;base64,${r}" sandbox="${Ddt}">
  ${Fdt}
</iframe>`},"putIntoIFrame"),dH=ie((e,t,n,r,s)=>{const i=e.append("div");i.attr("id",n),r&&i.attr("style",r);const a=i.append("svg").attr("id",t).attr("width","100%").attr("xmlns",Rdt);return s&&a.attr("xmlns:xlink",s),a.append("g"),e},"appendDivSvgG");function K4(e,t){return e.append("iframe").attr("id",t).attr("style","width: 100%; height: 100%;").attr("sandbox","")}ie(K4,"sandboxedIframe");var Vdt=ie((e,t,n,r)=>{var s,i,a;(s=e.getElementById(t))==null||s.remove(),(i=e.getElementById(n))==null||i.remove(),(a=e.getElementById(r))==null||a.remove()},"removeExistingElements"),Wdt=ie(async function(e,t,n){var D,H,O,K,U,W;jA();const r=I5(t);t=r.code;const s=Go();qt.debug(s),t.length>((s==null?void 0:s.maxTextSize)??kdt)&&(t=Edt);const i="#"+e,a="i"+e,o="#"+a,l="d"+e,c="#"+l,u=ie(()=>{const ne=Zr(h?o:c).node();ne&&"remove"in ne&&ne.remove()},"removeTempElements");let d=Zr("body");const h=s.securityLevel===Tdt,m=s.securityLevel===Adt,y=s.fontFamily;if(n!==void 0){if(n&&(n.innerHTML=""),h){const B=K4(Zr(n),a);d=Zr(B.nodes()[0].contentDocument.body),d.node().style.margin=0}else d=Zr(n);dH(d,e,l,`font-family: ${y}`,Ndt)}else{if(Vdt(document,e,l,a),h){const B=K4(Zr("body"),a);d=Zr(B.nodes()[0].contentDocument.body),d.node().style.margin=0}else d=Zr("body");dH(d,e,l)}let b,v;try{b=await G4.fromText(t,{title:r.title})}catch(B){if(s.suppressErrorRendering)throw u(),B;b=await G4.fromText("error"),v=B}const x=d.select(c).node(),w=b.type,_=x.firstChild,k=_.firstChild,C=(H=(D=b.renderer).getClasses)==null?void 0:H.call(D,t,b),T=zdt(s,w,C,i),A=document.createElement("style");A.innerHTML=T,_.insertBefore(A,k);try{await b.renderer.draw(t,e,QW.version,b)}catch(B){throw s.suppressErrorRendering?u():Out.draw(t,e,QW.version),B}const N=d.select(`${c} svg`),I=(K=(O=b.db).getAccTitle)==null?void 0:K.call(O),j=(W=(U=b.db).getAccDescription)==null?void 0:W.call(U);lfe(w,N,I,j),d.select(`[id="${e}"]`).selectAll("foreignobject > *").attr("xmlns",Idt);let L=d.select(c).node().innerHTML;if(qt.debug("config.arrowMarkerAbsolute",s.arrowMarkerAbsolute),L=Udt(L,h,Qi(s.arrowMarkerAbsolute)),h){const B=d.select(c+" svg").node();L=qdt(L,B)}else m||(L=By.sanitize(L,{ADD_TAGS:Ldt,ADD_ATTR:Bdt,HTML_INTEGRATION_POINTS:{foreignobject:!0}}));if(xdt(),v)throw v;return u(),{diagramType:w,svg:L,bindFunctions:b.db.bindFunctions}},"render");function afe(e={}){var r;const t=Ra({},e);t!=null&&t.fontFamily&&!((r=t.themeVariables)!=null&&r.fontFamily)&&(t.themeVariables||(t.themeVariables={}),t.themeVariables.fontFamily=t.fontFamily),sJe(t),t!=null&&t.theme&&t.theme in tf?t.themeVariables=tf[t.theme].getThemeVariables(t.themeVariables):t&&(t.themeVariables=tf.default.getThemeVariables(t.themeVariables));const n=typeof t=="object"?rJe(t):yae();N6(n.logLevel),jA()}ie(afe,"initialize");var ofe=ie((e,t={})=>{const{code:n}=N5(e);return G4.fromText(n,t)},"getDiagramFromText");function lfe(e,t,n,r){tfe(t,e),nfe(t,n,r,t.attr("id"))}ie(lfe,"addA11yInfo");var Km=Object.freeze({render:Wdt,parse:ife,getDiagramFromText:ofe,initialize:afe,getConfig:Go,setConfig:bae,getSiteConfig:yae,updateSiteConfig:iJe,reset:ie(()=>{Hk()},"reset"),globalReset:ie(()=>{Hk(zy)},"globalReset"),defaultConfig:zy});N6(Go().logLevel);Hk(Go());var Hdt=ie((e,t,n)=>{qt.warn(e),f5(e)?(n&&n(e.str,e.hash),t.push({...e,message:e.str,error:e})):(n&&n(e),e instanceof Error&&t.push({str:e.message,message:e.message,hash:e.name,error:e}))},"handleError"),cfe=ie(async function(e={querySelector:".mermaid"}){try{await Gdt(e)}catch(t){if(f5(t)&&qt.error(t.str),xl.parseError&&xl.parseError(t),!e.suppressErrors)throw qt.error("Use the suppressErrors option to suppress these errors"),t}},"run"),Gdt=ie(async function({postRenderCallback:e,querySelector:t,nodes:n}={querySelector:".mermaid"}){const r=Km.getConfig();qt.debug(`${e?"":"No "}Callback function found`);let s;if(n)s=n;else if(t)s=document.querySelectorAll(t);else throw new Error("Nodes and querySelector are both undefined");qt.debug(`Found ${s.length} diagrams`),(r==null?void 0:r.startOnLoad)!==void 0&&(qt.debug("Start On Load: "+(r==null?void 0:r.startOnLoad)),Km.updateSiteConfig({startOnLoad:r==null?void 0:r.startOnLoad}));const i=new Au.InitIDGenerator(r.deterministicIds,r.deterministicIDSeed);let a;const o=[];for(const l of Array.from(s)){if(qt.info("Rendering diagram: "+l.id),l.getAttribute("data-processed"))continue;l.setAttribute("data-processed","true");const c=`mermaid-${i.next()}`;a=l.innerHTML,a=Fce(Au.entityDecode(a)).trim().replace(/<br\s*\/?>/gi,"<br/>");const u=Au.detectInit(a);u&&qt.debug("Detected early reinit: ",u);try{const{svg:d,bindFunctions:h}=await hfe(c,a,l);l.innerHTML=d,e&&await e(c),h&&h(l)}catch(d){Hdt(d,o,xl.parseError)}}if(o.length>0)throw o[0]},"runThrowsErrors"),ufe=ie(function(e){Km.initialize(e)},"initialize"),Kdt=ie(async function(e,t,n){qt.warn("mermaid.init is deprecated. Please use run instead."),e&&ufe(e);const r={postRenderCallback:n,querySelector:".mermaid"};typeof t=="string"?r.querySelector=t:t&&(t instanceof HTMLElement?r.nodes=[t]:r.nodes=t),await cfe(r)},"init"),Ydt=ie(async(e,{lazyLoad:t=!0}={})=>{jA(),dae(...e),t===!1&&await bdt()},"registerExternalDiagrams"),dfe=ie(function(){if(xl.startOnLoad){const{startOnLoad:e}=Km.getConfig();e&&xl.run().catch(t=>qt.error("Mermaid failed to initialize",t))}},"contentLoaded");typeof document<"u"&&window.addEventListener("load",dfe,!1);var Zdt=ie(function(e){xl.parseError=e},"setParseErrorHandler"),kE=[],e3=!1,ffe=ie(async()=>{if(!e3){for(e3=!0;kE.length>0;){const e=kE.shift();if(e)try{await e()}catch(t){qt.error("Error executing queue",t)}}e3=!1}},"executeQueue"),Xdt=ie(async(e,t)=>new Promise((n,r)=>{const s=ie(()=>new Promise((i,a)=>{Km.parse(e,t).then(o=>{i(o),n(o)},o=>{var l;qt.error("Error parsing",o),(l=xl.parseError)==null||l.call(xl,o),a(o),r(o)})}),"performCall");kE.push(s),ffe().catch(r)}),"parse"),hfe=ie((e,t,n)=>new Promise((r,s)=>{const i=ie(()=>new Promise((a,o)=>{Km.render(e,t,n).then(l=>{a(l),r(l)},l=>{var c;qt.error("Error parsing",l),(c=xl.parseError)==null||c.call(xl,l),o(l),s(l)})}),"performCall");kE.push(i),ffe().catch(s)}),"render"),xl={startOnLoad:!0,mermaidAPI:Km,parse:Xdt,render:hfe,init:Kdt,run:cfe,registerExternalDiagrams:Ydt,registerLayoutLoaders:wde,initialize:ufe,parseError:void 0,contentLoaded:dfe,setParseErrorHandler:Zdt,detectType:I6,registerIconPacks:het},Jdt=xl;/*! Check if previously processed *//*!
 * Wait for document loaded before starting the execution
 */const Qdt=new DOMParser,eft=new XMLSerializer;function fH(e,t){const n=e.getAttribute(t);if(!n)return;let r="";for(const s of n.split(/\s+/)){const i=e.getElementById(s);i&&(r+=i.textContent)}return r}let hH=0;const tft=async(e,t)=>{const n=document.createElement("div");n.ariaHidden="true",n.style.maxHeight="0",n.style.opacity="0",n.style.overflow="hidden",t!=null&&t.containerStyle&&Object.assign(n.style,t.containerStyle),document.body.append(n);const r=await Promise.allSettled(e.map(async s=>{const i=`${(t==null?void 0:t.prefix)??"mermaid"}-${hH}`;hH+=1;const{svg:a}=await Jdt.render(i,s,n),o=Qdt.parseFromString(a,"text/html"),[l]=o.getElementsByTagName("svg"),{height:c,width:u}=l.viewBox.baseVal,d=fH(l,"aria-describedby"),h=fH(l,"aria-labelledby"),m={height:c,id:i,svg:eft.serializeToString(l),width:u};return d&&(m.description=d),h&&(m.title=h),m}));return n.remove(),r},nft=()=>tft,rft=({code:e,isStreaming:t=!1})=>{const{foldStreamingCodeBlocks:n}=pr(mn(T=>({foldStreamingCodeBlocks:T.foldStreamingCodeBlocks}))),[r,s]=E.useState(t?n:!1),[i,a]=E.useState(null),[o,l]=E.useState(!1),[c,u]=E.useState(null),[d,h]=E.useState(!1),m=E.useRef(null),y=Bi(mn(T=>Object.values(T.canvasControls))),b=E.useCallback((T,A,N,I,j)=>y.filter(L=>L.type==="codeblock"&&L.targetSlot===T&&L.renderer).map(L=>{if(L.renderer){const D={codeBlockContent:A,codeBlockLang:"mermaid",isFolded:I,toggleFold:j,canvasContextType:"codeblock"};return f.jsx(Ve.Fragment,{children:L.renderer(D)},L.id)}return null}).filter(Boolean),[y]),v=E.useCallback(async()=>{if(!(!e.trim()||r)){l(!0),u(null),a(null);try{const A=await nft()([e]);if(A.length>0&&A[0].status==="fulfilled")a(A[0].value.svg);else if(A.length>0&&A[0].status==="rejected"){const N=A[0].reason;u((N==null?void 0:N.message)||"Failed to render Mermaid diagram")}else u("No results returned from Mermaid renderer")}catch(T){console.error("Mermaid rendering error:",T),u(T instanceof Error?T.message:"Failed to render Mermaid diagram")}finally{l(!1)}}},[e,r]);E.useEffect(()=>{!r&&e.trim()&&!d&&v()},[e,r,d,v]);const x=()=>{const T=r;s(A=>!A),T&&!d&&setTimeout(v,0)},w=E.useCallback(async()=>{if(!i){ke.error("No SVG content to download");return}try{const T=new Blob([i],{type:"image/svg+xml"}),A=URL.createObjectURL(T),N=document.createElement("a");N.href=A,N.download="mermaid-diagram.svg",document.body.appendChild(N),N.click(),document.body.removeChild(N),URL.revokeObjectURL(A),ke.success("SVG downloaded successfully!")}catch(T){console.error("Download error:",T),ke.error("Failed to download SVG")}},[i]),_=E.useCallback(()=>{h(T=>!T)},[]),k=E.useMemo(()=>e?e.split(`
`).slice(0,3).join(`
`):"",[e]),C=b("codeblock-header-actions",e,"mermaid",r,x);return f.jsxs("div",{className:"code-block-container group/codeblock my-4 max-w-full",children:[f.jsxs("div",{className:"code-block-header sticky top-0 z-10 flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx("div",{className:"text-sm font-medium",children:"MERMAID"}),f.jsx("div",{className:"flex items-center gap-0.5 opacity-0 group-hover/codeblock:opacity-100 focus-within:opacity-100 transition-opacity",children:C})]}),f.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover/codeblock:opacity-100 focus-within:opacity-100 transition-opacity",children:[f.jsx("button",{onClick:_,className:"p-1.5 rounded-md hover:bg-muted/50 transition-colors",title:d?"Show diagram":"Show code",children:d?f.jsx(Mh,{className:"h-4 w-4"}):f.jsx(AE,{className:"h-4 w-4"})}),i&&!d&&f.jsx("button",{onClick:w,className:"p-1.5 rounded-md hover:bg-muted/50 transition-colors",title:"Download SVG",children:f.jsx(Fc,{className:"h-4 w-4"})})]})]}),!r&&!t&&f.jsx("div",{className:"overflow-hidden w-full",children:d?f.jsx(R6,{lang:"mermaid",code:e,isStreaming:t}):f.jsxs(f.Fragment,{children:[o&&f.jsxs("div",{className:"flex items-center justify-center p-8",children:[f.jsx(Hn,{className:"h-6 w-6 animate-spin text-muted-foreground"}),f.jsx("span",{className:"ml-2 text-sm text-muted-foreground",children:"Rendering diagram..."})]}),c&&f.jsxs("div",{className:"flex items-center gap-2 p-4 border border-destructive/20 bg-destructive/10 rounded-md",children:[f.jsx(Sl,{className:"h-5 w-5 text-destructive flex-shrink-0"}),f.jsxs("div",{className:"text-sm text-destructive",children:[f.jsx("div",{className:"font-medium",children:"Failed to render Mermaid diagram"}),f.jsx("div",{className:"text-xs mt-1 opacity-80",children:c})]})]}),i&&!o&&!c&&f.jsx("div",{ref:m,className:"mermaid-container p-4 bg-background border rounded-md overflow-auto",dangerouslySetInnerHTML:{__html:i}})]})}),(r||t)&&f.jsx("div",{className:"folded-content-preview p-4 cursor-pointer w-full box-border",onClick:x,children:f.jsx("pre",{className:"whitespace-pre-wrap break-words text-muted-foreground font-mono text-sm",children:k})})]})},sft=E.memo(rft);class ift{constructor(){ce(this,"id","core-block-renderer-mermaid");ce(this,"unregisterCallback")}async initialize(){}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}const n={id:this.id,supportedLanguages:["mermaid"],priority:10,renderer:r=>Ve.createElement(sft,{code:r.code,isStreaming:r.isStreaming})};this.unregisterCallback=t.registerBlockRenderer(n)}destroy(){this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=void 0)}}class im{static parse(t){try{const n=this.sanitizeCode(t),r=this.parseObjectLiteral(n);return this.validateAndSanitize(r)}catch(n){throw new Error(`Failed to parse Formedible definition: ${n instanceof Error?n.message:String(n)}`)}}static sanitizeCode(t){let n=t.replace(/\/\*[\s\S]*?\*\//g,"").replace(/\/\/.*$/gm,"");return n=n.replace(/\b(eval|Function|setTimeout|setInterval|require|import)\s*\(/g,""),n=n.replace(/=>\s*{[^}]*}/g,'""'),n=n.replace(/function\s*\([^)]*\)\s*{[^}]*}/g,'""'),n}static parseObjectLiteral(t){try{return JSON.parse(t)}catch{try{let r=t.trim();return r=this.replaceZodExpressions(r),r=r.replace(/([{,]\s*)([a-zA-Z_$][a-zA-Z0-9_$]*)\s*:/g,'$1"$2":'),r=r.replace(/,(\s*[}\]])/g,"$1"),r=r.replace(/'/g,'"'),JSON.parse(r)}catch(r){throw new Error(`Invalid syntax. Please use valid JSON format or JavaScript object literal syntax. Error: ${r instanceof Error?r.message:String(r)}`)}}}static replaceZodExpressions(t){let n=t,r=!0;for(;r;){r=!1;const s=n.match(/z\.[a-zA-Z]+\(/);if(s){const i=s.index,a=i+s[0].length-1;let o=1,l=a+1;for(;l<n.length&&o>0;)n[l]==="("?o++:n[l]===")"&&o--,l++;if(o===0){let c=l;for(;c<n.length;){const u=n.slice(c).match(/^\.[a-zA-Z]+\(/);if(u){let d=1,m=c+u[0].length-1+1;for(;m<n.length&&d>0;)n[m]==="("?d++:n[m]===")"&&d--,m++;if(d===0)c=m;else break}else break}n=n.slice(0,i)+'"__ZOD_SCHEMA__"'+n.slice(c),r=!0}else n=n.replace(/z\.[a-zA-Z]+/,'"__ZOD_SCHEMA__"'),r=!0}}return n}static validateAndSanitize(t){if(typeof t!="object"||t===null)throw new Error("Definition must be an object");const n={};for(const[r,s]of Object.entries(t))if(this.ALLOWED_KEYS.includes(r))switch(r){case"schema":break;case"fields":n[r]=this.validateFields(s);break;case"pages":n[r]=this.validatePages(s);break;case"progress":n[r]=this.validateProgress(s);break;case"formOptions":n[r]=this.validateFormOptions(s);break;case"submitLabel":case"nextLabel":case"previousLabel":case"formClassName":case"fieldClassName":typeof s=="string"&&(n[r]=s);break}return n}static validateFields(t){if(!Array.isArray(t))throw new Error("Fields must be an array");return t.map((n,r)=>{if(typeof n!="object"||n===null)throw new Error(`Field at index ${r} must be an object`);const s={};for(const[i,a]of Object.entries(n))if(this.ALLOWED_FIELD_KEYS.includes(i))switch(i){case"name":typeof a=="string"&&/^[a-zA-Z_$][a-zA-Z0-9_$]*$/.test(a)&&(s[i]=a);break;case"type":typeof a=="string"&&this.ALLOWED_FIELD_TYPES.includes(a)&&(s[i]=a);break;case"label":case"placeholder":case"description":case"accept":typeof a=="string"&&(s[i]=a);break;case"options":Array.isArray(a)&&(s[i]=a.filter(o=>typeof o=="string"||typeof o=="object"&&o!==null&&typeof o.value=="string"&&typeof o.label=="string"));break;case"min":case"max":case"step":case"page":typeof a=="number"&&!isNaN(a)&&(s[i]=a);break;case"multiple":typeof a=="boolean"&&(s[i]=a);break}if(!s.name||!s.type)throw new Error(`Field at index ${r} must have 'name' and 'type' properties`);return s})}static validatePages(t){return Array.isArray(t)?t.map(n=>{if(typeof n!="object"||n===null)return null;const r={};for(const[s,i]of Object.entries(n))if(this.ALLOWED_PAGE_KEYS.includes(s))switch(s){case"page":typeof i=="number"&&!isNaN(i)&&(r[s]=i);break;case"title":case"description":typeof i=="string"&&(r[s]=i);break}return r.page?r:null}).filter(Boolean):[]}static validateProgress(t){if(typeof t!="object"||t===null)return{};const n={};for(const[r,s]of Object.entries(t))if(this.ALLOWED_PROGRESS_KEYS.includes(r))switch(r){case"showSteps":case"showPercentage":typeof s=="boolean"&&(n[r]=s);break;case"className":typeof s=="string"&&(n[r]=s);break}return n}static validateFormOptions(t){if(typeof t!="object"||t===null)return{};const n={};for(const[r,s]of Object.entries(t))if(this.ALLOWED_FORM_OPTIONS_KEYS.includes(r))switch(r){case"defaultValues":typeof s=="object"&&s!==null&&(n[r]=s);break;case"asyncDebounceMs":typeof s=="number"&&!isNaN(s)&&(n[r]=s);break;case"canSubmitWhenInvalid":typeof s=="boolean"&&(n[r]=s);break}return n}}ce(im,"ALLOWED_FIELD_TYPES",["text","email","password","url","tel","textarea","select","checkbox","switch","number","date","slider","file"]),ce(im,"ALLOWED_KEYS",["schema","fields","pages","progress","submitLabel","nextLabel","previousLabel","formClassName","fieldClassName","formOptions"]),ce(im,"ALLOWED_FIELD_KEYS",["name","type","label","placeholder","description","options","min","max","step","accept","multiple","page","conditional"]),ce(im,"ALLOWED_PAGE_KEYS",["page","title","description"]),ce(im,"ALLOWED_PROGRESS_KEYS",["showSteps","showPercentage","className"]),ce(im,"ALLOWED_FORM_OPTIONS_KEYS",["defaultValues","asyncDebounceMs","canSubmitWhenInvalid"]);const aft=({code:e,isStreaming:t=!1})=>{const{foldStreamingCodeBlocks:n}=pr(mn(H=>({foldStreamingCodeBlocks:H.foldStreamingCodeBlocks}))),[r,s]=E.useState(t?n:!1),[i,a]=E.useState(null),[o,l]=E.useState(!1),[c,u]=E.useState(null),[d,h]=E.useState(!1),[m,y]=E.useState(!1),b=E.useMemo(()=>`_sendOnSubmit_${Nr()}`,[]),v=Bi(mn(H=>Object.values(H.canvasControls))),x=E.useCallback((H,O,K,U,W)=>v.filter(B=>B.type==="codeblock"&&B.targetSlot===H&&B.renderer).map(B=>{if(B.renderer){const ne={codeBlockContent:O,codeBlockLang:"formedible",isFolded:U,toggleFold:W,canvasContextType:"codeblock"};return f.jsx(Ve.Fragment,{children:B.renderer(ne)},B.id)}return null}).filter(Boolean),[v]),w=E.useCallback(async()=>{if(!(!e.trim()||r)){l(!0),u(null),a(null);try{const H=im.parse(e);a(H)}catch(H){console.error("Formedible parsing error:",H),u(H instanceof Error?H.message:"Failed to parse Formedible definition")}finally{l(!1)}}},[e,r]);E.useEffect(()=>{!r&&e.trim()&&!d&&!t&&w()},[e,r,d,t,w]);const _=()=>{const H=r;s(O=>!O),H&&!d&&setTimeout(w,0)},k=E.useCallback(()=>{h(H=>!H)},[]),C=E.useMemo(()=>e?e.split(`
`).slice(0,3).join(`
`):"",[e]),T=E.useCallback(H=>{const O={};return H.forEach(K=>{switch(K.type){case"text":case"email":case"password":case"url":case"tel":case"textarea":O[K.name]=$e();break;case"number":case"slider":O[K.name]=Tt();break;case"checkbox":case"switch":O[K.name]=Qn();break;case"date":O[K.name]=$be();break;case"select":O[K.name]=$e();break;case"file":O[K.name]=sf();break;default:O[K.name]=$e()}}),Ke(O)},[]),A=E.useCallback(H=>{const O={};return H.forEach(K=>{switch(K.type){case"text":case"email":case"password":case"url":case"tel":case"textarea":O[K.name]="";break;case"number":case"slider":O[K.name]=K.min||0;break;case"checkbox":case"switch":O[K.name]=!1;break;case"date":O[K.name]=new Date().toISOString().split("T")[0];break;case"select":if(K.options&&K.options.length>0){const U=K.options[0];O[K.name]=typeof U=="string"?U:U.value}else O[K.name]="";break;case"file":O[K.name]=null;break;default:O[K.name]=""}}),O},[]),N=E.useCallback(async(H,O)=>{try{const U=`These are the form values:
\`\`\`json
${JSON.stringify(H,null,2)}
\`\`\`
`;Ce.emit(an.setInputTextRequest,{text:U}),Ce.emit(an.focusInputRequest,void 0),console.log("Formedible: sendOnSubmit value before conditional: ",O),O?(console.log("Sending form data to prompt"),requestAnimationFrame(()=>{console.log("Setting input text");try{console.log("Creating turn data");const W={id:Nr(),content:U,parameters:{},metadata:{}};Ce.emit(an.submitPromptRequest,{turnData:W}),ke.success("Form submitted and prompt sent!")}catch(W){console.error("Failed to submit prompt:",W),ke.error("Form data added to input, but failed to send prompt")}})):ke.success("Form data added to prompt input")}catch(K){console.error("Form submission error:",K),ke.error("Failed to process form submission")}},[]),I=E.useMemo(()=>{var H;if(!i||!i.fields)return null;try{const O=T(i.fields),K=((H=i.formOptions)==null?void 0:H.defaultValues)||A(i.fields),U=i.pages&&i.pages.length>0?Math.max(...i.pages.map(V=>V.page)):1,W=[...i.fields,{name:b,type:"switch",label:"Send on submit",description:"Automatically send the prompt after form submission",page:U}],B=O.extend({[b]:Qn().default(!1)}),ne={...K,[b]:!1};return{schema:B,fields:W,pages:i.pages,progress:i.progress,submitLabel:i.submitLabel||"Submit",nextLabel:i.nextLabel||"Next",previousLabel:i.previousLabel||"Previous",formClassName:i.formClassName,fieldClassName:i.fieldClassName,formOptions:{...i.formOptions,defaultValues:ne,canSubmitWhenInvalid:!0,onSubmit:async({value:V})=>{console.log("Formedible onSubmit received full value:",V),console.log("Formedible onSubmit received sendOnSubmit:",V[b]);const Q=V[b],ee={...V};delete ee[b],y(Q),await N(ee,Q)},onSubmitInvalid:({value:V,formApi:Q})=>{console.error("Formedible onSubmitInvalid triggered. Values:",V),console.error("Formedible onSubmitInvalid triggered. Form API errors:",Q.formState.errors),ke.error("Form has validation errors. Please check your input.")}},disabled:!1}}catch(O){return console.error("Form configuration error:",O),{error:O instanceof Error?O.message:"Unknown error"}}},[i,T,A,N,b]),j=ug(I&&!("error"in I)?I:{fields:[],formOptions:{defaultValues:{}}}),L=E.useMemo(()=>I?"error"in I?f.jsx("div",{className:"p-4 border border-destructive/20 bg-destructive/10 rounded-md",children:f.jsxs("div",{className:"text-sm text-destructive",children:["Failed to render form: ",I.error]})}):!i||!i.fields?null:f.jsx(j.Form,{}):null,[I,i,j.Form]),D=x("codeblock-header-actions",e,"formedible",r,_);return f.jsxs("div",{className:"code-block-container group/codeblock my-4 max-w-full",children:[f.jsxs("div",{className:"code-block-header sticky top-0 z-[var(--z-sticky)] flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx("div",{className:"text-sm font-medium",children:"Formedible"}),f.jsx("div",{className:"flex items-center gap-0.5 opacity-0 group-hover/codeblock:opacity-100 focus-within:opacity-100 transition-opacity",children:D})]}),f.jsx("div",{className:"flex items-center gap-1 opacity-0 group-hover/codeblock:opacity-100 focus-within:opacity-100 transition-opacity",children:f.jsx("button",{onClick:k,className:"p-1.5 rounded-md hover:bg-muted/50 transition-colors",title:d?"Show form":"Show code",children:d?f.jsx(Kge,{className:"h-4 w-4"}):f.jsx(AE,{className:"h-4 w-4"})})})]}),!r&&f.jsx("div",{className:"overflow-hidden w-full",children:d?f.jsx(R6,{lang:"formedible",code:e,isStreaming:t}):f.jsxs(f.Fragment,{children:[o&&f.jsxs("div",{className:"flex items-center justify-center p-8",children:[f.jsx(Hn,{className:"h-6 w-6 animate-spin text-muted-foreground"}),f.jsx("span",{className:"ml-2 text-sm text-muted-foreground",children:"Parsing form definition..."})]}),c&&f.jsxs("div",{className:"flex items-center gap-2 p-4 border border-destructive/20 bg-destructive/10 rounded-md",children:[f.jsx(Sl,{className:"h-5 w-5 text-destructive flex-shrink-0"}),f.jsxs("div",{className:"text-sm text-destructive",children:[f.jsx("div",{className:"font-medium",children:"Failed to parse Formedible definition"}),f.jsx("div",{className:"text-xs mt-1 opacity-80",children:c})]})]}),L&&!o&&!c&&f.jsxs("div",{className:"p-4 bg-background border rounded-md",children:[f.jsx("div",{className:"mb-4 p-2 bg-muted/50 rounded text-xs text-muted-foreground",children:"📋 Interactive Form - Fill out and submit to add data to prompt input"}),L]})]})}),r&&f.jsx("div",{className:"folded-content-preview p-4 cursor-pointer w-full box-border",onClick:_,children:f.jsx("pre",{className:"whitespace-pre-wrap break-words text-muted-foreground font-mono text-sm",children:C})})]})},oft=E.memo(aft);class lft{constructor(){ce(this,"id","core-block-renderer-formedible");ce(this,"unregisterCallback")}async initialize(){}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}const n={id:this.id,supportedLanguages:["formedible"],priority:10,renderer:r=>Ve.createElement(oft,{code:r.code,isStreaming:r.isStreaming})};this.unregisterCallback=t.registerBlockRenderer(n)}destroy(){this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=void 0)}}const cft=[zHe,AGe,OGe,LYe,uZe,mZe,bZe,B7e,FUe,OUe,dHe,fHe,BHe,xHe,SHe,CHe,qHe,WUe,qVe,FHe,pHe,CWe,zUe,yHe,WHe,YHe,QHe,aGe,SGe,CGe,sWe,aWe,hWe,vWe,xWe,cXe,ift,lft,xZe,KZe,ZZe,SZe,CZe,EZe,AZe,NZe,PZe,MZe,JZe,eXe,rXe,HZe,oXe];function uft(){return f.jsxs(O7e,{children:[f.jsx(j7e,{}),f.jsx(M7e,{}),f.jsx("div",{className:"h-screen bg-background text-foreground flex flex-col",children:f.jsx("main",{className:"flex-grow overflow-hidden",children:f.jsx(E7e,{controls:cft})})})]})}G0e();Whe.createRoot(document.getElementById("root")).render(f.jsx(Ve.StrictMode,{children:f.jsx(uft,{})}));export{Drt as $,Xx as A,UXe as B,PJe as C,h5 as D,Go as E,mae as F,Mat as G,Vlt as H,QW as I,UQe as J,ZXe as K,qy as L,Hft as M,CA as N,M6 as O,VV as P,$rt as Q,f2 as R,Iat as S,_S as T,SJe as U,SS as V,kn as W,Wn as X,kae as Y,_at as Z,ie as _,AJe as a,hXe as a$,Q6 as a0,Jft as a1,tht as a2,x0 as a3,yW as a4,gW as a5,rht as a6,nht as a7,eht as a8,Zft as a9,vat as aA,dit as aB,fat as aC,s5 as aD,oH as aE,_ot as aF,Frt as aG,ga as aH,hA as aI,het as aJ,fet as aK,pg as aL,xat as aM,mce as aN,vA as aO,_A as aP,mE as aQ,yce as aR,pce as aS,Zit as aT,qo as aU,cnt as aV,K6 as aW,Sle as aX,ES as aY,kle as aZ,Yft as a_,Xft as aa,iht as ab,Qft as ac,sht as ad,Zot as ae,vde as af,uht as ag,VQe as ah,Qi as ai,Sp as aj,W6 as ak,Gce as al,yg as am,_ce as an,dr as ao,Gu as ap,I0 as aq,zlt as ar,cht as as,dht as at,oht as au,Pn as av,lht as aw,_lt as ax,vlt as ay,blt as az,TJe as b,Y6 as b0,Sh as b1,uW as b2,gnt as b3,b1 as b4,bat as b5,dat as b6,Jst as b7,i5 as b8,Hit as b9,Di as bA,Fr as bB,Sat as ba,AS as bb,Mb as bc,fE as bd,rat as be,dct as bf,TS as bg,pE as bh,Xit as bi,lce as bj,tit as bk,nit as bl,sm as bm,MW as bn,rit as bo,a5 as bp,eit as bq,ait as br,jb as bs,wp as bt,TW as bu,o5 as bv,uce as bw,W4 as bx,wat as by,SA as bz,ls as c,Zr as d,Cae as e,Ra as f,NJe as g,pf as h,qm as i,yet as j,Ib as k,qt as l,kce as m,Gft as n,hht as o,IJe as p,MJe as q,fht as r,RJe as s,qQe as t,Au as u,mlt as v,Oat as w,aht as x,EJe as y,Kft as z};
