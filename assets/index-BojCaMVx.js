const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/dagre-OKDRZEBW-DBOB1uUV.js","assets/graph-B2bPisRR.js","assets/_baseUniq-D-wsvHvb.js","assets/layout-1Tj1qXKs.js","assets/_basePickBy-8igZeZeT.js","assets/clone-z6cENHr4.js","assets/c4Diagram-VJAJSXHY-C7gNKdfE.js","assets/chunk-D6G4REZN-Cz-VRkIH.js","assets/flowDiagram-4HSFHLVR-CUmn8nOk.js","assets/chunk-RZ5BOZE2-C7_feiXo.js","assets/channel-B2QtaGy6.js","assets/erDiagram-Q7BY3M3F-CPNjoMzo.js","assets/gitGraphDiagram-7IBYFJ6S-CpqKGuaN.js","assets/chunk-4BMEZGHF-BIGzh7gZ.js","assets/chunk-XZIHB7SX-CowUn5Lz.js","assets/radar-MK3ICKWK-Dg_0uvCj.js","assets/ganttDiagram-APWFNJXF-CihBlsLX.js","assets/linear-BzfBaCZB.js","assets/init-Gi6I4Gst.js","assets/infoDiagram-PH2N3AL5-DAPupfWJ.js","assets/pieDiagram-IB7DONF6-Rp0dcLT9.js","assets/arc-GEF7p2Pt.js","assets/ordinal-Cboi1Yqb.js","assets/quadrantDiagram-7GDLP6J5-ALxnb1_I.js","assets/xychartDiagram-VJFVF3MP-FMMwMxkT.js","assets/requirementDiagram-KVF5MWMF-DEpYTEa6.js","assets/sequenceDiagram-X6HHIX6F-Dk73tPff.js","assets/classDiagram-GIVACNV2-BtzZQ87q.js","assets/chunk-A2AXSNBT-1_CK1gXP.js","assets/classDiagram-v2-COTLJTTW-BtzZQ87q.js","assets/stateDiagram-DGXRK772-B4eHhVEu.js","assets/chunk-AEK57VVT-rs5ongcD.js","assets/stateDiagram-v2-YXO3MK2T-BqBjavIS.js","assets/journeyDiagram-U35MCT3I-CpHjorXL.js","assets/timeline-definition-BDJGKUSR-DTcUkqn2.js","assets/mindmap-definition-ALO5MXBD-B_m_27ss.js","assets/cytoscape.esm-BZ-eYKzN.js","assets/sankeyDiagram-QLVOVGJD-CQLCuUH7.js","assets/diagram-VNBRO52H-CCqqz0cc.js","assets/diagram-SSKATNLV-DtAoZgT2.js","assets/blockDiagram-JOT3LUYC-elkzGZkY.js","assets/architectureDiagram-IEHRJDOE-R-njEK5X.js"])))=>i.map(i=>d[i]);
var Yfe=Object.defineProperty;var Zfe=(e,t,n)=>t in e?Yfe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var me=(e,t,n)=>Zfe(e,typeof t!="symbol"?t+"":t,n);function Xfe(e,t){for(var n=0;n<t.length;n++){const r=t[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in e)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(e,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var Xp=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function _a(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var sN={exports:{}},Sv={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var QL;function Jfe(){if(QL)return Sv;QL=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function n(r,s,i){var a=null;if(i!==void 0&&(a=""+i),s.key!==void 0&&(a=""+s.key),"key"in s){i={};for(var o in s)o!=="key"&&(i[o]=s[o])}else i=s;return s=i.ref,{$$typeof:e,type:r,key:a,ref:s!==void 0?s:null,props:i}}return Sv.Fragment=t,Sv.jsx=n,Sv.jsxs=n,Sv}var eB;function Qfe(){return eB||(eB=1,sN.exports=Jfe()),sN.exports}var f=Qfe(),iN={exports:{}};function ehe(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var $W={exports:{}},bi=$W.exports={},lu,cu;function L3(){throw new Error("setTimeout has not been defined")}function B3(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?lu=setTimeout:lu=L3}catch{lu=L3}try{typeof clearTimeout=="function"?cu=clearTimeout:cu=B3}catch{cu=B3}})();function zW(e){if(lu===setTimeout)return setTimeout(e,0);if((lu===L3||!lu)&&setTimeout)return lu=setTimeout,setTimeout(e,0);try{return lu(e,0)}catch{try{return lu.call(null,e,0)}catch{return lu.call(this,e,0)}}}function the(e){if(cu===clearTimeout)return clearTimeout(e);if((cu===B3||!cu)&&clearTimeout)return cu=clearTimeout,clearTimeout(e);try{return cu(e)}catch{try{return cu.call(null,e)}catch{return cu.call(this,e)}}}var Ed=[],T0=!1,Jp,_2=-1;function nhe(){!T0||!Jp||(T0=!1,Jp.length?Ed=Jp.concat(Ed):_2=-1,Ed.length&&UW())}function UW(){if(!T0){var e=zW(nhe);T0=!0;for(var t=Ed.length;t;){for(Jp=Ed,Ed=[];++_2<t;)Jp&&Jp[_2].run();_2=-1,t=Ed.length}Jp=null,T0=!1,the(e)}}bi.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];Ed.push(new qW(e,t)),Ed.length===1&&!T0&&zW(UW)};function qW(e,t){this.fun=e,this.array=t}qW.prototype.run=function(){this.fun.apply(null,this.array)};bi.title="browser";bi.browser=!0;bi.env={};bi.argv=[];bi.version="";bi.versions={};function Jd(){}bi.on=Jd;bi.addListener=Jd;bi.once=Jd;bi.off=Jd;bi.removeListener=Jd;bi.removeAllListeners=Jd;bi.emit=Jd;bi.prependListener=Jd;bi.prependOnceListener=Jd;bi.listeners=function(e){return[]};bi.binding=function(e){throw new Error("process.binding is not supported")};bi.cwd=function(){return"/"};bi.chdir=function(e){throw new Error("process.chdir is not supported")};bi.umask=function(){return 0};var rhe=$W.exports;const Ai=ehe(rhe);var Er={},tB;function she(){if(tB)return Er;tB=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),i=Symbol.for("react.consumer"),a=Symbol.for("react.context"),o=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),c=Symbol.for("react.memo"),u=Symbol.for("react.lazy"),d=Symbol.iterator;function h(W){return W===null||typeof W!="object"?null:(W=d&&W[d]||W["@@iterator"],typeof W=="function"?W:null)}var m={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y=Object.assign,b={};function v(W,Q,ee){this.props=W,this.context=Q,this.refs=b,this.updater=ee||m}v.prototype.isReactComponent={},v.prototype.setState=function(W,Q){if(typeof W!="object"&&typeof W!="function"&&W!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,W,Q,"setState")},v.prototype.forceUpdate=function(W){this.updater.enqueueForceUpdate(this,W,"forceUpdate")};function x(){}x.prototype=v.prototype;function w(W,Q,ee){this.props=W,this.context=Q,this.refs=b,this.updater=ee||m}var S=w.prototype=new x;S.constructor=w,y(S,v.prototype),S.isPureReactComponent=!0;var C=Array.isArray,k={H:null,A:null,T:null,S:null,V:null},A=Object.prototype.hasOwnProperty;function R(W,Q,ee,se,pe,ce){return ee=ce.ref,{$$typeof:e,type:W,key:Q,ref:ee!==void 0?ee:null,props:ce}}function N(W,Q){return R(W.type,Q,void 0,void 0,void 0,W.props)}function I(W){return typeof W=="object"&&W!==null&&W.$$typeof===e}function P(W){var Q={"=":"=0",":":"=2"};return"$"+W.replace(/[=:]/g,function(ee){return Q[ee]})}var L=/\/+/g;function O(W,Q){return typeof W=="object"&&W!==null&&W.key!=null?P(""+W.key):Q.toString(36)}function V(){}function D(W){switch(W.status){case"fulfilled":return W.value;case"rejected":throw W.reason;default:switch(typeof W.status=="string"?W.then(V,V):(W.status="pending",W.then(function(Q){W.status==="pending"&&(W.status="fulfilled",W.value=Q)},function(Q){W.status==="pending"&&(W.status="rejected",W.reason=Q)})),W.status){case"fulfilled":return W.value;case"rejected":throw W.reason}}throw W}function Z(W,Q,ee,se,pe){var ce=typeof W;(ce==="undefined"||ce==="boolean")&&(W=null);var Ie=!1;if(W===null)Ie=!0;else switch(ce){case"bigint":case"string":case"number":Ie=!0;break;case"object":switch(W.$$typeof){case e:case t:Ie=!0;break;case u:return Ie=W._init,Z(Ie(W._payload),Q,ee,se,pe)}}if(Ie)return pe=pe(W),Ie=se===""?"."+O(W,0):se,C(pe)?(ee="",Ie!=null&&(ee=Ie.replace(L,"$&/")+"/"),Z(pe,Q,ee,"",function(Ce){return Ce})):pe!=null&&(I(pe)&&(pe=N(pe,ee+(pe.key==null||W&&W.key===pe.key?"":(""+pe.key).replace(L,"$&/")+"/")+Ie)),Q.push(pe)),1;Ie=0;var De=se===""?".":se+":";if(C(W))for(var Se=0;Se<W.length;Se++)se=W[Se],ce=De+O(se,Se),Ie+=Z(se,Q,ee,ce,pe);else if(Se=h(W),typeof Se=="function")for(W=Se.call(W),Se=0;!(se=W.next()).done;)se=se.value,ce=De+O(se,Se++),Ie+=Z(se,Q,ee,ce,pe);else if(ce==="object"){if(typeof W.then=="function")return Z(D(W),Q,ee,se,pe);throw Q=String(W),Error("Objects are not valid as a React child (found: "+(Q==="[object Object]"?"object with keys {"+Object.keys(W).join(", ")+"}":Q)+"). If you meant to render a collection of children, use an array instead.")}return Ie}function U(W,Q,ee){if(W==null)return W;var se=[],pe=0;return Z(W,se,"","",function(ce){return Q.call(ee,ce,pe++)}),se}function H(W){if(W._status===-1){var Q=W._result;Q=Q(),Q.then(function(ee){(W._status===0||W._status===-1)&&(W._status=1,W._result=ee)},function(ee){(W._status===0||W._status===-1)&&(W._status=2,W._result=ee)}),W._status===-1&&(W._status=0,W._result=Q)}if(W._status===1)return W._result.default;throw W._result}var $=typeof reportError=="function"?reportError:function(W){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var Q=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof W=="object"&&W!==null&&typeof W.message=="string"?String(W.message):String(W),error:W});if(!window.dispatchEvent(Q))return}else if(typeof Ai=="object"&&typeof Ai.emit=="function"){Ai.emit("uncaughtException",W);return}console.error(W)};function ne(){}return Er.Children={map:U,forEach:function(W,Q,ee){U(W,function(){Q.apply(this,arguments)},ee)},count:function(W){var Q=0;return U(W,function(){Q++}),Q},toArray:function(W){return U(W,function(Q){return Q})||[]},only:function(W){if(!I(W))throw Error("React.Children.only expected to receive a single React element child.");return W}},Er.Component=v,Er.Fragment=n,Er.Profiler=s,Er.PureComponent=w,Er.StrictMode=r,Er.Suspense=l,Er.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=k,Er.__COMPILER_RUNTIME={__proto__:null,c:function(W){return k.H.useMemoCache(W)}},Er.cache=function(W){return function(){return W.apply(null,arguments)}},Er.cloneElement=function(W,Q,ee){if(W==null)throw Error("The argument must be a React element, but you passed "+W+".");var se=y({},W.props),pe=W.key,ce=void 0;if(Q!=null)for(Ie in Q.ref!==void 0&&(ce=void 0),Q.key!==void 0&&(pe=""+Q.key),Q)!A.call(Q,Ie)||Ie==="key"||Ie==="__self"||Ie==="__source"||Ie==="ref"&&Q.ref===void 0||(se[Ie]=Q[Ie]);var Ie=arguments.length-2;if(Ie===1)se.children=ee;else if(1<Ie){for(var De=Array(Ie),Se=0;Se<Ie;Se++)De[Se]=arguments[Se+2];se.children=De}return R(W.type,pe,void 0,void 0,ce,se)},Er.createContext=function(W){return W={$$typeof:a,_currentValue:W,_currentValue2:W,_threadCount:0,Provider:null,Consumer:null},W.Provider=W,W.Consumer={$$typeof:i,_context:W},W},Er.createElement=function(W,Q,ee){var se,pe={},ce=null;if(Q!=null)for(se in Q.key!==void 0&&(ce=""+Q.key),Q)A.call(Q,se)&&se!=="key"&&se!=="__self"&&se!=="__source"&&(pe[se]=Q[se]);var Ie=arguments.length-2;if(Ie===1)pe.children=ee;else if(1<Ie){for(var De=Array(Ie),Se=0;Se<Ie;Se++)De[Se]=arguments[Se+2];pe.children=De}if(W&&W.defaultProps)for(se in Ie=W.defaultProps,Ie)pe[se]===void 0&&(pe[se]=Ie[se]);return R(W,ce,void 0,void 0,null,pe)},Er.createRef=function(){return{current:null}},Er.forwardRef=function(W){return{$$typeof:o,render:W}},Er.isValidElement=I,Er.lazy=function(W){return{$$typeof:u,_payload:{_status:-1,_result:W},_init:H}},Er.memo=function(W,Q){return{$$typeof:c,type:W,compare:Q===void 0?null:Q}},Er.startTransition=function(W){var Q=k.T,ee={};k.T=ee;try{var se=W(),pe=k.S;pe!==null&&pe(ee,se),typeof se=="object"&&se!==null&&typeof se.then=="function"&&se.then(ne,$)}catch(ce){$(ce)}finally{k.T=Q}},Er.unstable_useCacheRefresh=function(){return k.H.useCacheRefresh()},Er.use=function(W){return k.H.use(W)},Er.useActionState=function(W,Q,ee){return k.H.useActionState(W,Q,ee)},Er.useCallback=function(W,Q){return k.H.useCallback(W,Q)},Er.useContext=function(W){return k.H.useContext(W)},Er.useDebugValue=function(){},Er.useDeferredValue=function(W,Q){return k.H.useDeferredValue(W,Q)},Er.useEffect=function(W,Q,ee){var se=k.H;if(typeof ee=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return se.useEffect(W,Q)},Er.useId=function(){return k.H.useId()},Er.useImperativeHandle=function(W,Q,ee){return k.H.useImperativeHandle(W,Q,ee)},Er.useInsertionEffect=function(W,Q){return k.H.useInsertionEffect(W,Q)},Er.useLayoutEffect=function(W,Q){return k.H.useLayoutEffect(W,Q)},Er.useMemo=function(W,Q){return k.H.useMemo(W,Q)},Er.useOptimistic=function(W,Q){return k.H.useOptimistic(W,Q)},Er.useReducer=function(W,Q,ee){return k.H.useReducer(W,Q,ee)},Er.useRef=function(W){return k.H.useRef(W)},Er.useState=function(W){return k.H.useState(W)},Er.useSyncExternalStore=function(W,Q,ee){return k.H.useSyncExternalStore(W,Q,ee)},Er.useTransition=function(){return k.H.useTransition()},Er.version="19.1.0",Er}var nB;function a1(){return nB||(nB=1,iN.exports=she()),iN.exports}var T=a1();const We=_a(T),VW=Xfe({__proto__:null,default:We},[T]);var aN={exports:{}},Cv={},oN={exports:{}},lN={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var rB;function ihe(){return rB||(rB=1,function(e){function t(U,H){var $=U.length;U.push(H);e:for(;0<$;){var ne=$-1>>>1,W=U[ne];if(0<s(W,H))U[ne]=H,U[$]=W,$=ne;else break e}}function n(U){return U.length===0?null:U[0]}function r(U){if(U.length===0)return null;var H=U[0],$=U.pop();if($!==H){U[0]=$;e:for(var ne=0,W=U.length,Q=W>>>1;ne<Q;){var ee=2*(ne+1)-1,se=U[ee],pe=ee+1,ce=U[pe];if(0>s(se,$))pe<W&&0>s(ce,se)?(U[ne]=ce,U[pe]=$,ne=pe):(U[ne]=se,U[ee]=$,ne=ee);else if(pe<W&&0>s(ce,$))U[ne]=ce,U[pe]=$,ne=pe;else break e}}return H}function s(U,H){var $=U.sortIndex-H.sortIndex;return $!==0?$:U.id-H.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var a=Date,o=a.now();e.unstable_now=function(){return a.now()-o}}var l=[],c=[],u=1,d=null,h=3,m=!1,y=!1,b=!1,v=!1,x=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,S=typeof setImmediate<"u"?setImmediate:null;function C(U){for(var H=n(c);H!==null;){if(H.callback===null)r(c);else if(H.startTime<=U)r(c),H.sortIndex=H.expirationTime,t(l,H);else break;H=n(c)}}function k(U){if(b=!1,C(U),!y)if(n(l)!==null)y=!0,A||(A=!0,O());else{var H=n(c);H!==null&&Z(k,H.startTime-U)}}var A=!1,R=-1,N=5,I=-1;function P(){return v?!0:!(e.unstable_now()-I<N)}function L(){if(v=!1,A){var U=e.unstable_now();I=U;var H=!0;try{e:{y=!1,b&&(b=!1,w(R),R=-1),m=!0;var $=h;try{t:{for(C(U),d=n(l);d!==null&&!(d.expirationTime>U&&P());){var ne=d.callback;if(typeof ne=="function"){d.callback=null,h=d.priorityLevel;var W=ne(d.expirationTime<=U);if(U=e.unstable_now(),typeof W=="function"){d.callback=W,C(U),H=!0;break t}d===n(l)&&r(l),C(U)}else r(l);d=n(l)}if(d!==null)H=!0;else{var Q=n(c);Q!==null&&Z(k,Q.startTime-U),H=!1}}break e}finally{d=null,h=$,m=!1}H=void 0}}finally{H?O():A=!1}}}var O;if(typeof S=="function")O=function(){S(L)};else if(typeof MessageChannel<"u"){var V=new MessageChannel,D=V.port2;V.port1.onmessage=L,O=function(){D.postMessage(null)}}else O=function(){x(L,0)};function Z(U,H){R=x(function(){U(e.unstable_now())},H)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(U){U.callback=null},e.unstable_forceFrameRate=function(U){0>U||125<U?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):N=0<U?Math.floor(1e3/U):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_next=function(U){switch(h){case 1:case 2:case 3:var H=3;break;default:H=h}var $=h;h=H;try{return U()}finally{h=$}},e.unstable_requestPaint=function(){v=!0},e.unstable_runWithPriority=function(U,H){switch(U){case 1:case 2:case 3:case 4:case 5:break;default:U=3}var $=h;h=U;try{return H()}finally{h=$}},e.unstable_scheduleCallback=function(U,H,$){var ne=e.unstable_now();switch(typeof $=="object"&&$!==null?($=$.delay,$=typeof $=="number"&&0<$?ne+$:ne):$=ne,U){case 1:var W=-1;break;case 2:W=250;break;case 5:W=1073741823;break;case 4:W=1e4;break;default:W=5e3}return W=$+W,U={id:u++,callback:H,priorityLevel:U,startTime:$,expirationTime:W,sortIndex:-1},$>ne?(U.sortIndex=$,t(c,U),n(l)===null&&U===n(c)&&(b?(w(R),R=-1):b=!0,Z(k,$-ne))):(U.sortIndex=W,t(l,U),y||m||(y=!0,A||(A=!0,O()))),U},e.unstable_shouldYield=P,e.unstable_wrapCallback=function(U){var H=h;return function(){var $=h;h=H;try{return U.apply(this,arguments)}finally{h=$}}}}(lN)),lN}var sB;function ahe(){return sB||(sB=1,oN.exports=ihe()),oN.exports}var cN={exports:{}},Ta={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var iB;function ohe(){if(iB)return Ta;iB=1;var e=a1();function t(l){var c="https://react.dev/errors/"+l;if(1<arguments.length){c+="?args[]="+encodeURIComponent(arguments[1]);for(var u=2;u<arguments.length;u++)c+="&args[]="+encodeURIComponent(arguments[u])}return"Minified React error #"+l+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var r={d:{f:n,r:function(){throw Error(t(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},s=Symbol.for("react.portal");function i(l,c,u){var d=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:d==null?null:""+d,children:l,containerInfo:c,implementation:u}}var a=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function o(l,c){if(l==="font")return"";if(typeof c=="string")return c==="use-credentials"?c:""}return Ta.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,Ta.createPortal=function(l,c){var u=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!c||c.nodeType!==1&&c.nodeType!==9&&c.nodeType!==11)throw Error(t(299));return i(l,c,null,u)},Ta.flushSync=function(l){var c=a.T,u=r.p;try{if(a.T=null,r.p=2,l)return l()}finally{a.T=c,r.p=u,r.d.f()}},Ta.preconnect=function(l,c){typeof l=="string"&&(c?(c=c.crossOrigin,c=typeof c=="string"?c==="use-credentials"?c:"":void 0):c=null,r.d.C(l,c))},Ta.prefetchDNS=function(l){typeof l=="string"&&r.d.D(l)},Ta.preinit=function(l,c){if(typeof l=="string"&&c&&typeof c.as=="string"){var u=c.as,d=o(u,c.crossOrigin),h=typeof c.integrity=="string"?c.integrity:void 0,m=typeof c.fetchPriority=="string"?c.fetchPriority:void 0;u==="style"?r.d.S(l,typeof c.precedence=="string"?c.precedence:void 0,{crossOrigin:d,integrity:h,fetchPriority:m}):u==="script"&&r.d.X(l,{crossOrigin:d,integrity:h,fetchPriority:m,nonce:typeof c.nonce=="string"?c.nonce:void 0})}},Ta.preinitModule=function(l,c){if(typeof l=="string")if(typeof c=="object"&&c!==null){if(c.as==null||c.as==="script"){var u=o(c.as,c.crossOrigin);r.d.M(l,{crossOrigin:u,integrity:typeof c.integrity=="string"?c.integrity:void 0,nonce:typeof c.nonce=="string"?c.nonce:void 0})}}else c==null&&r.d.M(l)},Ta.preload=function(l,c){if(typeof l=="string"&&typeof c=="object"&&c!==null&&typeof c.as=="string"){var u=c.as,d=o(u,c.crossOrigin);r.d.L(l,u,{crossOrigin:d,integrity:typeof c.integrity=="string"?c.integrity:void 0,nonce:typeof c.nonce=="string"?c.nonce:void 0,type:typeof c.type=="string"?c.type:void 0,fetchPriority:typeof c.fetchPriority=="string"?c.fetchPriority:void 0,referrerPolicy:typeof c.referrerPolicy=="string"?c.referrerPolicy:void 0,imageSrcSet:typeof c.imageSrcSet=="string"?c.imageSrcSet:void 0,imageSizes:typeof c.imageSizes=="string"?c.imageSizes:void 0,media:typeof c.media=="string"?c.media:void 0})}},Ta.preloadModule=function(l,c){if(typeof l=="string")if(c){var u=o(c.as,c.crossOrigin);r.d.m(l,{as:typeof c.as=="string"&&c.as!=="script"?c.as:void 0,crossOrigin:u,integrity:typeof c.integrity=="string"?c.integrity:void 0})}else r.d.m(l)},Ta.requestFormReset=function(l){r.d.r(l)},Ta.unstable_batchedUpdates=function(l,c){return l(c)},Ta.useFormState=function(l,c,u){return a.H.useFormState(l,c,u)},Ta.useFormStatus=function(){return a.H.useHostTransitionStatus()},Ta.version="19.1.0",Ta}var aB;function WW(){if(aB)return cN.exports;aB=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),cN.exports=ohe(),cN.exports}var oB;function lhe(){if(oB)return Cv;oB=1;var e=ahe(),t=a1(),n=WW();function r(p){var g="https://react.dev/errors/"+p;if(1<arguments.length){g+="?args[]="+encodeURIComponent(arguments[1]);for(var _=2;_<arguments.length;_++)g+="&args[]="+encodeURIComponent(arguments[_])}return"Minified React error #"+p+"; visit "+g+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(p){return!(!p||p.nodeType!==1&&p.nodeType!==9&&p.nodeType!==11)}function i(p){var g=p,_=p;if(p.alternate)for(;g.return;)g=g.return;else{p=g;do g=p,(g.flags&4098)!==0&&(_=g.return),p=g.return;while(p)}return g.tag===3?_:null}function a(p){if(p.tag===13){var g=p.memoizedState;if(g===null&&(p=p.alternate,p!==null&&(g=p.memoizedState)),g!==null)return g.dehydrated}return null}function o(p){if(i(p)!==p)throw Error(r(188))}function l(p){var g=p.alternate;if(!g){if(g=i(p),g===null)throw Error(r(188));return g!==p?null:p}for(var _=p,E=g;;){var j=_.return;if(j===null)break;var q=j.alternate;if(q===null){if(E=j.return,E!==null){_=E;continue}break}if(j.child===q.child){for(q=j.child;q;){if(q===_)return o(j),p;if(q===E)return o(j),g;q=q.sibling}throw Error(r(188))}if(_.return!==E.return)_=j,E=q;else{for(var ue=!1,Re=j.child;Re;){if(Re===_){ue=!0,_=j,E=q;break}if(Re===E){ue=!0,E=j,_=q;break}Re=Re.sibling}if(!ue){for(Re=q.child;Re;){if(Re===_){ue=!0,_=q,E=j;break}if(Re===E){ue=!0,E=q,_=j;break}Re=Re.sibling}if(!ue)throw Error(r(189))}}if(_.alternate!==E)throw Error(r(190))}if(_.tag!==3)throw Error(r(188));return _.stateNode.current===_?p:g}function c(p){var g=p.tag;if(g===5||g===26||g===27||g===6)return p;for(p=p.child;p!==null;){if(g=c(p),g!==null)return g;p=p.sibling}return null}var u=Object.assign,d=Symbol.for("react.element"),h=Symbol.for("react.transitional.element"),m=Symbol.for("react.portal"),y=Symbol.for("react.fragment"),b=Symbol.for("react.strict_mode"),v=Symbol.for("react.profiler"),x=Symbol.for("react.provider"),w=Symbol.for("react.consumer"),S=Symbol.for("react.context"),C=Symbol.for("react.forward_ref"),k=Symbol.for("react.suspense"),A=Symbol.for("react.suspense_list"),R=Symbol.for("react.memo"),N=Symbol.for("react.lazy"),I=Symbol.for("react.activity"),P=Symbol.for("react.memo_cache_sentinel"),L=Symbol.iterator;function O(p){return p===null||typeof p!="object"?null:(p=L&&p[L]||p["@@iterator"],typeof p=="function"?p:null)}var V=Symbol.for("react.client.reference");function D(p){if(p==null)return null;if(typeof p=="function")return p.$$typeof===V?null:p.displayName||p.name||null;if(typeof p=="string")return p;switch(p){case y:return"Fragment";case v:return"Profiler";case b:return"StrictMode";case k:return"Suspense";case A:return"SuspenseList";case I:return"Activity"}if(typeof p=="object")switch(p.$$typeof){case m:return"Portal";case S:return(p.displayName||"Context")+".Provider";case w:return(p._context.displayName||"Context")+".Consumer";case C:var g=p.render;return p=p.displayName,p||(p=g.displayName||g.name||"",p=p!==""?"ForwardRef("+p+")":"ForwardRef"),p;case R:return g=p.displayName||null,g!==null?g:D(p.type)||"Memo";case N:g=p._payload,p=p._init;try{return D(p(g))}catch{}}return null}var Z=Array.isArray,U=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,H=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,$={pending:!1,data:null,method:null,action:null},ne=[],W=-1;function Q(p){return{current:p}}function ee(p){0>W||(p.current=ne[W],ne[W]=null,W--)}function se(p,g){W++,ne[W]=p.current,p.current=g}var pe=Q(null),ce=Q(null),Ie=Q(null),De=Q(null);function Se(p,g){switch(se(Ie,g),se(ce,p),se(pe,null),g.nodeType){case 9:case 11:p=(p=g.documentElement)&&(p=p.namespaceURI)?TL(p):0;break;default:if(p=g.tagName,g=g.namespaceURI)g=TL(g),p=AL(g,p);else switch(p){case"svg":p=1;break;case"math":p=2;break;default:p=0}}ee(pe),se(pe,p)}function Ce(){ee(pe),ee(ce),ee(Ie)}function qe(p){p.memoizedState!==null&&se(De,p);var g=pe.current,_=AL(g,p.type);g!==_&&(se(ce,p),se(pe,_))}function Qe(p){ce.current===p&&(ee(pe),ee(ce)),De.current===p&&(ee(De),bv._currentValue=$)}var Ve=Object.prototype.hasOwnProperty,Ne=e.unstable_scheduleCallback,K=e.unstable_cancelCallback,ge=e.unstable_shouldYield,Ae=e.unstable_requestPaint,le=e.unstable_now,oe=e.unstable_getCurrentPriorityLevel,re=e.unstable_ImmediatePriority,Te=e.unstable_UserBlockingPriority,Be=e.unstable_NormalPriority,ke=e.unstable_LowPriority,lt=e.unstable_IdlePriority,Rt=e.log,ht=e.unstable_setDisableYieldValue,Pt=null,qt=null;function Lt(p){if(typeof Rt=="function"&&ht(p),qt&&typeof qt.setStrictMode=="function")try{qt.setStrictMode(Pt,p)}catch{}}var en=Math.clz32?Math.clz32:X,xe=Math.log,F=Math.LN2;function X(p){return p>>>=0,p===0?32:31-(xe(p)/F|0)|0}var ye=256,Fe=4194304;function we(p){var g=p&42;if(g!==0)return g;switch(p&-p){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return p&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return p&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return p}}function Me(p,g,_){var E=p.pendingLanes;if(E===0)return 0;var j=0,q=p.suspendedLanes,ue=p.pingedLanes;p=p.warmLanes;var Re=E&134217727;return Re!==0?(E=Re&~q,E!==0?j=we(E):(ue&=Re,ue!==0?j=we(ue):_||(_=Re&~p,_!==0&&(j=we(_))))):(Re=E&~q,Re!==0?j=we(Re):ue!==0?j=we(ue):_||(_=E&~p,_!==0&&(j=we(_)))),j===0?0:g!==0&&g!==j&&(g&q)===0&&(q=j&-j,_=g&-g,q>=_||q===32&&(_&4194048)!==0)?g:j}function de(p,g){return(p.pendingLanes&~(p.suspendedLanes&~p.pingedLanes)&g)===0}function vt(p,g){switch(p){case 1:case 2:case 4:case 8:case 64:return g+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return g+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ot(){var p=ye;return ye<<=1,(ye&4194048)===0&&(ye=256),p}function B(){var p=Fe;return Fe<<=1,(Fe&62914560)===0&&(Fe=4194304),p}function ze(p){for(var g=[],_=0;31>_;_++)g.push(p);return g}function st(p,g){p.pendingLanes|=g,g!==268435456&&(p.suspendedLanes=0,p.pingedLanes=0,p.warmLanes=0)}function be(p,g,_,E,j,q){var ue=p.pendingLanes;p.pendingLanes=_,p.suspendedLanes=0,p.pingedLanes=0,p.warmLanes=0,p.expiredLanes&=_,p.entangledLanes&=_,p.errorRecoveryDisabledLanes&=_,p.shellSuspendCounter=0;var Re=p.entanglements,Ye=p.expirationTimes,wt=p.hiddenUpdates;for(_=ue&~_;0<_;){var Dt=31-en(_),Bt=1<<Dt;Re[Dt]=0,Ye[Dt]=-1;var Ct=wt[Dt];if(Ct!==null)for(wt[Dt]=null,Dt=0;Dt<Ct.length;Dt++){var At=Ct[Dt];At!==null&&(At.lane&=-536870913)}_&=~Bt}E!==0&&_e(p,E,0),q!==0&&j===0&&p.tag!==0&&(p.suspendedLanes|=q&~(ue&~g))}function _e(p,g,_){p.pendingLanes|=g,p.suspendedLanes&=~g;var E=31-en(g);p.entangledLanes|=g,p.entanglements[E]=p.entanglements[E]|1073741824|_&4194090}function Ue(p,g){var _=p.entangledLanes|=g;for(p=p.entanglements;_;){var E=31-en(_),j=1<<E;j&g|p[E]&g&&(p[E]|=g),_&=~j}}function kt(p){switch(p){case 2:p=1;break;case 8:p=4;break;case 32:p=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:p=128;break;case 268435456:p=134217728;break;default:p=0}return p}function fe(p){return p&=-p,2<p?8<p?(p&134217727)!==0?32:268435456:8:2}function Y(){var p=H.p;return p!==0?p:(p=window.event,p===void 0?32:GL(p.type))}function G(p,g){var _=H.p;try{return H.p=p,g()}finally{H.p=_}}var J=Math.random().toString(36).slice(2),ve="__reactFiber$"+J,Oe="__reactProps$"+J,Ge="__reactContainer$"+J,_t="__reactEvents$"+J,tn="__reactListeners$"+J,Un="__reactHandles$"+J,Xt="__reactResources$"+J,nn="__reactMarker$"+J;function un(p){delete p[ve],delete p[Oe],delete p[_t],delete p[tn],delete p[Un]}function mr(p){var g=p[ve];if(g)return g;for(var _=p.parentNode;_;){if(g=_[Ge]||_[ve]){if(_=g.alternate,g.child!==null||_!==null&&_.child!==null)for(p=IL(p);p!==null;){if(_=p[ve])return _;p=IL(p)}return g}p=_,_=p.parentNode}return null}function Rr(p){if(p=p[ve]||p[Ge]){var g=p.tag;if(g===5||g===6||g===13||g===26||g===27||g===3)return p}return null}function ns(p){var g=p.tag;if(g===5||g===26||g===27||g===6)return p.stateNode;throw Error(r(33))}function rs(p){var g=p[Xt];return g||(g=p[Xt]={hoistableStyles:new Map,hoistableScripts:new Map}),g}function Cr(p){p[nn]=!0}var hn=new Set,et={};function Vt(p,g){pn(p,g),pn(p+"Capture",g)}function pn(p,g){for(et[p]=g,p=0;p<g.length;p++)hn.add(g[p])}var nr=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),As={},es={};function Ii(p){return Ve.call(es,p)?!0:Ve.call(As,p)?!1:nr.test(p)?es[p]=!0:(As[p]=!0,!1)}function ci(p,g,_){if(Ii(g))if(_===null)p.removeAttribute(g);else{switch(typeof _){case"undefined":case"function":case"symbol":p.removeAttribute(g);return;case"boolean":var E=g.toLowerCase().slice(0,5);if(E!=="data-"&&E!=="aria-"){p.removeAttribute(g);return}}p.setAttribute(g,""+_)}}function qa(p,g,_){if(_===null)p.removeAttribute(g);else{switch(typeof _){case"undefined":case"function":case"symbol":case"boolean":p.removeAttribute(g);return}p.setAttribute(g,""+_)}}function ua(p,g,_,E){if(E===null)p.removeAttribute(_);else{switch(typeof E){case"undefined":case"function":case"symbol":case"boolean":p.removeAttribute(_);return}p.setAttributeNS(g,_,""+E)}}var Ws,Vo;function _l(p){if(Ws===void 0)try{throw Error()}catch(_){var g=_.stack.trim().match(/\n( *(at )?)/);Ws=g&&g[1]||"",Vo=-1<_.stack.indexOf(`
    at`)?" (<anonymous>)":-1<_.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Ws+p+Vo}var df=!1;function ig(p,g){if(!p||df)return"";df=!0;var _=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var E={DetermineComponentFrameRoot:function(){try{if(g){var Bt=function(){throw Error()};if(Object.defineProperty(Bt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Bt,[])}catch(At){var Ct=At}Reflect.construct(p,[],Bt)}else{try{Bt.call()}catch(At){Ct=At}p.call(Bt.prototype)}}else{try{throw Error()}catch(At){Ct=At}(Bt=p())&&typeof Bt.catch=="function"&&Bt.catch(function(){})}}catch(At){if(At&&Ct&&typeof At.stack=="string")return[At.stack,Ct.stack]}return[null,null]}};E.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var j=Object.getOwnPropertyDescriptor(E.DetermineComponentFrameRoot,"name");j&&j.configurable&&Object.defineProperty(E.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var q=E.DetermineComponentFrameRoot(),ue=q[0],Re=q[1];if(ue&&Re){var Ye=ue.split(`
`),wt=Re.split(`
`);for(j=E=0;E<Ye.length&&!Ye[E].includes("DetermineComponentFrameRoot");)E++;for(;j<wt.length&&!wt[j].includes("DetermineComponentFrameRoot");)j++;if(E===Ye.length||j===wt.length)for(E=Ye.length-1,j=wt.length-1;1<=E&&0<=j&&Ye[E]!==wt[j];)j--;for(;1<=E&&0<=j;E--,j--)if(Ye[E]!==wt[j]){if(E!==1||j!==1)do if(E--,j--,0>j||Ye[E]!==wt[j]){var Dt=`
`+Ye[E].replace(" at new "," at ");return p.displayName&&Dt.includes("<anonymous>")&&(Dt=Dt.replace("<anonymous>",p.displayName)),Dt}while(1<=E&&0<=j);break}}}finally{df=!1,Error.prepareStackTrace=_}return(_=p?p.displayName||p.name:"")?_l(_):""}function Dr(p){switch(p.tag){case 26:case 27:case 5:return _l(p.type);case 16:return _l("Lazy");case 13:return _l("Suspense");case 19:return _l("SuspenseList");case 0:case 15:return ig(p.type,!1);case 11:return ig(p.type.render,!1);case 1:return ig(p.type,!0);case 31:return _l("Activity");default:return""}}function xb(p){try{var g="";do g+=Dr(p),p=p.return;while(p);return g}catch(_){return`
Error generating stack: `+_.message+`
`+_.stack}}function Va(p){switch(typeof p){case"bigint":case"boolean":case"number":case"string":case"undefined":return p;case"object":return p;default:return""}}function wb(p){var g=p.type;return(p=p.nodeName)&&p.toLowerCase()==="input"&&(g==="checkbox"||g==="radio")}function Rs(p){var g=wb(p)?"checked":"value",_=Object.getOwnPropertyDescriptor(p.constructor.prototype,g),E=""+p[g];if(!p.hasOwnProperty(g)&&typeof _<"u"&&typeof _.get=="function"&&typeof _.set=="function"){var j=_.get,q=_.set;return Object.defineProperty(p,g,{configurable:!0,get:function(){return j.call(this)},set:function(ue){E=""+ue,q.call(this,ue)}}),Object.defineProperty(p,g,{enumerable:_.enumerable}),{getValue:function(){return E},setValue:function(ue){E=""+ue},stopTracking:function(){p._valueTracker=null,delete p[g]}}}}function qc(p){p._valueTracker||(p._valueTracker=Rs(p))}function ff(p){if(!p)return!1;var g=p._valueTracker;if(!g)return!0;var _=g.getValue(),E="";return p&&(E=wb(p)?p.checked?"true":"false":p.value),p=E,p!==_?(g.setValue(p),!0):!1}function ic(p){if(p=p||(typeof document<"u"?document:void 0),typeof p>"u")return null;try{return p.activeElement||p.body}catch{return p.body}}var _b=/[\n"\\]/g;function Sa(p){return p.replace(_b,function(g){return"\\"+g.charCodeAt(0).toString(16)+" "})}function hf(p,g,_,E,j,q,ue,Re){p.name="",ue!=null&&typeof ue!="function"&&typeof ue!="symbol"&&typeof ue!="boolean"?p.type=ue:p.removeAttribute("type"),g!=null?ue==="number"?(g===0&&p.value===""||p.value!=g)&&(p.value=""+Va(g)):p.value!==""+Va(g)&&(p.value=""+Va(g)):ue!=="submit"&&ue!=="reset"||p.removeAttribute("value"),g!=null?pf(p,ue,Va(g)):_!=null?pf(p,ue,Va(_)):E!=null&&p.removeAttribute("value"),j==null&&q!=null&&(p.defaultChecked=!!q),j!=null&&(p.checked=j&&typeof j!="function"&&typeof j!="symbol"),Re!=null&&typeof Re!="function"&&typeof Re!="symbol"&&typeof Re!="boolean"?p.name=""+Va(Re):p.removeAttribute("name")}function Sb(p,g,_,E,j,q,ue,Re){if(q!=null&&typeof q!="function"&&typeof q!="symbol"&&typeof q!="boolean"&&(p.type=q),g!=null||_!=null){if(!(q!=="submit"&&q!=="reset"||g!=null))return;_=_!=null?""+Va(_):"",g=g!=null?""+Va(g):_,Re||g===p.value||(p.value=g),p.defaultValue=g}E=E??j,E=typeof E!="function"&&typeof E!="symbol"&&!!E,p.checked=Re?p.checked:!!E,p.defaultChecked=!!E,ue!=null&&typeof ue!="function"&&typeof ue!="symbol"&&typeof ue!="boolean"&&(p.name=ue)}function pf(p,g,_){g==="number"&&ic(p.ownerDocument)===p||p.defaultValue===""+_||(p.defaultValue=""+_)}function Wu(p,g,_,E){if(p=p.options,g){g={};for(var j=0;j<_.length;j++)g["$"+_[j]]=!0;for(_=0;_<p.length;_++)j=g.hasOwnProperty("$"+p[_].value),p[_].selected!==j&&(p[_].selected=j),j&&E&&(p[_].defaultSelected=!0)}else{for(_=""+Va(_),g=null,j=0;j<p.length;j++){if(p[j].value===_){p[j].selected=!0,E&&(p[j].defaultSelected=!0);return}g!==null||p[j].disabled||(g=p[j])}g!==null&&(g.selected=!0)}}function mf(p,g,_){if(g!=null&&(g=""+Va(g),g!==p.value&&(p.value=g),_==null)){p.defaultValue!==g&&(p.defaultValue=g);return}p.defaultValue=_!=null?""+Va(_):""}function Cb(p,g,_,E){if(g==null){if(E!=null){if(_!=null)throw Error(r(92));if(Z(E)){if(1<E.length)throw Error(r(93));E=E[0]}_=E}_==null&&(_=""),g=_}_=Va(g),p.defaultValue=_,E=p.textContent,E===_&&E!==""&&E!==null&&(p.value=E)}function gf(p,g){if(g){var _=p.firstChild;if(_&&_===p.lastChild&&_.nodeType===3){_.nodeValue=g;return}}p.textContent=g}var Hr=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function ag(p,g,_){var E=g.indexOf("--")===0;_==null||typeof _=="boolean"||_===""?E?p.setProperty(g,""):g==="float"?p.cssFloat="":p[g]="":E?p.setProperty(g,_):typeof _!="number"||_===0||Hr.has(g)?g==="float"?p.cssFloat=_:p[g]=(""+_).trim():p[g]=_+"px"}function h_(p,g,_){if(g!=null&&typeof g!="object")throw Error(r(62));if(p=p.style,_!=null){for(var E in _)!_.hasOwnProperty(E)||g!=null&&g.hasOwnProperty(E)||(E.indexOf("--")===0?p.setProperty(E,""):E==="float"?p.cssFloat="":p[E]="");for(var j in g)E=g[j],g.hasOwnProperty(j)&&_[j]!==E&&ag(p,j,E)}else for(var q in g)g.hasOwnProperty(q)&&ag(p,q,g[q])}function kb(p){if(p.indexOf("-")===-1)return!1;switch(p){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Wa=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),yf=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Hu(p){return yf.test(""+p)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":p}var Sl=null;function og(p){return p=p.target||p.srcElement||window,p.correspondingUseElement&&(p=p.correspondingUseElement),p.nodeType===3?p.parentNode:p}var Gu=null,Fs=null;function Wo(p){var g=Rr(p);if(g&&(p=g.stateNode)){var _=p[Oe]||null;e:switch(p=g.stateNode,g.type){case"input":if(hf(p,_.value,_.defaultValue,_.defaultValue,_.checked,_.defaultChecked,_.type,_.name),g=_.name,_.type==="radio"&&g!=null){for(_=p;_.parentNode;)_=_.parentNode;for(_=_.querySelectorAll('input[name="'+Sa(""+g)+'"][type="radio"]'),g=0;g<_.length;g++){var E=_[g];if(E!==p&&E.form===p.form){var j=E[Oe]||null;if(!j)throw Error(r(90));hf(E,j.value,j.defaultValue,j.defaultValue,j.checked,j.defaultChecked,j.type,j.name)}}for(g=0;g<_.length;g++)E=_[g],E.form===p.form&&ff(E)}break e;case"textarea":mf(p,_.value,_.defaultValue);break e;case"select":g=_.value,g!=null&&Wu(p,!!_.multiple,g,!1)}}}var Ku=!1;function bf(p,g,_){if(Ku)return p(g,_);Ku=!0;try{var E=p(g);return E}finally{if(Ku=!1,(Gu!==null||Fs!==null)&&(tS(),Gu&&(g=Gu,p=Fs,Fs=Gu=null,Wo(g),p)))for(g=0;g<p.length;g++)Wo(p[g])}}function Yu(p,g){var _=p.stateNode;if(_===null)return null;var E=_[Oe]||null;if(E===null)return null;_=E[g];e:switch(g){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(E=!E.disabled)||(p=p.type,E=!(p==="button"||p==="input"||p==="select"||p==="textarea")),p=!E;break e;default:p=!1}if(p)return null;if(_&&typeof _!="function")throw Error(r(231,g,typeof _));return _}var Gi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Eb=!1;if(Gi)try{var Ca={};Object.defineProperty(Ca,"passive",{get:function(){Eb=!0}}),window.addEventListener("test",Ca,Ca),window.removeEventListener("test",Ca,Ca)}catch{Eb=!1}var Cl=null,lg=null,vf=null;function xf(){if(vf)return vf;var p,g=lg,_=g.length,E,j="value"in Cl?Cl.value:Cl.textContent,q=j.length;for(p=0;p<_&&g[p]===j[p];p++);var ue=_-p;for(E=1;E<=ue&&g[_-E]===j[q-E];E++);return vf=j.slice(p,1<E?1-E:void 0)}function wf(p){var g=p.keyCode;return"charCode"in p?(p=p.charCode,p===0&&g===13&&(p=13)):p=g,p===10&&(p=13),32<=p||p===13?p:0}function hp(){return!0}function p_(){return!1}function xi(p){function g(_,E,j,q,ue){this._reactName=_,this._targetInst=j,this.type=E,this.nativeEvent=q,this.target=ue,this.currentTarget=null;for(var Re in p)p.hasOwnProperty(Re)&&(_=p[Re],this[Re]=_?_(q):q[Re]);return this.isDefaultPrevented=(q.defaultPrevented!=null?q.defaultPrevented:q.returnValue===!1)?hp:p_,this.isPropagationStopped=p_,this}return u(g.prototype,{preventDefault:function(){this.defaultPrevented=!0;var _=this.nativeEvent;_&&(_.preventDefault?_.preventDefault():typeof _.returnValue!="unknown"&&(_.returnValue=!1),this.isDefaultPrevented=hp)},stopPropagation:function(){var _=this.nativeEvent;_&&(_.stopPropagation?_.stopPropagation():typeof _.cancelBubble!="unknown"&&(_.cancelBubble=!0),this.isPropagationStopped=hp)},persist:function(){},isPersistent:hp}),g}var Zu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(p){return p.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},cg=xi(Zu),Vc=u({},Zu,{view:0,detail:0}),ug=xi(Vc),pp,Tb,mp,dg=u({},Vc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Xu,button:0,buttons:0,relatedTarget:function(p){return p.relatedTarget===void 0?p.fromElement===p.srcElement?p.toElement:p.fromElement:p.relatedTarget},movementX:function(p){return"movementX"in p?p.movementX:(p!==mp&&(mp&&p.type==="mousemove"?(pp=p.screenX-mp.screenX,Tb=p.screenY-mp.screenY):Tb=pp=0,mp=p),pp)},movementY:function(p){return"movementY"in p?p.movementY:Tb}}),fg=xi(dg),Ab=u({},dg,{dataTransfer:0}),m_=xi(Ab),hg=u({},Vc,{relatedTarget:0}),_f=xi(hg),pg=u({},Zu,{animationName:0,elapsedTime:0,pseudoElement:0}),g_=xi(pg),bA=u({},Zu,{clipboardData:function(p){return"clipboardData"in p?p.clipboardData:window.clipboardData}}),mg=xi(bA),Rb=u({},Zu,{data:0}),gg=xi(Rb),Nb={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Mb={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ki={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function gp(p){var g=this.nativeEvent;return g.getModifierState?g.getModifierState(p):(p=Ki[p])?!!g[p]:!1}function Xu(){return gp}var y_=u({},Vc,{key:function(p){if(p.key){var g=Nb[p.key]||p.key;if(g!=="Unidentified")return g}return p.type==="keypress"?(p=wf(p),p===13?"Enter":String.fromCharCode(p)):p.type==="keydown"||p.type==="keyup"?Mb[p.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Xu,charCode:function(p){return p.type==="keypress"?wf(p):0},keyCode:function(p){return p.type==="keydown"||p.type==="keyup"?p.keyCode:0},which:function(p){return p.type==="keypress"?wf(p):p.type==="keydown"||p.type==="keyup"?p.keyCode:0}}),yg=xi(y_),b_=u({},dg,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ib=xi(b_),bg=u({},Vc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Xu}),jb=xi(bg),Ju=u({},Zu,{propertyName:0,elapsedTime:0,pseudoElement:0}),Pb=xi(Ju),Ob=u({},dg,{deltaX:function(p){return"deltaX"in p?p.deltaX:"wheelDeltaX"in p?-p.wheelDeltaX:0},deltaY:function(p){return"deltaY"in p?p.deltaY:"wheelDeltaY"in p?-p.wheelDeltaY:"wheelDelta"in p?-p.wheelDelta:0},deltaZ:0,deltaMode:0}),vg=xi(Ob),Db=u({},Zu,{newState:0,oldState:0}),v_=xi(Db),vA=[9,13,27,32],yp=Gi&&"CompositionEvent"in window,Wc=null;Gi&&"documentMode"in document&&(Wc=document.documentMode);var xA=Gi&&"TextEvent"in window&&!Wc,xg=Gi&&(!yp||Wc&&8<Wc&&11>=Wc),wg=" ",x_=!1;function Fb(p,g){switch(p){case"keyup":return vA.indexOf(g.keyCode)!==-1;case"keydown":return g.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function w_(p){return p=p.detail,typeof p=="object"&&"data"in p?p.data:null}var Qu=!1;function __(p,g){switch(p){case"compositionend":return w_(g);case"keypress":return g.which!==32?null:(x_=!0,wg);case"textInput":return p=g.data,p===wg&&x_?null:p;default:return null}}function wA(p,g){if(Qu)return p==="compositionend"||!yp&&Fb(p,g)?(p=xf(),vf=lg=Cl=null,Qu=!1,p):null;switch(p){case"paste":return null;case"keypress":if(!(g.ctrlKey||g.altKey||g.metaKey)||g.ctrlKey&&g.altKey){if(g.char&&1<g.char.length)return g.char;if(g.which)return String.fromCharCode(g.which)}return null;case"compositionend":return xg&&g.locale!=="ko"?null:g.data;default:return null}}var S_={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function _g(p){var g=p&&p.nodeName&&p.nodeName.toLowerCase();return g==="input"?!!S_[p.type]:g==="textarea"}function Lb(p,g,_,E){Gu?Fs?Fs.push(E):Fs=[E]:Gu=E,g=oS(g,"onChange"),0<g.length&&(_=new cg("onChange","change",null,_,E),p.push({event:_,listeners:g}))}var Sf=null,bp=null;function _A(p){_L(p,0)}function Sg(p){var g=ns(p);if(ff(g))return p}function vp(p,g){if(p==="change")return g}var kl=!1;if(Gi){var Ls;if(Gi){var Cf="oninput"in document;if(!Cf){var Ha=document.createElement("div");Ha.setAttribute("oninput","return;"),Cf=typeof Ha.oninput=="function"}Ls=Cf}else Ls=!1;kl=Ls&&(!document.documentMode||9<document.documentMode)}function C_(){Sf&&(Sf.detachEvent("onpropertychange",Cg),bp=Sf=null)}function Cg(p){if(p.propertyName==="value"&&Sg(bp)){var g=[];Lb(g,bp,p,og(p)),bf(_A,g)}}function k_(p,g,_){p==="focusin"?(C_(),Sf=g,bp=_,Sf.attachEvent("onpropertychange",Cg)):p==="focusout"&&C_()}function ed(p){if(p==="selectionchange"||p==="keyup"||p==="keydown")return Sg(bp)}function Bb(p,g){if(p==="click")return Sg(g)}function kf(p,g){if(p==="input"||p==="change")return Sg(g)}function Hc(p,g){return p===g&&(p!==0||1/p===1/g)||p!==p&&g!==g}var ka=typeof Object.is=="function"?Object.is:Hc;function M(p,g){if(ka(p,g))return!0;if(typeof p!="object"||p===null||typeof g!="object"||g===null)return!1;var _=Object.keys(p),E=Object.keys(g);if(_.length!==E.length)return!1;for(E=0;E<_.length;E++){var j=_[E];if(!Ve.call(g,j)||!ka(p[j],g[j]))return!1}return!0}function z(p){for(;p&&p.firstChild;)p=p.firstChild;return p}function te(p,g){var _=z(p);p=0;for(var E;_;){if(_.nodeType===3){if(E=p+_.textContent.length,p<=g&&E>=g)return{node:_,offset:g-p};p=E}e:{for(;_;){if(_.nextSibling){_=_.nextSibling;break e}_=_.parentNode}_=void 0}_=z(_)}}function ae(p,g){return p&&g?p===g?!0:p&&p.nodeType===3?!1:g&&g.nodeType===3?ae(p,g.parentNode):"contains"in p?p.contains(g):p.compareDocumentPosition?!!(p.compareDocumentPosition(g)&16):!1:!1}function he(p){p=p!=null&&p.ownerDocument!=null&&p.ownerDocument.defaultView!=null?p.ownerDocument.defaultView:window;for(var g=ic(p.document);g instanceof p.HTMLIFrameElement;){try{var _=typeof g.contentWindow.location.href=="string"}catch{_=!1}if(_)p=g.contentWindow;else break;g=ic(p.document)}return g}function Ee(p){var g=p&&p.nodeName&&p.nodeName.toLowerCase();return g&&(g==="input"&&(p.type==="text"||p.type==="search"||p.type==="tel"||p.type==="url"||p.type==="password")||g==="textarea"||p.contentEditable==="true")}var Le=Gi&&"documentMode"in document&&11>=document.documentMode,He=null,nt=null,it=null,dt=!1;function Je(p,g,_){var E=_.window===_?_.document:_.nodeType===9?_:_.ownerDocument;dt||He==null||He!==ic(E)||(E=He,"selectionStart"in E&&Ee(E)?E={start:E.selectionStart,end:E.selectionEnd}:(E=(E.ownerDocument&&E.ownerDocument.defaultView||window).getSelection(),E={anchorNode:E.anchorNode,anchorOffset:E.anchorOffset,focusNode:E.focusNode,focusOffset:E.focusOffset}),it&&M(it,E)||(it=E,E=oS(nt,"onSelect"),0<E.length&&(g=new cg("onSelect","select",null,g,_),p.push({event:g,listeners:E}),g.target=He)))}function mt(p,g){var _={};return _[p.toLowerCase()]=g.toLowerCase(),_["Webkit"+p]="webkit"+g,_["Moz"+p]="moz"+g,_}var tt={animationend:mt("Animation","AnimationEnd"),animationiteration:mt("Animation","AnimationIteration"),animationstart:mt("Animation","AnimationStart"),transitionrun:mt("Transition","TransitionRun"),transitionstart:mt("Transition","TransitionStart"),transitioncancel:mt("Transition","TransitionCancel"),transitionend:mt("Transition","TransitionEnd")},ut={},gt={};Gi&&(gt=document.createElement("div").style,"AnimationEvent"in window||(delete tt.animationend.animation,delete tt.animationiteration.animation,delete tt.animationstart.animation),"TransitionEvent"in window||delete tt.transitionend.transition);function at(p){if(ut[p])return ut[p];if(!tt[p])return p;var g=tt[p],_;for(_ in g)if(g.hasOwnProperty(_)&&_ in gt)return ut[p]=g[_];return p}var St=at("animationend"),Nt=at("animationiteration"),Mt=at("animationstart"),Ot=at("transitionrun"),Yt=at("transitionstart"),rn=at("transitioncancel"),Ht=at("transitionend"),Jt=new Map,an="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");an.push("scrollEnd");function Gt(p,g){Jt.set(p,g),Vt(g,[p])}var mn=new WeakMap;function Bn(p,g){if(typeof p=="object"&&p!==null){var _=mn.get(p);return _!==void 0?_:(g={value:p,source:g,stack:xb(g)},mn.set(p,g),g)}return{value:p,source:g,stack:xb(g)}}var Vn=[],fr=0,da=0;function rr(){for(var p=fr,g=da=fr=0;g<p;){var _=Vn[g];Vn[g++]=null;var E=Vn[g];Vn[g++]=null;var j=Vn[g];Vn[g++]=null;var q=Vn[g];if(Vn[g++]=null,E!==null&&j!==null){var ue=E.pending;ue===null?j.next=j:(j.next=ue.next,ue.next=j),E.pending=j}q!==0&&Yi(_,j,q)}}function ui(p,g,_,E){Vn[fr++]=p,Vn[fr++]=g,Vn[fr++]=_,Vn[fr++]=E,da|=E,p.lanes|=E,p=p.alternate,p!==null&&(p.lanes|=E)}function wi(p,g,_,E){return ui(p,g,_,E),El(p)}function ac(p,g){return ui(p,null,null,g),El(p)}function Yi(p,g,_){p.lanes|=_;var E=p.alternate;E!==null&&(E.lanes|=_);for(var j=!1,q=p.return;q!==null;)q.childLanes|=_,E=q.alternate,E!==null&&(E.childLanes|=_),q.tag===22&&(p=q.stateNode,p===null||p._visibility&1||(j=!0)),p=q,q=q.return;return p.tag===3?(q=p.stateNode,j&&g!==null&&(j=31-en(_),p=q.hiddenUpdates,E=p[j],E===null?p[j]=[g]:E.push(g),g.lane=_|536870912),q):null}function El(p){if(50<uv)throw uv=0,AR=null,Error(r(185));for(var g=p.return;g!==null;)p=g,g=p.return;return p.tag===3?p.stateNode:null}var Gc={};function Pde(p,g,_,E){this.tag=p,this.key=_,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=g,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=E,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ho(p,g,_,E){return new Pde(p,g,_,E)}function SA(p){return p=p.prototype,!(!p||!p.isReactComponent)}function td(p,g){var _=p.alternate;return _===null?(_=Ho(p.tag,g,p.key,p.mode),_.elementType=p.elementType,_.type=p.type,_.stateNode=p.stateNode,_.alternate=p,p.alternate=_):(_.pendingProps=g,_.type=p.type,_.flags=0,_.subtreeFlags=0,_.deletions=null),_.flags=p.flags&65011712,_.childLanes=p.childLanes,_.lanes=p.lanes,_.child=p.child,_.memoizedProps=p.memoizedProps,_.memoizedState=p.memoizedState,_.updateQueue=p.updateQueue,g=p.dependencies,_.dependencies=g===null?null:{lanes:g.lanes,firstContext:g.firstContext},_.sibling=p.sibling,_.index=p.index,_.ref=p.ref,_.refCleanup=p.refCleanup,_}function oF(p,g){p.flags&=65011714;var _=p.alternate;return _===null?(p.childLanes=0,p.lanes=g,p.child=null,p.subtreeFlags=0,p.memoizedProps=null,p.memoizedState=null,p.updateQueue=null,p.dependencies=null,p.stateNode=null):(p.childLanes=_.childLanes,p.lanes=_.lanes,p.child=_.child,p.subtreeFlags=0,p.deletions=null,p.memoizedProps=_.memoizedProps,p.memoizedState=_.memoizedState,p.updateQueue=_.updateQueue,p.type=_.type,g=_.dependencies,p.dependencies=g===null?null:{lanes:g.lanes,firstContext:g.firstContext}),p}function E_(p,g,_,E,j,q){var ue=0;if(E=p,typeof p=="function")SA(p)&&(ue=1);else if(typeof p=="string")ue=Dfe(p,_,pe.current)?26:p==="html"||p==="head"||p==="body"?27:5;else e:switch(p){case I:return p=Ho(31,_,g,j),p.elementType=I,p.lanes=q,p;case y:return xp(_.children,j,q,g);case b:ue=8,j|=24;break;case v:return p=Ho(12,_,g,j|2),p.elementType=v,p.lanes=q,p;case k:return p=Ho(13,_,g,j),p.elementType=k,p.lanes=q,p;case A:return p=Ho(19,_,g,j),p.elementType=A,p.lanes=q,p;default:if(typeof p=="object"&&p!==null)switch(p.$$typeof){case x:case S:ue=10;break e;case w:ue=9;break e;case C:ue=11;break e;case R:ue=14;break e;case N:ue=16,E=null;break e}ue=29,_=Error(r(130,p===null?"null":typeof p,"")),E=null}return g=Ho(ue,_,g,j),g.elementType=p,g.type=E,g.lanes=q,g}function xp(p,g,_,E){return p=Ho(7,p,E,g),p.lanes=_,p}function CA(p,g,_){return p=Ho(6,p,null,g),p.lanes=_,p}function kA(p,g,_){return g=Ho(4,p.children!==null?p.children:[],p.key,g),g.lanes=_,g.stateNode={containerInfo:p.containerInfo,pendingChildren:null,implementation:p.implementation},g}var kg=[],Eg=0,T_=null,A_=0,Tl=[],Al=0,wp=null,nd=1,rd="";function _p(p,g){kg[Eg++]=A_,kg[Eg++]=T_,T_=p,A_=g}function lF(p,g,_){Tl[Al++]=nd,Tl[Al++]=rd,Tl[Al++]=wp,wp=p;var E=nd;p=rd;var j=32-en(E)-1;E&=~(1<<j),_+=1;var q=32-en(g)+j;if(30<q){var ue=j-j%5;q=(E&(1<<ue)-1).toString(32),E>>=ue,j-=ue,nd=1<<32-en(g)+j|_<<j|E,rd=q+p}else nd=1<<q|_<<j|E,rd=p}function EA(p){p.return!==null&&(_p(p,1),lF(p,1,0))}function TA(p){for(;p===T_;)T_=kg[--Eg],kg[Eg]=null,A_=kg[--Eg],kg[Eg]=null;for(;p===wp;)wp=Tl[--Al],Tl[Al]=null,rd=Tl[--Al],Tl[Al]=null,nd=Tl[--Al],Tl[Al]=null}var Ga=null,si=null,ss=!1,Sp=null,Kc=!1,AA=Error(r(519));function Cp(p){var g=Error(r(418,""));throw Ub(Bn(g,p)),AA}function cF(p){var g=p.stateNode,_=p.type,E=p.memoizedProps;switch(g[ve]=p,g[Oe]=E,_){case"dialog":Lr("cancel",g),Lr("close",g);break;case"iframe":case"object":case"embed":Lr("load",g);break;case"video":case"audio":for(_=0;_<fv.length;_++)Lr(fv[_],g);break;case"source":Lr("error",g);break;case"img":case"image":case"link":Lr("error",g),Lr("load",g);break;case"details":Lr("toggle",g);break;case"input":Lr("invalid",g),Sb(g,E.value,E.defaultValue,E.checked,E.defaultChecked,E.type,E.name,!0),qc(g);break;case"select":Lr("invalid",g);break;case"textarea":Lr("invalid",g),Cb(g,E.value,E.defaultValue,E.children),qc(g)}_=E.children,typeof _!="string"&&typeof _!="number"&&typeof _!="bigint"||g.textContent===""+_||E.suppressHydrationWarning===!0||EL(g.textContent,_)?(E.popover!=null&&(Lr("beforetoggle",g),Lr("toggle",g)),E.onScroll!=null&&Lr("scroll",g),E.onScrollEnd!=null&&Lr("scrollend",g),E.onClick!=null&&(g.onclick=lS),g=!0):g=!1,g||Cp(p)}function uF(p){for(Ga=p.return;Ga;)switch(Ga.tag){case 5:case 13:Kc=!1;return;case 27:case 3:Kc=!0;return;default:Ga=Ga.return}}function $b(p){if(p!==Ga)return!1;if(!ss)return uF(p),ss=!0,!1;var g=p.tag,_;if((_=g!==3&&g!==27)&&((_=g===5)&&(_=p.type,_=!(_!=="form"&&_!=="button")||VR(p.type,p.memoizedProps)),_=!_),_&&si&&Cp(p),uF(p),g===13){if(p=p.memoizedState,p=p!==null?p.dehydrated:null,!p)throw Error(r(317));e:{for(p=p.nextSibling,g=0;p;){if(p.nodeType===8)if(_=p.data,_==="/$"){if(g===0){si=lc(p.nextSibling);break e}g--}else _!=="$"&&_!=="$!"&&_!=="$?"||g++;p=p.nextSibling}si=null}}else g===27?(g=si,zf(p.type)?(p=KR,KR=null,si=p):si=g):si=Ga?lc(p.stateNode.nextSibling):null;return!0}function zb(){si=Ga=null,ss=!1}function dF(){var p=Sp;return p!==null&&(go===null?go=p:go.push.apply(go,p),Sp=null),p}function Ub(p){Sp===null?Sp=[p]:Sp.push(p)}var RA=Q(null),kp=null,sd=null;function Ef(p,g,_){se(RA,g._currentValue),g._currentValue=_}function id(p){p._currentValue=RA.current,ee(RA)}function NA(p,g,_){for(;p!==null;){var E=p.alternate;if((p.childLanes&g)!==g?(p.childLanes|=g,E!==null&&(E.childLanes|=g)):E!==null&&(E.childLanes&g)!==g&&(E.childLanes|=g),p===_)break;p=p.return}}function MA(p,g,_,E){var j=p.child;for(j!==null&&(j.return=p);j!==null;){var q=j.dependencies;if(q!==null){var ue=j.child;q=q.firstContext;e:for(;q!==null;){var Re=q;q=j;for(var Ye=0;Ye<g.length;Ye++)if(Re.context===g[Ye]){q.lanes|=_,Re=q.alternate,Re!==null&&(Re.lanes|=_),NA(q.return,_,p),E||(ue=null);break e}q=Re.next}}else if(j.tag===18){if(ue=j.return,ue===null)throw Error(r(341));ue.lanes|=_,q=ue.alternate,q!==null&&(q.lanes|=_),NA(ue,_,p),ue=null}else ue=j.child;if(ue!==null)ue.return=j;else for(ue=j;ue!==null;){if(ue===p){ue=null;break}if(j=ue.sibling,j!==null){j.return=ue.return,ue=j;break}ue=ue.return}j=ue}}function qb(p,g,_,E){p=null;for(var j=g,q=!1;j!==null;){if(!q){if((j.flags&524288)!==0)q=!0;else if((j.flags&262144)!==0)break}if(j.tag===10){var ue=j.alternate;if(ue===null)throw Error(r(387));if(ue=ue.memoizedProps,ue!==null){var Re=j.type;ka(j.pendingProps.value,ue.value)||(p!==null?p.push(Re):p=[Re])}}else if(j===De.current){if(ue=j.alternate,ue===null)throw Error(r(387));ue.memoizedState.memoizedState!==j.memoizedState.memoizedState&&(p!==null?p.push(bv):p=[bv])}j=j.return}p!==null&&MA(g,p,_,E),g.flags|=262144}function R_(p){for(p=p.firstContext;p!==null;){if(!ka(p.context._currentValue,p.memoizedValue))return!0;p=p.next}return!1}function Ep(p){kp=p,sd=null,p=p.dependencies,p!==null&&(p.firstContext=null)}function Ea(p){return fF(kp,p)}function N_(p,g){return kp===null&&Ep(p),fF(p,g)}function fF(p,g){var _=g._currentValue;if(g={context:g,memoizedValue:_,next:null},sd===null){if(p===null)throw Error(r(308));sd=g,p.dependencies={lanes:0,firstContext:g},p.flags|=524288}else sd=sd.next=g;return _}var Ode=typeof AbortController<"u"?AbortController:function(){var p=[],g=this.signal={aborted:!1,addEventListener:function(_,E){p.push(E)}};this.abort=function(){g.aborted=!0,p.forEach(function(_){return _()})}},Dde=e.unstable_scheduleCallback,Fde=e.unstable_NormalPriority,ji={$$typeof:S,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function IA(){return{controller:new Ode,data:new Map,refCount:0}}function Vb(p){p.refCount--,p.refCount===0&&Dde(Fde,function(){p.controller.abort()})}var Wb=null,jA=0,Tg=0,Ag=null;function Lde(p,g){if(Wb===null){var _=Wb=[];jA=0,Tg=OR(),Ag={status:"pending",value:void 0,then:function(E){_.push(E)}}}return jA++,g.then(hF,hF),g}function hF(){if(--jA===0&&Wb!==null){Ag!==null&&(Ag.status="fulfilled");var p=Wb;Wb=null,Tg=0,Ag=null;for(var g=0;g<p.length;g++)(0,p[g])()}}function Bde(p,g){var _=[],E={status:"pending",value:null,reason:null,then:function(j){_.push(j)}};return p.then(function(){E.status="fulfilled",E.value=g;for(var j=0;j<_.length;j++)(0,_[j])(g)},function(j){for(E.status="rejected",E.reason=j,j=0;j<_.length;j++)(0,_[j])(void 0)}),E}var pF=U.S;U.S=function(p,g){typeof g=="object"&&g!==null&&typeof g.then=="function"&&Lde(p,g),pF!==null&&pF(p,g)};var Tp=Q(null);function PA(){var p=Tp.current;return p!==null?p:Ps.pooledCache}function M_(p,g){g===null?se(Tp,Tp.current):se(Tp,g.pool)}function mF(){var p=PA();return p===null?null:{parent:ji._currentValue,pool:p}}var Hb=Error(r(460)),gF=Error(r(474)),I_=Error(r(542)),OA={then:function(){}};function yF(p){return p=p.status,p==="fulfilled"||p==="rejected"}function j_(){}function bF(p,g,_){switch(_=p[_],_===void 0?p.push(g):_!==g&&(g.then(j_,j_),g=_),g.status){case"fulfilled":return g.value;case"rejected":throw p=g.reason,xF(p),p;default:if(typeof g.status=="string")g.then(j_,j_);else{if(p=Ps,p!==null&&100<p.shellSuspendCounter)throw Error(r(482));p=g,p.status="pending",p.then(function(E){if(g.status==="pending"){var j=g;j.status="fulfilled",j.value=E}},function(E){if(g.status==="pending"){var j=g;j.status="rejected",j.reason=E}})}switch(g.status){case"fulfilled":return g.value;case"rejected":throw p=g.reason,xF(p),p}throw Gb=g,Hb}}var Gb=null;function vF(){if(Gb===null)throw Error(r(459));var p=Gb;return Gb=null,p}function xF(p){if(p===Hb||p===I_)throw Error(r(483))}var Tf=!1;function DA(p){p.updateQueue={baseState:p.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function FA(p,g){p=p.updateQueue,g.updateQueue===p&&(g.updateQueue={baseState:p.baseState,firstBaseUpdate:p.firstBaseUpdate,lastBaseUpdate:p.lastBaseUpdate,shared:p.shared,callbacks:null})}function Af(p){return{lane:p,tag:0,payload:null,callback:null,next:null}}function Rf(p,g,_){var E=p.updateQueue;if(E===null)return null;if(E=E.shared,(gs&2)!==0){var j=E.pending;return j===null?g.next=g:(g.next=j.next,j.next=g),E.pending=g,g=El(p),Yi(p,null,_),g}return ui(p,E,g,_),El(p)}function Kb(p,g,_){if(g=g.updateQueue,g!==null&&(g=g.shared,(_&4194048)!==0)){var E=g.lanes;E&=p.pendingLanes,_|=E,g.lanes=_,Ue(p,_)}}function LA(p,g){var _=p.updateQueue,E=p.alternate;if(E!==null&&(E=E.updateQueue,_===E)){var j=null,q=null;if(_=_.firstBaseUpdate,_!==null){do{var ue={lane:_.lane,tag:_.tag,payload:_.payload,callback:null,next:null};q===null?j=q=ue:q=q.next=ue,_=_.next}while(_!==null);q===null?j=q=g:q=q.next=g}else j=q=g;_={baseState:E.baseState,firstBaseUpdate:j,lastBaseUpdate:q,shared:E.shared,callbacks:E.callbacks},p.updateQueue=_;return}p=_.lastBaseUpdate,p===null?_.firstBaseUpdate=g:p.next=g,_.lastBaseUpdate=g}var BA=!1;function Yb(){if(BA){var p=Ag;if(p!==null)throw p}}function Zb(p,g,_,E){BA=!1;var j=p.updateQueue;Tf=!1;var q=j.firstBaseUpdate,ue=j.lastBaseUpdate,Re=j.shared.pending;if(Re!==null){j.shared.pending=null;var Ye=Re,wt=Ye.next;Ye.next=null,ue===null?q=wt:ue.next=wt,ue=Ye;var Dt=p.alternate;Dt!==null&&(Dt=Dt.updateQueue,Re=Dt.lastBaseUpdate,Re!==ue&&(Re===null?Dt.firstBaseUpdate=wt:Re.next=wt,Dt.lastBaseUpdate=Ye))}if(q!==null){var Bt=j.baseState;ue=0,Dt=wt=Ye=null,Re=q;do{var Ct=Re.lane&-536870913,At=Ct!==Re.lane;if(At?(Gr&Ct)===Ct:(E&Ct)===Ct){Ct!==0&&Ct===Tg&&(BA=!0),Dt!==null&&(Dt=Dt.next={lane:0,tag:Re.tag,payload:Re.payload,callback:null,next:null});e:{var sr=p,Wn=Re;Ct=g;var Ss=_;switch(Wn.tag){case 1:if(sr=Wn.payload,typeof sr=="function"){Bt=sr.call(Ss,Bt,Ct);break e}Bt=sr;break e;case 3:sr.flags=sr.flags&-65537|128;case 0:if(sr=Wn.payload,Ct=typeof sr=="function"?sr.call(Ss,Bt,Ct):sr,Ct==null)break e;Bt=u({},Bt,Ct);break e;case 2:Tf=!0}}Ct=Re.callback,Ct!==null&&(p.flags|=64,At&&(p.flags|=8192),At=j.callbacks,At===null?j.callbacks=[Ct]:At.push(Ct))}else At={lane:Ct,tag:Re.tag,payload:Re.payload,callback:Re.callback,next:null},Dt===null?(wt=Dt=At,Ye=Bt):Dt=Dt.next=At,ue|=Ct;if(Re=Re.next,Re===null){if(Re=j.shared.pending,Re===null)break;At=Re,Re=At.next,At.next=null,j.lastBaseUpdate=At,j.shared.pending=null}}while(!0);Dt===null&&(Ye=Bt),j.baseState=Ye,j.firstBaseUpdate=wt,j.lastBaseUpdate=Dt,q===null&&(j.shared.lanes=0),Ff|=ue,p.lanes=ue,p.memoizedState=Bt}}function wF(p,g){if(typeof p!="function")throw Error(r(191,p));p.call(g)}function _F(p,g){var _=p.callbacks;if(_!==null)for(p.callbacks=null,p=0;p<_.length;p++)wF(_[p],g)}var Rg=Q(null),P_=Q(0);function SF(p,g){p=fd,se(P_,p),se(Rg,g),fd=p|g.baseLanes}function $A(){se(P_,fd),se(Rg,Rg.current)}function zA(){fd=P_.current,ee(Rg),ee(P_)}var Nf=0,Ir=null,ws=null,_i=null,O_=!1,Ng=!1,Ap=!1,D_=0,Xb=0,Mg=null,$de=0;function di(){throw Error(r(321))}function UA(p,g){if(g===null)return!1;for(var _=0;_<g.length&&_<p.length;_++)if(!ka(p[_],g[_]))return!1;return!0}function qA(p,g,_,E,j,q){return Nf=q,Ir=g,g.memoizedState=null,g.updateQueue=null,g.lanes=0,U.H=p===null||p.memoizedState===null?a8:o8,Ap=!1,q=_(E,j),Ap=!1,Ng&&(q=kF(g,_,E,j)),CF(p),q}function CF(p){U.H=U_;var g=ws!==null&&ws.next!==null;if(Nf=0,_i=ws=Ir=null,O_=!1,Xb=0,Mg=null,g)throw Error(r(300));p===null||Zi||(p=p.dependencies,p!==null&&R_(p)&&(Zi=!0))}function kF(p,g,_,E){Ir=p;var j=0;do{if(Ng&&(Mg=null),Xb=0,Ng=!1,25<=j)throw Error(r(301));if(j+=1,_i=ws=null,p.updateQueue!=null){var q=p.updateQueue;q.lastEffect=null,q.events=null,q.stores=null,q.memoCache!=null&&(q.memoCache.index=0)}U.H=Gde,q=g(_,E)}while(Ng);return q}function zde(){var p=U.H,g=p.useState()[0];return g=typeof g.then=="function"?Jb(g):g,p=p.useState()[0],(ws!==null?ws.memoizedState:null)!==p&&(Ir.flags|=1024),g}function VA(){var p=D_!==0;return D_=0,p}function WA(p,g,_){g.updateQueue=p.updateQueue,g.flags&=-2053,p.lanes&=~_}function HA(p){if(O_){for(p=p.memoizedState;p!==null;){var g=p.queue;g!==null&&(g.pending=null),p=p.next}O_=!1}Nf=0,_i=ws=Ir=null,Ng=!1,Xb=D_=0,Mg=null}function po(){var p={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return _i===null?Ir.memoizedState=_i=p:_i=_i.next=p,_i}function Si(){if(ws===null){var p=Ir.alternate;p=p!==null?p.memoizedState:null}else p=ws.next;var g=_i===null?Ir.memoizedState:_i.next;if(g!==null)_i=g,ws=p;else{if(p===null)throw Ir.alternate===null?Error(r(467)):Error(r(310));ws=p,p={memoizedState:ws.memoizedState,baseState:ws.baseState,baseQueue:ws.baseQueue,queue:ws.queue,next:null},_i===null?Ir.memoizedState=_i=p:_i=_i.next=p}return _i}function GA(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Jb(p){var g=Xb;return Xb+=1,Mg===null&&(Mg=[]),p=bF(Mg,p,g),g=Ir,(_i===null?g.memoizedState:_i.next)===null&&(g=g.alternate,U.H=g===null||g.memoizedState===null?a8:o8),p}function F_(p){if(p!==null&&typeof p=="object"){if(typeof p.then=="function")return Jb(p);if(p.$$typeof===S)return Ea(p)}throw Error(r(438,String(p)))}function KA(p){var g=null,_=Ir.updateQueue;if(_!==null&&(g=_.memoCache),g==null){var E=Ir.alternate;E!==null&&(E=E.updateQueue,E!==null&&(E=E.memoCache,E!=null&&(g={data:E.data.map(function(j){return j.slice()}),index:0})))}if(g==null&&(g={data:[],index:0}),_===null&&(_=GA(),Ir.updateQueue=_),_.memoCache=g,_=g.data[g.index],_===void 0)for(_=g.data[g.index]=Array(p),E=0;E<p;E++)_[E]=P;return g.index++,_}function ad(p,g){return typeof g=="function"?g(p):g}function L_(p){var g=Si();return YA(g,ws,p)}function YA(p,g,_){var E=p.queue;if(E===null)throw Error(r(311));E.lastRenderedReducer=_;var j=p.baseQueue,q=E.pending;if(q!==null){if(j!==null){var ue=j.next;j.next=q.next,q.next=ue}g.baseQueue=j=q,E.pending=null}if(q=p.baseState,j===null)p.memoizedState=q;else{g=j.next;var Re=ue=null,Ye=null,wt=g,Dt=!1;do{var Bt=wt.lane&-536870913;if(Bt!==wt.lane?(Gr&Bt)===Bt:(Nf&Bt)===Bt){var Ct=wt.revertLane;if(Ct===0)Ye!==null&&(Ye=Ye.next={lane:0,revertLane:0,action:wt.action,hasEagerState:wt.hasEagerState,eagerState:wt.eagerState,next:null}),Bt===Tg&&(Dt=!0);else if((Nf&Ct)===Ct){wt=wt.next,Ct===Tg&&(Dt=!0);continue}else Bt={lane:0,revertLane:wt.revertLane,action:wt.action,hasEagerState:wt.hasEagerState,eagerState:wt.eagerState,next:null},Ye===null?(Re=Ye=Bt,ue=q):Ye=Ye.next=Bt,Ir.lanes|=Ct,Ff|=Ct;Bt=wt.action,Ap&&_(q,Bt),q=wt.hasEagerState?wt.eagerState:_(q,Bt)}else Ct={lane:Bt,revertLane:wt.revertLane,action:wt.action,hasEagerState:wt.hasEagerState,eagerState:wt.eagerState,next:null},Ye===null?(Re=Ye=Ct,ue=q):Ye=Ye.next=Ct,Ir.lanes|=Bt,Ff|=Bt;wt=wt.next}while(wt!==null&&wt!==g);if(Ye===null?ue=q:Ye.next=Re,!ka(q,p.memoizedState)&&(Zi=!0,Dt&&(_=Ag,_!==null)))throw _;p.memoizedState=q,p.baseState=ue,p.baseQueue=Ye,E.lastRenderedState=q}return j===null&&(E.lanes=0),[p.memoizedState,E.dispatch]}function ZA(p){var g=Si(),_=g.queue;if(_===null)throw Error(r(311));_.lastRenderedReducer=p;var E=_.dispatch,j=_.pending,q=g.memoizedState;if(j!==null){_.pending=null;var ue=j=j.next;do q=p(q,ue.action),ue=ue.next;while(ue!==j);ka(q,g.memoizedState)||(Zi=!0),g.memoizedState=q,g.baseQueue===null&&(g.baseState=q),_.lastRenderedState=q}return[q,E]}function EF(p,g,_){var E=Ir,j=Si(),q=ss;if(q){if(_===void 0)throw Error(r(407));_=_()}else _=g();var ue=!ka((ws||j).memoizedState,_);ue&&(j.memoizedState=_,Zi=!0),j=j.queue;var Re=RF.bind(null,E,j,p);if(Qb(2048,8,Re,[p]),j.getSnapshot!==g||ue||_i!==null&&_i.memoizedState.tag&1){if(E.flags|=2048,Ig(9,B_(),AF.bind(null,E,j,_,g),null),Ps===null)throw Error(r(349));q||(Nf&124)!==0||TF(E,g,_)}return _}function TF(p,g,_){p.flags|=16384,p={getSnapshot:g,value:_},g=Ir.updateQueue,g===null?(g=GA(),Ir.updateQueue=g,g.stores=[p]):(_=g.stores,_===null?g.stores=[p]:_.push(p))}function AF(p,g,_,E){g.value=_,g.getSnapshot=E,NF(g)&&MF(p)}function RF(p,g,_){return _(function(){NF(g)&&MF(p)})}function NF(p){var g=p.getSnapshot;p=p.value;try{var _=g();return!ka(p,_)}catch{return!0}}function MF(p){var g=ac(p,2);g!==null&&Xo(g,p,2)}function XA(p){var g=po();if(typeof p=="function"){var _=p;if(p=_(),Ap){Lt(!0);try{_()}finally{Lt(!1)}}}return g.memoizedState=g.baseState=p,g.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ad,lastRenderedState:p},g}function IF(p,g,_,E){return p.baseState=_,YA(p,ws,typeof E=="function"?E:ad)}function Ude(p,g,_,E,j){if(z_(p))throw Error(r(485));if(p=g.action,p!==null){var q={payload:j,action:p,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(ue){q.listeners.push(ue)}};U.T!==null?_(!0):q.isTransition=!1,E(q),_=g.pending,_===null?(q.next=g.pending=q,jF(g,q)):(q.next=_.next,g.pending=_.next=q)}}function jF(p,g){var _=g.action,E=g.payload,j=p.state;if(g.isTransition){var q=U.T,ue={};U.T=ue;try{var Re=_(j,E),Ye=U.S;Ye!==null&&Ye(ue,Re),PF(p,g,Re)}catch(wt){JA(p,g,wt)}finally{U.T=q}}else try{q=_(j,E),PF(p,g,q)}catch(wt){JA(p,g,wt)}}function PF(p,g,_){_!==null&&typeof _=="object"&&typeof _.then=="function"?_.then(function(E){OF(p,g,E)},function(E){return JA(p,g,E)}):OF(p,g,_)}function OF(p,g,_){g.status="fulfilled",g.value=_,DF(g),p.state=_,g=p.pending,g!==null&&(_=g.next,_===g?p.pending=null:(_=_.next,g.next=_,jF(p,_)))}function JA(p,g,_){var E=p.pending;if(p.pending=null,E!==null){E=E.next;do g.status="rejected",g.reason=_,DF(g),g=g.next;while(g!==E)}p.action=null}function DF(p){p=p.listeners;for(var g=0;g<p.length;g++)(0,p[g])()}function FF(p,g){return g}function LF(p,g){if(ss){var _=Ps.formState;if(_!==null){e:{var E=Ir;if(ss){if(si){t:{for(var j=si,q=Kc;j.nodeType!==8;){if(!q){j=null;break t}if(j=lc(j.nextSibling),j===null){j=null;break t}}q=j.data,j=q==="F!"||q==="F"?j:null}if(j){si=lc(j.nextSibling),E=j.data==="F!";break e}}Cp(E)}E=!1}E&&(g=_[0])}}return _=po(),_.memoizedState=_.baseState=g,E={pending:null,lanes:0,dispatch:null,lastRenderedReducer:FF,lastRenderedState:g},_.queue=E,_=r8.bind(null,Ir,E),E.dispatch=_,E=XA(!1),q=rR.bind(null,Ir,!1,E.queue),E=po(),j={state:g,dispatch:null,action:p,pending:null},E.queue=j,_=Ude.bind(null,Ir,j,q,_),j.dispatch=_,E.memoizedState=p,[g,_,!1]}function BF(p){var g=Si();return $F(g,ws,p)}function $F(p,g,_){if(g=YA(p,g,FF)[0],p=L_(ad)[0],typeof g=="object"&&g!==null&&typeof g.then=="function")try{var E=Jb(g)}catch(ue){throw ue===Hb?I_:ue}else E=g;g=Si();var j=g.queue,q=j.dispatch;return _!==g.memoizedState&&(Ir.flags|=2048,Ig(9,B_(),qde.bind(null,j,_),null)),[E,q,p]}function qde(p,g){p.action=g}function zF(p){var g=Si(),_=ws;if(_!==null)return $F(g,_,p);Si(),g=g.memoizedState,_=Si();var E=_.queue.dispatch;return _.memoizedState=p,[g,E,!1]}function Ig(p,g,_,E){return p={tag:p,create:_,deps:E,inst:g,next:null},g=Ir.updateQueue,g===null&&(g=GA(),Ir.updateQueue=g),_=g.lastEffect,_===null?g.lastEffect=p.next=p:(E=_.next,_.next=p,p.next=E,g.lastEffect=p),p}function B_(){return{destroy:void 0,resource:void 0}}function UF(){return Si().memoizedState}function $_(p,g,_,E){var j=po();E=E===void 0?null:E,Ir.flags|=p,j.memoizedState=Ig(1|g,B_(),_,E)}function Qb(p,g,_,E){var j=Si();E=E===void 0?null:E;var q=j.memoizedState.inst;ws!==null&&E!==null&&UA(E,ws.memoizedState.deps)?j.memoizedState=Ig(g,q,_,E):(Ir.flags|=p,j.memoizedState=Ig(1|g,q,_,E))}function qF(p,g){$_(8390656,8,p,g)}function VF(p,g){Qb(2048,8,p,g)}function WF(p,g){return Qb(4,2,p,g)}function HF(p,g){return Qb(4,4,p,g)}function GF(p,g){if(typeof g=="function"){p=p();var _=g(p);return function(){typeof _=="function"?_():g(null)}}if(g!=null)return p=p(),g.current=p,function(){g.current=null}}function KF(p,g,_){_=_!=null?_.concat([p]):null,Qb(4,4,GF.bind(null,g,p),_)}function QA(){}function YF(p,g){var _=Si();g=g===void 0?null:g;var E=_.memoizedState;return g!==null&&UA(g,E[1])?E[0]:(_.memoizedState=[p,g],p)}function ZF(p,g){var _=Si();g=g===void 0?null:g;var E=_.memoizedState;if(g!==null&&UA(g,E[1]))return E[0];if(E=p(),Ap){Lt(!0);try{p()}finally{Lt(!1)}}return _.memoizedState=[E,g],E}function eR(p,g,_){return _===void 0||(Nf&1073741824)!==0?p.memoizedState=g:(p.memoizedState=_,p=Q8(),Ir.lanes|=p,Ff|=p,_)}function XF(p,g,_,E){return ka(_,g)?_:Rg.current!==null?(p=eR(p,_,E),ka(p,g)||(Zi=!0),p):(Nf&42)===0?(Zi=!0,p.memoizedState=_):(p=Q8(),Ir.lanes|=p,Ff|=p,g)}function JF(p,g,_,E,j){var q=H.p;H.p=q!==0&&8>q?q:8;var ue=U.T,Re={};U.T=Re,rR(p,!1,g,_);try{var Ye=j(),wt=U.S;if(wt!==null&&wt(Re,Ye),Ye!==null&&typeof Ye=="object"&&typeof Ye.then=="function"){var Dt=Bde(Ye,E);ev(p,g,Dt,Zo(p))}else ev(p,g,E,Zo(p))}catch(Bt){ev(p,g,{then:function(){},status:"rejected",reason:Bt},Zo())}finally{H.p=q,U.T=ue}}function Vde(){}function tR(p,g,_,E){if(p.tag!==5)throw Error(r(476));var j=QF(p).queue;JF(p,j,g,$,_===null?Vde:function(){return e8(p),_(E)})}function QF(p){var g=p.memoizedState;if(g!==null)return g;g={memoizedState:$,baseState:$,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ad,lastRenderedState:$},next:null};var _={};return g.next={memoizedState:_,baseState:_,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ad,lastRenderedState:_},next:null},p.memoizedState=g,p=p.alternate,p!==null&&(p.memoizedState=g),g}function e8(p){var g=QF(p).next.queue;ev(p,g,{},Zo())}function nR(){return Ea(bv)}function t8(){return Si().memoizedState}function n8(){return Si().memoizedState}function Wde(p){for(var g=p.return;g!==null;){switch(g.tag){case 24:case 3:var _=Zo();p=Af(_);var E=Rf(g,p,_);E!==null&&(Xo(E,g,_),Kb(E,g,_)),g={cache:IA()},p.payload=g;return}g=g.return}}function Hde(p,g,_){var E=Zo();_={lane:E,revertLane:0,action:_,hasEagerState:!1,eagerState:null,next:null},z_(p)?s8(g,_):(_=wi(p,g,_,E),_!==null&&(Xo(_,p,E),i8(_,g,E)))}function r8(p,g,_){var E=Zo();ev(p,g,_,E)}function ev(p,g,_,E){var j={lane:E,revertLane:0,action:_,hasEagerState:!1,eagerState:null,next:null};if(z_(p))s8(g,j);else{var q=p.alternate;if(p.lanes===0&&(q===null||q.lanes===0)&&(q=g.lastRenderedReducer,q!==null))try{var ue=g.lastRenderedState,Re=q(ue,_);if(j.hasEagerState=!0,j.eagerState=Re,ka(Re,ue))return ui(p,g,j,0),Ps===null&&rr(),!1}catch{}finally{}if(_=wi(p,g,j,E),_!==null)return Xo(_,p,E),i8(_,g,E),!0}return!1}function rR(p,g,_,E){if(E={lane:2,revertLane:OR(),action:E,hasEagerState:!1,eagerState:null,next:null},z_(p)){if(g)throw Error(r(479))}else g=wi(p,_,E,2),g!==null&&Xo(g,p,2)}function z_(p){var g=p.alternate;return p===Ir||g!==null&&g===Ir}function s8(p,g){Ng=O_=!0;var _=p.pending;_===null?g.next=g:(g.next=_.next,_.next=g),p.pending=g}function i8(p,g,_){if((_&4194048)!==0){var E=g.lanes;E&=p.pendingLanes,_|=E,g.lanes=_,Ue(p,_)}}var U_={readContext:Ea,use:F_,useCallback:di,useContext:di,useEffect:di,useImperativeHandle:di,useLayoutEffect:di,useInsertionEffect:di,useMemo:di,useReducer:di,useRef:di,useState:di,useDebugValue:di,useDeferredValue:di,useTransition:di,useSyncExternalStore:di,useId:di,useHostTransitionStatus:di,useFormState:di,useActionState:di,useOptimistic:di,useMemoCache:di,useCacheRefresh:di},a8={readContext:Ea,use:F_,useCallback:function(p,g){return po().memoizedState=[p,g===void 0?null:g],p},useContext:Ea,useEffect:qF,useImperativeHandle:function(p,g,_){_=_!=null?_.concat([p]):null,$_(4194308,4,GF.bind(null,g,p),_)},useLayoutEffect:function(p,g){return $_(4194308,4,p,g)},useInsertionEffect:function(p,g){$_(4,2,p,g)},useMemo:function(p,g){var _=po();g=g===void 0?null:g;var E=p();if(Ap){Lt(!0);try{p()}finally{Lt(!1)}}return _.memoizedState=[E,g],E},useReducer:function(p,g,_){var E=po();if(_!==void 0){var j=_(g);if(Ap){Lt(!0);try{_(g)}finally{Lt(!1)}}}else j=g;return E.memoizedState=E.baseState=j,p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:p,lastRenderedState:j},E.queue=p,p=p.dispatch=Hde.bind(null,Ir,p),[E.memoizedState,p]},useRef:function(p){var g=po();return p={current:p},g.memoizedState=p},useState:function(p){p=XA(p);var g=p.queue,_=r8.bind(null,Ir,g);return g.dispatch=_,[p.memoizedState,_]},useDebugValue:QA,useDeferredValue:function(p,g){var _=po();return eR(_,p,g)},useTransition:function(){var p=XA(!1);return p=JF.bind(null,Ir,p.queue,!0,!1),po().memoizedState=p,[!1,p]},useSyncExternalStore:function(p,g,_){var E=Ir,j=po();if(ss){if(_===void 0)throw Error(r(407));_=_()}else{if(_=g(),Ps===null)throw Error(r(349));(Gr&124)!==0||TF(E,g,_)}j.memoizedState=_;var q={value:_,getSnapshot:g};return j.queue=q,qF(RF.bind(null,E,q,p),[p]),E.flags|=2048,Ig(9,B_(),AF.bind(null,E,q,_,g),null),_},useId:function(){var p=po(),g=Ps.identifierPrefix;if(ss){var _=rd,E=nd;_=(E&~(1<<32-en(E)-1)).toString(32)+_,g="«"+g+"R"+_,_=D_++,0<_&&(g+="H"+_.toString(32)),g+="»"}else _=$de++,g="«"+g+"r"+_.toString(32)+"»";return p.memoizedState=g},useHostTransitionStatus:nR,useFormState:LF,useActionState:LF,useOptimistic:function(p){var g=po();g.memoizedState=g.baseState=p;var _={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return g.queue=_,g=rR.bind(null,Ir,!0,_),_.dispatch=g,[p,g]},useMemoCache:KA,useCacheRefresh:function(){return po().memoizedState=Wde.bind(null,Ir)}},o8={readContext:Ea,use:F_,useCallback:YF,useContext:Ea,useEffect:VF,useImperativeHandle:KF,useInsertionEffect:WF,useLayoutEffect:HF,useMemo:ZF,useReducer:L_,useRef:UF,useState:function(){return L_(ad)},useDebugValue:QA,useDeferredValue:function(p,g){var _=Si();return XF(_,ws.memoizedState,p,g)},useTransition:function(){var p=L_(ad)[0],g=Si().memoizedState;return[typeof p=="boolean"?p:Jb(p),g]},useSyncExternalStore:EF,useId:t8,useHostTransitionStatus:nR,useFormState:BF,useActionState:BF,useOptimistic:function(p,g){var _=Si();return IF(_,ws,p,g)},useMemoCache:KA,useCacheRefresh:n8},Gde={readContext:Ea,use:F_,useCallback:YF,useContext:Ea,useEffect:VF,useImperativeHandle:KF,useInsertionEffect:WF,useLayoutEffect:HF,useMemo:ZF,useReducer:ZA,useRef:UF,useState:function(){return ZA(ad)},useDebugValue:QA,useDeferredValue:function(p,g){var _=Si();return ws===null?eR(_,p,g):XF(_,ws.memoizedState,p,g)},useTransition:function(){var p=ZA(ad)[0],g=Si().memoizedState;return[typeof p=="boolean"?p:Jb(p),g]},useSyncExternalStore:EF,useId:t8,useHostTransitionStatus:nR,useFormState:zF,useActionState:zF,useOptimistic:function(p,g){var _=Si();return ws!==null?IF(_,ws,p,g):(_.baseState=p,[p,_.queue.dispatch])},useMemoCache:KA,useCacheRefresh:n8},jg=null,tv=0;function q_(p){var g=tv;return tv+=1,jg===null&&(jg=[]),bF(jg,p,g)}function nv(p,g){g=g.props.ref,p.ref=g!==void 0?g:null}function V_(p,g){throw g.$$typeof===d?Error(r(525)):(p=Object.prototype.toString.call(g),Error(r(31,p==="[object Object]"?"object with keys {"+Object.keys(g).join(", ")+"}":p)))}function l8(p){var g=p._init;return g(p._payload)}function c8(p){function g(pt,rt){if(p){var xt=pt.deletions;xt===null?(pt.deletions=[rt],pt.flags|=16):xt.push(rt)}}function _(pt,rt){if(!p)return null;for(;rt!==null;)g(pt,rt),rt=rt.sibling;return null}function E(pt){for(var rt=new Map;pt!==null;)pt.key!==null?rt.set(pt.key,pt):rt.set(pt.index,pt),pt=pt.sibling;return rt}function j(pt,rt){return pt=td(pt,rt),pt.index=0,pt.sibling=null,pt}function q(pt,rt,xt){return pt.index=xt,p?(xt=pt.alternate,xt!==null?(xt=xt.index,xt<rt?(pt.flags|=67108866,rt):xt):(pt.flags|=67108866,rt)):(pt.flags|=1048576,rt)}function ue(pt){return p&&pt.alternate===null&&(pt.flags|=67108866),pt}function Re(pt,rt,xt,Ft){return rt===null||rt.tag!==6?(rt=CA(xt,pt.mode,Ft),rt.return=pt,rt):(rt=j(rt,xt),rt.return=pt,rt)}function Ye(pt,rt,xt,Ft){var bn=xt.type;return bn===y?Dt(pt,rt,xt.props.children,Ft,xt.key):rt!==null&&(rt.elementType===bn||typeof bn=="object"&&bn!==null&&bn.$$typeof===N&&l8(bn)===rt.type)?(rt=j(rt,xt.props),nv(rt,xt),rt.return=pt,rt):(rt=E_(xt.type,xt.key,xt.props,null,pt.mode,Ft),nv(rt,xt),rt.return=pt,rt)}function wt(pt,rt,xt,Ft){return rt===null||rt.tag!==4||rt.stateNode.containerInfo!==xt.containerInfo||rt.stateNode.implementation!==xt.implementation?(rt=kA(xt,pt.mode,Ft),rt.return=pt,rt):(rt=j(rt,xt.children||[]),rt.return=pt,rt)}function Dt(pt,rt,xt,Ft,bn){return rt===null||rt.tag!==7?(rt=xp(xt,pt.mode,Ft,bn),rt.return=pt,rt):(rt=j(rt,xt),rt.return=pt,rt)}function Bt(pt,rt,xt){if(typeof rt=="string"&&rt!==""||typeof rt=="number"||typeof rt=="bigint")return rt=CA(""+rt,pt.mode,xt),rt.return=pt,rt;if(typeof rt=="object"&&rt!==null){switch(rt.$$typeof){case h:return xt=E_(rt.type,rt.key,rt.props,null,pt.mode,xt),nv(xt,rt),xt.return=pt,xt;case m:return rt=kA(rt,pt.mode,xt),rt.return=pt,rt;case N:var Ft=rt._init;return rt=Ft(rt._payload),Bt(pt,rt,xt)}if(Z(rt)||O(rt))return rt=xp(rt,pt.mode,xt,null),rt.return=pt,rt;if(typeof rt.then=="function")return Bt(pt,q_(rt),xt);if(rt.$$typeof===S)return Bt(pt,N_(pt,rt),xt);V_(pt,rt)}return null}function Ct(pt,rt,xt,Ft){var bn=rt!==null?rt.key:null;if(typeof xt=="string"&&xt!==""||typeof xt=="number"||typeof xt=="bigint")return bn!==null?null:Re(pt,rt,""+xt,Ft);if(typeof xt=="object"&&xt!==null){switch(xt.$$typeof){case h:return xt.key===bn?Ye(pt,rt,xt,Ft):null;case m:return xt.key===bn?wt(pt,rt,xt,Ft):null;case N:return bn=xt._init,xt=bn(xt._payload),Ct(pt,rt,xt,Ft)}if(Z(xt)||O(xt))return bn!==null?null:Dt(pt,rt,xt,Ft,null);if(typeof xt.then=="function")return Ct(pt,rt,q_(xt),Ft);if(xt.$$typeof===S)return Ct(pt,rt,N_(pt,xt),Ft);V_(pt,xt)}return null}function At(pt,rt,xt,Ft,bn){if(typeof Ft=="string"&&Ft!==""||typeof Ft=="number"||typeof Ft=="bigint")return pt=pt.get(xt)||null,Re(rt,pt,""+Ft,bn);if(typeof Ft=="object"&&Ft!==null){switch(Ft.$$typeof){case h:return pt=pt.get(Ft.key===null?xt:Ft.key)||null,Ye(rt,pt,Ft,bn);case m:return pt=pt.get(Ft.key===null?xt:Ft.key)||null,wt(rt,pt,Ft,bn);case N:var Or=Ft._init;return Ft=Or(Ft._payload),At(pt,rt,xt,Ft,bn)}if(Z(Ft)||O(Ft))return pt=pt.get(xt)||null,Dt(rt,pt,Ft,bn,null);if(typeof Ft.then=="function")return At(pt,rt,xt,q_(Ft),bn);if(Ft.$$typeof===S)return At(pt,rt,xt,N_(rt,Ft),bn);V_(rt,Ft)}return null}function sr(pt,rt,xt,Ft){for(var bn=null,Or=null,jn=rt,Kn=rt=0,Ji=null;jn!==null&&Kn<xt.length;Kn++){jn.index>Kn?(Ji=jn,jn=null):Ji=jn.sibling;var ts=Ct(pt,jn,xt[Kn],Ft);if(ts===null){jn===null&&(jn=Ji);break}p&&jn&&ts.alternate===null&&g(pt,jn),rt=q(ts,rt,Kn),Or===null?bn=ts:Or.sibling=ts,Or=ts,jn=Ji}if(Kn===xt.length)return _(pt,jn),ss&&_p(pt,Kn),bn;if(jn===null){for(;Kn<xt.length;Kn++)jn=Bt(pt,xt[Kn],Ft),jn!==null&&(rt=q(jn,rt,Kn),Or===null?bn=jn:Or.sibling=jn,Or=jn);return ss&&_p(pt,Kn),bn}for(jn=E(jn);Kn<xt.length;Kn++)Ji=At(jn,pt,Kn,xt[Kn],Ft),Ji!==null&&(p&&Ji.alternate!==null&&jn.delete(Ji.key===null?Kn:Ji.key),rt=q(Ji,rt,Kn),Or===null?bn=Ji:Or.sibling=Ji,Or=Ji);return p&&jn.forEach(function(Hf){return g(pt,Hf)}),ss&&_p(pt,Kn),bn}function Wn(pt,rt,xt,Ft){if(xt==null)throw Error(r(151));for(var bn=null,Or=null,jn=rt,Kn=rt=0,Ji=null,ts=xt.next();jn!==null&&!ts.done;Kn++,ts=xt.next()){jn.index>Kn?(Ji=jn,jn=null):Ji=jn.sibling;var Hf=Ct(pt,jn,ts.value,Ft);if(Hf===null){jn===null&&(jn=Ji);break}p&&jn&&Hf.alternate===null&&g(pt,jn),rt=q(Hf,rt,Kn),Or===null?bn=Hf:Or.sibling=Hf,Or=Hf,jn=Ji}if(ts.done)return _(pt,jn),ss&&_p(pt,Kn),bn;if(jn===null){for(;!ts.done;Kn++,ts=xt.next())ts=Bt(pt,ts.value,Ft),ts!==null&&(rt=q(ts,rt,Kn),Or===null?bn=ts:Or.sibling=ts,Or=ts);return ss&&_p(pt,Kn),bn}for(jn=E(jn);!ts.done;Kn++,ts=xt.next())ts=At(jn,pt,Kn,ts.value,Ft),ts!==null&&(p&&ts.alternate!==null&&jn.delete(ts.key===null?Kn:ts.key),rt=q(ts,rt,Kn),Or===null?bn=ts:Or.sibling=ts,Or=ts);return p&&jn.forEach(function(Kfe){return g(pt,Kfe)}),ss&&_p(pt,Kn),bn}function Ss(pt,rt,xt,Ft){if(typeof xt=="object"&&xt!==null&&xt.type===y&&xt.key===null&&(xt=xt.props.children),typeof xt=="object"&&xt!==null){switch(xt.$$typeof){case h:e:{for(var bn=xt.key;rt!==null;){if(rt.key===bn){if(bn=xt.type,bn===y){if(rt.tag===7){_(pt,rt.sibling),Ft=j(rt,xt.props.children),Ft.return=pt,pt=Ft;break e}}else if(rt.elementType===bn||typeof bn=="object"&&bn!==null&&bn.$$typeof===N&&l8(bn)===rt.type){_(pt,rt.sibling),Ft=j(rt,xt.props),nv(Ft,xt),Ft.return=pt,pt=Ft;break e}_(pt,rt);break}else g(pt,rt);rt=rt.sibling}xt.type===y?(Ft=xp(xt.props.children,pt.mode,Ft,xt.key),Ft.return=pt,pt=Ft):(Ft=E_(xt.type,xt.key,xt.props,null,pt.mode,Ft),nv(Ft,xt),Ft.return=pt,pt=Ft)}return ue(pt);case m:e:{for(bn=xt.key;rt!==null;){if(rt.key===bn)if(rt.tag===4&&rt.stateNode.containerInfo===xt.containerInfo&&rt.stateNode.implementation===xt.implementation){_(pt,rt.sibling),Ft=j(rt,xt.children||[]),Ft.return=pt,pt=Ft;break e}else{_(pt,rt);break}else g(pt,rt);rt=rt.sibling}Ft=kA(xt,pt.mode,Ft),Ft.return=pt,pt=Ft}return ue(pt);case N:return bn=xt._init,xt=bn(xt._payload),Ss(pt,rt,xt,Ft)}if(Z(xt))return sr(pt,rt,xt,Ft);if(O(xt)){if(bn=O(xt),typeof bn!="function")throw Error(r(150));return xt=bn.call(xt),Wn(pt,rt,xt,Ft)}if(typeof xt.then=="function")return Ss(pt,rt,q_(xt),Ft);if(xt.$$typeof===S)return Ss(pt,rt,N_(pt,xt),Ft);V_(pt,xt)}return typeof xt=="string"&&xt!==""||typeof xt=="number"||typeof xt=="bigint"?(xt=""+xt,rt!==null&&rt.tag===6?(_(pt,rt.sibling),Ft=j(rt,xt),Ft.return=pt,pt=Ft):(_(pt,rt),Ft=CA(xt,pt.mode,Ft),Ft.return=pt,pt=Ft),ue(pt)):_(pt,rt)}return function(pt,rt,xt,Ft){try{tv=0;var bn=Ss(pt,rt,xt,Ft);return jg=null,bn}catch(jn){if(jn===Hb||jn===I_)throw jn;var Or=Ho(29,jn,null,pt.mode);return Or.lanes=Ft,Or.return=pt,Or}finally{}}}var Pg=c8(!0),u8=c8(!1),Rl=Q(null),Yc=null;function Mf(p){var g=p.alternate;se(Pi,Pi.current&1),se(Rl,p),Yc===null&&(g===null||Rg.current!==null||g.memoizedState!==null)&&(Yc=p)}function d8(p){if(p.tag===22){if(se(Pi,Pi.current),se(Rl,p),Yc===null){var g=p.alternate;g!==null&&g.memoizedState!==null&&(Yc=p)}}else If()}function If(){se(Pi,Pi.current),se(Rl,Rl.current)}function od(p){ee(Rl),Yc===p&&(Yc=null),ee(Pi)}var Pi=Q(0);function W_(p){for(var g=p;g!==null;){if(g.tag===13){var _=g.memoizedState;if(_!==null&&(_=_.dehydrated,_===null||_.data==="$?"||GR(_)))return g}else if(g.tag===19&&g.memoizedProps.revealOrder!==void 0){if((g.flags&128)!==0)return g}else if(g.child!==null){g.child.return=g,g=g.child;continue}if(g===p)break;for(;g.sibling===null;){if(g.return===null||g.return===p)return null;g=g.return}g.sibling.return=g.return,g=g.sibling}return null}function sR(p,g,_,E){g=p.memoizedState,_=_(E,g),_=_==null?g:u({},g,_),p.memoizedState=_,p.lanes===0&&(p.updateQueue.baseState=_)}var iR={enqueueSetState:function(p,g,_){p=p._reactInternals;var E=Zo(),j=Af(E);j.payload=g,_!=null&&(j.callback=_),g=Rf(p,j,E),g!==null&&(Xo(g,p,E),Kb(g,p,E))},enqueueReplaceState:function(p,g,_){p=p._reactInternals;var E=Zo(),j=Af(E);j.tag=1,j.payload=g,_!=null&&(j.callback=_),g=Rf(p,j,E),g!==null&&(Xo(g,p,E),Kb(g,p,E))},enqueueForceUpdate:function(p,g){p=p._reactInternals;var _=Zo(),E=Af(_);E.tag=2,g!=null&&(E.callback=g),g=Rf(p,E,_),g!==null&&(Xo(g,p,_),Kb(g,p,_))}};function f8(p,g,_,E,j,q,ue){return p=p.stateNode,typeof p.shouldComponentUpdate=="function"?p.shouldComponentUpdate(E,q,ue):g.prototype&&g.prototype.isPureReactComponent?!M(_,E)||!M(j,q):!0}function h8(p,g,_,E){p=g.state,typeof g.componentWillReceiveProps=="function"&&g.componentWillReceiveProps(_,E),typeof g.UNSAFE_componentWillReceiveProps=="function"&&g.UNSAFE_componentWillReceiveProps(_,E),g.state!==p&&iR.enqueueReplaceState(g,g.state,null)}function Rp(p,g){var _=g;if("ref"in g){_={};for(var E in g)E!=="ref"&&(_[E]=g[E])}if(p=p.defaultProps){_===g&&(_=u({},_));for(var j in p)_[j]===void 0&&(_[j]=p[j])}return _}var H_=typeof reportError=="function"?reportError:function(p){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var g=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof p=="object"&&p!==null&&typeof p.message=="string"?String(p.message):String(p),error:p});if(!window.dispatchEvent(g))return}else if(typeof Ai=="object"&&typeof Ai.emit=="function"){Ai.emit("uncaughtException",p);return}console.error(p)};function p8(p){H_(p)}function m8(p){console.error(p)}function g8(p){H_(p)}function G_(p,g){try{var _=p.onUncaughtError;_(g.value,{componentStack:g.stack})}catch(E){setTimeout(function(){throw E})}}function y8(p,g,_){try{var E=p.onCaughtError;E(_.value,{componentStack:_.stack,errorBoundary:g.tag===1?g.stateNode:null})}catch(j){setTimeout(function(){throw j})}}function aR(p,g,_){return _=Af(_),_.tag=3,_.payload={element:null},_.callback=function(){G_(p,g)},_}function b8(p){return p=Af(p),p.tag=3,p}function v8(p,g,_,E){var j=_.type.getDerivedStateFromError;if(typeof j=="function"){var q=E.value;p.payload=function(){return j(q)},p.callback=function(){y8(g,_,E)}}var ue=_.stateNode;ue!==null&&typeof ue.componentDidCatch=="function"&&(p.callback=function(){y8(g,_,E),typeof j!="function"&&(Lf===null?Lf=new Set([this]):Lf.add(this));var Re=E.stack;this.componentDidCatch(E.value,{componentStack:Re!==null?Re:""})})}function Kde(p,g,_,E,j){if(_.flags|=32768,E!==null&&typeof E=="object"&&typeof E.then=="function"){if(g=_.alternate,g!==null&&qb(g,_,j,!0),_=Rl.current,_!==null){switch(_.tag){case 13:return Yc===null?NR():_.alternate===null&&ii===0&&(ii=3),_.flags&=-257,_.flags|=65536,_.lanes=j,E===OA?_.flags|=16384:(g=_.updateQueue,g===null?_.updateQueue=new Set([E]):g.add(E),IR(p,E,j)),!1;case 22:return _.flags|=65536,E===OA?_.flags|=16384:(g=_.updateQueue,g===null?(g={transitions:null,markerInstances:null,retryQueue:new Set([E])},_.updateQueue=g):(_=g.retryQueue,_===null?g.retryQueue=new Set([E]):_.add(E)),IR(p,E,j)),!1}throw Error(r(435,_.tag))}return IR(p,E,j),NR(),!1}if(ss)return g=Rl.current,g!==null?((g.flags&65536)===0&&(g.flags|=256),g.flags|=65536,g.lanes=j,E!==AA&&(p=Error(r(422),{cause:E}),Ub(Bn(p,_)))):(E!==AA&&(g=Error(r(423),{cause:E}),Ub(Bn(g,_))),p=p.current.alternate,p.flags|=65536,j&=-j,p.lanes|=j,E=Bn(E,_),j=aR(p.stateNode,E,j),LA(p,j),ii!==4&&(ii=2)),!1;var q=Error(r(520),{cause:E});if(q=Bn(q,_),cv===null?cv=[q]:cv.push(q),ii!==4&&(ii=2),g===null)return!0;E=Bn(E,_),_=g;do{switch(_.tag){case 3:return _.flags|=65536,p=j&-j,_.lanes|=p,p=aR(_.stateNode,E,p),LA(_,p),!1;case 1:if(g=_.type,q=_.stateNode,(_.flags&128)===0&&(typeof g.getDerivedStateFromError=="function"||q!==null&&typeof q.componentDidCatch=="function"&&(Lf===null||!Lf.has(q))))return _.flags|=65536,j&=-j,_.lanes|=j,j=b8(j),v8(j,p,_,E),LA(_,j),!1}_=_.return}while(_!==null);return!1}var x8=Error(r(461)),Zi=!1;function fa(p,g,_,E){g.child=p===null?u8(g,null,_,E):Pg(g,p.child,_,E)}function w8(p,g,_,E,j){_=_.render;var q=g.ref;if("ref"in E){var ue={};for(var Re in E)Re!=="ref"&&(ue[Re]=E[Re])}else ue=E;return Ep(g),E=qA(p,g,_,ue,q,j),Re=VA(),p!==null&&!Zi?(WA(p,g,j),ld(p,g,j)):(ss&&Re&&EA(g),g.flags|=1,fa(p,g,E,j),g.child)}function _8(p,g,_,E,j){if(p===null){var q=_.type;return typeof q=="function"&&!SA(q)&&q.defaultProps===void 0&&_.compare===null?(g.tag=15,g.type=q,S8(p,g,q,E,j)):(p=E_(_.type,null,E,g,g.mode,j),p.ref=g.ref,p.return=g,g.child=p)}if(q=p.child,!pR(p,j)){var ue=q.memoizedProps;if(_=_.compare,_=_!==null?_:M,_(ue,E)&&p.ref===g.ref)return ld(p,g,j)}return g.flags|=1,p=td(q,E),p.ref=g.ref,p.return=g,g.child=p}function S8(p,g,_,E,j){if(p!==null){var q=p.memoizedProps;if(M(q,E)&&p.ref===g.ref)if(Zi=!1,g.pendingProps=E=q,pR(p,j))(p.flags&131072)!==0&&(Zi=!0);else return g.lanes=p.lanes,ld(p,g,j)}return oR(p,g,_,E,j)}function C8(p,g,_){var E=g.pendingProps,j=E.children,q=p!==null?p.memoizedState:null;if(E.mode==="hidden"){if((g.flags&128)!==0){if(E=q!==null?q.baseLanes|_:_,p!==null){for(j=g.child=p.child,q=0;j!==null;)q=q|j.lanes|j.childLanes,j=j.sibling;g.childLanes=q&~E}else g.childLanes=0,g.child=null;return k8(p,g,E,_)}if((_&536870912)!==0)g.memoizedState={baseLanes:0,cachePool:null},p!==null&&M_(g,q!==null?q.cachePool:null),q!==null?SF(g,q):$A(),d8(g);else return g.lanes=g.childLanes=536870912,k8(p,g,q!==null?q.baseLanes|_:_,_)}else q!==null?(M_(g,q.cachePool),SF(g,q),If(),g.memoizedState=null):(p!==null&&M_(g,null),$A(),If());return fa(p,g,j,_),g.child}function k8(p,g,_,E){var j=PA();return j=j===null?null:{parent:ji._currentValue,pool:j},g.memoizedState={baseLanes:_,cachePool:j},p!==null&&M_(g,null),$A(),d8(g),p!==null&&qb(p,g,E,!0),null}function K_(p,g){var _=g.ref;if(_===null)p!==null&&p.ref!==null&&(g.flags|=4194816);else{if(typeof _!="function"&&typeof _!="object")throw Error(r(284));(p===null||p.ref!==_)&&(g.flags|=4194816)}}function oR(p,g,_,E,j){return Ep(g),_=qA(p,g,_,E,void 0,j),E=VA(),p!==null&&!Zi?(WA(p,g,j),ld(p,g,j)):(ss&&E&&EA(g),g.flags|=1,fa(p,g,_,j),g.child)}function E8(p,g,_,E,j,q){return Ep(g),g.updateQueue=null,_=kF(g,E,_,j),CF(p),E=VA(),p!==null&&!Zi?(WA(p,g,q),ld(p,g,q)):(ss&&E&&EA(g),g.flags|=1,fa(p,g,_,q),g.child)}function T8(p,g,_,E,j){if(Ep(g),g.stateNode===null){var q=Gc,ue=_.contextType;typeof ue=="object"&&ue!==null&&(q=Ea(ue)),q=new _(E,q),g.memoizedState=q.state!==null&&q.state!==void 0?q.state:null,q.updater=iR,g.stateNode=q,q._reactInternals=g,q=g.stateNode,q.props=E,q.state=g.memoizedState,q.refs={},DA(g),ue=_.contextType,q.context=typeof ue=="object"&&ue!==null?Ea(ue):Gc,q.state=g.memoizedState,ue=_.getDerivedStateFromProps,typeof ue=="function"&&(sR(g,_,ue,E),q.state=g.memoizedState),typeof _.getDerivedStateFromProps=="function"||typeof q.getSnapshotBeforeUpdate=="function"||typeof q.UNSAFE_componentWillMount!="function"&&typeof q.componentWillMount!="function"||(ue=q.state,typeof q.componentWillMount=="function"&&q.componentWillMount(),typeof q.UNSAFE_componentWillMount=="function"&&q.UNSAFE_componentWillMount(),ue!==q.state&&iR.enqueueReplaceState(q,q.state,null),Zb(g,E,q,j),Yb(),q.state=g.memoizedState),typeof q.componentDidMount=="function"&&(g.flags|=4194308),E=!0}else if(p===null){q=g.stateNode;var Re=g.memoizedProps,Ye=Rp(_,Re);q.props=Ye;var wt=q.context,Dt=_.contextType;ue=Gc,typeof Dt=="object"&&Dt!==null&&(ue=Ea(Dt));var Bt=_.getDerivedStateFromProps;Dt=typeof Bt=="function"||typeof q.getSnapshotBeforeUpdate=="function",Re=g.pendingProps!==Re,Dt||typeof q.UNSAFE_componentWillReceiveProps!="function"&&typeof q.componentWillReceiveProps!="function"||(Re||wt!==ue)&&h8(g,q,E,ue),Tf=!1;var Ct=g.memoizedState;q.state=Ct,Zb(g,E,q,j),Yb(),wt=g.memoizedState,Re||Ct!==wt||Tf?(typeof Bt=="function"&&(sR(g,_,Bt,E),wt=g.memoizedState),(Ye=Tf||f8(g,_,Ye,E,Ct,wt,ue))?(Dt||typeof q.UNSAFE_componentWillMount!="function"&&typeof q.componentWillMount!="function"||(typeof q.componentWillMount=="function"&&q.componentWillMount(),typeof q.UNSAFE_componentWillMount=="function"&&q.UNSAFE_componentWillMount()),typeof q.componentDidMount=="function"&&(g.flags|=4194308)):(typeof q.componentDidMount=="function"&&(g.flags|=4194308),g.memoizedProps=E,g.memoizedState=wt),q.props=E,q.state=wt,q.context=ue,E=Ye):(typeof q.componentDidMount=="function"&&(g.flags|=4194308),E=!1)}else{q=g.stateNode,FA(p,g),ue=g.memoizedProps,Dt=Rp(_,ue),q.props=Dt,Bt=g.pendingProps,Ct=q.context,wt=_.contextType,Ye=Gc,typeof wt=="object"&&wt!==null&&(Ye=Ea(wt)),Re=_.getDerivedStateFromProps,(wt=typeof Re=="function"||typeof q.getSnapshotBeforeUpdate=="function")||typeof q.UNSAFE_componentWillReceiveProps!="function"&&typeof q.componentWillReceiveProps!="function"||(ue!==Bt||Ct!==Ye)&&h8(g,q,E,Ye),Tf=!1,Ct=g.memoizedState,q.state=Ct,Zb(g,E,q,j),Yb();var At=g.memoizedState;ue!==Bt||Ct!==At||Tf||p!==null&&p.dependencies!==null&&R_(p.dependencies)?(typeof Re=="function"&&(sR(g,_,Re,E),At=g.memoizedState),(Dt=Tf||f8(g,_,Dt,E,Ct,At,Ye)||p!==null&&p.dependencies!==null&&R_(p.dependencies))?(wt||typeof q.UNSAFE_componentWillUpdate!="function"&&typeof q.componentWillUpdate!="function"||(typeof q.componentWillUpdate=="function"&&q.componentWillUpdate(E,At,Ye),typeof q.UNSAFE_componentWillUpdate=="function"&&q.UNSAFE_componentWillUpdate(E,At,Ye)),typeof q.componentDidUpdate=="function"&&(g.flags|=4),typeof q.getSnapshotBeforeUpdate=="function"&&(g.flags|=1024)):(typeof q.componentDidUpdate!="function"||ue===p.memoizedProps&&Ct===p.memoizedState||(g.flags|=4),typeof q.getSnapshotBeforeUpdate!="function"||ue===p.memoizedProps&&Ct===p.memoizedState||(g.flags|=1024),g.memoizedProps=E,g.memoizedState=At),q.props=E,q.state=At,q.context=Ye,E=Dt):(typeof q.componentDidUpdate!="function"||ue===p.memoizedProps&&Ct===p.memoizedState||(g.flags|=4),typeof q.getSnapshotBeforeUpdate!="function"||ue===p.memoizedProps&&Ct===p.memoizedState||(g.flags|=1024),E=!1)}return q=E,K_(p,g),E=(g.flags&128)!==0,q||E?(q=g.stateNode,_=E&&typeof _.getDerivedStateFromError!="function"?null:q.render(),g.flags|=1,p!==null&&E?(g.child=Pg(g,p.child,null,j),g.child=Pg(g,null,_,j)):fa(p,g,_,j),g.memoizedState=q.state,p=g.child):p=ld(p,g,j),p}function A8(p,g,_,E){return zb(),g.flags|=256,fa(p,g,_,E),g.child}var lR={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function cR(p){return{baseLanes:p,cachePool:mF()}}function uR(p,g,_){return p=p!==null?p.childLanes&~_:0,g&&(p|=Nl),p}function R8(p,g,_){var E=g.pendingProps,j=!1,q=(g.flags&128)!==0,ue;if((ue=q)||(ue=p!==null&&p.memoizedState===null?!1:(Pi.current&2)!==0),ue&&(j=!0,g.flags&=-129),ue=(g.flags&32)!==0,g.flags&=-33,p===null){if(ss){if(j?Mf(g):If(),ss){var Re=si,Ye;if(Ye=Re){e:{for(Ye=Re,Re=Kc;Ye.nodeType!==8;){if(!Re){Re=null;break e}if(Ye=lc(Ye.nextSibling),Ye===null){Re=null;break e}}Re=Ye}Re!==null?(g.memoizedState={dehydrated:Re,treeContext:wp!==null?{id:nd,overflow:rd}:null,retryLane:536870912,hydrationErrors:null},Ye=Ho(18,null,null,0),Ye.stateNode=Re,Ye.return=g,g.child=Ye,Ga=g,si=null,Ye=!0):Ye=!1}Ye||Cp(g)}if(Re=g.memoizedState,Re!==null&&(Re=Re.dehydrated,Re!==null))return GR(Re)?g.lanes=32:g.lanes=536870912,null;od(g)}return Re=E.children,E=E.fallback,j?(If(),j=g.mode,Re=Y_({mode:"hidden",children:Re},j),E=xp(E,j,_,null),Re.return=g,E.return=g,Re.sibling=E,g.child=Re,j=g.child,j.memoizedState=cR(_),j.childLanes=uR(p,ue,_),g.memoizedState=lR,E):(Mf(g),dR(g,Re))}if(Ye=p.memoizedState,Ye!==null&&(Re=Ye.dehydrated,Re!==null)){if(q)g.flags&256?(Mf(g),g.flags&=-257,g=fR(p,g,_)):g.memoizedState!==null?(If(),g.child=p.child,g.flags|=128,g=null):(If(),j=E.fallback,Re=g.mode,E=Y_({mode:"visible",children:E.children},Re),j=xp(j,Re,_,null),j.flags|=2,E.return=g,j.return=g,E.sibling=j,g.child=E,Pg(g,p.child,null,_),E=g.child,E.memoizedState=cR(_),E.childLanes=uR(p,ue,_),g.memoizedState=lR,g=j);else if(Mf(g),GR(Re)){if(ue=Re.nextSibling&&Re.nextSibling.dataset,ue)var wt=ue.dgst;ue=wt,E=Error(r(419)),E.stack="",E.digest=ue,Ub({value:E,source:null,stack:null}),g=fR(p,g,_)}else if(Zi||qb(p,g,_,!1),ue=(_&p.childLanes)!==0,Zi||ue){if(ue=Ps,ue!==null&&(E=_&-_,E=(E&42)!==0?1:kt(E),E=(E&(ue.suspendedLanes|_))!==0?0:E,E!==0&&E!==Ye.retryLane))throw Ye.retryLane=E,ac(p,E),Xo(ue,p,E),x8;Re.data==="$?"||NR(),g=fR(p,g,_)}else Re.data==="$?"?(g.flags|=192,g.child=p.child,g=null):(p=Ye.treeContext,si=lc(Re.nextSibling),Ga=g,ss=!0,Sp=null,Kc=!1,p!==null&&(Tl[Al++]=nd,Tl[Al++]=rd,Tl[Al++]=wp,nd=p.id,rd=p.overflow,wp=g),g=dR(g,E.children),g.flags|=4096);return g}return j?(If(),j=E.fallback,Re=g.mode,Ye=p.child,wt=Ye.sibling,E=td(Ye,{mode:"hidden",children:E.children}),E.subtreeFlags=Ye.subtreeFlags&65011712,wt!==null?j=td(wt,j):(j=xp(j,Re,_,null),j.flags|=2),j.return=g,E.return=g,E.sibling=j,g.child=E,E=j,j=g.child,Re=p.child.memoizedState,Re===null?Re=cR(_):(Ye=Re.cachePool,Ye!==null?(wt=ji._currentValue,Ye=Ye.parent!==wt?{parent:wt,pool:wt}:Ye):Ye=mF(),Re={baseLanes:Re.baseLanes|_,cachePool:Ye}),j.memoizedState=Re,j.childLanes=uR(p,ue,_),g.memoizedState=lR,E):(Mf(g),_=p.child,p=_.sibling,_=td(_,{mode:"visible",children:E.children}),_.return=g,_.sibling=null,p!==null&&(ue=g.deletions,ue===null?(g.deletions=[p],g.flags|=16):ue.push(p)),g.child=_,g.memoizedState=null,_)}function dR(p,g){return g=Y_({mode:"visible",children:g},p.mode),g.return=p,p.child=g}function Y_(p,g){return p=Ho(22,p,null,g),p.lanes=0,p.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},p}function fR(p,g,_){return Pg(g,p.child,null,_),p=dR(g,g.pendingProps.children),p.flags|=2,g.memoizedState=null,p}function N8(p,g,_){p.lanes|=g;var E=p.alternate;E!==null&&(E.lanes|=g),NA(p.return,g,_)}function hR(p,g,_,E,j){var q=p.memoizedState;q===null?p.memoizedState={isBackwards:g,rendering:null,renderingStartTime:0,last:E,tail:_,tailMode:j}:(q.isBackwards=g,q.rendering=null,q.renderingStartTime=0,q.last=E,q.tail=_,q.tailMode=j)}function M8(p,g,_){var E=g.pendingProps,j=E.revealOrder,q=E.tail;if(fa(p,g,E.children,_),E=Pi.current,(E&2)!==0)E=E&1|2,g.flags|=128;else{if(p!==null&&(p.flags&128)!==0)e:for(p=g.child;p!==null;){if(p.tag===13)p.memoizedState!==null&&N8(p,_,g);else if(p.tag===19)N8(p,_,g);else if(p.child!==null){p.child.return=p,p=p.child;continue}if(p===g)break e;for(;p.sibling===null;){if(p.return===null||p.return===g)break e;p=p.return}p.sibling.return=p.return,p=p.sibling}E&=1}switch(se(Pi,E),j){case"forwards":for(_=g.child,j=null;_!==null;)p=_.alternate,p!==null&&W_(p)===null&&(j=_),_=_.sibling;_=j,_===null?(j=g.child,g.child=null):(j=_.sibling,_.sibling=null),hR(g,!1,j,_,q);break;case"backwards":for(_=null,j=g.child,g.child=null;j!==null;){if(p=j.alternate,p!==null&&W_(p)===null){g.child=j;break}p=j.sibling,j.sibling=_,_=j,j=p}hR(g,!0,_,null,q);break;case"together":hR(g,!1,null,null,void 0);break;default:g.memoizedState=null}return g.child}function ld(p,g,_){if(p!==null&&(g.dependencies=p.dependencies),Ff|=g.lanes,(_&g.childLanes)===0)if(p!==null){if(qb(p,g,_,!1),(_&g.childLanes)===0)return null}else return null;if(p!==null&&g.child!==p.child)throw Error(r(153));if(g.child!==null){for(p=g.child,_=td(p,p.pendingProps),g.child=_,_.return=g;p.sibling!==null;)p=p.sibling,_=_.sibling=td(p,p.pendingProps),_.return=g;_.sibling=null}return g.child}function pR(p,g){return(p.lanes&g)!==0?!0:(p=p.dependencies,!!(p!==null&&R_(p)))}function Yde(p,g,_){switch(g.tag){case 3:Se(g,g.stateNode.containerInfo),Ef(g,ji,p.memoizedState.cache),zb();break;case 27:case 5:qe(g);break;case 4:Se(g,g.stateNode.containerInfo);break;case 10:Ef(g,g.type,g.memoizedProps.value);break;case 13:var E=g.memoizedState;if(E!==null)return E.dehydrated!==null?(Mf(g),g.flags|=128,null):(_&g.child.childLanes)!==0?R8(p,g,_):(Mf(g),p=ld(p,g,_),p!==null?p.sibling:null);Mf(g);break;case 19:var j=(p.flags&128)!==0;if(E=(_&g.childLanes)!==0,E||(qb(p,g,_,!1),E=(_&g.childLanes)!==0),j){if(E)return M8(p,g,_);g.flags|=128}if(j=g.memoizedState,j!==null&&(j.rendering=null,j.tail=null,j.lastEffect=null),se(Pi,Pi.current),E)break;return null;case 22:case 23:return g.lanes=0,C8(p,g,_);case 24:Ef(g,ji,p.memoizedState.cache)}return ld(p,g,_)}function I8(p,g,_){if(p!==null)if(p.memoizedProps!==g.pendingProps)Zi=!0;else{if(!pR(p,_)&&(g.flags&128)===0)return Zi=!1,Yde(p,g,_);Zi=(p.flags&131072)!==0}else Zi=!1,ss&&(g.flags&1048576)!==0&&lF(g,A_,g.index);switch(g.lanes=0,g.tag){case 16:e:{p=g.pendingProps;var E=g.elementType,j=E._init;if(E=j(E._payload),g.type=E,typeof E=="function")SA(E)?(p=Rp(E,p),g.tag=1,g=T8(null,g,E,p,_)):(g.tag=0,g=oR(null,g,E,p,_));else{if(E!=null){if(j=E.$$typeof,j===C){g.tag=11,g=w8(null,g,E,p,_);break e}else if(j===R){g.tag=14,g=_8(null,g,E,p,_);break e}}throw g=D(E)||E,Error(r(306,g,""))}}return g;case 0:return oR(p,g,g.type,g.pendingProps,_);case 1:return E=g.type,j=Rp(E,g.pendingProps),T8(p,g,E,j,_);case 3:e:{if(Se(g,g.stateNode.containerInfo),p===null)throw Error(r(387));E=g.pendingProps;var q=g.memoizedState;j=q.element,FA(p,g),Zb(g,E,null,_);var ue=g.memoizedState;if(E=ue.cache,Ef(g,ji,E),E!==q.cache&&MA(g,[ji],_,!0),Yb(),E=ue.element,q.isDehydrated)if(q={element:E,isDehydrated:!1,cache:ue.cache},g.updateQueue.baseState=q,g.memoizedState=q,g.flags&256){g=A8(p,g,E,_);break e}else if(E!==j){j=Bn(Error(r(424)),g),Ub(j),g=A8(p,g,E,_);break e}else{switch(p=g.stateNode.containerInfo,p.nodeType){case 9:p=p.body;break;default:p=p.nodeName==="HTML"?p.ownerDocument.body:p}for(si=lc(p.firstChild),Ga=g,ss=!0,Sp=null,Kc=!0,_=u8(g,null,E,_),g.child=_;_;)_.flags=_.flags&-3|4096,_=_.sibling}else{if(zb(),E===j){g=ld(p,g,_);break e}fa(p,g,E,_)}g=g.child}return g;case 26:return K_(p,g),p===null?(_=DL(g.type,null,g.pendingProps,null))?g.memoizedState=_:ss||(_=g.type,p=g.pendingProps,E=cS(Ie.current).createElement(_),E[ve]=g,E[Oe]=p,pa(E,_,p),Cr(E),g.stateNode=E):g.memoizedState=DL(g.type,p.memoizedProps,g.pendingProps,p.memoizedState),null;case 27:return qe(g),p===null&&ss&&(E=g.stateNode=jL(g.type,g.pendingProps,Ie.current),Ga=g,Kc=!0,j=si,zf(g.type)?(KR=j,si=lc(E.firstChild)):si=j),fa(p,g,g.pendingProps.children,_),K_(p,g),p===null&&(g.flags|=4194304),g.child;case 5:return p===null&&ss&&((j=E=si)&&(E=Sfe(E,g.type,g.pendingProps,Kc),E!==null?(g.stateNode=E,Ga=g,si=lc(E.firstChild),Kc=!1,j=!0):j=!1),j||Cp(g)),qe(g),j=g.type,q=g.pendingProps,ue=p!==null?p.memoizedProps:null,E=q.children,VR(j,q)?E=null:ue!==null&&VR(j,ue)&&(g.flags|=32),g.memoizedState!==null&&(j=qA(p,g,zde,null,null,_),bv._currentValue=j),K_(p,g),fa(p,g,E,_),g.child;case 6:return p===null&&ss&&((p=_=si)&&(_=Cfe(_,g.pendingProps,Kc),_!==null?(g.stateNode=_,Ga=g,si=null,p=!0):p=!1),p||Cp(g)),null;case 13:return R8(p,g,_);case 4:return Se(g,g.stateNode.containerInfo),E=g.pendingProps,p===null?g.child=Pg(g,null,E,_):fa(p,g,E,_),g.child;case 11:return w8(p,g,g.type,g.pendingProps,_);case 7:return fa(p,g,g.pendingProps,_),g.child;case 8:return fa(p,g,g.pendingProps.children,_),g.child;case 12:return fa(p,g,g.pendingProps.children,_),g.child;case 10:return E=g.pendingProps,Ef(g,g.type,E.value),fa(p,g,E.children,_),g.child;case 9:return j=g.type._context,E=g.pendingProps.children,Ep(g),j=Ea(j),E=E(j),g.flags|=1,fa(p,g,E,_),g.child;case 14:return _8(p,g,g.type,g.pendingProps,_);case 15:return S8(p,g,g.type,g.pendingProps,_);case 19:return M8(p,g,_);case 31:return E=g.pendingProps,_=g.mode,E={mode:E.mode,children:E.children},p===null?(_=Y_(E,_),_.ref=g.ref,g.child=_,_.return=g,g=_):(_=td(p.child,E),_.ref=g.ref,g.child=_,_.return=g,g=_),g;case 22:return C8(p,g,_);case 24:return Ep(g),E=Ea(ji),p===null?(j=PA(),j===null&&(j=Ps,q=IA(),j.pooledCache=q,q.refCount++,q!==null&&(j.pooledCacheLanes|=_),j=q),g.memoizedState={parent:E,cache:j},DA(g),Ef(g,ji,j)):((p.lanes&_)!==0&&(FA(p,g),Zb(g,null,null,_),Yb()),j=p.memoizedState,q=g.memoizedState,j.parent!==E?(j={parent:E,cache:E},g.memoizedState=j,g.lanes===0&&(g.memoizedState=g.updateQueue.baseState=j),Ef(g,ji,E)):(E=q.cache,Ef(g,ji,E),E!==j.cache&&MA(g,[ji],_,!0))),fa(p,g,g.pendingProps.children,_),g.child;case 29:throw g.pendingProps}throw Error(r(156,g.tag))}function cd(p){p.flags|=4}function j8(p,g){if(g.type!=="stylesheet"||(g.state.loading&4)!==0)p.flags&=-16777217;else if(p.flags|=16777216,!zL(g)){if(g=Rl.current,g!==null&&((Gr&4194048)===Gr?Yc!==null:(Gr&62914560)!==Gr&&(Gr&536870912)===0||g!==Yc))throw Gb=OA,gF;p.flags|=8192}}function Z_(p,g){g!==null&&(p.flags|=4),p.flags&16384&&(g=p.tag!==22?B():536870912,p.lanes|=g,Lg|=g)}function rv(p,g){if(!ss)switch(p.tailMode){case"hidden":g=p.tail;for(var _=null;g!==null;)g.alternate!==null&&(_=g),g=g.sibling;_===null?p.tail=null:_.sibling=null;break;case"collapsed":_=p.tail;for(var E=null;_!==null;)_.alternate!==null&&(E=_),_=_.sibling;E===null?g||p.tail===null?p.tail=null:p.tail.sibling=null:E.sibling=null}}function Zs(p){var g=p.alternate!==null&&p.alternate.child===p.child,_=0,E=0;if(g)for(var j=p.child;j!==null;)_|=j.lanes|j.childLanes,E|=j.subtreeFlags&65011712,E|=j.flags&65011712,j.return=p,j=j.sibling;else for(j=p.child;j!==null;)_|=j.lanes|j.childLanes,E|=j.subtreeFlags,E|=j.flags,j.return=p,j=j.sibling;return p.subtreeFlags|=E,p.childLanes=_,g}function Zde(p,g,_){var E=g.pendingProps;switch(TA(g),g.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Zs(g),null;case 1:return Zs(g),null;case 3:return _=g.stateNode,E=null,p!==null&&(E=p.memoizedState.cache),g.memoizedState.cache!==E&&(g.flags|=2048),id(ji),Ce(),_.pendingContext&&(_.context=_.pendingContext,_.pendingContext=null),(p===null||p.child===null)&&($b(g)?cd(g):p===null||p.memoizedState.isDehydrated&&(g.flags&256)===0||(g.flags|=1024,dF())),Zs(g),null;case 26:return _=g.memoizedState,p===null?(cd(g),_!==null?(Zs(g),j8(g,_)):(Zs(g),g.flags&=-16777217)):_?_!==p.memoizedState?(cd(g),Zs(g),j8(g,_)):(Zs(g),g.flags&=-16777217):(p.memoizedProps!==E&&cd(g),Zs(g),g.flags&=-16777217),null;case 27:Qe(g),_=Ie.current;var j=g.type;if(p!==null&&g.stateNode!=null)p.memoizedProps!==E&&cd(g);else{if(!E){if(g.stateNode===null)throw Error(r(166));return Zs(g),null}p=pe.current,$b(g)?cF(g):(p=jL(j,E,_),g.stateNode=p,cd(g))}return Zs(g),null;case 5:if(Qe(g),_=g.type,p!==null&&g.stateNode!=null)p.memoizedProps!==E&&cd(g);else{if(!E){if(g.stateNode===null)throw Error(r(166));return Zs(g),null}if(p=pe.current,$b(g))cF(g);else{switch(j=cS(Ie.current),p){case 1:p=j.createElementNS("http://www.w3.org/2000/svg",_);break;case 2:p=j.createElementNS("http://www.w3.org/1998/Math/MathML",_);break;default:switch(_){case"svg":p=j.createElementNS("http://www.w3.org/2000/svg",_);break;case"math":p=j.createElementNS("http://www.w3.org/1998/Math/MathML",_);break;case"script":p=j.createElement("div"),p.innerHTML="<script><\/script>",p=p.removeChild(p.firstChild);break;case"select":p=typeof E.is=="string"?j.createElement("select",{is:E.is}):j.createElement("select"),E.multiple?p.multiple=!0:E.size&&(p.size=E.size);break;default:p=typeof E.is=="string"?j.createElement(_,{is:E.is}):j.createElement(_)}}p[ve]=g,p[Oe]=E;e:for(j=g.child;j!==null;){if(j.tag===5||j.tag===6)p.appendChild(j.stateNode);else if(j.tag!==4&&j.tag!==27&&j.child!==null){j.child.return=j,j=j.child;continue}if(j===g)break e;for(;j.sibling===null;){if(j.return===null||j.return===g)break e;j=j.return}j.sibling.return=j.return,j=j.sibling}g.stateNode=p;e:switch(pa(p,_,E),_){case"button":case"input":case"select":case"textarea":p=!!E.autoFocus;break e;case"img":p=!0;break e;default:p=!1}p&&cd(g)}}return Zs(g),g.flags&=-16777217,null;case 6:if(p&&g.stateNode!=null)p.memoizedProps!==E&&cd(g);else{if(typeof E!="string"&&g.stateNode===null)throw Error(r(166));if(p=Ie.current,$b(g)){if(p=g.stateNode,_=g.memoizedProps,E=null,j=Ga,j!==null)switch(j.tag){case 27:case 5:E=j.memoizedProps}p[ve]=g,p=!!(p.nodeValue===_||E!==null&&E.suppressHydrationWarning===!0||EL(p.nodeValue,_)),p||Cp(g)}else p=cS(p).createTextNode(E),p[ve]=g,g.stateNode=p}return Zs(g),null;case 13:if(E=g.memoizedState,p===null||p.memoizedState!==null&&p.memoizedState.dehydrated!==null){if(j=$b(g),E!==null&&E.dehydrated!==null){if(p===null){if(!j)throw Error(r(318));if(j=g.memoizedState,j=j!==null?j.dehydrated:null,!j)throw Error(r(317));j[ve]=g}else zb(),(g.flags&128)===0&&(g.memoizedState=null),g.flags|=4;Zs(g),j=!1}else j=dF(),p!==null&&p.memoizedState!==null&&(p.memoizedState.hydrationErrors=j),j=!0;if(!j)return g.flags&256?(od(g),g):(od(g),null)}if(od(g),(g.flags&128)!==0)return g.lanes=_,g;if(_=E!==null,p=p!==null&&p.memoizedState!==null,_){E=g.child,j=null,E.alternate!==null&&E.alternate.memoizedState!==null&&E.alternate.memoizedState.cachePool!==null&&(j=E.alternate.memoizedState.cachePool.pool);var q=null;E.memoizedState!==null&&E.memoizedState.cachePool!==null&&(q=E.memoizedState.cachePool.pool),q!==j&&(E.flags|=2048)}return _!==p&&_&&(g.child.flags|=8192),Z_(g,g.updateQueue),Zs(g),null;case 4:return Ce(),p===null&&BR(g.stateNode.containerInfo),Zs(g),null;case 10:return id(g.type),Zs(g),null;case 19:if(ee(Pi),j=g.memoizedState,j===null)return Zs(g),null;if(E=(g.flags&128)!==0,q=j.rendering,q===null)if(E)rv(j,!1);else{if(ii!==0||p!==null&&(p.flags&128)!==0)for(p=g.child;p!==null;){if(q=W_(p),q!==null){for(g.flags|=128,rv(j,!1),p=q.updateQueue,g.updateQueue=p,Z_(g,p),g.subtreeFlags=0,p=_,_=g.child;_!==null;)oF(_,p),_=_.sibling;return se(Pi,Pi.current&1|2),g.child}p=p.sibling}j.tail!==null&&le()>Q_&&(g.flags|=128,E=!0,rv(j,!1),g.lanes=4194304)}else{if(!E)if(p=W_(q),p!==null){if(g.flags|=128,E=!0,p=p.updateQueue,g.updateQueue=p,Z_(g,p),rv(j,!0),j.tail===null&&j.tailMode==="hidden"&&!q.alternate&&!ss)return Zs(g),null}else 2*le()-j.renderingStartTime>Q_&&_!==536870912&&(g.flags|=128,E=!0,rv(j,!1),g.lanes=4194304);j.isBackwards?(q.sibling=g.child,g.child=q):(p=j.last,p!==null?p.sibling=q:g.child=q,j.last=q)}return j.tail!==null?(g=j.tail,j.rendering=g,j.tail=g.sibling,j.renderingStartTime=le(),g.sibling=null,p=Pi.current,se(Pi,E?p&1|2:p&1),g):(Zs(g),null);case 22:case 23:return od(g),zA(),E=g.memoizedState!==null,p!==null?p.memoizedState!==null!==E&&(g.flags|=8192):E&&(g.flags|=8192),E?(_&536870912)!==0&&(g.flags&128)===0&&(Zs(g),g.subtreeFlags&6&&(g.flags|=8192)):Zs(g),_=g.updateQueue,_!==null&&Z_(g,_.retryQueue),_=null,p!==null&&p.memoizedState!==null&&p.memoizedState.cachePool!==null&&(_=p.memoizedState.cachePool.pool),E=null,g.memoizedState!==null&&g.memoizedState.cachePool!==null&&(E=g.memoizedState.cachePool.pool),E!==_&&(g.flags|=2048),p!==null&&ee(Tp),null;case 24:return _=null,p!==null&&(_=p.memoizedState.cache),g.memoizedState.cache!==_&&(g.flags|=2048),id(ji),Zs(g),null;case 25:return null;case 30:return null}throw Error(r(156,g.tag))}function Xde(p,g){switch(TA(g),g.tag){case 1:return p=g.flags,p&65536?(g.flags=p&-65537|128,g):null;case 3:return id(ji),Ce(),p=g.flags,(p&65536)!==0&&(p&128)===0?(g.flags=p&-65537|128,g):null;case 26:case 27:case 5:return Qe(g),null;case 13:if(od(g),p=g.memoizedState,p!==null&&p.dehydrated!==null){if(g.alternate===null)throw Error(r(340));zb()}return p=g.flags,p&65536?(g.flags=p&-65537|128,g):null;case 19:return ee(Pi),null;case 4:return Ce(),null;case 10:return id(g.type),null;case 22:case 23:return od(g),zA(),p!==null&&ee(Tp),p=g.flags,p&65536?(g.flags=p&-65537|128,g):null;case 24:return id(ji),null;case 25:return null;default:return null}}function P8(p,g){switch(TA(g),g.tag){case 3:id(ji),Ce();break;case 26:case 27:case 5:Qe(g);break;case 4:Ce();break;case 13:od(g);break;case 19:ee(Pi);break;case 10:id(g.type);break;case 22:case 23:od(g),zA(),p!==null&&ee(Tp);break;case 24:id(ji)}}function sv(p,g){try{var _=g.updateQueue,E=_!==null?_.lastEffect:null;if(E!==null){var j=E.next;_=j;do{if((_.tag&p)===p){E=void 0;var q=_.create,ue=_.inst;E=q(),ue.destroy=E}_=_.next}while(_!==j)}}catch(Re){Ns(g,g.return,Re)}}function jf(p,g,_){try{var E=g.updateQueue,j=E!==null?E.lastEffect:null;if(j!==null){var q=j.next;E=q;do{if((E.tag&p)===p){var ue=E.inst,Re=ue.destroy;if(Re!==void 0){ue.destroy=void 0,j=g;var Ye=_,wt=Re;try{wt()}catch(Dt){Ns(j,Ye,Dt)}}}E=E.next}while(E!==q)}}catch(Dt){Ns(g,g.return,Dt)}}function O8(p){var g=p.updateQueue;if(g!==null){var _=p.stateNode;try{_F(g,_)}catch(E){Ns(p,p.return,E)}}}function D8(p,g,_){_.props=Rp(p.type,p.memoizedProps),_.state=p.memoizedState;try{_.componentWillUnmount()}catch(E){Ns(p,g,E)}}function iv(p,g){try{var _=p.ref;if(_!==null){switch(p.tag){case 26:case 27:case 5:var E=p.stateNode;break;case 30:E=p.stateNode;break;default:E=p.stateNode}typeof _=="function"?p.refCleanup=_(E):_.current=E}}catch(j){Ns(p,g,j)}}function Zc(p,g){var _=p.ref,E=p.refCleanup;if(_!==null)if(typeof E=="function")try{E()}catch(j){Ns(p,g,j)}finally{p.refCleanup=null,p=p.alternate,p!=null&&(p.refCleanup=null)}else if(typeof _=="function")try{_(null)}catch(j){Ns(p,g,j)}else _.current=null}function F8(p){var g=p.type,_=p.memoizedProps,E=p.stateNode;try{e:switch(g){case"button":case"input":case"select":case"textarea":_.autoFocus&&E.focus();break e;case"img":_.src?E.src=_.src:_.srcSet&&(E.srcset=_.srcSet)}}catch(j){Ns(p,p.return,j)}}function mR(p,g,_){try{var E=p.stateNode;bfe(E,p.type,_,g),E[Oe]=g}catch(j){Ns(p,p.return,j)}}function L8(p){return p.tag===5||p.tag===3||p.tag===26||p.tag===27&&zf(p.type)||p.tag===4}function gR(p){e:for(;;){for(;p.sibling===null;){if(p.return===null||L8(p.return))return null;p=p.return}for(p.sibling.return=p.return,p=p.sibling;p.tag!==5&&p.tag!==6&&p.tag!==18;){if(p.tag===27&&zf(p.type)||p.flags&2||p.child===null||p.tag===4)continue e;p.child.return=p,p=p.child}if(!(p.flags&2))return p.stateNode}}function yR(p,g,_){var E=p.tag;if(E===5||E===6)p=p.stateNode,g?(_.nodeType===9?_.body:_.nodeName==="HTML"?_.ownerDocument.body:_).insertBefore(p,g):(g=_.nodeType===9?_.body:_.nodeName==="HTML"?_.ownerDocument.body:_,g.appendChild(p),_=_._reactRootContainer,_!=null||g.onclick!==null||(g.onclick=lS));else if(E!==4&&(E===27&&zf(p.type)&&(_=p.stateNode,g=null),p=p.child,p!==null))for(yR(p,g,_),p=p.sibling;p!==null;)yR(p,g,_),p=p.sibling}function X_(p,g,_){var E=p.tag;if(E===5||E===6)p=p.stateNode,g?_.insertBefore(p,g):_.appendChild(p);else if(E!==4&&(E===27&&zf(p.type)&&(_=p.stateNode),p=p.child,p!==null))for(X_(p,g,_),p=p.sibling;p!==null;)X_(p,g,_),p=p.sibling}function B8(p){var g=p.stateNode,_=p.memoizedProps;try{for(var E=p.type,j=g.attributes;j.length;)g.removeAttributeNode(j[0]);pa(g,E,_),g[ve]=p,g[Oe]=_}catch(q){Ns(p,p.return,q)}}var ud=!1,fi=!1,bR=!1,$8=typeof WeakSet=="function"?WeakSet:Set,Xi=null;function Jde(p,g){if(p=p.containerInfo,UR=mS,p=he(p),Ee(p)){if("selectionStart"in p)var _={start:p.selectionStart,end:p.selectionEnd};else e:{_=(_=p.ownerDocument)&&_.defaultView||window;var E=_.getSelection&&_.getSelection();if(E&&E.rangeCount!==0){_=E.anchorNode;var j=E.anchorOffset,q=E.focusNode;E=E.focusOffset;try{_.nodeType,q.nodeType}catch{_=null;break e}var ue=0,Re=-1,Ye=-1,wt=0,Dt=0,Bt=p,Ct=null;t:for(;;){for(var At;Bt!==_||j!==0&&Bt.nodeType!==3||(Re=ue+j),Bt!==q||E!==0&&Bt.nodeType!==3||(Ye=ue+E),Bt.nodeType===3&&(ue+=Bt.nodeValue.length),(At=Bt.firstChild)!==null;)Ct=Bt,Bt=At;for(;;){if(Bt===p)break t;if(Ct===_&&++wt===j&&(Re=ue),Ct===q&&++Dt===E&&(Ye=ue),(At=Bt.nextSibling)!==null)break;Bt=Ct,Ct=Bt.parentNode}Bt=At}_=Re===-1||Ye===-1?null:{start:Re,end:Ye}}else _=null}_=_||{start:0,end:0}}else _=null;for(qR={focusedElem:p,selectionRange:_},mS=!1,Xi=g;Xi!==null;)if(g=Xi,p=g.child,(g.subtreeFlags&1024)!==0&&p!==null)p.return=g,Xi=p;else for(;Xi!==null;){switch(g=Xi,q=g.alternate,p=g.flags,g.tag){case 0:break;case 11:case 15:break;case 1:if((p&1024)!==0&&q!==null){p=void 0,_=g,j=q.memoizedProps,q=q.memoizedState,E=_.stateNode;try{var sr=Rp(_.type,j,_.elementType===_.type);p=E.getSnapshotBeforeUpdate(sr,q),E.__reactInternalSnapshotBeforeUpdate=p}catch(Wn){Ns(_,_.return,Wn)}}break;case 3:if((p&1024)!==0){if(p=g.stateNode.containerInfo,_=p.nodeType,_===9)HR(p);else if(_===1)switch(p.nodeName){case"HEAD":case"HTML":case"BODY":HR(p);break;default:p.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((p&1024)!==0)throw Error(r(163))}if(p=g.sibling,p!==null){p.return=g.return,Xi=p;break}Xi=g.return}}function z8(p,g,_){var E=_.flags;switch(_.tag){case 0:case 11:case 15:Pf(p,_),E&4&&sv(5,_);break;case 1:if(Pf(p,_),E&4)if(p=_.stateNode,g===null)try{p.componentDidMount()}catch(ue){Ns(_,_.return,ue)}else{var j=Rp(_.type,g.memoizedProps);g=g.memoizedState;try{p.componentDidUpdate(j,g,p.__reactInternalSnapshotBeforeUpdate)}catch(ue){Ns(_,_.return,ue)}}E&64&&O8(_),E&512&&iv(_,_.return);break;case 3:if(Pf(p,_),E&64&&(p=_.updateQueue,p!==null)){if(g=null,_.child!==null)switch(_.child.tag){case 27:case 5:g=_.child.stateNode;break;case 1:g=_.child.stateNode}try{_F(p,g)}catch(ue){Ns(_,_.return,ue)}}break;case 27:g===null&&E&4&&B8(_);case 26:case 5:Pf(p,_),g===null&&E&4&&F8(_),E&512&&iv(_,_.return);break;case 12:Pf(p,_);break;case 13:Pf(p,_),E&4&&V8(p,_),E&64&&(p=_.memoizedState,p!==null&&(p=p.dehydrated,p!==null&&(_=ofe.bind(null,_),kfe(p,_))));break;case 22:if(E=_.memoizedState!==null||ud,!E){g=g!==null&&g.memoizedState!==null||fi,j=ud;var q=fi;ud=E,(fi=g)&&!q?Of(p,_,(_.subtreeFlags&8772)!==0):Pf(p,_),ud=j,fi=q}break;case 30:break;default:Pf(p,_)}}function U8(p){var g=p.alternate;g!==null&&(p.alternate=null,U8(g)),p.child=null,p.deletions=null,p.sibling=null,p.tag===5&&(g=p.stateNode,g!==null&&un(g)),p.stateNode=null,p.return=null,p.dependencies=null,p.memoizedProps=null,p.memoizedState=null,p.pendingProps=null,p.stateNode=null,p.updateQueue=null}var Hs=null,mo=!1;function dd(p,g,_){for(_=_.child;_!==null;)q8(p,g,_),_=_.sibling}function q8(p,g,_){if(qt&&typeof qt.onCommitFiberUnmount=="function")try{qt.onCommitFiberUnmount(Pt,_)}catch{}switch(_.tag){case 26:fi||Zc(_,g),dd(p,g,_),_.memoizedState?_.memoizedState.count--:_.stateNode&&(_=_.stateNode,_.parentNode.removeChild(_));break;case 27:fi||Zc(_,g);var E=Hs,j=mo;zf(_.type)&&(Hs=_.stateNode,mo=!1),dd(p,g,_),pv(_.stateNode),Hs=E,mo=j;break;case 5:fi||Zc(_,g);case 6:if(E=Hs,j=mo,Hs=null,dd(p,g,_),Hs=E,mo=j,Hs!==null)if(mo)try{(Hs.nodeType===9?Hs.body:Hs.nodeName==="HTML"?Hs.ownerDocument.body:Hs).removeChild(_.stateNode)}catch(q){Ns(_,g,q)}else try{Hs.removeChild(_.stateNode)}catch(q){Ns(_,g,q)}break;case 18:Hs!==null&&(mo?(p=Hs,ML(p.nodeType===9?p.body:p.nodeName==="HTML"?p.ownerDocument.body:p,_.stateNode),_v(p)):ML(Hs,_.stateNode));break;case 4:E=Hs,j=mo,Hs=_.stateNode.containerInfo,mo=!0,dd(p,g,_),Hs=E,mo=j;break;case 0:case 11:case 14:case 15:fi||jf(2,_,g),fi||jf(4,_,g),dd(p,g,_);break;case 1:fi||(Zc(_,g),E=_.stateNode,typeof E.componentWillUnmount=="function"&&D8(_,g,E)),dd(p,g,_);break;case 21:dd(p,g,_);break;case 22:fi=(E=fi)||_.memoizedState!==null,dd(p,g,_),fi=E;break;default:dd(p,g,_)}}function V8(p,g){if(g.memoizedState===null&&(p=g.alternate,p!==null&&(p=p.memoizedState,p!==null&&(p=p.dehydrated,p!==null))))try{_v(p)}catch(_){Ns(g,g.return,_)}}function Qde(p){switch(p.tag){case 13:case 19:var g=p.stateNode;return g===null&&(g=p.stateNode=new $8),g;case 22:return p=p.stateNode,g=p._retryCache,g===null&&(g=p._retryCache=new $8),g;default:throw Error(r(435,p.tag))}}function vR(p,g){var _=Qde(p);g.forEach(function(E){var j=lfe.bind(null,p,E);_.has(E)||(_.add(E),E.then(j,j))})}function Go(p,g){var _=g.deletions;if(_!==null)for(var E=0;E<_.length;E++){var j=_[E],q=p,ue=g,Re=ue;e:for(;Re!==null;){switch(Re.tag){case 27:if(zf(Re.type)){Hs=Re.stateNode,mo=!1;break e}break;case 5:Hs=Re.stateNode,mo=!1;break e;case 3:case 4:Hs=Re.stateNode.containerInfo,mo=!0;break e}Re=Re.return}if(Hs===null)throw Error(r(160));q8(q,ue,j),Hs=null,mo=!1,q=j.alternate,q!==null&&(q.return=null),j.return=null}if(g.subtreeFlags&13878)for(g=g.child;g!==null;)W8(g,p),g=g.sibling}var oc=null;function W8(p,g){var _=p.alternate,E=p.flags;switch(p.tag){case 0:case 11:case 14:case 15:Go(g,p),Ko(p),E&4&&(jf(3,p,p.return),sv(3,p),jf(5,p,p.return));break;case 1:Go(g,p),Ko(p),E&512&&(fi||_===null||Zc(_,_.return)),E&64&&ud&&(p=p.updateQueue,p!==null&&(E=p.callbacks,E!==null&&(_=p.shared.hiddenCallbacks,p.shared.hiddenCallbacks=_===null?E:_.concat(E))));break;case 26:var j=oc;if(Go(g,p),Ko(p),E&512&&(fi||_===null||Zc(_,_.return)),E&4){var q=_!==null?_.memoizedState:null;if(E=p.memoizedState,_===null)if(E===null)if(p.stateNode===null){e:{E=p.type,_=p.memoizedProps,j=j.ownerDocument||j;t:switch(E){case"title":q=j.getElementsByTagName("title")[0],(!q||q[nn]||q[ve]||q.namespaceURI==="http://www.w3.org/2000/svg"||q.hasAttribute("itemprop"))&&(q=j.createElement(E),j.head.insertBefore(q,j.querySelector("head > title"))),pa(q,E,_),q[ve]=p,Cr(q),E=q;break e;case"link":var ue=BL("link","href",j).get(E+(_.href||""));if(ue){for(var Re=0;Re<ue.length;Re++)if(q=ue[Re],q.getAttribute("href")===(_.href==null||_.href===""?null:_.href)&&q.getAttribute("rel")===(_.rel==null?null:_.rel)&&q.getAttribute("title")===(_.title==null?null:_.title)&&q.getAttribute("crossorigin")===(_.crossOrigin==null?null:_.crossOrigin)){ue.splice(Re,1);break t}}q=j.createElement(E),pa(q,E,_),j.head.appendChild(q);break;case"meta":if(ue=BL("meta","content",j).get(E+(_.content||""))){for(Re=0;Re<ue.length;Re++)if(q=ue[Re],q.getAttribute("content")===(_.content==null?null:""+_.content)&&q.getAttribute("name")===(_.name==null?null:_.name)&&q.getAttribute("property")===(_.property==null?null:_.property)&&q.getAttribute("http-equiv")===(_.httpEquiv==null?null:_.httpEquiv)&&q.getAttribute("charset")===(_.charSet==null?null:_.charSet)){ue.splice(Re,1);break t}}q=j.createElement(E),pa(q,E,_),j.head.appendChild(q);break;default:throw Error(r(468,E))}q[ve]=p,Cr(q),E=q}p.stateNode=E}else $L(j,p.type,p.stateNode);else p.stateNode=LL(j,E,p.memoizedProps);else q!==E?(q===null?_.stateNode!==null&&(_=_.stateNode,_.parentNode.removeChild(_)):q.count--,E===null?$L(j,p.type,p.stateNode):LL(j,E,p.memoizedProps)):E===null&&p.stateNode!==null&&mR(p,p.memoizedProps,_.memoizedProps)}break;case 27:Go(g,p),Ko(p),E&512&&(fi||_===null||Zc(_,_.return)),_!==null&&E&4&&mR(p,p.memoizedProps,_.memoizedProps);break;case 5:if(Go(g,p),Ko(p),E&512&&(fi||_===null||Zc(_,_.return)),p.flags&32){j=p.stateNode;try{gf(j,"")}catch(At){Ns(p,p.return,At)}}E&4&&p.stateNode!=null&&(j=p.memoizedProps,mR(p,j,_!==null?_.memoizedProps:j)),E&1024&&(bR=!0);break;case 6:if(Go(g,p),Ko(p),E&4){if(p.stateNode===null)throw Error(r(162));E=p.memoizedProps,_=p.stateNode;try{_.nodeValue=E}catch(At){Ns(p,p.return,At)}}break;case 3:if(fS=null,j=oc,oc=uS(g.containerInfo),Go(g,p),oc=j,Ko(p),E&4&&_!==null&&_.memoizedState.isDehydrated)try{_v(g.containerInfo)}catch(At){Ns(p,p.return,At)}bR&&(bR=!1,H8(p));break;case 4:E=oc,oc=uS(p.stateNode.containerInfo),Go(g,p),Ko(p),oc=E;break;case 12:Go(g,p),Ko(p);break;case 13:Go(g,p),Ko(p),p.child.flags&8192&&p.memoizedState!==null!=(_!==null&&_.memoizedState!==null)&&(kR=le()),E&4&&(E=p.updateQueue,E!==null&&(p.updateQueue=null,vR(p,E)));break;case 22:j=p.memoizedState!==null;var Ye=_!==null&&_.memoizedState!==null,wt=ud,Dt=fi;if(ud=wt||j,fi=Dt||Ye,Go(g,p),fi=Dt,ud=wt,Ko(p),E&8192)e:for(g=p.stateNode,g._visibility=j?g._visibility&-2:g._visibility|1,j&&(_===null||Ye||ud||fi||Np(p)),_=null,g=p;;){if(g.tag===5||g.tag===26){if(_===null){Ye=_=g;try{if(q=Ye.stateNode,j)ue=q.style,typeof ue.setProperty=="function"?ue.setProperty("display","none","important"):ue.display="none";else{Re=Ye.stateNode;var Bt=Ye.memoizedProps.style,Ct=Bt!=null&&Bt.hasOwnProperty("display")?Bt.display:null;Re.style.display=Ct==null||typeof Ct=="boolean"?"":(""+Ct).trim()}}catch(At){Ns(Ye,Ye.return,At)}}}else if(g.tag===6){if(_===null){Ye=g;try{Ye.stateNode.nodeValue=j?"":Ye.memoizedProps}catch(At){Ns(Ye,Ye.return,At)}}}else if((g.tag!==22&&g.tag!==23||g.memoizedState===null||g===p)&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===p)break e;for(;g.sibling===null;){if(g.return===null||g.return===p)break e;_===g&&(_=null),g=g.return}_===g&&(_=null),g.sibling.return=g.return,g=g.sibling}E&4&&(E=p.updateQueue,E!==null&&(_=E.retryQueue,_!==null&&(E.retryQueue=null,vR(p,_))));break;case 19:Go(g,p),Ko(p),E&4&&(E=p.updateQueue,E!==null&&(p.updateQueue=null,vR(p,E)));break;case 30:break;case 21:break;default:Go(g,p),Ko(p)}}function Ko(p){var g=p.flags;if(g&2){try{for(var _,E=p.return;E!==null;){if(L8(E)){_=E;break}E=E.return}if(_==null)throw Error(r(160));switch(_.tag){case 27:var j=_.stateNode,q=gR(p);X_(p,q,j);break;case 5:var ue=_.stateNode;_.flags&32&&(gf(ue,""),_.flags&=-33);var Re=gR(p);X_(p,Re,ue);break;case 3:case 4:var Ye=_.stateNode.containerInfo,wt=gR(p);yR(p,wt,Ye);break;default:throw Error(r(161))}}catch(Dt){Ns(p,p.return,Dt)}p.flags&=-3}g&4096&&(p.flags&=-4097)}function H8(p){if(p.subtreeFlags&1024)for(p=p.child;p!==null;){var g=p;H8(g),g.tag===5&&g.flags&1024&&g.stateNode.reset(),p=p.sibling}}function Pf(p,g){if(g.subtreeFlags&8772)for(g=g.child;g!==null;)z8(p,g.alternate,g),g=g.sibling}function Np(p){for(p=p.child;p!==null;){var g=p;switch(g.tag){case 0:case 11:case 14:case 15:jf(4,g,g.return),Np(g);break;case 1:Zc(g,g.return);var _=g.stateNode;typeof _.componentWillUnmount=="function"&&D8(g,g.return,_),Np(g);break;case 27:pv(g.stateNode);case 26:case 5:Zc(g,g.return),Np(g);break;case 22:g.memoizedState===null&&Np(g);break;case 30:Np(g);break;default:Np(g)}p=p.sibling}}function Of(p,g,_){for(_=_&&(g.subtreeFlags&8772)!==0,g=g.child;g!==null;){var E=g.alternate,j=p,q=g,ue=q.flags;switch(q.tag){case 0:case 11:case 15:Of(j,q,_),sv(4,q);break;case 1:if(Of(j,q,_),E=q,j=E.stateNode,typeof j.componentDidMount=="function")try{j.componentDidMount()}catch(wt){Ns(E,E.return,wt)}if(E=q,j=E.updateQueue,j!==null){var Re=E.stateNode;try{var Ye=j.shared.hiddenCallbacks;if(Ye!==null)for(j.shared.hiddenCallbacks=null,j=0;j<Ye.length;j++)wF(Ye[j],Re)}catch(wt){Ns(E,E.return,wt)}}_&&ue&64&&O8(q),iv(q,q.return);break;case 27:B8(q);case 26:case 5:Of(j,q,_),_&&E===null&&ue&4&&F8(q),iv(q,q.return);break;case 12:Of(j,q,_);break;case 13:Of(j,q,_),_&&ue&4&&V8(j,q);break;case 22:q.memoizedState===null&&Of(j,q,_),iv(q,q.return);break;case 30:break;default:Of(j,q,_)}g=g.sibling}}function xR(p,g){var _=null;p!==null&&p.memoizedState!==null&&p.memoizedState.cachePool!==null&&(_=p.memoizedState.cachePool.pool),p=null,g.memoizedState!==null&&g.memoizedState.cachePool!==null&&(p=g.memoizedState.cachePool.pool),p!==_&&(p!=null&&p.refCount++,_!=null&&Vb(_))}function wR(p,g){p=null,g.alternate!==null&&(p=g.alternate.memoizedState.cache),g=g.memoizedState.cache,g!==p&&(g.refCount++,p!=null&&Vb(p))}function Xc(p,g,_,E){if(g.subtreeFlags&10256)for(g=g.child;g!==null;)G8(p,g,_,E),g=g.sibling}function G8(p,g,_,E){var j=g.flags;switch(g.tag){case 0:case 11:case 15:Xc(p,g,_,E),j&2048&&sv(9,g);break;case 1:Xc(p,g,_,E);break;case 3:Xc(p,g,_,E),j&2048&&(p=null,g.alternate!==null&&(p=g.alternate.memoizedState.cache),g=g.memoizedState.cache,g!==p&&(g.refCount++,p!=null&&Vb(p)));break;case 12:if(j&2048){Xc(p,g,_,E),p=g.stateNode;try{var q=g.memoizedProps,ue=q.id,Re=q.onPostCommit;typeof Re=="function"&&Re(ue,g.alternate===null?"mount":"update",p.passiveEffectDuration,-0)}catch(Ye){Ns(g,g.return,Ye)}}else Xc(p,g,_,E);break;case 13:Xc(p,g,_,E);break;case 23:break;case 22:q=g.stateNode,ue=g.alternate,g.memoizedState!==null?q._visibility&2?Xc(p,g,_,E):av(p,g):q._visibility&2?Xc(p,g,_,E):(q._visibility|=2,Og(p,g,_,E,(g.subtreeFlags&10256)!==0)),j&2048&&xR(ue,g);break;case 24:Xc(p,g,_,E),j&2048&&wR(g.alternate,g);break;default:Xc(p,g,_,E)}}function Og(p,g,_,E,j){for(j=j&&(g.subtreeFlags&10256)!==0,g=g.child;g!==null;){var q=p,ue=g,Re=_,Ye=E,wt=ue.flags;switch(ue.tag){case 0:case 11:case 15:Og(q,ue,Re,Ye,j),sv(8,ue);break;case 23:break;case 22:var Dt=ue.stateNode;ue.memoizedState!==null?Dt._visibility&2?Og(q,ue,Re,Ye,j):av(q,ue):(Dt._visibility|=2,Og(q,ue,Re,Ye,j)),j&&wt&2048&&xR(ue.alternate,ue);break;case 24:Og(q,ue,Re,Ye,j),j&&wt&2048&&wR(ue.alternate,ue);break;default:Og(q,ue,Re,Ye,j)}g=g.sibling}}function av(p,g){if(g.subtreeFlags&10256)for(g=g.child;g!==null;){var _=p,E=g,j=E.flags;switch(E.tag){case 22:av(_,E),j&2048&&xR(E.alternate,E);break;case 24:av(_,E),j&2048&&wR(E.alternate,E);break;default:av(_,E)}g=g.sibling}}var ov=8192;function Dg(p){if(p.subtreeFlags&ov)for(p=p.child;p!==null;)K8(p),p=p.sibling}function K8(p){switch(p.tag){case 26:Dg(p),p.flags&ov&&p.memoizedState!==null&&Lfe(oc,p.memoizedState,p.memoizedProps);break;case 5:Dg(p);break;case 3:case 4:var g=oc;oc=uS(p.stateNode.containerInfo),Dg(p),oc=g;break;case 22:p.memoizedState===null&&(g=p.alternate,g!==null&&g.memoizedState!==null?(g=ov,ov=16777216,Dg(p),ov=g):Dg(p));break;default:Dg(p)}}function Y8(p){var g=p.alternate;if(g!==null&&(p=g.child,p!==null)){g.child=null;do g=p.sibling,p.sibling=null,p=g;while(p!==null)}}function lv(p){var g=p.deletions;if((p.flags&16)!==0){if(g!==null)for(var _=0;_<g.length;_++){var E=g[_];Xi=E,X8(E,p)}Y8(p)}if(p.subtreeFlags&10256)for(p=p.child;p!==null;)Z8(p),p=p.sibling}function Z8(p){switch(p.tag){case 0:case 11:case 15:lv(p),p.flags&2048&&jf(9,p,p.return);break;case 3:lv(p);break;case 12:lv(p);break;case 22:var g=p.stateNode;p.memoizedState!==null&&g._visibility&2&&(p.return===null||p.return.tag!==13)?(g._visibility&=-3,J_(p)):lv(p);break;default:lv(p)}}function J_(p){var g=p.deletions;if((p.flags&16)!==0){if(g!==null)for(var _=0;_<g.length;_++){var E=g[_];Xi=E,X8(E,p)}Y8(p)}for(p=p.child;p!==null;){switch(g=p,g.tag){case 0:case 11:case 15:jf(8,g,g.return),J_(g);break;case 22:_=g.stateNode,_._visibility&2&&(_._visibility&=-3,J_(g));break;default:J_(g)}p=p.sibling}}function X8(p,g){for(;Xi!==null;){var _=Xi;switch(_.tag){case 0:case 11:case 15:jf(8,_,g);break;case 23:case 22:if(_.memoizedState!==null&&_.memoizedState.cachePool!==null){var E=_.memoizedState.cachePool.pool;E!=null&&E.refCount++}break;case 24:Vb(_.memoizedState.cache)}if(E=_.child,E!==null)E.return=_,Xi=E;else e:for(_=p;Xi!==null;){E=Xi;var j=E.sibling,q=E.return;if(U8(E),E===_){Xi=null;break e}if(j!==null){j.return=q,Xi=j;break e}Xi=q}}}var efe={getCacheForType:function(p){var g=Ea(ji),_=g.data.get(p);return _===void 0&&(_=p(),g.data.set(p,_)),_}},tfe=typeof WeakMap=="function"?WeakMap:Map,gs=0,Ps=null,Fr=null,Gr=0,ys=0,Yo=null,Df=!1,Fg=!1,_R=!1,fd=0,ii=0,Ff=0,Mp=0,SR=0,Nl=0,Lg=0,cv=null,go=null,CR=!1,kR=0,Q_=1/0,eS=null,Lf=null,ha=0,Bf=null,Bg=null,$g=0,ER=0,TR=null,J8=null,uv=0,AR=null;function Zo(){if((gs&2)!==0&&Gr!==0)return Gr&-Gr;if(U.T!==null){var p=Tg;return p!==0?p:OR()}return Y()}function Q8(){Nl===0&&(Nl=(Gr&536870912)===0||ss?ot():536870912);var p=Rl.current;return p!==null&&(p.flags|=32),Nl}function Xo(p,g,_){(p===Ps&&(ys===2||ys===9)||p.cancelPendingCommit!==null)&&(zg(p,0),$f(p,Gr,Nl,!1)),st(p,_),((gs&2)===0||p!==Ps)&&(p===Ps&&((gs&2)===0&&(Mp|=_),ii===4&&$f(p,Gr,Nl,!1)),Jc(p))}function eL(p,g,_){if((gs&6)!==0)throw Error(r(327));var E=!_&&(g&124)===0&&(g&p.expiredLanes)===0||de(p,g),j=E?sfe(p,g):MR(p,g,!0),q=E;do{if(j===0){Fg&&!E&&$f(p,g,0,!1);break}else{if(_=p.current.alternate,q&&!nfe(_)){j=MR(p,g,!1),q=!1;continue}if(j===2){if(q=g,p.errorRecoveryDisabledLanes&q)var ue=0;else ue=p.pendingLanes&-536870913,ue=ue!==0?ue:ue&536870912?536870912:0;if(ue!==0){g=ue;e:{var Re=p;j=cv;var Ye=Re.current.memoizedState.isDehydrated;if(Ye&&(zg(Re,ue).flags|=256),ue=MR(Re,ue,!1),ue!==2){if(_R&&!Ye){Re.errorRecoveryDisabledLanes|=q,Mp|=q,j=4;break e}q=go,go=j,q!==null&&(go===null?go=q:go.push.apply(go,q))}j=ue}if(q=!1,j!==2)continue}}if(j===1){zg(p,0),$f(p,g,0,!0);break}e:{switch(E=p,q=j,q){case 0:case 1:throw Error(r(345));case 4:if((g&4194048)!==g)break;case 6:$f(E,g,Nl,!Df);break e;case 2:go=null;break;case 3:case 5:break;default:throw Error(r(329))}if((g&62914560)===g&&(j=kR+300-le(),10<j)){if($f(E,g,Nl,!Df),Me(E,0,!0)!==0)break e;E.timeoutHandle=RL(tL.bind(null,E,_,go,eS,CR,g,Nl,Mp,Lg,Df,q,2,-0,0),j);break e}tL(E,_,go,eS,CR,g,Nl,Mp,Lg,Df,q,0,-0,0)}}break}while(!0);Jc(p)}function tL(p,g,_,E,j,q,ue,Re,Ye,wt,Dt,Bt,Ct,At){if(p.timeoutHandle=-1,Bt=g.subtreeFlags,(Bt&8192||(Bt&16785408)===16785408)&&(yv={stylesheets:null,count:0,unsuspend:Ffe},K8(g),Bt=Bfe(),Bt!==null)){p.cancelPendingCommit=Bt(lL.bind(null,p,g,q,_,E,j,ue,Re,Ye,Dt,1,Ct,At)),$f(p,q,ue,!wt);return}lL(p,g,q,_,E,j,ue,Re,Ye)}function nfe(p){for(var g=p;;){var _=g.tag;if((_===0||_===11||_===15)&&g.flags&16384&&(_=g.updateQueue,_!==null&&(_=_.stores,_!==null)))for(var E=0;E<_.length;E++){var j=_[E],q=j.getSnapshot;j=j.value;try{if(!ka(q(),j))return!1}catch{return!1}}if(_=g.child,g.subtreeFlags&16384&&_!==null)_.return=g,g=_;else{if(g===p)break;for(;g.sibling===null;){if(g.return===null||g.return===p)return!0;g=g.return}g.sibling.return=g.return,g=g.sibling}}return!0}function $f(p,g,_,E){g&=~SR,g&=~Mp,p.suspendedLanes|=g,p.pingedLanes&=~g,E&&(p.warmLanes|=g),E=p.expirationTimes;for(var j=g;0<j;){var q=31-en(j),ue=1<<q;E[q]=-1,j&=~ue}_!==0&&_e(p,_,g)}function tS(){return(gs&6)===0?(dv(0),!1):!0}function RR(){if(Fr!==null){if(ys===0)var p=Fr.return;else p=Fr,sd=kp=null,HA(p),jg=null,tv=0,p=Fr;for(;p!==null;)P8(p.alternate,p),p=p.return;Fr=null}}function zg(p,g){var _=p.timeoutHandle;_!==-1&&(p.timeoutHandle=-1,xfe(_)),_=p.cancelPendingCommit,_!==null&&(p.cancelPendingCommit=null,_()),RR(),Ps=p,Fr=_=td(p.current,null),Gr=g,ys=0,Yo=null,Df=!1,Fg=de(p,g),_R=!1,Lg=Nl=SR=Mp=Ff=ii=0,go=cv=null,CR=!1,(g&8)!==0&&(g|=g&32);var E=p.entangledLanes;if(E!==0)for(p=p.entanglements,E&=g;0<E;){var j=31-en(E),q=1<<j;g|=p[j],E&=~q}return fd=g,rr(),_}function nL(p,g){Ir=null,U.H=U_,g===Hb||g===I_?(g=vF(),ys=3):g===gF?(g=vF(),ys=4):ys=g===x8?8:g!==null&&typeof g=="object"&&typeof g.then=="function"?6:1,Yo=g,Fr===null&&(ii=1,G_(p,Bn(g,p.current)))}function rL(){var p=U.H;return U.H=U_,p===null?U_:p}function sL(){var p=U.A;return U.A=efe,p}function NR(){ii=4,Df||(Gr&4194048)!==Gr&&Rl.current!==null||(Fg=!0),(Ff&134217727)===0&&(Mp&134217727)===0||Ps===null||$f(Ps,Gr,Nl,!1)}function MR(p,g,_){var E=gs;gs|=2;var j=rL(),q=sL();(Ps!==p||Gr!==g)&&(eS=null,zg(p,g)),g=!1;var ue=ii;e:do try{if(ys!==0&&Fr!==null){var Re=Fr,Ye=Yo;switch(ys){case 8:RR(),ue=6;break e;case 3:case 2:case 9:case 6:Rl.current===null&&(g=!0);var wt=ys;if(ys=0,Yo=null,Ug(p,Re,Ye,wt),_&&Fg){ue=0;break e}break;default:wt=ys,ys=0,Yo=null,Ug(p,Re,Ye,wt)}}rfe(),ue=ii;break}catch(Dt){nL(p,Dt)}while(!0);return g&&p.shellSuspendCounter++,sd=kp=null,gs=E,U.H=j,U.A=q,Fr===null&&(Ps=null,Gr=0,rr()),ue}function rfe(){for(;Fr!==null;)iL(Fr)}function sfe(p,g){var _=gs;gs|=2;var E=rL(),j=sL();Ps!==p||Gr!==g?(eS=null,Q_=le()+500,zg(p,g)):Fg=de(p,g);e:do try{if(ys!==0&&Fr!==null){g=Fr;var q=Yo;t:switch(ys){case 1:ys=0,Yo=null,Ug(p,g,q,1);break;case 2:case 9:if(yF(q)){ys=0,Yo=null,aL(g);break}g=function(){ys!==2&&ys!==9||Ps!==p||(ys=7),Jc(p)},q.then(g,g);break e;case 3:ys=7;break e;case 4:ys=5;break e;case 7:yF(q)?(ys=0,Yo=null,aL(g)):(ys=0,Yo=null,Ug(p,g,q,7));break;case 5:var ue=null;switch(Fr.tag){case 26:ue=Fr.memoizedState;case 5:case 27:var Re=Fr;if(!ue||zL(ue)){ys=0,Yo=null;var Ye=Re.sibling;if(Ye!==null)Fr=Ye;else{var wt=Re.return;wt!==null?(Fr=wt,nS(wt)):Fr=null}break t}}ys=0,Yo=null,Ug(p,g,q,5);break;case 6:ys=0,Yo=null,Ug(p,g,q,6);break;case 8:RR(),ii=6;break e;default:throw Error(r(462))}}ife();break}catch(Dt){nL(p,Dt)}while(!0);return sd=kp=null,U.H=E,U.A=j,gs=_,Fr!==null?0:(Ps=null,Gr=0,rr(),ii)}function ife(){for(;Fr!==null&&!ge();)iL(Fr)}function iL(p){var g=I8(p.alternate,p,fd);p.memoizedProps=p.pendingProps,g===null?nS(p):Fr=g}function aL(p){var g=p,_=g.alternate;switch(g.tag){case 15:case 0:g=E8(_,g,g.pendingProps,g.type,void 0,Gr);break;case 11:g=E8(_,g,g.pendingProps,g.type.render,g.ref,Gr);break;case 5:HA(g);default:P8(_,g),g=Fr=oF(g,fd),g=I8(_,g,fd)}p.memoizedProps=p.pendingProps,g===null?nS(p):Fr=g}function Ug(p,g,_,E){sd=kp=null,HA(g),jg=null,tv=0;var j=g.return;try{if(Kde(p,j,g,_,Gr)){ii=1,G_(p,Bn(_,p.current)),Fr=null;return}}catch(q){if(j!==null)throw Fr=j,q;ii=1,G_(p,Bn(_,p.current)),Fr=null;return}g.flags&32768?(ss||E===1?p=!0:Fg||(Gr&536870912)!==0?p=!1:(Df=p=!0,(E===2||E===9||E===3||E===6)&&(E=Rl.current,E!==null&&E.tag===13&&(E.flags|=16384))),oL(g,p)):nS(g)}function nS(p){var g=p;do{if((g.flags&32768)!==0){oL(g,Df);return}p=g.return;var _=Zde(g.alternate,g,fd);if(_!==null){Fr=_;return}if(g=g.sibling,g!==null){Fr=g;return}Fr=g=p}while(g!==null);ii===0&&(ii=5)}function oL(p,g){do{var _=Xde(p.alternate,p);if(_!==null){_.flags&=32767,Fr=_;return}if(_=p.return,_!==null&&(_.flags|=32768,_.subtreeFlags=0,_.deletions=null),!g&&(p=p.sibling,p!==null)){Fr=p;return}Fr=p=_}while(p!==null);ii=6,Fr=null}function lL(p,g,_,E,j,q,ue,Re,Ye){p.cancelPendingCommit=null;do rS();while(ha!==0);if((gs&6)!==0)throw Error(r(327));if(g!==null){if(g===p.current)throw Error(r(177));if(q=g.lanes|g.childLanes,q|=da,be(p,_,q,ue,Re,Ye),p===Ps&&(Fr=Ps=null,Gr=0),Bg=g,Bf=p,$g=_,ER=q,TR=j,J8=E,(g.subtreeFlags&10256)!==0||(g.flags&10256)!==0?(p.callbackNode=null,p.callbackPriority=0,cfe(Be,function(){return hL(),null})):(p.callbackNode=null,p.callbackPriority=0),E=(g.flags&13878)!==0,(g.subtreeFlags&13878)!==0||E){E=U.T,U.T=null,j=H.p,H.p=2,ue=gs,gs|=4;try{Jde(p,g,_)}finally{gs=ue,H.p=j,U.T=E}}ha=1,cL(),uL(),dL()}}function cL(){if(ha===1){ha=0;var p=Bf,g=Bg,_=(g.flags&13878)!==0;if((g.subtreeFlags&13878)!==0||_){_=U.T,U.T=null;var E=H.p;H.p=2;var j=gs;gs|=4;try{W8(g,p);var q=qR,ue=he(p.containerInfo),Re=q.focusedElem,Ye=q.selectionRange;if(ue!==Re&&Re&&Re.ownerDocument&&ae(Re.ownerDocument.documentElement,Re)){if(Ye!==null&&Ee(Re)){var wt=Ye.start,Dt=Ye.end;if(Dt===void 0&&(Dt=wt),"selectionStart"in Re)Re.selectionStart=wt,Re.selectionEnd=Math.min(Dt,Re.value.length);else{var Bt=Re.ownerDocument||document,Ct=Bt&&Bt.defaultView||window;if(Ct.getSelection){var At=Ct.getSelection(),sr=Re.textContent.length,Wn=Math.min(Ye.start,sr),Ss=Ye.end===void 0?Wn:Math.min(Ye.end,sr);!At.extend&&Wn>Ss&&(ue=Ss,Ss=Wn,Wn=ue);var pt=te(Re,Wn),rt=te(Re,Ss);if(pt&&rt&&(At.rangeCount!==1||At.anchorNode!==pt.node||At.anchorOffset!==pt.offset||At.focusNode!==rt.node||At.focusOffset!==rt.offset)){var xt=Bt.createRange();xt.setStart(pt.node,pt.offset),At.removeAllRanges(),Wn>Ss?(At.addRange(xt),At.extend(rt.node,rt.offset)):(xt.setEnd(rt.node,rt.offset),At.addRange(xt))}}}}for(Bt=[],At=Re;At=At.parentNode;)At.nodeType===1&&Bt.push({element:At,left:At.scrollLeft,top:At.scrollTop});for(typeof Re.focus=="function"&&Re.focus(),Re=0;Re<Bt.length;Re++){var Ft=Bt[Re];Ft.element.scrollLeft=Ft.left,Ft.element.scrollTop=Ft.top}}mS=!!UR,qR=UR=null}finally{gs=j,H.p=E,U.T=_}}p.current=g,ha=2}}function uL(){if(ha===2){ha=0;var p=Bf,g=Bg,_=(g.flags&8772)!==0;if((g.subtreeFlags&8772)!==0||_){_=U.T,U.T=null;var E=H.p;H.p=2;var j=gs;gs|=4;try{z8(p,g.alternate,g)}finally{gs=j,H.p=E,U.T=_}}ha=3}}function dL(){if(ha===4||ha===3){ha=0,Ae();var p=Bf,g=Bg,_=$g,E=J8;(g.subtreeFlags&10256)!==0||(g.flags&10256)!==0?ha=5:(ha=0,Bg=Bf=null,fL(p,p.pendingLanes));var j=p.pendingLanes;if(j===0&&(Lf=null),fe(_),g=g.stateNode,qt&&typeof qt.onCommitFiberRoot=="function")try{qt.onCommitFiberRoot(Pt,g,void 0,(g.current.flags&128)===128)}catch{}if(E!==null){g=U.T,j=H.p,H.p=2,U.T=null;try{for(var q=p.onRecoverableError,ue=0;ue<E.length;ue++){var Re=E[ue];q(Re.value,{componentStack:Re.stack})}}finally{U.T=g,H.p=j}}($g&3)!==0&&rS(),Jc(p),j=p.pendingLanes,(_&4194090)!==0&&(j&42)!==0?p===AR?uv++:(uv=0,AR=p):uv=0,dv(0)}}function fL(p,g){(p.pooledCacheLanes&=g)===0&&(g=p.pooledCache,g!=null&&(p.pooledCache=null,Vb(g)))}function rS(p){return cL(),uL(),dL(),hL()}function hL(){if(ha!==5)return!1;var p=Bf,g=ER;ER=0;var _=fe($g),E=U.T,j=H.p;try{H.p=32>_?32:_,U.T=null,_=TR,TR=null;var q=Bf,ue=$g;if(ha=0,Bg=Bf=null,$g=0,(gs&6)!==0)throw Error(r(331));var Re=gs;if(gs|=4,Z8(q.current),G8(q,q.current,ue,_),gs=Re,dv(0,!1),qt&&typeof qt.onPostCommitFiberRoot=="function")try{qt.onPostCommitFiberRoot(Pt,q)}catch{}return!0}finally{H.p=j,U.T=E,fL(p,g)}}function pL(p,g,_){g=Bn(_,g),g=aR(p.stateNode,g,2),p=Rf(p,g,2),p!==null&&(st(p,2),Jc(p))}function Ns(p,g,_){if(p.tag===3)pL(p,p,_);else for(;g!==null;){if(g.tag===3){pL(g,p,_);break}else if(g.tag===1){var E=g.stateNode;if(typeof g.type.getDerivedStateFromError=="function"||typeof E.componentDidCatch=="function"&&(Lf===null||!Lf.has(E))){p=Bn(_,p),_=b8(2),E=Rf(g,_,2),E!==null&&(v8(_,E,g,p),st(E,2),Jc(E));break}}g=g.return}}function IR(p,g,_){var E=p.pingCache;if(E===null){E=p.pingCache=new tfe;var j=new Set;E.set(g,j)}else j=E.get(g),j===void 0&&(j=new Set,E.set(g,j));j.has(_)||(_R=!0,j.add(_),p=afe.bind(null,p,g,_),g.then(p,p))}function afe(p,g,_){var E=p.pingCache;E!==null&&E.delete(g),p.pingedLanes|=p.suspendedLanes&_,p.warmLanes&=~_,Ps===p&&(Gr&_)===_&&(ii===4||ii===3&&(Gr&62914560)===Gr&&300>le()-kR?(gs&2)===0&&zg(p,0):SR|=_,Lg===Gr&&(Lg=0)),Jc(p)}function mL(p,g){g===0&&(g=B()),p=ac(p,g),p!==null&&(st(p,g),Jc(p))}function ofe(p){var g=p.memoizedState,_=0;g!==null&&(_=g.retryLane),mL(p,_)}function lfe(p,g){var _=0;switch(p.tag){case 13:var E=p.stateNode,j=p.memoizedState;j!==null&&(_=j.retryLane);break;case 19:E=p.stateNode;break;case 22:E=p.stateNode._retryCache;break;default:throw Error(r(314))}E!==null&&E.delete(g),mL(p,_)}function cfe(p,g){return Ne(p,g)}var sS=null,qg=null,jR=!1,iS=!1,PR=!1,Ip=0;function Jc(p){p!==qg&&p.next===null&&(qg===null?sS=qg=p:qg=qg.next=p),iS=!0,jR||(jR=!0,dfe())}function dv(p,g){if(!PR&&iS){PR=!0;do for(var _=!1,E=sS;E!==null;){if(p!==0){var j=E.pendingLanes;if(j===0)var q=0;else{var ue=E.suspendedLanes,Re=E.pingedLanes;q=(1<<31-en(42|p)+1)-1,q&=j&~(ue&~Re),q=q&201326741?q&201326741|1:q?q|2:0}q!==0&&(_=!0,vL(E,q))}else q=Gr,q=Me(E,E===Ps?q:0,E.cancelPendingCommit!==null||E.timeoutHandle!==-1),(q&3)===0||de(E,q)||(_=!0,vL(E,q));E=E.next}while(_);PR=!1}}function ufe(){gL()}function gL(){iS=jR=!1;var p=0;Ip!==0&&(vfe()&&(p=Ip),Ip=0);for(var g=le(),_=null,E=sS;E!==null;){var j=E.next,q=yL(E,g);q===0?(E.next=null,_===null?sS=j:_.next=j,j===null&&(qg=_)):(_=E,(p!==0||(q&3)!==0)&&(iS=!0)),E=j}dv(p)}function yL(p,g){for(var _=p.suspendedLanes,E=p.pingedLanes,j=p.expirationTimes,q=p.pendingLanes&-62914561;0<q;){var ue=31-en(q),Re=1<<ue,Ye=j[ue];Ye===-1?((Re&_)===0||(Re&E)!==0)&&(j[ue]=vt(Re,g)):Ye<=g&&(p.expiredLanes|=Re),q&=~Re}if(g=Ps,_=Gr,_=Me(p,p===g?_:0,p.cancelPendingCommit!==null||p.timeoutHandle!==-1),E=p.callbackNode,_===0||p===g&&(ys===2||ys===9)||p.cancelPendingCommit!==null)return E!==null&&E!==null&&K(E),p.callbackNode=null,p.callbackPriority=0;if((_&3)===0||de(p,_)){if(g=_&-_,g===p.callbackPriority)return g;switch(E!==null&&K(E),fe(_)){case 2:case 8:_=Te;break;case 32:_=Be;break;case 268435456:_=lt;break;default:_=Be}return E=bL.bind(null,p),_=Ne(_,E),p.callbackPriority=g,p.callbackNode=_,g}return E!==null&&E!==null&&K(E),p.callbackPriority=2,p.callbackNode=null,2}function bL(p,g){if(ha!==0&&ha!==5)return p.callbackNode=null,p.callbackPriority=0,null;var _=p.callbackNode;if(rS()&&p.callbackNode!==_)return null;var E=Gr;return E=Me(p,p===Ps?E:0,p.cancelPendingCommit!==null||p.timeoutHandle!==-1),E===0?null:(eL(p,E,g),yL(p,le()),p.callbackNode!=null&&p.callbackNode===_?bL.bind(null,p):null)}function vL(p,g){if(rS())return null;eL(p,g,!0)}function dfe(){wfe(function(){(gs&6)!==0?Ne(re,ufe):gL()})}function OR(){return Ip===0&&(Ip=ot()),Ip}function xL(p){return p==null||typeof p=="symbol"||typeof p=="boolean"?null:typeof p=="function"?p:Hu(""+p)}function wL(p,g){var _=g.ownerDocument.createElement("input");return _.name=g.name,_.value=g.value,p.id&&_.setAttribute("form",p.id),g.parentNode.insertBefore(_,g),p=new FormData(p),_.parentNode.removeChild(_),p}function ffe(p,g,_,E,j){if(g==="submit"&&_&&_.stateNode===j){var q=xL((j[Oe]||null).action),ue=E.submitter;ue&&(g=(g=ue[Oe]||null)?xL(g.formAction):ue.getAttribute("formAction"),g!==null&&(q=g,ue=null));var Re=new cg("action","action",null,E,j);p.push({event:Re,listeners:[{instance:null,listener:function(){if(E.defaultPrevented){if(Ip!==0){var Ye=ue?wL(j,ue):new FormData(j);tR(_,{pending:!0,data:Ye,method:j.method,action:q},null,Ye)}}else typeof q=="function"&&(Re.preventDefault(),Ye=ue?wL(j,ue):new FormData(j),tR(_,{pending:!0,data:Ye,method:j.method,action:q},q,Ye))},currentTarget:j}]})}}for(var DR=0;DR<an.length;DR++){var FR=an[DR],hfe=FR.toLowerCase(),pfe=FR[0].toUpperCase()+FR.slice(1);Gt(hfe,"on"+pfe)}Gt(St,"onAnimationEnd"),Gt(Nt,"onAnimationIteration"),Gt(Mt,"onAnimationStart"),Gt("dblclick","onDoubleClick"),Gt("focusin","onFocus"),Gt("focusout","onBlur"),Gt(Ot,"onTransitionRun"),Gt(Yt,"onTransitionStart"),Gt(rn,"onTransitionCancel"),Gt(Ht,"onTransitionEnd"),pn("onMouseEnter",["mouseout","mouseover"]),pn("onMouseLeave",["mouseout","mouseover"]),pn("onPointerEnter",["pointerout","pointerover"]),pn("onPointerLeave",["pointerout","pointerover"]),Vt("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Vt("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Vt("onBeforeInput",["compositionend","keypress","textInput","paste"]),Vt("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Vt("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Vt("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var fv="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),mfe=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(fv));function _L(p,g){g=(g&4)!==0;for(var _=0;_<p.length;_++){var E=p[_],j=E.event;E=E.listeners;e:{var q=void 0;if(g)for(var ue=E.length-1;0<=ue;ue--){var Re=E[ue],Ye=Re.instance,wt=Re.currentTarget;if(Re=Re.listener,Ye!==q&&j.isPropagationStopped())break e;q=Re,j.currentTarget=wt;try{q(j)}catch(Dt){H_(Dt)}j.currentTarget=null,q=Ye}else for(ue=0;ue<E.length;ue++){if(Re=E[ue],Ye=Re.instance,wt=Re.currentTarget,Re=Re.listener,Ye!==q&&j.isPropagationStopped())break e;q=Re,j.currentTarget=wt;try{q(j)}catch(Dt){H_(Dt)}j.currentTarget=null,q=Ye}}}}function Lr(p,g){var _=g[_t];_===void 0&&(_=g[_t]=new Set);var E=p+"__bubble";_.has(E)||(SL(g,p,2,!1),_.add(E))}function LR(p,g,_){var E=0;g&&(E|=4),SL(_,p,E,g)}var aS="_reactListening"+Math.random().toString(36).slice(2);function BR(p){if(!p[aS]){p[aS]=!0,hn.forEach(function(_){_!=="selectionchange"&&(mfe.has(_)||LR(_,!1,p),LR(_,!0,p))});var g=p.nodeType===9?p:p.ownerDocument;g===null||g[aS]||(g[aS]=!0,LR("selectionchange",!1,g))}}function SL(p,g,_,E){switch(GL(g)){case 2:var j=Ufe;break;case 8:j=qfe;break;default:j=QR}_=j.bind(null,g,_,p),j=void 0,!Eb||g!=="touchstart"&&g!=="touchmove"&&g!=="wheel"||(j=!0),E?j!==void 0?p.addEventListener(g,_,{capture:!0,passive:j}):p.addEventListener(g,_,!0):j!==void 0?p.addEventListener(g,_,{passive:j}):p.addEventListener(g,_,!1)}function $R(p,g,_,E,j){var q=E;if((g&1)===0&&(g&2)===0&&E!==null)e:for(;;){if(E===null)return;var ue=E.tag;if(ue===3||ue===4){var Re=E.stateNode.containerInfo;if(Re===j)break;if(ue===4)for(ue=E.return;ue!==null;){var Ye=ue.tag;if((Ye===3||Ye===4)&&ue.stateNode.containerInfo===j)return;ue=ue.return}for(;Re!==null;){if(ue=mr(Re),ue===null)return;if(Ye=ue.tag,Ye===5||Ye===6||Ye===26||Ye===27){E=q=ue;continue e}Re=Re.parentNode}}E=E.return}bf(function(){var wt=q,Dt=og(_),Bt=[];e:{var Ct=Jt.get(p);if(Ct!==void 0){var At=cg,sr=p;switch(p){case"keypress":if(wf(_)===0)break e;case"keydown":case"keyup":At=yg;break;case"focusin":sr="focus",At=_f;break;case"focusout":sr="blur",At=_f;break;case"beforeblur":case"afterblur":At=_f;break;case"click":if(_.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":At=fg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":At=m_;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":At=jb;break;case St:case Nt:case Mt:At=g_;break;case Ht:At=Pb;break;case"scroll":case"scrollend":At=ug;break;case"wheel":At=vg;break;case"copy":case"cut":case"paste":At=mg;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":At=Ib;break;case"toggle":case"beforetoggle":At=v_}var Wn=(g&4)!==0,Ss=!Wn&&(p==="scroll"||p==="scrollend"),pt=Wn?Ct!==null?Ct+"Capture":null:Ct;Wn=[];for(var rt=wt,xt;rt!==null;){var Ft=rt;if(xt=Ft.stateNode,Ft=Ft.tag,Ft!==5&&Ft!==26&&Ft!==27||xt===null||pt===null||(Ft=Yu(rt,pt),Ft!=null&&Wn.push(hv(rt,Ft,xt))),Ss)break;rt=rt.return}0<Wn.length&&(Ct=new At(Ct,sr,null,_,Dt),Bt.push({event:Ct,listeners:Wn}))}}if((g&7)===0){e:{if(Ct=p==="mouseover"||p==="pointerover",At=p==="mouseout"||p==="pointerout",Ct&&_!==Sl&&(sr=_.relatedTarget||_.fromElement)&&(mr(sr)||sr[Ge]))break e;if((At||Ct)&&(Ct=Dt.window===Dt?Dt:(Ct=Dt.ownerDocument)?Ct.defaultView||Ct.parentWindow:window,At?(sr=_.relatedTarget||_.toElement,At=wt,sr=sr?mr(sr):null,sr!==null&&(Ss=i(sr),Wn=sr.tag,sr!==Ss||Wn!==5&&Wn!==27&&Wn!==6)&&(sr=null)):(At=null,sr=wt),At!==sr)){if(Wn=fg,Ft="onMouseLeave",pt="onMouseEnter",rt="mouse",(p==="pointerout"||p==="pointerover")&&(Wn=Ib,Ft="onPointerLeave",pt="onPointerEnter",rt="pointer"),Ss=At==null?Ct:ns(At),xt=sr==null?Ct:ns(sr),Ct=new Wn(Ft,rt+"leave",At,_,Dt),Ct.target=Ss,Ct.relatedTarget=xt,Ft=null,mr(Dt)===wt&&(Wn=new Wn(pt,rt+"enter",sr,_,Dt),Wn.target=xt,Wn.relatedTarget=Ss,Ft=Wn),Ss=Ft,At&&sr)t:{for(Wn=At,pt=sr,rt=0,xt=Wn;xt;xt=Vg(xt))rt++;for(xt=0,Ft=pt;Ft;Ft=Vg(Ft))xt++;for(;0<rt-xt;)Wn=Vg(Wn),rt--;for(;0<xt-rt;)pt=Vg(pt),xt--;for(;rt--;){if(Wn===pt||pt!==null&&Wn===pt.alternate)break t;Wn=Vg(Wn),pt=Vg(pt)}Wn=null}else Wn=null;At!==null&&CL(Bt,Ct,At,Wn,!1),sr!==null&&Ss!==null&&CL(Bt,Ss,sr,Wn,!0)}}e:{if(Ct=wt?ns(wt):window,At=Ct.nodeName&&Ct.nodeName.toLowerCase(),At==="select"||At==="input"&&Ct.type==="file")var bn=vp;else if(_g(Ct))if(kl)bn=kf;else{bn=ed;var Or=k_}else At=Ct.nodeName,!At||At.toLowerCase()!=="input"||Ct.type!=="checkbox"&&Ct.type!=="radio"?wt&&kb(wt.elementType)&&(bn=vp):bn=Bb;if(bn&&(bn=bn(p,wt))){Lb(Bt,bn,_,Dt);break e}Or&&Or(p,Ct,wt),p==="focusout"&&wt&&Ct.type==="number"&&wt.memoizedProps.value!=null&&pf(Ct,"number",Ct.value)}switch(Or=wt?ns(wt):window,p){case"focusin":(_g(Or)||Or.contentEditable==="true")&&(He=Or,nt=wt,it=null);break;case"focusout":it=nt=He=null;break;case"mousedown":dt=!0;break;case"contextmenu":case"mouseup":case"dragend":dt=!1,Je(Bt,_,Dt);break;case"selectionchange":if(Le)break;case"keydown":case"keyup":Je(Bt,_,Dt)}var jn;if(yp)e:{switch(p){case"compositionstart":var Kn="onCompositionStart";break e;case"compositionend":Kn="onCompositionEnd";break e;case"compositionupdate":Kn="onCompositionUpdate";break e}Kn=void 0}else Qu?Fb(p,_)&&(Kn="onCompositionEnd"):p==="keydown"&&_.keyCode===229&&(Kn="onCompositionStart");Kn&&(xg&&_.locale!=="ko"&&(Qu||Kn!=="onCompositionStart"?Kn==="onCompositionEnd"&&Qu&&(jn=xf()):(Cl=Dt,lg="value"in Cl?Cl.value:Cl.textContent,Qu=!0)),Or=oS(wt,Kn),0<Or.length&&(Kn=new gg(Kn,p,null,_,Dt),Bt.push({event:Kn,listeners:Or}),jn?Kn.data=jn:(jn=w_(_),jn!==null&&(Kn.data=jn)))),(jn=xA?__(p,_):wA(p,_))&&(Kn=oS(wt,"onBeforeInput"),0<Kn.length&&(Or=new gg("onBeforeInput","beforeinput",null,_,Dt),Bt.push({event:Or,listeners:Kn}),Or.data=jn)),ffe(Bt,p,wt,_,Dt)}_L(Bt,g)})}function hv(p,g,_){return{instance:p,listener:g,currentTarget:_}}function oS(p,g){for(var _=g+"Capture",E=[];p!==null;){var j=p,q=j.stateNode;if(j=j.tag,j!==5&&j!==26&&j!==27||q===null||(j=Yu(p,_),j!=null&&E.unshift(hv(p,j,q)),j=Yu(p,g),j!=null&&E.push(hv(p,j,q))),p.tag===3)return E;p=p.return}return[]}function Vg(p){if(p===null)return null;do p=p.return;while(p&&p.tag!==5&&p.tag!==27);return p||null}function CL(p,g,_,E,j){for(var q=g._reactName,ue=[];_!==null&&_!==E;){var Re=_,Ye=Re.alternate,wt=Re.stateNode;if(Re=Re.tag,Ye!==null&&Ye===E)break;Re!==5&&Re!==26&&Re!==27||wt===null||(Ye=wt,j?(wt=Yu(_,q),wt!=null&&ue.unshift(hv(_,wt,Ye))):j||(wt=Yu(_,q),wt!=null&&ue.push(hv(_,wt,Ye)))),_=_.return}ue.length!==0&&p.push({event:g,listeners:ue})}var gfe=/\r\n?/g,yfe=/\u0000|\uFFFD/g;function kL(p){return(typeof p=="string"?p:""+p).replace(gfe,`
`).replace(yfe,"")}function EL(p,g){return g=kL(g),kL(p)===g}function lS(){}function _s(p,g,_,E,j,q){switch(_){case"children":typeof E=="string"?g==="body"||g==="textarea"&&E===""||gf(p,E):(typeof E=="number"||typeof E=="bigint")&&g!=="body"&&gf(p,""+E);break;case"className":qa(p,"class",E);break;case"tabIndex":qa(p,"tabindex",E);break;case"dir":case"role":case"viewBox":case"width":case"height":qa(p,_,E);break;case"style":h_(p,E,q);break;case"data":if(g!=="object"){qa(p,"data",E);break}case"src":case"href":if(E===""&&(g!=="a"||_!=="href")){p.removeAttribute(_);break}if(E==null||typeof E=="function"||typeof E=="symbol"||typeof E=="boolean"){p.removeAttribute(_);break}E=Hu(""+E),p.setAttribute(_,E);break;case"action":case"formAction":if(typeof E=="function"){p.setAttribute(_,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof q=="function"&&(_==="formAction"?(g!=="input"&&_s(p,g,"name",j.name,j,null),_s(p,g,"formEncType",j.formEncType,j,null),_s(p,g,"formMethod",j.formMethod,j,null),_s(p,g,"formTarget",j.formTarget,j,null)):(_s(p,g,"encType",j.encType,j,null),_s(p,g,"method",j.method,j,null),_s(p,g,"target",j.target,j,null)));if(E==null||typeof E=="symbol"||typeof E=="boolean"){p.removeAttribute(_);break}E=Hu(""+E),p.setAttribute(_,E);break;case"onClick":E!=null&&(p.onclick=lS);break;case"onScroll":E!=null&&Lr("scroll",p);break;case"onScrollEnd":E!=null&&Lr("scrollend",p);break;case"dangerouslySetInnerHTML":if(E!=null){if(typeof E!="object"||!("__html"in E))throw Error(r(61));if(_=E.__html,_!=null){if(j.children!=null)throw Error(r(60));p.innerHTML=_}}break;case"multiple":p.multiple=E&&typeof E!="function"&&typeof E!="symbol";break;case"muted":p.muted=E&&typeof E!="function"&&typeof E!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(E==null||typeof E=="function"||typeof E=="boolean"||typeof E=="symbol"){p.removeAttribute("xlink:href");break}_=Hu(""+E),p.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",_);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":E!=null&&typeof E!="function"&&typeof E!="symbol"?p.setAttribute(_,""+E):p.removeAttribute(_);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":E&&typeof E!="function"&&typeof E!="symbol"?p.setAttribute(_,""):p.removeAttribute(_);break;case"capture":case"download":E===!0?p.setAttribute(_,""):E!==!1&&E!=null&&typeof E!="function"&&typeof E!="symbol"?p.setAttribute(_,E):p.removeAttribute(_);break;case"cols":case"rows":case"size":case"span":E!=null&&typeof E!="function"&&typeof E!="symbol"&&!isNaN(E)&&1<=E?p.setAttribute(_,E):p.removeAttribute(_);break;case"rowSpan":case"start":E==null||typeof E=="function"||typeof E=="symbol"||isNaN(E)?p.removeAttribute(_):p.setAttribute(_,E);break;case"popover":Lr("beforetoggle",p),Lr("toggle",p),ci(p,"popover",E);break;case"xlinkActuate":ua(p,"http://www.w3.org/1999/xlink","xlink:actuate",E);break;case"xlinkArcrole":ua(p,"http://www.w3.org/1999/xlink","xlink:arcrole",E);break;case"xlinkRole":ua(p,"http://www.w3.org/1999/xlink","xlink:role",E);break;case"xlinkShow":ua(p,"http://www.w3.org/1999/xlink","xlink:show",E);break;case"xlinkTitle":ua(p,"http://www.w3.org/1999/xlink","xlink:title",E);break;case"xlinkType":ua(p,"http://www.w3.org/1999/xlink","xlink:type",E);break;case"xmlBase":ua(p,"http://www.w3.org/XML/1998/namespace","xml:base",E);break;case"xmlLang":ua(p,"http://www.w3.org/XML/1998/namespace","xml:lang",E);break;case"xmlSpace":ua(p,"http://www.w3.org/XML/1998/namespace","xml:space",E);break;case"is":ci(p,"is",E);break;case"innerText":case"textContent":break;default:(!(2<_.length)||_[0]!=="o"&&_[0]!=="O"||_[1]!=="n"&&_[1]!=="N")&&(_=Wa.get(_)||_,ci(p,_,E))}}function zR(p,g,_,E,j,q){switch(_){case"style":h_(p,E,q);break;case"dangerouslySetInnerHTML":if(E!=null){if(typeof E!="object"||!("__html"in E))throw Error(r(61));if(_=E.__html,_!=null){if(j.children!=null)throw Error(r(60));p.innerHTML=_}}break;case"children":typeof E=="string"?gf(p,E):(typeof E=="number"||typeof E=="bigint")&&gf(p,""+E);break;case"onScroll":E!=null&&Lr("scroll",p);break;case"onScrollEnd":E!=null&&Lr("scrollend",p);break;case"onClick":E!=null&&(p.onclick=lS);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!et.hasOwnProperty(_))e:{if(_[0]==="o"&&_[1]==="n"&&(j=_.endsWith("Capture"),g=_.slice(2,j?_.length-7:void 0),q=p[Oe]||null,q=q!=null?q[_]:null,typeof q=="function"&&p.removeEventListener(g,q,j),typeof E=="function")){typeof q!="function"&&q!==null&&(_ in p?p[_]=null:p.hasAttribute(_)&&p.removeAttribute(_)),p.addEventListener(g,E,j);break e}_ in p?p[_]=E:E===!0?p.setAttribute(_,""):ci(p,_,E)}}}function pa(p,g,_){switch(g){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Lr("error",p),Lr("load",p);var E=!1,j=!1,q;for(q in _)if(_.hasOwnProperty(q)){var ue=_[q];if(ue!=null)switch(q){case"src":E=!0;break;case"srcSet":j=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,g));default:_s(p,g,q,ue,_,null)}}j&&_s(p,g,"srcSet",_.srcSet,_,null),E&&_s(p,g,"src",_.src,_,null);return;case"input":Lr("invalid",p);var Re=q=ue=j=null,Ye=null,wt=null;for(E in _)if(_.hasOwnProperty(E)){var Dt=_[E];if(Dt!=null)switch(E){case"name":j=Dt;break;case"type":ue=Dt;break;case"checked":Ye=Dt;break;case"defaultChecked":wt=Dt;break;case"value":q=Dt;break;case"defaultValue":Re=Dt;break;case"children":case"dangerouslySetInnerHTML":if(Dt!=null)throw Error(r(137,g));break;default:_s(p,g,E,Dt,_,null)}}Sb(p,q,Re,Ye,wt,ue,j,!1),qc(p);return;case"select":Lr("invalid",p),E=ue=q=null;for(j in _)if(_.hasOwnProperty(j)&&(Re=_[j],Re!=null))switch(j){case"value":q=Re;break;case"defaultValue":ue=Re;break;case"multiple":E=Re;default:_s(p,g,j,Re,_,null)}g=q,_=ue,p.multiple=!!E,g!=null?Wu(p,!!E,g,!1):_!=null&&Wu(p,!!E,_,!0);return;case"textarea":Lr("invalid",p),q=j=E=null;for(ue in _)if(_.hasOwnProperty(ue)&&(Re=_[ue],Re!=null))switch(ue){case"value":E=Re;break;case"defaultValue":j=Re;break;case"children":q=Re;break;case"dangerouslySetInnerHTML":if(Re!=null)throw Error(r(91));break;default:_s(p,g,ue,Re,_,null)}Cb(p,E,j,q),qc(p);return;case"option":for(Ye in _)if(_.hasOwnProperty(Ye)&&(E=_[Ye],E!=null))switch(Ye){case"selected":p.selected=E&&typeof E!="function"&&typeof E!="symbol";break;default:_s(p,g,Ye,E,_,null)}return;case"dialog":Lr("beforetoggle",p),Lr("toggle",p),Lr("cancel",p),Lr("close",p);break;case"iframe":case"object":Lr("load",p);break;case"video":case"audio":for(E=0;E<fv.length;E++)Lr(fv[E],p);break;case"image":Lr("error",p),Lr("load",p);break;case"details":Lr("toggle",p);break;case"embed":case"source":case"link":Lr("error",p),Lr("load",p);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(wt in _)if(_.hasOwnProperty(wt)&&(E=_[wt],E!=null))switch(wt){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,g));default:_s(p,g,wt,E,_,null)}return;default:if(kb(g)){for(Dt in _)_.hasOwnProperty(Dt)&&(E=_[Dt],E!==void 0&&zR(p,g,Dt,E,_,void 0));return}}for(Re in _)_.hasOwnProperty(Re)&&(E=_[Re],E!=null&&_s(p,g,Re,E,_,null))}function bfe(p,g,_,E){switch(g){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var j=null,q=null,ue=null,Re=null,Ye=null,wt=null,Dt=null;for(At in _){var Bt=_[At];if(_.hasOwnProperty(At)&&Bt!=null)switch(At){case"checked":break;case"value":break;case"defaultValue":Ye=Bt;default:E.hasOwnProperty(At)||_s(p,g,At,null,E,Bt)}}for(var Ct in E){var At=E[Ct];if(Bt=_[Ct],E.hasOwnProperty(Ct)&&(At!=null||Bt!=null))switch(Ct){case"type":q=At;break;case"name":j=At;break;case"checked":wt=At;break;case"defaultChecked":Dt=At;break;case"value":ue=At;break;case"defaultValue":Re=At;break;case"children":case"dangerouslySetInnerHTML":if(At!=null)throw Error(r(137,g));break;default:At!==Bt&&_s(p,g,Ct,At,E,Bt)}}hf(p,ue,Re,Ye,wt,Dt,q,j);return;case"select":At=ue=Re=Ct=null;for(q in _)if(Ye=_[q],_.hasOwnProperty(q)&&Ye!=null)switch(q){case"value":break;case"multiple":At=Ye;default:E.hasOwnProperty(q)||_s(p,g,q,null,E,Ye)}for(j in E)if(q=E[j],Ye=_[j],E.hasOwnProperty(j)&&(q!=null||Ye!=null))switch(j){case"value":Ct=q;break;case"defaultValue":Re=q;break;case"multiple":ue=q;default:q!==Ye&&_s(p,g,j,q,E,Ye)}g=Re,_=ue,E=At,Ct!=null?Wu(p,!!_,Ct,!1):!!E!=!!_&&(g!=null?Wu(p,!!_,g,!0):Wu(p,!!_,_?[]:"",!1));return;case"textarea":At=Ct=null;for(Re in _)if(j=_[Re],_.hasOwnProperty(Re)&&j!=null&&!E.hasOwnProperty(Re))switch(Re){case"value":break;case"children":break;default:_s(p,g,Re,null,E,j)}for(ue in E)if(j=E[ue],q=_[ue],E.hasOwnProperty(ue)&&(j!=null||q!=null))switch(ue){case"value":Ct=j;break;case"defaultValue":At=j;break;case"children":break;case"dangerouslySetInnerHTML":if(j!=null)throw Error(r(91));break;default:j!==q&&_s(p,g,ue,j,E,q)}mf(p,Ct,At);return;case"option":for(var sr in _)if(Ct=_[sr],_.hasOwnProperty(sr)&&Ct!=null&&!E.hasOwnProperty(sr))switch(sr){case"selected":p.selected=!1;break;default:_s(p,g,sr,null,E,Ct)}for(Ye in E)if(Ct=E[Ye],At=_[Ye],E.hasOwnProperty(Ye)&&Ct!==At&&(Ct!=null||At!=null))switch(Ye){case"selected":p.selected=Ct&&typeof Ct!="function"&&typeof Ct!="symbol";break;default:_s(p,g,Ye,Ct,E,At)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Wn in _)Ct=_[Wn],_.hasOwnProperty(Wn)&&Ct!=null&&!E.hasOwnProperty(Wn)&&_s(p,g,Wn,null,E,Ct);for(wt in E)if(Ct=E[wt],At=_[wt],E.hasOwnProperty(wt)&&Ct!==At&&(Ct!=null||At!=null))switch(wt){case"children":case"dangerouslySetInnerHTML":if(Ct!=null)throw Error(r(137,g));break;default:_s(p,g,wt,Ct,E,At)}return;default:if(kb(g)){for(var Ss in _)Ct=_[Ss],_.hasOwnProperty(Ss)&&Ct!==void 0&&!E.hasOwnProperty(Ss)&&zR(p,g,Ss,void 0,E,Ct);for(Dt in E)Ct=E[Dt],At=_[Dt],!E.hasOwnProperty(Dt)||Ct===At||Ct===void 0&&At===void 0||zR(p,g,Dt,Ct,E,At);return}}for(var pt in _)Ct=_[pt],_.hasOwnProperty(pt)&&Ct!=null&&!E.hasOwnProperty(pt)&&_s(p,g,pt,null,E,Ct);for(Bt in E)Ct=E[Bt],At=_[Bt],!E.hasOwnProperty(Bt)||Ct===At||Ct==null&&At==null||_s(p,g,Bt,Ct,E,At)}var UR=null,qR=null;function cS(p){return p.nodeType===9?p:p.ownerDocument}function TL(p){switch(p){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function AL(p,g){if(p===0)switch(g){case"svg":return 1;case"math":return 2;default:return 0}return p===1&&g==="foreignObject"?0:p}function VR(p,g){return p==="textarea"||p==="noscript"||typeof g.children=="string"||typeof g.children=="number"||typeof g.children=="bigint"||typeof g.dangerouslySetInnerHTML=="object"&&g.dangerouslySetInnerHTML!==null&&g.dangerouslySetInnerHTML.__html!=null}var WR=null;function vfe(){var p=window.event;return p&&p.type==="popstate"?p===WR?!1:(WR=p,!0):(WR=null,!1)}var RL=typeof setTimeout=="function"?setTimeout:void 0,xfe=typeof clearTimeout=="function"?clearTimeout:void 0,NL=typeof Promise=="function"?Promise:void 0,wfe=typeof queueMicrotask=="function"?queueMicrotask:typeof NL<"u"?function(p){return NL.resolve(null).then(p).catch(_fe)}:RL;function _fe(p){setTimeout(function(){throw p})}function zf(p){return p==="head"}function ML(p,g){var _=g,E=0,j=0;do{var q=_.nextSibling;if(p.removeChild(_),q&&q.nodeType===8)if(_=q.data,_==="/$"){if(0<E&&8>E){_=E;var ue=p.ownerDocument;if(_&1&&pv(ue.documentElement),_&2&&pv(ue.body),_&4)for(_=ue.head,pv(_),ue=_.firstChild;ue;){var Re=ue.nextSibling,Ye=ue.nodeName;ue[nn]||Ye==="SCRIPT"||Ye==="STYLE"||Ye==="LINK"&&ue.rel.toLowerCase()==="stylesheet"||_.removeChild(ue),ue=Re}}if(j===0){p.removeChild(q),_v(g);return}j--}else _==="$"||_==="$?"||_==="$!"?j++:E=_.charCodeAt(0)-48;else E=0;_=q}while(_);_v(g)}function HR(p){var g=p.firstChild;for(g&&g.nodeType===10&&(g=g.nextSibling);g;){var _=g;switch(g=g.nextSibling,_.nodeName){case"HTML":case"HEAD":case"BODY":HR(_),un(_);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(_.rel.toLowerCase()==="stylesheet")continue}p.removeChild(_)}}function Sfe(p,g,_,E){for(;p.nodeType===1;){var j=_;if(p.nodeName.toLowerCase()!==g.toLowerCase()){if(!E&&(p.nodeName!=="INPUT"||p.type!=="hidden"))break}else if(E){if(!p[nn])switch(g){case"meta":if(!p.hasAttribute("itemprop"))break;return p;case"link":if(q=p.getAttribute("rel"),q==="stylesheet"&&p.hasAttribute("data-precedence"))break;if(q!==j.rel||p.getAttribute("href")!==(j.href==null||j.href===""?null:j.href)||p.getAttribute("crossorigin")!==(j.crossOrigin==null?null:j.crossOrigin)||p.getAttribute("title")!==(j.title==null?null:j.title))break;return p;case"style":if(p.hasAttribute("data-precedence"))break;return p;case"script":if(q=p.getAttribute("src"),(q!==(j.src==null?null:j.src)||p.getAttribute("type")!==(j.type==null?null:j.type)||p.getAttribute("crossorigin")!==(j.crossOrigin==null?null:j.crossOrigin))&&q&&p.hasAttribute("async")&&!p.hasAttribute("itemprop"))break;return p;default:return p}}else if(g==="input"&&p.type==="hidden"){var q=j.name==null?null:""+j.name;if(j.type==="hidden"&&p.getAttribute("name")===q)return p}else return p;if(p=lc(p.nextSibling),p===null)break}return null}function Cfe(p,g,_){if(g==="")return null;for(;p.nodeType!==3;)if((p.nodeType!==1||p.nodeName!=="INPUT"||p.type!=="hidden")&&!_||(p=lc(p.nextSibling),p===null))return null;return p}function GR(p){return p.data==="$!"||p.data==="$?"&&p.ownerDocument.readyState==="complete"}function kfe(p,g){var _=p.ownerDocument;if(p.data!=="$?"||_.readyState==="complete")g();else{var E=function(){g(),_.removeEventListener("DOMContentLoaded",E)};_.addEventListener("DOMContentLoaded",E),p._reactRetry=E}}function lc(p){for(;p!=null;p=p.nextSibling){var g=p.nodeType;if(g===1||g===3)break;if(g===8){if(g=p.data,g==="$"||g==="$!"||g==="$?"||g==="F!"||g==="F")break;if(g==="/$")return null}}return p}var KR=null;function IL(p){p=p.previousSibling;for(var g=0;p;){if(p.nodeType===8){var _=p.data;if(_==="$"||_==="$!"||_==="$?"){if(g===0)return p;g--}else _==="/$"&&g++}p=p.previousSibling}return null}function jL(p,g,_){switch(g=cS(_),p){case"html":if(p=g.documentElement,!p)throw Error(r(452));return p;case"head":if(p=g.head,!p)throw Error(r(453));return p;case"body":if(p=g.body,!p)throw Error(r(454));return p;default:throw Error(r(451))}}function pv(p){for(var g=p.attributes;g.length;)p.removeAttributeNode(g[0]);un(p)}var Ml=new Map,PL=new Set;function uS(p){return typeof p.getRootNode=="function"?p.getRootNode():p.nodeType===9?p:p.ownerDocument}var hd=H.d;H.d={f:Efe,r:Tfe,D:Afe,C:Rfe,L:Nfe,m:Mfe,X:jfe,S:Ife,M:Pfe};function Efe(){var p=hd.f(),g=tS();return p||g}function Tfe(p){var g=Rr(p);g!==null&&g.tag===5&&g.type==="form"?e8(g):hd.r(p)}var Wg=typeof document>"u"?null:document;function OL(p,g,_){var E=Wg;if(E&&typeof g=="string"&&g){var j=Sa(g);j='link[rel="'+p+'"][href="'+j+'"]',typeof _=="string"&&(j+='[crossorigin="'+_+'"]'),PL.has(j)||(PL.add(j),p={rel:p,crossOrigin:_,href:g},E.querySelector(j)===null&&(g=E.createElement("link"),pa(g,"link",p),Cr(g),E.head.appendChild(g)))}}function Afe(p){hd.D(p),OL("dns-prefetch",p,null)}function Rfe(p,g){hd.C(p,g),OL("preconnect",p,g)}function Nfe(p,g,_){hd.L(p,g,_);var E=Wg;if(E&&p&&g){var j='link[rel="preload"][as="'+Sa(g)+'"]';g==="image"&&_&&_.imageSrcSet?(j+='[imagesrcset="'+Sa(_.imageSrcSet)+'"]',typeof _.imageSizes=="string"&&(j+='[imagesizes="'+Sa(_.imageSizes)+'"]')):j+='[href="'+Sa(p)+'"]';var q=j;switch(g){case"style":q=Hg(p);break;case"script":q=Gg(p)}Ml.has(q)||(p=u({rel:"preload",href:g==="image"&&_&&_.imageSrcSet?void 0:p,as:g},_),Ml.set(q,p),E.querySelector(j)!==null||g==="style"&&E.querySelector(mv(q))||g==="script"&&E.querySelector(gv(q))||(g=E.createElement("link"),pa(g,"link",p),Cr(g),E.head.appendChild(g)))}}function Mfe(p,g){hd.m(p,g);var _=Wg;if(_&&p){var E=g&&typeof g.as=="string"?g.as:"script",j='link[rel="modulepreload"][as="'+Sa(E)+'"][href="'+Sa(p)+'"]',q=j;switch(E){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":q=Gg(p)}if(!Ml.has(q)&&(p=u({rel:"modulepreload",href:p},g),Ml.set(q,p),_.querySelector(j)===null)){switch(E){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(_.querySelector(gv(q)))return}E=_.createElement("link"),pa(E,"link",p),Cr(E),_.head.appendChild(E)}}}function Ife(p,g,_){hd.S(p,g,_);var E=Wg;if(E&&p){var j=rs(E).hoistableStyles,q=Hg(p);g=g||"default";var ue=j.get(q);if(!ue){var Re={loading:0,preload:null};if(ue=E.querySelector(mv(q)))Re.loading=5;else{p=u({rel:"stylesheet",href:p,"data-precedence":g},_),(_=Ml.get(q))&&YR(p,_);var Ye=ue=E.createElement("link");Cr(Ye),pa(Ye,"link",p),Ye._p=new Promise(function(wt,Dt){Ye.onload=wt,Ye.onerror=Dt}),Ye.addEventListener("load",function(){Re.loading|=1}),Ye.addEventListener("error",function(){Re.loading|=2}),Re.loading|=4,dS(ue,g,E)}ue={type:"stylesheet",instance:ue,count:1,state:Re},j.set(q,ue)}}}function jfe(p,g){hd.X(p,g);var _=Wg;if(_&&p){var E=rs(_).hoistableScripts,j=Gg(p),q=E.get(j);q||(q=_.querySelector(gv(j)),q||(p=u({src:p,async:!0},g),(g=Ml.get(j))&&ZR(p,g),q=_.createElement("script"),Cr(q),pa(q,"link",p),_.head.appendChild(q)),q={type:"script",instance:q,count:1,state:null},E.set(j,q))}}function Pfe(p,g){hd.M(p,g);var _=Wg;if(_&&p){var E=rs(_).hoistableScripts,j=Gg(p),q=E.get(j);q||(q=_.querySelector(gv(j)),q||(p=u({src:p,async:!0,type:"module"},g),(g=Ml.get(j))&&ZR(p,g),q=_.createElement("script"),Cr(q),pa(q,"link",p),_.head.appendChild(q)),q={type:"script",instance:q,count:1,state:null},E.set(j,q))}}function DL(p,g,_,E){var j=(j=Ie.current)?uS(j):null;if(!j)throw Error(r(446));switch(p){case"meta":case"title":return null;case"style":return typeof _.precedence=="string"&&typeof _.href=="string"?(g=Hg(_.href),_=rs(j).hoistableStyles,E=_.get(g),E||(E={type:"style",instance:null,count:0,state:null},_.set(g,E)),E):{type:"void",instance:null,count:0,state:null};case"link":if(_.rel==="stylesheet"&&typeof _.href=="string"&&typeof _.precedence=="string"){p=Hg(_.href);var q=rs(j).hoistableStyles,ue=q.get(p);if(ue||(j=j.ownerDocument||j,ue={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},q.set(p,ue),(q=j.querySelector(mv(p)))&&!q._p&&(ue.instance=q,ue.state.loading=5),Ml.has(p)||(_={rel:"preload",as:"style",href:_.href,crossOrigin:_.crossOrigin,integrity:_.integrity,media:_.media,hrefLang:_.hrefLang,referrerPolicy:_.referrerPolicy},Ml.set(p,_),q||Ofe(j,p,_,ue.state))),g&&E===null)throw Error(r(528,""));return ue}if(g&&E!==null)throw Error(r(529,""));return null;case"script":return g=_.async,_=_.src,typeof _=="string"&&g&&typeof g!="function"&&typeof g!="symbol"?(g=Gg(_),_=rs(j).hoistableScripts,E=_.get(g),E||(E={type:"script",instance:null,count:0,state:null},_.set(g,E)),E):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,p))}}function Hg(p){return'href="'+Sa(p)+'"'}function mv(p){return'link[rel="stylesheet"]['+p+"]"}function FL(p){return u({},p,{"data-precedence":p.precedence,precedence:null})}function Ofe(p,g,_,E){p.querySelector('link[rel="preload"][as="style"]['+g+"]")?E.loading=1:(g=p.createElement("link"),E.preload=g,g.addEventListener("load",function(){return E.loading|=1}),g.addEventListener("error",function(){return E.loading|=2}),pa(g,"link",_),Cr(g),p.head.appendChild(g))}function Gg(p){return'[src="'+Sa(p)+'"]'}function gv(p){return"script[async]"+p}function LL(p,g,_){if(g.count++,g.instance===null)switch(g.type){case"style":var E=p.querySelector('style[data-href~="'+Sa(_.href)+'"]');if(E)return g.instance=E,Cr(E),E;var j=u({},_,{"data-href":_.href,"data-precedence":_.precedence,href:null,precedence:null});return E=(p.ownerDocument||p).createElement("style"),Cr(E),pa(E,"style",j),dS(E,_.precedence,p),g.instance=E;case"stylesheet":j=Hg(_.href);var q=p.querySelector(mv(j));if(q)return g.state.loading|=4,g.instance=q,Cr(q),q;E=FL(_),(j=Ml.get(j))&&YR(E,j),q=(p.ownerDocument||p).createElement("link"),Cr(q);var ue=q;return ue._p=new Promise(function(Re,Ye){ue.onload=Re,ue.onerror=Ye}),pa(q,"link",E),g.state.loading|=4,dS(q,_.precedence,p),g.instance=q;case"script":return q=Gg(_.src),(j=p.querySelector(gv(q)))?(g.instance=j,Cr(j),j):(E=_,(j=Ml.get(q))&&(E=u({},_),ZR(E,j)),p=p.ownerDocument||p,j=p.createElement("script"),Cr(j),pa(j,"link",E),p.head.appendChild(j),g.instance=j);case"void":return null;default:throw Error(r(443,g.type))}else g.type==="stylesheet"&&(g.state.loading&4)===0&&(E=g.instance,g.state.loading|=4,dS(E,_.precedence,p));return g.instance}function dS(p,g,_){for(var E=_.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),j=E.length?E[E.length-1]:null,q=j,ue=0;ue<E.length;ue++){var Re=E[ue];if(Re.dataset.precedence===g)q=Re;else if(q!==j)break}q?q.parentNode.insertBefore(p,q.nextSibling):(g=_.nodeType===9?_.head:_,g.insertBefore(p,g.firstChild))}function YR(p,g){p.crossOrigin==null&&(p.crossOrigin=g.crossOrigin),p.referrerPolicy==null&&(p.referrerPolicy=g.referrerPolicy),p.title==null&&(p.title=g.title)}function ZR(p,g){p.crossOrigin==null&&(p.crossOrigin=g.crossOrigin),p.referrerPolicy==null&&(p.referrerPolicy=g.referrerPolicy),p.integrity==null&&(p.integrity=g.integrity)}var fS=null;function BL(p,g,_){if(fS===null){var E=new Map,j=fS=new Map;j.set(_,E)}else j=fS,E=j.get(_),E||(E=new Map,j.set(_,E));if(E.has(p))return E;for(E.set(p,null),_=_.getElementsByTagName(p),j=0;j<_.length;j++){var q=_[j];if(!(q[nn]||q[ve]||p==="link"&&q.getAttribute("rel")==="stylesheet")&&q.namespaceURI!=="http://www.w3.org/2000/svg"){var ue=q.getAttribute(g)||"";ue=p+ue;var Re=E.get(ue);Re?Re.push(q):E.set(ue,[q])}}return E}function $L(p,g,_){p=p.ownerDocument||p,p.head.insertBefore(_,g==="title"?p.querySelector("head > title"):null)}function Dfe(p,g,_){if(_===1||g.itemProp!=null)return!1;switch(p){case"meta":case"title":return!0;case"style":if(typeof g.precedence!="string"||typeof g.href!="string"||g.href==="")break;return!0;case"link":if(typeof g.rel!="string"||typeof g.href!="string"||g.href===""||g.onLoad||g.onError)break;switch(g.rel){case"stylesheet":return p=g.disabled,typeof g.precedence=="string"&&p==null;default:return!0}case"script":if(g.async&&typeof g.async!="function"&&typeof g.async!="symbol"&&!g.onLoad&&!g.onError&&g.src&&typeof g.src=="string")return!0}return!1}function zL(p){return!(p.type==="stylesheet"&&(p.state.loading&3)===0)}var yv=null;function Ffe(){}function Lfe(p,g,_){if(yv===null)throw Error(r(475));var E=yv;if(g.type==="stylesheet"&&(typeof _.media!="string"||matchMedia(_.media).matches!==!1)&&(g.state.loading&4)===0){if(g.instance===null){var j=Hg(_.href),q=p.querySelector(mv(j));if(q){p=q._p,p!==null&&typeof p=="object"&&typeof p.then=="function"&&(E.count++,E=hS.bind(E),p.then(E,E)),g.state.loading|=4,g.instance=q,Cr(q);return}q=p.ownerDocument||p,_=FL(_),(j=Ml.get(j))&&YR(_,j),q=q.createElement("link"),Cr(q);var ue=q;ue._p=new Promise(function(Re,Ye){ue.onload=Re,ue.onerror=Ye}),pa(q,"link",_),g.instance=q}E.stylesheets===null&&(E.stylesheets=new Map),E.stylesheets.set(g,p),(p=g.state.preload)&&(g.state.loading&3)===0&&(E.count++,g=hS.bind(E),p.addEventListener("load",g),p.addEventListener("error",g))}}function Bfe(){if(yv===null)throw Error(r(475));var p=yv;return p.stylesheets&&p.count===0&&XR(p,p.stylesheets),0<p.count?function(g){var _=setTimeout(function(){if(p.stylesheets&&XR(p,p.stylesheets),p.unsuspend){var E=p.unsuspend;p.unsuspend=null,E()}},6e4);return p.unsuspend=g,function(){p.unsuspend=null,clearTimeout(_)}}:null}function hS(){if(this.count--,this.count===0){if(this.stylesheets)XR(this,this.stylesheets);else if(this.unsuspend){var p=this.unsuspend;this.unsuspend=null,p()}}}var pS=null;function XR(p,g){p.stylesheets=null,p.unsuspend!==null&&(p.count++,pS=new Map,g.forEach($fe,p),pS=null,hS.call(p))}function $fe(p,g){if(!(g.state.loading&4)){var _=pS.get(p);if(_)var E=_.get(null);else{_=new Map,pS.set(p,_);for(var j=p.querySelectorAll("link[data-precedence],style[data-precedence]"),q=0;q<j.length;q++){var ue=j[q];(ue.nodeName==="LINK"||ue.getAttribute("media")!=="not all")&&(_.set(ue.dataset.precedence,ue),E=ue)}E&&_.set(null,E)}j=g.instance,ue=j.getAttribute("data-precedence"),q=_.get(ue)||E,q===E&&_.set(null,j),_.set(ue,j),this.count++,E=hS.bind(this),j.addEventListener("load",E),j.addEventListener("error",E),q?q.parentNode.insertBefore(j,q.nextSibling):(p=p.nodeType===9?p.head:p,p.insertBefore(j,p.firstChild)),g.state.loading|=4}}var bv={$$typeof:S,Provider:null,Consumer:null,_currentValue:$,_currentValue2:$,_threadCount:0};function zfe(p,g,_,E,j,q,ue,Re){this.tag=1,this.containerInfo=p,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ze(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ze(0),this.hiddenUpdates=ze(null),this.identifierPrefix=E,this.onUncaughtError=j,this.onCaughtError=q,this.onRecoverableError=ue,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Re,this.incompleteTransitions=new Map}function UL(p,g,_,E,j,q,ue,Re,Ye,wt,Dt,Bt){return p=new zfe(p,g,_,ue,Re,Ye,wt,Bt),g=1,q===!0&&(g|=24),q=Ho(3,null,null,g),p.current=q,q.stateNode=p,g=IA(),g.refCount++,p.pooledCache=g,g.refCount++,q.memoizedState={element:E,isDehydrated:_,cache:g},DA(q),p}function qL(p){return p?(p=Gc,p):Gc}function VL(p,g,_,E,j,q){j=qL(j),E.context===null?E.context=j:E.pendingContext=j,E=Af(g),E.payload={element:_},q=q===void 0?null:q,q!==null&&(E.callback=q),_=Rf(p,E,g),_!==null&&(Xo(_,p,g),Kb(_,p,g))}function WL(p,g){if(p=p.memoizedState,p!==null&&p.dehydrated!==null){var _=p.retryLane;p.retryLane=_!==0&&_<g?_:g}}function JR(p,g){WL(p,g),(p=p.alternate)&&WL(p,g)}function HL(p){if(p.tag===13){var g=ac(p,67108864);g!==null&&Xo(g,p,67108864),JR(p,67108864)}}var mS=!0;function Ufe(p,g,_,E){var j=U.T;U.T=null;var q=H.p;try{H.p=2,QR(p,g,_,E)}finally{H.p=q,U.T=j}}function qfe(p,g,_,E){var j=U.T;U.T=null;var q=H.p;try{H.p=8,QR(p,g,_,E)}finally{H.p=q,U.T=j}}function QR(p,g,_,E){if(mS){var j=eN(E);if(j===null)$R(p,g,E,gS,_),KL(p,E);else if(Wfe(j,p,g,_,E))E.stopPropagation();else if(KL(p,E),g&4&&-1<Vfe.indexOf(p)){for(;j!==null;){var q=Rr(j);if(q!==null)switch(q.tag){case 3:if(q=q.stateNode,q.current.memoizedState.isDehydrated){var ue=we(q.pendingLanes);if(ue!==0){var Re=q;for(Re.pendingLanes|=2,Re.entangledLanes|=2;ue;){var Ye=1<<31-en(ue);Re.entanglements[1]|=Ye,ue&=~Ye}Jc(q),(gs&6)===0&&(Q_=le()+500,dv(0))}}break;case 13:Re=ac(q,2),Re!==null&&Xo(Re,q,2),tS(),JR(q,2)}if(q=eN(E),q===null&&$R(p,g,E,gS,_),q===j)break;j=q}j!==null&&E.stopPropagation()}else $R(p,g,E,null,_)}}function eN(p){return p=og(p),tN(p)}var gS=null;function tN(p){if(gS=null,p=mr(p),p!==null){var g=i(p);if(g===null)p=null;else{var _=g.tag;if(_===13){if(p=a(g),p!==null)return p;p=null}else if(_===3){if(g.stateNode.current.memoizedState.isDehydrated)return g.tag===3?g.stateNode.containerInfo:null;p=null}else g!==p&&(p=null)}}return gS=p,null}function GL(p){switch(p){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(oe()){case re:return 2;case Te:return 8;case Be:case ke:return 32;case lt:return 268435456;default:return 32}default:return 32}}var nN=!1,Uf=null,qf=null,Vf=null,vv=new Map,xv=new Map,Wf=[],Vfe="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function KL(p,g){switch(p){case"focusin":case"focusout":Uf=null;break;case"dragenter":case"dragleave":qf=null;break;case"mouseover":case"mouseout":Vf=null;break;case"pointerover":case"pointerout":vv.delete(g.pointerId);break;case"gotpointercapture":case"lostpointercapture":xv.delete(g.pointerId)}}function wv(p,g,_,E,j,q){return p===null||p.nativeEvent!==q?(p={blockedOn:g,domEventName:_,eventSystemFlags:E,nativeEvent:q,targetContainers:[j]},g!==null&&(g=Rr(g),g!==null&&HL(g)),p):(p.eventSystemFlags|=E,g=p.targetContainers,j!==null&&g.indexOf(j)===-1&&g.push(j),p)}function Wfe(p,g,_,E,j){switch(g){case"focusin":return Uf=wv(Uf,p,g,_,E,j),!0;case"dragenter":return qf=wv(qf,p,g,_,E,j),!0;case"mouseover":return Vf=wv(Vf,p,g,_,E,j),!0;case"pointerover":var q=j.pointerId;return vv.set(q,wv(vv.get(q)||null,p,g,_,E,j)),!0;case"gotpointercapture":return q=j.pointerId,xv.set(q,wv(xv.get(q)||null,p,g,_,E,j)),!0}return!1}function YL(p){var g=mr(p.target);if(g!==null){var _=i(g);if(_!==null){if(g=_.tag,g===13){if(g=a(_),g!==null){p.blockedOn=g,G(p.priority,function(){if(_.tag===13){var E=Zo();E=kt(E);var j=ac(_,E);j!==null&&Xo(j,_,E),JR(_,E)}});return}}else if(g===3&&_.stateNode.current.memoizedState.isDehydrated){p.blockedOn=_.tag===3?_.stateNode.containerInfo:null;return}}}p.blockedOn=null}function yS(p){if(p.blockedOn!==null)return!1;for(var g=p.targetContainers;0<g.length;){var _=eN(p.nativeEvent);if(_===null){_=p.nativeEvent;var E=new _.constructor(_.type,_);Sl=E,_.target.dispatchEvent(E),Sl=null}else return g=Rr(_),g!==null&&HL(g),p.blockedOn=_,!1;g.shift()}return!0}function ZL(p,g,_){yS(p)&&_.delete(g)}function Hfe(){nN=!1,Uf!==null&&yS(Uf)&&(Uf=null),qf!==null&&yS(qf)&&(qf=null),Vf!==null&&yS(Vf)&&(Vf=null),vv.forEach(ZL),xv.forEach(ZL)}function bS(p,g){p.blockedOn===g&&(p.blockedOn=null,nN||(nN=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Hfe)))}var vS=null;function XL(p){vS!==p&&(vS=p,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){vS===p&&(vS=null);for(var g=0;g<p.length;g+=3){var _=p[g],E=p[g+1],j=p[g+2];if(typeof E!="function"){if(tN(E||_)===null)continue;break}var q=Rr(_);q!==null&&(p.splice(g,3),g-=3,tR(q,{pending:!0,data:j,method:_.method,action:E},E,j))}}))}function _v(p){function g(Ye){return bS(Ye,p)}Uf!==null&&bS(Uf,p),qf!==null&&bS(qf,p),Vf!==null&&bS(Vf,p),vv.forEach(g),xv.forEach(g);for(var _=0;_<Wf.length;_++){var E=Wf[_];E.blockedOn===p&&(E.blockedOn=null)}for(;0<Wf.length&&(_=Wf[0],_.blockedOn===null);)YL(_),_.blockedOn===null&&Wf.shift();if(_=(p.ownerDocument||p).$$reactFormReplay,_!=null)for(E=0;E<_.length;E+=3){var j=_[E],q=_[E+1],ue=j[Oe]||null;if(typeof q=="function")ue||XL(_);else if(ue){var Re=null;if(q&&q.hasAttribute("formAction")){if(j=q,ue=q[Oe]||null)Re=ue.formAction;else if(tN(j)!==null)continue}else Re=ue.action;typeof Re=="function"?_[E+1]=Re:(_.splice(E,3),E-=3),XL(_)}}}function rN(p){this._internalRoot=p}xS.prototype.render=rN.prototype.render=function(p){var g=this._internalRoot;if(g===null)throw Error(r(409));var _=g.current,E=Zo();VL(_,E,p,g,null,null)},xS.prototype.unmount=rN.prototype.unmount=function(){var p=this._internalRoot;if(p!==null){this._internalRoot=null;var g=p.containerInfo;VL(p.current,2,null,p,null,null),tS(),g[Ge]=null}};function xS(p){this._internalRoot=p}xS.prototype.unstable_scheduleHydration=function(p){if(p){var g=Y();p={blockedOn:null,target:p,priority:g};for(var _=0;_<Wf.length&&g!==0&&g<Wf[_].priority;_++);Wf.splice(_,0,p),_===0&&YL(p)}};var JL=t.version;if(JL!=="19.1.0")throw Error(r(527,JL,"19.1.0"));H.findDOMNode=function(p){var g=p._reactInternals;if(g===void 0)throw typeof p.render=="function"?Error(r(188)):(p=Object.keys(p).join(","),Error(r(268,p)));return p=l(g),p=p!==null?c(p):null,p=p===null?null:p.stateNode,p};var Gfe={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:U,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var wS=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!wS.isDisabled&&wS.supportsFiber)try{Pt=wS.inject(Gfe),qt=wS}catch{}}return Cv.createRoot=function(p,g){if(!s(p))throw Error(r(299));var _=!1,E="",j=p8,q=m8,ue=g8,Re=null;return g!=null&&(g.unstable_strictMode===!0&&(_=!0),g.identifierPrefix!==void 0&&(E=g.identifierPrefix),g.onUncaughtError!==void 0&&(j=g.onUncaughtError),g.onCaughtError!==void 0&&(q=g.onCaughtError),g.onRecoverableError!==void 0&&(ue=g.onRecoverableError),g.unstable_transitionCallbacks!==void 0&&(Re=g.unstable_transitionCallbacks)),g=UL(p,1,!1,null,null,_,E,j,q,ue,Re,null),p[Ge]=g.current,BR(p),new rN(g)},Cv.hydrateRoot=function(p,g,_){if(!s(p))throw Error(r(299));var E=!1,j="",q=p8,ue=m8,Re=g8,Ye=null,wt=null;return _!=null&&(_.unstable_strictMode===!0&&(E=!0),_.identifierPrefix!==void 0&&(j=_.identifierPrefix),_.onUncaughtError!==void 0&&(q=_.onUncaughtError),_.onCaughtError!==void 0&&(ue=_.onCaughtError),_.onRecoverableError!==void 0&&(Re=_.onRecoverableError),_.unstable_transitionCallbacks!==void 0&&(Ye=_.unstable_transitionCallbacks),_.formState!==void 0&&(wt=_.formState)),g=UL(p,1,!0,g,_??null,E,j,q,ue,Re,Ye,wt),g.context=qL(null),_=g.current,E=Zo(),E=kt(E),j=Af(E),j.callback=null,Rf(_,j,E),_=E,g.current.lanes=_,st(g,_),Jc(g),p[Ge]=g.current,BR(p),new xS(g)},Cv.version="19.1.0",Cv}var lB;function che(){if(lB)return aN.exports;lB=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),aN.exports=lhe(),aN.exports}var uhe=che();const dhe=_a(uhe);function cB(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function hl(...e){return t=>{let n=!1;const r=e.map(s=>{const i=cB(s,t);return!n&&typeof i=="function"&&(n=!0),i});if(n)return()=>{for(let s=0;s<r.length;s++){const i=r[s];typeof i=="function"?i():cB(e[s],null)}}}}function Rn(...e){return T.useCallback(hl(...e),e)}function Au(e){const t=fhe(e),n=T.forwardRef((r,s)=>{const{children:i,...a}=r,o=T.Children.toArray(i),l=o.find(phe);if(l){const c=l.props.children,u=o.map(d=>d===l?T.Children.count(c)>1?T.Children.only(null):T.isValidElement(c)?c.props.children:null:d);return f.jsx(t,{...a,ref:s,children:T.isValidElement(c)?T.cloneElement(c,void 0,u):null})}return f.jsx(t,{...a,ref:s,children:i})});return n.displayName=`${e}.Slot`,n}var HW=Au("Slot");function fhe(e){const t=T.forwardRef((n,r)=>{const{children:s,...i}=n;if(T.isValidElement(s)){const a=ghe(s),o=mhe(i,s.props);return s.type!==T.Fragment&&(o.ref=r?hl(r,a):a),T.cloneElement(s,o)}return T.Children.count(s)>1?T.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var hhe=Symbol("radix.slottable");function phe(e){return T.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===hhe}function mhe(e,t){const n={...t};for(const r in t){const s=e[r],i=t[r];/^on[A-Z]/.test(r)?s&&i?n[r]=(...o)=>{const l=i(...o);return s(...o),l}:s&&(n[r]=s):r==="style"?n[r]={...s,...i}:r==="className"&&(n[r]=[s,i].filter(Boolean).join(" "))}return{...e,...n}}function ghe(e){var r,s;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(s=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:s.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}function GW(e){var t,n,r="";if(typeof e=="string"||typeof e=="number")r+=e;else if(typeof e=="object")if(Array.isArray(e)){var s=e.length;for(t=0;t<s;t++)e[t]&&(n=GW(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}function KW(){for(var e,t,n=0,r="",s=arguments.length;n<s;n++)(e=arguments[n])&&(t=GW(e))&&(r&&(r+=" "),r+=t);return r}const uB=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,dB=KW,NP=(e,t)=>n=>{var r;if((t==null?void 0:t.variants)==null)return dB(e,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:s,defaultVariants:i}=t,a=Object.keys(s).map(c=>{const u=n==null?void 0:n[c],d=i==null?void 0:i[c];if(u===null)return null;const h=uB(u)||uB(d);return s[c][h]}),o=n&&Object.entries(n).reduce((c,u)=>{let[d,h]=u;return h===void 0||(c[d]=h),c},{}),l=t==null||(r=t.compoundVariants)===null||r===void 0?void 0:r.reduce((c,u)=>{let{class:d,className:h,...m}=u;return Object.entries(m).every(y=>{let[b,v]=y;return Array.isArray(v)?v.includes({...i,...o}[b]):{...i,...o}[b]===v})?[...c,d,h]:c},[]);return dB(e,a,l,n==null?void 0:n.class,n==null?void 0:n.className)},MP="-",yhe=e=>{const t=vhe(e),{conflictingClassGroups:n,conflictingClassGroupModifiers:r}=e;return{getClassGroupId:a=>{const o=a.split(MP);return o[0]===""&&o.length!==1&&o.shift(),YW(o,t)||bhe(a)},getConflictingClassGroupIds:(a,o)=>{const l=n[a]||[];return o&&r[a]?[...l,...r[a]]:l}}},YW=(e,t)=>{var a;if(e.length===0)return t.classGroupId;const n=e[0],r=t.nextPart.get(n),s=r?YW(e.slice(1),r):void 0;if(s)return s;if(t.validators.length===0)return;const i=e.join(MP);return(a=t.validators.find(({validator:o})=>o(i)))==null?void 0:a.classGroupId},fB=/^\[(.+)\]$/,bhe=e=>{if(fB.test(e)){const t=fB.exec(e)[1],n=t==null?void 0:t.substring(0,t.indexOf(":"));if(n)return"arbitrary.."+n}},vhe=e=>{const{theme:t,classGroups:n}=e,r={nextPart:new Map,validators:[]};for(const s in n)$3(n[s],r,s,t);return r},$3=(e,t,n,r)=>{e.forEach(s=>{if(typeof s=="string"){const i=s===""?t:hB(t,s);i.classGroupId=n;return}if(typeof s=="function"){if(xhe(s)){$3(s(r),t,n,r);return}t.validators.push({validator:s,classGroupId:n});return}Object.entries(s).forEach(([i,a])=>{$3(a,hB(t,i),n,r)})})},hB=(e,t)=>{let n=e;return t.split(MP).forEach(r=>{n.nextPart.has(r)||n.nextPart.set(r,{nextPart:new Map,validators:[]}),n=n.nextPart.get(r)}),n},xhe=e=>e.isThemeGetter,whe=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,n=new Map,r=new Map;const s=(i,a)=>{n.set(i,a),t++,t>e&&(t=0,r=n,n=new Map)};return{get(i){let a=n.get(i);if(a!==void 0)return a;if((a=r.get(i))!==void 0)return s(i,a),a},set(i,a){n.has(i)?n.set(i,a):s(i,a)}}},z3="!",U3=":",_he=U3.length,She=e=>{const{prefix:t,experimentalParseClassName:n}=e;let r=s=>{const i=[];let a=0,o=0,l=0,c;for(let y=0;y<s.length;y++){let b=s[y];if(a===0&&o===0){if(b===U3){i.push(s.slice(l,y)),l=y+_he;continue}if(b==="/"){c=y;continue}}b==="["?a++:b==="]"?a--:b==="("?o++:b===")"&&o--}const u=i.length===0?s:s.substring(l),d=Che(u),h=d!==u,m=c&&c>l?c-l:void 0;return{modifiers:i,hasImportantModifier:h,baseClassName:d,maybePostfixModifierPosition:m}};if(t){const s=t+U3,i=r;r=a=>a.startsWith(s)?i(a.substring(s.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:a,maybePostfixModifierPosition:void 0}}if(n){const s=r;r=i=>n({className:i,parseClassName:s})}return r},Che=e=>e.endsWith(z3)?e.substring(0,e.length-1):e.startsWith(z3)?e.substring(1):e,khe=e=>{const t=Object.fromEntries(e.orderSensitiveModifiers.map(r=>[r,!0]));return r=>{if(r.length<=1)return r;const s=[];let i=[];return r.forEach(a=>{a[0]==="["||t[a]?(s.push(...i.sort(),a),i=[]):i.push(a)}),s.push(...i.sort()),s}},Ehe=e=>({cache:whe(e.cacheSize),parseClassName:She(e),sortModifiers:khe(e),...yhe(e)}),The=/\s+/,Ahe=(e,t)=>{const{parseClassName:n,getClassGroupId:r,getConflictingClassGroupIds:s,sortModifiers:i}=t,a=[],o=e.trim().split(The);let l="";for(let c=o.length-1;c>=0;c-=1){const u=o[c],{isExternal:d,modifiers:h,hasImportantModifier:m,baseClassName:y,maybePostfixModifierPosition:b}=n(u);if(d){l=u+(l.length>0?" "+l:l);continue}let v=!!b,x=r(v?y.substring(0,b):y);if(!x){if(!v){l=u+(l.length>0?" "+l:l);continue}if(x=r(y),!x){l=u+(l.length>0?" "+l:l);continue}v=!1}const w=i(h).join(":"),S=m?w+z3:w,C=S+x;if(a.includes(C))continue;a.push(C);const k=s(x,v);for(let A=0;A<k.length;++A){const R=k[A];a.push(S+R)}l=u+(l.length>0?" "+l:l)}return l};function Rhe(){let e=0,t,n,r="";for(;e<arguments.length;)(t=arguments[e++])&&(n=ZW(t))&&(r&&(r+=" "),r+=n);return r}const ZW=e=>{if(typeof e=="string")return e;let t,n="";for(let r=0;r<e.length;r++)e[r]&&(t=ZW(e[r]))&&(n&&(n+=" "),n+=t);return n};function Nhe(e,...t){let n,r,s,i=a;function a(l){const c=t.reduce((u,d)=>d(u),e());return n=Ehe(c),r=n.cache.get,s=n.cache.set,i=o,o(l)}function o(l){const c=r(l);if(c)return c;const u=Ahe(l,n);return s(l,u),u}return function(){return i(Rhe.apply(null,arguments))}}const Oi=e=>{const t=n=>n[e]||[];return t.isThemeGetter=!0,t},XW=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,JW=/^\((?:(\w[\w-]*):)?(.+)\)$/i,Mhe=/^\d+\/\d+$/,Ihe=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,jhe=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,Phe=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,Ohe=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,Dhe=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Kg=e=>Mhe.test(e),jr=e=>!!e&&!Number.isNaN(Number(e)),Gf=e=>!!e&&Number.isInteger(Number(e)),uN=e=>e.endsWith("%")&&jr(e.slice(0,-1)),pd=e=>Ihe.test(e),Fhe=()=>!0,Lhe=e=>jhe.test(e)&&!Phe.test(e),QW=()=>!1,Bhe=e=>Ohe.test(e),$he=e=>Dhe.test(e),zhe=e=>!vn(e)&&!xn(e),Uhe=e=>jy(e,nH,QW),vn=e=>XW.test(e),jp=e=>jy(e,rH,Lhe),dN=e=>jy(e,Ghe,jr),pB=e=>jy(e,eH,QW),qhe=e=>jy(e,tH,$he),_S=e=>jy(e,sH,Bhe),xn=e=>JW.test(e),kv=e=>Py(e,rH),Vhe=e=>Py(e,Khe),mB=e=>Py(e,eH),Whe=e=>Py(e,nH),Hhe=e=>Py(e,tH),SS=e=>Py(e,sH,!0),jy=(e,t,n)=>{const r=XW.exec(e);return r?r[1]?t(r[1]):n(r[2]):!1},Py=(e,t,n=!1)=>{const r=JW.exec(e);return r?r[1]?t(r[1]):n:!1},eH=e=>e==="position"||e==="percentage",tH=e=>e==="image"||e==="url",nH=e=>e==="length"||e==="size"||e==="bg-size",rH=e=>e==="length",Ghe=e=>e==="number",Khe=e=>e==="family-name",sH=e=>e==="shadow",Yhe=()=>{const e=Oi("color"),t=Oi("font"),n=Oi("text"),r=Oi("font-weight"),s=Oi("tracking"),i=Oi("leading"),a=Oi("breakpoint"),o=Oi("container"),l=Oi("spacing"),c=Oi("radius"),u=Oi("shadow"),d=Oi("inset-shadow"),h=Oi("text-shadow"),m=Oi("drop-shadow"),y=Oi("blur"),b=Oi("perspective"),v=Oi("aspect"),x=Oi("ease"),w=Oi("animate"),S=()=>["auto","avoid","all","avoid-page","page","left","right","column"],C=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],k=()=>[...C(),xn,vn],A=()=>["auto","hidden","clip","visible","scroll"],R=()=>["auto","contain","none"],N=()=>[xn,vn,l],I=()=>[Kg,"full","auto",...N()],P=()=>[Gf,"none","subgrid",xn,vn],L=()=>["auto",{span:["full",Gf,xn,vn]},Gf,xn,vn],O=()=>[Gf,"auto",xn,vn],V=()=>["auto","min","max","fr",xn,vn],D=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],Z=()=>["start","end","center","stretch","center-safe","end-safe"],U=()=>["auto",...N()],H=()=>[Kg,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...N()],$=()=>[e,xn,vn],ne=()=>[...C(),mB,pB,{position:[xn,vn]}],W=()=>["no-repeat",{repeat:["","x","y","space","round"]}],Q=()=>["auto","cover","contain",Whe,Uhe,{size:[xn,vn]}],ee=()=>[uN,kv,jp],se=()=>["","none","full",c,xn,vn],pe=()=>["",jr,kv,jp],ce=()=>["solid","dashed","dotted","double"],Ie=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],De=()=>[jr,uN,mB,pB],Se=()=>["","none",y,xn,vn],Ce=()=>["none",jr,xn,vn],qe=()=>["none",jr,xn,vn],Qe=()=>[jr,xn,vn],Ve=()=>[Kg,"full",...N()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[pd],breakpoint:[pd],color:[Fhe],container:[pd],"drop-shadow":[pd],ease:["in","out","in-out"],font:[zhe],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[pd],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[pd],shadow:[pd],spacing:["px",jr],text:[pd],"text-shadow":[pd],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",Kg,vn,xn,v]}],container:["container"],columns:[{columns:[jr,vn,xn,o]}],"break-after":[{"break-after":S()}],"break-before":[{"break-before":S()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:k()}],overflow:[{overflow:A()}],"overflow-x":[{"overflow-x":A()}],"overflow-y":[{"overflow-y":A()}],overscroll:[{overscroll:R()}],"overscroll-x":[{"overscroll-x":R()}],"overscroll-y":[{"overscroll-y":R()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:I()}],"inset-x":[{"inset-x":I()}],"inset-y":[{"inset-y":I()}],start:[{start:I()}],end:[{end:I()}],top:[{top:I()}],right:[{right:I()}],bottom:[{bottom:I()}],left:[{left:I()}],visibility:["visible","invisible","collapse"],z:[{z:[Gf,"auto",xn,vn]}],basis:[{basis:[Kg,"full","auto",o,...N()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[jr,Kg,"auto","initial","none",vn]}],grow:[{grow:["",jr,xn,vn]}],shrink:[{shrink:["",jr,xn,vn]}],order:[{order:[Gf,"first","last","none",xn,vn]}],"grid-cols":[{"grid-cols":P()}],"col-start-end":[{col:L()}],"col-start":[{"col-start":O()}],"col-end":[{"col-end":O()}],"grid-rows":[{"grid-rows":P()}],"row-start-end":[{row:L()}],"row-start":[{"row-start":O()}],"row-end":[{"row-end":O()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":V()}],"auto-rows":[{"auto-rows":V()}],gap:[{gap:N()}],"gap-x":[{"gap-x":N()}],"gap-y":[{"gap-y":N()}],"justify-content":[{justify:[...D(),"normal"]}],"justify-items":[{"justify-items":[...Z(),"normal"]}],"justify-self":[{"justify-self":["auto",...Z()]}],"align-content":[{content:["normal",...D()]}],"align-items":[{items:[...Z(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...Z(),{baseline:["","last"]}]}],"place-content":[{"place-content":D()}],"place-items":[{"place-items":[...Z(),"baseline"]}],"place-self":[{"place-self":["auto",...Z()]}],p:[{p:N()}],px:[{px:N()}],py:[{py:N()}],ps:[{ps:N()}],pe:[{pe:N()}],pt:[{pt:N()}],pr:[{pr:N()}],pb:[{pb:N()}],pl:[{pl:N()}],m:[{m:U()}],mx:[{mx:U()}],my:[{my:U()}],ms:[{ms:U()}],me:[{me:U()}],mt:[{mt:U()}],mr:[{mr:U()}],mb:[{mb:U()}],ml:[{ml:U()}],"space-x":[{"space-x":N()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":N()}],"space-y-reverse":["space-y-reverse"],size:[{size:H()}],w:[{w:[o,"screen",...H()]}],"min-w":[{"min-w":[o,"screen","none",...H()]}],"max-w":[{"max-w":[o,"screen","none","prose",{screen:[a]},...H()]}],h:[{h:["screen",...H()]}],"min-h":[{"min-h":["screen","none",...H()]}],"max-h":[{"max-h":["screen",...H()]}],"font-size":[{text:["base",n,kv,jp]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[r,xn,dN]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",uN,vn]}],"font-family":[{font:[Vhe,vn,t]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[s,xn,vn]}],"line-clamp":[{"line-clamp":[jr,"none",xn,dN]}],leading:[{leading:[i,...N()]}],"list-image":[{"list-image":["none",xn,vn]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",xn,vn]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:$()}],"text-color":[{text:$()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...ce(),"wavy"]}],"text-decoration-thickness":[{decoration:[jr,"from-font","auto",xn,jp]}],"text-decoration-color":[{decoration:$()}],"underline-offset":[{"underline-offset":[jr,"auto",xn,vn]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:N()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",xn,vn]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",xn,vn]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:ne()}],"bg-repeat":[{bg:W()}],"bg-size":[{bg:Q()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},Gf,xn,vn],radial:["",xn,vn],conic:[Gf,xn,vn]},Hhe,qhe]}],"bg-color":[{bg:$()}],"gradient-from-pos":[{from:ee()}],"gradient-via-pos":[{via:ee()}],"gradient-to-pos":[{to:ee()}],"gradient-from":[{from:$()}],"gradient-via":[{via:$()}],"gradient-to":[{to:$()}],rounded:[{rounded:se()}],"rounded-s":[{"rounded-s":se()}],"rounded-e":[{"rounded-e":se()}],"rounded-t":[{"rounded-t":se()}],"rounded-r":[{"rounded-r":se()}],"rounded-b":[{"rounded-b":se()}],"rounded-l":[{"rounded-l":se()}],"rounded-ss":[{"rounded-ss":se()}],"rounded-se":[{"rounded-se":se()}],"rounded-ee":[{"rounded-ee":se()}],"rounded-es":[{"rounded-es":se()}],"rounded-tl":[{"rounded-tl":se()}],"rounded-tr":[{"rounded-tr":se()}],"rounded-br":[{"rounded-br":se()}],"rounded-bl":[{"rounded-bl":se()}],"border-w":[{border:pe()}],"border-w-x":[{"border-x":pe()}],"border-w-y":[{"border-y":pe()}],"border-w-s":[{"border-s":pe()}],"border-w-e":[{"border-e":pe()}],"border-w-t":[{"border-t":pe()}],"border-w-r":[{"border-r":pe()}],"border-w-b":[{"border-b":pe()}],"border-w-l":[{"border-l":pe()}],"divide-x":[{"divide-x":pe()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":pe()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...ce(),"hidden","none"]}],"divide-style":[{divide:[...ce(),"hidden","none"]}],"border-color":[{border:$()}],"border-color-x":[{"border-x":$()}],"border-color-y":[{"border-y":$()}],"border-color-s":[{"border-s":$()}],"border-color-e":[{"border-e":$()}],"border-color-t":[{"border-t":$()}],"border-color-r":[{"border-r":$()}],"border-color-b":[{"border-b":$()}],"border-color-l":[{"border-l":$()}],"divide-color":[{divide:$()}],"outline-style":[{outline:[...ce(),"none","hidden"]}],"outline-offset":[{"outline-offset":[jr,xn,vn]}],"outline-w":[{outline:["",jr,kv,jp]}],"outline-color":[{outline:$()}],shadow:[{shadow:["","none",u,SS,_S]}],"shadow-color":[{shadow:$()}],"inset-shadow":[{"inset-shadow":["none",d,SS,_S]}],"inset-shadow-color":[{"inset-shadow":$()}],"ring-w":[{ring:pe()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:$()}],"ring-offset-w":[{"ring-offset":[jr,jp]}],"ring-offset-color":[{"ring-offset":$()}],"inset-ring-w":[{"inset-ring":pe()}],"inset-ring-color":[{"inset-ring":$()}],"text-shadow":[{"text-shadow":["none",h,SS,_S]}],"text-shadow-color":[{"text-shadow":$()}],opacity:[{opacity:[jr,xn,vn]}],"mix-blend":[{"mix-blend":[...Ie(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":Ie()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[jr]}],"mask-image-linear-from-pos":[{"mask-linear-from":De()}],"mask-image-linear-to-pos":[{"mask-linear-to":De()}],"mask-image-linear-from-color":[{"mask-linear-from":$()}],"mask-image-linear-to-color":[{"mask-linear-to":$()}],"mask-image-t-from-pos":[{"mask-t-from":De()}],"mask-image-t-to-pos":[{"mask-t-to":De()}],"mask-image-t-from-color":[{"mask-t-from":$()}],"mask-image-t-to-color":[{"mask-t-to":$()}],"mask-image-r-from-pos":[{"mask-r-from":De()}],"mask-image-r-to-pos":[{"mask-r-to":De()}],"mask-image-r-from-color":[{"mask-r-from":$()}],"mask-image-r-to-color":[{"mask-r-to":$()}],"mask-image-b-from-pos":[{"mask-b-from":De()}],"mask-image-b-to-pos":[{"mask-b-to":De()}],"mask-image-b-from-color":[{"mask-b-from":$()}],"mask-image-b-to-color":[{"mask-b-to":$()}],"mask-image-l-from-pos":[{"mask-l-from":De()}],"mask-image-l-to-pos":[{"mask-l-to":De()}],"mask-image-l-from-color":[{"mask-l-from":$()}],"mask-image-l-to-color":[{"mask-l-to":$()}],"mask-image-x-from-pos":[{"mask-x-from":De()}],"mask-image-x-to-pos":[{"mask-x-to":De()}],"mask-image-x-from-color":[{"mask-x-from":$()}],"mask-image-x-to-color":[{"mask-x-to":$()}],"mask-image-y-from-pos":[{"mask-y-from":De()}],"mask-image-y-to-pos":[{"mask-y-to":De()}],"mask-image-y-from-color":[{"mask-y-from":$()}],"mask-image-y-to-color":[{"mask-y-to":$()}],"mask-image-radial":[{"mask-radial":[xn,vn]}],"mask-image-radial-from-pos":[{"mask-radial-from":De()}],"mask-image-radial-to-pos":[{"mask-radial-to":De()}],"mask-image-radial-from-color":[{"mask-radial-from":$()}],"mask-image-radial-to-color":[{"mask-radial-to":$()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":C()}],"mask-image-conic-pos":[{"mask-conic":[jr]}],"mask-image-conic-from-pos":[{"mask-conic-from":De()}],"mask-image-conic-to-pos":[{"mask-conic-to":De()}],"mask-image-conic-from-color":[{"mask-conic-from":$()}],"mask-image-conic-to-color":[{"mask-conic-to":$()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:ne()}],"mask-repeat":[{mask:W()}],"mask-size":[{mask:Q()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",xn,vn]}],filter:[{filter:["","none",xn,vn]}],blur:[{blur:Se()}],brightness:[{brightness:[jr,xn,vn]}],contrast:[{contrast:[jr,xn,vn]}],"drop-shadow":[{"drop-shadow":["","none",m,SS,_S]}],"drop-shadow-color":[{"drop-shadow":$()}],grayscale:[{grayscale:["",jr,xn,vn]}],"hue-rotate":[{"hue-rotate":[jr,xn,vn]}],invert:[{invert:["",jr,xn,vn]}],saturate:[{saturate:[jr,xn,vn]}],sepia:[{sepia:["",jr,xn,vn]}],"backdrop-filter":[{"backdrop-filter":["","none",xn,vn]}],"backdrop-blur":[{"backdrop-blur":Se()}],"backdrop-brightness":[{"backdrop-brightness":[jr,xn,vn]}],"backdrop-contrast":[{"backdrop-contrast":[jr,xn,vn]}],"backdrop-grayscale":[{"backdrop-grayscale":["",jr,xn,vn]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[jr,xn,vn]}],"backdrop-invert":[{"backdrop-invert":["",jr,xn,vn]}],"backdrop-opacity":[{"backdrop-opacity":[jr,xn,vn]}],"backdrop-saturate":[{"backdrop-saturate":[jr,xn,vn]}],"backdrop-sepia":[{"backdrop-sepia":["",jr,xn,vn]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":N()}],"border-spacing-x":[{"border-spacing-x":N()}],"border-spacing-y":[{"border-spacing-y":N()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",xn,vn]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[jr,"initial",xn,vn]}],ease:[{ease:["linear","initial",x,xn,vn]}],delay:[{delay:[jr,xn,vn]}],animate:[{animate:["none",w,xn,vn]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[b,xn,vn]}],"perspective-origin":[{"perspective-origin":k()}],rotate:[{rotate:Ce()}],"rotate-x":[{"rotate-x":Ce()}],"rotate-y":[{"rotate-y":Ce()}],"rotate-z":[{"rotate-z":Ce()}],scale:[{scale:qe()}],"scale-x":[{"scale-x":qe()}],"scale-y":[{"scale-y":qe()}],"scale-z":[{"scale-z":qe()}],"scale-3d":["scale-3d"],skew:[{skew:Qe()}],"skew-x":[{"skew-x":Qe()}],"skew-y":[{"skew-y":Qe()}],transform:[{transform:[xn,vn,"","none","gpu","cpu"]}],"transform-origin":[{origin:k()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:Ve()}],"translate-x":[{"translate-x":Ve()}],"translate-y":[{"translate-y":Ve()}],"translate-z":[{"translate-z":Ve()}],"translate-none":["translate-none"],accent:[{accent:$()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:$()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",xn,vn]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":N()}],"scroll-mx":[{"scroll-mx":N()}],"scroll-my":[{"scroll-my":N()}],"scroll-ms":[{"scroll-ms":N()}],"scroll-me":[{"scroll-me":N()}],"scroll-mt":[{"scroll-mt":N()}],"scroll-mr":[{"scroll-mr":N()}],"scroll-mb":[{"scroll-mb":N()}],"scroll-ml":[{"scroll-ml":N()}],"scroll-p":[{"scroll-p":N()}],"scroll-px":[{"scroll-px":N()}],"scroll-py":[{"scroll-py":N()}],"scroll-ps":[{"scroll-ps":N()}],"scroll-pe":[{"scroll-pe":N()}],"scroll-pt":[{"scroll-pt":N()}],"scroll-pr":[{"scroll-pr":N()}],"scroll-pb":[{"scroll-pb":N()}],"scroll-pl":[{"scroll-pl":N()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",xn,vn]}],fill:[{fill:["none",...$()]}],"stroke-w":[{stroke:[jr,kv,jp,dN]}],stroke:[{stroke:["none",...$()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},Zhe=Nhe(Yhe);function Ze(...e){return Zhe(KW(e))}const q3=NP("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function ft({className:e,variant:t,size:n,asChild:r=!1,...s}){const i=r?HW:"button";return f.jsx(i,{"data-slot":"button",className:Ze(q3({variant:t,size:n,className:e})),...s})}/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xhe=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Jhe=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,n,r)=>r?r.toUpperCase():n.toLowerCase()),gB=e=>{const t=Jhe(e);return t.charAt(0).toUpperCase()+t.slice(1)},iH=(...e)=>e.filter((t,n,r)=>!!t&&t.trim()!==""&&r.indexOf(t)===n).join(" ").trim();/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Qhe={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const epe=T.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:s="",children:i,iconNode:a,...o},l)=>T.createElement("svg",{ref:l,...Qhe,width:t,height:t,stroke:e,strokeWidth:r?Number(n)*24/Number(t):n,className:iH("lucide",s),...o},[...a.map(([c,u])=>T.createElement(c,u)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ut=(e,t)=>{const n=T.forwardRef(({className:r,...s},i)=>T.createElement(epe,{ref:i,iconNode:t,className:iH(`lucide-${Xhe(gB(e))}`,`lucide-${e}`,r),...s}));return n.displayName=gB(e),n};/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tpe=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],aH=Ut("archive",tpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const npe=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],oH=Ut("arrow-down",npe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rpe=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],spe=Ut("arrow-left",rpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ipe=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],ape=Ut("arrow-right",ipe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ope=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],lpe=Ut("arrow-up",ope);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cpe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]],upe=Ut("ban",cpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dpe=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M16 12h2",key:"7q9ll5"}],["path",{d:"M16 8h2",key:"msurwy"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}],["path",{d:"M6 12h2",key:"32wvfc"}],["path",{d:"M6 8h2",key:"30oboj"}]],fpe=Ut("book-open-text",dpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hpe=[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]],eC=Ut("bot",hpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ppe=[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M9 13a4.5 4.5 0 0 0 3-4",key:"10igwf"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M12 13h4",key:"1ku699"}],["path",{d:"M12 18h6a2 2 0 0 1 2 2v1",key:"105ag5"}],["path",{d:"M12 8h8",key:"1lhi5i"}],["path",{d:"M16 8V5a2 2 0 0 1 2-2",key:"u6izg6"}],["circle",{cx:"16",cy:"13",r:".5",key:"ry7gng"}],["circle",{cx:"18",cy:"3",r:".5",key:"1aiba7"}],["circle",{cx:"20",cy:"21",r:".5",key:"yhc1fs"}],["circle",{cx:"20",cy:"8",r:".5",key:"1e43v0"}]],Fh=Ut("brain-circuit",ppe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mpe=[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]],yB=Ut("brain",mpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gpe=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],ype=Ut("calendar",gpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bpe=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],so=Ut("check",bpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vpe=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Jl=Ut("chevron-down",vpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xpe=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],wpe=Ut("chevron-left",xpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _pe=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],IP=Ut("chevron-right",_pe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Spe=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],Lh=Ut("chevron-up",Spe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cpe=[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]],cE=Ut("chevrons-up-down",Cpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kpe=[["path",{d:"m17 11-5-5-5 5",key:"e8nh98"}],["path",{d:"m17 18-5-5-5 5",key:"2avn1x"}]],Epe=Ut("chevrons-up",kpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tpe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Rc=Ut("circle-alert",Tpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ape=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Rpe=Ut("circle-check-big",Ape);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Npe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],uE=Ut("circle-check",Npe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mpe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["rect",{x:"9",y:"9",width:"6",height:"6",rx:"1",key:"1ssd4o"}]],Ipe=Ut("circle-stop",Mpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jpe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Ppe=Ut("circle",jpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ope=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],Dpe=Ut("circle-x",Ope);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fpe=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]],dE=Ut("clipboard",Fpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lpe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]],Bpe=Ut("clock",Lpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $pe=[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]],jP=Ut("cloud-upload",$pe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zpe=[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]],lH=Ut("code",zpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Upe=[["path",{d:"M12 20a8 8 0 1 0 0-16 8 8 0 0 0 0 16Z",key:"sobvz5"}],["path",{d:"M12 14a2 2 0 1 0 0-4 2 2 0 0 0 0 4Z",key:"11i496"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 22v-2",key:"1osdcq"}],["path",{d:"m17 20.66-1-1.73",key:"eq3orb"}],["path",{d:"M11 10.27 7 3.34",key:"16pf9h"}],["path",{d:"m20.66 17-1.73-1",key:"sg0v6f"}],["path",{d:"m3.34 7 1.73 1",key:"1ulond"}],["path",{d:"M14 12h8",key:"4f43i9"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"m20.66 7-1.73 1",key:"1ow05n"}],["path",{d:"m3.34 17 1.73-1",key:"nuk764"}],["path",{d:"m17 3.34-1 1.73",key:"2wel8s"}],["path",{d:"m11 13.73-4 6.93",key:"794ttg"}]],qpe=Ut("cog",Upe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vpe=[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]],Wpe=Ut("coins",Vpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hpe=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],Gpe=Ut("copy",Hpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kpe=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],Ype=Ut("dollar-sign",Kpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zpe=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]],xu=Ut("download",Zpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xpe=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]],Jpe=Ut("ellipsis-vertical",Xpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qpe=[["path",{d:"M10 12v-1",key:"v7bkov"}],["path",{d:"M10 18v-2",key:"1cjy8d"}],["path",{d:"M10 7V6",key:"dljcrl"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M15.5 22H18a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v16a2 2 0 0 0 .274 1.01",key:"gkbcor"}],["circle",{cx:"10",cy:"20",r:"2",key:"1xzdoj"}]],eme=Ut("file-archive",Qpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tme=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]],nme=Ut("file-down",tme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rme=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 12a1 1 0 0 0-1 1v1a1 1 0 0 1-1 1 1 1 0 0 1 1 1v1a1 1 0 0 0 1 1",key:"1oajmo"}],["path",{d:"M14 18a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1 1 1 0 0 1-1-1v-1a1 1 0 0 0-1-1",key:"mpwhp6"}]],sme=Ut("file-json",rme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ime=[["path",{d:"M12 17h.01",key:"p32p05"}],["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7z",key:"1mlx9k"}],["path",{d:"M9.1 9a3 3 0 0 1 5.82 1c0 2-3 3-3 3",key:"mhlwft"}]],ame=Ut("file-question",ime);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ome=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],lme=Ut("file-text",ome);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cme=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 12v6",key:"3ahymv"}],["path",{d:"m15 15-3-3-3 3",key:"15xj92"}]],ume=Ut("file-up",cme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dme=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]],cH=Ut("file",dme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fme=[["circle",{cx:"12",cy:"13",r:"2",key:"1c1ljs"}],["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}],["path",{d:"M14 13h3",key:"1dgedf"}],["path",{d:"M7 13h3",key:"1pygq7"}]],uH=Ut("folder-git",fme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hme=[["path",{d:"M12 10v6",key:"1bos4e"}],["path",{d:"M9 13h6",key:"1uhe8q"}],["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],dH=Ut("folder-plus",hme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pme=[["path",{d:"M20 10a1 1 0 0 0 1-1V6a1 1 0 0 0-1-1h-2.5a1 1 0 0 1-.8-.4l-.9-1.2A1 1 0 0 0 15 3h-2a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1Z",key:"hod4my"}],["path",{d:"M20 21a1 1 0 0 0 1-1v-3a1 1 0 0 0-1-1h-2.9a1 1 0 0 1-.88-.55l-.42-.85a1 1 0 0 0-.92-.6H13a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1Z",key:"w4yl2u"}],["path",{d:"M3 5a2 2 0 0 0 2 2h3",key:"f2jnh7"}],["path",{d:"M3 3v13a2 2 0 0 0 2 2h3",key:"k8epm1"}]],bB=Ut("folder-tree",pme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mme=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}],["path",{d:"M12 10v6",key:"1bos4e"}],["path",{d:"m9 13 3-3 3 3",key:"1pxg3c"}]],gme=Ut("folder-up",mme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yme=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],ph=Ut("folder",yme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bme=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],PP=Ut("funnel",bme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vme=[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]],Nc=Ut("git-branch",vme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xme=[["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}],["line",{x1:"3",x2:"9",y1:"12",y2:"12",key:"1dyftd"}],["line",{x1:"15",x2:"21",y1:"12",y2:"12",key:"oup4p8"}]],fH=Ut("git-commit-horizontal",xme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wme=[["circle",{cx:"18",cy:"18",r:"3",key:"1xkwt0"}],["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M6 21V9a9 9 0 0 0 9 9",key:"7kw0sc"}]],hH=Ut("git-merge",wme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _me=[["circle",{cx:"18",cy:"18",r:"3",key:"1xkwt0"}],["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M13 6h3a2 2 0 0 1 2 2v7",key:"1yeb86"}],["line",{x1:"6",x2:"6",y1:"9",y2:"21",key:"rroup"}]],OP=Ut("git-pull-request",_me);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sme=[["path",{d:"M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4",key:"tonef"}],["path",{d:"M9 18c-4.51 2-5-2-7-2",key:"9comsn"}]],Cme=Ut("github",Sme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kme=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],vB=Ut("globe",kme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eme=[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]],Tme=Ut("grip-vertical",Eme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ame=[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]],DP=Ut("hard-drive",Ame);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rme=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],Nme=Ut("history",Rme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mme=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]],Ime=Ut("house",Mme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jme=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],mm=Ut("image",jme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pme=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],FP=Ut("info",Pme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ome=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],Bx=Ut("key",Ome);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dme=[["path",{d:"m12 8 6-3-6-3v10",key:"mvpnpy"}],["path",{d:"m8 11.99-5.5 3.14a1 1 0 0 0 0 1.74l8.5 4.86a2 2 0 0 0 2 0l8.5-4.86a1 1 0 0 0 0-1.74L16 12",key:"ek95tt"}],["path",{d:"m6.49 12.85 11.02 6.3",key:"1kt42w"}],["path",{d:"M17.51 12.85 6.5 19.15",key:"v55bdg"}]],pH=Ut("land-plot",Dme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fme=[["path",{d:"M21 6H3",key:"1jwq7v"}],["path",{d:"M7 12H3",key:"13ou7f"}],["path",{d:"M7 18H3",key:"1sijw9"}],["path",{d:"M12 18a5 5 0 0 0 9-3 4.5 4.5 0 0 0-4.5-4.5c-1.33 0-2.54.54-3.41 1.41L11 14",key:"qth677"}],["path",{d:"M11 10v4h4",key:"172dkj"}]],Lme=Ut("list-restart",Fme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bme=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Qn=Ut("loader-circle",Bme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $me=[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]],zme=Ut("menu",$me);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ume=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}],["path",{d:"M12 7v6",key:"lw1j43"}],["path",{d:"M9 10h6",key:"9gxzsh"}]],qme=Ut("message-square-plus",Ume);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vme=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}],["path",{d:"M13 8H7",key:"14i4kc"}],["path",{d:"M17 12H7",key:"16if0g"}]],xB=Ut("message-square-text",Vme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wme=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]],V3=Ut("message-square",Wme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hme=[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]],Gme=Ut("music",Hme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kme=[["path",{d:"M13.4 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-7.4",key:"re6nr2"}],["path",{d:"M2 6h4",key:"aawbzj"}],["path",{d:"M2 10h4",key:"l0bgd4"}],["path",{d:"M2 14h4",key:"1gsvsf"}],["path",{d:"M2 18h4",key:"1bu2t1"}],["path",{d:"M21.378 5.626a1 1 0 1 0-3.004-3.004l-5.01 5.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z",key:"pqwjuv"}]],mH=Ut("notebook-pen",Kme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yme=[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]],tC=Ut("palette",Yme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zme=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"m16 15-3-3 3-3",key:"14y99z"}]],Xme=Ut("panel-left-close",Zme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jme=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M15 3v18",key:"14nvp0"}],["path",{d:"m8 9 3 3-3 3",key:"12hl5m"}]],Qme=Ut("panel-right-close",Jme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ege=[["path",{d:"M13.234 20.252 21 12.3",key:"1cbrk9"}],["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 0 2.828 2 2 0 0 0 2.828 0l8.414-8.586a4 4 0 0 0 0-5.656 4 4 0 0 0-5.656 0l-8.415 8.585a6 6 0 1 0 8.486 8.486",key:"1pkts6"}]],fE=Ut("paperclip",ege);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tge=[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]],nge=Ut("pause",tge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rge=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],o1=Ut("pen",rge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sge=[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]],ige=Ut("play",sge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const age=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Ru=Ut("plus",age);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oge=[["path",{d:"M15.39 4.39a1 1 0 0 0 1.68-.474 2.5 2.5 0 1 1 3.014 3.015 1 1 0 0 0-.474 1.68l1.683 1.682a2.414 2.414 0 0 1 0 3.414L19.61 15.39a1 1 0 0 1-1.68-.474 2.5 2.5 0 1 0-3.014 3.015 1 1 0 0 1 .474 1.68l-1.683 1.682a2.414 2.414 0 0 1-3.414 0L8.61 19.61a1 1 0 0 0-1.68.474 2.5 2.5 0 1 1-3.014-3.015 1 1 0 0 0 .474-1.68l-1.683-1.682a2.414 2.414 0 0 1 0-3.414L4.39 8.61a1 1 0 0 1 1.68.474 2.5 2.5 0 1 0 3.014-3.015 1 1 0 0 1-.474-1.68l1.683-1.682a2.414 2.414 0 0 1 3.414 0z",key:"w46dr5"}]],wB=Ut("puzzle",oge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lge=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],gm=Ut("refresh-cw",lge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cge=[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]],uge=Ut("rocket",cge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dge=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],l1=Ut("rotate-ccw",dge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fge=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],Qd=Ut("save",fge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hge=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]],Fa=Ut("search",hge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pge=[["path",{d:"M3.714 3.048a.498.498 0 0 0-.683.627l2.843 7.627a2 2 0 0 1 0 1.396l-2.842 7.627a.498.498 0 0 0 .682.627l18-8.5a.5.5 0 0 0 0-.904z",key:"117uat"}],["path",{d:"M6 12h16",key:"s4cdu5"}]],mge=Ut("send-horizontal",pge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gge=[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]],G0=Ut("server",gge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yge=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],nC=Ut("settings",yge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bge=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]],_B=Ut("shield-alert",bge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vge=[["line",{x1:"21",x2:"14",y1:"4",y2:"4",key:"obuewd"}],["line",{x1:"10",x2:"3",y1:"4",y2:"4",key:"1q6298"}],["line",{x1:"21",x2:"12",y1:"12",y2:"12",key:"1iu8h1"}],["line",{x1:"8",x2:"3",y1:"12",y2:"12",key:"ntss68"}],["line",{x1:"21",x2:"16",y1:"20",y2:"20",key:"14d8ph"}],["line",{x1:"12",x2:"3",y1:"20",y2:"20",key:"m0wm8r"}],["line",{x1:"14",x2:"14",y1:"2",y2:"6",key:"14e1ph"}],["line",{x1:"8",x2:"8",y1:"10",y2:"14",key:"1i6ji0"}],["line",{x1:"16",x2:"16",y1:"18",y2:"22",key:"1lctlv"}]],xge=Ut("sliders-horizontal",vge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wge=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]],_ge=Ut("smile",wge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sge=[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]],gH=Ut("sparkles",Sge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cge=[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}]],SB=Ut("sparkle",Cge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kge=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],dh=Ut("square-pen",kge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ege=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],Tge=Ut("square",Ege);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Age=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],Rge=Ut("star",Age);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nge=[["path",{d:"m15 5 6.3 6.3a2.4 2.4 0 0 1 0 3.4L17 19",key:"1cbfv1"}],["path",{d:"M9.586 5.586A2 2 0 0 0 8.172 5H3a1 1 0 0 0-1 1v5.172a2 2 0 0 0 .586 1.414L8.29 18.29a2.426 2.426 0 0 0 3.42 0l3.58-3.58a2.426 2.426 0 0 0 0-3.42z",key:"135mg7"}],["circle",{cx:"6.5",cy:"9.5",r:".5",fill:"currentColor",key:"5pm5xn"}]],W3=Ut("tags",Nge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mge=[["path",{d:"M17 6.1H3",key:"wptmhv"}],["path",{d:"M21 12.1H3",key:"1j38uz"}],["path",{d:"M15.1 18H3",key:"1nb16a"}]],Ige=Ut("text",Mge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jge=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],Ao=Ut("trash-2",jge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pge=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]],Oge=Ut("trash",Pge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dge=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],LP=Ut("triangle-alert",Dge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fge=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]],yH=Ut("upload",Fge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lge=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],Bge=Ut("user",Lge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $ge=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]],CB=Ut("users",$ge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zge=[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]],Uge=Ut("video",zge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qge=[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]],ym=Ut("wrench",qge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vge=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],qi=Ut("x",Vge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wge=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],Hge=Ut("zap",Wge),kB=({controls:e,area:t,className:n})=>{const r=e.filter(s=>t==="trigger"?!!s.triggerRenderer:!!s.renderer);return r.length===0?null:f.jsx("div",{className:Ze(n),children:r.map(s=>{var a,o;const i=t==="trigger"?(a=s.triggerRenderer)==null?void 0:a.call(s):(o=s.renderer)==null?void 0:o.call(s);return i?f.jsx(We.Fragment,{children:i},s.id):null})})},EB=e=>{let t;const n=new Set,r=(c,u)=>{const d=typeof c=="function"?c(t):c;if(!Object.is(d,t)){const h=t;t=u??(typeof d!="object"||d===null)?d:Object.assign({},t,d),n.forEach(m=>m(t,h))}},s=()=>t,o={setState:r,getState:s,getInitialState:()=>l,subscribe:c=>(n.add(c),()=>n.delete(c))},l=t=e(r,s,o);return o},Gge=e=>e?EB(e):EB,Kge=e=>e;function Yge(e,t=Kge){const n=We.useSyncExternalStore(e.subscribe,()=>t(e.getState()),()=>t(e.getInitialState()));return We.useDebugValue(n),n}const TB=e=>{const t=Gge(e),n=r=>Yge(t,r);return Object.assign(n,t),n},$o=e=>e?TB(e):TB;var bH=Symbol.for("immer-nothing"),AB=Symbol.for("immer-draftable"),cs=Symbol.for("immer-state");function Vl(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var K0=Object.getPrototypeOf;function Y0(e){return!!e&&!!e[cs]}function zd(e){var t;return e?vH(e)||Array.isArray(e)||!!e[AB]||!!((t=e.constructor)!=null&&t[AB])||pE(e)||mE(e):!1}var Zge=Object.prototype.constructor.toString();function vH(e){if(!e||typeof e!="object")return!1;const t=K0(e);if(t===null)return!0;const n=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return n===Object?!0:typeof n=="function"&&Function.toString.call(n)===Zge}function $x(e,t){hE(e)===0?Reflect.ownKeys(e).forEach(n=>{t(n,e[n],e)}):e.forEach((n,r)=>t(r,n,e))}function hE(e){const t=e[cs];return t?t.type_:Array.isArray(e)?1:pE(e)?2:mE(e)?3:0}function H3(e,t){return hE(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function xH(e,t,n){const r=hE(e);r===2?e.set(t,n):r===3?e.add(n):e[t]=n}function Xge(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function pE(e){return e instanceof Map}function mE(e){return e instanceof Set}function ea(e){return e.copy_||e.base_}function G3(e,t){if(pE(e))return new Map(e);if(mE(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const n=vH(e);if(t===!0||t==="class_only"&&!n){const r=Object.getOwnPropertyDescriptors(e);delete r[cs];let s=Reflect.ownKeys(r);for(let i=0;i<s.length;i++){const a=s[i],o=r[a];o.writable===!1&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(r[a]={configurable:!0,writable:!0,enumerable:o.enumerable,value:e[a]})}return Object.create(K0(e),r)}else{const r=K0(e);if(r!==null&&n)return{...e};const s=Object.create(r);return Object.assign(s,e)}}function BP(e,t=!1){return gE(e)||Y0(e)||!zd(e)||(hE(e)>1&&(e.set=e.add=e.clear=e.delete=Jge),Object.freeze(e),t&&Object.entries(e).forEach(([n,r])=>BP(r,!0))),e}function Jge(){Vl(2)}function gE(e){return Object.isFrozen(e)}var K3={};function bm(e){const t=K3[e];return t||Vl(0,e),t}function Qge(e,t){K3[e]||(K3[e]=t)}var zx;function rC(){return zx}function e0e(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function RB(e,t){t&&(bm("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function Y3(e){Z3(e),e.drafts_.forEach(t0e),e.drafts_=null}function Z3(e){e===zx&&(zx=e.parent_)}function NB(e){return zx=e0e(zx,e)}function t0e(e){const t=e[cs];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function MB(e,t){t.unfinalizedDrafts_=t.drafts_.length;const n=t.drafts_[0];return e!==void 0&&e!==n?(n[cs].modified_&&(Y3(t),Vl(4)),zd(e)&&(e=sC(t,e),t.parent_||iC(t,e)),t.patches_&&bm("Patches").generateReplacementPatches_(n[cs].base_,e,t.patches_,t.inversePatches_)):e=sC(t,n,[]),Y3(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==bH?e:void 0}function sC(e,t,n){if(gE(t))return t;const r=t[cs];if(!r)return $x(t,(s,i)=>IB(e,r,t,s,i,n)),t;if(r.scope_!==e)return t;if(!r.modified_)return iC(e,r.base_,!0),r.base_;if(!r.finalized_){r.finalized_=!0,r.scope_.unfinalizedDrafts_--;const s=r.copy_;let i=s,a=!1;r.type_===3&&(i=new Set(s),s.clear(),a=!0),$x(i,(o,l)=>IB(e,r,s,o,l,n,a)),iC(e,s,!1),n&&e.patches_&&bm("Patches").generatePatches_(r,n,e.patches_,e.inversePatches_)}return r.copy_}function IB(e,t,n,r,s,i,a){if(Y0(s)){const o=i&&t&&t.type_!==3&&!H3(t.assigned_,r)?i.concat(r):void 0,l=sC(e,s,o);if(xH(n,r,l),Y0(l))e.canAutoFreeze_=!1;else return}else a&&n.add(s);if(zd(s)&&!gE(s)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;sC(e,s),(!t||!t.scope_.parent_)&&typeof r!="symbol"&&Object.prototype.propertyIsEnumerable.call(n,r)&&iC(e,s)}}function iC(e,t,n=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&BP(t,n)}function n0e(e,t){const n=Array.isArray(e),r={type_:n?1:0,scope_:t?t.scope_:rC(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let s=r,i=$P;n&&(s=[r],i=Ux);const{revoke:a,proxy:o}=Proxy.revocable(s,i);return r.draft_=o,r.revoke_=a,o}var $P={get(e,t){if(t===cs)return e;const n=ea(e);if(!H3(n,t))return r0e(e,n,t);const r=n[t];return e.finalized_||!zd(r)?r:r===fN(e.base_,t)?(hN(e),e.copy_[t]=qx(r,e)):r},has(e,t){return t in ea(e)},ownKeys(e){return Reflect.ownKeys(ea(e))},set(e,t,n){const r=wH(ea(e),t);if(r!=null&&r.set)return r.set.call(e.draft_,n),!0;if(!e.modified_){const s=fN(ea(e),t),i=s==null?void 0:s[cs];if(i&&i.base_===n)return e.copy_[t]=n,e.assigned_[t]=!1,!0;if(Xge(n,s)&&(n!==void 0||H3(e.base_,t)))return!0;hN(e),Sd(e)}return e.copy_[t]===n&&(n!==void 0||t in e.copy_)||Number.isNaN(n)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=n,e.assigned_[t]=!0),!0},deleteProperty(e,t){return fN(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,hN(e),Sd(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const n=ea(e),r=Reflect.getOwnPropertyDescriptor(n,t);return r&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:r.enumerable,value:n[t]}},defineProperty(){Vl(11)},getPrototypeOf(e){return K0(e.base_)},setPrototypeOf(){Vl(12)}},Ux={};$x($P,(e,t)=>{Ux[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});Ux.deleteProperty=function(e,t){return Ux.set.call(this,e,t,void 0)};Ux.set=function(e,t,n){return $P.set.call(this,e[0],t,n,e[0])};function fN(e,t){const n=e[cs];return(n?ea(n):e)[t]}function r0e(e,t,n){var s;const r=wH(t,n);return r?"value"in r?r.value:(s=r.get)==null?void 0:s.call(e.draft_):void 0}function wH(e,t){if(!(t in e))return;let n=K0(e);for(;n;){const r=Object.getOwnPropertyDescriptor(n,t);if(r)return r;n=K0(n)}}function Sd(e){e.modified_||(e.modified_=!0,e.parent_&&Sd(e.parent_))}function hN(e){e.copy_||(e.copy_=G3(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var s0e=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(t,n,r)=>{if(typeof t=="function"&&typeof n!="function"){const i=n;n=t;const a=this;return function(l=i,...c){return a.produce(l,u=>n.call(this,u,...c))}}typeof n!="function"&&Vl(6),r!==void 0&&typeof r!="function"&&Vl(7);let s;if(zd(t)){const i=NB(this),a=qx(t,void 0);let o=!0;try{s=n(a),o=!1}finally{o?Y3(i):Z3(i)}return RB(i,r),MB(s,i)}else if(!t||typeof t!="object"){if(s=n(t),s===void 0&&(s=t),s===bH&&(s=void 0),this.autoFreeze_&&BP(s,!0),r){const i=[],a=[];bm("Patches").generateReplacementPatches_(t,s,i,a),r(i,a)}return s}else Vl(1,t)},this.produceWithPatches=(t,n)=>{if(typeof t=="function")return(a,...o)=>this.produceWithPatches(a,l=>t(l,...o));let r,s;return[this.produce(t,n,(a,o)=>{r=a,s=o}),r,s]},typeof(e==null?void 0:e.autoFreeze)=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof(e==null?void 0:e.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){zd(e)||Vl(8),Y0(e)&&(e=i0e(e));const t=NB(this),n=qx(e,void 0);return n[cs].isManual_=!0,Z3(t),n}finishDraft(e,t){const n=e&&e[cs];(!n||!n.isManual_)&&Vl(9);const{scope_:r}=n;return RB(r,t),MB(void 0,r)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let n;for(n=t.length-1;n>=0;n--){const s=t[n];if(s.path.length===0&&s.op==="replace"){e=s.value;break}}n>-1&&(t=t.slice(n+1));const r=bm("Patches").applyPatches_;return Y0(e)?r(e,t):this.produce(e,s=>r(s,t))}};function qx(e,t){const n=pE(e)?bm("MapSet").proxyMap_(e,t):mE(e)?bm("MapSet").proxySet_(e,t):n0e(e,t);return(t?t.scope_:rC()).drafts_.push(n),n}function i0e(e){return Y0(e)||Vl(10,e),_H(e)}function _H(e){if(!zd(e)||gE(e))return e;const t=e[cs];let n;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,n=G3(e,t.scope_.immer_.useStrictShallowCopy_)}else n=G3(e,!0);return $x(n,(r,s)=>{xH(n,r,_H(s))}),t&&(t.finalized_=!1),n}function a0e(){class e extends Map{constructor(l,c){super(),this[cs]={type_:2,parent_:c,scope_:c?c.scope_:rC(),modified_:!1,finalized_:!1,copy_:void 0,assigned_:void 0,base_:l,draft_:this,isManual_:!1,revoked_:!1}}get size(){return ea(this[cs]).size}has(l){return ea(this[cs]).has(l)}set(l,c){const u=this[cs];return a(u),(!ea(u).has(l)||ea(u).get(l)!==c)&&(n(u),Sd(u),u.assigned_.set(l,!0),u.copy_.set(l,c),u.assigned_.set(l,!0)),this}delete(l){if(!this.has(l))return!1;const c=this[cs];return a(c),n(c),Sd(c),c.base_.has(l)?c.assigned_.set(l,!1):c.assigned_.delete(l),c.copy_.delete(l),!0}clear(){const l=this[cs];a(l),ea(l).size&&(n(l),Sd(l),l.assigned_=new Map,$x(l.base_,c=>{l.assigned_.set(c,!1)}),l.copy_.clear())}forEach(l,c){const u=this[cs];ea(u).forEach((d,h,m)=>{l.call(c,this.get(h),h,this)})}get(l){const c=this[cs];a(c);const u=ea(c).get(l);if(c.finalized_||!zd(u)||u!==c.base_.get(l))return u;const d=qx(u,c);return n(c),c.copy_.set(l,d),d}keys(){return ea(this[cs]).keys()}values(){const l=this.keys();return{[Symbol.iterator]:()=>this.values(),next:()=>{const c=l.next();return c.done?c:{done:!1,value:this.get(c.value)}}}}entries(){const l=this.keys();return{[Symbol.iterator]:()=>this.entries(),next:()=>{const c=l.next();if(c.done)return c;const u=this.get(c.value);return{done:!1,value:[c.value,u]}}}}[Symbol.iterator](){return this.entries()}}function t(o,l){return new e(o,l)}function n(o){o.copy_||(o.assigned_=new Map,o.copy_=new Map(o.base_))}class r extends Set{constructor(l,c){super(),this[cs]={type_:3,parent_:c,scope_:c?c.scope_:rC(),modified_:!1,finalized_:!1,copy_:void 0,base_:l,draft_:this,drafts_:new Map,revoked_:!1,isManual_:!1}}get size(){return ea(this[cs]).size}has(l){const c=this[cs];return a(c),c.copy_?!!(c.copy_.has(l)||c.drafts_.has(l)&&c.copy_.has(c.drafts_.get(l))):c.base_.has(l)}add(l){const c=this[cs];return a(c),this.has(l)||(i(c),Sd(c),c.copy_.add(l)),this}delete(l){if(!this.has(l))return!1;const c=this[cs];return a(c),i(c),Sd(c),c.copy_.delete(l)||(c.drafts_.has(l)?c.copy_.delete(c.drafts_.get(l)):!1)}clear(){const l=this[cs];a(l),ea(l).size&&(i(l),Sd(l),l.copy_.clear())}values(){const l=this[cs];return a(l),i(l),l.copy_.values()}entries(){const l=this[cs];return a(l),i(l),l.copy_.entries()}keys(){return this.values()}[Symbol.iterator](){return this.values()}forEach(l,c){const u=this.values();let d=u.next();for(;!d.done;)l.call(c,d.value,d.value,this),d=u.next()}}function s(o,l){return new r(o,l)}function i(o){o.copy_||(o.copy_=new Set,o.base_.forEach(l=>{if(zd(l)){const c=qx(l,o);o.drafts_.set(l,c),o.copy_.add(c)}else o.copy_.add(l)}))}function a(o){o.revoked_&&Vl(3,JSON.stringify(ea(o)))}Qge("MapSet",{proxyMap_:t,proxySet_:s})}var pl=new s0e,o0e=pl.produce;pl.produceWithPatches.bind(pl);pl.setAutoFreeze.bind(pl);pl.setUseStrictShallowCopy.bind(pl);pl.applyPatches.bind(pl);pl.createDraft.bind(pl);pl.finishDraft.bind(pl);const l0e=e=>(t,n,r)=>(r.setState=(s,i,...a)=>{const o=typeof s=="function"?o0e(s):s;return t(o,i,...a)},e(r.setState,n,r)),zo=l0e;function c0e(e){return{all:e=e||new Map,on:function(t,n){var r=e.get(t);r?r.push(n):e.set(t,[n])},off:function(t,n){var r=e.get(t);r&&(n?r.splice(r.indexOf(n)>>>0,1):e.set(t,[]))},emit:function(t,n){var r=e.get(t);r&&r.slice().map(function(s){s(n)}),(r=e.get("*"))&&r.slice().map(function(s){s(t,n)})}}}const Pe=c0e(),$r={promptControlsChanged:"control.registry.prompt.controls.changed",chatControlsChanged:"control.registry.chat.controls.changed",canvasControlsChanged:"control.registry.canvas.controls.changed",middlewareChanged:"control.registry.middleware.changed",toolsChanged:"control.registry.tools.changed",modalProvidersChanged:"control.registry.modal.providers.changed",registerPromptControlRequest:"control.registry.register.prompt.control.request",unregisterPromptControlRequest:"control.registry.unregister.prompt.control.request",registerChatControlRequest:"control.registry.register.chat.control.request",unregisterChatControlRequest:"control.registry.unregister.chat.control.request",registerCanvasControlRequest:"control.registry.register.canvas.control.request",unregisterCanvasControlRequest:"control.registry.unregister.canvas.control.request",registerMiddlewareRequest:"control.registry.register.middleware.request",unregisterMiddlewareRequest:"control.registry.unregister.middleware.request",registerToolRequest:"control.registry.register.tool.request",unregisterToolRequest:"control.registry.unregister.tool.request",registerModalProviderRequest:"control.registry.register.modal.provider.request",unregisterModalProviderRequest:"control.registry.unregister.modal.provider.request"},jo=$o(zo((e,t)=>({promptControls:{},chatControls:{},canvasControls:{},middlewareRegistry:{},tools:{},modalProviders:{},registerPromptControl:n=>(e(r=>{r.promptControls[n.id]&&console.warn(`ControlRegistryStore: PromptControl with ID "${n.id}" already registered. Overwriting.`),r.promptControls[n.id]=n}),Pe.emit($r.promptControlsChanged,{controls:t().promptControls}),()=>t().unregisterPromptControl(n.id)),unregisterPromptControl:n=>{e(r=>{r.promptControls[n]?delete r.promptControls[n]:console.warn(`ControlRegistryStore: PromptControl with ID "${n}" not found for unregistration.`)}),Pe.emit($r.promptControlsChanged,{controls:t().promptControls})},registerChatControl:n=>(e(r=>{r.chatControls[n.id]&&console.warn(`ControlRegistryStore: ChatControl with ID "${n.id}" already registered. Overwriting.`),r.chatControls[n.id]=n}),Pe.emit($r.chatControlsChanged,{controls:t().chatControls}),()=>t().unregisterChatControl(n.id)),unregisterChatControl:n=>{e(r=>{r.chatControls[n]?delete r.chatControls[n]:console.warn(`ControlRegistryStore: ChatControl with ID "${n}" not found for unregistration.`)}),Pe.emit($r.chatControlsChanged,{controls:t().chatControls})},registerCanvasControl:n=>(e(r=>{r.canvasControls[n.id]&&console.warn(`ControlRegistryStore: CanvasControl with ID "${n.id}" already registered. Overwriting.`),r.canvasControls[n.id]=n}),Pe.emit($r.canvasControlsChanged,{controls:t().canvasControls}),()=>t().unregisterCanvasControl(n.id)),unregisterCanvasControl:n=>{e(r=>{r.canvasControls[n]?delete r.canvasControls[n]:console.warn(`ControlRegistryStore: CanvasControl with ID "${n}" not found for unregistration.`)}),Pe.emit($r.canvasControlsChanged,{controls:t().canvasControls})},registerMiddleware:(n,r,s,i=0)=>{const a={modId:r,callback:s,order:i};return e(o=>{o.middlewareRegistry[n]||(o.middlewareRegistry[n]=[]),o.middlewareRegistry[n].push(a),o.middlewareRegistry[n].sort((l,c)=>(l.order??0)-(c.order??0))}),Pe.emit($r.middlewareChanged,{middleware:t().middlewareRegistry}),()=>t().unregisterMiddleware(n,r,s)},unregisterMiddleware:(n,r,s)=>{e(i=>{var a;i.middlewareRegistry[n]?(i.middlewareRegistry[n]=i.middlewareRegistry[n].filter(o=>!(o.modId===r&&o.callback===s)),((a=i.middlewareRegistry[n])==null?void 0:a.length)===0&&delete i.middlewareRegistry[n]):console.warn(`ControlRegistryStore: Middleware hook "${n}" not found for unregistration.`)}),Pe.emit($r.middlewareChanged,{middleware:t().middlewareRegistry})},getMiddlewareForHook:n=>{const r=t().middlewareRegistry[n]??[];return Object.freeze([...r].sort((s,i)=>(s.order??0)-(i.order??0)))},registerTool:(n,r,s,i)=>(e(a=>{a.tools[r]&&console.warn(`ControlRegistryStore: Tool "${r}" already registered by mod "${a.tools[r].modId}". Overwriting with registration from mod "${n}".`),a.tools[r]={definition:s,implementation:i,modId:n}}),Pe.emit($r.toolsChanged,{tools:t().tools}),()=>t().unregisterTool(r)),unregisterTool:n=>{e(r=>{r.tools[n]?delete r.tools[n]:console.warn(`ControlRegistryStore: Tool "${n}" not found for unregistration.`)}),Pe.emit($r.toolsChanged,{tools:t().tools})},getRegisteredTools:()=>Object.freeze({...t().tools}),registerModalProvider:(n,r)=>(e(s=>{s.modalProviders[n]&&console.warn(`ControlRegistryStore: ModalProvider with ID "${n}" already registered. Overwriting.`),s.modalProviders[n]=r}),Pe.emit($r.modalProvidersChanged,{providers:t().modalProviders}),()=>t().unregisterModalProvider(n)),unregisterModalProvider:n=>{e(r=>{r.modalProviders[n]?delete r.modalProviders[n]:console.warn(`ControlRegistryStore: ModalProvider with ID "${n}" not found for unregistration.`)}),Pe.emit($r.modalProvidersChanged,{providers:t().modalProviders})},getRegisteredActionHandlers:()=>{const n="controlRegistryStore",r=t();return[{eventName:$r.registerPromptControlRequest,handler:s=>{r.registerPromptControl(s.control)},storeId:n},{eventName:$r.unregisterPromptControlRequest,handler:s=>{r.unregisterPromptControl(s.id)},storeId:n},{eventName:$r.registerChatControlRequest,handler:s=>{r.registerChatControl(s.control)},storeId:n},{eventName:$r.unregisterChatControlRequest,handler:s=>{r.unregisterChatControl(s.id)},storeId:n},{eventName:$r.registerCanvasControlRequest,handler:s=>{r.registerCanvasControl(s.control)},storeId:n},{eventName:$r.unregisterCanvasControlRequest,handler:s=>{r.unregisterCanvasControl(s.id)},storeId:n},{eventName:$r.registerMiddlewareRequest,handler:s=>{r.registerMiddleware(s.hookName,s.modId,s.callback,s.order)},storeId:n},{eventName:$r.unregisterMiddlewareRequest,handler:s=>{r.unregisterMiddleware(s.hookName,s.modId,s.callback)},storeId:n},{eventName:$r.registerToolRequest,handler:s=>{r.registerTool(s.modId,s.toolName,s.definition,s.implementation)},storeId:n},{eventName:$r.unregisterToolRequest,handler:s=>{r.unregisterTool(s.toolName)},storeId:n},{eventName:$r.registerModalProviderRequest,handler:s=>{r.registerModalProvider(s.modalId,s.provider)},storeId:n},{eventName:$r.unregisterModalProviderRequest,handler:s=>{r.unregisterModalProvider(s.modalId)},storeId:n}]}})));var S2={exports:{}},u0e=S2.exports,jB;function d0e(){return jB||(jB=1,function(e,t){(function(n,r){e.exports=r()})(u0e,function(){var n=function(M,z){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(te,ae){te.__proto__=ae}||function(te,ae){for(var he in ae)Object.prototype.hasOwnProperty.call(ae,he)&&(te[he]=ae[he])})(M,z)},r=function(){return(r=Object.assign||function(M){for(var z,te=1,ae=arguments.length;te<ae;te++)for(var he in z=arguments[te])Object.prototype.hasOwnProperty.call(z,he)&&(M[he]=z[he]);return M}).apply(this,arguments)};function s(M,z,te){for(var ae,he=0,Ee=z.length;he<Ee;he++)!ae&&he in z||((ae=ae||Array.prototype.slice.call(z,0,he))[he]=z[he]);return M.concat(ae||Array.prototype.slice.call(z))}var i=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:Xp,a=Object.keys,o=Array.isArray;function l(M,z){return typeof z!="object"||a(z).forEach(function(te){M[te]=z[te]}),M}typeof Promise>"u"||i.Promise||(i.Promise=Promise);var c=Object.getPrototypeOf,u={}.hasOwnProperty;function d(M,z){return u.call(M,z)}function h(M,z){typeof z=="function"&&(z=z(c(M))),(typeof Reflect>"u"?a:Reflect.ownKeys)(z).forEach(function(te){y(M,te,z[te])})}var m=Object.defineProperty;function y(M,z,te,ae){m(M,z,l(te&&d(te,"get")&&typeof te.get=="function"?{get:te.get,set:te.set,configurable:!0}:{value:te,configurable:!0,writable:!0},ae))}function b(M){return{from:function(z){return M.prototype=Object.create(z.prototype),y(M.prototype,"constructor",M),{extend:h.bind(null,M.prototype)}}}}var v=Object.getOwnPropertyDescriptor,x=[].slice;function w(M,z,te){return x.call(M,z,te)}function S(M,z){return z(M)}function C(M){if(!M)throw new Error("Assertion Failed")}function k(M){i.setImmediate?setImmediate(M):setTimeout(M,0)}function A(M,z){if(typeof z=="string"&&d(M,z))return M[z];if(!z)return M;if(typeof z!="string"){for(var te=[],ae=0,he=z.length;ae<he;++ae){var Ee=A(M,z[ae]);te.push(Ee)}return te}var Le=z.indexOf(".");if(Le!==-1){var He=M[z.substr(0,Le)];return He==null?void 0:A(He,z.substr(Le+1))}}function R(M,z,te){if(M&&z!==void 0&&!("isFrozen"in Object&&Object.isFrozen(M)))if(typeof z!="string"&&"length"in z){C(typeof te!="string"&&"length"in te);for(var ae=0,he=z.length;ae<he;++ae)R(M,z[ae],te[ae])}else{var Ee,Le,He=z.indexOf(".");He!==-1?(Ee=z.substr(0,He),(Le=z.substr(He+1))===""?te===void 0?o(M)&&!isNaN(parseInt(Ee))?M.splice(Ee,1):delete M[Ee]:M[Ee]=te:R(He=!(He=M[Ee])||!d(M,Ee)?M[Ee]={}:He,Le,te)):te===void 0?o(M)&&!isNaN(parseInt(z))?M.splice(z,1):delete M[z]:M[z]=te}}function N(M){var z,te={};for(z in M)d(M,z)&&(te[z]=M[z]);return te}var I=[].concat;function P(M){return I.apply([],M)}var Pt="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(P([8,16,32,64].map(function(M){return["Int","Uint","Float"].map(function(z){return z+M+"Array"})}))).filter(function(M){return i[M]}),L=new Set(Pt.map(function(M){return i[M]})),O=null;function V(M){return O=new WeakMap,M=function z(te){if(!te||typeof te!="object")return te;var ae=O.get(te);if(ae)return ae;if(o(te)){ae=[],O.set(te,ae);for(var he=0,Ee=te.length;he<Ee;++he)ae.push(z(te[he]))}else if(L.has(te.constructor))ae=te;else{var Le,He=c(te);for(Le in ae=He===Object.prototype?{}:Object.create(He),O.set(te,ae),te)d(te,Le)&&(ae[Le]=z(te[Le]))}return ae}(M),O=null,M}var D={}.toString;function Z(M){return D.call(M).slice(8,-1)}var U=typeof Symbol<"u"?Symbol.iterator:"@@iterator",H=typeof U=="symbol"?function(M){var z;return M!=null&&(z=M[U])&&z.apply(M)}:function(){return null};function $(M,z){return z=M.indexOf(z),0<=z&&M.splice(z,1),0<=z}var ne={};function W(M){var z,te,ae,he;if(arguments.length===1){if(o(M))return M.slice();if(this===ne&&typeof M=="string")return[M];if(he=H(M)){for(te=[];!(ae=he.next()).done;)te.push(ae.value);return te}if(M==null)return[M];if(typeof(z=M.length)!="number")return[M];for(te=new Array(z);z--;)te[z]=M[z];return te}for(z=arguments.length,te=new Array(z);z--;)te[z]=arguments[z];return te}var Q=typeof Symbol<"u"?function(M){return M[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},ht=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],Ha=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(ht),ee={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function se(M,z){this.name=M,this.message=z}function pe(M,z){return M+". Errors: "+Object.keys(z).map(function(te){return z[te].toString()}).filter(function(te,ae,he){return he.indexOf(te)===ae}).join(`
`)}function ce(M,z,te,ae){this.failures=z,this.failedKeys=ae,this.successCount=te,this.message=pe(M,z)}function Ie(M,z){this.name="BulkError",this.failures=Object.keys(z).map(function(te){return z[te]}),this.failuresByPos=z,this.message=pe(M,this.failures)}b(se).from(Error).extend({toString:function(){return this.name+": "+this.message}}),b(ce).from(se),b(Ie).from(se);var De=Ha.reduce(function(M,z){return M[z]=z+"Error",M},{}),Se=se,Ce=Ha.reduce(function(M,z){var te=z+"Error";function ae(he,Ee){this.name=te,he?typeof he=="string"?(this.message="".concat(he).concat(Ee?`
 `+Ee:""),this.inner=Ee||null):typeof he=="object"&&(this.message="".concat(he.name," ").concat(he.message),this.inner=he):(this.message=ee[z]||te,this.inner=null)}return b(ae).from(Se),M[z]=ae,M},{});Ce.Syntax=SyntaxError,Ce.Type=TypeError,Ce.Range=RangeError;var qe=ht.reduce(function(M,z){return M[z+"Error"]=Ce[z],M},{}),Qe=Ha.reduce(function(M,z){return["Syntax","Type","Range"].indexOf(z)===-1&&(M[z+"Error"]=Ce[z]),M},{});function Ve(){}function Ne(M){return M}function K(M,z){return M==null||M===Ne?z:function(te){return z(M(te))}}function ge(M,z){return function(){M.apply(this,arguments),z.apply(this,arguments)}}function Ae(M,z){return M===Ve?z:function(){var te=M.apply(this,arguments);te!==void 0&&(arguments[0]=te);var ae=this.onsuccess,he=this.onerror;this.onsuccess=null,this.onerror=null;var Ee=z.apply(this,arguments);return ae&&(this.onsuccess=this.onsuccess?ge(ae,this.onsuccess):ae),he&&(this.onerror=this.onerror?ge(he,this.onerror):he),Ee!==void 0?Ee:te}}function le(M,z){return M===Ve?z:function(){M.apply(this,arguments);var te=this.onsuccess,ae=this.onerror;this.onsuccess=this.onerror=null,z.apply(this,arguments),te&&(this.onsuccess=this.onsuccess?ge(te,this.onsuccess):te),ae&&(this.onerror=this.onerror?ge(ae,this.onerror):ae)}}function oe(M,z){return M===Ve?z:function(te){var ae=M.apply(this,arguments);l(te,ae);var he=this.onsuccess,Ee=this.onerror;return this.onsuccess=null,this.onerror=null,te=z.apply(this,arguments),he&&(this.onsuccess=this.onsuccess?ge(he,this.onsuccess):he),Ee&&(this.onerror=this.onerror?ge(Ee,this.onerror):Ee),ae===void 0?te===void 0?void 0:te:l(ae,te)}}function re(M,z){return M===Ve?z:function(){return z.apply(this,arguments)!==!1&&M.apply(this,arguments)}}function Te(M,z){return M===Ve?z:function(){var te=M.apply(this,arguments);if(te&&typeof te.then=="function"){for(var ae=this,he=arguments.length,Ee=new Array(he);he--;)Ee[he]=arguments[he];return te.then(function(){return z.apply(ae,Ee)})}return z.apply(this,arguments)}}Qe.ModifyError=ce,Qe.DexieError=se,Qe.BulkError=Ie;var Be=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function ke(M){Be=M}var lt={},Rt=100,Pt=typeof Promise>"u"?[]:function(){var M=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[M,c(M),M];var z=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[z,c(z),M]}(),ht=Pt[0],Ha=Pt[1],Pt=Pt[2],Ha=Ha&&Ha.then,qt=ht&&ht.constructor,Lt=!!Pt,en=function(M,z){de.push([M,z]),F&&(queueMicrotask(fe),F=!1)},xe=!0,F=!0,X=[],ye=[],Fe=Ne,we={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:Ve,pgp:!1,env:{},finalize:Ve},Me=we,de=[],vt=0,ot=[];function B(M){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var z=this._PSD=Me;if(typeof M!="function"){if(M!==lt)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&be(this,this._value))}this._state=null,this._value=null,++z.ref,function te(ae,he){try{he(function(Ee){if(ae._state===null){if(Ee===ae)throw new TypeError("A promise cannot be resolved with itself.");var Le=ae._lib&&Y();Ee&&typeof Ee.then=="function"?te(ae,function(He,nt){Ee instanceof B?Ee._then(He,nt):Ee.then(He,nt)}):(ae._state=!0,ae._value=Ee,_e(ae)),Le&&G()}},be.bind(null,ae))}catch(Ee){be(ae,Ee)}}(this,M)}var ze={get:function(){var M=Me,z=Xt;function te(ae,he){var Ee=this,Le=!M.global&&(M!==Me||z!==Xt),He=Le&&!Rr(),nt=new B(function(it,dt){Ue(Ee,new st(Vt(ae,M,Le,He),Vt(he,M,Le,He),it,dt,M))});return this._consoleTask&&(nt._consoleTask=this._consoleTask),nt}return te.prototype=lt,te},set:function(M){y(this,"then",M&&M.prototype===lt?ze:{get:function(){return M},set:ze.set})}};function st(M,z,te,ae,he){this.onFulfilled=typeof M=="function"?M:null,this.onRejected=typeof z=="function"?z:null,this.resolve=te,this.reject=ae,this.psd=he}function be(M,z){var te,ae;ye.push(z),M._state===null&&(te=M._lib&&Y(),z=Fe(z),M._state=!1,M._value=z,ae=M,X.some(function(he){return he._value===ae._value})||X.push(ae),_e(M),te&&G())}function _e(M){var z=M._listeners;M._listeners=[];for(var te=0,ae=z.length;te<ae;++te)Ue(M,z[te]);var he=M._PSD;--he.ref||he.finalize(),vt===0&&(++vt,en(function(){--vt==0&&J()},[]))}function Ue(M,z){if(M._state!==null){var te=M._state?z.onFulfilled:z.onRejected;if(te===null)return(M._state?z.resolve:z.reject)(M._value);++z.psd.ref,++vt,en(kt,[te,M,z])}else M._listeners.push(z)}function kt(M,z,te){try{var ae,he=z._value;!z._state&&ye.length&&(ye=[]),ae=Be&&z._consoleTask?z._consoleTask.run(function(){return M(he)}):M(he),z._state||ye.indexOf(he)!==-1||function(Ee){for(var Le=X.length;Le;)if(X[--Le]._value===Ee._value)return X.splice(Le,1)}(z),te.resolve(ae)}catch(Ee){te.reject(Ee)}finally{--vt==0&&J(),--te.psd.ref||te.psd.finalize()}}function fe(){et(we,function(){Y()&&G()})}function Y(){var M=xe;return F=xe=!1,M}function G(){var M,z,te;do for(;0<de.length;)for(M=de,de=[],te=M.length,z=0;z<te;++z){var ae=M[z];ae[0].apply(null,ae[1])}while(0<de.length);F=xe=!0}function J(){var M=X;X=[],M.forEach(function(ae){ae._PSD.onunhandled.call(null,ae._value,ae)});for(var z=ot.slice(0),te=z.length;te;)z[--te]()}function ve(M){return new B(lt,!1,M)}function Oe(M,z){var te=Me;return function(){var ae=Y(),he=Me;try{return Cr(te,!0),M.apply(this,arguments)}catch(Ee){z&&z(Ee)}finally{Cr(he,!1),ae&&G()}}}h(B.prototype,{then:ze,_then:function(M,z){Ue(this,new st(null,null,M,z,Me))},catch:function(M){if(arguments.length===1)return this.then(null,M);var z=M,te=arguments[1];return typeof z=="function"?this.then(null,function(ae){return(ae instanceof z?te:ve)(ae)}):this.then(null,function(ae){return(ae&&ae.name===z?te:ve)(ae)})},finally:function(M){return this.then(function(z){return B.resolve(M()).then(function(){return z})},function(z){return B.resolve(M()).then(function(){return ve(z)})})},timeout:function(M,z){var te=this;return M<1/0?new B(function(ae,he){var Ee=setTimeout(function(){return he(new Ce.Timeout(z))},M);te.then(ae,he).finally(clearTimeout.bind(null,Ee))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&y(B.prototype,Symbol.toStringTag,"Dexie.Promise"),we.env=hn(),h(B,{all:function(){var M=W.apply(null,arguments).map(ns);return new B(function(z,te){M.length===0&&z([]);var ae=M.length;M.forEach(function(he,Ee){return B.resolve(he).then(function(Le){M[Ee]=Le,--ae||z(M)},te)})})},resolve:function(M){return M instanceof B?M:M&&typeof M.then=="function"?new B(function(z,te){M.then(z,te)}):new B(lt,!0,M)},reject:ve,race:function(){var M=W.apply(null,arguments).map(ns);return new B(function(z,te){M.map(function(ae){return B.resolve(ae).then(z,te)})})},PSD:{get:function(){return Me},set:function(M){return Me=M}},totalEchoes:{get:function(){return Xt}},newPSD:un,usePSD:et,scheduler:{get:function(){return en},set:function(M){en=M}},rejectionMapper:{get:function(){return Fe},set:function(M){Fe=M}},follow:function(M,z){return new B(function(te,ae){return un(function(he,Ee){var Le=Me;Le.unhandleds=[],Le.onunhandled=Ee,Le.finalize=ge(function(){var He,nt=this;He=function(){nt.unhandleds.length===0?he():Ee(nt.unhandleds[0])},ot.push(function it(){He(),ot.splice(ot.indexOf(it),1)}),++vt,en(function(){--vt==0&&J()},[])},Le.finalize),M()},z,te,ae)})}}),qt&&(qt.allSettled&&y(B,"allSettled",function(){var M=W.apply(null,arguments).map(ns);return new B(function(z){M.length===0&&z([]);var te=M.length,ae=new Array(te);M.forEach(function(he,Ee){return B.resolve(he).then(function(Le){return ae[Ee]={status:"fulfilled",value:Le}},function(Le){return ae[Ee]={status:"rejected",reason:Le}}).then(function(){return--te||z(ae)})})})}),qt.any&&typeof AggregateError<"u"&&y(B,"any",function(){var M=W.apply(null,arguments).map(ns);return new B(function(z,te){M.length===0&&te(new AggregateError([]));var ae=M.length,he=new Array(ae);M.forEach(function(Ee,Le){return B.resolve(Ee).then(function(He){return z(He)},function(He){he[Le]=He,--ae||te(new AggregateError(he))})})})}),qt.withResolvers&&(B.withResolvers=qt.withResolvers));var Ge={awaits:0,echoes:0,id:0},_t=0,tn=[],Un=0,Xt=0,nn=0;function un(M,z,te,ae){var he=Me,Ee=Object.create(he);return Ee.parent=he,Ee.ref=0,Ee.global=!1,Ee.id=++nn,we.env,Ee.env=Lt?{Promise:B,PromiseProp:{value:B,configurable:!0,writable:!0},all:B.all,race:B.race,allSettled:B.allSettled,any:B.any,resolve:B.resolve,reject:B.reject}:{},z&&l(Ee,z),++he.ref,Ee.finalize=function(){--this.parent.ref||this.parent.finalize()},ae=et(Ee,M,te,ae),Ee.ref===0&&Ee.finalize(),ae}function mr(){return Ge.id||(Ge.id=++_t),++Ge.awaits,Ge.echoes+=Rt,Ge.id}function Rr(){return!!Ge.awaits&&(--Ge.awaits==0&&(Ge.id=0),Ge.echoes=Ge.awaits*Rt,!0)}function ns(M){return Ge.echoes&&M&&M.constructor===qt?(mr(),M.then(function(z){return Rr(),z},function(z){return Rr(),nr(z)})):M}function rs(){var M=tn[tn.length-1];tn.pop(),Cr(M,!1)}function Cr(M,z){var te,ae=Me;(z?!Ge.echoes||Un++&&M===Me:!Un||--Un&&M===Me)||queueMicrotask(z?(function(he){++Xt,Ge.echoes&&--Ge.echoes!=0||(Ge.echoes=Ge.awaits=Ge.id=0),tn.push(Me),Cr(he,!0)}).bind(null,M):rs),M!==Me&&(Me=M,ae===we&&(we.env=hn()),Lt&&(te=we.env.Promise,z=M.env,(ae.global||M.global)&&(Object.defineProperty(i,"Promise",z.PromiseProp),te.all=z.all,te.race=z.race,te.resolve=z.resolve,te.reject=z.reject,z.allSettled&&(te.allSettled=z.allSettled),z.any&&(te.any=z.any))))}function hn(){var M=i.Promise;return Lt?{Promise:M,PromiseProp:Object.getOwnPropertyDescriptor(i,"Promise"),all:M.all,race:M.race,allSettled:M.allSettled,any:M.any,resolve:M.resolve,reject:M.reject}:{}}function et(M,z,te,ae,he){var Ee=Me;try{return Cr(M,!0),z(te,ae,he)}finally{Cr(Ee,!1)}}function Vt(M,z,te,ae){return typeof M!="function"?M:function(){var he=Me;te&&mr(),Cr(z,!0);try{return M.apply(this,arguments)}finally{Cr(he,!1),ae&&queueMicrotask(Rr)}}}function pn(M){Promise===qt&&Ge.echoes===0?Un===0?M():enqueueNativeMicroTask(M):setTimeout(M,0)}(""+Ha).indexOf("[native code]")===-1&&(mr=Rr=Ve);var nr=B.reject,As="￿",es="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Ii="String expected.",ci=[],qa="__dbnames",ua="readonly",Ws="readwrite";function Vo(M,z){return M?z?function(){return M.apply(this,arguments)&&z.apply(this,arguments)}:M:z}var _l={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function df(M){return typeof M!="string"||/\./.test(M)?function(z){return z}:function(z){return z[M]===void 0&&M in z&&delete(z=V(z))[M],z}}function ig(){throw Ce.Type()}function Dr(M,z){try{var te=xb(M),ae=xb(z);if(te!==ae)return te==="Array"?1:ae==="Array"?-1:te==="binary"?1:ae==="binary"?-1:te==="string"?1:ae==="string"?-1:te==="Date"?1:ae!=="Date"?NaN:-1;switch(te){case"number":case"Date":case"string":return z<M?1:M<z?-1:0;case"binary":return function(he,Ee){for(var Le=he.length,He=Ee.length,nt=Le<He?Le:He,it=0;it<nt;++it)if(he[it]!==Ee[it])return he[it]<Ee[it]?-1:1;return Le===He?0:Le<He?-1:1}(Va(M),Va(z));case"Array":return function(he,Ee){for(var Le=he.length,He=Ee.length,nt=Le<He?Le:He,it=0;it<nt;++it){var dt=Dr(he[it],Ee[it]);if(dt!==0)return dt}return Le===He?0:Le<He?-1:1}(M,z)}}catch{}return NaN}function xb(M){var z=typeof M;return z!="object"?z:ArrayBuffer.isView(M)?"binary":(M=Z(M),M==="ArrayBuffer"?"binary":M)}function Va(M){return M instanceof Uint8Array?M:ArrayBuffer.isView(M)?new Uint8Array(M.buffer,M.byteOffset,M.byteLength):new Uint8Array(M)}var wb=(Rs.prototype._trans=function(M,z,te){var ae=this._tx||Me.trans,he=this.name,Ee=Be&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(M==="readonly"?"read":"write"," ").concat(this.name));function Le(it,dt,Je){if(!Je.schema[he])throw new Ce.NotFound("Table "+he+" not part of transaction");return z(Je.idbtrans,Je)}var He=Y();try{var nt=ae&&ae.db._novip===this.db._novip?ae===Me.trans?ae._promise(M,Le,te):un(function(){return ae._promise(M,Le,te)},{trans:ae,transless:Me.transless||Me}):function it(dt,Je,mt,tt){if(dt.idbdb&&(dt._state.openComplete||Me.letThrough||dt._vip)){var ut=dt._createTransaction(Je,mt,dt._dbSchema);try{ut.create(),dt._state.PR1398_maxLoop=3}catch(gt){return gt.name===De.InvalidState&&dt.isOpen()&&0<--dt._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),dt.close({disableAutoOpen:!1}),dt.open().then(function(){return it(dt,Je,mt,tt)})):nr(gt)}return ut._promise(Je,function(gt,at){return un(function(){return Me.trans=ut,tt(gt,at,ut)})}).then(function(gt){if(Je==="readwrite")try{ut.idbtrans.commit()}catch{}return Je==="readonly"?gt:ut._completion.then(function(){return gt})})}if(dt._state.openComplete)return nr(new Ce.DatabaseClosed(dt._state.dbOpenError));if(!dt._state.isBeingOpened){if(!dt._state.autoOpen)return nr(new Ce.DatabaseClosed);dt.open().catch(Ve)}return dt._state.dbReadyPromise.then(function(){return it(dt,Je,mt,tt)})}(this.db,M,[this.name],Le);return Ee&&(nt._consoleTask=Ee,nt=nt.catch(function(it){return console.trace(it),nr(it)})),nt}finally{He&&G()}},Rs.prototype.get=function(M,z){var te=this;return M&&M.constructor===Object?this.where(M).first(z):M==null?nr(new Ce.Type("Invalid argument to Table.get()")):this._trans("readonly",function(ae){return te.core.get({trans:ae,key:M}).then(function(he){return te.hook.reading.fire(he)})}).then(z)},Rs.prototype.where=function(M){if(typeof M=="string")return new this.db.WhereClause(this,M);if(o(M))return new this.db.WhereClause(this,"[".concat(M.join("+"),"]"));var z=a(M);if(z.length===1)return this.where(z[0]).equals(M[z[0]]);var te=this.schema.indexes.concat(this.schema.primKey).filter(function(He){if(He.compound&&z.every(function(it){return 0<=He.keyPath.indexOf(it)})){for(var nt=0;nt<z.length;++nt)if(z.indexOf(He.keyPath[nt])===-1)return!1;return!0}return!1}).sort(function(He,nt){return He.keyPath.length-nt.keyPath.length})[0];if(te&&this.db._maxKey!==As){var Ee=te.keyPath.slice(0,z.length);return this.where(Ee).equals(Ee.map(function(nt){return M[nt]}))}!te&&Be&&console.warn("The query ".concat(JSON.stringify(M)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(z.join("+"),"]"));var ae=this.schema.idxByName;function he(He,nt){return Dr(He,nt)===0}var Le=z.reduce(function(Je,nt){var it=Je[0],dt=Je[1],Je=ae[nt],mt=M[nt];return[it||Je,it||!Je?Vo(dt,Je&&Je.multi?function(tt){return tt=A(tt,nt),o(tt)&&tt.some(function(ut){return he(mt,ut)})}:function(tt){return he(mt,A(tt,nt))}):dt]},[null,null]),Ee=Le[0],Le=Le[1];return Ee?this.where(Ee.name).equals(M[Ee.keyPath]).filter(Le):te?this.filter(Le):this.where(z).equals("")},Rs.prototype.filter=function(M){return this.toCollection().and(M)},Rs.prototype.count=function(M){return this.toCollection().count(M)},Rs.prototype.offset=function(M){return this.toCollection().offset(M)},Rs.prototype.limit=function(M){return this.toCollection().limit(M)},Rs.prototype.each=function(M){return this.toCollection().each(M)},Rs.prototype.toArray=function(M){return this.toCollection().toArray(M)},Rs.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},Rs.prototype.orderBy=function(M){return new this.db.Collection(new this.db.WhereClause(this,o(M)?"[".concat(M.join("+"),"]"):M))},Rs.prototype.reverse=function(){return this.toCollection().reverse()},Rs.prototype.mapToClass=function(M){var z,te=this.db,ae=this.name;function he(){return z!==null&&z.apply(this,arguments)||this}(this.schema.mappedClass=M).prototype instanceof ig&&(function(nt,it){if(typeof it!="function"&&it!==null)throw new TypeError("Class extends value "+String(it)+" is not a constructor or null");function dt(){this.constructor=nt}n(nt,it),nt.prototype=it===null?Object.create(it):(dt.prototype=it.prototype,new dt)}(he,z=M),Object.defineProperty(he.prototype,"db",{get:function(){return te},enumerable:!1,configurable:!0}),he.prototype.table=function(){return ae},M=he);for(var Ee=new Set,Le=M.prototype;Le;Le=c(Le))Object.getOwnPropertyNames(Le).forEach(function(nt){return Ee.add(nt)});function He(nt){if(!nt)return nt;var it,dt=Object.create(M.prototype);for(it in nt)if(!Ee.has(it))try{dt[it]=nt[it]}catch{}return dt}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=He,this.hook("reading",He),M},Rs.prototype.defineClass=function(){return this.mapToClass(function(M){l(this,M)})},Rs.prototype.add=function(M,z){var te=this,ae=this.schema.primKey,he=ae.auto,Ee=ae.keyPath,Le=M;return Ee&&he&&(Le=df(Ee)(M)),this._trans("readwrite",function(He){return te.core.mutate({trans:He,type:"add",keys:z!=null?[z]:null,values:[Le]})}).then(function(He){return He.numFailures?B.reject(He.failures[0]):He.lastResult}).then(function(He){if(Ee)try{R(M,Ee,He)}catch{}return He})},Rs.prototype.update=function(M,z){return typeof M!="object"||o(M)?this.where(":id").equals(M).modify(z):(M=A(M,this.schema.primKey.keyPath),M===void 0?nr(new Ce.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(M).modify(z))},Rs.prototype.put=function(M,z){var te=this,ae=this.schema.primKey,he=ae.auto,Ee=ae.keyPath,Le=M;return Ee&&he&&(Le=df(Ee)(M)),this._trans("readwrite",function(He){return te.core.mutate({trans:He,type:"put",values:[Le],keys:z!=null?[z]:null})}).then(function(He){return He.numFailures?B.reject(He.failures[0]):He.lastResult}).then(function(He){if(Ee)try{R(M,Ee,He)}catch{}return He})},Rs.prototype.delete=function(M){var z=this;return this._trans("readwrite",function(te){return z.core.mutate({trans:te,type:"delete",keys:[M]})}).then(function(te){return te.numFailures?B.reject(te.failures[0]):void 0})},Rs.prototype.clear=function(){var M=this;return this._trans("readwrite",function(z){return M.core.mutate({trans:z,type:"deleteRange",range:_l})}).then(function(z){return z.numFailures?B.reject(z.failures[0]):void 0})},Rs.prototype.bulkGet=function(M){var z=this;return this._trans("readonly",function(te){return z.core.getMany({keys:M,trans:te}).then(function(ae){return ae.map(function(he){return z.hook.reading.fire(he)})})})},Rs.prototype.bulkAdd=function(M,z,te){var ae=this,he=Array.isArray(z)?z:void 0,Ee=(te=te||(he?void 0:z))?te.allKeys:void 0;return this._trans("readwrite",function(Le){var it=ae.schema.primKey,He=it.auto,it=it.keyPath;if(it&&he)throw new Ce.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(he&&he.length!==M.length)throw new Ce.InvalidArgument("Arguments objects and keys must have the same length");var nt=M.length,it=it&&He?M.map(df(it)):M;return ae.core.mutate({trans:Le,type:"add",keys:he,values:it,wantResults:Ee}).then(function(ut){var Je=ut.numFailures,mt=ut.results,tt=ut.lastResult,ut=ut.failures;if(Je===0)return Ee?mt:tt;throw new Ie("".concat(ae.name,".bulkAdd(): ").concat(Je," of ").concat(nt," operations failed"),ut)})})},Rs.prototype.bulkPut=function(M,z,te){var ae=this,he=Array.isArray(z)?z:void 0,Ee=(te=te||(he?void 0:z))?te.allKeys:void 0;return this._trans("readwrite",function(Le){var it=ae.schema.primKey,He=it.auto,it=it.keyPath;if(it&&he)throw new Ce.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(he&&he.length!==M.length)throw new Ce.InvalidArgument("Arguments objects and keys must have the same length");var nt=M.length,it=it&&He?M.map(df(it)):M;return ae.core.mutate({trans:Le,type:"put",keys:he,values:it,wantResults:Ee}).then(function(ut){var Je=ut.numFailures,mt=ut.results,tt=ut.lastResult,ut=ut.failures;if(Je===0)return Ee?mt:tt;throw new Ie("".concat(ae.name,".bulkPut(): ").concat(Je," of ").concat(nt," operations failed"),ut)})})},Rs.prototype.bulkUpdate=function(M){var z=this,te=this.core,ae=M.map(function(Le){return Le.key}),he=M.map(function(Le){return Le.changes}),Ee=[];return this._trans("readwrite",function(Le){return te.getMany({trans:Le,keys:ae,cache:"clone"}).then(function(He){var nt=[],it=[];M.forEach(function(Je,mt){var tt=Je.key,ut=Je.changes,gt=He[mt];if(gt){for(var at=0,St=Object.keys(ut);at<St.length;at++){var Nt=St[at],Mt=ut[Nt];if(Nt===z.schema.primKey.keyPath){if(Dr(Mt,tt)!==0)throw new Ce.Constraint("Cannot update primary key in bulkUpdate()")}else R(gt,Nt,Mt)}Ee.push(mt),nt.push(tt),it.push(gt)}});var dt=nt.length;return te.mutate({trans:Le,type:"put",keys:nt,values:it,updates:{keys:ae,changeSpecs:he}}).then(function(Je){var mt=Je.numFailures,tt=Je.failures;if(mt===0)return dt;for(var ut=0,gt=Object.keys(tt);ut<gt.length;ut++){var at,St=gt[ut],Nt=Ee[Number(St)];Nt!=null&&(at=tt[St],delete tt[St],tt[Nt]=at)}throw new Ie("".concat(z.name,".bulkUpdate(): ").concat(mt," of ").concat(dt," operations failed"),tt)})})})},Rs.prototype.bulkDelete=function(M){var z=this,te=M.length;return this._trans("readwrite",function(ae){return z.core.mutate({trans:ae,type:"delete",keys:M})}).then(function(Le){var he=Le.numFailures,Ee=Le.lastResult,Le=Le.failures;if(he===0)return Ee;throw new Ie("".concat(z.name,".bulkDelete(): ").concat(he," of ").concat(te," operations failed"),Le)})},Rs);function Rs(){}function qc(M){function z(Le,He){if(He){for(var nt=arguments.length,it=new Array(nt-1);--nt;)it[nt-1]=arguments[nt];return te[Le].subscribe.apply(null,it),M}if(typeof Le=="string")return te[Le]}var te={};z.addEventType=Ee;for(var ae=1,he=arguments.length;ae<he;++ae)Ee(arguments[ae]);return z;function Ee(Le,He,nt){if(typeof Le!="object"){var it;He=He||re;var dt={subscribers:[],fire:nt=nt||Ve,subscribe:function(Je){dt.subscribers.indexOf(Je)===-1&&(dt.subscribers.push(Je),dt.fire=He(dt.fire,Je))},unsubscribe:function(Je){dt.subscribers=dt.subscribers.filter(function(mt){return mt!==Je}),dt.fire=dt.subscribers.reduce(He,nt)}};return te[Le]=z[Le]=dt}a(it=Le).forEach(function(Je){var mt=it[Je];if(o(mt))Ee(Je,it[Je][0],it[Je][1]);else{if(mt!=="asap")throw new Ce.InvalidArgument("Invalid event config");var tt=Ee(Je,Ne,function(){for(var ut=arguments.length,gt=new Array(ut);ut--;)gt[ut]=arguments[ut];tt.subscribers.forEach(function(at){k(function(){at.apply(null,gt)})})})}})}}function ff(M,z){return b(z).from({prototype:M}),z}function ic(M,z){return!(M.filter||M.algorithm||M.or)&&(z?M.justLimit:!M.replayFilter)}function _b(M,z){M.filter=Vo(M.filter,z)}function Sa(M,z,te){var ae=M.replayFilter;M.replayFilter=ae?function(){return Vo(ae(),z())}:z,M.justLimit=te&&!ae}function hf(M,z){if(M.isPrimKey)return z.primaryKey;var te=z.getIndexByKeyPath(M.index);if(!te)throw new Ce.Schema("KeyPath "+M.index+" on object store "+z.name+" is not indexed");return te}function Sb(M,z,te){var ae=hf(M,z.schema);return z.openCursor({trans:te,values:!M.keysOnly,reverse:M.dir==="prev",unique:!!M.unique,query:{index:ae,range:M.range}})}function pf(M,z,te,ae){var he=M.replayFilter?Vo(M.filter,M.replayFilter()):M.filter;if(M.or){var Ee={},Le=function(He,nt,it){var dt,Je;he&&!he(nt,it,function(mt){return nt.stop(mt)},function(mt){return nt.fail(mt)})||((Je=""+(dt=nt.primaryKey))=="[object ArrayBuffer]"&&(Je=""+new Uint8Array(dt)),d(Ee,Je)||(Ee[Je]=!0,z(He,nt,it)))};return Promise.all([M.or._iterate(Le,te),Wu(Sb(M,ae,te),M.algorithm,Le,!M.keysOnly&&M.valueMapper)])}return Wu(Sb(M,ae,te),Vo(M.algorithm,he),z,!M.keysOnly&&M.valueMapper)}function Wu(M,z,te,ae){var he=Oe(ae?function(Ee,Le,He){return te(ae(Ee),Le,He)}:te);return M.then(function(Ee){if(Ee)return Ee.start(function(){var Le=function(){return Ee.continue()};z&&!z(Ee,function(He){return Le=He},function(He){Ee.stop(He),Le=Ve},function(He){Ee.fail(He),Le=Ve})||he(Ee.value,Ee,function(He){return Le=He}),Le()})})}var mf=(Cb.prototype.execute=function(M){var z=this["@@propmod"];if(z.add!==void 0){var te=z.add;if(o(te))return s(s([],o(M)?M:[],!0),te).sort();if(typeof te=="number")return(Number(M)||0)+te;if(typeof te=="bigint")try{return BigInt(M)+te}catch{return BigInt(0)+te}throw new TypeError("Invalid term ".concat(te))}if(z.remove!==void 0){var ae=z.remove;if(o(ae))return o(M)?M.filter(function(he){return!ae.includes(he)}).sort():[];if(typeof ae=="number")return Number(M)-ae;if(typeof ae=="bigint")try{return BigInt(M)-ae}catch{return BigInt(0)-ae}throw new TypeError("Invalid subtrahend ".concat(ae))}return te=(te=z.replacePrefix)===null||te===void 0?void 0:te[0],te&&typeof M=="string"&&M.startsWith(te)?z.replacePrefix[1]+M.substring(te.length):M},Cb);function Cb(M){this["@@propmod"]=M}var gf=(Hr.prototype._read=function(M,z){var te=this._ctx;return te.error?te.table._trans(null,nr.bind(null,te.error)):te.table._trans("readonly",M).then(z)},Hr.prototype._write=function(M){var z=this._ctx;return z.error?z.table._trans(null,nr.bind(null,z.error)):z.table._trans("readwrite",M,"locked")},Hr.prototype._addAlgorithm=function(M){var z=this._ctx;z.algorithm=Vo(z.algorithm,M)},Hr.prototype._iterate=function(M,z){return pf(this._ctx,M,z,this._ctx.table.core)},Hr.prototype.clone=function(M){var z=Object.create(this.constructor.prototype),te=Object.create(this._ctx);return M&&l(te,M),z._ctx=te,z},Hr.prototype.raw=function(){return this._ctx.valueMapper=null,this},Hr.prototype.each=function(M){var z=this._ctx;return this._read(function(te){return pf(z,M,te,z.table.core)})},Hr.prototype.count=function(M){var z=this;return this._read(function(te){var ae=z._ctx,he=ae.table.core;if(ic(ae,!0))return he.count({trans:te,query:{index:hf(ae,he.schema),range:ae.range}}).then(function(Le){return Math.min(Le,ae.limit)});var Ee=0;return pf(ae,function(){return++Ee,!1},te,he).then(function(){return Ee})}).then(M)},Hr.prototype.sortBy=function(M,z){var te=M.split(".").reverse(),ae=te[0],he=te.length-1;function Ee(nt,it){return it?Ee(nt[te[it]],it-1):nt[ae]}var Le=this._ctx.dir==="next"?1:-1;function He(nt,it){return Dr(Ee(nt,he),Ee(it,he))*Le}return this.toArray(function(nt){return nt.sort(He)}).then(z)},Hr.prototype.toArray=function(M){var z=this;return this._read(function(te){var ae=z._ctx;if(ae.dir==="next"&&ic(ae,!0)&&0<ae.limit){var he=ae.valueMapper,Ee=hf(ae,ae.table.core.schema);return ae.table.core.query({trans:te,limit:ae.limit,values:!0,query:{index:Ee,range:ae.range}}).then(function(He){return He=He.result,he?He.map(he):He})}var Le=[];return pf(ae,function(He){return Le.push(He)},te,ae.table.core).then(function(){return Le})},M)},Hr.prototype.offset=function(M){var z=this._ctx;return M<=0||(z.offset+=M,ic(z)?Sa(z,function(){var te=M;return function(ae,he){return te===0||(te===1?--te:he(function(){ae.advance(te),te=0}),!1)}}):Sa(z,function(){var te=M;return function(){return--te<0}})),this},Hr.prototype.limit=function(M){return this._ctx.limit=Math.min(this._ctx.limit,M),Sa(this._ctx,function(){var z=M;return function(te,ae,he){return--z<=0&&ae(he),0<=z}},!0),this},Hr.prototype.until=function(M,z){return _b(this._ctx,function(te,ae,he){return!M(te.value)||(ae(he),z)}),this},Hr.prototype.first=function(M){return this.limit(1).toArray(function(z){return z[0]}).then(M)},Hr.prototype.last=function(M){return this.reverse().first(M)},Hr.prototype.filter=function(M){var z;return _b(this._ctx,function(te){return M(te.value)}),(z=this._ctx).isMatch=Vo(z.isMatch,M),this},Hr.prototype.and=function(M){return this.filter(M)},Hr.prototype.or=function(M){return new this.db.WhereClause(this._ctx.table,M,this)},Hr.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},Hr.prototype.desc=function(){return this.reverse()},Hr.prototype.eachKey=function(M){var z=this._ctx;return z.keysOnly=!z.isMatch,this.each(function(te,ae){M(ae.key,ae)})},Hr.prototype.eachUniqueKey=function(M){return this._ctx.unique="unique",this.eachKey(M)},Hr.prototype.eachPrimaryKey=function(M){var z=this._ctx;return z.keysOnly=!z.isMatch,this.each(function(te,ae){M(ae.primaryKey,ae)})},Hr.prototype.keys=function(M){var z=this._ctx;z.keysOnly=!z.isMatch;var te=[];return this.each(function(ae,he){te.push(he.key)}).then(function(){return te}).then(M)},Hr.prototype.primaryKeys=function(M){var z=this._ctx;if(z.dir==="next"&&ic(z,!0)&&0<z.limit)return this._read(function(ae){var he=hf(z,z.table.core.schema);return z.table.core.query({trans:ae,values:!1,limit:z.limit,query:{index:he,range:z.range}})}).then(function(ae){return ae.result}).then(M);z.keysOnly=!z.isMatch;var te=[];return this.each(function(ae,he){te.push(he.primaryKey)}).then(function(){return te}).then(M)},Hr.prototype.uniqueKeys=function(M){return this._ctx.unique="unique",this.keys(M)},Hr.prototype.firstKey=function(M){return this.limit(1).keys(function(z){return z[0]}).then(M)},Hr.prototype.lastKey=function(M){return this.reverse().firstKey(M)},Hr.prototype.distinct=function(){var M=this._ctx,M=M.index&&M.table.schema.idxByName[M.index];if(!M||!M.multi)return this;var z={};return _b(this._ctx,function(he){var ae=he.primaryKey.toString(),he=d(z,ae);return z[ae]=!0,!he}),this},Hr.prototype.modify=function(M){var z=this,te=this._ctx;return this._write(function(ae){var he,Ee,Le;Le=typeof M=="function"?M:(he=a(M),Ee=he.length,function(at){for(var St=!1,Nt=0;Nt<Ee;++Nt){var Mt=he[Nt],Ot=M[Mt],Yt=A(at,Mt);Ot instanceof mf?(R(at,Mt,Ot.execute(Yt)),St=!0):Yt!==Ot&&(R(at,Mt,Ot),St=!0)}return St});var He=te.table.core,Je=He.schema.primaryKey,nt=Je.outbound,it=Je.extractKey,dt=200,Je=z.db._options.modifyChunkSize;Je&&(dt=typeof Je=="object"?Je[He.name]||Je["*"]||200:Je);function mt(at,Mt){var Nt=Mt.failures,Mt=Mt.numFailures;ut+=at-Mt;for(var Ot=0,Yt=a(Nt);Ot<Yt.length;Ot++){var rn=Yt[Ot];tt.push(Nt[rn])}}var tt=[],ut=0,gt=[];return z.clone().primaryKeys().then(function(at){function St(Mt){var Ot=Math.min(dt,at.length-Mt);return He.getMany({trans:ae,keys:at.slice(Mt,Mt+Ot),cache:"immutable"}).then(function(Yt){for(var rn=[],Ht=[],Jt=nt?[]:null,an=[],Gt=0;Gt<Ot;++Gt){var mn=Yt[Gt],Bn={value:V(mn),primKey:at[Mt+Gt]};Le.call(Bn,Bn.value,Bn)!==!1&&(Bn.value==null?an.push(at[Mt+Gt]):nt||Dr(it(mn),it(Bn.value))===0?(Ht.push(Bn.value),nt&&Jt.push(at[Mt+Gt])):(an.push(at[Mt+Gt]),rn.push(Bn.value)))}return Promise.resolve(0<rn.length&&He.mutate({trans:ae,type:"add",values:rn}).then(function(Vn){for(var fr in Vn.failures)an.splice(parseInt(fr),1);mt(rn.length,Vn)})).then(function(){return(0<Ht.length||Nt&&typeof M=="object")&&He.mutate({trans:ae,type:"put",keys:Jt,values:Ht,criteria:Nt,changeSpec:typeof M!="function"&&M,isAdditionalChunk:0<Mt}).then(function(Vn){return mt(Ht.length,Vn)})}).then(function(){return(0<an.length||Nt&&M===ag)&&He.mutate({trans:ae,type:"delete",keys:an,criteria:Nt,isAdditionalChunk:0<Mt}).then(function(Vn){return mt(an.length,Vn)})}).then(function(){return at.length>Mt+Ot&&St(Mt+dt)})})}var Nt=ic(te)&&te.limit===1/0&&(typeof M!="function"||M===ag)&&{index:te.index,range:te.range};return St(0).then(function(){if(0<tt.length)throw new ce("Error modifying one or more objects",tt,ut,gt);return at.length})})})},Hr.prototype.delete=function(){var M=this._ctx,z=M.range;return ic(M)&&(M.isPrimKey||z.type===3)?this._write(function(te){var ae=M.table.core.schema.primaryKey,he=z;return M.table.core.count({trans:te,query:{index:ae,range:he}}).then(function(Ee){return M.table.core.mutate({trans:te,type:"deleteRange",range:he}).then(function(Le){var He=Le.failures;if(Le.lastResult,Le.results,Le=Le.numFailures,Le)throw new ce("Could not delete some values",Object.keys(He).map(function(nt){return He[nt]}),Ee-Le);return Ee-Le})})}):this.modify(ag)},Hr);function Hr(){}var ag=function(M,z){return z.value=null};function h_(M,z){return M<z?-1:M===z?0:1}function kb(M,z){return z<M?-1:M===z?0:1}function Wa(M,z,te){return M=M instanceof Gu?new M.Collection(M):M,M._ctx.error=new(te||TypeError)(z),M}function yf(M){return new M.Collection(M,function(){return og("")}).limit(0)}function Hu(M,z,te,ae){var he,Ee,Le,He,nt,it,dt,Je=te.length;if(!te.every(function(ut){return typeof ut=="string"}))return Wa(M,Ii);function mt(ut){he=ut==="next"?function(at){return at.toUpperCase()}:function(at){return at.toLowerCase()},Ee=ut==="next"?function(at){return at.toLowerCase()}:function(at){return at.toUpperCase()},Le=ut==="next"?h_:kb;var gt=te.map(function(at){return{lower:Ee(at),upper:he(at)}}).sort(function(at,St){return Le(at.lower,St.lower)});He=gt.map(function(at){return at.upper}),nt=gt.map(function(at){return at.lower}),dt=(it=ut)==="next"?"":ae}mt("next"),M=new M.Collection(M,function(){return Sl(He[0],nt[Je-1]+ae)}),M._ondirectionchange=function(ut){mt(ut)};var tt=0;return M._addAlgorithm(function(ut,gt,at){var St=ut.key;if(typeof St!="string")return!1;var Nt=Ee(St);if(z(Nt,nt,tt))return!0;for(var Mt=null,Ot=tt;Ot<Je;++Ot){var Yt=function(rn,Ht,Jt,an,Gt,mn){for(var Bn=Math.min(rn.length,an.length),Vn=-1,fr=0;fr<Bn;++fr){var da=Ht[fr];if(da!==an[fr])return Gt(rn[fr],Jt[fr])<0?rn.substr(0,fr)+Jt[fr]+Jt.substr(fr+1):Gt(rn[fr],an[fr])<0?rn.substr(0,fr)+an[fr]+Jt.substr(fr+1):0<=Vn?rn.substr(0,Vn)+Ht[Vn]+Jt.substr(Vn+1):null;Gt(rn[fr],da)<0&&(Vn=fr)}return Bn<an.length&&mn==="next"?rn+Jt.substr(rn.length):Bn<rn.length&&mn==="prev"?rn.substr(0,Jt.length):Vn<0?null:rn.substr(0,Vn)+an[Vn]+Jt.substr(Vn+1)}(St,Nt,He[Ot],nt[Ot],Le,it);Yt===null&&Mt===null?tt=Ot+1:(Mt===null||0<Le(Mt,Yt))&&(Mt=Yt)}return gt(Mt!==null?function(){ut.continue(Mt+dt)}:at),!1}),M}function Sl(M,z,te,ae){return{type:2,lower:M,upper:z,lowerOpen:te,upperOpen:ae}}function og(M){return{type:1,lower:M,upper:M}}var Gu=(Object.defineProperty(Fs.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),Fs.prototype.between=function(M,z,te,ae){te=te!==!1,ae=ae===!0;try{return 0<this._cmp(M,z)||this._cmp(M,z)===0&&(te||ae)&&(!te||!ae)?yf(this):new this.Collection(this,function(){return Sl(M,z,!te,!ae)})}catch{return Wa(this,es)}},Fs.prototype.equals=function(M){return M==null?Wa(this,es):new this.Collection(this,function(){return og(M)})},Fs.prototype.above=function(M){return M==null?Wa(this,es):new this.Collection(this,function(){return Sl(M,void 0,!0)})},Fs.prototype.aboveOrEqual=function(M){return M==null?Wa(this,es):new this.Collection(this,function(){return Sl(M,void 0,!1)})},Fs.prototype.below=function(M){return M==null?Wa(this,es):new this.Collection(this,function(){return Sl(void 0,M,!1,!0)})},Fs.prototype.belowOrEqual=function(M){return M==null?Wa(this,es):new this.Collection(this,function(){return Sl(void 0,M)})},Fs.prototype.startsWith=function(M){return typeof M!="string"?Wa(this,Ii):this.between(M,M+As,!0,!0)},Fs.prototype.startsWithIgnoreCase=function(M){return M===""?this.startsWith(M):Hu(this,function(z,te){return z.indexOf(te[0])===0},[M],As)},Fs.prototype.equalsIgnoreCase=function(M){return Hu(this,function(z,te){return z===te[0]},[M],"")},Fs.prototype.anyOfIgnoreCase=function(){var M=W.apply(ne,arguments);return M.length===0?yf(this):Hu(this,function(z,te){return te.indexOf(z)!==-1},M,"")},Fs.prototype.startsWithAnyOfIgnoreCase=function(){var M=W.apply(ne,arguments);return M.length===0?yf(this):Hu(this,function(z,te){return te.some(function(ae){return z.indexOf(ae)===0})},M,As)},Fs.prototype.anyOf=function(){var M=this,z=W.apply(ne,arguments),te=this._cmp;try{z.sort(te)}catch{return Wa(this,es)}if(z.length===0)return yf(this);var ae=new this.Collection(this,function(){return Sl(z[0],z[z.length-1])});ae._ondirectionchange=function(Ee){te=Ee==="next"?M._ascending:M._descending,z.sort(te)};var he=0;return ae._addAlgorithm(function(Ee,Le,He){for(var nt=Ee.key;0<te(nt,z[he]);)if(++he===z.length)return Le(He),!1;return te(nt,z[he])===0||(Le(function(){Ee.continue(z[he])}),!1)}),ae},Fs.prototype.notEqual=function(M){return this.inAnyRange([[-1/0,M],[M,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},Fs.prototype.noneOf=function(){var M=W.apply(ne,arguments);if(M.length===0)return new this.Collection(this);try{M.sort(this._ascending)}catch{return Wa(this,es)}var z=M.reduce(function(te,ae){return te?te.concat([[te[te.length-1][1],ae]]):[[-1/0,ae]]},null);return z.push([M[M.length-1],this.db._maxKey]),this.inAnyRange(z,{includeLowers:!1,includeUppers:!1})},Fs.prototype.inAnyRange=function(St,z){var te=this,ae=this._cmp,he=this._ascending,Ee=this._descending,Le=this._min,He=this._max;if(St.length===0)return yf(this);if(!St.every(function(Nt){return Nt[0]!==void 0&&Nt[1]!==void 0&&he(Nt[0],Nt[1])<=0}))return Wa(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",Ce.InvalidArgument);var nt=!z||z.includeLowers!==!1,it=z&&z.includeUppers===!0,dt,Je=he;function mt(Nt,Mt){return Je(Nt[0],Mt[0])}try{(dt=St.reduce(function(Nt,Mt){for(var Ot=0,Yt=Nt.length;Ot<Yt;++Ot){var rn=Nt[Ot];if(ae(Mt[0],rn[1])<0&&0<ae(Mt[1],rn[0])){rn[0]=Le(rn[0],Mt[0]),rn[1]=He(rn[1],Mt[1]);break}}return Ot===Yt&&Nt.push(Mt),Nt},[])).sort(mt)}catch{return Wa(this,es)}var tt=0,ut=it?function(Nt){return 0<he(Nt,dt[tt][1])}:function(Nt){return 0<=he(Nt,dt[tt][1])},gt=nt?function(Nt){return 0<Ee(Nt,dt[tt][0])}:function(Nt){return 0<=Ee(Nt,dt[tt][0])},at=ut,St=new this.Collection(this,function(){return Sl(dt[0][0],dt[dt.length-1][1],!nt,!it)});return St._ondirectionchange=function(Nt){Je=Nt==="next"?(at=ut,he):(at=gt,Ee),dt.sort(mt)},St._addAlgorithm(function(Nt,Mt,Ot){for(var Yt,rn=Nt.key;at(rn);)if(++tt===dt.length)return Mt(Ot),!1;return!ut(Yt=rn)&&!gt(Yt)||(te._cmp(rn,dt[tt][1])===0||te._cmp(rn,dt[tt][0])===0||Mt(function(){Je===he?Nt.continue(dt[tt][0]):Nt.continue(dt[tt][1])}),!1)}),St},Fs.prototype.startsWithAnyOf=function(){var M=W.apply(ne,arguments);return M.every(function(z){return typeof z=="string"})?M.length===0?yf(this):this.inAnyRange(M.map(function(z){return[z,z+As]})):Wa(this,"startsWithAnyOf() only works with strings")},Fs);function Fs(){}function Wo(M){return Oe(function(z){return Ku(z),M(z.target.error),!1})}function Ku(M){M.stopPropagation&&M.stopPropagation(),M.preventDefault&&M.preventDefault()}var bf="storagemutated",Yu="x-storagemutated-1",Gi=qc(null,bf),Eb=(Ca.prototype._lock=function(){return C(!Me.global),++this._reculock,this._reculock!==1||Me.global||(Me.lockOwnerFor=this),this},Ca.prototype._unlock=function(){if(C(!Me.global),--this._reculock==0)for(Me.global||(Me.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var M=this._blockedFuncs.shift();try{et(M[1],M[0])}catch{}}return this},Ca.prototype._locked=function(){return this._reculock&&Me.lockOwnerFor!==this},Ca.prototype.create=function(M){var z=this;if(!this.mode)return this;var te=this.db.idbdb,ae=this.db._state.dbOpenError;if(C(!this.idbtrans),!M&&!te)switch(ae&&ae.name){case"DatabaseClosedError":throw new Ce.DatabaseClosed(ae);case"MissingAPIError":throw new Ce.MissingAPI(ae.message,ae);default:throw new Ce.OpenFailed(ae)}if(!this.active)throw new Ce.TransactionInactive;return C(this._completion._state===null),(M=this.idbtrans=M||(this.db.core||te).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=Oe(function(he){Ku(he),z._reject(M.error)}),M.onabort=Oe(function(he){Ku(he),z.active&&z._reject(new Ce.Abort(M.error)),z.active=!1,z.on("abort").fire(he)}),M.oncomplete=Oe(function(){z.active=!1,z._resolve(),"mutatedParts"in M&&Gi.storagemutated.fire(M.mutatedParts)}),this},Ca.prototype._promise=function(M,z,te){var ae=this;if(M==="readwrite"&&this.mode!=="readwrite")return nr(new Ce.ReadOnly("Transaction is readonly"));if(!this.active)return nr(new Ce.TransactionInactive);if(this._locked())return new B(function(Ee,Le){ae._blockedFuncs.push([function(){ae._promise(M,z,te).then(Ee,Le)},Me])});if(te)return un(function(){var Ee=new B(function(Le,He){ae._lock();var nt=z(Le,He,ae);nt&&nt.then&&nt.then(Le,He)});return Ee.finally(function(){return ae._unlock()}),Ee._lib=!0,Ee});var he=new B(function(Ee,Le){var He=z(Ee,Le,ae);He&&He.then&&He.then(Ee,Le)});return he._lib=!0,he},Ca.prototype._root=function(){return this.parent?this.parent._root():this},Ca.prototype.waitFor=function(M){var z,te=this._root(),ae=B.resolve(M);te._waitingFor?te._waitingFor=te._waitingFor.then(function(){return ae}):(te._waitingFor=ae,te._waitingQueue=[],z=te.idbtrans.objectStore(te.storeNames[0]),function Ee(){for(++te._spinCount;te._waitingQueue.length;)te._waitingQueue.shift()();te._waitingFor&&(z.get(-1/0).onsuccess=Ee)}());var he=te._waitingFor;return new B(function(Ee,Le){ae.then(function(He){return te._waitingQueue.push(Oe(Ee.bind(null,He)))},function(He){return te._waitingQueue.push(Oe(Le.bind(null,He)))}).finally(function(){te._waitingFor===he&&(te._waitingFor=null)})})},Ca.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new Ce.Abort))},Ca.prototype.table=function(M){var z=this._memoizedTables||(this._memoizedTables={});if(d(z,M))return z[M];var te=this.schema[M];if(!te)throw new Ce.NotFound("Table "+M+" not part of transaction");return te=new this.db.Table(M,te,this),te.core=this.db.core.table(M),z[M]=te},Ca);function Ca(){}function Cl(M,z,te,ae,he,Ee,Le){return{name:M,keyPath:z,unique:te,multi:ae,auto:he,compound:Ee,src:(te&&!Le?"&":"")+(ae?"*":"")+(he?"++":"")+lg(z)}}function lg(M){return typeof M=="string"?M:M?"["+[].join.call(M,"+")+"]":""}function vf(M,z,te){return{name:M,primKey:z,indexes:te,mappedClass:null,idxByName:(ae=function(he){return[he.name,he]},te.reduce(function(he,Ee,Le){return Le=ae(Ee,Le),Le&&(he[Le[0]]=Le[1]),he},{}))};var ae}var xf=function(M){try{return M.only([[]]),xf=function(){return[[]]},[[]]}catch{return xf=function(){return As},As}};function wf(M){return M==null?function(){}:typeof M=="string"?(z=M).split(".").length===1?function(te){return te[z]}:function(te){return A(te,z)}:function(te){return A(te,M)};var z}function hp(M){return[].slice.call(M)}var p_=0;function xi(M){return M==null?":id":typeof M=="string"?M:"[".concat(M.join("+"),"]")}function Zu(M,z,nt){function ae(at){if(at.type===3)return null;if(at.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var tt=at.lower,ut=at.upper,gt=at.lowerOpen,at=at.upperOpen;return tt===void 0?ut===void 0?null:z.upperBound(ut,!!at):ut===void 0?z.lowerBound(tt,!!gt):z.bound(tt,ut,!!gt,!!at)}function he(mt){var tt,ut=mt.name;return{name:ut,schema:mt,mutate:function(gt){var at=gt.trans,St=gt.type,Nt=gt.keys,Mt=gt.values,Ot=gt.range;return new Promise(function(Yt,rn){Yt=Oe(Yt);var Ht=at.objectStore(ut),Jt=Ht.keyPath==null,an=St==="put"||St==="add";if(!an&&St!=="delete"&&St!=="deleteRange")throw new Error("Invalid operation type: "+St);var Gt,mn=(Nt||Mt||{length:1}).length;if(Nt&&Mt&&Nt.length!==Mt.length)throw new Error("Given keys array must have same length as given values array.");if(mn===0)return Yt({numFailures:0,failures:{},results:[],lastResult:void 0});function Bn(Yi){++da,Ku(Yi)}var Vn=[],fr=[],da=0;if(St==="deleteRange"){if(Ot.type===4)return Yt({numFailures:da,failures:fr,results:[],lastResult:void 0});Ot.type===3?Vn.push(Gt=Ht.clear()):Vn.push(Gt=Ht.delete(ae(Ot)))}else{var Jt=an?Jt?[Mt,Nt]:[Mt,null]:[Nt,null],rr=Jt[0],ui=Jt[1];if(an)for(var wi=0;wi<mn;++wi)Vn.push(Gt=ui&&ui[wi]!==void 0?Ht[St](rr[wi],ui[wi]):Ht[St](rr[wi])),Gt.onerror=Bn;else for(wi=0;wi<mn;++wi)Vn.push(Gt=Ht[St](rr[wi])),Gt.onerror=Bn}function ac(Yi){Yi=Yi.target.result,Vn.forEach(function(El,Gc){return El.error!=null&&(fr[Gc]=El.error)}),Yt({numFailures:da,failures:fr,results:St==="delete"?Nt:Vn.map(function(El){return El.result}),lastResult:Yi})}Gt.onerror=function(Yi){Bn(Yi),ac(Yi)},Gt.onsuccess=ac})},getMany:function(gt){var at=gt.trans,St=gt.keys;return new Promise(function(Nt,Mt){Nt=Oe(Nt);for(var Ot,Yt=at.objectStore(ut),rn=St.length,Ht=new Array(rn),Jt=0,an=0,Gt=function(Vn){Vn=Vn.target,Ht[Vn._pos]=Vn.result,++an===Jt&&Nt(Ht)},mn=Wo(Mt),Bn=0;Bn<rn;++Bn)St[Bn]!=null&&((Ot=Yt.get(St[Bn]))._pos=Bn,Ot.onsuccess=Gt,Ot.onerror=mn,++Jt);Jt===0&&Nt(Ht)})},get:function(gt){var at=gt.trans,St=gt.key;return new Promise(function(Nt,Mt){Nt=Oe(Nt);var Ot=at.objectStore(ut).get(St);Ot.onsuccess=function(Yt){return Nt(Yt.target.result)},Ot.onerror=Wo(Mt)})},query:(tt=it,function(gt){return new Promise(function(at,St){at=Oe(at);var Nt,Mt,Ot,Jt=gt.trans,Yt=gt.values,rn=gt.limit,Gt=gt.query,Ht=rn===1/0?void 0:rn,an=Gt.index,Gt=Gt.range,Jt=Jt.objectStore(ut),an=an.isPrimaryKey?Jt:Jt.index(an.name),Gt=ae(Gt);if(rn===0)return at({result:[]});tt?((Ht=Yt?an.getAll(Gt,Ht):an.getAllKeys(Gt,Ht)).onsuccess=function(mn){return at({result:mn.target.result})},Ht.onerror=Wo(St)):(Nt=0,Mt=!Yt&&"openKeyCursor"in an?an.openKeyCursor(Gt):an.openCursor(Gt),Ot=[],Mt.onsuccess=function(mn){var Bn=Mt.result;return Bn?(Ot.push(Yt?Bn.value:Bn.primaryKey),++Nt===rn?at({result:Ot}):void Bn.continue()):at({result:Ot})},Mt.onerror=Wo(St))})}),openCursor:function(gt){var at=gt.trans,St=gt.values,Nt=gt.query,Mt=gt.reverse,Ot=gt.unique;return new Promise(function(Yt,rn){Yt=Oe(Yt);var an=Nt.index,Ht=Nt.range,Jt=at.objectStore(ut),Jt=an.isPrimaryKey?Jt:Jt.index(an.name),an=Mt?Ot?"prevunique":"prev":Ot?"nextunique":"next",Gt=!St&&"openKeyCursor"in Jt?Jt.openKeyCursor(ae(Ht),an):Jt.openCursor(ae(Ht),an);Gt.onerror=Wo(rn),Gt.onsuccess=Oe(function(mn){var Bn,Vn,fr,da,rr=Gt.result;rr?(rr.___id=++p_,rr.done=!1,Bn=rr.continue.bind(rr),Vn=(Vn=rr.continuePrimaryKey)&&Vn.bind(rr),fr=rr.advance.bind(rr),da=function(){throw new Error("Cursor not stopped")},rr.trans=at,rr.stop=rr.continue=rr.continuePrimaryKey=rr.advance=function(){throw new Error("Cursor not started")},rr.fail=Oe(rn),rr.next=function(){var ui=this,wi=1;return this.start(function(){return wi--?ui.continue():ui.stop()}).then(function(){return ui})},rr.start=function(ui){function wi(){if(Gt.result)try{ui()}catch(Yi){rr.fail(Yi)}else rr.done=!0,rr.start=function(){throw new Error("Cursor behind last entry")},rr.stop()}var ac=new Promise(function(Yi,El){Yi=Oe(Yi),Gt.onerror=Wo(El),rr.fail=El,rr.stop=function(Gc){rr.stop=rr.continue=rr.continuePrimaryKey=rr.advance=da,Yi(Gc)}});return Gt.onsuccess=Oe(function(Yi){Gt.onsuccess=wi,wi()}),rr.continue=Bn,rr.continuePrimaryKey=Vn,rr.advance=fr,wi(),ac},Yt(rr)):Yt(null)},rn)})},count:function(gt){var at=gt.query,St=gt.trans,Nt=at.index,Mt=at.range;return new Promise(function(Ot,Yt){var rn=St.objectStore(ut),Ht=Nt.isPrimaryKey?rn:rn.index(Nt.name),rn=ae(Mt),Ht=rn?Ht.count(rn):Ht.count();Ht.onsuccess=Oe(function(Jt){return Ot(Jt.target.result)}),Ht.onerror=Wo(Yt)})}}}var Ee,Le,He,dt=(Le=nt,He=hp((Ee=M).objectStoreNames),{schema:{name:Ee.name,tables:He.map(function(mt){return Le.objectStore(mt)}).map(function(mt){var tt=mt.keyPath,at=mt.autoIncrement,ut=o(tt),gt={},at={name:mt.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:tt==null,compound:ut,keyPath:tt,autoIncrement:at,unique:!0,extractKey:wf(tt)},indexes:hp(mt.indexNames).map(function(St){return mt.index(St)}).map(function(Ot){var Nt=Ot.name,Mt=Ot.unique,Yt=Ot.multiEntry,Ot=Ot.keyPath,Yt={name:Nt,compound:o(Ot),keyPath:Ot,unique:Mt,multiEntry:Yt,extractKey:wf(Ot)};return gt[xi(Ot)]=Yt}),getIndexByKeyPath:function(St){return gt[xi(St)]}};return gt[":id"]=at.primaryKey,tt!=null&&(gt[xi(tt)]=at.primaryKey),at})},hasGetAll:0<He.length&&"getAll"in Le.objectStore(He[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),nt=dt.schema,it=dt.hasGetAll,dt=nt.tables.map(he),Je={};return dt.forEach(function(mt){return Je[mt.name]=mt}),{stack:"dbcore",transaction:M.transaction.bind(M),table:function(mt){if(!Je[mt])throw new Error("Table '".concat(mt,"' not found"));return Je[mt]},MIN_KEY:-1/0,MAX_KEY:xf(z),schema:nt}}function cg(M,z,te,ae){var he=te.IDBKeyRange;return te.indexedDB,{dbcore:(ae=Zu(z,he,ae),M.dbcore.reduce(function(Ee,Le){return Le=Le.create,r(r({},Ee),Le(Ee))},ae))}}function Vc(M,ae){var te=ae.db,ae=cg(M._middlewares,te,M._deps,ae);M.core=ae.dbcore,M.tables.forEach(function(he){var Ee=he.name;M.core.schema.tables.some(function(Le){return Le.name===Ee})&&(he.core=M.core.table(Ee),M[Ee]instanceof M.Table&&(M[Ee].core=he.core))})}function ug(M,z,te,ae){te.forEach(function(he){var Ee=ae[he];z.forEach(function(Le){var He=function nt(it,dt){return v(it,dt)||(it=c(it))&&nt(it,dt)}(Le,he);(!He||"value"in He&&He.value===void 0)&&(Le===M.Transaction.prototype||Le instanceof M.Transaction?y(Le,he,{get:function(){return this.table(he)},set:function(nt){m(this,he,{value:nt,writable:!0,configurable:!0,enumerable:!0})}}):Le[he]=new M.Table(he,Ee))})})}function pp(M,z){z.forEach(function(te){for(var ae in te)te[ae]instanceof M.Table&&delete te[ae]})}function Tb(M,z){return M._cfg.version-z._cfg.version}function mp(M,z,te,ae){var he=M._dbSchema;te.objectStoreNames.contains("$meta")&&!he.$meta&&(he.$meta=vf("$meta",g_("")[0],[]),M._storeNames.push("$meta"));var Ee=M._createTransaction("readwrite",M._storeNames,he);Ee.create(te),Ee._completion.catch(ae);var Le=Ee._reject.bind(Ee),He=Me.transless||Me;un(function(){return Me.trans=Ee,Me.transless=He,z!==0?(Vc(M,te),it=z,((nt=Ee).storeNames.includes("$meta")?nt.table("$meta").get("version").then(function(dt){return dt??it}):B.resolve(it)).then(function(dt){return mt=dt,tt=Ee,ut=te,gt=[],dt=(Je=M)._versions,at=Je._dbSchema=_f(0,Je.idbdb,ut),(dt=dt.filter(function(St){return St._cfg.version>=mt})).length!==0?(dt.forEach(function(St){gt.push(function(){var Nt=at,Mt=St._cfg.dbschema;pg(Je,Nt,ut),pg(Je,Mt,ut),at=Je._dbSchema=Mt;var Ot=fg(Nt,Mt);Ot.add.forEach(function(an){Ab(ut,an[0],an[1].primKey,an[1].indexes)}),Ot.change.forEach(function(an){if(an.recreate)throw new Ce.Upgrade("Not yet support for changing primary key");var Gt=ut.objectStore(an.name);an.add.forEach(function(mn){return hg(Gt,mn)}),an.change.forEach(function(mn){Gt.deleteIndex(mn.name),hg(Gt,mn)}),an.del.forEach(function(mn){return Gt.deleteIndex(mn)})});var Yt=St._cfg.contentUpgrade;if(Yt&&St._cfg.version>mt){Vc(Je,ut),tt._memoizedTables={};var rn=N(Mt);Ot.del.forEach(function(an){rn[an]=Nt[an]}),pp(Je,[Je.Transaction.prototype]),ug(Je,[Je.Transaction.prototype],a(rn),rn),tt.schema=rn;var Ht,Jt=Q(Yt);return Jt&&mr(),Ot=B.follow(function(){var an;(Ht=Yt(tt))&&Jt&&(an=Rr.bind(null,null),Ht.then(an,an))}),Ht&&typeof Ht.then=="function"?B.resolve(Ht):Ot.then(function(){return Ht})}}),gt.push(function(Nt){var Mt,Ot,Yt=St._cfg.dbschema;Mt=Yt,Ot=Nt,[].slice.call(Ot.db.objectStoreNames).forEach(function(rn){return Mt[rn]==null&&Ot.db.deleteObjectStore(rn)}),pp(Je,[Je.Transaction.prototype]),ug(Je,[Je.Transaction.prototype],Je._storeNames,Je._dbSchema),tt.schema=Je._dbSchema}),gt.push(function(Nt){Je.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(Je.idbdb.version/10)===St._cfg.version?(Je.idbdb.deleteObjectStore("$meta"),delete Je._dbSchema.$meta,Je._storeNames=Je._storeNames.filter(function(Mt){return Mt!=="$meta"})):Nt.objectStore("$meta").put(St._cfg.version,"version"))})}),function St(){return gt.length?B.resolve(gt.shift()(tt.idbtrans)).then(St):B.resolve()}().then(function(){m_(at,ut)})):B.resolve();var Je,mt,tt,ut,gt,at}).catch(Le)):(a(he).forEach(function(dt){Ab(te,dt,he[dt].primKey,he[dt].indexes)}),Vc(M,te),void B.follow(function(){return M.on.populate.fire(Ee)}).catch(Le));var nt,it})}function dg(M,z){m_(M._dbSchema,z),z.db.version%10!=0||z.objectStoreNames.contains("$meta")||z.db.createObjectStore("$meta").add(Math.ceil(z.db.version/10-1),"version");var te=_f(0,M.idbdb,z);pg(M,M._dbSchema,z);for(var ae=0,he=fg(te,M._dbSchema).change;ae<he.length;ae++){var Ee=function(Le){if(Le.change.length||Le.recreate)return console.warn("Unable to patch indexes of table ".concat(Le.name," because it has changes on the type of index or primary key.")),{value:void 0};var He=z.objectStore(Le.name);Le.add.forEach(function(nt){Be&&console.debug("Dexie upgrade patch: Creating missing index ".concat(Le.name,".").concat(nt.src)),hg(He,nt)})}(he[ae]);if(typeof Ee=="object")return Ee.value}}function fg(M,z){var te,ae={del:[],add:[],change:[]};for(te in M)z[te]||ae.del.push(te);for(te in z){var he=M[te],Ee=z[te];if(he){var Le={name:te,def:Ee,recreate:!1,del:[],add:[],change:[]};if(""+(he.primKey.keyPath||"")!=""+(Ee.primKey.keyPath||"")||he.primKey.auto!==Ee.primKey.auto)Le.recreate=!0,ae.change.push(Le);else{var He=he.idxByName,nt=Ee.idxByName,it=void 0;for(it in He)nt[it]||Le.del.push(it);for(it in nt){var dt=He[it],Je=nt[it];dt?dt.src!==Je.src&&Le.change.push(Je):Le.add.push(Je)}(0<Le.del.length||0<Le.add.length||0<Le.change.length)&&ae.change.push(Le)}}else ae.add.push([te,Ee])}return ae}function Ab(M,z,te,ae){var he=M.db.createObjectStore(z,te.keyPath?{keyPath:te.keyPath,autoIncrement:te.auto}:{autoIncrement:te.auto});return ae.forEach(function(Ee){return hg(he,Ee)}),he}function m_(M,z){a(M).forEach(function(te){z.db.objectStoreNames.contains(te)||(Be&&console.debug("Dexie: Creating missing table",te),Ab(z,te,M[te].primKey,M[te].indexes))})}function hg(M,z){M.createIndex(z.name,z.keyPath,{unique:z.unique,multiEntry:z.multi})}function _f(M,z,te){var ae={};return w(z.objectStoreNames,0).forEach(function(he){for(var Ee=te.objectStore(he),Le=Cl(lg(it=Ee.keyPath),it||"",!0,!1,!!Ee.autoIncrement,it&&typeof it!="string",!0),He=[],nt=0;nt<Ee.indexNames.length;++nt){var dt=Ee.index(Ee.indexNames[nt]),it=dt.keyPath,dt=Cl(dt.name,it,!!dt.unique,!!dt.multiEntry,!1,it&&typeof it!="string",!1);He.push(dt)}ae[he]=vf(he,Le,He)}),ae}function pg(M,z,te){for(var ae=te.db.objectStoreNames,he=0;he<ae.length;++he){var Ee=ae[he],Le=te.objectStore(Ee);M._hasGetAll="getAll"in Le;for(var He=0;He<Le.indexNames.length;++He){var nt=Le.indexNames[He],it=Le.index(nt).keyPath,dt=typeof it=="string"?it:"["+w(it).join("+")+"]";!z[Ee]||(it=z[Ee].idxByName[dt])&&(it.name=nt,delete z[Ee].idxByName[dt],z[Ee].idxByName[nt]=it)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&i.WorkerGlobalScope&&i instanceof i.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(M._hasGetAll=!1)}function g_(M){return M.split(",").map(function(z,te){var ae=(z=z.trim()).replace(/([&*]|\+\+)/g,""),he=/^\[/.test(ae)?ae.match(/^\[(.*)\]$/)[1].split("+"):ae;return Cl(ae,he||null,/\&/.test(z),/\*/.test(z),/\+\+/.test(z),o(he),te===0)})}var bA=(mg.prototype._parseStoresSpec=function(M,z){a(M).forEach(function(te){if(M[te]!==null){var ae=g_(M[te]),he=ae.shift();if(he.unique=!0,he.multi)throw new Ce.Schema("Primary key cannot be multi-valued");ae.forEach(function(Ee){if(Ee.auto)throw new Ce.Schema("Only primary key can be marked as autoIncrement (++)");if(!Ee.keyPath)throw new Ce.Schema("Index must have a name and cannot be an empty string")}),z[te]=vf(te,he,ae)}})},mg.prototype.stores=function(te){var z=this.db;this._cfg.storesSource=this._cfg.storesSource?l(this._cfg.storesSource,te):te;var te=z._versions,ae={},he={};return te.forEach(function(Ee){l(ae,Ee._cfg.storesSource),he=Ee._cfg.dbschema={},Ee._parseStoresSpec(ae,he)}),z._dbSchema=he,pp(z,[z._allTables,z,z.Transaction.prototype]),ug(z,[z._allTables,z,z.Transaction.prototype,this._cfg.tables],a(he),he),z._storeNames=a(he),this},mg.prototype.upgrade=function(M){return this._cfg.contentUpgrade=Te(this._cfg.contentUpgrade||Ve,M),this},mg);function mg(){}function Rb(M,z){var te=M._dbNamesDB;return te||(te=M._dbNamesDB=new kl(qa,{addons:[],indexedDB:M,IDBKeyRange:z})).version(1).stores({dbnames:"name"}),te.table("dbnames")}function gg(M){return M&&typeof M.databases=="function"}function Nb(M){return un(function(){return Me.letThrough=!0,M()})}function Mb(M){return!("from"in M)}var Ki=function(M,z){if(!this){var te=new Ki;return M&&"d"in M&&l(te,M),te}l(this,arguments.length?{d:1,from:M,to:1<arguments.length?z:M}:{d:0})};function gp(M,z,te){var ae=Dr(z,te);if(!isNaN(ae)){if(0<ae)throw RangeError();if(Mb(M))return l(M,{from:z,to:te,d:1});var he=M.l,ae=M.r;if(Dr(te,M.from)<0)return he?gp(he,z,te):M.l={from:z,to:te,d:1,l:null,r:null},b_(M);if(0<Dr(z,M.to))return ae?gp(ae,z,te):M.r={from:z,to:te,d:1,l:null,r:null},b_(M);Dr(z,M.from)<0&&(M.from=z,M.l=null,M.d=ae?ae.d+1:1),0<Dr(te,M.to)&&(M.to=te,M.r=null,M.d=M.l?M.l.d+1:1),te=!M.r,he&&!M.l&&Xu(M,he),ae&&te&&Xu(M,ae)}}function Xu(M,z){Mb(z)||function te(ae,nt){var Ee=nt.from,Le=nt.to,He=nt.l,nt=nt.r;gp(ae,Ee,Le),He&&te(ae,He),nt&&te(ae,nt)}(M,z)}function y_(M,z){var te=yg(z),ae=te.next();if(ae.done)return!1;for(var he=ae.value,Ee=yg(M),Le=Ee.next(he.from),He=Le.value;!ae.done&&!Le.done;){if(Dr(He.from,he.to)<=0&&0<=Dr(He.to,he.from))return!0;Dr(he.from,He.from)<0?he=(ae=te.next(He.from)).value:He=(Le=Ee.next(he.from)).value}return!1}function yg(M){var z=Mb(M)?null:{s:0,n:M};return{next:function(te){for(var ae=0<arguments.length;z;)switch(z.s){case 0:if(z.s=1,ae)for(;z.n.l&&Dr(te,z.n.from)<0;)z={up:z,n:z.n.l,s:1};else for(;z.n.l;)z={up:z,n:z.n.l,s:1};case 1:if(z.s=2,!ae||Dr(te,z.n.to)<=0)return{value:z.n,done:!1};case 2:if(z.n.r){z.s=3,z={up:z,n:z.n.r,s:0};continue}case 3:z=z.up}return{done:!0}}}}function b_(M){var z,te,ae=(((z=M.r)===null||z===void 0?void 0:z.d)||0)-(((te=M.l)===null||te===void 0?void 0:te.d)||0),he=1<ae?"r":ae<-1?"l":"";he&&(z=he=="r"?"l":"r",te=r({},M),ae=M[he],M.from=ae.from,M.to=ae.to,M[he]=ae[he],te[he]=ae[z],(M[z]=te).d=Ib(te)),M.d=Ib(M)}function Ib(te){var z=te.r,te=te.l;return(z?te?Math.max(z.d,te.d):z.d:te?te.d:0)+1}function bg(M,z){return a(z).forEach(function(te){M[te]?Xu(M[te],z[te]):M[te]=function ae(he){var Ee,Le,He={};for(Ee in he)d(he,Ee)&&(Le=he[Ee],He[Ee]=!Le||typeof Le!="object"||L.has(Le.constructor)?Le:ae(Le));return He}(z[te])}),M}function jb(M,z){return M.all||z.all||Object.keys(M).some(function(te){return z[te]&&y_(z[te],M[te])})}h(Ki.prototype,((Ha={add:function(M){return Xu(this,M),this},addKey:function(M){return gp(this,M,M),this},addKeys:function(M){var z=this;return M.forEach(function(te){return gp(z,te,te)}),this},hasKey:function(M){var z=yg(this).next(M).value;return z&&Dr(z.from,M)<=0&&0<=Dr(z.to,M)}})[U]=function(){return yg(this)},Ha));var Ju={},Pb={},Ob=!1;function vg(M){bg(Pb,M),Ob||(Ob=!0,setTimeout(function(){Ob=!1,Db(Pb,!(Pb={}))},0))}function Db(M,z){z===void 0&&(z=!1);var te=new Set;if(M.all)for(var ae=0,he=Object.values(Ju);ae<he.length;ae++)v_(Le=he[ae],M,te,z);else for(var Ee in M){var Le,He=/^idb\:\/\/(.*)\/(.*)\//.exec(Ee);He&&(Ee=He[1],He=He[2],(Le=Ju["idb://".concat(Ee,"/").concat(He)])&&v_(Le,M,te,z))}te.forEach(function(nt){return nt()})}function v_(M,z,te,ae){for(var he=[],Ee=0,Le=Object.entries(M.queries.query);Ee<Le.length;Ee++){for(var He=Le[Ee],nt=He[0],it=[],dt=0,Je=He[1];dt<Je.length;dt++){var mt=Je[dt];jb(z,mt.obsSet)?mt.subscribers.forEach(function(at){return te.add(at)}):ae&&it.push(mt)}ae&&he.push([nt,it])}if(ae)for(var tt=0,ut=he;tt<ut.length;tt++){var gt=ut[tt],nt=gt[0],it=gt[1];M.queries.query[nt]=it}}function vA(M){var z=M._state,te=M._deps.indexedDB;if(z.isBeingOpened||M.idbdb)return z.dbReadyPromise.then(function(){return z.dbOpenError?nr(z.dbOpenError):M});z.isBeingOpened=!0,z.dbOpenError=null,z.openComplete=!1;var ae=z.openCanceller,he=Math.round(10*M.verno),Ee=!1;function Le(){if(z.openCanceller!==ae)throw new Ce.DatabaseClosed("db.open() was cancelled")}function He(){return new B(function(mt,tt){if(Le(),!te)throw new Ce.MissingAPI;var ut=M.name,gt=z.autoSchema||!he?te.open(ut):te.open(ut,he);if(!gt)throw new Ce.MissingAPI;gt.onerror=Wo(tt),gt.onblocked=Oe(M._fireOnBlocked),gt.onupgradeneeded=Oe(function(at){var St;dt=gt.transaction,z.autoSchema&&!M._options.allowEmptyDB?(gt.onerror=Ku,dt.abort(),gt.result.close(),(St=te.deleteDatabase(ut)).onsuccess=St.onerror=Oe(function(){tt(new Ce.NoSuchDatabase("Database ".concat(ut," doesnt exist")))})):(dt.onerror=Wo(tt),at=at.oldVersion>Math.pow(2,62)?0:at.oldVersion,Je=at<1,M.idbdb=gt.result,Ee&&dg(M,dt),mp(M,at/10,dt,tt))},tt),gt.onsuccess=Oe(function(){dt=null;var at,St,Nt,Mt,Ot,Yt=M.idbdb=gt.result,rn=w(Yt.objectStoreNames);if(0<rn.length)try{var Ht=Yt.transaction((Mt=rn).length===1?Mt[0]:Mt,"readonly");if(z.autoSchema)St=Yt,Nt=Ht,(at=M).verno=St.version/10,Nt=at._dbSchema=_f(0,St,Nt),at._storeNames=w(St.objectStoreNames,0),ug(at,[at._allTables],a(Nt),Nt);else if(pg(M,M._dbSchema,Ht),((Ot=fg(_f(0,(Ot=M).idbdb,Ht),Ot._dbSchema)).add.length||Ot.change.some(function(Jt){return Jt.add.length||Jt.change.length}))&&!Ee)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),Yt.close(),he=Yt.version+1,Ee=!0,mt(He());Vc(M,Ht)}catch{}ci.push(M),Yt.onversionchange=Oe(function(Jt){z.vcFired=!0,M.on("versionchange").fire(Jt)}),Yt.onclose=Oe(function(Jt){M.on("close").fire(Jt)}),Je&&(Ot=M._deps,Ht=ut,Yt=Ot.indexedDB,Ot=Ot.IDBKeyRange,gg(Yt)||Ht===qa||Rb(Yt,Ot).put({name:Ht}).catch(Ve)),mt()},tt)}).catch(function(mt){switch(mt==null?void 0:mt.name){case"UnknownError":if(0<z.PR1398_maxLoop)return z.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),He();break;case"VersionError":if(0<he)return he=0,He()}return B.reject(mt)})}var nt,it=z.dbReadyResolve,dt=null,Je=!1;return B.race([ae,(typeof navigator>"u"?B.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(mt){function tt(){return indexedDB.databases().finally(mt)}nt=setInterval(tt,100),tt()}).finally(function(){return clearInterval(nt)}):Promise.resolve()).then(He)]).then(function(){return Le(),z.onReadyBeingFired=[],B.resolve(Nb(function(){return M.on.ready.fire(M.vip)})).then(function mt(){if(0<z.onReadyBeingFired.length){var tt=z.onReadyBeingFired.reduce(Te,Ve);return z.onReadyBeingFired=[],B.resolve(Nb(function(){return tt(M.vip)})).then(mt)}})}).finally(function(){z.openCanceller===ae&&(z.onReadyBeingFired=null,z.isBeingOpened=!1)}).catch(function(mt){z.dbOpenError=mt;try{dt&&dt.abort()}catch{}return ae===z.openCanceller&&M._close(),nr(mt)}).finally(function(){z.openComplete=!0,it()}).then(function(){var mt;return Je&&(mt={},M.tables.forEach(function(tt){tt.schema.indexes.forEach(function(ut){ut.name&&(mt["idb://".concat(M.name,"/").concat(tt.name,"/").concat(ut.name)]=new Ki(-1/0,[[[]]]))}),mt["idb://".concat(M.name,"/").concat(tt.name,"/")]=mt["idb://".concat(M.name,"/").concat(tt.name,"/:dels")]=new Ki(-1/0,[[[]]])}),Gi(bf).fire(mt),Db(mt,!0)),M})}function yp(M){function z(Ee){return M.next(Ee)}var te=he(z),ae=he(function(Ee){return M.throw(Ee)});function he(Ee){return function(nt){var He=Ee(nt),nt=He.value;return He.done?nt:nt&&typeof nt.then=="function"?nt.then(te,ae):o(nt)?Promise.all(nt).then(te,ae):te(nt)}}return he(z)()}function Wc(M,z,te){for(var ae=o(M)?M.slice():[M],he=0;he<te;++he)ae.push(z);return ae}var xA={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(M){return r(r({},M),{table:function(z){var te=M.table(z),ae=te.schema,he={},Ee=[];function Le(Je,mt,tt){var ut=xi(Je),gt=he[ut]=he[ut]||[],at=Je==null?0:typeof Je=="string"?1:Je.length,St=0<mt,St=r(r({},tt),{name:St?"".concat(ut,"(virtual-from:").concat(tt.name,")"):tt.name,lowLevelIndex:tt,isVirtual:St,keyTail:mt,keyLength:at,extractKey:wf(Je),unique:!St&&tt.unique});return gt.push(St),St.isPrimaryKey||Ee.push(St),1<at&&Le(at===2?Je[0]:Je.slice(0,at-1),mt+1,tt),gt.sort(function(Nt,Mt){return Nt.keyTail-Mt.keyTail}),St}z=Le(ae.primaryKey.keyPath,0,ae.primaryKey),he[":id"]=[z];for(var He=0,nt=ae.indexes;He<nt.length;He++){var it=nt[He];Le(it.keyPath,0,it)}function dt(Je){var mt,tt=Je.query.index;return tt.isVirtual?r(r({},Je),{query:{index:tt.lowLevelIndex,range:(mt=Je.query.range,tt=tt.keyTail,{type:mt.type===1?2:mt.type,lower:Wc(mt.lower,mt.lowerOpen?M.MAX_KEY:M.MIN_KEY,tt),lowerOpen:!0,upper:Wc(mt.upper,mt.upperOpen?M.MIN_KEY:M.MAX_KEY,tt),upperOpen:!0})}}):Je}return r(r({},te),{schema:r(r({},ae),{primaryKey:z,indexes:Ee,getIndexByKeyPath:function(Je){return(Je=he[xi(Je)])&&Je[0]}}),count:function(Je){return te.count(dt(Je))},query:function(Je){return te.query(dt(Je))},openCursor:function(Je){var mt=Je.query.index,tt=mt.keyTail,ut=mt.isVirtual,gt=mt.keyLength;return ut?te.openCursor(dt(Je)).then(function(St){return St&&at(St)}):te.openCursor(Je);function at(St){return Object.create(St,{continue:{value:function(Nt){Nt!=null?St.continue(Wc(Nt,Je.reverse?M.MAX_KEY:M.MIN_KEY,tt)):Je.unique?St.continue(St.key.slice(0,gt).concat(Je.reverse?M.MIN_KEY:M.MAX_KEY,tt)):St.continue()}},continuePrimaryKey:{value:function(Nt,Mt){St.continuePrimaryKey(Wc(Nt,M.MAX_KEY,tt),Mt)}},primaryKey:{get:function(){return St.primaryKey}},key:{get:function(){var Nt=St.key;return gt===1?Nt[0]:Nt.slice(0,gt)}},value:{get:function(){return St.value}}})}}})}})}};function xg(M,z,te,ae){return te=te||{},ae=ae||"",a(M).forEach(function(he){var Ee,Le,He;d(z,he)?(Ee=M[he],Le=z[he],typeof Ee=="object"&&typeof Le=="object"&&Ee&&Le?(He=Z(Ee))!==Z(Le)?te[ae+he]=z[he]:He==="Object"?xg(Ee,Le,te,ae+he+"."):Ee!==Le&&(te[ae+he]=z[he]):Ee!==Le&&(te[ae+he]=z[he])):te[ae+he]=void 0}),a(z).forEach(function(he){d(M,he)||(te[ae+he]=z[he])}),te}function wg(M,z){return z.type==="delete"?z.keys:z.keys||z.values.map(M.extractKey)}var x_={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(M){return r(r({},M),{table:function(z){var te=M.table(z),ae=te.schema.primaryKey;return r(r({},te),{mutate:function(he){var Ee=Me.trans,Le=Ee.table(z).hook,He=Le.deleting,nt=Le.creating,it=Le.updating;switch(he.type){case"add":if(nt.fire===Ve)break;return Ee._promise("readwrite",function(){return dt(he)},!0);case"put":if(nt.fire===Ve&&it.fire===Ve)break;return Ee._promise("readwrite",function(){return dt(he)},!0);case"delete":if(He.fire===Ve)break;return Ee._promise("readwrite",function(){return dt(he)},!0);case"deleteRange":if(He.fire===Ve)break;return Ee._promise("readwrite",function(){return function Je(mt,tt,ut){return te.query({trans:mt,values:!1,query:{index:ae,range:tt},limit:ut}).then(function(gt){var at=gt.result;return dt({type:"delete",keys:at,trans:mt}).then(function(St){return 0<St.numFailures?Promise.reject(St.failures[0]):at.length<ut?{failures:[],numFailures:0,lastResult:void 0}:Je(mt,r(r({},tt),{lower:at[at.length-1],lowerOpen:!0}),ut)})})}(he.trans,he.range,1e4)},!0)}return te.mutate(he);function dt(Je){var mt,tt,ut,gt=Me.trans,at=Je.keys||wg(ae,Je);if(!at)throw new Error("Keys missing");return(Je=Je.type==="add"||Je.type==="put"?r(r({},Je),{keys:at}):r({},Je)).type!=="delete"&&(Je.values=s([],Je.values)),Je.keys&&(Je.keys=s([],Je.keys)),mt=te,ut=at,((tt=Je).type==="add"?Promise.resolve([]):mt.getMany({trans:tt.trans,keys:ut,cache:"immutable"})).then(function(St){var Nt=at.map(function(Mt,Ot){var Yt,rn,Ht,Jt=St[Ot],an={onerror:null,onsuccess:null};return Je.type==="delete"?He.fire.call(an,Mt,Jt,gt):Je.type==="add"||Jt===void 0?(Yt=nt.fire.call(an,Mt,Je.values[Ot],gt),Mt==null&&Yt!=null&&(Je.keys[Ot]=Mt=Yt,ae.outbound||R(Je.values[Ot],ae.keyPath,Mt))):(Yt=xg(Jt,Je.values[Ot]),(rn=it.fire.call(an,Yt,Mt,Jt,gt))&&(Ht=Je.values[Ot],Object.keys(rn).forEach(function(Gt){d(Ht,Gt)?Ht[Gt]=rn[Gt]:R(Ht,Gt,rn[Gt])}))),an});return te.mutate(Je).then(function(Mt){for(var Ot=Mt.failures,Yt=Mt.results,rn=Mt.numFailures,Mt=Mt.lastResult,Ht=0;Ht<at.length;++Ht){var Jt=(Yt||at)[Ht],an=Nt[Ht];Jt==null?an.onerror&&an.onerror(Ot[Ht]):an.onsuccess&&an.onsuccess(Je.type==="put"&&St[Ht]?Je.values[Ht]:Jt)}return{failures:Ot,results:Yt,numFailures:rn,lastResult:Mt}}).catch(function(Mt){return Nt.forEach(function(Ot){return Ot.onerror&&Ot.onerror(Mt)}),Promise.reject(Mt)})})}}})}})}};function Fb(M,z,te){try{if(!z||z.keys.length<M.length)return null;for(var ae=[],he=0,Ee=0;he<z.keys.length&&Ee<M.length;++he)Dr(z.keys[he],M[Ee])===0&&(ae.push(te?V(z.values[he]):z.values[he]),++Ee);return ae.length===M.length?ae:null}catch{return null}}var w_={stack:"dbcore",level:-1,create:function(M){return{table:function(z){var te=M.table(z);return r(r({},te),{getMany:function(ae){if(!ae.cache)return te.getMany(ae);var he=Fb(ae.keys,ae.trans._cache,ae.cache==="clone");return he?B.resolve(he):te.getMany(ae).then(function(Ee){return ae.trans._cache={keys:ae.keys,values:ae.cache==="clone"?V(Ee):Ee},Ee})},mutate:function(ae){return ae.type!=="add"&&(ae.trans._cache=null),te.mutate(ae)}})}}}};function Qu(M,z){return M.trans.mode==="readonly"&&!!M.subscr&&!M.trans.explicit&&M.trans.db._options.cache!=="disabled"&&!z.schema.primaryKey.outbound}function __(M,z){switch(M){case"query":return z.values&&!z.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var wA={stack:"dbcore",level:0,name:"Observability",create:function(M){var z=M.schema.name,te=new Ki(M.MIN_KEY,M.MAX_KEY);return r(r({},M),{transaction:function(ae,he,Ee){if(Me.subscr&&he!=="readonly")throw new Ce.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(Me.querier));return M.transaction(ae,he,Ee)},table:function(ae){var he=M.table(ae),Ee=he.schema,Le=Ee.primaryKey,Je=Ee.indexes,He=Le.extractKey,nt=Le.outbound,it=Le.autoIncrement&&Je.filter(function(tt){return tt.compound&&tt.keyPath.includes(Le.keyPath)}),dt=r(r({},he),{mutate:function(tt){function ut(Gt){return Gt="idb://".concat(z,"/").concat(ae,"/").concat(Gt),Mt[Gt]||(Mt[Gt]=new Ki)}var gt,at,St,Nt=tt.trans,Mt=tt.mutatedParts||(tt.mutatedParts={}),Ot=ut(""),Yt=ut(":dels"),rn=tt.type,an=tt.type==="deleteRange"?[tt.range]:tt.type==="delete"?[tt.keys]:tt.values.length<50?[wg(Le,tt).filter(function(Gt){return Gt}),tt.values]:[],Ht=an[0],Jt=an[1],an=tt.trans._cache;return o(Ht)?(Ot.addKeys(Ht),(an=rn==="delete"||Ht.length===Jt.length?Fb(Ht,an):null)||Yt.addKeys(Ht),(an||Jt)&&(gt=ut,at=an,St=Jt,Ee.indexes.forEach(function(Gt){var mn=gt(Gt.name||"");function Bn(fr){return fr!=null?Gt.extractKey(fr):null}function Vn(fr){return Gt.multiEntry&&o(fr)?fr.forEach(function(da){return mn.addKey(da)}):mn.addKey(fr)}(at||St).forEach(function(fr,ui){var rr=at&&Bn(at[ui]),ui=St&&Bn(St[ui]);Dr(rr,ui)!==0&&(rr!=null&&Vn(rr),ui!=null&&Vn(ui))})}))):Ht?(Jt={from:(Jt=Ht.lower)!==null&&Jt!==void 0?Jt:M.MIN_KEY,to:(Jt=Ht.upper)!==null&&Jt!==void 0?Jt:M.MAX_KEY},Yt.add(Jt),Ot.add(Jt)):(Ot.add(te),Yt.add(te),Ee.indexes.forEach(function(Gt){return ut(Gt.name).add(te)})),he.mutate(tt).then(function(Gt){return!Ht||tt.type!=="add"&&tt.type!=="put"||(Ot.addKeys(Gt.results),it&&it.forEach(function(mn){for(var Bn=tt.values.map(function(rr){return mn.extractKey(rr)}),Vn=mn.keyPath.findIndex(function(rr){return rr===Le.keyPath}),fr=0,da=Gt.results.length;fr<da;++fr)Bn[fr][Vn]=Gt.results[fr];ut(mn.name).addKeys(Bn)})),Nt.mutatedParts=bg(Nt.mutatedParts||{},Mt),Gt})}}),Je=function(ut){var gt=ut.query,ut=gt.index,gt=gt.range;return[ut,new Ki((ut=gt.lower)!==null&&ut!==void 0?ut:M.MIN_KEY,(gt=gt.upper)!==null&&gt!==void 0?gt:M.MAX_KEY)]},mt={get:function(tt){return[Le,new Ki(tt.key)]},getMany:function(tt){return[Le,new Ki().addKeys(tt.keys)]},count:Je,query:Je,openCursor:Je};return a(mt).forEach(function(tt){dt[tt]=function(ut){var gt=Me.subscr,at=!!gt,St=Qu(Me,he)&&__(tt,ut)?ut.obsSet={}:gt;if(at){var Nt=function(Jt){return Jt="idb://".concat(z,"/").concat(ae,"/").concat(Jt),St[Jt]||(St[Jt]=new Ki)},Mt=Nt(""),Ot=Nt(":dels"),gt=mt[tt](ut),at=gt[0],gt=gt[1];if((tt==="query"&&at.isPrimaryKey&&!ut.values?Ot:Nt(at.name||"")).add(gt),!at.isPrimaryKey){if(tt!=="count"){var Yt=tt==="query"&&nt&&ut.values&&he.query(r(r({},ut),{values:!1}));return he[tt].apply(this,arguments).then(function(Jt){if(tt==="query"){if(nt&&ut.values)return Yt.then(function(Bn){return Bn=Bn.result,Mt.addKeys(Bn),Jt});var an=ut.values?Jt.result.map(He):Jt.result;(ut.values?Mt:Ot).addKeys(an)}else if(tt==="openCursor"){var Gt=Jt,mn=ut.values;return Gt&&Object.create(Gt,{key:{get:function(){return Ot.addKey(Gt.primaryKey),Gt.key}},primaryKey:{get:function(){var Bn=Gt.primaryKey;return Ot.addKey(Bn),Bn}},value:{get:function(){return mn&&Mt.addKey(Gt.primaryKey),Gt.value}}})}return Jt})}Ot.add(te)}}return he[tt].apply(this,arguments)}}),dt}})}};function S_(M,z,te){if(te.numFailures===0)return z;if(z.type==="deleteRange")return null;var ae=z.keys?z.keys.length:"values"in z&&z.values?z.values.length:1;return te.numFailures===ae?null:(z=r({},z),o(z.keys)&&(z.keys=z.keys.filter(function(he,Ee){return!(Ee in te.failures)})),"values"in z&&o(z.values)&&(z.values=z.values.filter(function(he,Ee){return!(Ee in te.failures)})),z)}function _g(M,z){return te=M,((ae=z).lower===void 0||(ae.lowerOpen?0<Dr(te,ae.lower):0<=Dr(te,ae.lower)))&&(M=M,(z=z).upper===void 0||(z.upperOpen?Dr(M,z.upper)<0:Dr(M,z.upper)<=0));var te,ae}function Lb(M,z,mt,ae,he,Ee){if(!mt||mt.length===0)return M;var Le=z.query.index,He=Le.multiEntry,nt=z.query.range,it=ae.schema.primaryKey.extractKey,dt=Le.extractKey,Je=(Le.lowLevelIndex||Le).extractKey,mt=mt.reduce(function(tt,ut){var gt=tt,at=[];if(ut.type==="add"||ut.type==="put")for(var St=new Ki,Nt=ut.values.length-1;0<=Nt;--Nt){var Mt,Ot=ut.values[Nt],Yt=it(Ot);St.hasKey(Yt)||(Mt=dt(Ot),(He&&o(Mt)?Mt.some(function(Gt){return _g(Gt,nt)}):_g(Mt,nt))&&(St.addKey(Yt),at.push(Ot)))}switch(ut.type){case"add":var rn=new Ki().addKeys(z.values?tt.map(function(mn){return it(mn)}):tt),gt=tt.concat(z.values?at.filter(function(mn){return mn=it(mn),!rn.hasKey(mn)&&(rn.addKey(mn),!0)}):at.map(function(mn){return it(mn)}).filter(function(mn){return!rn.hasKey(mn)&&(rn.addKey(mn),!0)}));break;case"put":var Ht=new Ki().addKeys(ut.values.map(function(mn){return it(mn)}));gt=tt.filter(function(mn){return!Ht.hasKey(z.values?it(mn):mn)}).concat(z.values?at:at.map(function(mn){return it(mn)}));break;case"delete":var Jt=new Ki().addKeys(ut.keys);gt=tt.filter(function(mn){return!Jt.hasKey(z.values?it(mn):mn)});break;case"deleteRange":var an=ut.range;gt=tt.filter(function(mn){return!_g(it(mn),an)})}return gt},M);return mt===M?M:(mt.sort(function(tt,ut){return Dr(Je(tt),Je(ut))||Dr(it(tt),it(ut))}),z.limit&&z.limit<1/0&&(mt.length>z.limit?mt.length=z.limit:M.length===z.limit&&mt.length<z.limit&&(he.dirty=!0)),Ee?Object.freeze(mt):mt)}function Sf(M,z){return Dr(M.lower,z.lower)===0&&Dr(M.upper,z.upper)===0&&!!M.lowerOpen==!!z.lowerOpen&&!!M.upperOpen==!!z.upperOpen}function bp(M,z){return function(te,ae,he,Ee){if(te===void 0)return ae!==void 0?-1:0;if(ae===void 0)return 1;if((ae=Dr(te,ae))===0){if(he&&Ee)return 0;if(he)return 1;if(Ee)return-1}return ae}(M.lower,z.lower,M.lowerOpen,z.lowerOpen)<=0&&0<=function(te,ae,he,Ee){if(te===void 0)return ae!==void 0?1:0;if(ae===void 0)return-1;if((ae=Dr(te,ae))===0){if(he&&Ee)return 0;if(he)return-1;if(Ee)return 1}return ae}(M.upper,z.upper,M.upperOpen,z.upperOpen)}function _A(M,z,te,ae){M.subscribers.add(te),ae.addEventListener("abort",function(){var he,Ee;M.subscribers.delete(te),M.subscribers.size===0&&(he=M,Ee=z,setTimeout(function(){he.subscribers.size===0&&$(Ee,he)},3e3))})}var Sg={stack:"dbcore",level:0,name:"Cache",create:function(M){var z=M.schema.name;return r(r({},M),{transaction:function(te,ae,he){var Ee,Le,He=M.transaction(te,ae,he);return ae==="readwrite"&&(Le=(Ee=new AbortController).signal,he=function(nt){return function(){if(Ee.abort(),ae==="readwrite"){for(var it=new Set,dt=0,Je=te;dt<Je.length;dt++){var mt=Je[dt],tt=Ju["idb://".concat(z,"/").concat(mt)];if(tt){var ut=M.table(mt),gt=tt.optimisticOps.filter(function(mn){return mn.trans===He});if(He._explicit&&nt&&He.mutatedParts)for(var at=0,St=Object.values(tt.queries.query);at<St.length;at++)for(var Nt=0,Mt=(rn=St[at]).slice();Nt<Mt.length;Nt++)jb((Ht=Mt[Nt]).obsSet,He.mutatedParts)&&($(rn,Ht),Ht.subscribers.forEach(function(mn){return it.add(mn)}));else if(0<gt.length){tt.optimisticOps=tt.optimisticOps.filter(function(mn){return mn.trans!==He});for(var Ot=0,Yt=Object.values(tt.queries.query);Ot<Yt.length;Ot++)for(var rn,Ht,Jt,an=0,Gt=(rn=Yt[Ot]).slice();an<Gt.length;an++)(Ht=Gt[an]).res!=null&&He.mutatedParts&&(nt&&!Ht.dirty?(Jt=Object.isFrozen(Ht.res),Jt=Lb(Ht.res,Ht.req,gt,ut,Ht,Jt),Ht.dirty?($(rn,Ht),Ht.subscribers.forEach(function(mn){return it.add(mn)})):Jt!==Ht.res&&(Ht.res=Jt,Ht.promise=B.resolve({result:Jt}))):(Ht.dirty&&$(rn,Ht),Ht.subscribers.forEach(function(mn){return it.add(mn)})))}}}it.forEach(function(mn){return mn()})}}},He.addEventListener("abort",he(!1),{signal:Le}),He.addEventListener("error",he(!1),{signal:Le}),He.addEventListener("complete",he(!0),{signal:Le})),He},table:function(te){var ae=M.table(te),he=ae.schema.primaryKey;return r(r({},ae),{mutate:function(Ee){var Le=Me.trans;if(he.outbound||Le.db._options.cache==="disabled"||Le.explicit||Le.idbtrans.mode!=="readwrite")return ae.mutate(Ee);var He=Ju["idb://".concat(z,"/").concat(te)];return He?(Le=ae.mutate(Ee),Ee.type!=="add"&&Ee.type!=="put"||!(50<=Ee.values.length||wg(he,Ee).some(function(nt){return nt==null}))?(He.optimisticOps.push(Ee),Ee.mutatedParts&&vg(Ee.mutatedParts),Le.then(function(nt){0<nt.numFailures&&($(He.optimisticOps,Ee),(nt=S_(0,Ee,nt))&&He.optimisticOps.push(nt),Ee.mutatedParts&&vg(Ee.mutatedParts))}),Le.catch(function(){$(He.optimisticOps,Ee),Ee.mutatedParts&&vg(Ee.mutatedParts)})):Le.then(function(nt){var it=S_(0,r(r({},Ee),{values:Ee.values.map(function(dt,Je){var mt;return nt.failures[Je]?dt:(dt=(mt=he.keyPath)!==null&&mt!==void 0&&mt.includes(".")?V(dt):r({},dt),R(dt,he.keyPath,nt.results[Je]),dt)})}),nt);He.optimisticOps.push(it),queueMicrotask(function(){return Ee.mutatedParts&&vg(Ee.mutatedParts)})}),Le):ae.mutate(Ee)},query:function(Ee){if(!Qu(Me,ae)||!__("query",Ee))return ae.query(Ee);var Le=((it=Me.trans)===null||it===void 0?void 0:it.db._options.cache)==="immutable",Je=Me,He=Je.requery,nt=Je.signal,it=function(ut,gt,at,St){var Nt=Ju["idb://".concat(ut,"/").concat(gt)];if(!Nt)return[];if(!(gt=Nt.queries[at]))return[null,!1,Nt,null];var Mt=gt[(St.query?St.query.index.name:null)||""];if(!Mt)return[null,!1,Nt,null];switch(at){case"query":var Ot=Mt.find(function(Yt){return Yt.req.limit===St.limit&&Yt.req.values===St.values&&Sf(Yt.req.query.range,St.query.range)});return Ot?[Ot,!0,Nt,Mt]:[Mt.find(function(Yt){return("limit"in Yt.req?Yt.req.limit:1/0)>=St.limit&&(!St.values||Yt.req.values)&&bp(Yt.req.query.range,St.query.range)}),!1,Nt,Mt];case"count":return Ot=Mt.find(function(Yt){return Sf(Yt.req.query.range,St.query.range)}),[Ot,!!Ot,Nt,Mt]}}(z,te,"query",Ee),dt=it[0],Je=it[1],mt=it[2],tt=it[3];return dt&&Je?dt.obsSet=Ee.obsSet:(Je=ae.query(Ee).then(function(ut){var gt=ut.result;if(dt&&(dt.res=gt),Le){for(var at=0,St=gt.length;at<St;++at)Object.freeze(gt[at]);Object.freeze(gt)}else ut.result=V(gt);return ut}).catch(function(ut){return tt&&dt&&$(tt,dt),Promise.reject(ut)}),dt={obsSet:Ee.obsSet,promise:Je,subscribers:new Set,type:"query",req:Ee,dirty:!1},tt?tt.push(dt):(tt=[dt],(mt=mt||(Ju["idb://".concat(z,"/").concat(te)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[Ee.query.index.name||""]=tt)),_A(dt,tt,He,nt),dt.promise.then(function(ut){return{result:Lb(ut.result,Ee,mt==null?void 0:mt.optimisticOps,ae,dt,Le)}})}})}})}};function vp(M,z){return new Proxy(M,{get:function(te,ae,he){return ae==="db"?z:Reflect.get(te,ae,he)}})}var kl=(Ls.prototype.version=function(M){if(isNaN(M)||M<.1)throw new Ce.Type("Given version is not a positive number");if(M=Math.round(10*M)/10,this.idbdb||this._state.isBeingOpened)throw new Ce.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,M);var z=this._versions,te=z.filter(function(ae){return ae._cfg.version===M})[0];return te||(te=new this.Version(M),z.push(te),z.sort(Tb),te.stores({}),this._state.autoSchema=!1,te)},Ls.prototype._whenReady=function(M){var z=this;return this.idbdb&&(this._state.openComplete||Me.letThrough||this._vip)?M():new B(function(te,ae){if(z._state.openComplete)return ae(new Ce.DatabaseClosed(z._state.dbOpenError));if(!z._state.isBeingOpened){if(!z._state.autoOpen)return void ae(new Ce.DatabaseClosed);z.open().catch(Ve)}z._state.dbReadyPromise.then(te,ae)}).then(M)},Ls.prototype.use=function(M){var z=M.stack,te=M.create,ae=M.level,he=M.name;return he&&this.unuse({stack:z,name:he}),M=this._middlewares[z]||(this._middlewares[z]=[]),M.push({stack:z,create:te,level:ae??10,name:he}),M.sort(function(Ee,Le){return Ee.level-Le.level}),this},Ls.prototype.unuse=function(M){var z=M.stack,te=M.name,ae=M.create;return z&&this._middlewares[z]&&(this._middlewares[z]=this._middlewares[z].filter(function(he){return ae?he.create!==ae:!!te&&he.name!==te})),this},Ls.prototype.open=function(){var M=this;return et(we,function(){return vA(M)})},Ls.prototype._close=function(){var M=this._state,z=ci.indexOf(this);if(0<=z&&ci.splice(z,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}M.isBeingOpened||(M.dbReadyPromise=new B(function(te){M.dbReadyResolve=te}),M.openCanceller=new B(function(te,ae){M.cancelOpen=ae}))},Ls.prototype.close=function(te){var z=(te===void 0?{disableAutoOpen:!0}:te).disableAutoOpen,te=this._state;z?(te.isBeingOpened&&te.cancelOpen(new Ce.DatabaseClosed),this._close(),te.autoOpen=!1,te.dbOpenError=new Ce.DatabaseClosed):(this._close(),te.autoOpen=this._options.autoOpen||te.isBeingOpened,te.openComplete=!1,te.dbOpenError=null)},Ls.prototype.delete=function(M){var z=this;M===void 0&&(M={disableAutoOpen:!0});var te=0<arguments.length&&typeof arguments[0]!="object",ae=this._state;return new B(function(he,Ee){function Le(){z.close(M);var He=z._deps.indexedDB.deleteDatabase(z.name);He.onsuccess=Oe(function(){var nt,it,dt;nt=z._deps,it=z.name,dt=nt.indexedDB,nt=nt.IDBKeyRange,gg(dt)||it===qa||Rb(dt,nt).delete(it).catch(Ve),he()}),He.onerror=Wo(Ee),He.onblocked=z._fireOnBlocked}if(te)throw new Ce.InvalidArgument("Invalid closeOptions argument to db.delete()");ae.isBeingOpened?ae.dbReadyPromise.then(Le):Le()})},Ls.prototype.backendDB=function(){return this.idbdb},Ls.prototype.isOpen=function(){return this.idbdb!==null},Ls.prototype.hasBeenClosed=function(){var M=this._state.dbOpenError;return M&&M.name==="DatabaseClosed"},Ls.prototype.hasFailed=function(){return this._state.dbOpenError!==null},Ls.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(Ls.prototype,"tables",{get:function(){var M=this;return a(this._allTables).map(function(z){return M._allTables[z]})},enumerable:!1,configurable:!0}),Ls.prototype.transaction=function(){var M=(function(z,te,ae){var he=arguments.length;if(he<2)throw new Ce.InvalidArgument("Too few arguments");for(var Ee=new Array(he-1);--he;)Ee[he-1]=arguments[he];return ae=Ee.pop(),[z,P(Ee),ae]}).apply(this,arguments);return this._transaction.apply(this,M)},Ls.prototype._transaction=function(M,z,te){var ae=this,he=Me.trans;he&&he.db===this&&M.indexOf("!")===-1||(he=null);var Ee,Le,He=M.indexOf("?")!==-1;M=M.replace("!","").replace("?","");try{if(Le=z.map(function(it){if(it=it instanceof ae.Table?it.name:it,typeof it!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return it}),M=="r"||M===ua)Ee=ua;else{if(M!="rw"&&M!=Ws)throw new Ce.InvalidArgument("Invalid transaction mode: "+M);Ee=Ws}if(he){if(he.mode===ua&&Ee===Ws){if(!He)throw new Ce.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");he=null}he&&Le.forEach(function(it){if(he&&he.storeNames.indexOf(it)===-1){if(!He)throw new Ce.SubTransaction("Table "+it+" not included in parent transaction.");he=null}}),He&&he&&!he.active&&(he=null)}}catch(it){return he?he._promise(null,function(dt,Je){Je(it)}):nr(it)}var nt=(function it(dt,Je,mt,tt,ut){return B.resolve().then(function(){var gt=Me.transless||Me,at=dt._createTransaction(Je,mt,dt._dbSchema,tt);if(at.explicit=!0,gt={trans:at,transless:gt},tt)at.idbtrans=tt.idbtrans;else try{at.create(),at.idbtrans._explicit=!0,dt._state.PR1398_maxLoop=3}catch(Mt){return Mt.name===De.InvalidState&&dt.isOpen()&&0<--dt._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),dt.close({disableAutoOpen:!1}),dt.open().then(function(){return it(dt,Je,mt,null,ut)})):nr(Mt)}var St,Nt=Q(ut);return Nt&&mr(),gt=B.follow(function(){var Mt;(St=ut.call(at,at))&&(Nt?(Mt=Rr.bind(null,null),St.then(Mt,Mt)):typeof St.next=="function"&&typeof St.throw=="function"&&(St=yp(St)))},gt),(St&&typeof St.then=="function"?B.resolve(St).then(function(Mt){return at.active?Mt:nr(new Ce.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):gt.then(function(){return St})).then(function(Mt){return tt&&at._resolve(),at._completion.then(function(){return Mt})}).catch(function(Mt){return at._reject(Mt),nr(Mt)})})}).bind(null,this,Ee,Le,he,te);return he?he._promise(Ee,nt,"lock"):Me.trans?et(Me.transless,function(){return ae._whenReady(nt)}):this._whenReady(nt)},Ls.prototype.table=function(M){if(!d(this._allTables,M))throw new Ce.InvalidTable("Table ".concat(M," does not exist"));return this._allTables[M]},Ls);function Ls(M,z){var te=this;this._middlewares={},this.verno=0;var ae=Ls.dependencies;this._options=z=r({addons:Ls.addons,autoOpen:!0,indexedDB:ae.indexedDB,IDBKeyRange:ae.IDBKeyRange,cache:"cloned"},z),this._deps={indexedDB:z.indexedDB,IDBKeyRange:z.IDBKeyRange},ae=z.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var he,Ee,Le,He,nt,it={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:Ve,dbReadyPromise:null,cancelOpen:Ve,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:z.autoOpen};it.dbReadyPromise=new B(function(Je){it.dbReadyResolve=Je}),it.openCanceller=new B(function(Je,mt){it.cancelOpen=mt}),this._state=it,this.name=M,this.on=qc(this,"populate","blocked","versionchange","close",{ready:[Te,Ve]}),this.on.ready.subscribe=S(this.on.ready.subscribe,function(Je){return function(mt,tt){Ls.vip(function(){var ut,gt=te._state;gt.openComplete?(gt.dbOpenError||B.resolve().then(mt),tt&&Je(mt)):gt.onReadyBeingFired?(gt.onReadyBeingFired.push(mt),tt&&Je(mt)):(Je(mt),ut=te,tt||Je(function at(){ut.on.ready.unsubscribe(mt),ut.on.ready.unsubscribe(at)}))})}}),this.Collection=(he=this,ff(gf.prototype,function(St,at){this.db=he;var tt=_l,ut=null;if(at)try{tt=at()}catch(Nt){ut=Nt}var gt=St._ctx,at=gt.table,St=at.hook.reading.fire;this._ctx={table:at,index:gt.index,isPrimKey:!gt.index||at.schema.primKey.keyPath&&gt.index===at.schema.primKey.name,range:tt,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:ut,or:gt.or,valueMapper:St!==Ne?St:null}})),this.Table=(Ee=this,ff(wb.prototype,function(Je,mt,tt){this.db=Ee,this._tx=tt,this.name=Je,this.schema=mt,this.hook=Ee._allTables[Je]?Ee._allTables[Je].hook:qc(null,{creating:[Ae,Ve],reading:[K,Ne],updating:[oe,Ve],deleting:[le,Ve]})})),this.Transaction=(Le=this,ff(Eb.prototype,function(Je,mt,tt,ut,gt){var at=this;this.db=Le,this.mode=Je,this.storeNames=mt,this.schema=tt,this.chromeTransactionDurability=ut,this.idbtrans=null,this.on=qc(this,"complete","error","abort"),this.parent=gt||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new B(function(St,Nt){at._resolve=St,at._reject=Nt}),this._completion.then(function(){at.active=!1,at.on.complete.fire()},function(St){var Nt=at.active;return at.active=!1,at.on.error.fire(St),at.parent?at.parent._reject(St):Nt&&at.idbtrans&&at.idbtrans.abort(),nr(St)})})),this.Version=(He=this,ff(bA.prototype,function(Je){this.db=He,this._cfg={version:Je,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(nt=this,ff(Gu.prototype,function(Je,mt,tt){if(this.db=nt,this._ctx={table:Je,index:mt===":id"?null:mt,or:tt},this._cmp=this._ascending=Dr,this._descending=function(ut,gt){return Dr(gt,ut)},this._max=function(ut,gt){return 0<Dr(ut,gt)?ut:gt},this._min=function(ut,gt){return Dr(ut,gt)<0?ut:gt},this._IDBKeyRange=nt._deps.IDBKeyRange,!this._IDBKeyRange)throw new Ce.MissingAPI})),this.on("versionchange",function(Je){0<Je.newVersion?console.warn("Another connection wants to upgrade database '".concat(te.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(te.name,"'. Closing db now to resume the delete request.")),te.close({disableAutoOpen:!1})}),this.on("blocked",function(Je){!Je.newVersion||Je.newVersion<Je.oldVersion?console.warn("Dexie.delete('".concat(te.name,"') was blocked")):console.warn("Upgrade '".concat(te.name,"' blocked by other connection holding version ").concat(Je.oldVersion/10))}),this._maxKey=xf(z.IDBKeyRange),this._createTransaction=function(Je,mt,tt,ut){return new te.Transaction(Je,mt,tt,te._options.chromeTransactionDurability,ut)},this._fireOnBlocked=function(Je){te.on("blocked").fire(Je),ci.filter(function(mt){return mt.name===te.name&&mt!==te&&!mt._state.vcFired}).map(function(mt){return mt.on("versionchange").fire(Je)})},this.use(w_),this.use(Sg),this.use(wA),this.use(xA),this.use(x_);var dt=new Proxy(this,{get:function(Je,mt,tt){if(mt==="_vip")return!0;if(mt==="table")return function(gt){return vp(te.table(gt),dt)};var ut=Reflect.get(Je,mt,tt);return ut instanceof wb?vp(ut,dt):mt==="tables"?ut.map(function(gt){return vp(gt,dt)}):mt==="_createTransaction"?function(){return vp(ut.apply(this,arguments),dt)}:ut}});this.vip=dt,ae.forEach(function(Je){return Je(te)})}var Cf,Ha=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",C_=(Cg.prototype.subscribe=function(M,z,te){return this._subscribe(M&&typeof M!="function"?M:{next:M,error:z,complete:te})},Cg.prototype[Ha]=function(){return this},Cg);function Cg(M){this._subscribe=M}try{Cf={indexedDB:i.indexedDB||i.mozIndexedDB||i.webkitIndexedDB||i.msIndexedDB,IDBKeyRange:i.IDBKeyRange||i.webkitIDBKeyRange}}catch{Cf={indexedDB:null,IDBKeyRange:null}}function k_(M){var z,te=!1,ae=new C_(function(he){var Ee=Q(M),Le,He=!1,nt={},it={},dt={get closed(){return He},unsubscribe:function(){He||(He=!0,Le&&Le.abort(),Je&&Gi.storagemutated.unsubscribe(tt))}};he.start&&he.start(dt);var Je=!1,mt=function(){return pn(ut)},tt=function(gt){bg(nt,gt),jb(it,nt)&&mt()},ut=function(){var gt,at,St;!He&&Cf.indexedDB&&(nt={},gt={},Le&&Le.abort(),Le=new AbortController,St=function(Nt){var Mt=Y();try{Ee&&mr();var Ot=un(M,Nt);return Ot=Ee?Ot.finally(Rr):Ot}finally{Mt&&G()}}(at={subscr:gt,signal:Le.signal,requery:mt,querier:M,trans:null}),Promise.resolve(St).then(function(Nt){te=!0,z=Nt,He||at.signal.aborted||(nt={},function(Mt){for(var Ot in Mt)if(d(Mt,Ot))return;return 1}(it=gt)||Je||(Gi(bf,tt),Je=!0),pn(function(){return!He&&he.next&&he.next(Nt)}))},function(Nt){te=!1,["DatabaseClosedError","AbortError"].includes(Nt==null?void 0:Nt.name)||He||pn(function(){He||he.error&&he.error(Nt)})}))};return setTimeout(mt,0),dt});return ae.hasValue=function(){return te},ae.getValue=function(){return z},ae}var ed=kl;function Bb(M){var z=Hc;try{Hc=!0,Gi.storagemutated.fire(M),Db(M,!0)}finally{Hc=z}}h(ed,r(r({},Qe),{delete:function(M){return new ed(M,{addons:[]}).delete()},exists:function(M){return new ed(M,{addons:[]}).open().then(function(z){return z.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(M){try{return z=ed.dependencies,te=z.indexedDB,z=z.IDBKeyRange,(gg(te)?Promise.resolve(te.databases()).then(function(ae){return ae.map(function(he){return he.name}).filter(function(he){return he!==qa})}):Rb(te,z).toCollection().primaryKeys()).then(M)}catch{return nr(new Ce.MissingAPI)}var z,te},defineClass:function(){return function(M){l(this,M)}},ignoreTransaction:function(M){return Me.trans?et(Me.transless,M):M()},vip:Nb,async:function(M){return function(){try{var z=yp(M.apply(this,arguments));return z&&typeof z.then=="function"?z:B.resolve(z)}catch(te){return nr(te)}}},spawn:function(M,z,te){try{var ae=yp(M.apply(te,z||[]));return ae&&typeof ae.then=="function"?ae:B.resolve(ae)}catch(he){return nr(he)}},currentTransaction:{get:function(){return Me.trans||null}},waitFor:function(M,z){return z=B.resolve(typeof M=="function"?ed.ignoreTransaction(M):M).timeout(z||6e4),Me.trans?Me.trans.waitFor(z):z},Promise:B,debug:{get:function(){return Be},set:function(M){ke(M)}},derive:b,extend:l,props:h,override:S,Events:qc,on:Gi,liveQuery:k_,extendObservabilitySet:bg,getByKeyPath:A,setByKeyPath:R,delByKeyPath:function(M,z){typeof z=="string"?R(M,z,void 0):"length"in z&&[].map.call(z,function(te){R(M,te,void 0)})},shallowClone:N,deepClone:V,getObjectDiff:xg,cmp:Dr,asap:k,minKey:-1/0,addons:[],connections:ci,errnames:De,dependencies:Cf,cache:Ju,semVer:"4.0.11",version:"4.0.11".split(".").map(function(M){return parseInt(M)}).reduce(function(M,z,te){return M+z/Math.pow(10,2*te)})})),ed.maxKey=xf(ed.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(Gi(bf,function(M){Hc||(M=new CustomEvent(Yu,{detail:M}),Hc=!0,dispatchEvent(M),Hc=!1)}),addEventListener(Yu,function(M){M=M.detail,Hc||Bb(M)}));var kf,Hc=!1,ka=function(){};return typeof BroadcastChannel<"u"&&((ka=function(){(kf=new BroadcastChannel(Yu)).onmessage=function(M){return M.data&&Bb(M.data)}})(),typeof kf.unref=="function"&&kf.unref(),Gi(bf,function(M){Hc||kf.postMessage(M)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(M){if(!kl.disableBfCache&&M.persisted){Be&&console.debug("Dexie: handling persisted pagehide"),kf!=null&&kf.close();for(var z=0,te=ci;z<te.length;z++)te[z].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(M){!kl.disableBfCache&&M.persisted&&(Be&&console.debug("Dexie: handling persisted pageshow"),ka(),Bb({all:new Ki(-1/0,[[]])}))})),B.rejectionMapper=function(M,z){return!M||M instanceof se||M instanceof TypeError||M instanceof SyntaxError||!M.name||!qe[M.name]?M:(z=new qe[M.name](z||M.message,M),"stack"in M&&y(z,"stack",{get:function(){return this.inner.stack}}),z)},ke(Be),r(kl,Object.freeze({__proto__:null,Dexie:kl,liveQuery:k_,Entity:ig,cmp:Dr,PropModification:mf,replacePrefix:function(M,z){return new mf({replacePrefix:[M,z]})},add:function(M){return new mf({add:M})},remove:function(M){return new mf({remove:M})},default:kl,RangeSet:Ki,mergeRanges:Xu,rangesOverlap:y_}),{default:kl}),kl})}(S2)),S2.exports}var f0e=d0e();const X3=_a(f0e),PB=Symbol.for("Dexie"),aC=globalThis[PB]||(globalThis[PB]=X3);if(X3.semVer!==aC.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${X3.semVer} and ${aC.semVer}`);const{liveQuery:Aut,mergeRanges:Rut,rangesOverlap:Nut,RangeSet:Mut,cmp:Iut,Entity:jut,PropModification:Put,replacePrefix:Out,add:Dut,remove:Fut}=aC;class h0e extends aC{constructor(){super("LiteChatDatabase_Rewrite_v1");me(this,"conversations");me(this,"interactions");me(this,"mods");me(this,"appState");me(this,"providerConfigs");me(this,"apiKeys");me(this,"syncRepos");me(this,"projects");me(this,"rules");me(this,"tags");me(this,"tagRuleLinks");me(this,"promptTemplates");this.version(9).stores({conversations:"++id, title, createdAt, updatedAt, syncRepoId, lastSyncedAt, projectId",interactions:"++id, conversationId, index, type, status, startedAt, parentId, rating",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name",syncRepos:"++id, &name, remoteUrl, username",projects:"++id, &path, parentId, createdAt, updatedAt, name",rules:"++id, &name, type, createdAt, updatedAt",tags:"++id, &name, createdAt, updatedAt",tagRuleLinks:"++id, tagId, ruleId, &[tagId+ruleId]",promptTemplates:"++id, &name, createdAt, updatedAt, isPublic"}),this.version(8).stores({conversations:"++id, title, createdAt, updatedAt, syncRepoId, lastSyncedAt, projectId",interactions:"++id, conversationId, index, type, status, startedAt, parentId, rating",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name",syncRepos:"++id, &name, remoteUrl, username",projects:"++id, &path, parentId, createdAt, updatedAt, name",rules:"++id, &name, type, createdAt, updatedAt",tags:"++id, &name, createdAt, updatedAt",tagRuleLinks:"++id, tagId, ruleId, &[tagId+ruleId]"}),this.version(7).stores({conversations:"++id, title, createdAt, updatedAt, syncRepoId, lastSyncedAt, projectId",interactions:"++id, conversationId, index, type, status, startedAt, parentId",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name",syncRepos:"++id, &name, remoteUrl, username",projects:"++id, &path, parentId, createdAt, updatedAt, name",rules:"++id, &name, type, createdAt, updatedAt",tags:"++id, &name, createdAt, updatedAt",tagRuleLinks:"++id, tagId, ruleId, &[tagId+ruleId]"}),this.version(6).stores({conversations:"++id, title, createdAt, updatedAt, syncRepoId, lastSyncedAt, projectId",interactions:"++id, conversationId, index, type, status, startedAt, parentId",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name",syncRepos:"++id, &name, remoteUrl, username",projects:"++id, &path, parentId, createdAt, updatedAt, name"}),this.version(5).stores({conversations:"++id, title, createdAt, updatedAt, syncRepoId, lastSyncedAt, projectId",interactions:"++id, conversationId, index, type, status, startedAt, parentId",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name",syncRepos:"++id, &name, remoteUrl",projects:"++id, &path, parentId, createdAt, updatedAt, name"}),this.version(4).stores({conversations:"++id, title, createdAt, updatedAt, syncRepoId, lastSyncedAt, projectId",interactions:"++id, conversationId, index, type, status, startedAt, parentId",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name",syncRepos:"++id, &name, remoteUrl",projects:"++id, name, parentId, createdAt, updatedAt"}),this.version(3).stores({conversations:"++id, title, createdAt, updatedAt, syncRepoId, lastSyncedAt, projectId",interactions:"++id, conversationId, index, type, status, startedAt, parentId",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name",syncRepos:"++id, &name, remoteUrl",projects:"++id, &name, parentId, createdAt, updatedAt"}),this.version(2).stores({conversations:"++id, title, createdAt, updatedAt, syncRepoId, lastSyncedAt",interactions:"++id, conversationId, index, type, status, startedAt, parentId",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name",syncRepos:"++id, &name, remoteUrl"}),this.version(1).stores({conversations:"++id, title, createdAt, updatedAt",interactions:"++id, conversationId, index, type, status, startedAt, parentId",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name"})}}const jt=new h0e,Di=(e,t=[])=>{const n={...e};return e.createdAt&&!(e.createdAt instanceof Date)&&(n.createdAt=new Date(e.createdAt)),e.updatedAt&&!(e.updatedAt instanceof Date)&&(n.updatedAt=new Date(e.updatedAt)),Array.isArray(t)?t.forEach(r=>{e[r]&&!(e[r]instanceof Date)&&(n[r]=new Date(e[r]))}):console.warn("[ensureDateFields] Expected otherDateFields to be an array, but received:",t),n};class Et{static async loadConversations(){try{return(await jt.conversations.orderBy("updatedAt").reverse().toArray()).map(n=>Di(n,["lastSyncedAt"]))}catch(t){throw console.error("PersistenceService: Error loading conversations:",t),t}}static async saveConversation(t){try{const n={...t,syncRepoId:t.syncRepoId??null,lastSyncedAt:t.lastSyncedAt??null,projectId:t.projectId??null};return await jt.conversations.put(n)}catch(n){throw console.error("PersistenceService: Error saving conversation:",n),n}}static async deleteConversation(t){try{await jt.conversations.delete(t)}catch(n){throw console.error("PersistenceService: Error deleting conversation:",n),n}}static async loadInteractionsForConversation(t){try{return(await jt.interactions.where({conversationId:t}).sortBy("index")).map(r=>Di(r,["startedAt","endedAt"]))}catch(n){throw console.error("PersistenceService: Error loading interactions for conversation:",n),n}}static async saveInteraction(t){try{return await jt.interactions.put(t)}catch(n){throw console.error("PersistenceService: Error saving interaction:",n),n}}static async deleteInteraction(t){try{await jt.interactions.delete(t)}catch(n){throw console.error("PersistenceService: Error deleting interaction:",n),n}}static async deleteInteractionsForConversation(t){try{await jt.interactions.where({conversationId:t}).delete()}catch(n){throw console.error("PersistenceService: Error deleting interactions for conversation:",n),n}}static async loadMods(){try{return(await jt.mods.orderBy("loadOrder").toArray()).map(n=>Di(n,[]))}catch(t){throw console.error("PersistenceService: Error loading mods:",t),t}}static async saveMod(t){try{return await jt.mods.put(t)}catch(n){throw console.error("PersistenceService: Error saving mod:",n),n}}static async deleteMod(t){try{await jt.mods.delete(t)}catch(n){throw console.error("PersistenceService: Error deleting mod:",n),n}}static async saveSetting(t,n){try{return await jt.appState.put({key:`settings:${t}`,value:n})}catch(r){throw console.error("PersistenceService: Error saving setting:",r),r}}static async loadSetting(t,n){try{const r=await jt.appState.get(`settings:${t}`);return(r==null?void 0:r.value)!==void 0?r.value:n}catch(r){return console.error("PersistenceService: Error loading setting:",r),n}}static async loadProviderConfigs(){var t;try{return(await((t=jt.providerConfigs)==null?void 0:t.toArray())??[]).map(r=>Di(r,["modelsLastFetchedAt"]))}catch(n){throw console.error("PersistenceService: Error loading provider configs:",n),n}}static async saveProviderConfig(t){try{return await jt.providerConfigs.put(t)}catch(n){throw console.error("PersistenceService: Error saving provider config:",n),n}}static async deleteProviderConfig(t){try{await jt.providerConfigs.delete(t)}catch(n){throw console.error("PersistenceService: Error deleting provider config:",n),n}}static async loadApiKeys(){var t;try{return(await((t=jt.apiKeys)==null?void 0:t.toArray())??[]).map(r=>Di(r,[]))}catch(n){throw console.error("PersistenceService: Error loading API keys:",n),n}}static async saveApiKey(t){try{return await jt.apiKeys.put(t)}catch(n){throw console.error("PersistenceService: Error saving API key:",n),n}}static async deleteApiKey(t){try{await jt.transaction("rw",[jt.apiKeys,jt.providerConfigs],async()=>{const n=await jt.providerConfigs.where("apiKeyId").equals(t).toArray();if(n.length>0){const r=n.map(s=>jt.providerConfigs.update(s.id,{apiKeyId:null}));await Promise.all(r),console.log(`PersistenceService: Unlinked API key ${t} from ${n.length} provider configs.`)}await jt.apiKeys.delete(t)})}catch(n){throw console.error("PersistenceService: Error deleting API key:",n),n}}static async loadSyncRepos(){try{return(await jt.syncRepos.toArray()).map(n=>Di(n,["lastPulledAt","lastPushedAt"]))}catch(t){throw console.error("PersistenceService: Error loading sync repos:",t),t}}static async saveSyncRepo(t){try{return await jt.syncRepos.put(t)}catch(n){throw console.error("PersistenceService: Error saving sync repo:",n),n}}static async deleteSyncRepo(t){try{await jt.transaction("rw",[jt.syncRepos,jt.conversations],async()=>{const n=await jt.conversations.where("syncRepoId").equals(t).toArray();if(n.length>0){const r=n.map(s=>jt.conversations.update(s.id,{syncRepoId:null}));await Promise.all(r),console.log(`PersistenceService: Unlinked SyncRepo ${t} from ${n.length} conversations.`)}await jt.syncRepos.delete(t)})}catch(n){throw console.error("PersistenceService: Error deleting sync repo:",n),n}}static async loadProjects(){try{return(await jt.projects.orderBy("updatedAt").reverse().toArray()).map(n=>Di(n,[]))}catch(t){throw console.error("PersistenceService: Error loading projects:",t),t}}static async saveProject(t){try{const n={id:t.id,path:t.path,createdAt:t.createdAt,updatedAt:t.updatedAt,name:t.name,parentId:t.parentId??null,systemPrompt:t.systemPrompt??null,modelId:t.modelId??null,temperature:t.temperature??null,maxTokens:t.maxTokens??null,topP:t.topP??null,topK:t.topK??null,presencePenalty:t.presencePenalty??null,frequencyPenalty:t.frequencyPenalty??null,defaultTagIds:t.defaultTagIds??null,defaultRuleIds:t.defaultRuleIds??null,metadata:t.metadata?{...t.metadata}:{}};return await jt.projects.put(n)}catch(n){throw console.error("PersistenceService: Error saving project:",n),n}}static async deleteProject(t){try{const n=async r=>{const s=await jt.projects.where("parentId").equals(r).toArray();for(const i of s)await n(i.id);await jt.projects.delete(r),console.log(`PersistenceService: Deleted Project ${r}`)};await jt.transaction("rw",[jt.projects],async()=>{await n(t)})}catch(n){throw console.error("PersistenceService: Error deleting project:",n),n}}static async loadRules(){try{return(await jt.rules.orderBy("name").toArray()).map(n=>Di(n))}catch(t){throw console.error("PersistenceService: Error loading rules:",t),t}}static async saveRule(t){try{return await jt.rules.put(t)}catch(n){throw console.error("PersistenceService: Error saving rule:",n),n}}static async deleteRule(t){try{await jt.transaction("rw",[jt.rules,jt.tagRuleLinks],async()=>{await jt.tagRuleLinks.where("ruleId").equals(t).delete(),await jt.rules.delete(t)})}catch(n){throw console.error("PersistenceService: Error deleting rule:",n),n}}static async loadTags(){try{return(await jt.tags.orderBy("name").toArray()).map(n=>Di(n))}catch(t){throw console.error("PersistenceService: Error loading tags:",t),t}}static async saveTag(t){try{return await jt.tags.put(t)}catch(n){throw console.error("PersistenceService: Error saving tag:",n),n}}static async deleteTag(t){try{await jt.transaction("rw",[jt.tags,jt.tagRuleLinks],async()=>{await jt.tagRuleLinks.where("tagId").equals(t).delete(),await jt.tags.delete(t)})}catch(n){throw console.error("PersistenceService: Error deleting tag:",n),n}}static async loadTagRuleLinks(){try{return await jt.tagRuleLinks.toArray()}catch(t){throw console.error("PersistenceService: Error loading tag-rule links:",t),t}}static async saveTagRuleLink(t){try{return await jt.tagRuleLinks.put(t)}catch(n){throw console.error("PersistenceService: Error saving tag-rule link:",n),n}}static async deleteTagRuleLink(t){try{await jt.tagRuleLinks.delete(t)}catch(n){throw console.error("PersistenceService: Error deleting tag-rule link:",n),n}}static async getAllDataForExport(t){const n={version:1,exportedAt:new Date().toISOString()};if(t.importSettings){const r=await jt.appState.toArray();n.settings={},r.forEach(s=>{s.key.startsWith("settings:")&&(n.settings[s.key.substring(9)]=s.value)})}return t.importApiKeys&&(n.apiKeys=await jt.apiKeys.toArray()),t.importProviderConfigs&&(n.providerConfigs=await jt.providerConfigs.toArray()),t.importProjects&&(n.projects=await jt.projects.toArray()),t.importConversations&&(n.conversations=await jt.conversations.toArray(),n.interactions=await jt.interactions.toArray()),t.importRulesAndTags&&(n.rules=await jt.rules.toArray(),n.tags=await jt.tags.toArray(),n.tagRuleLinks=await jt.tagRuleLinks.toArray()),t.importMods&&(n.mods=await jt.mods.toArray()),t.importSyncRepos&&(n.syncRepos=await jt.syncRepos.toArray()),n}static async importAllData(t,n){if(t.version!==1)throw new Error(`Unsupported export version: ${t.version}. Expected version 1.`);await jt.transaction("rw",[jt.appState,jt.apiKeys,jt.providerConfigs,jt.projects,jt.conversations,jt.interactions,jt.rules,jt.tags,jt.tagRuleLinks,jt.mods,jt.syncRepos],async()=>{if(n.importSettings&&await jt.appState.clear(),n.importApiKeys&&await jt.apiKeys.clear(),n.importProviderConfigs&&await jt.providerConfigs.clear(),n.importProjects&&await jt.projects.clear(),n.importConversations&&(await jt.conversations.clear(),await jt.interactions.clear()),n.importRulesAndTags&&(await jt.rules.clear(),await jt.tags.clear(),await jt.tagRuleLinks.clear()),n.importMods&&await jt.mods.clear(),n.importSyncRepos&&await jt.syncRepos.clear(),n.importSettings&&t.settings){const r=Object.entries(t.settings).map(([s,i])=>({key:`settings:${s}`,value:i}));await jt.appState.bulkPut(r)}n.importApiKeys&&t.apiKeys&&await jt.apiKeys.bulkPut(t.apiKeys.map(r=>Di(r))),n.importProviderConfigs&&t.providerConfigs&&await jt.providerConfigs.bulkPut(t.providerConfigs.map(r=>Di(r,["modelsLastFetchedAt"]))),n.importProjects&&t.projects&&await jt.projects.bulkPut(t.projects.map(r=>Di(r))),n.importConversations&&t.conversations&&(await jt.conversations.bulkPut(t.conversations.map(r=>Di(r,["lastSyncedAt"]))),t.interactions&&await jt.interactions.bulkPut(t.interactions.map(r=>Di(r,["startedAt","endedAt"])))),n.importRulesAndTags&&(t.rules&&await jt.rules.bulkPut(t.rules.map(r=>Di(r))),t.tags&&await jt.tags.bulkPut(t.tags.map(r=>Di(r))),t.tagRuleLinks&&await jt.tagRuleLinks.bulkPut(t.tagRuleLinks)),n.importMods&&t.mods&&await jt.mods.bulkPut(t.mods.map(r=>Di(r))),n.importSyncRepos&&t.syncRepos&&await jt.syncRepos.bulkPut(t.syncRepos.map(r=>Di(r,["lastPulledAt","lastPushedAt"])))})}static async loadPromptTemplates(){try{return(await jt.promptTemplates.orderBy("name").toArray()).map(n=>Di(n,["createdAt","updatedAt"]))}catch(t){throw console.error("PersistenceService: Error loading prompt templates:",t),t}}static async savePromptTemplate(t){try{return await jt.promptTemplates.put(t)}catch(n){throw console.error("PersistenceService: Error saving prompt template:",n),n}}static async deletePromptTemplate(t){try{await jt.promptTemplates.delete(t)}catch(n){throw console.error("PersistenceService: Error deleting prompt template:",n),n}}static async clearAllData(){try{await jt.transaction("rw",[jt.conversations,jt.interactions,jt.mods,jt.appState,jt.providerConfigs,jt.apiKeys,jt.syncRepos,jt.projects,jt.rules,jt.tags,jt.tagRuleLinks,jt.promptTemplates],async()=>{await jt.interactions.clear(),await jt.conversations.clear(),await jt.projects.clear(),await jt.mods.clear(),await jt.appState.clear(),await jt.providerConfigs.clear(),await jt.apiKeys.clear(),await jt.syncRepos.clear(),await jt.rules.clear(),await jt.tags.clear(),await jt.tagRuleLinks.clear(),await jt.promptTemplates.clear()}),console.log("PersistenceService: All data cleared.")}catch(t){throw console.error("PersistenceService: Error clearing all data:",t),t}}}const Zn={loaded:"interaction.loaded",currentConversationIdChanged:"interaction.current.conversation.id.changed",added:"interaction.added",updated:"interaction.updated",streamingIdsChanged:"interaction.streaming.ids.changed",activeStreamBuffersChanged:"interaction.active.stream.buffers.changed",activeReasoningBuffersChanged:"interaction.active.reasoning.buffers.changed",statusChanged:"interaction.status.changed",errorChanged:"interaction.error.changed",interactionRated:"interaction.rated",started:"interaction.sdk.started",streamChunk:"interaction.sdk.streamChunk",completed:"interaction.sdk.completed",loadInteractionsRequest:"interaction.load.interactions.request",rateInteractionRequest:"interaction.rate.interaction.request",setCurrentConversationIdRequest:"interaction.set.current.conversation.id.request",clearInteractionsRequest:"interaction.clear.interactions.request",setErrorRequest:"interaction.set.error.request",setStatusRequest:"interaction.set.status.request"};var al=WW();const yE=_a(al);function p0e(e){if(typeof document>"u")return;let t=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",t.appendChild(n),n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e))}const m0e=e=>{switch(e){case"success":return b0e;case"info":return x0e;case"warning":return v0e;case"error":return w0e;default:return null}},g0e=Array(12).fill(0),y0e=({visible:e,className:t})=>We.createElement("div",{className:["sonner-loading-wrapper",t].filter(Boolean).join(" "),"data-visible":e},We.createElement("div",{className:"sonner-spinner"},g0e.map((n,r)=>We.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${r}`})))),b0e=We.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},We.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),v0e=We.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},We.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),x0e=We.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},We.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),w0e=We.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},We.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),_0e=We.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},We.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),We.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),S0e=()=>{const[e,t]=We.useState(document.hidden);return We.useEffect(()=>{const n=()=>{t(document.hidden)};return document.addEventListener("visibilitychange",n),()=>window.removeEventListener("visibilitychange",n)},[]),e};let J3=1;class C0e{constructor(){this.subscribe=t=>(this.subscribers.push(t),()=>{const n=this.subscribers.indexOf(t);this.subscribers.splice(n,1)}),this.publish=t=>{this.subscribers.forEach(n=>n(t))},this.addToast=t=>{this.publish(t),this.toasts=[...this.toasts,t]},this.create=t=>{var n;const{message:r,...s}=t,i=typeof(t==null?void 0:t.id)=="number"||((n=t.id)==null?void 0:n.length)>0?t.id:J3++,a=this.toasts.find(l=>l.id===i),o=t.dismissible===void 0?!0:t.dismissible;return this.dismissedToasts.has(i)&&this.dismissedToasts.delete(i),a?this.toasts=this.toasts.map(l=>l.id===i?(this.publish({...l,...t,id:i,title:r}),{...l,...t,id:i,dismissible:o,title:r}):l):this.addToast({title:r,...s,dismissible:o,id:i}),i},this.dismiss=t=>(t?(this.dismissedToasts.add(t),requestAnimationFrame(()=>this.subscribers.forEach(n=>n({id:t,dismiss:!0})))):this.toasts.forEach(n=>{this.subscribers.forEach(r=>r({id:n.id,dismiss:!0}))}),t),this.message=(t,n)=>this.create({...n,message:t}),this.error=(t,n)=>this.create({...n,message:t,type:"error"}),this.success=(t,n)=>this.create({...n,type:"success",message:t}),this.info=(t,n)=>this.create({...n,type:"info",message:t}),this.warning=(t,n)=>this.create({...n,type:"warning",message:t}),this.loading=(t,n)=>this.create({...n,type:"loading",message:t}),this.promise=(t,n)=>{if(!n)return;let r;n.loading!==void 0&&(r=this.create({...n,promise:t,type:"loading",message:n.loading,description:typeof n.description!="function"?n.description:void 0}));const s=Promise.resolve(t instanceof Function?t():t);let i=r!==void 0,a;const o=s.then(async c=>{if(a=["resolve",c],We.isValidElement(c))i=!1,this.create({id:r,type:"default",message:c});else if(E0e(c)&&!c.ok){i=!1;const d=typeof n.error=="function"?await n.error(`HTTP error! status: ${c.status}`):n.error,h=typeof n.description=="function"?await n.description(`HTTP error! status: ${c.status}`):n.description,y=typeof d=="object"&&!We.isValidElement(d)?d:{message:d};this.create({id:r,type:"error",description:h,...y})}else if(c instanceof Error){i=!1;const d=typeof n.error=="function"?await n.error(c):n.error,h=typeof n.description=="function"?await n.description(c):n.description,y=typeof d=="object"&&!We.isValidElement(d)?d:{message:d};this.create({id:r,type:"error",description:h,...y})}else if(n.success!==void 0){i=!1;const d=typeof n.success=="function"?await n.success(c):n.success,h=typeof n.description=="function"?await n.description(c):n.description,y=typeof d=="object"&&!We.isValidElement(d)?d:{message:d};this.create({id:r,type:"success",description:h,...y})}}).catch(async c=>{if(a=["reject",c],n.error!==void 0){i=!1;const u=typeof n.error=="function"?await n.error(c):n.error,d=typeof n.description=="function"?await n.description(c):n.description,m=typeof u=="object"&&!We.isValidElement(u)?u:{message:u};this.create({id:r,type:"error",description:d,...m})}}).finally(()=>{i&&(this.dismiss(r),r=void 0),n.finally==null||n.finally.call(n)}),l=()=>new Promise((c,u)=>o.then(()=>a[0]==="reject"?u(a[1]):c(a[1])).catch(u));return typeof r!="string"&&typeof r!="number"?{unwrap:l}:Object.assign(r,{unwrap:l})},this.custom=(t,n)=>{const r=(n==null?void 0:n.id)||J3++;return this.create({jsx:t(r),id:r,...n}),r},this.getActiveToasts=()=>this.toasts.filter(t=>!this.dismissedToasts.has(t.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}}const vo=new C0e,k0e=(e,t)=>{const n=(t==null?void 0:t.id)||J3++;return vo.addToast({title:e,...t,id:n}),n},E0e=e=>e&&typeof e=="object"&&"ok"in e&&typeof e.ok=="boolean"&&"status"in e&&typeof e.status=="number",T0e=k0e,A0e=()=>vo.toasts,R0e=()=>vo.getActiveToasts(),je=Object.assign(T0e,{success:vo.success,info:vo.info,warning:vo.warning,error:vo.error,custom:vo.custom,message:vo.message,promise:vo.promise,dismiss:vo.dismiss,loading:vo.loading},{getHistory:A0e,getToasts:R0e});p0e("[data-sonner-toaster][dir=ltr],html[dir=ltr]{--toast-icon-margin-start:-3px;--toast-icon-margin-end:4px;--toast-svg-margin-start:-1px;--toast-svg-margin-end:0px;--toast-button-margin-start:auto;--toast-button-margin-end:0;--toast-close-button-start:0;--toast-close-button-end:unset;--toast-close-button-transform:translate(-35%, -35%)}[data-sonner-toaster][dir=rtl],html[dir=rtl]{--toast-icon-margin-start:4px;--toast-icon-margin-end:-3px;--toast-svg-margin-start:0px;--toast-svg-margin-end:-1px;--toast-button-margin-start:0;--toast-button-margin-end:auto;--toast-close-button-start:unset;--toast-close-button-end:0;--toast-close-button-transform:translate(35%, -35%)}[data-sonner-toaster]{position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1:hsl(0, 0%, 99%);--gray2:hsl(0, 0%, 97.3%);--gray3:hsl(0, 0%, 95.1%);--gray4:hsl(0, 0%, 93%);--gray5:hsl(0, 0%, 90.9%);--gray6:hsl(0, 0%, 88.7%);--gray7:hsl(0, 0%, 85.8%);--gray8:hsl(0, 0%, 78%);--gray9:hsl(0, 0%, 56.1%);--gray10:hsl(0, 0%, 52.3%);--gray11:hsl(0, 0%, 43.5%);--gray12:hsl(0, 0%, 9%);--border-radius:8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:0;z-index:999999999;transition:transform .4s ease}[data-sonner-toaster][data-lifted=true]{transform:translateY(-8px)}@media (hover:none) and (pointer:coarse){[data-sonner-toaster][data-lifted=true]{transform:none}}[data-sonner-toaster][data-x-position=right]{right:var(--offset-right)}[data-sonner-toaster][data-x-position=left]{left:var(--offset-left)}[data-sonner-toaster][data-x-position=center]{left:50%;transform:translateX(-50%)}[data-sonner-toaster][data-y-position=top]{top:var(--offset-top)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--offset-bottom)}[data-sonner-toast]{--y:translateY(100%);--lift-amount:calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:0;overflow-wrap:anywhere}[data-sonner-toast][data-styled=true]{padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px rgba(0,0,0,.1);width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}[data-sonner-toast]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-y-position=top]{top:0;--y:translateY(-100%);--lift:1;--lift-amount:calc(1 * var(--gap))}[data-sonner-toast][data-y-position=bottom]{bottom:0;--y:translateY(100%);--lift:-1;--lift-amount:calc(var(--lift) * var(--gap))}[data-sonner-toast][data-styled=true] [data-description]{font-weight:400;line-height:1.4;color:#3f3f3f}[data-rich-colors=true][data-sonner-toast][data-styled=true] [data-description]{color:inherit}[data-sonner-toaster][data-sonner-theme=dark] [data-description]{color:#e8e8e8}[data-sonner-toast][data-styled=true] [data-title]{font-weight:500;line-height:1.5;color:inherit}[data-sonner-toast][data-styled=true] [data-icon]{display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}[data-sonner-toast][data-promise=true] [data-icon]>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}[data-sonner-toast][data-styled=true] [data-icon]>*{flex-shrink:0}[data-sonner-toast][data-styled=true] [data-icon] svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}[data-sonner-toast][data-styled=true] [data-content]{display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;font-weight:500;cursor:pointer;outline:0;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}[data-sonner-toast][data-styled=true] [data-button]:focus-visible{box-shadow:0 0 0 2px rgba(0,0,0,.4)}[data-sonner-toast][data-styled=true] [data-button]:first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}[data-sonner-toast][data-styled=true] [data-cancel]{color:var(--normal-text);background:rgba(0,0,0,.08)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-styled=true] [data-cancel]{background:rgba(255,255,255,.3)}[data-sonner-toast][data-styled=true] [data-close-button]{position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);background:var(--normal-bg);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast][data-styled=true] [data-close-button]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-styled=true] [data-disabled=true]{cursor:not-allowed}[data-sonner-toast][data-styled=true]:hover [data-close-button]:hover{background:var(--gray2);border-color:var(--gray5)}[data-sonner-toast][data-swiping=true]::before{content:'';position:absolute;left:-100%;right:-100%;height:100%;z-index:-1}[data-sonner-toast][data-y-position=top][data-swiping=true]::before{bottom:50%;transform:scaleY(3) translateY(50%)}[data-sonner-toast][data-y-position=bottom][data-swiping=true]::before{top:50%;transform:scaleY(3) translateY(-50%)}[data-sonner-toast][data-swiping=false][data-removed=true]::before{content:'';position:absolute;inset:0;transform:scaleY(2)}[data-sonner-toast][data-expanded=true]::after{content:'';position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}[data-sonner-toast][data-mounted=true]{--y:translateY(0);opacity:1}[data-sonner-toast][data-expanded=false][data-front=false]{--scale:var(--toasts-before) * 0.05 + 1;--y:translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}[data-sonner-toast]>*{transition:opacity .4s}[data-sonner-toast][data-x-position=right]{right:0}[data-sonner-toast][data-x-position=left]{left:0}[data-sonner-toast][data-expanded=false][data-front=false][data-styled=true]>*{opacity:0}[data-sonner-toast][data-visible=false]{opacity:0;pointer-events:none}[data-sonner-toast][data-mounted=true][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}[data-sonner-toast][data-removed=true][data-front=true][data-swipe-out=false]{--y:translateY(calc(var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=false]{--y:translateY(40%);opacity:0;transition:transform .5s,opacity .2s}[data-sonner-toast][data-removed=true][data-front=false]::before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y,0)) translateX(var(--swipe-amount-x,0));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width:600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-sonner-theme=light]{--normal-bg:#fff;--normal-border:var(--gray4);--normal-text:var(--gray12);--success-bg:hsl(143, 85%, 96%);--success-border:hsl(145, 92%, 87%);--success-text:hsl(140, 100%, 27%);--info-bg:hsl(208, 100%, 97%);--info-border:hsl(221, 91%, 93%);--info-text:hsl(210, 92%, 45%);--warning-bg:hsl(49, 100%, 97%);--warning-border:hsl(49, 91%, 84%);--warning-text:hsl(31, 92%, 45%);--error-bg:hsl(359, 100%, 97%);--error-border:hsl(359, 100%, 94%);--error-text:hsl(360, 100%, 45%)}[data-sonner-toaster][data-sonner-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg:#000;--normal-border:hsl(0, 0%, 20%);--normal-text:var(--gray1)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg:#fff;--normal-border:var(--gray3);--normal-text:var(--gray12)}[data-sonner-toaster][data-sonner-theme=dark]{--normal-bg:#000;--normal-bg-hover:hsl(0, 0%, 12%);--normal-border:hsl(0, 0%, 20%);--normal-border-hover:hsl(0, 0%, 25%);--normal-text:var(--gray1);--success-bg:hsl(150, 100%, 6%);--success-border:hsl(147, 100%, 12%);--success-text:hsl(150, 86%, 65%);--info-bg:hsl(215, 100%, 6%);--info-border:hsl(223, 43%, 17%);--info-text:hsl(216, 87%, 65%);--warning-bg:hsl(64, 100%, 6%);--warning-border:hsl(60, 100%, 9%);--warning-text:hsl(46, 87%, 65%);--error-bg:hsl(358, 76%, 10%);--error-border:hsl(357, 89%, 16%);--error-text:hsl(358, 100%, 81%)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size:16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:first-child{animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}100%{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}100%{opacity:.15}}@media (prefers-reduced-motion){.sonner-loading-bar,[data-sonner-toast],[data-sonner-toast]>*{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}");function CS(e){return e.label!==void 0}const N0e=3,M0e="24px",I0e="16px",OB=4e3,j0e=356,P0e=14,O0e=45,D0e=200;function Qc(...e){return e.filter(Boolean).join(" ")}function F0e(e){const[t,n]=e.split("-"),r=[];return t&&r.push(t),n&&r.push(n),r}const L0e=e=>{var t,n,r,s,i,a,o,l,c;const{invert:u,toast:d,unstyled:h,interacting:m,setHeights:y,visibleToasts:b,heights:v,index:x,toasts:w,expanded:S,removeToast:C,defaultRichColors:k,closeButton:A,style:R,cancelButtonStyle:N,actionButtonStyle:I,className:P="",descriptionClassName:L="",duration:O,position:V,gap:D,expandByDefault:Z,classNames:U,icons:H,closeButtonAriaLabel:$="Close toast"}=e,[ne,W]=We.useState(null),[Q,ee]=We.useState(null),[se,pe]=We.useState(!1),[ce,Ie]=We.useState(!1),[De,Se]=We.useState(!1),[Ce,qe]=We.useState(!1),[Qe,Ve]=We.useState(!1),[Ne,K]=We.useState(0),[ge,Ae]=We.useState(0),le=We.useRef(d.duration||O||OB),oe=We.useRef(null),re=We.useRef(null),Te=x===0,Be=x+1<=b,ke=d.type,lt=d.dismissible!==!1,Rt=d.className||"",ht=d.descriptionClassName||"",Pt=We.useMemo(()=>v.findIndex(_e=>_e.toastId===d.id)||0,[v,d.id]),qt=We.useMemo(()=>{var _e;return(_e=d.closeButton)!=null?_e:A},[d.closeButton,A]),Lt=We.useMemo(()=>d.duration||O||OB,[d.duration,O]),en=We.useRef(0),xe=We.useRef(0),F=We.useRef(0),X=We.useRef(null),[ye,Fe]=V.split("-"),we=We.useMemo(()=>v.reduce((_e,Ue,kt)=>kt>=Pt?_e:_e+Ue.height,0),[v,Pt]),Me=S0e(),de=d.invert||u,vt=ke==="loading";xe.current=We.useMemo(()=>Pt*D+we,[Pt,we]),We.useEffect(()=>{le.current=Lt},[Lt]),We.useEffect(()=>{pe(!0)},[]),We.useEffect(()=>{const _e=re.current;if(_e){const Ue=_e.getBoundingClientRect().height;return Ae(Ue),y(kt=>[{toastId:d.id,height:Ue,position:d.position},...kt]),()=>y(kt=>kt.filter(fe=>fe.toastId!==d.id))}},[y,d.id]),We.useLayoutEffect(()=>{if(!se)return;const _e=re.current,Ue=_e.style.height;_e.style.height="auto";const kt=_e.getBoundingClientRect().height;_e.style.height=Ue,Ae(kt),y(fe=>fe.find(G=>G.toastId===d.id)?fe.map(G=>G.toastId===d.id?{...G,height:kt}:G):[{toastId:d.id,height:kt,position:d.position},...fe])},[se,d.title,d.description,y,d.id]);const ot=We.useCallback(()=>{Ie(!0),K(xe.current),y(_e=>_e.filter(Ue=>Ue.toastId!==d.id)),setTimeout(()=>{C(d)},D0e)},[d,C,y,xe]);We.useEffect(()=>{if(d.promise&&ke==="loading"||d.duration===1/0||d.type==="loading")return;let _e;return S||m||Me?(()=>{if(F.current<en.current){const fe=new Date().getTime()-en.current;le.current=le.current-fe}F.current=new Date().getTime()})():(()=>{le.current!==1/0&&(en.current=new Date().getTime(),_e=setTimeout(()=>{d.onAutoClose==null||d.onAutoClose.call(d,d),ot()},le.current))})(),()=>clearTimeout(_e)},[S,m,d,ke,Me,ot]),We.useEffect(()=>{d.delete&&ot()},[ot,d.delete]);function B(){var _e;if(H!=null&&H.loading){var Ue;return We.createElement("div",{className:Qc(U==null?void 0:U.loader,d==null||(Ue=d.classNames)==null?void 0:Ue.loader,"sonner-loader"),"data-visible":ke==="loading"},H.loading)}return We.createElement(y0e,{className:Qc(U==null?void 0:U.loader,d==null||(_e=d.classNames)==null?void 0:_e.loader),visible:ke==="loading"})}const ze=d.icon||(H==null?void 0:H[ke])||m0e(ke);var st,be;return We.createElement("li",{tabIndex:0,ref:re,className:Qc(P,Rt,U==null?void 0:U.toast,d==null||(t=d.classNames)==null?void 0:t.toast,U==null?void 0:U.default,U==null?void 0:U[ke],d==null||(n=d.classNames)==null?void 0:n[ke]),"data-sonner-toast":"","data-rich-colors":(st=d.richColors)!=null?st:k,"data-styled":!(d.jsx||d.unstyled||h),"data-mounted":se,"data-promise":!!d.promise,"data-swiped":Qe,"data-removed":ce,"data-visible":Be,"data-y-position":ye,"data-x-position":Fe,"data-index":x,"data-front":Te,"data-swiping":De,"data-dismissible":lt,"data-type":ke,"data-invert":de,"data-swipe-out":Ce,"data-swipe-direction":Q,"data-expanded":!!(S||Z&&se),style:{"--index":x,"--toasts-before":x,"--z-index":w.length-x,"--offset":`${ce?Ne:xe.current}px`,"--initial-height":Z?"auto":`${ge}px`,...R,...d.style},onDragEnd:()=>{Se(!1),W(null),X.current=null},onPointerDown:_e=>{vt||!lt||(oe.current=new Date,K(xe.current),_e.target.setPointerCapture(_e.pointerId),_e.target.tagName!=="BUTTON"&&(Se(!0),X.current={x:_e.clientX,y:_e.clientY}))},onPointerUp:()=>{var _e,Ue,kt;if(Ce||!lt)return;X.current=null;const fe=Number(((_e=re.current)==null?void 0:_e.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),Y=Number(((Ue=re.current)==null?void 0:Ue.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),G=new Date().getTime()-((kt=oe.current)==null?void 0:kt.getTime()),J=ne==="x"?fe:Y,ve=Math.abs(J)/G;if(Math.abs(J)>=O0e||ve>.11){K(xe.current),d.onDismiss==null||d.onDismiss.call(d,d),ee(ne==="x"?fe>0?"right":"left":Y>0?"down":"up"),ot(),qe(!0);return}else{var Oe,Ge;(Oe=re.current)==null||Oe.style.setProperty("--swipe-amount-x","0px"),(Ge=re.current)==null||Ge.style.setProperty("--swipe-amount-y","0px")}Ve(!1),Se(!1),W(null)},onPointerMove:_e=>{var Ue,kt,fe;if(!X.current||!lt||((Ue=window.getSelection())==null?void 0:Ue.toString().length)>0)return;const G=_e.clientY-X.current.y,J=_e.clientX-X.current.x;var ve;const Oe=(ve=e.swipeDirections)!=null?ve:F0e(V);!ne&&(Math.abs(J)>1||Math.abs(G)>1)&&W(Math.abs(J)>Math.abs(G)?"x":"y");let Ge={x:0,y:0};const _t=tn=>1/(1.5+Math.abs(tn)/20);if(ne==="y"){if(Oe.includes("top")||Oe.includes("bottom"))if(Oe.includes("top")&&G<0||Oe.includes("bottom")&&G>0)Ge.y=G;else{const tn=G*_t(G);Ge.y=Math.abs(tn)<Math.abs(G)?tn:G}}else if(ne==="x"&&(Oe.includes("left")||Oe.includes("right")))if(Oe.includes("left")&&J<0||Oe.includes("right")&&J>0)Ge.x=J;else{const tn=J*_t(J);Ge.x=Math.abs(tn)<Math.abs(J)?tn:J}(Math.abs(Ge.x)>0||Math.abs(Ge.y)>0)&&Ve(!0),(kt=re.current)==null||kt.style.setProperty("--swipe-amount-x",`${Ge.x}px`),(fe=re.current)==null||fe.style.setProperty("--swipe-amount-y",`${Ge.y}px`)}},qt&&!d.jsx&&ke!=="loading"?We.createElement("button",{"aria-label":$,"data-disabled":vt,"data-close-button":!0,onClick:vt||!lt?()=>{}:()=>{ot(),d.onDismiss==null||d.onDismiss.call(d,d)},className:Qc(U==null?void 0:U.closeButton,d==null||(r=d.classNames)==null?void 0:r.closeButton)},(be=H==null?void 0:H.close)!=null?be:_0e):null,(ke||d.icon||d.promise)&&d.icon!==null&&((H==null?void 0:H[ke])!==null||d.icon)?We.createElement("div",{"data-icon":"",className:Qc(U==null?void 0:U.icon,d==null||(s=d.classNames)==null?void 0:s.icon)},d.promise||d.type==="loading"&&!d.icon?d.icon||B():null,d.type!=="loading"?ze:null):null,We.createElement("div",{"data-content":"",className:Qc(U==null?void 0:U.content,d==null||(i=d.classNames)==null?void 0:i.content)},We.createElement("div",{"data-title":"",className:Qc(U==null?void 0:U.title,d==null||(a=d.classNames)==null?void 0:a.title)},d.jsx?d.jsx:typeof d.title=="function"?d.title():d.title),d.description?We.createElement("div",{"data-description":"",className:Qc(L,ht,U==null?void 0:U.description,d==null||(o=d.classNames)==null?void 0:o.description)},typeof d.description=="function"?d.description():d.description):null),We.isValidElement(d.cancel)?d.cancel:d.cancel&&CS(d.cancel)?We.createElement("button",{"data-button":!0,"data-cancel":!0,style:d.cancelButtonStyle||N,onClick:_e=>{CS(d.cancel)&&lt&&(d.cancel.onClick==null||d.cancel.onClick.call(d.cancel,_e),ot())},className:Qc(U==null?void 0:U.cancelButton,d==null||(l=d.classNames)==null?void 0:l.cancelButton)},d.cancel.label):null,We.isValidElement(d.action)?d.action:d.action&&CS(d.action)?We.createElement("button",{"data-button":!0,"data-action":!0,style:d.actionButtonStyle||I,onClick:_e=>{CS(d.action)&&(d.action.onClick==null||d.action.onClick.call(d.action,_e),!_e.defaultPrevented&&ot())},className:Qc(U==null?void 0:U.actionButton,d==null||(c=d.classNames)==null?void 0:c.actionButton)},d.action.label):null)};function DB(){if(typeof window>"u"||typeof document>"u")return"ltr";const e=document.documentElement.getAttribute("dir");return e==="auto"||!e?window.getComputedStyle(document.documentElement).direction:e}function B0e(e,t){const n={};return[e,t].forEach((r,s)=>{const i=s===1,a=i?"--mobile-offset":"--offset",o=i?I0e:M0e;function l(c){["top","right","bottom","left"].forEach(u=>{n[`${a}-${u}`]=typeof c=="number"?`${c}px`:c})}typeof r=="number"||typeof r=="string"?l(r):typeof r=="object"?["top","right","bottom","left"].forEach(c=>{r[c]===void 0?n[`${a}-${c}`]=o:n[`${a}-${c}`]=typeof r[c]=="number"?`${r[c]}px`:r[c]}):l(o)}),n}const $0e=We.forwardRef(function(t,n){const{invert:r,position:s="bottom-right",hotkey:i=["altKey","KeyT"],expand:a,closeButton:o,className:l,offset:c,mobileOffset:u,theme:d="light",richColors:h,duration:m,style:y,visibleToasts:b=N0e,toastOptions:v,dir:x=DB(),gap:w=P0e,icons:S,containerAriaLabel:C="Notifications"}=t,[k,A]=We.useState([]),R=We.useMemo(()=>Array.from(new Set([s].concat(k.filter(Q=>Q.position).map(Q=>Q.position)))),[k,s]),[N,I]=We.useState([]),[P,L]=We.useState(!1),[O,V]=We.useState(!1),[D,Z]=We.useState(d!=="system"?d:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),U=We.useRef(null),H=i.join("+").replace(/Key/g,"").replace(/Digit/g,""),$=We.useRef(null),ne=We.useRef(!1),W=We.useCallback(Q=>{A(ee=>{var se;return(se=ee.find(pe=>pe.id===Q.id))!=null&&se.delete||vo.dismiss(Q.id),ee.filter(({id:pe})=>pe!==Q.id)})},[]);return We.useEffect(()=>vo.subscribe(Q=>{if(Q.dismiss){requestAnimationFrame(()=>{A(ee=>ee.map(se=>se.id===Q.id?{...se,delete:!0}:se))});return}setTimeout(()=>{yE.flushSync(()=>{A(ee=>{const se=ee.findIndex(pe=>pe.id===Q.id);return se!==-1?[...ee.slice(0,se),{...ee[se],...Q},...ee.slice(se+1)]:[Q,...ee]})})})}),[k]),We.useEffect(()=>{if(d!=="system"){Z(d);return}if(d==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?Z("dark"):Z("light")),typeof window>"u")return;const Q=window.matchMedia("(prefers-color-scheme: dark)");try{Q.addEventListener("change",({matches:ee})=>{Z(ee?"dark":"light")})}catch{Q.addListener(({matches:se})=>{try{Z(se?"dark":"light")}catch(pe){console.error(pe)}})}},[d]),We.useEffect(()=>{k.length<=1&&L(!1)},[k]),We.useEffect(()=>{const Q=ee=>{var se;if(i.every(Ie=>ee[Ie]||ee.code===Ie)){var ce;L(!0),(ce=U.current)==null||ce.focus()}ee.code==="Escape"&&(document.activeElement===U.current||(se=U.current)!=null&&se.contains(document.activeElement))&&L(!1)};return document.addEventListener("keydown",Q),()=>document.removeEventListener("keydown",Q)},[i]),We.useEffect(()=>{if(U.current)return()=>{$.current&&($.current.focus({preventScroll:!0}),$.current=null,ne.current=!1)}},[U.current]),We.createElement("section",{ref:n,"aria-label":`${C} ${H}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},R.map((Q,ee)=>{var se;const[pe,ce]=Q.split("-");return k.length?We.createElement("ol",{key:Q,dir:x==="auto"?DB():x,tabIndex:-1,ref:U,className:l,"data-sonner-toaster":!0,"data-sonner-theme":D,"data-y-position":pe,"data-lifted":P&&k.length>1&&!a,"data-x-position":ce,style:{"--front-toast-height":`${((se=N[0])==null?void 0:se.height)||0}px`,"--width":`${j0e}px`,"--gap":`${w}px`,...y,...B0e(c,u)},onBlur:Ie=>{ne.current&&!Ie.currentTarget.contains(Ie.relatedTarget)&&(ne.current=!1,$.current&&($.current.focus({preventScroll:!0}),$.current=null))},onFocus:Ie=>{Ie.target instanceof HTMLElement&&Ie.target.dataset.dismissible==="false"||ne.current||(ne.current=!0,$.current=Ie.relatedTarget)},onMouseEnter:()=>L(!0),onMouseMove:()=>L(!0),onMouseLeave:()=>{O||L(!1)},onDragEnd:()=>L(!1),onPointerDown:Ie=>{Ie.target instanceof HTMLElement&&Ie.target.dataset.dismissible==="false"||V(!0)},onPointerUp:()=>V(!1)},k.filter(Ie=>!Ie.position&&ee===0||Ie.position===Q).map((Ie,De)=>{var Se,Ce;return We.createElement(L0e,{key:Ie.id,icons:S,index:De,toast:Ie,defaultRichColors:h,duration:(Se=v==null?void 0:v.duration)!=null?Se:m,className:v==null?void 0:v.className,descriptionClassName:v==null?void 0:v.descriptionClassName,invert:r,visibleToasts:b,closeButton:(Ce=v==null?void 0:v.closeButton)!=null?Ce:o,interacting:O,position:Q,style:v==null?void 0:v.style,unstyled:v==null?void 0:v.unstyled,classNames:v==null?void 0:v.classNames,cancelButtonStyle:v==null?void 0:v.cancelButtonStyle,actionButtonStyle:v==null?void 0:v.actionButtonStyle,closeButtonAriaLabel:v==null?void 0:v.closeButtonAriaLabel,removeToast:W,toasts:k.filter(qe=>qe.position==Ie.position),heights:N.filter(qe=>qe.position==Ie.position),setHeights:I,expandByDefault:a,gap:w,expanded:P,swipeDirections:t.swipeDirections})})):null}))}),$n=$o(zo((e,t)=>({interactions:[],currentConversationId:null,streamingInteractionIds:[],activeStreamBuffers:{},activeReasoningBuffers:{},error:null,status:"idle",loadInteractions:async n=>{if(t().currentConversationId!==n){console.warn(`InteractionStore: loadInteractions called for ${n}, but current is ${t().currentConversationId}. Aborting load.`);return}const r=t().status;e({status:"loading",error:null,interactions:[],streamingInteractionIds:[],activeStreamBuffers:{},activeReasoningBuffers:{}}),r!=="loading"&&Pe.emit(Zn.statusChanged,{status:"loading"});try{const s=await Et.loadInteractionsForConversation(n);s.sort((l,c)=>l.index-c.index);const i=t().interactions.filter(l=>l.conversationId===n),a=new Set(s.map(l=>l.id)),o=[...s,...i.filter(l=>!a.has(l.id))];o.sort((l,c)=>l.index-c.index),t().currentConversationId===n?(e({interactions:o,status:"idle"}),Pe.emit(Zn.loaded,{conversationId:n,interactions:o}),Pe.emit(Zn.statusChanged,{status:"idle"})):console.warn(`InteractionStore: loadInteractions for ${n} completed, but currentConversationId changed during fetch to ${t().currentConversationId}. Discarding.`)}catch(s){console.error(`InteractionStore: Error loading interactions for ${n}`,s),t().currentConversationId===n&&(e({error:"Failed load interactions",status:"error"}),Pe.emit(Zn.statusChanged,{status:"error"}),Pe.emit(Zn.errorChanged,{error:"Failed load interactions"}))}},_addInteractionToState:n=>{e(r=>{if(r.currentConversationId!==n.conversationId){console.warn(`InteractionStore: Attempted to add interaction for ${n.conversationId} but current is ${r.currentConversationId}. Skipping.`);return}if(!r.interactions.some(s=>s.id===n.id))r.interactions.push(n),r.interactions.sort((s,i)=>s.index-i.index);else{const s=r.interactions.findIndex(i=>i.id===n.id);s!==-1&&(r.interactions[s]={...r.interactions[s],...n})}}),Pe.emit(Zn.added,{interaction:n})},_updateInteractionInState:(n,r)=>{e(s=>{const i=s.interactions.findIndex(a=>a.id===n);if(i!==-1){if(s.currentConversationId!==s.interactions[i].conversationId){console.warn(`InteractionStore: Attempted to update interaction ${n} which is not in the current conversation ${s.currentConversationId}. Skipping.`);return}const a=s.interactions[i];let o={...a.metadata||{}};r.metadata&&(o={...o,...r.metadata},r.metadata.toolCalls!==void 0&&Array.isArray(r.metadata.toolCalls)&&(o.toolCalls=[...r.metadata.toolCalls]),r.metadata.toolResults!==void 0&&Array.isArray(r.metadata.toolResults)&&(o.toolResults=[...r.metadata.toolResults]),r.metadata.reasoning!==void 0&&(o.reasoning=r.metadata.reasoning));const l={...a,...r,metadata:o};"response"in r&&(l.response=r.response),"rating"in r&&(l.rating=r.rating),s.interactions[i]=l}}),Pe.emit(Zn.updated,{interactionId:n,updates:r})},appendInteractionResponseChunk:(n,r)=>{e(s=>{var i;s.streamingInteractionIds.includes(n)&&s.currentConversationId===((i=s.interactions.find(a=>a.id===n))==null?void 0:i.conversationId)&&(s.activeStreamBuffers[n]=(s.activeStreamBuffers[n]||"")+r)}),Pe.emit(Zn.activeStreamBuffersChanged,{buffers:t().activeStreamBuffers})},appendReasoningChunk:(n,r)=>{e(s=>{var i;s.streamingInteractionIds.includes(n)&&s.currentConversationId===((i=s.interactions.find(a=>a.id===n))==null?void 0:i.conversationId)&&(s.activeReasoningBuffers[n]=(s.activeReasoningBuffers[n]||"")+r)}),Pe.emit(Zn.activeReasoningBuffersChanged,{buffers:t().activeReasoningBuffers})},_removeInteractionFromState:n=>{e(r=>{r.interactions=r.interactions.filter(s=>s.id!==n)})},rateInteraction:async(n,r)=>{const s=t().interactions.find(i=>i.id===n);if(s&&t().currentConversationId===s.conversationId){t()._updateInteractionInState(n,{rating:r});try{await Et.saveInteraction({...s,rating:r}),Pe.emit(Zn.interactionRated,{interactionId:n,rating:r})}catch{t()._updateInteractionInState(n,{rating:s.rating}),je.error("Failed to save rating.")}}},setCurrentConversationId:async n=>{const r=t().currentConversationId;if(r===n){n&&t().interactions.length===0&&t().status!=="loading"?(console.warn(`InteractionStore: Current ID ${n} matches, but no interactions. Forcing reload.`),await t().loadInteractions(n)):console.log(`InteractionStore: setCurrentConversationId called with the same ID (${n}). No change needed or already handled.`);return}console.log(`InteractionStore: Setting current conversation ID from ${r} to ${n}`),e({currentConversationId:n}),Pe.emit(Zn.currentConversationIdChanged,{conversationId:n}),n?await t().loadInteractions(n):t().clearInteractions()},clearInteractions:()=>{const n=t().status;e({interactions:[],streamingInteractionIds:[],activeStreamBuffers:{},activeReasoningBuffers:{},status:"idle",error:null,currentConversationId:null}),n!=="idle"&&Pe.emit(Zn.statusChanged,{status:"idle"}),Pe.emit(Zn.currentConversationIdChanged,{conversationId:null})},setError:n=>{const r=t().status;let s="idle";e(i=>{i.error=n,n?(s="error",i.status="error"):i.status==="error"?(s=i.streamingInteractionIds.length>0?"streaming":"idle",i.status=s):s=i.status}),r!==s&&Pe.emit(Zn.statusChanged,{status:s}),Pe.emit(Zn.errorChanged,{error:n})},setStatus:n=>{t().status!==n&&(e({status:n}),Pe.emit(Zn.statusChanged,{status:n}))},_addStreamingId:n=>{let r=!1;e(s=>{s.streamingInteractionIds.includes(n)||(s.streamingInteractionIds.push(n),s.activeStreamBuffers[n]="",s.activeReasoningBuffers[n]="",s.streamingInteractionIds.length===1&&(s.status="streaming",r=!0),s.error=null)}),r&&Pe.emit(Zn.statusChanged,{status:"streaming"}),Pe.emit(Zn.streamingIdsChanged,{streamingIds:t().streamingInteractionIds})},_removeStreamingId:n=>{let r=!1;e(s=>{const i=s.streamingInteractionIds.indexOf(n);i!==-1&&(s.streamingInteractionIds.splice(i,1),delete s.activeStreamBuffers[n],delete s.activeReasoningBuffers[n],s.streamingInteractionIds.length===0&&s.status==="streaming"&&(s.status=s.error?"error":"idle",r=!0))}),r&&Pe.emit(Zn.statusChanged,{status:t().status}),Pe.emit(Zn.streamingIdsChanged,{streamingIds:t().streamingInteractionIds})},getRegisteredActionHandlers:()=>{const n="interactionStore",r=t();return[{eventName:Zn.loadInteractionsRequest,handler:s=>r.loadInteractions(s.conversationId),storeId:n},{eventName:Zn.rateInteractionRequest,handler:s=>r.rateInteraction(s.interactionId,s.rating),storeId:n},{eventName:Zn.setCurrentConversationIdRequest,handler:s=>r.setCurrentConversationId(s.id),storeId:n},{eventName:Zn.clearInteractionsRequest,handler:()=>r.clearInteractions(),storeId:n},{eventName:Zn.setErrorRequest,handler:s=>r.setError(s.error),storeId:n},{eventName:Zn.setStatusRequest,handler:s=>r.setStatus(s.status),storeId:n}]}}))),z0e="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";let Vi=(e=21)=>{let t="",n=crypto.getRandomValues(new Uint8Array(e|=0));for(;e--;)t+=z0e[n[e]&63];return t};const ql={attachedFilesChanged:"input.attached.files.changed",addAttachedFileRequest:"input.add.attached.file.request",removeAttachedFileRequest:"input.remove.attached.file.request",clearAttachedFilesRequest:"input.clear.attached.files.request"},mh=$o(zo((e,t)=>({attachedFilesMetadata:[],addAttachedFile:n=>{let r=!1;e(s=>{if(s.attachedFilesMetadata.some(a=>a.source==="direct"&&n.source==="direct"?a.name===n.name&&a.size===n.size:a.source==="vfs"&&n.source==="vfs"?a.path===n.path:!1))console.warn(`InputStore: File "${n.name}" (source: ${n.source}) already attached. Skipping.`);else{const a={id:Vi(),...n};s.attachedFilesMetadata.push(a),r=!0}}),r&&Pe.emit(ql.attachedFilesChanged,{files:t().attachedFilesMetadata})},removeAttachedFile:n=>{let r=!1;e(s=>{const i=s.attachedFilesMetadata.length;s.attachedFilesMetadata=s.attachedFilesMetadata.filter(a=>a.id!==n),r=s.attachedFilesMetadata.length<i}),r&&Pe.emit(ql.attachedFilesChanged,{files:t().attachedFilesMetadata})},clearAttachedFiles:()=>{const n=t().attachedFilesMetadata.length>0;e({attachedFilesMetadata:[]}),n&&Pe.emit(ql.attachedFilesChanged,{files:[]})},getRegisteredActionHandlers:()=>{const n="inputStore",r=t();return[{eventName:ql.addAttachedFileRequest,handler:s=>r.addAttachedFile(s),storeId:n},{eventName:ql.removeAttachedFileRequest,handler:s=>r.removeAttachedFile(s.attachmentId),storeId:n},{eventName:ql.clearAttachedFilesRequest,handler:()=>r.clearAttachedFiles(),storeId:n}]}}))),SH=new Set([".txt",".md",".markdown",".json",".js",".ts",".jsx",".tsx",".html",".htm",".css",".scss",".less",".py",".pyw",".java",".c",".cpp",".h",".hpp",".cs",".go",".php",".rb",".swift",".kt",".kts",".rs",".toml",".yaml",".yml",".xml",".sh",".bash",".zsh",".bat",".cmd",".ps1",".gitignore",".gitattributes",".env",".log",".csv",".tsv",".ini",".cfg",".conf",".sql",".dockerfile","dockerfile",".mod",".sum",".csproj",".vbproj",".fsproj",".sln",".props",".targets",".gradle",".kts",".pom",".rst",".tex",".bib",".r",".rmd",".pl",".pm",".lua",".dart",".diff",".patch",".applescript",".properties",".http",".rest",".tf",".tfvars",".hcl",".rego",".liquid",".erb",".jinja",".j2",".mustache",".hbs",".pug",".haml",".slim",".svelte",".vue",".astro",".svg",".webmanifest",".vtt",".srt",".sbv",".ass",".ssa",".config",".mdx",".nfo",".diz"]);Object.freeze(SH);const Vx=(e,t)=>{if(!e)return!1;const n=e.toLowerCase();if(t!=null&&t.startsWith("text/")||t==="application/json"||t==="application/xml"||t==="application/javascript"||t==="application/typescript"||t==="application/yaml"||t==="application/toml"||t==="application/sql"||t==="application/x-sh"||t==="application/x-httpd-php"||t==="application/x-python"||t==="application/x-ruby"||t==="image/svg+xml"||n.split(".").length<2)return!0;const s="."+n.split(".").pop();return SH.has(s)};var CH="vercel.ai.error",U0e=Symbol.for(CH),kH,q0e=class EH extends Error{constructor({name:t,message:n,cause:r}){super(n),this[kH]=!0,this.name=t,this.cause=r}static isInstance(t){return EH.hasMarker(t,CH)}static hasMarker(t,n){const r=Symbol.for(n);return t!=null&&typeof t=="object"&&r in t&&typeof t[r]=="boolean"&&t[r]===!0}};kH=U0e;var er=q0e,TH="AI_APICallError",AH=`vercel.ai.error.${TH}`,V0e=Symbol.for(AH),RH,Wl=class extends er{constructor({message:e,url:t,requestBodyValues:n,statusCode:r,responseHeaders:s,responseBody:i,cause:a,isRetryable:o=r!=null&&(r===408||r===409||r===429||r>=500),data:l}){super({name:TH,message:e,cause:a}),this[RH]=!0,this.url=t,this.requestBodyValues=n,this.statusCode=r,this.responseHeaders=s,this.responseBody=i,this.isRetryable=o,this.data=l}static isInstance(e){return er.hasMarker(e,AH)}};RH=V0e;var NH="AI_EmptyResponseBodyError",MH=`vercel.ai.error.${NH}`,W0e=Symbol.for(MH),IH,jH=class extends er{constructor({message:e="Empty response body"}={}){super({name:NH,message:e}),this[IH]=!0}static isInstance(e){return er.hasMarker(e,MH)}};IH=W0e;function c1(e){return e==null?"unknown error":typeof e=="string"?e:e instanceof Error?e.message:JSON.stringify(e)}var PH="AI_InvalidArgumentError",OH=`vercel.ai.error.${PH}`,H0e=Symbol.for(OH),DH,FH=class extends er{constructor({message:t,cause:n,argument:r}){super({name:PH,message:t,cause:n}),this[DH]=!0,this.argument=r}static isInstance(t){return er.hasMarker(t,OH)}};DH=H0e;var LH="AI_InvalidPromptError",BH=`vercel.ai.error.${LH}`,G0e=Symbol.for(BH),$H,yc=class extends er{constructor({prompt:e,message:t,cause:n}){super({name:LH,message:`Invalid prompt: ${t}`,cause:n}),this[$H]=!0,this.prompt=e}static isInstance(e){return er.hasMarker(e,BH)}};$H=G0e;var zH="AI_InvalidResponseDataError",UH=`vercel.ai.error.${zH}`,K0e=Symbol.for(UH),qH,Id=class extends er{constructor({data:e,message:t=`Invalid response data: ${JSON.stringify(e)}.`}){super({name:zH,message:t}),this[qH]=!0,this.data=e}static isInstance(e){return er.hasMarker(e,UH)}};qH=K0e;var VH="AI_JSONParseError",WH=`vercel.ai.error.${VH}`,Y0e=Symbol.for(WH),HH,oC=class extends er{constructor({text:e,cause:t}){super({name:VH,message:`JSON parsing failed: Text: ${e}.
Error message: ${c1(t)}`,cause:t}),this[HH]=!0,this.text=e}static isInstance(e){return er.hasMarker(e,WH)}};HH=Y0e;var GH="AI_LoadAPIKeyError",KH=`vercel.ai.error.${GH}`,Z0e=Symbol.for(KH),YH,kS=class extends er{constructor({message:e}){super({name:GH,message:e}),this[YH]=!0}static isInstance(e){return er.hasMarker(e,KH)}};YH=Z0e;var ZH="AI_TooManyEmbeddingValuesForCallError",XH=`vercel.ai.error.${ZH}`,X0e=Symbol.for(XH),JH,bE=class extends er{constructor(e){super({name:ZH,message:`Too many values for a single embedding call. The ${e.provider} model "${e.modelId}" can only embed up to ${e.maxEmbeddingsPerCall} values per call, but ${e.values.length} values were provided.`}),this[JH]=!0,this.provider=e.provider,this.modelId=e.modelId,this.maxEmbeddingsPerCall=e.maxEmbeddingsPerCall,this.values=e.values}static isInstance(e){return er.hasMarker(e,XH)}};JH=X0e;var QH="AI_TypeValidationError",eG=`vercel.ai.error.${QH}`,J0e=Symbol.for(eG),tG,Q0e=class Q3 extends er{constructor({value:t,cause:n}){super({name:QH,message:`Type validation failed: Value: ${JSON.stringify(t)}.
Error message: ${c1(n)}`,cause:n}),this[tG]=!0,this.value=t}static isInstance(t){return er.hasMarker(t,eG)}static wrap({value:t,cause:n}){return Q3.isInstance(n)&&n.value===t?n:new Q3({value:t,cause:n})}};tG=J0e;var lC=Q0e,nG="AI_UnsupportedFunctionalityError",rG=`vercel.ai.error.${nG}`,eye=Symbol.for(rG),sG,hr=class extends er{constructor({functionality:e,message:t=`'${e}' functionality not supported.`}){super({name:nG,message:t}),this[sG]=!0,this.functionality=e}static isInstance(e){return er.hasMarker(e,rG)}};sG=eye;let tye=(e,t=21)=>(n=t)=>{let r="",s=n|0;for(;s--;)r+=e[Math.random()*e.length|0];return r};var zP={},vE={};vE.byteLength=sye;vE.toByteArray=aye;vE.fromByteArray=cye;var fu=[],$l=[],nye=typeof Uint8Array<"u"?Uint8Array:Array,pN="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var Yg=0,rye=pN.length;Yg<rye;++Yg)fu[Yg]=pN[Yg],$l[pN.charCodeAt(Yg)]=Yg;$l[45]=62;$l[95]=63;function iG(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");n===-1&&(n=t);var r=n===t?0:4-n%4;return[n,r]}function sye(e){var t=iG(e),n=t[0],r=t[1];return(n+r)*3/4-r}function iye(e,t,n){return(t+n)*3/4-n}function aye(e){var t,n=iG(e),r=n[0],s=n[1],i=new nye(iye(e,r,s)),a=0,o=s>0?r-4:r,l;for(l=0;l<o;l+=4)t=$l[e.charCodeAt(l)]<<18|$l[e.charCodeAt(l+1)]<<12|$l[e.charCodeAt(l+2)]<<6|$l[e.charCodeAt(l+3)],i[a++]=t>>16&255,i[a++]=t>>8&255,i[a++]=t&255;return s===2&&(t=$l[e.charCodeAt(l)]<<2|$l[e.charCodeAt(l+1)]>>4,i[a++]=t&255),s===1&&(t=$l[e.charCodeAt(l)]<<10|$l[e.charCodeAt(l+1)]<<4|$l[e.charCodeAt(l+2)]>>2,i[a++]=t>>8&255,i[a++]=t&255),i}function oye(e){return fu[e>>18&63]+fu[e>>12&63]+fu[e>>6&63]+fu[e&63]}function lye(e,t,n){for(var r,s=[],i=t;i<n;i+=3)r=(e[i]<<16&16711680)+(e[i+1]<<8&65280)+(e[i+2]&255),s.push(oye(r));return s.join("")}function cye(e){for(var t,n=e.length,r=n%3,s=[],i=16383,a=0,o=n-r;a<o;a+=i)s.push(lye(e,a,a+i>o?o:a+i));return r===1?(t=e[n-1],s.push(fu[t>>2]+fu[t<<4&63]+"==")):r===2&&(t=(e[n-2]<<8)+e[n-1],s.push(fu[t>>10]+fu[t>>4&63]+fu[t<<2&63]+"=")),s.join("")}var UP={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */UP.read=function(e,t,n,r,s){var i,a,o=s*8-r-1,l=(1<<o)-1,c=l>>1,u=-7,d=n?s-1:0,h=n?-1:1,m=e[t+d];for(d+=h,i=m&(1<<-u)-1,m>>=-u,u+=o;u>0;i=i*256+e[t+d],d+=h,u-=8);for(a=i&(1<<-u)-1,i>>=-u,u+=r;u>0;a=a*256+e[t+d],d+=h,u-=8);if(i===0)i=1-c;else{if(i===l)return a?NaN:(m?-1:1)*(1/0);a=a+Math.pow(2,r),i=i-c}return(m?-1:1)*a*Math.pow(2,i-r)};UP.write=function(e,t,n,r,s,i){var a,o,l,c=i*8-s-1,u=(1<<c)-1,d=u>>1,h=s===23?Math.pow(2,-24)-Math.pow(2,-77):0,m=r?0:i-1,y=r?1:-1,b=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(o=isNaN(t)?1:0,a=u):(a=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-a))<1&&(a--,l*=2),a+d>=1?t+=h/l:t+=h*Math.pow(2,1-d),t*l>=2&&(a++,l/=2),a+d>=u?(o=0,a=u):a+d>=1?(o=(t*l-1)*Math.pow(2,s),a=a+d):(o=t*Math.pow(2,d-1)*Math.pow(2,s),a=0));s>=8;e[n+m]=o&255,m+=y,o/=256,s-=8);for(a=a<<s|o,c+=s;c>0;e[n+m]=a&255,m+=y,a/=256,c-=8);e[n+m-y]|=b*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(e){const t=vE,n=UP,r=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=u,e.SlowBuffer=k,e.INSPECT_MAX_BYTES=50;const s=2147483647;e.kMaxLength=s;const{Uint8Array:i,ArrayBuffer:a,SharedArrayBuffer:o}=globalThis;u.TYPED_ARRAY_SUPPORT=l(),!u.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function l(){try{const xe=new i(1),F={foo:function(){return 42}};return Object.setPrototypeOf(F,i.prototype),Object.setPrototypeOf(xe,F),xe.foo()===42}catch{return!1}}Object.defineProperty(u.prototype,"parent",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.buffer}}),Object.defineProperty(u.prototype,"offset",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.byteOffset}});function c(xe){if(xe>s)throw new RangeError('The value "'+xe+'" is invalid for option "size"');const F=new i(xe);return Object.setPrototypeOf(F,u.prototype),F}function u(xe,F,X){if(typeof xe=="number"){if(typeof F=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return y(xe)}return d(xe,F,X)}u.poolSize=8192;function d(xe,F,X){if(typeof xe=="string")return b(xe,F);if(a.isView(xe))return x(xe);if(xe==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof xe);if(ht(xe,a)||xe&&ht(xe.buffer,a)||typeof o<"u"&&(ht(xe,o)||xe&&ht(xe.buffer,o)))return w(xe,F,X);if(typeof xe=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const ye=xe.valueOf&&xe.valueOf();if(ye!=null&&ye!==xe)return u.from(ye,F,X);const Fe=S(xe);if(Fe)return Fe;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof xe[Symbol.toPrimitive]=="function")return u.from(xe[Symbol.toPrimitive]("string"),F,X);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof xe)}u.from=function(xe,F,X){return d(xe,F,X)},Object.setPrototypeOf(u.prototype,i.prototype),Object.setPrototypeOf(u,i);function h(xe){if(typeof xe!="number")throw new TypeError('"size" argument must be of type number');if(xe<0)throw new RangeError('The value "'+xe+'" is invalid for option "size"')}function m(xe,F,X){return h(xe),xe<=0?c(xe):F!==void 0?typeof X=="string"?c(xe).fill(F,X):c(xe).fill(F):c(xe)}u.alloc=function(xe,F,X){return m(xe,F,X)};function y(xe){return h(xe),c(xe<0?0:C(xe)|0)}u.allocUnsafe=function(xe){return y(xe)},u.allocUnsafeSlow=function(xe){return y(xe)};function b(xe,F){if((typeof F!="string"||F==="")&&(F="utf8"),!u.isEncoding(F))throw new TypeError("Unknown encoding: "+F);const X=A(xe,F)|0;let ye=c(X);const Fe=ye.write(xe,F);return Fe!==X&&(ye=ye.slice(0,Fe)),ye}function v(xe){const F=xe.length<0?0:C(xe.length)|0,X=c(F);for(let ye=0;ye<F;ye+=1)X[ye]=xe[ye]&255;return X}function x(xe){if(ht(xe,i)){const F=new i(xe);return w(F.buffer,F.byteOffset,F.byteLength)}return v(xe)}function w(xe,F,X){if(F<0||xe.byteLength<F)throw new RangeError('"offset" is outside of buffer bounds');if(xe.byteLength<F+(X||0))throw new RangeError('"length" is outside of buffer bounds');let ye;return F===void 0&&X===void 0?ye=new i(xe):X===void 0?ye=new i(xe,F):ye=new i(xe,F,X),Object.setPrototypeOf(ye,u.prototype),ye}function S(xe){if(u.isBuffer(xe)){const F=C(xe.length)|0,X=c(F);return X.length===0||xe.copy(X,0,0,F),X}if(xe.length!==void 0)return typeof xe.length!="number"||Pt(xe.length)?c(0):v(xe);if(xe.type==="Buffer"&&Array.isArray(xe.data))return v(xe.data)}function C(xe){if(xe>=s)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s.toString(16)+" bytes");return xe|0}function k(xe){return+xe!=xe&&(xe=0),u.alloc(+xe)}u.isBuffer=function(F){return F!=null&&F._isBuffer===!0&&F!==u.prototype},u.compare=function(F,X){if(ht(F,i)&&(F=u.from(F,F.offset,F.byteLength)),ht(X,i)&&(X=u.from(X,X.offset,X.byteLength)),!u.isBuffer(F)||!u.isBuffer(X))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(F===X)return 0;let ye=F.length,Fe=X.length;for(let we=0,Me=Math.min(ye,Fe);we<Me;++we)if(F[we]!==X[we]){ye=F[we],Fe=X[we];break}return ye<Fe?-1:Fe<ye?1:0},u.isEncoding=function(F){switch(String(F).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(F,X){if(!Array.isArray(F))throw new TypeError('"list" argument must be an Array of Buffers');if(F.length===0)return u.alloc(0);let ye;if(X===void 0)for(X=0,ye=0;ye<F.length;++ye)X+=F[ye].length;const Fe=u.allocUnsafe(X);let we=0;for(ye=0;ye<F.length;++ye){let Me=F[ye];if(ht(Me,i))we+Me.length>Fe.length?(u.isBuffer(Me)||(Me=u.from(Me)),Me.copy(Fe,we)):i.prototype.set.call(Fe,Me,we);else if(u.isBuffer(Me))Me.copy(Fe,we);else throw new TypeError('"list" argument must be an Array of Buffers');we+=Me.length}return Fe};function A(xe,F){if(u.isBuffer(xe))return xe.length;if(a.isView(xe)||ht(xe,a))return xe.byteLength;if(typeof xe!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof xe);const X=xe.length,ye=arguments.length>2&&arguments[2]===!0;if(!ye&&X===0)return 0;let Fe=!1;for(;;)switch(F){case"ascii":case"latin1":case"binary":return X;case"utf8":case"utf-8":return Te(xe).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return X*2;case"hex":return X>>>1;case"base64":return lt(xe).length;default:if(Fe)return ye?-1:Te(xe).length;F=(""+F).toLowerCase(),Fe=!0}}u.byteLength=A;function R(xe,F,X){let ye=!1;if((F===void 0||F<0)&&(F=0),F>this.length||((X===void 0||X>this.length)&&(X=this.length),X<=0)||(X>>>=0,F>>>=0,X<=F))return"";for(xe||(xe="utf8");;)switch(xe){case"hex":return ee(this,F,X);case"utf8":case"utf-8":return H(this,F,X);case"ascii":return W(this,F,X);case"latin1":case"binary":return Q(this,F,X);case"base64":return U(this,F,X);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return se(this,F,X);default:if(ye)throw new TypeError("Unknown encoding: "+xe);xe=(xe+"").toLowerCase(),ye=!0}}u.prototype._isBuffer=!0;function N(xe,F,X){const ye=xe[F];xe[F]=xe[X],xe[X]=ye}u.prototype.swap16=function(){const F=this.length;if(F%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let X=0;X<F;X+=2)N(this,X,X+1);return this},u.prototype.swap32=function(){const F=this.length;if(F%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let X=0;X<F;X+=4)N(this,X,X+3),N(this,X+1,X+2);return this},u.prototype.swap64=function(){const F=this.length;if(F%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let X=0;X<F;X+=8)N(this,X,X+7),N(this,X+1,X+6),N(this,X+2,X+5),N(this,X+3,X+4);return this},u.prototype.toString=function(){const F=this.length;return F===0?"":arguments.length===0?H(this,0,F):R.apply(this,arguments)},u.prototype.toLocaleString=u.prototype.toString,u.prototype.equals=function(F){if(!u.isBuffer(F))throw new TypeError("Argument must be a Buffer");return this===F?!0:u.compare(this,F)===0},u.prototype.inspect=function(){let F="";const X=e.INSPECT_MAX_BYTES;return F=this.toString("hex",0,X).replace(/(.{2})/g,"$1 ").trim(),this.length>X&&(F+=" ... "),"<Buffer "+F+">"},r&&(u.prototype[r]=u.prototype.inspect),u.prototype.compare=function(F,X,ye,Fe,we){if(ht(F,i)&&(F=u.from(F,F.offset,F.byteLength)),!u.isBuffer(F))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof F);if(X===void 0&&(X=0),ye===void 0&&(ye=F?F.length:0),Fe===void 0&&(Fe=0),we===void 0&&(we=this.length),X<0||ye>F.length||Fe<0||we>this.length)throw new RangeError("out of range index");if(Fe>=we&&X>=ye)return 0;if(Fe>=we)return-1;if(X>=ye)return 1;if(X>>>=0,ye>>>=0,Fe>>>=0,we>>>=0,this===F)return 0;let Me=we-Fe,de=ye-X;const vt=Math.min(Me,de),ot=this.slice(Fe,we),B=F.slice(X,ye);for(let ze=0;ze<vt;++ze)if(ot[ze]!==B[ze]){Me=ot[ze],de=B[ze];break}return Me<de?-1:de<Me?1:0};function I(xe,F,X,ye,Fe){if(xe.length===0)return-1;if(typeof X=="string"?(ye=X,X=0):X>2147483647?X=2147483647:X<-2147483648&&(X=-2147483648),X=+X,Pt(X)&&(X=Fe?0:xe.length-1),X<0&&(X=xe.length+X),X>=xe.length){if(Fe)return-1;X=xe.length-1}else if(X<0)if(Fe)X=0;else return-1;if(typeof F=="string"&&(F=u.from(F,ye)),u.isBuffer(F))return F.length===0?-1:P(xe,F,X,ye,Fe);if(typeof F=="number")return F=F&255,typeof i.prototype.indexOf=="function"?Fe?i.prototype.indexOf.call(xe,F,X):i.prototype.lastIndexOf.call(xe,F,X):P(xe,[F],X,ye,Fe);throw new TypeError("val must be string, number or Buffer")}function P(xe,F,X,ye,Fe){let we=1,Me=xe.length,de=F.length;if(ye!==void 0&&(ye=String(ye).toLowerCase(),ye==="ucs2"||ye==="ucs-2"||ye==="utf16le"||ye==="utf-16le")){if(xe.length<2||F.length<2)return-1;we=2,Me/=2,de/=2,X/=2}function vt(B,ze){return we===1?B[ze]:B.readUInt16BE(ze*we)}let ot;if(Fe){let B=-1;for(ot=X;ot<Me;ot++)if(vt(xe,ot)===vt(F,B===-1?0:ot-B)){if(B===-1&&(B=ot),ot-B+1===de)return B*we}else B!==-1&&(ot-=ot-B),B=-1}else for(X+de>Me&&(X=Me-de),ot=X;ot>=0;ot--){let B=!0;for(let ze=0;ze<de;ze++)if(vt(xe,ot+ze)!==vt(F,ze)){B=!1;break}if(B)return ot}return-1}u.prototype.includes=function(F,X,ye){return this.indexOf(F,X,ye)!==-1},u.prototype.indexOf=function(F,X,ye){return I(this,F,X,ye,!0)},u.prototype.lastIndexOf=function(F,X,ye){return I(this,F,X,ye,!1)};function L(xe,F,X,ye){X=Number(X)||0;const Fe=xe.length-X;ye?(ye=Number(ye),ye>Fe&&(ye=Fe)):ye=Fe;const we=F.length;ye>we/2&&(ye=we/2);let Me;for(Me=0;Me<ye;++Me){const de=parseInt(F.substr(Me*2,2),16);if(Pt(de))return Me;xe[X+Me]=de}return Me}function O(xe,F,X,ye){return Rt(Te(F,xe.length-X),xe,X,ye)}function V(xe,F,X,ye){return Rt(Be(F),xe,X,ye)}function D(xe,F,X,ye){return Rt(lt(F),xe,X,ye)}function Z(xe,F,X,ye){return Rt(ke(F,xe.length-X),xe,X,ye)}u.prototype.write=function(F,X,ye,Fe){if(X===void 0)Fe="utf8",ye=this.length,X=0;else if(ye===void 0&&typeof X=="string")Fe=X,ye=this.length,X=0;else if(isFinite(X))X=X>>>0,isFinite(ye)?(ye=ye>>>0,Fe===void 0&&(Fe="utf8")):(Fe=ye,ye=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const we=this.length-X;if((ye===void 0||ye>we)&&(ye=we),F.length>0&&(ye<0||X<0)||X>this.length)throw new RangeError("Attempt to write outside buffer bounds");Fe||(Fe="utf8");let Me=!1;for(;;)switch(Fe){case"hex":return L(this,F,X,ye);case"utf8":case"utf-8":return O(this,F,X,ye);case"ascii":case"latin1":case"binary":return V(this,F,X,ye);case"base64":return D(this,F,X,ye);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Z(this,F,X,ye);default:if(Me)throw new TypeError("Unknown encoding: "+Fe);Fe=(""+Fe).toLowerCase(),Me=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function U(xe,F,X){return F===0&&X===xe.length?t.fromByteArray(xe):t.fromByteArray(xe.slice(F,X))}function H(xe,F,X){X=Math.min(xe.length,X);const ye=[];let Fe=F;for(;Fe<X;){const we=xe[Fe];let Me=null,de=we>239?4:we>223?3:we>191?2:1;if(Fe+de<=X){let vt,ot,B,ze;switch(de){case 1:we<128&&(Me=we);break;case 2:vt=xe[Fe+1],(vt&192)===128&&(ze=(we&31)<<6|vt&63,ze>127&&(Me=ze));break;case 3:vt=xe[Fe+1],ot=xe[Fe+2],(vt&192)===128&&(ot&192)===128&&(ze=(we&15)<<12|(vt&63)<<6|ot&63,ze>2047&&(ze<55296||ze>57343)&&(Me=ze));break;case 4:vt=xe[Fe+1],ot=xe[Fe+2],B=xe[Fe+3],(vt&192)===128&&(ot&192)===128&&(B&192)===128&&(ze=(we&15)<<18|(vt&63)<<12|(ot&63)<<6|B&63,ze>65535&&ze<1114112&&(Me=ze))}}Me===null?(Me=65533,de=1):Me>65535&&(Me-=65536,ye.push(Me>>>10&1023|55296),Me=56320|Me&1023),ye.push(Me),Fe+=de}return ne(ye)}const $=4096;function ne(xe){const F=xe.length;if(F<=$)return String.fromCharCode.apply(String,xe);let X="",ye=0;for(;ye<F;)X+=String.fromCharCode.apply(String,xe.slice(ye,ye+=$));return X}function W(xe,F,X){let ye="";X=Math.min(xe.length,X);for(let Fe=F;Fe<X;++Fe)ye+=String.fromCharCode(xe[Fe]&127);return ye}function Q(xe,F,X){let ye="";X=Math.min(xe.length,X);for(let Fe=F;Fe<X;++Fe)ye+=String.fromCharCode(xe[Fe]);return ye}function ee(xe,F,X){const ye=xe.length;(!F||F<0)&&(F=0),(!X||X<0||X>ye)&&(X=ye);let Fe="";for(let we=F;we<X;++we)Fe+=qt[xe[we]];return Fe}function se(xe,F,X){const ye=xe.slice(F,X);let Fe="";for(let we=0;we<ye.length-1;we+=2)Fe+=String.fromCharCode(ye[we]+ye[we+1]*256);return Fe}u.prototype.slice=function(F,X){const ye=this.length;F=~~F,X=X===void 0?ye:~~X,F<0?(F+=ye,F<0&&(F=0)):F>ye&&(F=ye),X<0?(X+=ye,X<0&&(X=0)):X>ye&&(X=ye),X<F&&(X=F);const Fe=this.subarray(F,X);return Object.setPrototypeOf(Fe,u.prototype),Fe};function pe(xe,F,X){if(xe%1!==0||xe<0)throw new RangeError("offset is not uint");if(xe+F>X)throw new RangeError("Trying to access beyond buffer length")}u.prototype.readUintLE=u.prototype.readUIntLE=function(F,X,ye){F=F>>>0,X=X>>>0,ye||pe(F,X,this.length);let Fe=this[F],we=1,Me=0;for(;++Me<X&&(we*=256);)Fe+=this[F+Me]*we;return Fe},u.prototype.readUintBE=u.prototype.readUIntBE=function(F,X,ye){F=F>>>0,X=X>>>0,ye||pe(F,X,this.length);let Fe=this[F+--X],we=1;for(;X>0&&(we*=256);)Fe+=this[F+--X]*we;return Fe},u.prototype.readUint8=u.prototype.readUInt8=function(F,X){return F=F>>>0,X||pe(F,1,this.length),this[F]},u.prototype.readUint16LE=u.prototype.readUInt16LE=function(F,X){return F=F>>>0,X||pe(F,2,this.length),this[F]|this[F+1]<<8},u.prototype.readUint16BE=u.prototype.readUInt16BE=function(F,X){return F=F>>>0,X||pe(F,2,this.length),this[F]<<8|this[F+1]},u.prototype.readUint32LE=u.prototype.readUInt32LE=function(F,X){return F=F>>>0,X||pe(F,4,this.length),(this[F]|this[F+1]<<8|this[F+2]<<16)+this[F+3]*16777216},u.prototype.readUint32BE=u.prototype.readUInt32BE=function(F,X){return F=F>>>0,X||pe(F,4,this.length),this[F]*16777216+(this[F+1]<<16|this[F+2]<<8|this[F+3])},u.prototype.readBigUInt64LE=Lt(function(F){F=F>>>0,Ae(F,"offset");const X=this[F],ye=this[F+7];(X===void 0||ye===void 0)&&le(F,this.length-8);const Fe=X+this[++F]*2**8+this[++F]*2**16+this[++F]*2**24,we=this[++F]+this[++F]*2**8+this[++F]*2**16+ye*2**24;return BigInt(Fe)+(BigInt(we)<<BigInt(32))}),u.prototype.readBigUInt64BE=Lt(function(F){F=F>>>0,Ae(F,"offset");const X=this[F],ye=this[F+7];(X===void 0||ye===void 0)&&le(F,this.length-8);const Fe=X*2**24+this[++F]*2**16+this[++F]*2**8+this[++F],we=this[++F]*2**24+this[++F]*2**16+this[++F]*2**8+ye;return(BigInt(Fe)<<BigInt(32))+BigInt(we)}),u.prototype.readIntLE=function(F,X,ye){F=F>>>0,X=X>>>0,ye||pe(F,X,this.length);let Fe=this[F],we=1,Me=0;for(;++Me<X&&(we*=256);)Fe+=this[F+Me]*we;return we*=128,Fe>=we&&(Fe-=Math.pow(2,8*X)),Fe},u.prototype.readIntBE=function(F,X,ye){F=F>>>0,X=X>>>0,ye||pe(F,X,this.length);let Fe=X,we=1,Me=this[F+--Fe];for(;Fe>0&&(we*=256);)Me+=this[F+--Fe]*we;return we*=128,Me>=we&&(Me-=Math.pow(2,8*X)),Me},u.prototype.readInt8=function(F,X){return F=F>>>0,X||pe(F,1,this.length),this[F]&128?(255-this[F]+1)*-1:this[F]},u.prototype.readInt16LE=function(F,X){F=F>>>0,X||pe(F,2,this.length);const ye=this[F]|this[F+1]<<8;return ye&32768?ye|4294901760:ye},u.prototype.readInt16BE=function(F,X){F=F>>>0,X||pe(F,2,this.length);const ye=this[F+1]|this[F]<<8;return ye&32768?ye|4294901760:ye},u.prototype.readInt32LE=function(F,X){return F=F>>>0,X||pe(F,4,this.length),this[F]|this[F+1]<<8|this[F+2]<<16|this[F+3]<<24},u.prototype.readInt32BE=function(F,X){return F=F>>>0,X||pe(F,4,this.length),this[F]<<24|this[F+1]<<16|this[F+2]<<8|this[F+3]},u.prototype.readBigInt64LE=Lt(function(F){F=F>>>0,Ae(F,"offset");const X=this[F],ye=this[F+7];(X===void 0||ye===void 0)&&le(F,this.length-8);const Fe=this[F+4]+this[F+5]*2**8+this[F+6]*2**16+(ye<<24);return(BigInt(Fe)<<BigInt(32))+BigInt(X+this[++F]*2**8+this[++F]*2**16+this[++F]*2**24)}),u.prototype.readBigInt64BE=Lt(function(F){F=F>>>0,Ae(F,"offset");const X=this[F],ye=this[F+7];(X===void 0||ye===void 0)&&le(F,this.length-8);const Fe=(X<<24)+this[++F]*2**16+this[++F]*2**8+this[++F];return(BigInt(Fe)<<BigInt(32))+BigInt(this[++F]*2**24+this[++F]*2**16+this[++F]*2**8+ye)}),u.prototype.readFloatLE=function(F,X){return F=F>>>0,X||pe(F,4,this.length),n.read(this,F,!0,23,4)},u.prototype.readFloatBE=function(F,X){return F=F>>>0,X||pe(F,4,this.length),n.read(this,F,!1,23,4)},u.prototype.readDoubleLE=function(F,X){return F=F>>>0,X||pe(F,8,this.length),n.read(this,F,!0,52,8)},u.prototype.readDoubleBE=function(F,X){return F=F>>>0,X||pe(F,8,this.length),n.read(this,F,!1,52,8)};function ce(xe,F,X,ye,Fe,we){if(!u.isBuffer(xe))throw new TypeError('"buffer" argument must be a Buffer instance');if(F>Fe||F<we)throw new RangeError('"value" argument is out of bounds');if(X+ye>xe.length)throw new RangeError("Index out of range")}u.prototype.writeUintLE=u.prototype.writeUIntLE=function(F,X,ye,Fe){if(F=+F,X=X>>>0,ye=ye>>>0,!Fe){const de=Math.pow(2,8*ye)-1;ce(this,F,X,ye,de,0)}let we=1,Me=0;for(this[X]=F&255;++Me<ye&&(we*=256);)this[X+Me]=F/we&255;return X+ye},u.prototype.writeUintBE=u.prototype.writeUIntBE=function(F,X,ye,Fe){if(F=+F,X=X>>>0,ye=ye>>>0,!Fe){const de=Math.pow(2,8*ye)-1;ce(this,F,X,ye,de,0)}let we=ye-1,Me=1;for(this[X+we]=F&255;--we>=0&&(Me*=256);)this[X+we]=F/Me&255;return X+ye},u.prototype.writeUint8=u.prototype.writeUInt8=function(F,X,ye){return F=+F,X=X>>>0,ye||ce(this,F,X,1,255,0),this[X]=F&255,X+1},u.prototype.writeUint16LE=u.prototype.writeUInt16LE=function(F,X,ye){return F=+F,X=X>>>0,ye||ce(this,F,X,2,65535,0),this[X]=F&255,this[X+1]=F>>>8,X+2},u.prototype.writeUint16BE=u.prototype.writeUInt16BE=function(F,X,ye){return F=+F,X=X>>>0,ye||ce(this,F,X,2,65535,0),this[X]=F>>>8,this[X+1]=F&255,X+2},u.prototype.writeUint32LE=u.prototype.writeUInt32LE=function(F,X,ye){return F=+F,X=X>>>0,ye||ce(this,F,X,4,4294967295,0),this[X+3]=F>>>24,this[X+2]=F>>>16,this[X+1]=F>>>8,this[X]=F&255,X+4},u.prototype.writeUint32BE=u.prototype.writeUInt32BE=function(F,X,ye){return F=+F,X=X>>>0,ye||ce(this,F,X,4,4294967295,0),this[X]=F>>>24,this[X+1]=F>>>16,this[X+2]=F>>>8,this[X+3]=F&255,X+4};function Ie(xe,F,X,ye,Fe){ge(F,ye,Fe,xe,X,7);let we=Number(F&BigInt(4294967295));xe[X++]=we,we=we>>8,xe[X++]=we,we=we>>8,xe[X++]=we,we=we>>8,xe[X++]=we;let Me=Number(F>>BigInt(32)&BigInt(4294967295));return xe[X++]=Me,Me=Me>>8,xe[X++]=Me,Me=Me>>8,xe[X++]=Me,Me=Me>>8,xe[X++]=Me,X}function De(xe,F,X,ye,Fe){ge(F,ye,Fe,xe,X,7);let we=Number(F&BigInt(4294967295));xe[X+7]=we,we=we>>8,xe[X+6]=we,we=we>>8,xe[X+5]=we,we=we>>8,xe[X+4]=we;let Me=Number(F>>BigInt(32)&BigInt(4294967295));return xe[X+3]=Me,Me=Me>>8,xe[X+2]=Me,Me=Me>>8,xe[X+1]=Me,Me=Me>>8,xe[X]=Me,X+8}u.prototype.writeBigUInt64LE=Lt(function(F,X=0){return Ie(this,F,X,BigInt(0),BigInt("0xffffffffffffffff"))}),u.prototype.writeBigUInt64BE=Lt(function(F,X=0){return De(this,F,X,BigInt(0),BigInt("0xffffffffffffffff"))}),u.prototype.writeIntLE=function(F,X,ye,Fe){if(F=+F,X=X>>>0,!Fe){const vt=Math.pow(2,8*ye-1);ce(this,F,X,ye,vt-1,-vt)}let we=0,Me=1,de=0;for(this[X]=F&255;++we<ye&&(Me*=256);)F<0&&de===0&&this[X+we-1]!==0&&(de=1),this[X+we]=(F/Me>>0)-de&255;return X+ye},u.prototype.writeIntBE=function(F,X,ye,Fe){if(F=+F,X=X>>>0,!Fe){const vt=Math.pow(2,8*ye-1);ce(this,F,X,ye,vt-1,-vt)}let we=ye-1,Me=1,de=0;for(this[X+we]=F&255;--we>=0&&(Me*=256);)F<0&&de===0&&this[X+we+1]!==0&&(de=1),this[X+we]=(F/Me>>0)-de&255;return X+ye},u.prototype.writeInt8=function(F,X,ye){return F=+F,X=X>>>0,ye||ce(this,F,X,1,127,-128),F<0&&(F=255+F+1),this[X]=F&255,X+1},u.prototype.writeInt16LE=function(F,X,ye){return F=+F,X=X>>>0,ye||ce(this,F,X,2,32767,-32768),this[X]=F&255,this[X+1]=F>>>8,X+2},u.prototype.writeInt16BE=function(F,X,ye){return F=+F,X=X>>>0,ye||ce(this,F,X,2,32767,-32768),this[X]=F>>>8,this[X+1]=F&255,X+2},u.prototype.writeInt32LE=function(F,X,ye){return F=+F,X=X>>>0,ye||ce(this,F,X,4,2147483647,-2147483648),this[X]=F&255,this[X+1]=F>>>8,this[X+2]=F>>>16,this[X+3]=F>>>24,X+4},u.prototype.writeInt32BE=function(F,X,ye){return F=+F,X=X>>>0,ye||ce(this,F,X,4,2147483647,-2147483648),F<0&&(F=4294967295+F+1),this[X]=F>>>24,this[X+1]=F>>>16,this[X+2]=F>>>8,this[X+3]=F&255,X+4},u.prototype.writeBigInt64LE=Lt(function(F,X=0){return Ie(this,F,X,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),u.prototype.writeBigInt64BE=Lt(function(F,X=0){return De(this,F,X,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function Se(xe,F,X,ye,Fe,we){if(X+ye>xe.length)throw new RangeError("Index out of range");if(X<0)throw new RangeError("Index out of range")}function Ce(xe,F,X,ye,Fe){return F=+F,X=X>>>0,Fe||Se(xe,F,X,4),n.write(xe,F,X,ye,23,4),X+4}u.prototype.writeFloatLE=function(F,X,ye){return Ce(this,F,X,!0,ye)},u.prototype.writeFloatBE=function(F,X,ye){return Ce(this,F,X,!1,ye)};function qe(xe,F,X,ye,Fe){return F=+F,X=X>>>0,Fe||Se(xe,F,X,8),n.write(xe,F,X,ye,52,8),X+8}u.prototype.writeDoubleLE=function(F,X,ye){return qe(this,F,X,!0,ye)},u.prototype.writeDoubleBE=function(F,X,ye){return qe(this,F,X,!1,ye)},u.prototype.copy=function(F,X,ye,Fe){if(!u.isBuffer(F))throw new TypeError("argument should be a Buffer");if(ye||(ye=0),!Fe&&Fe!==0&&(Fe=this.length),X>=F.length&&(X=F.length),X||(X=0),Fe>0&&Fe<ye&&(Fe=ye),Fe===ye||F.length===0||this.length===0)return 0;if(X<0)throw new RangeError("targetStart out of bounds");if(ye<0||ye>=this.length)throw new RangeError("Index out of range");if(Fe<0)throw new RangeError("sourceEnd out of bounds");Fe>this.length&&(Fe=this.length),F.length-X<Fe-ye&&(Fe=F.length-X+ye);const we=Fe-ye;return this===F&&typeof i.prototype.copyWithin=="function"?this.copyWithin(X,ye,Fe):i.prototype.set.call(F,this.subarray(ye,Fe),X),we},u.prototype.fill=function(F,X,ye,Fe){if(typeof F=="string"){if(typeof X=="string"?(Fe=X,X=0,ye=this.length):typeof ye=="string"&&(Fe=ye,ye=this.length),Fe!==void 0&&typeof Fe!="string")throw new TypeError("encoding must be a string");if(typeof Fe=="string"&&!u.isEncoding(Fe))throw new TypeError("Unknown encoding: "+Fe);if(F.length===1){const Me=F.charCodeAt(0);(Fe==="utf8"&&Me<128||Fe==="latin1")&&(F=Me)}}else typeof F=="number"?F=F&255:typeof F=="boolean"&&(F=Number(F));if(X<0||this.length<X||this.length<ye)throw new RangeError("Out of range index");if(ye<=X)return this;X=X>>>0,ye=ye===void 0?this.length:ye>>>0,F||(F=0);let we;if(typeof F=="number")for(we=X;we<ye;++we)this[we]=F;else{const Me=u.isBuffer(F)?F:u.from(F,Fe),de=Me.length;if(de===0)throw new TypeError('The value "'+F+'" is invalid for argument "value"');for(we=0;we<ye-X;++we)this[we+X]=Me[we%de]}return this};const Qe={};function Ve(xe,F,X){Qe[xe]=class extends X{constructor(){super(),Object.defineProperty(this,"message",{value:F.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${xe}]`,this.stack,delete this.name}get code(){return xe}set code(Fe){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:Fe,writable:!0})}toString(){return`${this.name} [${xe}]: ${this.message}`}}}Ve("ERR_BUFFER_OUT_OF_BOUNDS",function(xe){return xe?`${xe} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),Ve("ERR_INVALID_ARG_TYPE",function(xe,F){return`The "${xe}" argument must be of type number. Received type ${typeof F}`},TypeError),Ve("ERR_OUT_OF_RANGE",function(xe,F,X){let ye=`The value of "${xe}" is out of range.`,Fe=X;return Number.isInteger(X)&&Math.abs(X)>2**32?Fe=Ne(String(X)):typeof X=="bigint"&&(Fe=String(X),(X>BigInt(2)**BigInt(32)||X<-(BigInt(2)**BigInt(32)))&&(Fe=Ne(Fe)),Fe+="n"),ye+=` It must be ${F}. Received ${Fe}`,ye},RangeError);function Ne(xe){let F="",X=xe.length;const ye=xe[0]==="-"?1:0;for(;X>=ye+4;X-=3)F=`_${xe.slice(X-3,X)}${F}`;return`${xe.slice(0,X)}${F}`}function K(xe,F,X){Ae(F,"offset"),(xe[F]===void 0||xe[F+X]===void 0)&&le(F,xe.length-(X+1))}function ge(xe,F,X,ye,Fe,we){if(xe>X||xe<F){const Me=typeof F=="bigint"?"n":"";let de;throw F===0||F===BigInt(0)?de=`>= 0${Me} and < 2${Me} ** ${(we+1)*8}${Me}`:de=`>= -(2${Me} ** ${(we+1)*8-1}${Me}) and < 2 ** ${(we+1)*8-1}${Me}`,new Qe.ERR_OUT_OF_RANGE("value",de,xe)}K(ye,Fe,we)}function Ae(xe,F){if(typeof xe!="number")throw new Qe.ERR_INVALID_ARG_TYPE(F,"number",xe)}function le(xe,F,X){throw Math.floor(xe)!==xe?(Ae(xe,X),new Qe.ERR_OUT_OF_RANGE("offset","an integer",xe)):F<0?new Qe.ERR_BUFFER_OUT_OF_BOUNDS:new Qe.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${F}`,xe)}const oe=/[^+/0-9A-Za-z-_]/g;function re(xe){if(xe=xe.split("=")[0],xe=xe.trim().replace(oe,""),xe.length<2)return"";for(;xe.length%4!==0;)xe=xe+"=";return xe}function Te(xe,F){F=F||1/0;let X;const ye=xe.length;let Fe=null;const we=[];for(let Me=0;Me<ye;++Me){if(X=xe.charCodeAt(Me),X>55295&&X<57344){if(!Fe){if(X>56319){(F-=3)>-1&&we.push(239,191,189);continue}else if(Me+1===ye){(F-=3)>-1&&we.push(239,191,189);continue}Fe=X;continue}if(X<56320){(F-=3)>-1&&we.push(239,191,189),Fe=X;continue}X=(Fe-55296<<10|X-56320)+65536}else Fe&&(F-=3)>-1&&we.push(239,191,189);if(Fe=null,X<128){if((F-=1)<0)break;we.push(X)}else if(X<2048){if((F-=2)<0)break;we.push(X>>6|192,X&63|128)}else if(X<65536){if((F-=3)<0)break;we.push(X>>12|224,X>>6&63|128,X&63|128)}else if(X<1114112){if((F-=4)<0)break;we.push(X>>18|240,X>>12&63|128,X>>6&63|128,X&63|128)}else throw new Error("Invalid code point")}return we}function Be(xe){const F=[];for(let X=0;X<xe.length;++X)F.push(xe.charCodeAt(X)&255);return F}function ke(xe,F){let X,ye,Fe;const we=[];for(let Me=0;Me<xe.length&&!((F-=2)<0);++Me)X=xe.charCodeAt(Me),ye=X>>8,Fe=X%256,we.push(Fe),we.push(ye);return we}function lt(xe){return t.toByteArray(re(xe))}function Rt(xe,F,X,ye){let Fe;for(Fe=0;Fe<ye&&!(Fe+X>=F.length||Fe>=xe.length);++Fe)F[Fe+X]=xe[Fe];return Fe}function ht(xe,F){return xe instanceof F||xe!=null&&xe.constructor!=null&&xe.constructor.name!=null&&xe.constructor.name===F.name}function Pt(xe){return xe!==xe}const qt=function(){const xe="0123456789abcdef",F=new Array(256);for(let X=0;X<16;++X){const ye=X*16;for(let Fe=0;Fe<16;++Fe)F[ye+Fe]=xe[X]+xe[Fe]}return F}();function Lt(xe){return typeof BigInt>"u"?en:xe}function en(){throw new Error("BigInt not supported")}})(zP);const ln=zP.Buffer,Os=zP.Buffer;var Pp={exports:{}},FB;function uye(){if(FB)return Pp.exports;FB=1;const e=typeof ln<"u",t=/"(?:_|\\u005[Ff])(?:_|\\u005[Ff])(?:p|\\u0070)(?:r|\\u0072)(?:o|\\u006[Ff])(?:t|\\u0074)(?:o|\\u006[Ff])(?:_|\\u005[Ff])(?:_|\\u005[Ff])"\s*:/,n=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/;function r(o,l,c){c==null&&l!==null&&typeof l=="object"&&(c=l,l=void 0),e&&ln.isBuffer(o)&&(o=o.toString()),o&&o.charCodeAt(0)===65279&&(o=o.slice(1));const u=JSON.parse(o,l);if(u===null||typeof u!="object")return u;const d=c&&c.protoAction||"error",h=c&&c.constructorAction||"error";if(d==="ignore"&&h==="ignore")return u;if(d!=="ignore"&&h!=="ignore"){if(t.test(o)===!1&&n.test(o)===!1)return u}else if(d!=="ignore"&&h==="ignore"){if(t.test(o)===!1)return u}else if(n.test(o)===!1)return u;return s(u,{protoAction:d,constructorAction:h,safe:c&&c.safe})}function s(o,{protoAction:l="error",constructorAction:c="error",safe:u}={}){let d=[o];for(;d.length;){const h=d;d=[];for(const m of h){if(l!=="ignore"&&Object.prototype.hasOwnProperty.call(m,"__proto__")){if(u===!0)return null;if(l==="error")throw new SyntaxError("Object contains forbidden prototype property");delete m.__proto__}if(c!=="ignore"&&Object.prototype.hasOwnProperty.call(m,"constructor")&&Object.prototype.hasOwnProperty.call(m.constructor,"prototype")){if(u===!0)return null;if(c==="error")throw new SyntaxError("Object contains forbidden prototype property");delete m.constructor}for(const y in m){const b=m[y];b&&typeof b=="object"&&d.push(b)}}}return o}function i(o,l,c){const u=Error.stackTraceLimit;Error.stackTraceLimit=0;try{return r(o,l,c)}finally{Error.stackTraceLimit=u}}function a(o,l){const c=Error.stackTraceLimit;Error.stackTraceLimit=0;try{return r(o,l,{safe:!0})}catch{return null}finally{Error.stackTraceLimit=c}}return Pp.exports=i,Pp.exports.default=i,Pp.exports.parse=i,Pp.exports.safeParse=a,Pp.exports.scan=s,Pp.exports}var dye=uye();const qP=_a(dye);var fye={};function qs(...e){return e.reduce((t,n)=>({...t,...n??{}}),{})}function hye(e){return new ReadableStream({async pull(t){try{const{value:n,done:r}=await e.next();r?t.close():t.enqueue(n)}catch(n){t.error(n)}},cancel(){}})}async function pye(e){return e==null?Promise.resolve():new Promise(t=>setTimeout(t,e))}function aG(){let e="",t,n=[],r,s;function i(l,c){if(l===""){a(c);return}if(l.startsWith(":"))return;const u=l.indexOf(":");if(u===-1){o(l,"");return}const d=l.slice(0,u),h=u+1,m=h<l.length&&l[h]===" "?l.slice(h+1):l.slice(h);o(d,m)}function a(l){n.length>0&&(l.enqueue({event:t,data:n.join(`
`),id:r,retry:s}),n=[],t=void 0,s=void 0)}function o(l,c){switch(l){case"event":t=c;break;case"data":n.push(c);break;case"id":r=c;break;case"retry":const u=parseInt(c,10);isNaN(u)||(s=u);break}}return new TransformStream({transform(l,c){const{lines:u,incompleteLine:d}=mye(e,l);e=d;for(let h=0;h<u.length;h++)i(u[h],c)},flush(l){i(e,l),a(l)}})}function mye(e,t){const n=[];let r=e;for(let s=0;s<t.length;){const i=t[s++];i===`
`?(n.push(r),r=""):i==="\r"?(n.push(r),r="",t[s]===`
`&&s++):r+=i}return{lines:n,incompleteLine:r}}function Oy(e){const t={};return e.headers.forEach((n,r)=>{t[r]=n}),t}var Lm=({prefix:e,size:t=16,alphabet:n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",separator:r="-"}={})=>{const s=tye(n,t);if(e==null)return s;if(n.includes(r))throw new FH({argument:"separator",message:`The separator "${r}" must not be part of the alphabet "${n}".`});return i=>`${e}${r}${s(i)}`},sa=Lm();function gye(e){return e==null?"unknown error":typeof e=="string"?e:e instanceof Error?e.message:JSON.stringify(e)}function yye(e){return Object.fromEntries(Object.entries(e).filter(([t,n])=>n!=null))}function C2(e){return e instanceof Error&&(e.name==="AbortError"||e.name==="TimeoutError")}function VP({apiKey:e,environmentVariableName:t,apiKeyParameterName:n="apiKey",description:r}){if(typeof e=="string")return e;if(e!=null)throw new kS({message:`${r} API key must be a string.`});if(typeof Ai>"u")throw new kS({message:`${r} API key is missing. Pass it using the '${n}' parameter. Environment variables is not supported in this environment.`});if(e=fye[t],e==null)throw new kS({message:`${r} API key is missing. Pass it using the '${n}' parameter or the ${t} environment variable.`});if(typeof e!="string")throw new kS({message:`${r} API key must be a string. The value of the ${t} environment variable is not a string.`});return e}var cC=Symbol.for("vercel.ai.validator");function bye(e){return{[cC]:!0,validate:e}}function vye(e){return typeof e=="object"&&e!==null&&cC in e&&e[cC]===!0&&"validate"in e}function xye(e){return vye(e)?e:wye(e)}function wye(e){return bye(t=>{const n=e.safeParse(t);return n.success?{success:!0,value:n.data}:{success:!1,error:n.error}})}function _ye({value:e,schema:t}){const n=Dy({value:e,schema:t});if(!n.success)throw lC.wrap({value:e,cause:n.error});return n.value}function Dy({value:e,schema:t}){const n=xye(t);try{if(n.validate==null)return{success:!0,value:e};const r=n.validate(e);return r.success?r:{success:!1,error:lC.wrap({value:e,cause:r.error})}}catch(r){return{success:!1,error:lC.wrap({value:e,cause:r})}}}function Sye({text:e,schema:t}){try{const n=qP.parse(e);return t==null?n:_ye({value:n,schema:t})}catch(n){throw oC.isInstance(n)||lC.isInstance(n)?n:new oC({text:e,cause:n})}}function vm({text:e,schema:t}){try{const n=qP.parse(e);if(t==null)return{success:!0,value:n,rawValue:n};const r=Dy({value:n,schema:t});return r.success?{...r,rawValue:n}:r}catch(n){return{success:!1,error:oC.isInstance(n)?n:new oC({text:e,cause:n})}}}function lm(e){try{return qP.parse(e),!0}catch{return!1}}function xE({provider:e,providerOptions:t,schema:n}){if((t==null?void 0:t[e])==null)return;const r=Dy({value:t[e],schema:n});if(!r.success)throw new FH({argument:"providerOptions",message:`invalid ${e} provider options`,cause:r.error});return r.value}var Cye=()=>globalThis.fetch,Vs=async({url:e,headers:t,body:n,failedResponseHandler:r,successfulResponseHandler:s,abortSignal:i,fetch:a})=>oG({url:e,headers:{"Content-Type":"application/json",...t},body:{content:JSON.stringify(n),values:n},failedResponseHandler:r,successfulResponseHandler:s,abortSignal:i,fetch:a}),kye=async({url:e,headers:t,formData:n,failedResponseHandler:r,successfulResponseHandler:s,abortSignal:i,fetch:a})=>oG({url:e,headers:t,body:{content:n,values:Object.fromEntries(n.entries())},failedResponseHandler:r,successfulResponseHandler:s,abortSignal:i,fetch:a}),oG=async({url:e,headers:t={},body:n,successfulResponseHandler:r,failedResponseHandler:s,abortSignal:i,fetch:a=Cye()})=>{try{const o=await a(e,{method:"POST",headers:yye(t),body:n.content,signal:i}),l=Oy(o);if(!o.ok){let c;try{c=await s({response:o,url:e,requestBodyValues:n.values})}catch(u){throw C2(u)||Wl.isInstance(u)?u:new Wl({message:"Failed to process error response",cause:u,statusCode:o.status,url:e,responseHeaders:l,requestBodyValues:n.values})}throw c.value}try{return await r({response:o,url:e,requestBodyValues:n.values})}catch(c){throw c instanceof Error&&(C2(c)||Wl.isInstance(c))?c:new Wl({message:"Failed to process successful response",cause:c,statusCode:o.status,url:e,responseHeaders:l,requestBodyValues:n.values})}}catch(o){if(C2(o))throw o;if(o instanceof TypeError&&o.message==="fetch failed"){const l=o.cause;if(l!=null)throw new Wl({message:`Cannot connect to API: ${l.message}`,cause:l,url:e,requestBodyValues:n.values,isRetryable:!0})}throw o}};async function ej(e){return typeof e=="function"&&(e=e()),Promise.resolve(e)}var Bh=({errorSchema:e,errorToMessage:t,isRetryable:n})=>async({response:r,url:s,requestBodyValues:i})=>{const a=await r.text(),o=Oy(r);if(a.trim()==="")return{responseHeaders:o,value:new Wl({message:r.statusText,url:s,requestBodyValues:i,statusCode:r.status,responseHeaders:o,responseBody:a,isRetryable:n==null?void 0:n(r)})};try{const l=Sye({text:a,schema:e});return{responseHeaders:o,value:new Wl({message:t(l),url:s,requestBodyValues:i,statusCode:r.status,responseHeaders:o,responseBody:a,data:l,isRetryable:n==null?void 0:n(r,l)})}}catch{return{responseHeaders:o,value:new Wl({message:r.statusText,url:s,requestBodyValues:i,statusCode:r.status,responseHeaders:o,responseBody:a,isRetryable:n==null?void 0:n(r)})}}},$h=e=>async({response:t})=>{const n=Oy(t);if(t.body==null)throw new jH({});return{responseHeaders:n,value:t.body.pipeThrough(new TextDecoderStream).pipeThrough(aG()).pipeThrough(new TransformStream({transform({data:r},s){r!=="[DONE]"&&s.enqueue(vm({text:r,schema:e}))}}))}},$a=e=>async({response:t,url:n,requestBodyValues:r})=>{const s=await t.text(),i=vm({text:s,schema:e}),a=Oy(t);if(!i.success)throw new Wl({message:"Invalid JSON response",cause:i.error,statusCode:t.status,responseHeaders:a,responseBody:s,url:n,requestBodyValues:r});return{responseHeaders:a,value:i.value,rawValue:i.rawValue}},Eye=()=>async({response:e,url:t,requestBodyValues:n})=>{const r=Oy(e);if(!e.body)throw new Wl({message:"Response body is empty",url:t,requestBodyValues:n,statusCode:e.status,responseHeaders:r,responseBody:void 0});try{const s=await e.arrayBuffer();return{responseHeaders:r,value:new Uint8Array(s)}}catch(s){throw new Wl({message:"Failed to read response as array buffer",url:t,requestBodyValues:n,statusCode:e.status,responseHeaders:r,responseBody:void 0,cause:s})}},{btoa:Tye,atob:Aye}=globalThis;function wE(e){const t=e.replace(/-/g,"+").replace(/_/g,"/"),n=Aye(t);return Uint8Array.from(n,r=>r.codePointAt(0))}function Nu(e){let t="";for(let n=0;n<e.length;n++)t+=String.fromCodePoint(e[n]);return Tye(t)}function u1(e){return e==null?void 0:e.replace(/\/$/,"")}var Qr;(function(e){e.assertEqual=s=>{};function t(s){}e.assertIs=t;function n(s){throw new Error}e.assertNever=n,e.arrayToEnum=s=>{const i={};for(const a of s)i[a]=a;return i},e.getValidEnumValues=s=>{const i=e.objectKeys(s).filter(o=>typeof s[s[o]]!="number"),a={};for(const o of i)a[o]=s[o];return e.objectValues(a)},e.objectValues=s=>e.objectKeys(s).map(function(i){return s[i]}),e.objectKeys=typeof Object.keys=="function"?s=>Object.keys(s):s=>{const i=[];for(const a in s)Object.prototype.hasOwnProperty.call(s,a)&&i.push(a);return i},e.find=(s,i)=>{for(const a of s)if(i(a))return a},e.isInteger=typeof Number.isInteger=="function"?s=>Number.isInteger(s):s=>typeof s=="number"&&Number.isFinite(s)&&Math.floor(s)===s;function r(s,i=" | "){return s.map(a=>typeof a=="string"?`'${a}'`:a).join(i)}e.joinValues=r,e.jsonStringifyReplacer=(s,i)=>typeof i=="bigint"?i.toString():i})(Qr||(Qr={}));var LB;(function(e){e.mergeShapes=(t,n)=>({...t,...n})})(LB||(LB={}));const gn=Qr.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),nh=e=>{switch(typeof e){case"undefined":return gn.undefined;case"string":return gn.string;case"number":return Number.isNaN(e)?gn.nan:gn.number;case"boolean":return gn.boolean;case"function":return gn.function;case"bigint":return gn.bigint;case"symbol":return gn.symbol;case"object":return Array.isArray(e)?gn.array:e===null?gn.null:e.then&&typeof e.then=="function"&&e.catch&&typeof e.catch=="function"?gn.promise:typeof Map<"u"&&e instanceof Map?gn.map:typeof Set<"u"&&e instanceof Set?gn.set:typeof Date<"u"&&e instanceof Date?gn.date:gn.object;default:return gn.unknown}},Zt=Qr.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class Mc extends Error{get errors(){return this.issues}constructor(t){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=t}format(t){const n=t||function(i){return i.message},r={_errors:[]},s=i=>{for(const a of i.issues)if(a.code==="invalid_union")a.unionErrors.map(s);else if(a.code==="invalid_return_type")s(a.returnTypeError);else if(a.code==="invalid_arguments")s(a.argumentsError);else if(a.path.length===0)r._errors.push(n(a));else{let o=r,l=0;for(;l<a.path.length;){const c=a.path[l];l===a.path.length-1?(o[c]=o[c]||{_errors:[]},o[c]._errors.push(n(a))):o[c]=o[c]||{_errors:[]},o=o[c],l++}}};return s(this),r}static assert(t){if(!(t instanceof Mc))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Qr.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(t=n=>n.message){const n={},r=[];for(const s of this.issues)s.path.length>0?(n[s.path[0]]=n[s.path[0]]||[],n[s.path[0]].push(t(s))):r.push(t(s));return{formErrors:r,fieldErrors:n}}get formErrors(){return this.flatten()}}Mc.create=e=>new Mc(e);const tj=(e,t)=>{let n;switch(e.code){case Zt.invalid_type:e.received===gn.undefined?n="Required":n=`Expected ${e.expected}, received ${e.received}`;break;case Zt.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(e.expected,Qr.jsonStringifyReplacer)}`;break;case Zt.unrecognized_keys:n=`Unrecognized key(s) in object: ${Qr.joinValues(e.keys,", ")}`;break;case Zt.invalid_union:n="Invalid input";break;case Zt.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${Qr.joinValues(e.options)}`;break;case Zt.invalid_enum_value:n=`Invalid enum value. Expected ${Qr.joinValues(e.options)}, received '${e.received}'`;break;case Zt.invalid_arguments:n="Invalid function arguments";break;case Zt.invalid_return_type:n="Invalid function return type";break;case Zt.invalid_date:n="Invalid date";break;case Zt.invalid_string:typeof e.validation=="object"?"includes"in e.validation?(n=`Invalid input: must include "${e.validation.includes}"`,typeof e.validation.position=="number"&&(n=`${n} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?n=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?n=`Invalid input: must end with "${e.validation.endsWith}"`:Qr.assertNever(e.validation):e.validation!=="regex"?n=`Invalid ${e.validation}`:n="Invalid";break;case Zt.too_small:e.type==="array"?n=`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:e.type==="string"?n=`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:e.type==="number"?n=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="date"?n=`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:n="Invalid input";break;case Zt.too_big:e.type==="array"?n=`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:e.type==="string"?n=`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:e.type==="number"?n=`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="bigint"?n=`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="date"?n=`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:n="Invalid input";break;case Zt.custom:n="Invalid input";break;case Zt.invalid_intersection_types:n="Intersection results could not be merged";break;case Zt.not_multiple_of:n=`Number must be a multiple of ${e.multipleOf}`;break;case Zt.not_finite:n="Number must be finite";break;default:n=t.defaultError,Qr.assertNever(e)}return{message:n}};let Rye=tj;function Nye(){return Rye}const Mye=e=>{const{data:t,path:n,errorMaps:r,issueData:s}=e,i=[...n,...s.path||[]],a={...s,path:i};if(s.message!==void 0)return{...s,path:i,message:s.message};let o="";const l=r.filter(c=>!!c).slice().reverse();for(const c of l)o=c(a,{data:t,defaultError:o}).message;return{...s,path:i,message:o}};function fn(e,t){const n=Nye(),r=Mye({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,n,n===tj?void 0:tj].filter(s=>!!s)});e.common.issues.push(r)}class io{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(t,n){const r=[];for(const s of n){if(s.status==="aborted")return cr;s.status==="dirty"&&t.dirty(),r.push(s.value)}return{status:t.value,value:r}}static async mergeObjectAsync(t,n){const r=[];for(const s of n){const i=await s.key,a=await s.value;r.push({key:i,value:a})}return io.mergeObjectSync(t,r)}static mergeObjectSync(t,n){const r={};for(const s of n){const{key:i,value:a}=s;if(i.status==="aborted"||a.status==="aborted")return cr;i.status==="dirty"&&t.dirty(),a.status==="dirty"&&t.dirty(),i.value!=="__proto__"&&(typeof a.value<"u"||s.alwaysSet)&&(r[i.value]=a.value)}return{status:t.value,value:r}}}const cr=Object.freeze({status:"aborted"}),Zv=e=>({status:"dirty",value:e}),Ql=e=>({status:"valid",value:e}),BB=e=>e.status==="aborted",$B=e=>e.status==="dirty",Z0=e=>e.status==="valid",uC=e=>typeof Promise<"u"&&e instanceof Promise;var En;(function(e){e.errToObj=t=>typeof t=="string"?{message:t}:t||{},e.toString=t=>typeof t=="string"?t:t==null?void 0:t.message})(En||(En={}));class Mu{constructor(t,n,r,s){this._cachedPath=[],this.parent=t,this.data=n,this._path=r,this._key=s}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const zB=(e,t)=>{if(Z0(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const n=new Mc(e.common.issues);return this._error=n,this._error}}};function Ar(e){if(!e)return{};const{errorMap:t,invalid_type_error:n,required_error:r,description:s}=e;if(t&&(n||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return t?{errorMap:t,description:s}:{errorMap:(a,o)=>{const{message:l}=e;return a.code==="invalid_enum_value"?{message:l??o.defaultError}:typeof o.data>"u"?{message:l??r??o.defaultError}:a.code!=="invalid_type"?{message:o.defaultError}:{message:l??n??o.defaultError}},description:s}}class Ur{get description(){return this._def.description}_getType(t){return nh(t.data)}_getOrReturnCtx(t,n){return n||{common:t.parent.common,data:t.data,parsedType:nh(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}_processInputParams(t){return{status:new io,ctx:{common:t.parent.common,data:t.data,parsedType:nh(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}}_parseSync(t){const n=this._parse(t);if(uC(n))throw new Error("Synchronous parse encountered promise.");return n}_parseAsync(t){const n=this._parse(t);return Promise.resolve(n)}parse(t,n){const r=this.safeParse(t,n);if(r.success)return r.data;throw r.error}safeParse(t,n){const r={common:{issues:[],async:(n==null?void 0:n.async)??!1,contextualErrorMap:n==null?void 0:n.errorMap},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:nh(t)},s=this._parseSync({data:t,path:r.path,parent:r});return zB(r,s)}"~validate"(t){var r,s;const n={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:nh(t)};if(!this["~standard"].async)try{const i=this._parseSync({data:t,path:[],parent:n});return Z0(i)?{value:i.value}:{issues:n.common.issues}}catch(i){(s=(r=i==null?void 0:i.message)==null?void 0:r.toLowerCase())!=null&&s.includes("encountered")&&(this["~standard"].async=!0),n.common={issues:[],async:!0}}return this._parseAsync({data:t,path:[],parent:n}).then(i=>Z0(i)?{value:i.value}:{issues:n.common.issues})}async parseAsync(t,n){const r=await this.safeParseAsync(t,n);if(r.success)return r.data;throw r.error}async safeParseAsync(t,n){const r={common:{issues:[],contextualErrorMap:n==null?void 0:n.errorMap,async:!0},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:nh(t)},s=this._parse({data:t,path:r.path,parent:r}),i=await(uC(s)?s:Promise.resolve(s));return zB(r,i)}refine(t,n){const r=s=>typeof n=="string"||typeof n>"u"?{message:n}:typeof n=="function"?n(s):n;return this._refinement((s,i)=>{const a=t(s),o=()=>i.addIssue({code:Zt.custom,...r(s)});return typeof Promise<"u"&&a instanceof Promise?a.then(l=>l?!0:(o(),!1)):a?!0:(o(),!1)})}refinement(t,n){return this._refinement((r,s)=>t(r)?!0:(s.addIssue(typeof n=="function"?n(r,s):n),!1))}_refinement(t){return new _m({schema:this,typeName:Qt.ZodEffects,effect:{type:"refinement",refinement:t}})}superRefine(t){return this._refinement(t)}constructor(t){this.spa=this.safeParseAsync,this._def=t,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:n=>this["~validate"](n)}}optional(){return _u.create(this,this._def)}nullable(){return Sm.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return wu.create(this)}promise(){return bC.create(this,this._def)}or(t){return hC.create([this,t],this._def)}and(t){return pC.create(this,t,this._def)}transform(t){return new _m({...Ar(this._def),schema:this,typeName:Qt.ZodEffects,effect:{type:"transform",transform:t}})}default(t){const n=typeof t=="function"?t:()=>t;return new vC({...Ar(this._def),innerType:this,defaultValue:n,typeName:Qt.ZodDefault})}brand(){return new dG({typeName:Qt.ZodBranded,type:this,...Ar(this._def)})}catch(t){const n=typeof t=="function"?t:()=>t;return new xC({...Ar(this._def),innerType:this,catchValue:n,typeName:Qt.ZodCatch})}describe(t){const n=this.constructor;return new n({...this._def,description:t})}pipe(t){return HP.create(this,t)}readonly(){return wC.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const Iye=/^c[^\s-]{8,}$/i,jye=/^[0-9a-z]+$/,Pye=/^[0-9A-HJKMNP-TV-Z]{26}$/i,Oye=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,Dye=/^[a-z0-9_-]{21}$/i,Fye=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,Lye=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,Bye=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,$ye="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let mN;const zye=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Uye=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,qye=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,Vye=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,Wye=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,Hye=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,lG="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",Gye=new RegExp(`^${lG}$`);function cG(e){let t="[0-5]\\d";e.precision?t=`${t}\\.\\d{${e.precision}}`:e.precision==null&&(t=`${t}(\\.\\d+)?`);const n=e.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${t})${n}`}function Kye(e){return new RegExp(`^${cG(e)}$`)}function Yye(e){let t=`${lG}T${cG(e)}`;const n=[];return n.push(e.local?"Z?":"Z"),e.offset&&n.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${n.join("|")})`,new RegExp(`^${t}$`)}function Zye(e,t){return!!((t==="v4"||!t)&&zye.test(e)||(t==="v6"||!t)&&qye.test(e))}function Xye(e,t){if(!Fye.test(e))return!1;try{const[n]=e.split("."),r=n.replace(/-/g,"+").replace(/_/g,"/").padEnd(n.length+(4-n.length%4)%4,"="),s=JSON.parse(atob(r));return!(typeof s!="object"||s===null||"typ"in s&&(s==null?void 0:s.typ)!=="JWT"||!s.alg||t&&s.alg!==t)}catch{return!1}}function Jye(e,t){return!!((t==="v4"||!t)&&Uye.test(e)||(t==="v6"||!t)&&Vye.test(e))}class Td extends Ur{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==gn.string){const i=this._getOrReturnCtx(t);return fn(i,{code:Zt.invalid_type,expected:gn.string,received:i.parsedType}),cr}const r=new io;let s;for(const i of this._def.checks)if(i.kind==="min")t.data.length<i.value&&(s=this._getOrReturnCtx(t,s),fn(s,{code:Zt.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="max")t.data.length>i.value&&(s=this._getOrReturnCtx(t,s),fn(s,{code:Zt.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="length"){const a=t.data.length>i.value,o=t.data.length<i.value;(a||o)&&(s=this._getOrReturnCtx(t,s),a?fn(s,{code:Zt.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):o&&fn(s,{code:Zt.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),r.dirty())}else if(i.kind==="email")Bye.test(t.data)||(s=this._getOrReturnCtx(t,s),fn(s,{validation:"email",code:Zt.invalid_string,message:i.message}),r.dirty());else if(i.kind==="emoji")mN||(mN=new RegExp($ye,"u")),mN.test(t.data)||(s=this._getOrReturnCtx(t,s),fn(s,{validation:"emoji",code:Zt.invalid_string,message:i.message}),r.dirty());else if(i.kind==="uuid")Oye.test(t.data)||(s=this._getOrReturnCtx(t,s),fn(s,{validation:"uuid",code:Zt.invalid_string,message:i.message}),r.dirty());else if(i.kind==="nanoid")Dye.test(t.data)||(s=this._getOrReturnCtx(t,s),fn(s,{validation:"nanoid",code:Zt.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid")Iye.test(t.data)||(s=this._getOrReturnCtx(t,s),fn(s,{validation:"cuid",code:Zt.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid2")jye.test(t.data)||(s=this._getOrReturnCtx(t,s),fn(s,{validation:"cuid2",code:Zt.invalid_string,message:i.message}),r.dirty());else if(i.kind==="ulid")Pye.test(t.data)||(s=this._getOrReturnCtx(t,s),fn(s,{validation:"ulid",code:Zt.invalid_string,message:i.message}),r.dirty());else if(i.kind==="url")try{new URL(t.data)}catch{s=this._getOrReturnCtx(t,s),fn(s,{validation:"url",code:Zt.invalid_string,message:i.message}),r.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(t.data)||(s=this._getOrReturnCtx(t,s),fn(s,{validation:"regex",code:Zt.invalid_string,message:i.message}),r.dirty())):i.kind==="trim"?t.data=t.data.trim():i.kind==="includes"?t.data.includes(i.value,i.position)||(s=this._getOrReturnCtx(t,s),fn(s,{code:Zt.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),r.dirty()):i.kind==="toLowerCase"?t.data=t.data.toLowerCase():i.kind==="toUpperCase"?t.data=t.data.toUpperCase():i.kind==="startsWith"?t.data.startsWith(i.value)||(s=this._getOrReturnCtx(t,s),fn(s,{code:Zt.invalid_string,validation:{startsWith:i.value},message:i.message}),r.dirty()):i.kind==="endsWith"?t.data.endsWith(i.value)||(s=this._getOrReturnCtx(t,s),fn(s,{code:Zt.invalid_string,validation:{endsWith:i.value},message:i.message}),r.dirty()):i.kind==="datetime"?Yye(i).test(t.data)||(s=this._getOrReturnCtx(t,s),fn(s,{code:Zt.invalid_string,validation:"datetime",message:i.message}),r.dirty()):i.kind==="date"?Gye.test(t.data)||(s=this._getOrReturnCtx(t,s),fn(s,{code:Zt.invalid_string,validation:"date",message:i.message}),r.dirty()):i.kind==="time"?Kye(i).test(t.data)||(s=this._getOrReturnCtx(t,s),fn(s,{code:Zt.invalid_string,validation:"time",message:i.message}),r.dirty()):i.kind==="duration"?Lye.test(t.data)||(s=this._getOrReturnCtx(t,s),fn(s,{validation:"duration",code:Zt.invalid_string,message:i.message}),r.dirty()):i.kind==="ip"?Zye(t.data,i.version)||(s=this._getOrReturnCtx(t,s),fn(s,{validation:"ip",code:Zt.invalid_string,message:i.message}),r.dirty()):i.kind==="jwt"?Xye(t.data,i.alg)||(s=this._getOrReturnCtx(t,s),fn(s,{validation:"jwt",code:Zt.invalid_string,message:i.message}),r.dirty()):i.kind==="cidr"?Jye(t.data,i.version)||(s=this._getOrReturnCtx(t,s),fn(s,{validation:"cidr",code:Zt.invalid_string,message:i.message}),r.dirty()):i.kind==="base64"?Wye.test(t.data)||(s=this._getOrReturnCtx(t,s),fn(s,{validation:"base64",code:Zt.invalid_string,message:i.message}),r.dirty()):i.kind==="base64url"?Hye.test(t.data)||(s=this._getOrReturnCtx(t,s),fn(s,{validation:"base64url",code:Zt.invalid_string,message:i.message}),r.dirty()):Qr.assertNever(i);return{status:r.value,value:t.data}}_regex(t,n,r){return this.refinement(s=>t.test(s),{validation:n,code:Zt.invalid_string,...En.errToObj(r)})}_addCheck(t){return new Td({...this._def,checks:[...this._def.checks,t]})}email(t){return this._addCheck({kind:"email",...En.errToObj(t)})}url(t){return this._addCheck({kind:"url",...En.errToObj(t)})}emoji(t){return this._addCheck({kind:"emoji",...En.errToObj(t)})}uuid(t){return this._addCheck({kind:"uuid",...En.errToObj(t)})}nanoid(t){return this._addCheck({kind:"nanoid",...En.errToObj(t)})}cuid(t){return this._addCheck({kind:"cuid",...En.errToObj(t)})}cuid2(t){return this._addCheck({kind:"cuid2",...En.errToObj(t)})}ulid(t){return this._addCheck({kind:"ulid",...En.errToObj(t)})}base64(t){return this._addCheck({kind:"base64",...En.errToObj(t)})}base64url(t){return this._addCheck({kind:"base64url",...En.errToObj(t)})}jwt(t){return this._addCheck({kind:"jwt",...En.errToObj(t)})}ip(t){return this._addCheck({kind:"ip",...En.errToObj(t)})}cidr(t){return this._addCheck({kind:"cidr",...En.errToObj(t)})}datetime(t){return typeof t=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:t}):this._addCheck({kind:"datetime",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,offset:(t==null?void 0:t.offset)??!1,local:(t==null?void 0:t.local)??!1,...En.errToObj(t==null?void 0:t.message)})}date(t){return this._addCheck({kind:"date",message:t})}time(t){return typeof t=="string"?this._addCheck({kind:"time",precision:null,message:t}):this._addCheck({kind:"time",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,...En.errToObj(t==null?void 0:t.message)})}duration(t){return this._addCheck({kind:"duration",...En.errToObj(t)})}regex(t,n){return this._addCheck({kind:"regex",regex:t,...En.errToObj(n)})}includes(t,n){return this._addCheck({kind:"includes",value:t,position:n==null?void 0:n.position,...En.errToObj(n==null?void 0:n.message)})}startsWith(t,n){return this._addCheck({kind:"startsWith",value:t,...En.errToObj(n)})}endsWith(t,n){return this._addCheck({kind:"endsWith",value:t,...En.errToObj(n)})}min(t,n){return this._addCheck({kind:"min",value:t,...En.errToObj(n)})}max(t,n){return this._addCheck({kind:"max",value:t,...En.errToObj(n)})}length(t,n){return this._addCheck({kind:"length",value:t,...En.errToObj(n)})}nonempty(t){return this.min(1,En.errToObj(t))}trim(){return new Td({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Td({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Td({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(t=>t.kind==="datetime")}get isDate(){return!!this._def.checks.find(t=>t.kind==="date")}get isTime(){return!!this._def.checks.find(t=>t.kind==="time")}get isDuration(){return!!this._def.checks.find(t=>t.kind==="duration")}get isEmail(){return!!this._def.checks.find(t=>t.kind==="email")}get isURL(){return!!this._def.checks.find(t=>t.kind==="url")}get isEmoji(){return!!this._def.checks.find(t=>t.kind==="emoji")}get isUUID(){return!!this._def.checks.find(t=>t.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(t=>t.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(t=>t.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(t=>t.kind==="cuid2")}get isULID(){return!!this._def.checks.find(t=>t.kind==="ulid")}get isIP(){return!!this._def.checks.find(t=>t.kind==="ip")}get isCIDR(){return!!this._def.checks.find(t=>t.kind==="cidr")}get isBase64(){return!!this._def.checks.find(t=>t.kind==="base64")}get isBase64url(){return!!this._def.checks.find(t=>t.kind==="base64url")}get minLength(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxLength(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}}Td.create=e=>new Td({checks:[],typeName:Qt.ZodString,coerce:(e==null?void 0:e.coerce)??!1,...Ar(e)});function Qye(e,t){const n=(e.toString().split(".")[1]||"").length,r=(t.toString().split(".")[1]||"").length,s=n>r?n:r,i=Number.parseInt(e.toFixed(s).replace(".","")),a=Number.parseInt(t.toFixed(s).replace(".",""));return i%a/10**s}class X0 extends Ur{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==gn.number){const i=this._getOrReturnCtx(t);return fn(i,{code:Zt.invalid_type,expected:gn.number,received:i.parsedType}),cr}let r;const s=new io;for(const i of this._def.checks)i.kind==="int"?Qr.isInteger(t.data)||(r=this._getOrReturnCtx(t,r),fn(r,{code:Zt.invalid_type,expected:"integer",received:"float",message:i.message}),s.dirty()):i.kind==="min"?(i.inclusive?t.data<i.value:t.data<=i.value)&&(r=this._getOrReturnCtx(t,r),fn(r,{code:Zt.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?t.data>i.value:t.data>=i.value)&&(r=this._getOrReturnCtx(t,r),fn(r,{code:Zt.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="multipleOf"?Qye(t.data,i.value)!==0&&(r=this._getOrReturnCtx(t,r),fn(r,{code:Zt.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):i.kind==="finite"?Number.isFinite(t.data)||(r=this._getOrReturnCtx(t,r),fn(r,{code:Zt.not_finite,message:i.message}),s.dirty()):Qr.assertNever(i);return{status:s.value,value:t.data}}gte(t,n){return this.setLimit("min",t,!0,En.toString(n))}gt(t,n){return this.setLimit("min",t,!1,En.toString(n))}lte(t,n){return this.setLimit("max",t,!0,En.toString(n))}lt(t,n){return this.setLimit("max",t,!1,En.toString(n))}setLimit(t,n,r,s){return new X0({...this._def,checks:[...this._def.checks,{kind:t,value:n,inclusive:r,message:En.toString(s)}]})}_addCheck(t){return new X0({...this._def,checks:[...this._def.checks,t]})}int(t){return this._addCheck({kind:"int",message:En.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:!1,message:En.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:!1,message:En.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:!0,message:En.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:!0,message:En.toString(t)})}multipleOf(t,n){return this._addCheck({kind:"multipleOf",value:t,message:En.toString(n)})}finite(t){return this._addCheck({kind:"finite",message:En.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:En.toString(t)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:En.toString(t)})}get minValue(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxValue(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}get isInt(){return!!this._def.checks.find(t=>t.kind==="int"||t.kind==="multipleOf"&&Qr.isInteger(t.value))}get isFinite(){let t=null,n=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(n===null||r.value>n)&&(n=r.value):r.kind==="max"&&(t===null||r.value<t)&&(t=r.value)}return Number.isFinite(n)&&Number.isFinite(t)}}X0.create=e=>new X0({checks:[],typeName:Qt.ZodNumber,coerce:(e==null?void 0:e.coerce)||!1,...Ar(e)});class Wx extends Ur{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(t){if(this._def.coerce)try{t.data=BigInt(t.data)}catch{return this._getInvalidInput(t)}if(this._getType(t)!==gn.bigint)return this._getInvalidInput(t);let r;const s=new io;for(const i of this._def.checks)i.kind==="min"?(i.inclusive?t.data<i.value:t.data<=i.value)&&(r=this._getOrReturnCtx(t,r),fn(r,{code:Zt.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?t.data>i.value:t.data>=i.value)&&(r=this._getOrReturnCtx(t,r),fn(r,{code:Zt.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="multipleOf"?t.data%i.value!==BigInt(0)&&(r=this._getOrReturnCtx(t,r),fn(r,{code:Zt.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):Qr.assertNever(i);return{status:s.value,value:t.data}}_getInvalidInput(t){const n=this._getOrReturnCtx(t);return fn(n,{code:Zt.invalid_type,expected:gn.bigint,received:n.parsedType}),cr}gte(t,n){return this.setLimit("min",t,!0,En.toString(n))}gt(t,n){return this.setLimit("min",t,!1,En.toString(n))}lte(t,n){return this.setLimit("max",t,!0,En.toString(n))}lt(t,n){return this.setLimit("max",t,!1,En.toString(n))}setLimit(t,n,r,s){return new Wx({...this._def,checks:[...this._def.checks,{kind:t,value:n,inclusive:r,message:En.toString(s)}]})}_addCheck(t){return new Wx({...this._def,checks:[...this._def.checks,t]})}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:En.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:En.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:En.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:En.toString(t)})}multipleOf(t,n){return this._addCheck({kind:"multipleOf",value:t,message:En.toString(n)})}get minValue(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxValue(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}}Wx.create=e=>new Wx({checks:[],typeName:Qt.ZodBigInt,coerce:(e==null?void 0:e.coerce)??!1,...Ar(e)});class nj extends Ur{_parse(t){if(this._def.coerce&&(t.data=!!t.data),this._getType(t)!==gn.boolean){const r=this._getOrReturnCtx(t);return fn(r,{code:Zt.invalid_type,expected:gn.boolean,received:r.parsedType}),cr}return Ql(t.data)}}nj.create=e=>new nj({typeName:Qt.ZodBoolean,coerce:(e==null?void 0:e.coerce)||!1,...Ar(e)});class dC extends Ur{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==gn.date){const i=this._getOrReturnCtx(t);return fn(i,{code:Zt.invalid_type,expected:gn.date,received:i.parsedType}),cr}if(Number.isNaN(t.data.getTime())){const i=this._getOrReturnCtx(t);return fn(i,{code:Zt.invalid_date}),cr}const r=new io;let s;for(const i of this._def.checks)i.kind==="min"?t.data.getTime()<i.value&&(s=this._getOrReturnCtx(t,s),fn(s,{code:Zt.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),r.dirty()):i.kind==="max"?t.data.getTime()>i.value&&(s=this._getOrReturnCtx(t,s),fn(s,{code:Zt.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),r.dirty()):Qr.assertNever(i);return{status:r.value,value:new Date(t.data.getTime())}}_addCheck(t){return new dC({...this._def,checks:[...this._def.checks,t]})}min(t,n){return this._addCheck({kind:"min",value:t.getTime(),message:En.toString(n)})}max(t,n){return this._addCheck({kind:"max",value:t.getTime(),message:En.toString(n)})}get minDate(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t!=null?new Date(t):null}get maxDate(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t!=null?new Date(t):null}}dC.create=e=>new dC({checks:[],coerce:(e==null?void 0:e.coerce)||!1,typeName:Qt.ZodDate,...Ar(e)});class UB extends Ur{_parse(t){if(this._getType(t)!==gn.symbol){const r=this._getOrReturnCtx(t);return fn(r,{code:Zt.invalid_type,expected:gn.symbol,received:r.parsedType}),cr}return Ql(t.data)}}UB.create=e=>new UB({typeName:Qt.ZodSymbol,...Ar(e)});class rj extends Ur{_parse(t){if(this._getType(t)!==gn.undefined){const r=this._getOrReturnCtx(t);return fn(r,{code:Zt.invalid_type,expected:gn.undefined,received:r.parsedType}),cr}return Ql(t.data)}}rj.create=e=>new rj({typeName:Qt.ZodUndefined,...Ar(e)});class fC extends Ur{_parse(t){if(this._getType(t)!==gn.null){const r=this._getOrReturnCtx(t);return fn(r,{code:Zt.invalid_type,expected:gn.null,received:r.parsedType}),cr}return Ql(t.data)}}fC.create=e=>new fC({typeName:Qt.ZodNull,...Ar(e)});class Hx extends Ur{constructor(){super(...arguments),this._any=!0}_parse(t){return Ql(t.data)}}Hx.create=e=>new Hx({typeName:Qt.ZodAny,...Ar(e)});class sj extends Ur{constructor(){super(...arguments),this._unknown=!0}_parse(t){return Ql(t.data)}}sj.create=e=>new sj({typeName:Qt.ZodUnknown,...Ar(e)});class gh extends Ur{_parse(t){const n=this._getOrReturnCtx(t);return fn(n,{code:Zt.invalid_type,expected:gn.never,received:n.parsedType}),cr}}gh.create=e=>new gh({typeName:Qt.ZodNever,...Ar(e)});class qB extends Ur{_parse(t){if(this._getType(t)!==gn.undefined){const r=this._getOrReturnCtx(t);return fn(r,{code:Zt.invalid_type,expected:gn.void,received:r.parsedType}),cr}return Ql(t.data)}}qB.create=e=>new qB({typeName:Qt.ZodVoid,...Ar(e)});class wu extends Ur{_parse(t){const{ctx:n,status:r}=this._processInputParams(t),s=this._def;if(n.parsedType!==gn.array)return fn(n,{code:Zt.invalid_type,expected:gn.array,received:n.parsedType}),cr;if(s.exactLength!==null){const a=n.data.length>s.exactLength.value,o=n.data.length<s.exactLength.value;(a||o)&&(fn(n,{code:a?Zt.too_big:Zt.too_small,minimum:o?s.exactLength.value:void 0,maximum:a?s.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:s.exactLength.message}),r.dirty())}if(s.minLength!==null&&n.data.length<s.minLength.value&&(fn(n,{code:Zt.too_small,minimum:s.minLength.value,type:"array",inclusive:!0,exact:!1,message:s.minLength.message}),r.dirty()),s.maxLength!==null&&n.data.length>s.maxLength.value&&(fn(n,{code:Zt.too_big,maximum:s.maxLength.value,type:"array",inclusive:!0,exact:!1,message:s.maxLength.message}),r.dirty()),n.common.async)return Promise.all([...n.data].map((a,o)=>s.type._parseAsync(new Mu(n,a,n.path,o)))).then(a=>io.mergeArray(r,a));const i=[...n.data].map((a,o)=>s.type._parseSync(new Mu(n,a,n.path,o)));return io.mergeArray(r,i)}get element(){return this._def.type}min(t,n){return new wu({...this._def,minLength:{value:t,message:En.toString(n)}})}max(t,n){return new wu({...this._def,maxLength:{value:t,message:En.toString(n)}})}length(t,n){return new wu({...this._def,exactLength:{value:t,message:En.toString(n)}})}nonempty(t){return this.min(1,t)}}wu.create=(e,t)=>new wu({type:e,minLength:null,maxLength:null,exactLength:null,typeName:Qt.ZodArray,...Ar(t)});function l0(e){if(e instanceof Ei){const t={};for(const n in e.shape){const r=e.shape[n];t[n]=_u.create(l0(r))}return new Ei({...e._def,shape:()=>t})}else return e instanceof wu?new wu({...e._def,type:l0(e.element)}):e instanceof _u?_u.create(l0(e.unwrap())):e instanceof Sm?Sm.create(l0(e.unwrap())):e instanceof xm?xm.create(e.items.map(t=>l0(t))):e}class Ei extends Ur{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const t=this._def.shape(),n=Qr.objectKeys(t);return this._cached={shape:t,keys:n},this._cached}_parse(t){if(this._getType(t)!==gn.object){const c=this._getOrReturnCtx(t);return fn(c,{code:Zt.invalid_type,expected:gn.object,received:c.parsedType}),cr}const{status:r,ctx:s}=this._processInputParams(t),{shape:i,keys:a}=this._getCached(),o=[];if(!(this._def.catchall instanceof gh&&this._def.unknownKeys==="strip"))for(const c in s.data)a.includes(c)||o.push(c);const l=[];for(const c of a){const u=i[c],d=s.data[c];l.push({key:{status:"valid",value:c},value:u._parse(new Mu(s,d,s.path,c)),alwaysSet:c in s.data})}if(this._def.catchall instanceof gh){const c=this._def.unknownKeys;if(c==="passthrough")for(const u of o)l.push({key:{status:"valid",value:u},value:{status:"valid",value:s.data[u]}});else if(c==="strict")o.length>0&&(fn(s,{code:Zt.unrecognized_keys,keys:o}),r.dirty());else if(c!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const c=this._def.catchall;for(const u of o){const d=s.data[u];l.push({key:{status:"valid",value:u},value:c._parse(new Mu(s,d,s.path,u)),alwaysSet:u in s.data})}}return s.common.async?Promise.resolve().then(async()=>{const c=[];for(const u of l){const d=await u.key,h=await u.value;c.push({key:d,value:h,alwaysSet:u.alwaysSet})}return c}).then(c=>io.mergeObjectSync(r,c)):io.mergeObjectSync(r,l)}get shape(){return this._def.shape()}strict(t){return En.errToObj,new Ei({...this._def,unknownKeys:"strict",...t!==void 0?{errorMap:(n,r)=>{var i,a;const s=((a=(i=this._def).errorMap)==null?void 0:a.call(i,n,r).message)??r.defaultError;return n.code==="unrecognized_keys"?{message:En.errToObj(t).message??s}:{message:s}}}:{}})}strip(){return new Ei({...this._def,unknownKeys:"strip"})}passthrough(){return new Ei({...this._def,unknownKeys:"passthrough"})}extend(t){return new Ei({...this._def,shape:()=>({...this._def.shape(),...t})})}merge(t){return new Ei({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>({...this._def.shape(),...t._def.shape()}),typeName:Qt.ZodObject})}setKey(t,n){return this.augment({[t]:n})}catchall(t){return new Ei({...this._def,catchall:t})}pick(t){const n={};for(const r of Qr.objectKeys(t))t[r]&&this.shape[r]&&(n[r]=this.shape[r]);return new Ei({...this._def,shape:()=>n})}omit(t){const n={};for(const r of Qr.objectKeys(this.shape))t[r]||(n[r]=this.shape[r]);return new Ei({...this._def,shape:()=>n})}deepPartial(){return l0(this)}partial(t){const n={};for(const r of Qr.objectKeys(this.shape)){const s=this.shape[r];t&&!t[r]?n[r]=s:n[r]=s.optional()}return new Ei({...this._def,shape:()=>n})}required(t){const n={};for(const r of Qr.objectKeys(this.shape))if(t&&!t[r])n[r]=this.shape[r];else{let i=this.shape[r];for(;i instanceof _u;)i=i._def.innerType;n[r]=i}return new Ei({...this._def,shape:()=>n})}keyof(){return uG(Qr.objectKeys(this.shape))}}Ei.create=(e,t)=>new Ei({shape:()=>e,unknownKeys:"strip",catchall:gh.create(),typeName:Qt.ZodObject,...Ar(t)});Ei.strictCreate=(e,t)=>new Ei({shape:()=>e,unknownKeys:"strict",catchall:gh.create(),typeName:Qt.ZodObject,...Ar(t)});Ei.lazycreate=(e,t)=>new Ei({shape:e,unknownKeys:"strip",catchall:gh.create(),typeName:Qt.ZodObject,...Ar(t)});class hC extends Ur{_parse(t){const{ctx:n}=this._processInputParams(t),r=this._def.options;function s(i){for(const o of i)if(o.result.status==="valid")return o.result;for(const o of i)if(o.result.status==="dirty")return n.common.issues.push(...o.ctx.common.issues),o.result;const a=i.map(o=>new Mc(o.ctx.common.issues));return fn(n,{code:Zt.invalid_union,unionErrors:a}),cr}if(n.common.async)return Promise.all(r.map(async i=>{const a={...n,common:{...n.common,issues:[]},parent:null};return{result:await i._parseAsync({data:n.data,path:n.path,parent:a}),ctx:a}})).then(s);{let i;const a=[];for(const l of r){const c={...n,common:{...n.common,issues:[]},parent:null},u=l._parseSync({data:n.data,path:n.path,parent:c});if(u.status==="valid")return u;u.status==="dirty"&&!i&&(i={result:u,ctx:c}),c.common.issues.length&&a.push(c.common.issues)}if(i)return n.common.issues.push(...i.ctx.common.issues),i.result;const o=a.map(l=>new Mc(l));return fn(n,{code:Zt.invalid_union,unionErrors:o}),cr}}get options(){return this._def.options}}hC.create=(e,t)=>new hC({options:e,typeName:Qt.ZodUnion,...Ar(t)});const vd=e=>e instanceof gC?vd(e.schema):e instanceof _m?vd(e.innerType()):e instanceof yC?[e.value]:e instanceof wm?e.options:e instanceof aj?Qr.objectValues(e.enum):e instanceof vC?vd(e._def.innerType):e instanceof rj?[void 0]:e instanceof fC?[null]:e instanceof _u?[void 0,...vd(e.unwrap())]:e instanceof Sm?[null,...vd(e.unwrap())]:e instanceof dG||e instanceof wC?vd(e.unwrap()):e instanceof xC?vd(e._def.innerType):[];class WP extends Ur{_parse(t){const{ctx:n}=this._processInputParams(t);if(n.parsedType!==gn.object)return fn(n,{code:Zt.invalid_type,expected:gn.object,received:n.parsedType}),cr;const r=this.discriminator,s=n.data[r],i=this.optionsMap.get(s);return i?n.common.async?i._parseAsync({data:n.data,path:n.path,parent:n}):i._parseSync({data:n.data,path:n.path,parent:n}):(fn(n,{code:Zt.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),cr)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(t,n,r){const s=new Map;for(const i of n){const a=vd(i.shape[t]);if(!a.length)throw new Error(`A discriminator value for key \`${t}\` could not be extracted from all schema options`);for(const o of a){if(s.has(o))throw new Error(`Discriminator property ${String(t)} has duplicate value ${String(o)}`);s.set(o,i)}}return new WP({typeName:Qt.ZodDiscriminatedUnion,discriminator:t,options:n,optionsMap:s,...Ar(r)})}}function ij(e,t){const n=nh(e),r=nh(t);if(e===t)return{valid:!0,data:e};if(n===gn.object&&r===gn.object){const s=Qr.objectKeys(t),i=Qr.objectKeys(e).filter(o=>s.indexOf(o)!==-1),a={...e,...t};for(const o of i){const l=ij(e[o],t[o]);if(!l.valid)return{valid:!1};a[o]=l.data}return{valid:!0,data:a}}else if(n===gn.array&&r===gn.array){if(e.length!==t.length)return{valid:!1};const s=[];for(let i=0;i<e.length;i++){const a=e[i],o=t[i],l=ij(a,o);if(!l.valid)return{valid:!1};s.push(l.data)}return{valid:!0,data:s}}else return n===gn.date&&r===gn.date&&+e==+t?{valid:!0,data:e}:{valid:!1}}class pC extends Ur{_parse(t){const{status:n,ctx:r}=this._processInputParams(t),s=(i,a)=>{if(BB(i)||BB(a))return cr;const o=ij(i.value,a.value);return o.valid?(($B(i)||$B(a))&&n.dirty(),{status:n.value,value:o.data}):(fn(r,{code:Zt.invalid_intersection_types}),cr)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([i,a])=>s(i,a)):s(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}pC.create=(e,t,n)=>new pC({left:e,right:t,typeName:Qt.ZodIntersection,...Ar(n)});class xm extends Ur{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==gn.array)return fn(r,{code:Zt.invalid_type,expected:gn.array,received:r.parsedType}),cr;if(r.data.length<this._def.items.length)return fn(r,{code:Zt.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),cr;!this._def.rest&&r.data.length>this._def.items.length&&(fn(r,{code:Zt.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),n.dirty());const i=[...r.data].map((a,o)=>{const l=this._def.items[o]||this._def.rest;return l?l._parse(new Mu(r,a,r.path,o)):null}).filter(a=>!!a);return r.common.async?Promise.all(i).then(a=>io.mergeArray(n,a)):io.mergeArray(n,i)}get items(){return this._def.items}rest(t){return new xm({...this._def,rest:t})}}xm.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new xm({items:e,typeName:Qt.ZodTuple,rest:null,...Ar(t)})};class mC extends Ur{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==gn.object)return fn(r,{code:Zt.invalid_type,expected:gn.object,received:r.parsedType}),cr;const s=[],i=this._def.keyType,a=this._def.valueType;for(const o in r.data)s.push({key:i._parse(new Mu(r,o,r.path,o)),value:a._parse(new Mu(r,r.data[o],r.path,o)),alwaysSet:o in r.data});return r.common.async?io.mergeObjectAsync(n,s):io.mergeObjectSync(n,s)}get element(){return this._def.valueType}static create(t,n,r){return n instanceof Ur?new mC({keyType:t,valueType:n,typeName:Qt.ZodRecord,...Ar(r)}):new mC({keyType:Td.create(),valueType:t,typeName:Qt.ZodRecord,...Ar(n)})}}class VB extends Ur{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==gn.map)return fn(r,{code:Zt.invalid_type,expected:gn.map,received:r.parsedType}),cr;const s=this._def.keyType,i=this._def.valueType,a=[...r.data.entries()].map(([o,l],c)=>({key:s._parse(new Mu(r,o,r.path,[c,"key"])),value:i._parse(new Mu(r,l,r.path,[c,"value"]))}));if(r.common.async){const o=new Map;return Promise.resolve().then(async()=>{for(const l of a){const c=await l.key,u=await l.value;if(c.status==="aborted"||u.status==="aborted")return cr;(c.status==="dirty"||u.status==="dirty")&&n.dirty(),o.set(c.value,u.value)}return{status:n.value,value:o}})}else{const o=new Map;for(const l of a){const c=l.key,u=l.value;if(c.status==="aborted"||u.status==="aborted")return cr;(c.status==="dirty"||u.status==="dirty")&&n.dirty(),o.set(c.value,u.value)}return{status:n.value,value:o}}}}VB.create=(e,t,n)=>new VB({valueType:t,keyType:e,typeName:Qt.ZodMap,...Ar(n)});class Gx extends Ur{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==gn.set)return fn(r,{code:Zt.invalid_type,expected:gn.set,received:r.parsedType}),cr;const s=this._def;s.minSize!==null&&r.data.size<s.minSize.value&&(fn(r,{code:Zt.too_small,minimum:s.minSize.value,type:"set",inclusive:!0,exact:!1,message:s.minSize.message}),n.dirty()),s.maxSize!==null&&r.data.size>s.maxSize.value&&(fn(r,{code:Zt.too_big,maximum:s.maxSize.value,type:"set",inclusive:!0,exact:!1,message:s.maxSize.message}),n.dirty());const i=this._def.valueType;function a(l){const c=new Set;for(const u of l){if(u.status==="aborted")return cr;u.status==="dirty"&&n.dirty(),c.add(u.value)}return{status:n.value,value:c}}const o=[...r.data.values()].map((l,c)=>i._parse(new Mu(r,l,r.path,c)));return r.common.async?Promise.all(o).then(l=>a(l)):a(o)}min(t,n){return new Gx({...this._def,minSize:{value:t,message:En.toString(n)}})}max(t,n){return new Gx({...this._def,maxSize:{value:t,message:En.toString(n)}})}size(t,n){return this.min(t,n).max(t,n)}nonempty(t){return this.min(1,t)}}Gx.create=(e,t)=>new Gx({valueType:e,minSize:null,maxSize:null,typeName:Qt.ZodSet,...Ar(t)});class gC extends Ur{get schema(){return this._def.getter()}_parse(t){const{ctx:n}=this._processInputParams(t);return this._def.getter()._parse({data:n.data,path:n.path,parent:n})}}gC.create=(e,t)=>new gC({getter:e,typeName:Qt.ZodLazy,...Ar(t)});class yC extends Ur{_parse(t){if(t.data!==this._def.value){const n=this._getOrReturnCtx(t);return fn(n,{received:n.data,code:Zt.invalid_literal,expected:this._def.value}),cr}return{status:"valid",value:t.data}}get value(){return this._def.value}}yC.create=(e,t)=>new yC({value:e,typeName:Qt.ZodLiteral,...Ar(t)});function uG(e,t){return new wm({values:e,typeName:Qt.ZodEnum,...Ar(t)})}class wm extends Ur{_parse(t){if(typeof t.data!="string"){const n=this._getOrReturnCtx(t),r=this._def.values;return fn(n,{expected:Qr.joinValues(r),received:n.parsedType,code:Zt.invalid_type}),cr}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(t.data)){const n=this._getOrReturnCtx(t),r=this._def.values;return fn(n,{received:n.data,code:Zt.invalid_enum_value,options:r}),cr}return Ql(t.data)}get options(){return this._def.values}get enum(){const t={};for(const n of this._def.values)t[n]=n;return t}get Values(){const t={};for(const n of this._def.values)t[n]=n;return t}get Enum(){const t={};for(const n of this._def.values)t[n]=n;return t}extract(t,n=this._def){return wm.create(t,{...this._def,...n})}exclude(t,n=this._def){return wm.create(this.options.filter(r=>!t.includes(r)),{...this._def,...n})}}wm.create=uG;class aj extends Ur{_parse(t){const n=Qr.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(t);if(r.parsedType!==gn.string&&r.parsedType!==gn.number){const s=Qr.objectValues(n);return fn(r,{expected:Qr.joinValues(s),received:r.parsedType,code:Zt.invalid_type}),cr}if(this._cache||(this._cache=new Set(Qr.getValidEnumValues(this._def.values))),!this._cache.has(t.data)){const s=Qr.objectValues(n);return fn(r,{received:r.data,code:Zt.invalid_enum_value,options:s}),cr}return Ql(t.data)}get enum(){return this._def.values}}aj.create=(e,t)=>new aj({values:e,typeName:Qt.ZodNativeEnum,...Ar(t)});class bC extends Ur{unwrap(){return this._def.type}_parse(t){const{ctx:n}=this._processInputParams(t);if(n.parsedType!==gn.promise&&n.common.async===!1)return fn(n,{code:Zt.invalid_type,expected:gn.promise,received:n.parsedType}),cr;const r=n.parsedType===gn.promise?n.data:Promise.resolve(n.data);return Ql(r.then(s=>this._def.type.parseAsync(s,{path:n.path,errorMap:n.common.contextualErrorMap})))}}bC.create=(e,t)=>new bC({type:e,typeName:Qt.ZodPromise,...Ar(t)});class _m extends Ur{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Qt.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(t){const{status:n,ctx:r}=this._processInputParams(t),s=this._def.effect||null,i={addIssue:a=>{fn(r,a),a.fatal?n.abort():n.dirty()},get path(){return r.path}};if(i.addIssue=i.addIssue.bind(i),s.type==="preprocess"){const a=s.transform(r.data,i);if(r.common.async)return Promise.resolve(a).then(async o=>{if(n.value==="aborted")return cr;const l=await this._def.schema._parseAsync({data:o,path:r.path,parent:r});return l.status==="aborted"?cr:l.status==="dirty"||n.value==="dirty"?Zv(l.value):l});{if(n.value==="aborted")return cr;const o=this._def.schema._parseSync({data:a,path:r.path,parent:r});return o.status==="aborted"?cr:o.status==="dirty"||n.value==="dirty"?Zv(o.value):o}}if(s.type==="refinement"){const a=o=>{const l=s.refinement(o,i);if(r.common.async)return Promise.resolve(l);if(l instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return o};if(r.common.async===!1){const o=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return o.status==="aborted"?cr:(o.status==="dirty"&&n.dirty(),a(o.value),{status:n.value,value:o.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(o=>o.status==="aborted"?cr:(o.status==="dirty"&&n.dirty(),a(o.value).then(()=>({status:n.value,value:o.value}))))}if(s.type==="transform")if(r.common.async===!1){const a=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!Z0(a))return cr;const o=s.transform(a.value,i);if(o instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:n.value,value:o}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(a=>Z0(a)?Promise.resolve(s.transform(a.value,i)).then(o=>({status:n.value,value:o})):cr);Qr.assertNever(s)}}_m.create=(e,t,n)=>new _m({schema:e,typeName:Qt.ZodEffects,effect:t,...Ar(n)});_m.createWithPreprocess=(e,t,n)=>new _m({schema:t,effect:{type:"preprocess",transform:e},typeName:Qt.ZodEffects,...Ar(n)});class _u extends Ur{_parse(t){return this._getType(t)===gn.undefined?Ql(void 0):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}_u.create=(e,t)=>new _u({innerType:e,typeName:Qt.ZodOptional,...Ar(t)});class Sm extends Ur{_parse(t){return this._getType(t)===gn.null?Ql(null):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}Sm.create=(e,t)=>new Sm({innerType:e,typeName:Qt.ZodNullable,...Ar(t)});class vC extends Ur{_parse(t){const{ctx:n}=this._processInputParams(t);let r=n.data;return n.parsedType===gn.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:n.path,parent:n})}removeDefault(){return this._def.innerType}}vC.create=(e,t)=>new vC({innerType:e,typeName:Qt.ZodDefault,defaultValue:typeof t.default=="function"?t.default:()=>t.default,...Ar(t)});class xC extends Ur{_parse(t){const{ctx:n}=this._processInputParams(t),r={...n,common:{...n.common,issues:[]}},s=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return uC(s)?s.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new Mc(r.common.issues)},input:r.data})})):{status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new Mc(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}xC.create=(e,t)=>new xC({innerType:e,typeName:Qt.ZodCatch,catchValue:typeof t.catch=="function"?t.catch:()=>t.catch,...Ar(t)});class WB extends Ur{_parse(t){if(this._getType(t)!==gn.nan){const r=this._getOrReturnCtx(t);return fn(r,{code:Zt.invalid_type,expected:gn.nan,received:r.parsedType}),cr}return{status:"valid",value:t.data}}}WB.create=e=>new WB({typeName:Qt.ZodNaN,...Ar(e)});class dG extends Ur{_parse(t){const{ctx:n}=this._processInputParams(t),r=n.data;return this._def.type._parse({data:r,path:n.path,parent:n})}unwrap(){return this._def.type}}class HP extends Ur{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.common.async)return(async()=>{const i=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return i.status==="aborted"?cr:i.status==="dirty"?(n.dirty(),Zv(i.value)):this._def.out._parseAsync({data:i.value,path:r.path,parent:r})})();{const s=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return s.status==="aborted"?cr:s.status==="dirty"?(n.dirty(),{status:"dirty",value:s.value}):this._def.out._parseSync({data:s.value,path:r.path,parent:r})}}static create(t,n){return new HP({in:t,out:n,typeName:Qt.ZodPipeline})}}class wC extends Ur{_parse(t){const n=this._def.innerType._parse(t),r=s=>(Z0(s)&&(s.value=Object.freeze(s.value)),s);return uC(n)?n.then(s=>r(s)):r(n)}unwrap(){return this._def.innerType}}wC.create=(e,t)=>new wC({innerType:e,typeName:Qt.ZodReadonly,...Ar(t)});function HB(e,t){const n=typeof e=="function"?e(t):typeof e=="string"?{message:e}:e;return typeof n=="string"?{message:n}:n}function fG(e,t={},n){return e?Hx.create().superRefine((r,s)=>{const i=e(r);if(i instanceof Promise)return i.then(a=>{if(!a){const o=HB(t,r),l=o.fatal??n??!0;s.addIssue({code:"custom",...o,fatal:l})}});if(!i){const a=HB(t,r),o=a.fatal??n??!0;s.addIssue({code:"custom",...a,fatal:o})}}):Hx.create()}var Qt;(function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"})(Qt||(Qt={}));const _C=(e,t={message:`Input not instance of ${e.name}`})=>fG(n=>n instanceof e,t),$e=Td.create,Tt=X0.create,br=nj.create,ebe=fC.create,yh=Hx.create,Fy=sj.create;gh.create;const on=wu.create,Ke=Ei.create,ps=hC.create,_E=WP.create;pC.create;xm.create;const bh=mC.create,tbe=gC.create,An=yC.create,bl=wm.create;bC.create;const na=_u.create;Sm.create;function nbe({prompt:e,useLegacyFunctionCalling:t=!1,systemMessageMode:n="system"}){const r=[],s=[];for(const{role:i,content:a}of e)switch(i){case"system":{switch(n){case"system":{r.push({role:"system",content:a});break}case"developer":{r.push({role:"developer",content:a});break}case"remove":{s.push({type:"other",message:"system messages are removed for this model"});break}default:{const o=n;throw new Error(`Unsupported system message mode: ${o}`)}}break}case"user":{if(a.length===1&&a[0].type==="text"){r.push({role:"user",content:a[0].text});break}r.push({role:"user",content:a.map((o,l)=>{var c,u,d,h;switch(o.type){case"text":return{type:"text",text:o.text};case"image":return{type:"image_url",image_url:{url:o.image instanceof URL?o.image.toString():`data:${(c=o.mimeType)!=null?c:"image/jpeg"};base64,${Nu(o.image)}`,detail:(d=(u=o.providerMetadata)==null?void 0:u.openai)==null?void 0:d.imageDetail}};case"file":{if(o.data instanceof URL)throw new hr({functionality:"'File content parts with URL data' functionality not supported."});switch(o.mimeType){case"audio/wav":return{type:"input_audio",input_audio:{data:o.data,format:"wav"}};case"audio/mp3":case"audio/mpeg":return{type:"input_audio",input_audio:{data:o.data,format:"mp3"}};case"application/pdf":return{type:"file",file:{filename:(h=o.filename)!=null?h:`part-${l}.pdf`,file_data:`data:application/pdf;base64,${o.data}`}};default:throw new hr({functionality:`File content part type ${o.mimeType} in user messages`})}}}})});break}case"assistant":{let o="";const l=[];for(const c of a)switch(c.type){case"text":{o+=c.text;break}case"tool-call":{l.push({id:c.toolCallId,type:"function",function:{name:c.toolName,arguments:JSON.stringify(c.args)}});break}}if(t){if(l.length>1)throw new hr({functionality:"useLegacyFunctionCalling with multiple tool calls in one message"});r.push({role:"assistant",content:o,function_call:l.length>0?l[0].function:void 0})}else r.push({role:"assistant",content:o,tool_calls:l.length>0?l:void 0});break}case"tool":{for(const o of a)t?r.push({role:"function",name:o.toolName,content:JSON.stringify(o.result)}):r.push({role:"tool",tool_call_id:o.toolCallId,content:JSON.stringify(o.result)});break}default:{const o=i;throw new Error(`Unsupported role: ${o}`)}}return{messages:r,warnings:s}}function GB(e){var t,n;return(n=(t=e==null?void 0:e.content)==null?void 0:t.map(({token:r,logprob:s,top_logprobs:i})=>({token:r,logprob:s,topLogprobs:i?i.map(({token:a,logprob:o})=>({token:a,logprob:o})):[]})))!=null?n:void 0}function SC(e){switch(e){case"stop":return"stop";case"length":return"length";case"content_filter":return"content-filter";case"function_call":case"tool_calls":return"tool-calls";default:return"unknown"}}var GP=Ke({error:Ke({message:$e(),type:$e().nullish(),param:yh().nullish(),code:ps([$e(),Tt()]).nullish()})}),Iu=Bh({errorSchema:GP,errorToMessage:e=>e.error.message});function CC({id:e,model:t,created:n}){return{id:e??void 0,modelId:t??void 0,timestamp:n!=null?new Date(n*1e3):void 0}}function rbe({mode:e,useLegacyFunctionCalling:t=!1,structuredOutputs:n}){var r;const s=(r=e.tools)!=null&&r.length?e.tools:void 0,i=[];if(s==null)return{tools:void 0,tool_choice:void 0,toolWarnings:i};const a=e.toolChoice;if(t){const c=[];for(const d of s)d.type==="provider-defined"?i.push({type:"unsupported-tool",tool:d}):c.push({name:d.name,description:d.description,parameters:d.parameters});if(a==null)return{functions:c,function_call:void 0,toolWarnings:i};switch(a.type){case"auto":case"none":case void 0:return{functions:c,function_call:void 0,toolWarnings:i};case"required":throw new hr({functionality:"useLegacyFunctionCalling and toolChoice: required"});default:return{functions:c,function_call:{name:a.toolName},toolWarnings:i}}}const o=[];for(const c of s)c.type==="provider-defined"?i.push({type:"unsupported-tool",tool:c}):o.push({type:"function",function:{name:c.name,description:c.description,parameters:c.parameters,strict:n?!0:void 0}});if(a==null)return{tools:o,tool_choice:void 0,toolWarnings:i};const l=a.type;switch(l){case"auto":case"none":case"required":return{tools:o,tool_choice:l,toolWarnings:i};case"tool":return{tools:o,tool_choice:{type:"function",function:{name:a.toolName}},toolWarnings:i};default:{const c=l;throw new hr({functionality:`Unsupported tool choice type: ${c}`})}}}var sbe=class{constructor(e,t,n){this.specificationVersion="v1",this.modelId=e,this.settings=t,this.config=n}get supportsStructuredOutputs(){var e;return(e=this.settings.structuredOutputs)!=null?e:oj(this.modelId)}get defaultObjectGenerationMode(){return obe(this.modelId)?"tool":this.supportsStructuredOutputs?"json":"tool"}get provider(){return this.config.provider}get supportsImageUrls(){return!this.settings.downloadImages}getArgs({mode:e,prompt:t,maxTokens:n,temperature:r,topP:s,topK:i,frequencyPenalty:a,presencePenalty:o,stopSequences:l,responseFormat:c,seed:u,providerMetadata:d}){var h,m,y,b,v,x,w,S;const C=e.type,k=[];i!=null&&k.push({type:"unsupported-setting",setting:"topK"}),(c==null?void 0:c.type)==="json"&&c.schema!=null&&!this.supportsStructuredOutputs&&k.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format schema is only supported with structuredOutputs"});const A=this.settings.useLegacyFunctionCalling;if(A&&this.settings.parallelToolCalls===!0)throw new hr({functionality:"useLegacyFunctionCalling with parallelToolCalls"});if(A&&this.supportsStructuredOutputs)throw new hr({functionality:"structuredOutputs with useLegacyFunctionCalling"});const{messages:R,warnings:N}=nbe({prompt:t,useLegacyFunctionCalling:A,systemMessageMode:lbe(this.modelId)});k.push(...N);const I={model:this.modelId,logit_bias:this.settings.logitBias,logprobs:this.settings.logprobs===!0||typeof this.settings.logprobs=="number"?!0:void 0,top_logprobs:typeof this.settings.logprobs=="number"?this.settings.logprobs:typeof this.settings.logprobs=="boolean"&&this.settings.logprobs?0:void 0,user:this.settings.user,parallel_tool_calls:this.settings.parallelToolCalls,max_tokens:n,temperature:r,top_p:s,frequency_penalty:a,presence_penalty:o,response_format:(c==null?void 0:c.type)==="json"?this.supportsStructuredOutputs&&c.schema!=null?{type:"json_schema",json_schema:{schema:c.schema,strict:!0,name:(h=c.name)!=null?h:"response",description:c.description}}:{type:"json_object"}:void 0,stop:l,seed:u,max_completion_tokens:(m=d==null?void 0:d.openai)==null?void 0:m.maxCompletionTokens,store:(y=d==null?void 0:d.openai)==null?void 0:y.store,metadata:(b=d==null?void 0:d.openai)==null?void 0:b.metadata,prediction:(v=d==null?void 0:d.openai)==null?void 0:v.prediction,reasoning_effort:(w=(x=d==null?void 0:d.openai)==null?void 0:x.reasoningEffort)!=null?w:this.settings.reasoningEffort,messages:R};switch(oj(this.modelId)?(I.temperature!=null&&(I.temperature=void 0,k.push({type:"unsupported-setting",setting:"temperature",details:"temperature is not supported for reasoning models"})),I.top_p!=null&&(I.top_p=void 0,k.push({type:"unsupported-setting",setting:"topP",details:"topP is not supported for reasoning models"})),I.frequency_penalty!=null&&(I.frequency_penalty=void 0,k.push({type:"unsupported-setting",setting:"frequencyPenalty",details:"frequencyPenalty is not supported for reasoning models"})),I.presence_penalty!=null&&(I.presence_penalty=void 0,k.push({type:"unsupported-setting",setting:"presencePenalty",details:"presencePenalty is not supported for reasoning models"})),I.logit_bias!=null&&(I.logit_bias=void 0,k.push({type:"other",message:"logitBias is not supported for reasoning models"})),I.logprobs!=null&&(I.logprobs=void 0,k.push({type:"other",message:"logprobs is not supported for reasoning models"})),I.top_logprobs!=null&&(I.top_logprobs=void 0,k.push({type:"other",message:"topLogprobs is not supported for reasoning models"})),I.max_tokens!=null&&(I.max_completion_tokens==null&&(I.max_completion_tokens=I.max_tokens),I.max_tokens=void 0)):(this.modelId.startsWith("gpt-4o-search-preview")||this.modelId.startsWith("gpt-4o-mini-search-preview"))&&I.temperature!=null&&(I.temperature=void 0,k.push({type:"unsupported-setting",setting:"temperature",details:"temperature is not supported for the search preview models and has been removed."})),C){case"regular":{const{tools:P,tool_choice:L,functions:O,function_call:V,toolWarnings:D}=rbe({mode:e,useLegacyFunctionCalling:A,structuredOutputs:this.supportsStructuredOutputs});return{args:{...I,tools:P,tool_choice:L,functions:O,function_call:V},warnings:[...k,...D]}}case"object-json":return{args:{...I,response_format:this.supportsStructuredOutputs&&e.schema!=null?{type:"json_schema",json_schema:{schema:e.schema,strict:!0,name:(S=e.name)!=null?S:"response",description:e.description}}:{type:"json_object"}},warnings:k};case"object-tool":return{args:A?{...I,function_call:{name:e.tool.name},functions:[{name:e.tool.name,description:e.tool.description,parameters:e.tool.parameters}]}:{...I,tool_choice:{type:"function",function:{name:e.tool.name}},tools:[{type:"function",function:{name:e.tool.name,description:e.tool.description,parameters:e.tool.parameters,strict:this.supportsStructuredOutputs?!0:void 0}}]},warnings:k};default:{const P=C;throw new Error(`Unsupported type: ${P}`)}}}async doGenerate(e){var t,n,r,s,i,a,o,l;const{args:c,warnings:u}=this.getArgs(e),{responseHeaders:d,value:h,rawValue:m}=await Vs({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:qs(this.config.headers(),e.headers),body:c,failedResponseHandler:Iu,successfulResponseHandler:$a(ibe),abortSignal:e.abortSignal,fetch:this.config.fetch}),{messages:y,...b}=c,v=h.choices[0],x=(t=h.usage)==null?void 0:t.completion_tokens_details,w=(n=h.usage)==null?void 0:n.prompt_tokens_details,S={openai:{}};return(x==null?void 0:x.reasoning_tokens)!=null&&(S.openai.reasoningTokens=x==null?void 0:x.reasoning_tokens),(x==null?void 0:x.accepted_prediction_tokens)!=null&&(S.openai.acceptedPredictionTokens=x==null?void 0:x.accepted_prediction_tokens),(x==null?void 0:x.rejected_prediction_tokens)!=null&&(S.openai.rejectedPredictionTokens=x==null?void 0:x.rejected_prediction_tokens),(w==null?void 0:w.cached_tokens)!=null&&(S.openai.cachedPromptTokens=w==null?void 0:w.cached_tokens),{text:(r=v.message.content)!=null?r:void 0,toolCalls:this.settings.useLegacyFunctionCalling&&v.message.function_call?[{toolCallType:"function",toolCallId:sa(),toolName:v.message.function_call.name,args:v.message.function_call.arguments}]:(s=v.message.tool_calls)==null?void 0:s.map(C=>{var k;return{toolCallType:"function",toolCallId:(k=C.id)!=null?k:sa(),toolName:C.function.name,args:C.function.arguments}}),finishReason:SC(v.finish_reason),usage:{promptTokens:(a=(i=h.usage)==null?void 0:i.prompt_tokens)!=null?a:NaN,completionTokens:(l=(o=h.usage)==null?void 0:o.completion_tokens)!=null?l:NaN},rawCall:{rawPrompt:y,rawSettings:b},rawResponse:{headers:d,body:m},request:{body:JSON.stringify(c)},response:CC(h),warnings:u,logprobs:GB(v.logprobs),providerMetadata:S}}async doStream(e){if(this.settings.simulateStreaming){const b=await this.doGenerate(e);return{stream:new ReadableStream({start(x){if(x.enqueue({type:"response-metadata",...b.response}),b.text&&x.enqueue({type:"text-delta",textDelta:b.text}),b.toolCalls)for(const w of b.toolCalls)x.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:w.toolCallId,toolName:w.toolName,argsTextDelta:w.args}),x.enqueue({type:"tool-call",...w});x.enqueue({type:"finish",finishReason:b.finishReason,usage:b.usage,logprobs:b.logprobs,providerMetadata:b.providerMetadata}),x.close()}}),rawCall:b.rawCall,rawResponse:b.rawResponse,warnings:b.warnings}}const{args:t,warnings:n}=this.getArgs(e),r={...t,stream:!0,stream_options:this.config.compatibility==="strict"?{include_usage:!0}:void 0},{responseHeaders:s,value:i}=await Vs({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:qs(this.config.headers(),e.headers),body:r,failedResponseHandler:Iu,successfulResponseHandler:$h(abe),abortSignal:e.abortSignal,fetch:this.config.fetch}),{messages:a,...o}=t,l=[];let c="unknown",u={promptTokens:void 0,completionTokens:void 0},d,h=!0;const{useLegacyFunctionCalling:m}=this.settings,y={openai:{}};return{stream:i.pipeThrough(new TransformStream({transform(b,v){var x,w,S,C,k,A,R,N,I,P,L,O;if(!b.success){c="error",v.enqueue({type:"error",error:b.error});return}const V=b.value;if("error"in V){c="error",v.enqueue({type:"error",error:V.error});return}if(h&&(h=!1,v.enqueue({type:"response-metadata",...CC(V)})),V.usage!=null){const{prompt_tokens:$,completion_tokens:ne,prompt_tokens_details:W,completion_tokens_details:Q}=V.usage;u={promptTokens:$??void 0,completionTokens:ne??void 0},(Q==null?void 0:Q.reasoning_tokens)!=null&&(y.openai.reasoningTokens=Q==null?void 0:Q.reasoning_tokens),(Q==null?void 0:Q.accepted_prediction_tokens)!=null&&(y.openai.acceptedPredictionTokens=Q==null?void 0:Q.accepted_prediction_tokens),(Q==null?void 0:Q.rejected_prediction_tokens)!=null&&(y.openai.rejectedPredictionTokens=Q==null?void 0:Q.rejected_prediction_tokens),(W==null?void 0:W.cached_tokens)!=null&&(y.openai.cachedPromptTokens=W==null?void 0:W.cached_tokens)}const D=V.choices[0];if((D==null?void 0:D.finish_reason)!=null&&(c=SC(D.finish_reason)),(D==null?void 0:D.delta)==null)return;const Z=D.delta;Z.content!=null&&v.enqueue({type:"text-delta",textDelta:Z.content});const U=GB(D==null?void 0:D.logprobs);U!=null&&U.length&&(d===void 0&&(d=[]),d.push(...U));const H=m&&Z.function_call!=null?[{type:"function",id:sa(),function:Z.function_call,index:0}]:Z.tool_calls;if(H!=null)for(const $ of H){const ne=$.index;if(l[ne]==null){if($.type!=="function")throw new Id({data:$,message:"Expected 'function' type."});if($.id==null)throw new Id({data:$,message:"Expected 'id' to be a string."});if(((x=$.function)==null?void 0:x.name)==null)throw new Id({data:$,message:"Expected 'function.name' to be a string."});l[ne]={id:$.id,type:"function",function:{name:$.function.name,arguments:(w=$.function.arguments)!=null?w:""},hasFinished:!1};const Q=l[ne];((S=Q.function)==null?void 0:S.name)!=null&&((C=Q.function)==null?void 0:C.arguments)!=null&&(Q.function.arguments.length>0&&v.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:Q.id,toolName:Q.function.name,argsTextDelta:Q.function.arguments}),lm(Q.function.arguments)&&(v.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(k=Q.id)!=null?k:sa(),toolName:Q.function.name,args:Q.function.arguments}),Q.hasFinished=!0));continue}const W=l[ne];W.hasFinished||(((A=$.function)==null?void 0:A.arguments)!=null&&(W.function.arguments+=(N=(R=$.function)==null?void 0:R.arguments)!=null?N:""),v.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:W.id,toolName:W.function.name,argsTextDelta:(I=$.function.arguments)!=null?I:""}),((P=W.function)==null?void 0:P.name)!=null&&((L=W.function)==null?void 0:L.arguments)!=null&&lm(W.function.arguments)&&(v.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(O=W.id)!=null?O:sa(),toolName:W.function.name,args:W.function.arguments}),W.hasFinished=!0))}},flush(b){var v,x;b.enqueue({type:"finish",finishReason:c,logprobs:d,usage:{promptTokens:(v=u.promptTokens)!=null?v:NaN,completionTokens:(x=u.completionTokens)!=null?x:NaN},...y!=null?{providerMetadata:y}:{}})}})),rawCall:{rawPrompt:a,rawSettings:o},rawResponse:{headers:s},request:{body:JSON.stringify(r)},warnings:n}}},hG=Ke({prompt_tokens:Tt().nullish(),completion_tokens:Tt().nullish(),prompt_tokens_details:Ke({cached_tokens:Tt().nullish()}).nullish(),completion_tokens_details:Ke({reasoning_tokens:Tt().nullish(),accepted_prediction_tokens:Tt().nullish(),rejected_prediction_tokens:Tt().nullish()}).nullish()}).nullish(),ibe=Ke({id:$e().nullish(),created:Tt().nullish(),model:$e().nullish(),choices:on(Ke({message:Ke({role:An("assistant").nullish(),content:$e().nullish(),function_call:Ke({arguments:$e(),name:$e()}).nullish(),tool_calls:on(Ke({id:$e().nullish(),type:An("function"),function:Ke({name:$e(),arguments:$e()})})).nullish()}),index:Tt(),logprobs:Ke({content:on(Ke({token:$e(),logprob:Tt(),top_logprobs:on(Ke({token:$e(),logprob:Tt()}))})).nullable()}).nullish(),finish_reason:$e().nullish()})),usage:hG}),abe=ps([Ke({id:$e().nullish(),created:Tt().nullish(),model:$e().nullish(),choices:on(Ke({delta:Ke({role:bl(["assistant"]).nullish(),content:$e().nullish(),function_call:Ke({name:$e().optional(),arguments:$e().optional()}).nullish(),tool_calls:on(Ke({index:Tt(),id:$e().nullish(),type:An("function").nullish(),function:Ke({name:$e().nullish(),arguments:$e().nullish()})})).nullish()}).nullish(),logprobs:Ke({content:on(Ke({token:$e(),logprob:Tt(),top_logprobs:on(Ke({token:$e(),logprob:Tt()}))})).nullable()}).nullish(),finish_reason:$e().nullish(),index:Tt()})),usage:hG}),GP]);function oj(e){return e.startsWith("o")}function obe(e){return e.startsWith("gpt-4o-audio-preview")}function lbe(e){var t,n;return oj(e)?(n=(t=cbe[e])==null?void 0:t.systemMessageMode)!=null?n:"developer":"system"}var cbe={"o1-mini":{systemMessageMode:"remove"},"o1-mini-2024-09-12":{systemMessageMode:"remove"},"o1-preview":{systemMessageMode:"remove"},"o1-preview-2024-09-12":{systemMessageMode:"remove"},o3:{systemMessageMode:"developer"},"o3-2025-04-16":{systemMessageMode:"developer"},"o3-mini":{systemMessageMode:"developer"},"o3-mini-2025-01-31":{systemMessageMode:"developer"},"o4-mini":{systemMessageMode:"developer"},"o4-mini-2025-04-16":{systemMessageMode:"developer"}};function ube({prompt:e,inputFormat:t,user:n="user",assistant:r="assistant"}){if(t==="prompt"&&e.length===1&&e[0].role==="user"&&e[0].content.length===1&&e[0].content[0].type==="text")return{prompt:e[0].content[0].text};let s="";e[0].role==="system"&&(s+=`${e[0].content}

`,e=e.slice(1));for(const{role:i,content:a}of e)switch(i){case"system":throw new yc({message:"Unexpected system message in prompt: ${content}",prompt:e});case"user":{const o=a.map(l=>{switch(l.type){case"text":return l.text;case"image":throw new hr({functionality:"images"})}}).join("");s+=`${n}:
${o}

`;break}case"assistant":{const o=a.map(l=>{switch(l.type){case"text":return l.text;case"tool-call":throw new hr({functionality:"tool-call messages"})}}).join("");s+=`${r}:
${o}

`;break}case"tool":throw new hr({functionality:"tool messages"});default:{const o=i;throw new Error(`Unsupported role: ${o}`)}}return s+=`${r}:
`,{prompt:s,stopSequences:[`
${n}:`]}}function KB(e){return e==null?void 0:e.tokens.map((t,n)=>({token:t,logprob:e.token_logprobs[n],topLogprobs:e.top_logprobs?Object.entries(e.top_logprobs[n]).map(([r,s])=>({token:r,logprob:s})):[]}))}var dbe=class{constructor(e,t,n){this.specificationVersion="v1",this.defaultObjectGenerationMode=void 0,this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}getArgs({mode:e,inputFormat:t,prompt:n,maxTokens:r,temperature:s,topP:i,topK:a,frequencyPenalty:o,presencePenalty:l,stopSequences:c,responseFormat:u,seed:d}){var h;const m=e.type,y=[];a!=null&&y.push({type:"unsupported-setting",setting:"topK"}),u!=null&&u.type!=="text"&&y.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format is not supported."});const{prompt:b,stopSequences:v}=ube({prompt:n,inputFormat:t}),x=[...v??[],...c??[]],w={model:this.modelId,echo:this.settings.echo,logit_bias:this.settings.logitBias,logprobs:typeof this.settings.logprobs=="number"?this.settings.logprobs:typeof this.settings.logprobs=="boolean"&&this.settings.logprobs?0:void 0,suffix:this.settings.suffix,user:this.settings.user,max_tokens:r,temperature:s,top_p:i,frequency_penalty:o,presence_penalty:l,seed:d,prompt:b,stop:x.length>0?x:void 0};switch(m){case"regular":{if((h=e.tools)!=null&&h.length)throw new hr({functionality:"tools"});if(e.toolChoice)throw new hr({functionality:"toolChoice"});return{args:w,warnings:y}}case"object-json":throw new hr({functionality:"object-json mode"});case"object-tool":throw new hr({functionality:"object-tool mode"});default:{const S=m;throw new Error(`Unsupported type: ${S}`)}}}async doGenerate(e){const{args:t,warnings:n}=this.getArgs(e),{responseHeaders:r,value:s,rawValue:i}=await Vs({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:qs(this.config.headers(),e.headers),body:t,failedResponseHandler:Iu,successfulResponseHandler:$a(fbe),abortSignal:e.abortSignal,fetch:this.config.fetch}),{prompt:a,...o}=t,l=s.choices[0];return{text:l.text,usage:{promptTokens:s.usage.prompt_tokens,completionTokens:s.usage.completion_tokens},finishReason:SC(l.finish_reason),logprobs:KB(l.logprobs),rawCall:{rawPrompt:a,rawSettings:o},rawResponse:{headers:r,body:i},response:CC(s),warnings:n,request:{body:JSON.stringify(t)}}}async doStream(e){const{args:t,warnings:n}=this.getArgs(e),r={...t,stream:!0,stream_options:this.config.compatibility==="strict"?{include_usage:!0}:void 0},{responseHeaders:s,value:i}=await Vs({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:qs(this.config.headers(),e.headers),body:r,failedResponseHandler:Iu,successfulResponseHandler:$h(hbe),abortSignal:e.abortSignal,fetch:this.config.fetch}),{prompt:a,...o}=t;let l="unknown",c={promptTokens:Number.NaN,completionTokens:Number.NaN},u,d=!0;return{stream:i.pipeThrough(new TransformStream({transform(h,m){if(!h.success){l="error",m.enqueue({type:"error",error:h.error});return}const y=h.value;if("error"in y){l="error",m.enqueue({type:"error",error:y.error});return}d&&(d=!1,m.enqueue({type:"response-metadata",...CC(y)})),y.usage!=null&&(c={promptTokens:y.usage.prompt_tokens,completionTokens:y.usage.completion_tokens});const b=y.choices[0];(b==null?void 0:b.finish_reason)!=null&&(l=SC(b.finish_reason)),(b==null?void 0:b.text)!=null&&m.enqueue({type:"text-delta",textDelta:b.text});const v=KB(b==null?void 0:b.logprobs);v!=null&&v.length&&(u===void 0&&(u=[]),u.push(...v))},flush(h){h.enqueue({type:"finish",finishReason:l,logprobs:u,usage:c})}})),rawCall:{rawPrompt:a,rawSettings:o},rawResponse:{headers:s},warnings:n,request:{body:JSON.stringify(r)}}}},fbe=Ke({id:$e().nullish(),created:Tt().nullish(),model:$e().nullish(),choices:on(Ke({text:$e(),finish_reason:$e(),logprobs:Ke({tokens:on($e()),token_logprobs:on(Tt()),top_logprobs:on(bh($e(),Tt())).nullable()}).nullish()})),usage:Ke({prompt_tokens:Tt(),completion_tokens:Tt()})}),hbe=ps([Ke({id:$e().nullish(),created:Tt().nullish(),model:$e().nullish(),choices:on(Ke({text:$e(),finish_reason:$e().nullish(),index:Tt(),logprobs:Ke({tokens:on($e()),token_logprobs:on(Tt()),top_logprobs:on(bh($e(),Tt())).nullable()}).nullish()})),usage:Ke({prompt_tokens:Tt(),completion_tokens:Tt()}).nullish()}),GP]),pbe=class{constructor(e,t,n){this.specificationVersion="v1",this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}get maxEmbeddingsPerCall(){var e;return(e=this.settings.maxEmbeddingsPerCall)!=null?e:2048}get supportsParallelCalls(){var e;return(e=this.settings.supportsParallelCalls)!=null?e:!0}async doEmbed({values:e,headers:t,abortSignal:n}){if(e.length>this.maxEmbeddingsPerCall)throw new bE({provider:this.provider,modelId:this.modelId,maxEmbeddingsPerCall:this.maxEmbeddingsPerCall,values:e});const{responseHeaders:r,value:s}=await Vs({url:this.config.url({path:"/embeddings",modelId:this.modelId}),headers:qs(this.config.headers(),t),body:{model:this.modelId,input:e,encoding_format:"float",dimensions:this.settings.dimensions,user:this.settings.user},failedResponseHandler:Iu,successfulResponseHandler:$a(mbe),abortSignal:n,fetch:this.config.fetch});return{embeddings:s.data.map(i=>i.embedding),usage:s.usage?{tokens:s.usage.prompt_tokens}:void 0,rawResponse:{headers:r}}}},mbe=Ke({data:on(Ke({embedding:on(Tt())})),usage:Ke({prompt_tokens:Tt()}).nullish()}),gbe={"dall-e-3":1,"dall-e-2":10,"gpt-image-1":10},ybe=new Set(["gpt-image-1"]),bbe=class{constructor(e,t,n){this.modelId=e,this.settings=t,this.config=n,this.specificationVersion="v1"}get maxImagesPerCall(){var e,t;return(t=(e=this.settings.maxImagesPerCall)!=null?e:gbe[this.modelId])!=null?t:1}get provider(){return this.config.provider}async doGenerate({prompt:e,n:t,size:n,aspectRatio:r,seed:s,providerOptions:i,headers:a,abortSignal:o}){var l,c,u,d;const h=[];r!=null&&h.push({type:"unsupported-setting",setting:"aspectRatio",details:"This model does not support aspect ratio. Use `size` instead."}),s!=null&&h.push({type:"unsupported-setting",setting:"seed"});const m=(u=(c=(l=this.config._internal)==null?void 0:l.currentDate)==null?void 0:c.call(l))!=null?u:new Date,{value:y,responseHeaders:b}=await Vs({url:this.config.url({path:"/images/generations",modelId:this.modelId}),headers:qs(this.config.headers(),a),body:{model:this.modelId,prompt:e,n:t,size:n,...(d=i.openai)!=null?d:{},...ybe.has(this.modelId)?{}:{response_format:"b64_json"}},failedResponseHandler:Iu,successfulResponseHandler:$a(vbe),abortSignal:o,fetch:this.config.fetch});return{images:y.data.map(v=>v.b64_json),warnings:h,response:{timestamp:m,modelId:this.modelId,headers:b}}}},vbe=Ke({data:on(Ke({b64_json:$e()}))}),xbe=Ke({include:on($e()).nullish(),language:$e().nullish(),prompt:$e().nullish(),temperature:Tt().min(0).max(1).nullish().default(0),timestampGranularities:on(bl(["word","segment"])).nullish().default(["segment"])}),YB={afrikaans:"af",arabic:"ar",armenian:"hy",azerbaijani:"az",belarusian:"be",bosnian:"bs",bulgarian:"bg",catalan:"ca",chinese:"zh",croatian:"hr",czech:"cs",danish:"da",dutch:"nl",english:"en",estonian:"et",finnish:"fi",french:"fr",galician:"gl",german:"de",greek:"el",hebrew:"he",hindi:"hi",hungarian:"hu",icelandic:"is",indonesian:"id",italian:"it",japanese:"ja",kannada:"kn",kazakh:"kk",korean:"ko",latvian:"lv",lithuanian:"lt",macedonian:"mk",malay:"ms",marathi:"mr",maori:"mi",nepali:"ne",norwegian:"no",persian:"fa",polish:"pl",portuguese:"pt",romanian:"ro",russian:"ru",serbian:"sr",slovak:"sk",slovenian:"sl",spanish:"es",swahili:"sw",swedish:"sv",tagalog:"tl",tamil:"ta",thai:"th",turkish:"tr",ukrainian:"uk",urdu:"ur",vietnamese:"vi",welsh:"cy"},wbe=class{constructor(e,t){this.modelId=e,this.config=t,this.specificationVersion="v1"}get provider(){return this.config.provider}getArgs({audio:e,mediaType:t,providerOptions:n}){var r,s,i,a,o;const l=[],c=xE({provider:"openai",providerOptions:n,schema:xbe}),u=new FormData,d=e instanceof Uint8Array?new Blob([e]):new Blob([wE(e)]);if(u.append("model",this.modelId),u.append("file",new File([d],"audio",{type:t})),c){const h={include:(r=c.include)!=null?r:void 0,language:(s=c.language)!=null?s:void 0,prompt:(i=c.prompt)!=null?i:void 0,temperature:(a=c.temperature)!=null?a:void 0,timestamp_granularities:(o=c.timestampGranularities)!=null?o:void 0};for(const m in h){const y=h[m];y!==void 0&&u.append(m,String(y))}}return{formData:u,warnings:l}}async doGenerate(e){var t,n,r,s,i,a;const o=(r=(n=(t=this.config._internal)==null?void 0:t.currentDate)==null?void 0:n.call(t))!=null?r:new Date,{formData:l,warnings:c}=this.getArgs(e),{value:u,responseHeaders:d,rawValue:h}=await kye({url:this.config.url({path:"/audio/transcriptions",modelId:this.modelId}),headers:qs(this.config.headers(),e.headers),formData:l,failedResponseHandler:Iu,successfulResponseHandler:$a(_be),abortSignal:e.abortSignal,fetch:this.config.fetch}),m=u.language!=null&&u.language in YB?YB[u.language]:void 0;return{text:u.text,segments:(i=(s=u.words)==null?void 0:s.map(y=>({text:y.word,startSecond:y.start,endSecond:y.end})))!=null?i:[],language:m,durationInSeconds:(a=u.duration)!=null?a:void 0,warnings:c,response:{timestamp:o,modelId:this.modelId,headers:d,body:h}}}},_be=Ke({text:$e(),language:$e().nullish(),duration:Tt().nullish(),words:on(Ke({word:$e(),start:Tt(),end:Tt()})).nullish()});function Sbe({prompt:e,systemMessageMode:t}){const n=[],r=[];for(const{role:s,content:i}of e)switch(s){case"system":{switch(t){case"system":{n.push({role:"system",content:i});break}case"developer":{n.push({role:"developer",content:i});break}case"remove":{r.push({type:"other",message:"system messages are removed for this model"});break}default:{const a=t;throw new Error(`Unsupported system message mode: ${a}`)}}break}case"user":{n.push({role:"user",content:i.map((a,o)=>{var l,c,u,d;switch(a.type){case"text":return{type:"input_text",text:a.text};case"image":return{type:"input_image",image_url:a.image instanceof URL?a.image.toString():`data:${(l=a.mimeType)!=null?l:"image/jpeg"};base64,${Nu(a.image)}`,detail:(u=(c=a.providerMetadata)==null?void 0:c.openai)==null?void 0:u.imageDetail};case"file":{if(a.data instanceof URL)throw new hr({functionality:"File URLs in user messages"});switch(a.mimeType){case"application/pdf":return{type:"input_file",filename:(d=a.filename)!=null?d:`part-${o}.pdf`,file_data:`data:application/pdf;base64,${a.data}`};default:throw new hr({functionality:"Only PDF files are supported in user messages"})}}}})});break}case"assistant":{for(const a of i)switch(a.type){case"text":{n.push({role:"assistant",content:[{type:"output_text",text:a.text}]});break}case"tool-call":{n.push({type:"function_call",call_id:a.toolCallId,name:a.toolName,arguments:JSON.stringify(a.args)});break}}break}case"tool":{for(const a of i)n.push({type:"function_call_output",call_id:a.toolCallId,output:JSON.stringify(a.result)});break}default:{const a=s;throw new Error(`Unsupported role: ${a}`)}}return{messages:n,warnings:r}}function ZB({finishReason:e,hasToolCalls:t}){switch(e){case void 0:case null:return t?"tool-calls":"stop";case"max_output_tokens":return"length";case"content_filter":return"content-filter";default:return t?"tool-calls":"unknown"}}function Cbe({mode:e,strict:t}){var n;const r=(n=e.tools)!=null&&n.length?e.tools:void 0,s=[];if(r==null)return{tools:void 0,tool_choice:void 0,toolWarnings:s};const i=e.toolChoice,a=[];for(const l of r)switch(l.type){case"function":a.push({type:"function",name:l.name,description:l.description,parameters:l.parameters,strict:t?!0:void 0});break;case"provider-defined":switch(l.id){case"openai.web_search_preview":a.push({type:"web_search_preview",search_context_size:l.args.searchContextSize,user_location:l.args.userLocation});break;default:s.push({type:"unsupported-tool",tool:l});break}break;default:s.push({type:"unsupported-tool",tool:l});break}if(i==null)return{tools:a,tool_choice:void 0,toolWarnings:s};const o=i.type;switch(o){case"auto":case"none":case"required":return{tools:a,tool_choice:o,toolWarnings:s};case"tool":return i.toolName==="web_search_preview"?{tools:a,tool_choice:{type:"web_search_preview"},toolWarnings:s}:{tools:a,tool_choice:{type:"function",name:i.toolName},toolWarnings:s};default:{const l=o;throw new hr({functionality:`Unsupported tool choice type: ${l}`})}}}var kbe=class{constructor(e,t){this.specificationVersion="v1",this.defaultObjectGenerationMode="json",this.supportsStructuredOutputs=!0,this.modelId=e,this.config=t}get provider(){return this.config.provider}getArgs({mode:e,maxTokens:t,temperature:n,stopSequences:r,topP:s,topK:i,presencePenalty:a,frequencyPenalty:o,seed:l,prompt:c,providerMetadata:u,responseFormat:d}){var h,m,y;const b=[],v=qbe(this.modelId),x=e.type;i!=null&&b.push({type:"unsupported-setting",setting:"topK"}),l!=null&&b.push({type:"unsupported-setting",setting:"seed"}),a!=null&&b.push({type:"unsupported-setting",setting:"presencePenalty"}),o!=null&&b.push({type:"unsupported-setting",setting:"frequencyPenalty"}),r!=null&&b.push({type:"unsupported-setting",setting:"stopSequences"});const{messages:w,warnings:S}=Sbe({prompt:c,systemMessageMode:v.systemMessageMode});b.push(...S);const C=xE({provider:"openai",providerOptions:u,schema:Vbe}),k=(h=C==null?void 0:C.strictSchemas)!=null?h:!0,A={model:this.modelId,input:w,temperature:n,top_p:s,max_output_tokens:t,...(d==null?void 0:d.type)==="json"&&{text:{format:d.schema!=null?{type:"json_schema",strict:k,name:(m=d.name)!=null?m:"response",description:d.description,schema:d.schema}:{type:"json_object"}}},metadata:C==null?void 0:C.metadata,parallel_tool_calls:C==null?void 0:C.parallelToolCalls,previous_response_id:C==null?void 0:C.previousResponseId,store:C==null?void 0:C.store,user:C==null?void 0:C.user,instructions:C==null?void 0:C.instructions,...v.isReasoningModel&&((C==null?void 0:C.reasoningEffort)!=null||(C==null?void 0:C.reasoningSummary)!=null)&&{reasoning:{...(C==null?void 0:C.reasoningEffort)!=null&&{effort:C.reasoningEffort},...(C==null?void 0:C.reasoningSummary)!=null&&{summary:C.reasoningSummary}}},...v.requiredAutoTruncation&&{truncation:"auto"}};switch(v.isReasoningModel&&(A.temperature!=null&&(A.temperature=void 0,b.push({type:"unsupported-setting",setting:"temperature",details:"temperature is not supported for reasoning models"})),A.top_p!=null&&(A.top_p=void 0,b.push({type:"unsupported-setting",setting:"topP",details:"topP is not supported for reasoning models"}))),x){case"regular":{const{tools:R,tool_choice:N,toolWarnings:I}=Cbe({mode:e,strict:k});return{args:{...A,tools:R,tool_choice:N},warnings:[...b,...I]}}case"object-json":return{args:{...A,text:{format:e.schema!=null?{type:"json_schema",strict:k,name:(y=e.name)!=null?y:"response",description:e.description,schema:e.schema}:{type:"json_object"}}},warnings:b};case"object-tool":return{args:{...A,tool_choice:{type:"function",name:e.tool.name},tools:[{type:"function",name:e.tool.name,description:e.tool.description,parameters:e.tool.parameters,strict:k}]},warnings:b};default:{const R=x;throw new Error(`Unsupported type: ${R}`)}}}async doGenerate(e){var t,n,r,s,i,a,o;const{args:l,warnings:c}=this.getArgs(e),{responseHeaders:u,value:d,rawValue:h}=await Vs({url:this.config.url({path:"/responses",modelId:this.modelId}),headers:qs(this.config.headers(),e.headers),body:l,failedResponseHandler:Iu,successfulResponseHandler:$a(Ke({id:$e(),created_at:Tt(),model:$e(),output:on(_E("type",[Ke({type:An("message"),role:An("assistant"),content:on(Ke({type:An("output_text"),text:$e(),annotations:on(Ke({type:An("url_citation"),start_index:Tt(),end_index:Tt(),url:$e(),title:$e()}))}))}),Ke({type:An("function_call"),call_id:$e(),name:$e(),arguments:$e()}),Ke({type:An("web_search_call")}),Ke({type:An("computer_call")}),Ke({type:An("reasoning"),summary:on(Ke({type:An("summary_text"),text:$e()}))})])),incomplete_details:Ke({reason:$e()}).nullable(),usage:pG})),abortSignal:e.abortSignal,fetch:this.config.fetch}),m=d.output.filter(v=>v.type==="message").flatMap(v=>v.content).filter(v=>v.type==="output_text"),y=d.output.filter(v=>v.type==="function_call").map(v=>({toolCallType:"function",toolCallId:v.call_id,toolName:v.name,args:v.arguments})),b=(n=(t=d.output.find(v=>v.type==="reasoning"))==null?void 0:t.summary)!=null?n:null;return{text:m.map(v=>v.text).join(`
`),sources:m.flatMap(v=>v.annotations.map(x=>{var w,S,C;return{sourceType:"url",id:(C=(S=(w=this.config).generateId)==null?void 0:S.call(w))!=null?C:sa(),url:x.url,title:x.title}})),finishReason:ZB({finishReason:(r=d.incomplete_details)==null?void 0:r.reason,hasToolCalls:y.length>0}),toolCalls:y.length>0?y:void 0,reasoning:b?b.map(v=>({type:"text",text:v.text})):void 0,usage:{promptTokens:d.usage.input_tokens,completionTokens:d.usage.output_tokens},rawCall:{rawPrompt:void 0,rawSettings:{}},rawResponse:{headers:u,body:h},request:{body:JSON.stringify(l)},response:{id:d.id,timestamp:new Date(d.created_at*1e3),modelId:d.model},providerMetadata:{openai:{responseId:d.id,cachedPromptTokens:(i=(s=d.usage.input_tokens_details)==null?void 0:s.cached_tokens)!=null?i:null,reasoningTokens:(o=(a=d.usage.output_tokens_details)==null?void 0:a.reasoning_tokens)!=null?o:null}},warnings:c}}async doStream(e){const{args:t,warnings:n}=this.getArgs(e),{responseHeaders:r,value:s}=await Vs({url:this.config.url({path:"/responses",modelId:this.modelId}),headers:qs(this.config.headers(),e.headers),body:{...t,stream:!0},failedResponseHandler:Iu,successfulResponseHandler:$h(Pbe),abortSignal:e.abortSignal,fetch:this.config.fetch}),i=this;let a="unknown",o=NaN,l=NaN,c=null,u=null,d=null;const h={};let m=!1;return{stream:s.pipeThrough(new TransformStream({transform(y,b){var v,x,w,S,C,k,A,R;if(!y.success){a="error",b.enqueue({type:"error",error:y.error});return}const N=y.value;if($be(N))N.item.type==="function_call"&&(h[N.output_index]={toolName:N.item.name,toolCallId:N.item.call_id},b.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:N.item.call_id,toolName:N.item.name,argsTextDelta:N.item.arguments}));else if(Bbe(N)){const I=h[N.output_index];I!=null&&b.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:I.toolCallId,toolName:I.toolName,argsTextDelta:N.delta})}else Lbe(N)?(d=N.response.id,b.enqueue({type:"response-metadata",id:N.response.id,timestamp:new Date(N.response.created_at*1e3),modelId:N.response.model})):Obe(N)?b.enqueue({type:"text-delta",textDelta:N.delta}):Ube(N)?b.enqueue({type:"reasoning",textDelta:N.delta}):Dbe(N)&&N.item.type==="function_call"?(h[N.output_index]=void 0,m=!0,b.enqueue({type:"tool-call",toolCallType:"function",toolCallId:N.item.call_id,toolName:N.item.name,args:N.item.arguments})):Fbe(N)?(a=ZB({finishReason:(v=N.response.incomplete_details)==null?void 0:v.reason,hasToolCalls:m}),o=N.response.usage.input_tokens,l=N.response.usage.output_tokens,c=(w=(x=N.response.usage.input_tokens_details)==null?void 0:x.cached_tokens)!=null?w:c,u=(C=(S=N.response.usage.output_tokens_details)==null?void 0:S.reasoning_tokens)!=null?C:u):zbe(N)&&b.enqueue({type:"source",source:{sourceType:"url",id:(R=(A=(k=i.config).generateId)==null?void 0:A.call(k))!=null?R:sa(),url:N.annotation.url,title:N.annotation.title}})},flush(y){y.enqueue({type:"finish",finishReason:a,usage:{promptTokens:o,completionTokens:l},...(c!=null||u!=null)&&{providerMetadata:{openai:{responseId:d,cachedPromptTokens:c,reasoningTokens:u}}}})}})),rawCall:{rawPrompt:void 0,rawSettings:{}},rawResponse:{headers:r},request:{body:JSON.stringify(t)},warnings:n}}},pG=Ke({input_tokens:Tt(),input_tokens_details:Ke({cached_tokens:Tt().nullish()}).nullish(),output_tokens:Tt(),output_tokens_details:Ke({reasoning_tokens:Tt().nullish()}).nullish()}),Ebe=Ke({type:An("response.output_text.delta"),delta:$e()}),Tbe=Ke({type:bl(["response.completed","response.incomplete"]),response:Ke({incomplete_details:Ke({reason:$e()}).nullish(),usage:pG})}),Abe=Ke({type:An("response.created"),response:Ke({id:$e(),created_at:Tt(),model:$e()})}),Rbe=Ke({type:An("response.output_item.done"),output_index:Tt(),item:_E("type",[Ke({type:An("message")}),Ke({type:An("function_call"),id:$e(),call_id:$e(),name:$e(),arguments:$e(),status:An("completed")})])}),Nbe=Ke({type:An("response.function_call_arguments.delta"),item_id:$e(),output_index:Tt(),delta:$e()}),Mbe=Ke({type:An("response.output_item.added"),output_index:Tt(),item:_E("type",[Ke({type:An("message")}),Ke({type:An("function_call"),id:$e(),call_id:$e(),name:$e(),arguments:$e()})])}),Ibe=Ke({type:An("response.output_text.annotation.added"),annotation:Ke({type:An("url_citation"),url:$e(),title:$e()})}),jbe=Ke({type:An("response.reasoning_summary_text.delta"),item_id:$e(),output_index:Tt(),summary_index:Tt(),delta:$e()}),Pbe=ps([Ebe,Tbe,Abe,Rbe,Nbe,Mbe,Ibe,jbe,Ke({type:$e()}).passthrough()]);function Obe(e){return e.type==="response.output_text.delta"}function Dbe(e){return e.type==="response.output_item.done"}function Fbe(e){return e.type==="response.completed"||e.type==="response.incomplete"}function Lbe(e){return e.type==="response.created"}function Bbe(e){return e.type==="response.function_call_arguments.delta"}function $be(e){return e.type==="response.output_item.added"}function zbe(e){return e.type==="response.output_text.annotation.added"}function Ube(e){return e.type==="response.reasoning_summary_text.delta"}function qbe(e){return e.startsWith("o")?e.startsWith("o1-mini")||e.startsWith("o1-preview")?{isReasoningModel:!0,systemMessageMode:"remove",requiredAutoTruncation:!1}:{isReasoningModel:!0,systemMessageMode:"developer",requiredAutoTruncation:!1}:{isReasoningModel:!1,systemMessageMode:"system",requiredAutoTruncation:!1}}var Vbe=Ke({metadata:yh().nullish(),parallelToolCalls:br().nullish(),previousResponseId:$e().nullish(),store:br().nullish(),user:$e().nullish(),reasoningEffort:$e().nullish(),strictSchemas:br().nullish(),instructions:$e().nullish(),reasoningSummary:$e().nullish()}),Wbe=Ke({});function Hbe({searchContextSize:e,userLocation:t}={}){return{type:"provider-defined",id:"openai.web_search_preview",args:{searchContextSize:e,userLocation:t},parameters:Wbe}}var Gbe={webSearchPreview:Hbe},Kbe=Ke({instructions:$e().nullish(),speed:Tt().min(.25).max(4).default(1).nullish()}),Ybe=class{constructor(e,t){this.modelId=e,this.config=t,this.specificationVersion="v1"}get provider(){return this.config.provider}getArgs({text:e,voice:t="alloy",outputFormat:n="mp3",speed:r,instructions:s,providerOptions:i}){const a=[],o=xE({provider:"openai",providerOptions:i,schema:Kbe}),l={model:this.modelId,input:e,voice:t,response_format:"mp3",speed:r,instructions:s};if(n&&(["mp3","opus","aac","flac","wav","pcm"].includes(n)?l.response_format=n:a.push({type:"unsupported-setting",setting:"outputFormat",details:`Unsupported output format: ${n}. Using mp3 instead.`})),o){const c={};for(const u in c){const d=c[u];d!==void 0&&(l[u]=d)}}return{requestBody:l,warnings:a}}async doGenerate(e){var t,n,r;const s=(r=(n=(t=this.config._internal)==null?void 0:t.currentDate)==null?void 0:n.call(t))!=null?r:new Date,{requestBody:i,warnings:a}=this.getArgs(e),{value:o,responseHeaders:l,rawValue:c}=await Vs({url:this.config.url({path:"/audio/speech",modelId:this.modelId}),headers:qs(this.config.headers(),e.headers),body:i,failedResponseHandler:Iu,successfulResponseHandler:Eye(),abortSignal:e.abortSignal,fetch:this.config.fetch});return{audio:o,warnings:a,request:{body:JSON.stringify(i)},response:{timestamp:s,modelId:this.modelId,headers:l,body:c}}}};function mG(e={}){var t,n,r;const s=(t=u1(e.baseURL))!=null?t:"https://api.openai.com/v1",i=(n=e.compatibility)!=null?n:"compatible",a=(r=e.name)!=null?r:"openai",o=()=>({Authorization:`Bearer ${VP({apiKey:e.apiKey,environmentVariableName:"OPENAI_API_KEY",description:"OpenAI"})}`,"OpenAI-Organization":e.organization,"OpenAI-Project":e.project,...e.headers}),l=(x,w={})=>new sbe(x,w,{provider:`${a}.chat`,url:({path:S})=>`${s}${S}`,headers:o,compatibility:i,fetch:e.fetch}),c=(x,w={})=>new dbe(x,w,{provider:`${a}.completion`,url:({path:S})=>`${s}${S}`,headers:o,compatibility:i,fetch:e.fetch}),u=(x,w={})=>new pbe(x,w,{provider:`${a}.embedding`,url:({path:S})=>`${s}${S}`,headers:o,fetch:e.fetch}),d=(x,w={})=>new bbe(x,w,{provider:`${a}.image`,url:({path:S})=>`${s}${S}`,headers:o,fetch:e.fetch}),h=x=>new wbe(x,{provider:`${a}.transcription`,url:({path:w})=>`${s}${w}`,headers:o,fetch:e.fetch}),m=x=>new Ybe(x,{provider:`${a}.speech`,url:({path:w})=>`${s}${w}`,headers:o,fetch:e.fetch}),y=(x,w)=>{if(new.target)throw new Error("The OpenAI model function cannot be called with the new keyword.");return x==="gpt-3.5-turbo-instruct"?c(x,w):l(x,w)},b=x=>new kbe(x,{provider:`${a}.responses`,url:({path:w})=>`${s}${w}`,headers:o,fetch:e.fetch}),v=function(x,w){return y(x,w)};return v.languageModel=y,v.chat=l,v.completion=c,v.responses=b,v.embedding=u,v.textEmbedding=u,v.textEmbeddingModel=u,v.image=d,v.imageModel=d,v.transcription=h,v.transcriptionModel=h,v.speech=m,v.speechModel=m,v.tools=Gbe,v}mG({compatibility:"strict"});function zl(e){if(Zbe(e))return;if(typeof e=="boolean")return{type:"boolean",properties:{}};const{type:t,description:n,required:r,properties:s,items:i,allOf:a,anyOf:o,oneOf:l,format:c,const:u,minLength:d,enum:h}=e,m={};if(n&&(m.description=n),r&&(m.required=r),c&&(m.format=c),u!==void 0&&(m.enum=[u]),t&&(Array.isArray(t)?t.includes("null")?(m.type=t.filter(y=>y!=="null")[0],m.nullable=!0):m.type=t:t==="null"?m.type="null":m.type=t),h!==void 0&&(m.enum=h),s!=null&&(m.properties=Object.entries(s).reduce((y,[b,v])=>(y[b]=zl(v),y),{})),i&&(m.items=Array.isArray(i)?i.map(zl):zl(i)),a&&(m.allOf=a.map(zl)),o)if(o.some(y=>typeof y=="object"&&(y==null?void 0:y.type)==="null")){const y=o.filter(b=>!(typeof b=="object"&&(b==null?void 0:b.type)==="null"));if(y.length===1){const b=zl(y[0]);typeof b=="object"&&(m.nullable=!0,Object.assign(m,b))}else m.anyOf=y.map(zl),m.nullable=!0}else m.anyOf=o.map(zl);return l&&(m.oneOf=l.map(zl)),d!==void 0&&(m.minLength=d),m}function Zbe(e){return e!=null&&typeof e=="object"&&e.type==="object"&&(e.properties==null||Object.keys(e.properties).length===0)}function Xbe(e){var t,n;const r=[],s=[];let i=!0;for(const{role:a,content:o}of e)switch(a){case"system":{if(!i)throw new hr({functionality:"system messages are only supported at the beginning of the conversation"});r.push({text:o});break}case"user":{i=!1;const l=[];for(const c of o)switch(c.type){case"text":{l.push({text:c.text});break}case"image":{l.push(c.image instanceof URL?{fileData:{mimeType:(t=c.mimeType)!=null?t:"image/jpeg",fileUri:c.image.toString()}}:{inlineData:{mimeType:(n=c.mimeType)!=null?n:"image/jpeg",data:Nu(c.image)}});break}case"file":{l.push(c.data instanceof URL?{fileData:{mimeType:c.mimeType,fileUri:c.data.toString()}}:{inlineData:{mimeType:c.mimeType,data:c.data}});break}}s.push({role:"user",parts:l});break}case"assistant":{i=!1,s.push({role:"model",parts:o.map(l=>{switch(l.type){case"text":return l.text.length===0?void 0:{text:l.text};case"file":{if(l.mimeType!=="image/png")throw new hr({functionality:"Only PNG images are supported in assistant messages"});if(l.data instanceof URL)throw new hr({functionality:"File data URLs in assistant messages are not supported"});return{inlineData:{mimeType:l.mimeType,data:l.data}}}case"tool-call":return{functionCall:{name:l.toolName,args:l.args}}}}).filter(l=>l!==void 0)});break}case"tool":{i=!1,s.push({role:"user",parts:o.map(l=>({functionResponse:{name:l.toolName,response:{name:l.toolName,content:l.result}}}))});break}}return{systemInstruction:r.length>0?{parts:r}:void 0,contents:s}}function XB(e){return e.includes("/")?e:`models/${e}`}var Jbe=Ke({error:Ke({code:Tt().nullable(),message:$e(),status:$e()})}),lj=Bh({errorSchema:Jbe,errorToMessage:e=>e.error.message});function Qbe(e,t,n,r){var s,i;const a=(s=e.tools)!=null&&s.length?e.tools:void 0,o=[],l=r.includes("gemini-2"),c=r.includes("gemini-1.5-flash")&&!r.includes("-8b");if(t)return{tools:l?{googleSearch:{}}:{googleSearchRetrieval:!c||!n?{}:{dynamicRetrievalConfig:n}},toolConfig:void 0,toolWarnings:o};if(a==null)return{tools:void 0,toolConfig:void 0,toolWarnings:o};const u=[];for(const m of a)m.type==="provider-defined"?o.push({type:"unsupported-tool",tool:m}):u.push({name:m.name,description:(i=m.description)!=null?i:"",parameters:zl(m.parameters)});const d=e.toolChoice;if(d==null)return{tools:{functionDeclarations:u},toolConfig:void 0,toolWarnings:o};const h=d.type;switch(h){case"auto":return{tools:{functionDeclarations:u},toolConfig:{functionCallingConfig:{mode:"AUTO"}},toolWarnings:o};case"none":return{tools:{functionDeclarations:u},toolConfig:{functionCallingConfig:{mode:"NONE"}},toolWarnings:o};case"required":return{tools:{functionDeclarations:u},toolConfig:{functionCallingConfig:{mode:"ANY"}},toolWarnings:o};case"tool":return{tools:{functionDeclarations:u},toolConfig:{functionCallingConfig:{mode:"ANY",allowedFunctionNames:[d.toolName]}},toolWarnings:o};default:{const m=h;throw new hr({functionality:`Unsupported tool choice type: ${m}`})}}}function JB({finishReason:e,hasToolCalls:t}){switch(e){case"STOP":return t?"tool-calls":"stop";case"MAX_TOKENS":return"length";case"IMAGE_SAFETY":case"RECITATION":case"SAFETY":case"BLOCKLIST":case"PROHIBITED_CONTENT":case"SPII":return"content-filter";case"FINISH_REASON_UNSPECIFIED":case"OTHER":return"other";case"MALFORMED_FUNCTION_CALL":return"error";default:return"unknown"}}var eve=class{constructor(e,t,n){this.specificationVersion="v1",this.defaultObjectGenerationMode="json",this.supportsImageUrls=!1,this.modelId=e,this.settings=t,this.config=n}get supportsStructuredOutputs(){var e;return(e=this.settings.structuredOutputs)!=null?e:!0}get provider(){return this.config.provider}async getArgs({mode:e,prompt:t,maxTokens:n,temperature:r,topP:s,topK:i,frequencyPenalty:a,presencePenalty:o,stopSequences:l,responseFormat:c,seed:u,providerMetadata:d}){var h,m,y;const b=e.type,v=[],x=xE({provider:"google",providerOptions:d,schema:sve});((h=x==null?void 0:x.thinkingConfig)==null?void 0:h.includeThoughts)===!0&&!this.config.provider.startsWith("google.vertex.")&&v.push({type:"other",message:`The 'includeThoughts' option is only supported with the Google Vertex provider and might not be supported or could behave unexpectedly with the current Google provider (${this.config.provider}).`});const w={maxOutputTokens:n,temperature:r,topK:i,topP:s,frequencyPenalty:a,presencePenalty:o,stopSequences:l,seed:u,responseMimeType:(c==null?void 0:c.type)==="json"?"application/json":void 0,responseSchema:(c==null?void 0:c.type)==="json"&&c.schema!=null&&this.supportsStructuredOutputs?zl(c.schema):void 0,...this.settings.audioTimestamp&&{audioTimestamp:this.settings.audioTimestamp},responseModalities:x==null?void 0:x.responseModalities,thinkingConfig:x==null?void 0:x.thinkingConfig},{contents:S,systemInstruction:C}=Xbe(t);switch(b){case"regular":{const{tools:k,toolConfig:A,toolWarnings:R}=Qbe(e,(m=this.settings.useSearchGrounding)!=null?m:!1,this.settings.dynamicRetrievalConfig,this.modelId);return{args:{generationConfig:w,contents:S,systemInstruction:C,safetySettings:this.settings.safetySettings,tools:k,toolConfig:A,cachedContent:this.settings.cachedContent},warnings:[...v,...R]}}case"object-json":return{args:{generationConfig:{...w,responseMimeType:"application/json",responseSchema:e.schema!=null&&this.supportsStructuredOutputs?zl(e.schema):void 0},contents:S,systemInstruction:C,safetySettings:this.settings.safetySettings,cachedContent:this.settings.cachedContent},warnings:v};case"object-tool":return{args:{generationConfig:w,contents:S,tools:{functionDeclarations:[{name:e.tool.name,description:(y=e.tool.description)!=null?y:"",parameters:zl(e.tool.parameters)}]},toolConfig:{functionCallingConfig:{mode:"ANY"}},safetySettings:this.settings.safetySettings,cachedContent:this.settings.cachedContent},warnings:v};default:{const k=b;throw new Error(`Unsupported type: ${k}`)}}}supportsUrl(e){return this.config.isSupportedUrl(e)}async doGenerate(e){var t,n,r,s,i;const{args:a,warnings:o}=await this.getArgs(e),l=JSON.stringify(a),c=qs(await ej(this.config.headers),e.headers),{responseHeaders:u,value:d,rawValue:h}=await Vs({url:`${this.config.baseURL}/${XB(this.modelId)}:generateContent`,headers:c,body:a,failedResponseHandler:lj,successfulResponseHandler:$a(nve),abortSignal:e.abortSignal,fetch:this.config.fetch}),{contents:m,...y}=a,b=d.candidates[0],v=b.content==null||typeof b.content!="object"||!("parts"in b.content)?[]:b.content.parts,x=QB({parts:v,generateId:this.config.generateId}),w=d.usageMetadata;return{text:e$(v),reasoning:t$(v),files:(t=n$(v))==null?void 0:t.map(S=>({data:S.inlineData.data,mimeType:S.inlineData.mimeType})),toolCalls:x,finishReason:JB({finishReason:b.finishReason,hasToolCalls:x!=null&&x.length>0}),usage:{promptTokens:(n=w==null?void 0:w.promptTokenCount)!=null?n:NaN,completionTokens:(r=w==null?void 0:w.candidatesTokenCount)!=null?r:NaN},rawCall:{rawPrompt:m,rawSettings:y},rawResponse:{headers:u,body:h},warnings:o,providerMetadata:{google:{groundingMetadata:(s=b.groundingMetadata)!=null?s:null,safetyRatings:(i=b.safetyRatings)!=null?i:null}},sources:r$({groundingMetadata:b.groundingMetadata,generateId:this.config.generateId}),request:{body:l}}}async doStream(e){const{args:t,warnings:n}=await this.getArgs(e),r=JSON.stringify(t),s=qs(await ej(this.config.headers),e.headers),{responseHeaders:i,value:a}=await Vs({url:`${this.config.baseURL}/${XB(this.modelId)}:streamGenerateContent?alt=sse`,headers:s,body:t,failedResponseHandler:lj,successfulResponseHandler:$h(rve),abortSignal:e.abortSignal,fetch:this.config.fetch}),{contents:o,...l}=t;let c="unknown",u={promptTokens:Number.NaN,completionTokens:Number.NaN},d;const h=this.config.generateId;let m=!1;return{stream:a.pipeThrough(new TransformStream({transform(y,b){var v,x,w,S,C,k;if(!y.success){b.enqueue({type:"error",error:y.error});return}const A=y.value,R=A.usageMetadata;R!=null&&(u={promptTokens:(v=R.promptTokenCount)!=null?v:NaN,completionTokens:(x=R.candidatesTokenCount)!=null?x:NaN});const N=(w=A.candidates)==null?void 0:w[0];if(N==null)return;const I=N.content;if(I!=null){const P=e$(I.parts);P!=null&&b.enqueue({type:"text-delta",textDelta:P});const L=t$(I.parts);if(L!=null)for(const D of L)b.enqueue({type:"reasoning",textDelta:D.text});const O=n$(I.parts);if(O!=null)for(const D of O)b.enqueue({type:"file",mimeType:D.inlineData.mimeType,data:D.inlineData.data});const V=QB({parts:I.parts,generateId:h});if(V!=null)for(const D of V)b.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:D.toolCallId,toolName:D.toolName,argsTextDelta:D.args}),b.enqueue({type:"tool-call",toolCallType:"function",toolCallId:D.toolCallId,toolName:D.toolName,args:D.args}),m=!0}if(N.finishReason!=null){c=JB({finishReason:N.finishReason,hasToolCalls:m});const P=(S=r$({groundingMetadata:N.groundingMetadata,generateId:h}))!=null?S:[];for(const L of P)b.enqueue({type:"source",source:L});d={google:{groundingMetadata:(C=N.groundingMetadata)!=null?C:null,safetyRatings:(k=N.safetyRatings)!=null?k:null}}}},flush(y){y.enqueue({type:"finish",finishReason:c,usage:u,providerMetadata:d})}})),rawCall:{rawPrompt:o,rawSettings:l},rawResponse:{headers:i},warnings:n,request:{body:r}}}};function QB({parts:e,generateId:t}){const n=e==null?void 0:e.filter(r=>"functionCall"in r);return n==null||n.length===0?void 0:n.map(r=>({toolCallType:"function",toolCallId:t(),toolName:r.functionCall.name,args:JSON.stringify(r.functionCall.args)}))}function e$(e){const t=e==null?void 0:e.filter(n=>"text"in n&&n.thought!==!0);return t==null||t.length===0?void 0:t.map(n=>n.text).join("")}function t$(e){const t=e==null?void 0:e.filter(n=>"text"in n&&n.thought===!0&&n.text!=null);return t==null||t.length===0?void 0:t.map(n=>({type:"text",text:n.text}))}function n$(e){return e==null?void 0:e.filter(t=>"inlineData"in t)}function r$({groundingMetadata:e,generateId:t}){var n;return(n=e==null?void 0:e.groundingChunks)==null?void 0:n.filter(r=>r.web!=null).map(r=>({sourceType:"url",id:t(),url:r.web.uri,title:r.web.title}))}var gG=Ke({parts:on(ps([Ke({functionCall:Ke({name:$e(),args:Fy()})}),Ke({inlineData:Ke({mimeType:$e(),data:$e()})}),Ke({text:$e().nullish(),thought:br().nullish()})])).nullish()}),tve=Ke({web:Ke({uri:$e(),title:$e()}).nullish(),retrievedContext:Ke({uri:$e(),title:$e()}).nullish()}),yG=Ke({webSearchQueries:on($e()).nullish(),retrievalQueries:on($e()).nullish(),searchEntryPoint:Ke({renderedContent:$e()}).nullish(),groundingChunks:on(tve).nullish(),groundingSupports:on(Ke({segment:Ke({startIndex:Tt().nullish(),endIndex:Tt().nullish(),text:$e().nullish()}),segment_text:$e().nullish(),groundingChunkIndices:on(Tt()).nullish(),supportChunkIndices:on(Tt()).nullish(),confidenceScores:on(Tt()).nullish(),confidenceScore:on(Tt()).nullish()})).nullish(),retrievalMetadata:ps([Ke({webDynamicRetrievalScore:Tt()}),Ke({})]).nullish()}),bG=Ke({category:$e().nullish(),probability:$e().nullish(),probabilityScore:Tt().nullish(),severity:$e().nullish(),severityScore:Tt().nullish(),blocked:br().nullish()}),nve=Ke({candidates:on(Ke({content:gG.nullish().or(Ke({}).strict()),finishReason:$e().nullish(),safetyRatings:on(bG).nullish(),groundingMetadata:yG.nullish()})),usageMetadata:Ke({promptTokenCount:Tt().nullish(),candidatesTokenCount:Tt().nullish(),totalTokenCount:Tt().nullish()}).nullish()}),rve=Ke({candidates:on(Ke({content:gG.nullish(),finishReason:$e().nullish(),safetyRatings:on(bG).nullish(),groundingMetadata:yG.nullish()})).nullish(),usageMetadata:Ke({promptTokenCount:Tt().nullish(),candidatesTokenCount:Tt().nullish(),totalTokenCount:Tt().nullish()}).nullish()}),sve=Ke({responseModalities:on(bl(["TEXT","IMAGE"])).nullish(),thinkingConfig:Ke({thinkingBudget:Tt().nullish(),includeThoughts:br().nullish()}).nullish()}),ive=class{constructor(e,t,n){this.specificationVersion="v1",this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}get maxEmbeddingsPerCall(){return 2048}get supportsParallelCalls(){return!0}async doEmbed({values:e,headers:t,abortSignal:n}){if(e.length>this.maxEmbeddingsPerCall)throw new bE({provider:this.provider,modelId:this.modelId,maxEmbeddingsPerCall:this.maxEmbeddingsPerCall,values:e});const r=qs(await ej(this.config.headers),t),{responseHeaders:s,value:i}=await Vs({url:`${this.config.baseURL}/models/${this.modelId}:batchEmbedContents`,headers:r,body:{requests:e.map(a=>({model:`models/${this.modelId}`,content:{role:"user",parts:[{text:a}]},outputDimensionality:this.settings.outputDimensionality,taskType:this.settings.taskType}))},failedResponseHandler:lj,successfulResponseHandler:$a(ave),abortSignal:n,fetch:this.config.fetch});return{embeddings:i.embeddings.map(a=>a.values),usage:void 0,rawResponse:{headers:s}}}},ave=Ke({embeddings:on(Ke({values:on(Tt())}))});function ove(e){return e.toString().startsWith("https://generativelanguage.googleapis.com/v1beta/files/")}function vG(e={}){var t;const n=(t=u1(e.baseURL))!=null?t:"https://generativelanguage.googleapis.com/v1beta",r=()=>({"x-goog-api-key":VP({apiKey:e.apiKey,environmentVariableName:"GOOGLE_GENERATIVE_AI_API_KEY",description:"Google Generative AI"}),...e.headers}),s=(o,l={})=>{var c;return new eve(o,l,{provider:"google.generative-ai",baseURL:n,headers:r,generateId:(c=e.generateId)!=null?c:sa,isSupportedUrl:ove,fetch:e.fetch})},i=(o,l={})=>new ive(o,l,{provider:"google.generative-ai",baseURL:n,headers:r,fetch:e.fetch}),a=function(o,l){if(new.target)throw new Error("The Google Generative AI model function cannot be called with the new keyword.");return s(o,l)};return a.languageModel=s,a.chat=s,a.generativeAI=s,a.embedding=i,a.textEmbedding=i,a.textEmbeddingModel=i,a}vG();var lve=Object.defineProperty,cve=Object.defineProperties,uve=Object.getOwnPropertyDescriptors,kC=Object.getOwnPropertySymbols,xG=Object.prototype.hasOwnProperty,wG=Object.prototype.propertyIsEnumerable,s$=(e,t,n)=>t in e?lve(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Na=(e,t)=>{for(var n in t||(t={}))xG.call(t,n)&&s$(e,n,t[n]);if(kC)for(var n of kC(t))wG.call(t,n)&&s$(e,n,t[n]);return e},k2=(e,t)=>cve(e,uve(t)),EC=(e,t)=>{var n={};for(var r in e)xG.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&kC)for(var r of kC(e))t.indexOf(r)<0&&wG.call(e,r)&&(n[r]=e[r]);return n},dve=Ke({type:An("reasoning.summary"),summary:$e()}),fve=Ke({type:An("reasoning.encrypted"),data:$e()}),hve=Ke({type:An("reasoning.text"),text:$e().nullish(),signature:$e().nullish()}),pve=ps([dve,fve,hve]),mve=ps([pve,Fy().transform(()=>null)]),KP=on(mve).transform(e=>e.filter(t=>!!t));function Kf(e){var t,n,r;const s=e==null?void 0:e.anthropic,i=e==null?void 0:e.openrouter;return(r=(n=(t=i==null?void 0:i.cacheControl)!=null?t:i==null?void 0:i.cache_control)!=null?n:s==null?void 0:s.cacheControl)!=null?r:s==null?void 0:s.cache_control}function gve(e){var t,n,r;const s=[];for(const{role:i,content:a,providerMetadata:o}of e)switch(i){case"system":{s.push({role:"system",content:a,cache_control:Kf(o)});break}case"user":{if(a.length===1&&((t=a[0])==null?void 0:t.type)==="text"){s.push({role:"user",content:a[0].text,cache_control:(n=Kf(o))!=null?n:Kf(a[0].providerMetadata)});break}const l=Kf(o),c=a.map(u=>{var d,h,m,y;const b=(d=Kf(u.providerMetadata))!=null?d:l;switch(u.type){case"text":return{type:"text",text:u.text,cache_control:b};case"image":return{type:"image_url",image_url:{url:u.image instanceof URL?u.image.toString():`data:${(h=u.mimeType)!=null?h:"image/jpeg"};base64,${Nu(u.image)}`},cache_control:b};case"file":return{type:"file",file:{filename:String((y=(m=u.providerMetadata)==null?void 0:m.openrouter)==null?void 0:y.filename),file_data:u.data instanceof Uint8Array?`data:${u.mimeType};base64,${Nu(u.data)}`:`data:${u.mimeType};base64,${u.data}`},cache_control:b};default:{const v=u;throw new Error(`Unsupported content part type: ${v}`)}}});s.push({role:"user",content:c});break}case"assistant":{let l="",c="";const u=[],d=[];for(const h of a)switch(h.type){case"text":{l+=h.text;break}case"tool-call":{d.push({id:h.toolCallId,type:"function",function:{name:h.toolName,arguments:JSON.stringify(h.args)}});break}case"reasoning":{c+=h.text,u.push({type:"reasoning.text",text:h.text,signature:h.signature});break}case"redacted-reasoning":{u.push({type:"reasoning.encrypted",data:h.data});break}case"file":break;default:{const m=h;throw new Error(`Unsupported part: ${m}`)}}s.push({role:"assistant",content:l,tool_calls:d.length>0?d:void 0,reasoning:c||void 0,reasoning_details:u.length>0?u:void 0,cache_control:Kf(o)});break}case"tool":{for(const l of a)s.push({role:"tool",tool_call_id:l.toolCallId,content:JSON.stringify(l.result),cache_control:(r=Kf(o))!=null?r:Kf(l.providerMetadata)});break}default:{const l=i;throw new Error(`Unsupported role: ${l}`)}}return s}function i$(e){var t,n;return(n=(t=e==null?void 0:e.content)==null?void 0:t.map(({token:r,logprob:s,top_logprobs:i})=>({token:r,logprob:s,topLogprobs:i?i.map(({token:a,logprob:o})=>({token:a,logprob:o})):[]})))!=null?n:void 0}function TC(e){switch(e){case"stop":return"stop";case"length":return"length";case"content_filter":return"content-filter";case"function_call":case"tool_calls":return"tool-calls";default:return"unknown"}}var YP=Ke({error:Ke({code:ps([$e(),Tt()]).nullable(),message:$e(),type:$e().nullable(),param:yh().nullable()})}),AC=Bh({errorSchema:YP,errorToMessage:e=>e.error.message});function yve(e){return"parameters"in e}var bve=class{constructor(e,t,n){this.specificationVersion="v1",this.defaultObjectGenerationMode="tool",this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}getArgs({mode:e,prompt:t,maxTokens:n,temperature:r,topP:s,frequencyPenalty:i,presencePenalty:a,seed:o,stopSequences:l,responseFormat:c,topK:u,providerMetadata:d}){var h;const m=e.type,y=(h=d==null?void 0:d.openrouter)!=null?h:{},b=Na(Na(Na({model:this.modelId,models:this.settings.models,logit_bias:this.settings.logitBias,logprobs:this.settings.logprobs===!0||typeof this.settings.logprobs=="number"?!0:void 0,top_logprobs:typeof this.settings.logprobs=="number"?this.settings.logprobs:typeof this.settings.logprobs=="boolean"&&this.settings.logprobs?0:void 0,user:this.settings.user,parallel_tool_calls:this.settings.parallelToolCalls,max_tokens:n,temperature:r,top_p:s,frequency_penalty:i,presence_penalty:a,seed:o,stop:l,response_format:c,top_k:u,messages:gve(t),include_reasoning:this.settings.includeReasoning,reasoning:this.settings.reasoning,usage:this.settings.usage},this.config.extraBody),this.settings.extraBody),y);switch(m){case"regular":return Na(Na({},b),wve(e));case"object-json":return k2(Na({},b),{response_format:{type:"json_object"}});case"object-tool":return k2(Na({},b),{tool_choice:{type:"function",function:{name:e.tool.name}},tools:[{type:"function",function:{name:e.tool.name,description:e.tool.description,parameters:e.tool.parameters}}]});default:{const v=m;throw new hr({functionality:`${v} mode`})}}}async doGenerate(e){var t,n,r,s,i,a,o,l,c;const u=this.getArgs(e),{responseHeaders:d,value:h}=await Vs({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:qs(this.config.headers(),e.headers),body:u,failedResponseHandler:AC,successfulResponseHandler:$a(vve),abortSignal:e.abortSignal,fetch:this.config.fetch}),m=u,{messages:y}=m,b=EC(m,["messages"]),v=h.choices[0];if(!v)throw new Error("No choice in response");const x=h.usage?{promptTokens:(t=h.usage.prompt_tokens)!=null?t:0,completionTokens:(n=h.usage.completion_tokens)!=null?n:0}:{promptTokens:0,completionTokens:0},w={};h.usage&&((r=this.settings.usage)!=null&&r.include)&&(w.openrouter={usage:{promptTokens:h.usage.prompt_tokens,promptTokensDetails:h.usage.prompt_tokens_details?{cachedTokens:(s=h.usage.prompt_tokens_details.cached_tokens)!=null?s:0}:void 0,completionTokens:h.usage.completion_tokens,completionTokensDetails:h.usage.completion_tokens_details?{reasoningTokens:(i=h.usage.completion_tokens_details.reasoning_tokens)!=null?i:0}:void 0,cost:h.usage.cost,totalTokens:(a=h.usage.total_tokens)!=null?a:0}});const S=Object.keys(w).length>0,C=(o=v.message.reasoning_details)!=null?o:[],k=C.length>0?C.map(A=>{var R;switch(A.type){case"reasoning.text":{if(A.text)return{type:"text",text:A.text,signature:(R=A.signature)!=null?R:void 0};break}case"reasoning.summary":{if(A.summary)return{type:"text",text:A.summary};break}case"reasoning.encrypted":{if(A.data)return{type:"redacted",data:A.data};break}}return null}).filter(A=>A!==null):v.message.reasoning?[{type:"text",text:v.message.reasoning}]:[];return Na({response:{id:h.id,modelId:h.model},text:(l=v.message.content)!=null?l:void 0,reasoning:k,toolCalls:(c=v.message.tool_calls)==null?void 0:c.map(A=>{var R;return{toolCallType:"function",toolCallId:(R=A.id)!=null?R:sa(),toolName:A.function.name,args:A.function.arguments}}),finishReason:TC(v.finish_reason),usage:x,rawCall:{rawPrompt:y,rawSettings:b},rawResponse:{headers:d},warnings:[],logprobs:i$(v.logprobs)},S?{providerMetadata:w}:{})}async doStream(e){var t,n;const r=this.getArgs(e),{responseHeaders:s,value:i}=await Vs({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:qs(this.config.headers(),e.headers),body:k2(Na({},r),{stream:!0,stream_options:this.config.compatibility==="strict"?Na({include_usage:!0},(t=this.settings.usage)!=null&&t.include?{include_usage:!0}:{}):void 0}),failedResponseHandler:AC,successfulResponseHandler:$h(xve),abortSignal:e.abortSignal,fetch:this.config.fetch}),a=r,{messages:o}=a,l=EC(a,["messages"]),c=[];let u="other",d={promptTokens:Number.NaN,completionTokens:Number.NaN},h;const m={},y=!!((n=this.settings.usage)!=null&&n.include);return{stream:i.pipeThrough(new TransformStream({transform(b,v){var x,w,S,C,k,A,R,N,I,P,L,O,V,D;if(!b.success){u="error",v.enqueue({type:"error",error:b.error});return}const Z=b.value;if("error"in Z){u="error",v.enqueue({type:"error",error:Z.error});return}Z.id&&v.enqueue({type:"response-metadata",id:Z.id}),Z.model&&v.enqueue({type:"response-metadata",modelId:Z.model}),Z.usage!=null&&(d={promptTokens:Z.usage.prompt_tokens,completionTokens:Z.usage.completion_tokens},m.promptTokens=Z.usage.prompt_tokens,Z.usage.prompt_tokens_details&&(m.promptTokensDetails={cachedTokens:(x=Z.usage.prompt_tokens_details.cached_tokens)!=null?x:0}),m.completionTokens=Z.usage.completion_tokens,Z.usage.completion_tokens_details&&(m.completionTokensDetails={reasoningTokens:(w=Z.usage.completion_tokens_details.reasoning_tokens)!=null?w:0}),m.cost=Z.usage.cost,m.totalTokens=Z.usage.total_tokens);const U=Z.choices[0];if((U==null?void 0:U.finish_reason)!=null&&(u=TC(U.finish_reason)),(U==null?void 0:U.delta)==null)return;const H=U.delta;if(H.content!=null&&v.enqueue({type:"text-delta",textDelta:H.content}),H.reasoning!=null&&v.enqueue({type:"reasoning",textDelta:H.reasoning}),H.reasoning_details&&H.reasoning_details.length>0)for(const ne of H.reasoning_details)switch(ne.type){case"reasoning.text":{ne.text&&v.enqueue({type:"reasoning",textDelta:ne.text}),ne.signature&&v.enqueue({type:"reasoning-signature",signature:ne.signature});break}case"reasoning.encrypted":{ne.data&&v.enqueue({type:"redacted-reasoning",data:ne.data});break}case"reasoning.summary":{ne.summary&&v.enqueue({type:"reasoning",textDelta:ne.summary});break}}const $=i$(U==null?void 0:U.logprobs);if($!=null&&$.length&&(h===void 0&&(h=[]),h.push(...$)),H.tool_calls!=null)for(const ne of H.tool_calls){const W=ne.index;if(c[W]==null){if(ne.type!=="function")throw new Id({data:ne,message:"Expected 'function' type."});if(ne.id==null)throw new Id({data:ne,message:"Expected 'id' to be a string."});if(((S=ne.function)==null?void 0:S.name)==null)throw new Id({data:ne,message:"Expected 'function.name' to be a string."});c[W]={id:ne.id,type:"function",function:{name:ne.function.name,arguments:(C=ne.function.arguments)!=null?C:""},sent:!1};const ee=c[W];if(ee==null)throw new Error("Tool call is missing");((k=ee.function)==null?void 0:k.name)!=null&&((A=ee.function)==null?void 0:A.arguments)!=null&&lm(ee.function.arguments)&&(v.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:ee.id,toolName:ee.function.name,argsTextDelta:ee.function.arguments}),v.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(R=ee.id)!=null?R:sa(),toolName:ee.function.name,args:ee.function.arguments}),ee.sent=!0);continue}const Q=c[W];if(Q==null)throw new Error("Tool call is missing");((N=ne.function)==null?void 0:N.arguments)!=null&&(Q.function.arguments+=(P=(I=ne.function)==null?void 0:I.arguments)!=null?P:""),v.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:Q.id,toolName:Q.function.name,argsTextDelta:(L=ne.function.arguments)!=null?L:""}),((O=Q.function)==null?void 0:O.name)!=null&&((V=Q.function)==null?void 0:V.arguments)!=null&&lm(Q.function.arguments)&&(v.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(D=Q.id)!=null?D:sa(),toolName:Q.function.name,args:Q.function.arguments}),Q.sent=!0)}},flush(b){var v;if(u==="tool-calls")for(const S of c)S.sent||(b.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(v=S.id)!=null?v:sa(),toolName:S.function.name,args:lm(S.function.arguments)?S.function.arguments:"{}"}),S.sent=!0);const x={};y&&(m.totalTokens!==void 0||m.cost!==void 0||m.promptTokensDetails!==void 0||m.completionTokensDetails!==void 0)&&(x.openrouter={usage:m});const w=Object.keys(x).length>0&&y;b.enqueue(Na({type:"finish",finishReason:u,logprobs:h,usage:d},w?{providerMetadata:x}:{}))}})),rawCall:{rawPrompt:o,rawSettings:l},rawResponse:{headers:s},warnings:[]}}},_G=Ke({id:$e().optional(),model:$e().optional(),usage:Ke({prompt_tokens:Tt(),prompt_tokens_details:Ke({cached_tokens:Tt()}).nullish(),completion_tokens:Tt(),completion_tokens_details:Ke({reasoning_tokens:Tt()}).nullish(),total_tokens:Tt(),cost:Tt().optional()}).nullish()}),vve=_G.extend({choices:on(Ke({message:Ke({role:An("assistant"),content:$e().nullable().optional(),reasoning:$e().nullable().optional(),reasoning_details:KP.nullish(),tool_calls:on(Ke({id:$e().optional().nullable(),type:An("function"),function:Ke({name:$e(),arguments:$e()})})).optional()}),index:Tt(),logprobs:Ke({content:on(Ke({token:$e(),logprob:Tt(),top_logprobs:on(Ke({token:$e(),logprob:Tt()}))})).nullable()}).nullable().optional(),finish_reason:$e().optional().nullable()}))}),xve=ps([_G.extend({choices:on(Ke({delta:Ke({role:bl(["assistant"]).optional(),content:$e().nullish(),reasoning:$e().nullish().optional(),reasoning_details:KP.nullish(),tool_calls:on(Ke({index:Tt(),id:$e().nullish(),type:An("function").optional(),function:Ke({name:$e().nullish(),arguments:$e().nullish()})})).nullish()}).nullish(),logprobs:Ke({content:on(Ke({token:$e(),logprob:Tt(),top_logprobs:on(Ke({token:$e(),logprob:Tt()}))})).nullable()}).nullish(),finish_reason:$e().nullable().optional(),index:Tt()}))}),YP]);function wve(e){var t;const n=(t=e.tools)!=null&&t.length?e.tools:void 0;if(n==null)return{tools:void 0,tool_choice:void 0};const r=n.map(a=>yve(a)?{type:"function",function:{name:a.name,description:a.description,parameters:a.parameters}}:{type:"function",function:{name:a.name}}),s=e.toolChoice;if(s==null)return{tools:r,tool_choice:void 0};const i=s.type;switch(i){case"auto":case"none":case"required":return{tools:r,tool_choice:i};case"tool":return{tools:r,tool_choice:{type:"function",function:{name:s.toolName}}};default:{const a=i;throw new Error(`Unsupported tool choice type: ${a}`)}}}function _ve({prompt:e,inputFormat:t,user:n="user",assistant:r="assistant"}){if(t==="prompt"&&e.length===1&&e[0]&&e[0].role==="user"&&e[0].content.length===1&&e[0].content[0]&&e[0].content[0].type==="text")return{prompt:e[0].content[0].text};let s="";e[0]&&e[0].role==="system"&&(s+=`${e[0].content}

`,e=e.slice(1));for(const{role:i,content:a}of e)switch(i){case"system":throw new yc({message:"Unexpected system message in prompt: ${content}",prompt:e});case"user":{const o=a.map(l=>{switch(l.type){case"text":return l.text;case"image":throw new hr({functionality:"images"});case"file":throw new hr({functionality:"file attachments"});default:{const c=l;throw new Error(`Unsupported content type: ${c}`)}}}).join("");s+=`${n}:
${o}

`;break}case"assistant":{const o=a.map(l=>{switch(l.type){case"text":return l.text;case"tool-call":throw new hr({functionality:"tool-call messages"});case"reasoning":throw new hr({functionality:"reasoning messages"});case"redacted-reasoning":throw new hr({functionality:"redacted reasoning messages"});case"file":throw new hr({functionality:"file attachments"});default:{const c=l;throw new Error(`Unsupported content type: ${c}`)}}}).join("");s+=`${r}:
${o}

`;break}case"tool":throw new hr({functionality:"tool messages"});default:{const o=i;throw new Error(`Unsupported role: ${o}`)}}return s+=`${r}:
`,{prompt:s}}function a$(e){return e==null?void 0:e.tokens.map((t,n)=>{var r,s;return{token:t,logprob:(r=e.token_logprobs[n])!=null?r:0,topLogprobs:e.top_logprobs?Object.entries((s=e.top_logprobs[n])!=null?s:{}).map(([i,a])=>({token:i,logprob:a})):[]}})}var Sve=class{constructor(e,t,n){this.specificationVersion="v1",this.defaultObjectGenerationMode=void 0,this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}getArgs({mode:e,inputFormat:t,prompt:n,maxTokens:r,temperature:s,topP:i,frequencyPenalty:a,presencePenalty:o,seed:l,responseFormat:c,topK:u,stopSequences:d,providerMetadata:h}){var m,y;const b=e.type,v=(m=h==null?void 0:h.openrouter)!=null?m:{},{prompt:x}=_ve({prompt:n,inputFormat:t}),w=Na(Na(Na({model:this.modelId,models:this.settings.models,logit_bias:this.settings.logitBias,logprobs:typeof this.settings.logprobs=="number"?this.settings.logprobs:typeof this.settings.logprobs=="boolean"&&this.settings.logprobs?0:void 0,suffix:this.settings.suffix,user:this.settings.user,max_tokens:r,temperature:s,top_p:i,frequency_penalty:a,presence_penalty:o,seed:l,stop:d,response_format:c,top_k:u,prompt:x,include_reasoning:this.settings.includeReasoning,reasoning:this.settings.reasoning},this.config.extraBody),this.settings.extraBody),v);switch(b){case"regular":{if((y=e.tools)!=null&&y.length)throw new hr({functionality:"tools"});if(e.toolChoice)throw new hr({functionality:"toolChoice"});return w}case"object-json":throw new hr({functionality:"object-json mode"});case"object-tool":throw new hr({functionality:"object-tool mode"});default:{const S=b;throw new hr({functionality:`${S} mode`})}}}async doGenerate(e){var t,n,r,s,i;const a=this.getArgs(e),{responseHeaders:o,value:l}=await Vs({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:qs(this.config.headers(),e.headers),body:a,failedResponseHandler:AC,successfulResponseHandler:$a(o$),abortSignal:e.abortSignal,fetch:this.config.fetch}),c=a,{prompt:u}=c,d=EC(c,["prompt"]);if("error"in l)throw new Error(`${l.error.message}`);const h=l.choices[0];if(!h)throw new Error("No choice in OpenRouter completion response");return{response:{id:l.id,modelId:l.model},text:(t=h.text)!=null?t:"",reasoning:h.reasoning||void 0,usage:{promptTokens:(r=(n=l.usage)==null?void 0:n.prompt_tokens)!=null?r:0,completionTokens:(i=(s=l.usage)==null?void 0:s.completion_tokens)!=null?i:0},finishReason:TC(h.finish_reason),logprobs:a$(h.logprobs),rawCall:{rawPrompt:u,rawSettings:d},rawResponse:{headers:o},warnings:[]}}async doStream(e){const t=this.getArgs(e),{responseHeaders:n,value:r}=await Vs({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:qs(this.config.headers(),e.headers),body:k2(Na({},this.getArgs(e)),{stream:!0,stream_options:this.config.compatibility==="strict"?{include_usage:!0}:void 0}),failedResponseHandler:AC,successfulResponseHandler:$h(o$),abortSignal:e.abortSignal,fetch:this.config.fetch}),s=t,{prompt:i}=s,a=EC(s,["prompt"]);let o="other",l={promptTokens:Number.NaN,completionTokens:Number.NaN},c;return{stream:r.pipeThrough(new TransformStream({transform(u,d){if(!u.success){o="error",d.enqueue({type:"error",error:u.error});return}const h=u.value;if("error"in h){o="error",d.enqueue({type:"error",error:h.error});return}h.usage!=null&&(l={promptTokens:h.usage.prompt_tokens,completionTokens:h.usage.completion_tokens});const m=h.choices[0];(m==null?void 0:m.finish_reason)!=null&&(o=TC(m.finish_reason)),(m==null?void 0:m.text)!=null&&d.enqueue({type:"text-delta",textDelta:m.text});const y=a$(m==null?void 0:m.logprobs);y!=null&&y.length&&(c===void 0&&(c=[]),c.push(...y))},flush(u){u.enqueue({type:"finish",finishReason:o,logprobs:c,usage:l})}})),rawCall:{rawPrompt:i,rawSettings:a},rawResponse:{headers:n},warnings:[]}}},o$=ps([Ke({id:$e().optional(),model:$e().optional(),choices:on(Ke({text:$e(),reasoning:$e().nullish().optional(),reasoning_details:KP.nullish(),finish_reason:$e().nullish(),index:Tt(),logprobs:Ke({tokens:on($e()),token_logprobs:on(Tt()),top_logprobs:on(bh($e(),Tt())).nullable()}).nullable().optional()})),usage:Ke({prompt_tokens:Tt(),completion_tokens:Tt()}).optional().nullable()}),YP]);function SG(e={}){var t,n,r;const s=(n=u1((t=e.baseURL)!=null?t:e.baseUrl))!=null?n:"https://openrouter.ai/api/v1",i=(r=e.compatibility)!=null?r:"compatible",a=()=>Na({Authorization:`Bearer ${VP({apiKey:e.apiKey,environmentVariableName:"OPENROUTER_API_KEY",description:"OpenRouter"})}`},e.headers),o=(d,h={})=>new bve(d,h,{provider:"openrouter.chat",url:({path:m})=>`${s}${m}`,headers:a,compatibility:i,fetch:e.fetch,extraBody:e.extraBody}),l=(d,h={})=>new Sve(d,h,{provider:"openrouter.completion",url:({path:m})=>`${s}${m}`,headers:a,compatibility:i,fetch:e.fetch,extraBody:e.extraBody}),c=(d,h)=>{if(new.target)throw new Error("The OpenRouter model function cannot be called with the new keyword.");return d==="openai/gpt-3.5-turbo-instruct"?l(d,h):o(d,h)},u=(d,h)=>c(d,h);return u.languageModel=c,u.chat=o,u.completion=l,u}SG({compatibility:"strict"});var Op={},gN={},l$;function c$(){return l$||(l$=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Allow=e.ALL=e.COLLECTION=e.ATOM=e.SPECIAL=e.INF=e._INFINITY=e.INFINITY=e.NAN=e.BOOL=e.NULL=e.OBJ=e.ARR=e.NUM=e.STR=void 0,e.STR=1,e.NUM=2,e.ARR=4,e.OBJ=8,e.NULL=16,e.BOOL=32,e.NAN=64,e.INFINITY=128,e._INFINITY=256,e.INF=e.INFINITY|e._INFINITY,e.SPECIAL=e.NULL|e.BOOL|e.INF|e.NAN,e.ATOM=e.STR|e.NUM|e.SPECIAL,e.COLLECTION=e.ARR|e.OBJ,e.ALL=e.ATOM|e.COLLECTION,e.Allow={STR:e.STR,NUM:e.NUM,ARR:e.ARR,OBJ:e.OBJ,NULL:e.NULL,BOOL:e.BOOL,NAN:e.NAN,INFINITY:e.INFINITY,_INFINITY:e._INFINITY,INF:e.INF,SPECIAL:e.SPECIAL,ATOM:e.ATOM,COLLECTION:e.COLLECTION,ALL:e.ALL},e.default=e.Allow}(gN)),gN}var u$;function Cve(){return u$||(u$=1,function(e){var t=Op&&Op.__createBinding||(Object.create?function(c,u,d,h){h===void 0&&(h=d);var m=Object.getOwnPropertyDescriptor(u,d);(!m||("get"in m?!u.__esModule:m.writable||m.configurable))&&(m={enumerable:!0,get:function(){return u[d]}}),Object.defineProperty(c,h,m)}:function(c,u,d,h){h===void 0&&(h=d),c[h]=u[d]}),n=Op&&Op.__exportStar||function(c,u){for(var d in c)d!=="default"&&!Object.prototype.hasOwnProperty.call(u,d)&&t(u,c,d)};Object.defineProperty(e,"__esModule",{value:!0}),e.Allow=e.MalformedJSON=e.PartialJSON=e.parseJSON=e.parse=void 0;const r=c$();Object.defineProperty(e,"Allow",{enumerable:!0,get:function(){return r.Allow}}),n(c$(),e);class s extends Error{}e.PartialJSON=s;class i extends Error{}e.MalformedJSON=i;function a(c,u=r.Allow.ALL){if(typeof c!="string")throw new TypeError(`expecting str, got ${typeof c}`);if(!c.trim())throw new Error(`${c} is empty`);return o(c.trim(),u)}e.parseJSON=a;const o=(c,u)=>{const d=c.length;let h=0;const m=k=>{throw new s(`${k} at position ${h}`)},y=k=>{throw new i(`${k} at position ${h}`)},b=()=>(C(),h>=d&&m("Unexpected end of input"),c[h]==='"'?v():c[h]==="{"?x():c[h]==="["?w():c.substring(h,h+4)==="null"||r.Allow.NULL&u&&d-h<4&&"null".startsWith(c.substring(h))?(h+=4,null):c.substring(h,h+4)==="true"||r.Allow.BOOL&u&&d-h<4&&"true".startsWith(c.substring(h))?(h+=4,!0):c.substring(h,h+5)==="false"||r.Allow.BOOL&u&&d-h<5&&"false".startsWith(c.substring(h))?(h+=5,!1):c.substring(h,h+8)==="Infinity"||r.Allow.INFINITY&u&&d-h<8&&"Infinity".startsWith(c.substring(h))?(h+=8,1/0):c.substring(h,h+9)==="-Infinity"||r.Allow._INFINITY&u&&1<d-h&&d-h<9&&"-Infinity".startsWith(c.substring(h))?(h+=9,-1/0):c.substring(h,h+3)==="NaN"||r.Allow.NAN&u&&d-h<3&&"NaN".startsWith(c.substring(h))?(h+=3,NaN):S()),v=()=>{const k=h;let A=!1;for(h++;h<d&&(c[h]!=='"'||A&&c[h-1]==="\\");)A=c[h]==="\\"?!A:!1,h++;if(c.charAt(h)=='"')try{return JSON.parse(c.substring(k,++h-Number(A)))}catch(R){y(String(R))}else if(r.Allow.STR&u)try{return JSON.parse(c.substring(k,h-Number(A))+'"')}catch{return JSON.parse(c.substring(k,c.lastIndexOf("\\"))+'"')}m("Unterminated string literal")},x=()=>{h++,C();const k={};try{for(;c[h]!=="}";){if(C(),h>=d&&r.Allow.OBJ&u)return k;const A=v();C(),h++;try{const R=b();k[A]=R}catch(R){if(r.Allow.OBJ&u)return k;throw R}C(),c[h]===","&&h++}}catch{if(r.Allow.OBJ&u)return k;m("Expected '}' at end of object")}return h++,k},w=()=>{h++;const k=[];try{for(;c[h]!=="]";)k.push(b()),C(),c[h]===","&&h++}catch{if(r.Allow.ARR&u)return k;m("Expected ']' at end of array")}return h++,k},S=()=>{if(h===0){c==="-"&&y("Not sure what '-' is");try{return JSON.parse(c)}catch(A){if(r.Allow.NUM&u)try{return JSON.parse(c.substring(0,c.lastIndexOf("e")))}catch{}y(String(A))}}const k=h;for(c[h]==="-"&&h++;c[h]&&",]}".indexOf(c[h])===-1;)h++;h==d&&!(r.Allow.NUM&u)&&m("Unterminated number literal");try{return JSON.parse(c.substring(k,h))}catch{c.substring(k,h)==="-"&&m("Not sure what '-' is");try{return JSON.parse(c.substring(k,c.lastIndexOf("e")))}catch(R){y(String(R))}}},C=()=>{for(;h<d&&` 
\r	`.includes(c[h]);)h++};return b()},l=a;e.parse=l}(Op)),Op}var kve=Cve();function yN(e){const t=[];for(const{content:n,role:r}of e)switch(r){case"system":{t.push({content:n,role:"system"});break}case"user":{t.push({...n.reduce((s,i)=>{if(i.type==="text")s.content+=i.text;else{if(i.type==="image"&&i.image instanceof URL)throw new hr({functionality:"Image URLs in user messages"});i.type==="image"&&i.image instanceof Uint8Array&&(s.images=s.images||[],s.images.push(Nu(i.image)))}return s},{content:""}),role:"user"});break}case"assistant":{const s=[],i=[];for(const a of n)switch(a.type){case"text":{s.push(a.text);break}case"tool-call":{i.push({function:{arguments:a.args,name:a.toolName},id:a.toolCallId,type:"function"});break}default:{const o=a;throw new Error(`Unsupported part: ${o}`)}}t.push({content:s.join(","),role:"assistant",tool_calls:i.length>0?i:void 0});break}case"tool":{t.push(...n.map(s=>({content:typeof s.result=="object"?JSON.stringify(s.result):`${s.result}`,role:"tool",tool_call_id:s.toolCallId})));break}default:{const s=r;throw new Error(`Unsupported role: ${s}`)}}return t}var Eve=class{constructor({tools:e,type:t}){this._firstMessage=!0,this._tools=e,this._toolPartial="",this._toolCalls=[],this._type=t,this._detectedToolCall=!1}get toolCalls(){return this._toolCalls}get detectedToolCall(){return this._detectedToolCall}parse({controller:e,delta:t}){var n;if(this.detectToolCall(t),!this._detectedToolCall)return!1;this._toolPartial+=t;let r=kve.parse(this._toolPartial);Array.isArray(r)||(r=[r]);for(const[s,i]of r.entries()){const a=(n=JSON.stringify(i==null?void 0:i.parameters))!=null?n:"";if(a==="")continue;this._toolCalls[s]||(this._toolCalls[s]={function:{arguments:"",name:i.name},id:sa(),type:"function"});const o=this._toolCalls[s];o.function.arguments=a,e.enqueue({argsTextDelta:t,toolCallId:o.id,toolCallType:"function",toolName:o.function.name,type:"tool-call-delta"})}return!0}finish({controller:e}){for(const t of this.toolCalls)e.enqueue({args:t.function.arguments,toolCallId:t.id,toolCallType:"function",toolName:t.function.name,type:"tool-call"});return this.finishReason()}detectToolCall(e){!this._tools||this._tools.length===0||this._firstMessage&&(this._type==="object-tool"?this._detectedToolCall=!0:this._type==="regular"&&(e.trim().startsWith("{")||e.trim().startsWith("["))&&(this._detectedToolCall=!0),this._firstMessage=!1)}finishReason(){return this.detectedToolCall?this._type==="object-tool"?"stop":"tool-calls":"stop"}};function Tve({finishReason:e,hasToolCalls:t}){switch(e){case"stop":return t?"tool-calls":"stop";default:return"other"}}var Ave=Ke({error:Ke({code:$e().nullable(),message:$e(),param:yh().nullable(),type:$e()})}),cj=Bh({errorSchema:Ave,errorToMessage:e=>e.error.message});function Rve({mode:e}){var t;const n=(t=e.tools)!=null&&t.length?e.tools:void 0,r=[],s=e.toolChoice;if(n===void 0)return{tools:void 0,toolWarnings:r};const i=[];for(const o of n)o.type==="provider-defined"?r.push({tool:o,type:"unsupported-tool"}):i.push({function:{description:o.description,name:o.name,parameters:o.parameters},type:"function"});if(s===void 0)return{tools:i,toolWarnings:r};const a=s.type;switch(a){case"auto":return{tools:i,toolWarnings:r};case"none":return{tools:void 0,toolWarnings:r};default:{const o=a;throw new hr({functionality:`Unsupported tool choice type: ${o}`})}}}function Nve(e){return Object.fromEntries(Object.entries(e).filter(([,t])=>t!==void 0))}var Mve=class extends TransformStream{constructor(){super({flush:e=>{this.buffer.length!==0&&e.enqueue(this.buffer)},transform:(e,t)=>{for(e=this.buffer+e;;){const n=e.indexOf(`
`);if(n===-1)break;t.enqueue(e.slice(0,n)),e=e.slice(n+1)}this.buffer=e}}),this.buffer=""}},Ive=e=>async({response:t})=>{const n=Oy(t);if(t.body===null)throw new jH({});return{responseHeaders:n,value:t.body.pipeThrough(new TextDecoderStream).pipeThrough(new Mve).pipeThrough(new TransformStream({transform(r,s){s.enqueue(vm({schema:e,text:r}))}}))}},jve=class{constructor(e,t,n){this.modelId=e,this.settings=t,this.config=n,this.specificationVersion="v1",this.defaultObjectGenerationMode="json",this.supportsImageUrls=!1}get supportsStructuredOutputs(){var e;return(e=this.settings.structuredOutputs)!=null?e:!1}get provider(){return this.config.provider}getArguments({frequencyPenalty:e,maxTokens:t,mode:n,presencePenalty:r,prompt:s,responseFormat:i,seed:a,stopSequences:o,temperature:l,topK:c,topP:u}){const d=n.type,h=[];i!==void 0&&i.type==="json"&&i.schema!==void 0&&!this.supportsStructuredOutputs&&h.push({details:"JSON response format schema is only supported with structuredOutputs",setting:"responseFormat",type:"unsupported-setting"});const m={format:i==null?void 0:i.type,model:this.modelId,options:Nve({f16_kv:this.settings.f16Kv,frequency_penalty:e,low_vram:this.settings.lowVram,main_gpu:this.settings.mainGpu,min_p:this.settings.minP,mirostat:this.settings.mirostat,mirostat_eta:this.settings.mirostatEta,mirostat_tau:this.settings.mirostatTau,num_batch:this.settings.numBatch,num_ctx:this.settings.numCtx,num_gpu:this.settings.numGpu,num_keep:this.settings.numKeep,num_predict:t,num_thread:this.settings.numThread,numa:this.settings.numa,penalize_newline:this.settings.penalizeNewline,presence_penalty:r,repeat_last_n:this.settings.repeatLastN,repeat_penalty:this.settings.repeatPenalty,seed:a,stop:o,temperature:l,tfs_z:this.settings.tfsZ,top_k:c,top_p:u,typical_p:this.settings.typicalP,use_mlock:this.settings.useMlock,use_mmap:this.settings.useMmap,vocab_only:this.settings.vocabOnly})};switch(d){case"regular":{const{tools:y,toolWarnings:b}=Rve({mode:n});return{args:{...m,messages:yN(s),tools:y},type:d,warnings:[...h,...b]}}case"object-json":return{args:{...m,format:this.supportsStructuredOutputs&&n.schema!==void 0?n.schema:"json",messages:yN(s)},type:d,warnings:h};case"object-tool":return{args:{...m,messages:yN(s),tool_choice:{function:{name:n.tool.name},type:"function"},tools:[{function:{description:n.tool.description,name:n.tool.name,parameters:n.tool.parameters},type:"function"}]},type:d,warnings:h};default:{const y=d;throw new Error(`Unsupported type: ${y}`)}}}async doGenerate(e){var t,n;const{args:r,warnings:s}=this.getArguments(e),i={...r,stream:!1},{responseHeaders:a,value:o}=await Vs({abortSignal:e.abortSignal,body:i,failedResponseHandler:cj,fetch:this.config.fetch,headers:qs(this.config.headers(),e.headers),successfulResponseHandler:$a(Pve),url:`${this.config.baseURL}/chat`}),{messages:l,...c}=i,u=(t=o.message.tool_calls)==null?void 0:t.map(d=>{var h;return{args:JSON.stringify(d.function.arguments),toolCallId:(h=d.id)!=null?h:sa(),toolCallType:"function",toolName:d.function.name}});return{finishReason:Tve({finishReason:o.done_reason,hasToolCalls:u!==void 0&&u.length>0}),rawCall:{rawPrompt:l,rawSettings:c},rawResponse:{headers:a},request:{body:JSON.stringify(i)},text:(n=o.message.content)!=null?n:void 0,toolCalls:u,usage:{completionTokens:o.eval_count||0,promptTokens:o.prompt_eval_count||0},warnings:s}}async doStream(e){if(this.settings.simulateStreaming){const m=await this.doGenerate(e),y=new ReadableStream({start(b){if(b.enqueue({type:"response-metadata",...m.response}),m.text&&b.enqueue({textDelta:m.text,type:"text-delta"}),m.toolCalls)for(const v of m.toolCalls)b.enqueue({argsTextDelta:v.args,toolCallId:v.toolCallId,toolCallType:"function",toolName:v.toolName,type:"tool-call-delta"}),b.enqueue({type:"tool-call",...v});b.enqueue({finishReason:m.finishReason,logprobs:m.logprobs,providerMetadata:m.providerMetadata,type:"finish",usage:m.usage}),b.close()}});return{rawCall:m.rawCall,rawResponse:m.rawResponse,stream:y,warnings:m.warnings}}const{args:t,type:n,warnings:r}=this.getArguments(e),{responseHeaders:s,value:i}=await Vs({abortSignal:e.abortSignal,body:t,failedResponseHandler:cj,fetch:this.config.fetch,headers:qs(this.config.headers(),e.headers),successfulResponseHandler:Ive(Ove),url:`${this.config.baseURL}/chat`}),{messages:a,...o}=t,l=e.mode.type==="regular"?e.mode.tools:e.mode.type==="object-tool"?[e.mode.tool]:void 0,c=new Eve({tools:l,type:n});let u="other",d={completionTokens:Number.NaN,promptTokens:Number.NaN};const{experimentalStreamTools:h=!0}=this.settings;return{rawCall:{rawPrompt:a,rawSettings:o},rawResponse:{headers:s},request:{body:JSON.stringify(t)},stream:i.pipeThrough(new TransformStream({async flush(m){m.enqueue({finishReason:u,type:"finish",usage:d})},async transform(m,y){if(!m.success){y.enqueue({error:m.error,type:"error"});return}const b=m.value;if(b.done){u=c.finish({controller:y}),d={completionTokens:b.eval_count,promptTokens:b.prompt_eval_count||0};return}h&&c.parse({controller:y,delta:b.message.content})||b.message.content!==null&&y.enqueue({textDelta:b.message.content,type:"text-delta"})}})),warnings:r}}},Pve=Ke({created_at:$e(),done:An(!0),done_reason:$e().optional().nullable(),eval_count:Tt(),eval_duration:Tt(),load_duration:Tt().optional(),message:Ke({content:$e(),role:$e(),tool_calls:on(Ke({function:Ke({arguments:bh(yh()),name:$e()}),id:$e().optional()})).optional().nullable()}),model:$e(),prompt_eval_count:Tt().optional(),prompt_eval_duration:Tt().optional(),total_duration:Tt()}),Ove=_E("done",[Ke({created_at:$e(),done:An(!1),message:Ke({content:$e(),role:$e()}),model:$e()}),Ke({created_at:$e(),done:An(!0),eval_count:Tt(),eval_duration:Tt(),load_duration:Tt().optional(),model:$e(),prompt_eval_count:Tt().optional(),prompt_eval_duration:Tt().optional(),total_duration:Tt()})]),Dve=class{constructor(e,t,n){this.specificationVersion="v1",this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}get maxEmbeddingsPerCall(){var e;return(e=this.settings.maxEmbeddingsPerCall)!=null?e:2048}get supportsParallelCalls(){return!1}async doEmbed({abortSignal:e,values:t}){if(t.length>this.maxEmbeddingsPerCall)throw new bE({maxEmbeddingsPerCall:this.maxEmbeddingsPerCall,modelId:this.modelId,provider:this.provider,values:t});const{responseHeaders:n,value:r}=await Vs({abortSignal:e,body:{input:t,model:this.modelId},failedResponseHandler:cj,fetch:this.config.fetch,headers:this.config.headers(),successfulResponseHandler:$a(Fve),url:`${this.config.baseURL}/embed`});return{embeddings:r.embeddings,rawResponse:{headers:n},usage:r.prompt_eval_count?{tokens:r.prompt_eval_count}:void 0}}},Fve=Ke({embeddings:on(on(Tt())),prompt_eval_count:Tt().nullable()});function CG(e={}){var t;const n=(t=u1(e.baseURL))!=null?t:"http://127.0.0.1:11434/api",r=()=>({...e.headers}),s=(o,l={})=>new jve(o,l,{baseURL:n,fetch:e.fetch,headers:r,provider:"ollama.chat"}),i=(o,l={})=>new Dve(o,l,{baseURL:n,fetch:e.fetch,headers:r,provider:"ollama.embedding"}),a=function(o,l){if(new.target)throw new Error("The Ollama model function cannot be called with the new keyword.");return s(o,l)};return a.chat=s,a.embedding=i,a.languageModel=s,a.textEmbedding=i,a.textEmbeddingModel=i,a}CG();function Ev(e){var t,n;return(n=(t=e==null?void 0:e.providerMetadata)==null?void 0:t.openaiCompatible)!=null?n:{}}function Lve(e){const t=[];for(const{role:n,content:r,...s}of e){const i=Ev({...s});switch(n){case"system":{t.push({role:"system",content:r,...i});break}case"user":{if(r.length===1&&r[0].type==="text"){t.push({role:"user",content:r[0].text,...Ev(r[0])});break}t.push({role:"user",content:r.map(a=>{var o;const l=Ev(a);switch(a.type){case"text":return{type:"text",text:a.text,...l};case"image":return{type:"image_url",image_url:{url:a.image instanceof URL?a.image.toString():`data:${(o=a.mimeType)!=null?o:"image/jpeg"};base64,${Nu(a.image)}`},...l};case"file":throw new hr({functionality:"File content parts in user messages"})}}),...i});break}case"assistant":{let a="";const o=[];for(const l of r){const c=Ev(l);switch(l.type){case"text":{a+=l.text;break}case"tool-call":{o.push({id:l.toolCallId,type:"function",function:{name:l.toolName,arguments:JSON.stringify(l.args)},...c});break}}}t.push({role:"assistant",content:a,tool_calls:o.length>0?o:void 0,...i});break}case"tool":{for(const a of r){const o=Ev(a);t.push({role:"tool",tool_call_id:a.toolCallId,content:JSON.stringify(a.result),...o})}break}default:{const a=n;throw new Error(`Unsupported role: ${a}`)}}}return t}function RC({id:e,model:t,created:n}){return{id:e??void 0,modelId:t??void 0,timestamp:n!=null?new Date(n*1e3):void 0}}function NC(e){switch(e){case"stop":return"stop";case"length":return"length";case"content_filter":return"content-filter";case"function_call":case"tool_calls":return"tool-calls";default:return"unknown"}}var Bve=Ke({error:Ke({message:$e(),type:$e().nullish(),param:yh().nullish(),code:ps([$e(),Tt()]).nullish()})}),SE={errorSchema:Bve,errorToMessage:e=>e.error.message};function $ve({mode:e,structuredOutputs:t}){var n;const r=(n=e.tools)!=null&&n.length?e.tools:void 0,s=[];if(r==null)return{tools:void 0,tool_choice:void 0,toolWarnings:s};const i=e.toolChoice,a=[];for(const l of r)l.type==="provider-defined"?s.push({type:"unsupported-tool",tool:l}):a.push({type:"function",function:{name:l.name,description:l.description,parameters:l.parameters}});if(i==null)return{tools:a,tool_choice:void 0,toolWarnings:s};const o=i.type;switch(o){case"auto":case"none":case"required":return{tools:a,tool_choice:o,toolWarnings:s};case"tool":return{tools:a,tool_choice:{type:"function",function:{name:i.toolName}},toolWarnings:s};default:{const l=o;throw new hr({functionality:`Unsupported tool choice type: ${l}`})}}}var zve=class{constructor(e,t,n){this.specificationVersion="v1";var r,s;this.modelId=e,this.settings=t,this.config=n;const i=(r=n.errorStructure)!=null?r:SE;this.chunkSchema=qve(i.errorSchema),this.failedResponseHandler=Bh(i),this.supportsStructuredOutputs=(s=n.supportsStructuredOutputs)!=null?s:!1}get defaultObjectGenerationMode(){return this.config.defaultObjectGenerationMode}get provider(){return this.config.provider}get providerOptionsName(){return this.config.provider.split(".")[0].trim()}getArgs({mode:e,prompt:t,maxTokens:n,temperature:r,topP:s,topK:i,frequencyPenalty:a,presencePenalty:o,providerMetadata:l,stopSequences:c,responseFormat:u,seed:d}){var h,m,y,b,v;const x=e.type,w=[];i!=null&&w.push({type:"unsupported-setting",setting:"topK"}),(u==null?void 0:u.type)==="json"&&u.schema!=null&&!this.supportsStructuredOutputs&&w.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format schema is only supported with structuredOutputs"});const S={model:this.modelId,user:this.settings.user,max_tokens:n,temperature:r,top_p:s,frequency_penalty:a,presence_penalty:o,response_format:(u==null?void 0:u.type)==="json"?this.supportsStructuredOutputs===!0&&u.schema!=null?{type:"json_schema",json_schema:{schema:u.schema,name:(h=u.name)!=null?h:"response",description:u.description}}:{type:"json_object"}:void 0,stop:c,seed:d,...l==null?void 0:l[this.providerOptionsName],reasoning_effort:(b=(m=l==null?void 0:l[this.providerOptionsName])==null?void 0:m.reasoningEffort)!=null?b:(y=l==null?void 0:l["openai-compatible"])==null?void 0:y.reasoningEffort,messages:Lve(t)};switch(x){case"regular":{const{tools:C,tool_choice:k,toolWarnings:A}=$ve({mode:e,structuredOutputs:this.supportsStructuredOutputs});return{args:{...S,tools:C,tool_choice:k},warnings:[...w,...A]}}case"object-json":return{args:{...S,response_format:this.supportsStructuredOutputs===!0&&e.schema!=null?{type:"json_schema",json_schema:{schema:e.schema,name:(v=e.name)!=null?v:"response",description:e.description}}:{type:"json_object"}},warnings:w};case"object-tool":return{args:{...S,tool_choice:{type:"function",function:{name:e.tool.name}},tools:[{type:"function",function:{name:e.tool.name,description:e.tool.description,parameters:e.tool.parameters}}]},warnings:w};default:{const C=x;throw new Error(`Unsupported type: ${C}`)}}}async doGenerate(e){var t,n,r,s,i,a,o,l,c,u,d;const{args:h,warnings:m}=this.getArgs({...e}),y=JSON.stringify(h),{responseHeaders:b,value:v,rawValue:x}=await Vs({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:qs(this.config.headers(),e.headers),body:h,failedResponseHandler:this.failedResponseHandler,successfulResponseHandler:$a(Uve),abortSignal:e.abortSignal,fetch:this.config.fetch}),{messages:w,...S}=h,C=v.choices[0],k={[this.providerOptionsName]:{},...(n=(t=this.config.metadataExtractor)==null?void 0:t.extractMetadata)==null?void 0:n.call(t,{parsedBody:x})},A=(r=v.usage)==null?void 0:r.completion_tokens_details,R=(s=v.usage)==null?void 0:s.prompt_tokens_details;return(A==null?void 0:A.reasoning_tokens)!=null&&(k[this.providerOptionsName].reasoningTokens=A==null?void 0:A.reasoning_tokens),(A==null?void 0:A.accepted_prediction_tokens)!=null&&(k[this.providerOptionsName].acceptedPredictionTokens=A==null?void 0:A.accepted_prediction_tokens),(A==null?void 0:A.rejected_prediction_tokens)!=null&&(k[this.providerOptionsName].rejectedPredictionTokens=A==null?void 0:A.rejected_prediction_tokens),(R==null?void 0:R.cached_tokens)!=null&&(k[this.providerOptionsName].cachedPromptTokens=R==null?void 0:R.cached_tokens),{text:(i=C.message.content)!=null?i:void 0,reasoning:(a=C.message.reasoning_content)!=null?a:void 0,toolCalls:(o=C.message.tool_calls)==null?void 0:o.map(N=>{var I;return{toolCallType:"function",toolCallId:(I=N.id)!=null?I:sa(),toolName:N.function.name,args:N.function.arguments}}),finishReason:NC(C.finish_reason),usage:{promptTokens:(c=(l=v.usage)==null?void 0:l.prompt_tokens)!=null?c:NaN,completionTokens:(d=(u=v.usage)==null?void 0:u.completion_tokens)!=null?d:NaN},providerMetadata:k,rawCall:{rawPrompt:w,rawSettings:S},rawResponse:{headers:b,body:x},response:RC(v),warnings:m,request:{body:y}}}async doStream(e){var t;if(this.settings.simulateStreaming){const b=await this.doGenerate(e);return{stream:new ReadableStream({start(x){if(x.enqueue({type:"response-metadata",...b.response}),b.reasoning)if(Array.isArray(b.reasoning))for(const w of b.reasoning)w.type==="text"&&x.enqueue({type:"reasoning",textDelta:w.text});else x.enqueue({type:"reasoning",textDelta:b.reasoning});if(b.text&&x.enqueue({type:"text-delta",textDelta:b.text}),b.toolCalls)for(const w of b.toolCalls)x.enqueue({type:"tool-call",...w});x.enqueue({type:"finish",finishReason:b.finishReason,usage:b.usage,logprobs:b.logprobs,providerMetadata:b.providerMetadata}),x.close()}}),rawCall:b.rawCall,rawResponse:b.rawResponse,warnings:b.warnings}}const{args:n,warnings:r}=this.getArgs({...e}),s={...n,stream:!0,stream_options:this.config.includeUsage?{include_usage:!0}:void 0},i=(t=this.config.metadataExtractor)==null?void 0:t.createStreamExtractor(),{responseHeaders:a,value:o}=await Vs({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:qs(this.config.headers(),e.headers),body:s,failedResponseHandler:this.failedResponseHandler,successfulResponseHandler:$h(this.chunkSchema),abortSignal:e.abortSignal,fetch:this.config.fetch}),{messages:l,...c}=n,u=[];let d="unknown",h={completionTokens:void 0,completionTokensDetails:{reasoningTokens:void 0,acceptedPredictionTokens:void 0,rejectedPredictionTokens:void 0},promptTokens:void 0,promptTokensDetails:{cachedTokens:void 0}},m=!0,y=this.providerOptionsName;return{stream:o.pipeThrough(new TransformStream({transform(b,v){var x,w,S,C,k,A,R,N,I,P,L,O;if(!b.success){d="error",v.enqueue({type:"error",error:b.error});return}const V=b.value;if(i==null||i.processChunk(b.rawValue),"error"in V){d="error",v.enqueue({type:"error",error:V.error.message});return}if(m&&(m=!1,v.enqueue({type:"response-metadata",...RC(V)})),V.usage!=null){const{prompt_tokens:U,completion_tokens:H,prompt_tokens_details:$,completion_tokens_details:ne}=V.usage;h.promptTokens=U??void 0,h.completionTokens=H??void 0,(ne==null?void 0:ne.reasoning_tokens)!=null&&(h.completionTokensDetails.reasoningTokens=ne==null?void 0:ne.reasoning_tokens),(ne==null?void 0:ne.accepted_prediction_tokens)!=null&&(h.completionTokensDetails.acceptedPredictionTokens=ne==null?void 0:ne.accepted_prediction_tokens),(ne==null?void 0:ne.rejected_prediction_tokens)!=null&&(h.completionTokensDetails.rejectedPredictionTokens=ne==null?void 0:ne.rejected_prediction_tokens),($==null?void 0:$.cached_tokens)!=null&&(h.promptTokensDetails.cachedTokens=$==null?void 0:$.cached_tokens)}const D=V.choices[0];if((D==null?void 0:D.finish_reason)!=null&&(d=NC(D.finish_reason)),(D==null?void 0:D.delta)==null)return;const Z=D.delta;if(Z.reasoning_content!=null&&v.enqueue({type:"reasoning",textDelta:Z.reasoning_content}),Z.content!=null&&v.enqueue({type:"text-delta",textDelta:Z.content}),Z.tool_calls!=null)for(const U of Z.tool_calls){const H=U.index;if(u[H]==null){if(U.type!=="function")throw new Id({data:U,message:"Expected 'function' type."});if(U.id==null)throw new Id({data:U,message:"Expected 'id' to be a string."});if(((x=U.function)==null?void 0:x.name)==null)throw new Id({data:U,message:"Expected 'function.name' to be a string."});u[H]={id:U.id,type:"function",function:{name:U.function.name,arguments:(w=U.function.arguments)!=null?w:""},hasFinished:!1};const ne=u[H];((S=ne.function)==null?void 0:S.name)!=null&&((C=ne.function)==null?void 0:C.arguments)!=null&&(ne.function.arguments.length>0&&v.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:ne.id,toolName:ne.function.name,argsTextDelta:ne.function.arguments}),lm(ne.function.arguments)&&(v.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(k=ne.id)!=null?k:sa(),toolName:ne.function.name,args:ne.function.arguments}),ne.hasFinished=!0));continue}const $=u[H];$.hasFinished||(((A=U.function)==null?void 0:A.arguments)!=null&&($.function.arguments+=(N=(R=U.function)==null?void 0:R.arguments)!=null?N:""),v.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:$.id,toolName:$.function.name,argsTextDelta:(I=U.function.arguments)!=null?I:""}),((P=$.function)==null?void 0:P.name)!=null&&((L=$.function)==null?void 0:L.arguments)!=null&&lm($.function.arguments)&&(v.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(O=$.id)!=null?O:sa(),toolName:$.function.name,args:$.function.arguments}),$.hasFinished=!0))}},flush(b){var v,x;const w={[y]:{},...i==null?void 0:i.buildMetadata()};h.completionTokensDetails.reasoningTokens!=null&&(w[y].reasoningTokens=h.completionTokensDetails.reasoningTokens),h.completionTokensDetails.acceptedPredictionTokens!=null&&(w[y].acceptedPredictionTokens=h.completionTokensDetails.acceptedPredictionTokens),h.completionTokensDetails.rejectedPredictionTokens!=null&&(w[y].rejectedPredictionTokens=h.completionTokensDetails.rejectedPredictionTokens),h.promptTokensDetails.cachedTokens!=null&&(w[y].cachedPromptTokens=h.promptTokensDetails.cachedTokens),b.enqueue({type:"finish",finishReason:d,usage:{promptTokens:(v=h.promptTokens)!=null?v:NaN,completionTokens:(x=h.completionTokens)!=null?x:NaN},providerMetadata:w})}})),rawCall:{rawPrompt:l,rawSettings:c},rawResponse:{headers:a},warnings:r,request:{body:JSON.stringify(s)}}}},kG=Ke({prompt_tokens:Tt().nullish(),completion_tokens:Tt().nullish(),prompt_tokens_details:Ke({cached_tokens:Tt().nullish()}).nullish(),completion_tokens_details:Ke({reasoning_tokens:Tt().nullish(),accepted_prediction_tokens:Tt().nullish(),rejected_prediction_tokens:Tt().nullish()}).nullish()}).nullish(),Uve=Ke({id:$e().nullish(),created:Tt().nullish(),model:$e().nullish(),choices:on(Ke({message:Ke({role:An("assistant").nullish(),content:$e().nullish(),reasoning_content:$e().nullish(),tool_calls:on(Ke({id:$e().nullish(),type:An("function"),function:Ke({name:$e(),arguments:$e()})})).nullish()}),finish_reason:$e().nullish()})),usage:kG}),qve=e=>ps([Ke({id:$e().nullish(),created:Tt().nullish(),model:$e().nullish(),choices:on(Ke({delta:Ke({role:bl(["assistant"]).nullish(),content:$e().nullish(),reasoning_content:$e().nullish(),tool_calls:on(Ke({index:Tt(),id:$e().nullish(),type:An("function").nullish(),function:Ke({name:$e().nullish(),arguments:$e().nullish()})})).nullish()}).nullish(),finish_reason:$e().nullish()})),usage:kG}),e]);function Vve({prompt:e,inputFormat:t,user:n="user",assistant:r="assistant"}){if(t==="prompt"&&e.length===1&&e[0].role==="user"&&e[0].content.length===1&&e[0].content[0].type==="text")return{prompt:e[0].content[0].text};let s="";e[0].role==="system"&&(s+=`${e[0].content}

`,e=e.slice(1));for(const{role:i,content:a}of e)switch(i){case"system":throw new yc({message:"Unexpected system message in prompt: ${content}",prompt:e});case"user":{const o=a.map(l=>{switch(l.type){case"text":return l.text;case"image":throw new hr({functionality:"images"})}}).join("");s+=`${n}:
${o}

`;break}case"assistant":{const o=a.map(l=>{switch(l.type){case"text":return l.text;case"tool-call":throw new hr({functionality:"tool-call messages"})}}).join("");s+=`${r}:
${o}

`;break}case"tool":throw new hr({functionality:"tool messages"});default:{const o=i;throw new Error(`Unsupported role: ${o}`)}}return s+=`${r}:
`,{prompt:s,stopSequences:[`
${n}:`]}}var Wve=class{constructor(e,t,n){this.specificationVersion="v1",this.defaultObjectGenerationMode=void 0;var r;this.modelId=e,this.settings=t,this.config=n;const s=(r=n.errorStructure)!=null?r:SE;this.chunkSchema=Gve(s.errorSchema),this.failedResponseHandler=Bh(s)}get provider(){return this.config.provider}get providerOptionsName(){return this.config.provider.split(".")[0].trim()}getArgs({mode:e,inputFormat:t,prompt:n,maxTokens:r,temperature:s,topP:i,topK:a,frequencyPenalty:o,presencePenalty:l,stopSequences:c,responseFormat:u,seed:d,providerMetadata:h}){var m;const y=e.type,b=[];a!=null&&b.push({type:"unsupported-setting",setting:"topK"}),u!=null&&u.type!=="text"&&b.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format is not supported."});const{prompt:v,stopSequences:x}=Vve({prompt:n,inputFormat:t}),w=[...x??[],...c??[]],S={model:this.modelId,echo:this.settings.echo,logit_bias:this.settings.logitBias,suffix:this.settings.suffix,user:this.settings.user,max_tokens:r,temperature:s,top_p:i,frequency_penalty:o,presence_penalty:l,seed:d,...h==null?void 0:h[this.providerOptionsName],prompt:v,stop:w.length>0?w:void 0};switch(y){case"regular":{if((m=e.tools)!=null&&m.length)throw new hr({functionality:"tools"});if(e.toolChoice)throw new hr({functionality:"toolChoice"});return{args:S,warnings:b}}case"object-json":throw new hr({functionality:"object-json mode"});case"object-tool":throw new hr({functionality:"object-tool mode"});default:{const C=y;throw new Error(`Unsupported type: ${C}`)}}}async doGenerate(e){var t,n,r,s;const{args:i,warnings:a}=this.getArgs(e),{responseHeaders:o,value:l,rawValue:c}=await Vs({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:qs(this.config.headers(),e.headers),body:i,failedResponseHandler:this.failedResponseHandler,successfulResponseHandler:$a(Hve),abortSignal:e.abortSignal,fetch:this.config.fetch}),{prompt:u,...d}=i,h=l.choices[0];return{text:h.text,usage:{promptTokens:(n=(t=l.usage)==null?void 0:t.prompt_tokens)!=null?n:NaN,completionTokens:(s=(r=l.usage)==null?void 0:r.completion_tokens)!=null?s:NaN},finishReason:NC(h.finish_reason),rawCall:{rawPrompt:u,rawSettings:d},rawResponse:{headers:o,body:c},response:RC(l),warnings:a,request:{body:JSON.stringify(i)}}}async doStream(e){const{args:t,warnings:n}=this.getArgs(e),r={...t,stream:!0,stream_options:this.config.includeUsage?{include_usage:!0}:void 0},{responseHeaders:s,value:i}=await Vs({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:qs(this.config.headers(),e.headers),body:r,failedResponseHandler:this.failedResponseHandler,successfulResponseHandler:$h(this.chunkSchema),abortSignal:e.abortSignal,fetch:this.config.fetch}),{prompt:a,...o}=t;let l="unknown",c={promptTokens:Number.NaN,completionTokens:Number.NaN},u=!0;return{stream:i.pipeThrough(new TransformStream({transform(d,h){if(!d.success){l="error",h.enqueue({type:"error",error:d.error});return}const m=d.value;if("error"in m){l="error",h.enqueue({type:"error",error:m.error});return}u&&(u=!1,h.enqueue({type:"response-metadata",...RC(m)})),m.usage!=null&&(c={promptTokens:m.usage.prompt_tokens,completionTokens:m.usage.completion_tokens});const y=m.choices[0];(y==null?void 0:y.finish_reason)!=null&&(l=NC(y.finish_reason)),(y==null?void 0:y.text)!=null&&h.enqueue({type:"text-delta",textDelta:y.text})},flush(d){d.enqueue({type:"finish",finishReason:l,usage:c})}})),rawCall:{rawPrompt:a,rawSettings:o},rawResponse:{headers:s},warnings:n,request:{body:JSON.stringify(r)}}}},Hve=Ke({id:$e().nullish(),created:Tt().nullish(),model:$e().nullish(),choices:on(Ke({text:$e(),finish_reason:$e()})),usage:Ke({prompt_tokens:Tt(),completion_tokens:Tt()}).nullish()}),Gve=e=>ps([Ke({id:$e().nullish(),created:Tt().nullish(),model:$e().nullish(),choices:on(Ke({text:$e(),finish_reason:$e().nullish(),index:Tt()})),usage:Ke({prompt_tokens:Tt(),completion_tokens:Tt()}).nullish()}),e]),Kve=class{constructor(e,t,n){this.specificationVersion="v1",this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}get maxEmbeddingsPerCall(){var e;return(e=this.config.maxEmbeddingsPerCall)!=null?e:2048}get supportsParallelCalls(){var e;return(e=this.config.supportsParallelCalls)!=null?e:!0}async doEmbed({values:e,headers:t,abortSignal:n}){var r;if(e.length>this.maxEmbeddingsPerCall)throw new bE({provider:this.provider,modelId:this.modelId,maxEmbeddingsPerCall:this.maxEmbeddingsPerCall,values:e});const{responseHeaders:s,value:i}=await Vs({url:this.config.url({path:"/embeddings",modelId:this.modelId}),headers:qs(this.config.headers(),t),body:{model:this.modelId,input:e,encoding_format:"float",dimensions:this.settings.dimensions,user:this.settings.user},failedResponseHandler:Bh((r=this.config.errorStructure)!=null?r:SE),successfulResponseHandler:$a(Yve),abortSignal:n,fetch:this.config.fetch});return{embeddings:i.data.map(a=>a.embedding),usage:i.usage?{tokens:i.usage.prompt_tokens}:void 0,rawResponse:{headers:s}}}},Yve=Ke({data:on(Ke({embedding:on(Tt())})),usage:Ke({prompt_tokens:Tt()}).nullish()}),Zve=class{constructor(e,t,n){this.modelId=e,this.settings=t,this.config=n,this.specificationVersion="v1"}get maxImagesPerCall(){var e;return(e=this.settings.maxImagesPerCall)!=null?e:10}get provider(){return this.config.provider}async doGenerate({prompt:e,n:t,size:n,aspectRatio:r,seed:s,providerOptions:i,headers:a,abortSignal:o}){var l,c,u,d,h;const m=[];r!=null&&m.push({type:"unsupported-setting",setting:"aspectRatio",details:"This model does not support aspect ratio. Use `size` instead."}),s!=null&&m.push({type:"unsupported-setting",setting:"seed"});const y=(u=(c=(l=this.config._internal)==null?void 0:l.currentDate)==null?void 0:c.call(l))!=null?u:new Date,{value:b,responseHeaders:v}=await Vs({url:this.config.url({path:"/images/generations",modelId:this.modelId}),headers:qs(this.config.headers(),a),body:{model:this.modelId,prompt:e,n:t,size:n,...(d=i.openai)!=null?d:{},response_format:"b64_json",...this.settings.user?{user:this.settings.user}:{}},failedResponseHandler:Bh((h=this.config.errorStructure)!=null?h:SE),successfulResponseHandler:$a(Xve),abortSignal:o,fetch:this.config.fetch});return{images:b.data.map(x=>x.b64_json),warnings:m,response:{timestamp:y,modelId:this.modelId,headers:v}}}},Xve=Ke({data:on(Ke({b64_json:$e()}))});function Jve(e){const t=u1(e.baseURL),n=e.name,r=()=>({...e.apiKey&&{Authorization:`Bearer ${e.apiKey}`},...e.headers}),s=d=>({provider:`${n}.${d}`,url:({path:h})=>{const m=new URL(`${t}${h}`);return e.queryParams&&(m.search=new URLSearchParams(e.queryParams).toString()),m.toString()},headers:r,fetch:e.fetch}),i=(d,h={})=>a(d,h),a=(d,h={})=>new zve(d,h,{...s("chat"),defaultObjectGenerationMode:"tool"}),o=(d,h={})=>new Wve(d,h,s("completion")),l=(d,h={})=>new Kve(d,h,s("embedding")),c=(d,h={})=>new Zve(d,h,s("image")),u=(d,h)=>i(d,h);return u.languageModel=i,u.chatModel=a,u.completionModel=o,u.textEmbeddingModel=l,u.imageModel=c,u}const yx=(e,t)=>`${e}:${t}`,Cc=e=>{if(!e||!e.includes(":"))return{providerId:null,modelId:null};const t=e.split(":"),n=t[0],r=t.slice(1).join(":");return{providerId:n,modelId:r}},J0=e=>e==="openai"||e==="openrouter"||e==="google",MC=e=>e==="ollama"||e==="openai-compatible",cm=e=>e==="openai"||e==="openrouter"||e==="ollama"||e==="openai-compatible",wo=[{value:"openrouter",label:"OpenRouter"},{value:"openai",label:"OpenAI"},{value:"ollama",label:"Ollama"},{value:"openai-compatible",label:"OpenAI-Compatible (LMStudio, etc.)"},{value:"google",label:"Google Gemini"}],Qve={openai:[{id:"gpt-4o",name:"GPT-4o"},{id:"dall-e-3",name:"DALL-E 3"},{id:"dall-e-2",name:"DALL-E 2"},{id:"o3-mini",name:"o3-mini"},{id:"o4-mini",name:"o4-mini"},{id:"o4-mini-high",name:"o4-mini-high"},{id:"o3-mini-high",name:"o3-mini-high"},{id:"o3",name:"o3"},{id:"4.1",name:"4.1"},{id:"4.1-mini",name:"4.1-mini"},{id:"4.1-nano",name:"4.1-nano"},{id:"o3-pro",name:"o3-pro"},{id:"codex-mini",name:"codex-mini"}],google:[{id:"gemini-2.5-pro-preview",name:"Gemini 2.5 Pro Preview"},{id:"gemini-2.5-flash-preview-05-20:thinking",name:"Gemini 2.5 Flash Preview (Thinking)"},{id:"gemini-2.5-flash-preview",name:"Gemini 2.5 Flash Preview"},{id:"gemini-2.0-flash-001",name:"Gemini 2.0 Flash"}],openrouter:[],ollama:[{id:"llama3",name:"Llama 3 (Ollama)"}],"openai-compatible":[]},EG=e=>{try{const t=e.replace(/\/+$/,"");return/\/(v\d+(\.\d+)*)$/.test(t)?t:t+"/v1"}catch(t){return console.error("Error processing base URL:",e,t),e.replace(/\/+$/,"")}};function ZP(e,t,n){try{switch(e.type){case"openai":return mG({apiKey:n})(t);case"google":return vG({apiKey:n})(t);case"openrouter":const s=SG({apiKey:n,extraBody:{include_reasoning:!0}})(t),i=s.doStream.bind(s);return s.doStream=async function(a){const o=await i(a),l=o.stream.getReader(),c=new ReadableStream({async start(u){try{for(;;){const{done:d,value:h}=await l.read();if(d)break;u.enqueue(h)}}catch(d){d&&typeof d=="object"&&"message"in d&&typeof d.message=="string"&&d.message.includes("reading 'sent'")?console.warn("[OpenRouter Provider Bug] Caught toolCall.sent error, attempting graceful recovery"):u.error(d)}finally{u.close()}}});return{...o,stream:c}},s;case"ollama":return CG({baseURL:e.baseURL??void 0})(t);case"openai-compatible":if(!e.baseURL)throw new Error("Base URL required");return Jve({baseURL:EG(e.baseURL),apiKey:n,name:e.name||"Custom API"})(t);default:return console.warn(`Unsupported provider type: ${e.type}`),null}}catch(r){return console.error(`Failed instantiate model ${t} for ${e.name}:`,r),null}}function TG(e,t,n){const s=Nr.getState().getAllAvailableModelDefsForProvider(e.id).find(a=>a.id===t);if(!s){console.warn(`Model definition not found for ${t} in provider ${e.name}`);return}const i=ZP(e,t,n);if(!i){console.warn(`Failed to instantiate AI SDK instance for ${t} from provider ${e.name}`);return}return{id:yx(e.id,t),name:s.name,providerId:e.id,providerName:e.name,instance:i,metadata:s}}const AG={openai:["max_tokens","temperature","top_p","stop","presence_penalty","frequency_penalty","seed","logit_bias","response_format","tools","tool_choice","logprobs","top_logprobs"],google:["max_tokens","temperature","top_p","top_k","stop","tools","tool_choice"],ollama:["max_tokens","temperature","top_p","top_k","stop","presence_penalty","frequency_penalty","seed","repetition_penalty","response_format"],"openai-compatible":["max_tokens","temperature","top_p","stop","presence_penalty","frequency_penalty","seed","logit_bias","response_format","tools","tool_choice","logprobs","top_logprobs","repetition_penalty","min_p","top_k"],openrouter:[]},Tv=new Map,exe=5*60*1e3,txe=(e,t)=>{var i,a,o,l,c,u,d,h,m,y,b,v,x,w;const n=e.id||e.name,r=e.name||n,s={id:n,name:r,created:e.created??null,description:e.description??null,context_length:e.context_length??null,architecture:{modality:((i=e.architecture)==null?void 0:i.modality)??"text->text",input_modalities:((a=e.architecture)==null?void 0:a.input_modalities)??["text"],output_modalities:((o=e.architecture)==null?void 0:o.output_modalities)??["text"],tokenizer:((l=e.architecture)==null?void 0:l.tokenizer)??"Unknown",instruct_type:((c=e.architecture)==null?void 0:c.instruct_type)??null},pricing:{prompt:((u=e.pricing)==null?void 0:u.prompt)??"0",completion:((d=e.pricing)==null?void 0:d.completion)??"0",request:((h=e.pricing)==null?void 0:h.request)??"0",image:((m=e.pricing)==null?void 0:m.image)??"0",web_search:((y=e.pricing)==null?void 0:y.web_search)??"0",internal_reasoning:((b=e.pricing)==null?void 0:b.internal_reasoning)??"0"},top_provider:{context_length:((v=e.top_provider)==null?void 0:v.context_length)??e.context_length??null,max_completion_tokens:((x=e.top_provider)==null?void 0:x.max_completion_tokens)??null,is_moderated:((w=e.top_provider)==null?void 0:w.is_moderated)??!1},per_request_limits:e.per_request_limits??null,supported_parameters:e.supported_parameters??AG[t]??[]};return t==="ollama"?(s.context_length=s.context_length??4096,s.top_provider&&(s.top_provider.context_length=s.context_length),s.architecture&&(s.architecture.tokenizer="Ollama")):t==="openai"?(n.includes("gpt-4")&&(s.context_length=8192),n.includes("gpt-4-32k")&&(s.context_length=32768),n.includes("gpt-4-turbo")&&(s.context_length=128e3),n.includes("gpt-4o")&&(s.context_length=128e3),n.includes("gpt-3.5-turbo")&&(s.context_length=16385),s.top_provider&&(s.top_provider.context_length=s.context_length),s.architecture&&(s.architecture.tokenizer="OpenAI")):t==="google"?(n.includes("gemini-1.5")?s.context_length=1048576:n.includes("gemini")&&(s.context_length=32768),s.top_provider&&(s.top_provider.context_length=s.context_length),s.architecture&&(s.architecture.tokenizer="Google")):t==="openai-compatible"&&(s.context_length=s.context_length??4096,s.top_provider&&(s.top_provider.context_length=s.context_length),s.architecture&&(s.architecture.tokenizer="Compatible")),s};async function nxe(e,t){const n=`${e.id}-${e.baseURL||""}`,r=Tv.get(n);if(r)return console.log(`[ModelFetcher] Using cache for provider ${e.name} (ID: ${e.id})`),r;const s=(async()=>{var o,l,c;let i;const a={Accept:"application/json"};t&&(a.Authorization=`Bearer ${t}`);try{switch(e.type){case"openai":if(!t)throw new Error("API Key required for OpenAI");i="https://api.openai.com/v1/models";break;case"openrouter":if(!t)throw new Error("API Key required for OpenRouter");i="https://openrouter.ai/api/v1/models",a["HTTP-Referer"]=((o=globalThis.location)==null?void 0:o.origin)||"http://localhost:3000",a["X-Title"]="LiteChat";break;case"ollama":const u=((l=e.baseURL)==null?void 0:l.replace(/\/$/,""))||"http://localhost:11434";i=new URL("/api/tags",u).toString(),delete a.Authorization;break;case"openai-compatible":if(!e.baseURL)throw new Error("Base URL required for OpenAI-Compatible");const d=EG(e.baseURL);i=new URL("models",d.endsWith("/")?d:d+"/").toString();break;case"google":default:return console.log(`[ModelFetcher] Model fetching not supported via API for type: ${e.type}. Returning empty list.`),[]}}catch(u){return console.error(`[ModelFetcher] Error constructing URL for ${e.name}:`,u),je.error(`Invalid Base URL for ${e.name}: ${u instanceof Error?u.message:String(u)}`),[]}console.log(`[ModelFetcher] Fetching models for ${e.name} (Type: ${e.type}) from ${i}`);try{const u=await fetch(i,{headers:a});if(!u.ok){let y=`(${u.status} ${u.statusText})`;try{const b=await u.text();y=b||y;try{const v=JSON.parse(b);y=((c=v==null?void 0:v.error)==null?void 0:c.message)||(v==null?void 0:v.message)||y}catch{}}catch(b){console.warn("[ModelFetcher] Failed to read error response body:",b)}throw new Error(`API Error: ${y}`)}const d=await u.json();let h=[];if(e.type==="ollama"?h=d.models||[]:h=d.data||d||[],!Array.isArray(h))return console.warn(`[ModelFetcher] Unexpected non-array response for ${e.name}:`,d),[];const m=h.map(y=>txe(y,e.type));return m.sort((y,b)=>(y.name||y.id).localeCompare(b.name||b.id)),console.log(`[ModelFetcher] Fetched and mapped ${m.length} models for ${e.name}`),m}catch(u){const d=u instanceof Error?u.message:String(u);return console.error(`[ModelFetcher] Error fetching models for ${e.name}:`,d),je.error(`Failed to fetch models for ${e.name}: ${d}`),Tv.delete(n),[]}})();return Tv.set(n,s),setTimeout(()=>{Tv.get(n)===s&&(Tv.delete(n),console.log(`[ModelFetcher] Cache expired for provider ${e.name} (ID: ${e.id})`))},exe),s}const dr={initialDataLoaded:"provider.initial.data.loaded",configsChanged:"provider.configs.changed",apiKeysChanged:"provider.api.keys.changed",selectedModelChanged:"provider.selected.model.changed",globalModelSortOrderChanged:"provider.global.model.sort.order.changed",fetchStatusChanged:"provider.fetch.status.changed",globallyEnabledModelsUpdated:"provider.globally.enabled.models.updated",selectedModelForDetailsChanged:"provider.selected.model.for.details.changed",enableApiKeyManagementChanged:"provider.enable.api.key.management.changed",loadInitialDataRequest:"provider.load.initial.data.request",selectModelRequest:"provider.select.model.request",addApiKeyRequest:"provider.add.api.key.request",deleteApiKeyRequest:"provider.delete.api.key.request",addProviderConfigRequest:"provider.add.config.request",updateProviderConfigRequest:"provider.update.config.request",deleteProviderConfigRequest:"provider.delete.config.request",fetchModelsRequest:"provider.fetch.models.request",setGlobalModelSortOrderRequest:"provider.set.global.model.sort.order.request",setEnableApiKeyManagementRequest:"provider.set.enable.api.key.management.request",setSelectedModelForDetailsRequest:"provider.set.selected.model.for.details.request"},bN="provider:lastModelSelection",d$="provider:globalModelSortOrder",Nr=$o(zo((e,t)=>({dbProviderConfigs:[],dbApiKeys:[],selectedModelId:null,globalModelSortOrder:[],providerFetchStatus:{},isLoading:!0,error:null,enableApiKeyManagement:!0,_selectedModelForDetails:null,globallyEnabledModelDefinitions:[],_updateGloballyEnabledModelDefinitions:()=>{const{dbProviderConfigs:n,globalModelSortOrder:r}=t(),s=t().getAvailableModelListItems(),i=new Map(s.map(u=>[u.id,u])),a=new Set;n.forEach(u=>{u.isEnabled&&u.enabledModels&&u.enabledModels.forEach(d=>{a.add(yx(u.id,d))})});const o=[],l=new Set;r.forEach(u=>{if(a.has(u)){const d=i.get(u);d&&!l.has(u)&&(o.push(d),l.add(u))}});const c=s.filter(u=>a.has(u.id)&&!l.has(u.id)).sort((u,d)=>u.name.localeCompare(d.name));o.push(...c),e({globallyEnabledModelDefinitions:o}),Pe.emit(dr.globallyEnabledModelsUpdated,{models:o})},getGloballyEnabledModelDefinitions:()=>t().globallyEnabledModelDefinitions,createAiModelConfig:(n,r,s)=>{const a=t().getAllAvailableModelDefsForProvider(n.id).find(l=>l.id===r);if(!a){console.warn(`Model definition not found for ${r} in provider ${n.name}`);return}const o=ZP(n,r,s);if(!o){console.warn(`Failed to instantiate AI SDK instance for ${r} from provider ${n.name}`);return}return{id:yx(n.id,r),name:a.name,providerId:n.id,providerName:n.name,instance:o,metadata:a}},setEnableApiKeyManagement:n=>{e({enableApiKeyManagement:n}),Et.saveSetting("enableApiKeyManagement",n),Pe.emit(dr.enableApiKeyManagementChanged,{enabled:n})},loadInitialData:async()=>{e({isLoading:!0,error:null});try{const n=await Et.loadSetting("enableApiKeyManagement",!0),[r,s,i,a]=await Promise.all([Et.loadProviderConfigs(),Et.loadApiKeys(),Et.loadSetting(d$,[]),Et.loadSetting(bN,null)]);e({dbProviderConfigs:r,dbApiKeys:s,enableApiKeyManagement:n,globalModelSortOrder:i}),t()._updateGloballyEnabledModelDefinitions();const o=t().globallyEnabledModelDefinitions.map(d=>d.id),l=new Set(o);let c=a;c&&l.has(c)||(c=o[0]??null),e({selectedModelId:c,isLoading:!1}),await Et.saveSetting(bN,c),Pe.emit(dr.initialDataLoaded,{configs:r,apiKeys:s,selectedModelId:c,globalSortOrder:t().globalModelSortOrder}),t().selectedModelId!==c?t().selectModel(c):Pe.emit(dr.selectedModelChanged,{modelId:c})}catch(n){console.error("ProviderStore: Error loading initial data",n),e({isLoading:!1,error:"Failed to load provider data"}),je.error("Failed to load provider data")}},selectModel:n=>{t().selectedModelId!==n&&(e({selectedModelId:n}),Et.saveSetting(bN,n),Pe.emit(dr.selectedModelChanged,{modelId:n}))},addApiKey:async(n,r,s)=>{const i=Vi(),a=new Date,o={id:i,name:n,value:s,providerId:r,createdAt:a,updatedAt:a};try{return await Et.saveApiKey(o),e(l=>{l.dbApiKeys.push(o)}),je.success(`API Key "${n}" added.`),Pe.emit(dr.apiKeysChanged,{apiKeys:t().dbApiKeys}),i}catch(l){throw console.error("ProviderStore: Error adding API key",l),je.error(`Failed to add API Key: ${l instanceof Error?l.message:String(l)}`),l}},deleteApiKey:async n=>{var s;const r=((s=t().dbApiKeys.find(i=>i.id===n))==null?void 0:s.name)??"Unknown Key";try{await Et.deleteApiKey(n),e(i=>{i.dbApiKeys=i.dbApiKeys.filter(a=>a.id!==n),i.dbProviderConfigs=i.dbProviderConfigs.map(a=>a.apiKeyId===n?{...a,apiKeyId:null}:a)}),je.success(`API Key "${r}" deleted.`),Pe.emit(dr.apiKeysChanged,{apiKeys:t().dbApiKeys}),Pe.emit(dr.configsChanged,{providerConfigs:t().dbProviderConfigs})}catch(i){throw console.error("ProviderStore: Error deleting API key",i),je.error(`Failed to delete API Key: ${i instanceof Error?i.message:String(i)}`),i}},addProviderConfig:async n=>{const r=Vi(),s=new Date,i={id:r,createdAt:s,updatedAt:s,name:n.name,type:n.type,isEnabled:n.isEnabled??!0,apiKeyId:n.apiKeyId??null,baseURL:n.baseURL??null,enabledModels:n.enabledModels??null,autoFetchModels:n.autoFetchModels??!0,fetchedModels:n.fetchedModels??null,modelsLastFetchedAt:n.modelsLastFetchedAt??null};try{return await Et.saveProviderConfig(i),e(a=>{a.dbProviderConfigs.push(i)}),t()._updateGloballyEnabledModelDefinitions(),je.success(`Provider "${n.name}" added.`),Pe.emit(dr.configsChanged,{providerConfigs:t().dbProviderConfigs}),t().fetchModels(r).catch(a=>{console.warn(`[ProviderStore] Initial model fetch failed for new provider ${r}:`,a)}),r}catch(a){throw console.error("ProviderStore: Error adding provider config",a),je.error(`Failed to add Provider: ${a instanceof Error?a.message:String(a)}`),a}},updateProviderConfig:async(n,r)=>{const s=t().dbProviderConfigs.find(a=>a.id===n);if(!s)return;const i={...s,...r,fetchedModels:r.fetchedModels!==void 0?r.fetchedModels:s.fetchedModels,modelsLastFetchedAt:r.modelsLastFetchedAt!==void 0?r.modelsLastFetchedAt:s.modelsLastFetchedAt,updatedAt:new Date};try{await Et.saveProviderConfig(i),e(a=>{const o=a.dbProviderConfigs.findIndex(l=>l.id===n);o!==-1&&(a.dbProviderConfigs[o]=i)}),t()._updateGloballyEnabledModelDefinitions(),Pe.emit(dr.configsChanged,{providerConfigs:t().dbProviderConfigs})}catch(a){throw console.error("ProviderStore: Error updating provider config",a),je.error(`Failed to update Provider: ${a instanceof Error?a.message:String(a)}`),a}},deleteProviderConfig:async n=>{const r=t().dbProviderConfigs.find(i=>i.id===n);if(!r)return;const s=r.name;try{await Et.deleteProviderConfig(n),e(i=>{i.dbProviderConfigs=i.dbProviderConfigs.filter(a=>a.id!==n),delete i.providerFetchStatus[n]}),t()._updateGloballyEnabledModelDefinitions(),Pe.emit(dr.configsChanged,{providerConfigs:t().dbProviderConfigs}),je.success(`Provider "${s}" deleted.`)}catch(i){throw console.error("ProviderStore: Error deleting provider config",i),je.error(`Failed to delete Provider: ${i instanceof Error?i.message:String(i)}`),i}},fetchModels:async n=>{var s;const r=t().dbProviderConfigs.find(i=>i.id===n);if(!r){je.error("Provider configuration not found for fetching models.");return}if(t().providerFetchStatus[n]!=="fetching"){t()._setProviderFetchStatus(n,"fetching");try{const i=r.apiKeyId,a=(s=t().dbApiKeys.find(l=>l.id===i))==null?void 0:s.value,o=await nxe(r,a);await t().updateProviderConfig(n,{fetchedModels:o,modelsLastFetchedAt:new Date}),t()._setProviderFetchStatus(n,"success"),je.success(`Models fetched successfully for ${r.name}`)}catch(i){console.error(`Error fetching models for ${r.name}:`,i),t()._setProviderFetchStatus(n,"error")}}},setGlobalModelSortOrder:async n=>{const r=Array.from(new Set(n));e({globalModelSortOrder:r}),await Et.saveSetting(d$,r),t()._updateGloballyEnabledModelDefinitions(),Pe.emit(dr.globalModelSortOrderChanged,{ids:r});const s=t().selectedModelId,i=t().globallyEnabledModelDefinitions.map(o=>o.id),a=new Set(i);if(!s||!a.has(s)){const o=i[0]??null;o!==s&&t().selectModel(o)}},_setProviderFetchStatus:(n,r)=>{e(s=>{s.providerFetchStatus[n]=r}),Pe.emit(dr.fetchStatusChanged,{providerId:n,status:r})},setSelectedModelForDetails:n=>{e({_selectedModelForDetails:n}),Pe.emit(dr.selectedModelForDetailsChanged,{modelId:n})},getSelectedModel:()=>{const{selectedModelId:n}=t();if(!n)return;const{providerId:r,modelId:s}=Cc(n);if(!r||!s)return;const i=t().dbProviderConfigs.find(o=>o.id===r);if(!i)return;const a=t().dbApiKeys.find(o=>o.id===i.apiKeyId);return t().createAiModelConfig(i,s,a==null?void 0:a.value)},getApiKeyForProvider:n=>{var s;const r=t().dbProviderConfigs.find(i=>i.id===n);return(s=t().dbApiKeys.find(i=>i.id===(r==null?void 0:r.apiKeyId)))==null?void 0:s.value},getActiveProviders:()=>t().dbProviderConfigs.filter(n=>n.isEnabled).map(n=>{const r=t().getAllAvailableModelDefsForProvider(n.id);return{id:n.id,name:n.name,type:n.type,allAvailableModels:r}}),getAllAvailableModelDefsForProvider:n=>{const r=t().dbProviderConfigs.find(a=>a.id===n);if(!r)return[];if(r.fetchedModels&&r.fetchedModels.length>0)return[...r.fetchedModels];const s=r.type;return(Qve[s]||[]).map(a=>{let o="text->text",l=["text"],c=["text"];return(a.id.includes("dall-e")||a.id.includes("imagen")||a.id.includes("flux")||a.id.includes("stable-diffusion"))&&(o="text->image",l=["text"],c=["image"]),{id:a.id,name:a.name,context_length:4096,architecture:{modality:o,input_modalities:l,output_modalities:c},pricing:{prompt:"0",completion:"0"},top_provider:{context_length:4096},supported_parameters:AG[r.type]??[]}})},getAvailableModelListItems:()=>{const{dbProviderConfigs:n}=t(),r=[];return n.forEach(s=>{t().getAllAvailableModelDefsForProvider(s.id).forEach(a=>{var o,l,c;r.push({id:yx(s.id,a.id),name:a.name,providerId:s.id,providerName:s.name,metadataSummary:{context_length:((o=a.top_provider)==null?void 0:o.context_length)??a.context_length,supported_parameters:a.supported_parameters,input_modalities:(l=a.architecture)==null?void 0:l.input_modalities,output_modalities:(c=a.architecture)==null?void 0:c.output_modalities,pricing:a.pricing,description:a.description}})})}),r},getRegisteredActionHandlers:()=>{const n="providerStore",r=t();return[{eventName:dr.loadInitialDataRequest,handler:r.loadInitialData,storeId:n},{eventName:dr.selectModelRequest,handler:s=>r.selectModel(s.modelId),storeId:n},{eventName:dr.addApiKeyRequest,handler:s=>r.addApiKey(s.name,s.providerId,s.value).then(()=>{}),storeId:n},{eventName:dr.deleteApiKeyRequest,handler:s=>r.deleteApiKey(s.id),storeId:n},{eventName:dr.addProviderConfigRequest,handler:s=>r.addProviderConfig(s).then(()=>{}),storeId:n},{eventName:dr.updateProviderConfigRequest,handler:s=>r.updateProviderConfig(s.id,s.changes),storeId:n},{eventName:dr.deleteProviderConfigRequest,handler:s=>r.deleteProviderConfig(s.id),storeId:n},{eventName:dr.fetchModelsRequest,handler:s=>r.fetchModels(s.providerConfigId),storeId:n},{eventName:dr.setGlobalModelSortOrderRequest,handler:s=>r.setGlobalModelSortOrder(s.ids),storeId:n},{eventName:dr.setEnableApiKeyManagementRequest,handler:s=>r.setEnableApiKeyManagement(s.enabled),storeId:n},{eventName:dr.setSelectedModelForDetailsRequest,handler:s=>r.setSelectedModelForDetails(s.modelId),storeId:n}]}}))),sn={loaded:"settings.loaded",themeChanged:"settings.theme.changed",globalSystemPromptChanged:"settings.global.system.prompt.changed",temperatureChanged:"settings.temperature.changed",maxTokensChanged:"settings.max.tokens.changed",topPChanged:"settings.top.p.changed",topKChanged:"settings.top.k.changed",presencePenaltyChanged:"settings.presence.penalty.changed",frequencyPenaltyChanged:"settings.frequency.penalty.changed",enableAdvancedSettingsChanged:"settings.enable.advanced.settings.changed",enableStreamingMarkdownChanged:"settings.enable.streaming.markdown.changed",enableStreamingCodeBlockParsingChanged:"settings.enable.streaming.code.block.parsing.changed",foldStreamingCodeBlocksChanged:"settings.fold.streaming.code.blocks.changed",foldUserMessagesOnCompletionChanged:"settings.fold.user.messages.on.completion.changed",streamingRenderFpsChanged:"settings.streaming.render.fps.changed",gitUserNameChanged:"settings.git.user.name.changed",gitUserEmailChanged:"settings.git.user.email.changed",toolMaxStepsChanged:"settings.tool.max.steps.changed",prismThemeUrlChanged:"settings.prism.theme.url.changed",autoTitleEnabledChanged:"settings.auto.title.enabled.changed",autoTitleModelIdChanged:"settings.auto.title.model.id.changed",autoTitlePromptMaxLengthChanged:"settings.auto.title.prompt.max.length.changed",autoTitleIncludeFilesChanged:"settings.auto.title.include.files.changed",autoTitleIncludeRulesChanged:"settings.auto.title.include.rules.changed",customFontFamilyChanged:"settings.custom.font.family.changed",customFontSizeChanged:"settings.custom.font.size.changed",chatMaxWidthChanged:"settings.chat.max.width.changed",customThemeColorsChanged:"settings.custom.theme.colors.changed",autoScrollIntervalChanged:"settings.auto.scroll.interval.changed",enableAutoScrollOnStreamChanged:"settings.enable.auto.scroll.on.stream.changed",autoSyncOnStreamCompleteChanged:"settings.auto.sync.on.stream.complete.changed",autoInitializeReposOnStartupChanged:"settings.auto.initialize.repos.on.startup.changed",setThemeRequest:"settings.set.theme.request",setGlobalSystemPromptRequest:"settings.set.global.system.prompt.request",setTemperatureRequest:"settings.set.temperature.request",setMaxTokensRequest:"settings.set.max.tokens.request",setTopPRequest:"settings.set.top.p.request",setTopKRequest:"settings.set.top.k.request",setPresencePenaltyRequest:"settings.set.presence.penalty.request",setFrequencyPenaltyRequest:"settings.set.frequency.penalty.request",setEnableAdvancedSettingsRequest:"settings.set.enable.advanced.settings.request",setEnableStreamingMarkdownRequest:"settings.set.enable.streaming.markdown.request",setEnableStreamingCodeBlockParsingRequest:"settings.set.enable.streaming.code.block.parsing.request",setFoldStreamingCodeBlocksRequest:"settings.set.fold.streaming.code.blocks.request",setFoldUserMessagesOnCompletionRequest:"settings.set.fold.user.messages.on.completion.request",setStreamingRenderFpsRequest:"settings.set.streaming.render.fps.request",setGitUserNameRequest:"settings.set.git.user.name.request",setGitUserEmailRequest:"settings.set.git.user.email.request",setToolMaxStepsRequest:"settings.set.tool.max.steps.request",setPrismThemeUrlRequest:"settings.set.prism.theme.url.request",setAutoTitleEnabledRequest:"settings.set.auto.title.enabled.request",setAutoTitleModelIdRequest:"settings.set.auto.title.model.id.request",setAutoTitlePromptMaxLengthRequest:"settings.set.auto.title.prompt.max.length.request",setAutoTitleIncludeFilesRequest:"settings.set.auto.title.include.files.request",setAutoTitleIncludeRulesRequest:"settings.set.auto.title.include.rules.request",setCustomFontFamilyRequest:"settings.set.custom.font.family.request",setCustomFontSizeRequest:"settings.set.custom.font.size.request",setChatMaxWidthRequest:"settings.set.chat.max.width.request",setCustomThemeColorsRequest:"settings.set.custom.theme.colors.request",setCustomThemeColorRequest:"settings.set.custom.theme.color.request",setAutoScrollIntervalRequest:"settings.set.auto.scroll.interval.request",setEnableAutoScrollOnStreamRequest:"settings.set.enable.auto.scroll.on.stream.request",setAutoSyncOnStreamCompleteRequest:"settings.set.auto.sync.on.stream.complete.request",setAutoInitializeReposOnStartupRequest:"settings.set.auto.initialize.repos.on.startup.request",loadSettingsRequest:"settings.load.settings.request",resetGeneralSettingsRequest:"settings.reset.general.settings.request",resetAssistantSettingsRequest:"settings.reset.assistant.settings.request",resetThemeSettingsRequest:"settings.reset.theme.settings.request"},rxe=`You are a helpful AI assistant.

You are knowledgeable, friendly, and always strive to provide accurate and useful information. When you don't know something, you admit it honestly. You communicate clearly and concisely, adapting your tone to be appropriate for the context.

Key principles:
- Be helpful and respectful
- Provide accurate information
- Ask clarifying questions when needed
- Explain complex concepts clearly
- Acknowledge limitations honestly 

When creating gated blocks, if you can infer a filepath for it, you should create it as follow : 
\`\`\`language:relative/path/to/file.ext
The file content would be completely normal
\`\`\`

examples : 
\`\`\`jsx:src/components/button.jsx
export const Button = ({ children, onClick }) => {
  return <button onClick={onClick}>{children}</button>;
};
\`\`\`

\`\`\`markdown:readme.md
---
title: My Project
description: This is a project description
---

# My Project

This is a project description
\`\`\``,vN="system",xN=rxe,wN=.7,_N=null,SN=null,CN=null,kN=0,EN=0,f$=!0,TN=!0,AN=!0,RN=!1,NN=!1,MN=15,h$=null,p$=null,IN=5,jN=null,PN=!0,ON=null,DN=768,FN=!1,LN=!1,BN=null,$N=16,zN="max-w-7xl",UN=null,qN=1e3,VN=!0,m$=!1,g$=!1,yr=$o(zo((e,t)=>({theme:vN,globalSystemPrompt:xN,temperature:wN,maxTokens:_N,topP:SN,topK:CN,presencePenalty:kN,frequencyPenalty:EN,enableAdvancedSettings:f$,enableStreamingMarkdown:TN,enableStreamingCodeBlockParsing:AN,foldStreamingCodeBlocks:RN,foldUserMessagesOnCompletion:NN,streamingRenderFPS:MN,gitUserName:h$,gitUserEmail:p$,toolMaxSteps:IN,prismThemeUrl:jN,autoTitleEnabled:PN,autoTitleModelId:ON,autoTitlePromptMaxLength:DN,autoTitleIncludeFiles:FN,autoTitleIncludeRules:LN,customFontFamily:BN,customFontSize:$N,chatMaxWidth:zN,customThemeColors:UN,autoScrollInterval:qN,enableAutoScrollOnStream:VN,autoSyncOnStreamComplete:m$,autoInitializeReposOnStartup:g$,setTheme:n=>{e({theme:n}),Et.saveSetting("theme",n),Pe.emit(sn.themeChanged,{theme:n})},setGlobalSystemPrompt:n=>{e({globalSystemPrompt:n}),Et.saveSetting("globalSystemPrompt",n),Pe.emit(sn.globalSystemPromptChanged,{prompt:n})},setTemperature:n=>{e({temperature:n}),Et.saveSetting("temperature",n),Pe.emit(sn.temperatureChanged,{value:n})},setMaxTokens:n=>{e({maxTokens:n}),Et.saveSetting("maxTokens",n),Pe.emit(sn.maxTokensChanged,{value:n})},setTopP:n=>{e({topP:n}),Et.saveSetting("topP",n),Pe.emit(sn.topPChanged,{value:n})},setTopK:n=>{e({topK:n}),Et.saveSetting("topK",n),Pe.emit(sn.topKChanged,{value:n})},setPresencePenalty:n=>{e({presencePenalty:n}),Et.saveSetting("presencePenalty",n),Pe.emit(sn.presencePenaltyChanged,{value:n})},setFrequencyPenalty:n=>{e({frequencyPenalty:n}),Et.saveSetting("frequencyPenalty",n),Pe.emit(sn.frequencyPenaltyChanged,{value:n})},setEnableAdvancedSettings:n=>{e({enableAdvancedSettings:n}),Et.saveSetting("enableAdvancedSettings",n),Pe.emit(sn.enableAdvancedSettingsChanged,{enabled:n})},setEnableStreamingMarkdown:n=>{e({enableStreamingMarkdown:n}),Et.saveSetting("enableStreamingMarkdown",n),Pe.emit(sn.enableStreamingMarkdownChanged,{enabled:n})},setEnableStreamingCodeBlockParsing:n=>{e({enableStreamingCodeBlockParsing:n}),Et.saveSetting("enableStreamingCodeBlockParsing",n),Pe.emit(sn.enableStreamingCodeBlockParsingChanged,{enabled:n})},setFoldStreamingCodeBlocks:n=>{e({foldStreamingCodeBlocks:n}),Et.saveSetting("foldStreamingCodeBlocks",n),Pe.emit(sn.foldStreamingCodeBlocksChanged,{fold:n})},setFoldUserMessagesOnCompletion:n=>{e({foldUserMessagesOnCompletion:n}),Et.saveSetting("foldUserMessagesOnCompletion",n),Pe.emit(sn.foldUserMessagesOnCompletionChanged,{fold:n})},setStreamingRenderFPS:n=>{const r=Math.max(3,Math.min(60,n));e({streamingRenderFPS:r}),Et.saveSetting("streamingRenderFPS",r),Pe.emit(sn.streamingRenderFpsChanged,{fps:r})},setGitUserName:n=>{const r=(n==null?void 0:n.trim())||null;e({gitUserName:r}),Et.saveSetting("gitUserName",r),Pe.emit(sn.gitUserNameChanged,{name:r})},setGitUserEmail:n=>{const r=(n==null?void 0:n.trim())||null;e({gitUserEmail:r}),Et.saveSetting("gitUserEmail",r),Pe.emit(sn.gitUserEmailChanged,{email:r})},setToolMaxSteps:n=>{const r=Math.max(1,Math.min(20,n));e({toolMaxSteps:r}),Et.saveSetting("toolMaxSteps",r),Pe.emit(sn.toolMaxStepsChanged,{steps:r})},setPrismThemeUrl:n=>{const r=(n==null?void 0:n.trim())||null;e({prismThemeUrl:r}),Et.saveSetting("prismThemeUrl",r),Pe.emit(sn.prismThemeUrlChanged,{url:r})},setAutoTitleEnabled:n=>{e({autoTitleEnabled:n}),Et.saveSetting("autoTitleEnabled",n),Pe.emit(sn.autoTitleEnabledChanged,{enabled:n})},setAutoTitleModelId:n=>{e({autoTitleModelId:n}),Et.saveSetting("autoTitleModelId",n),Pe.emit(sn.autoTitleModelIdChanged,{modelId:n})},setAutoTitlePromptMaxLength:n=>{const r=Math.max(100,Math.min(4e3,n));e({autoTitlePromptMaxLength:r}),Et.saveSetting("autoTitlePromptMaxLength",r),Pe.emit(sn.autoTitlePromptMaxLengthChanged,{length:r})},setAutoTitleIncludeFiles:n=>{e({autoTitleIncludeFiles:n}),Et.saveSetting("autoTitleIncludeFiles",n),Pe.emit(sn.autoTitleIncludeFilesChanged,{include:n})},setAutoTitleIncludeRules:n=>{e({autoTitleIncludeRules:n}),Et.saveSetting("autoTitleIncludeRules",n),Pe.emit(sn.autoTitleIncludeRulesChanged,{include:n})},setCustomFontFamily:n=>{const r=(n==null?void 0:n.trim())||null;e({customFontFamily:r}),Et.saveSetting("customFontFamily",r),Pe.emit(sn.customFontFamilyChanged,{fontFamily:r})},setCustomFontSize:n=>{const r=n===null?null:Math.max(10,Math.min(24,n));e({customFontSize:r}),Et.saveSetting("customFontSize",r),Pe.emit(sn.customFontSizeChanged,{fontSize:r})},setChatMaxWidth:n=>{e({chatMaxWidth:n}),Et.saveSetting("chatMaxWidth",n),Pe.emit(sn.chatMaxWidthChanged,{maxWidth:n})},setCustomThemeColors:n=>{e({customThemeColors:n}),Et.saveSetting("customThemeColors",n),Pe.emit(sn.customThemeColorsChanged,{colors:n})},setCustomThemeColor:(n,r)=>{e(i=>{const o={...i.customThemeColors??{}};r===null||r.trim()===""?delete o[n]:o[n]=r.trim(),i.customThemeColors=Object.keys(o).length>0?o:null});const s=t().customThemeColors;Et.saveSetting("customThemeColors",s),Pe.emit(sn.customThemeColorsChanged,{colors:s})},setAutoScrollInterval:n=>{const r=Math.max(50,n);e({autoScrollInterval:r}),Et.saveSetting("autoScrollInterval",r),Pe.emit(sn.autoScrollIntervalChanged,{interval:r})},setEnableAutoScrollOnStream:n=>{e({enableAutoScrollOnStream:n}),Et.saveSetting("enableAutoScrollOnStream",n),Pe.emit(sn.enableAutoScrollOnStreamChanged,{enabled:n})},setAutoSyncOnStreamComplete:n=>{e({autoSyncOnStreamComplete:n}),Et.saveSetting("autoSyncOnStreamComplete",n),Pe.emit(sn.autoSyncOnStreamCompleteChanged,{enabled:n})},setAutoInitializeReposOnStartup:n=>{e({autoInitializeReposOnStartup:n}),Et.saveSetting("autoInitializeReposOnStartup",n),Pe.emit(sn.autoInitializeReposOnStartupChanged,{enabled:n})},loadSettings:async()=>{try{const[n,r,s,i,a,o,l,c,u,d,h,m,y,b,v,x,w,S,C,k,A,R,N,I,P,L,O,V,D,Z,U]=await Promise.all([Et.loadSetting("theme",vN),Et.loadSetting("temperature",wN),Et.loadSetting("maxTokens",_N),Et.loadSetting("topP",SN),Et.loadSetting("topK",CN),Et.loadSetting("presencePenalty",kN),Et.loadSetting("frequencyPenalty",EN),Et.loadSetting("globalSystemPrompt",xN),Et.loadSetting("enableAdvancedSettings",f$),Et.loadSetting("enableStreamingMarkdown",TN),Et.loadSetting("enableStreamingCodeBlockParsing",AN),Et.loadSetting("foldStreamingCodeBlocks",RN),Et.loadSetting("foldUserMessagesOnCompletion",NN),Et.loadSetting("streamingRenderFPS",MN),Et.loadSetting("gitUserName",h$),Et.loadSetting("gitUserEmail",p$),Et.loadSetting("toolMaxSteps",IN),Et.loadSetting("prismThemeUrl",jN),Et.loadSetting("autoTitleEnabled",PN),Et.loadSetting("autoTitleModelId",ON),Et.loadSetting("autoTitlePromptMaxLength",DN),Et.loadSetting("autoTitleIncludeFiles",FN),Et.loadSetting("autoTitleIncludeRules",LN),Et.loadSetting("customFontFamily",BN),Et.loadSetting("customFontSize",$N),Et.loadSetting("chatMaxWidth",zN),Et.loadSetting("customThemeColors",UN),Et.loadSetting("autoScrollInterval",qN),Et.loadSetting("enableAutoScrollOnStream",VN),Et.loadSetting("autoSyncOnStreamComplete",m$),Et.loadSetting("autoInitializeReposOnStartup",g$)]),H={theme:n,temperature:r,maxTokens:s,topP:i,topK:a,presencePenalty:o,frequencyPenalty:l,globalSystemPrompt:c,enableAdvancedSettings:u,enableStreamingMarkdown:d,enableStreamingCodeBlockParsing:h,foldStreamingCodeBlocks:m,foldUserMessagesOnCompletion:y,streamingRenderFPS:b,gitUserName:v,gitUserEmail:x,toolMaxSteps:w,prismThemeUrl:S,autoTitleEnabled:C,autoTitleModelId:k,autoTitlePromptMaxLength:A,autoTitleIncludeFiles:R,autoTitleIncludeRules:N,customFontFamily:I,customFontSize:P,chatMaxWidth:L,customThemeColors:O,autoScrollInterval:V,enableAutoScrollOnStream:D,autoSyncOnStreamComplete:Z,autoInitializeReposOnStartup:U};e(H),Pe.emit(sn.loaded,{settings:H})}catch(n){console.error("SettingsStore: Error loading settings",n),Pe.emit(sn.loaded,{settings:t()})}},resetGeneralSettings:async()=>{try{t().setEnableStreamingMarkdown(TN),t().setEnableStreamingCodeBlockParsing(AN),t().setFoldStreamingCodeBlocks(RN),t().setFoldUserMessagesOnCompletion(NN),t().setStreamingRenderFPS(MN),t().setAutoScrollInterval(qN),t().setEnableAutoScrollOnStream(VN),je.success("Streaming & Display settings reset to defaults.")}catch(n){console.error("SettingsStore: Error resetting general settings",n),je.error("Failed to reset general settings.")}},resetAssistantSettings:async()=>{try{t().setGlobalSystemPrompt(xN),t().setTemperature(wN),t().setMaxTokens(_N),t().setTopP(SN),t().setTopK(CN),t().setPresencePenalty(kN),t().setFrequencyPenalty(EN),t().setToolMaxSteps(IN),t().setAutoTitleEnabled(PN),t().setAutoTitleModelId(ON),t().setAutoTitlePromptMaxLength(DN),t().setAutoTitleIncludeFiles(FN),t().setAutoTitleIncludeRules(LN),je.success("Assistant settings reset to defaults.")}catch(n){console.error("SettingsStore: Error resetting assistant settings",n),je.error("Failed to reset assistant settings.")}},resetThemeSettings:async()=>{try{t().setTheme(vN),t().setPrismThemeUrl(jN),t().setCustomFontFamily(BN),t().setCustomFontSize($N),t().setChatMaxWidth(zN),t().setCustomThemeColors(UN),je.success("Theme settings reset to defaults.")}catch(n){console.error("SettingsStore: Error resetting theme settings",n),je.error("Failed to reset theme settings.")}},getRegisteredActionHandlers:()=>{const n="settingsStore",r=t();return[{eventName:sn.setThemeRequest,handler:s=>r.setTheme(s.theme),storeId:n},{eventName:sn.setGlobalSystemPromptRequest,handler:s=>r.setGlobalSystemPrompt(s.prompt),storeId:n},{eventName:sn.setTemperatureRequest,handler:s=>r.setTemperature(s.value),storeId:n},{eventName:sn.setMaxTokensRequest,handler:s=>r.setMaxTokens(s.value),storeId:n},{eventName:sn.setTopPRequest,handler:s=>r.setTopP(s.value),storeId:n},{eventName:sn.setTopKRequest,handler:s=>r.setTopK(s.value),storeId:n},{eventName:sn.setPresencePenaltyRequest,handler:s=>r.setPresencePenalty(s.value),storeId:n},{eventName:sn.setFrequencyPenaltyRequest,handler:s=>r.setFrequencyPenalty(s.value),storeId:n},{eventName:sn.setEnableAdvancedSettingsRequest,handler:s=>r.setEnableAdvancedSettings(s.enabled),storeId:n},{eventName:sn.setEnableStreamingMarkdownRequest,handler:s=>r.setEnableStreamingMarkdown(s.enabled),storeId:n},{eventName:sn.setEnableStreamingCodeBlockParsingRequest,handler:s=>r.setEnableStreamingCodeBlockParsing(s.enabled),storeId:n},{eventName:sn.setFoldStreamingCodeBlocksRequest,handler:s=>r.setFoldStreamingCodeBlocks(s.fold),storeId:n},{eventName:sn.setFoldUserMessagesOnCompletionRequest,handler:s=>r.setFoldUserMessagesOnCompletion(s.fold),storeId:n},{eventName:sn.setStreamingRenderFpsRequest,handler:s=>r.setStreamingRenderFPS(s.fps),storeId:n},{eventName:sn.setGitUserNameRequest,handler:s=>r.setGitUserName(s.name),storeId:n},{eventName:sn.setGitUserEmailRequest,handler:s=>r.setGitUserEmail(s.email),storeId:n},{eventName:sn.setToolMaxStepsRequest,handler:s=>r.setToolMaxSteps(s.steps),storeId:n},{eventName:sn.setPrismThemeUrlRequest,handler:s=>r.setPrismThemeUrl(s.url),storeId:n},{eventName:sn.setAutoTitleEnabledRequest,handler:s=>r.setAutoTitleEnabled(s.enabled),storeId:n},{eventName:sn.setAutoTitleModelIdRequest,handler:s=>r.setAutoTitleModelId(s.modelId),storeId:n},{eventName:sn.setAutoTitlePromptMaxLengthRequest,handler:s=>r.setAutoTitlePromptMaxLength(s.length),storeId:n},{eventName:sn.setAutoTitleIncludeFilesRequest,handler:s=>r.setAutoTitleIncludeFiles(s.include),storeId:n},{eventName:sn.setAutoTitleIncludeRulesRequest,handler:s=>r.setAutoTitleIncludeRules(s.include),storeId:n},{eventName:sn.setCustomFontFamilyRequest,handler:s=>r.setCustomFontFamily(s.fontFamily),storeId:n},{eventName:sn.setCustomFontSizeRequest,handler:s=>r.setCustomFontSize(s.fontSize),storeId:n},{eventName:sn.setChatMaxWidthRequest,handler:s=>r.setChatMaxWidth(s.maxWidth),storeId:n},{eventName:sn.setCustomThemeColorsRequest,handler:s=>r.setCustomThemeColors(s.colors),storeId:n},{eventName:sn.setCustomThemeColorRequest,handler:s=>r.setCustomThemeColor(s.colorKey,s.value),storeId:n},{eventName:sn.setAutoScrollIntervalRequest,handler:s=>r.setAutoScrollInterval(s.interval),storeId:n},{eventName:sn.setEnableAutoScrollOnStreamRequest,handler:s=>r.setEnableAutoScrollOnStream(s.enabled),storeId:n},{eventName:sn.setAutoSyncOnStreamCompleteRequest,handler:s=>r.setAutoSyncOnStreamComplete(s.enabled),storeId:n},{eventName:sn.setAutoInitializeReposOnStartupRequest,handler:s=>r.setAutoInitializeReposOnStartup(s.enabled),storeId:n},{eventName:sn.loadSettingsRequest,handler:()=>r.loadSettings(),storeId:n},{eventName:sn.resetGeneralSettingsRequest,handler:()=>r.resetGeneralSettings(),storeId:n},{eventName:sn.resetAssistantSettingsRequest,handler:()=>r.resetAssistantSettings(),storeId:n},{eventName:sn.resetThemeSettingsRequest,handler:()=>r.resetThemeSettings(),storeId:n}]}})));async function IC(e,t){const n=jo.getState().getMiddlewareForHook,r=n(e);let s=t;for(const i of r)try{const a=await i.callback(s);if(a===!1)return console.log(`Middleware ${i.modId} cancelled action for hook ${e}`),!1;a&&typeof a=="object"&&(s=a)}catch(a){return console.error(`Middleware error in mod ${i.modId} for hook ${e}:`,a),!1}return s}function y$(){const e=$n.getState(),t=Nr.getState(),n=yr.getState(),{providerId:r}=Cc(t.selectedModelId),s={selectedConversationId:e.currentConversationId,interactions:e.interactions,isStreaming:e.status==="streaming",selectedProviderId:r,selectedModelId:t.selectedModelId,activeSystemPrompt:n.globalSystemPrompt,temperature:n.temperature,maxTokens:n.maxTokens,theme:n.theme,gitUserName:n.gitUserName,gitUserEmail:n.gitUserEmail};return Object.freeze(s)}function sxe(e){try{const t=atob(e),n=t.length,r=new Uint8Array(n);for(let s=0;s<n;s++)r[s]=t.charCodeAt(s);return r}catch(t){throw console.error("Error decoding base64 string:",t),new Error("Invalid base64 string for file content.")}}function b$(e){try{const t=e.type||"application/octet-stream",n=Vx(e.name,t),r=t.startsWith("image/");if(e.contentBytes!==void 0)return n?{type:"text",text:new TextDecoder().decode(e.contentBytes)}:r?{type:"image",image:e.contentBytes,mimeType:t}:(console.warn(`AIService: Unsupported VFS file type "${t}" for direct inclusion. Sending note.`),{type:"text",text:`[Attached VFS file: ${e.name} (${t})]`});if(e.contentText!==void 0&&n)return{type:"text",text:e.contentText};if(e.contentBase64!==void 0&&r)return{type:"image",image:sxe(e.contentBase64),mimeType:t};if(e.contentBase64!==void 0&&!n&&!r)return console.warn(`AIService: Unsupported direct upload type "${t}" for direct inclusion. Sending note.`),{type:"text",text:`[Attached file: ${e.name} (${t})]`};throw n&&e.contentText===void 0?new Error(`Missing text content for likely text file: ${e.name}`):r&&e.contentBase64===void 0?new Error(`Missing base64 content for image file: ${e.name}`):new Error(`Missing or unusable content for file: ${e.name}`)}catch(t){return console.error(`AIService: Failed to process content for ${e.name}:`,t),je.error(`Failed to process file "${e.name}": ${t instanceof Error?t.message:String(t)}`),{type:"text",text:`[Error processing file: ${e.name}]`}}}function uj(e){return e.flatMap(t=>{var s,i,a;const n=[],r=t.prompt;if(r){const o=[];r.content&&o.push({type:"text",text:r.content}),(s=r.metadata)!=null&&s.attachedFiles&&r.metadata.attachedFiles.length>0&&r.metadata.attachedFiles.forEach(l=>{o.push({type:"text",text:`[User attached file: ${l.name}]`})}),o.length>0&&n.push({role:"user",content:o})}if(t.response&&typeof t.response=="string"&&n.push({role:"assistant",content:t.response}),(i=t.metadata)!=null&&i.toolCalls&&Array.isArray(t.metadata.toolCalls)){const o=[];t.metadata.toolCalls.forEach(l=>{try{const c=JSON.parse(l);c&&c.type==="tool-call"&&c.toolCallId&&c.toolName&&c.args!==void 0?o.push(c):console.warn("[AIService] buildHistory: Invalid tool call structure after parsing:",l)}catch(c){console.error("[AIService] buildHistory: Failed to parse tool call string:",l,c)}}),o.length>0&&n.push({role:"assistant",content:o})}if((a=t.metadata)!=null&&a.toolResults&&Array.isArray(t.metadata.toolResults)){const o=[];t.metadata.toolResults.forEach(l=>{try{const c=JSON.parse(l);c&&c.type==="tool-result"&&c.toolCallId&&c.toolName&&c.result!==void 0?o.push(c):console.warn("[AIService] buildHistory: Invalid tool result structure after parsing:",l)}catch(c){console.error("[AIService] buildHistory: Failed to parse tool result string:",l,c)}}),o.length>0&&n.push({role:"tool",content:o})}return n})}const v$=e=>Symbol.iterator in e,x$=e=>"entries"in e,w$=(e,t)=>{const n=e instanceof Map?e:new Map(e.entries()),r=t instanceof Map?t:new Map(t.entries());if(n.size!==r.size)return!1;for(const[s,i]of n)if(!Object.is(i,r.get(s)))return!1;return!0},ixe=(e,t)=>{const n=e[Symbol.iterator](),r=t[Symbol.iterator]();let s=n.next(),i=r.next();for(;!s.done&&!i.done;){if(!Object.is(s.value,i.value))return!1;s=n.next(),i=r.next()}return!!s.done&&!!i.done};function axe(e,t){return Object.is(e,t)?!0:typeof e!="object"||e===null||typeof t!="object"||t===null?!1:!v$(e)||!v$(t)?w$({entries:()=>Object.entries(e)},{entries:()=>Object.entries(t)}):x$(e)&&x$(t)?w$(e,t):ixe(e,t)}function yn(e){const t=We.useRef(void 0);return n=>{const r=e(n);return axe(t.current,r)?t.current:t.current=r}}var Q0=(e=>(e.PROMPT_TURN_FINALIZE="middleware.prompt.turnFinalize",e.INTERACTION_BEFORE_START="middleware.interaction.beforeStart",e.INTERACTION_PROCESS_CHUNK="middleware.interaction.processChunk",e))(Q0||{});const Nn={initialized:"prompt.state.initialized",parameterChanged:"prompt.state.parameter.changed",transientParametersReset:"prompt.state.transient.parameters.reset",inputTextStateChanged:"prompt.state.input.text.changed",submitted:"prompt.state.submitted",setModelIdRequest:"prompt.state.set.model.id.request",setTemperatureRequest:"prompt.state.set.temperature.request",setMaxTokensRequest:"prompt.state.set.max.tokens.request",setTopPRequest:"prompt.state.set.top.p.request",setTopKRequest:"prompt.state.set.top.k.request",setPresencePenaltyRequest:"prompt.state.set.presence.penalty.request",setFrequencyPenaltyRequest:"prompt.state.set.frequency.penalty.request",setReasoningEnabledRequest:"prompt.state.set.reasoning.enabled.request",setWebSearchEnabledRequest:"prompt.state.set.web.search.enabled.request",setImageGenerationEnabledRequest:"prompt.state.set.image.generation.enabled.request",setStructuredOutputJsonRequest:"prompt.state.set.structured.output.json.request",initializePromptStateRequest:"prompt.state.initialize.prompt.state.request",resetTransientParametersRequest:"prompt.state.reset.transient.parameters.request",setInputTextRequest:"prompt.input.set.text.request",inputChanged:"prompt.inputChanged"},cc=(e,t)=>{Pe.emit(Nn.parameterChanged,{params:{[e]:t}})},Po=$o(zo((e,t)=>({modelId:null,temperature:null,maxTokens:null,topP:null,topK:null,presencePenalty:null,frequencyPenalty:null,reasoningEnabled:null,webSearchEnabled:null,imageGenerationEnabled:null,structuredOutputJson:null,setModelId:n=>{t().modelId!==n&&(e({modelId:n}),cc("modelId",n))},setTemperature:n=>{t().temperature!==n&&(e({temperature:n}),cc("temperature",n))},setMaxTokens:n=>{t().maxTokens!==n&&(e({maxTokens:n}),cc("maxTokens",n))},setTopP:n=>{t().topP!==n&&(e({topP:n}),cc("topP",n))},setTopK:n=>{t().topK!==n&&(e({topK:n}),cc("topK",n))},setPresencePenalty:n=>{t().presencePenalty!==n&&(e({presencePenalty:n}),cc("presencePenalty",n))},setFrequencyPenalty:n=>{t().frequencyPenalty!==n&&(e({frequencyPenalty:n}),cc("frequencyPenalty",n))},setReasoningEnabled:n=>{t().reasoningEnabled!==n&&(e({reasoningEnabled:n}),cc("reasoningEnabled",n))},setWebSearchEnabled:n=>{t().webSearchEnabled!==n&&(e({webSearchEnabled:n}),cc("webSearchEnabled",n))},setImageGenerationEnabled:n=>{t().imageGenerationEnabled!==n&&(e({imageGenerationEnabled:n}),cc("imageGenerationEnabled",n))},setStructuredOutputJson:n=>{t().structuredOutputJson!==n&&(e({structuredOutputJson:n}),cc("structuredOutputJson",n))},initializePromptState:n=>{console.log("[PromptStateStore] Initializing with:",n);const r=t(),s={};let i=!1;r.modelId!==n.modelId&&(s.modelId=n.modelId,i=!0),r.temperature!==n.temperature&&(s.temperature=n.temperature,i=!0),r.maxTokens!==n.maxTokens&&(s.maxTokens=n.maxTokens,i=!0),r.topP!==n.topP&&(s.topP=n.topP,i=!0),r.topK!==n.topK&&(s.topK=n.topK,i=!0),r.presencePenalty!==n.presencePenalty&&(s.presencePenalty=n.presencePenalty,i=!0),r.frequencyPenalty!==n.frequencyPenalty&&(s.frequencyPenalty=n.frequencyPenalty,i=!0),i&&(e(s),Pe.emit(Nn.parameterChanged,{params:s})),Pe.emit(Nn.initialized,{state:{...t()}})},resetTransientParameters:()=>{console.log("[PromptStateStore] Resetting transient parameters.");const n=t(),r={};let s=!1;n.temperature!==null&&(r.temperature=null,s=!0),n.maxTokens!==null&&(r.maxTokens=null,s=!0),n.topP!==null&&(r.topP=null,s=!0),n.topK!==null&&(r.topK=null,s=!0),n.presencePenalty!==null&&(r.presencePenalty=null,s=!0),n.frequencyPenalty!==null&&(r.frequencyPenalty=null,s=!0),n.reasoningEnabled!==null&&(r.reasoningEnabled=null,s=!0),n.webSearchEnabled!==null&&(r.webSearchEnabled=null,s=!0),n.imageGenerationEnabled!==null&&(r.imageGenerationEnabled=null,s=!0),n.structuredOutputJson!==null&&(r.structuredOutputJson=null,s=!0),s&&(e(r),Pe.emit(Nn.parameterChanged,{params:r})),Pe.emit(Nn.transientParametersReset,void 0)},getRegisteredActionHandlers:()=>{const n="promptStateStore",r=t();return[{eventName:Nn.setModelIdRequest,handler:s=>r.setModelId(s.id),storeId:n},{eventName:Nn.setTemperatureRequest,handler:s=>r.setTemperature(s.value),storeId:n},{eventName:Nn.setMaxTokensRequest,handler:s=>r.setMaxTokens(s.value),storeId:n},{eventName:Nn.setTopPRequest,handler:s=>r.setTopP(s.value),storeId:n},{eventName:Nn.setTopKRequest,handler:s=>r.setTopK(s.value),storeId:n},{eventName:Nn.setPresencePenaltyRequest,handler:s=>r.setPresencePenalty(s.value),storeId:n},{eventName:Nn.setFrequencyPenaltyRequest,handler:s=>r.setFrequencyPenalty(s.value),storeId:n},{eventName:Nn.setReasoningEnabledRequest,handler:s=>r.setReasoningEnabled(s.enabled),storeId:n},{eventName:Nn.setWebSearchEnabledRequest,handler:s=>r.setWebSearchEnabled(s.enabled),storeId:n},{eventName:Nn.setImageGenerationEnabledRequest,handler:s=>r.setImageGenerationEnabled(s.enabled),storeId:n},{eventName:Nn.setStructuredOutputJsonRequest,handler:s=>r.setStructuredOutputJson(s.json),storeId:n},{eventName:Nn.initializePromptStateRequest,handler:s=>r.initializePromptState(s.effectiveSettings),storeId:n},{eventName:Nn.resetTransientParametersRequest,handler:()=>r.resetTransientParameters(),storeId:n}]}}))),oxe=({InputAreaRenderer:e,onSubmit:t,className:n,placeholder:r="Send a message...",inputAreaRef:s,selectedItemId:i,selectedItemType:a})=>{const[o,l]=T.useState(!1),[c,u]=T.useState(!1),d=jo(yn(k=>k.promptControls)),h=$n(yn(k=>k.status==="streaming")),{attachedFilesMetadata:m,clearAttachedFiles:y}=mh(yn(k=>({attachedFilesMetadata:k.attachedFilesMetadata,clearAttachedFiles:k.clearAttachedFiles}))),b=Po(k=>k.modelId);T.useEffect(()=>{a==="conversation"&&i&&requestAnimationFrame(()=>{var k;(k=s.current)==null||k.focus()})},[i,a,s]);const v=T.useMemo(()=>Object.values(d),[d]),x=T.useMemo(()=>v.filter(k=>k.renderer),[v]),w=T.useMemo(()=>v.filter(k=>k.triggerRenderer),[v]),S=T.useCallback(async()=>{var N,I;const A=(((N=s==null?void 0:s.current)==null?void 0:N.getValue())??"").trim(),R=mh.getState().attachedFilesMetadata;if(!(!A&&R.length===0)&&!(h||o)){l(!0);try{let P={},L={};for(const U of v){if(U.getParameters){const H=await U.getParameters();H&&(P={...P,...H})}if(U.getMetadata){const H=await U.getMetadata();H&&(L={...L,...H})}}R.length>0&&(L.attachedFiles=[...R]),!L.modelId&&b&&(L.modelId=b);const O=v.find(U=>U.id==="core-rules-tags");if(O&&L.activeRuleIds&&L.activeTagIds){const U=[],H=new Set(L.activeRuleIds);L.activeTagIds.forEach($=>{O.getRulesForTag($).forEach(ne=>H.add(ne.id))}),H.forEach($=>{const ne=O.getRuleById($);ne&&U.push({type:ne.type,content:ne.content,sourceRuleId:ne.id})}),L.effectiveRulesContent=U}let V={id:Vi(),content:A,parameters:P,metadata:L};Pe.emit(Nn.submitted,{turnData:V});const D=await IC(Q0.PROMPT_TURN_FINALIZE,{turnData:V});if(D===!1){console.log("Prompt submission cancelled by middleware."),l(!1);return}const Z=D&&typeof D=="object"?D.turnData:V;await t(Z),y(),v.forEach(U=>{U.clearOnSubmit&&U.clearOnSubmit()}),(I=s.current)==null||I.clearValue(),u(!1)}catch(P){console.error("Error during prompt submission:",P),je.error(`Failed to send message: ${P instanceof Error?P.message:String(P)}`)}finally{l(!1)}}},[s,h,o,v,t,y,b]),C=T.useCallback(k=>{u(k.trim().length>0)},[]);return f.jsxs("div",{className:Ze("p-2 md:p-4 space-y-2 md:space-y-3",n),children:[x.length>0&&f.jsx(kB,{controls:x,area:"panel",className:"flex flex-wrap gap-1 md:gap-2 items-start mb-1 md:mb-2"}),f.jsxs("div",{className:"flex items-end gap-2",children:[f.jsx(e,{ref:s,onSubmit:S,disabled:h||o,placeholder:r,onValueChange:C,className:"flex-grow"}),f.jsx(ft,{type:"button",size:"icon",onClick:S,disabled:h||o||!c&&m.length===0,className:"h-9 w-9 flex-shrink-0","aria-label":"Send message",children:o?f.jsx(Qn,{className:"h-4 w-4 animate-spin"}):f.jsx(mge,{className:"h-4 w-4"})})]})," ",f.jsx(kB,{controls:w,area:"trigger",className:"flex items-center gap-1 flex-wrap flex-shrink-0 mt-1 md:mt-2"})]})};function Wt(e,t,{checkForDefaultPrevented:n=!0}={}){return function(s){if(e==null||e(s),n===!1||!s.defaultPrevented)return t==null?void 0:t(s)}}function lxe(e,t){const n=T.createContext(t),r=i=>{const{children:a,...o}=i,l=T.useMemo(()=>o,Object.values(o));return f.jsx(n.Provider,{value:l,children:a})};r.displayName=e+"Provider";function s(i){const a=T.useContext(n);if(a)return a;if(t!==void 0)return t;throw new Error(`\`${i}\` must be used within \`${e}\``)}return[r,s]}function Hi(e,t=[]){let n=[];function r(i,a){const o=T.createContext(a),l=n.length;n=[...n,a];const c=d=>{var x;const{scope:h,children:m,...y}=d,b=((x=h==null?void 0:h[e])==null?void 0:x[l])||o,v=T.useMemo(()=>y,Object.values(y));return f.jsx(b.Provider,{value:v,children:m})};c.displayName=i+"Provider";function u(d,h){var b;const m=((b=h==null?void 0:h[e])==null?void 0:b[l])||o,y=T.useContext(m);if(y)return y;if(a!==void 0)return a;throw new Error(`\`${d}\` must be used within \`${i}\``)}return[c,u]}const s=()=>{const i=n.map(a=>T.createContext(a));return function(o){const l=(o==null?void 0:o[e])||i;return T.useMemo(()=>({[`__scope${e}`]:{...o,[e]:l}}),[o,l])}};return s.scopeName=e,[r,cxe(s,...t)]}function cxe(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const r=e.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(i){const a=r.reduce((o,{useScope:l,scopeName:c})=>{const d=l(i)[`__scope${c}`];return{...o,...d}},{});return T.useMemo(()=>({[`__scope${t.scopeName}`]:a}),[a])}};return n.scopeName=t.scopeName,n}function uxe(e){const t=dxe(e),n=T.forwardRef((r,s)=>{const{children:i,...a}=r,o=T.Children.toArray(i),l=o.find(hxe);if(l){const c=l.props.children,u=o.map(d=>d===l?T.Children.count(c)>1?T.Children.only(null):T.isValidElement(c)?c.props.children:null:d);return f.jsx(t,{...a,ref:s,children:T.isValidElement(c)?T.cloneElement(c,void 0,u):null})}return f.jsx(t,{...a,ref:s,children:i})});return n.displayName=`${e}.Slot`,n}function dxe(e){const t=T.forwardRef((n,r)=>{const{children:s,...i}=n;if(T.isValidElement(s)){const a=mxe(s),o=pxe(i,s.props);return s.type!==T.Fragment&&(o.ref=r?hl(r,a):a),T.cloneElement(s,o)}return T.Children.count(s)>1?T.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var fxe=Symbol("radix.slottable");function hxe(e){return T.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===fxe}function pxe(e,t){const n={...t};for(const r in t){const s=e[r],i=t[r];/^on[A-Z]/.test(r)?s&&i?n[r]=(...o)=>{i(...o),s(...o)}:s&&(n[r]=s):r==="style"?n[r]={...s,...i}:r==="className"&&(n[r]=[s,i].filter(Boolean).join(" "))}return{...e,...n}}function mxe(e){var r,s;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(s=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:s.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var gxe=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],ar=gxe.reduce((e,t)=>{const n=uxe(`Primitive.${t}`),r=T.forwardRef((s,i)=>{const{asChild:a,...o}=s,l=a?n:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),f.jsx(l,{...o,ref:i})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{});function RG(e,t){e&&al.flushSync(()=>e.dispatchEvent(t))}function ks(e){const t=T.useRef(e);return T.useEffect(()=>{t.current=e}),T.useMemo(()=>(...n)=>{var r;return(r=t.current)==null?void 0:r.call(t,...n)},[])}function XP(e,t=globalThis==null?void 0:globalThis.document){const n=ks(e);T.useEffect(()=>{const r=s=>{s.key==="Escape"&&n(s)};return t.addEventListener("keydown",r,{capture:!0}),()=>t.removeEventListener("keydown",r,{capture:!0})},[n,t])}var yxe="DismissableLayer",dj="dismissableLayer.update",bxe="dismissableLayer.pointerDownOutside",vxe="dismissableLayer.focusOutside",_$,NG=T.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),CE=T.forwardRef((e,t)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:s,onFocusOutside:i,onInteractOutside:a,onDismiss:o,...l}=e,c=T.useContext(NG),[u,d]=T.useState(null),h=(u==null?void 0:u.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,m]=T.useState({}),y=Rn(t,R=>d(R)),b=Array.from(c.layers),[v]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),x=b.indexOf(v),w=u?b.indexOf(u):-1,S=c.layersWithOutsidePointerEventsDisabled.size>0,C=w>=x,k=_xe(R=>{const N=R.target,I=[...c.branches].some(P=>P.contains(N));!C||I||(s==null||s(R),a==null||a(R),R.defaultPrevented||o==null||o())},h),A=Sxe(R=>{const N=R.target;[...c.branches].some(P=>P.contains(N))||(i==null||i(R),a==null||a(R),R.defaultPrevented||o==null||o())},h);return XP(R=>{w===c.layers.size-1&&(r==null||r(R),!R.defaultPrevented&&o&&(R.preventDefault(),o()))},h),T.useEffect(()=>{if(u)return n&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(_$=h.body.style.pointerEvents,h.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(u)),c.layers.add(u),S$(),()=>{n&&c.layersWithOutsidePointerEventsDisabled.size===1&&(h.body.style.pointerEvents=_$)}},[u,h,n,c]),T.useEffect(()=>()=>{u&&(c.layers.delete(u),c.layersWithOutsidePointerEventsDisabled.delete(u),S$())},[u,c]),T.useEffect(()=>{const R=()=>m({});return document.addEventListener(dj,R),()=>document.removeEventListener(dj,R)},[]),f.jsx(ar.div,{...l,ref:y,style:{pointerEvents:S?C?"auto":"none":void 0,...e.style},onFocusCapture:Wt(e.onFocusCapture,A.onFocusCapture),onBlurCapture:Wt(e.onBlurCapture,A.onBlurCapture),onPointerDownCapture:Wt(e.onPointerDownCapture,k.onPointerDownCapture)})});CE.displayName=yxe;var xxe="DismissableLayerBranch",wxe=T.forwardRef((e,t)=>{const n=T.useContext(NG),r=T.useRef(null),s=Rn(t,r);return T.useEffect(()=>{const i=r.current;if(i)return n.branches.add(i),()=>{n.branches.delete(i)}},[n.branches]),f.jsx(ar.div,{...e,ref:s})});wxe.displayName=xxe;function _xe(e,t=globalThis==null?void 0:globalThis.document){const n=ks(e),r=T.useRef(!1),s=T.useRef(()=>{});return T.useEffect(()=>{const i=o=>{if(o.target&&!r.current){let l=function(){MG(bxe,n,c,{discrete:!0})};const c={originalEvent:o};o.pointerType==="touch"?(t.removeEventListener("click",s.current),s.current=l,t.addEventListener("click",s.current,{once:!0})):l()}else t.removeEventListener("click",s.current);r.current=!1},a=window.setTimeout(()=>{t.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(a),t.removeEventListener("pointerdown",i),t.removeEventListener("click",s.current)}},[t,n]),{onPointerDownCapture:()=>r.current=!0}}function Sxe(e,t=globalThis==null?void 0:globalThis.document){const n=ks(e),r=T.useRef(!1);return T.useEffect(()=>{const s=i=>{i.target&&!r.current&&MG(vxe,n,{originalEvent:i},{discrete:!1})};return t.addEventListener("focusin",s),()=>t.removeEventListener("focusin",s)},[t,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function S$(){const e=new CustomEvent(dj);document.dispatchEvent(e)}function MG(e,t,n,{discrete:r}){const s=n.originalEvent.target,i=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&s.addEventListener(e,t,{once:!0}),r?RG(s,i):s.dispatchEvent(i)}var ni=globalThis!=null&&globalThis.document?T.useLayoutEffect:()=>{},Cxe=VW[" useId ".trim().toString()]||(()=>{}),kxe=0;function aa(e){const[t,n]=T.useState(Cxe());return ni(()=>{n(r=>r??String(kxe++))},[e]),t?`radix-${t}`:""}const Exe=["top","right","bottom","left"],vh=Math.min,il=Math.max,jC=Math.round,ES=Math.floor,Su=e=>({x:e,y:e}),Txe={left:"right",right:"left",bottom:"top",top:"bottom"},Axe={start:"end",end:"start"};function fj(e,t,n){return il(e,vh(t,n))}function Ud(e,t){return typeof e=="function"?e(t):e}function qd(e){return e.split("-")[0]}function Ly(e){return e.split("-")[1]}function JP(e){return e==="x"?"y":"x"}function QP(e){return e==="y"?"height":"width"}function xh(e){return["top","bottom"].includes(qd(e))?"y":"x"}function eO(e){return JP(xh(e))}function Rxe(e,t,n){n===void 0&&(n=!1);const r=Ly(e),s=eO(e),i=QP(s);let a=s==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return t.reference[i]>t.floating[i]&&(a=PC(a)),[a,PC(a)]}function Nxe(e){const t=PC(e);return[hj(e),t,hj(t)]}function hj(e){return e.replace(/start|end/g,t=>Axe[t])}function Mxe(e,t,n){const r=["left","right"],s=["right","left"],i=["top","bottom"],a=["bottom","top"];switch(e){case"top":case"bottom":return n?t?s:r:t?r:s;case"left":case"right":return t?i:a;default:return[]}}function Ixe(e,t,n,r){const s=Ly(e);let i=Mxe(qd(e),n==="start",r);return s&&(i=i.map(a=>a+"-"+s),t&&(i=i.concat(i.map(hj)))),i}function PC(e){return e.replace(/left|right|bottom|top/g,t=>Txe[t])}function jxe(e){return{top:0,right:0,bottom:0,left:0,...e}}function IG(e){return typeof e!="number"?jxe(e):{top:e,right:e,bottom:e,left:e}}function OC(e){const{x:t,y:n,width:r,height:s}=e;return{width:r,height:s,top:n,left:t,right:t+r,bottom:n+s,x:t,y:n}}function C$(e,t,n){let{reference:r,floating:s}=e;const i=xh(t),a=eO(t),o=QP(a),l=qd(t),c=i==="y",u=r.x+r.width/2-s.width/2,d=r.y+r.height/2-s.height/2,h=r[o]/2-s[o]/2;let m;switch(l){case"top":m={x:u,y:r.y-s.height};break;case"bottom":m={x:u,y:r.y+r.height};break;case"right":m={x:r.x+r.width,y:d};break;case"left":m={x:r.x-s.width,y:d};break;default:m={x:r.x,y:r.y}}switch(Ly(t)){case"start":m[a]-=h*(n&&c?-1:1);break;case"end":m[a]+=h*(n&&c?-1:1);break}return m}const Pxe=async(e,t,n)=>{const{placement:r="bottom",strategy:s="absolute",middleware:i=[],platform:a}=n,o=i.filter(Boolean),l=await(a.isRTL==null?void 0:a.isRTL(t));let c=await a.getElementRects({reference:e,floating:t,strategy:s}),{x:u,y:d}=C$(c,r,l),h=r,m={},y=0;for(let b=0;b<o.length;b++){const{name:v,fn:x}=o[b],{x:w,y:S,data:C,reset:k}=await x({x:u,y:d,initialPlacement:r,placement:h,strategy:s,middlewareData:m,rects:c,platform:a,elements:{reference:e,floating:t}});u=w??u,d=S??d,m={...m,[v]:{...m[v],...C}},k&&y<=50&&(y++,typeof k=="object"&&(k.placement&&(h=k.placement),k.rects&&(c=k.rects===!0?await a.getElementRects({reference:e,floating:t,strategy:s}):k.rects),{x:u,y:d}=C$(c,h,l)),b=-1)}return{x:u,y:d,placement:h,strategy:s,middlewareData:m}};async function Kx(e,t){var n;t===void 0&&(t={});const{x:r,y:s,platform:i,rects:a,elements:o,strategy:l}=e,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:h=!1,padding:m=0}=Ud(t,e),y=IG(m),v=o[h?d==="floating"?"reference":"floating":d],x=OC(await i.getClippingRect({element:(n=await(i.isElement==null?void 0:i.isElement(v)))==null||n?v:v.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(o.floating)),boundary:c,rootBoundary:u,strategy:l})),w=d==="floating"?{x:r,y:s,width:a.floating.width,height:a.floating.height}:a.reference,S=await(i.getOffsetParent==null?void 0:i.getOffsetParent(o.floating)),C=await(i.isElement==null?void 0:i.isElement(S))?await(i.getScale==null?void 0:i.getScale(S))||{x:1,y:1}:{x:1,y:1},k=OC(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:o,rect:w,offsetParent:S,strategy:l}):w);return{top:(x.top-k.top+y.top)/C.y,bottom:(k.bottom-x.bottom+y.bottom)/C.y,left:(x.left-k.left+y.left)/C.x,right:(k.right-x.right+y.right)/C.x}}const Oxe=e=>({name:"arrow",options:e,async fn(t){const{x:n,y:r,placement:s,rects:i,platform:a,elements:o,middlewareData:l}=t,{element:c,padding:u=0}=Ud(e,t)||{};if(c==null)return{};const d=IG(u),h={x:n,y:r},m=eO(s),y=QP(m),b=await a.getDimensions(c),v=m==="y",x=v?"top":"left",w=v?"bottom":"right",S=v?"clientHeight":"clientWidth",C=i.reference[y]+i.reference[m]-h[m]-i.floating[y],k=h[m]-i.reference[m],A=await(a.getOffsetParent==null?void 0:a.getOffsetParent(c));let R=A?A[S]:0;(!R||!await(a.isElement==null?void 0:a.isElement(A)))&&(R=o.floating[S]||i.floating[y]);const N=C/2-k/2,I=R/2-b[y]/2-1,P=vh(d[x],I),L=vh(d[w],I),O=P,V=R-b[y]-L,D=R/2-b[y]/2+N,Z=fj(O,D,V),U=!l.arrow&&Ly(s)!=null&&D!==Z&&i.reference[y]/2-(D<O?P:L)-b[y]/2<0,H=U?D<O?D-O:D-V:0;return{[m]:h[m]+H,data:{[m]:Z,centerOffset:D-Z-H,...U&&{alignmentOffset:H}},reset:U}}}),Dxe=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var n,r;const{placement:s,middlewareData:i,rects:a,initialPlacement:o,platform:l,elements:c}=t,{mainAxis:u=!0,crossAxis:d=!0,fallbackPlacements:h,fallbackStrategy:m="bestFit",fallbackAxisSideDirection:y="none",flipAlignment:b=!0,...v}=Ud(e,t);if((n=i.arrow)!=null&&n.alignmentOffset)return{};const x=qd(s),w=xh(o),S=qd(o)===o,C=await(l.isRTL==null?void 0:l.isRTL(c.floating)),k=h||(S||!b?[PC(o)]:Nxe(o)),A=y!=="none";!h&&A&&k.push(...Ixe(o,b,y,C));const R=[o,...k],N=await Kx(t,v),I=[];let P=((r=i.flip)==null?void 0:r.overflows)||[];if(u&&I.push(N[x]),d){const D=Rxe(s,a,C);I.push(N[D[0]],N[D[1]])}if(P=[...P,{placement:s,overflows:I}],!I.every(D=>D<=0)){var L,O;const D=(((L=i.flip)==null?void 0:L.index)||0)+1,Z=R[D];if(Z)return{data:{index:D,overflows:P},reset:{placement:Z}};let U=(O=P.filter(H=>H.overflows[0]<=0).sort((H,$)=>H.overflows[1]-$.overflows[1])[0])==null?void 0:O.placement;if(!U)switch(m){case"bestFit":{var V;const H=(V=P.filter($=>{if(A){const ne=xh($.placement);return ne===w||ne==="y"}return!0}).map($=>[$.placement,$.overflows.filter(ne=>ne>0).reduce((ne,W)=>ne+W,0)]).sort(($,ne)=>$[1]-ne[1])[0])==null?void 0:V[0];H&&(U=H);break}case"initialPlacement":U=o;break}if(s!==U)return{reset:{placement:U}}}return{}}}};function k$(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function E$(e){return Exe.some(t=>e[t]>=0)}const Fxe=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:n}=t,{strategy:r="referenceHidden",...s}=Ud(e,t);switch(r){case"referenceHidden":{const i=await Kx(t,{...s,elementContext:"reference"}),a=k$(i,n.reference);return{data:{referenceHiddenOffsets:a,referenceHidden:E$(a)}}}case"escaped":{const i=await Kx(t,{...s,altBoundary:!0}),a=k$(i,n.floating);return{data:{escapedOffsets:a,escaped:E$(a)}}}default:return{}}}}};async function Lxe(e,t){const{placement:n,platform:r,elements:s}=e,i=await(r.isRTL==null?void 0:r.isRTL(s.floating)),a=qd(n),o=Ly(n),l=xh(n)==="y",c=["left","top"].includes(a)?-1:1,u=i&&l?-1:1,d=Ud(t,e);let{mainAxis:h,crossAxis:m,alignmentAxis:y}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:d.mainAxis||0,crossAxis:d.crossAxis||0,alignmentAxis:d.alignmentAxis};return o&&typeof y=="number"&&(m=o==="end"?y*-1:y),l?{x:m*u,y:h*c}:{x:h*c,y:m*u}}const Bxe=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var n,r;const{x:s,y:i,placement:a,middlewareData:o}=t,l=await Lxe(t,e);return a===((n=o.offset)==null?void 0:n.placement)&&(r=o.arrow)!=null&&r.alignmentOffset?{}:{x:s+l.x,y:i+l.y,data:{...l,placement:a}}}}},$xe=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:n,y:r,placement:s}=t,{mainAxis:i=!0,crossAxis:a=!1,limiter:o={fn:v=>{let{x,y:w}=v;return{x,y:w}}},...l}=Ud(e,t),c={x:n,y:r},u=await Kx(t,l),d=xh(qd(s)),h=JP(d);let m=c[h],y=c[d];if(i){const v=h==="y"?"top":"left",x=h==="y"?"bottom":"right",w=m+u[v],S=m-u[x];m=fj(w,m,S)}if(a){const v=d==="y"?"top":"left",x=d==="y"?"bottom":"right",w=y+u[v],S=y-u[x];y=fj(w,y,S)}const b=o.fn({...t,[h]:m,[d]:y});return{...b,data:{x:b.x-n,y:b.y-r,enabled:{[h]:i,[d]:a}}}}}},zxe=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:n,y:r,placement:s,rects:i,middlewareData:a}=t,{offset:o=0,mainAxis:l=!0,crossAxis:c=!0}=Ud(e,t),u={x:n,y:r},d=xh(s),h=JP(d);let m=u[h],y=u[d];const b=Ud(o,t),v=typeof b=="number"?{mainAxis:b,crossAxis:0}:{mainAxis:0,crossAxis:0,...b};if(l){const S=h==="y"?"height":"width",C=i.reference[h]-i.floating[S]+v.mainAxis,k=i.reference[h]+i.reference[S]-v.mainAxis;m<C?m=C:m>k&&(m=k)}if(c){var x,w;const S=h==="y"?"width":"height",C=["top","left"].includes(qd(s)),k=i.reference[d]-i.floating[S]+(C&&((x=a.offset)==null?void 0:x[d])||0)+(C?0:v.crossAxis),A=i.reference[d]+i.reference[S]+(C?0:((w=a.offset)==null?void 0:w[d])||0)-(C?v.crossAxis:0);y<k?y=k:y>A&&(y=A)}return{[h]:m,[d]:y}}}},Uxe=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){var n,r;const{placement:s,rects:i,platform:a,elements:o}=t,{apply:l=()=>{},...c}=Ud(e,t),u=await Kx(t,c),d=qd(s),h=Ly(s),m=xh(s)==="y",{width:y,height:b}=i.floating;let v,x;d==="top"||d==="bottom"?(v=d,x=h===(await(a.isRTL==null?void 0:a.isRTL(o.floating))?"start":"end")?"left":"right"):(x=d,v=h==="end"?"top":"bottom");const w=b-u.top-u.bottom,S=y-u.left-u.right,C=vh(b-u[v],w),k=vh(y-u[x],S),A=!t.middlewareData.shift;let R=C,N=k;if((n=t.middlewareData.shift)!=null&&n.enabled.x&&(N=S),(r=t.middlewareData.shift)!=null&&r.enabled.y&&(R=w),A&&!h){const P=il(u.left,0),L=il(u.right,0),O=il(u.top,0),V=il(u.bottom,0);m?N=y-2*(P!==0||L!==0?P+L:il(u.left,u.right)):R=b-2*(O!==0||V!==0?O+V:il(u.top,u.bottom))}await l({...t,availableWidth:N,availableHeight:R});const I=await a.getDimensions(o.floating);return y!==I.width||b!==I.height?{reset:{rects:!0}}:{}}}};function kE(){return typeof window<"u"}function By(e){return jG(e)?(e.nodeName||"").toLowerCase():"#document"}function ol(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function Lu(e){var t;return(t=(jG(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function jG(e){return kE()?e instanceof Node||e instanceof ol(e).Node:!1}function Ic(e){return kE()?e instanceof Element||e instanceof ol(e).Element:!1}function ju(e){return kE()?e instanceof HTMLElement||e instanceof ol(e).HTMLElement:!1}function T$(e){return!kE()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof ol(e).ShadowRoot}function d1(e){const{overflow:t,overflowX:n,overflowY:r,display:s}=jc(e);return/auto|scroll|overlay|hidden|clip/.test(t+r+n)&&!["inline","contents"].includes(s)}function qxe(e){return["table","td","th"].includes(By(e))}function EE(e){return[":popover-open",":modal"].some(t=>{try{return e.matches(t)}catch{return!1}})}function tO(e){const t=nO(),n=Ic(e)?jc(e):e;return["transform","translate","scale","rotate","perspective"].some(r=>n[r]?n[r]!=="none":!1)||(n.containerType?n.containerType!=="normal":!1)||!t&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!t&&(n.filter?n.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(r=>(n.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(n.contain||"").includes(r))}function Vxe(e){let t=wh(e);for(;ju(t)&&!ey(t);){if(tO(t))return t;if(EE(t))return null;t=wh(t)}return null}function nO(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function ey(e){return["html","body","#document"].includes(By(e))}function jc(e){return ol(e).getComputedStyle(e)}function TE(e){return Ic(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function wh(e){if(By(e)==="html")return e;const t=e.assignedSlot||e.parentNode||T$(e)&&e.host||Lu(e);return T$(t)?t.host:t}function PG(e){const t=wh(e);return ey(t)?e.ownerDocument?e.ownerDocument.body:e.body:ju(t)&&d1(t)?t:PG(t)}function Yx(e,t,n){var r;t===void 0&&(t=[]),n===void 0&&(n=!0);const s=PG(e),i=s===((r=e.ownerDocument)==null?void 0:r.body),a=ol(s);if(i){const o=pj(a);return t.concat(a,a.visualViewport||[],d1(s)?s:[],o&&n?Yx(o):[])}return t.concat(s,Yx(s,[],n))}function pj(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function OG(e){const t=jc(e);let n=parseFloat(t.width)||0,r=parseFloat(t.height)||0;const s=ju(e),i=s?e.offsetWidth:n,a=s?e.offsetHeight:r,o=jC(n)!==i||jC(r)!==a;return o&&(n=i,r=a),{width:n,height:r,$:o}}function rO(e){return Ic(e)?e:e.contextElement}function A0(e){const t=rO(e);if(!ju(t))return Su(1);const n=t.getBoundingClientRect(),{width:r,height:s,$:i}=OG(t);let a=(i?jC(n.width):n.width)/r,o=(i?jC(n.height):n.height)/s;return(!a||!Number.isFinite(a))&&(a=1),(!o||!Number.isFinite(o))&&(o=1),{x:a,y:o}}const Wxe=Su(0);function DG(e){const t=ol(e);return!nO()||!t.visualViewport?Wxe:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function Hxe(e,t,n){return t===void 0&&(t=!1),!n||t&&n!==ol(e)?!1:t}function Cm(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=!1);const s=e.getBoundingClientRect(),i=rO(e);let a=Su(1);t&&(r?Ic(r)&&(a=A0(r)):a=A0(e));const o=Hxe(i,n,r)?DG(i):Su(0);let l=(s.left+o.x)/a.x,c=(s.top+o.y)/a.y,u=s.width/a.x,d=s.height/a.y;if(i){const h=ol(i),m=r&&Ic(r)?ol(r):r;let y=h,b=pj(y);for(;b&&r&&m!==y;){const v=A0(b),x=b.getBoundingClientRect(),w=jc(b),S=x.left+(b.clientLeft+parseFloat(w.paddingLeft))*v.x,C=x.top+(b.clientTop+parseFloat(w.paddingTop))*v.y;l*=v.x,c*=v.y,u*=v.x,d*=v.y,l+=S,c+=C,y=ol(b),b=pj(y)}}return OC({width:u,height:d,x:l,y:c})}function sO(e,t){const n=TE(e).scrollLeft;return t?t.left+n:Cm(Lu(e)).left+n}function FG(e,t,n){n===void 0&&(n=!1);const r=e.getBoundingClientRect(),s=r.left+t.scrollLeft-(n?0:sO(e,r)),i=r.top+t.scrollTop;return{x:s,y:i}}function Gxe(e){let{elements:t,rect:n,offsetParent:r,strategy:s}=e;const i=s==="fixed",a=Lu(r),o=t?EE(t.floating):!1;if(r===a||o&&i)return n;let l={scrollLeft:0,scrollTop:0},c=Su(1);const u=Su(0),d=ju(r);if((d||!d&&!i)&&((By(r)!=="body"||d1(a))&&(l=TE(r)),ju(r))){const m=Cm(r);c=A0(r),u.x=m.x+r.clientLeft,u.y=m.y+r.clientTop}const h=a&&!d&&!i?FG(a,l,!0):Su(0);return{width:n.width*c.x,height:n.height*c.y,x:n.x*c.x-l.scrollLeft*c.x+u.x+h.x,y:n.y*c.y-l.scrollTop*c.y+u.y+h.y}}function Kxe(e){return Array.from(e.getClientRects())}function Yxe(e){const t=Lu(e),n=TE(e),r=e.ownerDocument.body,s=il(t.scrollWidth,t.clientWidth,r.scrollWidth,r.clientWidth),i=il(t.scrollHeight,t.clientHeight,r.scrollHeight,r.clientHeight);let a=-n.scrollLeft+sO(e);const o=-n.scrollTop;return jc(r).direction==="rtl"&&(a+=il(t.clientWidth,r.clientWidth)-s),{width:s,height:i,x:a,y:o}}function Zxe(e,t){const n=ol(e),r=Lu(e),s=n.visualViewport;let i=r.clientWidth,a=r.clientHeight,o=0,l=0;if(s){i=s.width,a=s.height;const c=nO();(!c||c&&t==="fixed")&&(o=s.offsetLeft,l=s.offsetTop)}return{width:i,height:a,x:o,y:l}}function Xxe(e,t){const n=Cm(e,!0,t==="fixed"),r=n.top+e.clientTop,s=n.left+e.clientLeft,i=ju(e)?A0(e):Su(1),a=e.clientWidth*i.x,o=e.clientHeight*i.y,l=s*i.x,c=r*i.y;return{width:a,height:o,x:l,y:c}}function A$(e,t,n){let r;if(t==="viewport")r=Zxe(e,n);else if(t==="document")r=Yxe(Lu(e));else if(Ic(t))r=Xxe(t,n);else{const s=DG(e);r={x:t.x-s.x,y:t.y-s.y,width:t.width,height:t.height}}return OC(r)}function LG(e,t){const n=wh(e);return n===t||!Ic(n)||ey(n)?!1:jc(n).position==="fixed"||LG(n,t)}function Jxe(e,t){const n=t.get(e);if(n)return n;let r=Yx(e,[],!1).filter(o=>Ic(o)&&By(o)!=="body"),s=null;const i=jc(e).position==="fixed";let a=i?wh(e):e;for(;Ic(a)&&!ey(a);){const o=jc(a),l=tO(a);!l&&o.position==="fixed"&&(s=null),(i?!l&&!s:!l&&o.position==="static"&&!!s&&["absolute","fixed"].includes(s.position)||d1(a)&&!l&&LG(e,a))?r=r.filter(u=>u!==a):s=o,a=wh(a)}return t.set(e,r),r}function Qxe(e){let{element:t,boundary:n,rootBoundary:r,strategy:s}=e;const a=[...n==="clippingAncestors"?EE(t)?[]:Jxe(t,this._c):[].concat(n),r],o=a[0],l=a.reduce((c,u)=>{const d=A$(t,u,s);return c.top=il(d.top,c.top),c.right=vh(d.right,c.right),c.bottom=vh(d.bottom,c.bottom),c.left=il(d.left,c.left),c},A$(t,o,s));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function ewe(e){const{width:t,height:n}=OG(e);return{width:t,height:n}}function twe(e,t,n){const r=ju(t),s=Lu(t),i=n==="fixed",a=Cm(e,!0,i,t);let o={scrollLeft:0,scrollTop:0};const l=Su(0);if(r||!r&&!i)if((By(t)!=="body"||d1(s))&&(o=TE(t)),r){const h=Cm(t,!0,i,t);l.x=h.x+t.clientLeft,l.y=h.y+t.clientTop}else s&&(l.x=sO(s));const c=s&&!r&&!i?FG(s,o):Su(0),u=a.left+o.scrollLeft-l.x-c.x,d=a.top+o.scrollTop-l.y-c.y;return{x:u,y:d,width:a.width,height:a.height}}function WN(e){return jc(e).position==="static"}function R$(e,t){if(!ju(e)||jc(e).position==="fixed")return null;if(t)return t(e);let n=e.offsetParent;return Lu(e)===n&&(n=n.ownerDocument.body),n}function BG(e,t){const n=ol(e);if(EE(e))return n;if(!ju(e)){let s=wh(e);for(;s&&!ey(s);){if(Ic(s)&&!WN(s))return s;s=wh(s)}return n}let r=R$(e,t);for(;r&&qxe(r)&&WN(r);)r=R$(r,t);return r&&ey(r)&&WN(r)&&!tO(r)?n:r||Vxe(e)||n}const nwe=async function(e){const t=this.getOffsetParent||BG,n=this.getDimensions,r=await n(e.floating);return{reference:twe(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function rwe(e){return jc(e).direction==="rtl"}const swe={convertOffsetParentRelativeRectToViewportRelativeRect:Gxe,getDocumentElement:Lu,getClippingRect:Qxe,getOffsetParent:BG,getElementRects:nwe,getClientRects:Kxe,getDimensions:ewe,getScale:A0,isElement:Ic,isRTL:rwe};function $G(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function iwe(e,t){let n=null,r;const s=Lu(e);function i(){var o;clearTimeout(r),(o=n)==null||o.disconnect(),n=null}function a(o,l){o===void 0&&(o=!1),l===void 0&&(l=1),i();const c=e.getBoundingClientRect(),{left:u,top:d,width:h,height:m}=c;if(o||t(),!h||!m)return;const y=ES(d),b=ES(s.clientWidth-(u+h)),v=ES(s.clientHeight-(d+m)),x=ES(u),S={rootMargin:-y+"px "+-b+"px "+-v+"px "+-x+"px",threshold:il(0,vh(1,l))||1};let C=!0;function k(A){const R=A[0].intersectionRatio;if(R!==l){if(!C)return a();R?a(!1,R):r=setTimeout(()=>{a(!1,1e-7)},1e3)}R===1&&!$G(c,e.getBoundingClientRect())&&a(),C=!1}try{n=new IntersectionObserver(k,{...S,root:s.ownerDocument})}catch{n=new IntersectionObserver(k,S)}n.observe(e)}return a(!0),i}function iO(e,t,n,r){r===void 0&&(r={});const{ancestorScroll:s=!0,ancestorResize:i=!0,elementResize:a=typeof ResizeObserver=="function",layoutShift:o=typeof IntersectionObserver=="function",animationFrame:l=!1}=r,c=rO(e),u=s||i?[...c?Yx(c):[],...Yx(t)]:[];u.forEach(x=>{s&&x.addEventListener("scroll",n,{passive:!0}),i&&x.addEventListener("resize",n)});const d=c&&o?iwe(c,n):null;let h=-1,m=null;a&&(m=new ResizeObserver(x=>{let[w]=x;w&&w.target===c&&m&&(m.unobserve(t),cancelAnimationFrame(h),h=requestAnimationFrame(()=>{var S;(S=m)==null||S.observe(t)})),n()}),c&&!l&&m.observe(c),m.observe(t));let y,b=l?Cm(e):null;l&&v();function v(){const x=Cm(e);b&&!$G(b,x)&&n(),b=x,y=requestAnimationFrame(v)}return n(),()=>{var x;u.forEach(w=>{s&&w.removeEventListener("scroll",n),i&&w.removeEventListener("resize",n)}),d==null||d(),(x=m)==null||x.disconnect(),m=null,l&&cancelAnimationFrame(y)}}const awe=Bxe,owe=$xe,lwe=Dxe,cwe=Uxe,uwe=Fxe,N$=Oxe,dwe=zxe,fwe=(e,t,n)=>{const r=new Map,s={platform:swe,...n},i={...s.platform,_c:r};return Pxe(e,t,{...s,platform:i})};var E2=typeof document<"u"?T.useLayoutEffect:T.useEffect;function DC(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let n,r,s;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(n=e.length,n!==t.length)return!1;for(r=n;r--!==0;)if(!DC(e[r],t[r]))return!1;return!0}if(s=Object.keys(e),n=s.length,n!==Object.keys(t).length)return!1;for(r=n;r--!==0;)if(!{}.hasOwnProperty.call(t,s[r]))return!1;for(r=n;r--!==0;){const i=s[r];if(!(i==="_owner"&&e.$$typeof)&&!DC(e[i],t[i]))return!1}return!0}return e!==e&&t!==t}function zG(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function M$(e,t){const n=zG(e);return Math.round(t*n)/n}function HN(e){const t=T.useRef(e);return E2(()=>{t.current=e}),t}function aO(e){e===void 0&&(e={});const{placement:t="bottom",strategy:n="absolute",middleware:r=[],platform:s,elements:{reference:i,floating:a}={},transform:o=!0,whileElementsMounted:l,open:c}=e,[u,d]=T.useState({x:0,y:0,strategy:n,placement:t,middlewareData:{},isPositioned:!1}),[h,m]=T.useState(r);DC(h,r)||m(r);const[y,b]=T.useState(null),[v,x]=T.useState(null),w=T.useCallback($=>{$!==A.current&&(A.current=$,b($))},[]),S=T.useCallback($=>{$!==R.current&&(R.current=$,x($))},[]),C=i||y,k=a||v,A=T.useRef(null),R=T.useRef(null),N=T.useRef(u),I=l!=null,P=HN(l),L=HN(s),O=HN(c),V=T.useCallback(()=>{if(!A.current||!R.current)return;const $={placement:t,strategy:n,middleware:h};L.current&&($.platform=L.current),fwe(A.current,R.current,$).then(ne=>{const W={...ne,isPositioned:O.current!==!1};D.current&&!DC(N.current,W)&&(N.current=W,al.flushSync(()=>{d(W)}))})},[h,t,n,L,O]);E2(()=>{c===!1&&N.current.isPositioned&&(N.current.isPositioned=!1,d($=>({...$,isPositioned:!1})))},[c]);const D=T.useRef(!1);E2(()=>(D.current=!0,()=>{D.current=!1}),[]),E2(()=>{if(C&&(A.current=C),k&&(R.current=k),C&&k){if(P.current)return P.current(C,k,V);V()}},[C,k,V,P,I]);const Z=T.useMemo(()=>({reference:A,floating:R,setReference:w,setFloating:S}),[w,S]),U=T.useMemo(()=>({reference:C,floating:k}),[C,k]),H=T.useMemo(()=>{const $={position:n,left:0,top:0};if(!U.floating)return $;const ne=M$(U.floating,u.x),W=M$(U.floating,u.y);return o?{...$,transform:"translate("+ne+"px, "+W+"px)",...zG(U.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:ne,top:W}},[n,o,U.floating,u.x,u.y]);return T.useMemo(()=>({...u,update:V,refs:Z,elements:U,floatingStyles:H}),[u,V,Z,U,H])}const hwe=e=>{function t(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:e,fn(n){const{element:r,padding:s}=typeof e=="function"?e(n):e;return r&&t(r)?r.current!=null?N$({element:r.current,padding:s}).fn(n):{}:r?N$({element:r,padding:s}).fn(n):{}}}},oO=(e,t)=>({...awe(e),options:[e,t]}),lO=(e,t)=>({...owe(e),options:[e,t]}),cO=(e,t)=>({...dwe(e),options:[e,t]}),uO=(e,t)=>({...lwe(e),options:[e,t]}),dO=(e,t)=>({...cwe(e),options:[e,t]}),fO=(e,t)=>({...uwe(e),options:[e,t]}),hO=(e,t)=>({...hwe(e),options:[e,t]});var pwe="Arrow",UG=T.forwardRef((e,t)=>{const{children:n,width:r=10,height:s=5,...i}=e;return f.jsx(ar.svg,{...i,ref:t,width:r,height:s,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?n:f.jsx("polygon",{points:"0,0 30,0 15,10"})})});UG.displayName=pwe;var mwe=UG;function $y(e){const[t,n]=T.useState(void 0);return ni(()=>{if(e){n({width:e.offsetWidth,height:e.offsetHeight});const r=new ResizeObserver(s=>{if(!Array.isArray(s)||!s.length)return;const i=s[0];let a,o;if("borderBoxSize"in i){const l=i.borderBoxSize,c=Array.isArray(l)?l[0]:l;a=c.inlineSize,o=c.blockSize}else a=e.offsetWidth,o=e.offsetHeight;n({width:a,height:o})});return r.observe(e,{box:"border-box"}),()=>r.unobserve(e)}else n(void 0)},[e]),t}var pO="Popper",[qG,AE]=Hi(pO),[gwe,VG]=qG(pO),WG=e=>{const{__scopePopper:t,children:n}=e,[r,s]=T.useState(null);return f.jsx(gwe,{scope:t,anchor:r,onAnchorChange:s,children:n})};WG.displayName=pO;var HG="PopperAnchor",GG=T.forwardRef((e,t)=>{const{__scopePopper:n,virtualRef:r,...s}=e,i=VG(HG,n),a=T.useRef(null),o=Rn(t,a);return T.useEffect(()=>{i.onAnchorChange((r==null?void 0:r.current)||a.current)}),r?null:f.jsx(ar.div,{...s,ref:o})});GG.displayName=HG;var mO="PopperContent",[ywe,bwe]=qG(mO),KG=T.forwardRef((e,t)=>{var De,Se,Ce,qe,Qe,Ve;const{__scopePopper:n,side:r="bottom",sideOffset:s=0,align:i="center",alignOffset:a=0,arrowPadding:o=0,avoidCollisions:l=!0,collisionBoundary:c=[],collisionPadding:u=0,sticky:d="partial",hideWhenDetached:h=!1,updatePositionStrategy:m="optimized",onPlaced:y,...b}=e,v=VG(mO,n),[x,w]=T.useState(null),S=Rn(t,Ne=>w(Ne)),[C,k]=T.useState(null),A=$y(C),R=(A==null?void 0:A.width)??0,N=(A==null?void 0:A.height)??0,I=r+(i!=="center"?"-"+i:""),P=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},L=Array.isArray(c)?c:[c],O=L.length>0,V={padding:P,boundary:L.filter(xwe),altBoundary:O},{refs:D,floatingStyles:Z,placement:U,isPositioned:H,middlewareData:$}=aO({strategy:"fixed",placement:I,whileElementsMounted:(...Ne)=>iO(...Ne,{animationFrame:m==="always"}),elements:{reference:v.anchor},middleware:[oO({mainAxis:s+N,alignmentAxis:a}),l&&lO({mainAxis:!0,crossAxis:!1,limiter:d==="partial"?cO():void 0,...V}),l&&uO({...V}),dO({...V,apply:({elements:Ne,rects:K,availableWidth:ge,availableHeight:Ae})=>{const{width:le,height:oe}=K.reference,re=Ne.floating.style;re.setProperty("--radix-popper-available-width",`${ge}px`),re.setProperty("--radix-popper-available-height",`${Ae}px`),re.setProperty("--radix-popper-anchor-width",`${le}px`),re.setProperty("--radix-popper-anchor-height",`${oe}px`)}}),C&&hO({element:C,padding:o}),wwe({arrowWidth:R,arrowHeight:N}),h&&fO({strategy:"referenceHidden",...V})]}),[ne,W]=XG(U),Q=ks(y);ni(()=>{H&&(Q==null||Q())},[H,Q]);const ee=(De=$.arrow)==null?void 0:De.x,se=(Se=$.arrow)==null?void 0:Se.y,pe=((Ce=$.arrow)==null?void 0:Ce.centerOffset)!==0,[ce,Ie]=T.useState();return ni(()=>{x&&Ie(window.getComputedStyle(x).zIndex)},[x]),f.jsx("div",{ref:D.setFloating,"data-radix-popper-content-wrapper":"",style:{...Z,transform:H?Z.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:ce,"--radix-popper-transform-origin":[(qe=$.transformOrigin)==null?void 0:qe.x,(Qe=$.transformOrigin)==null?void 0:Qe.y].join(" "),...((Ve=$.hide)==null?void 0:Ve.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:f.jsx(ywe,{scope:n,placedSide:ne,onArrowChange:k,arrowX:ee,arrowY:se,shouldHideArrow:pe,children:f.jsx(ar.div,{"data-side":ne,"data-align":W,...b,ref:S,style:{...b.style,animation:H?void 0:"none"}})})})});KG.displayName=mO;var YG="PopperArrow",vwe={top:"bottom",right:"left",bottom:"top",left:"right"},ZG=T.forwardRef(function(t,n){const{__scopePopper:r,...s}=t,i=bwe(YG,r),a=vwe[i.placedSide];return f.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[a]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:f.jsx(mwe,{...s,ref:n,style:{...s.style,display:"block"}})})});ZG.displayName=YG;function xwe(e){return e!==null}var wwe=e=>({name:"transformOrigin",options:e,fn(t){var v,x,w;const{placement:n,rects:r,middlewareData:s}=t,a=((v=s.arrow)==null?void 0:v.centerOffset)!==0,o=a?0:e.arrowWidth,l=a?0:e.arrowHeight,[c,u]=XG(n),d={start:"0%",center:"50%",end:"100%"}[u],h=(((x=s.arrow)==null?void 0:x.x)??0)+o/2,m=(((w=s.arrow)==null?void 0:w.y)??0)+l/2;let y="",b="";return c==="bottom"?(y=a?d:`${h}px`,b=`${-l}px`):c==="top"?(y=a?d:`${h}px`,b=`${r.floating.height+l}px`):c==="right"?(y=`${-l}px`,b=a?d:`${m}px`):c==="left"&&(y=`${r.floating.width+l}px`,b=a?d:`${m}px`),{data:{x:y,y:b}}}});function XG(e){const[t,n="center"]=e.split("-");return[t,n]}var JG=WG,QG=GG,eK=KG,tK=ZG,_we="Portal",RE=T.forwardRef((e,t)=>{var o;const{container:n,...r}=e,[s,i]=T.useState(!1);ni(()=>i(!0),[]);const a=n||s&&((o=globalThis==null?void 0:globalThis.document)==null?void 0:o.body);return a?yE.createPortal(f.jsx(ar.div,{...r,ref:t}),a):null});RE.displayName=_we;function Swe(e,t){return T.useReducer((n,r)=>t[n][r]??n,e)}var la=e=>{const{present:t,children:n}=e,r=Cwe(t),s=typeof n=="function"?n({present:r.isPresent}):T.Children.only(n),i=Rn(r.ref,kwe(s));return typeof n=="function"||r.isPresent?T.cloneElement(s,{ref:i}):null};la.displayName="Presence";function Cwe(e){const[t,n]=T.useState(),r=T.useRef(null),s=T.useRef(e),i=T.useRef("none"),a=e?"mounted":"unmounted",[o,l]=Swe(a,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return T.useEffect(()=>{const c=TS(r.current);i.current=o==="mounted"?c:"none"},[o]),ni(()=>{const c=r.current,u=s.current;if(u!==e){const h=i.current,m=TS(c);e?l("MOUNT"):m==="none"||(c==null?void 0:c.display)==="none"?l("UNMOUNT"):l(u&&h!==m?"ANIMATION_OUT":"UNMOUNT"),s.current=e}},[e,l]),ni(()=>{if(t){let c;const u=t.ownerDocument.defaultView??window,d=m=>{const b=TS(r.current).includes(m.animationName);if(m.target===t&&b&&(l("ANIMATION_END"),!s.current)){const v=t.style.animationFillMode;t.style.animationFillMode="forwards",c=u.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=v)})}},h=m=>{m.target===t&&(i.current=TS(r.current))};return t.addEventListener("animationstart",h),t.addEventListener("animationcancel",d),t.addEventListener("animationend",d),()=>{u.clearTimeout(c),t.removeEventListener("animationstart",h),t.removeEventListener("animationcancel",d),t.removeEventListener("animationend",d)}}else l("ANIMATION_END")},[t,l]),{isPresent:["mounted","unmountSuspended"].includes(o),ref:T.useCallback(c=>{r.current=c?getComputedStyle(c):null,n(c)},[])}}function TS(e){return(e==null?void 0:e.animationName)||"none"}function kwe(e){var r,s;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(s=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:s.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var Ewe=Symbol("radix.slottable");function Twe(e){const t=({children:n})=>f.jsx(f.Fragment,{children:n});return t.displayName=`${e}.Slottable`,t.__radixId=Ewe,t}var Awe=VW[" useInsertionEffect ".trim().toString()]||ni;function Pc({prop:e,defaultProp:t,onChange:n=()=>{},caller:r}){const[s,i,a]=Rwe({defaultProp:t,onChange:n}),o=e!==void 0,l=o?e:s;{const u=T.useRef(e!==void 0);T.useEffect(()=>{const d=u.current;d!==o&&console.warn(`${r} is changing from ${d?"controlled":"uncontrolled"} to ${o?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),u.current=o},[o,r])}const c=T.useCallback(u=>{var d;if(o){const h=Nwe(u)?u(e):u;h!==e&&((d=a.current)==null||d.call(a,h))}else i(u)},[o,e,i,a]);return[l,c]}function Rwe({defaultProp:e,onChange:t}){const[n,r]=T.useState(e),s=T.useRef(n),i=T.useRef(t);return Awe(()=>{i.current=t},[t]),T.useEffect(()=>{var a;s.current!==n&&((a=i.current)==null||a.call(i,n),s.current=n)},[n,s]),[n,r,i]}function Nwe(e){return typeof e=="function"}var Mwe=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),Iwe="VisuallyHidden",nK=T.forwardRef((e,t)=>f.jsx(ar.span,{...e,ref:t,style:{...Mwe,...e.style}}));nK.displayName=Iwe;var jwe=nK,[NE,$ut]=Hi("Tooltip",[AE]),ME=AE(),rK="TooltipProvider",Pwe=700,mj="tooltip.open",[Owe,gO]=NE(rK),sK=e=>{const{__scopeTooltip:t,delayDuration:n=Pwe,skipDelayDuration:r=300,disableHoverableContent:s=!1,children:i}=e,a=T.useRef(!0),o=T.useRef(!1),l=T.useRef(0);return T.useEffect(()=>{const c=l.current;return()=>window.clearTimeout(c)},[]),f.jsx(Owe,{scope:t,isOpenDelayedRef:a,delayDuration:n,onOpen:T.useCallback(()=>{window.clearTimeout(l.current),a.current=!1},[]),onClose:T.useCallback(()=>{window.clearTimeout(l.current),l.current=window.setTimeout(()=>a.current=!0,r)},[r]),isPointerInTransitRef:o,onPointerInTransitChange:T.useCallback(c=>{o.current=c},[]),disableHoverableContent:s,children:i})};sK.displayName=rK;var Zx="Tooltip",[Dwe,f1]=NE(Zx),iK=e=>{const{__scopeTooltip:t,children:n,open:r,defaultOpen:s,onOpenChange:i,disableHoverableContent:a,delayDuration:o}=e,l=gO(Zx,e.__scopeTooltip),c=ME(t),[u,d]=T.useState(null),h=aa(),m=T.useRef(0),y=a??l.disableHoverableContent,b=o??l.delayDuration,v=T.useRef(!1),[x,w]=Pc({prop:r,defaultProp:s??!1,onChange:R=>{R?(l.onOpen(),document.dispatchEvent(new CustomEvent(mj))):l.onClose(),i==null||i(R)},caller:Zx}),S=T.useMemo(()=>x?v.current?"delayed-open":"instant-open":"closed",[x]),C=T.useCallback(()=>{window.clearTimeout(m.current),m.current=0,v.current=!1,w(!0)},[w]),k=T.useCallback(()=>{window.clearTimeout(m.current),m.current=0,w(!1)},[w]),A=T.useCallback(()=>{window.clearTimeout(m.current),m.current=window.setTimeout(()=>{v.current=!0,w(!0),m.current=0},b)},[b,w]);return T.useEffect(()=>()=>{m.current&&(window.clearTimeout(m.current),m.current=0)},[]),f.jsx(JG,{...c,children:f.jsx(Dwe,{scope:t,contentId:h,open:x,stateAttribute:S,trigger:u,onTriggerChange:d,onTriggerEnter:T.useCallback(()=>{l.isOpenDelayedRef.current?A():C()},[l.isOpenDelayedRef,A,C]),onTriggerLeave:T.useCallback(()=>{y?k():(window.clearTimeout(m.current),m.current=0)},[k,y]),onOpen:C,onClose:k,disableHoverableContent:y,children:n})})};iK.displayName=Zx;var gj="TooltipTrigger",aK=T.forwardRef((e,t)=>{const{__scopeTooltip:n,...r}=e,s=f1(gj,n),i=gO(gj,n),a=ME(n),o=T.useRef(null),l=Rn(t,o,s.onTriggerChange),c=T.useRef(!1),u=T.useRef(!1),d=T.useCallback(()=>c.current=!1,[]);return T.useEffect(()=>()=>document.removeEventListener("pointerup",d),[d]),f.jsx(QG,{asChild:!0,...a,children:f.jsx(ar.button,{"aria-describedby":s.open?s.contentId:void 0,"data-state":s.stateAttribute,...r,ref:l,onPointerMove:Wt(e.onPointerMove,h=>{h.pointerType!=="touch"&&!u.current&&!i.isPointerInTransitRef.current&&(s.onTriggerEnter(),u.current=!0)}),onPointerLeave:Wt(e.onPointerLeave,()=>{s.onTriggerLeave(),u.current=!1}),onPointerDown:Wt(e.onPointerDown,()=>{s.open&&s.onClose(),c.current=!0,document.addEventListener("pointerup",d,{once:!0})}),onFocus:Wt(e.onFocus,()=>{c.current||s.onOpen()}),onBlur:Wt(e.onBlur,s.onClose),onClick:Wt(e.onClick,s.onClose)})})});aK.displayName=gj;var yO="TooltipPortal",[Fwe,Lwe]=NE(yO,{forceMount:void 0}),oK=e=>{const{__scopeTooltip:t,forceMount:n,children:r,container:s}=e,i=f1(yO,t);return f.jsx(Fwe,{scope:t,forceMount:n,children:f.jsx(la,{present:n||i.open,children:f.jsx(RE,{asChild:!0,container:s,children:r})})})};oK.displayName=yO;var ty="TooltipContent",lK=T.forwardRef((e,t)=>{const n=Lwe(ty,e.__scopeTooltip),{forceMount:r=n.forceMount,side:s="top",...i}=e,a=f1(ty,e.__scopeTooltip);return f.jsx(la,{present:r||a.open,children:a.disableHoverableContent?f.jsx(cK,{side:s,...i,ref:t}):f.jsx(Bwe,{side:s,...i,ref:t})})}),Bwe=T.forwardRef((e,t)=>{const n=f1(ty,e.__scopeTooltip),r=gO(ty,e.__scopeTooltip),s=T.useRef(null),i=Rn(t,s),[a,o]=T.useState(null),{trigger:l,onClose:c}=n,u=s.current,{onPointerInTransitChange:d}=r,h=T.useCallback(()=>{o(null),d(!1)},[d]),m=T.useCallback((y,b)=>{const v=y.currentTarget,x={x:y.clientX,y:y.clientY},w=qwe(x,v.getBoundingClientRect()),S=Vwe(x,w),C=Wwe(b.getBoundingClientRect()),k=Gwe([...S,...C]);o(k),d(!0)},[d]);return T.useEffect(()=>()=>h(),[h]),T.useEffect(()=>{if(l&&u){const y=v=>m(v,u),b=v=>m(v,l);return l.addEventListener("pointerleave",y),u.addEventListener("pointerleave",b),()=>{l.removeEventListener("pointerleave",y),u.removeEventListener("pointerleave",b)}}},[l,u,m,h]),T.useEffect(()=>{if(a){const y=b=>{const v=b.target,x={x:b.clientX,y:b.clientY},w=(l==null?void 0:l.contains(v))||(u==null?void 0:u.contains(v)),S=!Hwe(x,a);w?h():S&&(h(),c())};return document.addEventListener("pointermove",y),()=>document.removeEventListener("pointermove",y)}},[l,u,a,c,h]),f.jsx(cK,{...e,ref:i})}),[$we,zwe]=NE(Zx,{isInside:!1}),Uwe=Twe("TooltipContent"),cK=T.forwardRef((e,t)=>{const{__scopeTooltip:n,children:r,"aria-label":s,onEscapeKeyDown:i,onPointerDownOutside:a,...o}=e,l=f1(ty,n),c=ME(n),{onClose:u}=l;return T.useEffect(()=>(document.addEventListener(mj,u),()=>document.removeEventListener(mj,u)),[u]),T.useEffect(()=>{if(l.trigger){const d=h=>{const m=h.target;m!=null&&m.contains(l.trigger)&&u()};return window.addEventListener("scroll",d,{capture:!0}),()=>window.removeEventListener("scroll",d,{capture:!0})}},[l.trigger,u]),f.jsx(CE,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:i,onPointerDownOutside:a,onFocusOutside:d=>d.preventDefault(),onDismiss:u,children:f.jsxs(eK,{"data-state":l.stateAttribute,...c,...o,ref:t,style:{...o.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[f.jsx(Uwe,{children:r}),f.jsx($we,{scope:n,isInside:!0,children:f.jsx(jwe,{id:l.contentId,role:"tooltip",children:s||r})})]})})});lK.displayName=ty;var uK="TooltipArrow",dK=T.forwardRef((e,t)=>{const{__scopeTooltip:n,...r}=e,s=ME(n);return zwe(uK,n).isInside?null:f.jsx(tK,{...s,...r,ref:t})});dK.displayName=uK;function qwe(e,t){const n=Math.abs(t.top-e.y),r=Math.abs(t.bottom-e.y),s=Math.abs(t.right-e.x),i=Math.abs(t.left-e.x);switch(Math.min(n,r,s,i)){case i:return"left";case s:return"right";case n:return"top";case r:return"bottom";default:throw new Error("unreachable")}}function Vwe(e,t,n=5){const r=[];switch(t){case"top":r.push({x:e.x-n,y:e.y+n},{x:e.x+n,y:e.y+n});break;case"bottom":r.push({x:e.x-n,y:e.y-n},{x:e.x+n,y:e.y-n});break;case"left":r.push({x:e.x+n,y:e.y-n},{x:e.x+n,y:e.y+n});break;case"right":r.push({x:e.x-n,y:e.y-n},{x:e.x-n,y:e.y+n});break}return r}function Wwe(e){const{top:t,right:n,bottom:r,left:s}=e;return[{x:s,y:t},{x:n,y:t},{x:n,y:r},{x:s,y:r}]}function Hwe(e,t){const{x:n,y:r}=e;let s=!1;for(let i=0,a=t.length-1;i<t.length;a=i++){const o=t[i],l=t[a],c=o.x,u=o.y,d=l.x,h=l.y;u>r!=h>r&&n<(d-c)*(r-u)/(h-u)+c&&(s=!s)}return s}function Gwe(e){const t=e.slice();return t.sort((n,r)=>n.x<r.x?-1:n.x>r.x?1:n.y<r.y?-1:n.y>r.y?1:0),Kwe(t)}function Kwe(e){if(e.length<=1)return e.slice();const t=[];for(let r=0;r<e.length;r++){const s=e[r];for(;t.length>=2;){const i=t[t.length-1],a=t[t.length-2];if((i.x-a.x)*(s.y-a.y)>=(i.y-a.y)*(s.x-a.x))t.pop();else break}t.push(s)}t.pop();const n=[];for(let r=e.length-1;r>=0;r--){const s=e[r];for(;n.length>=2;){const i=n[n.length-1],a=n[n.length-2];if((i.x-a.x)*(s.y-a.y)>=(i.y-a.y)*(s.x-a.x))n.pop();else break}n.push(s)}return n.pop(),t.length===1&&n.length===1&&t[0].x===n[0].x&&t[0].y===n[0].y?t:t.concat(n)}var Ywe=sK,Zwe=iK,Xwe=aK,Jwe=oK,Qwe=lK,e1e=dK;function xr({delayDuration:e=0,...t}){return f.jsx(Ywe,{"data-slot":"tooltip-provider",delayDuration:e,...t})}function wr({...e}){return f.jsx(xr,{children:f.jsx(Zwe,{"data-slot":"tooltip",...e})})}function _r({...e}){return f.jsx(Xwe,{"data-slot":"tooltip-trigger",...e})}function Sr({className:e,sideOffset:t=0,children:n,...r}){return f.jsx(Jwe,{children:f.jsxs(Qwe,{"data-slot":"tooltip-content",sideOffset:t,className:Ze("bg-primary text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-fit origin-(--radix-tooltip-content-transform-origin) rounded-md px-3 py-1.5 text-xs text-balance",e),...r,children:[n,f.jsx(e1e,{className:"bg-primary fill-primary z-50 size-2.5 translate-y-[calc(-50%_-_2px)] rotate-45 rounded-[2px]"})]})})}var GN={exports:{}},I$;function t1e(){return I$||(I$=1,function(e){var t=typeof window<"u"?window:typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope?self:{};/**
 * Prism: Lightweight, robust, elegant syntax highlighting
 *
 * @license MIT <https://opensource.org/licenses/MIT>
 * @author Lea Verou <https://lea.verou.me>
 * @namespace
 * @public
 */var n=function(r){var s=/(?:^|\s)lang(?:uage)?-([\w-]+)(?=\s|$)/i,i=0,a={},o={manual:r.Prism&&r.Prism.manual,disableWorkerMessageHandler:r.Prism&&r.Prism.disableWorkerMessageHandler,util:{encode:function w(S){return S instanceof l?new l(S.type,w(S.content),S.alias):Array.isArray(S)?S.map(w):S.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ")},type:function(w){return Object.prototype.toString.call(w).slice(8,-1)},objId:function(w){return w.__id||Object.defineProperty(w,"__id",{value:++i}),w.__id},clone:function w(S,C){C=C||{};var k,A;switch(o.util.type(S)){case"Object":if(A=o.util.objId(S),C[A])return C[A];k={},C[A]=k;for(var R in S)S.hasOwnProperty(R)&&(k[R]=w(S[R],C));return k;case"Array":return A=o.util.objId(S),C[A]?C[A]:(k=[],C[A]=k,S.forEach(function(N,I){k[I]=w(N,C)}),k);default:return S}},getLanguage:function(w){for(;w;){var S=s.exec(w.className);if(S)return S[1].toLowerCase();w=w.parentElement}return"none"},setLanguage:function(w,S){w.className=w.className.replace(RegExp(s,"gi"),""),w.classList.add("language-"+S)},currentScript:function(){if(typeof document>"u")return null;if(document.currentScript&&document.currentScript.tagName==="SCRIPT")return document.currentScript;try{throw new Error}catch(k){var w=(/at [^(\r\n]*\((.*):[^:]+:[^:]+\)$/i.exec(k.stack)||[])[1];if(w){var S=document.getElementsByTagName("script");for(var C in S)if(S[C].src==w)return S[C]}return null}},isActive:function(w,S,C){for(var k="no-"+S;w;){var A=w.classList;if(A.contains(S))return!0;if(A.contains(k))return!1;w=w.parentElement}return!!C}},languages:{plain:a,plaintext:a,text:a,txt:a,extend:function(w,S){var C=o.util.clone(o.languages[w]);for(var k in S)C[k]=S[k];return C},insertBefore:function(w,S,C,k){k=k||o.languages;var A=k[w],R={};for(var N in A)if(A.hasOwnProperty(N)){if(N==S)for(var I in C)C.hasOwnProperty(I)&&(R[I]=C[I]);C.hasOwnProperty(N)||(R[N]=A[N])}var P=k[w];return k[w]=R,o.languages.DFS(o.languages,function(L,O){O===P&&L!=w&&(this[L]=R)}),R},DFS:function w(S,C,k,A){A=A||{};var R=o.util.objId;for(var N in S)if(S.hasOwnProperty(N)){C.call(S,N,S[N],k||N);var I=S[N],P=o.util.type(I);P==="Object"&&!A[R(I)]?(A[R(I)]=!0,w(I,C,null,A)):P==="Array"&&!A[R(I)]&&(A[R(I)]=!0,w(I,C,N,A))}}},plugins:{},highlightAll:function(w,S){o.highlightAllUnder(document,w,S)},highlightAllUnder:function(w,S,C){var k={callback:C,container:w,selector:'code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'};o.hooks.run("before-highlightall",k),k.elements=Array.prototype.slice.apply(k.container.querySelectorAll(k.selector)),o.hooks.run("before-all-elements-highlight",k);for(var A=0,R;R=k.elements[A++];)o.highlightElement(R,S===!0,k.callback)},highlightElement:function(w,S,C){var k=o.util.getLanguage(w),A=o.languages[k];o.util.setLanguage(w,k);var R=w.parentElement;R&&R.nodeName.toLowerCase()==="pre"&&o.util.setLanguage(R,k);var N=w.textContent,I={element:w,language:k,grammar:A,code:N};function P(O){I.highlightedCode=O,o.hooks.run("before-insert",I),I.element.innerHTML=I.highlightedCode,o.hooks.run("after-highlight",I),o.hooks.run("complete",I),C&&C.call(I.element)}if(o.hooks.run("before-sanity-check",I),R=I.element.parentElement,R&&R.nodeName.toLowerCase()==="pre"&&!R.hasAttribute("tabindex")&&R.setAttribute("tabindex","0"),!I.code){o.hooks.run("complete",I),C&&C.call(I.element);return}if(o.hooks.run("before-highlight",I),!I.grammar){P(o.util.encode(I.code));return}if(S&&r.Worker){var L=new Worker(o.filename);L.onmessage=function(O){P(O.data)},L.postMessage(JSON.stringify({language:I.language,code:I.code,immediateClose:!0}))}else P(o.highlight(I.code,I.grammar,I.language))},highlight:function(w,S,C){var k={code:w,grammar:S,language:C};if(o.hooks.run("before-tokenize",k),!k.grammar)throw new Error('The language "'+k.language+'" has no grammar.');return k.tokens=o.tokenize(k.code,k.grammar),o.hooks.run("after-tokenize",k),l.stringify(o.util.encode(k.tokens),k.language)},tokenize:function(w,S){var C=S.rest;if(C){for(var k in C)S[k]=C[k];delete S.rest}var A=new d;return h(A,A.head,w),u(w,A,S,A.head,0),y(A)},hooks:{all:{},add:function(w,S){var C=o.hooks.all;C[w]=C[w]||[],C[w].push(S)},run:function(w,S){var C=o.hooks.all[w];if(!(!C||!C.length))for(var k=0,A;A=C[k++];)A(S)}},Token:l};r.Prism=o;function l(w,S,C,k){this.type=w,this.content=S,this.alias=C,this.length=(k||"").length|0}l.stringify=function w(S,C){if(typeof S=="string")return S;if(Array.isArray(S)){var k="";return S.forEach(function(P){k+=w(P,C)}),k}var A={type:S.type,content:w(S.content,C),tag:"span",classes:["token",S.type],attributes:{},language:C},R=S.alias;R&&(Array.isArray(R)?Array.prototype.push.apply(A.classes,R):A.classes.push(R)),o.hooks.run("wrap",A);var N="";for(var I in A.attributes)N+=" "+I+'="'+(A.attributes[I]||"").replace(/"/g,"&quot;")+'"';return"<"+A.tag+' class="'+A.classes.join(" ")+'"'+N+">"+A.content+"</"+A.tag+">"};function c(w,S,C,k){w.lastIndex=S;var A=w.exec(C);if(A&&k&&A[1]){var R=A[1].length;A.index+=R,A[0]=A[0].slice(R)}return A}function u(w,S,C,k,A,R){for(var N in C)if(!(!C.hasOwnProperty(N)||!C[N])){var I=C[N];I=Array.isArray(I)?I:[I];for(var P=0;P<I.length;++P){if(R&&R.cause==N+","+P)return;var L=I[P],O=L.inside,V=!!L.lookbehind,D=!!L.greedy,Z=L.alias;if(D&&!L.pattern.global){var U=L.pattern.toString().match(/[imsuy]*$/)[0];L.pattern=RegExp(L.pattern.source,U+"g")}for(var H=L.pattern||L,$=k.next,ne=A;$!==S.tail&&!(R&&ne>=R.reach);ne+=$.value.length,$=$.next){var W=$.value;if(S.length>w.length)return;if(!(W instanceof l)){var Q=1,ee;if(D){if(ee=c(H,ne,w,V),!ee||ee.index>=w.length)break;var Ie=ee.index,se=ee.index+ee[0].length,pe=ne;for(pe+=$.value.length;Ie>=pe;)$=$.next,pe+=$.value.length;if(pe-=$.value.length,ne=pe,$.value instanceof l)continue;for(var ce=$;ce!==S.tail&&(pe<se||typeof ce.value=="string");ce=ce.next)Q++,pe+=ce.value.length;Q--,W=w.slice(ne,pe),ee.index-=ne}else if(ee=c(H,0,W,V),!ee)continue;var Ie=ee.index,De=ee[0],Se=W.slice(0,Ie),Ce=W.slice(Ie+De.length),qe=ne+W.length;R&&qe>R.reach&&(R.reach=qe);var Qe=$.prev;Se&&(Qe=h(S,Qe,Se),ne+=Se.length),m(S,Qe,Q);var Ve=new l(N,O?o.tokenize(De,O):De,Z,De);if($=h(S,Qe,Ve),Ce&&h(S,$,Ce),Q>1){var Ne={cause:N+","+P,reach:qe};u(w,S,C,$.prev,ne,Ne),R&&Ne.reach>R.reach&&(R.reach=Ne.reach)}}}}}}function d(){var w={value:null,prev:null,next:null},S={value:null,prev:w,next:null};w.next=S,this.head=w,this.tail=S,this.length=0}function h(w,S,C){var k=S.next,A={value:C,prev:S,next:k};return S.next=A,k.prev=A,w.length++,A}function m(w,S,C){for(var k=S.next,A=0;A<C&&k!==w.tail;A++)k=k.next;S.next=k,k.prev=S,w.length-=A}function y(w){for(var S=[],C=w.head.next;C!==w.tail;)S.push(C.value),C=C.next;return S}if(!r.document)return r.addEventListener&&(o.disableWorkerMessageHandler||r.addEventListener("message",function(w){var S=JSON.parse(w.data),C=S.language,k=S.code,A=S.immediateClose;r.postMessage(o.highlight(k,o.languages[C],C)),A&&r.close()},!1)),o;var b=o.util.currentScript();b&&(o.filename=b.src,b.hasAttribute("data-manual")&&(o.manual=!0));function v(){o.manual||o.highlightAll()}if(!o.manual){var x=document.readyState;x==="loading"||x==="interactive"&&b&&b.defer?document.addEventListener("DOMContentLoaded",v):window.requestAnimationFrame?window.requestAnimationFrame(v):window.setTimeout(v,16)}return o}(t);e.exports&&(e.exports=n),typeof Xp<"u"&&(Xp.Prism=n),n.languages.markup={comment:{pattern:/<!--(?:(?!<!--)[\s\S])*?-->/,greedy:!0},prolog:{pattern:/<\?[\s\S]+?\?>/,greedy:!0},doctype:{pattern:/<!DOCTYPE(?:[^>"'[\]]|"[^"]*"|'[^']*')+(?:\[(?:[^<"'\]]|"[^"]*"|'[^']*'|<(?!!--)|<!--(?:[^-]|-(?!->))*-->)*\]\s*)?>/i,greedy:!0,inside:{"internal-subset":{pattern:/(^[^\[]*\[)[\s\S]+(?=\]>$)/,lookbehind:!0,greedy:!0,inside:null},string:{pattern:/"[^"]*"|'[^']*'/,greedy:!0},punctuation:/^<!|>$|[[\]]/,"doctype-tag":/^DOCTYPE/i,name:/[^\s<>'"]+/}},cdata:{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,greedy:!0},tag:{pattern:/<\/?(?!\d)[^\s>\/=$<%]+(?:\s(?:\s*[^\s>\/=]+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))|(?=[\s/>])))+)?\s*\/?>/,greedy:!0,inside:{tag:{pattern:/^<\/?[^\s>\/]+/,inside:{punctuation:/^<\/?/,namespace:/^[^\s>\/:]+:/}},"special-attr":[],"attr-value":{pattern:/=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+)/,inside:{punctuation:[{pattern:/^=/,alias:"attr-equals"},{pattern:/^(\s*)["']|["']$/,lookbehind:!0}]}},punctuation:/\/?>/,"attr-name":{pattern:/[^\s>\/]+/,inside:{namespace:/^[^\s>\/:]+:/}}}},entity:[{pattern:/&[\da-z]{1,8};/i,alias:"named-entity"},/&#x?[\da-f]{1,8};/i]},n.languages.markup.tag.inside["attr-value"].inside.entity=n.languages.markup.entity,n.languages.markup.doctype.inside["internal-subset"].inside=n.languages.markup,n.hooks.add("wrap",function(r){r.type==="entity"&&(r.attributes.title=r.content.replace(/&amp;/,"&"))}),Object.defineProperty(n.languages.markup.tag,"addInlined",{value:function(s,i){var a={};a["language-"+i]={pattern:/(^<!\[CDATA\[)[\s\S]+?(?=\]\]>$)/i,lookbehind:!0,inside:n.languages[i]},a.cdata=/^<!\[CDATA\[|\]\]>$/i;var o={"included-cdata":{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,inside:a}};o["language-"+i]={pattern:/[\s\S]+/,inside:n.languages[i]};var l={};l[s]={pattern:RegExp(/(<__[^>]*>)(?:<!\[CDATA\[(?:[^\]]|\](?!\]>))*\]\]>|(?!<!\[CDATA\[)[\s\S])*?(?=<\/__>)/.source.replace(/__/g,function(){return s}),"i"),lookbehind:!0,greedy:!0,inside:o},n.languages.insertBefore("markup","cdata",l)}}),Object.defineProperty(n.languages.markup.tag,"addAttribute",{value:function(r,s){n.languages.markup.tag.inside["special-attr"].push({pattern:RegExp(/(^|["'\s])/.source+"(?:"+r+")"+/\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))/.source,"i"),lookbehind:!0,inside:{"attr-name":/^[^\s=]+/,"attr-value":{pattern:/=[\s\S]+/,inside:{value:{pattern:/(^=\s*(["']|(?!["'])))\S[\s\S]*(?=\2$)/,lookbehind:!0,alias:[s,"language-"+s],inside:n.languages[s]},punctuation:[{pattern:/^=/,alias:"attr-equals"},/"|'/]}}}})}}),n.languages.html=n.languages.markup,n.languages.mathml=n.languages.markup,n.languages.svg=n.languages.markup,n.languages.xml=n.languages.extend("markup",{}),n.languages.ssml=n.languages.xml,n.languages.atom=n.languages.xml,n.languages.rss=n.languages.xml,function(r){var s=/(?:"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n])*')/;r.languages.css={comment:/\/\*[\s\S]*?\*\//,atrule:{pattern:RegExp("@[\\w-](?:"+/[^;{\s"']|\s+(?!\s)/.source+"|"+s.source+")*?"+/(?:;|(?=\s*\{))/.source),inside:{rule:/^@[\w-]+/,"selector-function-argument":{pattern:/(\bselector\s*\(\s*(?![\s)]))(?:[^()\s]|\s+(?![\s)])|\((?:[^()]|\([^()]*\))*\))+(?=\s*\))/,lookbehind:!0,alias:"selector"},keyword:{pattern:/(^|[^\w-])(?:and|not|only|or)(?![\w-])/,lookbehind:!0}}},url:{pattern:RegExp("\\burl\\((?:"+s.source+"|"+/(?:[^\\\r\n()"']|\\[\s\S])*/.source+")\\)","i"),greedy:!0,inside:{function:/^url/i,punctuation:/^\(|\)$/,string:{pattern:RegExp("^"+s.source+"$"),alias:"url"}}},selector:{pattern:RegExp(`(^|[{}\\s])[^{}\\s](?:[^{};"'\\s]|\\s+(?![\\s{])|`+s.source+")*(?=\\s*\\{)"),lookbehind:!0},string:{pattern:s,greedy:!0},property:{pattern:/(^|[^-\w\xA0-\uFFFF])(?!\s)[-_a-z\xA0-\uFFFF](?:(?!\s)[-\w\xA0-\uFFFF])*(?=\s*:)/i,lookbehind:!0},important:/!important\b/i,function:{pattern:/(^|[^-a-z0-9])[-a-z0-9]+(?=\()/i,lookbehind:!0},punctuation:/[(){};:,]/},r.languages.css.atrule.inside.rest=r.languages.css;var i=r.languages.markup;i&&(i.tag.addInlined("style","css"),i.tag.addAttribute("style","css"))}(n),n.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\s\S]*?(?:\*\/|$)/,lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|trait)\s+|\bcatch\s+\()[\w.\\]+/i,lookbehind:!0,inside:{punctuation:/[.\\]/}},keyword:/\b(?:break|catch|continue|do|else|finally|for|function|if|in|instanceof|new|null|return|throw|try|while)\b/,boolean:/\b(?:false|true)\b/,function:/\b\w+(?=\()/,number:/\b0x[\da-f]+\b|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?/i,operator:/[<>]=?|[!=]=?=?|--?|\+\+?|&&?|\|\|?|[?*/~^%]/,punctuation:/[{}[\];(),.:]/},n.languages.javascript=n.languages.extend("clike",{"class-name":[n.languages.clike["class-name"],{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$A-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\.(?:constructor|prototype))/,lookbehind:!0}],keyword:[{pattern:/((?:^|\})\s*)catch\b/,lookbehind:!0},{pattern:/(^|[^.]|\.\.\.\s*)\b(?:as|assert(?=\s*\{)|async(?=\s*(?:function\b|\(|[$\w\xA0-\uFFFF]|$))|await|break|case|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally(?=\s*(?:\{|$))|for|from(?=\s*(?:['"]|$))|function|(?:get|set)(?=\s*(?:[#\[$\w\xA0-\uFFFF]|$))|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)\b/,lookbehind:!0}],function:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*(?:\.\s*(?:apply|bind|call)\s*)?\()/,number:{pattern:RegExp(/(^|[^\w$])/.source+"(?:"+(/NaN|Infinity/.source+"|"+/0[bB][01]+(?:_[01]+)*n?/.source+"|"+/0[oO][0-7]+(?:_[0-7]+)*n?/.source+"|"+/0[xX][\dA-Fa-f]+(?:_[\dA-Fa-f]+)*n?/.source+"|"+/\d+(?:_\d+)*n/.source+"|"+/(?:\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\.\d+(?:_\d+)*)(?:[Ee][+-]?\d+(?:_\d+)*)?/.source)+")"+/(?![\w$])/.source),lookbehind:!0},operator:/--|\+\+|\*\*=?|=>|&&=?|\|\|=?|[!=]==|<<=?|>>>?=?|[-+*/%&|^!=<>]=?|\.{3}|\?\?=?|\?\.?|[~:]/}),n.languages.javascript["class-name"][0].pattern=/(\b(?:class|extends|implements|instanceof|interface|new)\s+)[\w.\\]+/,n.languages.insertBefore("javascript","keyword",{regex:{pattern:RegExp(/((?:^|[^$\w\xA0-\uFFFF."'\])\s]|\b(?:return|yield))\s*)/.source+/\//.source+"(?:"+/(?:\[(?:[^\]\\\r\n]|\\.)*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}/.source+"|"+/(?:\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.)*\])*\])*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}v[dgimyus]{0,7}/.source+")"+/(?=(?:\s|\/\*(?:[^*]|\*(?!\/))*\*\/)*(?:$|[\r\n,.;:})\]]|\/\/))/.source),lookbehind:!0,greedy:!0,inside:{"regex-source":{pattern:/^(\/)[\s\S]+(?=\/[a-z]*$)/,lookbehind:!0,alias:"language-regex",inside:n.languages.regex},"regex-delimiter":/^\/|\/$/,"regex-flags":/^[a-z]+$/}},"function-variable":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*[=:]\s*(?:async\s*)?(?:\bfunction\b|(?:\((?:[^()]|\([^()]*\))*\)|(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)\s*=>))/,alias:"function"},parameter:[{pattern:/(function(?:\s+(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)?\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\))/,lookbehind:!0,inside:n.languages.javascript},{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$a-z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*=>)/i,lookbehind:!0,inside:n.languages.javascript},{pattern:/(\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*=>)/,lookbehind:!0,inside:n.languages.javascript},{pattern:/((?:\b|\s|^)(?!(?:as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)(?![$\w\xA0-\uFFFF]))(?:(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*)\(\s*|\]\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*\{)/,lookbehind:!0,inside:n.languages.javascript}],constant:/\b[A-Z](?:[A-Z_]|\dx?)*\b/}),n.languages.insertBefore("javascript","string",{hashbang:{pattern:/^#!.*/,greedy:!0,alias:"comment"},"template-string":{pattern:/`(?:\\[\s\S]|\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}|(?!\$\{)[^\\`])*`/,greedy:!0,inside:{"template-punctuation":{pattern:/^`|`$/,alias:"string"},interpolation:{pattern:/((?:^|[^\\])(?:\\{2})*)\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}/,lookbehind:!0,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:"punctuation"},rest:n.languages.javascript}},string:/[\s\S]+/}},"string-property":{pattern:/((?:^|[,{])[ \t]*)(["'])(?:\\(?:\r\n|[\s\S])|(?!\2)[^\\\r\n])*\2(?=\s*:)/m,lookbehind:!0,greedy:!0,alias:"property"}}),n.languages.insertBefore("javascript","operator",{"literal-property":{pattern:/((?:^|[,{])[ \t]*)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*:)/m,lookbehind:!0,alias:"property"}}),n.languages.markup&&(n.languages.markup.tag.addInlined("script","javascript"),n.languages.markup.tag.addAttribute(/on(?:abort|blur|change|click|composition(?:end|start|update)|dblclick|error|focus(?:in|out)?|key(?:down|up)|load|mouse(?:down|enter|leave|move|out|over|up)|reset|resize|scroll|select|slotchange|submit|unload|wheel)/.source,"javascript")),n.languages.js=n.languages.javascript,function(){if(typeof n>"u"||typeof document>"u")return;Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector);var r="Loading…",s=function(b,v){return"✖ Error "+b+" while fetching file: "+v},i="✖ Error: File does not exist or is empty",a={js:"javascript",py:"python",rb:"ruby",ps1:"powershell",psm1:"powershell",sh:"bash",bat:"batch",h:"c",tex:"latex"},o="data-src-status",l="loading",c="loaded",u="failed",d="pre[data-src]:not(["+o+'="'+c+'"]):not(['+o+'="'+l+'"])';function h(b,v,x){var w=new XMLHttpRequest;w.open("GET",b,!0),w.onreadystatechange=function(){w.readyState==4&&(w.status<400&&w.responseText?v(w.responseText):w.status>=400?x(s(w.status,w.statusText)):x(i))},w.send(null)}function m(b){var v=/^\s*(\d+)\s*(?:(,)\s*(?:(\d+)\s*)?)?$/.exec(b||"");if(v){var x=Number(v[1]),w=v[2],S=v[3];return w?S?[x,Number(S)]:[x,void 0]:[x,x]}}n.hooks.add("before-highlightall",function(b){b.selector+=", "+d}),n.hooks.add("before-sanity-check",function(b){var v=b.element;if(v.matches(d)){b.code="",v.setAttribute(o,l);var x=v.appendChild(document.createElement("CODE"));x.textContent=r;var w=v.getAttribute("data-src"),S=b.language;if(S==="none"){var C=(/\.(\w+)$/.exec(w)||[,"none"])[1];S=a[C]||C}n.util.setLanguage(x,S),n.util.setLanguage(v,S);var k=n.plugins.autoloader;k&&k.loadLanguages(S),h(w,function(A){v.setAttribute(o,c);var R=m(v.getAttribute("data-range"));if(R){var N=A.split(/\r\n?|\n/g),I=R[0],P=R[1]==null?N.length:R[1];I<0&&(I+=N.length),I=Math.max(0,Math.min(I-1,N.length)),P<0&&(P+=N.length),P=Math.max(0,Math.min(P,N.length)),A=N.slice(I,P).join(`
`),v.hasAttribute("data-start")||v.setAttribute("data-start",String(I+1))}x.textContent=A,n.highlightElement(x)},function(A){v.setAttribute(o,u),x.textContent=A})}}),n.plugins.fileHighlight={highlight:function(v){for(var x=(v||document).querySelectorAll(d),w=0,S;S=x[w++];)n.highlightElement(S)}};var y=!1;n.fileHighlight=function(){y||(console.warn("Prism.fileHighlight is deprecated. Use `Prism.plugins.fileHighlight.highlight` instead."),y=!0),n.plugins.fileHighlight.highlight.apply(this,arguments)}}()}(GN)),GN.exports}var n1e=t1e();const r1e=_a(n1e);var j$={},P$;function s1e(){return P$||(P$=1,function(e){e.languages.typescript=e.languages.extend("javascript",{"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|type)\s+)(?!keyof\b)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?:\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>)?/,lookbehind:!0,greedy:!0,inside:null},builtin:/\b(?:Array|Function|Promise|any|boolean|console|never|number|string|symbol|unknown)\b/}),e.languages.typescript.keyword.push(/\b(?:abstract|declare|is|keyof|readonly|require)\b/,/\b(?:asserts|infer|interface|module|namespace|type)\b(?=\s*(?:[{_$a-zA-Z\xA0-\uFFFF]|$))/,/\btype\b(?=\s*(?:[\{*]|$))/),delete e.languages.typescript.parameter,delete e.languages.typescript["literal-property"];var t=e.languages.extend("typescript",{});delete t["class-name"],e.languages.typescript["class-name"].inside=t,e.languages.insertBefore("typescript","function",{decorator:{pattern:/@[$\w\xA0-\uFFFF]+/,inside:{at:{pattern:/^@/,alias:"operator"},function:/^[\s\S]+/}},"generic-function":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>(?=\s*\()/,greedy:!0,inside:{function:/^#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*/,generic:{pattern:/<[\s\S]+/,alias:"class-name",inside:t}}}}),e.languages.ts=e.languages.typescript}(Prism)),j$}s1e();var O$={},D$;function i1e(){return D$||(D$=1,Prism.languages.python={comment:{pattern:/(^|[^\\])#.*/,lookbehind:!0,greedy:!0},"string-interpolation":{pattern:/(?:f|fr|rf)(?:("""|''')[\s\S]*?\1|("|')(?:\\.|(?!\2)[^\\\r\n])*\2)/i,greedy:!0,inside:{interpolation:{pattern:/((?:^|[^{])(?:\{\{)*)\{(?!\{)(?:[^{}]|\{(?!\{)(?:[^{}]|\{(?!\{)(?:[^{}])+\})+\})+\}/,lookbehind:!0,inside:{"format-spec":{pattern:/(:)[^:(){}]+(?=\}$)/,lookbehind:!0},"conversion-option":{pattern:/![sra](?=[:}]$)/,alias:"punctuation"},rest:null}},string:/[\s\S]+/}},"triple-quoted-string":{pattern:/(?:[rub]|br|rb)?("""|''')[\s\S]*?\1/i,greedy:!0,alias:"string"},string:{pattern:/(?:[rub]|br|rb)?("|')(?:\\.|(?!\1)[^\\\r\n])*\1/i,greedy:!0},function:{pattern:/((?:^|\s)def[ \t]+)[a-zA-Z_]\w*(?=\s*\()/g,lookbehind:!0},"class-name":{pattern:/(\bclass\s+)\w+/i,lookbehind:!0},decorator:{pattern:/(^[\t ]*)@\w+(?:\.\w+)*/m,lookbehind:!0,alias:["annotation","punctuation"],inside:{punctuation:/\./}},keyword:/\b(?:_(?=\s*:)|and|as|assert|async|await|break|case|class|continue|def|del|elif|else|except|exec|finally|for|from|global|if|import|in|is|lambda|match|nonlocal|not|or|pass|print|raise|return|try|while|with|yield)\b/,builtin:/\b(?:__import__|abs|all|any|apply|ascii|basestring|bin|bool|buffer|bytearray|bytes|callable|chr|classmethod|cmp|coerce|compile|complex|delattr|dict|dir|divmod|enumerate|eval|execfile|file|filter|float|format|frozenset|getattr|globals|hasattr|hash|help|hex|id|input|int|intern|isinstance|issubclass|iter|len|list|locals|long|map|max|memoryview|min|next|object|oct|open|ord|pow|property|range|raw_input|reduce|reload|repr|reversed|round|set|setattr|slice|sorted|staticmethod|str|sum|super|tuple|type|unichr|unicode|vars|xrange|zip)\b/,boolean:/\b(?:False|None|True)\b/,number:/\b0(?:b(?:_?[01])+|o(?:_?[0-7])+|x(?:_?[a-f0-9])+)\b|(?:\b\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\B\.\d+(?:_\d+)*)(?:e[+-]?\d+(?:_\d+)*)?j?(?!\w)/i,operator:/[-+%=]=?|!=|:=|\*\*?=?|\/\/?=?|<[<=>]?|>[=>]?|[&|^~]/,punctuation:/[{}[\];(),.:]/},Prism.languages.python["string-interpolation"].inside.interpolation.inside.rest=Prism.languages.python,Prism.languages.py=Prism.languages.python),O$}i1e();(function(e){var t="\\b(?:BASH|BASHOPTS|BASH_ALIASES|BASH_ARGC|BASH_ARGV|BASH_CMDS|BASH_COMPLETION_COMPAT_DIR|BASH_LINENO|BASH_REMATCH|BASH_SOURCE|BASH_VERSINFO|BASH_VERSION|COLORTERM|COLUMNS|COMP_WORDBREAKS|DBUS_SESSION_BUS_ADDRESS|DEFAULTS_PATH|DESKTOP_SESSION|DIRSTACK|DISPLAY|EUID|GDMSESSION|GDM_LANG|GNOME_KEYRING_CONTROL|GNOME_KEYRING_PID|GPG_AGENT_INFO|GROUPS|HISTCONTROL|HISTFILE|HISTFILESIZE|HISTSIZE|HOME|HOSTNAME|HOSTTYPE|IFS|INSTANCE|JOB|LANG|LANGUAGE|LC_ADDRESS|LC_ALL|LC_IDENTIFICATION|LC_MEASUREMENT|LC_MONETARY|LC_NAME|LC_NUMERIC|LC_PAPER|LC_TELEPHONE|LC_TIME|LESSCLOSE|LESSOPEN|LINES|LOGNAME|LS_COLORS|MACHTYPE|MAILCHECK|MANDATORY_PATH|NO_AT_BRIDGE|OLDPWD|OPTERR|OPTIND|ORBIT_SOCKETDIR|OSTYPE|PAPERSIZE|PATH|PIPESTATUS|PPID|PS1|PS2|PS3|PS4|PWD|RANDOM|REPLY|SECONDS|SELINUX_INIT|SESSION|SESSIONTYPE|SESSION_MANAGER|SHELL|SHELLOPTS|SHLVL|SSH_AUTH_SOCK|TERM|UID|UPSTART_EVENTS|UPSTART_INSTANCE|UPSTART_JOB|UPSTART_SESSION|USER|WINDOWID|XAUTHORITY|XDG_CONFIG_DIRS|XDG_CURRENT_DESKTOP|XDG_DATA_DIRS|XDG_GREETER_DATA_DIR|XDG_MENU_PREFIX|XDG_RUNTIME_DIR|XDG_SEAT|XDG_SEAT_PATH|XDG_SESSION_DESKTOP|XDG_SESSION_ID|XDG_SESSION_PATH|XDG_SESSION_TYPE|XDG_VTNR|XMODIFIERS)\\b",n={pattern:/(^(["']?)\w+\2)[ \t]+\S.*/,lookbehind:!0,alias:"punctuation",inside:null},r={bash:n,environment:{pattern:RegExp("\\$"+t),alias:"constant"},variable:[{pattern:/\$?\(\([\s\S]+?\)\)/,greedy:!0,inside:{variable:[{pattern:/(^\$\(\([\s\S]+)\)\)/,lookbehind:!0},/^\$\(\(/],number:/\b0x[\dA-Fa-f]+\b|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:[Ee]-?\d+)?/,operator:/--|\+\+|\*\*=?|<<=?|>>=?|&&|\|\||[=!+\-*/%<>^&|]=?|[?~:]/,punctuation:/\(\(?|\)\)?|,|;/}},{pattern:/\$\((?:\([^)]+\)|[^()])+\)|`[^`]+`/,greedy:!0,inside:{variable:/^\$\(|^`|\)$|`$/}},{pattern:/\$\{[^}]+\}/,greedy:!0,inside:{operator:/:[-=?+]?|[!\/]|##?|%%?|\^\^?|,,?/,punctuation:/[\[\]]/,environment:{pattern:RegExp("(\\{)"+t),lookbehind:!0,alias:"constant"}}},/\$(?:\w+|[#?*!@$])/],entity:/\\(?:[abceEfnrtv\\"]|O?[0-7]{1,3}|U[0-9a-fA-F]{8}|u[0-9a-fA-F]{4}|x[0-9a-fA-F]{1,2})/};e.languages.bash={shebang:{pattern:/^#!\s*\/.*/,alias:"important"},comment:{pattern:/(^|[^"{\\$])#.*/,lookbehind:!0},"function-name":[{pattern:/(\bfunction\s+)[\w-]+(?=(?:\s*\(?:\s*\))?\s*\{)/,lookbehind:!0,alias:"function"},{pattern:/\b[\w-]+(?=\s*\(\s*\)\s*\{)/,alias:"function"}],"for-or-select":{pattern:/(\b(?:for|select)\s+)\w+(?=\s+in\s)/,alias:"variable",lookbehind:!0},"assign-left":{pattern:/(^|[\s;|&]|[<>]\()\w+(?:\.\w+)*(?=\+?=)/,inside:{environment:{pattern:RegExp("(^|[\\s;|&]|[<>]\\()"+t),lookbehind:!0,alias:"constant"}},alias:"variable",lookbehind:!0},parameter:{pattern:/(^|\s)-{1,2}(?:\w+:[+-]?)?\w+(?:\.\w+)*(?=[=\s]|$)/,alias:"variable",lookbehind:!0},string:[{pattern:/((?:^|[^<])<<-?\s*)(\w+)\s[\s\S]*?(?:\r?\n|\r)\2/,lookbehind:!0,greedy:!0,inside:r},{pattern:/((?:^|[^<])<<-?\s*)(["'])(\w+)\2\s[\s\S]*?(?:\r?\n|\r)\3/,lookbehind:!0,greedy:!0,inside:{bash:n}},{pattern:/(^|[^\\](?:\\\\)*)"(?:\\[\s\S]|\$\([^)]+\)|\$(?!\()|`[^`]+`|[^"\\`$])*"/,lookbehind:!0,greedy:!0,inside:r},{pattern:/(^|[^$\\])'[^']*'/,lookbehind:!0,greedy:!0},{pattern:/\$'(?:[^'\\]|\\[\s\S])*'/,greedy:!0,inside:{entity:r.entity}}],environment:{pattern:RegExp("\\$?"+t),alias:"constant"},variable:r.variable,function:{pattern:/(^|[\s;|&]|[<>]\()(?:add|apropos|apt|apt-cache|apt-get|aptitude|aspell|automysqlbackup|awk|basename|bash|bc|bconsole|bg|bzip2|cal|cargo|cat|cfdisk|chgrp|chkconfig|chmod|chown|chroot|cksum|clear|cmp|column|comm|composer|cp|cron|crontab|csplit|curl|cut|date|dc|dd|ddrescue|debootstrap|df|diff|diff3|dig|dir|dircolors|dirname|dirs|dmesg|docker|docker-compose|du|egrep|eject|env|ethtool|expand|expect|expr|fdformat|fdisk|fg|fgrep|file|find|fmt|fold|format|free|fsck|ftp|fuser|gawk|git|gparted|grep|groupadd|groupdel|groupmod|groups|grub-mkconfig|gzip|halt|head|hg|history|host|hostname|htop|iconv|id|ifconfig|ifdown|ifup|import|install|ip|java|jobs|join|kill|killall|less|link|ln|locate|logname|logrotate|look|lpc|lpr|lprint|lprintd|lprintq|lprm|ls|lsof|lynx|make|man|mc|mdadm|mkconfig|mkdir|mke2fs|mkfifo|mkfs|mkisofs|mknod|mkswap|mmv|more|most|mount|mtools|mtr|mutt|mv|nano|nc|netstat|nice|nl|node|nohup|notify-send|npm|nslookup|op|open|parted|passwd|paste|pathchk|ping|pkill|pnpm|podman|podman-compose|popd|pr|printcap|printenv|ps|pushd|pv|quota|quotacheck|quotactl|ram|rar|rcp|reboot|remsync|rename|renice|rev|rm|rmdir|rpm|rsync|scp|screen|sdiff|sed|sendmail|seq|service|sftp|sh|shellcheck|shuf|shutdown|sleep|slocate|sort|split|ssh|stat|strace|su|sudo|sum|suspend|swapon|sync|sysctl|tac|tail|tar|tee|time|timeout|top|touch|tr|traceroute|tsort|tty|umount|uname|unexpand|uniq|units|unrar|unshar|unzip|update-grub|uptime|useradd|userdel|usermod|users|uudecode|uuencode|v|vcpkg|vdir|vi|vim|virsh|vmstat|wait|watch|wc|wget|whereis|which|who|whoami|write|xargs|xdg-open|yarn|yes|zenity|zip|zsh|zypper)(?=$|[)\s;|&])/,lookbehind:!0},keyword:{pattern:/(^|[\s;|&]|[<>]\()(?:case|do|done|elif|else|esac|fi|for|function|if|in|select|then|until|while)(?=$|[)\s;|&])/,lookbehind:!0},builtin:{pattern:/(^|[\s;|&]|[<>]\()(?:\.|:|alias|bind|break|builtin|caller|cd|command|continue|declare|echo|enable|eval|exec|exit|export|getopts|hash|help|let|local|logout|mapfile|printf|pwd|read|readarray|readonly|return|set|shift|shopt|source|test|times|trap|type|typeset|ulimit|umask|unalias|unset)(?=$|[)\s;|&])/,lookbehind:!0,alias:"class-name"},boolean:{pattern:/(^|[\s;|&]|[<>]\()(?:false|true)(?=$|[)\s;|&])/,lookbehind:!0},"file-descriptor":{pattern:/\B&\d\b/,alias:"important"},operator:{pattern:/\d?<>|>\||\+=|=[=~]?|!=?|<<[<-]?|[&\d]?>>|\d[<>]&?|[<>][&=]?|&[>&]?|\|[&|]?/,inside:{"file-descriptor":{pattern:/^\d/,alias:"important"}}},punctuation:/\$?\(\(?|\)\)?|\.\.|[{}[\];\\]/,number:{pattern:/(^|\s)(?:[1-9]\d*|0)(?:[.,]\d+)?\b/,lookbehind:!0}},n.inside=e.languages.bash;for(var s=["comment","function-name","for-or-select","assign-left","parameter","string","environment","function","keyword","builtin","boolean","file-descriptor","operator","punctuation","number"],i=r.variable[1].inside,a=0;a<s.length;a++)i[s[a]]=e.languages.bash[s[a]];e.languages.sh=e.languages.bash,e.languages.shell=e.languages.bash})(Prism);Prism.languages.json={property:{pattern:/(^|[^\\])"(?:\\.|[^\\"\r\n])*"(?=\s*:)/,lookbehind:!0,greedy:!0},string:{pattern:/(^|[^\\])"(?:\\.|[^\\"\r\n])*"(?!\s*:)/,lookbehind:!0,greedy:!0},comment:{pattern:/\/\/.*|\/\*[\s\S]*?(?:\*\/|$)/,greedy:!0},number:/-?\b\d+(?:\.\d+)?(?:e[+-]?\d+)?\b/i,punctuation:/[{}[\],]/,operator:/:/,boolean:/\b(?:false|true)\b/,null:{pattern:/\bnull\b/,alias:"keyword"}};Prism.languages.webmanifest=Prism.languages.json;(function(e){var t=/(?:\\.|[^\\\n\r]|(?:\n|\r\n?)(?![\r\n]))/.source;function n(u){return u=u.replace(/<inner>/g,function(){return t}),RegExp(/((?:^|[^\\])(?:\\{2})*)/.source+"(?:"+u+")")}var r=/(?:\\.|``(?:[^`\r\n]|`(?!`))+``|`[^`\r\n]+`|[^\\|\r\n`])+/.source,s=/\|?__(?:\|__)+\|?(?:(?:\n|\r\n?)|(?![\s\S]))/.source.replace(/__/g,function(){return r}),i=/\|?[ \t]*:?-{3,}:?[ \t]*(?:\|[ \t]*:?-{3,}:?[ \t]*)+\|?(?:\n|\r\n?)/.source;e.languages.markdown=e.languages.extend("markup",{}),e.languages.insertBefore("markdown","prolog",{"front-matter-block":{pattern:/(^(?:\s*[\r\n])?)---(?!.)[\s\S]*?[\r\n]---(?!.)/,lookbehind:!0,greedy:!0,inside:{punctuation:/^---|---$/,"front-matter":{pattern:/\S+(?:\s+\S+)*/,alias:["yaml","language-yaml"],inside:e.languages.yaml}}},blockquote:{pattern:/^>(?:[\t ]*>)*/m,alias:"punctuation"},table:{pattern:RegExp("^"+s+i+"(?:"+s+")*","m"),inside:{"table-data-rows":{pattern:RegExp("^("+s+i+")(?:"+s+")*$"),lookbehind:!0,inside:{"table-data":{pattern:RegExp(r),inside:e.languages.markdown},punctuation:/\|/}},"table-line":{pattern:RegExp("^("+s+")"+i+"$"),lookbehind:!0,inside:{punctuation:/\||:?-{3,}:?/}},"table-header-row":{pattern:RegExp("^"+s+"$"),inside:{"table-header":{pattern:RegExp(r),alias:"important",inside:e.languages.markdown},punctuation:/\|/}}}},code:[{pattern:/((?:^|\n)[ \t]*\n|(?:^|\r\n?)[ \t]*\r\n?)(?: {4}|\t).+(?:(?:\n|\r\n?)(?: {4}|\t).+)*/,lookbehind:!0,alias:"keyword"},{pattern:/^```[\s\S]*?^```$/m,greedy:!0,inside:{"code-block":{pattern:/^(```.*(?:\n|\r\n?))[\s\S]+?(?=(?:\n|\r\n?)^```$)/m,lookbehind:!0},"code-language":{pattern:/^(```).+/,lookbehind:!0},punctuation:/```/}}],title:[{pattern:/\S.*(?:\n|\r\n?)(?:==+|--+)(?=[ \t]*$)/m,alias:"important",inside:{punctuation:/==+$|--+$/}},{pattern:/(^\s*)#.+/m,lookbehind:!0,alias:"important",inside:{punctuation:/^#+|#+$/}}],hr:{pattern:/(^\s*)([*-])(?:[\t ]*\2){2,}(?=\s*$)/m,lookbehind:!0,alias:"punctuation"},list:{pattern:/(^\s*)(?:[*+-]|\d+\.)(?=[\t ].)/m,lookbehind:!0,alias:"punctuation"},"url-reference":{pattern:/!?\[[^\]]+\]:[\t ]+(?:\S+|<(?:\\.|[^>\\])+>)(?:[\t ]+(?:"(?:\\.|[^"\\])*"|'(?:\\.|[^'\\])*'|\((?:\\.|[^)\\])*\)))?/,inside:{variable:{pattern:/^(!?\[)[^\]]+/,lookbehind:!0},string:/(?:"(?:\\.|[^"\\])*"|'(?:\\.|[^'\\])*'|\((?:\\.|[^)\\])*\))$/,punctuation:/^[\[\]!:]|[<>]/},alias:"url"},bold:{pattern:n(/\b__(?:(?!_)<inner>|_(?:(?!_)<inner>)+_)+__\b|\*\*(?:(?!\*)<inner>|\*(?:(?!\*)<inner>)+\*)+\*\*/.source),lookbehind:!0,greedy:!0,inside:{content:{pattern:/(^..)[\s\S]+(?=..$)/,lookbehind:!0,inside:{}},punctuation:/\*\*|__/}},italic:{pattern:n(/\b_(?:(?!_)<inner>|__(?:(?!_)<inner>)+__)+_\b|\*(?:(?!\*)<inner>|\*\*(?:(?!\*)<inner>)+\*\*)+\*/.source),lookbehind:!0,greedy:!0,inside:{content:{pattern:/(^.)[\s\S]+(?=.$)/,lookbehind:!0,inside:{}},punctuation:/[*_]/}},strike:{pattern:n(/(~~?)(?:(?!~)<inner>)+\2/.source),lookbehind:!0,greedy:!0,inside:{content:{pattern:/(^~~?)[\s\S]+(?=\1$)/,lookbehind:!0,inside:{}},punctuation:/~~?/}},"code-snippet":{pattern:/(^|[^\\`])(?:``[^`\r\n]+(?:`[^`\r\n]+)*``(?!`)|`[^`\r\n]+`(?!`))/,lookbehind:!0,greedy:!0,alias:["code","keyword"]},url:{pattern:n(/!?\[(?:(?!\])<inner>)+\](?:\([^\s)]+(?:[\t ]+"(?:\\.|[^"\\])*")?\)|[ \t]?\[(?:(?!\])<inner>)+\])/.source),lookbehind:!0,greedy:!0,inside:{operator:/^!/,content:{pattern:/(^\[)[^\]]+(?=\])/,lookbehind:!0,inside:{}},variable:{pattern:/(^\][ \t]?\[)[^\]]+(?=\]$)/,lookbehind:!0},url:{pattern:/(^\]\()[^\s)]+/,lookbehind:!0},string:{pattern:/(^[ \t]+)"(?:\\.|[^"\\])*"(?=\)$)/,lookbehind:!0}}}}),["url","bold","italic","strike"].forEach(function(u){["url","bold","italic","strike","code-snippet"].forEach(function(d){u!==d&&(e.languages.markdown[u].inside.content.inside[d]=e.languages.markdown[d])})}),e.hooks.add("after-tokenize",function(u){if(u.language!=="markdown"&&u.language!=="md")return;function d(h){if(!(!h||typeof h=="string"))for(var m=0,y=h.length;m<y;m++){var b=h[m];if(b.type!=="code"){d(b.content);continue}var v=b.content[1],x=b.content[3];if(v&&x&&v.type==="code-language"&&x.type==="code-block"&&typeof v.content=="string"){var w=v.content.replace(/\b#/g,"sharp").replace(/\b\+\+/g,"pp");w=(/[a-z][\w-]*/i.exec(w)||[""])[0].toLowerCase();var S="language-"+w;x.alias?typeof x.alias=="string"?x.alias=[x.alias,S]:x.alias.push(S):x.alias=[S]}}}d(u.tokens)}),e.hooks.add("wrap",function(u){if(u.type==="code-block"){for(var d="",h=0,m=u.classes.length;h<m;h++){var y=u.classes[h],b=/language-(.+)/.exec(y);if(b){d=b[1];break}}var v=e.languages[d];if(v)u.content=e.highlight(c(u.content),v,d);else if(d&&d!=="none"&&e.plugins.autoloader){var x="md-"+new Date().valueOf()+"-"+Math.floor(Math.random()*1e16);u.attributes.id=x,e.plugins.autoloader.loadLanguages(d,function(){var w=document.getElementById(x);w&&(w.innerHTML=e.highlight(w.textContent,e.languages[d],d))})}}});var a=RegExp(e.languages.markup.tag.pattern.source,"gi"),o={amp:"&",lt:"<",gt:">",quot:'"'},l=String.fromCodePoint||String.fromCharCode;function c(u){var d=u.replace(a,"");return d=d.replace(/&(\w{1,8}|#x?[\da-f]{1,8});/gi,function(h,m){if(m=m.toLowerCase(),m[0]==="#"){var y;return m[1]==="x"?y=parseInt(m.slice(2),16):y=Number(m.slice(1)),l(y)}else{var b=o[m];return b||h}}),d}e.languages.md=e.languages.markdown})(Prism);(function(e){e.languages.diff={coord:[/^(?:\*{3}|-{3}|\+{3}).*$/m,/^@@.*@@$/m,/^\d.*$/m]};var t={"deleted-sign":"-","deleted-arrow":"<","inserted-sign":"+","inserted-arrow":">",unchanged:" ",diff:"!"};Object.keys(t).forEach(function(n){var r=t[n],s=[];/^\w+$/.test(n)||s.push(/\w+/.exec(n)[0]),n==="diff"&&s.push("bold"),e.languages.diff[n]={pattern:RegExp("^(?:["+r+`].*(?:\r
?|
|(?![\\s\\S])))+`,"m"),alias:s,inside:{line:{pattern:/(.)(?=[\s\S]).*(?:\r\n?|\n)?/,lookbehind:!0},prefix:{pattern:/[\s\S]/,alias:/\w+/.exec(n)[0]}}}}),Object.defineProperty(e.languages.diff,"PREFIXES",{value:t})})(Prism);Prism.languages.go=Prism.languages.extend("clike",{string:{pattern:/(^|[^\\])"(?:\\.|[^"\\\r\n])*"|`[^`]*`/,lookbehind:!0,greedy:!0},keyword:/\b(?:break|case|chan|const|continue|default|defer|else|fallthrough|for|func|go(?:to)?|if|import|interface|map|package|range|return|select|struct|switch|type|var)\b/,boolean:/\b(?:_|false|iota|nil|true)\b/,number:[/\b0(?:b[01_]+|o[0-7_]+)i?\b/i,/\b0x(?:[a-f\d_]+(?:\.[a-f\d_]*)?|\.[a-f\d_]+)(?:p[+-]?\d+(?:_\d+)*)?i?(?!\w)/i,/(?:\b\d[\d_]*(?:\.[\d_]*)?|\B\.\d[\d_]*)(?:e[+-]?[\d_]+)?i?(?!\w)/i],operator:/[*\/%^!=]=?|\+[=+]?|-[=-]?|\|[=|]?|&(?:=|&|\^=?)?|>(?:>=?|=)?|<(?:<=?|=|-)?|:=|\.\.\./,builtin:/\b(?:append|bool|byte|cap|close|complex|complex(?:64|128)|copy|delete|error|float(?:32|64)|u?int(?:8|16|32|64)?|imag|len|make|new|panic|print(?:ln)?|real|recover|rune|string|uintptr)\b/});Prism.languages.insertBefore("go","string",{char:{pattern:/'(?:\\.|[^'\\\r\n]){0,10}'/,greedy:!0}});delete Prism.languages.go["class-name"];(function(e){var t=/[*&][^\s[\]{},]+/,n=/!(?:<[\w\-%#;/?:@&=+$,.!~*'()[\]]+>|(?:[a-zA-Z\d-]*!)?[\w\-%#;/?:@&=+$.~*'()]+)?/,r="(?:"+n.source+"(?:[ 	]+"+t.source+")?|"+t.source+"(?:[ 	]+"+n.source+")?)",s=/(?:[^\s\x00-\x08\x0e-\x1f!"#%&'*,\-:>?@[\]`{|}\x7f-\x84\x86-\x9f\ud800-\udfff\ufffe\uffff]|[?:-]<PLAIN>)(?:[ \t]*(?:(?![#:])<PLAIN>|:<PLAIN>))*/.source.replace(/<PLAIN>/g,function(){return/[^\s\x00-\x08\x0e-\x1f,[\]{}\x7f-\x84\x86-\x9f\ud800-\udfff\ufffe\uffff]/.source}),i=/"(?:[^"\\\r\n]|\\.)*"|'(?:[^'\\\r\n]|\\.)*'/.source;function a(o,l){l=(l||"").replace(/m/g,"")+"m";var c=/([:\-,[{]\s*(?:\s<<prop>>[ \t]+)?)(?:<<value>>)(?=[ \t]*(?:$|,|\]|\}|(?:[\r\n]\s*)?#))/.source.replace(/<<prop>>/g,function(){return r}).replace(/<<value>>/g,function(){return o});return RegExp(c,l)}e.languages.yaml={scalar:{pattern:RegExp(/([\-:]\s*(?:\s<<prop>>[ \t]+)?[|>])[ \t]*(?:((?:\r?\n|\r)[ \t]+)\S[^\r\n]*(?:\2[^\r\n]+)*)/.source.replace(/<<prop>>/g,function(){return r})),lookbehind:!0,alias:"string"},comment:/#.*/,key:{pattern:RegExp(/((?:^|[:\-,[{\r\n?])[ \t]*(?:<<prop>>[ \t]+)?)<<key>>(?=\s*:\s)/.source.replace(/<<prop>>/g,function(){return r}).replace(/<<key>>/g,function(){return"(?:"+s+"|"+i+")"})),lookbehind:!0,greedy:!0,alias:"atrule"},directive:{pattern:/(^[ \t]*)%.+/m,lookbehind:!0,alias:"important"},datetime:{pattern:a(/\d{4}-\d\d?-\d\d?(?:[tT]|[ \t]+)\d\d?:\d{2}:\d{2}(?:\.\d*)?(?:[ \t]*(?:Z|[-+]\d\d?(?::\d{2})?))?|\d{4}-\d{2}-\d{2}|\d\d?:\d{2}(?::\d{2}(?:\.\d*)?)?/.source),lookbehind:!0,alias:"number"},boolean:{pattern:a(/false|true/.source,"i"),lookbehind:!0,alias:"important"},null:{pattern:a(/null|~/.source,"i"),lookbehind:!0,alias:"important"},string:{pattern:a(i),lookbehind:!0,greedy:!0},number:{pattern:a(/[+-]?(?:0x[\da-f]+|0o[0-7]+|(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?|\.inf|\.nan)/.source,"i"),lookbehind:!0},tag:n,important:t,punctuation:/---|[:[\]{}\-,|>?]|\.\.\./},e.languages.yml=e.languages.yaml})(Prism);var F$={},L$;function a1e(){return L$||(L$=1,function(e){for(var t=/\/\*(?:[^*/]|\*(?!\/)|\/(?!\*)|<self>)*\*\//.source,n=0;n<2;n++)t=t.replace(/<self>/g,function(){return t});t=t.replace(/<self>/g,function(){return/[^\s\S]/.source}),e.languages.rust={comment:[{pattern:RegExp(/(^|[^\\])/.source+t),lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/b?"(?:\\[\s\S]|[^\\"])*"|b?r(#*)"(?:[^"]|"(?!\1))*"\1/,greedy:!0},char:{pattern:/b?'(?:\\(?:x[0-7][\da-fA-F]|u\{(?:[\da-fA-F]_*){1,6}\}|.)|[^\\\r\n\t'])'/,greedy:!0},attribute:{pattern:/#!?\[(?:[^\[\]"]|"(?:\\[\s\S]|[^\\"])*")*\]/,greedy:!0,alias:"attr-name",inside:{string:null}},"closure-params":{pattern:/([=(,:]\s*|\bmove\s*)\|[^|]*\||\|[^|]*\|(?=\s*(?:\{|->))/,lookbehind:!0,greedy:!0,inside:{"closure-punctuation":{pattern:/^\||\|$/,alias:"punctuation"},rest:null}},"lifetime-annotation":{pattern:/'\w+/,alias:"symbol"},"fragment-specifier":{pattern:/(\$\w+:)[a-z]+/,lookbehind:!0,alias:"punctuation"},variable:/\$\w+/,"function-definition":{pattern:/(\bfn\s+)\w+/,lookbehind:!0,alias:"function"},"type-definition":{pattern:/(\b(?:enum|struct|trait|type|union)\s+)\w+/,lookbehind:!0,alias:"class-name"},"module-declaration":[{pattern:/(\b(?:crate|mod)\s+)[a-z][a-z_\d]*/,lookbehind:!0,alias:"namespace"},{pattern:/(\b(?:crate|self|super)\s*)::\s*[a-z][a-z_\d]*\b(?:\s*::(?:\s*[a-z][a-z_\d]*\s*::)*)?/,lookbehind:!0,alias:"namespace",inside:{punctuation:/::/}}],keyword:[/\b(?:Self|abstract|as|async|await|become|box|break|const|continue|crate|do|dyn|else|enum|extern|final|fn|for|if|impl|in|let|loop|macro|match|mod|move|mut|override|priv|pub|ref|return|self|static|struct|super|trait|try|type|typeof|union|unsafe|unsized|use|virtual|where|while|yield)\b/,/\b(?:bool|char|f(?:32|64)|[ui](?:8|16|32|64|128|size)|str)\b/],function:/\b[a-z_]\w*(?=\s*(?:::\s*<|\())/,macro:{pattern:/\b\w+!/,alias:"property"},constant:/\b[A-Z_][A-Z_\d]+\b/,"class-name":/\b[A-Z]\w*\b/,namespace:{pattern:/(?:\b[a-z][a-z_\d]*\s*::\s*)*\b[a-z][a-z_\d]*\s*::(?!\s*<)/,inside:{punctuation:/::/}},number:/\b(?:0x[\dA-Fa-f](?:_?[\dA-Fa-f])*|0o[0-7](?:_?[0-7])*|0b[01](?:_?[01])*|(?:(?:\d(?:_?\d)*)?\.)?\d(?:_?\d)*(?:[Ee][+-]?\d+)?)(?:_?(?:f32|f64|[iu](?:8|16|32|64|size)?))?\b/,boolean:/\b(?:false|true)\b/,punctuation:/->|\.\.=|\.{1,3}|::|[{}[\];(),:]/,operator:/[-+*\/%!^]=?|=[=>]?|&[&=]?|\|[|=]?|<<?=?|>>?=?|[@?]/},e.languages.rust["closure-params"].inside.rest=e.languages.rust,e.languages.rust.attribute.inside.string=e.languages.rust.string}(Prism)),F$}a1e();Prism.languages.sql={comment:{pattern:/(^|[^\\])(?:\/\*[\s\S]*?\*\/|(?:--|\/\/|#).*)/,lookbehind:!0},variable:[{pattern:/@(["'`])(?:\\[\s\S]|(?!\1)[^\\])+\1/,greedy:!0},/@[\w.$]+/],string:{pattern:/(^|[^@\\])("|')(?:\\[\s\S]|(?!\2)[^\\]|\2\2)*\2/,greedy:!0,lookbehind:!0},identifier:{pattern:/(^|[^@\\])`(?:\\[\s\S]|[^`\\]|``)*`/,greedy:!0,lookbehind:!0,inside:{punctuation:/^`|`$/}},function:/\b(?:AVG|COUNT|FIRST|FORMAT|LAST|LCASE|LEN|MAX|MID|MIN|MOD|NOW|ROUND|SUM|UCASE)(?=\s*\()/i,keyword:/\b(?:ACTION|ADD|AFTER|ALGORITHM|ALL|ALTER|ANALYZE|ANY|APPLY|AS|ASC|AUTHORIZATION|AUTO_INCREMENT|BACKUP|BDB|BEGIN|BERKELEYDB|BIGINT|BINARY|BIT|BLOB|BOOL|BOOLEAN|BREAK|BROWSE|BTREE|BULK|BY|CALL|CASCADED?|CASE|CHAIN|CHAR(?:ACTER|SET)?|CHECK(?:POINT)?|CLOSE|CLUSTERED|COALESCE|COLLATE|COLUMNS?|COMMENT|COMMIT(?:TED)?|COMPUTE|CONNECT|CONSISTENT|CONSTRAINT|CONTAINS(?:TABLE)?|CONTINUE|CONVERT|CREATE|CROSS|CURRENT(?:_DATE|_TIME|_TIMESTAMP|_USER)?|CURSOR|CYCLE|DATA(?:BASES?)?|DATE(?:TIME)?|DAY|DBCC|DEALLOCATE|DEC|DECIMAL|DECLARE|DEFAULT|DEFINER|DELAYED|DELETE|DELIMITERS?|DENY|DESC|DESCRIBE|DETERMINISTIC|DISABLE|DISCARD|DISK|DISTINCT|DISTINCTROW|DISTRIBUTED|DO|DOUBLE|DROP|DUMMY|DUMP(?:FILE)?|DUPLICATE|ELSE(?:IF)?|ENABLE|ENCLOSED|END|ENGINE|ENUM|ERRLVL|ERRORS|ESCAPED?|EXCEPT|EXEC(?:UTE)?|EXISTS|EXIT|EXPLAIN|EXTENDED|FETCH|FIELDS|FILE|FILLFACTOR|FIRST|FIXED|FLOAT|FOLLOWING|FOR(?: EACH ROW)?|FORCE|FOREIGN|FREETEXT(?:TABLE)?|FROM|FULL|FUNCTION|GEOMETRY(?:COLLECTION)?|GLOBAL|GOTO|GRANT|GROUP|HANDLER|HASH|HAVING|HOLDLOCK|HOUR|IDENTITY(?:COL|_INSERT)?|IF|IGNORE|IMPORT|INDEX|INFILE|INNER|INNODB|INOUT|INSERT|INT|INTEGER|INTERSECT|INTERVAL|INTO|INVOKER|ISOLATION|ITERATE|JOIN|KEYS?|KILL|LANGUAGE|LAST|LEAVE|LEFT|LEVEL|LIMIT|LINENO|LINES|LINESTRING|LOAD|LOCAL|LOCK|LONG(?:BLOB|TEXT)|LOOP|MATCH(?:ED)?|MEDIUM(?:BLOB|INT|TEXT)|MERGE|MIDDLEINT|MINUTE|MODE|MODIFIES|MODIFY|MONTH|MULTI(?:LINESTRING|POINT|POLYGON)|NATIONAL|NATURAL|NCHAR|NEXT|NO|NONCLUSTERED|NULLIF|NUMERIC|OFF?|OFFSETS?|ON|OPEN(?:DATASOURCE|QUERY|ROWSET)?|OPTIMIZE|OPTION(?:ALLY)?|ORDER|OUT(?:ER|FILE)?|OVER|PARTIAL|PARTITION|PERCENT|PIVOT|PLAN|POINT|POLYGON|PRECEDING|PRECISION|PREPARE|PREV|PRIMARY|PRINT|PRIVILEGES|PROC(?:EDURE)?|PUBLIC|PURGE|QUICK|RAISERROR|READS?|REAL|RECONFIGURE|REFERENCES|RELEASE|RENAME|REPEAT(?:ABLE)?|REPLACE|REPLICATION|REQUIRE|RESIGNAL|RESTORE|RESTRICT|RETURN(?:ING|S)?|REVOKE|RIGHT|ROLLBACK|ROUTINE|ROW(?:COUNT|GUIDCOL|S)?|RTREE|RULE|SAVE(?:POINT)?|SCHEMA|SECOND|SELECT|SERIAL(?:IZABLE)?|SESSION(?:_USER)?|SET(?:USER)?|SHARE|SHOW|SHUTDOWN|SIMPLE|SMALLINT|SNAPSHOT|SOME|SONAME|SQL|START(?:ING)?|STATISTICS|STATUS|STRIPED|SYSTEM_USER|TABLES?|TABLESPACE|TEMP(?:ORARY|TABLE)?|TERMINATED|TEXT(?:SIZE)?|THEN|TIME(?:STAMP)?|TINY(?:BLOB|INT|TEXT)|TOP?|TRAN(?:SACTIONS?)?|TRIGGER|TRUNCATE|TSEQUAL|TYPES?|UNBOUNDED|UNCOMMITTED|UNDEFINED|UNION|UNIQUE|UNLOCK|UNPIVOT|UNSIGNED|UPDATE(?:TEXT)?|USAGE|USE|USER|USING|VALUES?|VAR(?:BINARY|CHAR|CHARACTER|YING)|VIEW|WAITFOR|WARNINGS|WHEN|WHERE|WHILE|WITH(?: ROLLUP|IN)?|WORK|WRITE(?:TEXT)?|YEAR)\b/i,boolean:/\b(?:FALSE|NULL|TRUE)\b/i,number:/\b0x[\da-f]+\b|\b\d+(?:\.\d*)?|\B\.\d+\b/i,operator:/[-+*\/=%^~]|&&?|\|\|?|!=?|<(?:=>?|<|>)?|>[>=]?|\b(?:AND|BETWEEN|DIV|ILIKE|IN|IS|LIKE|NOT|OR|REGEXP|RLIKE|SOUNDS LIKE|XOR)\b/i,punctuation:/[;[\]()`,.]/};const o1e=({lang:e,code:t,filepath:n,isStreaming:r=!1})=>{const{foldStreamingCodeBlocks:s}=yr(yn(b=>({foldStreamingCodeBlocks:b.foldStreamingCodeBlocks}))),[i,a]=T.useState(r?s:!1),o=T.useRef(null),l=jo(yn(b=>Object.values(b.canvasControls))),c=T.useCallback((b,v,x,w,S,C)=>l.filter(k=>k.type==="codeblock"&&k.targetSlot===b&&k.renderer).map(k=>{if(k.renderer){const A={codeBlockContent:v,codeBlockLang:x,codeBlockFilepath:w,isFolded:S,toggleFold:C,canvasContextType:"codeblock"};return f.jsx(We.Fragment,{children:k.renderer(A)},k.id)}return null}).filter(Boolean),[l]),u=T.useCallback(()=>{if(o.current&&t)try{o.current.style.whiteSpace!=="pre-wrap"&&(o.current.style.whiteSpace="pre-wrap"),o.current.textContent=t,r1e.highlightElement(o.current)}catch(b){console.error("Prism highlight error:",b),o.current.textContent=t}else o.current&&(o.current.textContent="")},[t]);T.useEffect(()=>{i||u()},[t,e,i,u]);const d=()=>{const b=i;a(v=>!v),b&&setTimeout(u,0)},h=e?`language-${e}`:"language-plaintext",m=T.useMemo(()=>t?t.split(`
`).slice(0,3).join(`
`):"",[t]),y=c("codeblock-header-actions",t,e,n,i,d);return f.jsxs("div",{className:"code-block-container group/codeblock my-4 max-w-full",children:[f.jsxs("div",{className:"code-block-header sticky top-0 z-10 flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx("div",{className:"text-sm font-medium",children:e?e.toUpperCase():"CODE"}),n&&f.jsx("div",{className:"text-xs text-muted-foreground font-mono",children:n}),f.jsx("div",{className:"flex items-center gap-0.5 opacity-0 group-hover/codeblock:opacity-100 focus-within:opacity-100 transition-opacity",children:y})]}),f.jsx("div",{})]}),!i&&f.jsx("div",{className:"overflow-hidden w-full",children:f.jsx("pre",{className:"overflow-x-auto w-full relative overflow-wrap-anywhere",children:f.jsx("code",{ref:o,className:h+" block"})})}),i&&f.jsx("div",{className:"folded-content-preview p-4 cursor-pointer w-full box-border",onClick:d,children:f.jsx("pre",{className:"whitespace-pre-wrap break-words text-muted-foreground font-mono text-sm",children:m})})]})},zy=T.memo(o1e);var yt;(function(e){e[e.EPERM=1]="EPERM",e[e.ENOENT=2]="ENOENT",e[e.EINTR=4]="EINTR",e[e.EIO=5]="EIO",e[e.ENXIO=6]="ENXIO",e[e.EBADF=9]="EBADF",e[e.EAGAIN=11]="EAGAIN",e[e.ENOMEM=12]="ENOMEM",e[e.EACCES=13]="EACCES",e[e.EFAULT=14]="EFAULT",e[e.ENOTBLK=15]="ENOTBLK",e[e.EBUSY=16]="EBUSY",e[e.EEXIST=17]="EEXIST",e[e.EXDEV=18]="EXDEV",e[e.ENODEV=19]="ENODEV",e[e.ENOTDIR=20]="ENOTDIR",e[e.EISDIR=21]="EISDIR",e[e.EINVAL=22]="EINVAL",e[e.ENFILE=23]="ENFILE",e[e.EMFILE=24]="EMFILE",e[e.ETXTBSY=26]="ETXTBSY",e[e.EFBIG=27]="EFBIG",e[e.ENOSPC=28]="ENOSPC",e[e.ESPIPE=29]="ESPIPE",e[e.EROFS=30]="EROFS",e[e.EMLINK=31]="EMLINK",e[e.EPIPE=32]="EPIPE",e[e.EDOM=33]="EDOM",e[e.ERANGE=34]="ERANGE",e[e.EDEADLK=35]="EDEADLK",e[e.ENAMETOOLONG=36]="ENAMETOOLONG",e[e.ENOLCK=37]="ENOLCK",e[e.ENOSYS=38]="ENOSYS",e[e.ENOTEMPTY=39]="ENOTEMPTY",e[e.ELOOP=40]="ELOOP",e[e.ENOMSG=42]="ENOMSG",e[e.EBADE=52]="EBADE",e[e.EBADR=53]="EBADR",e[e.EXFULL=54]="EXFULL",e[e.ENOANO=55]="ENOANO",e[e.EBADRQC=56]="EBADRQC",e[e.ENOSTR=60]="ENOSTR",e[e.ENODATA=61]="ENODATA",e[e.ETIME=62]="ETIME",e[e.ENOSR=63]="ENOSR",e[e.ENONET=64]="ENONET",e[e.EREMOTE=66]="EREMOTE",e[e.ENOLINK=67]="ENOLINK",e[e.ECOMM=70]="ECOMM",e[e.EPROTO=71]="EPROTO",e[e.EBADMSG=74]="EBADMSG",e[e.EOVERFLOW=75]="EOVERFLOW",e[e.EBADFD=77]="EBADFD",e[e.ESTRPIPE=86]="ESTRPIPE",e[e.ENOTSOCK=88]="ENOTSOCK",e[e.EDESTADDRREQ=89]="EDESTADDRREQ",e[e.EMSGSIZE=90]="EMSGSIZE",e[e.EPROTOTYPE=91]="EPROTOTYPE",e[e.ENOPROTOOPT=92]="ENOPROTOOPT",e[e.EPROTONOSUPPORT=93]="EPROTONOSUPPORT",e[e.ESOCKTNOSUPPORT=94]="ESOCKTNOSUPPORT",e[e.ENOTSUP=95]="ENOTSUP",e[e.ENETDOWN=100]="ENETDOWN",e[e.ENETUNREACH=101]="ENETUNREACH",e[e.ENETRESET=102]="ENETRESET",e[e.ETIMEDOUT=110]="ETIMEDOUT",e[e.ECONNREFUSED=111]="ECONNREFUSED",e[e.EHOSTDOWN=112]="EHOSTDOWN",e[e.EHOSTUNREACH=113]="EHOSTUNREACH",e[e.EALREADY=114]="EALREADY",e[e.EINPROGRESS=115]="EINPROGRESS",e[e.ESTALE=116]="ESTALE",e[e.EREMOTEIO=121]="EREMOTEIO",e[e.EDQUOT=122]="EDQUOT"})(yt||(yt={}));const B$={[yt.EPERM]:"Operation not permitted",[yt.ENOENT]:"No such file or directory",[yt.EINTR]:"Interrupted system call",[yt.EIO]:"Input/output error",[yt.ENXIO]:"No such device or address",[yt.EBADF]:"Bad file descriptor",[yt.EAGAIN]:"Resource temporarily unavailable",[yt.ENOMEM]:"Cannot allocate memory",[yt.EACCES]:"Permission denied",[yt.EFAULT]:"Bad address",[yt.ENOTBLK]:"Block device required",[yt.EBUSY]:"Resource busy or locked",[yt.EEXIST]:"File exists",[yt.EXDEV]:"Invalid cross-device link",[yt.ENODEV]:"No such device",[yt.ENOTDIR]:"File is not a directory",[yt.EISDIR]:"File is a directory",[yt.EINVAL]:"Invalid argument",[yt.ENFILE]:"Too many open files in system",[yt.EMFILE]:"Too many open files",[yt.ETXTBSY]:"Text file busy",[yt.EFBIG]:"File is too big",[yt.ENOSPC]:"No space left on disk",[yt.ESPIPE]:"Illegal seek",[yt.EROFS]:"Cannot modify a read-only file system",[yt.EMLINK]:"Too many links",[yt.EPIPE]:"Broken pipe",[yt.EDOM]:"Numerical argument out of domain",[yt.ERANGE]:"Numerical result out of range",[yt.EDEADLK]:"Resource deadlock would occur",[yt.ENAMETOOLONG]:"File name too long",[yt.ENOLCK]:"No locks available",[yt.ENOSYS]:"Function not implemented",[yt.ENOTEMPTY]:"Directory is not empty",[yt.ELOOP]:"Too many levels of symbolic links",[yt.ENOMSG]:"No message of desired type",[yt.EBADE]:"Invalid exchange",[yt.EBADR]:"Invalid request descriptor",[yt.EXFULL]:"Exchange full",[yt.ENOANO]:"No anode",[yt.EBADRQC]:"Invalid request code",[yt.ENOSTR]:"Device not a stream",[yt.ENODATA]:"No data available",[yt.ETIME]:"Timer expired",[yt.ENOSR]:"Out of streams resources",[yt.ENONET]:"Machine is not on the network",[yt.EREMOTE]:"Object is remote",[yt.ENOLINK]:"Link has been severed",[yt.ECOMM]:"Communication error on send",[yt.EPROTO]:"Protocol error",[yt.EBADMSG]:"Bad message",[yt.EOVERFLOW]:"Value too large for defined data type",[yt.EBADFD]:"File descriptor in bad state",[yt.ESTRPIPE]:"Streams pipe error",[yt.ENOTSOCK]:"Socket operation on non-socket",[yt.EDESTADDRREQ]:"Destination address required",[yt.EMSGSIZE]:"Message too long",[yt.EPROTOTYPE]:"Protocol wrong type for socket",[yt.ENOPROTOOPT]:"Protocol not available",[yt.EPROTONOSUPPORT]:"Protocol not supported",[yt.ESOCKTNOSUPPORT]:"Socket type not supported",[yt.ENOTSUP]:"Operation is not supported",[yt.ENETDOWN]:"Network is down",[yt.ENETUNREACH]:"Network is unreachable",[yt.ENETRESET]:"Network dropped connection on reset",[yt.ETIMEDOUT]:"Connection timed out",[yt.ECONNREFUSED]:"Connection refused",[yt.EHOSTDOWN]:"Host is down",[yt.EHOSTUNREACH]:"No route to host",[yt.EALREADY]:"Operation already in progress",[yt.EINPROGRESS]:"Operation now in progress",[yt.ESTALE]:"Stale file handle",[yt.EREMOTEIO]:"Remote I/O error",[yt.EDQUOT]:"Disk quota exceeded"};class Xe extends Error{static fromJSON(t){const n=new Xe(t.errno,t.message,t.path,t.syscall);return n.code=t.code,n.stack=t.stack,n}static With(t,n,r){return new Xe(yt[t],B$[yt[t]],n,r)}constructor(t,n=B$[t],r,s=""){super(n),this.errno=t,this.message=n,this.path=r,this.syscall=s,this.code=yt[t]}toString(){return this.code+": "+this.message+(this.path?`, '${this.path}'`:"")}toJSON(){return{errno:this.errno,code:this.code,path:this.path,stack:this.stack,message:this.message,syscall:this.syscall}}bufferSize(){return 4+JSON.stringify(this.toJSON()).length}}var KN={exports:{}},$$;function l1e(){return $$||($$=1,function(e){var t=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function s(l,c,u){this.fn=l,this.context=c,this.once=u||!1}function i(l,c,u,d,h){if(typeof u!="function")throw new TypeError("The listener must be a function");var m=new s(u,d||l,h),y=n?n+c:c;return l._events[y]?l._events[y].fn?l._events[y]=[l._events[y],m]:l._events[y].push(m):(l._events[y]=m,l._eventsCount++),l}function a(l,c){--l._eventsCount===0?l._events=new r:delete l._events[c]}function o(){this._events=new r,this._eventsCount=0}o.prototype.eventNames=function(){var c=[],u,d;if(this._eventsCount===0)return c;for(d in u=this._events)t.call(u,d)&&c.push(n?d.slice(1):d);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(u)):c},o.prototype.listeners=function(c){var u=n?n+c:c,d=this._events[u];if(!d)return[];if(d.fn)return[d.fn];for(var h=0,m=d.length,y=new Array(m);h<m;h++)y[h]=d[h].fn;return y},o.prototype.listenerCount=function(c){var u=n?n+c:c,d=this._events[u];return d?d.fn?1:d.length:0},o.prototype.emit=function(c,u,d,h,m,y){var b=n?n+c:c;if(!this._events[b])return!1;var v=this._events[b],x=arguments.length,w,S;if(v.fn){switch(v.once&&this.removeListener(c,v.fn,void 0,!0),x){case 1:return v.fn.call(v.context),!0;case 2:return v.fn.call(v.context,u),!0;case 3:return v.fn.call(v.context,u,d),!0;case 4:return v.fn.call(v.context,u,d,h),!0;case 5:return v.fn.call(v.context,u,d,h,m),!0;case 6:return v.fn.call(v.context,u,d,h,m,y),!0}for(S=1,w=new Array(x-1);S<x;S++)w[S-1]=arguments[S];v.fn.apply(v.context,w)}else{var C=v.length,k;for(S=0;S<C;S++)switch(v[S].once&&this.removeListener(c,v[S].fn,void 0,!0),x){case 1:v[S].fn.call(v[S].context);break;case 2:v[S].fn.call(v[S].context,u);break;case 3:v[S].fn.call(v[S].context,u,d);break;case 4:v[S].fn.call(v[S].context,u,d,h);break;default:if(!w)for(k=1,w=new Array(x-1);k<x;k++)w[k-1]=arguments[k];v[S].fn.apply(v[S].context,w)}}return!0},o.prototype.on=function(c,u,d){return i(this,c,u,d,!1)},o.prototype.once=function(c,u,d){return i(this,c,u,d,!0)},o.prototype.removeListener=function(c,u,d,h){var m=n?n+c:c;if(!this._events[m])return this;if(!u)return a(this,m),this;var y=this._events[m];if(y.fn)y.fn===u&&(!h||y.once)&&(!d||y.context===d)&&a(this,m);else{for(var b=0,v=[],x=y.length;b<x;b++)(y[b].fn!==u||h&&!y[b].once||d&&y[b].context!==d)&&v.push(y[b]);v.length?this._events[m]=v.length===1?v[0]:v:a(this,m)}return this},o.prototype.removeAllListeners=function(c){var u;return c?(u=n?n+c:c,this._events[u]&&a(this,u)):(this._events=new r,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=n,o.EventEmitter=o,e.exports=o}(KN)),KN.exports}var c1e=l1e();const bO=_a(c1e);var BW;let u1e=class extends bO{constructor(n){super();me(this,BW,"List");me(this,"data",new Set);n&&this.push(...n)}toSet(){return new Set(this.data)}toArray(){return Array.from(this.data)}toJSON(){return JSON.stringify(Array.from(this.data))}toString(){return this.join(",")}_set(n,r,s=!1){if(Math.abs(n)>this.data.size)throw new ReferenceError("Can not set an element outside the bounds of the list");const i=Array.from(this.data);i.splice(n,+s,r),this.data=new Set(i),this.emit("update")}set(n,r){this._set(n,r,!0)}deleteAt(n){if(Math.abs(n)>this.data.size)throw new ReferenceError("Can not delete an element outside the bounds of the list");this.delete(Array.from(this.data).at(n))}insert(n,r=this.data.size){this._set(r,n,!1)}at(n){if(Math.abs(n)>this.data.size)throw new ReferenceError("Can not access an element outside the bounds of the list");return Array.from(this.data).at(n)}pop(){const n=Array.from(this.data).pop();return n!==void 0&&this.delete(n),n}push(...n){for(const r of n)this.add(r);return this.data.size}join(n){return Array.from(this.data).join(n)}splice(n,r,...s){if(Math.abs(n)>this.data.size)throw new ReferenceError("Can not splice elements outside the bounds of the list");const i=Array.from(this.data),a=i.splice(n,r,...s);return this.data=new Set(i),this.emit("update"),a}add(n){return this.data.add(n),this.emit("update"),this.emit("add",n),this}clear(){this.data.clear(),this.emit("update")}delete(n){const r=this.data.delete(n);return this.emit("update"),r}has(n){return this.data.has(n)}get size(){return this.data.size}entries(){return this.toArray().entries()}keys(){return this.toArray().keys()}values(){return this.data.values()}[(BW=Symbol.toStringTag,Symbol.iterator)](){return this.data[Symbol.iterator]()}};function z$(e=new Error){const t=setTimeout(()=>{throw e},5e3);return()=>clearTimeout(t)}function bs(e){throw e}const U$=Intl.NumberFormat("en",{notation:"compact"});U$.format.bind(U$);function Bm(e,...t){const n={};for(const r of t.flat())n[r]=e[r];return n}function d1e(e){try{return JSON.parse(e),!0}catch{return!1}}function yj(e=0,t=1){return Math.round(Math.random()*(t-e)+e)}function vO(e){return e.at(0).toUpperCase()+e.slice(1)}const f1e=new TextEncoder;function Kp(e){return f1e.encode(e)}const q$=new TextDecoder;function xO(e){if(!e)return"";if(e.buffer instanceof ArrayBuffer&&!e.buffer.resizable)return q$.decode(e);const t=new Uint8Array(e.byteLength);return t.set(e),q$.decode(t)}function Xx(e,t){if(e.byteLength>=t)return e;if(ArrayBuffer.isView(e)){const r=Xx(e.buffer,t);return new e.constructor(r,e.byteOffset,t)}const n=typeof SharedArrayBuffer<"u"&&e instanceof SharedArrayBuffer;if(e.maxByteLength>t)return n?e.grow(t):e.resize(t),e;if(n){const r=new SharedArrayBuffer(t);return new Uint8Array(r).set(new Uint8Array(e)),r}try{return e.transfer(t)}catch{const r=new ArrayBuffer(t);return new Uint8Array(r).set(new Uint8Array(e)),r}}function h1e(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}var p1e={};let m1e="process"in globalThis&&"env"in globalThis.process&&p1e.U_DEBUG=="true";function Jx(...e){m1e&&console.debug("[U]",...e)}const V$=["int8","uint8","int16","uint16","int32","uint32","int64","uint64","int128","uint128","float32","float64","float128"],g1e=[...V$,...V$.map(e=>vO(e)),"char"],wO=/^(u?int|float)(8|16|32|64|128)$/i;function fK(e){return e=="char"?"uint8":e.toLowerCase()}function _O(e){return wO.test(e.toString())}function bj(e){return e=="char"||wO.test(e.toString().toLowerCase())}function y1e(e){if(!bj(e))throw new TypeError("Not a valid primitive type: "+e)}const W$=BigInt("0xffffffffffffffff");Symbol.metadata??(Symbol.metadata=Symbol.for("Symbol.metadata"));Object.assign(Symbol,{size:Symbol("uSize"),serialize:Symbol("uSerialize"),deserialize:Symbol("uDeserialize")});function hK(e){return e.metadata??(e.metadata={}),e.metadata.structInit=[...e.metadata.structInit??[]],e.metadata.structInit}function b1e(e){return e!=null&&typeof e=="object"&&"struct"in e}function IE(e){Symbol.metadata in e||Object.defineProperty(e,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:Object.create(null)})}function kc(e){return typeof e=="function"&&Symbol.metadata in e&&b1e(e[Symbol.metadata])}function h1(e){return e!=null&&typeof e=="object"&&kc(e.constructor)}function pK(e){if(!h1(e))throw new TypeError((typeof e=="function"?e.name:typeof e=="object"&&e?e.constructor.name:e)+" is not a struct instance")}function SO(e){return h1(e)||kc(e)}function mK(e){if(!SO(e))throw new TypeError((typeof e=="function"?e.name:typeof e=="object"&&e?e.constructor.name:e)+" is not a struct")}function CO(e){return typeof e=="object"&&e!=null&&Symbol.size in e}function Us(e){if(e==null)return 0;if(Array.isArray(e)){let s=0;for(let i=0;i<e.length;i++)s+=Us(e[i]);return s}if(typeof e=="string")return y1e(e),+fK(e).match(wO)[2]/8;if(CO(e))return e[Symbol.size];mK(e);const t=kc(e)?e:e.constructor;IE(t);const{struct:n}=t[Symbol.metadata];let r=n.staticSize;if(kc(e))return r;for(const s of n.members.values()){const i=e[s.name];if(h1(i)&&i.constructor[Symbol.metadata].struct.isDynamic){n.isUnion?r=Math.max(r,Us(i)):r+=Us(i);continue}if(typeof s.length!="string")continue;let a=0;for(let o=0;o<e[s.length];o++)a+=Us(SO(i[o])?i[o]:s.type);n.isUnion?r=Math.max(r,a):r+=a}return r}function v1e(e,t){var i;mK(e);const n=kc(e)?e:e.constructor;IE(n);const{struct:r}=n[Symbol.metadata];if(kc(e)||!r.isDynamic)return((i=r.members.get(t))==null?void 0:i.staticOffset)??bs(new Error("Struct does not have member: "+t));let s=0;for(const a of r.members.values()){if(a.name==t)return s;const o=e[a.name];s+=Us(SO(o)?o:a.type)}throw new Error("Struct does not have member: "+t)}function x1e(e,t){return Math.ceil(e/t)*t}function $m(e={}){return function(n,r){const s=new Map;let i=0,a=!1;for(const{name:o,type:l,length:c}of hK(r)){if(!bj(l)&&!kc(l))throw new TypeError("Not a valid type: "+l);if(typeof c=="string"){const h=s.get(c);if(!h)throw new Error(`"${c}" is undefined or declared after "${o}"`);if(!_O(h.type))throw new Error(`"${c}" is not a number and cannot be used to count "${o}"`)}let u=`${typeof l=="string"?l:l.name} ${o}`;c!==void 0&&(u+=`[${c}]`),s.set(o,{name:o,staticOffset:e.isUnion?0:i,type:bj(l)?fK(l):l,length:c,decl:u});const d=typeof c=="string"||kc(l)&&l[Symbol.metadata].struct.isDynamic?0:Us(l)*(c||1);a||(a=kc(l)?l[Symbol.metadata].struct.isDynamic:typeof c=="string"),i=e.isUnion?Math.max(i,d):i+d,i=x1e(i,e.align||1),Jx("define",n.name+"."+o)}return r.metadata.struct={options:e,members:s,staticSize:i,isDynamic:a,isUnion:e.isUnion??!1},n}}function Qx(e,t){return function(n,r){let s=r.name;if(typeof s=="symbol"&&(console.warn("Symbol used for struct member name will be coerced to string: "+s.toString()),s=s.toString()),!s)throw new ReferenceError("Invalid name for struct member");return hK(r).push({name:s,type:e,length:t}),n}}function gK(e,t){return t.length===void 0?-1:typeof t.length=="string"?e[t.length]:Number.isSafeInteger(t.length)&&t.length>=0?t.length:bs(new Error("Array lengths must be natural numbers"))}function ga(e){if(CO(e)&&typeof e[Symbol.serialize]=="function")return e[Symbol.serialize]();pK(e),IE(e.constructor);const{options:t,members:n}=e.constructor[Symbol.metadata].struct,r=Us(e),s=new Uint8Array(r),i=new DataView(s.buffer);Jx("serialize",e.constructor.name);let a=0,o=0;for(const l of n.values()){const c=gK(e,l);Jx("	",l.decl);for(let u=0;u<Math.abs(c);u++){let d=c!=-1?e[l.name][u]:e[l.name];if(typeof d=="string"&&(d=d.charCodeAt(0)),a=o,o+=h1(d)?Us(d):Us(l.type),!_O(l.type)){s.set(d?ga(d):new Uint8Array(Us(l.type)),a);continue}const h=`set${vO(l.type)}`;if(h=="setInt64"){i.setBigInt64(a,BigInt(d),!t.bigEndian);continue}if(h=="setUint64"){i.setBigUint64(a,BigInt(d),!t.bigEndian);continue}if(h=="setInt128"){i.setBigUint64(a+(t.bigEndian?8:0),d&W$,!t.bigEndian),i.setBigInt64(a+(t.bigEndian?0:8),d>>BigInt(64),!t.bigEndian);continue}if(h=="setUint128"){i.setBigUint64(a+(t.bigEndian?8:0),d&W$,!t.bigEndian),i.setBigUint64(a+(t.bigEndian?0:8),d>>BigInt(64),!t.bigEndian);continue}if(h=="setFloat128"){i.setFloat64(a+(t.bigEndian?8:0),Number(d),!t.bigEndian),i.setBigUint64(a+(t.bigEndian?0:8),BigInt(0),!t.bigEndian);continue}i[h](a,Number(d),!t.bigEndian)}}return s}function jE(e,t){const n=h1e(t);if(CO(e)&&typeof e[Symbol.deserialize]=="function")return e[Symbol.deserialize](n);pK(e),IE(e.constructor);const{options:r,members:s}=e.constructor[Symbol.metadata].struct,i=new DataView(n.buffer,n.byteOffset,n.byteLength);Jx("deserialize",e.constructor.name);let a=0,o=0;for(const l of s.values()){const c=gK(e,l);Jx("	",l.decl);for(let u=0;u<Math.abs(c);u++){let d=c!=-1?e[l.name]:e;const h=c!=-1?u:l.name,m=d[h]===null||d[h]===void 0,y=m&&kc(l.type)&&l.type[Symbol.metadata].struct.isDynamic;if(a=o,!h1(d[h])&&!y&&(o+=Us(l.type)),typeof e[l.name]=="string"){e[l.name]=e[l.name].slice(0,u)+String.fromCharCode(i.getUint8(a))+e[l.name].slice(u+1);continue}if(!_O(l.type)){if(y&&kc(l.type))d[h]??(d[h]=new l.type);else if(m)continue;jE(d[h],new Uint8Array(n.subarray(a))),o+=Us(d[h]);continue}c&&c!=-1&&(d||(d=[]));const b=`get${vO(l.type)}`;if(b=="getInt64"){d[h]=i.getBigInt64(a,!r.bigEndian);continue}if(b=="getUint64"){d[h]=i.getBigUint64(a,!r.bigEndian);continue}if(b=="getInt128"){d[h]=i.getBigInt64(a+(r.bigEndian?0:8),!r.bigEndian)<<BigInt(64)|i.getBigUint64(a+(r.bigEndian?8:0),!r.bigEndian);continue}if(b=="getUint128"){d[h]=i.getBigUint64(a+(r.bigEndian?0:8),!r.bigEndian)<<BigInt(64)|i.getBigUint64(a+(r.bigEndian?8:0),!r.bigEndian);continue}if(b=="getFloat128"){d[h]=i.getFloat64(a+(r.bigEndian?8:0),!r.bigEndian);continue}d[h]=i[b](a,!r.bigEndian)}}}function w1e(e){function t(n,r){return typeof n=="number"||typeof n=="string"?Qx(e,n):Qx(e)(n,r)}return t}const Xn=Object.fromEntries(g1e.map(e=>[e,w1e(e)]));function _1e(e){return{suid:e.uid,sgid:e.gid,euid:e.uid,egid:e.gid,groups:[],...e}}const Lc={root:"/",pwd:"/",credentials:_1e({uid:0,gid:0}),descriptors:new Map};function yK(e,t){let n="",r=0,s=-1,i=0,a="\0";for(let o=0;o<=e.length;++o){if(o<e.length)a=e[o];else{if(a=="/")break;a="/"}if(a=="/"){if(!(s===o-1||i===1))if(i===2){if(n.length<2||r!==2||n.at(-1)!=="."||n.at(-2)!=="."){if(n.length>2){const l=n.lastIndexOf("/");l===-1?(n="",r=0):(n=n.slice(0,l),r=n.length-1-n.lastIndexOf("/")),s=o,i=0;continue}else if(n.length!==0){n="",r=0,s=o,i=0;continue}}t&&(n+=n.length>0?"/..":"..",r=2)}else n.length>0?n+="/"+e.slice(s+1,o):n=e.slice(s+1,o),r=o-s-1;s=o,i=0}else a==="."&&i!==-1?++i:i=-1}return n}function Vd(...e){var t;let n="";for(const s of[...e.reverse(),(t=this===null||this===void 0?void 0:this.pwd)!==null&&t!==void 0?t:Lc.pwd])if(s!=null&&s.length&&(n=`${s}/${n}`,s.startsWith("/")))break;const r=n.startsWith("/");return n=yK(n,!r),r?`/${n}`:n.length?n:"/"}function S1e(e){if(!e.length)return".";const t=e.startsWith("/"),n=e.endsWith("/");return e=yK(e,!t),e.length?(n&&(e+="/"),t?`/${e}`:e):t?"/":n?"./":"."}function as(...e){if(!e.length)return".";const t=e.join("/");return t!=null&&t.length?S1e(t):"."}function bK(e,t){if(e===t||(e=Vd.call(this,e),t=Vd.call(this,t),e===t))return"";const n=1,r=e.length,s=r-n,i=1,a=t.length-i,o=s<a?s:a;let l=-1,c=0;for(;c<o;c++){const d=e[n+c];if(d!==t[i+c])break;d==="/"&&(l=c)}if(c===o)if(a>o){if(t[i+c]==="/")return t.slice(i+c+1);if(c===0)return t.slice(i+c)}else s>o&&(e[n+c]==="/"?l=c:c===0&&(l=0));let u="";for(c=n+l+1;c<=r;++c)(c===r||e[c]==="/")&&(u+=u.length===0?"..":"/..");return`${u}${t.slice(i+l)}`}function Yr(e){if(e.length===0)return".";const t=e[0]==="/";let n=-1,r=!0;for(let s=e.length-1;s>=1;--s)if(e[s]==="/"){if(!r){n=s;break}}else r=!1;return n===-1?t?"/":".":t&&n===1?"//":e.slice(0,n)}function ny(e,t){let n=0,r=-1,s=!0;for(let i=e.length-1;i>=0;--i)if(e[i]==="/"){if(!s){n=i+1;break}}else r===-1&&(s=!1,r=i+1);return r===-1?"":e.slice(n,r)}function au(e){const t=e.startsWith("/"),n={root:t?"/":"",dir:"",base:"",ext:"",name:""};if(e.length===0)return n;const r=t?1:0;let s=-1,i=0,a=-1,o=!0,l=e.length-1,c=0;for(;l>=r;--l){if(e[l]==="/"){if(!o){i=l+1;break}continue}a===-1&&(o=!1,a=l+1),e[l]==="."?s===-1?s=l:c!==1&&(c=1):s!==-1&&(c=-1)}if(a!==-1){const u=i===0&&t?1:i;s===-1||c===0||c===1&&s===a-1&&s===i+1?n.base=n.name=e.slice(u,a):(n.name=e.slice(u,s),n.base=e.slice(u,a),n.ext=e.slice(s,a))}return i>0?n.dir=e.slice(0,i-1):t&&(n.dir="/"),n}var Gn;(function(e){e[e.EMERG=0]="EMERG",e[e.ALERT=1]="ALERT",e[e.CRIT=2]="CRIT",e[e.ERR=3]="ERR",e[e.WARN=4]="WARN",e[e.NOTICE=5]="NOTICE",e[e.INFO=6]="INFO",e[e.DEBUG=7]="DEBUG"})(Gn||(Gn={}));Gn.EMERG+"",Gn.ALERT+"",Gn.CRIT+"",Gn.ERR+"",Gn.WARN+"",Gn.NOTICE+"",Gn.INFO+"",Gn.DEBUG+"";const C1e=new u1e;function k1e(e,t){const n={level:e,message:t,timestamp:new Date,elapsedMs:performance.now()};C1e.add(n),j1e(n)}function E1e(e,t){var n,r;if(!(e instanceof Xe))return e.toString();const s=e.code+": "+e.message;if(!e.path)return s;const i=typeof t.fs=="string"?t.fs:(r=(n=t.fs)===null||n===void 0?void 0:n._mountPoint)!==null&&r!==void 0?r:"<unknown>";return s+": "+as(i,e.path)}function zh(e){return function(t,n={}){return k1e(e,E1e(t,n)),t}}zh(Gn.EMERG);const T1e=zh(Gn.ALERT),PE=zh(Gn.CRIT),_o=zh(Gn.ERR),Pa=zh(Gn.WARN),kO=zh(Gn.NOTICE),vK=zh(Gn.INFO),bx=zh(Gn.DEBUG);function A1e(e,t){return`\x1B[${t}m${e}\x1B[0m`}function R1e(e,t){const n="["+(e.elapsedMs/1e3).toFixed(3).padStart(10)+"] ";switch(t){case"ansi":return[A1e(n,"2;37")];case"css":return["%c"+n,"opacity: 0.8; color: white;"];default:return[n]}}Gn.EMERG+"",Gn.ALERT+"",Gn.CRIT+"",Gn.ERR+"",Gn.WARN+"",Gn.NOTICE+"",Gn.INFO+"",Gn.DEBUG+"",Gn.EMERG+"",Gn.ALERT+"",Gn.CRIT+"",Gn.ERR+"",Gn.WARN+"",Gn.NOTICE+"",Gn.INFO+"",Gn.DEBUG+"";Gn.EMERG+"",Gn.ALERT+"",Gn.CRIT+"",Gn.ERR+"",Gn.WARN+"",Gn.NOTICE+"",Gn.INFO+"",Gn.DEBUG+"",Gn.EMERG+"",Gn.ALERT+"",Gn.CRIT+"",Gn.ERR+"",Gn.WARN+"",Gn.NOTICE+"",Gn.INFO+"",Gn.DEBUG+"";let N1e=e=>[...R1e(e),e.message];function M1e(e){const t=N1e(e);return typeof t=="string"?[t]:Array.from(t)}let I1e=console.error;function j1e(e){e.level>P1e||I1e(...M1e(e))}let P1e=Gn.ALERT;function EO(e){return e!=null&&typeof e=="object"&&"create"in e&&typeof e.create=="function"}function O1e(e,t){return Object.defineProperty(t,"prototype",{value:void 0}),Object.defineProperty(t,"name",{value:e}),t}function D1e(e,t){if(typeof t!="object"||t===null)throw _o(new Xe(yt.EINVAL,"Invalid options"));for(const[n,r]of Object.entries(e.options)){const s=t==null?void 0:t[n];if(s==null){if(!r.required){bx("Using default for option: "+n);continue}throw _o(new Xe(yt.EINVAL,"Missing required option: "+n))}const i=(c,u=s)=>{var d;return typeof c=="function"?Symbol.hasInstance in c&&c.prototype?s instanceof c:c(s):typeof s===c||((d=s==null?void 0:s.constructor)===null||d===void 0?void 0:d.name)===c};if(Array.isArray(r.type)?r.type.some(c=>i(c)):i(r.type))continue;const a=typeof s=="object"&&"constructor"in s?s.constructor.name:typeof s,o=c=>typeof c=="function"?c.name!="type"?c.name:c.toString():c,l=Array.isArray(r.type)?`one of ${r.type.map(o).join(", ")}`:o(r.type);throw _o(new Xe(yt.EINVAL,`Incorrect type for "${n}": ${a} (expected ${l})`))}}function xK(e){return e!=null&&typeof e=="object"&&"backend"in e&&EO(e.backend)}const TO=0,zi=4,oi=2,T2=1,AO=1,F1e=2,L1e=4,wK=0,ja=1,jd=2,OE=64,DE=128,B1e=256,FE=512,km=1024,$1e=65536,z1e=262144,U1e=131072,LE=1052672,q1e=4096,V1e=32768,W1e=16384,H1e=2048,Cs=61440,zm=49152,ef=40960,Ec=32768,Um=24576,Ti=16384,qm=8192,Vm=4096,p1=2048,m1=1024,G1e=512,K1e=448,_K=256,SK=128,CK=64,Y1e=56,kK=32,EK=16,TK=8,Z1e=7,AK=4,RK=2,NK=1,X1e=0,ao=4294967295,MK=Object.freeze(Object.defineProperty({__proto__:null,COPYFILE_EXCL:AO,COPYFILE_FICLONE:F1e,COPYFILE_FICLONE_FORCE:L1e,F_OK:TO,O_APPEND:km,O_CREAT:OE,O_DIRECT:W1e,O_DIRECTORY:$1e,O_DSYNC:q1e,O_EXCL:DE,O_NOATIME:z1e,O_NOCTTY:B1e,O_NOFOLLOW:U1e,O_NONBLOCK:H1e,O_RDONLY:wK,O_RDWR:jd,O_SYMLINK:V1e,O_SYNC:LE,O_TRUNC:FE,O_WRONLY:ja,R_OK:zi,S_IFBLK:Um,S_IFCHR:qm,S_IFDIR:Ti,S_IFIFO:Vm,S_IFLNK:ef,S_IFMT:Cs,S_IFREG:Ec,S_IFSOCK:zm,S_IRGRP:kK,S_IROTH:AK,S_IRUSR:_K,S_IRWXG:Y1e,S_IRWXO:Z1e,S_IRWXU:K1e,S_ISGID:m1,S_ISUID:p1,S_ISVTX:G1e,S_IWGRP:EK,S_IWOTH:RK,S_IWUSR:SK,S_IXGRP:TK,S_IXOTH:NK,S_IXUSR:CK,UV_FS_O_FILEMAP:X1e,W_OK:oi,X_OK:T2,size_max:ao},Symbol.toStringTag,{value:"Module"})),AS=BigInt(1e3);class IK{_convert(t){return this._isBigint?BigInt(t):Number(t)}get blocks(){return this._convert(Math.ceil(Number(this.size)/512))}set blocks(t){}get atime(){return new Date(Number(this.atimeMs))}set atime(t){this.atimeMs=this._convert(t.getTime())}get mtime(){return new Date(Number(this.mtimeMs))}set mtime(t){this.mtimeMs=this._convert(t.getTime())}get ctime(){return new Date(Number(this.ctimeMs))}set ctime(t){this.ctimeMs=this._convert(t.getTime())}get birthtime(){return new Date(Number(this.birthtimeMs))}set birthtime(t){this.birthtimeMs=this._convert(t.getTime())}constructor({atimeMs:t,mtimeMs:n,ctimeMs:r,birthtimeMs:s,uid:i,gid:a,size:o,mode:l,ino:c,...u}={}){this.dev=this._convert(0),this.ino=this._convert(0),this.rdev=this._convert(0),this.nlink=this._convert(1),this.blksize=this._convert(4096),this.uid=this._convert(0),this.gid=this._convert(0);const d=Date.now();this.atimeMs=this._convert(t??d),this.mtimeMs=this._convert(n??d),this.ctimeMs=this._convert(r??d),this.birthtimeMs=this._convert(s??d),this.uid=this._convert(i??0),this.gid=this._convert(a??0),this.size=this._convert(o??0),this.ino=this._convert(c??0),this.mode=this._convert(l??420&Ec),(this.mode&Cs)==0&&(this.mode=this.mode|this._convert(Ec)),Object.assign(this,u)}isFile(){return(this.mode&Cs)===Ec}isDirectory(){return(this.mode&Cs)===Ti}isSymbolicLink(){return(this.mode&Cs)===ef}isSocket(){return(this.mode&Cs)===zm}isBlockDevice(){return(this.mode&Cs)===Um}isCharacterDevice(){return(this.mode&Cs)===qm}isFIFO(){return(this.mode&Cs)===Vm}toJSON(){return Bm(this,vj)}hasAccess(t,n){return fs(n,this._isBigint?new tf(this):this,t)}get atimeNs(){return BigInt(this.atimeMs)*AS}get mtimeNs(){return BigInt(this.mtimeMs)*AS}get ctimeNs(){return BigInt(this.ctimeMs)*AS}get birthtimeNs(){return BigInt(this.birthtimeMs)*AS}}function jK(e,t,n){let r=!0;return!isNaN(t)&&t>=0&&t<ao?e.uid=t:r=!1,!isNaN(n)&&n>=0&&n<ao?e.gid=n:r=!1,r}class tf extends IK{constructor(){super(...arguments),this._isBigint=!1}}class Wm extends IK{constructor(){super(...arguments),this._isBigint=!0}}function J1e(e,t){return e.size==t.size&&+e.atime==+t.atime&&+e.mtime==+t.mtime&&+e.ctime==+t.ctime&&e.mode==t.mode}class Q1e{constructor(){this.type=525687744115,this.bsize=4096,this.blocks=0,this.bfree=0,this.bavail=0,this.files=ao,this.ffree=ao}}class e_e{constructor(){this.type=BigInt("0x7a656e6673"),this.bsize=BigInt(4096),this.blocks=BigInt(0),this.bfree=BigInt(0),this.bavail=BigInt(0),this.files=BigInt(ao),this.ffree=BigInt(ao)}}var js=function(e,t,n,r,s,i){function a(x){if(x!==void 0&&typeof x!="function")throw new TypeError("Function expected");return x}for(var o=r.kind,l=o==="getter"?"get":o==="setter"?"set":"value",c=!t&&e?r.static?e:e.prototype:null,u=t||(c?Object.getOwnPropertyDescriptor(c,r.name):{}),d,h=!1,m=n.length-1;m>=0;m--){var y={};for(var b in r)y[b]=b==="access"?{}:r[b];for(var b in r.access)y.access[b]=r.access[b];y.addInitializer=function(x){if(h)throw new TypeError("Cannot add initializers after decoration has completed");i.push(a(x||null))};var v=(0,n[m])(o==="accessor"?{get:u.get,set:u.set}:u[l],y);if(o==="accessor"){if(v===void 0)continue;if(v===null||typeof v!="object")throw new TypeError("Object expected");(d=a(v.get))&&(u.get=d),(d=a(v.set))&&(u.set=d),(d=a(v.init))&&s.unshift(d)}else(d=a(v))&&(o==="field"?s.unshift(d):u[l]=d)}c&&Object.defineProperty(c,r.name,u),h=!0},Hn=function(e,t,n){for(var r=arguments.length>2,s=0;s<t.length;s++)n=r?t[s].call(e,n):t[s].call(e);return r?n:void 0},RO=function(e,t,n){return typeof t=="symbol"&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:n?"".concat(n," ",t):t})};const Jo=0,t_e=1024;let H$=(()=>{var e,t;let n=[$m()],r,s=[],i,a,o=[],l=[],c,u=[],d=[],h,m=[],y=[],b,v=[],x=[];return i=class{get key(){return this._key}set key(w){this._key=w,this.keySize=w.length}get value(){return this._value.subarray(0,this.valueSize)}set value(w){this._value=w,this.valueSize=w.length}constructor(w,S){this.keySize=Hn(this,o,0),this.valueSize=(Hn(this,l),Hn(this,u,0)),this._key=(Hn(this,d),Hn(this,m,"")),this._value=(Hn(this,y),Hn(this,v,new Uint8Array(t_e))),Hn(this,x),w&&(this.key=w),S&&(this.value=S)}},RO(i,"Attribute"),(()=>{const w=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;a=[(e=Xn).uint32.bind(e)],c=[(t=Xn).uint32.bind(t)],h=[Xn.char("keySize")],b=[Xn.uint8("valueSize")],js(null,null,a,{kind:"field",name:"keySize",static:!1,private:!1,access:{has:S=>"keySize"in S,get:S=>S.keySize,set:(S,C)=>{S.keySize=C}},metadata:w},o,l),js(null,null,c,{kind:"field",name:"valueSize",static:!1,private:!1,access:{has:S=>"valueSize"in S,get:S=>S.valueSize,set:(S,C)=>{S.valueSize=C}},metadata:w},u,d),js(null,null,h,{kind:"field",name:"_key",static:!1,private:!1,access:{has:S=>"_key"in S,get:S=>S._key,set:(S,C)=>{S._key=C}},metadata:w},m,y),js(null,null,b,{kind:"field",name:"_value",static:!1,private:!1,access:{has:S=>"_value"in S,get:S=>S._value,set:(S,C)=>{S._value=C}},metadata:w},v,x),js(null,r={value:i},n,{kind:"class",name:i.name,metadata:w},null,s),i=r.value,w&&Object.defineProperty(i,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:w}),Hn(i,s)})(),i})(),_h=(()=>{var e;let t=[$m()],n,r=[],s,i,a=[],o=[],l,c=[],u=[];return s=class{has(d){return this.data.some(h=>h.key==d)}get(d){return this.data.find(h=>h.key==d)}set(d,h){const m=this.get(d);if(m){m.value=h;return}this.data.push(new H$(d,h)),this.size++}remove(d){const h=this.data.findIndex(m=>m.key==d);return h===-1?!1:(this.data.splice(h,1),this.size--,!0)}keys(){return this.data.map(d=>d.key)}values(){return this.data.map(d=>d.value)}entries(){return this.data.map(d=>[d.key,d.value])}constructor(){this.size=Hn(this,a,0),this.data=(Hn(this,o),Hn(this,c,[])),Hn(this,u)}},RO(s,"Attributes"),(()=>{const d=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;i=[(e=Xn).uint32.bind(e)],l=[Qx(H$,"size")],js(null,null,i,{kind:"field",name:"size",static:!1,private:!1,access:{has:h=>"size"in h,get:h=>h.size,set:(h,m)=>{h.size=m}},metadata:d},a,o),js(null,null,l,{kind:"field",name:"data",static:!1,private:!1,access:{has:h=>"data"in h,get:h=>h.data,set:(h,m)=>{h.data=m}},metadata:d},c,u),js(null,n={value:s},t,{kind:"class",name:s.name,metadata:d},null,r),s=n.value,d&&Object.defineProperty(s,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:d}),Hn(s,r)})(),s})();const vj=["ino","data","size","mode","flags","nlink","uid","gid","atimeMs","birthtimeMs","mtimeMs","ctimeMs","version"],n_e=4;var So;(function(e){e[e.SecureRm=1]="SecureRm",e[e.Undelete=2]="Undelete",e[e.Compress=4]="Compress",e[e.Sync=8]="Sync",e[e.Immutable=16]="Immutable",e[e.Append=32]="Append",e[e.NoDump=64]="NoDump",e[e.NoAtime=128]="NoAtime",e[e.Dirty=256]="Dirty",e[e.CompressBlk=512]="CompressBlk",e[e.NoCompress=1024]="NoCompress",e[e.Encrypt=2048]="Encrypt",e[e.Btree=4096]="Btree",e[e.Index=4096]="Index",e[e.IMagic=8192]="IMagic",e[e.JournalData=16384]="JournalData",e[e.NoTail=32768]="NoTail",e[e.DirSync=65536]="DirSync",e[e.TopDir=131072]="TopDir",e[e.HugeFile=262144]="HugeFile",e[e.Extent=524288]="Extent",e[e.Verity=1048576]="Verity",e[e.EaInode=2097152]="EaInode",e[e.EofBlocks=4194304]="EofBlocks",e[e.NoCow=8388608]="NoCow",e[e.Dax=33554432]="Dax",e[e.InlineData=268435456]="InlineData",e[e.ProjInherit=536870912]="ProjInherit",e[e.CaseFold=1073741824]="CaseFold",e[e.Reserved=2147483648]="Reserved"})(So||(So={}));let Ci=(()=>{var e,t,n,r,s,i,a,o,l,c,u,d,h,m,y,b;let v=[$m()],x,w=[],S,C,k=[],A=[],R,N=[],I=[],P,L=[],O=[],V,D=[],Z=[],U,H=[],$=[],ne,W=[],Q=[],ee,se=[],pe=[],ce,Ie=[],De=[],Se,Ce=[],qe=[],Qe,Ve=[],Ne=[],K,ge=[],Ae=[],le,oe=[],re=[],Te,Be=[],ke=[],lt,Rt=[],ht=[],Pt,qt=[],Lt=[],en,xe=[],F=[],X,ye=[],Fe=[],we,Me=[],de=[];var vt=S=class{constructor(ot){if(this.data=Hn(this,k,yj(0,ao)),this.__data_old=(Hn(this,A),Hn(this,N,0)),this.size=(Hn(this,I),Hn(this,L,0)),this.mode=(Hn(this,O),Hn(this,D,0)),this.nlink=(Hn(this,Z),Hn(this,H,1)),this.uid=(Hn(this,$),Hn(this,W,0)),this.gid=(Hn(this,Q),Hn(this,se,0)),this.atimeMs=(Hn(this,pe),Hn(this,Ie,Date.now())),this.birthtimeMs=(Hn(this,De),Hn(this,Ce,Date.now())),this.mtimeMs=(Hn(this,qe),Hn(this,Ve,Date.now())),this.ctimeMs=(Hn(this,Ne),Hn(this,ge,Date.now())),this.ino=(Hn(this,Ae),Hn(this,oe,yj(0,ao))),this.__ino_old=(Hn(this,re),Hn(this,Be,0)),this.flags=(Hn(this,ke),Hn(this,Rt,0)),this.__after_flags=(Hn(this,ht),Hn(this,qt,0)),this.version=(Hn(this,Lt),Hn(this,xe,0)),this.__padding=(Hn(this,F),Hn(this,ye,[])),this.attributes=(Hn(this,Fe),Hn(this,Me,new _h)),Hn(this,de),!!ot){if(!("byteLength"in ot)){Object.assign(this,ot);return}if(ot.byteLength<Us(vt))throw PE(new Xe(yt.EIO,"Buffer is too small to create an inode"));jE(this,ot)}}toString(){return`<Inode ${this.ino}>`}toJSON(){return{...Bm(this,vj),attributes:this.attributes}}toStats(){return new tf(this)}update(ot){if(!ot)return!1;let B=!1;for(const ze of vj)ot[ze]!==void 0&&(ze=="ino"||ze=="data"||this[ze]!==ot[ze]&&(ze=="atimeMs"&&this.flags&So.NoAtime||(this[ze]=ot[ze],B=!0)));return ot.attributes&&(this.attributes=ot.attributes,B=!0),B&&(this.ctimeMs=Date.now()),B}};return RO(S,"Inode"),(()=>{const ot=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;C=[(e=Xn).uint32.bind(e)],R=[(t=Xn).uint32.bind(t)],P=[(n=Xn).uint32.bind(n)],V=[(r=Xn).uint16.bind(r)],U=[(s=Xn).uint32.bind(s)],ne=[(i=Xn).uint32.bind(i)],ee=[(a=Xn).uint32.bind(a)],ce=[(o=Xn).float64.bind(o)],Se=[(l=Xn).float64.bind(l)],Qe=[(c=Xn).float64.bind(c)],K=[(u=Xn).float64.bind(u)],le=[(d=Xn).uint32.bind(d)],Te=[(h=Xn).uint32.bind(h)],lt=[(m=Xn).uint32.bind(m)],Pt=[(y=Xn).uint16.bind(y)],en=[(b=Xn).uint32.bind(b)],X=[Xn.uint8(48)],we=[Qx(_h)],js(null,null,C,{kind:"field",name:"data",static:!1,private:!1,access:{has:B=>"data"in B,get:B=>B.data,set:(B,ze)=>{B.data=ze}},metadata:ot},k,A),js(null,null,R,{kind:"field",name:"__data_old",static:!1,private:!1,access:{has:B=>"__data_old"in B,get:B=>B.__data_old,set:(B,ze)=>{B.__data_old=ze}},metadata:ot},N,I),js(null,null,P,{kind:"field",name:"size",static:!1,private:!1,access:{has:B=>"size"in B,get:B=>B.size,set:(B,ze)=>{B.size=ze}},metadata:ot},L,O),js(null,null,V,{kind:"field",name:"mode",static:!1,private:!1,access:{has:B=>"mode"in B,get:B=>B.mode,set:(B,ze)=>{B.mode=ze}},metadata:ot},D,Z),js(null,null,U,{kind:"field",name:"nlink",static:!1,private:!1,access:{has:B=>"nlink"in B,get:B=>B.nlink,set:(B,ze)=>{B.nlink=ze}},metadata:ot},H,$),js(null,null,ne,{kind:"field",name:"uid",static:!1,private:!1,access:{has:B=>"uid"in B,get:B=>B.uid,set:(B,ze)=>{B.uid=ze}},metadata:ot},W,Q),js(null,null,ee,{kind:"field",name:"gid",static:!1,private:!1,access:{has:B=>"gid"in B,get:B=>B.gid,set:(B,ze)=>{B.gid=ze}},metadata:ot},se,pe),js(null,null,ce,{kind:"field",name:"atimeMs",static:!1,private:!1,access:{has:B=>"atimeMs"in B,get:B=>B.atimeMs,set:(B,ze)=>{B.atimeMs=ze}},metadata:ot},Ie,De),js(null,null,Se,{kind:"field",name:"birthtimeMs",static:!1,private:!1,access:{has:B=>"birthtimeMs"in B,get:B=>B.birthtimeMs,set:(B,ze)=>{B.birthtimeMs=ze}},metadata:ot},Ce,qe),js(null,null,Qe,{kind:"field",name:"mtimeMs",static:!1,private:!1,access:{has:B=>"mtimeMs"in B,get:B=>B.mtimeMs,set:(B,ze)=>{B.mtimeMs=ze}},metadata:ot},Ve,Ne),js(null,null,K,{kind:"field",name:"ctimeMs",static:!1,private:!1,access:{has:B=>"ctimeMs"in B,get:B=>B.ctimeMs,set:(B,ze)=>{B.ctimeMs=ze}},metadata:ot},ge,Ae),js(null,null,le,{kind:"field",name:"ino",static:!1,private:!1,access:{has:B=>"ino"in B,get:B=>B.ino,set:(B,ze)=>{B.ino=ze}},metadata:ot},oe,re),js(null,null,Te,{kind:"field",name:"__ino_old",static:!1,private:!1,access:{has:B=>"__ino_old"in B,get:B=>B.__ino_old,set:(B,ze)=>{B.__ino_old=ze}},metadata:ot},Be,ke),js(null,null,lt,{kind:"field",name:"flags",static:!1,private:!1,access:{has:B=>"flags"in B,get:B=>B.flags,set:(B,ze)=>{B.flags=ze}},metadata:ot},Rt,ht),js(null,null,Pt,{kind:"field",name:"__after_flags",static:!1,private:!1,access:{has:B=>"__after_flags"in B,get:B=>B.__after_flags,set:(B,ze)=>{B.__after_flags=ze}},metadata:ot},qt,Lt),js(null,null,en,{kind:"field",name:"version",static:!1,private:!1,access:{has:B=>"version"in B,get:B=>B.version,set:(B,ze)=>{B.version=ze}},metadata:ot},xe,F),js(null,null,X,{kind:"field",name:"__padding",static:!1,private:!1,access:{has:B=>"__padding"in B,get:B=>B.__padding,set:(B,ze)=>{B.__padding=ze}},metadata:ot},ye,Fe),js(null,null,we,{kind:"field",name:"attributes",static:!1,private:!1,access:{has:B=>"attributes"in B,get:B=>B.attributes,set:(B,ze)=>{B.attributes=ze}},metadata:ot},Me,de),js(null,x={value:S},v,{kind:"class",name:S.name,metadata:ot},null,w),vt=S=x.value,ot&&Object.defineProperty(S,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:ot}),Hn(S,w)})(),vt=S})();function r_e(e){return(e.mode&Cs)===Ec}function Oc(e){return(e.mode&Cs)===Ti}function ry(e){return(e.mode&Cs)===ef}function s_e(e){return(e.mode&Cs)===zm}function ew(e){return(e.mode&Cs)===Um}function tw(e){return(e.mode&Cs)===qm}function i_e(e){return(e.mode&Cs)===Vm}function fs(e,t,n){const r=(e==null?void 0:e.credentials)||Lc.credentials;if(ry(t)||r.euid===0||r.egid===0)return!0;let s=0;return r.uid===t.uid&&(t.mode&_K&&(s|=zi),t.mode&SK&&(s|=oi),t.mode&CK&&(s|=T2)),(r.gid===t.gid||r.groups.includes(Number(t.gid)))&&(t.mode&kK&&(s|=zi),t.mode&EK&&(s|=oi),t.mode&TK&&(s|=T2)),t.mode&AK&&(s|=zi),t.mode&RK&&(s|=oi),t.mode&NK&&(s|=T2),(s&n)===n}const G$=1;class FC extends Map{constructor(){super(...arguments),this.maxSize=ao}toJSON(){return{version:G$,maxSize:this.maxSize,entries:Object.fromEntries([...this].map(([t,n])=>[t,n.toJSON()]))}}toString(){return JSON.stringify(this.toJSON())}get byteSize(){let t=this.size*Us(Ci);for(const n of this.values())t+=n.size;return t}usage(){return{totalSpace:this.maxSize,freeSpace:this.maxSize-this.byteSize}}pathOf(t){for(const[n,r]of this)if(r.ino==t||r.data==t)return n}getByID(t){var n;return(n=this.entryByID(t))===null||n===void 0?void 0:n.inode}entryByID(t){for(const[n,r]of this)if(r.ino==t||r.data==t)return{path:n,inode:r}}directoryEntries(t){const n=this.get(t);if(!n)throw Xe.With("ENOENT",t);if((n.mode&Cs)!=Ti)throw Xe.With("ENOTDIR",t);const r={};for(const s of this.keys())Yr(s)==t&&s!=t&&(r[ny(s)]=this.get(s).ino);return r}_alloc(){return Math.max(...[...this.values()].flatMap(t=>[t.ino,t.data]))+1}directories(){const t=new Map;for(const[n,r]of this){if((r.mode&Cs)!=Ti)continue;const s={};for(const i of this.keys())Yr(i)==n&&i!=n&&(s[ny(i)]=this.get(i).ino);t.set(n,s)}return t}fromJSON(t){var n;if(t.version!=G$)throw new Xe(yt.EINVAL,"Index version mismatch");this.clear();for(const[r,s]of Object.entries(t.entries))(n=s.data)!==null&&n!==void 0||(s.data=yj(1,ao)),r=="/"&&(s.ino=0),this.set(r,new Ci(s));return this}static parse(t){if(!d1e(t))throw new Xe(yt.EINVAL,"Invalid JSON");const n=JSON.parse(t),r=new FC;return r.fromJSON(n),r}}const YN=4096;let NO=class xj{get uuid(){return this._uuid}constructor(t,n){this.type=t,this.name=n,this._uuid=crypto.randomUUID(),this.attributes=new Map,this.streamRead===xj.prototype.streamRead&&this.attributes.set("default_stream_read"),this.streamWrite===xj.prototype.streamWrite&&this.attributes.set("default_stream_write")}toString(){var t;return`${this.name} ${(t=this.label)!==null&&t!==void 0?t:""} (${this._mountPoint?"mounted on "+this._mountPoint:"unmounted"})`}usage(){return{totalSpace:0,freeSpace:0}}async ready(){}async exists(t){try{return await this.stat(t),!0}catch(n){return n.code!="ENOENT"}}existsSync(t){try{return this.statSync(t),!0}catch(n){return n.code!="ENOENT"}}streamRead(t,n){return new ReadableStream({start:async r=>{const{size:s}=await this.stat(t),{start:i=0,end:a=s}=n;for(let o=i;o<a;o+=YN){const l=o+YN>a?a-o:YN,c=new Uint8Array(l);await this.read(t,c,o,o+l).catch(r.error.bind(r)),r.enqueue(c)}r.close()},type:"bytes"})}streamWrite(t,n){var r;let s=(r=n.start)!==null&&r!==void 0?r:0;return new WritableStream({write:async(i,a)=>{let o=!1;const l=u=>{o=!0,a.error(u)},{size:c}=await this.stat(t);await this.write(t,i,s).catch(l),!o&&(s+=i.byteLength,await this.touch(t,{mtimeMs:Date.now(),size:Math.max(c,s)}).catch(l))}})}};function Ka(e){return JSON.parse(xO(e),(t,n)=>t==""?n:typeof n=="string"?BigInt(n).toString(16).slice(0,Math.min(n.length,8)):n)}function Il(e){return Kp(JSON.stringify(e))}function Uh(e,t){if(typeof e=="number")return e;if(typeof e=="string"){const n=parseInt(e,8);if(!isNaN(n))return n}if(typeof t=="number")return t;throw new Xe(yt.EINVAL,"Invalid mode: "+(e==null?void 0:e.toString()))}function LC(e){if(e instanceof Date)return e.getTime();try{return Number(e)}catch{throw new Xe(yt.EINVAL,"Invalid time.")}}function Fn(e,t=!1){if(e instanceof URL){if(e.protocol!="file:")throw new Xe(yt.EINVAL,"URLs must use the file: protocol");e=e.pathname}if(e=e.toString(),e.startsWith("file://")&&(e=e.slice(7)),e.includes("\0"))throw new Xe(yt.EINVAL,"Path can not contain null character");if(e.length==0)throw new Xe(yt.EINVAL,"Path can not be empty");return e=e.replaceAll(/[/\\]+/g,"/"),t?e:Vd(e)}function Pd(e,t="utf8",n,r=0){return typeof e!="object"||e===null?{encoding:typeof e=="string"?e:t??null,flag:n,mode:r}:{encoding:typeof(e==null?void 0:e.encoding)=="string"?e.encoding:t??null,flag:typeof(e==null?void 0:e.flag)=="string"?e.flag:n,mode:Uh("mode"in e?e==null?void 0:e.mode:null,r)}}class a_e{constructor(t,n,r,s){me(this,"id");me(this,"_size");me(this,"options");me(this,"regions",[]);this.id=t,this._size=n,this.options=r,r.sparse??(r.sparse=!0),r.sparse||this.regions.push({offset:0,data:new Uint8Array(n),ranges:[]}),s==null||s.set(t,this)}get size(){return this._size}set size(t){if(t>=this._size){this._size=t;return}this._size=t;for(let n=this.regions.length-1;n>=0;n--){const r=this.regions[n];if(r.offset>=t){this.regions.splice(n,1);continue}const s=t-r.offset;r.data.byteLength>s&&(r.data=r.data.subarray(0,s)),r.ranges=r.ranges.filter(i=>i.start<t).map(i=>i.end>t?{start:i.start,end:t}:i)}}collect(){if(!this.options.sparse)return;const{regionGapThreshold:t=4095}=this.options;for(let n=0;n<this.regions.length-1;){const r=this.regions[n],s=this.regions[n+1];if(s.offset-(r.offset+r.data.byteLength)>t){n++;continue}r.ranges.push(...s.ranges),r.ranges.sort((i,a)=>i.start-a.start),r.ranges=r.ranges.reduce((i,a)=>(!i.length||i.at(-1).end<a.start?i.push(a):i.at(-1).end=Math.max(i.at(-1).end,a.end),i),[]),r.data=Xx(r.data,s.offset+s.data.byteLength),r.data.set(s.data,s.offset-r.offset),this.regions.splice(n+1,1)}}missing(t,n){const r=[];for(const s of this.regions){if(s.offset>=n)break;for(const i of s.ranges)if(!(i.end<=t)&&(i.start>=n||(i.start>t&&r.push({start:t,end:Math.min(i.start,n)}),i.end>t&&(t=Math.max(t,i.end)),t>=n)))break;if(t>=n)break}return t<n&&r.push({start:t,end:n}),r}cached(t,n){const r=[];for(const i of this.regions){if(i.offset>=n)break;for(const a of i.ranges)if(!(a.end<=t)){if(a.start>=n)break;r.push({start:Math.max(t,a.start),end:Math.min(n,a.end)})}}r.sort((i,a)=>i.start-a.start);const s=[];for(const i of r){const a=s.at(-1);a&&i.start<=a.end?a.end=Math.max(a.end,i.end):s.push(i)}return s}regionAt(t){if(this.regions.length)for(const n of this.regions){if(n.offset>t)break;if(t>=n.offset&&t<n.offset+n.data.byteLength)return n}}add(t,n){const r=n+t.byteLength,s=this.regionAt(n);if(s)return s.data=Xx(s.data,r),s.data.set(t,n),s.ranges.push({start:n,end:r}),s.ranges.sort((o,l)=>o.start-l.start),this.collect(),this;const i={data:t,offset:n,ranges:[{start:n,end:r}]},a=this.regions.findIndex(o=>o.offset>n);return a==-1?this.regions.push(i):this.regions.splice(a,0,i),this.collect(),this}}var ZN,XN,JN;(ZN=Promise.withResolvers)!==null&&ZN!==void 0||(Promise.withResolvers=(Pa("Using a polyfill of Promise.withResolvers"),function(){let e,t;return{promise:new Promise((r,s)=>{e=r,t=s}),resolve:e,reject:t}}));(XN=Symbol.dispose)!==null&&XN!==void 0||(Symbol.dispose=(Pa("Using a polyfill of Symbol.dispose"),Symbol("Symbol.dispose")));(JN=Symbol.asyncDispose)!==null&&JN!==void 0||(Symbol.asyncDispose=(Pa("Using a polyfill of Symbol.asyncDispose"),Symbol("Symbol.asyncDispose")));class PK{constructor(t){this.store=t}}class o_e extends PK{async get(t,n,r){return this.getSync(t,n,r)}async set(t,n,r){return this.setSync(t,n,r)}async remove(t){return this.removeSync(t)}}class wj extends PK{constructor(){super(...arguments),this.asyncDone=Promise.resolve()}async(t){this.asyncDone=this.asyncDone.then(()=>t)}_cached(t,n){var r,s;(r=(s=this.store).cache)!==null&&r!==void 0||(s.cache=new Map);const i=this.store.cache.get(t);return i?(n&&(i.size=n.size),i):n?new a_e(t,n.size,{},this.store.cache):void 0}getSync(t,n,r){var s;const i=this._cached(t);if(!i)return;r??(r=i.size);const a=i.missing(n,r);for(const{start:l,end:c}of a)this.async(this.get(t,l,c));if(a.length)throw _o(Xe.With("EAGAIN",(s=this.store._fs)===null||s===void 0?void 0:s._path(t)));const o=i.regionAt(n);if(!o){Pa("Missing cache region for "+t);return}return o.data.subarray(n-o.offset,r-o.offset)}setSync(t,n,r){this.async(this.set(t,n,r))}removeSync(t){var n;this.async(this.remove(t)),(n=this.store.cache)===null||n===void 0||n.delete(t)}}class l_e{flag(t){var n,r;return(r=(n=this.raw.store.flags)===null||n===void 0?void 0:n.includes(t))!==null&&r!==void 0?r:!1}constructor(t,n){this.raw=t,this.fs=n,this.done=!1,this.originalData=new Map,this.modifiedKeys=new Set}keys(){return this.raw.keys()}async get(t,n=0,r){const s=await this.raw.get(t,n,r);return this.stash(t),s}getSync(t,n=0,r){const s=this.raw.getSync(t,n,r);return this.stash(t),s}async set(t,n,r=0){await this.markModified(t,r,n.byteLength),await this.raw.set(t,n,r)}setSync(t,n,r=0){this.markModifiedSync(t,r,n.byteLength),this.raw.setSync(t,n,r)}async remove(t){await this.markModified(t,0,void 0),await this.raw.remove(t)}removeSync(t){this.markModifiedSync(t,0,void 0),this.raw.removeSync(t)}commit(){return this.done=!0,Promise.resolve()}commitSync(){this.done=!0}async abort(){if(!this.done){for(const[t,n]of this.originalData)if(this.modifiedKeys.has(t)){if(n.some(r=>!r.data)){await this.raw.remove(t),this.fs._remove(t);continue}for(const r of n.reverse())await this.raw.set(t,r.data,r.offset)}this.done=!0}}abortSync(){if(!this.done){for(const[t,n]of this.originalData)if(this.modifiedKeys.has(t)){if(n.some(r=>!r.data)){this.raw.removeSync(t),this.fs._remove(t);continue}for(const r of n.reverse())this.raw.setSync(t,r.data,r.offset)}this.done=!0}}async[Symbol.asyncDispose](){this.done||await this.abort()}[Symbol.dispose](){this.done||this.abortSync()}stash(t,n,r=0){this.originalData.has(t)||this.originalData.set(t,[]),this.originalData.get(t).push({data:n,offset:r})}async markModified(t,n,r){this.modifiedKeys.add(t);const s=r?n+r:void 0;try{this.stash(t,await this.raw.get(t,n,s),n)}catch(i){if(!(this.raw instanceof wj))throw i;const o=this.raw._cached(t);if(!o)throw i;for(const l of o.cached(n,s??n))this.stash(t,await this.raw.get(t,l.start,l.end),l.start)}}markModifiedSync(t,n,r){this.modifiedKeys.add(t);const s=r?n+r:void 0;try{this.stash(t,this.raw.getSync(t,n,s),n)}catch(i){if(!(this.raw instanceof wj))throw i;const o=this.raw._cached(t);if(!o)throw i;for(const l of o.cached(n,s??n))this.stash(t,this.raw.getSync(t,l.start,l.end),l.start)}}}var Ms=function(e,t,n){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var r,s;if(n){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=t[Symbol.asyncDispose]}if(r===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=t[Symbol.dispose],n&&(s=r)}if(typeof r!="function")throw new TypeError("Object not disposable.");s&&(r=function(){try{s.call(this)}catch(i){return Promise.reject(i)}}),e.stack.push({value:t,dispose:r,async:n})}else n&&e.stack.push({async:!0});return t},Is=function(e){return function(t){function n(a){t.error=t.hasError?new e(a,t.error,"An error was suppressed during disposal."):a,t.hasError=!0}var r,s=0;function i(){for(;r=t.stack.pop();)try{if(!r.async&&s===1)return s=0,t.stack.push(r),Promise.resolve().then(i);if(r.dispose){var a=r.dispose.call(r.value);if(r.async)return s|=2,Promise.resolve(a).then(i,function(o){return n(o),i()})}else s|=1}catch(o){n(o)}if(s===1)return t.hasError?Promise.reject(t.error):Promise.resolve();if(t.hasError)throw t.error}return i()}}(typeof SuppressedError=="function"?SuppressedError:function(e,t,n){var r=new Error(n);return r.name="SuppressedError",r.error=e,r.suppressed=t,r});class OK extends NO{_path(t){var n;const[r]=(n=this._paths.get(t))!==null&&n!==void 0?n:[];return r}_add(t,n){this._paths.has(t)||this._paths.set(t,new Set),this._paths.get(t).add(n),this._ids.set(n,t)}_remove(t){var n;for(const r of(n=this._paths.get(t))!==null&&n!==void 0?n:[])this._ids.delete(r);this._paths.delete(t)}_move(t,n){const r=[];for(const[s,i]of this._ids){const a=bK(t,s);if(a.startsWith(".."))continue;let o=as(n,a);o.endsWith("/")&&(o=o.slice(0,-1)),r.push({oldKey:s,newKey:o,ino:i})}for(const{oldKey:s,newKey:i,ino:a}of r){this._ids.delete(s),this._ids.set(i,a);const o=this._paths.get(a);if(!o){Pa("Missing paths in table for ino "+a);continue}o.delete(s),o.add(i)}}async ready(){this._initialized||(this.checkRootSync(),await this.checkRoot(),await this._populate(),this._initialized=!0)}constructor(t){var n,r,s;super((n=t.type)!==null&&n!==void 0?n:1802921587,t.name),this.store=t,this._ids=new Map([["/",0]]),this._paths=new Map([[0,new Set("/")]]),this._initialized=!1,t._fs=this,this._uuid=(r=t.uuid)!==null&&r!==void 0?r:this.uuid,bx(this.name+": supports features: "+((s=this.store.flags)===null||s===void 0?void 0:s.join(", ")))}usage(){var t,n;return((n=(t=this.store).usage)===null||n===void 0?void 0:n.call(t))||{totalSpace:0,freeSpace:0}}async loadIndex(t){const n={stack:[],error:void 0,hasError:!1};try{const r=Ms(n,this.transaction(),!0),s=t.directories();for(const[i,a]of t)this._add(a.ino,i),await r.set(a.ino,ga(a)),s.has(i)&&await r.set(a.data,Il(s.get(i)));await r.commit()}catch(r){n.error=r,n.hasError=!0}finally{const r=Is(n);r&&await r}}loadIndexSync(t){const n={stack:[],error:void 0,hasError:!1};try{const r=Ms(n,this.transaction(),!1),s=t.directories();for(const[i,a]of t)this._add(a.ino,i),r.setSync(a.ino,ga(a)),s.has(i)&&r.setSync(a.data,Il(s.get(i)));r.commitSync()}catch(r){n.error=r,n.hasError=!0}finally{Is(n)}}async createIndex(){var t;const n={stack:[],error:void 0,hasError:!1};try{const r=new FC,s=Ms(n,this.transaction(),!0),i=[["/",0]],a=z$(Xe.With("EDEADLK"));for(;i.length;){const[o,l]=i.shift(),c=new Ci(await s.get(l));if(r.set(o,c),c.mode&Ti){const u=Ka((t=await s.get(c.data))!==null&&t!==void 0?t:bs(Xe.With("ENODATA",o)));for(const[d,h]of Object.entries(u))i.push([as(o,d),h])}}return a(),r}catch(r){n.error=r,n.hasError=!0}finally{const r=Is(n);r&&await r}}createIndexSync(){var t;const n={stack:[],error:void 0,hasError:!1};try{const r=new FC,s=Ms(n,this.transaction(),!1),i=[["/",0]],a=z$(Xe.With("EDEADLK"));for(;i.length;){const[o,l]=i.shift(),c=new Ci(s.getSync(l));if(r.set(o,c),c.mode&Ti){const u=Ka((t=s.getSync(c.data))!==null&&t!==void 0?t:bs(Xe.With("ENODATA",o)));for(const[d,h]of Object.entries(u))i.push([as(o,d),h])}}return a(),r}catch(r){n.error=r,n.hasError=!0}finally{Is(n)}}async rename(t,n){var r,s,i;const a={stack:[],error:void 0,hasError:!1};try{const o=Ms(a,this.transaction(),!0),l=au(t),c=au(n),u=await this.findInode(o,l.dir,"rename"),d=Ka((r=await o.get(u.data))!==null&&r!==void 0?r:bs(Xe.With("ENODATA",l.dir,"rename")));if(!d[l.base])throw Xe.With("ENOENT",t,"rename");const h=d[l.base];if(h!=this._ids.get(t)&&_o(`Ino mismatch while renaming ${t} to ${n}`),delete d[l.base],(c.dir+"/").startsWith(t+"/"))throw new Xe(yt.EBUSY,l.dir);const m=c.dir==l.dir,y=m?u:await this.findInode(o,c.dir,"rename"),b=m?d:Ka((s=await o.get(y.data))!==null&&s!==void 0?s:bs(Xe.With("ENODATA",c.dir,"rename")));if(b[c.base]){const v=new Ci((i=await o.get(b[c.base]))!==null&&i!==void 0?i:bs(Xe.With("ENOENT",n,"rename")));if(!v.toStats().isFile())throw Xe.With("EPERM",n,"rename");await o.remove(v.data),await o.remove(b[c.base])}b[c.base]=h,await o.set(u.data,Il(d)),await o.set(y.data,Il(b)),await o.commit(),this._move(t,n)}catch(o){a.error=o,a.hasError=!0}finally{const o=Is(a);o&&await o}}renameSync(t,n){var r,s,i;const a={stack:[],error:void 0,hasError:!1};try{const o=Ms(a,this.transaction(),!1),l=au(t),c=au(n),u=this.findInodeSync(o,l.dir,"rename"),d=Ka((r=o.getSync(u.data))!==null&&r!==void 0?r:bs(Xe.With("ENODATA",l.dir,"rename")));if(!d[l.base])throw Xe.With("ENOENT",t,"rename");const h=d[l.base];if(h!=this._ids.get(t)&&_o(`Ino mismatch while renaming ${t} to ${n}`),delete d[l.base],(c.dir+"/").startsWith(t+"/"))throw new Xe(yt.EBUSY,l.dir);const m=c.dir===l.dir,y=m?u:this.findInodeSync(o,c.dir,"rename"),b=m?d:Ka((s=o.getSync(y.data))!==null&&s!==void 0?s:bs(Xe.With("ENODATA",c.dir,"rename")));if(b[c.base]){const v=new Ci((i=o.getSync(b[c.base]))!==null&&i!==void 0?i:bs(Xe.With("ENOENT",n,"rename")));if(!v.toStats().isFile())throw Xe.With("EPERM",n,"rename");o.removeSync(v.data),o.removeSync(b[c.base])}b[c.base]=h,o.setSync(u.data,Il(d)),o.setSync(y.data,Il(b)),o.commitSync(),this._move(t,n)}catch(o){a.error=o,a.hasError=!0}finally{Is(a)}}async stat(t){const n={stack:[],error:void 0,hasError:!1};try{const r=Ms(n,this.transaction(),!0);return await this.findInode(r,t,"stat")}catch(r){n.error=r,n.hasError=!0}finally{const r=Is(n);r&&await r}}statSync(t){const n={stack:[],error:void 0,hasError:!1};try{const r=Ms(n,this.transaction(),!1);return this.findInodeSync(r,t,"stat")}catch(r){n.error=r,n.hasError=!0}finally{Is(n)}}async touch(t,n){const r={stack:[],error:void 0,hasError:!1};try{const s=Ms(r,this.transaction(),!0),i=await this.findInode(s,t,"touch");i.update(n)&&(this._add(i.ino,t),s.setSync(i.ino,ga(i))),await s.commit()}catch(s){r.error=s,r.hasError=!0}finally{const s=Is(r);s&&await s}}touchSync(t,n){const r={stack:[],error:void 0,hasError:!1};try{const s=Ms(r,this.transaction(),!1),i=this.findInodeSync(s,t,"touch");i.update(n)&&(this._add(i.ino,t),s.setSync(i.ino,ga(i))),s.commitSync()}catch(s){r.error=s,r.hasError=!0}finally{Is(r)}}async createFile(t,n){return n.mode|=Ec,await this.commitNew(t,n,new Uint8Array,"createFile")}createFileSync(t,n){return n.mode|=Ec,this.commitNewSync(t,n,new Uint8Array,"createFile")}async unlink(t){return this.remove(t,!1)}unlinkSync(t){this.removeSync(t,!1)}async rmdir(t){if((await this.readdir(t)).length)throw Xe.With("ENOTEMPTY",t,"rmdir");await this.remove(t,!0)}rmdirSync(t){if(this.readdirSync(t).length)throw Xe.With("ENOTEMPTY",t,"rmdir");this.removeSync(t,!0)}async mkdir(t,n){return n.mode|=Ti,await this.commitNew(t,n,Kp("{}"),"mkdir")}mkdirSync(t,n){return n.mode|=Ti,this.commitNewSync(t,n,Kp("{}"),"mkdir")}async readdir(t){var n;const r={stack:[],error:void 0,hasError:!1};try{const s=Ms(r,this.transaction(),!0),i=await this.findInode(s,t,"readdir");return Object.keys(Ka((n=await s.get(i.data))!==null&&n!==void 0?n:bs(Xe.With("ENOENT",t,"readdir"))))}catch(s){r.error=s,r.hasError=!0}finally{const s=Is(r);s&&await s}}readdirSync(t){var n;const r={stack:[],error:void 0,hasError:!1};try{const s=Ms(r,this.transaction(),!1),i=this.findInodeSync(s,t,"readdir");return Object.keys(Ka((n=s.getSync(i.data))!==null&&n!==void 0?n:bs(Xe.With("ENOENT",t,"readdir"))))}catch(s){r.error=s,r.hasError=!0}finally{Is(r)}}async sync(t,n,r){const s={stack:[],error:void 0,hasError:!1};try{const i=Ms(s,this.transaction(),!0),a=await this.findInode(i,t,"sync");n&&await i.set(a.data,n),a.update(r)&&(this._add(a.ino,t),await i.set(a.ino,ga(a))),await i.commit()}catch(i){s.error=i,s.hasError=!0}finally{const i=Is(s);i&&await i}}syncSync(t,n,r){const s={stack:[],error:void 0,hasError:!1};try{const i=Ms(s,this.transaction(),!1),a=this.findInodeSync(i,t,"sync");n&&i.setSync(a.data,n),a.update(r)&&(this._add(a.ino,t),i.setSync(a.ino,ga(a))),i.commitSync()}catch(i){s.error=i,s.hasError=!0}finally{Is(s)}}async link(t,n){var r;const s={stack:[],error:void 0,hasError:!1};try{const i=Ms(s,this.transaction(),!0),a=Yr(n),o=await this.findInode(i,a,"link"),l=Ka((r=await i.get(o.data))!==null&&r!==void 0?r:bs(Xe.With("ENOENT",a,"link"))),c=await this.findInode(i,t,"link");c.nlink++,l[ny(n)]=c.ino,this._add(c.ino,n),await i.set(c.ino,ga(c)),await i.set(o.data,Il(l)),await i.commit()}catch(i){s.error=i,s.hasError=!0}finally{const i=Is(s);i&&await i}}linkSync(t,n){var r;const s={stack:[],error:void 0,hasError:!1};try{const i=Ms(s,this.transaction(),!1),a=Yr(n),o=this.findInodeSync(i,a,"link"),l=Ka((r=i.getSync(o.data))!==null&&r!==void 0?r:bs(Xe.With("ENOENT",a,"link"))),c=this.findInodeSync(i,t,"link");c.nlink++,l[ny(n)]=c.ino,this._add(c.ino,n),i.setSync(c.ino,ga(c)),i.setSync(o.data,Il(l)),i.commitSync()}catch(i){s.error=i,s.hasError=!0}finally{Is(s)}}async read(t,n,r,s){var i;const a={stack:[],error:void 0,hasError:!1};try{const o=Ms(a,this.transaction(),!0),l=await this.findInode(o,t,"read");if(l.size==0)return;const c=(i=await o.get(l.data,r,s))!==null&&i!==void 0?i:bs(Xe.With("ENODATA",t,"read")),u=o.flag("partial")?c:c.subarray(r,s);u.byteLength>n.byteLength&&_o(`Trying to place ${u.byteLength} bytes into a ${n.byteLength} byte buffer on read`),n.set(u)}catch(o){a.error=o,a.hasError=!0}finally{const o=Is(a);o&&await o}}readSync(t,n,r,s){var i;const a={stack:[],error:void 0,hasError:!1};try{const o=Ms(a,this.transaction(),!1),l=this.findInodeSync(o,t,"read");if(l.size==0)return;const c=(i=o.getSync(l.data,r,s))!==null&&i!==void 0?i:bs(Xe.With("ENODATA",t,"read")),u=o.flag("partial")?c:c.subarray(r,s);u.byteLength>n.byteLength&&_o(`Trying to place ${u.byteLength} bytes into a ${n.byteLength} byte buffer on read`),n.set(u)}catch(o){a.error=o,a.hasError=!0}finally{Is(a)}}async write(t,n,r){var s;const i={stack:[],error:void 0,hasError:!1};try{const a=Ms(i,this.transaction(),!0),o=await this.findInode(a,t,"write");let l=n;a.flag("partial")||(l=Xx((s=await a.get(o.data))!==null&&s!==void 0?s:new Uint8Array,r+n.byteLength),l.set(n,r),r=0),await a.set(o.data,l,r),this._add(o.ino,t),await a.commit()}catch(a){i.error=a,i.hasError=!0}finally{const a=Is(i);a&&await a}}writeSync(t,n,r){var s;const i={stack:[],error:void 0,hasError:!1};try{const a=Ms(i,this.transaction(),!1),o=this.findInodeSync(a,t,"write");let l=n;a.flag("partial")||(l=Xx((s=a.getSync(o.data))!==null&&s!==void 0?s:new Uint8Array,r+n.byteLength),l.set(n,r),r=0),a.setSync(o.data,l,r),this._add(o.ino,t),a.commitSync()}catch(a){i.error=a,i.hasError=!0}finally{Is(i)}}transaction(){return new l_e(this.store.transaction(),this)}async checkRoot(){const t={stack:[],error:void 0,hasError:!1};try{const n=Ms(t,this.transaction(),!0);if(await n.get(Jo))return;const r=new Ci({ino:Jo,data:1,mode:511|Ti});await n.set(r.data,Kp("{}")),this._add(Jo,"/"),await n.set(Jo,ga(r)),await n.commit()}catch(n){t.error=n,t.hasError=!0}finally{const n=Is(t);n&&await n}}checkRootSync(){const t={stack:[],error:void 0,hasError:!1};try{const n=Ms(t,this.transaction(),!1);if(n.getSync(Jo))return;const r=new Ci({ino:Jo,data:1,mode:511|Ti});n.setSync(r.data,Kp("{}")),this._add(Jo,"/"),n.setSync(Jo,ga(r)),n.commitSync()}catch(n){t.error=n,t.hasError=!0}finally{Is(t)}}async _populate(){const t={stack:[],error:void 0,hasError:!1};try{if(this._initialized){Pa("Attempted to populate tables after initialization");return}bx("Populating tables with existing store metadata");const n=Ms(t,this.transaction(),!0),r=await n.get(Jo);if(!r){kO("Store does not have a root inode");const o=new Ci({ino:Jo,data:1,mode:511|Ti});await n.set(o.data,Kp("{}")),this._add(Jo,"/"),await n.set(Jo,ga(o)),await n.commit();return}if(r.length<Us(Ci)){PE("Store contains an invalid root inode. Refusing to populate tables");return}const s=new Set;let i=0;const a=[["/",Jo]];for(;a.length>0;){i++;const[o,l]=a.shift();this._add(l,o);const c=await n.get(l);if(!c){Pa("Store is missing data for inode: "+l);continue}if(c.length<Us(Ci)){Pa(`Invalid inode size for ino ${l}: ${c.length}`);continue}const u=new Ci(c);if((u.mode&Ti)!=Ti||s.has(l))continue;s.add(l);const d=await n.get(u.data);if(!d){Pa("Store is missing directory data: "+u.data);continue}const h=Ka(d);for(const[m,y]of Object.entries(h))a.push([as(o,m),y])}bx(`Added ${i} existing inode(s) from store`)}catch(n){t.error=n,t.hasError=!0}finally{const n=Is(t);n&&await n}}async findInode(t,n,r){var s;const i=this._ids.get(n);if(i===void 0)throw Xe.With("ENOENT",n,r);return new Ci((s=await t.get(i))!==null&&s!==void 0?s:bs(Xe.With("ENOENT",n,r)))}findInodeSync(t,n,r){var s;const i=this._ids.get(n);if(i===void 0)throw Xe.With("ENOENT",n,r);return new Ci((s=t.getSync(i))!==null&&s!==void 0?s:bs(Xe.With("ENOENT",n,r)))}allocNew(t,n){var r;(r=this._lastID)!==null&&r!==void 0||(this._lastID=Math.max(...this._paths.keys())),this._lastID+=2;const s=this._lastID;if(s>ao)throw _o(new Xe(yt.ENOSPC,"No IDs available",t,n),{fs:this});return this._add(s,t),s}async commitNew(t,n,r,s){var i;const a={stack:[],error:void 0,hasError:!1};try{if(t=="/")throw Xe.With("EEXIST",t,s);const o=Ms(a,this.transaction(),!0),{dir:l,base:c}=au(t),u=await this.findInode(o,l,s),d=Ka((i=await o.get(u.data))!==null&&i!==void 0?i:bs(Xe.With("ENOENT",l,s)));if(d[c])throw Xe.With("EEXIST",t,s);const h=this.allocNew(t,s),m=new Ci({...n,ino:h,data:h+1,size:r.byteLength});return await o.set(m.ino,ga(m)),await o.set(m.data,r),d[c]=m.ino,await o.set(u.data,Il(d)),await o.commit(),m}catch(o){a.error=o,a.hasError=!0}finally{const o=Is(a);o&&await o}}commitNewSync(t,n,r,s){var i;const a={stack:[],error:void 0,hasError:!1};try{if(t=="/")throw Xe.With("EEXIST",t,s);const o=Ms(a,this.transaction(),!1),{dir:l,base:c}=au(t),u=this.findInodeSync(o,l,s),d=Ka((i=o.getSync(u.data))!==null&&i!==void 0?i:bs(Xe.With("ENOENT",l,s)));if(d[c])throw Xe.With("EEXIST",t,s);const h=this.allocNew(t,s),m=new Ci({...n,ino:h,data:h+1,size:r.byteLength});return o.setSync(m.ino,ga(m)),o.setSync(m.data,r),d[c]=m.ino,o.setSync(u.data,Il(d)),o.commitSync(),m}catch(o){a.error=o,a.hasError=!0}finally{Is(a)}}async remove(t,n){var r,s;const i={stack:[],error:void 0,hasError:!1};try{const a=n?"rmdir":"unlink",o=Ms(i,this.transaction(),!0),{dir:l,base:c}=au(t),u=await this.findInode(o,l,a),d=Ka((r=await o.get(u.data))!==null&&r!==void 0?r:bs(Xe.With("ENOENT",l,a)));if(!d[c])throw Xe.With("ENOENT",t,a);const h=d[c],m=new Ci((s=await o.get(h))!==null&&s!==void 0?s:bs(Xe.With("ENOENT",t,a)));if(delete d[c],!n&&Oc(m))throw Xe.With("EISDIR",t,a);await o.set(u.data,Il(d)),m.nlink>1?(m.update({nlink:m.nlink-1}),await o.set(m.ino,ga(m))):(await o.remove(m.data),await o.remove(h),this._remove(h)),await o.commit()}catch(a){i.error=a,i.hasError=!0}finally{const a=Is(i);a&&await a}}removeSync(t,n){var r,s;const i={stack:[],error:void 0,hasError:!1};try{const a=n?"rmdir":"unlink",o=Ms(i,this.transaction(),!1),{dir:l,base:c}=au(t),u=this.findInodeSync(o,l,a),d=Ka((r=o.getSync(u.data))!==null&&r!==void 0?r:bs(Xe.With("ENOENT",l,a))),h=d[c];if(!h)throw Xe.With("ENOENT",t,a);const m=new Ci((s=o.getSync(h))!==null&&s!==void 0?s:bs(Xe.With("ENOENT",t,a)));if(delete d[c],!n&&Oc(m))throw Xe.With("EISDIR",t,a);o.setSync(u.data,Il(d)),m.nlink>1?(m.update({nlink:m.nlink-1}),o.setSync(m.ino,ga(m))):(o.removeSync(m.data),o.removeSync(h),this._remove(h)),o.commitSync()}catch(a){i.error=a,i.hasError=!0}finally{Is(i)}}}class c_e extends o_e{async keys(){return this.store.keys()}async get(t){var n,r,s;return await((s=(r=(n=this.store).getAsync)===null||r===void 0?void 0:r.call(n,t))!==null&&s!==void 0?s:this.store.get(t))}getSync(t){return this.store.get(t)}setSync(t,n){this.store.set(t,n)}removeSync(t){this.store.delete(t)}}class u_e extends Map{constructor(t=ao,n){super(),this.maxSize=t,this.label=n,this.flags=[],this.name="tmpfs"}async sync(){}transaction(){return new c_e(this)}get bytes(){let t=this.size*4;for(const n of this.values())t+=n.byteLength;return t}usage(){return{totalSpace:this.maxSize,freeSpace:this.maxSize-this.bytes}}}const d_e={name:"InMemory",options:{maxSize:{type:"number",required:!1},label:{type:"string",required:!1}},create({maxSize:e,label:t}){const n=new OK(new u_e(e,t));return n.checkRootSync(),n}},f_e=d_e;let Ui=!0;class K$ extends bO{get cursor(){return this._cursor}constructor(t,n,r,s=!1){super(),this.input=t,this.output=n,this.terminal=s,this.line="",this._cursor=0,this._buffer="",this._closed=!1,this._paused=!1,this._prompt="",this._history=[],this._historyIndex=-1,this._currentLine="",this._onData=i=>{if(!(this._paused||this._closed)){this._buffer+=typeof i=="string"?i:i.toString("utf8");for(let a=this._buffer.indexOf(`
`);a>=0;a=this._buffer.indexOf(`
`)){let o=this._buffer.substring(0,a);o.endsWith("\r")&&(o=o.substring(0,o.length-1)),this._buffer=this._buffer.substring(a+1),this.line=o,o.trim()&&!o.trim().match(/^\s*$/)&&this._history.at(-1)!=o&&(this._history.push(o),this._historyIndex=this._history.length,this.emit("history",this._history)),this.emit("line",o)}}},this.input.on("data",this._onData),this.input.on("end",this.close.bind(this)),this.input.on("close",this.close.bind(this))}close(){var t,n;if(!this._closed){if(this._closed=!0,(n=(t=this.input)===null||t===void 0?void 0:t.removeAllListeners)===null||n===void 0||n.call(t),this._buffer.length){const r=this._buffer;this._buffer="",this.line=r,this.emit("line",r)}this.emit("history",this._history),this.emit("close"),this.removeAllListeners()}}pause(){return this._paused?this:(this._paused=!0,"pause"in this.input&&this.input.pause(),this.emit("pause"),this)}resume(){return this._paused?(this._paused=!1,"resume"in this.input&&this.input.resume(),this.emit("resume"),this):this}setPrompt(t){this._prompt=t}getPrompt(){return this._prompt}prompt(t){if(!this.output)return;if(!t){this.output.write(this._prompt);return}const{cols:n}=this.getCursorPos();this.output.write(this._prompt),this._cursor=n}write(t,n){if(!this._closed){if(t){const r=typeof t=="string"?t:t.toString("utf8");this._onData(r)}if(!(!n||!this.terminal))switch((n.ctrl?"^":"")+n.name){case"^c":this.emit("SIGINT");break;case"^z":this.emit("SIGTSTP");break;case"^q":this.emit("SIGCONT");break;case"home":case"^a":if(!this.output)return;jl(this.output,-this._cursor,0),this._cursor=0,this._cursor=0;break;case"^e":case"end":{if(!this.output)return;const r=this.line.length-this._cursor;if(!r)return;jl(this.output,r,0),this._cursor=this.line.length,this._cursor=this.line.length;break}case"^k":{if(!this.output||this._cursor>=this.line.length)return;const r=this.line.slice(0,this._cursor);RS(this.output,1),this.line=r;break}case"^u":{if(!this.output||!this._cursor)return;const r=this.line.slice(this._cursor);RS(this.output,0),jl(this.output,0,0),this.output.write(this._prompt+r),this.line=r,this._cursor=0,this._cursor=0;break}case"^w":{if(!this.output||!this._cursor)return;let r=this._cursor-1;for(;r>=0&&this.line[r]===" ";)r--;for(;r>=0&&this.line[r]!==" ";)r--;const s=this.line.slice(0,r+1)+this.line.slice(this._cursor),i=r+1;this._renderLine(s),this._cursor=i,this._cursor=i,jl(this.output,-s.length,0),jl(this.output,i,0);break}case"^return":case"^enter":this._onData(`
`);break;case"return":case"enter":this._onData((t?typeof t=="string"?t:t.toString("utf8"):"")+`
`);break;case"up":case"down":{if(!this.output||!this._history.length)return;if(this._historyIndex===this._history.length&&(this._currentLine=this.line||""),n.name=="up"&&this._historyIndex>0)this._historyIndex--;else if(n.name=="down"&&this._historyIndex<this._history.length-1)this._historyIndex++;else if(n.name=="down"&&this._historyIndex==this._history.length-1){this._historyIndex=this._history.length,this._renderLine(this._currentLine);return}else return;const r=this._history[this._historyIndex];this._renderLine(r);break}case"left":case"right":{const r=n.name=="left"?-1:1;if(!this.output)return;const s=Math.max(0,Math.min(this.line.length,this._cursor+r));if(s==this._cursor)return;jl(this.output,r,0),this._cursor=s,this._cursor=s;break}case"backspace":{if(!this.output||!this._cursor)return;const r=this.line.slice(0,this._cursor-1)+this.line.slice(this._cursor);this._renderLine(r),this._cursor=--this._cursor,this._cursor>0&&(jl(this.output,-this._cursor,0),jl(this.output,this._cursor,0));break}case"delete":{if(!this.output||this._cursor>=this.line.length)return;const r=this.line.slice(0,this._cursor)+this.line.slice(this._cursor+1);RS(this.output,0),jl(this.output,0,0),this.output.write(this._prompt+r),this.line=r,jl(this.output,-r.length,0),jl(this.output,this._cursor,0);break}}}}_renderLine(t){this.output&&(RS(this.output,0),jl(this.output,0,0),this.output.write(this._prompt+t),this.line=t,this._cursor=t.length,this._cursor=t.length)}question(t,n,r){const s=typeof n=="function"?n:r;if(this._closed||!this.output){s("");return}this.output.write(t),this.once("line",s)}getCursorPos(){return{rows:0,cols:this.cursor}}prependListener(t,n){const r=this.listeners(t);return this.removeAllListeners(t),this.on(t,n),r.forEach(this.on.bind(this,t)),this}prependOnceListener(t,n){const r=this.listeners(t);return this.removeAllListeners(t),this.once(t,n),r.forEach(this.on.bind(this,t)),this}setMaxListeners(){return Pa("Interface.prototype.setMaxListeners is not supported"),this}getMaxListeners(){return Pa("Interface.prototype.getMaxListeners is not supported"),10}[Symbol.asyncIterator](){let t=!1;return{next:async()=>{if(t)return{done:t,value:void 0};const{resolve:n,promise:r}=Promise.withResolvers();return this.once("line",s=>n({value:s,done:!1})),this.once("close",()=>{t=!0,n({value:void 0,done:t})}),r},return:async n=>t?{done:t,value:n}:(t=!0,this.close(),{done:t,value:n}),throw:async n=>{throw t||(t=!0,this.close()),n},[Symbol.asyncIterator](){return this},[Symbol.asyncDispose]:async()=>{t||(t=!0,this.close())}}}async[Symbol.asyncDispose](){if(this._closed)return;const{resolve:t,promise:n}=Promise.withResolvers();this.once("close",()=>t()),this.close(),await n}rawListeners(t){return this.listeners(t)}}function h_e(e,t,n,r){return"input"in e?new K$(e.input,e.output,e.completer,e.terminal):new K$(e,t,n,r)}function RS(e,t){return e.write(t>=0?"\r\x1B[K":"\x1B[K"),!0}function jl(e,t,n){if(!e.write)return!1;let r="";return t<0?r+=`\x1B[${-t}D`:t>0&&(r+=`\x1B[${t}C`),n<0?r+=`\x1B[${-n}A`:n>0&&(r+=`\x1B[${n}B`),r&&e.write(r),!0}class BC{get position(){return this.flag&km?this.inode.size:this._position}set position(t){this._position=t}constructor(t,n,r,s,i,a){this.context=t,this.path=n,this.fs=r,this.internalPath=s,this.flag=i,this.inode=a,this._position=0,this.dirty=!1,this.closed=!1}[Symbol.dispose](){this.close()}get _isSync(){return!!(this.flag&LE||this.inode.flags&So.Sync)}sync(){if(this.closed)throw Xe.With("EBADF",this.path,"sync");this.dirty&&(this.fs.attributes.has("no_write")||this.fs.touchSync(this.internalPath,this.inode),this.dirty=!1)}datasync(){return this.sync()}close(){if(this.closed)throw Xe.With("EBADF",this.path,"close");this.sync(),this.dispose()}dispose(t){if(this.closed)throw Xe.With("EBADF",this.path,"dispose");if(this.dirty&&!t)throw Xe.With("EBUSY",this.path,"dispose");this.closed=!0}stat(){if(this.closed)throw Xe.With("EBADF",this.path,"stat");return this.inode}truncate(t){if(this.closed)throw Xe.With("EBADF",this.path,"truncate");if(this.dirty=!0,!(this.flag&ja||this.flag&jd))throw new Xe(yt.EPERM,"File not opened with a writeable mode",this.path,"truncate");this.inode.mtimeMs=Date.now(),this.inode.size=t,this.inode.ctimeMs=Date.now(),this._isSync&&this.sync()}write(t,n=0,r=t.byteLength-n,s=this.position){if(this.closed)throw Xe.With("EBADF",this.path,"write");if(!(this.flag&ja||this.flag&jd))throw new Xe(yt.EPERM,"File not opened with a writeable mode");if(this.inode.flags&So.Immutable)throw new Xe(yt.EPERM,"File is immutable",this.path,"write");this.dirty=!0;const i=s+r,a=t.subarray(n,n+r);return!tw(this.inode)&&!ew(this.inode)&&i>this.inode.size&&(this.inode.size=i),this.inode.mtimeMs=Date.now(),this.inode.ctimeMs=Date.now(),this._position=s+a.byteLength,this.fs.writeSync(this.internalPath,a,s),this._isSync&&this.sync(),a.byteLength}read(t,n=0,r=t.byteLength-n,s=this.position){if(this.closed)throw Xe.With("EBADF",this.path,"read");if(this.flag&ja)throw new Xe(yt.EPERM,"File not opened with a readable mode");this.inode.flags&So.NoAtime||(this.dirty=!0,this.inode.atimeMs=Date.now());let i=s+r;!tw(this.inode)&&!ew(this.inode)&&i>this.inode.size&&(i=s+Math.max(this.inode.size-s,0)),this._position=i;const a=new Uint8Array(t.buffer,t.byteOffset,t.byteLength);return this.fs.readSync(this.internalPath,a.subarray(n,n+r),s,i),this._isSync&&this.sync(),i-s}chmod(t){if(this.closed)throw Xe.With("EBADF",this.path,"chmod");this.dirty=!0,this.inode.mode=this.inode.mode&(t>Cs?-61441:Cs)|t,(this._isSync||t>Cs)&&this.sync()}chown(t,n){if(this.closed)throw Xe.With("EBADF",this.path,"chown");this.dirty=!0,jK(this.inode,t,n),this._isSync&&this.sync()}utimes(t,n){if(this.closed)throw Xe.With("EBADF",this.path,"utimes");this.dirty=!0,this.inode.atimeMs=t,this.inode.mtimeMs=n,this._isSync&&this.sync()}streamRead(t){if(this.closed)throw Xe.With("EBADF",this.path,"streamRead");return this.fs.streamRead(this.internalPath,t)}streamWrite(t){if(this.closed)throw Xe.With("EBADF",this.path,"streamWrite");if(this.inode.flags&So.Immutable)throw new Xe(yt.EPERM,"File is immutable",this.path,"streamWrite");return this.fs.streamWrite(this.internalPath,t)}}function $C(e){var t,n;const r=(n=(t=e.context)===null||t===void 0?void 0:t.descriptors)!==null&&n!==void 0?n:Lc.descriptors,s=Math.max(r.size?Math.max(...r.keys())+1:0,4);return r.set(s,e),s}function za(e,t){var n;const s=((n=e==null?void 0:e.descriptors)!==null&&n!==void 0?n:Lc.descriptors).get(t);if(!s)throw new Xe(yt.EBADF);return s}function DK(e,t){var n;return((n=e==null?void 0:e.descriptors)!==null&&n!==void 0?n:Lc.descriptors).delete(t)}const p_e=/[rwasx]{1,2}\+?/;function Od(e){if(typeof e=="number")return e;if(!p_e.test(e))throw new Xe(yt.EINVAL,"Invalid flag string: "+e);return m_e(e)}function m_e(e){if(!e.includes("r")&&!e.includes("w")&&!e.includes("a"))throw new Xe(yt.EINVAL,"Invalid flag string: "+e);let t=e.includes("r")?wK:OE;return e.includes("w")&&(t|=FE),e.includes("a")&&(t|=km),e.includes("+")?t|=jd:e.includes("r")||(t|=ja),e.includes("s")&&(t|=LE),e.includes("x")&&(t|=DE),t}function FK(e){let t=0;return e&ja||(t|=zi),(e&ja||e&jd)&&(t|=oi),t}const nw=new Map;MO("/",f_e.create({label:"root"}));function MO(e,t){if(e[0]!="/"&&(e="/"+e),e=Vd.call(this,e),nw.has(e))throw _o(new Xe(yt.EINVAL,"Mount point is already in use: "+e));t._mountPoint=e,nw.set(e,t),vK(`Mounted ${t.name} on ${e}`),bx(`${t.name} attributes: ${[...t.attributes].map(([n,r])=>r!=null?n+"="+r:n).join(", ")}`)}function LK(e){if(e[0]!="/"&&(e="/"+e),e=Vd.call(this,e),!nw.has(e)){Pa(e+" is already unmounted");return}nw.delete(e),kO("Unmounted "+e)}function Mr(e,t){const n=(t==null?void 0:t.root)||Lc.root;e=Fn(as(n,e));const r=[...nw].sort((s,i)=>s[0].length>i[0].length?-1:1);for(const[s,i]of r)if(y_e(s,e))return e=e.slice(s.length>1?s.length:0),e===""&&(e=n),{fs:i,path:e,mountPoint:s,root:n};throw T1e(new Xe(yt.EIO,"No file system",e))}function QN(e,t){for(const[n,r]of Object.entries(t))e=e==null?void 0:e.replaceAll(n,r);return e}function hs(e,t){typeof e.stack=="string"&&(e.stack=QN(e.stack,t));try{e.message=QN(e.message,t)}catch{}return e.path&&(e.path=QN(e.path,t)),e}function BK(e,t){const n=e.usage(),r=n.blockSize||4096;return{type:(t?BigInt:Number)(e.type),bsize:(t?BigInt:Number)(r),ffree:(t?BigInt:Number)(n.freeNodes||ao),files:(t?BigInt:Number)(n.totalNodes||ao),bavail:(t?BigInt:Number)(n.freeSpace/r),bfree:(t?BigInt:Number)(n.freeSpace/r),blocks:(t?BigInt:Number)(n.totalSpace/r)}}function g_e(e){var t,n,r,s,i,a,o;const l=this!==null&&this!==void 0?this:Lc;if(((t=l.credentials)===null||t===void 0?void 0:t.uid)!==0&&((n=l.credentials)===null||n===void 0?void 0:n.gid)!==0&&((r=l.credentials)===null||r===void 0?void 0:r.euid)!==0&&((s=l.credentials)===null||s===void 0?void 0:s.egid)!==0)throw new Xe(yt.EPERM,"Can not chroot() as non-root user");(i=l.root)!==null&&i!==void 0||(l.root="/");const c=as(l.root,e);for(const u of(o=(a=l.descriptors)===null||a===void 0?void 0:a.values())!==null&&o!==void 0?o:[]){if(!u.path.startsWith(l.root))throw Xe.With("EBUSY",u.path,"chroot");u.path=u.path.slice(l.root.length)}if(c.length>l.root.length)throw new Xe(yt.EPERM,"Can not chroot() outside of current root");l.root=c}function y_e(e,t){return e==="/"||e===t?!0:(e.endsWith("/")||(e+="/"),t.startsWith(e))}class $K extends bO{off(t,n,r,s){return super.off(t,n,r,s)}removeListener(t,n,r,s){return super.removeListener(t,n,r,s)}constructor(t,n){super(),this._context=t,this.path=n}setMaxListeners(){throw Xe.With("ENOSYS",this.path,"Watcher.setMaxListeners")}getMaxListeners(){throw Xe.With("ENOSYS",this.path,"Watcher.getMaxListeners")}prependListener(){throw Xe.With("ENOSYS",this.path,"Watcher.prependListener")}prependOnceListener(){throw Xe.With("ENOSYS",this.path,"Watcher.prependOnceListener")}rawListeners(){throw Xe.With("ENOSYS",this.path,"Watcher.rawListeners")}ref(){return this}unref(){return this}}class zK extends $K{constructor(t,n,r){super(t,n),this.options=r,this.realpath=t!=null&&t.root?as(t.root,n):n,v_e(this.realpath,this)}close(){super.emit("close"),x_e(this.realpath,this)}[Symbol.dispose](){this.close()}}class b_e extends $K{constructor(t,n,r){super(t,n),this.options=r,this.start()}onInterval(){try{const t=Sh(this.path);J1e(this.previous,t)||(this.emit("change",t,this.previous),this.previous=t)}catch(t){this.emit("error",t)}}start(){const t=this.options.interval||5e3;try{this.previous=Sh(this.path)}catch(n){this.emit("error",n);return}this.intervalId=setInterval(this.onInterval.bind(this),t),!this.options.persistent&&typeof this.intervalId=="object"&&this.intervalId.unref()}stop(){this.intervalId&&(clearInterval(this.intervalId),this.intervalId=void 0),this.removeAllListeners()}}const oh=new Map;function v_e(e,t){const n=Fn(e);oh.has(n)||oh.set(n,new Set),oh.get(n).add(t)}function x_e(e,t){const n=Fn(e);oh.has(n)&&(oh.get(n).delete(t),oh.get(n).size===0&&oh.delete(n))}function wa(e,t,n){var r;e&&(n=as((r=e.root)!==null&&r!==void 0?r:"/",n)),n=Fn(n);for(let s=n;s!="/";s=Yr(s)){const i=oh.get(s);if(i)for(const a of i)a.emit("change",t,bK.call(a._context,s,n)||ny(n))}}var g1=function(e,t,n){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var r,s;if(n){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=t[Symbol.asyncDispose]}if(r===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=t[Symbol.dispose],n&&(s=r)}if(typeof r!="function")throw new TypeError("Object not disposable.");s&&(r=function(){try{s.call(this)}catch(i){return Promise.reject(i)}}),e.stack.push({value:t,dispose:r,async:n})}else n&&e.stack.push({async:!0});return t},y1=function(e){return function(t){function n(a){t.error=t.hasError?new e(a,t.error,"An error was suppressed during disposal."):a,t.hasError=!0}var r,s=0;function i(){for(;r=t.stack.pop();)try{if(!r.async&&s===1)return s=0,t.stack.push(r),Promise.resolve().then(i);if(r.dispose){var a=r.dispose.call(r.value);if(r.async)return s|=2,Promise.resolve(a).then(i,function(o){return n(o),i()})}else s|=1}catch(o){n(o)}if(s===1)return t.hasError?Promise.reject(t.error):Promise.resolve();if(t.hasError)throw t.error}return i()}}(typeof SuppressedError=="function"?SuppressedError:function(e,t,n){var r=new Error(n);return r.name="SuppressedError",r.error=e,r.suppressed=t,r});function w_e(e,t){e=Fn(e),t=Fn(t);const n=Mr(e,this),r=Mr(t,this);if(!Sh.call(this,Yr(e)).hasAccess(oi,this))throw Xe.With("EACCES",e,"rename");try{if(n===r){n.fs.renameSync(n.path,r.path),wa(this,"rename",e.toString()),wa(this,"change",t.toString());return}DO.call(this,t,OO(e)),PO.call(this,e),wa(this,"rename",e.toString())}catch(s){throw hs(s,{[n.path]:e,[r.path]:t})}}function IO(e){e=Fn(e);try{const{fs:t,path:n}=Mr(qh.call(this,e),this);return t.existsSync(n)}catch(t){if(t.errno==yt.ENOENT)return!1;throw t}}function Sh(e,t){e=Fn(e);const{fs:n,path:r}=Mr(qh.call(this,e),this);try{const s=n.statSync(r);if(Ui&&!fs(this,s,zi))throw Xe.With("EACCES",r,"stat");return t!=null&&t.bigint?new Wm(s):new tf(s)}catch(s){throw hs(s,{[r]:e})}}function jO(e,t){e=Fn(e);const{fs:n,path:r}=Mr(e,this);try{const s=n.statSync(r);if(Ui&&!fs(this,s,zi))throw Xe.With("EACCES",r,"lstat");return t!=null&&t.bigint?new Wm(s):new tf(s)}catch(s){throw hs(s,{[r]:e})}}function __e(e,t=0){const n={stack:[],error:void 0,hasError:!1};try{const r=g1(n,Hm.call(this,e,{flag:"r+"}),!1);if(t||(t=0),t<0)throw new Xe(yt.EINVAL);r.truncate(t)}catch(r){n.error=r,n.hasError=!0}finally{y1(n)}}function PO(e){e=Fn(e);const{fs:t,path:n}=Mr(e,this);try{if(Ui&&!fs(this,t.statSync(n),oi))throw Xe.With("EACCES",n,"unlink");t.unlinkSync(n),wa(this,"rename",e.toString())}catch(r){throw hs(r,{[n]:e})}}function Hm(e,t){var n;e=Fn(e);const r=Uh(t.mode,420),s=Od(t.flag);e=t.preserveSymlinks?e:qh.call(this,e);const{fs:i,path:a}=Mr(e,this);let o;try{o=i.statSync(a)}catch{}if(!o){if(!(s&OE))throw Xe.With("ENOENT",e,"_open");const c=i.statSync(Yr(a));if(!fs(this,c,oi))throw Xe.With("EACCES",Yr(e),"_open");if(!Oc(c))throw Xe.With("ENOTDIR",Yr(e),"_open");if(!t.allowDirectory&&r&Ti)throw Xe.With("EISDIR",e,"_open");if(!fs(this,c,oi))throw Xe.With("EACCES",Yr(a),"_open");const{euid:u,egid:d}=(n=this===null||this===void 0?void 0:this.credentials)!==null&&n!==void 0?n:Lc.credentials,h=i.createFileSync(a,{mode:r,uid:c.mode&p1?c.uid:u,gid:c.mode&m1?c.gid:d});return new BC(this,e,i,a,s,h)}if(!fs(this,o,r)||!fs(this,o,FK(s)))throw Xe.With("EACCES",e,"_open");if(s&DE)throw Xe.With("EEXIST",e,"_open");const l=new BC(this,e,i,a,s,o);if(s&FE&&l.truncate(0),!t.allowDirectory&&o.mode&Ti)throw Xe.With("EISDIR",e,"_open");return l}function BE(e,t,n=TO){return $C(Hm.call(this,e,{flag:t,mode:n}))}function $E(e,t,n){return $C(Hm.call(this,e,{flag:t,mode:n,preserveSymlinks:!0}))}function UK(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{const s=g1(r,typeof e=="number"?za(this,e):Hm.call(this,e.toString(),{flag:t,mode:420,preserveSymlinks:n}),!1),{size:i}=s.stat(),a=new Uint8Array(i);return s.read(a,0,i,0),a}catch(s){r.error=s,r.hasError=!0}finally{y1(r)}}function OO(e,t={}){const n=Pd(t,null,"r",420);if(Od(n.flag)&ja)throw new Xe(yt.EINVAL,"Flag passed to readFile must allow for reading");const s=Os.from(UK.call(this,e,n.flag,!1));return n.encoding?s.toString(n.encoding):s}function DO(e,t,n={}){const r={stack:[],error:void 0,hasError:!1};try{const s=Pd(n,"utf8","w+",420),i=Od(s.flag);if(!(i&ja||i&jd))throw new Xe(yt.EINVAL,"Flag passed to writeFile must allow for writing");if(typeof t!="string"&&!s.encoding)throw new Xe(yt.EINVAL,"Encoding not specified");const a=typeof t=="string"?Os.from(t,s.encoding):new Uint8Array(t.buffer,t.byteOffset,t.byteLength);if(!a)throw new Xe(yt.EINVAL,"Data not specified");g1(r,typeof e=="number"?za(this,e):Hm.call(this,e.toString(),{flag:i,mode:s.mode,preserveSymlinks:!0}),!1).write(a,0,a.byteLength,0),wa(this,"change",e.toString())}catch(s){r.error=s,r.hasError=!0}finally{y1(r)}}function S_e(e,t,n={}){const r={stack:[],error:void 0,hasError:!1};try{const s=Pd(n,"utf8","a+",420),i=Od(s.flag);if(!(i&km))throw new Xe(yt.EINVAL,"Flag passed to appendFile must allow for appending");if(typeof t!="string"&&!s.encoding)throw new Xe(yt.EINVAL,"Encoding not specified");const a=typeof t=="string"?Os.from(t,s.encoding):new Uint8Array(t.buffer,t.byteOffset,t.byteLength);g1(r,Hm.call(this,typeof e=="number"?za(this,e).path:e.toString(),{flag:i,mode:s.mode,preserveSymlinks:!0}),!1).write(a,0,a.byteLength)}catch(s){r.error=s,r.hasError=!0}finally{y1(r)}}function C_e(e,t){const n=za(this,e).stat();return t!=null&&t.bigint?new Wm(n):new tf(n)}function Gm(e){za(this,e).close(),DK(this,e)}function k_e(e,t=0){if(t||(t=0),t<0)throw new Xe(yt.EINVAL);za(this,e).truncate(t)}function E_e(e){za(this,e).sync()}function T_e(e){za(this,e).datasync()}function A_e(e,t,n,r,s){let i,a,o,l;if(typeof t=="string"){l=typeof n=="number"?n:null;const d=typeof r=="string"?r:"utf8";a=0,i=Os.from(t,d),o=i.byteLength}else i=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),a=n,o=r,l=typeof s=="number"?s:null;const c=za(this,e);l??(l=c.position);const u=c.write(i,a,o,l);return wa(this,"change",c.path),u}function R_e(e,t,n,r,s){const i=za(this,e),a=typeof n=="object"?n.offset:n;return typeof n=="object"&&(r=n.length,s=n.position),s=Number(s),isNaN(s)&&(s=i.position),i.read(t,a,r,s)}function FO(e,t,n){za(this,e).chown(t,n)}function LO(e,t){const n=Uh(t,-1);if(n<0)throw new Xe(yt.EINVAL,"Invalid mode.");za(this,e).chmod(n)}function BO(e,t,n){za(this,e).utimes(LC(t),LC(n))}function qK(e){e=Fn(e);const{fs:t,path:n}=Mr(qh.call(this,e),this);try{const r=t.statSync(n);if(!Oc(r))throw Xe.With("ENOTDIR",n,"rmdir");if(Ui&&!fs(this,r,oi))throw Xe.With("EACCES",n,"rmdir");t.rmdirSync(n),wa(this,"rename",e.toString())}catch(r){throw hs(r,{[n]:e})}}function $O(e,t){var n,r;const{euid:s,egid:i}=(n=this===null||this===void 0?void 0:this.credentials)!==null&&n!==void 0?n:Lc.credentials;t=typeof t=="object"?t:{mode:t};const a=Uh(t==null?void 0:t.mode,511);e=qh.call(this,e);const{fs:o,path:l,root:c}=Mr(e,this),u={[l]:e},d=(h,m)=>{if(!fs(this,m,oi))throw Xe.With("EACCES",Yr(h),"mkdir");const y=o.mkdirSync(h,{mode:a,uid:m.mode&p1?m.uid:s,gid:m.mode&m1?m.gid:i});return wa(this,"rename",h),y};try{if(!(t!=null&&t.recursive)){d(l,o.statSync(Yr(l)));return}const h=[];for(let y=l,b=e;!o.existsSync(y);y=Yr(y),b=Yr(b))h.unshift(y),u[y]=b;if(!h.length)return;const m=[o.statSync(Yr(h[0]))];for(const[y,b]of h.entries())m.push(d(b,m[y]));return c.length==1?h[0]:(r=h[0])===null||r===void 0?void 0:r.slice(c.length)}catch(h){throw hs(h,u)}}function Uy(e,t){t=typeof t=="object"?t:{encoding:t},e=Fn(e);const{fs:n,path:r}=Mr(qh.call(this,e),this);let s;try{const a=n.statSync(r);if(Ui&&!fs(this,a,zi))throw Xe.With("EACCES",r,"readdir");if(!Oc(a))throw Xe.With("ENOTDIR",r,"readdir");s=n.readdirSync(r)}catch(a){throw hs(a,{[r]:e})}const i=[];for(const a of s){let o;try{o=n.statSync(as(r,a))}catch{continue}if(t!=null&&t.withFileTypes?i.push(new rw(a,o)):(t==null?void 0:t.encoding)=="buffer"?i.push(Os.from(a)):i.push(a),!(!Oc(o)||!(t!=null&&t.recursive)))for(const l of Uy.call(this,as(e,a),t))l instanceof rw?(l.path=as(a,l.path),i.push(l)):Os.isBuffer(l)?i.push(Os.from(as(a,xO(l)))):i.push(as(a,l))}return i}function N_e(e,t){if(e=Fn(e),!Sh(Yr(e)).hasAccess(zi,this))throw Xe.With("EACCES",Yr(e),"link");if(t=Fn(t),!Sh(Yr(t)).hasAccess(oi,this))throw Xe.With("EACCES",Yr(t),"link");const{fs:n,path:r}=Mr(e,this),s=Mr(t,this);if(n!=s.fs)throw Xe.With("EXDEV",t,"link");try{if(Ui&&!fs(this,n.statSync(r),zi))throw Xe.With("EACCES",r,"link");return n.linkSync(r,s.path)}catch(i){throw hs(i,{[r]:e,[s.path]:t})}}function M_e(e,t,n="file"){const r={stack:[],error:void 0,hasError:!1};try{if(!["file","dir","junction"].includes(n))throw new Xe(yt.EINVAL,"Invalid type: "+n);t=Fn(t);const s=g1(r,Hm.call(this,t,{flag:"wx",mode:420}),!1);s.write(Kp(Fn(e,!0))),s.chmod(ef)}catch(s){r.error=s,r.hasError=!0}finally{y1(r)}}function _j(e,t){const n=Os.from(UK.call(this,e,"r",!0)),r=typeof t=="object"?t==null?void 0:t.encoding:t;return r=="buffer"?n:n.toString(r??"utf-8")}function I_e(e,t,n){const r=BE.call(this,e,"r+");FO.call(this,r,t,n),Gm.call(this,r)}function j_e(e,t,n){const r=$E.call(this,e,"r+");FO.call(this,r,t,n),Gm.call(this,r)}function P_e(e,t){const n=BE.call(this,e,"r+");LO.call(this,n,t),Gm.call(this,n)}function O_e(e,t){const n=$E.call(this,e,"r+");LO.call(this,n,t),Gm.call(this,n)}function VK(e,t,n){const r=BE.call(this,e,"r+");BO.call(this,r,t,n),Gm.call(this,r)}function D_e(e,t,n){const r=$E.call(this,e,"r+");BO.call(this,r,t,n),Gm.call(this,r)}function Sj(e,t,n){try{const l=Mr(t,e),c=l.fs.statSync(l.path);if(!ry(c))return{...l,fullPath:t,stats:c};const u=Vd.call(e,Yr(t),_j.call(e,t).toString());return Sj(e,u)}catch{}const{base:r,dir:s}=au(t),i=s=="/"?"/":qh.call(e,s),a=as(i,r),o=Mr(a,e);try{const l=o.fs.statSync(o.path);if(!ry(l))return{...o,fullPath:a,stats:l};const c=Vd.call(e,i,_j.call(e,a).toString());return Sj(e,c)}catch(l){if(l.code=="ENOENT")return{...o,fullPath:t};throw hs(l,{[o.path]:a})}}function qh(e,t){var n;const r=typeof t=="string"?t:(n=t==null?void 0:t.encoding)!==null&&n!==void 0?n:"utf8";e=Fn(e);const{fullPath:s}=Sj(this,e);if(r=="utf8"||r=="utf-8")return s;const i=Os.from(s,"utf-8");return r=="buffer"?i:i.toString(r)}function F_e(e,t=384){if(!fs(this,Sh.call(this,e),t))throw new Xe(yt.EACCES)}function WK(e,t){e=Fn(e);let n;try{n=jO.bind(this)(e)}catch(r){if(r.code!="ENOENT"||!(t!=null&&t.force))throw r}if(n)switch(n.mode&Cs){case Ti:if(t!=null&&t.recursive)for(const r of Uy.call(this,e))WK.call(this,as(e,r),t);qK.call(this,e);break;case Ec:case ef:case Um:case qm:PO.call(this,e);break;case Vm:case zm:default:throw new Xe(yt.EPERM,"File type not supported",e,"rm")}}function L_e(e,t){const n=typeof t=="object"?t==null?void 0:t.encoding:t||"utf8",s="/tmp/"+`${e}${Date.now()}-${Math.random().toString(36).slice(2)}`;return $O.call(this,s),n=="buffer"?Os.from(s):s}function HK(e,t,n){if(e=Fn(e),t=Fn(t),n&&n&AO&&IO(t))throw new Xe(yt.EEXIST,"Destination file already exists",t,"copyFile");DO.call(this,t,OO(e)),wa(this,"rename",t.toString())}function B_e(e,t,n){const r=za(this,e);let s=0;for(const i of t)s+=r.read(i,0,i.byteLength,n+s);return s}function $_e(e,t,n){const r=za(this,e);let s=0;for(const i of t)s+=r.write(new Uint8Array(i.buffer),0,i.byteLength,n+s);return s}function z_e(e,t){return e=Fn(e),new zO(e,this)}function GK(e,t,n){e=Fn(e),t=Fn(t);const r=jO.call(this,e);if(n!=null&&n.errorOnExist&&IO.call(this,t))throw new Xe(yt.EEXIST,"Destination file or directory already exists",t,"cp");switch(r.mode&Cs){case Ti:if(!(n!=null&&n.recursive))throw new Xe(yt.EISDIR,e+" is a directory (not copied)",e,"cp");$O.call(this,t,{recursive:!0});for(const s of Uy.call(this,e,{withFileTypes:!0}))n.filter&&!n.filter(as(e,s.name),as(t,s.name))||GK.call(this,as(e,s.name),as(t,s.name),n);break;case Ec:case ef:HK.call(this,e,t);break;case Um:case qm:case Vm:case zm:default:throw new Xe(yt.EPERM,"File type not supported",e,"rm")}n!=null&&n.preserveTimestamps&&VK.call(this,t,r.atime,r.mtime)}function U_e(e,t){e=Fn(e);const{fs:n}=Mr(e,this);return BK(n,t==null?void 0:t.bigint)}function q_e(e,t={}){e=Array.isArray(e)?e:[e];const{cwd:n="/",withFileTypes:r=!1,exclude:s=()=>!1}=t,i=e.map(l=>(l=l.replace(/([.?+^$(){}|[\]/])/g,"\\$1").replace(/\*\*/g,".*").replace(/\*/g,"[^/]*").replace(/\?/g,"."),new RegExp(`^${l}$`))),a=[];function o(l){const c=Uy(l,{withFileTypes:r,encoding:"utf8"});for(const u of c){const d=r?u.path:l+"/"+u;s(r?u:d)||(Sh(d).isDirectory()&&i.some(h=>h.source.includes(".*"))&&o(d),i.some(h=>h.test(d.replace(/^\/+/g,"")))&&a.push(r?u.path:d.replace(/^\/+/g,"")))}}return o(n),a}class rw{get name(){return ny(this.path)}constructor(t,n){this.path=t,this.stats=n}get parentPath(){return this.path}isFile(){return r_e(this.stats)}isDirectory(){return Oc(this.stats)}isBlockDevice(){return ew(this.stats)}isCharacterDevice(){return tw(this.stats)}isSymbolicLink(){return ry(this.stats)}isFIFO(){return i_e(this.stats)}isSocket(){return s_e(this.stats)}}class zO{checkClosed(){if(this.closed)throw new Xe(yt.EBADF,"Can not use closed Dir")}constructor(t,n){this.path=t,this.context=n,this.closed=!1}close(t){if(this.closed=!0,!t)return Promise.resolve();t()}closeSync(){this.closed=!0}async _read(){var t,n;return this.checkClosed(),(t=this._entries)!==null&&t!==void 0||(this._entries=await Ym.call(this.context,this.path,{withFileTypes:!0})),this._entries.length&&(n=this._entries.shift())!==null&&n!==void 0?n:null}read(t){if(!t)return this._read();this._read().then(n=>t(void 0,n))}readSync(){var t,n;return this.checkClosed(),(t=this._entries)!==null&&t!==void 0||(this._entries=Uy.call(this.context,this.path,{withFileTypes:!0})),this._entries.length&&(n=this._entries.shift())!==null&&n!==void 0?n:null}async next(){const t=await this._read();return t?{done:!1,value:t}:(await this.close(),{done:!0,value:void 0})}[Symbol.asyncIterator](){return this}[Symbol.asyncDispose](){return Promise.resolve()}}var eM={exports:{}},tM={exports:{}},nM={},Y$;function Vh(){return Y$||(Y$=1,function(e){Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});var t={},n={};n.byteLength=u,n.toByteArray=h,n.fromByteArray=b;for(var r=[],s=[],i=typeof Uint8Array<"u"?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,l=a.length;o<l;++o)r[o]=a[o],s[a.charCodeAt(o)]=o;s[45]=62,s[95]=63;function c(w){var S=w.length;if(S%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var C=w.indexOf("=");C===-1&&(C=S);var k=C===S?0:4-C%4;return[C,k]}function u(w){var S=c(w),C=S[0],k=S[1];return(C+k)*3/4-k}function d(w,S,C){return(S+C)*3/4-C}function h(w){var S,C=c(w),k=C[0],A=C[1],R=new i(d(w,k,A)),N=0,I=A>0?k-4:k,P;for(P=0;P<I;P+=4)S=s[w.charCodeAt(P)]<<18|s[w.charCodeAt(P+1)]<<12|s[w.charCodeAt(P+2)]<<6|s[w.charCodeAt(P+3)],R[N++]=S>>16&255,R[N++]=S>>8&255,R[N++]=S&255;return A===2&&(S=s[w.charCodeAt(P)]<<2|s[w.charCodeAt(P+1)]>>4,R[N++]=S&255),A===1&&(S=s[w.charCodeAt(P)]<<10|s[w.charCodeAt(P+1)]<<4|s[w.charCodeAt(P+2)]>>2,R[N++]=S>>8&255,R[N++]=S&255),R}function m(w){return r[w>>18&63]+r[w>>12&63]+r[w>>6&63]+r[w&63]}function y(w,S,C){for(var k,A=[],R=S;R<C;R+=3)k=(w[R]<<16&16711680)+(w[R+1]<<8&65280)+(w[R+2]&255),A.push(m(k));return A.join("")}function b(w){for(var S,C=w.length,k=C%3,A=[],R=16383,N=0,I=C-k;N<I;N+=R)A.push(y(w,N,N+R>I?I:N+R));return k===1?(S=w[C-1],A.push(r[S>>2]+r[S<<4&63]+"==")):k===2&&(S=(w[C-2]<<8)+w[C-1],A.push(r[S>>10]+r[S>>4&63]+r[S<<2&63]+"=")),A.join("")}var v={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */v.read=function(w,S,C,k,A){var R,N,I=A*8-k-1,P=(1<<I)-1,L=P>>1,O=-7,V=C?A-1:0,D=C?-1:1,Z=w[S+V];for(V+=D,R=Z&(1<<-O)-1,Z>>=-O,O+=I;O>0;R=R*256+w[S+V],V+=D,O-=8);for(N=R&(1<<-O)-1,R>>=-O,O+=k;O>0;N=N*256+w[S+V],V+=D,O-=8);if(R===0)R=1-L;else{if(R===P)return N?NaN:(Z?-1:1)*(1/0);N=N+Math.pow(2,k),R=R-L}return(Z?-1:1)*N*Math.pow(2,R-k)},v.write=function(w,S,C,k,A,R){var N,I,P,L=R*8-A-1,O=(1<<L)-1,V=O>>1,D=A===23?Math.pow(2,-24)-Math.pow(2,-77):0,Z=k?0:R-1,U=k?1:-1,H=S<0||S===0&&1/S<0?1:0;for(S=Math.abs(S),isNaN(S)||S===1/0?(I=isNaN(S)?1:0,N=O):(N=Math.floor(Math.log(S)/Math.LN2),S*(P=Math.pow(2,-N))<1&&(N--,P*=2),N+V>=1?S+=D/P:S+=D*Math.pow(2,1-V),S*P>=2&&(N++,P/=2),N+V>=O?(I=0,N=O):N+V>=1?(I=(S*P-1)*Math.pow(2,A),N=N+V):(I=S*Math.pow(2,V-1)*Math.pow(2,A),N=0));A>=8;w[C+Z]=I&255,Z+=U,I/=256,A-=8);for(N=N<<A|I,L+=A;L>0;w[C+Z]=N&255,Z+=U,N/=256,L-=8);w[C+Z-U]|=H*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(w){const S=n,C=v,k=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;w.Buffer=O,w.SlowBuffer=se,w.INSPECT_MAX_BYTES=50;const A=2147483647;w.kMaxLength=A;const{Uint8Array:R,ArrayBuffer:N,SharedArrayBuffer:I}=globalThis;O.TYPED_ARRAY_SUPPORT=P(),!O.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function P(){try{const Y=new R(1),G={foo:function(){return 42}};return Object.setPrototypeOf(G,R.prototype),Object.setPrototypeOf(Y,G),Y.foo()===42}catch{return!1}}Object.defineProperty(O.prototype,"parent",{enumerable:!0,get:function(){if(O.isBuffer(this))return this.buffer}}),Object.defineProperty(O.prototype,"offset",{enumerable:!0,get:function(){if(O.isBuffer(this))return this.byteOffset}});function L(Y){if(Y>A)throw new RangeError('The value "'+Y+'" is invalid for option "size"');const G=new R(Y);return Object.setPrototypeOf(G,O.prototype),G}function O(Y,G,J){if(typeof Y=="number"){if(typeof G=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return U(Y)}return V(Y,G,J)}O.poolSize=8192;function V(Y,G,J){if(typeof Y=="string")return H(Y,G);if(N.isView(Y))return ne(Y);if(Y==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof Y);if(be(Y,N)||Y&&be(Y.buffer,N)||typeof I<"u"&&(be(Y,I)||Y&&be(Y.buffer,I)))return W(Y,G,J);if(typeof Y=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const ve=Y.valueOf&&Y.valueOf();if(ve!=null&&ve!==Y)return O.from(ve,G,J);const Oe=Q(Y);if(Oe)return Oe;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof Y[Symbol.toPrimitive]=="function")return O.from(Y[Symbol.toPrimitive]("string"),G,J);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof Y)}O.from=function(Y,G,J){return V(Y,G,J)},Object.setPrototypeOf(O.prototype,R.prototype),Object.setPrototypeOf(O,R);function D(Y){if(typeof Y!="number")throw new TypeError('"size" argument must be of type number');if(Y<0)throw new RangeError('The value "'+Y+'" is invalid for option "size"')}function Z(Y,G,J){return D(Y),Y<=0?L(Y):G!==void 0?typeof J=="string"?L(Y).fill(G,J):L(Y).fill(G):L(Y)}O.alloc=function(Y,G,J){return Z(Y,G,J)};function U(Y){return D(Y),L(Y<0?0:ee(Y)|0)}O.allocUnsafe=function(Y){return U(Y)},O.allocUnsafeSlow=function(Y){return U(Y)};function H(Y,G){if((typeof G!="string"||G==="")&&(G="utf8"),!O.isEncoding(G))throw new TypeError("Unknown encoding: "+G);const J=pe(Y,G)|0;let ve=L(J);const Oe=ve.write(Y,G);return Oe!==J&&(ve=ve.slice(0,Oe)),ve}function $(Y){const G=Y.length<0?0:ee(Y.length)|0,J=L(G);for(let ve=0;ve<G;ve+=1)J[ve]=Y[ve]&255;return J}function ne(Y){if(be(Y,R)){const G=new R(Y);return W(G.buffer,G.byteOffset,G.byteLength)}return $(Y)}function W(Y,G,J){if(G<0||Y.byteLength<G)throw new RangeError('"offset" is outside of buffer bounds');if(Y.byteLength<G+(J||0))throw new RangeError('"length" is outside of buffer bounds');let ve;return G===void 0&&J===void 0?ve=new R(Y):J===void 0?ve=new R(Y,G):ve=new R(Y,G,J),Object.setPrototypeOf(ve,O.prototype),ve}function Q(Y){if(O.isBuffer(Y)){const G=ee(Y.length)|0,J=L(G);return J.length===0||Y.copy(J,0,0,G),J}if(Y.length!==void 0)return typeof Y.length!="number"||_e(Y.length)?L(0):$(Y);if(Y.type==="Buffer"&&Array.isArray(Y.data))return $(Y.data)}function ee(Y){if(Y>=A)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+A.toString(16)+" bytes");return Y|0}function se(Y){return+Y!=Y&&(Y=0),O.alloc(+Y)}O.isBuffer=function(G){return G!=null&&G._isBuffer===!0&&G!==O.prototype},O.compare=function(G,J){if(be(G,R)&&(G=O.from(G,G.offset,G.byteLength)),be(J,R)&&(J=O.from(J,J.offset,J.byteLength)),!O.isBuffer(G)||!O.isBuffer(J))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(G===J)return 0;let ve=G.length,Oe=J.length;for(let Ge=0,_t=Math.min(ve,Oe);Ge<_t;++Ge)if(G[Ge]!==J[Ge]){ve=G[Ge],Oe=J[Ge];break}return ve<Oe?-1:Oe<ve?1:0},O.isEncoding=function(G){switch(String(G).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},O.concat=function(G,J){if(!Array.isArray(G))throw new TypeError('"list" argument must be an Array of Buffers');if(G.length===0)return O.alloc(0);let ve;if(J===void 0)for(J=0,ve=0;ve<G.length;++ve)J+=G[ve].length;const Oe=O.allocUnsafe(J);let Ge=0;for(ve=0;ve<G.length;++ve){let _t=G[ve];if(be(_t,R))Ge+_t.length>Oe.length?(O.isBuffer(_t)||(_t=O.from(_t)),_t.copy(Oe,Ge)):R.prototype.set.call(Oe,_t,Ge);else if(O.isBuffer(_t))_t.copy(Oe,Ge);else throw new TypeError('"list" argument must be an Array of Buffers');Ge+=_t.length}return Oe};function pe(Y,G){if(O.isBuffer(Y))return Y.length;if(N.isView(Y)||be(Y,N))return Y.byteLength;if(typeof Y!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof Y);const J=Y.length,ve=arguments.length>2&&arguments[2]===!0;if(!ve&&J===0)return 0;let Oe=!1;for(;;)switch(G){case"ascii":case"latin1":case"binary":return J;case"utf8":case"utf-8":return vt(Y).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return J*2;case"hex":return J>>>1;case"base64":return ze(Y).length;default:if(Oe)return ve?-1:vt(Y).length;G=(""+G).toLowerCase(),Oe=!0}}O.byteLength=pe;function ce(Y,G,J){let ve=!1;if((G===void 0||G<0)&&(G=0),G>this.length||((J===void 0||J>this.length)&&(J=this.length),J<=0)||(J>>>=0,G>>>=0,J<=G))return"";for(Y||(Y="utf8");;)switch(Y){case"hex":return Te(this,G,J);case"utf8":case"utf-8":return ge(this,G,J);case"ascii":return oe(this,G,J);case"latin1":case"binary":return re(this,G,J);case"base64":return K(this,G,J);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Be(this,G,J);default:if(ve)throw new TypeError("Unknown encoding: "+Y);Y=(Y+"").toLowerCase(),ve=!0}}O.prototype._isBuffer=!0;function Ie(Y,G,J){const ve=Y[G];Y[G]=Y[J],Y[J]=ve}O.prototype.swap16=function(){const G=this.length;if(G%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let J=0;J<G;J+=2)Ie(this,J,J+1);return this},O.prototype.swap32=function(){const G=this.length;if(G%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let J=0;J<G;J+=4)Ie(this,J,J+3),Ie(this,J+1,J+2);return this},O.prototype.swap64=function(){const G=this.length;if(G%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let J=0;J<G;J+=8)Ie(this,J,J+7),Ie(this,J+1,J+6),Ie(this,J+2,J+5),Ie(this,J+3,J+4);return this},O.prototype.toString=function(){const G=this.length;return G===0?"":arguments.length===0?ge(this,0,G):ce.apply(this,arguments)},O.prototype.toLocaleString=O.prototype.toString,O.prototype.equals=function(G){if(!O.isBuffer(G))throw new TypeError("Argument must be a Buffer");return this===G?!0:O.compare(this,G)===0},O.prototype.inspect=function(){let G="";const J=w.INSPECT_MAX_BYTES;return G=this.toString("hex",0,J).replace(/(.{2})/g,"$1 ").trim(),this.length>J&&(G+=" ... "),"<Buffer "+G+">"},k&&(O.prototype[k]=O.prototype.inspect),O.prototype.compare=function(G,J,ve,Oe,Ge){if(be(G,R)&&(G=O.from(G,G.offset,G.byteLength)),!O.isBuffer(G))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof G);if(J===void 0&&(J=0),ve===void 0&&(ve=G?G.length:0),Oe===void 0&&(Oe=0),Ge===void 0&&(Ge=this.length),J<0||ve>G.length||Oe<0||Ge>this.length)throw new RangeError("out of range index");if(Oe>=Ge&&J>=ve)return 0;if(Oe>=Ge)return-1;if(J>=ve)return 1;if(J>>>=0,ve>>>=0,Oe>>>=0,Ge>>>=0,this===G)return 0;let _t=Ge-Oe,tn=ve-J;const Un=Math.min(_t,tn),Xt=this.slice(Oe,Ge),nn=G.slice(J,ve);for(let un=0;un<Un;++un)if(Xt[un]!==nn[un]){_t=Xt[un],tn=nn[un];break}return _t<tn?-1:tn<_t?1:0};function De(Y,G,J,ve,Oe){if(Y.length===0)return-1;if(typeof J=="string"?(ve=J,J=0):J>2147483647?J=2147483647:J<-2147483648&&(J=-2147483648),J=+J,_e(J)&&(J=Oe?0:Y.length-1),J<0&&(J=Y.length+J),J>=Y.length){if(Oe)return-1;J=Y.length-1}else if(J<0)if(Oe)J=0;else return-1;if(typeof G=="string"&&(G=O.from(G,ve)),O.isBuffer(G))return G.length===0?-1:Se(Y,G,J,ve,Oe);if(typeof G=="number")return G=G&255,typeof R.prototype.indexOf=="function"?Oe?R.prototype.indexOf.call(Y,G,J):R.prototype.lastIndexOf.call(Y,G,J):Se(Y,[G],J,ve,Oe);throw new TypeError("val must be string, number or Buffer")}function Se(Y,G,J,ve,Oe){let Ge=1,_t=Y.length,tn=G.length;if(ve!==void 0&&(ve=String(ve).toLowerCase(),ve==="ucs2"||ve==="ucs-2"||ve==="utf16le"||ve==="utf-16le")){if(Y.length<2||G.length<2)return-1;Ge=2,_t/=2,tn/=2,J/=2}function Un(nn,un){return Ge===1?nn[un]:nn.readUInt16BE(un*Ge)}let Xt;if(Oe){let nn=-1;for(Xt=J;Xt<_t;Xt++)if(Un(Y,Xt)===Un(G,nn===-1?0:Xt-nn)){if(nn===-1&&(nn=Xt),Xt-nn+1===tn)return nn*Ge}else nn!==-1&&(Xt-=Xt-nn),nn=-1}else for(J+tn>_t&&(J=_t-tn),Xt=J;Xt>=0;Xt--){let nn=!0;for(let un=0;un<tn;un++)if(Un(Y,Xt+un)!==Un(G,un)){nn=!1;break}if(nn)return Xt}return-1}O.prototype.includes=function(G,J,ve){return this.indexOf(G,J,ve)!==-1},O.prototype.indexOf=function(G,J,ve){return De(this,G,J,ve,!0)},O.prototype.lastIndexOf=function(G,J,ve){return De(this,G,J,ve,!1)};function Ce(Y,G,J,ve){J=Number(J)||0;const Oe=Y.length-J;ve?(ve=Number(ve),ve>Oe&&(ve=Oe)):ve=Oe;const Ge=G.length;ve>Ge/2&&(ve=Ge/2);let _t;for(_t=0;_t<ve;++_t){const tn=parseInt(G.substr(_t*2,2),16);if(_e(tn))return _t;Y[J+_t]=tn}return _t}function qe(Y,G,J,ve){return st(vt(G,Y.length-J),Y,J,ve)}function Qe(Y,G,J,ve){return st(ot(G),Y,J,ve)}function Ve(Y,G,J,ve){return st(ze(G),Y,J,ve)}function Ne(Y,G,J,ve){return st(B(G,Y.length-J),Y,J,ve)}O.prototype.write=function(G,J,ve,Oe){if(J===void 0)Oe="utf8",ve=this.length,J=0;else if(ve===void 0&&typeof J=="string")Oe=J,ve=this.length,J=0;else if(isFinite(J))J=J>>>0,isFinite(ve)?(ve=ve>>>0,Oe===void 0&&(Oe="utf8")):(Oe=ve,ve=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const Ge=this.length-J;if((ve===void 0||ve>Ge)&&(ve=Ge),G.length>0&&(ve<0||J<0)||J>this.length)throw new RangeError("Attempt to write outside buffer bounds");Oe||(Oe="utf8");let _t=!1;for(;;)switch(Oe){case"hex":return Ce(this,G,J,ve);case"utf8":case"utf-8":return qe(this,G,J,ve);case"ascii":case"latin1":case"binary":return Qe(this,G,J,ve);case"base64":return Ve(this,G,J,ve);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Ne(this,G,J,ve);default:if(_t)throw new TypeError("Unknown encoding: "+Oe);Oe=(""+Oe).toLowerCase(),_t=!0}},O.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function K(Y,G,J){return G===0&&J===Y.length?S.fromByteArray(Y):S.fromByteArray(Y.slice(G,J))}function ge(Y,G,J){J=Math.min(Y.length,J);const ve=[];let Oe=G;for(;Oe<J;){const Ge=Y[Oe];let _t=null,tn=Ge>239?4:Ge>223?3:Ge>191?2:1;if(Oe+tn<=J){let Un,Xt,nn,un;switch(tn){case 1:Ge<128&&(_t=Ge);break;case 2:Un=Y[Oe+1],(Un&192)===128&&(un=(Ge&31)<<6|Un&63,un>127&&(_t=un));break;case 3:Un=Y[Oe+1],Xt=Y[Oe+2],(Un&192)===128&&(Xt&192)===128&&(un=(Ge&15)<<12|(Un&63)<<6|Xt&63,un>2047&&(un<55296||un>57343)&&(_t=un));break;case 4:Un=Y[Oe+1],Xt=Y[Oe+2],nn=Y[Oe+3],(Un&192)===128&&(Xt&192)===128&&(nn&192)===128&&(un=(Ge&15)<<18|(Un&63)<<12|(Xt&63)<<6|nn&63,un>65535&&un<1114112&&(_t=un))}}_t===null?(_t=65533,tn=1):_t>65535&&(_t-=65536,ve.push(_t>>>10&1023|55296),_t=56320|_t&1023),ve.push(_t),Oe+=tn}return le(ve)}const Ae=4096;function le(Y){const G=Y.length;if(G<=Ae)return String.fromCharCode.apply(String,Y);let J="",ve=0;for(;ve<G;)J+=String.fromCharCode.apply(String,Y.slice(ve,ve+=Ae));return J}function oe(Y,G,J){let ve="";J=Math.min(Y.length,J);for(let Oe=G;Oe<J;++Oe)ve+=String.fromCharCode(Y[Oe]&127);return ve}function re(Y,G,J){let ve="";J=Math.min(Y.length,J);for(let Oe=G;Oe<J;++Oe)ve+=String.fromCharCode(Y[Oe]);return ve}function Te(Y,G,J){const ve=Y.length;(!G||G<0)&&(G=0),(!J||J<0||J>ve)&&(J=ve);let Oe="";for(let Ge=G;Ge<J;++Ge)Oe+=Ue[Y[Ge]];return Oe}function Be(Y,G,J){const ve=Y.slice(G,J);let Oe="";for(let Ge=0;Ge<ve.length-1;Ge+=2)Oe+=String.fromCharCode(ve[Ge]+ve[Ge+1]*256);return Oe}O.prototype.slice=function(G,J){const ve=this.length;G=~~G,J=J===void 0?ve:~~J,G<0?(G+=ve,G<0&&(G=0)):G>ve&&(G=ve),J<0?(J+=ve,J<0&&(J=0)):J>ve&&(J=ve),J<G&&(J=G);const Oe=this.subarray(G,J);return Object.setPrototypeOf(Oe,O.prototype),Oe};function ke(Y,G,J){if(Y%1!==0||Y<0)throw new RangeError("offset is not uint");if(Y+G>J)throw new RangeError("Trying to access beyond buffer length")}O.prototype.readUintLE=O.prototype.readUIntLE=function(G,J,ve){G=G>>>0,J=J>>>0,ve||ke(G,J,this.length);let Oe=this[G],Ge=1,_t=0;for(;++_t<J&&(Ge*=256);)Oe+=this[G+_t]*Ge;return Oe},O.prototype.readUintBE=O.prototype.readUIntBE=function(G,J,ve){G=G>>>0,J=J>>>0,ve||ke(G,J,this.length);let Oe=this[G+--J],Ge=1;for(;J>0&&(Ge*=256);)Oe+=this[G+--J]*Ge;return Oe},O.prototype.readUint8=O.prototype.readUInt8=function(G,J){return G=G>>>0,J||ke(G,1,this.length),this[G]},O.prototype.readUint16LE=O.prototype.readUInt16LE=function(G,J){return G=G>>>0,J||ke(G,2,this.length),this[G]|this[G+1]<<8},O.prototype.readUint16BE=O.prototype.readUInt16BE=function(G,J){return G=G>>>0,J||ke(G,2,this.length),this[G]<<8|this[G+1]},O.prototype.readUint32LE=O.prototype.readUInt32LE=function(G,J){return G=G>>>0,J||ke(G,4,this.length),(this[G]|this[G+1]<<8|this[G+2]<<16)+this[G+3]*16777216},O.prototype.readUint32BE=O.prototype.readUInt32BE=function(G,J){return G=G>>>0,J||ke(G,4,this.length),this[G]*16777216+(this[G+1]<<16|this[G+2]<<8|this[G+3])},O.prototype.readBigUInt64LE=kt(function(G){G=G>>>0,Fe(G,"offset");const J=this[G],ve=this[G+7];(J===void 0||ve===void 0)&&we(G,this.length-8);const Oe=J+this[++G]*2**8+this[++G]*2**16+this[++G]*2**24,Ge=this[++G]+this[++G]*2**8+this[++G]*2**16+ve*2**24;return BigInt(Oe)+(BigInt(Ge)<<BigInt(32))}),O.prototype.readBigUInt64BE=kt(function(G){G=G>>>0,Fe(G,"offset");const J=this[G],ve=this[G+7];(J===void 0||ve===void 0)&&we(G,this.length-8);const Oe=J*2**24+this[++G]*2**16+this[++G]*2**8+this[++G],Ge=this[++G]*2**24+this[++G]*2**16+this[++G]*2**8+ve;return(BigInt(Oe)<<BigInt(32))+BigInt(Ge)}),O.prototype.readIntLE=function(G,J,ve){G=G>>>0,J=J>>>0,ve||ke(G,J,this.length);let Oe=this[G],Ge=1,_t=0;for(;++_t<J&&(Ge*=256);)Oe+=this[G+_t]*Ge;return Ge*=128,Oe>=Ge&&(Oe-=Math.pow(2,8*J)),Oe},O.prototype.readIntBE=function(G,J,ve){G=G>>>0,J=J>>>0,ve||ke(G,J,this.length);let Oe=J,Ge=1,_t=this[G+--Oe];for(;Oe>0&&(Ge*=256);)_t+=this[G+--Oe]*Ge;return Ge*=128,_t>=Ge&&(_t-=Math.pow(2,8*J)),_t},O.prototype.readInt8=function(G,J){return G=G>>>0,J||ke(G,1,this.length),this[G]&128?(255-this[G]+1)*-1:this[G]},O.prototype.readInt16LE=function(G,J){G=G>>>0,J||ke(G,2,this.length);const ve=this[G]|this[G+1]<<8;return ve&32768?ve|4294901760:ve},O.prototype.readInt16BE=function(G,J){G=G>>>0,J||ke(G,2,this.length);const ve=this[G+1]|this[G]<<8;return ve&32768?ve|4294901760:ve},O.prototype.readInt32LE=function(G,J){return G=G>>>0,J||ke(G,4,this.length),this[G]|this[G+1]<<8|this[G+2]<<16|this[G+3]<<24},O.prototype.readInt32BE=function(G,J){return G=G>>>0,J||ke(G,4,this.length),this[G]<<24|this[G+1]<<16|this[G+2]<<8|this[G+3]},O.prototype.readBigInt64LE=kt(function(G){G=G>>>0,Fe(G,"offset");const J=this[G],ve=this[G+7];(J===void 0||ve===void 0)&&we(G,this.length-8);const Oe=this[G+4]+this[G+5]*2**8+this[G+6]*2**16+(ve<<24);return(BigInt(Oe)<<BigInt(32))+BigInt(J+this[++G]*2**8+this[++G]*2**16+this[++G]*2**24)}),O.prototype.readBigInt64BE=kt(function(G){G=G>>>0,Fe(G,"offset");const J=this[G],ve=this[G+7];(J===void 0||ve===void 0)&&we(G,this.length-8);const Oe=(J<<24)+this[++G]*2**16+this[++G]*2**8+this[++G];return(BigInt(Oe)<<BigInt(32))+BigInt(this[++G]*2**24+this[++G]*2**16+this[++G]*2**8+ve)}),O.prototype.readFloatLE=function(G,J){return G=G>>>0,J||ke(G,4,this.length),C.read(this,G,!0,23,4)},O.prototype.readFloatBE=function(G,J){return G=G>>>0,J||ke(G,4,this.length),C.read(this,G,!1,23,4)},O.prototype.readDoubleLE=function(G,J){return G=G>>>0,J||ke(G,8,this.length),C.read(this,G,!0,52,8)},O.prototype.readDoubleBE=function(G,J){return G=G>>>0,J||ke(G,8,this.length),C.read(this,G,!1,52,8)};function lt(Y,G,J,ve,Oe,Ge){if(!O.isBuffer(Y))throw new TypeError('"buffer" argument must be a Buffer instance');if(G>Oe||G<Ge)throw new RangeError('"value" argument is out of bounds');if(J+ve>Y.length)throw new RangeError("Index out of range")}O.prototype.writeUintLE=O.prototype.writeUIntLE=function(G,J,ve,Oe){if(G=+G,J=J>>>0,ve=ve>>>0,!Oe){const tn=Math.pow(2,8*ve)-1;lt(this,G,J,ve,tn,0)}let Ge=1,_t=0;for(this[J]=G&255;++_t<ve&&(Ge*=256);)this[J+_t]=G/Ge&255;return J+ve},O.prototype.writeUintBE=O.prototype.writeUIntBE=function(G,J,ve,Oe){if(G=+G,J=J>>>0,ve=ve>>>0,!Oe){const tn=Math.pow(2,8*ve)-1;lt(this,G,J,ve,tn,0)}let Ge=ve-1,_t=1;for(this[J+Ge]=G&255;--Ge>=0&&(_t*=256);)this[J+Ge]=G/_t&255;return J+ve},O.prototype.writeUint8=O.prototype.writeUInt8=function(G,J,ve){return G=+G,J=J>>>0,ve||lt(this,G,J,1,255,0),this[J]=G&255,J+1},O.prototype.writeUint16LE=O.prototype.writeUInt16LE=function(G,J,ve){return G=+G,J=J>>>0,ve||lt(this,G,J,2,65535,0),this[J]=G&255,this[J+1]=G>>>8,J+2},O.prototype.writeUint16BE=O.prototype.writeUInt16BE=function(G,J,ve){return G=+G,J=J>>>0,ve||lt(this,G,J,2,65535,0),this[J]=G>>>8,this[J+1]=G&255,J+2},O.prototype.writeUint32LE=O.prototype.writeUInt32LE=function(G,J,ve){return G=+G,J=J>>>0,ve||lt(this,G,J,4,4294967295,0),this[J+3]=G>>>24,this[J+2]=G>>>16,this[J+1]=G>>>8,this[J]=G&255,J+4},O.prototype.writeUint32BE=O.prototype.writeUInt32BE=function(G,J,ve){return G=+G,J=J>>>0,ve||lt(this,G,J,4,4294967295,0),this[J]=G>>>24,this[J+1]=G>>>16,this[J+2]=G>>>8,this[J+3]=G&255,J+4};function Rt(Y,G,J,ve,Oe){ye(G,ve,Oe,Y,J,7);let Ge=Number(G&BigInt(4294967295));Y[J++]=Ge,Ge=Ge>>8,Y[J++]=Ge,Ge=Ge>>8,Y[J++]=Ge,Ge=Ge>>8,Y[J++]=Ge;let _t=Number(G>>BigInt(32)&BigInt(4294967295));return Y[J++]=_t,_t=_t>>8,Y[J++]=_t,_t=_t>>8,Y[J++]=_t,_t=_t>>8,Y[J++]=_t,J}function ht(Y,G,J,ve,Oe){ye(G,ve,Oe,Y,J,7);let Ge=Number(G&BigInt(4294967295));Y[J+7]=Ge,Ge=Ge>>8,Y[J+6]=Ge,Ge=Ge>>8,Y[J+5]=Ge,Ge=Ge>>8,Y[J+4]=Ge;let _t=Number(G>>BigInt(32)&BigInt(4294967295));return Y[J+3]=_t,_t=_t>>8,Y[J+2]=_t,_t=_t>>8,Y[J+1]=_t,_t=_t>>8,Y[J]=_t,J+8}O.prototype.writeBigUInt64LE=kt(function(G,J=0){return Rt(this,G,J,BigInt(0),BigInt("0xffffffffffffffff"))}),O.prototype.writeBigUInt64BE=kt(function(G,J=0){return ht(this,G,J,BigInt(0),BigInt("0xffffffffffffffff"))}),O.prototype.writeIntLE=function(G,J,ve,Oe){if(G=+G,J=J>>>0,!Oe){const Un=Math.pow(2,8*ve-1);lt(this,G,J,ve,Un-1,-Un)}let Ge=0,_t=1,tn=0;for(this[J]=G&255;++Ge<ve&&(_t*=256);)G<0&&tn===0&&this[J+Ge-1]!==0&&(tn=1),this[J+Ge]=(G/_t>>0)-tn&255;return J+ve},O.prototype.writeIntBE=function(G,J,ve,Oe){if(G=+G,J=J>>>0,!Oe){const Un=Math.pow(2,8*ve-1);lt(this,G,J,ve,Un-1,-Un)}let Ge=ve-1,_t=1,tn=0;for(this[J+Ge]=G&255;--Ge>=0&&(_t*=256);)G<0&&tn===0&&this[J+Ge+1]!==0&&(tn=1),this[J+Ge]=(G/_t>>0)-tn&255;return J+ve},O.prototype.writeInt8=function(G,J,ve){return G=+G,J=J>>>0,ve||lt(this,G,J,1,127,-128),G<0&&(G=255+G+1),this[J]=G&255,J+1},O.prototype.writeInt16LE=function(G,J,ve){return G=+G,J=J>>>0,ve||lt(this,G,J,2,32767,-32768),this[J]=G&255,this[J+1]=G>>>8,J+2},O.prototype.writeInt16BE=function(G,J,ve){return G=+G,J=J>>>0,ve||lt(this,G,J,2,32767,-32768),this[J]=G>>>8,this[J+1]=G&255,J+2},O.prototype.writeInt32LE=function(G,J,ve){return G=+G,J=J>>>0,ve||lt(this,G,J,4,2147483647,-2147483648),this[J]=G&255,this[J+1]=G>>>8,this[J+2]=G>>>16,this[J+3]=G>>>24,J+4},O.prototype.writeInt32BE=function(G,J,ve){return G=+G,J=J>>>0,ve||lt(this,G,J,4,2147483647,-2147483648),G<0&&(G=4294967295+G+1),this[J]=G>>>24,this[J+1]=G>>>16,this[J+2]=G>>>8,this[J+3]=G&255,J+4},O.prototype.writeBigInt64LE=kt(function(G,J=0){return Rt(this,G,J,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),O.prototype.writeBigInt64BE=kt(function(G,J=0){return ht(this,G,J,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function Pt(Y,G,J,ve,Oe,Ge){if(J+ve>Y.length)throw new RangeError("Index out of range");if(J<0)throw new RangeError("Index out of range")}function qt(Y,G,J,ve,Oe){return G=+G,J=J>>>0,Oe||Pt(Y,G,J,4),C.write(Y,G,J,ve,23,4),J+4}O.prototype.writeFloatLE=function(G,J,ve){return qt(this,G,J,!0,ve)},O.prototype.writeFloatBE=function(G,J,ve){return qt(this,G,J,!1,ve)};function Lt(Y,G,J,ve,Oe){return G=+G,J=J>>>0,Oe||Pt(Y,G,J,8),C.write(Y,G,J,ve,52,8),J+8}O.prototype.writeDoubleLE=function(G,J,ve){return Lt(this,G,J,!0,ve)},O.prototype.writeDoubleBE=function(G,J,ve){return Lt(this,G,J,!1,ve)},O.prototype.copy=function(G,J,ve,Oe){if(!O.isBuffer(G))throw new TypeError("argument should be a Buffer");if(ve||(ve=0),!Oe&&Oe!==0&&(Oe=this.length),J>=G.length&&(J=G.length),J||(J=0),Oe>0&&Oe<ve&&(Oe=ve),Oe===ve||G.length===0||this.length===0)return 0;if(J<0)throw new RangeError("targetStart out of bounds");if(ve<0||ve>=this.length)throw new RangeError("Index out of range");if(Oe<0)throw new RangeError("sourceEnd out of bounds");Oe>this.length&&(Oe=this.length),G.length-J<Oe-ve&&(Oe=G.length-J+ve);const Ge=Oe-ve;return this===G&&typeof R.prototype.copyWithin=="function"?this.copyWithin(J,ve,Oe):R.prototype.set.call(G,this.subarray(ve,Oe),J),Ge},O.prototype.fill=function(G,J,ve,Oe){if(typeof G=="string"){if(typeof J=="string"?(Oe=J,J=0,ve=this.length):typeof ve=="string"&&(Oe=ve,ve=this.length),Oe!==void 0&&typeof Oe!="string")throw new TypeError("encoding must be a string");if(typeof Oe=="string"&&!O.isEncoding(Oe))throw new TypeError("Unknown encoding: "+Oe);if(G.length===1){const _t=G.charCodeAt(0);(Oe==="utf8"&&_t<128||Oe==="latin1")&&(G=_t)}}else typeof G=="number"?G=G&255:typeof G=="boolean"&&(G=Number(G));if(J<0||this.length<J||this.length<ve)throw new RangeError("Out of range index");if(ve<=J)return this;J=J>>>0,ve=ve===void 0?this.length:ve>>>0,G||(G=0);let Ge;if(typeof G=="number")for(Ge=J;Ge<ve;++Ge)this[Ge]=G;else{const _t=O.isBuffer(G)?G:O.from(G,Oe),tn=_t.length;if(tn===0)throw new TypeError('The value "'+G+'" is invalid for argument "value"');for(Ge=0;Ge<ve-J;++Ge)this[Ge+J]=_t[Ge%tn]}return this};const en={};function xe(Y,G,J){en[Y]=class extends J{constructor(){super(),Object.defineProperty(this,"message",{value:G.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${Y}]`,this.stack,delete this.name}get code(){return Y}set code(Oe){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:Oe,writable:!0})}toString(){return`${this.name} [${Y}]: ${this.message}`}}}xe("ERR_BUFFER_OUT_OF_BOUNDS",function(Y){return Y?`${Y} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),xe("ERR_INVALID_ARG_TYPE",function(Y,G){return`The "${Y}" argument must be of type number. Received type ${typeof G}`},TypeError),xe("ERR_OUT_OF_RANGE",function(Y,G,J){let ve=`The value of "${Y}" is out of range.`,Oe=J;return Number.isInteger(J)&&Math.abs(J)>2**32?Oe=F(String(J)):typeof J=="bigint"&&(Oe=String(J),(J>BigInt(2)**BigInt(32)||J<-(BigInt(2)**BigInt(32)))&&(Oe=F(Oe)),Oe+="n"),ve+=` It must be ${G}. Received ${Oe}`,ve},RangeError);function F(Y){let G="",J=Y.length;const ve=Y[0]==="-"?1:0;for(;J>=ve+4;J-=3)G=`_${Y.slice(J-3,J)}${G}`;return`${Y.slice(0,J)}${G}`}function X(Y,G,J){Fe(G,"offset"),(Y[G]===void 0||Y[G+J]===void 0)&&we(G,Y.length-(J+1))}function ye(Y,G,J,ve,Oe,Ge){if(Y>J||Y<G){const _t=typeof G=="bigint"?"n":"";let tn;throw G===0||G===BigInt(0)?tn=`>= 0${_t} and < 2${_t} ** ${(Ge+1)*8}${_t}`:tn=`>= -(2${_t} ** ${(Ge+1)*8-1}${_t}) and < 2 ** ${(Ge+1)*8-1}${_t}`,new en.ERR_OUT_OF_RANGE("value",tn,Y)}X(ve,Oe,Ge)}function Fe(Y,G){if(typeof Y!="number")throw new en.ERR_INVALID_ARG_TYPE(G,"number",Y)}function we(Y,G,J){throw Math.floor(Y)!==Y?(Fe(Y,J),new en.ERR_OUT_OF_RANGE("offset","an integer",Y)):G<0?new en.ERR_BUFFER_OUT_OF_BOUNDS:new en.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${G}`,Y)}const Me=/[^+/0-9A-Za-z-_]/g;function de(Y){if(Y=Y.split("=")[0],Y=Y.trim().replace(Me,""),Y.length<2)return"";for(;Y.length%4!==0;)Y=Y+"=";return Y}function vt(Y,G){G=G||1/0;let J;const ve=Y.length;let Oe=null;const Ge=[];for(let _t=0;_t<ve;++_t){if(J=Y.charCodeAt(_t),J>55295&&J<57344){if(!Oe){if(J>56319){(G-=3)>-1&&Ge.push(239,191,189);continue}else if(_t+1===ve){(G-=3)>-1&&Ge.push(239,191,189);continue}Oe=J;continue}if(J<56320){(G-=3)>-1&&Ge.push(239,191,189),Oe=J;continue}J=(Oe-55296<<10|J-56320)+65536}else Oe&&(G-=3)>-1&&Ge.push(239,191,189);if(Oe=null,J<128){if((G-=1)<0)break;Ge.push(J)}else if(J<2048){if((G-=2)<0)break;Ge.push(J>>6|192,J&63|128)}else if(J<65536){if((G-=3)<0)break;Ge.push(J>>12|224,J>>6&63|128,J&63|128)}else if(J<1114112){if((G-=4)<0)break;Ge.push(J>>18|240,J>>12&63|128,J>>6&63|128,J&63|128)}else throw new Error("Invalid code point")}return Ge}function ot(Y){const G=[];for(let J=0;J<Y.length;++J)G.push(Y.charCodeAt(J)&255);return G}function B(Y,G){let J,ve,Oe;const Ge=[];for(let _t=0;_t<Y.length&&!((G-=2)<0);++_t)J=Y.charCodeAt(_t),ve=J>>8,Oe=J%256,Ge.push(Oe),Ge.push(ve);return Ge}function ze(Y){return S.toByteArray(de(Y))}function st(Y,G,J,ve){let Oe;for(Oe=0;Oe<ve&&!(Oe+J>=G.length||Oe>=Y.length);++Oe)G[Oe+J]=Y[Oe];return Oe}function be(Y,G){return Y instanceof G||Y!=null&&Y.constructor!=null&&Y.constructor.name!=null&&Y.constructor.name===G.name}function _e(Y){return Y!==Y}const Ue=function(){const Y="0123456789abcdef",G=new Array(256);for(let J=0;J<16;++J){const ve=J*16;for(let Oe=0;Oe<16;++Oe)G[ve+Oe]=Y[J]+Y[Oe]}return G}();function kt(Y){return typeof BigInt>"u"?fe:Y}function fe(){throw new Error("BigInt not supported")}})(t);const x=t.Buffer;e.Blob=t.Blob,e.BlobOptions=t.BlobOptions,e.Buffer=t.Buffer,e.File=t.File,e.FileOptions=t.FileOptions,e.INSPECT_MAX_BYTES=t.INSPECT_MAX_BYTES,e.SlowBuffer=t.SlowBuffer,e.TranscodeEncoding=t.TranscodeEncoding,e.atob=t.atob,e.btoa=t.btoa,e.constants=t.constants,e.default=x,e.isAscii=t.isAscii,e.isUtf8=t.isUtf8,e.kMaxLength=t.kMaxLength,e.kStringMaxLength=t.kStringMaxLength,e.resolveObjectURL=t.resolveObjectURL,e.transcode=t.transcode}(nM)),nM}var rM,Z$;function ei(){if(Z$)return rM;Z$=1;class e extends Error{constructor(n){if(!Array.isArray(n))throw new TypeError(`Expected input to be an Array, got ${typeof n}`);let r="";for(let s=0;s<n.length;s++)r+=`    ${n[s].stack}
`;super(r),this.name="AggregateError",this.errors=n}}return rM={AggregateError:e,ArrayIsArray(t){return Array.isArray(t)},ArrayPrototypeIncludes(t,n){return t.includes(n)},ArrayPrototypeIndexOf(t,n){return t.indexOf(n)},ArrayPrototypeJoin(t,n){return t.join(n)},ArrayPrototypeMap(t,n){return t.map(n)},ArrayPrototypePop(t,n){return t.pop(n)},ArrayPrototypePush(t,n){return t.push(n)},ArrayPrototypeSlice(t,n,r){return t.slice(n,r)},Error,FunctionPrototypeCall(t,n,...r){return t.call(n,...r)},FunctionPrototypeSymbolHasInstance(t,n){return Function.prototype[Symbol.hasInstance].call(t,n)},MathFloor:Math.floor,Number,NumberIsInteger:Number.isInteger,NumberIsNaN:Number.isNaN,NumberMAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER,NumberMIN_SAFE_INTEGER:Number.MIN_SAFE_INTEGER,NumberParseInt:Number.parseInt,ObjectDefineProperties(t,n){return Object.defineProperties(t,n)},ObjectDefineProperty(t,n,r){return Object.defineProperty(t,n,r)},ObjectGetOwnPropertyDescriptor(t,n){return Object.getOwnPropertyDescriptor(t,n)},ObjectKeys(t){return Object.keys(t)},ObjectSetPrototypeOf(t,n){return Object.setPrototypeOf(t,n)},Promise,PromisePrototypeCatch(t,n){return t.catch(n)},PromisePrototypeThen(t,n,r){return t.then(n,r)},PromiseReject(t){return Promise.reject(t)},PromiseResolve(t){return Promise.resolve(t)},ReflectApply:Reflect.apply,RegExpPrototypeTest(t,n){return t.test(n)},SafeSet:Set,String,StringPrototypeSlice(t,n,r){return t.slice(n,r)},StringPrototypeToLowerCase(t){return t.toLowerCase()},StringPrototypeToUpperCase(t){return t.toUpperCase()},StringPrototypeTrim(t){return t.trim()},Symbol,SymbolFor:Symbol.for,SymbolAsyncIterator:Symbol.asyncIterator,SymbolHasInstance:Symbol.hasInstance,SymbolIterator:Symbol.iterator,SymbolDispose:Symbol.dispose||Symbol("Symbol.dispose"),SymbolAsyncDispose:Symbol.asyncDispose||Symbol("Symbol.asyncDispose"),TypedArrayPrototypeSet(t,n,r){return t.set(n,r)},Boolean,Uint8Array},rM}var sM={exports:{}},iM,X$;function KK(){return X$||(X$=1,iM={format(e,...t){return e.replace(/%([sdifj])/g,function(...[n,r]){const s=t.shift();return r==="f"?s.toFixed(6):r==="j"?JSON.stringify(s):r==="s"&&typeof s=="object"?`${s.constructor!==Object?s.constructor.name:""} {}`.trim():s.toString()})},inspect(e){switch(typeof e){case"string":if(e.includes("'"))if(e.includes('"')){if(!e.includes("`")&&!e.includes("${"))return`\`${e}\``}else return`"${e}"`;return`'${e}'`;case"number":return isNaN(e)?"NaN":Object.is(e,-0)?String(e):e;case"bigint":return`${String(e)}n`;case"boolean":case"undefined":return String(e);case"object":return"{}"}}}),iM}var aM,J$;function co(){if(J$)return aM;J$=1;const{format:e,inspect:t}=KK(),{AggregateError:n}=ei(),r=globalThis.AggregateError||n,s=Symbol("kIsNodeError"),i=["string","function","number","object","Function","Object","boolean","bigint","symbol"],a=/^([A-Z][a-z0-9]*)+$/,o="__node_internal_",l={};function c(v,x){if(!v)throw new l.ERR_INTERNAL_ASSERTION(x)}function u(v){let x="",w=v.length;const S=v[0]==="-"?1:0;for(;w>=S+4;w-=3)x=`_${v.slice(w-3,w)}${x}`;return`${v.slice(0,w)}${x}`}function d(v,x,w){if(typeof x=="function")return c(x.length<=w.length,`Code: ${v}; The provided arguments length (${w.length}) does not match the required ones (${x.length}).`),x(...w);const S=(x.match(/%[dfijoOs]/g)||[]).length;return c(S===w.length,`Code: ${v}; The provided arguments length (${w.length}) does not match the required ones (${S}).`),w.length===0?x:e(x,...w)}function h(v,x,w){w||(w=Error);class S extends w{constructor(...k){super(d(v,x,k))}toString(){return`${this.name} [${v}]: ${this.message}`}}Object.defineProperties(S.prototype,{name:{value:w.name,writable:!0,enumerable:!1,configurable:!0},toString:{value(){return`${this.name} [${v}]: ${this.message}`},writable:!0,enumerable:!1,configurable:!0}}),S.prototype.code=v,S.prototype[s]=!0,l[v]=S}function m(v){const x=o+v.name;return Object.defineProperty(v,"name",{value:x}),v}function y(v,x){if(v&&x&&v!==x){if(Array.isArray(x.errors))return x.errors.push(v),x;const w=new r([x,v],x.message);return w.code=x.code,w}return v||x}class b extends Error{constructor(x="The operation was aborted",w=void 0){if(w!==void 0&&typeof w!="object")throw new l.ERR_INVALID_ARG_TYPE("options","Object",w);super(x,w),this.code="ABORT_ERR",this.name="AbortError"}}return h("ERR_ASSERTION","%s",Error),h("ERR_INVALID_ARG_TYPE",(v,x,w)=>{c(typeof v=="string","'name' must be a string"),Array.isArray(x)||(x=[x]);let S="The ";v.endsWith(" argument")?S+=`${v} `:S+=`"${v}" ${v.includes(".")?"property":"argument"} `,S+="must be ";const C=[],k=[],A=[];for(const N of x)c(typeof N=="string","All expected entries have to be of type string"),i.includes(N)?C.push(N.toLowerCase()):a.test(N)?k.push(N):(c(N!=="object",'The value "object" should be written as "Object"'),A.push(N));if(k.length>0){const N=C.indexOf("object");N!==-1&&(C.splice(C,N,1),k.push("Object"))}if(C.length>0){switch(C.length){case 1:S+=`of type ${C[0]}`;break;case 2:S+=`one of type ${C[0]} or ${C[1]}`;break;default:{const N=C.pop();S+=`one of type ${C.join(", ")}, or ${N}`}}(k.length>0||A.length>0)&&(S+=" or ")}if(k.length>0){switch(k.length){case 1:S+=`an instance of ${k[0]}`;break;case 2:S+=`an instance of ${k[0]} or ${k[1]}`;break;default:{const N=k.pop();S+=`an instance of ${k.join(", ")}, or ${N}`}}A.length>0&&(S+=" or ")}switch(A.length){case 0:break;case 1:A[0].toLowerCase()!==A[0]&&(S+="an "),S+=`${A[0]}`;break;case 2:S+=`one of ${A[0]} or ${A[1]}`;break;default:{const N=A.pop();S+=`one of ${A.join(", ")}, or ${N}`}}if(w==null)S+=`. Received ${w}`;else if(typeof w=="function"&&w.name)S+=`. Received function ${w.name}`;else if(typeof w=="object"){var R;if((R=w.constructor)!==null&&R!==void 0&&R.name)S+=`. Received an instance of ${w.constructor.name}`;else{const N=t(w,{depth:-1});S+=`. Received ${N}`}}else{let N=t(w,{colors:!1});N.length>25&&(N=`${N.slice(0,25)}...`),S+=`. Received type ${typeof w} (${N})`}return S},TypeError),h("ERR_INVALID_ARG_VALUE",(v,x,w="is invalid")=>{let S=t(x);return S.length>128&&(S=S.slice(0,128)+"..."),`The ${v.includes(".")?"property":"argument"} '${v}' ${w}. Received ${S}`},TypeError),h("ERR_INVALID_RETURN_VALUE",(v,x,w)=>{var S;const C=w!=null&&(S=w.constructor)!==null&&S!==void 0&&S.name?`instance of ${w.constructor.name}`:`type ${typeof w}`;return`Expected ${v} to be returned from the "${x}" function but got ${C}.`},TypeError),h("ERR_MISSING_ARGS",(...v)=>{c(v.length>0,"At least one arg needs to be specified");let x;const w=v.length;switch(v=(Array.isArray(v)?v:[v]).map(S=>`"${S}"`).join(" or "),w){case 1:x+=`The ${v[0]} argument`;break;case 2:x+=`The ${v[0]} and ${v[1]} arguments`;break;default:{const S=v.pop();x+=`The ${v.join(", ")}, and ${S} arguments`}break}return`${x} must be specified`},TypeError),h("ERR_OUT_OF_RANGE",(v,x,w)=>{c(x,'Missing "range" argument');let S;if(Number.isInteger(w)&&Math.abs(w)>2**32)S=u(String(w));else if(typeof w=="bigint"){S=String(w);const C=BigInt(2)**BigInt(32);(w>C||w<-C)&&(S=u(S)),S+="n"}else S=t(w);return`The value of "${v}" is out of range. It must be ${x}. Received ${S}`},RangeError),h("ERR_MULTIPLE_CALLBACK","Callback called multiple times",Error),h("ERR_METHOD_NOT_IMPLEMENTED","The %s method is not implemented",Error),h("ERR_STREAM_ALREADY_FINISHED","Cannot call %s after a stream was finished",Error),h("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable",Error),h("ERR_STREAM_DESTROYED","Cannot call %s after a stream was destroyed",Error),h("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),h("ERR_STREAM_PREMATURE_CLOSE","Premature close",Error),h("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF",Error),h("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event",Error),h("ERR_STREAM_WRITE_AFTER_END","write after end",Error),h("ERR_UNKNOWN_ENCODING","Unknown encoding: %s",TypeError),aM={AbortError:b,aggregateTwoErrors:m(y),hideStackFrames:m,codes:l},aM}var Av={exports:{}},Q$;function sw(){if(Q$)return Av.exports;Q$=1;const{AbortController:e,AbortSignal:t}=typeof self<"u"?self:typeof window<"u"?window:void 0;return Av.exports=e,Av.exports.AbortSignal=t,Av.exports.default=e,Av.exports}var NS={exports:{}},e9;function zE(){if(e9)return NS.exports;e9=1;var e=typeof Reflect=="object"?Reflect:null,t=e&&typeof e.apply=="function"?e.apply:function(k,A,R){return Function.prototype.apply.call(k,A,R)},n;e&&typeof e.ownKeys=="function"?n=e.ownKeys:Object.getOwnPropertySymbols?n=function(k){return Object.getOwnPropertyNames(k).concat(Object.getOwnPropertySymbols(k))}:n=function(k){return Object.getOwnPropertyNames(k)};function r(C){console&&console.warn&&console.warn(C)}var s=Number.isNaN||function(k){return k!==k};function i(){i.init.call(this)}NS.exports=i,NS.exports.once=x,i.EventEmitter=i,i.prototype._events=void 0,i.prototype._eventsCount=0,i.prototype._maxListeners=void 0;var a=10;function o(C){if(typeof C!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof C)}Object.defineProperty(i,"defaultMaxListeners",{enumerable:!0,get:function(){return a},set:function(C){if(typeof C!="number"||C<0||s(C))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+C+".");a=C}}),i.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},i.prototype.setMaxListeners=function(k){if(typeof k!="number"||k<0||s(k))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+k+".");return this._maxListeners=k,this};function l(C){return C._maxListeners===void 0?i.defaultMaxListeners:C._maxListeners}i.prototype.getMaxListeners=function(){return l(this)},i.prototype.emit=function(k){for(var A=[],R=1;R<arguments.length;R++)A.push(arguments[R]);var N=k==="error",I=this._events;if(I!==void 0)N=N&&I.error===void 0;else if(!N)return!1;if(N){var P;if(A.length>0&&(P=A[0]),P instanceof Error)throw P;var L=new Error("Unhandled error."+(P?" ("+P.message+")":""));throw L.context=P,L}var O=I[k];if(O===void 0)return!1;if(typeof O=="function")t(O,this,A);else for(var V=O.length,D=y(O,V),R=0;R<V;++R)t(D[R],this,A);return!0};function c(C,k,A,R){var N,I,P;if(o(A),I=C._events,I===void 0?(I=C._events=Object.create(null),C._eventsCount=0):(I.newListener!==void 0&&(C.emit("newListener",k,A.listener?A.listener:A),I=C._events),P=I[k]),P===void 0)P=I[k]=A,++C._eventsCount;else if(typeof P=="function"?P=I[k]=R?[A,P]:[P,A]:R?P.unshift(A):P.push(A),N=l(C),N>0&&P.length>N&&!P.warned){P.warned=!0;var L=new Error("Possible EventEmitter memory leak detected. "+P.length+" "+String(k)+" listeners added. Use emitter.setMaxListeners() to increase limit");L.name="MaxListenersExceededWarning",L.emitter=C,L.type=k,L.count=P.length,r(L)}return C}i.prototype.addListener=function(k,A){return c(this,k,A,!1)},i.prototype.on=i.prototype.addListener,i.prototype.prependListener=function(k,A){return c(this,k,A,!0)};function u(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function d(C,k,A){var R={fired:!1,wrapFn:void 0,target:C,type:k,listener:A},N=u.bind(R);return N.listener=A,R.wrapFn=N,N}i.prototype.once=function(k,A){return o(A),this.on(k,d(this,k,A)),this},i.prototype.prependOnceListener=function(k,A){return o(A),this.prependListener(k,d(this,k,A)),this},i.prototype.removeListener=function(k,A){var R,N,I,P,L;if(o(A),N=this._events,N===void 0)return this;if(R=N[k],R===void 0)return this;if(R===A||R.listener===A)--this._eventsCount===0?this._events=Object.create(null):(delete N[k],N.removeListener&&this.emit("removeListener",k,R.listener||A));else if(typeof R!="function"){for(I=-1,P=R.length-1;P>=0;P--)if(R[P]===A||R[P].listener===A){L=R[P].listener,I=P;break}if(I<0)return this;I===0?R.shift():b(R,I),R.length===1&&(N[k]=R[0]),N.removeListener!==void 0&&this.emit("removeListener",k,L||A)}return this},i.prototype.off=i.prototype.removeListener,i.prototype.removeAllListeners=function(k){var A,R,N;if(R=this._events,R===void 0)return this;if(R.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):R[k]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete R[k]),this;if(arguments.length===0){var I=Object.keys(R),P;for(N=0;N<I.length;++N)P=I[N],P!=="removeListener"&&this.removeAllListeners(P);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(A=R[k],typeof A=="function")this.removeListener(k,A);else if(A!==void 0)for(N=A.length-1;N>=0;N--)this.removeListener(k,A[N]);return this};function h(C,k,A){var R=C._events;if(R===void 0)return[];var N=R[k];return N===void 0?[]:typeof N=="function"?A?[N.listener||N]:[N]:A?v(N):y(N,N.length)}i.prototype.listeners=function(k){return h(this,k,!0)},i.prototype.rawListeners=function(k){return h(this,k,!1)},i.listenerCount=function(C,k){return typeof C.listenerCount=="function"?C.listenerCount(k):m.call(C,k)},i.prototype.listenerCount=m;function m(C){var k=this._events;if(k!==void 0){var A=k[C];if(typeof A=="function")return 1;if(A!==void 0)return A.length}return 0}i.prototype.eventNames=function(){return this._eventsCount>0?n(this._events):[]};function y(C,k){for(var A=new Array(k),R=0;R<k;++R)A[R]=C[R];return A}function b(C,k){for(;k+1<C.length;k++)C[k]=C[k+1];C.pop()}function v(C){for(var k=new Array(C.length),A=0;A<k.length;++A)k[A]=C[A].listener||C[A];return k}function x(C,k){return new Promise(function(A,R){function N(P){C.removeListener(k,I),R(P)}function I(){typeof C.removeListener=="function"&&C.removeListener("error",N),A([].slice.call(arguments))}S(C,k,I,{once:!0}),k!=="error"&&w(C,N,{once:!0})})}function w(C,k,A){typeof C.on=="function"&&S(C,"error",k,A)}function S(C,k,A,R){if(typeof C.on=="function")R.once?C.once(k,A):C.on(k,A);else if(typeof C.addEventListener=="function")C.addEventListener(k,function N(I){R.once&&C.removeEventListener(k,N),A(I)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof C)}return NS.exports}var t9;function Ro(){return t9||(t9=1,function(e){const t=Vh(),{format:n,inspect:r}=KK(),{codes:{ERR_INVALID_ARG_TYPE:s}}=co(),{kResistStopPropagation:i,AggregateError:a,SymbolDispose:o}=ei(),l=globalThis.AbortSignal||sw().AbortSignal,c=globalThis.AbortController||sw().AbortController,u=Object.getPrototypeOf(async function(){}).constructor,d=globalThis.Blob||t.Blob,h=typeof d<"u"?function(v){return v instanceof d}:function(v){return!1},m=(b,v)=>{if(b!==void 0&&(b===null||typeof b!="object"||!("aborted"in b)))throw new s(v,"AbortSignal",b)},y=(b,v)=>{if(typeof b!="function")throw new s(v,"Function",b)};e.exports={AggregateError:a,kEmptyObject:Object.freeze({}),once(b){let v=!1;return function(...x){v||(v=!0,b.apply(this,x))}},createDeferredPromise:function(){let b,v;return{promise:new Promise((w,S)=>{b=w,v=S}),resolve:b,reject:v}},promisify(b){return new Promise((v,x)=>{b((w,...S)=>w?x(w):v(...S))})},debuglog(){return function(){}},format:n,inspect:r,types:{isAsyncFunction(b){return b instanceof u},isArrayBufferView(b){return ArrayBuffer.isView(b)}},isBlob:h,deprecate(b,v){return b},addAbortListener:zE().addAbortListener||function(v,x){if(v===void 0)throw new s("signal","AbortSignal",v);m(v,"signal"),y(x,"listener");let w;return v.aborted?queueMicrotask(()=>x()):(v.addEventListener("abort",x,{__proto__:null,once:!0,[i]:!0}),w=()=>{v.removeEventListener("abort",x)}),{__proto__:null,[o](){var S;(S=w)===null||S===void 0||S()}}},AbortSignalAny:l.any||function(v){if(v.length===1)return v[0];const x=new c,w=()=>x.abort();return v.forEach(S=>{m(S,"signals"),S.addEventListener("abort",w,{once:!0})}),x.signal.addEventListener("abort",()=>{v.forEach(S=>S.removeEventListener("abort",w))},{once:!0}),x.signal}},e.exports.promisify.custom=Symbol.for("nodejs.util.promisify.custom")}(sM)),sM.exports}var MS={},oM,n9;function b1(){if(n9)return oM;n9=1;const{ArrayIsArray:e,ArrayPrototypeIncludes:t,ArrayPrototypeJoin:n,ArrayPrototypeMap:r,NumberIsInteger:s,NumberIsNaN:i,NumberMAX_SAFE_INTEGER:a,NumberMIN_SAFE_INTEGER:o,NumberParseInt:l,ObjectPrototypeHasOwnProperty:c,RegExpPrototypeExec:u,String:d,StringPrototypeToUpperCase:h,StringPrototypeTrim:m}=ei(),{hideStackFrames:y,codes:{ERR_SOCKET_BAD_PORT:b,ERR_INVALID_ARG_TYPE:v,ERR_INVALID_ARG_VALUE:x,ERR_OUT_OF_RANGE:w,ERR_UNKNOWN_SIGNAL:S}}=co(),{normalizeEncoding:C}=Ro(),{isAsyncFunction:k,isArrayBufferView:A}=Ro().types,R={};function N(re){return re===(re|0)}function I(re){return re===re>>>0}const P=/^[0-7]+$/,L="must be a 32-bit unsigned integer or an octal string";function O(re,Te,Be){if(typeof re>"u"&&(re=Be),typeof re=="string"){if(u(P,re)===null)throw new x(Te,re,L);re=l(re,8)}return Z(re,Te),re}const V=y((re,Te,Be=o,ke=a)=>{if(typeof re!="number")throw new v(Te,"number",re);if(!s(re))throw new w(Te,"an integer",re);if(re<Be||re>ke)throw new w(Te,`>= ${Be} && <= ${ke}`,re)}),D=y((re,Te,Be=-2147483648,ke=2147483647)=>{if(typeof re!="number")throw new v(Te,"number",re);if(!s(re))throw new w(Te,"an integer",re);if(re<Be||re>ke)throw new w(Te,`>= ${Be} && <= ${ke}`,re)}),Z=y((re,Te,Be=!1)=>{if(typeof re!="number")throw new v(Te,"number",re);if(!s(re))throw new w(Te,"an integer",re);const ke=Be?1:0,lt=4294967295;if(re<ke||re>lt)throw new w(Te,`>= ${ke} && <= ${lt}`,re)});function U(re,Te){if(typeof re!="string")throw new v(Te,"string",re)}function H(re,Te,Be=void 0,ke){if(typeof re!="number")throw new v(Te,"number",re);if(Be!=null&&re<Be||ke!=null&&re>ke||(Be!=null||ke!=null)&&i(re))throw new w(Te,`${Be!=null?`>= ${Be}`:""}${Be!=null&&ke!=null?" && ":""}${ke!=null?`<= ${ke}`:""}`,re)}const $=y((re,Te,Be)=>{if(!t(Be,re)){const lt="must be one of: "+n(r(Be,Rt=>typeof Rt=="string"?`'${Rt}'`:d(Rt)),", ");throw new x(Te,re,lt)}});function ne(re,Te){if(typeof re!="boolean")throw new v(Te,"boolean",re)}function W(re,Te,Be){return re==null||!c(re,Te)?Be:re[Te]}const Q=y((re,Te,Be=null)=>{const ke=W(Be,"allowArray",!1),lt=W(Be,"allowFunction",!1);if(!W(Be,"nullable",!1)&&re===null||!ke&&e(re)||typeof re!="object"&&(!lt||typeof re!="function"))throw new v(Te,"Object",re)}),ee=y((re,Te)=>{if(re!=null&&typeof re!="object"&&typeof re!="function")throw new v(Te,"a dictionary",re)}),se=y((re,Te,Be=0)=>{if(!e(re))throw new v(Te,"Array",re);if(re.length<Be){const ke=`must be longer than ${Be}`;throw new x(Te,re,ke)}});function pe(re,Te){se(re,Te);for(let Be=0;Be<re.length;Be++)U(re[Be],`${Te}[${Be}]`)}function ce(re,Te){se(re,Te);for(let Be=0;Be<re.length;Be++)ne(re[Be],`${Te}[${Be}]`)}function Ie(re,Te){se(re,Te);for(let Be=0;Be<re.length;Be++){const ke=re[Be],lt=`${Te}[${Be}]`;if(ke==null)throw new v(lt,"AbortSignal",ke);Qe(ke,lt)}}function De(re,Te="signal"){if(U(re,Te),R[re]===void 0)throw R[h(re)]!==void 0?new S(re+" (signals must use all capital letters)"):new S(re)}const Se=y((re,Te="buffer")=>{if(!A(re))throw new v(Te,["Buffer","TypedArray","DataView"],re)});function Ce(re,Te){const Be=C(Te),ke=re.length;if(Be==="hex"&&ke%2!==0)throw new x("encoding",Te,`is invalid for data of length ${ke}`)}function qe(re,Te="Port",Be=!0){if(typeof re!="number"&&typeof re!="string"||typeof re=="string"&&m(re).length===0||+re!==+re>>>0||re>65535||re===0&&!Be)throw new b(Te,re,Be);return re|0}const Qe=y((re,Te)=>{if(re!==void 0&&(re===null||typeof re!="object"||!("aborted"in re)))throw new v(Te,"AbortSignal",re)}),Ve=y((re,Te)=>{if(typeof re!="function")throw new v(Te,"Function",re)}),Ne=y((re,Te)=>{if(typeof re!="function"||k(re))throw new v(Te,"Function",re)}),K=y((re,Te)=>{if(re!==void 0)throw new v(Te,"undefined",re)});function ge(re,Te,Be){if(!t(Be,re))throw new v(Te,`('${n(Be,"|")}')`,re)}const Ae=/^(?:<[^>]*>)(?:\s*;\s*[^;"\s]+(?:=(")?[^;"\s]*\1)?)*$/;function le(re,Te){if(typeof re>"u"||!u(Ae,re))throw new x(Te,re,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}function oe(re){if(typeof re=="string")return le(re,"hints"),re;if(e(re)){const Te=re.length;let Be="";if(Te===0)return Be;for(let ke=0;ke<Te;ke++){const lt=re[ke];le(lt,"hints"),Be+=lt,ke!==Te-1&&(Be+=", ")}return Be}throw new x("hints",re,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}return oM={isInt32:N,isUint32:I,parseFileMode:O,validateArray:se,validateStringArray:pe,validateBooleanArray:ce,validateAbortSignalArray:Ie,validateBoolean:ne,validateBuffer:Se,validateDictionary:ee,validateEncoding:Ce,validateFunction:Ve,validateInt32:D,validateInteger:V,validateNumber:H,validateObject:Q,validateOneOf:$,validatePlainFunction:Ne,validatePort:qe,validateSignalName:De,validateString:U,validateUint32:Z,validateUndefined:K,validateUnion:ge,validateAbortSignal:Qe,validateLinkHeaderValue:oe},oM}var IS={exports:{}},lM={},r9;function Km(){return r9||(r9=1,function(e){Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});function t(C){return C&&C.__esModule&&Object.prototype.hasOwnProperty.call(C,"default")?C.default:C}var n={exports:{}},r=n.exports={},s,i;function a(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?s=setTimeout:s=a}catch{s=a}try{typeof clearTimeout=="function"?i=clearTimeout:i=o}catch{i=o}})();function l(C){if(s===setTimeout)return setTimeout(C,0);if((s===a||!s)&&setTimeout)return s=setTimeout,setTimeout(C,0);try{return s(C,0)}catch{try{return s.call(null,C,0)}catch{return s.call(this,C,0)}}}function c(C){if(i===clearTimeout)return clearTimeout(C);if((i===o||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(C);try{return i(C)}catch{try{return i.call(null,C)}catch{return i.call(this,C)}}}var u=[],d=!1,h,m=-1;function y(){!d||!h||(d=!1,h.length?u=h.concat(u):m=-1,u.length&&b())}function b(){if(!d){var C=l(y);d=!0;for(var k=u.length;k;){for(h=u,u=[];++m<k;)h&&h[m].run();m=-1,k=u.length}h=null,d=!1,c(C)}}r.nextTick=function(C){var k=new Array(arguments.length-1);if(arguments.length>1)for(var A=1;A<arguments.length;A++)k[A-1]=arguments[A];u.push(new v(C,k)),u.length===1&&!d&&l(b)};function v(C,k){this.fun=C,this.array=k}v.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={};function x(){}r.on=x,r.addListener=x,r.once=x,r.off=x,r.removeListener=x,r.removeAllListeners=x,r.emit=x,r.prependListener=x,r.prependOnceListener=x,r.listeners=function(C){return[]},r.binding=function(C){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(C){throw new Error("process.chdir is not supported")},r.umask=function(){return 0};var w=n.exports;const S=t(w);e.default=S,e.process=S}(lM)),lM}var cM,s9;function nf(){if(s9)return cM;s9=1;const{SymbolAsyncIterator:e,SymbolIterator:t,SymbolFor:n}=ei(),r=n("nodejs.stream.destroyed"),s=n("nodejs.stream.errored"),i=n("nodejs.stream.readable"),a=n("nodejs.stream.writable"),o=n("nodejs.stream.disturbed"),l=n("nodejs.webstream.isClosedPromise"),c=n("nodejs.webstream.controllerErrorFunction");function u(W,Q=!1){var ee;return!!(W&&typeof W.pipe=="function"&&typeof W.on=="function"&&(!Q||typeof W.pause=="function"&&typeof W.resume=="function")&&(!W._writableState||((ee=W._readableState)===null||ee===void 0?void 0:ee.readable)!==!1)&&(!W._writableState||W._readableState))}function d(W){var Q;return!!(W&&typeof W.write=="function"&&typeof W.on=="function"&&(!W._readableState||((Q=W._writableState)===null||Q===void 0?void 0:Q.writable)!==!1))}function h(W){return!!(W&&typeof W.pipe=="function"&&W._readableState&&typeof W.on=="function"&&typeof W.write=="function")}function m(W){return W&&(W._readableState||W._writableState||typeof W.write=="function"&&typeof W.on=="function"||typeof W.pipe=="function"&&typeof W.on=="function")}function y(W){return!!(W&&!m(W)&&typeof W.pipeThrough=="function"&&typeof W.getReader=="function"&&typeof W.cancel=="function")}function b(W){return!!(W&&!m(W)&&typeof W.getWriter=="function"&&typeof W.abort=="function")}function v(W){return!!(W&&!m(W)&&typeof W.readable=="object"&&typeof W.writable=="object")}function x(W){return y(W)||b(W)||v(W)}function w(W,Q){return W==null?!1:Q===!0?typeof W[e]=="function":Q===!1?typeof W[t]=="function":typeof W[e]=="function"||typeof W[t]=="function"}function S(W){if(!m(W))return null;const Q=W._writableState,ee=W._readableState,se=Q||ee;return!!(W.destroyed||W[r]||se!=null&&se.destroyed)}function C(W){if(!d(W))return null;if(W.writableEnded===!0)return!0;const Q=W._writableState;return Q!=null&&Q.errored?!1:typeof(Q==null?void 0:Q.ended)!="boolean"?null:Q.ended}function k(W,Q){if(!d(W))return null;if(W.writableFinished===!0)return!0;const ee=W._writableState;return ee!=null&&ee.errored?!1:typeof(ee==null?void 0:ee.finished)!="boolean"?null:!!(ee.finished||Q===!1&&ee.ended===!0&&ee.length===0)}function A(W){if(!u(W))return null;if(W.readableEnded===!0)return!0;const Q=W._readableState;return!Q||Q.errored?!1:typeof(Q==null?void 0:Q.ended)!="boolean"?null:Q.ended}function R(W,Q){if(!u(W))return null;const ee=W._readableState;return ee!=null&&ee.errored?!1:typeof(ee==null?void 0:ee.endEmitted)!="boolean"?null:!!(ee.endEmitted||Q===!1&&ee.ended===!0&&ee.length===0)}function N(W){return W&&W[i]!=null?W[i]:typeof(W==null?void 0:W.readable)!="boolean"?null:S(W)?!1:u(W)&&W.readable&&!R(W)}function I(W){return W&&W[a]!=null?W[a]:typeof(W==null?void 0:W.writable)!="boolean"?null:S(W)?!1:d(W)&&W.writable&&!C(W)}function P(W,Q){return m(W)?S(W)?!0:!((Q==null?void 0:Q.readable)!==!1&&N(W)||(Q==null?void 0:Q.writable)!==!1&&I(W)):null}function L(W){var Q,ee;return m(W)?W.writableErrored?W.writableErrored:(Q=(ee=W._writableState)===null||ee===void 0?void 0:ee.errored)!==null&&Q!==void 0?Q:null:null}function O(W){var Q,ee;return m(W)?W.readableErrored?W.readableErrored:(Q=(ee=W._readableState)===null||ee===void 0?void 0:ee.errored)!==null&&Q!==void 0?Q:null:null}function V(W){if(!m(W))return null;if(typeof W.closed=="boolean")return W.closed;const Q=W._writableState,ee=W._readableState;return typeof(Q==null?void 0:Q.closed)=="boolean"||typeof(ee==null?void 0:ee.closed)=="boolean"?(Q==null?void 0:Q.closed)||(ee==null?void 0:ee.closed):typeof W._closed=="boolean"&&D(W)?W._closed:null}function D(W){return typeof W._closed=="boolean"&&typeof W._defaultKeepAlive=="boolean"&&typeof W._removedConnection=="boolean"&&typeof W._removedContLen=="boolean"}function Z(W){return typeof W._sent100=="boolean"&&D(W)}function U(W){var Q;return typeof W._consuming=="boolean"&&typeof W._dumped=="boolean"&&((Q=W.req)===null||Q===void 0?void 0:Q.upgradeOrConnect)===void 0}function H(W){if(!m(W))return null;const Q=W._writableState,ee=W._readableState,se=Q||ee;return!se&&Z(W)||!!(se&&se.autoDestroy&&se.emitClose&&se.closed===!1)}function $(W){var Q;return!!(W&&((Q=W[o])!==null&&Q!==void 0?Q:W.readableDidRead||W.readableAborted))}function ne(W){var Q,ee,se,pe,ce,Ie,De,Se,Ce,qe;return!!(W&&((Q=(ee=(se=(pe=(ce=(Ie=W[s])!==null&&Ie!==void 0?Ie:W.readableErrored)!==null&&ce!==void 0?ce:W.writableErrored)!==null&&pe!==void 0?pe:(De=W._readableState)===null||De===void 0?void 0:De.errorEmitted)!==null&&se!==void 0?se:(Se=W._writableState)===null||Se===void 0?void 0:Se.errorEmitted)!==null&&ee!==void 0?ee:(Ce=W._readableState)===null||Ce===void 0?void 0:Ce.errored)!==null&&Q!==void 0?Q:!((qe=W._writableState)===null||qe===void 0)&&qe.errored))}return cM={isDestroyed:S,kIsDestroyed:r,isDisturbed:$,kIsDisturbed:o,isErrored:ne,kIsErrored:s,isReadable:N,kIsReadable:i,kIsClosedPromise:l,kControllerErrorFunction:c,kIsWritable:a,isClosed:V,isDuplexNodeStream:h,isFinished:P,isIterable:w,isReadableNodeStream:u,isReadableStream:y,isReadableEnded:A,isReadableFinished:R,isReadableErrored:O,isNodeStream:m,isWebStream:x,isWritable:I,isWritableNodeStream:d,isWritableStream:b,isWritableEnded:C,isWritableFinished:k,isWritableErrored:L,isServerRequest:U,isServerResponse:Z,willEmitClose:H,isTransformStream:v},cM}var i9;function Wh(){if(i9)return IS.exports;i9=1;const e=Km(),{AbortError:t,codes:n}=co(),{ERR_INVALID_ARG_TYPE:r,ERR_STREAM_PREMATURE_CLOSE:s}=n,{kEmptyObject:i,once:a}=Ro(),{validateAbortSignal:o,validateFunction:l,validateObject:c,validateBoolean:u}=b1(),{Promise:d,PromisePrototypeThen:h,SymbolDispose:m}=ei(),{isClosed:y,isReadable:b,isReadableNodeStream:v,isReadableStream:x,isReadableFinished:w,isReadableErrored:S,isWritable:C,isWritableNodeStream:k,isWritableStream:A,isWritableFinished:R,isWritableErrored:N,isNodeStream:I,willEmitClose:P,kIsClosedPromise:L}=nf();let O;function V($){return $.setHeader&&typeof $.abort=="function"}const D=()=>{};function Z($,ne,W){var Q,ee;if(arguments.length===2?(W=ne,ne=i):ne==null?ne=i:c(ne,"options"),l(W,"callback"),o(ne.signal,"options.signal"),W=a(W),x($)||A($))return U($,ne,W);if(!I($))throw new r("stream",["ReadableStream","WritableStream","Stream"],$);const se=(Q=ne.readable)!==null&&Q!==void 0?Q:v($),pe=(ee=ne.writable)!==null&&ee!==void 0?ee:k($),ce=$._writableState,Ie=$._readableState,De=()=>{$.writable||qe()};let Se=P($)&&v($)===se&&k($)===pe,Ce=R($,!1);const qe=()=>{Ce=!0,$.destroyed&&(Se=!1),!(Se&&(!$.readable||se))&&(!se||Qe)&&W.call($)};let Qe=w($,!1);const Ve=()=>{Qe=!0,$.destroyed&&(Se=!1),!(Se&&(!$.writable||pe))&&(!pe||Ce)&&W.call($)},Ne=re=>{W.call($,re)};let K=y($);const ge=()=>{K=!0;const re=N($)||S($);if(re&&typeof re!="boolean")return W.call($,re);if(se&&!Qe&&v($,!0)&&!w($,!1))return W.call($,new s);if(pe&&!Ce&&!R($,!1))return W.call($,new s);W.call($)},Ae=()=>{K=!0;const re=N($)||S($);if(re&&typeof re!="boolean")return W.call($,re);W.call($)},le=()=>{$.req.on("finish",qe)};V($)?($.on("complete",qe),Se||$.on("abort",ge),$.req?le():$.on("request",le)):pe&&!ce&&($.on("end",De),$.on("close",De)),!Se&&typeof $.aborted=="boolean"&&$.on("aborted",ge),$.on("end",Ve),$.on("finish",qe),ne.error!==!1&&$.on("error",Ne),$.on("close",ge),K?e.nextTick(ge):ce!=null&&ce.errorEmitted||Ie!=null&&Ie.errorEmitted?Se||e.nextTick(Ae):(!se&&(!Se||b($))&&(Ce||C($)===!1)||!pe&&(!Se||C($))&&(Qe||b($)===!1)||Ie&&$.req&&$.aborted)&&e.nextTick(Ae);const oe=()=>{W=D,$.removeListener("aborted",ge),$.removeListener("complete",qe),$.removeListener("abort",ge),$.removeListener("request",le),$.req&&$.req.removeListener("finish",qe),$.removeListener("end",De),$.removeListener("close",De),$.removeListener("finish",qe),$.removeListener("end",Ve),$.removeListener("error",Ne),$.removeListener("close",ge)};if(ne.signal&&!K){const re=()=>{const Te=W;oe(),Te.call($,new t(void 0,{cause:ne.signal.reason}))};if(ne.signal.aborted)e.nextTick(re);else{O=O||Ro().addAbortListener;const Te=O(ne.signal,re),Be=W;W=a((...ke)=>{Te[m](),Be.apply($,ke)})}}return oe}function U($,ne,W){let Q=!1,ee=D;if(ne.signal)if(ee=()=>{Q=!0,W.call($,new t(void 0,{cause:ne.signal.reason}))},ne.signal.aborted)e.nextTick(ee);else{O=O||Ro().addAbortListener;const pe=O(ne.signal,ee),ce=W;W=a((...Ie)=>{pe[m](),ce.apply($,Ie)})}const se=(...pe)=>{Q||e.nextTick(()=>W.apply($,pe))};return h($[L].promise,se,se),D}function H($,ne){var W;let Q=!1;return ne===null&&(ne=i),(W=ne)!==null&&W!==void 0&&W.cleanup&&(u(ne.cleanup,"cleanup"),Q=ne.cleanup),new d((ee,se)=>{const pe=Z($,ne,ce=>{Q&&pe(),ce?se(ce):ee()})})}return IS.exports=Z,IS.exports.finished=H,IS.exports}var uM,a9;function qy(){if(a9)return uM;a9=1;const e=Km(),{aggregateTwoErrors:t,codes:{ERR_MULTIPLE_CALLBACK:n},AbortError:r}=co(),{Symbol:s}=ei(),{kIsDestroyed:i,isDestroyed:a,isFinished:o,isServerRequest:l}=nf(),c=s("kDestroy"),u=s("kConstruct");function d(P,L,O){P&&(P.stack,L&&!L.errored&&(L.errored=P),O&&!O.errored&&(O.errored=P))}function h(P,L){const O=this._readableState,V=this._writableState,D=V||O;return V!=null&&V.destroyed||O!=null&&O.destroyed?(typeof L=="function"&&L(),this):(d(P,V,O),V&&(V.destroyed=!0),O&&(O.destroyed=!0),D.constructed?m(this,P,L):this.once(c,function(Z){m(this,t(Z,P),L)}),this)}function m(P,L,O){let V=!1;function D(Z){if(V)return;V=!0;const U=P._readableState,H=P._writableState;d(Z,H,U),H&&(H.closed=!0),U&&(U.closed=!0),typeof O=="function"&&O(Z),Z?e.nextTick(y,P,Z):e.nextTick(b,P)}try{P._destroy(L||null,D)}catch(Z){D(Z)}}function y(P,L){v(P,L),b(P)}function b(P){const L=P._readableState,O=P._writableState;O&&(O.closeEmitted=!0),L&&(L.closeEmitted=!0),(O!=null&&O.emitClose||L!=null&&L.emitClose)&&P.emit("close")}function v(P,L){const O=P._readableState,V=P._writableState;V!=null&&V.errorEmitted||O!=null&&O.errorEmitted||(V&&(V.errorEmitted=!0),O&&(O.errorEmitted=!0),P.emit("error",L))}function x(){const P=this._readableState,L=this._writableState;P&&(P.constructed=!0,P.closed=!1,P.closeEmitted=!1,P.destroyed=!1,P.errored=null,P.errorEmitted=!1,P.reading=!1,P.ended=P.readable===!1,P.endEmitted=P.readable===!1),L&&(L.constructed=!0,L.destroyed=!1,L.closed=!1,L.closeEmitted=!1,L.errored=null,L.errorEmitted=!1,L.finalCalled=!1,L.prefinished=!1,L.ended=L.writable===!1,L.ending=L.writable===!1,L.finished=L.writable===!1)}function w(P,L,O){const V=P._readableState,D=P._writableState;if(D!=null&&D.destroyed||V!=null&&V.destroyed)return this;V!=null&&V.autoDestroy||D!=null&&D.autoDestroy?P.destroy(L):L&&(L.stack,D&&!D.errored&&(D.errored=L),V&&!V.errored&&(V.errored=L),O?e.nextTick(v,P,L):v(P,L))}function S(P,L){if(typeof P._construct!="function")return;const O=P._readableState,V=P._writableState;O&&(O.constructed=!1),V&&(V.constructed=!1),P.once(u,L),!(P.listenerCount(u)>1)&&e.nextTick(C,P)}function C(P){let L=!1;function O(V){if(L){w(P,V??new n);return}L=!0;const D=P._readableState,Z=P._writableState,U=Z||D;D&&(D.constructed=!0),Z&&(Z.constructed=!0),U.destroyed?P.emit(c,V):V?w(P,V,!0):e.nextTick(k,P)}try{P._construct(V=>{e.nextTick(O,V)})}catch(V){e.nextTick(O,V)}}function k(P){P.emit(u)}function A(P){return(P==null?void 0:P.setHeader)&&typeof P.abort=="function"}function R(P){P.emit("close")}function N(P,L){P.emit("error",L),e.nextTick(R,P)}function I(P,L){!P||a(P)||(!L&&!o(P)&&(L=new r),l(P)?(P.socket=null,P.destroy(L)):A(P)?P.abort():A(P.req)?P.req.abort():typeof P.destroy=="function"?P.destroy(L):typeof P.close=="function"?P.close():L?e.nextTick(N,P,L):e.nextTick(R,P),P.destroyed||(P[i]=!0))}return uM={construct:S,destroyer:I,destroy:h,undestroy:x,errorOrDestroy:w},uM}var dM,o9;function UO(){if(o9)return dM;o9=1;const{ArrayIsArray:e,ObjectSetPrototypeOf:t}=ei(),{EventEmitter:n}=zE();function r(i){n.call(this,i)}t(r.prototype,n.prototype),t(r,n),r.prototype.pipe=function(i,a){const o=this;function l(b){i.writable&&i.write(b)===!1&&o.pause&&o.pause()}o.on("data",l);function c(){o.readable&&o.resume&&o.resume()}i.on("drain",c),!i._isStdio&&(!a||a.end!==!1)&&(o.on("end",d),o.on("close",h));let u=!1;function d(){u||(u=!0,i.end())}function h(){u||(u=!0,typeof i.destroy=="function"&&i.destroy())}function m(b){y(),n.listenerCount(this,"error")===0&&this.emit("error",b)}s(o,"error",m),s(i,"error",m);function y(){o.removeListener("data",l),i.removeListener("drain",c),o.removeListener("end",d),o.removeListener("close",h),o.removeListener("error",m),i.removeListener("error",m),o.removeListener("end",y),o.removeListener("close",y),i.removeListener("close",y)}return o.on("end",y),o.on("close",y),i.on("close",y),i.emit("pipe",o),i};function s(i,a,o){if(typeof i.prependListener=="function")return i.prependListener(a,o);!i._events||!i._events[a]?i.on(a,o):e(i._events[a])?i._events[a].unshift(o):i._events[a]=[o,i._events[a]]}return dM={Stream:r,prependListener:s},dM}var fM={exports:{}},l9;function UE(){return l9||(l9=1,function(e){const{SymbolDispose:t}=ei(),{AbortError:n,codes:r}=co(),{isNodeStream:s,isWebStream:i,kControllerErrorFunction:a}=nf(),o=Wh(),{ERR_INVALID_ARG_TYPE:l}=r;let c;const u=(d,h)=>{if(typeof d!="object"||!("aborted"in d))throw new l(h,"AbortSignal",d)};e.exports.addAbortSignal=function(h,m){if(u(h,"signal"),!s(m)&&!i(m))throw new l("stream",["ReadableStream","WritableStream","Stream"],m);return e.exports.addAbortSignalNoValidate(h,m)},e.exports.addAbortSignalNoValidate=function(d,h){if(typeof d!="object"||!("aborted"in d))return h;const m=s(h)?()=>{h.destroy(new n(void 0,{cause:d.reason}))}:()=>{h[a](new n(void 0,{cause:d.reason}))};if(d.aborted)m();else{c=c||Ro().addAbortListener;const y=c(d,m);o(h,y[t])}return h}}(fM)),fM.exports}var hM,c9;function V_e(){if(c9)return hM;c9=1;const{StringPrototypeSlice:e,SymbolIterator:t,TypedArrayPrototypeSet:n,Uint8Array:r}=ei(),{Buffer:s}=Vh(),{inspect:i}=Ro();return hM=class{constructor(){this.head=null,this.tail=null,this.length=0}push(o){const l={data:o,next:null};this.length>0?this.tail.next=l:this.head=l,this.tail=l,++this.length}unshift(o){const l={data:o,next:this.head};this.length===0&&(this.tail=l),this.head=l,++this.length}shift(){if(this.length===0)return;const o=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,o}clear(){this.head=this.tail=null,this.length=0}join(o){if(this.length===0)return"";let l=this.head,c=""+l.data;for(;(l=l.next)!==null;)c+=o+l.data;return c}concat(o){if(this.length===0)return s.alloc(0);const l=s.allocUnsafe(o>>>0);let c=this.head,u=0;for(;c;)n(l,c.data,u),u+=c.data.length,c=c.next;return l}consume(o,l){const c=this.head.data;if(o<c.length){const u=c.slice(0,o);return this.head.data=c.slice(o),u}return o===c.length?this.shift():l?this._getString(o):this._getBuffer(o)}first(){return this.head.data}*[t](){for(let o=this.head;o;o=o.next)yield o.data}_getString(o){let l="",c=this.head,u=0;do{const d=c.data;if(o>d.length)l+=d,o-=d.length;else{o===d.length?(l+=d,++u,c.next?this.head=c.next:this.head=this.tail=null):(l+=e(d,0,o),this.head=c,c.data=e(d,o));break}++u}while((c=c.next)!==null);return this.length-=u,l}_getBuffer(o){const l=s.allocUnsafe(o),c=o;let u=this.head,d=0;do{const h=u.data;if(o>h.length)n(l,h,c-o),o-=h.length;else{o===h.length?(n(l,h,c-o),++d,u.next?this.head=u.next:this.head=this.tail=null):(n(l,new r(h.buffer,h.byteOffset,o),c-o),this.head=u,u.data=h.slice(o));break}++d}while((u=u.next)!==null);return this.length-=d,l}[Symbol.for("nodejs.util.inspect.custom")](o,l){return i(this,{...l,depth:0,customInspect:!1})}},hM}var pM,u9;function qE(){if(u9)return pM;u9=1;const{MathFloor:e,NumberIsInteger:t}=ei(),{validateInteger:n}=b1(),{ERR_INVALID_ARG_VALUE:r}=co().codes;let s=16*1024,i=16;function a(u,d,h){return u.highWaterMark!=null?u.highWaterMark:d?u[h]:null}function o(u){return u?i:s}function l(u,d){n(d,"value",0),u?i=d:s=d}function c(u,d,h,m){const y=a(d,m,h);if(y!=null){if(!t(y)||y<0){const b=m?`options.${h}`:"options.highWaterMark";throw new r(b,y)}return e(y)}return o(u.objectMode)}return pM={getHighWaterMark:c,getDefaultHighWaterMark:o,setDefaultHighWaterMark:l},pM}var mM={},jS={exports:{}},d9;function qO(){return d9||(d9=1,function(e,t){var n=Vh(),r=n.Buffer;function s(a,o){for(var l in a)o[l]=a[l]}r.from&&r.alloc&&r.allocUnsafe&&r.allocUnsafeSlow?e.exports=n:(s(n,t),t.Buffer=i);function i(a,o,l){return r(a,o,l)}s(r,i),i.from=function(a,o,l){if(typeof a=="number")throw new TypeError("Argument must not be a number");return r(a,o,l)},i.alloc=function(a,o,l){if(typeof a!="number")throw new TypeError("Argument must be a number");var c=r(a);return o!==void 0?typeof l=="string"?c.fill(o,l):c.fill(o):c.fill(0),c},i.allocUnsafe=function(a){if(typeof a!="number")throw new TypeError("Argument must be a number");return r(a)},i.allocUnsafeSlow=function(a){if(typeof a!="number")throw new TypeError("Argument must be a number");return n.SlowBuffer(a)}}(jS,jS.exports)),jS.exports}var f9;function W_e(){if(f9)return mM;f9=1;var e=qO().Buffer,t=e.isEncoding||function(x){switch(x=""+x,x&&x.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function n(x){if(!x)return"utf8";for(var w;;)switch(x){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return x;default:if(w)return;x=(""+x).toLowerCase(),w=!0}}function r(x){var w=n(x);if(typeof w!="string"&&(e.isEncoding===t||!t(x)))throw new Error("Unknown encoding: "+x);return w||x}mM.StringDecoder=s;function s(x){this.encoding=r(x);var w;switch(this.encoding){case"utf16le":this.text=d,this.end=h,w=4;break;case"utf8":this.fillLast=l,w=4;break;case"base64":this.text=m,this.end=y,w=3;break;default:this.write=b,this.end=v;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=e.allocUnsafe(w)}s.prototype.write=function(x){if(x.length===0)return"";var w,S;if(this.lastNeed){if(w=this.fillLast(x),w===void 0)return"";S=this.lastNeed,this.lastNeed=0}else S=0;return S<x.length?w?w+this.text(x,S):this.text(x,S):w||""},s.prototype.end=u,s.prototype.text=c,s.prototype.fillLast=function(x){if(this.lastNeed<=x.length)return x.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);x.copy(this.lastChar,this.lastTotal-this.lastNeed,0,x.length),this.lastNeed-=x.length};function i(x){return x<=127?0:x>>5===6?2:x>>4===14?3:x>>3===30?4:x>>6===2?-1:-2}function a(x,w,S){var C=w.length-1;if(C<S)return 0;var k=i(w[C]);return k>=0?(k>0&&(x.lastNeed=k-1),k):--C<S||k===-2?0:(k=i(w[C]),k>=0?(k>0&&(x.lastNeed=k-2),k):--C<S||k===-2?0:(k=i(w[C]),k>=0?(k>0&&(k===2?k=0:x.lastNeed=k-3),k):0))}function o(x,w,S){if((w[0]&192)!==128)return x.lastNeed=0,"�";if(x.lastNeed>1&&w.length>1){if((w[1]&192)!==128)return x.lastNeed=1,"�";if(x.lastNeed>2&&w.length>2&&(w[2]&192)!==128)return x.lastNeed=2,"�"}}function l(x){var w=this.lastTotal-this.lastNeed,S=o(this,x);if(S!==void 0)return S;if(this.lastNeed<=x.length)return x.copy(this.lastChar,w,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);x.copy(this.lastChar,w,0,x.length),this.lastNeed-=x.length}function c(x,w){var S=a(this,x,w);if(!this.lastNeed)return x.toString("utf8",w);this.lastTotal=S;var C=x.length-(S-this.lastNeed);return x.copy(this.lastChar,0,C),x.toString("utf8",w,C)}function u(x){var w=x&&x.length?this.write(x):"";return this.lastNeed?w+"�":w}function d(x,w){if((x.length-w)%2===0){var S=x.toString("utf16le",w);if(S){var C=S.charCodeAt(S.length-1);if(C>=55296&&C<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=x[x.length-2],this.lastChar[1]=x[x.length-1],S.slice(0,-1)}return S}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=x[x.length-1],x.toString("utf16le",w,x.length-1)}function h(x){var w=x&&x.length?this.write(x):"";if(this.lastNeed){var S=this.lastTotal-this.lastNeed;return w+this.lastChar.toString("utf16le",0,S)}return w}function m(x,w){var S=(x.length-w)%3;return S===0?x.toString("base64",w):(this.lastNeed=3-S,this.lastTotal=3,S===1?this.lastChar[0]=x[x.length-1]:(this.lastChar[0]=x[x.length-2],this.lastChar[1]=x[x.length-1]),x.toString("base64",w,x.length-S))}function y(x){var w=x&&x.length?this.write(x):"";return this.lastNeed?w+this.lastChar.toString("base64",0,3-this.lastNeed):w}function b(x){return x.toString(this.encoding)}function v(x){return x&&x.length?this.write(x):""}return mM}var gM,h9;function YK(){if(h9)return gM;h9=1;const e=Km(),{PromisePrototypeThen:t,SymbolAsyncIterator:n,SymbolIterator:r}=ei(),{Buffer:s}=Vh(),{ERR_INVALID_ARG_TYPE:i,ERR_STREAM_NULL_VALUES:a}=co().codes;function o(l,c,u){let d;if(typeof c=="string"||c instanceof s)return new l({objectMode:!0,...u,read(){this.push(c),this.push(null)}});let h;if(c&&c[n])h=!0,d=c[n]();else if(c&&c[r])h=!1,d=c[r]();else throw new i("iterable",["Iterable"],c);const m=new l({objectMode:!0,highWaterMark:1,...u});let y=!1;m._read=function(){y||(y=!0,v())},m._destroy=function(x,w){t(b(x),()=>e.nextTick(w,x),S=>e.nextTick(w,S||x))};async function b(x){const w=x!=null,S=typeof d.throw=="function";if(w&&S){const{value:C,done:k}=await d.throw(x);if(await C,k)return}if(typeof d.return=="function"){const{value:C}=await d.return();await C}}async function v(){for(;;){try{const{value:x,done:w}=h?await d.next():d.next();if(w)m.push(null);else{const S=x&&typeof x.then=="function"?await x:x;if(S===null)throw y=!1,new a;if(m.push(S))continue;y=!1}}catch(x){m.destroy(x)}break}}return m}return gM=o,gM}var yM,p9;function VE(){if(p9)return yM;p9=1;const e=Km(),{ArrayPrototypeIndexOf:t,NumberIsInteger:n,NumberIsNaN:r,NumberParseInt:s,ObjectDefineProperties:i,ObjectKeys:a,ObjectSetPrototypeOf:o,Promise:l,SafeSet:c,SymbolAsyncDispose:u,SymbolAsyncIterator:d,Symbol:h}=ei();yM=ke,ke.ReadableState=Be;const{EventEmitter:m}=zE(),{Stream:y,prependListener:b}=UO(),{Buffer:v}=Vh(),{addAbortSignal:x}=UE(),w=Wh();let S=Ro().debuglog("stream",fe=>{S=fe});const C=V_e(),k=qy(),{getHighWaterMark:A,getDefaultHighWaterMark:R}=qE(),{aggregateTwoErrors:N,codes:{ERR_INVALID_ARG_TYPE:I,ERR_METHOD_NOT_IMPLEMENTED:P,ERR_OUT_OF_RANGE:L,ERR_STREAM_PUSH_AFTER_EOF:O,ERR_STREAM_UNSHIFT_AFTER_END_EVENT:V},AbortError:D}=co(),{validateObject:Z}=b1(),U=h("kPaused"),{StringDecoder:H}=W_e(),$=YK();o(ke.prototype,y.prototype),o(ke,y);const ne=()=>{},{errorOrDestroy:W}=k,Q=1,ee=2,se=4,pe=8,ce=16,Ie=32,De=64,Se=128,Ce=256,qe=512,Qe=1024,Ve=2048,Ne=4096,K=8192,ge=16384,Ae=32768,le=65536,oe=1<<17,re=1<<18;function Te(fe){return{enumerable:!1,get(){return(this.state&fe)!==0},set(Y){Y?this.state|=fe:this.state&=~fe}}}i(Be.prototype,{objectMode:Te(Q),ended:Te(ee),endEmitted:Te(se),reading:Te(pe),constructed:Te(ce),sync:Te(Ie),needReadable:Te(De),emittedReadable:Te(Se),readableListening:Te(Ce),resumeScheduled:Te(qe),errorEmitted:Te(Qe),emitClose:Te(Ve),autoDestroy:Te(Ne),destroyed:Te(K),closed:Te(ge),closeEmitted:Te(Ae),multiAwaitDrain:Te(le),readingMore:Te(oe),dataEmitted:Te(re)});function Be(fe,Y,G){typeof G!="boolean"&&(G=Y instanceof Wd()),this.state=Ve|Ne|ce|Ie,fe&&fe.objectMode&&(this.state|=Q),G&&fe&&fe.readableObjectMode&&(this.state|=Q),this.highWaterMark=fe?A(this,fe,"readableHighWaterMark",G):R(!1),this.buffer=new C,this.length=0,this.pipes=[],this.flowing=null,this[U]=null,fe&&fe.emitClose===!1&&(this.state&=-2049),fe&&fe.autoDestroy===!1&&(this.state&=-4097),this.errored=null,this.defaultEncoding=fe&&fe.defaultEncoding||"utf8",this.awaitDrainWriters=null,this.decoder=null,this.encoding=null,fe&&fe.encoding&&(this.decoder=new H(fe.encoding),this.encoding=fe.encoding)}function ke(fe){if(!(this instanceof ke))return new ke(fe);const Y=this instanceof Wd();this._readableState=new Be(fe,this,Y),fe&&(typeof fe.read=="function"&&(this._read=fe.read),typeof fe.destroy=="function"&&(this._destroy=fe.destroy),typeof fe.construct=="function"&&(this._construct=fe.construct),fe.signal&&!Y&&x(fe.signal,this)),y.call(this,fe),k.construct(this,()=>{this._readableState.needReadable&&F(this,this._readableState)})}ke.prototype.destroy=k.destroy,ke.prototype._undestroy=k.undestroy,ke.prototype._destroy=function(fe,Y){Y(fe)},ke.prototype[m.captureRejectionSymbol]=function(fe){this.destroy(fe)},ke.prototype[u]=function(){let fe;return this.destroyed||(fe=this.readableEnded?null:new D,this.destroy(fe)),new l((Y,G)=>w(this,J=>J&&J!==fe?G(J):Y(null)))},ke.prototype.push=function(fe,Y){return lt(this,fe,Y,!1)},ke.prototype.unshift=function(fe,Y){return lt(this,fe,Y,!0)};function lt(fe,Y,G,J){S("readableAddChunk",Y);const ve=fe._readableState;let Oe;if((ve.state&Q)===0&&(typeof Y=="string"?(G=G||ve.defaultEncoding,ve.encoding!==G&&(J&&ve.encoding?Y=v.from(Y,G).toString(ve.encoding):(Y=v.from(Y,G),G=""))):Y instanceof v?G="":y._isUint8Array(Y)?(Y=y._uint8ArrayToBuffer(Y),G=""):Y!=null&&(Oe=new I("chunk",["string","Buffer","Uint8Array"],Y))),Oe)W(fe,Oe);else if(Y===null)ve.state&=-9,Lt(fe,ve);else if((ve.state&Q)!==0||Y&&Y.length>0)if(J)if((ve.state&se)!==0)W(fe,new V);else{if(ve.destroyed||ve.errored)return!1;Rt(fe,ve,Y,!0)}else if(ve.ended)W(fe,new O);else{if(ve.destroyed||ve.errored)return!1;ve.state&=-9,ve.decoder&&!G?(Y=ve.decoder.write(Y),ve.objectMode||Y.length!==0?Rt(fe,ve,Y,!1):F(fe,ve)):Rt(fe,ve,Y,!1)}else J||(ve.state&=-9,F(fe,ve));return!ve.ended&&(ve.length<ve.highWaterMark||ve.length===0)}function Rt(fe,Y,G,J){Y.flowing&&Y.length===0&&!Y.sync&&fe.listenerCount("data")>0?((Y.state&le)!==0?Y.awaitDrainWriters.clear():Y.awaitDrainWriters=null,Y.dataEmitted=!0,fe.emit("data",G)):(Y.length+=Y.objectMode?1:G.length,J?Y.buffer.unshift(G):Y.buffer.push(G),(Y.state&De)!==0&&en(fe)),F(fe,Y)}ke.prototype.isPaused=function(){const fe=this._readableState;return fe[U]===!0||fe.flowing===!1},ke.prototype.setEncoding=function(fe){const Y=new H(fe);this._readableState.decoder=Y,this._readableState.encoding=this._readableState.decoder.encoding;const G=this._readableState.buffer;let J="";for(const ve of G)J+=Y.write(ve);return G.clear(),J!==""&&G.push(J),this._readableState.length=J.length,this};const ht=1073741824;function Pt(fe){if(fe>ht)throw new L("size","<= 1GiB",fe);return fe--,fe|=fe>>>1,fe|=fe>>>2,fe|=fe>>>4,fe|=fe>>>8,fe|=fe>>>16,fe++,fe}function qt(fe,Y){return fe<=0||Y.length===0&&Y.ended?0:(Y.state&Q)!==0?1:r(fe)?Y.flowing&&Y.length?Y.buffer.first().length:Y.length:fe<=Y.length?fe:Y.ended?Y.length:0}ke.prototype.read=function(fe){S("read",fe),fe===void 0?fe=NaN:n(fe)||(fe=s(fe,10));const Y=this._readableState,G=fe;if(fe>Y.highWaterMark&&(Y.highWaterMark=Pt(fe)),fe!==0&&(Y.state&=-129),fe===0&&Y.needReadable&&((Y.highWaterMark!==0?Y.length>=Y.highWaterMark:Y.length>0)||Y.ended))return S("read: emitReadable",Y.length,Y.ended),Y.length===0&&Y.ended?st(this):en(this),null;if(fe=qt(fe,Y),fe===0&&Y.ended)return Y.length===0&&st(this),null;let J=(Y.state&De)!==0;if(S("need readable",J),(Y.length===0||Y.length-fe<Y.highWaterMark)&&(J=!0,S("length less than watermark",J)),Y.ended||Y.reading||Y.destroyed||Y.errored||!Y.constructed)J=!1,S("reading, ended or constructing",J);else if(J){S("do read"),Y.state|=pe|Ie,Y.length===0&&(Y.state|=De);try{this._read(Y.highWaterMark)}catch(Oe){W(this,Oe)}Y.state&=-33,Y.reading||(fe=qt(G,Y))}let ve;return fe>0?ve=ze(fe,Y):ve=null,ve===null?(Y.needReadable=Y.length<=Y.highWaterMark,fe=0):(Y.length-=fe,Y.multiAwaitDrain?Y.awaitDrainWriters.clear():Y.awaitDrainWriters=null),Y.length===0&&(Y.ended||(Y.needReadable=!0),G!==fe&&Y.ended&&st(this)),ve!==null&&!Y.errorEmitted&&!Y.closeEmitted&&(Y.dataEmitted=!0,this.emit("data",ve)),ve};function Lt(fe,Y){if(S("onEofChunk"),!Y.ended){if(Y.decoder){const G=Y.decoder.end();G&&G.length&&(Y.buffer.push(G),Y.length+=Y.objectMode?1:G.length)}Y.ended=!0,Y.sync?en(fe):(Y.needReadable=!1,Y.emittedReadable=!0,xe(fe))}}function en(fe){const Y=fe._readableState;S("emitReadable",Y.needReadable,Y.emittedReadable),Y.needReadable=!1,Y.emittedReadable||(S("emitReadable",Y.flowing),Y.emittedReadable=!0,e.nextTick(xe,fe))}function xe(fe){const Y=fe._readableState;S("emitReadable_",Y.destroyed,Y.length,Y.ended),!Y.destroyed&&!Y.errored&&(Y.length||Y.ended)&&(fe.emit("readable"),Y.emittedReadable=!1),Y.needReadable=!Y.flowing&&!Y.ended&&Y.length<=Y.highWaterMark,vt(fe)}function F(fe,Y){!Y.readingMore&&Y.constructed&&(Y.readingMore=!0,e.nextTick(X,fe,Y))}function X(fe,Y){for(;!Y.reading&&!Y.ended&&(Y.length<Y.highWaterMark||Y.flowing&&Y.length===0);){const G=Y.length;if(S("maybeReadMore read 0"),fe.read(0),G===Y.length)break}Y.readingMore=!1}ke.prototype._read=function(fe){throw new P("_read()")},ke.prototype.pipe=function(fe,Y){const G=this,J=this._readableState;J.pipes.length===1&&(J.multiAwaitDrain||(J.multiAwaitDrain=!0,J.awaitDrainWriters=new c(J.awaitDrainWriters?[J.awaitDrainWriters]:[]))),J.pipes.push(fe),S("pipe count=%d opts=%j",J.pipes.length,Y);const Oe=(!Y||Y.end!==!1)&&fe!==e.stdout&&fe!==e.stderr?_t:rs;J.endEmitted?e.nextTick(Oe):G.once("end",Oe),fe.on("unpipe",Ge);function Ge(Cr,hn){S("onunpipe"),Cr===G&&hn&&hn.hasUnpiped===!1&&(hn.hasUnpiped=!0,Xt())}function _t(){S("onend"),fe.end()}let tn,Un=!1;function Xt(){S("cleanup"),fe.removeListener("close",Rr),fe.removeListener("finish",ns),tn&&fe.removeListener("drain",tn),fe.removeListener("error",mr),fe.removeListener("unpipe",Ge),G.removeListener("end",_t),G.removeListener("end",rs),G.removeListener("data",un),Un=!0,tn&&J.awaitDrainWriters&&(!fe._writableState||fe._writableState.needDrain)&&tn()}function nn(){Un||(J.pipes.length===1&&J.pipes[0]===fe?(S("false write response, pause",0),J.awaitDrainWriters=fe,J.multiAwaitDrain=!1):J.pipes.length>1&&J.pipes.includes(fe)&&(S("false write response, pause",J.awaitDrainWriters.size),J.awaitDrainWriters.add(fe)),G.pause()),tn||(tn=ye(G,fe),fe.on("drain",tn))}G.on("data",un);function un(Cr){S("ondata");const hn=fe.write(Cr);S("dest.write",hn),hn===!1&&nn()}function mr(Cr){if(S("onerror",Cr),rs(),fe.removeListener("error",mr),fe.listenerCount("error")===0){const hn=fe._writableState||fe._readableState;hn&&!hn.errorEmitted?W(fe,Cr):fe.emit("error",Cr)}}b(fe,"error",mr);function Rr(){fe.removeListener("finish",ns),rs()}fe.once("close",Rr);function ns(){S("onfinish"),fe.removeListener("close",Rr),rs()}fe.once("finish",ns);function rs(){S("unpipe"),G.unpipe(fe)}return fe.emit("pipe",G),fe.writableNeedDrain===!0?nn():J.flowing||(S("pipe resume"),G.resume()),fe};function ye(fe,Y){return function(){const J=fe._readableState;J.awaitDrainWriters===Y?(S("pipeOnDrain",1),J.awaitDrainWriters=null):J.multiAwaitDrain&&(S("pipeOnDrain",J.awaitDrainWriters.size),J.awaitDrainWriters.delete(Y)),(!J.awaitDrainWriters||J.awaitDrainWriters.size===0)&&fe.listenerCount("data")&&fe.resume()}}ke.prototype.unpipe=function(fe){const Y=this._readableState,G={hasUnpiped:!1};if(Y.pipes.length===0)return this;if(!fe){const ve=Y.pipes;Y.pipes=[],this.pause();for(let Oe=0;Oe<ve.length;Oe++)ve[Oe].emit("unpipe",this,{hasUnpiped:!1});return this}const J=t(Y.pipes,fe);return J===-1?this:(Y.pipes.splice(J,1),Y.pipes.length===0&&this.pause(),fe.emit("unpipe",this,G),this)},ke.prototype.on=function(fe,Y){const G=y.prototype.on.call(this,fe,Y),J=this._readableState;return fe==="data"?(J.readableListening=this.listenerCount("readable")>0,J.flowing!==!1&&this.resume()):fe==="readable"&&!J.endEmitted&&!J.readableListening&&(J.readableListening=J.needReadable=!0,J.flowing=!1,J.emittedReadable=!1,S("on readable",J.length,J.reading),J.length?en(this):J.reading||e.nextTick(we,this)),G},ke.prototype.addListener=ke.prototype.on,ke.prototype.removeListener=function(fe,Y){const G=y.prototype.removeListener.call(this,fe,Y);return fe==="readable"&&e.nextTick(Fe,this),G},ke.prototype.off=ke.prototype.removeListener,ke.prototype.removeAllListeners=function(fe){const Y=y.prototype.removeAllListeners.apply(this,arguments);return(fe==="readable"||fe===void 0)&&e.nextTick(Fe,this),Y};function Fe(fe){const Y=fe._readableState;Y.readableListening=fe.listenerCount("readable")>0,Y.resumeScheduled&&Y[U]===!1?Y.flowing=!0:fe.listenerCount("data")>0?fe.resume():Y.readableListening||(Y.flowing=null)}function we(fe){S("readable nexttick read 0"),fe.read(0)}ke.prototype.resume=function(){const fe=this._readableState;return fe.flowing||(S("resume"),fe.flowing=!fe.readableListening,Me(this,fe)),fe[U]=!1,this};function Me(fe,Y){Y.resumeScheduled||(Y.resumeScheduled=!0,e.nextTick(de,fe,Y))}function de(fe,Y){S("resume",Y.reading),Y.reading||fe.read(0),Y.resumeScheduled=!1,fe.emit("resume"),vt(fe),Y.flowing&&!Y.reading&&fe.read(0)}ke.prototype.pause=function(){return S("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(S("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState[U]=!0,this};function vt(fe){const Y=fe._readableState;for(S("flow",Y.flowing);Y.flowing&&fe.read()!==null;);}ke.prototype.wrap=function(fe){let Y=!1;fe.on("data",J=>{!this.push(J)&&fe.pause&&(Y=!0,fe.pause())}),fe.on("end",()=>{this.push(null)}),fe.on("error",J=>{W(this,J)}),fe.on("close",()=>{this.destroy()}),fe.on("destroy",()=>{this.destroy()}),this._read=()=>{Y&&fe.resume&&(Y=!1,fe.resume())};const G=a(fe);for(let J=1;J<G.length;J++){const ve=G[J];this[ve]===void 0&&typeof fe[ve]=="function"&&(this[ve]=fe[ve].bind(fe))}return this},ke.prototype[d]=function(){return ot(this)},ke.prototype.iterator=function(fe){return fe!==void 0&&Z(fe,"options"),ot(this,fe)};function ot(fe,Y){typeof fe.read!="function"&&(fe=ke.wrap(fe,{objectMode:!0}));const G=B(fe,Y);return G.stream=fe,G}async function*B(fe,Y){let G=ne;function J(Ge){this===fe?(G(),G=ne):G=Ge}fe.on("readable",J);let ve;const Oe=w(fe,{writable:!1},Ge=>{ve=Ge?N(ve,Ge):null,G(),G=ne});try{for(;;){const Ge=fe.destroyed?null:fe.read();if(Ge!==null)yield Ge;else{if(ve)throw ve;if(ve===null)return;await new l(J)}}}catch(Ge){throw ve=N(ve,Ge),ve}finally{(ve||(Y==null?void 0:Y.destroyOnReturn)!==!1)&&(ve===void 0||fe._readableState.autoDestroy)?k.destroyer(fe,null):(fe.off("readable",J),Oe())}}i(ke.prototype,{readable:{__proto__:null,get(){const fe=this._readableState;return!!fe&&fe.readable!==!1&&!fe.destroyed&&!fe.errorEmitted&&!fe.endEmitted},set(fe){this._readableState&&(this._readableState.readable=!!fe)}},readableDidRead:{__proto__:null,enumerable:!1,get:function(){return this._readableState.dataEmitted}},readableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(this._readableState.readable!==!1&&(this._readableState.destroyed||this._readableState.errored)&&!this._readableState.endEmitted)}},readableHighWaterMark:{__proto__:null,enumerable:!1,get:function(){return this._readableState.highWaterMark}},readableBuffer:{__proto__:null,enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}},readableFlowing:{__proto__:null,enumerable:!1,get:function(){return this._readableState.flowing},set:function(fe){this._readableState&&(this._readableState.flowing=fe)}},readableLength:{__proto__:null,enumerable:!1,get(){return this._readableState.length}},readableObjectMode:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.objectMode:!1}},readableEncoding:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.encoding:null}},errored:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.errored:null}},closed:{__proto__:null,get(){return this._readableState?this._readableState.closed:!1}},destroyed:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.destroyed:!1},set(fe){this._readableState&&(this._readableState.destroyed=fe)}},readableEnded:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.endEmitted:!1}}}),i(Be.prototype,{pipesCount:{__proto__:null,get(){return this.pipes.length}},paused:{__proto__:null,get(){return this[U]!==!1},set(fe){this[U]=!!fe}}}),ke._fromList=ze;function ze(fe,Y){if(Y.length===0)return null;let G;return Y.objectMode?G=Y.buffer.shift():!fe||fe>=Y.length?(Y.decoder?G=Y.buffer.join(""):Y.buffer.length===1?G=Y.buffer.first():G=Y.buffer.concat(Y.length),Y.buffer.clear()):G=Y.buffer.consume(fe,Y.decoder),G}function st(fe){const Y=fe._readableState;S("endReadable",Y.endEmitted),Y.endEmitted||(Y.ended=!0,e.nextTick(be,Y,fe))}function be(fe,Y){if(S("endReadableNT",fe.endEmitted,fe.length),!fe.errored&&!fe.closeEmitted&&!fe.endEmitted&&fe.length===0){if(fe.endEmitted=!0,Y.emit("end"),Y.writable&&Y.allowHalfOpen===!1)e.nextTick(_e,Y);else if(fe.autoDestroy){const G=Y._writableState;(!G||G.autoDestroy&&(G.finished||G.writable===!1))&&Y.destroy()}}}function _e(fe){fe.writable&&!fe.writableEnded&&!fe.destroyed&&fe.end()}ke.from=function(fe,Y){return $(ke,fe,Y)};let Ue;function kt(){return Ue===void 0&&(Ue={}),Ue}return ke.fromWeb=function(fe,Y){return kt().newStreamReadableFromReadableStream(fe,Y)},ke.toWeb=function(fe,Y){return kt().newReadableStreamFromStreamReadable(fe,Y)},ke.wrap=function(fe,Y){var G,J;return new ke({objectMode:(G=(J=fe.readableObjectMode)!==null&&J!==void 0?J:fe.objectMode)!==null&&G!==void 0?G:!0,...Y,destroy(ve,Oe){k.destroyer(fe,ve),Oe(ve)}}).wrap(fe)},yM}var bM,m9;function VO(){if(m9)return bM;m9=1;const e=Km(),{ArrayPrototypeSlice:t,Error:n,FunctionPrototypeSymbolHasInstance:r,ObjectDefineProperty:s,ObjectDefineProperties:i,ObjectSetPrototypeOf:a,StringPrototypeToLowerCase:o,Symbol:l,SymbolHasInstance:c}=ei();bM=Z,Z.WritableState=V;const{EventEmitter:u}=zE(),d=UO().Stream,{Buffer:h}=Vh(),m=qy(),{addAbortSignal:y}=UE(),{getHighWaterMark:b,getDefaultHighWaterMark:v}=qE(),{ERR_INVALID_ARG_TYPE:x,ERR_METHOD_NOT_IMPLEMENTED:w,ERR_MULTIPLE_CALLBACK:S,ERR_STREAM_CANNOT_PIPE:C,ERR_STREAM_DESTROYED:k,ERR_STREAM_ALREADY_FINISHED:A,ERR_STREAM_NULL_VALUES:R,ERR_STREAM_WRITE_AFTER_END:N,ERR_UNKNOWN_ENCODING:I}=co().codes,{errorOrDestroy:P}=m;a(Z.prototype,d.prototype),a(Z,d);function L(){}const O=l("kOnFinished");function V(Ne,K,ge){typeof ge!="boolean"&&(ge=K instanceof Wd()),this.objectMode=!!(Ne&&Ne.objectMode),ge&&(this.objectMode=this.objectMode||!!(Ne&&Ne.writableObjectMode)),this.highWaterMark=Ne?b(this,Ne,"writableHighWaterMark",ge):v(!1),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;const Ae=!!(Ne&&Ne.decodeStrings===!1);this.decodeStrings=!Ae,this.defaultEncoding=Ne&&Ne.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=W.bind(void 0,K),this.writecb=null,this.writelen=0,this.afterWriteTickInfo=null,D(this),this.pendingcb=0,this.constructed=!0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!Ne||Ne.emitClose!==!1,this.autoDestroy=!Ne||Ne.autoDestroy!==!1,this.errored=null,this.closed=!1,this.closeEmitted=!1,this[O]=[]}function D(Ne){Ne.buffered=[],Ne.bufferedIndex=0,Ne.allBuffers=!0,Ne.allNoop=!0}V.prototype.getBuffer=function(){return t(this.buffered,this.bufferedIndex)},s(V.prototype,"bufferedRequestCount",{__proto__:null,get(){return this.buffered.length-this.bufferedIndex}});function Z(Ne){const K=this instanceof Wd();if(!K&&!r(Z,this))return new Z(Ne);this._writableState=new V(Ne,this,K),Ne&&(typeof Ne.write=="function"&&(this._write=Ne.write),typeof Ne.writev=="function"&&(this._writev=Ne.writev),typeof Ne.destroy=="function"&&(this._destroy=Ne.destroy),typeof Ne.final=="function"&&(this._final=Ne.final),typeof Ne.construct=="function"&&(this._construct=Ne.construct),Ne.signal&&y(Ne.signal,this)),d.call(this,Ne),m.construct(this,()=>{const ge=this._writableState;ge.writing||pe(this,ge),Se(this,ge)})}s(Z,c,{__proto__:null,value:function(Ne){return r(this,Ne)?!0:this!==Z?!1:Ne&&Ne._writableState instanceof V}}),Z.prototype.pipe=function(){P(this,new C)};function U(Ne,K,ge,Ae){const le=Ne._writableState;if(typeof ge=="function")Ae=ge,ge=le.defaultEncoding;else{if(!ge)ge=le.defaultEncoding;else if(ge!=="buffer"&&!h.isEncoding(ge))throw new I(ge);typeof Ae!="function"&&(Ae=L)}if(K===null)throw new R;if(!le.objectMode)if(typeof K=="string")le.decodeStrings!==!1&&(K=h.from(K,ge),ge="buffer");else if(K instanceof h)ge="buffer";else if(d._isUint8Array(K))K=d._uint8ArrayToBuffer(K),ge="buffer";else throw new x("chunk",["string","Buffer","Uint8Array"],K);let oe;return le.ending?oe=new N:le.destroyed&&(oe=new k("write")),oe?(e.nextTick(Ae,oe),P(Ne,oe,!0),oe):(le.pendingcb++,H(Ne,le,K,ge,Ae))}Z.prototype.write=function(Ne,K,ge){return U(this,Ne,K,ge)===!0},Z.prototype.cork=function(){this._writableState.corked++},Z.prototype.uncork=function(){const Ne=this._writableState;Ne.corked&&(Ne.corked--,Ne.writing||pe(this,Ne))},Z.prototype.setDefaultEncoding=function(K){if(typeof K=="string"&&(K=o(K)),!h.isEncoding(K))throw new I(K);return this._writableState.defaultEncoding=K,this};function H(Ne,K,ge,Ae,le){const oe=K.objectMode?1:ge.length;K.length+=oe;const re=K.length<K.highWaterMark;return re||(K.needDrain=!0),K.writing||K.corked||K.errored||!K.constructed?(K.buffered.push({chunk:ge,encoding:Ae,callback:le}),K.allBuffers&&Ae!=="buffer"&&(K.allBuffers=!1),K.allNoop&&le!==L&&(K.allNoop=!1)):(K.writelen=oe,K.writecb=le,K.writing=!0,K.sync=!0,Ne._write(ge,Ae,K.onwrite),K.sync=!1),re&&!K.errored&&!K.destroyed}function $(Ne,K,ge,Ae,le,oe,re){K.writelen=Ae,K.writecb=re,K.writing=!0,K.sync=!0,K.destroyed?K.onwrite(new k("write")):ge?Ne._writev(le,K.onwrite):Ne._write(le,oe,K.onwrite),K.sync=!1}function ne(Ne,K,ge,Ae){--K.pendingcb,Ae(ge),se(K),P(Ne,ge)}function W(Ne,K){const ge=Ne._writableState,Ae=ge.sync,le=ge.writecb;if(typeof le!="function"){P(Ne,new S);return}ge.writing=!1,ge.writecb=null,ge.length-=ge.writelen,ge.writelen=0,K?(K.stack,ge.errored||(ge.errored=K),Ne._readableState&&!Ne._readableState.errored&&(Ne._readableState.errored=K),Ae?e.nextTick(ne,Ne,ge,K,le):ne(Ne,ge,K,le)):(ge.buffered.length>ge.bufferedIndex&&pe(Ne,ge),Ae?ge.afterWriteTickInfo!==null&&ge.afterWriteTickInfo.cb===le?ge.afterWriteTickInfo.count++:(ge.afterWriteTickInfo={count:1,cb:le,stream:Ne,state:ge},e.nextTick(Q,ge.afterWriteTickInfo)):ee(Ne,ge,1,le))}function Q({stream:Ne,state:K,count:ge,cb:Ae}){return K.afterWriteTickInfo=null,ee(Ne,K,ge,Ae)}function ee(Ne,K,ge,Ae){for(!K.ending&&!Ne.destroyed&&K.length===0&&K.needDrain&&(K.needDrain=!1,Ne.emit("drain"));ge-- >0;)K.pendingcb--,Ae();K.destroyed&&se(K),Se(Ne,K)}function se(Ne){if(Ne.writing)return;for(let le=Ne.bufferedIndex;le<Ne.buffered.length;++le){var K;const{chunk:oe,callback:re}=Ne.buffered[le],Te=Ne.objectMode?1:oe.length;Ne.length-=Te,re((K=Ne.errored)!==null&&K!==void 0?K:new k("write"))}const ge=Ne[O].splice(0);for(let le=0;le<ge.length;le++){var Ae;ge[le]((Ae=Ne.errored)!==null&&Ae!==void 0?Ae:new k("end"))}D(Ne)}function pe(Ne,K){if(K.corked||K.bufferProcessing||K.destroyed||!K.constructed)return;const{buffered:ge,bufferedIndex:Ae,objectMode:le}=K,oe=ge.length-Ae;if(!oe)return;let re=Ae;if(K.bufferProcessing=!0,oe>1&&Ne._writev){K.pendingcb-=oe-1;const Te=K.allNoop?L:ke=>{for(let lt=re;lt<ge.length;++lt)ge[lt].callback(ke)},Be=K.allNoop&&re===0?ge:t(ge,re);Be.allBuffers=K.allBuffers,$(Ne,K,!0,K.length,Be,"",Te),D(K)}else{do{const{chunk:Te,encoding:Be,callback:ke}=ge[re];ge[re++]=null;const lt=le?1:Te.length;$(Ne,K,!1,lt,Te,Be,ke)}while(re<ge.length&&!K.writing);re===ge.length?D(K):re>256?(ge.splice(0,re),K.bufferedIndex=0):K.bufferedIndex=re}K.bufferProcessing=!1}Z.prototype._write=function(Ne,K,ge){if(this._writev)this._writev([{chunk:Ne,encoding:K}],ge);else throw new w("_write()")},Z.prototype._writev=null,Z.prototype.end=function(Ne,K,ge){const Ae=this._writableState;typeof Ne=="function"?(ge=Ne,Ne=null,K=null):typeof K=="function"&&(ge=K,K=null);let le;if(Ne!=null){const oe=U(this,Ne,K);oe instanceof n&&(le=oe)}return Ae.corked&&(Ae.corked=1,this.uncork()),le||(!Ae.errored&&!Ae.ending?(Ae.ending=!0,Se(this,Ae,!0),Ae.ended=!0):Ae.finished?le=new A("end"):Ae.destroyed&&(le=new k("end"))),typeof ge=="function"&&(le||Ae.finished?e.nextTick(ge,le):Ae[O].push(ge)),this};function ce(Ne){return Ne.ending&&!Ne.destroyed&&Ne.constructed&&Ne.length===0&&!Ne.errored&&Ne.buffered.length===0&&!Ne.finished&&!Ne.writing&&!Ne.errorEmitted&&!Ne.closeEmitted}function Ie(Ne,K){let ge=!1;function Ae(le){if(ge){P(Ne,le??S());return}if(ge=!0,K.pendingcb--,le){const oe=K[O].splice(0);for(let re=0;re<oe.length;re++)oe[re](le);P(Ne,le,K.sync)}else ce(K)&&(K.prefinished=!0,Ne.emit("prefinish"),K.pendingcb++,e.nextTick(Ce,Ne,K))}K.sync=!0,K.pendingcb++;try{Ne._final(Ae)}catch(le){Ae(le)}K.sync=!1}function De(Ne,K){!K.prefinished&&!K.finalCalled&&(typeof Ne._final=="function"&&!K.destroyed?(K.finalCalled=!0,Ie(Ne,K)):(K.prefinished=!0,Ne.emit("prefinish")))}function Se(Ne,K,ge){ce(K)&&(De(Ne,K),K.pendingcb===0&&(ge?(K.pendingcb++,e.nextTick((Ae,le)=>{ce(le)?Ce(Ae,le):le.pendingcb--},Ne,K)):ce(K)&&(K.pendingcb++,Ce(Ne,K))))}function Ce(Ne,K){K.pendingcb--,K.finished=!0;const ge=K[O].splice(0);for(let Ae=0;Ae<ge.length;Ae++)ge[Ae]();if(Ne.emit("finish"),K.autoDestroy){const Ae=Ne._readableState;(!Ae||Ae.autoDestroy&&(Ae.endEmitted||Ae.readable===!1))&&Ne.destroy()}}i(Z.prototype,{closed:{__proto__:null,get(){return this._writableState?this._writableState.closed:!1}},destroyed:{__proto__:null,get(){return this._writableState?this._writableState.destroyed:!1},set(Ne){this._writableState&&(this._writableState.destroyed=Ne)}},writable:{__proto__:null,get(){const Ne=this._writableState;return!!Ne&&Ne.writable!==!1&&!Ne.destroyed&&!Ne.errored&&!Ne.ending&&!Ne.ended},set(Ne){this._writableState&&(this._writableState.writable=!!Ne)}},writableFinished:{__proto__:null,get(){return this._writableState?this._writableState.finished:!1}},writableObjectMode:{__proto__:null,get(){return this._writableState?this._writableState.objectMode:!1}},writableBuffer:{__proto__:null,get(){return this._writableState&&this._writableState.getBuffer()}},writableEnded:{__proto__:null,get(){return this._writableState?this._writableState.ending:!1}},writableNeedDrain:{__proto__:null,get(){const Ne=this._writableState;return Ne?!Ne.destroyed&&!Ne.ending&&Ne.needDrain:!1}},writableHighWaterMark:{__proto__:null,get(){return this._writableState&&this._writableState.highWaterMark}},writableCorked:{__proto__:null,get(){return this._writableState?this._writableState.corked:0}},writableLength:{__proto__:null,get(){return this._writableState&&this._writableState.length}},errored:{__proto__:null,enumerable:!1,get(){return this._writableState?this._writableState.errored:null}},writableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(this._writableState.writable!==!1&&(this._writableState.destroyed||this._writableState.errored)&&!this._writableState.finished)}}});const qe=m.destroy;Z.prototype.destroy=function(Ne,K){const ge=this._writableState;return!ge.destroyed&&(ge.bufferedIndex<ge.buffered.length||ge[O].length)&&e.nextTick(se,ge),qe.call(this,Ne,K),this},Z.prototype._undestroy=m.undestroy,Z.prototype._destroy=function(Ne,K){K(Ne)},Z.prototype[u.captureRejectionSymbol]=function(Ne){this.destroy(Ne)};let Qe;function Ve(){return Qe===void 0&&(Qe={}),Qe}return Z.fromWeb=function(Ne,K){return Ve().newStreamWritableFromWritableStream(Ne,K)},Z.toWeb=function(Ne){return Ve().newWritableStreamFromStreamWritable(Ne)},bM}var vM,g9;function H_e(){if(g9)return vM;g9=1;const e=Km(),t=Vh(),{isReadable:n,isWritable:r,isIterable:s,isNodeStream:i,isReadableNodeStream:a,isWritableNodeStream:o,isDuplexNodeStream:l,isReadableStream:c,isWritableStream:u}=nf(),d=Wh(),{AbortError:h,codes:{ERR_INVALID_ARG_TYPE:m,ERR_INVALID_RETURN_VALUE:y}}=co(),{destroyer:b}=qy(),v=Wd(),x=VE(),w=VO(),{createDeferredPromise:S}=Ro(),C=YK(),k=globalThis.Blob||t.Blob,A=typeof k<"u"?function(V){return V instanceof k}:function(V){return!1},R=globalThis.AbortController||sw().AbortController,{FunctionPrototypeCall:N}=ei();class I extends v{constructor(V){super(V),(V==null?void 0:V.readable)===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),(V==null?void 0:V.writable)===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)}}vM=function O(V,D){if(l(V))return V;if(a(V))return L({readable:V});if(o(V))return L({writable:V});if(i(V))return L({writable:!1,readable:!1});if(c(V))return L({readable:x.fromWeb(V)});if(u(V))return L({writable:w.fromWeb(V)});if(typeof V=="function"){const{value:U,write:H,final:$,destroy:ne}=P(V);if(s(U))return C(I,U,{objectMode:!0,write:H,final:$,destroy:ne});const W=U==null?void 0:U.then;if(typeof W=="function"){let Q;const ee=N(W,U,se=>{if(se!=null)throw new y("nully","body",se)},se=>{b(Q,se)});return Q=new I({objectMode:!0,readable:!1,write:H,final(se){$(async()=>{try{await ee,e.nextTick(se,null)}catch(pe){e.nextTick(se,pe)}})},destroy:ne})}throw new y("Iterable, AsyncIterable or AsyncFunction",D,U)}if(A(V))return O(V.arrayBuffer());if(s(V))return C(I,V,{objectMode:!0,writable:!1});if(c(V==null?void 0:V.readable)&&u(V==null?void 0:V.writable))return I.fromWeb(V);if(typeof(V==null?void 0:V.writable)=="object"||typeof(V==null?void 0:V.readable)=="object"){const U=V!=null&&V.readable?a(V==null?void 0:V.readable)?V==null?void 0:V.readable:O(V.readable):void 0,H=V!=null&&V.writable?o(V==null?void 0:V.writable)?V==null?void 0:V.writable:O(V.writable):void 0;return L({readable:U,writable:H})}const Z=V==null?void 0:V.then;if(typeof Z=="function"){let U;return N(Z,V,H=>{H!=null&&U.push(H),U.push(null)},H=>{b(U,H)}),U=new I({objectMode:!0,writable:!1,read(){}})}throw new m(D,["Blob","ReadableStream","WritableStream","Stream","Iterable","AsyncIterable","Function","{ readable, writable } pair","Promise"],V)};function P(O){let{promise:V,resolve:D}=S();const Z=new R,U=Z.signal;return{value:O(async function*(){for(;;){const $=V;V=null;const{chunk:ne,done:W,cb:Q}=await $;if(e.nextTick(Q),W)return;if(U.aborted)throw new h(void 0,{cause:U.reason});({promise:V,resolve:D}=S()),yield ne}}(),{signal:U}),write($,ne,W){const Q=D;D=null,Q({chunk:$,done:!1,cb:W})},final($){const ne=D;D=null,ne({done:!0,cb:$})},destroy($,ne){Z.abort(),ne($)}}}function L(O){const V=O.readable&&typeof O.readable.read!="function"?x.wrap(O.readable):O.readable,D=O.writable;let Z=!!n(V),U=!!r(D),H,$,ne,W,Q;function ee(se){const pe=W;W=null,pe?pe(se):se&&Q.destroy(se)}return Q=new I({readableObjectMode:!!(V!=null&&V.readableObjectMode),writableObjectMode:!!(D!=null&&D.writableObjectMode),readable:Z,writable:U}),U&&(d(D,se=>{U=!1,se&&b(V,se),ee(se)}),Q._write=function(se,pe,ce){D.write(se,pe)?ce():H=ce},Q._final=function(se){D.end(),$=se},D.on("drain",function(){if(H){const se=H;H=null,se()}}),D.on("finish",function(){if($){const se=$;$=null,se()}})),Z&&(d(V,se=>{Z=!1,se&&b(V,se),ee(se)}),V.on("readable",function(){if(ne){const se=ne;ne=null,se()}}),V.on("end",function(){Q.push(null)}),Q._read=function(){for(;;){const se=V.read();if(se===null){ne=Q._read;return}if(!Q.push(se))return}}),Q._destroy=function(se,pe){!se&&W!==null&&(se=new h),ne=null,H=null,$=null,W===null?pe(se):(W=pe,b(D,se),b(V,se))},Q}return vM}var xM,y9;function Wd(){if(y9)return xM;y9=1;const{ObjectDefineProperties:e,ObjectGetOwnPropertyDescriptor:t,ObjectKeys:n,ObjectSetPrototypeOf:r}=ei();xM=a;const s=VE(),i=VO();r(a.prototype,s.prototype),r(a,s);{const u=n(i.prototype);for(let d=0;d<u.length;d++){const h=u[d];a.prototype[h]||(a.prototype[h]=i.prototype[h])}}function a(u){if(!(this instanceof a))return new a(u);s.call(this,u),i.call(this,u),u?(this.allowHalfOpen=u.allowHalfOpen!==!1,u.readable===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),u.writable===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)):this.allowHalfOpen=!0}e(a.prototype,{writable:{__proto__:null,...t(i.prototype,"writable")},writableHighWaterMark:{__proto__:null,...t(i.prototype,"writableHighWaterMark")},writableObjectMode:{__proto__:null,...t(i.prototype,"writableObjectMode")},writableBuffer:{__proto__:null,...t(i.prototype,"writableBuffer")},writableLength:{__proto__:null,...t(i.prototype,"writableLength")},writableFinished:{__proto__:null,...t(i.prototype,"writableFinished")},writableCorked:{__proto__:null,...t(i.prototype,"writableCorked")},writableEnded:{__proto__:null,...t(i.prototype,"writableEnded")},writableNeedDrain:{__proto__:null,...t(i.prototype,"writableNeedDrain")},destroyed:{__proto__:null,get(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set(u){this._readableState&&this._writableState&&(this._readableState.destroyed=u,this._writableState.destroyed=u)}}});let o;function l(){return o===void 0&&(o={}),o}a.fromWeb=function(u,d){return l().newStreamDuplexFromReadableWritablePair(u,d)},a.toWeb=function(u){return l().newReadableWritablePairFromDuplex(u)};let c;return a.from=function(u){return c||(c=H_e()),c(u,"body")},xM}var wM,b9;function ZK(){if(b9)return wM;b9=1;const{ObjectSetPrototypeOf:e,Symbol:t}=ei();wM=a;const{ERR_METHOD_NOT_IMPLEMENTED:n}=co().codes,r=Wd(),{getHighWaterMark:s}=qE();e(a.prototype,r.prototype),e(a,r);const i=t("kCallback");function a(c){if(!(this instanceof a))return new a(c);const u=c?s(this,c,"readableHighWaterMark",!0):null;u===0&&(c={...c,highWaterMark:null,readableHighWaterMark:u,writableHighWaterMark:c.writableHighWaterMark||0}),r.call(this,c),this._readableState.sync=!1,this[i]=null,c&&(typeof c.transform=="function"&&(this._transform=c.transform),typeof c.flush=="function"&&(this._flush=c.flush)),this.on("prefinish",l)}function o(c){typeof this._flush=="function"&&!this.destroyed?this._flush((u,d)=>{if(u){c?c(u):this.destroy(u);return}d!=null&&this.push(d),this.push(null),c&&c()}):(this.push(null),c&&c())}function l(){this._final!==o&&o.call(this)}return a.prototype._final=o,a.prototype._transform=function(c,u,d){throw new n("_transform()")},a.prototype._write=function(c,u,d){const h=this._readableState,m=this._writableState,y=h.length;this._transform(c,u,(b,v)=>{if(b){d(b);return}v!=null&&this.push(v),m.ended||y===h.length||h.length<h.highWaterMark?d():this[i]=d})},a.prototype._read=function(){if(this[i]){const c=this[i];this[i]=null,c()}},wM}var _M,v9;function XK(){if(v9)return _M;v9=1;const{ObjectSetPrototypeOf:e}=ei();_M=n;const t=ZK();e(n.prototype,t.prototype),e(n,t);function n(r){if(!(this instanceof n))return new n(r);t.call(this,r)}return n.prototype._transform=function(r,s,i){i(null,r)},_M}var SM,x9;function WO(){if(x9)return SM;x9=1;const e=Km(),{ArrayIsArray:t,Promise:n,SymbolAsyncIterator:r,SymbolDispose:s}=ei(),i=Wh(),{once:a}=Ro(),o=qy(),l=Wd(),{aggregateTwoErrors:c,codes:{ERR_INVALID_ARG_TYPE:u,ERR_INVALID_RETURN_VALUE:d,ERR_MISSING_ARGS:h,ERR_STREAM_DESTROYED:m,ERR_STREAM_PREMATURE_CLOSE:y},AbortError:b}=co(),{validateFunction:v,validateAbortSignal:x}=b1(),{isIterable:w,isReadable:S,isReadableNodeStream:C,isNodeStream:k,isTransformStream:A,isWebStream:R,isReadableStream:N,isReadableFinished:I}=nf(),P=globalThis.AbortController||sw().AbortController;let L,O,V;function D(se,pe,ce){let Ie=!1;se.on("close",()=>{Ie=!0});const De=i(se,{readable:pe,writable:ce},Se=>{Ie=!Se});return{destroy:Se=>{Ie||(Ie=!0,o.destroyer(se,Se||new m("pipe")))},cleanup:De}}function Z(se){return v(se[se.length-1],"streams[stream.length - 1]"),se.pop()}function U(se){if(w(se))return se;if(C(se))return H(se);throw new u("val",["Readable","Iterable","AsyncIterable"],se)}async function*H(se){O||(O=VE()),yield*O.prototype[r].call(se)}async function $(se,pe,ce,{end:Ie}){let De,Se=null;const Ce=Ve=>{if(Ve&&(De=Ve),Se){const Ne=Se;Se=null,Ne()}},qe=()=>new n((Ve,Ne)=>{De?Ne(De):Se=()=>{De?Ne(De):Ve()}});pe.on("drain",Ce);const Qe=i(pe,{readable:!1},Ce);try{pe.writableNeedDrain&&await qe();for await(const Ve of se)pe.write(Ve)||await qe();Ie&&(pe.end(),await qe()),ce()}catch(Ve){ce(De!==Ve?c(De,Ve):Ve)}finally{Qe(),pe.off("drain",Ce)}}async function ne(se,pe,ce,{end:Ie}){A(pe)&&(pe=pe.writable);const De=pe.getWriter();try{for await(const Se of se)await De.ready,De.write(Se).catch(()=>{});await De.ready,Ie&&await De.close(),ce()}catch(Se){try{await De.abort(Se),ce(Se)}catch(Ce){ce(Ce)}}}function W(...se){return Q(se,a(Z(se)))}function Q(se,pe,ce){if(se.length===1&&t(se[0])&&(se=se[0]),se.length<2)throw new h("streams");const Ie=new P,De=Ie.signal,Se=ce==null?void 0:ce.signal,Ce=[];x(Se,"options.signal");function qe(){le(new b)}V=V||Ro().addAbortListener;let Qe;Se&&(Qe=V(Se,qe));let Ve,Ne;const K=[];let ge=0;function Ae(Be){le(Be,--ge===0)}function le(Be,ke){var lt;if(Be&&(!Ve||Ve.code==="ERR_STREAM_PREMATURE_CLOSE")&&(Ve=Be),!(!Ve&&!ke)){for(;K.length;)K.shift()(Ve);(lt=Qe)===null||lt===void 0||lt[s](),Ie.abort(),ke&&(Ve||Ce.forEach(Rt=>Rt()),e.nextTick(pe,Ve,Ne))}}let oe;for(let Be=0;Be<se.length;Be++){const ke=se[Be],lt=Be<se.length-1,Rt=Be>0,ht=lt||(ce==null?void 0:ce.end)!==!1,Pt=Be===se.length-1;if(k(ke)){let qt=function(Lt){Lt&&Lt.name!=="AbortError"&&Lt.code!=="ERR_STREAM_PREMATURE_CLOSE"&&Ae(Lt)};if(ht){const{destroy:Lt,cleanup:en}=D(ke,lt,Rt);K.push(Lt),S(ke)&&Pt&&Ce.push(en)}ke.on("error",qt),S(ke)&&Pt&&Ce.push(()=>{ke.removeListener("error",qt)})}if(Be===0)if(typeof ke=="function"){if(oe=ke({signal:De}),!w(oe))throw new d("Iterable, AsyncIterable or Stream","source",oe)}else w(ke)||C(ke)||A(ke)?oe=ke:oe=l.from(ke);else if(typeof ke=="function"){if(A(oe)){var re;oe=U((re=oe)===null||re===void 0?void 0:re.readable)}else oe=U(oe);if(oe=ke(oe,{signal:De}),lt){if(!w(oe,!0))throw new d("AsyncIterable",`transform[${Be-1}]`,oe)}else{var Te;L||(L=XK());const qt=new L({objectMode:!0}),Lt=(Te=oe)===null||Te===void 0?void 0:Te.then;if(typeof Lt=="function")ge++,Lt.call(oe,F=>{Ne=F,F!=null&&qt.write(F),ht&&qt.end(),e.nextTick(Ae)},F=>{qt.destroy(F),e.nextTick(Ae,F)});else if(w(oe,!0))ge++,$(oe,qt,Ae,{end:ht});else if(N(oe)||A(oe)){const F=oe.readable||oe;ge++,$(F,qt,Ae,{end:ht})}else throw new d("AsyncIterable or Promise","destination",oe);oe=qt;const{destroy:en,cleanup:xe}=D(oe,!1,!0);K.push(en),Pt&&Ce.push(xe)}}else if(k(ke)){if(C(oe)){ge+=2;const qt=ee(oe,ke,Ae,{end:ht});S(ke)&&Pt&&Ce.push(qt)}else if(A(oe)||N(oe)){const qt=oe.readable||oe;ge++,$(qt,ke,Ae,{end:ht})}else if(w(oe))ge++,$(oe,ke,Ae,{end:ht});else throw new u("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],oe);oe=ke}else if(R(ke)){if(C(oe))ge++,ne(U(oe),ke,Ae,{end:ht});else if(N(oe)||w(oe))ge++,ne(oe,ke,Ae,{end:ht});else if(A(oe))ge++,ne(oe.readable,ke,Ae,{end:ht});else throw new u("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],oe);oe=ke}else oe=l.from(ke)}return(De!=null&&De.aborted||Se!=null&&Se.aborted)&&e.nextTick(qe),oe}function ee(se,pe,ce,{end:Ie}){let De=!1;if(pe.on("close",()=>{De||ce(new y)}),se.pipe(pe,{end:!1}),Ie){let Se=function(){De=!0,pe.end()};I(se)?e.nextTick(Se):se.once("end",Se)}else ce();return i(se,{readable:!0,writable:!1},Se=>{const Ce=se._readableState;Se&&Se.code==="ERR_STREAM_PREMATURE_CLOSE"&&Ce&&Ce.ended&&!Ce.errored&&!Ce.errorEmitted?se.once("end",ce).once("error",ce):ce(Se)}),i(pe,{readable:!1,writable:!0},ce)}return SM={pipelineImpl:Q,pipeline:W},SM}var CM,w9;function JK(){if(w9)return CM;w9=1;const{pipeline:e}=WO(),t=Wd(),{destroyer:n}=qy(),{isNodeStream:r,isReadable:s,isWritable:i,isWebStream:a,isTransformStream:o,isWritableStream:l,isReadableStream:c}=nf(),{AbortError:u,codes:{ERR_INVALID_ARG_VALUE:d,ERR_MISSING_ARGS:h}}=co(),m=Wh();return CM=function(...b){if(b.length===0)throw new h("streams");if(b.length===1)return t.from(b[0]);const v=[...b];if(typeof b[0]=="function"&&(b[0]=t.from(b[0])),typeof b[b.length-1]=="function"){const L=b.length-1;b[L]=t.from(b[L])}for(let L=0;L<b.length;++L)if(!(!r(b[L])&&!a(b[L]))){if(L<b.length-1&&!(s(b[L])||c(b[L])||o(b[L])))throw new d(`streams[${L}]`,v[L],"must be readable");if(L>0&&!(i(b[L])||l(b[L])||o(b[L])))throw new d(`streams[${L}]`,v[L],"must be writable")}let x,w,S,C,k;function A(L){const O=C;C=null,O?O(L):L?k.destroy(L):!P&&!I&&k.destroy()}const R=b[0],N=e(b,A),I=!!(i(R)||l(R)||o(R)),P=!!(s(N)||c(N)||o(N));if(k=new t({writableObjectMode:!!(R!=null&&R.writableObjectMode),readableObjectMode:!!(N!=null&&N.readableObjectMode),writable:I,readable:P}),I){if(r(R))k._write=function(O,V,D){R.write(O,V)?D():x=D},k._final=function(O){R.end(),w=O},R.on("drain",function(){if(x){const O=x;x=null,O()}});else if(a(R)){const V=(o(R)?R.writable:R).getWriter();k._write=async function(D,Z,U){try{await V.ready,V.write(D).catch(()=>{}),U()}catch(H){U(H)}},k._final=async function(D){try{await V.ready,V.close().catch(()=>{}),w=D}catch(Z){D(Z)}}}const L=o(N)?N.readable:N;m(L,()=>{if(w){const O=w;w=null,O()}})}if(P){if(r(N))N.on("readable",function(){if(S){const L=S;S=null,L()}}),N.on("end",function(){k.push(null)}),k._read=function(){for(;;){const L=N.read();if(L===null){S=k._read;return}if(!k.push(L))return}};else if(a(N)){const O=(o(N)?N.readable:N).getReader();k._read=async function(){for(;;)try{const{value:V,done:D}=await O.read();if(!k.push(V))return;if(D){k.push(null);return}}catch{return}}}}return k._destroy=function(L,O){!L&&C!==null&&(L=new u),S=null,x=null,w=null,C===null?O(L):(C=O,r(N)&&n(N,L))},k},CM}var _9;function G_e(){if(_9)return MS;_9=1;const e=globalThis.AbortController||sw().AbortController,{codes:{ERR_INVALID_ARG_VALUE:t,ERR_INVALID_ARG_TYPE:n,ERR_MISSING_ARGS:r,ERR_OUT_OF_RANGE:s},AbortError:i}=co(),{validateAbortSignal:a,validateInteger:o,validateObject:l}=b1(),c=ei().Symbol("kWeak"),u=ei().Symbol("kResistStopPropagation"),{finished:d}=Wh(),h=JK(),{addAbortSignalNoValidate:m}=UE(),{isWritable:y,isNodeStream:b}=nf(),{deprecate:v}=Ro(),{ArrayPrototypePush:x,Boolean:w,MathFloor:S,Number:C,NumberIsNaN:k,Promise:A,PromiseReject:R,PromiseResolve:N,PromisePrototypeThen:I,Symbol:P}=ei(),L=P("kEmpty"),O=P("kEof");function V(Se,Ce){if(Ce!=null&&l(Ce,"options"),(Ce==null?void 0:Ce.signal)!=null&&a(Ce.signal,"options.signal"),b(Se)&&!y(Se))throw new t("stream",Se,"must be writable");const qe=h(this,Se);return Ce!=null&&Ce.signal&&m(Ce.signal,qe),qe}function D(Se,Ce){if(typeof Se!="function")throw new n("fn",["Function","AsyncFunction"],Se);Ce!=null&&l(Ce,"options"),(Ce==null?void 0:Ce.signal)!=null&&a(Ce.signal,"options.signal");let qe=1;(Ce==null?void 0:Ce.concurrency)!=null&&(qe=S(Ce.concurrency));let Qe=qe-1;return(Ce==null?void 0:Ce.highWaterMark)!=null&&(Qe=S(Ce.highWaterMark)),o(qe,"options.concurrency",1),o(Qe,"options.highWaterMark",0),Qe+=qe,(async function*(){const Ne=Ro().AbortSignalAny([Ce==null?void 0:Ce.signal].filter(w)),K=this,ge=[],Ae={signal:Ne};let le,oe,re=!1,Te=0;function Be(){re=!0,ke()}function ke(){Te-=1,lt()}function lt(){oe&&!re&&Te<qe&&ge.length<Qe&&(oe(),oe=null)}async function Rt(){try{for await(let ht of K){if(re)return;if(Ne.aborted)throw new i;try{if(ht=Se(ht,Ae),ht===L)continue;ht=N(ht)}catch(Pt){ht=R(Pt)}Te+=1,I(ht,ke,Be),ge.push(ht),le&&(le(),le=null),!re&&(ge.length>=Qe||Te>=qe)&&await new A(Pt=>{oe=Pt})}ge.push(O)}catch(ht){const Pt=R(ht);I(Pt,ke,Be),ge.push(Pt)}finally{re=!0,le&&(le(),le=null)}}Rt();try{for(;;){for(;ge.length>0;){const ht=await ge[0];if(ht===O)return;if(Ne.aborted)throw new i;ht!==L&&(yield ht),ge.shift(),lt()}await new A(ht=>{le=ht})}}finally{re=!0,oe&&(oe(),oe=null)}}).call(this)}function Z(Se=void 0){return Se!=null&&l(Se,"options"),(Se==null?void 0:Se.signal)!=null&&a(Se.signal,"options.signal"),(async function*(){let qe=0;for await(const Ve of this){var Qe;if(Se!=null&&(Qe=Se.signal)!==null&&Qe!==void 0&&Qe.aborted)throw new i({cause:Se.signal.reason});yield[qe++,Ve]}}).call(this)}async function U(Se,Ce=void 0){for await(const qe of W.call(this,Se,Ce))return!0;return!1}async function H(Se,Ce=void 0){if(typeof Se!="function")throw new n("fn",["Function","AsyncFunction"],Se);return!await U.call(this,async(...qe)=>!await Se(...qe),Ce)}async function $(Se,Ce){for await(const qe of W.call(this,Se,Ce))return qe}async function ne(Se,Ce){if(typeof Se!="function")throw new n("fn",["Function","AsyncFunction"],Se);async function qe(Qe,Ve){return await Se(Qe,Ve),L}for await(const Qe of D.call(this,qe,Ce));}function W(Se,Ce){if(typeof Se!="function")throw new n("fn",["Function","AsyncFunction"],Se);async function qe(Qe,Ve){return await Se(Qe,Ve)?Qe:L}return D.call(this,qe,Ce)}class Q extends r{constructor(){super("reduce"),this.message="Reduce of an empty stream requires an initial value"}}async function ee(Se,Ce,qe){var Qe;if(typeof Se!="function")throw new n("reducer",["Function","AsyncFunction"],Se);qe!=null&&l(qe,"options"),(qe==null?void 0:qe.signal)!=null&&a(qe.signal,"options.signal");let Ve=arguments.length>1;if(qe!=null&&(Qe=qe.signal)!==null&&Qe!==void 0&&Qe.aborted){const le=new i(void 0,{cause:qe.signal.reason});throw this.once("error",()=>{}),await d(this.destroy(le)),le}const Ne=new e,K=Ne.signal;if(qe!=null&&qe.signal){const le={once:!0,[c]:this,[u]:!0};qe.signal.addEventListener("abort",()=>Ne.abort(),le)}let ge=!1;try{for await(const le of this){var Ae;if(ge=!0,qe!=null&&(Ae=qe.signal)!==null&&Ae!==void 0&&Ae.aborted)throw new i;Ve?Ce=await Se(Ce,le,{signal:K}):(Ce=le,Ve=!0)}if(!ge&&!Ve)throw new Q}finally{Ne.abort()}return Ce}async function se(Se){Se!=null&&l(Se,"options"),(Se==null?void 0:Se.signal)!=null&&a(Se.signal,"options.signal");const Ce=[];for await(const Qe of this){var qe;if(Se!=null&&(qe=Se.signal)!==null&&qe!==void 0&&qe.aborted)throw new i(void 0,{cause:Se.signal.reason});x(Ce,Qe)}return Ce}function pe(Se,Ce){const qe=D.call(this,Se,Ce);return(async function*(){for await(const Ve of qe)yield*Ve}).call(this)}function ce(Se){if(Se=C(Se),k(Se))return 0;if(Se<0)throw new s("number",">= 0",Se);return Se}function Ie(Se,Ce=void 0){return Ce!=null&&l(Ce,"options"),(Ce==null?void 0:Ce.signal)!=null&&a(Ce.signal,"options.signal"),Se=ce(Se),(async function*(){var Qe;if(Ce!=null&&(Qe=Ce.signal)!==null&&Qe!==void 0&&Qe.aborted)throw new i;for await(const Ne of this){var Ve;if(Ce!=null&&(Ve=Ce.signal)!==null&&Ve!==void 0&&Ve.aborted)throw new i;Se--<=0&&(yield Ne)}}).call(this)}function De(Se,Ce=void 0){return Ce!=null&&l(Ce,"options"),(Ce==null?void 0:Ce.signal)!=null&&a(Ce.signal,"options.signal"),Se=ce(Se),(async function*(){var Qe;if(Ce!=null&&(Qe=Ce.signal)!==null&&Qe!==void 0&&Qe.aborted)throw new i;for await(const Ne of this){var Ve;if(Ce!=null&&(Ve=Ce.signal)!==null&&Ve!==void 0&&Ve.aborted)throw new i;if(Se-- >0&&(yield Ne),Se<=0)return}}).call(this)}return MS.streamReturningOperators={asIndexedPairs:v(Z,"readable.asIndexedPairs will be removed in a future version."),drop:Ie,filter:W,flatMap:pe,map:D,take:De,compose:V},MS.promiseReturningOperators={every:H,forEach:ne,reduce:ee,toArray:se,some:U,find:$},MS}var kM,S9;function QK(){if(S9)return kM;S9=1;const{ArrayPrototypePop:e,Promise:t}=ei(),{isIterable:n,isNodeStream:r,isWebStream:s}=nf(),{pipelineImpl:i}=WO(),{finished:a}=Wh();eY();function o(...l){return new t((c,u)=>{let d,h;const m=l[l.length-1];if(m&&typeof m=="object"&&!r(m)&&!n(m)&&!s(m)){const y=e(l);d=y.signal,h=y.end}i(l,(y,b)=>{y?u(y):c(b)},{signal:d,end:h})})}return kM={finished:a,pipeline:o},kM}var C9;function eY(){if(C9)return tM.exports;C9=1;const{Buffer:e}=Vh(),{ObjectDefineProperty:t,ObjectKeys:n,ReflectApply:r}=ei(),{promisify:{custom:s}}=Ro(),{streamReturningOperators:i,promiseReturningOperators:a}=G_e(),{codes:{ERR_ILLEGAL_CONSTRUCTOR:o}}=co(),l=JK(),{setDefaultHighWaterMark:c,getDefaultHighWaterMark:u}=qE(),{pipeline:d}=WO(),{destroyer:h}=qy(),m=Wh(),y=QK(),b=nf(),v=tM.exports=UO().Stream;v.isDestroyed=b.isDestroyed,v.isDisturbed=b.isDisturbed,v.isErrored=b.isErrored,v.isReadable=b.isReadable,v.isWritable=b.isWritable,v.Readable=VE();for(const w of n(i)){let C=function(...k){if(new.target)throw o();return v.Readable.from(r(S,this,k))};const S=i[w];t(C,"name",{__proto__:null,value:S.name}),t(C,"length",{__proto__:null,value:S.length}),t(v.Readable.prototype,w,{__proto__:null,value:C,enumerable:!1,configurable:!0,writable:!0})}for(const w of n(a)){let C=function(...k){if(new.target)throw o();return r(S,this,k)};const S=a[w];t(C,"name",{__proto__:null,value:S.name}),t(C,"length",{__proto__:null,value:S.length}),t(v.Readable.prototype,w,{__proto__:null,value:C,enumerable:!1,configurable:!0,writable:!0})}v.Writable=VO(),v.Duplex=Wd(),v.Transform=ZK(),v.PassThrough=XK(),v.pipeline=d;const{addAbortSignal:x}=UE();return v.addAbortSignal=x,v.finished=m,v.destroy=h,v.compose=l,v.setDefaultHighWaterMark=c,v.getDefaultHighWaterMark=u,t(v,"promises",{__proto__:null,configurable:!0,enumerable:!0,get(){return y}}),t(d,s,{__proto__:null,enumerable:!0,get(){return y.pipeline}}),t(m,s,{__proto__:null,enumerable:!0,get(){return y.finished}}),v.Stream=v,v._isUint8Array=function(S){return S instanceof Uint8Array},v._uint8ArrayToBuffer=function(S){return e.from(S.buffer,S.byteOffset,S.byteLength)},tM.exports}var k9;function K_e(){return k9||(k9=1,function(e){const t=eY(),n=QK(),r=t.Readable.destroy;e.exports=t.Readable,e.exports._uint8ArrayToBuffer=t._uint8ArrayToBuffer,e.exports._isUint8Array=t._isUint8Array,e.exports.isDisturbed=t.isDisturbed,e.exports.isErrored=t.isErrored,e.exports.isReadable=t.isReadable,e.exports.Readable=t.Readable,e.exports.Writable=t.Writable,e.exports.Duplex=t.Duplex,e.exports.Transform=t.Transform,e.exports.PassThrough=t.PassThrough,e.exports.addAbortSignal=t.addAbortSignal,e.exports.finished=t.finished,e.exports.destroy=t.destroy,e.exports.destroy=r,e.exports.pipeline=t.pipeline,e.exports.compose=t.compose,Object.defineProperty(t,"promises",{configurable:!0,enumerable:!0,get(){return n}}),e.exports.Stream=t.Stream,e.exports.default=e.exports}(eM)),eM.exports}var tY=K_e();class HO extends tY.Readable{constructor(t={},n){var r;super({...t,encoding:(r=t.encoding)!==null&&r!==void 0?r:void 0}),this.pending=!0,this._path="<unknown>",this._bytesRead=0,this.ready=Promise.resolve(n).then(s=>{this._path=s.path;const i=s.readableWebStream({start:t.start,end:t.end});this.reader=i.getReader(),this.pending=!1}).catch(s=>{this.destroy(s)})}async _read(){try{if(await this.ready,!this.reader)return;const{done:t,value:n}=await this.reader.read();if(t){this.push(null);return}this._bytesRead+=n.byteLength,this.push(n)}catch(t){this.destroy(new Xe(yt.EIO,t.toString()))}}close(t=()=>null){try{this.destroy(),this.emit("close"),t(null)}catch(n){t(new Xe(yt.EIO,n.toString()))}}get path(){return this._path}get bytesRead(){return this._bytesRead}wrap(t){return super.wrap(t),this}}class GO extends tY.Writable{constructor(t={},n){super(t),this.pending=!0,this._path="<unknown>",this._bytesWritten=0,this.ready=Promise.resolve(n).then(r=>{this._path=r.path;const s=r.writableWebStream({start:t.start});this.writer=s.getWriter(),this.pending=!1}).catch(r=>this.destroy(r))}async _write(t,n,r){if(await this.ready,!this.writer)return r(Pa(new Xe(yt.EAGAIN,"Underlying writable stream not ready",this._path)));if(n!="buffer")return r(Pa(new Xe(yt.ENOTSUP,"Unsupported encoding for stream",this._path)));const s=new Uint8Array(t.buffer,t.byteOffset,t.byteLength);try{await this.writer.write(s),this._bytesWritten+=t.byteLength,r()}catch(i){r(new Xe(yt.EIO,i.toString()))}}async _final(t){if(await this.ready,!this.writer)return t();try{await this.writer.close(),t()}catch(n){t(new Xe(yt.EIO,n.toString()))}}close(t=()=>null){try{this.destroy(),this.emit("close"),t(null)}catch(n){t(new Xe(yt.EIO,n.toString()))}}get path(){return this._path}get bytesWritten(){return this._bytesWritten}}var ec=function(e,t,n){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var r,s;if(n){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=t[Symbol.asyncDispose]}if(r===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=t[Symbol.dispose],n&&(s=r)}if(typeof r!="function")throw new TypeError("Object not disposable.");s&&(r=function(){try{s.call(this)}catch(i){return Promise.reject(i)}}),e.stack.push({value:t,dispose:r,async:n})}else n&&e.stack.push({async:!0});return t},tc=function(e){return function(t){function n(a){t.error=t.hasError?new e(a,t.error,"An error was suppressed during disposal."):a,t.hasError=!0}var r,s=0;function i(){for(;r=t.stack.pop();)try{if(!r.async&&s===1)return s=0,t.stack.push(r),Promise.resolve().then(i);if(r.dispose){var a=r.dispose.call(r.value);if(r.async)return s|=2,Promise.resolve(a).then(i,function(o){return n(o),i()})}else s|=1}catch(o){n(o)}if(s===1)return t.hasError?Promise.reject(t.error):Promise.resolve();if(t.hasError)throw t.error}return i()}}(typeof SuppressedError=="function"?SuppressedError:function(e,t,n){var r=new Error(n);return r.name="SuppressedError",r.error=e,r.suppressed=t,r});class La{get position(){return this.flag&km?this.inode.size:this._position}set position(t){this._position=t}constructor(t,n){this.context=t,this.fd=n,this._position=0,this.dirty=!1,this.closed=!1;const r=za(t,n);Object.assign(this,Bm(r,"path","fs","internalPath","flag","inode"))}get _isSync(){return!!(this.flag&LE||this.inode.flags&So.Sync)}_emitChange(){wa(this.context,"change",this.path)}async chown(t,n){if(this.closed)throw Xe.With("EBADF",this.path,"chown");this.dirty=!0,jK(this.inode,t,n),this._isSync&&await this.sync(),this._emitChange()}async chmod(t){const n=Uh(t,-1);if(n<0)throw new Xe(yt.EINVAL,"Invalid mode");if(this.closed)throw Xe.With("EBADF",this.path,"chmod");this.dirty=!0,this.inode.mode=this.inode.mode&(n>Cs?-61441:Cs)|n,(this._isSync||n>Cs)&&await this.sync(),this._emitChange()}datasync(){return this.sync()}async sync(){if(this.closed)throw Xe.With("EBADF",this.path,"sync");this.dirty&&(this.fs.attributes.has("no_write")||await this.fs.touch(this.internalPath,this.inode),this.dirty=!1)}async truncate(t=0){if(this.closed)throw Xe.With("EBADF",this.path,"truncate");if(t<0)throw new Xe(yt.EINVAL);if(this.dirty=!0,!(this.flag&ja||this.flag&jd))throw new Xe(yt.EPERM,"File not opened with a writeable mode",this.path,"truncate");this.inode.mtimeMs=Date.now(),this.inode.size=t,this._isSync&&await this.sync(),this._emitChange()}async utimes(t,n){if(this.closed)throw Xe.With("EBADF",this.path,"utimes");this.dirty=!0,this.inode.atimeMs=LC(t),this.inode.mtimeMs=LC(n),this._isSync&&await this.sync(),this._emitChange()}async appendFile(t,n={}){const r=Pd(n,"utf8","a",420);if(!(Od(r.flag)&km))throw new Xe(yt.EINVAL,"Flag passed to appendFile must allow for appending");if(typeof t!="string"&&!r.encoding)throw new Xe(yt.EINVAL,"Encoding not specified");const i=typeof t=="string"?Os.from(t,r.encoding):t;await this._write(i,0,i.length),this._emitChange()}async _read(t,n=0,r=t.byteLength-n,s=this.position){if(this.closed)throw Xe.With("EBADF",this.path,"read");if(this.flag&ja)throw new Xe(yt.EPERM,"File not opened with a readable mode");this.inode.flags&So.NoAtime||(this.dirty=!0,this.inode.atimeMs=Date.now());let i=s+r;!tw(this.inode)&&!ew(this.inode)&&i>this.inode.size&&(i=s+Math.max(this.inode.size-s,0)),this._position=i;const a=new Uint8Array(t.buffer,t.byteOffset,t.byteLength);return await this.fs.read(this.internalPath,a.subarray(n,n+r),s,i),this._isSync&&await this.sync(),{bytesRead:i-s,buffer:t}}async read(t,n,r,s){typeof n=="object"&&n!=null&&(s=n.position,r=n.length,n=n.offset),!ArrayBuffer.isView(t)&&typeof t=="object"&&(s=t.position,r=t.length,n=t.offset,t=t.buffer);const i=Number.isSafeInteger(s)?s:this.position;return t||(t=new Uint8Array(this.inode.size)),n??(n=0),this._read(t,n,r??t.byteLength-n,i)}async readFile(t){const n=Pd(t,null,"r",292);if(Od(n.flag)&ja)throw new Xe(yt.EINVAL,"Flag passed must allow for reading",this.path,"readFile");const{size:s}=await this.stat(),{buffer:i}=await this._read(new Uint8Array(s),0,s,0),a=Os.from(i);return n.encoding?a.toString(n.encoding):a}readableWebStream(t={}){if(this.closed)throw Xe.With("EBADF",this.path,"readableWebStream");return this.fs.streamRead(this.internalPath,t)}writableWebStream(t={}){if(this.closed)throw Xe.With("EBADF",this.path,"writableWebStream");if(this.inode.flags&So.Immutable)throw new Xe(yt.EPERM,"File is immutable",this.path,"writableWebStream");return this.fs.streamWrite(this.internalPath,t)}readLines(t){if(this.closed||this.flag&ja)throw Xe.With("EBADF",this.path,"readLines");return h_e({input:this.createReadStream(t),crlfDelay:1/0})}[Symbol.asyncDispose](){return this.close()}async stat(t){if(this.closed)throw Xe.With("EBADF",this.path,"stat");if(!fs(this.context,this.inode,zi))throw Xe.With("EACCES",this.path,"stat");return t!=null&&t.bigint?new Wm(this.inode):new tf(this.inode)}async _write(t,n=0,r=t.byteLength-n,s=this.position){if(this.closed)throw Xe.With("EBADF",this.path,"write");if(this.inode.flags&So.Immutable)throw new Xe(yt.EPERM,"File is immutable",this.path,"write");if(!(this.flag&ja||this.flag&jd))throw new Xe(yt.EPERM,"File not opened with a writeable mode",this.path,"write");this.dirty=!0;const i=s+r,a=t.subarray(n,n+r);return!tw(this.inode)&&!ew(this.inode)&&i>this.inode.size&&(this.inode.size=i),this.inode.mtimeMs=Date.now(),this.inode.ctimeMs=Date.now(),this._position=s+a.byteLength,await this.fs.write(this.internalPath,a,s),this._isSync&&await this.sync(),a.byteLength}async write(t,n,r,s){let i,a,o;typeof n=="object"&&n!=null&&(r=n.length,s=n.position,n=n.offset),typeof t=="string"?(s=typeof n=="number"?n:null,a=0,i=Os.from(t,typeof r=="string"?r:"utf8"),o=i.length):(i=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),a=n??0,o=typeof r=="number"?r:i.byteLength,s=typeof s=="number"?s:null),s??(s=this.position);const l=await this._write(i,a,o,s);return this._emitChange(),{buffer:t,bytesWritten:l}}async writeFile(t,n={}){const r=Pd(n,"utf8","w",420),s=Od(r.flag);if(!(s&ja||s&jd))throw new Xe(yt.EINVAL,"Flag passed must allow for writing",this.path,"writeFile");if(typeof t!="string"&&!r.encoding)throw new Xe(yt.EINVAL,"Encoding not specified");const i=typeof t=="string"?Os.from(t,r.encoding):t;await this._write(i,0,i.length,0),this._emitChange()}async close(){if(this.closed)throw Xe.With("EBADF",this.path,"close");await this.sync(),this.dispose(),DK(this.context,this.fd)}dispose(t){if(this.closed)throw Xe.With("EBADF",this.path,"dispose");if(this.dirty&&!t)throw Xe.With("EBUSY",this.path,"dispose");this.closed=!0}async writev(t,n){typeof n=="number"&&(this.position=n);let r=0;for(const s of t)r+=(await this.write(s)).bytesWritten;return{bytesWritten:r,buffers:t}}async readv(t,n){typeof n=="number"&&(this.position=n);let r=0;for(const s of t)r+=(await this.read(s)).bytesRead;return{bytesRead:r,buffers:t}}createReadStream(t={}){if(this.closed||this.flag&ja)throw Xe.With("EBADF",this.path,"createReadStream");return new HO(t,this)}createWriteStream(t={}){if(this.closed)throw Xe.With("EBADF",this.path,"createWriteStream");if(this.inode.flags&So.Immutable)throw new Xe(yt.EPERM,"File is immutable",this.path,"createWriteStream");return new GO(t,this)}}async function nY(e,t){e=Fn(e),t=Fn(t);const n=Mr(e,this),r=Mr(t,this);if(!(await Vy.call(this,Yr(e))).hasAccess(oi,this))throw Xe.With("EACCES",e,"rename");try{if(n.mountPoint==r.mountPoint){await n.fs.rename(n.path,r.path),wa(this,"rename",e.toString()),wa(this,"change",t.toString());return}await KE.call(this,t,await GE(e)),await HE.call(this,e),wa(this,"rename",e.toString())}catch(s){throw hs(s,{[n.path]:e,[r.path]:t})}}async function v1(e){try{const{fs:t,path:n}=Mr(await Hh.call(this,e),this);return await t.exists(n)}catch(t){if(t instanceof Xe&&t.code=="ENOENT")return!1;throw t}}async function Vy(e,t){e=Fn(e);const{fs:n,path:r}=Mr(await Hh.call(this,e),this);try{const s=await n.stat(r);if(Ui&&!fs(this,s,zi))throw Xe.With("EACCES",r,"stat");return t!=null&&t.bigint?new Wm(s):new tf(s)}catch(s){throw hs(s,{[r]:e})}}async function WE(e,t){e=Fn(e);const{fs:n,path:r}=Mr(e,this);try{const s=await n.stat(r);if(Ui&&!fs(this,s,zi))throw Xe.With("EACCES",r,"lstat");return t!=null&&t.bigint?new Wm(s):new tf(s)}catch(s){throw hs(s,{[r]:e})}}async function rY(e,t=0){const n={stack:[],error:void 0,hasError:!1};try{await ec(n,await nc.call(this,e,"r+"),!0).truncate(t)}catch(r){n.error=r,n.hasError=!0}finally{const r=tc(n);r&&await r}}async function HE(e){e=Fn(e);const{fs:t,path:n}=Mr(e,this);try{if(Ui&&!fs(this,await t.stat(n),oi))throw Xe.With("EACCES",n,"unlink");await t.unlink(n),wa(this,"rename",e.toString())}catch(r){throw hs(r,{[n]:e})}}async function Wy(e,t,n){var r;t=Fn(t);const s=Uh(n.mode,420),i=Od(n.flag),{fullPath:a,fs:o,path:l,stats:c}=await UC(e,t.toString(),n.preserveSymlinks);if(!c){if(!(i&OE))throw Xe.With("ENOENT",a,"_open");const d=await o.stat(Yr(l));if(!fs(e,d,oi))throw Xe.With("EACCES",Yr(a),"_open");if(!Oc(d))throw Xe.With("ENOTDIR",Yr(a),"_open");const{euid:h,egid:m}=(r=e==null?void 0:e.credentials)!==null&&r!==void 0?r:Lc.credentials,y=await o.createFile(l,{mode:s,uid:d.mode&p1?d.uid:h,gid:d.mode&m1?d.gid:m});return new La(e,$C(new BC(e,t,o,l,i,y)))}if(!fs(e,c,FK(i)))throw Xe.With("EACCES",a,"_open");if(i&DE)throw Xe.With("EEXIST",a,"_open");const u=new La(e,$C(new BC(e,t,o,l,i,c)));return i&FE&&await u.truncate(0),u}async function nc(e,t="r",n=420){return await Wy(this,e,{flag:t,mode:n})}async function GE(e,t){const n={stack:[],error:void 0,hasError:!1};try{const r=Pd(t,null,"r",292);return await ec(n,typeof e=="object"&&"fd"in e?e:await nc.call(this,e,r.flag,r.mode),!0).readFile(r)}catch(r){n.error=r,n.hasError=!0}finally{const r=tc(n);r&&await r}}async function KE(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{const s=Pd(n,"utf8","w+",420),i=ec(r,e instanceof La?e:await nc.call(this,e.toString(),s.flag,s.mode),!0),a=typeof t=="string"?t:t instanceof DataView?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t;if(typeof a!="string"&&!(a instanceof Uint8Array))throw new Xe(yt.EINVAL,'The "data" argument must be of type string or an instance of Buffer, TypedArray, or DataView. Received '+typeof t,i.path,"writeFile");await i.writeFile(a,s)}catch(s){r.error=s,r.hasError=!0}finally{const s=tc(r);s&&await s}}async function sY(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{const s=Pd(n,"utf8","a",420);if(!(Od(s.flag)&km))throw new Xe(yt.EINVAL,"Flag passed to appendFile must allow for appending");if(typeof t!="string"&&!s.encoding)throw new Xe(yt.EINVAL,"Encoding not specified");const a=typeof t=="string"?Os.from(t,s.encoding):new Uint8Array(t.buffer,t.byteOffset,t.byteLength);await ec(r,typeof e=="object"&&"fd"in e?e:await nc.call(this,e,s.flag,s.mode),!0).appendFile(a,s)}catch(s){r.error=s,r.hasError=!0}finally{const s=tc(r);s&&await s}}async function KO(e){e=await Hh.call(this,e);const{fs:t,path:n}=Mr(e,this);try{const r=await t.stat(n);if(!r)throw Xe.With("ENOENT",e,"rmdir");if(!Oc(r))throw Xe.With("ENOTDIR",n,"rmdir");if(Ui&&!fs(this,r,oi))throw Xe.With("EACCES",n,"rmdir");await t.rmdir(n),wa(this,"rename",e.toString())}catch(r){throw hs(r,{[n]:e})}}async function YE(e,t){var n,r;const{euid:s,egid:i}=(n=this===null||this===void 0?void 0:this.credentials)!==null&&n!==void 0?n:Lc.credentials;t=typeof t=="object"?t:{mode:t};const a=Uh(t==null?void 0:t.mode,511);e=await Hh.call(this,e);const{fs:o,path:l,root:c}=Mr(e,this),u={[l]:e},d=async(h,m)=>{if(!fs(this,m,oi))throw Xe.With("EACCES",Yr(h),"mkdir");const y=await o.mkdir(h,{mode:a,uid:m.mode&p1?m.uid:s,gid:m.mode&m1?m.gid:i});return wa(this,"rename",h),y};try{if(!(t!=null&&t.recursive)){await d(l,await o.stat(Yr(l)));return}const h=[];for(let y=l,b=e;!await o.exists(y);y=Yr(y),b=Yr(b))h.unshift(y),u[y]=b;if(!h.length)return;const m=[await o.stat(Yr(h[0]))];for(const[y,b]of h.entries())m.push(await d(b,m[y]));return c.length==1?h[0]:(r=h[0])===null||r===void 0?void 0:r.slice(c.length)}catch(h){throw hs(h,u)}}async function Ym(e,t){t=typeof t=="object"?t:{encoding:t},e=await Hh.call(this,e);const{fs:n,path:r}=Mr(e,this),s=await n.stat(r).catch(l=>bs(hs(l,{[r]:e})));if(!s)throw Xe.With("ENOENT",e,"readdir");if(!fs(this,s,zi))throw Xe.With("EACCES",e,"readdir");if(!Oc(s))throw Xe.With("ENOTDIR",e,"readdir");const i=await n.readdir(r).catch(l=>bs(hs(l,{[r]:e}))),a=[],o=async l=>{let c;if(!((t!=null&&t.recursive||t!=null&&t.withFileTypes)&&(c=await n.stat(as(r,l)).catch(u=>{if(u.code!="ENOENT")throw hs(u,{[r]:e})}),!c))&&(t!=null&&t.withFileTypes?a.push(new rw(l,c)):(t==null?void 0:t.encoding)=="buffer"?a.push(Os.from(l)):a.push(l),!(!(t!=null&&t.recursive)||!Oc(c))))for(const u of await Ym.call(this,as(e,l),t))u instanceof rw?(u.path=as(l,u.path),a.push(u)):Os.isBuffer(u)?a.push(Os.from(as(l,xO(u)))):a.push(as(l,u))};return await Promise.all(i.map(o)),a}async function iY(e,t){e=Fn(e),t=Fn(t);const{fs:n,path:r}=Mr(e,this),s=Mr(t,this);if(n!=s.fs)throw Xe.With("EXDEV",t,"link");try{if(Ui&&!fs(this,await n.stat(Yr(r)),zi))throw Xe.With("EACCES",Yr(r),"link");if(Ui&&!(await Vy.call(this,Yr(t))).hasAccess(oi,this))throw Xe.With("EACCES",Yr(t),"link");if(Ui&&!fs(this,await n.stat(r),zi))throw Xe.With("EACCES",r,"link");return await n.link(r,s.path)}catch(i){throw hs(i,{[s.path]:t,[r]:e})}}async function aY(e,t,n="file"){const r={stack:[],error:void 0,hasError:!1};try{if(!["file","dir","junction"].includes(n))throw new Xe(yt.EINVAL,"Invalid symlink type: "+n);if(t=Fn(t),await v1.call(this,t))throw Xe.With("EEXIST",t,"symlink");const s=ec(r,await Wy(this,t,{flag:"w+",mode:420,preserveSymlinks:!0}),!0);await s.writeFile(Fn(e,!0)),await s.chmod(ef)}catch(s){r.error=s,r.hasError=!0}finally{const s=tc(r);s&&await s}}async function zC(e,t){const n={stack:[],error:void 0,hasError:!1};try{const s=await ec(n,await Wy(this,Fn(e),{flag:"r",mode:420,preserveSymlinks:!0}),!0).readFile(),i=typeof t=="object"?t==null?void 0:t.encoding:t;return i=="buffer"?s:s.toString(i??"utf-8")}catch(r){n.error=r,n.hasError=!0}finally{const r=tc(n);r&&await r}}async function oY(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{await ec(r,await nc.call(this,e,"r+"),!0).chown(t,n)}catch(s){r.error=s,r.hasError=!0}finally{const s=tc(r);s&&await s}}async function lY(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{await ec(r,await Wy(this,e,{flag:"r+",mode:420,preserveSymlinks:!0,allowDirectory:!0}),!0).chown(t,n)}catch(s){r.error=s,r.hasError=!0}finally{const s=tc(r);s&&await s}}async function cY(e,t){const n={stack:[],error:void 0,hasError:!1};try{await ec(n,await nc.call(this,e,"r+"),!0).chmod(t)}catch(r){n.error=r,n.hasError=!0}finally{const r=tc(n);r&&await r}}async function uY(e,t){const n={stack:[],error:void 0,hasError:!1};try{await ec(n,await Wy(this,e,{flag:"r+",mode:420,preserveSymlinks:!0,allowDirectory:!0}),!0).chmod(t)}catch(r){n.error=r,n.hasError=!0}finally{const r=tc(n);r&&await r}}async function YO(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{await ec(r,await nc.call(this,e,"r+"),!0).utimes(t,n)}catch(s){r.error=s,r.hasError=!0}finally{const s=tc(r);s&&await s}}async function dY(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{await ec(r,await Wy(this,e,{flag:"r+",mode:420,preserveSymlinks:!0,allowDirectory:!0}),!0).utimes(new Date(t),new Date(n))}catch(s){r.error=s,r.hasError=!0}finally{const s=tc(r);s&&await s}}async function UC(e,t,n){if(n){const l=Mr(t,e),c=await l.fs.stat(l.path).catch(()=>{});return{...l,fullPath:t,stats:c}}try{const l=Mr(t,e),c=await l.fs.stat(l.path);if(!ry(c))return{...l,fullPath:t,stats:c};const u=Vd.call(e,Yr(t),(await zC.call(e,t)).toString());return await UC(e,u)}catch{}const{base:r,dir:s}=au(t),i=s=="/"?"/":await Hh.call(e,s),a=as(i,r),o=Mr(a,e);try{const l=await o.fs.stat(o.path);if(!ry(l))return{...o,fullPath:a,stats:l};const c=Vd.call(e,i,(await zC.call(e,a)).toString());return await UC(e,c)}catch(l){if(l.code=="ENOENT")return{...o,fullPath:t};throw hs(l,{[o.path]:a})}}async function Hh(e,t){var n;const r=typeof t=="string"?t:(n=t==null?void 0:t.encoding)!==null&&n!==void 0?n:"utf8";e=Fn(e);const{fullPath:s}=await UC(this,e);if(r=="utf8"||r=="utf-8")return s;const i=Os.from(s,"utf-8");return r=="buffer"?i:i.toString(r)}function Y_e(e,t={}){const n=new zK(this,e.toString(),typeof t!="string"?t:{encoding:t}),r=[];let s=!1;n.on("change",(a,o)=>{var l;(l=r.shift())===null||l===void 0||l({value:{eventType:a,filename:o},done:!1})});function i(){s=!0,n.close();for(const a of r)a({value:null,done:s});return r.length=0,Promise.resolve({value:null,done:!0})}return{async next(){if(s)return Promise.resolve({value:null,done:s});const{promise:a,resolve:o}=Promise.withResolvers();return r.push(o),a},return:i,throw:i,async[Symbol.asyncDispose](){await i()},[Symbol.asyncIterator](){return this}}}async function fY(e,t=TO){if(!(await Vy.call(this,e)).hasAccess(t,this))throw new Xe(yt.EACCES)}async function ZO(e,t){e=Fn(e);const n=await WE.call(this,e).catch(r=>{if(!(r.code=="ENOENT"&&(t!=null&&t.force)))throw r});if(n)switch(n.mode&Cs){case Ti:if(t!=null&&t.recursive)for(const r of await Ym.call(this,e))await ZO.call(this,as(e,r),t);await KO.call(this,e);break;case Ec:case ef:case Um:case qm:await HE.call(this,e);break;case Vm:case zm:default:throw new Xe(yt.EPERM,"File type not supported",e,"rm")}}async function hY(e,t){const n=typeof t=="object"?t==null?void 0:t.encoding:t||"utf8",s="/tmp/"+`${e}${Date.now()}-${Math.random().toString(36).slice(2)}`;return await YE.call(this,s),n=="buffer"?Os.from(s):s}async function XO(e,t,n){if(e=Fn(e),t=Fn(t),n&&n&AO&&await v1.call(this,t))throw new Xe(yt.EEXIST,"Destination file already exists",t,"copyFile");await KE.call(this,t,await GE.call(this,e)),wa(this,"rename",t.toString())}function pY(e,t){return e=Fn(e),Promise.resolve(new zO(e,this))}async function JO(e,t,n){e=Fn(e),t=Fn(t);const r=await WE.call(this,e);if(n!=null&&n.errorOnExist&&await v1.call(this,t))throw new Xe(yt.EEXIST,"Destination file or directory already exists",t,"cp");switch(r.mode&Cs){case Ti:{if(!(n!=null&&n.recursive))throw new Xe(yt.EISDIR,e+" is a directory (not copied)",e,"cp");const[s]=await Promise.all([Ym.call(this,e,{withFileTypes:!0}),YE.call(this,t,{recursive:!0})]),i=async a=>{n.filter&&!n.filter(as(e,a.name),as(t,a.name))||await JO.call(this,as(e,a.name),as(t,a.name),n)};await Promise.all(s.map(i));break}case Ec:case ef:await XO.call(this,e,t);break;case Um:case qm:case Vm:case zm:default:throw new Xe(yt.EPERM,"File type not supported",e,"rm")}n!=null&&n.preserveTimestamps&&await YO.call(this,t,r.atime,r.mtime)}async function mY(e,t){e=Fn(e);const{fs:n}=Mr(e,this);return Promise.resolve(BK(n,t==null?void 0:t.bigint))}function gY(e,t){e=Array.isArray(e)?e:[e];const{cwd:n="/",withFileTypes:r=!1,exclude:s=()=>!1}=t||{},i=e.map(o=>(o=o.replace(/([.?+^$(){}|[\]/])/g,"$1").replace(/\*\*/g,".*").replace(/\*/g,"[^/]*").replace(/\?/g,"."),new RegExp(`^${o}$`)));async function*a(o){const l=await Ym(o,{withFileTypes:r,encoding:"utf8"});for(const c of l){const u=r?c.path:o+"/"+c;s(r?c:u)||((await Vy(u)).isDirectory()&&i.some(d=>d.source.includes(".*"))&&(yield*a(u)),i.some(d=>d.test(u.replace(/^\/+/g,"")))&&(yield r?c:u.replace(/^\/+/g,"")))}}return a(n)}const Z_e=Object.freeze(Object.defineProperty({__proto__:null,FileHandle:La,access:fY,appendFile:sY,chmod:cY,chown:oY,constants:MK,copyFile:XO,cp:JO,exists:v1,glob:gY,lchmod:uY,lchown:lY,link:iY,lstat:WE,lutimes:dY,mkdir:YE,mkdtemp:hY,open:nc,opendir:pY,readFile:GE,readdir:Ym,readlink:zC,realpath:Hh,rename:nY,rm:ZO,rmdir:KO,stat:Vy,statfs:mY,symlink:aY,truncate:rY,unlink:HE,utimes:YO,watch:Y_e,writeFile:KE},Symbol.toStringTag,{value:"Module"})),pr=()=>{};async function X_e(e){const t=[];for await(const n of e)t.push(n);return t}function J_e(e,t,n=pr){nY.call(this,e,t).then(()=>n()).catch(n)}function Q_e(e,t=pr){v1.call(this,e).then(t).catch(()=>t(!1))}function eSe(e,t,n=pr){n=typeof t=="function"?t:n,Vy.call(this,e,typeof t!="function"?t:{}).then(r=>n(void 0,r)).catch(n)}function tSe(e,t,n=pr){n=typeof t=="function"?t:n,WE.call(this,e,typeof t!="function"?t:{}).then(r=>n(void 0,r)).catch(n)}function nSe(e,t=0,n=pr){n=typeof t=="function"?t:n;const r=typeof t=="number"?t:0;rY.call(this,e,r).then(()=>n()).catch(n)}function rSe(e,t=pr){HE.call(this,e).then(()=>t()).catch(t)}function sSe(e,t,n,r=pr){const s=Uh(n,420);r=typeof n=="function"?n:r,nc.call(this,e,t,s).then(i=>r(void 0,i.fd)).catch(r)}function iSe(e,t,n=pr){n=typeof t=="function"?t:n,GE.call(this,e,typeof t=="function"?null:t).then(r=>n(void 0,r)).catch(n)}function aSe(e,t,n,r=pr){r=typeof n=="function"?n:r,KE.call(this,e,t,typeof n!="function"?n:null).then(()=>r(void 0)).catch(r)}function oSe(e,t,n,r=pr){const s=typeof n!="function"?n:void 0;r=typeof n=="function"?n:r,sY.call(this,e,t,s).then(()=>r()).catch(r)}function lSe(e,t,n=pr){n=typeof t=="function"?t:n,new La(this,e).stat().then(r=>n(void 0,typeof t=="object"&&(t!=null&&t.bigint)?new Wm(r):r)).catch(n)}function cSe(e,t=pr){new La(this,e).close().then(()=>t()).catch(t)}function uSe(e,t,n=pr){const r=typeof t=="number"?t:0;n=typeof t=="function"?t:n;const s=new La(this,e);if(r<0)throw new Xe(yt.EINVAL);s.truncate(r).then(()=>n()).catch(n)}function dSe(e,t=pr){new La(this,e).sync().then(()=>t()).catch(t)}function fSe(e,t=pr){new La(this,e).datasync().then(()=>t()).catch(t)}function hSe(e,t,n,r,s,i=pr){let a,o,l,c,u;const d=new La(this,e);if(typeof t=="string"){switch(u="utf8",typeof n){case"function":i=n;break;case"number":c=n,u=typeof r=="string"?r:"utf8",i=typeof s=="function"?s:i;break;default:i=typeof r=="function"?r:typeof s=="function"?s:i,i(new Xe(yt.EINVAL,"Invalid arguments"));return}a=Os.from(t),o=0,l=a.length;const h=i;d.write(a,o,l,c).then(({bytesWritten:m})=>h(void 0,m,a.toString(u))).catch(h)}else{a=Os.from(t.buffer),o=n,l=r,c=typeof s=="number"?s:null;const h=typeof s=="function"?s:i;d.write(a,o,l,c).then(({bytesWritten:m})=>h(void 0,m,a)).catch(h)}}function pSe(e,t,n,r,s,i=pr){new La(this,e).read(t,n,r,s).then(({bytesRead:a,buffer:o})=>i(void 0,a,o)).catch(i)}function mSe(e,t,n,r=pr){new La(this,e).chown(t,n).then(()=>r()).catch(r)}function gSe(e,t,n){new La(this,e).chmod(t).then(()=>n()).catch(n)}function ySe(e,t,n,r=pr){new La(this,e).utimes(t,n).then(()=>r()).catch(r)}function bSe(e,t=pr){KO.call(this,e).then(()=>t()).catch(t)}function vSe(e,t,n=pr){YE.call(this,e,t).then(()=>n()).catch(n)}function xSe(e,t,n=pr){n=typeof t=="function"?t:n;const r=typeof t!="function"?t:{};Ym.call(this,e,r).then(s=>n(void 0,s)).catch(n)}function wSe(e,t,n=pr){iY.call(this,e,t).then(()=>n()).catch(n)}function _Se(e,t,n,r=pr){const s=typeof n=="string"?n:"file";r=typeof n=="function"?n:r,aY.call(this,e,t,s).then(()=>r()).catch(r)}function SSe(e,t,n=pr){n=typeof t=="function"?t:n,zC.call(this,e).then(r=>n(void 0,r)).catch(n)}function CSe(e,t,n,r=pr){oY.call(this,e,t,n).then(()=>r()).catch(r)}function kSe(e,t,n,r=pr){lY.call(this,e,t,n).then(()=>r()).catch(r)}function ESe(e,t,n=pr){cY.call(this,e,t).then(()=>n()).catch(n)}function TSe(e,t,n=pr){uY.call(this,e,t).then(()=>n()).catch(n)}function ASe(e,t,n,r=pr){YO.call(this,e,t,n).then(()=>r()).catch(r)}function RSe(e,t,n,r=pr){dY.call(this,e,t,n).then(()=>r()).catch(r)}function NSe(e,t,n=pr){n=typeof t=="function"?t:n,Hh.call(this,e,typeof t=="function"?null:t).then(r=>n(void 0,r)).catch(n)}function MSe(e,t,n=pr){const r=typeof t=="number"?t:zi;n=typeof t=="function"?t:n,fY.call(this,e,r).then(()=>n()).catch(n)}const p0=new Map;function ISe(e,t,n){const r=Fn(e),s=typeof t!="function"?t:{};if(typeof t=="function"&&(n=t),!n)throw new Xe(yt.EINVAL,"No listener specified",e.toString(),"watchFile");if(p0.has(r)){const a=p0.get(r);a&&a.listeners.add(n);return}const i=new b_e(this,r,s);i.on("change",(a,o)=>{const l=p0.get(r);if(l)for(const c of l.listeners)c(a,o)}),p0.set(r,{watcher:i,listeners:new Set})}function jSe(e,t=pr){const n=Fn(e),r=p0.get(n);r&&(t&&t!==pr?r.listeners.delete(t):r.listeners.clear(),r.listeners.size===0&&(r.watcher.stop(),p0.delete(n)))}function PSe(e,t,n){const r=new zK(this,Fn(e),typeof t=="object"?t:{});return n=typeof t=="function"?t:n,r.on("change",n||pr),r}function OSe(e,t){t=typeof t=="object"?t:{encoding:t};const n=nc.call(this,e,"r",t==null?void 0:t.mode);return new HO({...t,autoClose:!0},n)}function DSe(e,t){t=typeof t=="object"?t:{encoding:t};const n=nc.call(this,e,"w",t==null?void 0:t.mode);return new GO(t,n)}function FSe(e,t,n=pr){n=typeof t=="function"?t:n,ZO.call(this,e,typeof t=="function"?void 0:t).then(()=>n(void 0)).catch(n)}function LSe(e,t,n=pr){n=typeof t=="function"?t:n,hY.call(this,e,typeof t!="function"?t:null).then(r=>n(void 0,r)).catch(n)}function BSe(e,t,n,r=pr){r=typeof n=="function"?n:r,XO.call(this,e,t,typeof n=="function"?void 0:n).then(()=>r(void 0)).catch(r)}function $Se(e,t,n,r=pr){r=typeof n=="function"?n:r,new La(this,e).readv(t,typeof n=="function"?void 0:n).then(({buffers:s,bytesRead:i})=>r(void 0,i,s)).catch(r)}function zSe(e,t,n,r=pr){r=typeof n=="function"?n:r,new La(this,e).writev(t,typeof n=="function"?void 0:n).then(({buffers:s,bytesWritten:i})=>r(void 0,i,s)).catch(r)}function USe(e,t,n=pr){n=typeof t=="function"?t:n,pY.call(this,e,typeof t=="function"?void 0:t).then(r=>n(void 0,r)).catch(n)}function qSe(e,t,n,r=pr){r=typeof n=="function"?n:r,JO.call(this,e,t,typeof n=="function"?void 0:n).then(()=>r(void 0)).catch(r)}function VSe(e,t,n=pr){n=typeof t=="function"?t:n,mY.call(this,e,typeof t=="function"?void 0:t).then(r=>n(void 0,r)).catch(n)}async function WSe(e,t){const n=await nc.call(this,e.toString(),"r"),r=await n.readFile();return await n.close(),new Blob([r],t)}function HSe(e,t,n=pr){n=typeof t=="function"?t:n;const r=gY.call(this,e,typeof t=="function"?void 0:t);X_e(r).then(s=>{var i;return n(null,(i=s)!==null&&i!==void 0?i:[])}).catch(s=>n(s))}var Dp=function(e,t,n,r,s,i){function a(x){if(x!==void 0&&typeof x!="function")throw new TypeError("Function expected");return x}for(var o=r.kind,l=o==="getter"?"get":o==="setter"?"set":"value",c=!t&&e?r.static?e:e.prototype:null,u=t||(c?Object.getOwnPropertyDescriptor(c,r.name):{}),d,h=!1,m=n.length-1;m>=0;m--){var y={};for(var b in r)y[b]=b==="access"?{}:r[b];for(var b in r.access)y.access[b]=r.access[b];y.addInitializer=function(x){if(h)throw new TypeError("Cannot add initializers after decoration has completed");i.push(a(x||null))};var v=(0,n[m])(o==="accessor"?{get:u.get,set:u.set}:u[l],y);if(o==="accessor"){if(v===void 0)continue;if(v===null||typeof v!="object")throw new TypeError("Object expected");(d=a(v.get))&&(u.get=d),(d=a(v.set))&&(u.set=d),(d=a(v.init))&&s.unshift(d)}else(d=a(v))&&(o==="field"?s.unshift(d):u[l]=d)}c&&Object.defineProperty(c,r.name,u),h=!0},Qo=function(e,t,n){for(var r=arguments.length>2,s=0;s<t.length;s++)n=r?t[s].call(e,n):t[s].call(e);return r?n:void 0},GSe=function(e,t,n){return typeof t=="symbol"&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:n?"".concat(n," ",t):t})},qC;(function(e){e[e.RealTime=1]="RealTime",e[e.PreAlloc=2]="PreAlloc",e[e.Immutable=8]="Immutable",e[e.Append=16]="Append",e[e.Sync=32]="Sync",e[e.NoAtime=64]="NoAtime",e[e.NoDump=128]="NoDump",e[e.RtInherit=256]="RtInherit",e[e.ProjInherit=512]="ProjInherit",e[e.NoSymlinks=1024]="NoSymlinks",e[e.ExtSize=2048]="ExtSize",e[e.ExtSzInherit=4096]="ExtSzInherit",e[e.NoDefrag=8192]="NoDefrag",e[e.FileStream=16384]="FileStream",e[e.Dax=32768]="Dax",e[e.CowExtSize=65536]="CowExtSize",e[e.HasAttr=2147483648]="HasAttr"})(qC||(qC={}));let yY=(()=>{var e,t,n,r,s;let i=[$m()],a,o=[],l,c,u=[],d=[],h,m=[],y=[],b,v=[],x=[],w,S=[],C=[],k,A=[],R=[],N,I=[],P=[];return l=class{constructor(L=bs(new Xe(yt.EINVAL,"fsxattr must be initialized with an inode"))){this.xflags=Qo(this,u,0),this.extsize=(Qo(this,d),Qo(this,m,0)),this.nextents=(Qo(this,y),Qo(this,v,0)),this.projid=(Qo(this,x),Qo(this,S,0)),this.cowextsize=(Qo(this,C),Qo(this,A,0)),this.pad=(Qo(this,R),Qo(this,I,[])),Qo(this,P),this.extsize=L.size,this.nextents=1,this.projid=L.uid,this.cowextsize=L.size;for(const O of Object.keys(So))L.flags&So[O]&&O in qC&&(this.xflags|=qC[O])}},GSe(l,"fsxattr"),(()=>{const L=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;c=[(e=Xn).uint32.bind(e)],h=[(t=Xn).uint32.bind(t)],b=[(n=Xn).uint32.bind(n)],w=[(r=Xn).uint32.bind(r)],k=[(s=Xn).uint32.bind(s)],N=[Xn.char(8)],Dp(null,null,c,{kind:"field",name:"xflags",static:!1,private:!1,access:{has:O=>"xflags"in O,get:O=>O.xflags,set:(O,V)=>{O.xflags=V}},metadata:L},u,d),Dp(null,null,h,{kind:"field",name:"extsize",static:!1,private:!1,access:{has:O=>"extsize"in O,get:O=>O.extsize,set:(O,V)=>{O.extsize=V}},metadata:L},m,y),Dp(null,null,b,{kind:"field",name:"nextents",static:!1,private:!1,access:{has:O=>"nextents"in O,get:O=>O.nextents,set:(O,V)=>{O.nextents=V}},metadata:L},v,x),Dp(null,null,w,{kind:"field",name:"projid",static:!1,private:!1,access:{has:O=>"projid"in O,get:O=>O.projid,set:(O,V)=>{O.projid=V}},metadata:L},S,C),Dp(null,null,k,{kind:"field",name:"cowextsize",static:!1,private:!1,access:{has:O=>"cowextsize"in O,get:O=>O.cowextsize,set:(O,V)=>{O.cowextsize=V}},metadata:L},A,R),Dp(null,null,N,{kind:"field",name:"pad",static:!1,private:!1,access:{has:O=>"pad"in O,get:O=>O.pad,set:(O,V)=>{O.pad=V}},metadata:L},I,P),Dp(null,a={value:l},i,{kind:"class",name:l.name,metadata:L},null,o),l=a.value,L&&Object.defineProperty(l,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:L}),Qo(l,o)})(),l})();var zs;(function(e){e[e.GetFlags=2148034049]="GetFlags",e[e.SetFlags=1074292226]="SetFlags",e[e.GetVersion=2148038145]="GetVersion",e[e.SetVersion=1074296322]="SetVersion",e[e.Fiemap=3223348747]="Fiemap",e[e.GetXattr=2149341215]="GetXattr",e[e.SetXattr=1075599392]="SetXattr",e[e.GetLabel=2164298801]="GetLabel",e[e.SetLabel=1090556978]="SetLabel",e[e.GetUUID=2148603136]="GetUUID",e[e.GetSysfsPath=2155943169]="GetSysfsPath"})(zs||(zs={}));var xc;(function(e){e[e.GetFlags=2147771905]="GetFlags",e[e.SetFlags=1074030082]="SetFlags",e[e.GetVersion=2147776001]="GetVersion",e[e.SetVersion=1074034178]="SetVersion"})(xc||(xc={}));async function KSe(e,t,...n){e=Fn(e);const{fs:r,path:s}=Mr(e,this);try{const i=new Ci(await r.stat(s));switch(t){case zs.GetFlags:case xc.GetFlags:return i.flags;case zs.SetFlags:case xc.SetFlags:i.flags=n[0],await r.touch(s,i);return;case zs.GetVersion:case xc.GetVersion:return i.version;case zs.SetVersion:case xc.SetVersion:i.version=n[0],await r.touch(s,i);return;case zs.Fiemap:break;case zs.GetXattr:return new yY(i);case zs.SetXattr:break;case zs.GetLabel:return r.label;case zs.SetLabel:r.label=n[0];return;case zs.GetUUID:return r.uuid;case zs.GetSysfsPath:return`/sys/fs/${r.name}/${r.uuid}`}}catch(i){throw hs(i,{[s]:e})}throw new Xe(yt.ENOTSUP,"Unsupported command: "+t,e,"ioctl")}function YSe(e,t,...n){e=Fn(e);const{fs:r,path:s}=Mr(e,this);try{const i=new Ci(r.statSync(s));switch(t){case zs.GetFlags:case xc.GetFlags:return i.flags;case zs.SetFlags:case xc.SetFlags:i.flags=n[0],r.touchSync(s,i);return;case zs.GetVersion:case xc.GetVersion:return i.version;case zs.SetVersion:case xc.SetVersion:i.version=n[0],r.touchSync(s,i);return;case zs.Fiemap:break;case zs.GetXattr:return new yY(i);case zs.SetXattr:break;case zs.GetLabel:return r.label;case zs.SetLabel:r.label=n[0];return;case zs.GetUUID:return r.uuid;case zs.GetSysfsPath:return`/sys/fs/${r.name}/${r.uuid}`}}catch(i){throw hs(i,{[s]:e})}throw new Xe(yt.ENOTSUP,"Unsupported command: "+t,e,"ioctl")}const ZSe=[];function Hy(e,t,n,r){if(!t.startsWith("user.")&&!ZSe.includes(t))throw new Xe(yt.EPERM,"Only attributes in the user namespace are supported",n,r)}async function XSe(e,t,n={}){var r;e=Fn(e);const{fs:s,path:i}=Mr(e,this);Hy(this,t,e,"xattr.get");try{const a=await s.stat(i);if(Ui&&!fs(this,a,zi))throw Xe.With("EACCES",i,"xattr.get");(r=a.attributes)!==null&&r!==void 0||(a.attributes=new _h);const o=a.attributes.get(t);if(!o)throw Xe.With("ENODATA",i,"xattr.get");const l=Os.from(o.value);return n.encoding=="buffer"||!n.encoding?l:l.toString(n.encoding)}catch(a){throw hs(a,{[i]:e})}}function JSe(e,t,n={}){var r;e=Fn(e),Hy(this,t,e,"xattr.get");const{fs:s,path:i}=Mr(e,this);try{const a=s.statSync(i);if(Ui&&!fs(this,a,zi))throw Xe.With("EACCES",i,"xattr.get");(r=a.attributes)!==null&&r!==void 0||(a.attributes=new _h);const o=a.attributes.get(t);if(!o)throw Xe.With("ENODATA",i,"xattr.get");const l=Os.from(o.value);return n.encoding=="buffer"||!n.encoding?l:l.toString(n.encoding)}catch(a){throw hs(a,{[i]:e})}}async function QSe(e,t,n,r={}){var s;e=Fn(e);const{fs:i,path:a}=Mr(e,this);Hy(this,t,e,"xattr.set");try{const o=await i.stat(a);if(Ui&&!fs(this,o,oi))throw Xe.With("EACCES",a,"xattr.set");(s=o.attributes)!==null&&s!==void 0||(o.attributes=new _h);const l=o.attributes.get(t);if(r.create&&l)throw Xe.With("EEXIST",a,"xattr.set");if(r.replace&&!l)throw Xe.With("ENODATA",a,"xattr.set");o.attributes.set(t,Os.from(n)),await i.touch(a,Bm(o,"attributes"))}catch(o){throw hs(o,{[a]:e})}}function e2e(e,t,n,r={}){var s;e=Fn(e);const{fs:i,path:a}=Mr(e,this);Hy(this,t,e,"xattr.set");try{const o=i.statSync(a);if(Ui&&!fs(this,o,oi))throw Xe.With("EACCES",a,"xattr.set");(s=o.attributes)!==null&&s!==void 0||(o.attributes=new _h);const l=o.attributes.get(t);if(r.create&&l)throw Xe.With("EEXIST",a,"xattr.set");if(r.replace&&!l)throw Xe.With("ENODATA",a,"xattr.set");o.attributes.set(t,Os.from(n)),i.touchSync(a,Bm(o,"attributes"))}catch(o){throw hs(o,{[a]:e})}}async function t2e(e,t){var n;e=Fn(e);const{fs:r,path:s}=Mr(e,this);Hy(this,t,e,"xattr.remove");try{const i=await r.stat(s);if(Ui&&!fs(this,i,oi))throw Xe.With("EACCES",s,"xattr.remove");if((n=i.attributes)!==null&&n!==void 0||(i.attributes=new _h),!i.attributes.get(t))throw Xe.With("ENODATA",s,"xattr.remove");i.attributes.remove(t),await r.touch(s,Bm(i,"attributes"))}catch(i){throw hs(i,{[s]:e})}}function n2e(e,t){var n;e=Fn(e);const{fs:r,path:s}=Mr(e,this);Hy(this,t,e,"xattr.remove");try{const i=r.statSync(s);if(Ui&&!fs(this,i,oi))throw Xe.With("EACCES",s,"xattr.remove");if((n=i.attributes)!==null&&n!==void 0||(i.attributes=new _h),!i.attributes.get(t))throw Xe.With("ENODATA",s,"xattr.remove");i.attributes.remove(t),r.touchSync(s,Bm(i,"attributes"))}catch(i){throw hs(i,{[s]:e})}}async function r2e(e){e=Fn(e);const{fs:t,path:n}=Mr(e,this);try{const r=await t.stat(n);return r.attributes?r.attributes.keys():[]}catch(r){throw hs(r,{[n]:e})}}function s2e(e){e=Fn(e);const{fs:t,path:n}=Mr(e,this);try{const r=t.statSync(n);return r.attributes?r.attributes.keys():[]}catch(r){throw hs(r,{[n]:e})}}const i2e=Object.freeze(Object.defineProperty({__proto__:null,get:XSe,getSync:JSe,list:r2e,listSync:s2e,remove:t2e,removeSync:n2e,set:QSe,setSync:e2e},Symbol.toStringTag,{value:"Module"})),ca=Object.freeze(Object.defineProperty({__proto__:null,BigIntStatsFs:e_e,Dir:zO,Dirent:rw,get IOC(){return zs},get IOC32(){return xc},ReadStream:HO,Stats:tf,StatsFs:Q1e,WriteStream:GO,access:MSe,accessSync:F_e,appendFile:oSe,appendFileSync:S_e,chmod:ESe,chmodSync:P_e,chown:CSe,chownSync:I_e,chroot:g_e,close:cSe,closeSync:Gm,constants:MK,copyFile:BSe,copyFileSync:HK,cp:qSe,cpSync:GK,createReadStream:OSe,createWriteStream:DSe,exists:Q_e,existsSync:IO,fchmod:gSe,fchmodSync:LO,fchown:mSe,fchownSync:FO,fdatasync:fSe,fdatasyncSync:T_e,fstat:lSe,fstatSync:C_e,fsync:dSe,fsyncSync:E_e,ftruncate:uSe,ftruncateSync:k_e,futimes:ySe,futimesSync:BO,glob:HSe,globSync:q_e,ioctl:KSe,ioctlSync:YSe,lchmod:TSe,lchmodSync:O_e,lchown:kSe,lchownSync:j_e,link:wSe,linkSync:N_e,lopenSync:$E,lstat:tSe,lstatSync:jO,lutimes:RSe,lutimesSync:D_e,mkdir:vSe,mkdirSync:$O,mkdtemp:LSe,mkdtempSync:L_e,mount:MO,open:sSe,openAsBlob:WSe,openSync:BE,opendir:USe,opendirSync:z_e,promises:Z_e,read:pSe,readFile:iSe,readFileSync:OO,readSync:R_e,readdir:xSe,readdirSync:Uy,readlink:SSe,readlinkSync:_j,readv:$Se,readvSync:B_e,realpath:NSe,realpathSync:qh,rename:J_e,renameSync:w_e,rm:FSe,rmSync:WK,rmdir:bSe,rmdirSync:qK,stat:eSe,statSync:Sh,statfs:VSe,statfsSync:U_e,symlink:_Se,symlinkSync:M_e,truncate:nSe,truncateSync:__e,umount:LK,unlink:rSe,unlinkSync:PO,unwatchFile:jSe,utimes:ASe,utimesSync:VK,watch:PSe,watchFile:ISe,write:hSe,writeFile:aSe,writeFileSync:DO,writeSync:A_e,writev:zSe,writevSync:$_e,xattr:i2e},Symbol.toStringTag,{value:"Module"}));function E9(e){return xK(e)||EO(e)||e instanceof NO}async function bY(e,t=0){if(typeof e!="object"||e==null)throw _o(new Xe(yt.EINVAL,"Invalid options on mount configuration"));if(!E9(e))throw _o(new Xe(yt.EINVAL,"Invalid mount configuration"));if(e instanceof NO)return await e.ready(),e;EO(e)&&(e={backend:e});for(const[s,i]of Object.entries(e))if(s!="backend"&&E9(i)){if(vK("Resolving nested mount configuration: "+s),t>10)throw _o(new Xe(yt.EINVAL,"Invalid configuration, too deep and possibly infinite"));e[s]=await bY(i,++t)}const{backend:n}=e;if(typeof n.isAvailable=="function"&&!await n.isAvailable(e))throw _o(new Xe(yt.EPERM,"Backend not available: "+n.name));D1e(n,e);const r=await n.create(e);return e.disableAsyncCache&&r.attributes.set("no_async"),await r.ready(),r}async function a2e(e){if(!xK(e))throw new TypeError("Invalid single mount point configuration");const t=await bY(e);LK("/"),MO("/",t)}const o2e=["delete"];Math.max(...o2e.map(e=>e.length));O1e("RPCPort",e=>typeof(e==null?void 0:e.postMessage)=="function");const vY=new Uint32Array(256);for(let e=0;e<256;e++){let t=e;for(let n=0;n<8;n++)t=t&1?2197175160^t>>>1:t>>>1;vY[e]=t}function l2e(e){let t=4294967295;for(let n=0;n<e.length;n++)t=t>>>8^vY[(t^e[n])&255];return(t^4294967295)>>>0}var $s=function(e,t,n,r,s,i){function a(x){if(x!==void 0&&typeof x!="function")throw new TypeError("Function expected");return x}for(var o=r.kind,l=o==="getter"?"get":o==="setter"?"set":"value",c=!t&&e?r.static?e:e.prototype:null,u=t||(c?Object.getOwnPropertyDescriptor(c,r.name):{}),d,h=!1,m=n.length-1;m>=0;m--){var y={};for(var b in r)y[b]=b==="access"?{}:r[b];for(var b in r.access)y.access[b]=r.access[b];y.addInitializer=function(x){if(h)throw new TypeError("Cannot add initializers after decoration has completed");i.push(a(x||null))};var v=(0,n[m])(o==="accessor"?{get:u.get,set:u.set}:u[l],y);if(o==="accessor"){if(v===void 0)continue;if(v===null||typeof v!="object")throw new TypeError("Object expected");(d=a(v.get))&&(u.get=d),(d=a(v.set))&&(u.set=d),(d=a(v.init))&&s.unshift(d)}else(d=a(v))&&(o==="field"?s.unshift(d):u[l]=d)}c&&Object.defineProperty(c,r.name,u),h=!0},or=function(e,t,n){for(var r=arguments.length>2,s=0;s<t.length;s++)n=r?t[s].call(e,n):t[s].call(e);return r?n:void 0},QO=function(e,t,n){return typeof t=="symbol"&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:n?"".concat(n," ",t):t})};let T9=(()=>{var e,t,n,r;let s=[$m()],i,a=[],o,l,c=[],u=[],d,h=[],m=[],y,b=[],v=[],x,w=[],S=[];return o=class{constructor(){this.id=or(this,c,0),this.offset_=(or(this,u),or(this,h,0)),this.offset=(or(this,m),or(this,b,0)),this.size=(or(this,v),or(this,w,0)),or(this,S)}},QO(o,"MetadataEntry"),(()=>{const C=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;l=[(e=Xn).uint32.bind(e)],d=[(t=Xn).uint32.bind(t)],y=[(n=Xn).uint32.bind(n)],x=[(r=Xn).uint32.bind(r)],$s(null,null,l,{kind:"field",name:"id",static:!1,private:!1,access:{has:k=>"id"in k,get:k=>k.id,set:(k,A)=>{k.id=A}},metadata:C},c,u),$s(null,null,d,{kind:"field",name:"offset_",static:!1,private:!1,access:{has:k=>"offset_"in k,get:k=>k.offset_,set:(k,A)=>{k.offset_=A}},metadata:C},h,m),$s(null,null,y,{kind:"field",name:"offset",static:!1,private:!1,access:{has:k=>"offset"in k,get:k=>k.offset,set:(k,A)=>{k.offset=A}},metadata:C},b,v),$s(null,null,x,{kind:"field",name:"size",static:!1,private:!1,access:{has:k=>"size"in k,get:k=>k.size,set:(k,A)=>{k.size=A}},metadata:C},w,S),$s(null,i={value:o},s,{kind:"class",name:o.name,metadata:C},null,a),o=i.value,C&&Object.defineProperty(o,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:C}),or(o,a)})(),o})();const A9=255;let Fp=(()=>{var e,t,n,r;let s=[$m()],i,a=[],o,l,c=[],u=[],d,h=[],m=[],y,b=[],v=[],x,w=[],S=[],C,k=[],A=[];var R=o=class{constructor(N=bs(new Xe(yt.EINVAL,"Metadata block must be initialized with a superblock")),I=0){if(this.superblock=N,this.offset=I,this.checksum=or(this,c,0),this.timestamp=(or(this,u),or(this,h,Date.now())),this.previous_offset_=(or(this,m),or(this,b,0)),this.previous_offset=(or(this,v),or(this,w,0)),this._previous=or(this,S),this.entries=or(this,k,Array.from({length:A9},()=>new T9)),or(this,A),this.superblock=N,this.offset=I,!!I&&(jE(this,N.store._buffer.subarray(I,I+Us(R))),!xY(this)))throw PE(new Xe(yt.EIO,"SingleBuffer: Checksum mismatch for metadata block at 0x"+I.toString(16)))}get previous(){var N;if(this.previous_offset)return(N=this._previous)!==null&&N!==void 0||(this._previous=new R(this.superblock,this.previous_offset)),this._previous}};return QO(o,"MetadataBlock"),(()=>{const N=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;l=[(e=Xn).uint32.bind(e)],d=[(t=Xn).uint32.bind(t)],y=[(n=Xn).uint32.bind(n)],x=[(r=Xn).uint32.bind(r)],C=[Qx(T9,A9)],$s(null,null,l,{kind:"field",name:"checksum",static:!1,private:!1,access:{has:I=>"checksum"in I,get:I=>I.checksum,set:(I,P)=>{I.checksum=P}},metadata:N},c,u),$s(null,null,d,{kind:"field",name:"timestamp",static:!1,private:!1,access:{has:I=>"timestamp"in I,get:I=>I.timestamp,set:(I,P)=>{I.timestamp=P}},metadata:N},h,m),$s(null,null,y,{kind:"field",name:"previous_offset_",static:!1,private:!1,access:{has:I=>"previous_offset_"in I,get:I=>I.previous_offset_,set:(I,P)=>{I.previous_offset_=P}},metadata:N},b,v),$s(null,null,x,{kind:"field",name:"previous_offset",static:!1,private:!1,access:{has:I=>"previous_offset"in I,get:I=>I.previous_offset,set:(I,P)=>{I.previous_offset=P}},metadata:N},w,S),$s(null,null,C,{kind:"field",name:"entries",static:!1,private:!1,access:{has:I=>"entries"in I,get:I=>I.entries,set:(I,P)=>{I.entries=P}},metadata:N},k,A),$s(null,i={value:o},s,{kind:"class",name:o.name,metadata:N},null,a),R=o=i.value,N&&Object.defineProperty(o,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:N}),or(o,a)})(),R=o})();const R9=2049864546;(()=>{var e,t,n,r,s,i,a,o,l,c,u;let d=[$m()],h,m=[],y,b,v=[],x=[],w,S=[],C=[],k,A=[],R=[],N,I=[],P=[],L,O=[],V=[],D,Z=[],U=[],H,$=[],ne=[],W,Q=[],ee=[],se,pe=[],ce=[],Ie,De=[],Se=[],Ce,qe=[],Qe=[],Ve,Ne=[],K=[],ge,Ae=[],le=[];var oe=y=class{constructor(re=bs(new Xe(yt.EINVAL,"Super block must be initialized with a store"))){if(this.store=re,this.checksum=or(this,v,0),this.magic=(or(this,x),or(this,S,R9)),this.version=(or(this,C),or(this,A,1)),this.inode_format=(or(this,R),or(this,I,n_e)),this.flags=(or(this,P),or(this,O,0)),this.used_bytes=(or(this,V),or(this,Z,BigInt(0))),this.total_bytes=(or(this,U),or(this,$,BigInt(0))),this.uuid=(or(this,ne),or(this,Q,BigInt(0))),this.metadata_block_size=(or(this,ee),or(this,pe,Us(Fp))),this.metadata_offset_=(or(this,ce),or(this,De,0)),this.metadata_offset=(or(this,Se),or(this,qe,0)),this.metadata=or(this,Qe),this.label=or(this,Ne,""),this._padding=(or(this,K),or(this,Ae,new Array(132).fill(0))),or(this,le),this.store=re,re._view.getUint32(v1e(oe,"magic"),!0)!=R9){Pa("SingleBuffer: Invalid magic value, assuming this is a fresh super block"),this.metadata=new Fp(this),this.metadata.offset=Us(oe),this.metadata_offset=this.metadata.offset,this.used_bytes=BigInt(Us(oe)+Us(Fp)),this.total_bytes=BigInt(re._buffer.byteLength),re._write(this),re._write(this.metadata);return}if(jE(this,re._buffer.subarray(0,Us(oe))),!xY(this))throw PE(new Xe(yt.EIO,"SingleBuffer: Checksum mismatch for super block!"));this.metadata=new Fp(this,this.metadata_offset)}rotateMetadata(){const re=new Fp(this);return re.offset=Number(this.used_bytes),re.previous_offset=this.metadata_offset,this.metadata=re,this.metadata_offset=re.offset,this.store._write(re),this.used_bytes+=BigInt(Us(Fp)),this.store._write(this),re}isUnused(re,Te){if(!Te)return!0;if(re+Te>this.total_bytes||re<Us(oe))return!1;for(let Be=this.metadata;Be;Be=Be.previous){if(re<Be.offset+Us(Fp)&&re+Te>Be.offset)return!1;for(const ke of Be.entries)if(ke.offset&&(re>=ke.offset&&re<ke.offset+ke.size||re+Te>ke.offset&&re+Te<=ke.offset+ke.size||re<=ke.offset&&re+Te>=ke.offset+ke.size))return!1}return!0}};return QO(y,"SuperBlock"),(()=>{const re=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;b=[(e=Xn).uint32.bind(e)],w=[(t=Xn).uint32.bind(t)],k=[(n=Xn).uint16.bind(n)],N=[(r=Xn).uint16.bind(r)],L=[(s=Xn).uint32.bind(s)],D=[(i=Xn).uint64.bind(i)],H=[(a=Xn).uint64.bind(a)],W=[(o=Xn).uint128.bind(o)],se=[(l=Xn).uint32.bind(l)],Ie=[(c=Xn).uint32.bind(c)],Ce=[(u=Xn).uint32.bind(u)],Ve=[Xn.char(64)],ge=[Xn.char(132)],$s(null,null,b,{kind:"field",name:"checksum",static:!1,private:!1,access:{has:Te=>"checksum"in Te,get:Te=>Te.checksum,set:(Te,Be)=>{Te.checksum=Be}},metadata:re},v,x),$s(null,null,w,{kind:"field",name:"magic",static:!1,private:!1,access:{has:Te=>"magic"in Te,get:Te=>Te.magic,set:(Te,Be)=>{Te.magic=Be}},metadata:re},S,C),$s(null,null,k,{kind:"field",name:"version",static:!1,private:!1,access:{has:Te=>"version"in Te,get:Te=>Te.version,set:(Te,Be)=>{Te.version=Be}},metadata:re},A,R),$s(null,null,N,{kind:"field",name:"inode_format",static:!1,private:!1,access:{has:Te=>"inode_format"in Te,get:Te=>Te.inode_format,set:(Te,Be)=>{Te.inode_format=Be}},metadata:re},I,P),$s(null,null,L,{kind:"field",name:"flags",static:!1,private:!1,access:{has:Te=>"flags"in Te,get:Te=>Te.flags,set:(Te,Be)=>{Te.flags=Be}},metadata:re},O,V),$s(null,null,D,{kind:"field",name:"used_bytes",static:!1,private:!1,access:{has:Te=>"used_bytes"in Te,get:Te=>Te.used_bytes,set:(Te,Be)=>{Te.used_bytes=Be}},metadata:re},Z,U),$s(null,null,H,{kind:"field",name:"total_bytes",static:!1,private:!1,access:{has:Te=>"total_bytes"in Te,get:Te=>Te.total_bytes,set:(Te,Be)=>{Te.total_bytes=Be}},metadata:re},$,ne),$s(null,null,W,{kind:"field",name:"uuid",static:!1,private:!1,access:{has:Te=>"uuid"in Te,get:Te=>Te.uuid,set:(Te,Be)=>{Te.uuid=Be}},metadata:re},Q,ee),$s(null,null,se,{kind:"field",name:"metadata_block_size",static:!1,private:!1,access:{has:Te=>"metadata_block_size"in Te,get:Te=>Te.metadata_block_size,set:(Te,Be)=>{Te.metadata_block_size=Be}},metadata:re},pe,ce),$s(null,null,Ie,{kind:"field",name:"metadata_offset_",static:!1,private:!1,access:{has:Te=>"metadata_offset_"in Te,get:Te=>Te.metadata_offset_,set:(Te,Be)=>{Te.metadata_offset_=Be}},metadata:re},De,Se),$s(null,null,Ce,{kind:"field",name:"metadata_offset",static:!1,private:!1,access:{has:Te=>"metadata_offset"in Te,get:Te=>Te.metadata_offset,set:(Te,Be)=>{Te.metadata_offset=Be}},metadata:re},qe,Qe),$s(null,null,Ve,{kind:"field",name:"label",static:!1,private:!1,access:{has:Te=>"label"in Te,get:Te=>Te.label,set:(Te,Be)=>{Te.label=Be}},metadata:re},Ne,K),$s(null,null,ge,{kind:"field",name:"_padding",static:!1,private:!1,access:{has:Te=>"_padding"in Te,get:Te=>Te._padding,set:(Te,Be)=>{Te._padding=Be}},metadata:re},Ae,le),$s(null,h={value:y},d,{kind:"class",name:y.name,metadata:re},null,m),oe=y=h.value,re&&Object.defineProperty(y,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:re}),or(y,m)})(),oe=y})();function xY(e){const t=ga(e),n=l2e(t.subarray(4));return e.checksum===n}globalThis.__zenfs__=ca;function c2e(e){switch(e.name){case"TypeMismatchError":return"EPERM";case"IndexSizeError":case"HierarchyRequestError":case"InvalidCharacterError":case"InvalidStateError":case"SyntaxError":case"NamespaceError":case"ConstraintError":case"VersionError":case"URLMismatchError":case"InvalidNodeTypeError":return"EINVAL";case"WrongDocumentError":return"EXDEV";case"NoModificationAllowedError":case"InvalidModificationError":case"InvalidAccessError":case"SecurityError":case"NotAllowedError":return"EACCES";case"NotFoundError":return"ENOENT";case"NotSupportedError":return"ENOTSUP";case"InUseAttributeError":return"EBUSY";case"NetworkError":return"ENETDOWN";case"AbortError":return"EINTR";case"QuotaExceededError":return"ENOSPC";case"TimeoutError":return"ETIMEDOUT";case"ReadOnlyError":return"EROFS";case"DataCloneError":case"EncodingError":case"NotReadableError":case"DataError":case"TransactionInactiveError":case"OperationError":case"UnknownError":default:return"EIO"}}function Cj(e,t,n){if(e instanceof Xe)return e;const r=e instanceof DOMException?yt[c2e(e)]:yt.EIO,s=new Xe(r,e.message,t,n);return s.stack=e.stack,s.cause=e.cause,s}function m0(e){return new Promise((t,n)=>{e.onsuccess=()=>t(e.result),e.onerror=r=>{r.preventDefault(),n(Cj(e.error))}})}class u2e extends wj{constructor(t,n){super(n),this.tx=t,this.store=n,this._idb=t.objectStore(n.name)}async keys(){return(await m0(this._idb.getAllKeys())).filter(t=>typeof t=="string").map(t=>Number(t))}async get(t){const n=await m0(this._idb.get(t.toString()));return n&&this._cached(t,{size:n.byteLength}).add(n,0),n}async set(t,n){this._cached(t,{size:n.byteLength}).add(n,0),await m0(this._idb.put(n,t.toString()))}remove(t){return this.store.cache.delete(t),m0(this._idb.delete(t.toString()))}async commit(){const{promise:t,resolve:n,reject:r}=Promise.withResolvers();return this.tx.oncomplete=()=>n(),this.tx.onerror=()=>r(Cj(this.tx.error)),this.tx.commit(),t}async abort(){const{promise:t,resolve:n,reject:r}=Promise.withResolvers();return this.tx.onabort=()=>n(),this.tx.onerror=()=>r(Cj(this.tx.error)),this.tx.abort(),t}}async function d2e(e,t=globalThis.indexedDB){const n=t.open(e);return n.onupgradeneeded=()=>{const r=n.result;r.objectStoreNames.contains(e)&&(Pa("Found unexpected object store: "+e),r.deleteObjectStore(e)),r.createObjectStore(e)},await m0(n)}class f2e{constructor(t){this.db=t,this.cache=new Map}sync(){return Promise.resolve()}get name(){return this.db.name}transaction(){const t=this.db.transaction(this.name,"readwrite");return new u2e(t,this)}}const h2e={name:"IndexedDB",options:{storeName:{type:"string",required:!1},idbFactory:{type:"object",required:!1}},async isAvailable({idbFactory:e=globalThis.indexedDB}){try{if(!(e instanceof IDBFactory))return!1;const t=e.open("__zenfs_test");return await m0(t),!0}catch{return!1}finally{e==null||e.deleteDatabase("__zenfs_test")}},async create(e){const t=await d2e(e.storeName||"zenfs",e.idbFactory),n=new f2e(t),r=new OK(n);if(e!=null&&e.disableAsyncCache)return kO("Async preloading disabled for IndexedDB"),r;const s=n.transaction();for(const i of await s.keys())await s.get(i);return r}},p2e=h2e,dn={vfsKeyChanged:"vfs.key.changed",nodesUpdated:"vfs.nodes.updated",selectionChanged:"vfs.selection.changed",loadingStateChanged:"vfs.loading.state.changed",fsInstanceChanged:"vfs.instance.changed",vfsEnabledChanged:"vfs.enabled.changed",fileWritten:"vfs.sdk.fileWritten",fileRead:"vfs.sdk.fileRead",fileDeleted:"vfs.sdk.fileDeleted",setVfsKeyRequest:"vfs.set.vfs.key.request",initializeVFSRequest:"vfs.initialize.vfs.request",fetchNodesRequest:"vfs.fetch.nodes.request",setCurrentPathRequest:"vfs.set.current.path.request",createDirectoryRequest:"vfs.create.directory.request",uploadFilesRequest:"vfs.upload.files.request",deleteNodesRequest:"vfs.delete.nodes.request",renameNodeRequest:"vfs.rename.node.request",downloadFileRequest:"vfs.download.file.request",selectFileRequest:"vfs.select.file.request",deselectFileRequest:"vfs.deselect.file.request",clearSelectionRequest:"vfs.clear.selection.request",setEnableVfsRequest:"vfs.set.enable.vfs.request"};function PS(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var EM={exports:{}},N9;function m2e(){return N9||(N9=1,function(e,t){(function(n){e.exports=n()})(function(){return function n(r,s,i){function a(c,u){if(!s[c]){if(!r[c]){var d=typeof PS=="function"&&PS;if(!u&&d)return d(c,!0);if(o)return o(c,!0);var h=new Error("Cannot find module '"+c+"'");throw h.code="MODULE_NOT_FOUND",h}var m=s[c]={exports:{}};r[c][0].call(m.exports,function(y){var b=r[c][1][y];return a(b||y)},m,m.exports,n,r,s,i)}return s[c].exports}for(var o=typeof PS=="function"&&PS,l=0;l<i.length;l++)a(i[l]);return a}({1:[function(n,r,s){var i=n("./utils"),a=n("./support"),o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";s.encode=function(l){for(var c,u,d,h,m,y,b,v=[],x=0,w=l.length,S=w,C=i.getTypeOf(l)!=="string";x<l.length;)S=w-x,d=C?(c=l[x++],u=x<w?l[x++]:0,x<w?l[x++]:0):(c=l.charCodeAt(x++),u=x<w?l.charCodeAt(x++):0,x<w?l.charCodeAt(x++):0),h=c>>2,m=(3&c)<<4|u>>4,y=1<S?(15&u)<<2|d>>6:64,b=2<S?63&d:64,v.push(o.charAt(h)+o.charAt(m)+o.charAt(y)+o.charAt(b));return v.join("")},s.decode=function(l){var c,u,d,h,m,y,b=0,v=0,x="data:";if(l.substr(0,x.length)===x)throw new Error("Invalid base64 input, it looks like a data url.");var w,S=3*(l=l.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(l.charAt(l.length-1)===o.charAt(64)&&S--,l.charAt(l.length-2)===o.charAt(64)&&S--,S%1!=0)throw new Error("Invalid base64 input, bad content length.");for(w=a.uint8array?new Uint8Array(0|S):new Array(0|S);b<l.length;)c=o.indexOf(l.charAt(b++))<<2|(h=o.indexOf(l.charAt(b++)))>>4,u=(15&h)<<4|(m=o.indexOf(l.charAt(b++)))>>2,d=(3&m)<<6|(y=o.indexOf(l.charAt(b++))),w[v++]=c,m!==64&&(w[v++]=u),y!==64&&(w[v++]=d);return w}},{"./support":30,"./utils":32}],2:[function(n,r,s){var i=n("./external"),a=n("./stream/DataWorker"),o=n("./stream/Crc32Probe"),l=n("./stream/DataLengthProbe");function c(u,d,h,m,y){this.compressedSize=u,this.uncompressedSize=d,this.crc32=h,this.compression=m,this.compressedContent=y}c.prototype={getContentWorker:function(){var u=new a(i.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new l("data_length")),d=this;return u.on("end",function(){if(this.streamInfo.data_length!==d.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),u},getCompressedWorker:function(){return new a(i.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},c.createWorkerFrom=function(u,d,h){return u.pipe(new o).pipe(new l("uncompressedSize")).pipe(d.compressWorker(h)).pipe(new l("compressedSize")).withStreamInfo("compression",d)},r.exports=c},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(n,r,s){var i=n("./stream/GenericWorker");s.STORE={magic:"\0\0",compressWorker:function(){return new i("STORE compression")},uncompressWorker:function(){return new i("STORE decompression")}},s.DEFLATE=n("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(n,r,s){var i=n("./utils"),a=function(){for(var o,l=[],c=0;c<256;c++){o=c;for(var u=0;u<8;u++)o=1&o?3988292384^o>>>1:o>>>1;l[c]=o}return l}();r.exports=function(o,l){return o!==void 0&&o.length?i.getTypeOf(o)!=="string"?function(c,u,d,h){var m=a,y=h+d;c^=-1;for(var b=h;b<y;b++)c=c>>>8^m[255&(c^u[b])];return-1^c}(0|l,o,o.length,0):function(c,u,d,h){var m=a,y=h+d;c^=-1;for(var b=h;b<y;b++)c=c>>>8^m[255&(c^u.charCodeAt(b))];return-1^c}(0|l,o,o.length,0):0}},{"./utils":32}],5:[function(n,r,s){s.base64=!1,s.binary=!1,s.dir=!1,s.createFolders=!0,s.date=null,s.compression=null,s.compressionOptions=null,s.comment=null,s.unixPermissions=null,s.dosPermissions=null},{}],6:[function(n,r,s){var i=null;i=typeof Promise<"u"?Promise:n("lie"),r.exports={Promise:i}},{lie:37}],7:[function(n,r,s){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",a=n("pako"),o=n("./utils"),l=n("./stream/GenericWorker"),c=i?"uint8array":"array";function u(d,h){l.call(this,"FlateWorker/"+d),this._pako=null,this._pakoAction=d,this._pakoOptions=h,this.meta={}}s.magic="\b\0",o.inherits(u,l),u.prototype.processChunk=function(d){this.meta=d.meta,this._pako===null&&this._createPako(),this._pako.push(o.transformTo(c,d.data),!1)},u.prototype.flush=function(){l.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},u.prototype.cleanUp=function(){l.prototype.cleanUp.call(this),this._pako=null},u.prototype._createPako=function(){this._pako=new a[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var d=this;this._pako.onData=function(h){d.push({data:h,meta:d.meta})}},s.compressWorker=function(d){return new u("Deflate",d)},s.uncompressWorker=function(){return new u("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(n,r,s){function i(m,y){var b,v="";for(b=0;b<y;b++)v+=String.fromCharCode(255&m),m>>>=8;return v}function a(m,y,b,v,x,w){var S,C,k=m.file,A=m.compression,R=w!==c.utf8encode,N=o.transformTo("string",w(k.name)),I=o.transformTo("string",c.utf8encode(k.name)),P=k.comment,L=o.transformTo("string",w(P)),O=o.transformTo("string",c.utf8encode(P)),V=I.length!==k.name.length,D=O.length!==P.length,Z="",U="",H="",$=k.dir,ne=k.date,W={crc32:0,compressedSize:0,uncompressedSize:0};y&&!b||(W.crc32=m.crc32,W.compressedSize=m.compressedSize,W.uncompressedSize=m.uncompressedSize);var Q=0;y&&(Q|=8),R||!V&&!D||(Q|=2048);var ee=0,se=0;$&&(ee|=16),x==="UNIX"?(se=798,ee|=function(ce,Ie){var De=ce;return ce||(De=Ie?16893:33204),(65535&De)<<16}(k.unixPermissions,$)):(se=20,ee|=function(ce){return 63&(ce||0)}(k.dosPermissions)),S=ne.getUTCHours(),S<<=6,S|=ne.getUTCMinutes(),S<<=5,S|=ne.getUTCSeconds()/2,C=ne.getUTCFullYear()-1980,C<<=4,C|=ne.getUTCMonth()+1,C<<=5,C|=ne.getUTCDate(),V&&(U=i(1,1)+i(u(N),4)+I,Z+="up"+i(U.length,2)+U),D&&(H=i(1,1)+i(u(L),4)+O,Z+="uc"+i(H.length,2)+H);var pe="";return pe+=`
\0`,pe+=i(Q,2),pe+=A.magic,pe+=i(S,2),pe+=i(C,2),pe+=i(W.crc32,4),pe+=i(W.compressedSize,4),pe+=i(W.uncompressedSize,4),pe+=i(N.length,2),pe+=i(Z.length,2),{fileRecord:d.LOCAL_FILE_HEADER+pe+N+Z,dirRecord:d.CENTRAL_FILE_HEADER+i(se,2)+pe+i(L.length,2)+"\0\0\0\0"+i(ee,4)+i(v,4)+N+Z+L}}var o=n("../utils"),l=n("../stream/GenericWorker"),c=n("../utf8"),u=n("../crc32"),d=n("../signature");function h(m,y,b,v){l.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=y,this.zipPlatform=b,this.encodeFileName=v,this.streamFiles=m,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}o.inherits(h,l),h.prototype.push=function(m){var y=m.meta.percent||0,b=this.entriesCount,v=this._sources.length;this.accumulate?this.contentBuffer.push(m):(this.bytesWritten+=m.data.length,l.prototype.push.call(this,{data:m.data,meta:{currentFile:this.currentFile,percent:b?(y+100*(b-v-1))/b:100}}))},h.prototype.openedSource=function(m){this.currentSourceOffset=this.bytesWritten,this.currentFile=m.file.name;var y=this.streamFiles&&!m.file.dir;if(y){var b=a(m,y,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:b.fileRecord,meta:{percent:0}})}else this.accumulate=!0},h.prototype.closedSource=function(m){this.accumulate=!1;var y=this.streamFiles&&!m.file.dir,b=a(m,y,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(b.dirRecord),y)this.push({data:function(v){return d.DATA_DESCRIPTOR+i(v.crc32,4)+i(v.compressedSize,4)+i(v.uncompressedSize,4)}(m),meta:{percent:100}});else for(this.push({data:b.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},h.prototype.flush=function(){for(var m=this.bytesWritten,y=0;y<this.dirRecords.length;y++)this.push({data:this.dirRecords[y],meta:{percent:100}});var b=this.bytesWritten-m,v=function(x,w,S,C,k){var A=o.transformTo("string",k(C));return d.CENTRAL_DIRECTORY_END+"\0\0\0\0"+i(x,2)+i(x,2)+i(w,4)+i(S,4)+i(A.length,2)+A}(this.dirRecords.length,b,m,this.zipComment,this.encodeFileName);this.push({data:v,meta:{percent:100}})},h.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},h.prototype.registerPrevious=function(m){this._sources.push(m);var y=this;return m.on("data",function(b){y.processChunk(b)}),m.on("end",function(){y.closedSource(y.previous.streamInfo),y._sources.length?y.prepareNextSource():y.end()}),m.on("error",function(b){y.error(b)}),this},h.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},h.prototype.error=function(m){var y=this._sources;if(!l.prototype.error.call(this,m))return!1;for(var b=0;b<y.length;b++)try{y[b].error(m)}catch{}return!0},h.prototype.lock=function(){l.prototype.lock.call(this);for(var m=this._sources,y=0;y<m.length;y++)m[y].lock()},r.exports=h},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(n,r,s){var i=n("../compressions"),a=n("./ZipFileWorker");s.generateWorker=function(o,l,c){var u=new a(l.streamFiles,c,l.platform,l.encodeFileName),d=0;try{o.forEach(function(h,m){d++;var y=function(w,S){var C=w||S,k=i[C];if(!k)throw new Error(C+" is not a valid compression method !");return k}(m.options.compression,l.compression),b=m.options.compressionOptions||l.compressionOptions||{},v=m.dir,x=m.date;m._compressWorker(y,b).withStreamInfo("file",{name:h,dir:v,date:x,comment:m.comment||"",unixPermissions:m.unixPermissions,dosPermissions:m.dosPermissions}).pipe(u)}),u.entriesCount=d}catch(h){u.error(h)}return u}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(n,r,s){function i(){if(!(this instanceof i))return new i;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var a=new i;for(var o in this)typeof this[o]!="function"&&(a[o]=this[o]);return a}}(i.prototype=n("./object")).loadAsync=n("./load"),i.support=n("./support"),i.defaults=n("./defaults"),i.version="3.10.1",i.loadAsync=function(a,o){return new i().loadAsync(a,o)},i.external=n("./external"),r.exports=i},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(n,r,s){var i=n("./utils"),a=n("./external"),o=n("./utf8"),l=n("./zipEntries"),c=n("./stream/Crc32Probe"),u=n("./nodejsUtils");function d(h){return new a.Promise(function(m,y){var b=h.decompressed.getContentWorker().pipe(new c);b.on("error",function(v){y(v)}).on("end",function(){b.streamInfo.crc32!==h.decompressed.crc32?y(new Error("Corrupted zip : CRC32 mismatch")):m()}).resume()})}r.exports=function(h,m){var y=this;return m=i.extend(m||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:o.utf8decode}),u.isNode&&u.isStream(h)?a.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):i.prepareContent("the loaded zip file",h,!0,m.optimizedBinaryString,m.base64).then(function(b){var v=new l(m);return v.load(b),v}).then(function(b){var v=[a.Promise.resolve(b)],x=b.files;if(m.checkCRC32)for(var w=0;w<x.length;w++)v.push(d(x[w]));return a.Promise.all(v)}).then(function(b){for(var v=b.shift(),x=v.files,w=0;w<x.length;w++){var S=x[w],C=S.fileNameStr,k=i.resolve(S.fileNameStr);y.file(k,S.decompressed,{binary:!0,optimizedBinaryString:!0,date:S.date,dir:S.dir,comment:S.fileCommentStr.length?S.fileCommentStr:null,unixPermissions:S.unixPermissions,dosPermissions:S.dosPermissions,createFolders:m.createFolders}),S.dir||(y.file(k).unsafeOriginalName=C)}return v.zipComment.length&&(y.comment=v.zipComment),y})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(n,r,s){var i=n("../utils"),a=n("../stream/GenericWorker");function o(l,c){a.call(this,"Nodejs stream input adapter for "+l),this._upstreamEnded=!1,this._bindStream(c)}i.inherits(o,a),o.prototype._bindStream=function(l){var c=this;(this._stream=l).pause(),l.on("data",function(u){c.push({data:u,meta:{percent:0}})}).on("error",function(u){c.isPaused?this.generatedError=u:c.error(u)}).on("end",function(){c.isPaused?c._upstreamEnded=!0:c.end()})},o.prototype.pause=function(){return!!a.prototype.pause.call(this)&&(this._stream.pause(),!0)},o.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},r.exports=o},{"../stream/GenericWorker":28,"../utils":32}],13:[function(n,r,s){var i=n("readable-stream").Readable;function a(o,l,c){i.call(this,l),this._helper=o;var u=this;o.on("data",function(d,h){u.push(d)||u._helper.pause(),c&&c(h)}).on("error",function(d){u.emit("error",d)}).on("end",function(){u.push(null)})}n("../utils").inherits(a,i),a.prototype._read=function(){this._helper.resume()},r.exports=a},{"../utils":32,"readable-stream":16}],14:[function(n,r,s){r.exports={isNode:typeof ln<"u",newBufferFrom:function(i,a){if(ln.from&&ln.from!==Uint8Array.from)return ln.from(i,a);if(typeof i=="number")throw new Error('The "data" argument must not be a number');return new ln(i,a)},allocBuffer:function(i){if(ln.alloc)return ln.alloc(i);var a=new ln(i);return a.fill(0),a},isBuffer:function(i){return ln.isBuffer(i)},isStream:function(i){return i&&typeof i.on=="function"&&typeof i.pause=="function"&&typeof i.resume=="function"}}},{}],15:[function(n,r,s){function i(k,A,R){var N,I=o.getTypeOf(A),P=o.extend(R||{},u);P.date=P.date||new Date,P.compression!==null&&(P.compression=P.compression.toUpperCase()),typeof P.unixPermissions=="string"&&(P.unixPermissions=parseInt(P.unixPermissions,8)),P.unixPermissions&&16384&P.unixPermissions&&(P.dir=!0),P.dosPermissions&&16&P.dosPermissions&&(P.dir=!0),P.dir&&(k=x(k)),P.createFolders&&(N=v(k))&&w.call(this,N,!0);var L=I==="string"&&P.binary===!1&&P.base64===!1;R&&R.binary!==void 0||(P.binary=!L),(A instanceof d&&A.uncompressedSize===0||P.dir||!A||A.length===0)&&(P.base64=!1,P.binary=!0,A="",P.compression="STORE",I="string");var O=null;O=A instanceof d||A instanceof l?A:y.isNode&&y.isStream(A)?new b(k,A):o.prepareContent(k,A,P.binary,P.optimizedBinaryString,P.base64);var V=new h(k,O,P);this.files[k]=V}var a=n("./utf8"),o=n("./utils"),l=n("./stream/GenericWorker"),c=n("./stream/StreamHelper"),u=n("./defaults"),d=n("./compressedObject"),h=n("./zipObject"),m=n("./generate"),y=n("./nodejsUtils"),b=n("./nodejs/NodejsStreamInputAdapter"),v=function(k){k.slice(-1)==="/"&&(k=k.substring(0,k.length-1));var A=k.lastIndexOf("/");return 0<A?k.substring(0,A):""},x=function(k){return k.slice(-1)!=="/"&&(k+="/"),k},w=function(k,A){return A=A!==void 0?A:u.createFolders,k=x(k),this.files[k]||i.call(this,k,null,{dir:!0,createFolders:A}),this.files[k]};function S(k){return Object.prototype.toString.call(k)==="[object RegExp]"}var C={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(k){var A,R,N;for(A in this.files)N=this.files[A],(R=A.slice(this.root.length,A.length))&&A.slice(0,this.root.length)===this.root&&k(R,N)},filter:function(k){var A=[];return this.forEach(function(R,N){k(R,N)&&A.push(N)}),A},file:function(k,A,R){if(arguments.length!==1)return k=this.root+k,i.call(this,k,A,R),this;if(S(k)){var N=k;return this.filter(function(P,L){return!L.dir&&N.test(P)})}var I=this.files[this.root+k];return I&&!I.dir?I:null},folder:function(k){if(!k)return this;if(S(k))return this.filter(function(I,P){return P.dir&&k.test(I)});var A=this.root+k,R=w.call(this,A),N=this.clone();return N.root=R.name,N},remove:function(k){k=this.root+k;var A=this.files[k];if(A||(k.slice(-1)!=="/"&&(k+="/"),A=this.files[k]),A&&!A.dir)delete this.files[k];else for(var R=this.filter(function(I,P){return P.name.slice(0,k.length)===k}),N=0;N<R.length;N++)delete this.files[R[N].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(k){var A,R={};try{if((R=o.extend(k||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:a.utf8encode})).type=R.type.toLowerCase(),R.compression=R.compression.toUpperCase(),R.type==="binarystring"&&(R.type="string"),!R.type)throw new Error("No output type specified.");o.checkSupport(R.type),R.platform!=="darwin"&&R.platform!=="freebsd"&&R.platform!=="linux"&&R.platform!=="sunos"||(R.platform="UNIX"),R.platform==="win32"&&(R.platform="DOS");var N=R.comment||this.comment||"";A=m.generateWorker(this,R,N)}catch(I){(A=new l("error")).error(I)}return new c(A,R.type||"string",R.mimeType)},generateAsync:function(k,A){return this.generateInternalStream(k).accumulate(A)},generateNodeStream:function(k,A){return(k=k||{}).type||(k.type="nodebuffer"),this.generateInternalStream(k).toNodejsStream(A)}};r.exports=C},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(n,r,s){r.exports=n("stream")},{stream:void 0}],17:[function(n,r,s){var i=n("./DataReader");function a(o){i.call(this,o);for(var l=0;l<this.data.length;l++)o[l]=255&o[l]}n("../utils").inherits(a,i),a.prototype.byteAt=function(o){return this.data[this.zero+o]},a.prototype.lastIndexOfSignature=function(o){for(var l=o.charCodeAt(0),c=o.charCodeAt(1),u=o.charCodeAt(2),d=o.charCodeAt(3),h=this.length-4;0<=h;--h)if(this.data[h]===l&&this.data[h+1]===c&&this.data[h+2]===u&&this.data[h+3]===d)return h-this.zero;return-1},a.prototype.readAndCheckSignature=function(o){var l=o.charCodeAt(0),c=o.charCodeAt(1),u=o.charCodeAt(2),d=o.charCodeAt(3),h=this.readData(4);return l===h[0]&&c===h[1]&&u===h[2]&&d===h[3]},a.prototype.readData=function(o){if(this.checkOffset(o),o===0)return[];var l=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},r.exports=a},{"../utils":32,"./DataReader":18}],18:[function(n,r,s){var i=n("../utils");function a(o){this.data=o,this.length=o.length,this.index=0,this.zero=0}a.prototype={checkOffset:function(o){this.checkIndex(this.index+o)},checkIndex:function(o){if(this.length<this.zero+o||o<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+o+"). Corrupted zip ?")},setIndex:function(o){this.checkIndex(o),this.index=o},skip:function(o){this.setIndex(this.index+o)},byteAt:function(){},readInt:function(o){var l,c=0;for(this.checkOffset(o),l=this.index+o-1;l>=this.index;l--)c=(c<<8)+this.byteAt(l);return this.index+=o,c},readString:function(o){return i.transformTo("string",this.readData(o))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var o=this.readInt(4);return new Date(Date.UTC(1980+(o>>25&127),(o>>21&15)-1,o>>16&31,o>>11&31,o>>5&63,(31&o)<<1))}},r.exports=a},{"../utils":32}],19:[function(n,r,s){var i=n("./Uint8ArrayReader");function a(o){i.call(this,o)}n("../utils").inherits(a,i),a.prototype.readData=function(o){this.checkOffset(o);var l=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},r.exports=a},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(n,r,s){var i=n("./DataReader");function a(o){i.call(this,o)}n("../utils").inherits(a,i),a.prototype.byteAt=function(o){return this.data.charCodeAt(this.zero+o)},a.prototype.lastIndexOfSignature=function(o){return this.data.lastIndexOf(o)-this.zero},a.prototype.readAndCheckSignature=function(o){return o===this.readData(4)},a.prototype.readData=function(o){this.checkOffset(o);var l=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},r.exports=a},{"../utils":32,"./DataReader":18}],21:[function(n,r,s){var i=n("./ArrayReader");function a(o){i.call(this,o)}n("../utils").inherits(a,i),a.prototype.readData=function(o){if(this.checkOffset(o),o===0)return new Uint8Array(0);var l=this.data.subarray(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},r.exports=a},{"../utils":32,"./ArrayReader":17}],22:[function(n,r,s){var i=n("../utils"),a=n("../support"),o=n("./ArrayReader"),l=n("./StringReader"),c=n("./NodeBufferReader"),u=n("./Uint8ArrayReader");r.exports=function(d){var h=i.getTypeOf(d);return i.checkSupport(h),h!=="string"||a.uint8array?h==="nodebuffer"?new c(d):a.uint8array?new u(i.transformTo("uint8array",d)):new o(i.transformTo("array",d)):new l(d)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(n,r,s){s.LOCAL_FILE_HEADER="PK",s.CENTRAL_FILE_HEADER="PK",s.CENTRAL_DIRECTORY_END="PK",s.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",s.ZIP64_CENTRAL_DIRECTORY_END="PK",s.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(n,r,s){var i=n("./GenericWorker"),a=n("../utils");function o(l){i.call(this,"ConvertWorker to "+l),this.destType=l}a.inherits(o,i),o.prototype.processChunk=function(l){this.push({data:a.transformTo(this.destType,l.data),meta:l.meta})},r.exports=o},{"../utils":32,"./GenericWorker":28}],25:[function(n,r,s){var i=n("./GenericWorker"),a=n("../crc32");function o(){i.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}n("../utils").inherits(o,i),o.prototype.processChunk=function(l){this.streamInfo.crc32=a(l.data,this.streamInfo.crc32||0),this.push(l)},r.exports=o},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(n,r,s){var i=n("../utils"),a=n("./GenericWorker");function o(l){a.call(this,"DataLengthProbe for "+l),this.propName=l,this.withStreamInfo(l,0)}i.inherits(o,a),o.prototype.processChunk=function(l){if(l){var c=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=c+l.data.length}a.prototype.processChunk.call(this,l)},r.exports=o},{"../utils":32,"./GenericWorker":28}],27:[function(n,r,s){var i=n("../utils"),a=n("./GenericWorker");function o(l){a.call(this,"DataWorker");var c=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,l.then(function(u){c.dataIsReady=!0,c.data=u,c.max=u&&u.length||0,c.type=i.getTypeOf(u),c.isPaused||c._tickAndRepeat()},function(u){c.error(u)})}i.inherits(o,a),o.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this.data=null},o.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,i.delay(this._tickAndRepeat,[],this)),!0)},o.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(i.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},o.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var l=null,c=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":l=this.data.substring(this.index,c);break;case"uint8array":l=this.data.subarray(this.index,c);break;case"array":case"nodebuffer":l=this.data.slice(this.index,c)}return this.index=c,this.push({data:l,meta:{percent:this.max?this.index/this.max*100:0}})},r.exports=o},{"../utils":32,"./GenericWorker":28}],28:[function(n,r,s){function i(a){this.name=a||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}i.prototype={push:function(a){this.emit("data",a)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(a){this.emit("error",a)}return!0},error:function(a){return!this.isFinished&&(this.isPaused?this.generatedError=a:(this.isFinished=!0,this.emit("error",a),this.previous&&this.previous.error(a),this.cleanUp()),!0)},on:function(a,o){return this._listeners[a].push(o),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(a,o){if(this._listeners[a])for(var l=0;l<this._listeners[a].length;l++)this._listeners[a][l].call(this,o)},pipe:function(a){return a.registerPrevious(this)},registerPrevious:function(a){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=a.streamInfo,this.mergeStreamInfo(),this.previous=a;var o=this;return a.on("data",function(l){o.processChunk(l)}),a.on("end",function(){o.end()}),a.on("error",function(l){o.error(l)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var a=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),a=!0),this.previous&&this.previous.resume(),!a},flush:function(){},processChunk:function(a){this.push(a)},withStreamInfo:function(a,o){return this.extraStreamInfo[a]=o,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var a in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,a)&&(this.streamInfo[a]=this.extraStreamInfo[a])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var a="Worker "+this.name;return this.previous?this.previous+" -> "+a:a}},r.exports=i},{}],29:[function(n,r,s){var i=n("../utils"),a=n("./ConvertWorker"),o=n("./GenericWorker"),l=n("../base64"),c=n("../support"),u=n("../external"),d=null;if(c.nodestream)try{d=n("../nodejs/NodejsStreamOutputAdapter")}catch{}function h(y,b){return new u.Promise(function(v,x){var w=[],S=y._internalType,C=y._outputType,k=y._mimeType;y.on("data",function(A,R){w.push(A),b&&b(R)}).on("error",function(A){w=[],x(A)}).on("end",function(){try{var A=function(R,N,I){switch(R){case"blob":return i.newBlob(i.transformTo("arraybuffer",N),I);case"base64":return l.encode(N);default:return i.transformTo(R,N)}}(C,function(R,N){var I,P=0,L=null,O=0;for(I=0;I<N.length;I++)O+=N[I].length;switch(R){case"string":return N.join("");case"array":return Array.prototype.concat.apply([],N);case"uint8array":for(L=new Uint8Array(O),I=0;I<N.length;I++)L.set(N[I],P),P+=N[I].length;return L;case"nodebuffer":return ln.concat(N);default:throw new Error("concat : unsupported type '"+R+"'")}}(S,w),k);v(A)}catch(R){x(R)}w=[]}).resume()})}function m(y,b,v){var x=b;switch(b){case"blob":case"arraybuffer":x="uint8array";break;case"base64":x="string"}try{this._internalType=x,this._outputType=b,this._mimeType=v,i.checkSupport(x),this._worker=y.pipe(new a(x)),y.lock()}catch(w){this._worker=new o("error"),this._worker.error(w)}}m.prototype={accumulate:function(y){return h(this,y)},on:function(y,b){var v=this;return y==="data"?this._worker.on(y,function(x){b.call(v,x.data,x.meta)}):this._worker.on(y,function(){i.delay(b,arguments,v)}),this},resume:function(){return i.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(y){if(i.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new d(this,{objectMode:this._outputType!=="nodebuffer"},y)}},r.exports=m},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(n,r,s){if(s.base64=!0,s.array=!0,s.string=!0,s.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",s.nodebuffer=typeof ln<"u",s.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")s.blob=!1;else{var i=new ArrayBuffer(0);try{s.blob=new Blob([i],{type:"application/zip"}).size===0}catch{try{var a=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);a.append(i),s.blob=a.getBlob("application/zip").size===0}catch{s.blob=!1}}}try{s.nodestream=!!n("readable-stream").Readable}catch{s.nodestream=!1}},{"readable-stream":16}],31:[function(n,r,s){for(var i=n("./utils"),a=n("./support"),o=n("./nodejsUtils"),l=n("./stream/GenericWorker"),c=new Array(256),u=0;u<256;u++)c[u]=252<=u?6:248<=u?5:240<=u?4:224<=u?3:192<=u?2:1;c[254]=c[254]=1;function d(){l.call(this,"utf-8 decode"),this.leftOver=null}function h(){l.call(this,"utf-8 encode")}s.utf8encode=function(m){return a.nodebuffer?o.newBufferFrom(m,"utf-8"):function(y){var b,v,x,w,S,C=y.length,k=0;for(w=0;w<C;w++)(64512&(v=y.charCodeAt(w)))==55296&&w+1<C&&(64512&(x=y.charCodeAt(w+1)))==56320&&(v=65536+(v-55296<<10)+(x-56320),w++),k+=v<128?1:v<2048?2:v<65536?3:4;for(b=a.uint8array?new Uint8Array(k):new Array(k),w=S=0;S<k;w++)(64512&(v=y.charCodeAt(w)))==55296&&w+1<C&&(64512&(x=y.charCodeAt(w+1)))==56320&&(v=65536+(v-55296<<10)+(x-56320),w++),v<128?b[S++]=v:(v<2048?b[S++]=192|v>>>6:(v<65536?b[S++]=224|v>>>12:(b[S++]=240|v>>>18,b[S++]=128|v>>>12&63),b[S++]=128|v>>>6&63),b[S++]=128|63&v);return b}(m)},s.utf8decode=function(m){return a.nodebuffer?i.transformTo("nodebuffer",m).toString("utf-8"):function(y){var b,v,x,w,S=y.length,C=new Array(2*S);for(b=v=0;b<S;)if((x=y[b++])<128)C[v++]=x;else if(4<(w=c[x]))C[v++]=65533,b+=w-1;else{for(x&=w===2?31:w===3?15:7;1<w&&b<S;)x=x<<6|63&y[b++],w--;1<w?C[v++]=65533:x<65536?C[v++]=x:(x-=65536,C[v++]=55296|x>>10&1023,C[v++]=56320|1023&x)}return C.length!==v&&(C.subarray?C=C.subarray(0,v):C.length=v),i.applyFromCharCode(C)}(m=i.transformTo(a.uint8array?"uint8array":"array",m))},i.inherits(d,l),d.prototype.processChunk=function(m){var y=i.transformTo(a.uint8array?"uint8array":"array",m.data);if(this.leftOver&&this.leftOver.length){if(a.uint8array){var b=y;(y=new Uint8Array(b.length+this.leftOver.length)).set(this.leftOver,0),y.set(b,this.leftOver.length)}else y=this.leftOver.concat(y);this.leftOver=null}var v=function(w,S){var C;for((S=S||w.length)>w.length&&(S=w.length),C=S-1;0<=C&&(192&w[C])==128;)C--;return C<0||C===0?S:C+c[w[C]]>S?C:S}(y),x=y;v!==y.length&&(a.uint8array?(x=y.subarray(0,v),this.leftOver=y.subarray(v,y.length)):(x=y.slice(0,v),this.leftOver=y.slice(v,y.length))),this.push({data:s.utf8decode(x),meta:m.meta})},d.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:s.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},s.Utf8DecodeWorker=d,i.inherits(h,l),h.prototype.processChunk=function(m){this.push({data:s.utf8encode(m.data),meta:m.meta})},s.Utf8EncodeWorker=h},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(n,r,s){var i=n("./support"),a=n("./base64"),o=n("./nodejsUtils"),l=n("./external");function c(b){return b}function u(b,v){for(var x=0;x<b.length;++x)v[x]=255&b.charCodeAt(x);return v}n("setimmediate"),s.newBlob=function(b,v){s.checkSupport("blob");try{return new Blob([b],{type:v})}catch{try{var x=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return x.append(b),x.getBlob(v)}catch{throw new Error("Bug : can't construct the Blob.")}}};var d={stringifyByChunk:function(b,v,x){var w=[],S=0,C=b.length;if(C<=x)return String.fromCharCode.apply(null,b);for(;S<C;)v==="array"||v==="nodebuffer"?w.push(String.fromCharCode.apply(null,b.slice(S,Math.min(S+x,C)))):w.push(String.fromCharCode.apply(null,b.subarray(S,Math.min(S+x,C)))),S+=x;return w.join("")},stringifyByChar:function(b){for(var v="",x=0;x<b.length;x++)v+=String.fromCharCode(b[x]);return v},applyCanBeUsed:{uint8array:function(){try{return i.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return i.nodebuffer&&String.fromCharCode.apply(null,o.allocBuffer(1)).length===1}catch{return!1}}()}};function h(b){var v=65536,x=s.getTypeOf(b),w=!0;if(x==="uint8array"?w=d.applyCanBeUsed.uint8array:x==="nodebuffer"&&(w=d.applyCanBeUsed.nodebuffer),w)for(;1<v;)try{return d.stringifyByChunk(b,x,v)}catch{v=Math.floor(v/2)}return d.stringifyByChar(b)}function m(b,v){for(var x=0;x<b.length;x++)v[x]=b[x];return v}s.applyFromCharCode=h;var y={};y.string={string:c,array:function(b){return u(b,new Array(b.length))},arraybuffer:function(b){return y.string.uint8array(b).buffer},uint8array:function(b){return u(b,new Uint8Array(b.length))},nodebuffer:function(b){return u(b,o.allocBuffer(b.length))}},y.array={string:h,array:c,arraybuffer:function(b){return new Uint8Array(b).buffer},uint8array:function(b){return new Uint8Array(b)},nodebuffer:function(b){return o.newBufferFrom(b)}},y.arraybuffer={string:function(b){return h(new Uint8Array(b))},array:function(b){return m(new Uint8Array(b),new Array(b.byteLength))},arraybuffer:c,uint8array:function(b){return new Uint8Array(b)},nodebuffer:function(b){return o.newBufferFrom(new Uint8Array(b))}},y.uint8array={string:h,array:function(b){return m(b,new Array(b.length))},arraybuffer:function(b){return b.buffer},uint8array:c,nodebuffer:function(b){return o.newBufferFrom(b)}},y.nodebuffer={string:h,array:function(b){return m(b,new Array(b.length))},arraybuffer:function(b){return y.nodebuffer.uint8array(b).buffer},uint8array:function(b){return m(b,new Uint8Array(b.length))},nodebuffer:c},s.transformTo=function(b,v){if(v=v||"",!b)return v;s.checkSupport(b);var x=s.getTypeOf(v);return y[x][b](v)},s.resolve=function(b){for(var v=b.split("/"),x=[],w=0;w<v.length;w++){var S=v[w];S==="."||S===""&&w!==0&&w!==v.length-1||(S===".."?x.pop():x.push(S))}return x.join("/")},s.getTypeOf=function(b){return typeof b=="string"?"string":Object.prototype.toString.call(b)==="[object Array]"?"array":i.nodebuffer&&o.isBuffer(b)?"nodebuffer":i.uint8array&&b instanceof Uint8Array?"uint8array":i.arraybuffer&&b instanceof ArrayBuffer?"arraybuffer":void 0},s.checkSupport=function(b){if(!i[b.toLowerCase()])throw new Error(b+" is not supported by this platform")},s.MAX_VALUE_16BITS=65535,s.MAX_VALUE_32BITS=-1,s.pretty=function(b){var v,x,w="";for(x=0;x<(b||"").length;x++)w+="\\x"+((v=b.charCodeAt(x))<16?"0":"")+v.toString(16).toUpperCase();return w},s.delay=function(b,v,x){setImmediate(function(){b.apply(x||null,v||[])})},s.inherits=function(b,v){function x(){}x.prototype=v.prototype,b.prototype=new x},s.extend=function(){var b,v,x={};for(b=0;b<arguments.length;b++)for(v in arguments[b])Object.prototype.hasOwnProperty.call(arguments[b],v)&&x[v]===void 0&&(x[v]=arguments[b][v]);return x},s.prepareContent=function(b,v,x,w,S){return l.Promise.resolve(v).then(function(C){return i.blob&&(C instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(C))!==-1)&&typeof FileReader<"u"?new l.Promise(function(k,A){var R=new FileReader;R.onload=function(N){k(N.target.result)},R.onerror=function(N){A(N.target.error)},R.readAsArrayBuffer(C)}):C}).then(function(C){var k=s.getTypeOf(C);return k?(k==="arraybuffer"?C=s.transformTo("uint8array",C):k==="string"&&(S?C=a.decode(C):x&&w!==!0&&(C=function(A){return u(A,i.uint8array?new Uint8Array(A.length):new Array(A.length))}(C))),C):l.Promise.reject(new Error("Can't read the data of '"+b+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(n,r,s){var i=n("./reader/readerFor"),a=n("./utils"),o=n("./signature"),l=n("./zipEntry"),c=n("./support");function u(d){this.files=[],this.loadOptions=d}u.prototype={checkSignature:function(d){if(!this.reader.readAndCheckSignature(d)){this.reader.index-=4;var h=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+a.pretty(h)+", expected "+a.pretty(d)+")")}},isSignature:function(d,h){var m=this.reader.index;this.reader.setIndex(d);var y=this.reader.readString(4)===h;return this.reader.setIndex(m),y},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var d=this.reader.readData(this.zipCommentLength),h=c.uint8array?"uint8array":"array",m=a.transformTo(h,d);this.zipComment=this.loadOptions.decodeFileName(m)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var d,h,m,y=this.zip64EndOfCentralSize-44;0<y;)d=this.reader.readInt(2),h=this.reader.readInt(4),m=this.reader.readData(h),this.zip64ExtensibleData[d]={id:d,length:h,value:m}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var d,h;for(d=0;d<this.files.length;d++)h=this.files[d],this.reader.setIndex(h.localHeaderOffset),this.checkSignature(o.LOCAL_FILE_HEADER),h.readLocalPart(this.reader),h.handleUTF8(),h.processAttributes()},readCentralDir:function(){var d;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(o.CENTRAL_FILE_HEADER);)(d=new l({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(d);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var d=this.reader.lastIndexOfSignature(o.CENTRAL_DIRECTORY_END);if(d<0)throw this.isSignature(0,o.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(d);var h=d;if(this.checkSignature(o.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===a.MAX_VALUE_16BITS||this.diskWithCentralDirStart===a.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===a.MAX_VALUE_16BITS||this.centralDirRecords===a.MAX_VALUE_16BITS||this.centralDirSize===a.MAX_VALUE_32BITS||this.centralDirOffset===a.MAX_VALUE_32BITS){if(this.zip64=!0,(d=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(d),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,o.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var m=this.centralDirOffset+this.centralDirSize;this.zip64&&(m+=20,m+=12+this.zip64EndOfCentralSize);var y=h-m;if(0<y)this.isSignature(h,o.CENTRAL_FILE_HEADER)||(this.reader.zero=y);else if(y<0)throw new Error("Corrupted zip: missing "+Math.abs(y)+" bytes.")},prepareReader:function(d){this.reader=i(d)},load:function(d){this.prepareReader(d),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},r.exports=u},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(n,r,s){var i=n("./reader/readerFor"),a=n("./utils"),o=n("./compressedObject"),l=n("./crc32"),c=n("./utf8"),u=n("./compressions"),d=n("./support");function h(m,y){this.options=m,this.loadOptions=y}h.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(m){var y,b;if(m.skip(22),this.fileNameLength=m.readInt(2),b=m.readInt(2),this.fileName=m.readData(this.fileNameLength),m.skip(b),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((y=function(v){for(var x in u)if(Object.prototype.hasOwnProperty.call(u,x)&&u[x].magic===v)return u[x];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+a.pretty(this.compressionMethod)+" unknown (inner file : "+a.transformTo("string",this.fileName)+")");this.decompressed=new o(this.compressedSize,this.uncompressedSize,this.crc32,y,m.readData(this.compressedSize))},readCentralPart:function(m){this.versionMadeBy=m.readInt(2),m.skip(2),this.bitFlag=m.readInt(2),this.compressionMethod=m.readString(2),this.date=m.readDate(),this.crc32=m.readInt(4),this.compressedSize=m.readInt(4),this.uncompressedSize=m.readInt(4);var y=m.readInt(2);if(this.extraFieldsLength=m.readInt(2),this.fileCommentLength=m.readInt(2),this.diskNumberStart=m.readInt(2),this.internalFileAttributes=m.readInt(2),this.externalFileAttributes=m.readInt(4),this.localHeaderOffset=m.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");m.skip(y),this.readExtraFields(m),this.parseZIP64ExtraField(m),this.fileComment=m.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var m=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),m==0&&(this.dosPermissions=63&this.externalFileAttributes),m==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var m=i(this.extraFields[1].value);this.uncompressedSize===a.MAX_VALUE_32BITS&&(this.uncompressedSize=m.readInt(8)),this.compressedSize===a.MAX_VALUE_32BITS&&(this.compressedSize=m.readInt(8)),this.localHeaderOffset===a.MAX_VALUE_32BITS&&(this.localHeaderOffset=m.readInt(8)),this.diskNumberStart===a.MAX_VALUE_32BITS&&(this.diskNumberStart=m.readInt(4))}},readExtraFields:function(m){var y,b,v,x=m.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});m.index+4<x;)y=m.readInt(2),b=m.readInt(2),v=m.readData(b),this.extraFields[y]={id:y,length:b,value:v};m.setIndex(x)},handleUTF8:function(){var m=d.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=c.utf8decode(this.fileName),this.fileCommentStr=c.utf8decode(this.fileComment);else{var y=this.findExtraFieldUnicodePath();if(y!==null)this.fileNameStr=y;else{var b=a.transformTo(m,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(b)}var v=this.findExtraFieldUnicodeComment();if(v!==null)this.fileCommentStr=v;else{var x=a.transformTo(m,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(x)}}},findExtraFieldUnicodePath:function(){var m=this.extraFields[28789];if(m){var y=i(m.value);return y.readInt(1)!==1||l(this.fileName)!==y.readInt(4)?null:c.utf8decode(y.readData(m.length-5))}return null},findExtraFieldUnicodeComment:function(){var m=this.extraFields[25461];if(m){var y=i(m.value);return y.readInt(1)!==1||l(this.fileComment)!==y.readInt(4)?null:c.utf8decode(y.readData(m.length-5))}return null}},r.exports=h},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(n,r,s){function i(y,b,v){this.name=y,this.dir=v.dir,this.date=v.date,this.comment=v.comment,this.unixPermissions=v.unixPermissions,this.dosPermissions=v.dosPermissions,this._data=b,this._dataBinary=v.binary,this.options={compression:v.compression,compressionOptions:v.compressionOptions}}var a=n("./stream/StreamHelper"),o=n("./stream/DataWorker"),l=n("./utf8"),c=n("./compressedObject"),u=n("./stream/GenericWorker");i.prototype={internalStream:function(y){var b=null,v="string";try{if(!y)throw new Error("No output type specified.");var x=(v=y.toLowerCase())==="string"||v==="text";v!=="binarystring"&&v!=="text"||(v="string"),b=this._decompressWorker();var w=!this._dataBinary;w&&!x&&(b=b.pipe(new l.Utf8EncodeWorker)),!w&&x&&(b=b.pipe(new l.Utf8DecodeWorker))}catch(S){(b=new u("error")).error(S)}return new a(b,v,"")},async:function(y,b){return this.internalStream(y).accumulate(b)},nodeStream:function(y,b){return this.internalStream(y||"nodebuffer").toNodejsStream(b)},_compressWorker:function(y,b){if(this._data instanceof c&&this._data.compression.magic===y.magic)return this._data.getCompressedWorker();var v=this._decompressWorker();return this._dataBinary||(v=v.pipe(new l.Utf8EncodeWorker)),c.createWorkerFrom(v,y,b)},_decompressWorker:function(){return this._data instanceof c?this._data.getContentWorker():this._data instanceof u?this._data:new o(this._data)}};for(var d=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],h=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},m=0;m<d.length;m++)i.prototype[d[m]]=h;r.exports=i},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(n,r,s){(function(i){var a,o,l=i.MutationObserver||i.WebKitMutationObserver;if(l){var c=0,u=new l(y),d=i.document.createTextNode("");u.observe(d,{characterData:!0}),a=function(){d.data=c=++c%2}}else if(i.setImmediate||i.MessageChannel===void 0)a="document"in i&&"onreadystatechange"in i.document.createElement("script")?function(){var b=i.document.createElement("script");b.onreadystatechange=function(){y(),b.onreadystatechange=null,b.parentNode.removeChild(b),b=null},i.document.documentElement.appendChild(b)}:function(){setTimeout(y,0)};else{var h=new i.MessageChannel;h.port1.onmessage=y,a=function(){h.port2.postMessage(0)}}var m=[];function y(){var b,v;o=!0;for(var x=m.length;x;){for(v=m,m=[],b=-1;++b<x;)v[b]();x=m.length}o=!1}r.exports=function(b){m.push(b)!==1||o||a()}}).call(this,typeof Xp<"u"?Xp:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(n,r,s){var i=n("immediate");function a(){}var o={},l=["REJECTED"],c=["FULFILLED"],u=["PENDING"];function d(x){if(typeof x!="function")throw new TypeError("resolver must be a function");this.state=u,this.queue=[],this.outcome=void 0,x!==a&&b(this,x)}function h(x,w,S){this.promise=x,typeof w=="function"&&(this.onFulfilled=w,this.callFulfilled=this.otherCallFulfilled),typeof S=="function"&&(this.onRejected=S,this.callRejected=this.otherCallRejected)}function m(x,w,S){i(function(){var C;try{C=w(S)}catch(k){return o.reject(x,k)}C===x?o.reject(x,new TypeError("Cannot resolve promise with itself")):o.resolve(x,C)})}function y(x){var w=x&&x.then;if(x&&(typeof x=="object"||typeof x=="function")&&typeof w=="function")return function(){w.apply(x,arguments)}}function b(x,w){var S=!1;function C(R){S||(S=!0,o.reject(x,R))}function k(R){S||(S=!0,o.resolve(x,R))}var A=v(function(){w(k,C)});A.status==="error"&&C(A.value)}function v(x,w){var S={};try{S.value=x(w),S.status="success"}catch(C){S.status="error",S.value=C}return S}(r.exports=d).prototype.finally=function(x){if(typeof x!="function")return this;var w=this.constructor;return this.then(function(S){return w.resolve(x()).then(function(){return S})},function(S){return w.resolve(x()).then(function(){throw S})})},d.prototype.catch=function(x){return this.then(null,x)},d.prototype.then=function(x,w){if(typeof x!="function"&&this.state===c||typeof w!="function"&&this.state===l)return this;var S=new this.constructor(a);return this.state!==u?m(S,this.state===c?x:w,this.outcome):this.queue.push(new h(S,x,w)),S},h.prototype.callFulfilled=function(x){o.resolve(this.promise,x)},h.prototype.otherCallFulfilled=function(x){m(this.promise,this.onFulfilled,x)},h.prototype.callRejected=function(x){o.reject(this.promise,x)},h.prototype.otherCallRejected=function(x){m(this.promise,this.onRejected,x)},o.resolve=function(x,w){var S=v(y,w);if(S.status==="error")return o.reject(x,S.value);var C=S.value;if(C)b(x,C);else{x.state=c,x.outcome=w;for(var k=-1,A=x.queue.length;++k<A;)x.queue[k].callFulfilled(w)}return x},o.reject=function(x,w){x.state=l,x.outcome=w;for(var S=-1,C=x.queue.length;++S<C;)x.queue[S].callRejected(w);return x},d.resolve=function(x){return x instanceof this?x:o.resolve(new this(a),x)},d.reject=function(x){var w=new this(a);return o.reject(w,x)},d.all=function(x){var w=this;if(Object.prototype.toString.call(x)!=="[object Array]")return this.reject(new TypeError("must be an array"));var S=x.length,C=!1;if(!S)return this.resolve([]);for(var k=new Array(S),A=0,R=-1,N=new this(a);++R<S;)I(x[R],R);return N;function I(P,L){w.resolve(P).then(function(O){k[L]=O,++A!==S||C||(C=!0,o.resolve(N,k))},function(O){C||(C=!0,o.reject(N,O))})}},d.race=function(x){var w=this;if(Object.prototype.toString.call(x)!=="[object Array]")return this.reject(new TypeError("must be an array"));var S=x.length,C=!1;if(!S)return this.resolve([]);for(var k=-1,A=new this(a);++k<S;)R=x[k],w.resolve(R).then(function(N){C||(C=!0,o.resolve(A,N))},function(N){C||(C=!0,o.reject(A,N))});var R;return A}},{immediate:36}],38:[function(n,r,s){var i={};(0,n("./lib/utils/common").assign)(i,n("./lib/deflate"),n("./lib/inflate"),n("./lib/zlib/constants")),r.exports=i},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(n,r,s){var i=n("./zlib/deflate"),a=n("./utils/common"),o=n("./utils/strings"),l=n("./zlib/messages"),c=n("./zlib/zstream"),u=Object.prototype.toString,d=0,h=-1,m=0,y=8;function b(x){if(!(this instanceof b))return new b(x);this.options=a.assign({level:h,method:y,chunkSize:16384,windowBits:15,memLevel:8,strategy:m,to:""},x||{});var w=this.options;w.raw&&0<w.windowBits?w.windowBits=-w.windowBits:w.gzip&&0<w.windowBits&&w.windowBits<16&&(w.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new c,this.strm.avail_out=0;var S=i.deflateInit2(this.strm,w.level,w.method,w.windowBits,w.memLevel,w.strategy);if(S!==d)throw new Error(l[S]);if(w.header&&i.deflateSetHeader(this.strm,w.header),w.dictionary){var C;if(C=typeof w.dictionary=="string"?o.string2buf(w.dictionary):u.call(w.dictionary)==="[object ArrayBuffer]"?new Uint8Array(w.dictionary):w.dictionary,(S=i.deflateSetDictionary(this.strm,C))!==d)throw new Error(l[S]);this._dict_set=!0}}function v(x,w){var S=new b(w);if(S.push(x,!0),S.err)throw S.msg||l[S.err];return S.result}b.prototype.push=function(x,w){var S,C,k=this.strm,A=this.options.chunkSize;if(this.ended)return!1;C=w===~~w?w:w===!0?4:0,typeof x=="string"?k.input=o.string2buf(x):u.call(x)==="[object ArrayBuffer]"?k.input=new Uint8Array(x):k.input=x,k.next_in=0,k.avail_in=k.input.length;do{if(k.avail_out===0&&(k.output=new a.Buf8(A),k.next_out=0,k.avail_out=A),(S=i.deflate(k,C))!==1&&S!==d)return this.onEnd(S),!(this.ended=!0);k.avail_out!==0&&(k.avail_in!==0||C!==4&&C!==2)||(this.options.to==="string"?this.onData(o.buf2binstring(a.shrinkBuf(k.output,k.next_out))):this.onData(a.shrinkBuf(k.output,k.next_out)))}while((0<k.avail_in||k.avail_out===0)&&S!==1);return C===4?(S=i.deflateEnd(this.strm),this.onEnd(S),this.ended=!0,S===d):C!==2||(this.onEnd(d),!(k.avail_out=0))},b.prototype.onData=function(x){this.chunks.push(x)},b.prototype.onEnd=function(x){x===d&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=x,this.msg=this.strm.msg},s.Deflate=b,s.deflate=v,s.deflateRaw=function(x,w){return(w=w||{}).raw=!0,v(x,w)},s.gzip=function(x,w){return(w=w||{}).gzip=!0,v(x,w)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(n,r,s){var i=n("./zlib/inflate"),a=n("./utils/common"),o=n("./utils/strings"),l=n("./zlib/constants"),c=n("./zlib/messages"),u=n("./zlib/zstream"),d=n("./zlib/gzheader"),h=Object.prototype.toString;function m(b){if(!(this instanceof m))return new m(b);this.options=a.assign({chunkSize:16384,windowBits:0,to:""},b||{});var v=this.options;v.raw&&0<=v.windowBits&&v.windowBits<16&&(v.windowBits=-v.windowBits,v.windowBits===0&&(v.windowBits=-15)),!(0<=v.windowBits&&v.windowBits<16)||b&&b.windowBits||(v.windowBits+=32),15<v.windowBits&&v.windowBits<48&&(15&v.windowBits)==0&&(v.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new u,this.strm.avail_out=0;var x=i.inflateInit2(this.strm,v.windowBits);if(x!==l.Z_OK)throw new Error(c[x]);this.header=new d,i.inflateGetHeader(this.strm,this.header)}function y(b,v){var x=new m(v);if(x.push(b,!0),x.err)throw x.msg||c[x.err];return x.result}m.prototype.push=function(b,v){var x,w,S,C,k,A,R=this.strm,N=this.options.chunkSize,I=this.options.dictionary,P=!1;if(this.ended)return!1;w=v===~~v?v:v===!0?l.Z_FINISH:l.Z_NO_FLUSH,typeof b=="string"?R.input=o.binstring2buf(b):h.call(b)==="[object ArrayBuffer]"?R.input=new Uint8Array(b):R.input=b,R.next_in=0,R.avail_in=R.input.length;do{if(R.avail_out===0&&(R.output=new a.Buf8(N),R.next_out=0,R.avail_out=N),(x=i.inflate(R,l.Z_NO_FLUSH))===l.Z_NEED_DICT&&I&&(A=typeof I=="string"?o.string2buf(I):h.call(I)==="[object ArrayBuffer]"?new Uint8Array(I):I,x=i.inflateSetDictionary(this.strm,A)),x===l.Z_BUF_ERROR&&P===!0&&(x=l.Z_OK,P=!1),x!==l.Z_STREAM_END&&x!==l.Z_OK)return this.onEnd(x),!(this.ended=!0);R.next_out&&(R.avail_out!==0&&x!==l.Z_STREAM_END&&(R.avail_in!==0||w!==l.Z_FINISH&&w!==l.Z_SYNC_FLUSH)||(this.options.to==="string"?(S=o.utf8border(R.output,R.next_out),C=R.next_out-S,k=o.buf2string(R.output,S),R.next_out=C,R.avail_out=N-C,C&&a.arraySet(R.output,R.output,S,C,0),this.onData(k)):this.onData(a.shrinkBuf(R.output,R.next_out)))),R.avail_in===0&&R.avail_out===0&&(P=!0)}while((0<R.avail_in||R.avail_out===0)&&x!==l.Z_STREAM_END);return x===l.Z_STREAM_END&&(w=l.Z_FINISH),w===l.Z_FINISH?(x=i.inflateEnd(this.strm),this.onEnd(x),this.ended=!0,x===l.Z_OK):w!==l.Z_SYNC_FLUSH||(this.onEnd(l.Z_OK),!(R.avail_out=0))},m.prototype.onData=function(b){this.chunks.push(b)},m.prototype.onEnd=function(b){b===l.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=b,this.msg=this.strm.msg},s.Inflate=m,s.inflate=y,s.inflateRaw=function(b,v){return(v=v||{}).raw=!0,y(b,v)},s.ungzip=y},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(n,r,s){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";s.assign=function(l){for(var c=Array.prototype.slice.call(arguments,1);c.length;){var u=c.shift();if(u){if(typeof u!="object")throw new TypeError(u+"must be non-object");for(var d in u)u.hasOwnProperty(d)&&(l[d]=u[d])}}return l},s.shrinkBuf=function(l,c){return l.length===c?l:l.subarray?l.subarray(0,c):(l.length=c,l)};var a={arraySet:function(l,c,u,d,h){if(c.subarray&&l.subarray)l.set(c.subarray(u,u+d),h);else for(var m=0;m<d;m++)l[h+m]=c[u+m]},flattenChunks:function(l){var c,u,d,h,m,y;for(c=d=0,u=l.length;c<u;c++)d+=l[c].length;for(y=new Uint8Array(d),c=h=0,u=l.length;c<u;c++)m=l[c],y.set(m,h),h+=m.length;return y}},o={arraySet:function(l,c,u,d,h){for(var m=0;m<d;m++)l[h+m]=c[u+m]},flattenChunks:function(l){return[].concat.apply([],l)}};s.setTyped=function(l){l?(s.Buf8=Uint8Array,s.Buf16=Uint16Array,s.Buf32=Int32Array,s.assign(s,a)):(s.Buf8=Array,s.Buf16=Array,s.Buf32=Array,s.assign(s,o))},s.setTyped(i)},{}],42:[function(n,r,s){var i=n("./common"),a=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch{a=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{o=!1}for(var l=new i.Buf8(256),c=0;c<256;c++)l[c]=252<=c?6:248<=c?5:240<=c?4:224<=c?3:192<=c?2:1;function u(d,h){if(h<65537&&(d.subarray&&o||!d.subarray&&a))return String.fromCharCode.apply(null,i.shrinkBuf(d,h));for(var m="",y=0;y<h;y++)m+=String.fromCharCode(d[y]);return m}l[254]=l[254]=1,s.string2buf=function(d){var h,m,y,b,v,x=d.length,w=0;for(b=0;b<x;b++)(64512&(m=d.charCodeAt(b)))==55296&&b+1<x&&(64512&(y=d.charCodeAt(b+1)))==56320&&(m=65536+(m-55296<<10)+(y-56320),b++),w+=m<128?1:m<2048?2:m<65536?3:4;for(h=new i.Buf8(w),b=v=0;v<w;b++)(64512&(m=d.charCodeAt(b)))==55296&&b+1<x&&(64512&(y=d.charCodeAt(b+1)))==56320&&(m=65536+(m-55296<<10)+(y-56320),b++),m<128?h[v++]=m:(m<2048?h[v++]=192|m>>>6:(m<65536?h[v++]=224|m>>>12:(h[v++]=240|m>>>18,h[v++]=128|m>>>12&63),h[v++]=128|m>>>6&63),h[v++]=128|63&m);return h},s.buf2binstring=function(d){return u(d,d.length)},s.binstring2buf=function(d){for(var h=new i.Buf8(d.length),m=0,y=h.length;m<y;m++)h[m]=d.charCodeAt(m);return h},s.buf2string=function(d,h){var m,y,b,v,x=h||d.length,w=new Array(2*x);for(m=y=0;m<x;)if((b=d[m++])<128)w[y++]=b;else if(4<(v=l[b]))w[y++]=65533,m+=v-1;else{for(b&=v===2?31:v===3?15:7;1<v&&m<x;)b=b<<6|63&d[m++],v--;1<v?w[y++]=65533:b<65536?w[y++]=b:(b-=65536,w[y++]=55296|b>>10&1023,w[y++]=56320|1023&b)}return u(w,y)},s.utf8border=function(d,h){var m;for((h=h||d.length)>d.length&&(h=d.length),m=h-1;0<=m&&(192&d[m])==128;)m--;return m<0||m===0?h:m+l[d[m]]>h?m:h}},{"./common":41}],43:[function(n,r,s){r.exports=function(i,a,o,l){for(var c=65535&i|0,u=i>>>16&65535|0,d=0;o!==0;){for(o-=d=2e3<o?2e3:o;u=u+(c=c+a[l++]|0)|0,--d;);c%=65521,u%=65521}return c|u<<16|0}},{}],44:[function(n,r,s){r.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(n,r,s){var i=function(){for(var a,o=[],l=0;l<256;l++){a=l;for(var c=0;c<8;c++)a=1&a?3988292384^a>>>1:a>>>1;o[l]=a}return o}();r.exports=function(a,o,l,c){var u=i,d=c+l;a^=-1;for(var h=c;h<d;h++)a=a>>>8^u[255&(a^o[h])];return-1^a}},{}],46:[function(n,r,s){var i,a=n("../utils/common"),o=n("./trees"),l=n("./adler32"),c=n("./crc32"),u=n("./messages"),d=0,h=4,m=0,y=-2,b=-1,v=4,x=2,w=8,S=9,C=286,k=30,A=19,R=2*C+1,N=15,I=3,P=258,L=P+I+1,O=42,V=113,D=1,Z=2,U=3,H=4;function $(K,ge){return K.msg=u[ge],ge}function ne(K){return(K<<1)-(4<K?9:0)}function W(K){for(var ge=K.length;0<=--ge;)K[ge]=0}function Q(K){var ge=K.state,Ae=ge.pending;Ae>K.avail_out&&(Ae=K.avail_out),Ae!==0&&(a.arraySet(K.output,ge.pending_buf,ge.pending_out,Ae,K.next_out),K.next_out+=Ae,ge.pending_out+=Ae,K.total_out+=Ae,K.avail_out-=Ae,ge.pending-=Ae,ge.pending===0&&(ge.pending_out=0))}function ee(K,ge){o._tr_flush_block(K,0<=K.block_start?K.block_start:-1,K.strstart-K.block_start,ge),K.block_start=K.strstart,Q(K.strm)}function se(K,ge){K.pending_buf[K.pending++]=ge}function pe(K,ge){K.pending_buf[K.pending++]=ge>>>8&255,K.pending_buf[K.pending++]=255&ge}function ce(K,ge){var Ae,le,oe=K.max_chain_length,re=K.strstart,Te=K.prev_length,Be=K.nice_match,ke=K.strstart>K.w_size-L?K.strstart-(K.w_size-L):0,lt=K.window,Rt=K.w_mask,ht=K.prev,Pt=K.strstart+P,qt=lt[re+Te-1],Lt=lt[re+Te];K.prev_length>=K.good_match&&(oe>>=2),Be>K.lookahead&&(Be=K.lookahead);do if(lt[(Ae=ge)+Te]===Lt&&lt[Ae+Te-1]===qt&&lt[Ae]===lt[re]&&lt[++Ae]===lt[re+1]){re+=2,Ae++;do;while(lt[++re]===lt[++Ae]&&lt[++re]===lt[++Ae]&&lt[++re]===lt[++Ae]&&lt[++re]===lt[++Ae]&&lt[++re]===lt[++Ae]&&lt[++re]===lt[++Ae]&&lt[++re]===lt[++Ae]&&lt[++re]===lt[++Ae]&&re<Pt);if(le=P-(Pt-re),re=Pt-P,Te<le){if(K.match_start=ge,Be<=(Te=le))break;qt=lt[re+Te-1],Lt=lt[re+Te]}}while((ge=ht[ge&Rt])>ke&&--oe!=0);return Te<=K.lookahead?Te:K.lookahead}function Ie(K){var ge,Ae,le,oe,re,Te,Be,ke,lt,Rt,ht=K.w_size;do{if(oe=K.window_size-K.lookahead-K.strstart,K.strstart>=ht+(ht-L)){for(a.arraySet(K.window,K.window,ht,ht,0),K.match_start-=ht,K.strstart-=ht,K.block_start-=ht,ge=Ae=K.hash_size;le=K.head[--ge],K.head[ge]=ht<=le?le-ht:0,--Ae;);for(ge=Ae=ht;le=K.prev[--ge],K.prev[ge]=ht<=le?le-ht:0,--Ae;);oe+=ht}if(K.strm.avail_in===0)break;if(Te=K.strm,Be=K.window,ke=K.strstart+K.lookahead,lt=oe,Rt=void 0,Rt=Te.avail_in,lt<Rt&&(Rt=lt),Ae=Rt===0?0:(Te.avail_in-=Rt,a.arraySet(Be,Te.input,Te.next_in,Rt,ke),Te.state.wrap===1?Te.adler=l(Te.adler,Be,Rt,ke):Te.state.wrap===2&&(Te.adler=c(Te.adler,Be,Rt,ke)),Te.next_in+=Rt,Te.total_in+=Rt,Rt),K.lookahead+=Ae,K.lookahead+K.insert>=I)for(re=K.strstart-K.insert,K.ins_h=K.window[re],K.ins_h=(K.ins_h<<K.hash_shift^K.window[re+1])&K.hash_mask;K.insert&&(K.ins_h=(K.ins_h<<K.hash_shift^K.window[re+I-1])&K.hash_mask,K.prev[re&K.w_mask]=K.head[K.ins_h],K.head[K.ins_h]=re,re++,K.insert--,!(K.lookahead+K.insert<I)););}while(K.lookahead<L&&K.strm.avail_in!==0)}function De(K,ge){for(var Ae,le;;){if(K.lookahead<L){if(Ie(K),K.lookahead<L&&ge===d)return D;if(K.lookahead===0)break}if(Ae=0,K.lookahead>=I&&(K.ins_h=(K.ins_h<<K.hash_shift^K.window[K.strstart+I-1])&K.hash_mask,Ae=K.prev[K.strstart&K.w_mask]=K.head[K.ins_h],K.head[K.ins_h]=K.strstart),Ae!==0&&K.strstart-Ae<=K.w_size-L&&(K.match_length=ce(K,Ae)),K.match_length>=I)if(le=o._tr_tally(K,K.strstart-K.match_start,K.match_length-I),K.lookahead-=K.match_length,K.match_length<=K.max_lazy_match&&K.lookahead>=I){for(K.match_length--;K.strstart++,K.ins_h=(K.ins_h<<K.hash_shift^K.window[K.strstart+I-1])&K.hash_mask,Ae=K.prev[K.strstart&K.w_mask]=K.head[K.ins_h],K.head[K.ins_h]=K.strstart,--K.match_length!=0;);K.strstart++}else K.strstart+=K.match_length,K.match_length=0,K.ins_h=K.window[K.strstart],K.ins_h=(K.ins_h<<K.hash_shift^K.window[K.strstart+1])&K.hash_mask;else le=o._tr_tally(K,0,K.window[K.strstart]),K.lookahead--,K.strstart++;if(le&&(ee(K,!1),K.strm.avail_out===0))return D}return K.insert=K.strstart<I-1?K.strstart:I-1,ge===h?(ee(K,!0),K.strm.avail_out===0?U:H):K.last_lit&&(ee(K,!1),K.strm.avail_out===0)?D:Z}function Se(K,ge){for(var Ae,le,oe;;){if(K.lookahead<L){if(Ie(K),K.lookahead<L&&ge===d)return D;if(K.lookahead===0)break}if(Ae=0,K.lookahead>=I&&(K.ins_h=(K.ins_h<<K.hash_shift^K.window[K.strstart+I-1])&K.hash_mask,Ae=K.prev[K.strstart&K.w_mask]=K.head[K.ins_h],K.head[K.ins_h]=K.strstart),K.prev_length=K.match_length,K.prev_match=K.match_start,K.match_length=I-1,Ae!==0&&K.prev_length<K.max_lazy_match&&K.strstart-Ae<=K.w_size-L&&(K.match_length=ce(K,Ae),K.match_length<=5&&(K.strategy===1||K.match_length===I&&4096<K.strstart-K.match_start)&&(K.match_length=I-1)),K.prev_length>=I&&K.match_length<=K.prev_length){for(oe=K.strstart+K.lookahead-I,le=o._tr_tally(K,K.strstart-1-K.prev_match,K.prev_length-I),K.lookahead-=K.prev_length-1,K.prev_length-=2;++K.strstart<=oe&&(K.ins_h=(K.ins_h<<K.hash_shift^K.window[K.strstart+I-1])&K.hash_mask,Ae=K.prev[K.strstart&K.w_mask]=K.head[K.ins_h],K.head[K.ins_h]=K.strstart),--K.prev_length!=0;);if(K.match_available=0,K.match_length=I-1,K.strstart++,le&&(ee(K,!1),K.strm.avail_out===0))return D}else if(K.match_available){if((le=o._tr_tally(K,0,K.window[K.strstart-1]))&&ee(K,!1),K.strstart++,K.lookahead--,K.strm.avail_out===0)return D}else K.match_available=1,K.strstart++,K.lookahead--}return K.match_available&&(le=o._tr_tally(K,0,K.window[K.strstart-1]),K.match_available=0),K.insert=K.strstart<I-1?K.strstart:I-1,ge===h?(ee(K,!0),K.strm.avail_out===0?U:H):K.last_lit&&(ee(K,!1),K.strm.avail_out===0)?D:Z}function Ce(K,ge,Ae,le,oe){this.good_length=K,this.max_lazy=ge,this.nice_length=Ae,this.max_chain=le,this.func=oe}function qe(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=w,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new a.Buf16(2*R),this.dyn_dtree=new a.Buf16(2*(2*k+1)),this.bl_tree=new a.Buf16(2*(2*A+1)),W(this.dyn_ltree),W(this.dyn_dtree),W(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new a.Buf16(N+1),this.heap=new a.Buf16(2*C+1),W(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new a.Buf16(2*C+1),W(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Qe(K){var ge;return K&&K.state?(K.total_in=K.total_out=0,K.data_type=x,(ge=K.state).pending=0,ge.pending_out=0,ge.wrap<0&&(ge.wrap=-ge.wrap),ge.status=ge.wrap?O:V,K.adler=ge.wrap===2?0:1,ge.last_flush=d,o._tr_init(ge),m):$(K,y)}function Ve(K){var ge=Qe(K);return ge===m&&function(Ae){Ae.window_size=2*Ae.w_size,W(Ae.head),Ae.max_lazy_match=i[Ae.level].max_lazy,Ae.good_match=i[Ae.level].good_length,Ae.nice_match=i[Ae.level].nice_length,Ae.max_chain_length=i[Ae.level].max_chain,Ae.strstart=0,Ae.block_start=0,Ae.lookahead=0,Ae.insert=0,Ae.match_length=Ae.prev_length=I-1,Ae.match_available=0,Ae.ins_h=0}(K.state),ge}function Ne(K,ge,Ae,le,oe,re){if(!K)return y;var Te=1;if(ge===b&&(ge=6),le<0?(Te=0,le=-le):15<le&&(Te=2,le-=16),oe<1||S<oe||Ae!==w||le<8||15<le||ge<0||9<ge||re<0||v<re)return $(K,y);le===8&&(le=9);var Be=new qe;return(K.state=Be).strm=K,Be.wrap=Te,Be.gzhead=null,Be.w_bits=le,Be.w_size=1<<Be.w_bits,Be.w_mask=Be.w_size-1,Be.hash_bits=oe+7,Be.hash_size=1<<Be.hash_bits,Be.hash_mask=Be.hash_size-1,Be.hash_shift=~~((Be.hash_bits+I-1)/I),Be.window=new a.Buf8(2*Be.w_size),Be.head=new a.Buf16(Be.hash_size),Be.prev=new a.Buf16(Be.w_size),Be.lit_bufsize=1<<oe+6,Be.pending_buf_size=4*Be.lit_bufsize,Be.pending_buf=new a.Buf8(Be.pending_buf_size),Be.d_buf=1*Be.lit_bufsize,Be.l_buf=3*Be.lit_bufsize,Be.level=ge,Be.strategy=re,Be.method=Ae,Ve(K)}i=[new Ce(0,0,0,0,function(K,ge){var Ae=65535;for(Ae>K.pending_buf_size-5&&(Ae=K.pending_buf_size-5);;){if(K.lookahead<=1){if(Ie(K),K.lookahead===0&&ge===d)return D;if(K.lookahead===0)break}K.strstart+=K.lookahead,K.lookahead=0;var le=K.block_start+Ae;if((K.strstart===0||K.strstart>=le)&&(K.lookahead=K.strstart-le,K.strstart=le,ee(K,!1),K.strm.avail_out===0)||K.strstart-K.block_start>=K.w_size-L&&(ee(K,!1),K.strm.avail_out===0))return D}return K.insert=0,ge===h?(ee(K,!0),K.strm.avail_out===0?U:H):(K.strstart>K.block_start&&(ee(K,!1),K.strm.avail_out),D)}),new Ce(4,4,8,4,De),new Ce(4,5,16,8,De),new Ce(4,6,32,32,De),new Ce(4,4,16,16,Se),new Ce(8,16,32,32,Se),new Ce(8,16,128,128,Se),new Ce(8,32,128,256,Se),new Ce(32,128,258,1024,Se),new Ce(32,258,258,4096,Se)],s.deflateInit=function(K,ge){return Ne(K,ge,w,15,8,0)},s.deflateInit2=Ne,s.deflateReset=Ve,s.deflateResetKeep=Qe,s.deflateSetHeader=function(K,ge){return K&&K.state?K.state.wrap!==2?y:(K.state.gzhead=ge,m):y},s.deflate=function(K,ge){var Ae,le,oe,re;if(!K||!K.state||5<ge||ge<0)return K?$(K,y):y;if(le=K.state,!K.output||!K.input&&K.avail_in!==0||le.status===666&&ge!==h)return $(K,K.avail_out===0?-5:y);if(le.strm=K,Ae=le.last_flush,le.last_flush=ge,le.status===O)if(le.wrap===2)K.adler=0,se(le,31),se(le,139),se(le,8),le.gzhead?(se(le,(le.gzhead.text?1:0)+(le.gzhead.hcrc?2:0)+(le.gzhead.extra?4:0)+(le.gzhead.name?8:0)+(le.gzhead.comment?16:0)),se(le,255&le.gzhead.time),se(le,le.gzhead.time>>8&255),se(le,le.gzhead.time>>16&255),se(le,le.gzhead.time>>24&255),se(le,le.level===9?2:2<=le.strategy||le.level<2?4:0),se(le,255&le.gzhead.os),le.gzhead.extra&&le.gzhead.extra.length&&(se(le,255&le.gzhead.extra.length),se(le,le.gzhead.extra.length>>8&255)),le.gzhead.hcrc&&(K.adler=c(K.adler,le.pending_buf,le.pending,0)),le.gzindex=0,le.status=69):(se(le,0),se(le,0),se(le,0),se(le,0),se(le,0),se(le,le.level===9?2:2<=le.strategy||le.level<2?4:0),se(le,3),le.status=V);else{var Te=w+(le.w_bits-8<<4)<<8;Te|=(2<=le.strategy||le.level<2?0:le.level<6?1:le.level===6?2:3)<<6,le.strstart!==0&&(Te|=32),Te+=31-Te%31,le.status=V,pe(le,Te),le.strstart!==0&&(pe(le,K.adler>>>16),pe(le,65535&K.adler)),K.adler=1}if(le.status===69)if(le.gzhead.extra){for(oe=le.pending;le.gzindex<(65535&le.gzhead.extra.length)&&(le.pending!==le.pending_buf_size||(le.gzhead.hcrc&&le.pending>oe&&(K.adler=c(K.adler,le.pending_buf,le.pending-oe,oe)),Q(K),oe=le.pending,le.pending!==le.pending_buf_size));)se(le,255&le.gzhead.extra[le.gzindex]),le.gzindex++;le.gzhead.hcrc&&le.pending>oe&&(K.adler=c(K.adler,le.pending_buf,le.pending-oe,oe)),le.gzindex===le.gzhead.extra.length&&(le.gzindex=0,le.status=73)}else le.status=73;if(le.status===73)if(le.gzhead.name){oe=le.pending;do{if(le.pending===le.pending_buf_size&&(le.gzhead.hcrc&&le.pending>oe&&(K.adler=c(K.adler,le.pending_buf,le.pending-oe,oe)),Q(K),oe=le.pending,le.pending===le.pending_buf_size)){re=1;break}re=le.gzindex<le.gzhead.name.length?255&le.gzhead.name.charCodeAt(le.gzindex++):0,se(le,re)}while(re!==0);le.gzhead.hcrc&&le.pending>oe&&(K.adler=c(K.adler,le.pending_buf,le.pending-oe,oe)),re===0&&(le.gzindex=0,le.status=91)}else le.status=91;if(le.status===91)if(le.gzhead.comment){oe=le.pending;do{if(le.pending===le.pending_buf_size&&(le.gzhead.hcrc&&le.pending>oe&&(K.adler=c(K.adler,le.pending_buf,le.pending-oe,oe)),Q(K),oe=le.pending,le.pending===le.pending_buf_size)){re=1;break}re=le.gzindex<le.gzhead.comment.length?255&le.gzhead.comment.charCodeAt(le.gzindex++):0,se(le,re)}while(re!==0);le.gzhead.hcrc&&le.pending>oe&&(K.adler=c(K.adler,le.pending_buf,le.pending-oe,oe)),re===0&&(le.status=103)}else le.status=103;if(le.status===103&&(le.gzhead.hcrc?(le.pending+2>le.pending_buf_size&&Q(K),le.pending+2<=le.pending_buf_size&&(se(le,255&K.adler),se(le,K.adler>>8&255),K.adler=0,le.status=V)):le.status=V),le.pending!==0){if(Q(K),K.avail_out===0)return le.last_flush=-1,m}else if(K.avail_in===0&&ne(ge)<=ne(Ae)&&ge!==h)return $(K,-5);if(le.status===666&&K.avail_in!==0)return $(K,-5);if(K.avail_in!==0||le.lookahead!==0||ge!==d&&le.status!==666){var Be=le.strategy===2?function(ke,lt){for(var Rt;;){if(ke.lookahead===0&&(Ie(ke),ke.lookahead===0)){if(lt===d)return D;break}if(ke.match_length=0,Rt=o._tr_tally(ke,0,ke.window[ke.strstart]),ke.lookahead--,ke.strstart++,Rt&&(ee(ke,!1),ke.strm.avail_out===0))return D}return ke.insert=0,lt===h?(ee(ke,!0),ke.strm.avail_out===0?U:H):ke.last_lit&&(ee(ke,!1),ke.strm.avail_out===0)?D:Z}(le,ge):le.strategy===3?function(ke,lt){for(var Rt,ht,Pt,qt,Lt=ke.window;;){if(ke.lookahead<=P){if(Ie(ke),ke.lookahead<=P&&lt===d)return D;if(ke.lookahead===0)break}if(ke.match_length=0,ke.lookahead>=I&&0<ke.strstart&&(ht=Lt[Pt=ke.strstart-1])===Lt[++Pt]&&ht===Lt[++Pt]&&ht===Lt[++Pt]){qt=ke.strstart+P;do;while(ht===Lt[++Pt]&&ht===Lt[++Pt]&&ht===Lt[++Pt]&&ht===Lt[++Pt]&&ht===Lt[++Pt]&&ht===Lt[++Pt]&&ht===Lt[++Pt]&&ht===Lt[++Pt]&&Pt<qt);ke.match_length=P-(qt-Pt),ke.match_length>ke.lookahead&&(ke.match_length=ke.lookahead)}if(ke.match_length>=I?(Rt=o._tr_tally(ke,1,ke.match_length-I),ke.lookahead-=ke.match_length,ke.strstart+=ke.match_length,ke.match_length=0):(Rt=o._tr_tally(ke,0,ke.window[ke.strstart]),ke.lookahead--,ke.strstart++),Rt&&(ee(ke,!1),ke.strm.avail_out===0))return D}return ke.insert=0,lt===h?(ee(ke,!0),ke.strm.avail_out===0?U:H):ke.last_lit&&(ee(ke,!1),ke.strm.avail_out===0)?D:Z}(le,ge):i[le.level].func(le,ge);if(Be!==U&&Be!==H||(le.status=666),Be===D||Be===U)return K.avail_out===0&&(le.last_flush=-1),m;if(Be===Z&&(ge===1?o._tr_align(le):ge!==5&&(o._tr_stored_block(le,0,0,!1),ge===3&&(W(le.head),le.lookahead===0&&(le.strstart=0,le.block_start=0,le.insert=0))),Q(K),K.avail_out===0))return le.last_flush=-1,m}return ge!==h?m:le.wrap<=0?1:(le.wrap===2?(se(le,255&K.adler),se(le,K.adler>>8&255),se(le,K.adler>>16&255),se(le,K.adler>>24&255),se(le,255&K.total_in),se(le,K.total_in>>8&255),se(le,K.total_in>>16&255),se(le,K.total_in>>24&255)):(pe(le,K.adler>>>16),pe(le,65535&K.adler)),Q(K),0<le.wrap&&(le.wrap=-le.wrap),le.pending!==0?m:1)},s.deflateEnd=function(K){var ge;return K&&K.state?(ge=K.state.status)!==O&&ge!==69&&ge!==73&&ge!==91&&ge!==103&&ge!==V&&ge!==666?$(K,y):(K.state=null,ge===V?$(K,-3):m):y},s.deflateSetDictionary=function(K,ge){var Ae,le,oe,re,Te,Be,ke,lt,Rt=ge.length;if(!K||!K.state||(re=(Ae=K.state).wrap)===2||re===1&&Ae.status!==O||Ae.lookahead)return y;for(re===1&&(K.adler=l(K.adler,ge,Rt,0)),Ae.wrap=0,Rt>=Ae.w_size&&(re===0&&(W(Ae.head),Ae.strstart=0,Ae.block_start=0,Ae.insert=0),lt=new a.Buf8(Ae.w_size),a.arraySet(lt,ge,Rt-Ae.w_size,Ae.w_size,0),ge=lt,Rt=Ae.w_size),Te=K.avail_in,Be=K.next_in,ke=K.input,K.avail_in=Rt,K.next_in=0,K.input=ge,Ie(Ae);Ae.lookahead>=I;){for(le=Ae.strstart,oe=Ae.lookahead-(I-1);Ae.ins_h=(Ae.ins_h<<Ae.hash_shift^Ae.window[le+I-1])&Ae.hash_mask,Ae.prev[le&Ae.w_mask]=Ae.head[Ae.ins_h],Ae.head[Ae.ins_h]=le,le++,--oe;);Ae.strstart=le,Ae.lookahead=I-1,Ie(Ae)}return Ae.strstart+=Ae.lookahead,Ae.block_start=Ae.strstart,Ae.insert=Ae.lookahead,Ae.lookahead=0,Ae.match_length=Ae.prev_length=I-1,Ae.match_available=0,K.next_in=Be,K.input=ke,K.avail_in=Te,Ae.wrap=re,m},s.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(n,r,s){r.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(n,r,s){r.exports=function(i,a){var o,l,c,u,d,h,m,y,b,v,x,w,S,C,k,A,R,N,I,P,L,O,V,D,Z;o=i.state,l=i.next_in,D=i.input,c=l+(i.avail_in-5),u=i.next_out,Z=i.output,d=u-(a-i.avail_out),h=u+(i.avail_out-257),m=o.dmax,y=o.wsize,b=o.whave,v=o.wnext,x=o.window,w=o.hold,S=o.bits,C=o.lencode,k=o.distcode,A=(1<<o.lenbits)-1,R=(1<<o.distbits)-1;e:do{S<15&&(w+=D[l++]<<S,S+=8,w+=D[l++]<<S,S+=8),N=C[w&A];t:for(;;){if(w>>>=I=N>>>24,S-=I,(I=N>>>16&255)===0)Z[u++]=65535&N;else{if(!(16&I)){if((64&I)==0){N=C[(65535&N)+(w&(1<<I)-1)];continue t}if(32&I){o.mode=12;break e}i.msg="invalid literal/length code",o.mode=30;break e}P=65535&N,(I&=15)&&(S<I&&(w+=D[l++]<<S,S+=8),P+=w&(1<<I)-1,w>>>=I,S-=I),S<15&&(w+=D[l++]<<S,S+=8,w+=D[l++]<<S,S+=8),N=k[w&R];n:for(;;){if(w>>>=I=N>>>24,S-=I,!(16&(I=N>>>16&255))){if((64&I)==0){N=k[(65535&N)+(w&(1<<I)-1)];continue n}i.msg="invalid distance code",o.mode=30;break e}if(L=65535&N,S<(I&=15)&&(w+=D[l++]<<S,(S+=8)<I&&(w+=D[l++]<<S,S+=8)),m<(L+=w&(1<<I)-1)){i.msg="invalid distance too far back",o.mode=30;break e}if(w>>>=I,S-=I,(I=u-d)<L){if(b<(I=L-I)&&o.sane){i.msg="invalid distance too far back",o.mode=30;break e}if(V=x,(O=0)===v){if(O+=y-I,I<P){for(P-=I;Z[u++]=x[O++],--I;);O=u-L,V=Z}}else if(v<I){if(O+=y+v-I,(I-=v)<P){for(P-=I;Z[u++]=x[O++],--I;);if(O=0,v<P){for(P-=I=v;Z[u++]=x[O++],--I;);O=u-L,V=Z}}}else if(O+=v-I,I<P){for(P-=I;Z[u++]=x[O++],--I;);O=u-L,V=Z}for(;2<P;)Z[u++]=V[O++],Z[u++]=V[O++],Z[u++]=V[O++],P-=3;P&&(Z[u++]=V[O++],1<P&&(Z[u++]=V[O++]))}else{for(O=u-L;Z[u++]=Z[O++],Z[u++]=Z[O++],Z[u++]=Z[O++],2<(P-=3););P&&(Z[u++]=Z[O++],1<P&&(Z[u++]=Z[O++]))}break}}break}}while(l<c&&u<h);l-=P=S>>3,w&=(1<<(S-=P<<3))-1,i.next_in=l,i.next_out=u,i.avail_in=l<c?c-l+5:5-(l-c),i.avail_out=u<h?h-u+257:257-(u-h),o.hold=w,o.bits=S}},{}],49:[function(n,r,s){var i=n("../utils/common"),a=n("./adler32"),o=n("./crc32"),l=n("./inffast"),c=n("./inftrees"),u=1,d=2,h=0,m=-2,y=1,b=852,v=592;function x(O){return(O>>>24&255)+(O>>>8&65280)+((65280&O)<<8)+((255&O)<<24)}function w(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new i.Buf16(320),this.work=new i.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function S(O){var V;return O&&O.state?(V=O.state,O.total_in=O.total_out=V.total=0,O.msg="",V.wrap&&(O.adler=1&V.wrap),V.mode=y,V.last=0,V.havedict=0,V.dmax=32768,V.head=null,V.hold=0,V.bits=0,V.lencode=V.lendyn=new i.Buf32(b),V.distcode=V.distdyn=new i.Buf32(v),V.sane=1,V.back=-1,h):m}function C(O){var V;return O&&O.state?((V=O.state).wsize=0,V.whave=0,V.wnext=0,S(O)):m}function k(O,V){var D,Z;return O&&O.state?(Z=O.state,V<0?(D=0,V=-V):(D=1+(V>>4),V<48&&(V&=15)),V&&(V<8||15<V)?m:(Z.window!==null&&Z.wbits!==V&&(Z.window=null),Z.wrap=D,Z.wbits=V,C(O))):m}function A(O,V){var D,Z;return O?(Z=new w,(O.state=Z).window=null,(D=k(O,V))!==h&&(O.state=null),D):m}var R,N,I=!0;function P(O){if(I){var V;for(R=new i.Buf32(512),N=new i.Buf32(32),V=0;V<144;)O.lens[V++]=8;for(;V<256;)O.lens[V++]=9;for(;V<280;)O.lens[V++]=7;for(;V<288;)O.lens[V++]=8;for(c(u,O.lens,0,288,R,0,O.work,{bits:9}),V=0;V<32;)O.lens[V++]=5;c(d,O.lens,0,32,N,0,O.work,{bits:5}),I=!1}O.lencode=R,O.lenbits=9,O.distcode=N,O.distbits=5}function L(O,V,D,Z){var U,H=O.state;return H.window===null&&(H.wsize=1<<H.wbits,H.wnext=0,H.whave=0,H.window=new i.Buf8(H.wsize)),Z>=H.wsize?(i.arraySet(H.window,V,D-H.wsize,H.wsize,0),H.wnext=0,H.whave=H.wsize):(Z<(U=H.wsize-H.wnext)&&(U=Z),i.arraySet(H.window,V,D-Z,U,H.wnext),(Z-=U)?(i.arraySet(H.window,V,D-Z,Z,0),H.wnext=Z,H.whave=H.wsize):(H.wnext+=U,H.wnext===H.wsize&&(H.wnext=0),H.whave<H.wsize&&(H.whave+=U))),0}s.inflateReset=C,s.inflateReset2=k,s.inflateResetKeep=S,s.inflateInit=function(O){return A(O,15)},s.inflateInit2=A,s.inflate=function(O,V){var D,Z,U,H,$,ne,W,Q,ee,se,pe,ce,Ie,De,Se,Ce,qe,Qe,Ve,Ne,K,ge,Ae,le,oe=0,re=new i.Buf8(4),Te=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!O||!O.state||!O.output||!O.input&&O.avail_in!==0)return m;(D=O.state).mode===12&&(D.mode=13),$=O.next_out,U=O.output,W=O.avail_out,H=O.next_in,Z=O.input,ne=O.avail_in,Q=D.hold,ee=D.bits,se=ne,pe=W,ge=h;e:for(;;)switch(D.mode){case y:if(D.wrap===0){D.mode=13;break}for(;ee<16;){if(ne===0)break e;ne--,Q+=Z[H++]<<ee,ee+=8}if(2&D.wrap&&Q===35615){re[D.check=0]=255&Q,re[1]=Q>>>8&255,D.check=o(D.check,re,2,0),ee=Q=0,D.mode=2;break}if(D.flags=0,D.head&&(D.head.done=!1),!(1&D.wrap)||(((255&Q)<<8)+(Q>>8))%31){O.msg="incorrect header check",D.mode=30;break}if((15&Q)!=8){O.msg="unknown compression method",D.mode=30;break}if(ee-=4,K=8+(15&(Q>>>=4)),D.wbits===0)D.wbits=K;else if(K>D.wbits){O.msg="invalid window size",D.mode=30;break}D.dmax=1<<K,O.adler=D.check=1,D.mode=512&Q?10:12,ee=Q=0;break;case 2:for(;ee<16;){if(ne===0)break e;ne--,Q+=Z[H++]<<ee,ee+=8}if(D.flags=Q,(255&D.flags)!=8){O.msg="unknown compression method",D.mode=30;break}if(57344&D.flags){O.msg="unknown header flags set",D.mode=30;break}D.head&&(D.head.text=Q>>8&1),512&D.flags&&(re[0]=255&Q,re[1]=Q>>>8&255,D.check=o(D.check,re,2,0)),ee=Q=0,D.mode=3;case 3:for(;ee<32;){if(ne===0)break e;ne--,Q+=Z[H++]<<ee,ee+=8}D.head&&(D.head.time=Q),512&D.flags&&(re[0]=255&Q,re[1]=Q>>>8&255,re[2]=Q>>>16&255,re[3]=Q>>>24&255,D.check=o(D.check,re,4,0)),ee=Q=0,D.mode=4;case 4:for(;ee<16;){if(ne===0)break e;ne--,Q+=Z[H++]<<ee,ee+=8}D.head&&(D.head.xflags=255&Q,D.head.os=Q>>8),512&D.flags&&(re[0]=255&Q,re[1]=Q>>>8&255,D.check=o(D.check,re,2,0)),ee=Q=0,D.mode=5;case 5:if(1024&D.flags){for(;ee<16;){if(ne===0)break e;ne--,Q+=Z[H++]<<ee,ee+=8}D.length=Q,D.head&&(D.head.extra_len=Q),512&D.flags&&(re[0]=255&Q,re[1]=Q>>>8&255,D.check=o(D.check,re,2,0)),ee=Q=0}else D.head&&(D.head.extra=null);D.mode=6;case 6:if(1024&D.flags&&(ne<(ce=D.length)&&(ce=ne),ce&&(D.head&&(K=D.head.extra_len-D.length,D.head.extra||(D.head.extra=new Array(D.head.extra_len)),i.arraySet(D.head.extra,Z,H,ce,K)),512&D.flags&&(D.check=o(D.check,Z,ce,H)),ne-=ce,H+=ce,D.length-=ce),D.length))break e;D.length=0,D.mode=7;case 7:if(2048&D.flags){if(ne===0)break e;for(ce=0;K=Z[H+ce++],D.head&&K&&D.length<65536&&(D.head.name+=String.fromCharCode(K)),K&&ce<ne;);if(512&D.flags&&(D.check=o(D.check,Z,ce,H)),ne-=ce,H+=ce,K)break e}else D.head&&(D.head.name=null);D.length=0,D.mode=8;case 8:if(4096&D.flags){if(ne===0)break e;for(ce=0;K=Z[H+ce++],D.head&&K&&D.length<65536&&(D.head.comment+=String.fromCharCode(K)),K&&ce<ne;);if(512&D.flags&&(D.check=o(D.check,Z,ce,H)),ne-=ce,H+=ce,K)break e}else D.head&&(D.head.comment=null);D.mode=9;case 9:if(512&D.flags){for(;ee<16;){if(ne===0)break e;ne--,Q+=Z[H++]<<ee,ee+=8}if(Q!==(65535&D.check)){O.msg="header crc mismatch",D.mode=30;break}ee=Q=0}D.head&&(D.head.hcrc=D.flags>>9&1,D.head.done=!0),O.adler=D.check=0,D.mode=12;break;case 10:for(;ee<32;){if(ne===0)break e;ne--,Q+=Z[H++]<<ee,ee+=8}O.adler=D.check=x(Q),ee=Q=0,D.mode=11;case 11:if(D.havedict===0)return O.next_out=$,O.avail_out=W,O.next_in=H,O.avail_in=ne,D.hold=Q,D.bits=ee,2;O.adler=D.check=1,D.mode=12;case 12:if(V===5||V===6)break e;case 13:if(D.last){Q>>>=7&ee,ee-=7&ee,D.mode=27;break}for(;ee<3;){if(ne===0)break e;ne--,Q+=Z[H++]<<ee,ee+=8}switch(D.last=1&Q,ee-=1,3&(Q>>>=1)){case 0:D.mode=14;break;case 1:if(P(D),D.mode=20,V!==6)break;Q>>>=2,ee-=2;break e;case 2:D.mode=17;break;case 3:O.msg="invalid block type",D.mode=30}Q>>>=2,ee-=2;break;case 14:for(Q>>>=7&ee,ee-=7&ee;ee<32;){if(ne===0)break e;ne--,Q+=Z[H++]<<ee,ee+=8}if((65535&Q)!=(Q>>>16^65535)){O.msg="invalid stored block lengths",D.mode=30;break}if(D.length=65535&Q,ee=Q=0,D.mode=15,V===6)break e;case 15:D.mode=16;case 16:if(ce=D.length){if(ne<ce&&(ce=ne),W<ce&&(ce=W),ce===0)break e;i.arraySet(U,Z,H,ce,$),ne-=ce,H+=ce,W-=ce,$+=ce,D.length-=ce;break}D.mode=12;break;case 17:for(;ee<14;){if(ne===0)break e;ne--,Q+=Z[H++]<<ee,ee+=8}if(D.nlen=257+(31&Q),Q>>>=5,ee-=5,D.ndist=1+(31&Q),Q>>>=5,ee-=5,D.ncode=4+(15&Q),Q>>>=4,ee-=4,286<D.nlen||30<D.ndist){O.msg="too many length or distance symbols",D.mode=30;break}D.have=0,D.mode=18;case 18:for(;D.have<D.ncode;){for(;ee<3;){if(ne===0)break e;ne--,Q+=Z[H++]<<ee,ee+=8}D.lens[Te[D.have++]]=7&Q,Q>>>=3,ee-=3}for(;D.have<19;)D.lens[Te[D.have++]]=0;if(D.lencode=D.lendyn,D.lenbits=7,Ae={bits:D.lenbits},ge=c(0,D.lens,0,19,D.lencode,0,D.work,Ae),D.lenbits=Ae.bits,ge){O.msg="invalid code lengths set",D.mode=30;break}D.have=0,D.mode=19;case 19:for(;D.have<D.nlen+D.ndist;){for(;Ce=(oe=D.lencode[Q&(1<<D.lenbits)-1])>>>16&255,qe=65535&oe,!((Se=oe>>>24)<=ee);){if(ne===0)break e;ne--,Q+=Z[H++]<<ee,ee+=8}if(qe<16)Q>>>=Se,ee-=Se,D.lens[D.have++]=qe;else{if(qe===16){for(le=Se+2;ee<le;){if(ne===0)break e;ne--,Q+=Z[H++]<<ee,ee+=8}if(Q>>>=Se,ee-=Se,D.have===0){O.msg="invalid bit length repeat",D.mode=30;break}K=D.lens[D.have-1],ce=3+(3&Q),Q>>>=2,ee-=2}else if(qe===17){for(le=Se+3;ee<le;){if(ne===0)break e;ne--,Q+=Z[H++]<<ee,ee+=8}ee-=Se,K=0,ce=3+(7&(Q>>>=Se)),Q>>>=3,ee-=3}else{for(le=Se+7;ee<le;){if(ne===0)break e;ne--,Q+=Z[H++]<<ee,ee+=8}ee-=Se,K=0,ce=11+(127&(Q>>>=Se)),Q>>>=7,ee-=7}if(D.have+ce>D.nlen+D.ndist){O.msg="invalid bit length repeat",D.mode=30;break}for(;ce--;)D.lens[D.have++]=K}}if(D.mode===30)break;if(D.lens[256]===0){O.msg="invalid code -- missing end-of-block",D.mode=30;break}if(D.lenbits=9,Ae={bits:D.lenbits},ge=c(u,D.lens,0,D.nlen,D.lencode,0,D.work,Ae),D.lenbits=Ae.bits,ge){O.msg="invalid literal/lengths set",D.mode=30;break}if(D.distbits=6,D.distcode=D.distdyn,Ae={bits:D.distbits},ge=c(d,D.lens,D.nlen,D.ndist,D.distcode,0,D.work,Ae),D.distbits=Ae.bits,ge){O.msg="invalid distances set",D.mode=30;break}if(D.mode=20,V===6)break e;case 20:D.mode=21;case 21:if(6<=ne&&258<=W){O.next_out=$,O.avail_out=W,O.next_in=H,O.avail_in=ne,D.hold=Q,D.bits=ee,l(O,pe),$=O.next_out,U=O.output,W=O.avail_out,H=O.next_in,Z=O.input,ne=O.avail_in,Q=D.hold,ee=D.bits,D.mode===12&&(D.back=-1);break}for(D.back=0;Ce=(oe=D.lencode[Q&(1<<D.lenbits)-1])>>>16&255,qe=65535&oe,!((Se=oe>>>24)<=ee);){if(ne===0)break e;ne--,Q+=Z[H++]<<ee,ee+=8}if(Ce&&(240&Ce)==0){for(Qe=Se,Ve=Ce,Ne=qe;Ce=(oe=D.lencode[Ne+((Q&(1<<Qe+Ve)-1)>>Qe)])>>>16&255,qe=65535&oe,!(Qe+(Se=oe>>>24)<=ee);){if(ne===0)break e;ne--,Q+=Z[H++]<<ee,ee+=8}Q>>>=Qe,ee-=Qe,D.back+=Qe}if(Q>>>=Se,ee-=Se,D.back+=Se,D.length=qe,Ce===0){D.mode=26;break}if(32&Ce){D.back=-1,D.mode=12;break}if(64&Ce){O.msg="invalid literal/length code",D.mode=30;break}D.extra=15&Ce,D.mode=22;case 22:if(D.extra){for(le=D.extra;ee<le;){if(ne===0)break e;ne--,Q+=Z[H++]<<ee,ee+=8}D.length+=Q&(1<<D.extra)-1,Q>>>=D.extra,ee-=D.extra,D.back+=D.extra}D.was=D.length,D.mode=23;case 23:for(;Ce=(oe=D.distcode[Q&(1<<D.distbits)-1])>>>16&255,qe=65535&oe,!((Se=oe>>>24)<=ee);){if(ne===0)break e;ne--,Q+=Z[H++]<<ee,ee+=8}if((240&Ce)==0){for(Qe=Se,Ve=Ce,Ne=qe;Ce=(oe=D.distcode[Ne+((Q&(1<<Qe+Ve)-1)>>Qe)])>>>16&255,qe=65535&oe,!(Qe+(Se=oe>>>24)<=ee);){if(ne===0)break e;ne--,Q+=Z[H++]<<ee,ee+=8}Q>>>=Qe,ee-=Qe,D.back+=Qe}if(Q>>>=Se,ee-=Se,D.back+=Se,64&Ce){O.msg="invalid distance code",D.mode=30;break}D.offset=qe,D.extra=15&Ce,D.mode=24;case 24:if(D.extra){for(le=D.extra;ee<le;){if(ne===0)break e;ne--,Q+=Z[H++]<<ee,ee+=8}D.offset+=Q&(1<<D.extra)-1,Q>>>=D.extra,ee-=D.extra,D.back+=D.extra}if(D.offset>D.dmax){O.msg="invalid distance too far back",D.mode=30;break}D.mode=25;case 25:if(W===0)break e;if(ce=pe-W,D.offset>ce){if((ce=D.offset-ce)>D.whave&&D.sane){O.msg="invalid distance too far back",D.mode=30;break}Ie=ce>D.wnext?(ce-=D.wnext,D.wsize-ce):D.wnext-ce,ce>D.length&&(ce=D.length),De=D.window}else De=U,Ie=$-D.offset,ce=D.length;for(W<ce&&(ce=W),W-=ce,D.length-=ce;U[$++]=De[Ie++],--ce;);D.length===0&&(D.mode=21);break;case 26:if(W===0)break e;U[$++]=D.length,W--,D.mode=21;break;case 27:if(D.wrap){for(;ee<32;){if(ne===0)break e;ne--,Q|=Z[H++]<<ee,ee+=8}if(pe-=W,O.total_out+=pe,D.total+=pe,pe&&(O.adler=D.check=D.flags?o(D.check,U,pe,$-pe):a(D.check,U,pe,$-pe)),pe=W,(D.flags?Q:x(Q))!==D.check){O.msg="incorrect data check",D.mode=30;break}ee=Q=0}D.mode=28;case 28:if(D.wrap&&D.flags){for(;ee<32;){if(ne===0)break e;ne--,Q+=Z[H++]<<ee,ee+=8}if(Q!==(4294967295&D.total)){O.msg="incorrect length check",D.mode=30;break}ee=Q=0}D.mode=29;case 29:ge=1;break e;case 30:ge=-3;break e;case 31:return-4;case 32:default:return m}return O.next_out=$,O.avail_out=W,O.next_in=H,O.avail_in=ne,D.hold=Q,D.bits=ee,(D.wsize||pe!==O.avail_out&&D.mode<30&&(D.mode<27||V!==4))&&L(O,O.output,O.next_out,pe-O.avail_out)?(D.mode=31,-4):(se-=O.avail_in,pe-=O.avail_out,O.total_in+=se,O.total_out+=pe,D.total+=pe,D.wrap&&pe&&(O.adler=D.check=D.flags?o(D.check,U,pe,O.next_out-pe):a(D.check,U,pe,O.next_out-pe)),O.data_type=D.bits+(D.last?64:0)+(D.mode===12?128:0)+(D.mode===20||D.mode===15?256:0),(se==0&&pe===0||V===4)&&ge===h&&(ge=-5),ge)},s.inflateEnd=function(O){if(!O||!O.state)return m;var V=O.state;return V.window&&(V.window=null),O.state=null,h},s.inflateGetHeader=function(O,V){var D;return O&&O.state?(2&(D=O.state).wrap)==0?m:((D.head=V).done=!1,h):m},s.inflateSetDictionary=function(O,V){var D,Z=V.length;return O&&O.state?(D=O.state).wrap!==0&&D.mode!==11?m:D.mode===11&&a(1,V,Z,0)!==D.check?-3:L(O,V,Z,Z)?(D.mode=31,-4):(D.havedict=1,h):m},s.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(n,r,s){var i=n("../utils/common"),a=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],o=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],l=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],c=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];r.exports=function(u,d,h,m,y,b,v,x){var w,S,C,k,A,R,N,I,P,L=x.bits,O=0,V=0,D=0,Z=0,U=0,H=0,$=0,ne=0,W=0,Q=0,ee=null,se=0,pe=new i.Buf16(16),ce=new i.Buf16(16),Ie=null,De=0;for(O=0;O<=15;O++)pe[O]=0;for(V=0;V<m;V++)pe[d[h+V]]++;for(U=L,Z=15;1<=Z&&pe[Z]===0;Z--);if(Z<U&&(U=Z),Z===0)return y[b++]=20971520,y[b++]=20971520,x.bits=1,0;for(D=1;D<Z&&pe[D]===0;D++);for(U<D&&(U=D),O=ne=1;O<=15;O++)if(ne<<=1,(ne-=pe[O])<0)return-1;if(0<ne&&(u===0||Z!==1))return-1;for(ce[1]=0,O=1;O<15;O++)ce[O+1]=ce[O]+pe[O];for(V=0;V<m;V++)d[h+V]!==0&&(v[ce[d[h+V]]++]=V);if(R=u===0?(ee=Ie=v,19):u===1?(ee=a,se-=257,Ie=o,De-=257,256):(ee=l,Ie=c,-1),O=D,A=b,$=V=Q=0,C=-1,k=(W=1<<(H=U))-1,u===1&&852<W||u===2&&592<W)return 1;for(;;){for(N=O-$,P=v[V]<R?(I=0,v[V]):v[V]>R?(I=Ie[De+v[V]],ee[se+v[V]]):(I=96,0),w=1<<O-$,D=S=1<<H;y[A+(Q>>$)+(S-=w)]=N<<24|I<<16|P|0,S!==0;);for(w=1<<O-1;Q&w;)w>>=1;if(w!==0?(Q&=w-1,Q+=w):Q=0,V++,--pe[O]==0){if(O===Z)break;O=d[h+v[V]]}if(U<O&&(Q&k)!==C){for($===0&&($=U),A+=D,ne=1<<(H=O-$);H+$<Z&&!((ne-=pe[H+$])<=0);)H++,ne<<=1;if(W+=1<<H,u===1&&852<W||u===2&&592<W)return 1;y[C=Q&k]=U<<24|H<<16|A-b|0}}return Q!==0&&(y[A+Q]=O-$<<24|64<<16|0),x.bits=U,0}},{"../utils/common":41}],51:[function(n,r,s){r.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(n,r,s){var i=n("../utils/common"),a=0,o=1;function l(oe){for(var re=oe.length;0<=--re;)oe[re]=0}var c=0,u=29,d=256,h=d+1+u,m=30,y=19,b=2*h+1,v=15,x=16,w=7,S=256,C=16,k=17,A=18,R=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],N=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],I=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],P=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],L=new Array(2*(h+2));l(L);var O=new Array(2*m);l(O);var V=new Array(512);l(V);var D=new Array(256);l(D);var Z=new Array(u);l(Z);var U,H,$,ne=new Array(m);function W(oe,re,Te,Be,ke){this.static_tree=oe,this.extra_bits=re,this.extra_base=Te,this.elems=Be,this.max_length=ke,this.has_stree=oe&&oe.length}function Q(oe,re){this.dyn_tree=oe,this.max_code=0,this.stat_desc=re}function ee(oe){return oe<256?V[oe]:V[256+(oe>>>7)]}function se(oe,re){oe.pending_buf[oe.pending++]=255&re,oe.pending_buf[oe.pending++]=re>>>8&255}function pe(oe,re,Te){oe.bi_valid>x-Te?(oe.bi_buf|=re<<oe.bi_valid&65535,se(oe,oe.bi_buf),oe.bi_buf=re>>x-oe.bi_valid,oe.bi_valid+=Te-x):(oe.bi_buf|=re<<oe.bi_valid&65535,oe.bi_valid+=Te)}function ce(oe,re,Te){pe(oe,Te[2*re],Te[2*re+1])}function Ie(oe,re){for(var Te=0;Te|=1&oe,oe>>>=1,Te<<=1,0<--re;);return Te>>>1}function De(oe,re,Te){var Be,ke,lt=new Array(v+1),Rt=0;for(Be=1;Be<=v;Be++)lt[Be]=Rt=Rt+Te[Be-1]<<1;for(ke=0;ke<=re;ke++){var ht=oe[2*ke+1];ht!==0&&(oe[2*ke]=Ie(lt[ht]++,ht))}}function Se(oe){var re;for(re=0;re<h;re++)oe.dyn_ltree[2*re]=0;for(re=0;re<m;re++)oe.dyn_dtree[2*re]=0;for(re=0;re<y;re++)oe.bl_tree[2*re]=0;oe.dyn_ltree[2*S]=1,oe.opt_len=oe.static_len=0,oe.last_lit=oe.matches=0}function Ce(oe){8<oe.bi_valid?se(oe,oe.bi_buf):0<oe.bi_valid&&(oe.pending_buf[oe.pending++]=oe.bi_buf),oe.bi_buf=0,oe.bi_valid=0}function qe(oe,re,Te,Be){var ke=2*re,lt=2*Te;return oe[ke]<oe[lt]||oe[ke]===oe[lt]&&Be[re]<=Be[Te]}function Qe(oe,re,Te){for(var Be=oe.heap[Te],ke=Te<<1;ke<=oe.heap_len&&(ke<oe.heap_len&&qe(re,oe.heap[ke+1],oe.heap[ke],oe.depth)&&ke++,!qe(re,Be,oe.heap[ke],oe.depth));)oe.heap[Te]=oe.heap[ke],Te=ke,ke<<=1;oe.heap[Te]=Be}function Ve(oe,re,Te){var Be,ke,lt,Rt,ht=0;if(oe.last_lit!==0)for(;Be=oe.pending_buf[oe.d_buf+2*ht]<<8|oe.pending_buf[oe.d_buf+2*ht+1],ke=oe.pending_buf[oe.l_buf+ht],ht++,Be===0?ce(oe,ke,re):(ce(oe,(lt=D[ke])+d+1,re),(Rt=R[lt])!==0&&pe(oe,ke-=Z[lt],Rt),ce(oe,lt=ee(--Be),Te),(Rt=N[lt])!==0&&pe(oe,Be-=ne[lt],Rt)),ht<oe.last_lit;);ce(oe,S,re)}function Ne(oe,re){var Te,Be,ke,lt=re.dyn_tree,Rt=re.stat_desc.static_tree,ht=re.stat_desc.has_stree,Pt=re.stat_desc.elems,qt=-1;for(oe.heap_len=0,oe.heap_max=b,Te=0;Te<Pt;Te++)lt[2*Te]!==0?(oe.heap[++oe.heap_len]=qt=Te,oe.depth[Te]=0):lt[2*Te+1]=0;for(;oe.heap_len<2;)lt[2*(ke=oe.heap[++oe.heap_len]=qt<2?++qt:0)]=1,oe.depth[ke]=0,oe.opt_len--,ht&&(oe.static_len-=Rt[2*ke+1]);for(re.max_code=qt,Te=oe.heap_len>>1;1<=Te;Te--)Qe(oe,lt,Te);for(ke=Pt;Te=oe.heap[1],oe.heap[1]=oe.heap[oe.heap_len--],Qe(oe,lt,1),Be=oe.heap[1],oe.heap[--oe.heap_max]=Te,oe.heap[--oe.heap_max]=Be,lt[2*ke]=lt[2*Te]+lt[2*Be],oe.depth[ke]=(oe.depth[Te]>=oe.depth[Be]?oe.depth[Te]:oe.depth[Be])+1,lt[2*Te+1]=lt[2*Be+1]=ke,oe.heap[1]=ke++,Qe(oe,lt,1),2<=oe.heap_len;);oe.heap[--oe.heap_max]=oe.heap[1],function(Lt,en){var xe,F,X,ye,Fe,we,Me=en.dyn_tree,de=en.max_code,vt=en.stat_desc.static_tree,ot=en.stat_desc.has_stree,B=en.stat_desc.extra_bits,ze=en.stat_desc.extra_base,st=en.stat_desc.max_length,be=0;for(ye=0;ye<=v;ye++)Lt.bl_count[ye]=0;for(Me[2*Lt.heap[Lt.heap_max]+1]=0,xe=Lt.heap_max+1;xe<b;xe++)st<(ye=Me[2*Me[2*(F=Lt.heap[xe])+1]+1]+1)&&(ye=st,be++),Me[2*F+1]=ye,de<F||(Lt.bl_count[ye]++,Fe=0,ze<=F&&(Fe=B[F-ze]),we=Me[2*F],Lt.opt_len+=we*(ye+Fe),ot&&(Lt.static_len+=we*(vt[2*F+1]+Fe)));if(be!==0){do{for(ye=st-1;Lt.bl_count[ye]===0;)ye--;Lt.bl_count[ye]--,Lt.bl_count[ye+1]+=2,Lt.bl_count[st]--,be-=2}while(0<be);for(ye=st;ye!==0;ye--)for(F=Lt.bl_count[ye];F!==0;)de<(X=Lt.heap[--xe])||(Me[2*X+1]!==ye&&(Lt.opt_len+=(ye-Me[2*X+1])*Me[2*X],Me[2*X+1]=ye),F--)}}(oe,re),De(lt,qt,oe.bl_count)}function K(oe,re,Te){var Be,ke,lt=-1,Rt=re[1],ht=0,Pt=7,qt=4;for(Rt===0&&(Pt=138,qt=3),re[2*(Te+1)+1]=65535,Be=0;Be<=Te;Be++)ke=Rt,Rt=re[2*(Be+1)+1],++ht<Pt&&ke===Rt||(ht<qt?oe.bl_tree[2*ke]+=ht:ke!==0?(ke!==lt&&oe.bl_tree[2*ke]++,oe.bl_tree[2*C]++):ht<=10?oe.bl_tree[2*k]++:oe.bl_tree[2*A]++,lt=ke,qt=(ht=0)===Rt?(Pt=138,3):ke===Rt?(Pt=6,3):(Pt=7,4))}function ge(oe,re,Te){var Be,ke,lt=-1,Rt=re[1],ht=0,Pt=7,qt=4;for(Rt===0&&(Pt=138,qt=3),Be=0;Be<=Te;Be++)if(ke=Rt,Rt=re[2*(Be+1)+1],!(++ht<Pt&&ke===Rt)){if(ht<qt)for(;ce(oe,ke,oe.bl_tree),--ht!=0;);else ke!==0?(ke!==lt&&(ce(oe,ke,oe.bl_tree),ht--),ce(oe,C,oe.bl_tree),pe(oe,ht-3,2)):ht<=10?(ce(oe,k,oe.bl_tree),pe(oe,ht-3,3)):(ce(oe,A,oe.bl_tree),pe(oe,ht-11,7));lt=ke,qt=(ht=0)===Rt?(Pt=138,3):ke===Rt?(Pt=6,3):(Pt=7,4)}}l(ne);var Ae=!1;function le(oe,re,Te,Be){pe(oe,(c<<1)+(Be?1:0),3),function(ke,lt,Rt,ht){Ce(ke),se(ke,Rt),se(ke,~Rt),i.arraySet(ke.pending_buf,ke.window,lt,Rt,ke.pending),ke.pending+=Rt}(oe,re,Te)}s._tr_init=function(oe){Ae||(function(){var re,Te,Be,ke,lt,Rt=new Array(v+1);for(ke=Be=0;ke<u-1;ke++)for(Z[ke]=Be,re=0;re<1<<R[ke];re++)D[Be++]=ke;for(D[Be-1]=ke,ke=lt=0;ke<16;ke++)for(ne[ke]=lt,re=0;re<1<<N[ke];re++)V[lt++]=ke;for(lt>>=7;ke<m;ke++)for(ne[ke]=lt<<7,re=0;re<1<<N[ke]-7;re++)V[256+lt++]=ke;for(Te=0;Te<=v;Te++)Rt[Te]=0;for(re=0;re<=143;)L[2*re+1]=8,re++,Rt[8]++;for(;re<=255;)L[2*re+1]=9,re++,Rt[9]++;for(;re<=279;)L[2*re+1]=7,re++,Rt[7]++;for(;re<=287;)L[2*re+1]=8,re++,Rt[8]++;for(De(L,h+1,Rt),re=0;re<m;re++)O[2*re+1]=5,O[2*re]=Ie(re,5);U=new W(L,R,d+1,h,v),H=new W(O,N,0,m,v),$=new W(new Array(0),I,0,y,w)}(),Ae=!0),oe.l_desc=new Q(oe.dyn_ltree,U),oe.d_desc=new Q(oe.dyn_dtree,H),oe.bl_desc=new Q(oe.bl_tree,$),oe.bi_buf=0,oe.bi_valid=0,Se(oe)},s._tr_stored_block=le,s._tr_flush_block=function(oe,re,Te,Be){var ke,lt,Rt=0;0<oe.level?(oe.strm.data_type===2&&(oe.strm.data_type=function(ht){var Pt,qt=4093624447;for(Pt=0;Pt<=31;Pt++,qt>>>=1)if(1&qt&&ht.dyn_ltree[2*Pt]!==0)return a;if(ht.dyn_ltree[18]!==0||ht.dyn_ltree[20]!==0||ht.dyn_ltree[26]!==0)return o;for(Pt=32;Pt<d;Pt++)if(ht.dyn_ltree[2*Pt]!==0)return o;return a}(oe)),Ne(oe,oe.l_desc),Ne(oe,oe.d_desc),Rt=function(ht){var Pt;for(K(ht,ht.dyn_ltree,ht.l_desc.max_code),K(ht,ht.dyn_dtree,ht.d_desc.max_code),Ne(ht,ht.bl_desc),Pt=y-1;3<=Pt&&ht.bl_tree[2*P[Pt]+1]===0;Pt--);return ht.opt_len+=3*(Pt+1)+5+5+4,Pt}(oe),ke=oe.opt_len+3+7>>>3,(lt=oe.static_len+3+7>>>3)<=ke&&(ke=lt)):ke=lt=Te+5,Te+4<=ke&&re!==-1?le(oe,re,Te,Be):oe.strategy===4||lt===ke?(pe(oe,2+(Be?1:0),3),Ve(oe,L,O)):(pe(oe,4+(Be?1:0),3),function(ht,Pt,qt,Lt){var en;for(pe(ht,Pt-257,5),pe(ht,qt-1,5),pe(ht,Lt-4,4),en=0;en<Lt;en++)pe(ht,ht.bl_tree[2*P[en]+1],3);ge(ht,ht.dyn_ltree,Pt-1),ge(ht,ht.dyn_dtree,qt-1)}(oe,oe.l_desc.max_code+1,oe.d_desc.max_code+1,Rt+1),Ve(oe,oe.dyn_ltree,oe.dyn_dtree)),Se(oe),Be&&Ce(oe)},s._tr_tally=function(oe,re,Te){return oe.pending_buf[oe.d_buf+2*oe.last_lit]=re>>>8&255,oe.pending_buf[oe.d_buf+2*oe.last_lit+1]=255&re,oe.pending_buf[oe.l_buf+oe.last_lit]=255&Te,oe.last_lit++,re===0?oe.dyn_ltree[2*Te]++:(oe.matches++,re--,oe.dyn_ltree[2*(D[Te]+d+1)]++,oe.dyn_dtree[2*ee(re)]++),oe.last_lit===oe.lit_bufsize-1},s._tr_align=function(oe){pe(oe,2,3),ce(oe,S,L),function(re){re.bi_valid===16?(se(re,re.bi_buf),re.bi_buf=0,re.bi_valid=0):8<=re.bi_valid&&(re.pending_buf[re.pending++]=255&re.bi_buf,re.bi_buf>>=8,re.bi_valid-=8)}(oe)}},{"../utils/common":41}],53:[function(n,r,s){r.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(n,r,s){(function(i){(function(a,o){if(!a.setImmediate){var l,c,u,d,h=1,m={},y=!1,b=a.document,v=Object.getPrototypeOf&&Object.getPrototypeOf(a);v=v&&v.setTimeout?v:a,l={}.toString.call(a.process)==="[object process]"?function(C){Ai.nextTick(function(){w(C)})}:function(){if(a.postMessage&&!a.importScripts){var C=!0,k=a.onmessage;return a.onmessage=function(){C=!1},a.postMessage("","*"),a.onmessage=k,C}}()?(d="setImmediate$"+Math.random()+"$",a.addEventListener?a.addEventListener("message",S,!1):a.attachEvent("onmessage",S),function(C){a.postMessage(d+C,"*")}):a.MessageChannel?((u=new MessageChannel).port1.onmessage=function(C){w(C.data)},function(C){u.port2.postMessage(C)}):b&&"onreadystatechange"in b.createElement("script")?(c=b.documentElement,function(C){var k=b.createElement("script");k.onreadystatechange=function(){w(C),k.onreadystatechange=null,c.removeChild(k),k=null},c.appendChild(k)}):function(C){setTimeout(w,0,C)},v.setImmediate=function(C){typeof C!="function"&&(C=new Function(""+C));for(var k=new Array(arguments.length-1),A=0;A<k.length;A++)k[A]=arguments[A+1];var R={callback:C,args:k};return m[h]=R,l(h),h++},v.clearImmediate=x}function x(C){delete m[C]}function w(C){if(y)setTimeout(w,0,C);else{var k=m[C];if(k){y=!0;try{(function(A){var R=A.callback,N=A.args;switch(N.length){case 0:R();break;case 1:R(N[0]);break;case 2:R(N[0],N[1]);break;case 3:R(N[0],N[1],N[2]);break;default:R.apply(o,N)}})(k)}finally{x(C),y=!1}}}}function S(C){C.source===a&&typeof C.data=="string"&&C.data.indexOf(d)===0&&w(+C.data.slice(d.length))}})(typeof self>"u"?i===void 0?this:i:self)}).call(this,typeof Xp<"u"?Xp:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})}(EM)),EM.exports}var g2e=m2e();const eD=_a(g2e),iw=(e,t=2)=>{if(e===0)return"0 Bytes";const n=1024,r=t<0?0:t,s=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],i=Math.floor(Math.log(e)/Math.log(n));return parseFloat((e/Math.pow(n,i)).toFixed(r))+" "+s[i]},zr=e=>{let t=e.replace(/\/+/g,"/");return t.startsWith("/")||(t="/"+t),t!=="/"&&t.endsWith("/")&&(t=t.slice(0,-1)),t},Pu=(...e)=>zr(e.map(t=>t.trim()).filter(Boolean).join("/")),ZE=e=>{const t=zr(e);if(t==="/")return"/";const n=t.lastIndexOf("/");return n===-1||n===0?"/":t.substring(0,n)},gi=e=>{const t=zr(e);return t==="/"?"":t.substring(t.lastIndexOf("/")+1)},kj=(e,t)=>zr(e==="/"?`/${t}`:`${e}/${t}`);var TM,M9;function y2e(){if(M9)return TM;M9=1;var e=function(t){if(t=t||{},this.Promise=t.Promise||Promise,this.queues=Object.create(null),this.domainReentrant=t.domainReentrant||!1,this.domainReentrant){if(typeof Ai>"u"||typeof Ai.domain>"u")throw new Error("Domain-reentrant locks require `process.domain` to exist. Please flip `opts.domainReentrant = false`, use a NodeJS version that still implements Domain, or install a browser polyfill.");this.domains=Object.create(null)}this.timeout=t.timeout||e.DEFAULT_TIMEOUT,this.maxOccupationTime=t.maxOccupationTime||e.DEFAULT_MAX_OCCUPATION_TIME,this.maxExecutionTime=t.maxExecutionTime||e.DEFAULT_MAX_EXECUTION_TIME,t.maxPending===1/0||Number.isInteger(t.maxPending)&&t.maxPending>=0?this.maxPending=t.maxPending:this.maxPending=e.DEFAULT_MAX_PENDING};return e.DEFAULT_TIMEOUT=0,e.DEFAULT_MAX_OCCUPATION_TIME=0,e.DEFAULT_MAX_EXECUTION_TIME=0,e.DEFAULT_MAX_PENDING=1e3,e.prototype.acquire=function(t,n,r,s){if(Array.isArray(t))return this._acquireBatch(t,n,r,s);if(typeof n!="function")throw new Error("You must pass a function to execute");var i=null,a=null,o=null;typeof r!="function"&&(s=r,r=null,o=new this.Promise(function(S,C){i=S,a=C})),s=s||{};var l=!1,c=null,u=null,d=null,h=this,m=function(S,C,k){u&&(clearTimeout(u),u=null),d&&(clearTimeout(d),d=null),S&&(h.queues[t]&&h.queues[t].length===0&&delete h.queues[t],h.domainReentrant&&delete h.domains[t]),l||(o?C?a(C):i(k):typeof r=="function"&&r(C,k),l=!0),S&&h.queues[t]&&h.queues[t].length>0&&h.queues[t].shift()()},y=function(S){if(l)return m(S);c&&(clearTimeout(c),c=null),h.domainReentrant&&S&&(h.domains[t]=Ai.domain);var C=s.maxExecutionTime||h.maxExecutionTime;if(C&&(d=setTimeout(function(){h.queues[t]&&m(S,new Error("Maximum execution time is exceeded "+t))},C)),n.length===1){var k=!1;try{n(function(A,R){k||(k=!0,m(S,A,R))})}catch(A){k||(k=!0,m(S,A))}}else h._promiseTry(function(){return n()}).then(function(A){m(S,void 0,A)},function(A){m(S,A)})};h.domainReentrant&&Ai.domain&&(y=Ai.domain.bind(y));var b=s.maxPending||h.maxPending;if(!h.queues[t])h.queues[t]=[],y(!0);else if(h.domainReentrant&&Ai.domain&&Ai.domain===h.domains[t])y(!1);else if(h.queues[t].length>=b)m(!1,new Error("Too many pending tasks in queue "+t));else{var v=function(){y(!0)};s.skipQueue?h.queues[t].unshift(v):h.queues[t].push(v);var x=s.timeout||h.timeout;x&&(c=setTimeout(function(){c=null,m(!1,new Error("async-lock timed out in queue "+t))},x))}var w=s.maxOccupationTime||h.maxOccupationTime;if(w&&(u=setTimeout(function(){h.queues[t]&&m(!1,new Error("Maximum occupation time is exceeded in queue "+t))},w)),o)return o},e.prototype._acquireBatch=function(t,n,r,s){typeof r!="function"&&(s=r,r=null);var i=this,a=function(l,c){return function(u){i.acquire(l,c,u,s)}},o=t.reduceRight(function(l,c){return a(c,l)},n);if(typeof r=="function")o(r);else return new this.Promise(function(l,c){o.length===1?o(function(u,d){u?c(u):l(d)}):l(o())})},e.prototype.isBusy=function(t){return t?!!this.queues[t]:Object.keys(this.queues).length>0},e.prototype._promiseTry=function(t){try{return this.Promise.resolve(t())}catch(n){return this.Promise.reject(n)}},TM=e,TM}var AM,I9;function b2e(){return I9||(I9=1,AM=y2e()),AM}var v2e=b2e();const aw=_a(v2e);var OS={exports:{}},j9;function x2e(){return j9||(j9=1,typeof Object.create=="function"?OS.exports=function(t,n){n&&(t.super_=n,t.prototype=Object.create(n.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:OS.exports=function(t,n){if(n){t.super_=n;var r=function(){};r.prototype=n.prototype,t.prototype=new r,t.prototype.constructor=t}}),OS.exports}var RM,P9;function w2e(){if(P9)return RM;P9=1;var e=qO().Buffer;function t(n,r){this._block=e.alloc(n),this._finalSize=r,this._blockSize=n,this._len=0}return t.prototype.update=function(n,r){typeof n=="string"&&(r=r||"utf8",n=e.from(n,r));for(var s=this._block,i=this._blockSize,a=n.length,o=this._len,l=0;l<a;){for(var c=o%i,u=Math.min(a-l,i-c),d=0;d<u;d++)s[c+d]=n[l+d];o+=u,l+=u,o%i===0&&this._update(s)}return this._len+=a,this},t.prototype.digest=function(n){var r=this._len%this._blockSize;this._block[r]=128,this._block.fill(0,r+1),r>=this._finalSize&&(this._update(this._block),this._block.fill(0));var s=this._len*8;if(s<=4294967295)this._block.writeUInt32BE(s,this._blockSize-4);else{var i=(s&4294967295)>>>0,a=(s-i)/4294967296;this._block.writeUInt32BE(a,this._blockSize-8),this._block.writeUInt32BE(i,this._blockSize-4)}this._update(this._block);var o=this._hash();return n?o.toString(n):o},t.prototype._update=function(){throw new Error("_update must be implemented by subclass")},RM=t,RM}var NM,O9;function _2e(){if(O9)return NM;O9=1;var e=x2e(),t=w2e(),n=qO().Buffer,r=[1518500249,1859775393,-1894007588,-899497514],s=new Array(80);function i(){this.init(),this._w=s,t.call(this,64,56)}e(i,t),i.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this};function a(u){return u<<1|u>>>31}function o(u){return u<<5|u>>>27}function l(u){return u<<30|u>>>2}function c(u,d,h,m){return u===0?d&h|~d&m:u===2?d&h|d&m|h&m:d^h^m}return i.prototype._update=function(u){for(var d=this._w,h=this._a|0,m=this._b|0,y=this._c|0,b=this._d|0,v=this._e|0,x=0;x<16;++x)d[x]=u.readInt32BE(x*4);for(;x<80;++x)d[x]=a(d[x-3]^d[x-8]^d[x-14]^d[x-16]);for(var w=0;w<80;++w){var S=~~(w/20),C=o(h)+c(S,m,y,b)+v+d[w]+r[S]|0;v=b,b=y,y=l(m),m=h,h=C}this._a=h+this._a|0,this._b=m+this._b|0,this._c=y+this._c|0,this._d=b+this._d|0,this._e=v+this._e|0},i.prototype._hash=function(){var u=n.allocUnsafe(20);return u.writeInt32BE(this._a|0,0),u.writeInt32BE(this._b|0,4),u.writeInt32BE(this._c|0,8),u.writeInt32BE(this._d|0,12),u.writeInt32BE(this._e|0,16),u},NM=i,NM}var S2e=_2e();const wY=_a(S2e);var MM,D9;function C2e(){if(D9)return MM;D9=1;function e(s){if(typeof s!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(s))}function t(s,i){for(var a="",o=0,l=-1,c=0,u,d=0;d<=s.length;++d){if(d<s.length)u=s.charCodeAt(d);else{if(u===47)break;u=47}if(u===47){if(!(l===d-1||c===1))if(l!==d-1&&c===2){if(a.length<2||o!==2||a.charCodeAt(a.length-1)!==46||a.charCodeAt(a.length-2)!==46){if(a.length>2){var h=a.lastIndexOf("/");if(h!==a.length-1){h===-1?(a="",o=0):(a=a.slice(0,h),o=a.length-1-a.lastIndexOf("/")),l=d,c=0;continue}}else if(a.length===2||a.length===1){a="",o=0,l=d,c=0;continue}}i&&(a.length>0?a+="/..":a="..",o=2)}else a.length>0?a+="/"+s.slice(l+1,d):a=s.slice(l+1,d),o=d-l-1;l=d,c=0}else u===46&&c!==-1?++c:c=-1}return a}function n(s,i){var a=i.dir||i.root,o=i.base||(i.name||"")+(i.ext||"");return a?a===i.root?a+o:a+s+o:o}var r={resolve:function(){for(var i="",a=!1,o,l=arguments.length-1;l>=-1&&!a;l--){var c;l>=0?c=arguments[l]:(o===void 0&&(o=Ai.cwd()),c=o),e(c),c.length!==0&&(i=c+"/"+i,a=c.charCodeAt(0)===47)}return i=t(i,!a),a?i.length>0?"/"+i:"/":i.length>0?i:"."},normalize:function(i){if(e(i),i.length===0)return".";var a=i.charCodeAt(0)===47,o=i.charCodeAt(i.length-1)===47;return i=t(i,!a),i.length===0&&!a&&(i="."),i.length>0&&o&&(i+="/"),a?"/"+i:i},isAbsolute:function(i){return e(i),i.length>0&&i.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var i,a=0;a<arguments.length;++a){var o=arguments[a];e(o),o.length>0&&(i===void 0?i=o:i+="/"+o)}return i===void 0?".":r.normalize(i)},relative:function(i,a){if(e(i),e(a),i===a||(i=r.resolve(i),a=r.resolve(a),i===a))return"";for(var o=1;o<i.length&&i.charCodeAt(o)===47;++o);for(var l=i.length,c=l-o,u=1;u<a.length&&a.charCodeAt(u)===47;++u);for(var d=a.length,h=d-u,m=c<h?c:h,y=-1,b=0;b<=m;++b){if(b===m){if(h>m){if(a.charCodeAt(u+b)===47)return a.slice(u+b+1);if(b===0)return a.slice(u+b)}else c>m&&(i.charCodeAt(o+b)===47?y=b:b===0&&(y=0));break}var v=i.charCodeAt(o+b),x=a.charCodeAt(u+b);if(v!==x)break;v===47&&(y=b)}var w="";for(b=o+y+1;b<=l;++b)(b===l||i.charCodeAt(b)===47)&&(w.length===0?w+="..":w+="/..");return w.length>0?w+a.slice(u+y):(u+=y,a.charCodeAt(u)===47&&++u,a.slice(u))},_makeLong:function(i){return i},dirname:function(i){if(e(i),i.length===0)return".";for(var a=i.charCodeAt(0),o=a===47,l=-1,c=!0,u=i.length-1;u>=1;--u)if(a=i.charCodeAt(u),a===47){if(!c){l=u;break}}else c=!1;return l===-1?o?"/":".":o&&l===1?"//":i.slice(0,l)},basename:function(i,a){if(a!==void 0&&typeof a!="string")throw new TypeError('"ext" argument must be a string');e(i);var o=0,l=-1,c=!0,u;if(a!==void 0&&a.length>0&&a.length<=i.length){if(a.length===i.length&&a===i)return"";var d=a.length-1,h=-1;for(u=i.length-1;u>=0;--u){var m=i.charCodeAt(u);if(m===47){if(!c){o=u+1;break}}else h===-1&&(c=!1,h=u+1),d>=0&&(m===a.charCodeAt(d)?--d===-1&&(l=u):(d=-1,l=h))}return o===l?l=h:l===-1&&(l=i.length),i.slice(o,l)}else{for(u=i.length-1;u>=0;--u)if(i.charCodeAt(u)===47){if(!c){o=u+1;break}}else l===-1&&(c=!1,l=u+1);return l===-1?"":i.slice(o,l)}},extname:function(i){e(i);for(var a=-1,o=0,l=-1,c=!0,u=0,d=i.length-1;d>=0;--d){var h=i.charCodeAt(d);if(h===47){if(!c){o=d+1;break}continue}l===-1&&(c=!1,l=d+1),h===46?a===-1?a=d:u!==1&&(u=1):a!==-1&&(u=-1)}return a===-1||l===-1||u===0||u===1&&a===l-1&&a===o+1?"":i.slice(a,l)},format:function(i){if(i===null||typeof i!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof i);return n("/",i)},parse:function(i){e(i);var a={root:"",dir:"",base:"",ext:"",name:""};if(i.length===0)return a;var o=i.charCodeAt(0),l=o===47,c;l?(a.root="/",c=1):c=0;for(var u=-1,d=0,h=-1,m=!0,y=i.length-1,b=0;y>=c;--y){if(o=i.charCodeAt(y),o===47){if(!m){d=y+1;break}continue}h===-1&&(m=!1,h=y+1),o===46?u===-1?u=y:b!==1&&(b=1):u!==-1&&(b=-1)}return u===-1||h===-1||b===0||b===1&&u===h-1&&u===d+1?h!==-1&&(d===0&&l?a.base=a.name=i.slice(1,h):a.base=a.name=i.slice(d,h)):(d===0&&l?(a.name=i.slice(1,u),a.base=i.slice(1,h)):(a.name=i.slice(d,u),a.base=i.slice(d,h)),a.ext=i.slice(u,h)),d>0?a.dir=i.slice(0,d-1):l&&(a.dir="/"),a},sep:"/",delimiter:":",win32:null,posix:null};return r.posix=r,MM=r,MM}var $t=C2e(),IM={};/*! crc32.js (C) 2014-present SheetJS -- http://sheetjs.com */var F9;function k2e(){return F9||(F9=1,function(e){(function(t){t(typeof DO_NOT_EXPORT_CRC>"u"?e:{})})(function(t){t.version="1.2.2";function n(){for(var N=0,I=new Array(256),P=0;P!=256;++P)N=P,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,I[P]=N;return typeof Int32Array<"u"?new Int32Array(I):I}var r=n();function s(N){var I=0,P=0,L=0,O=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(L=0;L!=256;++L)O[L]=N[L];for(L=0;L!=256;++L)for(P=N[L],I=256+L;I<4096;I+=256)P=O[I]=P>>>8^N[P&255];var V=[];for(L=1;L!=16;++L)V[L-1]=typeof Int32Array<"u"?O.subarray(L*256,L*256+256):O.slice(L*256,L*256+256);return V}var i=s(r),a=i[0],o=i[1],l=i[2],c=i[3],u=i[4],d=i[5],h=i[6],m=i[7],y=i[8],b=i[9],v=i[10],x=i[11],w=i[12],S=i[13],C=i[14];function k(N,I){for(var P=I^-1,L=0,O=N.length;L<O;)P=P>>>8^r[(P^N.charCodeAt(L++))&255];return~P}function A(N,I){for(var P=I^-1,L=N.length-15,O=0;O<L;)P=C[N[O++]^P&255]^S[N[O++]^P>>8&255]^w[N[O++]^P>>16&255]^x[N[O++]^P>>>24]^v[N[O++]]^b[N[O++]]^y[N[O++]]^m[N[O++]]^h[N[O++]]^d[N[O++]]^u[N[O++]]^c[N[O++]]^l[N[O++]]^o[N[O++]]^a[N[O++]]^r[N[O++]];for(L+=15;O<L;)P=P>>>8^r[(P^N[O++])&255];return~P}function R(N,I){for(var P=I^-1,L=0,O=N.length,V=0,D=0;L<O;)V=N.charCodeAt(L++),V<128?P=P>>>8^r[(P^V)&255]:V<2048?(P=P>>>8^r[(P^(192|V>>6&31))&255],P=P>>>8^r[(P^(128|V&63))&255]):V>=55296&&V<57344?(V=(V&1023)+64,D=N.charCodeAt(L++)&1023,P=P>>>8^r[(P^(240|V>>8&7))&255],P=P>>>8^r[(P^(128|V>>2&63))&255],P=P>>>8^r[(P^(128|D>>6&15|(V&3)<<4))&255],P=P>>>8^r[(P^(128|D&63))&255]):(P=P>>>8^r[(P^(224|V>>12&15))&255],P=P>>>8^r[(P^(128|V>>6&63))&255],P=P>>>8^r[(P^(128|V&63))&255]);return~P}t.table=r,t.bstr=k,t.buf=A,t.str=R})}(IM)),IM}var E2e=k2e();const T2e=_a(E2e);var jM={},L9;function Gh(){return L9||(L9=1,function(e){var t=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";function n(i,a){return Object.prototype.hasOwnProperty.call(i,a)}e.assign=function(i){for(var a=Array.prototype.slice.call(arguments,1);a.length;){var o=a.shift();if(o){if(typeof o!="object")throw new TypeError(o+"must be non-object");for(var l in o)n(o,l)&&(i[l]=o[l])}}return i},e.shrinkBuf=function(i,a){return i.length===a?i:i.subarray?i.subarray(0,a):(i.length=a,i)};var r={arraySet:function(i,a,o,l,c){if(a.subarray&&i.subarray){i.set(a.subarray(o,o+l),c);return}for(var u=0;u<l;u++)i[c+u]=a[o+u]},flattenChunks:function(i){var a,o,l,c,u,d;for(l=0,a=0,o=i.length;a<o;a++)l+=i[a].length;for(d=new Uint8Array(l),c=0,a=0,o=i.length;a<o;a++)u=i[a],d.set(u,c),c+=u.length;return d}},s={arraySet:function(i,a,o,l,c){for(var u=0;u<l;u++)i[c+u]=a[o+u]},flattenChunks:function(i){return[].concat.apply([],i)}};e.setTyped=function(i){i?(e.Buf8=Uint8Array,e.Buf16=Uint16Array,e.Buf32=Int32Array,e.assign(e,r)):(e.Buf8=Array,e.Buf16=Array,e.Buf32=Array,e.assign(e,s))},e.setTyped(t)}(jM)),jM}var Zg={},uc={},Lp={},B9;function A2e(){if(B9)return Lp;B9=1;var e=Gh(),t=4,n=0,r=1,s=2;function i(F){for(var X=F.length;--X>=0;)F[X]=0}var a=0,o=1,l=2,c=3,u=258,d=29,h=256,m=h+1+d,y=30,b=19,v=2*m+1,x=15,w=16,S=7,C=256,k=16,A=17,R=18,N=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],I=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],P=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],L=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],O=512,V=new Array((m+2)*2);i(V);var D=new Array(y*2);i(D);var Z=new Array(O);i(Z);var U=new Array(u-c+1);i(U);var H=new Array(d);i(H);var $=new Array(y);i($);function ne(F,X,ye,Fe,we){this.static_tree=F,this.extra_bits=X,this.extra_base=ye,this.elems=Fe,this.max_length=we,this.has_stree=F&&F.length}var W,Q,ee;function se(F,X){this.dyn_tree=F,this.max_code=0,this.stat_desc=X}function pe(F){return F<256?Z[F]:Z[256+(F>>>7)]}function ce(F,X){F.pending_buf[F.pending++]=X&255,F.pending_buf[F.pending++]=X>>>8&255}function Ie(F,X,ye){F.bi_valid>w-ye?(F.bi_buf|=X<<F.bi_valid&65535,ce(F,F.bi_buf),F.bi_buf=X>>w-F.bi_valid,F.bi_valid+=ye-w):(F.bi_buf|=X<<F.bi_valid&65535,F.bi_valid+=ye)}function De(F,X,ye){Ie(F,ye[X*2],ye[X*2+1])}function Se(F,X){var ye=0;do ye|=F&1,F>>>=1,ye<<=1;while(--X>0);return ye>>>1}function Ce(F){F.bi_valid===16?(ce(F,F.bi_buf),F.bi_buf=0,F.bi_valid=0):F.bi_valid>=8&&(F.pending_buf[F.pending++]=F.bi_buf&255,F.bi_buf>>=8,F.bi_valid-=8)}function qe(F,X){var ye=X.dyn_tree,Fe=X.max_code,we=X.stat_desc.static_tree,Me=X.stat_desc.has_stree,de=X.stat_desc.extra_bits,vt=X.stat_desc.extra_base,ot=X.stat_desc.max_length,B,ze,st,be,_e,Ue,kt=0;for(be=0;be<=x;be++)F.bl_count[be]=0;for(ye[F.heap[F.heap_max]*2+1]=0,B=F.heap_max+1;B<v;B++)ze=F.heap[B],be=ye[ye[ze*2+1]*2+1]+1,be>ot&&(be=ot,kt++),ye[ze*2+1]=be,!(ze>Fe)&&(F.bl_count[be]++,_e=0,ze>=vt&&(_e=de[ze-vt]),Ue=ye[ze*2],F.opt_len+=Ue*(be+_e),Me&&(F.static_len+=Ue*(we[ze*2+1]+_e)));if(kt!==0){do{for(be=ot-1;F.bl_count[be]===0;)be--;F.bl_count[be]--,F.bl_count[be+1]+=2,F.bl_count[ot]--,kt-=2}while(kt>0);for(be=ot;be!==0;be--)for(ze=F.bl_count[be];ze!==0;)st=F.heap[--B],!(st>Fe)&&(ye[st*2+1]!==be&&(F.opt_len+=(be-ye[st*2+1])*ye[st*2],ye[st*2+1]=be),ze--)}}function Qe(F,X,ye){var Fe=new Array(x+1),we=0,Me,de;for(Me=1;Me<=x;Me++)Fe[Me]=we=we+ye[Me-1]<<1;for(de=0;de<=X;de++){var vt=F[de*2+1];vt!==0&&(F[de*2]=Se(Fe[vt]++,vt))}}function Ve(){var F,X,ye,Fe,we,Me=new Array(x+1);for(ye=0,Fe=0;Fe<d-1;Fe++)for(H[Fe]=ye,F=0;F<1<<N[Fe];F++)U[ye++]=Fe;for(U[ye-1]=Fe,we=0,Fe=0;Fe<16;Fe++)for($[Fe]=we,F=0;F<1<<I[Fe];F++)Z[we++]=Fe;for(we>>=7;Fe<y;Fe++)for($[Fe]=we<<7,F=0;F<1<<I[Fe]-7;F++)Z[256+we++]=Fe;for(X=0;X<=x;X++)Me[X]=0;for(F=0;F<=143;)V[F*2+1]=8,F++,Me[8]++;for(;F<=255;)V[F*2+1]=9,F++,Me[9]++;for(;F<=279;)V[F*2+1]=7,F++,Me[7]++;for(;F<=287;)V[F*2+1]=8,F++,Me[8]++;for(Qe(V,m+1,Me),F=0;F<y;F++)D[F*2+1]=5,D[F*2]=Se(F,5);W=new ne(V,N,h+1,m,x),Q=new ne(D,I,0,y,x),ee=new ne(new Array(0),P,0,b,S)}function Ne(F){var X;for(X=0;X<m;X++)F.dyn_ltree[X*2]=0;for(X=0;X<y;X++)F.dyn_dtree[X*2]=0;for(X=0;X<b;X++)F.bl_tree[X*2]=0;F.dyn_ltree[C*2]=1,F.opt_len=F.static_len=0,F.last_lit=F.matches=0}function K(F){F.bi_valid>8?ce(F,F.bi_buf):F.bi_valid>0&&(F.pending_buf[F.pending++]=F.bi_buf),F.bi_buf=0,F.bi_valid=0}function ge(F,X,ye,Fe){K(F),ce(F,ye),ce(F,~ye),e.arraySet(F.pending_buf,F.window,X,ye,F.pending),F.pending+=ye}function Ae(F,X,ye,Fe){var we=X*2,Me=ye*2;return F[we]<F[Me]||F[we]===F[Me]&&Fe[X]<=Fe[ye]}function le(F,X,ye){for(var Fe=F.heap[ye],we=ye<<1;we<=F.heap_len&&(we<F.heap_len&&Ae(X,F.heap[we+1],F.heap[we],F.depth)&&we++,!Ae(X,Fe,F.heap[we],F.depth));)F.heap[ye]=F.heap[we],ye=we,we<<=1;F.heap[ye]=Fe}function oe(F,X,ye){var Fe,we,Me=0,de,vt;if(F.last_lit!==0)do Fe=F.pending_buf[F.d_buf+Me*2]<<8|F.pending_buf[F.d_buf+Me*2+1],we=F.pending_buf[F.l_buf+Me],Me++,Fe===0?De(F,we,X):(de=U[we],De(F,de+h+1,X),vt=N[de],vt!==0&&(we-=H[de],Ie(F,we,vt)),Fe--,de=pe(Fe),De(F,de,ye),vt=I[de],vt!==0&&(Fe-=$[de],Ie(F,Fe,vt)));while(Me<F.last_lit);De(F,C,X)}function re(F,X){var ye=X.dyn_tree,Fe=X.stat_desc.static_tree,we=X.stat_desc.has_stree,Me=X.stat_desc.elems,de,vt,ot=-1,B;for(F.heap_len=0,F.heap_max=v,de=0;de<Me;de++)ye[de*2]!==0?(F.heap[++F.heap_len]=ot=de,F.depth[de]=0):ye[de*2+1]=0;for(;F.heap_len<2;)B=F.heap[++F.heap_len]=ot<2?++ot:0,ye[B*2]=1,F.depth[B]=0,F.opt_len--,we&&(F.static_len-=Fe[B*2+1]);for(X.max_code=ot,de=F.heap_len>>1;de>=1;de--)le(F,ye,de);B=Me;do de=F.heap[1],F.heap[1]=F.heap[F.heap_len--],le(F,ye,1),vt=F.heap[1],F.heap[--F.heap_max]=de,F.heap[--F.heap_max]=vt,ye[B*2]=ye[de*2]+ye[vt*2],F.depth[B]=(F.depth[de]>=F.depth[vt]?F.depth[de]:F.depth[vt])+1,ye[de*2+1]=ye[vt*2+1]=B,F.heap[1]=B++,le(F,ye,1);while(F.heap_len>=2);F.heap[--F.heap_max]=F.heap[1],qe(F,X),Qe(ye,ot,F.bl_count)}function Te(F,X,ye){var Fe,we=-1,Me,de=X[0*2+1],vt=0,ot=7,B=4;for(de===0&&(ot=138,B=3),X[(ye+1)*2+1]=65535,Fe=0;Fe<=ye;Fe++)Me=de,de=X[(Fe+1)*2+1],!(++vt<ot&&Me===de)&&(vt<B?F.bl_tree[Me*2]+=vt:Me!==0?(Me!==we&&F.bl_tree[Me*2]++,F.bl_tree[k*2]++):vt<=10?F.bl_tree[A*2]++:F.bl_tree[R*2]++,vt=0,we=Me,de===0?(ot=138,B=3):Me===de?(ot=6,B=3):(ot=7,B=4))}function Be(F,X,ye){var Fe,we=-1,Me,de=X[0*2+1],vt=0,ot=7,B=4;for(de===0&&(ot=138,B=3),Fe=0;Fe<=ye;Fe++)if(Me=de,de=X[(Fe+1)*2+1],!(++vt<ot&&Me===de)){if(vt<B)do De(F,Me,F.bl_tree);while(--vt!==0);else Me!==0?(Me!==we&&(De(F,Me,F.bl_tree),vt--),De(F,k,F.bl_tree),Ie(F,vt-3,2)):vt<=10?(De(F,A,F.bl_tree),Ie(F,vt-3,3)):(De(F,R,F.bl_tree),Ie(F,vt-11,7));vt=0,we=Me,de===0?(ot=138,B=3):Me===de?(ot=6,B=3):(ot=7,B=4)}}function ke(F){var X;for(Te(F,F.dyn_ltree,F.l_desc.max_code),Te(F,F.dyn_dtree,F.d_desc.max_code),re(F,F.bl_desc),X=b-1;X>=3&&F.bl_tree[L[X]*2+1]===0;X--);return F.opt_len+=3*(X+1)+5+5+4,X}function lt(F,X,ye,Fe){var we;for(Ie(F,X-257,5),Ie(F,ye-1,5),Ie(F,Fe-4,4),we=0;we<Fe;we++)Ie(F,F.bl_tree[L[we]*2+1],3);Be(F,F.dyn_ltree,X-1),Be(F,F.dyn_dtree,ye-1)}function Rt(F){var X=4093624447,ye;for(ye=0;ye<=31;ye++,X>>>=1)if(X&1&&F.dyn_ltree[ye*2]!==0)return n;if(F.dyn_ltree[9*2]!==0||F.dyn_ltree[10*2]!==0||F.dyn_ltree[13*2]!==0)return r;for(ye=32;ye<h;ye++)if(F.dyn_ltree[ye*2]!==0)return r;return n}var ht=!1;function Pt(F){ht||(Ve(),ht=!0),F.l_desc=new se(F.dyn_ltree,W),F.d_desc=new se(F.dyn_dtree,Q),F.bl_desc=new se(F.bl_tree,ee),F.bi_buf=0,F.bi_valid=0,Ne(F)}function qt(F,X,ye,Fe){Ie(F,(a<<1)+(Fe?1:0),3),ge(F,X,ye)}function Lt(F){Ie(F,o<<1,3),De(F,C,V),Ce(F)}function en(F,X,ye,Fe){var we,Me,de=0;F.level>0?(F.strm.data_type===s&&(F.strm.data_type=Rt(F)),re(F,F.l_desc),re(F,F.d_desc),de=ke(F),we=F.opt_len+3+7>>>3,Me=F.static_len+3+7>>>3,Me<=we&&(we=Me)):we=Me=ye+5,ye+4<=we&&X!==-1?qt(F,X,ye,Fe):F.strategy===t||Me===we?(Ie(F,(o<<1)+(Fe?1:0),3),oe(F,V,D)):(Ie(F,(l<<1)+(Fe?1:0),3),lt(F,F.l_desc.max_code+1,F.d_desc.max_code+1,de+1),oe(F,F.dyn_ltree,F.dyn_dtree)),Ne(F),Fe&&K(F)}function xe(F,X,ye){return F.pending_buf[F.d_buf+F.last_lit*2]=X>>>8&255,F.pending_buf[F.d_buf+F.last_lit*2+1]=X&255,F.pending_buf[F.l_buf+F.last_lit]=ye&255,F.last_lit++,X===0?F.dyn_ltree[ye*2]++:(F.matches++,X--,F.dyn_ltree[(U[ye]+h+1)*2]++,F.dyn_dtree[pe(X)*2]++),F.last_lit===F.lit_bufsize-1}return Lp._tr_init=Pt,Lp._tr_stored_block=qt,Lp._tr_flush_block=en,Lp._tr_tally=xe,Lp._tr_align=Lt,Lp}var PM,$9;function _Y(){if($9)return PM;$9=1;function e(t,n,r,s){for(var i=t&65535|0,a=t>>>16&65535|0,o=0;r!==0;){o=r>2e3?2e3:r,r-=o;do i=i+n[s++]|0,a=a+i|0;while(--o);i%=65521,a%=65521}return i|a<<16|0}return PM=e,PM}var OM,z9;function SY(){if(z9)return OM;z9=1;function e(){for(var r,s=[],i=0;i<256;i++){r=i;for(var a=0;a<8;a++)r=r&1?3988292384^r>>>1:r>>>1;s[i]=r}return s}var t=e();function n(r,s,i,a){var o=t,l=a+i;r^=-1;for(var c=a;c<l;c++)r=r>>>8^o[(r^s[c])&255];return r^-1}return OM=n,OM}var DM,U9;function tD(){return U9||(U9=1,DM={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}),DM}var q9;function R2e(){if(q9)return uc;q9=1;var e=Gh(),t=A2e(),n=_Y(),r=SY(),s=tD(),i=0,a=1,o=3,l=4,c=5,u=0,d=1,h=-2,m=-3,y=-5,b=-1,v=1,x=2,w=3,S=4,C=0,k=2,A=8,R=9,N=15,I=8,P=29,L=256,O=L+1+P,V=30,D=19,Z=2*O+1,U=15,H=3,$=258,ne=$+H+1,W=32,Q=42,ee=69,se=73,pe=91,ce=103,Ie=113,De=666,Se=1,Ce=2,qe=3,Qe=4,Ve=3;function Ne(B,ze){return B.msg=s[ze],ze}function K(B){return(B<<1)-(B>4?9:0)}function ge(B){for(var ze=B.length;--ze>=0;)B[ze]=0}function Ae(B){var ze=B.state,st=ze.pending;st>B.avail_out&&(st=B.avail_out),st!==0&&(e.arraySet(B.output,ze.pending_buf,ze.pending_out,st,B.next_out),B.next_out+=st,ze.pending_out+=st,B.total_out+=st,B.avail_out-=st,ze.pending-=st,ze.pending===0&&(ze.pending_out=0))}function le(B,ze){t._tr_flush_block(B,B.block_start>=0?B.block_start:-1,B.strstart-B.block_start,ze),B.block_start=B.strstart,Ae(B.strm)}function oe(B,ze){B.pending_buf[B.pending++]=ze}function re(B,ze){B.pending_buf[B.pending++]=ze>>>8&255,B.pending_buf[B.pending++]=ze&255}function Te(B,ze,st,be){var _e=B.avail_in;return _e>be&&(_e=be),_e===0?0:(B.avail_in-=_e,e.arraySet(ze,B.input,B.next_in,_e,st),B.state.wrap===1?B.adler=n(B.adler,ze,_e,st):B.state.wrap===2&&(B.adler=r(B.adler,ze,_e,st)),B.next_in+=_e,B.total_in+=_e,_e)}function Be(B,ze){var st=B.max_chain_length,be=B.strstart,_e,Ue,kt=B.prev_length,fe=B.nice_match,Y=B.strstart>B.w_size-ne?B.strstart-(B.w_size-ne):0,G=B.window,J=B.w_mask,ve=B.prev,Oe=B.strstart+$,Ge=G[be+kt-1],_t=G[be+kt];B.prev_length>=B.good_match&&(st>>=2),fe>B.lookahead&&(fe=B.lookahead);do if(_e=ze,!(G[_e+kt]!==_t||G[_e+kt-1]!==Ge||G[_e]!==G[be]||G[++_e]!==G[be+1])){be+=2,_e++;do;while(G[++be]===G[++_e]&&G[++be]===G[++_e]&&G[++be]===G[++_e]&&G[++be]===G[++_e]&&G[++be]===G[++_e]&&G[++be]===G[++_e]&&G[++be]===G[++_e]&&G[++be]===G[++_e]&&be<Oe);if(Ue=$-(Oe-be),be=Oe-$,Ue>kt){if(B.match_start=ze,kt=Ue,Ue>=fe)break;Ge=G[be+kt-1],_t=G[be+kt]}}while((ze=ve[ze&J])>Y&&--st!==0);return kt<=B.lookahead?kt:B.lookahead}function ke(B){var ze=B.w_size,st,be,_e,Ue,kt;do{if(Ue=B.window_size-B.lookahead-B.strstart,B.strstart>=ze+(ze-ne)){e.arraySet(B.window,B.window,ze,ze,0),B.match_start-=ze,B.strstart-=ze,B.block_start-=ze,be=B.hash_size,st=be;do _e=B.head[--st],B.head[st]=_e>=ze?_e-ze:0;while(--be);be=ze,st=be;do _e=B.prev[--st],B.prev[st]=_e>=ze?_e-ze:0;while(--be);Ue+=ze}if(B.strm.avail_in===0)break;if(be=Te(B.strm,B.window,B.strstart+B.lookahead,Ue),B.lookahead+=be,B.lookahead+B.insert>=H)for(kt=B.strstart-B.insert,B.ins_h=B.window[kt],B.ins_h=(B.ins_h<<B.hash_shift^B.window[kt+1])&B.hash_mask;B.insert&&(B.ins_h=(B.ins_h<<B.hash_shift^B.window[kt+H-1])&B.hash_mask,B.prev[kt&B.w_mask]=B.head[B.ins_h],B.head[B.ins_h]=kt,kt++,B.insert--,!(B.lookahead+B.insert<H)););}while(B.lookahead<ne&&B.strm.avail_in!==0)}function lt(B,ze){var st=65535;for(st>B.pending_buf_size-5&&(st=B.pending_buf_size-5);;){if(B.lookahead<=1){if(ke(B),B.lookahead===0&&ze===i)return Se;if(B.lookahead===0)break}B.strstart+=B.lookahead,B.lookahead=0;var be=B.block_start+st;if((B.strstart===0||B.strstart>=be)&&(B.lookahead=B.strstart-be,B.strstart=be,le(B,!1),B.strm.avail_out===0)||B.strstart-B.block_start>=B.w_size-ne&&(le(B,!1),B.strm.avail_out===0))return Se}return B.insert=0,ze===l?(le(B,!0),B.strm.avail_out===0?qe:Qe):(B.strstart>B.block_start&&(le(B,!1),B.strm.avail_out===0),Se)}function Rt(B,ze){for(var st,be;;){if(B.lookahead<ne){if(ke(B),B.lookahead<ne&&ze===i)return Se;if(B.lookahead===0)break}if(st=0,B.lookahead>=H&&(B.ins_h=(B.ins_h<<B.hash_shift^B.window[B.strstart+H-1])&B.hash_mask,st=B.prev[B.strstart&B.w_mask]=B.head[B.ins_h],B.head[B.ins_h]=B.strstart),st!==0&&B.strstart-st<=B.w_size-ne&&(B.match_length=Be(B,st)),B.match_length>=H)if(be=t._tr_tally(B,B.strstart-B.match_start,B.match_length-H),B.lookahead-=B.match_length,B.match_length<=B.max_lazy_match&&B.lookahead>=H){B.match_length--;do B.strstart++,B.ins_h=(B.ins_h<<B.hash_shift^B.window[B.strstart+H-1])&B.hash_mask,st=B.prev[B.strstart&B.w_mask]=B.head[B.ins_h],B.head[B.ins_h]=B.strstart;while(--B.match_length!==0);B.strstart++}else B.strstart+=B.match_length,B.match_length=0,B.ins_h=B.window[B.strstart],B.ins_h=(B.ins_h<<B.hash_shift^B.window[B.strstart+1])&B.hash_mask;else be=t._tr_tally(B,0,B.window[B.strstart]),B.lookahead--,B.strstart++;if(be&&(le(B,!1),B.strm.avail_out===0))return Se}return B.insert=B.strstart<H-1?B.strstart:H-1,ze===l?(le(B,!0),B.strm.avail_out===0?qe:Qe):B.last_lit&&(le(B,!1),B.strm.avail_out===0)?Se:Ce}function ht(B,ze){for(var st,be,_e;;){if(B.lookahead<ne){if(ke(B),B.lookahead<ne&&ze===i)return Se;if(B.lookahead===0)break}if(st=0,B.lookahead>=H&&(B.ins_h=(B.ins_h<<B.hash_shift^B.window[B.strstart+H-1])&B.hash_mask,st=B.prev[B.strstart&B.w_mask]=B.head[B.ins_h],B.head[B.ins_h]=B.strstart),B.prev_length=B.match_length,B.prev_match=B.match_start,B.match_length=H-1,st!==0&&B.prev_length<B.max_lazy_match&&B.strstart-st<=B.w_size-ne&&(B.match_length=Be(B,st),B.match_length<=5&&(B.strategy===v||B.match_length===H&&B.strstart-B.match_start>4096)&&(B.match_length=H-1)),B.prev_length>=H&&B.match_length<=B.prev_length){_e=B.strstart+B.lookahead-H,be=t._tr_tally(B,B.strstart-1-B.prev_match,B.prev_length-H),B.lookahead-=B.prev_length-1,B.prev_length-=2;do++B.strstart<=_e&&(B.ins_h=(B.ins_h<<B.hash_shift^B.window[B.strstart+H-1])&B.hash_mask,st=B.prev[B.strstart&B.w_mask]=B.head[B.ins_h],B.head[B.ins_h]=B.strstart);while(--B.prev_length!==0);if(B.match_available=0,B.match_length=H-1,B.strstart++,be&&(le(B,!1),B.strm.avail_out===0))return Se}else if(B.match_available){if(be=t._tr_tally(B,0,B.window[B.strstart-1]),be&&le(B,!1),B.strstart++,B.lookahead--,B.strm.avail_out===0)return Se}else B.match_available=1,B.strstart++,B.lookahead--}return B.match_available&&(be=t._tr_tally(B,0,B.window[B.strstart-1]),B.match_available=0),B.insert=B.strstart<H-1?B.strstart:H-1,ze===l?(le(B,!0),B.strm.avail_out===0?qe:Qe):B.last_lit&&(le(B,!1),B.strm.avail_out===0)?Se:Ce}function Pt(B,ze){for(var st,be,_e,Ue,kt=B.window;;){if(B.lookahead<=$){if(ke(B),B.lookahead<=$&&ze===i)return Se;if(B.lookahead===0)break}if(B.match_length=0,B.lookahead>=H&&B.strstart>0&&(_e=B.strstart-1,be=kt[_e],be===kt[++_e]&&be===kt[++_e]&&be===kt[++_e])){Ue=B.strstart+$;do;while(be===kt[++_e]&&be===kt[++_e]&&be===kt[++_e]&&be===kt[++_e]&&be===kt[++_e]&&be===kt[++_e]&&be===kt[++_e]&&be===kt[++_e]&&_e<Ue);B.match_length=$-(Ue-_e),B.match_length>B.lookahead&&(B.match_length=B.lookahead)}if(B.match_length>=H?(st=t._tr_tally(B,1,B.match_length-H),B.lookahead-=B.match_length,B.strstart+=B.match_length,B.match_length=0):(st=t._tr_tally(B,0,B.window[B.strstart]),B.lookahead--,B.strstart++),st&&(le(B,!1),B.strm.avail_out===0))return Se}return B.insert=0,ze===l?(le(B,!0),B.strm.avail_out===0?qe:Qe):B.last_lit&&(le(B,!1),B.strm.avail_out===0)?Se:Ce}function qt(B,ze){for(var st;;){if(B.lookahead===0&&(ke(B),B.lookahead===0)){if(ze===i)return Se;break}if(B.match_length=0,st=t._tr_tally(B,0,B.window[B.strstart]),B.lookahead--,B.strstart++,st&&(le(B,!1),B.strm.avail_out===0))return Se}return B.insert=0,ze===l?(le(B,!0),B.strm.avail_out===0?qe:Qe):B.last_lit&&(le(B,!1),B.strm.avail_out===0)?Se:Ce}function Lt(B,ze,st,be,_e){this.good_length=B,this.max_lazy=ze,this.nice_length=st,this.max_chain=be,this.func=_e}var en;en=[new Lt(0,0,0,0,lt),new Lt(4,4,8,4,Rt),new Lt(4,5,16,8,Rt),new Lt(4,6,32,32,Rt),new Lt(4,4,16,16,ht),new Lt(8,16,32,32,ht),new Lt(8,16,128,128,ht),new Lt(8,32,128,256,ht),new Lt(32,128,258,1024,ht),new Lt(32,258,258,4096,ht)];function xe(B){B.window_size=2*B.w_size,ge(B.head),B.max_lazy_match=en[B.level].max_lazy,B.good_match=en[B.level].good_length,B.nice_match=en[B.level].nice_length,B.max_chain_length=en[B.level].max_chain,B.strstart=0,B.block_start=0,B.lookahead=0,B.insert=0,B.match_length=B.prev_length=H-1,B.match_available=0,B.ins_h=0}function F(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=A,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new e.Buf16(Z*2),this.dyn_dtree=new e.Buf16((2*V+1)*2),this.bl_tree=new e.Buf16((2*D+1)*2),ge(this.dyn_ltree),ge(this.dyn_dtree),ge(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new e.Buf16(U+1),this.heap=new e.Buf16(2*O+1),ge(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new e.Buf16(2*O+1),ge(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function X(B){var ze;return!B||!B.state?Ne(B,h):(B.total_in=B.total_out=0,B.data_type=k,ze=B.state,ze.pending=0,ze.pending_out=0,ze.wrap<0&&(ze.wrap=-ze.wrap),ze.status=ze.wrap?Q:Ie,B.adler=ze.wrap===2?0:1,ze.last_flush=i,t._tr_init(ze),u)}function ye(B){var ze=X(B);return ze===u&&xe(B.state),ze}function Fe(B,ze){return!B||!B.state||B.state.wrap!==2?h:(B.state.gzhead=ze,u)}function we(B,ze,st,be,_e,Ue){if(!B)return h;var kt=1;if(ze===b&&(ze=6),be<0?(kt=0,be=-be):be>15&&(kt=2,be-=16),_e<1||_e>R||st!==A||be<8||be>15||ze<0||ze>9||Ue<0||Ue>S)return Ne(B,h);be===8&&(be=9);var fe=new F;return B.state=fe,fe.strm=B,fe.wrap=kt,fe.gzhead=null,fe.w_bits=be,fe.w_size=1<<fe.w_bits,fe.w_mask=fe.w_size-1,fe.hash_bits=_e+7,fe.hash_size=1<<fe.hash_bits,fe.hash_mask=fe.hash_size-1,fe.hash_shift=~~((fe.hash_bits+H-1)/H),fe.window=new e.Buf8(fe.w_size*2),fe.head=new e.Buf16(fe.hash_size),fe.prev=new e.Buf16(fe.w_size),fe.lit_bufsize=1<<_e+6,fe.pending_buf_size=fe.lit_bufsize*4,fe.pending_buf=new e.Buf8(fe.pending_buf_size),fe.d_buf=1*fe.lit_bufsize,fe.l_buf=3*fe.lit_bufsize,fe.level=ze,fe.strategy=Ue,fe.method=st,ye(B)}function Me(B,ze){return we(B,ze,A,N,I,C)}function de(B,ze){var st,be,_e,Ue;if(!B||!B.state||ze>c||ze<0)return B?Ne(B,h):h;if(be=B.state,!B.output||!B.input&&B.avail_in!==0||be.status===De&&ze!==l)return Ne(B,B.avail_out===0?y:h);if(be.strm=B,st=be.last_flush,be.last_flush=ze,be.status===Q)if(be.wrap===2)B.adler=0,oe(be,31),oe(be,139),oe(be,8),be.gzhead?(oe(be,(be.gzhead.text?1:0)+(be.gzhead.hcrc?2:0)+(be.gzhead.extra?4:0)+(be.gzhead.name?8:0)+(be.gzhead.comment?16:0)),oe(be,be.gzhead.time&255),oe(be,be.gzhead.time>>8&255),oe(be,be.gzhead.time>>16&255),oe(be,be.gzhead.time>>24&255),oe(be,be.level===9?2:be.strategy>=x||be.level<2?4:0),oe(be,be.gzhead.os&255),be.gzhead.extra&&be.gzhead.extra.length&&(oe(be,be.gzhead.extra.length&255),oe(be,be.gzhead.extra.length>>8&255)),be.gzhead.hcrc&&(B.adler=r(B.adler,be.pending_buf,be.pending,0)),be.gzindex=0,be.status=ee):(oe(be,0),oe(be,0),oe(be,0),oe(be,0),oe(be,0),oe(be,be.level===9?2:be.strategy>=x||be.level<2?4:0),oe(be,Ve),be.status=Ie);else{var kt=A+(be.w_bits-8<<4)<<8,fe=-1;be.strategy>=x||be.level<2?fe=0:be.level<6?fe=1:be.level===6?fe=2:fe=3,kt|=fe<<6,be.strstart!==0&&(kt|=W),kt+=31-kt%31,be.status=Ie,re(be,kt),be.strstart!==0&&(re(be,B.adler>>>16),re(be,B.adler&65535)),B.adler=1}if(be.status===ee)if(be.gzhead.extra){for(_e=be.pending;be.gzindex<(be.gzhead.extra.length&65535)&&!(be.pending===be.pending_buf_size&&(be.gzhead.hcrc&&be.pending>_e&&(B.adler=r(B.adler,be.pending_buf,be.pending-_e,_e)),Ae(B),_e=be.pending,be.pending===be.pending_buf_size));)oe(be,be.gzhead.extra[be.gzindex]&255),be.gzindex++;be.gzhead.hcrc&&be.pending>_e&&(B.adler=r(B.adler,be.pending_buf,be.pending-_e,_e)),be.gzindex===be.gzhead.extra.length&&(be.gzindex=0,be.status=se)}else be.status=se;if(be.status===se)if(be.gzhead.name){_e=be.pending;do{if(be.pending===be.pending_buf_size&&(be.gzhead.hcrc&&be.pending>_e&&(B.adler=r(B.adler,be.pending_buf,be.pending-_e,_e)),Ae(B),_e=be.pending,be.pending===be.pending_buf_size)){Ue=1;break}be.gzindex<be.gzhead.name.length?Ue=be.gzhead.name.charCodeAt(be.gzindex++)&255:Ue=0,oe(be,Ue)}while(Ue!==0);be.gzhead.hcrc&&be.pending>_e&&(B.adler=r(B.adler,be.pending_buf,be.pending-_e,_e)),Ue===0&&(be.gzindex=0,be.status=pe)}else be.status=pe;if(be.status===pe)if(be.gzhead.comment){_e=be.pending;do{if(be.pending===be.pending_buf_size&&(be.gzhead.hcrc&&be.pending>_e&&(B.adler=r(B.adler,be.pending_buf,be.pending-_e,_e)),Ae(B),_e=be.pending,be.pending===be.pending_buf_size)){Ue=1;break}be.gzindex<be.gzhead.comment.length?Ue=be.gzhead.comment.charCodeAt(be.gzindex++)&255:Ue=0,oe(be,Ue)}while(Ue!==0);be.gzhead.hcrc&&be.pending>_e&&(B.adler=r(B.adler,be.pending_buf,be.pending-_e,_e)),Ue===0&&(be.status=ce)}else be.status=ce;if(be.status===ce&&(be.gzhead.hcrc?(be.pending+2>be.pending_buf_size&&Ae(B),be.pending+2<=be.pending_buf_size&&(oe(be,B.adler&255),oe(be,B.adler>>8&255),B.adler=0,be.status=Ie)):be.status=Ie),be.pending!==0){if(Ae(B),B.avail_out===0)return be.last_flush=-1,u}else if(B.avail_in===0&&K(ze)<=K(st)&&ze!==l)return Ne(B,y);if(be.status===De&&B.avail_in!==0)return Ne(B,y);if(B.avail_in!==0||be.lookahead!==0||ze!==i&&be.status!==De){var Y=be.strategy===x?qt(be,ze):be.strategy===w?Pt(be,ze):en[be.level].func(be,ze);if((Y===qe||Y===Qe)&&(be.status=De),Y===Se||Y===qe)return B.avail_out===0&&(be.last_flush=-1),u;if(Y===Ce&&(ze===a?t._tr_align(be):ze!==c&&(t._tr_stored_block(be,0,0,!1),ze===o&&(ge(be.head),be.lookahead===0&&(be.strstart=0,be.block_start=0,be.insert=0))),Ae(B),B.avail_out===0))return be.last_flush=-1,u}return ze!==l?u:be.wrap<=0?d:(be.wrap===2?(oe(be,B.adler&255),oe(be,B.adler>>8&255),oe(be,B.adler>>16&255),oe(be,B.adler>>24&255),oe(be,B.total_in&255),oe(be,B.total_in>>8&255),oe(be,B.total_in>>16&255),oe(be,B.total_in>>24&255)):(re(be,B.adler>>>16),re(be,B.adler&65535)),Ae(B),be.wrap>0&&(be.wrap=-be.wrap),be.pending!==0?u:d)}function vt(B){var ze;return!B||!B.state?h:(ze=B.state.status,ze!==Q&&ze!==ee&&ze!==se&&ze!==pe&&ze!==ce&&ze!==Ie&&ze!==De?Ne(B,h):(B.state=null,ze===Ie?Ne(B,m):u))}function ot(B,ze){var st=ze.length,be,_e,Ue,kt,fe,Y,G,J;if(!B||!B.state||(be=B.state,kt=be.wrap,kt===2||kt===1&&be.status!==Q||be.lookahead))return h;for(kt===1&&(B.adler=n(B.adler,ze,st,0)),be.wrap=0,st>=be.w_size&&(kt===0&&(ge(be.head),be.strstart=0,be.block_start=0,be.insert=0),J=new e.Buf8(be.w_size),e.arraySet(J,ze,st-be.w_size,be.w_size,0),ze=J,st=be.w_size),fe=B.avail_in,Y=B.next_in,G=B.input,B.avail_in=st,B.next_in=0,B.input=ze,ke(be);be.lookahead>=H;){_e=be.strstart,Ue=be.lookahead-(H-1);do be.ins_h=(be.ins_h<<be.hash_shift^be.window[_e+H-1])&be.hash_mask,be.prev[_e&be.w_mask]=be.head[be.ins_h],be.head[be.ins_h]=_e,_e++;while(--Ue);be.strstart=_e,be.lookahead=H-1,ke(be)}return be.strstart+=be.lookahead,be.block_start=be.strstart,be.insert=be.lookahead,be.lookahead=0,be.match_length=be.prev_length=H-1,be.match_available=0,B.next_in=Y,B.input=G,B.avail_in=fe,be.wrap=kt,u}return uc.deflateInit=Me,uc.deflateInit2=we,uc.deflateReset=ye,uc.deflateResetKeep=X,uc.deflateSetHeader=Fe,uc.deflate=de,uc.deflateEnd=vt,uc.deflateSetDictionary=ot,uc.deflateInfo="pako deflate (from Nodeca project)",uc}var Bp={},V9;function CY(){if(V9)return Bp;V9=1;var e=Gh(),t=!0,n=!0;try{String.fromCharCode.apply(null,[0])}catch{t=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{n=!1}for(var r=new e.Buf8(256),s=0;s<256;s++)r[s]=s>=252?6:s>=248?5:s>=240?4:s>=224?3:s>=192?2:1;r[254]=r[254]=1,Bp.string2buf=function(a){var o,l,c,u,d,h=a.length,m=0;for(u=0;u<h;u++)l=a.charCodeAt(u),(l&64512)===55296&&u+1<h&&(c=a.charCodeAt(u+1),(c&64512)===56320&&(l=65536+(l-55296<<10)+(c-56320),u++)),m+=l<128?1:l<2048?2:l<65536?3:4;for(o=new e.Buf8(m),d=0,u=0;d<m;u++)l=a.charCodeAt(u),(l&64512)===55296&&u+1<h&&(c=a.charCodeAt(u+1),(c&64512)===56320&&(l=65536+(l-55296<<10)+(c-56320),u++)),l<128?o[d++]=l:l<2048?(o[d++]=192|l>>>6,o[d++]=128|l&63):l<65536?(o[d++]=224|l>>>12,o[d++]=128|l>>>6&63,o[d++]=128|l&63):(o[d++]=240|l>>>18,o[d++]=128|l>>>12&63,o[d++]=128|l>>>6&63,o[d++]=128|l&63);return o};function i(a,o){if(o<65534&&(a.subarray&&n||!a.subarray&&t))return String.fromCharCode.apply(null,e.shrinkBuf(a,o));for(var l="",c=0;c<o;c++)l+=String.fromCharCode(a[c]);return l}return Bp.buf2binstring=function(a){return i(a,a.length)},Bp.binstring2buf=function(a){for(var o=new e.Buf8(a.length),l=0,c=o.length;l<c;l++)o[l]=a.charCodeAt(l);return o},Bp.buf2string=function(a,o){var l,c,u,d,h=o||a.length,m=new Array(h*2);for(c=0,l=0;l<h;){if(u=a[l++],u<128){m[c++]=u;continue}if(d=r[u],d>4){m[c++]=65533,l+=d-1;continue}for(u&=d===2?31:d===3?15:7;d>1&&l<h;)u=u<<6|a[l++]&63,d--;if(d>1){m[c++]=65533;continue}u<65536?m[c++]=u:(u-=65536,m[c++]=55296|u>>10&1023,m[c++]=56320|u&1023)}return i(m,c)},Bp.utf8border=function(a,o){var l;for(o=o||a.length,o>a.length&&(o=a.length),l=o-1;l>=0&&(a[l]&192)===128;)l--;return l<0||l===0?o:l+r[a[l]]>o?l:o},Bp}var FM,W9;function kY(){if(W9)return FM;W9=1;function e(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}return FM=e,FM}var H9;function N2e(){if(H9)return Zg;H9=1;var e=R2e(),t=Gh(),n=CY(),r=tD(),s=kY(),i=Object.prototype.toString,a=0,o=4,l=0,c=1,u=2,d=-1,h=0,m=8;function y(w){if(!(this instanceof y))return new y(w);this.options=t.assign({level:d,method:m,chunkSize:16384,windowBits:15,memLevel:8,strategy:h,to:""},w||{});var S=this.options;S.raw&&S.windowBits>0?S.windowBits=-S.windowBits:S.gzip&&S.windowBits>0&&S.windowBits<16&&(S.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new s,this.strm.avail_out=0;var C=e.deflateInit2(this.strm,S.level,S.method,S.windowBits,S.memLevel,S.strategy);if(C!==l)throw new Error(r[C]);if(S.header&&e.deflateSetHeader(this.strm,S.header),S.dictionary){var k;if(typeof S.dictionary=="string"?k=n.string2buf(S.dictionary):i.call(S.dictionary)==="[object ArrayBuffer]"?k=new Uint8Array(S.dictionary):k=S.dictionary,C=e.deflateSetDictionary(this.strm,k),C!==l)throw new Error(r[C]);this._dict_set=!0}}y.prototype.push=function(w,S){var C=this.strm,k=this.options.chunkSize,A,R;if(this.ended)return!1;R=S===~~S?S:S===!0?o:a,typeof w=="string"?C.input=n.string2buf(w):i.call(w)==="[object ArrayBuffer]"?C.input=new Uint8Array(w):C.input=w,C.next_in=0,C.avail_in=C.input.length;do{if(C.avail_out===0&&(C.output=new t.Buf8(k),C.next_out=0,C.avail_out=k),A=e.deflate(C,R),A!==c&&A!==l)return this.onEnd(A),this.ended=!0,!1;(C.avail_out===0||C.avail_in===0&&(R===o||R===u))&&(this.options.to==="string"?this.onData(n.buf2binstring(t.shrinkBuf(C.output,C.next_out))):this.onData(t.shrinkBuf(C.output,C.next_out)))}while((C.avail_in>0||C.avail_out===0)&&A!==c);return R===o?(A=e.deflateEnd(this.strm),this.onEnd(A),this.ended=!0,A===l):(R===u&&(this.onEnd(l),C.avail_out=0),!0)},y.prototype.onData=function(w){this.chunks.push(w)},y.prototype.onEnd=function(w){w===l&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=t.flattenChunks(this.chunks)),this.chunks=[],this.err=w,this.msg=this.strm.msg};function b(w,S){var C=new y(S);if(C.push(w,!0),C.err)throw C.msg||r[C.err];return C.result}function v(w,S){return S=S||{},S.raw=!0,b(w,S)}function x(w,S){return S=S||{},S.gzip=!0,b(w,S)}return Zg.Deflate=y,Zg.deflate=b,Zg.deflateRaw=v,Zg.gzip=x,Zg}var Xg={},Pl={},LM,G9;function M2e(){if(G9)return LM;G9=1;var e=30,t=12;return LM=function(r,s){var i,a,o,l,c,u,d,h,m,y,b,v,x,w,S,C,k,A,R,N,I,P,L,O,V;i=r.state,a=r.next_in,O=r.input,o=a+(r.avail_in-5),l=r.next_out,V=r.output,c=l-(s-r.avail_out),u=l+(r.avail_out-257),d=i.dmax,h=i.wsize,m=i.whave,y=i.wnext,b=i.window,v=i.hold,x=i.bits,w=i.lencode,S=i.distcode,C=(1<<i.lenbits)-1,k=(1<<i.distbits)-1;e:do{x<15&&(v+=O[a++]<<x,x+=8,v+=O[a++]<<x,x+=8),A=w[v&C];t:for(;;){if(R=A>>>24,v>>>=R,x-=R,R=A>>>16&255,R===0)V[l++]=A&65535;else if(R&16){N=A&65535,R&=15,R&&(x<R&&(v+=O[a++]<<x,x+=8),N+=v&(1<<R)-1,v>>>=R,x-=R),x<15&&(v+=O[a++]<<x,x+=8,v+=O[a++]<<x,x+=8),A=S[v&k];n:for(;;){if(R=A>>>24,v>>>=R,x-=R,R=A>>>16&255,R&16){if(I=A&65535,R&=15,x<R&&(v+=O[a++]<<x,x+=8,x<R&&(v+=O[a++]<<x,x+=8)),I+=v&(1<<R)-1,I>d){r.msg="invalid distance too far back",i.mode=e;break e}if(v>>>=R,x-=R,R=l-c,I>R){if(R=I-R,R>m&&i.sane){r.msg="invalid distance too far back",i.mode=e;break e}if(P=0,L=b,y===0){if(P+=h-R,R<N){N-=R;do V[l++]=b[P++];while(--R);P=l-I,L=V}}else if(y<R){if(P+=h+y-R,R-=y,R<N){N-=R;do V[l++]=b[P++];while(--R);if(P=0,y<N){R=y,N-=R;do V[l++]=b[P++];while(--R);P=l-I,L=V}}}else if(P+=y-R,R<N){N-=R;do V[l++]=b[P++];while(--R);P=l-I,L=V}for(;N>2;)V[l++]=L[P++],V[l++]=L[P++],V[l++]=L[P++],N-=3;N&&(V[l++]=L[P++],N>1&&(V[l++]=L[P++]))}else{P=l-I;do V[l++]=V[P++],V[l++]=V[P++],V[l++]=V[P++],N-=3;while(N>2);N&&(V[l++]=V[P++],N>1&&(V[l++]=V[P++]))}}else if((R&64)===0){A=S[(A&65535)+(v&(1<<R)-1)];continue n}else{r.msg="invalid distance code",i.mode=e;break e}break}}else if((R&64)===0){A=w[(A&65535)+(v&(1<<R)-1)];continue t}else if(R&32){i.mode=t;break e}else{r.msg="invalid literal/length code",i.mode=e;break e}break}}while(a<o&&l<u);N=x>>3,a-=N,x-=N<<3,v&=(1<<x)-1,r.next_in=a,r.next_out=l,r.avail_in=a<o?5+(o-a):5-(a-o),r.avail_out=l<u?257+(u-l):257-(l-u),i.hold=v,i.bits=x},LM}var BM,K9;function I2e(){if(K9)return BM;K9=1;var e=Gh(),t=15,n=852,r=592,s=0,i=1,a=2,o=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],l=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],c=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],u=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];return BM=function(h,m,y,b,v,x,w,S){var C=S.bits,k=0,A=0,R=0,N=0,I=0,P=0,L=0,O=0,V=0,D=0,Z,U,H,$,ne,W=null,Q=0,ee,se=new e.Buf16(t+1),pe=new e.Buf16(t+1),ce=null,Ie=0,De,Se,Ce;for(k=0;k<=t;k++)se[k]=0;for(A=0;A<b;A++)se[m[y+A]]++;for(I=C,N=t;N>=1&&se[N]===0;N--);if(I>N&&(I=N),N===0)return v[x++]=1<<24|64<<16|0,v[x++]=1<<24|64<<16|0,S.bits=1,0;for(R=1;R<N&&se[R]===0;R++);for(I<R&&(I=R),O=1,k=1;k<=t;k++)if(O<<=1,O-=se[k],O<0)return-1;if(O>0&&(h===s||N!==1))return-1;for(pe[1]=0,k=1;k<t;k++)pe[k+1]=pe[k]+se[k];for(A=0;A<b;A++)m[y+A]!==0&&(w[pe[m[y+A]]++]=A);if(h===s?(W=ce=w,ee=19):h===i?(W=o,Q-=257,ce=l,Ie-=257,ee=256):(W=c,ce=u,ee=-1),D=0,A=0,k=R,ne=x,P=I,L=0,H=-1,V=1<<I,$=V-1,h===i&&V>n||h===a&&V>r)return 1;for(;;){De=k-L,w[A]<ee?(Se=0,Ce=w[A]):w[A]>ee?(Se=ce[Ie+w[A]],Ce=W[Q+w[A]]):(Se=96,Ce=0),Z=1<<k-L,U=1<<P,R=U;do U-=Z,v[ne+(D>>L)+U]=De<<24|Se<<16|Ce|0;while(U!==0);for(Z=1<<k-1;D&Z;)Z>>=1;if(Z!==0?(D&=Z-1,D+=Z):D=0,A++,--se[k]===0){if(k===N)break;k=m[y+w[A]]}if(k>I&&(D&$)!==H){for(L===0&&(L=I),ne+=R,P=k-L,O=1<<P;P+L<N&&(O-=se[P+L],!(O<=0));)P++,O<<=1;if(V+=1<<P,h===i&&V>n||h===a&&V>r)return 1;H=D&$,v[H]=I<<24|P<<16|ne-x|0}}return D!==0&&(v[ne+D]=k-L<<24|64<<16|0),S.bits=I,0},BM}var Y9;function j2e(){if(Y9)return Pl;Y9=1;var e=Gh(),t=_Y(),n=SY(),r=M2e(),s=I2e(),i=0,a=1,o=2,l=4,c=5,u=6,d=0,h=1,m=2,y=-2,b=-3,v=-4,x=-5,w=8,S=1,C=2,k=3,A=4,R=5,N=6,I=7,P=8,L=9,O=10,V=11,D=12,Z=13,U=14,H=15,$=16,ne=17,W=18,Q=19,ee=20,se=21,pe=22,ce=23,Ie=24,De=25,Se=26,Ce=27,qe=28,Qe=29,Ve=30,Ne=31,K=32,ge=852,Ae=592,le=15,oe=le;function re(we){return(we>>>24&255)+(we>>>8&65280)+((we&65280)<<8)+((we&255)<<24)}function Te(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new e.Buf16(320),this.work=new e.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function Be(we){var Me;return!we||!we.state?y:(Me=we.state,we.total_in=we.total_out=Me.total=0,we.msg="",Me.wrap&&(we.adler=Me.wrap&1),Me.mode=S,Me.last=0,Me.havedict=0,Me.dmax=32768,Me.head=null,Me.hold=0,Me.bits=0,Me.lencode=Me.lendyn=new e.Buf32(ge),Me.distcode=Me.distdyn=new e.Buf32(Ae),Me.sane=1,Me.back=-1,d)}function ke(we){var Me;return!we||!we.state?y:(Me=we.state,Me.wsize=0,Me.whave=0,Me.wnext=0,Be(we))}function lt(we,Me){var de,vt;return!we||!we.state||(vt=we.state,Me<0?(de=0,Me=-Me):(de=(Me>>4)+1,Me<48&&(Me&=15)),Me&&(Me<8||Me>15))?y:(vt.window!==null&&vt.wbits!==Me&&(vt.window=null),vt.wrap=de,vt.wbits=Me,ke(we))}function Rt(we,Me){var de,vt;return we?(vt=new Te,we.state=vt,vt.window=null,de=lt(we,Me),de!==d&&(we.state=null),de):y}function ht(we){return Rt(we,oe)}var Pt=!0,qt,Lt;function en(we){if(Pt){var Me;for(qt=new e.Buf32(512),Lt=new e.Buf32(32),Me=0;Me<144;)we.lens[Me++]=8;for(;Me<256;)we.lens[Me++]=9;for(;Me<280;)we.lens[Me++]=7;for(;Me<288;)we.lens[Me++]=8;for(s(a,we.lens,0,288,qt,0,we.work,{bits:9}),Me=0;Me<32;)we.lens[Me++]=5;s(o,we.lens,0,32,Lt,0,we.work,{bits:5}),Pt=!1}we.lencode=qt,we.lenbits=9,we.distcode=Lt,we.distbits=5}function xe(we,Me,de,vt){var ot,B=we.state;return B.window===null&&(B.wsize=1<<B.wbits,B.wnext=0,B.whave=0,B.window=new e.Buf8(B.wsize)),vt>=B.wsize?(e.arraySet(B.window,Me,de-B.wsize,B.wsize,0),B.wnext=0,B.whave=B.wsize):(ot=B.wsize-B.wnext,ot>vt&&(ot=vt),e.arraySet(B.window,Me,de-vt,ot,B.wnext),vt-=ot,vt?(e.arraySet(B.window,Me,de-vt,vt,0),B.wnext=vt,B.whave=B.wsize):(B.wnext+=ot,B.wnext===B.wsize&&(B.wnext=0),B.whave<B.wsize&&(B.whave+=ot))),0}function F(we,Me){var de,vt,ot,B,ze,st,be,_e,Ue,kt,fe,Y,G,J,ve=0,Oe,Ge,_t,tn,Un,Xt,nn,un,mr=new e.Buf8(4),Rr,ns,rs=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!we||!we.state||!we.output||!we.input&&we.avail_in!==0)return y;de=we.state,de.mode===D&&(de.mode=Z),ze=we.next_out,ot=we.output,be=we.avail_out,B=we.next_in,vt=we.input,st=we.avail_in,_e=de.hold,Ue=de.bits,kt=st,fe=be,un=d;e:for(;;)switch(de.mode){case S:if(de.wrap===0){de.mode=Z;break}for(;Ue<16;){if(st===0)break e;st--,_e+=vt[B++]<<Ue,Ue+=8}if(de.wrap&2&&_e===35615){de.check=0,mr[0]=_e&255,mr[1]=_e>>>8&255,de.check=n(de.check,mr,2,0),_e=0,Ue=0,de.mode=C;break}if(de.flags=0,de.head&&(de.head.done=!1),!(de.wrap&1)||(((_e&255)<<8)+(_e>>8))%31){we.msg="incorrect header check",de.mode=Ve;break}if((_e&15)!==w){we.msg="unknown compression method",de.mode=Ve;break}if(_e>>>=4,Ue-=4,nn=(_e&15)+8,de.wbits===0)de.wbits=nn;else if(nn>de.wbits){we.msg="invalid window size",de.mode=Ve;break}de.dmax=1<<nn,we.adler=de.check=1,de.mode=_e&512?O:D,_e=0,Ue=0;break;case C:for(;Ue<16;){if(st===0)break e;st--,_e+=vt[B++]<<Ue,Ue+=8}if(de.flags=_e,(de.flags&255)!==w){we.msg="unknown compression method",de.mode=Ve;break}if(de.flags&57344){we.msg="unknown header flags set",de.mode=Ve;break}de.head&&(de.head.text=_e>>8&1),de.flags&512&&(mr[0]=_e&255,mr[1]=_e>>>8&255,de.check=n(de.check,mr,2,0)),_e=0,Ue=0,de.mode=k;case k:for(;Ue<32;){if(st===0)break e;st--,_e+=vt[B++]<<Ue,Ue+=8}de.head&&(de.head.time=_e),de.flags&512&&(mr[0]=_e&255,mr[1]=_e>>>8&255,mr[2]=_e>>>16&255,mr[3]=_e>>>24&255,de.check=n(de.check,mr,4,0)),_e=0,Ue=0,de.mode=A;case A:for(;Ue<16;){if(st===0)break e;st--,_e+=vt[B++]<<Ue,Ue+=8}de.head&&(de.head.xflags=_e&255,de.head.os=_e>>8),de.flags&512&&(mr[0]=_e&255,mr[1]=_e>>>8&255,de.check=n(de.check,mr,2,0)),_e=0,Ue=0,de.mode=R;case R:if(de.flags&1024){for(;Ue<16;){if(st===0)break e;st--,_e+=vt[B++]<<Ue,Ue+=8}de.length=_e,de.head&&(de.head.extra_len=_e),de.flags&512&&(mr[0]=_e&255,mr[1]=_e>>>8&255,de.check=n(de.check,mr,2,0)),_e=0,Ue=0}else de.head&&(de.head.extra=null);de.mode=N;case N:if(de.flags&1024&&(Y=de.length,Y>st&&(Y=st),Y&&(de.head&&(nn=de.head.extra_len-de.length,de.head.extra||(de.head.extra=new Array(de.head.extra_len)),e.arraySet(de.head.extra,vt,B,Y,nn)),de.flags&512&&(de.check=n(de.check,vt,Y,B)),st-=Y,B+=Y,de.length-=Y),de.length))break e;de.length=0,de.mode=I;case I:if(de.flags&2048){if(st===0)break e;Y=0;do nn=vt[B+Y++],de.head&&nn&&de.length<65536&&(de.head.name+=String.fromCharCode(nn));while(nn&&Y<st);if(de.flags&512&&(de.check=n(de.check,vt,Y,B)),st-=Y,B+=Y,nn)break e}else de.head&&(de.head.name=null);de.length=0,de.mode=P;case P:if(de.flags&4096){if(st===0)break e;Y=0;do nn=vt[B+Y++],de.head&&nn&&de.length<65536&&(de.head.comment+=String.fromCharCode(nn));while(nn&&Y<st);if(de.flags&512&&(de.check=n(de.check,vt,Y,B)),st-=Y,B+=Y,nn)break e}else de.head&&(de.head.comment=null);de.mode=L;case L:if(de.flags&512){for(;Ue<16;){if(st===0)break e;st--,_e+=vt[B++]<<Ue,Ue+=8}if(_e!==(de.check&65535)){we.msg="header crc mismatch",de.mode=Ve;break}_e=0,Ue=0}de.head&&(de.head.hcrc=de.flags>>9&1,de.head.done=!0),we.adler=de.check=0,de.mode=D;break;case O:for(;Ue<32;){if(st===0)break e;st--,_e+=vt[B++]<<Ue,Ue+=8}we.adler=de.check=re(_e),_e=0,Ue=0,de.mode=V;case V:if(de.havedict===0)return we.next_out=ze,we.avail_out=be,we.next_in=B,we.avail_in=st,de.hold=_e,de.bits=Ue,m;we.adler=de.check=1,de.mode=D;case D:if(Me===c||Me===u)break e;case Z:if(de.last){_e>>>=Ue&7,Ue-=Ue&7,de.mode=Ce;break}for(;Ue<3;){if(st===0)break e;st--,_e+=vt[B++]<<Ue,Ue+=8}switch(de.last=_e&1,_e>>>=1,Ue-=1,_e&3){case 0:de.mode=U;break;case 1:if(en(de),de.mode=ee,Me===u){_e>>>=2,Ue-=2;break e}break;case 2:de.mode=ne;break;case 3:we.msg="invalid block type",de.mode=Ve}_e>>>=2,Ue-=2;break;case U:for(_e>>>=Ue&7,Ue-=Ue&7;Ue<32;){if(st===0)break e;st--,_e+=vt[B++]<<Ue,Ue+=8}if((_e&65535)!==(_e>>>16^65535)){we.msg="invalid stored block lengths",de.mode=Ve;break}if(de.length=_e&65535,_e=0,Ue=0,de.mode=H,Me===u)break e;case H:de.mode=$;case $:if(Y=de.length,Y){if(Y>st&&(Y=st),Y>be&&(Y=be),Y===0)break e;e.arraySet(ot,vt,B,Y,ze),st-=Y,B+=Y,be-=Y,ze+=Y,de.length-=Y;break}de.mode=D;break;case ne:for(;Ue<14;){if(st===0)break e;st--,_e+=vt[B++]<<Ue,Ue+=8}if(de.nlen=(_e&31)+257,_e>>>=5,Ue-=5,de.ndist=(_e&31)+1,_e>>>=5,Ue-=5,de.ncode=(_e&15)+4,_e>>>=4,Ue-=4,de.nlen>286||de.ndist>30){we.msg="too many length or distance symbols",de.mode=Ve;break}de.have=0,de.mode=W;case W:for(;de.have<de.ncode;){for(;Ue<3;){if(st===0)break e;st--,_e+=vt[B++]<<Ue,Ue+=8}de.lens[rs[de.have++]]=_e&7,_e>>>=3,Ue-=3}for(;de.have<19;)de.lens[rs[de.have++]]=0;if(de.lencode=de.lendyn,de.lenbits=7,Rr={bits:de.lenbits},un=s(i,de.lens,0,19,de.lencode,0,de.work,Rr),de.lenbits=Rr.bits,un){we.msg="invalid code lengths set",de.mode=Ve;break}de.have=0,de.mode=Q;case Q:for(;de.have<de.nlen+de.ndist;){for(;ve=de.lencode[_e&(1<<de.lenbits)-1],Oe=ve>>>24,Ge=ve>>>16&255,_t=ve&65535,!(Oe<=Ue);){if(st===0)break e;st--,_e+=vt[B++]<<Ue,Ue+=8}if(_t<16)_e>>>=Oe,Ue-=Oe,de.lens[de.have++]=_t;else{if(_t===16){for(ns=Oe+2;Ue<ns;){if(st===0)break e;st--,_e+=vt[B++]<<Ue,Ue+=8}if(_e>>>=Oe,Ue-=Oe,de.have===0){we.msg="invalid bit length repeat",de.mode=Ve;break}nn=de.lens[de.have-1],Y=3+(_e&3),_e>>>=2,Ue-=2}else if(_t===17){for(ns=Oe+3;Ue<ns;){if(st===0)break e;st--,_e+=vt[B++]<<Ue,Ue+=8}_e>>>=Oe,Ue-=Oe,nn=0,Y=3+(_e&7),_e>>>=3,Ue-=3}else{for(ns=Oe+7;Ue<ns;){if(st===0)break e;st--,_e+=vt[B++]<<Ue,Ue+=8}_e>>>=Oe,Ue-=Oe,nn=0,Y=11+(_e&127),_e>>>=7,Ue-=7}if(de.have+Y>de.nlen+de.ndist){we.msg="invalid bit length repeat",de.mode=Ve;break}for(;Y--;)de.lens[de.have++]=nn}}if(de.mode===Ve)break;if(de.lens[256]===0){we.msg="invalid code -- missing end-of-block",de.mode=Ve;break}if(de.lenbits=9,Rr={bits:de.lenbits},un=s(a,de.lens,0,de.nlen,de.lencode,0,de.work,Rr),de.lenbits=Rr.bits,un){we.msg="invalid literal/lengths set",de.mode=Ve;break}if(de.distbits=6,de.distcode=de.distdyn,Rr={bits:de.distbits},un=s(o,de.lens,de.nlen,de.ndist,de.distcode,0,de.work,Rr),de.distbits=Rr.bits,un){we.msg="invalid distances set",de.mode=Ve;break}if(de.mode=ee,Me===u)break e;case ee:de.mode=se;case se:if(st>=6&&be>=258){we.next_out=ze,we.avail_out=be,we.next_in=B,we.avail_in=st,de.hold=_e,de.bits=Ue,r(we,fe),ze=we.next_out,ot=we.output,be=we.avail_out,B=we.next_in,vt=we.input,st=we.avail_in,_e=de.hold,Ue=de.bits,de.mode===D&&(de.back=-1);break}for(de.back=0;ve=de.lencode[_e&(1<<de.lenbits)-1],Oe=ve>>>24,Ge=ve>>>16&255,_t=ve&65535,!(Oe<=Ue);){if(st===0)break e;st--,_e+=vt[B++]<<Ue,Ue+=8}if(Ge&&(Ge&240)===0){for(tn=Oe,Un=Ge,Xt=_t;ve=de.lencode[Xt+((_e&(1<<tn+Un)-1)>>tn)],Oe=ve>>>24,Ge=ve>>>16&255,_t=ve&65535,!(tn+Oe<=Ue);){if(st===0)break e;st--,_e+=vt[B++]<<Ue,Ue+=8}_e>>>=tn,Ue-=tn,de.back+=tn}if(_e>>>=Oe,Ue-=Oe,de.back+=Oe,de.length=_t,Ge===0){de.mode=Se;break}if(Ge&32){de.back=-1,de.mode=D;break}if(Ge&64){we.msg="invalid literal/length code",de.mode=Ve;break}de.extra=Ge&15,de.mode=pe;case pe:if(de.extra){for(ns=de.extra;Ue<ns;){if(st===0)break e;st--,_e+=vt[B++]<<Ue,Ue+=8}de.length+=_e&(1<<de.extra)-1,_e>>>=de.extra,Ue-=de.extra,de.back+=de.extra}de.was=de.length,de.mode=ce;case ce:for(;ve=de.distcode[_e&(1<<de.distbits)-1],Oe=ve>>>24,Ge=ve>>>16&255,_t=ve&65535,!(Oe<=Ue);){if(st===0)break e;st--,_e+=vt[B++]<<Ue,Ue+=8}if((Ge&240)===0){for(tn=Oe,Un=Ge,Xt=_t;ve=de.distcode[Xt+((_e&(1<<tn+Un)-1)>>tn)],Oe=ve>>>24,Ge=ve>>>16&255,_t=ve&65535,!(tn+Oe<=Ue);){if(st===0)break e;st--,_e+=vt[B++]<<Ue,Ue+=8}_e>>>=tn,Ue-=tn,de.back+=tn}if(_e>>>=Oe,Ue-=Oe,de.back+=Oe,Ge&64){we.msg="invalid distance code",de.mode=Ve;break}de.offset=_t,de.extra=Ge&15,de.mode=Ie;case Ie:if(de.extra){for(ns=de.extra;Ue<ns;){if(st===0)break e;st--,_e+=vt[B++]<<Ue,Ue+=8}de.offset+=_e&(1<<de.extra)-1,_e>>>=de.extra,Ue-=de.extra,de.back+=de.extra}if(de.offset>de.dmax){we.msg="invalid distance too far back",de.mode=Ve;break}de.mode=De;case De:if(be===0)break e;if(Y=fe-be,de.offset>Y){if(Y=de.offset-Y,Y>de.whave&&de.sane){we.msg="invalid distance too far back",de.mode=Ve;break}Y>de.wnext?(Y-=de.wnext,G=de.wsize-Y):G=de.wnext-Y,Y>de.length&&(Y=de.length),J=de.window}else J=ot,G=ze-de.offset,Y=de.length;Y>be&&(Y=be),be-=Y,de.length-=Y;do ot[ze++]=J[G++];while(--Y);de.length===0&&(de.mode=se);break;case Se:if(be===0)break e;ot[ze++]=de.length,be--,de.mode=se;break;case Ce:if(de.wrap){for(;Ue<32;){if(st===0)break e;st--,_e|=vt[B++]<<Ue,Ue+=8}if(fe-=be,we.total_out+=fe,de.total+=fe,fe&&(we.adler=de.check=de.flags?n(de.check,ot,fe,ze-fe):t(de.check,ot,fe,ze-fe)),fe=be,(de.flags?_e:re(_e))!==de.check){we.msg="incorrect data check",de.mode=Ve;break}_e=0,Ue=0}de.mode=qe;case qe:if(de.wrap&&de.flags){for(;Ue<32;){if(st===0)break e;st--,_e+=vt[B++]<<Ue,Ue+=8}if(_e!==(de.total&4294967295)){we.msg="incorrect length check",de.mode=Ve;break}_e=0,Ue=0}de.mode=Qe;case Qe:un=h;break e;case Ve:un=b;break e;case Ne:return v;case K:default:return y}return we.next_out=ze,we.avail_out=be,we.next_in=B,we.avail_in=st,de.hold=_e,de.bits=Ue,(de.wsize||fe!==we.avail_out&&de.mode<Ve&&(de.mode<Ce||Me!==l))&&xe(we,we.output,we.next_out,fe-we.avail_out),kt-=we.avail_in,fe-=we.avail_out,we.total_in+=kt,we.total_out+=fe,de.total+=fe,de.wrap&&fe&&(we.adler=de.check=de.flags?n(de.check,ot,fe,we.next_out-fe):t(de.check,ot,fe,we.next_out-fe)),we.data_type=de.bits+(de.last?64:0)+(de.mode===D?128:0)+(de.mode===ee||de.mode===H?256:0),(kt===0&&fe===0||Me===l)&&un===d&&(un=x),un}function X(we){if(!we||!we.state)return y;var Me=we.state;return Me.window&&(Me.window=null),we.state=null,d}function ye(we,Me){var de;return!we||!we.state||(de=we.state,(de.wrap&2)===0)?y:(de.head=Me,Me.done=!1,d)}function Fe(we,Me){var de=Me.length,vt,ot,B;return!we||!we.state||(vt=we.state,vt.wrap!==0&&vt.mode!==V)?y:vt.mode===V&&(ot=1,ot=t(ot,Me,de,0),ot!==vt.check)?b:(B=xe(we,Me,de,de),B?(vt.mode=Ne,v):(vt.havedict=1,d))}return Pl.inflateReset=ke,Pl.inflateReset2=lt,Pl.inflateResetKeep=Be,Pl.inflateInit=ht,Pl.inflateInit2=Rt,Pl.inflate=F,Pl.inflateEnd=X,Pl.inflateGetHeader=ye,Pl.inflateSetDictionary=Fe,Pl.inflateInfo="pako inflate (from Nodeca project)",Pl}var $M,Z9;function EY(){return Z9||(Z9=1,$M={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}),$M}var zM,X9;function P2e(){if(X9)return zM;X9=1;function e(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}return zM=e,zM}var J9;function O2e(){if(J9)return Xg;J9=1;var e=j2e(),t=Gh(),n=CY(),r=EY(),s=tD(),i=kY(),a=P2e(),o=Object.prototype.toString;function l(d){if(!(this instanceof l))return new l(d);this.options=t.assign({chunkSize:16384,windowBits:0,to:""},d||{});var h=this.options;h.raw&&h.windowBits>=0&&h.windowBits<16&&(h.windowBits=-h.windowBits,h.windowBits===0&&(h.windowBits=-15)),h.windowBits>=0&&h.windowBits<16&&!(d&&d.windowBits)&&(h.windowBits+=32),h.windowBits>15&&h.windowBits<48&&(h.windowBits&15)===0&&(h.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new i,this.strm.avail_out=0;var m=e.inflateInit2(this.strm,h.windowBits);if(m!==r.Z_OK)throw new Error(s[m]);if(this.header=new a,e.inflateGetHeader(this.strm,this.header),h.dictionary&&(typeof h.dictionary=="string"?h.dictionary=n.string2buf(h.dictionary):o.call(h.dictionary)==="[object ArrayBuffer]"&&(h.dictionary=new Uint8Array(h.dictionary)),h.raw&&(m=e.inflateSetDictionary(this.strm,h.dictionary),m!==r.Z_OK)))throw new Error(s[m])}l.prototype.push=function(d,h){var m=this.strm,y=this.options.chunkSize,b=this.options.dictionary,v,x,w,S,C,k=!1;if(this.ended)return!1;x=h===~~h?h:h===!0?r.Z_FINISH:r.Z_NO_FLUSH,typeof d=="string"?m.input=n.binstring2buf(d):o.call(d)==="[object ArrayBuffer]"?m.input=new Uint8Array(d):m.input=d,m.next_in=0,m.avail_in=m.input.length;do{if(m.avail_out===0&&(m.output=new t.Buf8(y),m.next_out=0,m.avail_out=y),v=e.inflate(m,r.Z_NO_FLUSH),v===r.Z_NEED_DICT&&b&&(v=e.inflateSetDictionary(this.strm,b)),v===r.Z_BUF_ERROR&&k===!0&&(v=r.Z_OK,k=!1),v!==r.Z_STREAM_END&&v!==r.Z_OK)return this.onEnd(v),this.ended=!0,!1;m.next_out&&(m.avail_out===0||v===r.Z_STREAM_END||m.avail_in===0&&(x===r.Z_FINISH||x===r.Z_SYNC_FLUSH))&&(this.options.to==="string"?(w=n.utf8border(m.output,m.next_out),S=m.next_out-w,C=n.buf2string(m.output,w),m.next_out=S,m.avail_out=y-S,S&&t.arraySet(m.output,m.output,w,S,0),this.onData(C)):this.onData(t.shrinkBuf(m.output,m.next_out))),m.avail_in===0&&m.avail_out===0&&(k=!0)}while((m.avail_in>0||m.avail_out===0)&&v!==r.Z_STREAM_END);return v===r.Z_STREAM_END&&(x=r.Z_FINISH),x===r.Z_FINISH?(v=e.inflateEnd(this.strm),this.onEnd(v),this.ended=!0,v===r.Z_OK):(x===r.Z_SYNC_FLUSH&&(this.onEnd(r.Z_OK),m.avail_out=0),!0)},l.prototype.onData=function(d){this.chunks.push(d)},l.prototype.onEnd=function(d){d===r.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=t.flattenChunks(this.chunks)),this.chunks=[],this.err=d,this.msg=this.strm.msg};function c(d,h){var m=new l(h);if(m.push(d,!0),m.err)throw m.msg||s[m.err];return m.result}function u(d,h){return h=h||{},h.raw=!0,c(d,h)}return Xg.Inflate=l,Xg.inflate=c,Xg.inflateRaw=u,Xg.ungzip=c,Xg}var UM,Q9;function D2e(){if(Q9)return UM;Q9=1;var e=Gh().assign,t=N2e(),n=O2e(),r=EY(),s={};return e(s,t,n,r),UM=s,UM}var F2e=D2e();const nD=_a(F2e);var qM,ez;function L2e(){if(ez)return qM;ez=1;const e=(t,n)=>function(...r){const s=n.promiseModule;return new s((i,a)=>{n.multiArgs?r.push((...o)=>{n.errorFirst?o[0]?a(o):(o.shift(),i(o)):i(o)}):n.errorFirst?r.push((o,l)=>{o?a(o):i(l)}):r.push(i),t.apply(this,r)})};return qM=(t,n)=>{n=Object.assign({exclude:[/.+(Sync|Stream)$/],errorFirst:!0,promiseModule:Promise},n);const r=typeof t;if(!(t!==null&&(r==="object"||r==="function")))throw new TypeError(`Expected \`input\` to be a \`Function\` or \`Object\`, got \`${t===null?"null":r}\``);const s=a=>{const o=l=>typeof l=="string"?a===l:l.test(a);return n.include?n.include.some(o):!n.exclude.some(o)};let i;r==="function"?i=function(...a){return n.excludeMain?t(...a):e(t,n).apply(this,a)}:i=Object.create(Object.getPrototypeOf(t));for(const a in t){const o=t[a];i[a]=typeof o=="function"&&s(a)?e(o,n):o}return i},qM}var B2e=L2e();const VM=_a(B2e);var WM,tz;function $2e(){if(tz)return WM;tz=1;var e={};function t(H){return Array.isArray(H)?H:[H]}const n="",r=" ",s="\\",i=/^\s+$/,a=/(?:[^\\]|^)\\$/,o=/^\\!/,l=/^\\#/,c=/\r?\n/g,u=/^\.*\/|^\.+$/,d="/";let h="node-ignore";typeof Symbol<"u"&&(h=Symbol.for("node-ignore"));const m=h,y=(H,$,ne)=>Object.defineProperty(H,$,{value:ne}),b=/([0-z])-([0-z])/g,v=()=>!1,x=H=>H.replace(b,($,ne,W)=>ne.charCodeAt(0)<=W.charCodeAt(0)?$:n),w=H=>{const{length:$}=H;return H.slice(0,$-$%2)},S=[[/^\uFEFF/,()=>n],[/((?:\\\\)*?)(\\?\s+)$/,(H,$,ne)=>$+(ne.indexOf("\\")===0?r:n)],[/(\\+?)\s/g,(H,$)=>{const{length:ne}=$;return $.slice(0,ne-ne%2)+r}],[/[\\$.|*+(){^]/g,H=>`\\${H}`],[/(?!\\)\?/g,()=>"[^/]"],[/^\//,()=>"^"],[/\//g,()=>"\\/"],[/^\^*\\\*\\\*\\\//,()=>"^(?:.*\\/)?"],[/^(?=[^^])/,function(){return/\/(?!$)/.test(this)?"^":"(?:^|\\/)"}],[/\\\/\\\*\\\*(?=\\\/|$)/g,(H,$,ne)=>$+6<ne.length?"(?:\\/[^\\/]+)*":"\\/.+"],[/(^|[^\\]+)(\\\*)+(?=.+)/g,(H,$,ne)=>{const W=ne.replace(/\\\*/g,"[^\\/]*");return $+W}],[/\\\\\\(?=[$.|*+(){^])/g,()=>s],[/\\\\/g,()=>s],[/(\\)?\[([^\]/]*?)(\\*)($|\])/g,(H,$,ne,W,Q)=>$===s?`\\[${ne}${w(W)}${Q}`:Q==="]"&&W.length%2===0?`[${x(ne)}${W}]`:"[]"],[/(?:[^*])$/,H=>/\/$/.test(H)?`${H}$`:`${H}(?=$|\\/$)`],[/(\^|\\\/)?\\\*$/,(H,$)=>`${$?`${$}[^/]+`:"[^/]*"}(?=$|\\/$)`]],C=Object.create(null),k=(H,$)=>{let ne=C[H];return ne||(ne=S.reduce((W,[Q,ee])=>W.replace(Q,ee.bind(H)),H),C[H]=ne),$?new RegExp(ne,"i"):new RegExp(ne)},A=H=>typeof H=="string",R=H=>H&&A(H)&&!i.test(H)&&!a.test(H)&&H.indexOf("#")!==0,N=H=>H.split(c);class I{constructor($,ne,W,Q){this.origin=$,this.pattern=ne,this.negative=W,this.regex=Q}}const P=(H,$)=>{const ne=H;let W=!1;H.indexOf("!")===0&&(W=!0,H=H.substr(1)),H=H.replace(o,"!").replace(l,"#");const Q=k(H,$);return new I(ne,H,W,Q)},L=(H,$)=>{throw new $(H)},O=(H,$,ne)=>A(H)?H?O.isNotRelative(H)?ne(`path should be a \`path.relative()\`d string, but got "${$}"`,RangeError):!0:ne("path must not be empty",TypeError):ne(`path must be a string, but got \`${$}\``,TypeError),V=H=>u.test(H);O.isNotRelative=V,O.convert=H=>H;class D{constructor({ignorecase:$=!0,ignoreCase:ne=$,allowRelativePaths:W=!1}={}){y(this,m,!0),this._rules=[],this._ignoreCase=ne,this._allowRelativePaths=W,this._initCache()}_initCache(){this._ignoreCache=Object.create(null),this._testCache=Object.create(null)}_addPattern($){if($&&$[m]){this._rules=this._rules.concat($._rules),this._added=!0;return}if(R($)){const ne=P($,this._ignoreCase);this._added=!0,this._rules.push(ne)}}add($){return this._added=!1,t(A($)?N($):$).forEach(this._addPattern,this),this._added&&this._initCache(),this}addPattern($){return this.add($)}_testOne($,ne){let W=!1,Q=!1;return this._rules.forEach(ee=>{const{negative:se}=ee;if(Q===se&&W!==Q||se&&!W&&!Q&&!ne)return;ee.regex.test($)&&(W=!se,Q=se)}),{ignored:W,unignored:Q}}_test($,ne,W,Q){const ee=$&&O.convert($);return O(ee,$,this._allowRelativePaths?v:L),this._t(ee,ne,W,Q)}_t($,ne,W,Q){if($ in ne)return ne[$];if(Q||(Q=$.split(d)),Q.pop(),!Q.length)return ne[$]=this._testOne($,W);const ee=this._t(Q.join(d)+d,ne,W,Q);return ne[$]=ee.ignored?ee:this._testOne($,W)}ignores($){return this._test($,this._ignoreCache,!1).ignored}createFilter(){return $=>!this.ignores($)}filter($){return t($).filter(this.createFilter())}test($){return this._test($,this._testCache,!0)}}const Z=H=>new D(H),U=H=>O(H&&O.convert(H),H,v);if(Z.isPathValid=U,Z.default=Z,WM=Z,typeof Ai<"u"&&(e&&e.IGNORE_TEST_WIN32||Ai.platform==="win32")){const H=ne=>/^\\\\\?\\/.test(ne)||/["<>|\u0000-\u001F]+/u.test(ne)?ne:ne.replace(/\\/g,"/");O.convert=H;const $=/^[a-z]:\//i;O.isNotRelative=ne=>$.test(ne)||V(ne)}return WM}var z2e=$2e();const U2e=_a(z2e);var HM,nz;function q2e(){if(nz)return HM;nz=1;function e(r){return r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function t(r,s,i){return s=s instanceof RegExp?s:new RegExp(e(s),"g"),r.replace(s,i)}var n={clean:function(s){if(typeof s!="string")throw new Error("Expected a string, received: "+s);return s=t(s,"./","/"),s=t(s,"..","."),s=t(s," ","-"),s=t(s,/^[~^:?*\\\-]/g,""),s=t(s,/[~^:?*\\]/g,"-"),s=t(s,/[~^:?*\\\-]$/g,""),s=t(s,"@{","-"),s=t(s,/\.$/g,""),s=t(s,/\/$/g,""),s=t(s,/\.lock$/g,""),s}};return HM=n,HM}var V2e=q2e();const gu=_a(V2e);var GM,rz;function W2e(){return rz||(rz=1,GM=function(e,t){var n=e,r=t,s=n.length,i=r.length,a=!1,o=null,l=s+1,c=[],u=[],d=[],h="",m=-1,y=0,b=1,v,x,w=function(){s>=i&&(v=n,x=s,n=r,r=v,s=i,i=x,a=!0,l=s+1)},S=function(R,N,I){return{x:R,y:N,k:I}},C=function(R,N){return{elem:R,t:N}},k=function(R,N,I){var P,L,O;for(N>I?P=c[R-1+l]:P=c[R+1+l],O=Math.max(N,I),L=O-R;L<s&&O<i&&n[L]===r[O];)++L,++O;return c[R+l]=u.length,u[u.length]=new S(L,O,P),O},A=function(R){var N,I,P;for(N=I=0,P=R.length-1;P>=0;--P)for(;N<R[P].x||I<R[P].y;)R[P].y-R[P].x>I-N?(a?d[d.length]=new C(r[I],m):d[d.length]=new C(r[I],b),++I):R[P].y-R[P].x<I-N?(a?d[d.length]=new C(n[N],b):d[d.length]=new C(n[N],m),++N):(d[d.length]=new C(n[N],y),h+=n[N],++N,++I)};return w(),{SES_DELETE:-1,SES_COMMON:0,SES_ADD:1,editdistance:function(){return o},getlcs:function(){return h},getses:function(){return d},compose:function(){var R,N,I,P,L,O,V,D;for(R=i-s,N=s+i+3,I={},V=0;V<N;++V)I[V]=-1,c[V]=-1;P=-1;do{for(++P,D=-P;D<=R-1;++D)I[D+l]=k(D,I[D-1+l]+1,I[D+1+l]);for(D=R+P;D>=R+1;--D)I[D+l]=k(D,I[D-1+l]+1,I[D+1+l]);I[R+l]=k(R,I[R-1+l]+1,I[R+1+l])}while(I[R+l]!==i);for(o=R+2*P,L=c[R+l],O=[];L!==-1;)O[O.length]=new S(u[L].x,u[L].y,null),L=u[L].k;A(O)}}}),GM}var KM,sz;function H2e(){if(sz)return KM;sz=1;var e=W2e();function t(i,a){var o=new e(i,a);o.compose();for(var l=o.getses(),c,u,d=i.length-1,h=a.length-1,m=l.length-1;m>=0;--m)l[m].t===o.SES_COMMON?(u?(u.chain={file1index:d,file2index:h,chain:null},u=u.chain):(c={file1index:d,file2index:h,chain:null},u=c),d--,h--):l[m].t===o.SES_DELETE?d--:l[m].t===o.SES_ADD&&h--;var y={file1index:-1,file2index:-1,chain:null};return u?(u.chain=y,c):y}function n(i,a){for(var o=[],l=i.length,c=a.length,u=t(i,a);u!==null;u=u.chain){var d=l-u.file1index-1,h=c-u.file2index-1;l=u.file1index,c=u.file2index,(d||h)&&o.push({file1:[l+1,d],file2:[c+1,h]})}return o.reverse(),o}function r(i,a,o){var l,c=n(a,i),u=n(a,o),d=[];function h($,ne){d.push([$.file1[0],ne,$.file1[1],$.file2[0],$.file2[1]])}for(l=0;l<c.length;l++)h(c[l],0);for(l=0;l<u.length;l++)h(u[l],2);d.sort(function($,ne){return $[0]-ne[0]});var m=[],y=0;function b($){$>y&&(m.push([1,y,$-y]),y=$)}for(var v=0;v<d.length;v++){for(var x=v,w=d[v],S=w[0],C=S+w[2];v<d.length-1;){var k=d[v+1],A=k[0];if(A>C)break;C=Math.max(C,A+k[2]),v++}if(b(S),x==v)w[4]>0&&m.push([w[1],w[3],w[4]]);else{var R={0:[i.length,-1,a.length,-1],2:[o.length,-1,a.length,-1]};for(l=x;l<=v;l++){w=d[l];var N=w[1],I=R[N],P=w[0],L=P+w[2],O=w[3],V=O+w[4];I[0]=Math.min(O,I[0]),I[1]=Math.max(V,I[1]),I[2]=Math.min(P,I[2]),I[3]=Math.max(L,I[3])}var D=R[0][0]+(S-R[0][2]),Z=R[0][1]+(C-R[0][3]),U=R[2][0]+(S-R[2][2]),H=R[2][1]+(C-R[2][3]);m.push([-1,D,Z-D,S,C-S,U,H-U])}y=C}return b(a.length),m}function s(i,a,o){var l=[],c=[i,a,o],u=r(i,a,o),d=[];function h(){d.length&&l.push({ok:d}),d=[]}function m(w){for(var S=0;S<w.length;S++)d.push(w[S])}function y(w){if(w[2]!=w[6])return!0;for(var S=w[1],C=w[5],k=0;k<w[2];k++)if(i[k+S]!=o[k+C])return!0;return!1}for(var b=0;b<u.length;b++){var v=u[b],x=v[0];x==-1?y(v)?(h(),l.push({conflict:{a:i.slice(v[1],v[1]+v[2]),aIndex:v[1],o:a.slice(v[3],v[3]+v[4]),oIndex:v[3],b:o.slice(v[5],v[5]+v[6]),bIndex:v[5]}})):m(c[0].slice(v[1],v[1]+v[2])):m(c[x].slice(v[1],v[1]+v[2]))}return h(),l}return KM=s,KM}var G2e=H2e();const K2e=_a(G2e);class Jr extends Error{constructor(t){super(t),this.caller=""}toJSON(){return{code:this.code,data:this.data,caller:this.caller,message:this.message,stack:this.stack}}fromJSON(t){const n=new Jr(t.message);return n.code=t.code,n.data=t.data,n.caller=t.caller,n.stack=t.stack,n}get isIsomorphicGitError(){return!0}}class x1 extends Jr{constructor(t){super(`Modifying the index is not possible because you have unmerged files: ${t.toString}. Fix them up in the work tree, and then use 'git add/rm as appropriate to mark resolution and make a commit.`),this.code=this.name=x1.code,this.data={filepaths:t}}}x1.code="UnmergedPathsError";class vr extends Jr{constructor(t){super(`An internal error caused this command to fail. Please file a bug report at https://github.com/isomorphic-git/isomorphic-git/issues with this error message: ${t}`),this.code=this.name=vr.code,this.data={message:t}}}vr.code="InternalError";class Gy extends Jr{constructor(t){super(`The filepath "${t}" contains unsafe character sequences`),this.code=this.name=Gy.code,this.data={filepath:t}}}Gy.code="UnsafeFilepathError";class hu{constructor(t){this.buffer=t,this._start=0}eof(){return this._start>=this.buffer.length}tell(){return this._start}seek(t){this._start=t}slice(t){const n=this.buffer.slice(this._start,this._start+t);return this._start+=t,n}toString(t,n){const r=this.buffer.toString(t,this._start,this._start+n);return this._start+=n,r}write(t,n,r){const s=this.buffer.write(t,this._start,n,r);return this._start+=n,s}copy(t,n,r){const s=t.copy(this.buffer,this._start,n,r);return this._start+=s,s}readUInt8(){const t=this.buffer.readUInt8(this._start);return this._start+=1,t}writeUInt8(t){const n=this.buffer.writeUInt8(t,this._start);return this._start+=1,n}readUInt16BE(){const t=this.buffer.readUInt16BE(this._start);return this._start+=2,t}writeUInt16BE(t){const n=this.buffer.writeUInt16BE(t,this._start);return this._start+=2,n}readUInt32BE(){const t=this.buffer.readUInt32BE(this._start);return this._start+=4,t}writeUInt32BE(t){const n=this.buffer.writeUInt32BE(t,this._start);return this._start+=4,n}}function XE(e,t){return-(e<t)||+(e>t)}function TY(e,t){return XE(e.path,t.path)}function AY(e){let t=e>0?e>>12:0;t!==4&&t!==8&&t!==10&&t!==14&&(t=8);let n=e&511;return n&73?n=493:n=420,t!==8&&(n=0),(t<<12)+n}const eu=2**32;function iz(e,t,n,r){if(e!==void 0&&t!==void 0)return[e,t];n===void 0&&(n=r.valueOf());const s=Math.floor(n/1e3),i=(n-s*1e3)*1e6;return[s,i]}function sy(e){const[t,n]=iz(e.ctimeSeconds,e.ctimeNanoseconds,e.ctimeMs,e.ctime),[r,s]=iz(e.mtimeSeconds,e.mtimeNanoseconds,e.mtimeMs,e.mtime);return{ctimeSeconds:t%eu,ctimeNanoseconds:n%eu,mtimeSeconds:r%eu,mtimeNanoseconds:s%eu,dev:e.dev%eu,ino:e.ino%eu,mode:AY(e.mode%eu),uid:e.uid%eu,gid:e.gid%eu,size:e.size>-1?e.size%eu:0}}function Y2e(e){let t="";for(const n of new Uint8Array(e))n<16&&(t+="0"),t+=n.toString(16);return t}let YM=null;async function Hd(e){return YM===null&&(YM=await X2e()),YM?RY(e):Z2e(e)}function Z2e(e){return new wY().update(e).digest("hex")}async function RY(e){const t=await crypto.subtle.digest("SHA-1",e);return Y2e(t)}async function X2e(){try{if(await RY(new Uint8Array([]))==="da39a3ee5e6b4b0d3255bfef95601890afd80709")return!0}catch{}return!1}function J2e(e){return{assumeValid:!!(e&32768),extended:!!(e&16384),stage:(e&12288)>>12,nameLength:e&4095}}function Q2e(e){const t=e.flags;return t.extended=!1,t.nameLength=Math.min(ln.from(e.path).length,4095),(t.assumeValid?32768:0)+(t.extended?16384:0)+((t.stage&3)<<12)+(t.nameLength&4095)}class Yp{constructor(t,n){this._dirty=!1,this._unmergedPaths=n||new Set,this._entries=t||new Map}_addEntry(t){if(t.flags.stage===0)t.stages=[t],this._entries.set(t.path,t),this._unmergedPaths.delete(t.path);else{let n=this._entries.get(t.path);n||(this._entries.set(t.path,t),n=t),n.stages[t.flags.stage]=t,this._unmergedPaths.add(t.path)}}static async from(t){if(ln.isBuffer(t))return Yp.fromBuffer(t);if(t===null)return new Yp(null);throw new vr("invalid type passed to GitIndex.from")}static async fromBuffer(t){if(t.length===0)throw new vr("Index file is empty (.git/index)");const n=new Yp,r=new hu(t),s=r.toString("utf8",4);if(s!=="DIRC")throw new vr(`Invalid dircache magic file number: ${s}`);const i=await Hd(t.slice(0,-20)),a=t.slice(-20).toString("hex");if(a!==i)throw new vr(`Invalid checksum in GitIndex buffer: expected ${a} but saw ${i}`);const o=r.readUInt32BE();if(o!==2)throw new vr(`Unsupported dircache version: ${o}`);const l=r.readUInt32BE();let c=0;for(;!r.eof()&&c<l;){const u={};u.ctimeSeconds=r.readUInt32BE(),u.ctimeNanoseconds=r.readUInt32BE(),u.mtimeSeconds=r.readUInt32BE(),u.mtimeNanoseconds=r.readUInt32BE(),u.dev=r.readUInt32BE(),u.ino=r.readUInt32BE(),u.mode=r.readUInt32BE(),u.uid=r.readUInt32BE(),u.gid=r.readUInt32BE(),u.size=r.readUInt32BE(),u.oid=r.slice(20).toString("hex");const d=r.readUInt16BE();u.flags=J2e(d);const h=t.indexOf(0,r.tell()+1)-r.tell();if(h<1)throw new vr(`Got a path length of: ${h}`);if(u.path=r.toString("utf8",h),u.path.includes("..\\")||u.path.includes("../"))throw new Gy(u.path);let m=8-(r.tell()-12)%8;for(m===0&&(m=8);m--;){const y=r.readUInt8();if(y!==0)throw new vr(`Expected 1-8 null characters but got '${y}' after ${u.path}`);if(r.eof())throw new vr("Unexpected end of file")}u.stages=[],n._addEntry(u),c++}return n}get unmergedPaths(){return[...this._unmergedPaths]}get entries(){return[...this._entries.values()].sort(TY)}get entriesMap(){return this._entries}get entriesFlat(){return[...this.entries].flatMap(t=>t.stages.length>1?t.stages.filter(n=>n):t)}*[Symbol.iterator](){for(const t of this.entries)yield t}insert({filepath:t,stats:n,oid:r,stage:s=0}){n||(n={ctimeSeconds:0,ctimeNanoseconds:0,mtimeSeconds:0,mtimeNanoseconds:0,dev:0,ino:0,mode:0,uid:0,gid:0,size:0}),n=sy(n);const i=ln.from(t),a={ctimeSeconds:n.ctimeSeconds,ctimeNanoseconds:n.ctimeNanoseconds,mtimeSeconds:n.mtimeSeconds,mtimeNanoseconds:n.mtimeNanoseconds,dev:n.dev,ino:n.ino,mode:n.mode||33188,uid:n.uid,gid:n.gid,size:n.size,path:t,oid:r,flags:{assumeValid:!1,extended:!1,stage:s,nameLength:i.length<4095?i.length:4095},stages:[]};this._addEntry(a),this._dirty=!0}delete({filepath:t}){if(this._entries.has(t))this._entries.delete(t);else for(const n of this._entries.keys())n.startsWith(t+"/")&&this._entries.delete(n);this._unmergedPaths.has(t)&&this._unmergedPaths.delete(t),this._dirty=!0}clear(){this._entries.clear(),this._dirty=!0}has({filepath:t}){return this._entries.has(t)}render(){return this.entries.map(t=>`${t.mode.toString(8)} ${t.oid}    ${t.path}`).join(`
`)}static async _entryToBuffer(t){const n=ln.from(t.path),r=Math.ceil((62+n.length+1)/8)*8,s=ln.alloc(r),i=new hu(s),a=sy(t);return i.writeUInt32BE(a.ctimeSeconds),i.writeUInt32BE(a.ctimeNanoseconds),i.writeUInt32BE(a.mtimeSeconds),i.writeUInt32BE(a.mtimeNanoseconds),i.writeUInt32BE(a.dev),i.writeUInt32BE(a.ino),i.writeUInt32BE(a.mode),i.writeUInt32BE(a.uid),i.writeUInt32BE(a.gid),i.writeUInt32BE(a.size),i.write(t.oid,20,"hex"),i.writeUInt16BE(Q2e(t)),i.write(t.path,n.length,"utf8"),s}async toObject(){const t=ln.alloc(12),n=new hu(t);n.write("DIRC",4,"utf8"),n.writeUInt32BE(2),n.writeUInt32BE(this.entriesFlat.length);let r=[];for(const o of this.entries)if(r.push(Yp._entryToBuffer(o)),o.stages.length>1)for(const l of o.stages)l&&l!==o&&r.push(Yp._entryToBuffer(l));r=await Promise.all(r);const s=ln.concat(r),i=ln.concat([t,s]),a=await Hd(i);return ln.concat([i,ln.from(a,"hex")])}}function VC(e,t,n=!0,r=!0){const s=sy(e),i=sy(t);return n&&s.mode!==i.mode||s.mtimeSeconds!==i.mtimeSeconds||s.ctimeSeconds!==i.ctimeSeconds||s.uid!==i.uid||s.gid!==i.gid||r&&s.ino!==i.ino||s.size!==i.size}let ZM=null;const XM=Symbol("IndexCache");function eCe(){return{map:new Map,stats:new Map}}async function tCe(e,t,n){const[r,s]=await Promise.all([e.lstat(t),e.read(t)]),i=await Yp.from(s);n.map.set(t,i),n.stats.set(t,r)}async function nCe(e,t,n){const r=n.stats.get(t);if(r===void 0)return!0;if(r===null)return!1;const s=await e.lstat(t);return s===null?!1:VC(r,s)}class oa{static async acquire({fs:t,gitdir:n,cache:r,allowUnmerged:s=!0},i){r[XM]||(r[XM]=eCe());const a=`${n}/index`;ZM===null&&(ZM=new aw({maxPending:1/0}));let o,l=[];return await ZM.acquire(a,async()=>{const c=r[XM];await nCe(t,a,c)&&await tCe(t,a,c);const u=c.map.get(a);if(l=u.unmergedPaths,l.length&&!s)throw new x1(l);if(o=await i(u),u._dirty){const d=await u.toObject();await t.write(a,d),c.stats.set(a,await t.lstat(a)),u._dirty=!1}}),o}}function WC(e){const t=Math.max(e.lastIndexOf("/"),e.lastIndexOf("\\"));return t>-1&&(e=e.slice(t+1)),e}function iy(e){const t=Math.max(e.lastIndexOf("/"),e.lastIndexOf("\\"));return t===-1?".":t===0?"/":e.slice(0,t)}function NY(e){const t=new Map,n=function(s){if(!t.has(s)){const i={type:"tree",fullpath:s,basename:WC(s),metadata:{},children:[]};t.set(s,i),i.parent=n(iy(s)),i.parent&&i.parent!==i&&i.parent.children.push(i)}return t.get(s)},r=function(s,i){if(!t.has(s)){const a={type:"blob",fullpath:s,basename:WC(s),metadata:i,parent:n(iy(s)),children:[]};a.parent&&a.parent.children.push(a),t.set(s,a)}return t.get(s)};n(".");for(const s of e)r(s.path,s);return t}function rCe(e){switch(e){case 16384:return"tree";case 33188:return"blob";case 33261:return"blob";case 40960:return"blob";case 57344:return"commit"}throw new vr(`Unexpected GitTree entry mode: ${e.toString(8)}`)}class sCe{constructor({fs:t,gitdir:n,cache:r}){this.treePromise=oa.acquire({fs:t,gitdir:n,cache:r},async function(i){return NY(i.entries)});const s=this;this.ConstructEntry=class{constructor(a){this._fullpath=a,this._type=!1,this._mode=!1,this._stat=!1,this._oid=!1}async type(){return s.type(this)}async mode(){return s.mode(this)}async stat(){return s.stat(this)}async content(){return s.content(this)}async oid(){return s.oid(this)}}}async readdir(t){const n=t._fullpath,s=(await this.treePromise).get(n);if(!s||s.type==="blob")return null;if(s.type!=="tree")throw new Error(`ENOTDIR: not a directory, scandir '${n}'`);const i=s.children.map(a=>a.fullpath);return i.sort(XE),i}async type(t){return t._type===!1&&await t.stat(),t._type}async mode(t){return t._mode===!1&&await t.stat(),t._mode}async stat(t){if(t._stat===!1){const r=(await this.treePromise).get(t._fullpath);if(!r)throw new Error(`ENOENT: no such file or directory, lstat '${t._fullpath}'`);const s=r.type==="tree"?{}:sy(r.metadata);t._type=r.type==="tree"?"tree":rCe(s.mode),t._mode=s.mode,r.type==="tree"?t._stat=void 0:t._stat=s}return t._stat}async content(t){}async oid(t){if(t._oid===!1){const r=(await this.treePromise).get(t._fullpath);t._oid=r.metadata.oid}return t._oid}}const JE=Symbol("GitWalkSymbol");function Ky(){const e=Object.create(null);return Object.defineProperty(e,JE,{value:function({fs:t,gitdir:n,cache:r}){return new sCe({fs:t,gitdir:n,cache:r})}}),Object.freeze(e),e}class Ts extends Jr{constructor(t){super(`Could not find ${t}.`),this.code=this.name=Ts.code,this.data={what:t}}}Ts.code="NotFoundError";class uo extends Jr{constructor(t,n,r,s){super(`Object ${t} ${s?`at ${s}`:""}was anticipated to be a ${r} but it is a ${n}.`),this.code=this.name=uo.code,this.data={oid:t,actual:n,expected:r,filepath:s}}}uo.code="ObjectTypeError";class Ch extends Jr{constructor(t){super(`Expected a 40-char hex object id but saw "${t}".`),this.code=this.name=Ch.code,this.data={value:t}}}Ch.code="InvalidOidError";class w1 extends Jr{constructor(t){super(`Could not find a fetch refspec for remote "${t}". Make sure the config file has an entry like the following:
[remote "${t}"]
	fetch = +refs/heads/*:refs/remotes/origin/*
`),this.code=this.name=w1.code,this.data={remote:t}}}w1.code="NoRefspecError";class HC{constructor(t){if(this.refs=new Map,this.parsedConfig=[],t){let n=null;this.parsedConfig=t.trim().split(`
`).map(r=>{if(/^\s*#/.test(r))return{line:r,comment:!0};const s=r.indexOf(" ");if(r.startsWith("^")){const i=r.slice(1);return this.refs.set(n+"^{}",i),{line:r,ref:n,peeled:i}}else{const i=r.slice(0,s);return n=r.slice(s+1),this.refs.set(n,i),{line:r,ref:n,oid:i}}})}return this}static from(t){return new HC(t)}delete(t){this.parsedConfig=this.parsedConfig.filter(n=>n.ref!==t),this.refs.delete(t)}toString(){return this.parsedConfig.map(({line:t})=>t).join(`
`)+`
`}}class GC{constructor({remotePath:t,localPath:n,force:r,matchPrefix:s}){Object.assign(this,{remotePath:t,localPath:n,force:r,matchPrefix:s})}static from(t){const[n,r,s,i,a]=t.match(/^(\+?)(.*?)(\*?):(.*?)(\*?)$/).slice(1),o=n==="+",l=s==="*";if(l!==(a==="*"))throw new vr("Invalid refspec");return new GC({remotePath:r,localPath:i,force:o,matchPrefix:l})}translate(t){if(this.matchPrefix){if(t.startsWith(this.remotePath))return this.localPath+t.replace(this.remotePath,"")}else if(t===this.remotePath)return this.localPath;return null}reverseTranslate(t){if(this.matchPrefix){if(t.startsWith(this.localPath))return this.remotePath+t.replace(this.localPath,"")}else if(t===this.localPath)return this.remotePath;return null}}class rD{constructor(t=[]){this.rules=t}static from(t){const n=[];for(const r of t)n.push(GC.from(r));return new rD(n)}add(t){const n=GC.from(t);this.rules.push(n)}translate(t){const n=[];for(const r of this.rules)for(const s of t){const i=r.translate(s);i&&n.push([s,i])}return n}translateOne(t){let n=null;for(const r of this.rules){const s=r.translate(t);s&&(n=s)}return n}localNamespaces(){return this.rules.filter(t=>t.matchPrefix).map(t=>t.localPath.replace(/\/$/,""))}}function iCe(e,t){const n=e.replace(/\^\{\}$/,""),r=t.replace(/\^\{\}$/,""),s=-(n<r)||+(n>r);return s===0?e.endsWith("^{}")?1:-1:s}const aCe=e=>{if(typeof e=="number")return e;e=e.toLowerCase();let t=parseInt(e);return e.endsWith("k")&&(t*=1024),e.endsWith("m")&&(t*=1024*1024),e.endsWith("g")&&(t*=1024*1024*1024),t},Rv=e=>{if(typeof e=="boolean")return e;if(e=e.trim().toLowerCase(),e==="true"||e==="yes"||e==="on")return!0;if(e==="false"||e==="no"||e==="off")return!1;throw Error(`Expected 'true', 'false', 'yes', 'no', 'on', or 'off', but got ${e}`)},az={core:{filemode:Rv,bare:Rv,logallrefupdates:Rv,symlinks:Rv,ignorecase:Rv,bigFileThreshold:aCe}},oCe=/^\[([A-Za-z0-9-.]+)(?: "(.*)")?\]$/,lCe=/^[A-Za-z0-9-.]+$/,cCe=/^([A-Za-z][A-Za-z-]*)(?: *= *(.*))?$/,uCe=/^[A-Za-z][A-Za-z-]*$/,dCe=/^(.*?)( *[#;].*)$/,fCe=e=>{const t=oCe.exec(e);if(t!=null){const[n,r]=t.slice(1);return[n,r]}return null},hCe=e=>{const t=cCe.exec(e);if(t!=null){const[n,r="true"]=t.slice(1),s=pCe(r),i=mCe(s);return[n,i]}return null},pCe=e=>{const t=dCe.exec(e);if(t==null)return e;const[n,r]=t.slice(1);return oz(n)&&oz(r)?`${n}${r}`:n},oz=e=>(e.match(/(?:^|[^\\])"/g)||[]).length%2!==0,mCe=e=>e.split("").reduce((t,n,r,s)=>{const i=n==='"'&&s[r-1]!=="\\",a=n==="\\"&&s[r+1]==='"';return i||a?t:t+n},""),lz=e=>e!=null?e.toLowerCase():null,Ej=(e,t,n)=>[lz(e),t,lz(n)].filter(r=>r!=null).join("."),cz=e=>{const t=e.split("."),n=t.shift(),r=t.pop(),s=t.length?t.join("."):void 0;return{section:n,subsection:s,name:r,path:Ej(n,s,r),sectionPath:Ej(n,s,null),isSection:!!n}},gCe=(e,t)=>e.reduce((n,r,s)=>t(r)?s:n,-1);class sD{constructor(t){let n=null,r=null;this.parsedConfig=t?t.split(`
`).map(s=>{let i=null,a=null;const o=s.trim(),l=fCe(o),c=l!=null;if(c)[n,r]=l;else{const d=hCe(o);d!=null&&([i,a]=d)}const u=Ej(n,r,i);return{line:s,isSection:c,section:n,subsection:r,name:i,value:a,path:u}}):[]}static from(t){return new sD(t)}async get(t,n=!1){const r=cz(t).path,s=this.parsedConfig.filter(i=>i.path===r).map(({section:i,name:a,value:o})=>{const l=az[i]&&az[i][a];return l?l(o):o});return n?s:s.pop()}async getall(t){return this.get(t,!0)}async getSubsections(t){return this.parsedConfig.filter(n=>n.isSection&&n.section===t).map(n=>n.subsection)}async deleteSection(t,n){this.parsedConfig=this.parsedConfig.filter(r=>!(r.section===t&&r.subsection===n))}async append(t,n){return this.set(t,n,!0)}async set(t,n,r=!1){const{section:s,subsection:i,name:a,path:o,sectionPath:l,isSection:c}=cz(t),u=gCe(this.parsedConfig,d=>d.path===o);if(n==null)u!==-1&&this.parsedConfig.splice(u,1);else if(u!==-1){const d=this.parsedConfig[u],h=Object.assign({},d,{name:a,value:n,modified:!0});r?this.parsedConfig.splice(u+1,0,h):this.parsedConfig[u]=h}else{const d=this.parsedConfig.findIndex(m=>m.path===l),h={section:s,subsection:i,name:a,value:n,modified:!0,path:o};if(lCe.test(s)&&uCe.test(a))if(d>=0)this.parsedConfig.splice(d+1,0,h);else{const m={isSection:c,section:s,subsection:i,modified:!0,path:l};this.parsedConfig.push(m,h)}}}toString(){return this.parsedConfig.map(({line:t,section:n,subsection:r,name:s,value:i,modified:a=!1})=>a?s!=null&&i!=null?typeof i=="string"&&/[#;]/.test(i)?`	${s} = "${i}"`:`	${s} = ${i}`:r!=null?`[${n} "${r}"]`:`[${n}]`:t).join(`
`)}}class Mi{static async get({fs:t,gitdir:n}){const r=await t.read(`${n}/config`,{encoding:"utf8"});return sD.from(r)}static async save({fs:t,gitdir:n,config:r}){await t.write(`${n}/config`,r.toString(),{encoding:"utf8"})}}const DS=e=>[`${e}`,`refs/${e}`,`refs/tags/${e}`,`refs/heads/${e}`,`refs/remotes/${e}`,`refs/remotes/${e}/HEAD`],yCe=["config","description","index","shallow","commondir"];let JM;async function Yf(e,t){return JM===void 0&&(JM=new aw),JM.acquire(e,t)}class Kt{static async updateRemoteRefs({fs:t,gitdir:n,remote:r,refs:s,symrefs:i,tags:a,refspecs:o=void 0,prune:l=!1,pruneTags:c=!1}){for(const v of s.values())if(!v.match(/[0-9a-f]{40}/))throw new Ch(v);const u=await Mi.get({fs:t,gitdir:n});if(!o){if(o=await u.getall(`remote.${r}.fetch`),o.length===0)throw new w1(r);o.unshift(`+HEAD:refs/remotes/${r}/HEAD`)}const d=rD.from(o),h=new Map;if(c){const v=await Kt.listRefs({fs:t,gitdir:n,filepath:"refs/tags"});await Kt.deleteRefs({fs:t,gitdir:n,refs:v.map(x=>`refs/tags/${x}`)})}if(a){for(const v of s.keys())if(v.startsWith("refs/tags")&&!v.endsWith("^{}")&&!await Kt.exists({fs:t,gitdir:n,ref:v})){const x=s.get(v);h.set(v,x)}}const m=d.translate([...s.keys()]);for(const[v,x]of m){const w=s.get(v);h.set(x,w)}const y=d.translate([...i.keys()]);for(const[v,x]of y){const w=i.get(v),S=d.translateOne(w);S&&h.set(x,`ref: ${S}`)}const b=[];if(l){for(const v of d.localNamespaces()){const x=(await Kt.listRefs({fs:t,gitdir:n,filepath:v})).map(w=>`${v}/${w}`);for(const w of x)h.has(w)||b.push(w)}b.length>0&&await Kt.deleteRefs({fs:t,gitdir:n,refs:b})}for(const[v,x]of h)await Yf(v,async()=>t.write($t.join(n,v),`${x.trim()}
`,"utf8"));return{pruned:b}}static async writeRef({fs:t,gitdir:n,ref:r,value:s}){if(!s.match(/[0-9a-f]{40}/))throw new Ch(s);await Yf(r,async()=>t.write($t.join(n,r),`${s.trim()}
`,"utf8"))}static async writeSymbolicRef({fs:t,gitdir:n,ref:r,value:s}){await Yf(r,async()=>t.write($t.join(n,r),`ref: ${s.trim()}
`,"utf8"))}static async deleteRef({fs:t,gitdir:n,ref:r}){return Kt.deleteRefs({fs:t,gitdir:n,refs:[r]})}static async deleteRefs({fs:t,gitdir:n,refs:r}){await Promise.all(r.map(o=>t.rm($t.join(n,o))));let s=await Yf("packed-refs",async()=>t.read(`${n}/packed-refs`,{encoding:"utf8"}));const i=HC.from(s),a=i.refs.size;for(const o of r)i.refs.has(o)&&i.delete(o);i.refs.size<a&&(s=i.toString(),await Yf("packed-refs",async()=>t.write(`${n}/packed-refs`,s,{encoding:"utf8"})))}static async resolve({fs:t,gitdir:n,ref:r,depth:s=void 0}){if(s!==void 0&&(s--,s===-1))return r;if(r.startsWith("ref: "))return r=r.slice(5),Kt.resolve({fs:t,gitdir:n,ref:r,depth:s});if(r.length===40&&/[0-9a-f]{40}/.test(r))return r;const i=await Kt.packedRefs({fs:t,gitdir:n}),a=DS(r).filter(o=>!yCe.includes(o));for(const o of a){const l=await Yf(o,async()=>await t.read(`${n}/${o}`,{encoding:"utf8"})||i.get(o));if(l)return Kt.resolve({fs:t,gitdir:n,ref:l.trim(),depth:s})}throw new Ts(r)}static async exists({fs:t,gitdir:n,ref:r}){try{return await Kt.expand({fs:t,gitdir:n,ref:r}),!0}catch{return!1}}static async expand({fs:t,gitdir:n,ref:r}){if(r.length===40&&/[0-9a-f]{40}/.test(r))return r;const s=await Kt.packedRefs({fs:t,gitdir:n}),i=DS(r);for(const a of i)if(await Yf(a,async()=>t.exists(`${n}/${a}`))||s.has(a))return a;throw new Ts(r)}static async expandAgainstMap({ref:t,map:n}){const r=DS(t);for(const s of r)if(await n.has(s))return s;throw new Ts(t)}static resolveAgainstMap({ref:t,fullref:n=t,depth:r=void 0,map:s}){if(r!==void 0&&(r--,r===-1))return{fullref:n,oid:t};if(t.startsWith("ref: "))return t=t.slice(5),Kt.resolveAgainstMap({ref:t,fullref:n,depth:r,map:s});if(t.length===40&&/[0-9a-f]{40}/.test(t))return{fullref:n,oid:t};const i=DS(t);for(const a of i){const o=s.get(a);if(o)return Kt.resolveAgainstMap({ref:o.trim(),fullref:a,depth:r,map:s})}throw new Ts(t)}static async packedRefs({fs:t,gitdir:n}){const r=await Yf("packed-refs",async()=>t.read(`${n}/packed-refs`,{encoding:"utf8"}));return HC.from(r).refs}static async listRefs({fs:t,gitdir:n,filepath:r}){const s=Kt.packedRefs({fs:t,gitdir:n});let i=null;try{i=await t.readdirDeep(`${n}/${r}`),i=i.map(a=>a.replace(`${n}/${r}/`,""))}catch{i=[]}for(let a of(await s).keys())a.startsWith(r)&&(a=a.replace(r+"/",""),i.includes(a)||i.push(a));return i.sort(iCe),i}static async listBranches({fs:t,gitdir:n,remote:r}){return r?Kt.listRefs({fs:t,gitdir:n,filepath:`refs/remotes/${r}`}):Kt.listRefs({fs:t,gitdir:n,filepath:"refs/heads"})}static async listTags({fs:t,gitdir:n}){return(await Kt.listRefs({fs:t,gitdir:n,filepath:"refs/tags"})).filter(s=>!s.endsWith("^{}"))}}function bCe(e,t){return XE(uz(e),uz(t))}function uz(e){return e.mode==="040000"?e.path+"/":e.path}function MY(e){switch(e){case"040000":return"tree";case"100644":return"blob";case"100755":return"blob";case"120000":return"blob";case"160000":return"commit"}throw new vr(`Unexpected GitTree entry mode: ${e}`)}function vCe(e){const t=[];let n=0;for(;n<e.length;){const r=e.indexOf(32,n);if(r===-1)throw new vr(`GitTree: Error parsing buffer at byte location ${n}: Could not find the next space character.`);const s=e.indexOf(0,n);if(s===-1)throw new vr(`GitTree: Error parsing buffer at byte location ${n}: Could not find the next null character.`);let i=e.slice(n,r).toString("utf8");i==="40000"&&(i="040000");const a=MY(i),o=e.slice(r+1,s).toString("utf8");if(o.includes("\\")||o.includes("/"))throw new Gy(o);const l=e.slice(s+1,s+21).toString("hex");n=s+21,t.push({mode:i,path:o,oid:l,type:a})}return t}function xCe(e){if(typeof e=="number"&&(e=e.toString(8)),e.match(/^0?4.*/))return"040000";if(e.match(/^1006.*/))return"100644";if(e.match(/^1007.*/))return"100755";if(e.match(/^120.*/))return"120000";if(e.match(/^160.*/))return"160000";throw new vr(`Could not understand file mode: ${e}`)}function wCe(e){return!e.oid&&e.sha&&(e.oid=e.sha),e.mode=xCe(e.mode),e.type||(e.type=MY(e.mode)),e}class Oo{constructor(t){if(ln.isBuffer(t))this._entries=vCe(t);else if(Array.isArray(t))this._entries=t.map(wCe);else throw new vr("invalid type passed to GitTree constructor");this._entries.sort(TY)}static from(t){return new Oo(t)}render(){return this._entries.map(t=>`${t.mode} ${t.type} ${t.oid}    ${t.path}`).join(`
`)}toObject(){const t=[...this._entries];return t.sort(bCe),ln.concat(t.map(n=>{const r=ln.from(n.mode.replace(/^0/,"")),s=ln.from(" "),i=ln.from(n.path,"utf8"),a=ln.from([0]),o=ln.from(n.oid,"hex");return ln.concat([r,s,i,a,o])}))}entries(){return this._entries}*[Symbol.iterator](){for(const t of this._entries)yield t}}class Yy{static wrap({type:t,object:n}){return ln.concat([ln.from(`${t} ${n.byteLength.toString()}\0`),ln.from(n)])}static unwrap(t){const n=t.indexOf(32),r=t.indexOf(0),s=t.slice(0,n).toString("utf8"),i=t.slice(n+1,r).toString("utf8"),a=t.length-(r+1);if(parseInt(i)!==a)throw new vr(`Length mismatch: expected ${i} bytes but got ${a} instead.`);return{type:s,object:ln.from(t.slice(r+1))}}}async function IY({fs:e,gitdir:t,oid:n}){const r=`objects/${n.slice(0,2)}/${n.slice(2)}`,s=await e.read(`${t}/${r}`);return s?{object:s,format:"deflated",source:r}:null}function _Ce(e,t){const n=new hu(e),r=dz(n);if(r!==t.byteLength)throw new vr(`applyDelta expected source buffer to be ${r} bytes but the provided buffer was ${t.length} bytes`);const s=dz(n);let i;const a=hz(n,t);if(a.byteLength===s)i=a;else{i=ln.alloc(s);const o=new hu(i);for(o.copy(a);!n.eof();)o.copy(hz(n,t));const l=o.tell();if(s!==l)throw new vr(`applyDelta expected target buffer to be ${s} bytes but the resulting buffer was ${l} bytes`)}return i}function dz(e){let t=0,n=0,r=null;do r=e.readUInt8(),t|=(r&127)<<n,n+=7;while(r&128);return t}function fz(e,t,n){let r=0,s=0;for(;n--;)t&1&&(r|=e.readUInt8()<<s),t>>=1,s+=8;return r}function hz(e,t){const n=e.readUInt8(),r=128,s=15,i=112;if(n&r){const a=fz(e,n&s,4);let o=fz(e,(n&i)>>4,3);return o===0&&(o=65536),t.slice(a,a+o)}else return e.slice(n)}function SCe(e){let t=[e];return{next(){return Promise.resolve({done:t.length===0,value:t.pop()})},return(){return t=[],{}},[Symbol.asyncIterator](){return this}}}function jY(e){return e[Symbol.asyncIterator]?e[Symbol.asyncIterator]():e[Symbol.iterator]?e[Symbol.iterator]():e.next?e:SCe(e)}class PY{constructor(t){if(typeof ln>"u")throw new Error("Missing Buffer dependency");this.stream=jY(t),this.buffer=null,this.cursor=0,this.undoCursor=0,this.started=!1,this._ended=!1,this._discardedBytes=0}eof(){return this._ended&&this.cursor===this.buffer.length}tell(){return this._discardedBytes+this.cursor}async byte(){if(!this.eof()&&(this.started||await this._init(),!(this.cursor===this.buffer.length&&(await this._loadnext(),this._ended))))return this._moveCursor(1),this.buffer[this.undoCursor]}async chunk(){if(!this.eof()&&(this.started||await this._init(),!(this.cursor===this.buffer.length&&(await this._loadnext(),this._ended))))return this._moveCursor(this.buffer.length),this.buffer.slice(this.undoCursor,this.cursor)}async read(t){if(!this.eof())return this.started||await this._init(),this.cursor+t>this.buffer.length&&(this._trim(),await this._accumulate(t)),this._moveCursor(t),this.buffer.slice(this.undoCursor,this.cursor)}async skip(t){this.eof()||(this.started||await this._init(),this.cursor+t>this.buffer.length&&(this._trim(),await this._accumulate(t)),this._moveCursor(t))}async undo(){this.cursor=this.undoCursor}async _next(){this.started=!0;let{done:t,value:n}=await this.stream.next();return t&&(this._ended=!0,!n)?ln.alloc(0):(n&&(n=ln.from(n)),n)}_trim(){this.buffer=this.buffer.slice(this.undoCursor),this.cursor-=this.undoCursor,this._discardedBytes+=this.undoCursor,this.undoCursor=0}_moveCursor(t){this.undoCursor=this.cursor,this.cursor+=t,this.cursor>this.buffer.length&&(this.cursor=this.buffer.length)}async _accumulate(t){if(this._ended)return;const n=[this.buffer];for(;this.cursor+t>CCe(n);){const r=await this._next();if(this._ended)break;n.push(r)}this.buffer=ln.concat(n)}async _loadnext(){this._discardedBytes+=this.buffer.length,this.undoCursor=0,this.cursor=0,this.buffer=await this._next()}async _init(){this.buffer=await this._next()}}function CCe(e){return e.reduce((t,n)=>t+n.length,0)}async function kCe(e,t){const n=new PY(e);let r=await n.read(4);if(r=r.toString("utf8"),r!=="PACK")throw new vr(`Invalid PACK header '${r}'`);let s=await n.read(4);if(s=s.readUInt32BE(0),s!==2)throw new vr(`Invalid packfile version: ${s}`);let i=await n.read(4);if(i=i.readUInt32BE(0),!(i<1))for(;!n.eof()&&i--;){const a=n.tell(),{type:o,length:l,ofs:c,reference:u}=await ECe(n),d=new nD.Inflate;for(;!d.result;){const h=await n.chunk();if(!h)break;if(d.push(h,!1),d.err)throw new vr(`Pako error: ${d.msg}`);if(d.result){if(d.result.length!==l)throw new vr("Inflated object size is different from that stated in packfile.");await n.undo(),await n.read(h.length-d.strm.avail_in);const m=n.tell();await t({data:d.result,type:o,num:i,offset:a,end:m,reference:u,ofs:c})}}}}async function ECe(e){let t=await e.byte();const n=t>>4&7;let r=t&15;if(t&128){let a=4;do t=await e.byte(),r|=(t&127)<<a,a+=7;while(t&128)}let s,i;if(n===6){let a=0;s=0;const o=[];do t=await e.byte(),s|=(t&127)<<a,a+=7,o.push(t);while(t&128);i=ln.from(o)}return n===7&&(i=await e.read(20)),{type:n,length:r,ofs:s,reference:i}}async function OY(e){return nD.inflate(e)}function TCe(e){const t=[];let n=0,r=0;do{n=e.readUInt8();const s=n&127;t.push(s),r=n&128}while(r);return t.reduce((s,i)=>s+1<<7|i,-1)}function ACe(e,t){let n=t,r=4,s=null;do s=e.readUInt8(),n|=(s&127)<<r,r+=7;while(s&128);return n}class ay{constructor(t){Object.assign(this,t),this.offsetCache={}}static async fromIdx({idx:t,getExternalRefDelta:n}){const r=new hu(t);if(r.slice(4).toString("hex")!=="ff744f63")return;const i=r.readUInt32BE();if(i!==2)throw new vr(`Unable to read version ${i} packfile IDX. (Only version 2 supported)`);if(t.byteLength>2048*1024*1024)throw new vr("To keep implementation simple, I haven't implemented the layer 5 feature needed to support packfiles > 2GB in size.");r.seek(r.tell()+4*255);const a=r.readUInt32BE(),o=[];for(let u=0;u<a;u++){const d=r.slice(20).toString("hex");o[u]=d}r.seek(r.tell()+4*a);const l=new Map;for(let u=0;u<a;u++)l.set(o[u],r.readUInt32BE());const c=r.slice(20).toString("hex");return new ay({hashes:o,crcs:{},offsets:l,packfileSha:c,getExternalRefDelta:n})}static async fromPack({pack:t,getExternalRefDelta:n,onProgress:r}){const s={1:"commit",2:"tree",3:"blob",4:"tag",6:"ofs-delta",7:"ref-delta"},i={},a=t.slice(-20).toString("hex"),o=[],l={},c=new Map;let u=null,d=null;await kCe([t],async({data:v,type:x,reference:w,offset:S,num:C})=>{u===null&&(u=C);const k=Math.floor((u-C)*100/u);k!==d&&r&&await r({phase:"Receiving objects",loaded:u-C,total:u}),d=k,x=s[x],["commit","tree","blob","tag"].includes(x)?i[S]={type:x,offset:S}:x==="ofs-delta"?i[S]={type:x,offset:S}:x==="ref-delta"&&(i[S]={type:x,offset:S})});const h=Object.keys(i).map(Number);for(const[v,x]of h.entries()){const w=v+1===h.length?t.byteLength-20:h[v+1],S=i[x],C=T2e.buf(t.slice(x,w))>>>0;S.end=w,S.crc=C}const m=new ay({pack:Promise.resolve(t),packfileSha:a,crcs:l,hashes:o,offsets:c,getExternalRefDelta:n});d=null;let y=0;const b=[0,0,0,0,0,0,0,0,0,0,0,0];for(let v in i){v=Number(v);const x=Math.floor(y*100/u);x!==d&&r&&await r({phase:"Resolving deltas",loaded:y,total:u}),y++,d=x;const w=i[v];if(!w.oid)try{m.readDepth=0,m.externalReadDepth=0;const{type:S,object:C}=await m.readSlice({start:v});b[m.readDepth]+=1;const k=await Hd(Yy.wrap({type:S,object:C}));w.oid=k,o.push(k),c.set(k,v),l[k]=w.crc}catch{continue}}return o.sort(),m}async toBuffer(){const t=[],n=(c,u)=>{t.push(ln.from(c,u))};n("ff744f63","hex"),n("00000002","hex");const r=new hu(ln.alloc(256*4));for(let c=0;c<256;c++){let u=0;for(const d of this.hashes)parseInt(d.slice(0,2),16)<=c&&u++;r.writeUInt32BE(u)}t.push(r.buffer);for(const c of this.hashes)n(c,"hex");const s=new hu(ln.alloc(this.hashes.length*4));for(const c of this.hashes)s.writeUInt32BE(this.crcs[c]);t.push(s.buffer);const i=new hu(ln.alloc(this.hashes.length*4));for(const c of this.hashes)i.writeUInt32BE(this.offsets.get(c));t.push(i.buffer),n(this.packfileSha,"hex");const a=ln.concat(t),o=await Hd(a),l=ln.alloc(20);return l.write(o,"hex"),ln.concat([a,l])}async load({pack:t}){this.pack=t}async unload(){this.pack=null}async read({oid:t}){if(!this.offsets.get(t)){if(this.getExternalRefDelta)return this.externalReadDepth++,this.getExternalRefDelta(t);throw new vr(`Could not read object ${t} from packfile`)}const n=this.offsets.get(t);return this.readSlice({start:n})}async readSlice({start:t}){if(this.offsetCache[t])return Object.assign({},this.offsetCache[t]);this.readDepth++;const n={16:"commit",32:"tree",48:"blob",64:"tag",96:"ofs_delta",112:"ref_delta"};if(!this.pack)throw new vr("Tried to read from a GitPackIndex with no packfile loaded into memory");const r=(await this.pack).slice(t),s=new hu(r),i=s.readUInt8(),a=i&112;let o=n[a];if(o===void 0)throw new vr("Unrecognized type: 0b"+a.toString(2));const l=i&15;let c=l;i&128&&(c=ACe(s,l));let d=null,h=null;if(o==="ofs_delta"){const y=TCe(s),b=t-y;({object:d,type:o}=await this.readSlice({start:b}))}if(o==="ref_delta"){const y=s.slice(20).toString("hex");({object:d,type:o}=await this.read({oid:y}))}const m=r.slice(s.tell());if(h=ln.from(await OY(m)),h.byteLength!==c)throw new vr(`Packfile told us object would have length ${c} but it had length ${h.byteLength}`);return d&&(h=ln.from(_Ce(h,d))),this.readDepth>3&&(this.offsetCache[t]={type:o,object:h}),{type:o,format:"content",object:h}}}const FS=Symbol("PackfileCache");async function RCe({fs:e,filename:t,getExternalRefDelta:n,emitter:r,emitterPrefix:s}){const i=await e.read(t);return ay.fromIdx({idx:i,getExternalRefDelta:n})}function iD({fs:e,cache:t,filename:n,getExternalRefDelta:r,emitter:s,emitterPrefix:i}){t[FS]||(t[FS]=new Map);let a=t[FS].get(n);return a||(a=RCe({fs:e,filename:n,getExternalRefDelta:r,emitter:s,emitterPrefix:i}),t[FS].set(n,a)),a}async function NCe({fs:e,cache:t,gitdir:n,oid:r,format:s="content",getExternalRefDelta:i}){let a=await e.readdir($t.join(n,"objects/pack"));a=a.filter(o=>o.endsWith(".idx"));for(const o of a){const l=`${n}/objects/pack/${o}`,c=await iD({fs:e,cache:t,filename:l,getExternalRefDelta:i});if(c.error)throw new vr(c.error);if(c.offsets.has(r)){if(!c.pack){const d=l.replace(/idx$/,"pack");c.pack=e.read(d)}const u=await c.read({oid:r,getExternalRefDelta:i});return u.format="content",u.source=`objects/pack/${o.replace(/idx$/,"pack")}`,u}}return null}async function Ys({fs:e,cache:t,gitdir:n,oid:r,format:s="content"}){const i=u=>Ys({fs:e,cache:t,gitdir:n,oid:u});let a;if(r==="4b825dc642cb6eb9a060e54bf8d69288fbee4904"&&(a={format:"wrapped",object:ln.from("tree 0\0")}),a||(a=await IY({fs:e,gitdir:n,oid:r})),!a){if(a=await NCe({fs:e,cache:t,gitdir:n,oid:r,getExternalRefDelta:i}),!a)throw new Ts(r);return a}if(s==="deflated"||(a.format==="deflated"&&(a.object=ln.from(await OY(a.object)),a.format="wrapped"),s==="wrapped"))return a;const o=await Hd(a.object);if(o!==r)throw new vr(`SHA check failed! Expected ${r}, computed ${o}`);const{object:l,type:c}=Yy.unwrap(a.object);if(a.type=c,a.object=l,a.format="content",s==="content")return a;throw new vr(`invalid requested format "${s}"`)}class Bc extends Jr{constructor(t,n,r=!0){super(`Failed to create ${t} at ${n} because it already exists.${r?` (Hint: use 'force: true' parameter to overwrite existing ${t}.)`:""}`),this.code=this.name=Bc.code,this.data={noun:t,where:n,canForce:r}}}Bc.code="AlreadyExistsError";class _1 extends Jr{constructor(t,n,r){super(`Found multiple ${t} matching "${n}" (${r.join(", ")}). Use a longer abbreviation length to disambiguate them.`),this.code=this.name=_1.code,this.data={nouns:t,short:n,matches:r}}}_1.code="AmbiguousError";class S1 extends Jr{constructor(t){super(`Your local changes to the following files would be overwritten by checkout: ${t.join(", ")}`),this.code=this.name=S1.code,this.data={filepaths:t}}}S1.code="CheckoutConflictError";class C1 extends Jr{constructor(t,n){super(`Failed to checkout "${t}" because commit ${n} is not available locally. Do a git fetch to make the branch available locally.`),this.code=this.name=C1.code,this.data={ref:t,oid:n}}}C1.code="CommitNotFetchedError";class k1 extends Jr{constructor(){super("Empty response from git server."),this.code=this.name=k1.code,this.data={}}}k1.code="EmptyServerResponseError";class E1 extends Jr{constructor(){super("A simple fast-forward merge was not possible."),this.code=this.name=E1.code,this.data={}}}E1.code="FastForwardError";class T1 extends Jr{constructor(t,n){super(`One or more branches were not updated: ${t}`),this.code=this.name=T1.code,this.data={prettyDetails:t,result:n}}}T1.code="GitPushError";class oy extends Jr{constructor(t,n,r){super(`HTTP Error: ${t} ${n}`),this.code=this.name=oy.code,this.data={statusCode:t,statusMessage:n,response:r}}}oy.code="HttpError";class kh extends Jr{constructor(t){let n="invalid filepath";t==="leading-slash"||t==="trailing-slash"?n='"filepath" parameter should not include leading or trailing directory separators because these can cause problems on some platforms.':t==="directory"&&(n='"filepath" should not be a directory.'),super(n),this.code=this.name=kh.code,this.data={reason:t}}}kh.code="InvalidFilepathError";class Dc extends Jr{constructor(t,n){super(`"${t}" would be an invalid git reference. (Hint: a valid alternative would be "${n}".)`),this.code=this.name=Dc.code,this.data={ref:t,suggestion:n}}}Dc.code="InvalidRefNameError";class A1 extends Jr{constructor(t){super(`Maximum search depth of ${t} exceeded.`),this.code=this.name=A1.code,this.data={depth:t}}}A1.code="MaxDepthError";class Zy extends Jr{constructor(){super("Merges with conflicts are not supported yet."),this.code=this.name=Zy.code,this.data={}}}Zy.code="MergeNotSupportedError";class Xy extends Jr{constructor(t,n,r,s){super(`Automatic merge failed with one or more merge conflicts in the following files: ${t.toString()}. Fix conflicts then commit the result.`),this.code=this.name=Xy.code,this.data={filepaths:t,bothModified:n,deleteByUs:r,deleteByTheirs:s}}}Xy.code="MergeConflictError";class Ba extends Jr{constructor(t){super(`No name was provided for ${t} in the argument or in the .git/config file.`),this.code=this.name=Ba.code,this.data={role:t}}}Ba.code="MissingNameError";class No extends Jr{constructor(t){super(`The function requires a "${t}" parameter but none was provided.`),this.code=this.name=No.code,this.data={parameter:t}}}No.code="MissingParameterError";class R1 extends Jr{constructor(t){super('There are multiple errors that were thrown by the method. Please refer to the "errors" property to see more'),this.code=this.name=R1.code,this.data={errors:t},this.errors=t}}R1.code="MultipleGitError";class Zm extends Jr{constructor(t,n){super(`Expected "${t}" but received "${n}".`),this.code=this.name=Zm.code,this.data={expected:t,actual:n}}}Zm.code="ParseError";class ly extends Jr{constructor(t){let n="";t==="not-fast-forward"?n=" because it was not a simple fast-forward":t==="tag-exists"&&(n=" because tag already exists"),super(`Push rejected${n}. Use "force: true" to override.`),this.code=this.name=ly.code,this.data={reason:t}}}ly.code="PushRejectedError";class lh extends Jr{constructor(t,n){super(`Remote does not support the "${t}" so the "${n}" parameter cannot be used.`),this.code=this.name=lh.code,this.data={capability:t,parameter:n}}}lh.code="RemoteCapabilityError";class N1 extends Jr{constructor(t,n){super(`Remote did not reply using the "smart" HTTP protocol. Expected "001e# service=git-upload-pack" but received: ${t}`),this.code=this.name=N1.code,this.data={preview:t,response:n}}}N1.code="SmartHttpError";class M1 extends Jr{constructor(t,n,r){super(`Git remote "${t}" uses an unrecognized transport protocol: "${n}"`),this.code=this.name=M1.code,this.data={url:t,transport:n,suggestion:r}}}M1.code="UnknownTransportError";class I1 extends Jr{constructor(t){super(`Cannot parse remote URL: "${t}"`),this.code=this.name=I1.code,this.data={url:t}}}I1.code="UrlParseError";class Jy extends Jr{constructor(){super("The operation was canceled."),this.code=this.name=Jy.code,this.data={}}}Jy.code="UserCanceledError";class j1 extends Jr{constructor(t){super(`Could not merge index: Entry for '${t}' is not up to date. Either reset the index entry to HEAD, or stage your unstaged changes.`),this.code=this.name=j1.code,this.data={filepath:t}}}j1.code="IndexResetError";class P1 extends Jr{constructor(t){super(`"${t}" does not point to any commit. You're maybe working on a repository with no commits yet. `),this.code=this.name=P1.code,this.data={ref:t}}}P1.code="NoCommitError";var MCe=Object.freeze({__proto__:null,AlreadyExistsError:Bc,AmbiguousError:_1,CheckoutConflictError:S1,CommitNotFetchedError:C1,EmptyServerResponseError:k1,FastForwardError:E1,GitPushError:T1,HttpError:oy,InternalError:vr,InvalidFilepathError:kh,InvalidOidError:Ch,InvalidRefNameError:Dc,MaxDepthError:A1,MergeNotSupportedError:Zy,MergeConflictError:Xy,MissingNameError:Ba,MissingParameterError:No,MultipleGitError:R1,NoRefspecError:w1,NotFoundError:Ts,ObjectTypeError:uo,ParseError:Zm,PushRejectedError:ly,RemoteCapabilityError:lh,SmartHttpError:N1,UnknownTransportError:M1,UnsafeFilepathError:Gy,UrlParseError:I1,UserCanceledError:Jy,UnmergedPathsError:x1,IndexResetError:j1,NoCommitError:P1});function Tj({name:e,email:t,timestamp:n,timezoneOffset:r}){return r=ICe(r),`${e} <${t}> ${n} ${r}`}function ICe(e){const t=jCe(PCe(e));e=Math.abs(e);const n=Math.floor(e/60);e-=n*60;let r=String(n),s=String(e);return r.length<2&&(r="0"+r),s.length<2&&(s="0"+s),(t===-1?"-":"+")+r+s}function jCe(e){return Math.sign(e)||(Object.is(e,-0)?-1:1)}function PCe(e){return e===0?e:-e}function Cd(e){return e=e.replace(/\r/g,""),e=e.replace(/^\n+/,""),e=e.replace(/\n+$/,"")+`
`,e}function KC(e){const[,t,n,r,s]=e.match(/^(.*) <(.*)> (.*) (.*)$/);return{name:t,email:n,timestamp:Number(r),timezoneOffset:OCe(s)}}function OCe(e){let[,t,n,r]=e.match(/(\+|-)(\d\d)(\d\d)/);return r=(t==="+"?1:-1)*(Number(n)*60+Number(r)),DCe(r)}function DCe(e){return e===0?e:-e}class no{constructor(t){if(typeof t=="string")this._tag=t;else if(ln.isBuffer(t))this._tag=t.toString("utf8");else if(typeof t=="object")this._tag=no.render(t);else throw new vr("invalid type passed to GitAnnotatedTag constructor")}static from(t){return new no(t)}static render(t){return`object ${t.object}
type ${t.type}
tag ${t.tag}
tagger ${Tj(t.tagger)}

${t.message}
${t.gpgsig?t.gpgsig:""}`}justHeaders(){return this._tag.slice(0,this._tag.indexOf(`

`))}message(){const t=this.withoutSignature();return t.slice(t.indexOf(`

`)+2)}parse(){return Object.assign(this.headers(),{message:this.message(),gpgsig:this.gpgsig()})}render(){return this._tag}headers(){const t=this.justHeaders().split(`
`),n=[];for(const s of t)s[0]===" "?n[n.length-1]+=`
`+s.slice(1):n.push(s);const r={};for(const s of n){const i=s.slice(0,s.indexOf(" ")),a=s.slice(s.indexOf(" ")+1);Array.isArray(r[i])?r[i].push(a):r[i]=a}return r.tagger&&(r.tagger=KC(r.tagger)),r.committer&&(r.committer=KC(r.committer)),r}withoutSignature(){const t=Cd(this._tag);return t.indexOf(`
-----BEGIN PGP SIGNATURE-----`)===-1?t:t.slice(0,t.lastIndexOf(`
-----BEGIN PGP SIGNATURE-----`))}gpgsig(){if(this._tag.indexOf(`
-----BEGIN PGP SIGNATURE-----`)===-1)return;const t=this._tag.slice(this._tag.indexOf("-----BEGIN PGP SIGNATURE-----"),this._tag.indexOf("-----END PGP SIGNATURE-----")+27);return Cd(t)}payload(){return this.withoutSignature()+`
`}toObject(){return ln.from(this._tag,"utf8")}static async sign(t,n,r){const s=t.payload();let{signature:i}=await n({payload:s,secretKey:r});i=Cd(i);const a=s+i;return no.from(a)}}function QM(e){return e.trim().split(`
`).map(t=>" "+t).join(`
`)+`
`}function FCe(e){return e.split(`
`).map(t=>t.replace(/^ /,"")).join(`
`)}class Ks{constructor(t){if(typeof t=="string")this._commit=t;else if(ln.isBuffer(t))this._commit=t.toString("utf8");else if(typeof t=="object")this._commit=Ks.render(t);else throw new vr("invalid type passed to GitCommit constructor")}static fromPayloadSignature({payload:t,signature:n}){const r=Ks.justHeaders(t),s=Ks.justMessage(t),i=Cd(r+`
gpgsig`+QM(n)+`
`+s);return new Ks(i)}static from(t){return new Ks(t)}toObject(){return ln.from(this._commit,"utf8")}headers(){return this.parseHeaders()}message(){return Ks.justMessage(this._commit)}parse(){return Object.assign({message:this.message()},this.headers())}static justMessage(t){return Cd(t.slice(t.indexOf(`

`)+2))}static justHeaders(t){return t.slice(0,t.indexOf(`

`))}parseHeaders(){const t=Ks.justHeaders(this._commit).split(`
`),n=[];for(const s of t)s[0]===" "?n[n.length-1]+=`
`+s.slice(1):n.push(s);const r={parent:[]};for(const s of n){const i=s.slice(0,s.indexOf(" ")),a=s.slice(s.indexOf(" ")+1);Array.isArray(r[i])?r[i].push(a):r[i]=a}return r.author&&(r.author=KC(r.author)),r.committer&&(r.committer=KC(r.committer)),r}static renderHeaders(t){let n="";if(t.tree?n+=`tree ${t.tree}
`:n+=`tree 4b825dc642cb6eb9a060e54bf8d69288fbee4904
`,t.parent){if(t.parent.length===void 0)throw new vr("commit 'parent' property should be an array");for(const i of t.parent)n+=`parent ${i}
`}const r=t.author;n+=`author ${Tj(r)}
`;const s=t.committer||t.author;return n+=`committer ${Tj(s)}
`,t.gpgsig&&(n+="gpgsig"+QM(t.gpgsig)),n}static render(t){return Ks.renderHeaders(t)+`
`+Cd(t.message)}render(){return this._commit}withoutSignature(){const t=Cd(this._commit);if(t.indexOf(`
gpgsig`)===-1)return t;const n=t.slice(0,t.indexOf(`
gpgsig`)),r=t.slice(t.indexOf(`-----END PGP SIGNATURE-----
`)+28);return Cd(n+`
`+r)}isolateSignature(){const t=this._commit.slice(this._commit.indexOf("-----BEGIN PGP SIGNATURE-----"),this._commit.indexOf("-----END PGP SIGNATURE-----")+27);return FCe(t)}static async sign(t,n,r){const s=t.withoutSignature(),i=Ks.justMessage(t._commit);let{signature:a}=await n({payload:s,secretKey:r});a=Cd(a);const l=Ks.justHeaders(t._commit)+`
gpgsig`+QM(a)+`
`+i;return Ks.from(l)}}async function cy({fs:e,cache:t,gitdir:n,oid:r}){if(r==="4b825dc642cb6eb9a060e54bf8d69288fbee4904")return{tree:Oo.from([]),oid:r};const{type:s,object:i}=await Ys({fs:e,cache:t,gitdir:n,oid:r});if(s==="tag")return r=no.from(i).parse().object,cy({fs:e,cache:t,gitdir:n,oid:r});if(s==="commit")return r=Ks.from(i).parse().tree,cy({fs:e,cache:t,gitdir:n,oid:r});if(s!=="tree")throw new uo(r,s,"tree");return{tree:Oo.from(i),oid:r}}class LCe{constructor({fs:t,gitdir:n,ref:r,cache:s}){this.fs=t,this.cache=s,this.gitdir=n,this.mapPromise=(async()=>{const a=new Map;let o;try{o=await Kt.resolve({fs:t,gitdir:n,ref:r})}catch(c){c instanceof Ts&&(o="4b825dc642cb6eb9a060e54bf8d69288fbee4904")}const l=await cy({fs:t,cache:this.cache,gitdir:n,oid:o});return l.type="tree",l.mode="40000",a.set(".",l),a})();const i=this;this.ConstructEntry=class{constructor(o){this._fullpath=o,this._type=!1,this._mode=!1,this._stat=!1,this._content=!1,this._oid=!1}async type(){return i.type(this)}async mode(){return i.mode(this)}async stat(){return i.stat(this)}async content(){return i.content(this)}async oid(){return i.oid(this)}}}async readdir(t){const n=t._fullpath,{fs:r,cache:s,gitdir:i}=this,a=await this.mapPromise,o=a.get(n);if(!o)throw new Error(`No obj for ${n}`);const l=o.oid;if(!l)throw new Error(`No oid for obj ${JSON.stringify(o)}`);if(o.type!=="tree")return null;const{type:c,object:u}=await Ys({fs:r,cache:s,gitdir:i,oid:l});if(c!==o.type)throw new uo(l,c,o.type);const d=Oo.from(u);for(const h of d)a.set($t.join(n,h.path),h);return d.entries().map(h=>$t.join(n,h.path))}async type(t){if(t._type===!1){const n=await this.mapPromise,{type:r}=n.get(t._fullpath);t._type=r}return t._type}async mode(t){if(t._mode===!1){const n=await this.mapPromise,{mode:r}=n.get(t._fullpath);t._mode=AY(parseInt(r,8))}return t._mode}async stat(t){}async content(t){if(t._content===!1){const n=await this.mapPromise,{fs:r,cache:s,gitdir:i}=this,o=n.get(t._fullpath).oid,{type:l,object:c}=await Ys({fs:r,cache:s,gitdir:i,oid:o});l!=="blob"?t._content=void 0:t._content=new Uint8Array(c)}return t._content}async oid(t){if(t._oid===!1){const r=(await this.mapPromise).get(t._fullpath);t._oid=r.oid}return t._oid}}function Hl({ref:e="HEAD"}={}){const t=Object.create(null);return Object.defineProperty(t,JE,{value:function({fs:n,gitdir:r,cache:s}){return new LCe({fs:n,gitdir:r,ref:e,cache:s})}}),Object.freeze(t),t}class BCe{constructor({fs:t,dir:n,gitdir:r,cache:s}){this.fs=t,this.cache=s,this.dir=n,this.gitdir=r,this.config=null;const i=this;this.ConstructEntry=class{constructor(o){this._fullpath=o,this._type=!1,this._mode=!1,this._stat=!1,this._content=!1,this._oid=!1}async type(){return i.type(this)}async mode(){return i.mode(this)}async stat(){return i.stat(this)}async content(){return i.content(this)}async oid(){return i.oid(this)}}}async readdir(t){const n=t._fullpath,{fs:r,dir:s}=this,i=await r.readdir($t.join(s,n));return i===null?null:i.map(a=>$t.join(n,a))}async type(t){return t._type===!1&&await t.stat(),t._type}async mode(t){return t._mode===!1&&await t.stat(),t._mode}async stat(t){if(t._stat===!1){const{fs:n,dir:r}=this;let s=await n.lstat(`${r}/${t._fullpath}`);if(!s)throw new Error(`ENOENT: no such file or directory, lstat '${t._fullpath}'`);let i=s.isDirectory()?"tree":"blob";i==="blob"&&!s.isFile()&&!s.isSymbolicLink()&&(i="special"),t._type=i,s=sy(s),t._mode=s.mode,s.size===-1&&t._actualSize&&(s.size=t._actualSize),t._stat=s}return t._stat}async content(t){if(t._content===!1){const{fs:n,dir:r,gitdir:s}=this;if(await t.type()==="tree")t._content=void 0;else{const a=await(await this._getGitConfig(n,s)).get("core.autocrlf"),o=await n.read(`${r}/${t._fullpath}`,{autocrlf:a});t._actualSize=o.length,t._stat&&t._stat.size===-1&&(t._stat.size=t._actualSize),t._content=new Uint8Array(o)}}return t._content}async oid(t){if(t._oid===!1){const n=this,{fs:r,gitdir:s,cache:i}=this;let a;await oa.acquire({fs:r,gitdir:s,cache:i},async function(o){const l=o.entriesMap.get(t._fullpath),c=await t.stat(),d=await(await n._getGitConfig(r,s)).get("core.filemode"),h=typeof Ai<"u"?Ai.platform!=="win32":!0;if(!l||VC(c,l,d,h)){const m=await t.content();m===void 0?a=void 0:(a=await Hd(Yy.wrap({type:"blob",object:m})),l&&a===l.oid&&(!d||c.mode===l.mode)&&VC(c,l,d,h)&&o.insert({filepath:t._fullpath,stats:c,oid:a}))}else a=l.oid}),t._oid=a}return t._oid}async _getGitConfig(t,n){return this.config?this.config:(this.config=await Mi.get({fs:t,gitdir:n}),this.config)}}function O1(){const e=Object.create(null);return Object.defineProperty(e,JE,{value:function({fs:t,dir:n,gitdir:r,cache:s}){return new BCe({fs:t,dir:n,gitdir:r,cache:s})}}),Object.freeze(e),e}function $Ce(e,t){const n=t-e;return Array.from({length:n},(r,s)=>e+s)}const DY=typeof Array.prototype.flat>"u"?e=>e.reduce((t,n)=>t.concat(n),[]):e=>e.flat();class zCe{constructor(){this.value=null}consider(t){t!=null&&(this.value===null?this.value=t:t<this.value&&(this.value=t))}reset(){this.value=null}}function*UCe(e){const t=new zCe;let n;const r=[],s=e.length;for(let i=0;i<s;i++)r[i]=e[i].next().value,r[i]!==void 0&&t.consider(r[i]);if(t.value!==null)for(;;){const i=[];n=t.value,t.reset();for(let a=0;a<s;a++)r[a]!==void 0&&r[a]===n?(i[a]=r[a],r[a]=e[a].next().value):i[a]=null,r[a]!==void 0&&t.consider(r[a]);if(yield i,t.value===null)return}}async function Eh({fs:e,cache:t,dir:n,gitdir:r,trees:s,map:i=async(l,c)=>c,reduce:a=async(l,c)=>{const u=DY(c);return l!==void 0&&u.unshift(l),u},iterate:o=(l,c)=>Promise.all([...c].map(l))}){const l=s.map(m=>m[JE]({fs:e,dir:n,gitdir:r,cache:t})),c=new Array(l.length).fill("."),u=$Ce(0,l.length),d=async m=>{u.map(v=>{const x=m[v];m[v]=x&&new l[v].ConstructEntry(x)});const b=(await Promise.all(u.map(v=>{const x=m[v];return x?l[v].readdir(x):[]}))).map(v=>(v===null?[]:v)[Symbol.iterator]());return{entries:m,children:UCe(b)}},h=async m=>{const{entries:y,children:b}=await d(m),v=y.find(w=>w&&w._fullpath)._fullpath,x=await i(v,y);if(x!==null){let w=await o(h,b);return w=w.filter(S=>S!==void 0),a(x,w)}};return h(c)}async function Aj(e,t){const n=await e.readdir(t);n==null?await e.rm(t):n.length?await Promise.all(n.map(r=>{const s=$t.join(t,r);return e.lstat(s).then(i=>{if(i)return i.isDirectory()?Aj(e,s):e.rm(s)})})).then(()=>e.rmdir(t)):await e.rmdir(t)}function qCe(e){return VCe(e)&&pz(e.then)&&pz(e.catch)}function VCe(e){return e&&typeof e=="object"}function pz(e){return typeof e=="function"}function mz(e){return qCe((n=>{try{return n.readFile().catch(r=>r)}catch(r){return r}})(e))}const gz=["readFile","writeFile","mkdir","rmdir","unlink","stat","lstat","readdir","readlink","symlink"];function yz(e,t){if(mz(t))for(const n of gz)e[`_${n}`]=t[n].bind(t);else for(const n of gz)e[`_${n}`]=VM(t[n].bind(t));mz(t)?t.rm?e._rm=t.rm.bind(t):t.rmdir.length>1?e._rm=t.rmdir.bind(t):e._rm=Aj.bind(null,e):t.rm?e._rm=VM(t.rm.bind(t)):t.rmdir.length>2?e._rm=VM(t.rmdir.bind(t)):e._rm=Aj.bind(null,e)}class Cn{constructor(t){if(typeof t._original_unwrapped_fs<"u")return t;const n=Object.getOwnPropertyDescriptor(t,"promises");n&&n.enumerable?yz(this,t.promises):yz(this,t),this._original_unwrapped_fs=t}async exists(t,n={}){try{return await this._stat(t),!0}catch(r){if(r.code==="ENOENT"||r.code==="ENOTDIR"||(r.code||"").includes("ENS"))return!1;throw console.log('Unhandled error in "FileSystem.exists()" function',r),r}}async read(t,n={}){try{let r=await this._readFile(t,n);if(n.autocrlf==="true")try{r=new TextDecoder("utf8",{fatal:!0}).decode(r),r=r.replace(/\r\n/g,`
`),r=new TextEncoder().encode(r)}catch{}return typeof r!="string"&&(r=ln.from(r)),r}catch{return null}}async write(t,n,r={}){try{await this._writeFile(t,n,r);return}catch{await this.mkdir(iy(t)),await this._writeFile(t,n,r)}}async mkdir(t,n=!1){try{await this._mkdir(t);return}catch(r){if(r===null||r.code==="EEXIST")return;if(n)throw r;if(r.code==="ENOENT"){const s=iy(t);if(s==="."||s==="/"||s===t)throw r;await this.mkdir(s),await this.mkdir(t,!0)}}}async rm(t){try{await this._unlink(t)}catch(n){if(n.code!=="ENOENT")throw n}}async rmdir(t,n){try{n&&n.recursive?await this._rm(t,n):await this._rmdir(t)}catch(r){if(r.code!=="ENOENT")throw r}}async readdir(t){try{const n=await this._readdir(t);return n.sort(XE),n}catch(n){return n.code==="ENOTDIR"?null:[]}}async readdirDeep(t){const n=await this._readdir(t);return(await Promise.all(n.map(async s=>{const i=t+"/"+s;return(await this._stat(i)).isDirectory()?this.readdirDeep(i):i}))).reduce((s,i)=>s.concat(i),[])}async lstat(t){try{return await this._lstat(t)}catch(n){if(n.code==="ENOENT"||(n.code||"").includes("ENS"))return null;throw n}}async readlink(t,n={encoding:"buffer"}){try{const r=await this._readlink(t,n);return ln.isBuffer(r)?r:ln.from(r)}catch(r){if(r.code==="ENOENT"||(r.code||"").includes("ENS"))return null;throw r}}async writelink(t,n){return this._symlink(n.toString("utf8"),t)}}function ct(e,t){if(t===void 0)throw new No(e)}async function YC(e,t){return!e&&!t?!1:e&&!t||!e&&t?!0:!(await e.type()==="tree"&&await t.type()==="tree"||await e.type()===await t.type()&&await e.mode()===await t.mode()&&await e.oid()===await t.oid())}async function WCe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),commit:r="HEAD",cache:s={}}){try{ct("fs",e),ct("dir",t),ct("gitdir",n);const i=new Cn(e),a=[Hl({ref:r}),O1(),Ky()];let o=[];await oa.acquire({fs:i,gitdir:n,cache:s},async function(c){o=c.unmergedPaths});const l=await Eh({fs:i,cache:s,dir:t,gitdir:n,trees:a,map:async function(c,[u,d,h]){const m=!await YC(d,h),y=o.includes(c),b=!await YC(h,u);if(m||y)return u?{path:c,mode:await u.mode(),oid:await u.oid(),type:await u.type(),content:await u.content()}:void 0;if(b)return!1;throw new j1(c)}});await oa.acquire({fs:i,gitdir:n,cache:s},async function(c){for(const u of l)if(u!==!1){if(!u){await i.rmdir(`${t}/${u.path}`,{recursive:!0}),c.delete({filepath:u.path});continue}if(u.type==="blob"){const d=new TextDecoder().decode(u.content);await i.write(`${t}/${u.path}`,d,{mode:u.mode}),c.insert({filepath:u.path,oid:u.oid,stage:0})}}})}catch(i){throw i.caller="git.abortMerge",i}}class Qy{static async isIgnored({fs:t,dir:n,gitdir:r=$t.join(n,".git"),filepath:s}){if(WC(s)===".git")return!0;if(s===".")return!1;let i="";const a=$t.join(r,"info","exclude");await t.exists(a)&&(i=await t.read(a,"utf8"));const o=[{gitignore:$t.join(n,".gitignore"),filepath:s}],l=s.split("/").filter(Boolean);for(let u=1;u<l.length;u++){const d=l.slice(0,u).join("/"),h=l.slice(u).join("/");o.push({gitignore:$t.join(n,d,".gitignore"),filepath:h})}let c=!1;for(const u of o){let d;try{d=await t.read(u.gitignore,"utf8")}catch(y){if(y.code==="NOENT")continue}const h=U2e().add(i);h.add(d);const m=iy(u.filepath);if(m!=="."&&h.ignores(m))return!0;c?c=!h.test(u.filepath).unignored:c=h.test(u.filepath).ignored}return c}}async function HCe({fs:e,gitdir:t,object:n,format:r,oid:s}){const i=`objects/${s.slice(0,2)}/${s.slice(2)}`,a=`${t}/${i}`;await e.exists(a)||await e.write(a,n)}let eI=null;async function FY(e){return eI===null&&(eI=KCe()),eI?GCe(e):nD.deflate(e)}async function GCe(e){const t=new CompressionStream("deflate"),n=new Blob([e]).stream().pipeThrough(t);return new Uint8Array(await new Response(n).arrayBuffer())}function KCe(){try{return new CompressionStream("deflate").writable.close(),new Blob([]).stream().cancel(),!0}catch{return!1}}async function Uo({fs:e,gitdir:t,type:n,object:r,format:s="content",oid:i=void 0,dryRun:a=!1}){return s!=="deflated"&&(s!=="wrapped"&&(r=Yy.wrap({type:n,object:r})),i=await Hd(r),r=ln.from(await FY(r))),a||await HCe({fs:e,gitdir:t,object:r,format:"deflated",oid:i}),i}function LY(e){let t;for(;~(t=e.indexOf(92));)e[t]=47;return e}async function YCe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),filepath:r,cache:s={},force:i=!1,parallel:a=!0}){try{ct("fs",e),ct("dir",t),ct("gitdir",n),ct("filepath",r);const o=new Cn(e);await oa.acquire({fs:o,gitdir:n,cache:s},async l=>{const u=await(await Mi.get({fs:o,gitdir:n})).get("core.autocrlf");return Rj({dir:t,gitdir:n,fs:o,filepath:r,index:l,force:i,parallel:a,autocrlf:u})})}catch(o){throw o.caller="git.add",o}}async function Rj({dir:e,gitdir:t,fs:n,filepath:r,index:s,force:i,parallel:a,autocrlf:o}){r=Array.isArray(r)?r:[r];const l=r.map(async h=>{if(!i&&await Qy.isIgnored({fs:n,dir:e,gitdir:t,filepath:h}))return;const m=await n.lstat($t.join(e,h));if(!m)throw new Ts(h);if(m.isDirectory()){const y=await n.readdir($t.join(e,h));if(a){const b=y.map(v=>Rj({dir:e,gitdir:t,fs:n,filepath:[$t.join(h,v)],index:s,force:i,parallel:a,autocrlf:o}));await Promise.all(b)}else for(const b of y)await Rj({dir:e,gitdir:t,fs:n,filepath:[$t.join(h,b)],index:s,force:i,parallel:a,autocrlf:o})}else{const y=m.isSymbolicLink()?await n.readlink($t.join(e,h)).then(LY):await n.read($t.join(e,h),{autocrlf:o});if(y===null)throw new Ts(h);const b=await Uo({fs:n,gitdir:t,type:"blob",object:y});s.insert({filepath:h,stats:m,oid:b})}}),c=await Promise.allSettled(l),u=c.filter(h=>h.status==="rejected").map(h=>h.reason);if(u.length>1)throw new R1(u);if(u.length===1)throw u[0];return c.filter(h=>h.status==="fulfilled"&&h.value).map(h=>h.value)}async function ow({fs:e,gitdir:t,path:n}){return(await Mi.get({fs:e,gitdir:t})).get(n)}function BY(e,...t){for(const n of t)if(n)for(const r of Object.keys(n)){const s=n[r];s!==void 0&&(e[r]=s)}return e}async function Th({fs:e,gitdir:t,author:n,commit:r}){const s=Math.floor(Date.now()/1e3),i={name:await ow({fs:e,gitdir:t,path:"user.name"}),email:await ow({fs:e,gitdir:t,path:"user.email"})||"",timestamp:s,timezoneOffset:new Date(s*1e3).getTimezoneOffset()},a=BY({},i,r?r.author:void 0,n);if(a.name!==void 0)return a}async function uy({fs:e,gitdir:t,author:n,committer:r,commit:s}){const i=Math.floor(Date.now()/1e3),a={name:await ow({fs:e,gitdir:t,path:"user.name"}),email:await ow({fs:e,gitdir:t,path:"user.email"})||"",timestamp:i,timezoneOffset:new Date(i*1e3).getTimezoneOffset()},o=BY({},a,s?s.committer:void 0,n,r);if(o.name!==void 0)return o}async function $Y({fs:e,cache:t,gitdir:n,oid:r}){const{type:s,object:i}=await Ys({fs:e,cache:t,gitdir:n,oid:r});if(s==="tag")return r=no.from(i).parse().object,$Y({fs:e,cache:t,gitdir:n,oid:r});if(s!=="commit")throw new uo(r,s,"commit");return{commit:Ks.from(i),oid:r}}async function dy({fs:e,cache:t,gitdir:n,oid:r}){const{commit:s,oid:i}=await $Y({fs:e,cache:t,gitdir:n,oid:r});return{oid:i,commit:s.parse(),payload:s.withoutSignature()}}async function QE({fs:e,cache:t,onSign:n,gitdir:r,message:s,author:i,committer:a,signingKey:o,amend:l=!1,dryRun:c=!1,noUpdateBranch:u=!1,ref:d,parent:h,tree:m}){let y=!1;d||(d=await Kt.resolve({fs:e,gitdir:r,ref:"HEAD",depth:2}));let b,v;try{b=await Kt.resolve({fs:e,gitdir:r,ref:d}),v=await dy({fs:e,gitdir:r,oid:b,cache:{}})}catch{y=!0}if(l&&y)throw new P1(d);const x=l?await Th({fs:e,gitdir:r,author:i,commit:v.commit}):await Th({fs:e,gitdir:r,author:i});if(!x)throw new Ba("author");const w=l?await uy({fs:e,gitdir:r,author:x,committer:a,commit:v.commit}):await uy({fs:e,gitdir:r,author:x,committer:a});if(!w)throw new Ba("committer");return oa.acquire({fs:e,gitdir:r,cache:t,allowUnmerged:!1},async function(S){const k=NY(S.entries).get(".");if(m||(m=await zY({fs:e,gitdir:r,inode:k,dryRun:c})),h?h=await Promise.all(h.map(N=>Kt.resolve({fs:e,gitdir:r,ref:N}))):l?h=v.commit.parent:h=b?[b]:[],!s)if(l)s=v.commit.message;else throw new No("message");let A=Ks.from({tree:m,parent:h,author:x,committer:w,message:s});o&&(A=await Ks.sign(A,n,o));const R=await Uo({fs:e,gitdir:r,type:"commit",object:A.toObject(),dryRun:c});return!u&&!c&&await Kt.writeRef({fs:e,gitdir:r,ref:d,value:R}),R})}async function zY({fs:e,gitdir:t,inode:n,dryRun:r}){const s=n.children;for(const l of s)l.type==="tree"&&(l.metadata.mode="040000",l.metadata.oid=await zY({fs:e,gitdir:t,inode:l,dryRun:r}));const i=s.map(l=>({mode:l.metadata.mode,path:l.basename,oid:l.metadata.oid,type:l.type})),a=Oo.from(i);return await Uo({fs:e,gitdir:t,type:"tree",object:a.toObject(),dryRun:r})}async function D1({fs:e,cache:t,gitdir:n,oid:r,filepath:s}){if(s.startsWith("/"))throw new kh("leading-slash");if(s.endsWith("/"))throw new kh("trailing-slash");const i=r,a=await cy({fs:e,cache:t,gitdir:n,oid:r}),o=a.tree;if(s==="")r=a.oid;else{const l=s.split("/");r=await UY({fs:e,cache:t,gitdir:n,tree:o,pathArray:l,oid:i,filepath:s})}return r}async function UY({fs:e,cache:t,gitdir:n,tree:r,pathArray:s,oid:i,filepath:a}){const o=s.shift();for(const l of r)if(l.path===o){if(s.length===0)return l.oid;{const{type:c,object:u}=await Ys({fs:e,cache:t,gitdir:n,oid:l.oid});if(c!=="tree")throw new uo(i,c,"tree",a);return r=Oo.from(u),UY({fs:e,cache:t,gitdir:n,tree:r,pathArray:s,oid:i,filepath:a})}}throw new Ts(`file or directory found at "${i}:${a}"`)}async function eb({fs:e,cache:t,gitdir:n,oid:r,filepath:s=void 0}){s!==void 0&&(r=await D1({fs:e,cache:t,gitdir:n,oid:r,filepath:s}));const{tree:i,oid:a}=await cy({fs:e,cache:t,gitdir:n,oid:r});return{oid:a,tree:i.entries()}}async function F1({fs:e,gitdir:t,tree:n}){const r=Oo.from(n).toObject();return await Uo({fs:e,gitdir:t,type:"tree",object:r,format:"content"})}async function ZCe({fs:e,cache:t,onSign:n,gitdir:r,ref:s,oid:i,note:a,force:o,author:l,committer:c,signingKey:u}){let d;try{d=await Kt.resolve({gitdir:r,fs:e,ref:s})}catch(x){if(!(x instanceof Ts))throw x}let m=(await eb({fs:e,cache:t,gitdir:r,oid:d||"4b825dc642cb6eb9a060e54bf8d69288fbee4904"})).tree;if(o)m=m.filter(x=>x.path!==i);else for(const x of m)if(x.path===i)throw new Bc("note",i);typeof a=="string"&&(a=ln.from(a,"utf8"));const y=await Uo({fs:e,gitdir:r,type:"blob",object:a,format:"content"});m.push({mode:"100644",path:i,oid:y,type:"blob"});const b=await F1({fs:e,gitdir:r,tree:m});return await QE({fs:e,cache:t,onSign:n,gitdir:r,ref:s,tree:b,parent:d&&[d],message:`Note added by 'isomorphic-git addNote'
`,author:l,committer:c,signingKey:u})}async function XCe({fs:e,onSign:t,dir:n,gitdir:r=$t.join(n,".git"),ref:s="refs/notes/commits",oid:i,note:a,force:o,author:l,committer:c,signingKey:u,cache:d={}}){try{ct("fs",e),ct("gitdir",r),ct("oid",i),ct("note",a),u&&ct("onSign",t);const h=new Cn(e),m=await Th({fs:h,gitdir:r,author:l});if(!m)throw new Ba("author");const y=await uy({fs:h,gitdir:r,author:m,committer:c});if(!y)throw new Ba("committer");return await ZCe({fs:new Cn(h),cache:d,onSign:t,gitdir:r,ref:s,oid:i,note:a,force:o,author:m,committer:y,signingKey:u})}catch(h){throw h.caller="git.addNote",h}}async function qY({fs:e,gitdir:t,remote:n,url:r,force:s}){if(n!==gu.clean(n))throw new Dc(n,gu.clean(n));const i=await Mi.get({fs:e,gitdir:t});if(!s&&(await i.getSubsections("remote")).includes(n)&&r!==await i.get(`remote.${n}.url`))throw new Bc("remote",n);await i.set(`remote.${n}.url`,r),await i.set(`remote.${n}.fetch`,`+refs/heads/*:refs/remotes/${n}/*`),await Mi.save({fs:e,gitdir:t,config:i})}async function JCe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),remote:r,url:s,force:i=!1}){try{return ct("fs",e),ct("gitdir",n),ct("remote",r),ct("url",s),await qY({fs:new Cn(e),gitdir:n,remote:r,url:s,force:i})}catch(a){throw a.caller="git.addRemote",a}}async function QCe({fs:e,cache:t,onSign:n,gitdir:r,ref:s,tagger:i,message:a=s,gpgsig:o,object:l,signingKey:c,force:u=!1}){if(s=s.startsWith("refs/tags/")?s:`refs/tags/${s}`,!u&&await Kt.exists({fs:e,gitdir:r,ref:s}))throw new Bc("tag",s);const d=await Kt.resolve({fs:e,gitdir:r,ref:l||"HEAD"}),{type:h}=await Ys({fs:e,cache:t,gitdir:r,oid:d});let m=no.from({object:d,type:h,tag:s.replace("refs/tags/",""),tagger:i,message:a,gpgsig:o});c&&(m=await no.sign(m,n,c));const y=await Uo({fs:e,gitdir:r,type:"tag",object:m.toObject()});await Kt.writeRef({fs:e,gitdir:r,ref:s,value:y})}async function eke({fs:e,onSign:t,dir:n,gitdir:r=$t.join(n,".git"),ref:s,tagger:i,message:a=s,gpgsig:o,object:l,signingKey:c,force:u=!1,cache:d={}}){try{ct("fs",e),ct("gitdir",r),ct("ref",s),c&&ct("onSign",t);const h=new Cn(e),m=await Th({fs:h,gitdir:r,author:i});if(!m)throw new Ba("tagger");return await QCe({fs:h,cache:d,onSign:t,gitdir:r,ref:s,tagger:m,message:a,gpgsig:o,object:l,signingKey:c,force:u})}catch(h){throw h.caller="git.annotatedTag",h}}async function tke({fs:e,gitdir:t,ref:n,object:r,checkout:s=!1,force:i=!1}){if(n!==gu.clean(n))throw new Dc(n,gu.clean(n));const a=`refs/heads/${n}`;if(!i&&await Kt.exists({fs:e,gitdir:t,ref:a}))throw new Bc("branch",n,!1);let o;try{o=await Kt.resolve({fs:e,gitdir:t,ref:r||"HEAD"})}catch{}o&&await Kt.writeRef({fs:e,gitdir:t,ref:a,value:o}),s&&await Kt.writeSymbolicRef({fs:e,gitdir:t,ref:"HEAD",value:a})}async function nke({fs:e,dir:t,gitdir:n=$t.join(t,".git"),ref:r,object:s,checkout:i=!1,force:a=!1}){try{return ct("fs",e),ct("gitdir",n),ct("ref",r),await tke({fs:new Cn(e),gitdir:n,ref:r,object:s,checkout:i,force:a})}catch(o){throw o.caller="git.branch",o}}const VY=(e,t)=>e==="."||t==null||t.length===0||t==="."?!0:t.length>=e.length?t.startsWith(e):e.startsWith(t);async function aD({fs:e,cache:t,onProgress:n,onPostCheckout:r,dir:s,gitdir:i,remote:a,ref:o,filepaths:l,noCheckout:c,noUpdateHead:u,dryRun:d,force:h,track:m=!0}){let y;if(r)try{y=await Kt.resolve({fs:e,gitdir:i,ref:"HEAD"})}catch{y="0000000000000000000000000000000000000000"}let b;try{b=await Kt.resolve({fs:e,gitdir:i,ref:o})}catch(v){if(o==="HEAD")throw v;const x=`${a}/${o}`;if(b=await Kt.resolve({fs:e,gitdir:i,ref:x}),m){const w=await Mi.get({fs:e,gitdir:i});await w.set(`branch.${o}.remote`,a),await w.set(`branch.${o}.merge`,`refs/heads/${o}`),await Mi.save({fs:e,gitdir:i,config:w})}await Kt.writeRef({fs:e,gitdir:i,ref:`refs/heads/${o}`,value:b})}if(!c){let v;try{v=await rke({fs:e,cache:t,onProgress:n,dir:s,gitdir:i,ref:o,force:h,filepaths:l})}catch(k){throw k instanceof Ts&&k.data.what===b?new C1(o,b):k}const x=v.filter(([k])=>k==="conflict").map(([k,A])=>A);if(x.length>0)throw new S1(x);const w=v.filter(([k])=>k==="error").map(([k,A])=>A);if(w.length>0)throw new vr(w.join(", "));if(d){r&&await r({previousHead:y,newHead:b,type:l!=null&&l.length>0?"file":"branch"});return}let S=0;const C=v.length;await oa.acquire({fs:e,gitdir:i,cache:t},async function(k){await Promise.all(v.filter(([A])=>A==="delete"||A==="delete-index").map(async function([A,R]){const N=`${s}/${R}`;A==="delete"&&await e.rm(N),k.delete({filepath:R}),n&&await n({phase:"Updating workdir",loaded:++S,total:C})}))}),await oa.acquire({fs:e,gitdir:i,cache:t},async function(k){for(const[A,R]of v)if(A==="rmdir"||A==="rmdir-index"){const N=`${s}/${R}`;try{A==="rmdir-index"&&k.delete({filepath:R}),await e.rmdir(N),n&&await n({phase:"Updating workdir",loaded:++S,total:C})}catch(I){if(I.code==="ENOTEMPTY")console.log(`Did not delete ${R} because directory is not empty`);else throw I}}}),await Promise.all(v.filter(([k])=>k==="mkdir"||k==="mkdir-index").map(async function([k,A]){const R=`${s}/${A}`;await e.mkdir(R),n&&await n({phase:"Updating workdir",loaded:++S,total:C})})),await oa.acquire({fs:e,gitdir:i,cache:t},async function(k){await Promise.all(v.filter(([A])=>A==="create"||A==="create-index"||A==="update"||A==="mkdir-index").map(async function([A,R,N,I,P]){const L=`${s}/${R}`;try{if(A!=="create-index"&&A!=="mkdir-index"){const{object:V}=await Ys({fs:e,cache:t,gitdir:i,oid:N});if(P&&await e.rm(L),I===33188)await e.write(L,V);else if(I===33261)await e.write(L,V,{mode:511});else if(I===40960)await e.writelink(L,V);else throw new vr(`Invalid mode 0o${I.toString(8)} detected in blob ${N}`)}const O=await e.lstat(L);I===33261&&(O.mode=493),A==="mkdir-index"&&(O.mode=57344),k.insert({filepath:R,stats:O,oid:N}),n&&await n({phase:"Updating workdir",loaded:++S,total:C})}catch(O){console.log(O)}}))}),r&&await r({previousHead:y,newHead:b,type:l!=null&&l.length>0?"file":"branch"})}if(!u){const v=await Kt.expand({fs:e,gitdir:i,ref:o});v.startsWith("refs/heads")?await Kt.writeSymbolicRef({fs:e,gitdir:i,ref:"HEAD",value:v}):await Kt.writeRef({fs:e,gitdir:i,ref:"HEAD",value:b})}}async function rke({fs:e,cache:t,onProgress:n,dir:r,gitdir:s,ref:i,force:a,filepaths:o}){let l=0;return Eh({fs:e,cache:t,dir:r,gitdir:s,trees:[Hl({ref:i}),O1(),Ky()],map:async function(c,[u,d,h]){if(c===".")return;if(o&&!o.some(y=>VY(c,y)))return null;switch(n&&await n({phase:"Analyzing workdir",loaded:++l}),[!!h,!!u,!!d].map(Number).join("")){case"000":return;case"001":return a&&o&&o.includes(c)?["delete",c]:void 0;case"010":switch(await u.type()){case"tree":return["mkdir",c];case"blob":return["create",c,await u.oid(),await u.mode()];case"commit":return["mkdir-index",c,await u.oid(),await u.mode()];default:return["error",`new entry Unhandled type ${await u.type()}`]}case"011":switch(`${await u.type()}-${await d.type()}`){case"tree-tree":return;case"tree-blob":case"blob-tree":return["conflict",c];case"blob-blob":return await u.oid()!==await d.oid()?a?["update",c,await u.oid(),await u.mode(),await u.mode()!==await d.mode()]:["conflict",c]:await u.mode()!==await d.mode()?a?["update",c,await u.oid(),await u.mode(),!0]:["conflict",c]:["create-index",c,await u.oid(),await u.mode()];case"commit-tree":return;case"commit-blob":return["conflict",c];default:return["error",`new entry Unhandled type ${u.type}`]}case"100":return["delete-index",c];case"101":switch(await h.type()){case"tree":return["rmdir",c];case"blob":return await h.oid()!==await d.oid()?a?["delete",c]:["conflict",c]:["delete",c];case"commit":return["rmdir-index",c];default:return["error",`delete entry Unhandled type ${await h.type()}`]}case"110":case"111":switch(`${await h.type()}-${await u.type()}`){case"tree-tree":return;case"blob-blob":{if(await h.oid()===await u.oid()&&await h.mode()===await u.mode()&&!a)return;if(d){if(await d.oid()!==await h.oid()&&await d.oid()!==await u.oid())return a?["update",c,await u.oid(),await u.mode(),await u.mode()!==await d.mode()]:["conflict",c]}else if(a)return["update",c,await u.oid(),await u.mode(),await u.mode()!==await h.mode()];return await u.mode()!==await h.mode()?["update",c,await u.oid(),await u.mode(),!0]:await u.oid()!==await h.oid()?["update",c,await u.oid(),await u.mode(),!1]:void 0}case"tree-blob":return["update-dir-to-blob",c,await u.oid()];case"blob-tree":return["update-blob-to-tree",c];case"commit-commit":return["mkdir-index",c,await u.oid(),await u.mode()];default:return["error",`update entry Unhandled type ${await h.type()}-${await u.type()}`]}}},reduce:async function(c,u){return u=DY(u),c?c&&c[0]==="rmdir"?(u.push(c),u):(u.unshift(c),u):u}})}async function WY({fs:e,onProgress:t,onPostCheckout:n,dir:r,gitdir:s=$t.join(r,".git"),remote:i="origin",ref:a,filepaths:o,noCheckout:l=!1,noUpdateHead:c=a===void 0,dryRun:u=!1,force:d=!1,track:h=!0,cache:m={}}){try{ct("fs",e),ct("dir",r),ct("gitdir",s);const y=a||"HEAD";return await aD({fs:new Cn(e),cache:m,onProgress:t,onPostCheckout:n,dir:r,gitdir:s,remote:i,ref:y,filepaths:o,noCheckout:l,noUpdateHead:c,dryRun:u,force:d,track:h})}catch(y){throw y.caller="git.checkout",y}}const ske=new RegExp("^refs/(heads/|tags/|remotes/)?(.*)");function Qp(e){const t=ske.exec(e);return t?t[1]==="remotes/"&&e.endsWith("/HEAD")?t[2].slice(0,-5):t[2]:e}async function Kh({fs:e,gitdir:t,fullname:n=!1,test:r=!1}){const s=await Kt.resolve({fs:e,gitdir:t,ref:"HEAD",depth:2});if(r)try{await Kt.resolve({fs:e,gitdir:t,ref:s})}catch{return}if(s.startsWith("refs/"))return n?s:Qp(s)}function ike(e){return e=e.replace(/^git@([^:]+):/,"https://$1/"),e=e.replace(/^ssh:\/\//,"https://"),e}function HY({username:e="",password:t=""}){return`Basic ${ln.from(`${e}:${t}`).toString("base64")}`}async function L1(e,t){const n=jY(e);for(;;){const{value:r,done:s}=await n.next();if(r&&await t(r),s)break}n.return&&n.return()}async function ZC(e){let t=0;const n=[];await L1(e,i=>{n.push(i),t+=i.byteLength});const r=new Uint8Array(t);let s=0;for(const i of n)r.set(i,s),s+=i.byteLength;return r}function bz(e){let t=e.match(/^https?:\/\/([^/]+)@/);if(t==null)return{url:e,auth:{}};t=t[1];const[n,r]=t.split(":");return e=e.replace(`${t}@`,""),{url:e,auth:{username:n,password:r}}}function Nj(e,t){const n=t.toString(16);return"0".repeat(e-n.length)+n}class pi{static flush(){return ln.from("0000","utf8")}static delim(){return ln.from("0001","utf8")}static encode(t){typeof t=="string"&&(t=ln.from(t));const n=t.length+4,r=Nj(4,n);return ln.concat([ln.from(r,"utf8"),t])}static streamReader(t){const n=new PY(t);return async function(){try{let s=await n.read(4);if(s==null)return!0;if(s=parseInt(s.toString("utf8"),16),s===0||s===1)return null;const i=await n.read(s-4);return i??!0}catch(s){return t.error=s,!0}}}}async function vz(e){const t={};let n;for(;n=await e(),n!==!0;){if(n===null)continue;n=n.toString("utf8").replace(/\n$/,"");const r=n.indexOf("=");if(r>-1){const s=n.slice(0,r),i=n.slice(r+1);t[s]=i}else t[n]=!0}return{protocolVersion:2,capabilities2:t}}async function xz(e,{service:t}){const n=new Set,r=new Map,s=new Map,i=pi.streamReader(e);let a=await i();for(;a===null;)a=await i();if(a===!0)throw new k1;if(a.includes("version 2"))return vz(i);if(a.toString("utf8").replace(/\n$/,"")!==`# service=${t}`)throw new Zm(`# service=${t}\\n`,a.toString("utf8"));let o=await i();for(;o===null;)o=await i();if(o===!0)return{capabilities:n,refs:r,symrefs:s};if(o=o.toString("utf8"),o.includes("version 2"))return vz(i);const[l,c]=tI(o,"\0","\\x00");if(c.split(" ").map(u=>n.add(u)),l!=="0000000000000000000000000000000000000000 capabilities^{}"){const[u,d]=tI(l," "," ");for(r.set(d,u);;){const h=await i();if(h===!0)break;if(h!==null){const[m,y]=tI(h.toString("utf8")," "," ");r.set(y,m)}}}for(const u of n)if(u.startsWith("symref=")){const d=u.match(/symref=([^:]+):(.*)/);d.length===3&&s.set(d[1],d[2])}return{protocolVersion:1,capabilities:n,refs:r,symrefs:s}}function tI(e,t,n){const r=e.trim().split(t);if(r.length!==2)throw new Zm(`Two strings separated by '${n}'`,e.toString("utf8"));return r}const wz=(e,t)=>e.endsWith("?")?`${e}${t}`:`${e}/${t.replace(/^https?:\/\//,"")}`,_z=(e,t)=>{(t.username||t.password)&&(e.Authorization=HY(t)),t.headers&&Object.assign(e,t.headers)},nI=async e=>{try{const t=ln.from(await ZC(e.body)),n=t.toString("utf8");return{preview:n.length<256?n:n.slice(0,256)+"...",response:n,data:t}}catch{return{}}};class XC{static async capabilities(){return["discover","connect"]}static async discover({http:t,onProgress:n,onAuth:r,onAuthSuccess:s,onAuthFailure:i,corsProxy:a,service:o,url:l,headers:c,protocolVersion:u}){let{url:d,auth:h}=bz(l);const m=a?wz(a,d):d;(h.username||h.password)&&(c.Authorization=HY(h)),u===2&&(c["Git-Protocol"]="version=2");let y,b,v=!1;do if(y=await t.request({onProgress:n,method:"GET",url:`${m}/info/refs?service=${o}`,headers:c}),b=!1,y.statusCode===401||y.statusCode===203){const x=v?i:r;if(x){if(h=await x(d,{...h,headers:{...c}}),h&&h.cancel)throw new Jy;h&&(_z(c,h),v=!0,b=!0)}}else y.statusCode===200&&v&&s&&await s(d,h);while(b);if(y.statusCode!==200){const{response:x}=await nI(y);throw new oy(y.statusCode,y.statusMessage,x)}if(y.headers["content-type"]===`application/x-${o}-advertisement`){const x=await xz(y.body,{service:o});return x.auth=h,x}else{const{preview:x,response:w,data:S}=await nI(y);try{const C=await xz([S],{service:o});return C.auth=h,C}catch{throw new N1(x,w)}}}static async connect({http:t,onProgress:n,corsProxy:r,service:s,url:i,auth:a,body:o,headers:l}){const c=bz(i);c&&(i=c.url),r&&(i=wz(r,i)),l["content-type"]=`application/x-${s}-request`,l.accept=`application/x-${s}-result`,_z(l,a);const u=await t.request({onProgress:n,method:"POST",url:`${i}/${s}`,body:o,headers:l});if(u.statusCode!==200){const{response:d}=nI(u);throw new oy(u.statusCode,u.statusMessage,d)}return u}}function ake({url:e}){if(e.startsWith("git@"))return{transport:"ssh",address:e};const t=e.match(/(\w+)(:\/\/|::)(.*)/);if(t!==null){if(t[2]==="://")return{transport:t[1],address:t[0]};if(t[2]==="::")return{transport:t[1],address:t[3]}}}class eT{static getRemoteHelperFor({url:t}){const n=new Map;n.set("http",XC),n.set("https",XC);const r=ake({url:t});if(!r)throw new I1(t);if(n.has(r.transport))return n.get(r.transport);throw new M1(t,r.transport,r.transport==="ssh"?ike(t):void 0)}}let $p=null;class lw{static async read({fs:t,gitdir:n}){$p===null&&($p=new aw);const r=$t.join(n,"shallow"),s=new Set;return await $p.acquire(r,async function(){const i=await t.read(r,{encoding:"utf8"});if(i===null||i.trim()==="")return s;i.trim().split(`
`).map(a=>s.add(a))}),s}static async write({fs:t,gitdir:n,oids:r}){$p===null&&($p=new aw);const s=$t.join(n,"shallow");if(r.size>0){const i=[...r].join(`
`)+`
`;await $p.acquire(s,async function(){await t.write(s,i,{encoding:"utf8"})})}else await $p.acquire(s,async function(){await t.rm(s)})}}async function oke({fs:e,gitdir:t,oid:n}){const r=`objects/${n.slice(0,2)}/${n.slice(2)}`;return e.exists(`${t}/${r}`)}async function lke({fs:e,cache:t,gitdir:n,oid:r,getExternalRefDelta:s}){let i=await e.readdir($t.join(n,"objects/pack"));i=i.filter(a=>a.endsWith(".idx"));for(const a of i){const o=`${n}/objects/pack/${a}`,l=await iD({fs:e,cache:t,filename:o,getExternalRefDelta:s});if(l.error)throw new vr(l.error);if(l.offsets.has(r))return!0}return!1}async function Sz({fs:e,cache:t,gitdir:n,oid:r,format:s="content"}){const i=o=>Ys({fs:e,cache:t,gitdir:n,oid:o});let a=await oke({fs:e,gitdir:n,oid:r});return a||(a=await lke({fs:e,cache:t,gitdir:n,oid:r,getExternalRefDelta:i})),a}function cke(e){const s="5041434b"+"00000002"+"00000000";return e.slice(0,12).toString("hex")===s}function GY(e,t){const n=e.map(r=>r.split("=",1)[0]);return t.filter(r=>{const s=r.split("=",1)[0];return n.includes(s)})}const tT={name:"isomorphic-git",version:"1.30.1",agent:"git/isomorphic-git@1.30.1"};class A2{constructor(){this._queue=[]}write(t){if(this._ended)throw Error("You cannot write to a FIFO that has already been ended!");if(this._waiting){const n=this._waiting;this._waiting=null,n({value:t})}else this._queue.push(t)}end(){if(this._ended=!0,this._waiting){const t=this._waiting;this._waiting=null,t({done:!0})}}destroy(t){this.error=t,this.end()}async next(){if(this._queue.length>0)return{value:this._queue.shift()};if(this._ended)return{done:!0};if(this._waiting)throw Error("You cannot call read until the previous call to read has returned!");return new Promise(t=>{this._waiting=t})}}function uke(e){const t=e.indexOf("\r"),n=e.indexOf(`
`);return t===-1&&n===-1?-1:t===-1?n+1:n===-1?t+1:n===t+1?n+1:Math.min(t,n)+1}function KY(e){const t=new A2;let n="";return(async()=>(await L1(e,r=>{for(r=r.toString("utf8"),n+=r;;){const s=uke(n);if(s===-1)break;t.write(n.slice(0,s)),n=n.slice(s)}}),n.length>0&&t.write(n),t.end()))(),t}class YY{static demux(t){const n=pi.streamReader(t),r=new A2,s=new A2,i=new A2,a=async function(){const o=await n();if(o===null)return a();if(o===!0){r.end(),i.end(),t.error?s.destroy(t.error):s.end();return}switch(o[0]){case 1:{s.write(o.slice(1));break}case 2:{i.write(o.slice(1));break}case 3:{const l=o.slice(1);i.write(l),r.end(),i.end(),s.destroy(new Error(l.toString("utf8")));return}default:r.write(o)}a()};return a(),{packetlines:r,packfile:s,progress:i}}}async function dke(e){const{packetlines:t,packfile:n,progress:r}=YY.demux(e),s=[],i=[],a=[];let o=!1,l=!1;return new Promise((c,u)=>{L1(t,d=>{const h=d.toString("utf8").trim();if(h.startsWith("shallow")){const m=h.slice(-41).trim();m.length!==40&&u(new Ch(m)),s.push(m)}else if(h.startsWith("unshallow")){const m=h.slice(-41).trim();m.length!==40&&u(new Ch(m)),i.push(m)}else if(h.startsWith("ACK")){const[,m,y]=h.split(" ");a.push({oid:m,status:y}),y||(l=!0)}else h.startsWith("NAK")?(o=!0,l=!0):(l=!0,o=!0);l&&(e.error?u(e.error):c({shallows:s,unshallows:i,acks:a,nak:o,packfile:n,progress:r}))}).finally(()=>{l||(e.error?u(e.error):c({shallows:s,unshallows:i,acks:a,nak:o,packfile:n,progress:r}))})})}function fke({capabilities:e=[],wants:t=[],haves:n=[],shallows:r=[],depth:s=null,since:i=null,exclude:a=[]}){const o=[];t=[...new Set(t)];let l=` ${e.join(" ")}`;for(const c of t)o.push(pi.encode(`want ${c}${l}
`)),l="";for(const c of r)o.push(pi.encode(`shallow ${c}
`));s!==null&&o.push(pi.encode(`deepen ${s}
`)),i!==null&&o.push(pi.encode(`deepen-since ${Math.floor(i.valueOf()/1e3)}
`));for(const c of a)o.push(pi.encode(`deepen-not ${c}
`));o.push(pi.flush());for(const c of n)o.push(pi.encode(`have ${c}
`));return o.push(pi.encode(`done
`)),o}async function oD({fs:e,cache:t,http:n,onProgress:r,onMessage:s,onAuth:i,onAuthSuccess:a,onAuthFailure:o,gitdir:l,ref:c,remoteRef:u,remote:d,url:h,corsProxy:m,depth:y=null,since:b=null,exclude:v=[],relative:x=!1,tags:w=!1,singleBranch:S=!1,headers:C={},prune:k=!1,pruneTags:A=!1}){const R=c||await Kh({fs:e,gitdir:l,test:!0}),N=await Mi.get({fs:e,gitdir:l}),I=d||R&&await N.get(`branch.${R}.remote`)||"origin",P=h||await N.get(`remote.${I}.url`);if(typeof P>"u")throw new No("remote OR url");const L=u||R&&await N.get(`branch.${R}.merge`)||c||"HEAD";m===void 0&&(m=await N.get("http.corsProxy"));const O=eT.getRemoteHelperFor({url:P}),V=await O.discover({http:n,onAuth:i,onAuthSuccess:a,onAuthFailure:o,corsProxy:m,service:"git-upload-pack",url:P,headers:C,protocolVersion:1}),D=V.auth,Z=V.refs;if(Z.size===0)return{defaultBranch:null,fetchHead:null,fetchHeadDescription:null};if(y!==null&&!V.capabilities.has("shallow"))throw new lh("shallow","depth");if(b!==null&&!V.capabilities.has("deepen-since"))throw new lh("deepen-since","since");if(v.length>0&&!V.capabilities.has("deepen-not"))throw new lh("deepen-not","exclude");if(x===!0&&!V.capabilities.has("deepen-relative"))throw new lh("deepen-relative","relative");const{oid:U,fullref:H}=Kt.resolveAgainstMap({ref:L,map:Z});for(const Ve of Z.keys())Ve===H||Ve==="HEAD"||Ve.startsWith("refs/heads/")||w&&Ve.startsWith("refs/tags/")||Z.delete(Ve);const $=GY([...V.capabilities],["multi_ack_detailed","no-done","side-band-64k","ofs-delta",`agent=${tT.agent}`]);x&&$.push("deepen-relative");const ne=S?[U]:Z.values(),W=S?[R]:await Kt.listRefs({fs:e,gitdir:l,filepath:"refs"});let Q=[];for(let Ve of W)try{Ve=await Kt.expand({fs:e,gitdir:l,ref:Ve});const Ne=await Kt.resolve({fs:e,gitdir:l,ref:Ve});await Sz({fs:e,cache:t,gitdir:l,oid:Ne})&&Q.push(Ne)}catch{}Q=[...new Set(Q)];const ee=await lw.read({fs:e,gitdir:l}),se=V.capabilities.has("shallow")?[...ee]:[],pe=fke({capabilities:$,wants:ne,haves:Q,shallows:se,depth:y,since:b,exclude:v}),ce=ln.from(await ZC(pe)),Ie=await O.connect({http:n,onProgress:r,corsProxy:m,service:"git-upload-pack",url:P,auth:D,body:[ce],headers:C}),De=await dke(Ie.body);Ie.headers&&(De.headers=Ie.headers);for(const Ve of De.shallows)if(!ee.has(Ve))try{const{object:Ne}=await Ys({fs:e,cache:t,gitdir:l,oid:Ve}),K=new Ks(Ne),ge=await Promise.all(K.headers().parent.map(le=>Sz({fs:e,cache:t,gitdir:l,oid:le})));ge.length===0||ge.every(le=>le)||ee.add(Ve)}catch{ee.add(Ve)}for(const Ve of De.unshallows)ee.delete(Ve);if(await lw.write({fs:e,gitdir:l,oids:ee}),S){const Ve=new Map([[H,U]]),Ne=new Map;let K=10,ge=H;for(;K--;){const oe=V.symrefs.get(ge);if(oe===void 0)break;Ne.set(ge,oe),ge=oe}const Ae=Z.get(ge);Ae&&Ve.set(ge,Ae);const{pruned:le}=await Kt.updateRemoteRefs({fs:e,gitdir:l,remote:I,refs:Ve,symrefs:Ne,tags:w,prune:k});k&&(De.pruned=le)}else{const{pruned:Ve}=await Kt.updateRemoteRefs({fs:e,gitdir:l,remote:I,refs:Z,symrefs:V.symrefs,tags:w,prune:k,pruneTags:A});k&&(De.pruned=Ve)}if(De.HEAD=V.symrefs.get("HEAD"),De.HEAD===void 0){const{oid:Ve}=Kt.resolveAgainstMap({ref:"HEAD",map:Z});for(const[Ne,K]of Z.entries())if(Ne!=="HEAD"&&K===Ve){De.HEAD=Ne;break}}const Se=H.startsWith("refs/tags")?"tag":"branch";if(De.FETCH_HEAD={oid:U,description:`${Se} '${Qp(H)}' of ${P}`},r||s){const Ve=KY(De.progress);L1(Ve,async Ne=>{if(s&&await s(Ne),r){const K=Ne.match(/([^:]*).*\((\d+?)\/(\d+?)\)/);K&&await r({phase:K[1].trim(),loaded:parseInt(K[2],10),total:parseInt(K[3],10)})}})}const Ce=ln.from(await ZC(De.packfile));if(Ie.body.error)throw Ie.body.error;const qe=Ce.slice(-20).toString("hex"),Qe={defaultBranch:De.HEAD,fetchHead:De.FETCH_HEAD.oid,fetchHeadDescription:De.FETCH_HEAD.description};if(De.headers&&(Qe.headers=De.headers),k&&(Qe.pruned=De.pruned),qe!==""&&!cke(Ce)){Qe.packfile=`objects/pack/pack-${qe}.pack`;const Ve=$t.join(l,Qe.packfile);await e.write(Ve,Ce);const Ne=ge=>Ys({fs:e,cache:t,gitdir:l,oid:ge}),K=await ay.fromPack({pack:Ce,getExternalRefDelta:Ne,onProgress:r});await e.write(Ve.replace(/\.pack$/,".idx"),await K.toBuffer())}return Qe}async function ZY({fs:e,bare:t=!1,dir:n,gitdir:r=t?n:$t.join(n,".git"),defaultBranch:s="master"}){if(await e.exists(r+"/config"))return;let i=["hooks","info","objects/info","objects/pack","refs/heads","refs/tags"];i=i.map(a=>r+"/"+a);for(const a of i)await e.mkdir(a);await e.write(r+"/config",`[core]
	repositoryformatversion = 0
	filemode = false
	bare = ${t}
`+(t?"":`	logallrefupdates = true
`)+`	symlinks = false
	ignorecase = true
`),await e.write(r+"/HEAD",`ref: refs/heads/${s}
`)}async function hke({fs:e,cache:t,http:n,onProgress:r,onMessage:s,onAuth:i,onAuthSuccess:a,onAuthFailure:o,onPostCheckout:l,dir:c,gitdir:u,url:d,corsProxy:h,ref:m,remote:y,depth:b,since:v,exclude:x,relative:w,singleBranch:S,noCheckout:C,noTags:k,headers:A}){try{if(await ZY({fs:e,gitdir:u}),await qY({fs:e,gitdir:u,remote:y,url:d,force:!1}),h){const I=await Mi.get({fs:e,gitdir:u});await I.set("http.corsProxy",h),await Mi.save({fs:e,gitdir:u,config:I})}const{defaultBranch:R,fetchHead:N}=await oD({fs:e,cache:t,http:n,onProgress:r,onMessage:s,onAuth:i,onAuthSuccess:a,onAuthFailure:o,gitdir:u,ref:m,remote:y,corsProxy:h,depth:b,since:v,exclude:x,relative:w,singleBranch:S,headers:A,tags:!k});if(N===null)return;m=m||R,m=m.replace("refs/heads/",""),await aD({fs:e,cache:t,onProgress:r,onPostCheckout:l,dir:c,gitdir:u,ref:m,remote:y,noCheckout:C})}catch(R){throw await e.rmdir(u,{recursive:!0,maxRetries:10}).catch(()=>{}),R}}async function pke({fs:e,http:t,onProgress:n,onMessage:r,onAuth:s,onAuthSuccess:i,onAuthFailure:a,onPostCheckout:o,dir:l,gitdir:c=$t.join(l,".git"),url:u,corsProxy:d=void 0,ref:h=void 0,remote:m="origin",depth:y=void 0,since:b=void 0,exclude:v=[],relative:x=!1,singleBranch:w=!1,noCheckout:S=!1,noTags:C=!1,headers:k={},cache:A={}}){try{return ct("fs",e),ct("http",t),ct("gitdir",c),S||ct("dir",l),ct("url",u),await hke({fs:new Cn(e),cache:A,http:t,onProgress:n,onMessage:r,onAuth:s,onAuthSuccess:i,onAuthFailure:a,onPostCheckout:o,dir:l,gitdir:c,url:u,corsProxy:d,ref:h,remote:m,depth:y,since:b,exclude:v,relative:x,singleBranch:w,noCheckout:S,noTags:C,headers:k})}catch(R){throw R.caller="git.clone",R}}async function mke({fs:e,onSign:t,dir:n,gitdir:r=$t.join(n,".git"),message:s,author:i,committer:a,signingKey:o,amend:l=!1,dryRun:c=!1,noUpdateBranch:u=!1,ref:d,parent:h,tree:m,cache:y={}}){try{ct("fs",e),l||ct("message",s),o&&ct("onSign",t);const b=new Cn(e);return await QE({fs:b,cache:y,onSign:t,gitdir:r,message:s,author:i,committer:a,signingKey:o,amend:l,dryRun:c,noUpdateBranch:u,ref:d,parent:h,tree:m})}catch(b){throw b.caller="git.commit",b}}async function gke({fs:e,dir:t,gitdir:n=$t.join(t,".git"),fullname:r=!1,test:s=!1}){try{return ct("fs",e),ct("gitdir",n),await Kh({fs:new Cn(e),gitdir:n,fullname:r,test:s})}catch(i){throw i.caller="git.currentBranch",i}}async function yke({fs:e,gitdir:t,ref:n}){if(n=n.startsWith("refs/heads/")?n:`refs/heads/${n}`,!await Kt.exists({fs:e,gitdir:t,ref:n}))throw new Ts(n);const s=await Kt.expand({fs:e,gitdir:t,ref:n}),i=await Kh({fs:e,gitdir:t,fullname:!0});if(s===i){const l=await Kt.resolve({fs:e,gitdir:t,ref:s});await Kt.writeRef({fs:e,gitdir:t,ref:"HEAD",value:l})}await Kt.deleteRef({fs:e,gitdir:t,ref:s});const a=Qp(n),o=await Mi.get({fs:e,gitdir:t});await o.deleteSection("branch",a),await Mi.save({fs:e,gitdir:t,config:o})}async function bke({fs:e,dir:t,gitdir:n=$t.join(t,".git"),ref:r}){try{return ct("fs",e),ct("ref",r),await yke({fs:new Cn(e),gitdir:n,ref:r})}catch(s){throw s.caller="git.deleteBranch",s}}async function vke({fs:e,dir:t,gitdir:n=$t.join(t,".git"),ref:r}){try{ct("fs",e),ct("ref",r),await Kt.deleteRef({fs:new Cn(e),gitdir:n,ref:r})}catch(s){throw s.caller="git.deleteRef",s}}async function xke({fs:e,gitdir:t,remote:n}){const r=await Mi.get({fs:e,gitdir:t});await r.deleteSection("remote",n),await Mi.save({fs:e,gitdir:t,config:r})}async function wke({fs:e,dir:t,gitdir:n=$t.join(t,".git"),remote:r}){try{return ct("fs",e),ct("remote",r),await xke({fs:new Cn(e),gitdir:n,remote:r})}catch(s){throw s.caller="git.deleteRemote",s}}async function _ke({fs:e,gitdir:t,ref:n}){n=n.startsWith("refs/tags/")?n:`refs/tags/${n}`,await Kt.deleteRef({fs:e,gitdir:t,ref:n})}async function Ske({fs:e,dir:t,gitdir:n=$t.join(t,".git"),ref:r}){try{return ct("fs",e),ct("ref",r),await _ke({fs:new Cn(e),gitdir:n,ref:r})}catch(s){throw s.caller="git.deleteTag",s}}async function Cke({fs:e,gitdir:t,oid:n}){const r=n.slice(0,2);return(await e.readdir(`${t}/objects/${r}`)).map(i=>`${r}${i}`).filter(i=>i.startsWith(n))}async function kke({fs:e,cache:t,gitdir:n,oid:r,getExternalRefDelta:s}){const i=[];let a=await e.readdir($t.join(n,"objects/pack"));a=a.filter(o=>o.endsWith(".idx"));for(const o of a){const l=`${n}/objects/pack/${o}`,c=await iD({fs:e,cache:t,filename:l,getExternalRefDelta:s});if(c.error)throw new vr(c.error);for(const u of c.offsets.keys())u.startsWith(r)&&i.push(u)}return i}async function Eke({fs:e,cache:t,gitdir:n,oid:r}){const s=o=>Ys({fs:e,cache:t,gitdir:n,oid:o}),i=await Cke({fs:e,gitdir:n,oid:r}),a=await kke({fs:e,cache:t,gitdir:n,oid:r,getExternalRefDelta:s});for(const o of a)i.indexOf(o)===-1&&i.push(o);if(i.length===1)return i[0];throw i.length>1?new _1("oids",r,i):new Ts(`an object matching "${r}"`)}async function Tke({fs:e,dir:t,gitdir:n=$t.join(t,".git"),oid:r,cache:s={}}){try{return ct("fs",e),ct("gitdir",n),ct("oid",r),await Eke({fs:new Cn(e),cache:s,gitdir:n,oid:r})}catch(i){throw i.caller="git.expandOid",i}}async function Ake({fs:e,dir:t,gitdir:n=$t.join(t,".git"),ref:r}){try{return ct("fs",e),ct("gitdir",n),ct("ref",r),await Kt.expand({fs:new Cn(e),gitdir:n,ref:r})}catch(s){throw s.caller="git.expandRef",s}}async function lD({fs:e,cache:t,gitdir:n,oids:r}){const s={},i=r.length;let a=r.map((o,l)=>({index:l,oid:o}));for(;a.length;){const o=new Set;for(const{oid:c,index:u}of a)s[c]||(s[c]=new Set),s[c].add(u),s[c].size===i&&o.add(c);if(o.size>0)return[...o];const l=new Map;for(const{oid:c,index:u}of a)try{const{object:d}=await Ys({fs:e,cache:t,gitdir:n,oid:c}),h=Ks.from(d),{parent:m}=h.parseHeaders();for(const y of m)(!s[y]||!s[y].has(u))&&l.set(y+":"+u,{oid:y,index:u})}catch{}a=Array.from(l.values())}return[]}const rI=/^.*(\r?\n|$)/gm;function Rke({branches:e,contents:t}){const n=e[1],r=e[2],s=t[0],i=t[1],a=t[2],o=i.match(rI),l=s.match(rI),c=a.match(rI),u=K2e(o,l,c),d=7;let h="",m=!0;for(const y of u)y.ok&&(h+=y.ok.join("")),y.conflict&&(m=!1,h+=`${"<".repeat(d)} ${n}
`,h+=y.conflict.a.join(""),h+=`${"=".repeat(d)}
`,h+=y.conflict.b.join(""),h+=`${">".repeat(d)} ${r}
`);return{cleanMerge:m,mergedText:h}}async function Nke({fs:e,cache:t,dir:n,gitdir:r=$t.join(n,".git"),index:s,ourOid:i,baseOid:a,theirOid:o,ourName:l="ours",baseName:c="base",theirName:u="theirs",dryRun:d=!1,abortOnConflict:h=!0,mergeDriver:m}){const y=Hl({ref:i}),b=Hl({ref:a}),v=Hl({ref:o}),x=[],w=[],S=[],C=[],k=await Eh({fs:e,cache:t,dir:n,gitdir:r,trees:[y,b,v],map:async function(A,[R,N,I]){const P=WC(A),L=await YC(R,N),O=await YC(I,N);switch(`${L}-${O}`){case"false-false":return{mode:await N.mode(),path:P,oid:await N.oid(),type:await N.type()};case"false-true":return I?{mode:await I.mode(),path:P,oid:await I.oid(),type:await I.type()}:void 0;case"true-false":return R?{mode:await R.mode(),path:P,oid:await R.oid(),type:await R.type()}:void 0;case"true-true":{if(R&&N&&I&&await R.type()==="blob"&&await N.type()==="blob"&&await I.type()==="blob")return Mke({fs:e,gitdir:r,path:P,ours:R,base:N,theirs:I,ourName:l,baseName:c,theirName:u,mergeDriver:m}).then(async V=>{if(V.cleanMerge)h||s.insert({filepath:A,oid:V.mergeResult.oid,stage:0});else if(x.push(A),w.push(A),!h){const D=await N.oid(),Z=await R.oid(),U=await I.oid();s.delete({filepath:A}),s.insert({filepath:A,oid:D,stage:1}),s.insert({filepath:A,oid:Z,stage:2}),s.insert({filepath:A,oid:U,stage:3})}return V.mergeResult});if(N&&!R&&I&&await N.type()==="blob"&&await I.type()==="blob"){if(x.push(A),S.push(A),!h){const V=await N.oid(),D=await I.oid();s.delete({filepath:A}),s.insert({filepath:A,oid:V,stage:1}),s.insert({filepath:A,oid:D,stage:3})}return{mode:await I.mode(),oid:await I.oid(),type:"blob",path:P}}if(N&&R&&!I&&await N.type()==="blob"&&await R.type()==="blob"){if(x.push(A),C.push(A),!h){const V=await N.oid(),D=await R.oid();s.delete({filepath:A}),s.insert({filepath:A,oid:V,stage:1}),s.insert({filepath:A,oid:D,stage:2})}return{mode:await R.mode(),oid:await R.oid(),type:"blob",path:P}}if(N&&!R&&!I&&await N.type()==="blob")return;throw new Zy}}},reduce:x.length!==0&&(!n||h)?void 0:async(A,R)=>{const N=R.filter(Boolean);if(A&&!(A&&A.type==="tree"&&N.length===0)){if(N.length>0){const P=new Oo(N).toObject(),L=await Uo({fs:e,gitdir:r,type:"tree",object:P,dryRun:d});A.oid=L}return A}}});return x.length!==0?(n&&!h&&await Eh({fs:e,cache:t,dir:n,gitdir:r,trees:[Hl({ref:k.oid})],map:async function(A,[R]){const N=`${n}/${A}`;if(await R.type()==="blob"){const I=await R.mode(),P=new TextDecoder().decode(await R.content());await e.write(N,P,{mode:I})}return!0}}),new Xy(x,w,S,C)):k.oid}async function Mke({fs:e,gitdir:t,path:n,ours:r,base:s,theirs:i,ourName:a,theirName:o,baseName:l,dryRun:c,mergeDriver:u=Rke}){const d="blob",h=await s.mode()===await r.mode()?await i.mode():await r.mode();if(await r.oid()===await i.oid())return{cleanMerge:!0,mergeResult:{mode:h,path:n,oid:await r.oid(),type:d}};if(await r.oid()===await s.oid())return{cleanMerge:!0,mergeResult:{mode:h,path:n,oid:await i.oid(),type:d}};if(await i.oid()===await s.oid())return{cleanMerge:!0,mergeResult:{mode:h,path:n,oid:await r.oid(),type:d}};const m=ln.from(await r.content()).toString("utf8"),y=ln.from(await s.content()).toString("utf8"),b=ln.from(await i.content()).toString("utf8"),{mergedText:v,cleanMerge:x}=await u({branches:[l,a,o],contents:[y,m,b],path:n}),w=await Uo({fs:e,gitdir:t,type:"blob",object:ln.from(v,"utf8"),dryRun:c});return{cleanMerge:x,mergeResult:{mode:h,path:n,oid:w,type:d}}}async function XY({fs:e,cache:t,dir:n,gitdir:r,ours:s,theirs:i,fastForward:a=!0,fastForwardOnly:o=!1,dryRun:l=!1,noUpdateBranch:c=!1,abortOnConflict:u=!0,message:d,author:h,committer:m,signingKey:y,onSign:b,mergeDriver:v}){s===void 0&&(s=await Kh({fs:e,gitdir:r,fullname:!0})),s=await Kt.expand({fs:e,gitdir:r,ref:s}),i=await Kt.expand({fs:e,gitdir:r,ref:i});const x=await Kt.resolve({fs:e,gitdir:r,ref:s}),w=await Kt.resolve({fs:e,gitdir:r,ref:i}),S=await lD({fs:e,cache:t,gitdir:r,oids:[x,w]});if(S.length!==1)throw new Zy;const C=S[0];if(C===w)return{oid:x,alreadyMerged:!0};if(a&&C===x)return!l&&!c&&await Kt.writeRef({fs:e,gitdir:r,ref:s,value:w}),{oid:w,fastForward:!0};{if(o)throw new E1;const k=await oa.acquire({fs:e,gitdir:r,cache:t,allowUnmerged:!1},async R=>Nke({fs:e,cache:t,dir:n,gitdir:r,index:R,ourOid:x,theirOid:w,baseOid:C,ourName:Qp(s),baseName:"base",theirName:Qp(i),dryRun:l,abortOnConflict:u,mergeDriver:v}));if(k instanceof Xy)throw k;return d||(d=`Merge branch '${Qp(i)}' into ${Qp(s)}`),{oid:await QE({fs:e,cache:t,gitdir:r,message:d,ref:s,tree:k,parent:[x,w],author:h,committer:m,signingKey:y,onSign:b,dryRun:l,noUpdateBranch:c}),tree:k,mergeCommit:!0}}}async function JY({fs:e,cache:t,http:n,onProgress:r,onMessage:s,onAuth:i,onAuthSuccess:a,onAuthFailure:o,dir:l,gitdir:c,ref:u,url:d,remote:h,remoteRef:m,prune:y,pruneTags:b,fastForward:v,fastForwardOnly:x,corsProxy:w,singleBranch:S,headers:C,author:k,committer:A,signingKey:R}){try{if(!u){const P=await Kh({fs:e,gitdir:c});if(!P)throw new No("ref");u=P}const{fetchHead:N,fetchHeadDescription:I}=await oD({fs:e,cache:t,http:n,onProgress:r,onMessage:s,onAuth:i,onAuthSuccess:a,onAuthFailure:o,gitdir:c,corsProxy:w,ref:u,url:d,remote:h,remoteRef:m,singleBranch:S,headers:C,prune:y,pruneTags:b});await XY({fs:e,cache:t,gitdir:c,ours:u,theirs:N,fastForward:v,fastForwardOnly:x,message:`Merge ${I}`,author:k,committer:A,signingKey:R,dryRun:!1,noUpdateBranch:!1}),await aD({fs:e,cache:t,onProgress:r,dir:l,gitdir:c,ref:u,remote:h,noCheckout:!1})}catch(N){throw N.caller="git.pull",N}}async function Ike({fs:e,http:t,onProgress:n,onMessage:r,onAuth:s,onAuthSuccess:i,onAuthFailure:a,dir:o,gitdir:l=$t.join(o,".git"),ref:c,url:u,remote:d,remoteRef:h,corsProxy:m,singleBranch:y,headers:b={},cache:v={}}){try{ct("fs",e),ct("http",t),ct("gitdir",l);const x={name:"",email:"",timestamp:Date.now(),timezoneOffset:0};return await JY({fs:new Cn(e),cache:v,http:t,onProgress:n,onMessage:r,onAuth:s,onAuthSuccess:i,onAuthFailure:a,dir:o,gitdir:l,ref:c,url:u,remote:d,remoteRef:h,fastForwardOnly:!0,corsProxy:m,singleBranch:y,headers:b,author:x,committer:x})}catch(x){throw x.caller="git.fastForward",x}}async function jke({fs:e,http:t,onProgress:n,onMessage:r,onAuth:s,onAuthSuccess:i,onAuthFailure:a,dir:o,gitdir:l=$t.join(o,".git"),ref:c,remote:u,remoteRef:d,url:h,corsProxy:m,depth:y=null,since:b=null,exclude:v=[],relative:x=!1,tags:w=!1,singleBranch:S=!1,headers:C={},prune:k=!1,pruneTags:A=!1,cache:R={}}){try{return ct("fs",e),ct("http",t),ct("gitdir",l),await oD({fs:new Cn(e),cache:R,http:t,onProgress:n,onMessage:r,onAuth:s,onAuthSuccess:i,onAuthFailure:a,gitdir:l,ref:c,remote:u,remoteRef:d,url:h,corsProxy:m,depth:y,since:b,exclude:v,relative:x,tags:w,singleBranch:S,headers:C,prune:k,pruneTags:A})}catch(N){throw N.caller="git.fetch",N}}async function Pke({fs:e,dir:t,gitdir:n=$t.join(t,".git"),oids:r,cache:s={}}){try{return ct("fs",e),ct("gitdir",n),ct("oids",r),await lD({fs:new Cn(e),cache:s,gitdir:n,oids:r})}catch(i){throw i.caller="git.findMergeBase",i}}async function QY({fs:e,filepath:t}){if(await e.exists($t.join(t,".git")))return t;{const n=iy(t);if(n===t)throw new Ts(`git root for ${t}`);return QY({fs:e,filepath:n})}}async function Oke({fs:e,filepath:t}){try{return ct("fs",e),ct("filepath",t),await QY({fs:new Cn(e),filepath:t})}catch(n){throw n.caller="git.findRoot",n}}async function Dke({fs:e,dir:t,gitdir:n=$t.join(t,".git"),path:r}){try{return ct("fs",e),ct("gitdir",n),ct("path",r),await ow({fs:new Cn(e),gitdir:n,path:r})}catch(s){throw s.caller="git.getConfig",s}}async function Fke({fs:e,gitdir:t,path:n}){return(await Mi.get({fs:e,gitdir:t})).getall(n)}async function Lke({fs:e,dir:t,gitdir:n=$t.join(t,".git"),path:r}){try{return ct("fs",e),ct("gitdir",n),ct("path",r),await Fke({fs:new Cn(e),gitdir:n,path:r})}catch(s){throw s.caller="git.getConfigAll",s}}async function Bke({http:e,onAuth:t,onAuthSuccess:n,onAuthFailure:r,corsProxy:s,url:i,headers:a={},forPush:o=!1}){try{ct("http",e),ct("url",i);const c=await eT.getRemoteHelperFor({url:i}).discover({http:e,onAuth:t,onAuthSuccess:n,onAuthFailure:r,corsProxy:s,service:o?"git-receive-pack":"git-upload-pack",url:i,headers:a,protocolVersion:1}),u={capabilities:[...c.capabilities]};for(const[d,h]of c.refs){const m=d.split("/"),y=m.pop();let b=u;for(const v of m)b[v]=b[v]||{},b=b[v];b[y]=h}for(const[d,h]of c.symrefs){const m=d.split("/"),y=m.pop();let b=u;for(const v of m)b[v]=b[v]||{},b=b[v];b[y]=h}return u}catch(l){throw l.caller="git.getRemoteInfo",l}}function eZ(e,t,n,r){const s=[];for(const[i,a]of e.refs){if(t&&!i.startsWith(t))continue;if(i.endsWith("^{}")){if(r){const l=i.replace("^{}",""),c=s[s.length-1],u=c.ref===l?c:s.find(d=>d.ref===l);if(u===void 0)throw new Error("I did not expect this to happen");u.peeled=a}continue}const o={ref:i,oid:a};n&&e.symrefs.has(i)&&(o.target=e.symrefs.get(i)),s.push(o)}return s}async function $ke({http:e,onAuth:t,onAuthSuccess:n,onAuthFailure:r,corsProxy:s,url:i,headers:a={},forPush:o=!1,protocolVersion:l=2}){try{ct("http",e),ct("url",i);const u=await eT.getRemoteHelperFor({url:i}).discover({http:e,onAuth:t,onAuthSuccess:n,onAuthFailure:r,corsProxy:s,service:o?"git-receive-pack":"git-upload-pack",url:i,headers:a,protocolVersion:l});if(u.protocolVersion===2)return{protocolVersion:u.protocolVersion,capabilities:u.capabilities2};const d={};for(const h of u.capabilities){const[m,y]=h.split("=");y?d[m]=y:d[m]=!0}return{protocolVersion:1,capabilities:d,refs:eZ(u,void 0,!0,!0)}}catch(c){throw c.caller="git.getRemoteInfo2",c}}async function zke({type:e,object:t,format:n="content",oid:r=void 0}){return n!=="deflated"&&(n!=="wrapped"&&(t=Yy.wrap({type:e,object:t})),r=await Hd(t)),{oid:r,object:t}}async function Uke({object:e}){try{ct("object",e),typeof e=="string"?e=ln.from(e,"utf8"):e=ln.from(e);const t="blob",{oid:n,object:r}=await zke({type:"blob",format:"content",object:e});return{oid:n,type:t,object:new Uint8Array(r),format:"wrapped"}}catch(t){throw t.caller="git.hashBlob",t}}async function qke({fs:e,cache:t,onProgress:n,dir:r,gitdir:s,filepath:i}){try{i=$t.join(r,i);const a=await e.read(i),o=c=>Ys({fs:e,cache:t,gitdir:s,oid:c}),l=await ay.fromPack({pack:a,getExternalRefDelta:o,onProgress:n});return await e.write(i.replace(/\.pack$/,".idx"),await l.toBuffer()),{oids:[...l.hashes]}}catch(a){throw a.caller="git.indexPack",a}}async function Vke({fs:e,onProgress:t,dir:n,gitdir:r=$t.join(n,".git"),filepath:s,cache:i={}}){try{return ct("fs",e),ct("dir",n),ct("gitdir",n),ct("filepath",s),await qke({fs:new Cn(e),cache:i,onProgress:t,dir:n,gitdir:r,filepath:s})}catch(a){throw a.caller="git.indexPack",a}}async function Wke({fs:e,bare:t=!1,dir:n,gitdir:r=t?n:$t.join(n,".git"),defaultBranch:s="master"}){try{return ct("fs",e),ct("gitdir",r),t||ct("dir",n),await ZY({fs:new Cn(e),bare:t,dir:n,gitdir:r,defaultBranch:s})}catch(i){throw i.caller="git.init",i}}async function tZ({fs:e,cache:t,gitdir:n,oid:r,ancestor:s,depth:i}){const a=await lw.read({fs:e,gitdir:n});if(!r)throw new No("oid");if(!s)throw new No("ancestor");if(r===s)return!1;const o=[r],l=new Set;let c=0;for(;o.length;){if(c++===i)throw new A1(i);const u=o.shift(),{type:d,object:h}=await Ys({fs:e,cache:t,gitdir:n,oid:u});if(d!=="commit")throw new uo(u,d,"commit");const m=Ks.from(h).parse();for(const y of m.parent)if(y===s)return!0;if(!a.has(u))for(const y of m.parent)l.has(y)||(o.push(y),l.add(y))}return!1}async function Hke({fs:e,dir:t,gitdir:n=$t.join(t,".git"),oid:r,ancestor:s,depth:i=-1,cache:a={}}){try{return ct("fs",e),ct("gitdir",n),ct("oid",r),ct("ancestor",s),await tZ({fs:new Cn(e),cache:a,gitdir:n,oid:r,ancestor:s,depth:i})}catch(o){throw o.caller="git.isDescendent",o}}async function Gke({fs:e,dir:t,gitdir:n=$t.join(t,".git"),filepath:r}){try{return ct("fs",e),ct("dir",t),ct("gitdir",n),ct("filepath",r),Qy.isIgnored({fs:new Cn(e),dir:t,gitdir:n,filepath:r})}catch(s){throw s.caller="git.isIgnored",s}}async function Kke({fs:e,dir:t,gitdir:n=$t.join(t,".git"),remote:r}){try{return ct("fs",e),ct("gitdir",n),Kt.listBranches({fs:new Cn(e),gitdir:n,remote:r})}catch(s){throw s.caller="git.listBranches",s}}async function Yke({fs:e,gitdir:t,ref:n,cache:r}){if(n){const s=await Kt.resolve({gitdir:t,fs:e,ref:n}),i=[];return await nZ({fs:e,cache:r,gitdir:t,oid:s,filenames:i,prefix:""}),i}else return oa.acquire({fs:e,gitdir:t,cache:r},async function(s){return s.entries.map(i=>i.path)})}async function nZ({fs:e,cache:t,gitdir:n,oid:r,filenames:s,prefix:i}){const{tree:a}=await eb({fs:e,cache:t,gitdir:n,oid:r});for(const o of a)o.type==="tree"?await nZ({fs:e,cache:t,gitdir:n,oid:o.oid,filenames:s,prefix:$t.join(i,o.path)}):s.push($t.join(i,o.path))}async function Zke({fs:e,dir:t,gitdir:n=$t.join(t,".git"),ref:r,cache:s={}}){try{return ct("fs",e),ct("gitdir",n),await Yke({fs:new Cn(e),cache:s,gitdir:n,ref:r})}catch(i){throw i.caller="git.listFiles",i}}async function Xke({fs:e,cache:t,gitdir:n,ref:r}){let s;try{s=await Kt.resolve({gitdir:n,fs:e,ref:r})}catch(o){if(o instanceof Ts)return[]}return(await eb({fs:e,cache:t,gitdir:n,oid:s})).tree.map(o=>({target:o.path,note:o.oid}))}async function Jke({fs:e,dir:t,gitdir:n=$t.join(t,".git"),ref:r="refs/notes/commits",cache:s={}}){try{return ct("fs",e),ct("gitdir",n),ct("ref",r),await Xke({fs:new Cn(e),cache:s,gitdir:n,ref:r})}catch(i){throw i.caller="git.listNotes",i}}async function Qke({fs:e,dir:t,gitdir:n=$t.join(t,".git"),filepath:r}){try{return ct("fs",e),ct("gitdir",n),Kt.listRefs({fs:new Cn(e),gitdir:n,filepath:r})}catch(s){throw s.caller="git.listRefs",s}}async function eEe({fs:e,gitdir:t}){const n=await Mi.get({fs:e,gitdir:t}),r=await n.getSubsections("remote");return Promise.all(r.map(async i=>{const a=await n.get(`remote.${i}.url`);return{remote:i,url:a}}))}async function tEe({fs:e,dir:t,gitdir:n=$t.join(t,".git")}){try{return ct("fs",e),ct("gitdir",n),await eEe({fs:new Cn(e),gitdir:n})}catch(r){throw r.caller="git.listRemotes",r}}async function nEe(e){const t=pi.streamReader(e),n=[];let r;for(;r=await t(),r!==!0;){if(r===null)continue;r=r.toString("utf8").replace(/\n$/,"");const[s,i,...a]=r.split(" "),o={ref:i,oid:s};for(const l of a){const[c,u]=l.split(":");c==="symref-target"?o.target=u:c==="peeled"&&(o.peeled=u)}n.push(o)}return n}async function rEe({prefix:e,symrefs:t,peelTags:n}){const r=[];return r.push(pi.encode(`command=ls-refs
`)),r.push(pi.encode(`agent=${tT.agent}
`)),(n||t||e)&&r.push(pi.delim()),n&&r.push(pi.encode("peel")),t&&r.push(pi.encode("symrefs")),e&&r.push(pi.encode(`ref-prefix ${e}`)),r.push(pi.flush()),r}async function sEe({http:e,onAuth:t,onAuthSuccess:n,onAuthFailure:r,corsProxy:s,url:i,headers:a={},forPush:o=!1,protocolVersion:l=2,prefix:c,symrefs:u,peelTags:d}){try{ct("http",e),ct("url",i);const h=await XC.discover({http:e,onAuth:t,onAuthSuccess:n,onAuthFailure:r,corsProxy:s,service:o?"git-receive-pack":"git-upload-pack",url:i,headers:a,protocolVersion:l});if(h.protocolVersion===1)return eZ(h,c,u,d);const m=await rEe({prefix:c,symrefs:u,peelTags:d}),y=await XC.connect({http:e,auth:h.auth,headers:a,corsProxy:s,service:o?"git-receive-pack":"git-upload-pack",url:i,body:m});return nEe(y.body)}catch(h){throw h.caller="git.listServerRefs",h}}async function iEe({fs:e,dir:t,gitdir:n=$t.join(t,".git")}){try{return ct("fs",e),ct("gitdir",n),Kt.listTags({fs:new Cn(e),gitdir:n})}catch(r){throw r.caller="git.listTags",r}}function aEe(e,t){return e.committer.timestamp-t.committer.timestamp}const oEe="e69de29bb2d1d6434b8b29ae775ad8c2e48c5391";async function Cz({fs:e,cache:t,gitdir:n,oid:r,fileId:s}){if(s===oEe)return;const i=r;let a;const o=await cy({fs:e,cache:t,gitdir:n,oid:r}),l=o.tree;return s===o.oid?a=o.path:(a=await rZ({fs:e,cache:t,gitdir:n,tree:l,fileId:s,oid:i}),Array.isArray(a)&&(a.length===0?a=void 0:a.length===1&&(a=a[0]))),a}async function rZ({fs:e,cache:t,gitdir:n,tree:r,fileId:s,oid:i,filepaths:a=[],parentPath:o=""}){const l=r.entries().map(function(c){let u;return c.oid===s?(u=$t.join(o,c.path),a.push(u)):c.type==="tree"&&(u=Ys({fs:e,cache:t,gitdir:n,oid:c.oid}).then(function({object:d}){return rZ({fs:e,cache:t,gitdir:n,tree:Oo.from(d),fileId:s,oid:i,filepaths:a,parentPath:$t.join(o,c.path)})})),u});return await Promise.all(l),a}async function lEe({fs:e,cache:t,gitdir:n,filepath:r,ref:s,depth:i,since:a,force:o,follow:l}){const c=typeof a>"u"?void 0:Math.floor(a.valueOf()/1e3),u=[],d=await lw.read({fs:e,gitdir:n}),h=await Kt.resolve({fs:e,gitdir:n,ref:s}),m=[await dy({fs:e,cache:t,gitdir:n,oid:h})];let y,b,v;function x(w){v&&r&&u.push(w)}for(;m.length>0;){const w=m.pop();if(c!==void 0&&w.commit.committer.timestamp<=c)break;if(r){let S;try{S=await D1({fs:e,cache:t,gitdir:n,oid:w.commit.tree,filepath:r}),b&&y!==S&&u.push(b),y=S,b=w,v=!0}catch(C){if(C instanceof Ts){let k=l&&y;if(k&&(k=await Cz({fs:e,cache:t,gitdir:n,oid:w.commit.tree,fileId:y}),k))if(Array.isArray(k)){if(b){const A=await Cz({fs:e,cache:t,gitdir:n,oid:b.commit.tree,fileId:y});if(Array.isArray(A))if(k=k.filter(R=>A.indexOf(R)===-1),k.length===1)k=k[0],r=k,b&&u.push(b);else{k=!1,b&&u.push(b);break}}}else r=k,b&&u.push(b);if(!k){if(v&&y&&(u.push(b),!o))break;if(!o&&!l)throw C}b=w,v=!1}else throw C}}else u.push(w);if(i!==void 0&&u.length===i){x(w);break}if(!d.has(w.oid))for(const S of w.commit.parent){const C=await dy({fs:e,cache:t,gitdir:n,oid:S});m.map(k=>k.oid).includes(C.oid)||m.push(C)}m.length===0&&x(w),m.sort((S,C)=>aEe(S.commit,C.commit))}return u}async function cEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),filepath:r,ref:s="HEAD",depth:i,since:a,force:o,follow:l,cache:c={}}){try{return ct("fs",e),ct("gitdir",n),ct("ref",s),await lEe({fs:new Cn(e),cache:c,gitdir:n,filepath:r,ref:s,depth:i,since:a,force:o,follow:l})}catch(u){throw u.caller="git.log",u}}async function uEe({fs:e,onSign:t,dir:n,gitdir:r=$t.join(n,".git"),ours:s,theirs:i,fastForward:a=!0,fastForwardOnly:o=!1,dryRun:l=!1,noUpdateBranch:c=!1,abortOnConflict:u=!0,message:d,author:h,committer:m,signingKey:y,cache:b={},mergeDriver:v}){try{ct("fs",e),y&&ct("onSign",t);const x=new Cn(e),w=await Th({fs:x,gitdir:r,author:h});if(!w&&(!o||!a))throw new Ba("author");const S=await uy({fs:x,gitdir:r,author:w,committer:m});if(!S&&(!o||!a))throw new Ba("committer");return await XY({fs:x,cache:b,dir:n,gitdir:r,ours:s,theirs:i,fastForward:a,fastForwardOnly:o,dryRun:l,noUpdateBranch:c,abortOnConflict:u,message:d,author:w,committer:S,signingKey:y,onSign:t,mergeDriver:v})}catch(x){throw x.caller="git.merge",x}}const dEe={commit:16,tree:32,blob:48,tag:64,ofs_delta:96,ref_delta:112};async function sZ({fs:e,cache:t,dir:n,gitdir:r=$t.join(n,".git"),oids:s}){const i=new wY,a=[];function o(u,d){const h=ln.from(u,d);a.push(h),i.update(h)}async function l({stype:u,object:d}){const h=dEe[u];let m=d.length,y=m>15?128:0;const b=m&15;m=m>>>4;let v=(y|h|b).toString(16);for(o(v,"hex");y;)y=m>127?128:0,v=y|m&127,o(Nj(2,v),"hex"),m=m>>>7;o(ln.from(await FY(d)))}o("PACK"),o("00000002","hex"),o(Nj(8,s.length),"hex");for(const u of s){const{type:d,object:h}=await Ys({fs:e,cache:t,gitdir:r,oid:u});await l({object:h,stype:d})}const c=i.digest();return a.push(c),a}async function fEe({fs:e,cache:t,gitdir:n,oids:r,write:s}){const i=await sZ({fs:e,cache:t,gitdir:n,oids:r}),a=ln.from(await ZC(i)),l=`pack-${a.slice(-20).toString("hex")}.pack`;return s?(await e.write($t.join(n,`objects/pack/${l}`),a),{filename:l}):{filename:l,packfile:new Uint8Array(a)}}async function hEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),oids:r,write:s=!1,cache:i={}}){try{return ct("fs",e),ct("gitdir",n),ct("oids",r),await fEe({fs:new Cn(e),cache:i,gitdir:n,oids:r,write:s})}catch(a){throw a.caller="git.packObjects",a}}async function pEe({fs:e,http:t,onProgress:n,onMessage:r,onAuth:s,onAuthSuccess:i,onAuthFailure:a,dir:o,gitdir:l=$t.join(o,".git"),ref:c,url:u,remote:d,remoteRef:h,prune:m=!1,pruneTags:y=!1,fastForward:b=!0,fastForwardOnly:v=!1,corsProxy:x,singleBranch:w,headers:S={},author:C,committer:k,signingKey:A,cache:R={}}){try{ct("fs",e),ct("gitdir",l);const N=new Cn(e),I=await Th({fs:N,gitdir:l,author:C});if(!I)throw new Ba("author");const P=await uy({fs:N,gitdir:l,author:I,committer:k});if(!P)throw new Ba("committer");return await JY({fs:N,cache:R,http:t,onProgress:n,onMessage:r,onAuth:s,onAuthSuccess:i,onAuthFailure:a,dir:o,gitdir:l,ref:c,url:u,remote:d,remoteRef:h,fastForward:b,fastForwardOnly:v,corsProxy:x,singleBranch:w,headers:S,author:I,committer:P,signingKey:A,prune:m,pruneTags:y})}catch(N){throw N.caller="git.pull",N}}async function mEe({fs:e,cache:t,dir:n,gitdir:r=$t.join(n,".git"),start:s,finish:i}){const a=await lw.read({fs:e,gitdir:r}),o=new Set,l=new Set;for(const d of s)o.add(await Kt.resolve({fs:e,gitdir:r,ref:d}));for(const d of i)try{const h=await Kt.resolve({fs:e,gitdir:r,ref:d});l.add(h)}catch{}const c=new Set;async function u(d){c.add(d);const{type:h,object:m}=await Ys({fs:e,cache:t,gitdir:r,oid:d});if(h==="tag"){const b=no.from(m).headers().object;return u(b)}if(h!=="commit")throw new uo(d,h,"commit");if(!a.has(d)){const b=Ks.from(m).headers().parent;for(d of b)!l.has(d)&&!c.has(d)&&await u(d)}}for(const d of o)await u(d);return c}async function sI({fs:e,cache:t,dir:n,gitdir:r=$t.join(n,".git"),oids:s}){const i=new Set;async function a(o){if(i.has(o))return;i.add(o);const{type:l,object:c}=await Ys({fs:e,cache:t,gitdir:r,oid:o});if(l==="tag"){const d=no.from(c).headers().object;await a(d)}else if(l==="commit"){const d=Ks.from(c).headers().tree;await a(d)}else if(l==="tree"){const u=Oo.from(c);for(const d of u)d.type==="blob"&&i.add(d.oid),d.type==="tree"&&await a(d.oid)}}for(const o of s)await a(o);return i}async function gEe(e){const t={};let n="";const r=pi.streamReader(e);let s=await r();for(;s!==!0;)s!==null&&(n+=s.toString("utf8")+`
`),s=await r();const i=n.toString("utf8").split(`
`);if(s=i.shift(),!s.startsWith("unpack "))throw new Zm('unpack ok" or "unpack [error message]',s);t.ok=s==="unpack ok",t.ok||(t.error=s.slice(7)),t.refs={};for(const a of i){if(a.trim()==="")continue;const o=a.slice(0,2),l=a.slice(3);let c=l.indexOf(" ");c===-1&&(c=l.length);const u=l.slice(0,c),d=l.slice(c+1);t.refs[u]={ok:o==="ok",error:d}}return t}async function yEe({capabilities:e=[],triplets:t=[]}){const n=[];let r=`\0 ${e.join(" ")}`;for(const s of t)n.push(pi.encode(`${s.oldoid} ${s.oid} ${s.fullRef}${r}
`)),r="";return n.push(pi.flush()),n}async function bEe({fs:e,cache:t,http:n,onProgress:r,onMessage:s,onAuth:i,onAuthSuccess:a,onAuthFailure:o,onPrePush:l,gitdir:c,ref:u,remoteRef:d,remote:h,url:m,force:y=!1,delete:b=!1,corsProxy:v,headers:x={}}){const w=u||await Kh({fs:e,gitdir:c});if(typeof w>"u")throw new No("ref");const S=await Mi.get({fs:e,gitdir:c});h=h||await S.get(`branch.${w}.pushRemote`)||await S.get("remote.pushDefault")||await S.get(`branch.${w}.remote`)||"origin";const C=m||await S.get(`remote.${h}.pushurl`)||await S.get(`remote.${h}.url`);if(typeof C>"u")throw new No("remote OR url");const k=d||await S.get(`branch.${w}.merge`);if(typeof C>"u")throw new No("remoteRef");v===void 0&&(v=await S.get("http.corsProxy"));const A=await Kt.expand({fs:e,gitdir:c,ref:w}),R=b?"0000000000000000000000000000000000000000":await Kt.resolve({fs:e,gitdir:c,ref:A}),N=eT.getRemoteHelperFor({url:C}),I=await N.discover({http:n,onAuth:i,onAuthSuccess:a,onAuthFailure:o,corsProxy:v,service:"git-receive-pack",url:C,headers:x,protocolVersion:1}),P=I.auth;let L;if(!k)L=A;else try{L=await Kt.expandAgainstMap({ref:k,map:I.refs})}catch(ee){if(ee instanceof Ts)L=k.startsWith("refs/")?k:`refs/heads/${k}`;else throw ee}const O=I.refs.get(L)||"0000000000000000000000000000000000000000";if(l&&!await l({remote:h,url:C,localRef:{ref:b?"(delete)":A,oid:R},remoteRef:{ref:L,oid:O}}))throw new Jy;const V=!I.capabilities.has("no-thin");let D=new Set;if(!b){const ee=[...I.refs.values()];let se=new Set;if(O!=="0000000000000000000000000000000000000000"){const pe=await lD({fs:e,cache:t,gitdir:c,oids:[R,O]});for(const ce of pe)ee.push(ce);V&&(se=await sI({fs:e,cache:t,gitdir:c,oids:pe}))}if(!ee.includes(R)){const pe=await mEe({fs:e,cache:t,gitdir:c,start:[R],finish:ee});D=await sI({fs:e,cache:t,gitdir:c,oids:pe})}if(V){try{const pe=await Kt.resolve({fs:e,gitdir:c,ref:`refs/remotes/${h}/HEAD`,depth:2}),{oid:ce}=await Kt.resolveAgainstMap({ref:pe.replace(`refs/remotes/${h}/`,""),fullref:pe,map:I.refs}),Ie=[ce];for(const De of await sI({fs:e,cache:t,gitdir:c,oids:Ie}))se.add(De)}catch{}for(const pe of se)D.delete(pe)}if(R===O&&(y=!0),!y){if(A.startsWith("refs/tags")&&O!=="0000000000000000000000000000000000000000")throw new ly("tag-exists");if(R!=="0000000000000000000000000000000000000000"&&O!=="0000000000000000000000000000000000000000"&&!await tZ({fs:e,cache:t,gitdir:c,oid:R,ancestor:O,depth:-1}))throw new ly("not-fast-forward")}}const Z=GY([...I.capabilities],["report-status","side-band-64k",`agent=${tT.agent}`]),U=await yEe({capabilities:Z,triplets:[{oldoid:O,oid:R,fullRef:L}]}),H=b?[]:await sZ({fs:e,cache:t,gitdir:c,oids:[...D]}),$=await N.connect({http:n,onProgress:r,corsProxy:v,service:"git-receive-pack",url:C,auth:P,headers:x,body:[...U,...H]}),{packfile:ne,progress:W}=await YY.demux($.body);if(s){const ee=KY(W);L1(ee,async se=>{await s(se)})}const Q=await gEe(ne);if($.headers&&(Q.headers=$.headers),h&&Q.ok&&Q.refs[L].ok&&!A.startsWith("refs/tags")){const ee=`refs/remotes/${h}/${L.replace("refs/heads","")}`;b?await Kt.deleteRef({fs:e,gitdir:c,ref:ee}):await Kt.writeRef({fs:e,gitdir:c,ref:ee,value:R})}if(Q.ok&&Object.values(Q.refs).every(ee=>ee.ok))return Q;{const ee=Object.entries(Q.refs).filter(([se,pe])=>!pe.ok).map(([se,pe])=>`
  - ${se}: ${pe.error}`).join("");throw new T1(ee,Q)}}async function vEe({fs:e,http:t,onProgress:n,onMessage:r,onAuth:s,onAuthSuccess:i,onAuthFailure:a,onPrePush:o,dir:l,gitdir:c=$t.join(l,".git"),ref:u,remoteRef:d,remote:h="origin",url:m,force:y=!1,delete:b=!1,corsProxy:v,headers:x={},cache:w={}}){try{return ct("fs",e),ct("http",t),ct("gitdir",c),await bEe({fs:new Cn(e),cache:w,http:t,onProgress:n,onMessage:r,onAuth:s,onAuthSuccess:i,onAuthFailure:a,onPrePush:o,gitdir:c,ref:u,remoteRef:d,remote:h,url:m,force:y,delete:b,corsProxy:v,headers:x})}catch(S){throw S.caller="git.push",S}}async function iZ({fs:e,cache:t,gitdir:n,oid:r}){const{type:s,object:i}=await Ys({fs:e,cache:t,gitdir:n,oid:r});if(s==="tag")return r=no.from(i).parse().object,iZ({fs:e,cache:t,gitdir:n,oid:r});if(s!=="blob")throw new uo(r,s,"blob");return{oid:r,blob:new Uint8Array(i)}}async function aZ({fs:e,cache:t,gitdir:n,oid:r,filepath:s=void 0}){return s!==void 0&&(r=await D1({fs:e,cache:t,gitdir:n,oid:r,filepath:s})),await iZ({fs:e,cache:t,gitdir:n,oid:r})}async function xEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),oid:r,filepath:s,cache:i={}}){try{return ct("fs",e),ct("gitdir",n),ct("oid",r),await aZ({fs:new Cn(e),cache:i,gitdir:n,oid:r,filepath:s})}catch(a){throw a.caller="git.readBlob",a}}async function oZ({fs:e,dir:t,gitdir:n=$t.join(t,".git"),oid:r,cache:s={}}){try{return ct("fs",e),ct("gitdir",n),ct("oid",r),await dy({fs:new Cn(e),cache:s,gitdir:n,oid:r})}catch(i){throw i.caller="git.readCommit",i}}async function wEe({fs:e,cache:t,gitdir:n,ref:r="refs/notes/commits",oid:s}){const i=await Kt.resolve({gitdir:n,fs:e,ref:r}),{blob:a}=await aZ({fs:e,cache:t,gitdir:n,oid:i,filepath:s});return a}async function _Ee({fs:e,dir:t,gitdir:n=$t.join(t,".git"),ref:r="refs/notes/commits",oid:s,cache:i={}}){try{return ct("fs",e),ct("gitdir",n),ct("ref",r),ct("oid",s),await wEe({fs:new Cn(e),cache:i,gitdir:n,ref:r,oid:s})}catch(a){throw a.caller="git.readNote",a}}async function SEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),oid:r,format:s="parsed",filepath:i=void 0,encoding:a=void 0,cache:o={}}){try{ct("fs",e),ct("gitdir",n),ct("oid",r);const l=new Cn(e);i!==void 0&&(r=await D1({fs:l,cache:o,gitdir:n,oid:r,filepath:i}));const u=await Ys({fs:l,cache:o,gitdir:n,oid:r,format:s==="parsed"?"content":s});if(u.oid=r,s==="parsed")switch(u.format="parsed",u.type){case"commit":u.object=Ks.from(u.object).parse();break;case"tree":u.object=Oo.from(u.object).entries();break;case"blob":a?u.object=u.object.toString(a):(u.object=new Uint8Array(u.object),u.format="content");break;case"tag":u.object=no.from(u.object).parse();break;default:throw new uo(u.oid,u.type,"blob|commit|tag|tree")}else(u.format==="deflated"||u.format==="wrapped")&&(u.type=u.format);return u}catch(l){throw l.caller="git.readObject",l}}async function CEe({fs:e,cache:t,gitdir:n,oid:r}){const{type:s,object:i}=await Ys({fs:e,cache:t,gitdir:n,oid:r,format:"content"});if(s!=="tag")throw new uo(r,s,"tag");const a=no.from(i);return{oid:r,tag:a.parse(),payload:a.payload()}}async function kEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),oid:r,cache:s={}}){try{return ct("fs",e),ct("gitdir",n),ct("oid",r),await CEe({fs:new Cn(e),cache:s,gitdir:n,oid:r})}catch(i){throw i.caller="git.readTag",i}}async function EEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),oid:r,filepath:s=void 0,cache:i={}}){try{return ct("fs",e),ct("gitdir",n),ct("oid",r),await eb({fs:new Cn(e),cache:i,gitdir:n,oid:r,filepath:s})}catch(a){throw a.caller="git.readTree",a}}async function TEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),filepath:r,cache:s={}}){try{ct("fs",e),ct("gitdir",n),ct("filepath",r),await oa.acquire({fs:new Cn(e),gitdir:n,cache:s},async function(i){i.delete({filepath:r})})}catch(i){throw i.caller="git.remove",i}}async function AEe({fs:e,cache:t,onSign:n,gitdir:r,ref:s="refs/notes/commits",oid:i,author:a,committer:o,signingKey:l}){let c;try{c=await Kt.resolve({gitdir:r,fs:e,ref:s})}catch(y){if(!(y instanceof Ts))throw y}let d=(await eb({fs:e,gitdir:r,oid:c||"4b825dc642cb6eb9a060e54bf8d69288fbee4904"})).tree;d=d.filter(y=>y.path!==i);const h=await F1({fs:e,gitdir:r,tree:d});return await QE({fs:e,cache:t,onSign:n,gitdir:r,ref:s,tree:h,parent:c&&[c],message:`Note removed by 'isomorphic-git removeNote'
`,author:a,committer:o,signingKey:l})}async function REe({fs:e,onSign:t,dir:n,gitdir:r=$t.join(n,".git"),ref:s="refs/notes/commits",oid:i,author:a,committer:o,signingKey:l,cache:c={}}){try{ct("fs",e),ct("gitdir",r),ct("oid",i);const u=new Cn(e),d=await Th({fs:u,gitdir:r,author:a});if(!d)throw new Ba("author");const h=await uy({fs:u,gitdir:r,author:d,committer:o});if(!h)throw new Ba("committer");return await AEe({fs:u,cache:c,onSign:t,gitdir:r,ref:s,oid:i,author:d,committer:h,signingKey:l})}catch(u){throw u.caller="git.removeNote",u}}async function NEe({fs:e,gitdir:t,oldref:n,ref:r,checkout:s=!1}){if(r!==gu.clean(r))throw new Dc(r,gu.clean(r));if(n!==gu.clean(n))throw new Dc(n,gu.clean(n));const i=`refs/heads/${n}`,a=`refs/heads/${r}`;if(await Kt.exists({fs:e,gitdir:t,ref:a}))throw new Bc("branch",r,!1);const l=await Kt.resolve({fs:e,gitdir:t,ref:i,depth:1});await Kt.writeRef({fs:e,gitdir:t,ref:a,value:l}),await Kt.deleteRef({fs:e,gitdir:t,ref:i});const u=await Kh({fs:e,gitdir:t,fullname:!0})===i;(s||u)&&await Kt.writeSymbolicRef({fs:e,gitdir:t,ref:"HEAD",value:a})}async function MEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),ref:r,oldref:s,checkout:i=!1}){try{return ct("fs",e),ct("gitdir",n),ct("ref",r),ct("oldref",s),await NEe({fs:new Cn(e),gitdir:n,ref:r,oldref:s,checkout:i})}catch(a){throw a.caller="git.renameBranch",a}}async function lZ({gitdir:e,type:t,object:n}){return Hd(Yy.wrap({type:t,object:n}))}async function IEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),filepath:r,ref:s,cache:i={}}){try{ct("fs",e),ct("gitdir",n),ct("filepath",r);const a=new Cn(e);let o,l;try{o=await Kt.resolve({fs:a,gitdir:n,ref:s||"HEAD"})}catch(d){if(s)throw d}if(o)try{o=await D1({fs:a,cache:i,gitdir:n,oid:o,filepath:r})}catch{o=null}let c={ctime:new Date(0),mtime:new Date(0),dev:0,ino:0,mode:0,uid:0,gid:0,size:0};const u=t&&await a.read($t.join(t,r));u&&(l=await lZ({gitdir:n,type:"blob",object:u}),o===l&&(c=await a.lstat($t.join(t,r)))),await oa.acquire({fs:a,gitdir:n,cache:i},async function(d){d.delete({filepath:r}),o&&d.insert({filepath:r,stats:c,oid:o})})}catch(a){throw a.caller="git.reset",a}}async function jEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),ref:r,depth:s}){try{return ct("fs",e),ct("gitdir",n),ct("ref",r),await Kt.resolve({fs:new Cn(e),gitdir:n,ref:r,depth:s})}catch(i){throw i.caller="git.resolveRef",i}}async function PEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),path:r,value:s,append:i=!1}){try{ct("fs",e),ct("gitdir",n),ct("path",r);const a=new Cn(e),o=await Mi.get({fs:a,gitdir:n});i?await o.append(r,s):await o.set(r,s),await Mi.save({fs:a,gitdir:n,config:o})}catch(a){throw a.caller="git.setConfig",a}}async function cZ({fs:e,gitdir:t,commit:n}){const r=Ks.from(n).toObject();return await Uo({fs:e,gitdir:t,type:"commit",object:r,format:"content"})}class JC{static get timezoneOffsetForRefLogEntry(){const t=new Date().getTimezoneOffset(),n=Math.abs(Math.floor(t/60)),r=Math.abs(t%60).toString().padStart(2,"0");return`${t>0?"-":"+"}${n.toString().padStart(2,"0")}${r}`}static createStashReflogEntry(t,n,r){const s=t.name.replace(/\s/g,""),i="0000000000000000000000000000000000000000",a=Math.floor(Date.now()/1e3),o=JC.timezoneOffsetForRefLogEntry;return`${i} ${n} ${s} ${t.email} ${a} ${o}	${r}
`}static getStashReflogEntry(t,n=!1){return t.split(`
`).filter(i=>i).reverse().map((i,a)=>n?`stash@{${a}}: ${i.split("	")[1]}`:i)}}const OEe={stage:Ky,workdir:O1};let iI;async function fy(e,t){return iI===void 0&&(iI=new aw),iI.acquire(e,t)}async function DEe(e,t,n,r,s=null){const i=$t.join(n,r),a=await e.lstat(i);if(!a)throw new Ts(i);if(a.isDirectory())throw new vr(`${i}: file expected, but found directory`);const o=s?await IY({fs:e,gitdir:t,oid:s}):void 0;let l=o?s:void 0;return o||await fy({fs:e,gitdir:t,currentFilepath:i},async()=>{const c=a.isSymbolicLink()?await e.readlink(i).then(LY):await e.read(i);if(c===null)throw new Ts(i);l=await Uo({fs:e,gitdir:t,type:"blob",object:c})}),l}async function FEe({fs:e,dir:t,gitdir:n,entries:r}){async function s(i){if(i.type==="tree"){if(!i.oid){const a=await Promise.all(i.children.map(s));i.oid=await F1({fs:e,gitdir:n,tree:a}),i.mode=16384}}else i.type==="blob"&&(i.oid=await DEe(e,n,t,i.path,i.oid),i.mode=33188);return i.path=i.path.split("/").pop(),i}return Promise.all(r.map(s))}async function kz({fs:e,dir:t,gitdir:n,treePair:r}){const s=r[1]==="stage",i=r.map(m=>typeof m=="string"?OEe[m]():m),a=[],u=await Eh({fs:e,cache:{},dir:t,gitdir:n,trees:i,map:async(m,[y,b])=>{if(!(m==="."||await Qy.isIgnored({fs:e,dir:t,gitdir:n,filepath:m}))&&b)return(!y||await y.oid()!==await b.oid()&&await b.oid()!==void 0)&&a.push([y,b]),{mode:await b.mode(),path:m,oid:await b.oid(),type:await b.type()}},reduce:async(m,y)=>(y=y.filter(Boolean),m?(m.children=y,m):y.length>0?y:void 0),iterate:async(m,y)=>{const b=[];for(const v of y){const[x,w]=v;s?w&&(await e.exists(`${t}/${w.toString()}`)?b.push(v):a.push([null,w])):x&&(w?b.push(v):a.push([x,null]))}return b.length?Promise.all(b.map(m)):[]}});if(a.length===0||u.length===0)return null;const h=(await FEe({fs:e,dir:t,gitdir:n,entries:u})).filter(Boolean).map(m=>({mode:m.mode,path:m.path,oid:m.oid,type:m.type}));return F1({fs:e,gitdir:n,tree:h})}async function LEe({fs:e,dir:t,gitdir:n,stashCommit:r,parentCommit:s,wasStaged:i}){const a=[],o=[],l=await Eh({fs:e,cache:{},dir:t,gitdir:n,trees:[Hl({ref:s}),Hl({ref:r})],map:async(c,[u,d])=>{if(c==="."||await Qy.isIgnored({fs:e,dir:t,gitdir:n,filepath:c}))return;const h=d?await d.type():await u.type();if(h!=="tree"&&h!=="blob")return;if(!d&&u){const y=h==="tree"?"rmdir":"rm";return h==="tree"&&a.push(c),h==="blob"&&i&&o.push({filepath:c,oid:await u.oid()}),{method:y,filepath:c}}const m=await d.oid();if(!u||await u.oid()!==m)return h==="tree"?{method:"mkdir",filepath:c}:(i&&o.push({filepath:c,oid:m,stats:await e.lstat($t.join(t,c))}),{method:"write",filepath:c,oid:m})}});await fy({fs:e,gitdir:n,dirRemoved:a,ops:l},async()=>{for(const c of l){const u=$t.join(t,c.filepath);switch(c.method){case"rmdir":await e.rmdir(u);break;case"mkdir":await e.mkdir(u);break;case"rm":await e.rm(u);break;case"write":if(!a.some(d=>u.startsWith(d))){const{object:d}=await Ys({fs:e,cache:{},gitdir:n,oid:c.oid});await e.exists(u)&&await e.rm(u),await e.write(u,d)}break}}}),await oa.acquire({fs:e,gitdir:n,cache:{}},async c=>{o.forEach(({filepath:u,stats:d,oid:h})=>{c.insert({filepath:u,stats:d,oid:h})})})}class Dd{constructor({fs:t,dir:n,gitdir:r=$t.join(n,".git")}){Object.assign(this,{fs:t,dir:n,gitdir:r,_author:null})}static get refStash(){return"refs/stash"}static get refLogsStash(){return"logs/refs/stash"}get refStashPath(){return $t.join(this.gitdir,Dd.refStash)}get refLogsStashPath(){return $t.join(this.gitdir,Dd.refLogsStash)}async getAuthor(){if(!this._author&&(this._author=await Th({fs:this.fs,gitdir:this.gitdir,author:{}}),!this._author))throw new Ba("author");return this._author}async getStashSHA(t,n){return await this.fs.exists(this.refStashPath)?(n||await this.readStashReflogs({parsed:!1}))[t].split(" ")[1]:null}async writeStashCommit({message:t,tree:n,parent:r}){return cZ({fs:this.fs,gitdir:this.gitdir,commit:{message:t,tree:n,parent:r,author:await this.getAuthor(),committer:await this.getAuthor()}})}async readStashCommit(t){const n=await this.readStashReflogs({parsed:!1});if(t!==0&&(t<0||t>n.length-1))throw new Dc(`stash@${t}`,"number that is in range of [0, num of stash pushed]");const r=await this.getStashSHA(t,n);return r?dy({fs:this.fs,cache:{},gitdir:this.gitdir,oid:r}):{}}async writeStashRef(t){return Kt.writeRef({fs:this.fs,gitdir:this.gitdir,ref:Dd.refStash,value:t})}async writeStashReflogEntry({stashCommit:t,message:n}){const r=await this.getAuthor(),s=JC.createStashReflogEntry(r,t,n),i=this.refLogsStashPath;await fy({filepath:i,entry:s},async()=>{const a=await this.fs.exists(i)?await this.fs.read(i,"utf8"):"";await this.fs.write(i,a+s,"utf8")})}async readStashReflogs({parsed:t=!1}){if(!await this.fs.exists(this.refLogsStashPath))return[];const r=(await this.fs.read(this.refLogsStashPath)).toString();return JC.getStashReflogEntry(r,t)}}async function BEe({fs:e,dir:t,gitdir:n,message:r=""}){const s=new Dd({fs:e,dir:t,gitdir:n});await s.getAuthor();const i=await Kh({fs:e,gitdir:n,fullname:!1}),a=await Kt.resolve({fs:e,gitdir:n,ref:"HEAD"}),l=(await oZ({fs:e,dir:t,gitdir:n,oid:a})).commit.message,c=[a];let u=null,d=Hl({ref:"HEAD"});const h=await kz({fs:e,dir:t,gitdir:n,treePair:[Hl({ref:"HEAD"}),"stage"]});if(h){const v=await s.writeStashCommit({message:`stash-Index: WIP on ${i} - ${new Date().toISOString()}`,tree:h,parent:c});c.push(v),u=h,d=Ky()}const m=await kz({fs:e,dir:t,gitdir:n,treePair:[d,"workdir"]});if(m){const v=await s.writeStashCommit({message:`stash-WorkDir: WIP on ${i} - ${new Date().toISOString()}`,tree:m,parent:[c[c.length-1]]});c.push(v),u=m}if(!u||!h&&!m)throw new Ts("changes, nothing to stash");const y=(r.trim()||`WIP on ${i}`)+`: ${a.substring(0,7)} ${l}`,b=await s.writeStashCommit({message:y,tree:u,parent:c});return await s.writeStashRef(b),await s.writeStashReflogEntry({stashCommit:b,message:y}),await WY({fs:e,dir:t,gitdir:n,ref:i,track:!1,force:!0}),b}async function uZ({fs:e,dir:t,gitdir:n,refIdx:r=0}){const i=await new Dd({fs:e,dir:t,gitdir:n}).readStashCommit(r),{parent:a=null}=i.commit?i.commit:{};if(!(!a||!Array.isArray(a)))for(let o=0;o<a.length-1;o++){const c=(await dy({fs:e,cache:{},gitdir:n,oid:a[o+1]})).commit.message.startsWith("stash-Index");await LEe({fs:e,dir:t,gitdir:n,stashCommit:a[o+1],parentCommit:a[o],wasStaged:c})}}async function dZ({fs:e,dir:t,gitdir:n,refIdx:r=0}){const s=new Dd({fs:e,dir:t,gitdir:n});if(!(await s.readStashCommit(r)).commit)return;const a=s.refStashPath;await fy(a,async()=>{await e.exists(a)&&await e.rm(a)});const o=await s.readStashReflogs({parsed:!1});if(!o.length)return;o.splice(r,1);const l=s.refLogsStashPath;await fy({reflogEntries:o,stashReflogPath:l,stashMgr:s},async()=>{if(o.length){await e.write(l,o.join(`
`),"utf8");const c=o[o.length-1].split(" ")[1];await s.writeStashRef(c)}else await e.rm(l)})}async function $Ee({fs:e,dir:t,gitdir:n}){return new Dd({fs:e,dir:t,gitdir:n}).readStashReflogs({parsed:!0})}async function zEe({fs:e,dir:t,gitdir:n}){const r=new Dd({fs:e,dir:t,gitdir:n}),s=[r.refStashPath,r.refLogsStashPath];await fy(s,async()=>{await Promise.all(s.map(async i=>{if(await e.exists(i))return e.rm(i)}))})}async function UEe({fs:e,dir:t,gitdir:n,refIdx:r=0}){await uZ({fs:e,dir:t,gitdir:n,refIdx:r}),await dZ({fs:e,dir:t,gitdir:n,refIdx:r})}async function qEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),op:r="push",message:s="",refIdx:i=0}){ct("fs",e),ct("dir",t),ct("gitdir",n),ct("op",r);const a={push:BEe,apply:uZ,drop:dZ,list:$Ee,clear:zEe,pop:UEe},o=["apply","drop","pop"];try{const l=new Cn(e);["refs","logs","logs/refs"].map(d=>$t.join(n,d)).forEach(async d=>{await l.exists(d)||await l.mkdir(d)});const u=a[r];if(u){if(o.includes(r)&&i<0)throw new Dc(`stash@${i}`,"number that is in range of [0, num of stash pushed]");return await u({fs:l,dir:t,gitdir:n,message:s,refIdx:i})}throw new Error(`To be implemented: ${r}`)}catch(l){throw l.caller="git.stash",l}}async function VEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),filepath:r,cache:s={}}){try{ct("fs",e),ct("gitdir",n),ct("filepath",r);const i=new Cn(e);if(await Qy.isIgnored({fs:i,gitdir:n,dir:t,filepath:r}))return"ignored";const o=await WEe({fs:i,cache:s,gitdir:n}),l=await fZ({fs:i,cache:s,gitdir:n,tree:o,path:r}),c=await oa.acquire({fs:i,gitdir:n,cache:s},async function(b){for(const v of b)if(v.path===r)return v;return null}),u=await i.lstat($t.join(t,r)),d=l!==null,h=c!==null,m=u!==null,y=async()=>{if(h&&!VC(c,u))return c.oid;{const b=await i.read($t.join(t,r)),v=await lZ({gitdir:n,type:"blob",object:b});return h&&c.oid===v&&u.size!==-1&&oa.acquire({fs:i,gitdir:n,cache:s},async function(x){x.insert({filepath:r,stats:u,oid:v})}),v}};if(!d&&!m&&!h)return"absent";if(!d&&!m&&h)return"*absent";if(!d&&m&&!h)return"*added";if(!d&&m&&h)return await y()===c.oid?"added":"*added";if(d&&!m&&!h)return"deleted";if(d&&!m&&h)return l===c.oid,"*deleted";if(d&&m&&!h)return await y()===l?"*undeleted":"*undeletemodified";if(d&&m&&h){const b=await y();return b===l?b===c.oid?"unmodified":"*unmodified":b===c.oid?"modified":"*modified"}}catch(i){throw i.caller="git.status",i}}async function fZ({fs:e,cache:t,gitdir:n,tree:r,path:s}){typeof s=="string"&&(s=s.split("/"));const i=s.shift();for(const a of r)if(a.path===i){if(s.length===0)return a.oid;const{type:o,object:l}=await Ys({fs:e,cache:t,gitdir:n,oid:a.oid});if(o==="tree"){const c=Oo.from(l);return fZ({fs:e,cache:t,gitdir:n,tree:c,path:s})}if(o==="blob")throw new uo(a.oid,o,"blob",s.join("/"))}return null}async function WEe({fs:e,cache:t,gitdir:n}){let r;try{r=await Kt.resolve({fs:e,gitdir:n,ref:"HEAD"})}catch(i){if(i instanceof Ts)return[]}const{tree:s}=await eb({fs:e,cache:t,gitdir:n,oid:r});return s}async function HEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),ref:r="HEAD",filepaths:s=["."],filter:i,cache:a={},ignored:o=!1}){try{ct("fs",e),ct("gitdir",n),ct("ref",r);const l=new Cn(e);return await Eh({fs:l,cache:a,dir:t,gitdir:n,trees:[Hl({ref:r}),O1(),Ky()],map:async function(c,[u,d,h]){if(!u&&!h&&d&&!o&&await Qy.isIgnored({fs:l,dir:t,filepath:c})||!s.some(A=>VY(c,A)))return null;if(i&&!i(c))return;const[m,y,b]=await Promise.all([u&&u.type(),d&&d.type(),h&&h.type()]),v=[m,y,b].includes("blob");if((m==="tree"||m==="special")&&!v)return;if(m==="commit")return null;if((y==="tree"||y==="special")&&!v)return;if(b==="commit")return null;if((b==="tree"||b==="special")&&!v)return;const x=m==="blob"?await u.oid():void 0,w=b==="blob"?await h.oid():void 0;let S;m!=="blob"&&y==="blob"&&b!=="blob"?S="42":y==="blob"&&(S=await d.oid());const C=[void 0,x,S,w],k=C.map(A=>C.indexOf(A));return k.shift(),[c,...k]}})}catch(l){throw l.caller="git.statusMatrix",l}}async function GEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),ref:r,object:s,force:i=!1}){try{ct("fs",e),ct("gitdir",n),ct("ref",r);const a=new Cn(e);if(r===void 0)throw new No("ref");r=r.startsWith("refs/tags/")?r:`refs/tags/${r}`;const o=await Kt.resolve({fs:a,gitdir:n,ref:s||"HEAD"});if(!i&&await Kt.exists({fs:a,gitdir:n,ref:r}))throw new Bc("tag",r);await Kt.writeRef({fs:a,gitdir:n,ref:r,value:o})}catch(a){throw a.caller="git.tag",a}}async function KEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),cache:r={},filepath:s,oid:i,mode:a,add:o,remove:l,force:c}){try{ct("fs",e),ct("gitdir",n),ct("filepath",s);const u=new Cn(e);if(l)return await oa.acquire({fs:u,gitdir:n,cache:r},async function(h){if(!c){const m=await u.lstat($t.join(t,s));if(m){if(m.isDirectory())throw new kh("directory");return}}h.has({filepath:s})&&h.delete({filepath:s})});let d;if(!i){if(d=await u.lstat($t.join(t,s)),!d)throw new Ts(`file at "${s}" on disk and "remove" not set`);if(d.isDirectory())throw new kh("directory")}return await oa.acquire({fs:u,gitdir:n,cache:r},async function(h){if(!o&&!h.has({filepath:s}))throw new Ts(`file at "${s}" in index and "add" not set`);let m;if(i)m={ctime:new Date(0),mtime:new Date(0),dev:0,ino:0,mode:a,uid:0,gid:0,size:0};else{m=d;const y=m.isSymbolicLink()?await u.readlink($t.join(t,s)):await u.read($t.join(t,s));i=await Uo({fs:u,gitdir:n,type:"blob",format:"content",object:y})}return h.insert({filepath:s,oid:i,stats:m}),i})}catch(u){throw u.caller="git.updateIndex",u}}function YEe(){try{return tT.version}catch(e){throw e.caller="git.version",e}}async function ZEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),trees:r,map:s,reduce:i,iterate:a,cache:o={}}){try{return ct("fs",e),ct("gitdir",n),ct("trees",r),await Eh({fs:new Cn(e),cache:o,dir:t,gitdir:n,trees:r,map:s,reduce:i,iterate:a})}catch(l){throw l.caller="git.walk",l}}async function XEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),blob:r}){try{return ct("fs",e),ct("gitdir",n),ct("blob",r),await Uo({fs:new Cn(e),gitdir:n,type:"blob",object:r,format:"content"})}catch(s){throw s.caller="git.writeBlob",s}}async function JEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),commit:r}){try{return ct("fs",e),ct("gitdir",n),ct("commit",r),await cZ({fs:new Cn(e),gitdir:n,commit:r})}catch(s){throw s.caller="git.writeCommit",s}}async function QEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),type:r,object:s,format:i="parsed",oid:a,encoding:o=void 0}){try{const l=new Cn(e);if(i==="parsed"){switch(r){case"commit":s=Ks.from(s).toObject();break;case"tree":s=Oo.from(s).toObject();break;case"blob":s=ln.from(s,o);break;case"tag":s=no.from(s).toObject();break;default:throw new uo(a||"",r,"blob|commit|tag|tree")}i="content"}return a=await Uo({fs:l,gitdir:n,type:r,object:s,oid:a,format:i}),a}catch(l){throw l.caller="git.writeObject",l}}async function eTe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),ref:r,value:s,force:i=!1,symbolic:a=!1}){try{ct("fs",e),ct("gitdir",n),ct("ref",r),ct("value",s);const o=new Cn(e);if(r!==gu.clean(r))throw new Dc(r,gu.clean(r));if(!i&&await Kt.exists({fs:o,gitdir:n,ref:r}))throw new Bc("ref",r);a?await Kt.writeSymbolicRef({fs:o,gitdir:n,ref:r,value:s}):(s=await Kt.resolve({fs:o,gitdir:n,ref:s}),await Kt.writeRef({fs:o,gitdir:n,ref:r,value:s}))}catch(o){throw o.caller="git.writeRef",o}}async function tTe({fs:e,gitdir:t,tag:n}){const r=no.from(n).toObject();return await Uo({fs:e,gitdir:t,type:"tag",object:r,format:"content"})}async function nTe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),tag:r}){try{return ct("fs",e),ct("gitdir",n),ct("tag",r),await tTe({fs:new Cn(e),gitdir:n,tag:r})}catch(s){throw s.caller="git.writeTag",s}}async function rTe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),tree:r}){try{return ct("fs",e),ct("gitdir",n),ct("tree",r),await F1({fs:new Cn(e),gitdir:n,tree:r})}catch(s){throw s.caller="git.writeTree",s}}var Bi={Errors:MCe,STAGE:Ky,TREE:Hl,WORKDIR:O1,add:YCe,abortMerge:WCe,addNote:XCe,addRemote:JCe,annotatedTag:eke,branch:nke,checkout:WY,clone:pke,commit:mke,getConfig:Dke,getConfigAll:Lke,setConfig:PEe,currentBranch:gke,deleteBranch:bke,deleteRef:vke,deleteRemote:wke,deleteTag:Ske,expandOid:Tke,expandRef:Ake,fastForward:Ike,fetch:jke,findMergeBase:Pke,findRoot:Oke,getRemoteInfo:Bke,getRemoteInfo2:$ke,hashBlob:Uke,indexPack:Vke,init:Wke,isDescendent:Hke,isIgnored:Gke,listBranches:Kke,listFiles:Zke,listNotes:Jke,listRefs:Qke,listRemotes:tEe,listServerRefs:sEe,listTags:iEe,log:cEe,merge:uEe,packObjects:hEe,pull:pEe,push:vEe,readBlob:xEe,readCommit:oZ,readNote:_Ee,readObject:SEe,readTag:kEe,readTree:EEe,remove:TEe,removeNote:REe,renameBranch:MEe,resetIndex:IEe,updateIndex:KEe,resolveRef:jEe,status:VEe,statusMatrix:HEe,tag:GEe,version:YEe,walk:ZEe,writeBlob:XEe,writeCommit:JEe,writeObject:QEe,writeRef:eTe,writeTag:nTe,writeTree:rTe,stash:qEe};function sTe(e){let t=[e];return{next(){return Promise.resolve({done:t.length===0,value:t.pop()})},return(){return t=[],{}},[Symbol.asyncIterator](){return this}}}function iTe(e){return e[Symbol.asyncIterator]?e[Symbol.asyncIterator]():e[Symbol.iterator]?e[Symbol.iterator]():e.next?e:sTe(e)}async function aTe(e,t){const n=iTe(e);for(;;){const{value:r,done:s}=await n.next();if(r&&await t(r),s)break}n.return&&n.return()}async function oTe(e){let t=0;const n=[];await aTe(e,i=>{n.push(i),t+=i.byteLength});const r=new Uint8Array(t);let s=0;for(const i of n)r.set(i,s),s+=i.byteLength;return r}function lTe(e){if(e[Symbol.asyncIterator])return e;const t=e.getReader();return{next(){return t.read()},return(){return t.releaseLock(),{}},[Symbol.asyncIterator](){return this}}}async function cTe({onProgress:e,url:t,method:n="GET",headers:r={},body:s}){s&&(s=await oTe(s));const i=await fetch(t,{method:n,headers:r,body:s}),a=i.body&&i.body.getReader?lTe(i.body):[new Uint8Array(await i.arrayBuffer())];r={};for(const[o,l]of i.headers.entries())r[o]=l;return{url:i.url,method:i.method,statusCode:i.status,statusMessage:i.statusText,body:a,headers:r}}var cw={request:cTe};const uw="https://cors.isomorphic-git.org",hy=new Map,hZ=async(e,t)=>{const{gitUserName:n,gitUserEmail:r}=yr.getState();if(!n||!r)return je.error("Git user name and email must be configured in Settings before committing."),!1;try{const s=await Bi.getConfig({fs:t,dir:e,path:"user.name"}).catch(()=>null),i=await Bi.getConfig({fs:t,dir:e,path:"user.email"}).catch(()=>null);return s!==n&&await Bi.setConfig({fs:t,dir:e,path:"user.name",value:n}),i!==r&&await Bi.setConfig({fs:t,dir:e,path:"user.email",value:r}),!0}catch(s){return console.error("[VFS Git Op] Error checking/setting Git config:",s),je.error(`Failed to configure Git user: ${s instanceof Error?s.message:String(s)}`),!1}},dw=async(e,t)=>{const n=new URL(e).origin;if(console.log(`[VFS Git Op] Auth requested for ${e}`),t!=null&&t.username&&(t!=null&&t.password))return console.log(`[VFS Git Op] Using stored credentials for ${e}`),{username:t.username,password:t.password,authScheme:"Basic"};const r=hy.get(n);if(r!=null&&r.username&&(r!=null&&r.password))return console.log(`[VFS Git Op] Using session credentials for ${e}`),{username:r.username,password:r.password,authScheme:"Basic"};console.log(`[VFS Git Op] No stored or session credentials found for ${e}. Prompting user.`);const s=window.prompt(`Enter username for ${e}`);if(!s)return je.error("Authentication cancelled: Username not provided."),null;const i=window.prompt(`Enter password or token for ${s}@${e}`);return i?(hy.set(n,{username:s,password:i}),console.log(`[VFS Git Op] Stored prompted credentials in session for ${n}`),{username:s,password:i,authScheme:"Basic"}):(je.error("Authentication cancelled: Password/token not provided."),null)},fw=(e,t)=>{const n=new URL(e).origin;return console.error(`[VFS Git Op] Auth FAILED for ${e}`,t),hy.has(n)&&(console.log(`[VFS Git Op] Clearing failed session credentials for ${n}`),hy.delete(n)),null},hw=(e,t)=>{console.log(`[VFS Git Op] Auth SUCCESS for ${e}`,t);const n=new URL(e).origin;!hy.has(n)&&t.username&&t.password&&(hy.set(n,{username:t.username,password:t.password}),console.log(`[VFS Git Op] Stored successful prompted credentials in session for ${n}`))},R0=e=>{if(e.name==="HttpError"&&e.data){const{statusCode:t,statusMessage:n,body:r}=e.data;let s="";if(r)try{const i=JSON.parse(r);s=i.message||i.error||JSON.stringify(i)}catch{s=r}return`HTTP ${t} ${n}${s?`: ${s}`:""}`}return e.name==="NotFoundError"?`Not Found: ${e.message}`:e.code==="CheckoutConflictError"?"Checkout conflict: Local changes would be overwritten.":e.code==="MergeConflictError"?"Merge conflict: Resolve conflicts manually.":e instanceof Error?e.message:String(e)},uTe=async(e,t)=>{const n=ca,r=zr(e),s=Pu(r,".git");try{return(await n.promises.stat(s)).isDirectory()}catch(i){return i instanceof Error&&i.code==="ENOENT"||console.error(`[VFS Git Op] Error checking for .git in ${r}:`,i),!1}},pZ=async(e,t,n,r,s)=>{var o;const i=(s==null?void 0:s.fsInstance)??ca,a=zr(e);console.log(`[VFS Git Op] Attempting to clone ${t} into ${a}`);try{let l=!1;try{await i.promises.stat(Pu(a,".git")),l=!0}catch(h){if(h.code!=="ENOENT")throw h}if(l)throw console.warn(`[VFS Git Op] Clone target ${a} already contains a .git directory.`),new Error(`Repository already cloned at ${a}.`);const c=ZE(a);if(c!=="/")try{await i.promises.mkdir(c,{recursive:!0})}catch(h){if(h.code!=="EEXIST")throw h}let u=n;if(!u)try{if(u=(o=(await Bi.getRemoteInfo({http:cw,url:t,corsProxy:uw,onAuth:m=>dw(m,r),onAuthFailure:fw,onAuthSuccess:hw})).HEAD)==null?void 0:o.replace("refs/heads/",""),!u)throw new Error("Could not determine default branch from remote.");console.log(`[VFS Git Op] No branch specified, using remote default: ${u}`)}catch(h){throw console.error("[VFS Git Op] Failed to get remote info to determine default branch:",h),new Error(`Failed to determine default branch: ${R0(h)}`)}await Bi.clone({fs:i,http:cw,dir:a,corsProxy:uw,url:t,ref:u,singleBranch:!0,depth:10,onAuth:h=>dw(h,r),onAuthFailure:fw,onAuthSuccess:hw,onProgress:h=>{h.phase==="counting objects"&&h.total?console.log(`Clone progress: ${h.phase} ${h.loaded}/${h.total}`):h.phase==="receiving objects"&&h.total?console.log(`Clone progress: ${h.phase} ${h.loaded}/${h.total}`):console.log(`Clone progress: ${h.phase}`)}}),await i.promises.stat(Pu(a,".git"));const d=await Bi.currentBranch({fs:i,dir:a,fullname:!1}).catch(()=>null);d!==u&&(console.warn(`[VFS Git Op] Cloned repo HEAD is at ${d}, expected ${u}. Checking out...`),await Bi.checkout({fs:i,dir:a,ref:u})),je.success(`Repository cloned successfully into ${a} (branch: ${u}).`),console.log(`[VFS Git Op] Clone successful for ${t}`)}catch(l){console.error(`[VFS Git Op] Git clone failed for ${t}:`,l);const c=R0(l);if(l instanceof Error&&l.message.includes("already cloned")||je.error(`Git clone failed: ${c}`),!(l instanceof Error&&l.message.includes("already cloned")))try{console.log(`[VFS Git Op] Attempting cleanup of failed clone: ${a}`),await i.promises.rm(a,{recursive:!0,force:!0})}catch(u){console.warn("[VFS Git Op] Failed cleanup after clone error:",u)}throw l}},mZ=async(e,t)=>{const n=(t==null?void 0:t.fsInstance)??ca,r=zr(e);try{await Bi.init({fs:n,dir:r}),je.success(`Initialized empty Git repository in "${gi(r)}"`)}catch(s){throw console.error(`[VFS Git Op] Git init failed for ${r}:`,s),je.error(`Git init failed: ${s instanceof Error?s.message:String(s)}`),s}},cD=async(e,t,n)=>{const r=(n==null?void 0:n.fsInstance)??ca,s=zr(e);try{if(!await hZ(s,r))throw new Error("Git user configuration is missing or invalid.");if(await Bi.add({fs:r,dir:s,filepath:"."}),!(await Bi.statusMatrix({fs:r,dir:s})).some(([,,c])=>c!==0)){je.info("No changes detected to commit.");return}const l=await Bi.commit({fs:r,dir:s,message:t,author:{name:yr.getState().gitUserName,email:yr.getState().gitUserEmail}});je.success(`Changes committed: ${l.substring(0,7)}`)}catch(i){throw console.error(`[VFS Git Op] Git commit failed for ${s}:`,i),je.error(`Git commit failed: ${i instanceof Error?i.message:String(i)}`),i}},nT=async(e,t,n,r)=>{const s=(r==null?void 0:r.fsInstance)??ca,i=zr(e);try{if(!await hZ(i,s))throw new Error("Git user configuration is missing or invalid.");if(!t)throw new Error("Branch name must be provided for pull operation.");console.log(`[VFS Git Op] Pulling branch ${t} for ${i}`);const o=await Bi.currentBranch({fs:s,dir:i,fullname:!1}).catch(()=>null);if(o!==t){console.log(`[VFS Git Op] Current branch is ${o}, switching to ${t} before pull...`);try{await Bi.checkout({fs:s,dir:i,ref:t})}catch(l){if(l.code==="NotFoundError"){console.log(`[VFS Git Op] Local branch ${t} not found. Attempting to fetch and create...`);try{await Bi.fetch({fs:s,http:cw,dir:i,corsProxy:uw,remote:"origin",ref:t,depth:1,singleBranch:!0,tags:!1,onAuth:c=>dw(c,n),onAuthFailure:fw,onAuthSuccess:hw}),await Bi.branch({fs:s,dir:i,ref:t,checkout:!0}),console.log(`[VFS Git Op] Successfully created and checked out local branch ${t}.`)}catch(c){throw console.error(`[VFS Git Op] Failed to create local branch ${t} from remote:`,c),new Error(`Failed to switch to or create local branch "${t}": ${R0(c)}`)}}else throw console.error(`[VFS Git Op] Failed to checkout branch ${t}:`,l),new Error(`Failed to checkout branch "${t}": ${R0(l)}`)}}await Bi.pull({fs:s,http:cw,dir:i,ref:t,singleBranch:!0,author:{name:yr.getState().gitUserName,email:yr.getState().gitUserEmail},corsProxy:uw,onAuth:l=>dw(l,n),onAuthFailure:fw,onAuthSuccess:hw}),je.success(`Pulled changes successfully for "${gi(i)}"`),console.log(`[VFS Git Op] Pull successful for ${i}`)}catch(a){if(console.error(`[VFS Git Op] Git pull failed for ${i}:`,a),a instanceof Error&&a.message.toLowerCase().includes("already up-to-date")?je.info(`Branch "${t}" is already up-to-date.`):je.error(`Git pull failed: ${R0(a)}`),!(a instanceof Error&&a.message.toLowerCase().includes("already up-to-date")))throw a}},uD=async(e,t,n,r)=>{var a,o;const s=(r==null?void 0:r.fsInstance)??ca,i=zr(e);try{if(!t)throw new Error("Branch name must be provided for push operation.");console.log(`[VFS Git Op] Pushing local branch ${t} for ${i}`);const l=await Bi.push({fs:s,http:cw,dir:i,corsProxy:uw,ref:t,remote:"origin",remoteRef:`refs/heads/${t}`,force:!1,onAuth:c=>dw(c,n),onAuthFailure:fw,onAuthSuccess:hw});if(l!=null&&l.ok)je.success(`Pushed changes successfully for "${gi(i)}"`);else if((a=l==null?void 0:l.error)!=null&&a.includes("up-to-date"))je.info(`Branch "${t}" already up-to-date on remote.`);else throw(o=l==null?void 0:l.error)!=null&&o.includes("rejected")?(je.error(`Push rejected for "${gi(i)}". Pull changes first.`),new Error(l.error)):new Error((l==null?void 0:l.error)||"Push rejected by remote")}catch(l){throw console.error(`[VFS Git Op] Git push failed for ${i}:`,l),l instanceof Error&&l.message.includes("rejected")||je.error(`Git push failed: ${R0(l)}`),l}},gZ=async(e,t)=>{const n=(t==null?void 0:t.fsInstance)??ca,r=zr(e);console.log(`[VFS Git Op] Git Status on ${r}`);try{const s=await Bi.statusMatrix({fs:n,dir:r});console.log("Git Status Matrix:",s);const i=s.map(([a,o,l,c])=>{let u="";return c===2&&(u+="INDEX_Modified "),c===3&&(u+="INDEX_Added "),o===0&&l===2?u+="WT_New":o===1&&l===2?u+="WT_Modified":o===1&&l===0?u+="WT_Deleted":o===1&&l===1&&c===0&&(u="Unmodified"),(!u||u==="INDEX_Unmodified ")&&(u=`h:${o} w:${l} s:${c}`),`${a}: ${u.trim()}`}).filter(a=>!a.endsWith("Unmodified")).join(`
`);je.info(`Git Status for "${gi(r)}":
${i||"No changes"}`,{duration:15e3})}catch(s){throw console.error(`[VFS Git Op] Git status failed for ${r}:`,s),je.error(`Git status failed: ${s instanceof Error?s.message:String(s)}`),s}},Em=async(e,t)=>{const n=(t==null?void 0:t.fsInstance)??ca,r=zr(e);if(r!=="/")try{await n.promises.mkdir(r,{recursive:!0})}catch(s){if(s instanceof Error&&s.code==="EEXIST"){console.warn(`[VFS Op] Directory already exists or created concurrently: ${r}`);return}throw console.error(`[VFS Op] Failed to create directory ${r}:`,s),je.error(`Error creating directory "${gi(r)}": ${s instanceof Error?s.message:String(s)}`),s}},dTe=async e=>{try{const t={backend:p2e,name:`litechat_vfs_${e}`};return await a2e(t),ca}catch(t){return console.error(`[VFS Op] Failed to initialize VFS for key "${e}":`,t),je.error(`Failed to initialize filesystem "${e}": ${t instanceof Error?t.message:String(t)}`),null}},dD=async(e,t)=>{const n=(t==null?void 0:t.fsInstance)??ca,r=zr(e);try{try{await n.promises.stat(r)}catch(l){if(l.code==="ENOENT")return console.warn(`[VFS Op] Directory not found for listing, attempting creation: ${r}`),await Em(r,{fsInstance:n}),[];throw l}const i=(await n.promises.readdir(r)).map(async l=>{const c=Pu(r,l);try{const u=await n.promises.stat(c);return{name:l,path:c,isDirectory:u.isDirectory(),size:u.size,lastModified:u.mtime}}catch(u){return console.error(`[VFS Op] Failed to stat ${c}:`,u),null}});return(await Promise.all(i)).filter(l=>l!==null)}catch(s){throw console.error(`[VFS Op] Failed to list directory ${r}:`,s),je.error(`Error listing files: ${s instanceof Error?s.message:String(s)}`),s}},Yh=async(e,t)=>{const n=(t==null?void 0:t.fsInstance)??ca,r=zr(e);try{const s=await n.promises.readFile(r);return Pe.emit(dn.fileRead,{path:r}),s}catch(s){throw console.error(`[VFS Op] Failed to read file ${r}:`,s),je.error(`Error reading file "${gi(r)}": ${s instanceof Error?s.message:String(s)}`),s}},rT=async(e,t,n)=>{const r=(n==null?void 0:n.fsInstance)??ca,s=zr(e),i=ZE(s);try{i!=="/"&&await Em(i,{fsInstance:r}),await r.promises.writeFile(s,t),Pe.emit(dn.fileWritten,{path:s})}catch(a){throw a instanceof Error&&a.message.includes("Error creating directory")||(console.error(`[VFS Op] Failed to write file ${s}:`,a),je.error(`Error writing file "${gi(s)}": ${a instanceof Error?a.message:String(a)}`)),a}},fD=async(e,t=!1,n)=>{const r=(n==null?void 0:n.fsInstance)??ca,s=zr(e);if(s==="/")throw je.error("Cannot delete the root directory."),new Error("Cannot delete the root directory.");try{(await r.promises.stat(s)).isDirectory()?(await r.promises.rm(s,{recursive:t}),Pe.emit(dn.fileDeleted,{path:s})):(await r.promises.unlink(s),Pe.emit(dn.fileDeleted,{path:s})),je.success(`"${gi(s)}" deleted.`)}catch(i){if(i instanceof Error&&i.code==="ENOENT"){console.warn(`[VFS Op] Item not found for deletion: ${s}`);return}throw console.error(`[VFS Op] Failed to delete ${s}:`,i),je.error(`Error deleting "${gi(s)}": ${i instanceof Error?i.message:String(i)}`),i}},yZ=async(e,t)=>{await Em(e,t)},fTe=async(e,t,n)=>{try{const r=await Yh(e,n),s=new Blob([r]),i=URL.createObjectURL(s),a=document.createElement("a");a.href=i;const o=zr(e);a.download=t||gi(o),document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(i)}catch(r){console.error(`[VFS Op] Failed to initiate download for ${e}:`,r),r instanceof Error&&r.message.includes("Error reading file")||je.error(`Download failed: ${r instanceof Error?r.message:String(r)}`)}},bZ=async(e,t,n)=>{const r=(n==null?void 0:n.fsInstance)??ca,s=zr(t);let i=0,a=0;const o=Array.from(e);try{await Em(s,{fsInstance:r});for(const l of o){const c=Pu(s,l.name);try{const u=await l.arrayBuffer();await rT(c,new Uint8Array(u),{fsInstance:r}),i++}catch(u){a++,console.error(`[VFS Op] Failed to upload ${l.name}:`,u)}}}catch(l){a=o.length,console.error(`[VFS Op] Failed to prepare target directory ${s} for upload:`,l)}finally{a>0&&i>0?je.warning(`Upload complete with issues. ${i} succeeded, ${a} failed.`):a===0&&i>0&&je.success(`Successfully uploaded ${i} file(s) to ${s==="/"?"root":gi(s)}.`)}},hTe=async(e,t,n)=>{const r=ca;if(!e.name.toLowerCase().endsWith(".zip")){je.error("Please select a valid ZIP file.");return}const s=zr(t);let i;try{await Em(s,{fsInstance:r}),i=await eD.loadAsync(e);const a=Object.values(i.files),o=await Promise.allSettled(a.map(async d=>{const h=Pu(s,d.name);if(d.dir)await Em(h,{fsInstance:r});else{const m=await d.async("uint8array");await rT(h,m,{fsInstance:r})}return{name:d.name,isDir:d.dir}}));let l=0,c=0,u=0;o.forEach(d=>{d.status==="fulfilled"&&d.value?d.value.isDir?c++:l++:d.status==="rejected"&&(u++,console.error("[VFS Op] ZIP Extraction item failed:",d.reason))}),u>0?je.warning(`Finished extracting "${e.name}". ${l+c} items succeeded, ${u} failed.`):je.success(`Successfully extracted ${l} files and ${c} folders from "${e.name}" to ${s==="/"?"root":gi(s)}.`)}catch(a){a instanceof Error&&a.message.includes("Error creating directory")||(console.error(`[VFS Op] Failed to extract zip ${e.name}:`,a),je.error(`ZIP extraction failed: ${a instanceof Error?a.message:String(a)}`))}},Ez=async(e,t="/",n)=>{const r=ca,s=new eD,i=zr(t),a=gi(i)||"root";try{try{if(!(await r.promises.stat(i)).isDirectory()){je.error(`Cannot export: "${a}" is not a directory.`);return}}catch(h){h instanceof Error&&h.code==="ENOENT"?je.error(`Cannot export: Path "${a}" not found.`):je.error(`Cannot export: Error accessing path "${a}". ${h instanceof Error?h.message:String(h)}`);return}const o=async(h,m)=>{const y=await dD(h,{fsInstance:r});for(const b of y)if(b.isDirectory){if(b.name===".git")continue;const v=m.folder(b.name);if(v)await o(b.path,v);else throw new Error(`Failed to create subfolder ${b.name} in zip.`)}else{const v=await Yh(b.path,{fsInstance:r});m.file(b.name,v)}};await o(i,s);const l=await s.generateAsync({type:"blob"}),c=URL.createObjectURL(l),u=document.createElement("a");u.href=c;const d=`vfs_${a}_export.zip`;u.download=e||d,document.body.appendChild(u),u.click(),document.body.removeChild(u),URL.revokeObjectURL(c),je.success(`"${a}" exported as ${u.download}.`)}catch(o){console.error("[VFS Op] Failed to download all as zip:",o),o instanceof Error&&(o.message.includes("Error listing files")||o.message.includes("Error reading file")||o.message.includes("Cannot export"))||je.error(`ZIP export failed: ${o instanceof Error?o.message:String(o)}`)}},vZ=async(e,t,n)=>{const r=(n==null?void 0:n.fsInstance)??ca,s=zr(e),i=zr(t);if(s==="/"||i==="/")throw je.error("Cannot rename the root directory."),new Error("Cannot rename the root directory.");if(s!==i)try{const a=ZE(i);a!=="/"&&await Em(a,{fsInstance:r}),await r.promises.rename(s,i),je.success(`Renamed "${gi(s)}" to "${gi(i)}"`)}catch(a){throw a instanceof Error&&a.code==="ENOENT"?a.message.includes("Error creating directory")||je.error(`Rename failed: Original item "${gi(s)}" not found.`):a instanceof Error&&a.code==="EEXIST"?je.error(`Rename failed: An item named "${gi(i)}" already exists.`):a instanceof Error&&a.message.includes("Error creating directory")||je.error(`Rename failed: ${a instanceof Error?a.message:String(a)}`),console.error(`[VFS Op] Failed to rename ${s} to ${i}:`,a),a}},pTe=1024*5,mTe=(e,t)=>{try{const n=atob(e),r=new Array(n.length);for(let a=0;a<n.length;a++)r[a]=n.charCodeAt(a);const s=new Uint8Array(r),i=new Blob([s],{type:t});return URL.createObjectURL(i)}catch(n){return console.error("Error creating blob URL from base64:",n),null}},Tz=e=>{let t=null;if(e.contentText!==void 0)t=new Blob([e.contentText],{type:e.type});else if(e.contentBase64!==void 0)try{const n=atob(e.contentBase64),r=new Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);const s=new Uint8Array(r);t=new Blob([s],{type:e.type})}catch(n){return console.error("Failed to reconstruct file from base64:",n),null}return t?new File([t],e.name,{type:e.type}):(console.error(`Failed to reconstruct file "${e.name}": No content found in metadata.`),null)},xZ=({fileMeta:e,onRemove:t,isReadOnly:n=!1})=>{const[r,s]=T.useState(null),[i,a]=T.useState(null),[o,l]=T.useState(!1),[c,u]=T.useState(!1),[d,h]=T.useState(!0),m=e.type||"application/octet-stream",y=Vx(e.name,m),b=m.startsWith("image/"),v=m.startsWith("audio/"),x=m.startsWith("video/"),w=e.source==="vfs";T.useEffect(()=>{let I=null;return a(null),e.source==="direct"&&!y&&e.contentBase64?(I=mTe(e.contentBase64,m),I||a("Failed to decode file content for preview."),s(I)):s(null),e.source==="direct"&&y&&e.contentText&&e.contentText.length>pTe?a(`Text file too large for preview (${(e.size/1024).toFixed(1)} KB).`):e.source==="direct"&&y&&e.contentText===void 0&&a("Text content missing from metadata."),()=>{I&&(URL.revokeObjectURL(I),s(null))}},[e.id,e.size,e.source,e.contentBase64,e.contentText,m,y]);const S=async()=>{if(e.source==="vfs"){je.info("File is already in VFS.");return}const I=Tz(e);if(!I){je.error("Cannot add to VFS: Failed to reconstruct file data.");return}l(!0);try{await bZ([I],"/"),je.success(`"${e.name}" added to VFS root.`)}catch(P){console.error("Failed to add file to VFS:",P),je.error(`Failed to add "${e.name}" to VFS.`)}finally{l(!1)}},C=async()=>{u(!0);try{let I;if(e.source==="vfs"&&e.path){const O=await Yh(e.path);I=new Blob([O],{type:m})}else{const O=Tz(e);if(!O)throw new Error("Could not reconstruct file data.");I=O}const P=URL.createObjectURL(I),L=document.createElement("a");L.href=P,L.download=e.name,document.body.appendChild(L),L.click(),document.body.removeChild(L),URL.revokeObjectURL(P)}catch(I){console.error("Failed to download file:",I),je.error(`Download failed: ${I instanceof Error?I.message:String(I)}`)}finally{u(!1)}},k=()=>h(I=>!I),A=()=>w?f.jsx(DP,{className:"h-5 w-5 text-cyan-500"}):y?f.jsx(lme,{className:"h-5 w-5 text-blue-500"}):b?f.jsx(mm,{className:"h-5 w-5 text-purple-500"}):v?f.jsx(Gme,{className:"h-5 w-5 text-green-500"}):x?f.jsx(Uge,{className:"h-5 w-5 text-orange-500"}):f.jsx(ame,{className:"h-5 w-5 text-muted-foreground"}),R=()=>w?f.jsx("p",{className:"p-2 text-xs text-muted-foreground italic",children:"VFS file attached. Content will be loaded when sent."}):i?f.jsxs("div",{className:"p-2 text-xs text-destructive flex items-center gap-1",children:[f.jsx(Rc,{className:"h-4 w-4"}),f.jsx("span",{children:i})]}):y&&e.contentText!==void 0?f.jsx(zy,{lang:m==="text/markdown"?"markdown":"text",code:e.contentText}):b&&r?f.jsx("img",{src:r,alt:e.name,className:"max-w-full max-h-64 object-contain rounded"}):v&&r?f.jsx("audio",{controls:!0,src:r,className:"w-full",children:"Your browser does not support the audio element."}):x&&r?f.jsx("video",{controls:!0,src:r,className:"max-w-full max-h-64 rounded",children:"Your browser does not support the video tag."}):f.jsx("p",{className:"p-2 text-xs text-muted-foreground italic",children:"Preview not available for this file type or content missing."}),N=T.useMemo(()=>{let I="File";return w?I="VFS File":y?I="Text":b?I="Image":v?I="Audio":x&&(I="Video"),`${I} (${iw(e.size)})`},[w,y,b,v,x,e.size]);return f.jsxs("div",{className:"border rounded-md overflow-hidden bg-card shadow-sm my-1",children:[f.jsxs("div",{className:"flex items-center justify-between p-2 border-b bg-muted/30",children:[f.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[A(),f.jsx("span",{className:"text-sm font-medium truncate",title:e.name,children:e.name}),f.jsxs("span",{className:"text-xs text-muted-foreground flex-shrink-0",children:["(",iw(e.size),")"]}),w&&e.path&&f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsxs("span",{className:"text-xs text-cyan-400 truncate max-w-[100px]",children:["(VFS: ",e.path,")"]})}),f.jsx(Sr,{children:f.jsxs("p",{children:["From VFS: ",e.path]})})]})})]}),f.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(ft,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:C,disabled:c,"aria-label":"Download file",children:c?f.jsx(Qn,{className:"h-3.5 w-3.5 animate-spin"}):f.jsx(xu,{className:"h-3.5 w-3.5"})})}),f.jsx(Sr,{children:"Download File"})]})}),f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(ft,{variant:"ghost",size:"icon",className:"h-6 w-6 text-muted-foreground hover:text-foreground",onClick:k,"aria-label":d?"Unfold preview":"Fold preview",children:f.jsx(cE,{className:"h-3.5 w-3.5"})})}),f.jsx(Sr,{side:"top",children:d?"Unfold":"Fold"})]})}),!n&&t&&f.jsxs(f.Fragment,{children:[e.source==="direct"&&f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(ft,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:S,disabled:o,"aria-label":"Add to VFS",children:o?f.jsx(Qn,{className:"h-3.5 w-3.5 animate-spin"}):f.jsx(jP,{className:"h-3.5 w-3.5"})})}),f.jsx(Sr,{children:"Add to VFS"})]})}),f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(ft,{variant:"ghost",size:"icon",className:"h-6 w-6 text-destructive hover:text-destructive/80",onClick:()=>t(e.id),"aria-label":"Remove file",children:f.jsx(qi,{className:"h-3.5 w-3.5"})})}),f.jsx(Sr,{children:"Remove from Prompt"})]})})]})]})]}),d?f.jsx("div",{className:"p-2 text-xs text-muted-foreground italic cursor-pointer hover:bg-muted/20",onClick:k,children:N}):f.jsx("div",{className:Ze("p-2 max-h-80 overflow-y-auto"),children:R()})]})},wZ=6048e5,gTe=864e5,_Z=6e4,SZ=36e5,LS=43200,Az=1440,Rz=Symbol.for("constructDateFrom");function yi(e,t){return typeof e=="function"?e(t):e&&typeof e=="object"&&Rz in e?e[Rz](t):e instanceof Date?new e.constructor(t):new Date(t)}function qr(e,t){return yi(t||e,e)}function CZ(e,t,n){const r=qr(e,n==null?void 0:n.in);return isNaN(t)?yi(e,NaN):(t&&r.setDate(r.getDate()+t),r)}function kZ(e,t,n){const r=qr(e,n==null?void 0:n.in);if(isNaN(t))return yi(e,NaN);if(!t)return r;const s=r.getDate(),i=yi(e,r.getTime());i.setMonth(r.getMonth()+t+1,0);const a=i.getDate();return s>=a?i:(r.setFullYear(i.getFullYear(),i.getMonth(),s),r)}let yTe={};function tb(){return yTe}function py(e,t){var o,l,c,u;const n=tb(),r=(t==null?void 0:t.weekStartsOn)??((l=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:l.weekStartsOn)??n.weekStartsOn??((u=(c=n.locale)==null?void 0:c.options)==null?void 0:u.weekStartsOn)??0,s=qr(e,t==null?void 0:t.in),i=s.getDay(),a=(i<r?7:0)+i-r;return s.setDate(s.getDate()-a),s.setHours(0,0,0,0),s}function pw(e,t){return py(e,{...t,weekStartsOn:1})}function EZ(e,t){const n=qr(e,t==null?void 0:t.in),r=n.getFullYear(),s=yi(n,0);s.setFullYear(r+1,0,4),s.setHours(0,0,0,0);const i=pw(s),a=yi(n,0);a.setFullYear(r,0,4),a.setHours(0,0,0,0);const o=pw(a);return n.getTime()>=i.getTime()?r+1:n.getTime()>=o.getTime()?r:r-1}function QC(e){const t=qr(e),n=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return n.setUTCFullYear(t.getFullYear()),+e-+n}function Zh(e,...t){const n=yi.bind(null,e||t.find(r=>typeof r=="object"));return t.map(n)}function mw(e,t){const n=qr(e,t==null?void 0:t.in);return n.setHours(0,0,0,0),n}function TZ(e,t,n){const[r,s]=Zh(n==null?void 0:n.in,e,t),i=mw(r),a=mw(s),o=+i-QC(i),l=+a-QC(a);return Math.round((o-l)/gTe)}function bTe(e,t){const n=EZ(e,t),r=yi(e,0);return r.setFullYear(n,0,4),r.setHours(0,0,0,0),pw(r)}function vTe(e,t,n){return CZ(e,t*7,n)}function xTe(e,t,n){return kZ(e,t*12,n)}function wTe(e,t){let n,r=t==null?void 0:t.in;return e.forEach(s=>{!r&&typeof s=="object"&&(r=yi.bind(null,s));const i=qr(s,r);(!n||n<i||isNaN(+i))&&(n=i)}),yi(r,n||NaN)}function _Te(e,t){let n,r=t==null?void 0:t.in;return e.forEach(s=>{!r&&typeof s=="object"&&(r=yi.bind(null,s));const i=qr(s,r);(!n||n>i||isNaN(+i))&&(n=i)}),yi(r,n||NaN)}function R2(e,t){const n=+qr(e)-+qr(t);return n<0?-1:n>0?1:n}function STe(e){return yi(e,Date.now())}function CTe(e,t,n){const[r,s]=Zh(n==null?void 0:n.in,e,t);return+mw(r)==+mw(s)}function AZ(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function kTe(e){return!(!AZ(e)&&typeof e!="number"||isNaN(+qr(e)))}function RZ(e,t,n){const[r,s]=Zh(n==null?void 0:n.in,e,t),i=r.getFullYear()-s.getFullYear(),a=r.getMonth()-s.getMonth();return i*12+a}function ETe(e){return t=>{const r=(e?Math[e]:Math.trunc)(t);return r===0?0:r}}function TTe(e,t){return+qr(e)-+qr(t)}function ATe(e,t){const n=qr(e,t==null?void 0:t.in);return n.setHours(23,59,59,999),n}function NZ(e,t){const n=qr(e,t==null?void 0:t.in),r=n.getMonth();return n.setFullYear(n.getFullYear(),r+1,0),n.setHours(23,59,59,999),n}function RTe(e,t){const n=qr(e,t==null?void 0:t.in);return+ATe(n,t)==+NZ(n,t)}function NTe(e,t,n){const[r,s,i]=Zh(n==null?void 0:n.in,e,e,t),a=R2(s,i),o=Math.abs(RZ(s,i));if(o<1)return 0;s.getMonth()===1&&s.getDate()>27&&s.setDate(30),s.setMonth(s.getMonth()-a*o);let l=R2(s,i)===-a;RTe(r)&&o===1&&R2(r,i)===1&&(l=!1);const c=a*(o-+l);return c===0?0:c}function MTe(e,t,n){const r=TTe(e,t)/1e3;return ETe(n==null?void 0:n.roundingMethod)(r)}function ITe(e,t){const[n,r]=Zh(e,t.start,t.end);return{start:n,end:r}}function jTe(e,t){const{start:n,end:r}=ITe(t==null?void 0:t.in,e);let s=+n>+r;const i=s?+n:+r,a=s?r:n;a.setHours(0,0,0,0),a.setDate(1);let o=1;const l=[];for(;+a<=i;)l.push(yi(n,a)),a.setMonth(a.getMonth()+o);return s?l.reverse():l}function PTe(e,t){const n=qr(e,t==null?void 0:t.in);return n.setDate(1),n.setHours(0,0,0,0),n}function OTe(e,t){const n=qr(e,t==null?void 0:t.in),r=n.getFullYear();return n.setFullYear(r+1,0,0),n.setHours(23,59,59,999),n}function MZ(e,t){const n=qr(e,t==null?void 0:t.in);return n.setFullYear(n.getFullYear(),0,1),n.setHours(0,0,0,0),n}function IZ(e,t){var o,l,c,u;const n=tb(),r=(t==null?void 0:t.weekStartsOn)??((l=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:l.weekStartsOn)??n.weekStartsOn??((u=(c=n.locale)==null?void 0:c.options)==null?void 0:u.weekStartsOn)??0,s=qr(e,t==null?void 0:t.in),i=s.getDay(),a=(i<r?-7:0)+6-(i-r);return s.setDate(s.getDate()+a),s.setHours(23,59,59,999),s}function DTe(e,t){return IZ(e,{...t,weekStartsOn:1})}const FTe={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},LTe=(e,t,n)=>{let r;const s=FTe[e];return typeof s=="string"?r=s:t===1?r=s.one:r=s.other.replace("{{count}}",t.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+r:r+" ago":r};function aI(e){return(t={})=>{const n=t.width?String(t.width):e.defaultWidth;return e.formats[n]||e.formats[e.defaultWidth]}}const BTe={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},$Te={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},zTe={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},UTe={date:aI({formats:BTe,defaultWidth:"full"}),time:aI({formats:$Te,defaultWidth:"full"}),dateTime:aI({formats:zTe,defaultWidth:"full"})},qTe={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},VTe=(e,t,n,r)=>qTe[e];function Nv(e){return(t,n)=>{const r=n!=null&&n.context?String(n.context):"standalone";let s;if(r==="formatting"&&e.formattingValues){const a=e.defaultFormattingWidth||e.defaultWidth,o=n!=null&&n.width?String(n.width):a;s=e.formattingValues[o]||e.formattingValues[a]}else{const a=e.defaultWidth,o=n!=null&&n.width?String(n.width):e.defaultWidth;s=e.values[o]||e.values[a]}const i=e.argumentCallback?e.argumentCallback(t):t;return s[i]}}const WTe={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},HTe={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},GTe={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},KTe={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},YTe={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},ZTe={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},XTe=(e,t)=>{const n=Number(e),r=n%100;if(r>20||r<10)switch(r%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},JTe={ordinalNumber:XTe,era:Nv({values:WTe,defaultWidth:"wide"}),quarter:Nv({values:HTe,defaultWidth:"wide",argumentCallback:e=>e-1}),month:Nv({values:GTe,defaultWidth:"wide"}),day:Nv({values:KTe,defaultWidth:"wide"}),dayPeriod:Nv({values:YTe,defaultWidth:"wide",formattingValues:ZTe,defaultFormattingWidth:"wide"})};function Mv(e){return(t,n={})=>{const r=n.width,s=r&&e.matchPatterns[r]||e.matchPatterns[e.defaultMatchWidth],i=t.match(s);if(!i)return null;const a=i[0],o=r&&e.parsePatterns[r]||e.parsePatterns[e.defaultParseWidth],l=Array.isArray(o)?eAe(o,d=>d.test(a)):QTe(o,d=>d.test(a));let c;c=e.valueCallback?e.valueCallback(l):l,c=n.valueCallback?n.valueCallback(c):c;const u=t.slice(a.length);return{value:c,rest:u}}}function QTe(e,t){for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&t(e[n]))return n}function eAe(e,t){for(let n=0;n<e.length;n++)if(t(e[n]))return n}function tAe(e){return(t,n={})=>{const r=t.match(e.matchPattern);if(!r)return null;const s=r[0],i=t.match(e.parsePattern);if(!i)return null;let a=e.valueCallback?e.valueCallback(i[0]):i[0];a=n.valueCallback?n.valueCallback(a):a;const o=t.slice(s.length);return{value:a,rest:o}}}const nAe=/^(\d+)(th|st|nd|rd)?/i,rAe=/\d+/i,sAe={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},iAe={any:[/^b/i,/^(a|c)/i]},aAe={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},oAe={any:[/1/i,/2/i,/3/i,/4/i]},lAe={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},cAe={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},uAe={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},dAe={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},fAe={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},hAe={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},pAe={ordinalNumber:tAe({matchPattern:nAe,parsePattern:rAe,valueCallback:e=>parseInt(e,10)}),era:Mv({matchPatterns:sAe,defaultMatchWidth:"wide",parsePatterns:iAe,defaultParseWidth:"any"}),quarter:Mv({matchPatterns:aAe,defaultMatchWidth:"wide",parsePatterns:oAe,defaultParseWidth:"any",valueCallback:e=>e+1}),month:Mv({matchPatterns:lAe,defaultMatchWidth:"wide",parsePatterns:cAe,defaultParseWidth:"any"}),day:Mv({matchPatterns:uAe,defaultMatchWidth:"wide",parsePatterns:dAe,defaultParseWidth:"any"}),dayPeriod:Mv({matchPatterns:fAe,defaultMatchWidth:"any",parsePatterns:hAe,defaultParseWidth:"any"})},sT={code:"en-US",formatDistance:LTe,formatLong:UTe,formatRelative:VTe,localize:JTe,match:pAe,options:{weekStartsOn:0,firstWeekContainsDate:1}};function mAe(e,t){const n=qr(e,t==null?void 0:t.in);return TZ(n,MZ(n))+1}function jZ(e,t){const n=qr(e,t==null?void 0:t.in),r=+pw(n)-+bTe(n);return Math.round(r/wZ)+1}function PZ(e,t){var u,d,h,m;const n=qr(e,t==null?void 0:t.in),r=n.getFullYear(),s=tb(),i=(t==null?void 0:t.firstWeekContainsDate)??((d=(u=t==null?void 0:t.locale)==null?void 0:u.options)==null?void 0:d.firstWeekContainsDate)??s.firstWeekContainsDate??((m=(h=s.locale)==null?void 0:h.options)==null?void 0:m.firstWeekContainsDate)??1,a=yi((t==null?void 0:t.in)||e,0);a.setFullYear(r+1,0,i),a.setHours(0,0,0,0);const o=py(a,t),l=yi((t==null?void 0:t.in)||e,0);l.setFullYear(r,0,i),l.setHours(0,0,0,0);const c=py(l,t);return+n>=+o?r+1:+n>=+c?r:r-1}function gAe(e,t){var o,l,c,u;const n=tb(),r=(t==null?void 0:t.firstWeekContainsDate)??((l=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:l.firstWeekContainsDate)??n.firstWeekContainsDate??((u=(c=n.locale)==null?void 0:c.options)==null?void 0:u.firstWeekContainsDate)??1,s=PZ(e,t),i=yi((t==null?void 0:t.in)||e,0);return i.setFullYear(s,0,r),i.setHours(0,0,0,0),py(i,t)}function OZ(e,t){const n=qr(e,t==null?void 0:t.in),r=+py(n,t)-+gAe(n,t);return Math.round(r/wZ)+1}function vs(e,t){const n=e<0?"-":"",r=Math.abs(e).toString().padStart(t,"0");return n+r}const Zf={y(e,t){const n=e.getFullYear(),r=n>0?n:1-n;return vs(t==="yy"?r%100:r,t.length)},M(e,t){const n=e.getMonth();return t==="M"?String(n+1):vs(n+1,2)},d(e,t){return vs(e.getDate(),t.length)},a(e,t){const n=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];case"aaaa":default:return n==="am"?"a.m.":"p.m."}},h(e,t){return vs(e.getHours()%12||12,t.length)},H(e,t){return vs(e.getHours(),t.length)},m(e,t){return vs(e.getMinutes(),t.length)},s(e,t){return vs(e.getSeconds(),t.length)},S(e,t){const n=t.length,r=e.getMilliseconds(),s=Math.trunc(r*Math.pow(10,n-3));return vs(s,t.length)}},Jg={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Nz={G:function(e,t,n){const r=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return n.era(r,{width:"abbreviated"});case"GGGGG":return n.era(r,{width:"narrow"});case"GGGG":default:return n.era(r,{width:"wide"})}},y:function(e,t,n){if(t==="yo"){const r=e.getFullYear(),s=r>0?r:1-r;return n.ordinalNumber(s,{unit:"year"})}return Zf.y(e,t)},Y:function(e,t,n,r){const s=PZ(e,r),i=s>0?s:1-s;if(t==="YY"){const a=i%100;return vs(a,2)}return t==="Yo"?n.ordinalNumber(i,{unit:"year"}):vs(i,t.length)},R:function(e,t){const n=EZ(e);return vs(n,t.length)},u:function(e,t){const n=e.getFullYear();return vs(n,t.length)},Q:function(e,t,n){const r=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(r);case"QQ":return vs(r,2);case"Qo":return n.ordinalNumber(r,{unit:"quarter"});case"QQQ":return n.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(r,{width:"wide",context:"formatting"})}},q:function(e,t,n){const r=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(r);case"qq":return vs(r,2);case"qo":return n.ordinalNumber(r,{unit:"quarter"});case"qqq":return n.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(r,{width:"wide",context:"standalone"})}},M:function(e,t,n){const r=e.getMonth();switch(t){case"M":case"MM":return Zf.M(e,t);case"Mo":return n.ordinalNumber(r+1,{unit:"month"});case"MMM":return n.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(r,{width:"wide",context:"formatting"})}},L:function(e,t,n){const r=e.getMonth();switch(t){case"L":return String(r+1);case"LL":return vs(r+1,2);case"Lo":return n.ordinalNumber(r+1,{unit:"month"});case"LLL":return n.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(r,{width:"wide",context:"standalone"})}},w:function(e,t,n,r){const s=OZ(e,r);return t==="wo"?n.ordinalNumber(s,{unit:"week"}):vs(s,t.length)},I:function(e,t,n){const r=jZ(e);return t==="Io"?n.ordinalNumber(r,{unit:"week"}):vs(r,t.length)},d:function(e,t,n){return t==="do"?n.ordinalNumber(e.getDate(),{unit:"date"}):Zf.d(e,t)},D:function(e,t,n){const r=mAe(e);return t==="Do"?n.ordinalNumber(r,{unit:"dayOfYear"}):vs(r,t.length)},E:function(e,t,n){const r=e.getDay();switch(t){case"E":case"EE":case"EEE":return n.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(r,{width:"short",context:"formatting"});case"EEEE":default:return n.day(r,{width:"wide",context:"formatting"})}},e:function(e,t,n,r){const s=e.getDay(),i=(s-r.weekStartsOn+8)%7||7;switch(t){case"e":return String(i);case"ee":return vs(i,2);case"eo":return n.ordinalNumber(i,{unit:"day"});case"eee":return n.day(s,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(s,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(s,{width:"short",context:"formatting"});case"eeee":default:return n.day(s,{width:"wide",context:"formatting"})}},c:function(e,t,n,r){const s=e.getDay(),i=(s-r.weekStartsOn+8)%7||7;switch(t){case"c":return String(i);case"cc":return vs(i,t.length);case"co":return n.ordinalNumber(i,{unit:"day"});case"ccc":return n.day(s,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(s,{width:"narrow",context:"standalone"});case"cccccc":return n.day(s,{width:"short",context:"standalone"});case"cccc":default:return n.day(s,{width:"wide",context:"standalone"})}},i:function(e,t,n){const r=e.getDay(),s=r===0?7:r;switch(t){case"i":return String(s);case"ii":return vs(s,t.length);case"io":return n.ordinalNumber(s,{unit:"day"});case"iii":return n.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(r,{width:"short",context:"formatting"});case"iiii":default:return n.day(r,{width:"wide",context:"formatting"})}},a:function(e,t,n){const s=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(s,{width:"wide",context:"formatting"})}},b:function(e,t,n){const r=e.getHours();let s;switch(r===12?s=Jg.noon:r===0?s=Jg.midnight:s=r/12>=1?"pm":"am",t){case"b":case"bb":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(s,{width:"wide",context:"formatting"})}},B:function(e,t,n){const r=e.getHours();let s;switch(r>=17?s=Jg.evening:r>=12?s=Jg.afternoon:r>=4?s=Jg.morning:s=Jg.night,t){case"B":case"BB":case"BBB":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(s,{width:"wide",context:"formatting"})}},h:function(e,t,n){if(t==="ho"){let r=e.getHours()%12;return r===0&&(r=12),n.ordinalNumber(r,{unit:"hour"})}return Zf.h(e,t)},H:function(e,t,n){return t==="Ho"?n.ordinalNumber(e.getHours(),{unit:"hour"}):Zf.H(e,t)},K:function(e,t,n){const r=e.getHours()%12;return t==="Ko"?n.ordinalNumber(r,{unit:"hour"}):vs(r,t.length)},k:function(e,t,n){let r=e.getHours();return r===0&&(r=24),t==="ko"?n.ordinalNumber(r,{unit:"hour"}):vs(r,t.length)},m:function(e,t,n){return t==="mo"?n.ordinalNumber(e.getMinutes(),{unit:"minute"}):Zf.m(e,t)},s:function(e,t,n){return t==="so"?n.ordinalNumber(e.getSeconds(),{unit:"second"}):Zf.s(e,t)},S:function(e,t){return Zf.S(e,t)},X:function(e,t,n){const r=e.getTimezoneOffset();if(r===0)return"Z";switch(t){case"X":return Iz(r);case"XXXX":case"XX":return qp(r);case"XXXXX":case"XXX":default:return qp(r,":")}},x:function(e,t,n){const r=e.getTimezoneOffset();switch(t){case"x":return Iz(r);case"xxxx":case"xx":return qp(r);case"xxxxx":case"xxx":default:return qp(r,":")}},O:function(e,t,n){const r=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+Mz(r,":");case"OOOO":default:return"GMT"+qp(r,":")}},z:function(e,t,n){const r=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+Mz(r,":");case"zzzz":default:return"GMT"+qp(r,":")}},t:function(e,t,n){const r=Math.trunc(+e/1e3);return vs(r,t.length)},T:function(e,t,n){return vs(+e,t.length)}};function Mz(e,t=""){const n=e>0?"-":"+",r=Math.abs(e),s=Math.trunc(r/60),i=r%60;return i===0?n+String(s):n+String(s)+t+vs(i,2)}function Iz(e,t){return e%60===0?(e>0?"-":"+")+vs(Math.abs(e)/60,2):qp(e,t)}function qp(e,t=""){const n=e>0?"-":"+",r=Math.abs(e),s=vs(Math.trunc(r/60),2),i=vs(r%60,2);return n+s+t+i}const jz=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},DZ=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},yAe=(e,t)=>{const n=e.match(/(P+)(p+)?/)||[],r=n[1],s=n[2];if(!s)return jz(e,t);let i;switch(r){case"P":i=t.dateTime({width:"short"});break;case"PP":i=t.dateTime({width:"medium"});break;case"PPP":i=t.dateTime({width:"long"});break;case"PPPP":default:i=t.dateTime({width:"full"});break}return i.replace("{{date}}",jz(r,t)).replace("{{time}}",DZ(s,t))},bAe={p:DZ,P:yAe},vAe=/^D+$/,xAe=/^Y+$/,wAe=["D","DD","YY","YYYY"];function _Ae(e){return vAe.test(e)}function SAe(e){return xAe.test(e)}function CAe(e,t,n){const r=kAe(e,t,n);if(console.warn(r),wAe.includes(e))throw new RangeError(r)}function kAe(e,t,n){const r=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${r} to the input \`${n}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const EAe=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,TAe=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,AAe=/^'([^]*?)'?$/,RAe=/''/g,NAe=/[a-zA-Z]/;function gw(e,t,n){var u,d,h,m,y,b,v,x;const r=tb(),s=(n==null?void 0:n.locale)??r.locale??sT,i=(n==null?void 0:n.firstWeekContainsDate)??((d=(u=n==null?void 0:n.locale)==null?void 0:u.options)==null?void 0:d.firstWeekContainsDate)??r.firstWeekContainsDate??((m=(h=r.locale)==null?void 0:h.options)==null?void 0:m.firstWeekContainsDate)??1,a=(n==null?void 0:n.weekStartsOn)??((b=(y=n==null?void 0:n.locale)==null?void 0:y.options)==null?void 0:b.weekStartsOn)??r.weekStartsOn??((x=(v=r.locale)==null?void 0:v.options)==null?void 0:x.weekStartsOn)??0,o=qr(e,n==null?void 0:n.in);if(!kTe(o))throw new RangeError("Invalid time value");let l=t.match(TAe).map(w=>{const S=w[0];if(S==="p"||S==="P"){const C=bAe[S];return C(w,s.formatLong)}return w}).join("").match(EAe).map(w=>{if(w==="''")return{isToken:!1,value:"'"};const S=w[0];if(S==="'")return{isToken:!1,value:MAe(w)};if(Nz[S])return{isToken:!0,value:w};if(S.match(NAe))throw new RangeError("Format string contains an unescaped latin alphabet character `"+S+"`");return{isToken:!1,value:w}});s.localize.preprocessor&&(l=s.localize.preprocessor(o,l));const c={firstWeekContainsDate:i,weekStartsOn:a,locale:s};return l.map(w=>{if(!w.isToken)return w.value;const S=w.value;(!(n!=null&&n.useAdditionalWeekYearTokens)&&SAe(S)||!(n!=null&&n.useAdditionalDayOfYearTokens)&&_Ae(S))&&CAe(S,t,String(e));const C=Nz[S[0]];return C(o,S,s.localize,c)}).join("")}function MAe(e){const t=e.match(AAe);return t?t[1].replace(RAe,"'"):e}function IAe(e,t,n){const r=tb(),s=(n==null?void 0:n.locale)??r.locale??sT,i=2520,a=R2(e,t);if(isNaN(a))throw new RangeError("Invalid time value");const o=Object.assign({},n,{addSuffix:n==null?void 0:n.addSuffix,comparison:a}),[l,c]=Zh(n==null?void 0:n.in,...a>0?[t,e]:[e,t]),u=MTe(c,l),d=(QC(c)-QC(l))/1e3,h=Math.round((u-d)/60);let m;if(h<2)return n!=null&&n.includeSeconds?u<5?s.formatDistance("lessThanXSeconds",5,o):u<10?s.formatDistance("lessThanXSeconds",10,o):u<20?s.formatDistance("lessThanXSeconds",20,o):u<40?s.formatDistance("halfAMinute",0,o):u<60?s.formatDistance("lessThanXMinutes",1,o):s.formatDistance("xMinutes",1,o):h===0?s.formatDistance("lessThanXMinutes",1,o):s.formatDistance("xMinutes",h,o);if(h<45)return s.formatDistance("xMinutes",h,o);if(h<90)return s.formatDistance("aboutXHours",1,o);if(h<Az){const y=Math.round(h/60);return s.formatDistance("aboutXHours",y,o)}else{if(h<i)return s.formatDistance("xDays",1,o);if(h<LS){const y=Math.round(h/Az);return s.formatDistance("xDays",y,o)}else if(h<LS*2)return m=Math.round(h/LS),s.formatDistance("aboutXMonths",m,o)}if(m=NTe(c,l),m<12){const y=Math.round(h/LS);return s.formatDistance("xMonths",y,o)}else{const y=m%12,b=Math.trunc(m/12);return y<3?s.formatDistance("aboutXYears",b,o):y<9?s.formatDistance("overXYears",b,o):s.formatDistance("almostXYears",b+1,o)}}function FZ(e,t){return IAe(e,STe(e),t)}function jAe(e,t){const n=qr(e,t==null?void 0:t.in),r=n.getFullYear(),s=n.getMonth(),i=yi(n,0);return i.setFullYear(r,s+1,0),i.setHours(0,0,0,0),i.getDate()}function PAe(e,t){return qr(e,t==null?void 0:t.in).getMonth()}function OAe(e,t){return qr(e,t==null?void 0:t.in).getFullYear()}function DAe(e,t){return+qr(e)>+qr(t)}function FAe(e,t){return+qr(e)<+qr(t)}function LAe(e,t,n){const[r,s]=Zh(n==null?void 0:n.in,e,t);return r.getFullYear()===s.getFullYear()&&r.getMonth()===s.getMonth()}function BAe(e,t,n){const[r,s]=Zh(n==null?void 0:n.in,e,t);return r.getFullYear()===s.getFullYear()}function $Ae(e,t){const n=()=>yi(t==null?void 0:t.in,NaN),s=VAe(e);let i;if(s.date){const c=WAe(s.date,2);i=HAe(c.restDateString,c.year)}if(!i||isNaN(+i))return n();const a=+i;let o=0,l;if(s.time&&(o=GAe(s.time),isNaN(o)))return n();if(s.timezone){if(l=KAe(s.timezone),isNaN(l))return n()}else{const c=new Date(a+o),u=qr(0,t==null?void 0:t.in);return u.setFullYear(c.getUTCFullYear(),c.getUTCMonth(),c.getUTCDate()),u.setHours(c.getUTCHours(),c.getUTCMinutes(),c.getUTCSeconds(),c.getUTCMilliseconds()),u}return qr(a+o+l,t==null?void 0:t.in)}const BS={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},zAe=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,UAe=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,qAe=/^([+-])(\d{2})(?::?(\d{2}))?$/;function VAe(e){const t={},n=e.split(BS.dateTimeDelimiter);let r;if(n.length>2)return t;if(/:/.test(n[0])?r=n[0]:(t.date=n[0],r=n[1],BS.timeZoneDelimiter.test(t.date)&&(t.date=e.split(BS.timeZoneDelimiter)[0],r=e.substr(t.date.length,e.length))),r){const s=BS.timezone.exec(r);s?(t.time=r.replace(s[1],""),t.timezone=s[1]):t.time=r}return t}function WAe(e,t){const n=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),r=e.match(n);if(!r)return{year:NaN,restDateString:""};const s=r[1]?parseInt(r[1]):null,i=r[2]?parseInt(r[2]):null;return{year:i===null?s:i*100,restDateString:e.slice((r[1]||r[2]).length)}}function HAe(e,t){if(t===null)return new Date(NaN);const n=e.match(zAe);if(!n)return new Date(NaN);const r=!!n[4],s=Iv(n[1]),i=Iv(n[2])-1,a=Iv(n[3]),o=Iv(n[4]),l=Iv(n[5])-1;if(r)return QAe(t,o,l)?YAe(t,o,l):new Date(NaN);{const c=new Date(0);return!XAe(t,i,a)||!JAe(t,s)?new Date(NaN):(c.setUTCFullYear(t,i,Math.max(s,a)),c)}}function Iv(e){return e?parseInt(e):1}function GAe(e){const t=e.match(UAe);if(!t)return NaN;const n=oI(t[1]),r=oI(t[2]),s=oI(t[3]);return eRe(n,r,s)?n*SZ+r*_Z+s*1e3:NaN}function oI(e){return e&&parseFloat(e.replace(",","."))||0}function KAe(e){if(e==="Z")return 0;const t=e.match(qAe);if(!t)return 0;const n=t[1]==="+"?-1:1,r=parseInt(t[2]),s=t[3]&&parseInt(t[3])||0;return tRe(r,s)?n*(r*SZ+s*_Z):NaN}function YAe(e,t,n){const r=new Date(0);r.setUTCFullYear(e,0,4);const s=r.getUTCDay()||7,i=(t-1)*7+n+1-s;return r.setUTCDate(r.getUTCDate()+i),r}const ZAe=[31,null,31,30,31,30,31,31,30,31,30,31];function LZ(e){return e%400===0||e%4===0&&e%100!==0}function XAe(e,t,n){return t>=0&&t<=11&&n>=1&&n<=(ZAe[t]||(LZ(e)?29:28))}function JAe(e,t){return t>=1&&t<=(LZ(e)?366:365)}function QAe(e,t,n){return t>=1&&t<=53&&n>=0&&n<=6}function eRe(e,t,n){return e===24?t===0&&n===0:n>=0&&n<60&&t>=0&&t<60&&e>=0&&e<25}function tRe(e,t){return t>=0&&t<=59}function nRe(e,t,n){const r=qr(e,n==null?void 0:n.in),s=r.getFullYear(),i=r.getDate(),a=yi(e,0);a.setFullYear(s,t,15),a.setHours(0,0,0,0);const o=jAe(a);return r.setMonth(t,Math.min(i,o)),r}function rRe(e,t,n){const r=qr(e,n==null?void 0:n.in);return isNaN(+r)?yi(e,NaN):(r.setFullYear(t),r)}const Dn=({tooltipText:e,icon:t,iconClassName:n,tooltipSide:r="top",onClick:s,disabled:i,variant:a="ghost",size:o="icon",className:l,"aria-label":c,...u})=>{const d=typeof t=="function";return f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(ft,{variant:a,size:o,onClick:s,disabled:i,className:Ze("h-6 w-6",l),"aria-label":c??e,...u,children:d?f.jsx(t,{className:Ze("h-3.5 w-3.5",n)}):t})}),f.jsx(Sr,{side:r,children:f.jsx("p",{children:e})})]})})},Pz={};function sRe(e){let t=Pz[e];if(t)return t;t=Pz[e]=[];for(let n=0;n<128;n++){const r=String.fromCharCode(n);t.push(r)}for(let n=0;n<e.length;n++){const r=e.charCodeAt(n);t[r]="%"+("0"+r.toString(16).toUpperCase()).slice(-2)}return t}function my(e,t){typeof t!="string"&&(t=my.defaultChars);const n=sRe(t);return e.replace(/(%[a-f0-9]{2})+/gi,function(r){let s="";for(let i=0,a=r.length;i<a;i+=3){const o=parseInt(r.slice(i+1,i+3),16);if(o<128){s+=n[o];continue}if((o&224)===192&&i+3<a){const l=parseInt(r.slice(i+4,i+6),16);if((l&192)===128){const c=o<<6&1984|l&63;c<128?s+="��":s+=String.fromCharCode(c),i+=3;continue}}if((o&240)===224&&i+6<a){const l=parseInt(r.slice(i+4,i+6),16),c=parseInt(r.slice(i+7,i+9),16);if((l&192)===128&&(c&192)===128){const u=o<<12&61440|l<<6&4032|c&63;u<2048||u>=55296&&u<=57343?s+="���":s+=String.fromCharCode(u),i+=6;continue}}if((o&248)===240&&i+9<a){const l=parseInt(r.slice(i+4,i+6),16),c=parseInt(r.slice(i+7,i+9),16),u=parseInt(r.slice(i+10,i+12),16);if((l&192)===128&&(c&192)===128&&(u&192)===128){let d=o<<18&1835008|l<<12&258048|c<<6&4032|u&63;d<65536||d>1114111?s+="����":(d-=65536,s+=String.fromCharCode(55296+(d>>10),56320+(d&1023))),i+=9;continue}}s+="�"}return s})}my.defaultChars=";/?:@&=+$,#";my.componentChars="";const Oz={};function iRe(e){let t=Oz[e];if(t)return t;t=Oz[e]=[];for(let n=0;n<128;n++){const r=String.fromCharCode(n);/^[0-9a-z]$/i.test(r)?t.push(r):t.push("%"+("0"+n.toString(16).toUpperCase()).slice(-2))}for(let n=0;n<e.length;n++)t[e.charCodeAt(n)]=e[n];return t}function B1(e,t,n){typeof t!="string"&&(n=t,t=B1.defaultChars),typeof n>"u"&&(n=!0);const r=iRe(t);let s="";for(let i=0,a=e.length;i<a;i++){const o=e.charCodeAt(i);if(n&&o===37&&i+2<a&&/^[0-9a-f]{2}$/i.test(e.slice(i+1,i+3))){s+=e.slice(i,i+3),i+=2;continue}if(o<128){s+=r[o];continue}if(o>=55296&&o<=57343){if(o>=55296&&o<=56319&&i+1<a){const l=e.charCodeAt(i+1);if(l>=56320&&l<=57343){s+=encodeURIComponent(e[i]+e[i+1]),i++;continue}}s+="%EF%BF%BD";continue}s+=encodeURIComponent(e[i])}return s}B1.defaultChars=";/?:@&=+$,-_.!~*'()#";B1.componentChars="-_.!~*'()";function hD(e){let t="";return t+=e.protocol||"",t+=e.slashes?"//":"",t+=e.auth?e.auth+"@":"",e.hostname&&e.hostname.indexOf(":")!==-1?t+="["+e.hostname+"]":t+=e.hostname||"",t+=e.port?":"+e.port:"",t+=e.pathname||"",t+=e.search||"",t+=e.hash||"",t}function ek(){this.protocol=null,this.slashes=null,this.auth=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.pathname=null}const aRe=/^([a-z0-9.+-]+:)/i,oRe=/:[0-9]*$/,lRe=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,cRe=["<",">",'"',"`"," ","\r",`
`,"	"],uRe=["{","}","|","\\","^","`"].concat(cRe),dRe=["'"].concat(uRe),Dz=["%","/","?",";","#"].concat(dRe),Fz=["/","?","#"],fRe=255,Lz=/^[+a-z0-9A-Z_-]{0,63}$/,hRe=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,Bz={javascript:!0,"javascript:":!0},$z={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0};function pD(e,t){if(e&&e instanceof ek)return e;const n=new ek;return n.parse(e,t),n}ek.prototype.parse=function(e,t){let n,r,s,i=e;if(i=i.trim(),!t&&e.split("#").length===1){const c=lRe.exec(i);if(c)return this.pathname=c[1],c[2]&&(this.search=c[2]),this}let a=aRe.exec(i);if(a&&(a=a[0],n=a.toLowerCase(),this.protocol=a,i=i.substr(a.length)),(t||a||i.match(/^\/\/[^@\/]+@[^@\/]+/))&&(s=i.substr(0,2)==="//",s&&!(a&&Bz[a])&&(i=i.substr(2),this.slashes=!0)),!Bz[a]&&(s||a&&!$z[a])){let c=-1;for(let y=0;y<Fz.length;y++)r=i.indexOf(Fz[y]),r!==-1&&(c===-1||r<c)&&(c=r);let u,d;c===-1?d=i.lastIndexOf("@"):d=i.lastIndexOf("@",c),d!==-1&&(u=i.slice(0,d),i=i.slice(d+1),this.auth=u),c=-1;for(let y=0;y<Dz.length;y++)r=i.indexOf(Dz[y]),r!==-1&&(c===-1||r<c)&&(c=r);c===-1&&(c=i.length),i[c-1]===":"&&c--;const h=i.slice(0,c);i=i.slice(c),this.parseHost(h),this.hostname=this.hostname||"";const m=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!m){const y=this.hostname.split(/\./);for(let b=0,v=y.length;b<v;b++){const x=y[b];if(x&&!x.match(Lz)){let w="";for(let S=0,C=x.length;S<C;S++)x.charCodeAt(S)>127?w+="x":w+=x[S];if(!w.match(Lz)){const S=y.slice(0,b),C=y.slice(b+1),k=x.match(hRe);k&&(S.push(k[1]),C.unshift(k[2])),C.length&&(i=C.join(".")+i),this.hostname=S.join(".");break}}}}this.hostname.length>fRe&&(this.hostname=""),m&&(this.hostname=this.hostname.substr(1,this.hostname.length-2))}const o=i.indexOf("#");o!==-1&&(this.hash=i.substr(o),i=i.slice(0,o));const l=i.indexOf("?");return l!==-1&&(this.search=i.substr(l),i=i.slice(0,l)),i&&(this.pathname=i),$z[n]&&this.hostname&&!this.pathname&&(this.pathname=""),this};ek.prototype.parseHost=function(e){let t=oRe.exec(e);t&&(t=t[0],t!==":"&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)};const pRe=Object.freeze(Object.defineProperty({__proto__:null,decode:my,encode:B1,format:hD,parse:pD},Symbol.toStringTag,{value:"Module"})),BZ=/[\0-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,$Z=/[\0-\x1F\x7F-\x9F]/,mRe=/[\xAD\u0600-\u0605\u061C\u06DD\u070F\u0890\u0891\u08E2\u180E\u200B-\u200F\u202A-\u202E\u2060-\u2064\u2066-\u206F\uFEFF\uFFF9-\uFFFB]|\uD804[\uDCBD\uDCCD]|\uD80D[\uDC30-\uDC3F]|\uD82F[\uDCA0-\uDCA3]|\uD834[\uDD73-\uDD7A]|\uDB40[\uDC01\uDC20-\uDC7F]/,mD=/[!-#%-\*,-\/:;\?@\[-\]_\{\}\xA1\xA7\xAB\xB6\xB7\xBB\xBF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061D-\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C77\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1B7D\u1B7E\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4F\u2E52-\u2E5D\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]|\uD800[\uDD00-\uDD02\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD803[\uDEAD\uDF55-\uDF59\uDF86-\uDF89]|\uD804[\uDC47-\uDC4D\uDCBB\uDCBC\uDCBE-\uDCC1\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC8\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9]|\uD805[\uDC4B-\uDC4F\uDC5A\uDC5B\uDC5D\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDE60-\uDE6C\uDEB9\uDF3C-\uDF3E]|\uD806[\uDC3B\uDD44-\uDD46\uDDE2\uDE3F-\uDE46\uDE9A-\uDE9C\uDE9E-\uDEA2\uDF00-\uDF09]|\uD807[\uDC41-\uDC45\uDC70\uDC71\uDEF7\uDEF8\uDF43-\uDF4F\uDFFF]|\uD809[\uDC70-\uDC74]|\uD80B[\uDFF1\uDFF2]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3B\uDF44]|\uD81B[\uDE97-\uDE9A\uDFE2]|\uD82F\uDC9F|\uD836[\uDE87-\uDE8B]|\uD83A[\uDD5E\uDD5F]/,zZ=/[\$\+<->\^`\|~\xA2-\xA6\xA8\xA9\xAC\xAE-\xB1\xB4\xB8\xD7\xF7\u02C2-\u02C5\u02D2-\u02DF\u02E5-\u02EB\u02ED\u02EF-\u02FF\u0375\u0384\u0385\u03F6\u0482\u058D-\u058F\u0606-\u0608\u060B\u060E\u060F\u06DE\u06E9\u06FD\u06FE\u07F6\u07FE\u07FF\u0888\u09F2\u09F3\u09FA\u09FB\u0AF1\u0B70\u0BF3-\u0BFA\u0C7F\u0D4F\u0D79\u0E3F\u0F01-\u0F03\u0F13\u0F15-\u0F17\u0F1A-\u0F1F\u0F34\u0F36\u0F38\u0FBE-\u0FC5\u0FC7-\u0FCC\u0FCE\u0FCF\u0FD5-\u0FD8\u109E\u109F\u1390-\u1399\u166D\u17DB\u1940\u19DE-\u19FF\u1B61-\u1B6A\u1B74-\u1B7C\u1FBD\u1FBF-\u1FC1\u1FCD-\u1FCF\u1FDD-\u1FDF\u1FED-\u1FEF\u1FFD\u1FFE\u2044\u2052\u207A-\u207C\u208A-\u208C\u20A0-\u20C0\u2100\u2101\u2103-\u2106\u2108\u2109\u2114\u2116-\u2118\u211E-\u2123\u2125\u2127\u2129\u212E\u213A\u213B\u2140-\u2144\u214A-\u214D\u214F\u218A\u218B\u2190-\u2307\u230C-\u2328\u232B-\u2426\u2440-\u244A\u249C-\u24E9\u2500-\u2767\u2794-\u27C4\u27C7-\u27E5\u27F0-\u2982\u2999-\u29D7\u29DC-\u29FB\u29FE-\u2B73\u2B76-\u2B95\u2B97-\u2BFF\u2CE5-\u2CEA\u2E50\u2E51\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u2FFF\u3004\u3012\u3013\u3020\u3036\u3037\u303E\u303F\u309B\u309C\u3190\u3191\u3196-\u319F\u31C0-\u31E3\u31EF\u3200-\u321E\u322A-\u3247\u3250\u3260-\u327F\u328A-\u32B0\u32C0-\u33FF\u4DC0-\u4DFF\uA490-\uA4C6\uA700-\uA716\uA720\uA721\uA789\uA78A\uA828-\uA82B\uA836-\uA839\uAA77-\uAA79\uAB5B\uAB6A\uAB6B\uFB29\uFBB2-\uFBC2\uFD40-\uFD4F\uFDCF\uFDFC-\uFDFF\uFE62\uFE64-\uFE66\uFE69\uFF04\uFF0B\uFF1C-\uFF1E\uFF3E\uFF40\uFF5C\uFF5E\uFFE0-\uFFE6\uFFE8-\uFFEE\uFFFC\uFFFD]|\uD800[\uDD37-\uDD3F\uDD79-\uDD89\uDD8C-\uDD8E\uDD90-\uDD9C\uDDA0\uDDD0-\uDDFC]|\uD802[\uDC77\uDC78\uDEC8]|\uD805\uDF3F|\uD807[\uDFD5-\uDFF1]|\uD81A[\uDF3C-\uDF3F\uDF45]|\uD82F\uDC9C|\uD833[\uDF50-\uDFC3]|\uD834[\uDC00-\uDCF5\uDD00-\uDD26\uDD29-\uDD64\uDD6A-\uDD6C\uDD83\uDD84\uDD8C-\uDDA9\uDDAE-\uDDEA\uDE00-\uDE41\uDE45\uDF00-\uDF56]|\uD835[\uDEC1\uDEDB\uDEFB\uDF15\uDF35\uDF4F\uDF6F\uDF89\uDFA9\uDFC3]|\uD836[\uDC00-\uDDFF\uDE37-\uDE3A\uDE6D-\uDE74\uDE76-\uDE83\uDE85\uDE86]|\uD838[\uDD4F\uDEFF]|\uD83B[\uDCAC\uDCB0\uDD2E\uDEF0\uDEF1]|\uD83C[\uDC00-\uDC2B\uDC30-\uDC93\uDCA0-\uDCAE\uDCB1-\uDCBF\uDCC1-\uDCCF\uDCD1-\uDCF5\uDD0D-\uDDAD\uDDE6-\uDE02\uDE10-\uDE3B\uDE40-\uDE48\uDE50\uDE51\uDE60-\uDE65\uDF00-\uDFFF]|\uD83D[\uDC00-\uDED7\uDEDC-\uDEEC\uDEF0-\uDEFC\uDF00-\uDF76\uDF7B-\uDFD9\uDFE0-\uDFEB\uDFF0]|\uD83E[\uDC00-\uDC0B\uDC10-\uDC47\uDC50-\uDC59\uDC60-\uDC87\uDC90-\uDCAD\uDCB0\uDCB1\uDD00-\uDE53\uDE60-\uDE6D\uDE70-\uDE7C\uDE80-\uDE88\uDE90-\uDEBD\uDEBF-\uDEC5\uDECE-\uDEDB\uDEE0-\uDEE8\uDEF0-\uDEF8\uDF00-\uDF92\uDF94-\uDFCA]/,UZ=/[ \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000]/,gRe=Object.freeze(Object.defineProperty({__proto__:null,Any:BZ,Cc:$Z,Cf:mRe,P:mD,S:zZ,Z:UZ},Symbol.toStringTag,{value:"Module"})),yRe=new Uint16Array('ᵁ<Õıʊҝջאٵ۞ޢߖࠏ੊ઑඡ๭༉༦჊ረዡᐕᒝᓃᓟᔥ\0\0\0\0\0\0ᕫᛍᦍᰒᷝ὾⁠↰⊍⏀⏻⑂⠤⤒ⴈ⹈⿎〖㊺㘹㞬㣾㨨㩱㫠㬮ࠀEMabcfglmnoprstu\\bfms¦³¹ÈÏlig耻Æ䃆P耻&䀦cute耻Á䃁reve;䄂Āiyx}rc耻Â䃂;䐐r;쀀𝔄rave耻À䃀pha;䎑acr;䄀d;橓Āgp¡on;䄄f;쀀𝔸plyFunction;恡ing耻Å䃅Ācs¾Ãr;쀀𝒜ign;扔ilde耻Ã䃃ml耻Ä䃄ЀaceforsuåûþėĜĢħĪĀcrêòkslash;或Ŷöø;櫧ed;挆y;䐑ƀcrtąċĔause;戵noullis;愬a;䎒r;쀀𝔅pf;쀀𝔹eve;䋘còēmpeq;扎܀HOacdefhilorsuōőŖƀƞƢƵƷƺǜȕɳɸɾcy;䐧PY耻©䂩ƀcpyŝŢźute;䄆Ā;iŧŨ拒talDifferentialD;慅leys;愭ȀaeioƉƎƔƘron;䄌dil耻Ç䃇rc;䄈nint;戰ot;䄊ĀdnƧƭilla;䂸terDot;䂷òſi;䎧rcleȀDMPTǇǋǑǖot;抙inus;抖lus;投imes;抗oĀcsǢǸkwiseContourIntegral;戲eCurlyĀDQȃȏoubleQuote;思uote;怙ȀlnpuȞȨɇɕonĀ;eȥȦ户;橴ƀgitȯȶȺruent;扡nt;戯ourIntegral;戮ĀfrɌɎ;愂oduct;成nterClockwiseContourIntegral;戳oss;樯cr;쀀𝒞pĀ;Cʄʅ拓ap;才րDJSZacefiosʠʬʰʴʸˋ˗ˡ˦̳ҍĀ;oŹʥtrahd;椑cy;䐂cy;䐅cy;䐏ƀgrsʿ˄ˇger;怡r;憡hv;櫤Āayː˕ron;䄎;䐔lĀ;t˝˞戇a;䎔r;쀀𝔇Āaf˫̧Ācm˰̢riticalȀADGT̖̜̀̆cute;䂴oŴ̋̍;䋙bleAcute;䋝rave;䁠ilde;䋜ond;拄ferentialD;慆Ѱ̽\0\0\0͔͂\0Ѕf;쀀𝔻ƀ;DE͈͉͍䂨ot;惜qual;扐blèCDLRUVͣͲ΂ϏϢϸontourIntegraìȹoɴ͹\0\0ͻ»͉nArrow;懓Āeo·ΤftƀARTΐΖΡrrow;懐ightArrow;懔eåˊngĀLRΫτeftĀARγιrrow;柸ightArrow;柺ightArrow;柹ightĀATϘϞrrow;懒ee;抨pɁϩ\0\0ϯrrow;懑ownArrow;懕erticalBar;戥ǹABLRTaВЪаўѿͼrrowƀ;BUНОТ憓ar;椓pArrow;懵reve;䌑eft˒к\0ц\0ѐightVector;楐eeVector;楞ectorĀ;Bљњ憽ar;楖ightǔѧ\0ѱeeVector;楟ectorĀ;BѺѻ懁ar;楗eeĀ;A҆҇护rrow;憧ĀctҒҗr;쀀𝒟rok;䄐ࠀNTacdfglmopqstuxҽӀӄӋӞӢӧӮӵԡԯԶՒ՝ՠեG;䅊H耻Ð䃐cute耻É䃉ƀaiyӒӗӜron;䄚rc耻Ê䃊;䐭ot;䄖r;쀀𝔈rave耻È䃈ement;戈ĀapӺӾcr;䄒tyɓԆ\0\0ԒmallSquare;旻erySmallSquare;斫ĀgpԦԪon;䄘f;쀀𝔼silon;䎕uĀaiԼՉlĀ;TՂՃ橵ilde;扂librium;懌Āci՗՚r;愰m;橳a;䎗ml耻Ë䃋Āipժկsts;戃onentialE;慇ʀcfiosօֈ֍ֲ׌y;䐤r;쀀𝔉lledɓ֗\0\0֣mallSquare;旼erySmallSquare;斪Ͱֺ\0ֿ\0\0ׄf;쀀𝔽All;戀riertrf;愱cò׋؀JTabcdfgorstר׬ׯ׺؀ؒؖ؛؝أ٬ٲcy;䐃耻>䀾mmaĀ;d׷׸䎓;䏜reve;䄞ƀeiy؇،ؐdil;䄢rc;䄜;䐓ot;䄠r;쀀𝔊;拙pf;쀀𝔾eater̀EFGLSTصلَٖٛ٦qualĀ;Lؾؿ扥ess;招ullEqual;执reater;檢ess;扷lantEqual;橾ilde;扳cr;쀀𝒢;扫ЀAacfiosuڅڋږڛڞڪھۊRDcy;䐪Āctڐڔek;䋇;䁞irc;䄤r;愌lbertSpace;愋ǰگ\0ڲf;愍izontalLine;攀Āctۃۅòکrok;䄦mpńېۘownHumðįqual;扏܀EJOacdfgmnostuۺ۾܃܇܎ܚܞܡܨ݄ݸދޏޕcy;䐕lig;䄲cy;䐁cute耻Í䃍Āiyܓܘrc耻Î䃎;䐘ot;䄰r;愑rave耻Ì䃌ƀ;apܠܯܿĀcgܴܷr;䄪inaryI;慈lieóϝǴ݉\0ݢĀ;eݍݎ戬Āgrݓݘral;戫section;拂isibleĀCTݬݲomma;恣imes;恢ƀgptݿރވon;䄮f;쀀𝕀a;䎙cr;愐ilde;䄨ǫޚ\0ޞcy;䐆l耻Ï䃏ʀcfosuެ޷޼߂ߐĀiyޱ޵rc;䄴;䐙r;쀀𝔍pf;쀀𝕁ǣ߇\0ߌr;쀀𝒥rcy;䐈kcy;䐄΀HJacfosߤߨ߽߬߱ࠂࠈcy;䐥cy;䐌ppa;䎚Āey߶߻dil;䄶;䐚r;쀀𝔎pf;쀀𝕂cr;쀀𝒦րJTaceflmostࠥࠩࠬࡐࡣ঳সে্਷ੇcy;䐉耻<䀼ʀcmnpr࠷࠼ࡁࡄࡍute;䄹bda;䎛g;柪lacetrf;愒r;憞ƀaeyࡗ࡜ࡡron;䄽dil;䄻;䐛Āfsࡨ॰tԀACDFRTUVarࡾࢩࢱࣦ࣠ࣼयज़ΐ४Ānrࢃ࢏gleBracket;柨rowƀ;BR࢙࢚࢞憐ar;懤ightArrow;懆eiling;挈oǵࢷ\0ࣃbleBracket;柦nǔࣈ\0࣒eeVector;楡ectorĀ;Bࣛࣜ懃ar;楙loor;挊ightĀAV࣯ࣵrrow;憔ector;楎Āerँगeƀ;AVउऊऐ抣rrow;憤ector;楚iangleƀ;BEतथऩ抲ar;槏qual;抴pƀDTVषूौownVector;楑eeVector;楠ectorĀ;Bॖॗ憿ar;楘ectorĀ;B॥०憼ar;楒ightáΜs̀EFGLSTॾঋকঝঢভqualGreater;拚ullEqual;扦reater;扶ess;檡lantEqual;橽ilde;扲r;쀀𝔏Ā;eঽা拘ftarrow;懚idot;䄿ƀnpw৔ਖਛgȀLRlr৞৷ਂਐeftĀAR০৬rrow;柵ightArrow;柷ightArrow;柶eftĀarγਊightáοightáϊf;쀀𝕃erĀLRਢਬeftArrow;憙ightArrow;憘ƀchtਾੀੂòࡌ;憰rok;䅁;扪Ѐacefiosuਗ਼੝੠੷੼અઋ઎p;椅y;䐜Ādl੥੯iumSpace;恟lintrf;愳r;쀀𝔐nusPlus;戓pf;쀀𝕄cò੶;䎜ҀJacefostuણધભીଔଙඑ඗ඞcy;䐊cute;䅃ƀaey઴હાron;䅇dil;䅅;䐝ƀgswે૰଎ativeƀMTV૓૟૨ediumSpace;怋hiĀcn૦૘ë૙eryThiî૙tedĀGL૸ଆreaterGreateòٳessLesóੈLine;䀊r;쀀𝔑ȀBnptଢନଷ଺reak;恠BreakingSpace;䂠f;愕ڀ;CDEGHLNPRSTV୕ୖ୪୼஡௫ఄ౞಄ದ೘ൡඅ櫬Āou୛୤ngruent;扢pCap;扭oubleVerticalBar;戦ƀlqxஃஊ஛ement;戉ualĀ;Tஒஓ扠ilde;쀀≂̸ists;戄reater΀;EFGLSTஶஷ஽௉௓௘௥扯qual;扱ullEqual;쀀≧̸reater;쀀≫̸ess;批lantEqual;쀀⩾̸ilde;扵umpń௲௽ownHump;쀀≎̸qual;쀀≏̸eĀfsఊధtTriangleƀ;BEచఛడ拪ar;쀀⧏̸qual;括s̀;EGLSTవశ఼ౄోౘ扮qual;扰reater;扸ess;쀀≪̸lantEqual;쀀⩽̸ilde;扴estedĀGL౨౹reaterGreater;쀀⪢̸essLess;쀀⪡̸recedesƀ;ESಒಓಛ技qual;쀀⪯̸lantEqual;拠ĀeiಫಹverseElement;戌ghtTriangleƀ;BEೋೌ೒拫ar;쀀⧐̸qual;拭ĀquೝഌuareSuĀbp೨೹setĀ;E೰ೳ쀀⊏̸qual;拢ersetĀ;Eഃആ쀀⊐̸qual;拣ƀbcpഓതൎsetĀ;Eഛഞ쀀⊂⃒qual;抈ceedsȀ;ESTലള഻െ抁qual;쀀⪰̸lantEqual;拡ilde;쀀≿̸ersetĀ;E൘൛쀀⊃⃒qual;抉ildeȀ;EFT൮൯൵ൿ扁qual;扄ullEqual;扇ilde;扉erticalBar;戤cr;쀀𝒩ilde耻Ñ䃑;䎝܀Eacdfgmoprstuvලෂ෉෕ෛ෠෧෼ขภยา฿ไlig;䅒cute耻Ó䃓Āiy෎ීrc耻Ô䃔;䐞blac;䅐r;쀀𝔒rave耻Ò䃒ƀaei෮ෲ෶cr;䅌ga;䎩cron;䎟pf;쀀𝕆enCurlyĀDQฎบoubleQuote;怜uote;怘;橔Āclวฬr;쀀𝒪ash耻Ø䃘iŬื฼de耻Õ䃕es;樷ml耻Ö䃖erĀBP๋๠Āar๐๓r;怾acĀek๚๜;揞et;掴arenthesis;揜Ҁacfhilors๿ງຊຏຒດຝະ໼rtialD;戂y;䐟r;쀀𝔓i;䎦;䎠usMinus;䂱Āipຢອncareplanåڝf;愙Ȁ;eio຺ູ໠໤檻cedesȀ;EST່້໏໚扺qual;檯lantEqual;扼ilde;找me;怳Ādp໩໮uct;戏ortionĀ;aȥ໹l;戝Āci༁༆r;쀀𝒫;䎨ȀUfos༑༖༛༟OT耻"䀢r;쀀𝔔pf;愚cr;쀀𝒬؀BEacefhiorsu༾གྷཇའཱིྦྷྪྭ႖ႩႴႾarr;椐G耻®䂮ƀcnrཎནབute;䅔g;柫rĀ;tཛྷཝ憠l;椖ƀaeyཧཬཱron;䅘dil;䅖;䐠Ā;vླྀཹ愜erseĀEUྂྙĀlq྇ྎement;戋uilibrium;懋pEquilibrium;楯r»ཹo;䎡ghtЀACDFTUVa࿁࿫࿳ဢဨၛႇϘĀnr࿆࿒gleBracket;柩rowƀ;BL࿜࿝࿡憒ar;懥eftArrow;懄eiling;按oǵ࿹\0စbleBracket;柧nǔည\0နeeVector;楝ectorĀ;Bဝသ懂ar;楕loor;挋Āerိ၃eƀ;AVဵံြ抢rrow;憦ector;楛iangleƀ;BEၐၑၕ抳ar;槐qual;抵pƀDTVၣၮၸownVector;楏eeVector;楜ectorĀ;Bႂႃ憾ar;楔ectorĀ;B႑႒懀ar;楓Āpuႛ႞f;愝ndImplies;楰ightarrow;懛ĀchႹႼr;愛;憱leDelayed;槴ڀHOacfhimoqstuფჱჷჽᄙᄞᅑᅖᅡᅧᆵᆻᆿĀCcჩხHcy;䐩y;䐨FTcy;䐬cute;䅚ʀ;aeiyᄈᄉᄎᄓᄗ檼ron;䅠dil;䅞rc;䅜;䐡r;쀀𝔖ortȀDLRUᄪᄴᄾᅉownArrow»ОeftArrow»࢚ightArrow»࿝pArrow;憑gma;䎣allCircle;战pf;쀀𝕊ɲᅭ\0\0ᅰt;戚areȀ;ISUᅻᅼᆉᆯ斡ntersection;抓uĀbpᆏᆞsetĀ;Eᆗᆘ抏qual;抑ersetĀ;Eᆨᆩ抐qual;抒nion;抔cr;쀀𝒮ar;拆ȀbcmpᇈᇛሉላĀ;sᇍᇎ拐etĀ;Eᇍᇕqual;抆ĀchᇠህeedsȀ;ESTᇭᇮᇴᇿ扻qual;檰lantEqual;扽ilde;承Tháྌ;我ƀ;esሒሓሣ拑rsetĀ;Eሜም抃qual;抇et»ሓրHRSacfhiorsሾቄ቉ቕ቞ቱቶኟዂወዑORN耻Þ䃞ADE;愢ĀHc቎ቒcy;䐋y;䐦Ābuቚቜ;䀉;䎤ƀaeyብቪቯron;䅤dil;䅢;䐢r;쀀𝔗Āeiቻ኉ǲኀ\0ኇefore;戴a;䎘Ācn኎ኘkSpace;쀀  Space;怉ldeȀ;EFTካኬኲኼ戼qual;扃ullEqual;扅ilde;扈pf;쀀𝕋ipleDot;惛Āctዖዛr;쀀𝒯rok;䅦ૡዷጎጚጦ\0ጬጱ\0\0\0\0\0ጸጽ፷ᎅ\0᏿ᐄᐊᐐĀcrዻጁute耻Ú䃚rĀ;oጇገ憟cir;楉rǣጓ\0጖y;䐎ve;䅬Āiyጞጣrc耻Û䃛;䐣blac;䅰r;쀀𝔘rave耻Ù䃙acr;䅪Ādiፁ፩erĀBPፈ፝Āarፍፐr;䁟acĀekፗፙ;揟et;掵arenthesis;揝onĀ;P፰፱拃lus;抎Āgp፻፿on;䅲f;쀀𝕌ЀADETadps᎕ᎮᎸᏄϨᏒᏗᏳrrowƀ;BDᅐᎠᎤar;椒ownArrow;懅ownArrow;憕quilibrium;楮eeĀ;AᏋᏌ报rrow;憥ownáϳerĀLRᏞᏨeftArrow;憖ightArrow;憗iĀ;lᏹᏺ䏒on;䎥ing;䅮cr;쀀𝒰ilde;䅨ml耻Ü䃜ҀDbcdefosvᐧᐬᐰᐳᐾᒅᒊᒐᒖash;披ar;櫫y;䐒ashĀ;lᐻᐼ抩;櫦Āerᑃᑅ;拁ƀbtyᑌᑐᑺar;怖Ā;iᑏᑕcalȀBLSTᑡᑥᑪᑴar;戣ine;䁼eparator;杘ilde;所ThinSpace;怊r;쀀𝔙pf;쀀𝕍cr;쀀𝒱dash;抪ʀcefosᒧᒬᒱᒶᒼirc;䅴dge;拀r;쀀𝔚pf;쀀𝕎cr;쀀𝒲Ȁfiosᓋᓐᓒᓘr;쀀𝔛;䎞pf;쀀𝕏cr;쀀𝒳ҀAIUacfosuᓱᓵᓹᓽᔄᔏᔔᔚᔠcy;䐯cy;䐇cy;䐮cute耻Ý䃝Āiyᔉᔍrc;䅶;䐫r;쀀𝔜pf;쀀𝕐cr;쀀𝒴ml;䅸ЀHacdefosᔵᔹᔿᕋᕏᕝᕠᕤcy;䐖cute;䅹Āayᕄᕉron;䅽;䐗ot;䅻ǲᕔ\0ᕛoWidtè૙a;䎖r;愨pf;愤cr;쀀𝒵௡ᖃᖊᖐ\0ᖰᖶᖿ\0\0\0\0ᗆᗛᗫᙟ᙭\0ᚕ᚛ᚲᚹ\0ᚾcute耻á䃡reve;䄃̀;Ediuyᖜᖝᖡᖣᖨᖭ戾;쀀∾̳;房rc耻â䃢te肻´̆;䐰lig耻æ䃦Ā;r²ᖺ;쀀𝔞rave耻à䃠ĀepᗊᗖĀfpᗏᗔsym;愵èᗓha;䎱ĀapᗟcĀclᗤᗧr;䄁g;樿ɤᗰ\0\0ᘊʀ;adsvᗺᗻᗿᘁᘇ戧nd;橕;橜lope;橘;橚΀;elmrszᘘᘙᘛᘞᘿᙏᙙ戠;榤e»ᘙsdĀ;aᘥᘦ戡ѡᘰᘲᘴᘶᘸᘺᘼᘾ;榨;榩;榪;榫;榬;榭;榮;榯tĀ;vᙅᙆ戟bĀ;dᙌᙍ抾;榝Āptᙔᙗh;戢»¹arr;捼Āgpᙣᙧon;䄅f;쀀𝕒΀;Eaeiop዁ᙻᙽᚂᚄᚇᚊ;橰cir;橯;扊d;手s;䀧roxĀ;e዁ᚒñᚃing耻å䃥ƀctyᚡᚦᚨr;쀀𝒶;䀪mpĀ;e዁ᚯñʈilde耻ã䃣ml耻ä䃤Āciᛂᛈoninôɲnt;樑ࠀNabcdefiklnoprsu᛭ᛱᜰ᜼ᝃᝈ᝸᝽០៦ᠹᡐᜍ᤽᥈ᥰot;櫭Ācrᛶ᜞kȀcepsᜀᜅᜍᜓong;扌psilon;䏶rime;怵imĀ;e᜚᜛戽q;拍Ŷᜢᜦee;抽edĀ;gᜬᜭ挅e»ᜭrkĀ;t፜᜷brk;掶Āoyᜁᝁ;䐱quo;怞ʀcmprtᝓ᝛ᝡᝤᝨausĀ;eĊĉptyv;榰séᜌnoõēƀahwᝯ᝱ᝳ;䎲;愶een;扬r;쀀𝔟g΀costuvwឍឝឳេ៕៛៞ƀaiuបពរðݠrc;旯p»፱ƀdptឤឨឭot;樀lus;樁imes;樂ɱឹ\0\0ើcup;樆ar;昅riangleĀdu៍្own;施p;斳plus;樄eåᑄåᒭarow;植ƀako៭ᠦᠵĀcn៲ᠣkƀlst៺֫᠂ozenge;槫riangleȀ;dlr᠒᠓᠘᠝斴own;斾eft;旂ight;斸k;搣Ʊᠫ\0ᠳƲᠯ\0ᠱ;斒;斑4;斓ck;斈ĀeoᠾᡍĀ;qᡃᡆ쀀=⃥uiv;쀀≡⃥t;挐Ȁptwxᡙᡞᡧᡬf;쀀𝕓Ā;tᏋᡣom»Ꮜtie;拈؀DHUVbdhmptuvᢅᢖᢪᢻᣗᣛᣬ᣿ᤅᤊᤐᤡȀLRlrᢎᢐᢒᢔ;敗;敔;敖;敓ʀ;DUduᢡᢢᢤᢦᢨ敐;敦;敩;敤;敧ȀLRlrᢳᢵᢷᢹ;敝;敚;敜;教΀;HLRhlrᣊᣋᣍᣏᣑᣓᣕ救;敬;散;敠;敫;敢;敟ox;槉ȀLRlrᣤᣦᣨᣪ;敕;敒;攐;攌ʀ;DUduڽ᣷᣹᣻᣽;敥;敨;攬;攴inus;抟lus;択imes;抠ȀLRlrᤙᤛᤝ᤟;敛;敘;攘;攔΀;HLRhlrᤰᤱᤳᤵᤷ᤻᤹攂;敪;敡;敞;攼;攤;攜Āevģ᥂bar耻¦䂦Ȁceioᥑᥖᥚᥠr;쀀𝒷mi;恏mĀ;e᜚᜜lƀ;bhᥨᥩᥫ䁜;槅sub;柈Ŭᥴ᥾lĀ;e᥹᥺怢t»᥺pƀ;Eeįᦅᦇ;檮Ā;qۜۛೡᦧ\0᧨ᨑᨕᨲ\0ᨷᩐ\0\0᪴\0\0᫁\0\0ᬡᬮ᭍᭒\0᯽\0ᰌƀcpr᦭ᦲ᧝ute;䄇̀;abcdsᦿᧀᧄ᧊᧕᧙戩nd;橄rcup;橉Āau᧏᧒p;橋p;橇ot;橀;쀀∩︀Āeo᧢᧥t;恁îړȀaeiu᧰᧻ᨁᨅǰ᧵\0᧸s;橍on;䄍dil耻ç䃧rc;䄉psĀ;sᨌᨍ橌m;橐ot;䄋ƀdmnᨛᨠᨦil肻¸ƭptyv;榲t脀¢;eᨭᨮ䂢räƲr;쀀𝔠ƀceiᨽᩀᩍy;䑇ckĀ;mᩇᩈ朓ark»ᩈ;䏇r΀;Ecefms᩟᩠ᩢᩫ᪤᪪᪮旋;槃ƀ;elᩩᩪᩭ䋆q;扗eɡᩴ\0\0᪈rrowĀlr᩼᪁eft;憺ight;憻ʀRSacd᪒᪔᪖᪚᪟»ཇ;擈st;抛irc;抚ash;抝nint;樐id;櫯cir;槂ubsĀ;u᪻᪼晣it»᪼ˬ᫇᫔᫺\0ᬊonĀ;eᫍᫎ䀺Ā;qÇÆɭ᫙\0\0᫢aĀ;t᫞᫟䀬;䁀ƀ;fl᫨᫩᫫戁îᅠeĀmx᫱᫶ent»᫩eóɍǧ᫾\0ᬇĀ;dኻᬂot;橭nôɆƀfryᬐᬔᬗ;쀀𝕔oäɔ脀©;sŕᬝr;愗Āaoᬥᬩrr;憵ss;朗Ācuᬲᬷr;쀀𝒸Ābpᬼ᭄Ā;eᭁᭂ櫏;櫑Ā;eᭉᭊ櫐;櫒dot;拯΀delprvw᭠᭬᭷ᮂᮬᯔ᯹arrĀlr᭨᭪;椸;椵ɰ᭲\0\0᭵r;拞c;拟arrĀ;p᭿ᮀ憶;椽̀;bcdosᮏᮐᮖᮡᮥᮨ截rcap;橈Āauᮛᮞp;橆p;橊ot;抍r;橅;쀀∪︀Ȁalrv᮵ᮿᯞᯣrrĀ;mᮼᮽ憷;椼yƀevwᯇᯔᯘqɰᯎ\0\0ᯒreã᭳uã᭵ee;拎edge;拏en耻¤䂤earrowĀlrᯮ᯳eft»ᮀight»ᮽeäᯝĀciᰁᰇoninôǷnt;戱lcty;挭ঀAHabcdefhijlorstuwz᰸᰻᰿ᱝᱩᱵᲊᲞᲬᲷ᳻᳿ᴍᵻᶑᶫᶻ᷆᷍rò΁ar;楥Ȁglrs᱈ᱍ᱒᱔ger;怠eth;愸òᄳhĀ;vᱚᱛ怐»ऊūᱡᱧarow;椏aã̕Āayᱮᱳron;䄏;䐴ƀ;ao̲ᱼᲄĀgrʿᲁr;懊tseq;橷ƀglmᲑᲔᲘ耻°䂰ta;䎴ptyv;榱ĀirᲣᲨsht;楿;쀀𝔡arĀlrᲳᲵ»ࣜ»သʀaegsv᳂͸᳖᳜᳠mƀ;oș᳊᳔ndĀ;ș᳑uit;晦amma;䏝in;拲ƀ;io᳧᳨᳸䃷de脀÷;o᳧ᳰntimes;拇nø᳷cy;䑒cɯᴆ\0\0ᴊrn;挞op;挍ʀlptuwᴘᴝᴢᵉᵕlar;䀤f;쀀𝕕ʀ;emps̋ᴭᴷᴽᵂqĀ;d͒ᴳot;扑inus;戸lus;戔quare;抡blebarwedgåúnƀadhᄮᵝᵧownarrowóᲃarpoonĀlrᵲᵶefôᲴighôᲶŢᵿᶅkaro÷གɯᶊ\0\0ᶎrn;挟op;挌ƀcotᶘᶣᶦĀryᶝᶡ;쀀𝒹;䑕l;槶rok;䄑Ādrᶰᶴot;拱iĀ;fᶺ᠖斿Āah᷀᷃ròЩaòྦangle;榦Āci᷒ᷕy;䑟grarr;柿ऀDacdefglmnopqrstuxḁḉḙḸոḼṉṡṾấắẽỡἪἷὄ὎὚ĀDoḆᴴoôᲉĀcsḎḔute耻é䃩ter;橮ȀaioyḢḧḱḶron;䄛rĀ;cḭḮ扖耻ê䃪lon;払;䑍ot;䄗ĀDrṁṅot;扒;쀀𝔢ƀ;rsṐṑṗ檚ave耻è䃨Ā;dṜṝ檖ot;檘Ȁ;ilsṪṫṲṴ檙nters;揧;愓Ā;dṹṺ檕ot;檗ƀapsẅẉẗcr;䄓tyƀ;svẒẓẕ戅et»ẓpĀ1;ẝẤĳạả;怄;怅怃ĀgsẪẬ;䅋p;怂ĀgpẴẸon;䄙f;쀀𝕖ƀalsỄỎỒrĀ;sỊị拕l;槣us;橱iƀ;lvỚớở䎵on»ớ;䏵ȀcsuvỪỳἋἣĀioữḱrc»Ḯɩỹ\0\0ỻíՈantĀglἂἆtr»ṝess»Ṻƀaeiἒ἖Ἒls;䀽st;扟vĀ;DȵἠD;橸parsl;槥ĀDaἯἳot;打rr;楱ƀcdiἾὁỸr;愯oô͒ĀahὉὋ;䎷耻ð䃰Āmrὓὗl耻ë䃫o;悬ƀcipὡὤὧl;䀡sôծĀeoὬὴctatioîՙnentialåչৡᾒ\0ᾞ\0ᾡᾧ\0\0ῆῌ\0ΐ\0ῦῪ \0 ⁚llingdotseñṄy;䑄male;晀ƀilrᾭᾳ῁lig;耀ﬃɩᾹ\0\0᾽g;耀ﬀig;耀ﬄ;쀀𝔣lig;耀ﬁlig;쀀fjƀaltῙ῜ῡt;晭ig;耀ﬂns;斱of;䆒ǰ΅\0ῳf;쀀𝕗ĀakֿῷĀ;vῼ´拔;櫙artint;樍Āao‌⁕Ācs‑⁒α‚‰‸⁅⁈\0⁐β•‥‧‪‬\0‮耻½䂽;慓耻¼䂼;慕;慙;慛Ƴ‴\0‶;慔;慖ʴ‾⁁\0\0⁃耻¾䂾;慗;慜5;慘ƶ⁌\0⁎;慚;慝8;慞l;恄wn;挢cr;쀀𝒻ࢀEabcdefgijlnorstv₂₉₟₥₰₴⃰⃵⃺⃿℃ℒℸ̗ℾ⅒↞Ā;lٍ₇;檌ƀcmpₐₕ₝ute;䇵maĀ;dₜ᳚䎳;檆reve;䄟Āiy₪₮rc;䄝;䐳ot;䄡Ȁ;lqsؾق₽⃉ƀ;qsؾٌ⃄lanô٥Ȁ;cdl٥⃒⃥⃕c;檩otĀ;o⃜⃝檀Ā;l⃢⃣檂;檄Ā;e⃪⃭쀀⋛︀s;檔r;쀀𝔤Ā;gٳ؛mel;愷cy;䑓Ȁ;Eajٚℌℎℐ;檒;檥;檤ȀEaesℛℝ℩ℴ;扩pĀ;p℣ℤ檊rox»ℤĀ;q℮ℯ檈Ā;q℮ℛim;拧pf;쀀𝕘Āci⅃ⅆr;愊mƀ;el٫ⅎ⅐;檎;檐茀>;cdlqr׮ⅠⅪⅮⅳⅹĀciⅥⅧ;檧r;橺ot;拗Par;榕uest;橼ʀadelsↄⅪ←ٖ↛ǰ↉\0↎proø₞r;楸qĀlqؿ↖lesó₈ií٫Āen↣↭rtneqq;쀀≩︀Å↪ԀAabcefkosy⇄⇇⇱⇵⇺∘∝∯≨≽ròΠȀilmr⇐⇔⇗⇛rsðᒄf»․ilôکĀdr⇠⇤cy;䑊ƀ;cwࣴ⇫⇯ir;楈;憭ar;意irc;䄥ƀalr∁∎∓rtsĀ;u∉∊晥it»∊lip;怦con;抹r;쀀𝔥sĀew∣∩arow;椥arow;椦ʀamopr∺∾≃≞≣rr;懿tht;戻kĀlr≉≓eftarrow;憩ightarrow;憪f;쀀𝕙bar;怕ƀclt≯≴≸r;쀀𝒽asè⇴rok;䄧Ābp⊂⊇ull;恃hen»ᱛૡ⊣\0⊪\0⊸⋅⋎\0⋕⋳\0\0⋸⌢⍧⍢⍿\0⎆⎪⎴cute耻í䃭ƀ;iyݱ⊰⊵rc耻î䃮;䐸Ācx⊼⊿y;䐵cl耻¡䂡ĀfrΟ⋉;쀀𝔦rave耻ì䃬Ȁ;inoܾ⋝⋩⋮Āin⋢⋦nt;樌t;戭fin;槜ta;愩lig;䄳ƀaop⋾⌚⌝ƀcgt⌅⌈⌗r;䄫ƀelpܟ⌏⌓inåގarôܠh;䄱f;抷ed;䆵ʀ;cfotӴ⌬⌱⌽⍁are;愅inĀ;t⌸⌹戞ie;槝doô⌙ʀ;celpݗ⍌⍐⍛⍡al;抺Āgr⍕⍙eróᕣã⍍arhk;樗rod;樼Ȁcgpt⍯⍲⍶⍻y;䑑on;䄯f;쀀𝕚a;䎹uest耻¿䂿Āci⎊⎏r;쀀𝒾nʀ;EdsvӴ⎛⎝⎡ӳ;拹ot;拵Ā;v⎦⎧拴;拳Ā;iݷ⎮lde;䄩ǫ⎸\0⎼cy;䑖l耻ï䃯̀cfmosu⏌⏗⏜⏡⏧⏵Āiy⏑⏕rc;䄵;䐹r;쀀𝔧ath;䈷pf;쀀𝕛ǣ⏬\0⏱r;쀀𝒿rcy;䑘kcy;䑔Ѐacfghjos␋␖␢␧␭␱␵␻ppaĀ;v␓␔䎺;䏰Āey␛␠dil;䄷;䐺r;쀀𝔨reen;䄸cy;䑅cy;䑜pf;쀀𝕜cr;쀀𝓀஀ABEHabcdefghjlmnoprstuv⑰⒁⒆⒍⒑┎┽╚▀♎♞♥♹♽⚚⚲⛘❝❨➋⟀⠁⠒ƀart⑷⑺⑼rò৆òΕail;椛arr;椎Ā;gঔ⒋;檋ar;楢ॣ⒥\0⒪\0⒱\0\0\0\0\0⒵Ⓔ\0ⓆⓈⓍ\0⓹ute;䄺mptyv;榴raîࡌbda;䎻gƀ;dlࢎⓁⓃ;榑åࢎ;檅uo耻«䂫rЀ;bfhlpst࢙ⓞⓦⓩ⓫⓮⓱⓵Ā;f࢝ⓣs;椟s;椝ë≒p;憫l;椹im;楳l;憢ƀ;ae⓿─┄檫il;椙Ā;s┉┊檭;쀀⪭︀ƀabr┕┙┝rr;椌rk;杲Āak┢┬cĀek┨┪;䁻;䁛Āes┱┳;榋lĀdu┹┻;榏;榍Ȁaeuy╆╋╖╘ron;䄾Ādi═╔il;䄼ìࢰâ┩;䐻Ȁcqrs╣╦╭╽a;椶uoĀ;rนᝆĀdu╲╷har;楧shar;楋h;憲ʀ;fgqs▋▌উ◳◿扤tʀahlrt▘▤▷◂◨rrowĀ;t࢙□aé⓶arpoonĀdu▯▴own»њp»०eftarrows;懇ightƀahs◍◖◞rrowĀ;sࣴࢧarpoonó྘quigarro÷⇰hreetimes;拋ƀ;qs▋ও◺lanôবʀ;cdgsব☊☍☝☨c;檨otĀ;o☔☕橿Ā;r☚☛檁;檃Ā;e☢☥쀀⋚︀s;檓ʀadegs☳☹☽♉♋pproøⓆot;拖qĀgq♃♅ôউgtò⒌ôছiíলƀilr♕࣡♚sht;楼;쀀𝔩Ā;Eজ♣;檑š♩♶rĀdu▲♮Ā;l॥♳;楪lk;斄cy;䑙ʀ;achtੈ⚈⚋⚑⚖rò◁orneòᴈard;楫ri;旺Āio⚟⚤dot;䅀ustĀ;a⚬⚭掰che»⚭ȀEaes⚻⚽⛉⛔;扨pĀ;p⛃⛄檉rox»⛄Ā;q⛎⛏檇Ā;q⛎⚻im;拦Ѐabnoptwz⛩⛴⛷✚✯❁❇❐Ānr⛮⛱g;柬r;懽rëࣁgƀlmr⛿✍✔eftĀar০✇ightá৲apsto;柼ightá৽parrowĀlr✥✩efô⓭ight;憬ƀafl✶✹✽r;榅;쀀𝕝us;樭imes;樴š❋❏st;戗áፎƀ;ef❗❘᠀旊nge»❘arĀ;l❤❥䀨t;榓ʀachmt❳❶❼➅➇ròࢨorneòᶌarĀ;d྘➃;業;怎ri;抿̀achiqt➘➝ੀ➢➮➻quo;怹r;쀀𝓁mƀ;egল➪➬;檍;檏Ābu┪➳oĀ;rฟ➹;怚rok;䅂萀<;cdhilqrࠫ⟒☹⟜⟠⟥⟪⟰Āci⟗⟙;檦r;橹reå◲mes;拉arr;楶uest;橻ĀPi⟵⟹ar;榖ƀ;ef⠀भ᠛旃rĀdu⠇⠍shar;楊har;楦Āen⠗⠡rtneqq;쀀≨︀Å⠞܀Dacdefhilnopsu⡀⡅⢂⢎⢓⢠⢥⢨⣚⣢⣤ઃ⣳⤂Dot;戺Ȁclpr⡎⡒⡣⡽r耻¯䂯Āet⡗⡙;時Ā;e⡞⡟朠se»⡟Ā;sျ⡨toȀ;dluျ⡳⡷⡻owîҌefôएðᏑker;斮Āoy⢇⢌mma;権;䐼ash;怔asuredangle»ᘦr;쀀𝔪o;愧ƀcdn⢯⢴⣉ro耻µ䂵Ȁ;acdᑤ⢽⣀⣄sôᚧir;櫰ot肻·Ƶusƀ;bd⣒ᤃ⣓戒Ā;uᴼ⣘;横ţ⣞⣡p;櫛ò−ðઁĀdp⣩⣮els;抧f;쀀𝕞Āct⣸⣽r;쀀𝓂pos»ᖝƀ;lm⤉⤊⤍䎼timap;抸ఀGLRVabcdefghijlmoprstuvw⥂⥓⥾⦉⦘⧚⧩⨕⨚⩘⩝⪃⪕⪤⪨⬄⬇⭄⭿⮮ⰴⱧⱼ⳩Āgt⥇⥋;쀀⋙̸Ā;v⥐௏쀀≫⃒ƀelt⥚⥲⥶ftĀar⥡⥧rrow;懍ightarrow;懎;쀀⋘̸Ā;v⥻ే쀀≪⃒ightarrow;懏ĀDd⦎⦓ash;抯ash;抮ʀbcnpt⦣⦧⦬⦱⧌la»˞ute;䅄g;쀀∠⃒ʀ;Eiop඄⦼⧀⧅⧈;쀀⩰̸d;쀀≋̸s;䅉roø඄urĀ;a⧓⧔普lĀ;s⧓ସǳ⧟\0⧣p肻 ଷmpĀ;e௹ఀʀaeouy⧴⧾⨃⨐⨓ǰ⧹\0⧻;橃on;䅈dil;䅆ngĀ;dൾ⨊ot;쀀⩭̸p;橂;䐽ash;怓΀;Aadqsxஒ⨩⨭⨻⩁⩅⩐rr;懗rĀhr⨳⨶k;椤Ā;oᏲᏰot;쀀≐̸uiöୣĀei⩊⩎ar;椨í஘istĀ;s஠டr;쀀𝔫ȀEest௅⩦⩹⩼ƀ;qs஼⩭௡ƀ;qs஼௅⩴lanô௢ií௪Ā;rஶ⪁»ஷƀAap⪊⪍⪑rò⥱rr;憮ar;櫲ƀ;svྍ⪜ྌĀ;d⪡⪢拼;拺cy;䑚΀AEadest⪷⪺⪾⫂⫅⫶⫹rò⥦;쀀≦̸rr;憚r;急Ȁ;fqs఻⫎⫣⫯tĀar⫔⫙rro÷⫁ightarro÷⪐ƀ;qs఻⪺⫪lanôౕĀ;sౕ⫴»శiíౝĀ;rవ⫾iĀ;eచథiäඐĀpt⬌⬑f;쀀𝕟膀¬;in⬙⬚⬶䂬nȀ;Edvஉ⬤⬨⬮;쀀⋹̸ot;쀀⋵̸ǡஉ⬳⬵;拷;拶iĀ;vಸ⬼ǡಸ⭁⭃;拾;拽ƀaor⭋⭣⭩rȀ;ast୻⭕⭚⭟lleì୻l;쀀⫽⃥;쀀∂̸lint;樔ƀ;ceಒ⭰⭳uåಥĀ;cಘ⭸Ā;eಒ⭽ñಘȀAait⮈⮋⮝⮧rò⦈rrƀ;cw⮔⮕⮙憛;쀀⤳̸;쀀↝̸ghtarrow»⮕riĀ;eೋೖ΀chimpqu⮽⯍⯙⬄୸⯤⯯Ȁ;cerല⯆ഷ⯉uå൅;쀀𝓃ortɭ⬅\0\0⯖ará⭖mĀ;e൮⯟Ā;q൴൳suĀbp⯫⯭å೸åഋƀbcp⯶ⰑⰙȀ;Ees⯿ⰀഢⰄ抄;쀀⫅̸etĀ;eഛⰋqĀ;qണⰀcĀ;eലⰗñസȀ;EesⰢⰣൟⰧ抅;쀀⫆̸etĀ;e൘ⰮqĀ;qൠⰣȀgilrⰽⰿⱅⱇìௗlde耻ñ䃱çృiangleĀlrⱒⱜeftĀ;eచⱚñదightĀ;eೋⱥñ೗Ā;mⱬⱭ䎽ƀ;esⱴⱵⱹ䀣ro;愖p;怇ҀDHadgilrsⲏⲔⲙⲞⲣⲰⲶⳓⳣash;抭arr;椄p;쀀≍⃒ash;抬ĀetⲨⲬ;쀀≥⃒;쀀>⃒nfin;槞ƀAetⲽⳁⳅrr;椂;쀀≤⃒Ā;rⳊⳍ쀀<⃒ie;쀀⊴⃒ĀAtⳘⳜrr;椃rie;쀀⊵⃒im;쀀∼⃒ƀAan⳰⳴ⴂrr;懖rĀhr⳺⳽k;椣Ā;oᏧᏥear;椧ቓ᪕\0\0\0\0\0\0\0\0\0\0\0\0\0ⴭ\0ⴸⵈⵠⵥ⵲ⶄᬇ\0\0ⶍⶫ\0ⷈⷎ\0ⷜ⸙⸫⸾⹃Ācsⴱ᪗ute耻ó䃳ĀiyⴼⵅrĀ;c᪞ⵂ耻ô䃴;䐾ʀabios᪠ⵒⵗǈⵚlac;䅑v;樸old;榼lig;䅓Ācr⵩⵭ir;榿;쀀𝔬ͯ⵹\0\0⵼\0ⶂn;䋛ave耻ò䃲;槁Ābmⶈ෴ar;榵Ȁacitⶕ⶘ⶥⶨrò᪀Āir⶝ⶠr;榾oss;榻nå๒;槀ƀaeiⶱⶵⶹcr;䅍ga;䏉ƀcdnⷀⷅǍron;䎿;榶pf;쀀𝕠ƀaelⷔ⷗ǒr;榷rp;榹΀;adiosvⷪⷫⷮ⸈⸍⸐⸖戨rò᪆Ȁ;efmⷷⷸ⸂⸅橝rĀ;oⷾⷿ愴f»ⷿ耻ª䂪耻º䂺gof;抶r;橖lope;橗;橛ƀclo⸟⸡⸧ò⸁ash耻ø䃸l;折iŬⸯ⸴de耻õ䃵esĀ;aǛ⸺s;樶ml耻ö䃶bar;挽ૡ⹞\0⹽\0⺀⺝\0⺢⺹\0\0⻋ຜ\0⼓\0\0⼫⾼\0⿈rȀ;astЃ⹧⹲຅脀¶;l⹭⹮䂶leìЃɩ⹸\0\0⹻m;櫳;櫽y;䐿rʀcimpt⺋⺏⺓ᡥ⺗nt;䀥od;䀮il;怰enk;怱r;쀀𝔭ƀimo⺨⺰⺴Ā;v⺭⺮䏆;䏕maô੶ne;明ƀ;tv⺿⻀⻈䏀chfork»´;䏖Āau⻏⻟nĀck⻕⻝kĀ;h⇴⻛;愎ö⇴sҀ;abcdemst⻳⻴ᤈ⻹⻽⼄⼆⼊⼎䀫cir;樣ir;樢Āouᵀ⼂;樥;橲n肻±ຝim;樦wo;樧ƀipu⼙⼠⼥ntint;樕f;쀀𝕡nd耻£䂣Ԁ;Eaceinosu່⼿⽁⽄⽇⾁⾉⾒⽾⾶;檳p;檷uå໙Ā;c໎⽌̀;acens່⽙⽟⽦⽨⽾pproø⽃urlyeñ໙ñ໎ƀaes⽯⽶⽺pprox;檹qq;檵im;拨iíໟmeĀ;s⾈ຮ怲ƀEas⽸⾐⽺ð⽵ƀdfp໬⾙⾯ƀals⾠⾥⾪lar;挮ine;挒urf;挓Ā;t໻⾴ï໻rel;抰Āci⿀⿅r;쀀𝓅;䏈ncsp;怈̀fiopsu⿚⋢⿟⿥⿫⿱r;쀀𝔮pf;쀀𝕢rime;恗cr;쀀𝓆ƀaeo⿸〉〓tĀei⿾々rnionóڰnt;樖stĀ;e【】䀿ñἙô༔઀ABHabcdefhilmnoprstux぀けさすムㄎㄫㅇㅢㅲㆎ㈆㈕㈤㈩㉘㉮㉲㊐㊰㊷ƀartぇおがròႳòϝail;検aròᱥar;楤΀cdenqrtとふへみわゔヌĀeuねぱ;쀀∽̱te;䅕iãᅮmptyv;榳gȀ;del࿑らるろ;榒;榥å࿑uo耻»䂻rր;abcfhlpstw࿜ガクシスゼゾダッデナp;極Ā;f࿠ゴs;椠;椳s;椞ë≝ð✮l;楅im;楴l;憣;憝Āaiパフil;椚oĀ;nホボ戶aló༞ƀabrョリヮrò៥rk;杳ĀakンヽcĀekヹ・;䁽;䁝Āes㄂㄄;榌lĀduㄊㄌ;榎;榐Ȁaeuyㄗㄜㄧㄩron;䅙Ādiㄡㄥil;䅗ì࿲âヺ;䑀Ȁclqsㄴㄷㄽㅄa;椷dhar;楩uoĀ;rȎȍh;憳ƀacgㅎㅟངlȀ;ipsླྀㅘㅛႜnåႻarôྩt;断ƀilrㅩဣㅮsht;楽;쀀𝔯ĀaoㅷㆆrĀduㅽㅿ»ѻĀ;l႑ㆄ;楬Ā;vㆋㆌ䏁;䏱ƀgns㆕ㇹㇼht̀ahlrstㆤㆰ㇂㇘㇤㇮rrowĀ;t࿜ㆭaéトarpoonĀduㆻㆿowîㅾp»႒eftĀah㇊㇐rrowó࿪arpoonóՑightarrows;應quigarro÷ニhreetimes;拌g;䋚ingdotseñἲƀahm㈍㈐㈓rò࿪aòՑ;怏oustĀ;a㈞㈟掱che»㈟mid;櫮Ȁabpt㈲㈽㉀㉒Ānr㈷㈺g;柭r;懾rëဃƀafl㉇㉊㉎r;榆;쀀𝕣us;樮imes;樵Āap㉝㉧rĀ;g㉣㉤䀩t;榔olint;樒arò㇣Ȁachq㉻㊀Ⴜ㊅quo;怺r;쀀𝓇Ābu・㊊oĀ;rȔȓƀhir㊗㊛㊠reåㇸmes;拊iȀ;efl㊪ၙᠡ㊫方tri;槎luhar;楨;愞ൡ㋕㋛㋟㌬㌸㍱\0㍺㎤\0\0㏬㏰\0㐨㑈㑚㒭㒱㓊㓱\0㘖\0\0㘳cute;䅛quï➺Ԁ;Eaceinpsyᇭ㋳㋵㋿㌂㌋㌏㌟㌦㌩;檴ǰ㋺\0㋼;檸on;䅡uåᇾĀ;dᇳ㌇il;䅟rc;䅝ƀEas㌖㌘㌛;檶p;檺im;择olint;樓iíሄ;䑁otƀ;be㌴ᵇ㌵担;橦΀Aacmstx㍆㍊㍗㍛㍞㍣㍭rr;懘rĀhr㍐㍒ë∨Ā;oਸ਼਴t耻§䂧i;䀻war;椩mĀin㍩ðnuóñt;朶rĀ;o㍶⁕쀀𝔰Ȁacoy㎂㎆㎑㎠rp;景Āhy㎋㎏cy;䑉;䑈rtɭ㎙\0\0㎜iäᑤaraì⹯耻­䂭Āgm㎨㎴maƀ;fv㎱㎲㎲䏃;䏂Ѐ;deglnprካ㏅㏉㏎㏖㏞㏡㏦ot;橪Ā;q኱ኰĀ;E㏓㏔檞;檠Ā;E㏛㏜檝;檟e;扆lus;樤arr;楲aròᄽȀaeit㏸㐈㐏㐗Āls㏽㐄lsetmé㍪hp;樳parsl;槤Ādlᑣ㐔e;挣Ā;e㐜㐝檪Ā;s㐢㐣檬;쀀⪬︀ƀflp㐮㐳㑂tcy;䑌Ā;b㐸㐹䀯Ā;a㐾㐿槄r;挿f;쀀𝕤aĀdr㑍ЂesĀ;u㑔㑕晠it»㑕ƀcsu㑠㑹㒟Āau㑥㑯pĀ;sᆈ㑫;쀀⊓︀pĀ;sᆴ㑵;쀀⊔︀uĀbp㑿㒏ƀ;esᆗᆜ㒆etĀ;eᆗ㒍ñᆝƀ;esᆨᆭ㒖etĀ;eᆨ㒝ñᆮƀ;afᅻ㒦ְrť㒫ֱ»ᅼaròᅈȀcemt㒹㒾㓂㓅r;쀀𝓈tmîñiì㐕aræᆾĀar㓎㓕rĀ;f㓔ឿ昆Āan㓚㓭ightĀep㓣㓪psiloîỠhé⺯s»⡒ʀbcmnp㓻㕞ሉ㖋㖎Ҁ;Edemnprs㔎㔏㔑㔕㔞㔣㔬㔱㔶抂;櫅ot;檽Ā;dᇚ㔚ot;櫃ult;櫁ĀEe㔨㔪;櫋;把lus;檿arr;楹ƀeiu㔽㕒㕕tƀ;en㔎㕅㕋qĀ;qᇚ㔏eqĀ;q㔫㔨m;櫇Ābp㕚㕜;櫕;櫓c̀;acensᇭ㕬㕲㕹㕻㌦pproø㋺urlyeñᇾñᇳƀaes㖂㖈㌛pproø㌚qñ㌗g;晪ڀ123;Edehlmnps㖩㖬㖯ሜ㖲㖴㗀㗉㗕㗚㗟㗨㗭耻¹䂹耻²䂲耻³䂳;櫆Āos㖹㖼t;檾ub;櫘Ā;dሢ㗅ot;櫄sĀou㗏㗒l;柉b;櫗arr;楻ult;櫂ĀEe㗤㗦;櫌;抋lus;櫀ƀeiu㗴㘉㘌tƀ;enሜ㗼㘂qĀ;qሢ㖲eqĀ;q㗧㗤m;櫈Ābp㘑㘓;櫔;櫖ƀAan㘜㘠㘭rr;懙rĀhr㘦㘨ë∮Ā;oਫ਩war;椪lig耻ß䃟௡㙑㙝㙠ዎ㙳㙹\0㙾㛂\0\0\0\0\0㛛㜃\0㜉㝬\0\0\0㞇ɲ㙖\0\0㙛get;挖;䏄rë๟ƀaey㙦㙫㙰ron;䅥dil;䅣;䑂lrec;挕r;쀀𝔱Ȁeiko㚆㚝㚵㚼ǲ㚋\0㚑eĀ4fኄኁaƀ;sv㚘㚙㚛䎸ym;䏑Ācn㚢㚲kĀas㚨㚮pproø዁im»ኬsðኞĀas㚺㚮ð዁rn耻þ䃾Ǭ̟㛆⋧es膀×;bd㛏㛐㛘䃗Ā;aᤏ㛕r;樱;樰ƀeps㛡㛣㜀á⩍Ȁ;bcf҆㛬㛰㛴ot;挶ir;櫱Ā;o㛹㛼쀀𝕥rk;櫚á㍢rime;怴ƀaip㜏㜒㝤dåቈ΀adempst㜡㝍㝀㝑㝗㝜㝟ngleʀ;dlqr㜰㜱㜶㝀㝂斵own»ᶻeftĀ;e⠀㜾ñम;扜ightĀ;e㊪㝋ñၚot;旬inus;樺lus;樹b;槍ime;樻ezium;揢ƀcht㝲㝽㞁Āry㝷㝻;쀀𝓉;䑆cy;䑛rok;䅧Āio㞋㞎xô᝷headĀlr㞗㞠eftarro÷ࡏightarrow»ཝऀAHabcdfghlmoprstuw㟐㟓㟗㟤㟰㟼㠎㠜㠣㠴㡑㡝㡫㢩㣌㣒㣪㣶ròϭar;楣Ācr㟜㟢ute耻ú䃺òᅐrǣ㟪\0㟭y;䑞ve;䅭Āiy㟵㟺rc耻û䃻;䑃ƀabh㠃㠆㠋ròᎭlac;䅱aòᏃĀir㠓㠘sht;楾;쀀𝔲rave耻ù䃹š㠧㠱rĀlr㠬㠮»ॗ»ႃlk;斀Āct㠹㡍ɯ㠿\0\0㡊rnĀ;e㡅㡆挜r»㡆op;挏ri;旸Āal㡖㡚cr;䅫肻¨͉Āgp㡢㡦on;䅳f;쀀𝕦̀adhlsuᅋ㡸㡽፲㢑㢠ownáᎳarpoonĀlr㢈㢌efô㠭ighô㠯iƀ;hl㢙㢚㢜䏅»ᏺon»㢚parrows;懈ƀcit㢰㣄㣈ɯ㢶\0\0㣁rnĀ;e㢼㢽挝r»㢽op;挎ng;䅯ri;旹cr;쀀𝓊ƀdir㣙㣝㣢ot;拰lde;䅩iĀ;f㜰㣨»᠓Āam㣯㣲rò㢨l耻ü䃼angle;榧ހABDacdeflnoprsz㤜㤟㤩㤭㦵㦸㦽㧟㧤㧨㧳㧹㧽㨁㨠ròϷarĀ;v㤦㤧櫨;櫩asèϡĀnr㤲㤷grt;榜΀eknprst㓣㥆㥋㥒㥝㥤㦖appá␕othinçẖƀhir㓫⻈㥙opô⾵Ā;hᎷ㥢ïㆍĀiu㥩㥭gmá㎳Ābp㥲㦄setneqĀ;q㥽㦀쀀⊊︀;쀀⫋︀setneqĀ;q㦏㦒쀀⊋︀;쀀⫌︀Āhr㦛㦟etá㚜iangleĀlr㦪㦯eft»थight»ၑy;䐲ash»ံƀelr㧄㧒㧗ƀ;beⷪ㧋㧏ar;抻q;扚lip;拮Ābt㧜ᑨaòᑩr;쀀𝔳tré㦮suĀbp㧯㧱»ജ»൙pf;쀀𝕧roð໻tré㦴Ācu㨆㨋r;쀀𝓋Ābp㨐㨘nĀEe㦀㨖»㥾nĀEe㦒㨞»㦐igzag;榚΀cefoprs㨶㨻㩖㩛㩔㩡㩪irc;䅵Ādi㩀㩑Ābg㩅㩉ar;機eĀ;qᗺ㩏;扙erp;愘r;쀀𝔴pf;쀀𝕨Ā;eᑹ㩦atèᑹcr;쀀𝓌ૣណ㪇\0㪋\0㪐㪛\0\0㪝㪨㪫㪯\0\0㫃㫎\0㫘ៜ៟tré៑r;쀀𝔵ĀAa㪔㪗ròσrò৶;䎾ĀAa㪡㪤ròθrò৫að✓is;拻ƀdptឤ㪵㪾Āfl㪺ឩ;쀀𝕩imåឲĀAa㫇㫊ròώròਁĀcq㫒ីr;쀀𝓍Āpt៖㫜ré។Ѐacefiosu㫰㫽㬈㬌㬑㬕㬛㬡cĀuy㫶㫻te耻ý䃽;䑏Āiy㬂㬆rc;䅷;䑋n耻¥䂥r;쀀𝔶cy;䑗pf;쀀𝕪cr;쀀𝓎Ācm㬦㬩y;䑎l耻ÿ䃿Ԁacdefhiosw㭂㭈㭔㭘㭤㭩㭭㭴㭺㮀cute;䅺Āay㭍㭒ron;䅾;䐷ot;䅼Āet㭝㭡træᕟa;䎶r;쀀𝔷cy;䐶grarr;懝pf;쀀𝕫cr;쀀𝓏Ājn㮅㮇;怍j;怌'.split("").map(e=>e.charCodeAt(0))),bRe=new Uint16Array("Ȁaglq	\x1Bɭ\0\0p;䀦os;䀧t;䀾t;䀼uot;䀢".split("").map(e=>e.charCodeAt(0)));var lI;const vRe=new Map([[0,65533],[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]),xRe=(lI=String.fromCodePoint)!==null&&lI!==void 0?lI:function(e){let t="";return e>65535&&(e-=65536,t+=String.fromCharCode(e>>>10&1023|55296),e=56320|e&1023),t+=String.fromCharCode(e),t};function wRe(e){var t;return e>=55296&&e<=57343||e>1114111?65533:(t=vRe.get(e))!==null&&t!==void 0?t:e}var ia;(function(e){e[e.NUM=35]="NUM",e[e.SEMI=59]="SEMI",e[e.EQUALS=61]="EQUALS",e[e.ZERO=48]="ZERO",e[e.NINE=57]="NINE",e[e.LOWER_A=97]="LOWER_A",e[e.LOWER_F=102]="LOWER_F",e[e.LOWER_X=120]="LOWER_X",e[e.LOWER_Z=122]="LOWER_Z",e[e.UPPER_A=65]="UPPER_A",e[e.UPPER_F=70]="UPPER_F",e[e.UPPER_Z=90]="UPPER_Z"})(ia||(ia={}));const _Re=32;var ch;(function(e){e[e.VALUE_LENGTH=49152]="VALUE_LENGTH",e[e.BRANCH_LENGTH=16256]="BRANCH_LENGTH",e[e.JUMP_TABLE=127]="JUMP_TABLE"})(ch||(ch={}));function Mj(e){return e>=ia.ZERO&&e<=ia.NINE}function SRe(e){return e>=ia.UPPER_A&&e<=ia.UPPER_F||e>=ia.LOWER_A&&e<=ia.LOWER_F}function CRe(e){return e>=ia.UPPER_A&&e<=ia.UPPER_Z||e>=ia.LOWER_A&&e<=ia.LOWER_Z||Mj(e)}function kRe(e){return e===ia.EQUALS||CRe(e)}var Qi;(function(e){e[e.EntityStart=0]="EntityStart",e[e.NumericStart=1]="NumericStart",e[e.NumericDecimal=2]="NumericDecimal",e[e.NumericHex=3]="NumericHex",e[e.NamedEntity=4]="NamedEntity"})(Qi||(Qi={}));var ah;(function(e){e[e.Legacy=0]="Legacy",e[e.Strict=1]="Strict",e[e.Attribute=2]="Attribute"})(ah||(ah={}));class ERe{constructor(t,n,r){this.decodeTree=t,this.emitCodePoint=n,this.errors=r,this.state=Qi.EntityStart,this.consumed=1,this.result=0,this.treeIndex=0,this.excess=1,this.decodeMode=ah.Strict}startEntity(t){this.decodeMode=t,this.state=Qi.EntityStart,this.result=0,this.treeIndex=0,this.excess=1,this.consumed=1}write(t,n){switch(this.state){case Qi.EntityStart:return t.charCodeAt(n)===ia.NUM?(this.state=Qi.NumericStart,this.consumed+=1,this.stateNumericStart(t,n+1)):(this.state=Qi.NamedEntity,this.stateNamedEntity(t,n));case Qi.NumericStart:return this.stateNumericStart(t,n);case Qi.NumericDecimal:return this.stateNumericDecimal(t,n);case Qi.NumericHex:return this.stateNumericHex(t,n);case Qi.NamedEntity:return this.stateNamedEntity(t,n)}}stateNumericStart(t,n){return n>=t.length?-1:(t.charCodeAt(n)|_Re)===ia.LOWER_X?(this.state=Qi.NumericHex,this.consumed+=1,this.stateNumericHex(t,n+1)):(this.state=Qi.NumericDecimal,this.stateNumericDecimal(t,n))}addToNumericResult(t,n,r,s){if(n!==r){const i=r-n;this.result=this.result*Math.pow(s,i)+parseInt(t.substr(n,i),s),this.consumed+=i}}stateNumericHex(t,n){const r=n;for(;n<t.length;){const s=t.charCodeAt(n);if(Mj(s)||SRe(s))n+=1;else return this.addToNumericResult(t,r,n,16),this.emitNumericEntity(s,3)}return this.addToNumericResult(t,r,n,16),-1}stateNumericDecimal(t,n){const r=n;for(;n<t.length;){const s=t.charCodeAt(n);if(Mj(s))n+=1;else return this.addToNumericResult(t,r,n,10),this.emitNumericEntity(s,2)}return this.addToNumericResult(t,r,n,10),-1}emitNumericEntity(t,n){var r;if(this.consumed<=n)return(r=this.errors)===null||r===void 0||r.absenceOfDigitsInNumericCharacterReference(this.consumed),0;if(t===ia.SEMI)this.consumed+=1;else if(this.decodeMode===ah.Strict)return 0;return this.emitCodePoint(wRe(this.result),this.consumed),this.errors&&(t!==ia.SEMI&&this.errors.missingSemicolonAfterCharacterReference(),this.errors.validateNumericCharacterReference(this.result)),this.consumed}stateNamedEntity(t,n){const{decodeTree:r}=this;let s=r[this.treeIndex],i=(s&ch.VALUE_LENGTH)>>14;for(;n<t.length;n++,this.excess++){const a=t.charCodeAt(n);if(this.treeIndex=TRe(r,s,this.treeIndex+Math.max(1,i),a),this.treeIndex<0)return this.result===0||this.decodeMode===ah.Attribute&&(i===0||kRe(a))?0:this.emitNotTerminatedNamedEntity();if(s=r[this.treeIndex],i=(s&ch.VALUE_LENGTH)>>14,i!==0){if(a===ia.SEMI)return this.emitNamedEntityData(this.treeIndex,i,this.consumed+this.excess);this.decodeMode!==ah.Strict&&(this.result=this.treeIndex,this.consumed+=this.excess,this.excess=0)}}return-1}emitNotTerminatedNamedEntity(){var t;const{result:n,decodeTree:r}=this,s=(r[n]&ch.VALUE_LENGTH)>>14;return this.emitNamedEntityData(n,s,this.consumed),(t=this.errors)===null||t===void 0||t.missingSemicolonAfterCharacterReference(),this.consumed}emitNamedEntityData(t,n,r){const{decodeTree:s}=this;return this.emitCodePoint(n===1?s[t]&~ch.VALUE_LENGTH:s[t+1],r),n===3&&this.emitCodePoint(s[t+2],r),r}end(){var t;switch(this.state){case Qi.NamedEntity:return this.result!==0&&(this.decodeMode!==ah.Attribute||this.result===this.treeIndex)?this.emitNotTerminatedNamedEntity():0;case Qi.NumericDecimal:return this.emitNumericEntity(0,2);case Qi.NumericHex:return this.emitNumericEntity(0,3);case Qi.NumericStart:return(t=this.errors)===null||t===void 0||t.absenceOfDigitsInNumericCharacterReference(this.consumed),0;case Qi.EntityStart:return 0}}}function qZ(e){let t="";const n=new ERe(e,r=>t+=xRe(r));return function(s,i){let a=0,o=0;for(;(o=s.indexOf("&",o))>=0;){t+=s.slice(a,o),n.startEntity(i);const c=n.write(s,o+1);if(c<0){a=o+n.end();break}a=o+c,o=c===0?a+1:a}const l=t+s.slice(a);return t="",l}}function TRe(e,t,n,r){const s=(t&ch.BRANCH_LENGTH)>>7,i=t&ch.JUMP_TABLE;if(s===0)return i!==0&&r===i?n:-1;if(i){const l=r-i;return l<0||l>=s?-1:e[n+l]-1}let a=n,o=a+s-1;for(;a<=o;){const l=a+o>>>1,c=e[l];if(c<r)a=l+1;else if(c>r)o=l-1;else return e[l+s]}return-1}const ARe=qZ(yRe);qZ(bRe);function VZ(e,t=ah.Legacy){return ARe(e,t)}function RRe(e){return Object.prototype.toString.call(e)}function gD(e){return RRe(e)==="[object String]"}const NRe=Object.prototype.hasOwnProperty;function MRe(e,t){return NRe.call(e,t)}function iT(e){return Array.prototype.slice.call(arguments,1).forEach(function(n){if(n){if(typeof n!="object")throw new TypeError(n+"must be object");Object.keys(n).forEach(function(r){e[r]=n[r]})}}),e}function WZ(e,t,n){return[].concat(e.slice(0,t),n,e.slice(t+1))}function yD(e){return!(e>=55296&&e<=57343||e>=64976&&e<=65007||(e&65535)===65535||(e&65535)===65534||e>=0&&e<=8||e===11||e>=14&&e<=31||e>=127&&e<=159||e>1114111)}function tk(e){if(e>65535){e-=65536;const t=55296+(e>>10),n=56320+(e&1023);return String.fromCharCode(t,n)}return String.fromCharCode(e)}const HZ=/\\([!"#$%&'()*+,\-./:;<=>?@[\\\]^_`{|}~])/g,IRe=/&([a-z#][a-z0-9]{1,31});/gi,jRe=new RegExp(HZ.source+"|"+IRe.source,"gi"),PRe=/^#((?:x[a-f0-9]{1,8}|[0-9]{1,8}))$/i;function ORe(e,t){if(t.charCodeAt(0)===35&&PRe.test(t)){const r=t[1].toLowerCase()==="x"?parseInt(t.slice(2),16):parseInt(t.slice(1),10);return yD(r)?tk(r):e}const n=VZ(e);return n!==e?n:e}function DRe(e){return e.indexOf("\\")<0?e:e.replace(HZ,"$1")}function gy(e){return e.indexOf("\\")<0&&e.indexOf("&")<0?e:e.replace(jRe,function(t,n,r){return n||ORe(t,r)})}const FRe=/[&<>"]/,LRe=/[&<>"]/g,BRe={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"};function $Re(e){return BRe[e]}function Ah(e){return FRe.test(e)?e.replace(LRe,$Re):e}const zRe=/[.?*+^$[\]\\(){}|-]/g;function URe(e){return e.replace(zRe,"\\$&")}function Ds(e){switch(e){case 9:case 32:return!0}return!1}function yw(e){if(e>=8192&&e<=8202)return!0;switch(e){case 9:case 10:case 11:case 12:case 13:case 32:case 160:case 5760:case 8239:case 8287:case 12288:return!0}return!1}function bw(e){return mD.test(e)||zZ.test(e)}function vw(e){switch(e){case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:case 41:case 42:case 43:case 44:case 45:case 46:case 47:case 58:case 59:case 60:case 61:case 62:case 63:case 64:case 91:case 92:case 93:case 94:case 95:case 96:case 123:case 124:case 125:case 126:return!0;default:return!1}}function aT(e){return e=e.trim().replace(/\s+/g," "),"ẞ".toLowerCase()==="Ṿ"&&(e=e.replace(/ẞ/g,"ß")),e.toLowerCase().toUpperCase()}const qRe={mdurl:pRe,ucmicro:gRe},VRe=Object.freeze(Object.defineProperty({__proto__:null,arrayReplaceAt:WZ,assign:iT,escapeHtml:Ah,escapeRE:URe,fromCodePoint:tk,has:MRe,isMdAsciiPunct:vw,isPunctChar:bw,isSpace:Ds,isString:gD,isValidEntityCode:yD,isWhiteSpace:yw,lib:qRe,normalizeReference:aT,unescapeAll:gy,unescapeMd:DRe},Symbol.toStringTag,{value:"Module"}));function WRe(e,t,n){let r,s,i,a;const o=e.posMax,l=e.pos;for(e.pos=t+1,r=1;e.pos<o;){if(i=e.src.charCodeAt(e.pos),i===93&&(r--,r===0)){s=!0;break}if(a=e.pos,e.md.inline.skipToken(e),i===91){if(a===e.pos-1)r++;else if(n)return e.pos=l,-1}}let c=-1;return s&&(c=e.pos),e.pos=l,c}function HRe(e,t,n){let r,s=t;const i={ok:!1,pos:0,str:""};if(e.charCodeAt(s)===60){for(s++;s<n;){if(r=e.charCodeAt(s),r===10||r===60)return i;if(r===62)return i.pos=s+1,i.str=gy(e.slice(t+1,s)),i.ok=!0,i;if(r===92&&s+1<n){s+=2;continue}s++}return i}let a=0;for(;s<n&&(r=e.charCodeAt(s),!(r===32||r<32||r===127));){if(r===92&&s+1<n){if(e.charCodeAt(s+1)===32)break;s+=2;continue}if(r===40&&(a++,a>32))return i;if(r===41){if(a===0)break;a--}s++}return t===s||a!==0||(i.str=gy(e.slice(t,s)),i.pos=s,i.ok=!0),i}function GRe(e,t,n,r){let s,i=t;const a={ok:!1,can_continue:!1,pos:0,str:"",marker:0};if(r)a.str=r.str,a.marker=r.marker;else{if(i>=n)return a;let o=e.charCodeAt(i);if(o!==34&&o!==39&&o!==40)return a;t++,i++,o===40&&(o=41),a.marker=o}for(;i<n;){if(s=e.charCodeAt(i),s===a.marker)return a.pos=i+1,a.str+=gy(e.slice(t,i)),a.ok=!0,a;if(s===40&&a.marker===41)return a;s===92&&i+1<n&&i++,i++}return a.can_continue=!0,a.str+=gy(e.slice(t,i)),a}const KRe=Object.freeze(Object.defineProperty({__proto__:null,parseLinkDestination:HRe,parseLinkLabel:WRe,parseLinkTitle:GRe},Symbol.toStringTag,{value:"Module"})),Bu={};Bu.code_inline=function(e,t,n,r,s){const i=e[t];return"<code"+s.renderAttrs(i)+">"+Ah(i.content)+"</code>"};Bu.code_block=function(e,t,n,r,s){const i=e[t];return"<pre"+s.renderAttrs(i)+"><code>"+Ah(e[t].content)+`</code></pre>
`};Bu.fence=function(e,t,n,r,s){const i=e[t],a=i.info?gy(i.info).trim():"";let o="",l="";if(a){const u=a.split(/(\s+)/g);o=u[0],l=u.slice(2).join("")}let c;if(n.highlight?c=n.highlight(i.content,o,l)||Ah(i.content):c=Ah(i.content),c.indexOf("<pre")===0)return c+`
`;if(a){const u=i.attrIndex("class"),d=i.attrs?i.attrs.slice():[];u<0?d.push(["class",n.langPrefix+o]):(d[u]=d[u].slice(),d[u][1]+=" "+n.langPrefix+o);const h={attrs:d};return`<pre><code${s.renderAttrs(h)}>${c}</code></pre>
`}return`<pre><code${s.renderAttrs(i)}>${c}</code></pre>
`};Bu.image=function(e,t,n,r,s){const i=e[t];return i.attrs[i.attrIndex("alt")][1]=s.renderInlineAsText(i.children,n,r),s.renderToken(e,t,n)};Bu.hardbreak=function(e,t,n){return n.xhtmlOut?`<br />
`:`<br>
`};Bu.softbreak=function(e,t,n){return n.breaks?n.xhtmlOut?`<br />
`:`<br>
`:`
`};Bu.text=function(e,t){return Ah(e[t].content)};Bu.html_block=function(e,t){return e[t].content};Bu.html_inline=function(e,t){return e[t].content};function nb(){this.rules=iT({},Bu)}nb.prototype.renderAttrs=function(t){let n,r,s;if(!t.attrs)return"";for(s="",n=0,r=t.attrs.length;n<r;n++)s+=" "+Ah(t.attrs[n][0])+'="'+Ah(t.attrs[n][1])+'"';return s};nb.prototype.renderToken=function(t,n,r){const s=t[n];let i="";if(s.hidden)return"";s.block&&s.nesting!==-1&&n&&t[n-1].hidden&&(i+=`
`),i+=(s.nesting===-1?"</":"<")+s.tag,i+=this.renderAttrs(s),s.nesting===0&&r.xhtmlOut&&(i+=" /");let a=!1;if(s.block&&(a=!0,s.nesting===1&&n+1<t.length)){const o=t[n+1];(o.type==="inline"||o.hidden||o.nesting===-1&&o.tag===s.tag)&&(a=!1)}return i+=a?`>
`:">",i};nb.prototype.renderInline=function(e,t,n){let r="";const s=this.rules;for(let i=0,a=e.length;i<a;i++){const o=e[i].type;typeof s[o]<"u"?r+=s[o](e,i,t,n,this):r+=this.renderToken(e,i,t)}return r};nb.prototype.renderInlineAsText=function(e,t,n){let r="";for(let s=0,i=e.length;s<i;s++)switch(e[s].type){case"text":r+=e[s].content;break;case"image":r+=this.renderInlineAsText(e[s].children,t,n);break;case"html_inline":case"html_block":r+=e[s].content;break;case"softbreak":case"hardbreak":r+=`
`;break}return r};nb.prototype.render=function(e,t,n){let r="";const s=this.rules;for(let i=0,a=e.length;i<a;i++){const o=e[i].type;o==="inline"?r+=this.renderInline(e[i].children,t,n):typeof s[o]<"u"?r+=s[o](e,i,t,n,this):r+=this.renderToken(e,i,t,n)}return r};function Do(){this.__rules__=[],this.__cache__=null}Do.prototype.__find__=function(e){for(let t=0;t<this.__rules__.length;t++)if(this.__rules__[t].name===e)return t;return-1};Do.prototype.__compile__=function(){const e=this,t=[""];e.__rules__.forEach(function(n){n.enabled&&n.alt.forEach(function(r){t.indexOf(r)<0&&t.push(r)})}),e.__cache__={},t.forEach(function(n){e.__cache__[n]=[],e.__rules__.forEach(function(r){r.enabled&&(n&&r.alt.indexOf(n)<0||e.__cache__[n].push(r.fn))})})};Do.prototype.at=function(e,t,n){const r=this.__find__(e),s=n||{};if(r===-1)throw new Error("Parser rule not found: "+e);this.__rules__[r].fn=t,this.__rules__[r].alt=s.alt||[],this.__cache__=null};Do.prototype.before=function(e,t,n,r){const s=this.__find__(e),i=r||{};if(s===-1)throw new Error("Parser rule not found: "+e);this.__rules__.splice(s,0,{name:t,enabled:!0,fn:n,alt:i.alt||[]}),this.__cache__=null};Do.prototype.after=function(e,t,n,r){const s=this.__find__(e),i=r||{};if(s===-1)throw new Error("Parser rule not found: "+e);this.__rules__.splice(s+1,0,{name:t,enabled:!0,fn:n,alt:i.alt||[]}),this.__cache__=null};Do.prototype.push=function(e,t,n){const r=n||{};this.__rules__.push({name:e,enabled:!0,fn:t,alt:r.alt||[]}),this.__cache__=null};Do.prototype.enable=function(e,t){Array.isArray(e)||(e=[e]);const n=[];return e.forEach(function(r){const s=this.__find__(r);if(s<0){if(t)return;throw new Error("Rules manager: invalid rule name "+r)}this.__rules__[s].enabled=!0,n.push(r)},this),this.__cache__=null,n};Do.prototype.enableOnly=function(e,t){Array.isArray(e)||(e=[e]),this.__rules__.forEach(function(n){n.enabled=!1}),this.enable(e,t)};Do.prototype.disable=function(e,t){Array.isArray(e)||(e=[e]);const n=[];return e.forEach(function(r){const s=this.__find__(r);if(s<0){if(t)return;throw new Error("Rules manager: invalid rule name "+r)}this.__rules__[s].enabled=!1,n.push(r)},this),this.__cache__=null,n};Do.prototype.getRules=function(e){return this.__cache__===null&&this.__compile__(),this.__cache__[e]||[]};function $c(e,t,n){this.type=e,this.tag=t,this.attrs=null,this.map=null,this.nesting=n,this.level=0,this.children=null,this.content="",this.markup="",this.info="",this.meta=null,this.block=!1,this.hidden=!1}$c.prototype.attrIndex=function(t){if(!this.attrs)return-1;const n=this.attrs;for(let r=0,s=n.length;r<s;r++)if(n[r][0]===t)return r;return-1};$c.prototype.attrPush=function(t){this.attrs?this.attrs.push(t):this.attrs=[t]};$c.prototype.attrSet=function(t,n){const r=this.attrIndex(t),s=[t,n];r<0?this.attrPush(s):this.attrs[r]=s};$c.prototype.attrGet=function(t){const n=this.attrIndex(t);let r=null;return n>=0&&(r=this.attrs[n][1]),r};$c.prototype.attrJoin=function(t,n){const r=this.attrIndex(t);r<0?this.attrPush([t,n]):this.attrs[r][1]=this.attrs[r][1]+" "+n};function GZ(e,t,n){this.src=e,this.env=n,this.tokens=[],this.inlineMode=!1,this.md=t}GZ.prototype.Token=$c;const YRe=/\r\n?|\n/g,ZRe=/\0/g;function XRe(e){let t;t=e.src.replace(YRe,`
`),t=t.replace(ZRe,"�"),e.src=t}function JRe(e){let t;e.inlineMode?(t=new e.Token("inline","",0),t.content=e.src,t.map=[0,1],t.children=[],e.tokens.push(t)):e.md.block.parse(e.src,e.md,e.env,e.tokens)}function QRe(e){const t=e.tokens;for(let n=0,r=t.length;n<r;n++){const s=t[n];s.type==="inline"&&e.md.inline.parse(s.content,e.md,e.env,s.children)}}function eNe(e){return/^<a[>\s]/i.test(e)}function tNe(e){return/^<\/a\s*>/i.test(e)}function nNe(e){const t=e.tokens;if(e.md.options.linkify)for(let n=0,r=t.length;n<r;n++){if(t[n].type!=="inline"||!e.md.linkify.pretest(t[n].content))continue;let s=t[n].children,i=0;for(let a=s.length-1;a>=0;a--){const o=s[a];if(o.type==="link_close"){for(a--;s[a].level!==o.level&&s[a].type!=="link_open";)a--;continue}if(o.type==="html_inline"&&(eNe(o.content)&&i>0&&i--,tNe(o.content)&&i++),!(i>0)&&o.type==="text"&&e.md.linkify.test(o.content)){const l=o.content;let c=e.md.linkify.match(l);const u=[];let d=o.level,h=0;c.length>0&&c[0].index===0&&a>0&&s[a-1].type==="text_special"&&(c=c.slice(1));for(let m=0;m<c.length;m++){const y=c[m].url,b=e.md.normalizeLink(y);if(!e.md.validateLink(b))continue;let v=c[m].text;c[m].schema?c[m].schema==="mailto:"&&!/^mailto:/i.test(v)?v=e.md.normalizeLinkText("mailto:"+v).replace(/^mailto:/,""):v=e.md.normalizeLinkText(v):v=e.md.normalizeLinkText("http://"+v).replace(/^http:\/\//,"");const x=c[m].index;if(x>h){const k=new e.Token("text","",0);k.content=l.slice(h,x),k.level=d,u.push(k)}const w=new e.Token("link_open","a",1);w.attrs=[["href",b]],w.level=d++,w.markup="linkify",w.info="auto",u.push(w);const S=new e.Token("text","",0);S.content=v,S.level=d,u.push(S);const C=new e.Token("link_close","a",-1);C.level=--d,C.markup="linkify",C.info="auto",u.push(C),h=c[m].lastIndex}if(h<l.length){const m=new e.Token("text","",0);m.content=l.slice(h),m.level=d,u.push(m)}t[n].children=s=WZ(s,a,u)}}}}const KZ=/\+-|\.\.|\?\?\?\?|!!!!|,,|--/,rNe=/\((c|tm|r)\)/i,sNe=/\((c|tm|r)\)/ig,iNe={c:"©",r:"®",tm:"™"};function aNe(e,t){return iNe[t.toLowerCase()]}function oNe(e){let t=0;for(let n=e.length-1;n>=0;n--){const r=e[n];r.type==="text"&&!t&&(r.content=r.content.replace(sNe,aNe)),r.type==="link_open"&&r.info==="auto"&&t--,r.type==="link_close"&&r.info==="auto"&&t++}}function lNe(e){let t=0;for(let n=e.length-1;n>=0;n--){const r=e[n];r.type==="text"&&!t&&KZ.test(r.content)&&(r.content=r.content.replace(/\+-/g,"±").replace(/\.{2,}/g,"…").replace(/([?!])…/g,"$1..").replace(/([?!]){4,}/g,"$1$1$1").replace(/,{2,}/g,",").replace(/(^|[^-])---(?=[^-]|$)/mg,"$1—").replace(/(^|\s)--(?=\s|$)/mg,"$1–").replace(/(^|[^-\s])--(?=[^-\s]|$)/mg,"$1–")),r.type==="link_open"&&r.info==="auto"&&t--,r.type==="link_close"&&r.info==="auto"&&t++}}function cNe(e){let t;if(e.md.options.typographer)for(t=e.tokens.length-1;t>=0;t--)e.tokens[t].type==="inline"&&(rNe.test(e.tokens[t].content)&&oNe(e.tokens[t].children),KZ.test(e.tokens[t].content)&&lNe(e.tokens[t].children))}const uNe=/['"]/,zz=/['"]/g,Uz="’";function $S(e,t,n){return e.slice(0,t)+n+e.slice(t+1)}function dNe(e,t){let n;const r=[];for(let s=0;s<e.length;s++){const i=e[s],a=e[s].level;for(n=r.length-1;n>=0&&!(r[n].level<=a);n--);if(r.length=n+1,i.type!=="text")continue;let o=i.content,l=0,c=o.length;e:for(;l<c;){zz.lastIndex=l;const u=zz.exec(o);if(!u)break;let d=!0,h=!0;l=u.index+1;const m=u[0]==="'";let y=32;if(u.index-1>=0)y=o.charCodeAt(u.index-1);else for(n=s-1;n>=0&&!(e[n].type==="softbreak"||e[n].type==="hardbreak");n--)if(e[n].content){y=e[n].content.charCodeAt(e[n].content.length-1);break}let b=32;if(l<c)b=o.charCodeAt(l);else for(n=s+1;n<e.length&&!(e[n].type==="softbreak"||e[n].type==="hardbreak");n++)if(e[n].content){b=e[n].content.charCodeAt(0);break}const v=vw(y)||bw(String.fromCharCode(y)),x=vw(b)||bw(String.fromCharCode(b)),w=yw(y),S=yw(b);if(S?d=!1:x&&(w||v||(d=!1)),w?h=!1:v&&(S||x||(h=!1)),b===34&&u[0]==='"'&&y>=48&&y<=57&&(h=d=!1),d&&h&&(d=v,h=x),!d&&!h){m&&(i.content=$S(i.content,u.index,Uz));continue}if(h)for(n=r.length-1;n>=0;n--){let C=r[n];if(r[n].level<a)break;if(C.single===m&&r[n].level===a){C=r[n];let k,A;m?(k=t.md.options.quotes[2],A=t.md.options.quotes[3]):(k=t.md.options.quotes[0],A=t.md.options.quotes[1]),i.content=$S(i.content,u.index,A),e[C.token].content=$S(e[C.token].content,C.pos,k),l+=A.length-1,C.token===s&&(l+=k.length-1),o=i.content,c=o.length,r.length=n;continue e}}d?r.push({token:s,pos:u.index,single:m,level:a}):h&&m&&(i.content=$S(i.content,u.index,Uz))}}}function fNe(e){if(e.md.options.typographer)for(let t=e.tokens.length-1;t>=0;t--)e.tokens[t].type!=="inline"||!uNe.test(e.tokens[t].content)||dNe(e.tokens[t].children,e)}function hNe(e){let t,n;const r=e.tokens,s=r.length;for(let i=0;i<s;i++){if(r[i].type!=="inline")continue;const a=r[i].children,o=a.length;for(t=0;t<o;t++)a[t].type==="text_special"&&(a[t].type="text");for(t=n=0;t<o;t++)a[t].type==="text"&&t+1<o&&a[t+1].type==="text"?a[t+1].content=a[t].content+a[t+1].content:(t!==n&&(a[n]=a[t]),n++);t!==n&&(a.length=n)}}const cI=[["normalize",XRe],["block",JRe],["inline",QRe],["linkify",nNe],["replacements",cNe],["smartquotes",fNe],["text_join",hNe]];function bD(){this.ruler=new Do;for(let e=0;e<cI.length;e++)this.ruler.push(cI[e][0],cI[e][1])}bD.prototype.process=function(e){const t=this.ruler.getRules("");for(let n=0,r=t.length;n<r;n++)t[n](e)};bD.prototype.State=GZ;function $u(e,t,n,r){this.src=e,this.md=t,this.env=n,this.tokens=r,this.bMarks=[],this.eMarks=[],this.tShift=[],this.sCount=[],this.bsCount=[],this.blkIndent=0,this.line=0,this.lineMax=0,this.tight=!1,this.ddIndent=-1,this.listIndent=-1,this.parentType="root",this.level=0;const s=this.src;for(let i=0,a=0,o=0,l=0,c=s.length,u=!1;a<c;a++){const d=s.charCodeAt(a);if(!u)if(Ds(d)){o++,d===9?l+=4-l%4:l++;continue}else u=!0;(d===10||a===c-1)&&(d!==10&&a++,this.bMarks.push(i),this.eMarks.push(a),this.tShift.push(o),this.sCount.push(l),this.bsCount.push(0),u=!1,o=0,l=0,i=a+1)}this.bMarks.push(s.length),this.eMarks.push(s.length),this.tShift.push(0),this.sCount.push(0),this.bsCount.push(0),this.lineMax=this.bMarks.length-1}$u.prototype.push=function(e,t,n){const r=new $c(e,t,n);return r.block=!0,n<0&&this.level--,r.level=this.level,n>0&&this.level++,this.tokens.push(r),r};$u.prototype.isEmpty=function(t){return this.bMarks[t]+this.tShift[t]>=this.eMarks[t]};$u.prototype.skipEmptyLines=function(t){for(let n=this.lineMax;t<n&&!(this.bMarks[t]+this.tShift[t]<this.eMarks[t]);t++);return t};$u.prototype.skipSpaces=function(t){for(let n=this.src.length;t<n;t++){const r=this.src.charCodeAt(t);if(!Ds(r))break}return t};$u.prototype.skipSpacesBack=function(t,n){if(t<=n)return t;for(;t>n;)if(!Ds(this.src.charCodeAt(--t)))return t+1;return t};$u.prototype.skipChars=function(t,n){for(let r=this.src.length;t<r&&this.src.charCodeAt(t)===n;t++);return t};$u.prototype.skipCharsBack=function(t,n,r){if(t<=r)return t;for(;t>r;)if(n!==this.src.charCodeAt(--t))return t+1;return t};$u.prototype.getLines=function(t,n,r,s){if(t>=n)return"";const i=new Array(n-t);for(let a=0,o=t;o<n;o++,a++){let l=0;const c=this.bMarks[o];let u=c,d;for(o+1<n||s?d=this.eMarks[o]+1:d=this.eMarks[o];u<d&&l<r;){const h=this.src.charCodeAt(u);if(Ds(h))h===9?l+=4-(l+this.bsCount[o])%4:l++;else if(u-c<this.tShift[o])l++;else break;u++}l>r?i[a]=new Array(l-r+1).join(" ")+this.src.slice(u,d):i[a]=this.src.slice(u,d)}return i.join("")};$u.prototype.Token=$c;const pNe=65536;function uI(e,t){const n=e.bMarks[t]+e.tShift[t],r=e.eMarks[t];return e.src.slice(n,r)}function qz(e){const t=[],n=e.length;let r=0,s=e.charCodeAt(r),i=!1,a=0,o="";for(;r<n;)s===124&&(i?(o+=e.substring(a,r-1),a=r):(t.push(o+e.substring(a,r)),o="",a=r+1)),i=s===92,r++,s=e.charCodeAt(r);return t.push(o+e.substring(a)),t}function mNe(e,t,n,r){if(t+2>n)return!1;let s=t+1;if(e.sCount[s]<e.blkIndent||e.sCount[s]-e.blkIndent>=4)return!1;let i=e.bMarks[s]+e.tShift[s];if(i>=e.eMarks[s])return!1;const a=e.src.charCodeAt(i++);if(a!==124&&a!==45&&a!==58||i>=e.eMarks[s])return!1;const o=e.src.charCodeAt(i++);if(o!==124&&o!==45&&o!==58&&!Ds(o)||a===45&&Ds(o))return!1;for(;i<e.eMarks[s];){const C=e.src.charCodeAt(i);if(C!==124&&C!==45&&C!==58&&!Ds(C))return!1;i++}let l=uI(e,t+1),c=l.split("|");const u=[];for(let C=0;C<c.length;C++){const k=c[C].trim();if(!k){if(C===0||C===c.length-1)continue;return!1}if(!/^:?-+:?$/.test(k))return!1;k.charCodeAt(k.length-1)===58?u.push(k.charCodeAt(0)===58?"center":"right"):k.charCodeAt(0)===58?u.push("left"):u.push("")}if(l=uI(e,t).trim(),l.indexOf("|")===-1||e.sCount[t]-e.blkIndent>=4)return!1;c=qz(l),c.length&&c[0]===""&&c.shift(),c.length&&c[c.length-1]===""&&c.pop();const d=c.length;if(d===0||d!==u.length)return!1;if(r)return!0;const h=e.parentType;e.parentType="table";const m=e.md.block.ruler.getRules("blockquote"),y=e.push("table_open","table",1),b=[t,0];y.map=b;const v=e.push("thead_open","thead",1);v.map=[t,t+1];const x=e.push("tr_open","tr",1);x.map=[t,t+1];for(let C=0;C<c.length;C++){const k=e.push("th_open","th",1);u[C]&&(k.attrs=[["style","text-align:"+u[C]]]);const A=e.push("inline","",0);A.content=c[C].trim(),A.children=[],e.push("th_close","th",-1)}e.push("tr_close","tr",-1),e.push("thead_close","thead",-1);let w,S=0;for(s=t+2;s<n&&!(e.sCount[s]<e.blkIndent);s++){let C=!1;for(let A=0,R=m.length;A<R;A++)if(m[A](e,s,n,!0)){C=!0;break}if(C||(l=uI(e,s).trim(),!l)||e.sCount[s]-e.blkIndent>=4||(c=qz(l),c.length&&c[0]===""&&c.shift(),c.length&&c[c.length-1]===""&&c.pop(),S+=d-c.length,S>pNe))break;if(s===t+2){const A=e.push("tbody_open","tbody",1);A.map=w=[t+2,0]}const k=e.push("tr_open","tr",1);k.map=[s,s+1];for(let A=0;A<d;A++){const R=e.push("td_open","td",1);u[A]&&(R.attrs=[["style","text-align:"+u[A]]]);const N=e.push("inline","",0);N.content=c[A]?c[A].trim():"",N.children=[],e.push("td_close","td",-1)}e.push("tr_close","tr",-1)}return w&&(e.push("tbody_close","tbody",-1),w[1]=s),e.push("table_close","table",-1),b[1]=s,e.parentType=h,e.line=s,!0}function gNe(e,t,n){if(e.sCount[t]-e.blkIndent<4)return!1;let r=t+1,s=r;for(;r<n;){if(e.isEmpty(r)){r++;continue}if(e.sCount[r]-e.blkIndent>=4){r++,s=r;continue}break}e.line=s;const i=e.push("code_block","code",0);return i.content=e.getLines(t,s,4+e.blkIndent,!1)+`
`,i.map=[t,e.line],!0}function yNe(e,t,n,r){let s=e.bMarks[t]+e.tShift[t],i=e.eMarks[t];if(e.sCount[t]-e.blkIndent>=4||s+3>i)return!1;const a=e.src.charCodeAt(s);if(a!==126&&a!==96)return!1;let o=s;s=e.skipChars(s,a);let l=s-o;if(l<3)return!1;const c=e.src.slice(o,s),u=e.src.slice(s,i);if(a===96&&u.indexOf(String.fromCharCode(a))>=0)return!1;if(r)return!0;let d=t,h=!1;for(;d++,!(d>=n||(s=o=e.bMarks[d]+e.tShift[d],i=e.eMarks[d],s<i&&e.sCount[d]<e.blkIndent));)if(e.src.charCodeAt(s)===a&&!(e.sCount[d]-e.blkIndent>=4)&&(s=e.skipChars(s,a),!(s-o<l)&&(s=e.skipSpaces(s),!(s<i)))){h=!0;break}l=e.sCount[t],e.line=d+(h?1:0);const m=e.push("fence","code",0);return m.info=u,m.content=e.getLines(t+1,d,l,!0),m.markup=c,m.map=[t,e.line],!0}function bNe(e,t,n,r){let s=e.bMarks[t]+e.tShift[t],i=e.eMarks[t];const a=e.lineMax;if(e.sCount[t]-e.blkIndent>=4||e.src.charCodeAt(s)!==62)return!1;if(r)return!0;const o=[],l=[],c=[],u=[],d=e.md.block.ruler.getRules("blockquote"),h=e.parentType;e.parentType="blockquote";let m=!1,y;for(y=t;y<n;y++){const S=e.sCount[y]<e.blkIndent;if(s=e.bMarks[y]+e.tShift[y],i=e.eMarks[y],s>=i)break;if(e.src.charCodeAt(s++)===62&&!S){let k=e.sCount[y]+1,A,R;e.src.charCodeAt(s)===32?(s++,k++,R=!1,A=!0):e.src.charCodeAt(s)===9?(A=!0,(e.bsCount[y]+k)%4===3?(s++,k++,R=!1):R=!0):A=!1;let N=k;for(o.push(e.bMarks[y]),e.bMarks[y]=s;s<i;){const I=e.src.charCodeAt(s);if(Ds(I))I===9?N+=4-(N+e.bsCount[y]+(R?1:0))%4:N++;else break;s++}m=s>=i,l.push(e.bsCount[y]),e.bsCount[y]=e.sCount[y]+1+(A?1:0),c.push(e.sCount[y]),e.sCount[y]=N-k,u.push(e.tShift[y]),e.tShift[y]=s-e.bMarks[y];continue}if(m)break;let C=!1;for(let k=0,A=d.length;k<A;k++)if(d[k](e,y,n,!0)){C=!0;break}if(C){e.lineMax=y,e.blkIndent!==0&&(o.push(e.bMarks[y]),l.push(e.bsCount[y]),u.push(e.tShift[y]),c.push(e.sCount[y]),e.sCount[y]-=e.blkIndent);break}o.push(e.bMarks[y]),l.push(e.bsCount[y]),u.push(e.tShift[y]),c.push(e.sCount[y]),e.sCount[y]=-1}const b=e.blkIndent;e.blkIndent=0;const v=e.push("blockquote_open","blockquote",1);v.markup=">";const x=[t,0];v.map=x,e.md.block.tokenize(e,t,y);const w=e.push("blockquote_close","blockquote",-1);w.markup=">",e.lineMax=a,e.parentType=h,x[1]=e.line;for(let S=0;S<u.length;S++)e.bMarks[S+t]=o[S],e.tShift[S+t]=u[S],e.sCount[S+t]=c[S],e.bsCount[S+t]=l[S];return e.blkIndent=b,!0}function vNe(e,t,n,r){const s=e.eMarks[t];if(e.sCount[t]-e.blkIndent>=4)return!1;let i=e.bMarks[t]+e.tShift[t];const a=e.src.charCodeAt(i++);if(a!==42&&a!==45&&a!==95)return!1;let o=1;for(;i<s;){const c=e.src.charCodeAt(i++);if(c!==a&&!Ds(c))return!1;c===a&&o++}if(o<3)return!1;if(r)return!0;e.line=t+1;const l=e.push("hr","hr",0);return l.map=[t,e.line],l.markup=Array(o+1).join(String.fromCharCode(a)),!0}function Vz(e,t){const n=e.eMarks[t];let r=e.bMarks[t]+e.tShift[t];const s=e.src.charCodeAt(r++);if(s!==42&&s!==45&&s!==43)return-1;if(r<n){const i=e.src.charCodeAt(r);if(!Ds(i))return-1}return r}function Wz(e,t){const n=e.bMarks[t]+e.tShift[t],r=e.eMarks[t];let s=n;if(s+1>=r)return-1;let i=e.src.charCodeAt(s++);if(i<48||i>57)return-1;for(;;){if(s>=r)return-1;if(i=e.src.charCodeAt(s++),i>=48&&i<=57){if(s-n>=10)return-1;continue}if(i===41||i===46)break;return-1}return s<r&&(i=e.src.charCodeAt(s),!Ds(i))?-1:s}function xNe(e,t){const n=e.level+2;for(let r=t+2,s=e.tokens.length-2;r<s;r++)e.tokens[r].level===n&&e.tokens[r].type==="paragraph_open"&&(e.tokens[r+2].hidden=!0,e.tokens[r].hidden=!0,r+=2)}function wNe(e,t,n,r){let s,i,a,o,l=t,c=!0;if(e.sCount[l]-e.blkIndent>=4||e.listIndent>=0&&e.sCount[l]-e.listIndent>=4&&e.sCount[l]<e.blkIndent)return!1;let u=!1;r&&e.parentType==="paragraph"&&e.sCount[l]>=e.blkIndent&&(u=!0);let d,h,m;if((m=Wz(e,l))>=0){if(d=!0,a=e.bMarks[l]+e.tShift[l],h=Number(e.src.slice(a,m-1)),u&&h!==1)return!1}else if((m=Vz(e,l))>=0)d=!1;else return!1;if(u&&e.skipSpaces(m)>=e.eMarks[l])return!1;if(r)return!0;const y=e.src.charCodeAt(m-1),b=e.tokens.length;d?(o=e.push("ordered_list_open","ol",1),h!==1&&(o.attrs=[["start",h]])):o=e.push("bullet_list_open","ul",1);const v=[l,0];o.map=v,o.markup=String.fromCharCode(y);let x=!1;const w=e.md.block.ruler.getRules("list"),S=e.parentType;for(e.parentType="list";l<n;){i=m,s=e.eMarks[l];const C=e.sCount[l]+m-(e.bMarks[l]+e.tShift[l]);let k=C;for(;i<s;){const Z=e.src.charCodeAt(i);if(Z===9)k+=4-(k+e.bsCount[l])%4;else if(Z===32)k++;else break;i++}const A=i;let R;A>=s?R=1:R=k-C,R>4&&(R=1);const N=C+R;o=e.push("list_item_open","li",1),o.markup=String.fromCharCode(y);const I=[l,0];o.map=I,d&&(o.info=e.src.slice(a,m-1));const P=e.tight,L=e.tShift[l],O=e.sCount[l],V=e.listIndent;if(e.listIndent=e.blkIndent,e.blkIndent=N,e.tight=!0,e.tShift[l]=A-e.bMarks[l],e.sCount[l]=k,A>=s&&e.isEmpty(l+1)?e.line=Math.min(e.line+2,n):e.md.block.tokenize(e,l,n,!0),(!e.tight||x)&&(c=!1),x=e.line-l>1&&e.isEmpty(e.line-1),e.blkIndent=e.listIndent,e.listIndent=V,e.tShift[l]=L,e.sCount[l]=O,e.tight=P,o=e.push("list_item_close","li",-1),o.markup=String.fromCharCode(y),l=e.line,I[1]=l,l>=n||e.sCount[l]<e.blkIndent||e.sCount[l]-e.blkIndent>=4)break;let D=!1;for(let Z=0,U=w.length;Z<U;Z++)if(w[Z](e,l,n,!0)){D=!0;break}if(D)break;if(d){if(m=Wz(e,l),m<0)break;a=e.bMarks[l]+e.tShift[l]}else if(m=Vz(e,l),m<0)break;if(y!==e.src.charCodeAt(m-1))break}return d?o=e.push("ordered_list_close","ol",-1):o=e.push("bullet_list_close","ul",-1),o.markup=String.fromCharCode(y),v[1]=l,e.line=l,e.parentType=S,c&&xNe(e,b),!0}function _Ne(e,t,n,r){let s=e.bMarks[t]+e.tShift[t],i=e.eMarks[t],a=t+1;if(e.sCount[t]-e.blkIndent>=4||e.src.charCodeAt(s)!==91)return!1;function o(w){const S=e.lineMax;if(w>=S||e.isEmpty(w))return null;let C=!1;if(e.sCount[w]-e.blkIndent>3&&(C=!0),e.sCount[w]<0&&(C=!0),!C){const R=e.md.block.ruler.getRules("reference"),N=e.parentType;e.parentType="reference";let I=!1;for(let P=0,L=R.length;P<L;P++)if(R[P](e,w,S,!0)){I=!0;break}if(e.parentType=N,I)return null}const k=e.bMarks[w]+e.tShift[w],A=e.eMarks[w];return e.src.slice(k,A+1)}let l=e.src.slice(s,i+1);i=l.length;let c=-1;for(s=1;s<i;s++){const w=l.charCodeAt(s);if(w===91)return!1;if(w===93){c=s;break}else if(w===10){const S=o(a);S!==null&&(l+=S,i=l.length,a++)}else if(w===92&&(s++,s<i&&l.charCodeAt(s)===10)){const S=o(a);S!==null&&(l+=S,i=l.length,a++)}}if(c<0||l.charCodeAt(c+1)!==58)return!1;for(s=c+2;s<i;s++){const w=l.charCodeAt(s);if(w===10){const S=o(a);S!==null&&(l+=S,i=l.length,a++)}else if(!Ds(w))break}const u=e.md.helpers.parseLinkDestination(l,s,i);if(!u.ok)return!1;const d=e.md.normalizeLink(u.str);if(!e.md.validateLink(d))return!1;s=u.pos;const h=s,m=a,y=s;for(;s<i;s++){const w=l.charCodeAt(s);if(w===10){const S=o(a);S!==null&&(l+=S,i=l.length,a++)}else if(!Ds(w))break}let b=e.md.helpers.parseLinkTitle(l,s,i);for(;b.can_continue;){const w=o(a);if(w===null)break;l+=w,s=i,i=l.length,a++,b=e.md.helpers.parseLinkTitle(l,s,i,b)}let v;for(s<i&&y!==s&&b.ok?(v=b.str,s=b.pos):(v="",s=h,a=m);s<i;){const w=l.charCodeAt(s);if(!Ds(w))break;s++}if(s<i&&l.charCodeAt(s)!==10&&v)for(v="",s=h,a=m;s<i;){const w=l.charCodeAt(s);if(!Ds(w))break;s++}if(s<i&&l.charCodeAt(s)!==10)return!1;const x=aT(l.slice(1,c));return x?(r||(typeof e.env.references>"u"&&(e.env.references={}),typeof e.env.references[x]>"u"&&(e.env.references[x]={title:v,href:d}),e.line=a),!0):!1}const SNe=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],CNe="[a-zA-Z_:][a-zA-Z0-9:._-]*",kNe="[^\"'=<>`\\x00-\\x20]+",ENe="'[^']*'",TNe='"[^"]*"',ANe="(?:"+kNe+"|"+ENe+"|"+TNe+")",RNe="(?:\\s+"+CNe+"(?:\\s*=\\s*"+ANe+")?)",YZ="<[A-Za-z][A-Za-z0-9\\-]*"+RNe+"*\\s*\\/?>",ZZ="<\\/[A-Za-z][A-Za-z0-9\\-]*\\s*>",NNe="<!---?>|<!--(?:[^-]|-[^-]|--[^>])*-->",MNe="<[?][\\s\\S]*?[?]>",INe="<![A-Za-z][^>]*>",jNe="<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",PNe=new RegExp("^(?:"+YZ+"|"+ZZ+"|"+NNe+"|"+MNe+"|"+INe+"|"+jNe+")"),ONe=new RegExp("^(?:"+YZ+"|"+ZZ+")"),Qg=[[/^<(script|pre|style|textarea)(?=(\s|>|$))/i,/<\/(script|pre|style|textarea)>/i,!0],[/^<!--/,/-->/,!0],[/^<\?/,/\?>/,!0],[/^<![A-Z]/,/>/,!0],[/^<!\[CDATA\[/,/\]\]>/,!0],[new RegExp("^</?("+SNe.join("|")+")(?=(\\s|/?>|$))","i"),/^$/,!0],[new RegExp(ONe.source+"\\s*$"),/^$/,!1]];function DNe(e,t,n,r){let s=e.bMarks[t]+e.tShift[t],i=e.eMarks[t];if(e.sCount[t]-e.blkIndent>=4||!e.md.options.html||e.src.charCodeAt(s)!==60)return!1;let a=e.src.slice(s,i),o=0;for(;o<Qg.length&&!Qg[o][0].test(a);o++);if(o===Qg.length)return!1;if(r)return Qg[o][2];let l=t+1;if(!Qg[o][1].test(a)){for(;l<n&&!(e.sCount[l]<e.blkIndent);l++)if(s=e.bMarks[l]+e.tShift[l],i=e.eMarks[l],a=e.src.slice(s,i),Qg[o][1].test(a)){a.length!==0&&l++;break}}e.line=l;const c=e.push("html_block","",0);return c.map=[t,l],c.content=e.getLines(t,l,e.blkIndent,!0),!0}function FNe(e,t,n,r){let s=e.bMarks[t]+e.tShift[t],i=e.eMarks[t];if(e.sCount[t]-e.blkIndent>=4)return!1;let a=e.src.charCodeAt(s);if(a!==35||s>=i)return!1;let o=1;for(a=e.src.charCodeAt(++s);a===35&&s<i&&o<=6;)o++,a=e.src.charCodeAt(++s);if(o>6||s<i&&!Ds(a))return!1;if(r)return!0;i=e.skipSpacesBack(i,s);const l=e.skipCharsBack(i,35,s);l>s&&Ds(e.src.charCodeAt(l-1))&&(i=l),e.line=t+1;const c=e.push("heading_open","h"+String(o),1);c.markup="########".slice(0,o),c.map=[t,e.line];const u=e.push("inline","",0);u.content=e.src.slice(s,i).trim(),u.map=[t,e.line],u.children=[];const d=e.push("heading_close","h"+String(o),-1);return d.markup="########".slice(0,o),!0}function LNe(e,t,n){const r=e.md.block.ruler.getRules("paragraph");if(e.sCount[t]-e.blkIndent>=4)return!1;const s=e.parentType;e.parentType="paragraph";let i=0,a,o=t+1;for(;o<n&&!e.isEmpty(o);o++){if(e.sCount[o]-e.blkIndent>3)continue;if(e.sCount[o]>=e.blkIndent){let m=e.bMarks[o]+e.tShift[o];const y=e.eMarks[o];if(m<y&&(a=e.src.charCodeAt(m),(a===45||a===61)&&(m=e.skipChars(m,a),m=e.skipSpaces(m),m>=y))){i=a===61?1:2;break}}if(e.sCount[o]<0)continue;let h=!1;for(let m=0,y=r.length;m<y;m++)if(r[m](e,o,n,!0)){h=!0;break}if(h)break}if(!i)return!1;const l=e.getLines(t,o,e.blkIndent,!1).trim();e.line=o+1;const c=e.push("heading_open","h"+String(i),1);c.markup=String.fromCharCode(a),c.map=[t,e.line];const u=e.push("inline","",0);u.content=l,u.map=[t,e.line-1],u.children=[];const d=e.push("heading_close","h"+String(i),-1);return d.markup=String.fromCharCode(a),e.parentType=s,!0}function BNe(e,t,n){const r=e.md.block.ruler.getRules("paragraph"),s=e.parentType;let i=t+1;for(e.parentType="paragraph";i<n&&!e.isEmpty(i);i++){if(e.sCount[i]-e.blkIndent>3||e.sCount[i]<0)continue;let c=!1;for(let u=0,d=r.length;u<d;u++)if(r[u](e,i,n,!0)){c=!0;break}if(c)break}const a=e.getLines(t,i,e.blkIndent,!1).trim();e.line=i;const o=e.push("paragraph_open","p",1);o.map=[t,e.line];const l=e.push("inline","",0);return l.content=a,l.map=[t,e.line],l.children=[],e.push("paragraph_close","p",-1),e.parentType=s,!0}const zS=[["table",mNe,["paragraph","reference"]],["code",gNe],["fence",yNe,["paragraph","reference","blockquote","list"]],["blockquote",bNe,["paragraph","reference","blockquote","list"]],["hr",vNe,["paragraph","reference","blockquote","list"]],["list",wNe,["paragraph","reference","blockquote"]],["reference",_Ne],["html_block",DNe,["paragraph","reference","blockquote"]],["heading",FNe,["paragraph","reference","blockquote"]],["lheading",LNe],["paragraph",BNe]];function oT(){this.ruler=new Do;for(let e=0;e<zS.length;e++)this.ruler.push(zS[e][0],zS[e][1],{alt:(zS[e][2]||[]).slice()})}oT.prototype.tokenize=function(e,t,n){const r=this.ruler.getRules(""),s=r.length,i=e.md.options.maxNesting;let a=t,o=!1;for(;a<n&&(e.line=a=e.skipEmptyLines(a),!(a>=n||e.sCount[a]<e.blkIndent));){if(e.level>=i){e.line=n;break}const l=e.line;let c=!1;for(let u=0;u<s;u++)if(c=r[u](e,a,n,!1),c){if(l>=e.line)throw new Error("block rule didn't increment state.line");break}if(!c)throw new Error("none of the block rules matched");e.tight=!o,e.isEmpty(e.line-1)&&(o=!0),a=e.line,a<n&&e.isEmpty(a)&&(o=!0,a++,e.line=a)}};oT.prototype.parse=function(e,t,n,r){if(!e)return;const s=new this.State(e,t,n,r);this.tokenize(s,s.line,s.lineMax)};oT.prototype.State=$u;function $1(e,t,n,r){this.src=e,this.env=n,this.md=t,this.tokens=r,this.tokens_meta=Array(r.length),this.pos=0,this.posMax=this.src.length,this.level=0,this.pending="",this.pendingLevel=0,this.cache={},this.delimiters=[],this._prev_delimiters=[],this.backticks={},this.backticksScanned=!1,this.linkLevel=0}$1.prototype.pushPending=function(){const e=new $c("text","",0);return e.content=this.pending,e.level=this.pendingLevel,this.tokens.push(e),this.pending="",e};$1.prototype.push=function(e,t,n){this.pending&&this.pushPending();const r=new $c(e,t,n);let s=null;return n<0&&(this.level--,this.delimiters=this._prev_delimiters.pop()),r.level=this.level,n>0&&(this.level++,this._prev_delimiters.push(this.delimiters),this.delimiters=[],s={delimiters:this.delimiters}),this.pendingLevel=this.level,this.tokens.push(r),this.tokens_meta.push(s),r};$1.prototype.scanDelims=function(e,t){const n=this.posMax,r=this.src.charCodeAt(e),s=e>0?this.src.charCodeAt(e-1):32;let i=e;for(;i<n&&this.src.charCodeAt(i)===r;)i++;const a=i-e,o=i<n?this.src.charCodeAt(i):32,l=vw(s)||bw(String.fromCharCode(s)),c=vw(o)||bw(String.fromCharCode(o)),u=yw(s),d=yw(o),h=!d&&(!c||u||l),m=!u&&(!l||d||c);return{can_open:h&&(t||!m||l),can_close:m&&(t||!h||c),length:a}};$1.prototype.Token=$c;function $Ne(e){switch(e){case 10:case 33:case 35:case 36:case 37:case 38:case 42:case 43:case 45:case 58:case 60:case 61:case 62:case 64:case 91:case 92:case 93:case 94:case 95:case 96:case 123:case 125:case 126:return!0;default:return!1}}function zNe(e,t){let n=e.pos;for(;n<e.posMax&&!$Ne(e.src.charCodeAt(n));)n++;return n===e.pos?!1:(t||(e.pending+=e.src.slice(e.pos,n)),e.pos=n,!0)}const UNe=/(?:^|[^a-z0-9.+-])([a-z][a-z0-9.+-]*)$/i;function qNe(e,t){if(!e.md.options.linkify||e.linkLevel>0)return!1;const n=e.pos,r=e.posMax;if(n+3>r||e.src.charCodeAt(n)!==58||e.src.charCodeAt(n+1)!==47||e.src.charCodeAt(n+2)!==47)return!1;const s=e.pending.match(UNe);if(!s)return!1;const i=s[1],a=e.md.linkify.matchAtStart(e.src.slice(n-i.length));if(!a)return!1;let o=a.url;if(o.length<=i.length)return!1;o=o.replace(/\*+$/,"");const l=e.md.normalizeLink(o);if(!e.md.validateLink(l))return!1;if(!t){e.pending=e.pending.slice(0,-i.length);const c=e.push("link_open","a",1);c.attrs=[["href",l]],c.markup="linkify",c.info="auto";const u=e.push("text","",0);u.content=e.md.normalizeLinkText(o);const d=e.push("link_close","a",-1);d.markup="linkify",d.info="auto"}return e.pos+=o.length-i.length,!0}function VNe(e,t){let n=e.pos;if(e.src.charCodeAt(n)!==10)return!1;const r=e.pending.length-1,s=e.posMax;if(!t)if(r>=0&&e.pending.charCodeAt(r)===32)if(r>=1&&e.pending.charCodeAt(r-1)===32){let i=r-1;for(;i>=1&&e.pending.charCodeAt(i-1)===32;)i--;e.pending=e.pending.slice(0,i),e.push("hardbreak","br",0)}else e.pending=e.pending.slice(0,-1),e.push("softbreak","br",0);else e.push("softbreak","br",0);for(n++;n<s&&Ds(e.src.charCodeAt(n));)n++;return e.pos=n,!0}const vD=[];for(let e=0;e<256;e++)vD.push(0);"\\!\"#$%&'()*+,./:;<=>?@[]^_`{|}~-".split("").forEach(function(e){vD[e.charCodeAt(0)]=1});function WNe(e,t){let n=e.pos;const r=e.posMax;if(e.src.charCodeAt(n)!==92||(n++,n>=r))return!1;let s=e.src.charCodeAt(n);if(s===10){for(t||e.push("hardbreak","br",0),n++;n<r&&(s=e.src.charCodeAt(n),!!Ds(s));)n++;return e.pos=n,!0}let i=e.src[n];if(s>=55296&&s<=56319&&n+1<r){const o=e.src.charCodeAt(n+1);o>=56320&&o<=57343&&(i+=e.src[n+1],n++)}const a="\\"+i;if(!t){const o=e.push("text_special","",0);s<256&&vD[s]!==0?o.content=i:o.content=a,o.markup=a,o.info="escape"}return e.pos=n+1,!0}function HNe(e,t){let n=e.pos;if(e.src.charCodeAt(n)!==96)return!1;const s=n;n++;const i=e.posMax;for(;n<i&&e.src.charCodeAt(n)===96;)n++;const a=e.src.slice(s,n),o=a.length;if(e.backticksScanned&&(e.backticks[o]||0)<=s)return t||(e.pending+=a),e.pos+=o,!0;let l=n,c;for(;(c=e.src.indexOf("`",l))!==-1;){for(l=c+1;l<i&&e.src.charCodeAt(l)===96;)l++;const u=l-c;if(u===o){if(!t){const d=e.push("code_inline","code",0);d.markup=a,d.content=e.src.slice(n,c).replace(/\n/g," ").replace(/^ (.+) $/,"$1")}return e.pos=l,!0}e.backticks[u]=c}return e.backticksScanned=!0,t||(e.pending+=a),e.pos+=o,!0}function GNe(e,t){const n=e.pos,r=e.src.charCodeAt(n);if(t||r!==126)return!1;const s=e.scanDelims(e.pos,!0);let i=s.length;const a=String.fromCharCode(r);if(i<2)return!1;let o;i%2&&(o=e.push("text","",0),o.content=a,i--);for(let l=0;l<i;l+=2)o=e.push("text","",0),o.content=a+a,e.delimiters.push({marker:r,length:0,token:e.tokens.length-1,end:-1,open:s.can_open,close:s.can_close});return e.pos+=s.length,!0}function Hz(e,t){let n;const r=[],s=t.length;for(let i=0;i<s;i++){const a=t[i];if(a.marker!==126||a.end===-1)continue;const o=t[a.end];n=e.tokens[a.token],n.type="s_open",n.tag="s",n.nesting=1,n.markup="~~",n.content="",n=e.tokens[o.token],n.type="s_close",n.tag="s",n.nesting=-1,n.markup="~~",n.content="",e.tokens[o.token-1].type==="text"&&e.tokens[o.token-1].content==="~"&&r.push(o.token-1)}for(;r.length;){const i=r.pop();let a=i+1;for(;a<e.tokens.length&&e.tokens[a].type==="s_close";)a++;a--,i!==a&&(n=e.tokens[a],e.tokens[a]=e.tokens[i],e.tokens[i]=n)}}function KNe(e){const t=e.tokens_meta,n=e.tokens_meta.length;Hz(e,e.delimiters);for(let r=0;r<n;r++)t[r]&&t[r].delimiters&&Hz(e,t[r].delimiters)}const XZ={tokenize:GNe,postProcess:KNe};function YNe(e,t){const n=e.pos,r=e.src.charCodeAt(n);if(t||r!==95&&r!==42)return!1;const s=e.scanDelims(e.pos,r===42);for(let i=0;i<s.length;i++){const a=e.push("text","",0);a.content=String.fromCharCode(r),e.delimiters.push({marker:r,length:s.length,token:e.tokens.length-1,end:-1,open:s.can_open,close:s.can_close})}return e.pos+=s.length,!0}function Gz(e,t){const n=t.length;for(let r=n-1;r>=0;r--){const s=t[r];if(s.marker!==95&&s.marker!==42||s.end===-1)continue;const i=t[s.end],a=r>0&&t[r-1].end===s.end+1&&t[r-1].marker===s.marker&&t[r-1].token===s.token-1&&t[s.end+1].token===i.token+1,o=String.fromCharCode(s.marker),l=e.tokens[s.token];l.type=a?"strong_open":"em_open",l.tag=a?"strong":"em",l.nesting=1,l.markup=a?o+o:o,l.content="";const c=e.tokens[i.token];c.type=a?"strong_close":"em_close",c.tag=a?"strong":"em",c.nesting=-1,c.markup=a?o+o:o,c.content="",a&&(e.tokens[t[r-1].token].content="",e.tokens[t[s.end+1].token].content="",r--)}}function ZNe(e){const t=e.tokens_meta,n=e.tokens_meta.length;Gz(e,e.delimiters);for(let r=0;r<n;r++)t[r]&&t[r].delimiters&&Gz(e,t[r].delimiters)}const JZ={tokenize:YNe,postProcess:ZNe};function XNe(e,t){let n,r,s,i,a="",o="",l=e.pos,c=!0;if(e.src.charCodeAt(e.pos)!==91)return!1;const u=e.pos,d=e.posMax,h=e.pos+1,m=e.md.helpers.parseLinkLabel(e,e.pos,!0);if(m<0)return!1;let y=m+1;if(y<d&&e.src.charCodeAt(y)===40){for(c=!1,y++;y<d&&(n=e.src.charCodeAt(y),!(!Ds(n)&&n!==10));y++);if(y>=d)return!1;if(l=y,s=e.md.helpers.parseLinkDestination(e.src,y,e.posMax),s.ok){for(a=e.md.normalizeLink(s.str),e.md.validateLink(a)?y=s.pos:a="",l=y;y<d&&(n=e.src.charCodeAt(y),!(!Ds(n)&&n!==10));y++);if(s=e.md.helpers.parseLinkTitle(e.src,y,e.posMax),y<d&&l!==y&&s.ok)for(o=s.str,y=s.pos;y<d&&(n=e.src.charCodeAt(y),!(!Ds(n)&&n!==10));y++);}(y>=d||e.src.charCodeAt(y)!==41)&&(c=!0),y++}if(c){if(typeof e.env.references>"u")return!1;if(y<d&&e.src.charCodeAt(y)===91?(l=y+1,y=e.md.helpers.parseLinkLabel(e,y),y>=0?r=e.src.slice(l,y++):y=m+1):y=m+1,r||(r=e.src.slice(h,m)),i=e.env.references[aT(r)],!i)return e.pos=u,!1;a=i.href,o=i.title}if(!t){e.pos=h,e.posMax=m;const b=e.push("link_open","a",1),v=[["href",a]];b.attrs=v,o&&v.push(["title",o]),e.linkLevel++,e.md.inline.tokenize(e),e.linkLevel--,e.push("link_close","a",-1)}return e.pos=y,e.posMax=d,!0}function JNe(e,t){let n,r,s,i,a,o,l,c,u="";const d=e.pos,h=e.posMax;if(e.src.charCodeAt(e.pos)!==33||e.src.charCodeAt(e.pos+1)!==91)return!1;const m=e.pos+2,y=e.md.helpers.parseLinkLabel(e,e.pos+1,!1);if(y<0)return!1;if(i=y+1,i<h&&e.src.charCodeAt(i)===40){for(i++;i<h&&(n=e.src.charCodeAt(i),!(!Ds(n)&&n!==10));i++);if(i>=h)return!1;for(c=i,o=e.md.helpers.parseLinkDestination(e.src,i,e.posMax),o.ok&&(u=e.md.normalizeLink(o.str),e.md.validateLink(u)?i=o.pos:u=""),c=i;i<h&&(n=e.src.charCodeAt(i),!(!Ds(n)&&n!==10));i++);if(o=e.md.helpers.parseLinkTitle(e.src,i,e.posMax),i<h&&c!==i&&o.ok)for(l=o.str,i=o.pos;i<h&&(n=e.src.charCodeAt(i),!(!Ds(n)&&n!==10));i++);else l="";if(i>=h||e.src.charCodeAt(i)!==41)return e.pos=d,!1;i++}else{if(typeof e.env.references>"u")return!1;if(i<h&&e.src.charCodeAt(i)===91?(c=i+1,i=e.md.helpers.parseLinkLabel(e,i),i>=0?s=e.src.slice(c,i++):i=y+1):i=y+1,s||(s=e.src.slice(m,y)),a=e.env.references[aT(s)],!a)return e.pos=d,!1;u=a.href,l=a.title}if(!t){r=e.src.slice(m,y);const b=[];e.md.inline.parse(r,e.md,e.env,b);const v=e.push("image","img",0),x=[["src",u],["alt",""]];v.attrs=x,v.children=b,v.content=r,l&&x.push(["title",l])}return e.pos=i,e.posMax=h,!0}const QNe=/^([a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*)$/,eMe=/^([a-zA-Z][a-zA-Z0-9+.-]{1,31}):([^<>\x00-\x20]*)$/;function tMe(e,t){let n=e.pos;if(e.src.charCodeAt(n)!==60)return!1;const r=e.pos,s=e.posMax;for(;;){if(++n>=s)return!1;const a=e.src.charCodeAt(n);if(a===60)return!1;if(a===62)break}const i=e.src.slice(r+1,n);if(eMe.test(i)){const a=e.md.normalizeLink(i);if(!e.md.validateLink(a))return!1;if(!t){const o=e.push("link_open","a",1);o.attrs=[["href",a]],o.markup="autolink",o.info="auto";const l=e.push("text","",0);l.content=e.md.normalizeLinkText(i);const c=e.push("link_close","a",-1);c.markup="autolink",c.info="auto"}return e.pos+=i.length+2,!0}if(QNe.test(i)){const a=e.md.normalizeLink("mailto:"+i);if(!e.md.validateLink(a))return!1;if(!t){const o=e.push("link_open","a",1);o.attrs=[["href",a]],o.markup="autolink",o.info="auto";const l=e.push("text","",0);l.content=e.md.normalizeLinkText(i);const c=e.push("link_close","a",-1);c.markup="autolink",c.info="auto"}return e.pos+=i.length+2,!0}return!1}function nMe(e){return/^<a[>\s]/i.test(e)}function rMe(e){return/^<\/a\s*>/i.test(e)}function sMe(e){const t=e|32;return t>=97&&t<=122}function iMe(e,t){if(!e.md.options.html)return!1;const n=e.posMax,r=e.pos;if(e.src.charCodeAt(r)!==60||r+2>=n)return!1;const s=e.src.charCodeAt(r+1);if(s!==33&&s!==63&&s!==47&&!sMe(s))return!1;const i=e.src.slice(r).match(PNe);if(!i)return!1;if(!t){const a=e.push("html_inline","",0);a.content=i[0],nMe(a.content)&&e.linkLevel++,rMe(a.content)&&e.linkLevel--}return e.pos+=i[0].length,!0}const aMe=/^&#((?:x[a-f0-9]{1,6}|[0-9]{1,7}));/i,oMe=/^&([a-z][a-z0-9]{1,31});/i;function lMe(e,t){const n=e.pos,r=e.posMax;if(e.src.charCodeAt(n)!==38||n+1>=r)return!1;if(e.src.charCodeAt(n+1)===35){const i=e.src.slice(n).match(aMe);if(i){if(!t){const a=i[1][0].toLowerCase()==="x"?parseInt(i[1].slice(1),16):parseInt(i[1],10),o=e.push("text_special","",0);o.content=yD(a)?tk(a):tk(65533),o.markup=i[0],o.info="entity"}return e.pos+=i[0].length,!0}}else{const i=e.src.slice(n).match(oMe);if(i){const a=VZ(i[0]);if(a!==i[0]){if(!t){const o=e.push("text_special","",0);o.content=a,o.markup=i[0],o.info="entity"}return e.pos+=i[0].length,!0}}}return!1}function Kz(e){const t={},n=e.length;if(!n)return;let r=0,s=-2;const i=[];for(let a=0;a<n;a++){const o=e[a];if(i.push(0),(e[r].marker!==o.marker||s!==o.token-1)&&(r=a),s=o.token,o.length=o.length||0,!o.close)continue;t.hasOwnProperty(o.marker)||(t[o.marker]=[-1,-1,-1,-1,-1,-1]);const l=t[o.marker][(o.open?3:0)+o.length%3];let c=r-i[r]-1,u=c;for(;c>l;c-=i[c]+1){const d=e[c];if(d.marker===o.marker&&d.open&&d.end<0){let h=!1;if((d.close||o.open)&&(d.length+o.length)%3===0&&(d.length%3!==0||o.length%3!==0)&&(h=!0),!h){const m=c>0&&!e[c-1].open?i[c-1]+1:0;i[a]=a-c+m,i[c]=m,o.open=!1,d.end=a,d.close=!1,u=-1,s=-2;break}}}u!==-1&&(t[o.marker][(o.open?3:0)+(o.length||0)%3]=u)}}function cMe(e){const t=e.tokens_meta,n=e.tokens_meta.length;Kz(e.delimiters);for(let r=0;r<n;r++)t[r]&&t[r].delimiters&&Kz(t[r].delimiters)}function uMe(e){let t,n,r=0;const s=e.tokens,i=e.tokens.length;for(t=n=0;t<i;t++)s[t].nesting<0&&r--,s[t].level=r,s[t].nesting>0&&r++,s[t].type==="text"&&t+1<i&&s[t+1].type==="text"?s[t+1].content=s[t].content+s[t+1].content:(t!==n&&(s[n]=s[t]),n++);t!==n&&(s.length=n)}const dI=[["text",zNe],["linkify",qNe],["newline",VNe],["escape",WNe],["backticks",HNe],["strikethrough",XZ.tokenize],["emphasis",JZ.tokenize],["link",XNe],["image",JNe],["autolink",tMe],["html_inline",iMe],["entity",lMe]],fI=[["balance_pairs",cMe],["strikethrough",XZ.postProcess],["emphasis",JZ.postProcess],["fragments_join",uMe]];function z1(){this.ruler=new Do;for(let e=0;e<dI.length;e++)this.ruler.push(dI[e][0],dI[e][1]);this.ruler2=new Do;for(let e=0;e<fI.length;e++)this.ruler2.push(fI[e][0],fI[e][1])}z1.prototype.skipToken=function(e){const t=e.pos,n=this.ruler.getRules(""),r=n.length,s=e.md.options.maxNesting,i=e.cache;if(typeof i[t]<"u"){e.pos=i[t];return}let a=!1;if(e.level<s){for(let o=0;o<r;o++)if(e.level++,a=n[o](e,!0),e.level--,a){if(t>=e.pos)throw new Error("inline rule didn't increment state.pos");break}}else e.pos=e.posMax;a||e.pos++,i[t]=e.pos};z1.prototype.tokenize=function(e){const t=this.ruler.getRules(""),n=t.length,r=e.posMax,s=e.md.options.maxNesting;for(;e.pos<r;){const i=e.pos;let a=!1;if(e.level<s){for(let o=0;o<n;o++)if(a=t[o](e,!1),a){if(i>=e.pos)throw new Error("inline rule didn't increment state.pos");break}}if(a){if(e.pos>=r)break;continue}e.pending+=e.src[e.pos++]}e.pending&&e.pushPending()};z1.prototype.parse=function(e,t,n,r){const s=new this.State(e,t,n,r);this.tokenize(s);const i=this.ruler2.getRules(""),a=i.length;for(let o=0;o<a;o++)i[o](s)};z1.prototype.State=$1;function dMe(e){const t={};e=e||{},t.src_Any=BZ.source,t.src_Cc=$Z.source,t.src_Z=UZ.source,t.src_P=mD.source,t.src_ZPCc=[t.src_Z,t.src_P,t.src_Cc].join("|"),t.src_ZCc=[t.src_Z,t.src_Cc].join("|");const n="[><｜]";return t.src_pseudo_letter="(?:(?!"+n+"|"+t.src_ZPCc+")"+t.src_Any+")",t.src_ip4="(?:(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)",t.src_auth="(?:(?:(?!"+t.src_ZCc+"|[@/\\[\\]()]).)+@)?",t.src_port="(?::(?:6(?:[0-4]\\d{3}|5(?:[0-4]\\d{2}|5(?:[0-2]\\d|3[0-5])))|[1-5]?\\d{1,4}))?",t.src_host_terminator="(?=$|"+n+"|"+t.src_ZPCc+")(?!"+(e["---"]?"-(?!--)|":"-|")+"_|:\\d|\\.-|\\.(?!$|"+t.src_ZPCc+"))",t.src_path="(?:[/?#](?:(?!"+t.src_ZCc+"|"+n+`|[()[\\]{}.,"'?!\\-;]).|\\[(?:(?!`+t.src_ZCc+"|\\]).)*\\]|\\((?:(?!"+t.src_ZCc+"|[)]).)*\\)|\\{(?:(?!"+t.src_ZCc+'|[}]).)*\\}|\\"(?:(?!'+t.src_ZCc+`|["]).)+\\"|\\'(?:(?!`+t.src_ZCc+"|[']).)+\\'|\\'(?="+t.src_pseudo_letter+"|[-])|\\.{2,}[a-zA-Z0-9%/&]|\\.(?!"+t.src_ZCc+"|[.]|$)|"+(e["---"]?"\\-(?!--(?:[^-]|$))(?:-*)|":"\\-+|")+",(?!"+t.src_ZCc+"|$)|;(?!"+t.src_ZCc+"|$)|\\!+(?!"+t.src_ZCc+"|[!]|$)|\\?(?!"+t.src_ZCc+"|[?]|$))+|\\/)?",t.src_email_name='[\\-;:&=\\+\\$,\\.a-zA-Z0-9_][\\-;:&=\\+\\$,\\"\\.a-zA-Z0-9_]*',t.src_xn="xn--[a-z0-9\\-]{1,59}",t.src_domain_root="(?:"+t.src_xn+"|"+t.src_pseudo_letter+"{1,63})",t.src_domain="(?:"+t.src_xn+"|(?:"+t.src_pseudo_letter+")|(?:"+t.src_pseudo_letter+"(?:-|"+t.src_pseudo_letter+"){0,61}"+t.src_pseudo_letter+"))",t.src_host="(?:(?:(?:(?:"+t.src_domain+")\\.)*"+t.src_domain+"))",t.tpl_host_fuzzy="(?:"+t.src_ip4+"|(?:(?:(?:"+t.src_domain+")\\.)+(?:%TLDS%)))",t.tpl_host_no_ip_fuzzy="(?:(?:(?:"+t.src_domain+")\\.)+(?:%TLDS%))",t.src_host_strict=t.src_host+t.src_host_terminator,t.tpl_host_fuzzy_strict=t.tpl_host_fuzzy+t.src_host_terminator,t.src_host_port_strict=t.src_host+t.src_port+t.src_host_terminator,t.tpl_host_port_fuzzy_strict=t.tpl_host_fuzzy+t.src_port+t.src_host_terminator,t.tpl_host_port_no_ip_fuzzy_strict=t.tpl_host_no_ip_fuzzy+t.src_port+t.src_host_terminator,t.tpl_host_fuzzy_test="localhost|www\\.|\\.\\d{1,3}\\.|(?:\\.(?:%TLDS%)(?:"+t.src_ZPCc+"|>|$))",t.tpl_email_fuzzy="(^|"+n+'|"|\\(|'+t.src_ZCc+")("+t.src_email_name+"@"+t.tpl_host_fuzzy_strict+")",t.tpl_link_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|｜]|"+t.src_ZPCc+"))((?![$+<=>^`|｜])"+t.tpl_host_port_fuzzy_strict+t.src_path+")",t.tpl_link_no_ip_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|｜]|"+t.src_ZPCc+"))((?![$+<=>^`|｜])"+t.tpl_host_port_no_ip_fuzzy_strict+t.src_path+")",t}function Ij(e){return Array.prototype.slice.call(arguments,1).forEach(function(n){n&&Object.keys(n).forEach(function(r){e[r]=n[r]})}),e}function lT(e){return Object.prototype.toString.call(e)}function fMe(e){return lT(e)==="[object String]"}function hMe(e){return lT(e)==="[object Object]"}function pMe(e){return lT(e)==="[object RegExp]"}function Yz(e){return lT(e)==="[object Function]"}function mMe(e){return e.replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}const QZ={fuzzyLink:!0,fuzzyEmail:!0,fuzzyIP:!1};function gMe(e){return Object.keys(e||{}).reduce(function(t,n){return t||QZ.hasOwnProperty(n)},!1)}const yMe={"http:":{validate:function(e,t,n){const r=e.slice(t);return n.re.http||(n.re.http=new RegExp("^\\/\\/"+n.re.src_auth+n.re.src_host_port_strict+n.re.src_path,"i")),n.re.http.test(r)?r.match(n.re.http)[0].length:0}},"https:":"http:","ftp:":"http:","//":{validate:function(e,t,n){const r=e.slice(t);return n.re.no_http||(n.re.no_http=new RegExp("^"+n.re.src_auth+"(?:localhost|(?:(?:"+n.re.src_domain+")\\.)+"+n.re.src_domain_root+")"+n.re.src_port+n.re.src_host_terminator+n.re.src_path,"i")),n.re.no_http.test(r)?t>=3&&e[t-3]===":"||t>=3&&e[t-3]==="/"?0:r.match(n.re.no_http)[0].length:0}},"mailto:":{validate:function(e,t,n){const r=e.slice(t);return n.re.mailto||(n.re.mailto=new RegExp("^"+n.re.src_email_name+"@"+n.re.src_host_strict,"i")),n.re.mailto.test(r)?r.match(n.re.mailto)[0].length:0}}},bMe="a[cdefgilmnoqrstuwxz]|b[abdefghijmnorstvwyz]|c[acdfghiklmnoruvwxyz]|d[ejkmoz]|e[cegrstu]|f[ijkmor]|g[abdefghilmnpqrstuwy]|h[kmnrtu]|i[delmnoqrst]|j[emop]|k[eghimnprwyz]|l[abcikrstuvy]|m[acdeghklmnopqrstuvwxyz]|n[acefgilopruz]|om|p[aefghklmnrstwy]|qa|r[eosuw]|s[abcdeghijklmnortuvxyz]|t[cdfghjklmnortvwz]|u[agksyz]|v[aceginu]|w[fs]|y[et]|z[amw]",vMe="biz|com|edu|gov|net|org|pro|web|xxx|aero|asia|coop|info|museum|name|shop|рф".split("|");function xMe(e){e.__index__=-1,e.__text_cache__=""}function wMe(e){return function(t,n){const r=t.slice(n);return e.test(r)?r.match(e)[0].length:0}}function Zz(){return function(e,t){t.normalize(e)}}function nk(e){const t=e.re=dMe(e.__opts__),n=e.__tlds__.slice();e.onCompile(),e.__tlds_replaced__||n.push(bMe),n.push(t.src_xn),t.src_tlds=n.join("|");function r(o){return o.replace("%TLDS%",t.src_tlds)}t.email_fuzzy=RegExp(r(t.tpl_email_fuzzy),"i"),t.link_fuzzy=RegExp(r(t.tpl_link_fuzzy),"i"),t.link_no_ip_fuzzy=RegExp(r(t.tpl_link_no_ip_fuzzy),"i"),t.host_fuzzy_test=RegExp(r(t.tpl_host_fuzzy_test),"i");const s=[];e.__compiled__={};function i(o,l){throw new Error('(LinkifyIt) Invalid schema "'+o+'": '+l)}Object.keys(e.__schemas__).forEach(function(o){const l=e.__schemas__[o];if(l===null)return;const c={validate:null,link:null};if(e.__compiled__[o]=c,hMe(l)){pMe(l.validate)?c.validate=wMe(l.validate):Yz(l.validate)?c.validate=l.validate:i(o,l),Yz(l.normalize)?c.normalize=l.normalize:l.normalize?i(o,l):c.normalize=Zz();return}if(fMe(l)){s.push(o);return}i(o,l)}),s.forEach(function(o){e.__compiled__[e.__schemas__[o]]&&(e.__compiled__[o].validate=e.__compiled__[e.__schemas__[o]].validate,e.__compiled__[o].normalize=e.__compiled__[e.__schemas__[o]].normalize)}),e.__compiled__[""]={validate:null,normalize:Zz()};const a=Object.keys(e.__compiled__).filter(function(o){return o.length>0&&e.__compiled__[o]}).map(mMe).join("|");e.re.schema_test=RegExp("(^|(?!_)(?:[><｜]|"+t.src_ZPCc+"))("+a+")","i"),e.re.schema_search=RegExp("(^|(?!_)(?:[><｜]|"+t.src_ZPCc+"))("+a+")","ig"),e.re.schema_at_start=RegExp("^"+e.re.schema_search.source,"i"),e.re.pretest=RegExp("("+e.re.schema_test.source+")|("+e.re.host_fuzzy_test.source+")|@","i"),xMe(e)}function _Me(e,t){const n=e.__index__,r=e.__last_index__,s=e.__text_cache__.slice(n,r);this.schema=e.__schema__.toLowerCase(),this.index=n+t,this.lastIndex=r+t,this.raw=s,this.text=s,this.url=s}function jj(e,t){const n=new _Me(e,t);return e.__compiled__[n.schema].normalize(n,e),n}function ml(e,t){if(!(this instanceof ml))return new ml(e,t);t||gMe(e)&&(t=e,e={}),this.__opts__=Ij({},QZ,t),this.__index__=-1,this.__last_index__=-1,this.__schema__="",this.__text_cache__="",this.__schemas__=Ij({},yMe,e),this.__compiled__={},this.__tlds__=vMe,this.__tlds_replaced__=!1,this.re={},nk(this)}ml.prototype.add=function(t,n){return this.__schemas__[t]=n,nk(this),this};ml.prototype.set=function(t){return this.__opts__=Ij(this.__opts__,t),this};ml.prototype.test=function(t){if(this.__text_cache__=t,this.__index__=-1,!t.length)return!1;let n,r,s,i,a,o,l,c,u;if(this.re.schema_test.test(t)){for(l=this.re.schema_search,l.lastIndex=0;(n=l.exec(t))!==null;)if(i=this.testSchemaAt(t,n[2],l.lastIndex),i){this.__schema__=n[2],this.__index__=n.index+n[1].length,this.__last_index__=n.index+n[0].length+i;break}}return this.__opts__.fuzzyLink&&this.__compiled__["http:"]&&(c=t.search(this.re.host_fuzzy_test),c>=0&&(this.__index__<0||c<this.__index__)&&(r=t.match(this.__opts__.fuzzyIP?this.re.link_fuzzy:this.re.link_no_ip_fuzzy))!==null&&(a=r.index+r[1].length,(this.__index__<0||a<this.__index__)&&(this.__schema__="",this.__index__=a,this.__last_index__=r.index+r[0].length))),this.__opts__.fuzzyEmail&&this.__compiled__["mailto:"]&&(u=t.indexOf("@"),u>=0&&(s=t.match(this.re.email_fuzzy))!==null&&(a=s.index+s[1].length,o=s.index+s[0].length,(this.__index__<0||a<this.__index__||a===this.__index__&&o>this.__last_index__)&&(this.__schema__="mailto:",this.__index__=a,this.__last_index__=o))),this.__index__>=0};ml.prototype.pretest=function(t){return this.re.pretest.test(t)};ml.prototype.testSchemaAt=function(t,n,r){return this.__compiled__[n.toLowerCase()]?this.__compiled__[n.toLowerCase()].validate(t,r,this):0};ml.prototype.match=function(t){const n=[];let r=0;this.__index__>=0&&this.__text_cache__===t&&(n.push(jj(this,r)),r=this.__last_index__);let s=r?t.slice(r):t;for(;this.test(s);)n.push(jj(this,r)),s=s.slice(this.__last_index__),r+=this.__last_index__;return n.length?n:null};ml.prototype.matchAtStart=function(t){if(this.__text_cache__=t,this.__index__=-1,!t.length)return null;const n=this.re.schema_at_start.exec(t);if(!n)return null;const r=this.testSchemaAt(t,n[2],n[0].length);return r?(this.__schema__=n[2],this.__index__=n.index+n[1].length,this.__last_index__=n.index+n[0].length+r,jj(this,0)):null};ml.prototype.tlds=function(t,n){return t=Array.isArray(t)?t:[t],n?(this.__tlds__=this.__tlds__.concat(t).sort().filter(function(r,s,i){return r!==i[s-1]}).reverse(),nk(this),this):(this.__tlds__=t.slice(),this.__tlds_replaced__=!0,nk(this),this)};ml.prototype.normalize=function(t){t.schema||(t.url="http://"+t.url),t.schema==="mailto:"&&!/^mailto:/i.test(t.url)&&(t.url="mailto:"+t.url)};ml.prototype.onCompile=function(){};const N0=2147483647,yu=36,xD=1,xw=26,SMe=38,CMe=700,eX=72,tX=128,nX="-",kMe=/^xn--/,EMe=/[^\0-\x7F]/,TMe=/[\x2E\u3002\uFF0E\uFF61]/g,AMe={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},hI=yu-xD,bu=Math.floor,pI=String.fromCharCode;function rh(e){throw new RangeError(AMe[e])}function RMe(e,t){const n=[];let r=e.length;for(;r--;)n[r]=t(e[r]);return n}function rX(e,t){const n=e.split("@");let r="";n.length>1&&(r=n[0]+"@",e=n[1]),e=e.replace(TMe,".");const s=e.split("."),i=RMe(s,t).join(".");return r+i}function sX(e){const t=[];let n=0;const r=e.length;for(;n<r;){const s=e.charCodeAt(n++);if(s>=55296&&s<=56319&&n<r){const i=e.charCodeAt(n++);(i&64512)==56320?t.push(((s&1023)<<10)+(i&1023)+65536):(t.push(s),n--)}else t.push(s)}return t}const NMe=e=>String.fromCodePoint(...e),MMe=function(e){return e>=48&&e<58?26+(e-48):e>=65&&e<91?e-65:e>=97&&e<123?e-97:yu},Xz=function(e,t){return e+22+75*(e<26)-((t!=0)<<5)},iX=function(e,t,n){let r=0;for(e=n?bu(e/CMe):e>>1,e+=bu(e/t);e>hI*xw>>1;r+=yu)e=bu(e/hI);return bu(r+(hI+1)*e/(e+SMe))},aX=function(e){const t=[],n=e.length;let r=0,s=tX,i=eX,a=e.lastIndexOf(nX);a<0&&(a=0);for(let o=0;o<a;++o)e.charCodeAt(o)>=128&&rh("not-basic"),t.push(e.charCodeAt(o));for(let o=a>0?a+1:0;o<n;){const l=r;for(let u=1,d=yu;;d+=yu){o>=n&&rh("invalid-input");const h=MMe(e.charCodeAt(o++));h>=yu&&rh("invalid-input"),h>bu((N0-r)/u)&&rh("overflow"),r+=h*u;const m=d<=i?xD:d>=i+xw?xw:d-i;if(h<m)break;const y=yu-m;u>bu(N0/y)&&rh("overflow"),u*=y}const c=t.length+1;i=iX(r-l,c,l==0),bu(r/c)>N0-s&&rh("overflow"),s+=bu(r/c),r%=c,t.splice(r++,0,s)}return String.fromCodePoint(...t)},oX=function(e){const t=[];e=sX(e);const n=e.length;let r=tX,s=0,i=eX;for(const l of e)l<128&&t.push(pI(l));const a=t.length;let o=a;for(a&&t.push(nX);o<n;){let l=N0;for(const u of e)u>=r&&u<l&&(l=u);const c=o+1;l-r>bu((N0-s)/c)&&rh("overflow"),s+=(l-r)*c,r=l;for(const u of e)if(u<r&&++s>N0&&rh("overflow"),u===r){let d=s;for(let h=yu;;h+=yu){const m=h<=i?xD:h>=i+xw?xw:h-i;if(d<m)break;const y=d-m,b=yu-m;t.push(pI(Xz(m+y%b,0))),d=bu(y/b)}t.push(pI(Xz(d,0))),i=iX(s,c,o===a),s=0,++o}++s,++r}return t.join("")},IMe=function(e){return rX(e,function(t){return kMe.test(t)?aX(t.slice(4).toLowerCase()):t})},jMe=function(e){return rX(e,function(t){return EMe.test(t)?"xn--"+oX(t):t})},lX={version:"2.3.1",ucs2:{decode:sX,encode:NMe},decode:aX,encode:oX,toASCII:jMe,toUnicode:IMe},PMe={options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"“”‘’",highlight:null,maxNesting:100},components:{core:{},block:{},inline:{}}},OMe={options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"“”‘’",highlight:null,maxNesting:20},components:{core:{rules:["normalize","block","inline","text_join"]},block:{rules:["paragraph"]},inline:{rules:["text"],rules2:["balance_pairs","fragments_join"]}}},DMe={options:{html:!0,xhtmlOut:!0,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"“”‘’",highlight:null,maxNesting:20},components:{core:{rules:["normalize","block","inline","text_join"]},block:{rules:["blockquote","code","fence","heading","hr","html_block","lheading","list","reference","paragraph"]},inline:{rules:["autolink","backticks","emphasis","entity","escape","html_inline","image","link","newline","text"],rules2:["balance_pairs","emphasis","fragments_join"]}}},FMe={default:PMe,zero:OMe,commonmark:DMe},LMe=/^(vbscript|javascript|file|data):/,BMe=/^data:image\/(gif|png|jpeg|webp);/;function $Me(e){const t=e.trim().toLowerCase();return LMe.test(t)?BMe.test(t):!0}const cX=["http:","https:","mailto:"];function zMe(e){const t=pD(e,!0);if(t.hostname&&(!t.protocol||cX.indexOf(t.protocol)>=0))try{t.hostname=lX.toASCII(t.hostname)}catch{}return B1(hD(t))}function UMe(e){const t=pD(e,!0);if(t.hostname&&(!t.protocol||cX.indexOf(t.protocol)>=0))try{t.hostname=lX.toUnicode(t.hostname)}catch{}return my(hD(t),my.defaultChars+"%")}function gl(e,t){if(!(this instanceof gl))return new gl(e,t);t||gD(e)||(t=e||{},e="default"),this.inline=new z1,this.block=new oT,this.core=new bD,this.renderer=new nb,this.linkify=new ml,this.validateLink=$Me,this.normalizeLink=zMe,this.normalizeLinkText=UMe,this.utils=VRe,this.helpers=iT({},KRe),this.options={},this.configure(e),t&&this.set(t)}gl.prototype.set=function(e){return iT(this.options,e),this};gl.prototype.configure=function(e){const t=this;if(gD(e)){const n=e;if(e=FMe[n],!e)throw new Error('Wrong `markdown-it` preset "'+n+'", check name')}if(!e)throw new Error("Wrong `markdown-it` preset, can't be empty");return e.options&&t.set(e.options),e.components&&Object.keys(e.components).forEach(function(n){e.components[n].rules&&t[n].ruler.enableOnly(e.components[n].rules),e.components[n].rules2&&t[n].ruler2.enableOnly(e.components[n].rules2)}),this};gl.prototype.enable=function(e,t){let n=[];Array.isArray(e)||(e=[e]),["core","block","inline"].forEach(function(s){n=n.concat(this[s].ruler.enable(e,!0))},this),n=n.concat(this.inline.ruler2.enable(e,!0));const r=e.filter(function(s){return n.indexOf(s)<0});if(r.length&&!t)throw new Error("MarkdownIt. Failed to enable unknown rule(s): "+r);return this};gl.prototype.disable=function(e,t){let n=[];Array.isArray(e)||(e=[e]),["core","block","inline"].forEach(function(s){n=n.concat(this[s].ruler.disable(e,!0))},this),n=n.concat(this.inline.ruler2.disable(e,!0));const r=e.filter(function(s){return n.indexOf(s)<0});if(r.length&&!t)throw new Error("MarkdownIt. Failed to disable unknown rule(s): "+r);return this};gl.prototype.use=function(e){const t=[this].concat(Array.prototype.slice.call(arguments,1));return e.apply(e,t),this};gl.prototype.parse=function(e,t){if(typeof e!="string")throw new Error("Input data should be a String");const n=new this.core.State(e,this,t);return this.core.process(n),n.tokens};gl.prototype.render=function(e,t){return t=t||{},this.renderer.render(this.parse(e,t),this.options,t)};gl.prototype.parseInline=function(e,t){const n=new this.core.State(e,this,t);return n.inlineMode=!0,this.core.process(n),n.tokens};gl.prototype.renderInline=function(e,t){return t=t||{},this.renderer.render(this.parseInline(e,t),this.options,t)};const mI=new gl({html:!1,linkify:!0,breaks:!0});function cT(e){return T.useMemo(()=>{var n;if(!e)return[];try{const r=mI.parse(e,{}),s=[];let i="",a=0;for(;a<r.length;){const o=r[a];if(o.type==="fence"){i&&(s.push(i),i="");const l=((n=o.info)==null?void 0:n.trim())||"";let c,u;if(l.includes(":")){const[d,...h]=l.split(":");c=d||void 0,u=h.join(":")||void 0}else c=l.split(" ")[0]||void 0;c==="mermaid"?s.push({type:"mermaid",code:o.content}):s.push({type:"code",lang:c,code:o.content,filepath:u}),a++}else{const l=[];for(;a<r.length&&r[a].type!=="fence";)l.push(r[a]),a++;l.length>0&&(i+=mI.renderer.render(l,mI.options,{}))}}return i&&s.push(i),s}catch(r){return console.error("Markdown parsing error:",r),[`<pre>${String(e??"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}</pre>`]}},[e])}const qMe="modulepreload",VMe=function(e){return"/"+e},Jz={},Zr=function(t,n,r){let s=Promise.resolve();if(n&&n.length>0){let a=function(c){return Promise.all(c.map(u=>Promise.resolve(u).then(d=>({status:"fulfilled",value:d}),d=>({status:"rejected",reason:d}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));s=a(n.map(c=>{if(c=VMe(c),c in Jz)return;Jz[c]=!0;const u=c.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${d}`))return;const h=document.createElement("link");if(h.rel=u?"stylesheet":qMe,u||(h.as="script"),h.crossOrigin="",h.href=c,l&&h.setAttribute("nonce",l),document.head.appendChild(h),u)return new Promise((m,y)=>{h.addEventListener("load",m),h.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return s.then(a=>{for(const o of a||[])o.status==="rejected"&&i(o.reason);return t().catch(i)})};var N2={exports:{}},WMe=N2.exports,Qz;function HMe(){return Qz||(Qz=1,function(e,t){(function(n,r){e.exports=r()})(WMe,function(){var n=1e3,r=6e4,s=36e5,i="millisecond",a="second",o="minute",l="hour",c="day",u="week",d="month",h="quarter",m="year",y="date",b="Invalid Date",v=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,x=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,w={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(D){var Z=["th","st","nd","rd"],U=D%100;return"["+D+(Z[(U-20)%10]||Z[U]||Z[0])+"]"}},S=function(D,Z,U){var H=String(D);return!H||H.length>=Z?D:""+Array(Z+1-H.length).join(U)+D},C={s:S,z:function(D){var Z=-D.utcOffset(),U=Math.abs(Z),H=Math.floor(U/60),$=U%60;return(Z<=0?"+":"-")+S(H,2,"0")+":"+S($,2,"0")},m:function D(Z,U){if(Z.date()<U.date())return-D(U,Z);var H=12*(U.year()-Z.year())+(U.month()-Z.month()),$=Z.clone().add(H,d),ne=U-$<0,W=Z.clone().add(H+(ne?-1:1),d);return+(-(H+(U-$)/(ne?$-W:W-$))||0)},a:function(D){return D<0?Math.ceil(D)||0:Math.floor(D)},p:function(D){return{M:d,y:m,w:u,d:c,D:y,h:l,m:o,s:a,ms:i,Q:h}[D]||String(D||"").toLowerCase().replace(/s$/,"")},u:function(D){return D===void 0}},k="en",A={};A[k]=w;var R="$isDayjsObject",N=function(D){return D instanceof O||!(!D||!D[R])},I=function D(Z,U,H){var $;if(!Z)return k;if(typeof Z=="string"){var ne=Z.toLowerCase();A[ne]&&($=ne),U&&(A[ne]=U,$=ne);var W=Z.split("-");if(!$&&W.length>1)return D(W[0])}else{var Q=Z.name;A[Q]=Z,$=Q}return!H&&$&&(k=$),$||!H&&k},P=function(D,Z){if(N(D))return D.clone();var U=typeof Z=="object"?Z:{};return U.date=D,U.args=arguments,new O(U)},L=C;L.l=I,L.i=N,L.w=function(D,Z){return P(D,{locale:Z.$L,utc:Z.$u,x:Z.$x,$offset:Z.$offset})};var O=function(){function D(U){this.$L=I(U.locale,null,!0),this.parse(U),this.$x=this.$x||U.x||{},this[R]=!0}var Z=D.prototype;return Z.parse=function(U){this.$d=function(H){var $=H.date,ne=H.utc;if($===null)return new Date(NaN);if(L.u($))return new Date;if($ instanceof Date)return new Date($);if(typeof $=="string"&&!/Z$/i.test($)){var W=$.match(v);if(W){var Q=W[2]-1||0,ee=(W[7]||"0").substring(0,3);return ne?new Date(Date.UTC(W[1],Q,W[3]||1,W[4]||0,W[5]||0,W[6]||0,ee)):new Date(W[1],Q,W[3]||1,W[4]||0,W[5]||0,W[6]||0,ee)}}return new Date($)}(U),this.init()},Z.init=function(){var U=this.$d;this.$y=U.getFullYear(),this.$M=U.getMonth(),this.$D=U.getDate(),this.$W=U.getDay(),this.$H=U.getHours(),this.$m=U.getMinutes(),this.$s=U.getSeconds(),this.$ms=U.getMilliseconds()},Z.$utils=function(){return L},Z.isValid=function(){return this.$d.toString()!==b},Z.isSame=function(U,H){var $=P(U);return this.startOf(H)<=$&&$<=this.endOf(H)},Z.isAfter=function(U,H){return P(U)<this.startOf(H)},Z.isBefore=function(U,H){return this.endOf(H)<P(U)},Z.$g=function(U,H,$){return L.u(U)?this[H]:this.set($,U)},Z.unix=function(){return Math.floor(this.valueOf()/1e3)},Z.valueOf=function(){return this.$d.getTime()},Z.startOf=function(U,H){var $=this,ne=!!L.u(H)||H,W=L.p(U),Q=function(Ce,qe){var Qe=L.w($.$u?Date.UTC($.$y,qe,Ce):new Date($.$y,qe,Ce),$);return ne?Qe:Qe.endOf(c)},ee=function(Ce,qe){return L.w($.toDate()[Ce].apply($.toDate("s"),(ne?[0,0,0,0]:[23,59,59,999]).slice(qe)),$)},se=this.$W,pe=this.$M,ce=this.$D,Ie="set"+(this.$u?"UTC":"");switch(W){case m:return ne?Q(1,0):Q(31,11);case d:return ne?Q(1,pe):Q(0,pe+1);case u:var De=this.$locale().weekStart||0,Se=(se<De?se+7:se)-De;return Q(ne?ce-Se:ce+(6-Se),pe);case c:case y:return ee(Ie+"Hours",0);case l:return ee(Ie+"Minutes",1);case o:return ee(Ie+"Seconds",2);case a:return ee(Ie+"Milliseconds",3);default:return this.clone()}},Z.endOf=function(U){return this.startOf(U,!1)},Z.$set=function(U,H){var $,ne=L.p(U),W="set"+(this.$u?"UTC":""),Q=($={},$[c]=W+"Date",$[y]=W+"Date",$[d]=W+"Month",$[m]=W+"FullYear",$[l]=W+"Hours",$[o]=W+"Minutes",$[a]=W+"Seconds",$[i]=W+"Milliseconds",$)[ne],ee=ne===c?this.$D+(H-this.$W):H;if(ne===d||ne===m){var se=this.clone().set(y,1);se.$d[Q](ee),se.init(),this.$d=se.set(y,Math.min(this.$D,se.daysInMonth())).$d}else Q&&this.$d[Q](ee);return this.init(),this},Z.set=function(U,H){return this.clone().$set(U,H)},Z.get=function(U){return this[L.p(U)]()},Z.add=function(U,H){var $,ne=this;U=Number(U);var W=L.p(H),Q=function(pe){var ce=P(ne);return L.w(ce.date(ce.date()+Math.round(pe*U)),ne)};if(W===d)return this.set(d,this.$M+U);if(W===m)return this.set(m,this.$y+U);if(W===c)return Q(1);if(W===u)return Q(7);var ee=($={},$[o]=r,$[l]=s,$[a]=n,$)[W]||1,se=this.$d.getTime()+U*ee;return L.w(se,this)},Z.subtract=function(U,H){return this.add(-1*U,H)},Z.format=function(U){var H=this,$=this.$locale();if(!this.isValid())return $.invalidDate||b;var ne=U||"YYYY-MM-DDTHH:mm:ssZ",W=L.z(this),Q=this.$H,ee=this.$m,se=this.$M,pe=$.weekdays,ce=$.months,Ie=$.meridiem,De=function(qe,Qe,Ve,Ne){return qe&&(qe[Qe]||qe(H,ne))||Ve[Qe].slice(0,Ne)},Se=function(qe){return L.s(Q%12||12,qe,"0")},Ce=Ie||function(qe,Qe,Ve){var Ne=qe<12?"AM":"PM";return Ve?Ne.toLowerCase():Ne};return ne.replace(x,function(qe,Qe){return Qe||function(Ve){switch(Ve){case"YY":return String(H.$y).slice(-2);case"YYYY":return L.s(H.$y,4,"0");case"M":return se+1;case"MM":return L.s(se+1,2,"0");case"MMM":return De($.monthsShort,se,ce,3);case"MMMM":return De(ce,se);case"D":return H.$D;case"DD":return L.s(H.$D,2,"0");case"d":return String(H.$W);case"dd":return De($.weekdaysMin,H.$W,pe,2);case"ddd":return De($.weekdaysShort,H.$W,pe,3);case"dddd":return pe[H.$W];case"H":return String(Q);case"HH":return L.s(Q,2,"0");case"h":return Se(1);case"hh":return Se(2);case"a":return Ce(Q,ee,!0);case"A":return Ce(Q,ee,!1);case"m":return String(ee);case"mm":return L.s(ee,2,"0");case"s":return String(H.$s);case"ss":return L.s(H.$s,2,"0");case"SSS":return L.s(H.$ms,3,"0");case"Z":return W}return null}(qe)||W.replace(":","")})},Z.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},Z.diff=function(U,H,$){var ne,W=this,Q=L.p(H),ee=P(U),se=(ee.utcOffset()-this.utcOffset())*r,pe=this-ee,ce=function(){return L.m(W,ee)};switch(Q){case m:ne=ce()/12;break;case d:ne=ce();break;case h:ne=ce()/3;break;case u:ne=(pe-se)/6048e5;break;case c:ne=(pe-se)/864e5;break;case l:ne=pe/s;break;case o:ne=pe/r;break;case a:ne=pe/n;break;default:ne=pe}return $?ne:L.a(ne)},Z.daysInMonth=function(){return this.endOf(d).$D},Z.$locale=function(){return A[this.$L]},Z.locale=function(U,H){if(!U)return this.$L;var $=this.clone(),ne=I(U,H,!0);return ne&&($.$L=ne),$},Z.clone=function(){return L.w(this.$d,this)},Z.toDate=function(){return new Date(this.valueOf())},Z.toJSON=function(){return this.isValid()?this.toISOString():null},Z.toISOString=function(){return this.$d.toISOString()},Z.toString=function(){return this.$d.toUTCString()},D}(),V=O.prototype;return P.prototype=V,[["$ms",i],["$s",a],["$m",o],["$H",l],["$W",c],["$M",d],["$y",m],["$D",y]].forEach(function(D){V[D[1]]=function(Z){return this.$g(Z,D[0],D[1])}}),P.extend=function(D,Z){return D.$i||(D(Z,O,P),D.$i=!0),P},P.locale=I,P.isDayjs=N,P.unix=function(D){return P(1e3*D)},P.en=A[k],P.Ls=A,P.p={},P})}(N2)),N2.exports}var GMe=HMe();const KMe=_a(GMe),M2={min:{r:0,g:0,b:0,s:0,l:0,a:0},max:{r:255,g:255,b:255,h:360,s:100,l:100,a:1},clamp:{r:e=>e>=255?255:e<0?0:e,g:e=>e>=255?255:e<0?0:e,b:e=>e>=255?255:e<0?0:e,h:e=>e%360,s:e=>e>=100?100:e<0?0:e,l:e=>e>=100?100:e<0?0:e,a:e=>e>=1?1:e<0?0:e},toLinear:e=>{const t=e/255;return e>.03928?Math.pow((t+.055)/1.055,2.4):t/12.92},hue2rgb:(e,t,n)=>(n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+(t-e)*6*n:n<1/2?t:n<2/3?e+(t-e)*(2/3-n)*6:e),hsl2rgb:({h:e,s:t,l:n},r)=>{if(!t)return n*2.55;e/=360,t/=100,n/=100;const s=n<.5?n*(1+t):n+t-n*t,i=2*n-s;switch(r){case"r":return M2.hue2rgb(i,s,e+1/3)*255;case"g":return M2.hue2rgb(i,s,e)*255;case"b":return M2.hue2rgb(i,s,e-1/3)*255}},rgb2hsl:({r:e,g:t,b:n},r)=>{e/=255,t/=255,n/=255;const s=Math.max(e,t,n),i=Math.min(e,t,n),a=(s+i)/2;if(r==="l")return a*100;if(s===i)return 0;const o=s-i,l=a>.5?o/(2-s-i):o/(s+i);if(r==="s")return l*100;switch(s){case e:return((t-n)/o+(t<n?6:0))*60;case t:return((n-e)/o+2)*60;case n:return((e-t)/o+4)*60;default:return-1}}},YMe={clamp:(e,t,n)=>t>n?Math.min(t,Math.max(n,e)):Math.min(n,Math.max(t,e)),round:e=>Math.round(e*1e10)/1e10},ZMe={dec2hex:e=>{const t=Math.round(e).toString(16);return t.length>1?t:`0${t}`}},lr={channel:M2,lang:YMe,unit:ZMe},Xf={};for(let e=0;e<=255;e++)Xf[e]=lr.unit.dec2hex(e);const Ra={ALL:0,RGB:1,HSL:2};class XMe{constructor(){this.type=Ra.ALL}get(){return this.type}set(t){if(this.type&&this.type!==t)throw new Error("Cannot change both RGB and HSL channels at the same time");this.type=t}reset(){this.type=Ra.ALL}is(t){return this.type===t}}class JMe{constructor(t,n){this.color=n,this.changed=!1,this.data=t,this.type=new XMe}set(t,n){return this.color=n,this.changed=!1,this.data=t,this.type.type=Ra.ALL,this}_ensureHSL(){const t=this.data,{h:n,s:r,l:s}=t;n===void 0&&(t.h=lr.channel.rgb2hsl(t,"h")),r===void 0&&(t.s=lr.channel.rgb2hsl(t,"s")),s===void 0&&(t.l=lr.channel.rgb2hsl(t,"l"))}_ensureRGB(){const t=this.data,{r:n,g:r,b:s}=t;n===void 0&&(t.r=lr.channel.hsl2rgb(t,"r")),r===void 0&&(t.g=lr.channel.hsl2rgb(t,"g")),s===void 0&&(t.b=lr.channel.hsl2rgb(t,"b"))}get r(){const t=this.data,n=t.r;return!this.type.is(Ra.HSL)&&n!==void 0?n:(this._ensureHSL(),lr.channel.hsl2rgb(t,"r"))}get g(){const t=this.data,n=t.g;return!this.type.is(Ra.HSL)&&n!==void 0?n:(this._ensureHSL(),lr.channel.hsl2rgb(t,"g"))}get b(){const t=this.data,n=t.b;return!this.type.is(Ra.HSL)&&n!==void 0?n:(this._ensureHSL(),lr.channel.hsl2rgb(t,"b"))}get h(){const t=this.data,n=t.h;return!this.type.is(Ra.RGB)&&n!==void 0?n:(this._ensureRGB(),lr.channel.rgb2hsl(t,"h"))}get s(){const t=this.data,n=t.s;return!this.type.is(Ra.RGB)&&n!==void 0?n:(this._ensureRGB(),lr.channel.rgb2hsl(t,"s"))}get l(){const t=this.data,n=t.l;return!this.type.is(Ra.RGB)&&n!==void 0?n:(this._ensureRGB(),lr.channel.rgb2hsl(t,"l"))}get a(){return this.data.a}set r(t){this.type.set(Ra.RGB),this.changed=!0,this.data.r=t}set g(t){this.type.set(Ra.RGB),this.changed=!0,this.data.g=t}set b(t){this.type.set(Ra.RGB),this.changed=!0,this.data.b=t}set h(t){this.type.set(Ra.HSL),this.changed=!0,this.data.h=t}set s(t){this.type.set(Ra.HSL),this.changed=!0,this.data.s=t}set l(t){this.type.set(Ra.HSL),this.changed=!0,this.data.l=t}set a(t){this.changed=!0,this.data.a=t}}const uT=new JMe({r:0,g:0,b:0,a:0},"transparent"),M0={re:/^#((?:[a-f0-9]{2}){2,4}|[a-f0-9]{3})$/i,parse:e=>{if(e.charCodeAt(0)!==35)return;const t=e.match(M0.re);if(!t)return;const n=t[1],r=parseInt(n,16),s=n.length,i=s%4===0,a=s>4,o=a?1:17,l=a?8:4,c=i?0:-1,u=a?255:15;return uT.set({r:(r>>l*(c+3)&u)*o,g:(r>>l*(c+2)&u)*o,b:(r>>l*(c+1)&u)*o,a:i?(r&u)*o/255:1},e)},stringify:e=>{const{r:t,g:n,b:r,a:s}=e;return s<1?`#${Xf[Math.round(t)]}${Xf[Math.round(n)]}${Xf[Math.round(r)]}${Xf[Math.round(s*255)]}`:`#${Xf[Math.round(t)]}${Xf[Math.round(n)]}${Xf[Math.round(r)]}`}},em={re:/^hsla?\(\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e-?\d+)?(?:deg|grad|rad|turn)?)\s*?(?:,|\s)\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e-?\d+)?%)\s*?(?:,|\s)\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e-?\d+)?%)(?:\s*?(?:,|\/)\s*?\+?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e-?\d+)?(%)?))?\s*?\)$/i,hueRe:/^(.+?)(deg|grad|rad|turn)$/i,_hue2deg:e=>{const t=e.match(em.hueRe);if(t){const[,n,r]=t;switch(r){case"grad":return lr.channel.clamp.h(parseFloat(n)*.9);case"rad":return lr.channel.clamp.h(parseFloat(n)*180/Math.PI);case"turn":return lr.channel.clamp.h(parseFloat(n)*360)}}return lr.channel.clamp.h(parseFloat(e))},parse:e=>{const t=e.charCodeAt(0);if(t!==104&&t!==72)return;const n=e.match(em.re);if(!n)return;const[,r,s,i,a,o]=n;return uT.set({h:em._hue2deg(r),s:lr.channel.clamp.s(parseFloat(s)),l:lr.channel.clamp.l(parseFloat(i)),a:a?lr.channel.clamp.a(o?parseFloat(a)/100:parseFloat(a)):1},e)},stringify:e=>{const{h:t,s:n,l:r,a:s}=e;return s<1?`hsla(${lr.lang.round(t)}, ${lr.lang.round(n)}%, ${lr.lang.round(r)}%, ${s})`:`hsl(${lr.lang.round(t)}, ${lr.lang.round(n)}%, ${lr.lang.round(r)}%)`}},vx={colors:{aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyanaqua:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",transparent:"#00000000",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},parse:e=>{e=e.toLowerCase();const t=vx.colors[e];if(t)return M0.parse(t)},stringify:e=>{const t=M0.stringify(e);for(const n in vx.colors)if(vx.colors[n]===t)return n}},Xv={re:/^rgba?\(\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e\d+)?(%?))\s*?(?:,|\s)\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e\d+)?(%?))\s*?(?:,|\s)\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e\d+)?(%?))(?:\s*?(?:,|\/)\s*?\+?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e\d+)?(%?)))?\s*?\)$/i,parse:e=>{const t=e.charCodeAt(0);if(t!==114&&t!==82)return;const n=e.match(Xv.re);if(!n)return;const[,r,s,i,a,o,l,c,u]=n;return uT.set({r:lr.channel.clamp.r(s?parseFloat(r)*2.55:parseFloat(r)),g:lr.channel.clamp.g(a?parseFloat(i)*2.55:parseFloat(i)),b:lr.channel.clamp.b(l?parseFloat(o)*2.55:parseFloat(o)),a:c?lr.channel.clamp.a(u?parseFloat(c)/100:parseFloat(c)):1},e)},stringify:e=>{const{r:t,g:n,b:r,a:s}=e;return s<1?`rgba(${lr.lang.round(t)}, ${lr.lang.round(n)}, ${lr.lang.round(r)}, ${lr.lang.round(s)})`:`rgb(${lr.lang.round(t)}, ${lr.lang.round(n)}, ${lr.lang.round(r)})`}},Ou={format:{keyword:vx,hex:M0,rgb:Xv,rgba:Xv,hsl:em,hsla:em},parse:e=>{if(typeof e!="string")return e;const t=M0.parse(e)||Xv.parse(e)||em.parse(e)||vx.parse(e);if(t)return t;throw new Error(`Unsupported color format: "${e}"`)},stringify:e=>!e.changed&&e.color?e.color:e.type.is(Ra.HSL)||e.data.r===void 0?em.stringify(e):e.a<1||!Number.isInteger(e.r)||!Number.isInteger(e.g)||!Number.isInteger(e.b)?Xv.stringify(e):M0.stringify(e)},uX=(e,t)=>{const n=Ou.parse(e);for(const r in t)n[r]=lr.channel.clamp[r](t[r]);return Ou.stringify(n)},xx=(e,t,n=0,r=1)=>{if(typeof e!="number")return uX(e,{a:t});const s=uT.set({r:lr.channel.clamp.r(e),g:lr.channel.clamp.g(t),b:lr.channel.clamp.b(n),a:lr.channel.clamp.a(r)});return Ou.stringify(s)},QMe=e=>{const{r:t,g:n,b:r}=Ou.parse(e),s=.2126*lr.channel.toLinear(t)+.7152*lr.channel.toLinear(n)+.0722*lr.channel.toLinear(r);return lr.lang.round(s)},eIe=e=>QMe(e)>=.5,U1=e=>!eIe(e),dX=(e,t,n)=>{const r=Ou.parse(e),s=r[t],i=lr.channel.clamp[t](s+n);return s!==i&&(r[t]=i),Ou.stringify(r)},wn=(e,t)=>dX(e,"l",t),zn=(e,t)=>dX(e,"l",-t),bt=(e,t)=>{const n=Ou.parse(e),r={};for(const s in t)t[s]&&(r[s]=n[s]+t[s]);return uX(e,r)},tIe=(e,t,n=50)=>{const{r,g:s,b:i,a}=Ou.parse(e),{r:o,g:l,b:c,a:u}=Ou.parse(t),d=n/100,h=d*2-1,m=a-u,b=((h*m===-1?h:(h+m)/(1+h*m))+1)/2,v=1-b,x=r*b+o*v,w=s*b+l*v,S=i*b+c*v,C=a*d+u*(1-d);return xx(x,w,S,C)},cn=(e,t=100)=>{const n=Ou.parse(e);return n.r=255-n.r,n.g=255-n.g,n.b=255-n.b,tIe(n,e,t)};/*! @license DOMPurify 3.2.6 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.6/LICENSE */const{entries:fX,setPrototypeOf:e7,isFrozen:nIe,getPrototypeOf:rIe,getOwnPropertyDescriptor:sIe}=Object;let{freeze:oo,seal:Yl,create:hX}=Object,{apply:Pj,construct:Oj}=typeof Reflect<"u"&&Reflect;oo||(oo=function(t){return t});Yl||(Yl=function(t){return t});Pj||(Pj=function(t,n,r){return t.apply(n,r)});Oj||(Oj=function(t,n){return new t(...n)});const US=lo(Array.prototype.forEach),iIe=lo(Array.prototype.lastIndexOf),t7=lo(Array.prototype.pop),jv=lo(Array.prototype.push),aIe=lo(Array.prototype.splice),I2=lo(String.prototype.toLowerCase),gI=lo(String.prototype.toString),n7=lo(String.prototype.match),Pv=lo(String.prototype.replace),oIe=lo(String.prototype.indexOf),lIe=lo(String.prototype.trim),hc=lo(Object.prototype.hasOwnProperty),Ya=lo(RegExp.prototype.test),Ov=cIe(TypeError);function lo(e){return function(t){t instanceof RegExp&&(t.lastIndex=0);for(var n=arguments.length,r=new Array(n>1?n-1:0),s=1;s<n;s++)r[s-1]=arguments[s];return Pj(e,t,r)}}function cIe(e){return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Oj(e,n)}}function Br(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:I2;e7&&e7(e,null);let r=t.length;for(;r--;){let s=t[r];if(typeof s=="string"){const i=n(s);i!==s&&(nIe(t)||(t[r]=i),s=i)}e[s]=!0}return e}function uIe(e){for(let t=0;t<e.length;t++)hc(e,t)||(e[t]=null);return e}function xd(e){const t=hX(null);for(const[n,r]of fX(e))hc(e,n)&&(Array.isArray(r)?t[n]=uIe(r):r&&typeof r=="object"&&r.constructor===Object?t[n]=xd(r):t[n]=r);return t}function Dv(e,t){for(;e!==null;){const r=sIe(e,t);if(r){if(r.get)return lo(r.get);if(typeof r.value=="function")return lo(r.value)}e=rIe(e)}function n(){return null}return n}const r7=oo(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),yI=oo(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),bI=oo(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),dIe=oo(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),vI=oo(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),fIe=oo(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),s7=oo(["#text"]),i7=oo(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),xI=oo(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),a7=oo(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),qS=oo(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),hIe=Yl(/\{\{[\w\W]*|[\w\W]*\}\}/gm),pIe=Yl(/<%[\w\W]*|[\w\W]*%>/gm),mIe=Yl(/\$\{[\w\W]*/gm),gIe=Yl(/^data-[\-\w.\u00B7-\uFFFF]+$/),yIe=Yl(/^aria-[\-\w]+$/),pX=Yl(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),bIe=Yl(/^(?:\w+script|data):/i),vIe=Yl(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),mX=Yl(/^html$/i),xIe=Yl(/^[a-z][.\w]*(-[.\w]+)+$/i);var o7=Object.freeze({__proto__:null,ARIA_ATTR:yIe,ATTR_WHITESPACE:vIe,CUSTOM_ELEMENT:xIe,DATA_ATTR:gIe,DOCTYPE_NAME:mX,ERB_EXPR:pIe,IS_ALLOWED_URI:pX,IS_SCRIPT_OR_DATA:bIe,MUSTACHE_EXPR:hIe,TMPLIT_EXPR:mIe});const Fv={element:1,text:3,progressingInstruction:7,comment:8,document:9},wIe=function(){return typeof window>"u"?null:window},_Ie=function(t,n){if(typeof t!="object"||typeof t.createPolicy!="function")return null;let r=null;const s="data-tt-policy-suffix";n&&n.hasAttribute(s)&&(r=n.getAttribute(s));const i="dompurify"+(r?"#"+r:"");try{return t.createPolicy(i,{createHTML(a){return a},createScriptURL(a){return a}})}catch{return console.warn("TrustedTypes policy "+i+" could not be created."),null}},l7=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function gX(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:wIe();const t=hn=>gX(hn);if(t.version="3.2.6",t.removed=[],!e||!e.document||e.document.nodeType!==Fv.document||!e.Element)return t.isSupported=!1,t;let{document:n}=e;const r=n,s=r.currentScript,{DocumentFragment:i,HTMLTemplateElement:a,Node:o,Element:l,NodeFilter:c,NamedNodeMap:u=e.NamedNodeMap||e.MozNamedAttrMap,HTMLFormElement:d,DOMParser:h,trustedTypes:m}=e,y=l.prototype,b=Dv(y,"cloneNode"),v=Dv(y,"remove"),x=Dv(y,"nextSibling"),w=Dv(y,"childNodes"),S=Dv(y,"parentNode");if(typeof a=="function"){const hn=n.createElement("template");hn.content&&hn.content.ownerDocument&&(n=hn.content.ownerDocument)}let C,k="";const{implementation:A,createNodeIterator:R,createDocumentFragment:N,getElementsByTagName:I}=n,{importNode:P}=r;let L=l7();t.isSupported=typeof fX=="function"&&typeof S=="function"&&A&&A.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:O,ERB_EXPR:V,TMPLIT_EXPR:D,DATA_ATTR:Z,ARIA_ATTR:U,IS_SCRIPT_OR_DATA:H,ATTR_WHITESPACE:$,CUSTOM_ELEMENT:ne}=o7;let{IS_ALLOWED_URI:W}=o7,Q=null;const ee=Br({},[...r7,...yI,...bI,...vI,...s7]);let se=null;const pe=Br({},[...i7,...xI,...a7,...qS]);let ce=Object.seal(hX(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Ie=null,De=null,Se=!0,Ce=!0,qe=!1,Qe=!0,Ve=!1,Ne=!0,K=!1,ge=!1,Ae=!1,le=!1,oe=!1,re=!1,Te=!0,Be=!1;const ke="user-content-";let lt=!0,Rt=!1,ht={},Pt=null;const qt=Br({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Lt=null;const en=Br({},["audio","video","img","source","image","track"]);let xe=null;const F=Br({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),X="http://www.w3.org/1998/Math/MathML",ye="http://www.w3.org/2000/svg",Fe="http://www.w3.org/1999/xhtml";let we=Fe,Me=!1,de=null;const vt=Br({},[X,ye,Fe],gI);let ot=Br({},["mi","mo","mn","ms","mtext"]),B=Br({},["annotation-xml"]);const ze=Br({},["title","style","font","a","script"]);let st=null;const be=["application/xhtml+xml","text/html"],_e="text/html";let Ue=null,kt=null;const fe=n.createElement("form"),Y=function(et){return et instanceof RegExp||et instanceof Function},G=function(){let et=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(kt&&kt===et)){if((!et||typeof et!="object")&&(et={}),et=xd(et),st=be.indexOf(et.PARSER_MEDIA_TYPE)===-1?_e:et.PARSER_MEDIA_TYPE,Ue=st==="application/xhtml+xml"?gI:I2,Q=hc(et,"ALLOWED_TAGS")?Br({},et.ALLOWED_TAGS,Ue):ee,se=hc(et,"ALLOWED_ATTR")?Br({},et.ALLOWED_ATTR,Ue):pe,de=hc(et,"ALLOWED_NAMESPACES")?Br({},et.ALLOWED_NAMESPACES,gI):vt,xe=hc(et,"ADD_URI_SAFE_ATTR")?Br(xd(F),et.ADD_URI_SAFE_ATTR,Ue):F,Lt=hc(et,"ADD_DATA_URI_TAGS")?Br(xd(en),et.ADD_DATA_URI_TAGS,Ue):en,Pt=hc(et,"FORBID_CONTENTS")?Br({},et.FORBID_CONTENTS,Ue):qt,Ie=hc(et,"FORBID_TAGS")?Br({},et.FORBID_TAGS,Ue):xd({}),De=hc(et,"FORBID_ATTR")?Br({},et.FORBID_ATTR,Ue):xd({}),ht=hc(et,"USE_PROFILES")?et.USE_PROFILES:!1,Se=et.ALLOW_ARIA_ATTR!==!1,Ce=et.ALLOW_DATA_ATTR!==!1,qe=et.ALLOW_UNKNOWN_PROTOCOLS||!1,Qe=et.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Ve=et.SAFE_FOR_TEMPLATES||!1,Ne=et.SAFE_FOR_XML!==!1,K=et.WHOLE_DOCUMENT||!1,le=et.RETURN_DOM||!1,oe=et.RETURN_DOM_FRAGMENT||!1,re=et.RETURN_TRUSTED_TYPE||!1,Ae=et.FORCE_BODY||!1,Te=et.SANITIZE_DOM!==!1,Be=et.SANITIZE_NAMED_PROPS||!1,lt=et.KEEP_CONTENT!==!1,Rt=et.IN_PLACE||!1,W=et.ALLOWED_URI_REGEXP||pX,we=et.NAMESPACE||Fe,ot=et.MATHML_TEXT_INTEGRATION_POINTS||ot,B=et.HTML_INTEGRATION_POINTS||B,ce=et.CUSTOM_ELEMENT_HANDLING||{},et.CUSTOM_ELEMENT_HANDLING&&Y(et.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(ce.tagNameCheck=et.CUSTOM_ELEMENT_HANDLING.tagNameCheck),et.CUSTOM_ELEMENT_HANDLING&&Y(et.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(ce.attributeNameCheck=et.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),et.CUSTOM_ELEMENT_HANDLING&&typeof et.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(ce.allowCustomizedBuiltInElements=et.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Ve&&(Ce=!1),oe&&(le=!0),ht&&(Q=Br({},s7),se=[],ht.html===!0&&(Br(Q,r7),Br(se,i7)),ht.svg===!0&&(Br(Q,yI),Br(se,xI),Br(se,qS)),ht.svgFilters===!0&&(Br(Q,bI),Br(se,xI),Br(se,qS)),ht.mathMl===!0&&(Br(Q,vI),Br(se,a7),Br(se,qS))),et.ADD_TAGS&&(Q===ee&&(Q=xd(Q)),Br(Q,et.ADD_TAGS,Ue)),et.ADD_ATTR&&(se===pe&&(se=xd(se)),Br(se,et.ADD_ATTR,Ue)),et.ADD_URI_SAFE_ATTR&&Br(xe,et.ADD_URI_SAFE_ATTR,Ue),et.FORBID_CONTENTS&&(Pt===qt&&(Pt=xd(Pt)),Br(Pt,et.FORBID_CONTENTS,Ue)),lt&&(Q["#text"]=!0),K&&Br(Q,["html","head","body"]),Q.table&&(Br(Q,["tbody"]),delete Ie.tbody),et.TRUSTED_TYPES_POLICY){if(typeof et.TRUSTED_TYPES_POLICY.createHTML!="function")throw Ov('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof et.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Ov('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');C=et.TRUSTED_TYPES_POLICY,k=C.createHTML("")}else C===void 0&&(C=_Ie(m,s)),C!==null&&typeof k=="string"&&(k=C.createHTML(""));oo&&oo(et),kt=et}},J=Br({},[...yI,...bI,...dIe]),ve=Br({},[...vI,...fIe]),Oe=function(et){let Vt=S(et);(!Vt||!Vt.tagName)&&(Vt={namespaceURI:we,tagName:"template"});const pn=I2(et.tagName),nr=I2(Vt.tagName);return de[et.namespaceURI]?et.namespaceURI===ye?Vt.namespaceURI===Fe?pn==="svg":Vt.namespaceURI===X?pn==="svg"&&(nr==="annotation-xml"||ot[nr]):!!J[pn]:et.namespaceURI===X?Vt.namespaceURI===Fe?pn==="math":Vt.namespaceURI===ye?pn==="math"&&B[nr]:!!ve[pn]:et.namespaceURI===Fe?Vt.namespaceURI===ye&&!B[nr]||Vt.namespaceURI===X&&!ot[nr]?!1:!ve[pn]&&(ze[pn]||!J[pn]):!!(st==="application/xhtml+xml"&&de[et.namespaceURI]):!1},Ge=function(et){jv(t.removed,{element:et});try{S(et).removeChild(et)}catch{v(et)}},_t=function(et,Vt){try{jv(t.removed,{attribute:Vt.getAttributeNode(et),from:Vt})}catch{jv(t.removed,{attribute:null,from:Vt})}if(Vt.removeAttribute(et),et==="is")if(le||oe)try{Ge(Vt)}catch{}else try{Vt.setAttribute(et,"")}catch{}},tn=function(et){let Vt=null,pn=null;if(Ae)et="<remove></remove>"+et;else{const es=n7(et,/^[\r\n\t ]+/);pn=es&&es[0]}st==="application/xhtml+xml"&&we===Fe&&(et='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+et+"</body></html>");const nr=C?C.createHTML(et):et;if(we===Fe)try{Vt=new h().parseFromString(nr,st)}catch{}if(!Vt||!Vt.documentElement){Vt=A.createDocument(we,"template",null);try{Vt.documentElement.innerHTML=Me?k:nr}catch{}}const As=Vt.body||Vt.documentElement;return et&&pn&&As.insertBefore(n.createTextNode(pn),As.childNodes[0]||null),we===Fe?I.call(Vt,K?"html":"body")[0]:K?Vt.documentElement:As},Un=function(et){return R.call(et.ownerDocument||et,et,c.SHOW_ELEMENT|c.SHOW_COMMENT|c.SHOW_TEXT|c.SHOW_PROCESSING_INSTRUCTION|c.SHOW_CDATA_SECTION,null)},Xt=function(et){return et instanceof d&&(typeof et.nodeName!="string"||typeof et.textContent!="string"||typeof et.removeChild!="function"||!(et.attributes instanceof u)||typeof et.removeAttribute!="function"||typeof et.setAttribute!="function"||typeof et.namespaceURI!="string"||typeof et.insertBefore!="function"||typeof et.hasChildNodes!="function")},nn=function(et){return typeof o=="function"&&et instanceof o};function un(hn,et,Vt){US(hn,pn=>{pn.call(t,et,Vt,kt)})}const mr=function(et){let Vt=null;if(un(L.beforeSanitizeElements,et,null),Xt(et))return Ge(et),!0;const pn=Ue(et.nodeName);if(un(L.uponSanitizeElement,et,{tagName:pn,allowedTags:Q}),Ne&&et.hasChildNodes()&&!nn(et.firstElementChild)&&Ya(/<[/\w!]/g,et.innerHTML)&&Ya(/<[/\w!]/g,et.textContent)||et.nodeType===Fv.progressingInstruction||Ne&&et.nodeType===Fv.comment&&Ya(/<[/\w]/g,et.data))return Ge(et),!0;if(!Q[pn]||Ie[pn]){if(!Ie[pn]&&ns(pn)&&(ce.tagNameCheck instanceof RegExp&&Ya(ce.tagNameCheck,pn)||ce.tagNameCheck instanceof Function&&ce.tagNameCheck(pn)))return!1;if(lt&&!Pt[pn]){const nr=S(et)||et.parentNode,As=w(et)||et.childNodes;if(As&&nr){const es=As.length;for(let Ii=es-1;Ii>=0;--Ii){const ci=b(As[Ii],!0);ci.__removalCount=(et.__removalCount||0)+1,nr.insertBefore(ci,x(et))}}}return Ge(et),!0}return et instanceof l&&!Oe(et)||(pn==="noscript"||pn==="noembed"||pn==="noframes")&&Ya(/<\/no(script|embed|frames)/i,et.innerHTML)?(Ge(et),!0):(Ve&&et.nodeType===Fv.text&&(Vt=et.textContent,US([O,V,D],nr=>{Vt=Pv(Vt,nr," ")}),et.textContent!==Vt&&(jv(t.removed,{element:et.cloneNode()}),et.textContent=Vt)),un(L.afterSanitizeElements,et,null),!1)},Rr=function(et,Vt,pn){if(Te&&(Vt==="id"||Vt==="name")&&(pn in n||pn in fe))return!1;if(!(Ce&&!De[Vt]&&Ya(Z,Vt))){if(!(Se&&Ya(U,Vt))){if(!se[Vt]||De[Vt]){if(!(ns(et)&&(ce.tagNameCheck instanceof RegExp&&Ya(ce.tagNameCheck,et)||ce.tagNameCheck instanceof Function&&ce.tagNameCheck(et))&&(ce.attributeNameCheck instanceof RegExp&&Ya(ce.attributeNameCheck,Vt)||ce.attributeNameCheck instanceof Function&&ce.attributeNameCheck(Vt))||Vt==="is"&&ce.allowCustomizedBuiltInElements&&(ce.tagNameCheck instanceof RegExp&&Ya(ce.tagNameCheck,pn)||ce.tagNameCheck instanceof Function&&ce.tagNameCheck(pn))))return!1}else if(!xe[Vt]){if(!Ya(W,Pv(pn,$,""))){if(!((Vt==="src"||Vt==="xlink:href"||Vt==="href")&&et!=="script"&&oIe(pn,"data:")===0&&Lt[et])){if(!(qe&&!Ya(H,Pv(pn,$,"")))){if(pn)return!1}}}}}}return!0},ns=function(et){return et!=="annotation-xml"&&n7(et,ne)},rs=function(et){un(L.beforeSanitizeAttributes,et,null);const{attributes:Vt}=et;if(!Vt||Xt(et))return;const pn={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:se,forceKeepAttr:void 0};let nr=Vt.length;for(;nr--;){const As=Vt[nr],{name:es,namespaceURI:Ii,value:ci}=As,qa=Ue(es),ua=ci;let Ws=es==="value"?ua:lIe(ua);if(pn.attrName=qa,pn.attrValue=Ws,pn.keepAttr=!0,pn.forceKeepAttr=void 0,un(L.uponSanitizeAttribute,et,pn),Ws=pn.attrValue,Be&&(qa==="id"||qa==="name")&&(_t(es,et),Ws=ke+Ws),Ne&&Ya(/((--!?|])>)|<\/(style|title)/i,Ws)){_t(es,et);continue}if(pn.forceKeepAttr)continue;if(!pn.keepAttr){_t(es,et);continue}if(!Qe&&Ya(/\/>/i,Ws)){_t(es,et);continue}Ve&&US([O,V,D],_l=>{Ws=Pv(Ws,_l," ")});const Vo=Ue(et.nodeName);if(!Rr(Vo,qa,Ws)){_t(es,et);continue}if(C&&typeof m=="object"&&typeof m.getAttributeType=="function"&&!Ii)switch(m.getAttributeType(Vo,qa)){case"TrustedHTML":{Ws=C.createHTML(Ws);break}case"TrustedScriptURL":{Ws=C.createScriptURL(Ws);break}}if(Ws!==ua)try{Ii?et.setAttributeNS(Ii,es,Ws):et.setAttribute(es,Ws),Xt(et)?Ge(et):t7(t.removed)}catch{_t(es,et)}}un(L.afterSanitizeAttributes,et,null)},Cr=function hn(et){let Vt=null;const pn=Un(et);for(un(L.beforeSanitizeShadowDOM,et,null);Vt=pn.nextNode();)un(L.uponSanitizeShadowNode,Vt,null),mr(Vt),rs(Vt),Vt.content instanceof i&&hn(Vt.content);un(L.afterSanitizeShadowDOM,et,null)};return t.sanitize=function(hn){let et=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Vt=null,pn=null,nr=null,As=null;if(Me=!hn,Me&&(hn="<!-->"),typeof hn!="string"&&!nn(hn))if(typeof hn.toString=="function"){if(hn=hn.toString(),typeof hn!="string")throw Ov("dirty is not a string, aborting")}else throw Ov("toString is not a function");if(!t.isSupported)return hn;if(ge||G(et),t.removed=[],typeof hn=="string"&&(Rt=!1),Rt){if(hn.nodeName){const ci=Ue(hn.nodeName);if(!Q[ci]||Ie[ci])throw Ov("root node is forbidden and cannot be sanitized in-place")}}else if(hn instanceof o)Vt=tn("<!---->"),pn=Vt.ownerDocument.importNode(hn,!0),pn.nodeType===Fv.element&&pn.nodeName==="BODY"||pn.nodeName==="HTML"?Vt=pn:Vt.appendChild(pn);else{if(!le&&!Ve&&!K&&hn.indexOf("<")===-1)return C&&re?C.createHTML(hn):hn;if(Vt=tn(hn),!Vt)return le?null:re?k:""}Vt&&Ae&&Ge(Vt.firstChild);const es=Un(Rt?hn:Vt);for(;nr=es.nextNode();)mr(nr),rs(nr),nr.content instanceof i&&Cr(nr.content);if(Rt)return hn;if(le){if(oe)for(As=N.call(Vt.ownerDocument);Vt.firstChild;)As.appendChild(Vt.firstChild);else As=Vt;return(se.shadowroot||se.shadowrootmode)&&(As=P.call(r,As,!0)),As}let Ii=K?Vt.outerHTML:Vt.innerHTML;return K&&Q["!doctype"]&&Vt.ownerDocument&&Vt.ownerDocument.doctype&&Vt.ownerDocument.doctype.name&&Ya(mX,Vt.ownerDocument.doctype.name)&&(Ii="<!DOCTYPE "+Vt.ownerDocument.doctype.name+`>
`+Ii),Ve&&US([O,V,D],ci=>{Ii=Pv(Ii,ci," ")}),C&&re?C.createHTML(Ii):Ii},t.setConfig=function(){let hn=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};G(hn),ge=!0},t.clearConfig=function(){kt=null,ge=!1},t.isValidAttribute=function(hn,et,Vt){kt||G({});const pn=Ue(hn),nr=Ue(et);return Rr(pn,nr,Vt)},t.addHook=function(hn,et){typeof et=="function"&&jv(L[hn],et)},t.removeHook=function(hn,et){if(et!==void 0){const Vt=iIe(L[hn],et);return Vt===-1?void 0:aIe(L[hn],Vt,1)[0]}return t7(L[hn])},t.removeHooks=function(hn){L[hn]=[]},t.removeAllHooks=function(){L=l7()},t}var yy=gX(),yX=Object.defineProperty,ie=(e,t)=>yX(e,"name",{value:t,configurable:!0}),SIe=(e,t)=>{for(var n in t)yX(e,n,{get:t[n],enumerable:!0})},md={trace:0,debug:1,info:2,warn:3,error:4,fatal:5},zt={trace:ie((...e)=>{},"trace"),debug:ie((...e)=>{},"debug"),info:ie((...e)=>{},"info"),warn:ie((...e)=>{},"warn"),error:ie((...e)=>{},"error"),fatal:ie((...e)=>{},"fatal")},wD=ie(function(e="fatal"){let t=md.fatal;typeof e=="string"?e.toLowerCase()in md&&(t=md[e]):typeof e=="number"&&(t=e),zt.trace=()=>{},zt.debug=()=>{},zt.info=()=>{},zt.warn=()=>{},zt.error=()=>{},zt.fatal=()=>{},t<=md.fatal&&(zt.fatal=console.error?console.error.bind(console,Ol("FATAL"),"color: orange"):console.log.bind(console,"\x1B[35m",Ol("FATAL"))),t<=md.error&&(zt.error=console.error?console.error.bind(console,Ol("ERROR"),"color: orange"):console.log.bind(console,"\x1B[31m",Ol("ERROR"))),t<=md.warn&&(zt.warn=console.warn?console.warn.bind(console,Ol("WARN"),"color: orange"):console.log.bind(console,"\x1B[33m",Ol("WARN"))),t<=md.info&&(zt.info=console.info?console.info.bind(console,Ol("INFO"),"color: lightblue"):console.log.bind(console,"\x1B[34m",Ol("INFO"))),t<=md.debug&&(zt.debug=console.debug?console.debug.bind(console,Ol("DEBUG"),"color: lightgreen"):console.log.bind(console,"\x1B[32m",Ol("DEBUG"))),t<=md.trace&&(zt.trace=console.debug?console.debug.bind(console,Ol("TRACE"),"color: lightgreen"):console.log.bind(console,"\x1B[32m",Ol("TRACE")))},"setLogLevel"),Ol=ie(e=>`%c${KMe().format("ss.SSS")} : ${e} : `,"format"),bX=/^-{3}\s*[\n\r](.*?)[\n\r]-{3}\s*[\n\r]+/s,wx=/%{2}{\s*(?:(\w+)\s*:|(\w+))\s*(?:(\w+)|((?:(?!}%{2}).|\r?\n)*))?\s*(?:}%{2})?/gi,CIe=/\s*%%.*\n/gm,B0,vX=(B0=class extends Error{constructor(t){super(t),this.name="UnknownDiagramError"}},ie(B0,"UnknownDiagramError"),B0),by={},_D=ie(function(e,t){e=e.replace(bX,"").replace(wx,"").replace(CIe,`
`);for(const[n,{detector:r}]of Object.entries(by))if(r(e,t))return n;throw new vX(`No diagram type detected matching given configuration for text: ${e}`)},"detectType"),xX=ie((...e)=>{for(const{id:t,detector:n,loader:r}of e)wX(t,n,r)},"registerLazyLoadedDiagrams"),wX=ie((e,t,n)=>{by[e]&&zt.warn(`Detector with key ${e} already exists. Overwriting.`),by[e]={detector:t,loader:n},zt.debug(`Detector with key ${e} added${n?" with loader":""}`)},"addDetector"),kIe=ie(e=>by[e].loader,"getDiagramLoader"),Dj=ie((e,t,{depth:n=2,clobber:r=!1}={})=>{const s={depth:n,clobber:r};return Array.isArray(t)&&!Array.isArray(e)?(t.forEach(i=>Dj(e,i,s)),e):Array.isArray(t)&&Array.isArray(e)?(t.forEach(i=>{e.includes(i)||e.push(i)}),e):e===void 0||n<=0?e!=null&&typeof e=="object"&&typeof t=="object"?Object.assign(e,t):t:(t!==void 0&&typeof e=="object"&&typeof t=="object"&&Object.keys(t).forEach(i=>{typeof t[i]=="object"&&(e[i]===void 0||typeof e[i]=="object")?(e[i]===void 0&&(e[i]=Array.isArray(t[i])?[]:{}),e[i]=Dj(e[i],t[i],{depth:n-1,clobber:r})):(r||typeof e[i]!="object"&&typeof t[i]!="object")&&(e[i]=t[i])}),e)},"assignWithDepth"),xa=Dj,dT="#ffffff",fT="#f2f2f2",Ja=ie((e,t)=>t?bt(e,{s:-40,l:10}):bt(e,{s:-40,l:-10}),"mkBorder"),$0,EIe=($0=class{constructor(){this.background="#f4f4f4",this.primaryColor="#fff4dd",this.noteBkgColor="#fff5ad",this.noteTextColor="#333",this.THEME_COLOR_LIMIT=12,this.fontFamily='"trebuchet ms", verdana, arial, sans-serif',this.fontSize="16px"}updateColors(){var n,r,s,i,a,o,l,c,u,d,h,m,y,b,v,x,w,S,C,k,A;if(this.primaryTextColor=this.primaryTextColor||(this.darkMode?"#eee":"#333"),this.secondaryColor=this.secondaryColor||bt(this.primaryColor,{h:-120}),this.tertiaryColor=this.tertiaryColor||bt(this.primaryColor,{h:180,l:5}),this.primaryBorderColor=this.primaryBorderColor||Ja(this.primaryColor,this.darkMode),this.secondaryBorderColor=this.secondaryBorderColor||Ja(this.secondaryColor,this.darkMode),this.tertiaryBorderColor=this.tertiaryBorderColor||Ja(this.tertiaryColor,this.darkMode),this.noteBorderColor=this.noteBorderColor||Ja(this.noteBkgColor,this.darkMode),this.noteBkgColor=this.noteBkgColor||"#fff5ad",this.noteTextColor=this.noteTextColor||"#333",this.secondaryTextColor=this.secondaryTextColor||cn(this.secondaryColor),this.tertiaryTextColor=this.tertiaryTextColor||cn(this.tertiaryColor),this.lineColor=this.lineColor||cn(this.background),this.arrowheadColor=this.arrowheadColor||cn(this.background),this.textColor=this.textColor||this.primaryTextColor,this.border2=this.border2||this.tertiaryBorderColor,this.nodeBkg=this.nodeBkg||this.primaryColor,this.mainBkg=this.mainBkg||this.primaryColor,this.nodeBorder=this.nodeBorder||this.primaryBorderColor,this.clusterBkg=this.clusterBkg||this.tertiaryColor,this.clusterBorder=this.clusterBorder||this.tertiaryBorderColor,this.defaultLinkColor=this.defaultLinkColor||this.lineColor,this.titleColor=this.titleColor||this.tertiaryTextColor,this.edgeLabelBackground=this.edgeLabelBackground||(this.darkMode?zn(this.secondaryColor,30):this.secondaryColor),this.nodeTextColor=this.nodeTextColor||this.primaryTextColor,this.actorBorder=this.actorBorder||this.primaryBorderColor,this.actorBkg=this.actorBkg||this.mainBkg,this.actorTextColor=this.actorTextColor||this.primaryTextColor,this.actorLineColor=this.actorLineColor||this.actorBorder,this.labelBoxBkgColor=this.labelBoxBkgColor||this.actorBkg,this.signalColor=this.signalColor||this.textColor,this.signalTextColor=this.signalTextColor||this.textColor,this.labelBoxBorderColor=this.labelBoxBorderColor||this.actorBorder,this.labelTextColor=this.labelTextColor||this.actorTextColor,this.loopTextColor=this.loopTextColor||this.actorTextColor,this.activationBorderColor=this.activationBorderColor||zn(this.secondaryColor,10),this.activationBkgColor=this.activationBkgColor||this.secondaryColor,this.sequenceNumberColor=this.sequenceNumberColor||cn(this.lineColor),this.sectionBkgColor=this.sectionBkgColor||this.tertiaryColor,this.altSectionBkgColor=this.altSectionBkgColor||"white",this.sectionBkgColor=this.sectionBkgColor||this.secondaryColor,this.sectionBkgColor2=this.sectionBkgColor2||this.primaryColor,this.excludeBkgColor=this.excludeBkgColor||"#eeeeee",this.taskBorderColor=this.taskBorderColor||this.primaryBorderColor,this.taskBkgColor=this.taskBkgColor||this.primaryColor,this.activeTaskBorderColor=this.activeTaskBorderColor||this.primaryColor,this.activeTaskBkgColor=this.activeTaskBkgColor||wn(this.primaryColor,23),this.gridColor=this.gridColor||"lightgrey",this.doneTaskBkgColor=this.doneTaskBkgColor||"lightgrey",this.doneTaskBorderColor=this.doneTaskBorderColor||"grey",this.critBorderColor=this.critBorderColor||"#ff8888",this.critBkgColor=this.critBkgColor||"red",this.todayLineColor=this.todayLineColor||"red",this.taskTextColor=this.taskTextColor||this.textColor,this.taskTextOutsideColor=this.taskTextOutsideColor||this.textColor,this.taskTextLightColor=this.taskTextLightColor||this.textColor,this.taskTextColor=this.taskTextColor||this.primaryTextColor,this.taskTextDarkColor=this.taskTextDarkColor||this.textColor,this.taskTextClickableColor=this.taskTextClickableColor||"#003163",this.personBorder=this.personBorder||this.primaryBorderColor,this.personBkg=this.personBkg||this.mainBkg,this.darkMode?(this.rowOdd=this.rowOdd||zn(this.mainBkg,5)||"#ffffff",this.rowEven=this.rowEven||zn(this.mainBkg,10)):(this.rowOdd=this.rowOdd||wn(this.mainBkg,75)||"#ffffff",this.rowEven=this.rowEven||wn(this.mainBkg,5)),this.transitionColor=this.transitionColor||this.lineColor,this.transitionLabelColor=this.transitionLabelColor||this.textColor,this.stateLabelColor=this.stateLabelColor||this.stateBkg||this.primaryTextColor,this.stateBkg=this.stateBkg||this.mainBkg,this.labelBackgroundColor=this.labelBackgroundColor||this.stateBkg,this.compositeBackground=this.compositeBackground||this.background||this.tertiaryColor,this.altBackground=this.altBackground||this.tertiaryColor,this.compositeTitleBackground=this.compositeTitleBackground||this.mainBkg,this.compositeBorder=this.compositeBorder||this.nodeBorder,this.innerEndBackground=this.nodeBorder,this.errorBkgColor=this.errorBkgColor||this.tertiaryColor,this.errorTextColor=this.errorTextColor||this.tertiaryTextColor,this.transitionColor=this.transitionColor||this.lineColor,this.specialStateColor=this.lineColor,this.cScale0=this.cScale0||this.primaryColor,this.cScale1=this.cScale1||this.secondaryColor,this.cScale2=this.cScale2||this.tertiaryColor,this.cScale3=this.cScale3||bt(this.primaryColor,{h:30}),this.cScale4=this.cScale4||bt(this.primaryColor,{h:60}),this.cScale5=this.cScale5||bt(this.primaryColor,{h:90}),this.cScale6=this.cScale6||bt(this.primaryColor,{h:120}),this.cScale7=this.cScale7||bt(this.primaryColor,{h:150}),this.cScale8=this.cScale8||bt(this.primaryColor,{h:210,l:150}),this.cScale9=this.cScale9||bt(this.primaryColor,{h:270}),this.cScale10=this.cScale10||bt(this.primaryColor,{h:300}),this.cScale11=this.cScale11||bt(this.primaryColor,{h:330}),this.darkMode)for(let R=0;R<this.THEME_COLOR_LIMIT;R++)this["cScale"+R]=zn(this["cScale"+R],75);else for(let R=0;R<this.THEME_COLOR_LIMIT;R++)this["cScale"+R]=zn(this["cScale"+R],25);for(let R=0;R<this.THEME_COLOR_LIMIT;R++)this["cScaleInv"+R]=this["cScaleInv"+R]||cn(this["cScale"+R]);for(let R=0;R<this.THEME_COLOR_LIMIT;R++)this.darkMode?this["cScalePeer"+R]=this["cScalePeer"+R]||wn(this["cScale"+R],10):this["cScalePeer"+R]=this["cScalePeer"+R]||zn(this["cScale"+R],10);this.scaleLabelColor=this.scaleLabelColor||this.labelTextColor;for(let R=0;R<this.THEME_COLOR_LIMIT;R++)this["cScaleLabel"+R]=this["cScaleLabel"+R]||this.scaleLabelColor;const t=this.darkMode?-4:-1;for(let R=0;R<5;R++)this["surface"+R]=this["surface"+R]||bt(this.mainBkg,{h:180,s:-15,l:t*(5+R*3)}),this["surfacePeer"+R]=this["surfacePeer"+R]||bt(this.mainBkg,{h:180,s:-15,l:t*(8+R*3)});this.classText=this.classText||this.textColor,this.fillType0=this.fillType0||this.primaryColor,this.fillType1=this.fillType1||this.secondaryColor,this.fillType2=this.fillType2||bt(this.primaryColor,{h:64}),this.fillType3=this.fillType3||bt(this.secondaryColor,{h:64}),this.fillType4=this.fillType4||bt(this.primaryColor,{h:-64}),this.fillType5=this.fillType5||bt(this.secondaryColor,{h:-64}),this.fillType6=this.fillType6||bt(this.primaryColor,{h:128}),this.fillType7=this.fillType7||bt(this.secondaryColor,{h:128}),this.pie1=this.pie1||this.primaryColor,this.pie2=this.pie2||this.secondaryColor,this.pie3=this.pie3||this.tertiaryColor,this.pie4=this.pie4||bt(this.primaryColor,{l:-10}),this.pie5=this.pie5||bt(this.secondaryColor,{l:-10}),this.pie6=this.pie6||bt(this.tertiaryColor,{l:-10}),this.pie7=this.pie7||bt(this.primaryColor,{h:60,l:-10}),this.pie8=this.pie8||bt(this.primaryColor,{h:-60,l:-10}),this.pie9=this.pie9||bt(this.primaryColor,{h:120,l:0}),this.pie10=this.pie10||bt(this.primaryColor,{h:60,l:-20}),this.pie11=this.pie11||bt(this.primaryColor,{h:-60,l:-20}),this.pie12=this.pie12||bt(this.primaryColor,{h:120,l:-10}),this.pieTitleTextSize=this.pieTitleTextSize||"25px",this.pieTitleTextColor=this.pieTitleTextColor||this.taskTextDarkColor,this.pieSectionTextSize=this.pieSectionTextSize||"17px",this.pieSectionTextColor=this.pieSectionTextColor||this.textColor,this.pieLegendTextSize=this.pieLegendTextSize||"17px",this.pieLegendTextColor=this.pieLegendTextColor||this.taskTextDarkColor,this.pieStrokeColor=this.pieStrokeColor||"black",this.pieStrokeWidth=this.pieStrokeWidth||"2px",this.pieOuterStrokeWidth=this.pieOuterStrokeWidth||"2px",this.pieOuterStrokeColor=this.pieOuterStrokeColor||"black",this.pieOpacity=this.pieOpacity||"0.7",this.radar={axisColor:((n=this.radar)==null?void 0:n.axisColor)||this.lineColor,axisStrokeWidth:((r=this.radar)==null?void 0:r.axisStrokeWidth)||2,axisLabelFontSize:((s=this.radar)==null?void 0:s.axisLabelFontSize)||12,curveOpacity:((i=this.radar)==null?void 0:i.curveOpacity)||.5,curveStrokeWidth:((a=this.radar)==null?void 0:a.curveStrokeWidth)||2,graticuleColor:((o=this.radar)==null?void 0:o.graticuleColor)||"#DEDEDE",graticuleStrokeWidth:((l=this.radar)==null?void 0:l.graticuleStrokeWidth)||1,graticuleOpacity:((c=this.radar)==null?void 0:c.graticuleOpacity)||.3,legendBoxSize:((u=this.radar)==null?void 0:u.legendBoxSize)||12,legendFontSize:((d=this.radar)==null?void 0:d.legendFontSize)||12},this.archEdgeColor=this.archEdgeColor||"#777",this.archEdgeArrowColor=this.archEdgeArrowColor||"#777",this.archEdgeWidth=this.archEdgeWidth||"3",this.archGroupBorderColor=this.archGroupBorderColor||"#000",this.archGroupBorderWidth=this.archGroupBorderWidth||"2px",this.quadrant1Fill=this.quadrant1Fill||this.primaryColor,this.quadrant2Fill=this.quadrant2Fill||bt(this.primaryColor,{r:5,g:5,b:5}),this.quadrant3Fill=this.quadrant3Fill||bt(this.primaryColor,{r:10,g:10,b:10}),this.quadrant4Fill=this.quadrant4Fill||bt(this.primaryColor,{r:15,g:15,b:15}),this.quadrant1TextFill=this.quadrant1TextFill||this.primaryTextColor,this.quadrant2TextFill=this.quadrant2TextFill||bt(this.primaryTextColor,{r:-5,g:-5,b:-5}),this.quadrant3TextFill=this.quadrant3TextFill||bt(this.primaryTextColor,{r:-10,g:-10,b:-10}),this.quadrant4TextFill=this.quadrant4TextFill||bt(this.primaryTextColor,{r:-15,g:-15,b:-15}),this.quadrantPointFill=this.quadrantPointFill||U1(this.quadrant1Fill)?wn(this.quadrant1Fill):zn(this.quadrant1Fill),this.quadrantPointTextFill=this.quadrantPointTextFill||this.primaryTextColor,this.quadrantXAxisTextFill=this.quadrantXAxisTextFill||this.primaryTextColor,this.quadrantYAxisTextFill=this.quadrantYAxisTextFill||this.primaryTextColor,this.quadrantInternalBorderStrokeFill=this.quadrantInternalBorderStrokeFill||this.primaryBorderColor,this.quadrantExternalBorderStrokeFill=this.quadrantExternalBorderStrokeFill||this.primaryBorderColor,this.quadrantTitleFill=this.quadrantTitleFill||this.primaryTextColor,this.xyChart={backgroundColor:((h=this.xyChart)==null?void 0:h.backgroundColor)||this.background,titleColor:((m=this.xyChart)==null?void 0:m.titleColor)||this.primaryTextColor,xAxisTitleColor:((y=this.xyChart)==null?void 0:y.xAxisTitleColor)||this.primaryTextColor,xAxisLabelColor:((b=this.xyChart)==null?void 0:b.xAxisLabelColor)||this.primaryTextColor,xAxisTickColor:((v=this.xyChart)==null?void 0:v.xAxisTickColor)||this.primaryTextColor,xAxisLineColor:((x=this.xyChart)==null?void 0:x.xAxisLineColor)||this.primaryTextColor,yAxisTitleColor:((w=this.xyChart)==null?void 0:w.yAxisTitleColor)||this.primaryTextColor,yAxisLabelColor:((S=this.xyChart)==null?void 0:S.yAxisLabelColor)||this.primaryTextColor,yAxisTickColor:((C=this.xyChart)==null?void 0:C.yAxisTickColor)||this.primaryTextColor,yAxisLineColor:((k=this.xyChart)==null?void 0:k.yAxisLineColor)||this.primaryTextColor,plotColorPalette:((A=this.xyChart)==null?void 0:A.plotColorPalette)||"#FFF4DD,#FFD8B1,#FFA07A,#ECEFF1,#D6DBDF,#C3E0A8,#FFB6A4,#FFD74D,#738FA7,#FFFFF0"},this.requirementBackground=this.requirementBackground||this.primaryColor,this.requirementBorderColor=this.requirementBorderColor||this.primaryBorderColor,this.requirementBorderSize=this.requirementBorderSize||"1",this.requirementTextColor=this.requirementTextColor||this.primaryTextColor,this.relationColor=this.relationColor||this.lineColor,this.relationLabelBackground=this.relationLabelBackground||(this.darkMode?zn(this.secondaryColor,30):this.secondaryColor),this.relationLabelColor=this.relationLabelColor||this.actorTextColor,this.git0=this.git0||this.primaryColor,this.git1=this.git1||this.secondaryColor,this.git2=this.git2||this.tertiaryColor,this.git3=this.git3||bt(this.primaryColor,{h:-30}),this.git4=this.git4||bt(this.primaryColor,{h:-60}),this.git5=this.git5||bt(this.primaryColor,{h:-90}),this.git6=this.git6||bt(this.primaryColor,{h:60}),this.git7=this.git7||bt(this.primaryColor,{h:120}),this.darkMode?(this.git0=wn(this.git0,25),this.git1=wn(this.git1,25),this.git2=wn(this.git2,25),this.git3=wn(this.git3,25),this.git4=wn(this.git4,25),this.git5=wn(this.git5,25),this.git6=wn(this.git6,25),this.git7=wn(this.git7,25)):(this.git0=zn(this.git0,25),this.git1=zn(this.git1,25),this.git2=zn(this.git2,25),this.git3=zn(this.git3,25),this.git4=zn(this.git4,25),this.git5=zn(this.git5,25),this.git6=zn(this.git6,25),this.git7=zn(this.git7,25)),this.gitInv0=this.gitInv0||cn(this.git0),this.gitInv1=this.gitInv1||cn(this.git1),this.gitInv2=this.gitInv2||cn(this.git2),this.gitInv3=this.gitInv3||cn(this.git3),this.gitInv4=this.gitInv4||cn(this.git4),this.gitInv5=this.gitInv5||cn(this.git5),this.gitInv6=this.gitInv6||cn(this.git6),this.gitInv7=this.gitInv7||cn(this.git7),this.branchLabelColor=this.branchLabelColor||(this.darkMode?"black":this.labelTextColor),this.gitBranchLabel0=this.gitBranchLabel0||this.branchLabelColor,this.gitBranchLabel1=this.gitBranchLabel1||this.branchLabelColor,this.gitBranchLabel2=this.gitBranchLabel2||this.branchLabelColor,this.gitBranchLabel3=this.gitBranchLabel3||this.branchLabelColor,this.gitBranchLabel4=this.gitBranchLabel4||this.branchLabelColor,this.gitBranchLabel5=this.gitBranchLabel5||this.branchLabelColor,this.gitBranchLabel6=this.gitBranchLabel6||this.branchLabelColor,this.gitBranchLabel7=this.gitBranchLabel7||this.branchLabelColor,this.tagLabelColor=this.tagLabelColor||this.primaryTextColor,this.tagLabelBackground=this.tagLabelBackground||this.primaryColor,this.tagLabelBorder=this.tagBorder||this.primaryBorderColor,this.tagLabelFontSize=this.tagLabelFontSize||"10px",this.commitLabelColor=this.commitLabelColor||this.secondaryTextColor,this.commitLabelBackground=this.commitLabelBackground||this.secondaryColor,this.commitLabelFontSize=this.commitLabelFontSize||"10px",this.attributeBackgroundColorOdd=this.attributeBackgroundColorOdd||dT,this.attributeBackgroundColorEven=this.attributeBackgroundColorEven||fT}calculate(t){if(typeof t!="object"){this.updateColors();return}const n=Object.keys(t);n.forEach(r=>{this[r]=t[r]}),this.updateColors(),n.forEach(r=>{this[r]=t[r]})}},ie($0,"Theme"),$0),TIe=ie(e=>{const t=new EIe;return t.calculate(e),t},"getThemeVariables"),z0,AIe=(z0=class{constructor(){this.background="#333",this.primaryColor="#1f2020",this.secondaryColor=wn(this.primaryColor,16),this.tertiaryColor=bt(this.primaryColor,{h:-160}),this.primaryBorderColor=cn(this.background),this.secondaryBorderColor=Ja(this.secondaryColor,this.darkMode),this.tertiaryBorderColor=Ja(this.tertiaryColor,this.darkMode),this.primaryTextColor=cn(this.primaryColor),this.secondaryTextColor=cn(this.secondaryColor),this.tertiaryTextColor=cn(this.tertiaryColor),this.lineColor=cn(this.background),this.textColor=cn(this.background),this.mainBkg="#1f2020",this.secondBkg="calculated",this.mainContrastColor="lightgrey",this.darkTextColor=wn(cn("#323D47"),10),this.lineColor="calculated",this.border1="#ccc",this.border2=xx(255,255,255,.25),this.arrowheadColor="calculated",this.fontFamily='"trebuchet ms", verdana, arial, sans-serif',this.fontSize="16px",this.labelBackground="#181818",this.textColor="#ccc",this.THEME_COLOR_LIMIT=12,this.nodeBkg="calculated",this.nodeBorder="calculated",this.clusterBkg="calculated",this.clusterBorder="calculated",this.defaultLinkColor="calculated",this.titleColor="#F9FFFE",this.edgeLabelBackground="calculated",this.actorBorder="calculated",this.actorBkg="calculated",this.actorTextColor="calculated",this.actorLineColor="calculated",this.signalColor="calculated",this.signalTextColor="calculated",this.labelBoxBkgColor="calculated",this.labelBoxBorderColor="calculated",this.labelTextColor="calculated",this.loopTextColor="calculated",this.noteBorderColor="calculated",this.noteBkgColor="#fff5ad",this.noteTextColor="calculated",this.activationBorderColor="calculated",this.activationBkgColor="calculated",this.sequenceNumberColor="black",this.sectionBkgColor=zn("#EAE8D9",30),this.altSectionBkgColor="calculated",this.sectionBkgColor2="#EAE8D9",this.excludeBkgColor=zn(this.sectionBkgColor,10),this.taskBorderColor=xx(255,255,255,70),this.taskBkgColor="calculated",this.taskTextColor="calculated",this.taskTextLightColor="calculated",this.taskTextOutsideColor="calculated",this.taskTextClickableColor="#003163",this.activeTaskBorderColor=xx(255,255,255,50),this.activeTaskBkgColor="#81B1DB",this.gridColor="calculated",this.doneTaskBkgColor="calculated",this.doneTaskBorderColor="grey",this.critBorderColor="#E83737",this.critBkgColor="#E83737",this.taskTextDarkColor="calculated",this.todayLineColor="#DB5757",this.personBorder=this.primaryBorderColor,this.personBkg=this.mainBkg,this.archEdgeColor="calculated",this.archEdgeArrowColor="calculated",this.archEdgeWidth="3",this.archGroupBorderColor=this.primaryBorderColor,this.archGroupBorderWidth="2px",this.rowOdd=this.rowOdd||wn(this.mainBkg,5)||"#ffffff",this.rowEven=this.rowEven||zn(this.mainBkg,10),this.labelColor="calculated",this.errorBkgColor="#a44141",this.errorTextColor="#ddd"}updateColors(){var t,n,r,s,i,a,o,l,c,u,d,h,m,y,b,v,x,w,S,C,k;this.secondBkg=wn(this.mainBkg,16),this.lineColor=this.mainContrastColor,this.arrowheadColor=this.mainContrastColor,this.nodeBkg=this.mainBkg,this.nodeBorder=this.border1,this.clusterBkg=this.secondBkg,this.clusterBorder=this.border2,this.defaultLinkColor=this.lineColor,this.edgeLabelBackground=wn(this.labelBackground,25),this.actorBorder=this.border1,this.actorBkg=this.mainBkg,this.actorTextColor=this.mainContrastColor,this.actorLineColor=this.actorBorder,this.signalColor=this.mainContrastColor,this.signalTextColor=this.mainContrastColor,this.labelBoxBkgColor=this.actorBkg,this.labelBoxBorderColor=this.actorBorder,this.labelTextColor=this.mainContrastColor,this.loopTextColor=this.mainContrastColor,this.noteBorderColor=this.secondaryBorderColor,this.noteBkgColor=this.secondBkg,this.noteTextColor=this.secondaryTextColor,this.activationBorderColor=this.border1,this.activationBkgColor=this.secondBkg,this.altSectionBkgColor=this.background,this.taskBkgColor=wn(this.mainBkg,23),this.taskTextColor=this.darkTextColor,this.taskTextLightColor=this.mainContrastColor,this.taskTextOutsideColor=this.taskTextLightColor,this.gridColor=this.mainContrastColor,this.doneTaskBkgColor=this.mainContrastColor,this.taskTextDarkColor=this.darkTextColor,this.archEdgeColor=this.lineColor,this.archEdgeArrowColor=this.lineColor,this.transitionColor=this.transitionColor||this.lineColor,this.transitionLabelColor=this.transitionLabelColor||this.textColor,this.stateLabelColor=this.stateLabelColor||this.stateBkg||this.primaryTextColor,this.stateBkg=this.stateBkg||this.mainBkg,this.labelBackgroundColor=this.labelBackgroundColor||this.stateBkg,this.compositeBackground=this.compositeBackground||this.background||this.tertiaryColor,this.altBackground=this.altBackground||"#555",this.compositeTitleBackground=this.compositeTitleBackground||this.mainBkg,this.compositeBorder=this.compositeBorder||this.nodeBorder,this.innerEndBackground=this.primaryBorderColor,this.specialStateColor="#f4f4f4",this.errorBkgColor=this.errorBkgColor||this.tertiaryColor,this.errorTextColor=this.errorTextColor||this.tertiaryTextColor,this.fillType0=this.primaryColor,this.fillType1=this.secondaryColor,this.fillType2=bt(this.primaryColor,{h:64}),this.fillType3=bt(this.secondaryColor,{h:64}),this.fillType4=bt(this.primaryColor,{h:-64}),this.fillType5=bt(this.secondaryColor,{h:-64}),this.fillType6=bt(this.primaryColor,{h:128}),this.fillType7=bt(this.secondaryColor,{h:128}),this.cScale1=this.cScale1||"#0b0000",this.cScale2=this.cScale2||"#4d1037",this.cScale3=this.cScale3||"#3f5258",this.cScale4=this.cScale4||"#4f2f1b",this.cScale5=this.cScale5||"#6e0a0a",this.cScale6=this.cScale6||"#3b0048",this.cScale7=this.cScale7||"#995a01",this.cScale8=this.cScale8||"#154706",this.cScale9=this.cScale9||"#161722",this.cScale10=this.cScale10||"#00296f",this.cScale11=this.cScale11||"#01629c",this.cScale12=this.cScale12||"#010029",this.cScale0=this.cScale0||this.primaryColor,this.cScale1=this.cScale1||this.secondaryColor,this.cScale2=this.cScale2||this.tertiaryColor,this.cScale3=this.cScale3||bt(this.primaryColor,{h:30}),this.cScale4=this.cScale4||bt(this.primaryColor,{h:60}),this.cScale5=this.cScale5||bt(this.primaryColor,{h:90}),this.cScale6=this.cScale6||bt(this.primaryColor,{h:120}),this.cScale7=this.cScale7||bt(this.primaryColor,{h:150}),this.cScale8=this.cScale8||bt(this.primaryColor,{h:210}),this.cScale9=this.cScale9||bt(this.primaryColor,{h:270}),this.cScale10=this.cScale10||bt(this.primaryColor,{h:300}),this.cScale11=this.cScale11||bt(this.primaryColor,{h:330});for(let A=0;A<this.THEME_COLOR_LIMIT;A++)this["cScaleInv"+A]=this["cScaleInv"+A]||cn(this["cScale"+A]);for(let A=0;A<this.THEME_COLOR_LIMIT;A++)this["cScalePeer"+A]=this["cScalePeer"+A]||wn(this["cScale"+A],10);for(let A=0;A<5;A++)this["surface"+A]=this["surface"+A]||bt(this.mainBkg,{h:30,s:-30,l:-(-10+A*4)}),this["surfacePeer"+A]=this["surfacePeer"+A]||bt(this.mainBkg,{h:30,s:-30,l:-(-7+A*4)});this.scaleLabelColor=this.scaleLabelColor||(this.darkMode?"black":this.labelTextColor);for(let A=0;A<this.THEME_COLOR_LIMIT;A++)this["cScaleLabel"+A]=this["cScaleLabel"+A]||this.scaleLabelColor;for(let A=0;A<this.THEME_COLOR_LIMIT;A++)this["pie"+A]=this["cScale"+A];this.pieTitleTextSize=this.pieTitleTextSize||"25px",this.pieTitleTextColor=this.pieTitleTextColor||this.taskTextDarkColor,this.pieSectionTextSize=this.pieSectionTextSize||"17px",this.pieSectionTextColor=this.pieSectionTextColor||this.textColor,this.pieLegendTextSize=this.pieLegendTextSize||"17px",this.pieLegendTextColor=this.pieLegendTextColor||this.taskTextDarkColor,this.pieStrokeColor=this.pieStrokeColor||"black",this.pieStrokeWidth=this.pieStrokeWidth||"2px",this.pieOuterStrokeWidth=this.pieOuterStrokeWidth||"2px",this.pieOuterStrokeColor=this.pieOuterStrokeColor||"black",this.pieOpacity=this.pieOpacity||"0.7",this.quadrant1Fill=this.quadrant1Fill||this.primaryColor,this.quadrant2Fill=this.quadrant2Fill||bt(this.primaryColor,{r:5,g:5,b:5}),this.quadrant3Fill=this.quadrant3Fill||bt(this.primaryColor,{r:10,g:10,b:10}),this.quadrant4Fill=this.quadrant4Fill||bt(this.primaryColor,{r:15,g:15,b:15}),this.quadrant1TextFill=this.quadrant1TextFill||this.primaryTextColor,this.quadrant2TextFill=this.quadrant2TextFill||bt(this.primaryTextColor,{r:-5,g:-5,b:-5}),this.quadrant3TextFill=this.quadrant3TextFill||bt(this.primaryTextColor,{r:-10,g:-10,b:-10}),this.quadrant4TextFill=this.quadrant4TextFill||bt(this.primaryTextColor,{r:-15,g:-15,b:-15}),this.quadrantPointFill=this.quadrantPointFill||U1(this.quadrant1Fill)?wn(this.quadrant1Fill):zn(this.quadrant1Fill),this.quadrantPointTextFill=this.quadrantPointTextFill||this.primaryTextColor,this.quadrantXAxisTextFill=this.quadrantXAxisTextFill||this.primaryTextColor,this.quadrantYAxisTextFill=this.quadrantYAxisTextFill||this.primaryTextColor,this.quadrantInternalBorderStrokeFill=this.quadrantInternalBorderStrokeFill||this.primaryBorderColor,this.quadrantExternalBorderStrokeFill=this.quadrantExternalBorderStrokeFill||this.primaryBorderColor,this.quadrantTitleFill=this.quadrantTitleFill||this.primaryTextColor,this.xyChart={backgroundColor:((t=this.xyChart)==null?void 0:t.backgroundColor)||this.background,titleColor:((n=this.xyChart)==null?void 0:n.titleColor)||this.primaryTextColor,xAxisTitleColor:((r=this.xyChart)==null?void 0:r.xAxisTitleColor)||this.primaryTextColor,xAxisLabelColor:((s=this.xyChart)==null?void 0:s.xAxisLabelColor)||this.primaryTextColor,xAxisTickColor:((i=this.xyChart)==null?void 0:i.xAxisTickColor)||this.primaryTextColor,xAxisLineColor:((a=this.xyChart)==null?void 0:a.xAxisLineColor)||this.primaryTextColor,yAxisTitleColor:((o=this.xyChart)==null?void 0:o.yAxisTitleColor)||this.primaryTextColor,yAxisLabelColor:((l=this.xyChart)==null?void 0:l.yAxisLabelColor)||this.primaryTextColor,yAxisTickColor:((c=this.xyChart)==null?void 0:c.yAxisTickColor)||this.primaryTextColor,yAxisLineColor:((u=this.xyChart)==null?void 0:u.yAxisLineColor)||this.primaryTextColor,plotColorPalette:((d=this.xyChart)==null?void 0:d.plotColorPalette)||"#3498db,#2ecc71,#e74c3c,#f1c40f,#bdc3c7,#ffffff,#34495e,#9b59b6,#1abc9c,#e67e22"},this.packet={startByteColor:this.primaryTextColor,endByteColor:this.primaryTextColor,labelColor:this.primaryTextColor,titleColor:this.primaryTextColor,blockStrokeColor:this.primaryTextColor,blockFillColor:this.background},this.radar={axisColor:((h=this.radar)==null?void 0:h.axisColor)||this.lineColor,axisStrokeWidth:((m=this.radar)==null?void 0:m.axisStrokeWidth)||2,axisLabelFontSize:((y=this.radar)==null?void 0:y.axisLabelFontSize)||12,curveOpacity:((b=this.radar)==null?void 0:b.curveOpacity)||.5,curveStrokeWidth:((v=this.radar)==null?void 0:v.curveStrokeWidth)||2,graticuleColor:((x=this.radar)==null?void 0:x.graticuleColor)||"#DEDEDE",graticuleStrokeWidth:((w=this.radar)==null?void 0:w.graticuleStrokeWidth)||1,graticuleOpacity:((S=this.radar)==null?void 0:S.graticuleOpacity)||.3,legendBoxSize:((C=this.radar)==null?void 0:C.legendBoxSize)||12,legendFontSize:((k=this.radar)==null?void 0:k.legendFontSize)||12},this.classText=this.primaryTextColor,this.requirementBackground=this.requirementBackground||this.primaryColor,this.requirementBorderColor=this.requirementBorderColor||this.primaryBorderColor,this.requirementBorderSize=this.requirementBorderSize||"1",this.requirementTextColor=this.requirementTextColor||this.primaryTextColor,this.relationColor=this.relationColor||this.lineColor,this.relationLabelBackground=this.relationLabelBackground||(this.darkMode?zn(this.secondaryColor,30):this.secondaryColor),this.relationLabelColor=this.relationLabelColor||this.actorTextColor,this.git0=wn(this.secondaryColor,20),this.git1=wn(this.pie2||this.secondaryColor,20),this.git2=wn(this.pie3||this.tertiaryColor,20),this.git3=wn(this.pie4||bt(this.primaryColor,{h:-30}),20),this.git4=wn(this.pie5||bt(this.primaryColor,{h:-60}),20),this.git5=wn(this.pie6||bt(this.primaryColor,{h:-90}),10),this.git6=wn(this.pie7||bt(this.primaryColor,{h:60}),10),this.git7=wn(this.pie8||bt(this.primaryColor,{h:120}),20),this.gitInv0=this.gitInv0||cn(this.git0),this.gitInv1=this.gitInv1||cn(this.git1),this.gitInv2=this.gitInv2||cn(this.git2),this.gitInv3=this.gitInv3||cn(this.git3),this.gitInv4=this.gitInv4||cn(this.git4),this.gitInv5=this.gitInv5||cn(this.git5),this.gitInv6=this.gitInv6||cn(this.git6),this.gitInv7=this.gitInv7||cn(this.git7),this.gitBranchLabel0=this.gitBranchLabel0||cn(this.labelTextColor),this.gitBranchLabel1=this.gitBranchLabel1||this.labelTextColor,this.gitBranchLabel2=this.gitBranchLabel2||this.labelTextColor,this.gitBranchLabel3=this.gitBranchLabel3||cn(this.labelTextColor),this.gitBranchLabel4=this.gitBranchLabel4||this.labelTextColor,this.gitBranchLabel5=this.gitBranchLabel5||this.labelTextColor,this.gitBranchLabel6=this.gitBranchLabel6||this.labelTextColor,this.gitBranchLabel7=this.gitBranchLabel7||this.labelTextColor,this.tagLabelColor=this.tagLabelColor||this.primaryTextColor,this.tagLabelBackground=this.tagLabelBackground||this.primaryColor,this.tagLabelBorder=this.tagBorder||this.primaryBorderColor,this.tagLabelFontSize=this.tagLabelFontSize||"10px",this.commitLabelColor=this.commitLabelColor||this.secondaryTextColor,this.commitLabelBackground=this.commitLabelBackground||this.secondaryColor,this.commitLabelFontSize=this.commitLabelFontSize||"10px",this.attributeBackgroundColorOdd=this.attributeBackgroundColorOdd||wn(this.background,12),this.attributeBackgroundColorEven=this.attributeBackgroundColorEven||wn(this.background,2),this.nodeBorder=this.nodeBorder||"#999"}calculate(t){if(typeof t!="object"){this.updateColors();return}const n=Object.keys(t);n.forEach(r=>{this[r]=t[r]}),this.updateColors(),n.forEach(r=>{this[r]=t[r]})}},ie(z0,"Theme"),z0),RIe=ie(e=>{const t=new AIe;return t.calculate(e),t},"getThemeVariables"),U0,NIe=(U0=class{constructor(){this.background="#f4f4f4",this.primaryColor="#ECECFF",this.secondaryColor=bt(this.primaryColor,{h:120}),this.secondaryColor="#ffffde",this.tertiaryColor=bt(this.primaryColor,{h:-160}),this.primaryBorderColor=Ja(this.primaryColor,this.darkMode),this.secondaryBorderColor=Ja(this.secondaryColor,this.darkMode),this.tertiaryBorderColor=Ja(this.tertiaryColor,this.darkMode),this.primaryTextColor=cn(this.primaryColor),this.secondaryTextColor=cn(this.secondaryColor),this.tertiaryTextColor=cn(this.tertiaryColor),this.lineColor=cn(this.background),this.textColor=cn(this.background),this.background="white",this.mainBkg="#ECECFF",this.secondBkg="#ffffde",this.lineColor="#333333",this.border1="#9370DB",this.border2="#aaaa33",this.arrowheadColor="#333333",this.fontFamily='"trebuchet ms", verdana, arial, sans-serif',this.fontSize="16px",this.labelBackground="rgba(232,232,232, 0.8)",this.textColor="#333",this.THEME_COLOR_LIMIT=12,this.nodeBkg="calculated",this.nodeBorder="calculated",this.clusterBkg="calculated",this.clusterBorder="calculated",this.defaultLinkColor="calculated",this.titleColor="calculated",this.edgeLabelBackground="calculated",this.actorBorder="calculated",this.actorBkg="calculated",this.actorTextColor="black",this.actorLineColor="calculated",this.signalColor="calculated",this.signalTextColor="calculated",this.labelBoxBkgColor="calculated",this.labelBoxBorderColor="calculated",this.labelTextColor="calculated",this.loopTextColor="calculated",this.noteBorderColor="calculated",this.noteBkgColor="#fff5ad",this.noteTextColor="calculated",this.activationBorderColor="#666",this.activationBkgColor="#f4f4f4",this.sequenceNumberColor="white",this.sectionBkgColor="calculated",this.altSectionBkgColor="calculated",this.sectionBkgColor2="calculated",this.excludeBkgColor="#eeeeee",this.taskBorderColor="calculated",this.taskBkgColor="calculated",this.taskTextLightColor="calculated",this.taskTextColor=this.taskTextLightColor,this.taskTextDarkColor="calculated",this.taskTextOutsideColor=this.taskTextDarkColor,this.taskTextClickableColor="calculated",this.activeTaskBorderColor="calculated",this.activeTaskBkgColor="calculated",this.gridColor="calculated",this.doneTaskBkgColor="calculated",this.doneTaskBorderColor="calculated",this.critBorderColor="calculated",this.critBkgColor="calculated",this.todayLineColor="calculated",this.sectionBkgColor=xx(102,102,255,.49),this.altSectionBkgColor="white",this.sectionBkgColor2="#fff400",this.taskBorderColor="#534fbc",this.taskBkgColor="#8a90dd",this.taskTextLightColor="white",this.taskTextColor="calculated",this.taskTextDarkColor="black",this.taskTextOutsideColor="calculated",this.taskTextClickableColor="#003163",this.activeTaskBorderColor="#534fbc",this.activeTaskBkgColor="#bfc7ff",this.gridColor="lightgrey",this.doneTaskBkgColor="lightgrey",this.doneTaskBorderColor="grey",this.critBorderColor="#ff8888",this.critBkgColor="red",this.todayLineColor="red",this.personBorder=this.primaryBorderColor,this.personBkg=this.mainBkg,this.archEdgeColor="calculated",this.archEdgeArrowColor="calculated",this.archEdgeWidth="3",this.archGroupBorderColor=this.primaryBorderColor,this.archGroupBorderWidth="2px",this.rowOdd="calculated",this.rowEven="calculated",this.labelColor="black",this.errorBkgColor="#552222",this.errorTextColor="#552222",this.updateColors()}updateColors(){var t,n,r,s,i,a,o,l,c,u,d,h,m,y,b,v,x,w,S,C,k;this.cScale0=this.cScale0||this.primaryColor,this.cScale1=this.cScale1||this.secondaryColor,this.cScale2=this.cScale2||this.tertiaryColor,this.cScale3=this.cScale3||bt(this.primaryColor,{h:30}),this.cScale4=this.cScale4||bt(this.primaryColor,{h:60}),this.cScale5=this.cScale5||bt(this.primaryColor,{h:90}),this.cScale6=this.cScale6||bt(this.primaryColor,{h:120}),this.cScale7=this.cScale7||bt(this.primaryColor,{h:150}),this.cScale8=this.cScale8||bt(this.primaryColor,{h:210}),this.cScale9=this.cScale9||bt(this.primaryColor,{h:270}),this.cScale10=this.cScale10||bt(this.primaryColor,{h:300}),this.cScale11=this.cScale11||bt(this.primaryColor,{h:330}),this.cScalePeer1=this.cScalePeer1||zn(this.secondaryColor,45),this.cScalePeer2=this.cScalePeer2||zn(this.tertiaryColor,40);for(let A=0;A<this.THEME_COLOR_LIMIT;A++)this["cScale"+A]=zn(this["cScale"+A],10),this["cScalePeer"+A]=this["cScalePeer"+A]||zn(this["cScale"+A],25);for(let A=0;A<this.THEME_COLOR_LIMIT;A++)this["cScaleInv"+A]=this["cScaleInv"+A]||bt(this["cScale"+A],{h:180});for(let A=0;A<5;A++)this["surface"+A]=this["surface"+A]||bt(this.mainBkg,{h:30,l:-(5+A*5)}),this["surfacePeer"+A]=this["surfacePeer"+A]||bt(this.mainBkg,{h:30,l:-(7+A*5)});if(this.scaleLabelColor=this.scaleLabelColor!=="calculated"&&this.scaleLabelColor?this.scaleLabelColor:this.labelTextColor,this.labelTextColor!=="calculated"){this.cScaleLabel0=this.cScaleLabel0||cn(this.labelTextColor),this.cScaleLabel3=this.cScaleLabel3||cn(this.labelTextColor);for(let A=0;A<this.THEME_COLOR_LIMIT;A++)this["cScaleLabel"+A]=this["cScaleLabel"+A]||this.labelTextColor}this.nodeBkg=this.mainBkg,this.nodeBorder=this.border1,this.clusterBkg=this.secondBkg,this.clusterBorder=this.border2,this.defaultLinkColor=this.lineColor,this.titleColor=this.textColor,this.edgeLabelBackground=this.labelBackground,this.actorBorder=wn(this.border1,23),this.actorBkg=this.mainBkg,this.labelBoxBkgColor=this.actorBkg,this.signalColor=this.textColor,this.signalTextColor=this.textColor,this.labelBoxBorderColor=this.actorBorder,this.labelTextColor=this.actorTextColor,this.loopTextColor=this.actorTextColor,this.noteBorderColor=this.border2,this.noteTextColor=this.actorTextColor,this.actorLineColor=this.actorBorder,this.taskTextColor=this.taskTextLightColor,this.taskTextOutsideColor=this.taskTextDarkColor,this.archEdgeColor=this.lineColor,this.archEdgeArrowColor=this.lineColor,this.rowOdd=this.rowOdd||wn(this.primaryColor,75)||"#ffffff",this.rowEven=this.rowEven||wn(this.primaryColor,1),this.transitionColor=this.transitionColor||this.lineColor,this.transitionLabelColor=this.transitionLabelColor||this.textColor,this.stateLabelColor=this.stateLabelColor||this.stateBkg||this.primaryTextColor,this.stateBkg=this.stateBkg||this.mainBkg,this.labelBackgroundColor=this.labelBackgroundColor||this.stateBkg,this.compositeBackground=this.compositeBackground||this.background||this.tertiaryColor,this.altBackground=this.altBackground||"#f0f0f0",this.compositeTitleBackground=this.compositeTitleBackground||this.mainBkg,this.compositeBorder=this.compositeBorder||this.nodeBorder,this.innerEndBackground=this.nodeBorder,this.specialStateColor=this.lineColor,this.errorBkgColor=this.errorBkgColor||this.tertiaryColor,this.errorTextColor=this.errorTextColor||this.tertiaryTextColor,this.transitionColor=this.transitionColor||this.lineColor,this.classText=this.primaryTextColor,this.fillType0=this.primaryColor,this.fillType1=this.secondaryColor,this.fillType2=bt(this.primaryColor,{h:64}),this.fillType3=bt(this.secondaryColor,{h:64}),this.fillType4=bt(this.primaryColor,{h:-64}),this.fillType5=bt(this.secondaryColor,{h:-64}),this.fillType6=bt(this.primaryColor,{h:128}),this.fillType7=bt(this.secondaryColor,{h:128}),this.pie1=this.pie1||this.primaryColor,this.pie2=this.pie2||this.secondaryColor,this.pie3=this.pie3||bt(this.tertiaryColor,{l:-40}),this.pie4=this.pie4||bt(this.primaryColor,{l:-10}),this.pie5=this.pie5||bt(this.secondaryColor,{l:-30}),this.pie6=this.pie6||bt(this.tertiaryColor,{l:-20}),this.pie7=this.pie7||bt(this.primaryColor,{h:60,l:-20}),this.pie8=this.pie8||bt(this.primaryColor,{h:-60,l:-40}),this.pie9=this.pie9||bt(this.primaryColor,{h:120,l:-40}),this.pie10=this.pie10||bt(this.primaryColor,{h:60,l:-40}),this.pie11=this.pie11||bt(this.primaryColor,{h:-90,l:-40}),this.pie12=this.pie12||bt(this.primaryColor,{h:120,l:-30}),this.pieTitleTextSize=this.pieTitleTextSize||"25px",this.pieTitleTextColor=this.pieTitleTextColor||this.taskTextDarkColor,this.pieSectionTextSize=this.pieSectionTextSize||"17px",this.pieSectionTextColor=this.pieSectionTextColor||this.textColor,this.pieLegendTextSize=this.pieLegendTextSize||"17px",this.pieLegendTextColor=this.pieLegendTextColor||this.taskTextDarkColor,this.pieStrokeColor=this.pieStrokeColor||"black",this.pieStrokeWidth=this.pieStrokeWidth||"2px",this.pieOuterStrokeWidth=this.pieOuterStrokeWidth||"2px",this.pieOuterStrokeColor=this.pieOuterStrokeColor||"black",this.pieOpacity=this.pieOpacity||"0.7",this.quadrant1Fill=this.quadrant1Fill||this.primaryColor,this.quadrant2Fill=this.quadrant2Fill||bt(this.primaryColor,{r:5,g:5,b:5}),this.quadrant3Fill=this.quadrant3Fill||bt(this.primaryColor,{r:10,g:10,b:10}),this.quadrant4Fill=this.quadrant4Fill||bt(this.primaryColor,{r:15,g:15,b:15}),this.quadrant1TextFill=this.quadrant1TextFill||this.primaryTextColor,this.quadrant2TextFill=this.quadrant2TextFill||bt(this.primaryTextColor,{r:-5,g:-5,b:-5}),this.quadrant3TextFill=this.quadrant3TextFill||bt(this.primaryTextColor,{r:-10,g:-10,b:-10}),this.quadrant4TextFill=this.quadrant4TextFill||bt(this.primaryTextColor,{r:-15,g:-15,b:-15}),this.quadrantPointFill=this.quadrantPointFill||U1(this.quadrant1Fill)?wn(this.quadrant1Fill):zn(this.quadrant1Fill),this.quadrantPointTextFill=this.quadrantPointTextFill||this.primaryTextColor,this.quadrantXAxisTextFill=this.quadrantXAxisTextFill||this.primaryTextColor,this.quadrantYAxisTextFill=this.quadrantYAxisTextFill||this.primaryTextColor,this.quadrantInternalBorderStrokeFill=this.quadrantInternalBorderStrokeFill||this.primaryBorderColor,this.quadrantExternalBorderStrokeFill=this.quadrantExternalBorderStrokeFill||this.primaryBorderColor,this.quadrantTitleFill=this.quadrantTitleFill||this.primaryTextColor,this.radar={axisColor:((t=this.radar)==null?void 0:t.axisColor)||this.lineColor,axisStrokeWidth:((n=this.radar)==null?void 0:n.axisStrokeWidth)||2,axisLabelFontSize:((r=this.radar)==null?void 0:r.axisLabelFontSize)||12,curveOpacity:((s=this.radar)==null?void 0:s.curveOpacity)||.5,curveStrokeWidth:((i=this.radar)==null?void 0:i.curveStrokeWidth)||2,graticuleColor:((a=this.radar)==null?void 0:a.graticuleColor)||"#DEDEDE",graticuleStrokeWidth:((o=this.radar)==null?void 0:o.graticuleStrokeWidth)||1,graticuleOpacity:((l=this.radar)==null?void 0:l.graticuleOpacity)||.3,legendBoxSize:((c=this.radar)==null?void 0:c.legendBoxSize)||12,legendFontSize:((u=this.radar)==null?void 0:u.legendFontSize)||12},this.xyChart={backgroundColor:((d=this.xyChart)==null?void 0:d.backgroundColor)||this.background,titleColor:((h=this.xyChart)==null?void 0:h.titleColor)||this.primaryTextColor,xAxisTitleColor:((m=this.xyChart)==null?void 0:m.xAxisTitleColor)||this.primaryTextColor,xAxisLabelColor:((y=this.xyChart)==null?void 0:y.xAxisLabelColor)||this.primaryTextColor,xAxisTickColor:((b=this.xyChart)==null?void 0:b.xAxisTickColor)||this.primaryTextColor,xAxisLineColor:((v=this.xyChart)==null?void 0:v.xAxisLineColor)||this.primaryTextColor,yAxisTitleColor:((x=this.xyChart)==null?void 0:x.yAxisTitleColor)||this.primaryTextColor,yAxisLabelColor:((w=this.xyChart)==null?void 0:w.yAxisLabelColor)||this.primaryTextColor,yAxisTickColor:((S=this.xyChart)==null?void 0:S.yAxisTickColor)||this.primaryTextColor,yAxisLineColor:((C=this.xyChart)==null?void 0:C.yAxisLineColor)||this.primaryTextColor,plotColorPalette:((k=this.xyChart)==null?void 0:k.plotColorPalette)||"#ECECFF,#8493A6,#FFC3A0,#DCDDE1,#B8E994,#D1A36F,#C3CDE6,#FFB6C1,#496078,#F8F3E3"},this.requirementBackground=this.requirementBackground||this.primaryColor,this.requirementBorderColor=this.requirementBorderColor||this.primaryBorderColor,this.requirementBorderSize=this.requirementBorderSize||"1",this.requirementTextColor=this.requirementTextColor||this.primaryTextColor,this.relationColor=this.relationColor||this.lineColor,this.relationLabelBackground=this.relationLabelBackground||this.labelBackground,this.relationLabelColor=this.relationLabelColor||this.actorTextColor,this.git0=this.git0||this.primaryColor,this.git1=this.git1||this.secondaryColor,this.git2=this.git2||this.tertiaryColor,this.git3=this.git3||bt(this.primaryColor,{h:-30}),this.git4=this.git4||bt(this.primaryColor,{h:-60}),this.git5=this.git5||bt(this.primaryColor,{h:-90}),this.git6=this.git6||bt(this.primaryColor,{h:60}),this.git7=this.git7||bt(this.primaryColor,{h:120}),this.darkMode?(this.git0=wn(this.git0,25),this.git1=wn(this.git1,25),this.git2=wn(this.git2,25),this.git3=wn(this.git3,25),this.git4=wn(this.git4,25),this.git5=wn(this.git5,25),this.git6=wn(this.git6,25),this.git7=wn(this.git7,25)):(this.git0=zn(this.git0,25),this.git1=zn(this.git1,25),this.git2=zn(this.git2,25),this.git3=zn(this.git3,25),this.git4=zn(this.git4,25),this.git5=zn(this.git5,25),this.git6=zn(this.git6,25),this.git7=zn(this.git7,25)),this.gitInv0=this.gitInv0||zn(cn(this.git0),25),this.gitInv1=this.gitInv1||cn(this.git1),this.gitInv2=this.gitInv2||cn(this.git2),this.gitInv3=this.gitInv3||cn(this.git3),this.gitInv4=this.gitInv4||cn(this.git4),this.gitInv5=this.gitInv5||cn(this.git5),this.gitInv6=this.gitInv6||cn(this.git6),this.gitInv7=this.gitInv7||cn(this.git7),this.gitBranchLabel0=this.gitBranchLabel0||cn(this.labelTextColor),this.gitBranchLabel1=this.gitBranchLabel1||this.labelTextColor,this.gitBranchLabel2=this.gitBranchLabel2||this.labelTextColor,this.gitBranchLabel3=this.gitBranchLabel3||cn(this.labelTextColor),this.gitBranchLabel4=this.gitBranchLabel4||this.labelTextColor,this.gitBranchLabel5=this.gitBranchLabel5||this.labelTextColor,this.gitBranchLabel6=this.gitBranchLabel6||this.labelTextColor,this.gitBranchLabel7=this.gitBranchLabel7||this.labelTextColor,this.tagLabelColor=this.tagLabelColor||this.primaryTextColor,this.tagLabelBackground=this.tagLabelBackground||this.primaryColor,this.tagLabelBorder=this.tagBorder||this.primaryBorderColor,this.tagLabelFontSize=this.tagLabelFontSize||"10px",this.commitLabelColor=this.commitLabelColor||this.secondaryTextColor,this.commitLabelBackground=this.commitLabelBackground||this.secondaryColor,this.commitLabelFontSize=this.commitLabelFontSize||"10px",this.attributeBackgroundColorOdd=this.attributeBackgroundColorOdd||dT,this.attributeBackgroundColorEven=this.attributeBackgroundColorEven||fT}calculate(t){if(Object.keys(this).forEach(r=>{this[r]==="calculated"&&(this[r]=void 0)}),typeof t!="object"){this.updateColors();return}const n=Object.keys(t);n.forEach(r=>{this[r]=t[r]}),this.updateColors(),n.forEach(r=>{this[r]=t[r]})}},ie(U0,"Theme"),U0),MIe=ie(e=>{const t=new NIe;return t.calculate(e),t},"getThemeVariables"),q0,IIe=(q0=class{constructor(){this.background="#f4f4f4",this.primaryColor="#cde498",this.secondaryColor="#cdffb2",this.background="white",this.mainBkg="#cde498",this.secondBkg="#cdffb2",this.lineColor="green",this.border1="#13540c",this.border2="#6eaa49",this.arrowheadColor="green",this.fontFamily='"trebuchet ms", verdana, arial, sans-serif',this.fontSize="16px",this.tertiaryColor=wn("#cde498",10),this.primaryBorderColor=Ja(this.primaryColor,this.darkMode),this.secondaryBorderColor=Ja(this.secondaryColor,this.darkMode),this.tertiaryBorderColor=Ja(this.tertiaryColor,this.darkMode),this.primaryTextColor=cn(this.primaryColor),this.secondaryTextColor=cn(this.secondaryColor),this.tertiaryTextColor=cn(this.primaryColor),this.lineColor=cn(this.background),this.textColor=cn(this.background),this.THEME_COLOR_LIMIT=12,this.nodeBkg="calculated",this.nodeBorder="calculated",this.clusterBkg="calculated",this.clusterBorder="calculated",this.defaultLinkColor="calculated",this.titleColor="#333",this.edgeLabelBackground="#e8e8e8",this.actorBorder="calculated",this.actorBkg="calculated",this.actorTextColor="black",this.actorLineColor="calculated",this.signalColor="#333",this.signalTextColor="#333",this.labelBoxBkgColor="calculated",this.labelBoxBorderColor="#326932",this.labelTextColor="calculated",this.loopTextColor="calculated",this.noteBorderColor="calculated",this.noteBkgColor="#fff5ad",this.noteTextColor="calculated",this.activationBorderColor="#666",this.activationBkgColor="#f4f4f4",this.sequenceNumberColor="white",this.sectionBkgColor="#6eaa49",this.altSectionBkgColor="white",this.sectionBkgColor2="#6eaa49",this.excludeBkgColor="#eeeeee",this.taskBorderColor="calculated",this.taskBkgColor="#487e3a",this.taskTextLightColor="white",this.taskTextColor="calculated",this.taskTextDarkColor="black",this.taskTextOutsideColor="calculated",this.taskTextClickableColor="#003163",this.activeTaskBorderColor="calculated",this.activeTaskBkgColor="calculated",this.gridColor="lightgrey",this.doneTaskBkgColor="lightgrey",this.doneTaskBorderColor="grey",this.critBorderColor="#ff8888",this.critBkgColor="red",this.todayLineColor="red",this.personBorder=this.primaryBorderColor,this.personBkg=this.mainBkg,this.archEdgeColor="calculated",this.archEdgeArrowColor="calculated",this.archEdgeWidth="3",this.archGroupBorderColor=this.primaryBorderColor,this.archGroupBorderWidth="2px",this.labelColor="black",this.errorBkgColor="#552222",this.errorTextColor="#552222"}updateColors(){var t,n,r,s,i,a,o,l,c,u,d,h,m,y,b,v,x,w,S,C,k;this.actorBorder=zn(this.mainBkg,20),this.actorBkg=this.mainBkg,this.labelBoxBkgColor=this.actorBkg,this.labelTextColor=this.actorTextColor,this.loopTextColor=this.actorTextColor,this.noteBorderColor=this.border2,this.noteTextColor=this.actorTextColor,this.actorLineColor=this.actorBorder,this.cScale0=this.cScale0||this.primaryColor,this.cScale1=this.cScale1||this.secondaryColor,this.cScale2=this.cScale2||this.tertiaryColor,this.cScale3=this.cScale3||bt(this.primaryColor,{h:30}),this.cScale4=this.cScale4||bt(this.primaryColor,{h:60}),this.cScale5=this.cScale5||bt(this.primaryColor,{h:90}),this.cScale6=this.cScale6||bt(this.primaryColor,{h:120}),this.cScale7=this.cScale7||bt(this.primaryColor,{h:150}),this.cScale8=this.cScale8||bt(this.primaryColor,{h:210}),this.cScale9=this.cScale9||bt(this.primaryColor,{h:270}),this.cScale10=this.cScale10||bt(this.primaryColor,{h:300}),this.cScale11=this.cScale11||bt(this.primaryColor,{h:330}),this.cScalePeer1=this.cScalePeer1||zn(this.secondaryColor,45),this.cScalePeer2=this.cScalePeer2||zn(this.tertiaryColor,40);for(let A=0;A<this.THEME_COLOR_LIMIT;A++)this["cScale"+A]=zn(this["cScale"+A],10),this["cScalePeer"+A]=this["cScalePeer"+A]||zn(this["cScale"+A],25);for(let A=0;A<this.THEME_COLOR_LIMIT;A++)this["cScaleInv"+A]=this["cScaleInv"+A]||bt(this["cScale"+A],{h:180});this.scaleLabelColor=this.scaleLabelColor!=="calculated"&&this.scaleLabelColor?this.scaleLabelColor:this.labelTextColor;for(let A=0;A<this.THEME_COLOR_LIMIT;A++)this["cScaleLabel"+A]=this["cScaleLabel"+A]||this.scaleLabelColor;for(let A=0;A<5;A++)this["surface"+A]=this["surface"+A]||bt(this.mainBkg,{h:30,s:-30,l:-(5+A*5)}),this["surfacePeer"+A]=this["surfacePeer"+A]||bt(this.mainBkg,{h:30,s:-30,l:-(8+A*5)});this.nodeBkg=this.mainBkg,this.nodeBorder=this.border1,this.clusterBkg=this.secondBkg,this.clusterBorder=this.border2,this.defaultLinkColor=this.lineColor,this.taskBorderColor=this.border1,this.taskTextColor=this.taskTextLightColor,this.taskTextOutsideColor=this.taskTextDarkColor,this.activeTaskBorderColor=this.taskBorderColor,this.activeTaskBkgColor=this.mainBkg,this.archEdgeColor=this.lineColor,this.archEdgeArrowColor=this.lineColor,this.rowOdd=this.rowOdd||wn(this.mainBkg,75)||"#ffffff",this.rowEven=this.rowEven||wn(this.mainBkg,20),this.transitionColor=this.transitionColor||this.lineColor,this.transitionLabelColor=this.transitionLabelColor||this.textColor,this.stateLabelColor=this.stateLabelColor||this.stateBkg||this.primaryTextColor,this.stateBkg=this.stateBkg||this.mainBkg,this.labelBackgroundColor=this.labelBackgroundColor||this.stateBkg,this.compositeBackground=this.compositeBackground||this.background||this.tertiaryColor,this.altBackground=this.altBackground||"#f0f0f0",this.compositeTitleBackground=this.compositeTitleBackground||this.mainBkg,this.compositeBorder=this.compositeBorder||this.nodeBorder,this.innerEndBackground=this.primaryBorderColor,this.specialStateColor=this.lineColor,this.errorBkgColor=this.errorBkgColor||this.tertiaryColor,this.errorTextColor=this.errorTextColor||this.tertiaryTextColor,this.transitionColor=this.transitionColor||this.lineColor,this.classText=this.primaryTextColor,this.fillType0=this.primaryColor,this.fillType1=this.secondaryColor,this.fillType2=bt(this.primaryColor,{h:64}),this.fillType3=bt(this.secondaryColor,{h:64}),this.fillType4=bt(this.primaryColor,{h:-64}),this.fillType5=bt(this.secondaryColor,{h:-64}),this.fillType6=bt(this.primaryColor,{h:128}),this.fillType7=bt(this.secondaryColor,{h:128}),this.pie1=this.pie1||this.primaryColor,this.pie2=this.pie2||this.secondaryColor,this.pie3=this.pie3||this.tertiaryColor,this.pie4=this.pie4||bt(this.primaryColor,{l:-30}),this.pie5=this.pie5||bt(this.secondaryColor,{l:-30}),this.pie6=this.pie6||bt(this.tertiaryColor,{h:40,l:-40}),this.pie7=this.pie7||bt(this.primaryColor,{h:60,l:-10}),this.pie8=this.pie8||bt(this.primaryColor,{h:-60,l:-10}),this.pie9=this.pie9||bt(this.primaryColor,{h:120,l:0}),this.pie10=this.pie10||bt(this.primaryColor,{h:60,l:-50}),this.pie11=this.pie11||bt(this.primaryColor,{h:-60,l:-50}),this.pie12=this.pie12||bt(this.primaryColor,{h:120,l:-50}),this.pieTitleTextSize=this.pieTitleTextSize||"25px",this.pieTitleTextColor=this.pieTitleTextColor||this.taskTextDarkColor,this.pieSectionTextSize=this.pieSectionTextSize||"17px",this.pieSectionTextColor=this.pieSectionTextColor||this.textColor,this.pieLegendTextSize=this.pieLegendTextSize||"17px",this.pieLegendTextColor=this.pieLegendTextColor||this.taskTextDarkColor,this.pieStrokeColor=this.pieStrokeColor||"black",this.pieStrokeWidth=this.pieStrokeWidth||"2px",this.pieOuterStrokeWidth=this.pieOuterStrokeWidth||"2px",this.pieOuterStrokeColor=this.pieOuterStrokeColor||"black",this.pieOpacity=this.pieOpacity||"0.7",this.quadrant1Fill=this.quadrant1Fill||this.primaryColor,this.quadrant2Fill=this.quadrant2Fill||bt(this.primaryColor,{r:5,g:5,b:5}),this.quadrant3Fill=this.quadrant3Fill||bt(this.primaryColor,{r:10,g:10,b:10}),this.quadrant4Fill=this.quadrant4Fill||bt(this.primaryColor,{r:15,g:15,b:15}),this.quadrant1TextFill=this.quadrant1TextFill||this.primaryTextColor,this.quadrant2TextFill=this.quadrant2TextFill||bt(this.primaryTextColor,{r:-5,g:-5,b:-5}),this.quadrant3TextFill=this.quadrant3TextFill||bt(this.primaryTextColor,{r:-10,g:-10,b:-10}),this.quadrant4TextFill=this.quadrant4TextFill||bt(this.primaryTextColor,{r:-15,g:-15,b:-15}),this.quadrantPointFill=this.quadrantPointFill||U1(this.quadrant1Fill)?wn(this.quadrant1Fill):zn(this.quadrant1Fill),this.quadrantPointTextFill=this.quadrantPointTextFill||this.primaryTextColor,this.quadrantXAxisTextFill=this.quadrantXAxisTextFill||this.primaryTextColor,this.quadrantYAxisTextFill=this.quadrantYAxisTextFill||this.primaryTextColor,this.quadrantInternalBorderStrokeFill=this.quadrantInternalBorderStrokeFill||this.primaryBorderColor,this.quadrantExternalBorderStrokeFill=this.quadrantExternalBorderStrokeFill||this.primaryBorderColor,this.quadrantTitleFill=this.quadrantTitleFill||this.primaryTextColor,this.packet={startByteColor:this.primaryTextColor,endByteColor:this.primaryTextColor,labelColor:this.primaryTextColor,titleColor:this.primaryTextColor,blockStrokeColor:this.primaryTextColor,blockFillColor:this.mainBkg},this.radar={axisColor:((t=this.radar)==null?void 0:t.axisColor)||this.lineColor,axisStrokeWidth:((n=this.radar)==null?void 0:n.axisStrokeWidth)||2,axisLabelFontSize:((r=this.radar)==null?void 0:r.axisLabelFontSize)||12,curveOpacity:((s=this.radar)==null?void 0:s.curveOpacity)||.5,curveStrokeWidth:((i=this.radar)==null?void 0:i.curveStrokeWidth)||2,graticuleColor:((a=this.radar)==null?void 0:a.graticuleColor)||"#DEDEDE",graticuleStrokeWidth:((o=this.radar)==null?void 0:o.graticuleStrokeWidth)||1,graticuleOpacity:((l=this.radar)==null?void 0:l.graticuleOpacity)||.3,legendBoxSize:((c=this.radar)==null?void 0:c.legendBoxSize)||12,legendFontSize:((u=this.radar)==null?void 0:u.legendFontSize)||12},this.xyChart={backgroundColor:((d=this.xyChart)==null?void 0:d.backgroundColor)||this.background,titleColor:((h=this.xyChart)==null?void 0:h.titleColor)||this.primaryTextColor,xAxisTitleColor:((m=this.xyChart)==null?void 0:m.xAxisTitleColor)||this.primaryTextColor,xAxisLabelColor:((y=this.xyChart)==null?void 0:y.xAxisLabelColor)||this.primaryTextColor,xAxisTickColor:((b=this.xyChart)==null?void 0:b.xAxisTickColor)||this.primaryTextColor,xAxisLineColor:((v=this.xyChart)==null?void 0:v.xAxisLineColor)||this.primaryTextColor,yAxisTitleColor:((x=this.xyChart)==null?void 0:x.yAxisTitleColor)||this.primaryTextColor,yAxisLabelColor:((w=this.xyChart)==null?void 0:w.yAxisLabelColor)||this.primaryTextColor,yAxisTickColor:((S=this.xyChart)==null?void 0:S.yAxisTickColor)||this.primaryTextColor,yAxisLineColor:((C=this.xyChart)==null?void 0:C.yAxisLineColor)||this.primaryTextColor,plotColorPalette:((k=this.xyChart)==null?void 0:k.plotColorPalette)||"#CDE498,#FF6B6B,#A0D2DB,#D7BDE2,#F0F0F0,#FFC3A0,#7FD8BE,#FF9A8B,#FAF3E0,#FFF176"},this.requirementBackground=this.requirementBackground||this.primaryColor,this.requirementBorderColor=this.requirementBorderColor||this.primaryBorderColor,this.requirementBorderSize=this.requirementBorderSize||"1",this.requirementTextColor=this.requirementTextColor||this.primaryTextColor,this.relationColor=this.relationColor||this.lineColor,this.relationLabelBackground=this.relationLabelBackground||this.edgeLabelBackground,this.relationLabelColor=this.relationLabelColor||this.actorTextColor,this.git0=this.git0||this.primaryColor,this.git1=this.git1||this.secondaryColor,this.git2=this.git2||this.tertiaryColor,this.git3=this.git3||bt(this.primaryColor,{h:-30}),this.git4=this.git4||bt(this.primaryColor,{h:-60}),this.git5=this.git5||bt(this.primaryColor,{h:-90}),this.git6=this.git6||bt(this.primaryColor,{h:60}),this.git7=this.git7||bt(this.primaryColor,{h:120}),this.darkMode?(this.git0=wn(this.git0,25),this.git1=wn(this.git1,25),this.git2=wn(this.git2,25),this.git3=wn(this.git3,25),this.git4=wn(this.git4,25),this.git5=wn(this.git5,25),this.git6=wn(this.git6,25),this.git7=wn(this.git7,25)):(this.git0=zn(this.git0,25),this.git1=zn(this.git1,25),this.git2=zn(this.git2,25),this.git3=zn(this.git3,25),this.git4=zn(this.git4,25),this.git5=zn(this.git5,25),this.git6=zn(this.git6,25),this.git7=zn(this.git7,25)),this.gitInv0=this.gitInv0||cn(this.git0),this.gitInv1=this.gitInv1||cn(this.git1),this.gitInv2=this.gitInv2||cn(this.git2),this.gitInv3=this.gitInv3||cn(this.git3),this.gitInv4=this.gitInv4||cn(this.git4),this.gitInv5=this.gitInv5||cn(this.git5),this.gitInv6=this.gitInv6||cn(this.git6),this.gitInv7=this.gitInv7||cn(this.git7),this.gitBranchLabel0=this.gitBranchLabel0||cn(this.labelTextColor),this.gitBranchLabel1=this.gitBranchLabel1||this.labelTextColor,this.gitBranchLabel2=this.gitBranchLabel2||this.labelTextColor,this.gitBranchLabel3=this.gitBranchLabel3||cn(this.labelTextColor),this.gitBranchLabel4=this.gitBranchLabel4||this.labelTextColor,this.gitBranchLabel5=this.gitBranchLabel5||this.labelTextColor,this.gitBranchLabel6=this.gitBranchLabel6||this.labelTextColor,this.gitBranchLabel7=this.gitBranchLabel7||this.labelTextColor,this.tagLabelColor=this.tagLabelColor||this.primaryTextColor,this.tagLabelBackground=this.tagLabelBackground||this.primaryColor,this.tagLabelBorder=this.tagBorder||this.primaryBorderColor,this.tagLabelFontSize=this.tagLabelFontSize||"10px",this.commitLabelColor=this.commitLabelColor||this.secondaryTextColor,this.commitLabelBackground=this.commitLabelBackground||this.secondaryColor,this.commitLabelFontSize=this.commitLabelFontSize||"10px",this.attributeBackgroundColorOdd=this.attributeBackgroundColorOdd||dT,this.attributeBackgroundColorEven=this.attributeBackgroundColorEven||fT}calculate(t){if(typeof t!="object"){this.updateColors();return}const n=Object.keys(t);n.forEach(r=>{this[r]=t[r]}),this.updateColors(),n.forEach(r=>{this[r]=t[r]})}},ie(q0,"Theme"),q0),jIe=ie(e=>{const t=new IIe;return t.calculate(e),t},"getThemeVariables"),V0,PIe=(V0=class{constructor(){this.primaryColor="#eee",this.contrast="#707070",this.secondaryColor=wn(this.contrast,55),this.background="#ffffff",this.tertiaryColor=bt(this.primaryColor,{h:-160}),this.primaryBorderColor=Ja(this.primaryColor,this.darkMode),this.secondaryBorderColor=Ja(this.secondaryColor,this.darkMode),this.tertiaryBorderColor=Ja(this.tertiaryColor,this.darkMode),this.primaryTextColor=cn(this.primaryColor),this.secondaryTextColor=cn(this.secondaryColor),this.tertiaryTextColor=cn(this.tertiaryColor),this.lineColor=cn(this.background),this.textColor=cn(this.background),this.mainBkg="#eee",this.secondBkg="calculated",this.lineColor="#666",this.border1="#999",this.border2="calculated",this.note="#ffa",this.text="#333",this.critical="#d42",this.done="#bbb",this.arrowheadColor="#333333",this.fontFamily='"trebuchet ms", verdana, arial, sans-serif',this.fontSize="16px",this.THEME_COLOR_LIMIT=12,this.nodeBkg="calculated",this.nodeBorder="calculated",this.clusterBkg="calculated",this.clusterBorder="calculated",this.defaultLinkColor="calculated",this.titleColor="calculated",this.edgeLabelBackground="white",this.actorBorder="calculated",this.actorBkg="calculated",this.actorTextColor="calculated",this.actorLineColor=this.actorBorder,this.signalColor="calculated",this.signalTextColor="calculated",this.labelBoxBkgColor="calculated",this.labelBoxBorderColor="calculated",this.labelTextColor="calculated",this.loopTextColor="calculated",this.noteBorderColor="calculated",this.noteBkgColor="calculated",this.noteTextColor="calculated",this.activationBorderColor="#666",this.activationBkgColor="#f4f4f4",this.sequenceNumberColor="white",this.sectionBkgColor="calculated",this.altSectionBkgColor="white",this.sectionBkgColor2="calculated",this.excludeBkgColor="#eeeeee",this.taskBorderColor="calculated",this.taskBkgColor="calculated",this.taskTextLightColor="white",this.taskTextColor="calculated",this.taskTextDarkColor="calculated",this.taskTextOutsideColor="calculated",this.taskTextClickableColor="#003163",this.activeTaskBorderColor="calculated",this.activeTaskBkgColor="calculated",this.gridColor="calculated",this.doneTaskBkgColor="calculated",this.doneTaskBorderColor="calculated",this.critBkgColor="calculated",this.critBorderColor="calculated",this.todayLineColor="calculated",this.personBorder=this.primaryBorderColor,this.personBkg=this.mainBkg,this.archEdgeColor="calculated",this.archEdgeArrowColor="calculated",this.archEdgeWidth="3",this.archGroupBorderColor=this.primaryBorderColor,this.archGroupBorderWidth="2px",this.rowOdd=this.rowOdd||wn(this.mainBkg,75)||"#ffffff",this.rowEven=this.rowEven||"#f4f4f4",this.labelColor="black",this.errorBkgColor="#552222",this.errorTextColor="#552222"}updateColors(){var t,n,r,s,i,a,o,l,c,u,d,h,m,y,b,v,x,w,S,C,k;this.secondBkg=wn(this.contrast,55),this.border2=this.contrast,this.actorBorder=wn(this.border1,23),this.actorBkg=this.mainBkg,this.actorTextColor=this.text,this.actorLineColor=this.actorBorder,this.signalColor=this.text,this.signalTextColor=this.text,this.labelBoxBkgColor=this.actorBkg,this.labelBoxBorderColor=this.actorBorder,this.labelTextColor=this.text,this.loopTextColor=this.text,this.noteBorderColor="#999",this.noteBkgColor="#666",this.noteTextColor="#fff",this.cScale0=this.cScale0||"#555",this.cScale1=this.cScale1||"#F4F4F4",this.cScale2=this.cScale2||"#555",this.cScale3=this.cScale3||"#BBB",this.cScale4=this.cScale4||"#777",this.cScale5=this.cScale5||"#999",this.cScale6=this.cScale6||"#DDD",this.cScale7=this.cScale7||"#FFF",this.cScale8=this.cScale8||"#DDD",this.cScale9=this.cScale9||"#BBB",this.cScale10=this.cScale10||"#999",this.cScale11=this.cScale11||"#777";for(let A=0;A<this.THEME_COLOR_LIMIT;A++)this["cScaleInv"+A]=this["cScaleInv"+A]||cn(this["cScale"+A]);for(let A=0;A<this.THEME_COLOR_LIMIT;A++)this.darkMode?this["cScalePeer"+A]=this["cScalePeer"+A]||wn(this["cScale"+A],10):this["cScalePeer"+A]=this["cScalePeer"+A]||zn(this["cScale"+A],10);this.scaleLabelColor=this.scaleLabelColor||(this.darkMode?"black":this.labelTextColor),this.cScaleLabel0=this.cScaleLabel0||this.cScale1,this.cScaleLabel2=this.cScaleLabel2||this.cScale1;for(let A=0;A<this.THEME_COLOR_LIMIT;A++)this["cScaleLabel"+A]=this["cScaleLabel"+A]||this.scaleLabelColor;for(let A=0;A<5;A++)this["surface"+A]=this["surface"+A]||bt(this.mainBkg,{l:-(5+A*5)}),this["surfacePeer"+A]=this["surfacePeer"+A]||bt(this.mainBkg,{l:-(8+A*5)});this.nodeBkg=this.mainBkg,this.nodeBorder=this.border1,this.clusterBkg=this.secondBkg,this.clusterBorder=this.border2,this.defaultLinkColor=this.lineColor,this.titleColor=this.text,this.sectionBkgColor=wn(this.contrast,30),this.sectionBkgColor2=wn(this.contrast,30),this.taskBorderColor=zn(this.contrast,10),this.taskBkgColor=this.contrast,this.taskTextColor=this.taskTextLightColor,this.taskTextDarkColor=this.text,this.taskTextOutsideColor=this.taskTextDarkColor,this.activeTaskBorderColor=this.taskBorderColor,this.activeTaskBkgColor=this.mainBkg,this.gridColor=wn(this.border1,30),this.doneTaskBkgColor=this.done,this.doneTaskBorderColor=this.lineColor,this.critBkgColor=this.critical,this.critBorderColor=zn(this.critBkgColor,10),this.todayLineColor=this.critBkgColor,this.archEdgeColor=this.lineColor,this.archEdgeArrowColor=this.lineColor,this.transitionColor=this.transitionColor||"#000",this.transitionLabelColor=this.transitionLabelColor||this.textColor,this.stateLabelColor=this.stateLabelColor||this.stateBkg||this.primaryTextColor,this.stateBkg=this.stateBkg||this.mainBkg,this.labelBackgroundColor=this.labelBackgroundColor||this.stateBkg,this.compositeBackground=this.compositeBackground||this.background||this.tertiaryColor,this.altBackground=this.altBackground||"#f4f4f4",this.compositeTitleBackground=this.compositeTitleBackground||this.mainBkg,this.stateBorder=this.stateBorder||"#000",this.innerEndBackground=this.primaryBorderColor,this.specialStateColor="#222",this.errorBkgColor=this.errorBkgColor||this.tertiaryColor,this.errorTextColor=this.errorTextColor||this.tertiaryTextColor,this.classText=this.primaryTextColor,this.fillType0=this.primaryColor,this.fillType1=this.secondaryColor,this.fillType2=bt(this.primaryColor,{h:64}),this.fillType3=bt(this.secondaryColor,{h:64}),this.fillType4=bt(this.primaryColor,{h:-64}),this.fillType5=bt(this.secondaryColor,{h:-64}),this.fillType6=bt(this.primaryColor,{h:128}),this.fillType7=bt(this.secondaryColor,{h:128});for(let A=0;A<this.THEME_COLOR_LIMIT;A++)this["pie"+A]=this["cScale"+A];this.pie12=this.pie0,this.pieTitleTextSize=this.pieTitleTextSize||"25px",this.pieTitleTextColor=this.pieTitleTextColor||this.taskTextDarkColor,this.pieSectionTextSize=this.pieSectionTextSize||"17px",this.pieSectionTextColor=this.pieSectionTextColor||this.textColor,this.pieLegendTextSize=this.pieLegendTextSize||"17px",this.pieLegendTextColor=this.pieLegendTextColor||this.taskTextDarkColor,this.pieStrokeColor=this.pieStrokeColor||"black",this.pieStrokeWidth=this.pieStrokeWidth||"2px",this.pieOuterStrokeWidth=this.pieOuterStrokeWidth||"2px",this.pieOuterStrokeColor=this.pieOuterStrokeColor||"black",this.pieOpacity=this.pieOpacity||"0.7",this.quadrant1Fill=this.quadrant1Fill||this.primaryColor,this.quadrant2Fill=this.quadrant2Fill||bt(this.primaryColor,{r:5,g:5,b:5}),this.quadrant3Fill=this.quadrant3Fill||bt(this.primaryColor,{r:10,g:10,b:10}),this.quadrant4Fill=this.quadrant4Fill||bt(this.primaryColor,{r:15,g:15,b:15}),this.quadrant1TextFill=this.quadrant1TextFill||this.primaryTextColor,this.quadrant2TextFill=this.quadrant2TextFill||bt(this.primaryTextColor,{r:-5,g:-5,b:-5}),this.quadrant3TextFill=this.quadrant3TextFill||bt(this.primaryTextColor,{r:-10,g:-10,b:-10}),this.quadrant4TextFill=this.quadrant4TextFill||bt(this.primaryTextColor,{r:-15,g:-15,b:-15}),this.quadrantPointFill=this.quadrantPointFill||U1(this.quadrant1Fill)?wn(this.quadrant1Fill):zn(this.quadrant1Fill),this.quadrantPointTextFill=this.quadrantPointTextFill||this.primaryTextColor,this.quadrantXAxisTextFill=this.quadrantXAxisTextFill||this.primaryTextColor,this.quadrantYAxisTextFill=this.quadrantYAxisTextFill||this.primaryTextColor,this.quadrantInternalBorderStrokeFill=this.quadrantInternalBorderStrokeFill||this.primaryBorderColor,this.quadrantExternalBorderStrokeFill=this.quadrantExternalBorderStrokeFill||this.primaryBorderColor,this.quadrantTitleFill=this.quadrantTitleFill||this.primaryTextColor,this.xyChart={backgroundColor:((t=this.xyChart)==null?void 0:t.backgroundColor)||this.background,titleColor:((n=this.xyChart)==null?void 0:n.titleColor)||this.primaryTextColor,xAxisTitleColor:((r=this.xyChart)==null?void 0:r.xAxisTitleColor)||this.primaryTextColor,xAxisLabelColor:((s=this.xyChart)==null?void 0:s.xAxisLabelColor)||this.primaryTextColor,xAxisTickColor:((i=this.xyChart)==null?void 0:i.xAxisTickColor)||this.primaryTextColor,xAxisLineColor:((a=this.xyChart)==null?void 0:a.xAxisLineColor)||this.primaryTextColor,yAxisTitleColor:((o=this.xyChart)==null?void 0:o.yAxisTitleColor)||this.primaryTextColor,yAxisLabelColor:((l=this.xyChart)==null?void 0:l.yAxisLabelColor)||this.primaryTextColor,yAxisTickColor:((c=this.xyChart)==null?void 0:c.yAxisTickColor)||this.primaryTextColor,yAxisLineColor:((u=this.xyChart)==null?void 0:u.yAxisLineColor)||this.primaryTextColor,plotColorPalette:((d=this.xyChart)==null?void 0:d.plotColorPalette)||"#EEE,#6BB8E4,#8ACB88,#C7ACD6,#E8DCC2,#FFB2A8,#FFF380,#7E8D91,#FFD8B1,#FAF3E0"},this.radar={axisColor:((h=this.radar)==null?void 0:h.axisColor)||this.lineColor,axisStrokeWidth:((m=this.radar)==null?void 0:m.axisStrokeWidth)||2,axisLabelFontSize:((y=this.radar)==null?void 0:y.axisLabelFontSize)||12,curveOpacity:((b=this.radar)==null?void 0:b.curveOpacity)||.5,curveStrokeWidth:((v=this.radar)==null?void 0:v.curveStrokeWidth)||2,graticuleColor:((x=this.radar)==null?void 0:x.graticuleColor)||"#DEDEDE",graticuleStrokeWidth:((w=this.radar)==null?void 0:w.graticuleStrokeWidth)||1,graticuleOpacity:((S=this.radar)==null?void 0:S.graticuleOpacity)||.3,legendBoxSize:((C=this.radar)==null?void 0:C.legendBoxSize)||12,legendFontSize:((k=this.radar)==null?void 0:k.legendFontSize)||12},this.requirementBackground=this.requirementBackground||this.primaryColor,this.requirementBorderColor=this.requirementBorderColor||this.primaryBorderColor,this.requirementBorderSize=this.requirementBorderSize||"1",this.requirementTextColor=this.requirementTextColor||this.primaryTextColor,this.relationColor=this.relationColor||this.lineColor,this.relationLabelBackground=this.relationLabelBackground||this.edgeLabelBackground,this.relationLabelColor=this.relationLabelColor||this.actorTextColor,this.git0=zn(this.pie1,25)||this.primaryColor,this.git1=this.pie2||this.secondaryColor,this.git2=this.pie3||this.tertiaryColor,this.git3=this.pie4||bt(this.primaryColor,{h:-30}),this.git4=this.pie5||bt(this.primaryColor,{h:-60}),this.git5=this.pie6||bt(this.primaryColor,{h:-90}),this.git6=this.pie7||bt(this.primaryColor,{h:60}),this.git7=this.pie8||bt(this.primaryColor,{h:120}),this.gitInv0=this.gitInv0||cn(this.git0),this.gitInv1=this.gitInv1||cn(this.git1),this.gitInv2=this.gitInv2||cn(this.git2),this.gitInv3=this.gitInv3||cn(this.git3),this.gitInv4=this.gitInv4||cn(this.git4),this.gitInv5=this.gitInv5||cn(this.git5),this.gitInv6=this.gitInv6||cn(this.git6),this.gitInv7=this.gitInv7||cn(this.git7),this.branchLabelColor=this.branchLabelColor||this.labelTextColor,this.gitBranchLabel0=this.branchLabelColor,this.gitBranchLabel1="white",this.gitBranchLabel2=this.branchLabelColor,this.gitBranchLabel3="white",this.gitBranchLabel4=this.branchLabelColor,this.gitBranchLabel5=this.branchLabelColor,this.gitBranchLabel6=this.branchLabelColor,this.gitBranchLabel7=this.branchLabelColor,this.tagLabelColor=this.tagLabelColor||this.primaryTextColor,this.tagLabelBackground=this.tagLabelBackground||this.primaryColor,this.tagLabelBorder=this.tagBorder||this.primaryBorderColor,this.tagLabelFontSize=this.tagLabelFontSize||"10px",this.commitLabelColor=this.commitLabelColor||this.secondaryTextColor,this.commitLabelBackground=this.commitLabelBackground||this.secondaryColor,this.commitLabelFontSize=this.commitLabelFontSize||"10px",this.attributeBackgroundColorOdd=this.attributeBackgroundColorOdd||dT,this.attributeBackgroundColorEven=this.attributeBackgroundColorEven||fT}calculate(t){if(typeof t!="object"){this.updateColors();return}const n=Object.keys(t);n.forEach(r=>{this[r]=t[r]}),this.updateColors(),n.forEach(r=>{this[r]=t[r]})}},ie(V0,"Theme"),V0),OIe=ie(e=>{const t=new PIe;return t.calculate(e),t},"getThemeVariables"),Fd={base:{getThemeVariables:TIe},dark:{getThemeVariables:RIe},default:{getThemeVariables:MIe},forest:{getThemeVariables:jIe},neutral:{getThemeVariables:OIe}},gd={flowchart:{useMaxWidth:!0,titleTopMargin:25,subGraphTitleMargin:{top:0,bottom:0},diagramPadding:8,htmlLabels:!0,nodeSpacing:50,rankSpacing:50,curve:"basis",padding:15,defaultRenderer:"dagre-wrapper",wrappingWidth:200},sequence:{useMaxWidth:!0,hideUnusedParticipants:!1,activationWidth:10,diagramMarginX:50,diagramMarginY:10,actorMargin:50,width:150,height:65,boxMargin:10,boxTextMargin:5,noteMargin:10,messageMargin:35,messageAlign:"center",mirrorActors:!0,forceMenus:!1,bottomMarginAdj:1,rightAngles:!1,showSequenceNumbers:!1,actorFontSize:14,actorFontFamily:'"Open Sans", sans-serif',actorFontWeight:400,noteFontSize:14,noteFontFamily:'"trebuchet ms", verdana, arial, sans-serif',noteFontWeight:400,noteAlign:"center",messageFontSize:16,messageFontFamily:'"trebuchet ms", verdana, arial, sans-serif',messageFontWeight:400,wrap:!1,wrapPadding:10,labelBoxWidth:50,labelBoxHeight:20},gantt:{useMaxWidth:!0,titleTopMargin:25,barHeight:20,barGap:4,topPadding:50,rightPadding:75,leftPadding:75,gridLineStartPadding:35,fontSize:11,sectionFontSize:11,numberSectionStyles:4,axisFormat:"%Y-%m-%d",topAxis:!1,displayMode:"",weekday:"sunday"},journey:{useMaxWidth:!0,diagramMarginX:50,diagramMarginY:10,leftMargin:150,width:150,height:50,boxMargin:10,boxTextMargin:5,noteMargin:10,messageMargin:35,messageAlign:"center",bottomMarginAdj:1,rightAngles:!1,taskFontSize:14,taskFontFamily:'"Open Sans", sans-serif',taskMargin:50,activationWidth:10,textPlacement:"fo",actorColours:["#8FBC8F","#7CFC00","#00FFFF","#20B2AA","#B0E0E6","#FFFFE0"],sectionFills:["#191970","#8B008B","#4B0082","#2F4F4F","#800000","#8B4513","#00008B"],sectionColours:["#fff"]},class:{useMaxWidth:!0,titleTopMargin:25,arrowMarkerAbsolute:!1,dividerMargin:10,padding:5,textHeight:10,defaultRenderer:"dagre-wrapper",htmlLabels:!1,hideEmptyMembersBox:!1},state:{useMaxWidth:!0,titleTopMargin:25,dividerMargin:10,sizeUnit:5,padding:8,textHeight:10,titleShift:-15,noteMargin:10,forkWidth:70,forkHeight:7,miniPadding:2,fontSizeFactor:5.02,fontSize:24,labelHeight:16,edgeLengthFactor:"20",compositTitleSize:35,radius:5,defaultRenderer:"dagre-wrapper"},er:{useMaxWidth:!0,titleTopMargin:25,diagramPadding:20,layoutDirection:"TB",minEntityWidth:100,minEntityHeight:75,entityPadding:15,nodeSpacing:140,rankSpacing:80,stroke:"gray",fill:"honeydew",fontSize:12},pie:{useMaxWidth:!0,textPosition:.75},quadrantChart:{useMaxWidth:!0,chartWidth:500,chartHeight:500,titleFontSize:20,titlePadding:10,quadrantPadding:5,xAxisLabelPadding:5,yAxisLabelPadding:5,xAxisLabelFontSize:16,yAxisLabelFontSize:16,quadrantLabelFontSize:16,quadrantTextTopPadding:5,pointTextPadding:5,pointLabelFontSize:12,pointRadius:5,xAxisPosition:"top",yAxisPosition:"left",quadrantInternalBorderStrokeWidth:1,quadrantExternalBorderStrokeWidth:2},xyChart:{useMaxWidth:!0,width:700,height:500,titleFontSize:20,titlePadding:10,showTitle:!0,xAxis:{$ref:"#/$defs/XYChartAxisConfig",showLabel:!0,labelFontSize:14,labelPadding:5,showTitle:!0,titleFontSize:16,titlePadding:5,showTick:!0,tickLength:5,tickWidth:2,showAxisLine:!0,axisLineWidth:2},yAxis:{$ref:"#/$defs/XYChartAxisConfig",showLabel:!0,labelFontSize:14,labelPadding:5,showTitle:!0,titleFontSize:16,titlePadding:5,showTick:!0,tickLength:5,tickWidth:2,showAxisLine:!0,axisLineWidth:2},chartOrientation:"vertical",plotReservedSpacePercent:50},requirement:{useMaxWidth:!0,rect_fill:"#f9f9f9",text_color:"#333",rect_border_size:"0.5px",rect_border_color:"#bbb",rect_min_width:200,rect_min_height:200,fontSize:14,rect_padding:10,line_height:20},mindmap:{useMaxWidth:!0,padding:10,maxNodeWidth:200},kanban:{useMaxWidth:!0,padding:8,sectionWidth:200,ticketBaseUrl:""},timeline:{useMaxWidth:!0,diagramMarginX:50,diagramMarginY:10,leftMargin:150,width:150,height:50,boxMargin:10,boxTextMargin:5,noteMargin:10,messageMargin:35,messageAlign:"center",bottomMarginAdj:1,rightAngles:!1,taskFontSize:14,taskFontFamily:'"Open Sans", sans-serif',taskMargin:50,activationWidth:10,textPlacement:"fo",actorColours:["#8FBC8F","#7CFC00","#00FFFF","#20B2AA","#B0E0E6","#FFFFE0"],sectionFills:["#191970","#8B008B","#4B0082","#2F4F4F","#800000","#8B4513","#00008B"],sectionColours:["#fff"],disableMulticolor:!1},gitGraph:{useMaxWidth:!0,titleTopMargin:25,diagramPadding:8,nodeLabel:{width:75,height:100,x:-25,y:0},mainBranchName:"main",mainBranchOrder:0,showCommitLabel:!0,showBranches:!0,rotateCommitLabel:!0,parallelCommits:!1,arrowMarkerAbsolute:!1},c4:{useMaxWidth:!0,diagramMarginX:50,diagramMarginY:10,c4ShapeMargin:50,c4ShapePadding:20,width:216,height:60,boxMargin:10,c4ShapeInRow:4,nextLinePaddingX:0,c4BoundaryInRow:2,personFontSize:14,personFontFamily:'"Open Sans", sans-serif',personFontWeight:"normal",external_personFontSize:14,external_personFontFamily:'"Open Sans", sans-serif',external_personFontWeight:"normal",systemFontSize:14,systemFontFamily:'"Open Sans", sans-serif',systemFontWeight:"normal",external_systemFontSize:14,external_systemFontFamily:'"Open Sans", sans-serif',external_systemFontWeight:"normal",system_dbFontSize:14,system_dbFontFamily:'"Open Sans", sans-serif',system_dbFontWeight:"normal",external_system_dbFontSize:14,external_system_dbFontFamily:'"Open Sans", sans-serif',external_system_dbFontWeight:"normal",system_queueFontSize:14,system_queueFontFamily:'"Open Sans", sans-serif',system_queueFontWeight:"normal",external_system_queueFontSize:14,external_system_queueFontFamily:'"Open Sans", sans-serif',external_system_queueFontWeight:"normal",boundaryFontSize:14,boundaryFontFamily:'"Open Sans", sans-serif',boundaryFontWeight:"normal",messageFontSize:12,messageFontFamily:'"Open Sans", sans-serif',messageFontWeight:"normal",containerFontSize:14,containerFontFamily:'"Open Sans", sans-serif',containerFontWeight:"normal",external_containerFontSize:14,external_containerFontFamily:'"Open Sans", sans-serif',external_containerFontWeight:"normal",container_dbFontSize:14,container_dbFontFamily:'"Open Sans", sans-serif',container_dbFontWeight:"normal",external_container_dbFontSize:14,external_container_dbFontFamily:'"Open Sans", sans-serif',external_container_dbFontWeight:"normal",container_queueFontSize:14,container_queueFontFamily:'"Open Sans", sans-serif',container_queueFontWeight:"normal",external_container_queueFontSize:14,external_container_queueFontFamily:'"Open Sans", sans-serif',external_container_queueFontWeight:"normal",componentFontSize:14,componentFontFamily:'"Open Sans", sans-serif',componentFontWeight:"normal",external_componentFontSize:14,external_componentFontFamily:'"Open Sans", sans-serif',external_componentFontWeight:"normal",component_dbFontSize:14,component_dbFontFamily:'"Open Sans", sans-serif',component_dbFontWeight:"normal",external_component_dbFontSize:14,external_component_dbFontFamily:'"Open Sans", sans-serif',external_component_dbFontWeight:"normal",component_queueFontSize:14,component_queueFontFamily:'"Open Sans", sans-serif',component_queueFontWeight:"normal",external_component_queueFontSize:14,external_component_queueFontFamily:'"Open Sans", sans-serif',external_component_queueFontWeight:"normal",wrap:!0,wrapPadding:10,person_bg_color:"#08427B",person_border_color:"#073B6F",external_person_bg_color:"#686868",external_person_border_color:"#8A8A8A",system_bg_color:"#1168BD",system_border_color:"#3C7FC0",system_db_bg_color:"#1168BD",system_db_border_color:"#3C7FC0",system_queue_bg_color:"#1168BD",system_queue_border_color:"#3C7FC0",external_system_bg_color:"#999999",external_system_border_color:"#8A8A8A",external_system_db_bg_color:"#999999",external_system_db_border_color:"#8A8A8A",external_system_queue_bg_color:"#999999",external_system_queue_border_color:"#8A8A8A",container_bg_color:"#438DD5",container_border_color:"#3C7FC0",container_db_bg_color:"#438DD5",container_db_border_color:"#3C7FC0",container_queue_bg_color:"#438DD5",container_queue_border_color:"#3C7FC0",external_container_bg_color:"#B3B3B3",external_container_border_color:"#A6A6A6",external_container_db_bg_color:"#B3B3B3",external_container_db_border_color:"#A6A6A6",external_container_queue_bg_color:"#B3B3B3",external_container_queue_border_color:"#A6A6A6",component_bg_color:"#85BBF0",component_border_color:"#78A8D8",component_db_bg_color:"#85BBF0",component_db_border_color:"#78A8D8",component_queue_bg_color:"#85BBF0",component_queue_border_color:"#78A8D8",external_component_bg_color:"#CCCCCC",external_component_border_color:"#BFBFBF",external_component_db_bg_color:"#CCCCCC",external_component_db_border_color:"#BFBFBF",external_component_queue_bg_color:"#CCCCCC",external_component_queue_border_color:"#BFBFBF"},sankey:{useMaxWidth:!0,width:600,height:400,linkColor:"gradient",nodeAlignment:"justify",showValues:!0,prefix:"",suffix:""},block:{useMaxWidth:!0,padding:8},packet:{useMaxWidth:!0,rowHeight:32,bitWidth:32,bitsPerRow:32,showBits:!0,paddingX:5,paddingY:5},architecture:{useMaxWidth:!0,padding:40,iconSize:80,fontSize:16},radar:{useMaxWidth:!0,width:600,height:600,marginTop:50,marginRight:50,marginBottom:50,marginLeft:50,axisScaleFactor:1,axisLabelFactor:1.05,curveTension:.17},theme:"default",look:"classic",handDrawnSeed:0,layout:"dagre",maxTextSize:5e4,maxEdges:500,darkMode:!1,fontFamily:'"trebuchet ms", verdana, arial, sans-serif;',logLevel:5,securityLevel:"strict",startOnLoad:!0,arrowMarkerAbsolute:!1,secure:["secure","securityLevel","startOnLoad","maxTextSize","suppressErrorRendering","maxEdges"],legacyMathML:!1,forceLegacyMathML:!1,deterministicIds:!1,fontSize:16,markdownAutoWrap:!0,suppressErrorRendering:!1},_X={...gd,deterministicIDSeed:void 0,elk:{mergeEdges:!1,nodePlacementStrategy:"BRANDES_KOEPF"},themeCSS:void 0,themeVariables:Fd.default.getThemeVariables(),sequence:{...gd.sequence,messageFont:ie(function(){return{fontFamily:this.messageFontFamily,fontSize:this.messageFontSize,fontWeight:this.messageFontWeight}},"messageFont"),noteFont:ie(function(){return{fontFamily:this.noteFontFamily,fontSize:this.noteFontSize,fontWeight:this.noteFontWeight}},"noteFont"),actorFont:ie(function(){return{fontFamily:this.actorFontFamily,fontSize:this.actorFontSize,fontWeight:this.actorFontWeight}},"actorFont")},class:{hideEmptyMembersBox:!1},gantt:{...gd.gantt,tickInterval:void 0,useWidth:void 0},c4:{...gd.c4,useWidth:void 0,personFont:ie(function(){return{fontFamily:this.personFontFamily,fontSize:this.personFontSize,fontWeight:this.personFontWeight}},"personFont"),external_personFont:ie(function(){return{fontFamily:this.external_personFontFamily,fontSize:this.external_personFontSize,fontWeight:this.external_personFontWeight}},"external_personFont"),systemFont:ie(function(){return{fontFamily:this.systemFontFamily,fontSize:this.systemFontSize,fontWeight:this.systemFontWeight}},"systemFont"),external_systemFont:ie(function(){return{fontFamily:this.external_systemFontFamily,fontSize:this.external_systemFontSize,fontWeight:this.external_systemFontWeight}},"external_systemFont"),system_dbFont:ie(function(){return{fontFamily:this.system_dbFontFamily,fontSize:this.system_dbFontSize,fontWeight:this.system_dbFontWeight}},"system_dbFont"),external_system_dbFont:ie(function(){return{fontFamily:this.external_system_dbFontFamily,fontSize:this.external_system_dbFontSize,fontWeight:this.external_system_dbFontWeight}},"external_system_dbFont"),system_queueFont:ie(function(){return{fontFamily:this.system_queueFontFamily,fontSize:this.system_queueFontSize,fontWeight:this.system_queueFontWeight}},"system_queueFont"),external_system_queueFont:ie(function(){return{fontFamily:this.external_system_queueFontFamily,fontSize:this.external_system_queueFontSize,fontWeight:this.external_system_queueFontWeight}},"external_system_queueFont"),containerFont:ie(function(){return{fontFamily:this.containerFontFamily,fontSize:this.containerFontSize,fontWeight:this.containerFontWeight}},"containerFont"),external_containerFont:ie(function(){return{fontFamily:this.external_containerFontFamily,fontSize:this.external_containerFontSize,fontWeight:this.external_containerFontWeight}},"external_containerFont"),container_dbFont:ie(function(){return{fontFamily:this.container_dbFontFamily,fontSize:this.container_dbFontSize,fontWeight:this.container_dbFontWeight}},"container_dbFont"),external_container_dbFont:ie(function(){return{fontFamily:this.external_container_dbFontFamily,fontSize:this.external_container_dbFontSize,fontWeight:this.external_container_dbFontWeight}},"external_container_dbFont"),container_queueFont:ie(function(){return{fontFamily:this.container_queueFontFamily,fontSize:this.container_queueFontSize,fontWeight:this.container_queueFontWeight}},"container_queueFont"),external_container_queueFont:ie(function(){return{fontFamily:this.external_container_queueFontFamily,fontSize:this.external_container_queueFontSize,fontWeight:this.external_container_queueFontWeight}},"external_container_queueFont"),componentFont:ie(function(){return{fontFamily:this.componentFontFamily,fontSize:this.componentFontSize,fontWeight:this.componentFontWeight}},"componentFont"),external_componentFont:ie(function(){return{fontFamily:this.external_componentFontFamily,fontSize:this.external_componentFontSize,fontWeight:this.external_componentFontWeight}},"external_componentFont"),component_dbFont:ie(function(){return{fontFamily:this.component_dbFontFamily,fontSize:this.component_dbFontSize,fontWeight:this.component_dbFontWeight}},"component_dbFont"),external_component_dbFont:ie(function(){return{fontFamily:this.external_component_dbFontFamily,fontSize:this.external_component_dbFontSize,fontWeight:this.external_component_dbFontWeight}},"external_component_dbFont"),component_queueFont:ie(function(){return{fontFamily:this.component_queueFontFamily,fontSize:this.component_queueFontSize,fontWeight:this.component_queueFontWeight}},"component_queueFont"),external_component_queueFont:ie(function(){return{fontFamily:this.external_component_queueFontFamily,fontSize:this.external_component_queueFontSize,fontWeight:this.external_component_queueFontWeight}},"external_component_queueFont"),boundaryFont:ie(function(){return{fontFamily:this.boundaryFontFamily,fontSize:this.boundaryFontSize,fontWeight:this.boundaryFontWeight}},"boundaryFont"),messageFont:ie(function(){return{fontFamily:this.messageFontFamily,fontSize:this.messageFontSize,fontWeight:this.messageFontWeight}},"messageFont")},pie:{...gd.pie,useWidth:984},xyChart:{...gd.xyChart,useWidth:void 0},requirement:{...gd.requirement,useWidth:void 0},packet:{...gd.packet},radar:{...gd.radar}},SX=ie((e,t="")=>Object.keys(e).reduce((n,r)=>Array.isArray(e[r])?n:typeof e[r]=="object"&&e[r]!==null?[...n,t+r,...SX(e[r],"")]:[...n,t+r],[]),"keyify"),DIe=new Set(SX(_X,"")),CX=_X,rk=ie(e=>{if(zt.debug("sanitizeDirective called with",e),!(typeof e!="object"||e==null)){if(Array.isArray(e)){e.forEach(t=>rk(t));return}for(const t of Object.keys(e)){if(zt.debug("Checking key",t),t.startsWith("__")||t.includes("proto")||t.includes("constr")||!DIe.has(t)||e[t]==null){zt.debug("sanitize deleting key: ",t),delete e[t];continue}if(typeof e[t]=="object"){zt.debug("sanitizing object",t),rk(e[t]);continue}const n=["themeCSS","fontFamily","altFontFamily"];for(const r of n)t.includes(r)&&(zt.debug("sanitizing css option",t),e[t]=FIe(e[t]))}if(e.themeVariables)for(const t of Object.keys(e.themeVariables)){const n=e.themeVariables[t];n!=null&&n.match&&!n.match(/^[\d "#%(),.;A-Za-z]+$/)&&(e.themeVariables[t]="")}zt.debug("After sanitization",e)}},"sanitizeDirective"),FIe=ie(e=>{let t=0,n=0;for(const r of e){if(t<n)return"{ /* ERROR: Unbalanced CSS */ }";r==="{"?t++:r==="}"&&n++}return t!==n?"{ /* ERROR: Unbalanced CSS */ }":e},"sanitizeCss"),vy=Object.freeze(CX),xo=xa({},vy),kX,xy=[],_x=xa({},vy),hT=ie((e,t)=>{let n=xa({},e),r={};for(const s of t)AX(s),r=xa(r,s);if(n=xa(n,r),r.theme&&r.theme in Fd){const s=xa({},kX),i=xa(s.themeVariables||{},r.themeVariables);n.theme&&n.theme in Fd&&(n.themeVariables=Fd[n.theme].getThemeVariables(i))}return _x=n,RX(_x),_x},"updateCurrentConfig"),LIe=ie(e=>(xo=xa({},vy),xo=xa(xo,e),e.theme&&Fd[e.theme]&&(xo.themeVariables=Fd[e.theme].getThemeVariables(e.themeVariables)),hT(xo,xy),xo),"setSiteConfig"),BIe=ie(e=>{kX=xa({},e)},"saveConfigFromInitialize"),$Ie=ie(e=>(xo=xa(xo,e),hT(xo,xy),xo),"updateSiteConfig"),EX=ie(()=>xa({},xo),"getSiteConfig"),TX=ie(e=>(RX(e),xa(_x,e),Mo()),"setConfig"),Mo=ie(()=>xa({},_x),"getConfig"),AX=ie(e=>{e&&(["secure",...xo.secure??[]].forEach(t=>{Object.hasOwn(e,t)&&(zt.debug(`Denied attempt to modify a secure key ${t}`,e[t]),delete e[t])}),Object.keys(e).forEach(t=>{t.startsWith("__")&&delete e[t]}),Object.keys(e).forEach(t=>{typeof e[t]=="string"&&(e[t].includes("<")||e[t].includes(">")||e[t].includes("url(data:"))&&delete e[t],typeof e[t]=="object"&&AX(e[t])}))},"sanitize"),zIe=ie(e=>{var t;rk(e),e.fontFamily&&!((t=e.themeVariables)!=null&&t.fontFamily)&&(e.themeVariables={...e.themeVariables,fontFamily:e.fontFamily}),xy.push(e),hT(xo,xy)},"addDirective"),sk=ie((e=xo)=>{xy=[],hT(e,xy)},"reset"),UIe={LAZY_LOAD_DEPRECATED:"The configuration options lazyLoadedDiagrams and loadExternalDiagramsAtStartup are deprecated. Please use registerExternalDiagrams instead."},c7={},qIe=ie(e=>{c7[e]||(zt.warn(UIe[e]),c7[e]=!0)},"issueWarning"),RX=ie(e=>{e&&(e.lazyLoadedDiagrams||e.loadExternalDiagramsAtStartup)&&qIe("LAZY_LOAD_DEPRECATED")},"checkConfig"),q1=/<br\s*\/?>/gi,VIe=ie(e=>e?IX(e).replace(/\\n/g,"#br#").split("#br#"):[""],"getRows"),WIe=(()=>{let e=!1;return()=>{e||(NX(),e=!0)}})();function NX(){const e="data-temp-href-target";yy.addHook("beforeSanitizeAttributes",t=>{t instanceof Element&&t.tagName==="A"&&t.hasAttribute("target")&&t.setAttribute(e,t.getAttribute("target")??"")}),yy.addHook("afterSanitizeAttributes",t=>{t instanceof Element&&t.tagName==="A"&&t.hasAttribute(e)&&(t.setAttribute("target",t.getAttribute(e)??""),t.removeAttribute(e),t.getAttribute("target")==="_blank"&&t.setAttribute("rel","noopener"))})}ie(NX,"setupDompurifyHooks");var MX=ie(e=>(WIe(),yy.sanitize(e)),"removeScript"),u7=ie((e,t)=>{var n;if(((n=t.flowchart)==null?void 0:n.htmlLabels)!==!1){const r=t.securityLevel;r==="antiscript"||r==="strict"?e=MX(e):r!=="loose"&&(e=IX(e),e=e.replace(/</g,"&lt;").replace(/>/g,"&gt;"),e=e.replace(/=/g,"&equals;"),e=YIe(e))}return e},"sanitizeMore"),Tm=ie((e,t)=>e&&(t.dompurifyConfig?e=yy.sanitize(u7(e,t),t.dompurifyConfig).toString():e=yy.sanitize(u7(e,t),{FORBID_TAGS:["style"]}).toString(),e),"sanitizeText"),HIe=ie((e,t)=>typeof e=="string"?Tm(e,t):e.flat().map(n=>Tm(n,t)),"sanitizeTextOrArray"),GIe=ie(e=>q1.test(e),"hasBreaks"),KIe=ie(e=>e.split(q1),"splitBreaks"),YIe=ie(e=>e.replace(/#br#/g,"<br/>"),"placeholderToBreak"),IX=ie(e=>e.replace(q1,"#br#"),"breakToPlaceholder"),ZIe=ie(e=>{let t="";return e&&(t=window.location.protocol+"//"+window.location.host+window.location.pathname+window.location.search,t=t.replaceAll(/\(/g,"\\("),t=t.replaceAll(/\)/g,"\\)")),t},"getUrl"),Wi=ie(e=>!(e===!1||["false","null","0"].includes(String(e).trim().toLowerCase())),"evaluate"),XIe=ie(function(...e){const t=e.filter(n=>!isNaN(n));return Math.max(...t)},"getMax"),JIe=ie(function(...e){const t=e.filter(n=>!isNaN(n));return Math.min(...t)},"getMin"),d7=ie(function(e){const t=e.split(/(,)/),n=[];for(let r=0;r<t.length;r++){let s=t[r];if(s===","&&r>0&&r+1<t.length){const i=t[r-1],a=t[r+1];QIe(i,a)&&(s=i+","+a,r++,n.pop())}n.push(e3e(s))}return n.join("")},"parseGenericTypes"),Fj=ie((e,t)=>Math.max(0,e.split(t).length-1),"countOccurrence"),QIe=ie((e,t)=>{const n=Fj(e,"~"),r=Fj(t,"~");return n===1&&r===1},"shouldCombineSets"),e3e=ie(e=>{const t=Fj(e,"~");let n=!1;if(t<=1)return e;t%2!==0&&e.startsWith("~")&&(e=e.substring(1),n=!0);const r=[...e];let s=r.indexOf("~"),i=r.lastIndexOf("~");for(;s!==-1&&i!==-1&&s!==i;)r[s]="<",r[i]=">",s=r.indexOf("~"),i=r.lastIndexOf("~");return n&&r.unshift("~"),r.join("")},"processSet"),f7=ie(()=>window.MathMLElement!==void 0,"isMathMLSupported"),Lj=/\$\$(.*)\$\$/g,wy=ie(e=>{var t;return(((t=e.match(Lj))==null?void 0:t.length)??0)>0},"hasKatex"),Gut=ie(async(e,t)=>{e=await SD(e,t);const n=document.createElement("div");n.innerHTML=e,n.id="katex-temp",n.style.visibility="hidden",n.style.position="absolute",n.style.top="0";const r=document.querySelector("body");r==null||r.insertAdjacentElement("beforeend",n);const s={width:n.clientWidth,height:n.clientHeight};return n.remove(),s},"calculateMathMLDimensions"),SD=ie(async(e,t)=>{if(!wy(e))return e;if(!(f7()||t.legacyMathML||t.forceLegacyMathML))return e.replace(Lj,"MathML is unsupported in this environment.");const{default:n}=await Zr(async()=>{const{default:s}=await import("./katex-ChWnQ-fc.js");return{default:s}},[]),r=t.forceLegacyMathML||!f7()&&t.legacyMathML?"htmlAndMathml":"mathml";return e.split(q1).map(s=>wy(s)?`<div style="display: flex; align-items: center; justify-content: center; white-space: nowrap;">${s}</div>`:`<div>${s}</div>`).join("").replace(Lj,(s,i)=>n.renderToString(i,{throwOnError:!0,displayMode:!0,output:r}).replace(/\n/g," ").replace(/<annotation.*<\/annotation>/g,""))},"renderKatex"),rb={getRows:VIe,sanitizeText:Tm,sanitizeTextOrArray:HIe,hasBreaks:GIe,splitBreaks:KIe,lineBreakRegex:q1,removeScript:MX,getUrl:ZIe,evaluate:Wi,getMax:XIe,getMin:JIe},t3e=ie(function(e,t){for(let n of t)e.attr(n[0],n[1])},"d3Attrs"),n3e=ie(function(e,t,n){let r=new Map;return n?(r.set("width","100%"),r.set("style",`max-width: ${t}px;`)):(r.set("height",e),r.set("width",t)),r},"calculateSvgSizeAttrs"),jX=ie(function(e,t,n,r){const s=n3e(t,n,r);t3e(e,s)},"configureSvgSize"),r3e=ie(function(e,t,n,r){const s=t.node().getBBox(),i=s.width,a=s.height;zt.info(`SVG bounds: ${i}x${a}`,s);let o=0,l=0;zt.info(`Graph bounds: ${o}x${l}`,e),o=i+n*2,l=a+n*2,zt.info(`Calculated bounds: ${o}x${l}`),jX(t,l,o,r);const c=`${s.x-n} ${s.y-n} ${s.width+2*n} ${s.height+2*n}`;t.attr("viewBox",c)},"setupGraphViewbox"),j2={},s3e=ie((e,t,n)=>{let r="";return e in j2&&j2[e]?r=j2[e](n):zt.warn(`No theme found for ${e}`),` & {
    font-family: ${n.fontFamily};
    font-size: ${n.fontSize};
    fill: ${n.textColor}
  }
  @keyframes edge-animation-frame {
    from {
      stroke-dashoffset: 0;
    }
  }
  @keyframes dash {
    to {
      stroke-dashoffset: 0;
    }
  }
  & .edge-animation-slow {
    stroke-dasharray: 9,5 !important;
    stroke-dashoffset: 900;
    animation: dash 50s linear infinite;
    stroke-linecap: round;
  }
  & .edge-animation-fast {
    stroke-dasharray: 9,5 !important;
    stroke-dashoffset: 900;
    animation: dash 20s linear infinite;
    stroke-linecap: round;
  }
  /* Classes common for multiple diagrams */

  & .error-icon {
    fill: ${n.errorBkgColor};
  }
  & .error-text {
    fill: ${n.errorTextColor};
    stroke: ${n.errorTextColor};
  }

  & .edge-thickness-normal {
    stroke-width: 1px;
  }
  & .edge-thickness-thick {
    stroke-width: 3.5px
  }
  & .edge-pattern-solid {
    stroke-dasharray: 0;
  }
  & .edge-thickness-invisible {
    stroke-width: 0;
    fill: none;
  }
  & .edge-pattern-dashed{
    stroke-dasharray: 3;
  }
  .edge-pattern-dotted {
    stroke-dasharray: 2;
  }

  & .marker {
    fill: ${n.lineColor};
    stroke: ${n.lineColor};
  }
  & .marker.cross {
    stroke: ${n.lineColor};
  }

  & svg {
    font-family: ${n.fontFamily};
    font-size: ${n.fontSize};
  }
   & p {
    margin: 0
   }

  ${r}

  ${t}
`},"getStyles"),i3e=ie((e,t)=>{t!==void 0&&(j2[e]=t)},"addStylesForDiagram"),a3e=s3e,PX={};SIe(PX,{clear:()=>o3e,getAccDescription:()=>d3e,getAccTitle:()=>c3e,getDiagramTitle:()=>h3e,setAccDescription:()=>u3e,setAccTitle:()=>l3e,setDiagramTitle:()=>f3e});var CD="",kD="",ED="",TD=ie(e=>Tm(e,Mo()),"sanitizeText"),o3e=ie(()=>{CD="",ED="",kD=""},"clear"),l3e=ie(e=>{CD=TD(e).replace(/^\s+/g,"")},"setAccTitle"),c3e=ie(()=>CD,"getAccTitle"),u3e=ie(e=>{ED=TD(e).replace(/\n\s+/g,`
`)},"setAccDescription"),d3e=ie(()=>ED,"getAccDescription"),f3e=ie(e=>{kD=TD(e)},"setDiagramTitle"),h3e=ie(()=>kD,"getDiagramTitle"),h7=zt,p3e=wD,os=Mo,Kut=TX,Yut=vy,AD=ie(e=>Tm(e,os()),"sanitizeText"),m3e=r3e,g3e=ie(()=>PX,"getCommonDb"),ik={},ak=ie((e,t,n)=>{var r;ik[e]&&h7.warn(`Diagram with id ${e} already registered. Overwriting.`),ik[e]=t,n&&wX(e,n),i3e(e,t.styles),(r=t.injectUtils)==null||r.call(t,h7,p3e,os,AD,m3e,g3e(),()=>{})},"registerDiagram"),Bj=ie(e=>{if(e in ik)return ik[e];throw new y3e(e)},"getDiagram"),W0,y3e=(W0=class extends Error{constructor(t){super(`Diagram ${t} not found.`)}},ie(W0,"DiagramNotFoundError"),W0);function RD(e){return typeof e>"u"||e===null}ie(RD,"isNothing");function OX(e){return typeof e=="object"&&e!==null}ie(OX,"isObject");function DX(e){return Array.isArray(e)?e:RD(e)?[]:[e]}ie(DX,"toArray");function FX(e,t){var n,r,s,i;if(t)for(i=Object.keys(t),n=0,r=i.length;n<r;n+=1)s=i[n],e[s]=t[s];return e}ie(FX,"extend");function LX(e,t){var n="",r;for(r=0;r<t;r+=1)n+=e;return n}ie(LX,"repeat");function BX(e){return e===0&&Number.NEGATIVE_INFINITY===1/e}ie(BX,"isNegativeZero");var b3e=RD,v3e=OX,x3e=DX,w3e=LX,_3e=BX,S3e=FX,$i={isNothing:b3e,isObject:v3e,toArray:x3e,repeat:w3e,isNegativeZero:_3e,extend:S3e};function ND(e,t){var n="",r=e.reason||"(unknown reason)";return e.mark?(e.mark.name&&(n+='in "'+e.mark.name+'" '),n+="("+(e.mark.line+1)+":"+(e.mark.column+1)+")",!t&&e.mark.snippet&&(n+=`

`+e.mark.snippet),r+" "+n):r}ie(ND,"formatError");function _y(e,t){Error.call(this),this.name="YAMLException",this.reason=e,this.mark=t,this.message=ND(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack||""}ie(_y,"YAMLException$1");_y.prototype=Object.create(Error.prototype);_y.prototype.constructor=_y;_y.prototype.toString=ie(function(t){return this.name+": "+ND(this,t)},"toString");var Co=_y;function P2(e,t,n,r,s){var i="",a="",o=Math.floor(s/2)-1;return r-t>o&&(i=" ... ",t=r-o+i.length),n-r>o&&(a=" ...",n=r+o-a.length),{str:i+e.slice(t,n).replace(/\t/g,"→")+a,pos:r-t+i.length}}ie(P2,"getLine");function O2(e,t){return $i.repeat(" ",t-e.length)+e}ie(O2,"padStart");function $X(e,t){if(t=Object.create(t||null),!e.buffer)return null;t.maxLength||(t.maxLength=79),typeof t.indent!="number"&&(t.indent=1),typeof t.linesBefore!="number"&&(t.linesBefore=3),typeof t.linesAfter!="number"&&(t.linesAfter=2);for(var n=/\r?\n|\r|\0/g,r=[0],s=[],i,a=-1;i=n.exec(e.buffer);)s.push(i.index),r.push(i.index+i[0].length),e.position<=i.index&&a<0&&(a=r.length-2);a<0&&(a=r.length-1);var o="",l,c,u=Math.min(e.line+t.linesAfter,s.length).toString().length,d=t.maxLength-(t.indent+u+3);for(l=1;l<=t.linesBefore&&!(a-l<0);l++)c=P2(e.buffer,r[a-l],s[a-l],e.position-(r[a]-r[a-l]),d),o=$i.repeat(" ",t.indent)+O2((e.line-l+1).toString(),u)+" | "+c.str+`
`+o;for(c=P2(e.buffer,r[a],s[a],e.position,d),o+=$i.repeat(" ",t.indent)+O2((e.line+1).toString(),u)+" | "+c.str+`
`,o+=$i.repeat("-",t.indent+u+3+c.pos)+`^
`,l=1;l<=t.linesAfter&&!(a+l>=s.length);l++)c=P2(e.buffer,r[a+l],s[a+l],e.position-(r[a]-r[a+l]),d),o+=$i.repeat(" ",t.indent)+O2((e.line+l+1).toString(),u)+" | "+c.str+`
`;return o.replace(/\n$/,"")}ie($X,"makeSnippet");var C3e=$X,k3e=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],E3e=["scalar","sequence","mapping"];function zX(e){var t={};return e!==null&&Object.keys(e).forEach(function(n){e[n].forEach(function(r){t[String(r)]=n})}),t}ie(zX,"compileStyleAliases");function UX(e,t){if(t=t||{},Object.keys(t).forEach(function(n){if(k3e.indexOf(n)===-1)throw new Co('Unknown option "'+n+'" is met in definition of "'+e+'" YAML type.')}),this.options=t,this.tag=e,this.kind=t.kind||null,this.resolve=t.resolve||function(){return!0},this.construct=t.construct||function(n){return n},this.instanceOf=t.instanceOf||null,this.predicate=t.predicate||null,this.represent=t.represent||null,this.representName=t.representName||null,this.defaultStyle=t.defaultStyle||null,this.multi=t.multi||!1,this.styleAliases=zX(t.styleAliases||null),E3e.indexOf(this.kind)===-1)throw new Co('Unknown kind "'+this.kind+'" is specified for "'+e+'" YAML type.')}ie(UX,"Type$1");var Da=UX;function $j(e,t){var n=[];return e[t].forEach(function(r){var s=n.length;n.forEach(function(i,a){i.tag===r.tag&&i.kind===r.kind&&i.multi===r.multi&&(s=a)}),n[s]=r}),n}ie($j,"compileList");function qX(){var e={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}},t,n;function r(s){s.multi?(e.multi[s.kind].push(s),e.multi.fallback.push(s)):e[s.kind][s.tag]=e.fallback[s.tag]=s}for(ie(r,"collectType"),t=0,n=arguments.length;t<n;t+=1)arguments[t].forEach(r);return e}ie(qX,"compileMap");function ok(e){return this.extend(e)}ie(ok,"Schema$1");ok.prototype.extend=ie(function(t){var n=[],r=[];if(t instanceof Da)r.push(t);else if(Array.isArray(t))r=r.concat(t);else if(t&&(Array.isArray(t.implicit)||Array.isArray(t.explicit)))t.implicit&&(n=n.concat(t.implicit)),t.explicit&&(r=r.concat(t.explicit));else throw new Co("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");n.forEach(function(i){if(!(i instanceof Da))throw new Co("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(i.loadKind&&i.loadKind!=="scalar")throw new Co("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(i.multi)throw new Co("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")}),r.forEach(function(i){if(!(i instanceof Da))throw new Co("Specified list of YAML types (or a single Type object) contains a non-Type object.")});var s=Object.create(ok.prototype);return s.implicit=(this.implicit||[]).concat(n),s.explicit=(this.explicit||[]).concat(r),s.compiledImplicit=$j(s,"implicit"),s.compiledExplicit=$j(s,"explicit"),s.compiledTypeMap=qX(s.compiledImplicit,s.compiledExplicit),s},"extend");var T3e=ok,A3e=new Da("tag:yaml.org,2002:str",{kind:"scalar",construct:ie(function(e){return e!==null?e:""},"construct")}),R3e=new Da("tag:yaml.org,2002:seq",{kind:"sequence",construct:ie(function(e){return e!==null?e:[]},"construct")}),N3e=new Da("tag:yaml.org,2002:map",{kind:"mapping",construct:ie(function(e){return e!==null?e:{}},"construct")}),M3e=new T3e({explicit:[A3e,R3e,N3e]});function VX(e){if(e===null)return!0;var t=e.length;return t===1&&e==="~"||t===4&&(e==="null"||e==="Null"||e==="NULL")}ie(VX,"resolveYamlNull");function WX(){return null}ie(WX,"constructYamlNull");function HX(e){return e===null}ie(HX,"isNull");var I3e=new Da("tag:yaml.org,2002:null",{kind:"scalar",resolve:VX,construct:WX,predicate:HX,represent:{canonical:ie(function(){return"~"},"canonical"),lowercase:ie(function(){return"null"},"lowercase"),uppercase:ie(function(){return"NULL"},"uppercase"),camelcase:ie(function(){return"Null"},"camelcase"),empty:ie(function(){return""},"empty")},defaultStyle:"lowercase"});function GX(e){if(e===null)return!1;var t=e.length;return t===4&&(e==="true"||e==="True"||e==="TRUE")||t===5&&(e==="false"||e==="False"||e==="FALSE")}ie(GX,"resolveYamlBoolean");function KX(e){return e==="true"||e==="True"||e==="TRUE"}ie(KX,"constructYamlBoolean");function YX(e){return Object.prototype.toString.call(e)==="[object Boolean]"}ie(YX,"isBoolean");var j3e=new Da("tag:yaml.org,2002:bool",{kind:"scalar",resolve:GX,construct:KX,predicate:YX,represent:{lowercase:ie(function(e){return e?"true":"false"},"lowercase"),uppercase:ie(function(e){return e?"TRUE":"FALSE"},"uppercase"),camelcase:ie(function(e){return e?"True":"False"},"camelcase")},defaultStyle:"lowercase"});function ZX(e){return 48<=e&&e<=57||65<=e&&e<=70||97<=e&&e<=102}ie(ZX,"isHexCode");function XX(e){return 48<=e&&e<=55}ie(XX,"isOctCode");function JX(e){return 48<=e&&e<=57}ie(JX,"isDecCode");function QX(e){if(e===null)return!1;var t=e.length,n=0,r=!1,s;if(!t)return!1;if(s=e[n],(s==="-"||s==="+")&&(s=e[++n]),s==="0"){if(n+1===t)return!0;if(s=e[++n],s==="b"){for(n++;n<t;n++)if(s=e[n],s!=="_"){if(s!=="0"&&s!=="1")return!1;r=!0}return r&&s!=="_"}if(s==="x"){for(n++;n<t;n++)if(s=e[n],s!=="_"){if(!ZX(e.charCodeAt(n)))return!1;r=!0}return r&&s!=="_"}if(s==="o"){for(n++;n<t;n++)if(s=e[n],s!=="_"){if(!XX(e.charCodeAt(n)))return!1;r=!0}return r&&s!=="_"}}if(s==="_")return!1;for(;n<t;n++)if(s=e[n],s!=="_"){if(!JX(e.charCodeAt(n)))return!1;r=!0}return!(!r||s==="_")}ie(QX,"resolveYamlInteger");function eJ(e){var t=e,n=1,r;if(t.indexOf("_")!==-1&&(t=t.replace(/_/g,"")),r=t[0],(r==="-"||r==="+")&&(r==="-"&&(n=-1),t=t.slice(1),r=t[0]),t==="0")return 0;if(r==="0"){if(t[1]==="b")return n*parseInt(t.slice(2),2);if(t[1]==="x")return n*parseInt(t.slice(2),16);if(t[1]==="o")return n*parseInt(t.slice(2),8)}return n*parseInt(t,10)}ie(eJ,"constructYamlInteger");function tJ(e){return Object.prototype.toString.call(e)==="[object Number]"&&e%1===0&&!$i.isNegativeZero(e)}ie(tJ,"isInteger");var P3e=new Da("tag:yaml.org,2002:int",{kind:"scalar",resolve:QX,construct:eJ,predicate:tJ,represent:{binary:ie(function(e){return e>=0?"0b"+e.toString(2):"-0b"+e.toString(2).slice(1)},"binary"),octal:ie(function(e){return e>=0?"0o"+e.toString(8):"-0o"+e.toString(8).slice(1)},"octal"),decimal:ie(function(e){return e.toString(10)},"decimal"),hexadecimal:ie(function(e){return e>=0?"0x"+e.toString(16).toUpperCase():"-0x"+e.toString(16).toUpperCase().slice(1)},"hexadecimal")},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),O3e=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$");function nJ(e){return!(e===null||!O3e.test(e)||e[e.length-1]==="_")}ie(nJ,"resolveYamlFloat");function rJ(e){var t,n;return t=e.replace(/_/g,"").toLowerCase(),n=t[0]==="-"?-1:1,"+-".indexOf(t[0])>=0&&(t=t.slice(1)),t===".inf"?n===1?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:t===".nan"?NaN:n*parseFloat(t,10)}ie(rJ,"constructYamlFloat");var D3e=/^[-+]?[0-9]+e/;function sJ(e,t){var n;if(isNaN(e))switch(t){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===e)switch(t){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===e)switch(t){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if($i.isNegativeZero(e))return"-0.0";return n=e.toString(10),D3e.test(n)?n.replace("e",".e"):n}ie(sJ,"representYamlFloat");function iJ(e){return Object.prototype.toString.call(e)==="[object Number]"&&(e%1!==0||$i.isNegativeZero(e))}ie(iJ,"isFloat");var F3e=new Da("tag:yaml.org,2002:float",{kind:"scalar",resolve:nJ,construct:rJ,predicate:iJ,represent:sJ,defaultStyle:"lowercase"}),aJ=M3e.extend({implicit:[I3e,j3e,P3e,F3e]}),L3e=aJ,oJ=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),lJ=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$");function cJ(e){return e===null?!1:oJ.exec(e)!==null||lJ.exec(e)!==null}ie(cJ,"resolveYamlTimestamp");function uJ(e){var t,n,r,s,i,a,o,l=0,c=null,u,d,h;if(t=oJ.exec(e),t===null&&(t=lJ.exec(e)),t===null)throw new Error("Date resolve error");if(n=+t[1],r=+t[2]-1,s=+t[3],!t[4])return new Date(Date.UTC(n,r,s));if(i=+t[4],a=+t[5],o=+t[6],t[7]){for(l=t[7].slice(0,3);l.length<3;)l+="0";l=+l}return t[9]&&(u=+t[10],d=+(t[11]||0),c=(u*60+d)*6e4,t[9]==="-"&&(c=-c)),h=new Date(Date.UTC(n,r,s,i,a,o,l)),c&&h.setTime(h.getTime()-c),h}ie(uJ,"constructYamlTimestamp");function dJ(e){return e.toISOString()}ie(dJ,"representYamlTimestamp");var B3e=new Da("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:cJ,construct:uJ,instanceOf:Date,represent:dJ});function fJ(e){return e==="<<"||e===null}ie(fJ,"resolveYamlMerge");var $3e=new Da("tag:yaml.org,2002:merge",{kind:"scalar",resolve:fJ}),MD=`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=
\r`;function hJ(e){if(e===null)return!1;var t,n,r=0,s=e.length,i=MD;for(n=0;n<s;n++)if(t=i.indexOf(e.charAt(n)),!(t>64)){if(t<0)return!1;r+=6}return r%8===0}ie(hJ,"resolveYamlBinary");function pJ(e){var t,n,r=e.replace(/[\r\n=]/g,""),s=r.length,i=MD,a=0,o=[];for(t=0;t<s;t++)t%4===0&&t&&(o.push(a>>16&255),o.push(a>>8&255),o.push(a&255)),a=a<<6|i.indexOf(r.charAt(t));return n=s%4*6,n===0?(o.push(a>>16&255),o.push(a>>8&255),o.push(a&255)):n===18?(o.push(a>>10&255),o.push(a>>2&255)):n===12&&o.push(a>>4&255),new Uint8Array(o)}ie(pJ,"constructYamlBinary");function mJ(e){var t="",n=0,r,s,i=e.length,a=MD;for(r=0;r<i;r++)r%3===0&&r&&(t+=a[n>>18&63],t+=a[n>>12&63],t+=a[n>>6&63],t+=a[n&63]),n=(n<<8)+e[r];return s=i%3,s===0?(t+=a[n>>18&63],t+=a[n>>12&63],t+=a[n>>6&63],t+=a[n&63]):s===2?(t+=a[n>>10&63],t+=a[n>>4&63],t+=a[n<<2&63],t+=a[64]):s===1&&(t+=a[n>>2&63],t+=a[n<<4&63],t+=a[64],t+=a[64]),t}ie(mJ,"representYamlBinary");function gJ(e){return Object.prototype.toString.call(e)==="[object Uint8Array]"}ie(gJ,"isBinary");var z3e=new Da("tag:yaml.org,2002:binary",{kind:"scalar",resolve:hJ,construct:pJ,predicate:gJ,represent:mJ}),U3e=Object.prototype.hasOwnProperty,q3e=Object.prototype.toString;function yJ(e){if(e===null)return!0;var t=[],n,r,s,i,a,o=e;for(n=0,r=o.length;n<r;n+=1){if(s=o[n],a=!1,q3e.call(s)!=="[object Object]")return!1;for(i in s)if(U3e.call(s,i))if(!a)a=!0;else return!1;if(!a)return!1;if(t.indexOf(i)===-1)t.push(i);else return!1}return!0}ie(yJ,"resolveYamlOmap");function bJ(e){return e!==null?e:[]}ie(bJ,"constructYamlOmap");var V3e=new Da("tag:yaml.org,2002:omap",{kind:"sequence",resolve:yJ,construct:bJ}),W3e=Object.prototype.toString;function vJ(e){if(e===null)return!0;var t,n,r,s,i,a=e;for(i=new Array(a.length),t=0,n=a.length;t<n;t+=1){if(r=a[t],W3e.call(r)!=="[object Object]"||(s=Object.keys(r),s.length!==1))return!1;i[t]=[s[0],r[s[0]]]}return!0}ie(vJ,"resolveYamlPairs");function xJ(e){if(e===null)return[];var t,n,r,s,i,a=e;for(i=new Array(a.length),t=0,n=a.length;t<n;t+=1)r=a[t],s=Object.keys(r),i[t]=[s[0],r[s[0]]];return i}ie(xJ,"constructYamlPairs");var H3e=new Da("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:vJ,construct:xJ}),G3e=Object.prototype.hasOwnProperty;function wJ(e){if(e===null)return!0;var t,n=e;for(t in n)if(G3e.call(n,t)&&n[t]!==null)return!1;return!0}ie(wJ,"resolveYamlSet");function _J(e){return e!==null?e:{}}ie(_J,"constructYamlSet");var K3e=new Da("tag:yaml.org,2002:set",{kind:"mapping",resolve:wJ,construct:_J}),SJ=L3e.extend({implicit:[B3e,$3e],explicit:[z3e,V3e,H3e,K3e]}),Rh=Object.prototype.hasOwnProperty,lk=1,CJ=2,kJ=3,ck=4,wI=1,Y3e=2,p7=3,Z3e=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,X3e=/[\x85\u2028\u2029]/,J3e=/[,\[\]\{\}]/,EJ=/^(?:!|!!|![a-z\-]+!)$/i,TJ=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function zj(e){return Object.prototype.toString.call(e)}ie(zj,"_class");function Tc(e){return e===10||e===13}ie(Tc,"is_EOL");function fh(e){return e===9||e===32}ie(fh,"is_WHITE_SPACE");function Qa(e){return e===9||e===32||e===10||e===13}ie(Qa,"is_WS_OR_EOL");function tm(e){return e===44||e===91||e===93||e===123||e===125}ie(tm,"is_FLOW_INDICATOR");function AJ(e){var t;return 48<=e&&e<=57?e-48:(t=e|32,97<=t&&t<=102?t-97+10:-1)}ie(AJ,"fromHexCode");function RJ(e){return e===120?2:e===117?4:e===85?8:0}ie(RJ,"escapedHexLen");function NJ(e){return 48<=e&&e<=57?e-48:-1}ie(NJ,"fromDecimalCode");function Uj(e){return e===48?"\0":e===97?"\x07":e===98?"\b":e===116||e===9?"	":e===110?`
`:e===118?"\v":e===102?"\f":e===114?"\r":e===101?"\x1B":e===32?" ":e===34?'"':e===47?"/":e===92?"\\":e===78?"":e===95?" ":e===76?"\u2028":e===80?"\u2029":""}ie(Uj,"simpleEscapeSequence");function MJ(e){return e<=65535?String.fromCharCode(e):String.fromCharCode((e-65536>>10)+55296,(e-65536&1023)+56320)}ie(MJ,"charFromCodepoint");var IJ=new Array(256),jJ=new Array(256);for(zp=0;zp<256;zp++)IJ[zp]=Uj(zp)?1:0,jJ[zp]=Uj(zp);var zp;function PJ(e,t){this.input=e,this.filename=t.filename||null,this.schema=t.schema||SJ,this.onWarning=t.onWarning||null,this.legacy=t.legacy||!1,this.json=t.json||!1,this.listener=t.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=e.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}ie(PJ,"State$1");function ID(e,t){var n={name:e.filename,buffer:e.input.slice(0,-1),position:e.position,line:e.line,column:e.position-e.lineStart};return n.snippet=C3e(n),new Co(t,n)}ie(ID,"generateError");function Pn(e,t){throw ID(e,t)}ie(Pn,"throwError");function ww(e,t){e.onWarning&&e.onWarning.call(null,ID(e,t))}ie(ww,"throwWarning");var m7={YAML:ie(function(t,n,r){var s,i,a;t.version!==null&&Pn(t,"duplication of %YAML directive"),r.length!==1&&Pn(t,"YAML directive accepts exactly one argument"),s=/^([0-9]+)\.([0-9]+)$/.exec(r[0]),s===null&&Pn(t,"ill-formed argument of the YAML directive"),i=parseInt(s[1],10),a=parseInt(s[2],10),i!==1&&Pn(t,"unacceptable YAML version of the document"),t.version=r[0],t.checkLineBreaks=a<2,a!==1&&a!==2&&ww(t,"unsupported YAML version of the document")},"handleYamlDirective"),TAG:ie(function(t,n,r){var s,i;r.length!==2&&Pn(t,"TAG directive accepts exactly two arguments"),s=r[0],i=r[1],EJ.test(s)||Pn(t,"ill-formed tag handle (first argument) of the TAG directive"),Rh.call(t.tagMap,s)&&Pn(t,'there is a previously declared suffix for "'+s+'" tag handle'),TJ.test(i)||Pn(t,"ill-formed tag prefix (second argument) of the TAG directive");try{i=decodeURIComponent(i)}catch{Pn(t,"tag prefix is malformed: "+i)}t.tagMap[s]=i},"handleTagDirective")};function Ld(e,t,n,r){var s,i,a,o;if(t<n){if(o=e.input.slice(t,n),r)for(s=0,i=o.length;s<i;s+=1)a=o.charCodeAt(s),a===9||32<=a&&a<=1114111||Pn(e,"expected valid JSON character");else Z3e.test(o)&&Pn(e,"the stream contains non-printable characters");e.result+=o}}ie(Ld,"captureSegment");function qj(e,t,n,r){var s,i,a,o;for($i.isObject(n)||Pn(e,"cannot merge mappings; the provided source object is unacceptable"),s=Object.keys(n),a=0,o=s.length;a<o;a+=1)i=s[a],Rh.call(t,i)||(t[i]=n[i],r[i]=!0)}ie(qj,"mergeMappings");function nm(e,t,n,r,s,i,a,o,l){var c,u;if(Array.isArray(s))for(s=Array.prototype.slice.call(s),c=0,u=s.length;c<u;c+=1)Array.isArray(s[c])&&Pn(e,"nested arrays are not supported inside keys"),typeof s=="object"&&zj(s[c])==="[object Object]"&&(s[c]="[object Object]");if(typeof s=="object"&&zj(s)==="[object Object]"&&(s="[object Object]"),s=String(s),t===null&&(t={}),r==="tag:yaml.org,2002:merge")if(Array.isArray(i))for(c=0,u=i.length;c<u;c+=1)qj(e,t,i[c],n);else qj(e,t,i,n);else!e.json&&!Rh.call(n,s)&&Rh.call(t,s)&&(e.line=a||e.line,e.lineStart=o||e.lineStart,e.position=l||e.position,Pn(e,"duplicated mapping key")),s==="__proto__"?Object.defineProperty(t,s,{configurable:!0,enumerable:!0,writable:!0,value:i}):t[s]=i,delete n[s];return t}ie(nm,"storeMappingPair");function pT(e){var t;t=e.input.charCodeAt(e.position),t===10?e.position++:t===13?(e.position++,e.input.charCodeAt(e.position)===10&&e.position++):Pn(e,"a line break is expected"),e.line+=1,e.lineStart=e.position,e.firstTabInLine=-1}ie(pT,"readLineBreak");function mi(e,t,n){for(var r=0,s=e.input.charCodeAt(e.position);s!==0;){for(;fh(s);)s===9&&e.firstTabInLine===-1&&(e.firstTabInLine=e.position),s=e.input.charCodeAt(++e.position);if(t&&s===35)do s=e.input.charCodeAt(++e.position);while(s!==10&&s!==13&&s!==0);if(Tc(s))for(pT(e),s=e.input.charCodeAt(e.position),r++,e.lineIndent=0;s===32;)e.lineIndent++,s=e.input.charCodeAt(++e.position);else break}return n!==-1&&r!==0&&e.lineIndent<n&&ww(e,"deficient indentation"),r}ie(mi,"skipSeparationSpace");function V1(e){var t=e.position,n;return n=e.input.charCodeAt(t),!!((n===45||n===46)&&n===e.input.charCodeAt(t+1)&&n===e.input.charCodeAt(t+2)&&(t+=3,n=e.input.charCodeAt(t),n===0||Qa(n)))}ie(V1,"testDocumentSeparator");function mT(e,t){t===1?e.result+=" ":t>1&&(e.result+=$i.repeat(`
`,t-1))}ie(mT,"writeFoldedLines");function OJ(e,t,n){var r,s,i,a,o,l,c,u,d=e.kind,h=e.result,m;if(m=e.input.charCodeAt(e.position),Qa(m)||tm(m)||m===35||m===38||m===42||m===33||m===124||m===62||m===39||m===34||m===37||m===64||m===96||(m===63||m===45)&&(s=e.input.charCodeAt(e.position+1),Qa(s)||n&&tm(s)))return!1;for(e.kind="scalar",e.result="",i=a=e.position,o=!1;m!==0;){if(m===58){if(s=e.input.charCodeAt(e.position+1),Qa(s)||n&&tm(s))break}else if(m===35){if(r=e.input.charCodeAt(e.position-1),Qa(r))break}else{if(e.position===e.lineStart&&V1(e)||n&&tm(m))break;if(Tc(m))if(l=e.line,c=e.lineStart,u=e.lineIndent,mi(e,!1,-1),e.lineIndent>=t){o=!0,m=e.input.charCodeAt(e.position);continue}else{e.position=a,e.line=l,e.lineStart=c,e.lineIndent=u;break}}o&&(Ld(e,i,a,!1),mT(e,e.line-l),i=a=e.position,o=!1),fh(m)||(a=e.position+1),m=e.input.charCodeAt(++e.position)}return Ld(e,i,a,!1),e.result?!0:(e.kind=d,e.result=h,!1)}ie(OJ,"readPlainScalar");function DJ(e,t){var n,r,s;if(n=e.input.charCodeAt(e.position),n!==39)return!1;for(e.kind="scalar",e.result="",e.position++,r=s=e.position;(n=e.input.charCodeAt(e.position))!==0;)if(n===39)if(Ld(e,r,e.position,!0),n=e.input.charCodeAt(++e.position),n===39)r=e.position,e.position++,s=e.position;else return!0;else Tc(n)?(Ld(e,r,s,!0),mT(e,mi(e,!1,t)),r=s=e.position):e.position===e.lineStart&&V1(e)?Pn(e,"unexpected end of the document within a single quoted scalar"):(e.position++,s=e.position);Pn(e,"unexpected end of the stream within a single quoted scalar")}ie(DJ,"readSingleQuotedScalar");function FJ(e,t){var n,r,s,i,a,o;if(o=e.input.charCodeAt(e.position),o!==34)return!1;for(e.kind="scalar",e.result="",e.position++,n=r=e.position;(o=e.input.charCodeAt(e.position))!==0;){if(o===34)return Ld(e,n,e.position,!0),e.position++,!0;if(o===92){if(Ld(e,n,e.position,!0),o=e.input.charCodeAt(++e.position),Tc(o))mi(e,!1,t);else if(o<256&&IJ[o])e.result+=jJ[o],e.position++;else if((a=RJ(o))>0){for(s=a,i=0;s>0;s--)o=e.input.charCodeAt(++e.position),(a=AJ(o))>=0?i=(i<<4)+a:Pn(e,"expected hexadecimal character");e.result+=MJ(i),e.position++}else Pn(e,"unknown escape sequence");n=r=e.position}else Tc(o)?(Ld(e,n,r,!0),mT(e,mi(e,!1,t)),n=r=e.position):e.position===e.lineStart&&V1(e)?Pn(e,"unexpected end of the document within a double quoted scalar"):(e.position++,r=e.position)}Pn(e,"unexpected end of the stream within a double quoted scalar")}ie(FJ,"readDoubleQuotedScalar");function LJ(e,t){var n=!0,r,s,i,a=e.tag,o,l=e.anchor,c,u,d,h,m,y=Object.create(null),b,v,x,w;if(w=e.input.charCodeAt(e.position),w===91)u=93,m=!1,o=[];else if(w===123)u=125,m=!0,o={};else return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=o),w=e.input.charCodeAt(++e.position);w!==0;){if(mi(e,!0,t),w=e.input.charCodeAt(e.position),w===u)return e.position++,e.tag=a,e.anchor=l,e.kind=m?"mapping":"sequence",e.result=o,!0;n?w===44&&Pn(e,"expected the node content, but found ','"):Pn(e,"missed comma between flow collection entries"),v=b=x=null,d=h=!1,w===63&&(c=e.input.charCodeAt(e.position+1),Qa(c)&&(d=h=!0,e.position++,mi(e,!0,t))),r=e.line,s=e.lineStart,i=e.position,Am(e,t,lk,!1,!0),v=e.tag,b=e.result,mi(e,!0,t),w=e.input.charCodeAt(e.position),(h||e.line===r)&&w===58&&(d=!0,w=e.input.charCodeAt(++e.position),mi(e,!0,t),Am(e,t,lk,!1,!0),x=e.result),m?nm(e,o,y,v,b,x,r,s,i):d?o.push(nm(e,null,y,v,b,x,r,s,i)):o.push(b),mi(e,!0,t),w=e.input.charCodeAt(e.position),w===44?(n=!0,w=e.input.charCodeAt(++e.position)):n=!1}Pn(e,"unexpected end of the stream within a flow collection")}ie(LJ,"readFlowCollection");function BJ(e,t){var n,r,s=wI,i=!1,a=!1,o=t,l=0,c=!1,u,d;if(d=e.input.charCodeAt(e.position),d===124)r=!1;else if(d===62)r=!0;else return!1;for(e.kind="scalar",e.result="";d!==0;)if(d=e.input.charCodeAt(++e.position),d===43||d===45)wI===s?s=d===43?p7:Y3e:Pn(e,"repeat of a chomping mode identifier");else if((u=NJ(d))>=0)u===0?Pn(e,"bad explicit indentation width of a block scalar; it cannot be less than one"):a?Pn(e,"repeat of an indentation width identifier"):(o=t+u-1,a=!0);else break;if(fh(d)){do d=e.input.charCodeAt(++e.position);while(fh(d));if(d===35)do d=e.input.charCodeAt(++e.position);while(!Tc(d)&&d!==0)}for(;d!==0;){for(pT(e),e.lineIndent=0,d=e.input.charCodeAt(e.position);(!a||e.lineIndent<o)&&d===32;)e.lineIndent++,d=e.input.charCodeAt(++e.position);if(!a&&e.lineIndent>o&&(o=e.lineIndent),Tc(d)){l++;continue}if(e.lineIndent<o){s===p7?e.result+=$i.repeat(`
`,i?1+l:l):s===wI&&i&&(e.result+=`
`);break}for(r?fh(d)?(c=!0,e.result+=$i.repeat(`
`,i?1+l:l)):c?(c=!1,e.result+=$i.repeat(`
`,l+1)):l===0?i&&(e.result+=" "):e.result+=$i.repeat(`
`,l):e.result+=$i.repeat(`
`,i?1+l:l),i=!0,a=!0,l=0,n=e.position;!Tc(d)&&d!==0;)d=e.input.charCodeAt(++e.position);Ld(e,n,e.position,!1)}return!0}ie(BJ,"readBlockScalar");function Vj(e,t){var n,r=e.tag,s=e.anchor,i=[],a,o=!1,l;if(e.firstTabInLine!==-1)return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=i),l=e.input.charCodeAt(e.position);l!==0&&(e.firstTabInLine!==-1&&(e.position=e.firstTabInLine,Pn(e,"tab characters must not be used in indentation")),!(l!==45||(a=e.input.charCodeAt(e.position+1),!Qa(a))));){if(o=!0,e.position++,mi(e,!0,-1)&&e.lineIndent<=t){i.push(null),l=e.input.charCodeAt(e.position);continue}if(n=e.line,Am(e,t,kJ,!1,!0),i.push(e.result),mi(e,!0,-1),l=e.input.charCodeAt(e.position),(e.line===n||e.lineIndent>t)&&l!==0)Pn(e,"bad indentation of a sequence entry");else if(e.lineIndent<t)break}return o?(e.tag=r,e.anchor=s,e.kind="sequence",e.result=i,!0):!1}ie(Vj,"readBlockSequence");function $J(e,t,n){var r,s,i,a,o,l,c=e.tag,u=e.anchor,d={},h=Object.create(null),m=null,y=null,b=null,v=!1,x=!1,w;if(e.firstTabInLine!==-1)return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=d),w=e.input.charCodeAt(e.position);w!==0;){if(!v&&e.firstTabInLine!==-1&&(e.position=e.firstTabInLine,Pn(e,"tab characters must not be used in indentation")),r=e.input.charCodeAt(e.position+1),i=e.line,(w===63||w===58)&&Qa(r))w===63?(v&&(nm(e,d,h,m,y,null,a,o,l),m=y=b=null),x=!0,v=!0,s=!0):v?(v=!1,s=!0):Pn(e,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),e.position+=1,w=r;else{if(a=e.line,o=e.lineStart,l=e.position,!Am(e,n,CJ,!1,!0))break;if(e.line===i){for(w=e.input.charCodeAt(e.position);fh(w);)w=e.input.charCodeAt(++e.position);if(w===58)w=e.input.charCodeAt(++e.position),Qa(w)||Pn(e,"a whitespace character is expected after the key-value separator within a block mapping"),v&&(nm(e,d,h,m,y,null,a,o,l),m=y=b=null),x=!0,v=!1,s=!1,m=e.tag,y=e.result;else if(x)Pn(e,"can not read an implicit mapping pair; a colon is missed");else return e.tag=c,e.anchor=u,!0}else if(x)Pn(e,"can not read a block mapping entry; a multiline key may not be an implicit key");else return e.tag=c,e.anchor=u,!0}if((e.line===i||e.lineIndent>t)&&(v&&(a=e.line,o=e.lineStart,l=e.position),Am(e,t,ck,!0,s)&&(v?y=e.result:b=e.result),v||(nm(e,d,h,m,y,b,a,o,l),m=y=b=null),mi(e,!0,-1),w=e.input.charCodeAt(e.position)),(e.line===i||e.lineIndent>t)&&w!==0)Pn(e,"bad indentation of a mapping entry");else if(e.lineIndent<t)break}return v&&nm(e,d,h,m,y,null,a,o,l),x&&(e.tag=c,e.anchor=u,e.kind="mapping",e.result=d),x}ie($J,"readBlockMapping");function zJ(e){var t,n=!1,r=!1,s,i,a;if(a=e.input.charCodeAt(e.position),a!==33)return!1;if(e.tag!==null&&Pn(e,"duplication of a tag property"),a=e.input.charCodeAt(++e.position),a===60?(n=!0,a=e.input.charCodeAt(++e.position)):a===33?(r=!0,s="!!",a=e.input.charCodeAt(++e.position)):s="!",t=e.position,n){do a=e.input.charCodeAt(++e.position);while(a!==0&&a!==62);e.position<e.length?(i=e.input.slice(t,e.position),a=e.input.charCodeAt(++e.position)):Pn(e,"unexpected end of the stream within a verbatim tag")}else{for(;a!==0&&!Qa(a);)a===33&&(r?Pn(e,"tag suffix cannot contain exclamation marks"):(s=e.input.slice(t-1,e.position+1),EJ.test(s)||Pn(e,"named tag handle cannot contain such characters"),r=!0,t=e.position+1)),a=e.input.charCodeAt(++e.position);i=e.input.slice(t,e.position),J3e.test(i)&&Pn(e,"tag suffix cannot contain flow indicator characters")}i&&!TJ.test(i)&&Pn(e,"tag name cannot contain such characters: "+i);try{i=decodeURIComponent(i)}catch{Pn(e,"tag name is malformed: "+i)}return n?e.tag=i:Rh.call(e.tagMap,s)?e.tag=e.tagMap[s]+i:s==="!"?e.tag="!"+i:s==="!!"?e.tag="tag:yaml.org,2002:"+i:Pn(e,'undeclared tag handle "'+s+'"'),!0}ie(zJ,"readTagProperty");function UJ(e){var t,n;if(n=e.input.charCodeAt(e.position),n!==38)return!1;for(e.anchor!==null&&Pn(e,"duplication of an anchor property"),n=e.input.charCodeAt(++e.position),t=e.position;n!==0&&!Qa(n)&&!tm(n);)n=e.input.charCodeAt(++e.position);return e.position===t&&Pn(e,"name of an anchor node must contain at least one character"),e.anchor=e.input.slice(t,e.position),!0}ie(UJ,"readAnchorProperty");function qJ(e){var t,n,r;if(r=e.input.charCodeAt(e.position),r!==42)return!1;for(r=e.input.charCodeAt(++e.position),t=e.position;r!==0&&!Qa(r)&&!tm(r);)r=e.input.charCodeAt(++e.position);return e.position===t&&Pn(e,"name of an alias node must contain at least one character"),n=e.input.slice(t,e.position),Rh.call(e.anchorMap,n)||Pn(e,'unidentified alias "'+n+'"'),e.result=e.anchorMap[n],mi(e,!0,-1),!0}ie(qJ,"readAlias");function Am(e,t,n,r,s){var i,a,o,l=1,c=!1,u=!1,d,h,m,y,b,v;if(e.listener!==null&&e.listener("open",e),e.tag=null,e.anchor=null,e.kind=null,e.result=null,i=a=o=ck===n||kJ===n,r&&mi(e,!0,-1)&&(c=!0,e.lineIndent>t?l=1:e.lineIndent===t?l=0:e.lineIndent<t&&(l=-1)),l===1)for(;zJ(e)||UJ(e);)mi(e,!0,-1)?(c=!0,o=i,e.lineIndent>t?l=1:e.lineIndent===t?l=0:e.lineIndent<t&&(l=-1)):o=!1;if(o&&(o=c||s),(l===1||ck===n)&&(lk===n||CJ===n?b=t:b=t+1,v=e.position-e.lineStart,l===1?o&&(Vj(e,v)||$J(e,v,b))||LJ(e,b)?u=!0:(a&&BJ(e,b)||DJ(e,b)||FJ(e,b)?u=!0:qJ(e)?(u=!0,(e.tag!==null||e.anchor!==null)&&Pn(e,"alias node should not have any properties")):OJ(e,b,lk===n)&&(u=!0,e.tag===null&&(e.tag="?")),e.anchor!==null&&(e.anchorMap[e.anchor]=e.result)):l===0&&(u=o&&Vj(e,v))),e.tag===null)e.anchor!==null&&(e.anchorMap[e.anchor]=e.result);else if(e.tag==="?"){for(e.result!==null&&e.kind!=="scalar"&&Pn(e,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+e.kind+'"'),d=0,h=e.implicitTypes.length;d<h;d+=1)if(y=e.implicitTypes[d],y.resolve(e.result)){e.result=y.construct(e.result),e.tag=y.tag,e.anchor!==null&&(e.anchorMap[e.anchor]=e.result);break}}else if(e.tag!=="!"){if(Rh.call(e.typeMap[e.kind||"fallback"],e.tag))y=e.typeMap[e.kind||"fallback"][e.tag];else for(y=null,m=e.typeMap.multi[e.kind||"fallback"],d=0,h=m.length;d<h;d+=1)if(e.tag.slice(0,m[d].tag.length)===m[d].tag){y=m[d];break}y||Pn(e,"unknown tag !<"+e.tag+">"),e.result!==null&&y.kind!==e.kind&&Pn(e,"unacceptable node kind for !<"+e.tag+'> tag; it should be "'+y.kind+'", not "'+e.kind+'"'),y.resolve(e.result,e.tag)?(e.result=y.construct(e.result,e.tag),e.anchor!==null&&(e.anchorMap[e.anchor]=e.result)):Pn(e,"cannot resolve a node with !<"+e.tag+"> explicit tag")}return e.listener!==null&&e.listener("close",e),e.tag!==null||e.anchor!==null||u}ie(Am,"composeNode");function VJ(e){var t=e.position,n,r,s,i=!1,a;for(e.version=null,e.checkLineBreaks=e.legacy,e.tagMap=Object.create(null),e.anchorMap=Object.create(null);(a=e.input.charCodeAt(e.position))!==0&&(mi(e,!0,-1),a=e.input.charCodeAt(e.position),!(e.lineIndent>0||a!==37));){for(i=!0,a=e.input.charCodeAt(++e.position),n=e.position;a!==0&&!Qa(a);)a=e.input.charCodeAt(++e.position);for(r=e.input.slice(n,e.position),s=[],r.length<1&&Pn(e,"directive name must not be less than one character in length");a!==0;){for(;fh(a);)a=e.input.charCodeAt(++e.position);if(a===35){do a=e.input.charCodeAt(++e.position);while(a!==0&&!Tc(a));break}if(Tc(a))break;for(n=e.position;a!==0&&!Qa(a);)a=e.input.charCodeAt(++e.position);s.push(e.input.slice(n,e.position))}a!==0&&pT(e),Rh.call(m7,r)?m7[r](e,r,s):ww(e,'unknown document directive "'+r+'"')}if(mi(e,!0,-1),e.lineIndent===0&&e.input.charCodeAt(e.position)===45&&e.input.charCodeAt(e.position+1)===45&&e.input.charCodeAt(e.position+2)===45?(e.position+=3,mi(e,!0,-1)):i&&Pn(e,"directives end mark is expected"),Am(e,e.lineIndent-1,ck,!1,!0),mi(e,!0,-1),e.checkLineBreaks&&X3e.test(e.input.slice(t,e.position))&&ww(e,"non-ASCII line breaks are interpreted as content"),e.documents.push(e.result),e.position===e.lineStart&&V1(e)){e.input.charCodeAt(e.position)===46&&(e.position+=3,mi(e,!0,-1));return}if(e.position<e.length-1)Pn(e,"end of the stream or a document separator is expected");else return}ie(VJ,"readDocument");function jD(e,t){e=String(e),t=t||{},e.length!==0&&(e.charCodeAt(e.length-1)!==10&&e.charCodeAt(e.length-1)!==13&&(e+=`
`),e.charCodeAt(0)===65279&&(e=e.slice(1)));var n=new PJ(e,t),r=e.indexOf("\0");for(r!==-1&&(n.position=r,Pn(n,"null byte is not allowed in input")),n.input+="\0";n.input.charCodeAt(n.position)===32;)n.lineIndent+=1,n.position+=1;for(;n.position<n.length-1;)VJ(n);return n.documents}ie(jD,"loadDocuments");function Q3e(e,t,n){t!==null&&typeof t=="object"&&typeof n>"u"&&(n=t,t=null);var r=jD(e,n);if(typeof t!="function")return r;for(var s=0,i=r.length;s<i;s+=1)t(r[s])}ie(Q3e,"loadAll$1");function WJ(e,t){var n=jD(e,t);if(n.length!==0){if(n.length===1)return n[0];throw new Co("expected a single document in the stream, but found more")}}ie(WJ,"load$1");var eje=WJ,tje={load:eje},HJ=Object.prototype.toString,GJ=Object.prototype.hasOwnProperty,PD=65279,nje=9,_w=10,rje=13,sje=32,ije=33,aje=34,Wj=35,oje=37,lje=38,cje=39,uje=42,KJ=44,dje=45,uk=58,fje=61,hje=62,pje=63,mje=64,YJ=91,ZJ=93,gje=96,XJ=123,yje=124,JJ=125,Ua={};Ua[0]="\\0";Ua[7]="\\a";Ua[8]="\\b";Ua[9]="\\t";Ua[10]="\\n";Ua[11]="\\v";Ua[12]="\\f";Ua[13]="\\r";Ua[27]="\\e";Ua[34]='\\"';Ua[92]="\\\\";Ua[133]="\\N";Ua[160]="\\_";Ua[8232]="\\L";Ua[8233]="\\P";var bje=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"],vje=/^[-+]?[0-9_]+(?::[0-9_]+)+(?:\.[0-9_]*)?$/;function QJ(e,t){var n,r,s,i,a,o,l;if(t===null)return{};for(n={},r=Object.keys(t),s=0,i=r.length;s<i;s+=1)a=r[s],o=String(t[a]),a.slice(0,2)==="!!"&&(a="tag:yaml.org,2002:"+a.slice(2)),l=e.compiledTypeMap.fallback[a],l&&GJ.call(l.styleAliases,o)&&(o=l.styleAliases[o]),n[a]=o;return n}ie(QJ,"compileStyleMap");function eQ(e){var t,n,r;if(t=e.toString(16).toUpperCase(),e<=255)n="x",r=2;else if(e<=65535)n="u",r=4;else if(e<=4294967295)n="U",r=8;else throw new Co("code point within a string may not be greater than 0xFFFFFFFF");return"\\"+n+$i.repeat("0",r-t.length)+t}ie(eQ,"encodeHex");var xje=1,Sw=2;function tQ(e){this.schema=e.schema||SJ,this.indent=Math.max(1,e.indent||2),this.noArrayIndent=e.noArrayIndent||!1,this.skipInvalid=e.skipInvalid||!1,this.flowLevel=$i.isNothing(e.flowLevel)?-1:e.flowLevel,this.styleMap=QJ(this.schema,e.styles||null),this.sortKeys=e.sortKeys||!1,this.lineWidth=e.lineWidth||80,this.noRefs=e.noRefs||!1,this.noCompatMode=e.noCompatMode||!1,this.condenseFlow=e.condenseFlow||!1,this.quotingType=e.quotingType==='"'?Sw:xje,this.forceQuotes=e.forceQuotes||!1,this.replacer=typeof e.replacer=="function"?e.replacer:null,this.implicitTypes=this.schema.compiledImplicit,this.explicitTypes=this.schema.compiledExplicit,this.tag=null,this.result="",this.duplicates=[],this.usedDuplicates=null}ie(tQ,"State");function Hj(e,t){for(var n=$i.repeat(" ",t),r=0,s=-1,i="",a,o=e.length;r<o;)s=e.indexOf(`
`,r),s===-1?(a=e.slice(r),r=o):(a=e.slice(r,s+1),r=s+1),a.length&&a!==`
`&&(i+=n),i+=a;return i}ie(Hj,"indentString");function dk(e,t){return`
`+$i.repeat(" ",e.indent*t)}ie(dk,"generateNextLine");function nQ(e,t){var n,r,s;for(n=0,r=e.implicitTypes.length;n<r;n+=1)if(s=e.implicitTypes[n],s.resolve(t))return!0;return!1}ie(nQ,"testImplicitResolving");function Cw(e){return e===sje||e===nje}ie(Cw,"isWhitespace");function Sy(e){return 32<=e&&e<=126||161<=e&&e<=55295&&e!==8232&&e!==8233||57344<=e&&e<=65533&&e!==PD||65536<=e&&e<=1114111}ie(Sy,"isPrintable");function Gj(e){return Sy(e)&&e!==PD&&e!==rje&&e!==_w}ie(Gj,"isNsCharOrWhitespace");function Kj(e,t,n){var r=Gj(e),s=r&&!Cw(e);return(n?r:r&&e!==KJ&&e!==YJ&&e!==ZJ&&e!==XJ&&e!==JJ)&&e!==Wj&&!(t===uk&&!s)||Gj(t)&&!Cw(t)&&e===Wj||t===uk&&s}ie(Kj,"isPlainSafe");function rQ(e){return Sy(e)&&e!==PD&&!Cw(e)&&e!==dje&&e!==pje&&e!==uk&&e!==KJ&&e!==YJ&&e!==ZJ&&e!==XJ&&e!==JJ&&e!==Wj&&e!==lje&&e!==uje&&e!==ije&&e!==yje&&e!==fje&&e!==hje&&e!==cje&&e!==aje&&e!==oje&&e!==mje&&e!==gje}ie(rQ,"isPlainSafeFirst");function sQ(e){return!Cw(e)&&e!==uk}ie(sQ,"isPlainSafeLast");function g0(e,t){var n=e.charCodeAt(t),r;return n>=55296&&n<=56319&&t+1<e.length&&(r=e.charCodeAt(t+1),r>=56320&&r<=57343)?(n-55296)*1024+r-56320+65536:n}ie(g0,"codePointAt");function OD(e){var t=/^\n* /;return t.test(e)}ie(OD,"needIndentIndicator");var iQ=1,Yj=2,aQ=3,oQ=4,c0=5;function lQ(e,t,n,r,s,i,a,o){var l,c=0,u=null,d=!1,h=!1,m=r!==-1,y=-1,b=rQ(g0(e,0))&&sQ(g0(e,e.length-1));if(t||a)for(l=0;l<e.length;c>=65536?l+=2:l++){if(c=g0(e,l),!Sy(c))return c0;b=b&&Kj(c,u,o),u=c}else{for(l=0;l<e.length;c>=65536?l+=2:l++){if(c=g0(e,l),c===_w)d=!0,m&&(h=h||l-y-1>r&&e[y+1]!==" ",y=l);else if(!Sy(c))return c0;b=b&&Kj(c,u,o),u=c}h=h||m&&l-y-1>r&&e[y+1]!==" "}return!d&&!h?b&&!a&&!s(e)?iQ:i===Sw?c0:Yj:n>9&&OD(e)?c0:a?i===Sw?c0:Yj:h?oQ:aQ}ie(lQ,"chooseScalarStyle");function cQ(e,t,n,r,s){e.dump=function(){if(t.length===0)return e.quotingType===Sw?'""':"''";if(!e.noCompatMode&&(bje.indexOf(t)!==-1||vje.test(t)))return e.quotingType===Sw?'"'+t+'"':"'"+t+"'";var i=e.indent*Math.max(1,n),a=e.lineWidth===-1?-1:Math.max(Math.min(e.lineWidth,40),e.lineWidth-i),o=r||e.flowLevel>-1&&n>=e.flowLevel;function l(c){return nQ(e,c)}switch(ie(l,"testAmbiguity"),lQ(t,o,e.indent,a,l,e.quotingType,e.forceQuotes&&!r,s)){case iQ:return t;case Yj:return"'"+t.replace(/'/g,"''")+"'";case aQ:return"|"+Zj(t,e.indent)+Xj(Hj(t,i));case oQ:return">"+Zj(t,e.indent)+Xj(Hj(uQ(t,a),i));case c0:return'"'+dQ(t)+'"';default:throw new Co("impossible error: invalid scalar style")}}()}ie(cQ,"writeScalar");function Zj(e,t){var n=OD(e)?String(t):"",r=e[e.length-1]===`
`,s=r&&(e[e.length-2]===`
`||e===`
`),i=s?"+":r?"":"-";return n+i+`
`}ie(Zj,"blockHeader");function Xj(e){return e[e.length-1]===`
`?e.slice(0,-1):e}ie(Xj,"dropEndingNewline");function uQ(e,t){for(var n=/(\n+)([^\n]*)/g,r=function(){var c=e.indexOf(`
`);return c=c!==-1?c:e.length,n.lastIndex=c,Jj(e.slice(0,c),t)}(),s=e[0]===`
`||e[0]===" ",i,a;a=n.exec(e);){var o=a[1],l=a[2];i=l[0]===" ",r+=o+(!s&&!i&&l!==""?`
`:"")+Jj(l,t),s=i}return r}ie(uQ,"foldString");function Jj(e,t){if(e===""||e[0]===" ")return e;for(var n=/ [^ ]/g,r,s=0,i,a=0,o=0,l="";r=n.exec(e);)o=r.index,o-s>t&&(i=a>s?a:o,l+=`
`+e.slice(s,i),s=i+1),a=o;return l+=`
`,e.length-s>t&&a>s?l+=e.slice(s,a)+`
`+e.slice(a+1):l+=e.slice(s),l.slice(1)}ie(Jj,"foldLine");function dQ(e){for(var t="",n=0,r,s=0;s<e.length;n>=65536?s+=2:s++)n=g0(e,s),r=Ua[n],!r&&Sy(n)?(t+=e[s],n>=65536&&(t+=e[s+1])):t+=r||eQ(n);return t}ie(dQ,"escapeString");function fQ(e,t,n){var r="",s=e.tag,i,a,o;for(i=0,a=n.length;i<a;i+=1)o=n[i],e.replacer&&(o=e.replacer.call(n,String(i),o)),(Du(e,t,o,!1,!1)||typeof o>"u"&&Du(e,t,null,!1,!1))&&(r!==""&&(r+=","+(e.condenseFlow?"":" ")),r+=e.dump);e.tag=s,e.dump="["+r+"]"}ie(fQ,"writeFlowSequence");function Qj(e,t,n,r){var s="",i=e.tag,a,o,l;for(a=0,o=n.length;a<o;a+=1)l=n[a],e.replacer&&(l=e.replacer.call(n,String(a),l)),(Du(e,t+1,l,!0,!0,!1,!0)||typeof l>"u"&&Du(e,t+1,null,!0,!0,!1,!0))&&((!r||s!=="")&&(s+=dk(e,t)),e.dump&&_w===e.dump.charCodeAt(0)?s+="-":s+="- ",s+=e.dump);e.tag=i,e.dump=s||"[]"}ie(Qj,"writeBlockSequence");function hQ(e,t,n){var r="",s=e.tag,i=Object.keys(n),a,o,l,c,u;for(a=0,o=i.length;a<o;a+=1)u="",r!==""&&(u+=", "),e.condenseFlow&&(u+='"'),l=i[a],c=n[l],e.replacer&&(c=e.replacer.call(n,l,c)),Du(e,t,l,!1,!1)&&(e.dump.length>1024&&(u+="? "),u+=e.dump+(e.condenseFlow?'"':"")+":"+(e.condenseFlow?"":" "),Du(e,t,c,!1,!1)&&(u+=e.dump,r+=u));e.tag=s,e.dump="{"+r+"}"}ie(hQ,"writeFlowMapping");function pQ(e,t,n,r){var s="",i=e.tag,a=Object.keys(n),o,l,c,u,d,h;if(e.sortKeys===!0)a.sort();else if(typeof e.sortKeys=="function")a.sort(e.sortKeys);else if(e.sortKeys)throw new Co("sortKeys must be a boolean or a function");for(o=0,l=a.length;o<l;o+=1)h="",(!r||s!=="")&&(h+=dk(e,t)),c=a[o],u=n[c],e.replacer&&(u=e.replacer.call(n,c,u)),Du(e,t+1,c,!0,!0,!0)&&(d=e.tag!==null&&e.tag!=="?"||e.dump&&e.dump.length>1024,d&&(e.dump&&_w===e.dump.charCodeAt(0)?h+="?":h+="? "),h+=e.dump,d&&(h+=dk(e,t)),Du(e,t+1,u,!0,d)&&(e.dump&&_w===e.dump.charCodeAt(0)?h+=":":h+=": ",h+=e.dump,s+=h));e.tag=i,e.dump=s||"{}"}ie(pQ,"writeBlockMapping");function e4(e,t,n){var r,s,i,a,o,l;for(s=n?e.explicitTypes:e.implicitTypes,i=0,a=s.length;i<a;i+=1)if(o=s[i],(o.instanceOf||o.predicate)&&(!o.instanceOf||typeof t=="object"&&t instanceof o.instanceOf)&&(!o.predicate||o.predicate(t))){if(n?o.multi&&o.representName?e.tag=o.representName(t):e.tag=o.tag:e.tag="?",o.represent){if(l=e.styleMap[o.tag]||o.defaultStyle,HJ.call(o.represent)==="[object Function]")r=o.represent(t,l);else if(GJ.call(o.represent,l))r=o.represent[l](t,l);else throw new Co("!<"+o.tag+'> tag resolver accepts not "'+l+'" style');e.dump=r}return!0}return!1}ie(e4,"detectType");function Du(e,t,n,r,s,i,a){e.tag=null,e.dump=n,e4(e,n,!1)||e4(e,n,!0);var o=HJ.call(e.dump),l=r,c;r&&(r=e.flowLevel<0||e.flowLevel>t);var u=o==="[object Object]"||o==="[object Array]",d,h;if(u&&(d=e.duplicates.indexOf(n),h=d!==-1),(e.tag!==null&&e.tag!=="?"||h||e.indent!==2&&t>0)&&(s=!1),h&&e.usedDuplicates[d])e.dump="*ref_"+d;else{if(u&&h&&!e.usedDuplicates[d]&&(e.usedDuplicates[d]=!0),o==="[object Object]")r&&Object.keys(e.dump).length!==0?(pQ(e,t,e.dump,s),h&&(e.dump="&ref_"+d+e.dump)):(hQ(e,t,e.dump),h&&(e.dump="&ref_"+d+" "+e.dump));else if(o==="[object Array]")r&&e.dump.length!==0?(e.noArrayIndent&&!a&&t>0?Qj(e,t-1,e.dump,s):Qj(e,t,e.dump,s),h&&(e.dump="&ref_"+d+e.dump)):(fQ(e,t,e.dump),h&&(e.dump="&ref_"+d+" "+e.dump));else if(o==="[object String]")e.tag!=="?"&&cQ(e,e.dump,t,i,l);else{if(o==="[object Undefined]")return!1;if(e.skipInvalid)return!1;throw new Co("unacceptable kind of an object to dump "+o)}e.tag!==null&&e.tag!=="?"&&(c=encodeURI(e.tag[0]==="!"?e.tag.slice(1):e.tag).replace(/!/g,"%21"),e.tag[0]==="!"?c="!"+c:c.slice(0,18)==="tag:yaml.org,2002:"?c="!!"+c.slice(18):c="!<"+c+">",e.dump=c+" "+e.dump)}return!0}ie(Du,"writeNode");function mQ(e,t){var n=[],r=[],s,i;for(fk(e,n,r),s=0,i=r.length;s<i;s+=1)t.duplicates.push(n[r[s]]);t.usedDuplicates=new Array(i)}ie(mQ,"getDuplicateReferences");function fk(e,t,n){var r,s,i;if(e!==null&&typeof e=="object")if(s=t.indexOf(e),s!==-1)n.indexOf(s)===-1&&n.push(s);else if(t.push(e),Array.isArray(e))for(s=0,i=e.length;s<i;s+=1)fk(e[s],t,n);else for(r=Object.keys(e),s=0,i=r.length;s<i;s+=1)fk(e[r[s]],t,n)}ie(fk,"inspectNode");function wje(e,t){t=t||{};var n=new tQ(t);n.noRefs||mQ(e,n);var r=e;return n.replacer&&(r=n.replacer.call({"":r},"",r)),Du(n,0,r,!0,!0)?n.dump+`
`:""}ie(wje,"dump$1");function _je(e,t){return function(){throw new Error("Function yaml."+e+" is removed in js-yaml 4. Use yaml."+t+" instead, which is now safe by default.")}}ie(_je,"renamed");var Sje=aJ,Cje=tje.load;/*! Bundled license information:

js-yaml/dist/js-yaml.mjs:
  (*! js-yaml 4.1.0 https://github.com/nodeca/js-yaml @license MIT *)
*/var Dl={aggregation:18,extension:18,composition:18,dependency:6,lollipop:13.5,arrow_point:4};function Jv(e,t){if(e===void 0||t===void 0)return{angle:0,deltaX:0,deltaY:0};e=Gs(e),t=Gs(t);const[n,r]=[e.x,e.y],[s,i]=[t.x,t.y],a=s-n,o=i-r;return{angle:Math.atan(o/a),deltaX:a,deltaY:o}}ie(Jv,"calculateDeltaAndAngle");var Gs=ie(e=>Array.isArray(e)?{x:e[0],y:e[1]}:e,"pointTransformer"),kje=ie(e=>({x:ie(function(t,n,r){let s=0;const i=Gs(r[0]).x<Gs(r[r.length-1]).x?"left":"right";if(n===0&&Object.hasOwn(Dl,e.arrowTypeStart)){const{angle:m,deltaX:y}=Jv(r[0],r[1]);s=Dl[e.arrowTypeStart]*Math.cos(m)*(y>=0?1:-1)}else if(n===r.length-1&&Object.hasOwn(Dl,e.arrowTypeEnd)){const{angle:m,deltaX:y}=Jv(r[r.length-1],r[r.length-2]);s=Dl[e.arrowTypeEnd]*Math.cos(m)*(y>=0?1:-1)}const a=Math.abs(Gs(t).x-Gs(r[r.length-1]).x),o=Math.abs(Gs(t).y-Gs(r[r.length-1]).y),l=Math.abs(Gs(t).x-Gs(r[0]).x),c=Math.abs(Gs(t).y-Gs(r[0]).y),u=Dl[e.arrowTypeStart],d=Dl[e.arrowTypeEnd],h=1;if(a<d&&a>0&&o<d){let m=d+h-a;m*=i==="right"?-1:1,s-=m}if(l<u&&l>0&&c<u){let m=u+h-l;m*=i==="right"?-1:1,s+=m}return Gs(t).x+s},"x"),y:ie(function(t,n,r){let s=0;const i=Gs(r[0]).y<Gs(r[r.length-1]).y?"down":"up";if(n===0&&Object.hasOwn(Dl,e.arrowTypeStart)){const{angle:m,deltaY:y}=Jv(r[0],r[1]);s=Dl[e.arrowTypeStart]*Math.abs(Math.sin(m))*(y>=0?1:-1)}else if(n===r.length-1&&Object.hasOwn(Dl,e.arrowTypeEnd)){const{angle:m,deltaY:y}=Jv(r[r.length-1],r[r.length-2]);s=Dl[e.arrowTypeEnd]*Math.abs(Math.sin(m))*(y>=0?1:-1)}const a=Math.abs(Gs(t).y-Gs(r[r.length-1]).y),o=Math.abs(Gs(t).x-Gs(r[r.length-1]).x),l=Math.abs(Gs(t).y-Gs(r[0]).y),c=Math.abs(Gs(t).x-Gs(r[0]).x),u=Dl[e.arrowTypeStart],d=Dl[e.arrowTypeEnd],h=1;if(a<d&&a>0&&o<d){let m=d+h-a;m*=i==="up"?-1:1,s-=m}if(l<u&&l>0&&c<u){let m=u+h-l;m*=i==="up"?-1:1,s+=m}return Gs(t).y+s},"y")}),"getLineFunctionsWithOffset"),DD=ie(({flowchart:e})=>{var s,i;const t=((s=e==null?void 0:e.subGraphTitleMargin)==null?void 0:s.top)??0,n=((i=e==null?void 0:e.subGraphTitleMargin)==null?void 0:i.bottom)??0,r=t+n;return{subGraphTitleTopMargin:t,subGraphTitleBottomMargin:n,subGraphTitleTotalMargin:r}},"getSubGraphTitleMargins");const Eje=Object.freeze({left:0,top:0,width:16,height:16}),hk=Object.freeze({rotate:0,vFlip:!1,hFlip:!1}),gQ=Object.freeze({...Eje,...hk}),Tje=Object.freeze({...gQ,body:"",hidden:!1}),Aje=Object.freeze({width:null,height:null}),Rje=Object.freeze({...Aje,...hk}),Nje=(e,t,n,r="")=>{const s=e.split(":");if(e.slice(0,1)==="@"){if(s.length<2||s.length>3)return null;r=s.shift().slice(1)}if(s.length>3||!s.length)return null;if(s.length>1){const o=s.pop(),l=s.pop(),c={provider:s.length>0?s[0]:r,prefix:l,name:o};return _I(c)?c:null}const i=s[0],a=i.split("-");if(a.length>1){const o={provider:r,prefix:a.shift(),name:a.join("-")};return _I(o)?o:null}if(n&&r===""){const o={provider:r,prefix:"",name:i};return _I(o,n)?o:null}return null},_I=(e,t)=>e?!!((t&&e.prefix===""||e.prefix)&&e.name):!1;function Mje(e,t){const n={};!e.hFlip!=!t.hFlip&&(n.hFlip=!0),!e.vFlip!=!t.vFlip&&(n.vFlip=!0);const r=((e.rotate||0)+(t.rotate||0))%4;return r&&(n.rotate=r),n}function g7(e,t){const n=Mje(e,t);for(const r in Tje)r in hk?r in e&&!(r in n)&&(n[r]=hk[r]):r in t?n[r]=t[r]:r in e&&(n[r]=e[r]);return n}function Ije(e,t){const n=e.icons,r=e.aliases||Object.create(null),s=Object.create(null);function i(a){if(n[a])return s[a]=[];if(!(a in s)){s[a]=null;const o=r[a]&&r[a].parent,l=o&&i(o);l&&(s[a]=[o].concat(l))}return s[a]}return(t||Object.keys(n).concat(Object.keys(r))).forEach(i),s}function y7(e,t,n){const r=e.icons,s=e.aliases||Object.create(null);let i={};function a(o){i=g7(r[o]||s[o],i)}return a(t),n.forEach(a),g7(e,i)}function jje(e,t){if(e.icons[t])return y7(e,t,[]);const n=Ije(e,[t])[t];return n?y7(e,t,n):null}const Pje=/(-?[0-9.]*[0-9]+[0-9.]*)/g,Oje=/^-?[0-9.]*[0-9]+[0-9.]*$/g;function b7(e,t,n){if(t===1)return e;if(n=n||100,typeof e=="number")return Math.ceil(e*t*n)/n;if(typeof e!="string")return e;const r=e.split(Pje);if(r===null||!r.length)return e;const s=[];let i=r.shift(),a=Oje.test(i);for(;;){if(a){const o=parseFloat(i);isNaN(o)?s.push(i):s.push(Math.ceil(o*t*n)/n)}else s.push(i);if(i=r.shift(),i===void 0)return s.join("");a=!a}}function Dje(e,t="defs"){let n="";const r=e.indexOf("<"+t);for(;r>=0;){const s=e.indexOf(">",r),i=e.indexOf("</"+t);if(s===-1||i===-1)break;const a=e.indexOf(">",i);if(a===-1)break;n+=e.slice(s+1,i).trim(),e=e.slice(0,r).trim()+e.slice(a+1)}return{defs:n,content:e}}function Fje(e,t){return e?"<defs>"+e+"</defs>"+t:t}function Lje(e,t,n){const r=Dje(e);return Fje(r.defs,t+r.content+n)}const Bje=e=>e==="unset"||e==="undefined"||e==="none";function $je(e,t){const n={...gQ,...e},r={...Rje,...t},s={left:n.left,top:n.top,width:n.width,height:n.height};let i=n.body;[n,r].forEach(b=>{const v=[],x=b.hFlip,w=b.vFlip;let S=b.rotate;x?w?S+=2:(v.push("translate("+(s.width+s.left).toString()+" "+(0-s.top).toString()+")"),v.push("scale(-1 1)"),s.top=s.left=0):w&&(v.push("translate("+(0-s.left).toString()+" "+(s.height+s.top).toString()+")"),v.push("scale(1 -1)"),s.top=s.left=0);let C;switch(S<0&&(S-=Math.floor(S/4)*4),S=S%4,S){case 1:C=s.height/2+s.top,v.unshift("rotate(90 "+C.toString()+" "+C.toString()+")");break;case 2:v.unshift("rotate(180 "+(s.width/2+s.left).toString()+" "+(s.height/2+s.top).toString()+")");break;case 3:C=s.width/2+s.left,v.unshift("rotate(-90 "+C.toString()+" "+C.toString()+")");break}S%2===1&&(s.left!==s.top&&(C=s.left,s.left=s.top,s.top=C),s.width!==s.height&&(C=s.width,s.width=s.height,s.height=C)),v.length&&(i=Lje(i,'<g transform="'+v.join(" ")+'">',"</g>"))});const a=r.width,o=r.height,l=s.width,c=s.height;let u,d;a===null?(d=o===null?"1em":o==="auto"?c:o,u=b7(d,l/c)):(u=a==="auto"?l:a,d=o===null?b7(u,c/l):o==="auto"?c:o);const h={},m=(b,v)=>{Bje(v)||(h[b]=v.toString())};m("width",u),m("height",d);const y=[s.left,s.top,l,c];return h.viewBox=y.join(" "),{attributes:h,viewBox:y,body:i}}const zje=/\sid="(\S+)"/g,Uje="IconifyId"+Date.now().toString(16)+(Math.random()*16777216|0).toString(16);let qje=0;function Vje(e,t=Uje){const n=[];let r;for(;r=zje.exec(e);)n.push(r[1]);if(!n.length)return e;const s="suffix"+(Math.random()*16777216|Date.now()).toString(16);return n.forEach(i=>{const a=typeof t=="function"?t(i):t+(qje++).toString(),o=i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");e=e.replace(new RegExp('([#;"])('+o+')([")]|\\.[a-z])',"g"),"$1"+a+s+"$3")}),e=e.replace(new RegExp(s,"g"),""),e}function Wje(e,t){let n=e.indexOf("xlink:")===-1?"":' xmlns:xlink="http://www.w3.org/1999/xlink"';for(const r in t)n+=" "+r+'="'+t[r]+'"';return'<svg xmlns="http://www.w3.org/2000/svg"'+n+">"+e+"</svg>"}var Hje={body:'<g><rect width="80" height="80" style="fill: #087ebf; stroke-width: 0px;"/><text transform="translate(21.16 64.67)" style="fill: #fff; font-family: ArialMT, Arial; font-size: 67.75px;"><tspan x="0" y="0">?</tspan></text></g>',height:80,width:80},t4=new Map,yQ=new Map,Gje=ie(e=>{for(const t of e){if(!t.name)throw new Error('Invalid icon loader. Must have a "name" property with non-empty string value.');if(zt.debug("Registering icon pack:",t.name),"loader"in t)yQ.set(t.name,t.loader);else if("icons"in t)t4.set(t.name,t.icons);else throw zt.error("Invalid icon loader:",t),new Error('Invalid icon loader. Must have either "icons" or "loader" property.')}},"registerIconPacks"),Kje=ie(async(e,t)=>{const n=Nje(e,!0,t!==void 0);if(!n)throw new Error(`Invalid icon name: ${e}`);const r=n.prefix||t;if(!r)throw new Error(`Icon name must contain a prefix: ${e}`);let s=t4.get(r);if(!s){const a=yQ.get(r);if(!a)throw new Error(`Icon set not found: ${n.prefix}`);try{s={...await a(),prefix:r},t4.set(r,s)}catch(o){throw zt.error(o),new Error(`Failed to load icon set: ${n.prefix}`)}}const i=jje(s,n.name);if(!i)throw new Error(`Icon not found: ${e}`);return i},"getRegisteredIconData"),gT=ie(async(e,t)=>{let n;try{n=await Kje(e,t==null?void 0:t.fallbackPrefix)}catch(i){zt.error(i),n=Hje}const r=$je(n,t);return Wje(Vje(r.body),r.attributes)},"getIconSVG"),Lv={},Fi={},v7;function Yje(){return v7||(v7=1,Object.defineProperty(Fi,"__esModule",{value:!0}),Fi.BLANK_URL=Fi.relativeFirstCharacters=Fi.whitespaceEscapeCharsRegex=Fi.urlSchemeRegex=Fi.ctrlCharactersRegex=Fi.htmlCtrlEntityRegex=Fi.htmlEntitiesRegex=Fi.invalidProtocolRegex=void 0,Fi.invalidProtocolRegex=/^([^\w]*)(javascript|data|vbscript)/im,Fi.htmlEntitiesRegex=/&#(\w+)(^\w|;)?/g,Fi.htmlCtrlEntityRegex=/&(newline|tab);/gi,Fi.ctrlCharactersRegex=/[\u0000-\u001F\u007F-\u009F\u2000-\u200D\uFEFF]/gim,Fi.urlSchemeRegex=/^.+(:|&colon;)/gim,Fi.whitespaceEscapeCharsRegex=/(\\|%5[cC])((%(6[eE]|72|74))|[nrt])/g,Fi.relativeFirstCharacters=[".","/"],Fi.BLANK_URL="about:blank"),Fi}var x7;function Zje(){if(x7)return Lv;x7=1,Object.defineProperty(Lv,"__esModule",{value:!0}),Lv.sanitizeUrl=void 0;var e=Yje();function t(a){return e.relativeFirstCharacters.indexOf(a[0])>-1}function n(a){var o=a.replace(e.ctrlCharactersRegex,"");return o.replace(e.htmlEntitiesRegex,function(l,c){return String.fromCharCode(c)})}function r(a){return URL.canParse(a)}function s(a){try{return decodeURIComponent(a)}catch{return a}}function i(a){if(!a)return e.BLANK_URL;var o,l=s(a.trim());do l=n(l).replace(e.htmlCtrlEntityRegex,"").replace(e.ctrlCharactersRegex,"").replace(e.whitespaceEscapeCharsRegex,"").trim(),l=s(l),o=l.match(e.ctrlCharactersRegex)||l.match(e.htmlEntitiesRegex)||l.match(e.htmlCtrlEntityRegex)||l.match(e.whitespaceEscapeCharsRegex);while(o&&o.length>0);var c=l;if(!c)return e.BLANK_URL;if(t(c))return c;var u=c.trimStart(),d=u.match(e.urlSchemeRegex);if(!d)return c;var h=d[0].toLowerCase().trim();if(e.invalidProtocolRegex.test(h))return e.BLANK_URL;var m=u.replace(/\\/g,"/");if(h==="mailto:"||h.includes("://"))return m;if(h==="http:"||h==="https:"){if(!r(m))return e.BLANK_URL;var y=new URL(m);return y.protocol=y.protocol.toLowerCase(),y.hostname=y.hostname.toLowerCase(),y.toString()}return m}return Lv.sanitizeUrl=i,Lv}var Xje=Zje(),Jje={value:()=>{}};function bQ(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new D2(n)}function D2(e){this._=e}function Qje(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",s=n.indexOf(".");if(s>=0&&(r=n.slice(s+1),n=n.slice(0,s)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}D2.prototype=bQ.prototype={constructor:D2,on:function(e,t){var n=this._,r=Qje(e+"",n),s,i=-1,a=r.length;if(arguments.length<2){for(;++i<a;)if((s=(e=r[i]).type)&&(s=e4e(n[s],e.name)))return s;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++i<a;)if(s=(e=r[i]).type)n[s]=w7(n[s],e.name,t);else if(t==null)for(s in n)n[s]=w7(n[s],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new D2(e)},call:function(e,t){if((s=arguments.length-2)>0)for(var n=new Array(s),r=0,s,i;r<s;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(i=this._[e],r=0,s=i.length;r<s;++r)i[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],s=0,i=r.length;s<i;++s)r[s].value.apply(t,n)}};function e4e(e,t){for(var n=0,r=e.length,s;n<r;++n)if((s=e[n]).name===t)return s.value}function w7(e,t,n){for(var r=0,s=e.length;r<s;++r)if(e[r].name===t){e[r]=Jje,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var n4="http://www.w3.org/1999/xhtml";const _7={svg:"http://www.w3.org/2000/svg",xhtml:n4,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function yT(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),_7.hasOwnProperty(t)?{space:_7[t],local:e}:e}function t4e(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===n4&&t.documentElement.namespaceURI===n4?t.createElement(e):t.createElementNS(n,e)}}function n4e(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function vQ(e){var t=yT(e);return(t.local?n4e:t4e)(t)}function r4e(){}function FD(e){return e==null?r4e:function(){return this.querySelector(e)}}function s4e(e){typeof e!="function"&&(e=FD(e));for(var t=this._groups,n=t.length,r=new Array(n),s=0;s<n;++s)for(var i=t[s],a=i.length,o=r[s]=new Array(a),l,c,u=0;u<a;++u)(l=i[u])&&(c=e.call(l,l.__data__,u,i))&&("__data__"in l&&(c.__data__=l.__data__),o[u]=c);return new yl(r,this._parents)}function i4e(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function a4e(){return[]}function xQ(e){return e==null?a4e:function(){return this.querySelectorAll(e)}}function o4e(e){return function(){return i4e(e.apply(this,arguments))}}function l4e(e){typeof e=="function"?e=o4e(e):e=xQ(e);for(var t=this._groups,n=t.length,r=[],s=[],i=0;i<n;++i)for(var a=t[i],o=a.length,l,c=0;c<o;++c)(l=a[c])&&(r.push(e.call(l,l.__data__,c,a)),s.push(l));return new yl(r,s)}function wQ(e){return function(){return this.matches(e)}}function _Q(e){return function(t){return t.matches(e)}}var c4e=Array.prototype.find;function u4e(e){return function(){return c4e.call(this.children,e)}}function d4e(){return this.firstElementChild}function f4e(e){return this.select(e==null?d4e:u4e(typeof e=="function"?e:_Q(e)))}var h4e=Array.prototype.filter;function p4e(){return Array.from(this.children)}function m4e(e){return function(){return h4e.call(this.children,e)}}function g4e(e){return this.selectAll(e==null?p4e:m4e(typeof e=="function"?e:_Q(e)))}function y4e(e){typeof e!="function"&&(e=wQ(e));for(var t=this._groups,n=t.length,r=new Array(n),s=0;s<n;++s)for(var i=t[s],a=i.length,o=r[s]=[],l,c=0;c<a;++c)(l=i[c])&&e.call(l,l.__data__,c,i)&&o.push(l);return new yl(r,this._parents)}function SQ(e){return new Array(e.length)}function b4e(){return new yl(this._enter||this._groups.map(SQ),this._parents)}function pk(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}pk.prototype={constructor:pk,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function v4e(e){return function(){return e}}function x4e(e,t,n,r,s,i){for(var a=0,o,l=t.length,c=i.length;a<c;++a)(o=t[a])?(o.__data__=i[a],r[a]=o):n[a]=new pk(e,i[a]);for(;a<l;++a)(o=t[a])&&(s[a]=o)}function w4e(e,t,n,r,s,i,a){var o,l,c=new Map,u=t.length,d=i.length,h=new Array(u),m;for(o=0;o<u;++o)(l=t[o])&&(h[o]=m=a.call(l,l.__data__,o,t)+"",c.has(m)?s[o]=l:c.set(m,l));for(o=0;o<d;++o)m=a.call(e,i[o],o,i)+"",(l=c.get(m))?(r[o]=l,l.__data__=i[o],c.delete(m)):n[o]=new pk(e,i[o]);for(o=0;o<u;++o)(l=t[o])&&c.get(h[o])===l&&(s[o]=l)}function _4e(e){return e.__data__}function S4e(e,t){if(!arguments.length)return Array.from(this,_4e);var n=t?w4e:x4e,r=this._parents,s=this._groups;typeof e!="function"&&(e=v4e(e));for(var i=s.length,a=new Array(i),o=new Array(i),l=new Array(i),c=0;c<i;++c){var u=r[c],d=s[c],h=d.length,m=C4e(e.call(u,u&&u.__data__,c,r)),y=m.length,b=o[c]=new Array(y),v=a[c]=new Array(y),x=l[c]=new Array(h);n(u,d,b,v,x,m,t);for(var w=0,S=0,C,k;w<y;++w)if(C=b[w]){for(w>=S&&(S=w+1);!(k=v[S])&&++S<y;);C._next=k||null}}return a=new yl(a,r),a._enter=o,a._exit=l,a}function C4e(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function k4e(){return new yl(this._exit||this._groups.map(SQ),this._parents)}function E4e(e,t,n){var r=this.enter(),s=this,i=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),t!=null&&(s=t(s),s&&(s=s.selection())),n==null?i.remove():n(i),r&&s?r.merge(s).order():s}function T4e(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,s=n.length,i=r.length,a=Math.min(s,i),o=new Array(s),l=0;l<a;++l)for(var c=n[l],u=r[l],d=c.length,h=o[l]=new Array(d),m,y=0;y<d;++y)(m=c[y]||u[y])&&(h[y]=m);for(;l<s;++l)o[l]=n[l];return new yl(o,this._parents)}function A4e(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],s=r.length-1,i=r[s],a;--s>=0;)(a=r[s])&&(i&&a.compareDocumentPosition(i)^4&&i.parentNode.insertBefore(a,i),i=a);return this}function R4e(e){e||(e=N4e);function t(d,h){return d&&h?e(d.__data__,h.__data__):!d-!h}for(var n=this._groups,r=n.length,s=new Array(r),i=0;i<r;++i){for(var a=n[i],o=a.length,l=s[i]=new Array(o),c,u=0;u<o;++u)(c=a[u])&&(l[u]=c);l.sort(t)}return new yl(s,this._parents).order()}function N4e(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function M4e(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function I4e(){return Array.from(this)}function j4e(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],s=0,i=r.length;s<i;++s){var a=r[s];if(a)return a}return null}function P4e(){let e=0;for(const t of this)++e;return e}function O4e(){return!this.node()}function D4e(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var s=t[n],i=0,a=s.length,o;i<a;++i)(o=s[i])&&e.call(o,o.__data__,i,s);return this}function F4e(e){return function(){this.removeAttribute(e)}}function L4e(e){return function(){this.removeAttributeNS(e.space,e.local)}}function B4e(e,t){return function(){this.setAttribute(e,t)}}function $4e(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function z4e(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function U4e(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function q4e(e,t){var n=yT(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?L4e:F4e:typeof t=="function"?n.local?U4e:z4e:n.local?$4e:B4e)(n,t))}function CQ(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function V4e(e){return function(){this.style.removeProperty(e)}}function W4e(e,t,n){return function(){this.style.setProperty(e,t,n)}}function H4e(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function G4e(e,t,n){return arguments.length>1?this.each((t==null?V4e:typeof t=="function"?H4e:W4e)(e,t,n??"")):Cy(this.node(),e)}function Cy(e,t){return e.style.getPropertyValue(t)||CQ(e).getComputedStyle(e,null).getPropertyValue(t)}function K4e(e){return function(){delete this[e]}}function Y4e(e,t){return function(){this[e]=t}}function Z4e(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function X4e(e,t){return arguments.length>1?this.each((t==null?K4e:typeof t=="function"?Z4e:Y4e)(e,t)):this.node()[e]}function kQ(e){return e.trim().split(/^|\s+/)}function LD(e){return e.classList||new EQ(e)}function EQ(e){this._node=e,this._names=kQ(e.getAttribute("class")||"")}EQ.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function TQ(e,t){for(var n=LD(e),r=-1,s=t.length;++r<s;)n.add(t[r])}function AQ(e,t){for(var n=LD(e),r=-1,s=t.length;++r<s;)n.remove(t[r])}function J4e(e){return function(){TQ(this,e)}}function Q4e(e){return function(){AQ(this,e)}}function ePe(e,t){return function(){(t.apply(this,arguments)?TQ:AQ)(this,e)}}function tPe(e,t){var n=kQ(e+"");if(arguments.length<2){for(var r=LD(this.node()),s=-1,i=n.length;++s<i;)if(!r.contains(n[s]))return!1;return!0}return this.each((typeof t=="function"?ePe:t?J4e:Q4e)(n,t))}function nPe(){this.textContent=""}function rPe(e){return function(){this.textContent=e}}function sPe(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function iPe(e){return arguments.length?this.each(e==null?nPe:(typeof e=="function"?sPe:rPe)(e)):this.node().textContent}function aPe(){this.innerHTML=""}function oPe(e){return function(){this.innerHTML=e}}function lPe(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function cPe(e){return arguments.length?this.each(e==null?aPe:(typeof e=="function"?lPe:oPe)(e)):this.node().innerHTML}function uPe(){this.nextSibling&&this.parentNode.appendChild(this)}function dPe(){return this.each(uPe)}function fPe(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function hPe(){return this.each(fPe)}function pPe(e){var t=typeof e=="function"?e:vQ(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function mPe(){return null}function gPe(e,t){var n=typeof e=="function"?e:vQ(e),r=t==null?mPe:typeof t=="function"?t:FD(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function yPe(){var e=this.parentNode;e&&e.removeChild(this)}function bPe(){return this.each(yPe)}function vPe(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function xPe(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function wPe(e){return this.select(e?xPe:vPe)}function _Pe(e){return arguments.length?this.property("__data__",e):this.node().__data__}function SPe(e){return function(t){e.call(this,t,this.__data__)}}function CPe(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function kPe(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,s=t.length,i;n<s;++n)i=t[n],(!e.type||i.type===e.type)&&i.name===e.name?this.removeEventListener(i.type,i.listener,i.options):t[++r]=i;++r?t.length=r:delete this.__on}}}function EPe(e,t,n){return function(){var r=this.__on,s,i=SPe(t);if(r){for(var a=0,o=r.length;a<o;++a)if((s=r[a]).type===e.type&&s.name===e.name){this.removeEventListener(s.type,s.listener,s.options),this.addEventListener(s.type,s.listener=i,s.options=n),s.value=t;return}}this.addEventListener(e.type,i,n),s={type:e.type,name:e.name,value:t,listener:i,options:n},r?r.push(s):this.__on=[s]}}function TPe(e,t,n){var r=CPe(e+""),s,i=r.length,a;if(arguments.length<2){var o=this.node().__on;if(o){for(var l=0,c=o.length,u;l<c;++l)for(s=0,u=o[l];s<i;++s)if((a=r[s]).type===u.type&&a.name===u.name)return u.value}return}for(o=t?EPe:kPe,s=0;s<i;++s)this.each(o(r[s],t,n));return this}function RQ(e,t,n){var r=CQ(e),s=r.CustomEvent;typeof s=="function"?s=new s(t,n):(s=r.document.createEvent("Event"),n?(s.initEvent(t,n.bubbles,n.cancelable),s.detail=n.detail):s.initEvent(t,!1,!1)),e.dispatchEvent(s)}function APe(e,t){return function(){return RQ(this,e,t)}}function RPe(e,t){return function(){return RQ(this,e,t.apply(this,arguments))}}function NPe(e,t){return this.each((typeof t=="function"?RPe:APe)(e,t))}function*MPe(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],s=0,i=r.length,a;s<i;++s)(a=r[s])&&(yield a)}var NQ=[null];function yl(e,t){this._groups=e,this._parents=t}function W1(){return new yl([[document.documentElement]],NQ)}function IPe(){return this}yl.prototype=W1.prototype={constructor:yl,select:s4e,selectAll:l4e,selectChild:f4e,selectChildren:g4e,filter:y4e,data:S4e,enter:b4e,exit:k4e,join:E4e,merge:T4e,selection:IPe,order:A4e,sort:R4e,call:M4e,nodes:I4e,node:j4e,size:P4e,empty:O4e,each:D4e,attr:q4e,style:G4e,property:X4e,classed:tPe,text:iPe,html:cPe,raise:dPe,lower:hPe,append:pPe,insert:gPe,remove:bPe,clone:wPe,datum:_Pe,on:TPe,dispatch:NPe,[Symbol.iterator]:MPe};function Kr(e){return typeof e=="string"?new yl([[document.querySelector(e)]],[document.documentElement]):new yl([[e]],NQ)}function BD(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function MQ(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function H1(){}var kw=.7,mk=1/kw,I0="\\s*([+-]?\\d+)\\s*",Ew="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Cu="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",jPe=/^#([0-9a-f]{3,8})$/,PPe=new RegExp(`^rgb\\(${I0},${I0},${I0}\\)$`),OPe=new RegExp(`^rgb\\(${Cu},${Cu},${Cu}\\)$`),DPe=new RegExp(`^rgba\\(${I0},${I0},${I0},${Ew}\\)$`),FPe=new RegExp(`^rgba\\(${Cu},${Cu},${Cu},${Ew}\\)$`),LPe=new RegExp(`^hsl\\(${Ew},${Cu},${Cu}\\)$`),BPe=new RegExp(`^hsla\\(${Ew},${Cu},${Cu},${Ew}\\)$`),S7={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};BD(H1,Tw,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:C7,formatHex:C7,formatHex8:$Pe,formatHsl:zPe,formatRgb:k7,toString:k7});function C7(){return this.rgb().formatHex()}function $Pe(){return this.rgb().formatHex8()}function zPe(){return IQ(this).formatHsl()}function k7(){return this.rgb().formatRgb()}function Tw(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=jPe.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?E7(t):n===3?new ko(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?VS(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?VS(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=PPe.exec(e))?new ko(t[1],t[2],t[3],1):(t=OPe.exec(e))?new ko(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=DPe.exec(e))?VS(t[1],t[2],t[3],t[4]):(t=FPe.exec(e))?VS(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=LPe.exec(e))?R7(t[1],t[2]/100,t[3]/100,1):(t=BPe.exec(e))?R7(t[1],t[2]/100,t[3]/100,t[4]):S7.hasOwnProperty(e)?E7(S7[e]):e==="transparent"?new ko(NaN,NaN,NaN,0):null}function E7(e){return new ko(e>>16&255,e>>8&255,e&255,1)}function VS(e,t,n,r){return r<=0&&(e=t=n=NaN),new ko(e,t,n,r)}function UPe(e){return e instanceof H1||(e=Tw(e)),e?(e=e.rgb(),new ko(e.r,e.g,e.b,e.opacity)):new ko}function r4(e,t,n,r){return arguments.length===1?UPe(e):new ko(e,t,n,r??1)}function ko(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}BD(ko,r4,MQ(H1,{brighter(e){return e=e==null?mk:Math.pow(mk,e),new ko(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?kw:Math.pow(kw,e),new ko(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new ko(um(this.r),um(this.g),um(this.b),gk(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:T7,formatHex:T7,formatHex8:qPe,formatRgb:A7,toString:A7}));function T7(){return`#${rm(this.r)}${rm(this.g)}${rm(this.b)}`}function qPe(){return`#${rm(this.r)}${rm(this.g)}${rm(this.b)}${rm((isNaN(this.opacity)?1:this.opacity)*255)}`}function A7(){const e=gk(this.opacity);return`${e===1?"rgb(":"rgba("}${um(this.r)}, ${um(this.g)}, ${um(this.b)}${e===1?")":`, ${e})`}`}function gk(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function um(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function rm(e){return e=um(e),(e<16?"0":"")+e.toString(16)}function R7(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new bc(e,t,n,r)}function IQ(e){if(e instanceof bc)return new bc(e.h,e.s,e.l,e.opacity);if(e instanceof H1||(e=Tw(e)),!e)return new bc;if(e instanceof bc)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,s=Math.min(t,n,r),i=Math.max(t,n,r),a=NaN,o=i-s,l=(i+s)/2;return o?(t===i?a=(n-r)/o+(n<r)*6:n===i?a=(r-t)/o+2:a=(t-n)/o+4,o/=l<.5?i+s:2-i-s,a*=60):o=l>0&&l<1?0:a,new bc(a,o,l,e.opacity)}function VPe(e,t,n,r){return arguments.length===1?IQ(e):new bc(e,t,n,r??1)}function bc(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}BD(bc,VPe,MQ(H1,{brighter(e){return e=e==null?mk:Math.pow(mk,e),new bc(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?kw:Math.pow(kw,e),new bc(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,s=2*n-r;return new ko(SI(e>=240?e-240:e+120,s,r),SI(e,s,r),SI(e<120?e+240:e-120,s,r),this.opacity)},clamp(){return new bc(N7(this.h),WS(this.s),WS(this.l),gk(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=gk(this.opacity);return`${e===1?"hsl(":"hsla("}${N7(this.h)}, ${WS(this.s)*100}%, ${WS(this.l)*100}%${e===1?")":`, ${e})`}`}}));function N7(e){return e=(e||0)%360,e<0?e+360:e}function WS(e){return Math.max(0,Math.min(1,e||0))}function SI(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const $D=e=>()=>e;function jQ(e,t){return function(n){return e+n*t}}function WPe(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function Zut(e,t){var n=t-e;return n?jQ(e,n>180||n<-180?n-360*Math.round(n/360):n):$D(isNaN(e)?t:e)}function HPe(e){return(e=+e)==1?PQ:function(t,n){return n-t?WPe(t,n,e):$D(isNaN(t)?n:t)}}function PQ(e,t){var n=t-e;return n?jQ(e,n):$D(isNaN(e)?t:e)}const M7=function e(t){var n=HPe(t);function r(s,i){var a=n((s=r4(s)).r,(i=r4(i)).r),o=n(s.g,i.g),l=n(s.b,i.b),c=PQ(s.opacity,i.opacity);return function(u){return s.r=a(u),s.g=o(u),s.b=l(u),s.opacity=c(u),s+""}}return r.gamma=e,r}(1);function sh(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var s4=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,CI=new RegExp(s4.source,"g");function GPe(e){return function(){return e}}function KPe(e){return function(t){return e(t)+""}}function YPe(e,t){var n=s4.lastIndex=CI.lastIndex=0,r,s,i,a=-1,o=[],l=[];for(e=e+"",t=t+"";(r=s4.exec(e))&&(s=CI.exec(t));)(i=s.index)>n&&(i=t.slice(n,i),o[a]?o[a]+=i:o[++a]=i),(r=r[0])===(s=s[0])?o[a]?o[a]+=s:o[++a]=s:(o[++a]=null,l.push({i:a,x:sh(r,s)})),n=CI.lastIndex;return n<t.length&&(i=t.slice(n),o[a]?o[a]+=i:o[++a]=i),o.length<2?l[0]?KPe(l[0].x):GPe(t):(t=l.length,function(c){for(var u=0,d;u<t;++u)o[(d=l[u]).i]=d.x(c);return o.join("")})}var I7=180/Math.PI,i4={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function OQ(e,t,n,r,s,i){var a,o,l;return(a=Math.sqrt(e*e+t*t))&&(e/=a,t/=a),(l=e*n+t*r)&&(n-=e*l,r-=t*l),(o=Math.sqrt(n*n+r*r))&&(n/=o,r/=o,l/=o),e*r<t*n&&(e=-e,t=-t,l=-l,a=-a),{translateX:s,translateY:i,rotate:Math.atan2(t,e)*I7,skewX:Math.atan(l)*I7,scaleX:a,scaleY:o}}var HS;function ZPe(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?i4:OQ(t.a,t.b,t.c,t.d,t.e,t.f)}function XPe(e){return e==null||(HS||(HS=document.createElementNS("http://www.w3.org/2000/svg","g")),HS.setAttribute("transform",e),!(e=HS.transform.baseVal.consolidate()))?i4:(e=e.matrix,OQ(e.a,e.b,e.c,e.d,e.e,e.f))}function DQ(e,t,n,r){function s(c){return c.length?c.pop()+" ":""}function i(c,u,d,h,m,y){if(c!==d||u!==h){var b=m.push("translate(",null,t,null,n);y.push({i:b-4,x:sh(c,d)},{i:b-2,x:sh(u,h)})}else(d||h)&&m.push("translate("+d+t+h+n)}function a(c,u,d,h){c!==u?(c-u>180?u+=360:u-c>180&&(c+=360),h.push({i:d.push(s(d)+"rotate(",null,r)-2,x:sh(c,u)})):u&&d.push(s(d)+"rotate("+u+r)}function o(c,u,d,h){c!==u?h.push({i:d.push(s(d)+"skewX(",null,r)-2,x:sh(c,u)}):u&&d.push(s(d)+"skewX("+u+r)}function l(c,u,d,h,m,y){if(c!==d||u!==h){var b=m.push(s(m)+"scale(",null,",",null,")");y.push({i:b-4,x:sh(c,d)},{i:b-2,x:sh(u,h)})}else(d!==1||h!==1)&&m.push(s(m)+"scale("+d+","+h+")")}return function(c,u){var d=[],h=[];return c=e(c),u=e(u),i(c.translateX,c.translateY,u.translateX,u.translateY,d,h),a(c.rotate,u.rotate,d,h),o(c.skewX,u.skewX,d,h),l(c.scaleX,c.scaleY,u.scaleX,u.scaleY,d,h),c=u=null,function(m){for(var y=-1,b=h.length,v;++y<b;)d[(v=h[y]).i]=v.x(m);return d.join("")}}}var JPe=DQ(ZPe,"px, ","px)","deg)"),QPe=DQ(XPe,", ",")",")"),ky=0,Qv=0,Bv=0,FQ=1e3,yk,ex,bk=0,Rm=0,bT=0,Aw=typeof performance=="object"&&performance.now?performance:Date,LQ=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function zD(){return Rm||(LQ(eOe),Rm=Aw.now()+bT)}function eOe(){Rm=0}function vk(){this._call=this._time=this._next=null}vk.prototype=BQ.prototype={constructor:vk,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?zD():+n)+(t==null?0:+t),!this._next&&ex!==this&&(ex?ex._next=this:yk=this,ex=this),this._call=e,this._time=n,a4()},stop:function(){this._call&&(this._call=null,this._time=1/0,a4())}};function BQ(e,t,n){var r=new vk;return r.restart(e,t,n),r}function tOe(){zD(),++ky;for(var e=yk,t;e;)(t=Rm-e._time)>=0&&e._call.call(void 0,t),e=e._next;--ky}function j7(){Rm=(bk=Aw.now())+bT,ky=Qv=0;try{tOe()}finally{ky=0,rOe(),Rm=0}}function nOe(){var e=Aw.now(),t=e-bk;t>FQ&&(bT-=t,bk=e)}function rOe(){for(var e,t=yk,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:yk=n);ex=e,a4(r)}function a4(e){if(!ky){Qv&&(Qv=clearTimeout(Qv));var t=e-Rm;t>24?(e<1/0&&(Qv=setTimeout(j7,e-Aw.now()-bT)),Bv&&(Bv=clearInterval(Bv))):(Bv||(bk=Aw.now(),Bv=setInterval(nOe,FQ)),ky=1,LQ(j7))}}function P7(e,t,n){var r=new vk;return t=t==null?0:+t,r.restart(s=>{r.stop(),e(s+t)},t,n),r}var sOe=bQ("start","end","cancel","interrupt"),iOe=[],$Q=0,O7=1,o4=2,F2=3,D7=4,l4=5,L2=6;function vT(e,t,n,r,s,i){var a=e.__transition;if(!a)e.__transition={};else if(n in a)return;aOe(e,n,{name:t,index:r,group:s,on:sOe,tween:iOe,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:$Q})}function UD(e,t){var n=zc(e,t);if(n.state>$Q)throw new Error("too late; already scheduled");return n}function zu(e,t){var n=zc(e,t);if(n.state>F2)throw new Error("too late; already running");return n}function zc(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function aOe(e,t,n){var r=e.__transition,s;r[t]=n,n.timer=BQ(i,0,n.time);function i(c){n.state=O7,n.timer.restart(a,n.delay,n.time),n.delay<=c&&a(c-n.delay)}function a(c){var u,d,h,m;if(n.state!==O7)return l();for(u in r)if(m=r[u],m.name===n.name){if(m.state===F2)return P7(a);m.state===D7?(m.state=L2,m.timer.stop(),m.on.call("interrupt",e,e.__data__,m.index,m.group),delete r[u]):+u<t&&(m.state=L2,m.timer.stop(),m.on.call("cancel",e,e.__data__,m.index,m.group),delete r[u])}if(P7(function(){n.state===F2&&(n.state=D7,n.timer.restart(o,n.delay,n.time),o(c))}),n.state=o4,n.on.call("start",e,e.__data__,n.index,n.group),n.state===o4){for(n.state=F2,s=new Array(h=n.tween.length),u=0,d=-1;u<h;++u)(m=n.tween[u].value.call(e,e.__data__,n.index,n.group))&&(s[++d]=m);s.length=d+1}}function o(c){for(var u=c<n.duration?n.ease.call(null,c/n.duration):(n.timer.restart(l),n.state=l4,1),d=-1,h=s.length;++d<h;)s[d].call(e,u);n.state===l4&&(n.on.call("end",e,e.__data__,n.index,n.group),l())}function l(){n.state=L2,n.timer.stop(),delete r[t];for(var c in r)return;delete e.__transition}}function oOe(e,t){var n=e.__transition,r,s,i=!0,a;if(n){t=t==null?null:t+"";for(a in n){if((r=n[a]).name!==t){i=!1;continue}s=r.state>o4&&r.state<l4,r.state=L2,r.timer.stop(),r.on.call(s?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[a]}i&&delete e.__transition}}function lOe(e){return this.each(function(){oOe(this,e)})}function cOe(e,t){var n,r;return function(){var s=zu(this,e),i=s.tween;if(i!==n){r=n=i;for(var a=0,o=r.length;a<o;++a)if(r[a].name===t){r=r.slice(),r.splice(a,1);break}}s.tween=r}}function uOe(e,t,n){var r,s;if(typeof n!="function")throw new Error;return function(){var i=zu(this,e),a=i.tween;if(a!==r){s=(r=a).slice();for(var o={name:t,value:n},l=0,c=s.length;l<c;++l)if(s[l].name===t){s[l]=o;break}l===c&&s.push(o)}i.tween=s}}function dOe(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=zc(this.node(),n).tween,s=0,i=r.length,a;s<i;++s)if((a=r[s]).name===e)return a.value;return null}return this.each((t==null?cOe:uOe)(n,e,t))}function qD(e,t,n){var r=e._id;return e.each(function(){var s=zu(this,r);(s.value||(s.value={}))[t]=n.apply(this,arguments)}),function(s){return zc(s,r).value[t]}}function zQ(e,t){var n;return(typeof t=="number"?sh:t instanceof Tw?M7:(n=Tw(t))?(t=n,M7):YPe)(e,t)}function fOe(e){return function(){this.removeAttribute(e)}}function hOe(e){return function(){this.removeAttributeNS(e.space,e.local)}}function pOe(e,t,n){var r,s=n+"",i;return function(){var a=this.getAttribute(e);return a===s?null:a===r?i:i=t(r=a,n)}}function mOe(e,t,n){var r,s=n+"",i;return function(){var a=this.getAttributeNS(e.space,e.local);return a===s?null:a===r?i:i=t(r=a,n)}}function gOe(e,t,n){var r,s,i;return function(){var a,o=n(this),l;return o==null?void this.removeAttribute(e):(a=this.getAttribute(e),l=o+"",a===l?null:a===r&&l===s?i:(s=l,i=t(r=a,o)))}}function yOe(e,t,n){var r,s,i;return function(){var a,o=n(this),l;return o==null?void this.removeAttributeNS(e.space,e.local):(a=this.getAttributeNS(e.space,e.local),l=o+"",a===l?null:a===r&&l===s?i:(s=l,i=t(r=a,o)))}}function bOe(e,t){var n=yT(e),r=n==="transform"?QPe:zQ;return this.attrTween(e,typeof t=="function"?(n.local?yOe:gOe)(n,r,qD(this,"attr."+e,t)):t==null?(n.local?hOe:fOe)(n):(n.local?mOe:pOe)(n,r,t))}function vOe(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function xOe(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function wOe(e,t){var n,r;function s(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&xOe(e,i)),n}return s._value=t,s}function _Oe(e,t){var n,r;function s(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&vOe(e,i)),n}return s._value=t,s}function SOe(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=yT(e);return this.tween(n,(r.local?wOe:_Oe)(r,t))}function COe(e,t){return function(){UD(this,e).delay=+t.apply(this,arguments)}}function kOe(e,t){return t=+t,function(){UD(this,e).delay=t}}function EOe(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?COe:kOe)(t,e)):zc(this.node(),t).delay}function TOe(e,t){return function(){zu(this,e).duration=+t.apply(this,arguments)}}function AOe(e,t){return t=+t,function(){zu(this,e).duration=t}}function ROe(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?TOe:AOe)(t,e)):zc(this.node(),t).duration}function NOe(e,t){if(typeof t!="function")throw new Error;return function(){zu(this,e).ease=t}}function MOe(e){var t=this._id;return arguments.length?this.each(NOe(t,e)):zc(this.node(),t).ease}function IOe(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;zu(this,e).ease=n}}function jOe(e){if(typeof e!="function")throw new Error;return this.each(IOe(this._id,e))}function POe(e){typeof e!="function"&&(e=wQ(e));for(var t=this._groups,n=t.length,r=new Array(n),s=0;s<n;++s)for(var i=t[s],a=i.length,o=r[s]=[],l,c=0;c<a;++c)(l=i[c])&&e.call(l,l.__data__,c,i)&&o.push(l);return new Gd(r,this._parents,this._name,this._id)}function OOe(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,s=n.length,i=Math.min(r,s),a=new Array(r),o=0;o<i;++o)for(var l=t[o],c=n[o],u=l.length,d=a[o]=new Array(u),h,m=0;m<u;++m)(h=l[m]||c[m])&&(d[m]=h);for(;o<r;++o)a[o]=t[o];return new Gd(a,this._parents,this._name,this._id)}function DOe(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function FOe(e,t,n){var r,s,i=DOe(t)?UD:zu;return function(){var a=i(this,e),o=a.on;o!==r&&(s=(r=o).copy()).on(t,n),a.on=s}}function LOe(e,t){var n=this._id;return arguments.length<2?zc(this.node(),n).on.on(e):this.each(FOe(n,e,t))}function BOe(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function $Oe(){return this.on("end.remove",BOe(this._id))}function zOe(e){var t=this._name,n=this._id;typeof e!="function"&&(e=FD(e));for(var r=this._groups,s=r.length,i=new Array(s),a=0;a<s;++a)for(var o=r[a],l=o.length,c=i[a]=new Array(l),u,d,h=0;h<l;++h)(u=o[h])&&(d=e.call(u,u.__data__,h,o))&&("__data__"in u&&(d.__data__=u.__data__),c[h]=d,vT(c[h],t,n,h,c,zc(u,n)));return new Gd(i,this._parents,t,n)}function UOe(e){var t=this._name,n=this._id;typeof e!="function"&&(e=xQ(e));for(var r=this._groups,s=r.length,i=[],a=[],o=0;o<s;++o)for(var l=r[o],c=l.length,u,d=0;d<c;++d)if(u=l[d]){for(var h=e.call(u,u.__data__,d,l),m,y=zc(u,n),b=0,v=h.length;b<v;++b)(m=h[b])&&vT(m,t,n,b,h,y);i.push(h),a.push(u)}return new Gd(i,a,t,n)}var qOe=W1.prototype.constructor;function VOe(){return new qOe(this._groups,this._parents)}function WOe(e,t){var n,r,s;return function(){var i=Cy(this,e),a=(this.style.removeProperty(e),Cy(this,e));return i===a?null:i===n&&a===r?s:s=t(n=i,r=a)}}function UQ(e){return function(){this.style.removeProperty(e)}}function HOe(e,t,n){var r,s=n+"",i;return function(){var a=Cy(this,e);return a===s?null:a===r?i:i=t(r=a,n)}}function GOe(e,t,n){var r,s,i;return function(){var a=Cy(this,e),o=n(this),l=o+"";return o==null&&(l=o=(this.style.removeProperty(e),Cy(this,e))),a===l?null:a===r&&l===s?i:(s=l,i=t(r=a,o))}}function KOe(e,t){var n,r,s,i="style."+t,a="end."+i,o;return function(){var l=zu(this,e),c=l.on,u=l.value[i]==null?o||(o=UQ(t)):void 0;(c!==n||s!==u)&&(r=(n=c).copy()).on(a,s=u),l.on=r}}function YOe(e,t,n){var r=(e+="")=="transform"?JPe:zQ;return t==null?this.styleTween(e,WOe(e,r)).on("end.style."+e,UQ(e)):typeof t=="function"?this.styleTween(e,GOe(e,r,qD(this,"style."+e,t))).each(KOe(this._id,e)):this.styleTween(e,HOe(e,r,t),n).on("end.style."+e,null)}function ZOe(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function XOe(e,t,n){var r,s;function i(){var a=t.apply(this,arguments);return a!==s&&(r=(s=a)&&ZOe(e,a,n)),r}return i._value=t,i}function JOe(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,XOe(e,t,n??""))}function QOe(e){return function(){this.textContent=e}}function eDe(e){return function(){var t=e(this);this.textContent=t??""}}function tDe(e){return this.tween("text",typeof e=="function"?eDe(qD(this,"text",e)):QOe(e==null?"":e+""))}function nDe(e){return function(t){this.textContent=e.call(this,t)}}function rDe(e){var t,n;function r(){var s=e.apply(this,arguments);return s!==n&&(t=(n=s)&&nDe(s)),t}return r._value=e,r}function sDe(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,rDe(e))}function iDe(){for(var e=this._name,t=this._id,n=qQ(),r=this._groups,s=r.length,i=0;i<s;++i)for(var a=r[i],o=a.length,l,c=0;c<o;++c)if(l=a[c]){var u=zc(l,t);vT(l,e,n,c,a,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new Gd(r,this._parents,e,n)}function aDe(){var e,t,n=this,r=n._id,s=n.size();return new Promise(function(i,a){var o={value:a},l={value:function(){--s===0&&i()}};n.each(function(){var c=zu(this,r),u=c.on;u!==e&&(t=(e=u).copy(),t._.cancel.push(o),t._.interrupt.push(o),t._.end.push(l)),c.on=t}),s===0&&i()})}var oDe=0;function Gd(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function qQ(){return++oDe}var yd=W1.prototype;Gd.prototype={constructor:Gd,select:zOe,selectAll:UOe,selectChild:yd.selectChild,selectChildren:yd.selectChildren,filter:POe,merge:OOe,selection:VOe,transition:iDe,call:yd.call,nodes:yd.nodes,node:yd.node,size:yd.size,empty:yd.empty,each:yd.each,on:LOe,attr:bOe,attrTween:SOe,style:YOe,styleTween:JOe,text:tDe,textTween:sDe,remove:$Oe,tween:dOe,delay:EOe,duration:ROe,ease:MOe,easeVarying:jOe,end:aDe,[Symbol.iterator]:yd[Symbol.iterator]};function lDe(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var cDe={time:null,delay:0,duration:250,ease:lDe};function uDe(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function dDe(e){var t,n;e instanceof Gd?(t=e._id,e=e._name):(t=qQ(),(n=cDe).time=zD(),e=e==null?null:e+"");for(var r=this._groups,s=r.length,i=0;i<s;++i)for(var a=r[i],o=a.length,l,c=0;c<o;++c)(l=a[c])&&vT(l,e,t,c,a,n||uDe(l,t));return new Gd(r,this._parents,e,t)}W1.prototype.interrupt=lOe;W1.prototype.transition=dDe;const c4=Math.PI,u4=2*c4,Vp=1e-6,fDe=u4-Vp;function VQ(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function hDe(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return VQ;const n=10**t;return function(r){this._+=r[0];for(let s=1,i=r.length;s<i;++s)this._+=Math.round(arguments[s]*n)/n+r[s]}}class pDe{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?VQ:hDe(t)}moveTo(t,n){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,n){this._append`L${this._x1=+t},${this._y1=+n}`}quadraticCurveTo(t,n,r,s){this._append`Q${+t},${+n},${this._x1=+r},${this._y1=+s}`}bezierCurveTo(t,n,r,s,i,a){this._append`C${+t},${+n},${+r},${+s},${this._x1=+i},${this._y1=+a}`}arcTo(t,n,r,s,i){if(t=+t,n=+n,r=+r,s=+s,i=+i,i<0)throw new Error(`negative radius: ${i}`);let a=this._x1,o=this._y1,l=r-t,c=s-n,u=a-t,d=o-n,h=u*u+d*d;if(this._x1===null)this._append`M${this._x1=t},${this._y1=n}`;else if(h>Vp)if(!(Math.abs(d*l-c*u)>Vp)||!i)this._append`L${this._x1=t},${this._y1=n}`;else{let m=r-a,y=s-o,b=l*l+c*c,v=m*m+y*y,x=Math.sqrt(b),w=Math.sqrt(h),S=i*Math.tan((c4-Math.acos((b+h-v)/(2*x*w)))/2),C=S/w,k=S/x;Math.abs(C-1)>Vp&&this._append`L${t+C*u},${n+C*d}`,this._append`A${i},${i},0,0,${+(d*m>u*y)},${this._x1=t+k*l},${this._y1=n+k*c}`}}arc(t,n,r,s,i,a){if(t=+t,n=+n,r=+r,a=!!a,r<0)throw new Error(`negative radius: ${r}`);let o=r*Math.cos(s),l=r*Math.sin(s),c=t+o,u=n+l,d=1^a,h=a?s-i:i-s;this._x1===null?this._append`M${c},${u}`:(Math.abs(this._x1-c)>Vp||Math.abs(this._y1-u)>Vp)&&this._append`L${c},${u}`,r&&(h<0&&(h=h%u4+u4),h>fDe?this._append`A${r},${r},0,1,${d},${t-o},${n-l}A${r},${r},0,1,${d},${this._x1=c},${this._y1=u}`:h>Vp&&this._append`A${r},${r},0,${+(h>=c4)},${d},${this._x1=t+r*Math.cos(i)},${this._y1=n+r*Math.sin(i)}`)}rect(t,n,r,s){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${r=+r}v${+s}h${-r}Z`}toString(){return this._}}function e0(e){return function(){return e}}const Xut=Math.abs,Jut=Math.atan2,Qut=Math.cos,edt=Math.max,tdt=Math.min,ndt=Math.sin,rdt=Math.sqrt,F7=1e-12,VD=Math.PI,L7=VD/2,sdt=2*VD;function idt(e){return e>1?0:e<-1?VD:Math.acos(e)}function adt(e){return e>=1?L7:e<=-1?-L7:Math.asin(e)}function mDe(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(n==null)t=null;else{const r=Math.floor(n);if(!(r>=0))throw new RangeError(`invalid digits: ${n}`);t=r}return e},()=>new pDe(t)}function gDe(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function WQ(e){this._context=e}WQ.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function xk(e){return new WQ(e)}function yDe(e){return e[0]}function bDe(e){return e[1]}function vDe(e,t){var n=e0(!0),r=null,s=xk,i=null,a=mDe(o);e=typeof e=="function"?e:e===void 0?yDe:e0(e),t=typeof t=="function"?t:t===void 0?bDe:e0(t);function o(l){var c,u=(l=gDe(l)).length,d,h=!1,m;for(r==null&&(i=s(m=a())),c=0;c<=u;++c)!(c<u&&n(d=l[c],c,l))===h&&((h=!h)?i.lineStart():i.lineEnd()),h&&i.point(+e(d,c,l),+t(d,c,l));if(m)return i=null,m+""||null}return o.x=function(l){return arguments.length?(e=typeof l=="function"?l:e0(+l),o):e},o.y=function(l){return arguments.length?(t=typeof l=="function"?l:e0(+l),o):t},o.defined=function(l){return arguments.length?(n=typeof l=="function"?l:e0(!!l),o):n},o.curve=function(l){return arguments.length?(s=l,r!=null&&(i=s(r)),o):s},o.context=function(l){return arguments.length?(l==null?r=i=null:i=s(r=l),o):r},o}class HQ{constructor(t,n){this._context=t,this._x=n}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,n){switch(t=+t,n=+n,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,n,t,n):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+n)/2,t,this._y0,t,n);break}}this._x0=t,this._y0=n}}function GQ(e){return new HQ(e,!0)}function KQ(e){return new HQ(e,!1)}function Nh(){}function wk(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function xT(e){this._context=e}xT.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:wk(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:wk(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function B2(e){return new xT(e)}function YQ(e){this._context=e}YQ.prototype={areaStart:Nh,areaEnd:Nh,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:wk(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function xDe(e){return new YQ(e)}function ZQ(e){this._context=e}ZQ.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:wk(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function wDe(e){return new ZQ(e)}function XQ(e,t){this._basis=new xT(e),this._beta=t}XQ.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var r=e[0],s=t[0],i=e[n]-r,a=t[n]-s,o=-1,l;++o<=n;)l=o/n,this._basis.point(this._beta*e[o]+(1-this._beta)*(r+l*i),this._beta*t[o]+(1-this._beta)*(s+l*a));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};const _De=function e(t){function n(r){return t===1?new xT(r):new XQ(r,t)}return n.beta=function(r){return e(+r)},n}(.85);function _k(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function WD(e,t){this._context=e,this._k=(1-t)/6}WD.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:_k(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:_k(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const JQ=function e(t){function n(r){return new WD(r,t)}return n.tension=function(r){return e(+r)},n}(0);function HD(e,t){this._context=e,this._k=(1-t)/6}HD.prototype={areaStart:Nh,areaEnd:Nh,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:_k(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const SDe=function e(t){function n(r){return new HD(r,t)}return n.tension=function(r){return e(+r)},n}(0);function GD(e,t){this._context=e,this._k=(1-t)/6}GD.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:_k(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const CDe=function e(t){function n(r){return new GD(r,t)}return n.tension=function(r){return e(+r)},n}(0);function KD(e,t,n){var r=e._x1,s=e._y1,i=e._x2,a=e._y2;if(e._l01_a>F7){var o=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,l=3*e._l01_a*(e._l01_a+e._l12_a);r=(r*o-e._x0*e._l12_2a+e._x2*e._l01_2a)/l,s=(s*o-e._y0*e._l12_2a+e._y2*e._l01_2a)/l}if(e._l23_a>F7){var c=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,u=3*e._l23_a*(e._l23_a+e._l12_a);i=(i*c+e._x1*e._l23_2a-t*e._l12_2a)/u,a=(a*c+e._y1*e._l23_2a-n*e._l12_2a)/u}e._context.bezierCurveTo(r,s,i,a,e._x2,e._y2)}function QQ(e,t){this._context=e,this._alpha=t}QQ.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:KD(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const eee=function e(t){function n(r){return t?new QQ(r,t):new WD(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function tee(e,t){this._context=e,this._alpha=t}tee.prototype={areaStart:Nh,areaEnd:Nh,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:KD(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const kDe=function e(t){function n(r){return t?new tee(r,t):new HD(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function nee(e,t){this._context=e,this._alpha=t}nee.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:KD(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const EDe=function e(t){function n(r){return t?new nee(r,t):new GD(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function ree(e){this._context=e}ree.prototype={areaStart:Nh,areaEnd:Nh,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function TDe(e){return new ree(e)}function B7(e){return e<0?-1:1}function $7(e,t,n){var r=e._x1-e._x0,s=t-e._x1,i=(e._y1-e._y0)/(r||s<0&&-0),a=(n-e._y1)/(s||r<0&&-0),o=(i*s+a*r)/(r+s);return(B7(i)+B7(a))*Math.min(Math.abs(i),Math.abs(a),.5*Math.abs(o))||0}function z7(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function kI(e,t,n){var r=e._x0,s=e._y0,i=e._x1,a=e._y1,o=(i-r)/3;e._context.bezierCurveTo(r+o,s+o*t,i-o,a-o*n,i,a)}function Sk(e){this._context=e}Sk.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:kI(this,this._t0,z7(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,kI(this,z7(this,n=$7(this,e,t)),n);break;default:kI(this,this._t0,n=$7(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function see(e){this._context=new iee(e)}(see.prototype=Object.create(Sk.prototype)).point=function(e,t){Sk.prototype.point.call(this,t,e)};function iee(e){this._context=e}iee.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,s,i){this._context.bezierCurveTo(t,e,r,n,i,s)}};function aee(e){return new Sk(e)}function oee(e){return new see(e)}function lee(e){this._context=e}lee.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var r=U7(e),s=U7(t),i=0,a=1;a<n;++i,++a)this._context.bezierCurveTo(r[0][i],s[0][i],r[1][i],s[1][i],e[a],t[a]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function U7(e){var t,n=e.length-1,r,s=new Array(n),i=new Array(n),a=new Array(n);for(s[0]=0,i[0]=2,a[0]=e[0]+2*e[1],t=1;t<n-1;++t)s[t]=1,i[t]=4,a[t]=4*e[t]+2*e[t+1];for(s[n-1]=2,i[n-1]=7,a[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)r=s[t]/i[t-1],i[t]-=r,a[t]-=r*a[t-1];for(s[n-1]=a[n-1]/i[n-1],t=n-2;t>=0;--t)s[t]=(a[t]-s[t+1])/i[t];for(i[n-1]=(e[n]+s[n-1])/2,t=0;t<n-1;++t)i[t]=2*e[t+1]-s[t+1];return[s,i]}function cee(e){return new lee(e)}function wT(e,t){this._context=e,this._t=t}wT.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function uee(e){return new wT(e,.5)}function dee(e){return new wT(e,0)}function fee(e){return new wT(e,1)}function tx(e,t,n){this.k=e,this.x=t,this.y=n}tx.prototype={constructor:tx,scale:function(e){return e===1?this:new tx(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new tx(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};tx.prototype;const y0=globalThis||void 0||self;var hee=typeof y0=="object"&&y0&&y0.Object===Object&&y0,ADe=typeof self=="object"&&self&&self.Object===Object&&self,Uu=hee||ADe||Function("return this")(),Ck=Uu.Symbol,pee=Object.prototype,RDe=pee.hasOwnProperty,NDe=pee.toString,$v=Ck?Ck.toStringTag:void 0;function MDe(e){var t=RDe.call(e,$v),n=e[$v];try{e[$v]=void 0;var r=!0}catch{}var s=NDe.call(e);return r&&(t?e[$v]=n:delete e[$v]),s}var IDe=Object.prototype,jDe=IDe.toString;function PDe(e){return jDe.call(e)}var ODe="[object Null]",DDe="[object Undefined]",q7=Ck?Ck.toStringTag:void 0;function sb(e){return e==null?e===void 0?DDe:ODe:q7&&q7 in Object(e)?MDe(e):PDe(e)}function Xm(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var FDe="[object AsyncFunction]",LDe="[object Function]",BDe="[object GeneratorFunction]",$De="[object Proxy]";function YD(e){if(!Xm(e))return!1;var t=sb(e);return t==LDe||t==BDe||t==FDe||t==$De}var EI=Uu["__core-js_shared__"],V7=function(){var e=/[^.]+$/.exec(EI&&EI.keys&&EI.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function zDe(e){return!!V7&&V7 in e}var UDe=Function.prototype,qDe=UDe.toString;function Jm(e){if(e!=null){try{return qDe.call(e)}catch{}try{return e+""}catch{}}return""}var VDe=/[\\^$.*+?()[\]{}|]/g,WDe=/^\[object .+?Constructor\]$/,HDe=Function.prototype,GDe=Object.prototype,KDe=HDe.toString,YDe=GDe.hasOwnProperty,ZDe=RegExp("^"+KDe.call(YDe).replace(VDe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function XDe(e){if(!Xm(e)||zDe(e))return!1;var t=YD(e)?ZDe:WDe;return t.test(Jm(e))}function JDe(e,t){return e==null?void 0:e[t]}function Qm(e,t){var n=JDe(e,t);return XDe(n)?n:void 0}var Rw=Qm(Object,"create");function QDe(){this.__data__=Rw?Rw(null):{},this.size=0}function e6e(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var t6e="__lodash_hash_undefined__",n6e=Object.prototype,r6e=n6e.hasOwnProperty;function s6e(e){var t=this.__data__;if(Rw){var n=t[e];return n===t6e?void 0:n}return r6e.call(t,e)?t[e]:void 0}var i6e=Object.prototype,a6e=i6e.hasOwnProperty;function o6e(e){var t=this.__data__;return Rw?t[e]!==void 0:a6e.call(t,e)}var l6e="__lodash_hash_undefined__";function c6e(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=Rw&&t===void 0?l6e:t,this}function Nm(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}Nm.prototype.clear=QDe;Nm.prototype.delete=e6e;Nm.prototype.get=s6e;Nm.prototype.has=o6e;Nm.prototype.set=c6e;function u6e(){this.__data__=[],this.size=0}function _T(e,t){return e===t||e!==e&&t!==t}function ST(e,t){for(var n=e.length;n--;)if(_T(e[n][0],t))return n;return-1}var d6e=Array.prototype,f6e=d6e.splice;function h6e(e){var t=this.__data__,n=ST(t,e);if(n<0)return!1;var r=t.length-1;return n==r?t.pop():f6e.call(t,n,1),--this.size,!0}function p6e(e){var t=this.__data__,n=ST(t,e);return n<0?void 0:t[n][1]}function m6e(e){return ST(this.__data__,e)>-1}function g6e(e,t){var n=this.__data__,r=ST(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this}function rf(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}rf.prototype.clear=u6e;rf.prototype.delete=h6e;rf.prototype.get=p6e;rf.prototype.has=m6e;rf.prototype.set=g6e;var Nw=Qm(Uu,"Map");function y6e(){this.size=0,this.__data__={hash:new Nm,map:new(Nw||rf),string:new Nm}}function b6e(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function CT(e,t){var n=e.__data__;return b6e(t)?n[typeof t=="string"?"string":"hash"]:n.map}function v6e(e){var t=CT(this,e).delete(e);return this.size-=t?1:0,t}function x6e(e){return CT(this,e).get(e)}function w6e(e){return CT(this,e).has(e)}function _6e(e,t){var n=CT(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this}function Xh(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}Xh.prototype.clear=y6e;Xh.prototype.delete=v6e;Xh.prototype.get=x6e;Xh.prototype.has=w6e;Xh.prototype.set=_6e;var S6e="Expected a function";function G1(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(S6e);var n=function(){var r=arguments,s=t?t.apply(this,r):r[0],i=n.cache;if(i.has(s))return i.get(s);var a=e.apply(this,r);return n.cache=i.set(s,a)||i,a};return n.cache=new(G1.Cache||Xh),n}G1.Cache=Xh;function C6e(){this.__data__=new rf,this.size=0}function k6e(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}function E6e(e){return this.__data__.get(e)}function T6e(e){return this.__data__.has(e)}var A6e=200;function R6e(e,t){var n=this.__data__;if(n instanceof rf){var r=n.__data__;if(!Nw||r.length<A6e-1)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new Xh(r)}return n.set(e,t),this.size=n.size,this}function ib(e){var t=this.__data__=new rf(e);this.size=t.size}ib.prototype.clear=C6e;ib.prototype.delete=k6e;ib.prototype.get=E6e;ib.prototype.has=T6e;ib.prototype.set=R6e;var kk=function(){try{var e=Qm(Object,"defineProperty");return e({},"",{}),e}catch{}}();function ZD(e,t,n){t=="__proto__"&&kk?kk(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function d4(e,t,n){(n!==void 0&&!_T(e[t],n)||n===void 0&&!(t in e))&&ZD(e,t,n)}function N6e(e){return function(t,n,r){for(var s=-1,i=Object(t),a=r(t),o=a.length;o--;){var l=a[++s];if(n(i[l],l,i)===!1)break}return t}}var M6e=N6e(),mee=typeof exports=="object"&&exports&&!exports.nodeType&&exports,W7=mee&&typeof module=="object"&&module&&!module.nodeType&&module,I6e=W7&&W7.exports===mee,H7=I6e?Uu.Buffer:void 0,G7=H7?H7.allocUnsafe:void 0;function j6e(e,t){if(t)return e.slice();var n=e.length,r=G7?G7(n):new e.constructor(n);return e.copy(r),r}var K7=Uu.Uint8Array;function P6e(e){var t=new e.constructor(e.byteLength);return new K7(t).set(new K7(e)),t}function O6e(e,t){var n=t?P6e(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function D6e(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}var Y7=Object.create,F6e=function(){function e(){}return function(t){if(!Xm(t))return{};if(Y7)return Y7(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();function gee(e,t){return function(n){return e(t(n))}}var yee=gee(Object.getPrototypeOf,Object),L6e=Object.prototype;function kT(e){var t=e&&e.constructor,n=typeof t=="function"&&t.prototype||L6e;return e===n}function B6e(e){return typeof e.constructor=="function"&&!kT(e)?F6e(yee(e)):{}}function K1(e){return e!=null&&typeof e=="object"}var $6e="[object Arguments]";function Z7(e){return K1(e)&&sb(e)==$6e}var bee=Object.prototype,z6e=bee.hasOwnProperty,U6e=bee.propertyIsEnumerable,Ek=Z7(function(){return arguments}())?Z7:function(e){return K1(e)&&z6e.call(e,"callee")&&!U6e.call(e,"callee")},Tk=Array.isArray,q6e=9007199254740991;function vee(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=q6e}function ET(e){return e!=null&&vee(e.length)&&!YD(e)}function V6e(e){return K1(e)&&ET(e)}function W6e(){return!1}var xee=typeof exports=="object"&&exports&&!exports.nodeType&&exports,X7=xee&&typeof module=="object"&&module&&!module.nodeType&&module,H6e=X7&&X7.exports===xee,J7=H6e?Uu.Buffer:void 0,G6e=J7?J7.isBuffer:void 0,XD=G6e||W6e,K6e="[object Object]",Y6e=Function.prototype,Z6e=Object.prototype,wee=Y6e.toString,X6e=Z6e.hasOwnProperty,J6e=wee.call(Object);function Q6e(e){if(!K1(e)||sb(e)!=K6e)return!1;var t=yee(e);if(t===null)return!0;var n=X6e.call(t,"constructor")&&t.constructor;return typeof n=="function"&&n instanceof n&&wee.call(n)==J6e}var e5e="[object Arguments]",t5e="[object Array]",n5e="[object Boolean]",r5e="[object Date]",s5e="[object Error]",i5e="[object Function]",a5e="[object Map]",o5e="[object Number]",l5e="[object Object]",c5e="[object RegExp]",u5e="[object Set]",d5e="[object String]",f5e="[object WeakMap]",h5e="[object ArrayBuffer]",p5e="[object DataView]",m5e="[object Float32Array]",g5e="[object Float64Array]",y5e="[object Int8Array]",b5e="[object Int16Array]",v5e="[object Int32Array]",x5e="[object Uint8Array]",w5e="[object Uint8ClampedArray]",_5e="[object Uint16Array]",S5e="[object Uint32Array]",Bs={};Bs[m5e]=Bs[g5e]=Bs[y5e]=Bs[b5e]=Bs[v5e]=Bs[x5e]=Bs[w5e]=Bs[_5e]=Bs[S5e]=!0;Bs[e5e]=Bs[t5e]=Bs[h5e]=Bs[n5e]=Bs[p5e]=Bs[r5e]=Bs[s5e]=Bs[i5e]=Bs[a5e]=Bs[o5e]=Bs[l5e]=Bs[c5e]=Bs[u5e]=Bs[d5e]=Bs[f5e]=!1;function C5e(e){return K1(e)&&vee(e.length)&&!!Bs[sb(e)]}function k5e(e){return function(t){return e(t)}}var _ee=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Sx=_ee&&typeof module=="object"&&module&&!module.nodeType&&module,E5e=Sx&&Sx.exports===_ee,TI=E5e&&hee.process,Q7=function(){try{var e=Sx&&Sx.require&&Sx.require("util").types;return e||TI&&TI.binding&&TI.binding("util")}catch{}}(),eU=Q7&&Q7.isTypedArray,JD=eU?k5e(eU):C5e;function f4(e,t){if(!(t==="constructor"&&typeof e[t]=="function")&&t!="__proto__")return e[t]}var T5e=Object.prototype,A5e=T5e.hasOwnProperty;function R5e(e,t,n){var r=e[t];(!(A5e.call(e,t)&&_T(r,n))||n===void 0&&!(t in e))&&ZD(e,t,n)}function N5e(e,t,n,r){var s=!n;n||(n={});for(var i=-1,a=t.length;++i<a;){var o=t[i],l=void 0;l===void 0&&(l=e[o]),s?ZD(n,o,l):R5e(n,o,l)}return n}function M5e(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}var I5e=9007199254740991,j5e=/^(?:0|[1-9]\d*)$/;function See(e,t){var n=typeof e;return t=t??I5e,!!t&&(n=="number"||n!="symbol"&&j5e.test(e))&&e>-1&&e%1==0&&e<t}var P5e=Object.prototype,O5e=P5e.hasOwnProperty;function D5e(e,t){var n=Tk(e),r=!n&&Ek(e),s=!n&&!r&&XD(e),i=!n&&!r&&!s&&JD(e),a=n||r||s||i,o=a?M5e(e.length,String):[],l=o.length;for(var c in e)(t||O5e.call(e,c))&&!(a&&(c=="length"||s&&(c=="offset"||c=="parent")||i&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||See(c,l)))&&o.push(c);return o}function F5e(e){var t=[];if(e!=null)for(var n in Object(e))t.push(n);return t}var L5e=Object.prototype,B5e=L5e.hasOwnProperty;function $5e(e){if(!Xm(e))return F5e(e);var t=kT(e),n=[];for(var r in e)r=="constructor"&&(t||!B5e.call(e,r))||n.push(r);return n}function Cee(e){return ET(e)?D5e(e,!0):$5e(e)}function z5e(e){return N5e(e,Cee(e))}function U5e(e,t,n,r,s,i,a){var o=f4(e,n),l=f4(t,n),c=a.get(l);if(c){d4(e,n,c);return}var u=i?i(o,l,n+"",e,t,a):void 0,d=u===void 0;if(d){var h=Tk(l),m=!h&&XD(l),y=!h&&!m&&JD(l);u=l,h||m||y?Tk(o)?u=o:V6e(o)?u=D6e(o):m?(d=!1,u=j6e(l,!0)):y?(d=!1,u=O6e(l,!0)):u=[]:Q6e(l)||Ek(l)?(u=o,Ek(o)?u=z5e(o):(!Xm(o)||YD(o))&&(u=B6e(l))):d=!1}d&&(a.set(l,u),s(u,l,r,i,a),a.delete(l)),d4(e,n,u)}function kee(e,t,n,r,s){e!==t&&M6e(t,function(i,a){if(s||(s=new ib),Xm(i))U5e(e,t,a,n,kee,r,s);else{var o=r?r(f4(e,a),i,a+"",e,t,s):void 0;o===void 0&&(o=i),d4(e,a,o)}},Cee)}function Eee(e){return e}function q5e(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}var tU=Math.max;function V5e(e,t,n){return t=tU(t===void 0?e.length-1:t,0),function(){for(var r=arguments,s=-1,i=tU(r.length-t,0),a=Array(i);++s<i;)a[s]=r[t+s];s=-1;for(var o=Array(t+1);++s<t;)o[s]=r[s];return o[t]=n(a),q5e(e,this,o)}}function W5e(e){return function(){return e}}var H5e=kk?function(e,t){return kk(e,"toString",{configurable:!0,enumerable:!1,value:W5e(t),writable:!0})}:Eee,G5e=800,K5e=16,Y5e=Date.now;function Z5e(e){var t=0,n=0;return function(){var r=Y5e(),s=K5e-(r-n);if(n=r,s>0){if(++t>=G5e)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var X5e=Z5e(H5e);function J5e(e,t){return X5e(V5e(e,t,Eee),e+"")}function Q5e(e,t,n){if(!Xm(n))return!1;var r=typeof t;return(r=="number"?ET(n)&&See(t,n.length):r=="string"&&t in n)?_T(n[t],e):!1}function eFe(e){return J5e(function(t,n){var r=-1,s=n.length,i=s>1?n[s-1]:void 0,a=s>2?n[2]:void 0;for(i=e.length>3&&typeof i=="function"?(s--,i):void 0,a&&Q5e(n[0],n[1],a)&&(i=s<3?void 0:i,s=1),t=Object(t);++r<s;){var o=n[r];o&&e(t,o,r,i)}return t})}var tFe=eFe(function(e,t,n){kee(e,t,n)}),nFe="​",rFe={curveBasis:B2,curveBasisClosed:xDe,curveBasisOpen:wDe,curveBumpX:GQ,curveBumpY:KQ,curveBundle:_De,curveCardinalClosed:SDe,curveCardinalOpen:CDe,curveCardinal:JQ,curveCatmullRomClosed:kDe,curveCatmullRomOpen:EDe,curveCatmullRom:eee,curveLinear:xk,curveLinearClosed:TDe,curveMonotoneX:aee,curveMonotoneY:oee,curveNatural:cee,curveStep:uee,curveStepAfter:fee,curveStepBefore:dee},sFe=/\s*(?:(\w+)(?=:):|(\w+))\s*(?:(\w+)|((?:(?!}%{2}).|\r?\n)*))?\s*(?:}%{2})?/gi,iFe=ie(function(e,t){const n=Tee(e,/(?:init\b)|(?:initialize\b)/);let r={};if(Array.isArray(n)){const a=n.map(o=>o.args);rk(a),r=xa(r,[...a])}else r=n.args;if(!r)return;let s=_D(e,t);const i="config";return r[i]!==void 0&&(s==="flowchart-v2"&&(s="flowchart"),r[s]=r[i],delete r[i]),r},"detectInit"),Tee=ie(function(e,t=null){var n,r;try{const s=new RegExp(`[%]{2}(?![{]${sFe.source})(?=[}][%]{2}).*
`,"ig");e=e.trim().replace(s,"").replace(/'/gm,'"'),zt.debug(`Detecting diagram directive${t!==null?" type:"+t:""} based on the text:${e}`);let i;const a=[];for(;(i=wx.exec(e))!==null;)if(i.index===wx.lastIndex&&wx.lastIndex++,i&&!t||t&&((n=i[1])!=null&&n.match(t))||t&&((r=i[2])!=null&&r.match(t))){const o=i[1]?i[1]:i[2],l=i[3]?i[3].trim():i[4]?JSON.parse(i[4].trim()):null;a.push({type:o,args:l})}return a.length===0?{type:e,args:null}:a.length===1?a[0]:a}catch(s){return zt.error(`ERROR: ${s.message} - Unable to parse directive type: '${t}' based on the text: '${e}'`),{type:void 0,args:null}}},"detectDirective"),aFe=ie(function(e){return e.replace(wx,"")},"removeDirectives"),oFe=ie(function(e,t){for(const[n,r]of t.entries())if(r.match(e))return n;return-1},"isSubstringInArray");function QD(e,t){if(!e)return t;const n=`curve${e.charAt(0).toUpperCase()+e.slice(1)}`;return rFe[n]??t}ie(QD,"interpolateToCurve");function Aee(e,t){const n=e.trim();if(n)return t.securityLevel!=="loose"?Xje.sanitizeUrl(n):n}ie(Aee,"formatUrl");var lFe=ie((e,...t)=>{const n=e.split("."),r=n.length-1,s=n[r];let i=window;for(let a=0;a<r;a++)if(i=i[n[a]],!i){zt.error(`Function name: ${e} not found in window`);return}i[s](...t)},"runFunc");function e6(e,t){return!e||!t?0:Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}ie(e6,"distance");function Ree(e){let t,n=0;e.forEach(s=>{n+=e6(s,t),t=s});const r=n/2;return t6(e,r)}ie(Ree,"traverseEdge");function Nee(e){return e.length===1?e[0]:Ree(e)}ie(Nee,"calcLabelPosition");var nU=ie((e,t=2)=>{const n=Math.pow(10,t);return Math.round(e*n)/n},"roundNumber"),t6=ie((e,t)=>{let n,r=t;for(const s of e){if(n){const i=e6(s,n);if(i===0)return n;if(i<r)r-=i;else{const a=r/i;if(a<=0)return n;if(a>=1)return{x:s.x,y:s.y};if(a>0&&a<1)return{x:nU((1-a)*n.x+a*s.x,5),y:nU((1-a)*n.y+a*s.y,5)}}}n=s}throw new Error("Could not find a suitable point for the given distance")},"calculatePoint"),cFe=ie((e,t,n)=>{zt.info(`our points ${JSON.stringify(t)}`),t[0]!==n&&(t=t.reverse());const s=t6(t,25),i=e?10:5,a=Math.atan2(t[0].y-s.y,t[0].x-s.x),o={x:0,y:0};return o.x=Math.sin(a)*i+(t[0].x+s.x)/2,o.y=-Math.cos(a)*i+(t[0].y+s.y)/2,o},"calcCardinalityPosition");function Mee(e,t,n){const r=structuredClone(n);zt.info("our points",r),t!=="start_left"&&t!=="start_right"&&r.reverse();const s=25+e,i=t6(r,s),a=10+e*.5,o=Math.atan2(r[0].y-i.y,r[0].x-i.x),l={x:0,y:0};return t==="start_left"?(l.x=Math.sin(o+Math.PI)*a+(r[0].x+i.x)/2,l.y=-Math.cos(o+Math.PI)*a+(r[0].y+i.y)/2):t==="end_right"?(l.x=Math.sin(o-Math.PI)*a+(r[0].x+i.x)/2-5,l.y=-Math.cos(o-Math.PI)*a+(r[0].y+i.y)/2-5):t==="end_left"?(l.x=Math.sin(o)*a+(r[0].x+i.x)/2-5,l.y=-Math.cos(o)*a+(r[0].y+i.y)/2-5):(l.x=Math.sin(o)*a+(r[0].x+i.x)/2,l.y=-Math.cos(o)*a+(r[0].y+i.y)/2),l}ie(Mee,"calcTerminalLabelPosition");function Iee(e){let t="",n="";for(const r of e)r!==void 0&&(r.startsWith("color:")||r.startsWith("text-align:")?n=n+r+";":t=t+r+";");return{style:t,labelStyle:n}}ie(Iee,"getStylesFromArray");var rU=0,uFe=ie(()=>(rU++,"id-"+Math.random().toString(36).substr(2,12)+"-"+rU),"generateId");function jee(e){let t="";const n="0123456789abcdef",r=n.length;for(let s=0;s<e;s++)t+=n.charAt(Math.floor(Math.random()*r));return t}ie(jee,"makeRandomHex");var dFe=ie(e=>jee(e.length),"random"),fFe=ie(function(){return{x:0,y:0,fill:void 0,anchor:"start",style:"#666",width:100,height:100,textMargin:0,rx:0,ry:0,valign:void 0,text:""}},"getTextObj"),hFe=ie(function(e,t){const n=t.text.replace(rb.lineBreakRegex," "),[,r]=TT(t.fontSize),s=e.append("text");s.attr("x",t.x),s.attr("y",t.y),s.style("text-anchor",t.anchor),s.style("font-family",t.fontFamily),s.style("font-size",r),s.style("font-weight",t.fontWeight),s.attr("fill",t.fill),t.class!==void 0&&s.attr("class",t.class);const i=s.append("tspan");return i.attr("x",t.x+t.textMargin*2),i.attr("fill",t.fill),i.text(n),s},"drawSimpleText"),pFe=G1((e,t,n)=>{if(!e||(n=Object.assign({fontSize:12,fontWeight:400,fontFamily:"Arial",joinWith:"<br/>"},n),rb.lineBreakRegex.test(e)))return e;const r=e.split(" ").filter(Boolean),s=[];let i="";return r.forEach((a,o)=>{const l=Kd(`${a} `,n),c=Kd(i,n);if(l>t){const{hyphenatedStrings:h,remainingWord:m}=mFe(a,t,"-",n);s.push(i,...h),i=m}else c+l>=t?(s.push(i),i=a):i=[i,a].filter(Boolean).join(" ");o+1===r.length&&s.push(i)}),s.filter(a=>a!=="").join(n.joinWith)},(e,t,n)=>`${e}${t}${n.fontSize}${n.fontWeight}${n.fontFamily}${n.joinWith}`),mFe=G1((e,t,n="-",r)=>{r=Object.assign({fontSize:12,fontWeight:400,fontFamily:"Arial",margin:0},r);const s=[...e],i=[];let a="";return s.forEach((o,l)=>{const c=`${a}${o}`;if(Kd(c,r)>=t){const d=l+1,h=s.length===d,m=`${c}${n}`;i.push(h?c:m),a=""}else a=c}),{hyphenatedStrings:i,remainingWord:a}},(e,t,n="-",r)=>`${e}${t}${n}${r.fontSize}${r.fontWeight}${r.fontFamily}`);function Pee(e,t){return n6(e,t).height}ie(Pee,"calculateTextHeight");function Kd(e,t){return n6(e,t).width}ie(Kd,"calculateTextWidth");var n6=G1((e,t)=>{const{fontSize:n=12,fontFamily:r="Arial",fontWeight:s=400}=t;if(!e)return{width:0,height:0};const[,i]=TT(n),a=["sans-serif",r],o=e.split(rb.lineBreakRegex),l=[],c=Kr("body");if(!c.remove)return{width:0,height:0,lineHeight:0};const u=c.append("svg");for(const h of a){let m=0;const y={width:0,height:0,lineHeight:0};for(const b of o){const v=fFe();v.text=b||nFe;const x=hFe(u,v).style("font-size",i).style("font-weight",s).style("font-family",h),w=(x._groups||x)[0][0].getBBox();if(w.width===0&&w.height===0)throw new Error("svg element not in render tree");y.width=Math.round(Math.max(y.width,w.width)),m=Math.round(w.height),y.height+=m,y.lineHeight=Math.round(Math.max(y.lineHeight,m))}l.push(y)}u.remove();const d=isNaN(l[1].height)||isNaN(l[1].width)||isNaN(l[1].lineHeight)||l[0].height>l[1].height&&l[0].width>l[1].width&&l[0].lineHeight>l[1].lineHeight?0:1;return l[d]},(e,t)=>`${e}${t.fontSize}${t.fontWeight}${t.fontFamily}`),H0,gFe=(H0=class{constructor(t=!1,n){this.count=0,this.count=n?n.length:0,this.next=t?()=>this.count++:()=>Date.now()}},ie(H0,"InitIDGenerator"),H0),GS,yFe=ie(function(e){return GS=GS||document.createElement("div"),e=escape(e).replace(/%26/g,"&").replace(/%23/g,"#").replace(/%3B/g,";"),GS.innerHTML=e,unescape(GS.textContent)},"entityDecode");function r6(e){return"str"in e}ie(r6,"isDetailedError");var bFe=ie((e,t,n,r)=>{var i;if(!r)return;const s=(i=e.node())==null?void 0:i.getBBox();s&&e.append("text").text(r).attr("text-anchor","middle").attr("x",s.x+s.width/2).attr("y",-n).attr("class",t)},"insertTitle"),TT=ie(e=>{if(typeof e=="number")return[e,e+"px"];const t=parseInt(e??"",10);return Number.isNaN(t)?[void 0,void 0]:e===String(t)?[t,e+"px"]:[t,e]},"parseFontSize");function s6(e,t){return tFe({},e,t)}ie(s6,"cleanAndMerge");var pu={assignWithDepth:xa,wrapLabel:pFe,calculateTextHeight:Pee,calculateTextWidth:Kd,calculateTextDimensions:n6,cleanAndMerge:s6,detectInit:iFe,detectDirective:Tee,isSubstringInArray:oFe,interpolateToCurve:QD,calcLabelPosition:Nee,calcCardinalityPosition:cFe,calcTerminalLabelPosition:Mee,formatUrl:Aee,getStylesFromArray:Iee,generateId:uFe,random:dFe,runFunc:lFe,entityDecode:yFe,insertTitle:bFe,parseFontSize:TT,InitIDGenerator:gFe},vFe=ie(function(e){let t=e;return t=t.replace(/style.*:\S*#.*;/g,function(n){return n.substring(0,n.length-1)}),t=t.replace(/classDef.*:\S*#.*;/g,function(n){return n.substring(0,n.length-1)}),t=t.replace(/#\w+;/g,function(n){const r=n.substring(1,n.length-1);return/^\+?\d+$/.test(r)?"ﬂ°°"+r+"¶ß":"ﬂ°"+r+"¶ß"}),t},"encodeEntities"),eg=ie(function(e){return e.replace(/ﬂ°°/g,"&#").replace(/ﬂ°/g,"&").replace(/¶ß/g,";")},"decodeEntities"),odt=ie((e,t,{counter:n=0,prefix:r,suffix:s},i)=>i||`${r?`${r}_`:""}${e}_${t}_${n}${s?`_${s}`:""}`,"getEdgeId");function ro(e){return e??null}ie(ro,"handleUndefinedAttr");function i6(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var tg=i6();function Oee(e){tg=e}var Cx={exec:()=>null};function ms(e,t=""){let n=typeof e=="string"?e:e.source;const r={replace:(s,i)=>{let a=typeof i=="string"?i:i.source;return a=a.replace(eo.caret,"$1"),n=n.replace(s,a),r},getRegex:()=>new RegExp(n,t)};return r}var eo={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] /,listReplaceTask:/^\[[ xX]\] +/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:e=>new RegExp(`^( {0,3}${e})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}#`),htmlBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}<(?:[a-z].*>|!--)`,"i")},xFe=/^(?:[ \t]*(?:\n|$))+/,wFe=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,_Fe=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,Y1=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,SFe=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,a6=/(?:[*+-]|\d{1,9}[.)])/,Dee=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,Fee=ms(Dee).replace(/bull/g,a6).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),CFe=ms(Dee).replace(/bull/g,a6).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),o6=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,kFe=/^[^\n]+/,l6=/(?!\s*\])(?:\\.|[^\[\]\\])+/,EFe=ms(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",l6).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),TFe=ms(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,a6).getRegex(),AT="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",c6=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,AFe=ms("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",c6).replace("tag",AT).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Lee=ms(o6).replace("hr",Y1).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",AT).getRegex(),RFe=ms(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",Lee).getRegex(),u6={blockquote:RFe,code:wFe,def:EFe,fences:_Fe,heading:SFe,hr:Y1,html:AFe,lheading:Fee,list:TFe,newline:xFe,paragraph:Lee,table:Cx,text:kFe},sU=ms("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",Y1).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",AT).getRegex(),NFe={...u6,lheading:CFe,table:sU,paragraph:ms(o6).replace("hr",Y1).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",sU).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",AT).getRegex()},MFe={...u6,html:ms(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",c6).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Cx,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:ms(o6).replace("hr",Y1).replace("heading",` *#{1,6} *[^
]`).replace("lheading",Fee).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},IFe=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,jFe=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,Bee=/^( {2,}|\\)\n(?!\s*$)/,PFe=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,RT=/[\p{P}\p{S}]/u,d6=/[\s\p{P}\p{S}]/u,$ee=/[^\s\p{P}\p{S}]/u,OFe=ms(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,d6).getRegex(),zee=/(?!~)[\p{P}\p{S}]/u,DFe=/(?!~)[\s\p{P}\p{S}]/u,FFe=/(?:[^\s\p{P}\p{S}]|~)/u,LFe=/\[[^[\]]*?\]\((?:\\.|[^\\\(\)]|\((?:\\.|[^\\\(\)])*\))*\)|`[^`]*?`|<[^<>]*?>/g,Uee=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,BFe=ms(Uee,"u").replace(/punct/g,RT).getRegex(),$Fe=ms(Uee,"u").replace(/punct/g,zee).getRegex(),qee="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",zFe=ms(qee,"gu").replace(/notPunctSpace/g,$ee).replace(/punctSpace/g,d6).replace(/punct/g,RT).getRegex(),UFe=ms(qee,"gu").replace(/notPunctSpace/g,FFe).replace(/punctSpace/g,DFe).replace(/punct/g,zee).getRegex(),qFe=ms("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,$ee).replace(/punctSpace/g,d6).replace(/punct/g,RT).getRegex(),VFe=ms(/\\(punct)/,"gu").replace(/punct/g,RT).getRegex(),WFe=ms(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),HFe=ms(c6).replace("(?:-->|$)","-->").getRegex(),GFe=ms("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",HFe).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),Ak=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,KFe=ms(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",Ak).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),Vee=ms(/^!?\[(label)\]\[(ref)\]/).replace("label",Ak).replace("ref",l6).getRegex(),Wee=ms(/^!?\[(ref)\](?:\[\])?/).replace("ref",l6).getRegex(),YFe=ms("reflink|nolink(?!\\()","g").replace("reflink",Vee).replace("nolink",Wee).getRegex(),f6={_backpedal:Cx,anyPunctuation:VFe,autolink:WFe,blockSkip:LFe,br:Bee,code:jFe,del:Cx,emStrongLDelim:BFe,emStrongRDelimAst:zFe,emStrongRDelimUnd:qFe,escape:IFe,link:KFe,nolink:Wee,punctuation:OFe,reflink:Vee,reflinkSearch:YFe,tag:GFe,text:PFe,url:Cx},ZFe={...f6,link:ms(/^!?\[(label)\]\((.*?)\)/).replace("label",Ak).getRegex(),reflink:ms(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",Ak).getRegex()},h4={...f6,emStrongRDelimAst:UFe,emStrongLDelim:$Fe,url:ms(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\.|[^\\])*?(?:\\.|[^\s~\\]))\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},XFe={...h4,br:ms(Bee).replace("{2,}","*").getRegex(),text:ms(h4.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},KS={normal:u6,gfm:NFe,pedantic:MFe},zv={normal:f6,gfm:h4,breaks:XFe,pedantic:ZFe},JFe={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},iU=e=>JFe[e];function ru(e,t){if(t){if(eo.escapeTest.test(e))return e.replace(eo.escapeReplace,iU)}else if(eo.escapeTestNoEncode.test(e))return e.replace(eo.escapeReplaceNoEncode,iU);return e}function aU(e){try{e=encodeURI(e).replace(eo.percentDecode,"%")}catch{return null}return e}function oU(e,t){var i;const n=e.replace(eo.findPipe,(a,o,l)=>{let c=!1,u=o;for(;--u>=0&&l[u]==="\\";)c=!c;return c?"|":" |"}),r=n.split(eo.splitPipe);let s=0;if(r[0].trim()||r.shift(),r.length>0&&!((i=r.at(-1))!=null&&i.trim())&&r.pop(),t)if(r.length>t)r.splice(t);else for(;r.length<t;)r.push("");for(;s<r.length;s++)r[s]=r[s].trim().replace(eo.slashPipe,"|");return r}function Uv(e,t,n){const r=e.length;if(r===0)return"";let s=0;for(;s<r&&e.charAt(r-s-1)===t;)s++;return e.slice(0,r-s)}function QFe(e,t){if(e.indexOf(t[1])===-1)return-1;let n=0;for(let r=0;r<e.length;r++)if(e[r]==="\\")r++;else if(e[r]===t[0])n++;else if(e[r]===t[1]&&(n--,n<0))return r;return n>0?-2:-1}function lU(e,t,n,r,s){const i=t.href,a=t.title||null,o=e[1].replace(s.other.outputLinkReplace,"$1");r.state.inLink=!0;const l={type:e[0].charAt(0)==="!"?"image":"link",raw:n,href:i,title:a,text:o,tokens:r.inlineTokens(o)};return r.state.inLink=!1,l}function e8e(e,t,n){const r=e.match(n.other.indentCodeCompensation);if(r===null)return t;const s=r[1];return t.split(`
`).map(i=>{const a=i.match(n.other.beginningSpace);if(a===null)return i;const[o]=a;return o.length>=s.length?i.slice(s.length):i}).join(`
`)}var Rk=class{constructor(e){me(this,"options");me(this,"rules");me(this,"lexer");this.options=e||tg}space(e){const t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){const t=this.rules.block.code.exec(e);if(t){const n=t[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?n:Uv(n,`
`)}}}fences(e){const t=this.rules.block.fences.exec(e);if(t){const n=t[0],r=e8e(n,t[3]||"",this.rules);return{type:"code",raw:n,lang:t[2]?t[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):t[2],text:r}}}heading(e){const t=this.rules.block.heading.exec(e);if(t){let n=t[2].trim();if(this.rules.other.endingHash.test(n)){const r=Uv(n,"#");(this.options.pedantic||!r||this.rules.other.endingSpaceChar.test(r))&&(n=r.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:n,tokens:this.lexer.inline(n)}}}hr(e){const t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:Uv(t[0],`
`)}}blockquote(e){const t=this.rules.block.blockquote.exec(e);if(t){let n=Uv(t[0],`
`).split(`
`),r="",s="";const i=[];for(;n.length>0;){let a=!1;const o=[];let l;for(l=0;l<n.length;l++)if(this.rules.other.blockquoteStart.test(n[l]))o.push(n[l]),a=!0;else if(!a)o.push(n[l]);else break;n=n.slice(l);const c=o.join(`
`),u=c.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");r=r?`${r}
${c}`:c,s=s?`${s}
${u}`:u;const d=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(u,i,!0),this.lexer.state.top=d,n.length===0)break;const h=i.at(-1);if((h==null?void 0:h.type)==="code")break;if((h==null?void 0:h.type)==="blockquote"){const m=h,y=m.raw+`
`+n.join(`
`),b=this.blockquote(y);i[i.length-1]=b,r=r.substring(0,r.length-m.raw.length)+b.raw,s=s.substring(0,s.length-m.text.length)+b.text;break}else if((h==null?void 0:h.type)==="list"){const m=h,y=m.raw+`
`+n.join(`
`),b=this.list(y);i[i.length-1]=b,r=r.substring(0,r.length-h.raw.length)+b.raw,s=s.substring(0,s.length-m.raw.length)+b.raw,n=y.substring(i.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:r,tokens:i,text:s}}}list(e){let t=this.rules.block.list.exec(e);if(t){let n=t[1].trim();const r=n.length>1,s={type:"list",raw:"",ordered:r,start:r?+n.slice(0,-1):"",loose:!1,items:[]};n=r?`\\d{1,9}\\${n.slice(-1)}`:`\\${n}`,this.options.pedantic&&(n=r?n:"[*+-]");const i=this.rules.other.listItemRegex(n);let a=!1;for(;e;){let l=!1,c="",u="";if(!(t=i.exec(e))||this.rules.block.hr.test(e))break;c=t[0],e=e.substring(c.length);let d=t[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,x=>" ".repeat(3*x.length)),h=e.split(`
`,1)[0],m=!d.trim(),y=0;if(this.options.pedantic?(y=2,u=d.trimStart()):m?y=t[1].length+1:(y=t[2].search(this.rules.other.nonSpaceChar),y=y>4?1:y,u=d.slice(y),y+=t[1].length),m&&this.rules.other.blankLine.test(h)&&(c+=h+`
`,e=e.substring(h.length+1),l=!0),!l){const x=this.rules.other.nextBulletRegex(y),w=this.rules.other.hrRegex(y),S=this.rules.other.fencesBeginRegex(y),C=this.rules.other.headingBeginRegex(y),k=this.rules.other.htmlBeginRegex(y);for(;e;){const A=e.split(`
`,1)[0];let R;if(h=A,this.options.pedantic?(h=h.replace(this.rules.other.listReplaceNesting,"  "),R=h):R=h.replace(this.rules.other.tabCharGlobal,"    "),S.test(h)||C.test(h)||k.test(h)||x.test(h)||w.test(h))break;if(R.search(this.rules.other.nonSpaceChar)>=y||!h.trim())u+=`
`+R.slice(y);else{if(m||d.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||S.test(d)||C.test(d)||w.test(d))break;u+=`
`+h}!m&&!h.trim()&&(m=!0),c+=A+`
`,e=e.substring(A.length+1),d=R.slice(y)}}s.loose||(a?s.loose=!0:this.rules.other.doubleBlankLine.test(c)&&(a=!0));let b=null,v;this.options.gfm&&(b=this.rules.other.listIsTask.exec(u),b&&(v=b[0]!=="[ ] ",u=u.replace(this.rules.other.listReplaceTask,""))),s.items.push({type:"list_item",raw:c,task:!!b,checked:v,loose:!1,text:u,tokens:[]}),s.raw+=c}const o=s.items.at(-1);if(o)o.raw=o.raw.trimEnd(),o.text=o.text.trimEnd();else return;s.raw=s.raw.trimEnd();for(let l=0;l<s.items.length;l++)if(this.lexer.state.top=!1,s.items[l].tokens=this.lexer.blockTokens(s.items[l].text,[]),!s.loose){const c=s.items[l].tokens.filter(d=>d.type==="space"),u=c.length>0&&c.some(d=>this.rules.other.anyLine.test(d.raw));s.loose=u}if(s.loose)for(let l=0;l<s.items.length;l++)s.items[l].loose=!0;return s}}html(e){const t=this.rules.block.html.exec(e);if(t)return{type:"html",block:!0,raw:t[0],pre:t[1]==="pre"||t[1]==="script"||t[1]==="style",text:t[0]}}def(e){const t=this.rules.block.def.exec(e);if(t){const n=t[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),r=t[2]?t[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",s=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):t[3];return{type:"def",tag:n,raw:t[0],href:r,title:s}}}table(e){var a;const t=this.rules.block.table.exec(e);if(!t||!this.rules.other.tableDelimiter.test(t[2]))return;const n=oU(t[1]),r=t[2].replace(this.rules.other.tableAlignChars,"").split("|"),s=(a=t[3])!=null&&a.trim()?t[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],i={type:"table",raw:t[0],header:[],align:[],rows:[]};if(n.length===r.length){for(const o of r)this.rules.other.tableAlignRight.test(o)?i.align.push("right"):this.rules.other.tableAlignCenter.test(o)?i.align.push("center"):this.rules.other.tableAlignLeft.test(o)?i.align.push("left"):i.align.push(null);for(let o=0;o<n.length;o++)i.header.push({text:n[o],tokens:this.lexer.inline(n[o]),header:!0,align:i.align[o]});for(const o of s)i.rows.push(oU(o,i.header.length).map((l,c)=>({text:l,tokens:this.lexer.inline(l),header:!1,align:i.align[c]})));return i}}lheading(e){const t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:t[2].charAt(0)==="="?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){const t=this.rules.block.paragraph.exec(e);if(t){const n=t[1].charAt(t[1].length-1)===`
`?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:n,tokens:this.lexer.inline(n)}}}text(e){const t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){const t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:t[1]}}tag(e){const t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&this.rules.other.startATag.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:t[0]}}link(e){const t=this.rules.inline.link.exec(e);if(t){const n=t[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(n)){if(!this.rules.other.endAngleBracket.test(n))return;const i=Uv(n.slice(0,-1),"\\");if((n.length-i.length)%2===0)return}else{const i=QFe(t[2],"()");if(i===-2)return;if(i>-1){const o=(t[0].indexOf("!")===0?5:4)+t[1].length+i;t[2]=t[2].substring(0,i),t[0]=t[0].substring(0,o).trim(),t[3]=""}}let r=t[2],s="";if(this.options.pedantic){const i=this.rules.other.pedanticHrefTitle.exec(r);i&&(r=i[1],s=i[3])}else s=t[3]?t[3].slice(1,-1):"";return r=r.trim(),this.rules.other.startAngleBracket.test(r)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(n)?r=r.slice(1):r=r.slice(1,-1)),lU(t,{href:r&&r.replace(this.rules.inline.anyPunctuation,"$1"),title:s&&s.replace(this.rules.inline.anyPunctuation,"$1")},t[0],this.lexer,this.rules)}}reflink(e,t){let n;if((n=this.rules.inline.reflink.exec(e))||(n=this.rules.inline.nolink.exec(e))){const r=(n[2]||n[1]).replace(this.rules.other.multipleSpaceGlobal," "),s=t[r.toLowerCase()];if(!s){const i=n[0].charAt(0);return{type:"text",raw:i,text:i}}return lU(n,s,n[0],this.lexer,this.rules)}}emStrong(e,t,n=""){let r=this.rules.inline.emStrongLDelim.exec(e);if(!r||r[3]&&n.match(this.rules.other.unicodeAlphaNumeric))return;if(!(r[1]||r[2]||"")||!n||this.rules.inline.punctuation.exec(n)){const i=[...r[0]].length-1;let a,o,l=i,c=0;const u=r[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(u.lastIndex=0,t=t.slice(-1*e.length+i);(r=u.exec(t))!=null;){if(a=r[1]||r[2]||r[3]||r[4]||r[5]||r[6],!a)continue;if(o=[...a].length,r[3]||r[4]){l+=o;continue}else if((r[5]||r[6])&&i%3&&!((i+o)%3)){c+=o;continue}if(l-=o,l>0)continue;o=Math.min(o,o+l+c);const d=[...r[0]][0].length,h=e.slice(0,i+r.index+d+o);if(Math.min(i,o)%2){const y=h.slice(1,-1);return{type:"em",raw:h,text:y,tokens:this.lexer.inlineTokens(y)}}const m=h.slice(2,-2);return{type:"strong",raw:h,text:m,tokens:this.lexer.inlineTokens(m)}}}}codespan(e){const t=this.rules.inline.code.exec(e);if(t){let n=t[2].replace(this.rules.other.newLineCharGlobal," ");const r=this.rules.other.nonSpaceChar.test(n),s=this.rules.other.startingSpaceChar.test(n)&&this.rules.other.endingSpaceChar.test(n);return r&&s&&(n=n.substring(1,n.length-1)),{type:"codespan",raw:t[0],text:n}}}br(e){const t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){const t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e){const t=this.rules.inline.autolink.exec(e);if(t){let n,r;return t[2]==="@"?(n=t[1],r="mailto:"+n):(n=t[1],r=n),{type:"link",raw:t[0],text:n,href:r,tokens:[{type:"text",raw:n,text:n}]}}}url(e){var n;let t;if(t=this.rules.inline.url.exec(e)){let r,s;if(t[2]==="@")r=t[0],s="mailto:"+r;else{let i;do i=t[0],t[0]=((n=this.rules.inline._backpedal.exec(t[0]))==null?void 0:n[0])??"";while(i!==t[0]);r=t[0],t[1]==="www."?s="http://"+t[0]:s=t[0]}return{type:"link",raw:t[0],text:r,href:s,tokens:[{type:"text",raw:r,text:r}]}}}inlineText(e){const t=this.rules.inline.text.exec(e);if(t){const n=this.lexer.state.inRawBlock;return{type:"text",raw:t[0],text:t[0],escaped:n}}}},Ad=class p4{constructor(t){me(this,"tokens");me(this,"options");me(this,"state");me(this,"tokenizer");me(this,"inlineQueue");this.tokens=[],this.tokens.links=Object.create(null),this.options=t||tg,this.options.tokenizer=this.options.tokenizer||new Rk,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const n={other:eo,block:KS.normal,inline:zv.normal};this.options.pedantic?(n.block=KS.pedantic,n.inline=zv.pedantic):this.options.gfm&&(n.block=KS.gfm,this.options.breaks?n.inline=zv.breaks:n.inline=zv.gfm),this.tokenizer.rules=n}static get rules(){return{block:KS,inline:zv}}static lex(t,n){return new p4(n).lex(t)}static lexInline(t,n){return new p4(n).inlineTokens(t)}lex(t){t=t.replace(eo.carriageReturn,`
`),this.blockTokens(t,this.tokens);for(let n=0;n<this.inlineQueue.length;n++){const r=this.inlineQueue[n];this.inlineTokens(r.src,r.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(t,n=[],r=!1){var s,i,a;for(this.options.pedantic&&(t=t.replace(eo.tabCharGlobal,"    ").replace(eo.spaceLine,""));t;){let o;if((i=(s=this.options.extensions)==null?void 0:s.block)!=null&&i.some(c=>(o=c.call({lexer:this},t,n))?(t=t.substring(o.raw.length),n.push(o),!0):!1))continue;if(o=this.tokenizer.space(t)){t=t.substring(o.raw.length);const c=n.at(-1);o.raw.length===1&&c!==void 0?c.raw+=`
`:n.push(o);continue}if(o=this.tokenizer.code(t)){t=t.substring(o.raw.length);const c=n.at(-1);(c==null?void 0:c.type)==="paragraph"||(c==null?void 0:c.type)==="text"?(c.raw+=`
`+o.raw,c.text+=`
`+o.text,this.inlineQueue.at(-1).src=c.text):n.push(o);continue}if(o=this.tokenizer.fences(t)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.heading(t)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.hr(t)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.blockquote(t)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.list(t)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.html(t)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.def(t)){t=t.substring(o.raw.length);const c=n.at(-1);(c==null?void 0:c.type)==="paragraph"||(c==null?void 0:c.type)==="text"?(c.raw+=`
`+o.raw,c.text+=`
`+o.raw,this.inlineQueue.at(-1).src=c.text):this.tokens.links[o.tag]||(this.tokens.links[o.tag]={href:o.href,title:o.title});continue}if(o=this.tokenizer.table(t)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.lheading(t)){t=t.substring(o.raw.length),n.push(o);continue}let l=t;if((a=this.options.extensions)!=null&&a.startBlock){let c=1/0;const u=t.slice(1);let d;this.options.extensions.startBlock.forEach(h=>{d=h.call({lexer:this},u),typeof d=="number"&&d>=0&&(c=Math.min(c,d))}),c<1/0&&c>=0&&(l=t.substring(0,c+1))}if(this.state.top&&(o=this.tokenizer.paragraph(l))){const c=n.at(-1);r&&(c==null?void 0:c.type)==="paragraph"?(c.raw+=`
`+o.raw,c.text+=`
`+o.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=c.text):n.push(o),r=l.length!==t.length,t=t.substring(o.raw.length);continue}if(o=this.tokenizer.text(t)){t=t.substring(o.raw.length);const c=n.at(-1);(c==null?void 0:c.type)==="text"?(c.raw+=`
`+o.raw,c.text+=`
`+o.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=c.text):n.push(o);continue}if(t){const c="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(c);break}else throw new Error(c)}}return this.state.top=!0,n}inline(t,n=[]){return this.inlineQueue.push({src:t,tokens:n}),n}inlineTokens(t,n=[]){var o,l,c;let r=t,s=null;if(this.tokens.links){const u=Object.keys(this.tokens.links);if(u.length>0)for(;(s=this.tokenizer.rules.inline.reflinkSearch.exec(r))!=null;)u.includes(s[0].slice(s[0].lastIndexOf("[")+1,-1))&&(r=r.slice(0,s.index)+"["+"a".repeat(s[0].length-2)+"]"+r.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(s=this.tokenizer.rules.inline.anyPunctuation.exec(r))!=null;)r=r.slice(0,s.index)+"++"+r.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;(s=this.tokenizer.rules.inline.blockSkip.exec(r))!=null;)r=r.slice(0,s.index)+"["+"a".repeat(s[0].length-2)+"]"+r.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);let i=!1,a="";for(;t;){i||(a=""),i=!1;let u;if((l=(o=this.options.extensions)==null?void 0:o.inline)!=null&&l.some(h=>(u=h.call({lexer:this},t,n))?(t=t.substring(u.raw.length),n.push(u),!0):!1))continue;if(u=this.tokenizer.escape(t)){t=t.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.tag(t)){t=t.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.link(t)){t=t.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.reflink(t,this.tokens.links)){t=t.substring(u.raw.length);const h=n.at(-1);u.type==="text"&&(h==null?void 0:h.type)==="text"?(h.raw+=u.raw,h.text+=u.text):n.push(u);continue}if(u=this.tokenizer.emStrong(t,r,a)){t=t.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.codespan(t)){t=t.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.br(t)){t=t.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.del(t)){t=t.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.autolink(t)){t=t.substring(u.raw.length),n.push(u);continue}if(!this.state.inLink&&(u=this.tokenizer.url(t))){t=t.substring(u.raw.length),n.push(u);continue}let d=t;if((c=this.options.extensions)!=null&&c.startInline){let h=1/0;const m=t.slice(1);let y;this.options.extensions.startInline.forEach(b=>{y=b.call({lexer:this},m),typeof y=="number"&&y>=0&&(h=Math.min(h,y))}),h<1/0&&h>=0&&(d=t.substring(0,h+1))}if(u=this.tokenizer.inlineText(d)){t=t.substring(u.raw.length),u.raw.slice(-1)!=="_"&&(a=u.raw.slice(-1)),i=!0;const h=n.at(-1);(h==null?void 0:h.type)==="text"?(h.raw+=u.raw,h.text+=u.text):n.push(u);continue}if(t){const h="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(h);break}else throw new Error(h)}}return n}},Nk=class{constructor(e){me(this,"options");me(this,"parser");this.options=e||tg}space(e){return""}code({text:e,lang:t,escaped:n}){var i;const r=(i=(t||"").match(eo.notSpaceStart))==null?void 0:i[0],s=e.replace(eo.endingNewline,"")+`
`;return r?'<pre><code class="language-'+ru(r)+'">'+(n?s:ru(s,!0))+`</code></pre>
`:"<pre><code>"+(n?s:ru(s,!0))+`</code></pre>
`}blockquote({tokens:e}){return`<blockquote>
${this.parser.parse(e)}</blockquote>
`}html({text:e}){return e}heading({tokens:e,depth:t}){return`<h${t}>${this.parser.parseInline(e)}</h${t}>
`}hr(e){return`<hr>
`}list(e){const t=e.ordered,n=e.start;let r="";for(let a=0;a<e.items.length;a++){const o=e.items[a];r+=this.listitem(o)}const s=t?"ol":"ul",i=t&&n!==1?' start="'+n+'"':"";return"<"+s+i+`>
`+r+"</"+s+`>
`}listitem(e){var n;let t="";if(e.task){const r=this.checkbox({checked:!!e.checked});e.loose?((n=e.tokens[0])==null?void 0:n.type)==="paragraph"?(e.tokens[0].text=r+" "+e.tokens[0].text,e.tokens[0].tokens&&e.tokens[0].tokens.length>0&&e.tokens[0].tokens[0].type==="text"&&(e.tokens[0].tokens[0].text=r+" "+ru(e.tokens[0].tokens[0].text),e.tokens[0].tokens[0].escaped=!0)):e.tokens.unshift({type:"text",raw:r+" ",text:r+" ",escaped:!0}):t+=r+" "}return t+=this.parser.parse(e.tokens,!!e.loose),`<li>${t}</li>
`}checkbox({checked:e}){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:e}){return`<p>${this.parser.parseInline(e)}</p>
`}table(e){let t="",n="";for(let s=0;s<e.header.length;s++)n+=this.tablecell(e.header[s]);t+=this.tablerow({text:n});let r="";for(let s=0;s<e.rows.length;s++){const i=e.rows[s];n="";for(let a=0;a<i.length;a++)n+=this.tablecell(i[a]);r+=this.tablerow({text:n})}return r&&(r=`<tbody>${r}</tbody>`),`<table>
<thead>
`+t+`</thead>
`+r+`</table>
`}tablerow({text:e}){return`<tr>
${e}</tr>
`}tablecell(e){const t=this.parser.parseInline(e.tokens),n=e.header?"th":"td";return(e.align?`<${n} align="${e.align}">`:`<${n}>`)+t+`</${n}>
`}strong({tokens:e}){return`<strong>${this.parser.parseInline(e)}</strong>`}em({tokens:e}){return`<em>${this.parser.parseInline(e)}</em>`}codespan({text:e}){return`<code>${ru(e,!0)}</code>`}br(e){return"<br>"}del({tokens:e}){return`<del>${this.parser.parseInline(e)}</del>`}link({href:e,title:t,tokens:n}){const r=this.parser.parseInline(n),s=aU(e);if(s===null)return r;e=s;let i='<a href="'+e+'"';return t&&(i+=' title="'+ru(t)+'"'),i+=">"+r+"</a>",i}image({href:e,title:t,text:n,tokens:r}){r&&(n=this.parser.parseInline(r,this.parser.textRenderer));const s=aU(e);if(s===null)return ru(n);e=s;let i=`<img src="${e}" alt="${n}"`;return t&&(i+=` title="${ru(t)}"`),i+=">",i}text(e){return"tokens"in e&&e.tokens?this.parser.parseInline(e.tokens):"escaped"in e&&e.escaped?e.text:ru(e.text)}},h6=class{strong({text:e}){return e}em({text:e}){return e}codespan({text:e}){return e}del({text:e}){return e}html({text:e}){return e}text({text:e}){return e}link({text:e}){return""+e}image({text:e}){return""+e}br(){return""}},Rd=class m4{constructor(t){me(this,"options");me(this,"renderer");me(this,"textRenderer");this.options=t||tg,this.options.renderer=this.options.renderer||new Nk,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new h6}static parse(t,n){return new m4(n).parse(t)}static parseInline(t,n){return new m4(n).parseInline(t)}parse(t,n=!0){var s,i;let r="";for(let a=0;a<t.length;a++){const o=t[a];if((i=(s=this.options.extensions)==null?void 0:s.renderers)!=null&&i[o.type]){const c=o,u=this.options.extensions.renderers[c.type].call({parser:this},c);if(u!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(c.type)){r+=u||"";continue}}const l=o;switch(l.type){case"space":{r+=this.renderer.space(l);continue}case"hr":{r+=this.renderer.hr(l);continue}case"heading":{r+=this.renderer.heading(l);continue}case"code":{r+=this.renderer.code(l);continue}case"table":{r+=this.renderer.table(l);continue}case"blockquote":{r+=this.renderer.blockquote(l);continue}case"list":{r+=this.renderer.list(l);continue}case"html":{r+=this.renderer.html(l);continue}case"paragraph":{r+=this.renderer.paragraph(l);continue}case"text":{let c=l,u=this.renderer.text(c);for(;a+1<t.length&&t[a+1].type==="text";)c=t[++a],u+=`
`+this.renderer.text(c);n?r+=this.renderer.paragraph({type:"paragraph",raw:u,text:u,tokens:[{type:"text",raw:u,text:u,escaped:!0}]}):r+=u;continue}default:{const c='Token with "'+l.type+'" type was not found.';if(this.options.silent)return console.error(c),"";throw new Error(c)}}}return r}parseInline(t,n=this.renderer){var s,i;let r="";for(let a=0;a<t.length;a++){const o=t[a];if((i=(s=this.options.extensions)==null?void 0:s.renderers)!=null&&i[o.type]){const c=this.options.extensions.renderers[o.type].call({parser:this},o);if(c!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(o.type)){r+=c||"";continue}}const l=o;switch(l.type){case"escape":{r+=n.text(l);break}case"html":{r+=n.html(l);break}case"link":{r+=n.link(l);break}case"image":{r+=n.image(l);break}case"strong":{r+=n.strong(l);break}case"em":{r+=n.em(l);break}case"codespan":{r+=n.codespan(l);break}case"br":{r+=n.br(l);break}case"del":{r+=n.del(l);break}case"text":{r+=n.text(l);break}default:{const c='Token with "'+l.type+'" type was not found.';if(this.options.silent)return console.error(c),"";throw new Error(c)}}}return r}},F3,$2=(F3=class{constructor(e){me(this,"options");me(this,"block");this.options=e||tg}preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}provideLexer(){return this.block?Ad.lex:Ad.lexInline}provideParser(){return this.block?Rd.parse:Rd.parseInline}},me(F3,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens"])),F3),t8e=class{constructor(...e){me(this,"defaults",i6());me(this,"options",this.setOptions);me(this,"parse",this.parseMarkdown(!0));me(this,"parseInline",this.parseMarkdown(!1));me(this,"Parser",Rd);me(this,"Renderer",Nk);me(this,"TextRenderer",h6);me(this,"Lexer",Ad);me(this,"Tokenizer",Rk);me(this,"Hooks",$2);this.use(...e)}walkTokens(e,t){var r,s;let n=[];for(const i of e)switch(n=n.concat(t.call(this,i)),i.type){case"table":{const a=i;for(const o of a.header)n=n.concat(this.walkTokens(o.tokens,t));for(const o of a.rows)for(const l of o)n=n.concat(this.walkTokens(l.tokens,t));break}case"list":{const a=i;n=n.concat(this.walkTokens(a.items,t));break}default:{const a=i;(s=(r=this.defaults.extensions)==null?void 0:r.childTokens)!=null&&s[a.type]?this.defaults.extensions.childTokens[a.type].forEach(o=>{const l=a[o].flat(1/0);n=n.concat(this.walkTokens(l,t))}):a.tokens&&(n=n.concat(this.walkTokens(a.tokens,t)))}}return n}use(...e){const t=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach(n=>{const r={...n};if(r.async=this.defaults.async||r.async||!1,n.extensions&&(n.extensions.forEach(s=>{if(!s.name)throw new Error("extension name required");if("renderer"in s){const i=t.renderers[s.name];i?t.renderers[s.name]=function(...a){let o=s.renderer.apply(this,a);return o===!1&&(o=i.apply(this,a)),o}:t.renderers[s.name]=s.renderer}if("tokenizer"in s){if(!s.level||s.level!=="block"&&s.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");const i=t[s.level];i?i.unshift(s.tokenizer):t[s.level]=[s.tokenizer],s.start&&(s.level==="block"?t.startBlock?t.startBlock.push(s.start):t.startBlock=[s.start]:s.level==="inline"&&(t.startInline?t.startInline.push(s.start):t.startInline=[s.start]))}"childTokens"in s&&s.childTokens&&(t.childTokens[s.name]=s.childTokens)}),r.extensions=t),n.renderer){const s=this.defaults.renderer||new Nk(this.defaults);for(const i in n.renderer){if(!(i in s))throw new Error(`renderer '${i}' does not exist`);if(["options","parser"].includes(i))continue;const a=i,o=n.renderer[a],l=s[a];s[a]=(...c)=>{let u=o.apply(s,c);return u===!1&&(u=l.apply(s,c)),u||""}}r.renderer=s}if(n.tokenizer){const s=this.defaults.tokenizer||new Rk(this.defaults);for(const i in n.tokenizer){if(!(i in s))throw new Error(`tokenizer '${i}' does not exist`);if(["options","rules","lexer"].includes(i))continue;const a=i,o=n.tokenizer[a],l=s[a];s[a]=(...c)=>{let u=o.apply(s,c);return u===!1&&(u=l.apply(s,c)),u}}r.tokenizer=s}if(n.hooks){const s=this.defaults.hooks||new $2;for(const i in n.hooks){if(!(i in s))throw new Error(`hook '${i}' does not exist`);if(["options","block"].includes(i))continue;const a=i,o=n.hooks[a],l=s[a];$2.passThroughHooks.has(i)?s[a]=c=>{if(this.defaults.async)return Promise.resolve(o.call(s,c)).then(d=>l.call(s,d));const u=o.call(s,c);return l.call(s,u)}:s[a]=(...c)=>{let u=o.apply(s,c);return u===!1&&(u=l.apply(s,c)),u}}r.hooks=s}if(n.walkTokens){const s=this.defaults.walkTokens,i=n.walkTokens;r.walkTokens=function(a){let o=[];return o.push(i.call(this,a)),s&&(o=o.concat(s.call(this,a))),o}}this.defaults={...this.defaults,...r}}),this}setOptions(e){return this.defaults={...this.defaults,...e},this}lexer(e,t){return Ad.lex(e,t??this.defaults)}parser(e,t){return Rd.parse(e,t??this.defaults)}parseMarkdown(e){return(n,r)=>{const s={...r},i={...this.defaults,...s},a=this.onError(!!i.silent,!!i.async);if(this.defaults.async===!0&&s.async===!1)return a(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof n>"u"||n===null)return a(new Error("marked(): input parameter is undefined or null"));if(typeof n!="string")return a(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(n)+", string expected"));i.hooks&&(i.hooks.options=i,i.hooks.block=e);const o=i.hooks?i.hooks.provideLexer():e?Ad.lex:Ad.lexInline,l=i.hooks?i.hooks.provideParser():e?Rd.parse:Rd.parseInline;if(i.async)return Promise.resolve(i.hooks?i.hooks.preprocess(n):n).then(c=>o(c,i)).then(c=>i.hooks?i.hooks.processAllTokens(c):c).then(c=>i.walkTokens?Promise.all(this.walkTokens(c,i.walkTokens)).then(()=>c):c).then(c=>l(c,i)).then(c=>i.hooks?i.hooks.postprocess(c):c).catch(a);try{i.hooks&&(n=i.hooks.preprocess(n));let c=o(n,i);i.hooks&&(c=i.hooks.processAllTokens(c)),i.walkTokens&&this.walkTokens(c,i.walkTokens);let u=l(c,i);return i.hooks&&(u=i.hooks.postprocess(u)),u}catch(c){return a(c)}}}onError(e,t){return n=>{if(n.message+=`
Please report this to https://github.com/markedjs/marked.`,e){const r="<p>An error occurred:</p><pre>"+ru(n.message+"",!0)+"</pre>";return t?Promise.resolve(r):r}if(t)return Promise.reject(n);throw n}}},Mm=new t8e;function ds(e,t){return Mm.parse(e,t)}ds.options=ds.setOptions=function(e){return Mm.setOptions(e),ds.defaults=Mm.defaults,Oee(ds.defaults),ds};ds.getDefaults=i6;ds.defaults=tg;ds.use=function(...e){return Mm.use(...e),ds.defaults=Mm.defaults,Oee(ds.defaults),ds};ds.walkTokens=function(e,t){return Mm.walkTokens(e,t)};ds.parseInline=Mm.parseInline;ds.Parser=Rd;ds.parser=Rd.parse;ds.Renderer=Nk;ds.TextRenderer=h6;ds.Lexer=Ad;ds.lexer=Ad.lex;ds.Tokenizer=Rk;ds.Hooks=$2;ds.parse=ds;ds.options;ds.setOptions;ds.use;ds.walkTokens;ds.parseInline;Rd.parse;Ad.lex;function Hee(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=Array.from(typeof e=="string"?[e]:e);r[r.length-1]=r[r.length-1].replace(/\r?\n([\t ]*)$/,"");var s=r.reduce(function(o,l){var c=l.match(/\n([\t ]+|(?!\s).)/g);return c?o.concat(c.map(function(u){var d,h;return(h=(d=u.match(/[\t ]/g))===null||d===void 0?void 0:d.length)!==null&&h!==void 0?h:0})):o},[]);if(s.length){var i=new RegExp(`
[	 ]{`+Math.min.apply(Math,s)+"}","g");r=r.map(function(o){return o.replace(i,`
`)})}r[0]=r[0].replace(/^\r?\n/,"");var a=r[0];return t.forEach(function(o,l){var c=a.match(/(?:^|\n)( *)$/),u=c?c[1]:"",d=o;typeof o=="string"&&o.includes(`
`)&&(d=String(o).split(`
`).map(function(h,m){return m===0?h:""+u+h}).join(`
`)),a+=d+r[l+1]}),a}function Gee(e,{markdownAutoWrap:t}){const r=e.replace(/<br\/>/g,`
`).replace(/\n{2,}/g,`
`),s=Hee(r);return t===!1?s.replace(/ /g,"&nbsp;"):s}ie(Gee,"preprocessMarkdown");function Kee(e,t={}){const n=Gee(e,t),r=ds.lexer(n),s=[[]];let i=0;function a(o,l="normal"){o.type==="text"?o.text.split(`
`).forEach((u,d)=>{d!==0&&(i++,s.push([])),u.split(" ").forEach(h=>{h=h.replace(/&#39;/g,"'"),h&&s[i].push({content:h,type:l})})}):o.type==="strong"||o.type==="em"?o.tokens.forEach(c=>{a(c,o.type)}):o.type==="html"&&s[i].push({content:o.text,type:"normal"})}return ie(a,"processNode"),r.forEach(o=>{var l;o.type==="paragraph"?(l=o.tokens)==null||l.forEach(c=>{a(c)}):o.type==="html"&&s[i].push({content:o.text,type:"normal"})}),s}ie(Kee,"markdownToLines");function Yee(e,{markdownAutoWrap:t}={}){const n=ds.lexer(e);function r(s){var i,a,o;return s.type==="text"?t===!1?s.text.replace(/\n */g,"<br/>").replace(/ /g,"&nbsp;"):s.text.replace(/\n */g,"<br/>"):s.type==="strong"?`<strong>${(i=s.tokens)==null?void 0:i.map(r).join("")}</strong>`:s.type==="em"?`<em>${(a=s.tokens)==null?void 0:a.map(r).join("")}</em>`:s.type==="paragraph"?`<p>${(o=s.tokens)==null?void 0:o.map(r).join("")}</p>`:s.type==="space"?"":s.type==="html"?`${s.text}`:s.type==="escape"?s.text:`Unsupported markdown: ${s.type}`}return ie(r,"output"),n.map(r).join("")}ie(Yee,"markdownToHTML");function Zee(e){return Intl.Segmenter?[...new Intl.Segmenter().segment(e)].map(t=>t.segment):[...e]}ie(Zee,"splitTextToChars");function Xee(e,t){const n=Zee(t.content);return p6(e,[],n,t.type)}ie(Xee,"splitWordToFitWidth");function p6(e,t,n,r){if(n.length===0)return[{content:t.join(""),type:r},{content:"",type:r}];const[s,...i]=n,a=[...t,s];return e([{content:a.join(""),type:r}])?p6(e,a,i,r):(t.length===0&&s&&(t.push(s),n.shift()),[{content:t.join(""),type:r},{content:n.join(""),type:r}])}ie(p6,"splitWordToFitWidthRecursion");function Jee(e,t){if(e.some(({content:n})=>n.includes(`
`)))throw new Error("splitLineToFitWidth does not support newlines in the line");return Mk(e,t)}ie(Jee,"splitLineToFitWidth");function Mk(e,t,n=[],r=[]){if(e.length===0)return r.length>0&&n.push(r),n.length>0?n:[];let s="";e[0].content===" "&&(s=" ",e.shift());const i=e.shift()??{content:" ",type:"normal"},a=[...r];if(s!==""&&a.push({content:s,type:"normal"}),a.push(i),t(a))return Mk(e,t,n,a);if(r.length>0)n.push(r),e.unshift(i);else if(i.content){const[o,l]=Xee(t,i);n.push([o]),l.content&&e.unshift(l)}return Mk(e,t,n)}ie(Mk,"splitLineToFitWidthRecursion");function g4(e,t){t&&e.attr("style",t)}ie(g4,"applyStyle");async function Qee(e,t,n,r,s=!1){const i=e.append("foreignObject");i.attr("width",`${10*n}px`),i.attr("height",`${10*n}px`);const a=i.append("xhtml:div");let o=t.label;t.label&&wy(t.label)&&(o=await SD(t.label.replace(rb.lineBreakRegex,`
`),os()));const l=t.isNode?"nodeLabel":"edgeLabel",c=a.append("span");c.html(o),g4(c,t.labelStyle),c.attr("class",`${l} ${r}`),g4(a,t.labelStyle),a.style("display","table-cell"),a.style("white-space","nowrap"),a.style("line-height","1.5"),a.style("max-width",n+"px"),a.style("text-align","center"),a.attr("xmlns","http://www.w3.org/1999/xhtml"),s&&a.attr("class","labelBkg");let u=a.node().getBoundingClientRect();return u.width===n&&(a.style("display","table"),a.style("white-space","break-spaces"),a.style("width",n+"px"),u=a.node().getBoundingClientRect()),i.node()}ie(Qee,"addHtmlSpan");function NT(e,t,n){return e.append("tspan").attr("class","text-outer-tspan").attr("x",0).attr("y",t*n-.1+"em").attr("dy",n+"em")}ie(NT,"createTspan");function ete(e,t,n){const r=e.append("text"),s=NT(r,1,t);MT(s,n);const i=s.node().getComputedTextLength();return r.remove(),i}ie(ete,"computeWidthOfText");function n8e(e,t,n){var a;const r=e.append("text"),s=NT(r,1,t);MT(s,[{content:n,type:"normal"}]);const i=(a=s.node())==null?void 0:a.getBoundingClientRect();return i&&r.remove(),i}ie(n8e,"computeDimensionOfText");function tte(e,t,n,r=!1){const i=t.append("g"),a=i.insert("rect").attr("class","background").attr("style","stroke: none"),o=i.append("text").attr("y","-10.1");let l=0;for(const c of n){const u=ie(h=>ete(i,1.1,h)<=e,"checkWidth"),d=u(c)?[c]:Jee(c,u);for(const h of d){const m=NT(o,l,1.1);MT(m,h),l++}}if(r){const c=o.node().getBBox(),u=2;return a.attr("x",c.x-u).attr("y",c.y-u).attr("width",c.width+2*u).attr("height",c.height+2*u),i.node()}else return o.node()}ie(tte,"createFormattedText");function MT(e,t){e.text(""),t.forEach((n,r)=>{const s=e.append("tspan").attr("font-style",n.type==="em"?"italic":"normal").attr("class","text-inner-tspan").attr("font-weight",n.type==="strong"?"bold":"normal");r===0?s.text(n.content):s.text(" "+n.content)})}ie(MT,"updateTextContentAndStyles");function nte(e){return e.replace(/fa[bklrs]?:fa-[\w-]+/g,t=>`<i class='${t.replace(":"," ")}'></i>`)}ie(nte,"replaceIconSubstring");var Jh=ie(async(e,t="",{style:n="",isTitle:r=!1,classes:s="",useHtmlLabels:i=!0,isNode:a=!0,width:o=200,addSvgBackground:l=!1}={},c)=>{if(zt.debug("XYZ createText",t,n,r,s,i,a,"addSvgBackground: ",l),i){const u=Yee(t,c),d=nte(eg(u)),h=t.replace(/\\\\/g,"\\"),m={isNode:a,label:wy(t)?h:d,labelStyle:n.replace("fill:","color:")};return await Qee(e,m,o,s,l)}else{const u=t.replace(/<br\s*\/?>/g,"<br/>"),d=Kee(u.replace("<br>","<br/>"),c),h=tte(o,e,d,t?l:!1);if(a){/stroke:/.exec(n)&&(n=n.replace("stroke:","lineColor:"));const m=n.replace(/stroke:[^;]+;?/g,"").replace(/stroke-width:[^;]+;?/g,"").replace(/fill:[^;]+;?/g,"").replace(/color:/g,"fill:");Kr(h).attr("style",m)}else{const m=n.replace(/stroke:[^;]+;?/g,"").replace(/stroke-width:[^;]+;?/g,"").replace(/fill:[^;]+;?/g,"").replace(/background:/g,"fill:");Kr(h).select("rect").attr("style",m.replace(/background:/g,"fill:"));const y=n.replace(/stroke:[^;]+;?/g,"").replace(/stroke-width:[^;]+;?/g,"").replace(/fill:[^;]+;?/g,"").replace(/color:/g,"fill:");Kr(h).select("text").attr("style",y)}return h}},"createText");function AI(e,t,n){if(e&&e.length){const[r,s]=t,i=Math.PI/180*n,a=Math.cos(i),o=Math.sin(i);for(const l of e){const[c,u]=l;l[0]=(c-r)*a-(u-s)*o+r,l[1]=(c-r)*o+(u-s)*a+s}}}function r8e(e,t){return e[0]===t[0]&&e[1]===t[1]}function s8e(e,t,n,r=1){const s=n,i=Math.max(t,.1),a=e[0]&&e[0][0]&&typeof e[0][0]=="number"?[e]:e,o=[0,0];if(s)for(const c of a)AI(c,o,s);const l=function(c,u,d){const h=[];for(const w of c){const S=[...w];r8e(S[0],S[S.length-1])||S.push([S[0][0],S[0][1]]),S.length>2&&h.push(S)}const m=[];u=Math.max(u,.1);const y=[];for(const w of h)for(let S=0;S<w.length-1;S++){const C=w[S],k=w[S+1];if(C[1]!==k[1]){const A=Math.min(C[1],k[1]);y.push({ymin:A,ymax:Math.max(C[1],k[1]),x:A===C[1]?C[0]:k[0],islope:(k[0]-C[0])/(k[1]-C[1])})}}if(y.sort((w,S)=>w.ymin<S.ymin?-1:w.ymin>S.ymin?1:w.x<S.x?-1:w.x>S.x?1:w.ymax===S.ymax?0:(w.ymax-S.ymax)/Math.abs(w.ymax-S.ymax)),!y.length)return m;let b=[],v=y[0].ymin,x=0;for(;b.length||y.length;){if(y.length){let w=-1;for(let S=0;S<y.length&&!(y[S].ymin>v);S++)w=S;y.splice(0,w+1).forEach(S=>{b.push({s:v,edge:S})})}if(b=b.filter(w=>!(w.edge.ymax<=v)),b.sort((w,S)=>w.edge.x===S.edge.x?0:(w.edge.x-S.edge.x)/Math.abs(w.edge.x-S.edge.x)),(d!==1||x%u==0)&&b.length>1)for(let w=0;w<b.length;w+=2){const S=w+1;if(S>=b.length)break;const C=b[w].edge,k=b[S].edge;m.push([[Math.round(C.x),v],[Math.round(k.x),v]])}v+=d,b.forEach(w=>{w.edge.x=w.edge.x+d*w.edge.islope}),x++}return m}(a,i,r);if(s){for(const c of a)AI(c,o,-s);(function(c,u,d){const h=[];c.forEach(m=>h.push(...m)),AI(h,u,d)})(l,o,-s)}return l}function Z1(e,t){var n;const r=t.hachureAngle+90;let s=t.hachureGap;s<0&&(s=4*t.strokeWidth),s=Math.round(Math.max(s,.1));let i=1;return t.roughness>=1&&(((n=t.randomizer)===null||n===void 0?void 0:n.next())||Math.random())>.7&&(i=s),s8e(e,s,r,i||1)}class m6{constructor(t){this.helper=t}fillPolygons(t,n){return this._fillPolygons(t,n)}_fillPolygons(t,n){const r=Z1(t,n);return{type:"fillSketch",ops:this.renderLines(r,n)}}renderLines(t,n){const r=[];for(const s of t)r.push(...this.helper.doubleLineOps(s[0][0],s[0][1],s[1][0],s[1][1],n));return r}}function IT(e){const t=e[0],n=e[1];return Math.sqrt(Math.pow(t[0]-n[0],2)+Math.pow(t[1]-n[1],2))}class i8e extends m6{fillPolygons(t,n){let r=n.hachureGap;r<0&&(r=4*n.strokeWidth),r=Math.max(r,.1);const s=Z1(t,Object.assign({},n,{hachureGap:r})),i=Math.PI/180*n.hachureAngle,a=[],o=.5*r*Math.cos(i),l=.5*r*Math.sin(i);for(const[c,u]of s)IT([c,u])&&a.push([[c[0]-o,c[1]+l],[...u]],[[c[0]+o,c[1]-l],[...u]]);return{type:"fillSketch",ops:this.renderLines(a,n)}}}class a8e extends m6{fillPolygons(t,n){const r=this._fillPolygons(t,n),s=Object.assign({},n,{hachureAngle:n.hachureAngle+90}),i=this._fillPolygons(t,s);return r.ops=r.ops.concat(i.ops),r}}class o8e{constructor(t){this.helper=t}fillPolygons(t,n){const r=Z1(t,n=Object.assign({},n,{hachureAngle:0}));return this.dotsOnLines(r,n)}dotsOnLines(t,n){const r=[];let s=n.hachureGap;s<0&&(s=4*n.strokeWidth),s=Math.max(s,.1);let i=n.fillWeight;i<0&&(i=n.strokeWidth/2);const a=s/4;for(const o of t){const l=IT(o),c=l/s,u=Math.ceil(c)-1,d=l-u*s,h=(o[0][0]+o[1][0])/2-s/4,m=Math.min(o[0][1],o[1][1]);for(let y=0;y<u;y++){const b=m+d+y*s,v=h-a+2*Math.random()*a,x=b-a+2*Math.random()*a,w=this.helper.ellipse(v,x,i,i,n);r.push(...w.ops)}}return{type:"fillSketch",ops:r}}}class l8e{constructor(t){this.helper=t}fillPolygons(t,n){const r=Z1(t,n);return{type:"fillSketch",ops:this.dashedLine(r,n)}}dashedLine(t,n){const r=n.dashOffset<0?n.hachureGap<0?4*n.strokeWidth:n.hachureGap:n.dashOffset,s=n.dashGap<0?n.hachureGap<0?4*n.strokeWidth:n.hachureGap:n.dashGap,i=[];return t.forEach(a=>{const o=IT(a),l=Math.floor(o/(r+s)),c=(o+s-l*(r+s))/2;let u=a[0],d=a[1];u[0]>d[0]&&(u=a[1],d=a[0]);const h=Math.atan((d[1]-u[1])/(d[0]-u[0]));for(let m=0;m<l;m++){const y=m*(r+s),b=y+r,v=[u[0]+y*Math.cos(h)+c*Math.cos(h),u[1]+y*Math.sin(h)+c*Math.sin(h)],x=[u[0]+b*Math.cos(h)+c*Math.cos(h),u[1]+b*Math.sin(h)+c*Math.sin(h)];i.push(...this.helper.doubleLineOps(v[0],v[1],x[0],x[1],n))}}),i}}class c8e{constructor(t){this.helper=t}fillPolygons(t,n){const r=n.hachureGap<0?4*n.strokeWidth:n.hachureGap,s=n.zigzagOffset<0?r:n.zigzagOffset,i=Z1(t,n=Object.assign({},n,{hachureGap:r+s}));return{type:"fillSketch",ops:this.zigzagLines(i,s,n)}}zigzagLines(t,n,r){const s=[];return t.forEach(i=>{const a=IT(i),o=Math.round(a/(2*n));let l=i[0],c=i[1];l[0]>c[0]&&(l=i[1],c=i[0]);const u=Math.atan((c[1]-l[1])/(c[0]-l[0]));for(let d=0;d<o;d++){const h=2*d*n,m=2*(d+1)*n,y=Math.sqrt(2*Math.pow(n,2)),b=[l[0]+h*Math.cos(u),l[1]+h*Math.sin(u)],v=[l[0]+m*Math.cos(u),l[1]+m*Math.sin(u)],x=[b[0]+y*Math.cos(u+Math.PI/4),b[1]+y*Math.sin(u+Math.PI/4)];s.push(...this.helper.doubleLineOps(b[0],b[1],x[0],x[1],r),...this.helper.doubleLineOps(x[0],x[1],v[0],v[1],r))}}),s}}const yo={};let u8e=class{constructor(t){this.seed=t}next(){return this.seed?(2**31-1&(this.seed=Math.imul(48271,this.seed)))/2**31:Math.random()}};const d8e=0,RI=1,cU=2,YS={A:7,a:7,C:6,c:6,H:1,h:1,L:2,l:2,M:2,m:2,Q:4,q:4,S:4,s:4,T:2,t:2,V:1,v:1,Z:0,z:0};function NI(e,t){return e.type===t}function g6(e){const t=[],n=function(a){const o=new Array;for(;a!=="";)if(a.match(/^([ \t\r\n,]+)/))a=a.substr(RegExp.$1.length);else if(a.match(/^([aAcChHlLmMqQsStTvVzZ])/))o[o.length]={type:d8e,text:RegExp.$1},a=a.substr(RegExp.$1.length);else{if(!a.match(/^(([-+]?[0-9]+(\.[0-9]*)?|[-+]?\.[0-9]+)([eE][-+]?[0-9]+)?)/))return[];o[o.length]={type:RI,text:`${parseFloat(RegExp.$1)}`},a=a.substr(RegExp.$1.length)}return o[o.length]={type:cU,text:""},o}(e);let r="BOD",s=0,i=n[s];for(;!NI(i,cU);){let a=0;const o=[];if(r==="BOD"){if(i.text!=="M"&&i.text!=="m")return g6("M0,0"+e);s++,a=YS[i.text],r=i.text}else NI(i,RI)?a=YS[r]:(s++,a=YS[i.text],r=i.text);if(!(s+a<n.length))throw new Error("Path data ended short");for(let l=s;l<s+a;l++){const c=n[l];if(!NI(c,RI))throw new Error("Param not a number: "+r+","+c.text);o[o.length]=+c.text}if(typeof YS[r]!="number")throw new Error("Bad segment: "+r);{const l={key:r,data:o};t.push(l),s+=a,i=n[s],r==="M"&&(r="L"),r==="m"&&(r="l")}}return t}function rte(e){let t=0,n=0,r=0,s=0;const i=[];for(const{key:a,data:o}of e)switch(a){case"M":i.push({key:"M",data:[...o]}),[t,n]=o,[r,s]=o;break;case"m":t+=o[0],n+=o[1],i.push({key:"M",data:[t,n]}),r=t,s=n;break;case"L":i.push({key:"L",data:[...o]}),[t,n]=o;break;case"l":t+=o[0],n+=o[1],i.push({key:"L",data:[t,n]});break;case"C":i.push({key:"C",data:[...o]}),t=o[4],n=o[5];break;case"c":{const l=o.map((c,u)=>u%2?c+n:c+t);i.push({key:"C",data:l}),t=l[4],n=l[5];break}case"Q":i.push({key:"Q",data:[...o]}),t=o[2],n=o[3];break;case"q":{const l=o.map((c,u)=>u%2?c+n:c+t);i.push({key:"Q",data:l}),t=l[2],n=l[3];break}case"A":i.push({key:"A",data:[...o]}),t=o[5],n=o[6];break;case"a":t+=o[5],n+=o[6],i.push({key:"A",data:[o[0],o[1],o[2],o[3],o[4],t,n]});break;case"H":i.push({key:"H",data:[...o]}),t=o[0];break;case"h":t+=o[0],i.push({key:"H",data:[t]});break;case"V":i.push({key:"V",data:[...o]}),n=o[0];break;case"v":n+=o[0],i.push({key:"V",data:[n]});break;case"S":i.push({key:"S",data:[...o]}),t=o[2],n=o[3];break;case"s":{const l=o.map((c,u)=>u%2?c+n:c+t);i.push({key:"S",data:l}),t=l[2],n=l[3];break}case"T":i.push({key:"T",data:[...o]}),t=o[0],n=o[1];break;case"t":t+=o[0],n+=o[1],i.push({key:"T",data:[t,n]});break;case"Z":case"z":i.push({key:"Z",data:[]}),t=r,n=s}return i}function ste(e){const t=[];let n="",r=0,s=0,i=0,a=0,o=0,l=0;for(const{key:c,data:u}of e){switch(c){case"M":t.push({key:"M",data:[...u]}),[r,s]=u,[i,a]=u;break;case"C":t.push({key:"C",data:[...u]}),r=u[4],s=u[5],o=u[2],l=u[3];break;case"L":t.push({key:"L",data:[...u]}),[r,s]=u;break;case"H":r=u[0],t.push({key:"L",data:[r,s]});break;case"V":s=u[0],t.push({key:"L",data:[r,s]});break;case"S":{let d=0,h=0;n==="C"||n==="S"?(d=r+(r-o),h=s+(s-l)):(d=r,h=s),t.push({key:"C",data:[d,h,...u]}),o=u[0],l=u[1],r=u[2],s=u[3];break}case"T":{const[d,h]=u;let m=0,y=0;n==="Q"||n==="T"?(m=r+(r-o),y=s+(s-l)):(m=r,y=s);const b=r+2*(m-r)/3,v=s+2*(y-s)/3,x=d+2*(m-d)/3,w=h+2*(y-h)/3;t.push({key:"C",data:[b,v,x,w,d,h]}),o=m,l=y,r=d,s=h;break}case"Q":{const[d,h,m,y]=u,b=r+2*(d-r)/3,v=s+2*(h-s)/3,x=m+2*(d-m)/3,w=y+2*(h-y)/3;t.push({key:"C",data:[b,v,x,w,m,y]}),o=d,l=h,r=m,s=y;break}case"A":{const d=Math.abs(u[0]),h=Math.abs(u[1]),m=u[2],y=u[3],b=u[4],v=u[5],x=u[6];d===0||h===0?(t.push({key:"C",data:[r,s,v,x,v,x]}),r=v,s=x):(r!==v||s!==x)&&(ite(r,s,v,x,d,h,m,y,b).forEach(function(w){t.push({key:"C",data:w})}),r=v,s=x);break}case"Z":t.push({key:"Z",data:[]}),r=i,s=a}n=c}return t}function qv(e,t,n){return[e*Math.cos(n)-t*Math.sin(n),e*Math.sin(n)+t*Math.cos(n)]}function ite(e,t,n,r,s,i,a,o,l,c){const u=(d=a,Math.PI*d/180);var d;let h=[],m=0,y=0,b=0,v=0;if(c)[m,y,b,v]=c;else{[e,t]=qv(e,t,-u),[n,r]=qv(n,r,-u);const V=(e-n)/2,D=(t-r)/2;let Z=V*V/(s*s)+D*D/(i*i);Z>1&&(Z=Math.sqrt(Z),s*=Z,i*=Z);const U=s*s,H=i*i,$=U*H-U*D*D-H*V*V,ne=U*D*D+H*V*V,W=(o===l?-1:1)*Math.sqrt(Math.abs($/ne));b=W*s*D/i+(e+n)/2,v=W*-i*V/s+(t+r)/2,m=Math.asin(parseFloat(((t-v)/i).toFixed(9))),y=Math.asin(parseFloat(((r-v)/i).toFixed(9))),e<b&&(m=Math.PI-m),n<b&&(y=Math.PI-y),m<0&&(m=2*Math.PI+m),y<0&&(y=2*Math.PI+y),l&&m>y&&(m-=2*Math.PI),!l&&y>m&&(y-=2*Math.PI)}let x=y-m;if(Math.abs(x)>120*Math.PI/180){const V=y,D=n,Z=r;y=l&&y>m?m+120*Math.PI/180*1:m+120*Math.PI/180*-1,h=ite(n=b+s*Math.cos(y),r=v+i*Math.sin(y),D,Z,s,i,a,0,l,[y,V,b,v])}x=y-m;const w=Math.cos(m),S=Math.sin(m),C=Math.cos(y),k=Math.sin(y),A=Math.tan(x/4),R=4/3*s*A,N=4/3*i*A,I=[e,t],P=[e+R*S,t-N*w],L=[n+R*k,r-N*C],O=[n,r];if(P[0]=2*I[0]-P[0],P[1]=2*I[1]-P[1],c)return[P,L,O].concat(h);{h=[P,L,O].concat(h);const V=[];for(let D=0;D<h.length;D+=3){const Z=qv(h[D][0],h[D][1],u),U=qv(h[D+1][0],h[D+1][1],u),H=qv(h[D+2][0],h[D+2][1],u);V.push([Z[0],Z[1],U[0],U[1],H[0],H[1]])}return V}}const f8e={randOffset:function(e,t){return Jn(e,t)},randOffsetWithRange:function(e,t,n){return Ik(e,t,n)},ellipse:function(e,t,n,r,s){const i=ote(n,r,s);return y4(e,t,s,i).opset},doubleLineOps:function(e,t,n,r,s){return Mh(e,t,n,r,s,!0)}};function ate(e,t,n,r,s){return{type:"path",ops:Mh(e,t,n,r,s)}}function z2(e,t,n){const r=(e||[]).length;if(r>2){const s=[];for(let i=0;i<r-1;i++)s.push(...Mh(e[i][0],e[i][1],e[i+1][0],e[i+1][1],n));return t&&s.push(...Mh(e[r-1][0],e[r-1][1],e[0][0],e[0][1],n)),{type:"path",ops:s}}return r===2?ate(e[0][0],e[0][1],e[1][0],e[1][1],n):{type:"path",ops:[]}}function h8e(e,t,n,r,s){return function(i,a){return z2(i,!0,a)}([[e,t],[e+n,t],[e+n,t+r],[e,t+r]],s)}function uU(e,t){if(e.length){const n=typeof e[0][0]=="number"?[e]:e,r=ZS(n[0],1*(1+.2*t.roughness),t),s=t.disableMultiStroke?[]:ZS(n[0],1.5*(1+.22*t.roughness),hU(t));for(let i=1;i<n.length;i++){const a=n[i];if(a.length){const o=ZS(a,1*(1+.2*t.roughness),t),l=t.disableMultiStroke?[]:ZS(a,1.5*(1+.22*t.roughness),hU(t));for(const c of o)c.op!=="move"&&r.push(c);for(const c of l)c.op!=="move"&&s.push(c)}}return{type:"path",ops:r.concat(s)}}return{type:"path",ops:[]}}function ote(e,t,n){const r=Math.sqrt(2*Math.PI*Math.sqrt((Math.pow(e/2,2)+Math.pow(t/2,2))/2)),s=Math.ceil(Math.max(n.curveStepCount,n.curveStepCount/Math.sqrt(200)*r)),i=2*Math.PI/s;let a=Math.abs(e/2),o=Math.abs(t/2);const l=1-n.curveFitting;return a+=Jn(a*l,n),o+=Jn(o*l,n),{increment:i,rx:a,ry:o}}function y4(e,t,n,r){const[s,i]=pU(r.increment,e,t,r.rx,r.ry,1,r.increment*Ik(.1,Ik(.4,1,n),n),n);let a=jk(s,null,n);if(!n.disableMultiStroke&&n.roughness!==0){const[o]=pU(r.increment,e,t,r.rx,r.ry,1.5,0,n),l=jk(o,null,n);a=a.concat(l)}return{estimatedPoints:i,opset:{type:"path",ops:a}}}function dU(e,t,n,r,s,i,a,o,l){const c=e,u=t;let d=Math.abs(n/2),h=Math.abs(r/2);d+=Jn(.01*d,l),h+=Jn(.01*h,l);let m=s,y=i;for(;m<0;)m+=2*Math.PI,y+=2*Math.PI;y-m>2*Math.PI&&(m=0,y=2*Math.PI);const b=2*Math.PI/l.curveStepCount,v=Math.min(b/2,(y-m)/2),x=mU(v,c,u,d,h,m,y,1,l);if(!l.disableMultiStroke){const w=mU(v,c,u,d,h,m,y,1.5,l);x.push(...w)}return a&&(o?x.push(...Mh(c,u,c+d*Math.cos(m),u+h*Math.sin(m),l),...Mh(c,u,c+d*Math.cos(y),u+h*Math.sin(y),l)):x.push({op:"lineTo",data:[c,u]},{op:"lineTo",data:[c+d*Math.cos(m),u+h*Math.sin(m)]})),{type:"path",ops:x}}function fU(e,t){const n=ste(rte(g6(e))),r=[];let s=[0,0],i=[0,0];for(const{key:a,data:o}of n)switch(a){case"M":i=[o[0],o[1]],s=[o[0],o[1]];break;case"L":r.push(...Mh(i[0],i[1],o[0],o[1],t)),i=[o[0],o[1]];break;case"C":{const[l,c,u,d,h,m]=o;r.push(...p8e(l,c,u,d,h,m,i,t)),i=[h,m];break}case"Z":r.push(...Mh(i[0],i[1],s[0],s[1],t)),i=[s[0],s[1]]}return{type:"path",ops:r}}function MI(e,t){const n=[];for(const r of e)if(r.length){const s=t.maxRandomnessOffset||0,i=r.length;if(i>2){n.push({op:"move",data:[r[0][0]+Jn(s,t),r[0][1]+Jn(s,t)]});for(let a=1;a<i;a++)n.push({op:"lineTo",data:[r[a][0]+Jn(s,t),r[a][1]+Jn(s,t)]})}}return{type:"fillPath",ops:n}}function t0(e,t){return function(n,r){let s=n.fillStyle||"hachure";if(!yo[s])switch(s){case"zigzag":yo[s]||(yo[s]=new i8e(r));break;case"cross-hatch":yo[s]||(yo[s]=new a8e(r));break;case"dots":yo[s]||(yo[s]=new o8e(r));break;case"dashed":yo[s]||(yo[s]=new l8e(r));break;case"zigzag-line":yo[s]||(yo[s]=new c8e(r));break;default:s="hachure",yo[s]||(yo[s]=new m6(r))}return yo[s]}(t,f8e).fillPolygons(e,t)}function hU(e){const t=Object.assign({},e);return t.randomizer=void 0,e.seed&&(t.seed=e.seed+1),t}function lte(e){return e.randomizer||(e.randomizer=new u8e(e.seed||0)),e.randomizer.next()}function Ik(e,t,n,r=1){return n.roughness*r*(lte(n)*(t-e)+e)}function Jn(e,t,n=1){return Ik(-e,e,t,n)}function Mh(e,t,n,r,s,i=!1){const a=i?s.disableMultiStrokeFill:s.disableMultiStroke,o=b4(e,t,n,r,s,!0,!1);if(a)return o;const l=b4(e,t,n,r,s,!0,!0);return o.concat(l)}function b4(e,t,n,r,s,i,a){const o=Math.pow(e-n,2)+Math.pow(t-r,2),l=Math.sqrt(o);let c=1;c=l<200?1:l>500?.4:-.0016668*l+1.233334;let u=s.maxRandomnessOffset||0;u*u*100>o&&(u=l/10);const d=u/2,h=.2+.2*lte(s);let m=s.bowing*s.maxRandomnessOffset*(r-t)/200,y=s.bowing*s.maxRandomnessOffset*(e-n)/200;m=Jn(m,s,c),y=Jn(y,s,c);const b=[],v=()=>Jn(d,s,c),x=()=>Jn(u,s,c),w=s.preserveVertices;return a?b.push({op:"move",data:[e+(w?0:v()),t+(w?0:v())]}):b.push({op:"move",data:[e+(w?0:Jn(u,s,c)),t+(w?0:Jn(u,s,c))]}),a?b.push({op:"bcurveTo",data:[m+e+(n-e)*h+v(),y+t+(r-t)*h+v(),m+e+2*(n-e)*h+v(),y+t+2*(r-t)*h+v(),n+(w?0:v()),r+(w?0:v())]}):b.push({op:"bcurveTo",data:[m+e+(n-e)*h+x(),y+t+(r-t)*h+x(),m+e+2*(n-e)*h+x(),y+t+2*(r-t)*h+x(),n+(w?0:x()),r+(w?0:x())]}),b}function ZS(e,t,n){if(!e.length)return[];const r=[];r.push([e[0][0]+Jn(t,n),e[0][1]+Jn(t,n)]),r.push([e[0][0]+Jn(t,n),e[0][1]+Jn(t,n)]);for(let s=1;s<e.length;s++)r.push([e[s][0]+Jn(t,n),e[s][1]+Jn(t,n)]),s===e.length-1&&r.push([e[s][0]+Jn(t,n),e[s][1]+Jn(t,n)]);return jk(r,null,n)}function jk(e,t,n){const r=e.length,s=[];if(r>3){const i=[],a=1-n.curveTightness;s.push({op:"move",data:[e[1][0],e[1][1]]});for(let o=1;o+2<r;o++){const l=e[o];i[0]=[l[0],l[1]],i[1]=[l[0]+(a*e[o+1][0]-a*e[o-1][0])/6,l[1]+(a*e[o+1][1]-a*e[o-1][1])/6],i[2]=[e[o+1][0]+(a*e[o][0]-a*e[o+2][0])/6,e[o+1][1]+(a*e[o][1]-a*e[o+2][1])/6],i[3]=[e[o+1][0],e[o+1][1]],s.push({op:"bcurveTo",data:[i[1][0],i[1][1],i[2][0],i[2][1],i[3][0],i[3][1]]})}}else r===3?(s.push({op:"move",data:[e[1][0],e[1][1]]}),s.push({op:"bcurveTo",data:[e[1][0],e[1][1],e[2][0],e[2][1],e[2][0],e[2][1]]})):r===2&&s.push(...b4(e[0][0],e[0][1],e[1][0],e[1][1],n,!0,!0));return s}function pU(e,t,n,r,s,i,a,o){const l=[],c=[];if(o.roughness===0){e/=4,c.push([t+r*Math.cos(-e),n+s*Math.sin(-e)]);for(let u=0;u<=2*Math.PI;u+=e){const d=[t+r*Math.cos(u),n+s*Math.sin(u)];l.push(d),c.push(d)}c.push([t+r*Math.cos(0),n+s*Math.sin(0)]),c.push([t+r*Math.cos(e),n+s*Math.sin(e)])}else{const u=Jn(.5,o)-Math.PI/2;c.push([Jn(i,o)+t+.9*r*Math.cos(u-e),Jn(i,o)+n+.9*s*Math.sin(u-e)]);const d=2*Math.PI+u-.01;for(let h=u;h<d;h+=e){const m=[Jn(i,o)+t+r*Math.cos(h),Jn(i,o)+n+s*Math.sin(h)];l.push(m),c.push(m)}c.push([Jn(i,o)+t+r*Math.cos(u+2*Math.PI+.5*a),Jn(i,o)+n+s*Math.sin(u+2*Math.PI+.5*a)]),c.push([Jn(i,o)+t+.98*r*Math.cos(u+a),Jn(i,o)+n+.98*s*Math.sin(u+a)]),c.push([Jn(i,o)+t+.9*r*Math.cos(u+.5*a),Jn(i,o)+n+.9*s*Math.sin(u+.5*a)])}return[c,l]}function mU(e,t,n,r,s,i,a,o,l){const c=i+Jn(.1,l),u=[];u.push([Jn(o,l)+t+.9*r*Math.cos(c-e),Jn(o,l)+n+.9*s*Math.sin(c-e)]);for(let d=c;d<=a;d+=e)u.push([Jn(o,l)+t+r*Math.cos(d),Jn(o,l)+n+s*Math.sin(d)]);return u.push([t+r*Math.cos(a),n+s*Math.sin(a)]),u.push([t+r*Math.cos(a),n+s*Math.sin(a)]),jk(u,null,l)}function p8e(e,t,n,r,s,i,a,o){const l=[],c=[o.maxRandomnessOffset||1,(o.maxRandomnessOffset||1)+.3];let u=[0,0];const d=o.disableMultiStroke?1:2,h=o.preserveVertices;for(let m=0;m<d;m++)m===0?l.push({op:"move",data:[a[0],a[1]]}):l.push({op:"move",data:[a[0]+(h?0:Jn(c[0],o)),a[1]+(h?0:Jn(c[0],o))]}),u=h?[s,i]:[s+Jn(c[m],o),i+Jn(c[m],o)],l.push({op:"bcurveTo",data:[e+Jn(c[m],o),t+Jn(c[m],o),n+Jn(c[m],o),r+Jn(c[m],o),u[0],u[1]]});return l}function Vv(e){return[...e]}function gU(e,t=0){const n=e.length;if(n<3)throw new Error("A curve must have at least three points.");const r=[];if(n===3)r.push(Vv(e[0]),Vv(e[1]),Vv(e[2]),Vv(e[2]));else{const s=[];s.push(e[0],e[0]);for(let o=1;o<e.length;o++)s.push(e[o]),o===e.length-1&&s.push(e[o]);const i=[],a=1-t;r.push(Vv(s[0]));for(let o=1;o+2<s.length;o++){const l=s[o];i[0]=[l[0],l[1]],i[1]=[l[0]+(a*s[o+1][0]-a*s[o-1][0])/6,l[1]+(a*s[o+1][1]-a*s[o-1][1])/6],i[2]=[s[o+1][0]+(a*s[o][0]-a*s[o+2][0])/6,s[o+1][1]+(a*s[o][1]-a*s[o+2][1])/6],i[3]=[s[o+1][0],s[o+1][1]],r.push(i[1],i[2],i[3])}}return r}function U2(e,t){return Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2)}function m8e(e,t,n){const r=U2(t,n);if(r===0)return U2(e,t);let s=((e[0]-t[0])*(n[0]-t[0])+(e[1]-t[1])*(n[1]-t[1]))/r;return s=Math.max(0,Math.min(1,s)),U2(e,Wp(t,n,s))}function Wp(e,t,n){return[e[0]+(t[0]-e[0])*n,e[1]+(t[1]-e[1])*n]}function v4(e,t,n,r){const s=r||[];if(function(o,l){const c=o[l+0],u=o[l+1],d=o[l+2],h=o[l+3];let m=3*u[0]-2*c[0]-h[0];m*=m;let y=3*u[1]-2*c[1]-h[1];y*=y;let b=3*d[0]-2*h[0]-c[0];b*=b;let v=3*d[1]-2*h[1]-c[1];return v*=v,m<b&&(m=b),y<v&&(y=v),m+y}(e,t)<n){const o=e[t+0];s.length?(i=s[s.length-1],a=o,Math.sqrt(U2(i,a))>1&&s.push(o)):s.push(o),s.push(e[t+3])}else{const l=e[t+0],c=e[t+1],u=e[t+2],d=e[t+3],h=Wp(l,c,.5),m=Wp(c,u,.5),y=Wp(u,d,.5),b=Wp(h,m,.5),v=Wp(m,y,.5),x=Wp(b,v,.5);v4([l,h,b,x],0,n,s),v4([x,v,y,d],0,n,s)}var i,a;return s}function g8e(e,t){return Pk(e,0,e.length,t)}function Pk(e,t,n,r,s){const i=s||[],a=e[t],o=e[n-1];let l=0,c=1;for(let u=t+1;u<n-1;++u){const d=m8e(e[u],a,o);d>l&&(l=d,c=u)}return Math.sqrt(l)>r?(Pk(e,t,c+1,r,i),Pk(e,c,n,r,i)):(i.length||i.push(a),i.push(o)),i}function II(e,t=.15,n){const r=[],s=(e.length-1)/3;for(let i=0;i<s;i++)v4(e,3*i,t,r);return n&&n>0?Pk(r,0,r.length,n):r}const el="none";class Ok{constructor(t){this.defaultOptions={maxRandomnessOffset:2,roughness:1,bowing:1,stroke:"#000",strokeWidth:1,curveTightness:0,curveFitting:.95,curveStepCount:9,fillStyle:"hachure",fillWeight:-1,hachureAngle:-41,hachureGap:-1,dashOffset:-1,dashGap:-1,zigzagOffset:-1,seed:0,disableMultiStroke:!1,disableMultiStrokeFill:!1,preserveVertices:!1,fillShapeRoughnessGain:.8},this.config=t||{},this.config.options&&(this.defaultOptions=this._o(this.config.options))}static newSeed(){return Math.floor(Math.random()*2**31)}_o(t){return t?Object.assign({},this.defaultOptions,t):this.defaultOptions}_d(t,n,r){return{shape:t,sets:n||[],options:r||this.defaultOptions}}line(t,n,r,s,i){const a=this._o(i);return this._d("line",[ate(t,n,r,s,a)],a)}rectangle(t,n,r,s,i){const a=this._o(i),o=[],l=h8e(t,n,r,s,a);if(a.fill){const c=[[t,n],[t+r,n],[t+r,n+s],[t,n+s]];a.fillStyle==="solid"?o.push(MI([c],a)):o.push(t0([c],a))}return a.stroke!==el&&o.push(l),this._d("rectangle",o,a)}ellipse(t,n,r,s,i){const a=this._o(i),o=[],l=ote(r,s,a),c=y4(t,n,a,l);if(a.fill)if(a.fillStyle==="solid"){const u=y4(t,n,a,l).opset;u.type="fillPath",o.push(u)}else o.push(t0([c.estimatedPoints],a));return a.stroke!==el&&o.push(c.opset),this._d("ellipse",o,a)}circle(t,n,r,s){const i=this.ellipse(t,n,r,r,s);return i.shape="circle",i}linearPath(t,n){const r=this._o(n);return this._d("linearPath",[z2(t,!1,r)],r)}arc(t,n,r,s,i,a,o=!1,l){const c=this._o(l),u=[],d=dU(t,n,r,s,i,a,o,!0,c);if(o&&c.fill)if(c.fillStyle==="solid"){const h=Object.assign({},c);h.disableMultiStroke=!0;const m=dU(t,n,r,s,i,a,!0,!1,h);m.type="fillPath",u.push(m)}else u.push(function(h,m,y,b,v,x,w){const S=h,C=m;let k=Math.abs(y/2),A=Math.abs(b/2);k+=Jn(.01*k,w),A+=Jn(.01*A,w);let R=v,N=x;for(;R<0;)R+=2*Math.PI,N+=2*Math.PI;N-R>2*Math.PI&&(R=0,N=2*Math.PI);const I=(N-R)/w.curveStepCount,P=[];for(let L=R;L<=N;L+=I)P.push([S+k*Math.cos(L),C+A*Math.sin(L)]);return P.push([S+k*Math.cos(N),C+A*Math.sin(N)]),P.push([S,C]),t0([P],w)}(t,n,r,s,i,a,c));return c.stroke!==el&&u.push(d),this._d("arc",u,c)}curve(t,n){const r=this._o(n),s=[],i=uU(t,r);if(r.fill&&r.fill!==el)if(r.fillStyle==="solid"){const a=uU(t,Object.assign(Object.assign({},r),{disableMultiStroke:!0,roughness:r.roughness?r.roughness+r.fillShapeRoughnessGain:0}));s.push({type:"fillPath",ops:this._mergedShape(a.ops)})}else{const a=[],o=t;if(o.length){const l=typeof o[0][0]=="number"?[o]:o;for(const c of l)c.length<3?a.push(...c):c.length===3?a.push(...II(gU([c[0],c[0],c[1],c[2]]),10,(1+r.roughness)/2)):a.push(...II(gU(c),10,(1+r.roughness)/2))}a.length&&s.push(t0([a],r))}return r.stroke!==el&&s.push(i),this._d("curve",s,r)}polygon(t,n){const r=this._o(n),s=[],i=z2(t,!0,r);return r.fill&&(r.fillStyle==="solid"?s.push(MI([t],r)):s.push(t0([t],r))),r.stroke!==el&&s.push(i),this._d("polygon",s,r)}path(t,n){const r=this._o(n),s=[];if(!t)return this._d("path",s,r);t=(t||"").replace(/\n/g," ").replace(/(-\s)/g,"-").replace("/(ss)/g"," ");const i=r.fill&&r.fill!=="transparent"&&r.fill!==el,a=r.stroke!==el,o=!!(r.simplification&&r.simplification<1),l=function(u,d,h){const m=ste(rte(g6(u))),y=[];let b=[],v=[0,0],x=[];const w=()=>{x.length>=4&&b.push(...II(x,d)),x=[]},S=()=>{w(),b.length&&(y.push(b),b=[])};for(const{key:k,data:A}of m)switch(k){case"M":S(),v=[A[0],A[1]],b.push(v);break;case"L":w(),b.push([A[0],A[1]]);break;case"C":if(!x.length){const R=b.length?b[b.length-1]:v;x.push([R[0],R[1]])}x.push([A[0],A[1]]),x.push([A[2],A[3]]),x.push([A[4],A[5]]);break;case"Z":w(),b.push([v[0],v[1]])}if(S(),!h)return y;const C=[];for(const k of y){const A=g8e(k,h);A.length&&C.push(A)}return C}(t,1,o?4-4*(r.simplification||1):(1+r.roughness)/2),c=fU(t,r);if(i)if(r.fillStyle==="solid")if(l.length===1){const u=fU(t,Object.assign(Object.assign({},r),{disableMultiStroke:!0,roughness:r.roughness?r.roughness+r.fillShapeRoughnessGain:0}));s.push({type:"fillPath",ops:this._mergedShape(u.ops)})}else s.push(MI(l,r));else s.push(t0(l,r));return a&&(o?l.forEach(u=>{s.push(z2(u,!1,r))}):s.push(c)),this._d("path",s,r)}opsToPath(t,n){let r="";for(const s of t.ops){const i=typeof n=="number"&&n>=0?s.data.map(a=>+a.toFixed(n)):s.data;switch(s.op){case"move":r+=`M${i[0]} ${i[1]} `;break;case"bcurveTo":r+=`C${i[0]} ${i[1]}, ${i[2]} ${i[3]}, ${i[4]} ${i[5]} `;break;case"lineTo":r+=`L${i[0]} ${i[1]} `}}return r.trim()}toPaths(t){const n=t.sets||[],r=t.options||this.defaultOptions,s=[];for(const i of n){let a=null;switch(i.type){case"path":a={d:this.opsToPath(i),stroke:r.stroke,strokeWidth:r.strokeWidth,fill:el};break;case"fillPath":a={d:this.opsToPath(i),stroke:el,strokeWidth:0,fill:r.fill||el};break;case"fillSketch":a=this.fillSketch(i,r)}a&&s.push(a)}return s}fillSketch(t,n){let r=n.fillWeight;return r<0&&(r=n.strokeWidth/2),{d:this.opsToPath(t),stroke:n.fill||el,strokeWidth:r,fill:el}}_mergedShape(t){return t.filter((n,r)=>r===0||n.op!=="move")}}class y8e{constructor(t,n){this.canvas=t,this.ctx=this.canvas.getContext("2d"),this.gen=new Ok(n)}draw(t){const n=t.sets||[],r=t.options||this.getDefaultOptions(),s=this.ctx,i=t.options.fixedDecimalPlaceDigits;for(const a of n)switch(a.type){case"path":s.save(),s.strokeStyle=r.stroke==="none"?"transparent":r.stroke,s.lineWidth=r.strokeWidth,r.strokeLineDash&&s.setLineDash(r.strokeLineDash),r.strokeLineDashOffset&&(s.lineDashOffset=r.strokeLineDashOffset),this._drawToContext(s,a,i),s.restore();break;case"fillPath":{s.save(),s.fillStyle=r.fill||"";const o=t.shape==="curve"||t.shape==="polygon"||t.shape==="path"?"evenodd":"nonzero";this._drawToContext(s,a,i,o),s.restore();break}case"fillSketch":this.fillSketch(s,a,r)}}fillSketch(t,n,r){let s=r.fillWeight;s<0&&(s=r.strokeWidth/2),t.save(),r.fillLineDash&&t.setLineDash(r.fillLineDash),r.fillLineDashOffset&&(t.lineDashOffset=r.fillLineDashOffset),t.strokeStyle=r.fill||"",t.lineWidth=s,this._drawToContext(t,n,r.fixedDecimalPlaceDigits),t.restore()}_drawToContext(t,n,r,s="nonzero"){t.beginPath();for(const i of n.ops){const a=typeof r=="number"&&r>=0?i.data.map(o=>+o.toFixed(r)):i.data;switch(i.op){case"move":t.moveTo(a[0],a[1]);break;case"bcurveTo":t.bezierCurveTo(a[0],a[1],a[2],a[3],a[4],a[5]);break;case"lineTo":t.lineTo(a[0],a[1])}}n.type==="fillPath"?t.fill(s):t.stroke()}get generator(){return this.gen}getDefaultOptions(){return this.gen.defaultOptions}line(t,n,r,s,i){const a=this.gen.line(t,n,r,s,i);return this.draw(a),a}rectangle(t,n,r,s,i){const a=this.gen.rectangle(t,n,r,s,i);return this.draw(a),a}ellipse(t,n,r,s,i){const a=this.gen.ellipse(t,n,r,s,i);return this.draw(a),a}circle(t,n,r,s){const i=this.gen.circle(t,n,r,s);return this.draw(i),i}linearPath(t,n){const r=this.gen.linearPath(t,n);return this.draw(r),r}polygon(t,n){const r=this.gen.polygon(t,n);return this.draw(r),r}arc(t,n,r,s,i,a,o=!1,l){const c=this.gen.arc(t,n,r,s,i,a,o,l);return this.draw(c),c}curve(t,n){const r=this.gen.curve(t,n);return this.draw(r),r}path(t,n){const r=this.gen.path(t,n);return this.draw(r),r}}const XS="http://www.w3.org/2000/svg";class b8e{constructor(t,n){this.svg=t,this.gen=new Ok(n)}draw(t){const n=t.sets||[],r=t.options||this.getDefaultOptions(),s=this.svg.ownerDocument||window.document,i=s.createElementNS(XS,"g"),a=t.options.fixedDecimalPlaceDigits;for(const o of n){let l=null;switch(o.type){case"path":l=s.createElementNS(XS,"path"),l.setAttribute("d",this.opsToPath(o,a)),l.setAttribute("stroke",r.stroke),l.setAttribute("stroke-width",r.strokeWidth+""),l.setAttribute("fill","none"),r.strokeLineDash&&l.setAttribute("stroke-dasharray",r.strokeLineDash.join(" ").trim()),r.strokeLineDashOffset&&l.setAttribute("stroke-dashoffset",`${r.strokeLineDashOffset}`);break;case"fillPath":l=s.createElementNS(XS,"path"),l.setAttribute("d",this.opsToPath(o,a)),l.setAttribute("stroke","none"),l.setAttribute("stroke-width","0"),l.setAttribute("fill",r.fill||""),t.shape!=="curve"&&t.shape!=="polygon"||l.setAttribute("fill-rule","evenodd");break;case"fillSketch":l=this.fillSketch(s,o,r)}l&&i.appendChild(l)}return i}fillSketch(t,n,r){let s=r.fillWeight;s<0&&(s=r.strokeWidth/2);const i=t.createElementNS(XS,"path");return i.setAttribute("d",this.opsToPath(n,r.fixedDecimalPlaceDigits)),i.setAttribute("stroke",r.fill||""),i.setAttribute("stroke-width",s+""),i.setAttribute("fill","none"),r.fillLineDash&&i.setAttribute("stroke-dasharray",r.fillLineDash.join(" ").trim()),r.fillLineDashOffset&&i.setAttribute("stroke-dashoffset",`${r.fillLineDashOffset}`),i}get generator(){return this.gen}getDefaultOptions(){return this.gen.defaultOptions}opsToPath(t,n){return this.gen.opsToPath(t,n)}line(t,n,r,s,i){const a=this.gen.line(t,n,r,s,i);return this.draw(a)}rectangle(t,n,r,s,i){const a=this.gen.rectangle(t,n,r,s,i);return this.draw(a)}ellipse(t,n,r,s,i){const a=this.gen.ellipse(t,n,r,s,i);return this.draw(a)}circle(t,n,r,s){const i=this.gen.circle(t,n,r,s);return this.draw(i)}linearPath(t,n){const r=this.gen.linearPath(t,n);return this.draw(r)}polygon(t,n){const r=this.gen.polygon(t,n);return this.draw(r)}arc(t,n,r,s,i,a,o=!1,l){const c=this.gen.arc(t,n,r,s,i,a,o,l);return this.draw(c)}curve(t,n){const r=this.gen.curve(t,n);return this.draw(r)}path(t,n){const r=this.gen.path(t,n);return this.draw(r)}}var kn={canvas:(e,t)=>new y8e(e,t),svg:(e,t)=>new b8e(e,t),generator:e=>new Ok(e),newSeed:()=>Ok.newSeed()},ur=ie(async(e,t,n)=>{var d,h;let r;const s=t.useHtmlLabels||Wi((d=os())==null?void 0:d.htmlLabels);n?r=n:r="node default";const i=e.insert("g").attr("class",r).attr("id",t.domId||t.id),a=i.insert("g").attr("class","label").attr("style",ro(t.labelStyle));let o;t.label===void 0?o="":o=typeof t.label=="string"?t.label:t.label[0];const l=await Jh(a,Tm(eg(o),os()),{useHtmlLabels:s,width:t.width||((h=os().flowchart)==null?void 0:h.wrappingWidth),cssClasses:"markdown-node-label",style:t.labelStyle,addSvgBackground:!!t.icon||!!t.img});let c=l.getBBox();const u=((t==null?void 0:t.padding)??0)/2;if(s){const m=l.children[0],y=Kr(l),b=m.getElementsByTagName("img");if(b){const v=o.replace(/<img[^>]*>/g,"").trim()==="";await Promise.all([...b].map(x=>new Promise(w=>{function S(){if(x.style.display="flex",x.style.flexDirection="column",v){const C=os().fontSize?os().fontSize:window.getComputedStyle(document.body).fontSize,k=5,[A=CX.fontSize]=TT(C),R=A*k+"px";x.style.minWidth=R,x.style.maxWidth=R}else x.style.width="100%";w(x)}ie(S,"setupImage"),setTimeout(()=>{x.complete&&S()}),x.addEventListener("error",S),x.addEventListener("load",S)})))}c=m.getBoundingClientRect(),y.attr("width",c.width),y.attr("height",c.height)}return s?a.attr("transform","translate("+-c.width/2+", "+-c.height/2+")"):a.attr("transform","translate(0, "+-c.height/2+")"),t.centerLabel&&a.attr("transform","translate("+-c.width/2+", "+-c.height/2+")"),a.insert("rect",":first-child"),{shapeSvg:i,bbox:c,halfPadding:u,label:a}},"labelHelper"),jI=ie(async(e,t,n)=>{var l,c,u,d,h,m;const r=n.useHtmlLabels||Wi((c=(l=os())==null?void 0:l.flowchart)==null?void 0:c.htmlLabels),s=e.insert("g").attr("class","label").attr("style",n.labelStyle||""),i=await Jh(s,Tm(eg(t),os()),{useHtmlLabels:r,width:n.width||((d=(u=os())==null?void 0:u.flowchart)==null?void 0:d.wrappingWidth),style:n.labelStyle,addSvgBackground:!!n.icon||!!n.img});let a=i.getBBox();const o=n.padding/2;if(Wi((m=(h=os())==null?void 0:h.flowchart)==null?void 0:m.htmlLabels)){const y=i.children[0],b=Kr(i);a=y.getBoundingClientRect(),b.attr("width",a.width),b.attr("height",a.height)}return r?s.attr("transform","translate("+-a.width/2+", "+-a.height/2+")"):s.attr("transform","translate(0, "+-a.height/2+")"),n.centerLabel&&s.attr("transform","translate("+-a.width/2+", "+-a.height/2+")"),s.insert("rect",":first-child"),{shapeSvg:e,bbox:a,halfPadding:o,label:s}},"insertLabel"),Mn=ie((e,t)=>{const n=t.node().getBBox();e.width=n.width,e.height=n.height},"updateNodeBounds"),tr=ie((e,t)=>(e.look==="handDrawn"?"rough-node":"node")+" "+e.cssClasses+" "+(t||""),"getNodeClasses");function Xr(e){const t=e.map((n,r)=>`${r===0?"M":"L"}${n.x},${n.y}`);return t.push("Z"),t.join(" ")}ie(Xr,"createPathFromPoints");function Ih(e,t,n,r,s,i){const a=[],l=n-e,c=r-t,u=l/i,d=2*Math.PI/u,h=t+c/2;for(let m=0;m<=50;m++){const y=m/50,b=e+y*l,v=h+s*Math.sin(d*(b-e));a.push({x:b,y:v})}return a}ie(Ih,"generateFullSineWavePoints");function y6(e,t,n,r,s,i){const a=[],o=s*Math.PI/180,u=(i*Math.PI/180-o)/(r-1);for(let d=0;d<r;d++){const h=o+d*u,m=e+n*Math.cos(h),y=t+n*Math.sin(h);a.push({x:-m,y:-y})}return a}ie(y6,"generateCirclePoints");var v8e=ie((e,t)=>{var n=e.x,r=e.y,s=t.x-n,i=t.y-r,a=e.width/2,o=e.height/2,l,c;return Math.abs(i)*a>Math.abs(s)*o?(i<0&&(o=-o),l=i===0?0:o*s/i,c=o):(s<0&&(a=-a),l=a,c=s===0?0:a*i/s),{x:n+l,y:r+c}},"intersectRect"),ab=v8e;function cte(e,t){t&&e.attr("style",t)}ie(cte,"applyStyle");async function ute(e){const t=Kr(document.createElementNS("http://www.w3.org/2000/svg","foreignObject")),n=t.append("xhtml:div");let r=e.label;e.label&&wy(e.label)&&(r=await SD(e.label.replace(rb.lineBreakRegex,`
`),os()));const s=e.isNode?"nodeLabel":"edgeLabel";return n.html('<span class="'+s+'" '+(e.labelStyle?'style="'+e.labelStyle+'"':"")+">"+r+"</span>"),cte(n,e.labelStyle),n.style("display","inline-block"),n.style("padding-right","1px"),n.style("white-space","nowrap"),n.attr("xmlns","http://www.w3.org/1999/xhtml"),t.node()}ie(ute,"addHtmlLabel");var x8e=ie(async(e,t,n,r)=>{let s=e||"";if(typeof s=="object"&&(s=s[0]),Wi(os().flowchart.htmlLabels)){s=s.replace(/\\n|\n/g,"<br />"),zt.info("vertexText"+s);const i={isNode:r,label:eg(s).replace(/fa[blrs]?:fa-[\w-]+/g,o=>`<i class='${o.replace(":"," ")}'></i>`),labelStyle:t&&t.replace("fill:","color:")};return await ute(i)}else{const i=document.createElementNS("http://www.w3.org/2000/svg","text");i.setAttribute("style",t.replace("color:","fill:"));let a=[];typeof s=="string"?a=s.split(/\\n|\n|<br\s*\/?>/gi):Array.isArray(s)?a=s:a=[];for(const o of a){const l=document.createElementNS("http://www.w3.org/2000/svg","tspan");l.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),l.setAttribute("dy","1em"),l.setAttribute("x","0"),n?l.setAttribute("class","title-row"):l.setAttribute("class","row"),l.textContent=o.trim(),i.appendChild(l)}return i}},"createLabel"),sm=x8e,sf=ie((e,t,n,r,s)=>["M",e+s,t,"H",e+n-s,"A",s,s,0,0,1,e+n,t+s,"V",t+r-s,"A",s,s,0,0,1,e+n-s,t+r,"H",e+s,"A",s,s,0,0,1,e,t+r-s,"V",t+s,"A",s,s,0,0,1,e+s,t,"Z"].join(" "),"createRoundedRectPathD"),w8e=ie(e=>{const{handDrawnSeed:t}=os();return{fill:e,hachureAngle:120,hachureGap:4,fillWeight:2,roughness:.7,stroke:e,seed:t}},"solidStateFill"),ob=ie(e=>{const t=_8e([...e.cssCompiledStyles||[],...e.cssStyles||[]]);return{stylesMap:t,stylesArray:[...t]}},"compileStyles"),_8e=ie(e=>{const t=new Map;return e.forEach(n=>{const[r,s]=n.split(":");t.set(r.trim(),s==null?void 0:s.trim())}),t},"styles2Map"),dte=ie(e=>e==="color"||e==="font-size"||e==="font-family"||e==="font-weight"||e==="font-style"||e==="text-decoration"||e==="text-align"||e==="text-transform"||e==="line-height"||e==="letter-spacing"||e==="word-spacing"||e==="text-shadow"||e==="text-overflow"||e==="white-space"||e==="word-wrap"||e==="word-break"||e==="overflow-wrap"||e==="hyphens","isLabelStyle"),In=ie(e=>{const{stylesArray:t}=ob(e),n=[],r=[],s=[],i=[];return t.forEach(a=>{const o=a[0];dte(o)?n.push(a.join(":")+" !important"):(r.push(a.join(":")+" !important"),o.includes("stroke")&&s.push(a.join(":")+" !important"),o==="fill"&&i.push(a.join(":")+" !important"))}),{labelStyles:n.join(";"),nodeStyles:r.join(";"),stylesArray:t,borderStyles:s,backgroundStyles:i}},"styles2String"),Tn=ie((e,t)=>{var l;const{themeVariables:n,handDrawnSeed:r}=os(),{nodeBorder:s,mainBkg:i}=n,{stylesMap:a}=ob(e);return Object.assign({roughness:.7,fill:a.get("fill")||i,fillStyle:"hachure",fillWeight:4,hachureGap:5.2,stroke:a.get("stroke")||s,seed:r,strokeWidth:((l=a.get("stroke-width"))==null?void 0:l.replace("px",""))||1.3,fillLineDash:[0,0]},t)},"userNodeOverrides"),fte=ie(async(e,t)=>{zt.info("Creating subgraph rect for ",t.id,t);const n=os(),{themeVariables:r,handDrawnSeed:s}=n,{clusterBkg:i,clusterBorder:a}=r,{labelStyles:o,nodeStyles:l,borderStyles:c,backgroundStyles:u}=In(t),d=e.insert("g").attr("class","cluster "+t.cssClasses).attr("id",t.id).attr("data-look",t.look),h=Wi(n.flowchart.htmlLabels),m=d.insert("g").attr("class","cluster-label "),y=await Jh(m,t.label,{style:t.labelStyle,useHtmlLabels:h,isNode:!0});let b=y.getBBox();if(Wi(n.flowchart.htmlLabels)){const R=y.children[0],N=Kr(y);b=R.getBoundingClientRect(),N.attr("width",b.width),N.attr("height",b.height)}const v=t.width<=b.width+t.padding?b.width+t.padding:t.width;t.width<=b.width+t.padding?t.diff=(v-t.width)/2-t.padding:t.diff=-t.padding;const x=t.height,w=t.x-v/2,S=t.y-x/2;zt.trace("Data ",t,JSON.stringify(t));let C;if(t.look==="handDrawn"){const R=kn.svg(d),N=Tn(t,{roughness:.7,fill:i,stroke:a,fillWeight:3,seed:s}),I=R.path(sf(w,S,v,x,0),N);C=d.insert(()=>(zt.debug("Rough node insert CXC",I),I),":first-child"),C.select("path:nth-child(2)").attr("style",c.join(";")),C.select("path").attr("style",u.join(";").replace("fill","stroke"))}else C=d.insert("rect",":first-child"),C.attr("style",l).attr("rx",t.rx).attr("ry",t.ry).attr("x",w).attr("y",S).attr("width",v).attr("height",x);const{subGraphTitleTopMargin:k}=DD(n);if(m.attr("transform",`translate(${t.x-b.width/2}, ${t.y-t.height/2+k})`),o){const R=m.select("span");R&&R.attr("style",o)}const A=C.node().getBBox();return t.offsetX=0,t.width=A.width,t.height=A.height,t.offsetY=b.height-t.padding/2,t.intersect=function(R){return ab(t,R)},{cluster:d,labelBBox:b}},"rect"),S8e=ie((e,t)=>{const n=e.insert("g").attr("class","note-cluster").attr("id",t.id),r=n.insert("rect",":first-child"),s=0*t.padding,i=s/2;r.attr("rx",t.rx).attr("ry",t.ry).attr("x",t.x-t.width/2-i).attr("y",t.y-t.height/2-i).attr("width",t.width+s).attr("height",t.height+s).attr("fill","none");const a=r.node().getBBox();return t.width=a.width,t.height=a.height,t.intersect=function(o){return ab(t,o)},{cluster:n,labelBBox:{width:0,height:0}}},"noteGroup"),C8e=ie(async(e,t)=>{const n=os(),{themeVariables:r,handDrawnSeed:s}=n,{altBackground:i,compositeBackground:a,compositeTitleBackground:o,nodeBorder:l}=r,c=e.insert("g").attr("class",t.cssClasses).attr("id",t.id).attr("data-id",t.id).attr("data-look",t.look),u=c.insert("g",":first-child"),d=c.insert("g").attr("class","cluster-label");let h=c.append("rect");const m=d.node().appendChild(await sm(t.label,t.labelStyle,void 0,!0));let y=m.getBBox();if(Wi(n.flowchart.htmlLabels)){const I=m.children[0],P=Kr(m);y=I.getBoundingClientRect(),P.attr("width",y.width),P.attr("height",y.height)}const b=0*t.padding,v=b/2,x=(t.width<=y.width+t.padding?y.width+t.padding:t.width)+b;t.width<=y.width+t.padding?t.diff=(x-t.width)/2-t.padding:t.diff=-t.padding;const w=t.height+b,S=t.height+b-y.height-6,C=t.x-x/2,k=t.y-w/2;t.width=x;const A=t.y-t.height/2-v+y.height+2;let R;if(t.look==="handDrawn"){const I=t.cssClasses.includes("statediagram-cluster-alt"),P=kn.svg(c),L=t.rx||t.ry?P.path(sf(C,k,x,w,10),{roughness:.7,fill:o,fillStyle:"solid",stroke:l,seed:s}):P.rectangle(C,k,x,w,{seed:s});R=c.insert(()=>L,":first-child");const O=P.rectangle(C,A,x,S,{fill:I?i:a,fillStyle:I?"hachure":"solid",stroke:l,seed:s});R=c.insert(()=>L,":first-child"),h=c.insert(()=>O)}else R=u.insert("rect",":first-child"),R.attr("class","outer").attr("x",C).attr("y",k).attr("width",x).attr("height",w).attr("data-look",t.look),h.attr("class","inner").attr("x",C).attr("y",A).attr("width",x).attr("height",S);d.attr("transform",`translate(${t.x-y.width/2}, ${k+1-(Wi(n.flowchart.htmlLabels)?0:3)})`);const N=R.node().getBBox();return t.height=N.height,t.offsetX=0,t.offsetY=y.height-t.padding/2,t.labelBBox=y,t.intersect=function(I){return ab(t,I)},{cluster:c,labelBBox:y}},"roundedWithTitle"),k8e=ie(async(e,t)=>{zt.info("Creating subgraph rect for ",t.id,t);const n=os(),{themeVariables:r,handDrawnSeed:s}=n,{clusterBkg:i,clusterBorder:a}=r,{labelStyles:o,nodeStyles:l,borderStyles:c,backgroundStyles:u}=In(t),d=e.insert("g").attr("class","cluster "+t.cssClasses).attr("id",t.id).attr("data-look",t.look),h=Wi(n.flowchart.htmlLabels),m=d.insert("g").attr("class","cluster-label "),y=await Jh(m,t.label,{style:t.labelStyle,useHtmlLabels:h,isNode:!0,width:t.width});let b=y.getBBox();if(Wi(n.flowchart.htmlLabels)){const R=y.children[0],N=Kr(y);b=R.getBoundingClientRect(),N.attr("width",b.width),N.attr("height",b.height)}const v=t.width<=b.width+t.padding?b.width+t.padding:t.width;t.width<=b.width+t.padding?t.diff=(v-t.width)/2-t.padding:t.diff=-t.padding;const x=t.height,w=t.x-v/2,S=t.y-x/2;zt.trace("Data ",t,JSON.stringify(t));let C;if(t.look==="handDrawn"){const R=kn.svg(d),N=Tn(t,{roughness:.7,fill:i,stroke:a,fillWeight:4,seed:s}),I=R.path(sf(w,S,v,x,t.rx),N);C=d.insert(()=>(zt.debug("Rough node insert CXC",I),I),":first-child"),C.select("path:nth-child(2)").attr("style",c.join(";")),C.select("path").attr("style",u.join(";").replace("fill","stroke"))}else C=d.insert("rect",":first-child"),C.attr("style",l).attr("rx",t.rx).attr("ry",t.ry).attr("x",w).attr("y",S).attr("width",v).attr("height",x);const{subGraphTitleTopMargin:k}=DD(n);if(m.attr("transform",`translate(${t.x-b.width/2}, ${t.y-t.height/2+k})`),o){const R=m.select("span");R&&R.attr("style",o)}const A=C.node().getBBox();return t.offsetX=0,t.width=A.width,t.height=A.height,t.offsetY=b.height-t.padding/2,t.intersect=function(R){return ab(t,R)},{cluster:d,labelBBox:b}},"kanbanSection"),E8e=ie((e,t)=>{const n=os(),{themeVariables:r,handDrawnSeed:s}=n,{nodeBorder:i}=r,a=e.insert("g").attr("class",t.cssClasses).attr("id",t.id).attr("data-look",t.look),o=a.insert("g",":first-child"),l=0*t.padding,c=t.width+l;t.diff=-t.padding;const u=t.height+l,d=t.x-c/2,h=t.y-u/2;t.width=c;let m;if(t.look==="handDrawn"){const v=kn.svg(a).rectangle(d,h,c,u,{fill:"lightgrey",roughness:.5,strokeLineDash:[5],stroke:i,seed:s});m=a.insert(()=>v,":first-child")}else m=o.insert("rect",":first-child"),m.attr("class","divider").attr("x",d).attr("y",h).attr("width",c).attr("height",u).attr("data-look",t.look);const y=m.node().getBBox();return t.height=y.height,t.offsetX=0,t.offsetY=0,t.intersect=function(b){return ab(t,b)},{cluster:a,labelBBox:{}}},"divider"),T8e=fte,A8e={rect:fte,squareRect:T8e,roundedWithTitle:C8e,noteGroup:S8e,divider:E8e,kanbanSection:k8e},hte=new Map,R8e=ie(async(e,t)=>{const n=t.shape||"rect",r=await A8e[n](e,t);return hte.set(t.id,r),r},"insertCluster"),cdt=ie(()=>{hte=new Map},"clear");function pte(e,t){return e.intersect(t)}ie(pte,"intersectNode");var N8e=pte;function mte(e,t,n,r){var s=e.x,i=e.y,a=s-r.x,o=i-r.y,l=Math.sqrt(t*t*o*o+n*n*a*a),c=Math.abs(t*n*a/l);r.x<s&&(c=-c);var u=Math.abs(t*n*o/l);return r.y<i&&(u=-u),{x:s+c,y:i+u}}ie(mte,"intersectEllipse");var gte=mte;function yte(e,t,n){return gte(e,t,t,n)}ie(yte,"intersectCircle");var M8e=yte;function bte(e,t,n,r){var s,i,a,o,l,c,u,d,h,m,y,b,v,x,w;if(s=t.y-e.y,a=e.x-t.x,l=t.x*e.y-e.x*t.y,h=s*n.x+a*n.y+l,m=s*r.x+a*r.y+l,!(h!==0&&m!==0&&x4(h,m))&&(i=r.y-n.y,o=n.x-r.x,c=r.x*n.y-n.x*r.y,u=i*e.x+o*e.y+c,d=i*t.x+o*t.y+c,!(u!==0&&d!==0&&x4(u,d))&&(y=s*o-i*a,y!==0)))return b=Math.abs(y/2),v=a*c-o*l,x=v<0?(v-b)/y:(v+b)/y,v=i*l-s*c,w=v<0?(v-b)/y:(v+b)/y,{x,y:w}}ie(bte,"intersectLine");function x4(e,t){return e*t>0}ie(x4,"sameSign");var I8e=bte;function vte(e,t,n){let r=e.x,s=e.y,i=[],a=Number.POSITIVE_INFINITY,o=Number.POSITIVE_INFINITY;typeof t.forEach=="function"?t.forEach(function(u){a=Math.min(a,u.x),o=Math.min(o,u.y)}):(a=Math.min(a,t.x),o=Math.min(o,t.y));let l=r-e.width/2-a,c=s-e.height/2-o;for(let u=0;u<t.length;u++){let d=t[u],h=t[u<t.length-1?u+1:0],m=I8e(e,n,{x:l+d.x,y:c+d.y},{x:l+h.x,y:c+h.y});m&&i.push(m)}return i.length?(i.length>1&&i.sort(function(u,d){let h=u.x-n.x,m=u.y-n.y,y=Math.sqrt(h*h+m*m),b=d.x-n.x,v=d.y-n.y,x=Math.sqrt(b*b+v*v);return y<x?-1:y===x?0:1}),i[0]):e}ie(vte,"intersectPolygon");var j8e=vte,Sn={node:N8e,circle:M8e,ellipse:gte,polygon:j8e,rect:ab};function xte(e,t){const{labelStyles:n}=In(t);t.labelStyle=n;const r=tr(t);let s=r;r||(s="anchor");const i=e.insert("g").attr("class",s).attr("id",t.domId||t.id),a=1,{cssStyles:o}=t,l=kn.svg(i),c=Tn(t,{fill:"black",stroke:"none",fillStyle:"solid"});t.look!=="handDrawn"&&(c.roughness=0);const u=l.circle(0,0,a*2,c),d=i.insert(()=>u,":first-child");return d.attr("class","anchor").attr("style",ro(o)),Mn(t,d),t.intersect=function(h){return zt.info("Circle intersect",t,a,h),Sn.circle(t,a,h)},i}ie(xte,"anchor");function w4(e,t,n,r,s,i,a){const l=(e+n)/2,c=(t+r)/2,u=Math.atan2(r-t,n-e),d=(n-e)/2,h=(r-t)/2,m=d/s,y=h/i,b=Math.sqrt(m**2+y**2);if(b>1)throw new Error("The given radii are too small to create an arc between the points.");const v=Math.sqrt(1-b**2),x=l+v*i*Math.sin(u)*(a?-1:1),w=c-v*s*Math.cos(u)*(a?-1:1),S=Math.atan2((t-w)/i,(e-x)/s);let k=Math.atan2((r-w)/i,(n-x)/s)-S;a&&k<0&&(k+=2*Math.PI),!a&&k>0&&(k-=2*Math.PI);const A=[];for(let R=0;R<20;R++){const N=R/19,I=S+N*k,P=x+s*Math.cos(I),L=w+i*Math.sin(I);A.push({x:P,y:L})}return A}ie(w4,"generateArcPoints");async function wte(e,t){const{labelStyles:n,nodeStyles:r}=In(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await ur(e,t,tr(t)),a=i.width+t.padding+20,o=i.height+t.padding,l=o/2,c=l/(2.5+o/50),{cssStyles:u}=t,d=[{x:a/2,y:-o/2},{x:-a/2,y:-o/2},...w4(-a/2,-o/2,-a/2,o/2,c,l,!1),{x:a/2,y:o/2},...w4(a/2,o/2,a/2,-o/2,c,l,!0)],h=kn.svg(s),m=Tn(t,{});t.look!=="handDrawn"&&(m.roughness=0,m.fillStyle="solid");const y=Xr(d),b=h.path(y,m),v=s.insert(()=>b,":first-child");return v.attr("class","basic label-container"),u&&t.look!=="handDrawn"&&v.selectAll("path").attr("style",u),r&&t.look!=="handDrawn"&&v.selectAll("path").attr("style",r),v.attr("transform",`translate(${c/2}, 0)`),Mn(t,v),t.intersect=function(x){return Sn.polygon(t,d,x)},s}ie(wte,"bowTieRect");function af(e,t,n,r){return e.insert("polygon",":first-child").attr("points",r.map(function(s){return s.x+","+s.y}).join(" ")).attr("class","label-container").attr("transform","translate("+-t/2+","+n/2+")")}ie(af,"insertPolygonShape");async function _te(e,t){const{labelStyles:n,nodeStyles:r}=In(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await ur(e,t,tr(t)),a=i.height+t.padding,o=12,l=i.width+t.padding+o,c=0,u=l,d=-a,h=0,m=[{x:c+o,y:d},{x:u,y:d},{x:u,y:h},{x:c,y:h},{x:c,y:d+o},{x:c+o,y:d}];let y;const{cssStyles:b}=t;if(t.look==="handDrawn"){const v=kn.svg(s),x=Tn(t,{}),w=Xr(m),S=v.path(w,x);y=s.insert(()=>S,":first-child").attr("transform",`translate(${-l/2}, ${a/2})`),b&&y.attr("style",b)}else y=af(s,l,a,m);return r&&y.attr("style",r),Mn(t,y),t.intersect=function(v){return Sn.polygon(t,m,v)},s}ie(_te,"card");function Ste(e,t){const{nodeStyles:n}=In(t);t.label="";const r=e.insert("g").attr("class",tr(t)).attr("id",t.domId??t.id),{cssStyles:s}=t,i=Math.max(28,t.width??0),a=[{x:0,y:i/2},{x:i/2,y:0},{x:0,y:-i/2},{x:-i/2,y:0}],o=kn.svg(r),l=Tn(t,{});t.look!=="handDrawn"&&(l.roughness=0,l.fillStyle="solid");const c=Xr(a),u=o.path(c,l),d=r.insert(()=>u,":first-child");return s&&t.look!=="handDrawn"&&d.selectAll("path").attr("style",s),n&&t.look!=="handDrawn"&&d.selectAll("path").attr("style",n),t.width=28,t.height=28,t.intersect=function(h){return Sn.polygon(t,a,h)},r}ie(Ste,"choice");async function Cte(e,t){const{labelStyles:n,nodeStyles:r}=In(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,halfPadding:a}=await ur(e,t,tr(t)),o=i.width/2+a;let l;const{cssStyles:c}=t;if(t.look==="handDrawn"){const u=kn.svg(s),d=Tn(t,{}),h=u.circle(0,0,o*2,d);l=s.insert(()=>h,":first-child"),l.attr("class","basic label-container").attr("style",ro(c))}else l=s.insert("circle",":first-child").attr("class","basic label-container").attr("style",r).attr("r",o).attr("cx",0).attr("cy",0);return Mn(t,l),t.intersect=function(u){return zt.info("Circle intersect",t,o,u),Sn.circle(t,o,u)},s}ie(Cte,"circle");function kte(e){const t=Math.cos(Math.PI/4),n=Math.sin(Math.PI/4),r=e*2,s={x:r/2*t,y:r/2*n},i={x:-(r/2)*t,y:r/2*n},a={x:-(r/2)*t,y:-(r/2)*n},o={x:r/2*t,y:-(r/2)*n};return`M ${i.x},${i.y} L ${o.x},${o.y}
                   M ${s.x},${s.y} L ${a.x},${a.y}`}ie(kte,"createLine");function Ete(e,t){const{labelStyles:n,nodeStyles:r}=In(t);t.labelStyle=n,t.label="";const s=e.insert("g").attr("class",tr(t)).attr("id",t.domId??t.id),i=Math.max(30,(t==null?void 0:t.width)??0),{cssStyles:a}=t,o=kn.svg(s),l=Tn(t,{});t.look!=="handDrawn"&&(l.roughness=0,l.fillStyle="solid");const c=o.circle(0,0,i*2,l),u=kte(i),d=o.path(u,l),h=s.insert(()=>c,":first-child");return h.insert(()=>d),a&&t.look!=="handDrawn"&&h.selectAll("path").attr("style",a),r&&t.look!=="handDrawn"&&h.selectAll("path").attr("style",r),Mn(t,h),t.intersect=function(m){return zt.info("crossedCircle intersect",t,{radius:i,point:m}),Sn.circle(t,i,m)},s}ie(Ete,"crossedCircle");function wd(e,t,n,r=100,s=0,i=180){const a=[],o=s*Math.PI/180,u=(i*Math.PI/180-o)/(r-1);for(let d=0;d<r;d++){const h=o+d*u,m=e+n*Math.cos(h),y=t+n*Math.sin(h);a.push({x:-m,y:-y})}return a}ie(wd,"generateCirclePoints");async function Tte(e,t){const{labelStyles:n,nodeStyles:r}=In(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await ur(e,t,tr(t)),o=i.width+(t.padding??0),l=i.height+(t.padding??0),c=Math.max(5,l*.1),{cssStyles:u}=t,d=[...wd(o/2,-l/2,c,30,-90,0),{x:-o/2-c,y:c},...wd(o/2+c*2,-c,c,20,-180,-270),...wd(o/2+c*2,c,c,20,-90,-180),{x:-o/2-c,y:-l/2},...wd(o/2,l/2,c,20,0,90)],h=[{x:o/2,y:-l/2-c},{x:-o/2,y:-l/2-c},...wd(o/2,-l/2,c,20,-90,0),{x:-o/2-c,y:-c},...wd(o/2+o*.1,-c,c,20,-180,-270),...wd(o/2+o*.1,c,c,20,-90,-180),{x:-o/2-c,y:l/2},...wd(o/2,l/2,c,20,0,90),{x:-o/2,y:l/2+c},{x:o/2,y:l/2+c}],m=kn.svg(s),y=Tn(t,{fill:"none"});t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");const v=Xr(d).replace("Z",""),x=m.path(v,y),w=Xr(h),S=m.path(w,{...y}),C=s.insert("g",":first-child");return C.insert(()=>S,":first-child").attr("stroke-opacity",0),C.insert(()=>x,":first-child"),C.attr("class","text"),u&&t.look!=="handDrawn"&&C.selectAll("path").attr("style",u),r&&t.look!=="handDrawn"&&C.selectAll("path").attr("style",r),C.attr("transform",`translate(${c}, 0)`),a.attr("transform",`translate(${-o/2+c-(i.x-(i.left??0))},${-l/2+(t.padding??0)/2-(i.y-(i.top??0))})`),Mn(t,C),t.intersect=function(k){return Sn.polygon(t,h,k)},s}ie(Tte,"curlyBraceLeft");function _d(e,t,n,r=100,s=0,i=180){const a=[],o=s*Math.PI/180,u=(i*Math.PI/180-o)/(r-1);for(let d=0;d<r;d++){const h=o+d*u,m=e+n*Math.cos(h),y=t+n*Math.sin(h);a.push({x:m,y})}return a}ie(_d,"generateCirclePoints");async function Ate(e,t){const{labelStyles:n,nodeStyles:r}=In(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await ur(e,t,tr(t)),o=i.width+(t.padding??0),l=i.height+(t.padding??0),c=Math.max(5,l*.1),{cssStyles:u}=t,d=[..._d(o/2,-l/2,c,20,-90,0),{x:o/2+c,y:-c},..._d(o/2+c*2,-c,c,20,-180,-270),..._d(o/2+c*2,c,c,20,-90,-180),{x:o/2+c,y:l/2},..._d(o/2,l/2,c,20,0,90)],h=[{x:-o/2,y:-l/2-c},{x:o/2,y:-l/2-c},..._d(o/2,-l/2,c,20,-90,0),{x:o/2+c,y:-c},..._d(o/2+c*2,-c,c,20,-180,-270),..._d(o/2+c*2,c,c,20,-90,-180),{x:o/2+c,y:l/2},..._d(o/2,l/2,c,20,0,90),{x:o/2,y:l/2+c},{x:-o/2,y:l/2+c}],m=kn.svg(s),y=Tn(t,{fill:"none"});t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");const v=Xr(d).replace("Z",""),x=m.path(v,y),w=Xr(h),S=m.path(w,{...y}),C=s.insert("g",":first-child");return C.insert(()=>S,":first-child").attr("stroke-opacity",0),C.insert(()=>x,":first-child"),C.attr("class","text"),u&&t.look!=="handDrawn"&&C.selectAll("path").attr("style",u),r&&t.look!=="handDrawn"&&C.selectAll("path").attr("style",r),C.attr("transform",`translate(${-c}, 0)`),a.attr("transform",`translate(${-o/2+(t.padding??0)/2-(i.x-(i.left??0))},${-l/2+(t.padding??0)/2-(i.y-(i.top??0))})`),Mn(t,C),t.intersect=function(k){return Sn.polygon(t,h,k)},s}ie(Ate,"curlyBraceRight");function ma(e,t,n,r=100,s=0,i=180){const a=[],o=s*Math.PI/180,u=(i*Math.PI/180-o)/(r-1);for(let d=0;d<r;d++){const h=o+d*u,m=e+n*Math.cos(h),y=t+n*Math.sin(h);a.push({x:-m,y:-y})}return a}ie(ma,"generateCirclePoints");async function Rte(e,t){const{labelStyles:n,nodeStyles:r}=In(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await ur(e,t,tr(t)),o=i.width+(t.padding??0),l=i.height+(t.padding??0),c=Math.max(5,l*.1),{cssStyles:u}=t,d=[...ma(o/2,-l/2,c,30,-90,0),{x:-o/2-c,y:c},...ma(o/2+c*2,-c,c,20,-180,-270),...ma(o/2+c*2,c,c,20,-90,-180),{x:-o/2-c,y:-l/2},...ma(o/2,l/2,c,20,0,90)],h=[...ma(-o/2+c+c/2,-l/2,c,20,-90,-180),{x:o/2-c/2,y:c},...ma(-o/2-c/2,-c,c,20,0,90),...ma(-o/2-c/2,c,c,20,-90,0),{x:o/2-c/2,y:-c},...ma(-o/2+c+c/2,l/2,c,30,-180,-270)],m=[{x:o/2,y:-l/2-c},{x:-o/2,y:-l/2-c},...ma(o/2,-l/2,c,20,-90,0),{x:-o/2-c,y:-c},...ma(o/2+c*2,-c,c,20,-180,-270),...ma(o/2+c*2,c,c,20,-90,-180),{x:-o/2-c,y:l/2},...ma(o/2,l/2,c,20,0,90),{x:-o/2,y:l/2+c},{x:o/2-c-c/2,y:l/2+c},...ma(-o/2+c+c/2,-l/2,c,20,-90,-180),{x:o/2-c/2,y:c},...ma(-o/2-c/2,-c,c,20,0,90),...ma(-o/2-c/2,c,c,20,-90,0),{x:o/2-c/2,y:-c},...ma(-o/2+c+c/2,l/2,c,30,-180,-270)],y=kn.svg(s),b=Tn(t,{fill:"none"});t.look!=="handDrawn"&&(b.roughness=0,b.fillStyle="solid");const x=Xr(d).replace("Z",""),w=y.path(x,b),C=Xr(h).replace("Z",""),k=y.path(C,b),A=Xr(m),R=y.path(A,{...b}),N=s.insert("g",":first-child");return N.insert(()=>R,":first-child").attr("stroke-opacity",0),N.insert(()=>w,":first-child"),N.insert(()=>k,":first-child"),N.attr("class","text"),u&&t.look!=="handDrawn"&&N.selectAll("path").attr("style",u),r&&t.look!=="handDrawn"&&N.selectAll("path").attr("style",r),N.attr("transform",`translate(${c-c/4}, 0)`),a.attr("transform",`translate(${-o/2+(t.padding??0)/2-(i.x-(i.left??0))},${-l/2+(t.padding??0)/2-(i.y-(i.top??0))})`),Mn(t,N),t.intersect=function(I){return Sn.polygon(t,m,I)},s}ie(Rte,"curlyBraces");async function Nte(e,t){const{labelStyles:n,nodeStyles:r}=In(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await ur(e,t,tr(t)),a=80,o=20,l=Math.max(a,(i.width+(t.padding??0)*2)*1.25,(t==null?void 0:t.width)??0),c=Math.max(o,i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),u=c/2,{cssStyles:d}=t,h=kn.svg(s),m=Tn(t,{});t.look!=="handDrawn"&&(m.roughness=0,m.fillStyle="solid");const y=l,b=c,v=y-u,x=b/4,w=[{x:v,y:0},{x,y:0},{x:0,y:b/2},{x,y:b},{x:v,y:b},...y6(-v,-b/2,u,50,270,90)],S=Xr(w),C=h.path(S,m),k=s.insert(()=>C,":first-child");return k.attr("class","basic label-container"),d&&t.look!=="handDrawn"&&k.selectChildren("path").attr("style",d),r&&t.look!=="handDrawn"&&k.selectChildren("path").attr("style",r),k.attr("transform",`translate(${-l/2}, ${-c/2})`),Mn(t,k),t.intersect=function(A){return Sn.polygon(t,w,A)},s}ie(Nte,"curvedTrapezoid");var P8e=ie((e,t,n,r,s,i)=>[`M${e},${t+i}`,`a${s},${i} 0,0,0 ${n},0`,`a${s},${i} 0,0,0 ${-n},0`,`l0,${r}`,`a${s},${i} 0,0,0 ${n},0`,`l0,${-r}`].join(" "),"createCylinderPathD"),O8e=ie((e,t,n,r,s,i)=>[`M${e},${t+i}`,`M${e+n},${t+i}`,`a${s},${i} 0,0,0 ${-n},0`,`l0,${r}`,`a${s},${i} 0,0,0 ${n},0`,`l0,${-r}`].join(" "),"createOuterCylinderPathD"),D8e=ie((e,t,n,r,s,i)=>[`M${e-n/2},${-r/2}`,`a${s},${i} 0,0,0 ${n},0`].join(" "),"createInnerCylinderPathD");async function Mte(e,t){const{labelStyles:n,nodeStyles:r}=In(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await ur(e,t,tr(t)),o=Math.max(i.width+t.padding,t.width??0),l=o/2,c=l/(2.5+o/50),u=Math.max(i.height+c+t.padding,t.height??0);let d;const{cssStyles:h}=t;if(t.look==="handDrawn"){const m=kn.svg(s),y=O8e(0,0,o,u,l,c),b=D8e(0,c,o,u,l,c),v=m.path(y,Tn(t,{})),x=m.path(b,Tn(t,{fill:"none"}));d=s.insert(()=>x,":first-child"),d=s.insert(()=>v,":first-child"),d.attr("class","basic label-container"),h&&d.attr("style",h)}else{const m=P8e(0,0,o,u,l,c);d=s.insert("path",":first-child").attr("d",m).attr("class","basic label-container").attr("style",ro(h)).attr("style",r)}return d.attr("label-offset-y",c),d.attr("transform",`translate(${-o/2}, ${-(u/2+c)})`),Mn(t,d),a.attr("transform",`translate(${-(i.width/2)-(i.x-(i.left??0))}, ${-(i.height/2)+(t.padding??0)/1.5-(i.y-(i.top??0))})`),t.intersect=function(m){const y=Sn.rect(t,m),b=y.x-(t.x??0);if(l!=0&&(Math.abs(b)<(t.width??0)/2||Math.abs(b)==(t.width??0)/2&&Math.abs(y.y-(t.y??0))>(t.height??0)/2-c)){let v=c*c*(1-b*b/(l*l));v>0&&(v=Math.sqrt(v)),v=c-v,m.y-(t.y??0)>0&&(v=-v),y.y+=v}return y},s}ie(Mte,"cylinder");async function Ite(e,t){const{labelStyles:n,nodeStyles:r}=In(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await ur(e,t,tr(t)),o=i.width+t.padding,l=i.height+t.padding,c=l*.2,u=-o/2,d=-l/2-c/2,{cssStyles:h}=t,m=kn.svg(s),y=Tn(t,{});t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");const b=[{x:u,y:d+c},{x:-u,y:d+c},{x:-u,y:-d},{x:u,y:-d},{x:u,y:d},{x:-u,y:d},{x:-u,y:d+c}],v=m.polygon(b.map(w=>[w.x,w.y]),y),x=s.insert(()=>v,":first-child");return x.attr("class","basic label-container"),h&&t.look!=="handDrawn"&&x.selectAll("path").attr("style",h),r&&t.look!=="handDrawn"&&x.selectAll("path").attr("style",r),a.attr("transform",`translate(${u+(t.padding??0)/2-(i.x-(i.left??0))}, ${d+c+(t.padding??0)/2-(i.y-(i.top??0))})`),Mn(t,x),t.intersect=function(w){return Sn.rect(t,w)},s}ie(Ite,"dividedRectangle");async function jte(e,t){var h,m;const{labelStyles:n,nodeStyles:r}=In(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,halfPadding:a}=await ur(e,t,tr(t)),l=i.width/2+a+5,c=i.width/2+a;let u;const{cssStyles:d}=t;if(t.look==="handDrawn"){const y=kn.svg(s),b=Tn(t,{roughness:.2,strokeWidth:2.5}),v=Tn(t,{roughness:.2,strokeWidth:1.5}),x=y.circle(0,0,l*2,b),w=y.circle(0,0,c*2,v);u=s.insert("g",":first-child"),u.attr("class",ro(t.cssClasses)).attr("style",ro(d)),(h=u.node())==null||h.appendChild(x),(m=u.node())==null||m.appendChild(w)}else{u=s.insert("g",":first-child");const y=u.insert("circle",":first-child"),b=u.insert("circle");u.attr("class","basic label-container").attr("style",r),y.attr("class","outer-circle").attr("style",r).attr("r",l).attr("cx",0).attr("cy",0),b.attr("class","inner-circle").attr("style",r).attr("r",c).attr("cx",0).attr("cy",0)}return Mn(t,u),t.intersect=function(y){return zt.info("DoubleCircle intersect",t,l,y),Sn.circle(t,l,y)},s}ie(jte,"doublecircle");function Pte(e,t,{config:{themeVariables:n}}){const{labelStyles:r,nodeStyles:s}=In(t);t.label="",t.labelStyle=r;const i=e.insert("g").attr("class",tr(t)).attr("id",t.domId??t.id),a=7,{cssStyles:o}=t,l=kn.svg(i),{nodeBorder:c}=n,u=Tn(t,{fillStyle:"solid"});t.look!=="handDrawn"&&(u.roughness=0);const d=l.circle(0,0,a*2,u),h=i.insert(()=>d,":first-child");return h.selectAll("path").attr("style",`fill: ${c} !important;`),o&&o.length>0&&t.look!=="handDrawn"&&h.selectAll("path").attr("style",o),s&&t.look!=="handDrawn"&&h.selectAll("path").attr("style",s),Mn(t,h),t.intersect=function(m){return zt.info("filledCircle intersect",t,{radius:a,point:m}),Sn.circle(t,a,m)},i}ie(Pte,"filledCircle");async function Ote(e,t){const{labelStyles:n,nodeStyles:r}=In(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await ur(e,t,tr(t)),o=i.width+(t.padding??0),l=o+i.height,c=o+i.height,u=[{x:0,y:-l},{x:c,y:-l},{x:c/2,y:0}],{cssStyles:d}=t,h=kn.svg(s),m=Tn(t,{});t.look!=="handDrawn"&&(m.roughness=0,m.fillStyle="solid");const y=Xr(u),b=h.path(y,m),v=s.insert(()=>b,":first-child").attr("transform",`translate(${-l/2}, ${l/2})`);return d&&t.look!=="handDrawn"&&v.selectChildren("path").attr("style",d),r&&t.look!=="handDrawn"&&v.selectChildren("path").attr("style",r),t.width=o,t.height=l,Mn(t,v),a.attr("transform",`translate(${-i.width/2-(i.x-(i.left??0))}, ${-l/2+(t.padding??0)/2+(i.y-(i.top??0))})`),t.intersect=function(x){return zt.info("Triangle intersect",t,u,x),Sn.polygon(t,u,x)},s}ie(Ote,"flippedTriangle");function Dte(e,t,{dir:n,config:{state:r,themeVariables:s}}){const{nodeStyles:i}=In(t);t.label="";const a=e.insert("g").attr("class",tr(t)).attr("id",t.domId??t.id),{cssStyles:o}=t;let l=Math.max(70,(t==null?void 0:t.width)??0),c=Math.max(10,(t==null?void 0:t.height)??0);n==="LR"&&(l=Math.max(10,(t==null?void 0:t.width)??0),c=Math.max(70,(t==null?void 0:t.height)??0));const u=-1*l/2,d=-1*c/2,h=kn.svg(a),m=Tn(t,{stroke:s.lineColor,fill:s.lineColor});t.look!=="handDrawn"&&(m.roughness=0,m.fillStyle="solid");const y=h.rectangle(u,d,l,c,m),b=a.insert(()=>y,":first-child");o&&t.look!=="handDrawn"&&b.selectAll("path").attr("style",o),i&&t.look!=="handDrawn"&&b.selectAll("path").attr("style",i),Mn(t,b);const v=(r==null?void 0:r.padding)??0;return t.width&&t.height&&(t.width+=v/2||0,t.height+=v/2||0),t.intersect=function(x){return Sn.rect(t,x)},a}ie(Dte,"forkJoin");async function Fte(e,t){const{labelStyles:n,nodeStyles:r}=In(t);t.labelStyle=n;const s=80,i=50,{shapeSvg:a,bbox:o}=await ur(e,t,tr(t)),l=Math.max(s,o.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),c=Math.max(i,o.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),u=c/2,{cssStyles:d}=t,h=kn.svg(a),m=Tn(t,{});t.look!=="handDrawn"&&(m.roughness=0,m.fillStyle="solid");const y=[{x:-l/2,y:-c/2},{x:l/2-u,y:-c/2},...y6(-l/2+u,0,u,50,90,270),{x:l/2-u,y:c/2},{x:-l/2,y:c/2}],b=Xr(y),v=h.path(b,m),x=a.insert(()=>v,":first-child");return x.attr("class","basic label-container"),d&&t.look!=="handDrawn"&&x.selectChildren("path").attr("style",d),r&&t.look!=="handDrawn"&&x.selectChildren("path").attr("style",r),Mn(t,x),t.intersect=function(w){return zt.info("Pill intersect",t,{radius:u,point:w}),Sn.polygon(t,y,w)},a}ie(Fte,"halfRoundedRectangle");var F8e=ie((e,t,n,r,s)=>[`M${e+s},${t}`,`L${e+n-s},${t}`,`L${e+n},${t-r/2}`,`L${e+n-s},${t-r}`,`L${e+s},${t-r}`,`L${e},${t-r/2}`,"Z"].join(" "),"createHexagonPathD");async function Lte(e,t){const{labelStyles:n,nodeStyles:r}=In(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await ur(e,t,tr(t)),a=4,o=i.height+t.padding,l=o/a,c=i.width+2*l+t.padding,u=[{x:l,y:0},{x:c-l,y:0},{x:c,y:-o/2},{x:c-l,y:-o},{x:l,y:-o},{x:0,y:-o/2}];let d;const{cssStyles:h}=t;if(t.look==="handDrawn"){const m=kn.svg(s),y=Tn(t,{}),b=F8e(0,0,c,o,l),v=m.path(b,y);d=s.insert(()=>v,":first-child").attr("transform",`translate(${-c/2}, ${o/2})`),h&&d.attr("style",h)}else d=af(s,c,o,u);return r&&d.attr("style",r),t.width=c,t.height=o,Mn(t,d),t.intersect=function(m){return Sn.polygon(t,u,m)},s}ie(Lte,"hexagon");async function Bte(e,t){const{labelStyles:n,nodeStyles:r}=In(t);t.label="",t.labelStyle=n;const{shapeSvg:s}=await ur(e,t,tr(t)),i=Math.max(30,(t==null?void 0:t.width)??0),a=Math.max(30,(t==null?void 0:t.height)??0),{cssStyles:o}=t,l=kn.svg(s),c=Tn(t,{});t.look!=="handDrawn"&&(c.roughness=0,c.fillStyle="solid");const u=[{x:0,y:0},{x:i,y:0},{x:0,y:a},{x:i,y:a}],d=Xr(u),h=l.path(d,c),m=s.insert(()=>h,":first-child");return m.attr("class","basic label-container"),o&&t.look!=="handDrawn"&&m.selectChildren("path").attr("style",o),r&&t.look!=="handDrawn"&&m.selectChildren("path").attr("style",r),m.attr("transform",`translate(${-i/2}, ${-a/2})`),Mn(t,m),t.intersect=function(y){return zt.info("Pill intersect",t,{points:u}),Sn.polygon(t,u,y)},s}ie(Bte,"hourglass");async function $te(e,t,{config:{themeVariables:n,flowchart:r}}){const{labelStyles:s}=In(t);t.labelStyle=s;const i=t.assetHeight??48,a=t.assetWidth??48,o=Math.max(i,a),l=r==null?void 0:r.wrappingWidth;t.width=Math.max(o,l??0);const{shapeSvg:c,bbox:u,label:d}=await ur(e,t,"icon-shape default"),h=t.pos==="t",m=o,y=o,{nodeBorder:b}=n,{stylesMap:v}=ob(t),x=-y/2,w=-m/2,S=t.label?8:0,C=kn.svg(c),k=Tn(t,{stroke:"none",fill:"none"});t.look!=="handDrawn"&&(k.roughness=0,k.fillStyle="solid");const A=C.rectangle(x,w,y,m,k),R=Math.max(y,u.width),N=m+u.height+S,I=C.rectangle(-R/2,-N/2,R,N,{...k,fill:"transparent",stroke:"none"}),P=c.insert(()=>A,":first-child"),L=c.insert(()=>I);if(t.icon){const O=c.append("g");O.html(`<g>${await gT(t.icon,{height:o,width:o,fallbackPrefix:""})}</g>`);const V=O.node().getBBox(),D=V.width,Z=V.height,U=V.x,H=V.y;O.attr("transform",`translate(${-D/2-U},${h?u.height/2+S/2-Z/2-H:-u.height/2-S/2-Z/2-H})`),O.attr("style",`color: ${v.get("stroke")??b};`)}return d.attr("transform",`translate(${-u.width/2-(u.x-(u.left??0))},${h?-N/2:N/2-u.height})`),P.attr("transform",`translate(0,${h?u.height/2+S/2:-u.height/2-S/2})`),Mn(t,L),t.intersect=function(O){if(zt.info("iconSquare intersect",t,O),!t.label)return Sn.rect(t,O);const V=t.x??0,D=t.y??0,Z=t.height??0;let U=[];return h?U=[{x:V-u.width/2,y:D-Z/2},{x:V+u.width/2,y:D-Z/2},{x:V+u.width/2,y:D-Z/2+u.height+S},{x:V+y/2,y:D-Z/2+u.height+S},{x:V+y/2,y:D+Z/2},{x:V-y/2,y:D+Z/2},{x:V-y/2,y:D-Z/2+u.height+S},{x:V-u.width/2,y:D-Z/2+u.height+S}]:U=[{x:V-y/2,y:D-Z/2},{x:V+y/2,y:D-Z/2},{x:V+y/2,y:D-Z/2+m},{x:V+u.width/2,y:D-Z/2+m},{x:V+u.width/2/2,y:D+Z/2},{x:V-u.width/2,y:D+Z/2},{x:V-u.width/2,y:D-Z/2+m},{x:V-y/2,y:D-Z/2+m}],Sn.polygon(t,U,O)},c}ie($te,"icon");async function zte(e,t,{config:{themeVariables:n,flowchart:r}}){const{labelStyles:s}=In(t);t.labelStyle=s;const i=t.assetHeight??48,a=t.assetWidth??48,o=Math.max(i,a),l=r==null?void 0:r.wrappingWidth;t.width=Math.max(o,l??0);const{shapeSvg:c,bbox:u,label:d}=await ur(e,t,"icon-shape default"),h=20,m=t.label?8:0,y=t.pos==="t",{nodeBorder:b,mainBkg:v}=n,{stylesMap:x}=ob(t),w=kn.svg(c),S=Tn(t,{});t.look!=="handDrawn"&&(S.roughness=0,S.fillStyle="solid");const C=x.get("fill");S.stroke=C??v;const k=c.append("g");t.icon&&k.html(`<g>${await gT(t.icon,{height:o,width:o,fallbackPrefix:""})}</g>`);const A=k.node().getBBox(),R=A.width,N=A.height,I=A.x,P=A.y,L=Math.max(R,N)*Math.SQRT2+h*2,O=w.circle(0,0,L,S),V=Math.max(L,u.width),D=L+u.height+m,Z=w.rectangle(-V/2,-D/2,V,D,{...S,fill:"transparent",stroke:"none"}),U=c.insert(()=>O,":first-child"),H=c.insert(()=>Z);return k.attr("transform",`translate(${-R/2-I},${y?u.height/2+m/2-N/2-P:-u.height/2-m/2-N/2-P})`),k.attr("style",`color: ${x.get("stroke")??b};`),d.attr("transform",`translate(${-u.width/2-(u.x-(u.left??0))},${y?-D/2:D/2-u.height})`),U.attr("transform",`translate(0,${y?u.height/2+m/2:-u.height/2-m/2})`),Mn(t,H),t.intersect=function($){return zt.info("iconSquare intersect",t,$),Sn.rect(t,$)},c}ie(zte,"iconCircle");async function Ute(e,t,{config:{themeVariables:n,flowchart:r}}){const{labelStyles:s}=In(t);t.labelStyle=s;const i=t.assetHeight??48,a=t.assetWidth??48,o=Math.max(i,a),l=r==null?void 0:r.wrappingWidth;t.width=Math.max(o,l??0);const{shapeSvg:c,bbox:u,halfPadding:d,label:h}=await ur(e,t,"icon-shape default"),m=t.pos==="t",y=o+d*2,b=o+d*2,{nodeBorder:v,mainBkg:x}=n,{stylesMap:w}=ob(t),S=-b/2,C=-y/2,k=t.label?8:0,A=kn.svg(c),R=Tn(t,{});t.look!=="handDrawn"&&(R.roughness=0,R.fillStyle="solid");const N=w.get("fill");R.stroke=N??x;const I=A.path(sf(S,C,b,y,5),R),P=Math.max(b,u.width),L=y+u.height+k,O=A.rectangle(-P/2,-L/2,P,L,{...R,fill:"transparent",stroke:"none"}),V=c.insert(()=>I,":first-child").attr("class","icon-shape2"),D=c.insert(()=>O);if(t.icon){const Z=c.append("g");Z.html(`<g>${await gT(t.icon,{height:o,width:o,fallbackPrefix:""})}</g>`);const U=Z.node().getBBox(),H=U.width,$=U.height,ne=U.x,W=U.y;Z.attr("transform",`translate(${-H/2-ne},${m?u.height/2+k/2-$/2-W:-u.height/2-k/2-$/2-W})`),Z.attr("style",`color: ${w.get("stroke")??v};`)}return h.attr("transform",`translate(${-u.width/2-(u.x-(u.left??0))},${m?-L/2:L/2-u.height})`),V.attr("transform",`translate(0,${m?u.height/2+k/2:-u.height/2-k/2})`),Mn(t,D),t.intersect=function(Z){if(zt.info("iconSquare intersect",t,Z),!t.label)return Sn.rect(t,Z);const U=t.x??0,H=t.y??0,$=t.height??0;let ne=[];return m?ne=[{x:U-u.width/2,y:H-$/2},{x:U+u.width/2,y:H-$/2},{x:U+u.width/2,y:H-$/2+u.height+k},{x:U+b/2,y:H-$/2+u.height+k},{x:U+b/2,y:H+$/2},{x:U-b/2,y:H+$/2},{x:U-b/2,y:H-$/2+u.height+k},{x:U-u.width/2,y:H-$/2+u.height+k}]:ne=[{x:U-b/2,y:H-$/2},{x:U+b/2,y:H-$/2},{x:U+b/2,y:H-$/2+y},{x:U+u.width/2,y:H-$/2+y},{x:U+u.width/2/2,y:H+$/2},{x:U-u.width/2,y:H+$/2},{x:U-u.width/2,y:H-$/2+y},{x:U-b/2,y:H-$/2+y}],Sn.polygon(t,ne,Z)},c}ie(Ute,"iconRounded");async function qte(e,t,{config:{themeVariables:n,flowchart:r}}){const{labelStyles:s}=In(t);t.labelStyle=s;const i=t.assetHeight??48,a=t.assetWidth??48,o=Math.max(i,a),l=r==null?void 0:r.wrappingWidth;t.width=Math.max(o,l??0);const{shapeSvg:c,bbox:u,halfPadding:d,label:h}=await ur(e,t,"icon-shape default"),m=t.pos==="t",y=o+d*2,b=o+d*2,{nodeBorder:v,mainBkg:x}=n,{stylesMap:w}=ob(t),S=-b/2,C=-y/2,k=t.label?8:0,A=kn.svg(c),R=Tn(t,{});t.look!=="handDrawn"&&(R.roughness=0,R.fillStyle="solid");const N=w.get("fill");R.stroke=N??x;const I=A.path(sf(S,C,b,y,.1),R),P=Math.max(b,u.width),L=y+u.height+k,O=A.rectangle(-P/2,-L/2,P,L,{...R,fill:"transparent",stroke:"none"}),V=c.insert(()=>I,":first-child"),D=c.insert(()=>O);if(t.icon){const Z=c.append("g");Z.html(`<g>${await gT(t.icon,{height:o,width:o,fallbackPrefix:""})}</g>`);const U=Z.node().getBBox(),H=U.width,$=U.height,ne=U.x,W=U.y;Z.attr("transform",`translate(${-H/2-ne},${m?u.height/2+k/2-$/2-W:-u.height/2-k/2-$/2-W})`),Z.attr("style",`color: ${w.get("stroke")??v};`)}return h.attr("transform",`translate(${-u.width/2-(u.x-(u.left??0))},${m?-L/2:L/2-u.height})`),V.attr("transform",`translate(0,${m?u.height/2+k/2:-u.height/2-k/2})`),Mn(t,D),t.intersect=function(Z){if(zt.info("iconSquare intersect",t,Z),!t.label)return Sn.rect(t,Z);const U=t.x??0,H=t.y??0,$=t.height??0;let ne=[];return m?ne=[{x:U-u.width/2,y:H-$/2},{x:U+u.width/2,y:H-$/2},{x:U+u.width/2,y:H-$/2+u.height+k},{x:U+b/2,y:H-$/2+u.height+k},{x:U+b/2,y:H+$/2},{x:U-b/2,y:H+$/2},{x:U-b/2,y:H-$/2+u.height+k},{x:U-u.width/2,y:H-$/2+u.height+k}]:ne=[{x:U-b/2,y:H-$/2},{x:U+b/2,y:H-$/2},{x:U+b/2,y:H-$/2+y},{x:U+u.width/2,y:H-$/2+y},{x:U+u.width/2/2,y:H+$/2},{x:U-u.width/2,y:H+$/2},{x:U-u.width/2,y:H-$/2+y},{x:U-b/2,y:H-$/2+y}],Sn.polygon(t,ne,Z)},c}ie(qte,"iconSquare");async function Vte(e,t,{config:{flowchart:n}}){const r=new Image;r.src=(t==null?void 0:t.img)??"",await r.decode();const s=Number(r.naturalWidth.toString().replace("px","")),i=Number(r.naturalHeight.toString().replace("px",""));t.imageAspectRatio=s/i;const{labelStyles:a}=In(t);t.labelStyle=a;const o=n==null?void 0:n.wrappingWidth;t.defaultWidth=n==null?void 0:n.wrappingWidth;const l=Math.max(t.label?o??0:0,(t==null?void 0:t.assetWidth)??s),c=t.constraint==="on"&&t!=null&&t.assetHeight?t.assetHeight*t.imageAspectRatio:l,u=t.constraint==="on"?c/t.imageAspectRatio:(t==null?void 0:t.assetHeight)??i;t.width=Math.max(c,o??0);const{shapeSvg:d,bbox:h,label:m}=await ur(e,t,"image-shape default"),y=t.pos==="t",b=-c/2,v=-u/2,x=t.label?8:0,w=kn.svg(d),S=Tn(t,{});t.look!=="handDrawn"&&(S.roughness=0,S.fillStyle="solid");const C=w.rectangle(b,v,c,u,S),k=Math.max(c,h.width),A=u+h.height+x,R=w.rectangle(-k/2,-A/2,k,A,{...S,fill:"none",stroke:"none"}),N=d.insert(()=>C,":first-child"),I=d.insert(()=>R);if(t.img){const P=d.append("image");P.attr("href",t.img),P.attr("width",c),P.attr("height",u),P.attr("preserveAspectRatio","none"),P.attr("transform",`translate(${-c/2},${y?A/2-u:-A/2})`)}return m.attr("transform",`translate(${-h.width/2-(h.x-(h.left??0))},${y?-u/2-h.height/2-x/2:u/2-h.height/2+x/2})`),N.attr("transform",`translate(0,${y?h.height/2+x/2:-h.height/2-x/2})`),Mn(t,I),t.intersect=function(P){if(zt.info("iconSquare intersect",t,P),!t.label)return Sn.rect(t,P);const L=t.x??0,O=t.y??0,V=t.height??0;let D=[];return y?D=[{x:L-h.width/2,y:O-V/2},{x:L+h.width/2,y:O-V/2},{x:L+h.width/2,y:O-V/2+h.height+x},{x:L+c/2,y:O-V/2+h.height+x},{x:L+c/2,y:O+V/2},{x:L-c/2,y:O+V/2},{x:L-c/2,y:O-V/2+h.height+x},{x:L-h.width/2,y:O-V/2+h.height+x}]:D=[{x:L-c/2,y:O-V/2},{x:L+c/2,y:O-V/2},{x:L+c/2,y:O-V/2+u},{x:L+h.width/2,y:O-V/2+u},{x:L+h.width/2/2,y:O+V/2},{x:L-h.width/2,y:O+V/2},{x:L-h.width/2,y:O-V/2+u},{x:L-c/2,y:O-V/2+u}],Sn.polygon(t,D,P)},d}ie(Vte,"imageSquare");async function Wte(e,t){const{labelStyles:n,nodeStyles:r}=In(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await ur(e,t,tr(t)),a=Math.max(i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),o=Math.max(i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),l=[{x:0,y:0},{x:a,y:0},{x:a+3*o/6,y:-o},{x:-3*o/6,y:-o}];let c;const{cssStyles:u}=t;if(t.look==="handDrawn"){const d=kn.svg(s),h=Tn(t,{}),m=Xr(l),y=d.path(m,h);c=s.insert(()=>y,":first-child").attr("transform",`translate(${-a/2}, ${o/2})`),u&&c.attr("style",u)}else c=af(s,a,o,l);return r&&c.attr("style",r),t.width=a,t.height=o,Mn(t,c),t.intersect=function(d){return Sn.polygon(t,l,d)},s}ie(Wte,"inv_trapezoid");async function X1(e,t,n){const{labelStyles:r,nodeStyles:s}=In(t);t.labelStyle=r;const{shapeSvg:i,bbox:a}=await ur(e,t,tr(t)),o=Math.max(a.width+n.labelPaddingX*2,(t==null?void 0:t.width)||0),l=Math.max(a.height+n.labelPaddingY*2,(t==null?void 0:t.height)||0),c=-o/2,u=-l/2;let d,{rx:h,ry:m}=t;const{cssStyles:y}=t;if(n!=null&&n.rx&&n.ry&&(h=n.rx,m=n.ry),t.look==="handDrawn"){const b=kn.svg(i),v=Tn(t,{}),x=h||m?b.path(sf(c,u,o,l,h||0),v):b.rectangle(c,u,o,l,v);d=i.insert(()=>x,":first-child"),d.attr("class","basic label-container").attr("style",ro(y))}else d=i.insert("rect",":first-child"),d.attr("class","basic label-container").attr("style",s).attr("rx",ro(h)).attr("ry",ro(m)).attr("x",c).attr("y",u).attr("width",o).attr("height",l);return Mn(t,d),t.intersect=function(b){return Sn.rect(t,b)},i}ie(X1,"drawRect");async function Hte(e,t){const{shapeSvg:n,bbox:r,label:s}=await ur(e,t,"label"),i=n.insert("rect",":first-child");return i.attr("width",.1).attr("height",.1),n.attr("class","label edgeLabel"),s.attr("transform",`translate(${-(r.width/2)-(r.x-(r.left??0))}, ${-(r.height/2)-(r.y-(r.top??0))})`),Mn(t,i),t.intersect=function(l){return Sn.rect(t,l)},n}ie(Hte,"labelRect");async function Gte(e,t){const{labelStyles:n,nodeStyles:r}=In(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await ur(e,t,tr(t)),a=Math.max(i.width+(t.padding??0),(t==null?void 0:t.width)??0),o=Math.max(i.height+(t.padding??0),(t==null?void 0:t.height)??0),l=[{x:0,y:0},{x:a+3*o/6,y:0},{x:a,y:-o},{x:-(3*o)/6,y:-o}];let c;const{cssStyles:u}=t;if(t.look==="handDrawn"){const d=kn.svg(s),h=Tn(t,{}),m=Xr(l),y=d.path(m,h);c=s.insert(()=>y,":first-child").attr("transform",`translate(${-a/2}, ${o/2})`),u&&c.attr("style",u)}else c=af(s,a,o,l);return r&&c.attr("style",r),t.width=a,t.height=o,Mn(t,c),t.intersect=function(d){return Sn.polygon(t,l,d)},s}ie(Gte,"lean_left");async function Kte(e,t){const{labelStyles:n,nodeStyles:r}=In(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await ur(e,t,tr(t)),a=Math.max(i.width+(t.padding??0),(t==null?void 0:t.width)??0),o=Math.max(i.height+(t.padding??0),(t==null?void 0:t.height)??0),l=[{x:-3*o/6,y:0},{x:a,y:0},{x:a+3*o/6,y:-o},{x:0,y:-o}];let c;const{cssStyles:u}=t;if(t.look==="handDrawn"){const d=kn.svg(s),h=Tn(t,{}),m=Xr(l),y=d.path(m,h);c=s.insert(()=>y,":first-child").attr("transform",`translate(${-a/2}, ${o/2})`),u&&c.attr("style",u)}else c=af(s,a,o,l);return r&&c.attr("style",r),t.width=a,t.height=o,Mn(t,c),t.intersect=function(d){return Sn.polygon(t,l,d)},s}ie(Kte,"lean_right");function Yte(e,t){const{labelStyles:n,nodeStyles:r}=In(t);t.label="",t.labelStyle=n;const s=e.insert("g").attr("class",tr(t)).attr("id",t.domId??t.id),{cssStyles:i}=t,a=Math.max(35,(t==null?void 0:t.width)??0),o=Math.max(35,(t==null?void 0:t.height)??0),l=7,c=[{x:a,y:0},{x:0,y:o+l/2},{x:a-2*l,y:o+l/2},{x:0,y:2*o},{x:a,y:o-l/2},{x:2*l,y:o-l/2}],u=kn.svg(s),d=Tn(t,{});t.look!=="handDrawn"&&(d.roughness=0,d.fillStyle="solid");const h=Xr(c),m=u.path(h,d),y=s.insert(()=>m,":first-child");return i&&t.look!=="handDrawn"&&y.selectAll("path").attr("style",i),r&&t.look!=="handDrawn"&&y.selectAll("path").attr("style",r),y.attr("transform",`translate(-${a/2},${-o})`),Mn(t,y),t.intersect=function(b){return zt.info("lightningBolt intersect",t,b),Sn.polygon(t,c,b)},s}ie(Yte,"lightningBolt");var L8e=ie((e,t,n,r,s,i,a)=>[`M${e},${t+i}`,`a${s},${i} 0,0,0 ${n},0`,`a${s},${i} 0,0,0 ${-n},0`,`l0,${r}`,`a${s},${i} 0,0,0 ${n},0`,`l0,${-r}`,`M${e},${t+i+a}`,`a${s},${i} 0,0,0 ${n},0`].join(" "),"createCylinderPathD"),B8e=ie((e,t,n,r,s,i,a)=>[`M${e},${t+i}`,`M${e+n},${t+i}`,`a${s},${i} 0,0,0 ${-n},0`,`l0,${r}`,`a${s},${i} 0,0,0 ${n},0`,`l0,${-r}`,`M${e},${t+i+a}`,`a${s},${i} 0,0,0 ${n},0`].join(" "),"createOuterCylinderPathD"),$8e=ie((e,t,n,r,s,i)=>[`M${e-n/2},${-r/2}`,`a${s},${i} 0,0,0 ${n},0`].join(" "),"createInnerCylinderPathD");async function Zte(e,t){const{labelStyles:n,nodeStyles:r}=In(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await ur(e,t,tr(t)),o=Math.max(i.width+(t.padding??0),t.width??0),l=o/2,c=l/(2.5+o/50),u=Math.max(i.height+c+(t.padding??0),t.height??0),d=u*.1;let h;const{cssStyles:m}=t;if(t.look==="handDrawn"){const y=kn.svg(s),b=B8e(0,0,o,u,l,c,d),v=$8e(0,c,o,u,l,c),x=Tn(t,{}),w=y.path(b,x),S=y.path(v,x);s.insert(()=>S,":first-child").attr("class","line"),h=s.insert(()=>w,":first-child"),h.attr("class","basic label-container"),m&&h.attr("style",m)}else{const y=L8e(0,0,o,u,l,c,d);h=s.insert("path",":first-child").attr("d",y).attr("class","basic label-container").attr("style",ro(m)).attr("style",r)}return h.attr("label-offset-y",c),h.attr("transform",`translate(${-o/2}, ${-(u/2+c)})`),Mn(t,h),a.attr("transform",`translate(${-(i.width/2)-(i.x-(i.left??0))}, ${-(i.height/2)+c-(i.y-(i.top??0))})`),t.intersect=function(y){const b=Sn.rect(t,y),v=b.x-(t.x??0);if(l!=0&&(Math.abs(v)<(t.width??0)/2||Math.abs(v)==(t.width??0)/2&&Math.abs(b.y-(t.y??0))>(t.height??0)/2-c)){let x=c*c*(1-v*v/(l*l));x>0&&(x=Math.sqrt(x)),x=c-x,y.y-(t.y??0)>0&&(x=-x),b.y+=x}return b},s}ie(Zte,"linedCylinder");async function Xte(e,t){const{labelStyles:n,nodeStyles:r}=In(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await ur(e,t,tr(t)),o=Math.max(i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),l=Math.max(i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),c=l/4,u=l+c,{cssStyles:d}=t,h=kn.svg(s),m=Tn(t,{});t.look!=="handDrawn"&&(m.roughness=0,m.fillStyle="solid");const y=[{x:-o/2-o/2*.1,y:-u/2},{x:-o/2-o/2*.1,y:u/2},...Ih(-o/2-o/2*.1,u/2,o/2+o/2*.1,u/2,c,.8),{x:o/2+o/2*.1,y:-u/2},{x:-o/2-o/2*.1,y:-u/2},{x:-o/2,y:-u/2},{x:-o/2,y:u/2*1.1},{x:-o/2,y:-u/2}],b=h.polygon(y.map(x=>[x.x,x.y]),m),v=s.insert(()=>b,":first-child");return v.attr("class","basic label-container"),d&&t.look!=="handDrawn"&&v.selectAll("path").attr("style",d),r&&t.look!=="handDrawn"&&v.selectAll("path").attr("style",r),v.attr("transform",`translate(0,${-c/2})`),a.attr("transform",`translate(${-o/2+(t.padding??0)+o/2*.1/2-(i.x-(i.left??0))},${-l/2+(t.padding??0)-c/2-(i.y-(i.top??0))})`),Mn(t,v),t.intersect=function(x){return Sn.polygon(t,y,x)},s}ie(Xte,"linedWaveEdgedRect");async function Jte(e,t){const{labelStyles:n,nodeStyles:r}=In(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await ur(e,t,tr(t)),o=Math.max(i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),l=Math.max(i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),c=5,u=-o/2,d=-l/2,{cssStyles:h}=t,m=kn.svg(s),y=Tn(t,{}),b=[{x:u-c,y:d+c},{x:u-c,y:d+l+c},{x:u+o-c,y:d+l+c},{x:u+o-c,y:d+l},{x:u+o,y:d+l},{x:u+o,y:d+l-c},{x:u+o+c,y:d+l-c},{x:u+o+c,y:d-c},{x:u+c,y:d-c},{x:u+c,y:d},{x:u,y:d},{x:u,y:d+c}],v=[{x:u,y:d+c},{x:u+o-c,y:d+c},{x:u+o-c,y:d+l},{x:u+o,y:d+l},{x:u+o,y:d},{x:u,y:d}];t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");const x=Xr(b),w=m.path(x,y),S=Xr(v),C=m.path(S,{...y,fill:"none"}),k=s.insert(()=>C,":first-child");return k.insert(()=>w,":first-child"),k.attr("class","basic label-container"),h&&t.look!=="handDrawn"&&k.selectAll("path").attr("style",h),r&&t.look!=="handDrawn"&&k.selectAll("path").attr("style",r),a.attr("transform",`translate(${-(i.width/2)-c-(i.x-(i.left??0))}, ${-(i.height/2)+c-(i.y-(i.top??0))})`),Mn(t,k),t.intersect=function(A){return Sn.polygon(t,b,A)},s}ie(Jte,"multiRect");async function Qte(e,t){const{labelStyles:n,nodeStyles:r}=In(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await ur(e,t,tr(t)),o=Math.max(i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),l=Math.max(i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),c=l/4,u=l+c,d=-o/2,h=-u/2,m=5,{cssStyles:y}=t,b=Ih(d-m,h+u+m,d+o-m,h+u+m,c,.8),v=b==null?void 0:b[b.length-1],x=[{x:d-m,y:h+m},{x:d-m,y:h+u+m},...b,{x:d+o-m,y:v.y-m},{x:d+o,y:v.y-m},{x:d+o,y:v.y-2*m},{x:d+o+m,y:v.y-2*m},{x:d+o+m,y:h-m},{x:d+m,y:h-m},{x:d+m,y:h},{x:d,y:h},{x:d,y:h+m}],w=[{x:d,y:h+m},{x:d+o-m,y:h+m},{x:d+o-m,y:v.y-m},{x:d+o,y:v.y-m},{x:d+o,y:h},{x:d,y:h}],S=kn.svg(s),C=Tn(t,{});t.look!=="handDrawn"&&(C.roughness=0,C.fillStyle="solid");const k=Xr(x),A=S.path(k,C),R=Xr(w),N=S.path(R,C),I=s.insert(()=>A,":first-child");return I.insert(()=>N),I.attr("class","basic label-container"),y&&t.look!=="handDrawn"&&I.selectAll("path").attr("style",y),r&&t.look!=="handDrawn"&&I.selectAll("path").attr("style",r),I.attr("transform",`translate(0,${-c/2})`),a.attr("transform",`translate(${-(i.width/2)-m-(i.x-(i.left??0))}, ${-(i.height/2)+m-c/2-(i.y-(i.top??0))})`),Mn(t,I),t.intersect=function(P){return Sn.polygon(t,x,P)},s}ie(Qte,"multiWaveEdgedRectangle");async function ene(e,t,{config:{themeVariables:n}}){var x;const{labelStyles:r,nodeStyles:s}=In(t);t.labelStyle=r,t.useHtmlLabels||((x=Mo().flowchart)==null?void 0:x.htmlLabels)!==!1||(t.centerLabel=!0);const{shapeSvg:a,bbox:o}=await ur(e,t,tr(t)),l=Math.max(o.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),c=Math.max(o.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),u=-l/2,d=-c/2,{cssStyles:h}=t,m=kn.svg(a),y=Tn(t,{fill:n.noteBkgColor,stroke:n.noteBorderColor});t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");const b=m.rectangle(u,d,l,c,y),v=a.insert(()=>b,":first-child");return v.attr("class","basic label-container"),h&&t.look!=="handDrawn"&&v.selectAll("path").attr("style",h),s&&t.look!=="handDrawn"&&v.selectAll("path").attr("style",s),Mn(t,v),t.intersect=function(w){return Sn.rect(t,w)},a}ie(ene,"note");var z8e=ie((e,t,n)=>[`M${e+n/2},${t}`,`L${e+n},${t-n/2}`,`L${e+n/2},${t-n}`,`L${e},${t-n/2}`,"Z"].join(" "),"createDecisionBoxPathD");async function tne(e,t){const{labelStyles:n,nodeStyles:r}=In(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await ur(e,t,tr(t)),a=i.width+t.padding,o=i.height+t.padding,l=a+o,c=[{x:l/2,y:0},{x:l,y:-l/2},{x:l/2,y:-l},{x:0,y:-l/2}];let u;const{cssStyles:d}=t;if(t.look==="handDrawn"){const h=kn.svg(s),m=Tn(t,{}),y=z8e(0,0,l),b=h.path(y,m);u=s.insert(()=>b,":first-child").attr("transform",`translate(${-l/2}, ${l/2})`),d&&u.attr("style",d)}else u=af(s,l,l,c);return r&&u.attr("style",r),Mn(t,u),t.intersect=function(h){return zt.debug(`APA12 Intersect called SPLIT
point:`,h,`
node:
`,t,`
res:`,Sn.polygon(t,c,h)),Sn.polygon(t,c,h)},s}ie(tne,"question");async function nne(e,t){const{labelStyles:n,nodeStyles:r}=In(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await ur(e,t,tr(t)),o=Math.max(i.width+(t.padding??0),(t==null?void 0:t.width)??0),l=Math.max(i.height+(t.padding??0),(t==null?void 0:t.height)??0),c=-o/2,u=-l/2,d=u/2,h=[{x:c+d,y:u},{x:c,y:0},{x:c+d,y:-u},{x:-c,y:-u},{x:-c,y:u}],{cssStyles:m}=t,y=kn.svg(s),b=Tn(t,{});t.look!=="handDrawn"&&(b.roughness=0,b.fillStyle="solid");const v=Xr(h),x=y.path(v,b),w=s.insert(()=>x,":first-child");return w.attr("class","basic label-container"),m&&t.look!=="handDrawn"&&w.selectAll("path").attr("style",m),r&&t.look!=="handDrawn"&&w.selectAll("path").attr("style",r),w.attr("transform",`translate(${-d/2},0)`),a.attr("transform",`translate(${-d/2-i.width/2-(i.x-(i.left??0))}, ${-(i.height/2)-(i.y-(i.top??0))})`),Mn(t,w),t.intersect=function(S){return Sn.polygon(t,h,S)},s}ie(nne,"rect_left_inv_arrow");async function rne(e,t){var N,I;const{labelStyles:n,nodeStyles:r}=In(t);t.labelStyle=n;let s;t.cssClasses?s="node "+t.cssClasses:s="node default";const i=e.insert("g").attr("class",s).attr("id",t.domId||t.id),a=i.insert("g"),o=i.insert("g").attr("class","label").attr("style",r),l=t.description,c=t.label,u=o.node().appendChild(await sm(c,t.labelStyle,!0,!0));let d={width:0,height:0};if(Wi((I=(N=os())==null?void 0:N.flowchart)==null?void 0:I.htmlLabels)){const P=u.children[0],L=Kr(u);d=P.getBoundingClientRect(),L.attr("width",d.width),L.attr("height",d.height)}zt.info("Text 2",l);const h=l||[],m=u.getBBox(),y=o.node().appendChild(await sm(h.join?h.join("<br/>"):h,t.labelStyle,!0,!0)),b=y.children[0],v=Kr(y);d=b.getBoundingClientRect(),v.attr("width",d.width),v.attr("height",d.height);const x=(t.padding||0)/2;Kr(y).attr("transform","translate( "+(d.width>m.width?0:(m.width-d.width)/2)+", "+(m.height+x+5)+")"),Kr(u).attr("transform","translate( "+(d.width<m.width?0:-(m.width-d.width)/2)+", 0)"),d=o.node().getBBox(),o.attr("transform","translate("+-d.width/2+", "+(-d.height/2-x+3)+")");const w=d.width+(t.padding||0),S=d.height+(t.padding||0),C=-d.width/2-x,k=-d.height/2-x;let A,R;if(t.look==="handDrawn"){const P=kn.svg(i),L=Tn(t,{}),O=P.path(sf(C,k,w,S,t.rx||0),L),V=P.line(-d.width/2-x,-d.height/2-x+m.height+x,d.width/2+x,-d.height/2-x+m.height+x,L);R=i.insert(()=>(zt.debug("Rough node insert CXC",O),V),":first-child"),A=i.insert(()=>(zt.debug("Rough node insert CXC",O),O),":first-child")}else A=a.insert("rect",":first-child"),R=a.insert("line"),A.attr("class","outer title-state").attr("style",r).attr("x",-d.width/2-x).attr("y",-d.height/2-x).attr("width",d.width+(t.padding||0)).attr("height",d.height+(t.padding||0)),R.attr("class","divider").attr("x1",-d.width/2-x).attr("x2",d.width/2+x).attr("y1",-d.height/2-x+m.height+x).attr("y2",-d.height/2-x+m.height+x);return Mn(t,A),t.intersect=function(P){return Sn.rect(t,P)},i}ie(rne,"rectWithTitle");async function sne(e,t){const n={rx:5,ry:5,labelPaddingX:((t==null?void 0:t.padding)||0)*1,labelPaddingY:((t==null?void 0:t.padding)||0)*1};return X1(e,t,n)}ie(sne,"roundedRect");async function ine(e,t){const{labelStyles:n,nodeStyles:r}=In(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await ur(e,t,tr(t)),o=(t==null?void 0:t.padding)??0,l=Math.max(i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),c=Math.max(i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),u=-i.width/2-o,d=-i.height/2-o,{cssStyles:h}=t,m=kn.svg(s),y=Tn(t,{});t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");const b=[{x:u,y:d},{x:u+l+8,y:d},{x:u+l+8,y:d+c},{x:u-8,y:d+c},{x:u-8,y:d},{x:u,y:d},{x:u,y:d+c}],v=m.polygon(b.map(w=>[w.x,w.y]),y),x=s.insert(()=>v,":first-child");return x.attr("class","basic label-container").attr("style",ro(h)),r&&t.look!=="handDrawn"&&x.selectAll("path").attr("style",r),h&&t.look!=="handDrawn"&&x.selectAll("path").attr("style",r),a.attr("transform",`translate(${-l/2+4+(t.padding??0)-(i.x-(i.left??0))},${-c/2+(t.padding??0)-(i.y-(i.top??0))})`),Mn(t,x),t.intersect=function(w){return Sn.rect(t,w)},s}ie(ine,"shadedProcess");async function ane(e,t){const{labelStyles:n,nodeStyles:r}=In(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await ur(e,t,tr(t)),o=Math.max(i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),l=Math.max(i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),c=-o/2,u=-l/2,{cssStyles:d}=t,h=kn.svg(s),m=Tn(t,{});t.look!=="handDrawn"&&(m.roughness=0,m.fillStyle="solid");const y=[{x:c,y:u},{x:c,y:u+l},{x:c+o,y:u+l},{x:c+o,y:u-l/2}],b=Xr(y),v=h.path(b,m),x=s.insert(()=>v,":first-child");return x.attr("class","basic label-container"),d&&t.look!=="handDrawn"&&x.selectChildren("path").attr("style",d),r&&t.look!=="handDrawn"&&x.selectChildren("path").attr("style",r),x.attr("transform",`translate(0, ${l/4})`),a.attr("transform",`translate(${-o/2+(t.padding??0)-(i.x-(i.left??0))}, ${-l/4+(t.padding??0)-(i.y-(i.top??0))})`),Mn(t,x),t.intersect=function(w){return Sn.polygon(t,y,w)},s}ie(ane,"slopedRect");async function one(e,t){const n={rx:0,ry:0,labelPaddingX:((t==null?void 0:t.padding)||0)*2,labelPaddingY:((t==null?void 0:t.padding)||0)*1};return X1(e,t,n)}ie(one,"squareRect");async function lne(e,t){const{labelStyles:n,nodeStyles:r}=In(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await ur(e,t,tr(t)),a=i.height+t.padding,o=i.width+a/4+t.padding;let l;const{cssStyles:c}=t;if(t.look==="handDrawn"){const u=kn.svg(s),d=Tn(t,{}),h=sf(-o/2,-a/2,o,a,a/2),m=u.path(h,d);l=s.insert(()=>m,":first-child"),l.attr("class","basic label-container").attr("style",ro(c))}else l=s.insert("rect",":first-child"),l.attr("class","basic label-container").attr("style",r).attr("rx",a/2).attr("ry",a/2).attr("x",-o/2).attr("y",-a/2).attr("width",o).attr("height",a);return Mn(t,l),t.intersect=function(u){return Sn.rect(t,u)},s}ie(lne,"stadium");async function cne(e,t){return X1(e,t,{rx:5,ry:5})}ie(cne,"state");function une(e,t,{config:{themeVariables:n}}){const{labelStyles:r,nodeStyles:s}=In(t);t.labelStyle=r;const{cssStyles:i}=t,{lineColor:a,stateBorder:o,nodeBorder:l}=n,c=e.insert("g").attr("class","node default").attr("id",t.domId||t.id),u=kn.svg(c),d=Tn(t,{});t.look!=="handDrawn"&&(d.roughness=0,d.fillStyle="solid");const h=u.circle(0,0,14,{...d,stroke:a,strokeWidth:2}),m=o??l,y=u.circle(0,0,5,{...d,fill:m,stroke:m,strokeWidth:2,fillStyle:"solid"}),b=c.insert(()=>h,":first-child");return b.insert(()=>y),i&&b.selectAll("path").attr("style",i),s&&b.selectAll("path").attr("style",s),Mn(t,b),t.intersect=function(v){return Sn.circle(t,7,v)},c}ie(une,"stateEnd");function dne(e,t,{config:{themeVariables:n}}){const{lineColor:r}=n,s=e.insert("g").attr("class","node default").attr("id",t.domId||t.id);let i;if(t.look==="handDrawn"){const o=kn.svg(s).circle(0,0,14,w8e(r));i=s.insert(()=>o),i.attr("class","state-start").attr("r",7).attr("width",14).attr("height",14)}else i=s.insert("circle",":first-child"),i.attr("class","state-start").attr("r",7).attr("width",14).attr("height",14);return Mn(t,i),t.intersect=function(a){return Sn.circle(t,7,a)},s}ie(dne,"stateStart");async function fne(e,t){const{labelStyles:n,nodeStyles:r}=In(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await ur(e,t,tr(t)),a=((t==null?void 0:t.padding)||0)/2,o=i.width+t.padding,l=i.height+t.padding,c=-i.width/2-a,u=-i.height/2-a,d=[{x:0,y:0},{x:o,y:0},{x:o,y:-l},{x:0,y:-l},{x:0,y:0},{x:-8,y:0},{x:o+8,y:0},{x:o+8,y:-l},{x:-8,y:-l},{x:-8,y:0}];if(t.look==="handDrawn"){const h=kn.svg(s),m=Tn(t,{}),y=h.rectangle(c-8,u,o+16,l,m),b=h.line(c,u,c,u+l,m),v=h.line(c+o,u,c+o,u+l,m);s.insert(()=>b,":first-child"),s.insert(()=>v,":first-child");const x=s.insert(()=>y,":first-child"),{cssStyles:w}=t;x.attr("class","basic label-container").attr("style",ro(w)),Mn(t,x)}else{const h=af(s,o,l,d);r&&h.attr("style",r),Mn(t,h)}return t.intersect=function(h){return Sn.polygon(t,d,h)},s}ie(fne,"subroutine");async function hne(e,t){const{labelStyles:n,nodeStyles:r}=In(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await ur(e,t,tr(t)),a=Math.max(i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),o=Math.max(i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),l=-a/2,c=-o/2,u=.2*o,d=.2*o,{cssStyles:h}=t,m=kn.svg(s),y=Tn(t,{}),b=[{x:l-u/2,y:c},{x:l+a+u/2,y:c},{x:l+a+u/2,y:c+o},{x:l-u/2,y:c+o}],v=[{x:l+a-u/2,y:c+o},{x:l+a+u/2,y:c+o},{x:l+a+u/2,y:c+o-d}];t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");const x=Xr(b),w=m.path(x,y),S=Xr(v),C=m.path(S,{...y,fillStyle:"solid"}),k=s.insert(()=>C,":first-child");return k.insert(()=>w,":first-child"),k.attr("class","basic label-container"),h&&t.look!=="handDrawn"&&k.selectAll("path").attr("style",h),r&&t.look!=="handDrawn"&&k.selectAll("path").attr("style",r),Mn(t,k),t.intersect=function(A){return Sn.polygon(t,b,A)},s}ie(hne,"taggedRect");async function pne(e,t){const{labelStyles:n,nodeStyles:r}=In(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await ur(e,t,tr(t)),o=Math.max(i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),l=Math.max(i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),c=l/4,u=.2*o,d=.2*l,h=l+c,{cssStyles:m}=t,y=kn.svg(s),b=Tn(t,{});t.look!=="handDrawn"&&(b.roughness=0,b.fillStyle="solid");const v=[{x:-o/2-o/2*.1,y:h/2},...Ih(-o/2-o/2*.1,h/2,o/2+o/2*.1,h/2,c,.8),{x:o/2+o/2*.1,y:-h/2},{x:-o/2-o/2*.1,y:-h/2}],x=-o/2+o/2*.1,w=-h/2-d*.4,S=[{x:x+o-u,y:(w+l)*1.4},{x:x+o,y:w+l-d},{x:x+o,y:(w+l)*.9},...Ih(x+o,(w+l)*1.3,x+o-u,(w+l)*1.5,-l*.03,.5)],C=Xr(v),k=y.path(C,b),A=Xr(S),R=y.path(A,{...b,fillStyle:"solid"}),N=s.insert(()=>R,":first-child");return N.insert(()=>k,":first-child"),N.attr("class","basic label-container"),m&&t.look!=="handDrawn"&&N.selectAll("path").attr("style",m),r&&t.look!=="handDrawn"&&N.selectAll("path").attr("style",r),N.attr("transform",`translate(0,${-c/2})`),a.attr("transform",`translate(${-o/2+(t.padding??0)-(i.x-(i.left??0))},${-l/2+(t.padding??0)-c/2-(i.y-(i.top??0))})`),Mn(t,N),t.intersect=function(I){return Sn.polygon(t,v,I)},s}ie(pne,"taggedWaveEdgedRectangle");async function mne(e,t){const{labelStyles:n,nodeStyles:r}=In(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await ur(e,t,tr(t)),a=Math.max(i.width+t.padding,(t==null?void 0:t.width)||0),o=Math.max(i.height+t.padding,(t==null?void 0:t.height)||0),l=-a/2,c=-o/2,u=s.insert("rect",":first-child");return u.attr("class","text").attr("style",r).attr("rx",0).attr("ry",0).attr("x",l).attr("y",c).attr("width",a).attr("height",o),Mn(t,u),t.intersect=function(d){return Sn.rect(t,d)},s}ie(mne,"text");var U8e=ie((e,t,n,r,s,i)=>`M${e},${t}
    a${s},${i} 0,0,1 0,${-r}
    l${n},0
    a${s},${i} 0,0,1 0,${r}
    M${n},${-r}
    a${s},${i} 0,0,0 0,${r}
    l${-n},0`,"createCylinderPathD"),q8e=ie((e,t,n,r,s,i)=>[`M${e},${t}`,`M${e+n},${t}`,`a${s},${i} 0,0,0 0,${-r}`,`l${-n},0`,`a${s},${i} 0,0,0 0,${r}`,`l${n},0`].join(" "),"createOuterCylinderPathD"),V8e=ie((e,t,n,r,s,i)=>[`M${e+n/2},${-r/2}`,`a${s},${i} 0,0,0 0,${r}`].join(" "),"createInnerCylinderPathD");async function gne(e,t){const{labelStyles:n,nodeStyles:r}=In(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a,halfPadding:o}=await ur(e,t,tr(t)),l=t.look==="neo"?o*2:o,c=i.height+l,u=c/2,d=u/(2.5+c/50),h=i.width+d+l,{cssStyles:m}=t;let y;if(t.look==="handDrawn"){const b=kn.svg(s),v=q8e(0,0,h,c,d,u),x=V8e(0,0,h,c,d,u),w=b.path(v,Tn(t,{})),S=b.path(x,Tn(t,{fill:"none"}));y=s.insert(()=>S,":first-child"),y=s.insert(()=>w,":first-child"),y.attr("class","basic label-container"),m&&y.attr("style",m)}else{const b=U8e(0,0,h,c,d,u);y=s.insert("path",":first-child").attr("d",b).attr("class","basic label-container").attr("style",ro(m)).attr("style",r),y.attr("class","basic label-container"),m&&y.selectAll("path").attr("style",m),r&&y.selectAll("path").attr("style",r)}return y.attr("label-offset-x",d),y.attr("transform",`translate(${-h/2}, ${c/2} )`),a.attr("transform",`translate(${-(i.width/2)-d-(i.x-(i.left??0))}, ${-(i.height/2)-(i.y-(i.top??0))})`),Mn(t,y),t.intersect=function(b){const v=Sn.rect(t,b),x=v.y-(t.y??0);if(u!=0&&(Math.abs(x)<(t.height??0)/2||Math.abs(x)==(t.height??0)/2&&Math.abs(v.x-(t.x??0))>(t.width??0)/2-d)){let w=d*d*(1-x*x/(u*u));w!=0&&(w=Math.sqrt(Math.abs(w))),w=d-w,b.x-(t.x??0)>0&&(w=-w),v.x+=w}return v},s}ie(gne,"tiltedCylinder");async function yne(e,t){const{labelStyles:n,nodeStyles:r}=In(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await ur(e,t,tr(t)),a=i.width+t.padding,o=i.height+t.padding,l=[{x:-3*o/6,y:0},{x:a+3*o/6,y:0},{x:a,y:-o},{x:0,y:-o}];let c;const{cssStyles:u}=t;if(t.look==="handDrawn"){const d=kn.svg(s),h=Tn(t,{}),m=Xr(l),y=d.path(m,h);c=s.insert(()=>y,":first-child").attr("transform",`translate(${-a/2}, ${o/2})`),u&&c.attr("style",u)}else c=af(s,a,o,l);return r&&c.attr("style",r),t.width=a,t.height=o,Mn(t,c),t.intersect=function(d){return Sn.polygon(t,l,d)},s}ie(yne,"trapezoid");async function bne(e,t){const{labelStyles:n,nodeStyles:r}=In(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await ur(e,t,tr(t)),a=60,o=20,l=Math.max(a,i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),c=Math.max(o,i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),{cssStyles:u}=t,d=kn.svg(s),h=Tn(t,{});t.look!=="handDrawn"&&(h.roughness=0,h.fillStyle="solid");const m=[{x:-l/2*.8,y:-c/2},{x:l/2*.8,y:-c/2},{x:l/2,y:-c/2*.6},{x:l/2,y:c/2},{x:-l/2,y:c/2},{x:-l/2,y:-c/2*.6}],y=Xr(m),b=d.path(y,h),v=s.insert(()=>b,":first-child");return v.attr("class","basic label-container"),u&&t.look!=="handDrawn"&&v.selectChildren("path").attr("style",u),r&&t.look!=="handDrawn"&&v.selectChildren("path").attr("style",r),Mn(t,v),t.intersect=function(x){return Sn.polygon(t,m,x)},s}ie(bne,"trapezoidalPentagon");async function vne(e,t){var w;const{labelStyles:n,nodeStyles:r}=In(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await ur(e,t,tr(t)),o=Wi((w=os().flowchart)==null?void 0:w.htmlLabels),l=i.width+(t.padding??0),c=l+i.height,u=l+i.height,d=[{x:0,y:0},{x:u,y:0},{x:u/2,y:-c}],{cssStyles:h}=t,m=kn.svg(s),y=Tn(t,{});t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");const b=Xr(d),v=m.path(b,y),x=s.insert(()=>v,":first-child").attr("transform",`translate(${-c/2}, ${c/2})`);return h&&t.look!=="handDrawn"&&x.selectChildren("path").attr("style",h),r&&t.look!=="handDrawn"&&x.selectChildren("path").attr("style",r),t.width=l,t.height=c,Mn(t,x),a.attr("transform",`translate(${-i.width/2-(i.x-(i.left??0))}, ${c/2-(i.height+(t.padding??0)/(o?2:1)-(i.y-(i.top??0)))})`),t.intersect=function(S){return zt.info("Triangle intersect",t,d,S),Sn.polygon(t,d,S)},s}ie(vne,"triangle");async function xne(e,t){const{labelStyles:n,nodeStyles:r}=In(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await ur(e,t,tr(t)),o=Math.max(i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),l=Math.max(i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),c=l/8,u=l+c,{cssStyles:d}=t,m=70-o,y=m>0?m/2:0,b=kn.svg(s),v=Tn(t,{});t.look!=="handDrawn"&&(v.roughness=0,v.fillStyle="solid");const x=[{x:-o/2-y,y:u/2},...Ih(-o/2-y,u/2,o/2+y,u/2,c,.8),{x:o/2+y,y:-u/2},{x:-o/2-y,y:-u/2}],w=Xr(x),S=b.path(w,v),C=s.insert(()=>S,":first-child");return C.attr("class","basic label-container"),d&&t.look!=="handDrawn"&&C.selectAll("path").attr("style",d),r&&t.look!=="handDrawn"&&C.selectAll("path").attr("style",r),C.attr("transform",`translate(0,${-c/2})`),a.attr("transform",`translate(${-o/2+(t.padding??0)-(i.x-(i.left??0))},${-l/2+(t.padding??0)-c-(i.y-(i.top??0))})`),Mn(t,C),t.intersect=function(k){return Sn.polygon(t,x,k)},s}ie(xne,"waveEdgedRectangle");async function wne(e,t){const{labelStyles:n,nodeStyles:r}=In(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await ur(e,t,tr(t)),a=100,o=50,l=Math.max(i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),c=Math.max(i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),u=l/c;let d=l,h=c;d>h*u?h=d/u:d=h*u,d=Math.max(d,a),h=Math.max(h,o);const m=Math.min(h*.2,h/4),y=h+m*2,{cssStyles:b}=t,v=kn.svg(s),x=Tn(t,{});t.look!=="handDrawn"&&(x.roughness=0,x.fillStyle="solid");const w=[{x:-d/2,y:y/2},...Ih(-d/2,y/2,d/2,y/2,m,1),{x:d/2,y:-y/2},...Ih(d/2,-y/2,-d/2,-y/2,m,-1)],S=Xr(w),C=v.path(S,x),k=s.insert(()=>C,":first-child");return k.attr("class","basic label-container"),b&&t.look!=="handDrawn"&&k.selectAll("path").attr("style",b),r&&t.look!=="handDrawn"&&k.selectAll("path").attr("style",r),Mn(t,k),t.intersect=function(A){return Sn.polygon(t,w,A)},s}ie(wne,"waveRectangle");async function _ne(e,t){const{labelStyles:n,nodeStyles:r}=In(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await ur(e,t,tr(t)),o=Math.max(i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),l=Math.max(i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),c=5,u=-o/2,d=-l/2,{cssStyles:h}=t,m=kn.svg(s),y=Tn(t,{}),b=[{x:u-c,y:d-c},{x:u-c,y:d+l},{x:u+o,y:d+l},{x:u+o,y:d-c}],v=`M${u-c},${d-c} L${u+o},${d-c} L${u+o},${d+l} L${u-c},${d+l} L${u-c},${d-c}
                M${u-c},${d} L${u+o},${d}
                M${u},${d-c} L${u},${d+l}`;t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");const x=m.path(v,y),w=s.insert(()=>x,":first-child");return w.attr("transform",`translate(${c/2}, ${c/2})`),w.attr("class","basic label-container"),h&&t.look!=="handDrawn"&&w.selectAll("path").attr("style",h),r&&t.look!=="handDrawn"&&w.selectAll("path").attr("style",r),a.attr("transform",`translate(${-(i.width/2)+c/2-(i.x-(i.left??0))}, ${-(i.height/2)+c/2-(i.y-(i.top??0))})`),Mn(t,w),t.intersect=function(S){return Sn.polygon(t,b,S)},s}ie(_ne,"windowPane");async function b6(e,t){var ne,W,Q;const n=t;if(n.alias&&(t.label=n.alias),t.look==="handDrawn"){const{themeVariables:ee}=Mo(),{background:se}=ee,pe={...t,id:t.id+"-background",look:"default",cssStyles:["stroke: none",`fill: ${se}`]};await b6(e,pe)}const r=Mo();t.useHtmlLabels=r.htmlLabels;let s=((ne=r.er)==null?void 0:ne.diagramPadding)??10,i=((W=r.er)==null?void 0:W.entityPadding)??6;const{cssStyles:a}=t,{labelStyles:o}=In(t);if(n.attributes.length===0&&t.label){const ee={rx:0,ry:0,labelPaddingX:s,labelPaddingY:s*1.5};Kd(t.label,r)+ee.labelPaddingX*2<r.er.minEntityWidth&&(t.width=r.er.minEntityWidth);const se=await X1(e,t,ee);if(!Wi(r.htmlLabels)){const pe=se.select("text"),ce=(Q=pe.node())==null?void 0:Q.getBBox();pe.attr("transform",`translate(${-ce.width/2}, 0)`)}return se}r.htmlLabels||(s*=1.25,i*=1.25);let l=tr(t);l||(l="node default");const c=e.insert("g").attr("class",l).attr("id",t.domId||t.id),u=await u0(c,t.label??"",r,0,0,["name"],o);u.height+=i;let d=0;const h=[];let m=0,y=0,b=0,v=0,x=!0,w=!0;for(const ee of n.attributes){const se=await u0(c,ee.type,r,0,d,["attribute-type"],o);m=Math.max(m,se.width+s);const pe=await u0(c,ee.name,r,0,d,["attribute-name"],o);y=Math.max(y,pe.width+s);const ce=await u0(c,ee.keys.join(),r,0,d,["attribute-keys"],o);b=Math.max(b,ce.width+s);const Ie=await u0(c,ee.comment,r,0,d,["attribute-comment"],o);v=Math.max(v,Ie.width+s),d+=Math.max(se.height,pe.height,ce.height,Ie.height)+i,h.push(d)}h.pop();let S=4;b<=s&&(x=!1,b=0,S--),v<=s&&(w=!1,v=0,S--);const C=c.node().getBBox();if(u.width+s*2-(m+y+b+v)>0){const ee=u.width+s*2-(m+y+b+v);m+=ee/S,y+=ee/S,b>0&&(b+=ee/S),v>0&&(v+=ee/S)}const k=m+y+b+v,A=kn.svg(c),R=Tn(t,{});t.look!=="handDrawn"&&(R.roughness=0,R.fillStyle="solid");const N=Math.max(C.width+s*2,(t==null?void 0:t.width)||0,k),I=Math.max(C.height+(h[0]||d)+i,(t==null?void 0:t.height)||0),P=-N/2,L=-I/2;c.selectAll("g:not(:first-child)").each((ee,se,pe)=>{const ce=Kr(pe[se]),Ie=ce.attr("transform");let De=0,Se=0;if(Ie){const qe=RegExp(/translate\(([^,]+),([^)]+)\)/).exec(Ie);qe&&(De=parseFloat(qe[1]),Se=parseFloat(qe[2]),ce.attr("class").includes("attribute-name")?De+=m:ce.attr("class").includes("attribute-keys")?De+=m+y:ce.attr("class").includes("attribute-comment")&&(De+=m+y+b))}ce.attr("transform",`translate(${P+s/2+De}, ${Se+L+u.height+i/2})`)}),c.select(".name").attr("transform","translate("+-u.width/2+", "+(L+i/2)+")");const O=A.rectangle(P,L,N,I,R),V=c.insert(()=>O,":first-child").attr("style",a.join("")),{themeVariables:D}=Mo(),{rowEven:Z,rowOdd:U,nodeBorder:H}=D;h.push(0);for(const[ee,se]of h.entries()){if(ee===0&&h.length>1)continue;const pe=ee%2===0&&se!==0,ce=A.rectangle(P,u.height+L+se,N,u.height,{...R,fill:pe?Z:U,stroke:H});c.insert(()=>ce,"g.label").attr("style",a.join("")).attr("class",`row-rect-${ee%2===0?"even":"odd"}`)}let $=A.line(P,u.height+L,N+P,u.height+L,R);c.insert(()=>$).attr("class","divider"),$=A.line(m+P,u.height+L,m+P,I+L,R),c.insert(()=>$).attr("class","divider"),x&&($=A.line(m+y+P,u.height+L,m+y+P,I+L,R),c.insert(()=>$).attr("class","divider")),w&&($=A.line(m+y+b+P,u.height+L,m+y+b+P,I+L,R),c.insert(()=>$).attr("class","divider"));for(const ee of h)$=A.line(P,u.height+L+ee,N+P,u.height+L+ee,R),c.insert(()=>$).attr("class","divider");return Mn(t,V),t.intersect=function(ee){return Sn.rect(t,ee)},c}ie(b6,"erBox");async function u0(e,t,n,r=0,s=0,i=[],a=""){const o=e.insert("g").attr("class",`label ${i.join(" ")}`).attr("transform",`translate(${r}, ${s})`).attr("style",a);t!==d7(t)&&(t=d7(t),t=t.replaceAll("<","&lt;").replaceAll(">","&gt;"));const l=o.node().appendChild(await Jh(o,t,{width:Kd(t,n)+100,style:a,useHtmlLabels:n.htmlLabels},n));if(t.includes("&lt;")||t.includes("&gt;")){let u=l.children[0];for(u.textContent=u.textContent.replaceAll("&lt;","<").replaceAll("&gt;",">");u.childNodes[0];)u=u.childNodes[0],u.textContent=u.textContent.replaceAll("&lt;","<").replaceAll("&gt;",">")}let c=l.getBBox();if(Wi(n.htmlLabels)){const u=l.children[0];u.style.textAlign="start";const d=Kr(l);c=u.getBoundingClientRect(),d.attr("width",c.width),d.attr("height",c.height)}return c}ie(u0,"addText");async function Sne(e,t,n,r,s=n.class.padding??12){const i=r?0:3,a=e.insert("g").attr("class",tr(t)).attr("id",t.domId||t.id);let o=null,l=null,c=null,u=null,d=0,h=0,m=0;if(o=a.insert("g").attr("class","annotation-group text"),t.annotations.length>0){const w=t.annotations[0];await nx(o,{text:`«${w}»`},0),d=o.node().getBBox().height}l=a.insert("g").attr("class","label-group text"),await nx(l,t,0,["font-weight: bolder"]);const y=l.node().getBBox();h=y.height,c=a.insert("g").attr("class","members-group text");let b=0;for(const w of t.members){const S=await nx(c,w,b,[w.parseClassifier()]);b+=S+i}m=c.node().getBBox().height,m<=0&&(m=s/2),u=a.insert("g").attr("class","methods-group text");let v=0;for(const w of t.methods){const S=await nx(u,w,v,[w.parseClassifier()]);v+=S+i}let x=a.node().getBBox();if(o!==null){const w=o.node().getBBox();o.attr("transform",`translate(${-w.width/2})`)}return l.attr("transform",`translate(${-y.width/2}, ${d})`),x=a.node().getBBox(),c.attr("transform",`translate(0, ${d+h+s*2})`),x=a.node().getBBox(),u.attr("transform",`translate(0, ${d+h+(m?m+s*4:s*2)})`),x=a.node().getBBox(),{shapeSvg:a,bbox:x}}ie(Sne,"textHelper");async function nx(e,t,n,r=[]){const s=e.insert("g").attr("class","label").attr("style",r.join("; ")),i=Mo();let a="useHtmlLabels"in t?t.useHtmlLabels:Wi(i.htmlLabels)??!0,o="";"text"in t?o=t.text:o=t.label,!a&&o.startsWith("\\")&&(o=o.substring(1)),wy(o)&&(a=!0);const l=await Jh(s,AD(eg(o)),{width:Kd(o,i)+50,classes:"markdown-node-label",useHtmlLabels:a},i);let c,u=1;if(a){const d=l.children[0],h=Kr(l);u=d.innerHTML.split("<br>").length,d.innerHTML.includes("</math>")&&(u+=d.innerHTML.split("<mrow>").length-1);const m=d.getElementsByTagName("img");if(m){const y=o.replace(/<img[^>]*>/g,"").trim()==="";await Promise.all([...m].map(b=>new Promise(v=>{function x(){var w;if(b.style.display="flex",b.style.flexDirection="column",y){const S=((w=i.fontSize)==null?void 0:w.toString())??window.getComputedStyle(document.body).fontSize,k=parseInt(S,10)*5+"px";b.style.minWidth=k,b.style.maxWidth=k}else b.style.width="100%";v(b)}ie(x,"setupImage"),setTimeout(()=>{b.complete&&x()}),b.addEventListener("error",x),b.addEventListener("load",x)})))}c=d.getBoundingClientRect(),h.attr("width",c.width),h.attr("height",c.height)}else{r.includes("font-weight: bolder")&&Kr(l).selectAll("tspan").attr("font-weight",""),u=l.children.length;const d=l.children[0];(l.textContent===""||l.textContent.includes("&gt"))&&(d.textContent=o[0]+o.substring(1).replaceAll("&gt;",">").replaceAll("&lt;","<").trim(),o[1]===" "&&(d.textContent=d.textContent[0]+" "+d.textContent.substring(1))),d.textContent==="undefined"&&(d.textContent=""),c=l.getBBox()}return s.attr("transform","translate(0,"+(-c.height/(2*u)+n)+")"),c.height}ie(nx,"addText");async function Cne(e,t){var I,P;const n=os(),r=n.class.padding??12,s=r,i=t.useHtmlLabels??Wi(n.htmlLabels)??!0,a=t;a.annotations=a.annotations??[],a.members=a.members??[],a.methods=a.methods??[];const{shapeSvg:o,bbox:l}=await Sne(e,t,n,i,s),{labelStyles:c,nodeStyles:u}=In(t);t.labelStyle=c,t.cssStyles=a.styles||"";const d=((I=a.styles)==null?void 0:I.join(";"))||u||"";t.cssStyles||(t.cssStyles=d.replaceAll("!important","").split(";"));const h=a.members.length===0&&a.methods.length===0&&!((P=n.class)!=null&&P.hideEmptyMembersBox),m=kn.svg(o),y=Tn(t,{});t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");const b=l.width;let v=l.height;a.members.length===0&&a.methods.length===0?v+=s:a.members.length>0&&a.methods.length===0&&(v+=s*2);const x=-b/2,w=-v/2,S=m.rectangle(x-r,w-r-(h?r:a.members.length===0&&a.methods.length===0?-r/2:0),b+2*r,v+2*r+(h?r*2:a.members.length===0&&a.methods.length===0?-r:0),y),C=o.insert(()=>S,":first-child");C.attr("class","basic label-container");const k=C.node().getBBox();o.selectAll(".text").each((L,O,V)=>{var ne;const D=Kr(V[O]),Z=D.attr("transform");let U=0;if(Z){const Q=RegExp(/translate\(([^,]+),([^)]+)\)/).exec(Z);Q&&(U=parseFloat(Q[2]))}let H=U+w+r-(h?r:a.members.length===0&&a.methods.length===0?-r/2:0);i||(H-=4);let $=x;(D.attr("class").includes("label-group")||D.attr("class").includes("annotation-group"))&&($=-((ne=D.node())==null?void 0:ne.getBBox().width)/2||0,o.selectAll("text").each(function(W,Q,ee){window.getComputedStyle(ee[Q]).textAnchor==="middle"&&($=0)})),D.attr("transform",`translate(${$}, ${H})`)});const A=o.select(".annotation-group").node().getBBox().height-(h?r/2:0)||0,R=o.select(".label-group").node().getBBox().height-(h?r/2:0)||0,N=o.select(".members-group").node().getBBox().height-(h?r/2:0)||0;if(a.members.length>0||a.methods.length>0||h){const L=m.line(k.x,A+R+w+r,k.x+k.width,A+R+w+r,y);o.insert(()=>L).attr("class","divider").attr("style",d)}if(h||a.members.length>0||a.methods.length>0){const L=m.line(k.x,A+R+N+w+s*2+r,k.x+k.width,A+R+N+w+r+s*2,y);o.insert(()=>L).attr("class","divider").attr("style",d)}if(a.look!=="handDrawn"&&o.selectAll("path").attr("style",d),C.select(":nth-child(2)").attr("style",d),o.selectAll(".divider").select("path").attr("style",d),t.labelStyle?o.selectAll("span").attr("style",t.labelStyle):o.selectAll("span").attr("style",d),!i){const L=RegExp(/color\s*:\s*([^;]*)/),O=L.exec(d);if(O){const V=O[0].replace("color","fill");o.selectAll("tspan").attr("style",V)}else if(c){const V=L.exec(c);if(V){const D=V[0].replace("color","fill");o.selectAll("tspan").attr("style",D)}}}return Mn(t,C),t.intersect=function(L){return Sn.rect(t,L)},o}ie(Cne,"classBox");async function kne(e,t){var A,R;const{labelStyles:n,nodeStyles:r}=In(t);t.labelStyle=n;const s=t,i=t,a=20,o=20,l="verifyMethod"in t,c=tr(t),u=e.insert("g").attr("class",c).attr("id",t.domId??t.id);let d;l?d=await su(u,`&lt;&lt;${s.type}&gt;&gt;`,0,t.labelStyle):d=await su(u,"&lt;&lt;Element&gt;&gt;",0,t.labelStyle);let h=d;const m=await su(u,s.name,h,t.labelStyle+"; font-weight: bold;");if(h+=m+o,l){const N=await su(u,`${s.requirementId?`Id: ${s.requirementId}`:""}`,h,t.labelStyle);h+=N;const I=await su(u,`${s.text?`Text: ${s.text}`:""}`,h,t.labelStyle);h+=I;const P=await su(u,`${s.risk?`Risk: ${s.risk}`:""}`,h,t.labelStyle);h+=P,await su(u,`${s.verifyMethod?`Verification: ${s.verifyMethod}`:""}`,h,t.labelStyle)}else{const N=await su(u,`${i.type?`Type: ${i.type}`:""}`,h,t.labelStyle);h+=N,await su(u,`${i.docRef?`Doc Ref: ${i.docRef}`:""}`,h,t.labelStyle)}const y=(((A=u.node())==null?void 0:A.getBBox().width)??200)+a,b=(((R=u.node())==null?void 0:R.getBBox().height)??200)+a,v=-y/2,x=-b/2,w=kn.svg(u),S=Tn(t,{});t.look!=="handDrawn"&&(S.roughness=0,S.fillStyle="solid");const C=w.rectangle(v,x,y,b,S),k=u.insert(()=>C,":first-child");if(k.attr("class","basic label-container").attr("style",r),u.selectAll(".label").each((N,I,P)=>{const L=Kr(P[I]),O=L.attr("transform");let V=0,D=0;if(O){const $=RegExp(/translate\(([^,]+),([^)]+)\)/).exec(O);$&&(V=parseFloat($[1]),D=parseFloat($[2]))}const Z=D-b/2;let U=v+a/2;(I===0||I===1)&&(U=V),L.attr("transform",`translate(${U}, ${Z+a})`)}),h>d+m+o){const N=w.line(v,x+d+m+o,v+y,x+d+m+o,S);u.insert(()=>N).attr("style",r)}return Mn(t,k),t.intersect=function(N){return Sn.rect(t,N)},u}ie(kne,"requirementBox");async function su(e,t,n,r=""){if(t==="")return 0;const s=e.insert("g").attr("class","label").attr("style",r),i=os(),a=i.htmlLabels??!0,o=await Jh(s,AD(eg(t)),{width:Kd(t,i)+50,classes:"markdown-node-label",useHtmlLabels:a,style:r},i);let l;if(a){const c=o.children[0],u=Kr(o);l=c.getBoundingClientRect(),u.attr("width",l.width),u.attr("height",l.height)}else{const c=o.children[0];for(const u of c.children)u.textContent=u.textContent.replaceAll("&gt;",">").replaceAll("&lt;","<"),r&&u.setAttribute("style",r);l=o.getBBox(),l.height+=6}return s.attr("transform",`translate(${-l.width/2},${-l.height/2+n})`),l.height}ie(su,"addText");var W8e=ie(e=>{switch(e){case"Very High":return"red";case"High":return"orange";case"Medium":return null;case"Low":return"blue";case"Very Low":return"lightblue"}},"colorFromPriority");async function Ene(e,t,{config:n}){var O,V;const{labelStyles:r,nodeStyles:s}=In(t);t.labelStyle=r||"";const i=10,a=t.width;t.width=(t.width??200)-10;const{shapeSvg:o,bbox:l,label:c}=await ur(e,t,tr(t)),u=t.padding||10;let d="",h;"ticket"in t&&t.ticket&&((O=n==null?void 0:n.kanban)!=null&&O.ticketBaseUrl)&&(d=(V=n==null?void 0:n.kanban)==null?void 0:V.ticketBaseUrl.replace("#TICKET#",t.ticket),h=o.insert("svg:a",":first-child").attr("class","kanban-ticket-link").attr("xlink:href",d).attr("target","_blank"));const m={useHtmlLabels:t.useHtmlLabels,labelStyle:t.labelStyle||"",width:t.width,img:t.img,padding:t.padding||8,centerLabel:!1};let y,b;h?{label:y,bbox:b}=await jI(h,"ticket"in t&&t.ticket||"",m):{label:y,bbox:b}=await jI(o,"ticket"in t&&t.ticket||"",m);const{label:v,bbox:x}=await jI(o,"assigned"in t&&t.assigned||"",m);t.width=a;const w=10,S=(t==null?void 0:t.width)||0,C=Math.max(b.height,x.height)/2,k=Math.max(l.height+w*2,(t==null?void 0:t.height)||0)+C,A=-S/2,R=-k/2;c.attr("transform","translate("+(u-S/2)+", "+(-C-l.height/2)+")"),y.attr("transform","translate("+(u-S/2)+", "+(-C+l.height/2)+")"),v.attr("transform","translate("+(u+S/2-x.width-2*i)+", "+(-C+l.height/2)+")");let N;const{rx:I,ry:P}=t,{cssStyles:L}=t;if(t.look==="handDrawn"){const D=kn.svg(o),Z=Tn(t,{}),U=I||P?D.path(sf(A,R,S,k,I||0),Z):D.rectangle(A,R,S,k,Z);N=o.insert(()=>U,":first-child"),N.attr("class","basic label-container").attr("style",L||null)}else{N=o.insert("rect",":first-child"),N.attr("class","basic label-container __APA__").attr("style",s).attr("rx",I??5).attr("ry",P??5).attr("x",A).attr("y",R).attr("width",S).attr("height",k);const D="priority"in t&&t.priority;if(D){const Z=o.append("line"),U=A+2,H=R+Math.floor((I??0)/2),$=R+k-Math.floor((I??0)/2);Z.attr("x1",U).attr("y1",H).attr("x2",U).attr("y2",$).attr("stroke-width","4").attr("stroke",W8e(D))}}return Mn(t,N),t.height=k,t.intersect=function(D){return Sn.rect(t,D)},o}ie(Ene,"kanbanItem");var H8e=[{semanticName:"Process",name:"Rectangle",shortName:"rect",description:"Standard process shape",aliases:["proc","process","rectangle"],internalAliases:["squareRect"],handler:one},{semanticName:"Event",name:"Rounded Rectangle",shortName:"rounded",description:"Represents an event",aliases:["event"],internalAliases:["roundedRect"],handler:sne},{semanticName:"Terminal Point",name:"Stadium",shortName:"stadium",description:"Terminal point",aliases:["terminal","pill"],handler:lne},{semanticName:"Subprocess",name:"Framed Rectangle",shortName:"fr-rect",description:"Subprocess",aliases:["subprocess","subproc","framed-rectangle","subroutine"],handler:fne},{semanticName:"Database",name:"Cylinder",shortName:"cyl",description:"Database storage",aliases:["db","database","cylinder"],handler:Mte},{semanticName:"Start",name:"Circle",shortName:"circle",description:"Starting point",aliases:["circ"],handler:Cte},{semanticName:"Decision",name:"Diamond",shortName:"diam",description:"Decision-making step",aliases:["decision","diamond","question"],handler:tne},{semanticName:"Prepare Conditional",name:"Hexagon",shortName:"hex",description:"Preparation or condition step",aliases:["hexagon","prepare"],handler:Lte},{semanticName:"Data Input/Output",name:"Lean Right",shortName:"lean-r",description:"Represents input or output",aliases:["lean-right","in-out"],internalAliases:["lean_right"],handler:Kte},{semanticName:"Data Input/Output",name:"Lean Left",shortName:"lean-l",description:"Represents output or input",aliases:["lean-left","out-in"],internalAliases:["lean_left"],handler:Gte},{semanticName:"Priority Action",name:"Trapezoid Base Bottom",shortName:"trap-b",description:"Priority action",aliases:["priority","trapezoid-bottom","trapezoid"],handler:yne},{semanticName:"Manual Operation",name:"Trapezoid Base Top",shortName:"trap-t",description:"Represents a manual task",aliases:["manual","trapezoid-top","inv-trapezoid"],internalAliases:["inv_trapezoid"],handler:Wte},{semanticName:"Stop",name:"Double Circle",shortName:"dbl-circ",description:"Represents a stop point",aliases:["double-circle"],internalAliases:["doublecircle"],handler:jte},{semanticName:"Text Block",name:"Text Block",shortName:"text",description:"Text block",handler:mne},{semanticName:"Card",name:"Notched Rectangle",shortName:"notch-rect",description:"Represents a card",aliases:["card","notched-rectangle"],handler:_te},{semanticName:"Lined/Shaded Process",name:"Lined Rectangle",shortName:"lin-rect",description:"Lined process shape",aliases:["lined-rectangle","lined-process","lin-proc","shaded-process"],handler:ine},{semanticName:"Start",name:"Small Circle",shortName:"sm-circ",description:"Small starting point",aliases:["start","small-circle"],internalAliases:["stateStart"],handler:dne},{semanticName:"Stop",name:"Framed Circle",shortName:"fr-circ",description:"Stop point",aliases:["stop","framed-circle"],internalAliases:["stateEnd"],handler:une},{semanticName:"Fork/Join",name:"Filled Rectangle",shortName:"fork",description:"Fork or join in process flow",aliases:["join"],internalAliases:["forkJoin"],handler:Dte},{semanticName:"Collate",name:"Hourglass",shortName:"hourglass",description:"Represents a collate operation",aliases:["hourglass","collate"],handler:Bte},{semanticName:"Comment",name:"Curly Brace",shortName:"brace",description:"Adds a comment",aliases:["comment","brace-l"],handler:Tte},{semanticName:"Comment Right",name:"Curly Brace",shortName:"brace-r",description:"Adds a comment",handler:Ate},{semanticName:"Comment with braces on both sides",name:"Curly Braces",shortName:"braces",description:"Adds a comment",handler:Rte},{semanticName:"Com Link",name:"Lightning Bolt",shortName:"bolt",description:"Communication link",aliases:["com-link","lightning-bolt"],handler:Yte},{semanticName:"Document",name:"Document",shortName:"doc",description:"Represents a document",aliases:["doc","document"],handler:xne},{semanticName:"Delay",name:"Half-Rounded Rectangle",shortName:"delay",description:"Represents a delay",aliases:["half-rounded-rectangle"],handler:Fte},{semanticName:"Direct Access Storage",name:"Horizontal Cylinder",shortName:"h-cyl",description:"Direct access storage",aliases:["das","horizontal-cylinder"],handler:gne},{semanticName:"Disk Storage",name:"Lined Cylinder",shortName:"lin-cyl",description:"Disk storage",aliases:["disk","lined-cylinder"],handler:Zte},{semanticName:"Display",name:"Curved Trapezoid",shortName:"curv-trap",description:"Represents a display",aliases:["curved-trapezoid","display"],handler:Nte},{semanticName:"Divided Process",name:"Divided Rectangle",shortName:"div-rect",description:"Divided process shape",aliases:["div-proc","divided-rectangle","divided-process"],handler:Ite},{semanticName:"Extract",name:"Triangle",shortName:"tri",description:"Extraction process",aliases:["extract","triangle"],handler:vne},{semanticName:"Internal Storage",name:"Window Pane",shortName:"win-pane",description:"Internal storage",aliases:["internal-storage","window-pane"],handler:_ne},{semanticName:"Junction",name:"Filled Circle",shortName:"f-circ",description:"Junction point",aliases:["junction","filled-circle"],handler:Pte},{semanticName:"Loop Limit",name:"Trapezoidal Pentagon",shortName:"notch-pent",description:"Loop limit step",aliases:["loop-limit","notched-pentagon"],handler:bne},{semanticName:"Manual File",name:"Flipped Triangle",shortName:"flip-tri",description:"Manual file operation",aliases:["manual-file","flipped-triangle"],handler:Ote},{semanticName:"Manual Input",name:"Sloped Rectangle",shortName:"sl-rect",description:"Manual input step",aliases:["manual-input","sloped-rectangle"],handler:ane},{semanticName:"Multi-Document",name:"Stacked Document",shortName:"docs",description:"Multiple documents",aliases:["documents","st-doc","stacked-document"],handler:Qte},{semanticName:"Multi-Process",name:"Stacked Rectangle",shortName:"st-rect",description:"Multiple processes",aliases:["procs","processes","stacked-rectangle"],handler:Jte},{semanticName:"Stored Data",name:"Bow Tie Rectangle",shortName:"bow-rect",description:"Stored data",aliases:["stored-data","bow-tie-rectangle"],handler:wte},{semanticName:"Summary",name:"Crossed Circle",shortName:"cross-circ",description:"Summary",aliases:["summary","crossed-circle"],handler:Ete},{semanticName:"Tagged Document",name:"Tagged Document",shortName:"tag-doc",description:"Tagged document",aliases:["tag-doc","tagged-document"],handler:pne},{semanticName:"Tagged Process",name:"Tagged Rectangle",shortName:"tag-rect",description:"Tagged process",aliases:["tagged-rectangle","tag-proc","tagged-process"],handler:hne},{semanticName:"Paper Tape",name:"Flag",shortName:"flag",description:"Paper tape",aliases:["paper-tape"],handler:wne},{semanticName:"Odd",name:"Odd",shortName:"odd",description:"Odd shape",internalAliases:["rect_left_inv_arrow"],handler:nne},{semanticName:"Lined Document",name:"Lined Document",shortName:"lin-doc",description:"Lined document",aliases:["lined-document"],handler:Xte}],G8e=ie(()=>{const t=[...Object.entries({state:cne,choice:Ste,note:ene,rectWithTitle:rne,labelRect:Hte,iconSquare:qte,iconCircle:zte,icon:$te,iconRounded:Ute,imageSquare:Vte,anchor:xte,kanbanItem:Ene,classBox:Cne,erBox:b6,requirementBox:kne}),...H8e.flatMap(n=>[n.shortName,..."aliases"in n?n.aliases:[],..."internalAliases"in n?n.internalAliases:[]].map(s=>[s,n.handler]))];return Object.fromEntries(t)},"generateShapeMap"),Tne=G8e();function K8e(e){return e in Tne}ie(K8e,"isValidShape");var jT=new Map;async function Ane(e,t,n){let r,s;t.shape==="rect"&&(t.rx&&t.ry?t.shape="roundedRect":t.shape="squareRect");const i=t.shape?Tne[t.shape]:void 0;if(!i)throw new Error(`No such shape: ${t.shape}. Please check your syntax.`);if(t.link){let a;n.config.securityLevel==="sandbox"?a="_top":t.linkTarget&&(a=t.linkTarget||"_blank"),r=e.insert("svg:a").attr("xlink:href",t.link).attr("target",a??null),s=await i(r,t,n)}else s=await i(e,t,n),r=s;return t.tooltip&&s.attr("title",t.tooltip),jT.set(t.id,r),t.haveCallback&&r.attr("class",r.attr("class")+" clickable"),r}ie(Ane,"insertNode");var udt=ie((e,t)=>{jT.set(t.id,e)},"setNodeElem"),ddt=ie(()=>{jT.clear()},"clear"),fdt=ie(e=>{const t=jT.get(e.id);zt.trace("Transforming node",e.diff,e,"translate("+(e.x-e.width/2-5)+", "+e.width/2+")");const n=8,r=e.diff||0;return e.clusterNode?t.attr("transform","translate("+(e.x+r-e.width/2)+", "+(e.y-e.height/2-n)+")"):t.attr("transform","translate("+e.x+", "+e.y+")"),r},"positionNode"),Y8e=ie((e,t,n,r,s,i)=>{t.arrowTypeStart&&yU(e,"start",t.arrowTypeStart,n,r,s,i),t.arrowTypeEnd&&yU(e,"end",t.arrowTypeEnd,n,r,s,i)},"addEdgeMarkers"),Z8e={arrow_cross:{type:"cross",fill:!1},arrow_point:{type:"point",fill:!0},arrow_barb:{type:"barb",fill:!0},arrow_circle:{type:"circle",fill:!1},aggregation:{type:"aggregation",fill:!1},extension:{type:"extension",fill:!1},composition:{type:"composition",fill:!0},dependency:{type:"dependency",fill:!0},lollipop:{type:"lollipop",fill:!1},only_one:{type:"onlyOne",fill:!1},zero_or_one:{type:"zeroOrOne",fill:!1},one_or_more:{type:"oneOrMore",fill:!1},zero_or_more:{type:"zeroOrMore",fill:!1},requirement_arrow:{type:"requirement_arrow",fill:!1},requirement_contains:{type:"requirement_contains",fill:!1}},yU=ie((e,t,n,r,s,i,a)=>{var d;const o=Z8e[n];if(!o){zt.warn(`Unknown arrow type: ${n}`);return}const l=o.type,u=`${s}_${i}-${l}${t==="start"?"Start":"End"}`;if(a&&a.trim()!==""){const h=a.replace(/[^\dA-Za-z]/g,"_"),m=`${u}_${h}`;if(!document.getElementById(m)){const y=document.getElementById(u);if(y){const b=y.cloneNode(!0);b.id=m,b.querySelectorAll("path, circle, line").forEach(x=>{x.setAttribute("stroke",a),o.fill&&x.setAttribute("fill",a)}),(d=y.parentNode)==null||d.appendChild(b)}}e.attr(`marker-${t}`,`url(${r}#${m})`)}else e.attr(`marker-${t}`,`url(${r}#${u})`)},"addEdgeMarker"),Dk=new Map,ya=new Map,hdt=ie(()=>{Dk.clear(),ya.clear()},"clear"),Wv=ie(e=>e?e.reduce((n,r)=>n+";"+r,""):"","getLabelStyles"),X8e=ie(async(e,t)=>{let n=Wi(os().flowchart.htmlLabels);const r=await Jh(e,t.label,{style:Wv(t.labelStyle),useHtmlLabels:n,addSvgBackground:!0,isNode:!1});zt.info("abc82",t,t.labelType);const s=e.insert("g").attr("class","edgeLabel"),i=s.insert("g").attr("class","label");i.node().appendChild(r);let a=r.getBBox();if(n){const l=r.children[0],c=Kr(r);a=l.getBoundingClientRect(),c.attr("width",a.width),c.attr("height",a.height)}i.attr("transform","translate("+-a.width/2+", "+-a.height/2+")"),Dk.set(t.id,s),t.width=a.width,t.height=a.height;let o;if(t.startLabelLeft){const l=await sm(t.startLabelLeft,Wv(t.labelStyle)),c=e.insert("g").attr("class","edgeTerminals"),u=c.insert("g").attr("class","inner");o=u.node().appendChild(l);const d=l.getBBox();u.attr("transform","translate("+-d.width/2+", "+-d.height/2+")"),ya.get(t.id)||ya.set(t.id,{}),ya.get(t.id).startLeft=c,rx(o,t.startLabelLeft)}if(t.startLabelRight){const l=await sm(t.startLabelRight,Wv(t.labelStyle)),c=e.insert("g").attr("class","edgeTerminals"),u=c.insert("g").attr("class","inner");o=c.node().appendChild(l),u.node().appendChild(l);const d=l.getBBox();u.attr("transform","translate("+-d.width/2+", "+-d.height/2+")"),ya.get(t.id)||ya.set(t.id,{}),ya.get(t.id).startRight=c,rx(o,t.startLabelRight)}if(t.endLabelLeft){const l=await sm(t.endLabelLeft,Wv(t.labelStyle)),c=e.insert("g").attr("class","edgeTerminals"),u=c.insert("g").attr("class","inner");o=u.node().appendChild(l);const d=l.getBBox();u.attr("transform","translate("+-d.width/2+", "+-d.height/2+")"),c.node().appendChild(l),ya.get(t.id)||ya.set(t.id,{}),ya.get(t.id).endLeft=c,rx(o,t.endLabelLeft)}if(t.endLabelRight){const l=await sm(t.endLabelRight,Wv(t.labelStyle)),c=e.insert("g").attr("class","edgeTerminals"),u=c.insert("g").attr("class","inner");o=u.node().appendChild(l);const d=l.getBBox();u.attr("transform","translate("+-d.width/2+", "+-d.height/2+")"),c.node().appendChild(l),ya.get(t.id)||ya.set(t.id,{}),ya.get(t.id).endRight=c,rx(o,t.endLabelRight)}return r},"insertEdgeLabel");function rx(e,t){os().flowchart.htmlLabels&&e&&(e.style.width=t.length*9+"px",e.style.height="12px")}ie(rx,"setTerminalWidth");var J8e=ie((e,t)=>{zt.debug("Moving label abc88 ",e.id,e.label,Dk.get(e.id),t);let n=t.updatedPath?t.updatedPath:t.originalPath;const r=os(),{subGraphTitleTotalMargin:s}=DD(r);if(e.label){const i=Dk.get(e.id);let a=e.x,o=e.y;if(n){const l=pu.calcLabelPosition(n);zt.debug("Moving label "+e.label+" from (",a,",",o,") to (",l.x,",",l.y,") abc88"),t.updatedPath&&(a=l.x,o=l.y)}i.attr("transform",`translate(${a}, ${o+s/2})`)}if(e.startLabelLeft){const i=ya.get(e.id).startLeft;let a=e.x,o=e.y;if(n){const l=pu.calcTerminalLabelPosition(e.arrowTypeStart?10:0,"start_left",n);a=l.x,o=l.y}i.attr("transform",`translate(${a}, ${o})`)}if(e.startLabelRight){const i=ya.get(e.id).startRight;let a=e.x,o=e.y;if(n){const l=pu.calcTerminalLabelPosition(e.arrowTypeStart?10:0,"start_right",n);a=l.x,o=l.y}i.attr("transform",`translate(${a}, ${o})`)}if(e.endLabelLeft){const i=ya.get(e.id).endLeft;let a=e.x,o=e.y;if(n){const l=pu.calcTerminalLabelPosition(e.arrowTypeEnd?10:0,"end_left",n);a=l.x,o=l.y}i.attr("transform",`translate(${a}, ${o})`)}if(e.endLabelRight){const i=ya.get(e.id).endRight;let a=e.x,o=e.y;if(n){const l=pu.calcTerminalLabelPosition(e.arrowTypeEnd?10:0,"end_right",n);a=l.x,o=l.y}i.attr("transform",`translate(${a}, ${o})`)}},"positionEdgeLabel"),Q8e=ie((e,t)=>{const n=e.x,r=e.y,s=Math.abs(t.x-n),i=Math.abs(t.y-r),a=e.width/2,o=e.height/2;return s>=a||i>=o},"outsideNode"),eLe=ie((e,t,n)=>{zt.debug(`intersection calc abc89:
  outsidePoint: ${JSON.stringify(t)}
  insidePoint : ${JSON.stringify(n)}
  node        : x:${e.x} y:${e.y} w:${e.width} h:${e.height}`);const r=e.x,s=e.y,i=Math.abs(r-n.x),a=e.width/2;let o=n.x<t.x?a-i:a+i;const l=e.height/2,c=Math.abs(t.y-n.y),u=Math.abs(t.x-n.x);if(Math.abs(s-t.y)*a>Math.abs(r-t.x)*l){let d=n.y<t.y?t.y-l-s:s-l-t.y;o=u*d/c;const h={x:n.x<t.x?n.x+o:n.x-u+o,y:n.y<t.y?n.y+c-d:n.y-c+d};return o===0&&(h.x=t.x,h.y=t.y),u===0&&(h.x=t.x),c===0&&(h.y=t.y),zt.debug(`abc89 top/bottom calc, Q ${c}, q ${d}, R ${u}, r ${o}`,h),h}else{n.x<t.x?o=t.x-a-r:o=r-a-t.x;let d=c*o/u,h=n.x<t.x?n.x+u-o:n.x-u+o,m=n.y<t.y?n.y+d:n.y-d;return zt.debug(`sides calc abc89, Q ${c}, q ${d}, R ${u}, r ${o}`,{_x:h,_y:m}),o===0&&(h=t.x,m=t.y),u===0&&(h=t.x),c===0&&(m=t.y),{x:h,y:m}}},"intersection"),bU=ie((e,t)=>{zt.warn("abc88 cutPathAtIntersect",e,t);let n=[],r=e[0],s=!1;return e.forEach(i=>{if(zt.info("abc88 checking point",i,t),!Q8e(t,i)&&!s){const a=eLe(t,r,i);zt.debug("abc88 inside",i,r,a),zt.debug("abc88 intersection",a,t);let o=!1;n.forEach(l=>{o=o||l.x===a.x&&l.y===a.y}),n.some(l=>l.x===a.x&&l.y===a.y)?zt.warn("abc88 no intersect",a,n):n.push(a),s=!0}else zt.warn("abc88 outside",i,r),r=i,s||n.push(i)}),zt.debug("returning points",n),n},"cutPathAtIntersect");function Rne(e){const t=[],n=[];for(let r=1;r<e.length-1;r++){const s=e[r-1],i=e[r],a=e[r+1];(s.x===i.x&&i.y===a.y&&Math.abs(i.x-a.x)>5&&Math.abs(i.y-s.y)>5||s.y===i.y&&i.x===a.x&&Math.abs(i.x-s.x)>5&&Math.abs(i.y-a.y)>5)&&(t.push(i),n.push(r))}return{cornerPoints:t,cornerPointPositions:n}}ie(Rne,"extractCornerPoints");var vU=ie(function(e,t,n){const r=t.x-e.x,s=t.y-e.y,i=Math.sqrt(r*r+s*s),a=n/i;return{x:t.x-a*r,y:t.y-a*s}},"findAdjacentPoint"),tLe=ie(function(e){const{cornerPointPositions:t}=Rne(e),n=[];for(let r=0;r<e.length;r++)if(t.includes(r)){const s=e[r-1],i=e[r+1],a=e[r],o=vU(s,a,5),l=vU(i,a,5),c=l.x-o.x,u=l.y-o.y;n.push(o);const d=Math.sqrt(2)*2;let h={x:a.x,y:a.y};if(Math.abs(i.x-s.x)>10&&Math.abs(i.y-s.y)>=10){zt.debug("Corner point fixing",Math.abs(i.x-s.x),Math.abs(i.y-s.y));const m=5;a.x===o.x?h={x:c<0?o.x-m+d:o.x+m-d,y:u<0?o.y-d:o.y+d}:h={x:c<0?o.x-d:o.x+d,y:u<0?o.y-m+d:o.y+m-d}}else zt.debug("Corner point skipping fixing",Math.abs(i.x-s.x),Math.abs(i.y-s.y));n.push(h,l)}else n.push(e[r]);return n},"fixCorners"),nLe=ie(function(e,t,n,r,s,i,a){var I;const{handDrawnSeed:o}=os();let l=t.points,c=!1;const u=s;var d=i;const h=[];for(const P in t.cssCompiledStyles)dte(P)||h.push(t.cssCompiledStyles[P]);d.intersect&&u.intersect&&(l=l.slice(1,t.points.length-1),l.unshift(u.intersect(l[0])),zt.debug("Last point APA12",t.start,"-->",t.end,l[l.length-1],d,d.intersect(l[l.length-1])),l.push(d.intersect(l[l.length-1]))),t.toCluster&&(zt.info("to cluster abc88",n.get(t.toCluster)),l=bU(t.points,n.get(t.toCluster).node),c=!0),t.fromCluster&&(zt.debug("from cluster abc88",n.get(t.fromCluster),JSON.stringify(l,null,2)),l=bU(l.reverse(),n.get(t.fromCluster).node).reverse(),c=!0);let m=l.filter(P=>!Number.isNaN(P.y));m=tLe(m);let y=B2;switch(y=xk,t.curve){case"linear":y=xk;break;case"basis":y=B2;break;case"cardinal":y=JQ;break;case"bumpX":y=GQ;break;case"bumpY":y=KQ;break;case"catmullRom":y=eee;break;case"monotoneX":y=aee;break;case"monotoneY":y=oee;break;case"natural":y=cee;break;case"step":y=uee;break;case"stepAfter":y=fee;break;case"stepBefore":y=dee;break;default:y=B2}const{x:b,y:v}=kje(t),x=vDe().x(b).y(v).curve(y);let w;switch(t.thickness){case"normal":w="edge-thickness-normal";break;case"thick":w="edge-thickness-thick";break;case"invisible":w="edge-thickness-invisible";break;default:w="edge-thickness-normal"}switch(t.pattern){case"solid":w+=" edge-pattern-solid";break;case"dotted":w+=" edge-pattern-dotted";break;case"dashed":w+=" edge-pattern-dashed";break;default:w+=" edge-pattern-solid"}let S,C=x(m);const k=Array.isArray(t.style)?t.style:[t.style];let A=k.find(P=>P==null?void 0:P.startsWith("stroke:"));if(t.look==="handDrawn"){const P=kn.svg(e);Object.assign([],m);const L=P.path(C,{roughness:.3,seed:o});w+=" transition",S=Kr(L).select("path").attr("id",t.id).attr("class"," "+w+(t.classes?" "+t.classes:"")).attr("style",k?k.reduce((V,D)=>V+";"+D,""):"");let O=S.attr("d");S.attr("d",O),e.node().appendChild(S.node())}else{const P=h.join(";"),L=k?k.reduce((D,Z)=>D+Z+";",""):"";let O="";t.animate&&(O=" edge-animation-fast"),t.animation&&(O=" edge-animation-"+t.animation);const V=P?P+";"+L+";":L;S=e.append("path").attr("d",C).attr("id",t.id).attr("class"," "+w+(t.classes?" "+t.classes:"")+(O??"")).attr("style",V),A=(I=V.match(/stroke:([^;]+)/))==null?void 0:I[1]}let R="";(os().flowchart.arrowMarkerAbsolute||os().state.arrowMarkerAbsolute)&&(R=window.location.protocol+"//"+window.location.host+window.location.pathname+window.location.search,R=R.replace(/\(/g,"\\(").replace(/\)/g,"\\)")),zt.info("arrowTypeStart",t.arrowTypeStart),zt.info("arrowTypeEnd",t.arrowTypeEnd),Y8e(S,t,R,a,r,A);let N={};return c&&(N.updatedPath=l),N.originalPath=t.points,N},"insertEdge"),rLe=ie((e,t,n,r)=>{t.forEach(s=>{vLe[s](e,n,r)})},"insertMarkers"),sLe=ie((e,t,n)=>{zt.trace("Making markers for ",n),e.append("defs").append("marker").attr("id",n+"_"+t+"-extensionStart").attr("class","marker extension "+t).attr("refX",18).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 1,7 L18,13 V 1 Z"),e.append("defs").append("marker").attr("id",n+"_"+t+"-extensionEnd").attr("class","marker extension "+t).attr("refX",1).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 1,1 V 13 L18,7 Z")},"extension"),iLe=ie((e,t,n)=>{e.append("defs").append("marker").attr("id",n+"_"+t+"-compositionStart").attr("class","marker composition "+t).attr("refX",18).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z"),e.append("defs").append("marker").attr("id",n+"_"+t+"-compositionEnd").attr("class","marker composition "+t).attr("refX",1).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z")},"composition"),aLe=ie((e,t,n)=>{e.append("defs").append("marker").attr("id",n+"_"+t+"-aggregationStart").attr("class","marker aggregation "+t).attr("refX",18).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z"),e.append("defs").append("marker").attr("id",n+"_"+t+"-aggregationEnd").attr("class","marker aggregation "+t).attr("refX",1).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z")},"aggregation"),oLe=ie((e,t,n)=>{e.append("defs").append("marker").attr("id",n+"_"+t+"-dependencyStart").attr("class","marker dependency "+t).attr("refX",6).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 5,7 L9,13 L1,7 L9,1 Z"),e.append("defs").append("marker").attr("id",n+"_"+t+"-dependencyEnd").attr("class","marker dependency "+t).attr("refX",13).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L14,7 L9,1 Z")},"dependency"),lLe=ie((e,t,n)=>{e.append("defs").append("marker").attr("id",n+"_"+t+"-lollipopStart").attr("class","marker lollipop "+t).attr("refX",13).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("circle").attr("stroke","black").attr("fill","transparent").attr("cx",7).attr("cy",7).attr("r",6),e.append("defs").append("marker").attr("id",n+"_"+t+"-lollipopEnd").attr("class","marker lollipop "+t).attr("refX",1).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("circle").attr("stroke","black").attr("fill","transparent").attr("cx",7).attr("cy",7).attr("r",6)},"lollipop"),cLe=ie((e,t,n)=>{e.append("marker").attr("id",n+"_"+t+"-pointEnd").attr("class","marker "+t).attr("viewBox","0 0 10 10").attr("refX",5).attr("refY",5).attr("markerUnits","userSpaceOnUse").attr("markerWidth",8).attr("markerHeight",8).attr("orient","auto").append("path").attr("d","M 0 0 L 10 5 L 0 10 z").attr("class","arrowMarkerPath").style("stroke-width",1).style("stroke-dasharray","1,0"),e.append("marker").attr("id",n+"_"+t+"-pointStart").attr("class","marker "+t).attr("viewBox","0 0 10 10").attr("refX",4.5).attr("refY",5).attr("markerUnits","userSpaceOnUse").attr("markerWidth",8).attr("markerHeight",8).attr("orient","auto").append("path").attr("d","M 0 5 L 10 10 L 10 0 z").attr("class","arrowMarkerPath").style("stroke-width",1).style("stroke-dasharray","1,0")},"point"),uLe=ie((e,t,n)=>{e.append("marker").attr("id",n+"_"+t+"-circleEnd").attr("class","marker "+t).attr("viewBox","0 0 10 10").attr("refX",11).attr("refY",5).attr("markerUnits","userSpaceOnUse").attr("markerWidth",11).attr("markerHeight",11).attr("orient","auto").append("circle").attr("cx","5").attr("cy","5").attr("r","5").attr("class","arrowMarkerPath").style("stroke-width",1).style("stroke-dasharray","1,0"),e.append("marker").attr("id",n+"_"+t+"-circleStart").attr("class","marker "+t).attr("viewBox","0 0 10 10").attr("refX",-1).attr("refY",5).attr("markerUnits","userSpaceOnUse").attr("markerWidth",11).attr("markerHeight",11).attr("orient","auto").append("circle").attr("cx","5").attr("cy","5").attr("r","5").attr("class","arrowMarkerPath").style("stroke-width",1).style("stroke-dasharray","1,0")},"circle"),dLe=ie((e,t,n)=>{e.append("marker").attr("id",n+"_"+t+"-crossEnd").attr("class","marker cross "+t).attr("viewBox","0 0 11 11").attr("refX",12).attr("refY",5.2).attr("markerUnits","userSpaceOnUse").attr("markerWidth",11).attr("markerHeight",11).attr("orient","auto").append("path").attr("d","M 1,1 l 9,9 M 10,1 l -9,9").attr("class","arrowMarkerPath").style("stroke-width",2).style("stroke-dasharray","1,0"),e.append("marker").attr("id",n+"_"+t+"-crossStart").attr("class","marker cross "+t).attr("viewBox","0 0 11 11").attr("refX",-1).attr("refY",5.2).attr("markerUnits","userSpaceOnUse").attr("markerWidth",11).attr("markerHeight",11).attr("orient","auto").append("path").attr("d","M 1,1 l 9,9 M 10,1 l -9,9").attr("class","arrowMarkerPath").style("stroke-width",2).style("stroke-dasharray","1,0")},"cross"),fLe=ie((e,t,n)=>{e.append("defs").append("marker").attr("id",n+"_"+t+"-barbEnd").attr("refX",19).attr("refY",7).attr("markerWidth",20).attr("markerHeight",14).attr("markerUnits","userSpaceOnUse").attr("orient","auto").append("path").attr("d","M 19,7 L9,13 L14,7 L9,1 Z")},"barb"),hLe=ie((e,t,n)=>{e.append("defs").append("marker").attr("id",n+"_"+t+"-onlyOneStart").attr("class","marker onlyOne "+t).attr("refX",0).attr("refY",9).attr("markerWidth",18).attr("markerHeight",18).attr("orient","auto").append("path").attr("d","M9,0 L9,18 M15,0 L15,18"),e.append("defs").append("marker").attr("id",n+"_"+t+"-onlyOneEnd").attr("class","marker onlyOne "+t).attr("refX",18).attr("refY",9).attr("markerWidth",18).attr("markerHeight",18).attr("orient","auto").append("path").attr("d","M3,0 L3,18 M9,0 L9,18")},"only_one"),pLe=ie((e,t,n)=>{const r=e.append("defs").append("marker").attr("id",n+"_"+t+"-zeroOrOneStart").attr("class","marker zeroOrOne "+t).attr("refX",0).attr("refY",9).attr("markerWidth",30).attr("markerHeight",18).attr("orient","auto");r.append("circle").attr("fill","white").attr("cx",21).attr("cy",9).attr("r",6),r.append("path").attr("d","M9,0 L9,18");const s=e.append("defs").append("marker").attr("id",n+"_"+t+"-zeroOrOneEnd").attr("class","marker zeroOrOne "+t).attr("refX",30).attr("refY",9).attr("markerWidth",30).attr("markerHeight",18).attr("orient","auto");s.append("circle").attr("fill","white").attr("cx",9).attr("cy",9).attr("r",6),s.append("path").attr("d","M21,0 L21,18")},"zero_or_one"),mLe=ie((e,t,n)=>{e.append("defs").append("marker").attr("id",n+"_"+t+"-oneOrMoreStart").attr("class","marker oneOrMore "+t).attr("refX",18).attr("refY",18).attr("markerWidth",45).attr("markerHeight",36).attr("orient","auto").append("path").attr("d","M0,18 Q 18,0 36,18 Q 18,36 0,18 M42,9 L42,27"),e.append("defs").append("marker").attr("id",n+"_"+t+"-oneOrMoreEnd").attr("class","marker oneOrMore "+t).attr("refX",27).attr("refY",18).attr("markerWidth",45).attr("markerHeight",36).attr("orient","auto").append("path").attr("d","M3,9 L3,27 M9,18 Q27,0 45,18 Q27,36 9,18")},"one_or_more"),gLe=ie((e,t,n)=>{const r=e.append("defs").append("marker").attr("id",n+"_"+t+"-zeroOrMoreStart").attr("class","marker zeroOrMore "+t).attr("refX",18).attr("refY",18).attr("markerWidth",57).attr("markerHeight",36).attr("orient","auto");r.append("circle").attr("fill","white").attr("cx",48).attr("cy",18).attr("r",6),r.append("path").attr("d","M0,18 Q18,0 36,18 Q18,36 0,18");const s=e.append("defs").append("marker").attr("id",n+"_"+t+"-zeroOrMoreEnd").attr("class","marker zeroOrMore "+t).attr("refX",39).attr("refY",18).attr("markerWidth",57).attr("markerHeight",36).attr("orient","auto");s.append("circle").attr("fill","white").attr("cx",9).attr("cy",18).attr("r",6),s.append("path").attr("d","M21,18 Q39,0 57,18 Q39,36 21,18")},"zero_or_more"),yLe=ie((e,t,n)=>{e.append("defs").append("marker").attr("id",n+"_"+t+"-requirement_arrowEnd").attr("refX",20).attr("refY",10).attr("markerWidth",20).attr("markerHeight",20).attr("orient","auto").append("path").attr("d",`M0,0
      L20,10
      M20,10
      L0,20`)},"requirement_arrow"),bLe=ie((e,t,n)=>{const r=e.append("defs").append("marker").attr("id",n+"_"+t+"-requirement_containsStart").attr("refX",0).attr("refY",10).attr("markerWidth",20).attr("markerHeight",20).attr("orient","auto").append("g");r.append("circle").attr("cx",10).attr("cy",10).attr("r",9).attr("fill","none"),r.append("line").attr("x1",1).attr("x2",19).attr("y1",10).attr("y2",10),r.append("line").attr("y1",1).attr("y2",19).attr("x1",10).attr("x2",10)},"requirement_contains"),vLe={extension:sLe,composition:iLe,aggregation:aLe,dependency:oLe,lollipop:lLe,point:cLe,circle:uLe,cross:dLe,barb:fLe,only_one:hLe,zero_or_one:pLe,one_or_more:mLe,zero_or_more:gLe,requirement_arrow:yLe,requirement_contains:bLe},xLe=rLe,wLe={common:rb,getConfig:Mo,insertCluster:R8e,insertEdge:nLe,insertEdgeLabel:X8e,insertMarkers:xLe,insertNode:Ane,interpolateToCurve:QD,labelHelper:ur,log:zt,positionEdgeLabel:J8e},Mw={},Nne=ie(e=>{for(const t of e)Mw[t.name]=t},"registerLayoutLoaders"),_Le=ie(()=>{Nne([{name:"dagre",loader:ie(async()=>await Zr(()=>import("./dagre-OKDRZEBW-DBOB1uUV.js"),__vite__mapDeps([0,1,2,3,4,5])),"loader")}])},"registerDefaultLayoutLoaders");_Le();var pdt=ie(async(e,t)=>{if(!(e.layoutAlgorithm in Mw))throw new Error(`Unknown layout algorithm: ${e.layoutAlgorithm}`);const n=Mw[e.layoutAlgorithm];return(await n.loader()).render(e,t,wLe,{algorithm:n.algorithm})},"render"),mdt=ie((e="",{fallback:t="dagre"}={})=>{if(e in Mw)return e;if(t in Mw)return zt.warn(`Layout algorithm ${e} is not registered. Using ${t} as fallback.`),t;throw new Error(`Both layout algorithms ${e} and ${t} are not registered.`)},"getRegisteredLayoutAlgorithm"),xU={name:"mermaid",version:"11.6.0",description:"Markdown-ish syntax for generating flowcharts, mindmaps, sequence diagrams, class diagrams, gantt charts, git graphs and more.",type:"module",module:"./dist/mermaid.core.mjs",types:"./dist/mermaid.d.ts",exports:{".":{types:"./dist/mermaid.d.ts",import:"./dist/mermaid.core.mjs",default:"./dist/mermaid.core.mjs"},"./*":"./*"},keywords:["diagram","markdown","flowchart","sequence diagram","gantt","class diagram","git graph","mindmap","packet diagram","c4 diagram","er diagram","pie chart","pie diagram","quadrant chart","requirement diagram","graph"],scripts:{clean:"rimraf dist",dev:"pnpm -w dev","docs:code":"typedoc src/defaultConfig.ts src/config.ts src/mermaid.ts && prettier --write ./src/docs/config/setup","docs:build":"rimraf ../../docs && pnpm docs:code && pnpm docs:spellcheck && tsx scripts/docs.cli.mts","docs:verify":"pnpm docs:code && pnpm docs:spellcheck && tsx scripts/docs.cli.mts --verify","docs:pre:vitepress":"pnpm --filter ./src/docs prefetch && rimraf src/vitepress && pnpm docs:code && tsx scripts/docs.cli.mts --vitepress && pnpm --filter ./src/vitepress install --no-frozen-lockfile --ignore-scripts","docs:build:vitepress":"pnpm docs:pre:vitepress && (cd src/vitepress && pnpm run build) && cpy --flat src/docs/landing/ ./src/vitepress/.vitepress/dist/landing","docs:dev":'pnpm docs:pre:vitepress && concurrently "pnpm --filter ./src/vitepress dev" "tsx scripts/docs.cli.mts --watch --vitepress"',"docs:dev:docker":'pnpm docs:pre:vitepress && concurrently "pnpm --filter ./src/vitepress dev:docker" "tsx scripts/docs.cli.mts --watch --vitepress"',"docs:serve":"pnpm docs:build:vitepress && vitepress serve src/vitepress","docs:spellcheck":'cspell "src/docs/**/*.md"',"docs:release-version":"tsx scripts/update-release-version.mts","docs:verify-version":"tsx scripts/update-release-version.mts --verify","types:build-config":"tsx scripts/create-types-from-json-schema.mts","types:verify-config":"tsx scripts/create-types-from-json-schema.mts --verify",checkCircle:"npx madge --circular ./src",prepublishOnly:"pnpm docs:verify-version"},repository:{type:"git",url:"https://github.com/mermaid-js/mermaid"},author:"Knut Sveidqvist",license:"MIT",standard:{ignore:["**/parser/*.js","dist/**/*.js","cypress/**/*.js"],globals:["page"]},dependencies:{"@braintree/sanitize-url":"^7.0.4","@iconify/utils":"^2.1.33","@mermaid-js/parser":"workspace:^","@types/d3":"^7.4.3",cytoscape:"^3.29.3","cytoscape-cose-bilkent":"^4.1.0","cytoscape-fcose":"^2.2.0",d3:"^7.9.0","d3-sankey":"^0.12.3","dagre-d3-es":"7.0.11",dayjs:"^1.11.13",dompurify:"^3.2.4",katex:"^0.16.9",khroma:"^2.1.0","lodash-es":"^4.17.21",marked:"^15.0.7",roughjs:"^4.6.6",stylis:"^4.3.6","ts-dedent":"^2.2.0",uuid:"^11.1.0"},devDependencies:{"@adobe/jsonschema2md":"^8.0.2","@iconify/types":"^2.0.0","@types/cytoscape":"^3.21.9","@types/cytoscape-fcose":"^2.2.4","@types/d3-sankey":"^0.12.4","@types/d3-scale":"^4.0.9","@types/d3-scale-chromatic":"^3.1.0","@types/d3-selection":"^3.0.11","@types/d3-shape":"^3.1.7","@types/jsdom":"^21.1.7","@types/katex":"^0.16.7","@types/lodash-es":"^4.17.12","@types/micromatch":"^4.0.9","@types/stylis":"^4.2.7","@types/uuid":"^10.0.0",ajv:"^8.17.1",chokidar:"^4.0.3",concurrently:"^9.1.2","csstree-validator":"^4.0.1",globby:"^14.0.2",jison:"^0.4.18","js-base64":"^3.7.7",jsdom:"^26.0.0","json-schema-to-typescript":"^15.0.4",micromatch:"^4.0.8","path-browserify":"^1.0.1",prettier:"^3.5.2",remark:"^15.0.1","remark-frontmatter":"^5.0.0","remark-gfm":"^4.0.1",rimraf:"^6.0.1","start-server-and-test":"^2.0.10","type-fest":"^4.35.0",typedoc:"^0.27.8","typedoc-plugin-markdown":"^4.4.2",typescript:"~5.7.3","unist-util-flatmap":"^1.0.0","unist-util-visit":"^5.0.0",vitepress:"^1.0.2","vitepress-plugin-search":"1.0.4-alpha.22"},files:["dist/","README.md"],publishConfig:{access:"public"}},SLe=ie(e=>{var s;const{securityLevel:t}=os();let n=Kr("body");if(t==="sandbox"){const a=((s=Kr(`#i${e}`).node())==null?void 0:s.contentDocument)??document;n=Kr(a.body)}return n.select(`#${e}`)},"selectSvgElement"),Mne="comm",Ine="rule",jne="decl",CLe="@import",kLe="@namespace",ELe="@keyframes",TLe="@layer",Pne=Math.abs,v6=String.fromCharCode;function One(e){return e.trim()}function q2(e,t,n){return e.replace(t,n)}function ALe(e,t,n){return e.indexOf(t,n)}function j0(e,t){return e.charCodeAt(t)|0}function Ey(e,t,n){return e.slice(t,n)}function uu(e){return e.length}function RLe(e){return e.length}function JS(e,t){return t.push(e),e}var PT=1,Ty=1,Dne=0,Zl=0,Ri=0,lb="";function x6(e,t,n,r,s,i,a,o){return{value:e,root:t,parent:n,type:r,props:s,children:i,line:PT,column:Ty,length:a,return:"",siblings:o}}function NLe(){return Ri}function MLe(){return Ri=Zl>0?j0(lb,--Zl):0,Ty--,Ri===10&&(Ty=1,PT--),Ri}function Ac(){return Ri=Zl<Dne?j0(lb,Zl++):0,Ty++,Ri===10&&(Ty=1,PT++),Ri}function uh(){return j0(lb,Zl)}function V2(){return Zl}function OT(e,t){return Ey(lb,e,t)}function Iw(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function ILe(e){return PT=Ty=1,Dne=uu(lb=e),Zl=0,[]}function jLe(e){return lb="",e}function PI(e){return One(OT(Zl-1,_4(e===91?e+2:e===40?e+1:e)))}function PLe(e){for(;(Ri=uh())&&Ri<33;)Ac();return Iw(e)>2||Iw(Ri)>3?"":" "}function OLe(e,t){for(;--t&&Ac()&&!(Ri<48||Ri>102||Ri>57&&Ri<65||Ri>70&&Ri<97););return OT(e,V2()+(t<6&&uh()==32&&Ac()==32))}function _4(e){for(;Ac();)switch(Ri){case e:return Zl;case 34:case 39:e!==34&&e!==39&&_4(Ri);break;case 40:e===41&&_4(e);break;case 92:Ac();break}return Zl}function DLe(e,t){for(;Ac()&&e+Ri!==57;)if(e+Ri===84&&uh()===47)break;return"/*"+OT(t,Zl-1)+"*"+v6(e===47?e:Ac())}function FLe(e){for(;!Iw(uh());)Ac();return OT(e,Zl)}function LLe(e){return jLe(W2("",null,null,null,[""],e=ILe(e),0,[0],e))}function W2(e,t,n,r,s,i,a,o,l){for(var c=0,u=0,d=a,h=0,m=0,y=0,b=1,v=1,x=1,w=0,S="",C=s,k=i,A=r,R=S;v;)switch(y=w,w=Ac()){case 40:if(y!=108&&j0(R,d-1)==58){ALe(R+=q2(PI(w),"&","&\f"),"&\f",Pne(c?o[c-1]:0))!=-1&&(x=-1);break}case 34:case 39:case 91:R+=PI(w);break;case 9:case 10:case 13:case 32:R+=PLe(y);break;case 92:R+=OLe(V2()-1,7);continue;case 47:switch(uh()){case 42:case 47:JS(BLe(DLe(Ac(),V2()),t,n,l),l),(Iw(y||1)==5||Iw(uh()||1)==5)&&uu(R)&&Ey(R,-1,void 0)!==" "&&(R+=" ");break;default:R+="/"}break;case 123*b:o[c++]=uu(R)*x;case 125*b:case 59:case 0:switch(w){case 0:case 125:v=0;case 59+u:x==-1&&(R=q2(R,/\f/g,"")),m>0&&(uu(R)-d||b===0&&y===47)&&JS(m>32?_U(R+";",r,n,d-1,l):_U(q2(R," ","")+";",r,n,d-2,l),l);break;case 59:R+=";";default:if(JS(A=wU(R,t,n,c,u,s,o,S,C=[],k=[],d,i),i),w===123)if(u===0)W2(R,t,A,A,C,i,d,o,k);else{switch(h){case 99:if(j0(R,3)===110)break;case 108:if(j0(R,2)===97)break;default:u=0;case 100:case 109:case 115:}u?W2(e,A,A,r&&JS(wU(e,A,A,0,0,s,o,S,s,C=[],d,k),k),s,k,d,o,r?C:k):W2(R,A,A,A,[""],k,0,o,k)}}c=u=m=0,b=x=1,S=R="",d=a;break;case 58:d=1+uu(R),m=y;default:if(b<1){if(w==123)--b;else if(w==125&&b++==0&&MLe()==125)continue}switch(R+=v6(w),w*b){case 38:x=u>0?1:(R+="\f",-1);break;case 44:o[c++]=(uu(R)-1)*x,x=1;break;case 64:uh()===45&&(R+=PI(Ac())),h=uh(),u=d=uu(S=R+=FLe(V2())),w++;break;case 45:y===45&&uu(R)==2&&(b=0)}}return i}function wU(e,t,n,r,s,i,a,o,l,c,u,d){for(var h=s-1,m=s===0?i:[""],y=RLe(m),b=0,v=0,x=0;b<r;++b)for(var w=0,S=Ey(e,h+1,h=Pne(v=a[b])),C=e;w<y;++w)(C=One(v>0?m[w]+" "+S:q2(S,/&\f/g,m[w])))&&(l[x++]=C);return x6(e,t,n,s===0?Ine:o,l,c,u,d)}function BLe(e,t,n,r){return x6(e,t,n,Mne,v6(NLe()),Ey(e,2,-2),0,r)}function _U(e,t,n,r,s){return x6(e,t,n,jne,Ey(e,0,r),Ey(e,r+1,-1),r,s)}function S4(e,t){for(var n="",r=0;r<e.length;r++)n+=t(e[r],r,e,t)||"";return n}function $Le(e,t,n,r){switch(e.type){case TLe:if(e.children.length)break;case CLe:case kLe:case jne:return e.return=e.return||e.value;case Mne:return"";case ELe:return e.return=e.value+"{"+S4(e.children,r)+"}";case Ine:if(!uu(e.value=e.props.join(",")))return""}return uu(n=S4(e.children,r))?e.return=e.value+"{"+n+"}":""}var zLe=gee(Object.keys,Object),ULe=Object.prototype,qLe=ULe.hasOwnProperty;function VLe(e){if(!kT(e))return zLe(e);var t=[];for(var n in Object(e))qLe.call(e,n)&&n!="constructor"&&t.push(n);return t}var C4=Qm(Uu,"DataView"),k4=Qm(Uu,"Promise"),E4=Qm(Uu,"Set"),T4=Qm(Uu,"WeakMap"),SU="[object Map]",WLe="[object Object]",CU="[object Promise]",kU="[object Set]",EU="[object WeakMap]",TU="[object DataView]",HLe=Jm(C4),GLe=Jm(Nw),KLe=Jm(k4),YLe=Jm(E4),ZLe=Jm(T4),Hp=sb;(C4&&Hp(new C4(new ArrayBuffer(1)))!=TU||Nw&&Hp(new Nw)!=SU||k4&&Hp(k4.resolve())!=CU||E4&&Hp(new E4)!=kU||T4&&Hp(new T4)!=EU)&&(Hp=function(e){var t=sb(e),n=t==WLe?e.constructor:void 0,r=n?Jm(n):"";if(r)switch(r){case HLe:return TU;case GLe:return SU;case KLe:return CU;case YLe:return kU;case ZLe:return EU}return t});var XLe="[object Map]",JLe="[object Set]",QLe=Object.prototype,eBe=QLe.hasOwnProperty;function AU(e){if(e==null)return!0;if(ET(e)&&(Tk(e)||typeof e=="string"||typeof e.splice=="function"||XD(e)||JD(e)||Ek(e)))return!e.length;var t=Hp(e);if(t==XLe||t==JLe)return!e.size;if(kT(e))return!VLe(e).length;for(var n in e)if(eBe.call(e,n))return!1;return!0}var Fne="c4",tBe=ie(e=>/^\s*C4Context|C4Container|C4Component|C4Dynamic|C4Deployment/.test(e),"detector"),nBe=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./c4Diagram-VJAJSXHY-C7gNKdfE.js");return{diagram:t}},__vite__mapDeps([6,7]));return{id:Fne,diagram:e}},"loader"),rBe={id:Fne,detector:tBe,loader:nBe},sBe=rBe,Lne="flowchart",iBe=ie((e,t)=>{var n,r;return((n=t==null?void 0:t.flowchart)==null?void 0:n.defaultRenderer)==="dagre-wrapper"||((r=t==null?void 0:t.flowchart)==null?void 0:r.defaultRenderer)==="elk"?!1:/^\s*graph/.test(e)},"detector"),aBe=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./flowDiagram-4HSFHLVR-CUmn8nOk.js");return{diagram:t}},__vite__mapDeps([8,9,10]));return{id:Lne,diagram:e}},"loader"),oBe={id:Lne,detector:iBe,loader:aBe},lBe=oBe,Bne="flowchart-v2",cBe=ie((e,t)=>{var n,r,s;return((n=t==null?void 0:t.flowchart)==null?void 0:n.defaultRenderer)==="dagre-d3"?!1:(((r=t==null?void 0:t.flowchart)==null?void 0:r.defaultRenderer)==="elk"&&(t.layout="elk"),/^\s*graph/.test(e)&&((s=t==null?void 0:t.flowchart)==null?void 0:s.defaultRenderer)==="dagre-wrapper"?!0:/^\s*flowchart/.test(e))},"detector"),uBe=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./flowDiagram-4HSFHLVR-CUmn8nOk.js");return{diagram:t}},__vite__mapDeps([8,9,10]));return{id:Bne,diagram:e}},"loader"),dBe={id:Bne,detector:cBe,loader:uBe},fBe=dBe,$ne="er",hBe=ie(e=>/^\s*erDiagram/.test(e),"detector"),pBe=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./erDiagram-Q7BY3M3F-CPNjoMzo.js");return{diagram:t}},__vite__mapDeps([11,9,10]));return{id:$ne,diagram:e}},"loader"),mBe={id:$ne,detector:hBe,loader:pBe},gBe=mBe,zne="gitGraph",yBe=ie(e=>/^\s*gitGraph/.test(e),"detector"),bBe=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./gitGraphDiagram-7IBYFJ6S-CpqKGuaN.js");return{diagram:t}},__vite__mapDeps([12,13,14,15,2,4,5]));return{id:zne,diagram:e}},"loader"),vBe={id:zne,detector:yBe,loader:bBe},xBe=vBe,Une="gantt",wBe=ie(e=>/^\s*gantt/.test(e),"detector"),_Be=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./ganttDiagram-APWFNJXF-CihBlsLX.js");return{diagram:t}},__vite__mapDeps([16,17,18]));return{id:Une,diagram:e}},"loader"),SBe={id:Une,detector:wBe,loader:_Be},CBe=SBe,qne="info",kBe=ie(e=>/^\s*info/.test(e),"detector"),EBe=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./infoDiagram-PH2N3AL5-DAPupfWJ.js");return{diagram:t}},__vite__mapDeps([19,15,2,4,5]));return{id:qne,diagram:e}},"loader"),TBe={id:qne,detector:kBe,loader:EBe},Vne="pie",ABe=ie(e=>/^\s*pie/.test(e),"detector"),RBe=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./pieDiagram-IB7DONF6-Rp0dcLT9.js");return{diagram:t}},__vite__mapDeps([20,13,15,2,4,5,21,22,18]));return{id:Vne,diagram:e}},"loader"),NBe={id:Vne,detector:ABe,loader:RBe},Wne="quadrantChart",MBe=ie(e=>/^\s*quadrantChart/.test(e),"detector"),IBe=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./quadrantDiagram-7GDLP6J5-ALxnb1_I.js");return{diagram:t}},__vite__mapDeps([23,17,18]));return{id:Wne,diagram:e}},"loader"),jBe={id:Wne,detector:MBe,loader:IBe},PBe=jBe,Hne="xychart",OBe=ie(e=>/^\s*xychart-beta/.test(e),"detector"),DBe=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./xychartDiagram-VJFVF3MP-FMMwMxkT.js");return{diagram:t}},__vite__mapDeps([24,18,22,17]));return{id:Hne,diagram:e}},"loader"),FBe={id:Hne,detector:OBe,loader:DBe},LBe=FBe,Gne="requirement",BBe=ie(e=>/^\s*requirement(Diagram)?/.test(e),"detector"),$Be=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./requirementDiagram-KVF5MWMF-DEpYTEa6.js");return{diagram:t}},__vite__mapDeps([25,9]));return{id:Gne,diagram:e}},"loader"),zBe={id:Gne,detector:BBe,loader:$Be},UBe=zBe,Kne="sequence",qBe=ie(e=>/^\s*sequenceDiagram/.test(e),"detector"),VBe=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./sequenceDiagram-X6HHIX6F-Dk73tPff.js");return{diagram:t}},__vite__mapDeps([26,7,14]));return{id:Kne,diagram:e}},"loader"),WBe={id:Kne,detector:qBe,loader:VBe},HBe=WBe,Yne="class",GBe=ie((e,t)=>{var n;return((n=t==null?void 0:t.class)==null?void 0:n.defaultRenderer)==="dagre-wrapper"?!1:/^\s*classDiagram/.test(e)},"detector"),KBe=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./classDiagram-GIVACNV2-BtzZQ87q.js");return{diagram:t}},__vite__mapDeps([27,28,9]));return{id:Yne,diagram:e}},"loader"),YBe={id:Yne,detector:GBe,loader:KBe},ZBe=YBe,Zne="classDiagram",XBe=ie((e,t)=>{var n;return/^\s*classDiagram/.test(e)&&((n=t==null?void 0:t.class)==null?void 0:n.defaultRenderer)==="dagre-wrapper"?!0:/^\s*classDiagram-v2/.test(e)},"detector"),JBe=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./classDiagram-v2-COTLJTTW-BtzZQ87q.js");return{diagram:t}},__vite__mapDeps([29,28,9]));return{id:Zne,diagram:e}},"loader"),QBe={id:Zne,detector:XBe,loader:JBe},e$e=QBe,Xne="state",t$e=ie((e,t)=>{var n;return((n=t==null?void 0:t.state)==null?void 0:n.defaultRenderer)==="dagre-wrapper"?!1:/^\s*stateDiagram/.test(e)},"detector"),n$e=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./stateDiagram-DGXRK772-B4eHhVEu.js");return{diagram:t}},__vite__mapDeps([30,31,9,1,2,3,4]));return{id:Xne,diagram:e}},"loader"),r$e={id:Xne,detector:t$e,loader:n$e},s$e=r$e,Jne="stateDiagram",i$e=ie((e,t)=>{var n;return!!(/^\s*stateDiagram-v2/.test(e)||/^\s*stateDiagram/.test(e)&&((n=t==null?void 0:t.state)==null?void 0:n.defaultRenderer)==="dagre-wrapper")},"detector"),a$e=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./stateDiagram-v2-YXO3MK2T-BqBjavIS.js");return{diagram:t}},__vite__mapDeps([32,31,9]));return{id:Jne,diagram:e}},"loader"),o$e={id:Jne,detector:i$e,loader:a$e},l$e=o$e,Qne="journey",c$e=ie(e=>/^\s*journey/.test(e),"detector"),u$e=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./journeyDiagram-U35MCT3I-CpHjorXL.js");return{diagram:t}},__vite__mapDeps([33,7,21]));return{id:Qne,diagram:e}},"loader"),d$e={id:Qne,detector:c$e,loader:u$e},f$e=d$e,h$e=ie((e,t,n)=>{zt.debug(`rendering svg for syntax error
`);const r=SLe(t),s=r.append("g");r.attr("viewBox","0 0 2412 512"),jX(r,100,512,!0),s.append("path").attr("class","error-icon").attr("d","m411.313,123.313c6.25-6.25 6.25-16.375 0-22.625s-16.375-6.25-22.625,0l-32,32-9.375,9.375-20.688-20.688c-12.484-12.5-32.766-12.5-45.25,0l-16,16c-1.261,1.261-2.304,2.648-3.31,4.051-21.739-8.561-45.324-13.426-70.065-13.426-105.867,0-192,86.133-192,192s86.133,192 192,192 192-86.133 192-192c0-24.741-4.864-48.327-13.426-70.065 1.402-1.007 2.79-2.049 4.051-3.31l16-16c12.5-12.492 12.5-32.758 0-45.25l-20.688-20.688 9.375-9.375 32.001-31.999zm-219.313,100.687c-52.938,0-96,43.063-96,96 0,8.836-7.164,16-16,16s-16-7.164-16-16c0-70.578 57.422-128 128-128 8.836,0 16,7.164 16,16s-7.164,16-16,16z"),s.append("path").attr("class","error-icon").attr("d","m459.02,148.98c-6.25-6.25-16.375-6.25-22.625,0s-6.25,16.375 0,22.625l16,16c3.125,3.125 7.219,4.688 11.313,4.688 4.094,0 8.188-1.563 11.313-4.688 6.25-6.25 6.25-16.375 0-22.625l-16.001-16z"),s.append("path").attr("class","error-icon").attr("d","m340.395,75.605c3.125,3.125 7.219,4.688 11.313,4.688 4.094,0 8.188-1.563 11.313-4.688 6.25-6.25 6.25-16.375 0-22.625l-16-16c-6.25-6.25-16.375-6.25-22.625,0s-6.25,16.375 0,22.625l15.999,16z"),s.append("path").attr("class","error-icon").attr("d","m400,64c8.844,0 16-7.164 16-16v-32c0-8.836-7.156-16-16-16-8.844,0-16,7.164-16,16v32c0,8.836 7.156,16 16,16z"),s.append("path").attr("class","error-icon").attr("d","m496,96.586h-32c-8.844,0-16,7.164-16,16 0,8.836 7.156,16 16,16h32c8.844,0 16-7.164 16-16 0-8.836-7.156-16-16-16z"),s.append("path").attr("class","error-icon").attr("d","m436.98,75.605c3.125,3.125 7.219,4.688 11.313,4.688 4.094,0 8.188-1.563 11.313-4.688l32-32c6.25-6.25 6.25-16.375 0-22.625s-16.375-6.25-22.625,0l-32,32c-6.251,6.25-6.251,16.375-0.001,22.625z"),s.append("text").attr("class","error-text").attr("x",1440).attr("y",250).attr("font-size","150px").style("text-anchor","middle").text("Syntax error in text"),s.append("text").attr("class","error-text").attr("x",1250).attr("y",400).attr("font-size","100px").style("text-anchor","middle").text(`mermaid version ${n}`)},"draw"),ere={draw:h$e},p$e=ere,m$e={db:{},renderer:ere,parser:{parse:ie(()=>{},"parse")}},g$e=m$e,tre="flowchart-elk",y$e=ie((e,t={})=>{var n;return/^\s*flowchart-elk/.test(e)||/^\s*flowchart|graph/.test(e)&&((n=t==null?void 0:t.flowchart)==null?void 0:n.defaultRenderer)==="elk"?(t.layout="elk",!0):!1},"detector"),b$e=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./flowDiagram-4HSFHLVR-CUmn8nOk.js");return{diagram:t}},__vite__mapDeps([8,9,10]));return{id:tre,diagram:e}},"loader"),v$e={id:tre,detector:y$e,loader:b$e},x$e=v$e,nre="timeline",w$e=ie(e=>/^\s*timeline/.test(e),"detector"),_$e=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./timeline-definition-BDJGKUSR-DTcUkqn2.js");return{diagram:t}},__vite__mapDeps([34,21]));return{id:nre,diagram:e}},"loader"),S$e={id:nre,detector:w$e,loader:_$e},C$e=S$e,rre="mindmap",k$e=ie(e=>/^\s*mindmap/.test(e),"detector"),E$e=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./mindmap-definition-ALO5MXBD-B_m_27ss.js");return{diagram:t}},__vite__mapDeps([35,36]));return{id:rre,diagram:e}},"loader"),T$e={id:rre,detector:k$e,loader:E$e},A$e=T$e,sre="kanban",R$e=ie(e=>/^\s*kanban/.test(e),"detector"),N$e=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./kanban-definition-NDS4AKOZ--Bf4gBUW.js");return{diagram:t}},[]);return{id:sre,diagram:e}},"loader"),M$e={id:sre,detector:R$e,loader:N$e},I$e=M$e,ire="sankey",j$e=ie(e=>/^\s*sankey-beta/.test(e),"detector"),P$e=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./sankeyDiagram-QLVOVGJD-CQLCuUH7.js");return{diagram:t}},__vite__mapDeps([37,22,18]));return{id:ire,diagram:e}},"loader"),O$e={id:ire,detector:j$e,loader:P$e},D$e=O$e,are="packet",F$e=ie(e=>/^\s*packet-beta/.test(e),"detector"),L$e=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./diagram-VNBRO52H-CCqqz0cc.js");return{diagram:t}},__vite__mapDeps([38,13,15,2,4,5]));return{id:are,diagram:e}},"loader"),B$e={id:are,detector:F$e,loader:L$e},ore="radar",$$e=ie(e=>/^\s*radar-beta/.test(e),"detector"),z$e=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./diagram-SSKATNLV-DtAoZgT2.js");return{diagram:t}},__vite__mapDeps([39,13,15,2,4,5]));return{id:ore,diagram:e}},"loader"),U$e={id:ore,detector:$$e,loader:z$e},lre="block",q$e=ie(e=>/^\s*block-beta/.test(e),"detector"),V$e=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./blockDiagram-JOT3LUYC-elkzGZkY.js");return{diagram:t}},__vite__mapDeps([40,5,2,1,10]));return{id:lre,diagram:e}},"loader"),W$e={id:lre,detector:q$e,loader:V$e},H$e=W$e,cre="architecture",G$e=ie(e=>/^\s*architecture/.test(e),"detector"),K$e=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./architectureDiagram-IEHRJDOE-R-njEK5X.js");return{diagram:t}},__vite__mapDeps([41,13,14,15,2,4,5,36]));return{id:cre,diagram:e}},"loader"),Y$e={id:cre,detector:G$e,loader:K$e},Z$e=Y$e,RU=!1,DT=ie(()=>{RU||(RU=!0,ak("error",g$e,e=>e.toLowerCase().trim()==="error"),ak("---",{db:{clear:ie(()=>{},"clear")},styles:{},renderer:{draw:ie(()=>{},"draw")},parser:{parse:ie(()=>{throw new Error("Diagrams beginning with --- are not valid. If you were trying to use a YAML front-matter, please ensure that you've correctly opened and closed the YAML front-matter with un-indented `---` blocks")},"parse")},init:ie(()=>null,"init")},e=>e.toLowerCase().trimStart().startsWith("---")),xX(sBe,I$e,e$e,ZBe,gBe,CBe,TBe,NBe,UBe,HBe,x$e,fBe,lBe,A$e,C$e,xBe,l$e,s$e,f$e,PBe,D$e,B$e,LBe,H$e,Z$e,U$e))},"addDiagrams"),X$e=ie(async()=>{zt.debug("Loading registered diagrams");const t=(await Promise.allSettled(Object.entries(by).map(async([n,{detector:r,loader:s}])=>{if(s)try{Bj(n)}catch{try{const{diagram:i,id:a}=await s();ak(a,i,r)}catch(i){throw zt.error(`Failed to load external diagram with key ${n}. Removing from detectors.`),delete by[n],i}}}))).filter(n=>n.status==="rejected");if(t.length>0){zt.error(`Failed to load ${t.length} external diagrams`);for(const n of t)zt.error(n);throw new Error(`Failed to load ${t.length} external diagrams`)}},"loadRegisteredDiagrams"),J$e="graphics-document document";function ure(e,t){e.attr("role",J$e),t!==""&&e.attr("aria-roledescription",t)}ie(ure,"setA11yDiagramInfo");function dre(e,t,n,r){if(e.insert!==void 0){if(n){const s=`chart-desc-${r}`;e.attr("aria-describedby",s),e.insert("desc",":first-child").attr("id",s).text(n)}if(t){const s=`chart-title-${r}`;e.attr("aria-labelledby",s),e.insert("title",":first-child").attr("id",s).text(t)}}}ie(dre,"addSVGa11yTitleDescription");var pm,A4=(pm=class{constructor(t,n,r,s,i){this.type=t,this.text=n,this.db=r,this.parser=s,this.renderer=i}static async fromText(t,n={}){var c,u;const r=Mo(),s=_D(t,r);t=vFe(t)+`
`;try{Bj(s)}catch{const d=kIe(s);if(!d)throw new vX(`Diagram ${s} not found.`);const{id:h,diagram:m}=await d();ak(h,m)}const{db:i,parser:a,renderer:o,init:l}=Bj(s);return a.parser&&(a.parser.yy=i),(c=i.clear)==null||c.call(i),l==null||l(r),n.title&&((u=i.setDiagramTitle)==null||u.call(i,n.title)),await a.parse(t),new pm(s,t,i,a,o)}async render(t,n){await this.renderer.draw(this.text,t,n,this)}getParser(){return this.parser}getType(){return this.type}},ie(pm,"Diagram"),pm),NU=[],Q$e=ie(()=>{NU.forEach(e=>{e()}),NU=[]},"attachFunctions"),e9e=ie(e=>e.replace(/^\s*%%(?!{)[^\n]+\n?/gm,"").trimStart(),"cleanupComments");function fre(e){const t=e.match(bX);if(!t)return{text:e,metadata:{}};let n=Cje(t[1],{schema:Sje})??{};n=typeof n=="object"&&!Array.isArray(n)?n:{};const r={};return n.displayMode&&(r.displayMode=n.displayMode.toString()),n.title&&(r.title=n.title.toString()),n.config&&(r.config=n.config),{text:e.slice(t[0].length),metadata:r}}ie(fre,"extractFrontMatter");var t9e=ie(e=>e.replace(/\r\n?/g,`
`).replace(/<(\w+)([^>]*)>/g,(t,n,r)=>"<"+n+r.replace(/="([^"]*)"/g,"='$1'")+">"),"cleanupText"),n9e=ie(e=>{const{text:t,metadata:n}=fre(e),{displayMode:r,title:s,config:i={}}=n;return r&&(i.gantt||(i.gantt={}),i.gantt.displayMode=r),{title:s,config:i,text:t}},"processFrontmatter"),r9e=ie(e=>{const t=pu.detectInit(e)??{},n=pu.detectDirective(e,"wrap");return Array.isArray(n)?t.wrap=n.some(({type:r})=>r==="wrap"):(n==null?void 0:n.type)==="wrap"&&(t.wrap=!0),{text:aFe(e),directive:t}},"processDirectives");function w6(e){const t=t9e(e),n=n9e(t),r=r9e(n.text),s=s6(n.config,r.directive);return e=e9e(r.text),{code:e,title:n.title,config:s}}ie(w6,"preprocessDiagram");function hre(e){const t=new TextEncoder().encode(e),n=Array.from(t,r=>String.fromCodePoint(r)).join("");return btoa(n)}ie(hre,"toBase64");var s9e=5e4,i9e="graph TB;a[Maximum text size in diagram exceeded];style a fill:#faa",a9e="sandbox",o9e="loose",l9e="http://www.w3.org/2000/svg",c9e="http://www.w3.org/1999/xlink",u9e="http://www.w3.org/1999/xhtml",d9e="100%",f9e="100%",h9e="border:0;margin:0;",p9e="margin:0",m9e="allow-top-navigation-by-user-activation allow-popups",g9e='The "iframe" tag is not supported by your browser.',y9e=["foreignobject"],b9e=["dominant-baseline"];function _6(e){const t=w6(e);return sk(),zIe(t.config??{}),t}ie(_6,"processAndSetConfigs");async function pre(e,t){DT();try{const{code:n,config:r}=_6(e);return{diagramType:(await gre(n)).type,config:r}}catch(n){if(t!=null&&t.suppressErrors)return!1;throw n}}ie(pre,"parse");var MU=ie((e,t,n=[])=>`
.${e} ${t} { ${n.join(" !important; ")} !important; }`,"cssImportantStyles"),v9e=ie((e,t=new Map)=>{var r;let n="";if(e.themeCSS!==void 0&&(n+=`
${e.themeCSS}`),e.fontFamily!==void 0&&(n+=`
:root { --mermaid-font-family: ${e.fontFamily}}`),e.altFontFamily!==void 0&&(n+=`
:root { --mermaid-alt-font-family: ${e.altFontFamily}}`),t instanceof Map){const o=e.htmlLabels??((r=e.flowchart)==null?void 0:r.htmlLabels)?["> *","span"]:["rect","polygon","ellipse","circle","path"];t.forEach(l=>{AU(l.styles)||o.forEach(c=>{n+=MU(l.id,c,l.styles)}),AU(l.textStyles)||(n+=MU(l.id,"tspan",((l==null?void 0:l.textStyles)||[]).map(c=>c.replace("color","fill"))))})}return n},"createCssStyles"),x9e=ie((e,t,n,r)=>{const s=v9e(e,n),i=a3e(t,s,e.themeVariables);return S4(LLe(`${r}{${i}}`),$Le)},"createUserStyles"),w9e=ie((e="",t,n)=>{let r=e;return!n&&!t&&(r=r.replace(/marker-end="url\([\d+./:=?A-Za-z-]*?#/g,'marker-end="url(#')),r=eg(r),r=r.replace(/<br>/g,"<br/>"),r},"cleanUpSvgCode"),_9e=ie((e="",t)=>{var s,i;const n=(i=(s=t==null?void 0:t.viewBox)==null?void 0:s.baseVal)!=null&&i.height?t.viewBox.baseVal.height+"px":f9e,r=hre(`<body style="${p9e}">${e}</body>`);return`<iframe style="width:${d9e};height:${n};${h9e}" src="data:text/html;charset=UTF-8;base64,${r}" sandbox="${m9e}">
  ${g9e}
</iframe>`},"putIntoIFrame"),IU=ie((e,t,n,r,s)=>{const i=e.append("div");i.attr("id",n),r&&i.attr("style",r);const a=i.append("svg").attr("id",t).attr("width","100%").attr("xmlns",l9e);return s&&a.attr("xmlns:xlink",s),a.append("g"),e},"appendDivSvgG");function R4(e,t){return e.append("iframe").attr("id",t).attr("style","width: 100%; height: 100%;").attr("sandbox","")}ie(R4,"sandboxedIframe");var S9e=ie((e,t,n,r)=>{var s,i,a;(s=e.getElementById(t))==null||s.remove(),(i=e.getElementById(n))==null||i.remove(),(a=e.getElementById(r))==null||a.remove()},"removeExistingElements"),C9e=ie(async function(e,t,n){var O,V,D,Z,U,H;DT();const r=_6(t);t=r.code;const s=Mo();zt.debug(s),t.length>((s==null?void 0:s.maxTextSize)??s9e)&&(t=i9e);const i="#"+e,a="i"+e,o="#"+a,l="d"+e,c="#"+l,u=ie(()=>{const ne=Kr(h?o:c).node();ne&&"remove"in ne&&ne.remove()},"removeTempElements");let d=Kr("body");const h=s.securityLevel===a9e,m=s.securityLevel===o9e,y=s.fontFamily;if(n!==void 0){if(n&&(n.innerHTML=""),h){const $=R4(Kr(n),a);d=Kr($.nodes()[0].contentDocument.body),d.node().style.margin=0}else d=Kr(n);IU(d,e,l,`font-family: ${y}`,c9e)}else{if(S9e(document,e,l,a),h){const $=R4(Kr("body"),a);d=Kr($.nodes()[0].contentDocument.body),d.node().style.margin=0}else d=Kr("body");IU(d,e,l)}let b,v;try{b=await A4.fromText(t,{title:r.title})}catch($){if(s.suppressErrorRendering)throw u(),$;b=await A4.fromText("error"),v=$}const x=d.select(c).node(),w=b.type,S=x.firstChild,C=S.firstChild,k=(V=(O=b.renderer).getClasses)==null?void 0:V.call(O,t,b),A=x9e(s,w,k,i),R=document.createElement("style");R.innerHTML=A,S.insertBefore(R,C);try{await b.renderer.draw(t,e,xU.version,b)}catch($){throw s.suppressErrorRendering?u():p$e.draw(t,e,xU.version),$}const N=d.select(`${c} svg`),I=(Z=(D=b.db).getAccTitle)==null?void 0:Z.call(D),P=(H=(U=b.db).getAccDescription)==null?void 0:H.call(U);yre(w,N,I,P),d.select(`[id="${e}"]`).selectAll("foreignobject > *").attr("xmlns",u9e);let L=d.select(c).node().innerHTML;if(zt.debug("config.arrowMarkerAbsolute",s.arrowMarkerAbsolute),L=w9e(L,h,Wi(s.arrowMarkerAbsolute)),h){const $=d.select(c+" svg").node();L=_9e(L,$)}else m||(L=yy.sanitize(L,{ADD_TAGS:y9e,ADD_ATTR:b9e,HTML_INTEGRATION_POINTS:{foreignobject:!0}}));if(Q$e(),v)throw v;return u(),{diagramType:w,svg:L,bindFunctions:b.db.bindFunctions}},"render");function mre(e={}){var r;const t=xa({},e);t!=null&&t.fontFamily&&!((r=t.themeVariables)!=null&&r.fontFamily)&&(t.themeVariables||(t.themeVariables={}),t.themeVariables.fontFamily=t.fontFamily),BIe(t),t!=null&&t.theme&&t.theme in Fd?t.themeVariables=Fd[t.theme].getThemeVariables(t.themeVariables):t&&(t.themeVariables=Fd.default.getThemeVariables(t.themeVariables));const n=typeof t=="object"?LIe(t):EX();wD(n.logLevel),DT()}ie(mre,"initialize");var gre=ie((e,t={})=>{const{code:n}=w6(e);return A4.fromText(n,t)},"getDiagramFromText");function yre(e,t,n,r){ure(t,e),dre(t,n,r,t.attr("id"))}ie(yre,"addA11yInfo");var Im=Object.freeze({render:C9e,parse:pre,getDiagramFromText:gre,initialize:mre,getConfig:Mo,setConfig:TX,getSiteConfig:EX,updateSiteConfig:$Ie,reset:ie(()=>{sk()},"reset"),globalReset:ie(()=>{sk(vy)},"globalReset"),defaultConfig:vy});wD(Mo().logLevel);sk(Mo());var k9e=ie((e,t,n)=>{zt.warn(e),r6(e)?(n&&n(e.str,e.hash),t.push({...e,message:e.str,error:e})):(n&&n(e),e instanceof Error&&t.push({str:e.message,message:e.message,hash:e.name,error:e}))},"handleError"),bre=ie(async function(e={querySelector:".mermaid"}){try{await E9e(e)}catch(t){if(r6(t)&&zt.error(t.str),ll.parseError&&ll.parseError(t),!e.suppressErrors)throw zt.error("Use the suppressErrors option to suppress these errors"),t}},"run"),E9e=ie(async function({postRenderCallback:e,querySelector:t,nodes:n}={querySelector:".mermaid"}){const r=Im.getConfig();zt.debug(`${e?"":"No "}Callback function found`);let s;if(n)s=n;else if(t)s=document.querySelectorAll(t);else throw new Error("Nodes and querySelector are both undefined");zt.debug(`Found ${s.length} diagrams`),(r==null?void 0:r.startOnLoad)!==void 0&&(zt.debug("Start On Load: "+(r==null?void 0:r.startOnLoad)),Im.updateSiteConfig({startOnLoad:r==null?void 0:r.startOnLoad}));const i=new pu.InitIDGenerator(r.deterministicIds,r.deterministicIDSeed);let a;const o=[];for(const l of Array.from(s)){if(zt.info("Rendering diagram: "+l.id),l.getAttribute("data-processed"))continue;l.setAttribute("data-processed","true");const c=`mermaid-${i.next()}`;a=l.innerHTML,a=Hee(pu.entityDecode(a)).trim().replace(/<br\s*\/?>/gi,"<br/>");const u=pu.detectInit(a);u&&zt.debug("Detected early reinit: ",u);try{const{svg:d,bindFunctions:h}=await _re(c,a,l);l.innerHTML=d,e&&await e(c),h&&h(l)}catch(d){k9e(d,o,ll.parseError)}}if(o.length>0)throw o[0]},"runThrowsErrors"),vre=ie(function(e){Im.initialize(e)},"initialize"),T9e=ie(async function(e,t,n){zt.warn("mermaid.init is deprecated. Please use run instead."),e&&vre(e);const r={postRenderCallback:n,querySelector:".mermaid"};typeof t=="string"?r.querySelector=t:t&&(t instanceof HTMLElement?r.nodes=[t]:r.nodes=t),await bre(r)},"init"),A9e=ie(async(e,{lazyLoad:t=!0}={})=>{DT(),xX(...e),t===!1&&await X$e()},"registerExternalDiagrams"),xre=ie(function(){if(ll.startOnLoad){const{startOnLoad:e}=Im.getConfig();e&&ll.run().catch(t=>zt.error("Mermaid failed to initialize",t))}},"contentLoaded");typeof document<"u"&&window.addEventListener("load",xre,!1);var R9e=ie(function(e){ll.parseError=e},"setParseErrorHandler"),Fk=[],OI=!1,wre=ie(async()=>{if(!OI){for(OI=!0;Fk.length>0;){const e=Fk.shift();if(e)try{await e()}catch(t){zt.error("Error executing queue",t)}}OI=!1}},"executeQueue"),N9e=ie(async(e,t)=>new Promise((n,r)=>{const s=ie(()=>new Promise((i,a)=>{Im.parse(e,t).then(o=>{i(o),n(o)},o=>{var l;zt.error("Error parsing",o),(l=ll.parseError)==null||l.call(ll,o),a(o),r(o)})}),"performCall");Fk.push(s),wre().catch(r)}),"parse"),_re=ie((e,t,n)=>new Promise((r,s)=>{const i=ie(()=>new Promise((a,o)=>{Im.render(e,t,n).then(l=>{a(l),r(l)},l=>{var c;zt.error("Error parsing",l),(c=ll.parseError)==null||c.call(ll,l),o(l),s(l)})}),"performCall");Fk.push(i),wre().catch(s)}),"render"),ll={startOnLoad:!0,mermaidAPI:Im,parse:N9e,render:_re,init:T9e,run:bre,registerExternalDiagrams:A9e,registerLayoutLoaders:Nne,initialize:vre,parseError:void 0,contentLoaded:xre,setParseErrorHandler:R9e,detectType:_D,registerIconPacks:Gje},M9e=ll;/*! Check if previously processed *//*!
 * Wait for document loaded before starting the execution
 */const I9e=new DOMParser,j9e=new XMLSerializer;function jU(e,t){const n=e.getAttribute(t);if(!n)return;let r="";for(const s of n.split(/\s+/)){const i=e.getElementById(s);i&&(r+=i.textContent)}return r}let PU=0;const P9e=async(e,t)=>{const n=document.createElement("div");n.ariaHidden="true",n.style.maxHeight="0",n.style.opacity="0",n.style.overflow="hidden",t!=null&&t.containerStyle&&Object.assign(n.style,t.containerStyle),document.body.append(n);const r=await Promise.allSettled(e.map(async s=>{const i=`${(t==null?void 0:t.prefix)??"mermaid"}-${PU}`;PU+=1;const{svg:a}=await M9e.render(i,s,n),o=I9e.parseFromString(a,"text/html"),[l]=o.getElementsByTagName("svg"),{height:c,width:u}=l.viewBox.baseVal,d=jU(l,"aria-describedby"),h=jU(l,"aria-labelledby"),m={height:c,id:i,svg:j9e.serializeToString(l),width:u};return d&&(m.description=d),h&&(m.title=h),m}));return n.remove(),r},O9e=()=>P9e,D9e=({code:e,isStreaming:t=!1})=>{const{foldStreamingCodeBlocks:n}=yr(yn(w=>({foldStreamingCodeBlocks:w.foldStreamingCodeBlocks}))),[r,s]=T.useState(t?n:!1),[i,a]=T.useState(null),[o,l]=T.useState(!1),[c,u]=T.useState(null),d=T.useRef(null),h=jo(yn(w=>Object.values(w.canvasControls))),m=T.useCallback((w,S,C,k,A)=>h.filter(R=>R.type==="codeblock"&&R.targetSlot===w&&R.renderer).map(R=>{if(R.renderer){const N={codeBlockContent:S,codeBlockLang:"mermaid",isFolded:k,toggleFold:A,canvasContextType:"codeblock"};return f.jsx(We.Fragment,{children:R.renderer(N)},R.id)}return null}).filter(Boolean),[h]),y=T.useCallback(async()=>{if(!(!e.trim()||r)){l(!0),u(null),a(null);try{const S=await O9e()([e]);if(S.length>0&&S[0].status==="fulfilled")a(S[0].value.svg);else if(S.length>0&&S[0].status==="rejected"){const C=S[0].reason;u((C==null?void 0:C.message)||"Failed to render Mermaid diagram")}else u("No results returned from Mermaid renderer")}catch(w){console.error("Mermaid rendering error:",w),u(w instanceof Error?w.message:"Failed to render Mermaid diagram")}finally{l(!1)}}},[e,r]);T.useEffect(()=>{!r&&e.trim()&&y()},[e,r,y]);const b=()=>{const w=r;s(S=>!S),w&&setTimeout(y,0)},v=T.useMemo(()=>e?e.split(`
`).slice(0,3).join(`
`):"",[e]),x=m("codeblock-header-actions",e,"mermaid",r,b);return f.jsxs("div",{className:"code-block-container group/codeblock my-4 max-w-full",children:[f.jsxs("div",{className:"code-block-header sticky top-0 z-10 flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx("div",{className:"text-sm font-medium",children:"MERMAID"}),f.jsx("div",{className:"flex items-center gap-0.5 opacity-0 group-hover/codeblock:opacity-100 focus-within:opacity-100 transition-opacity",children:x})]}),f.jsx("div",{})]}),!r&&f.jsxs("div",{className:"overflow-hidden w-full",children:[o&&f.jsxs("div",{className:"flex items-center justify-center p-8",children:[f.jsx(Qn,{className:"h-6 w-6 animate-spin text-muted-foreground"}),f.jsx("span",{className:"ml-2 text-sm text-muted-foreground",children:"Rendering diagram..."})]}),c&&f.jsxs("div",{className:"flex items-center gap-2 p-4 border border-destructive/20 bg-destructive/10 rounded-md",children:[f.jsx(Rc,{className:"h-5 w-5 text-destructive flex-shrink-0"}),f.jsxs("div",{className:"text-sm text-destructive",children:[f.jsx("div",{className:"font-medium",children:"Failed to render Mermaid diagram"}),f.jsx("div",{className:"text-xs mt-1 opacity-80",children:c})]})]}),i&&!o&&!c&&f.jsx("div",{ref:d,className:"mermaid-container p-4 bg-background border rounded-md overflow-auto",dangerouslySetInnerHTML:{__html:i}})]}),r&&f.jsx("div",{className:"folded-content-preview p-4 cursor-pointer w-full box-border",onClick:b,children:f.jsx("pre",{className:"whitespace-pre-wrap break-words text-muted-foreground font-mono text-sm",children:v})})]})},S6=T.memo(D9e),F9e=({markdownContent:e})=>{const t=cT(e);return e!=null&&e.trim()?f.jsx("div",{className:"overflow-wrap-anywhere",children:t.map((n,r)=>{if(typeof n=="string")return f.jsx("div",{className:"markdown-content",dangerouslySetInnerHTML:{__html:n}},`html-${r}`);if(n.type==="code"){const s=n;return f.jsx(zy,{lang:s.lang,code:s.code,filepath:s.filepath},`code-${r}`)}else if(n.type==="mermaid"){const s=n;return f.jsx(S6,{code:s.code},`mermaid-${r}`)}return null})}):null},FT=We.memo(({turnData:e,timestamp:t,className:n,isAssistantComplete:r=!0})=>{var b,v;const s=yr(x=>x.foldUserMessagesOnCompletion),[i,a]=T.useState(r&&s),[o,l]=T.useState(!1);T.useEffect(()=>{r&&s&&a(!0)},[r,s]);const c=t?FZ(new Date(t),{addSuffix:!0}):"Sending...",u=((b=e.metadata)==null?void 0:b.attachedFiles)&&e.metadata.attachedFiles.length>0,d=e.content&&e.content.trim().length>0,h=T.useCallback(()=>a(x=>!x),[]),m=T.useCallback(async()=>{if(e.content)try{await navigator.clipboard.writeText(e.content),l(!0),je.success("User prompt copied!"),setTimeout(()=>l(!1),1500)}catch(x){je.error("Failed to copy prompt."),console.error("Clipboard copy failed:",x)}},[e.content]),y=T.useMemo(()=>{var w;let x="";return d&&(x+=`"${e.content.substring(0,50)}${e.content.length>50?"...":""}"`),d&&u&&(x+=" + "),u&&(x+=`${(w=e.metadata.attachedFiles)==null?void 0:w.length} file(s)`),x||"[Empty Prompt]"},[d,u,e.content,e.metadata]);return f.jsxs("div",{className:Ze("user-prompt relative group/user overflow-wrap-anywhere",n),children:[f.jsxs("div",{className:Ze("flex flex-col sm:flex-row justify-between items-start mb-2 sticky top-0 bg-card/80 backdrop-blur-sm z-10 p-1 -m-1 rounded-t"),children:[f.jsxs("div",{className:"flex items-center gap-1 mb-1 sm:mb-0",children:[f.jsx(Bge,{className:"h-4 w-4 text-primary flex-shrink-0"}),f.jsx("span",{className:"text-xs font-semibold text-primary mr-1",children:"User"}),f.jsxs("div",{className:"flex items-center gap-0.5 opacity-0 group-hover/user:opacity-100 focus-within:opacity-100 transition-opacity",children:[d&&f.jsx(Dn,{tooltipText:"Copy Prompt",onClick:m,"aria-label":"Copy user prompt",icon:o?f.jsx(so,{className:"text-green-500"}):f.jsx(dE,{}),className:"h-5 w-5"}),(d||u)&&f.jsx(Dn,{tooltipText:i?"Unfold":"Fold",onClick:h,"aria-label":i?"Unfold prompt":"Fold prompt",icon:i?f.jsx(Jl,{}):f.jsx(Lh,{}),iconClassName:"h-3.5 w-3.5",className:"h-5 w-5"})]})]}),f.jsx("div",{className:"flex items-center flex-shrink-0 self-end sm:self-start",children:f.jsx("span",{className:"text-xs text-muted-foreground",children:c})})]}),!i&&f.jsxs(f.Fragment,{children:[u&&f.jsx("div",{className:"mb-2 space-y-1",children:(v=e.metadata.attachedFiles)==null?void 0:v.map(x=>f.jsx(xZ,{fileMeta:x,isReadOnly:!0},x.id))}),f.jsx(F9e,{markdownContent:e.content})]}),i&&f.jsx("div",{className:"text-xs text-muted-foreground italic cursor-pointer hover:bg-muted/20 p-1 rounded",onClick:h,children:y})]})});FT.displayName="UserPromptDisplay";const L9e=(e,t,n,r,s)=>{if(typeof e=="string")return e.trim()?f.jsx("div",{className:"markdown-content",dangerouslySetInnerHTML:{__html:e}},`html-${t}`):null;if(e.type==="code"){const i=e,a=i.lang?`language-${i.lang}`:"language-plaintext";return n?f.jsx(zy,{lang:i.lang,code:i.code,filepath:i.filepath,isStreaming:r},`code-${t}`):f.jsxs("pre",{className:"code-block-container my-4 border border-border rounded-lg overflow-x-auto",children:[f.jsx("div",{className:"code-block-header flex items-center justify-between px-3 py-2 border-b border-border bg-muted/50",children:f.jsx("div",{className:"text-sm font-medium",children:i.lang?i.lang.toUpperCase():"CODE"})}),f.jsx("code",{className:Ze(a,"block p-4 font-mono text-sm leading-relaxed"),children:i.code})]},`pre-${t}`)}else if(e.type==="mermaid"){const i=e;return f.jsx(S6,{code:i.code,isStreaming:r},`mermaid-${t}`)}return null},B9e=({interactionId:e,markdownContent:t,isStreaming:n=!1,className:r})=>{const{enableStreamingMarkdown:s,enableStreamingCodeBlockParsing:i}=yr(yn(m=>({enableStreamingMarkdown:m.enableStreamingMarkdown,enableStreamingCodeBlockParsing:m.enableStreamingCodeBlockParsing}))),a=cT(s?t:null),o=jo(yn(m=>Object.values(m.canvasControls))),l=T.useCallback((m,y)=>o.filter(b=>b.type==="tool-call-step"&&b.targetSlot===m&&b.renderer).map(b=>b.renderer?f.jsx(We.Fragment,{children:b.renderer(y)},b.id):null).filter(Boolean),[o]),{toolCallStrings:c,toolResultStrings:u}=$n(yn(m=>{var b,v;const y=m.interactions.find(x=>x.id===e);return{toolCallStrings:(b=y==null?void 0:y.metadata)==null?void 0:b.toolCalls,toolResultStrings:(v=y==null?void 0:y.metadata)==null?void 0:v.toolResults}})),d=T.useMemo(()=>{if(!c)return[];try{const m=c.map(b=>JSON.parse(b)),y=(u==null?void 0:u.map(b=>JSON.parse(b)))??[];return m.map(b=>{const v=y.find(x=>x.toolCallId===b.toolCallId);return{call:b,result:v}})}catch(m){return console.error("[StreamingContentView] Error parsing tool call/result strings:",m),[]}},[c,u]),h=T.useMemo(()=>s?a.map((m,y)=>L9e(m,y,i,n&&y===a.length-1)).filter(Boolean):[],[s,a,i,n,e]);return!s&&!t&&d.length===0?n?f.jsx("div",{className:Ze("text-muted-foreground italic",r),children:"Generating response..."}):null:f.jsxs("div",{className:Ze("streaming-content-view overflow-wrap-anywhere",r),children:[d.map(({call:m,result:y},b)=>{const v={interactionId:e,toolCall:m,toolResult:y,canvasContextType:"tool-call-step"};return f.jsx(We.Fragment,{children:l("tool-call-content",v)},`tool-step-${m.toolCallId||b}`)}),s?h:t?f.jsx("div",{className:"markdown-content",dangerouslySetInnerHTML:{__html:new gl().render(t)}}):null]})},$9e=({onStop:e,className:t,size:n="icon",variant:r="ghost","aria-label":s="Stop Generation"})=>f.jsx(Dn,{tooltipText:"Stop",onClick:e,"aria-label":s,icon:f.jsx(Tge,{}),variant:r,size:n,className:t}),z9e=Symbol("Let zodToJsonSchema decide on which parser to use"),OU={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",allowedAdditionalProperties:!0,rejectedAdditionalProperties:!1,definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"},U9e=e=>typeof e=="string"?{...OU,name:e}:{...OU,...e},q9e=e=>{const t=U9e(e),n=t.name!==void 0?[...t.basePath,t.definitionPath,t.name]:t.basePath;return{...t,currentPath:n,propertyPath:void 0,seen:new Map(Object.entries(t.definitions).map(([r,s])=>[s._def,{def:s._def,path:[...t.basePath,t.definitionPath,r],jsonSchema:void 0}]))}};function Sre(e,t,n,r){r!=null&&r.errorMessages&&n&&(e.errorMessage={...e.errorMessage,[t]:n})}function xs(e,t,n,r,s){e[t]=n,Sre(e,t,r,s)}function V9e(){return{}}function W9e(e,t){var r,s,i;const n={type:"array"};return(r=e.type)!=null&&r._def&&((i=(s=e.type)==null?void 0:s._def)==null?void 0:i.typeName)!==Qt.ZodAny&&(n.items=ls(e.type._def,{...t,currentPath:[...t.currentPath,"items"]})),e.minLength&&xs(n,"minItems",e.minLength.value,e.minLength.message,t),e.maxLength&&xs(n,"maxItems",e.maxLength.value,e.maxLength.message,t),e.exactLength&&(xs(n,"minItems",e.exactLength.value,e.exactLength.message,t),xs(n,"maxItems",e.exactLength.value,e.exactLength.message,t)),n}function H9e(e,t){const n={type:"integer",format:"int64"};if(!e.checks)return n;for(const r of e.checks)switch(r.kind){case"min":t.target==="jsonSchema7"?r.inclusive?xs(n,"minimum",r.value,r.message,t):xs(n,"exclusiveMinimum",r.value,r.message,t):(r.inclusive||(n.exclusiveMinimum=!0),xs(n,"minimum",r.value,r.message,t));break;case"max":t.target==="jsonSchema7"?r.inclusive?xs(n,"maximum",r.value,r.message,t):xs(n,"exclusiveMaximum",r.value,r.message,t):(r.inclusive||(n.exclusiveMaximum=!0),xs(n,"maximum",r.value,r.message,t));break;case"multipleOf":xs(n,"multipleOf",r.value,r.message,t);break}return n}function G9e(){return{type:"boolean"}}function Cre(e,t){return ls(e.type._def,t)}const K9e=(e,t)=>ls(e.innerType._def,t);function kre(e,t,n){const r=n??t.dateStrategy;if(Array.isArray(r))return{anyOf:r.map((s,i)=>kre(e,t,s))};switch(r){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return Y9e(e,t)}}const Y9e=(e,t)=>{const n={type:"integer",format:"unix-time"};if(t.target==="openApi3")return n;for(const r of e.checks)switch(r.kind){case"min":xs(n,"minimum",r.value,r.message,t);break;case"max":xs(n,"maximum",r.value,r.message,t);break}return n};function Z9e(e,t){return{...ls(e.innerType._def,t),default:e.defaultValue()}}function X9e(e,t){return t.effectStrategy==="input"?ls(e.schema._def,t):{}}function J9e(e){return{type:"string",enum:Array.from(e.values)}}const Q9e=e=>"type"in e&&e.type==="string"?!1:"allOf"in e;function eze(e,t){const n=[ls(e.left._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),ls(e.right._def,{...t,currentPath:[...t.currentPath,"allOf","1"]})].filter(i=>!!i);let r=t.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0;const s=[];return n.forEach(i=>{if(Q9e(i))s.push(...i.allOf),i.unevaluatedProperties===void 0&&(r=void 0);else{let a=i;if("additionalProperties"in i&&i.additionalProperties===!1){const{additionalProperties:o,...l}=i;a=l}else r=void 0;s.push(a)}}),s.length?{allOf:s,...r}:void 0}function tze(e,t){const n=typeof e.value;return n!=="bigint"&&n!=="number"&&n!=="boolean"&&n!=="string"?{type:Array.isArray(e.value)?"array":"object"}:t.target==="openApi3"?{type:n==="bigint"?"integer":n,enum:[e.value]}:{type:n==="bigint"?"integer":n,const:e.value}}let DI;const dc={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(DI===void 0&&(DI=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),DI),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv4Cidr:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,ipv6Cidr:/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,base64url:/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/,jwt:/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/};function Ere(e,t){const n={type:"string"};if(e.checks)for(const r of e.checks)switch(r.kind){case"min":xs(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,r.value):r.value,r.message,t);break;case"max":xs(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,r.value):r.value,r.message,t);break;case"email":switch(t.emailStrategy){case"format:email":fc(n,"email",r.message,t);break;case"format:idn-email":fc(n,"idn-email",r.message,t);break;case"pattern:zod":Za(n,dc.email,r.message,t);break}break;case"url":fc(n,"uri",r.message,t);break;case"uuid":fc(n,"uuid",r.message,t);break;case"regex":Za(n,r.regex,r.message,t);break;case"cuid":Za(n,dc.cuid,r.message,t);break;case"cuid2":Za(n,dc.cuid2,r.message,t);break;case"startsWith":Za(n,RegExp(`^${FI(r.value,t)}`),r.message,t);break;case"endsWith":Za(n,RegExp(`${FI(r.value,t)}$`),r.message,t);break;case"datetime":fc(n,"date-time",r.message,t);break;case"date":fc(n,"date",r.message,t);break;case"time":fc(n,"time",r.message,t);break;case"duration":fc(n,"duration",r.message,t);break;case"length":xs(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,r.value):r.value,r.message,t),xs(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,r.value):r.value,r.message,t);break;case"includes":{Za(n,RegExp(FI(r.value,t)),r.message,t);break}case"ip":{r.version!=="v6"&&fc(n,"ipv4",r.message,t),r.version!=="v4"&&fc(n,"ipv6",r.message,t);break}case"base64url":Za(n,dc.base64url,r.message,t);break;case"jwt":Za(n,dc.jwt,r.message,t);break;case"cidr":{r.version!=="v6"&&Za(n,dc.ipv4Cidr,r.message,t),r.version!=="v4"&&Za(n,dc.ipv6Cidr,r.message,t);break}case"emoji":Za(n,dc.emoji(),r.message,t);break;case"ulid":{Za(n,dc.ulid,r.message,t);break}case"base64":{switch(t.base64Strategy){case"format:binary":{fc(n,"binary",r.message,t);break}case"contentEncoding:base64":{xs(n,"contentEncoding","base64",r.message,t);break}case"pattern:zod":{Za(n,dc.base64,r.message,t);break}}break}case"nanoid":Za(n,dc.nanoid,r.message,t)}return n}function FI(e,t){return t.patternStrategy==="escape"?rze(e):e}const nze=new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function rze(e){let t="";for(let n=0;n<e.length;n++)nze.has(e[n])||(t+="\\"),t+=e[n];return t}function fc(e,t,n,r){var s;e.format||(s=e.anyOf)!=null&&s.some(i=>i.format)?(e.anyOf||(e.anyOf=[]),e.format&&(e.anyOf.push({format:e.format,...e.errorMessage&&r.errorMessages&&{errorMessage:{format:e.errorMessage.format}}}),delete e.format,e.errorMessage&&(delete e.errorMessage.format,Object.keys(e.errorMessage).length===0&&delete e.errorMessage)),e.anyOf.push({format:t,...n&&r.errorMessages&&{errorMessage:{format:n}}})):xs(e,"format",t,n,r)}function Za(e,t,n,r){var s;e.pattern||(s=e.allOf)!=null&&s.some(i=>i.pattern)?(e.allOf||(e.allOf=[]),e.pattern&&(e.allOf.push({pattern:e.pattern,...e.errorMessage&&r.errorMessages&&{errorMessage:{pattern:e.errorMessage.pattern}}}),delete e.pattern,e.errorMessage&&(delete e.errorMessage.pattern,Object.keys(e.errorMessage).length===0&&delete e.errorMessage)),e.allOf.push({pattern:DU(t,r),...n&&r.errorMessages&&{errorMessage:{pattern:n}}})):xs(e,"pattern",DU(t,r),n,r)}function DU(e,t){var l;if(!t.applyRegexFlags||!e.flags)return e.source;const n={i:e.flags.includes("i"),m:e.flags.includes("m"),s:e.flags.includes("s")},r=n.i?e.source.toLowerCase():e.source;let s="",i=!1,a=!1,o=!1;for(let c=0;c<r.length;c++){if(i){s+=r[c],i=!1;continue}if(n.i){if(a){if(r[c].match(/[a-z]/)){o?(s+=r[c],s+=`${r[c-2]}-${r[c]}`.toUpperCase(),o=!1):r[c+1]==="-"&&((l=r[c+2])!=null&&l.match(/[a-z]/))?(s+=r[c],o=!0):s+=`${r[c]}${r[c].toUpperCase()}`;continue}}else if(r[c].match(/[a-z]/)){s+=`[${r[c]}${r[c].toUpperCase()}]`;continue}}if(n.m){if(r[c]==="^"){s+=`(^|(?<=[\r
]))`;continue}else if(r[c]==="$"){s+=`($|(?=[\r
]))`;continue}}if(n.s&&r[c]==="."){s+=a?`${r[c]}\r
`:`[${r[c]}\r
]`;continue}s+=r[c],r[c]==="\\"?i=!0:a&&r[c]==="]"?a=!1:!a&&r[c]==="["&&(a=!0)}try{new RegExp(s)}catch{return console.warn(`Could not convert regex pattern at ${t.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),e.source}return s}function Tre(e,t){var r,s,i,a,o,l;if(t.target==="openAi"&&console.warn("Warning: OpenAI may not support records in schemas! Try an array of key-value pairs instead."),t.target==="openApi3"&&((r=e.keyType)==null?void 0:r._def.typeName)===Qt.ZodEnum)return{type:"object",required:e.keyType._def.values,properties:e.keyType._def.values.reduce((c,u)=>({...c,[u]:ls(e.valueType._def,{...t,currentPath:[...t.currentPath,"properties",u]})??{}}),{}),additionalProperties:t.rejectedAdditionalProperties};const n={type:"object",additionalProperties:ls(e.valueType._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??t.allowedAdditionalProperties};if(t.target==="openApi3")return n;if(((s=e.keyType)==null?void 0:s._def.typeName)===Qt.ZodString&&((i=e.keyType._def.checks)!=null&&i.length)){const{type:c,...u}=Ere(e.keyType._def,t);return{...n,propertyNames:u}}else{if(((a=e.keyType)==null?void 0:a._def.typeName)===Qt.ZodEnum)return{...n,propertyNames:{enum:e.keyType._def.values}};if(((o=e.keyType)==null?void 0:o._def.typeName)===Qt.ZodBranded&&e.keyType._def.type._def.typeName===Qt.ZodString&&((l=e.keyType._def.type._def.checks)!=null&&l.length)){const{type:c,...u}=Cre(e.keyType._def,t);return{...n,propertyNames:u}}}return n}function sze(e,t){if(t.mapStrategy==="record")return Tre(e,t);const n=ls(e.keyType._def,{...t,currentPath:[...t.currentPath,"items","items","0"]})||{},r=ls(e.valueType._def,{...t,currentPath:[...t.currentPath,"items","items","1"]})||{};return{type:"array",maxItems:125,items:{type:"array",items:[n,r],minItems:2,maxItems:2}}}function ize(e){const t=e.values,r=Object.keys(e.values).filter(i=>typeof t[t[i]]!="number").map(i=>t[i]),s=Array.from(new Set(r.map(i=>typeof i)));return{type:s.length===1?s[0]==="string"?"string":"number":["string","number"],enum:r}}function aze(){return{not:{}}}function oze(e){return e.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}const Lk={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function lze(e,t){if(t.target==="openApi3")return FU(e,t);const n=e.options instanceof Map?Array.from(e.options.values()):e.options;if(n.every(r=>r._def.typeName in Lk&&(!r._def.checks||!r._def.checks.length))){const r=n.reduce((s,i)=>{const a=Lk[i._def.typeName];return a&&!s.includes(a)?[...s,a]:s},[]);return{type:r.length>1?r:r[0]}}else if(n.every(r=>r._def.typeName==="ZodLiteral"&&!r.description)){const r=n.reduce((s,i)=>{const a=typeof i._def.value;switch(a){case"string":case"number":case"boolean":return[...s,a];case"bigint":return[...s,"integer"];case"object":if(i._def.value===null)return[...s,"null"];case"symbol":case"undefined":case"function":default:return s}},[]);if(r.length===n.length){const s=r.filter((i,a,o)=>o.indexOf(i)===a);return{type:s.length>1?s:s[0],enum:n.reduce((i,a)=>i.includes(a._def.value)?i:[...i,a._def.value],[])}}}else if(n.every(r=>r._def.typeName==="ZodEnum"))return{type:"string",enum:n.reduce((r,s)=>[...r,...s._def.values.filter(i=>!r.includes(i))],[])};return FU(e,t)}const FU=(e,t)=>{const n=(e.options instanceof Map?Array.from(e.options.values()):e.options).map((r,s)=>ls(r._def,{...t,currentPath:[...t.currentPath,"anyOf",`${s}`]})).filter(r=>!!r&&(!t.strictUnions||typeof r=="object"&&Object.keys(r).length>0));return n.length?{anyOf:n}:void 0};function cze(e,t){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(e.innerType._def.typeName)&&(!e.innerType._def.checks||!e.innerType._def.checks.length))return t.target==="openApi3"?{type:Lk[e.innerType._def.typeName],nullable:!0}:{type:[Lk[e.innerType._def.typeName],"null"]};if(t.target==="openApi3"){const r=ls(e.innerType._def,{...t,currentPath:[...t.currentPath]});return r&&"$ref"in r?{allOf:[r],nullable:!0}:r&&{...r,nullable:!0}}const n=ls(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","0"]});return n&&{anyOf:[n,{type:"null"}]}}function uze(e,t){const n={type:"number"};if(!e.checks)return n;for(const r of e.checks)switch(r.kind){case"int":n.type="integer",Sre(n,"type",r.message,t);break;case"min":t.target==="jsonSchema7"?r.inclusive?xs(n,"minimum",r.value,r.message,t):xs(n,"exclusiveMinimum",r.value,r.message,t):(r.inclusive||(n.exclusiveMinimum=!0),xs(n,"minimum",r.value,r.message,t));break;case"max":t.target==="jsonSchema7"?r.inclusive?xs(n,"maximum",r.value,r.message,t):xs(n,"exclusiveMaximum",r.value,r.message,t):(r.inclusive||(n.exclusiveMaximum=!0),xs(n,"maximum",r.value,r.message,t));break;case"multipleOf":xs(n,"multipleOf",r.value,r.message,t);break}return n}function dze(e,t){const n=t.target==="openAi",r={type:"object",properties:{}},s=[],i=e.shape();for(const o in i){let l=i[o];if(l===void 0||l._def===void 0)continue;let c=hze(l);c&&n&&(l instanceof _u&&(l=l._def.innerType),l.isNullable()||(l=l.nullable()),c=!1);const u=ls(l._def,{...t,currentPath:[...t.currentPath,"properties",o],propertyPath:[...t.currentPath,"properties",o]});u!==void 0&&(r.properties[o]=u,c||s.push(o))}s.length&&(r.required=s);const a=fze(e,t);return a!==void 0&&(r.additionalProperties=a),r}function fze(e,t){if(e.catchall._def.typeName!=="ZodNever")return ls(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]});switch(e.unknownKeys){case"passthrough":return t.allowedAdditionalProperties;case"strict":return t.rejectedAdditionalProperties;case"strip":return t.removeAdditionalStrategy==="strict"?t.allowedAdditionalProperties:t.rejectedAdditionalProperties}}function hze(e){try{return e.isOptional()}catch{return!0}}const pze=(e,t)=>{var r;if(t.currentPath.toString()===((r=t.propertyPath)==null?void 0:r.toString()))return ls(e.innerType._def,t);const n=ls(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","1"]});return n?{anyOf:[{not:{}},n]}:{}},mze=(e,t)=>{if(t.pipeStrategy==="input")return ls(e.in._def,t);if(t.pipeStrategy==="output")return ls(e.out._def,t);const n=ls(e.in._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),r=ls(e.out._def,{...t,currentPath:[...t.currentPath,"allOf",n?"1":"0"]});return{allOf:[n,r].filter(s=>s!==void 0)}};function gze(e,t){return ls(e.type._def,t)}function yze(e,t){const r={type:"array",uniqueItems:!0,items:ls(e.valueType._def,{...t,currentPath:[...t.currentPath,"items"]})};return e.minSize&&xs(r,"minItems",e.minSize.value,e.minSize.message,t),e.maxSize&&xs(r,"maxItems",e.maxSize.value,e.maxSize.message,t),r}function bze(e,t){return e.rest?{type:"array",minItems:e.items.length,items:e.items.map((n,r)=>ls(n._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[]),additionalItems:ls(e.rest._def,{...t,currentPath:[...t.currentPath,"additionalItems"]})}:{type:"array",minItems:e.items.length,maxItems:e.items.length,items:e.items.map((n,r)=>ls(n._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[])}}function vze(){return{not:{}}}function xze(){return{}}const wze=(e,t)=>ls(e.innerType._def,t),_ze=(e,t,n)=>{switch(t){case Qt.ZodString:return Ere(e,n);case Qt.ZodNumber:return uze(e,n);case Qt.ZodObject:return dze(e,n);case Qt.ZodBigInt:return H9e(e,n);case Qt.ZodBoolean:return G9e();case Qt.ZodDate:return kre(e,n);case Qt.ZodUndefined:return vze();case Qt.ZodNull:return oze(n);case Qt.ZodArray:return W9e(e,n);case Qt.ZodUnion:case Qt.ZodDiscriminatedUnion:return lze(e,n);case Qt.ZodIntersection:return eze(e,n);case Qt.ZodTuple:return bze(e,n);case Qt.ZodRecord:return Tre(e,n);case Qt.ZodLiteral:return tze(e,n);case Qt.ZodEnum:return J9e(e);case Qt.ZodNativeEnum:return ize(e);case Qt.ZodNullable:return cze(e,n);case Qt.ZodOptional:return pze(e,n);case Qt.ZodMap:return sze(e,n);case Qt.ZodSet:return yze(e,n);case Qt.ZodLazy:return()=>e.getter()._def;case Qt.ZodPromise:return gze(e,n);case Qt.ZodNaN:case Qt.ZodNever:return aze();case Qt.ZodEffects:return X9e(e,n);case Qt.ZodAny:return V9e();case Qt.ZodUnknown:return xze();case Qt.ZodDefault:return Z9e(e,n);case Qt.ZodBranded:return Cre(e,n);case Qt.ZodReadonly:return wze(e,n);case Qt.ZodCatch:return K9e(e,n);case Qt.ZodPipeline:return mze(e,n);case Qt.ZodFunction:case Qt.ZodVoid:case Qt.ZodSymbol:return;default:return(r=>{})()}};function ls(e,t,n=!1){var o;const r=t.seen.get(e);if(t.override){const l=(o=t.override)==null?void 0:o.call(t,e,t,r,n);if(l!==z9e)return l}if(r&&!n){const l=Sze(r,t);if(l!==void 0)return l}const s={def:e,path:t.currentPath,jsonSchema:void 0};t.seen.set(e,s);const i=_ze(e,e.typeName,t),a=typeof i=="function"?ls(i(),t):i;if(a&&kze(e,t,a),t.postProcess){const l=t.postProcess(a,e,t);return s.jsonSchema=a,l}return s.jsonSchema=a,a}const Sze=(e,t)=>{switch(t.$refStrategy){case"root":return{$ref:e.path.join("/")};case"relative":return{$ref:Cze(t.currentPath,e.path)};case"none":case"seen":return e.path.length<t.currentPath.length&&e.path.every((n,r)=>t.currentPath[r]===n)?(console.warn(`Recursive reference detected at ${t.currentPath.join("/")}! Defaulting to any`),{}):t.$refStrategy==="seen"?{}:void 0}},Cze=(e,t)=>{let n=0;for(;n<e.length&&n<t.length&&e[n]===t[n];n++);return[(e.length-n).toString(),...t.slice(n)].join("/")},kze=(e,t,n)=>(e.description&&(n.description=e.description,t.markdownDescription&&(n.markdownDescription=e.description)),n),Eze=(e,t)=>{const n=q9e(t),r=typeof t=="object"&&t.definitions?Object.entries(t.definitions).reduce((l,[c,u])=>({...l,[c]:ls(u._def,{...n,currentPath:[...n.basePath,n.definitionPath,c]},!0)??{}}),{}):void 0,s=typeof t=="string"?t:(t==null?void 0:t.nameStrategy)==="title"||t==null?void 0:t.name,i=ls(e._def,s===void 0?n:{...n,currentPath:[...n.basePath,n.definitionPath,s]},!1)??{},a=typeof t=="object"&&t.name!==void 0&&t.nameStrategy==="title"?t.name:void 0;a!==void 0&&(i.title=a);const o=s===void 0?r?{...i,[n.definitionPath]:r}:i:{$ref:[...n.$refStrategy==="relative"?[]:n.basePath,n.definitionPath,s].join("/"),[n.definitionPath]:{...r,[s]:i}};return n.target==="jsonSchema7"?o.$schema="http://json-schema.org/draft-07/schema#":(n.target==="jsonSchema2019-09"||n.target==="openAi")&&(o.$schema="https://json-schema.org/draft/2019-09/schema#"),n.target==="openAi"&&("anyOf"in o||"oneOf"in o||"allOf"in o||"type"in o&&Array.isArray(o.type))&&console.warn("Warning: OpenAI may not support schemas with unions as roots! Try wrapping it in an object property."),o};var jw={code:"0",name:"text",parse:e=>{if(typeof e!="string")throw new Error('"text" parts expect a string value.');return{type:"text",value:e}}},Pw={code:"3",name:"error",parse:e=>{if(typeof e!="string")throw new Error('"error" parts expect a string value.');return{type:"error",value:e}}},Ow={code:"4",name:"assistant_message",parse:e=>{if(e==null||typeof e!="object"||!("id"in e)||!("role"in e)||!("content"in e)||typeof e.id!="string"||typeof e.role!="string"||e.role!=="assistant"||!Array.isArray(e.content)||!e.content.every(t=>t!=null&&typeof t=="object"&&"type"in t&&t.type==="text"&&"text"in t&&t.text!=null&&typeof t.text=="object"&&"value"in t.text&&typeof t.text.value=="string"))throw new Error('"assistant_message" parts expect an object with an "id", "role", and "content" property.');return{type:"assistant_message",value:e}}},Dw={code:"5",name:"assistant_control_data",parse:e=>{if(e==null||typeof e!="object"||!("threadId"in e)||!("messageId"in e)||typeof e.threadId!="string"||typeof e.messageId!="string")throw new Error('"assistant_control_data" parts expect an object with a "threadId" and "messageId" property.');return{type:"assistant_control_data",value:{threadId:e.threadId,messageId:e.messageId}}}},Fw={code:"6",name:"data_message",parse:e=>{if(e==null||typeof e!="object"||!("role"in e)||!("data"in e)||typeof e.role!="string"||e.role!=="data")throw new Error('"data_message" parts expect an object with a "role" and "data" property.');return{type:"data_message",value:e}}},Tze=[jw,Pw,Ow,Dw,Fw];jw.code+"",Pw.code+"",Ow.code+"",Dw.code+"",Fw.code+"";jw.name+"",jw.code,Pw.name+"",Pw.code,Ow.name+"",Ow.code,Dw.name+"",Dw.code,Fw.name+"",Fw.code;Tze.map(e=>e.code);function Aze(e){const t=["ROOT"];let n=-1,r=null;function s(l,c,u){switch(l){case'"':{n=c,t.pop(),t.push(u),t.push("INSIDE_STRING");break}case"f":case"t":case"n":{n=c,r=c,t.pop(),t.push(u),t.push("INSIDE_LITERAL");break}case"-":{t.pop(),t.push(u),t.push("INSIDE_NUMBER");break}case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":{n=c,t.pop(),t.push(u),t.push("INSIDE_NUMBER");break}case"{":{n=c,t.pop(),t.push(u),t.push("INSIDE_OBJECT_START");break}case"[":{n=c,t.pop(),t.push(u),t.push("INSIDE_ARRAY_START");break}}}function i(l,c){switch(l){case",":{t.pop(),t.push("INSIDE_OBJECT_AFTER_COMMA");break}case"}":{n=c,t.pop();break}}}function a(l,c){switch(l){case",":{t.pop(),t.push("INSIDE_ARRAY_AFTER_COMMA");break}case"]":{n=c,t.pop();break}}}for(let l=0;l<e.length;l++){const c=e[l];switch(t[t.length-1]){case"ROOT":s(c,l,"FINISH");break;case"INSIDE_OBJECT_START":{switch(c){case'"':{t.pop(),t.push("INSIDE_OBJECT_KEY");break}case"}":{n=l,t.pop();break}}break}case"INSIDE_OBJECT_AFTER_COMMA":{switch(c){case'"':{t.pop(),t.push("INSIDE_OBJECT_KEY");break}}break}case"INSIDE_OBJECT_KEY":{switch(c){case'"':{t.pop(),t.push("INSIDE_OBJECT_AFTER_KEY");break}}break}case"INSIDE_OBJECT_AFTER_KEY":{switch(c){case":":{t.pop(),t.push("INSIDE_OBJECT_BEFORE_VALUE");break}}break}case"INSIDE_OBJECT_BEFORE_VALUE":{s(c,l,"INSIDE_OBJECT_AFTER_VALUE");break}case"INSIDE_OBJECT_AFTER_VALUE":{i(c,l);break}case"INSIDE_STRING":{switch(c){case'"':{t.pop(),n=l;break}case"\\":{t.push("INSIDE_STRING_ESCAPE");break}default:n=l}break}case"INSIDE_ARRAY_START":{switch(c){case"]":{n=l,t.pop();break}default:{n=l,s(c,l,"INSIDE_ARRAY_AFTER_VALUE");break}}break}case"INSIDE_ARRAY_AFTER_VALUE":{switch(c){case",":{t.pop(),t.push("INSIDE_ARRAY_AFTER_COMMA");break}case"]":{n=l,t.pop();break}default:{n=l;break}}break}case"INSIDE_ARRAY_AFTER_COMMA":{s(c,l,"INSIDE_ARRAY_AFTER_VALUE");break}case"INSIDE_STRING_ESCAPE":{t.pop(),n=l;break}case"INSIDE_NUMBER":{switch(c){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":{n=l;break}case"e":case"E":case"-":case".":break;case",":{t.pop(),t[t.length-1]==="INSIDE_ARRAY_AFTER_VALUE"&&a(c,l),t[t.length-1]==="INSIDE_OBJECT_AFTER_VALUE"&&i(c,l);break}case"}":{t.pop(),t[t.length-1]==="INSIDE_OBJECT_AFTER_VALUE"&&i(c,l);break}case"]":{t.pop(),t[t.length-1]==="INSIDE_ARRAY_AFTER_VALUE"&&a(c,l);break}default:{t.pop();break}}break}case"INSIDE_LITERAL":{const d=e.substring(r,l+1);!"false".startsWith(d)&&!"true".startsWith(d)&&!"null".startsWith(d)?(t.pop(),t[t.length-1]==="INSIDE_OBJECT_AFTER_VALUE"?i(c,l):t[t.length-1]==="INSIDE_ARRAY_AFTER_VALUE"&&a(c,l)):n=l;break}}}let o=e.slice(0,n+1);for(let l=t.length-1;l>=0;l--)switch(t[l]){case"INSIDE_STRING":{o+='"';break}case"INSIDE_OBJECT_KEY":case"INSIDE_OBJECT_AFTER_KEY":case"INSIDE_OBJECT_AFTER_COMMA":case"INSIDE_OBJECT_START":case"INSIDE_OBJECT_BEFORE_VALUE":case"INSIDE_OBJECT_AFTER_VALUE":{o+="}";break}case"INSIDE_ARRAY_START":case"INSIDE_ARRAY_AFTER_COMMA":case"INSIDE_ARRAY_AFTER_VALUE":{o+="]";break}case"INSIDE_LITERAL":{const u=e.substring(r,e.length);"true".startsWith(u)?o+="true".slice(u.length):"false".startsWith(u)?o+="false".slice(u.length):"null".startsWith(u)&&(o+="null".slice(u.length))}}return o}function Rze(e){if(e===void 0)return{value:void 0,state:"undefined-input"};let t=vm({text:e});return t.success?{value:t.value,state:"successful-parse"}:(t=vm({text:Aze(e)}),t.success?{value:t.value,state:"repaired-parse"}:{value:void 0,state:"failed-parse"})}var Nze={code:"0",name:"text",parse:e=>{if(typeof e!="string")throw new Error('"text" parts expect a string value.');return{type:"text",value:e}}},Mze={code:"2",name:"data",parse:e=>{if(!Array.isArray(e))throw new Error('"data" parts expect an array value.');return{type:"data",value:e}}},Ize={code:"3",name:"error",parse:e=>{if(typeof e!="string")throw new Error('"error" parts expect a string value.');return{type:"error",value:e}}},jze={code:"8",name:"message_annotations",parse:e=>{if(!Array.isArray(e))throw new Error('"message_annotations" parts expect an array value.');return{type:"message_annotations",value:e}}},Pze={code:"9",name:"tool_call",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("toolName"in e)||typeof e.toolName!="string"||!("args"in e)||typeof e.args!="object")throw new Error('"tool_call" parts expect an object with a "toolCallId", "toolName", and "args" property.');return{type:"tool_call",value:e}}},Oze={code:"a",name:"tool_result",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("result"in e))throw new Error('"tool_result" parts expect an object with a "toolCallId" and a "result" property.');return{type:"tool_result",value:e}}},Dze={code:"b",name:"tool_call_streaming_start",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("toolName"in e)||typeof e.toolName!="string")throw new Error('"tool_call_streaming_start" parts expect an object with a "toolCallId" and "toolName" property.');return{type:"tool_call_streaming_start",value:e}}},Fze={code:"c",name:"tool_call_delta",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("argsTextDelta"in e)||typeof e.argsTextDelta!="string")throw new Error('"tool_call_delta" parts expect an object with a "toolCallId" and "argsTextDelta" property.');return{type:"tool_call_delta",value:e}}},Lze={code:"d",name:"finish_message",parse:e=>{if(e==null||typeof e!="object"||!("finishReason"in e)||typeof e.finishReason!="string")throw new Error('"finish_message" parts expect an object with a "finishReason" property.');const t={finishReason:e.finishReason};return"usage"in e&&e.usage!=null&&typeof e.usage=="object"&&"promptTokens"in e.usage&&"completionTokens"in e.usage&&(t.usage={promptTokens:typeof e.usage.promptTokens=="number"?e.usage.promptTokens:Number.NaN,completionTokens:typeof e.usage.completionTokens=="number"?e.usage.completionTokens:Number.NaN}),{type:"finish_message",value:t}}},Bze={code:"e",name:"finish_step",parse:e=>{if(e==null||typeof e!="object"||!("finishReason"in e)||typeof e.finishReason!="string")throw new Error('"finish_step" parts expect an object with a "finishReason" property.');const t={finishReason:e.finishReason,isContinued:!1};return"usage"in e&&e.usage!=null&&typeof e.usage=="object"&&"promptTokens"in e.usage&&"completionTokens"in e.usage&&(t.usage={promptTokens:typeof e.usage.promptTokens=="number"?e.usage.promptTokens:Number.NaN,completionTokens:typeof e.usage.completionTokens=="number"?e.usage.completionTokens:Number.NaN}),"isContinued"in e&&typeof e.isContinued=="boolean"&&(t.isContinued=e.isContinued),{type:"finish_step",value:t}}},$ze={code:"f",name:"start_step",parse:e=>{if(e==null||typeof e!="object"||!("messageId"in e)||typeof e.messageId!="string")throw new Error('"start_step" parts expect an object with an "id" property.');return{type:"start_step",value:{messageId:e.messageId}}}},zze={code:"g",name:"reasoning",parse:e=>{if(typeof e!="string")throw new Error('"reasoning" parts expect a string value.');return{type:"reasoning",value:e}}},Uze={code:"h",name:"source",parse:e=>{if(e==null||typeof e!="object")throw new Error('"source" parts expect a Source object.');return{type:"source",value:e}}},qze={code:"i",name:"redacted_reasoning",parse:e=>{if(e==null||typeof e!="object"||!("data"in e)||typeof e.data!="string")throw new Error('"redacted_reasoning" parts expect an object with a "data" property.');return{type:"redacted_reasoning",value:{data:e.data}}}},Vze={code:"j",name:"reasoning_signature",parse:e=>{if(e==null||typeof e!="object"||!("signature"in e)||typeof e.signature!="string")throw new Error('"reasoning_signature" parts expect an object with a "signature" property.');return{type:"reasoning_signature",value:{signature:e.signature}}}},Wze={code:"k",name:"file",parse:e=>{if(e==null||typeof e!="object"||!("data"in e)||typeof e.data!="string"||!("mimeType"in e)||typeof e.mimeType!="string")throw new Error('"file" parts expect an object with a "data" and "mimeType" property.');return{type:"file",value:e}}},LT=[Nze,Mze,Ize,jze,Pze,Oze,Dze,Fze,Lze,Bze,$ze,zze,Uze,qze,Vze,Wze];Object.fromEntries(LT.map(e=>[e.code,e]));Object.fromEntries(LT.map(e=>[e.name,e.code]));LT.map(e=>e.code);function Aa(e,t){const n=LT.find(r=>r.name===e);if(!n)throw new Error(`Invalid stream part type: ${e}`);return`${n.code}:${JSON.stringify(t)}
`}function Hze(e,t){var n;const r=(n=void 0)!=null?n:!1;return Are(Eze(e,{$refStrategy:r?"root":"none",target:"jsonSchema7"}),{validate:s=>{const i=e.safeParse(s);return i.success?{success:!0,value:i.data}:{success:!1,error:i.error}}})}var N4=Symbol.for("vercel.ai.schema");function Are(e,{validate:t}={}){return{[N4]:!0,_type:void 0,[cC]:!0,jsonSchema:e,validate:t}}function Gze(e){return typeof e=="object"&&e!==null&&N4 in e&&e[N4]===!0&&"jsonSchema"in e&&"validate"in e}function BT(e){return Gze(e)?e:Hze(e)}var Kze=typeof globalThis=="object"?globalThis:typeof self=="object"?self:typeof window=="object"?window:typeof y0=="object"?y0:{},im="1.9.0",LU=/^(\d+)\.(\d+)\.(\d+)(-(.+))?$/;function Yze(e){var t=new Set([e]),n=new Set,r=e.match(LU);if(!r)return function(){return!1};var s={major:+r[1],minor:+r[2],patch:+r[3],prerelease:r[4]};if(s.prerelease!=null)return function(l){return l===e};function i(o){return n.add(o),!1}function a(o){return t.add(o),!0}return function(l){if(t.has(l))return!0;if(n.has(l))return!1;var c=l.match(LU);if(!c)return i(l);var u={major:+c[1],minor:+c[2],patch:+c[3],prerelease:c[4]};return u.prerelease!=null||s.major!==u.major?i(l):s.major===0?s.minor===u.minor&&s.patch<=u.patch?a(l):i(l):s.minor<=u.minor?a(l):i(l)}}var Zze=Yze(im),Xze=im.split(".")[0],Lw=Symbol.for("opentelemetry.js.api."+Xze),Bw=Kze;function C6(e,t,n,r){var s;r===void 0&&(r=!1);var i=Bw[Lw]=(s=Bw[Lw])!==null&&s!==void 0?s:{version:im};if(!r&&i[e]){var a=new Error("@opentelemetry/api: Attempted duplicate registration of API: "+e);return n.error(a.stack||a.message),!1}if(i.version!==im){var a=new Error("@opentelemetry/api: Registration of version v"+i.version+" for "+e+" does not match previously registered API v"+im);return n.error(a.stack||a.message),!1}return i[e]=t,n.debug("@opentelemetry/api: Registered a global for "+e+" v"+im+"."),!0}function $w(e){var t,n,r=(t=Bw[Lw])===null||t===void 0?void 0:t.version;if(!(!r||!Zze(r)))return(n=Bw[Lw])===null||n===void 0?void 0:n[e]}function k6(e,t){t.debug("@opentelemetry/api: Unregistering a global for "+e+" v"+im+".");var n=Bw[Lw];n&&delete n[e]}var Jze=function(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),s,i=[],a;try{for(;(t===void 0||t-- >0)&&!(s=r.next()).done;)i.push(s.value)}catch(o){a={error:o}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(a)throw a.error}}return i},Qze=function(e,t,n){if(n||arguments.length===2)for(var r=0,s=t.length,i;r<s;r++)(i||!(r in t))&&(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))},e7e=function(){function e(t){this._namespace=t.namespace||"DiagComponentLogger"}return e.prototype.debug=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return Hv("debug",this._namespace,t)},e.prototype.error=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return Hv("error",this._namespace,t)},e.prototype.info=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return Hv("info",this._namespace,t)},e.prototype.warn=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return Hv("warn",this._namespace,t)},e.prototype.verbose=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return Hv("verbose",this._namespace,t)},e}();function Hv(e,t,n){var r=$w("diag");if(r)return n.unshift(t),r[e].apply(r,Qze([],Jze(n),!1))}var nl;(function(e){e[e.NONE=0]="NONE",e[e.ERROR=30]="ERROR",e[e.WARN=50]="WARN",e[e.INFO=60]="INFO",e[e.DEBUG=70]="DEBUG",e[e.VERBOSE=80]="VERBOSE",e[e.ALL=9999]="ALL"})(nl||(nl={}));function t7e(e,t){e<nl.NONE?e=nl.NONE:e>nl.ALL&&(e=nl.ALL),t=t||{};function n(r,s){var i=t[r];return typeof i=="function"&&e>=s?i.bind(t):function(){}}return{error:n("error",nl.ERROR),warn:n("warn",nl.WARN),info:n("info",nl.INFO),debug:n("debug",nl.DEBUG),verbose:n("verbose",nl.VERBOSE)}}var n7e=function(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),s,i=[],a;try{for(;(t===void 0||t-- >0)&&!(s=r.next()).done;)i.push(s.value)}catch(o){a={error:o}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(a)throw a.error}}return i},r7e=function(e,t,n){if(n||arguments.length===2)for(var r=0,s=t.length,i;r<s;r++)(i||!(r in t))&&(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))},s7e="diag",Bk=function(){function e(){function t(s){return function(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];var o=$w("diag");if(o)return o[s].apply(o,r7e([],n7e(i),!1))}}var n=this,r=function(s,i){var a,o,l;if(i===void 0&&(i={logLevel:nl.INFO}),s===n){var c=new Error("Cannot use diag as the logger for itself. Please use a DiagLogger implementation like ConsoleDiagLogger or a custom implementation");return n.error((a=c.stack)!==null&&a!==void 0?a:c.message),!1}typeof i=="number"&&(i={logLevel:i});var u=$w("diag"),d=t7e((o=i.logLevel)!==null&&o!==void 0?o:nl.INFO,s);if(u&&!i.suppressOverrideMessage){var h=(l=new Error().stack)!==null&&l!==void 0?l:"<failed to generate stacktrace>";u.warn("Current logger will be overwritten from "+h),d.warn("Current logger will overwrite one already registered from "+h)}return C6("diag",d,n,!0)};n.setLogger=r,n.disable=function(){k6(s7e,n)},n.createComponentLogger=function(s){return new e7e(s)},n.verbose=t("verbose"),n.debug=t("debug"),n.info=t("info"),n.warn=t("warn"),n.error=t("error")}return e.instance=function(){return this._instance||(this._instance=new e),this._instance},e}();function i7e(e){return Symbol.for(e)}var a7e=function(){function e(t){var n=this;n._currentContext=t?new Map(t):new Map,n.getValue=function(r){return n._currentContext.get(r)},n.setValue=function(r,s){var i=new e(n._currentContext);return i._currentContext.set(r,s),i},n.deleteValue=function(r){var s=new e(n._currentContext);return s._currentContext.delete(r),s}}return e}(),o7e=new a7e,l7e=function(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),s,i=[],a;try{for(;(t===void 0||t-- >0)&&!(s=r.next()).done;)i.push(s.value)}catch(o){a={error:o}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(a)throw a.error}}return i},c7e=function(e,t,n){if(n||arguments.length===2)for(var r=0,s=t.length,i;r<s;r++)(i||!(r in t))&&(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))},u7e=function(){function e(){}return e.prototype.active=function(){return o7e},e.prototype.with=function(t,n,r){for(var s=[],i=3;i<arguments.length;i++)s[i-3]=arguments[i];return n.call.apply(n,c7e([r],l7e(s),!1))},e.prototype.bind=function(t,n){return n},e.prototype.enable=function(){return this},e.prototype.disable=function(){return this},e}(),d7e=function(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),s,i=[],a;try{for(;(t===void 0||t-- >0)&&!(s=r.next()).done;)i.push(s.value)}catch(o){a={error:o}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(a)throw a.error}}return i},f7e=function(e,t,n){if(n||arguments.length===2)for(var r=0,s=t.length,i;r<s;r++)(i||!(r in t))&&(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))},LI="context",h7e=new u7e,Rre=function(){function e(){}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalContextManager=function(t){return C6(LI,t,Bk.instance())},e.prototype.active=function(){return this._getContextManager().active()},e.prototype.with=function(t,n,r){for(var s,i=[],a=3;a<arguments.length;a++)i[a-3]=arguments[a];return(s=this._getContextManager()).with.apply(s,f7e([t,n,r],d7e(i),!1))},e.prototype.bind=function(t,n){return this._getContextManager().bind(t,n)},e.prototype._getContextManager=function(){return $w(LI)||h7e},e.prototype.disable=function(){this._getContextManager().disable(),k6(LI,Bk.instance())},e}(),M4;(function(e){e[e.NONE=0]="NONE",e[e.SAMPLED=1]="SAMPLED"})(M4||(M4={}));var Nre="0000000000000000",Mre="00000000000000000000000000000000",p7e={traceId:Mre,spanId:Nre,traceFlags:M4.NONE},kx=function(){function e(t){t===void 0&&(t=p7e),this._spanContext=t}return e.prototype.spanContext=function(){return this._spanContext},e.prototype.setAttribute=function(t,n){return this},e.prototype.setAttributes=function(t){return this},e.prototype.addEvent=function(t,n){return this},e.prototype.addLink=function(t){return this},e.prototype.addLinks=function(t){return this},e.prototype.setStatus=function(t){return this},e.prototype.updateName=function(t){return this},e.prototype.end=function(t){},e.prototype.isRecording=function(){return!1},e.prototype.recordException=function(t,n){},e}(),E6=i7e("OpenTelemetry Context Key SPAN");function T6(e){return e.getValue(E6)||void 0}function m7e(){return T6(Rre.getInstance().active())}function A6(e,t){return e.setValue(E6,t)}function g7e(e){return e.deleteValue(E6)}function y7e(e,t){return A6(e,new kx(t))}function Ire(e){var t;return(t=T6(e))===null||t===void 0?void 0:t.spanContext()}var b7e=/^([0-9a-f]{32})$/i,v7e=/^[0-9a-f]{16}$/i;function x7e(e){return b7e.test(e)&&e!==Mre}function w7e(e){return v7e.test(e)&&e!==Nre}function jre(e){return x7e(e.traceId)&&w7e(e.spanId)}function _7e(e){return new kx(e)}var BI=Rre.getInstance(),Pre=function(){function e(){}return e.prototype.startSpan=function(t,n,r){r===void 0&&(r=BI.active());var s=!!(n!=null&&n.root);if(s)return new kx;var i=r&&Ire(r);return S7e(i)&&jre(i)?new kx(i):new kx},e.prototype.startActiveSpan=function(t,n,r,s){var i,a,o;if(!(arguments.length<2)){arguments.length===2?o=n:arguments.length===3?(i=n,o=r):(i=n,a=r,o=s);var l=a??BI.active(),c=this.startSpan(t,i,l),u=A6(l,c);return BI.with(u,o,void 0,c)}},e}();function S7e(e){return typeof e=="object"&&typeof e.spanId=="string"&&typeof e.traceId=="string"&&typeof e.traceFlags=="number"}var C7e=new Pre,k7e=function(){function e(t,n,r,s){this._provider=t,this.name=n,this.version=r,this.options=s}return e.prototype.startSpan=function(t,n,r){return this._getTracer().startSpan(t,n,r)},e.prototype.startActiveSpan=function(t,n,r,s){var i=this._getTracer();return Reflect.apply(i.startActiveSpan,i,arguments)},e.prototype._getTracer=function(){if(this._delegate)return this._delegate;var t=this._provider.getDelegateTracer(this.name,this.version,this.options);return t?(this._delegate=t,this._delegate):C7e},e}(),E7e=function(){function e(){}return e.prototype.getTracer=function(t,n,r){return new Pre},e}(),T7e=new E7e,BU=function(){function e(){}return e.prototype.getTracer=function(t,n,r){var s;return(s=this.getDelegateTracer(t,n,r))!==null&&s!==void 0?s:new k7e(this,t,n,r)},e.prototype.getDelegate=function(){var t;return(t=this._delegate)!==null&&t!==void 0?t:T7e},e.prototype.setDelegate=function(t){this._delegate=t},e.prototype.getDelegateTracer=function(t,n,r){var s;return(s=this._delegate)===null||s===void 0?void 0:s.getTracer(t,n,r)},e}(),$k;(function(e){e[e.UNSET=0]="UNSET",e[e.OK=1]="OK",e[e.ERROR=2]="ERROR"})($k||($k={}));var $I="trace",A7e=function(){function e(){this._proxyTracerProvider=new BU,this.wrapSpanContext=_7e,this.isSpanContextValid=jre,this.deleteSpan=g7e,this.getSpan=T6,this.getActiveSpan=m7e,this.getSpanContext=Ire,this.setSpan=A6,this.setSpanContext=y7e}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalTracerProvider=function(t){var n=C6($I,this._proxyTracerProvider,Bk.instance());return n&&this._proxyTracerProvider.setDelegate(t),n},e.prototype.getTracerProvider=function(){return $w($I)||this._proxyTracerProvider},e.prototype.getTracer=function(t,n){return this.getTracerProvider().getTracer(t,n)},e.prototype.disable=function(){k6($I,Bk.instance()),this._proxyTracerProvider=new BU},e}(),R7e=A7e.getInstance(),N7e=Object.defineProperty,R6=(e,t)=>{for(var n in t)N7e(e,n,{get:t[n],enumerable:!0})};function zk(e,{contentType:t,dataStreamVersion:n}){const r=new Headers(e??{});return r.has("Content-Type")||r.set("Content-Type",t),n!==void 0&&r.set("X-Vercel-AI-Data-Stream",n),r}function $U(e,{contentType:t,dataStreamVersion:n}){const r={};if(e!=null)for(const[s,i]of Object.entries(e))r[s]=i;return r["Content-Type"]==null&&(r["Content-Type"]=t),n!==void 0&&(r["X-Vercel-AI-Data-Stream"]=n),r}function zU({response:e,status:t,statusText:n,headers:r,stream:s}){e.writeHead(t??200,n,r);const i=s.getReader();(async()=>{try{for(;;){const{done:o,value:l}=await i.read();if(o)break;e.write(l)}}catch(o){throw o}finally{e.end()}})()}var Ore="AI_InvalidArgumentError",Dre=`vercel.ai.error.${Ore}`,M7e=Symbol.for(Dre),Fre,gc=class extends er{constructor({parameter:e,value:t,message:n}){super({name:Ore,message:`Invalid argument for parameter ${e}: ${n}`}),this[Fre]=!0,this.parameter=e,this.value=t}static isInstance(e){return er.hasMarker(e,Dre)}};Fre=M7e;var Lre="AI_RetryError",Bre=`vercel.ai.error.${Lre}`,I7e=Symbol.for(Bre),$re,UU=class extends er{constructor({message:e,reason:t,errors:n}){super({name:Lre,message:e}),this[$re]=!0,this.reason=t,this.errors=n,this.lastError=n[n.length-1]}static isInstance(e){return er.hasMarker(e,Bre)}};$re=I7e;var j7e=({maxRetries:e=2,initialDelayInMs:t=2e3,backoffFactor:n=2}={})=>async r=>zre(r,{maxRetries:e,delayInMs:t,backoffFactor:n});async function zre(e,{maxRetries:t,delayInMs:n,backoffFactor:r},s=[]){try{return await e()}catch(i){if(C2(i)||t===0)throw i;const a=gye(i),o=[...s,i],l=o.length;if(l>t)throw new UU({message:`Failed after ${l} attempts. Last error: ${a}`,reason:"maxRetriesExceeded",errors:o});if(i instanceof Error&&Wl.isInstance(i)&&i.isRetryable===!0&&l<=t)return await pye(n),zre(e,{maxRetries:t,delayInMs:r*n,backoffFactor:r},o);throw l===1?i:new UU({message:`Failed after ${l} attempts with non-retryable error: '${a}'`,reason:"errorNotRetryable",errors:o})}}function P7e({maxRetries:e}){if(e!=null){if(!Number.isInteger(e))throw new gc({parameter:"maxRetries",value:e,message:"maxRetries must be an integer"});if(e<0)throw new gc({parameter:"maxRetries",value:e,message:"maxRetries must be >= 0"})}const t=e??2;return{maxRetries:t,retry:j7e({maxRetries:t})}}function I4({operationId:e,telemetry:t}){return{"operation.name":`${e}${(t==null?void 0:t.functionId)!=null?` ${t.functionId}`:""}`,"resource.name":t==null?void 0:t.functionId,"ai.operationId":e,"ai.telemetry.functionId":t==null?void 0:t.functionId}}function O7e({model:e,settings:t,telemetry:n,headers:r}){var s;return{"ai.model.provider":e.provider,"ai.model.id":e.modelId,...Object.entries(t).reduce((i,[a,o])=>(i[`ai.settings.${a}`]=o,i),{}),...Object.entries((s=n==null?void 0:n.metadata)!=null?s:{}).reduce((i,[a,o])=>(i[`ai.telemetry.metadata.${a}`]=o,i),{}),...Object.entries(r??{}).reduce((i,[a,o])=>(o!==void 0&&(i[`ai.request.headers.${a}`]=o),i),{})}}var D7e={startSpan(){return QS},startActiveSpan(e,t,n,r){if(typeof t=="function")return t(QS);if(typeof n=="function")return n(QS);if(typeof r=="function")return r(QS)}},QS={spanContext(){return F7e},setAttribute(){return this},setAttributes(){return this},addEvent(){return this},addLink(){return this},addLinks(){return this},setStatus(){return this},updateName(){return this},end(){return this},isRecording(){return!1},recordException(){return this}},F7e={traceId:"",spanId:"",traceFlags:0};function L7e({isEnabled:e=!1,tracer:t}={}){return e?t||R7e.getTracer("ai"):D7e}function j4({name:e,tracer:t,attributes:n,fn:r,endWhenDone:s=!0}){return t.startActiveSpan(e,{attributes:n},async i=>{try{const a=await r(i);return s&&i.end(),a}catch(a){try{a instanceof Error?(i.recordException({name:a.name,message:a.message,stack:a.stack}),i.setStatus({code:$k.ERROR,message:a.message})):i.setStatus({code:$k.ERROR})}finally{i.end()}throw a}})}function b0({telemetry:e,attributes:t}){return(e==null?void 0:e.isEnabled)!==!0?{}:Object.entries(t).reduce((n,[r,s])=>{if(s===void 0)return n;if(typeof s=="object"&&"input"in s&&typeof s.input=="function"){if((e==null?void 0:e.recordInputs)===!1)return n;const i=s.input();return i===void 0?n:{...n,[r]:i}}if(typeof s=="object"&&"output"in s&&typeof s.output=="function"){if((e==null?void 0:e.recordOutputs)===!1)return n;const i=s.output();return i===void 0?n:{...n,[r]:i}}return{...n,[r]:s}},{})}var B7e=class{constructor({data:e,mimeType:t}){const n=e instanceof Uint8Array;this.base64Data=n?void 0:e,this.uint8ArrayData=n?e:void 0,this.mimeType=t}get base64(){return this.base64Data==null&&(this.base64Data=Nu(this.uint8ArrayData)),this.base64Data}get uint8Array(){return this.uint8ArrayData==null&&(this.uint8ArrayData=wE(this.base64Data)),this.uint8ArrayData}},$7e=class extends B7e{constructor(e){super(e),this.type="file"}},z7e=[{mimeType:"image/gif",bytesPrefix:[71,73,70],base64Prefix:"R0lG"},{mimeType:"image/png",bytesPrefix:[137,80,78,71],base64Prefix:"iVBORw"},{mimeType:"image/jpeg",bytesPrefix:[255,216],base64Prefix:"/9j/"},{mimeType:"image/webp",bytesPrefix:[82,73,70,70],base64Prefix:"UklGRg"},{mimeType:"image/bmp",bytesPrefix:[66,77],base64Prefix:"Qk"},{mimeType:"image/tiff",bytesPrefix:[73,73,42,0],base64Prefix:"SUkqAA"},{mimeType:"image/tiff",bytesPrefix:[77,77,0,42],base64Prefix:"TU0AKg"},{mimeType:"image/avif",bytesPrefix:[0,0,0,32,102,116,121,112,97,118,105,102],base64Prefix:"AAAAIGZ0eXBhdmlm"},{mimeType:"image/heic",bytesPrefix:[0,0,0,32,102,116,121,112,104,101,105,99],base64Prefix:"AAAAIGZ0eXBoZWlj"}],U7e=e=>{const t=typeof e=="string"?wE(e):e,n=(t[6]&127)<<21|(t[7]&127)<<14|(t[8]&127)<<7|t[9]&127;return t.slice(n+10)};function q7e(e){return typeof e=="string"&&e.startsWith("SUQz")||typeof e!="string"&&e.length>10&&e[0]===73&&e[1]===68&&e[2]===51?U7e(e):e}function V7e({data:e,signatures:t}){const n=q7e(e);for(const r of t)if(typeof n=="string"?n.startsWith(r.base64Prefix):n.length>=r.bytesPrefix.length&&r.bytesPrefix.every((s,i)=>n[i]===s))return r.mimeType}var Ure="AI_NoObjectGeneratedError",qre=`vercel.ai.error.${Ure}`,W7e=Symbol.for(qre),Vre,qU=class extends er{constructor({message:e="No object generated.",cause:t,text:n,response:r,usage:s,finishReason:i}){super({name:Ure,message:e,cause:t}),this[Vre]=!0,this.text=n,this.response=r,this.usage=s,this.finishReason=i}static isInstance(e){return er.hasMarker(e,qre)}};Vre=W7e;var Wre="AI_DownloadError",Hre=`vercel.ai.error.${Wre}`,H7e=Symbol.for(Hre),Gre,zI=class extends er{constructor({url:e,statusCode:t,statusText:n,cause:r,message:s=r==null?`Failed to download ${e}: ${t} ${n}`:`Failed to download ${e}: ${r}`}){super({name:Wre,message:s,cause:r}),this[Gre]=!0,this.url=e,this.statusCode=t,this.statusText=n}static isInstance(e){return er.hasMarker(e,Hre)}};Gre=H7e;async function G7e({url:e}){var t;const n=e.toString();try{const r=await fetch(n);if(!r.ok)throw new zI({url:n,statusCode:r.status,statusText:r.statusText});return{data:new Uint8Array(await r.arrayBuffer()),mimeType:(t=r.headers.get("content-type"))!=null?t:void 0}}catch(r){throw zI.isInstance(r)?r:new zI({url:n,cause:r})}}var Kre="AI_InvalidDataContentError",Yre=`vercel.ai.error.${Kre}`,K7e=Symbol.for(Yre),Zre,VU=class extends er{constructor({content:e,cause:t,message:n=`Invalid data content. Expected a base64 string, Uint8Array, ArrayBuffer, or Buffer, but got ${typeof e}.`}){super({name:Kre,message:n,cause:t}),this[Zre]=!0,this.content=e}static isInstance(e){return er.hasMarker(e,Yre)}};Zre=K7e;var Xre=ps([$e(),_C(Uint8Array),_C(ArrayBuffer),fG(e=>{var t,n;return(n=(t=globalThis.Buffer)==null?void 0:t.isBuffer(e))!=null?n:!1},{message:"Must be a Buffer"})]);function N6(e){return typeof e=="string"?e:e instanceof ArrayBuffer?Nu(new Uint8Array(e)):Nu(e)}function Uk(e){if(e instanceof Uint8Array)return e;if(typeof e=="string")try{return wE(e)}catch(t){throw new VU({message:"Invalid data content. Content string is not a base64-encoded media.",content:e,cause:t})}if(e instanceof ArrayBuffer)return new Uint8Array(e);throw new VU({content:e})}function Y7e(e){try{return new TextDecoder().decode(e)}catch{throw new Error("Error decoding Uint8Array to text")}}var Jre="AI_InvalidMessageRoleError",Qre=`vercel.ai.error.${Jre}`,Z7e=Symbol.for(Qre),ese,X7e=class extends er{constructor({role:e,message:t=`Invalid message role: '${e}'. Must be one of: "system", "user", "assistant", "tool".`}){super({name:Jre,message:t}),this[ese]=!0,this.role=e}static isInstance(e){return er.hasMarker(e,Qre)}};ese=Z7e;function J7e(e){try{const[t,n]=e.split(",");return{mimeType:t.split(";")[0].split(":")[1],base64Content:n}}catch{return{mimeType:void 0,base64Content:void 0}}}async function Q7e({prompt:e,modelSupportsImageUrls:t=!0,modelSupportsUrl:n=()=>!1,downloadImplementation:r=G7e}){const s=await tUe(e.messages,r,t,n);return[...e.system!=null?[{role:"system",content:e.system}]:[],...e.messages.map(i=>eUe(i,s))]}function eUe(e,t){var n,r,s,i,a,o;const l=e.role;switch(l){case"system":return{role:"system",content:e.content,providerMetadata:(n=e.providerOptions)!=null?n:e.experimental_providerMetadata};case"user":return typeof e.content=="string"?{role:"user",content:[{type:"text",text:e.content}],providerMetadata:(r=e.providerOptions)!=null?r:e.experimental_providerMetadata}:{role:"user",content:e.content.map(c=>nUe(c,t)).filter(c=>c.type!=="text"||c.text!==""),providerMetadata:(s=e.providerOptions)!=null?s:e.experimental_providerMetadata};case"assistant":return typeof e.content=="string"?{role:"assistant",content:[{type:"text",text:e.content}],providerMetadata:(i=e.providerOptions)!=null?i:e.experimental_providerMetadata}:{role:"assistant",content:e.content.filter(c=>c.type!=="text"||c.text!=="").map(c=>{var u;const d=(u=c.providerOptions)!=null?u:c.experimental_providerMetadata;switch(c.type){case"file":return{type:"file",data:c.data instanceof URL?c.data:N6(c.data),filename:c.filename,mimeType:c.mimeType,providerMetadata:d};case"reasoning":return{type:"reasoning",text:c.text,signature:c.signature,providerMetadata:d};case"redacted-reasoning":return{type:"redacted-reasoning",data:c.data,providerMetadata:d};case"text":return{type:"text",text:c.text,providerMetadata:d};case"tool-call":return{type:"tool-call",toolCallId:c.toolCallId,toolName:c.toolName,args:c.args,providerMetadata:d}}}),providerMetadata:(a=e.providerOptions)!=null?a:e.experimental_providerMetadata};case"tool":return{role:"tool",content:e.content.map(c=>{var u;return{type:"tool-result",toolCallId:c.toolCallId,toolName:c.toolName,result:c.result,content:c.experimental_content,isError:c.isError,providerMetadata:(u=c.providerOptions)!=null?u:c.experimental_providerMetadata}}),providerMetadata:(o=e.providerOptions)!=null?o:e.experimental_providerMetadata};default:{const c=l;throw new X7e({role:c})}}}async function tUe(e,t,n,r){const s=e.filter(a=>a.role==="user").map(a=>a.content).filter(a=>Array.isArray(a)).flat().filter(a=>a.type==="image"||a.type==="file").filter(a=>!(a.type==="image"&&n===!0)).map(a=>a.type==="image"?a.image:a.data).map(a=>typeof a=="string"&&(a.startsWith("http:")||a.startsWith("https:"))?new URL(a):a).filter(a=>a instanceof URL).filter(a=>!r(a)),i=await Promise.all(s.map(async a=>({url:a,data:await t({url:a})})));return Object.fromEntries(i.map(({url:a,data:o})=>[a.toString(),o]))}function nUe(e,t){var n,r,s,i;if(e.type==="text")return{type:"text",text:e.text,providerMetadata:(n=e.providerOptions)!=null?n:e.experimental_providerMetadata};let a=e.mimeType,o,l,c;const u=e.type;switch(u){case"image":o=e.image;break;case"file":o=e.data;break;default:throw new Error(`Unsupported part type: ${u}`)}try{l=typeof o=="string"?new URL(o):o}catch{l=o}if(l instanceof URL)if(l.protocol==="data:"){const{mimeType:d,base64Content:h}=J7e(l.toString());if(d==null||h==null)throw new Error(`Invalid data URL format in part ${u}`);a=d,c=Uk(h)}else{const d=t[l.toString()];d?(c=d.data,a??(a=d.mimeType)):c=l}else c=Uk(l);switch(u){case"image":return c instanceof Uint8Array&&(a=(r=V7e({data:c,signatures:z7e}))!=null?r:a),{type:"image",image:c,mimeType:a,providerMetadata:(s=e.providerOptions)!=null?s:e.experimental_providerMetadata};case"file":{if(a==null)throw new Error("Mime type is missing for file part");return{type:"file",data:c instanceof Uint8Array?N6(c):c,filename:e.filename,mimeType:a,providerMetadata:(i=e.providerOptions)!=null?i:e.experimental_providerMetadata}}}}function rUe({maxTokens:e,temperature:t,topP:n,topK:r,presencePenalty:s,frequencyPenalty:i,stopSequences:a,seed:o}){if(e!=null){if(!Number.isInteger(e))throw new gc({parameter:"maxTokens",value:e,message:"maxTokens must be an integer"});if(e<1)throw new gc({parameter:"maxTokens",value:e,message:"maxTokens must be >= 1"})}if(t!=null&&typeof t!="number")throw new gc({parameter:"temperature",value:t,message:"temperature must be a number"});if(n!=null&&typeof n!="number")throw new gc({parameter:"topP",value:n,message:"topP must be a number"});if(r!=null&&typeof r!="number")throw new gc({parameter:"topK",value:r,message:"topK must be a number"});if(s!=null&&typeof s!="number")throw new gc({parameter:"presencePenalty",value:s,message:"presencePenalty must be a number"});if(i!=null&&typeof i!="number")throw new gc({parameter:"frequencyPenalty",value:i,message:"frequencyPenalty must be a number"});if(o!=null&&!Number.isInteger(o))throw new gc({parameter:"seed",value:o,message:"seed must be an integer"});return{maxTokens:e,temperature:t??0,topP:n,topK:r,presencePenalty:s,frequencyPenalty:i,stopSequences:a!=null&&a.length>0?a:void 0,seed:o}}function WU(e){var t,n,r;const s=[];for(const i of e){let a;try{a=new URL(i.url)}catch{throw new Error(`Invalid URL: ${i.url}`)}switch(a.protocol){case"http:":case"https:":{if((t=i.contentType)!=null&&t.startsWith("image/"))s.push({type:"image",image:a});else{if(!i.contentType)throw new Error("If the attachment is not an image, it must specify a content type");s.push({type:"file",data:a,mimeType:i.contentType})}break}case"data:":{let o,l,c;try{[o,l]=i.url.split(","),c=o.split(";")[0].split(":")[1]}catch{throw new Error(`Error processing data URL: ${i.url}`)}if(c==null||l==null)throw new Error(`Invalid data URL format: ${i.url}`);if((n=i.contentType)!=null&&n.startsWith("image/"))s.push({type:"image",image:Uk(l)});else if((r=i.contentType)!=null&&r.startsWith("text/"))s.push({type:"text",text:Y7e(Uk(l))});else{if(!i.contentType)throw new Error("If the attachment is not an image or text, it must specify a content type");s.push({type:"file",data:l,mimeType:i.contentType})}break}default:throw new Error(`Unsupported URL protocol: ${a.protocol}`)}}return s}var tse="AI_MessageConversionError",nse=`vercel.ai.error.${tse}`,sUe=Symbol.for(nse),rse,UI=class extends er{constructor({originalMessage:e,message:t}){super({name:tse,message:t}),this[rse]=!0,this.originalMessage=e}static isInstance(e){return er.hasMarker(e,nse)}};rse=sUe;function iUe(e,t){var n,r;const s=(n=t==null?void 0:t.tools)!=null?n:{},i=[];for(let a=0;a<e.length;a++){const o=e[a],l=a===e.length-1,{role:c,content:u,experimental_attachments:d}=o;switch(c){case"system":{i.push({role:"system",content:u});break}case"user":{if(o.parts==null)i.push({role:"user",content:d?[{type:"text",text:u},...WU(d)]:u});else{const h=o.parts.filter(m=>m.type==="text").map(m=>({type:"text",text:m.text}));i.push({role:"user",content:d?[...h,...WU(d)]:h})}break}case"assistant":{if(o.parts!=null){let y=function(){const w=[];for(const C of x)switch(C.type){case"file":case"text":{w.push(C);break}case"reasoning":{for(const k of C.details)switch(k.type){case"text":w.push({type:"reasoning",text:k.text,signature:k.signature});break;case"redacted":w.push({type:"redacted-reasoning",data:k.data});break}break}case"tool-invocation":w.push({type:"tool-call",toolCallId:C.toolInvocation.toolCallId,toolName:C.toolInvocation.toolName,args:C.toolInvocation.args});break;default:{const k=C;throw new Error(`Unsupported part: ${k}`)}}i.push({role:"assistant",content:w});const S=x.filter(C=>C.type==="tool-invocation").map(C=>C.toolInvocation);S.length>0&&i.push({role:"tool",content:S.map(C=>{if(!("result"in C))throw new UI({originalMessage:o,message:"ToolInvocation must have a result: "+JSON.stringify(C)});const{toolCallId:k,toolName:A,result:R}=C,N=s[A];return(N==null?void 0:N.experimental_toToolResultContent)!=null?{type:"tool-result",toolCallId:k,toolName:A,result:N.experimental_toToolResultContent(R),experimental_content:N.experimental_toToolResultContent(R)}:{type:"tool-result",toolCallId:k,toolName:A,result:R}})}),x=[],v=!1,b++},b=0,v=!1,x=[];for(const w of o.parts)switch(w.type){case"text":{v&&y(),x.push(w);break}case"file":case"reasoning":{x.push(w);break}case"tool-invocation":{((r=w.toolInvocation.step)!=null?r:0)!==b&&y(),x.push(w),v=!0;break}}y();break}const h=o.toolInvocations;if(h==null||h.length===0){i.push({role:"assistant",content:u});break}const m=h.reduce((y,b)=>{var v;return Math.max(y,(v=b.step)!=null?v:0)},0);for(let y=0;y<=m;y++){const b=h.filter(v=>{var x;return((x=v.step)!=null?x:0)===y});b.length!==0&&(i.push({role:"assistant",content:[...l&&u&&y===0?[{type:"text",text:u}]:[],...b.map(({toolCallId:v,toolName:x,args:w})=>({type:"tool-call",toolCallId:v,toolName:x,args:w}))]}),i.push({role:"tool",content:b.map(v=>{if(!("result"in v))throw new UI({originalMessage:o,message:"ToolInvocation must have a result: "+JSON.stringify(v)});const{toolCallId:x,toolName:w,result:S}=v,C=s[w];return(C==null?void 0:C.experimental_toToolResultContent)!=null?{type:"tool-result",toolCallId:x,toolName:w,result:C.experimental_toToolResultContent(S),experimental_content:C.experimental_toToolResultContent(S)}:{type:"tool-result",toolCallId:x,toolName:w,result:S}})}))}u&&!l&&i.push({role:"assistant",content:u});break}case"data":break;default:{const h=c;throw new UI({originalMessage:o,message:`Unsupported role: ${h}`})}}}return i}var P4=tbe(()=>ps([ebe(),$e(),Tt(),br(),bh($e(),P4),on(P4)])),li=bh($e(),bh($e(),P4)),aUe=on(ps([Ke({type:An("text"),text:$e()}),Ke({type:An("image"),data:$e(),mimeType:$e().optional()})])),sse=Ke({type:An("text"),text:$e(),providerOptions:li.optional(),experimental_providerMetadata:li.optional()}),oUe=Ke({type:An("image"),image:ps([Xre,_C(URL)]),mimeType:$e().optional(),providerOptions:li.optional(),experimental_providerMetadata:li.optional()}),ise=Ke({type:An("file"),data:ps([Xre,_C(URL)]),filename:$e().optional(),mimeType:$e(),providerOptions:li.optional(),experimental_providerMetadata:li.optional()}),lUe=Ke({type:An("reasoning"),text:$e(),providerOptions:li.optional(),experimental_providerMetadata:li.optional()}),cUe=Ke({type:An("redacted-reasoning"),data:$e(),providerOptions:li.optional(),experimental_providerMetadata:li.optional()}),uUe=Ke({type:An("tool-call"),toolCallId:$e(),toolName:$e(),args:Fy(),providerOptions:li.optional(),experimental_providerMetadata:li.optional()}),dUe=Ke({type:An("tool-result"),toolCallId:$e(),toolName:$e(),result:Fy(),content:aUe.optional(),isError:br().optional(),providerOptions:li.optional(),experimental_providerMetadata:li.optional()}),fUe=Ke({role:An("system"),content:$e(),providerOptions:li.optional(),experimental_providerMetadata:li.optional()}),hUe=Ke({role:An("user"),content:ps([$e(),on(ps([sse,oUe,ise]))]),providerOptions:li.optional(),experimental_providerMetadata:li.optional()}),pUe=Ke({role:An("assistant"),content:ps([$e(),on(ps([sse,ise,lUe,cUe,uUe]))]),providerOptions:li.optional(),experimental_providerMetadata:li.optional()}),mUe=Ke({role:An("tool"),content:on(dUe),providerOptions:li.optional(),experimental_providerMetadata:li.optional()}),gUe=ps([fUe,hUe,pUe,mUe]);function yUe({prompt:e,tools:t}){if(e.prompt==null&&e.messages==null)throw new yc({prompt:e,message:"prompt or messages must be defined"});if(e.prompt!=null&&e.messages!=null)throw new yc({prompt:e,message:"prompt and messages cannot be defined at the same time"});if(e.system!=null&&typeof e.system!="string")throw new yc({prompt:e,message:"system must be a string"});if(e.prompt!=null){if(typeof e.prompt!="string")throw new yc({prompt:e,message:"prompt must be a string"});return{type:"prompt",system:e.system,messages:[{role:"user",content:e.prompt}]}}if(e.messages!=null){const r=bUe(e.messages)==="ui-messages"?iUe(e.messages,{tools:t}):e.messages;if(r.length===0)throw new yc({prompt:e,message:"messages must not be empty"});const s=Dy({value:r,schema:on(gUe)});if(!s.success)throw new yc({prompt:e,message:["message must be a CoreMessage or a UI message",`Validation error: ${s.error.message}`].join(`
`),cause:s.error});return{type:"messages",messages:r,system:e.system}}throw new Error("unreachable")}function bUe(e){if(!Array.isArray(e))throw new yc({prompt:e,message:["messages must be an array of CoreMessage or UIMessage",`Received non-array value: ${JSON.stringify(e)}`].join(`
`),cause:e});if(e.length===0)return"messages";const t=e.map(vUe);if(t.some(r=>r==="has-ui-specific-parts"))return"ui-messages";const n=t.findIndex(r=>r!=="has-core-specific-parts"&&r!=="message");if(n===-1)return"messages";throw new yc({prompt:e,message:["messages must be an array of CoreMessage or UIMessage",`Received message of type: "${t[n]}" at index ${n}`,`messages[${n}]: ${JSON.stringify(e[n])}`].join(`
`),cause:e})}function vUe(e){return typeof e=="object"&&e!==null&&(e.role==="function"||e.role==="data"||"toolInvocations"in e||"parts"in e||"experimental_attachments"in e)?"has-ui-specific-parts":typeof e=="object"&&e!==null&&"content"in e&&(Array.isArray(e.content)||"experimental_providerMetadata"in e||"providerOptions"in e)?"has-core-specific-parts":typeof e=="object"&&e!==null&&"role"in e&&"content"in e&&typeof e.content=="string"&&["system","user","assistant","tool"].includes(e.role)?"message":"other"}function xUe({promptTokens:e,completionTokens:t}){return{promptTokens:e,completionTokens:t,totalTokens:e+t}}function wUe(e,t){return{promptTokens:e.promptTokens+t.promptTokens,completionTokens:e.completionTokens+t.completionTokens,totalTokens:e.totalTokens+t.totalTokens}}var _Ue="JSON schema:",SUe="You MUST answer with a JSON object that matches the JSON schema above.",CUe="You MUST answer with JSON.";function kUe({prompt:e,schema:t,schemaPrefix:n=t!=null?_Ue:void 0,schemaSuffix:r=t!=null?SUe:CUe}){return[e!=null&&e.length>0?e:void 0,e!=null&&e.length>0?"":void 0,n,t!=null?JSON.stringify(t):void 0,r].filter(s=>s!=null).join(`
`)}function qI(e){const t=e.pipeThrough(new TransformStream);return t[Symbol.asyncIterator]=()=>{const n=t.getReader();return{async next(){const{done:r,value:s}=await n.read();return r?{done:!0,value:void 0}:{done:!1,value:s}}}},t}function EUe(e){const t=e.map(n=>({...n,content:typeof n.content=="string"?n.content:n.content.map(TUe)}));return JSON.stringify(t)}function TUe(e){return e.type==="image"?{...e,image:e.image instanceof Uint8Array?N6(e.image):e.image}:e}Lm({prefix:"aiobj",size:24});var bo=class{constructor(){this.status={type:"pending"},this._resolve=void 0,this._reject=void 0}get value(){return this.promise?this.promise:(this.promise=new Promise((e,t)=>{this.status.type==="resolved"?e(this.status.value):this.status.type==="rejected"&&t(this.status.error),this._resolve=e,this._reject=t}),this.promise)}resolve(e){var t;this.status={type:"resolved",value:e},this.promise&&((t=this._resolve)==null||t.call(this,e))}reject(e){var t;this.status={type:"rejected",error:e},this.promise&&((t=this._reject)==null||t.call(this,e))}};function HU(){let e,t;return{promise:new Promise((r,s)=>{e=r,t=s}),resolve:e,reject:t}}function AUe(){let e=[],t=null,n=!1,r=HU();const s=async()=>{if(n&&e.length===0){t==null||t.close();return}if(e.length===0)return r=HU(),await r.promise,s();try{const{value:i,done:a}=await e[0].read();a?(e.shift(),e.length>0?await s():n&&(t==null||t.close())):t==null||t.enqueue(i)}catch(i){t==null||t.error(i),e.shift(),n&&e.length===0&&(t==null||t.close())}};return{stream:new ReadableStream({start(i){t=i},pull:s,async cancel(){for(const i of e)await i.cancel();e=[],n=!0}}),addStream:i=>{if(n)throw new Error("Cannot add inner stream: outer stream is closed");e.push(i.getReader()),r.resolve()},close:()=>{n=!0,r.resolve(),e.length===0&&(t==null||t.close())},terminate:()=>{n=!0,r.resolve(),e.forEach(i=>i.cancel()),e=[],t==null||t.close()}}}function RUe(){var e,t;return(t=(e=globalThis==null?void 0:globalThis.performance)==null?void 0:e.now())!=null?t:Date.now()}Lm({prefix:"aiobj",size:24});var ase="AI_NoOutputSpecifiedError",ose=`vercel.ai.error.${ase}`,NUe=Symbol.for(ose),lse,MUe=class extends er{constructor({message:e="No output specified."}={}){super({name:ase,message:e}),this[lse]=!0}static isInstance(e){return er.hasMarker(e,ose)}};lse=NUe;var cse="AI_ToolExecutionError",use=`vercel.ai.error.${cse}`,IUe=Symbol.for(use),dse,jUe=class extends er{constructor({toolArgs:e,toolName:t,toolCallId:n,cause:r,message:s=`Error executing tool ${t}: ${c1(r)}`}){super({name:cse,message:s,cause:r}),this[dse]=!0,this.toolArgs=e,this.toolName=t,this.toolCallId=n}static isInstance(e){return er.hasMarker(e,use)}};dse=IUe;function PUe(e){return e!=null&&Object.keys(e).length>0}function OUe({tools:e,toolChoice:t,activeTools:n}){return PUe(e)?{tools:(n!=null?Object.entries(e).filter(([s])=>n.includes(s)):Object.entries(e)).map(([s,i])=>{const a=i.type;switch(a){case void 0:case"function":return{type:"function",name:s,description:i.description,parameters:BT(i.parameters).jsonSchema};case"provider-defined":return{type:"provider-defined",name:s,id:i.id,args:i.args};default:{const o=a;throw new Error(`Unsupported tool type: ${o}`)}}}),toolChoice:t==null?{type:"auto"}:typeof t=="string"?{type:t}:{type:"tool",toolName:t.toolName}}:{tools:void 0,toolChoice:void 0}}var DUe=/^([\s\S]*?)(\s+)(\S*)$/;function FUe(e){const t=e.match(DUe);return t?{prefix:t[1],whitespace:t[2],suffix:t[3]}:void 0}var fse="AI_InvalidToolArgumentsError",hse=`vercel.ai.error.${fse}`,LUe=Symbol.for(hse),pse,mse=class extends er{constructor({toolArgs:e,toolName:t,cause:n,message:r=`Invalid arguments for tool ${t}: ${c1(n)}`}){super({name:fse,message:r,cause:n}),this[pse]=!0,this.toolArgs=e,this.toolName=t}static isInstance(e){return er.hasMarker(e,hse)}};pse=LUe;var gse="AI_NoSuchToolError",yse=`vercel.ai.error.${gse}`,BUe=Symbol.for(yse),bse,O4=class extends er{constructor({toolName:e,availableTools:t=void 0,message:n=`Model tried to call unavailable tool '${e}'. ${t===void 0?"No tools are available.":`Available tools: ${t.join(", ")}.`}`}){super({name:gse,message:n}),this[bse]=!0,this.toolName=e,this.availableTools=t}static isInstance(e){return er.hasMarker(e,yse)}};bse=BUe;var vse="AI_ToolCallRepairError",xse=`vercel.ai.error.${vse}`,$Ue=Symbol.for(xse),wse,zUe=class extends er{constructor({cause:e,originalError:t,message:n=`Error repairing tool call: ${c1(e)}`}){super({name:vse,message:n,cause:e}),this[wse]=!0,this.originalError=t}static isInstance(e){return er.hasMarker(e,xse)}};wse=$Ue;async function UUe({toolCall:e,tools:t,repairToolCall:n,system:r,messages:s}){if(t==null)throw new O4({toolName:e.toolName});try{return await GU({toolCall:e,tools:t})}catch(i){if(n==null||!(O4.isInstance(i)||mse.isInstance(i)))throw i;let a=null;try{a=await n({toolCall:e,tools:t,parameterSchema:({toolName:o})=>BT(t[o].parameters).jsonSchema,system:r,messages:s,error:i})}catch(o){throw new zUe({cause:o,originalError:i})}if(a==null)throw i;return await GU({toolCall:a,tools:t})}}async function GU({toolCall:e,tools:t}){const n=e.toolName,r=t[n];if(r==null)throw new O4({toolName:e.toolName,availableTools:Object.keys(t)});const s=BT(r.parameters),i=e.args.trim()===""?Dy({value:{},schema:s}):vm({text:e.args,schema:s});if(i.success===!1)throw new mse({toolName:n,toolArgs:e.args,cause:i.error});return{type:"tool-call",toolCallId:e.toolCallId,toolName:n,args:i.value}}function qUe(e){const t=e.filter(n=>n.type==="text").map(n=>n.text).join("");return t.length>0?t:void 0}function KU({text:e="",files:t,reasoning:n,tools:r,toolCalls:s,toolResults:i,messageId:a,generateMessageId:o}){const l=[],c=[];return n.length>0&&c.push(...n.map(u=>u.type==="text"?{...u,type:"reasoning"}:{...u,type:"redacted-reasoning"})),t.length>0&&c.push(...t.map(u=>({type:"file",data:u.base64,mimeType:u.mimeType}))),e.length>0&&c.push({type:"text",text:e}),s.length>0&&c.push(...s),c.length>0&&l.push({role:"assistant",content:c,id:a}),i.length>0&&l.push({role:"tool",id:o(),content:i.map(u=>{const d=r[u.toolName];return(d==null?void 0:d.experimental_toToolResultContent)!=null?{type:"tool-result",toolCallId:u.toolCallId,toolName:u.toolName,result:d.experimental_toToolResultContent(u.result),experimental_content:d.experimental_toToolResultContent(u.result)}:{type:"tool-result",toolCallId:u.toolCallId,toolName:u.toolName,result:u.result}})}),l}Lm({prefix:"aitxt",size:24});Lm({prefix:"msg",size:24});var VUe={};R6(VUe,{object:()=>ZUe,text:()=>YUe});var _se="AI_InvalidStreamPartError",Sse=`vercel.ai.error.${_se}`,WUe=Symbol.for(Sse),Cse,HUe=class extends er{constructor({chunk:e,message:t}){super({name:_se,message:t}),this[Cse]=!0,this.chunk=e}static isInstance(e){return er.hasMarker(e,Sse)}};Cse=WUe;var GUe="AI_MCPClientError",kse=`vercel.ai.error.${GUe}`,KUe=Symbol.for(kse),Ese,ta=class extends er{constructor({name:e="MCPClientError",message:t,cause:n}){super({name:e,message:t,cause:n}),this[Ese]=!0}static isInstance(e){return er.hasMarker(e,kse)}};Ese=KUe;var YUe=()=>({type:"text",responseFormat:()=>({type:"text"}),injectIntoSystemPrompt({system:e}){return e},parsePartial({text:e}){return{partial:e}},parseOutput({text:e}){return e}}),ZUe=({schema:e})=>{const t=BT(e);return{type:"object",responseFormat:({model:n})=>({type:"json",schema:n.supportsStructuredOutputs?t.jsonSchema:void 0}),injectIntoSystemPrompt({system:n,model:r}){return r.supportsStructuredOutputs?n:kUe({prompt:n,schema:t.jsonSchema})},parsePartial({text:n}){const r=Rze(n);switch(r.state){case"failed-parse":case"undefined-input":return;case"repaired-parse":case"successful-parse":return{partial:r.value};default:{const s=r.state;throw new Error(`Unsupported parse state: ${s}`)}}},parseOutput({text:n},r){const s=vm({text:n});if(!s.success)throw new qU({message:"No object generated: could not parse the response.",cause:s.error,text:n,response:r.response,usage:r.usage,finishReason:r.finishReason});const i=Dy({value:s.value,schema:t});if(!i.success)throw new qU({message:"No object generated: response did not match schema.",cause:i.error,text:n,response:r.response,usage:r.usage,finishReason:r.finishReason});return i.value}}};function XUe(e){return e===void 0?[]:Array.isArray(e)?e:[e]}async function JUe({stream:e,onError:t}){const n=e.getReader();try{for(;;){const{done:r}=await n.read();if(r)break}}catch(r){t==null||t(r)}finally{n.releaseLock()}}function M6(e,t){const n=e.getReader(),r=t.getReader();let s,i,a=!1,o=!1;async function l(u){try{s==null&&(s=n.read());const d=await s;s=void 0,d.done?u.close():u.enqueue(d.value)}catch(d){u.error(d)}}async function c(u){try{i==null&&(i=r.read());const d=await i;i=void 0,d.done?u.close():u.enqueue(d.value)}catch(d){u.error(d)}}return new ReadableStream({async pull(u){try{if(a){await c(u);return}if(o){await l(u);return}s==null&&(s=n.read()),i==null&&(i=r.read());const{result:d,reader:h}=await Promise.race([s.then(m=>({result:m,reader:n})),i.then(m=>({result:m,reader:r}))]);d.done||u.enqueue(d.value),h===n?(s=void 0,d.done&&(await c(u),a=!0)):(i=void 0,d.done&&(o=!0,await l(u)))}catch(d){u.error(d)}},cancel(){n.cancel(),r.cancel()}})}function QUe({tools:e,generatorStream:t,toolCallStreaming:n,tracer:r,telemetry:s,system:i,messages:a,abortSignal:o,repairToolCall:l}){let c=null;const u=new ReadableStream({start(x){c=x}}),d={},h=new Set;let m=!1,y;function b(){m&&h.size===0&&(y!=null&&c.enqueue(y),c.close())}const v=new TransformStream({async transform(x,w){const S=x.type;switch(S){case"text-delta":case"reasoning":case"reasoning-signature":case"redacted-reasoning":case"source":case"response-metadata":case"error":{w.enqueue(x);break}case"file":{w.enqueue(new $7e({data:x.data,mimeType:x.mimeType}));break}case"tool-call-delta":{n&&(d[x.toolCallId]||(w.enqueue({type:"tool-call-streaming-start",toolCallId:x.toolCallId,toolName:x.toolName}),d[x.toolCallId]=!0),w.enqueue({type:"tool-call-delta",toolCallId:x.toolCallId,toolName:x.toolName,argsTextDelta:x.argsTextDelta}));break}case"tool-call":{try{const C=await UUe({toolCall:x,tools:e,repairToolCall:l,system:i,messages:a});w.enqueue(C);const k=e[C.toolName];if(k.execute!=null){const A=sa();h.add(A),j4({name:"ai.toolCall",attributes:b0({telemetry:s,attributes:{...I4({operationId:"ai.toolCall",telemetry:s}),"ai.toolCall.name":C.toolName,"ai.toolCall.id":C.toolCallId,"ai.toolCall.args":{output:()=>JSON.stringify(C.args)}}}),tracer:r,fn:async R=>k.execute(C.args,{toolCallId:C.toolCallId,messages:a,abortSignal:o}).then(N=>{c.enqueue({...C,type:"tool-result",result:N}),h.delete(A),b();try{R.setAttributes(b0({telemetry:s,attributes:{"ai.toolCall.result":{output:()=>JSON.stringify(N)}}}))}catch{}},N=>{c.enqueue({type:"error",error:new jUe({toolCallId:C.toolCallId,toolName:C.toolName,toolArgs:C.args,cause:N})}),h.delete(A),b()})})}}catch(C){c.enqueue({type:"error",error:C})}break}case"finish":{y={type:"finish",finishReason:x.finishReason,logprobs:x.logprobs,usage:xUe(x.usage),experimental_providerMetadata:x.providerMetadata};break}default:{const C=S;throw new Error(`Unhandled chunk type: ${C}`)}}},flush(){m=!0,b()}});return new ReadableStream({async start(x){return Promise.all([t.pipeThrough(v).pipeTo(new WritableStream({write(w){x.enqueue(w)},close(){}})),u.pipeTo(new WritableStream({write(w){x.enqueue(w)},close(){x.close()}}))])}})}var eqe=Lm({prefix:"aitxt",size:24}),tqe=Lm({prefix:"msg",size:24});function nqe({model:e,tools:t,toolChoice:n,system:r,prompt:s,messages:i,maxRetries:a,abortSignal:o,headers:l,maxSteps:c=1,experimental_generateMessageId:u=tqe,experimental_output:d,experimental_continueSteps:h=!1,experimental_telemetry:m,experimental_providerMetadata:y,providerOptions:b=y,experimental_toolCallStreaming:v=!1,toolCallStreaming:x=v,experimental_activeTools:w,experimental_repairToolCall:S,experimental_transform:C,onChunk:k,onError:A,onFinish:R,onStepFinish:N,_internal:{now:I=RUe,generateId:P=eqe,currentDate:L=()=>new Date}={},...O}){return new sqe({model:e,telemetry:m,headers:l,settings:O,maxRetries:a,abortSignal:o,system:r,prompt:s,messages:i,tools:t,toolChoice:n,toolCallStreaming:x,transforms:XUe(C),activeTools:w,repairToolCall:S,maxSteps:c,output:d,continueSteps:h,providerOptions:b,onChunk:k,onError:A,onFinish:R,onStepFinish:N,now:I,currentDate:L,generateId:P,generateMessageId:u})}function rqe(e){if(!e)return new TransformStream({transform(i,a){a.enqueue({part:i,partialOutput:void 0})}});let t="",n="",r="";function s({controller:i,partialOutput:a=void 0}){i.enqueue({part:{type:"text-delta",textDelta:n},partialOutput:a}),n=""}return new TransformStream({transform(i,a){if(i.type==="step-finish"&&s({controller:a}),i.type!=="text-delta"){a.enqueue({part:i,partialOutput:void 0});return}t+=i.textDelta,n+=i.textDelta;const o=e.parsePartial({text:t});if(o!=null){const l=JSON.stringify(o.partial);l!==r&&(s({controller:a,partialOutput:o.partial}),r=l)}},flush(i){n.length>0&&s({controller:i})}})}var sqe=class{constructor({model:e,telemetry:t,headers:n,settings:r,maxRetries:s,abortSignal:i,system:a,prompt:o,messages:l,tools:c,toolChoice:u,toolCallStreaming:d,transforms:h,activeTools:m,repairToolCall:y,maxSteps:b,output:v,continueSteps:x,providerOptions:w,now:S,currentDate:C,generateId:k,generateMessageId:A,onChunk:R,onError:N,onFinish:I,onStepFinish:P}){this.warningsPromise=new bo,this.usagePromise=new bo,this.finishReasonPromise=new bo,this.providerMetadataPromise=new bo,this.textPromise=new bo,this.reasoningPromise=new bo,this.reasoningDetailsPromise=new bo,this.sourcesPromise=new bo,this.filesPromise=new bo,this.toolCallsPromise=new bo,this.toolResultsPromise=new bo,this.requestPromise=new bo,this.responsePromise=new bo,this.stepsPromise=new bo;var L;if(b<1)throw new gc({parameter:"maxSteps",value:b,message:"maxSteps must be at least 1"});this.output=v;let O="",V="",D="",Z=[],U=[],H,$=[];const ne=[],W={id:k(),timestamp:C(),modelId:e.modelId,messages:[]};let Q=[],ee=[],se,pe,ce="initial";const Ie=[];let De;const Se=new TransformStream({async transform(le,oe){oe.enqueue(le);const{part:re}=le;if((re.type==="text-delta"||re.type==="reasoning"||re.type==="source"||re.type==="tool-call"||re.type==="tool-result"||re.type==="tool-call-streaming-start"||re.type==="tool-call-delta")&&await(R==null?void 0:R({chunk:re})),re.type==="error"&&await(N==null?void 0:N({error:re.error})),re.type==="text-delta"&&(O+=re.textDelta,V+=re.textDelta,D+=re.textDelta),re.type==="reasoning"&&(H==null?(H={type:"text",text:re.textDelta},Z.push(H)):H.text+=re.textDelta),re.type==="reasoning-signature"){if(H==null)throw new er({name:"InvalidStreamPart",message:"reasoning-signature without reasoning"});H.signature=re.signature,H=void 0}if(re.type==="redacted-reasoning"&&Z.push({type:"redacted",data:re.data}),re.type==="file"&&U.push(re),re.type==="source"&&(ne.push(re.source),$.push(re.source)),re.type==="tool-call"&&Q.push(re),re.type==="tool-result"&&ee.push(re),re.type==="step-finish"){const Te=KU({text:V,files:U,reasoning:Z,tools:c??{},toolCalls:Q,toolResults:ee,messageId:re.messageId,generateMessageId:A}),Be=Ie.length;let ke="done";Be+1<b&&(x&&re.finishReason==="length"&&Q.length===0?ke="continue":Q.length>0&&ee.length===Q.length&&(ke="tool-result"));const lt={stepType:ce,text:O,reasoning:qUe(Z),reasoningDetails:Z,files:U,sources:$,toolCalls:Q,toolResults:ee,finishReason:re.finishReason,usage:re.usage,warnings:re.warnings,logprobs:re.logprobs,request:re.request,response:{...re.response,messages:[...W.messages,...Te]},providerMetadata:re.experimental_providerMetadata,experimental_providerMetadata:re.experimental_providerMetadata,isContinued:re.isContinued};await(P==null?void 0:P(lt)),Ie.push(lt),Q=[],ee=[],O="",$=[],Z=[],U=[],H=void 0,ke!=="done"&&(ce=ke),ke!=="continue"&&(W.messages.push(...Te),V="")}re.type==="finish"&&(W.id=re.response.id,W.timestamp=re.response.timestamp,W.modelId=re.response.modelId,W.headers=re.response.headers,pe=re.usage,se=re.finishReason)},async flush(le){var oe;try{if(Ie.length===0)return;const re=Ie[Ie.length-1];Ae.warningsPromise.resolve(re.warnings),Ae.requestPromise.resolve(re.request),Ae.responsePromise.resolve(re.response),Ae.toolCallsPromise.resolve(re.toolCalls),Ae.toolResultsPromise.resolve(re.toolResults),Ae.providerMetadataPromise.resolve(re.experimental_providerMetadata),Ae.reasoningPromise.resolve(re.reasoning),Ae.reasoningDetailsPromise.resolve(re.reasoningDetails);const Te=se??"unknown",Be=pe??{completionTokens:NaN,promptTokens:NaN,totalTokens:NaN};Ae.finishReasonPromise.resolve(Te),Ae.usagePromise.resolve(Be),Ae.textPromise.resolve(D),Ae.sourcesPromise.resolve(ne),Ae.filesPromise.resolve(re.files),Ae.stepsPromise.resolve(Ie),await(I==null?void 0:I({finishReason:Te,logprobs:void 0,usage:Be,text:D,reasoning:re.reasoning,reasoningDetails:re.reasoningDetails,files:re.files,sources:re.sources,toolCalls:re.toolCalls,toolResults:re.toolResults,request:(oe=re.request)!=null?oe:{},response:re.response,warnings:re.warnings,providerMetadata:re.providerMetadata,experimental_providerMetadata:re.experimental_providerMetadata,steps:Ie})),De.setAttributes(b0({telemetry:t,attributes:{"ai.response.finishReason":Te,"ai.response.text":{output:()=>D},"ai.response.toolCalls":{output:()=>{var ke;return(ke=re.toolCalls)!=null&&ke.length?JSON.stringify(re.toolCalls):void 0}},"ai.usage.promptTokens":Be.promptTokens,"ai.usage.completionTokens":Be.completionTokens}}))}catch(re){le.error(re)}finally{De.end()}}}),Ce=AUe();this.addStream=Ce.addStream,this.closeStream=Ce.close;let qe=Ce.stream;for(const le of h)qe=qe.pipeThrough(le({tools:c,stopStream(){Ce.terminate()}}));this.baseStream=qe.pipeThrough(rqe(v)).pipeThrough(Se);const{maxRetries:Qe,retry:Ve}=P7e({maxRetries:s}),Ne=L7e(t),K=O7e({model:e,telemetry:t,headers:n,settings:{...r,maxRetries:Qe}}),ge=yUe({prompt:{system:(L=v==null?void 0:v.injectIntoSystemPrompt({system:a,model:e}))!=null?L:a,prompt:o,messages:l},tools:c}),Ae=this;j4({name:"ai.streamText",attributes:b0({telemetry:t,attributes:{...I4({operationId:"ai.streamText",telemetry:t}),...K,"ai.prompt":{input:()=>JSON.stringify({system:a,prompt:o,messages:l})},"ai.settings.maxSteps":b}}),tracer:Ne,endWhenDone:!1,fn:async le=>{De=le;async function oe({currentStep:re,responseMessages:Te,usage:Be,stepType:ke,previousStepText:lt,hasLeadingWhitespace:Rt,messageId:ht}){var Pt;const qt=Te.length===0?ge.type:"messages",Lt=[...ge.messages,...Te],en=await Q7e({prompt:{type:qt,system:ge.system,messages:Lt},modelSupportsImageUrls:e.supportsImageUrls,modelSupportsUrl:(Pt=e.supportsUrl)==null?void 0:Pt.bind(e)}),xe={type:"regular",...OUe({tools:c,toolChoice:u,activeTools:m})},{result:{stream:F,warnings:X,rawResponse:ye,request:Fe},doStreamSpan:we,startTimestampMs:Me}=await Ve(()=>j4({name:"ai.streamText.doStream",attributes:b0({telemetry:t,attributes:{...I4({operationId:"ai.streamText.doStream",telemetry:t}),...K,"ai.prompt.format":{input:()=>qt},"ai.prompt.messages":{input:()=>EUe(en)},"ai.prompt.tools":{input:()=>{var Xt;return(Xt=xe.tools)==null?void 0:Xt.map(nn=>JSON.stringify(nn))}},"ai.prompt.toolChoice":{input:()=>xe.toolChoice!=null?JSON.stringify(xe.toolChoice):void 0},"gen_ai.system":e.provider,"gen_ai.request.model":e.modelId,"gen_ai.request.frequency_penalty":r.frequencyPenalty,"gen_ai.request.max_tokens":r.maxTokens,"gen_ai.request.presence_penalty":r.presencePenalty,"gen_ai.request.stop_sequences":r.stopSequences,"gen_ai.request.temperature":r.temperature,"gen_ai.request.top_k":r.topK,"gen_ai.request.top_p":r.topP}}),tracer:Ne,endWhenDone:!1,fn:async Xt=>({startTimestampMs:S(),doStreamSpan:Xt,result:await e.doStream({mode:xe,...rUe(r),inputFormat:qt,responseFormat:v==null?void 0:v.responseFormat({model:e}),prompt:en,providerMetadata:w,abortSignal:i,headers:n})})})),de=QUe({tools:c,generatorStream:F,toolCallStreaming:d,tracer:Ne,telemetry:t,system:a,messages:Lt,repairToolCall:y,abortSignal:i}),vt=Fe??{},ot=[],B=[],ze=[],st=[];let be,_e="unknown",Ue={promptTokens:0,completionTokens:0,totalTokens:0},kt,fe=!0,Y="",G=ke==="continue"?lt:"",J,ve={id:k(),timestamp:C(),modelId:e.modelId},Oe="",Ge=!1,_t=!0,tn=!1;async function Un({controller:Xt,chunk:nn}){Xt.enqueue(nn),Y+=nn.textDelta,G+=nn.textDelta,Ge=!0,tn=nn.textDelta.trimEnd()!==nn.textDelta}Ae.addStream(de.pipeThrough(new TransformStream({async transform(Xt,nn){var un,mr,Rr;if(fe){const rs=S()-Me;fe=!1,we.addEvent("ai.stream.firstChunk",{"ai.response.msToFirstChunk":rs}),we.setAttributes({"ai.response.msToFirstChunk":rs}),nn.enqueue({type:"step-start",messageId:ht,request:vt,warnings:X??[]})}if(Xt.type==="text-delta"&&Xt.textDelta.length===0)return;const ns=Xt.type;switch(ns){case"text-delta":{if(x){const rs=_t&&Rt?Xt.textDelta.trimStart():Xt.textDelta;if(rs.length===0)break;_t=!1,Oe+=rs;const Cr=FUe(Oe);Cr!=null&&(Oe=Cr.suffix,await Un({controller:nn,chunk:{type:"text-delta",textDelta:Cr.prefix+Cr.whitespace}}))}else await Un({controller:nn,chunk:Xt});break}case"reasoning":{nn.enqueue(Xt),be==null?(be={type:"text",text:Xt.textDelta},ze.push(be)):be.text+=Xt.textDelta;break}case"reasoning-signature":{if(nn.enqueue(Xt),be==null)throw new HUe({chunk:Xt,message:"reasoning-signature without reasoning"});be.signature=Xt.signature,be=void 0;break}case"redacted-reasoning":{nn.enqueue(Xt),ze.push({type:"redacted",data:Xt.data});break}case"tool-call":{nn.enqueue(Xt),ot.push(Xt);break}case"tool-result":{nn.enqueue(Xt),B.push(Xt);break}case"response-metadata":{ve={id:(un=Xt.id)!=null?un:ve.id,timestamp:(mr=Xt.timestamp)!=null?mr:ve.timestamp,modelId:(Rr=Xt.modelId)!=null?Rr:ve.modelId};break}case"finish":{Ue=Xt.usage,_e=Xt.finishReason,kt=Xt.experimental_providerMetadata,J=Xt.logprobs;const rs=S()-Me;we.addEvent("ai.stream.finish"),we.setAttributes({"ai.response.msToFinish":rs,"ai.response.avgCompletionTokensPerSecond":1e3*Ue.completionTokens/rs});break}case"file":{st.push(Xt),nn.enqueue(Xt);break}case"source":case"tool-call-streaming-start":case"tool-call-delta":{nn.enqueue(Xt);break}case"error":{nn.enqueue(Xt),_e="error";break}default:{const rs=ns;throw new Error(`Unknown chunk type: ${rs}`)}}},async flush(Xt){const nn=ot.length>0?JSON.stringify(ot):void 0;let un="done";re+1<b&&(x&&_e==="length"&&ot.length===0?un="continue":ot.length>0&&B.length===ot.length&&(un="tool-result")),x&&Oe.length>0&&(un!=="continue"||ke==="continue"&&!Ge)&&(await Un({controller:Xt,chunk:{type:"text-delta",textDelta:Oe}}),Oe="");try{we.setAttributes(b0({telemetry:t,attributes:{"ai.response.finishReason":_e,"ai.response.text":{output:()=>Y},"ai.response.toolCalls":{output:()=>nn},"ai.response.id":ve.id,"ai.response.model":ve.modelId,"ai.response.timestamp":ve.timestamp.toISOString(),"ai.usage.promptTokens":Ue.promptTokens,"ai.usage.completionTokens":Ue.completionTokens,"gen_ai.response.finish_reasons":[_e],"gen_ai.response.id":ve.id,"gen_ai.response.model":ve.modelId,"gen_ai.usage.input_tokens":Ue.promptTokens,"gen_ai.usage.output_tokens":Ue.completionTokens}}))}catch{}finally{we.end()}Xt.enqueue({type:"step-finish",finishReason:_e,usage:Ue,providerMetadata:kt,experimental_providerMetadata:kt,logprobs:J,request:vt,response:{...ve,headers:ye==null?void 0:ye.headers},warnings:X,isContinued:un==="continue",messageId:ht});const mr=wUe(Be,Ue);if(un==="done")Xt.enqueue({type:"finish",finishReason:_e,usage:mr,providerMetadata:kt,experimental_providerMetadata:kt,logprobs:J,response:{...ve,headers:ye==null?void 0:ye.headers}}),Ae.closeStream();else{if(ke==="continue"){const Rr=Te[Te.length-1];typeof Rr.content=="string"?Rr.content+=Y:Rr.content.push({text:Y,type:"text"})}else Te.push(...KU({text:Y,files:st,reasoning:ze,tools:c??{},toolCalls:ot,toolResults:B,messageId:ht,generateMessageId:A}));await oe({currentStep:re+1,responseMessages:Te,usage:mr,stepType:un,previousStepText:G,hasLeadingWhitespace:tn,messageId:un==="continue"?ht:A()})}}})))}await oe({currentStep:0,responseMessages:[],usage:{promptTokens:0,completionTokens:0,totalTokens:0},previousStepText:"",stepType:"initial",hasLeadingWhitespace:!1,messageId:A()})}}).catch(le=>{Ae.addStream(new ReadableStream({start(oe){oe.enqueue({type:"error",error:le}),oe.close()}})),Ae.closeStream()})}get warnings(){return this.warningsPromise.value}get usage(){return this.usagePromise.value}get finishReason(){return this.finishReasonPromise.value}get experimental_providerMetadata(){return this.providerMetadataPromise.value}get providerMetadata(){return this.providerMetadataPromise.value}get text(){return this.textPromise.value}get reasoning(){return this.reasoningPromise.value}get reasoningDetails(){return this.reasoningDetailsPromise.value}get sources(){return this.sourcesPromise.value}get files(){return this.filesPromise.value}get toolCalls(){return this.toolCallsPromise.value}get toolResults(){return this.toolResultsPromise.value}get request(){return this.requestPromise.value}get response(){return this.responsePromise.value}get steps(){return this.stepsPromise.value}teeStream(){const[e,t]=this.baseStream.tee();return this.baseStream=t,e}get textStream(){return qI(this.teeStream().pipeThrough(new TransformStream({transform({part:e},t){e.type==="text-delta"&&t.enqueue(e.textDelta)}})))}get fullStream(){return qI(this.teeStream().pipeThrough(new TransformStream({transform({part:e},t){t.enqueue(e)}})))}async consumeStream(e){var t;try{await JUe({stream:this.fullStream,onError:e==null?void 0:e.onError})}catch(n){(t=e==null?void 0:e.onError)==null||t.call(e,n)}}get experimental_partialOutputStream(){if(this.output==null)throw new MUe;return qI(this.teeStream().pipeThrough(new TransformStream({transform({partialOutput:e},t){e!=null&&t.enqueue(e)}})))}toDataStreamInternal({getErrorMessage:e=()=>"An error occurred.",sendUsage:t=!0,sendReasoning:n=!1,sendSources:r=!1,experimental_sendFinish:s=!0}){return this.fullStream.pipeThrough(new TransformStream({transform:async(i,a)=>{const o=i.type;switch(o){case"text-delta":{a.enqueue(Aa("text",i.textDelta));break}case"reasoning":{n&&a.enqueue(Aa("reasoning",i.textDelta));break}case"redacted-reasoning":{n&&a.enqueue(Aa("redacted_reasoning",{data:i.data}));break}case"reasoning-signature":{n&&a.enqueue(Aa("reasoning_signature",{signature:i.signature}));break}case"file":{a.enqueue(Aa("file",{mimeType:i.mimeType,data:i.base64}));break}case"source":{r&&a.enqueue(Aa("source",i.source));break}case"tool-call-streaming-start":{a.enqueue(Aa("tool_call_streaming_start",{toolCallId:i.toolCallId,toolName:i.toolName}));break}case"tool-call-delta":{a.enqueue(Aa("tool_call_delta",{toolCallId:i.toolCallId,argsTextDelta:i.argsTextDelta}));break}case"tool-call":{a.enqueue(Aa("tool_call",{toolCallId:i.toolCallId,toolName:i.toolName,args:i.args}));break}case"tool-result":{a.enqueue(Aa("tool_result",{toolCallId:i.toolCallId,result:i.result}));break}case"error":{a.enqueue(Aa("error",e(i.error)));break}case"step-start":{a.enqueue(Aa("start_step",{messageId:i.messageId}));break}case"step-finish":{a.enqueue(Aa("finish_step",{finishReason:i.finishReason,usage:t?{promptTokens:i.usage.promptTokens,completionTokens:i.usage.completionTokens}:void 0,isContinued:i.isContinued}));break}case"finish":{s&&a.enqueue(Aa("finish_message",{finishReason:i.finishReason,usage:t?{promptTokens:i.usage.promptTokens,completionTokens:i.usage.completionTokens}:void 0}));break}default:{const l=o;throw new Error(`Unknown chunk type: ${l}`)}}}}))}pipeDataStreamToResponse(e,{status:t,statusText:n,headers:r,data:s,getErrorMessage:i,sendUsage:a,sendReasoning:o,sendSources:l,experimental_sendFinish:c}={}){zU({response:e,status:t,statusText:n,headers:$U(r,{contentType:"text/plain; charset=utf-8",dataStreamVersion:"v1"}),stream:this.toDataStream({data:s,getErrorMessage:i,sendUsage:a,sendReasoning:o,sendSources:l,experimental_sendFinish:c})})}pipeTextStreamToResponse(e,t){zU({response:e,status:t==null?void 0:t.status,statusText:t==null?void 0:t.statusText,headers:$U(t==null?void 0:t.headers,{contentType:"text/plain; charset=utf-8"}),stream:this.textStream.pipeThrough(new TextEncoderStream)})}toDataStream(e){const t=this.toDataStreamInternal({getErrorMessage:e==null?void 0:e.getErrorMessage,sendUsage:e==null?void 0:e.sendUsage,sendReasoning:e==null?void 0:e.sendReasoning,sendSources:e==null?void 0:e.sendSources,experimental_sendFinish:e==null?void 0:e.experimental_sendFinish}).pipeThrough(new TextEncoderStream);return e!=null&&e.data?M6(e==null?void 0:e.data.stream,t):t}mergeIntoDataStream(e,t){e.merge(this.toDataStreamInternal({getErrorMessage:e.onError,sendUsage:t==null?void 0:t.sendUsage,sendReasoning:t==null?void 0:t.sendReasoning,sendSources:t==null?void 0:t.sendSources,experimental_sendFinish:t==null?void 0:t.experimental_sendFinish}))}toDataStreamResponse({headers:e,status:t,statusText:n,data:r,getErrorMessage:s,sendUsage:i,sendReasoning:a,sendSources:o,experimental_sendFinish:l}={}){return new Response(this.toDataStream({data:r,getErrorMessage:s,sendUsage:i,sendReasoning:a,sendSources:o,experimental_sendFinish:l}),{status:t,statusText:n,headers:zk(e,{contentType:"text/plain; charset=utf-8",dataStreamVersion:"v1"})})}toTextStreamResponse(e){var t;return new Response(this.textStream.pipeThrough(new TextEncoderStream),{status:(t=e==null?void 0:e.status)!=null?t:200,headers:zk(e==null?void 0:e.headers,{contentType:"text/plain; charset=utf-8"})})}};var Tse="2024-11-05",iqe=[Tse,"2024-10-07"],aqe=Ke({name:$e(),version:$e()}).passthrough(),I6=Ke({_meta:na(Ke({}).passthrough())}).passthrough(),zw=I6,oqe=Ke({method:$e(),params:na(I6)}),lqe=Ke({experimental:na(Ke({}).passthrough()),logging:na(Ke({}).passthrough()),prompts:na(Ke({listChanged:na(br())}).passthrough()),resources:na(Ke({subscribe:na(br()),listChanged:na(br())}).passthrough()),tools:na(Ke({listChanged:na(br())}).passthrough())}).passthrough(),cqe=zw.extend({protocolVersion:$e(),capabilities:lqe,serverInfo:aqe,instructions:na($e())}),uqe=zw.extend({nextCursor:na($e())}),dqe=Ke({name:$e(),description:na($e()),inputSchema:Ke({type:An("object"),properties:na(Ke({}).passthrough())}).passthrough()}).passthrough(),fqe=uqe.extend({tools:on(dqe)}),hqe=Ke({type:An("text"),text:$e()}).passthrough(),pqe=Ke({type:An("image"),data:$e().base64(),mimeType:$e()}).passthrough(),Ase=Ke({uri:$e(),mimeType:na($e())}).passthrough(),mqe=Ase.extend({text:$e()}),gqe=Ase.extend({blob:$e().base64()}),yqe=Ke({type:An("resource"),resource:ps([mqe,gqe])}).passthrough(),bqe=zw.extend({content:on(ps([hqe,pqe,yqe])),isError:br().default(!1).optional()}).or(zw.extend({toolResult:Fy()})),$T="2.0",vqe=Ke({jsonrpc:An($T),id:ps([$e(),Tt().int()])}).merge(oqe).strict(),xqe=Ke({jsonrpc:An($T),id:ps([$e(),Tt().int()]),result:zw}).strict(),wqe=Ke({jsonrpc:An($T),id:ps([$e(),Tt().int()]),error:Ke({code:Tt().int(),message:$e(),data:na(Fy())})}).strict(),_qe=Ke({jsonrpc:An($T)}).merge(Ke({method:$e(),params:na(I6)})).strict(),Sqe=ps([vqe,_qe,xqe,wqe]),Cqe=class{constructor({url:e,headers:t}){this.connected=!1,this.url=new URL(e),this.headers=t}async start(){return new Promise((e,t)=>{if(this.connected)return e();this.abortController=new AbortController,(async()=>{var r,s,i;try{const a=new Headers(this.headers);a.set("Accept","text/event-stream");const o=await fetch(this.url.href,{headers:a,signal:(r=this.abortController)==null?void 0:r.signal});if(!o.ok||!o.body){const d=new ta({message:`MCP SSE Transport Error: ${o.status} ${o.statusText}`});return(s=this.onerror)==null||s.call(this,d),t(d)}const c=o.body.pipeThrough(new TextDecoderStream).pipeThrough(aG()).getReader(),u=async()=>{var d,h,m;try{for(;;){const{done:y,value:b}=await c.read();if(y){if(this.connected)throw this.connected=!1,new ta({message:"MCP SSE Transport Error: Connection closed unexpectedly"});return}const{event:v,data:x}=b;if(v==="endpoint"){if(this.endpoint=new URL(x,this.url),this.endpoint.origin!==this.url.origin)throw new ta({message:`MCP SSE Transport Error: Endpoint origin does not match connection origin: ${this.endpoint.origin}`});this.connected=!0,e()}else if(v==="message")try{const w=Sqe.parse(JSON.parse(x));(d=this.onmessage)==null||d.call(this,w)}catch(w){const S=new ta({message:"MCP SSE Transport Error: Failed to parse message",cause:w});(h=this.onerror)==null||h.call(this,S)}}}catch(y){if(y instanceof Error&&y.name==="AbortError")return;(m=this.onerror)==null||m.call(this,y),t(y)}};this.sseConnection={close:()=>c.cancel()},u()}catch(a){if(a instanceof Error&&a.name==="AbortError")return;(i=this.onerror)==null||i.call(this,a),t(a)}})()})}async close(){var e,t,n;this.connected=!1,(e=this.sseConnection)==null||e.close(),(t=this.abortController)==null||t.abort(),(n=this.onclose)==null||n.call(this)}async send(e){var t,n,r;if(!this.endpoint||!this.connected)throw new ta({message:"MCP SSE Transport Error: Not connected"});try{const s=new Headers(this.headers);s.set("Content-Type","application/json");const i={method:"POST",headers:s,body:JSON.stringify(e),signal:(t=this.abortController)==null?void 0:t.signal},a=await fetch(this.endpoint,i);if(!a.ok){const o=await a.text().catch(()=>null),l=new ta({message:`MCP SSE Transport Error: POSTing to endpoint (HTTP ${a.status}): ${o}`});(n=this.onerror)==null||n.call(this,l);return}}catch(s){(r=this.onerror)==null||r.call(this,s);return}}};function kqe(e){if(e.type!=="sse")throw new ta({message:"Unsupported or invalid transport configuration. If you are using a custom transport, make sure it implements the MCPTransport interface."});return new Cqe(e)}function Eqe(e){return"start"in e&&typeof e.start=="function"&&"send"in e&&typeof e.send=="function"&&"close"in e&&typeof e.close=="function"}var Tqe="1.0.0";async function YU(e){const t=new Aqe(e);return await t.init(),t}var Aqe=class{constructor({transport:e,name:t="ai-sdk-mcp-client",onUncaughtError:n}){this.requestMessageId=0,this.responseHandlers=new Map,this.serverCapabilities={},this.isClosed=!0,this.onUncaughtError=n,Eqe(e)?this.transport=e:this.transport=kqe(e),this.transport.onclose=()=>this.onClose(),this.transport.onerror=r=>this.onError(r),this.transport.onmessage=r=>{if("method"in r){this.onError(new ta({message:"Unsupported message type"}));return}this.onResponse(r)},this.clientInfo={name:t,version:Tqe}}async init(){try{await this.transport.start(),this.isClosed=!1;const e=await this.request({request:{method:"initialize",params:{protocolVersion:Tse,capabilities:{},clientInfo:this.clientInfo}},resultSchema:cqe});if(e===void 0)throw new ta({message:"Server sent invalid initialize result"});if(!iqe.includes(e.protocolVersion))throw new ta({message:`Server's protocol version is not supported: ${e.protocolVersion}`});return this.serverCapabilities=e.capabilities,await this.notification({method:"notifications/initialized"}),this}catch(e){throw await this.close(),e}}async close(){var e;this.isClosed||(await((e=this.transport)==null?void 0:e.close()),this.onClose())}assertCapability(e){switch(e){case"initialize":break;case"tools/list":case"tools/call":if(!this.serverCapabilities.tools)throw new ta({message:"Server does not support tools"});break;default:throw new ta({message:`Unsupported method: ${e}`})}}async request({request:e,resultSchema:t,options:n}){return new Promise((r,s)=>{if(this.isClosed)return s(new ta({message:"Attempted to send a request from a closed client"}));this.assertCapability(e.method);const i=n==null?void 0:n.signal;i==null||i.throwIfAborted();const a=this.requestMessageId++,o={...e,jsonrpc:"2.0",id:a},l=()=>{this.responseHandlers.delete(a)};this.responseHandlers.set(a,c=>{if(i!=null&&i.aborted)return s(new ta({message:"Request was aborted",cause:i.reason}));if(c instanceof Error)return s(c);try{const u=t.parse(c.result);r(u)}catch(u){const d=new ta({message:"Failed to parse server response",cause:u});s(d)}}),this.transport.send(o).catch(c=>{l(),s(c)})})}async listTools({params:e,options:t}={}){try{return this.request({request:{method:"tools/list",params:e},resultSchema:fqe,options:t})}catch(n){throw n}}async callTool({name:e,args:t,options:n}){try{return this.request({request:{method:"tools/call",params:{name:e,arguments:t}},resultSchema:bqe,options:{signal:n==null?void 0:n.abortSignal}})}catch(r){throw r}}async notification(e){const t={...e,jsonrpc:"2.0"};await this.transport.send(t)}async tools({schemas:e="automatic"}={}){var t;const n={};try{const r=await this.listTools();for(const{name:s,description:i,inputSchema:a}of r.tools){if(e!=="automatic"&&!(s in e))continue;const o=e==="automatic"?Are({...a,properties:(t=a.properties)!=null?t:{},additionalProperties:!1}):e[s].parameters,l=this,c={description:i,parameters:o,execute:async(u,d)=>{var h;return(h=d==null?void 0:d.abortSignal)==null||h.throwIfAborted(),l.callTool({name:s,args:u,options:d})}};n[s]=c}return n}catch(r){throw r}}onClose(){if(this.isClosed)return;this.isClosed=!0;const e=new ta({message:"Connection closed"});for(const t of this.responseHandlers.values())t(e);this.responseHandlers.clear()}onError(e){this.onUncaughtError&&this.onUncaughtError(e)}onResponse(e){const t=Number(e.id),n=this.responseHandlers.get(t);if(n===void 0)throw new ta({message:`Protocol error: Received a response for an unknown message ID: ${JSON.stringify(e)}`});this.responseHandlers.delete(t),n("result"in e?e:new ta({message:e.error.message,cause:e.error}))}},Rqe={};R6(Rqe,{mergeIntoDataStream:()=>Iqe,toDataStream:()=>Nqe,toDataStreamResponse:()=>Mqe});function Rse(e={}){const t=new TextEncoder;let n="";return new TransformStream({async start(){e.onStart&&await e.onStart()},async transform(r,s){s.enqueue(t.encode(r)),n+=r,e.onToken&&await e.onToken(r),e.onText&&typeof r=="string"&&await e.onText(r)},async flush(){e.onCompletion&&await e.onCompletion(n),e.onFinal&&await e.onFinal(n)}})}function j6(e,t){return e.pipeThrough(new TransformStream({transform:async(n,r)=>{var s;if(typeof n=="string"){r.enqueue(n);return}if("event"in n){n.event==="on_chat_model_stream"&&ZU((s=n.data)==null?void 0:s.chunk,r);return}ZU(n,r)}})).pipeThrough(Rse(t)).pipeThrough(new TextDecoderStream).pipeThrough(new TransformStream({transform:async(n,r)=>{r.enqueue(Aa("text",n))}}))}function Nqe(e,t){return j6(e,t).pipeThrough(new TextEncoderStream)}function Mqe(e,t){var n;const r=j6(e,t==null?void 0:t.callbacks).pipeThrough(new TextEncoderStream),s=t==null?void 0:t.data,i=t==null?void 0:t.init,a=s?M6(s.stream,r):r;return new Response(a,{status:(n=i==null?void 0:i.status)!=null?n:200,statusText:i==null?void 0:i.statusText,headers:zk(i==null?void 0:i.headers,{contentType:"text/plain; charset=utf-8",dataStreamVersion:"v1"})})}function Iqe(e,t){t.dataStream.merge(j6(e,t.callbacks))}function ZU(e,t){if(typeof e.content=="string")t.enqueue(e.content);else{const n=e.content;for(const r of n)r.type==="text"&&t.enqueue(r.text)}}var jqe={};R6(jqe,{mergeIntoDataStream:()=>Dqe,toDataStream:()=>Pqe,toDataStreamResponse:()=>Oqe});function P6(e,t){const n=Fqe();return hye(e[Symbol.asyncIterator]()).pipeThrough(new TransformStream({async transform(r,s){s.enqueue(n(r.delta))}})).pipeThrough(Rse(t)).pipeThrough(new TextDecoderStream).pipeThrough(new TransformStream({transform:async(r,s)=>{s.enqueue(Aa("text",r))}}))}function Pqe(e,t){return P6(e,t).pipeThrough(new TextEncoderStream)}function Oqe(e,t={}){var n;const{init:r,data:s,callbacks:i}=t,a=P6(e,i).pipeThrough(new TextEncoderStream),o=s?M6(s.stream,a):a;return new Response(o,{status:(n=r==null?void 0:r.status)!=null?n:200,statusText:r==null?void 0:r.statusText,headers:zk(r==null?void 0:r.headers,{contentType:"text/plain; charset=utf-8",dataStreamVersion:"v1"})})}function Dqe(e,t){t.dataStream.merge(P6(e,t.callbacks))}function Fqe(){let e=!0;return t=>(e&&(t=t.trimStart(),t&&(e=!1)),t)}class Lqe{static async executeInteraction(t,n,r){let s,i=!1,a=null,o,l,c;try{s=await nqe(n);for await(const u of s.fullStream){if(n.abortSignal.aborted){console.log(`[AIService] Stream ${t} aborted by signal.`);break}switch(u.type){case"text-delta":r.onChunk(u.textDelta);break;case"reasoning":r.onReasoningChunk(u.textDelta);break;case"tool-call":r.onToolCall(u);break;case"tool-result":r.onToolResult(u);break;case"step-start":r.onStepStart&&r.onStepStart({messageId:u.messageId,request:u.request,warnings:u.warnings||[]}),console.log(`[AIService] Step started for ${t} - Message ID: ${u.messageId}`);break;case"step-finish":r.onStepFinish&&r.onStepFinish({finishReason:u.finishReason,usage:u.usage,isContinued:u.isContinued||!1,warnings:u.warnings||[]}),console.log(`[AIService] Step finished for ${t} - Reason: ${u.finishReason}, Continued: ${u.isContinued}`);break;case"finish":i=!0,a=u.finishReason,o=u.usage,l=u.providerMetadata;break;case"error":r.onError(new Error(`AI Stream Error Part: ${u.error instanceof Error?u.error.message:u.error}`));return;default:console.warn(`[AIService] Received unexpected stream part type: ${u.type} for ${t}`,u);break}}s!=null&&s.reasoning?(c=await s.reasoning,console.log(`[AIService] Extracted final reasoning for ${t}`)):console.log(`[AIService] No final reasoning found in stream result for ${t}.`),!n.abortSignal.aborted&&i?r.onFinish({finishReason:a,usage:o,providerMetadata:l,reasoning:c}):!n.abortSignal.aborted&&!i&&(console.warn(`[AIService] Stream ${t} ended without a 'finish' part.`),r.onError(new Error("Stream ended unexpectedly without a finish signal.")))}catch(u){console.error(`[AIService] Error during streamText call for ${t}:`,u),u instanceof Error&&u.name==="AbortError"||r.onError(u instanceof Error?u:new Error(String(u)))}finally{console.log(`[AIService] Stream processing finished for ${t}.`)}}}const Bqe=".litechat/conversations",Nse="/synced_repos";async function $qe(e,t,n,r=!1){n(t.id,"syncing");const s=zr(`${Nse}/${t.id}`),i={username:t.username,password:t.password},a=t.branch||"main";try{let o=!1;try{await e.promises.stat(Pu(s,".git")),o=!0}catch(l){if(l.code==="ENOENT")o=!1;else throw l}o?(r||je.info(`Pulling latest changes for "${t.name}"...`),await nT(s,a,i,{fsInstance:e}),r||je.success(`Repository "${t.name}" synced successfully.`),n(t.id,"idle")):(r||je.info(`Cloning repository "${t.name}"...`),await pZ(s,t.remoteUrl,a,i,{fsInstance:e}),r||je.success(`Repository "${t.name}" cloned successfully.`),n(t.id,"idle"))}catch(o){console.error(`Failed to initialize/sync repository ${t.name}:`,o),n(t.id,"error")}}async function zqe(e,t,n,r,s,i,a,o=!1){var h,m;r(t.id,"syncing");const l=zr(`${Nse}/${n.id}`),c=Pu(l,Bqe,`${t.id}.json`),u={username:n.username,password:n.password},d=n.branch||"main";try{try{await e.promises.stat(Pu(l,".git"))}catch(w){if(w.code==="ENOENT"){je.error(`Repository "${n.name}" not found locally. Please clone/sync it from Settings first.`),r(t.id,"error","Repo not cloned");return}throw w}o||je.info(`Pulling latest changes for "${n.name}"...`),await nT(l,d,u,{fsInstance:e});let y=null,b=null;try{const w=await Yh(c,{fsInstance:e}),S=new TextDecoder().decode(w);y=JSON.parse(S),b=(h=y==null?void 0:y.conversation)!=null&&h.updatedAt?new Date(y.conversation.updatedAt).getTime():null,isNaN(b??NaN)&&(b=null)}catch(w){w.code==="ENOENT"?console.log(`Conversation file ${c} not found in repo. Will push local version.`):(console.error(`Failed to read or parse remote conversation file: ${w.message}`),je.warning(`Could not read remote version of conversation: ${w.message}`))}const v=t.updatedAt.getTime(),x=((m=t.lastSyncedAt)==null?void 0:m.getTime())??0;if(!y||v>(b??0)||v>x&&v>=(b??0)){o||je.info("Local changes detected. Pushing to remote...");const w=await Et.loadInteractionsForConversation(t.id),{lastSyncedAt:S,...C}=t,k=JSON.stringify({conversation:C,interactions:w},null,2);await rT(c,k,{fsInstance:e}),await cD(l,`Sync conversation: ${t.title} (${t.id})`,{fsInstance:e}),await uD(l,d,u,{fsInstance:e}),await s(t.id,{lastSyncedAt:new Date}),r(t.id,"idle"),o||je.success("Conversation synced successfully (pushed).")}else if(b&&b>v){o||je.info("Remote changes detected. Updating local conversation...");const w={...y.conversation,createdAt:new Date(y.conversation.createdAt),updatedAt:new Date(y.conversation.updatedAt),lastSyncedAt:new Date};await Et.saveConversation(w),await Et.deleteInteractionsForConversation(t.id);const S=y.interactions.map(C=>Et.saveInteraction({...C,conversationId:t.id,startedAt:C.startedAt?new Date(C.startedAt):null,endedAt:C.endedAt?new Date(C.endedAt):null}));await Promise.all(S),i()===t.id&&a()==="conversation"&&await $n.getState().loadInteractions(t.id),r(t.id,"idle"),o||je.success("Conversation synced successfully (pulled).")}else o||je.info("Conversation already up-to-date."),await s(t.id,{lastSyncedAt:new Date}),r(t.id,"idle")}catch(y){console.error(`Sync failed for conversation ${t.id}:`,y),r(t.id,"error",y.message)}}const va={loaded:"project.loaded",added:"project.added",updated:"project.updated",deleted:"project.deleted",loadingStateChanged:"project.loading.state.changed",loadProjectsRequest:"project.load.projects.request",addProjectRequest:"project.add.project.request",updateProjectRequest:"project.update.project.request",deleteProjectRequest:"project.delete.project.request"},Yn={conversationsLoaded:"conversation.conversations.loaded",selectedItemChanged:"conversation.selected.item.changed",conversationAdded:"conversation.added",conversationUpdated:"conversation.updated",conversationDeleted:"conversation.deleted",conversationSyncStatusChanged:"conversation.sync.status.changed",syncReposLoaded:"conversation.sync.repos.loaded",syncRepoChanged:"conversation.sync.repo.changed",syncRepoInitStatusChanged:"conversation.sync.repo.init.status.changed",loadingStateChanged:"conversation.loading.state.changed",loadConversationsRequest:"conversation.load.conversations.request",addConversationRequest:"conversation.add.conversation.request",updateConversationRequest:"conversation.update.conversation.request",deleteConversationRequest:"conversation.delete.conversation.request",selectItemRequest:"conversation.select.item.request",importConversationRequest:"conversation.import.conversation.request",exportConversationRequest:"conversation.export.conversation.request",exportProjectRequest:"conversation.export.project.request",exportAllConversationsRequest:"conversation.export.all.conversations.request",loadSyncReposRequest:"conversation.load.sync.repos.request",addSyncRepoRequest:"conversation.add.sync.repo.request",updateSyncRepoRequest:"conversation.update.sync.repo.request",deleteSyncRepoRequest:"conversation.delete.sync.repo.request",linkConversationToRepoRequest:"conversation.link.conversation.to.repo.request",syncConversationRequest:"conversation.sync.conversation.request",initializeOrSyncRepoRequest:"conversation.initialize.or.sync.repo.request",updateCurrentConversationToolSettingsRequest:"conversation.update.current.conversation.tool.settings.request"},Fo=$o(zo((e,t)=>({projects:[],isLoading:!1,error:null,loadProjects:async()=>{e({isLoading:!0,error:null});try{const n=await Et.loadProjects();e({projects:n,isLoading:!1}),Pe.emit(va.loaded,{projects:n})}catch(n){console.error("ProjectStore: Error loading projects",n),e({error:"Failed to load projects",isLoading:!1}),Pe.emit(va.loadingStateChanged,{isLoading:!1,error:"Failed to load projects"})}},addProject:async n=>{var l;const r=Vi(),s=new Date,i=n.parentId?((l=t().getProjectById(n.parentId))==null?void 0:l.path)??"/":"/",a=zr(`${i}/${n.name.replace(/\s+/g,"-").toLowerCase()}-${r.substring(0,4)}`),o={id:r,path:a,createdAt:s,updatedAt:s,name:n.name,parentId:n.parentId??null,systemPrompt:n.systemPrompt??null,modelId:n.modelId??null,temperature:n.temperature??null,maxTokens:n.maxTokens??null,topP:n.topP??null,topK:n.topK??null,presencePenalty:n.presencePenalty??null,frequencyPenalty:n.frequencyPenalty??null,defaultTagIds:n.defaultTagIds??null,defaultRuleIds:n.defaultRuleIds??null,metadata:n.metadata??{}};try{return await Et.saveProject(o),e(c=>{c.projects.unshift(o),c.projects.sort((u,d)=>d.updatedAt.getTime()-u.updatedAt.getTime())}),Pe.emit(va.added,{project:o}),r}catch(c){throw console.error("ProjectStore: Error adding project",c),e({error:"Failed to save new project"}),c}},updateProject:async(n,r)=>{var a;const s=t().getProjectById(n);if(!s){console.warn(`ProjectStore: Project ${n} not found for update.`);return}const i={...s,...r,updatedAt:new Date};if(r.name&&r.name!==s.name){const o=s.parentId?((a=t().getProjectById(s.parentId))==null?void 0:a.path)??"/":"/";i.path=zr(`${o}/${r.name.replace(/\s+/g,"-").toLowerCase()}-${n.substring(0,4)}`)}try{await Et.saveProject(i),e(o=>{const l=o.projects.findIndex(c=>c.id===n);l!==-1&&(o.projects[l]=i,o.projects.sort((c,u)=>u.updatedAt.getTime()-c.updatedAt.getTime()))}),Pe.emit(va.updated,{projectId:n,updates:i})}catch(o){throw console.error("ProjectStore: Error updating project",o),e({error:"Failed to save project update"}),o}},deleteProject:async n=>{const r=t().projects.find(a=>a.id===n);if(!r)return;const s=new Set,i=a=>{s.add(a),t().projects.filter(o=>o.parentId===a).forEach(o=>i(o.id))};i(n);try{await Et.deleteProject(n),e(a=>({projects:a.projects.filter(o=>!s.has(o.id))})),Pe.emit(Yn.loadConversationsRequest,void 0),Pe.emit(va.deleted,{projectId:n}),je.success(`Project "${r.name}" and its contents deleted.`)}catch(a){throw console.error("ProjectStore: Error deleting project",a),e({error:"Failed to delete project"}),a}},getProjectById:n=>{if(n)return t().projects.find(r=>r.id===n)},getTopLevelProjectId:n=>{if(!n)return null;let r=t().getProjectById(n);if(!r)return null;for(;r.parentId;){const s=t().getProjectById(r.parentId);if(!s)break;r=s}return r.id},getEffectiveProjectSettings:n=>{const r=yr.getState(),s=Nr.getState().selectedModelId,i={systemPrompt:r.globalSystemPrompt,modelId:s,temperature:r.temperature,maxTokens:r.maxTokens,topP:r.topP,topK:r.topK,presencePenalty:r.presencePenalty,frequencyPenalty:r.frequencyPenalty,defaultTagIds:null,defaultRuleIds:null};if(!n)return i;const a=t().getProjectById(n);if(!a)return i;const o=a.parentId?t().getEffectiveProjectSettings(a.parentId):i;return{systemPrompt:a.systemPrompt!==null&&a.systemPrompt!==void 0?a.systemPrompt:o.systemPrompt,modelId:a.modelId!==null&&a.modelId!==void 0?a.modelId:o.modelId,temperature:a.temperature!==null&&a.temperature!==void 0?a.temperature:o.temperature,maxTokens:a.maxTokens!==null&&a.maxTokens!==void 0?a.maxTokens:o.maxTokens,topP:a.topP!==null&&a.topP!==void 0?a.topP:o.topP,topK:a.topK!==null&&a.topK!==void 0?a.topK:o.topK,presencePenalty:a.presencePenalty!==null&&a.presencePenalty!==void 0?a.presencePenalty:o.presencePenalty,frequencyPenalty:a.frequencyPenalty!==null&&a.frequencyPenalty!==void 0?a.frequencyPenalty:o.frequencyPenalty,defaultTagIds:a.defaultTagIds!==null&&a.defaultTagIds!==void 0?a.defaultTagIds:o.defaultTagIds,defaultRuleIds:a.defaultRuleIds!==null&&a.defaultRuleIds!==void 0?a.defaultRuleIds:o.defaultRuleIds}},getRegisteredActionHandlers:()=>{const n="projectStore",r=t(),s=i=>async a=>{await i(a)};return[{eventName:va.loadProjectsRequest,handler:r.loadProjects,storeId:n},{eventName:va.addProjectRequest,handler:s(r.addProject),storeId:n},{eventName:va.updateProjectRequest,handler:i=>r.updateProject(i.id,i.updates),storeId:n},{eventName:va.deleteProjectRequest,handler:i=>r.deleteProject(i.id),storeId:n}]}}))),e2=(e,t)=>{const n=URL.createObjectURL(e),r=document.createElement("a");r.href=n,r.download=t,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(n)},Uqe=(e,t)=>{let n=`# ${e.title}

`;return n+=`*Conversation ID: ${e.id}*
`,n+=`*Created: ${gw(e.createdAt,"yyyy-MM-dd HH:mm:ss")}*
`,n+=`*Last Updated: ${gw(e.updatedAt,"yyyy-MM-dd HH:mm:ss")}*
`,e.projectId&&(n+=`*Project ID: ${e.projectId}*
`),n+=`
---

`,t.filter(r=>r.type==="message.user_assistant").sort((r,s)=>r.index-s.index).forEach(r=>{var s,i,a,o,l,c,u,d;((s=r.prompt)!=null&&s.content||(o=(a=(i=r.prompt)==null?void 0:i.metadata)==null?void 0:a.attachedFiles)!=null&&o.length)&&(n+=`## User (Index: ${r.index})

`,(l=r.prompt.metadata)!=null&&l.attachedFiles&&r.prompt.metadata.attachedFiles.length>0&&(n+=`**Attached Files:**
`,r.prompt.metadata.attachedFiles.forEach(h=>{n+=`- ${h.name} (${h.type}, ${iw(h.size)}) ${h.source==="vfs"?`(VFS: ${h.path})`:"(Direct Upload)"}
`}),n+=`
`),r.prompt.content&&(n+=`${r.prompt.content}

`)),r.response&&(n+=`## Assistant (Index: ${r.index})

`,(c=r.metadata)!=null&&c.modelId&&(n+=`*Model: ${r.metadata.modelId}*

`),typeof r.response=="string"?n+=`${r.response}

`:(n+="```json\n",n+=`${JSON.stringify(r.response,null,2)}
`,n+="```\n\n"),((u=r.metadata)!=null&&u.promptTokens||(d=r.metadata)!=null&&d.completionTokens)&&(n+=`*Tokens: ${r.metadata.promptTokens??"?"} (prompt) / ${r.metadata.completionTokens??"?"} (completion)*

`)),n+=`---

`}),n};class v0{static async importConversation(t,n,r){try{const s=await t.text(),i=JSON.parse(s);if(!i||typeof i!="object"||!i.conversation||!Array.isArray(i.interactions))throw new Error("Invalid import file format. Expected { conversation: {}, interactions: [] }.");const a=i.conversation,o=i.interactions;if(!a.id||!a.title||!a.createdAt||!a.updatedAt)throw new Error("Invalid conversation data in import file.");const l=await n({title:a.title||"Imported Chat",metadata:a.metadata,projectId:null,syncRepoId:null,lastSyncedAt:null}),c=o.map(u=>Et.saveInteraction({...u,conversationId:l,id:Vi()}));await Promise.all(c),await r(l,"conversation"),je.success("Conversation imported successfully.")}catch(s){throw console.error("ImportExportService: Error importing conversation",s),je.error(`Import failed: ${s instanceof Error?s.message:String(s)}`),s}}static async exportConversation(t,n){try{const r=qn.getState().getConversationById(t);if(!r)throw new Error("Conversation not found.");const s=await Et.loadInteractionsForConversation(t);let i,a;const o=r.title.replace(/[^a-z0-9]/gi,"_").toLowerCase()||"conversation";if(n==="json"){const c=JSON.stringify({conversation:r,interactions:s},null,2);i=new Blob([c],{type:"application/json"}),a=`litechat_conversation_${o}_${t.substring(0,6)}.json`}else if(n==="md"){const l=Uqe(r,s);i=new Blob([l],{type:"text/markdown"}),a=`litechat_conversation_${o}_${t.substring(0,6)}.md`}else throw new Error("Invalid export format specified.");e2(i,a),je.success(`Conversation exported as ${n.toUpperCase()}.`)}catch(r){throw console.error("ImportExportService: Error exporting conversation",r),je.error(`Export failed: ${r instanceof Error?r.message:String(r)}`),r}}static async exportProject(t){try{const{projects:n,getProjectById:r}=Fo.getState(),{conversations:s}=qn.getState(),i=r(t);if(!i)throw new Error("Project not found.");const a=async h=>{const m=n.find(x=>x.id===h);if(!m)throw new Error(`Project ${h} not found in state.`);const y=n.filter(x=>x.parentId===h),b=s.filter(x=>x.projectId===h),v=[];for(const x of y)v.push(await a(x.id));for(const x of b){const w=await Et.loadInteractionsForConversation(x.id);v.push({conversation:x,interactions:w})}return{project:m,children:v}},o=await a(t),l=JSON.stringify(o,null,2),c=new Blob([l],{type:"application/json"}),d=`litechat_project_${i.name.replace(/[^a-z0-9]/gi,"_").toLowerCase()||"project"}_${t.substring(0,6)}.json`;e2(c,d),je.success(`Project "${i.name}" exported.`)}catch(n){throw console.error("ImportExportService: Error exporting project",n),je.error(`Project export failed: ${n instanceof Error?n.message:String(n)}`),n}}static async exportAllConversations(){try{const t=qn.getState().conversations,n=[];for(const a of t){const o=await Et.loadInteractionsForConversation(a.id);n.push({conversation:a,interactions:o})}const r=JSON.stringify(n,null,2),s=new Blob([r],{type:"application/json"}),i=`litechat_all_conversations_export_${new Date().toISOString().split("T")[0]}.json`;e2(s,i),je.success("All conversations exported.")}catch(t){throw console.error("ImportExportService: Error exporting conversations",t),je.error(`Export failed: ${t instanceof Error?t.message:String(t)}`),t}}static async exportFullConfiguration(t){try{const n=await Et.getAllDataForExport(t),r=JSON.stringify(n,null,2),s=new Blob([r],{type:"application/json"}),i=`litechat_full_export_${new Date().toISOString().split("T")[0]}.json`;e2(s,i),je.success("Full configuration exported successfully.")}catch(n){throw console.error("ImportExportService: Error exporting full configuration",n),je.error(`Full export failed: ${n instanceof Error?n.message:String(n)}`),n}}static async importFullConfiguration(t,n){try{const r=await t.text(),s=JSON.parse(r);if(!s||typeof s!="object"||!s.version)throw new Error("Invalid import file format. Missing version or basic structure.");await Et.importAllData(s,n),je.success("Configuration imported successfully. Reloading application..."),setTimeout(()=>window.location.reload(),1500)}catch(r){throw console.error("ImportExportService: Error importing full configuration",r),je.error(`Full import failed: ${r instanceof Error?r.message:String(r)}`),r}}}const tu="sync_repos",us={repoChanged:"sync.repo.changed",repoInitStatusChanged:"sync.repo.init.status.changed",bulkSyncStarted:"sync.bulk.sync.started",bulkSyncProgress:"sync.bulk.sync.progress",bulkSyncCompleted:"sync.bulk.sync.completed",bulkSyncFailed:"sync.bulk.sync.failed"},Js=$o(zo((e,t)=>({nodes:{},childrenMap:{"":[]},rootId:null,currentParentId:null,selectedFileIds:new Set,loading:!1,operationLoading:!1,error:null,fs:null,enableVfs:!0,vfsKey:null,configuredVfsKey:null,initializingKey:null,_setLoading:n=>{e(r=>{r.loading=n,n&&(r.error=null)}),Pe.emit(dn.loadingStateChanged,{isLoading:t().loading,operationLoading:t().operationLoading,error:t().error})},_setOperationLoading:n=>{e(r=>{r.operationLoading=n}),Pe.emit(dn.loadingStateChanged,{isLoading:t().loading,operationLoading:t().operationLoading,error:t().error})},_setError:n=>{e(r=>{r.error=n,r.loading=!1,r.operationLoading=!1,r.initializingKey=null,n&&je.error(`VFS Error: ${n}`)}),Pe.emit(dn.loadingStateChanged,{isLoading:t().loading,operationLoading:t().operationLoading,error:t().error})},_addNodes:n=>{e(r=>{const s={};n.forEach(i=>{r.nodes[i.id]=i;const a=i.parentId??r.rootId??"";s[a]||(s[a]=r.childrenMap[a]?[...r.childrenMap[a]]:[]),s[a].includes(i.id)||s[a].push(i.id)});for(const i in s)(!r.childrenMap[i]||JSON.stringify(r.childrenMap[i].sort())!==JSON.stringify(s[i].sort()))&&(r.childrenMap[i]=s[i])}),Pe.emit(dn.nodesUpdated,{vfsKey:t().vfsKey,nodes:t().nodes,childrenMap:t().childrenMap})},_updateNode:(n,r)=>{e(s=>{s.nodes[n]&&Object.assign(s.nodes[n],r)}),Pe.emit(dn.nodesUpdated,{vfsKey:t().vfsKey,nodes:t().nodes,childrenMap:t().childrenMap})},_removeNodes:n=>{e(r=>{n.forEach(s=>{const i=r.nodes[s];if(i){const a=i.parentId??r.rootId??"";if(r.childrenMap[a]&&(r.childrenMap[a]=r.childrenMap[a].filter(o=>o!==s)),delete r.nodes[s],r.selectedFileIds.delete(s),i.type==="folder"){const o=Object.values(r.nodes).filter(l=>l.parentId===s).map(l=>l.id);o.length>0&&t()._removeNodes(o),delete r.childrenMap[s]}}})}),Pe.emit(dn.nodesUpdated,{vfsKey:t().vfsKey,nodes:t().nodes,childrenMap:t().childrenMap}),Pe.emit(dn.selectionChanged,{selectedFileIds:Array.from(t().selectedFileIds)})},_setFsInstance:n=>{e({fs:n}),Pe.emit(dn.fsInstanceChanged,{fsInstance:n})},_setEnableVfs:n=>{console.log(`[VfsStore] Setting global enableVfs to: ${n}`),e({enableVfs:n}),Pe.emit(dn.vfsEnabledChanged,{enabled:n}),n||(e({fs:null,configuredVfsKey:null,vfsKey:null,rootId:null,currentParentId:null,nodes:{},childrenMap:{"":[]},error:null,loading:!1,operationLoading:!1,initializingKey:null}),Pe.emit(dn.vfsKeyChanged,{vfsKey:null,configuredVfsKey:null}))},_setConfiguredVfsKey:n=>{e({configuredVfsKey:n}),Pe.emit(dn.vfsKeyChanged,{vfsKey:t().vfsKey,configuredVfsKey:n})},setVfsKey:n=>{if(n!==null){const r=t().vfsKey,s=t().configuredVfsKey;if(n===r){n&&n!==s&&!t().initializingKey&&t().initializeVFS(n).catch(i=>{console.error(`[VfsStore] Error during re-initialization trigger for ${n}:`,i)});return}console.log(`[VfsStore] setVfsKey: Changing desired key from ${r} to ${n}. Configured: ${s}`),e({vfsKey:n}),e({fs:null,configuredVfsKey:null,rootId:null,currentParentId:null,nodes:{},childrenMap:{"":[]},error:null,loading:!1,operationLoading:!1,selectedFileIds:new Set,initializingKey:null}),Pe.emit(dn.vfsKeyChanged,{vfsKey:n,configuredVfsKey:null}),n!==null&&t().initializeVFS(n).catch(i=>{console.error(`[VfsStore] Error during initialization trigger for ${n}:`,i)})}},initializeVFS:async(n,r)=>{let s,i;if(typeof n=="object"&&n!==null&&"vfsKey"in n)console.warn("[VfsStore] initializeVFS called with a single object payload. Correcting. Input:",JSON.parse(JSON.stringify(n))),s=String(n.vfsKey),i=n.options;else if(typeof n=="string")s=n,i=r;else{const h=`[VfsStore] initializeVFS called with invalid vfsKey type. Type: ${typeof n}, Value: "${String(n)}". Aborting.`;throw console.error(h,n),new Error("VFS key must be a string and cannot be empty.")}if(!s||s.trim()===""){const h=`[VfsStore] initializeVFS: Derived vfsKey is empty or invalid. Original param: ${String(n)}, Derived key: "${s}". Aborting.`;throw console.error(h,{originalVfsKeyParam:n,originalOptionsParam:r}),new Error("VFS key cannot be empty after processing.")}const a=(i==null?void 0:i.force)===!0;if(t().initializingKey===s){const h=`Initialization skipped for "${s}". Already actively initializing this exact key.`;return console.warn(`[VfsStore] ${h}`),new Promise((m,y)=>{const b=setInterval(()=>{const v=t();v.initializingKey!==s&&(clearInterval(b),v.configuredVfsKey===s&&v.fs?m(v.fs):y(new Error(`VFS initialization for "${s}" failed or was interrupted`)))},100);setTimeout(()=>{clearInterval(b),y(new Error(`Timeout waiting for VFS "${s}" initialization to complete`))},1e4)})}if(t().configuredVfsKey===s&&t().fs)return a||e({loading:!1}),t().fs;if(!a){if(t().vfsKey!==s){const h=`UI Initialization aborted for "${s}". Desired key is now "${t().vfsKey}".`;throw console.warn(`[VfsStore] ${h}`),new Error(h)}if(t().initializingKey!==null&&t().initializingKey!==s){const h=`UI Initialization skipped for "${s}". Already initializing a different key "${t().initializingKey}".`;throw console.warn(`[VfsStore] ${h}`),new Error(h)}}const{_setLoading:o,_setError:l,_addNodes:c,_setFsInstance:u,_setConfiguredVfsKey:d}=t();console.log(`[VfsStore] Initializing VFS with key: ${s} (Forced: ${a})`),e({initializingKey:s}),a||(o(!0),l(null));try{const h=await dTe(s);if(!h)throw new Error("Filesystem backend initialization failed.");if(!a&&t().vfsKey!==s){const b=`UI Initialization for key "${s}" completed, but desired key changed to "${t().vfsKey}". Discarding result.`;throw console.warn(`[VfsStore] ${b}`),e({initializingKey:null,loading:!1}),new Error(b)}if(a)return u(h),d(s),e({initializingKey:null}),Pe.emit(dn.loadingStateChanged,{isLoading:!1,operationLoading:!1,error:null}),h;u(h),d(s),console.log(`[VfsStore] UI VFS instance configured for key: ${s}`);const m="vfs-root";let y=t().nodes[m];try{await h.promises.stat("/")}catch(b){if(b.code==="ENOENT")console.warn("[VfsStore] Root directory '/' not found, will be created implicitly.");else throw b}if(!y||y.path!=="/"){const b=Date.now();y={id:m,parentId:null,name:"",path:"/",type:"folder",createdAt:b,lastModified:b},c([y])}return e(b=>{b.rootId=y.id,b.currentParentId=y.id}),await t().fetchNodes(y.id),h}catch(h){const m=`Failed to initialize VFS (${s}): ${h instanceof Error?h.message:String(h)}`;throw console.error(`[VfsStore DEBUG] Error in initializeVFS catch block: ${m}`,h),t().initializingKey===s&&(l(m),a||(u(null),d(null))),new Error(m)}finally{t().initializingKey===s&&(e({initializingKey:null}),a||e({loading:!1}))}},fetchNodes:async(n=null)=>{const{_setLoading:r,_setError:s,_addNodes:i,fs:a,nodes:o,rootId:l,configuredVfsKey:c,vfsKey:u,initializingKey:d}=t();if(!a||c!==u||d){console.warn(`[VfsStore] fetchNodes skipped. Ready: ${!!a}, Match: ${c===u}, Init: ${d}`);return}r(!0);try{const h=n?o[n]:o[l||""],m=h?h.path:"/",y=await dD(m,{fsInstance:a}),b=n??l??"",v=new Set(y.map(k=>k.path)),S=(t().childrenMap[b]||[]).map(k=>t().nodes[k]).filter(Boolean).filter(k=>!v.has(k.path)).map(k=>k.id);S.length>0&&t()._removeNodes(S);const C=y.map(k=>{const A=Object.values(t().nodes).find(N=>N.path===k.path),R=Date.now();return{id:(A==null?void 0:A.id)||Vi(),parentId:n,name:k.name,path:k.path,type:k.isDirectory?"folder":"file",size:k.size,createdAt:(A==null?void 0:A.createdAt)??R,lastModified:k.lastModified.getTime(),mimeType:k.isDirectory?void 0:k.mimeType}});C.length>0&&i(C),e(k=>{const A=C.map(R=>R.id);(!k.childrenMap[b]||JSON.stringify(k.childrenMap[b].sort())!==JSON.stringify(A.sort()))&&(k.childrenMap[b]=A)})}catch(h){console.error("Failed to fetch VFS nodes:",h),s("Failed to load directory contents.")}finally{r(!1)}},findNodeByPath:n=>{const r=zr(n);if(t().vfsKey===t().configuredVfsKey){if(r==="/"){const s=t().rootId;return s?t().nodes[s]:void 0}return Object.values(t().nodes).find(s=>s.path===r)}},setCurrentPath:async n=>{const{findNodeByPath:r,fetchNodes:s,rootId:i,fs:a}=t();if(!a||t().vfsKey!==t().configuredVfsKey)return;const o=zr(n),l=r(o);l&&l.type==="folder"?(e(c=>{c.currentParentId=l.id}),t().childrenMap[l.id]||await s(l.id)):o==="/"&&i?(e(c=>{c.currentParentId=i}),t().childrenMap[i]||await s(i)):console.warn(`Path not found or not a directory: ${n}`)},createDirectory:async(n,r)=>{const{_setOperationLoading:s,_setError:i,fs:a,nodes:o,rootId:l,_addNodes:c,configuredVfsKey:u,vfsKey:d}=t();if(!a||u!==d){i("Filesystem not ready.");return}if(!r.trim()){i("Directory name cannot be empty.");return}s(!0);try{const h=n?o[n]:o[l||""],m=h?h.path:"/",y=kj(m,r.trim());try{throw await a.promises.stat(y),new Error(`"${r.trim()}" already exists.`)}catch(w){if(w.code!=="ENOENT")throw w}await yZ(y,{fsInstance:a});const b=Date.now(),x={id:Vi(),parentId:n,name:r.trim(),path:y,type:"folder",createdAt:b,lastModified:b};c([x])}catch(h){console.error("Failed to create directory:",h),i(h.message||"Failed to create directory.")}finally{s(!1)}},uploadFiles:async(n,r)=>{const{_setOperationLoading:s,_setError:i,fs:a,nodes:o,rootId:l,configuredVfsKey:c,vfsKey:u}=t();if(!a||c!==u){i("Filesystem not ready.");return}s(!0);try{const d=n?o[n]:o[l||""],h=d?d.path:"/";await bZ(Array.from(r),h,{fsInstance:a}),await t().fetchNodes(n)}catch(d){console.error("Failed to upload files:",d),i("Failed to upload one or more files.")}finally{s(!1)}},deleteNodes:async n=>{const{_setOperationLoading:r,_setError:s,_removeNodes:i,fs:a,configuredVfsKey:o,vfsKey:l}=t();if(!a||o!==l){s("Filesystem not ready.");return}r(!0);try{const c=n.map(u=>t().nodes[u]).filter(Boolean);for(const u of c)await fD(u.path,u.type==="folder",{fsInstance:a});i(n)}catch(c){console.error("Failed to delete nodes:",c),s("Failed to delete one or more items."),await t().fetchNodes(t().currentParentId)}finally{r(!1)}},renameNode:async(n,r)=>{const{_setOperationLoading:s,_setError:i,_updateNode:a,nodes:o,fs:l,rootId:c,configuredVfsKey:u,vfsKey:d}=t();if(!l||u!==d){i("Filesystem not ready.");return}if(!r.trim()){i("Name cannot be empty.");return}const h=o[n];if(!h){i("Item not found.");return}if(h.name!==r.trim()){s(!0);try{const m=h.parentId?o[h.parentId]:o[c||""],y=m?m.path:"/",b=kj(y,r.trim());try{throw await l.promises.stat(b),new Error(`"${r.trim()}" already exists.`)}catch(x){if(x.code!=="ENOENT")throw x}await vZ(h.path,b,{fsInstance:l});const v={name:r.trim(),path:b,lastModified:Date.now()};a(n,v)}catch(m){console.error("Failed to rename item:",m),i(m.message||"Failed to rename item.")}finally{s(!1)}}},downloadFile:async n=>{const{nodes:r,fs:s,_setError:i,configuredVfsKey:a,vfsKey:o}=t();if(!s||a!==o)return i("Filesystem not ready."),null;const l=r[n];if(!l||l.type!=="file")return i("File not found."),null;try{const c=await Yh(l.path,{fsInstance:s}),u=l.mimeType||"application/octet-stream",d=new Blob([c],{type:u});return{name:l.name,blob:d}}catch(c){return console.error("Failed to download file:",c),i("Failed to retrieve file content."),null}},selectFile:n=>{e(r=>{r.selectedFileIds.add(n)}),Pe.emit(dn.selectionChanged,{selectedFileIds:Array.from(t().selectedFileIds)})},deselectFile:n=>{e(r=>{r.selectedFileIds.delete(n)}),Pe.emit(dn.selectionChanged,{selectedFileIds:Array.from(t().selectedFileIds)})},clearSelection:()=>{e(n=>{n.selectedFileIds.clear()}),Pe.emit(dn.selectionChanged,{selectedFileIds:[]})},resetStuckInitialization:()=>{console.warn("[VfsStore] Force resetting stuck initialization state"),e({initializingKey:null,loading:!1,operationLoading:!1,error:null})},getRegisteredActionHandlers:()=>{const n="vfsStore",r=t(),s=i=>async a=>{await i(a)};return[{eventName:dn.setVfsKeyRequest,handler:i=>r.setVfsKey(i.key),storeId:n},{eventName:dn.initializeVFSRequest,handler:async i=>{await r.initializeVFS(i.vfsKey,i.options)},storeId:n},{eventName:dn.fetchNodesRequest,handler:i=>r.fetchNodes(i.parentId),storeId:n},{eventName:dn.setCurrentPathRequest,handler:i=>r.setCurrentPath(i.path),storeId:n},{eventName:dn.createDirectoryRequest,handler:i=>r.createDirectory(i.parentId,i.name),storeId:n},{eventName:dn.uploadFilesRequest,handler:i=>r.uploadFiles(i.parentId,i.files),storeId:n},{eventName:dn.deleteNodesRequest,handler:i=>r.deleteNodes(i.ids),storeId:n},{eventName:dn.renameNodeRequest,handler:i=>r.renameNode(i.id,i.newName),storeId:n},{eventName:dn.downloadFileRequest,handler:s(r.downloadFile),storeId:n},{eventName:dn.selectFileRequest,handler:i=>r.selectFile(i.fileId),storeId:n},{eventName:dn.deselectFileRequest,handler:i=>r.deselectFile(i.fileId),storeId:n},{eventName:dn.clearSelectionRequest,handler:r.clearSelection,storeId:n},{eventName:dn.setEnableVfsRequest,handler:i=>r._setEnableVfs(i.enabled),storeId:n}]}}))),qqe="/synced_repos",qn=$o(zo((e,t)=>({conversations:[],selectedItemId:null,selectedItemType:null,syncRepos:[],conversationSyncStatus:{},repoInitializationStatus:{},isLoading:!1,error:null,_ensureSyncVfsReady:async()=>(console.log("[ConversationStore] Ensuring Sync VFS is ready..."),Js.getState().initializingKey===tu&&(console.warn("[ConversationStore] VFS appears stuck in initializing state, resetting..."),Js.getState().resetStuckInitialization()),new Promise((r,s)=>{let i=null;const a=()=>{Pe.off(dn.fsInstanceChanged,o),Pe.off(dn.loadingStateChanged,l),i&&(clearTimeout(i),i=null)},o=u=>{Js.getState().configuredVfsKey===tu&&u.fsInstance&&(console.log(`[ConversationStore] Sync VFS ready via fsInstanceChanged for key ${tu}.`),a(),r(u.fsInstance))},l=u=>{const d=Js.getState();d.configuredVfsKey===tu&&(u.error?(console.error(`[ConversationStore] Sync VFS initialization error for key ${tu}: ${u.error}`),a(),s(new Error(u.error))):!u.isLoading&&!u.operationLoading&&d.fs&&(console.log(`[ConversationStore] Sync VFS ready via loadingStateChanged for key ${tu}.`),a(),r(d.fs)))};Pe.on(dn.fsInstanceChanged,o),Pe.on(dn.loadingStateChanged,l);const c=Js.getState();if(c.configuredVfsKey===tu&&c.fs&&!c.loading&&!c.operationLoading&&!c.error){console.log(`[ConversationStore] Sync VFS already ready for key ${tu}.`),a(),r(c.fs);return}i=setTimeout(()=>{const u=`Timeout waiting for Sync VFS (${tu}) to become ready.`;console.error(`[ConversationStore] ${u}`),a(),s(new Error(u))},3e4),Pe.emit(dn.initializeVFSRequest,{vfsKey:tu,options:{force:!0}})})),loadConversations:async()=>{e({isLoading:!0,error:null});try{const[n,r]=await Promise.all([Et.loadConversations(),Et.loadSyncRepos()]),s={};n.forEach(i=>{if(i.syncRepoId){const a=i.lastSyncedAt instanceof Date?i.lastSyncedAt.getTime():null,o=i.updatedAt instanceof Date?i.updatedAt.getTime():null;a?o&&o>a?s[i.id]="needs-sync":s[i.id]="idle":s[i.id]="needs-sync"}else s[i.id]="idle"}),e({conversations:n,syncRepos:r,conversationSyncStatus:s,repoInitializationStatus:{},isLoading:!1}),Pe.emit(Yn.conversationsLoaded,{conversations:n}),Pe.emit(Yn.syncReposLoaded,{repos:r})}catch(n){console.error("ConversationStore: Error loading conversations",n),e({error:"Failed load conversations",isLoading:!1}),Pe.emit(Yn.loadingStateChanged,{isLoading:!1,error:"Failed load conversations"})}},addConversation:async n=>{const r=Vi(),s=new Date,i={id:r,createdAt:s,updatedAt:s,title:n.title,projectId:n.projectId??null,metadata:{...n.metadata??{},enabledTools:[],toolMaxStepsOverride:null},syncRepoId:n.syncRepoId??null,lastSyncedAt:n.lastSyncedAt??null};let a=!1;try{const o=JSON.stringify(i);return await Et.saveConversation(JSON.parse(o)),a=!0,e(l=>{l.conversations.some(c=>c.id===i.id)||(l.conversations.unshift(i),l.conversationSyncStatus[r]=i.syncRepoId?"needs-sync":"idle")}),Pe.emit(Yn.conversationAdded,{conversation:i}),r}catch(o){throw console.error("ConversationStore: Error adding conversation",o),a&&e(l=>({error:"Failed to save new conversation to state",conversations:l.conversations.filter(c=>c.id!==r),conversationSyncStatus:Object.fromEntries(Object.entries(l.conversationSyncStatus).filter(([c])=>c!==r))})),o}},updateConversation:async(n,r)=>{const s=t().getConversationById(n);if(!s){console.warn(`ConversationStore: Conversation ${n} not found for update.`);return}e(a=>{const o=a.conversations.findIndex(l=>l.id===n);if(o!==-1){const l=a.conversations[o].metadata??{},c=r.metadata??{},u={...l,...c};Object.assign(a.conversations[o],{...r,metadata:u,updatedAt:new Date});const d=["title","metadata","projectId"].some(y=>y in r),h=a.conversations[o].lastSyncedAt instanceof Date?a.conversations[o].lastSyncedAt.getTime():null,m=a.conversations[o].updatedAt.getTime();"syncRepoId"in r?a.conversationSyncStatus[n]=r.syncRepoId?"needs-sync":"idle":d&&a.conversations[o].syncRepoId&&a.conversationSyncStatus[n]==="idle"&&(!h||m>h)&&(a.conversationSyncStatus[n]="needs-sync")}});const i=t().getConversationById(n);if(i)try{const a=JSON.parse(JSON.stringify(i));await Et.saveConversation(a),Pe.emit(Yn.conversationUpdated,{conversationId:n,updates:r})}catch(a){throw console.error("ConversationStore: Error updating conversation",a),e(o=>{const l=o.conversations.findIndex(c=>c.id===n);if(l!==-1){o.conversations[l]=s;const c=s.lastSyncedAt instanceof Date?s.lastSyncedAt.getTime():null,u=s.updatedAt.getTime();o.conversationSyncStatus[n]=s.syncRepoId&&c&&u<=c?"idle":s.syncRepoId?"needs-sync":"idle"}o.error="Failed to save conversation update"}),a}else console.error("ConversationStore: Failed to retrieve updated conversation state after update."),e(a=>{const o=a.conversations.findIndex(l=>l.id===n);if(o!==-1){a.conversations[o]=s;const l=s.lastSyncedAt instanceof Date?s.lastSyncedAt.getTime():null,c=s.updatedAt.getTime();a.conversationSyncStatus[n]=s.syncRepoId&&l&&c<=l?"idle":s.syncRepoId?"needs-sync":"idle"}a.error="Failed to save conversation update (state error)"})},deleteConversation:async n=>{const r=t().selectedItemId,s=t().selectedItemType,i=t().conversations.find(a=>a.id===n);if(i){e(a=>({conversations:a.conversations.filter(o=>o.id!==n),selectedItemId:r===n&&s==="conversation"?null:r,selectedItemType:r===n&&s==="conversation"?null:s,conversationSyncStatus:Object.fromEntries(Object.entries(a.conversationSyncStatus).filter(([o])=>o!==n))}));try{await Et.deleteConversation(n),await Et.deleteInteractionsForConversation(n),Pe.emit(Yn.conversationDeleted,{conversationId:n}),r===n&&s==="conversation"&&(Pe.emit(Zn.setCurrentConversationIdRequest,{id:null}),Pe.emit(Yn.selectedItemChanged,{itemId:null,itemType:null}))}catch(a){throw console.error("ConversationStore: Error deleting conversation",a),e(o=>{if(i){o.conversations.push(i);const l=i.lastSyncedAt instanceof Date?i.lastSyncedAt.getTime():null,c=i.updatedAt.getTime();o.conversationSyncStatus[n]=i.syncRepoId&&l&&c<=l?"idle":i.syncRepoId?"needs-sync":"idle"}r===n&&s==="conversation"&&(o.selectedItemId=n,o.selectedItemType="conversation"),o.error="Failed to delete conversation"}),a}}},selectItem:async(n,r)=>{const s=t().selectedItemId,i=t().selectedItemType;if(s===n&&i===r)return;console.log(`ConversationStore: Selecting item. ID: ${n}, Type: ${r}. Previous: ${s} (${i})`);const a=r==="conversation"?n:null;a&&(Pe.emit(Zn.setCurrentConversationIdRequest,{id:a}),Pe.emit(Zn.loadInteractionsRequest,{conversationId:a})),e({selectedItemId:n,selectedItemType:r}),Pe.emit(Yn.selectedItemChanged,{itemId:n,itemType:r})},importConversation:async n=>{await v0.importConversation(n,t().addConversation,t().selectItem)},exportConversation:async(n,r)=>{await v0.exportConversation(n,r)},exportProject:async n=>{await v0.exportProject(n)},exportAllConversations:async()=>{await v0.exportAllConversations()},loadSyncRepos:async()=>{if(!t().isLoading){e({isLoading:!0,error:null});try{const n=await Et.loadSyncRepos();e({syncRepos:n,isLoading:!1}),Pe.emit(Yn.syncReposLoaded,{repos:n})}catch(n){console.error("ConversationStore: Error loading sync repos",n),e({error:"Failed load sync repositories",isLoading:!1}),Pe.emit(Yn.loadingStateChanged,{isLoading:!1,error:"Failed load sync repositories"})}}},addSyncRepo:async n=>{const r=Vi(),s=new Date,i={id:r,createdAt:s,updatedAt:s,name:n.name,remoteUrl:n.remoteUrl,branch:n.branch||"main",username:n.username??null,password:n.password??null};e(a=>{a.syncRepos.push(i)});try{const a=t().syncRepos.find(o=>o.id===r);if(a){const o=JSON.parse(JSON.stringify(a));await Et.saveSyncRepo(o),Pe.emit(us.repoChanged,{repoId:r,action:"added"})}else throw new Error("Failed to retrieve newly added sync repo state");je.success(`Sync repository "${i.name}" added.`);try{await t().initializeOrSyncRepo(r)}catch(o){console.warn(`Failed to automatically initialize repository "${i.name}":`,o),je.warning(`Repository "${i.name}" added but initialization failed. You can manually sync it later.`)}return r}catch(a){throw console.error("ConversationStore: Error adding sync repo",a),e(o=>({error:"Failed to save sync repository",syncRepos:o.syncRepos.filter(l=>l.id!==r)})),a}},updateSyncRepo:async(n,r)=>{const s=t().syncRepos.find(a=>a.id===n);if(!s){console.warn(`ConversationStore: SyncRepo ${n} not found.`);return}e(a=>{const o=a.syncRepos.findIndex(l=>l.id===n);o!==-1&&Object.assign(a.syncRepos[o],{...r,branch:r.branch||a.syncRepos[o].branch||"main",updatedAt:new Date})});const i=t().syncRepos.find(a=>a.id===n);if(i)try{const a=JSON.parse(JSON.stringify(i));await Et.saveSyncRepo(a),Pe.emit(us.repoChanged,{repoId:n,action:"updated"}),je.success(`Sync repository "${i.name}" updated.`)}catch(a){throw console.error("ConversationStore: Error updating sync repo",a),e(o=>{const l=o.syncRepos.findIndex(c=>c.id===n);l!==-1&&(o.syncRepos[l]=s),o.error="Failed to save sync repository update"}),a}else console.error("ConversationStore: Failed to retrieve updated sync repo state after update."),e(a=>{const o=a.syncRepos.findIndex(l=>l.id===n);o!==-1&&(a.syncRepos[o]=s),a.error="Failed to save sync repository update (state error)"})},deleteSyncRepo:async n=>{const r=t().syncRepos.find(s=>s.id===n);if(r)try{let s;try{s=await t()._ensureSyncVfsReady()}catch(a){throw console.error("ConversationStore: Failed to initialize sync VFS for deletion",a),je.error("Failed to initialize filesystem for deletion. Repository not deleted."),a}await Et.deleteSyncRepo(n);const i=zr(`${qqe}/${n}`);try{await fD(i,!0,{fsInstance:s}),console.log(`[ConversationStore] Successfully deleted VFS directory: ${i}`)}catch(a){console.error(`[ConversationStore] Failed to delete VFS directory ${i}:`,a),a.code!=="ENOENT"&&console.warn(`Could not remove local sync folder for "${r.name}": ${a.message}`)}e(a=>({syncRepos:a.syncRepos.filter(o=>o.id!==n),repoInitializationStatus:Object.fromEntries(Object.entries(a.repoInitializationStatus).filter(([o])=>o!==n))})),Pe.emit(us.repoChanged,{repoId:n,action:"deleted"}),je.success(`Sync repository "${r.name}" deleted.`)}catch(s){throw console.error("ConversationStore: Error deleting sync repo",s),e(i=>{i.error="Failed to delete sync repository"}),s}},linkConversationToRepo:async(n,r)=>{await t().updateConversation(n,{syncRepoId:r,lastSyncedAt:null}),t()._setConversationSyncStatus(n,r?"needs-sync":"idle"),je.info(`Conversation ${r?"linked to":"unlinked from"} sync repository.`)},_setConversationSyncStatus:(n,r,s=null)=>{e(i=>{i.conversationSyncStatus[n]=r,r==="error"&&s&&console.error(`Sync error for ${n}: ${s}`)}),Pe.emit(Yn.conversationSyncStatusChanged,{conversationId:n,status:r})},_setRepoInitializationStatus:(n,r)=>{e(s=>{s.repoInitializationStatus[n]=r}),Pe.emit(us.repoInitStatusChanged,{repoId:n,status:r})},initializeOrSyncRepo:async(n,r=!1)=>{const s=t().syncRepos.find(a=>a.id===n);if(!s){r||je.error("Sync repsitory configuration not found.");return}let i;try{i=await t()._ensureSyncVfsReady()}catch{t()._setRepoInitializationStatus(n,"error");return}await $qe(i,s,t()._setRepoInitializationStatus,r)},syncConversation:async(n,r=!1)=>{const s=t().getConversationById(n);if(!s){r||je.error("Conversation not found for syncing.");return}if(!s.syncRepoId){r||je.info("Conversation not linked to a sync repository.");return}const i=t().syncRepos.find(l=>l.id===s.syncRepoId);if(!i){r||je.error("Sync repository configuration not found."),t()._setConversationSyncStatus(n,"error","Repo not found");return}let a;try{a=await t()._ensureSyncVfsReady()}catch{t()._setConversationSyncStatus(n,"error","Filesystem not ready");return}await zqe(a,s,i,t()._setConversationSyncStatus,t().updateConversation,()=>t().selectedItemId,()=>t().selectedItemType,r);const o=t().getConversationById(n);o&&e(l=>{const c=l.conversations.findIndex(u=>u.id===n);c!==-1&&(l.conversations[c]=o)})},getConversationById:n=>{if(n)return t().conversations.find(r=>r.id===n)},syncAllConversations:async()=>{const{BulkSyncService:n}=await Zr(async()=>{const{BulkSyncService:r}=await Promise.resolve().then(()=>F0);return{BulkSyncService:r}},void 0);await n.syncAll({syncRepos:!1,syncConversations:!0,continueOnError:!0,maxConcurrent:3})},syncPendingConversations:async()=>{const{BulkSyncService:n}=await Zr(async()=>{const{BulkSyncService:r}=await Promise.resolve().then(()=>F0);return{BulkSyncService:r}},void 0);await n.syncPendingConversations()},initializeAllRepositories:async()=>{const{BulkSyncService:n}=await Zr(async()=>{const{BulkSyncService:r}=await Promise.resolve().then(()=>F0);return{BulkSyncService:r}},void 0);await n.initializeAllRepositories()},updateCurrentConversationToolSettings:async n=>{const{selectedItemId:r,selectedItemType:s,updateConversation:i}=t();if(s!=="conversation"||!r){console.warn("Cannot update tool settings: No conversation selected.");return}const a=t().getConversationById(r);if(!a){console.warn("Cannot update tool settings: Selected conversation not found.");return}const o=a.metadata??{},l={...o};n.enabledTools!==void 0&&(l.enabledTools=n.enabledTools),n.toolMaxStepsOverride!==void 0&&(l.toolMaxStepsOverride=n.toolMaxStepsOverride),(JSON.stringify(l)!==JSON.stringify(o)||!a.metadata)&&await i(r,{metadata:l})},_unlinkConversationsFromProjects:n=>{const r=new Set(n);e(s=>{s.conversations=s.conversations.map(i=>i.projectId&&r.has(i.projectId)?{...i,projectId:null}:i)})},getRegisteredActionHandlers:()=>{const n="conversationStore",r=t(),s=i=>async a=>{await i(a)};return[{eventName:Yn.loadConversationsRequest,handler:r.loadConversations,storeId:n},{eventName:Yn.addConversationRequest,handler:s(r.addConversation),storeId:n},{eventName:Yn.updateConversationRequest,handler:i=>r.updateConversation(i.id,i.updates),storeId:n},{eventName:Yn.deleteConversationRequest,handler:i=>r.deleteConversation(i.id),storeId:n},{eventName:Yn.selectItemRequest,handler:i=>r.selectItem(i.id,i.type),storeId:n},{eventName:Yn.importConversationRequest,handler:i=>r.importConversation(i.file),storeId:n},{eventName:Yn.exportConversationRequest,handler:i=>r.exportConversation(i.conversationId,i.format),storeId:n},{eventName:Yn.exportProjectRequest,handler:i=>r.exportProject(i.projectId),storeId:n},{eventName:Yn.exportAllConversationsRequest,handler:r.exportAllConversations,storeId:n},{eventName:Yn.loadSyncReposRequest,handler:r.loadSyncRepos,storeId:n},{eventName:Yn.addSyncRepoRequest,handler:s(r.addSyncRepo),storeId:n},{eventName:Yn.updateSyncRepoRequest,handler:i=>r.updateSyncRepo(i.id,i.updates),storeId:n},{eventName:Yn.deleteSyncRepoRequest,handler:i=>r.deleteSyncRepo(i.id),storeId:n},{eventName:Yn.linkConversationToRepoRequest,handler:i=>r.linkConversationToRepo(i.conversationId,i.repoId),storeId:n},{eventName:Yn.syncConversationRequest,handler:i=>r.syncConversation(i.conversationId),storeId:n},{eventName:Yn.initializeOrSyncRepoRequest,handler:i=>r.initializeOrSyncRepo(i.repoId),storeId:n},{eventName:Yn.updateCurrentConversationToolSettingsRequest,handler:i=>r.updateCurrentConversationToolSettings(i),storeId:n}]}}))),vc={copyInteractionResponseRequest:"canvas.interaction.copy.response.request",regenerateInteractionRequest:"canvas.interaction.regenerate.request",regenerateInteractionWithModelRequest:"canvas.interaction.regenerate.with.model.request",raceInteractionRequest:"canvas.interaction.race.request",editResponseRequest:"canvas.interaction.edit.response.request",copyCodeBlockRequest:"canvas.codeblock.copy.request"},Ex={async submitPrompt(e){var P,L,O,V,D,Z;console.log("[ConversationService] submitPrompt called",e);const t=$n.getState(),n=Fo.getState(),r=Po.getState(),s=qn.getState(),i=yr.getState(),a=t.currentConversationId;if(!a){je.error("Cannot submit prompt: No active conversation."),console.error("[ConversationService] submitPrompt failed: No conversationId.");return}const o=s.getConversationById(a),l=(o==null?void 0:o.projectId)??null,c=n.getEffectiveProjectSettings(l),d=t.interactions.filter(U=>U.conversationId===a).length===0&&i.autoTitleEnabled&&((P=e.metadata)==null?void 0:P.autoTitleEnabledForTurn)===!0&&i.autoTitleModelId,m=t.interactions.filter(U=>U.parentId===null&&U.status==="COMPLETED").sort((U,H)=>U.index-H.index).map(U=>{var H;if(U.type==="message.assistant_regen"&&((H=U.metadata)!=null&&H.regeneratedFromId)){const $=t.interactions.find(ne=>ne.id===U.metadata.regeneratedFromId);if($&&$.prompt&&$.type==="message.user_assistant")return{...U,prompt:$.prompt,type:"message.user_assistant"}}return U.type==="message.user_assistant"&&U.prompt?U:null}).filter(Boolean),y=uj(m);let b=e.content;const v=[],x=((L=e.metadata)==null?void 0:L.effectiveRulesContent)??[],w=x.filter(U=>U.type==="system").map(U=>U.content),S=x.filter(U=>U.type==="before").map(U=>U.content),C=x.filter(U=>U.type==="after").map(U=>U.content);S.length>0&&(b=`${S.join(`
`)}

${b}`),C.length>0&&(b=`${b}

    ${C.join(`
`)}`),b&&v.push({type:"text",text:b});const k=((O=e.metadata)==null?void 0:O.attachedFiles)??[];if(k.length>0){const U=await this._processFilesForPrompt(k,a);v.unshift(...U)}v.length>0?y.push({role:"user",content:v}):console.warn("[ConversationService] No user text or file content found in turnData. Submitting without user message.");let R=((V=e.metadata)==null?void 0:V.turnSystemPrompt)??c.systemPrompt??void 0;w.length>0&&(R=`${R?`${R}

        `:""}${w.join(`
`)}`);const N={temperature:r.temperature,max_tokens:r.maxTokens,top_p:r.topP,top_k:r.topK,presence_penalty:r.presencePenalty,frequency_penalty:r.frequencyPenalty,...e.parameters??{}};Object.keys(N).forEach(U=>{(N[U]===null||N[U]===void 0)&&delete N[U]});const I={system:R,messages:y,parameters:N,metadata:{...(({turnSystemPrompt:U,activeTagIds:H,activeRuleIds:$,effectiveRulesContent:ne,autoTitleEnabledForTurn:W,...Q})=>({...Q,effectivelyAppliedTagIds:H,effectivelyAppliedRuleIds:$}))(e.metadata??{}),modelId:r.modelId??void 0,attachedFiles:(D=e.metadata.attachedFiles)==null?void 0:D.map(({contentBase64:U,contentText:H,...$})=>$)}};try{const U=dm.startInteraction(I,a,e);if(d){console.log("[ConversationService] Triggering asynchronous title generation.");const H=(((Z=e.metadata)==null?void 0:Z.effectiveRulesContent)??[]).map($=>({id:$.sourceRuleId||Vi(),name:$.sourceRuleId?`Rule ${$.sourceRuleId.substring(0,4)}`:"Context Rule",content:$.content,type:$.type,createdAt:new Date,updatedAt:new Date}));this.generateConversationTitle(a,e,H).catch($=>{console.error("[ConversationService] Background title generation failed:",$)})}await U}catch(U){throw console.error("[ConversationService] Error starting interaction:",U),je.error(`Failed to start interaction: ${U instanceof Error?U.message:String(U)}`),U}},async generateConversationTitle(e,t,n){var o,l;const r=yr.getState();if(!r.autoTitleModelId){console.warn("[ConversationService] Auto-title generation skipped: No model selected in settings.");return}let s=t.content;if(s.length>r.autoTitlePromptMaxLength&&(s=s.substring(0,r.autoTitlePromptMaxLength)+"..."),r.autoTitleIncludeFiles&&((l=(o=t.metadata)==null?void 0:o.attachedFiles)!=null&&l.length)){const c=t.metadata.attachedFiles.map(u=>u.name).join(", ");s+=`

[Attached files: ${c}]`}if(r.autoTitleIncludeRules&&n.length>0){const c=n.map(u=>u.name).join(", ");s+=`

[Active rules: ${c}]`}const i={system:"Generate a concise, descriptive title (max 8-10 words) for the following user prompt. Output ONLY the title text, nothing else.",messages:[{role:"user",content:s}],parameters:{temperature:.5,max_tokens:20},metadata:{modelId:r.autoTitleModelId,isTitleGeneration:!0},tools:void 0,toolChoice:"none"},a={id:Vi(),content:`[Generate title based on: ${t.content.substring(0,50)}...]`,parameters:i.parameters,metadata:{...i.metadata,originalTurnId:t.id}};try{await dm.startInteraction(i,e,a,"conversation.title_generation")}catch(c){console.error("[ConversationService] Error starting title generation interaction:",c)}},async regenerateInteraction(e){var O,V,D,Z;console.log(`[ConversationService] regenerateInteraction called for ID: ${e}`);const t=$n.getState(),n=Fo.getState(),r=Po.getState(),s=qn.getState(),i=t.interactions.find(U=>U.id===e);if(console.log("[ConversationService] Target interaction for regen:",JSON.parse(JSON.stringify(i))),!i||!i.prompt){je.error("Cannot regenerate: Original interaction data missing.");return}const a=null,o=i.index,l=i.prompt,c=i.conversationId,u=s.getConversationById(c),d=(u==null?void 0:u.projectId)??null,h=n.getEffectiveProjectSettings(d),m=i.index,y=t.interactions.filter(U=>U.conversationId===c&&U.index<m&&U.status==="COMPLETED"&&U.type==="message.user_assistant"&&U.parentId===null).sort((U,H)=>U.index-H.index),b=uj(y);let v=l.content;const x=[],w=((O=l.metadata)==null?void 0:O.effectiveRulesContent)??[],S=w.filter(U=>U.type==="system").map(U=>U.content),C=w.filter(U=>U.type==="before").map(U=>U.content),k=w.filter(U=>U.type==="after").map(U=>U.content);C.length>0&&(v=`${C.join(`
`)}

${v}`),k.length>0&&(v=`${v}

    ${k.join(`
`)}`),v&&x.push({type:"text",text:v});const A=((V=l.metadata)==null?void 0:V.attachedFiles)??[];if(A.length>0){const U=await this._processFilesForPrompt(A,c);x.unshift(...U)}x.length>0?b.push({role:"user",content:x}):console.warn("[ConversationService] No user text or file content found in original turnData for regeneration.");let N=((D=l.metadata)==null?void 0:D.turnSystemPrompt)??h.systemPrompt??void 0;S.length>0&&(N=`${N?`${N}

        `:""}${S.join(`
`)}`);const I={temperature:r.temperature,max_tokens:r.maxTokens,top_p:r.topP,top_k:r.topK,presence_penalty:r.presencePenalty,frequency_penalty:r.frequencyPenalty,...l.parameters??{}};Object.keys(I).forEach(U=>{(I[U]===null||I[U]===void 0)&&delete I[U]});const P={system:N,messages:b,parameters:I,metadata:{...(({turnSystemPrompt:U,activeTagIds:H,activeRuleIds:$,effectiveRulesContent:ne,autoTitleEnabledForTurn:W,...Q})=>({...Q,effectivelyAppliedTagIds:H,effectivelyAppliedRuleIds:$}))(l.metadata??{}),modelId:r.modelId??void 0,regeneratedFromId:e,attachedFiles:A.map(({contentBase64:U,contentText:H,...$})=>$)}};let L=null;try{if(L=await dm.startInteraction(P,c,l,"message.assistant_regen"),!L)throw new Error("Failed to create new interaction for regeneration.");const U={};let H=!1;L.index!==o&&(U.index=o,H=!0),L.parentId!==a&&(U.parentId=a,H=!0);let $=L;H&&(t._updateInteractionInState(L.id,U),$={...L,...U},await Et.saveInteraction($)),console.log("[ConversationService] New active interaction state after potential updates:",JSON.parse(JSON.stringify($)));const ne=[];let W=i;for(;W;){ne.push(W);const ee=(Z=W.metadata)==null?void 0:Z.regeneratedFromId;ee?W=t.interactions.find(se=>se.id===ee):W=null}const Q=ne.sort((ee,se)=>{var Ie,De;const pe=((Ie=ee.startedAt)==null?void 0:Ie.getTime())??0,ce=((De=se.startedAt)==null?void 0:De.getTime())??0;return pe-ce});for(let ee=0;ee<Q.length;ee++){const se=Q[ee],pe={parentId:$.id,index:ee};console.log(`[ConversationService] Updating old version ${se.id} to be child of ${$.id} with childIndex ${ee}`,JSON.parse(JSON.stringify(pe))),t._updateInteractionInState(se.id,pe),await Et.saveInteraction({...se,...pe})}}catch(U){throw console.error("[ConversationService] Error during regeneration process:",U),je.error(`Failed to regenerate response: ${U instanceof Error?U.message:String(U)}`),U}},async _processFilesForPrompt(e,t){const n=[],r=e.filter(i=>i.source==="vfs");let s;if(r.length>0){const i=qn.getState().getConversationById(t),a=(i==null?void 0:i.projectId)??"orphan";try{s=await this._ensureVfsReady(a)}catch{je.error(`Filesystem unavailable for key ${a}. VFS files cannot be processed.`),r.forEach(l=>{n.push({type:"text",text:`[Skipped VFS file: ${l.name} - Filesystem unavailable]`})}),s=void 0}}for(const i of e){let a=null;try{if(i.source==="direct")a=b$(i);else if(i.source==="vfs"&&s&&i.path){console.log(`[ConversationService] Fetching VFS file: ${i.path}`);const o=await Yh(i.path,{fsInstance:s});a=b$({...i,contentBytes:o})}else if(i.source==="vfs"&&!s)continue;a&&n.push(a)}catch(o){console.error(`[ConversationService] Error processing file ${i.name}:`,o),n.push({type:"text",text:`[Error processing file: ${i.name}]`})}}return n},async _ensureVfsReady(e){return console.log(`[ConversationService] Ensuring VFS ready for key "${e}"...`),new Promise((t,n)=>{const r=o=>{Js.getState().configuredVfsKey===e&&(i(),t(o.fsInstance))},s=o=>{if(Js.getState().configuredVfsKey===e&&!o.isLoading&&!o.operationLoading)if(o.error)i(),n(new Error(o.error));else{const l=Js.getState().fs;l&&(i(),t(l))}},i=()=>{Pe.off(dn.fsInstanceChanged,r),Pe.off(dn.loadingStateChanged,s)};Pe.on(dn.fsInstanceChanged,r),Pe.on(dn.loadingStateChanged,s);const a=Js.getState();if(a.configuredVfsKey===e&&a.fs&&!a.loading&&!a.operationLoading&&!a.error){i(),t(a.fs);return}if(a.configuredVfsKey===e&&a.error&&!a.loading&&!a.operationLoading){i(),n(new Error(a.error));return}Pe.emit(dn.initializeVFSRequest,{vfsKey:e,options:{force:!0}})})}},dm={_activeControllers:new Map,_streamingToolData:new Map,_firstChunkTimestamps:new Map,_interactionStartTimes:new Map,_pendingRegenerations:new Set,initializeCanvasEventHandlers(){Pe.on(vc.copyInteractionResponseRequest,async e=>{const{interactionId:t}=e,n=$n.getState().interactions.find(s=>s.id===t);if(!n){je.error(`Copy failed: Interaction ${t} not found.`),console.warn(`[InteractionService] Copy request for unknown interaction ${t}`);return}const r=n.response??"";if(typeof r!="string"||r.trim()===""){je.info("No response content to copy.");return}try{await navigator.clipboard.writeText(r),je.success("Response copied!")}catch(s){je.error("Failed to copy response."),console.error("[InteractionService] Error copying response:",s)}}),Pe.on(vc.regenerateInteractionRequest,async e=>{const{interactionId:t}=e;if(console.log(`[InteractionService] Received regenerateInteractionRequest for ${t}`),this._pendingRegenerations.has(t)){console.warn(`[InteractionService] Regeneration already pending for ${t}. Ignoring request.`);return}const n=$n.getState().interactions.find(o=>o.id===t);if(!n){je.error(`Regeneration failed: Interaction ${t} not found.`),console.warn(`[InteractionService] Regeneration request for unknown interaction ${t}`);return}const r=$n.getState();if(r.status==="streaming"){je.info("Cannot regenerate while another response is streaming.");return}const i=r.interactions.filter(o=>o.conversationId===n.conversationId&&o.parentId===null&&(o.type==="message.user_assistant"||o.type==="message.assistant_regen")).sort((o,l)=>o.index-l.index),a=i.length>0?i[i.length-1]:null;if((a==null?void 0:a.id)!==t){je.info("Can only regenerate the last response in the conversation.");return}try{this._pendingRegenerations.add(t),await Ex.regenerateInteraction(t)}catch(o){je.error(`Failed to regenerate response: ${String(o)}`),console.error(`[InteractionService] Error regenerating interaction ${t}:`,o)}finally{this._pendingRegenerations.delete(t)}}),Pe.on(vc.regenerateInteractionWithModelRequest,async e=>{const{interactionId:t,modelId:n}=e;if(this._pendingRegenerations.has(t)){console.warn(`[InteractionService] Regeneration already pending for ${t}. Ignoring request.`);return}const r=$n.getState().interactions.find(l=>l.id===t);if(!r){je.error(`Regeneration failed: Interaction ${t} not found.`),console.warn(`[InteractionService] Regeneration request for unknown interaction ${t}`);return}const s=$n.getState();if(s.status==="streaming"){je.info("Cannot regenerate while another response is streaming.");return}const a=s.interactions.filter(l=>l.conversationId===r.conversationId&&l.parentId===null&&(l.type==="message.user_assistant"||l.type==="message.assistant_regen")).sort((l,c)=>l.index-c.index),o=a.length>0?a[a.length-1]:null;if((o==null?void 0:o.id)!==t){je.info("Can only regenerate the last response in the conversation.");return}try{this._pendingRegenerations.add(t);const l=Po.getState(),c=l.modelId;console.log(`[InteractionService] Temporarily setting model to ${n} for regeneration`),l.setModelId(n);try{await Ex.regenerateInteraction(t)}finally{console.log(`[InteractionService] Restoring original model ${c}`),l.setModelId(c)}}catch(l){je.error(`Failed to regenerate response: ${String(l)}`),console.error(`[InteractionService] Error regenerating interaction ${t}:`,l)}finally{this._pendingRegenerations.delete(t)}}),Pe.on(vc.raceInteractionRequest,async e=>{const{interactionId:t,modelIds:n,staggerMs:r}=e,s=$n.getState().interactions.find(c=>c.id===t);if(!s){je.error(`Race failed: Interaction ${t} not found.`),console.warn(`[InteractionService] Race request for unknown interaction ${t}`);return}const i=$n.getState();if(i.status==="streaming"){je.info("Cannot start race while another response is streaming.");return}const o=i.interactions.filter(c=>c.conversationId===s.conversationId&&c.parentId===null&&(c.type==="message.user_assistant"||c.type==="message.assistant_regen")).sort((c,u)=>c.index-u.index),l=o.length>0?o[o.length-1]:null;if((l==null?void 0:l.id)!==t){je.info("Can only race from the last response in the conversation.");return}if(n.length<2){je.error("Need at least 2 models to race");return}try{const c=Po.getState(),u=c.modelId;console.log(`[InteractionService] Starting race with ${n.length} models`),je.info(`Starting race with ${n.length} models...`);const d=n.map((b,v)=>new Promise(x=>{setTimeout(async()=>{try{c.setModelId(b),await Ex.regenerateInteraction(t),x({success:!0,modelId:b,index:v})}catch(w){console.error(`[InteractionService] Race participant ${v+1} failed:`,w),x({success:!1,modelId:b,index:v,error:w})}},v*r)})),h=await Promise.all(d);c.setModelId(u);const m=h.filter(b=>b.success).length,y=h.length-m;m>0?je.success(`Race completed! ${m} models responded${y>0?`, ${y} failed`:""}`):je.error(`Race failed: All ${n.length} models failed to respond`)}catch(c){je.error(`Race failed: ${String(c)}`),console.error("[InteractionService] Error during race:",c)}}),Pe.on(vc.copyCodeBlockRequest,async e=>{const{content:t,interactionId:n,codeBlockId:r,language:s}=e;if(!t||t.trim()===""){je.info("No code to copy.");return}try{await navigator.clipboard.writeText(t),je.success(`Code block ${s?`(${s}) `:""}copied!`),console.log(`[InteractionService] Code block copied. InteractionID: ${n}, CodeBlockID: ${r}, Language: ${s}`)}catch(i){je.error("Failed to copy code block."),console.error("[InteractionService] Error copying code block:",i)}})},async startInteraction(e,t,n,r="message.user_assistant"){var D,Z,U,H,$,ne,W,Q,ee,se,pe,ce,Ie,De;console.log(`[InteractionService] startInteraction called (Type: ${r})`,e,t,n);const s=await IC(Q0.INTERACTION_BEFORE_START,{prompt:e,conversationId:t});if(s===!1)return console.log("[InteractionService] Interaction start cancelled by middleware."),null;const i=s&&typeof s=="object"?s.prompt:e,a=Vi(),o=new AbortController;this._activeControllers.set(a,o),this._streamingToolData.set(a,{calls:[],results:[]}),this._firstChunkTimestamps.delete(a),this._interactionStartTimes.delete(a);const l=$n.getState(),u=l.interactions.filter(Se=>Se.conversationId===t),d=r==="conversation.title_generation"?-1:u.reduce((Se,Ce)=>Math.max(Se,Ce.index),-1)+1,h=null,m=performance.now();this._interactionStartTimes.set(a,m);const y={id:a,conversationId:t,type:r,prompt:{...n},response:null,status:"STREAMING",startedAt:new Date,endedAt:null,metadata:{...i.metadata||{},toolCalls:[],toolResults:[],reasoning:void 0,timeToFirstToken:void 0,generationTime:void 0,isTitleGeneration:r==="conversation.title_generation"},index:d,parentId:h};r!=="conversation.title_generation"?(l._addInteractionToState(y),l._addStreamingId(a)):(l._addInteractionToState(y),l._addStreamingId(a),console.log(`[InteractionService] Added title generation interaction ${a} to state.`)),Et.saveInteraction({...y}).catch(Se=>{console.error(`[InteractionService] Failed initial persistence for ${a}`,Se)}),Pe.emit(Zn.started,{interactionId:a,conversationId:t,type:y.type});const b=(D=i.metadata)==null?void 0:D.modelId;if(!b)return this._finalizeInteraction(a,"ERROR",new Error("No model ID specified in prompt metadata."),r),null;const{providerId:v,modelId:x}=Cc(b);if(!v||!x)return this._finalizeInteraction(a,"ERROR",new Error(`Invalid combined model ID format: ${b}`),r),null;const w=Nr.getState().dbProviderConfigs.find(Se=>Se.id===v);if(!w)return this._finalizeInteraction(a,"ERROR",new Error(`Provider configuration not found for ID: ${v}`),r),null;const S=Nr.getState().getApiKeyForProvider(v),C=ZP(w,x,S);if(!C)return this._finalizeInteraction(a,"ERROR",new Error(`Failed to instantiate model instance ${b} from provider ${w.name}`),r),null;console.log(`[InteractionService] Using model instance for ${b}`);const k=r!=="conversation.title_generation"?(((Z=i.metadata)==null?void 0:Z.enabledTools)??[]).reduce((Se,Ce)=>{if(Ce.startsWith("mcp_")){const qe=globalThis.mcpToolsModuleInstance;if(qe&&qe.mcpClients){const Qe=Ce.substring(4).split("_");if(Qe.length>=2){const Ve=Qe[0],Ne=Qe.slice(1).join("_");for(const[,K]of qe.mcpClients)if(K.name===Ve&&K.tools[Ne]){const ge=jo.getState().getRegisteredTools(),Ae=`mcp_${Ve}_${Ne}`,le=ge[Ae];if(le&&le.definition){const oe={description:le.definition.description,parameters:le.definition.parameters,execute:async re=>{if(le.implementation)return await le.implementation(re,y$());throw console.error(`[InteractionService] MCP tool ${Ne} has no implementation`),new Error(`MCP tool ${Ne} has no implementation`)}};Se[Ce]=oe}else console.warn(`[InteractionService] MCP tool ${Ae} not found in control registry`);break}}}}else{const Qe=jo.getState().getRegisteredTools()[Ce];if(Qe&&Qe.implementation){const Ve={description:Qe.definition.description,parameters:Qe.definition.parameters,execute:async Ne=>{const K=$n.getState().currentConversationId,ge=K?qn.getState().getConversationById(K):null;let Ae;ge&&ge.projectId?typeof ge.projectId=="string"?Ae=ge.projectId:(console.warn(`[InteractionService] conversation.projectId for conversation ${K} is not a string (type: ${typeof ge.projectId}). Defaulting VFS key to "orphan". Value:`,ge.projectId),Ae="orphan"):Ae="orphan";let le;try{if(Pe.emit(dn.initializeVFSRequest,{vfsKey:Ae,options:{force:!0}}),await new Promise(oe=>setTimeout(oe,100)),le=Js.getState().fs,Js.getState().configuredVfsKey!==Ae||!le)throw new Error(`Filesystem for key "${Ae}" not ready after request.`)}catch(oe){throw new Error(`Filesystem error: ${oe.message}`)}try{const oe=y$(),re=Qe.definition.parameters.parse(Ne),Te=Qe.implementation,Be={...oe,fsInstance:le};return await Te(re,Be)}catch(oe){throw oe instanceof Mc?new Error(`Invalid arguments: ${oe.errors.map(re=>`${re.path.join(".")} (${re.message})`).join(", ")}`):new Error(oe instanceof Error?oe.message:String(oe))}}};Se[Ce]=Ve}}return Se},{}):void 0,{getSelectedModel:A}=Nr.getState(),R=A(),N=((H=(U=R==null?void 0:R.metadata)==null?void 0:U.supported_parameters)==null?void 0:H.includes("tools"))??!1,I=((($=i.metadata)==null?void 0:$.enabledTools)??[]).filter(Se=>Se.startsWith("mcp_")).length,P=(((ne=i.metadata)==null?void 0:ne.enabledTools)??[]).filter(Se=>!Se.startsWith("mcp_")).length;!N&&(I>0||P>0)&&console.warn(`[InteractionService] Model ${(R==null?void 0:R.name)||"unknown"} does not support tools. Ignoring ${I+P} enabled tools.`);const L=((W=i.parameters)==null?void 0:W.maxSteps)??yr.getState().toolMaxSteps,O={model:C,messages:i.messages,abortSignal:o.signal,system:i.system,temperature:(Q=i.parameters)==null?void 0:Q.temperature,maxTokens:(ee=i.parameters)==null?void 0:ee.max_tokens,topP:(se=i.parameters)==null?void 0:se.top_p,topK:(pe=i.parameters)==null?void 0:pe.top_k,presencePenalty:(ce=i.parameters)==null?void 0:ce.presence_penalty,frequencyPenalty:(Ie=i.parameters)==null?void 0:Ie.frequency_penalty,maxSteps:L,...N&&k&&Object.keys(k).length>0&&{tools:k},...((De=i.parameters)==null?void 0:De.providerOptions)&&{providerOptions:i.parameters.providerOptions},...N&&i.toolChoice&&{toolChoice:i.toolChoice}},V={onChunk:Se=>this._handleChunk(a,Se),onReasoningChunk:Se=>this._handleReasoningChunk(a,Se),onToolCall:Se=>this._handleToolCall(a,Se),onToolResult:Se=>this._handleToolResult(a,Se),onFinish:Se=>this._handleFinish(a,Se,r),onError:Se=>this._handleError(a,Se,r)};return console.log(`[InteractionService] Calling AIService.executeInteraction for ${a}`),Lqe.executeInteraction(a,O,V).catch(Se=>{console.error(`[InteractionService] Error during AIService.executeInteraction for ${a}:`,Se);const Ce=$n.getState().interactions.find(qe=>qe.id===a);Ce&&Ce.status==="STREAMING"&&this._finalizeInteraction(a,"ERROR",Se instanceof Error?Se:new Error(String(Se)),r)}),y},abortInteraction(e){console.log(`[InteractionService] Aborting interaction ${e}`);const t=this._activeControllers.get(e);if(t&&!t.signal.aborted)t.abort(),je.info("Interaction cancelled.");else{console.warn(`[InteractionService] No active controller found or already aborted for ${e}.`);const n=$n.getState(),r=n.interactions.find(s=>s.id===e);n.streamingInteractionIds.includes(e)&&(console.warn(`[InteractionService] Forcing cleanup for potentially stuck interaction ${e}`),this._finalizeInteraction(e,"CANCELLED",new Error("Interaction aborted manually (controller missing)"),(r==null?void 0:r.type)??"message.user_assistant"))}},async _handleChunk(e,t){this._firstChunkTimestamps.has(e)||this._firstChunkTimestamps.set(e,performance.now());const n={interactionId:e,chunk:t},r=await IC(Q0.INTERACTION_PROCESS_CHUNK,n);if(r!==!1){const s=r&&typeof r=="object"&&"chunk"in r?r.chunk:t;$n.getState().appendInteractionResponseChunk(e,s),Pe.emit(Zn.streamChunk,{interactionId:e,chunk:s})}},_handleReasoningChunk(e,t){$n.getState().appendReasoningChunk(e,t)},_handleToolCall(e,t){try{const n=JSON.stringify(t),r=this._streamingToolData.get(e)||{calls:[],results:[]};r.calls.push(n),this._streamingToolData.set(e,r),$n.getState()._updateInteractionInState(e,{metadata:{toolCalls:[...r.calls]}})}catch(n){console.error(`[InteractionService] Failed to process tool call for ${e}:`,n)}},_handleToolResult(e,t){try{const n=JSON.stringify(t),r=this._streamingToolData.get(e)||{calls:[],results:[]};r.results.push(n),this._streamingToolData.set(e,r),$n.getState()._updateInteractionInState(e,{metadata:{toolResults:[...r.results]}})}catch(n){console.error(`[InteractionService] Failed to process tool result for ${e}:`,n)}},_handleFinish(e,t,n){console.log(`[InteractionService] Finishing interaction ${e} (Type: ${n}). Reason: ${t.finishReason}`),this._finalizeInteraction(e,"COMPLETED",void 0,n,t)},_handleError(e,t,n){console.error(`[InteractionService] Handling error for interaction ${e} (Type: ${n}):`,t);const r=t.name==="AbortError";this._finalizeInteraction(e,r?"CANCELLED":"ERROR",r?void 0:t,n)},_finalizeInteraction(e,t,n,r="message.user_assistant",s){var k;const i=$n.getState(),a=i.interactions.find(A=>A.id===e);if(!a||a.status!=="STREAMING"&&r!=="conversation.title_generation"){console.warn(`[InteractionService] Interaction ${e} already finalized or not found. Skipping finalization with status ${t}.`),this._activeControllers.delete(e),this._streamingToolData.delete(e),this._interactionStartTimes.delete(e),this._firstChunkTimestamps.delete(e);return}const o=i.activeStreamBuffers[e]??"",l=i.activeReasoningBuffers[e]??"",c=this._streamingToolData.get(e)||{calls:[],results:[]},u=(a==null?void 0:a.metadata)||{};console.log(`[InteractionService] Finalizing ${e}. Buffered Content Length: ${o.length}, Reasoning Length: ${l.length}`);const d=performance.now(),h=this._interactionStartTimes.get(e),m=this._firstChunkTimestamps.get(e),y=h?Math.round(d-h):void 0,b=h&&m?Math.round(m-h):void 0,v=(s==null?void 0:s.reasoning)??l,x={status:t,endedAt:new Date,response:o||null,metadata:{...u,...(s==null?void 0:s.usage)&&{promptTokens:s.usage.promptTokens,completionTokens:s.usage.completionTokens,totalTokens:s.usage.totalTokens},...(s==null?void 0:s.providerMetadata)&&{providerMetadata:s.providerMetadata},toolCalls:c.calls,toolResults:c.results,reasoning:v||void 0,timeToFirstToken:b,generationTime:y,...(t==="ERROR"||t==="WARNING"||t==="CANCELLED")&&{error:(n==null?void 0:n.message)??"Interaction ended unexpectedly."}}};if(r==="conversation.title_generation"&&t==="COMPLETED"&&x.response&&typeof x.response=="string"){const A=x.response.trim().replace(/^"|"$/g,"");A&&a&&(console.log(`[InteractionService] Updating conversation ${a.conversationId} title to: "${A}"`),Pe.emit(Yn.updateConversationRequest,{id:a.conversationId,updates:{title:A}}))}i._updateInteractionInState(e,x),i._removeStreamingId(e);const w=$n.getState().interactions.find(A=>A.id===e);w?(console.log(`[InteractionService] Persisting final state for ${e}. Response length: ${((k=w.response)==null?void 0:k.length)??0}`),Et.saveInteraction({...w}).catch(A=>{console.error(`[InteractionService] Failed final persistence for ${e}`,A)})):console.error(`[InteractionService] CRITICAL - Could not find final state for interaction ${e} to persist.`);let S=[],C=[];try{S=c.calls.map(A=>JSON.parse(A)),C=c.results.map(A=>JSON.parse(A))}catch(A){console.error("[InteractionService] Failed to parse tool strings for event emitter:",A)}Pe.emit(Zn.completed,{interactionId:e,status:t,error:n==null?void 0:n.message,toolCalls:S,toolResults:C}),this._activeControllers.delete(e),this._streamingToolData.delete(e),this._interactionStartTimes.delete(e),this._firstChunkTimestamps.delete(e),console.log(`[InteractionService] Finalized interaction ${e} with status ${t}.`)}},qk=We.memo(({interactionId:e,className:t,renderSlot:n,showPrompt:r=!0})=>{var D;const{interaction:s,interactionStatus:i}=$n(yn(Z=>{const U=Z.interactions.find(H=>H.id===e);return{interaction:U,interactionStatus:U==null?void 0:U.status}})),a=yr(Z=>Z.streamingRenderFPS),[o,l]=T.useState(""),[c,u]=T.useState(""),[d,h]=T.useState(!0),[m,y]=T.useState(!1),b=T.useRef(null),v=T.useRef(0),x=T.useRef(null);T.useEffect(()=>{const Z=1e3/a;let U=!0;const H=$=>{if(!U)return;if($n.getState().streamingInteractionIds.includes(e)){if($-v.current>=Z){const W=$n.getState().activeStreamBuffers[e]??"",Q=$n.getState().activeReasoningBuffers[e]??"";l(W),u(Q),v.current=$}b.current=requestAnimationFrame(H)}else{const W=$n.getState().activeStreamBuffers[e]??"",Q=$n.getState().activeReasoningBuffers[e]??"";l(W),u(Q),b.current=null}};return b.current=requestAnimationFrame(H),()=>{U=!1,b.current&&(cancelAnimationFrame(b.current),b.current=null)}},[e,a]),T.useEffect(()=>{if(i&&i!=="STREAMING"){const Z=$n.getState().activeStreamBuffers[e]??"",U=$n.getState().activeReasoningBuffers[e]??"";l(Z),u(U),b.current&&(cancelAnimationFrame(b.current),b.current=null)}},[i,e]);const{dbProviderConfigs:w,getAllAvailableModelDefsForProvider:S}=Nr(yn(Z=>({dbProviderConfigs:Z.dbProviderConfigs,getAllAvailableModelDefsForProvider:Z.getAllAvailableModelDefsForProvider}))),C=T.useMemo(()=>{var ee;const Z=(ee=s==null?void 0:s.metadata)==null?void 0:ee.modelId;if(!Z)return"Loading Model...";const{providerId:U,modelId:H}=Cc(Z);if(!U||!H)return Z;const $=w.find(se=>se.id===U),ne=($==null?void 0:$.name)??U,Q=S(U).find(se=>se.id===H);return`${(Q==null?void 0:Q.name)??H} (${ne})`},[(D=s==null?void 0:s.metadata)==null?void 0:D.modelId,w,S]),k=T.useCallback(()=>h(Z=>!Z),[]),A=T.useCallback(()=>{y(!1)},[]),R=T.useCallback(()=>{y(!0)},[]),N=T.useCallback(()=>{m?A():R()},[m,A,R]);if(!s)return r?f.jsxs("div",{className:Ze("group/card relative rounded-lg border border-primary/30 bg-card p-4 shadow-sm animate-pulse",t),children:[f.jsx("div",{className:"h-8 bg-muted rounded w-3/4 mb-4"}),f.jsxs("div",{className:"mt-3 pt-3 border-t border-border/50",children:[f.jsxs("div",{className:"flex justify-between items-center mb-2",children:[f.jsx("span",{className:"text-xs font-medium text-muted-foreground",children:"Assistant (Loading...)"}),f.jsx("span",{className:"text-xs text-muted-foreground",children:"Streaming..."})]}),f.jsxs("div",{className:"space-y-2 mt-2",children:[f.jsx("div",{className:"h-4 bg-muted rounded w-full"}),f.jsx("div",{className:"h-4 bg-muted rounded w-5/6"}),f.jsx("div",{className:"h-4 bg-muted rounded w-full"})]})]})]}):f.jsxs("div",{className:Ze("group/card relative rounded-lg border border-primary/30 bg-card p-4 shadow-sm animate-pulse",t),children:[f.jsxs("div",{className:"flex justify-between items-center mb-2",children:[f.jsx("span",{className:"text-xs font-medium text-muted-foreground",children:"Assistant (Loading...)"}),f.jsx("span",{className:"text-xs text-muted-foreground",children:"Streaming..."})]}),f.jsxs("div",{className:"space-y-2 mt-2",children:[f.jsx("div",{className:"h-4 bg-muted rounded w-full"}),f.jsx("div",{className:"h-4 bg-muted rounded w-5/6"}),f.jsx("div",{className:"h-4 bg-muted rounded w-full"})]})]});const I=()=>{dm.abortInteraction(e)},P=n==null?void 0:n("header-actions",s,{isFolded:m,toggleFold:N}),L=n==null?void 0:n("actions",s),O=n==null?void 0:n("content",s),V=n==null?void 0:n("menu",s);return f.jsxs("div",{ref:x,className:Ze("group/card relative rounded-lg border bg-card p-3 md:p-4 shadow-sm transition-colors",i==="ERROR"?"border-destructive/50 bg-destructive/5":i==="STREAMING"?"border-primary/30":"border-border",t),children:[r&&s.prompt&&f.jsx(FT,{turnData:s.prompt,timestamp:s.startedAt,isAssistantComplete:!1}),f.jsxs("div",{className:Ze("relative group/assistant",r&&s.prompt?"mt-3 pt-3 border-t border-border/50":""),children:[V,f.jsxs("div",{className:Ze("flex flex-col sm:flex-row justify-between items-start mb-2 sticky top-0 bg-card/80 backdrop-blur-sm z-20 p-1 -m-1 rounded-t"),children:[f.jsxs("div",{className:"flex items-start gap-1 min-w-0 mb-1 sm:mb-0",children:[f.jsx(eC,{className:"h-4 w-4 text-secondary flex-shrink-0 mt-0.5"}),f.jsx("div",{className:"flex flex-col min-w-0",children:f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsxs("span",{className:"text-xs font-semibold text-secondary truncate mr-1",children:["Assistant (",C,")"]}),f.jsx("div",{className:"flex items-center gap-0.5 opacity-0 group-hover/assistant:opacity-100 focus-within:opacity-100 transition-opacity",children:P})]})})]}),f.jsx("div",{className:"flex items-start flex-shrink-0 gap-1 self-end sm:self-start",children:f.jsx("span",{className:"text-xs text-muted-foreground mt-0.5",children:"Streaming..."})})]}),!m&&f.jsxs(f.Fragment,{children:[O,c&&f.jsxs("div",{className:"my-2 p-2 border border-blue-500/30 bg-blue-500/10 rounded-md text-xs",children:[f.jsxs("div",{className:"flex items-center justify-between mb-1 cursor-pointer group/reasoning",onClick:k,children:[f.jsxs("span",{className:"font-semibold text-blue-700 dark:text-blue-300 flex items-center gap-1",children:[f.jsx(Fh,{className:"h-3.5 w-3.5"})," Reasoning (Streaming)"]}),f.jsx("div",{className:"flex items-center opacity-0 group-hover/reasoning:opacity-100 focus-within:opacity-100 transition-opacity",children:f.jsx(Dn,{tooltipText:d?"Show Reasoning":"Hide Reasoning",onClick:Z=>{Z.stopPropagation(),k()},"aria-label":d?"Show reasoning":"Hide reasoning",icon:d?f.jsx(Jl,{}):f.jsx(Lh,{}),iconClassName:"h-3 w-3",className:"h-5 w-5 text-muted-foreground"})})]}),!d&&f.jsx("pre",{className:"whitespace-pre-wrap text-xs font-mono p-2 bg-background/30 rounded mt-1 overflow-wrap-anywhere",children:c})]}),f.jsx(B9e,{interactionId:e,markdownContent:o,isStreaming:!0})]}),m&&f.jsxs("div",{className:"text-xs text-muted-foreground italic cursor-pointer hover:bg-muted/20 p-1 rounded",onClick:N,children:[c?"[Reasoning] ":"",o&&typeof o=="string"?`"${o.substring(0,80)}${o.length>80?"...":""}"`:"[Streaming...]"]})]}),f.jsxs("div",{className:Ze("absolute bottom-1 right-1 md:bottom-2 md:right-2 flex items-center space-x-0.5 md:space-x-1 opacity-0 group-hover/card:opacity-100 transition-opacity duration-200","bg-card/80 backdrop-blur-sm p-0.5 md:p-1 rounded-md shadow-md z-20"),children:[L,f.jsx($9e,{onStop:I,"aria-label":"Stop Generation"})]})]})});qk.displayName="StreamingInteractionCard";const XU=e=>e===void 0?"?":e<1e3?`${e}ms`:`${(e/1e3).toFixed(2)}s`,Vqe=({displayModelName:e,timeAgo:t,promptTokens:n,completionTokens:r,timeToFirstToken:s,generationTime:i,headerActionsSlot:a})=>{const o=n!==void 0&&r!==void 0?n+r:void 0;return f.jsxs("div",{className:Ze("flex flex-col sm:flex-row justify-between items-start mb-2 sticky top-0 bg-card/80 backdrop-blur-sm z-20 p-1 -m-1 rounded-t"),children:[f.jsxs("div",{className:"flex items-start gap-1 min-w-0 mb-1 sm:mb-0",children:[f.jsx(eC,{className:"h-4 w-4 text-secondary flex-shrink-0 mt-0.5"}),f.jsxs("div",{className:"flex flex-col min-w-0",children:[f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsxs("span",{className:"text-xs font-semibold text-secondary truncate mr-1",children:["Assistant (",e,")"]}),f.jsx("div",{className:"flex items-center gap-0.5 opacity-0 group-hover/assistant:opacity-100 focus-within:opacity-100 transition-opacity",children:a})]}),f.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground mt-0.5 flex-wrap",children:[o!==void 0&&f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsxs(_r,{className:"flex items-center gap-0.5 cursor-default",children:[f.jsx(Wpe,{className:"h-3 w-3"}),f.jsx("span",{children:o.toLocaleString()})]}),f.jsxs(Sr,{side:"bottom",children:["Tokens: ",n??"?"," (Prompt) +"," ",r??"?"," (Completion) = ",o]})]})}),s!==void 0&&f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsxs(_r,{className:"flex items-center gap-0.5 cursor-default",children:[f.jsx(Hge,{className:"h-3 w-3"}),f.jsx("span",{children:XU(s)})]}),f.jsx(Sr,{side:"bottom",children:"Time to First Token"})]})}),i!==void 0&&f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsxs(_r,{className:"flex items-center gap-0.5 cursor-default",children:[f.jsx(Bpe,{className:"h-3 w-3"}),f.jsx("span",{children:XU(i)})]}),f.jsx(Sr,{side:"bottom",children:"Total Generation Time"})]})})]})]})]}),f.jsx("div",{className:"flex items-start flex-shrink-0 gap-1 self-end sm:self-start",children:f.jsx("span",{className:"text-xs text-muted-foreground mt-0.5",children:t})})]})},Wqe=({markdownContent:e})=>{const t=cT(e);return e!=null&&e.trim()?f.jsx("div",{className:"overflow-wrap-anywhere",children:t.map((n,r)=>{if(typeof n=="string")return f.jsx("div",{className:"markdown-content",dangerouslySetInnerHTML:{__html:n}},`html-${r}`);if(n.type==="code"){const s=n;return f.jsx(zy,{lang:s.lang,code:s.code,filepath:s.filepath},`code-${r}`)}else if(n.type==="mermaid"){const s=n;return f.jsx(S6,{code:s.code},`mermaid-${r}`)}return null})}):null},Hqe=({interactionId:e,response:t,toolCalls:n,toolResults:r,reasoning:s,isError:i,errorMessage:a,isFolded:o,toggleFold:l})=>{const[c,u]=T.useState(!0),[d,h]=T.useState(!1),m=jo(yn(k=>Object.values(k.canvasControls))),y=T.useCallback((k,A)=>m.filter(R=>R.type==="tool-call-step"&&R.targetSlot===k&&R.renderer).map(R=>R.renderer?f.jsx(We.Fragment,{children:R.renderer(A)},R.id):null).filter(Boolean),[m]),b=T.useMemo(()=>{if(!n)return[];const k=n.map(R=>JSON.parse(R)),A=(r==null?void 0:r.map(R=>JSON.parse(R)))??[];return k.map(R=>{const N=A.find(I=>I.toolCallId===R.toolCallId);return{call:R,result:N}})},[n,r]),v=T.useCallback(()=>u(k=>!k),[]),x=T.useCallback(async()=>{if(s)try{await navigator.clipboard.writeText(s),h(!0),je.success("Reasoning copied!"),setTimeout(()=>h(!1),1500)}catch(k){je.error("Failed to copy reasoning."),console.error("Clipboard copy failed for reasoning:",k)}},[s]),w=!!s,S=t&&(typeof t!="string"||t.trim().length>0),C=b&&b.length>0;return o?f.jsxs("div",{className:"text-xs text-muted-foreground italic cursor-pointer hover:bg-muted/20 p-1 rounded",onClick:l,children:[w?"[Reasoning] ":"",C?`[${b==null?void 0:b.length} Tool Call(s)] `:"",S&&typeof t=="string"?`"${t.substring(0,80)}${t.length>80?"...":""}"`:C||w?"":"[No text response]"]}):f.jsxs(f.Fragment,{children:[i&&a&&f.jsxs("div",{className:"mb-2 rounded border border-destructive bg-destructive/10 p-2 text-xs text-destructive-foreground",children:[f.jsx("p",{className:"font-semibold",children:"Error:"}),f.jsx("p",{children:a})]}),w&&f.jsxs("div",{className:"my-2 p-2 border border-blue-500/30 bg-blue-500/10 rounded-md text-xs",children:[f.jsxs("div",{className:"flex items-center justify-between mb-1 cursor-pointer group/reasoning",onClick:v,children:[f.jsxs("span",{className:"font-semibold text-blue-700 dark:text-blue-300 flex items-center gap-1",children:[f.jsx(Fh,{className:"h-3.5 w-3.5"})," Reasoning"]}),f.jsxs("div",{className:"flex items-center opacity-0 group-hover/reasoning:opacity-100 focus-within:opacity-100 transition-opacity",children:[f.jsx(Dn,{tooltipText:"Copy Reasoning",onClick:k=>{k.stopPropagation(),x()},"aria-label":"Copy reasoning",icon:d?f.jsx(so,{className:"text-green-500"}):f.jsx(dE,{}),className:"h-5 w-5 text-muted-foreground"}),f.jsx(Dn,{tooltipText:c?"Show Reasoning":"Hide Reasoning",onClick:k=>{k.stopPropagation(),v()},"aria-label":c?"Show reasoning":"Hide reasoning",icon:c?f.jsx(Jl,{}):f.jsx(Lh,{}),iconClassName:"h-3 w-3",className:"h-5 w-5 text-muted-foreground"})]})]}),!c&&f.jsx("pre",{className:"whitespace-pre-wrap text-xs font-mono p-2 bg-background/30 rounded mt-1 overflow-wrap-anywhere",children:s})]}),b.map(({call:k,result:A},R)=>{const N={interactionId:e,toolCall:k,toolResult:A,canvasContextType:"tool-call-step"};return f.jsx(We.Fragment,{children:y("tool-call-content",N)},`tool-step-${k.toolCallId||R}`)}),S&&typeof t=="string"&&f.jsx(Wqe,{markdownContent:t,interactionId:e}),!S&&!C&&!w&&!i&&f.jsx("div",{className:"text-xs text-muted-foreground italic p-1",children:"[No text response]"})]})},D4=We.memo(({interaction:e,className:t,renderSlot:n,showPrompt:r=!0})=>{var P,L,O,V,D,Z,U,H,$,ne,W,Q;const[s,i]=T.useState(!1),a=T.useRef(null),o=T.useCallback(()=>{i(!1)},[]),l=T.useCallback(()=>{i(!0)},[]),c=T.useCallback(()=>{s?o():l()},[s,o,l]),{dbProviderConfigs:u,getAllAvailableModelDefsForProvider:d}=Nr(yn(ee=>({dbProviderConfigs:ee.dbProviderConfigs,getAllAvailableModelDefsForProvider:ee.getAllAvailableModelDefsForProvider}))),h=e.endedAt?FZ(new Date(e.endedAt),{addSuffix:!0}):"Processing...",m=T.useMemo(()=>{var Ce;const ee=(Ce=e.metadata)==null?void 0:Ce.modelId;if(!ee)return"Unknown Model";const{providerId:se,modelId:pe}=Cc(ee);if(!se||!pe)return ee;const ce=u.find(qe=>qe.id===se),Ie=(ce==null?void 0:ce.name)??se,Se=d(se).find(qe=>qe.id===pe);return`${(Se==null?void 0:Se.name)??pe} (${Ie})`},[(P=e.metadata)==null?void 0:P.modelId,u,d]),y=e.status==="COMPLETED",b=y||e.status==="ERROR",v=e.status==="ERROR",x=e.response&&(typeof e.response!="string"||e.response.trim().length>0),w=((L=e.metadata)==null?void 0:L.toolCalls)&&e.metadata.toolCalls.length>0,S=((O=e.metadata)==null?void 0:O.toolResults)&&e.metadata.toolResults.length>0,C=!!((V=e.metadata)!=null&&V.reasoning),k=x||w||S||C,A=n==null?void 0:n("header-actions",e,{isFolded:s,toggleFold:c}),R=n==null?void 0:n("actions",e),N=n==null?void 0:n("content",e),I=n==null?void 0:n("menu",e);return f.jsxs("div",{ref:a,className:Ze("group/card relative rounded-lg border bg-card p-3 md:p-4 shadow-sm transition-colors hover:bg-muted/50","overflow-wrap-anywhere",v?"border-destructive/50 bg-destructive/5":"border-border",t),children:[r&&e.prompt&&f.jsx(FT,{turnData:e.prompt,timestamp:e.startedAt,isAssistantComplete:y}),f.jsxs("div",{className:Ze("relative group/assistant",r&&e.prompt?"mt-3 pt-3 border-t border-border/50":""),children:[I,f.jsx(Vqe,{displayModelName:m,timeAgo:h,isFolded:s,toggleFold:c,canFold:k,promptTokens:(D=e.metadata)==null?void 0:D.promptTokens,completionTokens:(Z=e.metadata)==null?void 0:Z.completionTokens,timeToFirstToken:(U=e.metadata)==null?void 0:U.timeToFirstToken,generationTime:(H=e.metadata)==null?void 0:H.generationTime,headerActionsSlot:A&&A.length>0?f.jsx(f.Fragment,{children:A}):void 0}),N,f.jsx(Hqe,{interactionId:e.id,response:e.response,toolCalls:($=e.metadata)==null?void 0:$.toolCalls,toolResults:(ne=e.metadata)==null?void 0:ne.toolResults,reasoning:(W=e.metadata)==null?void 0:W.reasoning,isError:v,errorMessage:(Q=e.metadata)==null?void 0:Q.error,isFolded:s,toggleFold:c})]}),b&&R&&R.length>0&&f.jsx("div",{className:Ze("absolute bottom-1 right-1 md:bottom-2 md:right-2 flex items-center space-x-0.5 md:space-x-1 opacity-0 group-hover/card:opacity-100 transition-opacity duration-200","bg-card/80 backdrop-blur-sm p-0.5 md:p-1 rounded-md shadow-md z-20"),children:R})]})});D4.displayName="InteractionCard";const Gqe=({interactionGroup:e,renderSlot:t,activeStreamingInteractionId:n})=>{const[r,s]=T.useState(0);if(!e||e.length===0)return null;if(e.length===1){const a=e[0];return f.jsxs("div",{className:"tab-content pt-0",children:[" ",a.id===n&&a.status==="STREAMING"?f.jsx(qk,{interactionId:a.id,renderSlot:t,showPrompt:!1},a.id):f.jsx(D4,{interaction:a,renderSlot:t,showPrompt:!1},a.id)]})}const i=e[r];return f.jsxs("div",{className:"response-tabs-container flex flex-col",children:[f.jsxs("div",{className:"tabs-header flex border-b mb-1",children:[" ",e.map((a,o)=>{const l=()=>{var c,u,d;return o===0?(c=a.metadata)!=null&&c.editedResponse?f.jsx(SB,{className:"h-3.5 w-3.5 mr-1 flex-shrink-0"}):f.jsx(SB,{className:"h-3.5 w-3.5 mr-1 flex-shrink-0"}):(u=a.metadata)!=null&&u.raceTab?f.jsx(pH,{className:"h-3.5 w-3.5 mr-1 flex-shrink-0"}):(d=a.metadata)!=null&&d.originalVersion?f.jsx(mH,{className:"h-3.5 w-3.5 mr-1 flex-shrink-0"}):f.jsx(Nme,{className:"h-3.5 w-3.5 mr-1 flex-shrink-0"})};return f.jsxs(ft,{variant:"ghost",size:"sm",onClick:()=>s(o),className:`mr-0.5 rounded-b-none flex items-center px-2 py-1 text-xs font-medium hover:bg-muted/50 focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-0 transition-colors duration-150 ease-in-out                 ${r===o?"border-b-2 border-primary text-primary":"border-b-2 border-transparent text-muted-foreground hover:text-foreground"}`,children:[l(),o+1," "]},a.id)})]}),f.jsxs("div",{className:"tab-content pt-1",children:[" ",i&&(i.id===n&&i.status==="STREAMING"?f.jsx(qk,{interactionId:i.id,renderSlot:t,showPrompt:!1},i.id):f.jsx(D4,{interaction:i,renderSlot:t,showPrompt:!1},i.id))]})]})};var Kqe=T.createContext(void 0);function cb(e){const t=T.useContext(Kqe);return e||t||"ltr"}function Uw(e,[t,n]){return Math.min(n,Math.max(t,e))}function Yqe(e,t){return T.useReducer((n,r)=>t[n][r]??n,e)}var O6="ScrollArea",[Mse,gdt]=Hi(O6),[Zqe,rc]=Mse(O6),Ise=T.forwardRef((e,t)=>{const{__scopeScrollArea:n,type:r="hover",dir:s,scrollHideDelay:i=600,...a}=e,[o,l]=T.useState(null),[c,u]=T.useState(null),[d,h]=T.useState(null),[m,y]=T.useState(null),[b,v]=T.useState(null),[x,w]=T.useState(0),[S,C]=T.useState(0),[k,A]=T.useState(!1),[R,N]=T.useState(!1),I=Rn(t,L=>l(L)),P=cb(s);return f.jsx(Zqe,{scope:n,type:r,dir:P,scrollHideDelay:i,scrollArea:o,viewport:c,onViewportChange:u,content:d,onContentChange:h,scrollbarX:m,onScrollbarXChange:y,scrollbarXEnabled:k,onScrollbarXEnabledChange:A,scrollbarY:b,onScrollbarYChange:v,scrollbarYEnabled:R,onScrollbarYEnabledChange:N,onCornerWidthChange:w,onCornerHeightChange:C,children:f.jsx(ar.div,{dir:P,...a,ref:I,style:{position:"relative","--radix-scroll-area-corner-width":x+"px","--radix-scroll-area-corner-height":S+"px",...e.style}})})});Ise.displayName=O6;var jse="ScrollAreaViewport",Pse=T.forwardRef((e,t)=>{const{__scopeScrollArea:n,children:r,nonce:s,...i}=e,a=rc(jse,n),o=T.useRef(null),l=Rn(t,o,a.onViewportChange);return f.jsxs(f.Fragment,{children:[f.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:s}),f.jsx(ar.div,{"data-radix-scroll-area-viewport":"",...i,ref:l,style:{overflowX:a.scrollbarXEnabled?"scroll":"hidden",overflowY:a.scrollbarYEnabled?"scroll":"hidden",...e.style},children:f.jsx("div",{ref:a.onContentChange,style:{minWidth:"100%",display:"table"},children:r})})]})});Pse.displayName=jse;var qu="ScrollAreaScrollbar",Ose=T.forwardRef((e,t)=>{const{forceMount:n,...r}=e,s=rc(qu,e.__scopeScrollArea),{onScrollbarXEnabledChange:i,onScrollbarYEnabledChange:a}=s,o=e.orientation==="horizontal";return T.useEffect(()=>(o?i(!0):a(!0),()=>{o?i(!1):a(!1)}),[o,i,a]),s.type==="hover"?f.jsx(Xqe,{...r,ref:t,forceMount:n}):s.type==="scroll"?f.jsx(Jqe,{...r,ref:t,forceMount:n}):s.type==="auto"?f.jsx(Dse,{...r,ref:t,forceMount:n}):s.type==="always"?f.jsx(D6,{...r,ref:t}):null});Ose.displayName=qu;var Xqe=T.forwardRef((e,t)=>{const{forceMount:n,...r}=e,s=rc(qu,e.__scopeScrollArea),[i,a]=T.useState(!1);return T.useEffect(()=>{const o=s.scrollArea;let l=0;if(o){const c=()=>{window.clearTimeout(l),a(!0)},u=()=>{l=window.setTimeout(()=>a(!1),s.scrollHideDelay)};return o.addEventListener("pointerenter",c),o.addEventListener("pointerleave",u),()=>{window.clearTimeout(l),o.removeEventListener("pointerenter",c),o.removeEventListener("pointerleave",u)}}},[s.scrollArea,s.scrollHideDelay]),f.jsx(la,{present:n||i,children:f.jsx(Dse,{"data-state":i?"visible":"hidden",...r,ref:t})})}),Jqe=T.forwardRef((e,t)=>{const{forceMount:n,...r}=e,s=rc(qu,e.__scopeScrollArea),i=e.orientation==="horizontal",a=UT(()=>l("SCROLL_END"),100),[o,l]=Yqe("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return T.useEffect(()=>{if(o==="idle"){const c=window.setTimeout(()=>l("HIDE"),s.scrollHideDelay);return()=>window.clearTimeout(c)}},[o,s.scrollHideDelay,l]),T.useEffect(()=>{const c=s.viewport,u=i?"scrollLeft":"scrollTop";if(c){let d=c[u];const h=()=>{const m=c[u];d!==m&&(l("SCROLL"),a()),d=m};return c.addEventListener("scroll",h),()=>c.removeEventListener("scroll",h)}},[s.viewport,i,l,a]),f.jsx(la,{present:n||o!=="hidden",children:f.jsx(D6,{"data-state":o==="hidden"?"hidden":"visible",...r,ref:t,onPointerEnter:Wt(e.onPointerEnter,()=>l("POINTER_ENTER")),onPointerLeave:Wt(e.onPointerLeave,()=>l("POINTER_LEAVE"))})})}),Dse=T.forwardRef((e,t)=>{const n=rc(qu,e.__scopeScrollArea),{forceMount:r,...s}=e,[i,a]=T.useState(!1),o=e.orientation==="horizontal",l=UT(()=>{if(n.viewport){const c=n.viewport.offsetWidth<n.viewport.scrollWidth,u=n.viewport.offsetHeight<n.viewport.scrollHeight;a(o?c:u)}},10);return Ay(n.viewport,l),Ay(n.content,l),f.jsx(la,{present:r||i,children:f.jsx(D6,{"data-state":i?"visible":"hidden",...s,ref:t})})}),D6=T.forwardRef((e,t)=>{const{orientation:n="vertical",...r}=e,s=rc(qu,e.__scopeScrollArea),i=T.useRef(null),a=T.useRef(0),[o,l]=T.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),c=zse(o.viewport,o.content),u={...r,sizes:o,onSizesChange:l,hasThumb:c>0&&c<1,onThumbChange:h=>i.current=h,onThumbPointerUp:()=>a.current=0,onThumbPointerDown:h=>a.current=h};function d(h,m){return sVe(h,a.current,o,m)}return n==="horizontal"?f.jsx(Qqe,{...u,ref:t,onThumbPositionChange:()=>{if(s.viewport&&i.current){const h=s.viewport.scrollLeft,m=JU(h,o,s.dir);i.current.style.transform=`translate3d(${m}px, 0, 0)`}},onWheelScroll:h=>{s.viewport&&(s.viewport.scrollLeft=h)},onDragScroll:h=>{s.viewport&&(s.viewport.scrollLeft=d(h,s.dir))}}):n==="vertical"?f.jsx(eVe,{...u,ref:t,onThumbPositionChange:()=>{if(s.viewport&&i.current){const h=s.viewport.scrollTop,m=JU(h,o);i.current.style.transform=`translate3d(0, ${m}px, 0)`}},onWheelScroll:h=>{s.viewport&&(s.viewport.scrollTop=h)},onDragScroll:h=>{s.viewport&&(s.viewport.scrollTop=d(h))}}):null}),Qqe=T.forwardRef((e,t)=>{const{sizes:n,onSizesChange:r,...s}=e,i=rc(qu,e.__scopeScrollArea),[a,o]=T.useState(),l=T.useRef(null),c=Rn(t,l,i.onScrollbarXChange);return T.useEffect(()=>{l.current&&o(getComputedStyle(l.current))},[l]),f.jsx(Lse,{"data-orientation":"horizontal",...s,ref:c,sizes:n,style:{bottom:0,left:i.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:i.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":zT(n)+"px",...e.style},onThumbPointerDown:u=>e.onThumbPointerDown(u.x),onDragScroll:u=>e.onDragScroll(u.x),onWheelScroll:(u,d)=>{if(i.viewport){const h=i.viewport.scrollLeft+u.deltaX;e.onWheelScroll(h),qse(h,d)&&u.preventDefault()}},onResize:()=>{l.current&&i.viewport&&a&&r({content:i.viewport.scrollWidth,viewport:i.viewport.offsetWidth,scrollbar:{size:l.current.clientWidth,paddingStart:Wk(a.paddingLeft),paddingEnd:Wk(a.paddingRight)}})}})}),eVe=T.forwardRef((e,t)=>{const{sizes:n,onSizesChange:r,...s}=e,i=rc(qu,e.__scopeScrollArea),[a,o]=T.useState(),l=T.useRef(null),c=Rn(t,l,i.onScrollbarYChange);return T.useEffect(()=>{l.current&&o(getComputedStyle(l.current))},[l]),f.jsx(Lse,{"data-orientation":"vertical",...s,ref:c,sizes:n,style:{top:0,right:i.dir==="ltr"?0:void 0,left:i.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":zT(n)+"px",...e.style},onThumbPointerDown:u=>e.onThumbPointerDown(u.y),onDragScroll:u=>e.onDragScroll(u.y),onWheelScroll:(u,d)=>{if(i.viewport){const h=i.viewport.scrollTop+u.deltaY;e.onWheelScroll(h),qse(h,d)&&u.preventDefault()}},onResize:()=>{l.current&&i.viewport&&a&&r({content:i.viewport.scrollHeight,viewport:i.viewport.offsetHeight,scrollbar:{size:l.current.clientHeight,paddingStart:Wk(a.paddingTop),paddingEnd:Wk(a.paddingBottom)}})}})}),[tVe,Fse]=Mse(qu),Lse=T.forwardRef((e,t)=>{const{__scopeScrollArea:n,sizes:r,hasThumb:s,onThumbChange:i,onThumbPointerUp:a,onThumbPointerDown:o,onThumbPositionChange:l,onDragScroll:c,onWheelScroll:u,onResize:d,...h}=e,m=rc(qu,n),[y,b]=T.useState(null),v=Rn(t,I=>b(I)),x=T.useRef(null),w=T.useRef(""),S=m.viewport,C=r.content-r.viewport,k=ks(u),A=ks(l),R=UT(d,10);function N(I){if(x.current){const P=I.clientX-x.current.left,L=I.clientY-x.current.top;c({x:P,y:L})}}return T.useEffect(()=>{const I=P=>{const L=P.target;(y==null?void 0:y.contains(L))&&k(P,C)};return document.addEventListener("wheel",I,{passive:!1}),()=>document.removeEventListener("wheel",I,{passive:!1})},[S,y,C,k]),T.useEffect(A,[r,A]),Ay(y,R),Ay(m.content,R),f.jsx(tVe,{scope:n,scrollbar:y,hasThumb:s,onThumbChange:ks(i),onThumbPointerUp:ks(a),onThumbPositionChange:A,onThumbPointerDown:ks(o),children:f.jsx(ar.div,{...h,ref:v,style:{position:"absolute",...h.style},onPointerDown:Wt(e.onPointerDown,I=>{I.button===0&&(I.target.setPointerCapture(I.pointerId),x.current=y.getBoundingClientRect(),w.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",m.viewport&&(m.viewport.style.scrollBehavior="auto"),N(I))}),onPointerMove:Wt(e.onPointerMove,N),onPointerUp:Wt(e.onPointerUp,I=>{const P=I.target;P.hasPointerCapture(I.pointerId)&&P.releasePointerCapture(I.pointerId),document.body.style.webkitUserSelect=w.current,m.viewport&&(m.viewport.style.scrollBehavior=""),x.current=null})})})}),Vk="ScrollAreaThumb",Bse=T.forwardRef((e,t)=>{const{forceMount:n,...r}=e,s=Fse(Vk,e.__scopeScrollArea);return f.jsx(la,{present:n||s.hasThumb,children:f.jsx(nVe,{ref:t,...r})})}),nVe=T.forwardRef((e,t)=>{const{__scopeScrollArea:n,style:r,...s}=e,i=rc(Vk,n),a=Fse(Vk,n),{onThumbPositionChange:o}=a,l=Rn(t,d=>a.onThumbChange(d)),c=T.useRef(void 0),u=UT(()=>{c.current&&(c.current(),c.current=void 0)},100);return T.useEffect(()=>{const d=i.viewport;if(d){const h=()=>{if(u(),!c.current){const m=iVe(d,o);c.current=m,o()}};return o(),d.addEventListener("scroll",h),()=>d.removeEventListener("scroll",h)}},[i.viewport,u,o]),f.jsx(ar.div,{"data-state":a.hasThumb?"visible":"hidden",...s,ref:l,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...r},onPointerDownCapture:Wt(e.onPointerDownCapture,d=>{const m=d.target.getBoundingClientRect(),y=d.clientX-m.left,b=d.clientY-m.top;a.onThumbPointerDown({x:y,y:b})}),onPointerUp:Wt(e.onPointerUp,a.onThumbPointerUp)})});Bse.displayName=Vk;var F6="ScrollAreaCorner",$se=T.forwardRef((e,t)=>{const n=rc(F6,e.__scopeScrollArea),r=!!(n.scrollbarX&&n.scrollbarY);return n.type!=="scroll"&&r?f.jsx(rVe,{...e,ref:t}):null});$se.displayName=F6;var rVe=T.forwardRef((e,t)=>{const{__scopeScrollArea:n,...r}=e,s=rc(F6,n),[i,a]=T.useState(0),[o,l]=T.useState(0),c=!!(i&&o);return Ay(s.scrollbarX,()=>{var d;const u=((d=s.scrollbarX)==null?void 0:d.offsetHeight)||0;s.onCornerHeightChange(u),l(u)}),Ay(s.scrollbarY,()=>{var d;const u=((d=s.scrollbarY)==null?void 0:d.offsetWidth)||0;s.onCornerWidthChange(u),a(u)}),c?f.jsx(ar.div,{...r,ref:t,style:{width:i,height:o,position:"absolute",right:s.dir==="ltr"?0:void 0,left:s.dir==="rtl"?0:void 0,bottom:0,...e.style}}):null});function Wk(e){return e?parseInt(e,10):0}function zse(e,t){const n=e/t;return isNaN(n)?0:n}function zT(e){const t=zse(e.viewport,e.content),n=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,r=(e.scrollbar.size-n)*t;return Math.max(r,18)}function sVe(e,t,n,r="ltr"){const s=zT(n),i=s/2,a=t||i,o=s-a,l=n.scrollbar.paddingStart+a,c=n.scrollbar.size-n.scrollbar.paddingEnd-o,u=n.content-n.viewport,d=r==="ltr"?[0,u]:[u*-1,0];return Use([l,c],d)(e)}function JU(e,t,n="ltr"){const r=zT(t),s=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,i=t.scrollbar.size-s,a=t.content-t.viewport,o=i-r,l=n==="ltr"?[0,a]:[a*-1,0],c=Uw(e,l);return Use([0,a],[0,o])(c)}function Use(e,t){return n=>{if(e[0]===e[1]||t[0]===t[1])return t[0];const r=(t[1]-t[0])/(e[1]-e[0]);return t[0]+r*(n-e[0])}}function qse(e,t){return e>0&&e<t}var iVe=(e,t=()=>{})=>{let n={left:e.scrollLeft,top:e.scrollTop},r=0;return function s(){const i={left:e.scrollLeft,top:e.scrollTop},a=n.left!==i.left,o=n.top!==i.top;(a||o)&&t(),n=i,r=window.requestAnimationFrame(s)}(),()=>window.cancelAnimationFrame(r)};function UT(e,t){const n=ks(e),r=T.useRef(0);return T.useEffect(()=>()=>window.clearTimeout(r.current),[]),T.useCallback(()=>{window.clearTimeout(r.current),r.current=window.setTimeout(n,t)},[n,t])}function Ay(e,t){const n=ks(t);ni(()=>{let r=0;if(e){const s=new ResizeObserver(()=>{cancelAnimationFrame(r),r=window.requestAnimationFrame(n)});return s.observe(e),()=>{window.cancelAnimationFrame(r),s.unobserve(e)}}},[e,n])}var aVe=Ise,oVe=Pse,lVe=$se;function Lo({className:e,children:t,...n}){return f.jsxs(aVe,{"data-slot":"scroll-area",className:Ze("relative",e),...n,children:[f.jsx(oVe,{"data-slot":"scroll-area-viewport",className:"focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1",children:t}),f.jsx(cVe,{}),f.jsx(lVe,{})]})}function cVe({className:e,orientation:t="vertical",...n}){return f.jsx(Ose,{"data-slot":"scroll-area-scrollbar",orientation:t,className:Ze("flex touch-none p-px transition-colors select-none",t==="vertical"&&"h-full w-2.5 border-l border-l-transparent",t==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent",e),...n,children:f.jsx(Bse,{"data-slot":"scroll-area-thumb",className:"bg-border relative flex-1 rounded-full"})})}function Wr({className:e,...t}){return f.jsx("div",{"data-slot":"skeleton",className:Ze("bg-accent animate-pulse rounded-md",e),...t})}const uVe=e=>{const{size:t=24,color:n="currentColor",...r}=e;return f.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:t,height:t,viewBox:"0 0 512 512",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",...r,children:[f.jsx("g",{transform:"translate(0.000000,512.000000) scale(0.100000,-0.100000)",fill:n,stroke:"none",children:f.jsx("path",{d:`M2310 5053 c-1035 -101 -1883 -794 -2159 -1764 -55 -194 -79 -338
-91 -552 -18 -323 20 -620 117 -907 92 -272 238 -543 404 -747 33 -39 59 -75
59 -78 0 -4 -49 -129 -109 -279 -252 -624 -251 -621 -196 -676 57 -56 73 -53
351 58 137 55 349 143 472 195 l223 95 77 -38 c221 -109 437 -179 680 -219
132 -23 411 -44 475 -37 23 3 85 8 137 11 404 26 806 168 1180 417 282 188
571 489 759 792 400 642 467 1498 174 2216 -179 439 -495 826 -888 1088 -361
239 -743 378 -1165 422 -88 9 -419 11 -500 3z m404 -463 c-1 -30 -17 -128 -36
-217 l-34 -163 137 0 c128 0 139 -1 149 -20 11 -21 4 -44 -22 -72 -7 -7 -68
-75 -135 -150 l-123 -136 0 -175 0 -175 238 -4 c265 -5 329 -16 469 -82 220
-105 414 -311 486 -519 l24 -68 86 -4 c129 -7 195 -43 236 -130 20 -42 21 -61
21 -300 0 -240 -1 -258 -21 -297 -46 -90 -115 -127 -235 -128 l-82 0 -11 -47
c-17 -66 -71 -179 -119 -250 -108 -159 -276 -293 -452 -361 -174 -66 -251 -72
-830 -63 l-475 8 -89 27 c-303 91 -554 328 -650 614 l-23 67 -89 5 c-98 6
-131 20 -180 72 -63 66 -64 72 -64 354 0 240 1 261 21 301 40 84 105 119 232
129 l84 7 32 80 c84 215 291 424 513 519 126 53 225 68 466 68 l212 0 0 268 0
267 -126 -3 c-108 -3 -129 -1 -145 14 -10 9 -19 25 -19 35 0 9 111 146 246
304 234 273 247 286 277 283 32 -3 32 -3 31 -58z`})}),f.jsxs("g",{transform:"translate(165, 220) scale(2.5)",children:[f.jsx("path",{d:"M4 12h16",stroke:n,strokeWidth:"4"}),f.jsx("path",{d:"M12 5v16",stroke:n,strokeWidth:"4"})]}),f.jsxs("g",{transform:"translate(290, 220) scale(2.5)",children:[f.jsx("path",{d:"M4 12h16",stroke:n,strokeWidth:"4"}),f.jsx("path",{d:"M12 5v16",stroke:n,strokeWidth:"4"})]}),f.jsx("g",{transform:"translate(0.000000,512.000000) scale(0.100000,-0.100000)",fill:n,stroke:"none",children:f.jsx("path",{d:`M2147 1999 c-26 -15 -48 -65 -41 -94 15 -61 181 -167 304 -196 30 -7
100 -12 155 -12 81 1 115 6 178 27 135 45 247 133 249 194 2 60 -48 103 -104
88 -13 -3 -50 -25 -83 -50 -85 -64 -172 -90 -280 -84 -92 6 -165 35 -259 103
-49 35 -86 43 -119 24z`})})]})};function cl({className:e,...t}){return f.jsx("div",{"data-slot":"card",className:Ze("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",e),...t})}function ul({className:e,...t}){return f.jsx("div",{"data-slot":"card-header",className:Ze("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",e),...t})}function dl({className:e,...t}){return f.jsx("div",{"data-slot":"card-title",className:Ze("leading-none font-semibold",e),...t})}function Bd({className:e,...t}){return f.jsx("div",{"data-slot":"card-description",className:Ze("text-muted-foreground text-sm",e),...t})}function fl({className:e,...t}){return f.jsx("div",{"data-slot":"card-content",className:Ze("px-6",e),...t})}function dVe({className:e,...t}){return f.jsx("div",{"data-slot":"card-footer",className:Ze("flex items-center px-6 [.border-t]:pt-6",e),...t})}const Pr={sidebarVisibilityChanged:"ui.sidebar.visibility.changed",chatControlPanelVisibilityChanged:"ui.chat.control.panel.visibility.changed",promptControlPanelVisibilityChanged:"ui.prompt.control.panel.visibility.changed",globalLoadingChanged:"ui.global.loading.changed",globalErrorChanged:"ui.global.error.changed",focusInputFlagChanged:"ui.focus.input.flag.changed",modalStateChanged:"ui.modal.state.changed",toggleSidebarRequest:"ui.toggle.sidebar.request",toggleChatControlPanelRequest:"ui.toggle.chat.control.panel.request",togglePromptControlPanelRequest:"ui.toggle.prompt.control.panel.request",setGlobalLoadingRequest:"ui.set.global.loading.request",setGlobalErrorRequest:"ui.set.global.error.request",setFocusInputFlagRequest:"ui.set.focus.input.flag.request",openModalRequest:"ui.modal.open.request",closeModalRequest:"ui.modal.close.request",contextChanged:"ui.legacy.contextChanged"},fVe=({title:e,description:t,icon:n,onClick:r})=>f.jsxs(cl,{className:"hover:border-primary/50 hover:bg-muted/30 transition-all cursor-pointer group",onClick:r,children:[f.jsxs(ul,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[f.jsxs(dl,{className:"text-sm font-medium flex items-center gap-2",children:[n," ",e]}),f.jsx(ape,{className:"h-4 w-4 text-muted-foreground group-hover:translate-x-1 transition-transform"})]}),f.jsx(fl,{children:f.jsx("p",{className:"text-xs text-muted-foreground",children:t})})]}),Vse=()=>{const e=(r,s)=>{Pe.emit(Pr.openModalRequest,{modalId:"settingsModal",initialTab:r,initialSubTab:s})},t=()=>{Pe.emit(Pr.openModalRequest,{modalId:"core-vfs-modal-panel"})},n=[{title:"Configure Theme",description:"Customize colors, fonts, and code block appearance.",icon:f.jsx(tC,{className:"h-4 w-4 text-purple-500"}),onClick:()=>e("theme")},{title:"Manage Rules & Tags",description:"Define reusable prompt snippets and organize them.",icon:f.jsx(W3,{className:"h-4 w-4 text-blue-500"}),onClick:()=>e("rules-tags")},{title:"Add Files",description:"Upload or manage files in the virtual filesystem.",icon:f.jsx(DP,{className:"h-4 w-4 text-cyan-500"}),onClick:t},{title:"Add Provider",description:"Connect to AI services like OpenAI, Ollama, etc.",icon:f.jsx(G0,{className:"h-4 w-4 text-green-500"}),onClick:()=>e("providers","providers-config")},{title:"Add API Key",description:"Store API keys securely in your browser.",icon:f.jsx(Bx,{className:"h-4 w-4 text-amber-500"}),onClick:()=>e("providers","api-keys")},{title:"Setup Git Sync",description:"Configure repositories to sync conversations with Git.",icon:f.jsx(Nc,{className:"h-4 w-4 text-orange-500"}),onClick:()=>e("git")}];return f.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 max-w-4xl w-full pt-4",children:n.map(r=>f.jsx(fVe,{title:r.title,description:r.description,icon:r.icon,onClick:r.onClick},r.title))})},QU=()=>f.jsxs("div",{className:"flex h-full flex-col items-center justify-center text-center p-4",children:[f.jsx(uVe,{className:"h-16 w-16 text-muted-foreground mb-4"}),f.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Start Chatting"}),f.jsx("p",{className:"text-muted-foreground max-w-md mb-8",children:"Select an existing conversation or project from the sidebar, or click the '+' button to start a new chat. You can also explore these setup options:"}),f.jsx(Vse,{})]}),L6=T.createContext({});function B6(e){const t=T.useRef(null);return t.current===null&&(t.current=e()),t.current}const $6=typeof window<"u",Wse=$6?T.useLayoutEffect:T.useEffect,qT=T.createContext(null),z6=T.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});class hVe extends T.Component{getSnapshotBeforeUpdate(t){const n=this.props.childRef.current;if(n&&t.isPresent&&!this.props.isPresent){const r=n.offsetParent,s=r instanceof HTMLElement&&r.offsetWidth||0,i=this.props.sizeRef.current;i.height=n.offsetHeight||0,i.width=n.offsetWidth||0,i.top=n.offsetTop,i.left=n.offsetLeft,i.right=s-i.width-i.left}return null}componentDidUpdate(){}render(){return this.props.children}}function pVe({children:e,isPresent:t,anchorX:n}){const r=T.useId(),s=T.useRef(null),i=T.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:a}=T.useContext(z6);return T.useInsertionEffect(()=>{const{width:o,height:l,top:c,left:u,right:d}=i.current;if(t||!s.current||!o||!l)return;const h=n==="left"?`left: ${u}`:`right: ${d}`;s.current.dataset.motionPopId=r;const m=document.createElement("style");return a&&(m.nonce=a),document.head.appendChild(m),m.sheet&&m.sheet.insertRule(`
          [data-motion-pop-id="${r}"] {
            position: absolute !important;
            width: ${o}px !important;
            height: ${l}px !important;
            ${h}px !important;
            top: ${c}px !important;
          }
        `),()=>{document.head.contains(m)&&document.head.removeChild(m)}},[t]),f.jsx(hVe,{isPresent:t,childRef:s,sizeRef:i,children:T.cloneElement(e,{ref:s})})}const mVe=({children:e,initial:t,isPresent:n,onExitComplete:r,custom:s,presenceAffectsLayout:i,mode:a,anchorX:o})=>{const l=B6(gVe),c=T.useId();let u=!0,d=T.useMemo(()=>(u=!1,{id:c,initial:t,isPresent:n,custom:s,onExitComplete:h=>{l.set(h,!0);for(const m of l.values())if(!m)return;r&&r()},register:h=>(l.set(h,!1),()=>l.delete(h))}),[n,l,r]);return i&&u&&(d={...d}),T.useMemo(()=>{l.forEach((h,m)=>l.set(m,!1))},[n]),T.useEffect(()=>{!n&&!l.size&&r&&r()},[n]),a==="popLayout"&&(e=f.jsx(pVe,{isPresent:n,anchorX:o,children:e})),f.jsx(qT.Provider,{value:d,children:e})};function gVe(){return new Map}function Hse(e=!0){const t=T.useContext(qT);if(t===null)return[!0,null];const{isPresent:n,onExitComplete:r,register:s}=t,i=T.useId();T.useEffect(()=>{if(e)return s(i)},[e]);const a=T.useCallback(()=>e&&r&&r(i),[i,r,e]);return!n&&r?[!1,a]:[!0]}const t2=e=>e.key||"";function eq(e){const t=[];return T.Children.forEach(e,n=>{T.isValidElement(n)&&t.push(n)}),t}const yVe=({children:e,custom:t,initial:n=!0,onExitComplete:r,presenceAffectsLayout:s=!0,mode:i="sync",propagate:a=!1,anchorX:o="left"})=>{const[l,c]=Hse(a),u=T.useMemo(()=>eq(e),[e]),d=a&&!l?[]:u.map(t2),h=T.useRef(!0),m=T.useRef(u),y=B6(()=>new Map),[b,v]=T.useState(u),[x,w]=T.useState(u);Wse(()=>{h.current=!1,m.current=u;for(let k=0;k<x.length;k++){const A=t2(x[k]);d.includes(A)?y.delete(A):y.get(A)!==!0&&y.set(A,!1)}},[x,d.length,d.join("-")]);const S=[];if(u!==b){let k=[...u];for(let A=0;A<x.length;A++){const R=x[A],N=t2(R);d.includes(N)||(k.splice(A,0,R),S.push(R))}return i==="wait"&&S.length&&(k=S),w(eq(k)),v(u),null}const{forceRender:C}=T.useContext(L6);return f.jsx(f.Fragment,{children:x.map(k=>{const A=t2(k),R=a&&!l?!1:u===x||d.includes(A),N=()=>{if(y.has(A))y.set(A,!0);else return;let I=!0;y.forEach(P=>{P||(I=!1)}),I&&(C==null||C(),w(m.current),a&&(c==null||c()),r&&r())};return f.jsx(mVe,{isPresent:R,initial:!h.current||n?void 0:!1,custom:t,presenceAffectsLayout:s,mode:i,onExitComplete:R?void 0:N,anchorX:o,children:k},A)})})},n2=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"],tq={value:null};function bVe(e,t){let n=new Set,r=new Set,s=!1,i=!1;const a=new WeakSet;let o={delta:0,timestamp:0,isProcessing:!1},l=0;function c(d){a.has(d)&&(u.schedule(d),e()),l++,d(o)}const u={schedule:(d,h=!1,m=!1)=>{const b=m&&s?n:r;return h&&a.add(d),b.has(d)||b.add(d),d},cancel:d=>{r.delete(d),a.delete(d)},process:d=>{if(o=d,s){i=!0;return}s=!0,[n,r]=[r,n],n.forEach(c),t&&tq.value&&tq.value.frameloop[t].push(l),l=0,n.clear(),s=!1,i&&(i=!1,u.process(d))}};return u}const Yd={},vVe=40;function Gse(e,t){let n=!1,r=!0;const s={delta:0,timestamp:0,isProcessing:!1},i=()=>n=!0,a=n2.reduce((S,C)=>(S[C]=bVe(i,t?C:void 0),S),{}),{setup:o,read:l,resolveKeyframes:c,preUpdate:u,update:d,preRender:h,render:m,postRender:y}=a,b=()=>{const S=Yd.useManualTiming?s.timestamp:performance.now();n=!1,Yd.useManualTiming||(s.delta=r?1e3/60:Math.max(Math.min(S-s.timestamp,vVe),1)),s.timestamp=S,s.isProcessing=!0,o.process(s),l.process(s),c.process(s),u.process(s),d.process(s),h.process(s),m.process(s),y.process(s),s.isProcessing=!1,n&&t&&(r=!1,e(b))},v=()=>{n=!0,r=!0,s.isProcessing||e(b)};return{schedule:n2.reduce((S,C)=>{const k=a[C];return S[C]=(A,R=!1,N=!1)=>(n||v(),k.schedule(A,R,N)),S},{}),cancel:S=>{for(let C=0;C<n2.length;C++)a[n2[C]].cancel(S)},state:s,steps:a}}const Gl=e=>e,{schedule:ti,cancel:jh,state:ba,steps:VI}=Gse(typeof requestAnimationFrame<"u"?requestAnimationFrame:Gl,!0),Kse=T.createContext({strict:!1}),nq={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Ry={};for(const e in nq)Ry[e]={isEnabled:t=>nq[e].some(n=>!!t[n])};function xVe(e){for(const t in e)Ry[t]={...Ry[t],...e[t]}}const wVe=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Hk(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||wVe.has(e)}let Yse=e=>!Hk(e);function _Ve(e){e&&(Yse=t=>t.startsWith("on")?!Hk(t):e(t))}try{_Ve(require("@emotion/is-prop-valid").default)}catch{}function SVe(e,t,n){const r={};for(const s in e)s==="values"&&typeof e.values=="object"||(Yse(s)||n===!0&&Hk(s)||!t&&!Hk(s)||e.draggable&&s.startsWith("onDrag"))&&(r[s]=e[s]);return r}function CVe(e){if(typeof Proxy>"u")return e;const t=new Map,n=(...r)=>e(...r);return new Proxy(n,{get:(r,s)=>s==="create"?e:(t.has(s)||t.set(s,e(s)),t.get(s))})}const VT=T.createContext({});function WT(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}function qw(e){return typeof e=="string"||Array.isArray(e)}const U6=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],q6=["initial",...U6];function HT(e){return WT(e.animate)||q6.some(t=>qw(e[t]))}function Zse(e){return!!(HT(e)||e.variants)}function kVe(e,t){if(HT(e)){const{initial:n,animate:r}=e;return{initial:n===!1||qw(n)?n:void 0,animate:qw(r)?r:void 0}}return e.inherit!==!1?t:{}}function EVe(e){const{initial:t,animate:n}=kVe(e,T.useContext(VT));return T.useMemo(()=>({initial:t,animate:n}),[rq(t),rq(n)])}function rq(e){return Array.isArray(e)?e.join(" "):e}const TVe=Symbol.for("motionComponentSymbol");function x0(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function AVe(e,t,n){return T.useCallback(r=>{r&&e.onMount&&e.onMount(r),t&&(r?t.mount(r):t.unmount()),n&&(typeof n=="function"?n(r):x0(n)&&(n.current=r))},[t])}const V6=e=>e.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),RVe="framerAppearId",Xse="data-"+V6(RVe),Jse=T.createContext({}),{schedule:W6}=Gse(queueMicrotask,!1);function NVe(e,t,n,r,s){var b,v;const{visualElement:i}=T.useContext(VT),a=T.useContext(Kse),o=T.useContext(qT),l=T.useContext(z6).reducedMotion,c=T.useRef(null);r=r||a.renderer,!c.current&&r&&(c.current=r(e,{visualState:t,parent:i,props:n,presenceContext:o,blockInitialAnimation:o?o.initial===!1:!1,reducedMotionConfig:l}));const u=c.current,d=T.useContext(Jse);u&&!u.projection&&s&&(u.type==="html"||u.type==="svg")&&MVe(c.current,n,s,d);const h=T.useRef(!1);T.useInsertionEffect(()=>{u&&h.current&&u.update(n,o)});const m=n[Xse],y=T.useRef(!!m&&!((b=window.MotionHandoffIsComplete)!=null&&b.call(window,m))&&((v=window.MotionHasOptimisedAnimation)==null?void 0:v.call(window,m)));return Wse(()=>{u&&(h.current=!0,window.MotionIsMounted=!0,u.updateFeatures(),W6.render(u.render),y.current&&u.animationState&&u.animationState.animateChanges())}),T.useEffect(()=>{u&&(!y.current&&u.animationState&&u.animationState.animateChanges(),y.current&&(queueMicrotask(()=>{var x;(x=window.MotionHandoffMarkAsComplete)==null||x.call(window,m)}),y.current=!1))}),u}function MVe(e,t,n,r){const{layoutId:s,layout:i,drag:a,dragConstraints:o,layoutScroll:l,layoutRoot:c,layoutCrossfade:u}=t;e.projection=new n(e.latestValues,t["data-framer-portal-id"]?void 0:Qse(e.parent)),e.projection.setOptions({layoutId:s,layout:i,alwaysMeasureLayout:!!a||o&&x0(o),visualElement:e,animationType:typeof i=="string"?i:"both",initialPromotionConfig:r,crossfade:u,layoutScroll:l,layoutRoot:c})}function Qse(e){if(e)return e.options.allowProjection!==!1?e.projection:Qse(e.parent)}let H6=()=>{};function IVe({preloadedFeatures:e,createVisualElement:t,useRender:n,useVisualState:r,Component:s}){e&&xVe(e);function i(o,l){let c;const u={...T.useContext(z6),...o,layoutId:jVe(o)},{isStatic:d}=u,h=EVe(o),m=r(o,d);if(!d&&$6){PVe();const y=OVe(u);c=y.MeasureLayout,h.visualElement=NVe(s,m,u,t,y.ProjectionNode)}return f.jsxs(VT.Provider,{value:h,children:[c&&h.visualElement?f.jsx(c,{visualElement:h.visualElement,...u}):null,n(s,o,AVe(m,h.visualElement,l),m,d,h.visualElement)]})}i.displayName=`motion.${typeof s=="string"?s:`create(${s.displayName??s.name??""})`}`;const a=T.forwardRef(i);return a[TVe]=s,a}function jVe({layoutId:e}){const t=T.useContext(L6).id;return t&&e!==void 0?t+"-"+e:e}function PVe(e,t){T.useContext(Kse).strict}function OVe(e){const{drag:t,layout:n}=Ry;if(!t&&!n)return{};const r={...t,...n};return{MeasureLayout:t!=null&&t.isEnabled(e)||n!=null&&n.isEnabled(e)?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}const eie=e=>t=>typeof t=="string"&&t.startsWith(e),G6=eie("--"),DVe=eie("var(--"),K6=e=>DVe(e)?FVe.test(e.split("/*")[0].trim()):!1,FVe=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,Vw={};function LVe(e){for(const t in e)Vw[t]=e[t],G6(t)&&(Vw[t].isCSSVariable=!0)}const ub=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],db=new Set(ub);function tie(e,{layout:t,layoutId:n}){return db.has(e)||e.startsWith("origin")||(t||n!==void 0)&&(!!Vw[e]||e==="opacity")}const Oa=e=>!!(e&&e.getVelocity),nie=(e,t)=>t&&typeof e=="number"?t.transform(e):e,Zd=(e,t,n)=>n>t?t:n<e?e:n,fb={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},Ww={...fb,transform:e=>Zd(0,1,e)},r2={...fb,default:1},sq={...fb,transform:Math.round},J1=e=>({test:t=>typeof t=="string"&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),Jf=J1("deg"),ku=J1("%"),ir=J1("px"),BVe=J1("vh"),$Ve=J1("vw"),iq={...ku,parse:e=>ku.parse(e)/100,transform:e=>ku.transform(e*100)},zVe={rotate:Jf,rotateX:Jf,rotateY:Jf,rotateZ:Jf,scale:r2,scaleX:r2,scaleY:r2,scaleZ:r2,skew:Jf,skewX:Jf,skewY:Jf,distance:ir,translateX:ir,translateY:ir,translateZ:ir,x:ir,y:ir,z:ir,perspective:ir,transformPerspective:ir,opacity:Ww,originX:iq,originY:iq,originZ:ir},Y6={borderWidth:ir,borderTopWidth:ir,borderRightWidth:ir,borderBottomWidth:ir,borderLeftWidth:ir,borderRadius:ir,radius:ir,borderTopLeftRadius:ir,borderTopRightRadius:ir,borderBottomRightRadius:ir,borderBottomLeftRadius:ir,width:ir,maxWidth:ir,height:ir,maxHeight:ir,top:ir,right:ir,bottom:ir,left:ir,padding:ir,paddingTop:ir,paddingRight:ir,paddingBottom:ir,paddingLeft:ir,margin:ir,marginTop:ir,marginRight:ir,marginBottom:ir,marginLeft:ir,backgroundPositionX:ir,backgroundPositionY:ir,...zVe,zIndex:sq,fillOpacity:Ww,strokeOpacity:Ww,numOctaves:sq},UVe={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},qVe=ub.length;function VVe(e,t,n){let r="",s=!0;for(let i=0;i<qVe;i++){const a=ub[i],o=e[a];if(o===void 0)continue;let l=!0;if(typeof o=="number"?l=o===(a.startsWith("scale")?1:0):l=parseFloat(o)===0,!l||n){const c=nie(o,Y6[a]);if(!l){s=!1;const u=UVe[a]||a;r+=`${u}(${c}) `}n&&(t[a]=c)}}return r=r.trim(),n?r=n(t,s?"":r):s&&(r="none"),r}function Z6(e,t,n){const{style:r,vars:s,transformOrigin:i}=e;let a=!1,o=!1;for(const l in t){const c=t[l];if(db.has(l)){a=!0;continue}else if(G6(l)){s[l]=c;continue}else{const u=nie(c,Y6[l]);l.startsWith("origin")?(o=!0,i[l]=u):r[l]=u}}if(t.transform||(a||n?r.transform=VVe(t,e.transform,n):r.transform&&(r.transform="none")),o){const{originX:l="50%",originY:c="50%",originZ:u=0}=i;r.transformOrigin=`${l} ${c} ${u}`}}const X6=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function rie(e,t,n){for(const r in t)!Oa(t[r])&&!tie(r,n)&&(e[r]=t[r])}function WVe({transformTemplate:e},t){return T.useMemo(()=>{const n=X6();return Z6(n,t,e),Object.assign({},n.vars,n.style)},[t])}function HVe(e,t){const n=e.style||{},r={};return rie(r,n,e),Object.assign(r,WVe(e,t)),r}function GVe(e,t){const n={},r=HVe(e,t);return e.drag&&e.dragListener!==!1&&(n.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(n.tabIndex=0),n.style=r,n}const KVe=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function J6(e){return typeof e!="string"||e.includes("-")?!1:!!(KVe.indexOf(e)>-1||/[A-Z]/u.test(e))}const YVe={offset:"stroke-dashoffset",array:"stroke-dasharray"},ZVe={offset:"strokeDashoffset",array:"strokeDasharray"};function XVe(e,t,n=1,r=0,s=!0){e.pathLength=1;const i=s?YVe:ZVe;e[i.offset]=ir.transform(-r);const a=ir.transform(t),o=ir.transform(n);e[i.array]=`${a} ${o}`}function sie(e,{attrX:t,attrY:n,attrScale:r,pathLength:s,pathSpacing:i=1,pathOffset:a=0,...o},l,c,u){if(Z6(e,o,c),l){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:d,style:h}=e;d.transform&&(h.transform=d.transform,delete d.transform),(h.transform||d.transformOrigin)&&(h.transformOrigin=d.transformOrigin??"50% 50%",delete d.transformOrigin),h.transform&&(h.transformBox=(u==null?void 0:u.transformBox)??"fill-box",delete d.transformBox),t!==void 0&&(d.x=t),n!==void 0&&(d.y=n),r!==void 0&&(d.scale=r),s!==void 0&&XVe(d,s,i,a,!1)}const iie=()=>({...X6(),attrs:{}}),aie=e=>typeof e=="string"&&e.toLowerCase()==="svg";function JVe(e,t,n,r){const s=T.useMemo(()=>{const i=iie();return sie(i,t,aie(r),e.transformTemplate,e.style),{...i.attrs,style:{...i.style}}},[t]);if(e.style){const i={};rie(i,e.style,e),s.style={...i,...s.style}}return s}function QVe(e=!1){return(n,r,s,{latestValues:i},a)=>{const l=(J6(n)?JVe:GVe)(r,i,a,n),c=SVe(r,typeof n=="string",e),u=n!==T.Fragment?{...c,...l,ref:s}:{},{children:d}=r,h=T.useMemo(()=>Oa(d)?d.get():d,[d]);return T.createElement(n,{...u,children:h})}}function aq(e){const t=[{},{}];return e==null||e.values.forEach((n,r)=>{t[0][r]=n.get(),t[1][r]=n.getVelocity()}),t}function Q6(e,t,n,r){if(typeof t=="function"){const[s,i]=aq(r);t=t(n!==void 0?n:e.custom,s,i)}if(typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"){const[s,i]=aq(r);t=t(n!==void 0?n:e.custom,s,i)}return t}function H2(e){return Oa(e)?e.get():e}function eWe({scrapeMotionValuesFromProps:e,createRenderState:t},n,r,s){return{latestValues:tWe(n,r,s,e),renderState:t()}}const oie=e=>(t,n)=>{const r=T.useContext(VT),s=T.useContext(qT),i=()=>eWe(e,t,r,s);return n?i():B6(i)};function tWe(e,t,n,r){const s={},i=r(e,{});for(const h in i)s[h]=H2(i[h]);let{initial:a,animate:o}=e;const l=HT(e),c=Zse(e);t&&c&&!l&&e.inherit!==!1&&(a===void 0&&(a=t.initial),o===void 0&&(o=t.animate));let u=n?n.initial===!1:!1;u=u||a===!1;const d=u?o:a;if(d&&typeof d!="boolean"&&!WT(d)){const h=Array.isArray(d)?d:[d];for(let m=0;m<h.length;m++){const y=Q6(e,h[m]);if(y){const{transitionEnd:b,transition:v,...x}=y;for(const w in x){let S=x[w];if(Array.isArray(S)){const C=u?S.length-1:0;S=S[C]}S!==null&&(s[w]=S)}for(const w in b)s[w]=b[w]}}}return s}function e5(e,t,n){var i;const{style:r}=e,s={};for(const a in r)(Oa(r[a])||t.style&&Oa(t.style[a])||tie(a,e)||((i=n==null?void 0:n.getValue(a))==null?void 0:i.liveStyle)!==void 0)&&(s[a]=r[a]);return s}const nWe={useVisualState:oie({scrapeMotionValuesFromProps:e5,createRenderState:X6})};function lie(e,t,n){const r=e5(e,t,n);for(const s in e)if(Oa(e[s])||Oa(t[s])){const i=ub.indexOf(s)!==-1?"attr"+s.charAt(0).toUpperCase()+s.substring(1):s;r[i]=e[s]}return r}const rWe={useVisualState:oie({scrapeMotionValuesFromProps:lie,createRenderState:iie})};function sWe(e,t){return function(r,{forwardMotionProps:s}={forwardMotionProps:!1}){const a={...J6(r)?rWe:nWe,preloadedFeatures:e,useRender:QVe(s),createVisualElement:t,Component:r};return IVe(a)}}function Hw(e,t,n){const r=e.getProps();return Q6(r,t,n!==void 0?n:r.custom,e)}const F4=e=>Array.isArray(e);let G2;function iWe(){G2=void 0}const Eo={now:()=>(G2===void 0&&Eo.set(ba.isProcessing||Yd.useManualTiming?ba.timestamp:performance.now()),G2),set:e=>{G2=e,queueMicrotask(iWe)}};function t5(e,t){e.indexOf(t)===-1&&e.push(t)}function n5(e,t){const n=e.indexOf(t);n>-1&&e.splice(n,1)}class r5{constructor(){this.subscriptions=[]}add(t){return t5(this.subscriptions,t),()=>n5(this.subscriptions,t)}notify(t,n,r){const s=this.subscriptions.length;if(s)if(s===1)this.subscriptions[0](t,n,r);else for(let i=0;i<s;i++){const a=this.subscriptions[i];a&&a(t,n,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function cie(e,t){return t?e*(1e3/t):0}const oq=30,aWe=e=>!isNaN(parseFloat(e));class oWe{constructor(t,n={}){this.version="__VERSION__",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(r,s=!0)=>{var a,o;const i=Eo.now();this.updatedAt!==i&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(r),this.current!==this.prev&&((a=this.events.change)==null||a.notify(this.current)),s&&((o=this.events.renderRequest)==null||o.notify(this.current))},this.hasAnimated=!1,this.setCurrent(t),this.owner=n.owner}setCurrent(t){this.current=t,this.updatedAt=Eo.now(),this.canTrackVelocity===null&&t!==void 0&&(this.canTrackVelocity=aWe(this.current))}setPrevFrameValue(t=this.current){this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,n){this.events[t]||(this.events[t]=new r5);const r=this.events[t].add(n);return t==="change"?()=>{r(),ti.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,n){this.passiveEffect=t,this.stopPassiveEffect=n}set(t,n=!0){!n||!this.passiveEffect?this.updateAndNotify(t,n):this.passiveEffect(t,this.updateAndNotify)}setWithVelocity(t,n,r){this.set(n),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-r}jump(t,n=!0){this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,n&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const t=Eo.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||t-this.updatedAt>oq)return 0;const n=Math.min(this.updatedAt-this.prevUpdatedAt,oq);return cie(parseFloat(this.current)-parseFloat(this.prevFrameValue),n)}start(t){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=t(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var t;(t=this.events.destroy)==null||t.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Gw(e,t){return new oWe(e,t)}function lWe(e,t,n){e.hasValue(t)?e.getValue(t).set(n):e.addValue(t,Gw(n))}function cWe(e){return F4(e)?e[e.length-1]||0:e}function uWe(e,t){const n=Hw(e,t);let{transitionEnd:r={},transition:s={},...i}=n||{};i={...i,...r};for(const a in i){const o=cWe(i[a]);lWe(e,a,o)}}function dWe(e){return!!(Oa(e)&&e.add)}function L4(e,t){const n=e.getValue("willChange");if(dWe(n))return n.add(t);if(!n&&Yd.WillChange){const r=new Yd.WillChange("auto");e.addValue("willChange",r),r.add(t)}}function uie(e){return e.props[Xse]}const fWe=e=>e!==null;function hWe(e,{repeat:t,repeatType:n="loop"},r){const s=e.filter(fWe),i=t&&n!=="loop"&&t%2===1?0:s.length-1;return s[i]}const pWe={type:"spring",stiffness:500,damping:25,restSpeed:10},mWe=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),gWe={type:"keyframes",duration:.8},yWe={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},bWe=(e,{keyframes:t})=>t.length>2?gWe:db.has(e)?e.startsWith("scale")?mWe(t[1]):pWe:yWe;function vWe({when:e,delay:t,delayChildren:n,staggerChildren:r,staggerDirection:s,repeat:i,repeatType:a,repeatDelay:o,from:l,elapsed:c,...u}){return!!Object.keys(u).length}function s5(e,t){return(e==null?void 0:e[t])??(e==null?void 0:e.default)??e}const Eu=e=>e*1e3,Tu=e=>e/1e3,Tx=e=>Math.round(e*1e5)/1e5,i5=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function xWe(e){return e==null}const wWe=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,a5=(e,t)=>n=>!!(typeof n=="string"&&wWe.test(n)&&n.startsWith(e)||t&&!xWe(n)&&Object.prototype.hasOwnProperty.call(n,t)),die=(e,t,n)=>r=>{if(typeof r!="string")return r;const[s,i,a,o]=r.match(i5);return{[e]:parseFloat(s),[t]:parseFloat(i),[n]:parseFloat(a),alpha:o!==void 0?parseFloat(o):1}},_We=e=>Zd(0,255,e),WI={...fb,transform:e=>Math.round(_We(e))},am={test:a5("rgb","red"),parse:die("red","green","blue"),transform:({red:e,green:t,blue:n,alpha:r=1})=>"rgba("+WI.transform(e)+", "+WI.transform(t)+", "+WI.transform(n)+", "+Tx(Ww.transform(r))+")"};function SWe(e){let t="",n="",r="",s="";return e.length>5?(t=e.substring(1,3),n=e.substring(3,5),r=e.substring(5,7),s=e.substring(7,9)):(t=e.substring(1,2),n=e.substring(2,3),r=e.substring(3,4),s=e.substring(4,5),t+=t,n+=n,r+=r,s+=s),{red:parseInt(t,16),green:parseInt(n,16),blue:parseInt(r,16),alpha:s?parseInt(s,16)/255:1}}const B4={test:a5("#"),parse:SWe,transform:am.transform},w0={test:a5("hsl","hue"),parse:die("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:n,alpha:r=1})=>"hsla("+Math.round(e)+", "+ku.transform(Tx(t))+", "+ku.transform(Tx(n))+", "+Tx(Ww.transform(r))+")"},Ma={test:e=>am.test(e)||B4.test(e)||w0.test(e),parse:e=>am.test(e)?am.parse(e):w0.test(e)?w0.parse(e):B4.parse(e),transform:e=>typeof e=="string"?e:e.hasOwnProperty("red")?am.transform(e):w0.transform(e)},CWe=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function kWe(e){var t,n;return isNaN(e)&&typeof e=="string"&&(((t=e.match(i5))==null?void 0:t.length)||0)+(((n=e.match(CWe))==null?void 0:n.length)||0)>0}const fie="number",hie="color",EWe="var",TWe="var(",lq="${}",AWe=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Kw(e){const t=e.toString(),n=[],r={color:[],number:[],var:[]},s=[];let i=0;const o=t.replace(AWe,l=>(Ma.test(l)?(r.color.push(i),s.push(hie),n.push(Ma.parse(l))):l.startsWith(TWe)?(r.var.push(i),s.push(EWe),n.push(l)):(r.number.push(i),s.push(fie),n.push(parseFloat(l))),++i,lq)).split(lq);return{values:n,split:o,indexes:r,types:s}}function pie(e){return Kw(e).values}function mie(e){const{split:t,types:n}=Kw(e),r=t.length;return s=>{let i="";for(let a=0;a<r;a++)if(i+=t[a],s[a]!==void 0){const o=n[a];o===fie?i+=Tx(s[a]):o===hie?i+=Ma.transform(s[a]):i+=s[a]}return i}}const RWe=e=>typeof e=="number"?0:e;function NWe(e){const t=pie(e);return mie(e)(t.map(RWe))}const Ph={test:kWe,parse:pie,createTransformer:mie,getAnimatableNone:NWe};function HI(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+(t-e)*6*n:n<1/2?t:n<2/3?e+(t-e)*(2/3-n)*6:e}function MWe({hue:e,saturation:t,lightness:n,alpha:r}){e/=360,t/=100,n/=100;let s=0,i=0,a=0;if(!t)s=i=a=n;else{const o=n<.5?n*(1+t):n+t-n*t,l=2*n-o;s=HI(l,o,e+1/3),i=HI(l,o,e),a=HI(l,o,e-1/3)}return{red:Math.round(s*255),green:Math.round(i*255),blue:Math.round(a*255),alpha:r}}function Gk(e,t){return n=>n>0?t:e}const Qs=(e,t,n)=>e+(t-e)*n,GI=(e,t,n)=>{const r=e*e,s=n*(t*t-r)+r;return s<0?0:Math.sqrt(s)},IWe=[B4,am,w0],jWe=e=>IWe.find(t=>t.test(e));function cq(e){const t=jWe(e);if(!t)return!1;let n=t.parse(e);return t===w0&&(n=MWe(n)),n}const uq=(e,t)=>{const n=cq(e),r=cq(t);if(!n||!r)return Gk(e,t);const s={...n};return i=>(s.red=GI(n.red,r.red,i),s.green=GI(n.green,r.green,i),s.blue=GI(n.blue,r.blue,i),s.alpha=Qs(n.alpha,r.alpha,i),am.transform(s))},$4=new Set(["none","hidden"]);function PWe(e,t){return $4.has(e)?n=>n<=0?e:t:n=>n>=1?t:e}const OWe=(e,t)=>n=>t(e(n)),Q1=(...e)=>e.reduce(OWe);function DWe(e,t){return n=>Qs(e,t,n)}function o5(e){return typeof e=="number"?DWe:typeof e=="string"?K6(e)?Gk:Ma.test(e)?uq:BWe:Array.isArray(e)?gie:typeof e=="object"?Ma.test(e)?uq:FWe:Gk}function gie(e,t){const n=[...e],r=n.length,s=e.map((i,a)=>o5(i)(i,t[a]));return i=>{for(let a=0;a<r;a++)n[a]=s[a](i);return n}}function FWe(e,t){const n={...e,...t},r={};for(const s in n)e[s]!==void 0&&t[s]!==void 0&&(r[s]=o5(e[s])(e[s],t[s]));return s=>{for(const i in r)n[i]=r[i](s);return n}}function LWe(e,t){const n=[],r={color:0,var:0,number:0};for(let s=0;s<t.values.length;s++){const i=t.types[s],a=e.indexes[i][r[i]],o=e.values[a]??0;n[s]=o,r[i]++}return n}const BWe=(e,t)=>{const n=Ph.createTransformer(t),r=Kw(e),s=Kw(t);return r.indexes.var.length===s.indexes.var.length&&r.indexes.color.length===s.indexes.color.length&&r.indexes.number.length>=s.indexes.number.length?$4.has(e)&&!s.values.length||$4.has(t)&&!r.values.length?PWe(e,t):Q1(gie(LWe(r,s),s.values),n):Gk(e,t)};function yie(e,t,n){return typeof e=="number"&&typeof t=="number"&&typeof n=="number"?Qs(e,t,n):o5(e)(e,t)}const $We=e=>{const t=({timestamp:n})=>e(n);return{start:()=>ti.update(t,!0),stop:()=>jh(t),now:()=>ba.isProcessing?ba.timestamp:Eo.now()}},bie=(e,t,n=10)=>{let r="";const s=Math.max(Math.round(t/n),2);for(let i=0;i<s;i++)r+=e(i/(s-1))+", ";return`linear(${r.substring(0,r.length-2)})`},Kk=2e4;function l5(e){let t=0;const n=50;let r=e.next(t);for(;!r.done&&t<Kk;)t+=n,r=e.next(t);return t>=Kk?1/0:t}function zWe(e,t=100,n){const r=n({...e,keyframes:[0,t]}),s=Math.min(l5(r),Kk);return{type:"keyframes",ease:i=>r.next(s*i).value/t,duration:Tu(s)}}const UWe=5;function vie(e,t,n){const r=Math.max(t-UWe,0);return cie(n-e(r),t-r)}const ai={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},dq=.001;function qWe({duration:e=ai.duration,bounce:t=ai.bounce,velocity:n=ai.velocity,mass:r=ai.mass}){let s,i,a=1-t;a=Zd(ai.minDamping,ai.maxDamping,a),e=Zd(ai.minDuration,ai.maxDuration,Tu(e)),a<1?(s=c=>{const u=c*a,d=u*e,h=u-n,m=z4(c,a),y=Math.exp(-d);return dq-h/m*y},i=c=>{const d=c*a*e,h=d*n+n,m=Math.pow(a,2)*Math.pow(c,2)*e,y=Math.exp(-d),b=z4(Math.pow(c,2),a);return(-s(c)+dq>0?-1:1)*((h-m)*y)/b}):(s=c=>{const u=Math.exp(-c*e),d=(c-n)*e+1;return-.001+u*d},i=c=>{const u=Math.exp(-c*e),d=(n-c)*(e*e);return u*d});const o=5/e,l=WWe(s,i,o);if(e=Eu(e),isNaN(l))return{stiffness:ai.stiffness,damping:ai.damping,duration:e};{const c=Math.pow(l,2)*r;return{stiffness:c,damping:a*2*Math.sqrt(r*c),duration:e}}}const VWe=12;function WWe(e,t,n){let r=n;for(let s=1;s<VWe;s++)r=r-e(r)/t(r);return r}function z4(e,t){return e*Math.sqrt(1-t*t)}const HWe=["duration","bounce"],GWe=["stiffness","damping","mass"];function fq(e,t){return t.some(n=>e[n]!==void 0)}function KWe(e){let t={velocity:ai.velocity,stiffness:ai.stiffness,damping:ai.damping,mass:ai.mass,isResolvedFromDuration:!1,...e};if(!fq(e,GWe)&&fq(e,HWe))if(e.visualDuration){const n=e.visualDuration,r=2*Math.PI/(n*1.2),s=r*r,i=2*Zd(.05,1,1-(e.bounce||0))*Math.sqrt(s);t={...t,mass:ai.mass,stiffness:s,damping:i}}else{const n=qWe(e);t={...t,...n,mass:ai.mass},t.isResolvedFromDuration=!0}return t}function Yk(e=ai.visualDuration,t=ai.bounce){const n=typeof e!="object"?{visualDuration:e,keyframes:[0,1],bounce:t}:e;let{restSpeed:r,restDelta:s}=n;const i=n.keyframes[0],a=n.keyframes[n.keyframes.length-1],o={done:!1,value:i},{stiffness:l,damping:c,mass:u,duration:d,velocity:h,isResolvedFromDuration:m}=KWe({...n,velocity:-Tu(n.velocity||0)}),y=h||0,b=c/(2*Math.sqrt(l*u)),v=a-i,x=Tu(Math.sqrt(l/u)),w=Math.abs(v)<5;r||(r=w?ai.restSpeed.granular:ai.restSpeed.default),s||(s=w?ai.restDelta.granular:ai.restDelta.default);let S;if(b<1){const k=z4(x,b);S=A=>{const R=Math.exp(-b*x*A);return a-R*((y+b*x*v)/k*Math.sin(k*A)+v*Math.cos(k*A))}}else if(b===1)S=k=>a-Math.exp(-x*k)*(v+(y+x*v)*k);else{const k=x*Math.sqrt(b*b-1);S=A=>{const R=Math.exp(-b*x*A),N=Math.min(k*A,300);return a-R*((y+b*x*v)*Math.sinh(N)+k*v*Math.cosh(N))/k}}const C={calculatedDuration:m&&d||null,next:k=>{const A=S(k);if(m)o.done=k>=d;else{let R=k===0?y:0;b<1&&(R=k===0?Eu(y):vie(S,k,A));const N=Math.abs(R)<=r,I=Math.abs(a-A)<=s;o.done=N&&I}return o.value=o.done?a:A,o},toString:()=>{const k=Math.min(l5(C),Kk),A=bie(R=>C.next(k*R).value,k,30);return k+"ms "+A},toTransition:()=>{}};return C}Yk.applyToOptions=e=>{const t=zWe(e,100,Yk);return e.ease=t.ease,e.duration=Eu(t.duration),e.type="keyframes",e};function U4({keyframes:e,velocity:t=0,power:n=.8,timeConstant:r=325,bounceDamping:s=10,bounceStiffness:i=500,modifyTarget:a,min:o,max:l,restDelta:c=.5,restSpeed:u}){const d=e[0],h={done:!1,value:d},m=N=>o!==void 0&&N<o||l!==void 0&&N>l,y=N=>o===void 0?l:l===void 0||Math.abs(o-N)<Math.abs(l-N)?o:l;let b=n*t;const v=d+b,x=a===void 0?v:a(v);x!==v&&(b=x-d);const w=N=>-b*Math.exp(-N/r),S=N=>x+w(N),C=N=>{const I=w(N),P=S(N);h.done=Math.abs(I)<=c,h.value=h.done?x:P};let k,A;const R=N=>{m(h.value)&&(k=N,A=Yk({keyframes:[h.value,y(h.value)],velocity:vie(S,N,h.value),damping:s,stiffness:i,restDelta:c,restSpeed:u}))};return R(0),{calculatedDuration:null,next:N=>{let I=!1;return!A&&k===void 0&&(I=!0,C(N),R(N)),k!==void 0&&N>=k?A.next(N-k):(!I&&C(N),h)}}}const Yw=(e,t,n)=>{const r=t-e;return r===0?1:(n-e)/r};function YWe(e,t,n){const r=[],s=n||Yd.mix||yie,i=e.length-1;for(let a=0;a<i;a++){let o=s(e[a],e[a+1]);if(t){const l=Array.isArray(t)?t[a]||Gl:t;o=Q1(l,o)}r.push(o)}return r}function ZWe(e,t,{clamp:n=!0,ease:r,mixer:s}={}){const i=e.length;if(H6(i===t.length),i===1)return()=>t[0];if(i===2&&t[0]===t[1])return()=>t[1];const a=e[0]===e[1];e[0]>e[i-1]&&(e=[...e].reverse(),t=[...t].reverse());const o=YWe(t,r,s),l=o.length,c=u=>{if(a&&u<e[0])return t[0];let d=0;if(l>1)for(;d<e.length-2&&!(u<e[d+1]);d++);const h=Yw(e[d],e[d+1],u);return o[d](h)};return n?u=>c(Zd(e[0],e[i-1],u)):c}function XWe(e,t){const n=e[e.length-1];for(let r=1;r<=t;r++){const s=Yw(0,t,r);e.push(Qs(n,1,s))}}function JWe(e){const t=[0];return XWe(t,e.length-1),t}function QWe(e,t){return e.map(n=>n*t)}const xie=(e,t,n)=>(((1-3*n+3*t)*e+(3*n-6*t))*e+3*t)*e,eHe=1e-7,tHe=12;function nHe(e,t,n,r,s){let i,a,o=0;do a=t+(n-t)/2,i=xie(a,r,s)-e,i>0?n=a:t=a;while(Math.abs(i)>eHe&&++o<tHe);return a}function e_(e,t,n,r){if(e===t&&n===r)return Gl;const s=i=>nHe(i,0,1,e,n);return i=>i===0||i===1?i:xie(s(i),t,r)}const rHe=e_(.42,0,1,1),sHe=e_(0,0,.58,1),wie=e_(.42,0,.58,1),iHe=e=>Array.isArray(e)&&typeof e[0]!="number",_ie=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,Sie=e=>t=>1-e(1-t),Cie=e_(.33,1.53,.69,.99),c5=Sie(Cie),kie=_ie(c5),Eie=e=>(e*=2)<1?.5*c5(e):.5*(2-Math.pow(2,-10*(e-1))),u5=e=>1-Math.sin(Math.acos(e)),Tie=Sie(u5),Aie=_ie(u5),Rie=e=>Array.isArray(e)&&typeof e[0]=="number",aHe={linear:Gl,easeIn:rHe,easeInOut:wie,easeOut:sHe,circIn:u5,circInOut:Aie,circOut:Tie,backIn:c5,backInOut:kie,backOut:Cie,anticipate:Eie},oHe=e=>typeof e=="string",hq=e=>{if(Rie(e)){H6(e.length===4);const[t,n,r,s]=e;return e_(t,n,r,s)}else if(oHe(e))return aHe[e];return e};function lHe(e,t){return e.map(()=>t||wie).splice(0,e.length-1)}function Ax({duration:e=300,keyframes:t,times:n,ease:r="easeInOut"}){const s=iHe(r)?r.map(hq):hq(r),i={done:!1,value:t[0]},a=QWe(n&&n.length===t.length?n:JWe(t),e),o=ZWe(a,t,{ease:Array.isArray(s)?s:lHe(t,s)});return{calculatedDuration:e,next:l=>(i.value=o(l),i.done=l>=e,i)}}const cHe=e=>e!==null;function d5(e,{repeat:t,repeatType:n="loop"},r,s=1){const i=e.filter(cHe),o=s<0||t&&n!=="loop"&&t%2===1?0:i.length-1;return!o||r===void 0?i[o]:r}const uHe={decay:U4,inertia:U4,tween:Ax,keyframes:Ax,spring:Yk};function Nie(e){typeof e.type=="string"&&(e.type=uHe[e.type])}class f5{constructor(){this.count=0,this.updateFinished()}get finished(){return this._finished}updateFinished(){this.count++,this._finished=new Promise(t=>{this.resolve=t})}notifyFinished(){this.resolve()}then(t,n){return this.finished.then(t,n)}}const dHe=e=>e/100;class Mie extends f5{constructor(t){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{const{motionValue:n}=this.options;if(n&&n.updatedAt!==Eo.now()&&this.tick(Eo.now()),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:r}=this.options;r&&r()},this.options=t,this.initAnimation(),this.play(),t.autoplay===!1&&this.pause()}initAnimation(){const{options:t}=this;Nie(t);const{type:n=Ax,repeat:r=0,repeatDelay:s=0,repeatType:i,velocity:a=0}=t;let{keyframes:o}=t;const l=n||Ax;l!==Ax&&typeof o[0]!="number"&&(this.mixKeyframes=Q1(dHe,yie(o[0],o[1])),o=[0,100]);const c=l({...t,keyframes:o});i==="mirror"&&(this.mirroredGenerator=l({...t,keyframes:[...o].reverse(),velocity:-a})),c.calculatedDuration===null&&(c.calculatedDuration=l5(c));const{calculatedDuration:u}=c;this.calculatedDuration=u,this.resolvedDuration=u+s,this.totalDuration=this.resolvedDuration*(r+1)-s,this.generator=c}updateTime(t){const n=Math.round(t-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=n}tick(t,n=!1){const{generator:r,totalDuration:s,mixKeyframes:i,mirroredGenerator:a,resolvedDuration:o,calculatedDuration:l}=this;if(this.startTime===null)return r.next(0);const{delay:c=0,keyframes:u,repeat:d,repeatType:h,repeatDelay:m,type:y,onUpdate:b,finalKeyframe:v}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-s/this.speed,this.startTime)),n?this.currentTime=t:this.updateTime(t);const x=this.currentTime-c*(this.playbackSpeed>=0?1:-1),w=this.playbackSpeed>=0?x<0:x>s;this.currentTime=Math.max(x,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=s);let S=this.currentTime,C=r;if(d){const N=Math.min(this.currentTime,s)/o;let I=Math.floor(N),P=N%1;!P&&N>=1&&(P=1),P===1&&I--,I=Math.min(I,d+1),!!(I%2)&&(h==="reverse"?(P=1-P,m&&(P-=m/o)):h==="mirror"&&(C=a)),S=Zd(0,1,P)*o}const k=w?{done:!1,value:u[0]}:C.next(S);i&&(k.value=i(k.value));let{done:A}=k;!w&&l!==null&&(A=this.playbackSpeed>=0?this.currentTime>=s:this.currentTime<=0);const R=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&A);return R&&y!==U4&&(k.value=d5(u,this.options,v,this.speed)),b&&b(k.value),R&&this.finish(),k}then(t,n){return this.finished.then(t,n)}get duration(){return Tu(this.calculatedDuration)}get time(){return Tu(this.currentTime)}set time(t){t=Eu(t),this.currentTime=t,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.playbackSpeed)}get speed(){return this.playbackSpeed}set speed(t){this.updateTime(Eo.now());const n=this.playbackSpeed!==t;this.playbackSpeed=t,n&&(this.time=Tu(this.currentTime))}play(){if(this.isStopped)return;const{driver:t=$We,onPlay:n,startTime:r}=this.options;this.driver||(this.driver=t(i=>this.tick(i))),n&&n();const s=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=s):this.holdTime!==null?this.startTime=s-this.holdTime:this.startTime||(this.startTime=r??s),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(Eo.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:t}=this.options;t&&t()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown()}teardown(){this.notifyFinished(),this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}attachTimeline(t){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),t.observe(this)}}function fHe(e){for(let t=1;t<e.length;t++)e[t]??(e[t]=e[t-1])}const om=e=>e*180/Math.PI,q4=e=>{const t=om(Math.atan2(e[1],e[0]));return V4(t)},hHe={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:e=>(Math.abs(e[0])+Math.abs(e[3]))/2,rotate:q4,rotateZ:q4,skewX:e=>om(Math.atan(e[1])),skewY:e=>om(Math.atan(e[2])),skew:e=>(Math.abs(e[1])+Math.abs(e[2]))/2},V4=e=>(e=e%360,e<0&&(e+=360),e),pq=q4,mq=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),gq=e=>Math.sqrt(e[4]*e[4]+e[5]*e[5]),pHe={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:mq,scaleY:gq,scale:e=>(mq(e)+gq(e))/2,rotateX:e=>V4(om(Math.atan2(e[6],e[5]))),rotateY:e=>V4(om(Math.atan2(-e[2],e[0]))),rotateZ:pq,rotate:pq,skewX:e=>om(Math.atan(e[4])),skewY:e=>om(Math.atan(e[1])),skew:e=>(Math.abs(e[1])+Math.abs(e[4]))/2};function yq(e){return e.includes("scale")?1:0}function W4(e,t){if(!e||e==="none")return yq(t);const n=e.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let r,s;if(n)r=pHe,s=n;else{const o=e.match(/^matrix\(([-\d.e\s,]+)\)$/u);r=hHe,s=o}if(!s)return yq(t);const i=r[t],a=s[1].split(",").map(gHe);return typeof i=="function"?i(a):a[i]}const mHe=(e,t)=>{const{transform:n="none"}=getComputedStyle(e);return W4(n,t)};function gHe(e){return parseFloat(e.trim())}const bq=e=>e===fb||e===ir,yHe=new Set(["x","y","z"]),bHe=ub.filter(e=>!yHe.has(e));function vHe(e){const t=[];return bHe.forEach(n=>{const r=e.getValue(n);r!==void 0&&(t.push([n,r.get()]),r.set(n.startsWith("scale")?1:0))}),t}const fm={width:({x:e},{paddingLeft:t="0",paddingRight:n="0"})=>e.max-e.min-parseFloat(t)-parseFloat(n),height:({y:e},{paddingTop:t="0",paddingBottom:n="0"})=>e.max-e.min-parseFloat(t)-parseFloat(n),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:(e,{transform:t})=>W4(t,"x"),y:(e,{transform:t})=>W4(t,"y")};fm.translateX=fm.x;fm.translateY=fm.y;const hm=new Set;let H4=!1,G4=!1,K4=!1;function Iie(){if(G4){const e=Array.from(hm).filter(r=>r.needsMeasurement),t=new Set(e.map(r=>r.element)),n=new Map;t.forEach(r=>{const s=vHe(r);s.length&&(n.set(r,s),r.render())}),e.forEach(r=>r.measureInitialState()),t.forEach(r=>{r.render();const s=n.get(r);s&&s.forEach(([i,a])=>{var o;(o=r.getValue(i))==null||o.set(a)})}),e.forEach(r=>r.measureEndState()),e.forEach(r=>{r.suspendedScrollY!==void 0&&window.scrollTo(0,r.suspendedScrollY)})}G4=!1,H4=!1,hm.forEach(e=>e.complete(K4)),hm.clear()}function jie(){hm.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(G4=!0)})}function xHe(){K4=!0,jie(),Iie(),K4=!1}class h5{constructor(t,n,r,s,i,a=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...t],this.onComplete=n,this.name=r,this.motionValue=s,this.element=i,this.isAsync=a}scheduleResolve(){this.isScheduled=!0,this.isAsync?(hm.add(this),H4||(H4=!0,ti.read(jie),ti.resolveKeyframes(Iie))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:t,name:n,element:r,motionValue:s}=this;if(t[0]===null){const i=s==null?void 0:s.get(),a=t[t.length-1];if(i!==void 0)t[0]=i;else if(r&&n){const o=r.readValue(n,a);o!=null&&(t[0]=o)}t[0]===void 0&&(t[0]=a),s&&i===void 0&&s.set(t[0])}fHe(t)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(t=!1){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,t),hm.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,hm.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const wHe=e=>e.startsWith("--");function _He(e,t,n){wHe(t)?e.style.setProperty(t,n):e.style[t]=n}function p5(e){let t;return()=>(t===void 0&&(t=e()),t)}const SHe=p5(()=>window.ScrollTimeline!==void 0),CHe={};function kHe(e,t){const n=p5(e);return()=>CHe[t]??n()}const Pie=kHe(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),sx=([e,t,n,r])=>`cubic-bezier(${e}, ${t}, ${n}, ${r})`,vq={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:sx([0,.65,.55,1]),circOut:sx([.55,0,1,.45]),backIn:sx([.31,.01,.66,-.59]),backOut:sx([.33,1.53,.69,.99])};function Oie(e,t){if(e)return typeof e=="function"?Pie()?bie(e,t):"ease-out":Rie(e)?sx(e):Array.isArray(e)?e.map(n=>Oie(n,t)||vq.easeOut):vq[e]}function EHe(e,t,n,{delay:r=0,duration:s=300,repeat:i=0,repeatType:a="loop",ease:o="easeOut",times:l}={},c=void 0){const u={[t]:n};l&&(u.offset=l);const d=Oie(o,s);Array.isArray(d)&&(u.easing=d);const h={delay:r,duration:s,easing:Array.isArray(d)?"linear":d,fill:"both",iterations:i+1,direction:a==="reverse"?"alternate":"normal"};return c&&(h.pseudoElement=c),e.animate(u,h)}function Die(e){return typeof e=="function"&&"applyToOptions"in e}function THe({type:e,...t}){return Die(e)&&Pie()?e.applyToOptions(t):(t.duration??(t.duration=300),t.ease??(t.ease="easeOut"),t)}class AHe extends f5{constructor(t){if(super(),this.finishedTime=null,this.isStopped=!1,!t)return;const{element:n,name:r,keyframes:s,pseudoElement:i,allowFlatten:a=!1,finalKeyframe:o,onComplete:l}=t;this.isPseudoElement=!!i,this.allowFlatten=a,this.options=t,H6(typeof t.type!="string");const c=THe(t);this.animation=EHe(n,r,s,c,i),c.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!i){const u=d5(s,this.options,o,this.speed);this.updateMotionValue?this.updateMotionValue(u):_He(n,r,u),this.animation.cancel()}l==null||l(),this.notifyFinished()},this.animation.oncancel=()=>this.notifyFinished()}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){var t,n;(n=(t=this.animation).finish)==null||n.call(t)}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:t}=this;t==="idle"||t==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var t,n;this.isPseudoElement||(n=(t=this.animation).commitStyles)==null||n.call(t)}get duration(){var n,r;const t=((r=(n=this.animation.effect)==null?void 0:n.getComputedTiming)==null?void 0:r.call(n).duration)||0;return Tu(Number(t))}get time(){return Tu(Number(this.animation.currentTime)||0)}set time(t){this.finishedTime=null,this.animation.currentTime=Eu(t)}get speed(){return this.animation.playbackRate}set speed(t){t<0&&(this.finishedTime=null),this.animation.playbackRate=t}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(t){this.animation.startTime=t}attachTimeline({timeline:t,observe:n}){var r;return this.allowFlatten&&((r=this.animation.effect)==null||r.updateTiming({easing:"linear"})),this.animation.onfinish=null,t&&SHe()?(this.animation.timeline=t,Gl):n(this)}}const Fie={anticipate:Eie,backInOut:kie,circInOut:Aie};function RHe(e){return e in Fie}function NHe(e){typeof e.ease=="string"&&RHe(e.ease)&&(e.ease=Fie[e.ease])}const xq=10;class MHe extends AHe{constructor(t){NHe(t),Nie(t),super(t),t.startTime&&(this.startTime=t.startTime),this.options=t}updateMotionValue(t){const{motionValue:n,onUpdate:r,onComplete:s,element:i,...a}=this.options;if(!n)return;if(t!==void 0){n.set(t);return}const o=new Mie({...a,autoplay:!1}),l=Eu(this.finishedTime??this.time);n.setWithVelocity(o.sample(l-xq).value,o.sample(l).value,xq),o.stop()}}const wq=(e,t)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(Ph.test(e)||e==="0")&&!e.startsWith("url("));function IHe(e){const t=e[0];if(e.length===1)return!0;for(let n=0;n<e.length;n++)if(e[n]!==t)return!0}function jHe(e,t,n,r){const s=e[0];if(s===null)return!1;if(t==="display"||t==="visibility")return!0;const i=e[e.length-1],a=wq(s,t),o=wq(i,t);return!a||!o?!1:IHe(e)||(n==="spring"||Die(n))&&r}const PHe=new Set(["opacity","clipPath","filter","transform"]),OHe=p5(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function DHe(e){const{motionValue:t,name:n,repeatDelay:r,repeatType:s,damping:i,type:a}=e;if(!t||!t.owner||!(t.owner.current instanceof HTMLElement))return!1;const{onUpdate:o,transformTemplate:l}=t.owner.getProps();return OHe()&&n&&PHe.has(n)&&(n!=="transform"||!l)&&!o&&!r&&s!=="mirror"&&i!==0&&a!=="inertia"}const FHe=40;class LHe extends f5{constructor({autoplay:t=!0,delay:n=0,type:r="keyframes",repeat:s=0,repeatDelay:i=0,repeatType:a="loop",keyframes:o,name:l,motionValue:c,element:u,...d}){var y;super(),this.stop=()=>{var b,v;this._animation?(this._animation.stop(),(b=this.stopTimeline)==null||b.call(this)):(v=this.keyframeResolver)==null||v.cancel()},this.createdAt=Eo.now();const h={autoplay:t,delay:n,type:r,repeat:s,repeatDelay:i,repeatType:a,name:l,motionValue:c,element:u,...d},m=(u==null?void 0:u.KeyframeResolver)||h5;this.keyframeResolver=new m(o,(b,v,x)=>this.onKeyframesResolved(b,v,h,!x),l,c,u),(y=this.keyframeResolver)==null||y.scheduleResolve()}onKeyframesResolved(t,n,r,s){this.keyframeResolver=void 0;const{name:i,type:a,velocity:o,delay:l,isHandoff:c,onUpdate:u}=r;this.resolvedAt=Eo.now(),jHe(t,i,a,o)||((Yd.instantAnimations||!l)&&(u==null||u(d5(t,r,n))),t[0]=t[t.length-1],r.duration=0,r.repeat=0);const h={startTime:s?this.resolvedAt?this.resolvedAt-this.createdAt>FHe?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:n,...r,keyframes:t},m=!c&&DHe(h)?new MHe({...h,element:h.motionValue.owner.current}):new Mie(h);m.finished.then(()=>this.notifyFinished()).catch(Gl),this.pendingTimeline&&(this.stopTimeline=m.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=m}get finished(){return this._animation?this.animation.finished:this._finished}then(t,n){return this.finished.finally(t).then(()=>{})}get animation(){return this._animation||xHe(),this._animation}get duration(){return this.animation.duration}get time(){return this.animation.time}set time(t){this.animation.time=t}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(t){this.animation.speed=t}get startTime(){return this.animation.startTime}attachTimeline(t){return this._animation?this.stopTimeline=this.animation.attachTimeline(t):this.pendingTimeline=t,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this.animation.cancel()}}const m5=(e,t,n,r={},s,i)=>a=>{const o=s5(r,e)||{},l=o.delay||r.delay||0;let{elapsed:c=0}=r;c=c-Eu(l);const u={keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:t.getVelocity(),...o,delay:-c,onUpdate:h=>{t.set(h),o.onUpdate&&o.onUpdate(h)},onComplete:()=>{a(),o.onComplete&&o.onComplete()},name:e,motionValue:t,element:i?void 0:s};vWe(o)||Object.assign(u,bWe(e,u)),u.duration&&(u.duration=Eu(u.duration)),u.repeatDelay&&(u.repeatDelay=Eu(u.repeatDelay)),u.from!==void 0&&(u.keyframes[0]=u.from);let d=!1;if((u.type===!1||u.duration===0&&!u.repeatDelay)&&(u.duration=0,u.delay===0&&(d=!0)),(Yd.instantAnimations||Yd.skipAnimations)&&(d=!0,u.duration=0,u.delay=0),u.allowFlatten=!o.type&&!o.ease,d&&!i&&t.get()!==void 0){const h=hWe(u.keyframes,o);if(h!==void 0){ti.update(()=>{u.onUpdate(h),u.onComplete()});return}}return new LHe(u)},Lie=new Set(["width","height","top","left","right","bottom",...ub]);function BHe({protectedKeys:e,needsAnimating:t},n){const r=e.hasOwnProperty(n)&&t[n]!==!0;return t[n]=!1,r}function Bie(e,t,{delay:n=0,transitionOverride:r,type:s}={}){let{transition:i=e.getDefaultTransition(),transitionEnd:a,...o}=t;r&&(i=r);const l=[],c=s&&e.animationState&&e.animationState.getState()[s];for(const u in o){const d=e.getValue(u,e.latestValues[u]??null),h=o[u];if(h===void 0||c&&BHe(c,u))continue;const m={delay:n,...s5(i||{},u)},y=d.get();if(y!==void 0&&!d.isAnimating&&!Array.isArray(h)&&h===y&&!m.velocity)continue;let b=!1;if(window.MotionHandoffAnimation){const x=uie(e);if(x){const w=window.MotionHandoffAnimation(x,u,ti);w!==null&&(m.startTime=w,b=!0)}}L4(e,u),d.start(m5(u,d,h,e.shouldReduceMotion&&Lie.has(u)?{type:!1}:m,e,b));const v=d.animation;v&&l.push(v)}return a&&Promise.all(l).then(()=>{ti.update(()=>{a&&uWe(e,a)})}),l}function Y4(e,t,n={}){var l;const r=Hw(e,t,n.type==="exit"?(l=e.presenceContext)==null?void 0:l.custom:void 0);let{transition:s=e.getDefaultTransition()||{}}=r||{};n.transitionOverride&&(s=n.transitionOverride);const i=r?()=>Promise.all(Bie(e,r,n)):()=>Promise.resolve(),a=e.variantChildren&&e.variantChildren.size?(c=0)=>{const{delayChildren:u=0,staggerChildren:d,staggerDirection:h}=s;return $He(e,t,u+c,d,h,n)}:()=>Promise.resolve(),{when:o}=s;if(o){const[c,u]=o==="beforeChildren"?[i,a]:[a,i];return c().then(()=>u())}else return Promise.all([i(),a(n.delay)])}function $He(e,t,n=0,r=0,s=1,i){const a=[],o=(e.variantChildren.size-1)*r,l=s===1?(c=0)=>c*r:(c=0)=>o-c*r;return Array.from(e.variantChildren).sort(zHe).forEach((c,u)=>{c.notify("AnimationStart",t),a.push(Y4(c,t,{...i,delay:n+l(u)}).then(()=>c.notify("AnimationComplete",t)))}),Promise.all(a)}function zHe(e,t){return e.sortNodePosition(t)}function UHe(e,t,n={}){e.notify("AnimationStart",t);let r;if(Array.isArray(t)){const s=t.map(i=>Y4(e,i,n));r=Promise.all(s)}else if(typeof t=="string")r=Y4(e,t,n);else{const s=typeof t=="function"?Hw(e,t,n.custom):t;r=Promise.all(Bie(e,s,n))}return r.then(()=>{e.notify("AnimationComplete",t)})}function $ie(e,t){if(!Array.isArray(t))return!1;const n=t.length;if(n!==e.length)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}const qHe=q6.length;function zie(e){if(!e)return;if(!e.isControllingVariants){const n=e.parent?zie(e.parent)||{}:{};return e.props.initial!==void 0&&(n.initial=e.props.initial),n}const t={};for(let n=0;n<qHe;n++){const r=q6[n],s=e.props[r];(qw(s)||s===!1)&&(t[r]=s)}return t}const VHe=[...U6].reverse(),WHe=U6.length;function HHe(e){return t=>Promise.all(t.map(({animation:n,options:r})=>UHe(e,n,r)))}function GHe(e){let t=HHe(e),n=_q(),r=!0;const s=l=>(c,u)=>{var h;const d=Hw(e,u,l==="exit"?(h=e.presenceContext)==null?void 0:h.custom:void 0);if(d){const{transition:m,transitionEnd:y,...b}=d;c={...c,...b,...y}}return c};function i(l){t=l(e)}function a(l){const{props:c}=e,u=zie(e.parent)||{},d=[],h=new Set;let m={},y=1/0;for(let v=0;v<WHe;v++){const x=VHe[v],w=n[x],S=c[x]!==void 0?c[x]:u[x],C=qw(S),k=x===l?w.isActive:null;k===!1&&(y=v);let A=S===u[x]&&S!==c[x]&&C;if(A&&r&&e.manuallyAnimateOnMount&&(A=!1),w.protectedKeys={...m},!w.isActive&&k===null||!S&&!w.prevProp||WT(S)||typeof S=="boolean")continue;const R=KHe(w.prevProp,S);let N=R||x===l&&w.isActive&&!A&&C||v>y&&C,I=!1;const P=Array.isArray(S)?S:[S];let L=P.reduce(s(x),{});k===!1&&(L={});const{prevResolvedValues:O={}}=w,V={...O,...L},D=H=>{N=!0,h.has(H)&&(I=!0,h.delete(H)),w.needsAnimating[H]=!0;const $=e.getValue(H);$&&($.liveStyle=!1)};for(const H in V){const $=L[H],ne=O[H];if(m.hasOwnProperty(H))continue;let W=!1;F4($)&&F4(ne)?W=!$ie($,ne):W=$!==ne,W?$!=null?D(H):h.add(H):$!==void 0&&h.has(H)?D(H):w.protectedKeys[H]=!0}w.prevProp=S,w.prevResolvedValues=L,w.isActive&&(m={...m,...L}),r&&e.blockInitialAnimation&&(N=!1),N&&(!(A&&R)||I)&&d.push(...P.map(H=>({animation:H,options:{type:x}})))}if(h.size){const v={};if(typeof c.initial!="boolean"){const x=Hw(e,Array.isArray(c.initial)?c.initial[0]:c.initial);x&&x.transition&&(v.transition=x.transition)}h.forEach(x=>{const w=e.getBaseTarget(x),S=e.getValue(x);S&&(S.liveStyle=!0),v[x]=w??null}),d.push({animation:v})}let b=!!d.length;return r&&(c.initial===!1||c.initial===c.animate)&&!e.manuallyAnimateOnMount&&(b=!1),r=!1,b?t(d):Promise.resolve()}function o(l,c){var d;if(n[l].isActive===c)return Promise.resolve();(d=e.variantChildren)==null||d.forEach(h=>{var m;return(m=h.animationState)==null?void 0:m.setActive(l,c)}),n[l].isActive=c;const u=a(l);for(const h in n)n[h].protectedKeys={};return u}return{animateChanges:a,setActive:o,setAnimateFunction:i,getState:()=>n,reset:()=>{n=_q(),r=!0}}}function KHe(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!$ie(t,e):!1}function Up(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function _q(){return{animate:Up(!0),whileInView:Up(),whileHover:Up(),whileTap:Up(),whileDrag:Up(),whileFocus:Up(),exit:Up()}}class Qh{constructor(t){this.isMounted=!1,this.node=t}update(){}}class YHe extends Qh{constructor(t){super(t),t.animationState||(t.animationState=GHe(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();WT(t)&&(this.unmountControls=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:n}=this.node.prevProps||{};t!==n&&this.updateAnimationControlsSubscription()}unmount(){var t;this.node.animationState.reset(),(t=this.unmountControls)==null||t.call(this)}}let ZHe=0;class XHe extends Qh{constructor(){super(...arguments),this.id=ZHe++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:n}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===r)return;const s=this.node.animationState.setActive("exit",!t);n&&!t&&s.then(()=>{n(this.id)})}mount(){const{register:t,onExitComplete:n}=this.node.presenceContext||{};n&&n(this.id),t&&(this.unmount=t(this.id))}unmount(){}}const JHe={animation:{Feature:YHe},exit:{Feature:XHe}};function Zw(e,t,n,r={passive:!0}){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n)}const g5=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1;function t_(e){return{point:{x:e.pageX,y:e.pageY}}}const QHe=e=>t=>g5(t)&&e(t,t_(t));function Rx(e,t,n,r){return Zw(e,t,QHe(n),r)}function Uie({top:e,left:t,right:n,bottom:r}){return{x:{min:t,max:n},y:{min:e,max:r}}}function eGe({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function tGe(e,t){if(!t)return e;const n=t({x:e.left,y:e.top}),r=t({x:e.right,y:e.bottom});return{top:n.y,left:n.x,bottom:r.y,right:r.x}}const qie=1e-4,nGe=1-qie,rGe=1+qie,Vie=.01,sGe=0-Vie,iGe=0+Vie;function to(e){return e.max-e.min}function aGe(e,t,n){return Math.abs(e-t)<=n}function Sq(e,t,n,r=.5){e.origin=r,e.originPoint=Qs(t.min,t.max,e.origin),e.scale=to(n)/to(t),e.translate=Qs(n.min,n.max,e.origin)-e.originPoint,(e.scale>=nGe&&e.scale<=rGe||isNaN(e.scale))&&(e.scale=1),(e.translate>=sGe&&e.translate<=iGe||isNaN(e.translate))&&(e.translate=0)}function Nx(e,t,n,r){Sq(e.x,t.x,n.x,r?r.originX:void 0),Sq(e.y,t.y,n.y,r?r.originY:void 0)}function Cq(e,t,n){e.min=n.min+t.min,e.max=e.min+to(t)}function oGe(e,t,n){Cq(e.x,t.x,n.x),Cq(e.y,t.y,n.y)}function kq(e,t,n){e.min=t.min-n.min,e.max=e.min+to(t)}function Mx(e,t,n){kq(e.x,t.x,n.x),kq(e.y,t.y,n.y)}const Eq=()=>({translate:0,scale:1,origin:0,originPoint:0}),_0=()=>({x:Eq(),y:Eq()}),Tq=()=>({min:0,max:0}),hi=()=>({x:Tq(),y:Tq()});function Bl(e){return[e("x"),e("y")]}function KI(e){return e===void 0||e===1}function Z4({scale:e,scaleX:t,scaleY:n}){return!KI(e)||!KI(t)||!KI(n)}function Gp(e){return Z4(e)||Wie(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function Wie(e){return Aq(e.x)||Aq(e.y)}function Aq(e){return e&&e!=="0%"}function Zk(e,t,n){const r=e-n,s=t*r;return n+s}function Rq(e,t,n,r,s){return s!==void 0&&(e=Zk(e,s,r)),Zk(e,n,r)+t}function X4(e,t=0,n=1,r,s){e.min=Rq(e.min,t,n,r,s),e.max=Rq(e.max,t,n,r,s)}function Hie(e,{x:t,y:n}){X4(e.x,t.translate,t.scale,t.originPoint),X4(e.y,n.translate,n.scale,n.originPoint)}const Nq=.999999999999,Mq=1.0000000000001;function lGe(e,t,n,r=!1){const s=n.length;if(!s)return;t.x=t.y=1;let i,a;for(let o=0;o<s;o++){i=n[o],a=i.projectionDelta;const{visualElement:l}=i.options;l&&l.props.style&&l.props.style.display==="contents"||(r&&i.options.layoutScroll&&i.scroll&&i!==i.root&&C0(e,{x:-i.scroll.offset.x,y:-i.scroll.offset.y}),a&&(t.x*=a.x.scale,t.y*=a.y.scale,Hie(e,a)),r&&Gp(i.latestValues)&&C0(e,i.latestValues))}t.x<Mq&&t.x>Nq&&(t.x=1),t.y<Mq&&t.y>Nq&&(t.y=1)}function S0(e,t){e.min=e.min+t,e.max=e.max+t}function Iq(e,t,n,r,s=.5){const i=Qs(e.min,e.max,s);X4(e,t,n,i,r)}function C0(e,t){Iq(e.x,t.x,t.scaleX,t.scale,t.originX),Iq(e.y,t.y,t.scaleY,t.scale,t.originY)}function Gie(e,t){return Uie(tGe(e.getBoundingClientRect(),t))}function cGe(e,t,n){const r=Gie(e,n),{scroll:s}=t;return s&&(S0(r.x,s.offset.x),S0(r.y,s.offset.y)),r}const Kie=({current:e})=>e?e.ownerDocument.defaultView:null,jq=(e,t)=>Math.abs(e-t);function uGe(e,t){const n=jq(e.x,t.x),r=jq(e.y,t.y);return Math.sqrt(n**2+r**2)}class Yie{constructor(t,n,{transformPagePoint:r,contextWindow:s,dragSnapToOrigin:i=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const d=ZI(this.lastMoveEventInfo,this.history),h=this.startEvent!==null,m=uGe(d.offset,{x:0,y:0})>=3;if(!h&&!m)return;const{point:y}=d,{timestamp:b}=ba;this.history.push({...y,timestamp:b});const{onStart:v,onMove:x}=this.handlers;h||(v&&v(this.lastMoveEvent,d),this.startEvent=this.lastMoveEvent),x&&x(this.lastMoveEvent,d)},this.handlePointerMove=(d,h)=>{this.lastMoveEvent=d,this.lastMoveEventInfo=YI(h,this.transformPagePoint),ti.update(this.updatePoint,!0)},this.handlePointerUp=(d,h)=>{this.end();const{onEnd:m,onSessionEnd:y,resumeAnimation:b}=this.handlers;if(this.dragSnapToOrigin&&b&&b(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const v=ZI(d.type==="pointercancel"?this.lastMoveEventInfo:YI(h,this.transformPagePoint),this.history);this.startEvent&&m&&m(d,v),y&&y(d,v)},!g5(t))return;this.dragSnapToOrigin=i,this.handlers=n,this.transformPagePoint=r,this.contextWindow=s||window;const a=t_(t),o=YI(a,this.transformPagePoint),{point:l}=o,{timestamp:c}=ba;this.history=[{...l,timestamp:c}];const{onSessionStart:u}=n;u&&u(t,ZI(o,this.history)),this.removeListeners=Q1(Rx(this.contextWindow,"pointermove",this.handlePointerMove),Rx(this.contextWindow,"pointerup",this.handlePointerUp),Rx(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),jh(this.updatePoint)}}function YI(e,t){return t?{point:t(e.point)}:e}function Pq(e,t){return{x:e.x-t.x,y:e.y-t.y}}function ZI({point:e},t){return{point:e,delta:Pq(e,Zie(t)),offset:Pq(e,dGe(t)),velocity:fGe(t,.1)}}function dGe(e){return e[0]}function Zie(e){return e[e.length-1]}function fGe(e,t){if(e.length<2)return{x:0,y:0};let n=e.length-1,r=null;const s=Zie(e);for(;n>=0&&(r=e[n],!(s.timestamp-r.timestamp>Eu(t)));)n--;if(!r)return{x:0,y:0};const i=Tu(s.timestamp-r.timestamp);if(i===0)return{x:0,y:0};const a={x:(s.x-r.x)/i,y:(s.y-r.y)/i};return a.x===1/0&&(a.x=0),a.y===1/0&&(a.y=0),a}function hGe(e,{min:t,max:n},r){return t!==void 0&&e<t?e=r?Qs(t,e,r.min):Math.max(e,t):n!==void 0&&e>n&&(e=r?Qs(n,e,r.max):Math.min(e,n)),e}function Oq(e,t,n){return{min:t!==void 0?e.min+t:void 0,max:n!==void 0?e.max+n-(e.max-e.min):void 0}}function pGe(e,{top:t,left:n,bottom:r,right:s}){return{x:Oq(e.x,n,s),y:Oq(e.y,t,r)}}function Dq(e,t){let n=t.min-e.min,r=t.max-e.max;return t.max-t.min<e.max-e.min&&([n,r]=[r,n]),{min:n,max:r}}function mGe(e,t){return{x:Dq(e.x,t.x),y:Dq(e.y,t.y)}}function gGe(e,t){let n=.5;const r=to(e),s=to(t);return s>r?n=Yw(t.min,t.max-r,e.min):r>s&&(n=Yw(e.min,e.max-s,t.min)),Zd(0,1,n)}function yGe(e,t){const n={};return t.min!==void 0&&(n.min=t.min-e.min),t.max!==void 0&&(n.max=t.max-e.min),n}const J4=.35;function bGe(e=J4){return e===!1?e=0:e===!0&&(e=J4),{x:Fq(e,"left","right"),y:Fq(e,"top","bottom")}}function Fq(e,t,n){return{min:Lq(e,t),max:Lq(e,n)}}function Lq(e,t){return typeof e=="number"?e:e[t]||0}const pc={x:!1,y:!1};function Xie(){return pc.x||pc.y}function vGe(e){return e==="x"||e==="y"?pc[e]?null:(pc[e]=!0,()=>{pc[e]=!1}):pc.x||pc.y?null:(pc.x=pc.y=!0,()=>{pc.x=pc.y=!1})}const xGe=new WeakMap;class wGe{constructor(t){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=hi(),this.visualElement=t}start(t,{snapToCursor:n=!1}={}){const{presenceContext:r}=this.visualElement;if(r&&r.isPresent===!1)return;const s=u=>{const{dragSnapToOrigin:d}=this.getProps();d?this.pauseAnimation():this.stopAnimation(),n&&this.snapToCursor(t_(u).point)},i=(u,d)=>{const{drag:h,dragPropagation:m,onDragStart:y}=this.getProps();if(h&&!m&&(this.openDragLock&&this.openDragLock(),this.openDragLock=vGe(h),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Bl(v=>{let x=this.getAxisMotionValue(v).get()||0;if(ku.test(x)){const{projection:w}=this.visualElement;if(w&&w.layout){const S=w.layout.layoutBox[v];S&&(x=to(S)*(parseFloat(x)/100))}}this.originPoint[v]=x}),y&&ti.postRender(()=>y(u,d)),L4(this.visualElement,"transform");const{animationState:b}=this.visualElement;b&&b.setActive("whileDrag",!0)},a=(u,d)=>{const{dragPropagation:h,dragDirectionLock:m,onDirectionLock:y,onDrag:b}=this.getProps();if(!h&&!this.openDragLock)return;const{offset:v}=d;if(m&&this.currentDirection===null){this.currentDirection=_Ge(v),this.currentDirection!==null&&y&&y(this.currentDirection);return}this.updateAxis("x",d.point,v),this.updateAxis("y",d.point,v),this.visualElement.render(),b&&b(u,d)},o=(u,d)=>this.stop(u,d),l=()=>Bl(u=>{var d;return this.getAnimationState(u)==="paused"&&((d=this.getAxisMotionValue(u).animation)==null?void 0:d.play())}),{dragSnapToOrigin:c}=this.getProps();this.panSession=new Yie(t,{onSessionStart:s,onStart:i,onMove:a,onSessionEnd:o,resumeAnimation:l},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:c,contextWindow:Kie(this.visualElement)})}stop(t,n){const r=this.isDragging;if(this.cancel(),!r)return;const{velocity:s}=n;this.startAnimation(s);const{onDragEnd:i}=this.getProps();i&&ti.postRender(()=>i(t,n))}cancel(){this.isDragging=!1;const{projection:t,animationState:n}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(t,n,r){const{drag:s}=this.getProps();if(!r||!s2(t,s,this.currentDirection))return;const i=this.getAxisMotionValue(t);let a=this.originPoint[t]+r[t];this.constraints&&this.constraints[t]&&(a=hGe(a,this.constraints[t],this.elastic[t])),i.set(a)}resolveConstraints(){var i;const{dragConstraints:t,dragElastic:n}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(i=this.visualElement.projection)==null?void 0:i.layout,s=this.constraints;t&&x0(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&r?this.constraints=pGe(r.layoutBox,t):this.constraints=!1,this.elastic=bGe(n),s!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&Bl(a=>{this.constraints!==!1&&this.getAxisMotionValue(a)&&(this.constraints[a]=yGe(r.layoutBox[a],this.constraints[a]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:n}=this.getProps();if(!t||!x0(t))return!1;const r=t.current,{projection:s}=this.visualElement;if(!s||!s.layout)return!1;const i=cGe(r,s.root,this.visualElement.getTransformPagePoint());let a=mGe(s.layout.layoutBox,i);if(n){const o=n(eGe(a));this.hasMutatedConstraints=!!o,o&&(a=Uie(o))}return a}startAnimation(t){const{drag:n,dragMomentum:r,dragElastic:s,dragTransition:i,dragSnapToOrigin:a,onDragTransitionEnd:o}=this.getProps(),l=this.constraints||{},c=Bl(u=>{if(!s2(u,n,this.currentDirection))return;let d=l&&l[u]||{};a&&(d={min:0,max:0});const h=s?200:1e6,m=s?40:1e7,y={type:"inertia",velocity:r?t[u]:0,bounceStiffness:h,bounceDamping:m,timeConstant:750,restDelta:1,restSpeed:10,...i,...d};return this.startAxisValueAnimation(u,y)});return Promise.all(c).then(o)}startAxisValueAnimation(t,n){const r=this.getAxisMotionValue(t);return L4(this.visualElement,t),r.start(m5(t,r,0,n,this.visualElement,!1))}stopAnimation(){Bl(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){Bl(t=>{var n;return(n=this.getAxisMotionValue(t).animation)==null?void 0:n.pause()})}getAnimationState(t){var n;return(n=this.getAxisMotionValue(t).animation)==null?void 0:n.state}getAxisMotionValue(t){const n=`_drag${t.toUpperCase()}`,r=this.visualElement.getProps(),s=r[n];return s||this.visualElement.getValue(t,(r.initial?r.initial[t]:void 0)||0)}snapToCursor(t){Bl(n=>{const{drag:r}=this.getProps();if(!s2(n,r,this.currentDirection))return;const{projection:s}=this.visualElement,i=this.getAxisMotionValue(n);if(s&&s.layout){const{min:a,max:o}=s.layout.layoutBox[n];i.set(t[n]-Qs(a,o,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:n}=this.getProps(),{projection:r}=this.visualElement;if(!x0(n)||!r||!this.constraints)return;this.stopAnimation();const s={x:0,y:0};Bl(a=>{const o=this.getAxisMotionValue(a);if(o&&this.constraints!==!1){const l=o.get();s[a]=gGe({min:l,max:l},this.constraints[a])}});const{transformTemplate:i}=this.visualElement.getProps();this.visualElement.current.style.transform=i?i({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),Bl(a=>{if(!s2(a,t,null))return;const o=this.getAxisMotionValue(a),{min:l,max:c}=this.constraints[a];o.set(Qs(l,c,s[a]))})}addListeners(){if(!this.visualElement.current)return;xGe.set(this.visualElement,this);const t=this.visualElement.current,n=Rx(t,"pointerdown",l=>{const{drag:c,dragListener:u=!0}=this.getProps();c&&u&&this.start(l)}),r=()=>{const{dragConstraints:l}=this.getProps();x0(l)&&l.current&&(this.constraints=this.resolveRefConstraints())},{projection:s}=this.visualElement,i=s.addEventListener("measure",r);s&&!s.layout&&(s.root&&s.root.updateScroll(),s.updateLayout()),ti.read(r);const a=Zw(window,"resize",()=>this.scalePositionWithinConstraints()),o=s.addEventListener("didUpdate",({delta:l,hasLayoutChanged:c})=>{this.isDragging&&c&&(Bl(u=>{const d=this.getAxisMotionValue(u);d&&(this.originPoint[u]+=l[u].translate,d.set(d.get()+l[u].translate))}),this.visualElement.render())});return()=>{a(),n(),i(),o&&o()}}getProps(){const t=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:r=!1,dragPropagation:s=!1,dragConstraints:i=!1,dragElastic:a=J4,dragMomentum:o=!0}=t;return{...t,drag:n,dragDirectionLock:r,dragPropagation:s,dragConstraints:i,dragElastic:a,dragMomentum:o}}}function s2(e,t,n){return(t===!0||t===e)&&(n===null||n===e)}function _Ge(e,t=10){let n=null;return Math.abs(e.y)>t?n="y":Math.abs(e.x)>t&&(n="x"),n}class SGe extends Qh{constructor(t){super(t),this.removeGroupControls=Gl,this.removeListeners=Gl,this.controls=new wGe(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Gl}unmount(){this.removeGroupControls(),this.removeListeners()}}const Bq=e=>(t,n)=>{e&&ti.postRender(()=>e(t,n))};class CGe extends Qh{constructor(){super(...arguments),this.removePointerDownListener=Gl}onPointerDown(t){this.session=new Yie(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:Kie(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:n,onPan:r,onPanEnd:s}=this.node.getProps();return{onSessionStart:Bq(t),onStart:Bq(n),onMove:r,onEnd:(i,a)=>{delete this.session,s&&ti.postRender(()=>s(i,a))}}}mount(){this.removePointerDownListener=Rx(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const K2={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function $q(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const Gv={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(ir.test(e))e=parseFloat(e);else return e;const n=$q(e,t.target.x),r=$q(e,t.target.y);return`${n}% ${r}%`}},kGe={correct:(e,{treeScale:t,projectionDelta:n})=>{const r=e,s=Ph.parse(e);if(s.length>5)return r;const i=Ph.createTransformer(e),a=typeof s[0]!="number"?1:0,o=n.x.scale*t.x,l=n.y.scale*t.y;s[0+a]/=o,s[1+a]/=l;const c=Qs(o,l,.5);return typeof s[2+a]=="number"&&(s[2+a]/=c),typeof s[3+a]=="number"&&(s[3+a]/=c),i(s)}};class EGe extends T.Component{componentDidMount(){const{visualElement:t,layoutGroup:n,switchLayoutGroup:r,layoutId:s}=this.props,{projection:i}=t;LVe(TGe),i&&(n.group&&n.group.add(i),r&&r.register&&s&&r.register(i),i.root.didUpdate(),i.addEventListener("animationComplete",()=>{this.safeToRemove()}),i.setOptions({...i.options,onExitComplete:()=>this.safeToRemove()})),K2.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:n,visualElement:r,drag:s,isPresent:i}=this.props,{projection:a}=r;return a&&(a.isPresent=i,s||t.layoutDependency!==n||n===void 0||t.isPresent!==i?a.willUpdate():this.safeToRemove(),t.isPresent!==i&&(i?a.promote():a.relegate()||ti.postRender(()=>{const o=a.getStack();(!o||!o.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),W6.postRender(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:n,switchLayoutGroup:r}=this.props,{projection:s}=t;s&&(s.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(s),r&&r.deregister&&r.deregister(s))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function Jie(e){const[t,n]=Hse(),r=T.useContext(L6);return f.jsx(EGe,{...e,layoutGroup:r,switchLayoutGroup:T.useContext(Jse),isPresent:t,safeToRemove:n})}const TGe={borderRadius:{...Gv,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Gv,borderTopRightRadius:Gv,borderBottomLeftRadius:Gv,borderBottomRightRadius:Gv,boxShadow:kGe};function AGe(e,t,n){const r=Oa(e)?e:Gw(e);return r.start(m5("",r,t,n)),r.animation}function RGe(e){return e instanceof SVGElement&&e.tagName!=="svg"}const NGe=(e,t)=>e.depth-t.depth;class MGe{constructor(){this.children=[],this.isDirty=!1}add(t){t5(this.children,t),this.isDirty=!0}remove(t){n5(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(NGe),this.isDirty=!1,this.children.forEach(t)}}function IGe(e,t){const n=Eo.now(),r=({timestamp:s})=>{const i=s-n;i>=t&&(jh(r),e(i-t))};return ti.setup(r,!0),()=>jh(r)}const Qie=["TopLeft","TopRight","BottomLeft","BottomRight"],jGe=Qie.length,zq=e=>typeof e=="string"?parseFloat(e):e,Uq=e=>typeof e=="number"||ir.test(e);function PGe(e,t,n,r,s,i){s?(e.opacity=Qs(0,n.opacity??1,OGe(r)),e.opacityExit=Qs(t.opacity??1,0,DGe(r))):i&&(e.opacity=Qs(t.opacity??1,n.opacity??1,r));for(let a=0;a<jGe;a++){const o=`border${Qie[a]}Radius`;let l=qq(t,o),c=qq(n,o);if(l===void 0&&c===void 0)continue;l||(l=0),c||(c=0),l===0||c===0||Uq(l)===Uq(c)?(e[o]=Math.max(Qs(zq(l),zq(c),r),0),(ku.test(c)||ku.test(l))&&(e[o]+="%")):e[o]=c}(t.rotate||n.rotate)&&(e.rotate=Qs(t.rotate||0,n.rotate||0,r))}function qq(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const OGe=eae(0,.5,Tie),DGe=eae(.5,.95,Gl);function eae(e,t,n){return r=>r<e?0:r>t?1:n(Yw(e,t,r))}function Vq(e,t){e.min=t.min,e.max=t.max}function Fl(e,t){Vq(e.x,t.x),Vq(e.y,t.y)}function Wq(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}function Hq(e,t,n,r,s){return e-=t,e=Zk(e,1/n,r),s!==void 0&&(e=Zk(e,1/s,r)),e}function FGe(e,t=0,n=1,r=.5,s,i=e,a=e){if(ku.test(t)&&(t=parseFloat(t),t=Qs(a.min,a.max,t/100)-a.min),typeof t!="number")return;let o=Qs(i.min,i.max,r);e===i&&(o-=t),e.min=Hq(e.min,t,n,o,s),e.max=Hq(e.max,t,n,o,s)}function Gq(e,t,[n,r,s],i,a){FGe(e,t[n],t[r],t[s],t.scale,i,a)}const LGe=["x","scaleX","originX"],BGe=["y","scaleY","originY"];function Kq(e,t,n,r){Gq(e.x,t,LGe,n?n.x:void 0,r?r.x:void 0),Gq(e.y,t,BGe,n?n.y:void 0,r?r.y:void 0)}function Yq(e){return e.translate===0&&e.scale===1}function tae(e){return Yq(e.x)&&Yq(e.y)}function Zq(e,t){return e.min===t.min&&e.max===t.max}function $Ge(e,t){return Zq(e.x,t.x)&&Zq(e.y,t.y)}function Xq(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function nae(e,t){return Xq(e.x,t.x)&&Xq(e.y,t.y)}function Jq(e){return to(e.x)/to(e.y)}function Qq(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}class zGe{constructor(){this.members=[]}add(t){t5(this.members,t),t.scheduleRender()}remove(t){if(n5(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(t){const n=this.members.findIndex(s=>t===s);if(n===0)return!1;let r;for(let s=n;s>=0;s--){const i=this.members[s];if(i.isPresent!==!1){r=i;break}}return r?(this.promote(r),!0):!1}promote(t,n){const r=this.lead;if(t!==r&&(this.prevLead=r,this.lead=t,t.show(),r)){r.instance&&r.scheduleRender(),t.scheduleRender(),t.resumeFrom=r,n&&(t.resumeFrom.preserveOpacity=!0),r.snapshot&&(t.snapshot=r.snapshot,t.snapshot.latestValues=r.animationValues||r.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:s}=t.options;s===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:n,resumingFrom:r}=t;n.onExitComplete&&n.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function UGe(e,t,n){let r="";const s=e.x.translate/t.x,i=e.y.translate/t.y,a=(n==null?void 0:n.z)||0;if((s||i||a)&&(r=`translate3d(${s}px, ${i}px, ${a}px) `),(t.x!==1||t.y!==1)&&(r+=`scale(${1/t.x}, ${1/t.y}) `),n){const{transformPerspective:c,rotate:u,rotateX:d,rotateY:h,skewX:m,skewY:y}=n;c&&(r=`perspective(${c}px) ${r}`),u&&(r+=`rotate(${u}deg) `),d&&(r+=`rotateX(${d}deg) `),h&&(r+=`rotateY(${h}deg) `),m&&(r+=`skewX(${m}deg) `),y&&(r+=`skewY(${y}deg) `)}const o=e.x.scale*t.x,l=e.y.scale*t.y;return(o!==1||l!==1)&&(r+=`scale(${o}, ${l})`),r||"none"}const XI=["","X","Y","Z"],qGe={visibility:"hidden"},eV=1e3;let VGe=0;function JI(e,t,n,r){const{latestValues:s}=t;s[e]&&(n[e]=s[e],t.setStaticValue(e,0),r&&(r[e]=0))}function rae(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:t}=e.options;if(!t)return;const n=uie(t);if(window.MotionHasOptimisedAnimation(n,"transform")){const{layout:s,layoutId:i}=e.options;window.MotionCancelOptimisedAnimation(n,"transform",ti,!(s||i))}const{parent:r}=e;r&&!r.hasCheckedOptimisedAppear&&rae(r)}function sae({attachResizeListener:e,defaultParent:t,measureScroll:n,checkIsScrollRoot:r,resetTransform:s}){return class{constructor(a={},o=t==null?void 0:t()){this.id=VGe++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(GGe),this.nodes.forEach(JGe),this.nodes.forEach(QGe),this.nodes.forEach(KGe)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=a,this.root=o?o.root||o:this,this.path=o?[...o.path,o]:[],this.parent=o,this.depth=o?o.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new MGe)}addEventListener(a,o){return this.eventHandlers.has(a)||this.eventHandlers.set(a,new r5),this.eventHandlers.get(a).add(o)}notifyListeners(a,...o){const l=this.eventHandlers.get(a);l&&l.notify(...o)}hasListeners(a){return this.eventHandlers.has(a)}mount(a){if(this.instance)return;this.isSVG=RGe(a),this.instance=a;const{layoutId:o,layout:l,visualElement:c}=this.options;if(c&&!c.current&&c.mount(a),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(l||o)&&(this.isLayoutDirty=!0),e){let u;const d=()=>this.root.updateBlockedByResize=!1;e(a,()=>{this.root.updateBlockedByResize=!0,u&&u(),u=IGe(d,250),K2.hasAnimatedSinceResize&&(K2.hasAnimatedSinceResize=!1,this.nodes.forEach(nV))})}o&&this.root.registerSharedNode(o,this),this.options.animate!==!1&&c&&(o||l)&&this.addEventListener("didUpdate",({delta:u,hasLayoutChanged:d,hasRelativeLayoutChanged:h,layout:m})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const y=this.options.transition||c.getDefaultTransition()||sKe,{onLayoutAnimationStart:b,onLayoutAnimationComplete:v}=c.getProps(),x=!this.targetLayout||!nae(this.targetLayout,m),w=!d&&h;if(this.options.layoutRoot||this.resumeFrom||w||d&&(x||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(u,w);const S={...s5(y,"layout"),onPlay:b,onComplete:v};(c.shouldReduceMotion||this.options.layoutRoot)&&(S.delay=0,S.type=!1),this.startAnimation(S)}else d||nV(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=m})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const a=this.getStack();a&&a.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),jh(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(eKe),this.animationId++)}getTransformTemplate(){const{visualElement:a}=this.options;return a&&a.getProps().transformTemplate}willUpdate(a=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&rae(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let u=0;u<this.path.length;u++){const d=this.path[u];d.shouldResetTransform=!0,d.updateScroll("snapshot"),d.options.layoutRoot&&d.willUpdate(!1)}const{layoutId:o,layout:l}=this.options;if(o===void 0&&!l)return;const c=this.getTransformTemplate();this.prevTransformTemplateValue=c?c(this.latestValues,""):void 0,this.updateSnapshot(),a&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(tV);return}this.isUpdating||this.nodes.forEach(ZGe),this.isUpdating=!1,this.nodes.forEach(XGe),this.nodes.forEach(WGe),this.nodes.forEach(HGe),this.clearAllSnapshots();const o=Eo.now();ba.delta=Zd(0,1e3/60,o-ba.timestamp),ba.timestamp=o,ba.isProcessing=!0,VI.update.process(ba),VI.preRender.process(ba),VI.render.process(ba),ba.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,W6.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(YGe),this.sharedNodes.forEach(tKe)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,ti.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){ti.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!to(this.snapshot.measuredBox.x)&&!to(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const a=this.layout;this.layout=this.measure(!1),this.layoutCorrected=hi(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:o}=this.options;o&&o.notify("LayoutMeasure",this.layout.layoutBox,a?a.layoutBox:void 0)}updateScroll(a="measure"){let o=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===a&&(o=!1),o&&this.instance){const l=r(this.instance);this.scroll={animationId:this.root.animationId,phase:a,isRoot:l,offset:n(this.instance),wasRoot:this.scroll?this.scroll.isRoot:l}}}resetTransform(){if(!s)return;const a=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,o=this.projectionDelta&&!tae(this.projectionDelta),l=this.getTransformTemplate(),c=l?l(this.latestValues,""):void 0,u=c!==this.prevTransformTemplateValue;a&&this.instance&&(o||Gp(this.latestValues)||u)&&(s(this.instance,c),this.shouldResetTransform=!1,this.scheduleRender())}measure(a=!0){const o=this.measurePageBox();let l=this.removeElementScroll(o);return a&&(l=this.removeTransform(l)),iKe(l),{animationId:this.root.animationId,measuredBox:o,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){var c;const{visualElement:a}=this.options;if(!a)return hi();const o=a.measureViewportBox();if(!(((c=this.scroll)==null?void 0:c.wasRoot)||this.path.some(aKe))){const{scroll:u}=this.root;u&&(S0(o.x,u.offset.x),S0(o.y,u.offset.y))}return o}removeElementScroll(a){var l;const o=hi();if(Fl(o,a),(l=this.scroll)!=null&&l.wasRoot)return o;for(let c=0;c<this.path.length;c++){const u=this.path[c],{scroll:d,options:h}=u;u!==this.root&&d&&h.layoutScroll&&(d.wasRoot&&Fl(o,a),S0(o.x,d.offset.x),S0(o.y,d.offset.y))}return o}applyTransform(a,o=!1){const l=hi();Fl(l,a);for(let c=0;c<this.path.length;c++){const u=this.path[c];!o&&u.options.layoutScroll&&u.scroll&&u!==u.root&&C0(l,{x:-u.scroll.offset.x,y:-u.scroll.offset.y}),Gp(u.latestValues)&&C0(l,u.latestValues)}return Gp(this.latestValues)&&C0(l,this.latestValues),l}removeTransform(a){const o=hi();Fl(o,a);for(let l=0;l<this.path.length;l++){const c=this.path[l];if(!c.instance||!Gp(c.latestValues))continue;Z4(c.latestValues)&&c.updateSnapshot();const u=hi(),d=c.measurePageBox();Fl(u,d),Kq(o,c.latestValues,c.snapshot?c.snapshot.layoutBox:void 0,u)}return Gp(this.latestValues)&&Kq(o,this.latestValues),o}setTargetDelta(a){this.targetDelta=a,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(a){this.options={...this.options,...a,crossfade:a.crossfade!==void 0?a.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==ba.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(a=!1){var h;const o=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=o.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=o.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=o.isSharedProjectionDirty);const l=!!this.resumingFrom||this!==o;if(!(a||l&&this.isSharedProjectionDirty||this.isProjectionDirty||(h=this.parent)!=null&&h.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:u,layoutId:d}=this.options;if(!(!this.layout||!(u||d))){if(this.resolvedRelativeTargetAt=ba.timestamp,!this.targetDelta&&!this.relativeTarget){const m=this.getClosestProjectingParent();m&&m.layout&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=hi(),this.relativeTargetOrigin=hi(),Mx(this.relativeTargetOrigin,this.layout.layoutBox,m.layout.layoutBox),Fl(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=hi(),this.targetWithTransforms=hi()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),oGe(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Fl(this.target,this.layout.layoutBox),Hie(this.target,this.targetDelta)):Fl(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const m=this.getClosestProjectingParent();m&&!!m.resumingFrom==!!this.resumingFrom&&!m.options.layoutScroll&&m.target&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=hi(),this.relativeTargetOrigin=hi(),Mx(this.relativeTargetOrigin,this.target,m.target),Fl(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||Z4(this.parent.latestValues)||Wie(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var y;const a=this.getLead(),o=!!this.resumingFrom||this!==a;let l=!0;if((this.isProjectionDirty||(y=this.parent)!=null&&y.isProjectionDirty)&&(l=!1),o&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(l=!1),this.resolvedRelativeTargetAt===ba.timestamp&&(l=!1),l)return;const{layout:c,layoutId:u}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(c||u))return;Fl(this.layoutCorrected,this.layout.layoutBox);const d=this.treeScale.x,h=this.treeScale.y;lGe(this.layoutCorrected,this.treeScale,this.path,o),a.layout&&!a.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(a.target=a.layout.layoutBox,a.targetWithTransforms=hi());const{target:m}=a;if(!m){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(Wq(this.prevProjectionDelta.x,this.projectionDelta.x),Wq(this.prevProjectionDelta.y,this.projectionDelta.y)),Nx(this.projectionDelta,this.layoutCorrected,m,this.latestValues),(this.treeScale.x!==d||this.treeScale.y!==h||!Qq(this.projectionDelta.x,this.prevProjectionDelta.x)||!Qq(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",m))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(a=!0){var o;if((o=this.options.visualElement)==null||o.scheduleRender(),a){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=_0(),this.projectionDelta=_0(),this.projectionDeltaWithTransform=_0()}setAnimationOrigin(a,o=!1){const l=this.snapshot,c=l?l.latestValues:{},u={...this.latestValues},d=_0();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!o;const h=hi(),m=l?l.source:void 0,y=this.layout?this.layout.source:void 0,b=m!==y,v=this.getStack(),x=!v||v.members.length<=1,w=!!(b&&!x&&this.options.crossfade===!0&&!this.path.some(rKe));this.animationProgress=0;let S;this.mixTargetDelta=C=>{const k=C/1e3;rV(d.x,a.x,k),rV(d.y,a.y,k),this.setTargetDelta(d),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Mx(h,this.layout.layoutBox,this.relativeParent.layout.layoutBox),nKe(this.relativeTarget,this.relativeTargetOrigin,h,k),S&&$Ge(this.relativeTarget,S)&&(this.isProjectionDirty=!1),S||(S=hi()),Fl(S,this.relativeTarget)),b&&(this.animationValues=u,PGe(u,c,this.latestValues,k,w,x)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=k},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(a){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(jh(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=ti.update(()=>{K2.hasAnimatedSinceResize=!0,this.currentAnimation=AGe(0,eV,{...a,onUpdate:o=>{this.mixTargetDelta(o),a.onUpdate&&a.onUpdate(o)},onStop:()=>{},onComplete:()=>{a.onComplete&&a.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const a=this.getStack();a&&a.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(eV),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const a=this.getLead();let{targetWithTransforms:o,target:l,layout:c,latestValues:u}=a;if(!(!o||!l||!c)){if(this!==a&&this.layout&&c&&iae(this.options.animationType,this.layout.layoutBox,c.layoutBox)){l=this.target||hi();const d=to(this.layout.layoutBox.x);l.x.min=a.target.x.min,l.x.max=l.x.min+d;const h=to(this.layout.layoutBox.y);l.y.min=a.target.y.min,l.y.max=l.y.min+h}Fl(o,l),C0(o,u),Nx(this.projectionDeltaWithTransform,this.layoutCorrected,o,u)}}registerSharedNode(a,o){this.sharedNodes.has(a)||this.sharedNodes.set(a,new zGe),this.sharedNodes.get(a).add(o);const c=o.options.initialPromotionConfig;o.promote({transition:c?c.transition:void 0,preserveFollowOpacity:c&&c.shouldPreserveFollowOpacity?c.shouldPreserveFollowOpacity(o):void 0})}isLead(){const a=this.getStack();return a?a.lead===this:!0}getLead(){var o;const{layoutId:a}=this.options;return a?((o=this.getStack())==null?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:a}=this.options;return a?(o=this.getStack())==null?void 0:o.prevLead:void 0}getStack(){const{layoutId:a}=this.options;if(a)return this.root.sharedNodes.get(a)}promote({needsReset:a,transition:o,preserveFollowOpacity:l}={}){const c=this.getStack();c&&c.promote(this,l),a&&(this.projectionDelta=void 0,this.needsReset=!0),o&&this.setOptions({transition:o})}relegate(){const a=this.getStack();return a?a.relegate(this):!1}resetSkewAndRotation(){const{visualElement:a}=this.options;if(!a)return;let o=!1;const{latestValues:l}=a;if((l.z||l.rotate||l.rotateX||l.rotateY||l.rotateZ||l.skewX||l.skewY)&&(o=!0),!o)return;const c={};l.z&&JI("z",a,c,this.animationValues);for(let u=0;u<XI.length;u++)JI(`rotate${XI[u]}`,a,c,this.animationValues),JI(`skew${XI[u]}`,a,c,this.animationValues);a.render();for(const u in c)a.setStaticValue(u,c[u]),this.animationValues&&(this.animationValues[u]=c[u]);a.scheduleRender()}getProjectionStyles(a){if(!this.instance||this.isSVG)return;if(!this.isVisible)return qGe;const o={visibility:""},l=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,o.opacity="",o.pointerEvents=H2(a==null?void 0:a.pointerEvents)||"",o.transform=l?l(this.latestValues,""):"none",o;const c=this.getLead();if(!this.projectionDelta||!this.layout||!c.target){const m={};return this.options.layoutId&&(m.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,m.pointerEvents=H2(a==null?void 0:a.pointerEvents)||""),this.hasProjected&&!Gp(this.latestValues)&&(m.transform=l?l({},""):"none",this.hasProjected=!1),m}const u=c.animationValues||c.latestValues;this.applyTransformsToTarget(),o.transform=UGe(this.projectionDeltaWithTransform,this.treeScale,u),l&&(o.transform=l(u,o.transform));const{x:d,y:h}=this.projectionDelta;o.transformOrigin=`${d.origin*100}% ${h.origin*100}% 0`,c.animationValues?o.opacity=c===this?u.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:u.opacityExit:o.opacity=c===this?u.opacity!==void 0?u.opacity:"":u.opacityExit!==void 0?u.opacityExit:0;for(const m in Vw){if(u[m]===void 0)continue;const{correct:y,applyTo:b,isCSSVariable:v}=Vw[m],x=o.transform==="none"?u[m]:y(u[m],c);if(b){const w=b.length;for(let S=0;S<w;S++)o[b[S]]=x}else v?this.options.visualElement.renderState.vars[m]=x:o[m]=x}return this.options.layoutId&&(o.pointerEvents=c===this?H2(a==null?void 0:a.pointerEvents)||"":"none"),o}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(a=>{var o;return(o=a.currentAnimation)==null?void 0:o.stop()}),this.root.nodes.forEach(tV),this.root.sharedNodes.clear()}}}function WGe(e){e.updateLayout()}function HGe(e){var n;const t=((n=e.resumeFrom)==null?void 0:n.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&t&&e.hasListeners("didUpdate")){const{layoutBox:r,measuredBox:s}=e.layout,{animationType:i}=e.options,a=t.source!==e.layout.source;i==="size"?Bl(d=>{const h=a?t.measuredBox[d]:t.layoutBox[d],m=to(h);h.min=r[d].min,h.max=h.min+m}):iae(i,t.layoutBox,r)&&Bl(d=>{const h=a?t.measuredBox[d]:t.layoutBox[d],m=to(r[d]);h.max=h.min+m,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[d].max=e.relativeTarget[d].min+m)});const o=_0();Nx(o,r,t.layoutBox);const l=_0();a?Nx(l,e.applyTransform(s,!0),t.measuredBox):Nx(l,r,t.layoutBox);const c=!tae(o);let u=!1;if(!e.resumeFrom){const d=e.getClosestProjectingParent();if(d&&!d.resumeFrom){const{snapshot:h,layout:m}=d;if(h&&m){const y=hi();Mx(y,t.layoutBox,h.layoutBox);const b=hi();Mx(b,r,m.layoutBox),nae(y,b)||(u=!0),d.options.layoutRoot&&(e.relativeTarget=b,e.relativeTargetOrigin=y,e.relativeParent=d)}}}e.notifyListeners("didUpdate",{layout:r,snapshot:t,delta:l,layoutDelta:o,hasLayoutChanged:c,hasRelativeLayoutChanged:u})}else if(e.isLead()){const{onExitComplete:r}=e.options;r&&r()}e.options.transition=void 0}function GGe(e){e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function KGe(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function YGe(e){e.clearSnapshot()}function tV(e){e.clearMeasurements()}function ZGe(e){e.isLayoutDirty=!1}function XGe(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function nV(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function JGe(e){e.resolveTargetDelta()}function QGe(e){e.calcProjection()}function eKe(e){e.resetSkewAndRotation()}function tKe(e){e.removeLeadSnapshot()}function rV(e,t,n){e.translate=Qs(t.translate,0,n),e.scale=Qs(t.scale,1,n),e.origin=t.origin,e.originPoint=t.originPoint}function sV(e,t,n,r){e.min=Qs(t.min,n.min,r),e.max=Qs(t.max,n.max,r)}function nKe(e,t,n,r){sV(e.x,t.x,n.x,r),sV(e.y,t.y,n.y,r)}function rKe(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const sKe={duration:.45,ease:[.4,0,.1,1]},iV=e=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),aV=iV("applewebkit/")&&!iV("chrome/")?Math.round:Gl;function oV(e){e.min=aV(e.min),e.max=aV(e.max)}function iKe(e){oV(e.x),oV(e.y)}function iae(e,t,n){return e==="position"||e==="preserve-aspect"&&!aGe(Jq(t),Jq(n),.2)}function aKe(e){var t;return e!==e.root&&((t=e.scroll)==null?void 0:t.wasRoot)}const oKe=sae({attachResizeListener:(e,t)=>Zw(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),QI={current:void 0},aae=sae({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!QI.current){const e=new oKe({});e.mount(window),e.setOptions({layoutScroll:!0}),QI.current=e}return QI.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),lKe={pan:{Feature:CGe},drag:{Feature:SGe,ProjectionNode:aae,MeasureLayout:Jie}};function cKe(e,t,n){if(e instanceof EventTarget)return[e];if(typeof e=="string"){let r=document;const s=(n==null?void 0:n[e])??r.querySelectorAll(e);return s?Array.from(s):[]}return Array.from(e)}function oae(e,t){const n=cKe(e),r=new AbortController,s={passive:!0,...t,signal:r.signal};return[n,s,()=>r.abort()]}function lV(e){return!(e.pointerType==="touch"||Xie())}function uKe(e,t,n={}){const[r,s,i]=oae(e,n),a=o=>{if(!lV(o))return;const{target:l}=o,c=t(l,o);if(typeof c!="function"||!l)return;const u=d=>{lV(d)&&(c(d),l.removeEventListener("pointerleave",u))};l.addEventListener("pointerleave",u,s)};return r.forEach(o=>{o.addEventListener("pointerenter",a,s)}),i}function cV(e,t,n){const{props:r}=e;e.animationState&&r.whileHover&&e.animationState.setActive("whileHover",n==="Start");const s="onHover"+n,i=r[s];i&&ti.postRender(()=>i(t,t_(t)))}class dKe extends Qh{mount(){const{current:t}=this.node;t&&(this.unmount=uKe(t,(n,r)=>(cV(this.node,r,"Start"),s=>cV(this.node,s,"End"))))}unmount(){}}class fKe extends Qh{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Q1(Zw(this.node.current,"focus",()=>this.onFocus()),Zw(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}const lae=(e,t)=>t?e===t?!0:lae(e,t.parentElement):!1,hKe=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function pKe(e){return hKe.has(e.tagName)||e.tabIndex!==-1}const ix=new WeakSet;function uV(e){return t=>{t.key==="Enter"&&e(t)}}function e3(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}const mKe=(e,t)=>{const n=e.currentTarget;if(!n)return;const r=uV(()=>{if(ix.has(n))return;e3(n,"down");const s=uV(()=>{e3(n,"up")}),i=()=>e3(n,"cancel");n.addEventListener("keyup",s,t),n.addEventListener("blur",i,t)});n.addEventListener("keydown",r,t),n.addEventListener("blur",()=>n.removeEventListener("keydown",r),t)};function dV(e){return g5(e)&&!Xie()}function gKe(e,t,n={}){const[r,s,i]=oae(e,n),a=o=>{const l=o.currentTarget;if(!dV(o)||ix.has(l))return;ix.add(l);const c=t(l,o),u=(m,y)=>{window.removeEventListener("pointerup",d),window.removeEventListener("pointercancel",h),!(!dV(m)||!ix.has(l))&&(ix.delete(l),typeof c=="function"&&c(m,{success:y}))},d=m=>{u(m,l===window||l===document||n.useGlobalTarget||lae(l,m.target))},h=m=>{u(m,!1)};window.addEventListener("pointerup",d,s),window.addEventListener("pointercancel",h,s)};return r.forEach(o=>{(n.useGlobalTarget?window:o).addEventListener("pointerdown",a,s),o instanceof HTMLElement&&(o.addEventListener("focus",c=>mKe(c,s)),!pKe(o)&&!o.hasAttribute("tabindex")&&(o.tabIndex=0))}),i}function fV(e,t,n){const{props:r}=e;if(e.current instanceof HTMLButtonElement&&e.current.disabled)return;e.animationState&&r.whileTap&&e.animationState.setActive("whileTap",n==="Start");const s="onTap"+(n==="End"?"":n),i=r[s];i&&ti.postRender(()=>i(t,t_(t)))}class yKe extends Qh{mount(){const{current:t}=this.node;t&&(this.unmount=gKe(t,(n,r)=>(fV(this.node,r,"Start"),(s,{success:i})=>fV(this.node,s,i?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const Q4=new WeakMap,t3=new WeakMap,bKe=e=>{const t=Q4.get(e.target);t&&t(e)},vKe=e=>{e.forEach(bKe)};function xKe({root:e,...t}){const n=e||document;t3.has(n)||t3.set(n,{});const r=t3.get(n),s=JSON.stringify(t);return r[s]||(r[s]=new IntersectionObserver(vKe,{root:e,...t})),r[s]}function wKe(e,t,n){const r=xKe(t);return Q4.set(e,n),r.observe(e),()=>{Q4.delete(e),r.unobserve(e)}}const _Ke={some:0,all:1};class SKe extends Qh{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:n,margin:r,amount:s="some",once:i}=t,a={root:n?n.current:void 0,rootMargin:r,threshold:typeof s=="number"?s:_Ke[s]},o=l=>{const{isIntersecting:c}=l;if(this.isInView===c||(this.isInView=c,i&&!c&&this.hasEnteredView))return;c&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",c);const{onViewportEnter:u,onViewportLeave:d}=this.node.getProps(),h=c?u:d;h&&h(l)};return wKe(this.node.current,a,o)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:n}=this.node;["amount","margin","root"].some(CKe(t,n))&&this.startObserver()}unmount(){}}function CKe({viewport:e={}},{viewport:t={}}={}){return n=>e[n]!==t[n]}const kKe={inView:{Feature:SKe},tap:{Feature:yKe},focus:{Feature:fKe},hover:{Feature:dKe}},EKe={layout:{ProjectionNode:aae,MeasureLayout:Jie}},eP={current:null},cae={current:!1};function TKe(){if(cae.current=!0,!!$6)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>eP.current=e.matches;e.addListener(t),t()}else eP.current=!1}const AKe=new WeakMap;function RKe(e,t,n){for(const r in t){const s=t[r],i=n[r];if(Oa(s))e.addValue(r,s);else if(Oa(i))e.addValue(r,Gw(s,{owner:e}));else if(i!==s)if(e.hasValue(r)){const a=e.getValue(r);a.liveStyle===!0?a.jump(s):a.hasAnimated||a.set(s)}else{const a=e.getStaticValue(r);e.addValue(r,Gw(a!==void 0?a:s,{owner:e}))}}for(const r in n)t[r]===void 0&&e.removeValue(r);return t}const uae=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e),dae=e=>/^0[^.\s]+$/u.test(e),NKe={test:e=>e==="auto",parse:e=>e},fae=e=>t=>t.test(e),hae=[fb,ir,ku,Jf,$Ve,BVe,NKe],hV=e=>hae.find(fae(e)),MKe=[...hae,Ma,Ph],IKe=e=>MKe.find(fae(e)),jKe=new Set(["brightness","contrast","saturate","opacity"]);function PKe(e){const[t,n]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[r]=n.match(i5)||[];if(!r)return e;const s=n.replace(r,"");let i=jKe.has(t)?1:0;return r!==n&&(i*=100),t+"("+i+s+")"}const OKe=/\b([a-z-]*)\(.*?\)/gu,tP={...Ph,getAnimatableNone:e=>{const t=e.match(OKe);return t?t.map(PKe).join(" "):e}},DKe={...Y6,color:Ma,backgroundColor:Ma,outlineColor:Ma,fill:Ma,stroke:Ma,borderColor:Ma,borderTopColor:Ma,borderRightColor:Ma,borderBottomColor:Ma,borderLeftColor:Ma,filter:tP,WebkitFilter:tP},pae=e=>DKe[e];function mae(e,t){let n=pae(e);return n!==tP&&(n=Ph),n.getAnimatableNone?n.getAnimatableNone(t):void 0}const pV=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class FKe{scrapeMotionValuesFromProps(t,n,r){return{}}constructor({parent:t,props:n,presenceContext:r,reducedMotionConfig:s,blockInitialAnimation:i,visualState:a},o={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=h5,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const h=Eo.now();this.renderScheduledAt<h&&(this.renderScheduledAt=h,ti.render(this.render,!1,!0))};const{latestValues:l,renderState:c}=a;this.latestValues=l,this.baseTarget={...l},this.initialValues=n.initial?{...l}:{},this.renderState=c,this.parent=t,this.props=n,this.presenceContext=r,this.depth=t?t.depth+1:0,this.reducedMotionConfig=s,this.options=o,this.blockInitialAnimation=!!i,this.isControllingVariants=HT(n),this.isVariantNode=Zse(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:u,...d}=this.scrapeMotionValuesFromProps(n,{},this);for(const h in d){const m=d[h];l[h]!==void 0&&Oa(m)&&m.set(l[h],!1)}}mount(t){this.current=t,AKe.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((n,r)=>this.bindToMotionValue(r,n)),cae.current||TKe(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:eP.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),jh(this.notifyUpdate),jh(this.render),this.valueSubscriptions.forEach(t=>t()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const t in this.events)this.events[t].clear();for(const t in this.features){const n=this.features[t];n&&(n.unmount(),n.isMounted=!1)}this.current=null}bindToMotionValue(t,n){this.valueSubscriptions.has(t)&&this.valueSubscriptions.get(t)();const r=db.has(t);r&&this.onBindTransform&&this.onBindTransform();const s=n.on("change",o=>{this.latestValues[t]=o,this.props.onUpdate&&ti.preRender(this.notifyUpdate),r&&this.projection&&(this.projection.isTransformDirty=!0)}),i=n.on("renderRequest",this.scheduleRender);let a;window.MotionCheckAppearSync&&(a=window.MotionCheckAppearSync(this,t,n)),this.valueSubscriptions.set(t,()=>{s(),i(),a&&a(),n.owner&&n.stop()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}updateFeatures(){let t="animation";for(t in Ry){const n=Ry[t];if(!n)continue;const{isEnabled:r,Feature:s}=n;if(!this.features[t]&&s&&r(this.props)&&(this.features[t]=new s(this)),this.features[t]){const i=this.features[t];i.isMounted?i.update():(i.mount(),i.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):hi()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,n){this.latestValues[t]=n}update(t,n){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let r=0;r<pV.length;r++){const s=pV[r];this.propEventSubscriptions[s]&&(this.propEventSubscriptions[s](),delete this.propEventSubscriptions[s]);const i="on"+s,a=t[i];a&&(this.propEventSubscriptions[s]=this.on(s,a))}this.prevMotionValues=RKe(this,this.scrapeMotionValuesFromProps(t,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(t){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(t),()=>n.variantChildren.delete(t)}addValue(t,n){const r=this.values.get(t);n!==r&&(r&&this.removeValue(t),this.bindToMotionValue(t,n),this.values.set(t,n),this.latestValues[t]=n.get())}removeValue(t){this.values.delete(t);const n=this.valueSubscriptions.get(t);n&&(n(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,n){if(this.props.values&&this.props.values[t])return this.props.values[t];let r=this.values.get(t);return r===void 0&&n!==void 0&&(r=Gw(n===null?void 0:n,{owner:this}),this.addValue(t,r)),r}readValue(t,n){let r=this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:this.getBaseTargetFromProps(this.props,t)??this.readValueFromInstance(this.current,t,this.options);return r!=null&&(typeof r=="string"&&(uae(r)||dae(r))?r=parseFloat(r):!IKe(r)&&Ph.test(n)&&(r=mae(t,n)),this.setBaseTarget(t,Oa(r)?r.get():r)),Oa(r)?r.get():r}setBaseTarget(t,n){this.baseTarget[t]=n}getBaseTarget(t){var i;const{initial:n}=this.props;let r;if(typeof n=="string"||typeof n=="object"){const a=Q6(this.props,n,(i=this.presenceContext)==null?void 0:i.custom);a&&(r=a[t])}if(n&&r!==void 0)return r;const s=this.getBaseTargetFromProps(this.props,t);return s!==void 0&&!Oa(s)?s:this.initialValues[t]!==void 0&&r===void 0?void 0:this.baseTarget[t]}on(t,n){return this.events[t]||(this.events[t]=new r5),this.events[t].add(n)}notify(t,...n){this.events[t]&&this.events[t].notify(...n)}}const LKe=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function BKe(e){const t=LKe.exec(e);if(!t)return[,];const[,n,r,s]=t;return[`--${n??r}`,s]}function gae(e,t,n=1){const[r,s]=BKe(e);if(!r)return;const i=window.getComputedStyle(t).getPropertyValue(r);if(i){const a=i.trim();return uae(a)?parseFloat(a):a}return K6(s)?gae(s,t,n+1):s}function $Ke(e){return typeof e=="number"?e===0:e!==null?e==="none"||e==="0"||dae(e):!0}const zKe=new Set(["auto","none","0"]);function UKe(e,t,n){let r=0,s;for(;r<e.length&&!s;){const i=e[r];typeof i=="string"&&!zKe.has(i)&&Kw(i).values.length&&(s=e[r]),r++}if(s&&n)for(const i of t)e[i]=mae(n,s)}class qKe extends h5{constructor(t,n,r,s,i){super(t,n,r,s,i,!0)}readKeyframes(){const{unresolvedKeyframes:t,element:n,name:r}=this;if(!n||!n.current)return;super.readKeyframes();for(let l=0;l<t.length;l++){let c=t[l];if(typeof c=="string"&&(c=c.trim(),K6(c))){const u=gae(c,n.current);u!==void 0&&(t[l]=u),l===t.length-1&&(this.finalKeyframe=c)}}if(this.resolveNoneKeyframes(),!Lie.has(r)||t.length!==2)return;const[s,i]=t,a=hV(s),o=hV(i);if(a!==o)if(bq(a)&&bq(o))for(let l=0;l<t.length;l++){const c=t[l];typeof c=="string"&&(t[l]=parseFloat(c))}else fm[r]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:t,name:n}=this,r=[];for(let s=0;s<t.length;s++)(t[s]===null||$Ke(t[s]))&&r.push(s);r.length&&UKe(t,r,n)}measureInitialState(){const{element:t,unresolvedKeyframes:n,name:r}=this;if(!t||!t.current)return;r==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=fm[r](t.measureViewportBox(),window.getComputedStyle(t.current)),n[0]=this.measuredOrigin;const s=n[n.length-1];s!==void 0&&t.getValue(r,s).jump(s,!1)}measureEndState(){var o;const{element:t,name:n,unresolvedKeyframes:r}=this;if(!t||!t.current)return;const s=t.getValue(n);s&&s.jump(this.measuredOrigin,!1);const i=r.length-1,a=r[i];r[i]=fm[n](t.measureViewportBox(),window.getComputedStyle(t.current)),a!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=a),(o=this.removedTransforms)!=null&&o.length&&this.removedTransforms.forEach(([l,c])=>{t.getValue(l).set(c)}),this.resolveNoneKeyframes()}}class yae extends FKe{constructor(){super(...arguments),this.KeyframeResolver=qKe}sortInstanceNodePosition(t,n){return t.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(t,n){return t.style?t.style[n]:void 0}removeValueFromRenderState(t,{vars:n,style:r}){delete n[t],delete r[t]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;Oa(t)&&(this.childSubscription=t.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}}function bae(e,{style:t,vars:n},r,s){Object.assign(e.style,t,s&&s.getProjectionStyles(r));for(const i in n)e.style.setProperty(i,n[i])}function VKe(e){return window.getComputedStyle(e)}class WKe extends yae{constructor(){super(...arguments),this.type="html",this.renderInstance=bae}readValueFromInstance(t,n){if(db.has(n))return mHe(t,n);{const r=VKe(t),s=(G6(n)?r.getPropertyValue(n):r[n])||0;return typeof s=="string"?s.trim():s}}measureInstanceViewportBox(t,{transformPagePoint:n}){return Gie(t,n)}build(t,n,r){Z6(t,n,r.transformTemplate)}scrapeMotionValuesFromProps(t,n,r){return e5(t,n,r)}}const vae=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function HKe(e,t,n,r){bae(e,t,void 0,r);for(const s in t.attrs)e.setAttribute(vae.has(s)?s:V6(s),t.attrs[s])}class GKe extends yae{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=hi}getBaseTargetFromProps(t,n){return t[n]}readValueFromInstance(t,n){if(db.has(n)){const r=pae(n);return r&&r.default||0}return n=vae.has(n)?n:V6(n),t.getAttribute(n)}scrapeMotionValuesFromProps(t,n,r){return lie(t,n,r)}build(t,n,r){sie(t,n,this.isSVGTag,r.transformTemplate,r.style)}renderInstance(t,n,r,s){HKe(t,n,r,s)}mount(t){this.isSVGTag=aie(t.tagName),super.mount(t)}}const KKe=(e,t)=>J6(e)?new GKe(t):new WKe(t,{allowProjection:e!==T.Fragment}),YKe=sWe({...JHe,...kKe,...lKe,...EKe},KKe),du=CVe(YKe),P0=new WeakMap,Y2=new WeakMap,Xk={current:[]};let n3=!1,Ix=0;const ax=new Set,i2=new Map;function xae(e){const t=Array.from(e).sort((n,r)=>n instanceof $d&&n.options.deps.includes(r)?1:r instanceof $d&&r.options.deps.includes(n)?-1:0);for(const n of t){if(Xk.current.includes(n))continue;Xk.current.push(n),n.recompute();const r=Y2.get(n);if(r)for(const s of r){const i=P0.get(s);i&&xae(i)}}}function ZKe(e){e.listeners.forEach(t=>t({prevVal:e.prevState,currentVal:e.state}))}function XKe(e){e.listeners.forEach(t=>t({prevVal:e.prevState,currentVal:e.state}))}function wae(e){if(Ix>0&&!i2.has(e)&&i2.set(e,e.prevState),ax.add(e),!(Ix>0)&&!n3)try{for(n3=!0;ax.size>0;){const t=Array.from(ax);ax.clear();for(const n of t){const r=i2.get(n)??n.prevState;n.prevState=r,ZKe(n)}for(const n of t){const r=P0.get(n);r&&(Xk.current.push(n),xae(r))}for(const n of t){const r=P0.get(n);if(r)for(const s of r)XKe(s)}}}finally{n3=!1,Xk.current=[],i2.clear()}}function iu(e){Ix++;try{e()}finally{if(Ix--,Ix===0){const t=Array.from(ax)[0];t&&wae(t)}}}function JKe(e){return typeof e=="function"}class nP{constructor(t,n){this.listeners=new Set,this.subscribe=r=>{var s,i;this.listeners.add(r);const a=(i=(s=this.options)==null?void 0:s.onSubscribe)==null?void 0:i.call(s,r,this);return()=>{this.listeners.delete(r),a==null||a()}},this.prevState=t,this.state=t,this.options=n}setState(t){var n,r,s;this.prevState=this.state,(n=this.options)!=null&&n.updateFn?this.state=this.options.updateFn(this.prevState)(t):JKe(t)?this.state=t(this.prevState):this.state=t,(s=(r=this.options)==null?void 0:r.onUpdate)==null||s.call(r),wae(this)}}class $d{constructor(t){this.listeners=new Set,this._subscriptions=[],this.lastSeenDepValues=[],this.getDepVals=()=>{const n=[],r=[];for(const s of this.options.deps)n.push(s.prevState),r.push(s.state);return this.lastSeenDepValues=r,{prevDepVals:n,currDepVals:r,prevVal:this.prevState??void 0}},this.recompute=()=>{var n,r;this.prevState=this.state;const{prevDepVals:s,currDepVals:i,prevVal:a}=this.getDepVals();this.state=this.options.fn({prevDepVals:s,currDepVals:i,prevVal:a}),(r=(n=this.options).onUpdate)==null||r.call(n)},this.checkIfRecalculationNeededDeeply=()=>{for(const i of this.options.deps)i instanceof $d&&i.checkIfRecalculationNeededDeeply();let n=!1;const r=this.lastSeenDepValues,{currDepVals:s}=this.getDepVals();for(let i=0;i<s.length;i++)if(s[i]!==r[i]){n=!0;break}n&&this.recompute()},this.mount=()=>(this.registerOnGraph(),this.checkIfRecalculationNeededDeeply(),()=>{this.unregisterFromGraph();for(const n of this._subscriptions)n()}),this.subscribe=n=>{var r,s;this.listeners.add(n);const i=(s=(r=this.options).onSubscribe)==null?void 0:s.call(r,n,this);return()=>{this.listeners.delete(n),i==null||i()}},this.options=t,this.state=t.fn({prevDepVals:void 0,prevVal:void 0,currDepVals:this.getDepVals().currDepVals})}registerOnGraph(t=this.options.deps){for(const n of t)if(n instanceof $d)n.registerOnGraph(),this.registerOnGraph(n.options.deps);else if(n instanceof nP){let r=P0.get(n);r||(r=new Set,P0.set(n,r)),r.add(this);let s=Y2.get(this);s||(s=new Set,Y2.set(this,s)),s.add(n)}}unregisterFromGraph(t=this.options.deps){for(const n of t)if(n instanceof $d)this.unregisterFromGraph(n.options.deps);else if(n instanceof nP){const r=P0.get(n);r&&r.delete(this);const s=Y2.get(this);s&&s.delete(n)}}}function GT(e,t){return typeof e=="function"?e(t):e}function ox(e,t){return y5(t).reduce((r,s)=>{if(r===null)return null;if(typeof r<"u")return r[s]},e)}function a2(e,t,n){const r=y5(t);function s(i){if(!r.length)return GT(n,i);const a=r.shift();if(typeof a=="string"||typeof a=="number"&&!Array.isArray(i))return typeof i=="object"?(i===null&&(i={}),{...i,[a]:s(i[a])}):{[a]:s()};if(Array.isArray(i)&&typeof a=="number"){const o=i.slice(0,a);return[...o.length?o:new Array(a),s(i[a]),...i.slice(a+1)]}return[...new Array(a),s()]}return s(e)}function QKe(e,t){const n=y5(t);function r(s){if(!s)return;if(n.length===1){const a=n[0];if(Array.isArray(s)&&typeof a=="number")return s.filter((c,u)=>u!==a);const{[a]:o,...l}=s;return l}const i=n.shift();if(typeof i=="string"&&typeof s=="object")return{...s,[i]:r(s[i])};if(typeof i=="number"&&Array.isArray(s)){if(i>=s.length)return s;const a=s.slice(0,i);return[...a.length?a:new Array(i),r(s[i]),...s.slice(i+1)]}throw new Error("It seems we have created an infinite loop in deleteBy. ")}return r(e)}const eYe=/^(\d+)$/gm,tYe=/\.(\d+)(?=\.)/gm,nYe=/^(\d+)\./gm,rYe=/\.(\d+$)/gm,sYe=/\.{2,}/gm,rP="__int__",o2=`${rP}$1`;function y5(e){if(Array.isArray(e))return[...e];if(typeof e!="string")throw new Error("Path must be a string.");return e.replace(/(^\[)|]/gm,"").replace(/\[/g,".").replace(eYe,o2).replace(tYe,`.${o2}.`).replace(nYe,`${o2}.`).replace(rYe,`.${o2}`).replace(sYe,".").split(".").map(t=>t.indexOf(rP)===0?parseInt(t.substring(rP.length),10):t)}function iYe(e){return!(Array.isArray(e)&&e.length===0)}function sP(e,t){const{asyncDebounceMs:n}=t,{onChangeAsync:r,onBlurAsync:s,onSubmitAsync:i,onBlurAsyncDebounceMs:a,onChangeAsyncDebounceMs:o}=t.validators||{},l=n??0,c={cause:"change",validate:r,debounceMs:o??l},u={cause:"blur",validate:s,debounceMs:a??l},d={cause:"submit",validate:i,debounceMs:0},h=m=>({...m,debounceMs:0});switch(e){case"submit":return[h(c),h(u),d];case"blur":return[u];case"change":return[c];case"server":default:return[]}}function iP(e,t){const{onChange:n,onBlur:r,onSubmit:s,onMount:i}=t.validators||{},a={cause:"change",validate:n},o={cause:"blur",validate:r},l={cause:"submit",validate:s},c={cause:"mount",validate:i},u={cause:"server",validate:()=>{}};switch(e){case"mount":return[c];case"submit":return[a,o,l,u];case"server":return[u];case"blur":return[o,u];case"change":default:return[a,u]}}const aP=e=>!!e&&typeof e=="object"&&"fields"in e;function d0(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[s,i]of e)if(!t.has(s)||!Object.is(i,t.get(s)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const s of e)if(!t.has(s))return!1;return!0}const n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(const s of n)if(!r.includes(s)||!d0(e[s],t[s]))return!1;return!0}const mV=({newFormValidatorError:e,isPreviousErrorFromFormValidator:t,previousErrorValue:n})=>e?{newErrorValue:e,newSource:"form"}:t?{newErrorValue:void 0,newSource:void 0}:n?{newErrorValue:n,newSource:"field"}:{newErrorValue:void 0,newSource:void 0},gV=({formLevelError:e,fieldLevelError:t})=>t?{newErrorValue:t,newSource:"field"}:e?{newErrorValue:e,newSource:"form"}:{newErrorValue:void 0,newSource:void 0};function aYe(e){const t=new Map;for(const n of e){const r=[...n.path??[]].map(s=>{const i=typeof s=="object"?s.key:s;return typeof i=="number"?`[${i}]`:i}).join(".").replace(/\.\[/g,"[");t.set(r,(t.get(r)??[]).concat(n))}return Object.fromEntries(t)}const yV=e=>{const t=aYe(e);return{form:t,fields:t}},O0={validate({value:e,validationSource:t},n){const r=n["~standard"].validate(e);if(r instanceof Promise)throw new Error("async function passed to sync validator");if(r.issues)return t==="field"?r.issues:yV(r.issues)},async validateAsync({value:e,validationSource:t},n){const r=await n["~standard"].validate(e);if(r.issues)return t==="field"?r.issues:yV(r.issues)}},_ae=e=>!!e&&"~standard"in e,Jk={isValidating:!1,isTouched:!1,isBlurred:!1,isDirty:!1,isPristine:!0,isValid:!0,isDefaultValue:!0,errors:[],errorMap:{},errorSourceMap:{}};function l2(e){function t(d,h,m,y){const b=r(d,h,m,y);({insert:()=>o(b,d,h),remove:()=>l(b),swap:()=>y!==void 0&&u(b,d,h,y),move:()=>y!==void 0&&c(b,d,h,y)})[m]()}function n(d,h){return`${d}[${h}]`}function r(d,h,m,y){const b=[n(d,h)];if(m==="swap")b.push(n(d,y));else if(m==="move"){const[v,x]=[Math.min(h,y),Math.max(h,y)];for(let w=v;w<=x;w++)b.push(n(d,w))}else{const v=e.getFieldValue(d),x=Array.isArray(v)?v.length:0;for(let w=h+1;w<x;w++)b.push(n(d,w))}return Object.keys(e.fieldInfo).filter(v=>b.some(x=>v.startsWith(x)))}function s(d,h){return d.replace(/\[(\d+)\]/,(m,y)=>{const b=parseInt(y,10);return`[${h==="up"?b+1:Math.max(0,b-1)}]`})}function i(d,h){(h==="up"?d:[...d].reverse()).forEach(y=>{const b=s(y.toString(),h),v=e.getFieldMeta(b);v?e.setFieldMeta(y,v):e.setFieldMeta(y,a())})}const a=()=>Jk,o=(d,h,m)=>{i(d,"down"),d.forEach(y=>{y.toString().startsWith(n(h,m))&&e.setFieldMeta(y,a())})},l=d=>{i(d,"up")},c=(d,h,m,y)=>{const b=new Map(Object.keys(e.fieldInfo).filter(v=>v.startsWith(n(h,m))).map(v=>[v,e.getFieldMeta(v)]));i(d,m<y?"up":"down"),Object.keys(e.fieldInfo).filter(v=>v.startsWith(n(h,y))).forEach(v=>{const x=v.replace(n(h,y),n(h,m)),w=b.get(x);w&&e.setFieldMeta(v,w)})},u=(d,h,m,y)=>{d.forEach(b=>{if(!b.toString().startsWith(n(h,m)))return;const v=b.toString().replace(n(h,m),n(h,y)),[x,w]=[e.getFieldMeta(b),e.getFieldMeta(v)];x&&e.setFieldMeta(v,x),w&&e.setFieldMeta(b,w)})};return{handleArrayFieldMetaShift:t}}function r3(e){return{values:e.values??{},errorMap:e.errorMap??{},fieldMetaBase:e.fieldMetaBase??{},isSubmitted:e.isSubmitted??!1,isSubmitting:e.isSubmitting??!1,isValidating:e.isValidating??!1,submissionAttempts:e.submissionAttempts??0,isSubmitSuccessful:e.isSubmitSuccessful??!1,validationMetaMap:e.validationMetaMap??{onChange:void 0,onBlur:void 0,onSubmit:void 0,onMount:void 0,onServer:void 0}}}class oYe{constructor(t){var n;this.options={},this.fieldInfo={},this.prevTransformArray=[],this.mount=()=>{var r,s;const i=this.fieldMetaDerived.mount(),a=this.store.mount(),o=()=>{i(),a()};(s=(r=this.options.listeners)==null?void 0:r.onMount)==null||s.call(r,{formApi:this});const{onMount:l}=this.options.validators||{};return l&&this.validateSync("mount"),o},this.update=r=>{var s,i;if(!r)return;const a=this.options;this.options=r;const o=!!((i=(s=r.transform)==null?void 0:s.deps)!=null&&i.some((u,d)=>u!==this.prevTransformArray[d])),l=r.defaultValues&&!d0(r.defaultValues,a.defaultValues)&&!this.state.isTouched,c=!d0(r.defaultState,a.defaultState)&&!this.state.isTouched;!l&&!c&&!o||iu(()=>{this.baseStore.setState(()=>r3(Object.assign({},this.state,c?r.defaultState:{},l?{values:r.defaultValues}:{},o?{_force_re_eval:!this.state._force_re_eval}:{})))})},this.reset=(r,s)=>{const{fieldMeta:i}=this.state,a=this.resetFieldMeta(i);r&&!(s!=null&&s.keepDefaultValues)&&(this.options={...this.options,defaultValues:r}),this.baseStore.setState(()=>{var o;return r3({...this.options.defaultState,values:r??this.options.defaultValues??((o=this.options.defaultState)==null?void 0:o.values),fieldMetaBase:a})})},this.validateAllFields=async r=>{const s=[];return iu(()=>{Object.values(this.fieldInfo).forEach(a=>{if(!a.instance)return;const o=a.instance;s.push(Promise.resolve().then(()=>o.validate(r,{skipFormValidation:!0}))),a.instance.state.meta.isTouched||a.instance.setMeta(l=>({...l,isTouched:!0}))})}),(await Promise.all(s)).flat()},this.validateArrayFieldsStartingFrom=async(r,s,i)=>{const a=this.getFieldValue(r),o=Array.isArray(a)?Math.max(a.length-1,0):null,l=[`${r}[${s}]`];for(let h=s+1;h<=(o??0);h++)l.push(`${r}[${h}]`);const c=Object.keys(this.fieldInfo).filter(h=>l.some(m=>h.startsWith(m))),u=[];return iu(()=>{c.forEach(h=>{u.push(Promise.resolve().then(()=>this.validateField(h,i)))})}),(await Promise.all(u)).flat()},this.validateField=(r,s)=>{var i;const a=(i=this.fieldInfo[r])==null?void 0:i.instance;return a?(a.state.meta.isTouched||a.setMeta(o=>({...o,isTouched:!0})),a.validate(s)):[]},this.validateSync=r=>{const s=iP(r,this.options);let i=!1;const a={};return iu(()=>{var o,l;for(const u of s){if(!u.validate)continue;const d=this.runValidator({validate:u.validate,value:{value:this.state.values,formApi:this,validationSource:"form"},type:"validate"}),{formError:h,fieldErrors:m}=Z2(d),y=c2(u.cause);for(const b of Object.keys(this.state.fieldMeta)){const v=this.getFieldMeta(b);if(!v)continue;const{errorMap:x,errorSourceMap:w}=v,S=m==null?void 0:m[b],{newErrorValue:C,newSource:k}=mV({newFormValidatorError:S,isPreviousErrorFromFormValidator:(w==null?void 0:w[y])==="form",previousErrorValue:x==null?void 0:x[y]});k==="form"&&(a[b]={...a[b],[y]:S}),(x==null?void 0:x[y])!==C&&this.setFieldMeta(b,A=>({...A,errorMap:{...A.errorMap,[y]:C},errorSourceMap:{...A.errorSourceMap,[y]:k}}))}((o=this.state.errorMap)==null?void 0:o[y])!==h&&this.baseStore.setState(b=>({...b,errorMap:{...b.errorMap,[y]:h}})),(h||m)&&(i=!0)}const c=c2("submit");(l=this.state.errorMap)!=null&&l[c]&&r!=="submit"&&!i&&this.baseStore.setState(u=>({...u,errorMap:{...u.errorMap,[c]:void 0}}))}),{hasErrored:i,fieldsErrorMap:a}},this.validateAsync=async r=>{const s=sP(r,this.options);this.state.isFormValidating||this.baseStore.setState(c=>({...c,isFormValidating:!0}));const i=[];let a;for(const c of s){if(!c.validate)continue;const u=c2(c.cause),d=this.state.validationMetaMap[u];d==null||d.lastAbortController.abort();const h=new AbortController;this.state.validationMetaMap[u]={lastAbortController:h},i.push(new Promise(async m=>{let y;try{y=await new Promise((w,S)=>{setTimeout(async()=>{if(h.signal.aborted)return w(void 0);try{w(await this.runValidator({validate:c.validate,value:{value:this.state.values,formApi:this,validationSource:"form",signal:h.signal},type:"validateAsync"}))}catch(C){S(C)}},c.debounceMs)})}catch(w){y=w}const{formError:b,fieldErrors:v}=Z2(y);v&&(a=a?{...a,...v}:v);const x=c2(c.cause);for(const w of Object.keys(this.state.fieldMeta)){const S=this.getFieldMeta(w);if(!S)continue;const{errorMap:C,errorSourceMap:k}=S,A=a==null?void 0:a[w],{newErrorValue:R,newSource:N}=mV({newFormValidatorError:A,isPreviousErrorFromFormValidator:(k==null?void 0:k[x])==="form",previousErrorValue:C==null?void 0:C[x]});(C==null?void 0:C[x])!==R&&this.setFieldMeta(w,I=>({...I,errorMap:{...I.errorMap,[x]:R},errorSourceMap:{...I.errorSourceMap,[x]:N}}))}this.baseStore.setState(w=>({...w,errorMap:{...w.errorMap,[x]:b}})),m(a?{fieldErrors:a,errorMapKey:x}:void 0)}))}let o=[];const l={};if(i.length){o=await Promise.all(i);for(const c of o)if(c!=null&&c.fieldErrors){const{errorMapKey:u}=c;for(const[d,h]of Object.entries(c.fieldErrors)){const y={...l[d]||{},[u]:h};l[d]=y}}}return this.baseStore.setState(c=>({...c,isFormValidating:!1})),l},this.validate=r=>{const{hasErrored:s,fieldsErrorMap:i}=this.validateSync(r);return s&&!this.options.asyncAlways?i:this.validateAsync(r)},this.getFieldValue=r=>ox(this.state.values,r),this.getFieldMeta=r=>this.state.fieldMeta[r],this.getFieldInfo=r=>{var s;return(s=this.fieldInfo)[r]||(s[r]={instance:null,validationMetaMap:{onChange:void 0,onBlur:void 0,onSubmit:void 0,onMount:void 0,onServer:void 0}})},this.setFieldMeta=(r,s)=>{this.baseStore.setState(i=>({...i,fieldMetaBase:{...i.fieldMetaBase,[r]:GT(s,i.fieldMetaBase[r])}}))},this.resetFieldMeta=r=>Object.keys(r).reduce((s,i)=>{const a=i;return s[a]=Jk,s},{}),this.setFieldValue=(r,s,i)=>{const a=(i==null?void 0:i.dontUpdateMeta)??!1;iu(()=>{a||this.setFieldMeta(r,o=>({...o,isTouched:!0,isDirty:!0,errorMap:{...o==null?void 0:o.errorMap,onMount:void 0}})),this.baseStore.setState(o=>({...o,values:a2(o.values,r,s)}))})},this.deleteField=r=>{const i=[...Object.keys(this.fieldInfo).filter(a=>{const o=r.toString();return a!==o&&a.startsWith(o)}),r];this.baseStore.setState(a=>{const o={...a};return i.forEach(l=>{o.values=QKe(o.values,l),delete this.fieldInfo[l],delete o.fieldMetaBase[l]}),o})},this.pushFieldValue=(r,s,i)=>{this.setFieldValue(r,a=>[...Array.isArray(a)?a:[],s],i),this.validateField(r,"change")},this.insertFieldValue=async(r,s,i,a)=>{this.setFieldValue(r,o=>[...o.slice(0,s),i,...o.slice(s)],a),await this.validateField(r,"change"),l2(this).handleArrayFieldMetaShift(r,s,"insert"),await this.validateArrayFieldsStartingFrom(r,s,"change")},this.replaceFieldValue=async(r,s,i,a)=>{this.setFieldValue(r,o=>o.map((l,c)=>c===s?i:l),a),await this.validateField(r,"change"),await this.validateArrayFieldsStartingFrom(r,s,"change")},this.removeFieldValue=async(r,s,i)=>{const a=this.getFieldValue(r),o=Array.isArray(a)?Math.max(a.length-1,0):null;if(this.setFieldValue(r,l=>l.filter((c,u)=>u!==s),i),l2(this).handleArrayFieldMetaShift(r,s,"remove"),o!==null){const l=`${r}[${o}]`;this.deleteField(l)}await this.validateField(r,"change"),await this.validateArrayFieldsStartingFrom(r,s,"change")},this.swapFieldValues=(r,s,i,a)=>{this.setFieldValue(r,o=>{const l=o[s],c=o[i];return a2(a2(o,`${s}`,c),`${i}`,l)},a),l2(this).handleArrayFieldMetaShift(r,s,"swap",i),this.validateField(r,"change"),this.validateField(`${r}[${s}]`,"change"),this.validateField(`${r}[${i}]`,"change")},this.moveFieldValues=(r,s,i,a)=>{this.setFieldValue(r,o=>{const l=[...o];return l.splice(i,0,l.splice(s,1)[0]),l},a),l2(this).handleArrayFieldMetaShift(r,s,"move",i),this.validateField(r,"change"),this.validateField(`${r}[${s}]`,"change"),this.validateField(`${r}[${i}]`,"change")},this.clearFieldValues=(r,s)=>{const i=this.getFieldValue(r),a=Array.isArray(i)?Math.max(i.length-1,0):null;if(this.setFieldValue(r,[],s),a!==null)for(let o=0;o<=a;o++){const l=`${r}[${o}]`;this.deleteField(l)}this.validateField(r,"change")},this.resetField=r=>{this.baseStore.setState(s=>({...s,fieldMetaBase:{...s.fieldMetaBase,[r]:Jk},values:this.options.defaultValues?a2(s.values,r,ox(this.options.defaultValues,r)):s.values}))},this.getAllErrors=()=>({form:{errors:this.state.errors,errorMap:this.state.errorMap},fields:Object.entries(this.state.fieldMeta).reduce((r,[s,i])=>(Object.keys(i).length&&i.errors.length&&(r[s]={errors:i.errors,errorMap:i.errorMap}),r),{})}),this.parseValuesWithSchema=r=>O0.validate({value:this.state.values,validationSource:"form"},r),this.parseValuesWithSchemaAsync=r=>O0.validateAsync({value:this.state.values,validationSource:"form"},r),this.baseStore=new nP(r3({...t==null?void 0:t.defaultState,values:(t==null?void 0:t.defaultValues)??((n=t==null?void 0:t.defaultState)==null?void 0:n.values)})),this.fieldMetaDerived=new $d({deps:[this.baseStore],fn:({prevDepVals:r,currDepVals:s,prevVal:i})=>{var a,o,l;const c=i,u=r==null?void 0:r[0],d=s[0];let h=0;const m={};for(const y of Object.keys(d.fieldMetaBase)){const b=d.fieldMetaBase[y],v=u==null?void 0:u.fieldMetaBase[y],x=c==null?void 0:c[y],w=ox(d.values,y);let S=x==null?void 0:x.errors;if(!v||b.errorMap!==v.errorMap){S=Object.values(b.errorMap??{}).filter(N=>N!==void 0);const R=(a=this.getFieldInfo(y))==null?void 0:a.instance;R&&!R.options.disableErrorFlat&&(S=S==null?void 0:S.flat(1))}const C=!iYe(S??[]),k=!b.isDirty,A=d0(w,ox(this.options.defaultValues,y))||d0(w,(l=(o=this.getFieldInfo(y))==null?void 0:o.instance)==null?void 0:l.options.defaultValue);if(x&&x.isPristine===k&&x.isValid===C&&x.isDefaultValue===A&&x.errors===S&&b===v){m[y]=x,h++;continue}m[y]={...b,errors:S,isPristine:k,isValid:C,isDefaultValue:A}}return Object.keys(d.fieldMetaBase).length&&c&&h===Object.keys(d.fieldMetaBase).length?c:m}}),this.store=new $d({deps:[this.baseStore,this.fieldMetaDerived],fn:({prevDepVals:r,currDepVals:s,prevVal:i})=>{var a,o,l,c;const u=i,d=r==null?void 0:r[0],h=s[0],m=s[1],y=Object.values(m).filter(Boolean),b=y.some($=>$.isValidating),v=y.every($=>$.isValid),x=y.some($=>$.isTouched),w=y.some($=>$.isBlurred),S=y.every($=>$.isDefaultValue),C=x&&((a=h.errorMap)==null?void 0:a.onMount),k=y.some($=>$.isDirty),A=!k,R=!!((o=h.errorMap)!=null&&o.onMount||y.some($=>{var ne;return(ne=$==null?void 0:$.errorMap)==null?void 0:ne.onMount})),N=!!b;let I=(u==null?void 0:u.errors)??[];(!d||h.errorMap!==d.errorMap)&&(I=Object.values(h.errorMap).reduce(($,ne)=>ne===void 0?$:ne&&aP(ne)?($.push(ne.form),$):($.push(ne),$),[]));const P=I.length===0,L=v&&P,O=this.options.canSubmitWhenInvalid??!1,V=h.submissionAttempts===0&&!x&&!R||!N&&!h.isSubmitting&&L||O;let D=h.errorMap;if(C&&(I=I.filter($=>$!==h.errorMap.onMount),D=Object.assign(D,{onMount:void 0})),u&&d&&u.errorMap===D&&u.fieldMeta===this.fieldMetaDerived.state&&u.errors===I&&u.isFieldsValidating===b&&u.isFieldsValid===v&&u.isFormValid===P&&u.isValid===L&&u.canSubmit===V&&u.isTouched===x&&u.isBlurred===w&&u.isPristine===A&&u.isDefaultValue===S&&u.isDirty===k&&d0(d,h))return u;let Z={...h,errorMap:D,fieldMeta:this.fieldMetaDerived.state,errors:I,isFieldsValidating:b,isFieldsValid:v,isFormValid:P,isValid:L,canSubmit:V,isTouched:x,isBlurred:w,isPristine:A,isDefaultValue:S,isDirty:k};const U=((l=this.options.transform)==null?void 0:l.deps)??[];if(U.length!==this.prevTransformArray.length||U.some(($,ne)=>$!==this.prevTransformArray[ne])){const $=Object.assign({},this,{state:Z});(c=this.options.transform)==null||c.fn($),Z=$.state,this.prevTransformArray=U}return Z}}),this.handleSubmit=this.handleSubmit.bind(this),this.update(t||{})}get state(){return this.store.state}runValidator(t){return _ae(t.validate)?O0[t.type](t.value,t.validate):t.validate(t.value)}async handleSubmit(t){var n,r,s,i,a,o,l,c;if(this.baseStore.setState(d=>({...d,isSubmitted:!1,submissionAttempts:d.submissionAttempts+1,isSubmitSuccessful:!1})),iu(()=>{Object.values(this.fieldInfo).forEach(d=>{d.instance&&(d.instance.state.meta.isTouched||d.instance.setMeta(h=>({...h,isTouched:!0})))})}),!this.state.canSubmit)return;this.baseStore.setState(d=>({...d,isSubmitting:!0}));const u=()=>{this.baseStore.setState(d=>({...d,isSubmitting:!1}))};if(await this.validateAllFields("submit"),!this.state.isFieldsValid){u(),(r=(n=this.options).onSubmitInvalid)==null||r.call(n,{value:this.state.values,formApi:this});return}if(await this.validate("submit"),!this.state.isValid){u(),(i=(s=this.options).onSubmitInvalid)==null||i.call(s,{value:this.state.values,formApi:this});return}iu(()=>{Object.values(this.fieldInfo).forEach(d=>{var h,m,y;(y=(m=(h=d.instance)==null?void 0:h.options.listeners)==null?void 0:m.onSubmit)==null||y.call(m,{value:d.instance.state.value,fieldApi:d.instance})})}),(o=(a=this.options.listeners)==null?void 0:a.onSubmit)==null||o.call(a,{formApi:this});try{await((c=(l=this.options).onSubmit)==null?void 0:c.call(l,{value:this.state.values,formApi:this,meta:t??this.options.onSubmitMeta})),iu(()=>{this.baseStore.setState(d=>({...d,isSubmitted:!0,isSubmitSuccessful:!0})),u()})}catch(d){throw this.baseStore.setState(h=>({...h,isSubmitSuccessful:!1})),u(),d}}setErrorMap(t){iu(()=>{Object.entries(t).forEach(([n,r])=>{const s=n;if(aP(r)){const{formError:i,fieldErrors:a}=Z2(r);for(const o of Object.keys(this.fieldInfo))this.getFieldMeta(o)&&this.setFieldMeta(o,c=>({...c,errorMap:{...c.errorMap,[s]:a==null?void 0:a[o]},errorSourceMap:{...c.errorSourceMap,[s]:"form"}}));this.baseStore.setState(o=>({...o,errorMap:{...o.errorMap,[s]:i}}))}else this.baseStore.setState(i=>({...i,errorMap:{...i.errorMap,[s]:r}}))})})}}function Z2(e){if(e){if(aP(e)){const t=Z2(e.form).formError,n=e.fields;return{formError:t,fieldErrors:n}}return{formError:e}}return{formError:void 0}}function c2(e){switch(e){case"submit":return"onSubmit";case"blur":return"onBlur";case"mount":return"onMount";case"server":return"onServer";case"change":default:return"onChange"}}class lYe{constructor(t){this.options={},this.mount=()=>{var n,r;const s=this.store.mount();this.options.defaultValue!==void 0&&this.form.setFieldValue(this.name,this.options.defaultValue,{dontUpdateMeta:!0});const i=this.getInfo();i.instance=this,this.update(this.options);const{onMount:a}=this.options.validators||{};if(a){const o=this.runValidator({validate:a,value:{value:this.state.value,fieldApi:this,validationSource:"field"},type:"validate"});o&&this.setMeta(l=>({...l,errorMap:{...l==null?void 0:l.errorMap,onMount:o},errorSourceMap:{...l==null?void 0:l.errorSourceMap,onMount:"field"}}))}return(r=(n=this.options.listeners)==null?void 0:n.onMount)==null||r.call(n,{value:this.state.value,fieldApi:this}),s},this.update=n=>{this.options=n;const r=this.name!==n.name;if(this.name=n.name,this.state.value===void 0){const s=ox(n.form.options.defaultValues,n.name),i=n.defaultValue??s;r?this.setValue(a=>a||i,{dontUpdateMeta:!0}):i!==void 0&&this.setValue(i,{dontUpdateMeta:!0})}this.form.getFieldMeta(this.name)===void 0&&this.setMeta(this.state.meta)},this.getValue=()=>this.form.getFieldValue(this.name),this.setValue=(n,r)=>{this.form.setFieldValue(this.name,n,r),this.triggerOnChangeListener(),this.validate("change")},this.getMeta=()=>this.store.state.meta,this.setMeta=n=>this.form.setFieldMeta(this.name,n),this.getInfo=()=>this.form.getFieldInfo(this.name),this.pushValue=(n,r)=>{this.form.pushFieldValue(this.name,n,r),this.triggerOnChangeListener()},this.insertValue=(n,r,s)=>{this.form.insertFieldValue(this.name,n,r,s),this.triggerOnChangeListener()},this.replaceValue=(n,r,s)=>{this.form.replaceFieldValue(this.name,n,r,s),this.triggerOnChangeListener()},this.removeValue=(n,r)=>{this.form.removeFieldValue(this.name,n,r),this.triggerOnChangeListener()},this.swapValues=(n,r,s)=>{this.form.swapFieldValues(this.name,n,r,s),this.triggerOnChangeListener()},this.moveValue=(n,r,s)=>{this.form.moveFieldValues(this.name,n,r,s),this.triggerOnChangeListener()},this.clearValues=n=>{this.form.clearFieldValues(this.name,n),this.triggerOnChangeListener()},this.getLinkedFields=n=>{const r=Object.values(this.form.fieldInfo),s=[];for(const i of r){if(!i.instance)continue;const{onChangeListenTo:a,onBlurListenTo:o}=i.instance.options.validators||{};n==="change"&&(a!=null&&a.includes(this.name))&&s.push(i.instance),n==="blur"&&(o!=null&&o.includes(this.name))&&s.push(i.instance)}return s},this.validateSync=(n,r)=>{var s;const i=iP(n,this.options),o=this.getLinkedFields(n).reduce((u,d)=>{const h=iP(n,d.options);return h.forEach(m=>{m.field=d}),u.concat(h)},[]);let l=!1;iu(()=>{const u=(d,h)=>{var m;const y=u2(h.cause),b=h.validate?bV(d.runValidator({validate:h.validate,value:{value:d.store.state.value,validationSource:"field",fieldApi:d},type:"validate"})):void 0,v=r[y],{newErrorValue:x,newSource:w}=gV({formLevelError:v,fieldLevelError:b});((m=d.state.meta.errorMap)==null?void 0:m[y])!==x&&d.setMeta(S=>({...S,errorMap:{...S.errorMap,[y]:x},errorSourceMap:{...S.errorSourceMap,[y]:w}})),x&&(l=!0)};for(const d of i)u(this,d);for(const d of o)d.validate&&u(d.field,d)});const c=u2("submit");return(s=this.state.meta.errorMap)!=null&&s[c]&&n!=="submit"&&!l&&this.setMeta(u=>({...u,errorMap:{...u.errorMap,[c]:void 0},errorSourceMap:{...u.errorSourceMap,[c]:void 0}})),{hasErrored:l}},this.validateAsync=async(n,r)=>{const s=sP(n,this.options),i=await r,a=this.getLinkedFields(n),o=a.reduce((h,m)=>{const y=sP(n,m.options);return y.forEach(b=>{b.field=m}),h.concat(y)},[]);this.state.meta.isValidating||this.setMeta(h=>({...h,isValidating:!0}));for(const h of a)h.setMeta(m=>({...m,isValidating:!0}));const l=[],c=[],u=(h,m,y)=>{const b=u2(m.cause),v=h.getInfo().validationMetaMap[b];v==null||v.lastAbortController.abort();const x=new AbortController;this.getInfo().validationMetaMap[b]={lastAbortController:x},y.push(new Promise(async w=>{var S;let C;try{C=await new Promise((I,P)=>{this.timeoutIds.validations[m.cause]&&clearTimeout(this.timeoutIds.validations[m.cause]),this.timeoutIds.validations[m.cause]=setTimeout(async()=>{if(x.signal.aborted)return I(void 0);try{I(await this.runValidator({validate:m.validate,value:{value:h.store.state.value,fieldApi:h,signal:x.signal,validationSource:"field"},type:"validateAsync"}))}catch(L){P(L)}},m.debounceMs)})}catch(I){C=I}if(x.signal.aborted)return w(void 0);const k=bV(C),A=(S=i[this.name])==null?void 0:S[b],{newErrorValue:R,newSource:N}=gV({formLevelError:A,fieldLevelError:k});h.setMeta(I=>({...I,errorMap:{...I==null?void 0:I.errorMap,[b]:R},errorSourceMap:{...I.errorSourceMap,[b]:N}})),w(R)}))};for(const h of s)h.validate&&u(this,h,l);for(const h of o)h.validate&&u(h.field,h,c);let d=[];(l.length||c.length)&&(d=await Promise.all(l),await Promise.all(c)),this.setMeta(h=>({...h,isValidating:!1}));for(const h of a)h.setMeta(m=>({...m,isValidating:!1}));return d.filter(Boolean)},this.validate=(n,r)=>{var s;if(!this.state.meta.isTouched)return[];const{fieldsErrorMap:i}=r!=null&&r.skipFormValidation?{fieldsErrorMap:{}}:this.form.validateSync(n),{hasErrored:a}=this.validateSync(n,i[this.name]??{});if(a&&!this.options.asyncAlways)return(s=this.getInfo().validationMetaMap[u2(n)])==null||s.lastAbortController.abort(),this.state.meta.errors;const o=r!=null&&r.skipFormValidation?Promise.resolve({}):this.form.validateAsync(n);return this.validateAsync(n,o)},this.handleChange=n=>{this.setValue(n)},this.handleBlur=()=>{this.state.meta.isTouched||(this.setMeta(r=>({...r,isTouched:!0})),this.validate("change")),this.state.meta.isBlurred||this.setMeta(r=>({...r,isBlurred:!0})),this.validate("blur"),this.triggerOnBlurListener()},this.parseValueWithSchema=n=>O0.validate({value:this.state.value,validationSource:"field"},n),this.parseValueWithSchemaAsync=n=>O0.validateAsync({value:this.state.value,validationSource:"field"},n),this.form=t.form,this.name=t.name,this.timeoutIds={validations:{},listeners:{},formListeners:{}},this.store=new $d({deps:[this.form.store],fn:()=>{const n=this.form.getFieldValue(this.name),r=this.form.getFieldMeta(this.name)??{...Jk,...t.defaultMeta};return{value:n,meta:r}}}),this.options=t}get state(){return this.store.state}runValidator(t){return _ae(t.validate)?O0[t.type](t.value,t.validate):t.validate(t.value)}setErrorMap(t){this.setMeta(n=>({...n,errorMap:{...n.errorMap,...t}}))}triggerOnBlurListener(){var t,n,r,s,i,a;const o=(t=this.form.options.listeners)==null?void 0:t.onBlurDebounceMs;o&&o>0?(this.timeoutIds.formListeners.blur&&clearTimeout(this.timeoutIds.formListeners.blur),this.timeoutIds.formListeners.blur=setTimeout(()=>{var c,u;(u=(c=this.form.options.listeners)==null?void 0:c.onBlur)==null||u.call(c,{formApi:this.form,fieldApi:this})},o)):(r=(n=this.form.options.listeners)==null?void 0:n.onBlur)==null||r.call(n,{formApi:this.form,fieldApi:this});const l=(s=this.options.listeners)==null?void 0:s.onBlurDebounceMs;l&&l>0?(this.timeoutIds.listeners.blur&&clearTimeout(this.timeoutIds.listeners.blur),this.timeoutIds.listeners.blur=setTimeout(()=>{var c,u;(u=(c=this.options.listeners)==null?void 0:c.onBlur)==null||u.call(c,{value:this.state.value,fieldApi:this})},l)):(a=(i=this.options.listeners)==null?void 0:i.onBlur)==null||a.call(i,{value:this.state.value,fieldApi:this})}triggerOnChangeListener(){var t,n,r,s,i,a;const o=(t=this.form.options.listeners)==null?void 0:t.onChangeDebounceMs;o&&o>0?(this.timeoutIds.formListeners.blur&&clearTimeout(this.timeoutIds.formListeners.blur),this.timeoutIds.formListeners.blur=setTimeout(()=>{var c,u;(u=(c=this.form.options.listeners)==null?void 0:c.onChange)==null||u.call(c,{formApi:this.form,fieldApi:this})},o)):(r=(n=this.form.options.listeners)==null?void 0:n.onChange)==null||r.call(n,{formApi:this.form,fieldApi:this});const l=(s=this.options.listeners)==null?void 0:s.onChangeDebounceMs;l&&l>0?(this.timeoutIds.listeners.change&&clearTimeout(this.timeoutIds.listeners.change),this.timeoutIds.listeners.change=setTimeout(()=>{var c,u;(u=(c=this.options.listeners)==null?void 0:c.onChange)==null||u.call(c,{value:this.state.value,fieldApi:this})},l)):(a=(i=this.options.listeners)==null?void 0:i.onChange)==null||a.call(i,{value:this.state.value,fieldApi:this})}}function bV(e){if(e)return e}function u2(e){switch(e){case"submit":return"onSubmit";case"blur":return"onBlur";case"mount":return"onMount";case"server":return"onServer";case"change":default:return"onChange"}}var s3={exports:{}},i3={},a3={exports:{}},o3={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vV;function cYe(){if(vV)return o3;vV=1;var e=a1();function t(d,h){return d===h&&(d!==0||1/d===1/h)||d!==d&&h!==h}var n=typeof Object.is=="function"?Object.is:t,r=e.useState,s=e.useEffect,i=e.useLayoutEffect,a=e.useDebugValue;function o(d,h){var m=h(),y=r({inst:{value:m,getSnapshot:h}}),b=y[0].inst,v=y[1];return i(function(){b.value=m,b.getSnapshot=h,l(b)&&v({inst:b})},[d,m,h]),s(function(){return l(b)&&v({inst:b}),d(function(){l(b)&&v({inst:b})})},[d]),a(m),m}function l(d){var h=d.getSnapshot;d=d.value;try{var m=h();return!n(d,m)}catch{return!0}}function c(d,h){return h()}var u=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?c:o;return o3.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:u,o3}var xV;function uYe(){return xV||(xV=1,a3.exports=cYe()),a3.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wV;function dYe(){if(wV)return i3;wV=1;var e=a1(),t=uYe();function n(c,u){return c===u&&(c!==0||1/c===1/u)||c!==c&&u!==u}var r=typeof Object.is=="function"?Object.is:n,s=t.useSyncExternalStore,i=e.useRef,a=e.useEffect,o=e.useMemo,l=e.useDebugValue;return i3.useSyncExternalStoreWithSelector=function(c,u,d,h,m){var y=i(null);if(y.current===null){var b={hasValue:!1,value:null};y.current=b}else b=y.current;y=o(function(){function x(A){if(!w){if(w=!0,S=A,A=h(A),m!==void 0&&b.hasValue){var R=b.value;if(m(R,A))return C=R}return C=A}if(R=C,r(S,A))return R;var N=h(A);return m!==void 0&&m(R,N)?(S=A,R):(S=A,C=N)}var w=!1,S,C,k=d===void 0?null:d;return[function(){return x(u())},k===null?void 0:function(){return x(k())}]},[u,d,h,m]);var v=s(c,y[0],y[1]);return a(function(){b.hasValue=!0,b.value=v},[v]),l(v),v},i3}var _V;function fYe(){return _V||(_V=1,s3.exports=dYe()),s3.exports}var hYe=fYe();function b5(e,t=n=>n){return hYe.useSyncExternalStoreWithSelector(e.subscribe,()=>e.state,()=>e.state,t,pYe)}function pYe(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[r,s]of e)if(!t.has(r)||!Object.is(s,t.get(r)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const r of e)if(!t.has(r))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(let r=0;r<n.length;r++)if(!Object.prototype.hasOwnProperty.call(t,n[r])||!Object.is(e[n[r]],t[n[r]]))return!1;return!0}const Qk=typeof window<"u"?T.useLayoutEffect:T.useEffect;function mYe(e){const[t]=T.useState(()=>{const r=new lYe({...e,form:e.form,name:e.name});return r.Field=Sae,r});return Qk(t.mount,[t]),Qk(()=>{t.update(e)}),b5(t.store,e.mode==="array"?n=>[n.meta,Object.keys(n.value??[]).length]:void 0),t}const Sae=({children:e,...t})=>{const n=mYe(t),r=T.useMemo(()=>GT(e,n),[e,n,n.state.value,n.state.meta]);return f.jsx(f.Fragment,{children:r})};function gYe({form:e,selector:t,children:n}){const r=b5(e.store,t);return GT(n,r)}function ri(e){const[t]=T.useState(()=>{const n=new oYe(e),r=n;return r.Field=function(i){return f.jsx(Sae,{...i,form:n})},r.Subscribe=s=>f.jsx(gYe,{form:n,selector:s.selector,children:s.children}),r});return Qk(t.mount,[]),b5(t.store,n=>n.isSubmitting),Qk(()=>{t.update(e)}),t}function _n({className:e,type:t,...n}){return f.jsx("input",{type:t,"data-slot":"input",className:Ze("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",e),...n})}function yYe(e){const t=e+"CollectionProvider",[n,r]=Hi(t),[s,i]=n(t,{collectionRef:{current:null},itemMap:new Map}),a=b=>{const{scope:v,children:x}=b,w=We.useRef(null),S=We.useRef(new Map).current;return f.jsx(s,{scope:v,itemMap:S,collectionRef:w,children:x})};a.displayName=t;const o=e+"CollectionSlot",l=Au(o),c=We.forwardRef((b,v)=>{const{scope:x,children:w}=b,S=i(o,x),C=Rn(v,S.collectionRef);return f.jsx(l,{ref:C,children:w})});c.displayName=o;const u=e+"CollectionItemSlot",d="data-radix-collection-item",h=Au(u),m=We.forwardRef((b,v)=>{const{scope:x,children:w,...S}=b,C=We.useRef(null),k=Rn(v,C),A=i(u,x);return We.useEffect(()=>(A.itemMap.set(C,{ref:C,...S}),()=>void A.itemMap.delete(C))),f.jsx(h,{[d]:"",ref:k,children:w})});m.displayName=u;function y(b){const v=i(e+"CollectionConsumer",b);return We.useCallback(()=>{const w=v.collectionRef.current;if(!w)return[];const S=Array.from(w.querySelectorAll(`[${d}]`));return Array.from(v.itemMap.values()).sort((A,R)=>S.indexOf(A.ref.current)-S.indexOf(R.ref.current))},[v.collectionRef,v.itemMap])}return[{Provider:a,Slot:c,ItemSlot:m},y,r]}var bYe=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],vi=bYe.reduce((e,t)=>{const n=Au(`Primitive.${t}`),r=T.forwardRef((s,i)=>{const{asChild:a,...o}=s,l=a?n:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),f.jsx(l,{...o,ref:i})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{});function vYe(e,t){e&&al.flushSync(()=>e.dispatchEvent(t))}var xYe="DismissableLayer",oP="dismissableLayer.update",wYe="dismissableLayer.pointerDownOutside",_Ye="dismissableLayer.focusOutside",SV,Cae=T.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),kae=T.forwardRef((e,t)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:s,onFocusOutside:i,onInteractOutside:a,onDismiss:o,...l}=e,c=T.useContext(Cae),[u,d]=T.useState(null),h=(u==null?void 0:u.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,m]=T.useState({}),y=Rn(t,R=>d(R)),b=Array.from(c.layers),[v]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),x=b.indexOf(v),w=u?b.indexOf(u):-1,S=c.layersWithOutsidePointerEventsDisabled.size>0,C=w>=x,k=kYe(R=>{const N=R.target,I=[...c.branches].some(P=>P.contains(N));!C||I||(s==null||s(R),a==null||a(R),R.defaultPrevented||o==null||o())},h),A=EYe(R=>{const N=R.target;[...c.branches].some(P=>P.contains(N))||(i==null||i(R),a==null||a(R),R.defaultPrevented||o==null||o())},h);return XP(R=>{w===c.layers.size-1&&(r==null||r(R),!R.defaultPrevented&&o&&(R.preventDefault(),o()))},h),T.useEffect(()=>{if(u)return n&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(SV=h.body.style.pointerEvents,h.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(u)),c.layers.add(u),CV(),()=>{n&&c.layersWithOutsidePointerEventsDisabled.size===1&&(h.body.style.pointerEvents=SV)}},[u,h,n,c]),T.useEffect(()=>()=>{u&&(c.layers.delete(u),c.layersWithOutsidePointerEventsDisabled.delete(u),CV())},[u,c]),T.useEffect(()=>{const R=()=>m({});return document.addEventListener(oP,R),()=>document.removeEventListener(oP,R)},[]),f.jsx(vi.div,{...l,ref:y,style:{pointerEvents:S?C?"auto":"none":void 0,...e.style},onFocusCapture:Wt(e.onFocusCapture,A.onFocusCapture),onBlurCapture:Wt(e.onBlurCapture,A.onBlurCapture),onPointerDownCapture:Wt(e.onPointerDownCapture,k.onPointerDownCapture)})});kae.displayName=xYe;var SYe="DismissableLayerBranch",CYe=T.forwardRef((e,t)=>{const n=T.useContext(Cae),r=T.useRef(null),s=Rn(t,r);return T.useEffect(()=>{const i=r.current;if(i)return n.branches.add(i),()=>{n.branches.delete(i)}},[n.branches]),f.jsx(vi.div,{...e,ref:s})});CYe.displayName=SYe;function kYe(e,t=globalThis==null?void 0:globalThis.document){const n=ks(e),r=T.useRef(!1),s=T.useRef(()=>{});return T.useEffect(()=>{const i=o=>{if(o.target&&!r.current){let l=function(){Eae(wYe,n,c,{discrete:!0})};const c={originalEvent:o};o.pointerType==="touch"?(t.removeEventListener("click",s.current),s.current=l,t.addEventListener("click",s.current,{once:!0})):l()}else t.removeEventListener("click",s.current);r.current=!1},a=window.setTimeout(()=>{t.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(a),t.removeEventListener("pointerdown",i),t.removeEventListener("click",s.current)}},[t,n]),{onPointerDownCapture:()=>r.current=!0}}function EYe(e,t=globalThis==null?void 0:globalThis.document){const n=ks(e),r=T.useRef(!1);return T.useEffect(()=>{const s=i=>{i.target&&!r.current&&Eae(_Ye,n,{originalEvent:i},{discrete:!1})};return t.addEventListener("focusin",s),()=>t.removeEventListener("focusin",s)},[t,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function CV(){const e=new CustomEvent(oP);document.dispatchEvent(e)}function Eae(e,t,n,{discrete:r}){const s=n.originalEvent.target,i=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&s.addEventListener(e,t,{once:!0}),r?vYe(s,i):s.dispatchEvent(i)}var l3=0;function KT(){T.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??kV()),document.body.insertAdjacentElement("beforeend",e[1]??kV()),l3++,()=>{l3===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),l3--}},[])}function kV(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var c3="focusScope.autoFocusOnMount",u3="focusScope.autoFocusOnUnmount",EV={bubbles:!1,cancelable:!0},TYe="FocusScope",Tae=T.forwardRef((e,t)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:s,onUnmountAutoFocus:i,...a}=e,[o,l]=T.useState(null),c=ks(s),u=ks(i),d=T.useRef(null),h=Rn(t,b=>l(b)),m=T.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;T.useEffect(()=>{if(r){let b=function(S){if(m.paused||!o)return;const C=S.target;o.contains(C)?d.current=C:Qf(d.current,{select:!0})},v=function(S){if(m.paused||!o)return;const C=S.relatedTarget;C!==null&&(o.contains(C)||Qf(d.current,{select:!0}))},x=function(S){if(document.activeElement===document.body)for(const k of S)k.removedNodes.length>0&&Qf(o)};document.addEventListener("focusin",b),document.addEventListener("focusout",v);const w=new MutationObserver(x);return o&&w.observe(o,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",b),document.removeEventListener("focusout",v),w.disconnect()}}},[r,o,m.paused]),T.useEffect(()=>{if(o){AV.add(m);const b=document.activeElement;if(!o.contains(b)){const x=new CustomEvent(c3,EV);o.addEventListener(c3,c),o.dispatchEvent(x),x.defaultPrevented||(AYe(jYe(Aae(o)),{select:!0}),document.activeElement===b&&Qf(o))}return()=>{o.removeEventListener(c3,c),setTimeout(()=>{const x=new CustomEvent(u3,EV);o.addEventListener(u3,u),o.dispatchEvent(x),x.defaultPrevented||Qf(b??document.body,{select:!0}),o.removeEventListener(u3,u),AV.remove(m)},0)}}},[o,c,u,m]);const y=T.useCallback(b=>{if(!n&&!r||m.paused)return;const v=b.key==="Tab"&&!b.altKey&&!b.ctrlKey&&!b.metaKey,x=document.activeElement;if(v&&x){const w=b.currentTarget,[S,C]=RYe(w);S&&C?!b.shiftKey&&x===C?(b.preventDefault(),n&&Qf(S,{select:!0})):b.shiftKey&&x===S&&(b.preventDefault(),n&&Qf(C,{select:!0})):x===w&&b.preventDefault()}},[n,r,m.paused]);return f.jsx(vi.div,{tabIndex:-1,...a,ref:h,onKeyDown:y})});Tae.displayName=TYe;function AYe(e,{select:t=!1}={}){const n=document.activeElement;for(const r of e)if(Qf(r,{select:t}),document.activeElement!==n)return}function RYe(e){const t=Aae(e),n=TV(t,e),r=TV(t.reverse(),e);return[n,r]}function Aae(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const s=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||s?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function TV(e,t){for(const n of e)if(!NYe(n,{upTo:t}))return n}function NYe(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function MYe(e){return e instanceof HTMLInputElement&&"select"in e}function Qf(e,{select:t=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&MYe(e)&&t&&e.select()}}var AV=IYe();function IYe(){let e=[];return{add(t){const n=e[0];t!==n&&(n==null||n.pause()),e=RV(e,t),e.unshift(t)},remove(t){var n;e=RV(e,t),(n=e[0])==null||n.resume()}}}function RV(e,t){const n=[...e],r=n.indexOf(t);return r!==-1&&n.splice(r,1),n}function jYe(e){return e.filter(t=>t.tagName!=="A")}var PYe="Arrow",Rae=T.forwardRef((e,t)=>{const{children:n,width:r=10,height:s=5,...i}=e;return f.jsx(vi.svg,{...i,ref:t,width:r,height:s,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?n:f.jsx("polygon",{points:"0,0 30,0 15,10"})})});Rae.displayName=PYe;var OYe=Rae,v5="Popper",[Nae,Mae]=Hi(v5),[DYe,Iae]=Nae(v5),jae=e=>{const{__scopePopper:t,children:n}=e,[r,s]=T.useState(null);return f.jsx(DYe,{scope:t,anchor:r,onAnchorChange:s,children:n})};jae.displayName=v5;var Pae="PopperAnchor",Oae=T.forwardRef((e,t)=>{const{__scopePopper:n,virtualRef:r,...s}=e,i=Iae(Pae,n),a=T.useRef(null),o=Rn(t,a);return T.useEffect(()=>{i.onAnchorChange((r==null?void 0:r.current)||a.current)}),r?null:f.jsx(vi.div,{...s,ref:o})});Oae.displayName=Pae;var x5="PopperContent",[FYe,LYe]=Nae(x5),Dae=T.forwardRef((e,t)=>{var De,Se,Ce,qe,Qe,Ve;const{__scopePopper:n,side:r="bottom",sideOffset:s=0,align:i="center",alignOffset:a=0,arrowPadding:o=0,avoidCollisions:l=!0,collisionBoundary:c=[],collisionPadding:u=0,sticky:d="partial",hideWhenDetached:h=!1,updatePositionStrategy:m="optimized",onPlaced:y,...b}=e,v=Iae(x5,n),[x,w]=T.useState(null),S=Rn(t,Ne=>w(Ne)),[C,k]=T.useState(null),A=$y(C),R=(A==null?void 0:A.width)??0,N=(A==null?void 0:A.height)??0,I=r+(i!=="center"?"-"+i:""),P=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},L=Array.isArray(c)?c:[c],O=L.length>0,V={padding:P,boundary:L.filter($Ye),altBoundary:O},{refs:D,floatingStyles:Z,placement:U,isPositioned:H,middlewareData:$}=aO({strategy:"fixed",placement:I,whileElementsMounted:(...Ne)=>iO(...Ne,{animationFrame:m==="always"}),elements:{reference:v.anchor},middleware:[oO({mainAxis:s+N,alignmentAxis:a}),l&&lO({mainAxis:!0,crossAxis:!1,limiter:d==="partial"?cO():void 0,...V}),l&&uO({...V}),dO({...V,apply:({elements:Ne,rects:K,availableWidth:ge,availableHeight:Ae})=>{const{width:le,height:oe}=K.reference,re=Ne.floating.style;re.setProperty("--radix-popper-available-width",`${ge}px`),re.setProperty("--radix-popper-available-height",`${Ae}px`),re.setProperty("--radix-popper-anchor-width",`${le}px`),re.setProperty("--radix-popper-anchor-height",`${oe}px`)}}),C&&hO({element:C,padding:o}),zYe({arrowWidth:R,arrowHeight:N}),h&&fO({strategy:"referenceHidden",...V})]}),[ne,W]=Bae(U),Q=ks(y);ni(()=>{H&&(Q==null||Q())},[H,Q]);const ee=(De=$.arrow)==null?void 0:De.x,se=(Se=$.arrow)==null?void 0:Se.y,pe=((Ce=$.arrow)==null?void 0:Ce.centerOffset)!==0,[ce,Ie]=T.useState();return ni(()=>{x&&Ie(window.getComputedStyle(x).zIndex)},[x]),f.jsx("div",{ref:D.setFloating,"data-radix-popper-content-wrapper":"",style:{...Z,transform:H?Z.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:ce,"--radix-popper-transform-origin":[(qe=$.transformOrigin)==null?void 0:qe.x,(Qe=$.transformOrigin)==null?void 0:Qe.y].join(" "),...((Ve=$.hide)==null?void 0:Ve.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:f.jsx(FYe,{scope:n,placedSide:ne,onArrowChange:k,arrowX:ee,arrowY:se,shouldHideArrow:pe,children:f.jsx(vi.div,{"data-side":ne,"data-align":W,...b,ref:S,style:{...b.style,animation:H?void 0:"none"}})})})});Dae.displayName=x5;var Fae="PopperArrow",BYe={top:"bottom",right:"left",bottom:"top",left:"right"},Lae=T.forwardRef(function(t,n){const{__scopePopper:r,...s}=t,i=LYe(Fae,r),a=BYe[i.placedSide];return f.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[a]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:f.jsx(OYe,{...s,ref:n,style:{...s.style,display:"block"}})})});Lae.displayName=Fae;function $Ye(e){return e!==null}var zYe=e=>({name:"transformOrigin",options:e,fn(t){var v,x,w;const{placement:n,rects:r,middlewareData:s}=t,a=((v=s.arrow)==null?void 0:v.centerOffset)!==0,o=a?0:e.arrowWidth,l=a?0:e.arrowHeight,[c,u]=Bae(n),d={start:"0%",center:"50%",end:"100%"}[u],h=(((x=s.arrow)==null?void 0:x.x)??0)+o/2,m=(((w=s.arrow)==null?void 0:w.y)??0)+l/2;let y="",b="";return c==="bottom"?(y=a?d:`${h}px`,b=`${-l}px`):c==="top"?(y=a?d:`${h}px`,b=`${r.floating.height+l}px`):c==="right"?(y=`${-l}px`,b=a?d:`${m}px`):c==="left"&&(y=`${r.floating.width+l}px`,b=a?d:`${m}px`),{data:{x:y,y:b}}}});function Bae(e){const[t,n="center"]=e.split("-");return[t,n]}var UYe=jae,qYe=Oae,VYe=Dae,WYe=Lae,HYe="Portal",$ae=T.forwardRef((e,t)=>{var o;const{container:n,...r}=e,[s,i]=T.useState(!1);ni(()=>i(!0),[]);const a=n||s&&((o=globalThis==null?void 0:globalThis.document)==null?void 0:o.body);return a?yE.createPortal(f.jsx(vi.div,{...r,ref:t}),a):null});$ae.displayName=HYe;function YT(e){const t=T.useRef({value:e,previous:e});return T.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var zae=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),GYe="VisuallyHidden",KYe=T.forwardRef((e,t)=>f.jsx(vi.span,{...e,ref:t,style:{...zae,...e.style}}));KYe.displayName=GYe;var YYe=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},n0=new WeakMap,d2=new WeakMap,f2={},d3=0,Uae=function(e){return e&&(e.host||Uae(e.parentNode))},ZYe=function(e,t){return t.map(function(n){if(e.contains(n))return n;var r=Uae(n);return r&&e.contains(r)?r:(console.error("aria-hidden",n,"in not contained inside",e,". Doing nothing"),null)}).filter(function(n){return!!n})},XYe=function(e,t,n,r){var s=ZYe(t,Array.isArray(e)?e:[e]);f2[n]||(f2[n]=new WeakMap);var i=f2[n],a=[],o=new Set,l=new Set(s),c=function(d){!d||o.has(d)||(o.add(d),c(d.parentNode))};s.forEach(c);var u=function(d){!d||l.has(d)||Array.prototype.forEach.call(d.children,function(h){if(o.has(h))u(h);else try{var m=h.getAttribute(r),y=m!==null&&m!=="false",b=(n0.get(h)||0)+1,v=(i.get(h)||0)+1;n0.set(h,b),i.set(h,v),a.push(h),b===1&&y&&d2.set(h,!0),v===1&&h.setAttribute(n,"true"),y||h.setAttribute(r,"true")}catch(x){console.error("aria-hidden: cannot operate on ",h,x)}})};return u(t),o.clear(),d3++,function(){a.forEach(function(d){var h=n0.get(d)-1,m=i.get(d)-1;n0.set(d,h),i.set(d,m),h||(d2.has(d)||d.removeAttribute(r),d2.delete(d)),m||d.removeAttribute(n)}),d3--,d3||(n0=new WeakMap,n0=new WeakMap,d2=new WeakMap,f2={})}},ZT=function(e,t,n){n===void 0&&(n="data-aria-hidden");var r=Array.from(Array.isArray(e)?e:[e]),s=YYe(e);return s?(r.push.apply(r,Array.from(s.querySelectorAll("[aria-live]"))),XYe(r,s,n,"aria-hidden")):function(){return null}},mu=function(){return mu=Object.assign||function(t){for(var n,r=1,s=arguments.length;r<s;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},mu.apply(this,arguments)};function qae(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(e);s<r.length;s++)t.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(n[r[s]]=e[r[s]]);return n}function JYe(e,t,n){if(n||arguments.length===2)for(var r=0,s=t.length,i;r<s;r++)(i||!(r in t))&&(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))}var X2="right-scroll-bar-position",J2="width-before-scroll-bar",QYe="with-scroll-bars-hidden",eZe="--removed-body-scroll-bar-size";function f3(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function tZe(e,t){var n=T.useState(function(){return{value:e,callback:t,facade:{get current(){return n.value},set current(r){var s=n.value;s!==r&&(n.value=r,n.callback(r,s))}}}})[0];return n.callback=t,n.facade}var nZe=typeof window<"u"?T.useLayoutEffect:T.useEffect,NV=new WeakMap;function rZe(e,t){var n=tZe(null,function(r){return e.forEach(function(s){return f3(s,r)})});return nZe(function(){var r=NV.get(n);if(r){var s=new Set(r),i=new Set(e),a=n.current;s.forEach(function(o){i.has(o)||f3(o,null)}),i.forEach(function(o){s.has(o)||f3(o,a)})}NV.set(n,e)},[e]),n}function sZe(e){return e}function iZe(e,t){t===void 0&&(t=sZe);var n=[],r=!1,s={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:e},useMedium:function(i){var a=t(i,r);return n.push(a),function(){n=n.filter(function(o){return o!==a})}},assignSyncMedium:function(i){for(r=!0;n.length;){var a=n;n=[],a.forEach(i)}n={push:function(o){return i(o)},filter:function(){return n}}},assignMedium:function(i){r=!0;var a=[];if(n.length){var o=n;n=[],o.forEach(i),a=n}var l=function(){var u=a;a=[],u.forEach(i)},c=function(){return Promise.resolve().then(l)};c(),n={push:function(u){a.push(u),c()},filter:function(u){return a=a.filter(u),n}}}};return s}function aZe(e){e===void 0&&(e={});var t=iZe(null);return t.options=mu({async:!0,ssr:!1},e),t}var Vae=function(e){var t=e.sideCar,n=qae(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=t.read();if(!r)throw new Error("Sidecar medium not found");return T.createElement(r,mu({},n))};Vae.isSideCarExport=!0;function oZe(e,t){return e.useMedium(t),Vae}var Wae=aZe(),h3=function(){},XT=T.forwardRef(function(e,t){var n=T.useRef(null),r=T.useState({onScrollCapture:h3,onWheelCapture:h3,onTouchMoveCapture:h3}),s=r[0],i=r[1],a=e.forwardProps,o=e.children,l=e.className,c=e.removeScrollBar,u=e.enabled,d=e.shards,h=e.sideCar,m=e.noIsolation,y=e.inert,b=e.allowPinchZoom,v=e.as,x=v===void 0?"div":v,w=e.gapMode,S=qae(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),C=h,k=rZe([n,t]),A=mu(mu({},S),s);return T.createElement(T.Fragment,null,u&&T.createElement(C,{sideCar:Wae,removeScrollBar:c,shards:d,noIsolation:m,inert:y,setCallbacks:i,allowPinchZoom:!!b,lockRef:n,gapMode:w}),a?T.cloneElement(T.Children.only(o),mu(mu({},A),{ref:k})):T.createElement(x,mu({},A,{className:l,ref:k}),o))});XT.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};XT.classNames={fullWidth:J2,zeroRight:X2};var lZe=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function cZe(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=lZe();return t&&e.setAttribute("nonce",t),e}function uZe(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function dZe(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var fZe=function(){var e=0,t=null;return{add:function(n){e==0&&(t=cZe())&&(uZe(t,n),dZe(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},hZe=function(){var e=fZe();return function(t,n){T.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&n])}},Hae=function(){var e=hZe(),t=function(n){var r=n.styles,s=n.dynamic;return e(r,s),null};return t},pZe={left:0,top:0,right:0,gap:0},p3=function(e){return parseInt(e||"",10)||0},mZe=function(e){var t=window.getComputedStyle(document.body),n=t[e==="padding"?"paddingLeft":"marginLeft"],r=t[e==="padding"?"paddingTop":"marginTop"],s=t[e==="padding"?"paddingRight":"marginRight"];return[p3(n),p3(r),p3(s)]},gZe=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return pZe;var t=mZe(e),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,r-n+t[2]-t[0])}},yZe=Hae(),D0="data-scroll-locked",bZe=function(e,t,n,r){var s=e.left,i=e.top,a=e.right,o=e.gap;return n===void 0&&(n="margin"),`
  .`.concat(QYe,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(o,"px ").concat(r,`;
  }
  body[`).concat(D0,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(r,";"),n==="margin"&&`
    padding-left: `.concat(s,`px;
    padding-top: `).concat(i,`px;
    padding-right: `).concat(a,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(o,"px ").concat(r,`;
    `),n==="padding"&&"padding-right: ".concat(o,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(X2,` {
    right: `).concat(o,"px ").concat(r,`;
  }
  
  .`).concat(J2,` {
    margin-right: `).concat(o,"px ").concat(r,`;
  }
  
  .`).concat(X2," .").concat(X2,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(J2," .").concat(J2,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(D0,`] {
    `).concat(eZe,": ").concat(o,`px;
  }
`)},MV=function(){var e=parseInt(document.body.getAttribute(D0)||"0",10);return isFinite(e)?e:0},vZe=function(){T.useEffect(function(){return document.body.setAttribute(D0,(MV()+1).toString()),function(){var e=MV()-1;e<=0?document.body.removeAttribute(D0):document.body.setAttribute(D0,e.toString())}},[])},xZe=function(e){var t=e.noRelative,n=e.noImportant,r=e.gapMode,s=r===void 0?"margin":r;vZe();var i=T.useMemo(function(){return gZe(s)},[s]);return T.createElement(yZe,{styles:bZe(i,!t,s,n?"":"!important")})},lP=!1;if(typeof window<"u")try{var h2=Object.defineProperty({},"passive",{get:function(){return lP=!0,!0}});window.addEventListener("test",h2,h2),window.removeEventListener("test",h2,h2)}catch{lP=!1}var r0=lP?{passive:!1}:!1,wZe=function(e){return e.tagName==="TEXTAREA"},Gae=function(e,t){if(!(e instanceof Element))return!1;var n=window.getComputedStyle(e);return n[t]!=="hidden"&&!(n.overflowY===n.overflowX&&!wZe(e)&&n[t]==="visible")},_Ze=function(e){return Gae(e,"overflowY")},SZe=function(e){return Gae(e,"overflowX")},IV=function(e,t){var n=t.ownerDocument,r=t;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var s=Kae(e,r);if(s){var i=Yae(e,r),a=i[1],o=i[2];if(a>o)return!0}r=r.parentNode}while(r&&r!==n.body);return!1},CZe=function(e){var t=e.scrollTop,n=e.scrollHeight,r=e.clientHeight;return[t,n,r]},kZe=function(e){var t=e.scrollLeft,n=e.scrollWidth,r=e.clientWidth;return[t,n,r]},Kae=function(e,t){return e==="v"?_Ze(t):SZe(t)},Yae=function(e,t){return e==="v"?CZe(t):kZe(t)},EZe=function(e,t){return e==="h"&&t==="rtl"?-1:1},TZe=function(e,t,n,r,s){var i=EZe(e,window.getComputedStyle(t).direction),a=i*r,o=n.target,l=t.contains(o),c=!1,u=a>0,d=0,h=0;do{var m=Yae(e,o),y=m[0],b=m[1],v=m[2],x=b-v-i*y;(y||x)&&Kae(e,o)&&(d+=x,h+=y),o instanceof ShadowRoot?o=o.host:o=o.parentNode}while(!l&&o!==document.body||l&&(t.contains(o)||t===o));return(u&&Math.abs(d)<1||!u&&Math.abs(h)<1)&&(c=!0),c},p2=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},jV=function(e){return[e.deltaX,e.deltaY]},PV=function(e){return e&&"current"in e?e.current:e},AZe=function(e,t){return e[0]===t[0]&&e[1]===t[1]},RZe=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},NZe=0,s0=[];function MZe(e){var t=T.useRef([]),n=T.useRef([0,0]),r=T.useRef(),s=T.useState(NZe++)[0],i=T.useState(Hae)[0],a=T.useRef(e);T.useEffect(function(){a.current=e},[e]),T.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(s));var b=JYe([e.lockRef.current],(e.shards||[]).map(PV),!0).filter(Boolean);return b.forEach(function(v){return v.classList.add("allow-interactivity-".concat(s))}),function(){document.body.classList.remove("block-interactivity-".concat(s)),b.forEach(function(v){return v.classList.remove("allow-interactivity-".concat(s))})}}},[e.inert,e.lockRef.current,e.shards]);var o=T.useCallback(function(b,v){if("touches"in b&&b.touches.length===2||b.type==="wheel"&&b.ctrlKey)return!a.current.allowPinchZoom;var x=p2(b),w=n.current,S="deltaX"in b?b.deltaX:w[0]-x[0],C="deltaY"in b?b.deltaY:w[1]-x[1],k,A=b.target,R=Math.abs(S)>Math.abs(C)?"h":"v";if("touches"in b&&R==="h"&&A.type==="range")return!1;var N=IV(R,A);if(!N)return!0;if(N?k=R:(k=R==="v"?"h":"v",N=IV(R,A)),!N)return!1;if(!r.current&&"changedTouches"in b&&(S||C)&&(r.current=k),!k)return!0;var I=r.current||k;return TZe(I,v,b,I==="h"?S:C)},[]),l=T.useCallback(function(b){var v=b;if(!(!s0.length||s0[s0.length-1]!==i)){var x="deltaY"in v?jV(v):p2(v),w=t.current.filter(function(k){return k.name===v.type&&(k.target===v.target||v.target===k.shadowParent)&&AZe(k.delta,x)})[0];if(w&&w.should){v.cancelable&&v.preventDefault();return}if(!w){var S=(a.current.shards||[]).map(PV).filter(Boolean).filter(function(k){return k.contains(v.target)}),C=S.length>0?o(v,S[0]):!a.current.noIsolation;C&&v.cancelable&&v.preventDefault()}}},[]),c=T.useCallback(function(b,v,x,w){var S={name:b,delta:v,target:x,should:w,shadowParent:IZe(x)};t.current.push(S),setTimeout(function(){t.current=t.current.filter(function(C){return C!==S})},1)},[]),u=T.useCallback(function(b){n.current=p2(b),r.current=void 0},[]),d=T.useCallback(function(b){c(b.type,jV(b),b.target,o(b,e.lockRef.current))},[]),h=T.useCallback(function(b){c(b.type,p2(b),b.target,o(b,e.lockRef.current))},[]);T.useEffect(function(){return s0.push(i),e.setCallbacks({onScrollCapture:d,onWheelCapture:d,onTouchMoveCapture:h}),document.addEventListener("wheel",l,r0),document.addEventListener("touchmove",l,r0),document.addEventListener("touchstart",u,r0),function(){s0=s0.filter(function(b){return b!==i}),document.removeEventListener("wheel",l,r0),document.removeEventListener("touchmove",l,r0),document.removeEventListener("touchstart",u,r0)}},[]);var m=e.removeScrollBar,y=e.inert;return T.createElement(T.Fragment,null,y?T.createElement(i,{styles:RZe(s)}):null,m?T.createElement(xZe,{gapMode:e.gapMode}):null)}function IZe(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const jZe=oZe(Wae,MZe);var n_=T.forwardRef(function(e,t){return T.createElement(XT,mu({},e,{ref:t,sideCar:jZe}))});n_.classNames=XT.classNames;var PZe=[" ","Enter","ArrowUp","ArrowDown"],OZe=[" ","Enter"],jm="Select",[JT,QT,DZe]=yYe(jm),[hb,bdt]=Hi(jm,[DZe,Mae]),eA=Mae(),[FZe,ep]=hb(jm),[LZe,BZe]=hb(jm),Zae=e=>{const{__scopeSelect:t,children:n,open:r,defaultOpen:s,onOpenChange:i,value:a,defaultValue:o,onValueChange:l,dir:c,name:u,autoComplete:d,disabled:h,required:m,form:y}=e,b=eA(t),[v,x]=T.useState(null),[w,S]=T.useState(null),[C,k]=T.useState(!1),A=cb(c),[R,N]=Pc({prop:r,defaultProp:s??!1,onChange:i,caller:jm}),[I,P]=Pc({prop:a,defaultProp:o,onChange:l,caller:jm}),L=T.useRef(null),O=v?y||!!v.closest("form"):!0,[V,D]=T.useState(new Set),Z=Array.from(V).map(U=>U.props.value).join(";");return f.jsx(UYe,{...b,children:f.jsxs(FZe,{required:m,scope:t,trigger:v,onTriggerChange:x,valueNode:w,onValueNodeChange:S,valueNodeHasChildren:C,onValueNodeHasChildrenChange:k,contentId:aa(),value:I,onValueChange:P,open:R,onOpenChange:N,dir:A,triggerPointerDownPosRef:L,disabled:h,children:[f.jsx(JT.Provider,{scope:t,children:f.jsx(LZe,{scope:e.__scopeSelect,onNativeOptionAdd:T.useCallback(U=>{D(H=>new Set(H).add(U))},[]),onNativeOptionRemove:T.useCallback(U=>{D(H=>{const $=new Set(H);return $.delete(U),$})},[]),children:n})}),O?f.jsxs(boe,{"aria-hidden":!0,required:m,tabIndex:-1,name:u,autoComplete:d,value:I,onChange:U=>P(U.target.value),disabled:h,form:y,children:[I===void 0?f.jsx("option",{value:""}):null,Array.from(V)]},Z):null]})})};Zae.displayName=jm;var Xae="SelectTrigger",Jae=T.forwardRef((e,t)=>{const{__scopeSelect:n,disabled:r=!1,...s}=e,i=eA(n),a=ep(Xae,n),o=a.disabled||r,l=Rn(t,a.onTriggerChange),c=QT(n),u=T.useRef("touch"),[d,h,m]=xoe(b=>{const v=c().filter(S=>!S.disabled),x=v.find(S=>S.value===a.value),w=woe(v,b,x);w!==void 0&&a.onValueChange(w.value)}),y=b=>{o||(a.onOpenChange(!0),m()),b&&(a.triggerPointerDownPosRef.current={x:Math.round(b.pageX),y:Math.round(b.pageY)})};return f.jsx(qYe,{asChild:!0,...i,children:f.jsx(vi.button,{type:"button",role:"combobox","aria-controls":a.contentId,"aria-expanded":a.open,"aria-required":a.required,"aria-autocomplete":"none",dir:a.dir,"data-state":a.open?"open":"closed",disabled:o,"data-disabled":o?"":void 0,"data-placeholder":voe(a.value)?"":void 0,...s,ref:l,onClick:Wt(s.onClick,b=>{b.currentTarget.focus(),u.current!=="mouse"&&y(b)}),onPointerDown:Wt(s.onPointerDown,b=>{u.current=b.pointerType;const v=b.target;v.hasPointerCapture(b.pointerId)&&v.releasePointerCapture(b.pointerId),b.button===0&&b.ctrlKey===!1&&b.pointerType==="mouse"&&(y(b),b.preventDefault())}),onKeyDown:Wt(s.onKeyDown,b=>{const v=d.current!=="";!(b.ctrlKey||b.altKey||b.metaKey)&&b.key.length===1&&h(b.key),!(v&&b.key===" ")&&PZe.includes(b.key)&&(y(),b.preventDefault())})})})});Jae.displayName=Xae;var Qae="SelectValue",eoe=T.forwardRef((e,t)=>{const{__scopeSelect:n,className:r,style:s,children:i,placeholder:a="",...o}=e,l=ep(Qae,n),{onValueNodeHasChildrenChange:c}=l,u=i!==void 0,d=Rn(t,l.onValueNodeChange);return ni(()=>{c(u)},[c,u]),f.jsx(vi.span,{...o,ref:d,style:{pointerEvents:"none"},children:voe(l.value)?f.jsx(f.Fragment,{children:a}):i})});eoe.displayName=Qae;var $Ze="SelectIcon",toe=T.forwardRef((e,t)=>{const{__scopeSelect:n,children:r,...s}=e;return f.jsx(vi.span,{"aria-hidden":!0,...s,ref:t,children:r||"▼"})});toe.displayName=$Ze;var zZe="SelectPortal",noe=e=>f.jsx($ae,{asChild:!0,...e});noe.displayName=zZe;var Pm="SelectContent",roe=T.forwardRef((e,t)=>{const n=ep(Pm,e.__scopeSelect),[r,s]=T.useState();if(ni(()=>{s(new DocumentFragment)},[]),!n.open){const i=r;return i?al.createPortal(f.jsx(soe,{scope:e.__scopeSelect,children:f.jsx(JT.Slot,{scope:e.__scopeSelect,children:f.jsx("div",{children:e.children})})}),i):null}return f.jsx(ioe,{...e,ref:t})});roe.displayName=Pm;var mc=10,[soe,tp]=hb(Pm),UZe="SelectContentImpl",qZe=Au("SelectContent.RemoveScroll"),ioe=T.forwardRef((e,t)=>{const{__scopeSelect:n,position:r="item-aligned",onCloseAutoFocus:s,onEscapeKeyDown:i,onPointerDownOutside:a,side:o,sideOffset:l,align:c,alignOffset:u,arrowPadding:d,collisionBoundary:h,collisionPadding:m,sticky:y,hideWhenDetached:b,avoidCollisions:v,...x}=e,w=ep(Pm,n),[S,C]=T.useState(null),[k,A]=T.useState(null),R=Rn(t,De=>C(De)),[N,I]=T.useState(null),[P,L]=T.useState(null),O=QT(n),[V,D]=T.useState(!1),Z=T.useRef(!1);T.useEffect(()=>{if(S)return ZT(S)},[S]),KT();const U=T.useCallback(De=>{const[Se,...Ce]=O().map(Ve=>Ve.ref.current),[qe]=Ce.slice(-1),Qe=document.activeElement;for(const Ve of De)if(Ve===Qe||(Ve==null||Ve.scrollIntoView({block:"nearest"}),Ve===Se&&k&&(k.scrollTop=0),Ve===qe&&k&&(k.scrollTop=k.scrollHeight),Ve==null||Ve.focus(),document.activeElement!==Qe))return},[O,k]),H=T.useCallback(()=>U([N,S]),[U,N,S]);T.useEffect(()=>{V&&H()},[V,H]);const{onOpenChange:$,triggerPointerDownPosRef:ne}=w;T.useEffect(()=>{if(S){let De={x:0,y:0};const Se=qe=>{var Qe,Ve;De={x:Math.abs(Math.round(qe.pageX)-(((Qe=ne.current)==null?void 0:Qe.x)??0)),y:Math.abs(Math.round(qe.pageY)-(((Ve=ne.current)==null?void 0:Ve.y)??0))}},Ce=qe=>{De.x<=10&&De.y<=10?qe.preventDefault():S.contains(qe.target)||$(!1),document.removeEventListener("pointermove",Se),ne.current=null};return ne.current!==null&&(document.addEventListener("pointermove",Se),document.addEventListener("pointerup",Ce,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",Se),document.removeEventListener("pointerup",Ce,{capture:!0})}}},[S,$,ne]),T.useEffect(()=>{const De=()=>$(!1);return window.addEventListener("blur",De),window.addEventListener("resize",De),()=>{window.removeEventListener("blur",De),window.removeEventListener("resize",De)}},[$]);const[W,Q]=xoe(De=>{const Se=O().filter(Qe=>!Qe.disabled),Ce=Se.find(Qe=>Qe.ref.current===document.activeElement),qe=woe(Se,De,Ce);qe&&setTimeout(()=>qe.ref.current.focus())}),ee=T.useCallback((De,Se,Ce)=>{const qe=!Z.current&&!Ce;(w.value!==void 0&&w.value===Se||qe)&&(I(De),qe&&(Z.current=!0))},[w.value]),se=T.useCallback(()=>S==null?void 0:S.focus(),[S]),pe=T.useCallback((De,Se,Ce)=>{const qe=!Z.current&&!Ce;(w.value!==void 0&&w.value===Se||qe)&&L(De)},[w.value]),ce=r==="popper"?cP:aoe,Ie=ce===cP?{side:o,sideOffset:l,align:c,alignOffset:u,arrowPadding:d,collisionBoundary:h,collisionPadding:m,sticky:y,hideWhenDetached:b,avoidCollisions:v}:{};return f.jsx(soe,{scope:n,content:S,viewport:k,onViewportChange:A,itemRefCallback:ee,selectedItem:N,onItemLeave:se,itemTextRefCallback:pe,focusSelectedItem:H,selectedItemText:P,position:r,isPositioned:V,searchRef:W,children:f.jsx(n_,{as:qZe,allowPinchZoom:!0,children:f.jsx(Tae,{asChild:!0,trapped:w.open,onMountAutoFocus:De=>{De.preventDefault()},onUnmountAutoFocus:Wt(s,De=>{var Se;(Se=w.trigger)==null||Se.focus({preventScroll:!0}),De.preventDefault()}),children:f.jsx(kae,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:i,onPointerDownOutside:a,onFocusOutside:De=>De.preventDefault(),onDismiss:()=>w.onOpenChange(!1),children:f.jsx(ce,{role:"listbox",id:w.contentId,"data-state":w.open?"open":"closed",dir:w.dir,onContextMenu:De=>De.preventDefault(),...x,...Ie,onPlaced:()=>D(!0),ref:R,style:{display:"flex",flexDirection:"column",outline:"none",...x.style},onKeyDown:Wt(x.onKeyDown,De=>{const Se=De.ctrlKey||De.altKey||De.metaKey;if(De.key==="Tab"&&De.preventDefault(),!Se&&De.key.length===1&&Q(De.key),["ArrowUp","ArrowDown","Home","End"].includes(De.key)){let qe=O().filter(Qe=>!Qe.disabled).map(Qe=>Qe.ref.current);if(["ArrowUp","End"].includes(De.key)&&(qe=qe.slice().reverse()),["ArrowUp","ArrowDown"].includes(De.key)){const Qe=De.target,Ve=qe.indexOf(Qe);qe=qe.slice(Ve+1)}setTimeout(()=>U(qe)),De.preventDefault()}})})})})})})});ioe.displayName=UZe;var VZe="SelectItemAlignedPosition",aoe=T.forwardRef((e,t)=>{const{__scopeSelect:n,onPlaced:r,...s}=e,i=ep(Pm,n),a=tp(Pm,n),[o,l]=T.useState(null),[c,u]=T.useState(null),d=Rn(t,R=>u(R)),h=QT(n),m=T.useRef(!1),y=T.useRef(!0),{viewport:b,selectedItem:v,selectedItemText:x,focusSelectedItem:w}=a,S=T.useCallback(()=>{if(i.trigger&&i.valueNode&&o&&c&&b&&v&&x){const R=i.trigger.getBoundingClientRect(),N=c.getBoundingClientRect(),I=i.valueNode.getBoundingClientRect(),P=x.getBoundingClientRect();if(i.dir!=="rtl"){const Qe=P.left-N.left,Ve=I.left-Qe,Ne=R.left-Ve,K=R.width+Ne,ge=Math.max(K,N.width),Ae=window.innerWidth-mc,le=Uw(Ve,[mc,Math.max(mc,Ae-ge)]);o.style.minWidth=K+"px",o.style.left=le+"px"}else{const Qe=N.right-P.right,Ve=window.innerWidth-I.right-Qe,Ne=window.innerWidth-R.right-Ve,K=R.width+Ne,ge=Math.max(K,N.width),Ae=window.innerWidth-mc,le=Uw(Ve,[mc,Math.max(mc,Ae-ge)]);o.style.minWidth=K+"px",o.style.right=le+"px"}const L=h(),O=window.innerHeight-mc*2,V=b.scrollHeight,D=window.getComputedStyle(c),Z=parseInt(D.borderTopWidth,10),U=parseInt(D.paddingTop,10),H=parseInt(D.borderBottomWidth,10),$=parseInt(D.paddingBottom,10),ne=Z+U+V+$+H,W=Math.min(v.offsetHeight*5,ne),Q=window.getComputedStyle(b),ee=parseInt(Q.paddingTop,10),se=parseInt(Q.paddingBottom,10),pe=R.top+R.height/2-mc,ce=O-pe,Ie=v.offsetHeight/2,De=v.offsetTop+Ie,Se=Z+U+De,Ce=ne-Se;if(Se<=pe){const Qe=L.length>0&&v===L[L.length-1].ref.current;o.style.bottom="0px";const Ve=c.clientHeight-b.offsetTop-b.offsetHeight,Ne=Math.max(ce,Ie+(Qe?se:0)+Ve+H),K=Se+Ne;o.style.height=K+"px"}else{const Qe=L.length>0&&v===L[0].ref.current;o.style.top="0px";const Ne=Math.max(pe,Z+b.offsetTop+(Qe?ee:0)+Ie)+Ce;o.style.height=Ne+"px",b.scrollTop=Se-pe+b.offsetTop}o.style.margin=`${mc}px 0`,o.style.minHeight=W+"px",o.style.maxHeight=O+"px",r==null||r(),requestAnimationFrame(()=>m.current=!0)}},[h,i.trigger,i.valueNode,o,c,b,v,x,i.dir,r]);ni(()=>S(),[S]);const[C,k]=T.useState();ni(()=>{c&&k(window.getComputedStyle(c).zIndex)},[c]);const A=T.useCallback(R=>{R&&y.current===!0&&(S(),w==null||w(),y.current=!1)},[S,w]);return f.jsx(HZe,{scope:n,contentWrapper:o,shouldExpandOnScrollRef:m,onScrollButtonChange:A,children:f.jsx("div",{ref:l,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:C},children:f.jsx(vi.div,{...s,ref:d,style:{boxSizing:"border-box",maxHeight:"100%",...s.style}})})})});aoe.displayName=VZe;var WZe="SelectPopperPosition",cP=T.forwardRef((e,t)=>{const{__scopeSelect:n,align:r="start",collisionPadding:s=mc,...i}=e,a=eA(n);return f.jsx(VYe,{...a,...i,ref:t,align:r,collisionPadding:s,style:{boxSizing:"border-box",...i.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});cP.displayName=WZe;var[HZe,w5]=hb(Pm,{}),uP="SelectViewport",ooe=T.forwardRef((e,t)=>{const{__scopeSelect:n,nonce:r,...s}=e,i=tp(uP,n),a=w5(uP,n),o=Rn(t,i.onViewportChange),l=T.useRef(0);return f.jsxs(f.Fragment,{children:[f.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:r}),f.jsx(JT.Slot,{scope:n,children:f.jsx(vi.div,{"data-radix-select-viewport":"",role:"presentation",...s,ref:o,style:{position:"relative",flex:1,overflow:"hidden auto",...s.style},onScroll:Wt(s.onScroll,c=>{const u=c.currentTarget,{contentWrapper:d,shouldExpandOnScrollRef:h}=a;if(h!=null&&h.current&&d){const m=Math.abs(l.current-u.scrollTop);if(m>0){const y=window.innerHeight-mc*2,b=parseFloat(d.style.minHeight),v=parseFloat(d.style.height),x=Math.max(b,v);if(x<y){const w=x+m,S=Math.min(y,w),C=w-S;d.style.height=S+"px",d.style.bottom==="0px"&&(u.scrollTop=C>0?C:0,d.style.justifyContent="flex-end")}}}l.current=u.scrollTop})})})]})});ooe.displayName=uP;var loe="SelectGroup",[GZe,KZe]=hb(loe),YZe=T.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,s=aa();return f.jsx(GZe,{scope:n,id:s,children:f.jsx(vi.div,{role:"group","aria-labelledby":s,...r,ref:t})})});YZe.displayName=loe;var coe="SelectLabel",ZZe=T.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,s=KZe(coe,n);return f.jsx(vi.div,{id:s.id,...r,ref:t})});ZZe.displayName=coe;var eE="SelectItem",[XZe,uoe]=hb(eE),doe=T.forwardRef((e,t)=>{const{__scopeSelect:n,value:r,disabled:s=!1,textValue:i,...a}=e,o=ep(eE,n),l=tp(eE,n),c=o.value===r,[u,d]=T.useState(i??""),[h,m]=T.useState(!1),y=Rn(t,w=>{var S;return(S=l.itemRefCallback)==null?void 0:S.call(l,w,r,s)}),b=aa(),v=T.useRef("touch"),x=()=>{s||(o.onValueChange(r),o.onOpenChange(!1))};if(r==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return f.jsx(XZe,{scope:n,value:r,disabled:s,textId:b,isSelected:c,onItemTextChange:T.useCallback(w=>{d(S=>S||((w==null?void 0:w.textContent)??"").trim())},[]),children:f.jsx(JT.ItemSlot,{scope:n,value:r,disabled:s,textValue:u,children:f.jsx(vi.div,{role:"option","aria-labelledby":b,"data-highlighted":h?"":void 0,"aria-selected":c&&h,"data-state":c?"checked":"unchecked","aria-disabled":s||void 0,"data-disabled":s?"":void 0,tabIndex:s?void 0:-1,...a,ref:y,onFocus:Wt(a.onFocus,()=>m(!0)),onBlur:Wt(a.onBlur,()=>m(!1)),onClick:Wt(a.onClick,()=>{v.current!=="mouse"&&x()}),onPointerUp:Wt(a.onPointerUp,()=>{v.current==="mouse"&&x()}),onPointerDown:Wt(a.onPointerDown,w=>{v.current=w.pointerType}),onPointerMove:Wt(a.onPointerMove,w=>{var S;v.current=w.pointerType,s?(S=l.onItemLeave)==null||S.call(l):v.current==="mouse"&&w.currentTarget.focus({preventScroll:!0})}),onPointerLeave:Wt(a.onPointerLeave,w=>{var S;w.currentTarget===document.activeElement&&((S=l.onItemLeave)==null||S.call(l))}),onKeyDown:Wt(a.onKeyDown,w=>{var C;((C=l.searchRef)==null?void 0:C.current)!==""&&w.key===" "||(OZe.includes(w.key)&&x(),w.key===" "&&w.preventDefault())})})})})});doe.displayName=eE;var lx="SelectItemText",foe=T.forwardRef((e,t)=>{const{__scopeSelect:n,className:r,style:s,...i}=e,a=ep(lx,n),o=tp(lx,n),l=uoe(lx,n),c=BZe(lx,n),[u,d]=T.useState(null),h=Rn(t,x=>d(x),l.onItemTextChange,x=>{var w;return(w=o.itemTextRefCallback)==null?void 0:w.call(o,x,l.value,l.disabled)}),m=u==null?void 0:u.textContent,y=T.useMemo(()=>f.jsx("option",{value:l.value,disabled:l.disabled,children:m},l.value),[l.disabled,l.value,m]),{onNativeOptionAdd:b,onNativeOptionRemove:v}=c;return ni(()=>(b(y),()=>v(y)),[b,v,y]),f.jsxs(f.Fragment,{children:[f.jsx(vi.span,{id:l.textId,...i,ref:h}),l.isSelected&&a.valueNode&&!a.valueNodeHasChildren?al.createPortal(i.children,a.valueNode):null]})});foe.displayName=lx;var hoe="SelectItemIndicator",poe=T.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e;return uoe(hoe,n).isSelected?f.jsx(vi.span,{"aria-hidden":!0,...r,ref:t}):null});poe.displayName=hoe;var dP="SelectScrollUpButton",moe=T.forwardRef((e,t)=>{const n=tp(dP,e.__scopeSelect),r=w5(dP,e.__scopeSelect),[s,i]=T.useState(!1),a=Rn(t,r.onScrollButtonChange);return ni(()=>{if(n.viewport&&n.isPositioned){let o=function(){const c=l.scrollTop>0;i(c)};const l=n.viewport;return o(),l.addEventListener("scroll",o),()=>l.removeEventListener("scroll",o)}},[n.viewport,n.isPositioned]),s?f.jsx(yoe,{...e,ref:a,onAutoScroll:()=>{const{viewport:o,selectedItem:l}=n;o&&l&&(o.scrollTop=o.scrollTop-l.offsetHeight)}}):null});moe.displayName=dP;var fP="SelectScrollDownButton",goe=T.forwardRef((e,t)=>{const n=tp(fP,e.__scopeSelect),r=w5(fP,e.__scopeSelect),[s,i]=T.useState(!1),a=Rn(t,r.onScrollButtonChange);return ni(()=>{if(n.viewport&&n.isPositioned){let o=function(){const c=l.scrollHeight-l.clientHeight,u=Math.ceil(l.scrollTop)<c;i(u)};const l=n.viewport;return o(),l.addEventListener("scroll",o),()=>l.removeEventListener("scroll",o)}},[n.viewport,n.isPositioned]),s?f.jsx(yoe,{...e,ref:a,onAutoScroll:()=>{const{viewport:o,selectedItem:l}=n;o&&l&&(o.scrollTop=o.scrollTop+l.offsetHeight)}}):null});goe.displayName=fP;var yoe=T.forwardRef((e,t)=>{const{__scopeSelect:n,onAutoScroll:r,...s}=e,i=tp("SelectScrollButton",n),a=T.useRef(null),o=QT(n),l=T.useCallback(()=>{a.current!==null&&(window.clearInterval(a.current),a.current=null)},[]);return T.useEffect(()=>()=>l(),[l]),ni(()=>{var u;const c=o().find(d=>d.ref.current===document.activeElement);(u=c==null?void 0:c.ref.current)==null||u.scrollIntoView({block:"nearest"})},[o]),f.jsx(vi.div,{"aria-hidden":!0,...s,ref:t,style:{flexShrink:0,...s.style},onPointerDown:Wt(s.onPointerDown,()=>{a.current===null&&(a.current=window.setInterval(r,50))}),onPointerMove:Wt(s.onPointerMove,()=>{var c;(c=i.onItemLeave)==null||c.call(i),a.current===null&&(a.current=window.setInterval(r,50))}),onPointerLeave:Wt(s.onPointerLeave,()=>{l()})})}),JZe="SelectSeparator",QZe=T.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e;return f.jsx(vi.div,{"aria-hidden":!0,...r,ref:t})});QZe.displayName=JZe;var hP="SelectArrow",eXe=T.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,s=eA(n),i=ep(hP,n),a=tp(hP,n);return i.open&&a.position==="popper"?f.jsx(WYe,{...s,...r,ref:t}):null});eXe.displayName=hP;var tXe="SelectBubbleInput",boe=T.forwardRef(({__scopeSelect:e,value:t,...n},r)=>{const s=T.useRef(null),i=Rn(r,s),a=YT(t);return T.useEffect(()=>{const o=s.current;if(!o)return;const l=window.HTMLSelectElement.prototype,u=Object.getOwnPropertyDescriptor(l,"value").set;if(a!==t&&u){const d=new Event("change",{bubbles:!0});u.call(o,t),o.dispatchEvent(d)}},[a,t]),f.jsx(vi.select,{...n,style:{...zae,...n.style},ref:i,defaultValue:t})});boe.displayName=tXe;function voe(e){return e===""||e===void 0}function xoe(e){const t=ks(e),n=T.useRef(""),r=T.useRef(0),s=T.useCallback(a=>{const o=n.current+a;t(o),function l(c){n.current=c,window.clearTimeout(r.current),c!==""&&(r.current=window.setTimeout(()=>l(""),1e3))}(o)},[t]),i=T.useCallback(()=>{n.current="",window.clearTimeout(r.current)},[]);return T.useEffect(()=>()=>window.clearTimeout(r.current),[]),[n,s,i]}function woe(e,t,n){const s=t.length>1&&Array.from(t).every(c=>c===t[0])?t[0]:t,i=n?e.indexOf(n):-1;let a=nXe(e,Math.max(i,0));s.length===1&&(a=a.filter(c=>c!==n));const l=a.find(c=>c.textValue.toLowerCase().startsWith(s.toLowerCase()));return l!==n?l:void 0}function nXe(e,t){return e.map((n,r)=>e[(t+r)%e.length])}var rXe=Zae,sXe=Jae,iXe=eoe,aXe=toe,oXe=noe,lXe=roe,cXe=ooe,uXe=doe,dXe=foe,fXe=poe,hXe=moe,pXe=goe;function np({...e}){return f.jsx(rXe,{"data-slot":"select",...e})}function rp({...e}){return f.jsx(iXe,{"data-slot":"select-value",...e})}function sp({className:e,size:t="default",children:n,...r}){return f.jsxs(sXe,{"data-slot":"select-trigger","data-size":t,className:Ze("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...r,children:[n,f.jsx(aXe,{asChild:!0,children:f.jsx(Jl,{className:"size-4 opacity-50"})})]})}function ip({className:e,children:t,position:n="popper",...r}){return f.jsx(oXe,{children:f.jsxs(lXe,{"data-slot":"select-content",className:Ze("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md",n==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:n,...r,children:[f.jsx(mXe,{}),f.jsx(cXe,{className:Ze("p-1",n==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:t}),f.jsx(gXe,{})]})})}function To({className:e,children:t,...n}){return f.jsxs(uXe,{"data-slot":"select-item",className:Ze("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",e),...n,children:[f.jsx("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:f.jsx(fXe,{children:f.jsx(so,{className:"size-4"})})}),f.jsx(dXe,{children:t})]})}function mXe({className:e,...t}){return f.jsx(hXe,{"data-slot":"select-scroll-up-button",className:Ze("flex cursor-default items-center justify-center py-1",e),...t,children:f.jsx(Lh,{className:"size-4"})})}function gXe({className:e,...t}){return f.jsx(pXe,{"data-slot":"select-scroll-down-button",className:Ze("flex cursor-default items-center justify-center py-1",e),...t,children:f.jsx(Jl,{className:"size-4"})})}var yXe=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],bXe=yXe.reduce((e,t)=>{const n=Au(`Primitive.${t}`),r=T.forwardRef((s,i)=>{const{asChild:a,...o}=s,l=a?n:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),f.jsx(l,{...o,ref:i})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{}),vXe="Label",_oe=T.forwardRef((e,t)=>f.jsx(bXe.label,{...e,ref:t,onMouseDown:n=>{var s;n.target.closest("button, input, select, textarea")||((s=e.onMouseDown)==null||s.call(e,n),!n.defaultPrevented&&n.detail>1&&n.preventDefault())}}));_oe.displayName=vXe;var xXe=_oe;function It({className:e,...t}){return f.jsx(xXe,{"data-slot":"label",className:Ze("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",e),...t})}const Ni=({field:e,className:t})=>e.state.meta.isTouched&&e.state.meta.errors.length>0?f.jsx("em",{className:`text-xs text-destructive mt-1 block ${t||""}`,children:e.state.meta.errors.map(r=>typeof r=="string"?r:typeof r=="object"&&r!==null&&"message"in r&&typeof r.message=="string"?r.message:(console.warn("[GlobalFieldMetaMessages] Encountered an unexpected error structure:",r),"Validation error")).join(", ")}):null,wXe=wo.map(e=>e.value),m2=Ke({keyName:$e().min(1,"Key Name is required."),providerType:bl(wXe,{errorMap:()=>({message:"Provider Type is required."})}),keyValue:$e().min(1,"API Key Value is required.")}),Soe=({initialProviderType:e=null,initialName:t="",initialValue:n="",onSave:r,onCancel:s,disabled:i=!1,className:a})=>{const o=T.useRef(null),l=ri({defaultValues:{keyName:t,providerType:e,keyValue:n},validators:{onChangeAsync:m2,onChangeAsyncDebounceMs:500},onSubmit:async({value:u})=>{await r(u.keyName,u.providerType,u.keyValue)}});T.useEffect(()=>{l.reset({keyName:t,providerType:e,keyValue:n})},[t,n,e,l]);const c=(u,d)=>{var b,v;if(!u)return;const h=(b=wo.find(x=>x.value===u))==null?void 0:b.label,m=l.getFieldValue("providerType"),y=(v=wo.find(x=>x.value===m))==null?void 0:v.label;h&&(!(d!=null&&d.trim())||d===y)&&l.setFieldValue("keyName",h),requestAnimationFrame(()=>{var x;(x=o.current)==null||x.focus()})};return f.jsxs("form",{onSubmit:u=>{u.preventDefault(),u.stopPropagation(),l.handleSubmit()},className:Ze("space-y-6",a),children:[f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[f.jsx(l.Field,{name:"providerType",validators:{onChange:m2.shape.providerType},children:u=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(It,{htmlFor:u.name,children:"Provider Type"}),f.jsxs(np,{value:u.state.value??"",onValueChange:d=>{const h=d;u.handleChange(h),u.handleBlur(),c(h,l.getFieldValue("keyName"))},disabled:i||l.state.isSubmitting,children:[f.jsx(sp,{id:u.name,children:f.jsx(rp,{placeholder:"Select Provider Type"})}),f.jsx(ip,{children:wo.map(d=>f.jsx(To,{value:d.value,children:d.label},d.value))})]}),f.jsx(Ni,{field:u})]})}),f.jsx(l.Field,{name:"keyName",validators:{onChange:m2.shape.keyName},children:u=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(It,{htmlFor:u.name,children:"Key Name"}),f.jsx(_n,{id:u.name,value:u.state.value??"",onChange:d=>u.handleChange(d.target.value),onBlur:u.handleBlur,placeholder:"e.g., My OpenAI Key",disabled:i||l.state.isSubmitting}),f.jsx(Ni,{field:u})]})}),f.jsx(l.Field,{name:"keyValue",validators:{onChange:m2.shape.keyValue},children:u=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(It,{htmlFor:u.name,children:"API Key Value"}),f.jsx(_n,{ref:o,id:u.name,type:"password",value:u.state.value??"",onChange:d=>u.handleChange(d.target.value),onBlur:u.handleBlur,placeholder:"Enter your API key",disabled:i||l.state.isSubmitting,autoComplete:"new-password"}),f.jsx(Ni,{field:u})]})})]}),f.jsxs("div",{className:"flex justify-end space-x-2 pt-2",children:[f.jsxs(ft,{variant:"ghost",size:"sm",onClick:s,disabled:i||l.state.isSubmitting,type:"button",children:[f.jsx(qi,{className:"h-4 w-4 mr-1"})," Cancel"]}),f.jsx(l.Subscribe,{selector:u=>[u.canSubmit,u.isSubmitting,u.isValidating,u.isValid],children:([u,d,h,m])=>f.jsxs(ft,{type:"submit",size:"sm",disabled:i||!u||d||h||!m,children:[(d||h)&&f.jsx(Qn,{className:"h-4 w-4 mr-1 animate-spin"}),f.jsx(Qd,{className:"h-4 w-4 mr-1"}),d||h?"Saving...":"Save API Key"]})})]})]})},_Xe=({className:e,label:t,selectedKeyId:n,onKeySelected:r,apiKeys:s,disabled:i=!1})=>{var c;const a=u=>{r(u==="none"?null:u)},o=(c=s.find(u=>u.id===n))==null?void 0:c.name,l=n?o||`Key ID: ${n.substring(0,6)}...`:"None";return f.jsxs(np,{value:n??"none",onValueChange:a,disabled:i||s.length===0,children:[f.jsx(sp,{className:Ze("w-full h-9 text-sm bg-background border-border text-foreground",e),"aria-label":t||"Select API Key",children:f.jsx(rp,{asChild:!0,children:f.jsxs("div",{className:"flex items-center overflow-hidden",children:[f.jsx(Bx,{className:"h-3 w-3 mr-1.5 text-muted-foreground flex-shrink-0"}),f.jsxs("span",{className:"truncate flex-grow text-left",children:[t&&f.jsxs("span",{className:"mr-1",children:[t,":"]}),s.length===0?f.jsx("span",{className:"text-muted-foreground",children:"No keys available"}):l]})]})})}),f.jsxs(ip,{className:"bg-popover border-border text-popover-foreground",children:[f.jsx(To,{value:"none",children:f.jsx("span",{className:"text-muted-foreground",children:"None"})}),s.map(u=>f.jsx(To,{value:u.id,children:u.name||`Key ID: ${u.id.substring(0,6)}...`},u.id))]})]})};function Xw({form:e,name:t,label:n,type:r="text",placeholder:s,disabled:i,wrapperClassName:a,className:o,...l}){return f.jsx(e.Field,{name:t,children:c=>{const u=typeof c.state.value=="string"||typeof c.state.value=="number"?String(c.state.value):"";return f.jsxs("div",{className:Ze("space-y-1.5",a),children:[f.jsx(It,{htmlFor:c.name,className:"text-sm",children:n}),f.jsx(_n,{id:c.name,name:c.name,type:r,value:u,onBlur:c.handleBlur,onChange:d=>c.handleChange(d.target.value),placeholder:s,disabled:i??c.form.state.isSubmitting,className:Ze(o,c.state.meta.errors.length?"border-destructive":""),...l}),f.jsx(Ni,{field:c})]})}})}function jx({form:e,name:t,label:n,options:r,placeholder:s,disabled:i,wrapperClassName:a,triggerClassName:o,contentClassName:l,...c}){return f.jsx(e.Field,{name:t,children:u=>{const d=u.state.value!==null&&u.state.value!==void 0?String(u.state.value):"";return f.jsxs("div",{className:Ze("space-y-1.5",a),children:[f.jsx(It,{htmlFor:u.name,className:"text-sm",children:n}),f.jsxs(np,{value:d,onValueChange:h=>u.handleChange(h),disabled:i??u.form.state.isSubmitting,...c,children:[f.jsx(sp,{id:u.name,onBlur:u.handleBlur,className:Ze(o,u.state.meta.errors.length?"border-destructive":""),children:f.jsx(rp,{placeholder:s})}),f.jsx(ip,{className:l,children:r.map(h=>f.jsx(To,{value:String(h.value),disabled:h.disabled,children:h.label},h.value))})]}),f.jsx(Ni,{field:u})]})}})}var SXe=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Coe=SXe.reduce((e,t)=>{const n=Au(`Primitive.${t}`),r=T.forwardRef((s,i)=>{const{asChild:a,...o}=s,l=a?n:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),f.jsx(l,{...o,ref:i})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{}),tA="Switch",[CXe,vdt]=Hi(tA),[kXe,EXe]=CXe(tA),koe=T.forwardRef((e,t)=>{const{__scopeSwitch:n,name:r,checked:s,defaultChecked:i,required:a,disabled:o,value:l="on",onCheckedChange:c,form:u,...d}=e,[h,m]=T.useState(null),y=Rn(t,S=>m(S)),b=T.useRef(!1),v=h?u||!!h.closest("form"):!0,[x,w]=Pc({prop:s,defaultProp:i??!1,onChange:c,caller:tA});return f.jsxs(kXe,{scope:n,checked:x,disabled:o,children:[f.jsx(Coe.button,{type:"button",role:"switch","aria-checked":x,"aria-required":a,"data-state":Roe(x),"data-disabled":o?"":void 0,disabled:o,value:l,...d,ref:y,onClick:Wt(e.onClick,S=>{w(C=>!C),v&&(b.current=S.isPropagationStopped(),b.current||S.stopPropagation())})}),v&&f.jsx(Aoe,{control:h,bubbles:!b.current,name:r,value:l,checked:x,required:a,disabled:o,form:u,style:{transform:"translateX(-100%)"}})]})});koe.displayName=tA;var Eoe="SwitchThumb",Toe=T.forwardRef((e,t)=>{const{__scopeSwitch:n,...r}=e,s=EXe(Eoe,n);return f.jsx(Coe.span,{"data-state":Roe(s.checked),"data-disabled":s.disabled?"":void 0,...r,ref:t})});Toe.displayName=Eoe;var TXe="SwitchBubbleInput",Aoe=T.forwardRef(({__scopeSwitch:e,control:t,checked:n,bubbles:r=!0,...s},i)=>{const a=T.useRef(null),o=Rn(a,i),l=YT(n),c=$y(t);return T.useEffect(()=>{const u=a.current;if(!u)return;const d=window.HTMLInputElement.prototype,m=Object.getOwnPropertyDescriptor(d,"checked").set;if(l!==n&&m){const y=new Event("click",{bubbles:r});m.call(u,n),u.dispatchEvent(y)}},[l,n,r]),f.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:n,...s,tabIndex:-1,ref:o,style:{...s.style,...c,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});Aoe.displayName=TXe;function Roe(e){return e?"checked":"unchecked"}var AXe=koe,RXe=Toe;function Io({className:e,...t}){return f.jsx(AXe,{"data-slot":"switch",className:Ze("peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",e),...t,children:f.jsx(RXe,{"data-slot":"switch-thumb",className:Ze("bg-background dark:data-[state=unchecked]:bg-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0")})})}function Zp({form:e,name:t,label:n,description:r,disabled:s,wrapperClassName:i,className:a,labelClassName:o,...l}){return f.jsx(e.Field,{name:t,children:c=>{const u=typeof c.state.value=="boolean"?c.state.value:!1;return f.jsxs("div",{className:Ze("space-y-1.5",i),children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx(It,{htmlFor:c.name,className:Ze("text-sm font-medium leading-none cursor-pointer",o),children:n}),f.jsx(Io,{id:c.name,name:c.name,checked:u,onCheckedChange:d=>c.handleChange(d),onBlur:c.handleBlur,disabled:s??c.form.state.isSubmitting,className:Ze(a,c.state.meta.errors.length?"border-destructive":""),...l})]}),r&&f.jsx("p",{className:"text-xs text-muted-foreground pt-1",children:r}),f.jsx(Ni,{field:c})]})}})}const NXe=wo.map(e=>e.value),MXe=Ke({name:$e().min(1,"Provider Name is required."),type:bl(NXe,{errorMap:()=>({message:"Provider Type is required."})}),isEnabled:br(),apiKeyId:$e().nullable(),baseURL:$e().url().nullable().or(An("")),autoFetchModels:br()}).refine(e=>MC(e.type)?!(!e.baseURL||e.baseURL.trim()===""):!0,{message:"Base URL is required and must be a valid URL for this provider type.",path:["baseURL"]}).refine(e=>J0(e.type)?!!e.apiKeyId:!0,{message:"API Key is required for this provider type.",path:["apiKeyId"]}),IXe=wo.map(e=>({value:e.value,label:e.label})),Noe=({initialData:e,onSubmit:t,onChange:n,onCancel:r,apiKeys:s,isSavingExt:i=!1,disabled:a=!1,className:o})=>{var v;const l=ri({defaultValues:{name:(e==null?void 0:e.name)||"",type:(e==null?void 0:e.type)||((v=wo[0])==null?void 0:v.value),isEnabled:(e==null?void 0:e.isEnabled)??!0,apiKeyId:(e==null?void 0:e.apiKeyId)||null,baseURL:(e==null?void 0:e.baseURL)||null,autoFetchModels:(e==null?void 0:e.autoFetchModels)??!1},validators:{onChangeAsync:MXe,onChangeAsyncDebounceMs:500},onSubmit:async({value:x})=>{const w={...x,baseURL:(x.baseURL===null||typeof x.baseURL=="string"&&x.baseURL.trim()==="")&&!MC(x.type)?null:x.baseURL};await t(w)}}),c=T.useRef(l.state.values);T.useEffect(()=>{const x=l.store.subscribe(()=>{const w=l.state.values,S=c.current;if(n&&S)for(const C in w){const k=C;w[k]!==S[k]&&n(k,w[k])}c.current={...w}});return l.state.values!==c.current&&(c.current=l.state.values),x},[l,n]),T.useEffect(()=>{var S,C;const x=(e==null?void 0:e.type)||((S=wo[0])==null?void 0:S.value),w={name:(e==null?void 0:e.name)||((C=wo.find(k=>k.value===x))==null?void 0:C.label)||"",type:x,isEnabled:(e==null?void 0:e.isEnabled)??!0,apiKeyId:(e==null?void 0:e.apiKeyId)||null,baseURL:(e==null?void 0:e.baseURL)||null,autoFetchModels:(e==null?void 0:e.autoFetchModels)??cm(x)};l.reset(w),c.current=w},[e]);const u=l.state.values.type,d=J0(u??null),h=MC(u??null),m=cm(u??null),y=T.useCallback(x=>{var S,C;if(!x)return;const w=l.state.values.type;if(x!==w){l.setFieldValue("apiKeyId",null),l.setFieldValue("baseURL",null),l.setFieldValue("autoFetchModels",cm(x));const k=(S=wo.find(N=>N.value===x))==null?void 0:S.label,A=(C=wo.find(N=>N.value===w))==null?void 0:C.label,R=l.state.values.name;k&&(!(R!=null&&R.trim())||R===A)&&l.setFieldValue("name",k)}},[l]);T.useEffect(()=>{const x=l.state.values.type;x!==void 0&&y(x)},[l.state.values.type,y]);const b=(s||[]).filter(x=>!u||x.providerId===u);return f.jsxs("form",{onSubmit:x=>{x.preventDefault(),x.stopPropagation(),l.handleSubmit()},className:Ze("space-y-4 border rounded-md p-4 bg-card shadow-sm",o),children:[f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-4 gap-y-3",children:[f.jsx(jx,{form:l,name:"type",label:"Provider Type",options:IXe,disabled:a||i,placeholder:"Select Type",wrapperClassName:"md:col-span-1"}),f.jsx(Xw,{form:l,name:"name",label:"Provider Name",placeholder:"e.g., My Ollama",disabled:a||i,"aria-label":"Provider Name",wrapperClassName:"md:col-span-1"}),d&&f.jsx(l.Field,{name:"apiKeyId",children:x=>f.jsxs("div",{className:"space-y-1.5 md:col-span-2",children:[f.jsx(It,{htmlFor:`${x.name}-trigger`,children:"API Key"})," ",f.jsx(_Xe,{selectedKeyId:x.state.value??null,onKeySelected:w=>{x.handleChange(w),x.handleBlur()},apiKeys:b,disabled:a||i||!u}),f.jsx(Ni,{field:x})]})}),h&&f.jsx(Xw,{form:l,name:"baseURL",label:"Base URL",placeholder:"e.g., http://localhost:11434",type:"url",disabled:a||i||!u,wrapperClassName:"md:col-span-2"}),m&&f.jsx(Zp,{form:l,name:"autoFetchModels",label:"Auto-Fetch Models",description:"Automatically fetch and update the list of available models from this provider.",disabled:a||i||!u,wrapperClassName:"md:col-span-2"}),f.jsx(Zp,{form:l,name:"isEnabled",label:"Enable Provider",description:"Allow this provider to be used for generating responses.",disabled:a||i,wrapperClassName:"md:col-span-2"})]}),f.jsxs("div",{className:"flex justify-end space-x-2 pt-2",children:[f.jsxs(ft,{variant:"ghost",size:"sm",onClick:r,disabled:a||i,type:"button",children:[f.jsx(qi,{className:"h-4 w-4 mr-1"})," Cancel"]}),f.jsx(l.Subscribe,{selector:x=>[x.canSubmit,x.isSubmitting,x.isValidating,x.isValid],children:([x,w,S,C])=>f.jsxs(ft,{type:"submit",size:"sm",disabled:a||i||!x||w||!C||S,children:[(i||w||S)&&f.jsx(Qn,{className:"h-4 w-4 mr-1 animate-spin"}),f.jsx(Qd,{className:"h-4 w-4 mr-1"})," ",i||w||S?"Saving...":e!=null&&e.name?"Save Changes":"Add Provider"]})})]})]})},Moe=({apiKeys:e,onAddProvider:t,onCancel:n,initialType:r="openai",initialName:s="",initialApiKeyId:i=null})=>{const[a,o]=T.useState(!1),[l,c]=T.useState({name:s,type:r,isEnabled:!0,apiKeyId:i,baseURL:null,autoFetchModels:cm(r)});T.useEffect(()=>{c(h=>({...h,name:s||h.name||"",type:r||h.type||null,apiKeyId:i||h.apiKeyId||null,autoFetchModels:!1}))},[s,r,i]);const u=T.useCallback((h,m)=>new Promise(y=>{c(b=>{var w,S;const v={...b,[h]:m},x=b.name||"";if(h==="type"){const C=m,k=(w=wo.find(R=>R.value===b.type))==null?void 0:w.label;v.apiKeyId=null,v.baseURL=null,v.autoFetchModels=C?cm(C):!1;const A=(S=wo.find(R=>R.value===C))==null?void 0:S.label;if(A&&(!x.trim()||x===k)&&(v.name=A),C&&J0(C)){const R=(e||[]).filter(N=>N.providerId===C);R.length>0&&(v.apiKeyId=R[0].id)}}return v}),y(void 0)}),[e]),d=T.useCallback(async()=>{var h,m;if(!((h=l.name)!=null&&h.trim())||!l.type){je.error("Provider Name and Type are required.");return}o(!0);try{const y=l.type,b=l.autoFetchModels??cm(y),v={name:l.name.trim(),type:y,isEnabled:l.isEnabled??!0,apiKeyId:l.apiKeyId??null,baseURL:((m=l.baseURL)==null?void 0:m.trim())||null,enabledModels:null,autoFetchModels:b,fetchedModels:null,modelsLastFetchedAt:null};await t(v),n()}catch(y){console.error("Failed to add provider (from form component):",y)}finally{o(!1)}},[l,t,n]);return f.jsxs("div",{className:"border border-primary rounded-md p-4 space-y-3 bg-card shadow-lg flex-shrink-0",children:[f.jsx("h4",{className:"font-semibold text-card-foreground",children:"Add New Provider"}),f.jsx(Noe,{initialData:l,onSubmit:d,onCancel:n,onChange:u,apiKeys:e,disabled:a})]})},kd=We.forwardRef(({className:e,href:t,children:n,...r},s)=>f.jsx("a",{ref:s,href:t,target:"_blank",rel:"noopener noreferrer",className:Ze("font-medium text-primary underline-offset-4 hover:underline focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...r,children:n}));kd.displayName="Lnk";const jXe=e=>{const{size:t=24,color:n="currentColor",...r}=e;return f.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:t,height:t,viewBox:"0 0 512 512",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",...r,children:[f.jsx("g",{transform:"translate(0.000000,512.000000) scale(0.100000,-0.100000)",fill:n,stroke:"none",children:f.jsx("path",{d:`M2310 5053 c-1035 -101 -1883 -794 -2159 -1764 -55 -194 -79 -338
-91 -552 -18 -323 20 -620 117 -907 92 -272 238 -543 404 -747 33 -39 59 -75
59 -78 0 -4 -49 -129 -109 -279 -252 -624 -251 -621 -196 -676 57 -56 73 -53
351 58 137 55 349 143 472 195 l223 95 77 -38 c221 -109 437 -179 680 -219
132 -23 411 -44 475 -37 23 3 85 8 137 11 404 26 806 168 1180 417 282 188
571 489 759 792 400 642 467 1498 174 2216 -179 439 -495 826 -888 1088 -361
239 -743 378 -1165 422 -88 9 -419 11 -500 3z m404 -463 c-1 -30 -17 -128 -36
-217 l-34 -163 137 0 c128 0 139 -1 149 -20 11 -21 4 -44 -22 -72 -7 -7 -68
-75 -135 -150 l-123 -136 0 -175 0 -175 238 -4 c265 -5 329 -16 469 -82 220
-105 414 -311 486 -519 l24 -68 86 -4 c129 -7 195 -43 236 -130 20 -42 21 -61
21 -300 0 -240 -1 -258 -21 -297 -46 -90 -115 -127 -235 -128 l-82 0 -11 -47
c-17 -66 -71 -179 -119 -250 -108 -159 -276 -293 -452 -361 -174 -66 -251 -72
-830 -63 l-475 8 -89 27 c-303 91 -554 328 -650 614 l-23 67 -89 5 c-98 6
-131 20 -180 72 -63 66 -64 72 -64 354 0 240 1 261 21 301 40 84 105 119 232
129 l84 7 32 80 c84 215 291 424 513 519 126 53 225 68 466 68 l212 0 0 268 0
267 -126 -3 c-108 -3 -129 -1 -145 14 -10 9 -19 25 -19 35 0 9 111 146 246
304 234 273 247 286 277 283 32 -3 32 -3 31 -58z`})}),f.jsxs("g",{transform:"translate(165, 220) scale(2.5)",children:[f.jsx("path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",fill:"none",stroke:n,strokeWidth:"4"}),f.jsx("circle",{cx:"12",cy:"12",r:"3",fill:"none",stroke:n,strokeWidth:"4"})]}),f.jsxs("g",{transform:"translate(290, 220) scale(2.5)",children:[f.jsx("path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",fill:"none",stroke:n,strokeWidth:"4"}),f.jsx("circle",{cx:"12",cy:"12",r:"3",fill:"none",stroke:n,strokeWidth:"4"})]}),f.jsx("g",{transform:"translate(0.000000,512.000000) scale(0.100000,-0.100000)",fill:n,stroke:"none",children:f.jsx("path",{d:`M2147 1999 c-26 -15 -48 -65 -41 -94 15 -61 181 -167 304 -196 30 -7
100 -12 155 -12 81 1 115 6 178 27 135 45 247 133 249 194 2 60 -48 103 -104
88 -13 -3 -50 -25 -83 -50 -85 -64 -172 -90 -280 -84 -92 6 -165 35 -259 103
-49 35 -86 43 -119 24z`})})]})},PXe=NP("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function is({className:e,variant:t,asChild:n=!1,...r}){const s=n?HW:"span";return f.jsx(s,{"data-slot":"badge",className:Ze(PXe({variant:t}),e),...r})}const OXe=()=>{const[e,t]=T.useState(!1);T.useEffect(()=>{t(!0)},[]);const n={hidden:{opacity:0},show:{opacity:1,transition:{staggerChildren:.2,delayChildren:.3}}},r={hidden:{opacity:0,y:20},show:{opacity:1,y:0,transition:{duration:.5}}},s=[{word:"LiteChat",color:"bg-gradient-to-tr from-lime-500 via-amber-400 to-red-600 bg-clip-text text-transparent"},{word:"library",color:"text-emerald-500"},{word:"browser",color:"text-violet-500"},{word:"local",color:"text-amber-500"},{word:"remote",color:"text-sky-500"},{word:"providers",color:"text-purple-500"},{word:" AI ",color:"bg-gradient-to-b from-amber-300 to-rose-700 bg-clip-text text-transparent"},{word:"Open Source",color:"bg-gradient-to-r from-lime-500 to-yellow-500 bg-clip-text text-transparent"}],i=o=>{let l=[o];return s.forEach(({word:c,color:u})=>{l=l.reduce((d,h)=>typeof h!="string"?(d.push(h),d):(h.split(new RegExp(`(${c})`,"gi")).forEach((y,b)=>{y.toLowerCase()===c.toLowerCase()?d.push(f.jsx("span",{className:`${u} font-medium`,children:y},`${y}-${b}`)):d.push(y)}),d),[])}),l=l.reduce((c,u,d)=>{if(typeof u!="string")return c.push(u),c;const h=/(\([^)]*\))/g;return u.split(h).forEach((y,b)=>{h.test(y)?c.push(f.jsx("span",{className:"text-sm text-muted",children:y},`paren-${d}-${b}`)):c.push(y)}),c},[]),l},a=["Oh, hey?! Hi there!! How are you doing!?","Nice of you to pop by to checkout LiteChat!","What'd you mean you don't know what LiteChat is? Oh Boy hey, you in for a treat!","To start with, it's an(other) AI chat app (yes...shocker, right ?) and it's Open Source ! ","But, it is also an extensible library, so you can go on and create your own, AI chat app! With your own functionnalities !","(are AI chat apps the new JS frameworks?)","And cause I might be a wee bit on the reluctant side when it comes to parting with my coins, it doesn't require no servers! It all stays in your browser.","(that means I couldn't snoop on what you do here, even if I wanted to!)","While able to run LLM both local (did I tell you I ain't liking throwing coins out?) and from remote providers","(but sometimes you have to :(..)","To cap things off, there is no fancy/crazy tech involved, I just glued bricks together with AI","(kids call it vibing apparently ^^)","Enough of this interminable babble! Go setup your future chat to prompt your brains out!"];return f.jsxs(du.div,{className:"text-center max-w-4xl mx-auto space-y-3 my-6",initial:"hidden",animate:e?"show":"hidden",variants:n,children:[f.jsx("div",{className:"flex justify-center mb-4",children:f.jsxs(is,{variant:"outline",className:"px-3 py-1 bg-black/5 dark:bg-white/10 backdrop-blur-sm border-none",children:[f.jsx(gH,{className:"w-4 h-4 mr-2 text-yellow-500"}),f.jsx("span",{className:"text-sm",children:"Welcome to your future AI chat"})]})}),a.map((o,l)=>f.jsx(du.p,{className:`text-sm md:text-base ${l===0?"font-medium":""} leading-relaxed`,variants:r,children:i(o)},l)),f.jsxs(du.div,{variants:r,className:"pt-2",children:[f.jsx(is,{className:"bg-gradient-to-r from-violet-600 to-primary border-none",children:"No server required!"}),f.jsx(is,{className:"ml-2 bg-gradient-to-r from-amber-500 to-emerald-500 border-none",children:"100% in-browser"})]})]})};var _5="Progress",S5=100,[DXe,xdt]=Hi(_5),[FXe,LXe]=DXe(_5),Ioe=T.forwardRef((e,t)=>{const{__scopeProgress:n,value:r=null,max:s,getValueLabel:i=BXe,...a}=e;(s||s===0)&&!OV(s)&&console.error($Xe(`${s}`,"Progress"));const o=OV(s)?s:S5;r!==null&&!DV(r,o)&&console.error(zXe(`${r}`,"Progress"));const l=DV(r,o)?r:null,c=tE(l)?i(l,o):void 0;return f.jsx(FXe,{scope:n,value:l,max:o,children:f.jsx(ar.div,{"aria-valuemax":o,"aria-valuemin":0,"aria-valuenow":tE(l)?l:void 0,"aria-valuetext":c,role:"progressbar","data-state":Ooe(l,o),"data-value":l??void 0,"data-max":o,...a,ref:t})})});Ioe.displayName=_5;var joe="ProgressIndicator",Poe=T.forwardRef((e,t)=>{const{__scopeProgress:n,...r}=e,s=LXe(joe,n);return f.jsx(ar.div,{"data-state":Ooe(s.value,s.max),"data-value":s.value??void 0,"data-max":s.max,...r,ref:t})});Poe.displayName=joe;function BXe(e,t){return`${Math.round(e/t*100)}%`}function Ooe(e,t){return e==null?"indeterminate":e===t?"complete":"loading"}function tE(e){return typeof e=="number"}function OV(e){return tE(e)&&!isNaN(e)&&e>0}function DV(e,t){return tE(e)&&!isNaN(e)&&e<=t&&e>=0}function $Xe(e,t){return`Invalid prop \`max\` of value \`${e}\` supplied to \`${t}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${S5}\`.`}function zXe(e,t){return`Invalid prop \`value\` of value \`${e}\` supplied to \`${t}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${S5} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var Doe=Ioe,UXe=Poe;const Ny=T.forwardRef(({className:e,value:t,...n},r)=>f.jsx(Doe,{ref:r,className:Ze("relative h-4 w-full overflow-hidden rounded-full bg-secondary",e),...n,children:f.jsx(UXe,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(t||0)}%)`}})}));Ny.displayName=Doe.displayName;var qXe=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],of=qXe.reduce((e,t)=>{const n=Au(`Primitive.${t}`),r=T.forwardRef((s,i)=>{const{asChild:a,...o}=s,l=a?n:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),f.jsx(l,{...o,ref:i})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{});function VXe(e,t){e&&al.flushSync(()=>e.dispatchEvent(t))}var WXe="DismissableLayer",pP="dismissableLayer.update",HXe="dismissableLayer.pointerDownOutside",GXe="dismissableLayer.focusOutside",FV,Foe=T.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Loe=T.forwardRef((e,t)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:s,onFocusOutside:i,onInteractOutside:a,onDismiss:o,...l}=e,c=T.useContext(Foe),[u,d]=T.useState(null),h=(u==null?void 0:u.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,m]=T.useState({}),y=Rn(t,R=>d(R)),b=Array.from(c.layers),[v]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),x=b.indexOf(v),w=u?b.indexOf(u):-1,S=c.layersWithOutsidePointerEventsDisabled.size>0,C=w>=x,k=ZXe(R=>{const N=R.target,I=[...c.branches].some(P=>P.contains(N));!C||I||(s==null||s(R),a==null||a(R),R.defaultPrevented||o==null||o())},h),A=XXe(R=>{const N=R.target;[...c.branches].some(P=>P.contains(N))||(i==null||i(R),a==null||a(R),R.defaultPrevented||o==null||o())},h);return XP(R=>{w===c.layers.size-1&&(r==null||r(R),!R.defaultPrevented&&o&&(R.preventDefault(),o()))},h),T.useEffect(()=>{if(u)return n&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(FV=h.body.style.pointerEvents,h.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(u)),c.layers.add(u),LV(),()=>{n&&c.layersWithOutsidePointerEventsDisabled.size===1&&(h.body.style.pointerEvents=FV)}},[u,h,n,c]),T.useEffect(()=>()=>{u&&(c.layers.delete(u),c.layersWithOutsidePointerEventsDisabled.delete(u),LV())},[u,c]),T.useEffect(()=>{const R=()=>m({});return document.addEventListener(pP,R),()=>document.removeEventListener(pP,R)},[]),f.jsx(of.div,{...l,ref:y,style:{pointerEvents:S?C?"auto":"none":void 0,...e.style},onFocusCapture:Wt(e.onFocusCapture,A.onFocusCapture),onBlurCapture:Wt(e.onBlurCapture,A.onBlurCapture),onPointerDownCapture:Wt(e.onPointerDownCapture,k.onPointerDownCapture)})});Loe.displayName=WXe;var KXe="DismissableLayerBranch",YXe=T.forwardRef((e,t)=>{const n=T.useContext(Foe),r=T.useRef(null),s=Rn(t,r);return T.useEffect(()=>{const i=r.current;if(i)return n.branches.add(i),()=>{n.branches.delete(i)}},[n.branches]),f.jsx(of.div,{...e,ref:s})});YXe.displayName=KXe;function ZXe(e,t=globalThis==null?void 0:globalThis.document){const n=ks(e),r=T.useRef(!1),s=T.useRef(()=>{});return T.useEffect(()=>{const i=o=>{if(o.target&&!r.current){let l=function(){Boe(HXe,n,c,{discrete:!0})};const c={originalEvent:o};o.pointerType==="touch"?(t.removeEventListener("click",s.current),s.current=l,t.addEventListener("click",s.current,{once:!0})):l()}else t.removeEventListener("click",s.current);r.current=!1},a=window.setTimeout(()=>{t.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(a),t.removeEventListener("pointerdown",i),t.removeEventListener("click",s.current)}},[t,n]),{onPointerDownCapture:()=>r.current=!0}}function XXe(e,t=globalThis==null?void 0:globalThis.document){const n=ks(e),r=T.useRef(!1);return T.useEffect(()=>{const s=i=>{i.target&&!r.current&&Boe(GXe,n,{originalEvent:i},{discrete:!1})};return t.addEventListener("focusin",s),()=>t.removeEventListener("focusin",s)},[t,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function LV(){const e=new CustomEvent(pP);document.dispatchEvent(e)}function Boe(e,t,n,{discrete:r}){const s=n.originalEvent.target,i=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&s.addEventListener(e,t,{once:!0}),r?VXe(s,i):s.dispatchEvent(i)}var m3="focusScope.autoFocusOnMount",g3="focusScope.autoFocusOnUnmount",BV={bubbles:!1,cancelable:!0},JXe="FocusScope",$oe=T.forwardRef((e,t)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:s,onUnmountAutoFocus:i,...a}=e,[o,l]=T.useState(null),c=ks(s),u=ks(i),d=T.useRef(null),h=Rn(t,b=>l(b)),m=T.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;T.useEffect(()=>{if(r){let b=function(S){if(m.paused||!o)return;const C=S.target;o.contains(C)?d.current=C:eh(d.current,{select:!0})},v=function(S){if(m.paused||!o)return;const C=S.relatedTarget;C!==null&&(o.contains(C)||eh(d.current,{select:!0}))},x=function(S){if(document.activeElement===document.body)for(const k of S)k.removedNodes.length>0&&eh(o)};document.addEventListener("focusin",b),document.addEventListener("focusout",v);const w=new MutationObserver(x);return o&&w.observe(o,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",b),document.removeEventListener("focusout",v),w.disconnect()}}},[r,o,m.paused]),T.useEffect(()=>{if(o){zV.add(m);const b=document.activeElement;if(!o.contains(b)){const x=new CustomEvent(m3,BV);o.addEventListener(m3,c),o.dispatchEvent(x),x.defaultPrevented||(QXe(sJe(zoe(o)),{select:!0}),document.activeElement===b&&eh(o))}return()=>{o.removeEventListener(m3,c),setTimeout(()=>{const x=new CustomEvent(g3,BV);o.addEventListener(g3,u),o.dispatchEvent(x),x.defaultPrevented||eh(b??document.body,{select:!0}),o.removeEventListener(g3,u),zV.remove(m)},0)}}},[o,c,u,m]);const y=T.useCallback(b=>{if(!n&&!r||m.paused)return;const v=b.key==="Tab"&&!b.altKey&&!b.ctrlKey&&!b.metaKey,x=document.activeElement;if(v&&x){const w=b.currentTarget,[S,C]=eJe(w);S&&C?!b.shiftKey&&x===C?(b.preventDefault(),n&&eh(S,{select:!0})):b.shiftKey&&x===S&&(b.preventDefault(),n&&eh(C,{select:!0})):x===w&&b.preventDefault()}},[n,r,m.paused]);return f.jsx(of.div,{tabIndex:-1,...a,ref:h,onKeyDown:y})});$oe.displayName=JXe;function QXe(e,{select:t=!1}={}){const n=document.activeElement;for(const r of e)if(eh(r,{select:t}),document.activeElement!==n)return}function eJe(e){const t=zoe(e),n=$V(t,e),r=$V(t.reverse(),e);return[n,r]}function zoe(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const s=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||s?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function $V(e,t){for(const n of e)if(!tJe(n,{upTo:t}))return n}function tJe(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function nJe(e){return e instanceof HTMLInputElement&&"select"in e}function eh(e,{select:t=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&nJe(e)&&t&&e.select()}}var zV=rJe();function rJe(){let e=[];return{add(t){const n=e[0];t!==n&&(n==null||n.pause()),e=UV(e,t),e.unshift(t)},remove(t){var n;e=UV(e,t),(n=e[0])==null||n.resume()}}}function UV(e,t){const n=[...e],r=n.indexOf(t);return r!==-1&&n.splice(r,1),n}function sJe(e){return e.filter(t=>t.tagName!=="A")}var iJe="Arrow",Uoe=T.forwardRef((e,t)=>{const{children:n,width:r=10,height:s=5,...i}=e;return f.jsx(of.svg,{...i,ref:t,width:r,height:s,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?n:f.jsx("polygon",{points:"0,0 30,0 15,10"})})});Uoe.displayName=iJe;var aJe=Uoe,C5="Popper",[qoe,Voe]=Hi(C5),[oJe,Woe]=qoe(C5),Hoe=e=>{const{__scopePopper:t,children:n}=e,[r,s]=T.useState(null);return f.jsx(oJe,{scope:t,anchor:r,onAnchorChange:s,children:n})};Hoe.displayName=C5;var Goe="PopperAnchor",Koe=T.forwardRef((e,t)=>{const{__scopePopper:n,virtualRef:r,...s}=e,i=Woe(Goe,n),a=T.useRef(null),o=Rn(t,a);return T.useEffect(()=>{i.onAnchorChange((r==null?void 0:r.current)||a.current)}),r?null:f.jsx(of.div,{...s,ref:o})});Koe.displayName=Goe;var k5="PopperContent",[lJe,cJe]=qoe(k5),Yoe=T.forwardRef((e,t)=>{var De,Se,Ce,qe,Qe,Ve;const{__scopePopper:n,side:r="bottom",sideOffset:s=0,align:i="center",alignOffset:a=0,arrowPadding:o=0,avoidCollisions:l=!0,collisionBoundary:c=[],collisionPadding:u=0,sticky:d="partial",hideWhenDetached:h=!1,updatePositionStrategy:m="optimized",onPlaced:y,...b}=e,v=Woe(k5,n),[x,w]=T.useState(null),S=Rn(t,Ne=>w(Ne)),[C,k]=T.useState(null),A=$y(C),R=(A==null?void 0:A.width)??0,N=(A==null?void 0:A.height)??0,I=r+(i!=="center"?"-"+i:""),P=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},L=Array.isArray(c)?c:[c],O=L.length>0,V={padding:P,boundary:L.filter(dJe),altBoundary:O},{refs:D,floatingStyles:Z,placement:U,isPositioned:H,middlewareData:$}=aO({strategy:"fixed",placement:I,whileElementsMounted:(...Ne)=>iO(...Ne,{animationFrame:m==="always"}),elements:{reference:v.anchor},middleware:[oO({mainAxis:s+N,alignmentAxis:a}),l&&lO({mainAxis:!0,crossAxis:!1,limiter:d==="partial"?cO():void 0,...V}),l&&uO({...V}),dO({...V,apply:({elements:Ne,rects:K,availableWidth:ge,availableHeight:Ae})=>{const{width:le,height:oe}=K.reference,re=Ne.floating.style;re.setProperty("--radix-popper-available-width",`${ge}px`),re.setProperty("--radix-popper-available-height",`${Ae}px`),re.setProperty("--radix-popper-anchor-width",`${le}px`),re.setProperty("--radix-popper-anchor-height",`${oe}px`)}}),C&&hO({element:C,padding:o}),fJe({arrowWidth:R,arrowHeight:N}),h&&fO({strategy:"referenceHidden",...V})]}),[ne,W]=Joe(U),Q=ks(y);ni(()=>{H&&(Q==null||Q())},[H,Q]);const ee=(De=$.arrow)==null?void 0:De.x,se=(Se=$.arrow)==null?void 0:Se.y,pe=((Ce=$.arrow)==null?void 0:Ce.centerOffset)!==0,[ce,Ie]=T.useState();return ni(()=>{x&&Ie(window.getComputedStyle(x).zIndex)},[x]),f.jsx("div",{ref:D.setFloating,"data-radix-popper-content-wrapper":"",style:{...Z,transform:H?Z.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:ce,"--radix-popper-transform-origin":[(qe=$.transformOrigin)==null?void 0:qe.x,(Qe=$.transformOrigin)==null?void 0:Qe.y].join(" "),...((Ve=$.hide)==null?void 0:Ve.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:f.jsx(lJe,{scope:n,placedSide:ne,onArrowChange:k,arrowX:ee,arrowY:se,shouldHideArrow:pe,children:f.jsx(of.div,{"data-side":ne,"data-align":W,...b,ref:S,style:{...b.style,animation:H?void 0:"none"}})})})});Yoe.displayName=k5;var Zoe="PopperArrow",uJe={top:"bottom",right:"left",bottom:"top",left:"right"},Xoe=T.forwardRef(function(t,n){const{__scopePopper:r,...s}=t,i=cJe(Zoe,r),a=uJe[i.placedSide];return f.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[a]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:f.jsx(aJe,{...s,ref:n,style:{...s.style,display:"block"}})})});Xoe.displayName=Zoe;function dJe(e){return e!==null}var fJe=e=>({name:"transformOrigin",options:e,fn(t){var v,x,w;const{placement:n,rects:r,middlewareData:s}=t,a=((v=s.arrow)==null?void 0:v.centerOffset)!==0,o=a?0:e.arrowWidth,l=a?0:e.arrowHeight,[c,u]=Joe(n),d={start:"0%",center:"50%",end:"100%"}[u],h=(((x=s.arrow)==null?void 0:x.x)??0)+o/2,m=(((w=s.arrow)==null?void 0:w.y)??0)+l/2;let y="",b="";return c==="bottom"?(y=a?d:`${h}px`,b=`${-l}px`):c==="top"?(y=a?d:`${h}px`,b=`${r.floating.height+l}px`):c==="right"?(y=`${-l}px`,b=a?d:`${m}px`):c==="left"&&(y=`${r.floating.width+l}px`,b=a?d:`${m}px`),{data:{x:y,y:b}}}});function Joe(e){const[t,n="center"]=e.split("-");return[t,n]}var hJe=Hoe,Qoe=Koe,pJe=Yoe,mJe=Xoe,gJe="Portal",ele=T.forwardRef((e,t)=>{var o;const{container:n,...r}=e,[s,i]=T.useState(!1);ni(()=>i(!0),[]);const a=n||s&&((o=globalThis==null?void 0:globalThis.document)==null?void 0:o.body);return a?yE.createPortal(f.jsx(of.div,{...r,ref:t}),a):null});ele.displayName=gJe;var nA="Popover",[tle,wdt]=Hi(nA,[Voe]),r_=Voe(),[yJe,ap]=tle(nA),nle=e=>{const{__scopePopover:t,children:n,open:r,defaultOpen:s,onOpenChange:i,modal:a=!1}=e,o=r_(t),l=T.useRef(null),[c,u]=T.useState(!1),[d,h]=Pc({prop:r,defaultProp:s??!1,onChange:i,caller:nA});return f.jsx(hJe,{...o,children:f.jsx(yJe,{scope:t,contentId:aa(),triggerRef:l,open:d,onOpenChange:h,onOpenToggle:T.useCallback(()=>h(m=>!m),[h]),hasCustomAnchor:c,onCustomAnchorAdd:T.useCallback(()=>u(!0),[]),onCustomAnchorRemove:T.useCallback(()=>u(!1),[]),modal:a,children:n})})};nle.displayName=nA;var rle="PopoverAnchor",bJe=T.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,s=ap(rle,n),i=r_(n),{onCustomAnchorAdd:a,onCustomAnchorRemove:o}=s;return T.useEffect(()=>(a(),()=>o()),[a,o]),f.jsx(Qoe,{...i,...r,ref:t})});bJe.displayName=rle;var sle="PopoverTrigger",ile=T.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,s=ap(sle,n),i=r_(n),a=Rn(t,s.triggerRef),o=f.jsx(of.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":ule(s.open),...r,ref:a,onClick:Wt(e.onClick,s.onOpenToggle)});return s.hasCustomAnchor?o:f.jsx(Qoe,{asChild:!0,...i,children:o})});ile.displayName=sle;var E5="PopoverPortal",[vJe,xJe]=tle(E5,{forceMount:void 0}),ale=e=>{const{__scopePopover:t,forceMount:n,children:r,container:s}=e,i=ap(E5,t);return f.jsx(vJe,{scope:t,forceMount:n,children:f.jsx(la,{present:n||i.open,children:f.jsx(ele,{asChild:!0,container:s,children:r})})})};ale.displayName=E5;var My="PopoverContent",ole=T.forwardRef((e,t)=>{const n=xJe(My,e.__scopePopover),{forceMount:r=n.forceMount,...s}=e,i=ap(My,e.__scopePopover);return f.jsx(la,{present:r||i.open,children:i.modal?f.jsx(_Je,{...s,ref:t}):f.jsx(SJe,{...s,ref:t})})});ole.displayName=My;var wJe=Au("PopoverContent.RemoveScroll"),_Je=T.forwardRef((e,t)=>{const n=ap(My,e.__scopePopover),r=T.useRef(null),s=Rn(t,r),i=T.useRef(!1);return T.useEffect(()=>{const a=r.current;if(a)return ZT(a)},[]),f.jsx(n_,{as:wJe,allowPinchZoom:!0,children:f.jsx(lle,{...e,ref:s,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Wt(e.onCloseAutoFocus,a=>{var o;a.preventDefault(),i.current||(o=n.triggerRef.current)==null||o.focus()}),onPointerDownOutside:Wt(e.onPointerDownOutside,a=>{const o=a.detail.originalEvent,l=o.button===0&&o.ctrlKey===!0,c=o.button===2||l;i.current=c},{checkForDefaultPrevented:!1}),onFocusOutside:Wt(e.onFocusOutside,a=>a.preventDefault(),{checkForDefaultPrevented:!1})})})}),SJe=T.forwardRef((e,t)=>{const n=ap(My,e.__scopePopover),r=T.useRef(!1),s=T.useRef(!1);return f.jsx(lle,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var a,o;(a=e.onCloseAutoFocus)==null||a.call(e,i),i.defaultPrevented||(r.current||(o=n.triggerRef.current)==null||o.focus(),i.preventDefault()),r.current=!1,s.current=!1},onInteractOutside:i=>{var l,c;(l=e.onInteractOutside)==null||l.call(e,i),i.defaultPrevented||(r.current=!0,i.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const a=i.target;((c=n.triggerRef.current)==null?void 0:c.contains(a))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&s.current&&i.preventDefault()}})}),lle=T.forwardRef((e,t)=>{const{__scopePopover:n,trapFocus:r,onOpenAutoFocus:s,onCloseAutoFocus:i,disableOutsidePointerEvents:a,onEscapeKeyDown:o,onPointerDownOutside:l,onFocusOutside:c,onInteractOutside:u,...d}=e,h=ap(My,n),m=r_(n);return KT(),f.jsx($oe,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:s,onUnmountAutoFocus:i,children:f.jsx(Loe,{asChild:!0,disableOutsidePointerEvents:a,onInteractOutside:u,onEscapeKeyDown:o,onPointerDownOutside:l,onFocusOutside:c,onDismiss:()=>h.onOpenChange(!1),children:f.jsx(pJe,{"data-state":ule(h.open),role:"dialog",id:h.contentId,...m,...d,ref:t,style:{...d.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),cle="PopoverClose",CJe=T.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,s=ap(cle,n);return f.jsx(of.button,{type:"button",...r,ref:t,onClick:Wt(e.onClick,()=>s.onOpenChange(!1))})});CJe.displayName=cle;var kJe="PopoverArrow",EJe=T.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,s=r_(n);return f.jsx(mJe,{...s,...r,ref:t})});EJe.displayName=kJe;function ule(e){return e?"open":"closed"}var TJe=nle,AJe=ile,RJe=ale,NJe=ole;function vl({...e}){return f.jsx(TJe,{"data-slot":"popover",...e})}function xl({...e}){return f.jsx(AJe,{"data-slot":"popover-trigger",...e})}function wl({className:e,align:t="center",sideOffset:n=4,...r}){return f.jsx(RJe,{children:f.jsx(NJe,{"data-slot":"popover-content",align:t,sideOffset:n,className:Ze("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-72 origin-(--radix-popover-content-transform-origin) rounded-md border p-4 shadow-md outline-hidden",e),...r})})}function i0(e,t,n){let r=n.initialDeps??[],s;function i(){var a,o,l,c;let u;n.key&&((a=n.debug)!=null&&a.call(n))&&(u=Date.now());const d=e();if(!(d.length!==r.length||d.some((y,b)=>r[b]!==y)))return s;r=d;let m;if(n.key&&((o=n.debug)!=null&&o.call(n))&&(m=Date.now()),s=t(...d),n.key&&((l=n.debug)!=null&&l.call(n))){const y=Math.round((Date.now()-u)*100)/100,b=Math.round((Date.now()-m)*100)/100,v=b/16,x=(w,S)=>{for(w=String(w);w.length<S;)w=" "+w;return w};console.info(`%c⏱ ${x(b,5)} /${x(y,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*v,120))}deg 100% 31%);`,n==null?void 0:n.key)}return(c=n==null?void 0:n.onChange)==null||c.call(n,s),s}return i.updateDeps=a=>{r=a},i}function y3(e,t){if(e===void 0)throw new Error("Unexpected undefined");return e}const MJe=(e,t)=>Math.abs(e-t)<=1,IJe=(e,t,n)=>{let r;return function(...s){e.clearTimeout(r),r=e.setTimeout(()=>t.apply(this,s),n)}},qV=e=>{const{offsetWidth:t,offsetHeight:n}=e;return{width:t,height:n}},jJe=e=>e,PJe=e=>{const t=Math.max(e.startIndex-e.overscan,0),n=Math.min(e.endIndex+e.overscan,e.count-1),r=[];for(let s=t;s<=n;s++)r.push(s);return r},OJe=(e,t)=>{const n=e.scrollElement;if(!n)return;const r=e.targetWindow;if(!r)return;const s=a=>{const{width:o,height:l}=a;t({width:Math.round(o),height:Math.round(l)})};if(s(qV(n)),!r.ResizeObserver)return()=>{};const i=new r.ResizeObserver(a=>{const o=()=>{const l=a[0];if(l!=null&&l.borderBoxSize){const c=l.borderBoxSize[0];if(c){s({width:c.inlineSize,height:c.blockSize});return}}s(qV(n))};e.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(o):o()});return i.observe(n,{box:"border-box"}),()=>{i.unobserve(n)}},VV={passive:!0},WV=typeof window>"u"?!0:"onscrollend"in window,DJe=(e,t)=>{const n=e.scrollElement;if(!n)return;const r=e.targetWindow;if(!r)return;let s=0;const i=e.options.useScrollendEvent&&WV?()=>{}:IJe(r,()=>{t(s,!1)},e.options.isScrollingResetDelay),a=u=>()=>{const{horizontal:d,isRtl:h}=e.options;s=d?n.scrollLeft*(h&&-1||1):n.scrollTop,i(),t(s,u)},o=a(!0),l=a(!1);l(),n.addEventListener("scroll",o,VV);const c=e.options.useScrollendEvent&&WV;return c&&n.addEventListener("scrollend",l,VV),()=>{n.removeEventListener("scroll",o),c&&n.removeEventListener("scrollend",l)}},FJe=(e,t,n)=>{if(t!=null&&t.borderBoxSize){const r=t.borderBoxSize[0];if(r)return Math.round(r[n.options.horizontal?"inlineSize":"blockSize"])}return e[n.options.horizontal?"offsetWidth":"offsetHeight"]},LJe=(e,{adjustments:t=0,behavior:n},r)=>{var s,i;const a=e+t;(i=(s=r.scrollElement)==null?void 0:s.scrollTo)==null||i.call(s,{[r.options.horizontal?"left":"top"]:a,behavior:n})};class BJe{constructor(t){this.unsubs=[],this.scrollElement=null,this.targetWindow=null,this.isScrolling=!1,this.scrollToIndexTimeoutId=null,this.measurementsCache=[],this.itemSizeCache=new Map,this.pendingMeasuredCacheIndexes=[],this.scrollRect=null,this.scrollOffset=null,this.scrollDirection=null,this.scrollAdjustments=0,this.elementsCache=new Map,this.observer=(()=>{let n=null;const r=()=>n||(!this.targetWindow||!this.targetWindow.ResizeObserver?null:n=new this.targetWindow.ResizeObserver(s=>{s.forEach(i=>{const a=()=>{this._measureElement(i.target,i)};this.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(a):a()})}));return{disconnect:()=>{var s;(s=r())==null||s.disconnect(),n=null},observe:s=>{var i;return(i=r())==null?void 0:i.observe(s,{box:"border-box"})},unobserve:s=>{var i;return(i=r())==null?void 0:i.unobserve(s)}}})(),this.range=null,this.setOptions=n=>{Object.entries(n).forEach(([r,s])=>{typeof s>"u"&&delete n[r]}),this.options={debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:jJe,rangeExtractor:PJe,onChange:()=>{},measureElement:FJe,initialRect:{width:0,height:0},scrollMargin:0,gap:0,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1,isScrollingResetDelay:150,enabled:!0,isRtl:!1,useScrollendEvent:!1,useAnimationFrameWithResizeObserver:!1,...n}},this.notify=n=>{var r,s;(s=(r=this.options).onChange)==null||s.call(r,this,n)},this.maybeNotify=i0(()=>(this.calculateRange(),[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]),n=>{this.notify(n)},{key:!1,debug:()=>this.options.debug,initialDeps:[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]}),this.cleanup=()=>{this.unsubs.filter(Boolean).forEach(n=>n()),this.unsubs=[],this.observer.disconnect(),this.scrollElement=null,this.targetWindow=null},this._didMount=()=>()=>{this.cleanup()},this._willUpdate=()=>{var n;const r=this.options.enabled?this.options.getScrollElement():null;if(this.scrollElement!==r){if(this.cleanup(),!r){this.maybeNotify();return}this.scrollElement=r,this.scrollElement&&"ownerDocument"in this.scrollElement?this.targetWindow=this.scrollElement.ownerDocument.defaultView:this.targetWindow=((n=this.scrollElement)==null?void 0:n.window)??null,this.elementsCache.forEach(s=>{this.observer.observe(s)}),this._scrollToOffset(this.getScrollOffset(),{adjustments:void 0,behavior:void 0}),this.unsubs.push(this.options.observeElementRect(this,s=>{this.scrollRect=s,this.maybeNotify()})),this.unsubs.push(this.options.observeElementOffset(this,(s,i)=>{this.scrollAdjustments=0,this.scrollDirection=i?this.getScrollOffset()<s?"forward":"backward":null,this.scrollOffset=s,this.isScrolling=i,this.maybeNotify()}))}},this.getSize=()=>this.options.enabled?(this.scrollRect=this.scrollRect??this.options.initialRect,this.scrollRect[this.options.horizontal?"width":"height"]):(this.scrollRect=null,0),this.getScrollOffset=()=>this.options.enabled?(this.scrollOffset=this.scrollOffset??(typeof this.options.initialOffset=="function"?this.options.initialOffset():this.options.initialOffset),this.scrollOffset):(this.scrollOffset=null,0),this.getFurthestMeasurement=(n,r)=>{const s=new Map,i=new Map;for(let a=r-1;a>=0;a--){const o=n[a];if(s.has(o.lane))continue;const l=i.get(o.lane);if(l==null||o.end>l.end?i.set(o.lane,o):o.end<l.end&&s.set(o.lane,!0),s.size===this.options.lanes)break}return i.size===this.options.lanes?Array.from(i.values()).sort((a,o)=>a.end===o.end?a.index-o.index:a.end-o.end)[0]:void 0},this.getMeasurementOptions=i0(()=>[this.options.count,this.options.paddingStart,this.options.scrollMargin,this.options.getItemKey,this.options.enabled],(n,r,s,i,a)=>(this.pendingMeasuredCacheIndexes=[],{count:n,paddingStart:r,scrollMargin:s,getItemKey:i,enabled:a}),{key:!1}),this.getMeasurements=i0(()=>[this.getMeasurementOptions(),this.itemSizeCache],({count:n,paddingStart:r,scrollMargin:s,getItemKey:i,enabled:a},o)=>{if(!a)return this.measurementsCache=[],this.itemSizeCache.clear(),[];this.measurementsCache.length===0&&(this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach(u=>{this.itemSizeCache.set(u.key,u.size)}));const l=this.pendingMeasuredCacheIndexes.length>0?Math.min(...this.pendingMeasuredCacheIndexes):0;this.pendingMeasuredCacheIndexes=[];const c=this.measurementsCache.slice(0,l);for(let u=l;u<n;u++){const d=i(u),h=this.options.lanes===1?c[u-1]:this.getFurthestMeasurement(c,u),m=h?h.end+this.options.gap:r+s,y=o.get(d),b=typeof y=="number"?y:this.options.estimateSize(u),v=m+b,x=h?h.lane:u%this.options.lanes;c[u]={index:u,start:m,size:b,end:v,key:d,lane:x}}return this.measurementsCache=c,c},{key:!1,debug:()=>this.options.debug}),this.calculateRange=i0(()=>[this.getMeasurements(),this.getSize(),this.getScrollOffset(),this.options.lanes],(n,r,s,i)=>this.range=n.length>0&&r>0?$Je({measurements:n,outerSize:r,scrollOffset:s,lanes:i}):null,{key:!1,debug:()=>this.options.debug}),this.getVirtualIndexes=i0(()=>{let n=null,r=null;const s=this.calculateRange();return s&&(n=s.startIndex,r=s.endIndex),this.maybeNotify.updateDeps([this.isScrolling,n,r]),[this.options.rangeExtractor,this.options.overscan,this.options.count,n,r]},(n,r,s,i,a)=>i===null||a===null?[]:n({startIndex:i,endIndex:a,overscan:r,count:s}),{key:!1,debug:()=>this.options.debug}),this.indexFromElement=n=>{const r=this.options.indexAttribute,s=n.getAttribute(r);return s?parseInt(s,10):(console.warn(`Missing attribute name '${r}={index}' on measured element.`),-1)},this._measureElement=(n,r)=>{const s=this.indexFromElement(n),i=this.measurementsCache[s];if(!i)return;const a=i.key,o=this.elementsCache.get(a);o!==n&&(o&&this.observer.unobserve(o),this.observer.observe(n),this.elementsCache.set(a,n)),n.isConnected&&this.resizeItem(s,this.options.measureElement(n,r,this))},this.resizeItem=(n,r)=>{const s=this.measurementsCache[n];if(!s)return;const i=this.itemSizeCache.get(s.key)??s.size,a=r-i;a!==0&&((this.shouldAdjustScrollPositionOnItemSizeChange!==void 0?this.shouldAdjustScrollPositionOnItemSizeChange(s,a,this):s.start<this.getScrollOffset()+this.scrollAdjustments)&&this._scrollToOffset(this.getScrollOffset(),{adjustments:this.scrollAdjustments+=a,behavior:void 0}),this.pendingMeasuredCacheIndexes.push(s.index),this.itemSizeCache=new Map(this.itemSizeCache.set(s.key,r)),this.notify(!1))},this.measureElement=n=>{if(!n){this.elementsCache.forEach((r,s)=>{r.isConnected||(this.observer.unobserve(r),this.elementsCache.delete(s))});return}this._measureElement(n,void 0)},this.getVirtualItems=i0(()=>[this.getVirtualIndexes(),this.getMeasurements()],(n,r)=>{const s=[];for(let i=0,a=n.length;i<a;i++){const o=n[i],l=r[o];s.push(l)}return s},{key:!1,debug:()=>this.options.debug}),this.getVirtualItemForOffset=n=>{const r=this.getMeasurements();if(r.length!==0)return y3(r[dle(0,r.length-1,s=>y3(r[s]).start,n)])},this.getOffsetForAlignment=(n,r,s=0)=>{const i=this.getSize(),a=this.getScrollOffset();r==="auto"&&(r=n>=a+i?"end":"start"),r==="center"?n+=(s-i)/2:r==="end"&&(n-=i);const o=this.getTotalSize()-i;return Math.max(Math.min(o,n),0)},this.getOffsetForIndex=(n,r="auto")=>{n=Math.max(0,Math.min(n,this.options.count-1));const s=this.measurementsCache[n];if(!s)return;const i=this.getSize(),a=this.getScrollOffset();if(r==="auto")if(s.end>=a+i-this.options.scrollPaddingEnd)r="end";else if(s.start<=a+this.options.scrollPaddingStart)r="start";else return[a,r];const o=r==="end"?s.end+this.options.scrollPaddingEnd:s.start-this.options.scrollPaddingStart;return[this.getOffsetForAlignment(o,r,s.size),r]},this.isDynamicMode=()=>this.elementsCache.size>0,this.cancelScrollToIndex=()=>{this.scrollToIndexTimeoutId!==null&&this.targetWindow&&(this.targetWindow.clearTimeout(this.scrollToIndexTimeoutId),this.scrollToIndexTimeoutId=null)},this.scrollToOffset=(n,{align:r="start",behavior:s}={})=>{this.cancelScrollToIndex(),s==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getOffsetForAlignment(n,r),{adjustments:void 0,behavior:s})},this.scrollToIndex=(n,{align:r="auto",behavior:s}={})=>{n=Math.max(0,Math.min(n,this.options.count-1)),this.cancelScrollToIndex(),s==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size.");const i=this.getOffsetForIndex(n,r);if(!i)return;const[a,o]=i;this._scrollToOffset(a,{adjustments:void 0,behavior:s}),s!=="smooth"&&this.isDynamicMode()&&this.targetWindow&&(this.scrollToIndexTimeoutId=this.targetWindow.setTimeout(()=>{if(this.scrollToIndexTimeoutId=null,this.elementsCache.has(this.options.getItemKey(n))){const[c]=y3(this.getOffsetForIndex(n,o)),u=this.getScrollOffset();MJe(c,u)||this.scrollToIndex(n,{align:o,behavior:s})}else this.scrollToIndex(n,{align:o,behavior:s})}))},this.scrollBy=(n,{behavior:r}={})=>{this.cancelScrollToIndex(),r==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getScrollOffset()+n,{adjustments:void 0,behavior:r})},this.getTotalSize=()=>{var n;const r=this.getMeasurements();let s;if(r.length===0)s=this.options.paddingStart;else if(this.options.lanes===1)s=((n=r[r.length-1])==null?void 0:n.end)??0;else{const i=Array(this.options.lanes).fill(null);let a=r.length-1;for(;a>=0&&i.some(o=>o===null);){const o=r[a];i[o.lane]===null&&(i[o.lane]=o.end),a--}s=Math.max(...i.filter(o=>o!==null))}return Math.max(s-this.options.scrollMargin+this.options.paddingEnd,0)},this._scrollToOffset=(n,{adjustments:r,behavior:s})=>{this.options.scrollToFn(n,{behavior:s,adjustments:r},this)},this.measure=()=>{this.itemSizeCache=new Map,this.notify(!1)},this.setOptions(t)}}const dle=(e,t,n,r)=>{for(;e<=t;){const s=(e+t)/2|0,i=n(s);if(i<r)e=s+1;else if(i>r)t=s-1;else return s}return e>0?e-1:0};function $Je({measurements:e,outerSize:t,scrollOffset:n,lanes:r}){const s=e.length-1,i=l=>e[l].start;if(e.length<=r)return{startIndex:0,endIndex:s};let a=dle(0,s,i,n),o=a;if(r===1)for(;o<s&&e[o].end<n+t;)o++;else if(r>1){const l=Array(r).fill(0);for(;o<s&&l.some(u=>u<n+t);){const u=e[o];l[u.lane]=u.end,o++}const c=Array(r).fill(n+t);for(;a>=0&&c.some(u=>u>=n);){const u=e[a];c[u.lane]=u.start,a--}a=Math.max(0,a-a%r),o=Math.min(s,o+(r-1-o%r))}return{startIndex:a,endIndex:o}}const HV=typeof document<"u"?T.useLayoutEffect:T.useEffect;function zJe(e){const t=T.useReducer(()=>({}),{})[1],n={...e,onChange:(s,i)=>{var a;i?al.flushSync(t):t(),(a=e.onChange)==null||a.call(e,s,i)}},[r]=T.useState(()=>new BJe(n));return r.setOptions(n),HV(()=>r._didMount(),[]),HV(()=>r._willUpdate()),r}function T5(e){return zJe({observeElementRect:OJe,observeElementOffset:DJe,scrollToFn:LJe,...e})}const GV=e=>{if(!e)return null;const t=parseFloat(e);return isNaN(t)?null:t/1e6},A5=({providerId:e,allAvailableModels:t,enabledModelIds:n,onToggleModel:r,isLoading:s=!1,disabled:i=!1,listHeightClass:a="h-[26rem]",onModelClick:o})=>{const[l,c]=T.useState(null),u=T.useCallback(Z=>{if(Z){const U=Z.querySelector("[data-radix-scroll-area-viewport]");if(U)c(U);else{const H=new MutationObserver(()=>{const $=Z.querySelector("[data-radix-scroll-area-viewport]");$&&(c($),H.disconnect())});return H.observe(Z,{childList:!0,subtree:!0}),()=>H.disconnect()}}else c(null)},[]),[d,h]=T.useState(""),[m,y]=T.useState(!1),[b,v]=T.useState("all"),[x,w]=T.useState({reasoning:!1,webSearch:!1,tools:!1,multimodal:!1}),[S,C]=T.useState(""),[k,A]=T.useState(""),[R,N]=T.useState(""),[I,P]=T.useState(""),L=T.useMemo(()=>{let Z=[...t];if(b==="enabled"?Z=Z.filter(ce=>n.has(ce.id)):b==="disabled"&&(Z=Z.filter(ce=>!n.has(ce.id))),d.trim()){const ce=d.toLowerCase();Z=Z.filter(Ie=>Ie.name.toLowerCase().includes(ce)||Ie.id.toLowerCase().includes(ce))}const U=Object.entries(x).filter(([,ce])=>ce).map(([ce])=>ce);U.length>0&&(Z=Z.filter(ce=>{var Se;const Ie=new Set(ce.supported_parameters??[]),De=new Set(((Se=ce.architecture)==null?void 0:Se.input_modalities)??[]);return U.every(Ce=>{switch(Ce){case"reasoning":return Ie.has("reasoning");case"webSearch":return Ie.has("web_search")||Ie.has("web_search_options");case"tools":return Ie.has("tools");case"multimodal":return Array.from(De).some(qe=>qe!=="text");default:return!0}})}));const H=parseFloat(S),$=parseFloat(k),ne=parseFloat(R),W=parseFloat(I),Q=!isNaN(H),ee=!isNaN($),se=!isNaN(ne),pe=!isNaN(W);return(Q||ee||se||pe)&&(Z=Z.filter(ce=>{var ge,Ae;const Ie=GV((ge=ce.pricing)==null?void 0:ge.prompt),De=GV((Ae=ce.pricing)==null?void 0:Ae.completion),Se=Q?H/1e6:-1/0,Ce=ee?$/1e6:1/0,qe=se?ne/1e6:-1/0,Qe=pe?W/1e6:1/0,Ve=Ie!==null&&Ie>=Se&&Ie<=Ce,Ne=De!==null&&De>=qe&&De<=Qe;let K=!0;return(Q||ee)&&K&&(K=Ve),(se||pe)&&K&&(K=Ne),K})),Z},[t,d,b,n,x,S,k,R,I]),O=T5({count:L.length,getScrollElement:()=>l,estimateSize:()=>40,overscan:10}),V=Z=>{w(U=>({...U,[Z]:!U[Z]}))},D=(b!=="all"?1:0)+Object.values(x).filter(Boolean).length+(S||k||R||I?1:0);return s?f.jsxs("div",{className:Ze("space-y-2",a),children:[f.jsx("div",{className:"h-8 w-full bg-muted rounded animate-pulse"}),f.jsx("div",{className:"h-8 w-full bg-muted rounded animate-pulse"}),f.jsx("div",{className:"h-8 w-full bg-muted rounded animate-pulse"})]}):t.length===0?f.jsx("p",{className:"text-sm text-muted-foreground italic pt-2",children:"No models available for this provider. Try fetching models."}):f.jsxs("div",{className:"space-y-2 flex flex-col h-full",children:[f.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[f.jsxs("div",{className:"relative flex-grow",children:[f.jsx(Fa,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),f.jsx(_n,{value:d,onChange:Z=>h(Z.target.value),placeholder:"Filter models by name...",className:"pl-8 h-9 w-full text-xs",type:"text",disabled:i})]}),f.jsxs(vl,{open:m,onOpenChange:y,children:[f.jsx(xl,{asChild:!0,children:f.jsxs(ft,{variant:"outline",size:"sm",className:"h-9 px-3 relative",disabled:i,children:[f.jsx(PP,{className:"h-4 w-4 mr-1"}),"Filters",D>0&&f.jsx("span",{className:"absolute -top-1 -right-1 inline-flex items-center justify-center px-1.5 py-0.5 text-xs font-semibold leading-none text-white bg-primary rounded-full",children:D})]})}),f.jsxs(wl,{className:"w-72 p-4 space-y-4",children:[f.jsxs("div",{className:"space-y-2",children:[f.jsx(It,{className:"text-xs font-semibold",children:"Status"}),f.jsxs("div",{className:"flex gap-1",children:[f.jsx(ft,{variant:b==="all"?"secondary":"outline",size:"sm",onClick:()=>v("all"),children:"All"}),f.jsxs(ft,{variant:b==="enabled"?"secondary":"outline",size:"sm",onClick:()=>v("enabled"),children:[f.jsx(so,{className:"h-3 w-3 mr-1"})," Enabled"]}),f.jsxs(ft,{variant:b==="disabled"?"secondary":"outline",size:"sm",onClick:()=>v("disabled"),children:[f.jsx(upe,{className:"h-3 w-3 mr-1"})," Disabled"]})]})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx(It,{className:"text-xs font-semibold",children:"Capabilities"}),f.jsxs("div",{className:"flex flex-wrap gap-1",children:[f.jsx(Dn,{tooltipText:"Reasoning","aria-label":"Reasoning",icon:f.jsx(Fh,{}),onClick:()=>V("reasoning"),variant:x.reasoning?"secondary":"outline",className:Ze(x.reasoning&&"text-primary")}),f.jsx(Dn,{tooltipText:"Web Search","aria-label":"Web Search",icon:f.jsx(Fa,{}),onClick:()=>V("webSearch"),variant:x.webSearch?"secondary":"outline",className:Ze(x.webSearch&&"text-primary")}),f.jsx(Dn,{tooltipText:"Tools","aria-label":"Tools",icon:f.jsx(ym,{}),onClick:()=>V("tools"),variant:x.tools?"secondary":"outline",className:Ze(x.tools&&"text-primary")}),f.jsx(Dn,{tooltipText:"Multimodal","aria-label":"Multimodal",icon:f.jsx(mm,{}),onClick:()=>V("multimodal"),variant:x.multimodal?"secondary":"outline",className:Ze(x.multimodal&&"text-primary")})]})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsxs(It,{className:"text-xs font-semibold flex items-center gap-1",children:[f.jsx(Ype,{className:"h-3 w-3"})," Price Range ($ / 1M Tokens)"]}),f.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[f.jsx(_n,{type:"number",min:"0",step:"0.01",placeholder:"Min Input",value:S,onChange:Z=>C(Z.target.value),className:"h-8 text-xs"}),f.jsx(_n,{type:"number",min:"0",step:"0.01",placeholder:"Max Input",value:k,onChange:Z=>A(Z.target.value),className:"h-8 text-xs"}),f.jsx(_n,{type:"number",min:"0",step:"0.01",placeholder:"Min Output",value:R,onChange:Z=>N(Z.target.value),className:"h-8 text-xs"}),f.jsx(_n,{type:"number",min:"0",step:"0.01",placeholder:"Max Output",value:I,onChange:Z=>P(Z.target.value),className:"h-8 text-xs"})]})]})]})]})]}),f.jsxs(Lo,{className:Ze("w-full rounded-md border border-border p-1 bg-background/50 flex-grow",a),ref:u,children:[l&&f.jsx("div",{style:{height:`${O.getTotalSize()}px`,width:"100%",position:"relative"},children:L.length===0&&!s?f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4 absolute inset-0 flex items-center justify-center",children:"No models match the current filters."}):O.getVirtualItems().map(Z=>{const U=L[Z.index];return U?f.jsxs("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:`${Z.size}px`,transform:`translateY(${Z.start}px)`},className:"flex items-center justify-between space-x-2 p-1.5 rounded hover:bg-muted/50",children:[f.jsx(Io,{id:`enable-model-${e}-${U.id}`,checked:n.has(U.id),onCheckedChange:H=>r(U.id,H),disabled:i,"aria-label":`Enable model ${U.name||U.id}`,className:"flex-shrink-0",onClick:H=>H.stopPropagation()}),f.jsx(It,{htmlFor:`enable-model-${e}-${U.id}`,className:"text-sm font-normal text-card-foreground flex-grow cursor-pointer truncate pl-2",title:U.name||U.id,onClick:o?()=>o(U.id):void 0,children:U.name||U.id})]},U.id):null})}),!l&&!s&&f.jsx("div",{className:"flex items-center justify-center h-full text-muted-foreground",children:"Initializing list..."})]})]})},UJe=({stepNumber:e,title:t,description:n,isComplete:r,isActive:s,openOnComplete:i=!1,contentClassName:a="",icon:o,children:l})=>{const[c,u]=T.useState(!1);return T.useEffect(()=>{u(s||r&&i)},[s,r,i]),f.jsxs(cl,{className:`border border-border/40 bg-card/50 backdrop-blur-sm shadow-lg ${r?"border-l-4 border-l-green-500/70":s?"border-l-4 border-l-primary/70":""}`,children:[f.jsx(ul,{className:"pb-2",children:f.jsxs("div",{className:"flex items-center space-x-3",children:[f.jsx("div",{className:`flex h-8 w-8 shrink-0 items-center justify-center rounded-full ${r?"bg-green-500/20 text-green-500":s?"bg-primary/20 text-primary":"bg-muted text-muted-foreground"}`,children:r?f.jsx(uE,{className:"h-5 w-5"}):f.jsx("div",{className:"flex items-center justify-center",children:o})}),f.jsxs("div",{className:"flex-1",children:[f.jsxs("div",{className:"flex items-center justify-between cursor-pointer",onClick:()=>u(!c),children:[f.jsxs(dl,{className:"text-base",children:[f.jsxs("span",{className:"opacity-60 mr-2",children:[e,"."]}),t]}),f.jsx("button",{className:`p-1 rounded-full transition-all ${c?"rotate-90":""} hover:bg-muted/60`,children:f.jsx(IP,{className:"h-4 w-4"})})]}),!c&&f.jsx(Bd,{className:"text-xs mt-1",children:typeof n=="string"?n.substring(0,60)+(n.length>60?"...":""):"Click to expand"})]})]})}),f.jsx(yVe,{children:c&&f.jsx(du.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},className:"overflow-hidden",children:f.jsxs(fl,{className:"pt-2",children:[typeof n=="string"?f.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:n}):f.jsx("div",{className:"text-sm text-muted-foreground mb-4",children:n}),f.jsx("div",{className:a,children:l})]})})})]})},qJe=()=>{const{apiKeys:e,addApiKey:t,providers:n,addProviderConfig:r,updateProviderConfig:s,getAllAvailableModelDefsForProvider:i,isLoading:a,enableApiKeyManagement:o}=Nr(yn(se=>({apiKeys:se.dbApiKeys,addApiKey:se.addApiKey,providers:se.dbProviderConfigs,addProviderConfig:se.addProviderConfig,updateProviderConfig:se.updateProviderConfig,getAllAvailableModelDefsForProvider:se.getAllAvailableModelDefsForProvider,isLoading:se.isLoading,enableApiKeyManagement:se.enableApiKeyManagement}))),{addConversation:l,selectItem:c}=qn(yn(se=>({addConversation:se.addConversation,selectItem:se.selectItem}))),[u,d]=T.useState(!1),[h,m]=T.useState(!1),[y,b]=T.useState(!1),[v,x]=T.useState(!1),[w,S]=T.useState(!1),C=T.useMemo(()=>!o||e.length>0,[o,e]),k=T.useMemo(()=>n.length>0,[n]),A=T.useMemo(()=>n.some(se=>se.isEnabled&&se.enabledModels&&se.enabledModels.length>0),[n]),R=T.useMemo(()=>{const se=[...n].sort((pe,ce)=>ce.createdAt.getTime()-pe.createdAt.getTime());return se.length>0?se[0]:null},[n]),N=T.useMemo(()=>R?i(R.id):[],[R,i]),I=T.useMemo(()=>new Set((R==null?void 0:R.enabledModels)??[]),[R]),{initialProviderTypeForForm:P,initialProviderNameForForm:L,initialApiKeyIdForForm:O}=T.useMemo(()=>{var se;if(k)return{type:void 0,name:void 0,keyId:void 0};if(e.length>0){const ce=[...e].sort((Ie,De)=>De.createdAt.getTime()-Ie.createdAt.getTime()).find(Ie=>J0(Ie.providerId));if(ce){const Ie=ce.providerId,De=((se=wo.find(Se=>Se.value===Ie))==null?void 0:se.label)||Ie;return{initialProviderTypeForForm:Ie,initialProviderNameForForm:De,initialApiKeyIdForForm:ce.id}}}return{initialProviderTypeForForm:void 0,initialProviderNameForForm:void 0,initialApiKeyIdForForm:void 0}},[e,k]),V=T.useCallback(async(se,pe,ce)=>{d(!0);try{await t(se,pe,ce),je.success("API key added successfully!")}finally{d(!1)}},[t]),D=T.useCallback(async se=>{m(!0);try{const pe={...se,apiKeyId:se.apiKeyId??(J0(se.type)?O??null:null)},ce=await r(pe);return je.success("Provider added successfully!"),ce}finally{m(!1)}},[r,O]),Z=T.useCallback(async(se,pe)=>{if(!R)return;x(!0);const ce=new Set(R.enabledModels??[]);pe?ce.add(se):ce.delete(se);const Ie=Array.from(ce);try{await s(R.id,{enabledModels:Ie}),je.success(pe?"Model enabled successfully!":"Model disabled successfully!")}catch(De){je.error("Failed to update model status."),console.error("Failed to save model toggle:",De)}finally{x(!1)}},[R,s]),U=T.useCallback(async()=>{b(!0),S(!0);try{await new Promise(pe=>setTimeout(pe,800));const se=await l({title:"New Chat"});await c(se,"conversation"),je.success("Welcome to your first chat!")}catch(se){je.error("Failed to start your first chat."),console.error("Failed to start first chat:",se),b(!1),S(!1)}},[l,c]),H=()=>{Pe.emit(Pr.openModalRequest,{modalId:"settingsModal",initialTab:"providers"})},$=[C,k,A].filter(Boolean).length,ne=o?3:2,W=$/ne*100,Q=[...o?[{id:"api-key",title:"Add API Key",description:f.jsxs("div",{className:"space-y-2",children:[f.jsxs("p",{children:["To use providers like"," ",f.jsx(kd,{href:"https://platform.openai.com/api-keys",className:"text-blue-500 hover:text-blue-700 transition-colors",children:"OpenAI"}),","," ",f.jsx(kd,{href:"https://aistudio.google.com/app/apikey",className:"text-green-600 hover:text-green-700 transition-colors",children:"Google"}),","," ",f.jsx(kd,{href:"https://console.anthropic.com/settings/keys",className:"text-purple-500 hover:text-purple-700 transition-colors",children:"Anthropic (Claude)"}),", or"," ",f.jsx(kd,{href:"https://openrouter.ai/keys",className:"text-orange-500 hover:text-orange-700 transition-colors",children:"OpenRouter"})," ","or any OpenAI API compatible provider, add an API key. Keys are stored securely in your browser."]}),f.jsxs("p",{children:['If you want truly local AI, "no internet required", you can setup'," ",f.jsx(kd,{href:"https://www.ollama.com/",className:"text-teal-500 hover:text-teal-700 transition-colors",children:"Ollama"})," ","or,"," ",f.jsx(kd,{href:"https://lmstudio.ai/",className:"text-indigo-500 hover:text-indigo-700 transition-colors",children:"LMStudio"})," ","(or any other local LLM solution with an OpenAI compatible API). These typically don't require API keys so see you in step 2."]})]}),isComplete:C,content:f.jsx(Soe,{onSave:V,onCancel:()=>{},disabled:u,className:"border-none shadow-none p-0",initialProviderType:P}),icon:f.jsx(Bx,{className:"h-4 w-4"})}]:[],{id:"add-provider",title:"Add AI Provider",description:f.jsxs("div",{className:"space-y-2",children:[f.jsx("p",{children:"Connect to an AI provider you configured the key for..."}),f.jsx("p",{children:"This might look redundant, but it allows you to have multiple keys for the same provider (personal, professional, etc.)"})]}),isComplete:k,content:f.jsx(Moe,{apiKeys:e,onAddProvider:D,onCancel:()=>{},initialType:P,initialName:L,initialApiKeyId:O}),icon:f.jsx(G0,{className:"h-4 w-4"})},{id:"enable-models",title:"Enable Models",description:f.jsxs("div",{className:"space-y-2",children:[f.jsxs("p",{children:["Enable models for the provider you just added (",f.jsx("span",{className:"font-medium text-primary",children:(R==null?void 0:R.name)||"..."}),")."]}),f.jsx("p",{children:"Enabling specific models improves the UI by reducing clutter and choice paralysis. You can enable more later in Settings."}),f.jsx("p",{children:"And just like before, you can choose to activate a model for a certain combination of key/provider!"})]}),isComplete:A,content:R?f.jsx("div",{className:"bg-card/40 rounded-lg p-3 border border-border/30 shadow-inner",children:f.jsx(A5,{providerId:R.id,allAvailableModels:N,enabledModelIds:I,onToggleModel:Z,isLoading:a||v,listHeightClass:"h-[26rem]"})}):f.jsxs("p",{className:"text-sm text-muted-foreground italic flex items-center",children:[f.jsx(Rc,{className:"h-4 w-4 mr-2 text-amber-500"}),"Add a provider in Step ",o?"2":"1"," first."]}),icon:f.jsx(Fh,{className:"h-4 w-4"})},{id:"start-chat",title:"Start Chatting",description:"You're all set! Click below to start your first chat.",isComplete:!1,content:f.jsxs("div",{children:[w&&f.jsx(du.div,{initial:{opacity:0},animate:{opacity:1},className:"mb-4",children:f.jsx(Ny,{value:y?void 0:100,className:"h-2"})}),f.jsxs(ft,{onClick:U,disabled:y||!A,className:"w-full bg-gradient-to-r from-indigo-500 to-primary hover:opacity-90 transition-all",children:[f.jsx(qme,{className:"mr-2 h-4 w-4"}),y?"Launching...":"Start First Chat"]}),f.jsx(Vse,{})]}),contentClassName:"p-4",icon:f.jsx(uge,{className:"h-4 w-4"})}],ee=Q.findIndex(se=>!se.isComplete);return a?f.jsx("div",{className:"flex h-full flex-col items-center justify-center p-4 space-y-4 max-w-4xl mx-auto w-full",children:f.jsxs(du.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},className:"w-full",children:[f.jsx(Wr,{className:"h-12 w-1/2 mx-auto mb-6"}),f.jsx(Wr,{className:"h-8 w-3/4 mx-auto mb-2"}),f.jsx(Wr,{className:"h-4 w-1/2 mx-auto mb-8"}),f.jsx(Wr,{className:"h-20 w-full mb-6"}),f.jsx(Wr,{className:"h-20 w-full mb-6"}),f.jsx(Wr,{className:"h-20 w-full"})]})}):f.jsx("div",{className:"flex h-full flex-col items-center justify-start p-4 bg-gradient-to-b from-background to-background/80",children:f.jsxs("div",{className:"w-full max-w-4xl space-y-6 pt-8",children:[f.jsxs("div",{className:"text-center mb-8",children:[f.jsx(du.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{type:"spring",stiffness:500,damping:30},children:f.jsxs("div",{className:"relative mx-auto w-16 h-16 mb-4",children:[f.jsx("div",{className:"absolute inset-0 bg-primary/20 rounded-full blur-xl"}),f.jsx("div",{className:"relative bg-gradient-to-br from-primary to-indigo-600 p-3 rounded-full",children:f.jsx(jXe,{className:"h-10 w-10 text-white"})})]})}),f.jsx("h2",{className:"text-3xl font-bold mb-3 bg-gradient-to-r from-primary to-indigo-500 bg-clip-text text-transparent",children:"Welcome to LiteChat"}),f.jsx(OXe,{})]}),f.jsxs(du.div,{className:"space-y-4",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[f.jsx(xr,{children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsxs("div",{className:"mt-6 bg-card/40 backdrop-blur-sm border border-border/30 rounded-xl p-3 w-3/4 mx-auto",children:[f.jsx(Ny,{value:W,className:"h-1.5"}),f.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["Setup Progress: ",Math.round(W),"%"]})]})}),f.jsx(Sr,{children:f.jsxs("p",{children:["Steps completed: ",$," of ",ne]})})]})}),Q.map((se,pe)=>{const ce=pe===ee;return f.jsx(du.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:pe*.1,duration:.3},children:f.jsx(UJe,{stepNumber:pe+1,title:se.title,description:se.description,isComplete:se.id!=="start-chat"&&se.isComplete,isActive:ce,openOnComplete:se.id==="enable-models",contentClassName:se.id==="add-provider"||se.id==="api-key"?"p-0 border-none shadow-none bg-transparent":se.contentClassName,icon:se.icon,children:se.content})},se.id)})]}),!a&&!k&&ee===-1&&f.jsxs(du.div,{className:"text-center mt-6 p-4 bg-red-500/10 rounded-lg border border-red-500/30",initial:{opacity:0},animate:{opacity:1},transition:{delay:.5},children:[f.jsx(Rc,{className:"h-8 w-8 text-red-500 mx-auto mb-2"}),f.jsx("p",{className:"text-sm mb-3",children:"Configuration issue detected. Please review provider settings."}),f.jsx(ft,{variant:"outline",size:"sm",onClick:H,className:"border-red-500/50 hover:bg-red-500/20 transition-colors",children:"Open Provider Settings"})]})]})})},g2=["conversation.title_generation"],VJe=({conversationId:e,interactions:t,status:n,className:r})=>{const s=T.useRef(null),i=T.useRef(null),[a,o]=T.useState(!1),l=T.useRef(null),c=$n(D=>D.streamingInteractionIds),{chatMaxWidth:u,autoScrollInterval:d,enableAutoScrollOnStream:h}=yr(yn(D=>({chatMaxWidth:D.chatMaxWidth,autoScrollInterval:D.autoScrollInterval,enableAutoScrollOnStream:D.enableAutoScrollOnStream}))),m=yr(D=>D.setEnableAutoScrollOnStream),y=T.useMemo(()=>D=>({isLoading:D.isLoading}),[]),b=T.useMemo(()=>D=>({conversationCount:D.conversations.length,isConversationLoading:D.isLoading}),[]),{isLoading:v}=Nr(yn(y)),{conversationCount:x,isConversationLoading:w}=qn(yn(b)),{projectCount:S,isProjectLoading:C}=Fo(yn(D=>({projectCount:D.projects.length,isProjectLoading:D.isLoading}))),k=T.useMemo(()=>v||w||C?!1:x===0&&S===0,[x,S,v,w,C]),A=T.useMemo(()=>t.filter(U=>U.parentId===null&&!g2.includes(U.type)).sort((U,H)=>U.index-H.index).map(U=>{const H=t.filter($=>$.parentId===U.id&&!g2.includes($.type)).sort(($,ne)=>$.index-ne.index);return[U,...H]}),[t]),R=jo(yn(D=>Object.values(D.canvasControls))),N=T.useCallback((D,Z,U,H)=>R.filter(ne=>{const W=ne.type===D,Q=ne.targetSlot===Z,ee=!!ne.renderer;return W&&Q&&ee}).map(ne=>{if(ne.renderer){const Q={...{interaction:U,interactionId:U==null?void 0:U.id,responseContent:typeof(U==null?void 0:U.response)=="string"?U.response:void 0,canvasContextType:D},...H};return f.jsx(We.Fragment,{children:ne.renderer(Q)},ne.id)}return null}).filter(Boolean),[R]),I=(D="smooth")=>{i.current&&i.current.scrollTo({top:i.current.scrollHeight,behavior:D})};T.useEffect(()=>{if(i.current){const{scrollHeight:D,clientHeight:Z,scrollTop:U}=i.current;(D-Z<=U+150||n!=="streaming")&&requestAnimationFrame(()=>{I(n==="streaming"?"smooth":"auto")})}},[A.length,n]),T.useEffect(()=>(n==="streaming"&&h?(l.current&&clearInterval(l.current),l.current=setInterval(()=>{I("smooth")},d)):l.current&&(clearInterval(l.current),l.current=null),()=>{l.current&&clearInterval(l.current)}),[n,d,h]),T.useEffect(()=>{const D=i.current;if(!D)return;const Z=()=>{if(!i.current)return;const{scrollHeight:U,clientHeight:H,scrollTop:$}=i.current,ne=$<U-H-H*.5;o(ne)};return D.addEventListener("scroll",Z,{passive:!0}),Z(),()=>{i.current&&i.current.removeEventListener("scroll",Z)}},[]),T.useEffect(()=>{s.current&&(i.current=s.current.querySelector("[data-radix-scroll-area-viewport]"))},[]);const P=T.useMemo(()=>{const D=[];return[...t].sort((H,$)=>{var ne,W;return H.index!==$.index?H.index-$.index:H.parentId===null&&$.parentId!==null?-1:H.parentId!==null&&$.parentId===null?1:H.parentId!==null&&$.parentId!==null&&H.parentId===$.parentId?H.index-$.index:(((ne=H.startedAt)==null?void 0:ne.getTime())??0)-(((W=$.startedAt)==null?void 0:W.getTime())??0)}).filter(H=>H.parentId===null&&!g2.includes(H.type)).forEach(H=>{var Q,ee;let $=null;if(H.type==="message.user_assistant"&&H.prompt)$=H.prompt;else if(H.type==="message.assistant_regen"&&((Q=H.metadata)!=null&&Q.regeneratedFromId)){let se,pe=H;const ce=new Set;for(;pe&&!ce.has(pe.id);){if(ce.add(pe.id),pe.type==="message.user_assistant"&&pe.prompt){se=pe;break}if((ee=pe.metadata)!=null&&ee.regeneratedFromId)pe=t.find(Ie=>Ie.id===pe.metadata.regeneratedFromId);else break}se?$=se.prompt:H.prompt?$=H.prompt:console.warn(`[ChatCanvas] Could not reliably find user prompt for active interaction ${H.id} of type ${H.type}. Displaying turn without prompt.`)}if($)D.push(f.jsx(FT,{turnData:$,timestamp:H.startedAt,isAssistantComplete:H.status==="COMPLETED"||H.status==="ERROR"},`prompt-${H.id}`));else if(H.type!=="message.user_assistant"&&H.type!=="message.assistant_regen"){console.log("[ChatCanvas] Skipping active interaction on spine due to no user prompt and non-standard type:",H.id,H.type);return}const ne=t.filter(se=>se.parentId===H.id&&!g2.includes(se.type)).sort((se,pe)=>se.index-pe.index),W=[H,...ne];W.length>0&&D.push(f.jsx(Gqe,{interactionGroup:W,renderSlot:(se,pe,ce)=>N("interaction",se,pe,ce),activeStreamingInteractionId:c.find(se=>W.some(pe=>pe.id===se))},`tabs-${H.id}`))}),D},[t,N,c]),L=T.useMemo(()=>c.filter(D=>!t.some(Z=>Z.id===D)).map(D=>f.jsx(qk,{interactionId:D,renderSlot:(Z,U,H)=>N("interaction",Z,U,H)},`${D}-streaming-new`)),[c,t,N]),O=()=>v||w||C?f.jsxs("div",{className:"space-y-4 p-2 md:p-4",children:[f.jsx(Wr,{className:"h-24 w-full"}),f.jsx(Wr,{className:"h-32 w-full"}),f.jsx(Wr,{className:"h-20 w-full"})]}):e?A.length===0&&n!=="streaming"&&c.length===0?f.jsx(QU,{}):f.jsxs("div",{className:"space-y-4 p-2 md:p-4 break-words",children:[P,L]}):f.jsx(QU,{}),V=u||"max-w-7xl";return f.jsx("div",{className:Ze("flex-grow relative",r),children:k?f.jsx(Lo,{className:"h-full w-full",children:f.jsx("div",{className:Ze("mx-auto w-full",V),children:f.jsx(qJe,{})})}):f.jsxs(f.Fragment,{children:[f.jsx(Lo,{className:"h-full w-full",ref:s,children:f.jsx("div",{className:Ze("mx-auto w-full",V),children:O()})}),a&&f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(ft,{variant:"outline",size:"icon",className:"absolute bottom-4 right-4 z-20 h-8 w-8 rounded-full shadow-md bg-background/80 backdrop-blur-sm hover:bg-muted",onClick:()=>I(),"aria-label":"Scroll to bottom",children:f.jsx(oH,{className:"h-4 w-4"})})}),f.jsx(Sr,{side:"left",children:"Scroll to Bottom"})]})}),n==="streaming"&&f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(ft,{variant:"outline",size:"icon",className:"absolute bottom-4 right-14 z-20 h-8 w-8 rounded-full shadow-md bg-background/80 backdrop-blur-sm hover:bg-muted",onClick:()=>m(!h),"aria-label":h?"Disable follow stream":"Enable follow stream",children:h?f.jsx(nge,{className:"h-4 w-4"}):f.jsx(ige,{className:"h-4 w-4"})})}),f.jsx(Sr,{side:"left",children:h?"Stop Following Stream":"Follow Stream"})]})})]})})},WJe=We.memo(VJe),a0=({controls:e,panelId:t,renderMode:n="full",className:r})=>{const s=e.filter(i=>(i.panel??"main")===t&&(i.show?i.show():!0));return s.length===0?null:f.jsx("div",{className:Ze(r),children:s.map(i=>{const a=n==="icon"?i.iconRenderer:i.renderer;return f.jsx(We.Fragment,{children:a?a():null},i.id)})})},Jw=$o(zo((e,t)=>({isChatControlPanelOpen:{},isPromptControlPanelOpen:{},isSidebarCollapsed:!1,globalLoading:!1,globalError:null,focusInputOnNextRender:!1,toggleChatControlPanel:(n,r)=>{const s=t().isChatControlPanelOpen[n]??!1,i=r??!s;s!==i&&(e(a=>{a.isChatControlPanelOpen[n]=i}),Pe.emit(Pr.chatControlPanelVisibilityChanged,{panelId:n,isOpen:i}))},togglePromptControlPanel:(n,r)=>{const s=t().isPromptControlPanelOpen[n]??!1,i=r??!s;s!==i&&(e(a=>{a.isPromptControlPanelOpen[n]=i}),Pe.emit(Pr.promptControlPanelVisibilityChanged,{controlId:n,isOpen:i}))},toggleSidebar:n=>{const r=t().isSidebarCollapsed,s=n??!r;r!==s&&(e({isSidebarCollapsed:s}),Pe.emit(Pr.sidebarVisibilityChanged,{isCollapsed:s}))},setGlobalLoading:n=>{t().globalLoading!==n&&(e({globalLoading:n}),Pe.emit(Pr.globalLoadingChanged,{loading:n}))},setGlobalError:n=>{t().globalError!==n&&(e({globalError:n}),Pe.emit(Pr.globalErrorChanged,{error:n}))},setFocusInputFlag:n=>{t().focusInputOnNextRender!==n&&(e({focusInputOnNextRender:n}),Pe.emit(Pr.focusInputFlagChanged,{focus:n}))},getRegisteredActionHandlers:()=>{const n="uiStateStore",r=t();return[{eventName:Pr.toggleSidebarRequest,handler:s=>r.toggleSidebar(s==null?void 0:s.isCollapsed),storeId:n},{eventName:Pr.toggleChatControlPanelRequest,handler:s=>r.toggleChatControlPanel(s.panelId,s.isOpen),storeId:n},{eventName:Pr.togglePromptControlPanelRequest,handler:s=>r.togglePromptControlPanel(s.controlId,s.isOpen),storeId:n},{eventName:Pr.setGlobalLoadingRequest,handler:s=>r.setGlobalLoading(s.loading),storeId:n},{eventName:Pr.setGlobalErrorRequest,handler:s=>r.setGlobalError(s.error),storeId:n},{eventName:Pr.setFocusInputFlagRequest,handler:s=>r.setFocusInputFlag(s.focus),storeId:n}]}})));var HJe=(e,t,n,r,s,i,a,o)=>{let l=document.documentElement,c=["light","dark"];function u(m){(Array.isArray(e)?e:[e]).forEach(y=>{let b=y==="class",v=b&&i?s.map(x=>i[x]||x):s;b?(l.classList.remove(...v),l.classList.add(i&&i[m]?i[m]:m)):l.setAttribute(y,m)}),d(m)}function d(m){o&&c.includes(m)&&(l.style.colorScheme=m)}function h(){return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}if(r)u(r);else try{let m=localStorage.getItem(t)||n,y=a&&m==="system"?h():m;u(y)}catch{}},GJe=T.createContext(void 0),KJe={setTheme:e=>{},themes:[]},YJe=()=>{var e;return(e=T.useContext(GJe))!=null?e:KJe};T.memo(({forcedTheme:e,storageKey:t,attribute:n,enableSystem:r,enableColorScheme:s,defaultTheme:i,value:a,themes:o,nonce:l,scriptProps:c})=>{let u=JSON.stringify([n,t,i,e,o,a,r,s]).slice(1,-1);return T.createElement("script",{...c,suppressHydrationWarning:!0,nonce:typeof window>"u"?l:"",dangerouslySetInnerHTML:{__html:`(${HJe.toString()})(${u})`}})});const ZJe=({...e})=>{const{theme:t="system"}=YJe();return f.jsx($0e,{theme:t,className:"toaster group",style:{"--normal-bg":"var(--popover)","--normal-text":"var(--popover-foreground)","--normal-border":"var(--border)"},...e})};function Bo({className:e,...t}){return f.jsx("textarea",{"data-slot":"textarea",className:Ze("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),...t})}const fle=T.memo(T.forwardRef(({initialValue:e="",onSubmit:t,disabled:n,placeholder:r="Type message... (Shift+Enter for new line)",className:s,onValueChange:i,...a},o)=>{const l=T.useRef(null),[c,u]=T.useState(e);T.useImperativeHandle(o,()=>({getValue:()=>c,setValue:m=>{u(m),i&&i(m),Pe.emit(Nn.inputChanged,{value:m}),requestAnimationFrame(()=>{const y=l.current;y&&(y.style.height="auto",y.style.height=`${y.scrollHeight}px`,y.style.overflowY=y.scrollHeight>250?"auto":"hidden")})},focus:()=>{var m;return(m=l.current)==null?void 0:m.focus()},clearValue:()=>{u(""),i&&i(""),Pe.emit(Nn.inputChanged,{value:""}),requestAnimationFrame(()=>{const m=l.current;m&&(m.style.height="auto",m.style.height=`${m.scrollHeight}px`,m.style.overflowY="hidden")})}}));const d=m=>{var y;if(m.key==="Enter"&&!m.shiftKey&&!n){m.preventDefault();const b=mh.getState().attachedFilesMetadata.length>0;(c.trim().length>0||b)&&(t(),(y=o==null?void 0:o.current)==null||y.clearValue())}},h=m=>{const y=m.target.value;u(y),i&&i(y),Pe.emit(Nn.inputChanged,{value:y})};return T.useEffect(()=>{const m=l.current;if(m){m.style.height="auto";const y=m.scrollHeight,b=250;m.style.height=`${Math.min(y,b)}px`,m.style.overflowY=y>b?"auto":"hidden"}},[c]),T.useEffect(()=>{e!==c&&(u(e),i&&i(e))},[e,i]),T.useEffect(()=>{const m=y=>{u(y.text),i&&i(y.text),Pe.emit(Nn.inputChanged,{value:y.text}),requestAnimationFrame(()=>{const b=l.current;b&&(b.style.height="auto",b.style.height=`${b.scrollHeight}px`,b.style.overflowY=b.scrollHeight>250?"auto":"hidden")})};return Pe.on(Nn.setInputTextRequest,m),()=>{Pe.off(Nn.setInputTextRequest,m)}},[i]),f.jsx(Bo,{ref:l,value:c,onChange:h,onKeyDown:d,disabled:n,placeholder:r,rows:1,className:Ze("w-full p-3 border rounded bg-input text-foreground resize-none focus:ring-2 focus:ring-primary outline-none disabled:opacity-50 overflow-y-auto","min-h-[40px] max-h-[250px]",s),"aria-label":"Chat input",...a})}));fle.displayName="InputArea";const ki={dbModsLoaded:"mod.db.mods.loaded",loadedInstancesChanged:"mod.loaded.instances.changed",settingsTabsChanged:"mod.settings.tabs.changed",loadingStateChanged:"mod.loading.state.changed",modLoaded:"mod.sdk.loaded",modError:"mod.sdk.error",loadDbModsRequest:"mod.load.db.mods.request",addDbModRequest:"mod.add.db.mod.request",updateDbModRequest:"mod.update.db.mod.request",deleteDbModRequest:"mod.delete.db.mod.request"},Oh=$o(zo((e,t)=>({dbMods:[],loadedMods:[],modSettingsTabs:[],isLoading:!1,error:null,loadDbMods:async()=>{e({isLoading:!0,error:null});try{const n=await Et.loadMods();e({dbMods:n,isLoading:!1}),Pe.emit(ki.dbModsLoaded,{dbMods:n})}catch(n){const r="Failed to load mods";console.error("ModStore: Error loading mods",n),e({error:r,isLoading:!1}),Pe.emit(ki.loadingStateChanged,{isLoading:!1,error:r}),je.error(r)}},addDbMod:async n=>{const r=Vi(),s={id:r,createdAt:new Date,...n,loadOrder:n.loadOrder??Date.now()};e(i=>{i.dbMods.push(s),i.dbMods.sort((a,o)=>a.loadOrder-o.loadOrder)});try{return await Et.saveMod(s),je.success(`Mod "${s.name}" added.`),Pe.emit(ki.dbModsLoaded,{dbMods:t().dbMods}),r}catch(i){const a="Failed to save new mod";throw console.error("ModStore: Error adding mod",i),e(o=>{o.dbMods=o.dbMods.filter(l=>l.id!==r),o.error=a}),Pe.emit(ki.loadingStateChanged,{isLoading:t().isLoading,error:a}),je.error(a),i}},updateDbMod:async(n,r)=>{let s,i=-1;e(o=>{i=o.dbMods.findIndex(l=>l.id===n),i!==-1?(s={...o.dbMods[i]},o.dbMods[i]={...o.dbMods[i],...r},r.loadOrder!==void 0&&o.dbMods.sort((l,c)=>l.loadOrder-c.loadOrder)):console.warn(`ModStore: Mod ${n} not found for update.`)});const a=i!==-1?t().dbMods[i]:void 0;if(a)try{await Et.saveMod(a),je.success(`Mod "${a.name}" updated.`),Pe.emit(ki.dbModsLoaded,{dbMods:t().dbMods})}catch(o){const l="Failed to save mod update";throw console.error("ModStore: Error updating mod",o),e(c=>{const u=c.dbMods.findIndex(d=>d.id===n);u!==-1&&s&&(c.dbMods[u]=s,c.dbMods.sort((d,h)=>d.loadOrder-h.loadOrder)),c.error=l}),Pe.emit(ki.loadingStateChanged,{isLoading:t().isLoading,error:l}),je.error(l),o}},deleteDbMod:async n=>{const r=t().dbMods.find(i=>i.id===n);if(!r){console.warn(`ModStore: Mod ${n} not found for deletion.`);return}const s=r.name;e(i=>({dbMods:i.dbMods.filter(a=>a.id!==n)}));try{await Et.deleteMod(n),je.success(`Mod "${s}" deleted.`),Pe.emit(ki.dbModsLoaded,{dbMods:t().dbMods})}catch(i){const a="Failed to delete mod";throw console.error("ModStore: Error deleting mod",i),e(o=>{o.dbMods.push(r),o.dbMods.sort((l,c)=>l.loadOrder-c.loadOrder),o.error=a}),Pe.emit(ki.loadingStateChanged,{isLoading:t().isLoading,error:a}),je.error(a),i}},setLoadedMods:n=>{e({loadedMods:n}),Pe.emit(ki.loadedInstancesChanged,{loadedMods:n})},_addSettingsTab:n=>{e(r=>{if(!r.modSettingsTabs.some(s=>s.id===n.id))r.modSettingsTabs.push(n),r.modSettingsTabs.sort((s,i)=>(s.order??999)-(i.order??999));else{console.warn(`ModStore: Settings tab with ID "${n.id}" already registered. Overwriting.`);const s=r.modSettingsTabs.findIndex(i=>i.id===n.id);r.modSettingsTabs[s]=n,r.modSettingsTabs.sort((i,a)=>(i.order??999)-(a.order??999))}}),Pe.emit(ki.settingsTabsChanged,{tabs:t().modSettingsTabs})},_removeSettingsTab:n=>{e(r=>{r.modSettingsTabs=r.modSettingsTabs.filter(s=>s.id!==n)}),Pe.emit(ki.settingsTabsChanged,{tabs:t().modSettingsTabs})},getRegisteredActionHandlers:()=>{const n="modStore",r=t(),s=i=>async a=>{await i(a)};return[{eventName:ki.loadDbModsRequest,handler:r.loadDbMods,storeId:n},{eventName:ki.addDbModRequest,handler:s(r.addDbMod),storeId:n},{eventName:ki.updateDbModRequest,handler:i=>r.updateDbMod(i.id,i.changes),storeId:n},{eventName:ki.deleteDbModRequest,handler:i=>r.deleteDbMod(i.id),storeId:n}]}}))),op={loaded:"app.loaded",errorBoundaryTriggered:"app.error.boundary.triggered",initializationPhaseCompleted:"app.initialization.phase.completed"};function mP(e){const t=e.id,n=e.name;return{modId:t,modName:n,registerPromptControl:s=>(Pe.emit($r.registerPromptControlRequest,{control:s}),()=>Pe.emit($r.unregisterPromptControlRequest,{id:s.id})),registerChatControl:s=>{const i={...s,status:s.status??(()=>"ready")};return Pe.emit($r.registerChatControlRequest,{control:i}),()=>Pe.emit($r.unregisterChatControlRequest,{id:s.id})},registerCanvasControl:s=>(Pe.emit($r.registerCanvasControlRequest,{control:s}),()=>Pe.emit($r.unregisterCanvasControlRequest,{id:s.id})),registerTool:(s,i,a)=>(console.log(`[${n}] Registering tool: ${s}`),Pe.emit($r.registerToolRequest,{modId:t,toolName:s,definition:i,implementation:a}),()=>Pe.emit($r.unregisterToolRequest,{toolName:s})),on:(s,i)=>(Pe.on(s,i),()=>Pe.off(s,i)),emit:(s,i)=>{Pe.emit(s,i)},addMiddleware:(s,i)=>(Pe.emit($r.registerMiddlewareRequest,{hookName:s,modId:t,callback:i}),()=>Pe.emit($r.unregisterMiddlewareRequest,{hookName:s,modId:t,callback:i})),registerSettingsTab:s=>(Oh.getState()._addSettingsTab(s),()=>Oh.getState()._removeSettingsTab(s.id)),getContextSnapshot:()=>{const s=$n.getState(),i=qn.getState(),a=yr.getState(),o=Nr.getState(),{providerId:l}=Cc(o.selectedModelId),c=i.selectedItemType==="conversation"?i.selectedItemId:null;return Object.freeze({selectedConversationId:c,interactions:Object.freeze(s.currentConversationId===c?s.interactions.map(u=>Object.freeze({...u})):[]),isStreaming:s.status==="streaming",selectedProviderId:l,selectedModelId:o.selectedModelId,activeSystemPrompt:a.globalSystemPrompt,temperature:a.temperature,maxTokens:a.maxTokens,theme:a.theme,gitUserName:a.gitUserName,gitUserEmail:a.gitUserEmail})},showToast:(s,i)=>{je[s](`[Mod: ${n}] ${i}`)},log:(s,...i)=>{console[s](`[Mod: ${n}]`,...i)},registerModalProvider:(s,i)=>(Pe.emit($r.registerModalProviderRequest,{modalId:s,provider:i}),()=>Pe.emit($r.unregisterModalProviderRequest,{modalId:s})),getVfsInstance:async s=>Js.getState().initializeVFS(s,{force:!0})}}async function XJe(e){const t=e.filter(r=>r.enabled),n=await Promise.all(t.map(async r=>{let s=r.scriptContent,i=null,a=null;try{if(i=mP(r),r.sourceUrl){console.log(`[ModLoader] Fetching script for ${r.name} from ${r.sourceUrl}`);try{const c=await fetch(r.sourceUrl);if(!c.ok)throw new Error(`Failed to fetch mod script: ${c.status} ${c.statusText}`);s=await c.text(),console.log(`[ModLoader] Successfully fetched script for ${r.name}`)}catch(c){throw console.error(`[ModLoader] Error fetching script from ${r.sourceUrl}:`,c),c}}if(!s)throw new Error("Mod script content is empty.");new Function("modApi",s)(i),console.log(`[ModLoader] Successfully executed script for ${r.name}`)}catch(l){a=l instanceof Error?l:String(l),console.error(`[ModLoader] Error loading mod "${r.name}":`,l),je.error(`Error loading mod "${r.name}": ${a instanceof Error?a.message:a}`)}i||(i=mP(r));const o={id:r.id,name:r.name,api:i,error:a};return Pe.emit(o.error?ki.modError:ki.modLoaded,{id:r.id,name:r.name,error:o.error??"unknown error"}),o}));return Pe.emit(op.loaded,void 0),console.log(`[ModLoader] Finished processing ${n.length} mods.`),n}const gr={dataLoaded:"rules.data.loaded",ruleSaved:"rules.rule.saved",ruleDeleted:"rules.rule.deleted",tagSaved:"rules.tag.saved",tagDeleted:"rules.tag.deleted",linkSaved:"rules.link.saved",linkDeleted:"rules.link.deleted",loadingStateChanged:"rules.loading.state.changed",loadRulesAndTagsRequest:"rules.load.rules.and.tags.request",addRuleRequest:"rules.add.rule.request",updateRuleRequest:"rules.update.rule.request",deleteRuleRequest:"rules.delete.rule.request",addTagRequest:"rules.add.tag.request",updateTagRequest:"rules.update.tag.request",deleteTagRequest:"rules.delete.tag.request",linkTagToRuleRequest:"rules.link.tag.to.rule.request",unlinkTagFromRuleRequest:"rules.unlink.tag.from.rule.request"},KV=null;class JJe{static async applyBundledConfig(t){{console.log("[BundledConfig] No bundled user configuration found, skipping...");return}}static hasBundledConfig(){return KV!==null}static getBundledConfig(){return KV}}class Qw{static async syncAll(t={}){const n={syncRepos:!0,syncConversations:!0,continueOnError:!0,maxConcurrent:3,...t};if(this.isRunning){je.warning("Bulk sync already in progress");return}this.isRunning=!0,this.abortController=new AbortController;const r=qn.getState(),s=r.syncRepos,i=r.conversations.filter(o=>o.syncRepoId),a={totalRepos:n.syncRepos?s.length:0,completedRepos:0,totalConversations:n.syncConversations?i.length:0,completedConversations:0,currentOperation:"Starting bulk sync...",errors:[]};try{Pe.emit(us.bulkSyncStarted,{progress:a}),je.info(`Starting bulk sync: ${s.length} repositories, ${i.length} conversations`),n.syncRepos&&s.length>0&&await this.syncRepositoriesInBatches(s,n,a),n.syncConversations&&i.length>0&&await this.syncConversationsInBatches(i,n,a);const o=a.errors.length>0;Pe.emit(us.bulkSyncCompleted,{progress:a,success:!o}),o?(je.warning(`Bulk sync completed with ${a.errors.length} errors. Check console for details.`),console.warn("Bulk sync errors:",a.errors)):je.success("Bulk sync completed successfully!")}catch(o){console.error("Bulk sync failed:",o),je.error(`Bulk sync failed: ${o instanceof Error?o.message:"Unknown error"}`),Pe.emit(us.bulkSyncFailed,{progress:a,error:String(o)})}finally{this.isRunning=!1,this.abortController=null}}static async syncPendingConversations(){const t=qn.getState(),n=t.conversations.filter(r=>{const s=t.conversationSyncStatus[r.id];return r.syncRepoId&&s==="needs-sync"});if(n.length===0){je.info("No conversations need syncing");return}je.info(`Syncing ${n.length} pending conversations...`),await this.syncAll({syncRepos:!1,syncConversations:!0,continueOnError:!0,maxConcurrent:2})}static async initializeAllRepositories(){const n=qn.getState().syncRepos;if(n.length===0){je.info("No repositories configured");return}je.info(`Initializing ${n.length} repositories...`),await this.syncAll({syncRepos:!0,syncConversations:!1,continueOnError:!0,maxConcurrent:2})}static abort(){this.isRunning&&this.abortController&&(this.abortController.abort(),je.info("Bulk sync operation cancelled"))}static isActive(){return this.isRunning}static async syncRepositoriesInBatches(t,n,r){var i;r.currentOperation="Initializing repositories...",Pe.emit(us.bulkSyncProgress,{progress:r});const s=this.createBatches(t,n.maxConcurrent);for(const a of s){if((i=this.abortController)!=null&&i.signal.aborted)throw new Error("Operation cancelled");const o=a.map(async l=>{try{r.currentOperation=`Syncing repository: ${l.name}`,Pe.emit(us.bulkSyncProgress,{progress:r}),await qn.getState().initializeOrSyncRepo(l.id,!0),r.completedRepos++}catch(c){const u=c instanceof Error?c.message:String(c);if(r.errors.push({type:"repo",id:l.id,error:u}),console.error(`Failed to sync repository ${l.name}:`,c),!n.continueOnError)throw c}});await Promise.all(o),Pe.emit(us.bulkSyncProgress,{progress:r})}}static async syncConversationsInBatches(t,n,r){var i;r.currentOperation="Syncing conversations...",Pe.emit(us.bulkSyncProgress,{progress:r});const s=this.createBatches(t,n.maxConcurrent);for(const a of s){if((i=this.abortController)!=null&&i.signal.aborted)throw new Error("Operation cancelled");const o=a.map(async l=>{try{r.currentOperation=`Syncing conversation: ${l.title}`,Pe.emit(us.bulkSyncProgress,{progress:r}),await qn.getState().syncConversation(l.id,!0),r.completedConversations++}catch(c){const u=c instanceof Error?c.message:String(c);if(r.errors.push({type:"conversation",id:l.id,error:u}),console.error(`Failed to sync conversation ${l.title}:`,c),!n.continueOnError)throw c}});await Promise.all(o),Pe.emit(us.bulkSyncProgress,{progress:r})}}static createBatches(t,n){const r=[];for(let s=0;s<t.length;s+=n)r.push(t.slice(s,s+n));return r}}me(Qw,"isRunning",!1),me(Qw,"abortController",null);const F0=Object.freeze(Object.defineProperty({__proto__:null,BulkSyncService:Qw},Symbol.toStringTag,{value:"Module"}));class hle{static async runStartupSync(){if(!this.hasRunStartupSync){this.hasRunStartupSync=!0;try{const t=qn.getState(),n=yr.getState();await new Promise(o=>setTimeout(o,1e3));const r=t.syncRepos,s=t.conversations.filter(o=>o.syncRepoId);if(r.length===0){console.log("[StartupSync] No repositories configured, skipping startup sync");return}console.log(`[StartupSync] Found ${r.length} repositories and ${s.length} synced conversations`);const i=r.filter(o=>{const l=t.repoInitializationStatus[o.id];return!l||l==="error"});i.length>0&&n.autoInitializeReposOnStartup?(console.log(`[StartupSync] Initializing ${i.length} repositories in background`),setTimeout(async()=>{try{await Qw.syncAll({syncRepos:!0,syncConversations:!1,continueOnError:!0,maxConcurrent:1})}catch(o){console.warn("[StartupSync] Background repo initialization failed:",o)}},2e3)):i.length>0&&console.log(`[StartupSync] Found ${i.length} uninitialized repositories, but auto-initialization is disabled`);const a=s.filter(o=>t.conversationSyncStatus[o.id]==="needs-sync");a.length>0&&n.autoSyncOnStreamComplete&&(console.log(`[StartupSync] Found ${a.length} conversations pending sync`),setTimeout(async()=>{try{await Qw.syncPendingConversations()}catch(o){console.warn("[StartupSync] Background conversation sync failed:",o)}},5e3))}catch(t){console.error("[StartupSync] Startup sync failed:",t)}}}static reset(){this.hasRunStartupSync=!1}}me(hle,"hasRunStartupSync",!1);function QJe(e){const t=new Map(e.map(a=>[a.id,a])),n=new Set,r=new Set,s=[];function i(a){if(n.has(a.id))return!0;if(r.has(a.id))return console.error(`[Init] Circular dependency detected involving module: ${a.id}`),je.error("Initialization Error: Circular dependency in controls."),!1;r.add(a.id);for(const o of a.dependencies??[]){const l=t.get(o);if(!l)return console.error(`[Init] Missing dependency "${o}" for module "${a.id}"`),je.error(`Initialization Error: Missing dependency "${o}" for "${a.id}".`),r.delete(a.id),!1;if(!i(l))return r.delete(a.id),!1}return r.delete(a.id),n.add(a.id),s.push(a),!0}for(const a of e)if(!n.has(a.id)&&!i(a))return null;return s}async function eQe(e,t){console.log("[Init] Core Data: Applying bundled configuration..."),await JJe.applyBundledConfig(),console.log("[Init] Core Data: Requesting loads..."),t.emit(sn.loadSettingsRequest,void 0),t.emit(dr.loadInitialDataRequest,void 0),t.emit(gr.loadRulesAndTagsRequest,void 0),t.emit(Yn.loadConversationsRequest,void 0),t.emit(va.loadProjectsRequest,void 0),await new Promise(n=>{let r=!1,s=!1,i=!1,a=!1,o=!1;const l=()=>{r&&s&&i&&a&&o&&n()},c=t.on(sn.loaded,()=>{r=!0,c(),l()}),u=t.on(dr.initialDataLoaded,()=>{s=!0,u(),l()}),d=t.on(gr.dataLoaded,()=>{i=!0,d(),l()}),h=t.on(Yn.conversationsLoaded,()=>{a=!0,h(),l()}),m=t.on(va.loaded,()=>{o=!0,m(),l()})}),Pe.emit(op.initializationPhaseCompleted,{phase:"coreData"}),console.log("[Init] Core Data: Loaded (or load requested)."),setTimeout(()=>{hle.runStartupSync().catch(n=>{console.warn("[Init] Startup sync failed:",n)})},1e3)}async function tQe(e,t){console.log("[Init] Control Modules: Instantiation & Dependency Resolution START");const n=e.map(s=>new s),r=QJe(n);if(!r)throw console.error("[Init] Control Modules: Dependency resolution FAILED."),new Error("Failed to resolve control module dependency order.");console.log(`[Init] Control Modules: Dependency order resolved (${r.length} modules):`,r.map(s=>s.id)),console.log("[Init] Control Modules: Instantiation & Dependency Resolution COMPLETE"),console.log("[Init] Control Modules: Initialization START");for(const s of r)try{await s.initialize(t)}catch(i){console.error(`[Init] Error initializing module "${s.id}":`,i),je.error(`Module Init Error (${s.id}): ${i instanceof Error?i.message:String(i)}`)}return Pe.emit(op.initializationPhaseCompleted,{phase:"controlModulesInit"}),console.log("[Init] Control Modules: Initialization COMPLETE."),r}function nQe(e,t){console.log("[Init] Control Modules: Registration START");for(const n of e)try{n.register(t)}catch(r){console.error(`[Init] Error registering module "${n.id}":`,r),je.error(`Module Registration Error (${n.id}): ${r instanceof Error?r.message:String(r)}`)}Pe.emit(op.initializationPhaseCompleted,{phase:"controlModulesRegister"}),console.log("[Init] Control Modules: Registration COMPLETE.")}async function rQe(e,t){console.log("[Init] External Mods: Loading DB records..."),t.emit(ki.loadDbModsRequest,void 0),await new Promise(s=>{const i=t.on(ki.dbModsLoaded,()=>{i(),s()})});const n=Oh.getState().dbMods;console.log(`[Init] External Mods: Processing ${n.length} mods...`);const r=await XJe(n);Oh.getState().setLoadedMods(r),Pe.emit(op.initializationPhaseCompleted,{phase:"externalMods"}),console.log(`[Init] External Mods: ${r.length} mods processed.`)}function sQe(e,t){var a;console.log("[Init] Core UI States: Initializing...");const n=e.selectedItemId,r=e.selectedItemType,s=r==="project"?n:r==="conversation"?((a=e.getConversationById(n))==null?void 0:a.projectId)??null:null,i=e.getEffectiveProjectSettings(s);t.emit(Nn.initializePromptStateRequest,{effectiveSettings:i}),Pe.emit(op.initializationPhaseCompleted,{phase:"uiStateSync"}),console.log("[Init] Core UI States: Initial prompt state synchronization requested.")}async function iQe(e,t){console.log("[Init] LiteChat Full Initialization START"),dm.initializeCanvasEventHandlers();const n={requestLoadSettings:()=>t.emit(sn.loadSettingsRequest,void 0),requestLoadProviderData:()=>t.emit(dr.loadInitialDataRequest,void 0),requestLoadRulesAndTags:()=>t.emit(gr.loadRulesAndTagsRequest,void 0),requestLoadConversations:()=>t.emit(Yn.loadConversationsRequest,void 0),requestLoadProjects:()=>t.emit(va.loadProjectsRequest,void 0),requestLoadDbMods:()=>t.emit(ki.loadDbModsRequest,void 0),setLoadedMods:Oh.getState().setLoadedMods,getConversationById:qn.getState().getConversationById,getEffectiveProjectSettings:Fo.getState().getEffectiveProjectSettings,initializePromptState:Po.getState().initializePromptState,selectedItemId:qn.getState().selectedItemId,selectedItemType:qn.getState().selectedItemType};let r=[];try{await eQe(n,t),r=await tQe(e,t),nQe(r,t),await rQe(n,t),sQe(n,t),Pe.emit(op.initializationPhaseCompleted,{phase:"all"}),console.log("LiteChat: Full initialization sequence COMPLETE.")}catch(s){throw console.error("LiteChat: Full initialization sequence FAILED:",s),je.error(`Initialization sequence failed: ${s instanceof Error?s.message:String(s)}`),Jw.getState().setGlobalError("Initialization sequence failed."),s}return r}const ple=$o(zo((e,t)=>({rules:[],tags:[],tagRuleLinks:[],isLoading:!1,error:null,loadRulesAndTags:async()=>{e({isLoading:!0,error:null});try{const[n,r,s]=await Promise.all([Et.loadRules(),Et.loadTags(),Et.loadTagRuleLinks()]);e({rules:n,tags:r,tagRuleLinks:s,isLoading:!1}),Pe.emit(gr.dataLoaded,{rules:n,tags:r,links:s})}catch(n){console.error("RulesStore: Error loading rules and tags",n),e({error:"Failed load rules/tags",isLoading:!1}),je.error("Failed to load rules and tags."),Pe.emit(gr.loadingStateChanged,{isLoading:!1,error:"Failed load rules/tags"})}},addRule:async n=>{const r=Vi(),s=new Date,i={id:r,createdAt:s,updatedAt:s,...n};e(a=>{a.rules.push(i),a.rules.sort((o,l)=>o.name.localeCompare(l.name))});try{await Et.saveRule(i),je.success(`Rule "${i.name}" added.`),Pe.emit(gr.ruleSaved,{rule:i});const{rules:a,tags:o,tagRuleLinks:l}=t();return Pe.emit(gr.dataLoaded,{rules:[...a],tags:[...o],links:[...l]}),r}catch(a){throw console.error("RulesStore: Error adding rule",a),e(o=>({error:"Failed to save new rule",rules:o.rules.filter(l=>l.id!==r)})),je.error("Failed to save new rule."),a}},updateRule:async(n,r)=>{const s=t().rules.find(a=>a.id===n);if(!s)throw je.error("Rule not found for update."),new Error("Rule not found");const i={...s,...r,updatedAt:new Date};e(a=>{const o=a.rules.findIndex(l=>l.id===n);o!==-1&&(a.rules[o]=i,a.rules.sort((l,c)=>l.name.localeCompare(c.name)))});try{await Et.saveRule(i),je.success(`Rule "${i.name}" updated.`),Pe.emit(gr.ruleSaved,{rule:i});const{rules:a,tags:o,tagRuleLinks:l}=t();Pe.emit(gr.dataLoaded,{rules:[...a],tags:[...o],links:[...l]})}catch(a){throw console.error("RulesStore: Error updating rule",a),e(o=>{const l=o.rules.findIndex(c=>c.id===n);l!==-1&&(o.rules[l]=s,o.rules.sort((c,u)=>c.name.localeCompare(u.name))),o.error="Failed to save rule update"}),je.error("Failed to save rule update."),a}},deleteRule:async n=>{const r=t().rules.find(a=>a.id===n);if(!r)throw je.error("Rule not found for deletion."),new Error("Rule not found");const s=[...t().tagRuleLinks.filter(a=>a.ruleId===n)],i={...r};e(a=>{a.rules=a.rules.filter(o=>o.id!==n),a.tagRuleLinks=a.tagRuleLinks.filter(o=>o.ruleId!==n)});try{await Et.deleteRule(n),je.success(`Rule "${r.name}" deleted.`),Pe.emit(gr.ruleDeleted,{ruleId:n});const{rules:a,tags:o,tagRuleLinks:l}=t();Pe.emit(gr.dataLoaded,{rules:[...a],tags:[...o],links:[...l]})}catch(a){throw console.error("RulesStore: Error deleting rule",a),e(o=>{o.rules.find(l=>l.id===i.id)||(o.rules.push(i),o.rules.sort((l,c)=>l.name.localeCompare(c.name))),s.forEach(l=>{o.tagRuleLinks.find(c=>c.tagId===l.tagId&&c.ruleId===l.ruleId)||o.tagRuleLinks.push(l)}),o.error="Failed to delete rule"}),je.error("Failed to delete rule."),a}},addTag:async n=>{const r=Vi(),s=new Date,i={id:r,createdAt:s,updatedAt:s,...n};e(a=>{a.tags.push(i),a.tags.sort((o,l)=>o.name.localeCompare(l.name))});try{await Et.saveTag(i),je.success(`Tag "${i.name}" added.`),Pe.emit(gr.tagSaved,{tag:i});const{rules:a,tags:o,tagRuleLinks:l}=t();return Pe.emit(gr.dataLoaded,{rules:[...a],tags:[...o],links:[...l]}),r}catch(a){throw console.error("RulesStore: Error adding tag",a),e(o=>({error:"Failed to save new tag",tags:o.tags.filter(l=>l.id!==r)})),je.error("Failed to save new tag."),a}},updateTag:async(n,r)=>{const s=t().tags.find(a=>a.id===n);if(!s)throw je.error("Tag not found for update."),new Error("Tag not found");const i={...s,...r,updatedAt:new Date};e(a=>{const o=a.tags.findIndex(l=>l.id===n);o!==-1&&(a.tags[o]=i,a.tags.sort((l,c)=>l.name.localeCompare(c.name)))});try{await Et.saveTag(i),je.success(`Tag "${i.name}" updated.`),Pe.emit(gr.tagSaved,{tag:i});const{rules:a,tags:o,tagRuleLinks:l}=t();Pe.emit(gr.dataLoaded,{rules:[...a],tags:[...o],links:[...l]})}catch(a){throw console.error("RulesStore: Error updating tag",a),e(o=>{const l=o.tags.findIndex(c=>c.id===n);l!==-1&&(o.tags[l]=s,o.tags.sort((c,u)=>c.name.localeCompare(u.name))),o.error="Failed to save tag update"}),je.error("Failed to save tag update."),a}},deleteTag:async n=>{const r=t().tags.find(a=>a.id===n);if(!r)throw je.error("Tag not found for deletion."),new Error("Tag not found");const s={...r},i=[...t().tagRuleLinks.filter(a=>a.tagId===n)];e(a=>{a.tags=a.tags.filter(o=>o.id!==n),a.tagRuleLinks=a.tagRuleLinks.filter(o=>o.tagId!==n)});try{await Et.deleteTag(n),je.success(`Tag "${r.name}" deleted.`),Pe.emit(gr.tagDeleted,{tagId:n});const{rules:a,tags:o,tagRuleLinks:l}=t();Pe.emit(gr.dataLoaded,{rules:[...a],tags:[...o],links:[...l]})}catch(a){throw console.error("RulesStore: Error deleting tag",a),e(o=>{o.tags.find(l=>l.id===s.id)||(o.tags.push(s),o.tags.sort((l,c)=>l.name.localeCompare(c.name))),i.forEach(l=>{o.tagRuleLinks.find(c=>c.tagId===l.tagId&&c.ruleId===l.ruleId)||o.tagRuleLinks.push(l)}),o.error="Failed to delete tag"}),je.error("Failed to delete tag."),a}},linkTagToRule:async(n,r)=>{const s=`${n}-${r}`;if(t().tagRuleLinks.some(a=>a.id===s)){je.info("Link already exists.");return}const i={id:s,tagId:n,ruleId:r};e(a=>{a.tagRuleLinks.push(i)});try{await Et.saveTagRuleLink(i),je.success("Tag linked to rule."),gr.linkSaved&&Pe.emit(gr.linkSaved,{link:i});const{rules:a,tags:o,tagRuleLinks:l}=t();Pe.emit(gr.dataLoaded,{rules:[...a],tags:[...o],links:[...l]})}catch(a){throw console.error("RulesStore: Error linking tag to rule",a),e(o=>{o.tagRuleLinks=o.tagRuleLinks.filter(l=>l.id!==s),o.error="Failed to link tag to rule"}),je.error("Failed to link tag to rule."),a}},unlinkTagFromRule:async(n,r)=>{const s=`${n}-${r}`,i=t().tagRuleLinks.find(a=>a.id===s);i||je.info("Link not found for unlinking."),e(a=>{a.tagRuleLinks=a.tagRuleLinks.filter(o=>o.id!==s)});try{await Et.deleteTagRuleLink(s),je.success("Tag unlinked from rule."),gr.linkDeleted&&Pe.emit(gr.linkDeleted,{linkId:s});const{rules:a,tags:o,tagRuleLinks:l}=t();Pe.emit(gr.dataLoaded,{rules:[...a],tags:[...o],links:[...l]})}catch(a){throw console.error("RulesStore: Error unlinking tag from rule",a),i&&e(o=>{o.tagRuleLinks.some(l=>l.id===i.id)||o.tagRuleLinks.push(i),o.error="Failed to unlink tag from rule"}),je.error("Failed to unlink tag from rule."),a}},getRulesForTag:n=>{const r=t(),s=new Set(r.tagRuleLinks.filter(i=>i.tagId===n).map(i=>i.ruleId));return r.rules.filter(i=>s.has(i.id))},getTagsForRule:n=>{const r=t(),s=new Set(r.tagRuleLinks.filter(i=>i.ruleId===n).map(i=>i.tagId));return r.tags.filter(i=>s.has(i.id))},getRuleById:n=>t().rules.find(r=>r.id===n),getTagById:n=>t().tags.find(r=>r.id===n),getRulesByIds:n=>{const r=new Set(n);return t().rules.filter(s=>r.has(s.id))},getRegisteredActionHandlers:()=>{const n="rulesStore",r=t(),s=i=>async a=>{await i(a)};return[{eventName:gr.loadRulesAndTagsRequest,handler:r.loadRulesAndTags,storeId:n},{eventName:gr.addRuleRequest,handler:s(r.addRule),storeId:n},{eventName:gr.updateRuleRequest,handler:i=>r.updateRule(i.id,i.updates),storeId:n},{eventName:gr.deleteRuleRequest,handler:i=>r.deleteRule(i.id),storeId:n},{eventName:gr.addTagRequest,handler:s(r.addTag),storeId:n},{eventName:gr.updateTagRequest,handler:i=>r.updateTag(i.id,i.updates),storeId:n},{eventName:gr.deleteTagRequest,handler:i=>r.deleteTag(i.id),storeId:n},{eventName:gr.linkTagToRuleRequest,handler:i=>r.linkTagToRule(i.tagId,i.ruleId),storeId:n},{eventName:gr.unlinkTagFromRuleRequest,handler:i=>r.unlinkTagFromRule(i.tagId,i.ruleId),storeId:n}]}}))),Xa={promptTemplatesChanged:"prompt-template.prompts.changed",promptTemplateAdded:"prompt-template.added",promptTemplateUpdated:"prompt-template.updated",promptTemplateDeleted:"prompt-template.deleted",loadPromptTemplatesRequest:"prompt-template.load.request",addPromptTemplateRequest:"prompt-template.add.request",updatePromptTemplateRequest:"prompt-template.update.request",deletePromptTemplateRequest:"prompt-template.delete.request",selectPromptTemplateRequest:"prompt-template.select.request",compilePromptTemplateRequest:"prompt-template.compile.request"},Om=$o(zo((e,t)=>({promptTemplates:[],loading:!1,error:null,loadPromptTemplates:async()=>{e(n=>{n.loading=!0,n.error=null});try{const n=await Et.loadPromptTemplates();e(r=>{r.promptTemplates=n,r.loading=!1}),Pe.emit(Xa.promptTemplatesChanged,{promptTemplates:n})}catch(n){const r=n instanceof Error?n.message:"Failed to load prompt templates";e(s=>{s.error=r,s.loading=!1}),je.error(r)}},addPromptTemplate:async n=>{const r={id:Vi(),createdAt:new Date,updatedAt:new Date,...n};e(s=>{s.promptTemplates.push(r)});try{return await Et.savePromptTemplate(r),Pe.emit(Xa.promptTemplateAdded,{promptTemplate:r}),je.success("Prompt template created successfully"),r.id}catch(s){e(a=>{a.promptTemplates=a.promptTemplates.filter(o=>o.id!==r.id)});const i=s instanceof Error?s.message:"Failed to create prompt template";throw e(a=>{a.error=i}),je.error(i),s}},updatePromptTemplate:async(n,r)=>{const s=t().promptTemplates.find(a=>a.id===n);if(!s){je.error("Prompt template not found");return}const i={...s,...r,updatedAt:new Date};e(a=>{const o=a.promptTemplates.findIndex(l=>l.id===n);o!==-1&&(a.promptTemplates[o]=i)});try{await Et.savePromptTemplate(i),Pe.emit(Xa.promptTemplateUpdated,{promptTemplate:i}),je.success("Prompt template updated successfully")}catch(a){e(l=>{const c=l.promptTemplates.findIndex(u=>u.id===n);c!==-1&&(l.promptTemplates[c]=s)});const o=a instanceof Error?a.message:"Failed to update prompt template";throw e(l=>{l.error=o}),je.error(o),a}},deletePromptTemplate:async n=>{const r=t().promptTemplates.find(s=>s.id===n);if(!r){je.error("Prompt template not found");return}e(s=>{s.promptTemplates=s.promptTemplates.filter(i=>i.id!==n)});try{await Et.deletePromptTemplate(n),Pe.emit(Xa.promptTemplateDeleted,{id:n}),je.success("Prompt template deleted successfully")}catch(s){e(a=>{a.promptTemplates.push(r)});const i=s instanceof Error?s.message:"Failed to delete prompt template";throw e(a=>{a.error=i}),je.error(i),s}},compilePromptTemplate:async(n,r)=>{const s=t().promptTemplates.find(i=>i.id===n);if(!s)throw new Error("Template not found");try{let i=s.prompt;for(const o of s.variables){const l=r[o.name],c=[new RegExp(`{{\\s*${o.name}\\s*}}`,"g"),new RegExp(`{{${o.name}}}`,"g"),new RegExp(`{{ ${o.name} }}`,"g")];if(l!=null){let u;typeof l=="object"?u=JSON.stringify(l):u=String(l);for(const d of c){const h=i;i=i.replace(d,u),h!==i&&console.log(`Replaced "${o.name}" using pattern ${d} in:`,h,"→",i)}}else{if(o.required)throw new Error(`Required variable "${o.name}" is missing`);if(o.default)for(const u of c)i=i.replace(u,o.default)}}return{content:i,selectedTools:s.tools,selectedRules:s.rules}}catch(i){const a=i instanceof Error?i.message:"Failed to compile prompt template";throw je.error(a),i}},getTemplatesByType:n=>t().promptTemplates.filter(r=>(r.type||"prompt")===n),getAgents:()=>t().promptTemplates.filter(n=>(n.type||"prompt")==="agent"),getTasksForAgent:n=>t().promptTemplates.filter(r=>(r.type||"prompt")==="task"&&r.parentId===n),getAvailableFollowUps:(n,r)=>{const s=t().promptTemplates,i=s.find(a=>a.id===n);return r==="task"&&(i!=null&&i.parentId)?s.filter(a=>(a.type||"prompt")==="task"&&a.parentId===i.parentId&&a.id!==n):s.filter(a=>(a.type||"prompt")==="prompt"&&a.id!==n)},getRegisteredActionHandlers:()=>{const n=t();return[{eventName:Xa.loadPromptTemplatesRequest,handler:()=>n.loadPromptTemplates(),storeId:"promptTemplateStore"},{eventName:Xa.addPromptTemplateRequest,handler:async r=>{await n.addPromptTemplate(r.promptTemplate)},storeId:"promptTemplateStore"},{eventName:Xa.updatePromptTemplateRequest,handler:r=>n.updatePromptTemplate(r.id,r.updates),storeId:"promptTemplateStore"},{eventName:Xa.deletePromptTemplateRequest,handler:r=>n.deletePromptTemplate(r.id),storeId:"promptTemplateStore"},{eventName:Xa.compilePromptTemplateRequest,handler:async r=>{await n.compilePromptTemplate(r.templateId,r.formData)},storeId:"promptTemplateStore"}]}}))),kr={serversChanged:"mcp.servers.changed",serverAdded:"mcp.server.added",serverUpdated:"mcp.server.updated",serverDeleted:"mcp.server.deleted",serverConnectionChanged:"mcp.server.connection.changed",toolsChanged:"mcp.tools.changed",retryAttemptsChanged:"mcp.retry.attempts.changed",retryDelayChanged:"mcp.retry.delay.changed",connectionTimeoutChanged:"mcp.connection.timeout.changed",maxResponseSizeChanged:"mcp.max.response.size.changed",bridgeConfigChanged:"mcp.bridge.config.changed",beforeToolCall:"mcp.tool.before.call",afterToolCall:"mcp.tool.after.call",toolCallFailed:"mcp.tool.call.failed",beforeToolExecution:"mcp.tool.before.execution",toolDiscovered:"mcp.tool.discovered",toolRegistered:"mcp.tool.registered",toolUnregistered:"mcp.tool.unregistered",setServersRequest:"mcp.set.servers.request",addServerRequest:"mcp.add.server.request",updateServerRequest:"mcp.update.server.request",deleteServerRequest:"mcp.delete.server.request",connectServerRequest:"mcp.connect.server.request",disconnectServerRequest:"mcp.disconnect.server.request",refreshToolsRequest:"mcp.refresh.tools.request",loadMcpStateRequest:"mcp.load.state.request",resetMcpStateRequest:"mcp.reset.state.request",setRetryAttemptsRequest:"mcp.set.retry.attempts.request",setRetryDelayRequest:"mcp.set.retry.delay.request",setConnectionTimeoutRequest:"mcp.set.connection.timeout.request",setMaxResponseSizeRequest:"mcp.set.max.response.size.request"},cx=3,ux=2e3,dx=1e4,fx=128e3,aQe={servers:[],serverStatuses:{},loading:!1,error:null,retryAttempts:cx,retryDelay:ux,connectionTimeout:dx,maxResponseSize:fx,bridgeConfig:{}},rl=$o(zo((e,t)=>({...aQe,setServers:n=>{e(r=>{r.servers=n,r.error=null}),Et.saveSetting("mcpServers",n).catch(r=>{console.error("Failed to persist MCP servers:",r)}),Pe.emit(kr.serversChanged,{servers:n})},addServer:n=>{const r={...n,id:`mcp_${Date.now()}_${Math.random().toString(36).substr(2,9)}`};e(i=>{i.servers.push(r),i.error=null});const s=t().servers;Et.saveSetting("mcpServers",s).catch(i=>{console.error("Failed to persist MCP servers:",i)}),Pe.emit(kr.serverAdded,{server:r}),Pe.emit(kr.serversChanged,{servers:s})},updateServer:(n,r)=>{let s=null;if(e(i=>{const a=i.servers.findIndex(o=>o.id===n);a!==-1&&(i.servers[a]={...i.servers[a],...r},s=i.servers[a],i.error=null)}),s){const i=t().servers;Et.saveSetting("mcpServers",i).catch(a=>{console.error("Failed to persist MCP servers:",a)}),Pe.emit(kr.serverUpdated,{server:s}),Pe.emit(kr.serversChanged,{servers:i})}},deleteServer:n=>{e(s=>{s.servers=s.servers.filter(i=>i.id!==n),delete s.serverStatuses[n],s.error=null});const r=t().servers;Et.saveSetting("mcpServers",r).catch(s=>{console.error("Failed to persist MCP servers:",s)}),Pe.emit(kr.serverDeleted,{serverId:n}),Pe.emit(kr.serversChanged,{servers:r})},setServerStatus:n=>{e(r=>{r.serverStatuses[n.serverId]=n}),Pe.emit(kr.serverConnectionChanged,{serverId:n.serverId,connected:n.connected,error:n.error}),n.tools.length>0&&Pe.emit(kr.toolsChanged,{serverId:n.serverId,tools:n.tools})},clearServerStatus:n=>{e(r=>{delete r.serverStatuses[n]}),Pe.emit(kr.serverConnectionChanged,{serverId:n,connected:!1})},setRetryAttempts:n=>{const r=Math.max(0,Math.min(10,n));e(s=>{s.retryAttempts=r}),Et.saveSetting("mcpRetryAttempts",r).catch(s=>{console.error("Failed to persist MCP retry attempts:",s)}),Pe.emit(kr.retryAttemptsChanged,{attempts:r})},setRetryDelay:n=>{const r=Math.max(500,Math.min(3e4,n));e(s=>{s.retryDelay=r}),Et.saveSetting("mcpRetryDelay",r).catch(s=>{console.error("Failed to persist MCP retry delay:",s)}),Pe.emit(kr.retryDelayChanged,{delay:r})},setConnectionTimeout:n=>{const r=Math.max(1e3,Math.min(6e4,n));e(s=>{s.connectionTimeout=r}),Et.saveSetting("mcpConnectionTimeout",r).catch(s=>{console.error("Failed to persist MCP connection timeout:",s)}),Pe.emit(kr.connectionTimeoutChanged,{timeout:r})},setMaxResponseSize:n=>{const r=Math.max(1e3,Math.min(1e7,n));e(s=>{s.maxResponseSize=r}),Et.saveSetting("mcpMaxResponseSize",r).catch(s=>{console.error("Failed to persist MCP max response size:",s)}),Pe.emit(kr.maxResponseSizeChanged,{size:r})},setBridgeConfig:n=>{e(r=>{r.bridgeConfig={...n}}),Et.saveSetting("mcpBridgeConfig",n).catch(r=>{console.error("Failed to persist MCP bridge config:",r)}),Pe.emit(kr.bridgeConfigChanged,{config:n})},setLoading:n=>{e(r=>{r.loading=n})},setError:n=>{e(r=>{r.error=n})},loadMcpState:async()=>{try{e(l=>{l.loading=!0,l.error=null});const[n,r,s,i,a,o]=await Promise.all([Et.loadSetting("mcpServers",[]),Et.loadSetting("mcpRetryAttempts",cx),Et.loadSetting("mcpRetryDelay",ux),Et.loadSetting("mcpConnectionTimeout",dx),Et.loadSetting("mcpMaxResponseSize",fx),Et.loadSetting("mcpBridgeConfig",{})]);e(l=>{l.servers=n||[],l.retryAttempts=r,l.retryDelay=s,l.connectionTimeout=i,l.maxResponseSize=a,l.bridgeConfig=o||{},l.loading=!1}),Pe.emit(kr.serversChanged,{servers:n||[]}),Pe.emit(kr.retryAttemptsChanged,{attempts:r}),Pe.emit(kr.retryDelayChanged,{delay:s}),Pe.emit(kr.connectionTimeoutChanged,{timeout:i}),Pe.emit(kr.maxResponseSizeChanged,{size:a}),Pe.emit(kr.bridgeConfigChanged,{config:o||{}})}catch(n){console.error("Failed to load MCP state:",n),e(r=>{r.error=n.message||"Failed to load MCP state",r.loading=!1})}},resetMcpState:()=>{e(n=>{n.servers=[],n.serverStatuses={},n.retryAttempts=cx,n.retryDelay=ux,n.connectionTimeout=dx,n.maxResponseSize=fx,n.bridgeConfig={},n.loading=!1,n.error=null}),Promise.all([Et.saveSetting("mcpServers",[]),Et.saveSetting("mcpRetryAttempts",cx),Et.saveSetting("mcpRetryDelay",ux),Et.saveSetting("mcpConnectionTimeout",dx),Et.saveSetting("mcpMaxResponseSize",fx)]).catch(n=>{console.error("Failed to clear MCP settings from storage:",n)}),Pe.emit(kr.serversChanged,{servers:[]}),Pe.emit(kr.retryAttemptsChanged,{attempts:cx}),Pe.emit(kr.retryDelayChanged,{delay:ux}),Pe.emit(kr.connectionTimeoutChanged,{timeout:dx}),Pe.emit(kr.maxResponseSizeChanged,{size:fx})},getRegisteredActionHandlers:()=>{const n=t();return[{eventName:kr.setServersRequest,handler:r=>n.setServers(r.servers),storeId:"mcpStore"},{eventName:kr.addServerRequest,handler:r=>n.addServer(r.server),storeId:"mcpStore"},{eventName:kr.updateServerRequest,handler:r=>n.updateServer(r.id,r.updates),storeId:"mcpStore"},{eventName:kr.deleteServerRequest,handler:r=>n.deleteServer(r.id),storeId:"mcpStore"},{eventName:kr.setRetryAttemptsRequest,handler:r=>n.setRetryAttempts(r.attempts),storeId:"mcpStore"},{eventName:kr.setRetryDelayRequest,handler:r=>n.setRetryDelay(r.delay),storeId:"mcpStore"},{eventName:kr.setConnectionTimeoutRequest,handler:r=>n.setConnectionTimeout(r.timeout),storeId:"mcpStore"},{eventName:kr.setMaxResponseSizeRequest,handler:r=>n.setMaxResponseSize(r.size),storeId:"mcpStore"},{eventName:kr.loadMcpStateRequest,handler:()=>n.loadMcpState(),storeId:"mcpStore"},{eventName:kr.resetMcpStateRequest,handler:()=>n.resetMcpState(),storeId:"mcpStore"}]},exportProxyConfig:()=>t().servers.map(r=>({id:r.id,name:r.name,url:r.url,enabled:r.enabled}))}))),oQe=[yr,Nr,ple,qn,Fo,$n,mh,Po,Oh,Jw,Js,jo,Om,rl];class mle{static initialize(){if(this.isInitialized){console.warn("[Coordinator] Already initialized. Skipping re-initialization.");return}console.log("[Coordinator] Initializing dynamic event listeners for action requests...");const t=[];oQe.forEach(n=>{const r=n.getState();if(r&&typeof r.getRegisteredActionHandlers=="function")try{const s=r.getRegisteredActionHandlers();Array.isArray(s)?t.push(...s):console.warn(`[Coordinator] getRegisteredActionHandlers for store did not return an array. Store ID: ${r.id||"Unknown"}`)}catch(s){console.error("[Coordinator] Error calling getRegisteredActionHandlers for a store:",s)}}),t.length===0?console.warn("[Coordinator] No action handlers were registered by any store."):t.forEach(n=>{n&&n.eventName&&typeof n.handler=="function"?Pe.on(n.eventName,n.handler):console.error("[Coordinator] Invalid action handler structure encountered:",n)}),this.isInitialized=!0,console.log(`[Coordinator] Dynamic event listeners initialized. Total handlers: ${t.length}.`)}}me(mle,"isInitialized",!1);const lQe=()=>{const[e,t]=T.useState({}),n=jo(r=>r.modalProviders);return T.useEffect(()=>{const r=i=>{t(a=>({...a,[i.modalId]:{...i,isOpen:!0}})),Pe.emit(Pr.modalStateChanged,{...i,isOpen:!0})},s=i=>{t(a=>{const o={...a};return o[i.modalId]&&(o[i.modalId].isOpen=!1),o}),Pe.emit(Pr.modalStateChanged,{modalId:i.modalId,isOpen:!1})};return Pe.on(Pr.openModalRequest,r),Pe.on(Pr.closeModalRequest,s),()=>{Pe.off(Pr.openModalRequest,r),Pe.off(Pr.closeModalRequest,s)}},[]),f.jsx(f.Fragment,{children:Object.entries(e).map(([r,s])=>{if(!s.isOpen)return null;const i=n[r];if(!i)return console.warn(`[ModalManager] No provider for modalId: ${r}`),null;const a={isOpen:!0,onClose:()=>Pe.emit(Pr.closeModalRequest,{modalId:r}),modalProps:s.modalProps,targetId:s.targetId,initialTab:s.initialTab,initialSubTab:s.initialSubTab};return f.jsx(i,{...a},r)})})};let YV=[],ZV=null,bd=!1;const cQe=({controls:e=[]})=>{const[t,n]=T.useState(!0),[r,s]=T.useState(!1),i=T.useRef(null),a=T.useRef(null),{selectedItemId:o,selectedItemType:l,getConversationById:c}=qn(yn(I=>({selectedItemId:I.selectedItemId,selectedItemType:I.selectedItemType,getConversationById:I.getConversationById}))),{getEffectiveProjectSettings:u}=Fo(yn(I=>({getEffectiveProjectSettings:I.getEffectiveProjectSettings}))),{interactions:d,status:h}=$n(yn(I=>({interactions:I.interactions,status:I.status}))),{globalError:m,isSidebarCollapsed:y,isChatControlPanelOpen:b}=Jw(yn(I=>({globalError:I.globalError,isSidebarCollapsed:I.isSidebarCollapsed,isChatControlPanelOpen:I.isChatControlPanelOpen}))),v=jo(yn(I=>Object.values(I.chatControls))),x=T.useMemo(()=>v.filter(I=>(I.panel??"main")==="sidebar"&&(I.show?I.show():!0)),[v]),w=T.useMemo(()=>v.filter(I=>I.panel==="sidebar-footer"&&(I.show?I.show():!0)),[v]),S=T.useMemo(()=>v.filter(I=>I.panel==="header"&&(I.show?I.show():!0)),[v]),C=T.useCallback(()=>{s(I=>!I)},[]);T.useEffect(()=>{r&&o&&(l==="conversation"||l==="project")&&s(!1)},[o,l]),T.useEffect(()=>{a.current||(a.current=mP({id:"core-litechat-app",name:"LiteChat App Core"}));const I=a.current;mle.initialize(),ZV||(ZV=(async()=>{if(bd){n(!1);return}n(!0);try{YV=await iQe(e,I),bd=!0}catch(L){console.error("[LiteChat] App: Top-level initialization error:",L),bd=!1}finally{n(!1)}})().then(()=>YV))},[e]);const k=T.useRef({itemId:null,itemType:null,effectiveSettingsString:""});T.useEffect(()=>{if(t||!bd||!a.current)return;const I=a.current,P={itemId:o,itemType:l};let L=null;if(l==="project")L=o;else if(l==="conversation"&&o){const D=c(o);L=(D==null?void 0:D.projectId)??null}const O=u(L),V=JSON.stringify(O);(P.itemId!==k.current.itemId||P.itemType!==k.current.itemType||V!==k.current.effectiveSettingsString)&&(I.emit(Nn.initializePromptStateRequest,{effectiveSettings:O}),I.emit(Pr.contextChanged,{selectedItemId:o,selectedItemType:l}),k.current={...P,effectiveSettingsString:V})},[o,l,c,u,t,bd]),T.useEffect(()=>{if(t||!bd||!a.current)return;const I=a.current,P=()=>{let Z=null;if(l==="project")Z=o;else if(l==="conversation"&&o){const H=c(o);Z=(H==null?void 0:H.projectId)??null}const U=u(Z);I.emit(Nn.initializePromptStateRequest,{effectiveSettings:U})},L=I.on(sn.loaded,P),O=I.on(va.updated,P),V=I.on(sn.globalSystemPromptChanged,P),D=I.on(sn.temperatureChanged,P);return()=>{L(),O(),V(),D()}},[o,l,c,u,t,bd]),T.useEffect(()=>{if(t||!bd||!a.current)return;const I=a.current;let P=null;if(b["core-vfs-modal-panel"]||l==="project")if(l==="project")P=o;else if(l==="conversation"){const V=c(o);P=(V==null?void 0:V.projectId)??"orphan"}else P="orphan";else if(l==="conversation"){const V=c(o);P=(V==null?void 0:V.projectId)??"orphan"}let O=null;typeof P=="string"?O=P:P===null?O=null:(console.warn(`[LiteChatVFS] Calculated VFS key was not a string or null. Type: ${typeof P}, Value:`,P,"Defaulting to 'orphan'."),O="orphan"),Js.getState().vfsKey!==O&&I.emit(dn.setVfsKeyRequest,{key:O})},[o,l,c,t,bd,b]);const A=async I=>{const P=qn.getState(),L=await P.addConversation(I);return console.log("New conversation ID:",L),await P.selectItem(L,"conversation"),console.log("conv selected:",L),L},R=T.useCallback(async I=>{var V;if(!a.current){je.error("Application core not ready. Please try again.");return}const P=qn.getState();let L=P.selectedItemType==="conversation"?P.selectedItemId:null;const O=P.selectedItemType==="project"?P.selectedItemId:P.selectedItemType==="conversation"?((V=P.getConversationById(P.selectedItemId))==null?void 0:V.projectId)??null:null;if(!L)try{L=await A({title:"New Chat",projectId:O}),console.log("New conversation ID 2:",L)}catch(D){console.error("[LiteChat] App: Failed to create new conversation",D),je.error("Failed to start new chat.");return}try{const D=Po.getState(),Z={...I,metadata:{...I.metadata,modelId:D.modelId}};await Ex.submitPrompt(Z)}catch(D){console.error("[LiteChat] App: Error submitting prompt:",D),je.error("Failed to send message.")}},[]),N=l==="conversation"?o:null;return t?f.jsx("div",{className:"flex items-center justify-center h-screen w-screen bg-background text-foreground",children:f.jsxs("div",{className:"flex flex-col items-center gap-4",children:[f.jsx(Qn,{className:"h-12 w-12 animate-spin text-primary"}),f.jsx("p",{className:"text-lg text-muted-foreground",children:"Initializing LiteChat..."})]})}):f.jsxs(f.Fragment,{children:[f.jsx(lQe,{}),f.jsxs("div",{className:"flex h-full w-full border border-border rounded-lg overflow-hidden bg-background text-foreground",children:[f.jsxs("div",{className:Ze("hidden md:flex flex-col border-r border-border bg-card","transition-[width] duration-300 ease-in-out","flex-shrink-0 overflow-hidden",y?"w-16":"w-64"),children:[f.jsxs("div",{className:"flex-grow overflow-y-auto overflow-x-hidden",children:[f.jsx("div",{className:Ze(y?"hidden":"block"),children:f.jsx(a0,{controls:x,panelId:"sidebar",renderMode:"full",className:"h-full"})}),f.jsx("div",{className:Ze(y?"block":"hidden"),children:f.jsx(a0,{controls:x,panelId:"sidebar",renderMode:"icon",className:"flex flex-col items-center gap-2 p-2"})})]}),f.jsx("div",{className:Ze("flex-shrink-0 border-t border-border p-2",y?"flex flex-col items-center gap-2":"flex items-center justify-center"),children:f.jsx(a0,{controls:w,panelId:"sidebar-footer",renderMode:y?"icon":"full",className:Ze("flex",y?"flex-col gap-2 items-center":"items-center gap-1 justify-center")})})]}),r&&f.jsxs("div",{className:"md:hidden fixed inset-0 z-40 flex",children:[f.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm animate-fadeIn",onClick:C}),f.jsxs("div",{className:"relative w-4/5 max-w-sm bg-card border-r border-border h-full flex flex-col animate-slideInFromLeft shadow-2xl",children:[f.jsxs("div",{className:"sticky top-0 z-10 flex justify-between items-center p-4 border-b border-border bg-card",children:[f.jsx("h2",{className:"font-semibold text-card-foreground",children:"LiteChat Menu"}),f.jsx("button",{onClick:C,className:"p-2 rounded-md hover:bg-muted text-card-foreground touch-manipulation","aria-label":"Close menu",style:{minHeight:"44px",minWidth:"44px"},children:f.jsx(qi,{className:"h-5 w-5"})})]}),f.jsx("div",{className:"flex-grow overflow-y-auto overflow-x-hidden bg-card",children:x.length>0?f.jsx(a0,{controls:x,panelId:"sidebar",renderMode:"full",className:"h-full"}):f.jsxs("div",{className:"p-4 text-center text-muted-foreground",children:[f.jsx("p",{className:"text-sm",children:"Loading menu..."}),f.jsx("p",{className:"text-xs mt-2",children:"Please wait while the application initializes."})]})}),f.jsx("div",{className:"flex-shrink-0 border-t border-border p-4 bg-card",children:w.length>0?f.jsx(a0,{controls:w,panelId:"sidebar-footer",renderMode:"full",className:"flex items-center justify-between"}):f.jsx("div",{className:"text-center text-muted-foreground text-xs",children:"Footer controls loading..."})})]})]}),f.jsxs("div",{className:"flex flex-col flex-grow min-w-0",children:[f.jsxs("div",{className:"flex items-center justify-between p-2 border-b border-border bg-card flex-shrink-0",children:[f.jsx("button",{className:Ze("md:hidden p-3 rounded-md hover:bg-muted active:bg-muted/80 transition-colors touch-manipulation",r&&"bg-muted"),onClick:C,"aria-label":r?"Close menu":"Open menu",style:{minHeight:"44px",minWidth:"44px"},children:r?f.jsx(qi,{className:"h-6 w-6"}):f.jsx(zme,{className:"h-6 w-6"})}),f.jsx(a0,{controls:S,panelId:"header",className:"flex items-center justify-end gap-1 flex-grow"})]}),f.jsx(WJe,{conversationId:N,interactions:d,status:h,className:"flex-grow overflow-y-hidden"}),m&&f.jsxs("div",{className:"p-2 bg-destructive text-destructive-foreground text-sm text-center",children:["Error: ",m]}),f.jsx(oxe,{InputAreaRenderer:fle,onSubmit:R,className:"border-t border-border bg-card flex-shrink-0",inputAreaRef:i,selectedItemId:o,selectedItemType:l})]})]}),f.jsx(ZJe,{richColors:!0,position:"bottom-right",closeButton:!0})]})},uQe="prism-theme-link",dQe="prism-default-light-theme-link",fQe="prism-default-dark-theme-link",hQe="https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-material-light.min.css",pQe="https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-vsc-dark-plus.min.css",b3=e=>{let t=document.getElementById(e);return t||(t=document.createElement("link"),t.id=e,t.rel="stylesheet",document.head.appendChild(t)),t},mQe=()=>{const{prismThemeUrl:e,theme:t}=yr(yn(s=>({prismThemeUrl:s.prismThemeUrl,theme:s.theme}))),n=T.useMemo(()=>typeof window>"u"?"light":window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light",[]),r=T.useMemo(()=>{const s=t==="system"?n:t;return s==="dark"||s==="TijuDark"?"dark":"light"},[t,n]);return T.useEffect(()=>{if(typeof window>"u")return;const s=b3(dQe),i=b3(fQe),a=b3(uQe);return s.disabled=!0,i.disabled=!0,a.disabled=!0,s.href=hQe,i.href=pQe,e?(a.href=e,a.disabled=!1):r==="dark"?i.disabled=!1:s.disabled=!1,()=>{}},[e,r]),null},v3=e=>e.replace(/([a-z0-9]|(?=[A-Z]))([A-Z])/g,"$1-$2").toLowerCase(),x3=["background","foreground","card","cardForeground","popover","popoverForeground","primary","primaryForeground","secondary","secondaryForeground","muted","mutedForeground","accent","accentForeground","destructive","destructiveForeground","border","input","ring","chart1","chart2","chart3","chart4","chart5","sidebar","sidebarForeground","sidebarPrimary","sidebarPrimaryForeground","sidebarAccent","sidebarAccentForeground","sidebarBorder","sidebarRing"],gQe=()=>{const{theme:e,customFontFamily:t,customFontSize:n,customThemeColors:r}=yr(yn(s=>({theme:s.theme,customFontFamily:s.customFontFamily,customFontSize:s.customFontSize,customThemeColors:s.customThemeColors})));return T.useEffect(()=>{const s=document.body,i=document.documentElement;s.classList.remove("light","dark","TijuLight","TijuDark","custom"),x3.forEach(a=>{i.style.removeProperty(`--${v3(a)}`)}),i.style.removeProperty("--custom-font-family"),i.style.removeProperty("--custom-font-size"),e==="light"?s.classList.add("light"):e==="dark"?s.classList.add("dark"):e==="TijuLight"?s.classList.add("TijuLight"):e==="TijuDark"?s.classList.add("TijuDark"):e==="custom"?(s.classList.add("custom"),t?i.style.setProperty("--custom-font-family",t):i.style.removeProperty("--custom-font-family"),n?i.style.setProperty("--custom-font-size",`${n}px`):i.style.removeProperty("--custom-font-size"),r&&Object.entries(r).forEach(([a,o])=>{if(o&&x3.includes(a)){const l=`--${v3(a)}`;i.style.setProperty(l,o)}else if(x3.includes(a)){const l=`--${v3(a)}`;i.style.removeProperty(l)}})):window.matchMedia("(prefers-color-scheme: dark)").matches?s.classList.add("dark"):s.classList.add("light")},[e,t,n,r]),null},yQe=e=>{const{size:t=24,color:n="currentColor",...r}=e;return f.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:t,height:t,viewBox:"0 0 512 512",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",...r,children:[f.jsx("g",{transform:"translate(0.000000,512.000000) scale(0.100000,-0.100000)",fill:n,stroke:"none",children:f.jsx("path",{d:`M2310 5053 c-1035 -101 -1883 -794 -2159 -1764 -55 -194 -79 -338
-91 -552 -18 -323 20 -620 117 -907 92 -272 238 -543 404 -747 33 -39 59 -75
59 -78 0 -4 -49 -129 -109 -279 -252 -624 -251 -621 -196 -676 57 -56 73 -53
351 58 137 55 349 143 472 195 l223 95 77 -38 c221 -109 437 -179 680 -219
132 -23 411 -44 475 -37 23 3 85 8 137 11 404 26 806 168 1180 417 282 188
571 489 759 792 400 642 467 1498 174 2216 -179 439 -495 826 -888 1088 -361
239 -743 378 -1165 422 -88 9 -419 11 -500 3z m404 -463 c-1 -30 -17 -128 -36
-217 l-34 -163 137 0 c128 0 139 -1 149 -20 11 -21 4 -44 -22 -72 -7 -7 -68
-75 -135 -150 l-123 -136 0 -175 0 -175 238 -4 c265 -5 329 -16 469 -82 220
-105 414 -311 486 -519 l24 -68 86 -4 c129 -7 195 -43 236 -130 20 -42 21 -61
21 -300 0 -240 -1 -258 -21 -297 -46 -90 -115 -127 -235 -128 l-82 0 -11 -47
c-17 -66 -71 -179 -119 -250 -108 -159 -276 -293 -452 -361 -174 -66 -251 -72
-830 -63 l-475 8 -89 27 c-303 91 -554 328 -650 614 l-23 67 -89 5 c-98 6
-131 20 -180 72 -63 66 -64 72 -64 354 0 240 1 261 21 301 40 84 105 119 232
129 l84 7 32 80 c84 215 291 424 513 519 126 53 225 68 466 68 l212 0 0 268 0
267 -126 -3 c-108 -3 -129 -1 -145 14 -10 9 -19 25 -19 35 0 9 111 146 246
304 234 273 247 286 277 283 32 -3 32 -3 31 -58z`})}),f.jsxs("g",{transform:"translate(165, 220) scale(2.5)",children:[f.jsx("path",{d:"M5 5l14 14",stroke:n,strokeWidth:"4"}),f.jsx("path",{d:"M18 5l-14 14",stroke:n,strokeWidth:"4"})]}),f.jsxs("g",{transform:"translate(290, 220) scale(2.5)",children:[f.jsx("path",{d:"M5 5l14 14",stroke:n,strokeWidth:"4"}),f.jsx("path",{d:"M18 5l-14 14",stroke:n,strokeWidth:"4"})]}),f.jsx("g",{transform:"translate(0.000000,512.000000) scale(0.100000,-0.100000)",fill:n,stroke:"none",children:f.jsx("path",{d:`M2147 1750 c-26 15 -48 65 -41 94
             15 61 181 167 304 196
             30 7 100 12 155 12
             81 -1 115 -6 178 -27
             135 -45 247 -133 249 -194
             2 -60 -48 -103 -104 -88
             -13 3 -50 25 -83 50
             -85 64 -172 90 -280 84
             -92 -6 -165 -35 -259 -103
             -49 -35 -86 -43 -119 -24z`})})]})},XV="0.1.0-dev",JV="https://github.com/DimitriGilbert/LiteChat",QV=({textToCopy:e,label:t,className:n})=>{const[r,s]=T.useState(!1),i=async()=>{try{await navigator.clipboard.writeText(e),s(!0),je.success(`${t} copied to clipboard!`),setTimeout(()=>s(!1),2e3)}catch(a){je.error(`Failed to copy ${t.toLowerCase()}.`),console.error(`Clipboard copy failed for ${t}:`,a)}};return f.jsxs(ft,{variant:"outline",onClick:i,className:n,children:[r?f.jsx(so,{className:"mr-2 h-4 w-4 text-green-500"}):f.jsx(Gpe,{className:"mr-2 h-4 w-4"}),r?"Copied!":`Copy ${t}`]})};class bQe extends T.Component{constructor(){super(...arguments);me(this,"state",{hasError:!1,error:null,errorInfo:null});me(this,"handleReportOnGitHub",async()=>{const n=this.generateErrorReport(!0);try{await navigator.clipboard.writeText(n),je.success("Error report copied to clipboard. Paste it into the GitHub issue body.");const r=`${JV}/issues/new?title=${encodeURIComponent(this.getGitHubIssueTitle())}`;window.open(r,"_blank","noopener,noreferrer")}catch(r){je.error("Failed to copy error report. Please copy manually."),console.error("Clipboard copy failed for GitHub report:",r);const s=`${JV}/issues/new?title=${encodeURIComponent(this.getGitHubIssueTitle())}`;window.open(s,"_blank","noopener,noreferrer")}})}static getDerivedStateFromError(n){return{hasError:!0,error:n,errorInfo:null}}componentDidCatch(n,r){console.error("Uncaught error:",n,r),this.setState({errorInfo:r})}getGitHubIssueTitle(){var i;const{error:n,errorInfo:r}=this.state;let s="Crash Report: ";if(r!=null&&r.componentStack){const a=(i=r.componentStack.trim().split(/\s+at\s+/)[1])==null?void 0:i.split(" ")[0];a&&(s+=`Error in <${a}> - `)}return s+=(n==null?void 0:n.message.substring(0,70))??"Unknown Error",n&&n.message.length>70&&(s+="..."),s}generateErrorReport(n=!1){const{error:r,errorInfo:s}=this.state,i=`
`,a=n?"```":"";let o=`## LiteChat Error Report${i}${i}`;return o+=`**Version:** ${XV}${i}`,o+=`**Timestamp:** ${new Date().toISOString()}${i}`,o+=`**User Agent:** ${typeof navigator<"u"?navigator.userAgent:"N/A"}${i}${i}`,r?o+=`**Error Message:**${i}${a}${i}${r.message}${i}${a}${i}${i}`:o+=`**Error Message:** Unknown Error${i}${i}`,s!=null&&s.componentStack&&(o+=`**Component Stack:**${i}${a}text${i}${s.componentStack.trim()}${i}${a}${i}${i}`),r!=null&&r.stack&&(o+=`**Error Stack Trace:**${i}${a}text${i}${r.stack.trim()}${i}${a}${i}${i}`),o+=`**Steps to Reproduce (Please Describe):**${i}1. ...${i}2. ...${i}${i}`,o+=`**Expected Behavior:**${i}...${i}${i}`,o+=`**Actual Behavior:**${i}...${i}`,o}generateAIPrompt(){var i,a;const{error:n,errorInfo:r}=this.state;return`I encountered an error in a React application (LiteChat v${XV}). Please help me debug it.

Error Message:
\`\`\`
${(n==null?void 0:n.message)??"Unknown Error"}
\`\`\`

Component Stack (if available):
\`\`\`
${((i=r==null?void 0:r.componentStack)==null?void 0:i.trim())??"Not available"}
\`\`\`

Error Stack Trace (if available):
\`\`\`
${((a=n==null?void 0:n.stack)==null?void 0:a.trim())??"Not available"}
\`\`\`

Based on this information, what are the likely causes and potential solutions? Focus on React-specific issues if the component stack is present.`}render(){var n;return this.state.hasError?this.props.fallback?this.props.fallback:f.jsx("div",{role:"alert",className:"flex flex-col items-center justify-center h-screen w-screen p-4 bg-background text-foreground",children:f.jsxs("div",{className:"max-w-2xl w-full border border-destructive bg-destructive/10 rounded-lg p-6 text-center shadow-lg",children:[f.jsx(yQe,{className:"h-24 w-24 text-destructive mx-auto mb-4"}),f.jsx("h1",{className:"text-2xl font-semibold text-destructive mb-2",children:"Oops! Something went wrong."}),f.jsx("p",{className:"text-destructive/90 mb-4",children:"LiteChat encountered an unexpected error. Please try refreshing the page. If the problem persists, consider reporting the issue. Copy the details and paste them into the GitHub issue."}),f.jsx("pre",{className:"text-left text-xs bg-destructive/10 border border-destructive/30 rounded p-3 max-h-32 overflow-auto mb-4 font-mono text-destructive/80",children:((n=this.state.error)==null?void 0:n.message)??"Unknown Error"}),f.jsxs("div",{className:"flex flex-wrap justify-center gap-2",children:[f.jsx(ft,{variant:"destructive",onClick:()=>window.location.reload(),children:"Refresh Page"}),f.jsx(QV,{textToCopy:this.generateErrorReport(),label:"Details"}),f.jsx(QV,{textToCopy:this.generateAIPrompt(),label:"AI Debug Prompt"}),f.jsxs(ft,{variant:"outline",onClick:this.handleReportOnGitHub,children:[f.jsx(lH,{className:"mr-2 h-4 w-4"})," Report on GitHub"]})]})]})}):this.props.children}}const gle=(e,t)=>{if(!t)return null;let n=Nc,r="text-muted-foreground/70",s=`Linked to ${t}`;switch(e){case"syncing":n=Qn,r="animate-spin text-blue-500",s=`Syncing with ${t}...`;break;case"error":n=Rc,r="text-destructive",s=`Sync error with ${t}`;break;case"needs-sync":n=LP,r="text-orange-500",s=`Needs sync with ${t}`;break;case"idle":n=uE,r="text-green-500",s=`Synced with ${t}`;break;default:n=Nc,r="text-muted-foreground/70",s=`Linked to ${t} (Status: ${e??"Unknown"})`;break}return f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(n,{className:Ze("h-3 w-3 ml-1 flex-shrink-0",r)})}),f.jsx(Sr,{side:"right",children:s})]})})},yle=T.memo(({item:e,level:t,selectedItemId:n,conversationSyncStatus:r,repoNameMap:s,onSelectItem:i,onDeleteConversation:a,onDeleteProject:o,onExportConversation:l,onExportProject:c,expandedProjects:u,toggleProjectExpansion:d,editingItemId:h,editingItemType:m,handleStartEditing:y,handleSaveEdit:b,handleCancelEdit:v,isSavingEdit:x,originalNameToCompare:w})=>{const S=e.id===n,C=e.itemType==="project",k=e.id===h&&e.itemType===m,[A,R]=T.useState(C?e.name:e.title),N=T.useRef(null);T.useEffect(()=>{if(k){const ce=C?e.name:e.title;R(ce),requestAnimationFrame(()=>{var Ie,De;(Ie=N.current)==null||Ie.focus(),(De=N.current)==null||De.select()})}},[k,e,C]),T.useEffect(()=>{if(!k){const ce=C?e.name:e.title;A!==ce&&R(ce)}},[C?e.name:e.title,k,A,C]);const I=C&&u.has(e.id),P=C,L=!C&&e.syncRepoId?r[e.id]:void 0,O=!C&&e.syncRepoId?s.get(e.syncRepoId):void 0,V=!C&&O?gle(L,O):null,D=ce=>{ce.stopPropagation(),Pe.emit(Pr.openModalRequest,{modalId:"projectSettingsModal",targetId:e.id})},Z=()=>{k||(C&&d(e.id),i(e.id,e.itemType))},U=ce=>{ce.stopPropagation(),C?window.confirm(`Delete project "${e.name}" and ALL its contents (sub-projects and conversations)? This cannot be undone.`)&&o(e.id,ce):a(e.id,ce)},H=ce=>{ce.stopPropagation(),y(e)},$=()=>{R(w),v(e.itemType==="project"&&w==="New Project")},ne=async()=>{if(x)return;const ce=A.trim();await b(e.id,e.itemType,ce)},W=()=>{var De;if(x)return;const ce=A.trim(),Ie=e.itemType==="project"&&w==="New Project";if(!ce){w!=="New Project"?(je.error("Name cannot be empty."),R(w),(De=N.current)==null||De.focus()):$();return}ce!==w||Ie?ne():$()},Q=ce=>{ce.key==="Enter"?(ce.preventDefault(),ne()):ce.key==="Escape"&&(ce.preventDefault(),$())},ee=C?e.name:e.title,se=x?Qn:so,pe=x?"h-3 w-3 animate-spin":"h-3 w-3";return f.jsxs("li",{className:Ze("relative flex justify-between items-center group p-1.5 text-xs rounded","border border-transparent",!k&&"hover:bg-muted/50 hover:text-primary/80",S&&!k?"bg-primary/10 text-primary font-medium border-primary dark:bg-primary/20 dark:border-primary/70":"",k&&"bg-muted ring-1 ring-primary",!k&&"cursor-pointer"),style:{paddingLeft:`${.375+t*.75}rem`},onClick:Z,title:k?"":ee,children:[f.jsxs("div",{className:"flex items-center min-w-0 gap-1 flex-grow mr-1",children:[P&&f.jsx("span",{className:"flex-shrink-0 w-3 cursor-pointer p-0.5 -ml-0.5",onClick:ce=>{ce.stopPropagation(),d(e.id)},children:I?f.jsx(Jl,{className:"h-3 w-3 text-muted-foreground"}):f.jsx(IP,{className:"h-3 w-3 text-muted-foreground"})}),!P&&f.jsx("span",{className:"w-3 flex-shrink-0"}),C?f.jsx(ph,{className:"h-3.5 w-3.5 text-yellow-500 flex-shrink-0"}):f.jsx(V3,{className:"h-3.5 w-3.5 text-blue-400 flex-shrink-0"}),k?f.jsx(_n,{ref:N,value:A,onChange:ce=>R(ce.target.value),onKeyDown:Q,onBlur:W,className:"h-6 px-1 py-0 text-xs flex-grow min-w-0",onClick:ce=>ce.stopPropagation(),disabled:x}):f.jsx("span",{className:"truncate min-w-0 flex-1",children:ee}),V]}),f.jsx("div",{className:Ze("items-center flex-shrink-0 ml-1",k?"flex":"hidden group-hover:flex transition-all duration-150"),onClick:ce=>ce.stopPropagation(),children:k?f.jsxs(f.Fragment,{children:[f.jsx(Dn,{tooltipText:"Save (Enter)",onClick:ce=>{ce.stopPropagation(),ne()},disabled:x||!A.trim(),"aria-label":"Save changes",icon:f.jsx(se,{}),iconClassName:pe,className:"h-5 w-5 text-green-500 hover:text-green-600"}),f.jsx(Dn,{tooltipText:"Cancel (Esc)",onClick:ce=>{ce.stopPropagation(),$()},disabled:x,"aria-label":"Cancel edit",icon:f.jsx(qi,{}),className:"h-5 w-5 text-muted-foreground hover:text-foreground"})]}):f.jsxs(f.Fragment,{children:[C&&f.jsx(Dn,{tooltipText:"Project Settings",onClick:D,"aria-label":`Settings for ${ee}`,icon:f.jsx(qpe,{}),className:"h-5 w-5 text-muted-foreground hover:text-foreground"}),f.jsx(Dn,{tooltipText:"Edit",onClick:H,"aria-label":`Edit ${ee}`,icon:f.jsx(o1,{}),className:"h-5 w-5 text-muted-foreground hover:text-foreground"}),C?f.jsx(Dn,{tooltipText:"Export Project (JSON)",onClick:ce=>c(e.id,ce),"aria-label":`Export project ${ee}`,icon:f.jsx(sme,{}),className:"h-5 w-5 text-muted-foreground hover:text-foreground"}):f.jsxs("div",{className:"relative group/export",children:[f.jsx(Dn,{tooltipText:"Export Conversation","aria-label":`Export ${ee}`,icon:f.jsx(xu,{}),className:"h-5 w-5 text-muted-foreground group-hover/export:text-foreground"}),f.jsxs("div",{className:`absolute right-0 top-full mt-1 hidden group-hover/export:flex
                                 bg-popover border border-border rounded-md shadow-lg p-0.5 z-10 gap-0.5`,onClick:ce=>ce.stopPropagation(),children:[f.jsx(ft,{variant:"ghost",size:"sm",className:"h-5 px-1.5 text-xs",onClick:ce=>l(e.id,"json",ce),children:"JSON"}),f.jsx(ft,{variant:"ghost",size:"sm",className:"h-5 px-1.5 text-xs",onClick:ce=>l(e.id,"md",ce),children:"MD"})]})]}),f.jsx(Dn,{tooltipText:"Delete",onClick:U,"aria-label":`Delete ${ee}`,icon:f.jsx(Ao,{}),className:"h-5 w-5 text-destructive hover:text-destructive/80"})]})})]})});yle.displayName="ConversationItemRenderer";function vQe({updateProject:e,updateConversation:t,deleteProject:n}){const[r,s]=T.useState(null),[i,a]=T.useState(null),[o,l]=T.useState(""),[c,u]=T.useState(!1),d=T.useCallback(y=>{s(y.id),a(y.itemType);const b=y.itemType==="project"?y.name:y.title;l(b),u(!1)},[]),h=T.useCallback(y=>{const b=r,v=y??(i==="project"&&o==="New Project");s(null),a(null),l(""),u(!1),v&&b&&n(b).catch(x=>{console.error("Failed to delete new project on cancel:",x),je.error("Failed to clean up cancelled new project.")})},[r,i,o,n]),m=T.useCallback(async(y,b,v)=>{if(y!==r||b!==i||c)return;const x=v==null?void 0:v.trim();if(!x){je.error("Name cannot be empty.");return}if(x===o&&!(b==="project"&&o==="New Project")){h();return}u(!0);try{b==="project"?await e(y,{name:x}):await t(y,{title:x}),je.success("Item renamed successfully."),s(null),a(null),l("")}catch(S){console.error("Failed to save item name:",S),je.error(`Failed to rename item: ${S instanceof Error?S.message:String(S)}`)}finally{u(!1)}},[r,i,c,e,t,h,o]);return{editingItemId:r,editingItemType:i,isSavingEdit:c,handleStartEditing:d,handleSaveEdit:m,handleCancelEdit:h,originalNameToCompare:o}}const ble=(e,t,n,r,s,i,a,o,l)=>{if(!n)return!0;const c=`${t}-${e}`;if(l[c]!==void 0)return l[c];let u=!1;{const d=i.get(e);if(d)if(d.name.toLowerCase().includes(n))u=!0;else{const h=o.get(e)||[],m=a.get(e)||[];for(const y of m)if(y.title.toLowerCase().includes(n)){u=!0;break}if(!u){for(const y of h)if(ble(y.id,"project",n,r,s,i,a,o,l)){u=!0;break}}}}return l[c]=u,u},xQe=({module:e})=>{const t=T.useRef(null),n=T.useRef(null),[r,s]=T.useState(!1),[,i]=T.useState({});T.useEffect(()=>(e.setNotifyCallback(()=>i({})),e.isLoading&&!qn.getState().isLoading&&!Fo.getState().isLoading&&e.setIsLoading(!1),()=>e.setNotifyCallback(null)),[e]),T.useEffect(()=>{const ge=t.current;if(ge){const Ae=ge.querySelector("[data-radix-scroll-area-viewport]");if(Ae&&n.current!==Ae?(n.current=Ae,r||s(!0),i({})):!Ae&&n.current&&(n.current=null,s(!1)),!n.current){const le=new MutationObserver(()=>{const oe=ge.querySelector("[data-radix-scroll-area-viewport]");oe&&n.current!==oe&&(n.current=oe,s(!0),i({}),le.disconnect())});return le.observe(ge,{childList:!0,subtree:!0}),()=>le.disconnect()}}},[t.current,r]);const{selectedItemId:a,selectedItemType:o,conversations:l,syncRepos:c,conversationSyncStatus:u,selectItem:d,addConversation:h,updateConversation:m,deleteConversation:y,exportConversation:b,exportProject:v,getConversationById:x}=qn(yn(ge=>({selectedItemId:ge.selectedItemId,selectedItemType:ge.selectedItemType,conversations:ge.conversations,syncRepos:ge.syncRepos,conversationSyncStatus:ge.conversationSyncStatus,selectItem:ge.selectItem,addConversation:ge.addConversation,updateConversation:ge.updateConversation,deleteConversation:ge.deleteConversation,exportConversation:ge.exportConversation,exportProject:ge.exportProject,getConversationById:ge.getConversationById}))),{projects:w,addProject:S,updateProject:C,deleteProject:k,getProjectById:A}=Fo(yn(ge=>({projects:ge.projects,addProject:ge.addProject,updateProject:ge.updateProject,deleteProject:ge.deleteProject,getProjectById:ge.getProjectById}))),R=e.isLoading,[N,I]=We.useState(new Set),[P,L]=T.useState(""),O=vQe({updateProject:C,updateConversation:m,deleteProject:k}),{editingItemId:V,editingItemType:D,isSavingEdit:Z,handleStartEditing:U,handleSaveEdit:H,handleCancelEdit:$,originalNameToCompare:ne}=O,W=T.useCallback(ge=>{I(Ae=>{const le=new Set(Ae);return le.has(ge)?le.delete(ge):le.add(ge),le})},[]),Q=T.useCallback(()=>{if(o==="project")return a;if(o==="conversation"&&a){const ge=x(a);return(ge==null?void 0:ge.projectId)??null}return null},[a,o,x]),ee=T.useCallback(async()=>{if(!V)try{const ge=Q(),Ae=await h({title:"New Chat",projectId:ge});d(Ae,"conversation")}catch(ge){console.error("Failed to create new chat:",ge),je.error("Failed to create new chat.")}},[V,Q,h,d]),se=T.useCallback(async()=>{if(!V)try{const ge=Q(),Ae=await S({name:"New Project",parentId:ge});d(Ae,"project"),ge&&I(le=>new Set(le).add(ge)),setTimeout(()=>{const le=A(Ae);le&&U({...le,itemType:"project"})},50)}catch(ge){console.error("Failed to create new project:",ge)}},[V,Q,S,d,A,U]),pe=T.useCallback((ge,Ae)=>{ge===V&&Ae===D||(V&&(ge!==V||Ae!==D)&&$(),(ge!==a||Ae!==o)&&d(ge,Ae))},[V,D,a,o,$,d]),ce=T.useCallback((ge,Ae)=>{Ae.stopPropagation(),window.confirm("Delete this conversation? This cannot be undone.")&&y(ge).catch(le=>{console.error("Failed to delete conversation:",le),je.error("Failed to delete conversation.")})},[y]),Ie=T.useCallback((ge,Ae)=>{Ae.stopPropagation(),k(ge).catch(le=>{console.error("Failed to delete project:",le),je.error("Failed to delete project.")})},[k]),De=T.useCallback(async(ge,Ae,le)=>{le.stopPropagation();try{await b(ge,Ae)}catch(oe){console.error(`Failed to export conversation as ${Ae}:`,oe)}},[b]),Se=T.useCallback(async(ge,Ae)=>{Ae.stopPropagation();try{await v(ge)}catch(le){console.error("Failed to export project:",le)}},[v]),Ce=T.useMemo(()=>new Map((c||[]).map(ge=>[ge.id,ge.name])),[c]),{projectsById:qe,conversationsByProjectId:Qe,projectsByParentId:Ve}=T.useMemo(()=>{const ge=new Map(w.map(oe=>[oe.id,oe])),Ae=new Map;l.forEach(oe=>{const re=oe.projectId??null;Ae.has(re)||Ae.set(re,[]),Ae.get(re).push(oe)});const le=new Map;return w.forEach(oe=>{const re=oe.parentId??null;le.has(re)||le.set(re,[]),le.get(re).push(oe)}),{projectsById:ge,conversationsByProjectId:Ae,projectsByParentId:le}},[w,l]),Ne=T.useMemo(()=>{const ge=[],Ae=P.toLowerCase(),le={};function oe(re,Te){const Be=(Ve.get(re)||[]).filter(Rt=>ble(Rt.id,"project",Ae,w,l,qe,Qe,Ve,le)),ke=(Qe.get(re)||[]).filter(Rt=>Rt.title.toLowerCase().includes(Ae)),lt=[...Be,...ke];lt.sort((Rt,ht)=>new Date(ht.updatedAt).getTime()-new Date(Rt.updatedAt).getTime()),lt.forEach(Rt=>{"path"in Rt?(ge.push({id:`project-${Rt.id}`,originalId:Rt.id,type:"project",level:Te,data:Rt,updatedAt:Rt.updatedAt}),N.has(Rt.id)&&oe(Rt.id,Te+1)):ge.push({id:`conversation-${Rt.id}`,originalId:Rt.id,type:"conversation",level:Te,data:Rt,updatedAt:Rt.updatedAt})})}return oe(null,0),ge},[w,l,P,N,qe,Qe,Ve]),K=T5({count:Ne.length,getScrollElement:()=>n.current,estimateSize:()=>30,overscan:10});return f.jsxs("div",{className:"p-2 border-r border-[--border] bg-card text-card-foreground h-full flex flex-col",children:[f.jsxs("div",{className:"flex justify-between items-center mb-2 flex-shrink-0 px-1",children:[f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx("h3",{className:"text-sm font-semibold",children:"LiteChat"}),f.jsx(kd,{href:"https://github.com/DimitriGilbert/LiteChat",target:"_blank",rel:"noopener noreferrer","aria-label":"GitHub Repository",children:f.jsx(ft,{size:"sm",variant:"ghost",className:"h-4 w-4 p-0",children:f.jsx(Cme,{className:"h-4 w-4"})})}),f.jsx(kd,{href:"release/latest.zip",download:"LiteChat.zip","aria-label":"Download LiteChat",children:f.jsx(ft,{size:"sm",variant:"ghost",className:"h-4 w-4 p-0",children:f.jsx(xu,{className:"h-4 w-4"})})})]}),f.jsxs("div",{className:"flex items-center",children:[f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(ft,{size:"sm",variant:"ghost",onClick:se,"aria-label":"New Project",disabled:R||!!V,className:"h-7 w-7 p-0",children:f.jsx(dH,{className:"h-4 w-4"})})}),f.jsx(Sr,{side:"bottom",children:"New Project"})]})}),f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(ft,{size:"sm",variant:"ghost",onClick:ee,"aria-label":"New Chat",disabled:R||!!V,className:"h-7 w-7 p-0",children:f.jsx(Ru,{className:"h-4 w-4"})})}),f.jsx(Sr,{side:"bottom",children:"New Chat"})]})})]})]}),f.jsxs("div",{className:"relative mb-2 px-1 flex-shrink-0",children:[f.jsx(Fa,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),f.jsx(_n,{type:"search",placeholder:"Filter...",value:P,onChange:ge=>L(ge.target.value),className:"h-8 text-xs pl-8",disabled:R})]}),f.jsxs(Lo,{className:"flex-grow",ref:t,children:[R&&Ne.length===0?f.jsxs("div",{className:"space-y-1 p-1",children:[f.jsx("div",{className:"h-8 w-full bg-muted rounded animate-pulse"}),f.jsx("div",{className:"h-8 w-full bg-muted rounded animate-pulse"}),f.jsx("div",{className:"h-8 w-full bg-muted rounded animate-pulse"})]}):!R&&Ne.length===0?f.jsx("p",{className:"text-xs text-muted-foreground p-2 text-center",children:P.trim()!==""?"No items match your filter.":"Workspace is empty."}):r&&f.jsx("div",{style:{height:`${K.getTotalSize()}px`,width:"100%",position:"relative"},children:K.getVirtualItems().map(ge=>{const Ae=Ne[ge.index];if(!Ae)return null;const le={...Ae.data,itemType:Ae.type};return f.jsx("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:`${ge.size}px`,transform:`translateY(${ge.start}px)`},className:"px-1",children:f.jsx(yle,{item:le,level:Ae.level,selectedItemId:a,conversationSyncStatus:u,repoNameMap:Ce,onSelectItem:()=>pe(Ae.originalId,Ae.type),onDeleteConversation:ce,onDeleteProject:Ie,onExportConversation:De,onExportProject:Se,expandedProjects:N,toggleProjectExpansion:W,editingItemId:V,editingItemType:D,handleStartEditing:U,handleSaveEdit:H,handleCancelEdit:$,isSavingEdit:Z,originalNameToCompare:ne})},Ae.id)})}),!r&&!R&&f.jsx("div",{className:"flex items-center justify-center h-full text-muted-foreground",children:"Initializing list..."})]})]})},wQe=({module:e})=>{const{selectedItemType:t}=qn(yn(r=>({selectedItemType:r.selectedItemType})));return e.isLoading?f.jsx(Qn,{className:"h-5 w-5 animate-spin text-muted-foreground"}):t==="project"?f.jsx(ph,{className:"h-5 w-5 text-primary"}):t==="conversation"?f.jsx(xB,{className:"h-5 w-5 text-primary"}):f.jsx(xB,{className:"h-5 w-5 text-muted-foreground"})};class _Qe{constructor(){me(this,"id","core-conversation-list");me(this,"unregisterCallback",null);me(this,"eventUnsubscribers",[]);me(this,"isLoading",!0);me(this,"conversationsLoading",!0);me(this,"projectsLoading",!0);me(this,"notifyComponentUpdate",null);me(this,"setIsLoading",t=>{var n;this.isLoading!==t&&(this.isLoading=t,(n=this.notifyComponentUpdate)==null||n.call(this))});me(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){this.conversationsLoading=qn.getState().isLoading,this.projectsLoading=Fo.getState().isLoading,this.updateCombinedLoadingState(),t.emit(Yn.loadConversationsRequest,void 0),t.emit(va.loadProjectsRequest,void 0);const n=t.on(Yn.conversationsLoaded,()=>{this.conversationsLoading=!1,this.updateCombinedLoadingState()}),r=t.on(va.loaded,()=>{this.projectsLoading=!1,this.updateCombinedLoadingState()}),s=t.on(Yn.loadingStateChanged,a=>{a.isLoading!==this.conversationsLoading&&(this.conversationsLoading=a.isLoading,this.updateCombinedLoadingState())}),i=t.on(va.loadingStateChanged,a=>{a.isLoading!==this.projectsLoading&&(this.projectsLoading=a.isLoading,this.updateCombinedLoadingState())});this.eventUnsubscribers.push(n,r,s,i)}updateCombinedLoadingState(){var n;const t=this.conversationsLoading||this.projectsLoading;this.isLoading!==t&&(this.isLoading=t,(n=this.notifyComponentUpdate)==null||n.call(this))}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Module "${this.id}" already registered. Skipping.`);return}this.unregisterCallback=t.registerChatControl({id:this.id,panel:"sidebar",status:()=>this.isLoading?"loading":"ready",renderer:()=>We.createElement(xQe,{module:this}),iconRenderer:()=>We.createElement(wQe,{module:this}),show:()=>!0})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,console.log(`[${this.id}] Destroyed.`)}}const eW=({module:e})=>{const t=(n,r)=>{e.openSettingsModal(n,r)};return f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(ft,{variant:"ghost",size:"icon",onClick:()=>t(),className:"h-8 w-8","aria-label":"Open Settings",children:f.jsx(nC,{className:"h-4 w-4"})})}),f.jsx(Sr,{side:"top",children:"Settings"})]})})};var w3="focusScope.autoFocusOnMount",_3="focusScope.autoFocusOnUnmount",tW={bubbles:!1,cancelable:!0},SQe="FocusScope",R5=T.forwardRef((e,t)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:s,onUnmountAutoFocus:i,...a}=e,[o,l]=T.useState(null),c=ks(s),u=ks(i),d=T.useRef(null),h=Rn(t,b=>l(b)),m=T.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;T.useEffect(()=>{if(r){let b=function(S){if(m.paused||!o)return;const C=S.target;o.contains(C)?d.current=C:th(d.current,{select:!0})},v=function(S){if(m.paused||!o)return;const C=S.relatedTarget;C!==null&&(o.contains(C)||th(d.current,{select:!0}))},x=function(S){if(document.activeElement===document.body)for(const k of S)k.removedNodes.length>0&&th(o)};document.addEventListener("focusin",b),document.addEventListener("focusout",v);const w=new MutationObserver(x);return o&&w.observe(o,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",b),document.removeEventListener("focusout",v),w.disconnect()}}},[r,o,m.paused]),T.useEffect(()=>{if(o){rW.add(m);const b=document.activeElement;if(!o.contains(b)){const x=new CustomEvent(w3,tW);o.addEventListener(w3,c),o.dispatchEvent(x),x.defaultPrevented||(CQe(RQe(vle(o)),{select:!0}),document.activeElement===b&&th(o))}return()=>{o.removeEventListener(w3,c),setTimeout(()=>{const x=new CustomEvent(_3,tW);o.addEventListener(_3,u),o.dispatchEvent(x),x.defaultPrevented||th(b??document.body,{select:!0}),o.removeEventListener(_3,u),rW.remove(m)},0)}}},[o,c,u,m]);const y=T.useCallback(b=>{if(!n&&!r||m.paused)return;const v=b.key==="Tab"&&!b.altKey&&!b.ctrlKey&&!b.metaKey,x=document.activeElement;if(v&&x){const w=b.currentTarget,[S,C]=kQe(w);S&&C?!b.shiftKey&&x===C?(b.preventDefault(),n&&th(S,{select:!0})):b.shiftKey&&x===S&&(b.preventDefault(),n&&th(C,{select:!0})):x===w&&b.preventDefault()}},[n,r,m.paused]);return f.jsx(ar.div,{tabIndex:-1,...a,ref:h,onKeyDown:y})});R5.displayName=SQe;function CQe(e,{select:t=!1}={}){const n=document.activeElement;for(const r of e)if(th(r,{select:t}),document.activeElement!==n)return}function kQe(e){const t=vle(e),n=nW(t,e),r=nW(t.reverse(),e);return[n,r]}function vle(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const s=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||s?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function nW(e,t){for(const n of e)if(!EQe(n,{upTo:t}))return n}function EQe(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function TQe(e){return e instanceof HTMLInputElement&&"select"in e}function th(e,{select:t=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&TQe(e)&&t&&e.select()}}var rW=AQe();function AQe(){let e=[];return{add(t){const n=e[0];t!==n&&(n==null||n.pause()),e=sW(e,t),e.unshift(t)},remove(t){var n;e=sW(e,t),(n=e[0])==null||n.resume()}}}function sW(e,t){const n=[...e],r=n.indexOf(t);return r!==-1&&n.splice(r,1),n}function RQe(e){return e.filter(t=>t.tagName!=="A")}function NQe(e){const t=MQe(e),n=T.forwardRef((r,s)=>{const{children:i,...a}=r,o=T.Children.toArray(i),l=o.find(jQe);if(l){const c=l.props.children,u=o.map(d=>d===l?T.Children.count(c)>1?T.Children.only(null):T.isValidElement(c)?c.props.children:null:d);return f.jsx(t,{...a,ref:s,children:T.isValidElement(c)?T.cloneElement(c,void 0,u):null})}return f.jsx(t,{...a,ref:s,children:i})});return n.displayName=`${e}.Slot`,n}function MQe(e){const t=T.forwardRef((n,r)=>{const{children:s,...i}=n;if(T.isValidElement(s)){const a=OQe(s),o=PQe(i,s.props);return s.type!==T.Fragment&&(o.ref=r?hl(r,a):a),T.cloneElement(s,o)}return T.Children.count(s)>1?T.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var IQe=Symbol("radix.slottable");function jQe(e){return T.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===IQe}function PQe(e,t){const n={...t};for(const r in t){const s=e[r],i=t[r];/^on[A-Z]/.test(r)?s&&i?n[r]=(...o)=>{i(...o),s(...o)}:s&&(n[r]=s):r==="style"?n[r]={...s,...i}:r==="className"&&(n[r]=[s,i].filter(Boolean).join(" "))}return{...e,...n}}function OQe(e){var r,s;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(s=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:s.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var rA="Dialog",[xle,_dt]=Hi(rA),[DQe,Uc]=xle(rA),wle=e=>{const{__scopeDialog:t,children:n,open:r,defaultOpen:s,onOpenChange:i,modal:a=!0}=e,o=T.useRef(null),l=T.useRef(null),[c,u]=Pc({prop:r,defaultProp:s??!1,onChange:i,caller:rA});return f.jsx(DQe,{scope:t,triggerRef:o,contentRef:l,contentId:aa(),titleId:aa(),descriptionId:aa(),open:c,onOpenChange:u,onOpenToggle:T.useCallback(()=>u(d=>!d),[u]),modal:a,children:n})};wle.displayName=rA;var _le="DialogTrigger",FQe=T.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,s=Uc(_le,n),i=Rn(t,s.triggerRef);return f.jsx(ar.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":I5(s.open),...r,ref:i,onClick:Wt(e.onClick,s.onOpenToggle)})});FQe.displayName=_le;var N5="DialogPortal",[LQe,Sle]=xle(N5,{forceMount:void 0}),Cle=e=>{const{__scopeDialog:t,forceMount:n,children:r,container:s}=e,i=Uc(N5,t);return f.jsx(LQe,{scope:t,forceMount:n,children:T.Children.map(r,a=>f.jsx(la,{present:n||i.open,children:f.jsx(RE,{asChild:!0,container:s,children:a})}))})};Cle.displayName=N5;var nE="DialogOverlay",kle=T.forwardRef((e,t)=>{const n=Sle(nE,e.__scopeDialog),{forceMount:r=n.forceMount,...s}=e,i=Uc(nE,e.__scopeDialog);return i.modal?f.jsx(la,{present:r||i.open,children:f.jsx($Qe,{...s,ref:t})}):null});kle.displayName=nE;var BQe=NQe("DialogOverlay.RemoveScroll"),$Qe=T.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,s=Uc(nE,n);return f.jsx(n_,{as:BQe,allowPinchZoom:!0,shards:[s.contentRef],children:f.jsx(ar.div,{"data-state":I5(s.open),...r,ref:t,style:{pointerEvents:"auto",...r.style}})})}),Dm="DialogContent",Ele=T.forwardRef((e,t)=>{const n=Sle(Dm,e.__scopeDialog),{forceMount:r=n.forceMount,...s}=e,i=Uc(Dm,e.__scopeDialog);return f.jsx(la,{present:r||i.open,children:i.modal?f.jsx(zQe,{...s,ref:t}):f.jsx(UQe,{...s,ref:t})})});Ele.displayName=Dm;var zQe=T.forwardRef((e,t)=>{const n=Uc(Dm,e.__scopeDialog),r=T.useRef(null),s=Rn(t,n.contentRef,r);return T.useEffect(()=>{const i=r.current;if(i)return ZT(i)},[]),f.jsx(Tle,{...e,ref:s,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Wt(e.onCloseAutoFocus,i=>{var a;i.preventDefault(),(a=n.triggerRef.current)==null||a.focus()}),onPointerDownOutside:Wt(e.onPointerDownOutside,i=>{const a=i.detail.originalEvent,o=a.button===0&&a.ctrlKey===!0;(a.button===2||o)&&i.preventDefault()}),onFocusOutside:Wt(e.onFocusOutside,i=>i.preventDefault())})}),UQe=T.forwardRef((e,t)=>{const n=Uc(Dm,e.__scopeDialog),r=T.useRef(!1),s=T.useRef(!1);return f.jsx(Tle,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var a,o;(a=e.onCloseAutoFocus)==null||a.call(e,i),i.defaultPrevented||(r.current||(o=n.triggerRef.current)==null||o.focus(),i.preventDefault()),r.current=!1,s.current=!1},onInteractOutside:i=>{var l,c;(l=e.onInteractOutside)==null||l.call(e,i),i.defaultPrevented||(r.current=!0,i.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const a=i.target;((c=n.triggerRef.current)==null?void 0:c.contains(a))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&s.current&&i.preventDefault()}})}),Tle=T.forwardRef((e,t)=>{const{__scopeDialog:n,trapFocus:r,onOpenAutoFocus:s,onCloseAutoFocus:i,...a}=e,o=Uc(Dm,n),l=T.useRef(null),c=Rn(t,l);return KT(),f.jsxs(f.Fragment,{children:[f.jsx(R5,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:s,onUnmountAutoFocus:i,children:f.jsx(CE,{role:"dialog",id:o.contentId,"aria-describedby":o.descriptionId,"aria-labelledby":o.titleId,"data-state":I5(o.open),...a,ref:c,onDismiss:()=>o.onOpenChange(!1)})}),f.jsxs(f.Fragment,{children:[f.jsx(qQe,{titleId:o.titleId}),f.jsx(WQe,{contentRef:l,descriptionId:o.descriptionId})]})]})}),M5="DialogTitle",Ale=T.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,s=Uc(M5,n);return f.jsx(ar.h2,{id:s.titleId,...r,ref:t})});Ale.displayName=M5;var Rle="DialogDescription",Nle=T.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,s=Uc(Rle,n);return f.jsx(ar.p,{id:s.descriptionId,...r,ref:t})});Nle.displayName=Rle;var Mle="DialogClose",Ile=T.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,s=Uc(Mle,n);return f.jsx(ar.button,{type:"button",...r,ref:t,onClick:Wt(e.onClick,()=>s.onOpenChange(!1))})});Ile.displayName=Mle;function I5(e){return e?"open":"closed"}var jle="DialogTitleWarning",[Sdt,Ple]=lxe(jle,{contentName:Dm,titleName:M5,docsSlug:"dialog"}),qQe=({titleId:e})=>{const t=Ple(jle),n=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return T.useEffect(()=>{e&&(document.getElementById(e)||console.error(n))},[n,e]),null},VQe="DialogDescriptionWarning",WQe=({contentRef:e,descriptionId:t})=>{const r=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${Ple(VQe).contentName}}.`;return T.useEffect(()=>{var i;const s=(i=e.current)==null?void 0:i.getAttribute("aria-describedby");t&&s&&(document.getElementById(t)||console.warn(r))},[r,e,t]),null},Ole=wle,Dle=Cle,Fle=kle,Lle=Ele,HQe=Ale,GQe=Nle,Ble=Ile;function lp({...e}){return f.jsx(Ole,{"data-slot":"dialog",...e})}function KQe({...e}){return f.jsx(Dle,{"data-slot":"dialog-portal",...e})}function YQe({...e}){return f.jsx(Ble,{"data-slot":"dialog-close",...e})}function ZQe({className:e,...t}){return f.jsx(Fle,{"data-slot":"dialog-overlay",className:Ze("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",e),...t})}function cp({className:e,children:t,...n}){return f.jsxs(KQe,{"data-slot":"dialog-portal",children:[f.jsx(ZQe,{}),f.jsxs(Lle,{"data-slot":"dialog-content",className:Ze("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",e),...n,children:[t,f.jsxs(Ble,{className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[f.jsx(qi,{}),f.jsx("span",{className:"sr-only",children:"Close"})]})]})]})}function up({className:e,...t}){return f.jsx("div",{"data-slot":"dialog-header",className:Ze("flex flex-col gap-2 text-center sm:text-left",e),...t})}function pb({className:e,...t}){return f.jsx("div",{"data-slot":"dialog-footer",className:Ze("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",e),...t})}function dp({className:e,...t}){return f.jsx(HQe,{"data-slot":"dialog-title",className:Ze("text-lg leading-none font-semibold",e),...t})}function ng({className:e,...t}){return f.jsx(GQe,{"data-slot":"dialog-description",className:Ze("text-muted-foreground text-sm",e),...t})}function iW(e){const t=XQe(e),n=T.forwardRef((r,s)=>{const{children:i,...a}=r,o=T.Children.toArray(i),l=o.find(QQe);if(l){const c=l.props.children,u=o.map(d=>d===l?T.Children.count(c)>1?T.Children.only(null):T.isValidElement(c)?c.props.children:null:d);return f.jsx(t,{...a,ref:s,children:T.isValidElement(c)?T.cloneElement(c,void 0,u):null})}return f.jsx(t,{...a,ref:s,children:i})});return n.displayName=`${e}.Slot`,n}function XQe(e){const t=T.forwardRef((n,r)=>{const{children:s,...i}=n;if(T.isValidElement(s)){const a=tet(s),o=eet(i,s.props);return s.type!==T.Fragment&&(o.ref=r?hl(r,a):a),T.cloneElement(s,o)}return T.Children.count(s)>1?T.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var JQe=Symbol("radix.slottable");function QQe(e){return T.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===JQe}function eet(e,t){const n={...t};for(const r in t){const s=e[r],i=t[r];/^on[A-Z]/.test(r)?s&&i?n[r]=(...o)=>{i(...o),s(...o)}:s&&(n[r]=s):r==="style"?n[r]={...s,...i}:r==="className"&&(n[r]=[s,i].filter(Boolean).join(" "))}return{...e,...n}}function tet(e){var r,s;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(s=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:s.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}function j5(e){const t=e+"CollectionProvider",[n,r]=Hi(t),[s,i]=n(t,{collectionRef:{current:null},itemMap:new Map}),a=b=>{const{scope:v,children:x}=b,w=We.useRef(null),S=We.useRef(new Map).current;return f.jsx(s,{scope:v,itemMap:S,collectionRef:w,children:x})};a.displayName=t;const o=e+"CollectionSlot",l=iW(o),c=We.forwardRef((b,v)=>{const{scope:x,children:w}=b,S=i(o,x),C=Rn(v,S.collectionRef);return f.jsx(l,{ref:C,children:w})});c.displayName=o;const u=e+"CollectionItemSlot",d="data-radix-collection-item",h=iW(u),m=We.forwardRef((b,v)=>{const{scope:x,children:w,...S}=b,C=We.useRef(null),k=Rn(v,C),A=i(u,x);return We.useEffect(()=>(A.itemMap.set(C,{ref:C,...S}),()=>void A.itemMap.delete(C))),f.jsx(h,{[d]:"",ref:k,children:w})});m.displayName=u;function y(b){const v=i(e+"CollectionConsumer",b);return We.useCallback(()=>{const w=v.collectionRef.current;if(!w)return[];const S=Array.from(w.querySelectorAll(`[${d}]`));return Array.from(v.itemMap.values()).sort((A,R)=>S.indexOf(A.ref.current)-S.indexOf(R.ref.current))},[v.collectionRef,v.itemMap])}return[{Provider:a,Slot:c,ItemSlot:m},y,r]}var S3="rovingFocusGroup.onEntryFocus",net={bubbles:!1,cancelable:!0},s_="RovingFocusGroup",[gP,$le,ret]=j5(s_),[set,sA]=Hi(s_,[ret]),[iet,aet]=set(s_),zle=T.forwardRef((e,t)=>f.jsx(gP.Provider,{scope:e.__scopeRovingFocusGroup,children:f.jsx(gP.Slot,{scope:e.__scopeRovingFocusGroup,children:f.jsx(oet,{...e,ref:t})})}));zle.displayName=s_;var oet=T.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,orientation:r,loop:s=!1,dir:i,currentTabStopId:a,defaultCurrentTabStopId:o,onCurrentTabStopIdChange:l,onEntryFocus:c,preventScrollOnEntryFocus:u=!1,...d}=e,h=T.useRef(null),m=Rn(t,h),y=cb(i),[b,v]=Pc({prop:a,defaultProp:o??null,onChange:l,caller:s_}),[x,w]=T.useState(!1),S=ks(c),C=$le(n),k=T.useRef(!1),[A,R]=T.useState(0);return T.useEffect(()=>{const N=h.current;if(N)return N.addEventListener(S3,S),()=>N.removeEventListener(S3,S)},[S]),f.jsx(iet,{scope:n,orientation:r,dir:y,loop:s,currentTabStopId:b,onItemFocus:T.useCallback(N=>v(N),[v]),onItemShiftTab:T.useCallback(()=>w(!0),[]),onFocusableItemAdd:T.useCallback(()=>R(N=>N+1),[]),onFocusableItemRemove:T.useCallback(()=>R(N=>N-1),[]),children:f.jsx(ar.div,{tabIndex:x||A===0?-1:0,"data-orientation":r,...d,ref:m,style:{outline:"none",...e.style},onMouseDown:Wt(e.onMouseDown,()=>{k.current=!0}),onFocus:Wt(e.onFocus,N=>{const I=!k.current;if(N.target===N.currentTarget&&I&&!x){const P=new CustomEvent(S3,net);if(N.currentTarget.dispatchEvent(P),!P.defaultPrevented){const L=C().filter(U=>U.focusable),O=L.find(U=>U.active),V=L.find(U=>U.id===b),Z=[O,V,...L].filter(Boolean).map(U=>U.ref.current);Vle(Z,u)}}k.current=!1}),onBlur:Wt(e.onBlur,()=>w(!1))})})}),Ule="RovingFocusGroupItem",qle=T.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,focusable:r=!0,active:s=!1,tabStopId:i,children:a,...o}=e,l=aa(),c=i||l,u=aet(Ule,n),d=u.currentTabStopId===c,h=$le(n),{onFocusableItemAdd:m,onFocusableItemRemove:y,currentTabStopId:b}=u;return T.useEffect(()=>{if(r)return m(),()=>y()},[r,m,y]),f.jsx(gP.ItemSlot,{scope:n,id:c,focusable:r,active:s,children:f.jsx(ar.span,{tabIndex:d?0:-1,"data-orientation":u.orientation,...o,ref:t,onMouseDown:Wt(e.onMouseDown,v=>{r?u.onItemFocus(c):v.preventDefault()}),onFocus:Wt(e.onFocus,()=>u.onItemFocus(c)),onKeyDown:Wt(e.onKeyDown,v=>{if(v.key==="Tab"&&v.shiftKey){u.onItemShiftTab();return}if(v.target!==v.currentTarget)return;const x=det(v,u.orientation,u.dir);if(x!==void 0){if(v.metaKey||v.ctrlKey||v.altKey||v.shiftKey)return;v.preventDefault();let S=h().filter(C=>C.focusable).map(C=>C.ref.current);if(x==="last")S.reverse();else if(x==="prev"||x==="next"){x==="prev"&&S.reverse();const C=S.indexOf(v.currentTarget);S=u.loop?fet(S,C+1):S.slice(C+1)}setTimeout(()=>Vle(S))}}),children:typeof a=="function"?a({isCurrentTabStop:d,hasTabStop:b!=null}):a})})});qle.displayName=Ule;var cet={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function uet(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function det(e,t,n){const r=uet(e.key,n);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return cet[r]}function Vle(e,t=!1){const n=document.activeElement;for(const r of e)if(r===n||(r.focus({preventScroll:t}),document.activeElement!==n))return}function fet(e,t){return e.map((n,r)=>e[(t+r)%e.length])}var Wle=zle,Hle=qle,iA="Tabs",[het,Cdt]=Hi(iA,[sA]),Gle=sA(),[pet,P5]=het(iA),Kle=T.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,onValueChange:s,defaultValue:i,orientation:a="horizontal",dir:o,activationMode:l="automatic",...c}=e,u=cb(o),[d,h]=Pc({prop:r,onChange:s,defaultProp:i??"",caller:iA});return f.jsx(pet,{scope:n,baseId:aa(),value:d,onValueChange:h,orientation:a,dir:u,activationMode:l,children:f.jsx(ar.div,{dir:u,"data-orientation":a,...c,ref:t})})});Kle.displayName=iA;var Yle="TabsList",Zle=T.forwardRef((e,t)=>{const{__scopeTabs:n,loop:r=!0,...s}=e,i=P5(Yle,n),a=Gle(n);return f.jsx(Wle,{asChild:!0,...a,orientation:i.orientation,dir:i.dir,loop:r,children:f.jsx(ar.div,{role:"tablist","aria-orientation":i.orientation,...s,ref:t})})});Zle.displayName=Yle;var Xle="TabsTrigger",Jle=T.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,disabled:s=!1,...i}=e,a=P5(Xle,n),o=Gle(n),l=tce(a.baseId,r),c=nce(a.baseId,r),u=r===a.value;return f.jsx(Hle,{asChild:!0,...o,focusable:!s,active:u,children:f.jsx(ar.button,{type:"button",role:"tab","aria-selected":u,"aria-controls":c,"data-state":u?"active":"inactive","data-disabled":s?"":void 0,disabled:s,id:l,...i,ref:t,onMouseDown:Wt(e.onMouseDown,d=>{!s&&d.button===0&&d.ctrlKey===!1?a.onValueChange(r):d.preventDefault()}),onKeyDown:Wt(e.onKeyDown,d=>{[" ","Enter"].includes(d.key)&&a.onValueChange(r)}),onFocus:Wt(e.onFocus,()=>{const d=a.activationMode!=="manual";!u&&!s&&d&&a.onValueChange(r)})})})});Jle.displayName=Xle;var Qle="TabsContent",ece=T.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,forceMount:s,children:i,...a}=e,o=P5(Qle,n),l=tce(o.baseId,r),c=nce(o.baseId,r),u=r===o.value,d=T.useRef(u);return T.useEffect(()=>{const h=requestAnimationFrame(()=>d.current=!1);return()=>cancelAnimationFrame(h)},[]),f.jsx(la,{present:s||u,children:({present:h})=>f.jsx(ar.div,{"data-state":u?"active":"inactive","data-orientation":o.orientation,role:"tabpanel","aria-labelledby":l,hidden:!h,id:c,tabIndex:0,...a,ref:t,style:{...e.style,animationDuration:d.current?"0s":void 0},children:h&&i})})});ece.displayName=Qle;function tce(e,t){return`${e}-trigger-${t}`}function nce(e,t){return`${e}-content-${t}`}var met=Kle,get=Zle,yet=Jle,bet=ece;function vet({className:e,...t}){return f.jsx(met,{"data-slot":"tabs",className:Ze("flex flex-col gap-2",e),...t})}function xet({className:e,...t}){return f.jsx(get,{"data-slot":"tabs-list",className:Ze("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",e),...t})}function wet({className:e,...t}){return f.jsx(yet,{"data-slot":"tabs-trigger",className:Ze("data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...t})}function _et({className:e,...t}){return f.jsx(bet,{"data-slot":"tabs-content",className:Ze("flex-1 outline-none",e),...t})}const sc=({tabs:e,defaultValue:t,initialValue:n,onValueChange:r,className:s,listClassName:i,contentContainerClassName:a,scrollable:o})=>{var m;const[l,c]=T.useState(n??t??((m=e[0])==null?void 0:m.value));T.useEffect(()=>{n!==void 0&&n!==l&&c(n)},[n,l]);const u=y=>{c(y),r&&r(y)},d=Ze("px-1 py-0.25 text-xs sm:px-3 sm:py-1.5 sm:text-sm font-medium rounded-md","text-muted-foreground","border border-transparent","focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2","data-[state=active]:bg-primary/10 data-[state=active]:text-primary","data-[state=active]:border-primary","dark:data-[state=active]:bg-primary/20 dark:data-[state=active]:text-primary","dark:data-[state=active]:border-primary/70","hover:bg-muted/50 hover:text-primary/80"),h=({children:y})=>{const v=Ze(o?"flex-grow overflow-y-auto pb-2 sm:pb-6 pr-1 sm:pr-2 -mr-1 sm:-mr-2":"flex-grow pb-2 sm:pb-6 pr-1 sm:pr-2 -mr-1 sm:-mr-2",a);return o?f.jsx(Lo,{className:v,children:y}):f.jsx("div",{className:v,children:y})};return f.jsxs(vet,{value:l,onValueChange:u,defaultValue:t,className:Ze("flex flex-col h-full",s),children:[f.jsx(xet,{className:Ze("flex-shrink-0 sticky top-0 bg-background z-10 flex-wrap h-auto justify-start border-b gap-0.5 sm:gap-1 p-0.5 sm:p-1 px-2 sm:px-6",i),children:e.map(y=>f.jsx(wet,{value:y.value,disabled:y.disabled,className:d,children:y.label},y.value))}),f.jsx(h,{children:e.map(y=>f.jsx(_et,{value:y.value,className:"data-[state=inactive]:hidden h-full",children:y.content},y.value))})]})},rce=T.memo(({isOpen:e,onClose:t,initialTab:n})=>{const{modSettingsTabs:r}=Oh(yn(u=>({modSettingsTabs:u.modSettingsTabs||[]}))),s=T.useMemo(()=>[...r.map(h=>{const m=h.component;return{value:h.id,label:h.title,content:f.jsx(m,{}),order:h.order??999}})].sort((h,m)=>(h.order??999)-(m.order??999)),[r]),i=T.useCallback(()=>s.length>0?s[0].value:"general",[s]),[a,o]=T.useState(i());T.useEffect(()=>{if(e){let u=i();n&&s.some(d=>d.value===n)?u=n:n&&(console.warn(`[SettingsModal] Initial tab "${n}" not found. Defaulting to "${u}".`),je.error(`Settings tab "${n}" not found. Opening default tab.`)),o(u)}},[e,n,s,i]);const l=u=>{u||t()},c=u=>{o(u)};return f.jsx(lp,{open:e,onOpenChange:l,children:f.jsxs(cp,{className:Ze("w-[95vw] h-[90vh] flex flex-col p-0","sm:w-[90vw] sm:h-[85vh]","md:w-[85vw] md:max-w-[1200px] md:h-[80vh]","lg:w-[75vw]","min-h-[500px] max-h-[95vh]"),children:[f.jsxs(up,{className:"p-4 md:p-6 pb-2 md:pb-4 flex-shrink-0",children:[f.jsx(dp,{children:"Settings"}),f.jsx(ng,{children:"Manage application settings, AI behavior, API keys, providers, and data."})]}),s.length>0?f.jsx(sc,{tabs:s,initialValue:a,onValueChange:c,className:"flex-grow overflow-hidden px-4 md:px-6",listClassName:"-mx-4 md:-mx-6 px-2 md:px-6 py-1 md:py-0",contentContainerClassName:"flex-grow overflow-y-auto pb-4 md:pb-6",scrollable:!1},a):f.jsx("div",{className:"flex-grow flex items-center justify-center text-muted-foreground p-4",children:"No settings tabs available or still loading. Check console for module registration errors."}),f.jsx(pb,{className:"flex-shrink-0 border-t p-4 md:p-6 pt-3 md:pt-4 mt-auto",children:f.jsx(ft,{variant:"outline",onClick:()=>l(!1),children:"Close"})})]})})});rce.displayName="SettingsModalComponent";const Cet=rce;class ket{constructor(){me(this,"id","core-settings-trigger");me(this,"modalId","settingsModal");me(this,"unregisterChatControlCallback",null);me(this,"unregisterModalProviderCallback",null);me(this,"modApiRef",null);me(this,"openSettingsModal",(t,n)=>{var r;(r=this.modApiRef)==null||r.emit(Pr.openModalRequest,{modalId:this.modalId,initialTab:t||"general",initialSubTab:n})});me(this,"closeSettingsModal",()=>{var t;(t=this.modApiRef)==null||t.emit(Pr.closeModalRequest,{modalId:this.modalId})})}async initialize(t){this.modApiRef=t}register(t){if(this.modApiRef=t,this.unregisterChatControlCallback&&this.unregisterModalProviderCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterChatControlCallback||(this.unregisterChatControlCallback=t.registerChatControl({id:this.id,panel:"sidebar-footer",status:()=>"ready",renderer:()=>We.createElement(eW,{module:this}),iconRenderer:()=>We.createElement(eW,{module:this}),show:()=>!0})),this.unregisterModalProviderCallback||(this.unregisterModalProviderCallback=t.registerModalProvider(this.modalId,n=>We.createElement(Cet,{isOpen:n.isOpen,onClose:n.onClose,initialTab:n.initialTab,initialSubTab:n.initialSubTab})))}destroy(){this.unregisterChatControlCallback&&(this.unregisterChatControlCallback(),this.unregisterChatControlCallback=null),this.unregisterModalProviderCallback&&(this.unregisterModalProviderCallback(),this.unregisterModalProviderCallback=null),this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const Eet=({module:e})=>{const[,t]=T.useState({});T.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const n=e.getIsSidebarCollapsed();return f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(ft,{variant:"ghost",size:"icon",onClick:()=>e.toggleSidebar(),className:"h-8 w-8","aria-label":n?"Expand Sidebar":"Collapse Sidebar",children:n?f.jsx(Qme,{className:"h-4 w-4"}):f.jsx(Xme,{className:"h-4 w-4"})})}),f.jsx(Sr,{side:"top",children:n?"Expand Sidebar":"Collapse Sidebar"})]})})};class Tet{constructor(){me(this,"id","core-sidebar-toggle");me(this,"unregisterCallback",null);me(this,"notifyComponentUpdate",null);me(this,"modApiRef",null);me(this,"getIsSidebarCollapsed",()=>Jw.getState().isSidebarCollapsed);me(this,"toggleSidebar",t=>{var s,i;const n=Jw.getState().isSidebarCollapsed,r=t??!n;n!==r&&((s=this.modApiRef)==null||s.emit(Pr.toggleSidebarRequest,{isCollapsed:r}),(i=this.notifyComponentUpdate)==null||i.call(this))});me(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){this.modApiRef=t}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}const n=()=>We.createElement(Eet,{module:this});this.unregisterCallback=t.registerChatControl({id:this.id,panel:"sidebar-footer",status:()=>"ready",renderer:n,iconRenderer:n,show:()=>!0})}destroy(){this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}function Iy({form:e,name:t,label:n,placeholder:r,disabled:s,wrapperClassName:i,allowNull:a=!1,min:o,max:l,step:c,className:u,onBlurInput:d,...h}){return f.jsx(e.Field,{name:t,children:m=>{const y=x=>{const w=x.target.value;if(w===""&&a)m.handleChange(null);else{const S=parseFloat(w);isNaN(S)?w===""&&!a&&m.handleChange(w):m.handleChange(S)}},b=typeof m.state.value=="number"?m.state.value.toString():(m.state.value===null&&a,""),v=x=>{m.handleBlur(),d&&d(x)};return f.jsxs("div",{className:Ze("space-y-1.5",i),children:[" ",f.jsx(It,{htmlFor:m.name,className:"text-sm",children:n}),f.jsx(_n,{id:m.name,name:m.name,type:"number",value:b,onBlur:v,onChange:y,placeholder:r,disabled:s??m.form.state.isSubmitting,min:o,max:l,step:c,className:Ze(u,m.state.meta.errors.length?"border-destructive":""),...h}),f.jsx(Ni,{field:m})]})}})}var sce=["PageUp","PageDown"],ice=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],ace={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},mb="Slider",[yP,Aet,Ret]=j5(mb),[oce,kdt]=Hi(mb,[Ret]),[Net,aA]=oce(mb),lce=T.forwardRef((e,t)=>{const{name:n,min:r=0,max:s=100,step:i=1,orientation:a="horizontal",disabled:o=!1,minStepsBetweenThumbs:l=0,defaultValue:c=[r],value:u,onValueChange:d=()=>{},onValueCommit:h=()=>{},inverted:m=!1,form:y,...b}=e,v=T.useRef(new Set),x=T.useRef(0),S=a==="horizontal"?Met:Iet,[C=[],k]=Pc({prop:u,defaultProp:c,onChange:L=>{var V;(V=[...v.current][x.current])==null||V.focus(),d(L)}}),A=T.useRef(C);function R(L){const O=Fet(C,L);P(L,O)}function N(L){P(L,x.current)}function I(){const L=A.current[x.current];C[x.current]!==L&&h(C)}function P(L,O,{commit:V}={commit:!1}){const D=zet(i),Z=Uet(Math.round((L-r)/i)*i+r,D),U=Uw(Z,[r,s]);k((H=[])=>{const $=Oet(H,U,O);if($et($,l*i)){x.current=$.indexOf(U);const ne=String($)!==String(H);return ne&&V&&h($),ne?$:H}else return H})}return f.jsx(Net,{scope:e.__scopeSlider,name:n,disabled:o,min:r,max:s,valueIndexToChangeRef:x,thumbs:v.current,values:C,orientation:a,form:y,children:f.jsx(yP.Provider,{scope:e.__scopeSlider,children:f.jsx(yP.Slot,{scope:e.__scopeSlider,children:f.jsx(S,{"aria-disabled":o,"data-disabled":o?"":void 0,...b,ref:t,onPointerDown:Wt(b.onPointerDown,()=>{o||(A.current=C)}),min:r,max:s,inverted:m,onSlideStart:o?void 0:R,onSlideMove:o?void 0:N,onSlideEnd:o?void 0:I,onHomeKeyDown:()=>!o&&P(r,0,{commit:!0}),onEndKeyDown:()=>!o&&P(s,C.length-1,{commit:!0}),onStepKeyDown:({event:L,direction:O})=>{if(!o){const Z=sce.includes(L.key)||L.shiftKey&&ice.includes(L.key)?10:1,U=x.current,H=C[U],$=i*Z*O;P(H+$,U,{commit:!0})}}})})})})});lce.displayName=mb;var[cce,uce]=oce(mb,{startEdge:"left",endEdge:"right",size:"width",direction:1}),Met=T.forwardRef((e,t)=>{const{min:n,max:r,dir:s,inverted:i,onSlideStart:a,onSlideMove:o,onSlideEnd:l,onStepKeyDown:c,...u}=e,[d,h]=T.useState(null),m=Rn(t,S=>h(S)),y=T.useRef(void 0),b=cb(s),v=b==="ltr",x=v&&!i||!v&&i;function w(S){const C=y.current||d.getBoundingClientRect(),k=[0,C.width],R=O5(k,x?[n,r]:[r,n]);return y.current=C,R(S-C.left)}return f.jsx(cce,{scope:e.__scopeSlider,startEdge:x?"left":"right",endEdge:x?"right":"left",direction:x?1:-1,size:"width",children:f.jsx(dce,{dir:b,"data-orientation":"horizontal",...u,ref:m,style:{...u.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:S=>{const C=w(S.clientX);a==null||a(C)},onSlideMove:S=>{const C=w(S.clientX);o==null||o(C)},onSlideEnd:()=>{y.current=void 0,l==null||l()},onStepKeyDown:S=>{const k=ace[x?"from-left":"from-right"].includes(S.key);c==null||c({event:S,direction:k?-1:1})}})})}),Iet=T.forwardRef((e,t)=>{const{min:n,max:r,inverted:s,onSlideStart:i,onSlideMove:a,onSlideEnd:o,onStepKeyDown:l,...c}=e,u=T.useRef(null),d=Rn(t,u),h=T.useRef(void 0),m=!s;function y(b){const v=h.current||u.current.getBoundingClientRect(),x=[0,v.height],S=O5(x,m?[r,n]:[n,r]);return h.current=v,S(b-v.top)}return f.jsx(cce,{scope:e.__scopeSlider,startEdge:m?"bottom":"top",endEdge:m?"top":"bottom",size:"height",direction:m?1:-1,children:f.jsx(dce,{"data-orientation":"vertical",...c,ref:d,style:{...c.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:b=>{const v=y(b.clientY);i==null||i(v)},onSlideMove:b=>{const v=y(b.clientY);a==null||a(v)},onSlideEnd:()=>{h.current=void 0,o==null||o()},onStepKeyDown:b=>{const x=ace[m?"from-bottom":"from-top"].includes(b.key);l==null||l({event:b,direction:x?-1:1})}})})}),dce=T.forwardRef((e,t)=>{const{__scopeSlider:n,onSlideStart:r,onSlideMove:s,onSlideEnd:i,onHomeKeyDown:a,onEndKeyDown:o,onStepKeyDown:l,...c}=e,u=aA(mb,n);return f.jsx(ar.span,{...c,ref:t,onKeyDown:Wt(e.onKeyDown,d=>{d.key==="Home"?(a(d),d.preventDefault()):d.key==="End"?(o(d),d.preventDefault()):sce.concat(ice).includes(d.key)&&(l(d),d.preventDefault())}),onPointerDown:Wt(e.onPointerDown,d=>{const h=d.target;h.setPointerCapture(d.pointerId),d.preventDefault(),u.thumbs.has(h)?h.focus():r(d)}),onPointerMove:Wt(e.onPointerMove,d=>{d.target.hasPointerCapture(d.pointerId)&&s(d)}),onPointerUp:Wt(e.onPointerUp,d=>{const h=d.target;h.hasPointerCapture(d.pointerId)&&(h.releasePointerCapture(d.pointerId),i(d))})})}),fce="SliderTrack",hce=T.forwardRef((e,t)=>{const{__scopeSlider:n,...r}=e,s=aA(fce,n);return f.jsx(ar.span,{"data-disabled":s.disabled?"":void 0,"data-orientation":s.orientation,...r,ref:t})});hce.displayName=fce;var bP="SliderRange",pce=T.forwardRef((e,t)=>{const{__scopeSlider:n,...r}=e,s=aA(bP,n),i=uce(bP,n),a=T.useRef(null),o=Rn(t,a),l=s.values.length,c=s.values.map(h=>yce(h,s.min,s.max)),u=l>1?Math.min(...c):0,d=100-Math.max(...c);return f.jsx(ar.span,{"data-orientation":s.orientation,"data-disabled":s.disabled?"":void 0,...r,ref:o,style:{...e.style,[i.startEdge]:u+"%",[i.endEdge]:d+"%"}})});pce.displayName=bP;var vP="SliderThumb",mce=T.forwardRef((e,t)=>{const n=Aet(e.__scopeSlider),[r,s]=T.useState(null),i=Rn(t,o=>s(o)),a=T.useMemo(()=>r?n().findIndex(o=>o.ref.current===r):-1,[n,r]);return f.jsx(jet,{...e,ref:i,index:a})}),jet=T.forwardRef((e,t)=>{const{__scopeSlider:n,index:r,name:s,...i}=e,a=aA(vP,n),o=uce(vP,n),[l,c]=T.useState(null),u=Rn(t,w=>c(w)),d=l?a.form||!!l.closest("form"):!0,h=$y(l),m=a.values[r],y=m===void 0?0:yce(m,a.min,a.max),b=Det(r,a.values.length),v=h==null?void 0:h[o.size],x=v?Let(v,y,o.direction):0;return T.useEffect(()=>{if(l)return a.thumbs.add(l),()=>{a.thumbs.delete(l)}},[l,a.thumbs]),f.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[o.startEdge]:`calc(${y}% + ${x}px)`},children:[f.jsx(yP.ItemSlot,{scope:e.__scopeSlider,children:f.jsx(ar.span,{role:"slider","aria-label":e["aria-label"]||b,"aria-valuemin":a.min,"aria-valuenow":m,"aria-valuemax":a.max,"aria-orientation":a.orientation,"data-orientation":a.orientation,"data-disabled":a.disabled?"":void 0,tabIndex:a.disabled?void 0:0,...i,ref:u,style:m===void 0?{display:"none"}:e.style,onFocus:Wt(e.onFocus,()=>{a.valueIndexToChangeRef.current=r})})}),d&&f.jsx(gce,{name:s??(a.name?a.name+(a.values.length>1?"[]":""):void 0),form:a.form,value:m},r)]})});mce.displayName=vP;var Pet="RadioBubbleInput",gce=T.forwardRef(({__scopeSlider:e,value:t,...n},r)=>{const s=T.useRef(null),i=Rn(s,r),a=YT(t);return T.useEffect(()=>{const o=s.current;if(!o)return;const l=window.HTMLInputElement.prototype,u=Object.getOwnPropertyDescriptor(l,"value").set;if(a!==t&&u){const d=new Event("input",{bubbles:!0});u.call(o,t),o.dispatchEvent(d)}},[a,t]),f.jsx(ar.input,{style:{display:"none"},...n,ref:i,defaultValue:t})});gce.displayName=Pet;function Oet(e=[],t,n){const r=[...e];return r[n]=t,r.sort((s,i)=>s-i)}function yce(e,t,n){const i=100/(n-t)*(e-t);return Uw(i,[0,100])}function Det(e,t){return t>2?`Value ${e+1} of ${t}`:t===2?["Minimum","Maximum"][e]:void 0}function Fet(e,t){if(e.length===1)return 0;const n=e.map(s=>Math.abs(s-t)),r=Math.min(...n);return n.indexOf(r)}function Let(e,t,n){const r=e/2,i=O5([0,50],[0,r]);return(r-i(t)*n)*n}function Bet(e){return e.slice(0,-1).map((t,n)=>e[n+1]-t)}function $et(e,t){if(t>0){const n=Bet(e);return Math.min(...n)>=t}return!0}function O5(e,t){return n=>{if(e[0]===e[1]||t[0]===t[1])return t[0];const r=(t[1]-t[0])/(e[1]-e[0]);return t[0]+r*(n-e[0])}}function zet(e){return(String(e).split(".")[1]||"").length}function Uet(e,t){const n=Math.pow(10,t);return Math.round(e*n)/n}var qet=lce,Vet=hce,Wet=pce,Het=mce;function k0({className:e,defaultValue:t,value:n,min:r=0,max:s=100,...i}){const a=T.useMemo(()=>Array.isArray(n)?n:Array.isArray(t)?t:[r,s],[n,t,r,s]);return f.jsxs(qet,{"data-slot":"slider",defaultValue:t,value:n,min:r,max:s,className:Ze("relative flex w-full touch-none items-center select-none data-[disabled]:opacity-50 data-[orientation=vertical]:h-full data-[orientation=vertical]:min-h-44 data-[orientation=vertical]:w-auto data-[orientation=vertical]:flex-col",e),...i,children:[f.jsx(Vet,{"data-slot":"slider-track",className:Ze("bg-muted relative grow overflow-hidden rounded-full data-[orientation=horizontal]:h-1.5 data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-1.5"),children:f.jsx(Wet,{"data-slot":"slider-range",className:Ze("bg-primary absolute data-[orientation=horizontal]:h-full data-[orientation=vertical]:w-full")})}),Array.from({length:a.length},(o,l)=>f.jsx(Het,{"data-slot":"slider-thumb",className:"border-primary bg-background ring-ring/50 block size-4 shrink-0 rounded-full border shadow-sm transition-[color,box-shadow] hover:ring-4 focus-visible:ring-4 focus-visible:outline-hidden disabled:pointer-events-none disabled:opacity-50"},l))]})}function wc({form:e,name:t,label:n,valueLabelPrefix:r="",valueLabelSuffix:s="",valueDisplayPrecision:i=2,showRawValue:a=!1,disabled:o,wrapperClassName:l,className:c,min:u,max:d,step:h,...m}){return f.jsx(e.Field,{name:t,children:y=>{const b=typeof y.state.value=="number"?y.state.value:u??0,v=b.toFixed(i);return f.jsxs("div",{className:Ze("space-y-1.5",l),children:[f.jsxs(It,{htmlFor:y.name,className:"text-sm",children:[n," (",r,v,s,")",a&&f.jsxs("span",{className:"text-xs text-muted-foreground ml-2",children:["(Raw: ",y.state.value,")"]})]}),f.jsx(k0,{id:y.name,name:y.name,value:[b],onValueChange:x=>y.handleChange(x[0]),onBlur:y.handleBlur,disabled:o??y.form.state.isSubmitting,min:u,max:d,step:h,className:Ze(c,y.state.meta.errors.length?"border-destructive":""),...m}),f.jsx(Ni,{field:y})]})}})}const Get=Ke({temperature:Tt().min(0).max(1),topP:Tt().min(0).max(1),maxTokens:Tt().min(1).nullable(),topK:Tt().min(1).nullable(),presencePenalty:Tt().min(-2).max(2),frequencyPenalty:Tt().min(-2).max(2)}),Ket=({module:e,className:t})=>{const n=ri({defaultValues:{temperature:e.temperature??e.defaultTemperature??.7,topP:e.topP??e.defaultTopP??1,maxTokens:e.maxTokens??e.defaultMaxTokens??null,topK:e.topK??e.defaultTopK??null,presencePenalty:e.presencePenalty??e.defaultPresencePenalty??0,frequencyPenalty:e.frequencyPenalty??e.defaultFrequencyPenalty??0},validators:{onChangeAsync:Get,onChangeAsyncDebounceMs:500}});T.useEffect(()=>{n.reset({temperature:e.temperature??e.defaultTemperature??.7,topP:e.topP??e.defaultTopP??1,maxTokens:e.maxTokens??e.defaultMaxTokens??null,topK:e.topK??e.defaultTopK??null,presencePenalty:e.presencePenalty??e.defaultPresencePenalty??0,frequencyPenalty:e.frequencyPenalty??e.defaultFrequencyPenalty??0})},[e.temperature,e.defaultTemperature,e.topP,e.defaultTopP,e.maxTokens,e.defaultMaxTokens,e.topK,e.defaultTopK,e.presencePenalty,e.defaultPresencePenalty,e.frequencyPenalty,e.defaultFrequencyPenalty]);const[,r]=We.useState({});T.useEffect(()=>{const u=()=>r({});return e.setNotifyCallback(u),()=>e.setNotifyCallback(null)},[e]);const s=T.useCallback((u,d,h)=>{var m;((m=n.getFieldMeta(u))==null?void 0:m.errors.length)===0&&d(h)},[n,e]),i=T.useCallback((u,d)=>{var h;if(((h=n.getFieldMeta(u))==null?void 0:h.errors.length)===0){const m=n.getFieldValue(u);d(m)}},[n,e]),a=T.useCallback((u,d,h)=>{n.setFieldValue(u,h),d(null)},[n,e]),o=e.supportedParams,l=e.defaultTemperature!==void 0||e.defaultTopP!==void 0||e.defaultMaxTokens!==void 0||e.defaultTopK!==void 0||e.defaultPresencePenalty!==void 0||e.defaultFrequencyPenalty!==void 0,c=(u,d,h,m,y="N/A")=>{var b;return!l||m===void 0?null:f.jsxs(ft,{variant:"link",size:"sm",className:"text-xs h-auto p-0 mt-1 text-muted-foreground",onClick:()=>a(u,h,m??null),disabled:d===null,children:["Use Default (",((b=m==null?void 0:m.toFixed)==null?void 0:b.call(m,2))??y,")"]})};return f.jsxs("div",{className:Ze("space-y-4 p-4",t),children:[o.has("temperature")&&f.jsxs("div",{className:"space-y-0.5",children:[" ",f.jsx(wc,{form:n,name:"temperature",label:"Temperature",min:0,max:1,step:.01,valueDisplayPrecision:2,onValueCommit:u=>s("temperature",e.setTemperature,u[0]),wrapperClassName:"text-xs"}),c("temperature",e.temperature,e.setTemperature,e.defaultTemperature,"0.70")]}),o.has("top_p")&&f.jsxs("div",{className:"space-y-0.5",children:[f.jsx(wc,{form:n,name:"topP",label:"Top P",min:0,max:1,step:.01,valueDisplayPrecision:2,onValueCommit:u=>s("topP",e.setTopP,u[0]),wrapperClassName:"text-xs"}),c("topP",e.topP,e.setTopP,e.defaultTopP,"1.00")]}),f.jsxs("div",{className:"grid grid-cols-2 gap-4 items-start",children:[" ",o.has("max_tokens")&&f.jsxs("div",{className:"space-y-0.5",children:[f.jsx(Iy,{form:n,name:"maxTokens",label:"Max Tokens",placeholder:`Default: ${e.defaultMaxTokens??"None"}`,min:1,allowNull:!0,onBlurInput:()=>i("maxTokens",e.setMaxTokens),className:"h-8 text-xs",wrapperClassName:"text-xs"}),c("maxTokens",e.maxTokens,e.setMaxTokens,e.defaultMaxTokens,"None")]}),o.has("top_k")&&f.jsxs("div",{className:"space-y-0.5",children:[f.jsx(Iy,{form:n,name:"topK",label:"Top K",placeholder:`Default: ${e.defaultTopK??"None"}`,min:1,allowNull:!0,onBlurInput:()=>i("topK",e.setTopK),className:"h-8 text-xs",wrapperClassName:"text-xs"}),c("topK",e.topK,e.setTopK,e.defaultTopK,"None")]})]}),o.has("presence_penalty")&&f.jsxs("div",{className:"space-y-0.5",children:[f.jsx(wc,{form:n,name:"presencePenalty",label:"Presence Penalty",min:-2,max:2,step:.01,valueDisplayPrecision:2,onValueCommit:u=>s("presencePenalty",e.setPresencePenalty,u[0]),wrapperClassName:"text-xs"}),c("presencePenalty",e.presencePenalty,e.setPresencePenalty,e.defaultPresencePenalty,"0.00")]}),o.has("frequency_penalty")&&f.jsxs("div",{className:"space-y-0.5",children:[f.jsx(wc,{form:n,name:"frequencyPenalty",label:"Frequency Penalty",min:-2,max:2,step:.01,valueDisplayPrecision:2,onValueCommit:u=>s("frequencyPenalty",e.setFrequencyPenalty,u[0]),wrapperClassName:"text-xs"}),c("frequencyPenalty",e.frequencyPenalty,e.setFrequencyPenalty,e.defaultFrequencyPenalty,"0.00")]})]})},Yet=({module:e})=>{const[,t]=T.useState({});T.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const n=e.getIsStreaming();return e.getIsVisible()?f.jsxs(vl,{children:[f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(xl,{asChild:!0,children:f.jsx(ft,{variant:"ghost",size:"icon",className:"h-8 w-8",disabled:n,"aria-label":"Adjust Advanced Parameters",children:f.jsx(xge,{className:"h-4 w-4"})})})}),f.jsx(Sr,{side:"top",children:"Advanced Parameters"})]})}),f.jsx(wl,{className:"w-auto p-0",align:"start",children:f.jsx(Ket,{module:e})})]}):null};class Zet{constructor(){me(this,"id","core-parameters");me(this,"unregisterCallback",null);me(this,"eventUnsubscribers",[]);me(this,"modApiRef",null);me(this,"temperature",null);me(this,"topP",null);me(this,"maxTokens",null);me(this,"topK",null);me(this,"presencePenalty",null);me(this,"frequencyPenalty",null);me(this,"defaultTemperature",null);me(this,"defaultTopP",null);me(this,"defaultMaxTokens",null);me(this,"defaultTopK",null);me(this,"defaultPresencePenalty",null);me(this,"defaultFrequencyPenalty",null);me(this,"isStreaming",!1);me(this,"isVisible",!0);me(this,"supportedParams",new Set);me(this,"notifyComponentUpdate",null);me(this,"getIsStreaming",()=>this.isStreaming);me(this,"getIsVisible",()=>this.isVisible);me(this,"setTemperature",t=>{var n,r;this.temperature=t,(n=this.modApiRef)==null||n.emit(Nn.setTemperatureRequest,{value:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});me(this,"setTopP",t=>{var n,r;this.topP=t,(n=this.modApiRef)==null||n.emit(Nn.setTopPRequest,{value:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});me(this,"setMaxTokens",t=>{var n,r;this.maxTokens=t,(n=this.modApiRef)==null||n.emit(Nn.setMaxTokensRequest,{value:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});me(this,"setTopK",t=>{var n,r;this.topK=t,(n=this.modApiRef)==null||n.emit(Nn.setTopKRequest,{value:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});me(this,"setPresencePenalty",t=>{var n,r;this.presencePenalty=t,(n=this.modApiRef)==null||n.emit(Nn.setPresencePenaltyRequest,{value:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});me(this,"setFrequencyPenalty",t=>{var n,r;this.frequencyPenalty=t,(n=this.modApiRef)==null||n.emit(Nn.setFrequencyPenaltyRequest,{value:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});me(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){this.modApiRef=t,this.loadInitialState(),this.updateSupportedParams();const n=t.on(Zn.statusChanged,a=>{var o;typeof a=="object"&&a&&"status"in a&&this.isStreaming!==(a.status==="streaming")&&(this.isStreaming=a.status==="streaming",(o=this.notifyComponentUpdate)==null||o.call(this))}),r=t.on(dr.selectedModelChanged,()=>{var a;this.updateSupportedParams(),this.updateVisibility(),(a=this.notifyComponentUpdate)==null||a.call(this)}),s=t.on(sn.enableAdvancedSettingsChanged,()=>{var a;this.updateVisibility(),(a=this.notifyComponentUpdate)==null||a.call(this)}),i=t.on(Nn.parameterChanged,a=>{var o;if(typeof a=="object"&&a&&"params"in a){const l=a.params;let c=!1;"temperature"in l&&this.temperature!==l.temperature&&(this.temperature=l.temperature??null,c=!0),"topP"in l&&this.topP!==l.topP&&(this.topP=l.topP??null,c=!0),"maxTokens"in l&&this.maxTokens!==l.maxTokens&&(this.maxTokens=l.maxTokens??null,c=!0),"topK"in l&&this.topK!==l.topK&&(this.topK=l.topK??null,c=!0),"presencePenalty"in l&&this.presencePenalty!==l.presencePenalty&&(this.presencePenalty=l.presencePenalty??null,c=!0),"frequencyPenalty"in l&&this.frequencyPenalty!==l.frequencyPenalty&&(this.frequencyPenalty=l.frequencyPenalty??null,c=!0),c&&((o=this.notifyComponentUpdate)==null||o.call(this))}});this.eventUnsubscribers.push(n,r,s,i)}loadInitialState(){const t=yr.getState(),n=Po.getState();this.isStreaming=$n.getState().status==="streaming",this.temperature=n.temperature,this.topP=n.topP,this.maxTokens=n.maxTokens,this.topK=n.topK,this.presencePenalty=n.presencePenalty,this.frequencyPenalty=n.frequencyPenalty,this.defaultTemperature=t.temperature,this.defaultTopP=t.topP,this.defaultMaxTokens=t.maxTokens,this.defaultTopK=t.topK,this.defaultPresencePenalty=t.presencePenalty,this.defaultFrequencyPenalty=t.frequencyPenalty,this.updateVisibility()}updateSupportedParams(){var o;const t=Nr.getState();if(!t.selectedModelId){this.supportedParams=new Set;return}const{providerId:n,modelId:r}=Cc(t.selectedModelId);if(!n||!r){this.supportedParams=new Set;return}const s=t.dbProviderConfigs.find(l=>l.id===n);if(!s){this.supportedParams=new Set;return}const i=t.dbApiKeys.find(l=>l.id===s.apiKeyId),a=TG(s,r,i==null?void 0:i.value);this.supportedParams=new Set(((o=a==null?void 0:a.metadata)==null?void 0:o.supported_parameters)??[])}updateVisibility(){const r=yr.getState().enableAdvancedSettings&&["temperature","top_p","max_tokens","top_k","presence_penalty","frequency_penalty"].some(s=>this.supportedParams.has(s));this.isVisible!==r&&(this.isVisible=r)}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>We.createElement(Yet,{module:this}),getParameters:()=>{const n={},r=(s,i)=>{i!==null&&(n[s]=i)};return r("temperature",this.temperature),r("top_p",this.topP),r("max_tokens",this.maxTokens),r("top_k",this.topK),r("presence_penalty",this.presencePenalty),r("frequency_penalty",this.frequencyPenalty),Object.keys(n).length>0?n:void 0}})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const Xet=({module:e})=>{const t=T.useRef(null),[,n]=T.useState({});T.useEffect(()=>(e.setNotifyCallback(()=>n({})),()=>e.setNotifyCallback(null)),[e]);const r=e.getIsStreaming(),s=e.getModelSupportsNonText(),i=T.useCallback(async l=>{const c=l.target.files;if(c){for(const u of Array.from(c))try{let d={};const h=e.isLikelyTextFile(u.name,u.type),m=u.type.startsWith("image/");if(h)d.contentText=await u.text();else if(m&&s){const y=new FileReader,b=new Promise((x,w)=>{y.onload=()=>x(y.result),y.onerror=S=>w(S)});y.readAsDataURL(u);const v=await b;v&&v.includes(",")&&(d.contentBase64=v.split(",")[1])}e.onFileAdd({source:"direct",name:u.name,type:u.type||"application/octet-stream",size:u.size,...d})}catch(d){console.error(`Error processing file ${u.name}:`,d),je.error(`Failed to process file "${u.name}": ${d instanceof Error?d.message:String(d)}`)}l.target&&(l.target.value="")}},[e,s]),a=()=>{var l;(l=t.current)==null||l.click()},o=s?"Attach Files (Text, Images, etc.)":"Attach Text Files";return f.jsxs(f.Fragment,{children:[f.jsx("input",{type:"file",ref:t,onChange:i,multiple:!0,className:"hidden",disabled:r}),f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(ft,{type:"button",variant:"ghost",size:"icon",onClick:a,disabled:r,className:"h-8 w-8","aria-label":o,children:f.jsx(fE,{className:"h-4 w-4"})})}),f.jsx(Sr,{side:"top",children:o})]})})]})},Jet=({module:e})=>{const[,t]=T.useState({}),n=e.getAttachedFiles(),r=e.getIsStreaming();return T.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]),n.length===0?null:f.jsx("div",{className:Ze("max-h-40 overflow-y-auto pr-1","flex flex-wrap gap-1"),children:n.map(s=>f.jsx(xZ,{fileMeta:s,onRemove:e.onFileRemove,isReadOnly:r},s.id))})},bce=20,Qet=bce*1024*1024;class ett{constructor(){me(this,"id","core-file-attachment");me(this,"unregisterCallback",null);me(this,"eventUnsubscribers",[]);me(this,"modApiRef",null);me(this,"isStreaming",!1);me(this,"modelSupportsNonText",!0);me(this,"attachedFiles",[]);me(this,"notifyComponentUpdate",null);me(this,"getIsStreaming",()=>this.isStreaming);me(this,"getModelSupportsNonText",()=>this.modelSupportsNonText);me(this,"getAttachedFiles",()=>this.attachedFiles);me(this,"isLikelyTextFile",(t,n)=>Vx(t,n));me(this,"onFileAdd",t=>{var r;if(t.size>Qet){je.error(`File "${t.name}" exceeds the ${bce}MB limit.`);return}if(!Vx(t.name,t.type)&&!this.modelSupportsNonText){je.warning(`File "${t.name}" (${t.type}) cannot be uploaded. The current model only supports text input.`);return}(r=this.modApiRef)==null||r.emit(ql.addAttachedFileRequest,t)});me(this,"onFileRemove",t=>{var n;(n=this.modApiRef)==null||n.emit(ql.removeAttachedFileRequest,{attachmentId:t})});me(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){var i;this.modApiRef=t,this.isStreaming=$n.getState().status==="streaming",this.attachedFiles=mh.getState().attachedFilesMetadata,this.updateModelSupport(),(i=this.notifyComponentUpdate)==null||i.call(this);const n=t.on(Zn.statusChanged,a=>{var o;typeof a=="object"&&a&&"status"in a&&this.isStreaming!==(a.status==="streaming")&&(this.isStreaming=a.status==="streaming",(o=this.notifyComponentUpdate)==null||o.call(this))}),r=t.on(dr.selectedModelChanged,()=>{var a;this.updateModelSupport(),(a=this.notifyComponentUpdate)==null||a.call(this)}),s=t.on(ql.attachedFilesChanged,a=>{var o;typeof a=="object"&&a&&"files"in a&&JSON.stringify(this.attachedFiles)!==JSON.stringify(a.files)&&(this.attachedFiles=a.files,(o=this.notifyComponentUpdate)==null||o.call(this))});this.eventUnsubscribers.push(n,r,s)}updateModelSupport(){var i,a;const{getSelectedModel:t}=Nr.getState(),n=t(),r=(a=(i=n==null?void 0:n.metadata)==null?void 0:i.architecture)==null?void 0:a.input_modalities,s=!r||r.some(o=>o!=="text");this.modelSupportsNonText!==s&&(this.modelSupportsNonText=s)}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,triggerRenderer:()=>We.createElement(Xet,{module:this}),renderer:()=>We.createElement(Jet,{module:this})})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const ttt=({module:e})=>{const[,t]=T.useState({});T.useEffect(()=>{if(e&&typeof e.setNotifyTriggerUpdate=="function")return e.setNotifyTriggerUpdate(()=>t({})),()=>{e&&typeof e.setNotifyTriggerUpdate=="function"&&e.setNotifyTriggerUpdate(null)}},[e]);const n=e&&typeof e.getIsVfsModalOpen=="function"?e.getIsVfsModalOpen():!1,r=e&&typeof e.getSelectedFileIdsCount=="function"?e.getSelectedFileIdsCount():0,s=e&&typeof e.getEnableVfs=="function"?e.getEnableVfs():!1,i=mh.getState().addAttachedFile,a=()=>{const o=Js.getState().selectedFileIds;if(o.size===0){je.info("No files selected in VFS to attach.");return}let l=0;const c=e.getVfsNodes();o.forEach(u=>{const d=c[u];d&&d.type==="file"&&(i({source:"vfs",name:d.name,type:d.mimeType||"application/octet-stream",size:d.size,path:d.path}),l++)}),l>0?(je.success(`Attached ${l} file(s) from VFS to the next prompt.`),typeof e.clearVfsSelection=="function"&&e.clearVfsSelection(),e.toggleVfsModal):je.warning("No valid files were selected to attach.")};return s?f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(ft,{variant:"ghost",size:"icon",className:Ze("h-8 w-8",n&&"bg-muted text-primary"),onClick:()=>e&&typeof e.toggleVfsModal=="function"&&e.toggleVfsModal(),"aria-label":"Toggle Virtual File System",children:f.jsx(DP,{className:"h-4 w-4"})})}),f.jsx(Sr,{side:"top",children:"Virtual Filesystem"})]})}),r>0&&f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsxs(ft,{variant:"secondary",size:"sm",className:"h-8 animate-fadeIn px-2",onClick:a,"aria-label":`Attach ${r} selected VFS file(s)`,children:[f.jsx(fE,{className:"h-4 w-4 mr-1"}),"Attach (",r,")"]})}),f.jsx(Sr,{side:"top",children:"Attach selected VFS files to prompt"})]})})]}):null};function lf({className:e,...t}){return f.jsx("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:f.jsx("table",{"data-slot":"table",className:Ze("w-full caption-bottom text-sm",e),...t})})}function fp({className:e,...t}){return f.jsx("thead",{"data-slot":"table-header",className:Ze("[&_tr]:border-b",e),...t})}function cf({className:e,...t}){return f.jsx("tbody",{"data-slot":"table-body",className:Ze("[&_tr:last-child]:border-0",e),...t})}function Es({className:e,...t}){return f.jsx("tr",{"data-slot":"table-row",className:Ze("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",e),...t})}function Tr({className:e,...t}){return f.jsx("th",{"data-slot":"table-head",className:Ze("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...t})}function On({className:e,...t}){return f.jsx("td",{"data-slot":"table-cell",className:Ze("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...t})}function ntt({className:e,...t}){return f.jsx("caption",{"data-slot":"table-caption",className:Ze("text-muted-foreground mt-4 text-sm",e),...t})}const vce=({newFolderName:e,setNewFolderName:t,handleCreateFolder:n,cancelCreatingFolder:r,newFolderInputRef:s,isOperationLoading:i,isMobile:a=!1})=>{const o=l=>{l.key==="Enter"?n():l.key==="Escape"&&r()};return a?f.jsxs("div",{className:"flex items-center gap-2 p-1",children:[f.jsx(ph,{className:"h-5 w-5 text-yellow-400 flex-shrink-0"}),f.jsx(_n,{ref:s,value:e,onChange:l=>t(l.target.value),onBlur:n,onKeyDown:o,className:"h-7 px-2 py-1 text-sm bg-input border-border focus:ring-1 focus:ring-primary flex-grow",placeholder:"New folder name",disabled:i}),f.jsxs("div",{className:"flex items-center gap-0.5 flex-shrink-0",children:[f.jsx(ft,{variant:"ghost",size:"icon",className:"h-7 w-7 text-green-500 hover:text-green-400",onClick:n,"aria-label":"Create folder",disabled:i||!e.trim(),children:i?f.jsx(Qn,{className:"h-4 w-4 animate-spin"}):f.jsx(so,{className:"h-4 w-4"})}),f.jsx(ft,{variant:"ghost",size:"icon",className:"h-7 w-7 text-muted-foreground hover:text-foreground",onClick:r,"aria-label":"Cancel create folder",disabled:i,children:f.jsx(qi,{className:"h-4 w-4"})})]})]}):f.jsxs(Es,{className:"bg-muted/30",children:[f.jsx(On,{className:"px-2 py-1"}),f.jsx(On,{className:"px-2 py-1",children:f.jsx(ph,{className:"h-5 w-5 text-yellow-400"})}),f.jsx(On,{className:"py-1 px-2",colSpan:3,children:f.jsx(_n,{ref:s,value:e,onChange:l=>t(l.target.value),onBlur:n,onKeyDown:o,className:"h-7 px-2 py-1 text-sm bg-input border-border focus:ring-1 focus:ring-primary w-full",placeholder:"New folder name",disabled:i})}),f.jsx(On,{className:"text-right pr-4 py-1",children:f.jsxs("div",{className:"flex items-center justify-end gap-0.5",children:[f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(ft,{variant:"ghost",size:"icon",className:"h-6 w-6 text-green-500 hover:text-green-400",onClick:n,"aria-label":"Create folder",disabled:i||!e.trim(),children:i?f.jsx(Qn,{className:"h-4 w-4 animate-spin"}):f.jsx(so,{className:"h-4 w-4"})})}),f.jsx(Sr,{side:"top",children:"Create (Enter)"})]})}),f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(ft,{variant:"ghost",size:"icon",className:"h-6 w-6 text-muted-foreground hover:text-foreground",onClick:r,"aria-label":"Cancel create folder",disabled:i,children:f.jsx(qi,{className:"h-4 w-4"})})}),f.jsx(Sr,{side:"top",children:"Cancel (Esc)"})]})})]})})]})};var rtt=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],D5=rtt.reduce((e,t)=>{const n=Au(`Primitive.${t}`),r=T.forwardRef((s,i)=>{const{asChild:a,...o}=s,l=a?n:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),f.jsx(l,{...o,ref:i})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{}),oA="Checkbox",[stt,Edt]=Hi(oA),[itt,F5]=stt(oA);function att(e){const{__scopeCheckbox:t,checked:n,children:r,defaultChecked:s,disabled:i,form:a,name:o,onCheckedChange:l,required:c,value:u="on",internal_do_not_use_render:d}=e,[h,m]=Pc({prop:n,defaultProp:s??!1,onChange:l,caller:oA}),[y,b]=T.useState(null),[v,x]=T.useState(null),w=T.useRef(!1),S=y?!!a||!!y.closest("form"):!0,C={checked:h,disabled:i,setChecked:m,control:y,setControl:b,name:o,form:a,value:u,hasConsumerStoppedPropagationRef:w,required:c,defaultChecked:hh(s)?!1:s,isFormControl:S,bubbleInput:v,setBubbleInput:x};return f.jsx(itt,{scope:t,...C,children:ott(d)?d(C):r})}var xce="CheckboxTrigger",wce=T.forwardRef(({__scopeCheckbox:e,onKeyDown:t,onClick:n,...r},s)=>{const{control:i,value:a,disabled:o,checked:l,required:c,setControl:u,setChecked:d,hasConsumerStoppedPropagationRef:h,isFormControl:m,bubbleInput:y}=F5(xce,e),b=Rn(s,u),v=T.useRef(l);return T.useEffect(()=>{const x=i==null?void 0:i.form;if(x){const w=()=>d(v.current);return x.addEventListener("reset",w),()=>x.removeEventListener("reset",w)}},[i,d]),f.jsx(D5.button,{type:"button",role:"checkbox","aria-checked":hh(l)?"mixed":l,"aria-required":c,"data-state":Tce(l),"data-disabled":o?"":void 0,disabled:o,value:a,...r,ref:b,onKeyDown:Wt(t,x=>{x.key==="Enter"&&x.preventDefault()}),onClick:Wt(n,x=>{d(w=>hh(w)?!0:!w),y&&m&&(h.current=x.isPropagationStopped(),h.current||x.stopPropagation())})})});wce.displayName=xce;var _ce=T.forwardRef((e,t)=>{const{__scopeCheckbox:n,name:r,checked:s,defaultChecked:i,required:a,disabled:o,value:l,onCheckedChange:c,form:u,...d}=e;return f.jsx(att,{__scopeCheckbox:n,checked:s,defaultChecked:i,disabled:o,required:a,onCheckedChange:c,name:r,form:u,value:l,internal_do_not_use_render:({isFormControl:h})=>f.jsxs(f.Fragment,{children:[f.jsx(wce,{...d,ref:t,__scopeCheckbox:n}),h&&f.jsx(Ece,{__scopeCheckbox:n})]})})});_ce.displayName=oA;var Sce="CheckboxIndicator",Cce=T.forwardRef((e,t)=>{const{__scopeCheckbox:n,forceMount:r,...s}=e,i=F5(Sce,n);return f.jsx(la,{present:r||hh(i.checked)||i.checked===!0,children:f.jsx(D5.span,{"data-state":Tce(i.checked),"data-disabled":i.disabled?"":void 0,...s,ref:t,style:{pointerEvents:"none",...e.style}})})});Cce.displayName=Sce;var kce="CheckboxBubbleInput",Ece=T.forwardRef(({__scopeCheckbox:e,...t},n)=>{const{control:r,hasConsumerStoppedPropagationRef:s,checked:i,defaultChecked:a,required:o,disabled:l,name:c,value:u,form:d,bubbleInput:h,setBubbleInput:m}=F5(kce,e),y=Rn(n,m),b=YT(i),v=$y(r);T.useEffect(()=>{const w=h;if(!w)return;const S=window.HTMLInputElement.prototype,k=Object.getOwnPropertyDescriptor(S,"checked").set,A=!s.current;if(b!==i&&k){const R=new Event("click",{bubbles:A});w.indeterminate=hh(i),k.call(w,hh(i)?!1:i),w.dispatchEvent(R)}},[h,b,i,s]);const x=T.useRef(hh(i)?!1:i);return f.jsx(D5.input,{type:"checkbox","aria-hidden":!0,defaultChecked:a??x.current,required:o,disabled:l,name:c,value:u,form:d,...t,tabIndex:-1,ref:y,style:{...t.style,...v,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});Ece.displayName=kce;function ott(e){return typeof e=="function"}function hh(e){return e==="indeterminate"}function Tce(e){return hh(e)?"indeterminate":e?"checked":"unchecked"}function Xl({className:e,...t}){return f.jsx(_ce,{"data-slot":"checkbox",className:Ze("peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",e),...t,children:f.jsx(Cce,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:f.jsx(so,{className:"size-3.5"})})})}function ltt(e){const t=ctt(e),n=T.forwardRef((r,s)=>{const{children:i,...a}=r,o=T.Children.toArray(i),l=o.find(dtt);if(l){const c=l.props.children,u=o.map(d=>d===l?T.Children.count(c)>1?T.Children.only(null):T.isValidElement(c)?c.props.children:null:d);return f.jsx(t,{...a,ref:s,children:T.isValidElement(c)?T.cloneElement(c,void 0,u):null})}return f.jsx(t,{...a,ref:s,children:i})});return n.displayName=`${e}.Slot`,n}function ctt(e){const t=T.forwardRef((n,r)=>{const{children:s,...i}=n;if(T.isValidElement(s)){const a=htt(s),o=ftt(i,s.props);return s.type!==T.Fragment&&(o.ref=r?hl(r,a):a),T.cloneElement(s,o)}return T.Children.count(s)>1?T.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var utt=Symbol("radix.slottable");function dtt(e){return T.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===utt}function ftt(e,t){const n={...t};for(const r in t){const s=e[r],i=t[r];/^on[A-Z]/.test(r)?s&&i?n[r]=(...o)=>{i(...o),s(...o)}:s&&(n[r]=s):r==="style"?n[r]={...s,...i}:r==="className"&&(n[r]=[s,i].filter(Boolean).join(" "))}return{...e,...n}}function htt(e){var r,s;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(s=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:s.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var xP=["Enter"," "],ptt=["ArrowDown","PageUp","Home"],Ace=["ArrowUp","PageDown","End"],mtt=[...ptt,...Ace],gtt={ltr:[...xP,"ArrowRight"],rtl:[...xP,"ArrowLeft"]},ytt={ltr:["ArrowLeft"],rtl:["ArrowRight"]},i_="Menu",[e1,btt,vtt]=j5(i_),[rg,lA]=Hi(i_,[vtt,AE,sA]),cA=AE(),Rce=sA(),[xtt,sg]=rg(i_),[wtt,a_]=rg(i_),Nce=e=>{const{__scopeMenu:t,open:n=!1,children:r,dir:s,onOpenChange:i,modal:a=!0}=e,o=cA(t),[l,c]=T.useState(null),u=T.useRef(!1),d=ks(i),h=cb(s);return T.useEffect(()=>{const m=()=>{u.current=!0,document.addEventListener("pointerdown",y,{capture:!0,once:!0}),document.addEventListener("pointermove",y,{capture:!0,once:!0})},y=()=>u.current=!1;return document.addEventListener("keydown",m,{capture:!0}),()=>{document.removeEventListener("keydown",m,{capture:!0}),document.removeEventListener("pointerdown",y,{capture:!0}),document.removeEventListener("pointermove",y,{capture:!0})}},[]),f.jsx(JG,{...o,children:f.jsx(xtt,{scope:t,open:n,onOpenChange:d,content:l,onContentChange:c,children:f.jsx(wtt,{scope:t,onClose:T.useCallback(()=>d(!1),[d]),isUsingKeyboardRef:u,dir:h,modal:a,children:r})})})};Nce.displayName=i_;var _tt="MenuAnchor",L5=T.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e,s=cA(n);return f.jsx(QG,{...s,...r,ref:t})});L5.displayName=_tt;var B5="MenuPortal",[Stt,Mce]=rg(B5,{forceMount:void 0}),Ice=e=>{const{__scopeMenu:t,forceMount:n,children:r,container:s}=e,i=sg(B5,t);return f.jsx(Stt,{scope:t,forceMount:n,children:f.jsx(la,{present:n||i.open,children:f.jsx(RE,{asChild:!0,container:s,children:r})})})};Ice.displayName=B5;var Kl="MenuContent",[Ctt,$5]=rg(Kl),jce=T.forwardRef((e,t)=>{const n=Mce(Kl,e.__scopeMenu),{forceMount:r=n.forceMount,...s}=e,i=sg(Kl,e.__scopeMenu),a=a_(Kl,e.__scopeMenu);return f.jsx(e1.Provider,{scope:e.__scopeMenu,children:f.jsx(la,{present:r||i.open,children:f.jsx(e1.Slot,{scope:e.__scopeMenu,children:a.modal?f.jsx(ktt,{...s,ref:t}):f.jsx(Ett,{...s,ref:t})})})})}),ktt=T.forwardRef((e,t)=>{const n=sg(Kl,e.__scopeMenu),r=T.useRef(null),s=Rn(t,r);return T.useEffect(()=>{const i=r.current;if(i)return ZT(i)},[]),f.jsx(z5,{...e,ref:s,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:Wt(e.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)})}),Ett=T.forwardRef((e,t)=>{const n=sg(Kl,e.__scopeMenu);return f.jsx(z5,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)})}),Ttt=ltt("MenuContent.ScrollLock"),z5=T.forwardRef((e,t)=>{const{__scopeMenu:n,loop:r=!1,trapFocus:s,onOpenAutoFocus:i,onCloseAutoFocus:a,disableOutsidePointerEvents:o,onEntryFocus:l,onEscapeKeyDown:c,onPointerDownOutside:u,onFocusOutside:d,onInteractOutside:h,onDismiss:m,disableOutsideScroll:y,...b}=e,v=sg(Kl,n),x=a_(Kl,n),w=cA(n),S=Rce(n),C=btt(n),[k,A]=T.useState(null),R=T.useRef(null),N=Rn(t,R,v.onContentChange),I=T.useRef(0),P=T.useRef(""),L=T.useRef(0),O=T.useRef(null),V=T.useRef("right"),D=T.useRef(0),Z=y?n_:T.Fragment,U=y?{as:Ttt,allowPinchZoom:!0}:void 0,H=ne=>{var De,Se;const W=P.current+ne,Q=C().filter(Ce=>!Ce.disabled),ee=document.activeElement,se=(De=Q.find(Ce=>Ce.ref.current===ee))==null?void 0:De.textValue,pe=Q.map(Ce=>Ce.textValue),ce=Btt(pe,W,se),Ie=(Se=Q.find(Ce=>Ce.textValue===ce))==null?void 0:Se.ref.current;(function Ce(qe){P.current=qe,window.clearTimeout(I.current),qe!==""&&(I.current=window.setTimeout(()=>Ce(""),1e3))})(W),Ie&&setTimeout(()=>Ie.focus())};T.useEffect(()=>()=>window.clearTimeout(I.current),[]),KT();const $=T.useCallback(ne=>{var Q,ee;return V.current===((Q=O.current)==null?void 0:Q.side)&&ztt(ne,(ee=O.current)==null?void 0:ee.area)},[]);return f.jsx(Ctt,{scope:n,searchRef:P,onItemEnter:T.useCallback(ne=>{$(ne)&&ne.preventDefault()},[$]),onItemLeave:T.useCallback(ne=>{var W;$(ne)||((W=R.current)==null||W.focus(),A(null))},[$]),onTriggerLeave:T.useCallback(ne=>{$(ne)&&ne.preventDefault()},[$]),pointerGraceTimerRef:L,onPointerGraceIntentChange:T.useCallback(ne=>{O.current=ne},[]),children:f.jsx(Z,{...U,children:f.jsx(R5,{asChild:!0,trapped:s,onMountAutoFocus:Wt(i,ne=>{var W;ne.preventDefault(),(W=R.current)==null||W.focus({preventScroll:!0})}),onUnmountAutoFocus:a,children:f.jsx(CE,{asChild:!0,disableOutsidePointerEvents:o,onEscapeKeyDown:c,onPointerDownOutside:u,onFocusOutside:d,onInteractOutside:h,onDismiss:m,children:f.jsx(Wle,{asChild:!0,...S,dir:x.dir,orientation:"vertical",loop:r,currentTabStopId:k,onCurrentTabStopIdChange:A,onEntryFocus:Wt(l,ne=>{x.isUsingKeyboardRef.current||ne.preventDefault()}),preventScrollOnEntryFocus:!0,children:f.jsx(eK,{role:"menu","aria-orientation":"vertical","data-state":Yce(v.open),"data-radix-menu-content":"",dir:x.dir,...w,...b,ref:N,style:{outline:"none",...b.style},onKeyDown:Wt(b.onKeyDown,ne=>{const Q=ne.target.closest("[data-radix-menu-content]")===ne.currentTarget,ee=ne.ctrlKey||ne.altKey||ne.metaKey,se=ne.key.length===1;Q&&(ne.key==="Tab"&&ne.preventDefault(),!ee&&se&&H(ne.key));const pe=R.current;if(ne.target!==pe||!mtt.includes(ne.key))return;ne.preventDefault();const Ie=C().filter(De=>!De.disabled).map(De=>De.ref.current);Ace.includes(ne.key)&&Ie.reverse(),Ftt(Ie)}),onBlur:Wt(e.onBlur,ne=>{ne.currentTarget.contains(ne.target)||(window.clearTimeout(I.current),P.current="")}),onPointerMove:Wt(e.onPointerMove,t1(ne=>{const W=ne.target,Q=D.current!==ne.clientX;if(ne.currentTarget.contains(W)&&Q){const ee=ne.clientX>D.current?"right":"left";V.current=ee,D.current=ne.clientX}}))})})})})})})});jce.displayName=Kl;var Att="MenuGroup",U5=T.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return f.jsx(ar.div,{role:"group",...r,ref:t})});U5.displayName=Att;var Rtt="MenuLabel",Pce=T.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return f.jsx(ar.div,{...r,ref:t})});Pce.displayName=Rtt;var rE="MenuItem",aW="menu.itemSelect",uA=T.forwardRef((e,t)=>{const{disabled:n=!1,onSelect:r,...s}=e,i=T.useRef(null),a=a_(rE,e.__scopeMenu),o=$5(rE,e.__scopeMenu),l=Rn(t,i),c=T.useRef(!1),u=()=>{const d=i.current;if(!n&&d){const h=new CustomEvent(aW,{bubbles:!0,cancelable:!0});d.addEventListener(aW,m=>r==null?void 0:r(m),{once:!0}),RG(d,h),h.defaultPrevented?c.current=!1:a.onClose()}};return f.jsx(Oce,{...s,ref:l,disabled:n,onClick:Wt(e.onClick,u),onPointerDown:d=>{var h;(h=e.onPointerDown)==null||h.call(e,d),c.current=!0},onPointerUp:Wt(e.onPointerUp,d=>{var h;c.current||(h=d.currentTarget)==null||h.click()}),onKeyDown:Wt(e.onKeyDown,d=>{const h=o.searchRef.current!=="";n||h&&d.key===" "||xP.includes(d.key)&&(d.currentTarget.click(),d.preventDefault())})})});uA.displayName=rE;var Oce=T.forwardRef((e,t)=>{const{__scopeMenu:n,disabled:r=!1,textValue:s,...i}=e,a=$5(rE,n),o=Rce(n),l=T.useRef(null),c=Rn(t,l),[u,d]=T.useState(!1),[h,m]=T.useState("");return T.useEffect(()=>{const y=l.current;y&&m((y.textContent??"").trim())},[i.children]),f.jsx(e1.ItemSlot,{scope:n,disabled:r,textValue:s??h,children:f.jsx(Hle,{asChild:!0,...o,focusable:!r,children:f.jsx(ar.div,{role:"menuitem","data-highlighted":u?"":void 0,"aria-disabled":r||void 0,"data-disabled":r?"":void 0,...i,ref:c,onPointerMove:Wt(e.onPointerMove,t1(y=>{r?a.onItemLeave(y):(a.onItemEnter(y),y.defaultPrevented||y.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:Wt(e.onPointerLeave,t1(y=>a.onItemLeave(y))),onFocus:Wt(e.onFocus,()=>d(!0)),onBlur:Wt(e.onBlur,()=>d(!1))})})})}),Ntt="MenuCheckboxItem",Dce=T.forwardRef((e,t)=>{const{checked:n=!1,onCheckedChange:r,...s}=e;return f.jsx(zce,{scope:e.__scopeMenu,checked:n,children:f.jsx(uA,{role:"menuitemcheckbox","aria-checked":sE(n)?"mixed":n,...s,ref:t,"data-state":V5(n),onSelect:Wt(s.onSelect,()=>r==null?void 0:r(sE(n)?!0:!n),{checkForDefaultPrevented:!1})})})});Dce.displayName=Ntt;var Fce="MenuRadioGroup",[Mtt,Itt]=rg(Fce,{value:void 0,onValueChange:()=>{}}),Lce=T.forwardRef((e,t)=>{const{value:n,onValueChange:r,...s}=e,i=ks(r);return f.jsx(Mtt,{scope:e.__scopeMenu,value:n,onValueChange:i,children:f.jsx(U5,{...s,ref:t})})});Lce.displayName=Fce;var Bce="MenuRadioItem",$ce=T.forwardRef((e,t)=>{const{value:n,...r}=e,s=Itt(Bce,e.__scopeMenu),i=n===s.value;return f.jsx(zce,{scope:e.__scopeMenu,checked:i,children:f.jsx(uA,{role:"menuitemradio","aria-checked":i,...r,ref:t,"data-state":V5(i),onSelect:Wt(r.onSelect,()=>{var a;return(a=s.onValueChange)==null?void 0:a.call(s,n)},{checkForDefaultPrevented:!1})})})});$ce.displayName=Bce;var q5="MenuItemIndicator",[zce,jtt]=rg(q5,{checked:!1}),Uce=T.forwardRef((e,t)=>{const{__scopeMenu:n,forceMount:r,...s}=e,i=jtt(q5,n);return f.jsx(la,{present:r||sE(i.checked)||i.checked===!0,children:f.jsx(ar.span,{...s,ref:t,"data-state":V5(i.checked)})})});Uce.displayName=q5;var Ptt="MenuSeparator",qce=T.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return f.jsx(ar.div,{role:"separator","aria-orientation":"horizontal",...r,ref:t})});qce.displayName=Ptt;var Ott="MenuArrow",Vce=T.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e,s=cA(n);return f.jsx(tK,{...s,...r,ref:t})});Vce.displayName=Ott;var Dtt="MenuSub",[Tdt,Wce]=rg(Dtt),hx="MenuSubTrigger",Hce=T.forwardRef((e,t)=>{const n=sg(hx,e.__scopeMenu),r=a_(hx,e.__scopeMenu),s=Wce(hx,e.__scopeMenu),i=$5(hx,e.__scopeMenu),a=T.useRef(null),{pointerGraceTimerRef:o,onPointerGraceIntentChange:l}=i,c={__scopeMenu:e.__scopeMenu},u=T.useCallback(()=>{a.current&&window.clearTimeout(a.current),a.current=null},[]);return T.useEffect(()=>u,[u]),T.useEffect(()=>{const d=o.current;return()=>{window.clearTimeout(d),l(null)}},[o,l]),f.jsx(L5,{asChild:!0,...c,children:f.jsx(Oce,{id:s.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":s.contentId,"data-state":Yce(n.open),...e,ref:hl(t,s.onTriggerChange),onClick:d=>{var h;(h=e.onClick)==null||h.call(e,d),!(e.disabled||d.defaultPrevented)&&(d.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:Wt(e.onPointerMove,t1(d=>{i.onItemEnter(d),!d.defaultPrevented&&!e.disabled&&!n.open&&!a.current&&(i.onPointerGraceIntentChange(null),a.current=window.setTimeout(()=>{n.onOpenChange(!0),u()},100))})),onPointerLeave:Wt(e.onPointerLeave,t1(d=>{var m,y;u();const h=(m=n.content)==null?void 0:m.getBoundingClientRect();if(h){const b=(y=n.content)==null?void 0:y.dataset.side,v=b==="right",x=v?-5:5,w=h[v?"left":"right"],S=h[v?"right":"left"];i.onPointerGraceIntentChange({area:[{x:d.clientX+x,y:d.clientY},{x:w,y:h.top},{x:S,y:h.top},{x:S,y:h.bottom},{x:w,y:h.bottom}],side:b}),window.clearTimeout(o.current),o.current=window.setTimeout(()=>i.onPointerGraceIntentChange(null),300)}else{if(i.onTriggerLeave(d),d.defaultPrevented)return;i.onPointerGraceIntentChange(null)}})),onKeyDown:Wt(e.onKeyDown,d=>{var m;const h=i.searchRef.current!=="";e.disabled||h&&d.key===" "||gtt[r.dir].includes(d.key)&&(n.onOpenChange(!0),(m=n.content)==null||m.focus(),d.preventDefault())})})})});Hce.displayName=hx;var Gce="MenuSubContent",Kce=T.forwardRef((e,t)=>{const n=Mce(Kl,e.__scopeMenu),{forceMount:r=n.forceMount,...s}=e,i=sg(Kl,e.__scopeMenu),a=a_(Kl,e.__scopeMenu),o=Wce(Gce,e.__scopeMenu),l=T.useRef(null),c=Rn(t,l);return f.jsx(e1.Provider,{scope:e.__scopeMenu,children:f.jsx(la,{present:r||i.open,children:f.jsx(e1.Slot,{scope:e.__scopeMenu,children:f.jsx(z5,{id:o.contentId,"aria-labelledby":o.triggerId,...s,ref:c,align:"start",side:a.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:u=>{var d;a.isUsingKeyboardRef.current&&((d=l.current)==null||d.focus()),u.preventDefault()},onCloseAutoFocus:u=>u.preventDefault(),onFocusOutside:Wt(e.onFocusOutside,u=>{u.target!==o.trigger&&i.onOpenChange(!1)}),onEscapeKeyDown:Wt(e.onEscapeKeyDown,u=>{a.onClose(),u.preventDefault()}),onKeyDown:Wt(e.onKeyDown,u=>{var m;const d=u.currentTarget.contains(u.target),h=ytt[a.dir].includes(u.key);d&&h&&(i.onOpenChange(!1),(m=o.trigger)==null||m.focus(),u.preventDefault())})})})})})});Kce.displayName=Gce;function Yce(e){return e?"open":"closed"}function sE(e){return e==="indeterminate"}function V5(e){return sE(e)?"indeterminate":e?"checked":"unchecked"}function Ftt(e){const t=document.activeElement;for(const n of e)if(n===t||(n.focus(),document.activeElement!==t))return}function Ltt(e,t){return e.map((n,r)=>e[(t+r)%e.length])}function Btt(e,t,n){const s=t.length>1&&Array.from(t).every(c=>c===t[0])?t[0]:t,i=n?e.indexOf(n):-1;let a=Ltt(e,Math.max(i,0));s.length===1&&(a=a.filter(c=>c!==n));const l=a.find(c=>c.toLowerCase().startsWith(s.toLowerCase()));return l!==n?l:void 0}function $tt(e,t){const{x:n,y:r}=e;let s=!1;for(let i=0,a=t.length-1;i<t.length;a=i++){const o=t[i],l=t[a],c=o.x,u=o.y,d=l.x,h=l.y;u>r!=h>r&&n<(d-c)*(r-u)/(h-u)+c&&(s=!s)}return s}function ztt(e,t){if(!t)return!1;const n={x:e.clientX,y:e.clientY};return $tt(n,t)}function t1(e){return t=>t.pointerType==="mouse"?e(t):void 0}var Zce=Nce,Xce=L5,Jce=Ice,Qce=jce,eue=U5,tue=Pce,nue=uA,rue=Dce,sue=Lce,iue=$ce,aue=Uce,oue=qce,lue=Vce,cue=Hce,uue=Kce,W5="ContextMenu",[Utt,Adt]=Hi(W5,[lA]),fo=lA(),[qtt,due]=Utt(W5),fue=e=>{const{__scopeContextMenu:t,children:n,onOpenChange:r,dir:s,modal:i=!0}=e,[a,o]=T.useState(!1),l=fo(t),c=ks(r),u=T.useCallback(d=>{o(d),c(d)},[c]);return f.jsx(qtt,{scope:t,open:a,onOpenChange:u,modal:i,children:f.jsx(Zce,{...l,dir:s,open:a,onOpenChange:u,modal:i,children:n})})};fue.displayName=W5;var hue="ContextMenuTrigger",pue=T.forwardRef((e,t)=>{const{__scopeContextMenu:n,disabled:r=!1,...s}=e,i=due(hue,n),a=fo(n),o=T.useRef({x:0,y:0}),l=T.useRef({getBoundingClientRect:()=>DOMRect.fromRect({width:0,height:0,...o.current})}),c=T.useRef(0),u=T.useCallback(()=>window.clearTimeout(c.current),[]),d=h=>{o.current={x:h.clientX,y:h.clientY},i.onOpenChange(!0)};return T.useEffect(()=>u,[u]),T.useEffect(()=>void(r&&u()),[r,u]),f.jsxs(f.Fragment,{children:[f.jsx(Xce,{...a,virtualRef:l}),f.jsx(ar.span,{"data-state":i.open?"open":"closed","data-disabled":r?"":void 0,...s,ref:t,style:{WebkitTouchCallout:"none",...e.style},onContextMenu:r?e.onContextMenu:Wt(e.onContextMenu,h=>{u(),d(h),h.preventDefault()}),onPointerDown:r?e.onPointerDown:Wt(e.onPointerDown,y2(h=>{u(),c.current=window.setTimeout(()=>d(h),700)})),onPointerMove:r?e.onPointerMove:Wt(e.onPointerMove,y2(u)),onPointerCancel:r?e.onPointerCancel:Wt(e.onPointerCancel,y2(u)),onPointerUp:r?e.onPointerUp:Wt(e.onPointerUp,y2(u))})]})});pue.displayName=hue;var Vtt="ContextMenuPortal",mue=e=>{const{__scopeContextMenu:t,...n}=e,r=fo(t);return f.jsx(Jce,{...r,...n})};mue.displayName=Vtt;var gue="ContextMenuContent",yue=T.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=due(gue,n),i=fo(n),a=T.useRef(!1);return f.jsx(Qce,{...i,...r,ref:t,side:"right",sideOffset:2,align:"start",onCloseAutoFocus:o=>{var l;(l=e.onCloseAutoFocus)==null||l.call(e,o),!o.defaultPrevented&&a.current&&o.preventDefault(),a.current=!1},onInteractOutside:o=>{var l;(l=e.onInteractOutside)==null||l.call(e,o),!o.defaultPrevented&&!s.modal&&(a.current=!0)},style:{...e.style,"--radix-context-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-context-menu-content-available-width":"var(--radix-popper-available-width)","--radix-context-menu-content-available-height":"var(--radix-popper-available-height)","--radix-context-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-context-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});yue.displayName=gue;var Wtt="ContextMenuGroup",Htt=T.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=fo(n);return f.jsx(eue,{...s,...r,ref:t})});Htt.displayName=Wtt;var Gtt="ContextMenuLabel",Ktt=T.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=fo(n);return f.jsx(tue,{...s,...r,ref:t})});Ktt.displayName=Gtt;var Ytt="ContextMenuItem",bue=T.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=fo(n);return f.jsx(nue,{...s,...r,ref:t})});bue.displayName=Ytt;var Ztt="ContextMenuCheckboxItem",Xtt=T.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=fo(n);return f.jsx(rue,{...s,...r,ref:t})});Xtt.displayName=Ztt;var Jtt="ContextMenuRadioGroup",Qtt=T.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=fo(n);return f.jsx(sue,{...s,...r,ref:t})});Qtt.displayName=Jtt;var ent="ContextMenuRadioItem",tnt=T.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=fo(n);return f.jsx(iue,{...s,...r,ref:t})});tnt.displayName=ent;var nnt="ContextMenuItemIndicator",rnt=T.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=fo(n);return f.jsx(aue,{...s,...r,ref:t})});rnt.displayName=nnt;var snt="ContextMenuSeparator",vue=T.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=fo(n);return f.jsx(oue,{...s,...r,ref:t})});vue.displayName=snt;var int="ContextMenuArrow",ant=T.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=fo(n);return f.jsx(lue,{...s,...r,ref:t})});ant.displayName=int;var ont="ContextMenuSubTrigger",lnt=T.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=fo(n);return f.jsx(cue,{...s,...r,ref:t})});lnt.displayName=ont;var cnt="ContextMenuSubContent",unt=T.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=fo(n);return f.jsx(uue,{...s,...r,ref:t,style:{...e.style,"--radix-context-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-context-menu-content-available-width":"var(--radix-popper-available-width)","--radix-context-menu-content-available-height":"var(--radix-popper-available-height)","--radix-context-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-context-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});unt.displayName=cnt;function y2(e){return t=>t.pointerType!=="mouse"?e(t):void 0}var dnt=fue,fnt=pue,hnt=mue,pnt=yue,mnt=bue,gnt=vue;function oW({...e}){return f.jsx(dnt,{"data-slot":"context-menu",...e})}function lW({...e}){return f.jsx(fnt,{"data-slot":"context-menu-trigger",...e})}function cW({className:e,...t}){return f.jsx(hnt,{children:f.jsx(pnt,{"data-slot":"context-menu-content",className:Ze("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-context-menu-content-available-height) min-w-[8rem] origin-(--radix-context-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",e),...t})})}function tl({className:e,inset:t,variant:n="default",...r}){return f.jsx(mnt,{"data-slot":"context-menu-item","data-inset":t,"data-variant":n,className:Ze("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...r})}function uW({className:e,...t}){return f.jsx(gnt,{"data-slot":"context-menu-separator",className:Ze("bg-border -mx-1 my-1 h-px",e),...t})}const ynt=({entry:e,isEditingThis:t,isChecked:n,isGitRepo:r,newName:s,isOperationLoading:i,creatingFolder:a,handleNavigate:o,handleCheckboxChange:l,startEditing:c,cancelEditing:u,handleRename:d,handleDownload:h,handleDelete:m,setNewName:y,renameInputRef:b,handleGitInit:v,handleGitPull:x,handleGitCommit:w,handleGitPush:S,handleGitStatus:C})=>{const k=e.type==="folder",A=L=>{L.target.closest('input[type="checkbox"], button, input[type="text"], [data-radix-context-menu-trigger]')||t||i||(k?o(e):l(!n,e.id))},R=L=>{L.key==="Enter"?d():L.key==="Escape"&&u()},N=k?r?uH:ph:cH,I=k?r?"text-green-400":"text-yellow-400":"text-blue-400",P=f.jsxs(Es,{className:Ze("group hover:bg-muted/50",t&&"bg-muted ring-1 ring-primary",i&&"opacity-70 cursor-not-allowed",!k&&"cursor-pointer"),onClick:A,onDoubleClick:()=>!i&&!t&&o(e),children:[f.jsx(On,{className:"px-2 py-1",children:f.jsx(Xl,{checked:n,onCheckedChange:L=>l(!!L,e.id),"aria-label":`Select ${e.name}`,className:"border-border data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",disabled:i||k})}),f.jsx(On,{className:"px-2 py-1",children:f.jsx(N,{className:Ze("h-5 w-5",I)})}),f.jsx(On,{className:"py-1 px-2",children:t?f.jsx(_n,{ref:b,value:s,onChange:L=>y(L.target.value),onBlur:d,onKeyDown:R,className:"h-7 px-2 py-1 text-sm bg-input border-border focus:ring-1 focus:ring-primary w-full",onClick:L=>L.stopPropagation(),disabled:i}):f.jsx("span",{className:Ze("truncate",k&&"cursor-pointer hover:underline"),title:e.name,onClick:L=>{k&&(L.stopPropagation(),o(e))},children:e.name})}),f.jsx(On,{className:"text-right py-1 px-2 text-xs text-muted-foreground",children:e.type==="file"&&e.size!==void 0?iw(e.size):""}),f.jsx(On,{className:"text-right text-xs text-muted-foreground py-1 px-2",children:new Date(e.lastModified).toLocaleString()}),f.jsx(On,{className:"text-right pr-4 py-1",children:f.jsx("div",{className:Ze("flex items-center justify-end gap-0.5 opacity-0 group-hover:opacity-100 focus-within:opacity-100 transition-opacity",t&&"opacity-100",i&&"opacity-30"),children:t?f.jsxs(f.Fragment,{children:[f.jsx(Dn,{tooltipText:"Save (Enter)",onClick:L=>{L.stopPropagation(),d()},"aria-label":"Save name",disabled:i||!s.trim(),icon:i?f.jsx(Qn,{className:"h-4 w-4 animate-spin"}):f.jsx(so,{}),className:"h-6 w-6 text-green-500 hover:text-green-400"}),f.jsx(Dn,{tooltipText:"Cancel (Esc)",onClick:L=>{L.stopPropagation(),u()},"aria-label":"Cancel edit",disabled:i,icon:f.jsx(qi,{}),className:"h-6 w-6 text-muted-foreground hover:text-foreground"})]}):f.jsxs(f.Fragment,{children:[f.jsx(Dn,{tooltipText:"Rename",onClick:L=>{L.stopPropagation(),c(e)},"aria-label":"Rename",disabled:i||a,icon:f.jsx(dh,{}),className:"h-6 w-6 text-muted-foreground hover:text-foreground"}),f.jsx(Dn,{tooltipText:k?"Download folder (.zip)":"Download file",onClick:L=>{L.stopPropagation(),h(e)},"aria-label":k?"Download folder as ZIP":"Download file",disabled:i,icon:f.jsx(xu,{}),className:"h-6 w-6 text-muted-foreground hover:text-foreground"}),f.jsx(Dn,{tooltipText:"Delete",onClick:L=>{L.stopPropagation(),m(e)},"aria-label":`Delete ${k?"folder":"file"}`,disabled:i,icon:f.jsx(Ao,{}),className:"h-6 w-6 text-destructive hover:text-destructive/80"})]})})})]},e.id);return k?f.jsxs(oW,{children:[f.jsx(lW,{disabled:t||i,asChild:!0,children:P}),f.jsxs(cW,{children:[f.jsx(tl,{onSelect:()=>o(e),disabled:t||i,children:"Open Folder"}),f.jsx(uW,{}),r?f.jsxs(f.Fragment,{children:[f.jsxs(tl,{onSelect:()=>x(e.path),disabled:i,children:[f.jsx(hH,{className:"mr-2 h-4 w-4"}),"Git Pull"]}),f.jsxs(tl,{onSelect:()=>w(e.path),disabled:i,children:[f.jsx(fH,{className:"mr-2 h-4 w-4"}),"Git Commit..."]}),f.jsxs(tl,{onSelect:()=>S(e.path),disabled:i,children:[f.jsx(OP,{className:"mr-2 h-4 w-4"}),"Git Push"]}),f.jsxs(tl,{onSelect:()=>C(e.path),disabled:i,children:[f.jsx(FP,{className:"mr-2 h-4 w-4"}),"Git Status"]})]}):f.jsxs(tl,{onSelect:()=>v(e.path),disabled:i,children:[f.jsx(Nc,{className:"mr-2 h-4 w-4"}),"Initialize Git Repository"]}),f.jsx(uW,{}),f.jsxs(tl,{onSelect:()=>c(e),disabled:i,children:[f.jsx(dh,{className:"mr-2 h-4 w-4"}),"Rename"]}),f.jsxs(tl,{onSelect:()=>h(e),disabled:i,children:[f.jsx(xu,{className:"mr-2 h-4 w-4"}),"Download as ZIP"]}),f.jsxs(tl,{className:"text-red-600 focus:text-red-600 focus:bg-red-100 dark:focus:bg-red-900/20",onSelect:()=>m(e),disabled:i,children:[f.jsx(Ao,{className:"mr-2 h-4 w-4"}),"Delete Folder"]})]})]},e.id):f.jsxs(oW,{children:[f.jsx(lW,{disabled:t||i,asChild:!0,children:P}),f.jsxs(cW,{children:[f.jsxs(tl,{onSelect:()=>l(!n,e.id),disabled:i,children:[n?"Deselect":"Select"," File"]}),f.jsxs(tl,{onSelect:()=>c(e),disabled:i,children:[f.jsx(dh,{className:"mr-2 h-4 w-4"}),"Rename"]}),f.jsxs(tl,{onSelect:()=>h(e),disabled:i,children:[f.jsx(xu,{className:"mr-2 h-4 w-4"}),"Download File"]}),f.jsxs(tl,{className:"text-red-600 focus:text-red-600 focus:bg-red-100 dark:focus:bg-red-900/20",onSelect:()=>m(e),disabled:i,children:[f.jsx(Ao,{className:"mr-2 h-4 w-4"}),"Delete File"]})]})]},e.id)},bnt=({entries:e,editingPath:t,newName:n,creatingFolder:r,newFolderName:s,selectedFileIds:i,isOperationLoading:a,handleNavigate:o,handleCheckboxChange:l,startEditing:c,cancelEditing:u,handleRename:d,cancelCreatingFolder:h,handleCreateFolder:m,handleDownload:y,handleDelete:b,setNewName:v,setNewFolderName:x,renameInputRef:w,newFolderInputRef:S,gitRepoStatus:C,handleGitInit:k,handleGitPull:A,handleGitCommit:R,handleGitPush:N,handleGitStatus:I})=>{const P=T.useMemo(()=>e,[e]);return a&&e.length===0&&!r?f.jsx("div",{className:"flex items-center justify-center h-full text-muted-foreground",children:"Loading..."}):f.jsx("div",{className:"relative h-full",children:f.jsxs(lf,{className:"w-full text-sm",children:[f.jsx(fp,{className:"sticky top-0 bg-card z-10",children:f.jsxs(Es,{className:"hover:bg-card",children:[f.jsx(Tr,{className:"w-[40px] px-2"}),f.jsx(Tr,{className:"w-[40px] px-2"}),f.jsx(Tr,{children:"Name"}),f.jsx(Tr,{className:"w-[100px] text-right",children:"Size"}),f.jsx(Tr,{className:"w-[150px] text-right",children:"Modified"}),f.jsx(Tr,{className:"w-[100px] text-right pr-4",children:"Actions"})]})}),f.jsxs(cf,{children:[r&&f.jsx(vce,{newFolderName:s,setNewFolderName:x,handleCreateFolder:m,cancelCreatingFolder:h,newFolderInputRef:S,isOperationLoading:a}),P.map(L=>{const O=t===L.path,V=i.has(L.id),D=C[L.path]??!1;return f.jsx(ynt,{entry:L,isEditingThis:O,isChecked:V,isGitRepo:D,newName:O?n:"",isOperationLoading:a,creatingFolder:r,handleNavigate:o,handleCheckboxChange:l,startEditing:c,cancelEditing:u,handleRename:d,handleDownload:y,handleDelete:b,setNewName:v,renameInputRef:w,handleGitInit:k,handleGitPull:A,handleGitCommit:R,handleGitPush:N,handleGitStatus:I},L.id)}),e.length===0&&!r&&!a&&f.jsx(Es,{children:f.jsx(On,{colSpan:6,className:"h-24 text-center text-muted-foreground",children:"Folder is empty"})})]})]})})},vnt=({currentPath:e,isAnyLoading:t,isOperationLoading:n,entries:r,editingPath:s,creatingFolder:i,handleNavigateHome:a,handleNavigateUp:o,handleRefresh:l,startCreatingFolder:c,handleUploadClick:u,handleFolderUploadClick:d,handleArchiveUploadClick:h,handleDownloadAll:m,handleCloneClick:y,fileInputRef:b,folderInputRef:v,archiveInputRef:x,handleFileChange:w,handleArchiveChange:S})=>f.jsxs(f.Fragment,{children:[f.jsx("input",{type:"file",ref:b,onChange:w,className:"hidden",multiple:!0,disabled:t}),f.jsx("input",{type:"file",ref:v,onChange:w,className:"hidden",webkitdirectory:"true",mozdirectory:"true",directory:"true",disabled:t}),f.jsx("input",{type:"file",ref:x,onChange:S,className:"hidden",accept:".zip",disabled:t}),f.jsxs("div",{className:"flex items-center gap-1 p-2 border-b border-border flex-shrink-0 flex-wrap",children:[f.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[f.jsx(ft,{variant:"ghost",size:"icon",onClick:C=>{C.preventDefault(),C.stopPropagation(),a()},disabled:e==="/"||t,title:"Go to root directory",className:"h-8 w-8",type:"button",children:f.jsx(Ime,{className:"h-4 w-4"})}),f.jsx(ft,{variant:"ghost",size:"icon",onClick:C=>{C.preventDefault(),C.stopPropagation(),o()},disabled:e==="/"||t,title:"Go up one level",className:"h-8 w-8",type:"button",children:f.jsx(gme,{className:"h-4 w-4"})}),f.jsx("span",{className:"text-sm font-mono text-muted-foreground truncate flex-shrink min-w-0 px-2 py-1 rounded bg-muted/50 max-w-[150px] sm:max-w-xs md:max-w-sm lg:max-w-md",title:e,children:e})]}),f.jsx("div",{className:"flex-grow"}),f.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0 flex-wrap justify-end",children:[" ",f.jsx(ft,{variant:"ghost",size:"icon",onClick:C=>{C.preventDefault(),C.stopPropagation(),l()},disabled:t,title:"Refresh current directory",className:"h-8 w-8",type:"button",children:n?f.jsx(Qn,{className:"h-4 w-4 animate-spin"}):f.jsx(gm,{className:"h-4 w-4"})}),f.jsxs(ft,{variant:"outline",size:"sm",onClick:C=>{C.preventDefault(),C.stopPropagation(),c()},disabled:t||i||!!s,className:"h-8",title:"Create New Folder",type:"button",children:[n&&i?f.jsx(Qn,{className:"h-4 w-4 mr-1 animate-spin"}):f.jsx(dH,{className:"h-4 w-4 mr-1"}),f.jsx("span",{className:"hidden sm:inline",children:"Folder"})," "]}),f.jsxs(ft,{variant:"outline",size:"sm",onClick:C=>{C.preventDefault(),C.stopPropagation(),u()},disabled:t,className:"h-8",title:"Upload Files",type:"button",children:[n?f.jsx(Qn,{className:"h-4 w-4 mr-1 animate-spin"}):f.jsx(jP,{className:"h-4 w-4 mr-1"}),f.jsx("span",{className:"hidden sm:inline",children:"Files"})," "]}),f.jsxs(ft,{variant:"outline",size:"sm",onClick:C=>{C.preventDefault(),C.stopPropagation(),d()},disabled:t,className:"h-8",title:"Upload Folder",type:"button",children:[n?f.jsx(Qn,{className:"h-4 w-4 mr-1 animate-spin"}):f.jsx(ph,{className:"h-4 w-4 mr-1"}),f.jsx("span",{className:"hidden sm:inline",children:"Folder"})," "]}),f.jsxs(ft,{variant:"outline",size:"sm",onClick:C=>{C.preventDefault(),C.stopPropagation(),h()},disabled:t,className:"h-8",title:"Upload & Extract ZIP",type:"button",children:[n?f.jsx(Qn,{className:"h-4 w-4 mr-1 animate-spin"}):f.jsx(eme,{className:"h-4 w-4 mr-1"}),f.jsx("span",{className:"hidden sm:inline",children:"ZIP"})," "]}),f.jsxs(ft,{variant:"outline",size:"sm",onClick:C=>{C.preventDefault(),C.stopPropagation(),y()},disabled:t,className:"h-8",title:"Clone Git Repository",type:"button",children:[n?f.jsx(Qn,{className:"h-4 w-4 mr-1 animate-spin"}):f.jsx(Nc,{className:"h-4 w-4 mr-1"}),f.jsx("span",{className:"hidden sm:inline",children:"Clone"})," "]}),f.jsxs(ft,{variant:"outline",size:"sm",onClick:C=>{C.preventDefault(),C.stopPropagation(),m()},disabled:t||r.length===0,className:"h-8",title:"Download Current Directory as ZIP",type:"button",children:[n?f.jsx(Qn,{className:"h-4 w-4 mr-1 animate-spin"}):f.jsx(aH,{className:"h-4 w-4 mr-1"}),f.jsx("span",{className:"hidden sm:inline",children:"Export"})," "]})]})]})]}),xue=({isOpen:e,onOpenChange:t,title:n,description:r,children:s,submitLabel:i="Submit",onSubmit:a,isSubmitting:o,submitDisabled:l=!1,className:c,contentClassName:u})=>{const d=async h=>{h==null||h.preventDefault(),!(o||l)&&await a()};return f.jsx(lp,{open:e,onOpenChange:t,children:f.jsxs(cp,{className:Ze(c),children:[f.jsxs(up,{children:[f.jsx(dp,{children:n}),r&&f.jsx(ng,{children:r})]}),f.jsx("div",{className:Ze("py-4",u),children:s}),f.jsxs(pb,{children:[f.jsx(YQe,{asChild:!0,children:f.jsx(ft,{variant:"outline",disabled:o,children:"Cancel"})}),f.jsxs(ft,{onClick:d,disabled:o||l,children:[o&&f.jsx(Qn,{className:"mr-2 h-4 w-4 animate-spin"}),o?"Submitting...":i]})]})]})})},xnt=({isOpen:e,onOpenChange:t,cloneRepoUrl:n,setCloneRepoUrl:r,cloneBranch:s,setCloneBranch:i,isCloning:a,onSubmitClone:o,currentPath:l})=>f.jsx(xue,{isOpen:e,onOpenChange:t,title:"Clone Git Repository",description:f.jsxs(f.Fragment,{children:["Enter the repository URL. It will be cloned into a new folder named after the repository within ",f.jsx("code",{children:l}),"."]}),submitLabel:"Clone",onSubmit:o,isSubmitting:a,submitDisabled:!n.trim(),children:f.jsxs("div",{className:"grid gap-4",children:[f.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[f.jsx(It,{htmlFor:"clone-url",className:"text-right",children:"URL"}),f.jsx(_n,{id:"clone-url",value:n,onChange:c=>r(c.target.value),className:"col-span-3",placeholder:"https://github.com/user/repo.git",disabled:a})]}),f.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[f.jsx(It,{htmlFor:"clone-branch",className:"text-right",children:"Branch"}),f.jsx(_n,{id:"clone-branch",value:s,onChange:c=>i(c.target.value),className:"col-span-3",placeholder:"main (default)",disabled:a})]})]})}),wnt=({isOpen:e,onOpenChange:t,commitPath:n,commitMessage:r,setCommitMessage:s,isCommitting:i,onSubmitCommit:a})=>f.jsx(xue,{isOpen:e,onOpenChange:t,title:"Commit Changes",description:f.jsxs(f.Fragment,{children:["Enter a commit message for the changes in ",f.jsx("code",{children:n}),". All current changes in this directory will be staged and committed."]}),submitLabel:"Commit",onSubmit:a,isSubmitting:i,submitDisabled:!r.trim(),children:f.jsx("div",{className:"grid gap-4",children:f.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[f.jsx(It,{htmlFor:"commit-msg",className:"text-right",children:"Message"}),f.jsx(_n,{id:"commit-msg",value:r,onChange:o=>s(o.target.value),className:"col-span-3",placeholder:"e.g., Add feature X",disabled:i})]})})});var dA="DropdownMenu",[_nt,Rdt]=Hi(dA,[lA]),ho=lA(),[Snt,wue]=_nt(dA),_ue=e=>{const{__scopeDropdownMenu:t,children:n,dir:r,open:s,defaultOpen:i,onOpenChange:a,modal:o=!0}=e,l=ho(t),c=T.useRef(null),[u,d]=Pc({prop:s,defaultProp:i??!1,onChange:a,caller:dA});return f.jsx(Snt,{scope:t,triggerId:aa(),triggerRef:c,contentId:aa(),open:u,onOpenChange:d,onOpenToggle:T.useCallback(()=>d(h=>!h),[d]),modal:o,children:f.jsx(Zce,{...l,open:u,onOpenChange:d,dir:r,modal:o,children:n})})};_ue.displayName=dA;var Sue="DropdownMenuTrigger",Cue=T.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,disabled:r=!1,...s}=e,i=wue(Sue,n),a=ho(n);return f.jsx(Xce,{asChild:!0,...a,children:f.jsx(ar.button,{type:"button",id:i.triggerId,"aria-haspopup":"menu","aria-expanded":i.open,"aria-controls":i.open?i.contentId:void 0,"data-state":i.open?"open":"closed","data-disabled":r?"":void 0,disabled:r,...s,ref:hl(t,i.triggerRef),onPointerDown:Wt(e.onPointerDown,o=>{!r&&o.button===0&&o.ctrlKey===!1&&(i.onOpenToggle(),i.open||o.preventDefault())}),onKeyDown:Wt(e.onKeyDown,o=>{r||(["Enter"," "].includes(o.key)&&i.onOpenToggle(),o.key==="ArrowDown"&&i.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(o.key)&&o.preventDefault())})})})});Cue.displayName=Sue;var Cnt="DropdownMenuPortal",kue=e=>{const{__scopeDropdownMenu:t,...n}=e,r=ho(t);return f.jsx(Jce,{...r,...n})};kue.displayName=Cnt;var Eue="DropdownMenuContent",Tue=T.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=wue(Eue,n),i=ho(n),a=T.useRef(!1);return f.jsx(Qce,{id:s.contentId,"aria-labelledby":s.triggerId,...i,...r,ref:t,onCloseAutoFocus:Wt(e.onCloseAutoFocus,o=>{var l;a.current||(l=s.triggerRef.current)==null||l.focus(),a.current=!1,o.preventDefault()}),onInteractOutside:Wt(e.onInteractOutside,o=>{const l=o.detail.originalEvent,c=l.button===0&&l.ctrlKey===!0,u=l.button===2||c;(!s.modal||u)&&(a.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});Tue.displayName=Eue;var knt="DropdownMenuGroup",Ent=T.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=ho(n);return f.jsx(eue,{...s,...r,ref:t})});Ent.displayName=knt;var Tnt="DropdownMenuLabel",Ant=T.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=ho(n);return f.jsx(tue,{...s,...r,ref:t})});Ant.displayName=Tnt;var Rnt="DropdownMenuItem",Aue=T.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=ho(n);return f.jsx(nue,{...s,...r,ref:t})});Aue.displayName=Rnt;var Nnt="DropdownMenuCheckboxItem",Mnt=T.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=ho(n);return f.jsx(rue,{...s,...r,ref:t})});Mnt.displayName=Nnt;var Int="DropdownMenuRadioGroup",jnt=T.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=ho(n);return f.jsx(sue,{...s,...r,ref:t})});jnt.displayName=Int;var Pnt="DropdownMenuRadioItem",Ont=T.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=ho(n);return f.jsx(iue,{...s,...r,ref:t})});Ont.displayName=Pnt;var Dnt="DropdownMenuItemIndicator",Fnt=T.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=ho(n);return f.jsx(aue,{...s,...r,ref:t})});Fnt.displayName=Dnt;var Lnt="DropdownMenuSeparator",Rue=T.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=ho(n);return f.jsx(oue,{...s,...r,ref:t})});Rue.displayName=Lnt;var Bnt="DropdownMenuArrow",$nt=T.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=ho(n);return f.jsx(lue,{...s,...r,ref:t})});$nt.displayName=Bnt;var znt="DropdownMenuSubTrigger",Unt=T.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=ho(n);return f.jsx(cue,{...s,...r,ref:t})});Unt.displayName=znt;var qnt="DropdownMenuSubContent",Vnt=T.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=ho(n);return f.jsx(uue,{...s,...r,ref:t,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});Vnt.displayName=qnt;var Wnt=_ue,Hnt=Cue,Gnt=kue,Knt=Tue,Ynt=Aue,Znt=Rue;function Xnt({...e}){return f.jsx(Wnt,{"data-slot":"dropdown-menu",...e})}function Jnt({...e}){return f.jsx(Hnt,{"data-slot":"dropdown-menu-trigger",...e})}function Qnt({className:e,sideOffset:t=4,...n}){return f.jsx(Gnt,{children:f.jsx(Knt,{"data-slot":"dropdown-menu-content",sideOffset:t,className:Ze("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-dropdown-menu-content-available-height) min-w-[8rem] origin-(--radix-dropdown-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",e),...n})})}function nu({className:e,inset:t,variant:n="default",...r}){return f.jsx(Ynt,{"data-slot":"dropdown-menu-item","data-inset":t,"data-variant":n,className:Ze("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...r})}function dW({className:e,...t}){return f.jsx(Znt,{"data-slot":"dropdown-menu-separator",className:Ze("bg-border -mx-1 my-1 h-px",e),...t})}const ert=({entries:e,editingPath:t,newName:n,creatingFolder:r,newFolderName:s,selectedFileIds:i,isOperationLoading:a,handleNavigate:o,handleCheckboxChange:l,startEditing:c,cancelEditing:u,handleRename:d,cancelCreatingFolder:h,handleCreateFolder:m,handleDownload:y,handleDelete:b,setNewName:v,setNewFolderName:x,renameInputRef:w,newFolderInputRef:S,gitRepoStatus:C,handleGitInit:k,handleGitPull:A,handleGitCommit:R,handleGitPush:N,handleGitStatus:I})=>{const P=L=>{L.key==="Enter"?d():L.key==="Escape"&&u()};return a&&e.length===0&&!r?f.jsx("div",{className:"flex items-center justify-center h-full text-muted-foreground p-4",children:"Loading..."}):f.jsxs("div",{className:"p-2 space-y-1",children:[r&&f.jsx("div",{className:"border rounded-md p-2 bg-muted/30",children:f.jsx(vce,{newFolderName:s,setNewFolderName:x,handleCreateFolder:m,cancelCreatingFolder:h,newFolderInputRef:S,isOperationLoading:a,isMobile:!0})}),e.map(L=>{const O=t===L.path,V=i.has(L.id),D=C[L.path]??!1,Z=L.type==="folder",U=Z?D?uH:ph:cH,H=Z?D?"text-green-400":"text-yellow-400":"text-blue-400";return f.jsxs("div",{className:Ze("flex items-center justify-between p-2 border rounded-md",O&&"bg-muted ring-1 ring-primary",a&&"opacity-70 cursor-not-allowed",!O&&"hover:bg-muted/50",!O&&"cursor-pointer"),onClick:()=>{O||a||(Z?o(L):l(!V,L.id))},children:[f.jsxs("div",{className:"flex items-center gap-2 flex-grow min-w-0",children:[!Z&&f.jsx(Xl,{checked:V,onCheckedChange:$=>l(!!$,L.id),"aria-label":`Select ${L.name}`,className:"border-border data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground flex-shrink-0",disabled:a,onClick:$=>$.stopPropagation()}),Z&&f.jsx("div",{className:"w-6 flex-shrink-0"}),f.jsx(U,{className:Ze("h-5 w-5 flex-shrink-0",H)}),f.jsxs("div",{className:"flex flex-col min-w-0 flex-grow",children:[O?f.jsx(_n,{ref:w,value:n,onChange:$=>v($.target.value),onBlur:d,onKeyDown:P,className:"h-7 px-2 py-1 text-sm bg-input border-border focus:ring-1 focus:ring-primary w-full",onClick:$=>$.stopPropagation(),disabled:a}):f.jsx("span",{className:"text-sm font-medium truncate",title:L.name,children:L.name}),f.jsx("span",{className:"text-xs text-muted-foreground",children:L.type==="file"&&L.size!==void 0?iw(L.size):L.type==="folder"?D?"Git Repository":"Folder":""})]})]}),f.jsx("div",{className:"flex items-center flex-shrink-0 ml-2",children:O?f.jsxs(f.Fragment,{children:[f.jsx(ft,{variant:"ghost",size:"icon",className:"h-7 w-7 text-green-500 hover:text-green-600",onClick:$=>{$.stopPropagation(),d()},disabled:a||!n.trim(),"aria-label":"Save name",children:a?f.jsx(Qn,{className:"h-4 w-4 animate-spin"}):f.jsx(so,{className:"h-4 w-4"})}),f.jsx(ft,{variant:"ghost",size:"icon",className:"h-7 w-7 text-muted-foreground hover:text-foreground",onClick:$=>{$.stopPropagation(),u()},disabled:a,"aria-label":"Cancel edit",children:f.jsx(qi,{className:"h-4 w-4"})})]}):f.jsxs(Xnt,{children:[f.jsx(Jnt,{asChild:!0,children:f.jsx(ft,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:$=>$.stopPropagation(),disabled:a,"aria-label":"More actions",children:f.jsx(Jpe,{className:"h-4 w-4"})})}),f.jsxs(Qnt,{align:"end",onClick:$=>$.stopPropagation(),children:[Z&&f.jsx(nu,{onSelect:()=>o(L),children:"Open Folder"}),!Z&&f.jsxs(nu,{onSelect:()=>l(!V,L.id),children:[V?"Deselect":"Select"," File"]}),f.jsxs(nu,{onSelect:()=>c(L),children:[f.jsx(dh,{className:"mr-2 h-4 w-4"})," Rename"]}),f.jsxs(nu,{onSelect:()=>y(L),children:[f.jsx(xu,{className:"mr-2 h-4 w-4"})," Download"," ",Z?"as ZIP":""]}),Z&&f.jsx(dW,{}),Z&&D&&f.jsxs(f.Fragment,{children:[f.jsxs(nu,{onSelect:()=>A(L.path),children:[f.jsx(hH,{className:"mr-2 h-4 w-4"})," Git Pull"]}),f.jsxs(nu,{onSelect:()=>R(L.path),children:[f.jsx(fH,{className:"mr-2 h-4 w-4"})," Git Commit..."]}),f.jsxs(nu,{onSelect:()=>N(L.path),children:[f.jsx(OP,{className:"mr-2 h-4 w-4"})," Git Push"]}),f.jsxs(nu,{onSelect:()=>I(L.path),children:[f.jsx(FP,{className:"mr-2 h-4 w-4"})," Git Status"]})]}),Z&&!D&&f.jsxs(nu,{onSelect:()=>k(L.path),children:[f.jsx(Nc,{className:"mr-2 h-4 w-4"})," Initialize Git Repo"]}),f.jsx(dW,{}),f.jsxs(nu,{className:"text-red-600 focus:text-red-600",onSelect:()=>b(L),children:[f.jsx(Ao,{className:"mr-2 h-4 w-4"})," Delete"]})]})]})})]},L.id)}),e.length===0&&!r&&!a&&f.jsx("div",{className:"p-4 text-center text-sm text-muted-foreground",children:"Folder is empty"})]})},H5=T.memo(()=>{const{nodes:e,childrenMap:t,currentParentId:n,loading:r,operationLoading:s,error:i,rootId:a,selectedFileIds:o,vfsKey:l,configuredVfsKey:c,initializingKey:u}=Js(yn(_e=>({nodes:_e.nodes,childrenMap:_e.childrenMap,currentParentId:_e.currentParentId,selectedFileIds:_e.selectedFileIds,loading:_e.loading,operationLoading:_e.operationLoading,error:_e.error,rootId:_e.rootId,vfsKey:_e.vfsKey,configuredVfsKey:_e.configuredVfsKey,initializingKey:_e.initializingKey}))),[d,h]=T.useState(""),[m,y]=T.useState(null),[b,v]=T.useState(!1),[x,w]=T.useState(""),[S,C]=T.useState({}),[k,A]=T.useState(!1),[R,N]=T.useState(""),[I,P]=T.useState(""),[L,O]=T.useState(!1),[V,D]=T.useState(!1),[Z,U]=T.useState(null),[H,$]=T.useState(""),[ne,W]=T.useState(!1),[Q,ee]=T.useState({}),se=T.useRef(null),pe=T.useRef(null),ce=T.useRef(null),Ie=T.useRef(null),De=T.useRef(null),Se=n?e[n]:null,Ce=Se?Se.path:"/",Qe=(t[n||a||""]||[]).map(_e=>e[_e]).filter(_e=>!!_e).sort((_e,Ue)=>_e.type==="folder"&&Ue.type==="file"?-1:_e.type==="file"&&Ue.type==="folder"?1:_e.name.localeCompare(Ue.name)),Ve=T.useMemo(()=>Qe.filter(_e=>_e.type==="folder").map(_e=>_e.path),[Qe]),Ne=r||u!==null||l!==c,K=s||L||ne||Object.values(Q).some(Boolean);T.useEffect(()=>{n!==null&&!t[n]&&!Ne&&c===l?Pe.emit(dn.fetchNodesRequest,{parentId:n}):n===null&&a&&!t[a]&&!Ne&&c===l&&Pe.emit(dn.fetchNodesRequest,{parentId:a})},[n,t,a,Ne,c,l]),T.useEffect(()=>{var _e,Ue;m&&((_e=Ie.current)==null||_e.focus(),(Ue=Ie.current)==null||Ue.select())},[m]),T.useEffect(()=>{var _e;b&&((_e=De.current)==null||_e.focus())},[b]),T.useEffect(()=>{(async()=>{if(Ne||Ve.length===0)return;const Ue={};let kt=!1;for(const fe of Ve)try{const Y=await uTe(fe);S[fe]!==Y&&(Ue[fe]=Y,kt=!0)}catch(Y){console.error(`Error checking git status for ${fe}:`,Y),S[fe]!==!1&&(Ue[fe]=!1,kt=!0)}kt&&C(fe=>({...fe,...Ue}))})()},[Ve,Ne,S]);const ge=T.useCallback(async(_e,Ue,kt)=>{if(!(K||Ne)){kt!==!1&&Pe.emit(dn.loadingStateChanged,{isLoading:r,operationLoading:!0,error:null});try{Pe.emit(_e,Ue)}catch(fe){console.error("[FileManager Operation Error]:",fe),Pe.emit(dn.loadingStateChanged,{isLoading:r,operationLoading:s,error:fe instanceof Error?fe.message:String(fe)})}finally{kt!==!1&&Pe.emit(dn.loadingStateChanged,{isLoading:r,operationLoading:!1,error:i})}}},[K,Ne,r,s,i]),Ae=T.useCallback(_e=>{K||Ne||m||_e.type==="folder"&&ge(dn.setCurrentPathRequest,{path:_e.path},!1)},[K,Ne,m,ge]),le=T.useCallback(()=>{if(K||Ne||Ce==="/")return;const _e=ZE(Ce);ge(dn.setCurrentPathRequest,{path:_e},!1)},[K,Ne,Ce,ge]),oe=T.useCallback(()=>{K||Ne||Ce==="/"||ge(dn.setCurrentPathRequest,{path:"/"},!1)},[K,Ne,Ce,ge]),re=T.useCallback(()=>{Ne||ge(dn.fetchNodesRequest,{parentId:n},!1)},[ge,n,Ne]),Te=T.useCallback((_e,Ue)=>{const kt=e[Ue];kt&&kt.type==="file"?_e?Pe.emit(dn.selectFileRequest,{fileId:Ue}):Pe.emit(dn.deselectFileRequest,{fileId:Ue}):kt&&kt.type==="folder"&&je.info("Folders cannot be attached to the prompt.")},[e]),Be=T.useCallback(_e=>{K||Ne||b||(y(_e.path),h(_e.name),v(!1))},[K,Ne,b]),ke=T.useCallback(()=>{y(null),h("")},[]),lt=T.useCallback(async()=>{if(!m||!d.trim()){ke();return}const _e=Object.values(e).find(Ue=>Ue.path===m);_e&&_e.name!==d.trim()&&await ge(dn.renameNodeRequest,{id:_e.id,newName:d.trim()}),ke()},[m,d,e,ke,ge]),Rt=T.useCallback(()=>{K||Ne||m||(v(!0),w(""),y(null))},[K,Ne,m]),ht=T.useCallback(()=>{v(!1),w("")},[]),Pt=T.useCallback(async()=>{if(!x.trim()){ht();return}await ge(dn.createDirectoryRequest,{parentId:n,name:x.trim()}),ht()},[x,n,ht,ge]),qt=()=>{var _e;return(_e=se.current)==null?void 0:_e.click()},Lt=()=>{var _e;return(_e=pe.current)==null?void 0:_e.click()},en=()=>{var _e;return(_e=ce.current)==null?void 0:_e.click()},xe=T.useCallback(async _e=>{const Ue=_e.target.files;Ue&&Ue.length>0&&(await ge(dn.uploadFilesRequest,{parentId:n,files:Ue}),_e.target&&(_e.target.value=""))},[n,ge]),F=T.useCallback(async _e=>{var kt;const Ue=(kt=_e.target.files)==null?void 0:kt[0];if(Ue){Pe.emit(dn.loadingStateChanged,{isLoading:r,operationLoading:!0,error:null});try{await hTe(Ue,Ce),Pe.emit(dn.fetchNodesRequest,{parentId:n})}catch(fe){console.error("Archive upload error:",fe)}finally{Pe.emit(dn.loadingStateChanged,{isLoading:r,operationLoading:!1,error:i}),_e.target&&(_e.target.value="")}}},[Ce,n,r,i]),X=T.useCallback(async _e=>{window.confirm(`Delete ${_e.type} "${_e.name}"?${_e.type==="folder"?`

WARNING: This will delete all contents inside`:""}`)&&await ge(dn.deleteNodesRequest,{ids:[_e.id]})},[ge]),ye=T.useCallback(async _e=>{Pe.emit(dn.loadingStateChanged,{isLoading:r,operationLoading:!0,error:null});try{_e.type==="file"?await fTe(_e.path):await Ez(`${_e.name}.zip`,_e.path)}catch(Ue){console.error("Download error:",Ue)}finally{Pe.emit(dn.loadingStateChanged,{isLoading:r,operationLoading:!1,error:i})}},[r,i]),Fe=T.useCallback(async()=>{if(Qe.length!==0){Pe.emit(dn.loadingStateChanged,{isLoading:r,operationLoading:!0,error:null});try{const _e=gi(Ce)||"root";await Ez(`${_e}_export.zip`,Ce)}catch(_e){console.error("Download all error:",_e)}finally{Pe.emit(dn.loadingStateChanged,{isLoading:r,operationLoading:!1,error:i})}}},[Ce,Qe.length,r,i]),we=T.useCallback(async(_e,Ue)=>{if(!(Q[_e]||Ne||s)){ee(kt=>({...kt,[_e]:!0})),Pe.emit(dn.loadingStateChanged,{isLoading:r,operationLoading:s,error:null});try{await Ue()}catch(kt){console.error(`[FileManager Git Op Error @ ${_e}]:`,kt)}finally{ee(kt=>({...kt,[_e]:!1}))}}},[Q,Ne,s,r]),Me=T.useCallback(_e=>{we(_e,async()=>{await mZ(_e),C(Ue=>({...Ue,[_e]:!0}))})},[we]),de=T.useCallback(_e=>{je.info("Pulling default branch (auth not implemented yet)..."),we(_e,()=>nT(_e,"main"))},[we]),vt=T.useCallback(_e=>{U(_e),$(""),D(!0)},[]),ot=T.useCallback(_e=>{je.info("Pushing default branch (auth not implemented yet)..."),we(_e,()=>uD(_e,"main"))},[we]),B=T.useCallback(_e=>{we(_e,()=>gZ(_e))},[we]),ze=T.useCallback(()=>{N(""),P(""),A(!0)},[]),st=T.useCallback(async()=>{if(!R.trim()){je.error("Repository URL cannot be empty.");return}O(!0),Pe.emit(dn.loadingStateChanged,{isLoading:r,operationLoading:s,error:null});try{const _e=gi(R.trim().replace(/\.git$/,""))||"cloned_repo",Ue=kj(Ce,_e);await pZ(Ue,R.trim(),I.trim()||void 0),A(!1),Pe.emit(dn.fetchNodesRequest,{parentId:n})}catch{}finally{O(!1)}},[R,I,Ce,n,r,s]),be=T.useCallback(async()=>{if(!Z||!H.trim()){je.error("Commit message cannot be empty.");return}W(!0),Pe.emit(dn.loadingStateChanged,{isLoading:r,operationLoading:s,error:null});try{await cD(Z,H.trim()),D(!1)}catch{}finally{W(!1)}},[Z,H,r,s]);return Ne?f.jsxs("div",{className:"flex h-full flex-col items-center justify-center bg-card text-muted-foreground p-4",children:[f.jsx(Qn,{className:"h-8 w-8 animate-spin mb-2"}),f.jsx("p",{children:u?`Initializing filesystem: ${u}`:"Loading filesystem..."}),i&&f.jsxs("p",{className:"text-destructive mt-2",children:["Error: ",i]})]}):i&&!Ne?f.jsxs("div",{className:"flex h-full flex-col items-center justify-center bg-card text-destructive p-4",children:[f.jsxs("p",{children:["Error loading filesystem: ",i]}),f.jsx(ft,{variant:"outline",size:"sm",onClick:()=>Pe.emit(dn.initializeVFSRequest,{vfsKey:l||"default_fallback_key"}),className:"mt-2",children:"Retry"})]}):f.jsxs("div",{className:Ze("flex h-full flex-col bg-card text-card-foreground"),children:[f.jsx(vnt,{currentPath:Ce,isAnyLoading:K||Ne,isOperationLoading:s,entries:Qe,editingPath:m,creatingFolder:b,handleNavigateHome:oe,handleNavigateUp:le,handleRefresh:re,startCreatingFolder:Rt,handleUploadClick:qt,handleFolderUploadClick:Lt,handleArchiveUploadClick:en,handleDownloadAll:Fe,handleCloneClick:ze,fileInputRef:se,folderInputRef:pe,archiveInputRef:ce,handleFileChange:xe,handleArchiveChange:F}),f.jsx("div",{className:"flex-grow overflow-auto hidden md:block",children:f.jsx(bnt,{entries:Qe,editingPath:m,newName:d,creatingFolder:b,newFolderName:x,selectedFileIds:o,isOperationLoading:K,handleNavigate:Ae,handleCheckboxChange:Te,startEditing:Be,cancelEditing:ke,handleRename:lt,cancelCreatingFolder:ht,handleCreateFolder:Pt,handleDownload:ye,handleDelete:X,setNewName:h,setNewFolderName:w,renameInputRef:Ie,newFolderInputRef:De,gitRepoStatus:S,handleGitInit:Me,handleGitPull:de,handleGitCommit:vt,handleGitPush:ot,handleGitStatus:B})}),f.jsx("div",{className:"flex-grow overflow-auto block md:hidden",children:f.jsx(ert,{entries:Qe,editingPath:m,newName:d,creatingFolder:b,newFolderName:x,selectedFileIds:o,isOperationLoading:K,handleNavigate:Ae,handleCheckboxChange:Te,startEditing:Be,cancelEditing:ke,handleRename:lt,cancelCreatingFolder:ht,handleCreateFolder:Pt,handleDownload:ye,handleDelete:X,setNewName:h,setNewFolderName:w,renameInputRef:Ie,newFolderInputRef:De,gitRepoStatus:S,handleGitInit:Me,handleGitPull:de,handleGitCommit:vt,handleGitPush:ot,handleGitStatus:B})}),f.jsx(xnt,{isOpen:k,onOpenChange:A,cloneRepoUrl:R,setCloneRepoUrl:N,cloneBranch:I,setCloneBranch:P,isCloning:L,onSubmitClone:st,currentPath:Ce}),f.jsx(wnt,{isOpen:V,onOpenChange:D,commitPath:Z,commitMessage:H,setCommitMessage:$,isCommitting:ne,onSubmitCommit:be})]})});H5.displayName="FileManager";const trt=({vfsKey:e,selectedItemType:t})=>e==="orphan"?f.jsxs("div",{className:"flex items-center gap-2 text-xs text-blue-300 bg-blue-900/40 px-2 py-1 rounded mb-1",children:[f.jsx(CB,{className:"h-4 w-4"}),f.jsxs("span",{children:[f.jsx("b",{children:"Shared VFS:"})," All chats ",f.jsx("i",{children:"not"})," in a project share this filesystem."]})]}):e&&t==="conversation"?f.jsxs("div",{className:"flex items-center gap-2 text-xs text-blue-300 bg-blue-900/40 px-2 py-1 rounded mb-1",children:[f.jsx(CB,{className:"h-4 w-4"}),f.jsxs("span",{children:[f.jsx("b",{children:"Project-shared VFS:"})," All chats in this project share this filesystem."]})]}):e&&t==="project"?f.jsxs("div",{className:"flex items-center gap-2 text-xs text-blue-300 bg-blue-900/40 px-2 py-1 rounded mb-1",children:[f.jsx(ph,{className:"h-4 w-4"}),f.jsxs("span",{children:[f.jsx("b",{children:"Project VFS:"})," Filesystem for this project and all its chats."]})]}):null,nrt=({module:e,isOpen:t,onClose:n})=>{const[r,s]=T.useState(e.getSelectedFileIdsCount()),[i,a]=T.useState(null);T.useEffect(()=>{const u=h=>{s(h.selectedFileIds.length)},d=h=>{a(h.itemType)};return Pe.on(dn.selectionChanged,u),Pe.on(Yn.selectedItemChanged,d),()=>{Pe.off(dn.selectionChanged,u),Pe.off(Yn.selectedItemChanged,d)}},[]);const o=Js.getState().vfsKey,l=()=>{const u=Js.getState().selectedFileIds,d=e.getVfsNodes();if(u.size===0){je.info("No files selected in VFS to attach.");return}let h=0;u.forEach(m=>{const y=d[m];y&&y.type==="file"&&(Pe.emit(ql.addAttachedFileRequest,{source:"vfs",name:y.name,type:y.mimeType||"application/octet-stream",size:y.size,path:y.path}),h++)}),h>0?(je.success(`Attached ${h} file(s) from VFS to the next prompt.`),e.clearVfsSelection(),n()):je.warning("No valid files were selected to attach.")},c=()=>{e.clearVfsSelection(),n()};return f.jsx(lp,{open:t,onOpenChange:u=>!u&&c(),children:f.jsxs(cp,{className:"sm:max-w-[90vw] md:max-w-[80vw] lg:max-w-[70vw] w-[90vw] h-[80vh] min-h-[500px] max-h-[90vh] flex flex-col p-0 gap-0",children:[f.jsxs(up,{className:"p-4 pb-2 border-b flex-shrink-0",children:[f.jsx(dp,{children:"Virtual Filesystem"}),f.jsx(ng,{children:"Manage files associated with the current context. Select files to attach them to your next prompt."}),f.jsx(trt,{vfsKey:o,selectedItemType:i})]}),f.jsx("div",{className:"flex-grow overflow-hidden",children:f.jsx(H5,{})}),f.jsxs(pb,{className:"p-4 pt-2 border-t flex-shrink-0",children:[f.jsx(ft,{variant:"outline",onClick:c,children:"Close"}),f.jsxs(ft,{onClick:l,disabled:r===0,children:[f.jsx(fE,{className:"h-4 w-4 mr-2"}),"Attach Selected (",r,")"]})]})]})})};class rrt{constructor(){me(this,"id","core-vfs");me(this,"modalId","core-vfs-modal-panel");me(this,"unregisterCallbacks",[]);me(this,"eventUnsubscribers",[]);me(this,"modApiRef",null);me(this,"notifyTriggerUpdate",null);me(this,"isModalOpenByManager",!1);me(this,"getEnableVfs",()=>Js.getState().enableVfs);me(this,"getIsVfsModalOpen",()=>this.isModalOpenByManager);me(this,"getSelectedFileIdsCount",()=>Js.getState().selectedFileIds.size);me(this,"toggleVfsModal",()=>{var t,n;this.isModalOpenByManager?(t=this.modApiRef)==null||t.emit(Pr.closeModalRequest,{modalId:this.modalId}):(n=this.modApiRef)==null||n.emit(Pr.openModalRequest,{modalId:this.modalId})});me(this,"clearVfsSelection",()=>{var t;(t=this.modApiRef)==null||t.emit(dn.clearSelectionRequest,void 0)});me(this,"getVfsNodes",()=>Js.getState().nodes);me(this,"setNotifyTriggerUpdate",t=>{this.notifyTriggerUpdate=t})}async initialize(t){this.modApiRef=t,this.updateVfsKeyBasedOnContext();const n=t.on(Pr.contextChanged,()=>{var s;this.updateVfsKeyBasedOnContext(),(s=this.notifyTriggerUpdate)==null||s.call(this)}),r=t.on(Pr.modalStateChanged,s=>{var i;if(s.modalId===this.modalId){const a=s.isOpen;this.isModalOpenByManager!==a&&(this.isModalOpenByManager=a,(i=this.notifyTriggerUpdate)==null||i.call(this),a&&this.updateVfsKeyBasedOnContext())}});this.eventUnsubscribers.push(n,r)}updateVfsKeyBasedOnContext(){var i;const{selectedItemId:t,selectedItemType:n}=qn.getState(),r=Js.getState().vfsKey;let s=null;if(this.isModalOpenByManager)if(n==="project")s=t;else if(n==="conversation"){const a=qn.getState().getConversationById(t);s=(a==null?void 0:a.projectId)??"orphan"}else s="orphan";else if(n==="project")s=t;else if(n==="conversation"){const a=qn.getState().getConversationById(t);s=(a==null?void 0:a.projectId)??"orphan"}else s="orphan";r!==s&&(console.log(`[${this.id}] Updating VFS key from "${r}" to "${s}"`),(i=this.modApiRef)==null||i.emit(dn.setVfsKeyRequest,{key:s}))}register(t){if(this.modApiRef=t,this.unregisterCallbacks.length>0){console.warn(`[${this.id}] Already registered. Skipping.`);return}const n=t.registerPromptControl({id:"core-vfs-prompt-trigger",triggerRenderer:()=>We.createElement(ttt,{module:this})});this.unregisterCallbacks.push(n);const r=t.registerModalProvider(this.modalId,s=>We.createElement(nrt,{module:this,...s}));this.unregisterCallbacks.push(r)}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallbacks.forEach(t=>t()),this.unregisterCallbacks=[],this.notifyTriggerUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const srt=({module:e})=>{const[,t]=T.useState({});T.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const n=e.selectedItemId,r=e.selectedItemType,s=e.syncRepos,i=e.conversationSyncStatus,a=e.isStreaming,[o,l]=T.useState(null),[c,u]=T.useState("idle"),[d,h]=T.useState(!1),[m,y]=T.useState(!1);T.useEffect(()=>{if(r==="conversation"&&n){const A=e.getConversationById(n);l((A==null?void 0:A.syncRepoId)??null),u(i[n]??"idle")}else l(null),u("idle")},[n,r,i,e]);const b=We.useMemo(()=>new Map(s.map(A=>[A.id,A.name])),[s]),v=o?b.get(o):void 0,x=T.useCallback(async A=>{if(!n||r!=="conversation")return;h(!0);const R=A==="none"?null:A;await e.linkConversationToRepo(n,R),h(!1)},[n,r,e]),w=T.useCallback(async()=>{!n||!o||(y(!0),await e.syncConversation(n),y(!1))},[n,o,e]),S=gle(c,v),C=!o||m||d||a||c==="syncing";return r==="conversation"&&s.length>0?f.jsxs(vl,{children:[f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(xl,{asChild:!0,children:f.jsx(ft,{variant:o?"secondary":"ghost",size:"icon",className:"h-8 w-8",disabled:a||d||m,"aria-label":"Configure Git Sync",children:c==="syncing"||m||d?f.jsx(Qn,{className:"h-4 w-4 animate-spin"}):f.jsx(Nc,{className:"h-4 w-4"})})})}),f.jsx(Sr,{side:"top",children:o?`Sync Status: ${c}`:"Link to Sync Repo"})]})}),f.jsxs(wl,{className:"w-64 p-4 space-y-3",align:"start",children:[f.jsx(It,{htmlFor:"sync-repo-select",className:"text-sm font-medium",children:"Link to Repository"}),f.jsxs(np,{value:o??"none",onValueChange:x,disabled:d||m||a,children:[f.jsx(sp,{id:"sync-repo-select",className:"w-full h-9",children:f.jsx(rp,{placeholder:"Select repository..."})}),f.jsxs(ip,{children:[f.jsx(To,{value:"none",children:f.jsx("span",{className:"text-muted-foreground",children:"None"})}),s.map(A=>f.jsx(To,{value:A.id,children:A.name},A.id))]})]}),f.jsxs("div",{className:"flex items-center justify-between pt-2",children:[f.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:["Status: ",S||"Not Linked"]}),f.jsxs(ft,{size:"sm",variant:"outline",onClick:w,disabled:C,className:"h-8",children:[m||c==="syncing"?f.jsx(Qn,{className:"h-4 w-4 mr-1 animate-spin"}):f.jsx(OP,{className:"h-4 w-4 mr-1"}),"Sync Now"]})]})]})]}):null},px=({title:e,description:t,children:n,className:r,titleClassName:s,descriptionClassName:i,contentClassName:a})=>f.jsxs("div",{className:Ze("space-y-2",r),children:[f.jsxs("div",{children:[f.jsx("h3",{className:Ze("text-lg font-medium",s),children:e}),t&&f.jsx("p",{className:Ze("text-sm text-muted-foreground",i),children:t})]}),f.jsx("div",{className:Ze(a),children:n})]}),irt=Ke({gitUserName:$e().min(1,"User name cannot be empty."),gitUserEmail:$e().email("Invalid email address.")});function fW({field:e}){return f.jsx(f.Fragment,{children:e.state.meta.isTouched&&e.state.meta.errors.length>0?f.jsx("em",{className:"text-xs text-destructive mt-1 block",children:e.state.meta.errors.map(t=>typeof t=="string"?t:typeof t=="object"&&t!==null&&"message"in t&&typeof t.message=="string"?t.message:(console.warn("FieldMetaMessages encountered an unexpected error object:",t),"Invalid input")).join(", ")}):null})}const art=()=>{const{gitUserName:e,setGitUserName:t,gitUserEmail:n,setGitUserEmail:r}=yr(yn(i=>({gitUserName:i.gitUserName,setGitUserName:i.setGitUserName,gitUserEmail:i.gitUserEmail,setGitUserEmail:i.setGitUserEmail}))),s=ri({defaultValues:{gitUserName:e??"",gitUserEmail:n??""},validators:{onChange:irt},onSubmit:async({value:i})=>{try{t(i.gitUserName),r(i.gitUserEmail),je.success("Git user configuration updated!")}catch(a){je.error("Failed to update Git configuration."),console.error("Error submitting Git config form:",a)}}});return T.useEffect(()=>{s.reset({gitUserName:e??"",gitUserEmail:n??""})},[e,n,s]),f.jsx("div",{className:"space-y-4 p-1",children:f.jsx(px,{title:"Git User Configuration",description:"Set your user name and email for Git commits made within the VFS. This is required for committing changes.",contentClassName:"rounded-lg border p-3 shadow-sm bg-card",children:f.jsxs("form",{onSubmit:i=>{i.preventDefault(),i.stopPropagation(),s.handleSubmit()},className:"space-y-3",children:[f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[f.jsx(s.Field,{name:"gitUserName",children:i=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(It,{htmlFor:i.name,children:"Git User Name"}),f.jsx(_n,{id:i.name,value:i.state.value,onBlur:i.handleBlur,onChange:a=>i.handleChange(a.target.value),placeholder:"Your Name",className:i.state.meta.errors.length?"border-destructive":""}),f.jsx(fW,{field:i})]})}),f.jsx(s.Field,{name:"gitUserEmail",children:i=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(It,{htmlFor:i.name,children:"Git User Email"}),f.jsx(_n,{id:i.name,type:"email",value:i.state.value,onBlur:i.handleBlur,onChange:a=>i.handleChange(a.target.value),placeholder:"your.email@example.com",className:i.state.meta.errors.length?"border-destructive":""}),f.jsx(fW,{field:i})]})})]}),f.jsx("div",{className:"flex justify-end pt-2",children:f.jsx(s.Subscribe,{selector:i=>[i.canSubmit,i.isSubmitting,i.isValidating,i.isValid],children:([i,a,o,l])=>f.jsx(ft,{type:"submit",size:"sm",disabled:!i||a||o||!l,children:a?"Saving...":o?"Validating...":"Save Git Config"})})})]})})})},ort=We.memo(art),lrt=NP("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function Nue({className:e,variant:t,...n}){return f.jsx("div",{"data-slot":"alert",role:"alert",className:Ze(lrt({variant:t}),e),...n})}function Mue({className:e,...t}){return f.jsx("div",{"data-slot":"alert-title",className:Ze("col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight",e),...t})}function Iue({className:e,...t}){return f.jsx("div",{"data-slot":"alert-description",className:Ze("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",e),...t})}var crt="Separator",hW="horizontal",urt=["horizontal","vertical"],jue=T.forwardRef((e,t)=>{const{decorative:n,orientation:r=hW,...s}=e,i=drt(r)?r:hW,o=n?{role:"none"}:{"aria-orientation":i==="vertical"?i:void 0,role:"separator"};return f.jsx(ar.div,{"data-orientation":i,...o,...s,ref:t})});jue.displayName=crt;function drt(e){return urt.includes(e)}var frt=jue;function Xd({className:e,orientation:t="horizontal",decorative:n=!0,...r}){return f.jsx(frt,{"data-slot":"separator-root",decorative:n,orientation:t,className:Ze("bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px",e),...r})}const hrt=({onSyncAll:e,onSyncPending:t,onInitializeRepos:n,onAbortSync:r,isRunning:s=!1,totalRepos:i,totalConversations:a,pendingConversations:o})=>{const[l,c]=T.useState(null),[u,d]=T.useState(!1);T.useEffect(()=>{const S=R=>{R&&R.progress&&(c(R.progress),d(!0))},C=R=>{R&&R.progress&&c(R.progress)},k=R=>{R&&R.progress&&(c(R.progress),setTimeout(()=>{c(null),d(!1)},2e3))},A=R=>{R&&R.progress&&(c(R.progress),setTimeout(()=>{c(null),d(!1)},5e3))};return Pe.on(us.bulkSyncStarted,S),Pe.on(us.bulkSyncProgress,C),Pe.on(us.bulkSyncCompleted,k),Pe.on(us.bulkSyncFailed,A),()=>{Pe.off(us.bulkSyncStarted,S),Pe.off(us.bulkSyncProgress,C),Pe.off(us.bulkSyncCompleted,k),Pe.off(us.bulkSyncFailed,A)}},[]);const h=s||u,m=l?l.completedRepos/Math.max(l.totalRepos,1)*100:0,y=l?l.completedConversations/Math.max(l.totalConversations,1)*100:0,b=async()=>{d(!0);try{await e()}catch(S){console.error("Sync all failed:",S),d(!1)}},v=async()=>{d(!0);try{await t()}catch(S){console.error("Sync pending failed:",S),d(!1)}},x=async()=>{d(!0);try{await n()}catch(S){console.error("Initialize repos failed:",S),d(!1)}},w=async()=>{try{await r()}catch(S){console.error("Abort sync failed:",S)}};return f.jsxs(cl,{className:"w-full",children:[f.jsxs(ul,{className:"pb-3",children:[f.jsxs(dl,{className:"flex items-center gap-2",children:[f.jsx(Nc,{className:"h-5 w-5"}),"Bulk Git Sync"]}),f.jsx(Bd,{children:"Manage synchronization across all repositories and conversations"})]}),f.jsxs(fl,{className:"space-y-4",children:[f.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"font-medium text-lg",children:i}),f.jsx("div",{className:"text-muted-foreground",children:"Repositories"})]}),f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"font-medium text-lg",children:a}),f.jsx("div",{className:"text-muted-foreground",children:"Total Conversations"})]}),f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:Ze("font-medium text-lg",o>0?"text-orange-600":"text-green-600"),children:o}),f.jsx("div",{className:"text-muted-foreground",children:"Pending Sync"})]})]}),f.jsx(Xd,{}),l&&f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{className:"flex items-center justify-between text-sm",children:[f.jsx("span",{className:"font-medium",children:"Current Operation"}),f.jsx(is,{variant:l.errors.length>0?"destructive":"default",children:l.errors.length>0?"Errors":"Running"})]}),f.jsx("div",{className:"text-sm text-muted-foreground bg-muted p-2 rounded",children:l.currentOperation}),l.totalRepos>0&&f.jsxs("div",{className:"space-y-2",children:[f.jsxs("div",{className:"flex justify-between text-sm",children:[f.jsx("span",{children:"Repository Progress"}),f.jsxs("span",{children:[l.completedRepos,"/",l.totalRepos]})]}),f.jsx(Ny,{value:m,className:"h-2"})]}),l.totalConversations>0&&f.jsxs("div",{className:"space-y-2",children:[f.jsxs("div",{className:"flex justify-between text-sm",children:[f.jsx("span",{children:"Conversation Progress"}),f.jsxs("span",{children:[l.completedConversations,"/",l.totalConversations]})]}),f.jsx(Ny,{value:y,className:"h-2"})]}),l.errors.length>0&&f.jsxs("div",{className:"mt-2",children:[f.jsxs("div",{className:"flex items-center gap-2 text-sm text-destructive mb-2",children:[f.jsx(Rc,{className:"h-4 w-4"}),l.errors.length," Error",l.errors.length!==1?"s":""]}),f.jsxs("div",{className:"max-h-24 overflow-y-auto space-y-1",children:[l.errors.slice(0,5).map((S,C)=>f.jsxs("div",{className:"text-xs text-muted-foreground bg-destructive/10 p-2 rounded",children:[f.jsxs("span",{className:"font-medium",children:[S.type,":"]})," ",S.error]},C)),l.errors.length>5&&f.jsxs("div",{className:"text-xs text-muted-foreground",children:["...and ",l.errors.length-5," more errors"]})]})]})]}),f.jsx(Xd,{}),f.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[f.jsx(xr,{children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsxs(ft,{onClick:x,disabled:h||i===0,variant:"outline",size:"sm",className:"w-full",children:[f.jsx(xu,{className:"h-4 w-4 mr-1"}),"Clone Repos"]})}),f.jsx(Sr,{children:"Initialize/clone all configured repositories"})]})}),f.jsx(xr,{children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsxs(ft,{onClick:v,disabled:h||o===0,variant:"outline",size:"sm",className:"w-full",children:[f.jsx(yH,{className:"h-4 w-4 mr-1"}),"Sync Pending"]})}),f.jsx(Sr,{children:"Sync only conversations that need syncing"})]})}),f.jsx(xr,{children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsxs(ft,{onClick:b,disabled:h||i===0&&a===0,size:"sm",className:"w-full",children:[f.jsx(gm,{className:Ze("h-4 w-4 mr-1",h&&"animate-spin")}),"Sync All"]})}),f.jsx(Sr,{children:"Sync all repositories and conversations"})]})}),f.jsxs(ft,{onClick:w,disabled:!h,variant:"destructive",size:"sm",className:"w-full",children:[f.jsx(Ipe,{className:"h-4 w-4 mr-1"}),"Stop"]})]})]})]})},prt=Ke({name:$e().min(1,"Repository Name is required."),remoteUrl:$e().min(1,"Remote URL is required.").url("Invalid URL format (e.g., https://github.com/user/repo.git)"),branch:$e().min(1,"Branch name is required (e.g., main)."),username:$e().nullable().optional(),password:$e().nullable().optional()}),b2={name:"",remoteUrl:"",branch:"main",username:null,password:null},mrt=()=>{const{syncRepos:e,addSyncRepo:t,updateSyncRepo:n,repoInitializationStatus:r,isLoading:s}=qn(yn(C=>({syncRepos:C.syncRepos,addSyncRepo:C.addSyncRepo,updateSyncRepo:C.updateSyncRepo,repoInitializationStatus:C.repoInitializationStatus,isLoading:C.isLoading}))),{autoSyncOnStreamComplete:i,setAutoSyncOnStreamComplete:a}=yr(yn(C=>({autoSyncOnStreamComplete:C.autoSyncOnStreamComplete,setAutoSyncOnStreamComplete:C.setAutoSyncOnStreamComplete}))),[o,l]=T.useState(!1),[c,u]=T.useState(null),[d,h]=T.useState({});T.useEffect(()=>{const C=k=>{k&&k.action==="deleted"&&k.repoId&&h(A=>({...A,[k.repoId]:!1}))};return Pe.on(us.repoChanged,C),()=>Pe.off(us.repoChanged,C)},[]);const m=ri({defaultValues:b2,validators:{onChangeAsync:prt,onChangeAsyncDebounceMs:500},onSubmit:async({value:C})=>{var k,A,R,N;if(!((k=C.name)!=null&&k.trim())||!((A=C.remoteUrl)!=null&&A.trim())){je.error("Repository Name and Remote URL are required.");return}try{const I={name:C.name.trim(),remoteUrl:C.remoteUrl.trim(),branch:((R=C.branch)==null?void 0:R.trim())||"main",username:((N=C.username)==null?void 0:N.trim())||null,password:C.password||null};c?await n(c,I):await t(I),y()}catch(I){console.error("Failed to save sync repo:",I)}}}),y=T.useCallback(()=>{m.reset(b2),l(!1),u(null)},[m]);T.useEffect(()=>{if(c){const C=e.find(k=>k.id===c);C?(m.reset({name:C.name,remoteUrl:C.remoteUrl,branch:C.branch||"main",username:C.username??null,password:C.password??null}),l(!1)):y()}else o||m.reset(b2)},[c,e,m,o,y]);const b=C=>{u(C.id),l(!1)},v=T.useCallback((C,k)=>{if(window.confirm(`Are you sure you want to delete the sync repository "${k}"? This will unlink it from any conversations and remove the local copy.`)){h(A=>({...A,[C]:!0}));try{Pe.emit(Yn.deleteSyncRepoRequest,{id:C}),c===C&&y()}catch(A){console.error("Failed to delete sync repo:",A),h(R=>({...R,[C]:!1}))}}},[c,y]),x=T.useCallback(C=>{Pe.emit(Yn.initializeOrSyncRepoRequest,{repoId:C})},[]),w=()=>{u(null),m.reset(b2),l(!0)},S=()=>f.jsxs("form",{onSubmit:C=>{C.preventDefault(),C.stopPropagation(),m.handleSubmit()},className:"border rounded-md p-4 space-y-3 bg-card shadow-md mb-4",children:[f.jsx("h4",{className:"font-semibold text-card-foreground",children:c?"Edit Sync Repository":"Add New Sync Repository"}),f.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[f.jsx(m.Field,{name:"name",children:C=>f.jsxs("div",{className:"sm:col-span-1 space-y-1.5",children:[f.jsx(It,{htmlFor:C.name,children:"Name"}),f.jsx(_n,{id:C.name,value:C.state.value??"",onChange:k=>C.handleChange(k.target.value),onBlur:C.handleBlur,placeholder:"e.g., My Backup",disabled:m.state.isSubmitting}),f.jsx(Ni,{field:C})]})}),f.jsx(m.Field,{name:"remoteUrl",children:C=>f.jsxs("div",{className:"sm:col-span-2 space-y-1.5",children:[f.jsx(It,{htmlFor:C.name,children:"Remote URL (HTTPS)"}),f.jsx(_n,{id:C.name,type:"url",value:C.state.value??"",onChange:k=>C.handleChange(k.target.value),onBlur:C.handleBlur,placeholder:"https://github.com/user/repo.git",disabled:m.state.isSubmitting}),f.jsx(Ni,{field:C})]})}),f.jsx(m.Field,{name:"branch",children:C=>f.jsxs("div",{className:"sm:col-span-1 space-y-1.5",children:[f.jsx(It,{htmlFor:C.name,children:"Branch"}),f.jsx(_n,{id:C.name,value:C.state.value??"",onChange:k=>C.handleChange(k.target.value),onBlur:C.handleBlur,placeholder:"main",disabled:m.state.isSubmitting}),f.jsx(Ni,{field:C})]})})]}),f.jsxs("div",{className:"pt-2",children:[f.jsx(It,{className:"text-sm font-medium",children:"Authentication (Optional - Basic Auth/Token)"}),f.jsxs(Nue,{variant:"destructive",className:"mt-2 mb-3",children:[f.jsx(LP,{className:"h-4 w-4"}),f.jsx(Mue,{children:"Security Warning"}),f.jsx(Iue,{className:"text-xs",children:"Storing credentials directly is insecure. Use a Personal Access Token (PAT) as the password if possible. Credentials are required only for private repositories."})]}),f.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[f.jsx(m.Field,{name:"username",children:C=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(It,{htmlFor:C.name,children:"Username"}),f.jsx(_n,{id:C.name,value:C.state.value??"",onChange:k=>C.handleChange(k.target.value),onBlur:C.handleBlur,placeholder:"Git Username (Optional)",disabled:m.state.isSubmitting,autoComplete:"off"}),f.jsx(Ni,{field:C})]})}),f.jsx(m.Field,{name:"password",children:C=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(It,{htmlFor:C.name,children:"Password / Token"}),f.jsx(_n,{id:C.name,type:"password",value:C.state.value??"",onChange:k=>C.handleChange(k.target.value),onBlur:C.handleBlur,placeholder:"Password or PAT (Optional)",disabled:m.state.isSubmitting,autoComplete:"new-password"}),f.jsx(Ni,{field:C})]})})]})]}),f.jsxs("div",{className:"flex justify-end space-x-2 pt-2",children:[f.jsxs(ft,{variant:"ghost",size:"sm",onClick:y,disabled:m.state.isSubmitting,type:"button",children:[f.jsx(qi,{className:"h-4 w-4 mr-1"})," Cancel"]}),f.jsx(m.Subscribe,{selector:C=>[C.canSubmit,C.isSubmitting,C.isValidating,C.isValid],children:([C,k,A,R])=>f.jsxs(ft,{variant:"secondary",size:"sm",type:"submit",disabled:k||!C||!R||A,children:[(k||A)&&f.jsx(Qn,{className:"h-4 w-4 mr-1 animate-spin"}),f.jsx(Qd,{className:"h-4 w-4 mr-1"})," ",k||A?"Saving...":"Save Repository"]})})]})]});return f.jsxs("div",{className:"space-y-6 p-1",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"text-lg font-medium",children:"Sync Repositories"}),f.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Configure remote Git repositories to synchronize conversations. Link conversations to a repo using the sync control in the chat input area. Use the 'Sync/Clone' button to initialize the local copy or pull updates."}),f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg bg-card",children:[f.jsxs("div",{className:"space-y-1",children:[f.jsx(It,{htmlFor:"auto-sync-toggle",className:"text-sm font-medium",children:"Auto-sync after stream completion"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Automatically sync conversations with linked repositories when a message stream completes"})]}),f.jsx(Io,{id:"auto-sync-toggle",checked:i,onCheckedChange:a})]}),f.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg bg-card",children:[f.jsxs("div",{className:"space-y-1",children:[f.jsx(It,{htmlFor:"auto-init-repos-toggle",className:"text-sm font-medium",children:"Auto-initialize repositories on startup"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Automatically clone/initialize configured repositories when the app starts (off by default)"})]}),f.jsx(Io,{id:"auto-init-repos-toggle",checked:yr(C=>C.autoInitializeReposOnStartup),onCheckedChange:yr.getState().setAutoInitializeReposOnStartup})]})]}),e.length>0&&f.jsx(hrt,{onSyncAll:async()=>{await qn.getState().syncAllConversations()},onSyncPending:async()=>{await qn.getState().syncPendingConversations()},onInitializeRepos:async()=>{await qn.getState().initializeAllRepositories()},onAbortSync:async()=>{const{BulkSyncService:C}=await Zr(async()=>{const{BulkSyncService:k}=await Promise.resolve().then(()=>F0);return{BulkSyncService:k}},void 0);C.abort()},totalRepos:e.length,totalConversations:qn.getState().conversations.filter(C=>C.syncRepoId).length,pendingConversations:qn.getState().conversations.filter(C=>{const k=qn.getState().conversationSyncStatus[C.id];return C.syncRepoId&&k==="needs-sync"}).length})]}),!o&&!c&&f.jsxs(ft,{onClick:w,variant:"outline",className:"w-full mb-4",disabled:s,children:[f.jsx(Ru,{className:"h-4 w-4 mr-1"})," Add Sync Repository"]}),(o||c)&&S(),f.jsxs("div",{children:[f.jsx("h4",{className:"text-md font-medium mb-2",children:"Configured Repositories"}),s&&!o&&!c?f.jsxs("div",{className:"space-y-2",children:[f.jsx(Wr,{className:"h-10 w-full"}),f.jsx(Wr,{className:"h-10 w-full"}),f.jsx(Wr,{className:"h-10 w-full"})]}):e.length===0&&!o&&!c?f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No sync repositories configured yet."}):f.jsx("div",{className:"border rounded-md overflow-x-auto",children:f.jsxs(lf,{children:[f.jsx(fp,{children:f.jsxs(Es,{children:[f.jsx(Tr,{children:"Name"}),f.jsx(Tr,{className:"hidden md:table-cell",children:"Remote URL"}),f.jsx(Tr,{className:"hidden lg:table-cell",children:"Branch"}),f.jsx(Tr,{className:"hidden lg:table-cell",children:"Auth"}),f.jsx(Tr,{className:"text-right",children:"Actions"})]})}),f.jsx(cf,{children:e.map(C=>{const k=d[C.id],A=c===C.id,R=!!C.username||!!C.password,N=r[C.id]||"idle",I=N==="syncing",P=k||m.state.isSubmitting||!!c||I;let L=null,O="Initialize/Sync Repository";return N==="syncing"?(L=f.jsx(Qn,{className:"h-4 w-4 animate-spin mr-1"}),O="Initializing/Syncing..."):N==="idle"?(L=f.jsx(uE,{className:"h-4 w-4 text-green-500 mr-1"}),O="Sync Successful / Ready"):N==="error"?(L=f.jsx(Rc,{className:"h-4 w-4 text-destructive mr-1"}),O="Sync Failed"):L=f.jsx(gm,{className:"h-4 w-4 mr-1"}),f.jsxs(Es,{className:Ze(A?"bg-muted/50":"",P&&!A?"opacity-70":""),children:[f.jsx(On,{className:"font-medium truncate max-w-[100px] sm:max-w-xs",children:C.name}),f.jsx(On,{className:"text-xs truncate max-w-[100px] sm:max-w-xs hidden md:table-cell",children:C.remoteUrl}),f.jsx(On,{className:"hidden lg:table-cell",children:C.branch||"main"}),f.jsx(On,{className:"text-xs hidden lg:table-cell",children:R?"Configured":"None"}),f.jsxs(On,{className:"text-right space-x-1",children:[f.jsx(Dn,{tooltipText:O,onClick:()=>x(C.id),"aria-label":`Initialize or Sync repo ${C.name}`,disabled:P,icon:L,variant:"outline",className:"h-8 w-8"}),f.jsx(Dn,{tooltipText:"Edit",onClick:()=>b(C),"aria-label":`Edit repo ${C.name}`,disabled:P,icon:f.jsx(o1,{}),className:"h-8 w-8"}),f.jsx(Dn,{tooltipText:"Delete",onClick:()=>v(C.id,C.name),"aria-label":`Delete repo ${C.name}`,disabled:P,icon:k?f.jsx(Qn,{className:"h-4 w-4 animate-spin"}):f.jsx(Ao,{}),className:"text-destructive hover:text-destructive/80 h-8 w-8"})]})]},C.id)})})]})})]})]})},grt=We.memo(mrt),yrt=()=>{const e=T.useMemo(()=>[{value:"config",label:"User Config",content:f.jsx(ort,{})},{value:"sync",label:"Sync Repositories",content:f.jsx(grt,{})}],[]);return f.jsx(sc,{tabs:e,defaultValue:"config",className:"h-full",listClassName:"bg-muted/50 rounded-md",contentContainerClassName:"mt-4"})},brt=We.memo(yrt);class vrt{constructor(){me(this,"id","core-git-sync");me(this,"unregisterPromptControlCallback",null);me(this,"unregisterSettingsTabCallback",null);me(this,"eventUnsubscribers",[]);me(this,"modApiRef",null);me(this,"selectedItemId",null);me(this,"selectedItemType",null);me(this,"syncRepos",[]);me(this,"conversationSyncStatus",{});me(this,"isStreaming",!1);me(this,"autoSyncEnabled",!1);me(this,"isBulkSyncing",!1);me(this,"bulkSyncProgress",null);me(this,"notifyComponentUpdate",null);me(this,"linkConversationToRepo",(t,n)=>{var r;(r=this.modApiRef)==null||r.emit(Yn.linkConversationToRepoRequest,{conversationId:t,repoId:n})});me(this,"syncConversation",t=>{var n;(n=this.modApiRef)==null||n.emit(Yn.syncConversationRequest,{conversationId:t})});me(this,"getConversationById",t=>qn.getState().getConversationById(t));me(this,"syncAllConversations",async()=>{await qn.getState().syncAllConversations()});me(this,"syncPendingConversations",async()=>{await qn.getState().syncPendingConversations()});me(this,"initializeAllRepositories",async()=>{await qn.getState().initializeAllRepositories()});me(this,"abortBulkSync",async()=>{const{BulkSyncService:t}=await Zr(async()=>{const{BulkSyncService:n}=await Promise.resolve().then(()=>F0);return{BulkSyncService:n}},void 0);t.abort()});me(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){this.modApiRef=t,this.loadInitialState();const n=t.on(Pr.contextChanged,m=>{var y;this.selectedItemId=m.selectedItemId,this.selectedItemType=m.selectedItemType,(y=this.notifyComponentUpdate)==null||y.call(this)}),r=t.on(us.repoChanged,()=>{var m;this.syncRepos=qn.getState().syncRepos,(m=this.notifyComponentUpdate)==null||m.call(this)}),s=t.on(Yn.conversationSyncStatusChanged,m=>{var y;typeof m=="object"&&m&&"conversationId"in m&&"status"in m&&(this.conversationSyncStatus={...this.conversationSyncStatus,[m.conversationId]:m.status},(y=this.notifyComponentUpdate)==null||y.call(this))}),i=t.on(Zn.statusChanged,m=>{var y;typeof m=="object"&&m&&"status"in m&&(this.isStreaming=m.status==="streaming",(y=this.notifyComponentUpdate)==null||y.call(this))}),a=t.on(Zn.completed,async m=>{typeof m=="object"&&m&&"interactionId"in m&&"status"in m&&m.status==="COMPLETED"&&this.autoSyncEnabled&&await this.handleAutoSync()}),o=t.on(sn.autoSyncOnStreamCompleteChanged,m=>{var y;typeof m=="object"&&m&&"enabled"in m&&(this.autoSyncEnabled=m.enabled,(y=this.notifyComponentUpdate)==null||y.call(this))}),l=t.on(us.bulkSyncStarted,m=>{var y;typeof m=="object"&&m&&"progress"in m&&(this.isBulkSyncing=!0,this.bulkSyncProgress=m.progress,(y=this.notifyComponentUpdate)==null||y.call(this))}),c=t.on(us.bulkSyncProgress,m=>{var y;typeof m=="object"&&m&&"progress"in m&&(this.bulkSyncProgress=m.progress,(y=this.notifyComponentUpdate)==null||y.call(this))}),u=t.on(us.bulkSyncCompleted,m=>{var y;typeof m=="object"&&m&&"progress"in m&&(this.isBulkSyncing=!1,this.bulkSyncProgress=null,(y=this.notifyComponentUpdate)==null||y.call(this))}),d=t.on(us.bulkSyncFailed,m=>{var y;typeof m=="object"&&m&&"progress"in m&&(this.isBulkSyncing=!1,this.bulkSyncProgress=null,(y=this.notifyComponentUpdate)==null||y.call(this))}),h=t.on(Yn.conversationUpdated,m=>{var y;typeof m=="object"&&m&&"conversationId"in m&&"updates"in m&&m.conversationId===this.selectedItemId&&m.updates.syncRepoId!==void 0&&(this.loadInitialState(),(y=this.notifyComponentUpdate)==null||y.call(this))});this.eventUnsubscribers.push(n,r,s,i,a,o,l,c,u,d,h)}loadInitialState(){const t=qn.getState();this.selectedItemId=t.selectedItemId,this.selectedItemType=t.selectedItemType,this.syncRepos=t.syncRepos,this.conversationSyncStatus=t.conversationSyncStatus,this.isStreaming=$n.getState().status==="streaming",this.autoSyncEnabled=yr.getState().autoSyncOnStreamComplete}async handleAutoSync(){if(!this.selectedItemId||this.selectedItemType!=="conversation")return;const t=this.getConversationById(this.selectedItemId);if(!(t!=null&&t.syncRepoId))return;const n=this.conversationSyncStatus[this.selectedItemId];if(!(n==="syncing"||n==="idle")){console.log(`[GitSyncControlModule] Auto-syncing conversation ${this.selectedItemId}`);try{await this.syncConversation(this.selectedItemId)}catch(r){console.error("[GitSyncControlModule] Auto-sync failed:",r)}}}register(t){this.modApiRef=t,this.unregisterPromptControlCallback||(this.unregisterPromptControlCallback=t.registerPromptControl({id:this.id,triggerRenderer:()=>We.createElement(srt,{module:this})})),this.unregisterSettingsTabCallback||(this.unregisterSettingsTabCallback=t.registerSettingsTab({id:"git",title:"Git",component:brt,order:60}))}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterPromptControlCallback&&(this.unregisterPromptControlCallback(),this.unregisterPromptControlCallback=null),this.unregisterSettingsTabCallback&&(this.unregisterSettingsTabCallback(),this.unregisterSettingsTabCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const xrt=({module:e})=>{const[,t]=T.useState({});T.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const{syncRepos:n,repoInitializationStatus:r}=qn(yn(c=>({syncRepos:c.syncRepos,repoInitializationStatus:c.repoInitializationStatus}))),s=()=>{e.syncAllRepos()},i=c=>{e.syncRepo(c)},a=e.isSyncing,o=n.length>0,l=Object.values(r).some(c=>c==="syncing");return f.jsx(xr,{delayDuration:100,children:f.jsxs(vl,{children:[f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(xl,{asChild:!0,children:f.jsx(ft,{variant:"ghost",size:"icon",className:"h-8 w-8",disabled:!o,"aria-label":"Manual Git Sync",children:a||l?f.jsx(Qn,{className:"h-4 w-4 animate-spin"}):f.jsx(Nc,{className:"h-4 w-4"})})})}),f.jsx(Sr,{side:"top",children:o?"Manual Git Sync":"No sync repositories configured"})]}),f.jsx(wl,{className:"w-80 p-4",align:"start",children:f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("h4",{className:"font-semibold text-sm",children:"Git Sync Repositories"}),f.jsxs(ft,{variant:"outline",size:"sm",onClick:s,disabled:!o||a||l,className:"h-8",children:[a||l?f.jsx(Qn,{className:"h-3 w-3 mr-1 animate-spin"}):f.jsx(gm,{className:"h-3 w-3 mr-1"}),"Sync All"]})]}),o?f.jsx("div",{className:"space-y-2",children:n.map(c=>{const u=r[c.id]||"idle",d=u==="syncing";return f.jsxs("div",{className:Ze("flex items-center justify-between p-3 border rounded-lg","bg-card hover:bg-muted/50 transition-colors"),children:[f.jsxs("div",{className:"min-w-0 flex-1",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("span",{className:"text-sm font-medium truncate",children:c.name}),f.jsx(is,{variant:u==="idle"?"secondary":u==="syncing"?"default":u==="error"?"destructive":"outline",className:"text-xs",children:u==="idle"?"Ready":u==="syncing"?"Syncing":u==="error"?"Error":"Unknown"})]}),f.jsx("p",{className:"text-xs text-muted-foreground truncate",children:c.branch||"main"})]}),f.jsx(ft,{variant:"ghost",size:"sm",onClick:()=>i(c.id),disabled:d||a,className:"h-8 w-8 p-0",children:d?f.jsx(Qn,{className:"h-3 w-3 animate-spin"}):f.jsx(gm,{className:"h-3 w-3"})})]},c.id)})}):f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No sync repositories configured. Go to Settings → Git → Sync Repositories to add one."})]})})]})})};class wrt{constructor(){me(this,"id","core-manual-git-sync-sidebar");me(this,"unregisterCallback",null);me(this,"eventUnsubscribers",[]);me(this,"modApiRef",null);me(this,"syncRepos",[]);me(this,"repoInitializationStatus",{});me(this,"isSyncing",!1);me(this,"notifyComponentUpdate",null);me(this,"syncAllRepos",async()=>{var t,n;if(!(this.isSyncing||this.syncRepos.length===0)){this.isSyncing=!0,(t=this.notifyComponentUpdate)==null||t.call(this);try{console.log("[ManualSyncSidebarControlModule] Starting bulk sync for all repositories and conversations");const{BulkSyncService:r}=await Zr(async()=>{const{BulkSyncService:s}=await Promise.resolve().then(()=>F0);return{BulkSyncService:s}},void 0);await r.syncAll({syncRepos:!0,syncConversations:!0,continueOnError:!0,maxConcurrent:3}),console.log("[ManualSyncSidebarControlModule] Completed bulk sync")}catch(r){console.error("[ManualSyncSidebarControlModule] Error in bulk sync:",r)}finally{this.isSyncing=!1,(n=this.notifyComponentUpdate)==null||n.call(this)}}});me(this,"syncRepo",async t=>{var r;const n=this.syncRepos.find(s=>s.id===t);if(!n){console.warn(`[ManualSyncSidebarControlModule] Repository ${t} not found`);return}console.log(`[ManualSyncSidebarControlModule] Starting sync for repository: ${n.name}`),(r=this.modApiRef)==null||r.emit(Yn.initializeOrSyncRepoRequest,{repoId:t})});me(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){this.modApiRef=t,this.loadInitialState();const n=t.on(us.repoChanged,()=>{var i;this.syncRepos=qn.getState().syncRepos,(i=this.notifyComponentUpdate)==null||i.call(this)}),r=t.on(us.repoInitStatusChanged,i=>{var a;typeof i=="object"&&i&&"repoId"in i&&"status"in i&&(this.repoInitializationStatus={...this.repoInitializationStatus,[i.repoId]:i.status},(a=this.notifyComponentUpdate)==null||a.call(this))}),s=t.on(Yn.syncReposLoaded,()=>{var i;this.loadInitialState(),(i=this.notifyComponentUpdate)==null||i.call(this)});this.eventUnsubscribers.push(n,r,s)}loadInitialState(){const t=qn.getState();this.syncRepos=t.syncRepos,this.repoInitializationStatus=t.repoInitializationStatus}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}const n=()=>We.createElement(xrt,{module:this});this.unregisterCallback=t.registerChatControl({id:this.id,panel:"sidebar-footer",status:()=>"ready",renderer:n,iconRenderer:n,show:()=>!0})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const _rt=Ke({path:$e().optional().describe("The directory path to list within the VFS. Defaults to the current directory if omitted.")}),Srt=Ke({path:$e().describe("The path of the file to read within the VFS."),encoding:bl(["utf-8","base64"]).optional().default("utf-8").describe("Encoding for reading the file (utf-8 or base64).")}),Crt=Ke({path:$e().describe("The path where the file should be written."),content:$e().describe("The content to write to the file."),encoding:bl(["utf-8","base64"]).optional().default("utf-8").describe("Encoding of the provided content (utf-8 or base64).")}),krt=Ke({path:$e().describe("The path of the file or directory to delete."),recursive:br().optional().default(!1).describe("Whether to delete directories recursively.")}),Ert=Ke({path:$e().describe("The path of the directory to create (including parents).")}),Trt=Ke({oldPath:$e().describe("The current path of the item to rename."),newName:$e().describe("The new name for the item.")});class Art{constructor(){me(this,"id","core-vfs-tools");me(this,"unregisterCallbacks",[])}async initialize(t){console.log(`[${this.id}] Initialized.`)}register(t){if(this.unregisterCallbacks.length>0){console.warn(`[${this.id}] Already registered. Skipping.`);return}console.log(`[${this.id}] Registering Core VFS Tools...`);const n={description:"List files and directories in a specified VFS path, or the current path if none is given.",parameters:_rt};this.unregisterCallbacks.push(t.registerTool("vfsListFiles",n,async({path:l},c)=>{const u=c==null?void 0:c.fsInstance;if(!u)return{success:!1,error:"Filesystem instance not available in context."};const d=zr(l||"/");try{const h=await dD(d,{fsInstance:u});return{success:!0,path:d,entries:h.map(m=>({name:m.name,type:m.isDirectory?"folder":"file",size:m.size,lastModified:m.lastModified.toISOString()}))}}catch(h){return{success:!1,path:d,error:h.message}}}));const r={description:"Read the content of a file from the VFS.",parameters:Srt};this.unregisterCallbacks.push(t.registerTool("vfsReadFile",r,async({path:l,encoding:c},u)=>{const d=u==null?void 0:u.fsInstance;if(!d)return{success:!1,error:"Filesystem instance not available in context."};const h=zr(l);try{const m=await Yh(h,{fsInstance:d});let y;return c==="base64"?y=btoa(String.fromCharCode(...m)):y=new TextDecoder().decode(m),{success:!0,path:h,content:y,encoding:c}}catch(m){return{success:!1,path:h,error:m.message}}}));const s={description:"Write content to a file in the VFS.",parameters:Crt};this.unregisterCallbacks.push(t.registerTool("vfsWriteFile",s,async({path:l,content:c,encoding:u},d)=>{const h=d==null?void 0:d.fsInstance;if(!h)return{success:!1,error:"Filesystem instance not available in context."};const m=zr(l);try{let y;if(u==="base64"){const b=atob(c),v=b.length,x=new Uint8Array(v);for(let w=0;w<v;w++)x[w]=b.charCodeAt(w);y=x}else y=c;return await rT(m,y,{fsInstance:h}),{success:!0,path:m}}catch(y){return{success:!1,path:m,error:y.message}}}));const i={description:"Delete a file or directory from the VFS.",parameters:krt};this.unregisterCallbacks.push(t.registerTool("vfsDelete",i,async({path:l,recursive:c},u)=>{const d=u==null?void 0:u.fsInstance;if(!d)return{success:!1,error:"Filesystem instance not available in context."};const h=zr(l);try{return await fD(h,c,{fsInstance:d}),{success:!0,path:h}}catch(m){return{success:!1,path:h,error:m.message}}}));const a={description:"Create a directory (including parents) in the VFS.",parameters:Ert};this.unregisterCallbacks.push(t.registerTool("vfsCreateDirectory",a,async({path:l},c)=>{const u=c==null?void 0:c.fsInstance;if(!u)return{success:!1,error:"Filesystem instance not available in context."};const d=zr(l);try{return await yZ(d,{fsInstance:u}),{success:!0,path:d}}catch(h){return{success:!1,path:d,error:h.message}}}));const o={description:"Rename a file or directory in the VFS.",parameters:Trt};this.unregisterCallbacks.push(t.registerTool("vfsRename",o,async({oldPath:l,newName:c},u)=>{const d=u==null?void 0:u.fsInstance;if(!d)return{success:!1,error:"Filesystem instance not available in context."};const h=zr(l),m=zr(h.substring(0,h.lastIndexOf("/"))||"/"),y=Pu(m,c);try{return await vZ(h,y,{fsInstance:d}),{success:!0,oldPath:h,newPath:y}}catch(b){return{success:!1,oldPath:h,newName:c,error:b.message}}})),console.log(`[${this.id}] Core VFS Tools Registered.`)}destroy(){this.unregisterCallbacks.forEach(t=>t()),this.unregisterCallbacks=[],console.log(`[${this.id}] Destroyed.`)}}const Rrt=Ke({path:$e().describe("The directory path within the VFS to initialize as a Git repository.")}),Nrt=Ke({path:$e().describe("The directory path of the Git repository within the VFS to commit."),message:$e().describe("The commit message.")}),Mrt=Ke({path:$e().describe("The directory path of the Git repository within the VFS to pull from."),branch:$e().optional().describe("The branch name to pull.")}),Irt=Ke({path:$e().describe("The directory path of the Git repository within the VFS to push."),branch:$e().optional().describe("The branch name to push.")}),jrt=Ke({path:$e().describe("The directory path of the Git repository within the VFS to check status.")});class Prt{constructor(){me(this,"id","core-git-tools");me(this,"unregisterCallbacks",[])}async initialize(t){}register(t){if(this.unregisterCallbacks.length>0){console.warn(`[${this.id}] Already registered. Skipping.`);return}const n={description:"Initialize an empty Git repository in a VFS directory.",parameters:Rrt};this.unregisterCallbacks.push(t.registerTool("gitInit",n,async({path:o},l)=>{const c=l==null?void 0:l.fsInstance;if(!c)return{success:!1,error:"Filesystem instance not available in context."};try{return await mZ(o,{fsInstance:c}),{success:!0,message:`Repository initialized at ${o}`}}catch(u){return{success:!1,error:u.message}}}));const r={description:"Stage all changes and commit them in a VFS Git repository.",parameters:Nrt};this.unregisterCallbacks.push(t.registerTool("gitCommit",r,async({path:o,message:l},c)=>{const u=c==null?void 0:c.fsInstance;if(!u)return{success:!1,error:"Filesystem instance not available in context."};const d=yr.getState();if(!d.gitUserName||!d.gitUserEmail)return{success:!1,error:"Git user name and email not configured in settings. Cannot commit."};try{return await cD(o,l,{fsInstance:u}),{success:!0,message:`Changes committed in ${o}`}}catch(h){return{success:!1,error:h.message}}}));const s={description:"Pull changes from the remote repository for the specified branch.",parameters:Mrt};this.unregisterCallbacks.push(t.registerTool("gitPull",s,async({path:o,branch:l},c)=>{const u=c==null?void 0:c.fsInstance;if(!u)return{success:!1,error:"Filesystem instance not available in context."};try{return await nT(o,l||"main",void 0,{fsInstance:u}),{success:!0,message:`Pulled changes for ${o}`}}catch(d){return{success:!1,error:d.message}}}));const i={description:"Push committed changes from the local branch to the remote repository.",parameters:Irt};this.unregisterCallbacks.push(t.registerTool("gitPush",i,async({path:o,branch:l},c)=>{const u=c==null?void 0:c.fsInstance;if(!u)return{success:!1,error:"Filesystem instance not available in context."};try{return await uD(o,l||"main",void 0,{fsInstance:u}),{success:!0,message:`Pushed changes for ${o}`}}catch(d){return{success:!1,error:d.message}}}));const a={description:"Get the Git status for a VFS repository.",parameters:jrt};this.unregisterCallbacks.push(t.registerTool("gitStatus",a,async({path:o},l)=>{const c=l==null?void 0:l.fsInstance;if(!c)return{success:!1,error:"Filesystem instance not available in context."};try{return await gZ(o,{fsInstance:c}),{success:!0,message:`Status checked for ${o}`}}catch(u){return{success:!1,error:u.message}}}))}destroy(){this.unregisterCallbacks.forEach(t=>t()),this.unregisterCallbacks=[],console.log(`[${this.id}] Destroyed.`)}}class Ort{constructor(){me(this,"id","core-mcp-tools");me(this,"unregisterCallbacks",[]);me(this,"mcpToolUnregisterCallbacks",[]);me(this,"mcpClients",new Map);me(this,"modApi");me(this,"connectionAttempts",new Map);me(this,"retryTimeouts",new Map)}async initialize(t){this.modApi=t,globalThis.mcpToolsModuleInstance=this,Pe.emit(kr.loadMcpStateRequest,void 0),this.setupEventListeners(),await this.initializeMcpClients()}register(t){}destroy(){this.retryTimeouts.forEach(t=>{clearTimeout(t)}),this.retryTimeouts.clear(),this.connectionAttempts.clear(),this.mcpClients.forEach(t=>{try{t.client&&typeof t.client.disconnect=="function"&&t.client.disconnect()}catch(n){console.error(`[${this.id}] Error disconnecting MCP client ${t.id}:`,n)}}),this.mcpClients.clear(),this.unregisterCallbacks.forEach(t=>t()),this.unregisterCallbacks=[],this.mcpToolUnregisterCallbacks.forEach(t=>t()),this.mcpToolUnregisterCallbacks=[]}setupEventListeners(){const t=n=>{this.initializeMcpClients().catch(r=>{console.error(`[${this.id}] Error reinitializing MCP clients:`,r)})};Pe.on(kr.serversChanged,t),this.unregisterCallbacks.push(()=>{Pe.off(kr.serversChanged,t)})}getRetryConfig(){const t=rl.getState();return{maxAttempts:t.retryAttempts,baseDelay:t.retryDelay,timeout:t.connectionTimeout}}async initializeMcpClients(){try{const n=rl.getState().servers.filter(r=>r.enabled);this.connectionAttempts.clear(),this.retryTimeouts.forEach(r=>{clearTimeout(r)}),this.retryTimeouts.clear(),this.mcpClients.forEach(r=>{try{r.client&&typeof r.client.disconnect=="function"&&r.client.disconnect()}catch(s){console.error(`[${this.id}] Error disconnecting existing MCP client ${r.id}:`,s)}}),this.mcpClients.clear(),this.mcpToolUnregisterCallbacks.forEach(r=>r()),this.mcpToolUnregisterCallbacks=[];for(const r of n)this.connectToMcpServerWithRetry(r)}catch(t){console.error(`[${this.id}] Error initializing MCP clients:`,t),je.error("Failed to initialize MCP clients",{description:t instanceof Error?t.message:"Unknown error occurred"})}}async connectToMcpServerWithRetry(t){const n=this.getRetryConfig(),r=this.connectionAttempts.get(t.id)||0;try{await this.connectToMcpServer(t),this.connectionAttempts.delete(t.id);const s=this.retryTimeouts.get(t.id);s&&(clearTimeout(s),this.retryTimeouts.delete(t.id)),je.success(`Connected to MCP server: ${t.name}`,{description:"Successfully connected and loaded tools"})}catch(s){if(console.error(`[${this.id}] Failed to connect to MCP server ${t.name} (attempt ${r+1}):`,s),rl.getState().setServerStatus({serverId:t.id,connected:!1,error:s instanceof Error?s.message:"Connection failed",lastConnected:void 0,toolCount:0,tools:[]}),r<n.maxAttempts){this.connectionAttempts.set(t.id,r+1);const a=r+1,o=n.baseDelay*Math.pow(1.5,r),l=setTimeout(()=>{this.retryTimeouts.delete(t.id),this.connectToMcpServerWithRetry(t)},o);this.retryTimeouts.set(t.id,l),je.warning(`MCP server connection failed: ${t.name}`,{description:`Retrying in ${Math.round(o/1e3)}s (attempt ${a+1}/${n.maxAttempts+1})`})}else{this.connectionAttempts.delete(t.id);const a=s instanceof Error?s.message:"Connection failed";je.error(`Failed to connect to MCP server: ${t.name}`,{description:`All ${n.maxAttempts+1} connection attempts failed. ${a}`,duration:1e4}),console.error(`[${this.id}] All retry attempts exhausted for MCP server ${t.name}`)}}}async connectToMcpServer(t){const n=this.getRetryConfig();try{let r,s="streamable-http";if(t.url.startsWith("stdio://"))r=await this.connectWithStdioTransport(t),s="stdio";else{const i=new Promise((a,o)=>{setTimeout(()=>{o(new Error(`Connection timeout after ${n.timeout}ms`))},n.timeout)});try{r=await Promise.race([this.connectWithStreamableHttp(t),i]),s="streamable-http"}catch{r=await Promise.race([this.connectWithSseTransport(t),i]),s="sse"}}await this.handleSuccessfulConnection(t,r,s)}catch(r){let s=r;throw r instanceof Error&&(r.message.includes("Bridge service not healthy")||r.message.includes("stdio bridge connection failed")?s=new Error("Stdio MCP server requires LiteChat MCP Bridge. Please install and start the bridge service: npm install -g litechat-mcp-bridge && litechat-mcp-bridge"):r.message.includes("fetch")?s=new Error(`Network error: Unable to reach MCP server at ${t.url}. Please check if the server is running and accessible.`):r.message.includes("timeout")?s=new Error(`Connection timeout: MCP server at ${t.url} did not respond within ${n.timeout}ms.`):r.message.includes("401")||r.message.includes("403")?s=new Error(`Authentication error: Invalid credentials for MCP server at ${t.url}.`):r.message.includes("404")?s=new Error(`Server not found: MCP server endpoint ${t.url} does not exist.`):r.message.includes("500")&&(s=new Error(`Server error: MCP server at ${t.url} returned an internal server error.`))),console.error(`[${this.id}] Failed to connect to MCP server ${t.name}:`,s),s}}async connectWithStreamableHttp(t){const n=this.createStreamableHttpTransport(t);return YU({transport:n})}async getBridgeUrl(){const n=rl.getState().bridgeConfig||{};if(n.url)return n.url;if(n.host||n.port){const r=n.host||"localhost",s=n.port||3001;return`http://${r}:${s}`}return"http://localhost:3001"}async connectWithStdioTransport(t){var o;if(!t.url.startsWith("stdio://"))throw new Error("Not a stdio server configuration");const n=new URL(t.url),r=n.hostname||n.pathname.replace("//",""),s=n.searchParams.get("args")||"";if(!r)throw new Error("stdio:// URL must specify a command (e.g., stdio://npx?args=-y,@modelcontextprotocol/server-filesystem,.)");const i=await this.getBridgeUrl(),a=`${r}-${Date.now()}`;try{const l=new URLSearchParams;l.set("command",r),s&&l.set("args",s);const c=`${i}/servers/${a}/mcp?${l.toString()}`,u=await fetch(c,{method:"POST",headers:{"Content-Type":"application/json",...t.headers||{}},body:JSON.stringify({jsonrpc:"2.0",id:1,method:"tools/list",params:{}})});if(!u.ok)throw new Error(`Failed to get tools: ${u.status} ${u.statusText}`);const d=await u.json();if(d.error)throw new Error(`Tools request failed: ${d.error.message}`);let h=0;return{tools:((o=d.result)==null?void 0:o.tools)||[],serverEndpoint:c,callTool:async m=>{const y=`${Date.now()}_${++h}`,b=await fetch(c,{method:"POST",headers:{"Content-Type":"application/json",...t.headers||{}},body:JSON.stringify({jsonrpc:"2.0",id:y,method:"tools/call",params:{name:m.name,arguments:m.arguments}})});if(!b.ok)throw new Error(`Tool call failed: ${b.status} ${b.statusText}`);const v=await b.json();if(v.error)throw new Error(`Tool execution failed: ${v.error.message}`);return v.result}}}catch(l){throw new Error(`Bridge connection failed: ${l instanceof Error?l.message:l}. Ensure bridge is running with: npm run mcp-proxy. Command: ${r}, Args: ${s||"none"}`)}}async connectWithSseTransport(t){return YU({transport:{type:"sse",url:t.url,headers:t.headers||{}}})}createStreamableHttpTransport(t){let n=null,r=!1;return{async start(){const s=await fetch(t.url,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json, text/event-stream",Origin:window.location.origin,...t.headers},body:JSON.stringify({jsonrpc:"2.0",id:`init_${Date.now()}`,method:"initialize",params:{protocolVersion:"2025-03-26",capabilities:{tools:{}},clientInfo:{name:"LiteChat",version:"1.0.0"}}})});if(!s.ok)throw new Error(`HTTP ${s.status}: ${s.statusText}`);n=s.headers.get("Mcp-Session-Id");const i=await s.json();if(i.error)throw new Error(`MCP Initialize Error: ${i.error.message}`);const a=await fetch(t.url,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json",Origin:window.location.origin,...n&&{"Mcp-Session-Id":n},...t.headers},body:JSON.stringify({jsonrpc:"2.0",method:"initialized",params:{}})});if(!a.ok)throw new Error(`Failed to send initialized notification: ${a.status}`);r=!0},async send(s){var o,l;if(!r)throw new Error("Transport not connected");const i=await fetch(t.url,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json, text/event-stream",Origin:window.location.origin,...n&&{"Mcp-Session-Id":n},...t.headers},body:JSON.stringify(s)});if(!i.ok)throw i.status===404&&n?(n=null,r=!1,new Error("Session expired, reinitializing connection")):new Error(`HTTP ${i.status}: ${i.statusText}`);const a=i.headers.get("Content-Type")||"";if(a.includes("text/event-stream"))(o=i.body)==null||o.getReader();else if(a.includes("application/json")){const c=await i.json();(l=this.onmessage)==null||l.call(this,c)}},async close(){var s;if(n)try{await fetch(t.url,{method:"DELETE",headers:{Origin:window.location.origin,"Mcp-Session-Id":n,...t.headers}})}catch{}r=!1,n=null,(s=this.onclose)==null||s.call(this)},onclose:void 0,onerror:void 0,onmessage:void 0}}async handleSuccessfulConnection(t,n,r){let s;try{if(n.tools&&Array.isArray(n.tools))s={},n.tools.forEach(l=>{s[l.name]={description:l.description,parameters:l.inputSchema}});else throw console.error(`[${this.id}] Bridge client missing tools array:`,n),new Error("Bridge client missing tools array")}catch(l){throw console.error(`[${this.id}] Failed to retrieve tools from ${t.name}:`,l),console.error(`[${this.id}] Error stack:`,l instanceof Error?l.stack:"No stack trace available"),l}const i={id:t.id,name:t.name,client:n,tools:s,transport:r};this.mcpClients.set(t.id,i),i.tools=s,this.modApi&&Object.entries(s).forEach(([l,c])=>{const u=`mcp_${t.name}_${l}`,d=c;let h;if(d.parameters&&typeof d.parameters=="object"&&d.parameters.properties){const v={},x=d.parameters.required||[];for(const[w,S]of Object.entries(d.parameters.properties)){let C;switch(S.type){case"string":C=$e();break;case"number":C=Tt();break;case"boolean":C=br();break;case"array":C=on(yh());break;case"object":C=Ke({}).passthrough();break;default:C=yh()}S.description&&(C=C.describe(S.description)),x.includes(w)||(C=C.optional()),v[w]=C}h=Ke(v)}else h=Ke({});const m={description:d.description||`MCP tool ${l} from ${t.name}`,parameters:h},y=async v=>{const x=await i.client.callTool({name:l,arguments:v});return x&&x.content?Array.isArray(x.content)?x.content.map(S=>S.type==="text"?S.text:S.type==="image"?`[Image: ${S.mimeType||"unknown format"}]`:JSON.stringify(S)).join(`
`):typeof x.content=="string"?x.content:JSON.stringify(x.content):JSON.stringify(x)},b=this.modApi.registerTool(u,m,y);this.mcpToolUnregisterCallbacks.push(b),Pe.emit(kr.toolDiscovered,{toolName:l,serverId:t.id,serverName:t.name,toolDefinition:d})}),rl.getState().setServerStatus({serverId:t.id,connected:!0,error:void 0,lastConnected:new Date,toolCount:Object.keys(s).length,tools:Object.keys(s)});const o={"streamable-http":"Streamable HTTP (latest)",sse:"SSE (legacy)",stdio:"Stdio (local bridge)"};je.success(`Connected to MCP server: ${t.name}`,{description:`Using ${o[r]} transport with ${Object.keys(s).length} tools`})}retryServerConnection(t){const r=rl.getState().servers.find(a=>a.id===t);if(!r){console.error(`[${this.id}] Server with ID ${t} not found`);return}if(!r.enabled)return;this.connectionAttempts.delete(t);const s=this.retryTimeouts.get(t);s&&(clearTimeout(s),this.retryTimeouts.delete(t));const i=this.mcpClients.get(t);if(i){try{i.client&&typeof i.client.disconnect=="function"&&i.client.disconnect()}catch(a){console.error(`[${this.id}] Error disconnecting existing client for ${r.name}:`,a)}this.mcpClients.delete(t)}this.connectToMcpServerWithRetry(r)}getConnectionStatus(){const t={},n=rl.getState();return n.servers.forEach(r=>{const s=n.serverStatuses[r.id];t[r.id]={connected:(s==null?void 0:s.connected)||!1,error:s==null?void 0:s.error,toolCount:(s==null?void 0:s.toolCount)||0}}),t}registerMcpToolWithAI(t,n){const r=this.mcpClients.get(t);if(!r)return console.error(`[${this.id}] No MCP client found for server ${t}`),()=>{};const s=r.tools[n];if(!s)return console.error(`[${this.id}] Tool ${n} not found in server ${r.name}`),()=>{};if(!this.modApi)return console.error(`[${this.id}] ModApi not available for tool registration`),()=>{};const i=`mcp_${r.name}_${n}`;try{const a={description:s.description||`MCP tool ${n} from ${r.name}`,parameters:s.parameters||Ke({})},o=async c=>{const u=await r.client.callTool({name:n,arguments:c});let d="";u&&u.content?Array.isArray(u.content)?d=u.content.map(m=>m.type==="text"?m.text:m.type==="image"?`[Image: ${m.mimeType||"unknown format"}]`:JSON.stringify(m)).join(`
`):typeof u.content=="string"?d=u.content:d=JSON.stringify(u.content):d=JSON.stringify(u);const{maxResponseSize:h}=rl.getState();return d.length>h&&(d=d.substring(0,h)+`

[... response truncated due to size ...]`),d},l=this.modApi.registerTool(i,a,o);return this.mcpToolUnregisterCallbacks.push(l),Pe.emit(kr.toolRegistered,{toolName:n,serverId:r.id,serverName:r.name,prefixedToolName:i}),l}catch(a){return console.error(`[${this.id}] Error registering MCP tool ${n} with AI SDK:`,a),()=>{}}}unregisterMcpToolFromAI(t,n){const r=this.mcpClients.get(t);if(!r){console.error(`[${this.id}] No MCP client found for server ${t}`);return}const s=`mcp_${r.name}_${n}`;Pe.emit(kr.toolUnregistered,{toolName:n,serverId:r.id,prefixedToolName:s})}}const Drt=(e,t=80)=>e.length<=t?e:e.slice(0,t).trim()+"...",Pue=({enabledTools:e,onToggleTool:t,onToggleAll:n,disabled:r=!1,className:s,maxSteps:i,onMaxStepsChange:a,globalDefaultMaxSteps:o=5,showMaxSteps:l=!1,disabledMessage:c})=>{const u=jo(x=>x.tools),[d,h]=T.useState(""),m=T.useMemo(()=>Object.entries(u).map(([x,{definition:w,modId:S}])=>({name:x,description:w.description??"No description provided.",modId:S})).sort((x,w)=>x.name.localeCompare(w.name)),[u]),y=T.useMemo(()=>{const x=d.trim().toLowerCase();return x?m.filter(w=>w.name.toLowerCase().includes(x)||w.description.toLowerCase().includes(x)||w.modId.toLowerCase().includes(x)):m},[m,d]),b=T.useCallback(x=>{if(!a)return;const w=x.target.value;if(w===""){a(null);return}const S=parseInt(w,10);if(isNaN(S))a(null);else{const C=Math.max(1,Math.min(20,S));a(C)}},[a]),v=i===null?"":String(i);return f.jsxs("div",{className:Ze("p-4 max-w-2xl space-y-3",s),children:[f.jsx("h4",{className:"text-sm font-medium",children:"Available Tools"}),f.jsxs("div",{className:"relative",children:[f.jsx(Fa,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),f.jsx(_n,{type:"search",placeholder:"Filter tools...",value:d,onChange:x=>h(x.target.value),className:"pl-8 h-9",disabled:r})]}),f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsxs(It,{className:"text-xs text-muted-foreground",children:[y.length," tools shown (",e.size," enabled)"]}),f.jsxs("div",{className:"space-x-2",children:[f.jsx(ft,{variant:"outline",size:"sm",onClick:()=>n(!0,m.map(x=>x.name)),disabled:r||m.length===0,children:"Enable All"}),f.jsx(ft,{variant:"outline",size:"sm",onClick:()=>n(!1,m.map(x=>x.name)),disabled:r||m.length===0||e.size===0,children:"Disable All"})]})]}),f.jsx("div",{className:"border rounded-md bg-background/50",children:r&&c?f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:c}):m.length===0?f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No tools registered."}):y.length===0?f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No tools match filter."}):f.jsx(Lo,{className:"h-96 w-full",children:f.jsx("div",{className:"p-2 space-y-1",children:y.map(x=>f.jsxs("div",{className:"flex items-center justify-between p-1.5 rounded hover:bg-muted",children:[f.jsx(Io,{id:`tool-switch-${x.name}`,checked:e.has(x.name),onCheckedChange:w=>t(x.name,w),className:"flex-shrink-0",disabled:r}),f.jsxs("div",{className:"flex-grow pl-2 space-y-0.5",children:[f.jsx(It,{htmlFor:`tool-switch-${x.name}`,className:Ze("block text-sm font-medium",r?"cursor-not-allowed":"cursor-pointer"),children:x.name}),f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx("span",{className:"block text-xs text-muted-foreground break-words cursor-help",children:Drt(x.description)})}),f.jsx(Sr,{side:"bottom",className:"max-w-sm",children:f.jsxs("div",{className:"space-y-1",children:[f.jsx("div",{className:"font-medium",children:x.name}),f.jsxs("div",{className:"text-xs opacity-90",children:["From: ",x.modId]}),f.jsx("div",{className:"text-xs",children:x.description})]})})]})]})]},x.name))})})}),l&&f.jsxs("div",{className:"pt-2",children:[f.jsx(It,{htmlFor:"local-max-steps",className:"text-xs font-medium",children:"Max Tool Steps (This Turn)"}),f.jsx(_n,{id:"local-max-steps",type:"number",min:"1",max:"20",step:"1",value:v,onChange:b,className:"w-20 h-8 text-xs mt-1",placeholder:String(o),disabled:r}),f.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Overrides the global setting for the next message only (1-20). Leave blank to use default."})]})]})},Frt=({module:e,popoverMaxSteps:t,setPopoverMaxSteps:n,className:r})=>{const s=e.getEnabledTools(),i=e.getSelectedItemId(),a=e.getSelectedItemType(),o=e.getGlobalDefaultMaxSteps(),l=T.useCallback((h,m)=>{e.setEnabledTools(y=>{const b=new Set(y);return m?b.add(h):b.delete(h),b})},[e]),c=T.useCallback((h,m)=>{e.setEnabledTools(()=>h?new Set(m):new Set)},[e]),u=a!=="conversation"||!i;return f.jsx(Pue,{enabledTools:s,onToggleTool:l,onToggleAll:c,disabled:u,className:r,maxSteps:t,onMaxStepsChange:n,globalDefaultMaxSteps:o,showMaxSteps:!0,disabledMessage:"Select a conversation to manage tools."})},Lrt=({module:e})=>{const[,t]=T.useState({});T.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const[n,r]=T.useState(!1),[s,i]=T.useState(e.getMaxStepsOverride()),a=e.getEnabledTools(),o=e.getMaxStepsOverride(),l=e.getIsStreaming(),c=e.getIsVisible();T.useEffect(()=>{i(e.getMaxStepsOverride())},[e.getMaxStepsOverride()]);const u=m=>{r(m),!m&&s!==e.getMaxStepsOverride()&&e.setMaxStepsOverride(s)},d=a.size>0||o!==null,h=l;return c?f.jsxs(vl,{open:n,onOpenChange:u,children:[f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(xl,{asChild:!0,children:f.jsx(ft,{variant:d?"secondary":"ghost",size:"icon",className:"h-8 w-8",disabled:h,"aria-label":"Configure Tools",children:f.jsx(ym,{className:"h-4 w-4"})})})}),f.jsx(Sr,{side:"top",children:`Tools (${a.size} enabled)`})]})}),f.jsx(wl,{className:"w-auto p-0",align:"start",children:f.jsx(Frt,{module:e,popoverMaxSteps:s,setPopoverMaxSteps:i})})]}):null};class Brt{constructor(){me(this,"id","core-tool-selector");me(this,"unregisterCallback",null);me(this,"eventUnsubscribers",[]);me(this,"transientEnabledTools",new Set);me(this,"transientMaxStepsOverride",null);me(this,"isStreaming",!1);me(this,"isVisible",!0);me(this,"selectedItemId",null);me(this,"selectedItemType",null);me(this,"allToolsCount",0);me(this,"globalDefaultMaxSteps",5);me(this,"notifyComponentUpdate",null);me(this,"getEnabledTools",()=>this.transientEnabledTools);me(this,"getMaxStepsOverride",()=>this.transientMaxStepsOverride);me(this,"getIsStreaming",()=>this.isStreaming);me(this,"getIsVisible",()=>this.isVisible);me(this,"getSelectedItemId",()=>this.selectedItemId);me(this,"getSelectedItemType",()=>this.selectedItemType);me(this,"getAllToolsCount",()=>this.allToolsCount);me(this,"getGlobalDefaultMaxSteps",()=>this.globalDefaultMaxSteps);me(this,"setEnabledTools",t=>{var n;this.transientEnabledTools=t(this.transientEnabledTools),(n=this.notifyComponentUpdate)==null||n.call(this)});me(this,"setMaxStepsOverride",t=>{var n;this.transientMaxStepsOverride=t,(n=this.notifyComponentUpdate)==null||n.call(this)});me(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){var o;this.loadInitialState(),this.updateVisibility(),(o=this.notifyComponentUpdate)==null||o.call(this);const n=t.on(Zn.statusChanged,l=>{var c;typeof l=="object"&&l&&"status"in l&&this.isStreaming!==(l.status==="streaming")&&(this.isStreaming=l.status==="streaming",(c=this.notifyComponentUpdate)==null||c.call(this))}),r=t.on(dr.selectedModelChanged,()=>{var l;this.updateVisibility(),(l=this.notifyComponentUpdate)==null||l.call(this)}),s=t.on(Pr.contextChanged,l=>{var c;this.selectedItemId=l.selectedItemId,this.selectedItemType=l.selectedItemType,this.updateVisibility(),(c=this.notifyComponentUpdate)==null||c.call(this)}),i=t.on(sn.toolMaxStepsChanged,l=>{var c;typeof l=="object"&&l&&"steps"in l&&(this.globalDefaultMaxSteps=l.steps,(c=this.notifyComponentUpdate)==null||c.call(this))}),a=t.on($r.toolsChanged,l=>{var c;if(l&&typeof l.tools=="object"){const u=Object.keys(l.tools).length;this.allToolsCount!==u&&(this.allToolsCount=u,this.updateVisibility(),(c=this.notifyComponentUpdate)==null||c.call(this))}});this.eventUnsubscribers.push(n,r,s,i,a)}loadInitialState(){this.isStreaming=$n.getState().status==="streaming",this.selectedItemId=qn.getState().selectedItemId,this.selectedItemType=qn.getState().selectedItemType,this.allToolsCount=Object.keys(jo.getState().tools).length,this.globalDefaultMaxSteps=yr.getState().toolMaxSteps}updateVisibility(){var a,o;const{getSelectedModel:t}=Nr.getState(),n=t(),r=this.allToolsCount>0,s=((o=(a=n==null?void 0:n.metadata)==null?void 0:a.supported_parameters)==null?void 0:o.includes("tools"))??!1,i=r&&s;this.isVisible!==i&&(this.isVisible=i)}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,triggerRenderer:()=>We.createElement(Lrt,{module:this}),getMetadata:()=>{if(this.transientEnabledTools.size>0||this.transientMaxStepsOverride!==null)return{enabledTools:Array.from(this.transientEnabledTools),...this.transientMaxStepsOverride!==null&&{maxSteps:this.transientMaxStepsOverride}}},clearOnSubmit:()=>{var r;let n=!1;this.transientEnabledTools.size>0&&(this.transientEnabledTools=new Set,n=!0),this.transientMaxStepsOverride!==null&&(this.transientMaxStepsOverride=null,n=!0),n&&((r=this.notifyComponentUpdate)==null||r.call(this))}})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,console.log(`[${this.id}] Destroyed.`)}}var pW=1,$rt=.9,zrt=.8,Urt=.17,C3=.1,k3=.999,qrt=.9999,Vrt=.99,Wrt=/[\\\/_+.#"@\[\(\{&]/,Hrt=/[\\\/_+.#"@\[\(\{&]/g,Grt=/[\s-]/,Oue=/[\s-]/g;function wP(e,t,n,r,s,i,a){if(i===t.length)return s===e.length?pW:Vrt;var o=`${s},${i}`;if(a[o]!==void 0)return a[o];for(var l=r.charAt(i),c=n.indexOf(l,s),u=0,d,h,m,y;c>=0;)d=wP(e,t,n,r,c+1,i+1,a),d>u&&(c===s?d*=pW:Wrt.test(e.charAt(c-1))?(d*=zrt,m=e.slice(s,c-1).match(Hrt),m&&s>0&&(d*=Math.pow(k3,m.length))):Grt.test(e.charAt(c-1))?(d*=$rt,y=e.slice(s,c-1).match(Oue),y&&s>0&&(d*=Math.pow(k3,y.length))):(d*=Urt,s>0&&(d*=Math.pow(k3,c-s))),e.charAt(c)!==t.charAt(i)&&(d*=qrt)),(d<C3&&n.charAt(c-1)===r.charAt(i+1)||r.charAt(i+1)===r.charAt(i)&&n.charAt(c-1)!==r.charAt(i))&&(h=wP(e,t,n,r,c+1,i+2,a),h*C3>d&&(d=h*C3)),d>u&&(u=d),c=n.indexOf(l,c+1);return a[o]=u,u}function mW(e){return e.toLowerCase().replace(Oue," ")}function Krt(e,t,n){return e=n&&n.length>0?`${e+" "+n.join(" ")}`:e,wP(e,t,mW(e),mW(t),0,0,{})}var Kv='[cmdk-group=""]',E3='[cmdk-group-items=""]',Yrt='[cmdk-group-heading=""]',Due='[cmdk-item=""]',gW=`${Due}:not([aria-disabled="true"])`,_P="cmdk-item-select",f0="data-value",Zrt=(e,t,n)=>Krt(e,t,n),Fue=T.createContext(void 0),o_=()=>T.useContext(Fue),Lue=T.createContext(void 0),G5=()=>T.useContext(Lue),Bue=T.createContext(void 0),$ue=T.forwardRef((e,t)=>{let n=h0(()=>{var ee,se;return{search:"",value:(se=(ee=e.value)!=null?ee:e.defaultValue)!=null?se:"",selectedItemId:void 0,filtered:{count:0,items:new Map,groups:new Set}}}),r=h0(()=>new Set),s=h0(()=>new Map),i=h0(()=>new Map),a=h0(()=>new Set),o=zue(e),{label:l,children:c,value:u,onValueChange:d,filter:h,shouldFilter:m,loop:y,disablePointerSelection:b=!1,vimBindings:v=!0,...x}=e,w=aa(),S=aa(),C=aa(),k=T.useRef(null),A=ost();Fm(()=>{if(u!==void 0){let ee=u.trim();n.current.value=ee,R.emit()}},[u]),Fm(()=>{A(6,V)},[]);let R=T.useMemo(()=>({subscribe:ee=>(a.current.add(ee),()=>a.current.delete(ee)),snapshot:()=>n.current,setState:(ee,se,pe)=>{var ce,Ie,De,Se;if(!Object.is(n.current[ee],se)){if(n.current[ee]=se,ee==="search")O(),P(),A(1,L);else if(ee==="value"){if(document.activeElement.hasAttribute("cmdk-input")||document.activeElement.hasAttribute("cmdk-root")){let Ce=document.getElementById(C);Ce?Ce.focus():(ce=document.getElementById(w))==null||ce.focus()}if(A(7,()=>{var Ce;n.current.selectedItemId=(Ce=D())==null?void 0:Ce.id,R.emit()}),pe||A(5,V),((Ie=o.current)==null?void 0:Ie.value)!==void 0){let Ce=se??"";(Se=(De=o.current).onValueChange)==null||Se.call(De,Ce);return}}R.emit()}},emit:()=>{a.current.forEach(ee=>ee())}}),[]),N=T.useMemo(()=>({value:(ee,se,pe)=>{var ce;se!==((ce=i.current.get(ee))==null?void 0:ce.value)&&(i.current.set(ee,{value:se,keywords:pe}),n.current.filtered.items.set(ee,I(se,pe)),A(2,()=>{P(),R.emit()}))},item:(ee,se)=>(r.current.add(ee),se&&(s.current.has(se)?s.current.get(se).add(ee):s.current.set(se,new Set([ee]))),A(3,()=>{O(),P(),n.current.value||L(),R.emit()}),()=>{i.current.delete(ee),r.current.delete(ee),n.current.filtered.items.delete(ee);let pe=D();A(4,()=>{O(),(pe==null?void 0:pe.getAttribute("id"))===ee&&L(),R.emit()})}),group:ee=>(s.current.has(ee)||s.current.set(ee,new Set),()=>{i.current.delete(ee),s.current.delete(ee)}),filter:()=>o.current.shouldFilter,label:l||e["aria-label"],getDisablePointerSelection:()=>o.current.disablePointerSelection,listId:w,inputId:C,labelId:S,listInnerRef:k}),[]);function I(ee,se){var pe,ce;let Ie=(ce=(pe=o.current)==null?void 0:pe.filter)!=null?ce:Zrt;return ee?Ie(ee,n.current.search,se):0}function P(){if(!n.current.search||o.current.shouldFilter===!1)return;let ee=n.current.filtered.items,se=[];n.current.filtered.groups.forEach(ce=>{let Ie=s.current.get(ce),De=0;Ie.forEach(Se=>{let Ce=ee.get(Se);De=Math.max(Ce,De)}),se.push([ce,De])});let pe=k.current;Z().sort((ce,Ie)=>{var De,Se;let Ce=ce.getAttribute("id"),qe=Ie.getAttribute("id");return((De=ee.get(qe))!=null?De:0)-((Se=ee.get(Ce))!=null?Se:0)}).forEach(ce=>{let Ie=ce.closest(E3);Ie?Ie.appendChild(ce.parentElement===Ie?ce:ce.closest(`${E3} > *`)):pe.appendChild(ce.parentElement===pe?ce:ce.closest(`${E3} > *`))}),se.sort((ce,Ie)=>Ie[1]-ce[1]).forEach(ce=>{var Ie;let De=(Ie=k.current)==null?void 0:Ie.querySelector(`${Kv}[${f0}="${encodeURIComponent(ce[0])}"]`);De==null||De.parentElement.appendChild(De)})}function L(){let ee=Z().find(pe=>pe.getAttribute("aria-disabled")!=="true"),se=ee==null?void 0:ee.getAttribute(f0);R.setState("value",se||void 0)}function O(){var ee,se,pe,ce;if(!n.current.search||o.current.shouldFilter===!1){n.current.filtered.count=r.current.size;return}n.current.filtered.groups=new Set;let Ie=0;for(let De of r.current){let Se=(se=(ee=i.current.get(De))==null?void 0:ee.value)!=null?se:"",Ce=(ce=(pe=i.current.get(De))==null?void 0:pe.keywords)!=null?ce:[],qe=I(Se,Ce);n.current.filtered.items.set(De,qe),qe>0&&Ie++}for(let[De,Se]of s.current)for(let Ce of Se)if(n.current.filtered.items.get(Ce)>0){n.current.filtered.groups.add(De);break}n.current.filtered.count=Ie}function V(){var ee,se,pe;let ce=D();ce&&(((ee=ce.parentElement)==null?void 0:ee.firstChild)===ce&&((pe=(se=ce.closest(Kv))==null?void 0:se.querySelector(Yrt))==null||pe.scrollIntoView({block:"nearest"})),ce.scrollIntoView({block:"nearest"}))}function D(){var ee;return(ee=k.current)==null?void 0:ee.querySelector(`${Due}[aria-selected="true"]`)}function Z(){var ee;return Array.from(((ee=k.current)==null?void 0:ee.querySelectorAll(gW))||[])}function U(ee){let se=Z()[ee];se&&R.setState("value",se.getAttribute(f0))}function H(ee){var se;let pe=D(),ce=Z(),Ie=ce.findIndex(Se=>Se===pe),De=ce[Ie+ee];(se=o.current)!=null&&se.loop&&(De=Ie+ee<0?ce[ce.length-1]:Ie+ee===ce.length?ce[0]:ce[Ie+ee]),De&&R.setState("value",De.getAttribute(f0))}function $(ee){let se=D(),pe=se==null?void 0:se.closest(Kv),ce;for(;pe&&!ce;)pe=ee>0?ist(pe,Kv):ast(pe,Kv),ce=pe==null?void 0:pe.querySelector(gW);ce?R.setState("value",ce.getAttribute(f0)):H(ee)}let ne=()=>U(Z().length-1),W=ee=>{ee.preventDefault(),ee.metaKey?ne():ee.altKey?$(1):H(1)},Q=ee=>{ee.preventDefault(),ee.metaKey?U(0):ee.altKey?$(-1):H(-1)};return T.createElement(ar.div,{ref:t,tabIndex:-1,...x,"cmdk-root":"",onKeyDown:ee=>{var se;(se=x.onKeyDown)==null||se.call(x,ee);let pe=ee.nativeEvent.isComposing||ee.keyCode===229;if(!(ee.defaultPrevented||pe))switch(ee.key){case"n":case"j":{v&&ee.ctrlKey&&W(ee);break}case"ArrowDown":{W(ee);break}case"p":case"k":{v&&ee.ctrlKey&&Q(ee);break}case"ArrowUp":{Q(ee);break}case"Home":{ee.preventDefault(),U(0);break}case"End":{ee.preventDefault(),ne();break}case"Enter":{ee.preventDefault();let ce=D();if(ce){let Ie=new Event(_P);ce.dispatchEvent(Ie)}}}}},T.createElement("label",{"cmdk-label":"",htmlFor:N.inputId,id:N.labelId,style:cst},l),fA(e,ee=>T.createElement(Lue.Provider,{value:R},T.createElement(Fue.Provider,{value:N},ee))))}),Xrt=T.forwardRef((e,t)=>{var n,r;let s=aa(),i=T.useRef(null),a=T.useContext(Bue),o=o_(),l=zue(e),c=(r=(n=l.current)==null?void 0:n.forceMount)!=null?r:a==null?void 0:a.forceMount;Fm(()=>{if(!c)return o.item(s,a==null?void 0:a.id)},[c]);let u=Uue(s,i,[e.value,e.children,i],e.keywords),d=G5(),h=Dh(A=>A.value&&A.value===u.current),m=Dh(A=>c||o.filter()===!1?!0:A.search?A.filtered.items.get(s)>0:!0);T.useEffect(()=>{let A=i.current;if(!(!A||e.disabled))return A.addEventListener(_P,y),()=>A.removeEventListener(_P,y)},[m,e.onSelect,e.disabled]);function y(){var A,R;b(),(R=(A=l.current).onSelect)==null||R.call(A,u.current)}function b(){d.setState("value",u.current,!0)}if(!m)return null;let{disabled:v,value:x,onSelect:w,forceMount:S,keywords:C,...k}=e;return T.createElement(ar.div,{ref:hl(i,t),...k,id:s,"cmdk-item":"",role:"option","aria-disabled":!!v,"aria-selected":!!h,"data-disabled":!!v,"data-selected":!!h,onPointerMove:v||o.getDisablePointerSelection()?void 0:b,onClick:v?void 0:y},e.children)}),Jrt=T.forwardRef((e,t)=>{let{heading:n,children:r,forceMount:s,...i}=e,a=aa(),o=T.useRef(null),l=T.useRef(null),c=aa(),u=o_(),d=Dh(m=>s||u.filter()===!1?!0:m.search?m.filtered.groups.has(a):!0);Fm(()=>u.group(a),[]),Uue(a,o,[e.value,e.heading,l]);let h=T.useMemo(()=>({id:a,forceMount:s}),[s]);return T.createElement(ar.div,{ref:hl(o,t),...i,"cmdk-group":"",role:"presentation",hidden:d?void 0:!0},n&&T.createElement("div",{ref:l,"cmdk-group-heading":"","aria-hidden":!0,id:c},n),fA(e,m=>T.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":n?c:void 0},T.createElement(Bue.Provider,{value:h},m))))}),Qrt=T.forwardRef((e,t)=>{let{alwaysRender:n,...r}=e,s=T.useRef(null),i=Dh(a=>!a.search);return!n&&!i?null:T.createElement(ar.div,{ref:hl(s,t),...r,"cmdk-separator":"",role:"separator"})}),est=T.forwardRef((e,t)=>{let{onValueChange:n,...r}=e,s=e.value!=null,i=G5(),a=Dh(c=>c.search),o=Dh(c=>c.selectedItemId),l=o_();return T.useEffect(()=>{e.value!=null&&i.setState("search",e.value)},[e.value]),T.createElement(ar.input,{ref:t,...r,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":l.listId,"aria-labelledby":l.labelId,"aria-activedescendant":o,id:l.inputId,type:"text",value:s?e.value:a,onChange:c=>{s||i.setState("search",c.target.value),n==null||n(c.target.value)}})}),tst=T.forwardRef((e,t)=>{let{children:n,label:r="Suggestions",...s}=e,i=T.useRef(null),a=T.useRef(null),o=Dh(c=>c.selectedItemId),l=o_();return T.useEffect(()=>{if(a.current&&i.current){let c=a.current,u=i.current,d,h=new ResizeObserver(()=>{d=requestAnimationFrame(()=>{let m=c.offsetHeight;u.style.setProperty("--cmdk-list-height",m.toFixed(1)+"px")})});return h.observe(c),()=>{cancelAnimationFrame(d),h.unobserve(c)}}},[]),T.createElement(ar.div,{ref:hl(i,t),...s,"cmdk-list":"",role:"listbox",tabIndex:-1,"aria-activedescendant":o,"aria-label":r,id:l.listId},fA(e,c=>T.createElement("div",{ref:hl(a,l.listInnerRef),"cmdk-list-sizer":""},c)))}),nst=T.forwardRef((e,t)=>{let{open:n,onOpenChange:r,overlayClassName:s,contentClassName:i,container:a,...o}=e;return T.createElement(Ole,{open:n,onOpenChange:r},T.createElement(Dle,{container:a},T.createElement(Fle,{"cmdk-overlay":"",className:s}),T.createElement(Lle,{"aria-label":e.label,"cmdk-dialog":"",className:i},T.createElement($ue,{ref:t,...o}))))}),rst=T.forwardRef((e,t)=>Dh(n=>n.filtered.count===0)?T.createElement(ar.div,{ref:t,...e,"cmdk-empty":"",role:"presentation"}):null),sst=T.forwardRef((e,t)=>{let{progress:n,children:r,label:s="Loading...",...i}=e;return T.createElement(ar.div,{ref:t,...i,"cmdk-loading":"",role:"progressbar","aria-valuenow":n,"aria-valuemin":0,"aria-valuemax":100,"aria-label":s},fA(e,a=>T.createElement("div",{"aria-hidden":!0},a)))}),gb=Object.assign($ue,{List:tst,Item:Xrt,Input:est,Group:Jrt,Separator:Qrt,Dialog:nst,Empty:rst,Loading:sst});function ist(e,t){let n=e.nextElementSibling;for(;n;){if(n.matches(t))return n;n=n.nextElementSibling}}function ast(e,t){let n=e.previousElementSibling;for(;n;){if(n.matches(t))return n;n=n.previousElementSibling}}function zue(e){let t=T.useRef(e);return Fm(()=>{t.current=e}),t}var Fm=typeof window>"u"?T.useEffect:T.useLayoutEffect;function h0(e){let t=T.useRef();return t.current===void 0&&(t.current=e()),t}function Dh(e){let t=G5(),n=()=>e(t.snapshot());return T.useSyncExternalStore(t.subscribe,n,n)}function Uue(e,t,n,r=[]){let s=T.useRef(),i=o_();return Fm(()=>{var a;let o=(()=>{var c;for(let u of n){if(typeof u=="string")return u.trim();if(typeof u=="object"&&"current"in u)return u.current?(c=u.current.textContent)==null?void 0:c.trim():s.current}})(),l=r.map(c=>c.trim());i.value(e,o,l),(a=t.current)==null||a.setAttribute(f0,o),s.current=o}),s}var ost=()=>{let[e,t]=T.useState(),n=h0(()=>new Map);return Fm(()=>{n.current.forEach(r=>r()),n.current=new Map},[e]),(r,s)=>{n.current.set(r,s),t({})}};function lst(e){let t=e.type;return typeof t=="function"?t(e.props):"render"in t?t.render(e.props):e}function fA({asChild:e,children:t},n){return e&&T.isValidElement(t)?T.cloneElement(lst(t),{ref:t.ref},n(t.props.children)):n(t)}var cst={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};function que({className:e,...t}){return f.jsx(gb,{"data-slot":"command",className:Ze("bg-popover text-popover-foreground flex h-full w-full flex-col overflow-hidden rounded-md",e),...t})}function Vue({className:e,...t}){return f.jsxs("div",{"data-slot":"command-input-wrapper",className:"flex h-9 items-center gap-2 border-b px-3",children:[f.jsx(Fa,{className:"size-4 shrink-0 opacity-50"}),f.jsx(gb.Input,{"data-slot":"command-input",className:Ze("placeholder:text-muted-foreground flex h-10 w-full rounded-md bg-transparent py-3 text-sm outline-hidden disabled:cursor-not-allowed disabled:opacity-50",e),...t})]})}function Wue({className:e,...t}){return f.jsx(gb.List,{"data-slot":"command-list",className:Ze("max-h-[300px] scroll-py-1 overflow-x-hidden overflow-y-auto",e),...t})}function Hue({...e}){return f.jsx(gb.Empty,{"data-slot":"command-empty",className:"py-6 text-center text-sm",...e})}function Gue({className:e,...t}){return f.jsx(gb.Group,{"data-slot":"command-group",className:Ze("text-foreground [&_[cmdk-group-heading]]:text-muted-foreground overflow-hidden p-1 [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium",e),...t})}function Kue({className:e,...t}){return f.jsx(gb.Item,{"data-slot":"command-item",className:Ze("data-[selected=true]:bg-accent data-[selected=true]:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled=true]:pointer-events-none data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...t})}const K5=({models:e,value:t,onChange:n,className:r,disabled:s,isLoading:i})=>{const[a,o]=T.useState(!1),[l,c]=T.useState(""),[u,d]=T.useState({reasoning:!1,webSearch:!1,tools:!1,multimodal:!1,imageGeneration:!1}),h=T.useMemo(()=>{let w=e;if(l.trim()){const C=l.toLowerCase();w=e.filter(k=>k.name.toLowerCase().includes(C)||k.providerName.toLowerCase().includes(C)||k.id.toLowerCase().includes(C))}const S=Object.entries(u).filter(([,C])=>C).map(([C])=>C);return S.length===0?w:w.filter(C=>{var N,I,P;const k=new Set(((N=C.metadataSummary)==null?void 0:N.supported_parameters)??[]),A=new Set(((I=C.metadataSummary)==null?void 0:I.input_modalities)??[]),R=new Set(((P=C.metadataSummary)==null?void 0:P.output_modalities)??[]);return S.every(L=>{switch(L){case"reasoning":return k.has("reasoning");case"webSearch":return k.has("web_search")||k.has("web_search_options");case"tools":return k.has("tools");case"multimodal":return Array.from(A).some(O=>O!=="text");case"imageGeneration":return R.has("image");default:return!0}})})},[e,l,u]),m=T.useMemo(()=>e.find(w=>w.id===t),[e,t]),y=T.useCallback(w=>{const S=w===t?null:w;n==null||n(S),o(!1),c("")},[t,n]),b=w=>{d(S=>({...S,[w]:!S[w]}))};if(i)return f.jsx(Wr,{className:Ze("h-9 w-[250px]",r)});const x=Object.values(u).filter(Boolean).length;return f.jsxs(vl,{open:a,onOpenChange:o,children:[f.jsx(xl,{asChild:!0,children:f.jsxs(ft,{variant:"outline",role:"combobox","aria-expanded":a,disabled:s||e.length===0,className:Ze("w-auto justify-between h-9 text-sm font-normal relative",r),children:[f.jsx("span",{className:"truncate max-w-[200px] sm:max-w-[300px]",children:m?`${m.name} (${m.providerName})`:"Select Model..."}),f.jsx(cE,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"}),x>0&&f.jsx("span",{className:"absolute -top-1 -right-1 inline-flex items-center justify-center px-1.5 py-0.5 text-xs font-semibold leading-none text-white bg-primary rounded-full",children:x})]})}),f.jsx(wl,{className:"w-[--radix-popover-trigger-width] p-0",style:{maxHeight:"min(40vh, 400px)",overflow:"hidden"},children:f.jsxs(que,{shouldFilter:!1,children:[f.jsxs("div",{className:"flex items-center border-b px-3",children:[f.jsx(Fa,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),f.jsx(Vue,{placeholder:"Search model...",value:l,onValueChange:c,className:"flex h-10 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50 border-0 focus-visible:ring-0 focus-visible:ring-offset-0"}),f.jsxs("div",{className:"flex items-center gap-0.5 ml-auto pl-2",children:[f.jsx(ft,{variant:u.reasoning?"secondary":"ghost",size:"sm",className:Ze("h-7 w-7 p-0",u.reasoning&&"text-primary"),onClick:()=>b("reasoning"),title:"Filter: Reasoning","aria-label":"Filter by reasoning capability",children:f.jsx(yB,{className:"h-4 w-4"})}),f.jsx(ft,{variant:u.webSearch?"secondary":"ghost",size:"sm",className:Ze("h-7 w-7 p-0",u.webSearch&&"text-primary"),onClick:()=>b("webSearch"),title:"Filter: Web Search","aria-label":"Filter by web search capability",children:f.jsx(vB,{className:"h-4 w-4"})}),f.jsx(ft,{variant:u.tools?"secondary":"ghost",size:"sm",className:Ze("h-7 w-7 p-0",u.tools&&"text-primary"),onClick:()=>b("tools"),title:"Filter: Tools","aria-label":"Filter by tool usage capability",children:f.jsx(ym,{className:"h-4 w-4"})}),f.jsx(ft,{variant:u.multimodal?"secondary":"ghost",size:"sm",className:Ze("h-7 w-7 p-0",u.multimodal&&"text-primary"),onClick:()=>b("multimodal"),title:"Filter: Multimodal","aria-label":"Filter by multimodal capability",children:f.jsx(mm,{className:"h-4 w-4"})}),f.jsx(ft,{variant:u.imageGeneration?"secondary":"ghost",size:"sm",className:Ze("h-7 w-7 p-0",u.imageGeneration&&"text-primary"),onClick:()=>b("imageGeneration"),title:"Filter: Image Generation","aria-label":"Filter by image generation capability",children:f.jsx(tC,{className:"h-4 w-4"})})]})]}),f.jsxs(Wue,{className:"max-h-[calc(min(40vh,400px)-70px)] overflow-y-auto",children:[f.jsx(Hue,{children:x>0?"No models match all active filters.":e.length===0?"No models available.":"No model found."}),f.jsx(Gue,{children:h.map(w=>{var S,C,k,A,R,N,I,P,L,O,V,D;return f.jsx(Kue,{value:w.id,onSelect:y,className:"flex items-center",children:f.jsxs("div",{className:"flex-1 truncate flex justify-between items-center",children:[f.jsxs("div",{children:[f.jsx("div",{className:"text-sm font-medium",children:w.name}),f.jsx("div",{className:"text-xs text-muted-foreground",children:w.providerName})]}),f.jsxs("div",{className:"flex gap-1 ml-2",children:[((C=(S=w.metadataSummary)==null?void 0:S.supported_parameters)==null?void 0:C.includes("reasoning"))&&f.jsx(yB,{className:"h-3.5 w-3.5 text-purple-500"}),(((A=(k=w.metadataSummary)==null?void 0:k.supported_parameters)==null?void 0:A.includes("web_search"))||((N=(R=w.metadataSummary)==null?void 0:R.supported_parameters)==null?void 0:N.includes("web_search_options")))&&f.jsx(vB,{className:"h-3.5 w-3.5 text-blue-500"}),((P=(I=w.metadataSummary)==null?void 0:I.supported_parameters)==null?void 0:P.includes("tools"))&&f.jsx(ym,{className:"h-3.5 w-3.5 text-orange-500"}),((O=(L=w.metadataSummary)==null?void 0:L.input_modalities)==null?void 0:O.some(Z=>Z!=="text"))&&f.jsx(mm,{className:"h-3.5 w-3.5 text-green-500"}),((D=(V=w.metadataSummary)==null?void 0:V.output_modalities)==null?void 0:D.includes("image"))&&f.jsx(tC,{className:"h-3.5 w-3.5 text-pink-500"})]})]})},w.id)})})]})]})})]})},T3=Ke({systemPrompt:$e().nullable(),modelId:$e().nullable()}),ust=({initialSystemPrompt:e,initialModelId:t,onSave:n,effectiveSystemPrompt:r,effectiveModelId:s,isParentSaving:i=!1})=>{var u;const{getAvailableModelListItems:a}=Nr(yn(d=>({getAvailableModelListItems:d.getAvailableModelListItems}))),o=a(),l=((u=o.find(d=>d.id===s))==null?void 0:u.name)||s,c=ri({defaultValues:{systemPrompt:e??null,modelId:t??null},validators:{onChangeAsync:T3,onChangeAsyncDebounceMs:500},onSubmit:async({value:d})=>{await n({systemPrompt:d.systemPrompt,modelId:d.modelId})}});return T.useEffect(()=>{c.reset({systemPrompt:e??null,modelId:t??null})},[e,t,c]),f.jsxs("form",{onSubmit:d=>{d.preventDefault(),d.stopPropagation(),c.handleSubmit()},className:"space-y-6",children:[f.jsx(c.Field,{name:"systemPrompt",validators:{onChange:T3.shape.systemPrompt},children:d=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(It,{htmlFor:`${d.name}-textarea`,children:"System Prompt (Overrides Parent/Global)"}),f.jsx(Bo,{id:`${d.name}-textarea`,placeholder:`Inherited: ${(r==null?void 0:r.substring(0,100))||"Default"}${r&&r.length>100?"...":""}`,value:d.state.value??"",onChange:h=>d.handleChange(h.target.value),onBlur:d.handleBlur,rows:6,disabled:c.state.isSubmitting||i,className:"mt-1"}),f.jsx(Ni,{field:d}),f.jsx(ft,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>c.setFieldValue("systemPrompt",null),disabled:c.state.isSubmitting||i||d.state.value===null,type:"button",children:"Use Inherited/Default"})]})}),f.jsx(c.Field,{name:"modelId",validators:{onChange:T3.shape.modelId},children:d=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(It,{children:"Default Model (Overrides Parent/Global)"}),f.jsx(K5,{models:o,value:d.state.value,onChange:h=>{d.handleChange(h),d.handleBlur()},disabled:c.state.isSubmitting||i,className:"w-full mt-1"}),f.jsx(Ni,{field:d}),f.jsxs(ft,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>c.setFieldValue("modelId",null),disabled:c.state.isSubmitting||i||d.state.value===null,type:"button",children:["Use Inherited/Default (",l||"Global Default",")"]})]})}),f.jsx("div",{className:"flex justify-end pt-2",children:f.jsx(c.Subscribe,{selector:d=>[d.canSubmit,d.isSubmitting,d.isValidating,d.isValid],children:([d,h,m,y])=>f.jsxs(ft,{type:"submit",size:"sm",disabled:i||!d||h||m||!y,children:[(h||m)&&f.jsx(Qn,{className:"h-4 w-4 mr-1 animate-spin"}),f.jsx(Qd,{className:"h-4 w-4 mr-1"}),h||m?"Saving...":"Save Prompt Settings"]})})})]})};function o0({field:e}){return e.state.meta.isTouched&&e.state.meta.errors.length>0?f.jsx("em",{className:"text-xs text-destructive pt-1 block",children:e.state.meta.errors.join(", ")}):null}const dst=({form:e,isSaving:t,effectiveTemperature:n,effectiveMaxTokens:r,effectiveTopP:s,effectiveTopK:i,effectivePresencePenalty:a,effectiveFrequencyPenalty:o})=>f.jsxs("div",{className:"space-y-4",children:[f.jsx(e.Field,{name:"temperature",children:l=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsxs(It,{htmlFor:l.name,className:"text-xs",children:["Temperature (",(l.state.value??n??.7).toFixed(2),")"]}),f.jsx(k0,{id:l.name,min:0,max:1,step:.01,value:[l.state.value??n??.7],onValueChange:c=>l.handleChange(c[0]),onBlur:l.handleBlur,disabled:t}),f.jsxs(ft,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>l.handleChange(null),disabled:t||l.state.value===null,children:["Use Inherited/Default (",(n==null?void 0:n.toFixed(2))??"N/A",")"]}),f.jsx(o0,{field:l})]})}),f.jsx(e.Field,{name:"topP",children:l=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsxs(It,{htmlFor:l.name,className:"text-xs",children:["Top P (",(l.state.value??s??1).toFixed(2),")"]}),f.jsx(k0,{id:l.name,min:0,max:1,step:.01,value:[l.state.value??s??1],onValueChange:c=>l.handleChange(c[0]),onBlur:l.handleBlur,disabled:t}),f.jsxs(ft,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>l.handleChange(null),disabled:t||l.state.value===null,children:["Use Inherited/Default (",(s==null?void 0:s.toFixed(2))??"N/A",")"]}),f.jsx(o0,{field:l})]})}),f.jsxs("div",{className:"grid grid-cols-2 gap-4 items-end",children:[f.jsx(e.Field,{name:"maxTokens",children:l=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(It,{htmlFor:l.name,className:"text-xs",children:"Max Tokens"}),f.jsx(_n,{id:l.name,type:"number",placeholder:`Inherited: ${r??"Default"}`,value:l.state.value??"",onChange:c=>l.handleChange(c.target.value===""?null:parseInt(c.target.value,10)),onBlur:l.handleBlur,min:"1",className:"h-8 text-xs",disabled:t}),f.jsx(ft,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>l.handleChange(null),disabled:t||l.state.value===null,children:"Use Inherited/Default"}),f.jsx(o0,{field:l})]})}),f.jsx(e.Field,{name:"topK",children:l=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(It,{htmlFor:l.name,className:"text-xs",children:"Top K"}),f.jsx(_n,{id:l.name,type:"number",placeholder:`Inherited: ${i??"Default"}`,value:l.state.value??"",onChange:c=>l.handleChange(c.target.value===""?null:parseInt(c.target.value,10)),onBlur:l.handleBlur,min:"1",className:"h-8 text-xs",disabled:t}),f.jsx(ft,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>l.handleChange(null),disabled:t||l.state.value===null,children:"Use Inherited/Default"}),f.jsx(o0,{field:l})]})})]}),f.jsx(e.Field,{name:"presencePenalty",children:l=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsxs(It,{htmlFor:l.name,className:"text-xs",children:["Presence Penalty (",(l.state.value??a??0).toFixed(2),")"]}),f.jsx(k0,{id:l.name,min:-2,max:2,step:.01,value:[l.state.value??a??0],onValueChange:c=>l.handleChange(c[0]),onBlur:l.handleBlur,disabled:t}),f.jsxs(ft,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>l.handleChange(null),disabled:t||l.state.value===null,children:["Use Inherited/Default (",(a==null?void 0:a.toFixed(2))??"N/A",")"]}),f.jsx(o0,{field:l})]})}),f.jsx(e.Field,{name:"frequencyPenalty",children:l=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsxs(It,{htmlFor:l.name,className:"text-xs",children:["Frequency Penalty (",(l.state.value??o??0).toFixed(2),")"]}),f.jsx(k0,{id:l.name,min:-2,max:2,step:.01,value:[l.state.value??o??0],onValueChange:c=>l.handleChange(c[0]),onBlur:l.handleBlur,disabled:t}),f.jsxs(ft,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>l.handleChange(null),disabled:t||l.state.value===null,children:["Use Inherited/Default (",(o==null?void 0:o.toFixed(2))??"N/A",")"]}),f.jsx(o0,{field:l})]})})]}),yW=Ke({syncRepoId:$e().nullable()}),fst=({initialSyncRepoId:e,onSave:t,effectiveSyncRepoId:n,syncRepos:r,isParentSaving:s=!1})=>{var o;const i=((o=r.find(l=>l.id===n))==null?void 0:o.name)??"None",a=ri({defaultValues:{syncRepoId:e??null},validators:{onChangeAsync:yW,onChangeAsyncDebounceMs:500},onSubmit:async({value:l})=>{await t(l)}});return T.useEffect(()=>{a.reset({syncRepoId:e??null})},[e,a]),f.jsxs("form",{onSubmit:l=>{l.preventDefault(),l.stopPropagation(),a.handleSubmit()},className:"space-y-6",children:[f.jsx(a.Field,{name:"syncRepoId",validators:{onChange:yW.shape.syncRepoId},children:l=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(It,{htmlFor:l.name,children:"Sync Repository (Overrides Parent/Global)"}),f.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Link this project to a sync repository. All new conversations created within this project will automatically inherit this link."}),f.jsxs(np,{value:l.state.value??"none",onValueChange:c=>{l.handleChange(c==="none"?null:c),l.handleBlur()},disabled:a.state.isSubmitting||s||r.length===0,children:[f.jsx(sp,{id:l.name,children:f.jsx(rp,{placeholder:r.length===0?"No sync repos configured":`Inherited: ${i}`})}),f.jsxs(ip,{children:[f.jsx(To,{value:"none",children:f.jsxs("span",{className:"text-muted-foreground",children:["Use Inherited/Default (",i,")"]})}),r.map(c=>f.jsx(To,{value:c.id,children:c.name},c.id))]})]}),f.jsx(Ni,{field:l}),f.jsx(ft,{variant:"link",size:"sm",className:"text-xs h-auto p-0 mt-1 text-muted-foreground",onClick:()=>a.setFieldValue("syncRepoId",null),disabled:a.state.isSubmitting||s||l.state.value===null,type:"button",children:"Use Inherited/Default"})]})}),f.jsx("div",{className:"flex justify-end pt-2",children:f.jsx(a.Subscribe,{selector:l=>[l.canSubmit,l.isSubmitting,l.isValidating,l.isValid],children:([l,c,u,d])=>f.jsxs(ft,{type:"submit",size:"sm",disabled:s||!l||c||u||!d||r.length===0,children:[(c||u)&&f.jsx(Qn,{className:"h-4 w-4 mr-1 animate-spin"}),f.jsx(Qd,{className:"h-4 w-4 mr-1"}),c||u?"Saving...":"Save Sync Settings"]})})})]})},hst=({projectId:e})=>{const t=T.useMemo(()=>[{value:"manage",label:"Manage Files",content:f.jsx("div",{className:"flex-grow border rounded-md overflow-hidden h-full",children:e?f.jsx(H5,{}):f.jsx("div",{className:"p-4 text-center text-muted-foreground",children:"Invalid Project ID. Cannot load filesystem."})})},{value:"settings",label:"Settings",content:f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx(It,{children:"Project Filesystem Info"}),f.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"Each project has its own dedicated Virtual File System (VFS)."}),f.jsxs("div",{className:"p-3 border rounded bg-muted/30 text-sm mb-2 break-all",children:[" ",f.jsxs("p",{children:[f.jsx("span",{className:"font-medium",children:"Project ID (VFS Key):"})," ",f.jsx("code",{className:"text-xs",children:e||"N/A"})]})]})]}),f.jsxs("div",{className:"border-t pt-4 border-destructive/50 mt-4 flex-shrink-0",children:[f.jsx(It,{className:"text-destructive",children:"Danger Zone"}),f.jsx("p",{className:"text-xs text-destructive/90 mb-2",children:"Clearing the VFS will permanently delete all files stored specifically for this project. This cannot be undone."})]})]})}],[e]);return f.jsx(sc,{tabs:t,defaultValue:"manage",className:"h-full flex flex-col",listClassName:Ze("bg-muted/50 rounded-md","flex-wrap justify-start h-auto","p-1 gap-1"),contentContainerClassName:"mt-3 flex-grow flex flex-col overflow-y-auto"})},pst=({allRules:e,selectedRuleIds:t,onSelectionChange:n,disabled:r=!1})=>{const[s,i]=T.useState(""),a=T.useMemo(()=>{const o=s.toLowerCase();return o?e.filter(l=>l.name.toLowerCase().includes(o)||l.content.toLowerCase().includes(o)||l.type.toLowerCase().includes(o)):e},[e,s]);return f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{className:"relative",children:[f.jsx(Fa,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),f.jsx(_n,{type:"search",placeholder:"Filter rules...",value:s,onChange:o=>i(o.target.value),className:"pl-8 h-9",disabled:r})]}),f.jsx(Lo,{className:"h-48 border rounded-md p-2 bg-background/50",children:a.length===0?f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:e.length===0?"No rules defined globally.":"No rules match filter."}):f.jsx("div",{className:"space-y-1",children:a.map(o=>f.jsx("div",{className:"flex items-start justify-between p-1.5 rounded hover:bg-muted",children:f.jsxs("div",{className:"flex items-center space-x-2 flex-grow mr-2",children:[f.jsx(Xl,{id:`project-default-rule-${o.id}`,checked:t.has(o.id),onCheckedChange:l=>n(o.id,!!l),className:"mt-0.5",disabled:r}),f.jsxs(It,{htmlFor:`project-default-rule-${o.id}`,className:"text-sm font-normal cursor-pointer space-y-0.5",children:[f.jsx("span",{className:"block font-medium",children:o.name}),f.jsxs("span",{className:"block text-xs text-muted-foreground",children:["Type: ",o.type]}),f.jsxs("span",{className:"block text-xs text-muted-foreground truncate max-w-xs",children:["Content: ",o.content]})]})]})},o.id))})})]})},mst=({defaultRuleIds:e,setDefaultRuleIds:t,isSaving:n,allRules:r})=>{const s=T.useMemo(()=>new Set(e??[]),[e]),i=T.useCallback((a,o)=>{const l=new Set(s);o?l.add(a):l.delete(a);const c=Array.from(l);t(c.length>0?c:null)},[s,t]);return f.jsxs("div",{className:"space-y-4",children:[f.jsx(It,{children:"Default Rules for this Project"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Select rules that will be automatically applied to new conversations within this project. These can be overridden per-conversation or per-turn."}),f.jsx(pst,{allRules:r,selectedRuleIds:s,onSelectionChange:i,disabled:n})]})},gst=({allTags:e,selectedTagIds:t,onSelectionChange:n,disabled:r=!1,getRulesForTag:s})=>{const[i,a]=T.useState(""),o=T.useMemo(()=>{const l=i.toLowerCase();return l?e.filter(c=>{var u;return c.name.toLowerCase().includes(l)||((u=c.description)==null?void 0:u.toLowerCase().includes(l))}):e},[e,i]);return f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{className:"relative",children:[f.jsx(Fa,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),f.jsx(_n,{type:"search",placeholder:"Filter tags...",value:i,onChange:l=>a(l.target.value),className:"pl-8 h-9",disabled:r})]}),f.jsx(Lo,{className:"h-48 border rounded-md p-2 bg-background/50",children:o.length===0?f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:e.length===0?"No tags defined globally.":"No tags match filter."}):f.jsx("div",{className:"space-y-1",children:o.map(l=>{const c=s(l.id);return f.jsx("div",{className:"flex items-start justify-between p-1.5 rounded hover:bg-muted",children:f.jsxs("div",{className:"flex items-center space-x-2 flex-grow mr-2",children:[f.jsx(Xl,{id:`project-default-tag-${l.id}`,checked:t.has(l.id),onCheckedChange:u=>n(l.id,!!u),className:"mt-0.5",disabled:r}),f.jsxs(It,{htmlFor:`project-default-tag-${l.id}`,className:"text-sm font-normal cursor-pointer space-y-0.5",children:[f.jsx("span",{className:"block font-medium",children:l.name}),l.description&&f.jsx("span",{className:"block text-xs text-muted-foreground",children:l.description}),c.length>0&&f.jsxs("span",{className:"block text-xs text-blue-500 dark:text-blue-400",children:["Includes: ",c.map(u=>u.name).join(", ")]})]})]})},l.id)})})})]})},yst=({defaultTagIds:e,setDefaultTagIds:t,isSaving:n,allTags:r,getRulesForTag:s})=>{const i=T.useMemo(()=>new Set(e??[]),[e]),a=T.useCallback((o,l)=>{const c=new Set(i);l?c.add(o):c.delete(o);const u=Array.from(c);t(u.length>0?u:null)},[i,t]);return f.jsxs("div",{className:"space-y-4",children:[f.jsx(It,{children:"Default Tags for this Project"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Select tags whose rules will be automatically applied to new conversations within this project. These can be overridden per-conversation or per-turn."}),f.jsx(gst,{allTags:r,selectedTagIds:i,onSelectionChange:a,disabled:n,getRulesForTag:s})]})},bst=Ke({temperature:Tt().min(0).max(1),topP:Tt().min(0).max(1),maxTokens:Tt().min(1).nullable(),topK:Tt().min(1).nullable(),presencePenalty:Tt().min(-2).max(2),frequencyPenalty:Tt().min(-2).max(2)}),vst=({isOpen:e,onClose:t,projectId:n,module:r})=>{const{getProjectById:s,updateProject:i}=Fo(yn(U=>({getProjectById:U.getProjectById,updateProject:U.updateProject}))),a=Fo(U=>U.getEffectiveProjectSettings),o=qn(U=>U.syncRepos),l=yr(yn(U=>({globalSystemPrompt:U.globalSystemPrompt,temperature:U.temperature,maxTokens:U.maxTokens,topP:U.topP,topK:U.topK,presencePenalty:U.presencePenalty,frequencyPenalty:U.frequencyPenalty}))),c=Nr(U=>U.selectedModelId),u=Js(U=>U.setVfsKey),[d,h]=T.useState(null),[m,y]=T.useState(null),[b,v]=T.useState(null),[x,w]=T.useState(null),[S,C]=T.useState(null),[k,A]=T.useState(!1),[R,N]=T.useState("prompt"),{project:I,effectiveSettings:P}=T.useMemo(()=>{const U=n?s(n):null,H=n?a(n):null;return{project:U,effectiveSettings:H}},[n,s,a]),L=ri({defaultValues:{temperature:(I==null?void 0:I.temperature)??.7,topP:(I==null?void 0:I.topP)??1,maxTokens:(I==null?void 0:I.maxTokens)??null,topK:(I==null?void 0:I.topK)??null,presencePenalty:(I==null?void 0:I.presencePenalty)??0,frequencyPenalty:(I==null?void 0:I.presencePenalty)??0},validators:{onChangeAsync:bst,onChangeAsyncDebounceMs:500}}),O=T.useCallback(U=>{var $;if(!U)return null;const H=s(U);return H?(($=H.metadata)==null?void 0:$.syncRepoId)!==void 0?H.metadata.syncRepoId:O(H.parentId):null},[s]),V=n?O(n):null;T.useEffect(()=>{var U;e&&n&&I&&P?(u(n),h(I.systemPrompt??null),y(I.modelId??null),v(((U=I.metadata)==null?void 0:U.syncRepoId)??null),w(I.defaultTagIds??null),C(I.defaultRuleIds??null),L.reset({temperature:I.temperature??.7,topP:I.topP??1,maxTokens:I.maxTokens??null,topK:I.topK??null,presencePenalty:I.presencePenalty??0,frequencyPenalty:I.frequencyPenalty??0}),N("prompt")):e||(u(null),h(null),y(null),v(null),w(null),C(null),L.reset({temperature:.7,topP:1,maxTokens:null,topK:null,presencePenalty:0,frequencyPenalty:0}))},[e,n,I,P,u,L]);const D=async()=>{if(!(!n||!I)){A(!0);try{const U=I.parentId?a(I.parentId):{systemPrompt:l.globalSystemPrompt,modelId:c,temperature:l.temperature,maxTokens:l.maxTokens,topP:l.topP,topK:l.topK,presencePenalty:l.presencePenalty,frequencyPenalty:l.frequencyPenalty,defaultTagIds:null,defaultRuleIds:null},H=I.parentId?O(I.parentId):null,$={},ne={...I.metadata??{}},W=L.state.values;d!==U.systemPrompt?$.systemPrompt=d:$.systemPrompt=void 0,m!==U.modelId?$.modelId=m:$.modelId=void 0,W.temperature!==U.temperature?$.temperature=W.temperature:$.temperature=void 0,W.maxTokens!==U.maxTokens?$.maxTokens=W.maxTokens:$.maxTokens=void 0,W.topP!==U.topP?$.topP=W.topP:$.topP=void 0,W.topK!==U.topK?$.topK=W.topK:$.topK=void 0,W.presencePenalty!==U.presencePenalty?$.presencePenalty=W.presencePenalty:$.presencePenalty=void 0,W.frequencyPenalty!==U.frequencyPenalty?$.frequencyPenalty=W.frequencyPenalty:$.frequencyPenalty=void 0,b!==H?ne.syncRepoId=b:delete ne.syncRepoId,JSON.stringify(x)!==JSON.stringify(U.defaultTagIds)?$.defaultTagIds=x:$.defaultTagIds=void 0,JSON.stringify(S)!==JSON.stringify(U.defaultRuleIds)?$.defaultRuleIds=S:$.defaultRuleIds=void 0,$.metadata=ne,await i(n,$),je.success(`Project "${I.name}" settings updated.`),t()}catch(U){je.error("Failed to save project settings."),console.error("Failed to save project settings:",U)}finally{A(!1)}}},Z=T.useMemo(()=>[{value:"prompt",label:"Prompt & Model",content:f.jsx(ust,{initialSystemPrompt:d,initialModelId:m,onSave:({systemPrompt:U,modelId:H})=>{h(U),y(H)},effectiveSystemPrompt:(P==null?void 0:P.systemPrompt)??l.globalSystemPrompt,effectiveModelId:(P==null?void 0:P.modelId)??c,isParentSaving:k})},{value:"params",label:"Parameters",content:f.jsx(dst,{form:L,effectiveTemperature:(P==null?void 0:P.temperature)??l.temperature,effectiveMaxTokens:(P==null?void 0:P.maxTokens)??l.maxTokens,effectiveTopP:(P==null?void 0:P.topP)??l.topP??1,effectiveTopK:(P==null?void 0:P.topK)??l.topK,effectivePresencePenalty:(P==null?void 0:P.presencePenalty)??l.presencePenalty??0,effectiveFrequencyPenalty:(P==null?void 0:P.frequencyPenalty)??l.frequencyPenalty??0,isSaving:k})},{value:"rules-tags",label:"Rules & Tags",content:f.jsxs("div",{className:"space-y-6",children:[f.jsx(mst,{defaultRuleIds:S,setDefaultRuleIds:C,isSaving:k,allRules:r.getAllRules()}),f.jsx(yst,{defaultTagIds:x,setDefaultTagIds:w,isSaving:k,allTags:r.getAllTags(),getRulesForTag:r.getRulesForTag})]})},{value:"sync",label:"Sync",content:f.jsx(fst,{initialSyncRepoId:b,onSave:({syncRepoId:U})=>{v(U)},effectiveSyncRepoId:V,syncRepos:o,isParentSaving:k})},{value:"vfs",label:"Filesystem",content:f.jsx(hst,{projectId:n,projectName:(I==null?void 0:I.name)??null,isSaving:k})}],[d,m,b,x,S,L,P,l,c,k,V,o,n,I==null?void 0:I.name,r]);return f.jsx(lp,{open:e,onOpenChange:t,children:f.jsxs(cp,{className:Ze("w-[95vw] h-[85vh] flex flex-col p-0","sm:w-[90vw] sm:max-w-[800px]","md:h-[75vh]","min-h-[500px] max-h-[90vh]"),children:[f.jsxs(up,{className:"p-4 md:p-6 pb-2 md:pb-4 flex-shrink-0",children:[f.jsxs(dp,{children:["Project Settings: ",I==null?void 0:I.name]}),f.jsx(ng,{children:"Configure default settings for this project. Settings inherit from parent projects or global defaults if not set here."})]}),f.jsx(sc,{tabs:Z,initialValue:R,onValueChange:N,className:"flex-grow overflow-hidden px-4 md:px-6",listClassName:"-mx-4 md:-mx-6 px-2 md:px-6 py-1 md:py-0",contentContainerClassName:"pb-4 md:pb-6 overflow-y-auto",scrollable:!1}),f.jsxs(pb,{className:"flex-shrink-0 border-t p-4 md:p-6 pt-3 md:pt-4 mt-auto",children:[f.jsx(ft,{variant:"outline",onClick:t,disabled:k,children:"Cancel"}),f.jsxs(ft,{onClick:D,disabled:k,children:[k&&f.jsx(Qn,{className:"mr-2 h-4 w-4 animate-spin"}),"Save Project Settings"]})]})]})})};class xst{constructor(){me(this,"id","core-project-settings");me(this,"modalId","projectSettingsModal");me(this,"unregisterModalProviderCallback",null);me(this,"modApiRef",null);me(this,"eventUnsubscribers",[]);me(this,"allRules",[]);me(this,"allTags",[]);me(this,"tagRuleLinks",[]);me(this,"getAllRules",()=>this.allRules);me(this,"getAllTags",()=>this.allTags);me(this,"getRulesForTag",t=>{const n=new Set(this.tagRuleLinks.filter(r=>r.tagId===t).map(r=>r.ruleId));return this.allRules.filter(r=>n.has(r.id))});me(this,"openModal",(t,n)=>{var r;(r=this.modApiRef)==null||r.emit(Pr.openModalRequest,{modalId:this.modalId,targetId:t,initialTab:n})});me(this,"closeModal",()=>{var t;(t=this.modApiRef)==null||t.emit(Pr.closeModalRequest,{modalId:this.modalId})})}async initialize(t){this.modApiRef=t;const n=t.on(gr.dataLoaded,r=>{r&&(this.allRules=r.rules||[],this.allTags=r.tags||[],this.tagRuleLinks=(r.links||[]).map(s=>({tagId:s.tagId,ruleId:s.ruleId})))});this.eventUnsubscribers.push(n),t.emit(gr.loadRulesAndTagsRequest,void 0),console.log(`[${this.id}] Initialized.`)}register(t){if(this.modApiRef=t,this.unregisterModalProviderCallback){console.warn(`[${this.id}] Modal provider already registered. Skipping.`);return}this.unregisterModalProviderCallback=t.registerModalProvider(this.modalId,n=>We.createElement(vst,{isOpen:n.isOpen,onClose:n.onClose,projectId:n.targetId||null,module:this})),console.log(`[${this.id}] Modal provider registered for ${this.modalId}.`)}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterModalProviderCallback&&(this.unregisterModalProviderCallback(),this.unregisterModalProviderCallback=null),this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const Y5=We.memo(({module:e,value:t,onChange:n,className:r,disabled:s})=>{const[,i]=T.useState({});T.useEffect(()=>{if(e)return e.setNotifyCallback(()=>i({})),()=>e.setNotifyCallback(null)},[e]);const a=!!e,o=a?e.selectedModelId:t,l=a?e.isStreaming:s,c=a?e.isLoadingProviders:!1,u=a?e.globallyEnabledModels:Nr(h=>h.getGloballyEnabledModelDefinitions()),d=T.useCallback(h=>{a&&e?e.handleSelectionChange(h):n&&n(h)},[a,e,n]);return f.jsx(K5,{models:u,value:o,onChange:d,className:r,disabled:l,isLoading:c})});Y5.displayName="GlobalModelSelector";class wst{constructor(){me(this,"id","core-global-model-selector");me(this,"unregisterCallback",null);me(this,"eventUnsubscribers",[]);me(this,"modApiRef",null);me(this,"selectedModelId",null);me(this,"isStreaming",!1);me(this,"isLoadingProviders",!0);me(this,"globallyEnabledModels",[]);me(this,"notifyComponentUpdate",null);me(this,"handleSelectionChange",t=>{var n,r;(n=this.modApiRef)==null||n.emit(dr.selectModelRequest,{modelId:t}),(r=this.modApiRef)==null||r.emit(Nn.setModelIdRequest,{id:t})});me(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){this.modApiRef=t;const n=Nr.getState();this.isLoadingProviders=n.isLoading,this.selectedModelId=n.selectedModelId,this.isStreaming=$n.getState().status==="streaming",this.isLoadingProviders||(this.globallyEnabledModels=n.getGloballyEnabledModelDefinitions());const r=t.on(Zn.statusChanged,o=>{var l;if(typeof o=="object"&&o&&"status"in o){const c=o.status==="streaming";this.isStreaming!==c&&(this.isStreaming=c,(l=this.notifyComponentUpdate)==null||l.call(this))}}),s=t.on(dr.selectedModelChanged,o=>{var l,c;typeof o=="object"&&o&&"modelId"in o&&this.selectedModelId!==o.modelId&&(this.selectedModelId=o.modelId,(l=this.modApiRef)==null||l.emit(Nn.setModelIdRequest,{id:o.modelId}),(c=this.notifyComponentUpdate)==null||c.call(this))}),i=t.on(dr.globallyEnabledModelsUpdated,o=>{var d,h;let l=!1;JSON.stringify(this.globallyEnabledModels)!==JSON.stringify(o.models)&&(this.globallyEnabledModels=o.models,l=!0);const c=Nr.getState().isLoading;this.isLoadingProviders!==c&&(this.isLoadingProviders=c,l=!0);const u=Nr.getState().selectedModelId;this.selectedModelId!==u&&(this.selectedModelId=u,(d=this.modApiRef)==null||d.emit(Nn.setModelIdRequest,{id:this.selectedModelId}),l=!0),l&&((h=this.notifyComponentUpdate)==null||h.call(this))}),a=t.on(dr.initialDataLoaded,()=>{var u,d;const o=Nr.getState();let l=!1;this.isLoadingProviders!==o.isLoading&&(this.isLoadingProviders=o.isLoading,l=!0),this.selectedModelId!==o.selectedModelId&&(this.selectedModelId=o.selectedModelId,(u=this.modApiRef)==null||u.emit(Nn.setModelIdRequest,{id:this.selectedModelId}),l=!0);const c=o.getGloballyEnabledModelDefinitions();JSON.stringify(this.globallyEnabledModels)!==JSON.stringify(c)&&(this.globallyEnabledModels=c,l=!0),l&&((d=this.notifyComponentUpdate)==null||d.call(this))});this.eventUnsubscribers.push(r,s,i,a)}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>this.isLoadingProviders?"loading":"ready",triggerRenderer:()=>We.createElement(Y5,{module:this})})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const _st=({module:e})=>{const[,t]=T.useState({});T.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const[n,r]=T.useState(!1),[s,i]=T.useState(e.getTurnSystemPrompt()),a=e.getEffectiveSystemPrompt(),o=e.getIsStreaming(),l=e.getTurnSystemPrompt();T.useEffect(()=>{n&&i(e.getTurnSystemPrompt())},[n,e]),T.useEffect(()=>{const m=e.getTurnSystemPrompt();s!==m&&i(m)},[e.getTurnSystemPrompt(),s]);const c=T.useCallback(()=>{e.setTurnSystemPrompt(s.trim()),r(!1)},[s,e]),u=T.useCallback(()=>{i(""),e.setTurnSystemPrompt(""),r(!1)},[e]),d=m=>{m&&i(e.getTurnSystemPrompt()),r(m)},h=l.trim().length>0;return f.jsxs(vl,{open:n,onOpenChange:d,children:[f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(xl,{asChild:!0,children:f.jsx(ft,{variant:h?"secondary":"ghost",size:"icon",className:"h-8 w-8",disabled:o,"aria-label":"Set System Prompt for Next Turn",children:f.jsx(Ige,{className:"h-4 w-4"})})})}),f.jsx(Sr,{side:"top",children:h?"System Prompt Override Active":"Set System Prompt (Next Turn)"})]})}),f.jsxs(wl,{className:"w-80 p-4 space-y-3",align:"start",children:[f.jsx(It,{htmlFor:"turn-system-prompt",children:"System Prompt (Overrides Project/Global for Next Turn)"}),f.jsx(Bo,{id:"turn-system-prompt",placeholder:`Inherited: ${(a==null?void 0:a.substring(0,50))||"Default"}${a&&a.length>50?"...":""}`,value:s,onChange:m=>i(m.target.value),rows:5,className:"text-sm"}),f.jsxs("div",{className:"flex justify-between",children:[f.jsx(ft,{variant:"outline",size:"sm",onClick:u,disabled:!s.trim(),children:"Clear Override"}),f.jsx(ft,{size:"sm",onClick:c,children:"Set for Next Turn"})]})]})]})};class Sst{constructor(){me(this,"id","core-system-prompt");me(this,"unregisterCallback",null);me(this,"eventUnsubscribers",[]);me(this,"modApiRef",null);me(this,"turnSystemPromptValue","");me(this,"effectiveSystemPrompt",null);me(this,"isStreaming",!1);me(this,"notifyComponentUpdate",null);me(this,"getTurnSystemPrompt",()=>this.turnSystemPromptValue);me(this,"getEffectiveSystemPrompt",()=>this.effectiveSystemPrompt);me(this,"getIsStreaming",()=>this.isStreaming);me(this,"setTurnSystemPrompt",t=>{var n;this.turnSystemPromptValue!==t&&(this.turnSystemPromptValue=t,(n=this.notifyComponentUpdate)==null||n.call(this))});me(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){this.modApiRef=t,this.isStreaming=$n.getState().status==="streaming",this.updateEffectivePrompt();const n=t.on(Zn.statusChanged,a=>{var o;typeof a=="object"&&a&&"status"in a&&this.isStreaming!==(a.status==="streaming")&&(this.isStreaming=a.status==="streaming",(o=this.notifyComponentUpdate)==null||o.call(this))}),r=t.on(Pr.contextChanged,()=>{var a;this.updateEffectivePrompt(),(a=this.notifyComponentUpdate)==null||a.call(this)}),s=t.on(va.updated,()=>{var a;this.updateEffectivePrompt(),(a=this.notifyComponentUpdate)==null||a.call(this)}),i=t.on(sn.globalSystemPromptChanged,()=>{var a;this.updateEffectivePrompt(),(a=this.notifyComponentUpdate)==null||a.call(this)});this.eventUnsubscribers.push(n,r,s,i)}updateEffectivePrompt(){var a;const t=qn.getState(),n=Fo.getState(),r=yr.getState(),s=t.selectedItemType==="project"?t.selectedItemId:t.selectedItemType==="conversation"?((a=t.getConversationById(t.selectedItemId))==null?void 0:a.projectId)??null:null,i=n.getEffectiveProjectSettings(s).systemPrompt??r.globalSystemPrompt;this.effectiveSystemPrompt!==i&&(this.effectiveSystemPrompt=i)}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>We.createElement(_st,{module:this}),getMetadata:()=>{const n=this.turnSystemPromptValue.trim();return n?{turnSystemPrompt:n}:void 0},clearOnSubmit:()=>{var n;this.turnSystemPromptValue!==""&&(this.turnSystemPromptValue="",(n=this.notifyComponentUpdate)==null||n.call(this))}})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const Cst=({module:e})=>{const[,t]=T.useState({});T.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const n=e.getStructuredOutputJson(),[r,s]=T.useState(!1),[i,a]=T.useState(n??""),[o,l]=T.useState(""),[c,u]=T.useState([]),d=T.useCallback(()=>{try{JSON.parse(i),e.setStructuredOutputJson(i.trim()||null),s(!1),je.success("Structured output applied for next turn.")}catch{je.error("Invalid JSON format.")}},[i,e]),h=T.useCallback(()=>{a(""),e.setStructuredOutputJson(null),s(!1),je.info("Structured output cleared.")},[e]),m=T.useCallback(()=>{if(!o.trim()){je.error("Please provide a name to save to the library.");return}try{JSON.parse(i);const w={id:Date.now().toString(),name:o.trim(),json:i};u(S=>[...S,w]),l(""),je.success(`"${w.name}" saved to library.`)}catch{je.error("Cannot save invalid JSON to library.")}},[i,o]),y=T.useCallback(w=>{a(w.json),e.setStructuredOutputJson(w.json),s(!1),je.success(`Loaded "${w.name}" from library.`)},[e]),b=T.useCallback(w=>{u(S=>S.filter(C=>C.id!==w)),je.info("Item removed from library.")},[]);T.useEffect(()=>{r&&a(e.getStructuredOutputJson()??"")},[r,e]);const v=[{value:"entry",label:"Entry",content:f.jsxs("div",{className:"space-y-3 p-1",children:[f.jsx(It,{htmlFor:"structured-output-entry",children:"JSON Output Schema"}),f.jsx(Bo,{id:"structured-output-entry",placeholder:'e.g., {"type": "object", "properties": {"name": {"type": "string"}}}',value:i,onChange:w=>a(w.target.value),rows:8,className:"font-mono text-xs"}),f.jsxs("div",{className:"flex justify-between items-end gap-2",children:[f.jsxs("div",{className:"flex-grow space-y-1",children:[f.jsx(It,{htmlFor:"structured-output-name",className:"text-xs",children:"Save to Library (Optional Name)"}),f.jsx(_n,{id:"structured-output-name",value:o,onChange:w=>l(w.target.value),placeholder:"Schema Name",className:"h-8 text-xs"})]}),f.jsxs(ft,{size:"sm",variant:"outline",onClick:m,disabled:!o.trim()||!i.trim(),className:"h-8",children:[f.jsx(Qd,{className:"h-3.5 w-3.5 mr-1"})," Save"]})]}),f.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[f.jsx(ft,{variant:"outline",size:"sm",onClick:h,disabled:!n,children:"Clear Applied Schema"}),f.jsx(ft,{size:"sm",onClick:d,disabled:!i,children:"Apply for Next Turn"})]})]})},{value:"library",label:"Library",content:f.jsx("div",{className:"space-y-2 p-1",children:c.length===0?f.jsx("p",{className:"text-xs text-muted-foreground text-center py-4",children:"No saved schemas yet."}):c.map(w=>f.jsxs("div",{className:"flex items-center justify-between p-2 border rounded hover:bg-muted/50",children:[f.jsx("span",{className:"text-sm font-medium truncate flex-grow mr-2",children:w.name}),f.jsxs("div",{className:"flex gap-1 flex-shrink-0",children:[f.jsx(ft,{size:"sm",variant:"outline",onClick:()=>y(w),className:"h-7 px-2 text-xs",children:"Use"}),f.jsx(ft,{size:"icon",variant:"ghost",onClick:()=>b(w.id),className:"h-7 w-7 text-destructive",children:f.jsx(Ao,{className:"h-3.5 w-3.5"})})]})]},w.id))})}],x=!!n;return f.jsxs(vl,{open:r,onOpenChange:s,children:[f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(xl,{asChild:!0,children:f.jsx(ft,{variant:x?"secondary":"ghost",size:"icon",className:"h-8 w-8","aria-label":"Set Structured Output",children:f.jsx(lH,{className:"h-4 w-4"})})})}),f.jsx(Sr,{side:"top",children:x?"Structured Output Active":"Set Structured Output (JSON Schema)"})]})}),f.jsx(wl,{className:"w-[450px] p-0",align:"start",children:f.jsx(sc,{tabs:v,defaultValue:"entry"})})]})},kst=({module:e})=>{const[,t]=T.useState({});return T.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]),e.getIsVisible()?f.jsx(Cst,{module:e}):null};class Est{constructor(){me(this,"id","core-structured-output");me(this,"unregisterCallback",null);me(this,"eventUnsubscribers",[]);me(this,"modApiRef",null);me(this,"structuredOutputJson",null);me(this,"isVisible",!0);me(this,"notifyComponentUpdate",null);me(this,"getStructuredOutputJson",()=>this.structuredOutputJson);me(this,"getIsVisible",()=>this.isVisible);me(this,"setStructuredOutputJson",t=>{var n,r;this.structuredOutputJson=t,(n=this.modApiRef)==null||n.emit(Nn.setStructuredOutputJsonRequest,{json:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});me(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){var s;this.modApiRef=t,this.structuredOutputJson=Po.getState().structuredOutputJson,this.updateVisibility(),(s=this.notifyComponentUpdate)==null||s.call(this);const n=t.on(dr.selectedModelChanged,()=>{var i;this.updateVisibility(),(i=this.notifyComponentUpdate)==null||i.call(this)}),r=t.on(Nn.parameterChanged,i=>{var a;if(typeof i=="object"&&i&&"params"in i){const o=i.params;"structuredOutputJson"in o&&this.structuredOutputJson!==(o.structuredOutputJson??null)&&(this.structuredOutputJson=o.structuredOutputJson??null,(a=this.notifyComponentUpdate)==null||a.call(this))}});this.eventUnsubscribers.push(n,r)}updateVisibility(){var i;const{getSelectedModel:t}=Nr.getState(),n=t(),r=(i=n==null?void 0:n.metadata)==null?void 0:i.supported_parameters,s=Array.isArray(r)&&r.includes("structured_output");this.isVisible!==s&&(this.isVisible=s)}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>We.createElement(kst,{module:this}),getParameters:()=>{if(this.structuredOutputJson)try{return{structured_output:JSON.parse(this.structuredOutputJson)}}catch(n){console.error("Invalid JSON in structured output state:",n);return}},clearOnSubmit:()=>{var n;(n=this.modApiRef)==null||n.emit(Nn.setStructuredOutputJsonRequest,{json:null})}})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const Tst=({module:e})=>{const[,t]=T.useState({});T.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const n=e.contextLength,r=e.getEstimatedInputTokens(),s=e.getTotalEstimatedTokens(),i=e.getContextPercentage(),a=e.historyTokens,o=e.selectedModelId,l=T.useMemo(()=>i>85?"text-red-600 dark:text-red-500":i>70?"text-orange-500 dark:text-orange-400":i>40?"text-yellow-500 dark:text-yellow-400":"text-green-600 dark:text-green-500",[i]);if(!(o!==null&&n>0))return null;const u=`Context: ~${s.toLocaleString()} / ${n.toLocaleString()} tokens (${i}%) [History: ${a}, Input: ${r}]`;return f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx("div",{className:"flex items-center justify-center h-8 w-8 px-2",children:f.jsx(Ppe,{className:Ze("h-3 w-3 fill-current",l)})})}),f.jsx(Sr,{side:"top",children:u})]})})},Yue=4,Ast=e=>{let t=0;return e.forEach(n=>{var r,s,i,a;(r=n.prompt)!=null&&r.content&&(t+=new TextEncoder().encode(n.prompt.content).length),(a=(i=(s=n.prompt)==null?void 0:s.metadata)==null?void 0:i.attachedFiles)==null||a.forEach(o=>{t+=o.size}),n.response&&typeof n.response=="string"&&(t+=new TextEncoder().encode(n.response).length)}),Math.ceil(t/Yue)};class Rst{constructor(){me(this,"id","core-usage-display");me(this,"unregisterCallback",null);me(this,"eventUnsubscribers",[]);me(this,"currentInputText","");me(this,"historyTokens",0);me(this,"attachedFiles",[]);me(this,"selectedModelId",null);me(this,"contextLength",0);me(this,"notifyComponentUpdate",null);me(this,"getEstimatedInputTokens",()=>{const t=new TextEncoder().encode(this.currentInputText).length,n=this.attachedFiles.reduce((r,s)=>r+s.size,0);return Math.ceil((t+n)/Yue)});me(this,"getTotalEstimatedTokens",()=>this.historyTokens+this.getEstimatedInputTokens());me(this,"getContextPercentage",()=>this.contextLength?Math.min(100,Math.round(this.getTotalEstimatedTokens()/this.contextLength*100)):0);me(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){this.loadInitialState(),this.updateContextLength();const n=t.on(Nn.inputChanged,o=>{var l;typeof o=="object"&&o&&"value"in o&&(this.currentInputText=o.value,(l=this.notifyComponentUpdate)==null||l.call(this))}),r=t.on(ql.attachedFilesChanged,o=>{var l;typeof o=="object"&&o&&"files"in o&&(this.attachedFiles=o.files,(l=this.notifyComponentUpdate)==null||l.call(this))}),s=t.on(dr.selectedModelChanged,o=>{var l;typeof o=="object"&&o&&"modelId"in o&&(this.selectedModelId=o.modelId,this.updateContextLength(),(l=this.notifyComponentUpdate)==null||l.call(this))}),i=t.on(Zn.completed,()=>{var o;this.updateHistoryTokens(),(o=this.notifyComponentUpdate)==null||o.call(this)}),a=t.on(Pr.contextChanged,()=>{var o;this.updateHistoryTokens(),(o=this.notifyComponentUpdate)==null||o.call(this)});this.eventUnsubscribers.push(n,r,s,i,a),console.log(`[${this.id}] Initialized.`)}loadInitialState(){const t=mh.getState(),n=Nr.getState();this.attachedFiles=t.attachedFilesMetadata,this.selectedModelId=n.selectedModelId,this.updateHistoryTokens()}updateHistoryTokens(){const t=$n.getState();if(t.currentConversationId){const n=t.interactions.filter(r=>r.status==="COMPLETED");this.historyTokens=Ast(n)}else this.historyTokens=0}updateContextLength(){var c;if(!this.selectedModelId){this.contextLength=0;return}const{dbProviderConfigs:t,dbApiKeys:n}=Nr.getState(),{providerId:r,modelId:s}=Cc(this.selectedModelId);if(!r||!s){this.contextLength=0;return}const i=t.find(u=>u.id===r);if(!i){this.contextLength=0;return}const a=n.find(u=>u.id===i.apiKeyId),o=TG(i,s,a==null?void 0:a.value),l=o==null?void 0:o.metadata;this.contextLength=((c=l==null?void 0:l.top_provider)==null?void 0:c.context_length)??(l==null?void 0:l.context_length)??0}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>We.createElement(Tst,{module:this})}),console.log(`[${this.id}] Registered.`)}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,console.log(`[${this.id}] Destroyed.`)}}const Nst=({module:e})=>{const[,t]=T.useState({});T.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const n=e.getReasoningEnabled(),r=e.getIsStreaming(),s=e.getIsVisible(),i=n===!0,a=T.useCallback(()=>{const o=i?null:!0;e.setReasoningEnabled(o)},[i,e]);return s?f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(ft,{variant:i?"secondary":"ghost",size:"icon",className:"h-8 w-8",onClick:a,disabled:r,"aria-label":i?"Disable Reasoning for Next Turn":"Enable Reasoning for Next Turn",children:f.jsx(Fh,{className:Ze("h-4 w-4",i?"text-primary":"text-muted-foreground")})})}),f.jsx(Sr,{side:"top",children:i?"Reasoning Enabled (Click to Disable)":"Reasoning Disabled (Click to Enable)"})]})}):null};class Mst{constructor(){me(this,"id","core-reasoning");me(this,"unregisterCallback",null);me(this,"eventUnsubscribers",[]);me(this,"modApiRef",null);me(this,"reasoningEnabled",null);me(this,"isStreaming",!1);me(this,"isVisible",!0);me(this,"notifyComponentUpdate",null);me(this,"getReasoningEnabled",()=>this.reasoningEnabled);me(this,"getIsStreaming",()=>this.isStreaming);me(this,"getIsVisible",()=>this.isVisible);me(this,"setReasoningEnabled",t=>{var n,r;this.reasoningEnabled=t,(n=this.modApiRef)==null||n.emit(Nn.setReasoningEnabledRequest,{enabled:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});me(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){var i;this.modApiRef=t,this.reasoningEnabled=Po.getState().reasoningEnabled,this.isStreaming=$n.getState().status==="streaming",this.updateVisibility(),(i=this.notifyComponentUpdate)==null||i.call(this);const n=t.on(Zn.statusChanged,a=>{var o;typeof a=="object"&&a&&"status"in a&&this.isStreaming!==(a.status==="streaming")&&(this.isStreaming=a.status==="streaming",(o=this.notifyComponentUpdate)==null||o.call(this))}),r=t.on(dr.selectedModelChanged,()=>{var a;this.updateVisibility(),(a=this.notifyComponentUpdate)==null||a.call(this)}),s=t.on(Nn.parameterChanged,a=>{var o;if(typeof a=="object"&&a&&"params"in a){const l=a.params;"reasoningEnabled"in l&&this.reasoningEnabled!==l.reasoningEnabled&&(this.reasoningEnabled=l.reasoningEnabled??null,(o=this.notifyComponentUpdate)==null||o.call(this))}});this.eventUnsubscribers.push(n,r,s)}updateVisibility(){var s,i;const{getSelectedModel:t}=Nr.getState(),n=t(),r=((i=(s=n==null?void 0:n.metadata)==null?void 0:s.supported_parameters)==null?void 0:i.includes("reasoning"))??!1;this.isVisible!==r&&(this.isVisible=r)}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>We.createElement(Nst,{module:this}),getMetadata:()=>this.reasoningEnabled===!0?{reasoningEnabled:!0}:void 0,clearOnSubmit:()=>{var n;(n=this.modApiRef)==null||n.emit(Nn.setReasoningEnabledRequest,{enabled:null})}})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const Ist=({module:e})=>{const[,t]=T.useState({});T.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const n=e.getWebSearchEnabled(),r=e.getIsStreaming(),s=e.getIsVisible(),i=n===!0,a=T.useCallback(()=>{const o=i?null:!0;e.setWebSearchEnabled(o)},[i,e]);return s?f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(ft,{variant:i?"secondary":"ghost",size:"icon",className:"h-8 w-8",onClick:a,disabled:r,"aria-label":i?"Disable Web Search for Next Turn":"Enable Web Search for Next Turn",children:f.jsx(Fa,{className:Ze("h-4 w-4",i?"text-primary":"text-muted-foreground")})})}),f.jsx(Sr,{side:"top",children:i?"Web Search Enabled (Click to Disable)":"Web Search Disabled (Click to Enable)"})]})}):null};class jst{constructor(){me(this,"id","core-web-search");me(this,"unregisterCallback",null);me(this,"eventUnsubscribers",[]);me(this,"modApiRef",null);me(this,"webSearchEnabled",null);me(this,"isStreaming",!1);me(this,"isVisible",!0);me(this,"notifyComponentUpdate",null);me(this,"getWebSearchEnabled",()=>this.webSearchEnabled);me(this,"getIsStreaming",()=>this.isStreaming);me(this,"getIsVisible",()=>this.isVisible);me(this,"setWebSearchEnabled",t=>{var n,r;this.webSearchEnabled=t,(n=this.modApiRef)==null||n.emit(Nn.setWebSearchEnabledRequest,{enabled:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});me(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){var i;this.modApiRef=t,this.webSearchEnabled=Po.getState().webSearchEnabled,this.isStreaming=$n.getState().status==="streaming",this.updateVisibility(),(i=this.notifyComponentUpdate)==null||i.call(this);const n=t.on(Zn.statusChanged,a=>{var o;typeof a=="object"&&a&&"status"in a&&this.isStreaming!==(a.status==="streaming")&&(this.isStreaming=a.status==="streaming",(o=this.notifyComponentUpdate)==null||o.call(this))}),r=t.on(dr.selectedModelChanged,()=>{var a;this.updateVisibility(),(a=this.notifyComponentUpdate)==null||a.call(this)}),s=t.on(Nn.parameterChanged,a=>{var o;if(typeof a=="object"&&a&&"params"in a){const l=a.params;"webSearchEnabled"in l&&this.webSearchEnabled!==l.webSearchEnabled&&(this.webSearchEnabled=l.webSearchEnabled??null,(o=this.notifyComponentUpdate)==null||o.call(this))}});this.eventUnsubscribers.push(n,r,s)}updateVisibility(){var i;const{getSelectedModel:t}=Nr.getState(),n=t(),r=((i=n==null?void 0:n.metadata)==null?void 0:i.supported_parameters)??[],s=r.includes("web_search")||r.includes("web_search_options");this.isVisible!==s&&(this.isVisible=s)}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>We.createElement(Ist,{module:this}),getParameters:()=>this.webSearchEnabled===!0?{web_search:!0}:void 0,clearOnSubmit:()=>{var n;(n=this.modApiRef)==null||n.emit(Nn.setWebSearchEnabledRequest,{enabled:null})}})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const Zue=({activeTagIds:e,activeRuleIds:t,onToggleTag:n,onToggleRule:r,allRules:s,allTags:i,getRulesForTag:a})=>{const[o,l]=T.useState(""),[c,u]=T.useState(""),d=T.useMemo(()=>{const w=o.toLowerCase();return w?i.filter(S=>{var C;return S.name.toLowerCase().includes(w)||((C=S.description)==null?void 0:C.toLowerCase().includes(w))}):i},[i,o]),h=T.useMemo(()=>{const w=c.toLowerCase();return w?s.filter(S=>S.name.toLowerCase().includes(w)||S.content.toLowerCase().includes(w)||S.type.toLowerCase().includes(w)):s},[s,c]),m=T.useCallback((w,S)=>{n(w,S)},[n]),y=T.useCallback((w,S)=>{r(w,S)},[r]),b=()=>f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{className:"relative",children:[f.jsx(Fa,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),f.jsx(_n,{type:"search",placeholder:"Filter tags...",value:o,onChange:w=>l(w.target.value),className:"pl-8 h-9"})]}),f.jsx("div",{className:"border rounded-md p-2 bg-background/50",children:d.length===0?f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:i.length===0?"No tags defined.":"No tags match filter."}):f.jsx("div",{className:"space-y-1",children:d.map(w=>{const S=a(w.id);return f.jsx("div",{className:"flex items-start justify-between p-1.5 rounded hover:bg-muted",children:f.jsxs("div",{className:"flex items-center space-x-2 flex-grow mr-2",children:[f.jsx(Xl,{id:`tag-activate-${w.id}`,checked:e.has(w.id),onCheckedChange:C=>m(w.id,!!C),className:"mt-0.5"}),f.jsxs(It,{htmlFor:`tag-activate-${w.id}`,className:"text-sm font-normal cursor-pointer space-y-0.5",children:[f.jsx("span",{className:"block font-medium",children:w.name}),w.description&&f.jsx("span",{className:"block text-xs text-muted-foreground",children:w.description}),S.length>0&&f.jsxs("span",{className:"block text-xs text-blue-500 dark:text-blue-400",children:["Includes: ",S.map(C=>C.name).join(", ")]})]})]})},w.id)})})})]}),v=()=>f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{className:"relative",children:[f.jsx(Fa,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),f.jsx(_n,{type:"search",placeholder:"Filter rules...",value:c,onChange:w=>u(w.target.value),className:"pl-8 h-9"})]}),f.jsx("div",{className:"border rounded-md p-2 bg-background/50",children:h.length===0?f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:s.length===0?"No rules defined.":"No rules match filter."}):f.jsx("div",{className:"space-y-1",children:h.map(w=>f.jsx("div",{className:"flex items-start justify-between p-1.5 rounded hover:bg-muted",children:f.jsxs("div",{className:"flex items-center space-x-2 flex-grow mr-2",children:[f.jsx(Xl,{id:`rule-activate-${w.id}`,checked:t.has(w.id),onCheckedChange:S=>y(w.id,!!S),className:"mt-0.5"}),f.jsxs(It,{htmlFor:`rule-activate-${w.id}`,className:"text-sm font-normal cursor-pointer space-y-0.5",children:[f.jsx("span",{className:"block font-medium",children:w.name}),f.jsxs("span",{className:"block text-xs text-muted-foreground",children:["Type: ",w.type]}),f.jsxs("span",{className:"block text-xs text-muted-foreground truncate max-w-xs",children:["Content: ",w.content]})]})]})},w.id))})})]}),x=[{value:"tags",label:"Activate Tags",content:b()},{value:"rules",label:"Activate Rules",content:v()}];return f.jsx("div",{className:"p-0 max-w-lg",children:f.jsx(sc,{tabs:x,defaultValue:"tags",scrollable:!1})})},Pst=({module:e})=>{const[,t]=T.useState({});T.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const[n,r]=T.useState(!1),s=e.getActiveTagIds(),i=e.getActiveRuleIds(),a=e.getIsStreaming(),o=e.getHasRulesOrTags(),l=e.getAllRules(),c=e.getAllTags(),u=e.getRulesForTag,d=T.useCallback((v,x)=>{e.setActiveTagIds(w=>{const S=new Set(w);return x?S.add(v):S.delete(v),S})},[e]),h=T.useCallback((v,x)=>{e.setActiveRuleIds(w=>{const S=new Set(w);return x?S.add(v):S.delete(v),S})},[e]),m=()=>{o?r(v=>!v):e.handleTriggerClick()&&r(!1)},y=s.size>0||i.size>0,b=a;return f.jsxs(vl,{open:n,onOpenChange:r,children:[f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:o?f.jsx(xl,{asChild:!0,children:f.jsx(ft,{variant:y?"secondary":"ghost",size:"icon",className:"h-8 w-8",disabled:b,"aria-label":"Configure Rules & Tags for Next Turn",onClick:m,children:f.jsx(_B,{className:"h-4 w-4"})})}):f.jsx(ft,{variant:"ghost",size:"icon",className:"h-8 w-8",disabled:b,"aria-label":"Add Rules & Tags (Opens Settings)",onClick:m,children:f.jsx(_B,{className:"h-4 w-4"})})}),f.jsx(Sr,{side:"top",children:o?y?`Rules/Tags Active (${s.size} tags, ${i.size} rules)`:"Activate Rules/Tags (Next Turn)":"Add Rules/Tags (Opens Settings)"})]})}),o&&f.jsx(wl,{className:"w-auto p-0",align:"start",children:f.jsx(Zue,{activeTagIds:s,activeRuleIds:i,onToggleTag:d,onToggleRule:h,allRules:l,allTags:c,getRulesForTag:u})})]})};function Ost({form:e,name:t,label:n,description:r,placeholder:s,disabled:i,wrapperClassName:a,className:o,rows:l,...c}){return f.jsx(e.Field,{name:t,children:u=>{const d=typeof u.state.value=="string"||typeof u.state.value=="number"?String(u.state.value):"";return f.jsxs("div",{className:Ze("space-y-1.5",a),children:[f.jsx(It,{htmlFor:u.name,className:"text-sm",children:n}),r&&f.jsx("p",{className:"text-xs text-muted-foreground",children:r}),f.jsx(Bo,{id:u.name,name:u.name,value:d,onBlur:u.handleBlur,onChange:h=>u.handleChange(h.target.value),placeholder:s,disabled:i??u.form.state.isSubmitting,rows:l,className:Ze(o,u.state.meta.errors.length?"border-destructive":""),...c}),f.jsx(Ni,{field:u})]})}})}const Dst=Ke({name:$e().min(1,"Rule Name is required."),content:$e().min(1,"Rule Content is required."),type:bl(["system","before","after"],{errorMap:()=>({message:"Rule Type is required."})})}),Fst=[{value:"system",label:"System Prompt"},{value:"before",label:"Before User Prompt"},{value:"after",label:"After User Prompt"}],Lst=({initialData:e,isSavingExt:t,onSave:n,onCancel:r})=>{const s=ri({defaultValues:{name:(e==null?void 0:e.name)||"",content:(e==null?void 0:e.content)||"",type:(e==null?void 0:e.type)||"before"},validators:{onChangeAsync:Dst,onChangeAsyncDebounceMs:500},onSubmit:async({value:i})=>{await n({name:i.name.trim(),content:i.content.trim(),type:i.type})}});return T.useEffect(()=>{s.reset({name:(e==null?void 0:e.name)||"",content:(e==null?void 0:e.content)||"",type:(e==null?void 0:e.type)||"before"})},[e,s]),f.jsxs("form",{onSubmit:i=>{i.preventDefault(),i.stopPropagation(),s.handleSubmit()},className:"space-y-4 border rounded-md p-4 bg-card shadow-md",children:[f.jsx("h4",{className:"font-semibold text-card-foreground",children:e!=null&&e.id?"Edit Rule":"Add New Rule"}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[f.jsx(Xw,{form:s,name:"name",label:"Rule Name",placeholder:"e.g., Always respond in JSON",required:!0,disabled:t,wrapperClassName:"md:col-span-2"}),f.jsx(jx,{form:s,name:"type",label:"Rule Type",options:Fst,placeholder:"Select Type",disabled:t})]}),f.jsx(Ost,{form:s,name:"content",label:"Rule Content",placeholder:"Enter the rule text to be injected...",required:!0,rows:4,disabled:t,className:"font-mono text-xs"}),f.jsxs("div",{className:"flex justify-end space-x-2 pt-2",children:[f.jsxs(ft,{variant:"ghost",size:"sm",onClick:r,disabled:t,type:"button",children:[f.jsx(qi,{className:"h-4 w-4 mr-1"})," Cancel"]}),f.jsx(s.Subscribe,{selector:i=>[i.canSubmit,i.isSubmitting,i.isValidating,i.isValid],children:([i,a,o,l])=>f.jsxs(ft,{variant:"secondary",size:"sm",type:"submit",disabled:t||!i||a||!l||o,children:[(t||a||o)&&f.jsx(Qn,{className:"h-4 w-4 mr-1 animate-spin"}),f.jsx(Qd,{className:"h-4 w-4 mr-1"})," ",t||a||o?"Saving...":"Save Rule"]})})]})]})},Bst=({rules:e,isLoading:t,isDeleting:n,onEdit:r,onDelete:s})=>{const i=a=>{window.confirm(`Are you sure you want to delete the rule "${a.name}"? This will also remove it from any tags.`)&&s(a.id,a.name)};return f.jsx("div",{className:"border rounded-md overflow-hidden",children:f.jsxs(lf,{children:[f.jsx(fp,{children:f.jsxs(Es,{children:[f.jsx(Tr,{children:"Name"}),f.jsx(Tr,{children:"Type"}),f.jsx(Tr,{children:"Content Preview"}),f.jsx(Tr,{className:"text-right",children:"Actions"})]})}),f.jsx(cf,{children:t?f.jsxs(f.Fragment,{children:[f.jsx(Es,{children:f.jsx(On,{colSpan:4,children:f.jsx(Wr,{className:"h-10 w-full"})})}),f.jsx(Es,{children:f.jsx(On,{colSpan:4,children:f.jsx(Wr,{className:"h-10 w-full"})})})]}):e.length===0?f.jsx(Es,{children:f.jsx(On,{colSpan:4,className:"h-24 text-center text-muted-foreground",children:"No rules defined yet."})}):e.map(a=>{const o=n[a.id];return f.jsxs(Es,{children:[f.jsx(On,{className:"font-medium",children:a.name}),f.jsx(On,{className:"capitalize",children:a.type}),f.jsx(On,{className:"text-xs text-muted-foreground truncate max-w-xs",children:a.content}),f.jsxs(On,{className:"text-right space-x-1",children:[f.jsx(Dn,{tooltipText:"Edit Rule",onClick:()=>r(a),disabled:o,icon:f.jsx(o1,{}),className:"h-8 w-8","aria-label":`Edit rule ${a.name}`}),f.jsx(Dn,{tooltipText:"Delete Rule",onClick:()=>i(a),disabled:o,icon:o?f.jsx(Qn,{className:"h-4 w-4 animate-spin"}):f.jsx(Ao,{}),className:"text-destructive hover:text-destructive/80 h-8 w-8","aria-label":`Delete rule ${a.name}`})]})]},a.id)})})]})})},$st=({module:e})=>{const[,t]=T.useState(Date.now()),n=e.getAllRules(),r=e.getIsLoadingRules(),[s,i]=T.useState(!1),[a,o]=T.useState(null),[l,c]=T.useState(!1),[u,d]=T.useState({});T.useEffect(()=>(e.setNotifySettingsCallback(()=>t(Date.now())),()=>{e.setNotifySettingsCallback(null)}),[e]);const h=()=>{o(null),i(!0)},m=x=>{o(x),i(!0)},y=T.useCallback(()=>{i(!1),o(null),c(!1)},[]),b=T.useCallback(async x=>{c(!0);try{a?e.updateRule(a.id,x):e.addRule(x),y()}catch{}finally{c(!1)}},[e,a,y]),v=T.useCallback(async x=>{d(w=>({...w,[x]:!0}));try{e.deleteRule(x),(a==null?void 0:a.id)===x&&y()}catch{}finally{d(w=>({...w,[x]:!1}))}},[e,a,y]);return f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"text-lg font-semibold text-card-foreground",children:"Manage Rules"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Create reusable text snippets (rules) that can be automatically injected into prompts based on assigned tags. Rules can modify the system prompt, or be added before/after the user's input."})]}),!s&&f.jsxs(ft,{onClick:h,variant:"outline",className:"w-full",disabled:r,children:[f.jsx(Ru,{className:"h-4 w-4 mr-1"})," Add New Rule"]}),s&&f.jsx(Lst,{initialData:a??void 0,isSavingExt:l,onSave:b,onCancel:y}),f.jsxs("div",{className:"pt-4",children:[f.jsx("h4",{className:"text-md font-medium mb-2",children:"Existing Rules"}),f.jsx(Bst,{rules:n,isLoading:r,isDeleting:u,onEdit:m,onDelete:v})]})]})},A3=Ke({name:$e().min(1,"Tag Name is required."),description:$e().nullable()}),zst=({initialData:e,isParentSaving:t=!1,onSave:n,onCancel:r})=>{const s=ri({defaultValues:{name:(e==null?void 0:e.name)||"",description:(e==null?void 0:e.description)||null},validators:{onChangeAsync:A3,onChangeAsyncDebounceMs:500},onSubmit:async({value:i})=>{var a;await n({name:i.name.trim(),description:((a=i.description)==null?void 0:a.trim())||null})}});return T.useEffect(()=>{s.reset({name:(e==null?void 0:e.name)||"",description:(e==null?void 0:e.description)||null})},[e,s]),f.jsxs("form",{onSubmit:i=>{i.preventDefault(),i.stopPropagation(),s.handleSubmit()},className:"space-y-4 border rounded-md p-4 bg-card shadow-md",children:[f.jsx("h4",{className:"font-semibold text-card-foreground",children:e!=null&&e.id?"Edit Tag":"Add New Tag"}),f.jsx(s.Field,{name:"name",validators:{onChange:A3.shape.name},children:i=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(It,{htmlFor:i.name,children:"Tag Name"}),f.jsx(_n,{id:i.name,value:i.state.value??"",onChange:a=>i.handleChange(a.target.value),onBlur:i.handleBlur,placeholder:"e.g., Code Generation, Summarization",disabled:s.state.isSubmitting||t}),f.jsx(Ni,{field:i})]})}),f.jsx(s.Field,{name:"description",validators:{onChange:A3.shape.description},children:i=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(It,{htmlFor:i.name,children:"Description (Optional)"}),f.jsx(Bo,{id:i.name,value:i.state.value??"",onChange:a=>i.handleChange(a.target.value),onBlur:i.handleBlur,placeholder:"Describe when to use this tag...",rows:2,disabled:s.state.isSubmitting||t}),f.jsx(Ni,{field:i})]})}),f.jsxs("div",{className:"flex justify-end space-x-2 pt-2",children:[f.jsxs(ft,{variant:"ghost",size:"sm",onClick:r,disabled:s.state.isSubmitting||t,type:"button",children:[f.jsx(qi,{className:"h-4 w-4 mr-1"})," Cancel"]}),f.jsx(s.Subscribe,{selector:i=>[i.canSubmit,i.isSubmitting,i.isValidating,i.isValid],children:([i,a,o,l])=>f.jsxs(ft,{variant:"secondary",size:"sm",type:"submit",disabled:t||!i||a||o||!l,children:[(a||o)&&f.jsx(Qn,{className:"h-4 w-4 mr-1 animate-spin"}),f.jsx(Qd,{className:"h-4 w-4 mr-1"})," ",a||o?"Saving...":"Save Tag"]})})]})]})},Ust=({tags:e,rulesByTagId:t,isLoading:n,isDeleting:r,onEdit:s,onDelete:i})=>{const a=o=>{window.confirm(`Are you sure you want to delete the tag "${o.name}"? This will remove it from all rules.`)&&i(o.id,o.name)};return f.jsx("div",{className:"border rounded-md overflow-hidden",children:f.jsxs(lf,{children:[f.jsx(fp,{children:f.jsxs(Es,{children:[f.jsx(Tr,{children:"Name"}),f.jsx(Tr,{children:"Description"}),f.jsx(Tr,{children:"Linked Rules"}),f.jsx(Tr,{className:"text-right",children:"Actions"})]})}),f.jsx(cf,{children:n?f.jsxs(f.Fragment,{children:[f.jsx(Es,{children:f.jsx(On,{colSpan:4,children:f.jsx(Wr,{className:"h-10 w-full"})})}),f.jsx(Es,{children:f.jsx(On,{colSpan:4,children:f.jsx(Wr,{className:"h-10 w-full"})})})]}):e.length===0?f.jsx(Es,{children:f.jsx(On,{colSpan:4,className:"h-24 text-center text-muted-foreground",children:"No tags defined yet."})}):e.map(o=>{const l=r[o.id],c=t.get(o.id)||[];return f.jsxs(Es,{children:[f.jsx(On,{className:"font-medium",children:o.name}),f.jsx(On,{className:"text-xs text-muted-foreground truncate max-w-xs",children:o.description||"-"}),f.jsx(On,{className:"text-xs",children:c.length>0?c.map(u=>u.name).join(", "):"None"}),f.jsxs(On,{className:"text-right space-x-1",children:[f.jsx(Dn,{tooltipText:"Edit Tag & Rules",onClick:()=>s(o),disabled:l,icon:f.jsx(o1,{}),className:"h-8 w-8","aria-label":`Edit tag ${o.name}`}),f.jsx(Dn,{tooltipText:"Delete Tag",onClick:()=>a(o),disabled:l,icon:l?f.jsx(Qn,{className:"h-4 w-4 animate-spin"}):f.jsx(Ao,{}),className:"text-destructive hover:text-destructive/80 h-8 w-8","aria-label":`Delete tag ${o.name}`})]})]},o.id)})})]})})},qst=({tag:e,allRules:t,linkedRuleIds:n,onLinkChange:r,disabled:s=!1})=>{const[i,a]=T.useState(!1),[o,l]=T.useState(""),c=T.useMemo(()=>[...t].sort((y,b)=>y.name.localeCompare(b.name)),[t]),u=T.useMemo(()=>{const y=o.toLowerCase();return y?c.filter(b=>b.name.toLowerCase().includes(y)||b.content.toLowerCase().includes(y)||b.type.toLowerCase().includes(y)):c},[c,o]),d=T.useCallback(y=>{const b=n.has(y);r(e.id,y,!b),l("")},[n,r,e.id]),h=T.useCallback((y,b)=>{b.stopPropagation(),r(e.id,y,!1)},[r,e.id]),m=T.useMemo(()=>c.filter(y=>n.has(y.id)),[c,n]);return f.jsxs("div",{className:"space-y-3",children:[f.jsxs(It,{className:"font-medium",children:['Associated Rules for "',e.name,'"']}),f.jsxs(vl,{open:i,onOpenChange:a,children:[f.jsx(xl,{asChild:!0,children:f.jsxs(ft,{variant:"outline",role:"combobox","aria-expanded":i,className:"w-full justify-between h-9",disabled:s||t.length===0,children:[f.jsx("span",{className:"truncate",children:m.length>0?`${m.length} rule(s) selected`:"Select rules..."}),f.jsx(cE,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),f.jsx(wl,{className:"w-[--radix-popover-trigger-width] p-0",children:f.jsxs(que,{shouldFilter:!1,children:[f.jsx(Vue,{placeholder:"Search rules...",value:o,onValueChange:l}),f.jsxs(Wue,{children:[f.jsx(Hue,{children:t.length===0?"No rules defined.":"No rules found."}),f.jsx(Gue,{children:u.map(y=>{const b=n.has(y.id);return f.jsxs(Kue,{value:y.id,onSelect:()=>d(y.id),className:"cursor-pointer",children:[f.jsx(so,{className:Ze("mr-2 h-4 w-4",b?"opacity-100":"opacity-0")}),f.jsx("span",{className:"truncate",children:y.name}),f.jsxs("span",{className:"ml-2 text-xs text-muted-foreground",children:["(",y.type,")"]})]},y.id)})})]})]})})]}),m.length>0&&f.jsx("div",{className:"flex flex-wrap gap-1 pt-2",children:m.map(y=>f.jsxs(is,{variant:"secondary",className:"flex items-center gap-1",children:[f.jsx("span",{className:"truncate",children:y.name}),f.jsx(ft,{variant:"ghost",size:"icon",className:"h-4 w-4 p-0 text-muted-foreground hover:text-destructive hover:bg-transparent",onClick:b=>h(y.id,b),disabled:s,"aria-label":`Unlink rule ${y.name}`,children:f.jsx(qi,{className:"h-3 w-3"})})]},y.id))})]})},Vst=({module:e})=>{const[,t]=T.useState(Date.now()),n=e.getAllTags(),r=e.getAllRules(),s=e.getTagRuleLinks(),i=e.getRulesForTag,a=e.getIsLoadingRules(),[o,l]=T.useState(!1),[c,u]=T.useState(null),[d,h]=T.useState(!1),[m,y]=T.useState({});T.useEffect(()=>(e.setNotifySettingsCallback(()=>t(Date.now())),()=>{e.setNotifySettingsCallback(null)}),[e]);const b=()=>{u(null),l(!0)},v=R=>{u(R),l(!0)},x=T.useCallback(()=>{l(!1),u(null),h(!1)},[]),w=T.useCallback(async R=>{h(!0);try{c?e.updateTag(c.id,R):e.addTag(R),c||x()}catch{}finally{h(!1)}},[e,c,x]),S=T.useCallback(async R=>{y(N=>({...N,[R]:!0}));try{e.deleteTag(R),(c==null?void 0:c.id)===R&&x()}catch{}finally{y(N=>({...N,[R]:!1}))}},[e,c,x]),C=T.useCallback(async(R,N,I)=>{try{I?e.linkTagToRule(R,N):e.unlinkTagFromRule(R,N)}catch{}},[e]),k=T.useMemo(()=>{const R=new Map;return n.forEach(N=>{R.set(N.id,i(N.id))}),R},[n,i]),A=T.useMemo(()=>c?new Set(s.filter(R=>R.tagId===c.id).map(R=>R.ruleId)):new Set,[c,s]);return f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"text-lg font-semibold text-card-foreground",children:"Manage Tags"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Create tags to group related rules. You can activate tags before sending a prompt to apply their associated rules."})]}),!o&&f.jsxs(ft,{onClick:b,variant:"outline",className:"w-full",disabled:a,children:[f.jsx(Ru,{className:"h-4 w-4 mr-1"})," Add New Tag"]}),o&&f.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[f.jsx(zst,{initialData:c??void 0,isParentSaving:d,onSave:w,onCancel:x}),c&&f.jsx(qst,{tag:c,allRules:r,linkedRuleIds:A,onLinkChange:C,disabled:d})]}),f.jsx(Xd,{}),f.jsxs("div",{className:"pt-4",children:[f.jsx("h4",{className:"text-md font-medium mb-2",children:"Existing Tags"}),f.jsx(Ust,{tags:n,rulesByTagId:k,isLoading:a,isDeleting:m,onEdit:v,onDelete:S})]})]})},Wst=({module:e})=>{const[,t]=T.useState({});T.useEffect(()=>(e.setNotifySettingsCallback(()=>t({})),()=>e.setNotifySettingsCallback(null)),[e]);const n=T.useMemo(()=>[{value:"rules",label:"Rules",content:f.jsx($st,{module:e})},{value:"tags",label:"Tags",content:f.jsx(Vst,{module:e})}],[e]);return f.jsx(sc,{tabs:n,defaultValue:"rules",className:"h-full",listClassName:"bg-muted/50 rounded-md",contentContainerClassName:"mt-4"})};class Hst{constructor(){me(this,"id","core-rules-tags");me(this,"unregisterPromptControlCallback",null);me(this,"unregisterSettingsTabCallback",null);me(this,"eventUnsubscribers",[]);me(this,"modApiRef",null);me(this,"allRules",[]);me(this,"allTags",[]);me(this,"tagRuleLinks",[]);me(this,"transientActiveTagIds",new Set);me(this,"transientActiveRuleIds",new Set);me(this,"isStreaming",!1);me(this,"hasRulesOrTags",!1);me(this,"isLoadingRules",!0);me(this,"notifyComponentUpdate",null);me(this,"notifySettingsComponentUpdate",null);me(this,"getAllRules",()=>this.allRules);me(this,"getAllTags",()=>this.allTags);me(this,"getTagRuleLinks",()=>this.tagRuleLinks);me(this,"getRulesForTag",t=>{const n=new Set(this.tagRuleLinks.filter(r=>r.tagId===t).map(r=>r.ruleId));return this.allRules.filter(r=>n.has(r.id))});me(this,"getRuleById",t=>this.allRules.find(n=>n.id===t));me(this,"getTagById",t=>this.allTags.find(n=>n.id===t));me(this,"getRulesByIds",t=>{const n=new Set(t);return this.allRules.filter(r=>n.has(r.id))});me(this,"addRule",t=>{var n;(n=this.modApiRef)==null||n.emit(gr.addRuleRequest,t)});me(this,"updateRule",(t,n)=>{var r;(r=this.modApiRef)==null||r.emit(gr.updateRuleRequest,{id:t,updates:n})});me(this,"deleteRule",t=>{var n;(n=this.modApiRef)==null||n.emit(gr.deleteRuleRequest,{id:t})});me(this,"addTag",t=>{var n;(n=this.modApiRef)==null||n.emit(gr.addTagRequest,t)});me(this,"updateTag",(t,n)=>{var r;(r=this.modApiRef)==null||r.emit(gr.updateTagRequest,{id:t,updates:n})});me(this,"deleteTag",t=>{var n;(n=this.modApiRef)==null||n.emit(gr.deleteTagRequest,{id:t})});me(this,"linkTagToRule",(t,n)=>{var r;(r=this.modApiRef)==null||r.emit(gr.linkTagToRuleRequest,{tagId:t,ruleId:n})});me(this,"unlinkTagFromRule",(t,n)=>{var r;(r=this.modApiRef)==null||r.emit(gr.unlinkTagFromRuleRequest,{tagId:t,ruleId:n})});me(this,"handleTriggerClick",()=>!this.hasRulesOrTags&&this.modApiRef?(this.modApiRef.emit(Pr.openModalRequest,{modalId:"settingsModal",initialTab:"rules-tags"}),!0):!1);me(this,"getIsStreaming",()=>this.isStreaming);me(this,"getHasRulesOrTags",()=>this.hasRulesOrTags);me(this,"getIsLoadingRules",()=>this.isLoadingRules);me(this,"getActiveTagIds",()=>this.transientActiveTagIds);me(this,"getActiveRuleIds",()=>this.transientActiveRuleIds);me(this,"setActiveTagIds",t=>{var n;this.transientActiveTagIds=t(this.transientActiveTagIds),(n=this.notifyComponentUpdate)==null||n.call(this)});me(this,"setActiveRuleIds",t=>{var n;this.transientActiveRuleIds=t(this.transientActiveRuleIds),(n=this.notifyComponentUpdate)==null||n.call(this)});me(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t});me(this,"setNotifySettingsCallback",t=>{this.notifySettingsComponentUpdate=t})}async initialize(t){this.modApiRef=t,this.isStreaming=t.getContextSnapshot().isStreaming,t.emit(gr.loadRulesAndTagsRequest,void 0);const n=t.on(Zn.statusChanged,s=>{var i;typeof s=="object"&&s&&"status"in s&&this.isStreaming!==(s.status==="streaming")&&(this.isStreaming=s.status==="streaming",(i=this.notifyComponentUpdate)==null||i.call(this))}),r=t.on(gr.dataLoaded,s=>{var i,a;s&&(this.allRules=s.rules||[],this.allTags=s.tags||[],this.tagRuleLinks=(s.links||[]).map(o=>({tagId:o.tagId,ruleId:o.ruleId}))),this.updateHasRulesOrTags(),this.isLoadingRules=!1,(i=this.notifyComponentUpdate)==null||i.call(this),(a=this.notifySettingsComponentUpdate)==null||a.call(this)});this.eventUnsubscribers.push(n,r)}updateHasRulesOrTags(){const t=this.allRules.length>0||this.allTags.length>0;this.hasRulesOrTags!==t&&(this.hasRulesOrTags=t)}register(t){this.modApiRef=t,this.unregisterPromptControlCallback||(this.unregisterPromptControlCallback=t.registerPromptControl({id:this.id,status:()=>this.isLoadingRules?"loading":"ready",triggerRenderer:()=>We.createElement(Pst,{module:this}),getMetadata:()=>{const n=Array.from(this.transientActiveTagIds),r=Array.from(this.transientActiveRuleIds),s=[],i=new Set(r);if(n.forEach(a=>{this.getRulesForTag(a).forEach(o=>i.add(o.id))}),i.forEach(a=>{const o=this.getRuleById(a);o&&s.push({type:o.type,content:o.content,sourceRuleId:o.id})}),n.length>0||r.length>0||s.length>0)return{activeTagIds:n,activeRuleIds:r,effectiveRulesContent:s}},clearOnSubmit:()=>{var r;let n=!1;this.transientActiveTagIds.size>0&&(this.transientActiveTagIds=new Set,n=!0),this.transientActiveRuleIds.size>0&&(this.transientActiveRuleIds=new Set,n=!0),n&&((r=this.notifyComponentUpdate)==null||r.call(this))}})),this.unregisterSettingsTabCallback||(this.unregisterSettingsTabCallback=t.registerSettingsTab({id:"rules-tags",title:"Rules & Tags",component:()=>We.createElement(Wst,{module:this}),order:50}))}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterPromptControlCallback&&(this.unregisterPromptControlCallback(),this.unregisterPromptControlCallback=null),this.unregisterSettingsTabCallback&&(this.unregisterSettingsTabCallback(),this.unregisterSettingsTabCallback=null),this.notifyComponentUpdate=null,this.notifySettingsComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const Gst=({module:e})=>{const[,t]=T.useState({});T.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const n=e.getTurnEnabled(),r=e.getIsStreaming(),s=e.getGlobalAutoTitleEnabled()&&e.getIsFirstInteraction(),i=T.useCallback(()=>{const a=!n;e.setTurnEnabled(a)},[n,e]);return s?f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(ft,{variant:n?"secondary":"ghost",size:"icon",className:"h-8 w-8",onClick:i,disabled:r,"aria-label":n?"Disable Auto-Title for this Chat":"Enable Auto-Title for this Chat",children:f.jsx(gH,{className:Ze("h-4 w-4",n?"text-primary":"text-muted-foreground")})})}),f.jsx(Sr,{side:"top",children:n?"Auto-Title Enabled (Click to Disable)":"Auto-Title Disabled (Click to Enable)"})]})}):null};class Kst{constructor(){me(this,"id","core-auto-title");me(this,"unregisterCallback",null);me(this,"eventUnsubscribers",[]);me(this,"turnAutoTitleEnabled",!1);me(this,"isStreaming",!1);me(this,"isFirstInteraction",!1);me(this,"globalAutoTitleEnabled",!0);me(this,"notifyComponentUpdate",null);me(this,"getTurnEnabled",()=>this.turnAutoTitleEnabled);me(this,"getIsStreaming",()=>this.isStreaming);me(this,"getIsFirstInteraction",()=>this.isFirstInteraction);me(this,"getGlobalAutoTitleEnabled",()=>this.globalAutoTitleEnabled);me(this,"setTurnEnabled",t=>{var n;this.turnAutoTitleEnabled!==t&&(this.turnAutoTitleEnabled=t,(n=this.notifyComponentUpdate)==null||n.call(this))});me(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){var a;this.turnAutoTitleEnabled=!1,this.isStreaming=$n.getState().status==="streaming",this.globalAutoTitleEnabled=yr.getState().autoTitleEnabled,this.checkFirstInteraction(),(a=this.notifyComponentUpdate)==null||a.call(this);const n=t.on(Zn.statusChanged,o=>{var l;typeof o=="object"&&o&&"status"in o&&this.isStreaming!==(o.status==="streaming")&&(this.isStreaming=o.status==="streaming",(l=this.notifyComponentUpdate)==null||l.call(this))}),r=t.on(Pr.contextChanged,()=>{var l;const o=this.isFirstInteraction;this.checkFirstInteraction(),o!==this.isFirstInteraction&&((l=this.notifyComponentUpdate)==null||l.call(this))}),s=t.on(Zn.completed,()=>{var l;const o=this.isFirstInteraction;this.checkFirstInteraction(),o!==this.isFirstInteraction&&((l=this.notifyComponentUpdate)==null||l.call(this))}),i=t.on(sn.autoTitleEnabledChanged,o=>{var l;typeof o=="object"&&o&&"enabled"in o&&this.globalAutoTitleEnabled!==o.enabled&&(this.globalAutoTitleEnabled=o.enabled,(l=this.notifyComponentUpdate)==null||l.call(this))});this.eventUnsubscribers.push(n,r,s,i)}checkFirstInteraction(){const t=$n.getState(),n=t.currentConversationId===null||t.interactions.filter(r=>r.conversationId===t.currentConversationId).length===0;this.isFirstInteraction!==n&&(this.isFirstInteraction=n,!n&&this.turnAutoTitleEnabled&&(this.turnAutoTitleEnabled=!1))}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}const n=()=>We.createElement(Gst,{module:this});this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:n,getMetadata:()=>this.turnAutoTitleEnabled?{autoTitleEnabledForTurn:!0}:void 0,clearOnSubmit:()=>{var r;this.turnAutoTitleEnabled&&(this.turnAutoTitleEnabled=!1,(r=this.notifyComponentUpdate)==null||r.call(this))}})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,console.log(`[${this.id}] Destroyed.`)}}function Yst(){const e=new URLSearchParams(window.location.search),t=e.get("q")??void 0,n=e.get("m")??void 0,r=e.getAll("vfs").filter(Boolean),s=e.get("s")??"1";return{query:t,modelId:n,vfsFiles:r.length>0?r:void 0,submit:s}}class Zst{constructor(){me(this,"id","core-url-parameters");me(this,"modApiRef",null)}async initialize(t){this.modApiRef=t,console.log(`[${this.id}] Initializing...`),t.on(op.initializationPhaseCompleted,n=>{n.phase==="all"&&this.processUrlParameters().catch(r=>{console.error(`[${this.id}] Error processing URL parameters:`,r),je.error("Failed to process URL parameters.")})}),console.log(`[${this.id}] Initialized, awaiting full app load.`)}register(t){}destroy(){this.modApiRef=null}async processUrlParameters(){var r,s;if(!this.modApiRef){console.warn(`[${this.id}] ModAPI not available, cannot process URL parameters.`);return}const t=this.modApiRef,n=Yst();if(!(!n.query&&!n.modelId&&!((r=n.vfsFiles)!=null&&r.length))){je.info("Processing parameters from URL...");try{const i=await new Promise((a,o)=>{const l=t.on(Yn.conversationAdded,c=>{c.conversation.title.startsWith("From URL:")&&(l(),a(c.conversation.id))});setTimeout(()=>{l(),o(new Error("Timeout waiting for conversation creation event."))},5e3),t.emit(Yn.addConversationRequest,{title:n.query?`From URL: ${n.query.substring(0,30)}...`:"From URL Parameters"})});if(t.emit(Yn.selectItemRequest,{id:i,type:"conversation"}),n.modelId){const a=Nr.getState().getAvailableModelListItems();let o=null;const l=n.modelId.toLowerCase();if(n.modelId.includes(":")){const c=a.find(u=>u.id===n.modelId);c&&(o=c.id)}if(!o){const c=a.find(u=>u.name.toLowerCase()===l);c&&(o=c.id)}if(!o){const c=a.find(u=>u.name.toLowerCase().startsWith(l));c&&(o=c.id)}if(!o){const c=a.find(u=>{const d=u.id.toLowerCase().split("/");return d.length>1&&d[1].startsWith(l)});c&&(o=c.id)}if(o){t.emit(Nn.setModelIdRequest,{id:o}),t.emit(dr.selectModelRequest,{modelId:o});const c=a.find(u=>u.id===o);je.success(`Model set to: ${c==null?void 0:c.name} (${c==null?void 0:c.providerName})`)}else je.warning(`Model matching "${n.modelId}" not found or not enabled. Using default.`)}if(n.vfsFiles&&n.vfsFiles.length>0){const a="orphan";let o;try{if(o=await t.getVfsInstance(a),!o)throw new Error("Failed to get VFS instance via ModAPI.")}catch(l){je.error(`Failed to initialize VFS for URL files: ${l instanceof Error?l.message:String(l)}`)}if(o)for(const l of n.vfsFiles)try{const c=await Yh(l,{fsInstance:o}),u=await o.promises.stat(l),d=gi(l),h="application/octet-stream",m=Vx(d,h);let y={};if(m)y.contentText=new TextDecoder().decode(c);else{let b="";const v=c.byteLength;for(let x=0;x<v;x++)b+=String.fromCharCode(c[x]);y.contentBase64=window.btoa(b)}t.emit(ql.addAttachedFileRequest,{source:"vfs",name:d,type:h,size:u.size,path:l,...y}),je.success(`Attached VFS file: ${d}`)}catch(c){c.code==="ENOENT"?je.warning(`VFS file not found: ${l}`):je.warning(`Failed to attach VFS file "${l}": ${c.message}`),console.error(`Error processing VFS file ${l}:`,c)}}if(n.query)if(n.submit==="0")t.emit(Nn.inputChanged,{value:n.query}),je.info("Query from URL loaded into input area."),window.history.replaceState({},document.title,window.location.pathname);else{let a={},o={};const l=mh.getState().attachedFilesMetadata;l.length>0&&(o.attachedFiles=[...l]);let c={id:Vi(),content:n.query,parameters:a,metadata:o};t.emit(Nn.submitted,{turnData:c});const u=await IC(Q0.PROMPT_TURN_FINALIZE,{turnData:c});if(u===!1){je.warning("Prompt submission from URL cancelled by middleware.");return}const d=u&&typeof u=="object"?u.turnData:c;await Ex.submitPrompt(d),window.history.replaceState({},document.title,window.location.pathname)}else(n.modelId||(s=n.vfsFiles)!=null&&s.length)&&(je.info("Model and/or VFS files from URL applied. Type your message."),window.history.replaceState({},document.title,window.location.pathname))}catch(i){je.error(`Failed to process URL parameters: ${i instanceof Error?i.message:String(i)}`),console.error("Error processing URL parameters:",i)}}}}const Xst=({module:e})=>{const[t,n]=T.useState(!1),[,r]=T.useState({});T.useEffect(()=>(e.setNotifyCallback(()=>r({})),()=>e.setNotifyCallback(null)),[e]),T.useEffect(()=>{const o=e.getImageGenerationEnabled();n(o===!0)},[e]);const s=e.getIsVisible(),i=e.getIsStreaming(),a=T.useCallback(()=>{const o=!t;e.setImageGenerationEnabled(o?!0:null),n(o)},[t,e]);return s?f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(ft,{variant:t?"secondary":"ghost",size:"icon",onClick:a,disabled:i,className:"h-8 w-8","aria-label":t?"Disable Image Generation for Next Turn":"Enable Image Generation for Next Turn",children:f.jsx(tC,{className:Ze("h-4 w-4",t?"text-primary":"text-muted-foreground")})})}),f.jsx(Sr,{side:"top",children:t?"Image Generation Enabled (Click to Disable)":"Image Generation Disabled (Click to Enable)"})]})}):null};class Jst{constructor(){me(this,"id","core-image-generation");me(this,"modApiRef",null);me(this,"isImageGenerationEnabled",null);me(this,"unregisterCallback",null);me(this,"notifyComponentUpdate",null);me(this,"eventUnsubscribers",[]);me(this,"isVisible",!1);me(this,"isStreaming",!1);me(this,"getImageGenerationEnabled",()=>this.isImageGenerationEnabled);me(this,"getIsVisible",()=>this.isVisible);me(this,"getIsStreaming",()=>this.isStreaming);me(this,"setImageGenerationEnabled",t=>{var n,r;this.isImageGenerationEnabled=t,(n=this.modApiRef)==null||n.emit(Nn.setImageGenerationEnabledRequest,{enabled:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});me(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){this.modApiRef=t,this.isImageGenerationEnabled=null,this.isStreaming=$n.getState().status==="streaming",this.updateVisibility();const n=t.on(dr.selectedModelChanged,()=>{var s;this.updateVisibility(),(s=this.notifyComponentUpdate)==null||s.call(this)}),r=t.on(Zn.statusChanged,s=>{var i;typeof s=="object"&&s&&"status"in s&&this.isStreaming!==(s.status==="streaming")&&(this.isStreaming=s.status==="streaming",(i=this.notifyComponentUpdate)==null||i.call(this))});this.eventUnsubscribers.push(n,r),console.log(`[${this.id}] Initialized.`)}updateVisibility(){var i,a;const{getSelectedModel:t}=Nr.getState(),n=t(),s=(((a=(i=n==null?void 0:n.metadata)==null?void 0:i.architecture)==null?void 0:a.output_modalities)??[]).includes("image");this.isVisible!==s&&(this.isVisible=s)}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>We.createElement(Xst,{module:this}),getMetadata:()=>this.isImageGenerationEnabled===!0?{imageGenerationEnabled:!0}:void 0,clearOnSubmit:()=>{var s;(s=this.modApiRef)==null||s.emit(Nn.setImageGenerationEnabledRequest,{enabled:null})}});const n=s=>{var i;s.enabled!==this.isImageGenerationEnabled&&(this.isImageGenerationEnabled=s.enabled,(i=this.notifyComponentUpdate)==null||i.call(this))},r=this.modApiRef.on(Nn.setImageGenerationEnabledRequest,n);this.eventUnsubscribers.push(r),console.log(`[${this.id}] Registered successfully`)}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const Qst=({module:e})=>{const[t,n]=T.useState(!1),[r,s]=T.useState([]),[i,a]=T.useState(250),[,o]=T.useState({}),{status:l}=$n(yn(b=>({status:b.status})));T.useEffect(()=>{if(e)return e.setNotifyCallback(()=>o({})),()=>e.setNotifyCallback(null)},[e]);const c=(b,v)=>{s(x=>v?[...x,b]:x.filter(w=>w!==b))},u=()=>{if(r.length<2){je.error("Please select at least 2 models to race");return}e.setRaceMode(!0,r,i),n(!1),je.info(`Race mode enabled! Send your prompt to race ${r.length} models.`),s([]),a(250)},d=()=>{e.setRaceMode(!1),je.info("Race mode disabled")},h=b=>{if(b.stopPropagation(),e.isRaceModeActive){d();return}if(l==="streaming"){je.info("Cannot start race while another response is streaming");return}if(e.globallyEnabledModels.length<2){je.info("Need at least 2 models enabled to race");return}n(!0)},m=l!=="streaming"&&e.globallyEnabledModels.length>=2,y=()=>e.isRaceModeActive?"Race mode active - click to cancel, or send your prompt to race models":l==="streaming"?"Cannot race while streaming":e.globallyEnabledModels.length<2?`Need at least 2 models enabled to race (currently have ${e.globallyEnabledModels.length})`:"Race multiple models with your prompt";return f.jsxs(f.Fragment,{children:[f.jsx(Dn,{tooltipText:y(),onClick:h,"aria-label":"Race Multiple Models Against Each Other",disabled:!m,icon:f.jsx(pH,{}),className:`h-5 w-5 md:h-6 md:w-6 ${e.isRaceModeActive?"bg-primary text-primary-foreground":""}`}),f.jsx(lp,{open:t,onOpenChange:n,children:f.jsxs(cp,{className:"max-w-md",children:[f.jsxs(up,{children:[f.jsx(dp,{children:"Race Models"}),f.jsx(ng,{children:'Select multiple models to race against each other. After clicking "Enable Race Mode", send your prompt and all selected models will respond.'})]}),f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"space-y-2",children:[f.jsx(It,{htmlFor:"stagger-input",children:"Stagger Delay (ms)"}),f.jsx(_n,{id:"stagger-input",type:"number",min:"0",max:"5000",step:"50",value:i,onChange:b=>a(parseInt(b.target.value)||250),placeholder:"250",className:"w-full"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Delay between starting each model (0-5000ms)"})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsxs(It,{children:["Select Models to Race (",r.length," selected)"]}),f.jsx(Lo,{className:"h-48 w-full border rounded-md p-3",children:f.jsx("div",{className:"space-y-2",children:e.globallyEnabledModels.map(b=>f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(Xl,{id:`model-${b.id}`,checked:r.includes(b.id),onCheckedChange:v=>c(b.id,v===!0)}),f.jsx(It,{htmlFor:`model-${b.id}`,className:"text-sm cursor-pointer flex-1 min-w-0",children:f.jsxs("div",{className:"truncate",children:[f.jsx("span",{className:"font-medium",children:b.name}),f.jsxs("span",{className:"text-muted-foreground ml-2",children:["(",b.providerName,")"]})]})})]},b.id))})}),e.globallyEnabledModels.length===0&&f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No models available"})]})]}),f.jsxs(pb,{children:[f.jsx(ft,{variant:"outline",onClick:()=>n(!1),children:"Cancel"}),f.jsx(ft,{onClick:u,disabled:r.length<2||e.isLoadingProviders,children:"Enable Race Mode"})]})]})})]})};class eit{constructor(){me(this,"id","race-prompt-control");me(this,"eventUnsubscribers",[]);me(this,"modApi",null);me(this,"notifyComponentUpdate",null);me(this,"isRaceMode",!1);me(this,"raceModelIds",[]);me(this,"raceStaggerMs",250);me(this,"globallyEnabledModels",[]);me(this,"isLoadingProviders",!1)}async initialize(t){this.modApi=t;const n=Nr.getState();this.globallyEnabledModels=n.getGloballyEnabledModelDefinitions(),this.isLoadingProviders=n.isLoading;const r=t.on(dr.globallyEnabledModelsUpdated,a=>{var o;this.globallyEnabledModels=a.models,(o=this.notifyComponentUpdate)==null||o.call(this)}),s=t.on(dr.initialDataLoaded,a=>{var o;a.globallyEnabledModels&&(this.globallyEnabledModels=a.globallyEnabledModels,this.isLoadingProviders=!1,(o=this.notifyComponentUpdate)==null||o.call(this))}),i=t.addMiddleware(Q0.PROMPT_TURN_FINALIZE,async a=>this.isRaceMode?await this.handleRaceSubmission(a.turnData):a);this.eventUnsubscribers.push(r,s,i)}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.notifyComponentUpdate=null,this.modApi=null}setNotifyCallback(t){this.notifyComponentUpdate=t}setRaceMode(t,n,r){var s;this.isRaceMode=t,t&&n&&r!==void 0?(this.raceModelIds=n,this.raceStaggerMs=r):(this.raceModelIds=[],this.raceStaggerMs=250),(s=this.notifyComponentUpdate)==null||s.call(this)}get isRaceModeActive(){return this.isRaceMode}async handleRaceSubmission(t){try{console.log(`[RacePromptControlModule] Starting race submission with ${this.raceModelIds.length} models:`,this.raceModelIds);const n=$n.getState(),r=n.currentConversationId;if(!r)return je.error("No active conversation for racing"),!1;if(this.raceModelIds.length===0)return je.error("No models selected for racing"),this.setRaceMode(!1),!1;je.info(`Racing ${this.raceModelIds.length} models with your prompt...`);const i=n.interactions.filter(y=>y.conversationId===r).reduce((y,b)=>Math.max(y,b.index),-1)+1,a=await this.buildPromptObject(t,r,i),o=[...this.raceModelIds],l=this.raceStaggerMs,u=Po.getState().modelId;if(!u)return je.error("No model currently selected"),this.setRaceMode(!1),!1;this.setRaceMode(!1);const d={...a,metadata:{...a.metadata,modelId:u}},h=await dm.startInteraction(d,r,t,"message.user_assistant");if(!h)throw new Error("Failed to create main race interaction");const m=o.map((y,b)=>new Promise(v=>{setTimeout(async()=>{try{const x={...a,metadata:{...a.metadata,modelId:y,raceTab:!0,raceParticipantIndex:b+1}},w=await dm.startInteraction(x,r,t,"message.assistant_regen");if(w){const S={parentId:h.id,index:b+1};n._updateInteractionInState(w.id,S),await Et.saveInteraction({...w,...S})}v()}catch(x){console.error(`[RacePromptControlModule] Race participant ${b+1} failed:`,x),v()}},(b+1)*l)}));return await Promise.all(m),je.success(`Race started! Current model + ${o.length} race models responding in tabs.`),!1}catch(n){return je.error(`Race failed: ${String(n)}`),console.error("[RacePromptControlModule] Error during race:",n),this.setRaceMode(!1),!1}}async buildPromptObject(t,n,r){var R,N,I;const s=$n.getState(),i=Fo.getState(),o=qn.getState().getConversationById(n),l=(o==null?void 0:o.projectId)??null,c=i.getEffectiveProjectSettings(l),u=s.interactions.filter(P=>P.conversationId===n&&P.index<r&&P.status==="COMPLETED"&&P.type==="message.user_assistant"&&P.parentId===null).sort((P,L)=>P.index-L.index),d=uj(u);let h=t.content;const m=[],y=((R=t.metadata)==null?void 0:R.effectiveRulesContent)??[],b=y.filter(P=>P.type==="system").map(P=>P.content),v=y.filter(P=>P.type==="before").map(P=>P.content),x=y.filter(P=>P.type==="after").map(P=>P.content);v.length>0&&(h=`${v.join(`
`)}

${h}`),x.length>0&&(h=`${h}

${x.join(`
`)}`),h&&m.push({type:"text",text:h});const w=((N=t.metadata)==null?void 0:N.attachedFiles)??[];w.length>0,m.length>0&&d.push({role:"user",content:m});let C=((I=t.metadata)==null?void 0:I.turnSystemPrompt)??c.systemPrompt??void 0;b.length>0&&(C=`${C?`${C}

`:""}${b.join(`
`)}`);const k=Po.getState(),A={temperature:k.temperature,max_tokens:k.maxTokens,top_p:k.topP,top_k:k.topK,presence_penalty:k.presencePenalty,frequency_penalty:k.frequencyPenalty,...t.parameters??{}};return Object.keys(A).forEach(P=>{(A[P]===null||A[P]===void 0)&&delete A[P]}),{system:C,messages:d,parameters:A,metadata:{...t.metadata??{},attachedFiles:w.map(({contentBase64:P,contentText:L,...O})=>O)}}}register(t){t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>We.createElement(Qst,{module:this})})}}const mx=({fieldApi:e,label:t,description:n,placeholder:r,inputClassName:s,labelClassName:i,wrapperClassName:a,type:o="text"})=>{const{name:l,state:c,handleChange:u,handleBlur:d}=e,h=c.value,m=y=>{u(y.target.value)};return f.jsxs("div",{className:Ze("space-y-1.5",a),children:[t&&f.jsx(It,{htmlFor:l,className:Ze("text-sm font-medium",i),children:t}),n&&f.jsx("p",{className:"text-xs text-muted-foreground",children:n}),f.jsx(_n,{id:l,name:l,type:o,value:h==null?"":String(h),onBlur:d,onChange:m,placeholder:r,className:Ze(s,c.meta.errors.length?"border-destructive":""),disabled:e.form.state.isSubmitting}),c.meta.isTouched&&c.meta.errors.length>0&&f.jsx("div",{className:"text-xs text-destructive pt-1",children:c.meta.errors.map((y,b)=>f.jsx("p",{children:typeof y=="string"?y:(y==null?void 0:y.message)||"Invalid"},b))})]})},tit=({fieldApi:e,label:t,placeholder:n,description:r,rows:s=3,inputClassName:i,labelClassName:a,wrapperClassName:o})=>f.jsxs("div",{className:Ze("space-y-1.5",o),children:[t&&f.jsx(It,{htmlFor:e.name,className:Ze("text-sm font-medium",a),children:t}),r&&f.jsx("p",{className:"text-xs text-muted-foreground",children:r}),f.jsx(Bo,{id:e.name,name:e.name,value:e.state.value||"",onBlur:e.handleBlur,onChange:l=>e.handleChange(l.target.value),placeholder:n,rows:s,className:Ze(i,e.state.meta.errors.length?"border-destructive":""),disabled:e.form.state.isSubmitting}),e.state.meta.isTouched&&e.state.meta.errors.length>0&&f.jsx("div",{className:"text-xs text-destructive pt-1",children:e.state.meta.errors.map((l,c)=>f.jsx("p",{children:String(l)},c))})]}),nit=({fieldApi:e,label:t,placeholder:n,description:r,options:s=[],inputClassName:i,labelClassName:a,wrapperClassName:o})=>f.jsxs("div",{className:Ze("space-y-1.5",o),children:[t&&f.jsx(It,{htmlFor:e.name+"-trigger",className:Ze("text-sm font-medium",a),children:t}),r&&f.jsx("p",{className:"text-xs text-muted-foreground",children:r}),f.jsxs(np,{value:e.state.value||"",onValueChange:l=>e.handleChange(l),disabled:e.form.state.isSubmitting,children:[f.jsx(sp,{id:e.name+"-trigger",onBlur:e.handleBlur,className:Ze(i,e.state.meta.errors.length?"border-destructive":""),children:f.jsx(rp,{placeholder:n||"Select an option"})}),f.jsx(ip,{children:s.map((l,c)=>{const u=typeof l=="string"?l:l.value,d=typeof l=="string"?l:l.label;return f.jsx(To,{value:u,children:d},u+c)})})]}),e.state.meta.isTouched&&e.state.meta.errors.length>0&&f.jsx("div",{className:"text-xs text-destructive pt-1",children:e.state.meta.errors.map((l,c)=>f.jsx("p",{children:String(l)},c))})]}),rit=({fieldApi:e,label:t,description:n,labelClassName:r,wrapperClassName:s})=>f.jsxs("div",{className:Ze("space-y-1.5",s),children:[f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(Xl,{id:e.name,checked:!!e.state.value,onCheckedChange:i=>e.handleChange(!!i),onBlur:e.handleBlur,disabled:e.form.state.isSubmitting,"aria-describedby":n?`${e.name}-description`:void 0}),t&&f.jsx(It,{htmlFor:e.name,className:Ze("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",r),children:t})]}),n&&f.jsx("p",{id:`${e.name}-description`,className:"text-xs text-muted-foreground",children:n}),e.state.meta.isTouched&&e.state.meta.errors.length>0&&f.jsx("div",{className:"text-xs text-destructive pt-1",children:e.state.meta.errors.map((i,a)=>f.jsx("p",{children:String(i)},a))})]}),sit=({fieldApi:e,label:t,description:n,labelClassName:r,wrapperClassName:s})=>f.jsxs("div",{className:Ze("space-y-1.5",s),children:[f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(Io,{id:e.name,checked:!!e.state.value,onCheckedChange:i=>e.handleChange(i),onBlur:e.handleBlur,disabled:e.form.state.isSubmitting,"aria-describedby":n?`${e.name}-description`:void 0}),t&&f.jsx(It,{htmlFor:e.name,className:Ze("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",r),children:t})]}),n&&f.jsx("p",{id:`${e.name}-description`,className:"text-xs text-muted-foreground",children:n}),e.state.meta.isTouched&&e.state.meta.errors.length>0&&f.jsx("div",{className:"text-xs text-destructive pt-1",children:e.state.meta.errors.map((i,a)=>f.jsx("p",{children:String(i)},a))})]}),iit=({fieldApi:e,label:t,description:n,placeholder:r,inputClassName:s,labelClassName:i,wrapperClassName:a,min:o,max:l,step:c})=>{const{name:u,state:d,handleChange:h,handleBlur:m}=e,y=d.value,b=x=>{const w=x.target.value;if(w==="")h(void 0);else{const S=parseFloat(w);h(isNaN(S)?w:S)}};let v="";return(typeof y=="number"||typeof y=="string")&&(v=y),f.jsxs("div",{className:Ze("space-y-1.5",a),children:[t&&f.jsx(It,{htmlFor:u,className:Ze("text-sm font-medium",i),children:t}),n&&f.jsx("p",{className:"text-xs text-muted-foreground",children:n}),f.jsx(_n,{id:u,name:u,type:"number",value:v,onBlur:m,onChange:b,placeholder:r,min:o,max:l,step:c,className:Ze(s,d.meta.errors.length?"border-destructive":""),disabled:e.form.state.isSubmitting}),d.meta.isTouched&&d.meta.errors.length>0&&f.jsx("div",{className:"text-xs text-destructive pt-1",children:d.meta.errors.map((x,w)=>f.jsx("p",{children:typeof x=="string"?x:(x==null?void 0:x.message)||"Invalid"},w))})]})},R3={},gx={};function Px(e,t){try{const r=(R3[e]||(R3[e]=new Intl.DateTimeFormat("en-GB",{timeZone:e,hour:"numeric",timeZoneName:"longOffset"}).format))(t).split("GMT")[1]||"";return r in gx?gx[r]:bW(r,r.split(":"))}catch{if(e in gx)return gx[e];const n=e==null?void 0:e.match(ait);return n?bW(e,n.slice(1)):NaN}}const ait=/([+-]\d\d):?(\d\d)?/;function bW(e,t){const n=+t[0],r=+(t[1]||0);return gx[e]=n>0?n*60+r:n*60-r}class vu extends Date{constructor(...t){super(),t.length>1&&typeof t[t.length-1]=="string"&&(this.timeZone=t.pop()),this.internal=new Date,isNaN(Px(this.timeZone,this))?this.setTime(NaN):t.length?typeof t[0]=="number"&&(t.length===1||t.length===2&&typeof t[1]!="number")?this.setTime(t[0]):typeof t[0]=="string"?this.setTime(+new Date(t[0])):t[0]instanceof Date?this.setTime(+t[0]):(this.setTime(+new Date(...t)),Xue(this),SP(this)):this.setTime(Date.now())}static tz(t,...n){return n.length?new vu(...n,t):new vu(Date.now(),t)}withTimeZone(t){return new vu(+this,t)}getTimezoneOffset(){return-Px(this.timeZone,this)}setTime(t){return Date.prototype.setTime.apply(this,arguments),SP(this),+this}[Symbol.for("constructDateFrom")](t){return new vu(+new Date(t),this.timeZone)}}const vW=/^(get|set)(?!UTC)/;Object.getOwnPropertyNames(Date.prototype).forEach(e=>{if(!vW.test(e))return;const t=e.replace(vW,"$1UTC");vu.prototype[t]&&(e.startsWith("get")?vu.prototype[e]=function(){return this.internal[t]()}:(vu.prototype[e]=function(){return Date.prototype[t].apply(this.internal,arguments),oit(this),+this},vu.prototype[t]=function(){return Date.prototype[t].apply(this,arguments),SP(this),+this}))});function SP(e){e.internal.setTime(+e),e.internal.setUTCMinutes(e.internal.getUTCMinutes()-e.getTimezoneOffset())}function oit(e){Date.prototype.setFullYear.call(e,e.internal.getUTCFullYear(),e.internal.getUTCMonth(),e.internal.getUTCDate()),Date.prototype.setHours.call(e,e.internal.getUTCHours(),e.internal.getUTCMinutes(),e.internal.getUTCSeconds(),e.internal.getUTCMilliseconds()),Xue(e)}function Xue(e){const t=Px(e.timeZone,e),n=new Date(+e);n.setUTCHours(n.getUTCHours()-1);const r=-new Date(+e).getTimezoneOffset(),s=-new Date(+n).getTimezoneOffset(),i=r-s,a=Date.prototype.getHours.apply(e)!==e.internal.getUTCHours();i&&a&&e.internal.setUTCMinutes(e.internal.getUTCMinutes()+i);const o=r-t;o&&Date.prototype.setUTCMinutes.call(e,Date.prototype.getUTCMinutes.call(e)+o);const l=Px(e.timeZone,e),u=-new Date(+e).getTimezoneOffset()-l,d=l!==t,h=u-o;if(d&&h){Date.prototype.setUTCMinutes.call(e,Date.prototype.getUTCMinutes.call(e)+h);const m=Px(e.timeZone,e),y=l-m;y&&(e.internal.setUTCMinutes(e.internal.getUTCMinutes()+y),Date.prototype.setUTCMinutes.call(e,Date.prototype.getUTCMinutes.call(e)+y))}}class Ia extends vu{static tz(t,...n){return n.length?new Ia(...n,t):new Ia(Date.now(),t)}toISOString(){const[t,n,r]=this.tzComponents(),s=`${t}${n}:${r}`;return this.internal.toISOString().slice(0,-1)+s}toString(){return`${this.toDateString()} ${this.toTimeString()}`}toDateString(){const[t,n,r,s]=this.internal.toUTCString().split(" ");return`${t==null?void 0:t.slice(0,-1)} ${r} ${n} ${s}`}toTimeString(){const t=this.internal.toUTCString().split(" ")[4],[n,r,s]=this.tzComponents();return`${t} GMT${n}${r}${s} (${lit(this.timeZone,this)})`}toLocaleString(t,n){return Date.prototype.toLocaleString.call(this,t,{...n,timeZone:(n==null?void 0:n.timeZone)||this.timeZone})}toLocaleDateString(t,n){return Date.prototype.toLocaleDateString.call(this,t,{...n,timeZone:(n==null?void 0:n.timeZone)||this.timeZone})}toLocaleTimeString(t,n){return Date.prototype.toLocaleTimeString.call(this,t,{...n,timeZone:(n==null?void 0:n.timeZone)||this.timeZone})}tzComponents(){const t=this.getTimezoneOffset(),n=t>0?"-":"+",r=String(Math.floor(Math.abs(t)/60)).padStart(2,"0"),s=String(Math.abs(t)%60).padStart(2,"0");return[n,r,s]}withTimeZone(t){return new Ia(+this,t)}[Symbol.for("constructDateFrom")](t){return new Ia(+new Date(t),this.timeZone)}}function lit(e,t){return new Intl.DateTimeFormat("en-GB",{timeZone:e,timeZoneName:"long"}).format(t).slice(12)}var Ln;(function(e){e.Root="root",e.Chevron="chevron",e.Day="day",e.DayButton="day_button",e.CaptionLabel="caption_label",e.Dropdowns="dropdowns",e.Dropdown="dropdown",e.DropdownRoot="dropdown_root",e.Footer="footer",e.MonthGrid="month_grid",e.MonthCaption="month_caption",e.MonthsDropdown="months_dropdown",e.Month="month",e.Months="months",e.Nav="nav",e.NextMonthButton="button_next",e.PreviousMonthButton="button_previous",e.Week="week",e.Weeks="weeks",e.Weekday="weekday",e.Weekdays="weekdays",e.WeekNumber="week_number",e.WeekNumberHeader="week_number_header",e.YearsDropdown="years_dropdown"})(Ln||(Ln={}));var Xs;(function(e){e.disabled="disabled",e.hidden="hidden",e.outside="outside",e.focused="focused",e.today="today"})(Xs||(Xs={}));var _c;(function(e){e.range_end="range_end",e.range_middle="range_middle",e.range_start="range_start",e.selected="selected"})(_c||(_c={}));var sl;(function(e){e.weeks_before_enter="weeks_before_enter",e.weeks_before_exit="weeks_before_exit",e.weeks_after_enter="weeks_after_enter",e.weeks_after_exit="weeks_after_exit",e.caption_after_enter="caption_after_enter",e.caption_after_exit="caption_after_exit",e.caption_before_enter="caption_before_enter",e.caption_before_exit="caption_before_exit"})(sl||(sl={}));const xW=5,cit=4;function uit(e,t){const n=t.startOfMonth(e),r=n.getDay()>0?n.getDay():7,s=t.addDays(e,-r+1),i=t.addDays(s,xW*7-1);return t.getMonth(e)===t.getMonth(i)?xW:cit}function Jue(e,t){const n=t.startOfMonth(e),r=n.getDay();return r===1?n:r===0?t.addDays(n,-1*6):t.addDays(n,-1*(r-1))}function dit(e,t){const n=Jue(e,t),r=uit(e,t);return t.addDays(n,r*7-1)}class uf{constructor(t,n){this.Date=Date,this.today=()=>{var r;return(r=this.overrides)!=null&&r.today?this.overrides.today():this.options.timeZone?Ia.tz(this.options.timeZone):new this.Date},this.newDate=(r,s,i)=>{var a;return(a=this.overrides)!=null&&a.newDate?this.overrides.newDate(r,s,i):this.options.timeZone?new Ia(r,s,i,this.options.timeZone):new Date(r,s,i)},this.addDays=(r,s)=>{var i;return(i=this.overrides)!=null&&i.addDays?this.overrides.addDays(r,s):CZ(r,s)},this.addMonths=(r,s)=>{var i;return(i=this.overrides)!=null&&i.addMonths?this.overrides.addMonths(r,s):kZ(r,s)},this.addWeeks=(r,s)=>{var i;return(i=this.overrides)!=null&&i.addWeeks?this.overrides.addWeeks(r,s):vTe(r,s)},this.addYears=(r,s)=>{var i;return(i=this.overrides)!=null&&i.addYears?this.overrides.addYears(r,s):xTe(r,s)},this.differenceInCalendarDays=(r,s)=>{var i;return(i=this.overrides)!=null&&i.differenceInCalendarDays?this.overrides.differenceInCalendarDays(r,s):TZ(r,s)},this.differenceInCalendarMonths=(r,s)=>{var i;return(i=this.overrides)!=null&&i.differenceInCalendarMonths?this.overrides.differenceInCalendarMonths(r,s):RZ(r,s)},this.eachMonthOfInterval=r=>{var s;return(s=this.overrides)!=null&&s.eachMonthOfInterval?this.overrides.eachMonthOfInterval(r):jTe(r)},this.endOfBroadcastWeek=r=>{var s;return(s=this.overrides)!=null&&s.endOfBroadcastWeek?this.overrides.endOfBroadcastWeek(r):dit(r,this)},this.endOfISOWeek=r=>{var s;return(s=this.overrides)!=null&&s.endOfISOWeek?this.overrides.endOfISOWeek(r):DTe(r)},this.endOfMonth=r=>{var s;return(s=this.overrides)!=null&&s.endOfMonth?this.overrides.endOfMonth(r):NZ(r)},this.endOfWeek=(r,s)=>{var i;return(i=this.overrides)!=null&&i.endOfWeek?this.overrides.endOfWeek(r,s):IZ(r,this.options)},this.endOfYear=r=>{var s;return(s=this.overrides)!=null&&s.endOfYear?this.overrides.endOfYear(r):OTe(r)},this.format=(r,s,i)=>{var o;const a=(o=this.overrides)!=null&&o.format?this.overrides.format(r,s,this.options):gw(r,s,this.options);return this.options.numerals&&this.options.numerals!=="latn"?this.replaceDigits(a):a},this.getISOWeek=r=>{var s;return(s=this.overrides)!=null&&s.getISOWeek?this.overrides.getISOWeek(r):jZ(r)},this.getMonth=(r,s)=>{var i;return(i=this.overrides)!=null&&i.getMonth?this.overrides.getMonth(r,this.options):PAe(r,this.options)},this.getYear=(r,s)=>{var i;return(i=this.overrides)!=null&&i.getYear?this.overrides.getYear(r,this.options):OAe(r,this.options)},this.getWeek=(r,s)=>{var i;return(i=this.overrides)!=null&&i.getWeek?this.overrides.getWeek(r,this.options):OZ(r,this.options)},this.isAfter=(r,s)=>{var i;return(i=this.overrides)!=null&&i.isAfter?this.overrides.isAfter(r,s):DAe(r,s)},this.isBefore=(r,s)=>{var i;return(i=this.overrides)!=null&&i.isBefore?this.overrides.isBefore(r,s):FAe(r,s)},this.isDate=r=>{var s;return(s=this.overrides)!=null&&s.isDate?this.overrides.isDate(r):AZ(r)},this.isSameDay=(r,s)=>{var i;return(i=this.overrides)!=null&&i.isSameDay?this.overrides.isSameDay(r,s):CTe(r,s)},this.isSameMonth=(r,s)=>{var i;return(i=this.overrides)!=null&&i.isSameMonth?this.overrides.isSameMonth(r,s):LAe(r,s)},this.isSameYear=(r,s)=>{var i;return(i=this.overrides)!=null&&i.isSameYear?this.overrides.isSameYear(r,s):BAe(r,s)},this.max=r=>{var s;return(s=this.overrides)!=null&&s.max?this.overrides.max(r):wTe(r)},this.min=r=>{var s;return(s=this.overrides)!=null&&s.min?this.overrides.min(r):_Te(r)},this.setMonth=(r,s)=>{var i;return(i=this.overrides)!=null&&i.setMonth?this.overrides.setMonth(r,s):nRe(r,s)},this.setYear=(r,s)=>{var i;return(i=this.overrides)!=null&&i.setYear?this.overrides.setYear(r,s):rRe(r,s)},this.startOfBroadcastWeek=(r,s)=>{var i;return(i=this.overrides)!=null&&i.startOfBroadcastWeek?this.overrides.startOfBroadcastWeek(r,this):Jue(r,this)},this.startOfDay=r=>{var s;return(s=this.overrides)!=null&&s.startOfDay?this.overrides.startOfDay(r):mw(r)},this.startOfISOWeek=r=>{var s;return(s=this.overrides)!=null&&s.startOfISOWeek?this.overrides.startOfISOWeek(r):pw(r)},this.startOfMonth=r=>{var s;return(s=this.overrides)!=null&&s.startOfMonth?this.overrides.startOfMonth(r):PTe(r)},this.startOfWeek=(r,s)=>{var i;return(i=this.overrides)!=null&&i.startOfWeek?this.overrides.startOfWeek(r,this.options):py(r,this.options)},this.startOfYear=r=>{var s;return(s=this.overrides)!=null&&s.startOfYear?this.overrides.startOfYear(r):MZ(r)},this.options={locale:sT,...t},this.overrides=n}getDigitMap(){const{numerals:t="latn"}=this.options,n=new Intl.NumberFormat("en-US",{numberingSystem:t}),r={};for(let s=0;s<10;s++)r[s.toString()]=n.format(s);return r}replaceDigits(t){const n=this.getDigitMap();return t.replace(/\d/g,r=>n[r]||r)}formatNumber(t){return this.replaceDigits(t.toString())}}const Vu=new uf;class Que{constructor(t,n,r=Vu){this.date=t,this.displayMonth=n,this.outside=!!(n&&!r.isSameMonth(t,n)),this.dateLib=r}isEqualTo(t){return this.dateLib.isSameDay(t.date,this.date)&&this.dateLib.isSameMonth(t.displayMonth,this.displayMonth)}}class fit{constructor(t,n){this.date=t,this.weeks=n}}class hit{constructor(t,n){this.days=n,this.weekNumber=t}}function Nd(e,t,n=!1,r=Vu){let{from:s,to:i}=e;const{differenceInCalendarDays:a,isSameDay:o}=r;return s&&i?(a(i,s)<0&&([s,i]=[i,s]),a(t,s)>=(n?1:0)&&a(i,t)>=(n?1:0)):!n&&i?o(i,t):!n&&s?o(s,t):!1}function ede(e){return!!(e&&typeof e=="object"&&"before"in e&&"after"in e)}function Z5(e){return!!(e&&typeof e=="object"&&"from"in e)}function tde(e){return!!(e&&typeof e=="object"&&"after"in e)}function nde(e){return!!(e&&typeof e=="object"&&"before"in e)}function rde(e){return!!(e&&typeof e=="object"&&"dayOfWeek"in e)}function sde(e,t){return Array.isArray(e)&&e.every(t.isDate)}function Md(e,t,n=Vu){const r=Array.isArray(t)?t:[t],{isSameDay:s,differenceInCalendarDays:i,isAfter:a}=n;return r.some(o=>{if(typeof o=="boolean")return o;if(n.isDate(o))return s(e,o);if(sde(o,n))return o.includes(e);if(Z5(o))return Nd(o,e,!1,n);if(rde(o))return Array.isArray(o.dayOfWeek)?o.dayOfWeek.includes(e.getDay()):o.dayOfWeek===e.getDay();if(ede(o)){const l=i(o.before,e),c=i(o.after,e),u=l>0,d=c<0;return a(o.before,o.after)?d&&u:u||d}return tde(o)?i(e,o.after)>0:nde(o)?i(o.before,e)>0:typeof o=="function"?o(e):!1})}function pit(e,t,n){const{disabled:r,hidden:s,modifiers:i,showOutsideDays:a,broadcastCalendar:o,today:l}=t,{isSameDay:c,isSameMonth:u,startOfMonth:d,isBefore:h,endOfMonth:m,isAfter:y}=n,b=t.startMonth&&d(t.startMonth),v=t.endMonth&&m(t.endMonth),x={[Xs.focused]:[],[Xs.outside]:[],[Xs.disabled]:[],[Xs.hidden]:[],[Xs.today]:[]},w={};for(const S of e){const{date:C,displayMonth:k}=S,A=!!(k&&!u(C,k)),R=!!(b&&h(C,b)),N=!!(v&&y(C,v)),I=!!(r&&Md(C,r,n)),P=!!(s&&Md(C,s,n))||R||N||!o&&!a&&A||o&&a===!1&&A,L=c(C,l??n.today());A&&x.outside.push(S),I&&x.disabled.push(S),P&&x.hidden.push(S),L&&x.today.push(S),i&&Object.keys(i).forEach(O=>{const V=i==null?void 0:i[O];V&&Md(C,V,n)&&(w[O]?w[O].push(S):w[O]=[S])})}return S=>{const C={[Xs.focused]:!1,[Xs.disabled]:!1,[Xs.hidden]:!1,[Xs.outside]:!1,[Xs.today]:!1},k={};for(const A in x){const R=x[A];C[A]=R.some(N=>N===S)}for(const A in w)k[A]=w[A].some(R=>R===S);return{...C,...k}}}function mit(e,t,n={}){return Object.entries(e).filter(([,s])=>s===!0).reduce((s,[i])=>(n[i]?s.push(n[i]):t[Xs[i]]?s.push(t[Xs[i]]):t[_c[i]]&&s.push(t[_c[i]]),s),[t[Ln.Day]])}function git(e){return We.createElement("button",{...e})}function yit(e){return We.createElement("span",{...e})}function bit(e){const{size:t=24,orientation:n="left",className:r}=e;return We.createElement("svg",{className:r,width:t,height:t,viewBox:"0 0 24 24"},n==="up"&&We.createElement("polygon",{points:"6.77 17 12.5 11.43 18.24 17 20 15.28 12.5 8 5 15.28"}),n==="down"&&We.createElement("polygon",{points:"6.77 8 12.5 13.57 18.24 8 20 9.72 12.5 17 5 9.72"}),n==="left"&&We.createElement("polygon",{points:"16 18.112 9.81111111 12 16 5.87733333 14.0888889 4 6 12 14.0888889 20"}),n==="right"&&We.createElement("polygon",{points:"8 18.112 14.18888889 12 8 5.87733333 9.91111111 4 18 12 9.91111111 20"}))}function vit(e){const{day:t,modifiers:n,...r}=e;return We.createElement("td",{...r})}function xit(e){const{day:t,modifiers:n,...r}=e,s=We.useRef(null);return We.useEffect(()=>{var i;n.focused&&((i=s.current)==null||i.focus())},[n.focused]),We.createElement("button",{ref:s,...r})}function wit(e){const{options:t,className:n,components:r,classNames:s,...i}=e,a=[s[Ln.Dropdown],n].join(" "),o=t==null?void 0:t.find(({value:l})=>l===i.value);return We.createElement("span",{"data-disabled":i.disabled,className:s[Ln.DropdownRoot]},We.createElement(r.Select,{className:a,...i},t==null?void 0:t.map(({value:l,label:c,disabled:u})=>We.createElement(r.Option,{key:l,value:l,disabled:u},c))),We.createElement("span",{className:s[Ln.CaptionLabel],"aria-hidden":!0},o==null?void 0:o.label,We.createElement(r.Chevron,{orientation:"down",size:18,className:s[Ln.Chevron]})))}function _it(e){return We.createElement("div",{...e})}function Sit(e){return We.createElement("div",{...e})}function Cit(e){const{calendarMonth:t,displayIndex:n,...r}=e;return We.createElement("div",{...r},e.children)}function kit(e){const{calendarMonth:t,displayIndex:n,...r}=e;return We.createElement("div",{...r})}function Eit(e){return We.createElement("table",{...e})}function Tit(e){return We.createElement("div",{...e})}const ide=T.createContext(void 0);function l_(){const e=T.useContext(ide);if(e===void 0)throw new Error("useDayPicker() must be used within a custom component.");return e}function Ait(e){const{components:t}=l_();return We.createElement(t.Dropdown,{...e})}function Rit(e){const{onPreviousClick:t,onNextClick:n,previousMonth:r,nextMonth:s,...i}=e,{components:a,classNames:o,labels:{labelPrevious:l,labelNext:c}}=l_(),u=T.useCallback(h=>{s&&(n==null||n(h))},[s,n]),d=T.useCallback(h=>{r&&(t==null||t(h))},[r,t]);return We.createElement("nav",{...i},We.createElement(a.PreviousMonthButton,{type:"button",className:o[Ln.PreviousMonthButton],tabIndex:r?void 0:-1,"aria-disabled":r?void 0:!0,"aria-label":l(r),onClick:d},We.createElement(a.Chevron,{disabled:r?void 0:!0,className:o[Ln.Chevron],orientation:"left"})),We.createElement(a.NextMonthButton,{type:"button",className:o[Ln.NextMonthButton],tabIndex:s?void 0:-1,"aria-disabled":s?void 0:!0,"aria-label":c(s),onClick:u},We.createElement(a.Chevron,{disabled:s?void 0:!0,orientation:"right",className:o[Ln.Chevron]})))}function Nit(e){const{components:t}=l_();return We.createElement(t.Button,{...e})}function Mit(e){return We.createElement("option",{...e})}function Iit(e){const{components:t}=l_();return We.createElement(t.Button,{...e})}function jit(e){const{rootRef:t,...n}=e;return We.createElement("div",{...n,ref:t})}function Pit(e){return We.createElement("select",{...e})}function Oit(e){const{week:t,...n}=e;return We.createElement("tr",{...n})}function Dit(e){return We.createElement("th",{...e})}function Fit(e){return We.createElement("thead",{"aria-hidden":!0},We.createElement("tr",{...e}))}function Lit(e){const{week:t,...n}=e;return We.createElement("th",{...n})}function Bit(e){return We.createElement("th",{...e})}function $it(e){return We.createElement("tbody",{...e})}function zit(e){const{components:t}=l_();return We.createElement(t.Dropdown,{...e})}const Uit=Object.freeze(Object.defineProperty({__proto__:null,Button:git,CaptionLabel:yit,Chevron:bit,Day:vit,DayButton:xit,Dropdown:wit,DropdownNav:_it,Footer:Sit,Month:Cit,MonthCaption:kit,MonthGrid:Eit,Months:Tit,MonthsDropdown:Ait,Nav:Rit,NextMonthButton:Nit,Option:Mit,PreviousMonthButton:Iit,Root:jit,Select:Pit,Week:Oit,WeekNumber:Lit,WeekNumberHeader:Bit,Weekday:Dit,Weekdays:Fit,Weeks:$it,YearsDropdown:zit},Symbol.toStringTag,{value:"Module"}));function qit(e){return{...Uit,...e}}function Vit(e){const t={"data-mode":e.mode??void 0,"data-required":"required"in e?e.required:void 0,"data-multiple-months":e.numberOfMonths&&e.numberOfMonths>1||void 0,"data-week-numbers":e.showWeekNumber||void 0,"data-broadcast-calendar":e.broadcastCalendar||void 0,"data-nav-layout":e.navLayout||void 0};return Object.entries(e).forEach(([n,r])=>{n.startsWith("data-")&&(t[n]=r)}),t}function X5(){const e={};for(const t in Ln)e[Ln[t]]=`rdp-${Ln[t]}`;for(const t in Xs)e[Xs[t]]=`rdp-${Xs[t]}`;for(const t in _c)e[_c[t]]=`rdp-${_c[t]}`;for(const t in sl)e[sl[t]]=`rdp-${sl[t]}`;return e}function ade(e,t,n){return(n??new uf(t)).format(e,"LLLL y")}const Wit=ade;function Hit(e,t,n){return(n??new uf(t)).format(e,"d")}function Git(e,t=Vu){return t.format(e,"LLLL")}function Kit(e,t=Vu){return e<10?t.formatNumber(`0${e.toLocaleString()}`):t.formatNumber(`${e.toLocaleString()}`)}function Yit(){return""}function Zit(e,t,n){return(n??new uf(t)).format(e,"cccccc")}function ode(e,t=Vu){return t.format(e,"yyyy")}const Xit=ode,Jit=Object.freeze(Object.defineProperty({__proto__:null,formatCaption:ade,formatDay:Hit,formatMonthCaption:Wit,formatMonthDropdown:Git,formatWeekNumber:Kit,formatWeekNumberHeader:Yit,formatWeekdayName:Zit,formatYearCaption:Xit,formatYearDropdown:ode},Symbol.toStringTag,{value:"Module"}));function Qit(e){return e!=null&&e.formatMonthCaption&&!e.formatCaption&&(e.formatCaption=e.formatMonthCaption),e!=null&&e.formatYearCaption&&!e.formatYearDropdown&&(e.formatYearDropdown=e.formatYearCaption),{...Jit,...e}}function eat(e,t,n,r,s){const{startOfMonth:i,startOfYear:a,endOfYear:o,eachMonthOfInterval:l,getMonth:c}=s;return l({start:a(e),end:o(e)}).map(h=>{const m=r.formatMonthDropdown(h,s),y=c(h),b=t&&h<i(t)||n&&h>i(n)||!1;return{value:y,label:m,disabled:b}})}function tat(e,t={},n={}){let r={...t==null?void 0:t[Ln.Day]};return Object.entries(e).filter(([,s])=>s===!0).forEach(([s])=>{r={...r,...n==null?void 0:n[s]}}),r}function nat(e,t,n){const r=e.today(),s=t?e.startOfISOWeek(r):e.startOfWeek(r),i=[];for(let a=0;a<7;a++){const o=e.addDays(s,a);i.push(o)}return i}function rat(e,t,n,r){if(!e||!t)return;const{startOfYear:s,endOfYear:i,addYears:a,getYear:o,isBefore:l,isSameYear:c}=r,u=s(e),d=i(t),h=[];let m=u;for(;l(m,d)||c(m,d);)h.push(m),m=a(m,1);return h.map(y=>{const b=n.formatYearDropdown(y,r);return{value:o(y),label:b,disabled:!1}})}function lde(e,t,n){return(n??new uf(t)).format(e,"LLLL y")}const sat=lde;function iat(e,t,n,r){let s=(r??new uf(n)).format(e,"PPPP");return t!=null&&t.today&&(s=`Today, ${s}`),s}function cde(e,t,n,r){let s=(r??new uf(n)).format(e,"PPPP");return t.today&&(s=`Today, ${s}`),t.selected&&(s=`${s}, selected`),s}const aat=cde;function oat(){return""}function lat(e){return"Choose the Month"}function cat(e){return"Go to the Next Month"}function uat(e){return"Go to the Previous Month"}function dat(e,t,n){return(n??new uf(t)).format(e,"cccc")}function fat(e,t){return`Week ${e}`}function hat(e){return"Week Number"}function pat(e){return"Choose the Year"}const mat=Object.freeze(Object.defineProperty({__proto__:null,labelCaption:sat,labelDay:aat,labelDayButton:cde,labelGrid:lde,labelGridcell:iat,labelMonthDropdown:lat,labelNav:oat,labelNext:cat,labelPrevious:uat,labelWeekNumber:fat,labelWeekNumberHeader:hat,labelWeekday:dat,labelYearDropdown:pat},Symbol.toStringTag,{value:"Module"})),c_=e=>e instanceof HTMLElement?e:null,N3=e=>[...e.querySelectorAll("[data-animated-month]")??[]],gat=e=>c_(e.querySelector("[data-animated-month]")),M3=e=>c_(e.querySelector("[data-animated-caption]")),I3=e=>c_(e.querySelector("[data-animated-weeks]")),yat=e=>c_(e.querySelector("[data-animated-nav]")),bat=e=>c_(e.querySelector("[data-animated-weekdays]"));function vat(e,t,{classNames:n,months:r,focused:s,dateLib:i}){const a=T.useRef(null),o=T.useRef(r),l=T.useRef(!1);T.useLayoutEffect(()=>{const c=o.current;if(o.current=r,!t||!e.current||!(e.current instanceof HTMLElement)||r.length===0||c.length===0||r.length!==c.length)return;const u=i.isSameMonth(r[0].date,c[0].date),d=i.isAfter(r[0].date,c[0].date),h=d?n[sl.caption_after_enter]:n[sl.caption_before_enter],m=d?n[sl.weeks_after_enter]:n[sl.weeks_before_enter],y=a.current,b=e.current.cloneNode(!0);if(b instanceof HTMLElement?(N3(b).forEach(S=>{if(!(S instanceof HTMLElement))return;const C=gat(S);C&&S.contains(C)&&S.removeChild(C);const k=M3(S);k&&k.classList.remove(h);const A=I3(S);A&&A.classList.remove(m)}),a.current=b):a.current=null,l.current||u||s)return;const v=y instanceof HTMLElement?N3(y):[],x=N3(e.current);if(x&&x.every(w=>w instanceof HTMLElement)&&v&&v.every(w=>w instanceof HTMLElement)){l.current=!0,e.current.style.isolation="isolate";const w=yat(e.current);w&&(w.style.zIndex="1"),x.forEach((S,C)=>{const k=v[C];if(!k)return;S.style.position="relative",S.style.overflow="hidden";const A=M3(S);A&&A.classList.add(h);const R=I3(S);R&&R.classList.add(m);const N=()=>{l.current=!1,e.current&&(e.current.style.isolation=""),w&&(w.style.zIndex=""),A&&A.classList.remove(h),R&&R.classList.remove(m),S.style.position="",S.style.overflow="",S.contains(k)&&S.removeChild(k)};k.style.pointerEvents="none",k.style.position="absolute",k.style.overflow="hidden",k.setAttribute("aria-hidden","true");const I=bat(k);I&&(I.style.opacity="0");const P=M3(k);P&&(P.classList.add(d?n[sl.caption_before_exit]:n[sl.caption_after_exit]),P.addEventListener("animationend",N));const L=I3(k);L&&L.classList.add(d?n[sl.weeks_before_exit]:n[sl.weeks_after_exit]),S.insertBefore(k,S.firstChild)})}})}function xat(e,t,n,r){const s=e[0],i=e[e.length-1],{ISOWeek:a,fixedWeeks:o,broadcastCalendar:l}=n??{},{addDays:c,differenceInCalendarDays:u,differenceInCalendarMonths:d,endOfBroadcastWeek:h,endOfISOWeek:m,endOfMonth:y,endOfWeek:b,isAfter:v,startOfBroadcastWeek:x,startOfISOWeek:w,startOfWeek:S}=r,C=l?x(s,r):a?w(s):S(s),k=l?h(i):a?m(y(i)):b(y(i)),A=u(k,C),R=d(i,s)+1,N=[];for(let L=0;L<=A;L++){const O=c(C,L);if(t&&v(O,t))break;N.push(O)}const P=(l?35:42)*R;if(o&&N.length<P){const L=P-N.length;for(let O=0;O<L;O++){const V=c(N[N.length-1],1);N.push(V)}}return N}function wat(e){const t=[];return e.reduce((n,r)=>{const s=r.weeks.reduce((i,a)=>[...i,...a.days],t);return[...n,...s]},t)}function _at(e,t,n,r){const{numberOfMonths:s=1}=n,i=[];for(let a=0;a<s;a++){const o=r.addMonths(e,a);if(t&&o>t)break;i.push(o)}return i}function wW(e,t){const{month:n,defaultMonth:r,today:s=t.today(),numberOfMonths:i=1,endMonth:a,startMonth:o}=e;let l=n||r||s;const{differenceInCalendarMonths:c,addMonths:u,startOfMonth:d}=t;if(a&&c(a,l)<0){const h=-1*(i-1);l=u(a,h)}return o&&c(l,o)<0&&(l=o),d(l)}function Sat(e,t,n,r){const{addDays:s,endOfBroadcastWeek:i,endOfISOWeek:a,endOfMonth:o,endOfWeek:l,getISOWeek:c,getWeek:u,startOfBroadcastWeek:d,startOfISOWeek:h,startOfWeek:m}=r,y=e.reduce((b,v)=>{const x=n.broadcastCalendar?d(v,r):n.ISOWeek?h(v):m(v),w=n.broadcastCalendar?i(v):n.ISOWeek?a(o(v)):l(o(v)),S=t.filter(R=>R>=x&&R<=w),C=n.broadcastCalendar?35:42;if(n.fixedWeeks&&S.length<C){const R=t.filter(N=>{const I=C-S.length;return N>w&&N<=s(w,I)});S.push(...R)}const k=S.reduce((R,N)=>{const I=n.ISOWeek?c(N):u(N),P=R.find(O=>O.weekNumber===I),L=new Que(N,v,r);return P?P.days.push(L):R.push(new hit(I,[L])),R},[]),A=new fit(v,k);return b.push(A),b},[]);return n.reverseMonths?y.reverse():y}function Cat(e,t){let{startMonth:n,endMonth:r}=e;const{startOfYear:s,startOfDay:i,startOfMonth:a,endOfMonth:o,addYears:l,endOfYear:c,newDate:u,today:d}=t,{fromYear:h,toYear:m,fromMonth:y,toMonth:b}=e;!n&&y&&(n=y),!n&&h&&(n=t.newDate(h,0,1)),!r&&b&&(r=b),!r&&m&&(r=u(m,11,31));const v=e.captionLayout==="dropdown"||e.captionLayout==="dropdown-years";return n?n=a(n):h?n=u(h,0,1):!n&&v&&(n=s(l(e.today??d(),-100))),r?r=o(r):m?r=u(m,11,31):!r&&v&&(r=c(e.today??d())),[n&&i(n),r&&i(r)]}function kat(e,t,n,r){if(n.disableNavigation)return;const{pagedNavigation:s,numberOfMonths:i=1}=n,{startOfMonth:a,addMonths:o,differenceInCalendarMonths:l}=r,c=s?i:1,u=a(e);if(!t)return o(u,c);if(!(l(t,e)<i))return o(u,c)}function Eat(e,t,n,r){if(n.disableNavigation)return;const{pagedNavigation:s,numberOfMonths:i}=n,{startOfMonth:a,addMonths:o,differenceInCalendarMonths:l}=r,c=s?i??1:1,u=a(e);if(!t)return o(u,-c);if(!(l(u,t)<=0))return o(u,-c)}function Tat(e){const t=[];return e.reduce((n,r)=>[...n,...r.weeks],t)}function hA(e,t){const[n,r]=T.useState(e);return[t===void 0?n:t,r]}function Aat(e,t){const[n,r]=Cat(e,t),{startOfMonth:s,endOfMonth:i}=t,a=wW(e,t),[o,l]=hA(a,e.month?a:void 0);T.useEffect(()=>{const A=wW(e,t);l(A)},[e.timeZone]);const c=_at(o,r,e,t),u=xat(c,e.endMonth?i(e.endMonth):void 0,e,t),d=Sat(c,u,e,t),h=Tat(d),m=wat(d),y=Eat(o,n,e,t),b=kat(o,r,e,t),{disableNavigation:v,onMonthChange:x}=e,w=A=>h.some(R=>R.days.some(N=>N.isEqualTo(A))),S=A=>{if(v)return;let R=s(A);n&&R<s(n)&&(R=s(n)),r&&R>s(r)&&(R=s(r)),l(R),x==null||x(R)};return{months:d,weeks:h,days:m,navStart:n,navEnd:r,previousMonth:y,nextMonth:b,goToMonth:S,goToDay:A=>{w(A)||S(A.date)}}}var ou;(function(e){e[e.Today=0]="Today",e[e.Selected=1]="Selected",e[e.LastFocused=2]="LastFocused",e[e.FocusedModifier=3]="FocusedModifier"})(ou||(ou={}));function _W(e){return!e[Xs.disabled]&&!e[Xs.hidden]&&!e[Xs.outside]}function Rat(e,t,n,r){let s,i=-1;for(const a of e){const o=t(a);_W(o)&&(o[Xs.focused]&&i<ou.FocusedModifier?(s=a,i=ou.FocusedModifier):r!=null&&r.isEqualTo(a)&&i<ou.LastFocused?(s=a,i=ou.LastFocused):n(a.date)&&i<ou.Selected?(s=a,i=ou.Selected):o[Xs.today]&&i<ou.Today&&(s=a,i=ou.Today))}return s||(s=e.find(a=>_W(t(a)))),s}function Nat(e,t,n,r,s,i,a){const{ISOWeek:o,broadcastCalendar:l}=i,{addDays:c,addMonths:u,addWeeks:d,addYears:h,endOfBroadcastWeek:m,endOfISOWeek:y,endOfWeek:b,max:v,min:x,startOfBroadcastWeek:w,startOfISOWeek:S,startOfWeek:C}=a;let A={day:c,week:d,month:u,year:h,startOfWeek:R=>l?w(R,a):o?S(R):C(R),endOfWeek:R=>l?m(R):o?y(R):b(R)}[e](n,t==="after"?1:-1);return t==="before"&&r?A=v([r,A]):t==="after"&&s&&(A=x([s,A])),A}function ude(e,t,n,r,s,i,a,o=0){if(o>365)return;const l=Nat(e,t,n.date,r,s,i,a),c=!!(i.disabled&&Md(l,i.disabled,a)),u=!!(i.hidden&&Md(l,i.hidden,a)),d=l,h=new Que(l,d,a);return!c&&!u?h:ude(e,t,h,r,s,i,a,o+1)}function Mat(e,t,n,r,s){const{autoFocus:i}=e,[a,o]=T.useState(),l=Rat(t.days,n,r||(()=>!1),a),[c,u]=T.useState(i?l:void 0);return{isFocusTarget:b=>!!(l!=null&&l.isEqualTo(b)),setFocused:u,focused:c,blur:()=>{o(c),u(void 0)},moveFocus:(b,v)=>{if(!c)return;const x=ude(b,v,c,t.navStart,t.navEnd,e,s);x&&(t.goToDay(x),u(x))}}}function Iat(e,t){const{selected:n,required:r,onSelect:s}=e,[i,a]=hA(n,s?n:void 0),o=s?n:i,{isSameDay:l}=t,c=m=>(o==null?void 0:o.some(y=>l(y,m)))??!1,{min:u,max:d}=e;return{selected:o,select:(m,y,b)=>{let v=[...o??[]];if(c(m)){if((o==null?void 0:o.length)===u||r&&(o==null?void 0:o.length)===1)return;v=o==null?void 0:o.filter(x=>!l(x,m))}else(o==null?void 0:o.length)===d?v=[m]:v=[...v,m];return s||a(v),s==null||s(v,m,y,b),v},isSelected:c}}function jat(e,t,n=0,r=0,s=!1,i=Vu){const{from:a,to:o}=t||{},{isSameDay:l,isAfter:c,isBefore:u}=i;let d;if(!a&&!o)d={from:e,to:n>0?void 0:e};else if(a&&!o)l(a,e)?s?d={from:a,to:void 0}:d=void 0:u(e,a)?d={from:e,to:a}:d={from:a,to:e};else if(a&&o)if(l(a,e)&&l(o,e))s?d={from:a,to:o}:d=void 0;else if(l(a,e))d={from:a,to:n>0?void 0:e};else if(l(o,e))d={from:e,to:n>0?void 0:e};else if(u(e,a))d={from:e,to:o};else if(c(e,a))d={from:a,to:e};else if(c(e,o))d={from:a,to:e};else throw new Error("Invalid range");if(d!=null&&d.from&&(d!=null&&d.to)){const h=i.differenceInCalendarDays(d.to,d.from);r>0&&h>r?d={from:e,to:void 0}:n>1&&h<n&&(d={from:e,to:void 0})}return d}function Pat(e,t,n=Vu){const r=Array.isArray(t)?t:[t];let s=e.from;const i=n.differenceInCalendarDays(e.to,e.from),a=Math.min(i,6);for(let o=0;o<=a;o++){if(r.includes(s.getDay()))return!0;s=n.addDays(s,1)}return!1}function SW(e,t,n=Vu){return Nd(e,t.from,!1,n)||Nd(e,t.to,!1,n)||Nd(t,e.from,!1,n)||Nd(t,e.to,!1,n)}function Oat(e,t,n=Vu){const r=Array.isArray(t)?t:[t];if(r.filter(o=>typeof o!="function").some(o=>typeof o=="boolean"?o:n.isDate(o)?Nd(e,o,!1,n):sde(o,n)?o.some(l=>Nd(e,l,!1,n)):Z5(o)?o.from&&o.to?SW(e,{from:o.from,to:o.to},n):!1:rde(o)?Pat(e,o.dayOfWeek,n):ede(o)?n.isAfter(o.before,o.after)?SW(e,{from:n.addDays(o.after,1),to:n.addDays(o.before,-1)},n):Md(e.from,o,n)||Md(e.to,o,n):tde(o)||nde(o)?Md(e.from,o,n)||Md(e.to,o,n):!1))return!0;const a=r.filter(o=>typeof o=="function");if(a.length){let o=e.from;const l=n.differenceInCalendarDays(e.to,e.from);for(let c=0;c<=l;c++){if(a.some(u=>u(o)))return!0;o=n.addDays(o,1)}}return!1}function Dat(e,t){const{disabled:n,excludeDisabled:r,selected:s,required:i,onSelect:a}=e,[o,l]=hA(s,a?s:void 0),c=a?s:o;return{selected:c,select:(h,m,y)=>{const{min:b,max:v}=e,x=h?jat(h,c,b,v,i,t):void 0;return r&&n&&(x!=null&&x.from)&&x.to&&Oat({from:x.from,to:x.to},n,t)&&(x.from=h,x.to=void 0),a||l(x),a==null||a(x,h,m,y),x},isSelected:h=>c&&Nd(c,h,!1,t)}}function Fat(e,t){const{selected:n,required:r,onSelect:s}=e,[i,a]=hA(n,s?n:void 0),o=s?n:i,{isSameDay:l}=t;return{selected:o,select:(d,h,m)=>{let y=d;return!r&&o&&o&&l(d,o)&&(y=void 0),s||a(y),s==null||s(y,d,h,m),y},isSelected:d=>o?l(o,d):!1}}function Lat(e,t){const n=Fat(e,t),r=Iat(e,t),s=Dat(e,t);switch(e.mode){case"single":return n;case"multiple":return r;case"range":return s;default:return}}function Bat(e){var vt;let t=e;t.timeZone&&(t={...e},t.today&&(t.today=new Ia(t.today,t.timeZone)),t.month&&(t.month=new Ia(t.month,t.timeZone)),t.defaultMonth&&(t.defaultMonth=new Ia(t.defaultMonth,t.timeZone)),t.startMonth&&(t.startMonth=new Ia(t.startMonth,t.timeZone)),t.endMonth&&(t.endMonth=new Ia(t.endMonth,t.timeZone)),t.mode==="single"&&t.selected?t.selected=new Ia(t.selected,t.timeZone):t.mode==="multiple"&&t.selected?t.selected=(vt=t.selected)==null?void 0:vt.map(ot=>new Ia(ot,t.timeZone)):t.mode==="range"&&t.selected&&(t.selected={from:t.selected.from?new Ia(t.selected.from,t.timeZone):void 0,to:t.selected.to?new Ia(t.selected.to,t.timeZone):void 0}));const{components:n,formatters:r,labels:s,dateLib:i,locale:a,classNames:o}=T.useMemo(()=>{const ot={...sT,...t.locale};return{dateLib:new uf({locale:ot,weekStartsOn:t.broadcastCalendar?1:t.weekStartsOn,firstWeekContainsDate:t.firstWeekContainsDate,useAdditionalWeekYearTokens:t.useAdditionalWeekYearTokens,useAdditionalDayOfYearTokens:t.useAdditionalDayOfYearTokens,timeZone:t.timeZone,numerals:t.numerals},t.dateLib),components:qit(t.components),formatters:Qit(t.formatters),labels:{...mat,...t.labels},locale:ot,classNames:{...X5(),...t.classNames}}},[t.locale,t.broadcastCalendar,t.weekStartsOn,t.firstWeekContainsDate,t.useAdditionalWeekYearTokens,t.useAdditionalDayOfYearTokens,t.timeZone,t.numerals,t.dateLib,t.components,t.formatters,t.labels,t.classNames]),{captionLayout:l,mode:c,navLayout:u,numberOfMonths:d=1,onDayBlur:h,onDayClick:m,onDayFocus:y,onDayKeyDown:b,onDayMouseEnter:v,onDayMouseLeave:x,onNextClick:w,onPrevClick:S,showWeekNumber:C,styles:k}=t,{formatCaption:A,formatDay:R,formatMonthDropdown:N,formatWeekNumber:I,formatWeekNumberHeader:P,formatWeekdayName:L,formatYearDropdown:O}=r,V=Aat(t,i),{days:D,months:Z,navStart:U,navEnd:H,previousMonth:$,nextMonth:ne,goToMonth:W}=V,Q=pit(D,t,i),{isSelected:ee,select:se,selected:pe}=Lat(t,i)??{},{blur:ce,focused:Ie,isFocusTarget:De,moveFocus:Se,setFocused:Ce}=Mat(t,V,Q,ee??(()=>!1),i),{labelDayButton:qe,labelGridcell:Qe,labelGrid:Ve,labelMonthDropdown:Ne,labelNav:K,labelPrevious:ge,labelNext:Ae,labelWeekday:le,labelWeekNumber:oe,labelWeekNumberHeader:re,labelYearDropdown:Te}=s,Be=T.useMemo(()=>nat(i,t.ISOWeek),[i,t.ISOWeek]),ke=c!==void 0||m!==void 0,lt=T.useCallback(()=>{$&&(W($),S==null||S($))},[$,W,S]),Rt=T.useCallback(()=>{ne&&(W(ne),w==null||w(ne))},[W,ne,w]),ht=T.useCallback((ot,B)=>ze=>{ze.preventDefault(),ze.stopPropagation(),Ce(ot),se==null||se(ot.date,B,ze),m==null||m(ot.date,B,ze)},[se,m,Ce]),Pt=T.useCallback((ot,B)=>ze=>{Ce(ot),y==null||y(ot.date,B,ze)},[y,Ce]),qt=T.useCallback((ot,B)=>ze=>{ce(),h==null||h(ot.date,B,ze)},[ce,h]),Lt=T.useCallback((ot,B)=>ze=>{const st={ArrowLeft:["day",t.dir==="rtl"?"after":"before"],ArrowRight:["day",t.dir==="rtl"?"before":"after"],ArrowDown:["week","after"],ArrowUp:["week","before"],PageUp:[ze.shiftKey?"year":"month","before"],PageDown:[ze.shiftKey?"year":"month","after"],Home:["startOfWeek","before"],End:["endOfWeek","after"]};if(st[ze.key]){ze.preventDefault(),ze.stopPropagation();const[be,_e]=st[ze.key];Se(be,_e)}b==null||b(ot.date,B,ze)},[Se,b,t.dir]),en=T.useCallback((ot,B)=>ze=>{v==null||v(ot.date,B,ze)},[v]),xe=T.useCallback((ot,B)=>ze=>{x==null||x(ot.date,B,ze)},[x]),F=T.useCallback(ot=>B=>{const ze=Number(B.target.value),st=i.setMonth(i.startOfMonth(ot),ze);W(st)},[i,W]),X=T.useCallback(ot=>B=>{const ze=Number(B.target.value),st=i.setYear(i.startOfMonth(ot),ze);W(st)},[i,W]),{className:ye,style:Fe}=T.useMemo(()=>({className:[o[Ln.Root],t.className].filter(Boolean).join(" "),style:{...k==null?void 0:k[Ln.Root],...t.style}}),[o,t.className,t.style,k]),we=Vit(t),Me=T.useRef(null);vat(Me,!!t.animate,{classNames:o,months:Z,focused:Ie,dateLib:i});const de={dayPickerProps:t,selected:pe,select:se,isSelected:ee,months:Z,nextMonth:ne,previousMonth:$,goToMonth:W,getModifiers:Q,components:n,classNames:o,styles:k,labels:s,formatters:r};return We.createElement(ide.Provider,{value:de},We.createElement(n.Root,{rootRef:t.animate?Me:void 0,className:ye,style:Fe,dir:t.dir,id:t.id,lang:t.lang,nonce:t.nonce,title:t.title,role:t.role,"aria-label":t["aria-label"],...we},We.createElement(n.Months,{className:o[Ln.Months],style:k==null?void 0:k[Ln.Months]},!t.hideNavigation&&!u&&We.createElement(n.Nav,{"data-animated-nav":t.animate?"true":void 0,className:o[Ln.Nav],style:k==null?void 0:k[Ln.Nav],"aria-label":K(),onPreviousClick:lt,onNextClick:Rt,previousMonth:$,nextMonth:ne}),Z.map((ot,B)=>{const ze=eat(ot.date,U,H,r,i),st=rat(U,H,r,i);return We.createElement(n.Month,{"data-animated-month":t.animate?"true":void 0,className:o[Ln.Month],style:k==null?void 0:k[Ln.Month],key:B,displayIndex:B,calendarMonth:ot},u==="around"&&!t.hideNavigation&&B===0&&We.createElement(n.PreviousMonthButton,{type:"button",className:o[Ln.PreviousMonthButton],tabIndex:$?void 0:-1,"aria-disabled":$?void 0:!0,"aria-label":ge($),onClick:lt,"data-animated-button":t.animate?"true":void 0},We.createElement(n.Chevron,{disabled:$?void 0:!0,className:o[Ln.Chevron],orientation:t.dir==="rtl"?"right":"left"})),We.createElement(n.MonthCaption,{"data-animated-caption":t.animate?"true":void 0,className:o[Ln.MonthCaption],style:k==null?void 0:k[Ln.MonthCaption],calendarMonth:ot,displayIndex:B},l!=null&&l.startsWith("dropdown")?We.createElement(n.DropdownNav,{className:o[Ln.Dropdowns],style:k==null?void 0:k[Ln.Dropdowns]},l==="dropdown"||l==="dropdown-months"?We.createElement(n.MonthsDropdown,{className:o[Ln.MonthsDropdown],"aria-label":Ne(),classNames:o,components:n,disabled:!!t.disableNavigation,onChange:F(ot.date),options:ze,style:k==null?void 0:k[Ln.Dropdown],value:i.getMonth(ot.date)}):We.createElement("span",null,N(ot.date,i)),l==="dropdown"||l==="dropdown-years"?We.createElement(n.YearsDropdown,{className:o[Ln.YearsDropdown],"aria-label":Te(i.options),classNames:o,components:n,disabled:!!t.disableNavigation,onChange:X(ot.date),options:st,style:k==null?void 0:k[Ln.Dropdown],value:i.getYear(ot.date)}):We.createElement("span",null,O(ot.date,i)),We.createElement("span",{role:"status","aria-live":"polite",style:{border:0,clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"absolute",width:"1px",whiteSpace:"nowrap",wordWrap:"normal"}},A(ot.date,i.options,i))):We.createElement(n.CaptionLabel,{className:o[Ln.CaptionLabel],role:"status","aria-live":"polite"},A(ot.date,i.options,i))),u==="around"&&!t.hideNavigation&&B===d-1&&We.createElement(n.NextMonthButton,{type:"button",className:o[Ln.NextMonthButton],tabIndex:ne?void 0:-1,"aria-disabled":ne?void 0:!0,"aria-label":Ae(ne),onClick:Rt,"data-animated-button":t.animate?"true":void 0},We.createElement(n.Chevron,{disabled:ne?void 0:!0,className:o[Ln.Chevron],orientation:t.dir==="rtl"?"left":"right"})),B===d-1&&u==="after"&&!t.hideNavigation&&We.createElement(n.Nav,{"data-animated-nav":t.animate?"true":void 0,className:o[Ln.Nav],style:k==null?void 0:k[Ln.Nav],"aria-label":K(),onPreviousClick:lt,onNextClick:Rt,previousMonth:$,nextMonth:ne}),We.createElement(n.MonthGrid,{role:"grid","aria-multiselectable":c==="multiple"||c==="range","aria-label":Ve(ot.date,i.options,i)||void 0,className:o[Ln.MonthGrid],style:k==null?void 0:k[Ln.MonthGrid]},!t.hideWeekdays&&We.createElement(n.Weekdays,{"data-animated-weekdays":t.animate?"true":void 0,className:o[Ln.Weekdays],style:k==null?void 0:k[Ln.Weekdays]},C&&We.createElement(n.WeekNumberHeader,{"aria-label":re(i.options),className:o[Ln.WeekNumberHeader],style:k==null?void 0:k[Ln.WeekNumberHeader],scope:"col"},P()),Be.map((be,_e)=>We.createElement(n.Weekday,{"aria-label":le(be,i.options,i),className:o[Ln.Weekday],key:_e,style:k==null?void 0:k[Ln.Weekday],scope:"col"},L(be,i.options,i)))),We.createElement(n.Weeks,{"data-animated-weeks":t.animate?"true":void 0,className:o[Ln.Weeks],style:k==null?void 0:k[Ln.Weeks]},ot.weeks.map((be,_e)=>We.createElement(n.Week,{className:o[Ln.Week],key:be.weekNumber,style:k==null?void 0:k[Ln.Week],week:be},C&&We.createElement(n.WeekNumber,{week:be,style:k==null?void 0:k[Ln.WeekNumber],"aria-label":oe(be.weekNumber,{locale:a}),className:o[Ln.WeekNumber],scope:"row",role:"rowheader"},I(be.weekNumber,i)),be.days.map(Ue=>{const{date:kt}=Ue,fe=Q(Ue);if(fe[Xs.focused]=!fe.hidden&&!!(Ie!=null&&Ie.isEqualTo(Ue)),fe[_c.selected]=(ee==null?void 0:ee(kt))||fe.selected,Z5(pe)){const{from:ve,to:Oe}=pe;fe[_c.range_start]=!!(ve&&Oe&&i.isSameDay(kt,ve)),fe[_c.range_end]=!!(ve&&Oe&&i.isSameDay(kt,Oe)),fe[_c.range_middle]=Nd(pe,kt,!0,i)}const Y=tat(fe,k,t.modifiersStyles),G=mit(fe,o,t.modifiersClassNames),J=!ke&&!fe.hidden?Qe(kt,fe,i.options,i):void 0;return We.createElement(n.Day,{key:`${i.format(kt,"yyyy-MM-dd")}_${i.format(Ue.displayMonth,"yyyy-MM")}`,day:Ue,modifiers:fe,className:G.join(" "),style:Y,role:"gridcell","aria-selected":fe.selected||void 0,"aria-label":J,"data-day":i.format(kt,"yyyy-MM-dd"),"data-month":Ue.outside?i.format(kt,"yyyy-MM"):void 0,"data-selected":fe.selected||void 0,"data-disabled":fe.disabled||void 0,"data-hidden":fe.hidden||void 0,"data-outside":Ue.outside||void 0,"data-focused":fe.focused||void 0,"data-today":fe.today||void 0},!fe.hidden&&ke?We.createElement(n.DayButton,{className:o[Ln.DayButton],style:k==null?void 0:k[Ln.DayButton],type:"button",day:Ue,modifiers:fe,disabled:fe.disabled||void 0,tabIndex:De(Ue)?0:-1,"aria-label":qe(kt,fe,i.options,i),onClick:ht(Ue,fe),onBlur:qt(Ue,fe),onFocus:Pt(Ue,fe),onKeyDown:Lt(Ue,fe),onMouseEnter:en(Ue,fe),onMouseLeave:xe(Ue,fe)},R(kt,i.options,i)):!fe.hidden&&R(Ue.date,i.options,i))}))))))})),t.footer&&We.createElement(n.Footer,{className:o[Ln.Footer],style:k==null?void 0:k[Ln.Footer],role:"status","aria-live":"polite"},t.footer)))}function $at({className:e,classNames:t,showOutsideDays:n=!0,captionLayout:r="label",buttonVariant:s="ghost",formatters:i,components:a,...o}){const l=X5();return f.jsx(Bat,{showOutsideDays:n,className:Ze("bg-background group/calendar p-3 [--cell-size:--spacing(8)] [[data-slot=card-content]_&]:bg-transparent [[data-slot=popover-content]_&]:bg-transparent",String.raw`rtl:**:[.rdp-button\_next>svg]:rotate-180`,String.raw`rtl:**:[.rdp-button\_previous>svg]:rotate-180`,e),captionLayout:r,formatters:{formatMonthDropdown:c=>c.toLocaleString("default",{month:"short"}),...i},classNames:{root:Ze("w-fit",l.root),months:Ze("flex gap-4 flex-col md:flex-row relative",l.months),month:Ze("flex flex-col w-full gap-4",l.month),nav:Ze("flex items-center gap-1 w-full absolute top-0 inset-x-0 justify-between",l.nav),button_previous:Ze(q3({variant:s}),"size-(--cell-size) aria-disabled:opacity-50 p-0 select-none",l.button_previous),button_next:Ze(q3({variant:s}),"size-(--cell-size) aria-disabled:opacity-50 p-0 select-none",l.button_next),month_caption:Ze("flex items-center justify-center h-(--cell-size) w-full px-(--cell-size)",l.month_caption),dropdowns:Ze("w-full flex items-center text-sm font-medium justify-center h-(--cell-size) gap-1.5",l.dropdowns),dropdown_root:Ze("relative has-focus:border-ring border border-input shadow-xs has-focus:ring-ring/50 has-focus:ring-[3px] rounded-md",l.dropdown_root),dropdown:Ze("absolute inset-0 opacity-0",l.dropdown),caption_label:Ze("select-none font-medium",r==="label"?"text-sm":"rounded-md pl-2 pr-1 flex items-center gap-1 text-sm h-8 [&>svg]:text-muted-foreground [&>svg]:size-3.5",l.caption_label),table:"w-full border-collapse",weekdays:Ze("flex",l.weekdays),weekday:Ze("text-muted-foreground rounded-md flex-1 font-normal text-[0.8rem] select-none",l.weekday),week:Ze("flex w-full mt-2",l.week),week_number_header:Ze("select-none w-(--cell-size)",l.week_number_header),week_number:Ze("text-[0.8rem] select-none text-muted-foreground",l.week_number),day:Ze("relative w-full h-full p-0 text-center [&:first-child[data-selected=true]_button]:rounded-l-md [&:last-child[data-selected=true]_button]:rounded-r-md group/day aspect-square select-none",l.day),range_start:Ze("rounded-l-md bg-accent",l.range_start),range_middle:Ze("rounded-none",l.range_middle),range_end:Ze("rounded-r-md bg-accent",l.range_end),today:Ze("bg-accent text-accent-foreground rounded-md data-[selected=true]:rounded-none",l.today),outside:Ze("text-muted-foreground aria-selected:text-muted-foreground",l.outside),disabled:Ze("text-muted-foreground opacity-50",l.disabled),hidden:Ze("invisible",l.hidden),...t},components:{Root:({className:c,rootRef:u,...d})=>f.jsx("div",{"data-slot":"calendar",ref:u,className:Ze(c),...d}),Chevron:({className:c,orientation:u,...d})=>u==="left"?f.jsx(wpe,{className:Ze("size-4",c),...d}):u==="right"?f.jsx(IP,{className:Ze("size-4",c),...d}):f.jsx(Jl,{className:Ze("size-4",c),...d}),DayButton:zat,WeekNumber:({children:c,...u})=>f.jsx("td",{...u,children:f.jsx("div",{className:"flex size-(--cell-size) items-center justify-center text-center",children:c})}),...a},...o})}function zat({className:e,day:t,modifiers:n,...r}){const s=X5(),i=T.useRef(null);return T.useEffect(()=>{var a;n.focused&&((a=i.current)==null||a.focus())},[n.focused]),f.jsx(ft,{ref:i,variant:"ghost",size:"icon","data-day":t.date.toLocaleDateString(),"data-selected-single":n.selected&&!n.range_start&&!n.range_end&&!n.range_middle,"data-range-start":n.range_start,"data-range-end":n.range_end,"data-range-middle":n.range_middle,className:Ze("data-[selected-single=true]:bg-primary data-[selected-single=true]:text-primary-foreground data-[range-middle=true]:bg-accent data-[range-middle=true]:text-accent-foreground data-[range-start=true]:bg-primary data-[range-start=true]:text-primary-foreground data-[range-end=true]:bg-primary data-[range-end=true]:text-primary-foreground group-data-[focused=true]/day:border-ring group-data-[focused=true]/day:ring-ring/50 dark:hover:text-accent-foreground flex aspect-square size-auto w-full min-w-(--cell-size) flex-col gap-1 leading-none font-normal group-data-[focused=true]/day:relative group-data-[focused=true]/day:z-10 group-data-[focused=true]/day:ring-[3px] data-[range-end=true]:rounded-md data-[range-end=true]:rounded-r-md data-[range-middle=true]:rounded-none data-[range-start=true]:rounded-md data-[range-start=true]:rounded-l-md [&>span]:text-xs [&>span]:opacity-70",s.day,e),...r})}const Uat=({fieldApi:e,label:t,placeholder:n="Pick a date",description:r,inputClassName:s,labelClassName:i,wrapperClassName:a})=>{const[o,l]=We.useState(!1),c=e.state.value?e.state.value instanceof Date?e.state.value:typeof e.state.value=="string"?$Ae(e.state.value):void 0:void 0,u=d=>{e.handleChange(d),e.handleBlur(),l(!1)};return f.jsxs("div",{className:Ze("space-y-1.5",a),children:[t&&f.jsx(It,{htmlFor:e.name+"-trigger",className:Ze("text-sm font-medium",i),children:t}),r&&f.jsx("p",{className:"text-xs text-muted-foreground",children:r}),f.jsxs(vl,{open:o,onOpenChange:l,children:[f.jsx(xl,{asChild:!0,children:f.jsxs(ft,{id:e.name+"-trigger",variant:"outline",className:Ze("w-full justify-start text-left font-normal",!c&&"text-muted-foreground",s,e.state.meta.errors.length?"border-destructive":""),disabled:e.form.state.isSubmitting,onBlur:e.handleBlur,children:[f.jsx(ype,{className:"mr-2 h-4 w-4"}),c?gw(c,"PPP"):f.jsx("span",{children:n})]})}),f.jsx(wl,{className:"w-auto p-0",children:f.jsx($at,{mode:"single",selected:c,onSelect:u,initialFocus:!0,disabled:e.form.state.isSubmitting})})]}),e.state.meta.isTouched&&e.state.meta.errors.length>0&&f.jsx("div",{className:"text-xs text-destructive pt-1",children:e.state.meta.errors.map((d,h)=>f.jsx("p",{children:String(d)},h))})]})},qat=({fieldApi:e,label:t,description:n,min:r=0,max:s=100,step:i=1,valueLabelPrefix:a="",valueLabelSuffix:o="",valueDisplayPrecision:l=0,showRawValue:c=!1,wrapperClassName:u,inputClassName:d,labelClassName:h})=>{const{name:m,state:y,handleChange:b,handleBlur:v}=e,x=typeof y.value=="number"?y.value:r,w=x.toFixed(l);return f.jsxs("div",{className:Ze("space-y-1.5",u),children:[t&&f.jsxs(It,{htmlFor:m,className:Ze("text-sm font-medium",h),children:[t," (",a,w,o,")",c&&f.jsxs("span",{className:"text-xs text-muted-foreground ml-2",children:["(Raw: ",y.value,")"]})]}),n&&f.jsx("p",{className:"text-xs text-muted-foreground",children:n}),f.jsx(k0,{id:m,name:m,value:[x],onValueChange:S=>b(S[0]),onBlur:v,disabled:e.form.state.isSubmitting,min:r,max:s,step:i,className:Ze(d,y.meta.errors.length?"border-destructive":"")}),y.meta.isTouched&&y.meta.errors.length>0&&f.jsx("div",{className:"text-xs text-destructive pt-1",children:y.meta.errors.map((S,C)=>f.jsx("p",{children:typeof S=="string"?S:(S==null?void 0:S.message)||"Invalid"},C))})]})},Vat=({fieldApi:e,label:t,accept:n,className:r,wrapperClassName:s,description:i})=>{const{name:a,state:o,handleChange:l,handleBlur:c}=e,u=o.value,d=y=>{var v;const b=((v=y.target.files)==null?void 0:v[0])??null;l(b),c()},h=()=>{l(null);const y=document.getElementById(a);y&&(y.value=""),c()},m=()=>{const y=document.getElementById(a);y==null||y.click()};return f.jsxs("div",{className:Ze("space-y-1.5",s),children:[t&&f.jsx(It,{className:"text-sm font-medium cursor-pointer",onClick:m,children:t}),i&&f.jsx("p",{className:"text-xs text-muted-foreground",children:i}),f.jsx(_n,{id:a,name:a,type:"file",accept:n,onChange:d,className:"hidden"}),u?f.jsxs("div",{className:"flex items-center justify-between p-2.5 border rounded-lg bg-muted/40 shadow-sm hover:shadow-md transition-shadow",children:[f.jsxs("div",{className:"flex items-center gap-2 text-sm overflow-hidden",children:[f.jsx(fE,{className:"h-5 w-5 text-primary shrink-0"}),f.jsx("span",{className:"truncate",title:u.name,children:u.name}),f.jsxs("span",{className:"text-xs text-muted-foreground whitespace-nowrap",children:["(",(u.size/1024).toFixed(1)," KB)"]})]}),f.jsx(ft,{type:"button",variant:"ghost",size:"icon",onClick:h,className:"h-7 w-7 text-destructive hover:bg-destructive/10 shrink-0","aria-label":"Remove file",children:f.jsx(qi,{className:"h-4 w-4"})})]}):f.jsxs("button",{type:"button",onClick:m,className:Ze("w-full flex flex-col items-center justify-center p-4 border-2 border-dashed rounded-lg hover:border-primary transition-colors cursor-pointer bg-background hover:bg-muted/50",r,o.meta.errors.length?"border-destructive hover:border-destructive":"border-muted-foreground/50"),children:[f.jsx(jP,{className:"h-8 w-8 text-muted-foreground mb-2"}),f.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Click or drag and drop a file"}),n&&f.jsxs("span",{className:"text-xs text-muted-foreground/80 mt-1",children:["Accepted types: ",n]})]}),o.meta.isTouched&&o.meta.errors.length>0&&f.jsx("div",{className:"text-xs text-destructive pt-1",children:o.meta.errors.map((y,b)=>f.jsx("p",{children:typeof y=="string"?y:(y==null?void 0:y.message)||"Invalid"},b))})]})},Wat={text:mx,email:mx,password:mx,url:mx,textarea:tit,select:nit,checkbox:rit,switch:sit,number:iit,date:Uat,slider:qat,file:Vat},Hat=({value:e,currentPage:t,totalPages:n,className:r})=>f.jsxs("div",{className:Ze("space-y-2",r),children:[f.jsxs("div",{className:"flex justify-between text-sm text-muted-foreground",children:[f.jsxs("span",{children:["Step ",t," of ",n]}),f.jsxs("span",{children:[Math.round(e),"%"]})]}),f.jsx(Ny,{value:e,className:"h-2"})]}),Gat=({children:e,title:t,description:n})=>f.jsxs("div",{className:"space-y-6",children:[(t||n)&&f.jsxs("div",{className:"space-y-2",children:[t&&f.jsx("h3",{className:"text-lg font-semibold",children:t}),n&&f.jsx("p",{className:"text-muted-foreground",children:n})]}),f.jsx("div",{className:"space-y-4",children:e})]});function J5(e){const{fields:t=[],schema:n,submitLabel:r="Submit",nextLabel:s="Next",previousLabel:i="Previous",formClassName:a,fieldClassName:o,pages:l=[],progress:c,defaultComponents:u={},globalWrapper:d,formOptions:h,onPageChange:m,autoSubmitOnChange:y=!1,autoSubmitDebounceMs:b=1e3,disabled:v=!1,loading:x=!1,resetOnSubmitSuccess:w=!1}=e,[S,C]=T.useState(1),k={...Wat,...u},A=T.useMemo(()=>{const ne={};return t.forEach(W=>{const Q=W.page||1;ne[Q]||(ne[Q]=[]),ne[Q].push(W)}),ne},[t]),R=Math.max(...Object.keys(A).map(Number),1),N=R>1,I=N?(S-1)/(R-1)*100:100,P={...h,...n&&{validators:{onChange:n,...h==null?void 0:h.validators}},...w&&(h==null?void 0:h.onSubmit)&&{onSubmit:async ne=>{try{const W=await h.onSubmit(ne);return L.reset(),W}catch(W){throw W}}}},L=ri(P);We.useEffect(()=>{const ne=[];let W,Q;if(h!=null&&h.onChange||y){const ee=L.store.subscribe(()=>{const se=L,pe=se.state.values;h!=null&&h.onChange&&se.state.isValid&&(clearTimeout(Q),Q=setTimeout(()=>{h.onChange({value:pe,formApi:se})},300)),y&&!v&&!x&&(clearTimeout(W),W=setTimeout(()=>{L.state.canSubmit&&L.handleSubmit()},b))});ne.push(ee)}return ne.push(()=>{clearTimeout(W),clearTimeout(Q)}),()=>{ne.forEach(ee=>ee())}},[L,y,b,v,x]);const O=()=>A[S]||[],V=()=>l.find(ne=>ne.page===S),D=()=>{if(S<R){const ne=S+1;C(ne),m==null||m(ne,"next")}},Z=()=>{if(S>1){const ne=S-1;C(ne),m==null||m(ne,"previous")}},U=S===R,H=S===1;return{form:L,Form:({className:ne,children:W,onSubmit:Q})=>{const ee=Se=>{Se.preventDefault(),Se.stopPropagation(),Q?Q(Se):U?L.handleSubmit():D()},se=Ze("space-y-6",a,ne),pe=Se=>{const{name:Ce,type:qe,label:Qe,placeholder:Ve,description:Ne,options:K,min:ge,max:Ae,step:le,accept:oe,multiple:re,component:Te,wrapper:Be,conditional:ke,validation:lt}=Se;return f.jsx(L.Field,{name:Ce,validators:lt?{onChange:lt}:void 0,children:Rt=>{const ht=Rt.form.state.values;if(ke&&!ke(ht))return null;const Pt={fieldApi:Rt,label:Qe,placeholder:Ve,description:Ne,wrapperClassName:o,min:ge,max:Ae,step:le,accept:oe,multiple:re,disabled:v||x||Rt.form.state.isSubmitting},qt=Te||k[qe]||mx,Lt=qe==="select"?{...Pt,options:K||[]}:{...Pt,type:["text","email","password","url"].includes(qe)?qe:void 0},en=f.jsx(qt,{...Lt}),xe=Be||d;return xe?f.jsx(xe,{field:Se,children:en}):en}},Ce)},ce=()=>{const Se=O(),Ce=V(),qe=Se.map(Ve=>pe(Ve)).filter(Boolean),Qe=(Ce==null?void 0:Ce.component)||Gat;return f.jsx(Qe,{title:Ce==null?void 0:Ce.title,description:Ce==null?void 0:Ce.description,page:S,totalPages:R,children:qe})},Ie=()=>{if(!N||!c)return null;const Se=c.component||Hat;return f.jsx(Se,{value:I,currentPage:S,totalPages:R,className:c.className})},De=()=>N?f.jsx(L.Subscribe,{selector:Se=>({canSubmit:Se.canSubmit,isSubmitting:Se.isSubmitting}),children:Se=>{const{canSubmit:Ce,isSubmitting:qe}=Se;return f.jsxs("div",{className:"flex justify-between gap-4",children:[f.jsx(ft,{type:"button",variant:"outline",onClick:Z,disabled:H||v||x,className:H?"invisible":"",children:i}),f.jsx(ft,{type:"submit",disabled:(!Ce||qe||v||x)&&U,className:"flex-1 max-w-xs",children:x&&U?"Loading...":qe&&U?"Submitting...":U?r:s})]})}}):f.jsx(L.Subscribe,{selector:Se=>({canSubmit:Se.canSubmit,isSubmitting:Se.isSubmitting}),children:Se=>{const{canSubmit:Ce,isSubmitting:qe}=Se;return f.jsx(ft,{type:"submit",disabled:!Ce||qe||v||x,className:"w-full",children:x?"Loading...":qe?"Submitting...":r})}});return f.jsx("form",{onSubmit:ee,className:se,children:W||f.jsxs(f.Fragment,{children:[Ie(),ce(),De()]})})},currentPage:S,totalPages:R,goToNextPage:D,goToPreviousPage:Z,setCurrentPage:C,isFirstPage:H,isLastPage:U,progressValue:I}}function Kat({templates:e,onSelect:t}){const[n,r]=T.useState(""),s=e.filter(i=>i.name.toLowerCase().includes(n.toLowerCase())||i.description.toLowerCase().includes(n.toLowerCase())||i.tags.some(a=>a.toLowerCase().includes(n.toLowerCase())));return f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx(It,{htmlFor:"search",children:"Search Templates"}),f.jsx(_n,{id:"search",placeholder:"Search by name, description, or tags...",value:n,onChange:i=>r(i.target.value)})]}),f.jsx("div",{className:"grid gap-3",children:s.length===0?f.jsx("div",{className:"text-center py-8 text-muted-foreground",children:n?"No templates match your search.":"No templates available."}):s.map(i=>f.jsxs(cl,{className:"cursor-pointer hover:bg-muted/50 transition-colors",onClick:()=>t(i),children:[f.jsx(ul,{className:"pb-3",children:f.jsxs("div",{className:"flex items-start justify-between",children:[f.jsxs("div",{children:[f.jsx(dl,{className:"text-sm",children:i.name}),f.jsx(Bd,{className:"text-xs",children:i.description})]}),i.isPublic&&f.jsx(is,{variant:"default",className:"text-xs",children:"Public"})]})}),f.jsx(fl,{className:"pt-0",children:f.jsxs("div",{className:"flex flex-wrap gap-1",children:[i.tags.map(a=>f.jsx(is,{variant:"outline",className:"text-xs",children:a},a)),i.variables.length>0&&f.jsxs(is,{variant:"secondary",className:"text-xs",children:[i.variables.length," variables"]}),i.tools&&i.tools.length>0&&f.jsxs(is,{variant:"secondary",className:"text-xs",children:[i.tools.length," tools"]}),i.rules&&i.rules.length>0&&f.jsxs(is,{variant:"secondary",className:"text-xs",children:[i.rules.length," rules"]})]})})]},i.id))})]})}function Yat({template:e,onSubmit:t,onBack:n,previewElementRef:r,onCompile:s}){const i=e.variables.map(l=>({name:l.name,type:l.type==="boolean"?"switch":l.type==="number"?"number":l.type==="array"?"textarea":"text",label:l.name,placeholder:l.default||`Enter ${l.name}`,description:l.description||l.instructions,required:l.required})),a=e.variables.reduce((l,c)=>{if(c.default)if(c.type==="number")l[c.name]=parseFloat(c.default)||0;else if(c.type==="boolean")l[c.name]=c.default.toLowerCase()==="true";else if(c.type==="array")try{l[c.name]=JSON.parse(c.default)}catch{l[c.name]=c.default.split(",").map(u=>u.trim())}else l[c.name]=c.default;return l},{}),{Form:o}=J5({fields:i,submitLabel:"Proompt !",formOptions:{defaultValues:a,onSubmit:async({value:l})=>{t(l)},onChange:async({value:l})=>{await s(l)}}});return f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx(ft,{variant:"outline",size:"sm",onClick:n,children:"← Back"}),f.jsxs("div",{children:[f.jsx("h3",{className:"font-medium",children:e.name}),f.jsx("p",{className:"text-sm text-muted-foreground",children:e.description})]})]}),f.jsxs("div",{className:"md:flex md:space-x-4",children:[f.jsx("div",{className:"md:w-1/2 border rounded-lg p-4",children:e.variables.length===0?f.jsxs("div",{className:"text-center",children:[f.jsx("p",{className:"text-muted-foreground",children:"This template has no variables defined. The template will be applied as-is."}),f.jsx(ft,{onClick:()=>t({}),className:"mt-3",children:"Proompt !"})]}):f.jsxs(f.Fragment,{children:[f.jsx(It,{className:"text-sm font-medium mb-4 block",children:"Template Variables"}),f.jsx(o,{})]})}),f.jsxs("div",{className:"md:w-1/2 border rounded-lg p-4",children:[f.jsx(It,{className:"text-sm font-medium",children:"Live Preview"}),f.jsx("div",{ref:r,className:"mt-2 p-3 bg-muted rounded text-sm font-mono whitespace-pre-wrap max-h-64 overflow-y-auto",children:e.prompt})]})]})]})}const Zat=({module:e})=>{const[t,n]=T.useState(!1),[r,s]=T.useState(null),i=T.useRef(null),{loadPromptTemplates:a,getTemplatesByType:o}=Om(yn(m=>({loadPromptTemplates:m.loadPromptTemplates,getTemplatesByType:m.getTemplatesByType}))),l=o("prompt");T.useEffect(()=>{t&&a()},[t,a]);const c=m=>{s(m),i.current&&(i.current.textContent=m.prompt)},u=async m=>{if(r)try{await e.applyTemplate(r.id,m),n(!1),s(null),je.success("Template applied to input area!")}catch(y){console.error("Failed to Proompt :",y),je.error("Failed to Proompt !")}},d=()=>{s(null)},h=async m=>{if(!(!r||!i.current))try{const y=await e.compileTemplate(r.id,m);i.current.textContent=y.content}catch(y){i.current.textContent=`Error: ${y instanceof Error?y.message:"Compilation failed"}`}};return f.jsxs(f.Fragment,{children:[f.jsx(ft,{variant:"ghost",size:"sm",onClick:()=>n(!0),className:"h-8 w-8 p-0",title:"Open Prompt Library",children:f.jsx(fpe,{className:"h-4 w-4"})}),f.jsx(lp,{open:t,onOpenChange:n,children:f.jsxs(cp,{className:"!w-[80vw] !h-[85vh] !max-w-none flex flex-col",children:[f.jsxs(up,{children:[f.jsx(dp,{children:r?"Fill Template Variables":"Prompt Library"}),f.jsx(ng,{children:r?"Provide values for the template variables below.":"Select a prompt template to use. Templates can include dynamic variables, auto-select tools, and rules."})]}),f.jsx("div",{className:"flex-1 overflow-hidden",children:r?f.jsx(Yat,{template:r,onSubmit:u,onBack:d,module:e,previewElementRef:i,onCompile:h}):f.jsx(Kat,{templates:l,onSelect:c})})]})})]})};class Xat{constructor(){me(this,"id","core-prompt-library");me(this,"unregisterCallback",null);me(this,"eventUnsubscribers",[]);me(this,"notifyComponentUpdate",null);me(this,"isStreaming",!1);me(this,"modApiRef",null);me(this,"getIsStreaming",()=>this.isStreaming);me(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t});me(this,"compileTemplate",async(t,n)=>{const{compilePromptTemplate:r}=Om.getState();return await r(t,n)});me(this,"applyTemplate",async(t,n)=>{var s;const r=await this.compileTemplate(t,n);(s=this.modApiRef)==null||s.emit(Nn.setInputTextRequest,{text:r.content})})}async initialize(t){this.modApiRef=t,this.isStreaming=$n.getState().status==="streaming";const n=t.on(Zn.statusChanged,r=>{var s;typeof r=="object"&&r&&"status"in r&&this.isStreaming!==(r.status==="streaming")&&(this.isStreaming=r.status==="streaming",(s=this.notifyComponentUpdate)==null||s.call(this))});this.eventUnsubscribers.push(n)}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>We.createElement(Zat,{module:this})})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),console.log(`[${this.id}] Destroyed.`)}}const Jat=e=>{const{size:t=24,color:n="currentColor",...r}=e;return f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t,height:t,viewBox:"0 0 512 512",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",...r,children:f.jsxs("g",{transform:"translate(0.000000,512.000000) scale(0.100000,-0.100000)",fill:n,stroke:"none",children:[f.jsx("path",{d:`M2310 5053 c-1035 -101 -1883 -794 -2159 -1764 -55 -194 -79 -338
-91 -552 -18 -323 20 -620 117 -907 92 -272 238 -543 404 -747 33 -39 59 -75
59 -78 0 -4 -49 -129 -109 -279 -252 -624 -251 -621 -196 -676 57 -56 73 -53
351 58 137 55 349 143 472 195 l223 95 77 -38 c221 -109 437 -179 680 -219
132 -23 411 -44 475 -37 23 3 85 8 137 11 404 26 806 168 1180 417 282 188
571 489 759 792 400 642 467 1498 174 2216 -179 439 -495 826 -888 1088 -361
239 -743 378 -1165 422 -88 9 -419 11 -500 3z m404 -463 c-1 -30 -17 -128 -36
-217 l-34 -163 137 0 c128 0 139 -1 149 -20 11 -21 4 -44 -22 -72 -7 -7 -68
-75 -135 -150 l-123 -136 0 -175 0 -175 238 -4 c265 -5 329 -16 469 -82 220
-105 414 -311 486 -519 l24 -68 86 -4 c129 -7 195 -43 236 -130 20 -42 21 -61
21 -300 0 -240 -1 -258 -21 -297 -46 -90 -115 -127 -235 -128 l-82 0 -11 -47
c-17 -66 -71 -179 -119 -250 -108 -159 -276 -293 -452 -361 -174 -66 -251 -72
-830 -63 l-475 8 -89 27 c-303 91 -554 328 -650 614 l-23 67 -89 5 c-98 6
-131 20 -180 72 -63 66 -64 72 -64 354 0 240 1 261 21 301 40 84 105 119 232
129 l84 7 32 80 c84 215 291 424 513 519 126 53 225 68 466 68 l212 0 0 268 0
267 -126 -3 c-108 -3 -129 -1 -145 14 -10 9 -19 25 -19 35 0 9 111 146 246
304 234 273 247 286 277 283 32 -3 32 -3 31 -58z`}),f.jsx("path",{d:`M1854 2726 c-92 -40 -150 -139 -141 -239 21 -237 343 -298 446 -84
59 123 -10 287 -138 325 -51 16 -128 15 -167 -2z`}),f.jsx("path",{d:`M3053 2719 c-81 -40 -133 -121 -133 -205 0 -102 47 -180 134 -220 95
-44 193 -27 268 47 78 78 94 181 44 278 -21 38 -76 88 -118 105 -54 23 -144
20 -195 -5z`}),f.jsx("path",{d:`M2147 1999 c-26 -15 -48 -65 -41 -94 15 -61 181 -167 304 -196 30 -7
100 -12 155 -12 81 1 115 6 178 27 135 45 247 133 249 194 2 60 -48 103 -104
88 -13 -3 -50 -25 -83 -50 -85 -64 -172 -90 -280 -84 -92 6 -165 35 -259 103
-49 35 -86 43 -119 24z`})]})})};function Qat({agents:e,onUseAgent:t,onClearAgent:n,hasActiveAgent:r,currentAgentName:s,module:i}){const[a,o]=T.useState(""),l=e.filter(c=>c.name.toLowerCase().includes(a.toLowerCase())||c.description.toLowerCase().includes(a.toLowerCase())||c.tags.some(u=>u.toLowerCase().includes(a.toLowerCase())));return f.jsxs("div",{className:"space-y-4",children:[r&&f.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(eC,{className:"h-4 w-4 text-primary"}),f.jsxs("span",{className:"text-sm font-medium",children:["Active Agent: ",s]})]}),f.jsx(ft,{variant:"outline",size:"sm",onClick:n,children:"Clear Agent"})]}),f.jsxs("div",{children:[f.jsx(It,{htmlFor:"search",children:"Search Agents"}),f.jsx(_n,{id:"search",placeholder:"Search by name, description, or tags...",value:a,onChange:c=>o(c.target.value)})]}),f.jsx("div",{className:"grid gap-3",children:l.length===0?f.jsx("div",{className:"text-center py-8 text-muted-foreground",children:a?"No agents match your search.":"No agents available."}):l.map(c=>{const u=i.getTasksForAgent(c.id);return f.jsxs(cl,{className:"hover:bg-muted/50 transition-colors",children:[f.jsx(ul,{className:"pb-3",children:f.jsxs("div",{className:"flex items-start justify-between",children:[f.jsxs("div",{children:[f.jsxs(dl,{className:"text-sm flex items-center gap-2",children:[f.jsx(eC,{className:"h-4 w-4"}),c.name]}),f.jsx(Bd,{className:"text-xs",children:c.description})]}),c.isPublic&&f.jsx(is,{variant:"default",className:"text-xs",children:"Public"})]})}),f.jsxs(fl,{className:"pt-0 space-y-3",children:[f.jsxs("div",{className:"flex flex-wrap gap-1",children:[f.jsxs(is,{variant:"secondary",className:"text-xs",children:[u.length," tasks"]}),c.tags.map(d=>f.jsx(is,{variant:"outline",className:"text-xs",children:d},d)),c.variables.length>0&&f.jsxs(is,{variant:"secondary",className:"text-xs",children:[c.variables.length," variables"]}),c.tools&&c.tools.length>0&&f.jsxs(is,{variant:"secondary",className:"text-xs",children:[c.tools.length," tools"]}),c.rules&&c.rules.length>0&&f.jsxs(is,{variant:"secondary",className:"text-xs",children:[c.rules.length," rules"]})]}),f.jsx(ft,{size:"sm",onClick:()=>t(c),className:"w-full",children:"Use Agent"})]})]},c.id)})})]})}function eot({agent:e,onChange:t,previewElementRef:n,onCompile:r}){const s=e.variables.map(o=>({name:o.name,type:o.type==="boolean"?"switch":o.type==="number"?"number":o.type==="array"?"textarea":"text",label:o.name,placeholder:o.default||`Enter ${o.name}`,description:o.description||o.instructions,required:o.required})),i=e.variables.reduce((o,l)=>{if(l.default)if(l.type==="number")o[l.name]=parseFloat(l.default)||0;else if(l.type==="boolean")o[l.name]=l.default.toLowerCase()==="true";else if(l.type==="array")try{o[l.name]=JSON.parse(l.default)}catch{o[l.name]=l.default.split(",").map(c=>c.trim())}else o[l.name]=l.default;return o},{}),{Form:a}=J5({fields:s,submitLabel:"",formOptions:{defaultValues:i,onSubmit:async()=>{},onChange:async({value:o})=>{t(o),await r(o)}}});return T.useEffect(()=>{n.current&&(n.current.textContent=e.prompt)},[e.prompt,n]),f.jsxs("div",{className:"md:flex md:space-x-4",children:[f.jsx("div",{className:"md:w-1/2 border rounded-lg p-4",children:e.variables.length===0?f.jsx("div",{className:"text-center",children:f.jsx("p",{className:"text-muted-foreground",children:"This agent has no variables defined. The agent will be applied as-is."})}):f.jsxs(f.Fragment,{children:[f.jsx(It,{className:"text-sm font-medium mb-4 block",children:"Agent Configuration"}),f.jsx(a,{})]})}),f.jsxs("div",{className:"md:w-1/2 border rounded-lg p-4",children:[f.jsx(It,{className:"text-sm font-medium",children:"System Prompt Preview"}),f.jsx("div",{ref:n,className:"mt-2 p-3 bg-muted rounded text-sm font-mono whitespace-pre-wrap max-h-64 overflow-y-auto"})]})]})}function tot({task:e,onChange:t,previewElementRef:n,onCompile:r}){const s=e.variables.map(o=>({name:o.name,type:o.type==="boolean"?"switch":o.type==="number"?"number":o.type==="array"?"textarea":"text",label:o.name,placeholder:o.default||`Enter ${o.name}`,description:o.description||o.instructions,required:o.required})),i=e.variables.reduce((o,l)=>{if(l.default)if(l.type==="number")o[l.name]=parseFloat(l.default)||0;else if(l.type==="boolean")o[l.name]=l.default.toLowerCase()==="true";else if(l.type==="array")try{o[l.name]=JSON.parse(l.default)}catch{o[l.name]=l.default.split(",").map(c=>c.trim())}else o[l.name]=l.default;return o},{}),{Form:a}=J5({fields:s,submitLabel:"",formOptions:{defaultValues:i,onSubmit:async()=>{},onChange:async({value:o})=>{t(o),await r(o)}}});return T.useEffect(()=>{n.current&&(n.current.textContent=e.prompt)},[e.prompt,n]),f.jsxs("div",{className:"md:flex md:space-x-4",children:[f.jsx("div",{className:"md:w-1/2 border rounded-lg p-4",children:e.variables.length===0?f.jsx("div",{className:"text-center",children:f.jsx("p",{className:"text-muted-foreground",children:"This task has no variables defined. The task will be executed as-is."})}):f.jsxs(f.Fragment,{children:[f.jsx(It,{className:"text-sm font-medium mb-4 block",children:"Task Configuration"}),f.jsx(a,{})]})}),f.jsxs("div",{className:"md:w-1/2 border rounded-lg p-4",children:[f.jsx(It,{className:"text-sm font-medium",children:"Task Prompt Preview"}),f.jsx("div",{ref:n,className:"mt-2 p-3 bg-muted rounded text-sm font-mono whitespace-pre-wrap max-h-64 overflow-y-auto"})]})]})}function not({agent:e,tasks:t,onSubmit:n,onBack:r,previewElementRef:s,onCompile:i,autoClearEnabled:a,onAutoClearChange:o,module:l}){const[c,u]=T.useState(""),[d,h]=T.useState({}),[m,y]=T.useState({}),b=T.useRef(null),v=t.find(R=>R.id===c),x=R=>{h(R)},w=R=>{y(R)},S=R=>{u(R),y({})},C=()=>{v?n(d,v,m):n(d)},k=async R=>{if(s.current)try{await i(R)}catch(N){s.current&&(s.current.textContent=`Error: ${N instanceof Error?N.message:"Compilation failed"}`)}},A=async R=>{if(!(!v||!b.current))try{const N=await l.compileTaskTemplate(v.id,R);b.current.textContent=N.content}catch(N){b.current.textContent=`Error: ${N instanceof Error?N.message:"Compilation failed"}`}};return f.jsxs("div",{className:"flex flex-col h-full",children:[f.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[f.jsxs(ft,{variant:"ghost",size:"sm",onClick:r,children:[f.jsx(spe,{className:"h-4 w-4 mr-1"}),"Back to Agents"]}),f.jsx("div",{className:"flex-1"}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(It,{htmlFor:"auto-clear",className:"text-sm",children:"Auto-clear after use"}),f.jsx(Io,{id:"auto-clear",checked:a,onCheckedChange:o})]})]}),t.length>0&&f.jsxs(cl,{className:"mb-4",children:[f.jsxs(ul,{children:[f.jsx(dl,{className:"text-lg",children:"Task Selection (Optional)"}),f.jsx(Bd,{children:"Choose a task to execute with this agent, or leave empty to use the agent alone."})]}),f.jsx(fl,{children:f.jsxs("div",{children:[f.jsx(It,{htmlFor:"task-select",children:"Select Task"}),f.jsxs("div",{className:"flex gap-2",children:[f.jsxs(np,{value:c,onValueChange:S,children:[f.jsx(sp,{className:"flex-1",children:f.jsx(rp,{placeholder:"Select a task (optional)"})}),f.jsx(ip,{children:t.map(R=>f.jsx(To,{value:R.id,children:R.name},R.id))})]}),c&&f.jsx(ft,{variant:"outline",size:"sm",onClick:()=>u(""),children:"Clear"})]})]})})]}),f.jsxs("div",{className:"flex-1 overflow-auto space-y-4",children:[f.jsxs(cl,{children:[f.jsxs(ul,{children:[f.jsx(dl,{className:"text-lg",children:"Agent Configuration"}),f.jsxs(Bd,{children:["Configure the system prompt and settings for ",e.name]})]}),f.jsx(fl,{children:f.jsx(eot,{agent:e,onChange:x,previewElementRef:s,onCompile:k})})]}),v&&f.jsxs(cl,{children:[f.jsxs(ul,{children:[f.jsx(dl,{className:"text-lg",children:"Task Configuration"}),f.jsxs(Bd,{children:["Configure the task prompt for ",v.name]})]}),f.jsx(fl,{children:f.jsx(tot,{task:v,onChange:w,previewElementRef:b,onCompile:A})})]}),f.jsx("div",{className:"flex justify-end pt-4",children:f.jsxs(ft,{onClick:C,size:"lg",children:["Use Agent ",v?`with ${v.name}`:""]})})]})]})}const rot=({module:e})=>{const[t,n]=T.useState(!1),[r,s]=T.useState(null),[i,a]=T.useState(!1),[o,l]=T.useState(0),c=T.useRef(null);T.useEffect(()=>{const k=()=>{l(A=>A+1)};return e.setNotifyCallback(k),()=>{e.setNotifyCallback(null)}},[e]),T.useEffect(()=>{t&&e.loadPromptTemplates()},[t,e]);const u=e.getAgents(),d=e.hasActiveAgent(),h=e.getCurrentAgentId(),m=h?u.find(k=>k.id===h):null;T.useEffect(()=>{},[o]);const y=k=>{s(k),a(!0)},b=async(k,A,R)=>{var N;if(r)try{A&&R?(await e.applyAgentWithTask(r.id,A.id,k,R),je.success(`Agent "${r.name}" applied with task "${A.name}"!`)):(await e.applyAgent(r.id,k),je.success(`Agent "${r.name}" applied!`)),e.getAutoClearEnabled()&&((N=e.clearOnSubmit)==null||N.call(e)),n(!1),s(null),a(!1)}catch(I){console.error("Failed to apply agent:",I),je.error("Failed to apply agent!")}},v=()=>{s(null),a(!1)},x=()=>{var k;(k=e.clearOnSubmit)==null||k.call(e),je.success("Agent cleared!")},w=async k=>{if(!(!r||!c.current))try{const A=await e.compileTemplate(r.id,k);c.current.textContent=A.content}catch(A){c.current.textContent=`Error: ${A instanceof Error?A.message:"Compilation failed"}`}},S=()=>i&&r?`Configure ${r.name}`:"Select Agent",C=()=>i&&r?"Configure the agent and optionally select a task to execute.":"Select an AI agent to work with. Each agent has specialized capabilities and tasks.";return f.jsxs(f.Fragment,{children:[f.jsx(ft,{variant:d?"secondary":"ghost",size:"sm",onClick:()=>n(!0),className:"h-8 w-8 p-0",title:d?`Active Agent: ${(m==null?void 0:m.name)||"Unknown"}`:"Select Agent",children:f.jsx(Jat,{className:"h-4 w-4"})}),f.jsx(lp,{open:t,onOpenChange:n,children:f.jsxs(cp,{className:"!w-[80vw] !h-[85vh] !max-w-none flex flex-col",children:[f.jsxs(up,{children:[f.jsx(dp,{children:S()}),f.jsx(ng,{children:C()})]}),f.jsx("div",{className:"flex-1 overflow-hidden",children:i&&r?f.jsx(not,{agent:r,tasks:e.getTasksForAgent(r.id),onSubmit:b,onBack:v,previewElementRef:c,onCompile:w,autoClearEnabled:e.getAutoClearEnabled(),onAutoClearChange:e.setAutoClearEnabled,module:e}):f.jsx(Qat,{agents:u,onUseAgent:y,onClearAgent:x,hasActiveAgent:d,currentAgentName:m==null?void 0:m.name,module:e})})]})})]})};class sot{constructor(){me(this,"id","agent-control");me(this,"unregisterPromptControlCallback",null);me(this,"unregisterCallback");me(this,"eventUnsubscribers",[]);me(this,"modApiRef",null);me(this,"allTemplates",[]);me(this,"isLoadingTemplates",!0);me(this,"notifyComponentUpdate",null);me(this,"currentAgentId",null);me(this,"currentAgentSystemPrompt",null);me(this,"autoClearEnabled",!1);me(this,"getAllTemplates",()=>this.allTemplates);me(this,"getAgents",()=>this.allTemplates.filter(t=>(t.type||"prompt")==="agent"));me(this,"getTasksForAgent",t=>this.allTemplates.filter(n=>(n.type||"prompt")==="task"&&n.parentId===t));me(this,"getIsLoadingTemplates",()=>this.isLoadingTemplates);me(this,"compileTemplate",async(t,n)=>{const{compilePromptTemplate:r}=Om.getState();return await r(t,n)});me(this,"compileTaskTemplate",async(t,n)=>{const{compilePromptTemplate:r}=Om.getState();return await r(t,n)});me(this,"applyTemplate",async(t,n)=>{var s;const r=await this.compileTemplate(t,n);(s=this.modApiRef)==null||s.emit(Nn.setInputTextRequest,{text:r.content}),r.selectedTools&&r.selectedTools.length>0,r.selectedRules&&r.selectedRules.length>0});me(this,"applyAgent",async(t,n)=>{var s;const r=await this.compileTemplate(t,n);this.currentAgentId=t,this.currentAgentSystemPrompt=r.content,(s=this.notifyComponentUpdate)==null||s.call(this),r.selectedTools&&r.selectedTools.length>0,r.selectedRules&&r.selectedRules.length>0});me(this,"applyAgentWithTask",async(t,n,r,s)=>{var a;await this.applyAgent(t,r);const i=await this.compileTemplate(n,s);(a=this.modApiRef)==null||a.emit(Nn.setInputTextRequest,{text:i.content}),i.selectedTools&&i.selectedTools.length>0,i.selectedRules&&i.selectedRules.length>0});me(this,"getCurrentAgentId",()=>this.currentAgentId);me(this,"getCurrentAgentSystemPrompt",()=>this.currentAgentSystemPrompt);me(this,"hasActiveAgent",()=>this.currentAgentId!==null);me(this,"getAutoClearEnabled",()=>this.autoClearEnabled);me(this,"setAutoClearEnabled",t=>{this.autoClearEnabled=t});me(this,"clearOnSubmit",()=>{var t;this.currentAgentId=null,this.currentAgentSystemPrompt=null,(t=this.notifyComponentUpdate)==null||t.call(this)});me(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t});me(this,"loadPromptTemplates",()=>{var t;(t=this.modApiRef)==null||t.emit(Xa.loadPromptTemplatesRequest,{})})}async initialize(t){this.modApiRef=t,t.emit(Xa.loadPromptTemplatesRequest,{});const n=t.on(Xa.promptTemplatesChanged,a=>{var o;a!=null&&a.promptTemplates&&(this.allTemplates=a.promptTemplates,this.isLoadingTemplates=!1,(o=this.notifyComponentUpdate)==null||o.call(this))}),r=t.on(Xa.promptTemplateAdded,a=>{var o;a!=null&&a.promptTemplate&&(this.allTemplates=[...this.allTemplates,a.promptTemplate],(o=this.notifyComponentUpdate)==null||o.call(this))}),s=t.on(Xa.promptTemplateUpdated,a=>{var o;if(a!=null&&a.promptTemplate){const l=this.allTemplates.findIndex(c=>c.id===a.promptTemplate.id);l!==-1&&(this.allTemplates[l]=a.promptTemplate,(o=this.notifyComponentUpdate)==null||o.call(this))}}),i=t.on(Xa.promptTemplateDeleted,a=>{var o;a!=null&&a.id&&(this.allTemplates=this.allTemplates.filter(l=>l.id!==a.id),(o=this.notifyComponentUpdate)==null||o.call(this))});this.eventUnsubscribers.push(n,r,s,i)}register(t){this.modApiRef=t,this.unregisterPromptControlCallback||(this.unregisterPromptControlCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>We.createElement(rot,{module:this}),getMetadata:()=>{if(this.currentAgentSystemPrompt)return{turnSystemPrompt:this.currentAgentSystemPrompt}},clearOnSubmit:()=>{var n;this.autoClearEnabled&&(this.currentAgentId=null,this.currentAgentSystemPrompt=null,(n=this.notifyComponentUpdate)==null||n.call(this))}}))}destroy(t){this.eventUnsubscribers.forEach(n=>n()),this.eventUnsubscribers=[],this.unregisterPromptControlCallback&&(this.unregisterPromptControlCallback(),this.unregisterPromptControlCallback=null),this.modApiRef=null,this.notifyComponentUpdate=null,this.unregisterCallback&&this.unregisterCallback()}}const iot=Ke({enableStreamingMarkdown:br(),enableStreamingCodeBlockParsing:br(),foldStreamingCodeBlocks:br(),foldUserMessagesOnCompletion:br(),enableAutoScrollOnStream:br(),streamingRenderFPS:Tt().min(3,"Min 3 FPS").max(60,"Max 60 FPS"),autoScrollInterval:Tt().min(50,"Min 50ms").max(5e3,"Max 5000ms")}),aot=()=>{const e=yr(yn(s=>({setEnableStreamingMarkdown:s.setEnableStreamingMarkdown,setEnableStreamingCodeBlockParsing:s.setEnableStreamingCodeBlockParsing,setFoldStreamingCodeBlocks:s.setFoldStreamingCodeBlocks,setFoldUserMessagesOnCompletion:s.setFoldUserMessagesOnCompletion,setStreamingRenderFPS:s.setStreamingRenderFPS,setAutoScrollInterval:s.setAutoScrollInterval,setEnableAutoScrollOnStream:s.setEnableAutoScrollOnStream,resetGeneralSettings:s.resetGeneralSettings}))),t=yr(yn(s=>({enableStreamingMarkdown:s.enableStreamingMarkdown,enableStreamingCodeBlockParsing:s.enableStreamingCodeBlockParsing,foldStreamingCodeBlocks:s.foldStreamingCodeBlocks,foldUserMessagesOnCompletion:s.foldUserMessagesOnCompletion,streamingRenderFPS:s.streamingRenderFPS,autoScrollInterval:s.autoScrollInterval,enableAutoScrollOnStream:s.enableAutoScrollOnStream}))),n=ri({defaultValues:{enableStreamingMarkdown:t.enableStreamingMarkdown??!0,enableStreamingCodeBlockParsing:t.enableStreamingCodeBlockParsing??!0,foldStreamingCodeBlocks:t.foldStreamingCodeBlocks??!1,foldUserMessagesOnCompletion:t.foldUserMessagesOnCompletion??!1,enableAutoScrollOnStream:t.enableAutoScrollOnStream??!0,streamingRenderFPS:t.streamingRenderFPS??15,autoScrollInterval:t.autoScrollInterval??1e3},validators:{onChangeAsync:iot,onChangeAsyncDebounceMs:500},onSubmit:async({value:s})=>{e.setEnableStreamingMarkdown(s.enableStreamingMarkdown),e.setEnableStreamingCodeBlockParsing(s.enableStreamingCodeBlockParsing),e.setFoldStreamingCodeBlocks(s.foldStreamingCodeBlocks),e.setFoldUserMessagesOnCompletion(s.foldUserMessagesOnCompletion),e.setEnableAutoScrollOnStream(s.enableAutoScrollOnStream),e.setStreamingRenderFPS(s.streamingRenderFPS),e.setAutoScrollInterval(s.autoScrollInterval)}});T.useEffect(()=>{n.reset({enableStreamingMarkdown:t.enableStreamingMarkdown??!0,enableStreamingCodeBlockParsing:t.enableStreamingCodeBlockParsing??!0,foldStreamingCodeBlocks:t.foldStreamingCodeBlocks??!1,foldUserMessagesOnCompletion:t.foldUserMessagesOnCompletion??!1,enableAutoScrollOnStream:t.enableAutoScrollOnStream??!0,streamingRenderFPS:t.streamingRenderFPS??15,autoScrollInterval:t.autoScrollInterval??1e3})},[t.enableStreamingMarkdown,t.enableStreamingCodeBlockParsing,t.foldStreamingCodeBlocks,t.foldUserMessagesOnCompletion,t.enableAutoScrollOnStream,t.streamingRenderFPS,t.autoScrollInterval,n]);const r=()=>{window.confirm("Are you sure you want to reset Streaming & Display settings to their defaults?")&&e.resetGeneralSettings()};return f.jsxs("form",{onSubmit:s=>{s.preventDefault(),s.stopPropagation(),n.handleSubmit()},className:"p-1 space-y-4",children:[f.jsxs("div",{className:"space-y-3",children:[f.jsx("h3",{className:"text-lg font-medium",children:"Streaming & Display"}),f.jsx(Zp,{form:n,name:"enableStreamingMarkdown",label:"Parse Markdown While Streaming",description:"Render Markdown formatting as the response arrives (may impact performance slightly)."}),f.jsx(Zp,{form:n,name:"enableStreamingCodeBlockParsing",label:"Use Full Code Blocks While Streaming",description:"Use the syntax-highlighting component for code blocks during streaming."}),f.jsx(Zp,{form:n,name:"foldStreamingCodeBlocks",label:"Fold Code Blocks by Default During Streaming",description:"Automatically collapse code blocks as they stream in. Useful for long code outputs."}),f.jsx(Zp,{form:n,name:"foldUserMessagesOnCompletion",label:"Fold User Messages After Response",description:"Automatically collapse the user's prompt message once the assistant finishes responding."}),f.jsx(Zp,{form:n,name:"enableAutoScrollOnStream",label:"Auto-Scroll While Streaming",description:"Automatically scroll to the bottom as new content arrives."}),f.jsxs("div",{className:"rounded-lg border p-3 shadow-sm space-y-2",children:[f.jsx(wc,{form:n,name:"streamingRenderFPS",label:"Streaming Update Rate",min:3,max:60,step:1,valueLabelSuffix:" FPS"}),f.jsx(Iy,{form:n,name:"streamingRenderFPS",label:"FPS Input",min:3,max:60,step:1,className:"w-24 h-8 text-xs ml-auto","aria-label":"Streaming Render FPS Value"}),f.jsx("p",{className:Ze("text-sm text-muted-foreground"),children:"Controls how frequently the UI updates during streaming (3-60 FPS)."})]}),f.jsxs("div",{className:"rounded-lg border p-3 shadow-sm space-y-2",children:[f.jsx(wc,{form:n,name:"autoScrollInterval",label:"Auto-Scroll Interval",min:50,max:5e3,step:50,valueLabelSuffix:" ms",disabled:!n.state.values.enableAutoScrollOnStream}),f.jsx(Iy,{form:n,name:"autoScrollInterval",label:"Interval Input (ms)",min:50,max:5e3,step:50,className:"w-24 h-8 text-xs ml-auto",disabled:!n.state.values.enableAutoScrollOnStream,"aria-label":"Auto Scroll Interval Value"}),f.jsx("p",{className:Ze("text-sm text-muted-foreground"),children:"How often to scroll to the bottom during streaming (50-5000 ms)."})]})]}),f.jsx(Xd,{}),f.jsx("div",{className:"flex items-center justify-between pt-3",children:f.jsx(n.Subscribe,{children:s=>{const i=s.canSubmit,a=s.isSubmitting,o=s.isValidating,l=s.isValid;return f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(ft,{type:"submit",size:"sm",disabled:!i||a||o||!l,children:a?"Saving...":o?"Validating...":"Save Changes"}),f.jsxs(ft,{variant:"outline",size:"sm",onClick:r,type:"button",children:[f.jsx(l1,{className:"mr-2 h-4 w-4"}),"Reset General Settings"]})]})}})})]})},oot=We.memo(aot);class lot{constructor(){me(this,"id","core-settings-general");me(this,"unregisterCallback",null)}async initialize(t){}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerSettingsTab({id:"general",title:"General",component:oot,order:10})}destroy(){this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),console.log(`[${this.id}] Destroyed.`)}}const cot=({label:e,colorKey:t,value:n,onChange:r})=>{const[s,i]=T.useState(n??"");T.useEffect(()=>{i(n??"")},[n]);const a=()=>{r(t,s.trim()||null)},o=l=>{i(l.target.value)};return f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(It,{htmlFor:`color-${t}`,className:"text-xs w-28 shrink-0",children:e}),f.jsx(_n,{id:`color-${t}`,type:"text",value:s,onChange:o,onBlur:a,className:"h-8 text-xs flex-grow",placeholder:"e.g., #ffffff or oklch(0.5 0.2 180)"}),f.jsx(_n,{type:"color",value:s!=null&&s.startsWith("#")?s:"#000000",onChange:l=>{i(l.target.value),r(t,l.target.value)},className:"h-8 w-10 p-1 border-none cursor-pointer bg-transparent","aria-label":`Pick ${e} color`})]})},uot=[{label:"Default Light",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-material-light.min.css"},{label:"A11y Dark",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-a11y-dark.min.css"},{label:"Atom Dark",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-atom-dark.min.css"},{label:"Atelier Sulphurpool Light",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-base16-ateliersulphurpool.light.min.css"},{label:"CB",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-cb.min.css"},{label:"Coldark Cold",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-coldark-cold.min.css"},{label:"Coldark Dark",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-coldark-dark.min.css"},{label:"Coy (No Shadow)",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-coy-without-shadows.min.css"},{label:"Darcula",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-darcula.min.css"},{label:"Dracula",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-dracula.min.css"},{label:"Duotone Dark",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-duotone-dark.min.css"},{label:"Duotone Earth",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-duotone-earth.min.css"},{label:"Duotone Forest",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-duotone-forest.min.css"},{label:"Duotone Light",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-duotone-light.min.css"},{label:"Duotone Sea",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-duotone-sea.min.css"},{label:"Duotone Space",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-duotone-space.min.css"},{label:"GH Colors",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-ghcolors.min.css"},{label:"Gruvbox Dark",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-gruvbox-dark.min.css"},{label:"Gruvbox Light",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-gruvbox-light.min.css"},{label:"Holi",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-holi-theme.min.css"},{label:"Hopscotch",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-hopscotch.min.css"},{label:"Lucario",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-lucario.min.css"},{label:"Material Dark",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-material-dark.min.css"},{label:"Material Oceanic",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-material-oceanic.min.css"},{label:"Night Owl",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-night-owl.min.css"},{label:"Nord",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-nord.min.css"},{label:"One Dark",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-one-dark.min.css"},{label:"One Light",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-one-light.min.css"},{label:"Pojoaque",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-pojoaque.min.css"},{label:"Shades of Purple",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-shades-of-purple.min.css"},{label:"Solarized Dark Atom",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-solarized-dark-atom.min.css"},{label:"Synthwave '84",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-synthwave84.min.css"},{label:"VS",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-vs.min.css"},{label:"VSC Dark Plus",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-vsc-dark-plus.min.css"},{label:"Xonokai",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-xonokai.min.css"},{label:"Z-Touch",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-z-touch.min.css"}],dot=bl(["system","light","dark","TijuLight","TijuDark","custom"]),fot=Ke({theme:dot,prismThemeUrl:$e(),customFontFamily:$e(),customFontSize:Tt().min(12).max(20),chatMaxWidth:$e(),customThemeColors:bh($e(),$e().nullable())}),hot=()=>{const e=yr(yn(a=>({setTheme:a.setTheme,setPrismThemeUrl:a.setPrismThemeUrl,setCustomFontFamily:a.setCustomFontFamily,setCustomFontSize:a.setCustomFontSize,setChatMaxWidth:a.setChatMaxWidth,setCustomThemeColor:a.setCustomThemeColor,resetThemeSettings:a.resetThemeSettings}))),t=yr(yn(a=>({theme:a.theme,prismThemeUrl:a.prismThemeUrl,customFontFamily:a.customFontFamily,customFontSize:a.customFontSize,chatMaxWidth:a.chatMaxWidth,_rawCustomThemeColors:a.customThemeColors}))),n=ri({defaultValues:{theme:t.theme??"system",prismThemeUrl:t.prismThemeUrl??"",customFontFamily:t.customFontFamily??"",customFontSize:t.customFontSize??16,chatMaxWidth:t.chatMaxWidth??"max-w-7xl",customThemeColors:t._rawCustomThemeColors??{}},onSubmit:async({value:a})=>{e.setTheme(a.theme),e.setPrismThemeUrl(a.prismThemeUrl||null),e.setCustomFontFamily(a.customFontFamily),e.setCustomFontSize(a.customFontSize),e.setChatMaxWidth(a.chatMaxWidth),a.customThemeColors&&Object.entries(a.customThemeColors).forEach(([o,l])=>{e.setCustomThemeColor(o,l)})},validators:{onChangeAsync:fot,onChangeAsyncDebounceMs:300}});T.useEffect(()=>{n.reset({theme:t.theme??"system",prismThemeUrl:t.prismThemeUrl??"",customFontFamily:t.customFontFamily??"",customFontSize:t.customFontSize??16,chatMaxWidth:t.chatMaxWidth??"max-w-7xl",customThemeColors:t._rawCustomThemeColors??{}})},[t.theme,t.prismThemeUrl,t.customFontFamily,t.customFontSize,t.chatMaxWidth,t._rawCustomThemeColors]);const r=()=>{window.confirm("Are you sure you want to reset all Theme settings to their defaults?")&&e.resetThemeSettings()},s=[{value:"max-w-3xl",label:"Very Small"},{value:"max-w-4xl",label:"Small"},{value:"max-w-5xl",label:"Medium"},{value:"max-w-6xl",label:"Large"},{value:"max-w-7xl",label:"Very Large"},{value:"max-w-full",label:"Full Width"}],i=[{key:"background",label:"Background"},{key:"foreground",label:"Foreground"},{key:"card",label:"Card BG"},{key:"cardForeground",label:"Card FG"},{key:"popover",label:"Popover BG"},{key:"popoverForeground",label:"Popover FG"},{key:"primary",label:"Primary"},{key:"primaryForeground",label:"Primary FG"},{key:"secondary",label:"Secondary"},{key:"secondaryForeground",label:"Secondary FG"},{key:"muted",label:"Muted BG"},{key:"mutedForeground",label:"Muted FG"},{key:"accent",label:"Accent"},{key:"accentForeground",label:"Accent FG"},{key:"destructive",label:"Destructive"},{key:"destructiveForeground",label:"Destructive FG"},{key:"border",label:"Border"},{key:"input",label:"Input BG"},{key:"ring",label:"Ring (Focus)"},{key:"sidebar",label:"Sidebar BG"},{key:"sidebarForeground",label:"Sidebar FG"},{key:"sidebarPrimary",label:"Sidebar Primary"},{key:"sidebarPrimaryForeground",label:"Sidebar Primary FG"},{key:"sidebarAccent",label:"Sidebar Accent"},{key:"sidebarAccentForeground",label:"Sidebar Accent FG"},{key:"sidebarBorder",label:"Sidebar Border"},{key:"sidebarRing",label:"Sidebar Ring"},{key:"chart1",label:"Chart 1"},{key:"chart2",label:"Chart 2"},{key:"chart3",label:"Chart 3"},{key:"chart4",label:"Chart 4"},{key:"chart5",label:"Chart 5"}];return f.jsxs("form",{onSubmit:a=>{a.preventDefault(),a.stopPropagation(),n.handleSubmit()},className:"space-y-4 p-1",children:[f.jsx(px,{title:"Base Theme",description:"Select the overall look and feel.",contentClassName:"rounded-lg border p-3 shadow-sm bg-card",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx(It,{htmlFor:"theme-select",className:"font-medium",children:"Theme"}),f.jsx(jx,{form:n,name:"theme",label:"Theme",options:[{value:"light",label:"Default Light"},{value:"dark",label:"Default Dark"},{value:"system",label:"System"},{value:"TijuLight",label:"Tiju Light"},{value:"TijuDark",label:"Tiju Dark"},{value:"custom",label:"User Custom"}],triggerClassName:"w-[180px]"})]})}),f.jsxs(px,{title:"Font & Layout",description:"Customize typography and content width.",contentClassName:"rounded-lg border p-3 shadow-sm bg-card space-y-3",children:[f.jsxs("div",{children:[f.jsx(Xw,{form:n,name:"customFontFamily",label:"Custom Font Family",placeholder:"e.g., 'Inter', sans-serif (Leave blank for default)",className:"mt-1"}),f.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Applies only when 'User Custom' theme is selected. Ensure the font is available (system or web font)."})]}),f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(wc,{form:n,name:"customFontSize",label:`Base Font Size (${n.getFieldValue("customFontSize")}px)`,min:12,max:20,step:1,className:"mt-1"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Applies only when 'User Custom' theme is selected. Affects base text size (Default: 16px)."})]}),f.jsxs("div",{children:[f.jsx(jx,{form:n,name:"chatMaxWidth",label:"Chat Content Max Width",options:s,triggerClassName:"w-full mt-1"}),f.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Controls the maximum width of the main chat message area."})]})]}),f.jsxs(px,{title:"Code Block Theme",description:"Customize syntax highlighting appearance.",contentClassName:"rounded-lg border p-3 shadow-sm bg-card space-y-3",children:[f.jsx(jx,{form:n,name:"prismThemeUrl",label:"Code Block Theme",options:uot,triggerClassName:"w-full"}),f.jsx(Xw,{form:n,name:"prismThemeUrl",label:"Or paste custom theme URL here...",placeholder:"Or paste custom theme URL here...",type:"url",className:"mt-1"}),f.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Select a preset theme or paste a URL to a PrismJS CSS file. Leave blank or select 'Default' to use themes matching light/dark mode."})]}),n.getFieldValue("theme")==="custom"&&f.jsx(px,{title:"Custom Theme Colors",description:"Define custom colors. Use valid CSS color values (hex, rgb, oklch, etc.). Leave blank to use default light/dark theme colors.",contentClassName:"rounded-lg border p-3 shadow-sm bg-card",children:f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-4 gap-y-2",children:i.map(({key:a,label:o})=>{var l;return f.jsx(cot,{label:o,colorKey:a,value:(l=n.getFieldValue("customThemeColors"))==null?void 0:l[a],onChange:(c,u)=>n.setFieldValue(`customThemeColors.${c}`,u===null?"":u)},a)})})}),f.jsx(Xd,{}),f.jsxs("div",{className:"flex justify-between pt-3",children:[f.jsxs(ft,{variant:"outline",size:"sm",onClick:r,type:"button",children:[f.jsx(l1,{className:"mr-2 h-4 w-4"}),"Reset Theme Settings"]}),f.jsx(ft,{type:"submit",size:"sm",className:"bg-primary text-primary-foreground hover:bg-primary/90",children:"Apply Theme Settings"})]})]})},pot=We.memo(hot);class mot{constructor(){me(this,"id","core-settings-theme");me(this,"unregisterCallback",null)}async initialize(t){}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerSettingsTab({id:"theme",title:"Theme",component:pot,order:20})}destroy(){this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),console.log(`[${this.id}] Destroyed.`)}}const got=({provider:e,apiKeys:t,onEdit:n,onDelete:r,onFetchModels:s,onUpdate:i,fetchStatus:a,isDeleting:o,allAvailableModelsForView:l})=>{var N,I;const[c,u]=T.useState(!0),d=J0(e.type),h=MC(e.type),m=cm(e.type),y=a==="fetching"||o,b=o||a==="fetching",v=o||a==="fetching",x=T.useMemo(()=>new Set(e.enabledModels??[]),[e.enabledModels]),w=e.apiKeyId?t.some(P=>P.id===e.apiKeyId):!1,S=d&&!w,C=T.useCallback(async(P,L)=>{const O=new Set(e.enabledModels??[]);L?O.add(P):O.delete(P);const V=Array.from(O);try{await i(e.id,{enabledModels:V})}catch(D){je.error("Failed to update model status."),console.error("Failed to save model toggle:",D)}},[e.enabledModels,e.id,i]),k=()=>u(P=>!P),A=((N=e.enabledModels)==null?void 0:N.length)??0,R=l.length;return f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center space-x-3 min-w-0",children:[f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{children:f.jsx("span",{className:Ze("h-2.5 w-2.5 rounded-full flex-shrink-0 block",a==="error"?"bg-destructive animate-pulse":e.isEnabled?"bg-green-500":"bg-muted-foreground")})}),f.jsx(Sr,{side:"top",children:a==="error"?"Error fetching models":e.isEnabled?"Enabled":"Disabled"})]})}),f.jsx("h3",{className:"font-semibold text-lg text-card-foreground truncate",children:e.name}),f.jsxs("span",{className:"text-sm text-muted-foreground flex-shrink-0",children:["(",e.type,")"]}),S&&f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{children:f.jsx(Rc,{className:"h-4 w-4 text-amber-500 flex-shrink-0"})}),f.jsx(Sr,{side:"top",children:f.jsx("p",{children:"API Key required but none linked/found."})})]})})]}),f.jsxs("div",{className:"flex items-center space-x-1 flex-shrink-0",children:[f.jsx(Dn,{tooltipText:"Edit",onClick:n,disabled:b,"aria-label":"Edit provider",icon:f.jsx(o1,{}),className:"h-8 w-8"}),f.jsx(Dn,{tooltipText:"Delete",onClick:r,disabled:v,className:"text-destructive hover:text-destructive/80 h-8 w-8","aria-label":"Delete provider",icon:o?f.jsx(Qn,{className:"h-4 w-4 animate-spin"}):f.jsx(Ao,{})})]})]}),f.jsxs("div",{className:"text-sm text-muted-foreground mt-1 space-y-1 pl-5",children:[d&&f.jsxs("div",{children:["API Key:"," ",e.apiKeyId?w?f.jsx("span",{className:"text-green-400",children:((I=t.find(P=>P.id===e.apiKeyId))==null?void 0:I.name)||"Linked (Unnamed Key)"}):f.jsx("span",{className:"text-destructive",children:"Linked Key Missing!"}):f.jsx("span",{className:"text-amber-400",children:"Not Linked"})]}),h&&f.jsxs("div",{children:["Base URL: ",e.baseURL||"Not Set"]}),f.jsxs("div",{children:["Auto-fetch Models:"," ",e.autoFetchModels?f.jsx("span",{className:"text-green-400",children:"Enabled"}):f.jsx("span",{className:"text-muted-foreground/80",children:"Disabled"}),e.fetchedModels&&f.jsxs("span",{className:"text-xs text-muted-foreground/80 ml-2",children:["(Last fetched:"," ",e.modelsLastFetchedAt?new Date(e.modelsLastFetchedAt).toLocaleString():"Never",")"]})]}),m&&f.jsx("div",{className:"pt-1",children:f.jsxs(ft,{variant:"outline",size:"sm",onClick:s,disabled:y,className:"text-xs h-7 px-2",children:[a==="fetching"&&f.jsx(Qn,{className:"h-3 w-3 mr-1 animate-spin"}),a==="success"&&f.jsx(so,{className:"h-3 w-3 mr-1 text-green-500"}),a==="error"&&f.jsx(Rc,{className:"h-3 w-3 mr-1 text-destructive"}),a==="idle"&&f.jsx(gm,{className:"h-3 w-3 mr-1"}),a==="fetching"?"Fetching...":a==="error"?"Fetch Failed":"Fetch Models Now"]})})]}),f.jsxs("div",{className:"space-y-1 pt-2",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("span",{className:"font-medium text-card-foreground text-sm",children:["Model Enablement (",A," / ",R," enabled)"]}),f.jsx(Dn,{tooltipText:c?"Show Models":"Hide Models",onClick:k,"aria-label":c?"Show model list":"Hide model list",icon:c?f.jsx(Jl,{}):f.jsx(Lh,{}),className:"h-6 w-6"})]}),!c&&f.jsx(A5,{providerId:e.id,allAvailableModels:l,enabledModelIds:x,onToggleModel:C,isLoading:a==="fetching",disabled:o,listHeightClass:"h-[26rem]"})]})]})},yot=We.memo(got),bot=({providerId:e,editData:t,apiKeys:n,allAvailableModels:r,isSaving:s,onCancel:i,onSave:a,onChange:o})=>{const l=T.useMemo(()=>new Set(t.enabledModels??[]),[t.enabledModels]),c=T.useCallback((d,h)=>{const m=new Set(t.enabledModels??[]);h?m.add(d):m.delete(d);const y=Array.from(m);o("enabledModels",y)},[t.enabledModels,o]),u=T.useCallback((d,h)=>new Promise(m=>{o(d,h),m(void 0)}),[o]);return f.jsx("div",{className:"space-y-4",children:f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[f.jsxs("div",{className:"space-y-3",children:[f.jsx("h4",{className:"text-md font-semibold text-card-foreground mb-2",children:"Basic Configuration"}),f.jsx(Noe,{initialData:t,onChange:u,onSubmit:a,onCancel:i,apiKeys:n,disabled:s})]}),f.jsxs("div",{className:"space-y-3",children:[f.jsx("h4",{className:"text-md font-semibold text-card-foreground",children:"Model Enablement"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Toggle models on/off for global use. Changes will be saved with the form."}),f.jsx(A5,{providerId:e,allAvailableModels:r,enabledModelIds:l,onToggleModel:c,disabled:s,listHeightClass:"h-[calc(100%-8rem)]"})]})]})})},vot=We.memo(bot),xot=({provider:e,apiKeys:t,onUpdate:n,onDelete:r,onFetchModels:s,fetchStatus:i,onSelectModelForDetails:a})=>{const[o,l]=T.useState(!1),[c,u]=T.useState(!1),[d,h]=T.useState(!1),[m,y]=T.useState({name:"placeholder"}),b=Nr(I=>I.getAllAvailableModelDefsForProvider),[v,x]=T.useState([]),w=T.useMemo(()=>[...b(e.id)].sort((P,L)=>(P.name||P.id).localeCompare(L.name||L.id)),[e.id,b]);T.useEffect(()=>{if(o){const I=b(e.id);x([...I].sort((P,L)=>(P.name||P.id).localeCompare(L.name||L.id))),y({name:e.name,type:e.type,isEnabled:e.isEnabled,apiKeyId:e.apiKeyId,baseURL:e.baseURL,enabledModels:e.enabledModels??[],autoFetchModels:e.autoFetchModels})}else x([])},[o,e.id,e.name,e.type,e.isEnabled,e.apiKeyId,e.baseURL,e.enabledModels,e.autoFetchModels,b]);const S=()=>l(!0),C=()=>{l(!1),y({}),u(!1)},k=T.useCallback(async()=>{u(!0);try{const I=m.enabledModels&&m.enabledModels.length>0?m.enabledModels:null,P={name:m.name,type:m.type,isEnabled:m.isEnabled,apiKeyId:m.apiKeyId,baseURL:m.baseURL,autoFetchModels:m.autoFetchModels,enabledModels:I};Object.keys(P).forEach(L=>{P[L]===void 0&&delete P[L]}),await n(e.id,P),l(!1),y({}),je.success(`Provider "${P.name||e.name}" updated.`)}catch(I){console.error("Failed to save provider update:",I),je.error("Failed to save provider configuration.")}finally{u(!1)}},[m,n,e.id,e.name]),A=T.useCallback((I,P)=>{y(L=>({...L,[I]:P}))},[]),R=T.useCallback(async()=>{if(window.confirm(`Delete provider "${e.name}"?`)){h(!0);try{await r(e.id)}catch(I){console.error("Failed to delete provider:",I),h(!1)}}},[r,e.id,e.name]),N=T.useCallback(async()=>{if(await s(e.id),o){const I=b(e.id);x([...I].sort((P,L)=>(P.name||P.id).localeCompare(L.name||L.id)))}},[s,e.id,o,b]);return f.jsx("div",{className:"border border-border p-4 space-y-3 bg-card rounded-md shadow-sm",children:o?f.jsx(vot,{providerId:e.id,editData:m,apiKeys:t,allAvailableModels:v,isSaving:c,onCancel:C,onSave:k,onChange:A}):f.jsx(yot,{provider:e,apiKeys:t,onEdit:S,onDelete:R,onFetchModels:N,onUpdate:n,fetchStatus:i,isDeleting:d,onSelectModelForDetails:a,allAvailableModelsForView:w})})},wot=We.memo(xot);function _ot(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return T.useMemo(()=>r=>{t.forEach(s=>s(r))},t)}const pA=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function yb(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function Q5(e){return"nodeType"in e}function qo(e){var t,n;return e?yb(e)?e:Q5(e)&&(t=(n=e.ownerDocument)==null?void 0:n.defaultView)!=null?t:window:window}function eF(e){const{Document:t}=qo(e);return e instanceof t}function u_(e){return yb(e)?!1:e instanceof qo(e).HTMLElement}function dde(e){return e instanceof qo(e).SVGElement}function bb(e){return e?yb(e)?e.document:Q5(e)?eF(e)?e:u_(e)||dde(e)?e.ownerDocument:document:document:document}const Fu=pA?T.useLayoutEffect:T.useEffect;function tF(e){const t=T.useRef(e);return Fu(()=>{t.current=e}),T.useCallback(function(){for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return t.current==null?void 0:t.current(...r)},[])}function Sot(){const e=T.useRef(null),t=T.useCallback((r,s)=>{e.current=setInterval(r,s)},[]),n=T.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,n]}function n1(e,t){t===void 0&&(t=[e]);const n=T.useRef(e);return Fu(()=>{n.current!==e&&(n.current=e)},t),n}function d_(e,t){const n=T.useRef();return T.useMemo(()=>{const r=e(n.current);return n.current=r,r},[...t])}function iE(e){const t=tF(e),n=T.useRef(null),r=T.useCallback(s=>{s!==n.current&&(t==null||t(s,n.current)),n.current=s},[]);return[n,r]}function CP(e){const t=T.useRef();return T.useEffect(()=>{t.current=e},[e]),t.current}let j3={};function f_(e,t){return T.useMemo(()=>{if(t)return t;const n=j3[e]==null?0:j3[e]+1;return j3[e]=n,e+"-"+n},[e,t])}function fde(e){return function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),s=1;s<n;s++)r[s-1]=arguments[s];return r.reduce((i,a)=>{const o=Object.entries(a);for(const[l,c]of o){const u=i[l];u!=null&&(i[l]=u+e*c)}return i},{...t})}}const L0=fde(1),r1=fde(-1);function Cot(e){return"clientX"in e&&"clientY"in e}function nF(e){if(!e)return!1;const{KeyboardEvent:t}=qo(e.target);return t&&e instanceof t}function kot(e){if(!e)return!1;const{TouchEvent:t}=qo(e.target);return t&&e instanceof t}function kP(e){if(kot(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:n}=e.touches[0];return{x:t,y:n}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:n}=e.changedTouches[0];return{x:t,y:n}}}return Cot(e)?{x:e.clientX,y:e.clientY}:null}const s1=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:n}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:n}=e;return"scaleX("+t+") scaleY("+n+")"}},Transform:{toString(e){if(e)return[s1.Translate.toString(e),s1.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:n,easing:r}=e;return t+" "+n+"ms "+r}}}),CW="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function Eot(e){return e.matches(CW)?e:e.querySelector(CW)}const Tot={display:"none"};function Aot(e){let{id:t,value:n}=e;return We.createElement("div",{id:t,style:Tot},n)}function Rot(e){let{id:t,announcement:n,ariaLiveType:r="assertive"}=e;const s={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return We.createElement("div",{id:t,style:s,role:"status","aria-live":r,"aria-atomic":!0},n)}function Not(){const[e,t]=T.useState("");return{announce:T.useCallback(r=>{r!=null&&t(r)},[]),announcement:e}}const hde=T.createContext(null);function Mot(e){const t=T.useContext(hde);T.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function Iot(){const[e]=T.useState(()=>new Set),t=T.useCallback(r=>(e.add(r),()=>e.delete(r)),[e]);return[T.useCallback(r=>{let{type:s,event:i}=r;e.forEach(a=>{var o;return(o=a[s])==null?void 0:o.call(a,i)})},[e]),t]}const jot={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},Pot={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was moved over droppable area "+n.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was dropped over droppable area "+n.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function Oot(e){let{announcements:t=Pot,container:n,hiddenTextDescribedById:r,screenReaderInstructions:s=jot}=e;const{announce:i,announcement:a}=Not(),o=f_("DndLiveRegion"),[l,c]=T.useState(!1);if(T.useEffect(()=>{c(!0)},[]),Mot(T.useMemo(()=>({onDragStart(d){let{active:h}=d;i(t.onDragStart({active:h}))},onDragMove(d){let{active:h,over:m}=d;t.onDragMove&&i(t.onDragMove({active:h,over:m}))},onDragOver(d){let{active:h,over:m}=d;i(t.onDragOver({active:h,over:m}))},onDragEnd(d){let{active:h,over:m}=d;i(t.onDragEnd({active:h,over:m}))},onDragCancel(d){let{active:h,over:m}=d;i(t.onDragCancel({active:h,over:m}))}}),[i,t])),!l)return null;const u=We.createElement(We.Fragment,null,We.createElement(Aot,{id:r,value:s.draggable}),We.createElement(Rot,{id:o,announcement:a}));return n?al.createPortal(u,n):u}var Li;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(Li||(Li={}));function aE(){}function kW(e,t){return T.useMemo(()=>({sensor:e,options:t??{}}),[e,t])}function Dot(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return T.useMemo(()=>[...t].filter(r=>r!=null),[...t])}const Fc=Object.freeze({x:0,y:0});function pde(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function mde(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return n-r}function Fot(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return r-n}function EW(e){let{left:t,top:n,height:r,width:s}=e;return[{x:t,y:n},{x:t+s,y:n},{x:t,y:n+r},{x:t+s,y:n+r}]}function gde(e,t){if(!e||e.length===0)return null;const[n]=e;return n[t]}function TW(e,t,n){return t===void 0&&(t=e.left),n===void 0&&(n=e.top),{x:t+e.width*.5,y:n+e.height*.5}}const Lot=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const s=TW(t,t.left,t.top),i=[];for(const a of r){const{id:o}=a,l=n.get(o);if(l){const c=pde(TW(l),s);i.push({id:o,data:{droppableContainer:a,value:c}})}}return i.sort(mde)},Bot=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const s=EW(t),i=[];for(const a of r){const{id:o}=a,l=n.get(o);if(l){const c=EW(l),u=s.reduce((h,m,y)=>h+pde(c[y],m),0),d=Number((u/4).toFixed(4));i.push({id:o,data:{droppableContainer:a,value:d}})}}return i.sort(mde)};function $ot(e,t){const n=Math.max(t.top,e.top),r=Math.max(t.left,e.left),s=Math.min(t.left+t.width,e.left+e.width),i=Math.min(t.top+t.height,e.top+e.height),a=s-r,o=i-n;if(r<s&&n<i){const l=t.width*t.height,c=e.width*e.height,u=a*o,d=u/(l+c-u);return Number(d.toFixed(4))}return 0}const zot=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const s=[];for(const i of r){const{id:a}=i,o=n.get(a);if(o){const l=$ot(o,t);l>0&&s.push({id:a,data:{droppableContainer:i,value:l}})}}return s.sort(Fot)};function Uot(e,t,n){return{...e,scaleX:t&&n?t.width/n.width:1,scaleY:t&&n?t.height/n.height:1}}function yde(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:Fc}function qot(e){return function(n){for(var r=arguments.length,s=new Array(r>1?r-1:0),i=1;i<r;i++)s[i-1]=arguments[i];return s.reduce((a,o)=>({...a,top:a.top+e*o.y,bottom:a.bottom+e*o.y,left:a.left+e*o.x,right:a.right+e*o.x}),{...n})}}const Vot=qot(1);function Wot(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function Hot(e,t,n){const r=Wot(t);if(!r)return e;const{scaleX:s,scaleY:i,x:a,y:o}=r,l=e.left-a-(1-s)*parseFloat(n),c=e.top-o-(1-i)*parseFloat(n.slice(n.indexOf(" ")+1)),u=s?e.width/s:e.width,d=i?e.height/i:e.height;return{width:u,height:d,top:c,right:l+u,bottom:c+d,left:l}}const Got={ignoreTransform:!1};function vb(e,t){t===void 0&&(t=Got);let n=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:c,transformOrigin:u}=qo(e).getComputedStyle(e);c&&(n=Hot(n,c,u))}const{top:r,left:s,width:i,height:a,bottom:o,right:l}=n;return{top:r,left:s,width:i,height:a,bottom:o,right:l}}function AW(e){return vb(e,{ignoreTransform:!0})}function Kot(e){const t=e.innerWidth,n=e.innerHeight;return{top:0,left:0,right:t,bottom:n,width:t,height:n}}function Yot(e,t){return t===void 0&&(t=qo(e).getComputedStyle(e)),t.position==="fixed"}function Zot(e,t){t===void 0&&(t=qo(e).getComputedStyle(e));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(s=>{const i=t[s];return typeof i=="string"?n.test(i):!1})}function mA(e,t){const n=[];function r(s){if(t!=null&&n.length>=t||!s)return n;if(eF(s)&&s.scrollingElement!=null&&!n.includes(s.scrollingElement))return n.push(s.scrollingElement),n;if(!u_(s)||dde(s)||n.includes(s))return n;const i=qo(e).getComputedStyle(s);return s!==e&&Zot(s,i)&&n.push(s),Yot(s,i)?n:r(s.parentNode)}return e?r(e):n}function bde(e){const[t]=mA(e,1);return t??null}function P3(e){return!pA||!e?null:yb(e)?e:Q5(e)?eF(e)||e===bb(e).scrollingElement?window:u_(e)?e:null:null}function vde(e){return yb(e)?e.scrollX:e.scrollLeft}function xde(e){return yb(e)?e.scrollY:e.scrollTop}function EP(e){return{x:vde(e),y:xde(e)}}var ra;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(ra||(ra={}));function wde(e){return!pA||!e?!1:e===document.scrollingElement}function _de(e){const t={x:0,y:0},n=wde(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},r={x:e.scrollWidth-n.width,y:e.scrollHeight-n.height},s=e.scrollTop<=t.y,i=e.scrollLeft<=t.x,a=e.scrollTop>=r.y,o=e.scrollLeft>=r.x;return{isTop:s,isLeft:i,isBottom:a,isRight:o,maxScroll:r,minScroll:t}}const Xot={x:.2,y:.2};function Jot(e,t,n,r,s){let{top:i,left:a,right:o,bottom:l}=n;r===void 0&&(r=10),s===void 0&&(s=Xot);const{isTop:c,isBottom:u,isLeft:d,isRight:h}=_de(e),m={x:0,y:0},y={x:0,y:0},b={height:t.height*s.y,width:t.width*s.x};return!c&&i<=t.top+b.height?(m.y=ra.Backward,y.y=r*Math.abs((t.top+b.height-i)/b.height)):!u&&l>=t.bottom-b.height&&(m.y=ra.Forward,y.y=r*Math.abs((t.bottom-b.height-l)/b.height)),!h&&o>=t.right-b.width?(m.x=ra.Forward,y.x=r*Math.abs((t.right-b.width-o)/b.width)):!d&&a<=t.left+b.width&&(m.x=ra.Backward,y.x=r*Math.abs((t.left+b.width-a)/b.width)),{direction:m,speed:y}}function Qot(e){if(e===document.scrollingElement){const{innerWidth:i,innerHeight:a}=window;return{top:0,left:0,right:i,bottom:a,width:i,height:a}}const{top:t,left:n,right:r,bottom:s}=e.getBoundingClientRect();return{top:t,left:n,right:r,bottom:s,width:e.clientWidth,height:e.clientHeight}}function Sde(e){return e.reduce((t,n)=>L0(t,EP(n)),Fc)}function elt(e){return e.reduce((t,n)=>t+vde(n),0)}function tlt(e){return e.reduce((t,n)=>t+xde(n),0)}function nlt(e,t){if(t===void 0&&(t=vb),!e)return;const{top:n,left:r,bottom:s,right:i}=t(e);bde(e)&&(s<=0||i<=0||n>=window.innerHeight||r>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const rlt=[["x",["left","right"],elt],["y",["top","bottom"],tlt]];class rF{constructor(t,n){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const r=mA(n),s=Sde(r);this.rect={...t},this.width=t.width,this.height=t.height;for(const[i,a,o]of rlt)for(const l of a)Object.defineProperty(this,l,{get:()=>{const c=o(r),u=s[i]-c;return this.rect[l]+u},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class Ox{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(n=>{var r;return(r=this.target)==null?void 0:r.removeEventListener(...n)})},this.target=t}add(t,n,r){var s;(s=this.target)==null||s.addEventListener(t,n,r),this.listeners.push([t,n,r])}}function slt(e){const{EventTarget:t}=qo(e);return e instanceof t?e:bb(e)}function O3(e,t){const n=Math.abs(e.x),r=Math.abs(e.y);return typeof t=="number"?Math.sqrt(n**2+r**2)>t:"x"in t&&"y"in t?n>t.x&&r>t.y:"x"in t?n>t.x:"y"in t?r>t.y:!1}var Ul;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(Ul||(Ul={}));function RW(e){e.preventDefault()}function ilt(e){e.stopPropagation()}var Vr;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(Vr||(Vr={}));const Cde={start:[Vr.Space,Vr.Enter],cancel:[Vr.Esc],end:[Vr.Space,Vr.Enter,Vr.Tab]},alt=(e,t)=>{let{currentCoordinates:n}=t;switch(e.code){case Vr.Right:return{...n,x:n.x+25};case Vr.Left:return{...n,x:n.x-25};case Vr.Down:return{...n,y:n.y+25};case Vr.Up:return{...n,y:n.y-25}}};class sF{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:n}}=t;this.props=t,this.listeners=new Ox(bb(n)),this.windowListeners=new Ox(qo(n)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(Ul.Resize,this.handleCancel),this.windowListeners.add(Ul.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(Ul.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:n}=this.props,r=t.node.current;r&&nlt(r),n(Fc)}handleKeyDown(t){if(nF(t)){const{active:n,context:r,options:s}=this.props,{keyboardCodes:i=Cde,coordinateGetter:a=alt,scrollBehavior:o="smooth"}=s,{code:l}=t;if(i.end.includes(l)){this.handleEnd(t);return}if(i.cancel.includes(l)){this.handleCancel(t);return}const{collisionRect:c}=r.current,u=c?{x:c.left,y:c.top}:Fc;this.referenceCoordinates||(this.referenceCoordinates=u);const d=a(t,{active:n,context:r.current,currentCoordinates:u});if(d){const h=r1(d,u),m={x:0,y:0},{scrollableAncestors:y}=r.current;for(const b of y){const v=t.code,{isTop:x,isRight:w,isLeft:S,isBottom:C,maxScroll:k,minScroll:A}=_de(b),R=Qot(b),N={x:Math.min(v===Vr.Right?R.right-R.width/2:R.right,Math.max(v===Vr.Right?R.left:R.left+R.width/2,d.x)),y:Math.min(v===Vr.Down?R.bottom-R.height/2:R.bottom,Math.max(v===Vr.Down?R.top:R.top+R.height/2,d.y))},I=v===Vr.Right&&!w||v===Vr.Left&&!S,P=v===Vr.Down&&!C||v===Vr.Up&&!x;if(I&&N.x!==d.x){const L=b.scrollLeft+h.x,O=v===Vr.Right&&L<=k.x||v===Vr.Left&&L>=A.x;if(O&&!h.y){b.scrollTo({left:L,behavior:o});return}O?m.x=b.scrollLeft-L:m.x=v===Vr.Right?b.scrollLeft-k.x:b.scrollLeft-A.x,m.x&&b.scrollBy({left:-m.x,behavior:o});break}else if(P&&N.y!==d.y){const L=b.scrollTop+h.y,O=v===Vr.Down&&L<=k.y||v===Vr.Up&&L>=A.y;if(O&&!h.x){b.scrollTo({top:L,behavior:o});return}O?m.y=b.scrollTop-L:m.y=v===Vr.Down?b.scrollTop-k.y:b.scrollTop-A.y,m.y&&b.scrollBy({top:-m.y,behavior:o});break}}this.handleMove(t,L0(r1(d,this.referenceCoordinates),m))}}}handleMove(t,n){const{onMove:r}=this.props;t.preventDefault(),r(n)}handleEnd(t){const{onEnd:n}=this.props;t.preventDefault(),this.detach(),n()}handleCancel(t){const{onCancel:n}=this.props;t.preventDefault(),this.detach(),n()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}sF.activators=[{eventName:"onKeyDown",handler:(e,t,n)=>{let{keyboardCodes:r=Cde,onActivation:s}=t,{active:i}=n;const{code:a}=e.nativeEvent;if(r.start.includes(a)){const o=i.activatorNode.current;return o&&e.target!==o?!1:(e.preventDefault(),s==null||s({event:e.nativeEvent}),!0)}return!1}}];function NW(e){return!!(e&&"distance"in e)}function MW(e){return!!(e&&"delay"in e)}class iF{constructor(t,n,r){var s;r===void 0&&(r=slt(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=n;const{event:i}=t,{target:a}=i;this.props=t,this.events=n,this.document=bb(a),this.documentListeners=new Ox(this.document),this.listeners=new Ox(r),this.windowListeners=new Ox(qo(a)),this.initialCoordinates=(s=kP(i))!=null?s:Fc,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:n,bypassActivationConstraint:r}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(Ul.Resize,this.handleCancel),this.windowListeners.add(Ul.DragStart,RW),this.windowListeners.add(Ul.VisibilityChange,this.handleCancel),this.windowListeners.add(Ul.ContextMenu,RW),this.documentListeners.add(Ul.Keydown,this.handleKeydown),n){if(r!=null&&r({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(MW(n)){this.timeoutId=setTimeout(this.handleStart,n.delay),this.handlePending(n);return}if(NW(n)){this.handlePending(n);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,n){const{active:r,onPending:s}=this.props;s(r,t,this.initialCoordinates,n)}handleStart(){const{initialCoordinates:t}=this,{onStart:n}=this.props;t&&(this.activated=!0,this.documentListeners.add(Ul.Click,ilt,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(Ul.SelectionChange,this.removeTextSelection),n(t))}handleMove(t){var n;const{activated:r,initialCoordinates:s,props:i}=this,{onMove:a,options:{activationConstraint:o}}=i;if(!s)return;const l=(n=kP(t))!=null?n:Fc,c=r1(s,l);if(!r&&o){if(NW(o)){if(o.tolerance!=null&&O3(c,o.tolerance))return this.handleCancel();if(O3(c,o.distance))return this.handleStart()}if(MW(o)&&O3(c,o.tolerance))return this.handleCancel();this.handlePending(o,c);return}t.cancelable&&t.preventDefault(),a(l)}handleEnd(){const{onAbort:t,onEnd:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleCancel(){const{onAbort:t,onCancel:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleKeydown(t){t.code===Vr.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const olt={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class aF extends iF{constructor(t){const{event:n}=t,r=bb(n.target);super(t,olt,r)}}aF.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return!n.isPrimary||n.button!==0?!1:(r==null||r({event:n}),!0)}}];const llt={move:{name:"mousemove"},end:{name:"mouseup"}};var TP;(function(e){e[e.RightClick=2]="RightClick"})(TP||(TP={}));class clt extends iF{constructor(t){super(t,llt,bb(t.event.target))}}clt.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return n.button===TP.RightClick?!1:(r==null||r({event:n}),!0)}}];const D3={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class ult extends iF{constructor(t){super(t,D3)}static setup(){return window.addEventListener(D3.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(D3.move.name,t)};function t(){}}}ult.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;const{touches:s}=n;return s.length>1?!1:(r==null||r({event:n}),!0)}}];var Dx;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(Dx||(Dx={}));var oE;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(oE||(oE={}));function dlt(e){let{acceleration:t,activator:n=Dx.Pointer,canScroll:r,draggingRect:s,enabled:i,interval:a=5,order:o=oE.TreeOrder,pointerCoordinates:l,scrollableAncestors:c,scrollableAncestorRects:u,delta:d,threshold:h}=e;const m=hlt({delta:d,disabled:!i}),[y,b]=Sot(),v=T.useRef({x:0,y:0}),x=T.useRef({x:0,y:0}),w=T.useMemo(()=>{switch(n){case Dx.Pointer:return l?{top:l.y,bottom:l.y,left:l.x,right:l.x}:null;case Dx.DraggableRect:return s}},[n,s,l]),S=T.useRef(null),C=T.useCallback(()=>{const A=S.current;if(!A)return;const R=v.current.x*x.current.x,N=v.current.y*x.current.y;A.scrollBy(R,N)},[]),k=T.useMemo(()=>o===oE.TreeOrder?[...c].reverse():c,[o,c]);T.useEffect(()=>{if(!i||!c.length||!w){b();return}for(const A of k){if((r==null?void 0:r(A))===!1)continue;const R=c.indexOf(A),N=u[R];if(!N)continue;const{direction:I,speed:P}=Jot(A,N,w,t,h);for(const L of["x","y"])m[L][I[L]]||(P[L]=0,I[L]=0);if(P.x>0||P.y>0){b(),S.current=A,y(C,a),v.current=P,x.current=I;return}}v.current={x:0,y:0},x.current={x:0,y:0},b()},[t,C,r,b,i,a,JSON.stringify(w),JSON.stringify(m),y,c,k,u,JSON.stringify(h)])}const flt={x:{[ra.Backward]:!1,[ra.Forward]:!1},y:{[ra.Backward]:!1,[ra.Forward]:!1}};function hlt(e){let{delta:t,disabled:n}=e;const r=CP(t);return d_(s=>{if(n||!r||!s)return flt;const i={x:Math.sign(t.x-r.x),y:Math.sign(t.y-r.y)};return{x:{[ra.Backward]:s.x[ra.Backward]||i.x===-1,[ra.Forward]:s.x[ra.Forward]||i.x===1},y:{[ra.Backward]:s.y[ra.Backward]||i.y===-1,[ra.Forward]:s.y[ra.Forward]||i.y===1}}},[n,t,r])}function plt(e,t){const n=t!=null?e.get(t):void 0,r=n?n.node.current:null;return d_(s=>{var i;return t==null?null:(i=r??s)!=null?i:null},[r,t])}function mlt(e,t){return T.useMemo(()=>e.reduce((n,r)=>{const{sensor:s}=r,i=s.activators.map(a=>({eventName:a.eventName,handler:t(a.handler,r)}));return[...n,...i]},[]),[e,t])}var i1;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(i1||(i1={}));var AP;(function(e){e.Optimized="optimized"})(AP||(AP={}));const IW=new Map;function glt(e,t){let{dragging:n,dependencies:r,config:s}=t;const[i,a]=T.useState(null),{frequency:o,measure:l,strategy:c}=s,u=T.useRef(e),d=v(),h=n1(d),m=T.useCallback(function(x){x===void 0&&(x=[]),!h.current&&a(w=>w===null?x:w.concat(x.filter(S=>!w.includes(S))))},[h]),y=T.useRef(null),b=d_(x=>{if(d&&!n)return IW;if(!x||x===IW||u.current!==e||i!=null){const w=new Map;for(let S of e){if(!S)continue;if(i&&i.length>0&&!i.includes(S.id)&&S.rect.current){w.set(S.id,S.rect.current);continue}const C=S.node.current,k=C?new rF(l(C),C):null;S.rect.current=k,k&&w.set(S.id,k)}return w}return x},[e,i,n,d,l]);return T.useEffect(()=>{u.current=e},[e]),T.useEffect(()=>{d||m()},[n,d]),T.useEffect(()=>{i&&i.length>0&&a(null)},[JSON.stringify(i)]),T.useEffect(()=>{d||typeof o!="number"||y.current!==null||(y.current=setTimeout(()=>{m(),y.current=null},o))},[o,d,m,...r]),{droppableRects:b,measureDroppableContainers:m,measuringScheduled:i!=null};function v(){switch(c){case i1.Always:return!1;case i1.BeforeDragging:return n;default:return!n}}}function kde(e,t){return d_(n=>e?n||(typeof t=="function"?t(e):e):null,[t,e])}function ylt(e,t){return kde(e,t)}function blt(e){let{callback:t,disabled:n}=e;const r=tF(t),s=T.useMemo(()=>{if(n||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:i}=window;return new i(r)},[r,n]);return T.useEffect(()=>()=>s==null?void 0:s.disconnect(),[s]),s}function gA(e){let{callback:t,disabled:n}=e;const r=tF(t),s=T.useMemo(()=>{if(n||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:i}=window;return new i(r)},[n]);return T.useEffect(()=>()=>s==null?void 0:s.disconnect(),[s]),s}function vlt(e){return new rF(vb(e),e)}function jW(e,t,n){t===void 0&&(t=vlt);const[r,s]=T.useState(null);function i(){s(l=>{if(!e)return null;if(e.isConnected===!1){var c;return(c=l??n)!=null?c:null}const u=t(e);return JSON.stringify(l)===JSON.stringify(u)?l:u})}const a=blt({callback(l){if(e)for(const c of l){const{type:u,target:d}=c;if(u==="childList"&&d instanceof HTMLElement&&d.contains(e)){i();break}}}}),o=gA({callback:i});return Fu(()=>{i(),e?(o==null||o.observe(e),a==null||a.observe(document.body,{childList:!0,subtree:!0})):(o==null||o.disconnect(),a==null||a.disconnect())},[e]),r}function xlt(e){const t=kde(e);return yde(e,t)}const PW=[];function wlt(e){const t=T.useRef(e),n=d_(r=>e?r&&r!==PW&&e&&t.current&&e.parentNode===t.current.parentNode?r:mA(e):PW,[e]);return T.useEffect(()=>{t.current=e},[e]),n}function _lt(e){const[t,n]=T.useState(null),r=T.useRef(e),s=T.useCallback(i=>{const a=P3(i.target);a&&n(o=>o?(o.set(a,EP(a)),new Map(o)):null)},[]);return T.useEffect(()=>{const i=r.current;if(e!==i){a(i);const o=e.map(l=>{const c=P3(l);return c?(c.addEventListener("scroll",s,{passive:!0}),[c,EP(c)]):null}).filter(l=>l!=null);n(o.length?new Map(o):null),r.current=e}return()=>{a(e),a(i)};function a(o){o.forEach(l=>{const c=P3(l);c==null||c.removeEventListener("scroll",s)})}},[s,e]),T.useMemo(()=>e.length?t?Array.from(t.values()).reduce((i,a)=>L0(i,a),Fc):Sde(e):Fc,[e,t])}function OW(e,t){t===void 0&&(t=[]);const n=T.useRef(null);return T.useEffect(()=>{n.current=null},t),T.useEffect(()=>{const r=e!==Fc;r&&!n.current&&(n.current=e),!r&&n.current&&(n.current=null)},[e]),n.current?r1(e,n.current):Fc}function Slt(e){T.useEffect(()=>{if(!pA)return;const t=e.map(n=>{let{sensor:r}=n;return r.setup==null?void 0:r.setup()});return()=>{for(const n of t)n==null||n()}},e.map(t=>{let{sensor:n}=t;return n}))}function Clt(e,t){return T.useMemo(()=>e.reduce((n,r)=>{let{eventName:s,handler:i}=r;return n[s]=a=>{i(a,t)},n},{}),[e,t])}function Ede(e){return T.useMemo(()=>e?Kot(e):null,[e])}const DW=[];function klt(e,t){t===void 0&&(t=vb);const[n]=e,r=Ede(n?qo(n):null),[s,i]=T.useState(DW);function a(){i(()=>e.length?e.map(l=>wde(l)?r:new rF(t(l),l)):DW)}const o=gA({callback:a});return Fu(()=>{o==null||o.disconnect(),a(),e.forEach(l=>o==null?void 0:o.observe(l))},[e]),s}function Elt(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return u_(t)?t:e}function Tlt(e){let{measure:t}=e;const[n,r]=T.useState(null),s=T.useCallback(c=>{for(const{target:u}of c)if(u_(u)){r(d=>{const h=t(u);return d?{...d,width:h.width,height:h.height}:h});break}},[t]),i=gA({callback:s}),a=T.useCallback(c=>{const u=Elt(c);i==null||i.disconnect(),u&&(i==null||i.observe(u)),r(u?t(u):null)},[t,i]),[o,l]=iE(a);return T.useMemo(()=>({nodeRef:o,rect:n,setRef:l}),[n,o,l])}const Alt=[{sensor:aF,options:{}},{sensor:sF,options:{}}],Rlt={current:{}},Q2={draggable:{measure:AW},droppable:{measure:AW,strategy:i1.WhileDragging,frequency:AP.Optimized},dragOverlay:{measure:vb}};class Fx extends Map{get(t){var n;return t!=null&&(n=super.get(t))!=null?n:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:n}=t;return!n})}getNodeFor(t){var n,r;return(n=(r=this.get(t))==null?void 0:r.node.current)!=null?n:void 0}}const Nlt={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new Fx,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:aE},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:Q2,measureDroppableContainers:aE,windowRect:null,measuringScheduled:!1},Mlt={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:aE,draggableNodes:new Map,over:null,measureDroppableContainers:aE},yA=T.createContext(Mlt),Tde=T.createContext(Nlt);function Ilt(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new Fx}}}function jlt(e,t){switch(t.type){case Li.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case Li.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case Li.DragEnd:case Li.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case Li.RegisterDroppable:{const{element:n}=t,{id:r}=n,s=new Fx(e.droppable.containers);return s.set(r,n),{...e,droppable:{...e.droppable,containers:s}}}case Li.SetDroppableDisabled:{const{id:n,key:r,disabled:s}=t,i=e.droppable.containers.get(n);if(!i||r!==i.key)return e;const a=new Fx(e.droppable.containers);return a.set(n,{...i,disabled:s}),{...e,droppable:{...e.droppable,containers:a}}}case Li.UnregisterDroppable:{const{id:n,key:r}=t,s=e.droppable.containers.get(n);if(!s||r!==s.key)return e;const i=new Fx(e.droppable.containers);return i.delete(n),{...e,droppable:{...e.droppable,containers:i}}}default:return e}}function Plt(e){let{disabled:t}=e;const{active:n,activatorEvent:r,draggableNodes:s}=T.useContext(yA),i=CP(r),a=CP(n==null?void 0:n.id);return T.useEffect(()=>{if(!t&&!r&&i&&a!=null){if(!nF(i)||document.activeElement===i.target)return;const o=s.get(a);if(!o)return;const{activatorNode:l,node:c}=o;if(!l.current&&!c.current)return;requestAnimationFrame(()=>{for(const u of[l.current,c.current]){if(!u)continue;const d=Eot(u);if(d){d.focus();break}}})}},[r,t,s,a,i]),null}function Olt(e,t){let{transform:n,...r}=t;return e!=null&&e.length?e.reduce((s,i)=>i({transform:s,...r}),n):n}function Dlt(e){return T.useMemo(()=>({draggable:{...Q2.draggable,...e==null?void 0:e.draggable},droppable:{...Q2.droppable,...e==null?void 0:e.droppable},dragOverlay:{...Q2.dragOverlay,...e==null?void 0:e.dragOverlay}}),[e==null?void 0:e.draggable,e==null?void 0:e.droppable,e==null?void 0:e.dragOverlay])}function Flt(e){let{activeNode:t,measure:n,initialRect:r,config:s=!0}=e;const i=T.useRef(!1),{x:a,y:o}=typeof s=="boolean"?{x:s,y:s}:s;Fu(()=>{if(!a&&!o||!t){i.current=!1;return}if(i.current||!r)return;const c=t==null?void 0:t.node.current;if(!c||c.isConnected===!1)return;const u=n(c),d=yde(u,r);if(a||(d.x=0),o||(d.y=0),i.current=!0,Math.abs(d.x)>0||Math.abs(d.y)>0){const h=bde(c);h&&h.scrollBy({top:d.y,left:d.x})}},[t,a,o,r,n])}const Ade=T.createContext({...Fc,scaleX:1,scaleY:1});var ih;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(ih||(ih={}));const Llt=T.memo(function(t){var n,r,s,i;let{id:a,accessibility:o,autoScroll:l=!0,children:c,sensors:u=Alt,collisionDetection:d=zot,measuring:h,modifiers:m,...y}=t;const b=T.useReducer(jlt,void 0,Ilt),[v,x]=b,[w,S]=Iot(),[C,k]=T.useState(ih.Uninitialized),A=C===ih.Initialized,{draggable:{active:R,nodes:N,translate:I},droppable:{containers:P}}=v,L=R!=null?N.get(R):null,O=T.useRef({initial:null,translated:null}),V=T.useMemo(()=>{var st;return R!=null?{id:R,data:(st=L==null?void 0:L.data)!=null?st:Rlt,rect:O}:null},[R,L]),D=T.useRef(null),[Z,U]=T.useState(null),[H,$]=T.useState(null),ne=n1(y,Object.values(y)),W=f_("DndDescribedBy",a),Q=T.useMemo(()=>P.getEnabled(),[P]),ee=Dlt(h),{droppableRects:se,measureDroppableContainers:pe,measuringScheduled:ce}=glt(Q,{dragging:A,dependencies:[I.x,I.y],config:ee.droppable}),Ie=plt(N,R),De=T.useMemo(()=>H?kP(H):null,[H]),Se=ze(),Ce=ylt(Ie,ee.draggable.measure);Flt({activeNode:R!=null?N.get(R):null,config:Se.layoutShiftCompensation,initialRect:Ce,measure:ee.draggable.measure});const qe=jW(Ie,ee.draggable.measure,Ce),Qe=jW(Ie?Ie.parentElement:null),Ve=T.useRef({activatorEvent:null,active:null,activeNode:Ie,collisionRect:null,collisions:null,droppableRects:se,draggableNodes:N,draggingNode:null,draggingNodeRect:null,droppableContainers:P,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),Ne=P.getNodeFor((n=Ve.current.over)==null?void 0:n.id),K=Tlt({measure:ee.dragOverlay.measure}),ge=(r=K.nodeRef.current)!=null?r:Ie,Ae=A?(s=K.rect)!=null?s:qe:null,le=!!(K.nodeRef.current&&K.rect),oe=xlt(le?null:qe),re=Ede(ge?qo(ge):null),Te=wlt(A?Ne??Ie:null),Be=klt(Te),ke=Olt(m,{transform:{x:I.x-oe.x,y:I.y-oe.y,scaleX:1,scaleY:1},activatorEvent:H,active:V,activeNodeRect:qe,containerNodeRect:Qe,draggingNodeRect:Ae,over:Ve.current.over,overlayNodeRect:K.rect,scrollableAncestors:Te,scrollableAncestorRects:Be,windowRect:re}),lt=De?L0(De,I):null,Rt=_lt(Te),ht=OW(Rt),Pt=OW(Rt,[qe]),qt=L0(ke,ht),Lt=Ae?Vot(Ae,ke):null,en=V&&Lt?d({active:V,collisionRect:Lt,droppableRects:se,droppableContainers:Q,pointerCoordinates:lt}):null,xe=gde(en,"id"),[F,X]=T.useState(null),ye=le?ke:L0(ke,Pt),Fe=Uot(ye,(i=F==null?void 0:F.rect)!=null?i:null,qe),we=T.useRef(null),Me=T.useCallback((st,be)=>{let{sensor:_e,options:Ue}=be;if(D.current==null)return;const kt=N.get(D.current);if(!kt)return;const fe=st.nativeEvent,Y=new _e({active:D.current,activeNode:kt,event:fe,options:Ue,context:Ve,onAbort(J){if(!N.get(J))return;const{onDragAbort:Oe}=ne.current,Ge={id:J};Oe==null||Oe(Ge),w({type:"onDragAbort",event:Ge})},onPending(J,ve,Oe,Ge){if(!N.get(J))return;const{onDragPending:tn}=ne.current,Un={id:J,constraint:ve,initialCoordinates:Oe,offset:Ge};tn==null||tn(Un),w({type:"onDragPending",event:Un})},onStart(J){const ve=D.current;if(ve==null)return;const Oe=N.get(ve);if(!Oe)return;const{onDragStart:Ge}=ne.current,_t={activatorEvent:fe,active:{id:ve,data:Oe.data,rect:O}};al.unstable_batchedUpdates(()=>{Ge==null||Ge(_t),k(ih.Initializing),x({type:Li.DragStart,initialCoordinates:J,active:ve}),w({type:"onDragStart",event:_t}),U(we.current),$(fe)})},onMove(J){x({type:Li.DragMove,coordinates:J})},onEnd:G(Li.DragEnd),onCancel:G(Li.DragCancel)});we.current=Y;function G(J){return async function(){const{active:Oe,collisions:Ge,over:_t,scrollAdjustedTranslate:tn}=Ve.current;let Un=null;if(Oe&&tn){const{cancelDrop:Xt}=ne.current;Un={activatorEvent:fe,active:Oe,collisions:Ge,delta:tn,over:_t},J===Li.DragEnd&&typeof Xt=="function"&&await Promise.resolve(Xt(Un))&&(J=Li.DragCancel)}D.current=null,al.unstable_batchedUpdates(()=>{x({type:J}),k(ih.Uninitialized),X(null),U(null),$(null),we.current=null;const Xt=J===Li.DragEnd?"onDragEnd":"onDragCancel";if(Un){const nn=ne.current[Xt];nn==null||nn(Un),w({type:Xt,event:Un})}})}}},[N]),de=T.useCallback((st,be)=>(_e,Ue)=>{const kt=_e.nativeEvent,fe=N.get(Ue);if(D.current!==null||!fe||kt.dndKit||kt.defaultPrevented)return;const Y={active:fe};st(_e,be.options,Y)===!0&&(kt.dndKit={capturedBy:be.sensor},D.current=Ue,Me(_e,be))},[N,Me]),vt=mlt(u,de);Slt(u),Fu(()=>{qe&&C===ih.Initializing&&k(ih.Initialized)},[qe,C]),T.useEffect(()=>{const{onDragMove:st}=ne.current,{active:be,activatorEvent:_e,collisions:Ue,over:kt}=Ve.current;if(!be||!_e)return;const fe={active:be,activatorEvent:_e,collisions:Ue,delta:{x:qt.x,y:qt.y},over:kt};al.unstable_batchedUpdates(()=>{st==null||st(fe),w({type:"onDragMove",event:fe})})},[qt.x,qt.y]),T.useEffect(()=>{const{active:st,activatorEvent:be,collisions:_e,droppableContainers:Ue,scrollAdjustedTranslate:kt}=Ve.current;if(!st||D.current==null||!be||!kt)return;const{onDragOver:fe}=ne.current,Y=Ue.get(xe),G=Y&&Y.rect.current?{id:Y.id,rect:Y.rect.current,data:Y.data,disabled:Y.disabled}:null,J={active:st,activatorEvent:be,collisions:_e,delta:{x:kt.x,y:kt.y},over:G};al.unstable_batchedUpdates(()=>{X(G),fe==null||fe(J),w({type:"onDragOver",event:J})})},[xe]),Fu(()=>{Ve.current={activatorEvent:H,active:V,activeNode:Ie,collisionRect:Lt,collisions:en,droppableRects:se,draggableNodes:N,draggingNode:ge,draggingNodeRect:Ae,droppableContainers:P,over:F,scrollableAncestors:Te,scrollAdjustedTranslate:qt},O.current={initial:Ae,translated:Lt}},[V,Ie,en,Lt,N,ge,Ae,se,P,F,Te,qt]),dlt({...Se,delta:I,draggingRect:Lt,pointerCoordinates:lt,scrollableAncestors:Te,scrollableAncestorRects:Be});const ot=T.useMemo(()=>({active:V,activeNode:Ie,activeNodeRect:qe,activatorEvent:H,collisions:en,containerNodeRect:Qe,dragOverlay:K,draggableNodes:N,droppableContainers:P,droppableRects:se,over:F,measureDroppableContainers:pe,scrollableAncestors:Te,scrollableAncestorRects:Be,measuringConfiguration:ee,measuringScheduled:ce,windowRect:re}),[V,Ie,qe,H,en,Qe,K,N,P,se,F,pe,Te,Be,ee,ce,re]),B=T.useMemo(()=>({activatorEvent:H,activators:vt,active:V,activeNodeRect:qe,ariaDescribedById:{draggable:W},dispatch:x,draggableNodes:N,over:F,measureDroppableContainers:pe}),[H,vt,V,qe,x,W,N,F,pe]);return We.createElement(hde.Provider,{value:S},We.createElement(yA.Provider,{value:B},We.createElement(Tde.Provider,{value:ot},We.createElement(Ade.Provider,{value:Fe},c)),We.createElement(Plt,{disabled:(o==null?void 0:o.restoreFocus)===!1})),We.createElement(Oot,{...o,hiddenTextDescribedById:W}));function ze(){const st=(Z==null?void 0:Z.autoScrollEnabled)===!1,be=typeof l=="object"?l.enabled===!1:l===!1,_e=A&&!st&&!be;return typeof l=="object"?{...l,enabled:_e}:{enabled:_e}}}),Blt=T.createContext(null),FW="button",$lt="Draggable";function zlt(e){let{id:t,data:n,disabled:r=!1,attributes:s}=e;const i=f_($lt),{activators:a,activatorEvent:o,active:l,activeNodeRect:c,ariaDescribedById:u,draggableNodes:d,over:h}=T.useContext(yA),{role:m=FW,roleDescription:y="draggable",tabIndex:b=0}=s??{},v=(l==null?void 0:l.id)===t,x=T.useContext(v?Ade:Blt),[w,S]=iE(),[C,k]=iE(),A=Clt(a,t),R=n1(n);Fu(()=>(d.set(t,{id:t,key:i,node:w,activatorNode:C,data:R}),()=>{const I=d.get(t);I&&I.key===i&&d.delete(t)}),[d,t]);const N=T.useMemo(()=>({role:m,tabIndex:b,"aria-disabled":r,"aria-pressed":v&&m===FW?!0:void 0,"aria-roledescription":y,"aria-describedby":u.draggable}),[r,m,b,v,y,u.draggable]);return{active:l,activatorEvent:o,activeNodeRect:c,attributes:N,isDragging:v,listeners:r?void 0:A,node:w,over:h,setNodeRef:S,setActivatorNodeRef:k,transform:x}}function Ult(){return T.useContext(Tde)}const qlt="Droppable",Vlt={timeout:25};function Wlt(e){let{data:t,disabled:n=!1,id:r,resizeObserverConfig:s}=e;const i=f_(qlt),{active:a,dispatch:o,over:l,measureDroppableContainers:c}=T.useContext(yA),u=T.useRef({disabled:n}),d=T.useRef(!1),h=T.useRef(null),m=T.useRef(null),{disabled:y,updateMeasurementsFor:b,timeout:v}={...Vlt,...s},x=n1(b??r),w=T.useCallback(()=>{if(!d.current){d.current=!0;return}m.current!=null&&clearTimeout(m.current),m.current=setTimeout(()=>{c(Array.isArray(x.current)?x.current:[x.current]),m.current=null},v)},[v]),S=gA({callback:w,disabled:y||!a}),C=T.useCallback((N,I)=>{S&&(I&&(S.unobserve(I),d.current=!1),N&&S.observe(N))},[S]),[k,A]=iE(C),R=n1(t);return T.useEffect(()=>{!S||!k.current||(S.disconnect(),d.current=!1,S.observe(k.current))},[k,S]),T.useEffect(()=>(o({type:Li.RegisterDroppable,element:{id:r,key:i,disabled:n,node:k,rect:h,data:R}}),()=>o({type:Li.UnregisterDroppable,key:i,id:r})),[r]),T.useEffect(()=>{n!==u.current.disabled&&(o({type:Li.SetDroppableDisabled,id:r,key:i,disabled:n}),u.current.disabled=n)},[r,i,n,o]),{active:a,rect:h,isOver:(l==null?void 0:l.id)===r,node:k,over:l,setNodeRef:A}}function Lx(e,t,n){const r=e.slice();return r.splice(n<0?r.length+n:n,0,r.splice(t,1)[0]),r}function Hlt(e,t){return e.reduce((n,r,s)=>{const i=t.get(r);return i&&(n[s]=i),n},Array(e.length))}function v2(e){return e!==null&&e>=0}function Glt(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function Klt(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const Rde=e=>{let{rects:t,activeIndex:n,overIndex:r,index:s}=e;const i=Lx(t,r,n),a=t[s],o=i[s];return!o||!a?null:{x:o.left-a.left,y:o.top-a.top,scaleX:o.width/a.width,scaleY:o.height/a.height}},x2={scaleX:1,scaleY:1},Ylt=e=>{var t;let{activeIndex:n,activeNodeRect:r,index:s,rects:i,overIndex:a}=e;const o=(t=i[n])!=null?t:r;if(!o)return null;if(s===n){const c=i[a];return c?{x:0,y:n<a?c.top+c.height-(o.top+o.height):c.top-o.top,...x2}:null}const l=Zlt(i,s,n);return s>n&&s<=a?{x:0,y:-o.height-l,...x2}:s<n&&s>=a?{x:0,y:o.height+l,...x2}:{x:0,y:0,...x2}};function Zlt(e,t,n){const r=e[t],s=e[t-1],i=e[t+1];return r?n<t?s?r.top-(s.top+s.height):i?i.top-(r.top+r.height):0:i?i.top-(r.top+r.height):s?r.top-(s.top+s.height):0:0}const Nde="Sortable",Mde=We.createContext({activeIndex:-1,containerId:Nde,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:Rde,disabled:{draggable:!1,droppable:!1}});function Xlt(e){let{children:t,id:n,items:r,strategy:s=Rde,disabled:i=!1}=e;const{active:a,dragOverlay:o,droppableRects:l,over:c,measureDroppableContainers:u}=Ult(),d=f_(Nde,n),h=o.rect!==null,m=T.useMemo(()=>r.map(A=>typeof A=="object"&&"id"in A?A.id:A),[r]),y=a!=null,b=a?m.indexOf(a.id):-1,v=c?m.indexOf(c.id):-1,x=T.useRef(m),w=!Glt(m,x.current),S=v!==-1&&b===-1||w,C=Klt(i);Fu(()=>{w&&y&&u(m)},[w,m,y,u]),T.useEffect(()=>{x.current=m},[m]);const k=T.useMemo(()=>({activeIndex:b,containerId:d,disabled:C,disableTransforms:S,items:m,overIndex:v,useDragOverlay:h,sortedRects:Hlt(m,l),strategy:s}),[b,d,C.draggable,C.droppable,S,m,v,l,h,s]);return We.createElement(Mde.Provider,{value:k},t)}const Jlt=e=>{let{id:t,items:n,activeIndex:r,overIndex:s}=e;return Lx(n,r,s).indexOf(t)},Qlt=e=>{let{containerId:t,isSorting:n,wasDragging:r,index:s,items:i,newIndex:a,previousItems:o,previousContainerId:l,transition:c}=e;return!c||!r||o!==i&&s===a?!1:n?!0:a!==s&&t===l},ect={duration:200,easing:"ease"},Ide="transform",tct=s1.Transition.toString({property:Ide,duration:0,easing:"linear"}),nct={roleDescription:"sortable"};function rct(e){let{disabled:t,index:n,node:r,rect:s}=e;const[i,a]=T.useState(null),o=T.useRef(n);return Fu(()=>{if(!t&&n!==o.current&&r.current){const l=s.current;if(l){const c=vb(r.current,{ignoreTransform:!0}),u={x:l.left-c.left,y:l.top-c.top,scaleX:l.width/c.width,scaleY:l.height/c.height};(u.x||u.y)&&a(u)}}n!==o.current&&(o.current=n)},[t,n,r,s]),T.useEffect(()=>{i&&a(null)},[i]),i}function sct(e){let{animateLayoutChanges:t=Qlt,attributes:n,disabled:r,data:s,getNewIndex:i=Jlt,id:a,strategy:o,resizeObserverConfig:l,transition:c=ect}=e;const{items:u,containerId:d,activeIndex:h,disabled:m,disableTransforms:y,sortedRects:b,overIndex:v,useDragOverlay:x,strategy:w}=T.useContext(Mde),S=ict(r,m),C=u.indexOf(a),k=T.useMemo(()=>({sortable:{containerId:d,index:C,items:u},...s}),[d,s,C,u]),A=T.useMemo(()=>u.slice(u.indexOf(a)),[u,a]),{rect:R,node:N,isOver:I,setNodeRef:P}=Wlt({id:a,data:k,disabled:S.droppable,resizeObserverConfig:{updateMeasurementsFor:A,...l}}),{active:L,activatorEvent:O,activeNodeRect:V,attributes:D,setNodeRef:Z,listeners:U,isDragging:H,over:$,setActivatorNodeRef:ne,transform:W}=zlt({id:a,data:k,attributes:{...nct,...n},disabled:S.draggable}),Q=_ot(P,Z),ee=!!L,se=ee&&!y&&v2(h)&&v2(v),pe=!x&&H,ce=pe&&se?W:null,De=se?ce??(o??w)({rects:b,activeNodeRect:V,activeIndex:h,overIndex:v,index:C}):null,Se=v2(h)&&v2(v)?i({id:a,items:u,activeIndex:h,overIndex:v}):C,Ce=L==null?void 0:L.id,qe=T.useRef({activeId:Ce,items:u,newIndex:Se,containerId:d}),Qe=u!==qe.current.items,Ve=t({active:L,containerId:d,isDragging:H,isSorting:ee,id:a,index:C,items:u,newIndex:qe.current.newIndex,previousItems:qe.current.items,previousContainerId:qe.current.containerId,transition:c,wasDragging:qe.current.activeId!=null}),Ne=rct({disabled:!Ve,index:C,node:N,rect:R});return T.useEffect(()=>{ee&&qe.current.newIndex!==Se&&(qe.current.newIndex=Se),d!==qe.current.containerId&&(qe.current.containerId=d),u!==qe.current.items&&(qe.current.items=u)},[ee,Se,d,u]),T.useEffect(()=>{if(Ce===qe.current.activeId)return;if(Ce!=null&&qe.current.activeId==null){qe.current.activeId=Ce;return}const ge=setTimeout(()=>{qe.current.activeId=Ce},50);return()=>clearTimeout(ge)},[Ce]),{active:L,activeIndex:h,attributes:D,data:k,rect:R,index:C,newIndex:Se,items:u,isOver:I,isSorting:ee,isDragging:H,listeners:U,node:N,overIndex:v,over:$,setNodeRef:Q,setActivatorNodeRef:ne,setDroppableNodeRef:P,setDraggableNodeRef:Z,transform:Ne??De,transition:K()};function K(){if(Ne||Qe&&qe.current.newIndex===C)return tct;if(!(pe&&!nF(O)||!c)&&(ee||Ve))return s1.Transition.toString({...c,property:Ide})}}function ict(e,t){var n,r;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(n=e==null?void 0:e.draggable)!=null?n:t.draggable,droppable:(r=e==null?void 0:e.droppable)!=null?r:t.droppable}}function lE(e){if(!e)return!1;const t=e.data.current;return!!(t&&"sortable"in t&&typeof t.sortable=="object"&&"containerId"in t.sortable&&"items"in t.sortable&&"index"in t.sortable)}const act=[Vr.Down,Vr.Right,Vr.Up,Vr.Left],oct=(e,t)=>{let{context:{active:n,collisionRect:r,droppableRects:s,droppableContainers:i,over:a,scrollableAncestors:o}}=t;if(act.includes(e.code)){if(e.preventDefault(),!n||!r)return;const l=[];i.getEnabled().forEach(d=>{if(!d||d!=null&&d.disabled)return;const h=s.get(d.id);if(h)switch(e.code){case Vr.Down:r.top<h.top&&l.push(d);break;case Vr.Up:r.top>h.top&&l.push(d);break;case Vr.Left:r.left>h.left&&l.push(d);break;case Vr.Right:r.left<h.left&&l.push(d);break}});const c=Bot({collisionRect:r,droppableRects:s,droppableContainers:l});let u=gde(c,"id");if(u===(a==null?void 0:a.id)&&c.length>1&&(u=c[1].id),u!=null){const d=i.get(n.id),h=i.get(u),m=h?s.get(h.id):null,y=h==null?void 0:h.node.current;if(y&&m&&d&&h){const v=mA(y).some((A,R)=>o[R]!==A),x=jde(d,h),w=lct(d,h),S=v||!x?{x:0,y:0}:{x:w?r.width-m.width:0,y:w?r.height-m.height:0},C={x:m.left,y:m.top};return S.x&&S.y?C:r1(C,S)}}}};function jde(e,t){return!lE(e)||!lE(t)?!1:e.data.current.sortable.containerId===t.data.current.sortable.containerId}function lct(e,t){return!lE(e)||!lE(t)||!jde(e,t)?!1:e.data.current.sortable.index<t.data.current.sortable.index}const cct=({id:e,modelDetails:t,buttonsDisabled:n,onMoveToTop:r,onMoveUp:s,onMoveDown:i,isFirst:a,isLast:o})=>{var k,A,R;const{attributes:l,listeners:c,setNodeRef:u,transform:d,transition:h,isDragging:m}=sct({id:e,disabled:!1}),y={transform:s1.Transform.toString(d),transition:h,zIndex:m?10:void 0},b=new Set(((k=t.metadataSummary)==null?void 0:k.supported_parameters)??[]),v=new Set(((A=t.metadataSummary)==null?void 0:A.input_modalities)??[]),x=b.has("reasoning"),w=b.has("web_search")||b.has("web_search_options"),S=b.has("tools"),C=Array.from(v).some(N=>N!=="text");return f.jsxs("div",{ref:u,style:y,className:Ze("flex items-center space-x-2 p-2 rounded border border-transparent bg-muted/50 hover:bg-muted mb-1",m&&"shadow-lg border-primary bg-card","cursor-grab active:cursor-grabbing"),"aria-label":`Drag to reorder model ${t.name}`,children:[f.jsx("button",{...l,...c,type:"button",className:Ze("p-1 flex-shrink-0","hover:text-foreground"),"aria-hidden":"true",tabIndex:-1,children:f.jsx(Tme,{className:"h-5 w-5 text-muted-foreground"})}),f.jsxs("div",{className:"flex-grow min-w-0",children:[f.jsxs(It,{className:Ze("text-sm font-normal text-foreground flex-grow truncate pointer-events-none"),children:[t.name," ",f.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",t.providerName,")"]})]}),f.jsxs("div",{className:"flex items-center gap-1 mt-0.5",children:[x&&f.jsx(Fh,{className:"h-3 w-3 text-blue-500"}),w&&f.jsx(Fa,{className:"h-3 w-3 text-green-500"}),S&&f.jsx(ym,{className:"h-3 w-3 text-orange-500"}),C&&f.jsx(mm,{className:"h-3 w-3 text-purple-500"})]})]}),f.jsxs("div",{className:"flex items-center gap-0.5 ml-auto flex-shrink-0",children:[((R=t.metadataSummary)==null?void 0:R.description)&&f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx("span",{className:"p-1 text-muted-foreground hover:text-foreground cursor-default","aria-label":"Model information",children:f.jsx(FP,{className:"h-4 w-4"})})}),f.jsx(Sr,{side:"top",align:"end",className:"max-w-xs break-words",children:f.jsx("p",{children:t.metadataSummary.description})})]})}),f.jsx(Dn,{tooltipText:"Move to Top",onClick:()=>r(e),disabled:a||n,icon:f.jsx(Epe,{}),className:"h-6 w-6"}),f.jsx(Dn,{tooltipText:"Move Up",onClick:()=>s(e),disabled:a||n,icon:f.jsx(lpe,{}),className:"h-6 w-6"}),f.jsx(Dn,{tooltipText:"Move Down",onClick:()=>i(e),disabled:o||n,icon:f.jsx(oH,{}),className:"h-6 w-6"})]})]})},uct=({setGlobalModelSortOrderFromModule:e})=>{const{dbProviderConfigs:t,globalModelSortOrder:n,isLoading:r,getAvailableModelListItems:s}=Nr(yn(I=>({dbProviderConfigs:I.dbProviderConfigs,globalModelSortOrder:I.globalModelSortOrder,isLoading:I.isLoading,getAvailableModelListItems:I.getAvailableModelListItems}))),[i,a]=T.useState(""),[o,l]=T.useState(!1),[c,u]=T.useState(()=>new Set(t.map(I=>I.id))),[d,h]=T.useState({reasoning:!1,webSearch:!1,tools:!1,multimodal:!1});T.useEffect(()=>{u(new Set(t.map(I=>I.id)))},[t]);const m=T.useMemo(()=>{const I=s(),P=new Map(I.map(Z=>[Z.id,Z])),L=new Set;t.forEach(Z=>{Z.isEnabled&&Z.enabledModels&&Z.enabledModels.forEach(U=>{L.add(yx(Z.id,U))})});const O=I.filter(Z=>L.has(Z.id)),V=[],D=new Set;return n.forEach(Z=>{if(L.has(Z)){const U=P.get(Z);U&&!D.has(Z)&&(V.push(U),D.add(Z))}}),O.forEach(Z=>{D.has(Z.id)||V.push(Z)}),V},[t,n,s]),y=T.useMemo(()=>{let I=m;if(c.size!==t.length&&(I=I.filter(L=>c.has(L.providerId))),i.trim()){const L=i.toLowerCase();I=I.filter(O=>O.name.toLowerCase().includes(L)||O.providerName.toLowerCase().includes(L)||O.id.toLowerCase().includes(L))}const P=Object.entries(d).filter(([,L])=>L).map(([L])=>L);return P.length>0&&(I=I.filter(L=>{var D,Z;const O=new Set(((D=L.metadataSummary)==null?void 0:D.supported_parameters)??[]),V=new Set(((Z=L.metadataSummary)==null?void 0:Z.input_modalities)??[]);return P.every(U=>{switch(U){case"reasoning":return O.has("reasoning");case"webSearch":return O.has("web_search")||O.has("web_search_options");case"tools":return O.has("tools");case"multimodal":return Array.from(V).some(H=>H!=="text");default:return!0}})})),I},[m,i,c,t.length,d]),b=i.trim().length>0||c.size!==t.length||Object.values(d).some(Boolean),v=T.useMemo(()=>y.map(I=>I.id),[y]),x=T.useCallback(I=>{const{active:P,over:L}=I;if(L&&P.id!==L.id){const O=m.map(H=>H.id),V=P.id,D=L.id,Z=O.indexOf(V),U=O.indexOf(D);if(Z!==-1&&U!==-1){const H=Lx(O,Z,U);e(H)}else console.warn("DND: Could not find dragged items in the full model order. This might happen if the underlying list changed during drag or items are filtered out.")}},[m,e]),w=T.useCallback((I,P)=>{if(b)return;const L=m.map(D=>D.id),O=L.indexOf(I);if(O===-1)return;let V;if(P==="top"){if(O===0)return;const D=L.splice(O,1)[0];L.unshift(D),V=L}else if(P==="up"){if(O===0)return;V=Lx(L,O,O-1)}else{if(O===L.length-1)return;V=Lx(L,O,O+1)}e(V)},[m,e,b]),S=Dot(kW(aF),kW(sF,{coordinateGetter:oct})),C=T.useCallback((I,P)=>{u(L=>{const O=new Set(L);return P?O.add(I):O.delete(I),O})},[]),k=I=>{h(P=>({...P,[I]:!P[I]}))},A=c.size!==t.length?1:0,R=Object.values(d).filter(Boolean).length,N=A+R;return r?f.jsxs("div",{className:"space-y-4 border border-border rounded-lg p-4 bg-card shadow-sm",children:[f.jsx(Wr,{className:"h-8 w-1/3"}),f.jsx(Wr,{className:"h-6 w-1/2"}),f.jsx(Wr,{className:"h-64 w-full"})]}):f.jsxs("div",{className:"space-y-4 border border-border rounded-lg p-4 bg-card shadow-sm",children:[f.jsx("h3",{className:"text-lg font-semibold text-card-foreground",children:"Global Model Order"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Drag and drop the globally enabled models to define their display order. Filtering affects the view below. Move buttons (up/down/top) are disabled when filters are active."}),f.jsx(Xd,{}),f.jsxs("div",{className:"space-y-3",children:[f.jsx(It,{className:"text-base font-medium text-card-foreground",children:"Enabled & Ordered Models"}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsxs("div",{className:"relative flex-grow",children:[f.jsx(Fa,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),f.jsx(_n,{type:"search",placeholder:"Filter models by name or provider...",value:i,onChange:I=>a(I.target.value),className:"pl-8 w-full h-9",disabled:r})]}),f.jsxs(vl,{open:o,onOpenChange:l,children:[f.jsx(xl,{asChild:!0,children:f.jsxs(ft,{variant:"outline",size:"sm",className:"h-9 px-3 relative",disabled:r||t.length===0,children:[f.jsx(PP,{className:"h-4 w-4 mr-1"}),"Filters",N>0&&f.jsx("span",{className:"absolute -top-1 -right-1 inline-flex items-center justify-center px-1.5 py-0.5 text-xs font-semibold leading-none text-white bg-primary rounded-full",children:N})]})}),f.jsx(wl,{className:"w-64 p-0",children:f.jsxs("div",{className:"p-2 space-y-3",children:[f.jsxs("div",{children:[f.jsx(It,{className:"text-xs px-2 font-semibold block mb-1",children:"Providers"}),f.jsx(Lo,{className:"h-32 border rounded-md p-1",children:t.map(I=>f.jsxs("div",{className:"flex items-center space-x-2 p-1.5 rounded hover:bg-muted",children:[f.jsx(Xl,{id:`organizer-provider-filter-${I.id}`,checked:c.has(I.id),onCheckedChange:P=>C(I.id,!!P)}),f.jsxs(It,{htmlFor:`organizer-provider-filter-${I.id}`,className:"text-sm font-normal cursor-pointer",children:[I.name," (",I.type,")"]})]},I.id))})]}),f.jsxs("div",{children:[f.jsx(It,{className:"text-xs px-2 font-semibold block mb-1",children:"Capabilities"}),f.jsxs("div",{className:"flex flex-wrap gap-1 p-1 border rounded-md",children:[f.jsx(Dn,{tooltipText:"Reasoning",icon:f.jsx(Fh,{}),onClick:()=>k("reasoning"),variant:d.reasoning?"secondary":"outline",className:Ze("h-7 w-auto px-2 text-xs",d.reasoning&&"text-primary"),children:"Reasoning"}),f.jsx(Dn,{tooltipText:"Web Search",icon:f.jsx(Fa,{}),onClick:()=>k("webSearch"),variant:d.webSearch?"secondary":"outline",className:Ze("h-7 w-auto px-2 text-xs",d.webSearch&&"text-primary"),children:"Web"}),f.jsx(Dn,{tooltipText:"Tools",icon:f.jsx(ym,{}),onClick:()=>k("tools"),variant:d.tools?"secondary":"outline",className:Ze("h-7 w-auto px-2 text-xs",d.tools&&"text-primary"),children:"Tools"}),f.jsx(Dn,{tooltipText:"Multimodal",icon:f.jsx(mm,{}),onClick:()=>k("multimodal"),variant:d.multimodal?"secondary":"outline",className:Ze("h-7 w-auto px-2 text-xs",d.multimodal&&"text-primary"),children:"Multimodal"})]})]})]})})]})]}),f.jsx(Lo,{className:"h-[calc(20*2.75rem+2px)] w-full rounded-md border border-border p-3 bg-background/50",children:y.length>0?f.jsx(Llt,{sensors:S,collisionDetection:Lot,onDragEnd:x,children:f.jsx(Xlt,{items:v,strategy:Ylt,children:y.map(I=>f.jsx(cct,{id:I.id,modelDetails:I,onMoveToTop:()=>w(I.id,"top"),onMoveUp:()=>w(I.id,"up"),onMoveDown:()=>w(I.id,"down"),isFirst:m.findIndex(P=>P.id===I.id)===0,isLast:m.findIndex(P=>P.id===I.id)===m.length-1,buttonsDisabled:b},I.id))})}):f.jsx("div",{className:"flex items-center justify-center h-full text-sm text-muted-foreground",children:b?"No models match your filters.":"No models enabled globally. Enable models within provider configurations."})})]})]})},w2=e=>{if(!e)return"N/A";const t=parseFloat(e);return isNaN(t)?"N/A":`$${(t/1e3).toFixed(4)} / 1K tokens`},Ll=(e,t,n=!1,r="secondary")=>t==null||String(t).trim()===""?null:f.jsxs(Es,{children:[f.jsx(On,{className:"font-medium text-xs w-1/3 py-1.5 px-3",children:e}),f.jsx(On,{className:"text-xs py-1.5 px-3 break-all",children:n?f.jsx(is,{variant:r,className:"text-xs",children:String(t)}):Array.isArray(t)?f.jsx("div",{className:"flex flex-wrap gap-1",children:t.map((s,i)=>f.jsx(is,{variant:"outline",className:"text-xs",children:String(s)},i))}):String(t)})]}),dct=({modelId:e})=>{var m,y,b,v,x,w,S,C,k,A,R,N;const{createAiModelConfig:t,dbProviderConfigs:n,dbApiKeys:r,updateProviderConfig:s,isLoading:i}=Nr(yn(I=>({createAiModelConfig:I.createAiModelConfig,dbProviderConfigs:I.dbProviderConfigs,dbApiKeys:I.dbApiKeys,updateProviderConfig:I.updateProviderConfig,isLoading:I.isLoading}))),a=T.useMemo(()=>{if(!e)return;const{providerId:I,modelId:P}=Cc(e);if(!I||!P)return;const L=n.find(V=>V.id===I);if(!L)return;const O=r.find(V=>V.id===L.apiKeyId);return t(L,P,O==null?void 0:O.value)},[e,n,r,t]),o=a==null?void 0:a.metadata,l=T.useCallback(async()=>{if(!a||!e)return;const{providerId:I,modelId:P}=Cc(e);if(!I||!P)return;const L=n.find(Z=>Z.id===I);if(!L){je.error("Provider configuration not found.");return}const O=new Set(L.enabledModels??[]),V=O.has(P);V?O.delete(P):O.add(P);const D=Array.from(O);try{await s(L.id,{enabledModels:D}),je.success(`Model "${a.name}" ${V?"disabled":"enabled"}.`)}catch{je.error("Failed to update model status.")}},[a,e,n,s]);if(i)return f.jsxs("div",{className:"space-y-4 p-1 h-full flex flex-col",children:[f.jsx(Wr,{className:"h-8 w-3/4 flex-shrink-0"}),f.jsx(Wr,{className:"h-4 w-1/2 flex-shrink-0"}),f.jsxs("div",{className:"flex-grow space-y-2",children:[f.jsx(Wr,{className:"h-10 w-full"}),f.jsx(Wr,{className:"h-10 w-full"}),f.jsx(Wr,{className:"h-10 w-full"}),f.jsx(Wr,{className:"h-10 w-full"})]})]});if(!e)return f.jsxs("div",{className:"p-4 text-center text-muted-foreground h-full flex flex-col items-center justify-center",children:[f.jsx(Rc,{className:"mx-auto h-10 w-10 mb-2 text-amber-500"}),f.jsx("p",{className:"text-sm",children:'No model selected. Click a model in the "Configuration" or "Browse Models" tab to view its details.'})]});if(!a||!o)return f.jsxs("div",{className:"p-4 text-center text-destructive h-full flex flex-col items-center justify-center",children:[f.jsx(Rc,{className:"mx-auto h-10 w-10 mb-2"}),f.jsxs("p",{className:"text-sm",children:["Details not available for model: ",e,". It might be misconfigured or no longer available."]})]});const{providerId:c,modelId:u}=Cc(e),d=n.find(I=>I.id===c),h=u!=null&&(d==null?void 0:d.isEnabled)&&((m=d==null?void 0:d.enabledModels)==null?void 0:m.includes(u))===!0;return f.jsxs("div",{className:"space-y-4 p-1 h-full flex flex-col",children:[f.jsxs("div",{className:"flex items-center justify-between flex-shrink-0",children:[f.jsxs("h4",{className:"text-lg font-semibold text-card-foreground truncate",children:[a.name,f.jsxs("span",{className:"text-sm text-muted-foreground ml-2",children:["(",a.providerName,")"]})]}),f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(It,{htmlFor:`enable-details-${u}`,className:"text-xs",children:h?"Enabled":"Disabled"}),f.jsx(Io,{id:`enable-details-${u}`,checked:h,onCheckedChange:l,disabled:!(d!=null&&d.isEnabled),"aria-label":`Enable model ${a.name}`})]})]}),o.description&&f.jsx("p",{className:"text-xs text-muted-foreground flex-shrink-0",children:o.description}),f.jsx(Lo,{className:"flex-grow border rounded-md bg-background/30",children:f.jsxs(lf,{children:[f.jsxs(ntt,{className:"py-2 text-xs",children:["Model ID: ",o.id]}),f.jsxs(cf,{children:[Ll("Context Length",((y=o.top_provider)==null?void 0:y.context_length)??o.context_length),Ll("Max Completion Tokens",(b=o.top_provider)==null?void 0:b.max_completion_tokens),Ll("Input Modalities",(v=o.architecture)==null?void 0:v.input_modalities),Ll("Output Modalities",(x=o.architecture)==null?void 0:x.output_modalities),Ll("Tokenizer",(w=o.architecture)==null?void 0:w.tokenizer,!0),Ll("Instruct Type",(S=o.architecture)==null?void 0:S.instruct_type,!0),Ll("Pricing (Prompt)",w2((C=o.pricing)==null?void 0:C.prompt)),Ll("Pricing (Completion)",w2((k=o.pricing)==null?void 0:k.completion)),Ll("Pricing (Image)",w2((A=o.pricing)==null?void 0:A.image)),Ll("Pricing (Request)",w2((R=o.pricing)==null?void 0:R.request)),Ll("Supported Parameters",o.supported_parameters),Ll("Moderated",(N=o.top_provider)!=null&&N.is_moderated?f.jsx(uE,{className:"h-4 w-4 text-green-500"}):"No")]})]})})]})},fct=()=>{const{apiKeys:e,addApiKey:t,deleteApiKey:n,isLoading:r}=Nr(yn(h=>({apiKeys:h.dbApiKeys,addApiKey:h.addApiKey,deleteApiKey:h.deleteApiKey,isLoading:h.isLoading}))),[s,i]=T.useState(!1),[a,o]=T.useState(!1),[l,c]=T.useState({}),u=T.useCallback(async(h,m,y)=>{o(!0);try{await t(h,m,y),i(!1)}catch(b){console.error("Failed to add API key (from component):",b)}finally{o(!1)}},[t]),d=T.useCallback(async(h,m)=>{if(window.confirm(`Are you sure you want to delete the API key "${m}"? This will unlink it from any providers using it.`)){c(y=>({...y,[h]:!0}));try{await n(h)}catch(y){console.error("Failed to delete API key (from component):",y)}finally{c(y=>({...y,[h]:!1}))}}},[n]);return f.jsxs("div",{className:"space-y-6 p-1",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"text-lg font-medium",children:"API Key Management"}),f.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Manage API keys for different providers. Keys are stored securely in your browser's local storage and never sent to any server other than the intended AI provider."})]}),!s&&f.jsxs(ft,{onClick:()=>i(!0),variant:"outline",className:"w-full mb-4",disabled:r,children:[f.jsx(Ru,{className:"h-4 w-4 mr-1"})," Add New API Key"]}),s&&f.jsxs("div",{className:"border rounded-md p-4 space-y-3 bg-card shadow-md mb-4",children:[f.jsx("h4",{className:"font-semibold text-card-foreground",children:"Add New Key"}),f.jsx(Soe,{onSave:u,onCancel:()=>i(!1),disabled:a})]}),f.jsxs("div",{children:[f.jsx("h4",{className:"text-md font-medium mb-2",children:"Stored API Keys"}),r&&!s?f.jsxs("div",{className:"space-y-2",children:[f.jsx(Wr,{className:"h-10 w-full"}),f.jsx(Wr,{className:"h-10 w-full"})]}):(e||[]).length===0&&!s?f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No API keys stored yet."}):f.jsx("div",{className:"border rounded-md overflow-hidden",children:f.jsxs(lf,{children:[f.jsx(fp,{children:f.jsxs(Es,{children:[f.jsx(Tr,{children:"Name"}),f.jsx(Tr,{children:"Provider Type"}),f.jsx(Tr,{children:"Created"}),f.jsx(Tr,{className:"text-right",children:"Actions"})]})}),f.jsx(cf,{children:(e||[]).map(h=>{const m=l[h.id];return f.jsxs(Es,{className:m?"opacity-50":"",children:[f.jsx(On,{className:"font-medium",children:h.name||"Unnamed Key"}),f.jsx(On,{children:h.providerId||"Unknown"}),f.jsx(On,{className:"text-xs text-muted-foreground",children:gw(new Date(h.createdAt),"PPp")}),f.jsx(On,{className:"text-right",children:f.jsx(Dn,{tooltipText:"Delete Key",onClick:()=>d(h.id,h.name||"Unnamed Key"),disabled:m,"aria-label":`Delete key ${h.name||"Unnamed Key"}`,icon:m?f.jsx(Qn,{className:"h-4 w-4 animate-spin"}):f.jsx(Ao,{}),className:"text-destructive hover:text-destructive/80 h-8 w-8"})})]},h.id)})})]})})]})]})},hct=We.memo(fct),pct=({onSelectModelForDetails:e})=>{const[t,n]=T.useState(null),[r,s]=T.useState(null),i=T.useCallback(P=>{if(P){n(P);const L=P.querySelector("[data-radix-scroll-area-viewport]");if(L)s(L);else{const O=new MutationObserver(()=>{const V=P.querySelector("[data-radix-scroll-area-viewport]");V&&(s(V),O.disconnect())});return O.observe(P,{childList:!0,subtree:!0}),()=>O.disconnect()}}else n(null),s(null)},[]),{getAvailableModelListItems:a,isLoading:o,dbProviderConfigs:l}=Nr(yn(P=>({getAvailableModelListItems:P.getAvailableModelListItems,isLoading:P.isLoading,dbProviderConfigs:P.dbProviderConfigs}))),[c,u]=T.useState(""),[d,h]=T.useState(!1),[m,y]=T.useState(()=>new Set(l.map(P=>P.id))),[b,v]=T.useState({reasoning:!1,webSearch:!1,tools:!1,multimodal:!1}),x=T.useMemo(()=>a(),[a]);T.useEffect(()=>{y(new Set(l.map(P=>P.id)))},[l]);const w=T.useMemo(()=>{let P=x;if(m.size!==l.length&&(P=P.filter(O=>m.has(O.providerId))),c.trim()){const O=c.toLowerCase();P=P.filter(V=>V.name.toLowerCase().includes(O)||V.providerName.toLowerCase().includes(O)||V.id.toLowerCase().includes(O))}const L=Object.entries(b).filter(([,O])=>O).map(([O])=>O);return L.length>0&&(P=P.filter(O=>{var Z,U;const V=new Set(((Z=O.metadataSummary)==null?void 0:Z.supported_parameters)??[]),D=new Set(((U=O.metadataSummary)==null?void 0:U.input_modalities)??[]);return L.every(H=>{switch(H){case"reasoning":return V.has("reasoning");case"webSearch":return V.has("web_search")||V.has("web_search_options");case"tools":return V.has("tools");case"multimodal":return Array.from(D).some($=>$!=="text");default:return!0}})})),P.sort((O,V)=>{const D=O.providerName.localeCompare(V.providerName);return D!==0?D:O.name.localeCompare(V.name)})},[x,c,m,l.length,b]),S=T5({count:w.length,getScrollElement:()=>r,estimateSize:()=>48,overscan:10}),C=T.useCallback((P,L)=>{y(O=>{const V=new Set(O);return L?V.add(P):V.delete(P),V})},[]),k=P=>{v(L=>({...L,[P]:!L[P]}))},A=P=>{e(P)},R=m.size!==l.length?1:0,N=Object.values(b).filter(Boolean).length,I=R+N;return o?f.jsxs("div",{className:"space-y-2 h-full flex flex-col",children:[f.jsx(Wr,{className:"h-9 w-full flex-shrink-0"}),f.jsx(Wr,{className:"h-full w-full flex-grow"})]}):f.jsxs("div",{className:"space-y-3 h-full flex flex-col",children:[f.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[f.jsxs("div",{className:"relative flex-grow",children:[f.jsx(Fa,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),f.jsx(_n,{type:"search",placeholder:"Filter models by name or provider...",value:c,onChange:P=>u(P.target.value),className:"pl-8 w-full h-9",disabled:o})]}),f.jsxs(vl,{open:d,onOpenChange:h,children:[f.jsx(xl,{asChild:!0,children:f.jsxs(ft,{variant:"outline",size:"sm",className:"h-9 px-3 relative",disabled:o||l.length===0,children:[f.jsx(PP,{className:"h-4 w-4 mr-1"}),"Filters",I>0&&f.jsx("span",{className:"absolute -top-1 -right-1 inline-flex items-center justify-center px-1.5 py-0.5 text-xs font-semibold leading-none text-white bg-primary rounded-full",children:I})]})}),f.jsx(wl,{className:"w-64 p-0",children:f.jsxs("div",{className:"p-2 space-y-3",children:[f.jsxs("div",{children:[f.jsx(It,{className:"text-xs px-2 font-semibold block mb-1",children:"Providers"}),f.jsx(Lo,{className:"h-32 border rounded-md p-1",children:l.map(P=>f.jsxs("div",{className:"flex items-center space-x-2 p-1.5 rounded hover:bg-muted",children:[f.jsx(Xl,{id:`model-browser-provider-filter-${P.id}`,checked:m.has(P.id),onCheckedChange:L=>C(P.id,!!L)}),f.jsxs(It,{htmlFor:`model-browser-provider-filter-${P.id}`,className:"text-sm font-normal cursor-pointer",children:[P.name," (",P.type,")"]})]},P.id))})]}),f.jsxs("div",{children:[f.jsx(It,{className:"text-xs px-2 font-semibold block mb-1",children:"Capabilities"}),f.jsxs("div",{className:"flex flex-wrap gap-1 p-1 border rounded-md",children:[f.jsx(Dn,{tooltipText:"Reasoning",icon:f.jsx(Fh,{}),onClick:()=>k("reasoning"),variant:b.reasoning?"secondary":"outline",className:Ze("h-7 w-auto px-2 text-xs",b.reasoning&&"text-primary"),children:"Reasoning"}),f.jsx(Dn,{tooltipText:"Web Search",icon:f.jsx(Fa,{}),onClick:()=>k("webSearch"),variant:b.webSearch?"secondary":"outline",className:Ze("h-7 w-auto px-2 text-xs",b.webSearch&&"text-primary"),children:"Web"}),f.jsx(Dn,{tooltipText:"Tools",icon:f.jsx(ym,{}),onClick:()=>k("tools"),variant:b.tools?"secondary":"outline",className:Ze("h-7 w-auto px-2 text-xs",b.tools&&"text-primary"),children:"Tools"}),f.jsx(Dn,{tooltipText:"Multimodal",icon:f.jsx(mm,{}),onClick:()=>k("multimodal"),variant:b.multimodal?"secondary":"outline",className:Ze("h-7 w-auto px-2 text-xs",b.multimodal&&"text-primary"),children:"Multimodal"})]})]})]})})]})]}),f.jsxs(Lo,{className:"flex-grow border rounded-md bg-background/50 h-[calc(15*2.5rem+2px)]",ref:i,children:[r&&f.jsx("div",{style:{height:`${S.getTotalSize()}px`,width:"100%",position:"relative"},children:w.length===0&&!o?f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4 absolute inset-0 flex items-center justify-center",children:"No models match your filters."}):S.getVirtualItems().map(P=>{var O;const L=w[P.index];return L?f.jsx("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:`${P.size}px`,transform:`translateY(${P.start}px)`},className:"p-1",children:f.jsx(xr,{delayDuration:300,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsxs("button",{className:"w-full text-left p-1.5 rounded hover:bg-muted/50 flex flex-col",onClick:()=>A(L.id),children:[f.jsx("span",{className:"text-sm font-medium truncate",children:L.name}),f.jsx("span",{className:"text-xs text-muted-foreground truncate",children:L.providerName})]})}),((O=L.metadataSummary)==null?void 0:O.description)&&f.jsx(Sr,{side:"bottom",align:"start",className:"max-w-xs",children:f.jsx("p",{children:L.metadataSummary.description})})]})})},L.id):null})}),!r&&!o&&f.jsx("div",{className:"flex items-center justify-center h-full text-muted-foreground",children:"Initializing list..."})]})]})},mct=({onSelectModelForDetails:e})=>{const{addDbProviderConfig:t,updateDbProviderConfig:n,deleteDbProviderConfig:r,fetchModels:s,providerFetchStatus:i,dbProviderConfigs:a,apiKeys:o,isLoading:l}=Nr(yn(b=>({addDbProviderConfig:b.addProviderConfig,updateDbProviderConfig:b.updateProviderConfig,deleteDbProviderConfig:b.deleteProviderConfig,fetchModels:b.fetchModels,providerFetchStatus:b.providerFetchStatus,dbProviderConfigs:b.dbProviderConfigs,apiKeys:b.dbApiKeys,isLoading:b.isLoading}))),[c,u]=T.useState(!1),d=()=>u(!0),h=T.useCallback(()=>u(!1),[]),m=T.useCallback(async b=>{await s(b)},[s]),y=T.useMemo(()=>a||[],[a]);return f.jsxs("div",{className:"space-y-6 h-full flex flex-col",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"text-lg font-semibold text-card-foreground",children:"Provider Configuration"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Add, remove, or configure connections to AI providers. Enable models within each provider's edit section. Click a model name to view its details."})]}),f.jsx("div",{className:"flex-shrink-0",children:c?f.jsx(Moe,{apiKeys:o||[],onAddProvider:t,onCancel:h}):f.jsxs(ft,{onClick:d,variant:"outline",className:"w-full",disabled:l,children:[f.jsx(Ru,{className:"h-4 w-4 mr-1"})," Add Provider Configuration"]})}),f.jsx("div",{className:"flex-grow border-t border-border pt-4 mt-4 overflow-y-auto",children:f.jsxs("div",{className:"space-y-2",children:[l&&!c?f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:[f.jsx(Wr,{className:"h-24 w-full"}),f.jsx(Wr,{className:"h-24 w-full"}),f.jsx(Wr,{className:"h-24 w-full"})]}):f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:y.map(b=>f.jsx(wot,{provider:b,apiKeys:o||[],onUpdate:n,onDelete:r,onFetchModels:m,fetchStatus:i[b.id]||"idle",onSelectModelForDetails:e},b.id))}),!l&&y.length===0&&!c&&f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:'No providers configured yet. Click "Add Provider Configuration" above.'})]})})]})},gct=({setGlobalModelSortOrderFromModule:e})=>{const{selectedModelForDetails:t,setSelectedModelForDetails:n}=Nr(yn(o=>({selectedModelForDetails:o._selectedModelForDetails,setSelectedModelForDetails:o.setSelectedModelForDetails}))),[r,s]=T.useState("providers-config"),i=T.useCallback(o=>{n(o),o&&s("providers-details-current")},[n,s]),a=T.useMemo(()=>[{value:"providers-config",label:"Configuration",content:f.jsx(mct,{onSelectModelForDetails:i})},{value:"providers-order",label:"Model Order",content:f.jsx(uct,{setGlobalModelSortOrderFromModule:e})},{value:"api-keys",label:"API Keys",content:f.jsx(hct,{})},{value:"providers-details-current",label:"Selected Model",content:f.jsx(dct,{modelId:t})},{value:"providers-browse-all",label:"Browse Models",content:f.jsx(pct,{onSelectModelForDetails:i})}],[t,i,e]);return f.jsx(sc,{tabs:a,initialValue:r,onValueChange:s,className:"h-full",listClassName:"bg-muted/50 rounded-md",contentContainerClassName:"mt-4"})},yct=We.memo(gct);class bct{constructor(){me(this,"id","core-provider-settings");me(this,"modApiRef",null);me(this,"eventUnsubscribers",[]);me(this,"setGlobalModelSortOrderFromModule",t=>{var n;(n=this.modApiRef)==null||n.emit(dr.setGlobalModelSortOrderRequest,{ids:t})})}async initialize(t){this.modApiRef=t}register(t){this.modApiRef=t,t.registerSettingsTab({id:"providers",title:"Providers & Models",order:20,component:()=>We.createElement(yct,{setGlobalModelSortOrderFromModule:this.setGlobalModelSortOrderFromModule})})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.modApiRef=null}}const vct=Ke({globalSystemPrompt:$e()});function xct({field:e}){return f.jsx(f.Fragment,{children:e.state.meta.isTouched&&e.state.meta.errors.length>0?f.jsx("em",{className:"text-xs text-destructive mt-1 block",children:e.state.meta.errors.join(", ")}):null})}const wct=()=>{const{globalSystemPrompt:e,setGlobalSystemPrompt:t}=yr(yn(r=>({globalSystemPrompt:r.globalSystemPrompt,setGlobalSystemPrompt:r.setGlobalSystemPrompt}))),n=ri({defaultValues:{globalSystemPrompt:e??""},validators:{onChangeAsync:vct,onChangeAsyncDebounceMs:500},onSubmit:async({value:r})=>{try{t(r.globalSystemPrompt),je.success("Global system prompt updated!")}catch(s){je.error("Failed to update prompt. Please try again."),console.error("Error submitting assistant prompt form:",s)}}});return T.useEffect(()=>{n.state.values.globalSystemPrompt!==(e??"")&&n.reset({globalSystemPrompt:e??""})},[e,n]),f.jsxs("form",{onSubmit:r=>{r.preventDefault(),r.stopPropagation(),n.handleSubmit()},className:"space-y-3",children:[f.jsx("div",{children:f.jsx(n.Field,{name:"globalSystemPrompt",children:r=>f.jsxs(f.Fragment,{children:[f.jsx(It,{htmlFor:r.name,className:"text-sm mb-1 block",children:"Global System Prompt"}),f.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"Default instructions for the assistant. Can be overridden per-project."}),f.jsx(Bo,{id:r.name,placeholder:"Enter default system instructions for the assistant...",value:r.state.value,onBlur:r.handleBlur,onChange:s=>r.handleChange(s.target.value),rows:6,className:r.state.meta.errors.length?"border-destructive":""}),f.jsx(xct,{field:r})]})})}),f.jsx("div",{className:"flex justify-end pt-2",children:f.jsx(n.Subscribe,{selector:r=>[r.canSubmit,r.isSubmitting,r.isValidating,r.isValid],children:([r,s,i,a])=>f.jsx(ft,{type:"submit",size:"sm",disabled:!r||s||i||!a,children:s?"Saving...":i?"Validating...":"Save Prompt"})})})]})},_ct=Ke({temperature:Tt().min(0).max(1),topP:Tt().min(0).max(1),maxTokens:Tt().min(1).nullable(),topK:Tt().min(1).nullable(),presencePenalty:Tt().min(-2).max(2),frequencyPenalty:Tt().min(-2).max(2)}),Sct=()=>{const e=yr(yn(n=>({temperature:n.temperature,setTemperature:n.setTemperature,topP:n.topP,setTopP:n.setTopP,maxTokens:n.maxTokens,setMaxTokens:n.setMaxTokens,topK:n.topK,setTopK:n.setTopK,presencePenalty:n.presencePenalty,setPresencePenalty:n.setPresencePenalty,frequencyPenalty:n.frequencyPenalty,setFrequencyPenalty:n.setFrequencyPenalty}))),t=ri({defaultValues:{temperature:e.temperature??.7,topP:e.topP??1,maxTokens:e.maxTokens??null,topK:e.topK??null,presencePenalty:e.presencePenalty??0,frequencyPenalty:e.frequencyPenalty??0},validators:{onChangeAsync:_ct,onChangeAsyncDebounceMs:500},onSubmit:async({value:n})=>{try{e.setTemperature(n.temperature),e.setTopP(n.topP),e.setMaxTokens(n.maxTokens??null),e.setTopK(n.topK??null),e.setPresencePenalty(n.presencePenalty),e.setFrequencyPenalty(n.frequencyPenalty),je.success("Assistant parameters updated!")}catch(r){je.error("Failed to update parameters."),console.error("Error submitting parameters form:",r)}}});return T.useEffect(()=>{t.reset({temperature:e.temperature??.7,topP:e.topP??1,maxTokens:e.maxTokens??null,topK:e.topK??null,presencePenalty:e.presencePenalty??0,frequencyPenalty:e.frequencyPenalty??0})},[e.temperature,e.topP,e.maxTokens,e.topK,e.presencePenalty,e.frequencyPenalty,t]),f.jsxs("form",{onSubmit:n=>{n.preventDefault(),n.stopPropagation(),t.handleSubmit()},className:"space-y-4",children:[f.jsx("p",{className:"text-xs text-muted-foreground mb-3",children:"Set the default global values for AI parameters. These can be overridden per-project or per-prompt turn."}),f.jsx(wc,{form:t,name:"temperature",label:"Temperature",min:0,max:1,step:.01,valueDisplayPrecision:2,wrapperClassName:"space-y-1.5"}),f.jsx(wc,{form:t,name:"topP",label:"Top P",min:0,max:1,step:.01,valueDisplayPrecision:2,wrapperClassName:"space-y-1.5"}),f.jsxs("div",{className:"grid grid-cols-2 gap-4 items-end",children:[f.jsx(Iy,{form:t,name:"maxTokens",label:"Max Tokens",placeholder:"Default (None)",min:1,className:"h-9 text-sm",allowNull:!0,wrapperClassName:"space-y-1.5"}),f.jsx(Iy,{form:t,name:"topK",label:"Top K",placeholder:"Default (None)",min:1,className:"h-9 text-sm",allowNull:!0,wrapperClassName:"space-y-1.5"})]}),f.jsx(wc,{form:t,name:"presencePenalty",label:"Presence Penalty",min:-2,max:2,step:.01,valueDisplayPrecision:2,wrapperClassName:"space-y-1.5"}),f.jsx(wc,{form:t,name:"frequencyPenalty",label:"Frequency Penalty",min:-2,max:2,step:.01,valueDisplayPrecision:2,wrapperClassName:"space-y-1.5"}),f.jsxs("div",{className:"flex justify-end space-x-2",children:[f.jsx(ft,{type:"button",variant:"ghost",onClick:()=>t.reset(),disabled:!t.state.isDirty,children:"Reset"}),f.jsx(t.Subscribe,{selector:n=>[n.canSubmit,n.isSubmitting],children:([n,r])=>f.jsx(ft,{type:"submit",disabled:!n||r,children:r?"Saving...":"Save Changes"})})]})]})},Cct=Ke({toolMaxSteps:Tt({required_error:"Max steps is required",invalid_type_error:"Max steps must be a number"}).min(1,"Must be at least 1").max(20,"Cannot exceed 20")});function kct({field:e}){return f.jsx(f.Fragment,{children:e.state.meta.isTouched&&e.state.meta.errors.length>0?f.jsx("em",{className:"text-xs text-destructive mt-1 block",children:e.state.meta.errors.join(", ")}):null})}const Ect=()=>{const{toolMaxSteps:e,setToolMaxSteps:t}=yr(yn(r=>({toolMaxSteps:r.toolMaxSteps,setToolMaxSteps:r.setToolMaxSteps}))),n=ri({defaultValues:{toolMaxSteps:e??5},validators:{onChangeAsync:Cct,onChangeAsyncDebounceMs:500},onSubmit:async({value:r})=>{try{t(r.toolMaxSteps),je.success("Tool settings updated!")}catch(s){je.error("Failed to update tool settings."),console.error("Error submitting tool settings form:",s)}}});return T.useEffect(()=>{n.state.values.toolMaxSteps!==(e??5)&&n.reset({toolMaxSteps:e??5})},[e,n]),f.jsxs("form",{onSubmit:r=>{r.preventDefault(),r.stopPropagation(),n.handleSubmit()},className:"space-y-3",children:[f.jsx(n.Field,{name:"toolMaxSteps",children:r=>f.jsxs("div",{children:[f.jsx(It,{htmlFor:r.name,className:"text-sm mb-1 block",children:"Maximum Tool Steps per Turn"}),f.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"Limits the number of sequential tool calls the AI can make before generating a final response (1-20). Higher values allow more complex tasks but increase latency and cost. (Default: 5)"}),f.jsx(_n,{id:r.name,type:"number",min:1,max:20,step:1,value:r.state.value,onBlur:r.handleBlur,onChange:s=>{const i=s.target.valueAsNumber;isNaN(i)?s.target.value===""&&r.handleChange(void 0):r.handleChange(i)},className:`w-24 ${r.state.meta.errors.length?"border-destructive":""}`}),f.jsx(kct,{field:r})]})}),f.jsx("div",{className:"flex justify-end pt-2",children:f.jsx(n.Subscribe,{selector:r=>[r.canSubmit,r.isSubmitting,r.isValidating,r.isValid],children:([r,s,i,a])=>f.jsx(ft,{type:"submit",size:"sm",disabled:!r||s||i||!a,children:s?"Saving...":i?"Validating...":"Save Tool Settings"})})})]})},Tct=Ke({autoTitleEnabled:br(),autoTitleModelId:$e().nullable(),autoTitlePromptMaxLength:Tt().min(100).max(4e3),autoTitleIncludeFiles:br(),autoTitleIncludeRules:br()});function Yv({field:e}){return f.jsx(f.Fragment,{children:e.state.meta.isTouched&&e.state.meta.errors.length>0?f.jsx("em",{className:"text-xs text-destructive mt-1 block",children:e.state.meta.errors.join(", ")}):null})}const Act=()=>{const e=yr(yn(n=>({autoTitleEnabled:n.autoTitleEnabled,setAutoTitleEnabled:n.setAutoTitleEnabled,autoTitleModelId:n.autoTitleModelId,setAutoTitleModelId:n.setAutoTitleModelId,autoTitlePromptMaxLength:n.autoTitlePromptMaxLength,setAutoTitlePromptMaxLength:n.setAutoTitlePromptMaxLength,autoTitleIncludeFiles:n.autoTitleIncludeFiles,setAutoTitleIncludeFiles:n.setAutoTitleIncludeFiles,autoTitleIncludeRules:n.autoTitleIncludeRules,setAutoTitleIncludeRules:n.setAutoTitleIncludeRules}))),t=ri({defaultValues:{autoTitleEnabled:e.autoTitleEnabled??!1,autoTitleModelId:e.autoTitleModelId??null,autoTitlePromptMaxLength:e.autoTitlePromptMaxLength??768,autoTitleIncludeFiles:e.autoTitleIncludeFiles??!1,autoTitleIncludeRules:e.autoTitleIncludeRules??!1},validators:{onChangeAsync:Tct,onChangeAsyncDebounceMs:500},onSubmit:async({value:n})=>{try{e.setAutoTitleEnabled(n.autoTitleEnabled),e.setAutoTitleModelId(n.autoTitleModelId??null),e.setAutoTitlePromptMaxLength(n.autoTitlePromptMaxLength),e.setAutoTitleIncludeFiles(n.autoTitleIncludeFiles),e.setAutoTitleIncludeRules(n.autoTitleIncludeRules),je.success("Auto-title settings updated!")}catch(r){je.error("Failed to update auto-title settings."),console.error("Error submitting auto-title settings form:",r)}}});return T.useEffect(()=>{t.reset({autoTitleEnabled:e.autoTitleEnabled??!1,autoTitleModelId:e.autoTitleModelId??null,autoTitlePromptMaxLength:e.autoTitlePromptMaxLength??768,autoTitleIncludeFiles:e.autoTitleIncludeFiles??!1,autoTitleIncludeRules:e.autoTitleIncludeRules??!1})},[e.autoTitleEnabled,e.autoTitleModelId,e.autoTitlePromptMaxLength,e.autoTitleIncludeFiles,e.autoTitleIncludeRules,t]),f.jsxs("form",{onSubmit:n=>{n.preventDefault(),n.stopPropagation(),t.handleSubmit()},className:"space-y-3",children:[f.jsx(t.Field,{name:"autoTitleEnabled",children:n=>f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(Io,{id:n.name,checked:n.state.value,onCheckedChange:n.handleChange,onBlur:n.handleBlur,"aria-labelledby":`${n.name}-label`}),f.jsx(It,{id:`${n.name}-label`,htmlFor:n.name,children:"Enable Auto-Title Generation"}),f.jsx(Yv,{field:n})]})}),t.state.values.autoTitleEnabled&&f.jsxs("div",{className:"space-y-3 pl-6 border-l-2 border-muted",children:[f.jsx(t.Field,{name:"autoTitleModelId",children:n=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(It,{htmlFor:n.name,children:"Model for Title Generation"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Choose which model to use for generating conversation titles. Uses global default model if not specified."}),f.jsx(Y5,{value:n.state.value,onChange:r=>n.handleChange(r),className:"w-full"}),f.jsx(Yv,{field:n})]})}),f.jsx(t.Field,{name:"autoTitlePromptMaxLength",children:n=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(It,{htmlFor:n.name,children:"Conversation Content Length Limit"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Maximum characters from conversation to include in title generation prompt (100-4000)."}),f.jsx(_n,{id:n.name,type:"number",min:100,max:4e3,step:1,value:n.state.value,onBlur:n.handleBlur,onChange:r=>{const s=r.target.valueAsNumber;isNaN(s)||n.handleChange(s)},className:`w-32 ${n.state.meta.errors.length?"border-destructive":""}`}),f.jsx(Yv,{field:n})]})}),f.jsx(t.Field,{name:"autoTitleIncludeFiles",children:n=>f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(Io,{id:n.name,checked:n.state.value,onCheckedChange:n.handleChange,onBlur:n.handleBlur,"aria-labelledby":`${n.name}-label`}),f.jsx(It,{id:`${n.name}-label`,htmlFor:n.name,children:"Include file context in title prompt"}),f.jsx(Yv,{field:n})]})}),f.jsx(t.Field,{name:"autoTitleIncludeRules",children:n=>f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(Io,{id:n.name,checked:n.state.value,onCheckedChange:n.handleChange,onBlur:n.handleBlur,"aria-labelledby":`${n.name}-label`}),f.jsx(It,{id:`${n.name}-label`,htmlFor:n.name,children:"Include active rules in title prompt"}),f.jsx(Yv,{field:n})]})})]}),f.jsx("div",{className:"flex justify-end pt-2",children:f.jsx(t.Subscribe,{selector:n=>[n.canSubmit,n.isSubmitting,n.isValidating,n.isValid],children:([n,r,s,i])=>f.jsx(ft,{type:"submit",size:"sm",disabled:!n||r||s||!i,children:r?"Saving...":s?"Validating...":"Save Title Settings"})})})]})},Rct=({selectedTools:e,onToolsChange:t,className:n,disabled:r=!1,maxSteps:s,onMaxStepsChange:i,globalDefaultMaxSteps:a=5,showMaxSteps:o=!1})=>{const l=T.useMemo(()=>new Set(e),[e]),c=T.useCallback((d,h)=>{const m=h?[...e,d]:e.filter(y=>y!==d);t(m)},[e,t]),u=T.useCallback((d,h)=>{t(d?h:[])},[t]);return f.jsx(Pue,{enabledTools:l,onToggleTool:c,onToggleAll:u,disabled:r,className:n,maxSteps:s,onMaxStepsChange:i,globalDefaultMaxSteps:a,showMaxSteps:o})},Nct=({variables:e,onVariablesChange:t,templateId:n})=>{const[r,s]=T.useState({name:"",description:"",type:"string",required:!1,default:"",instructions:""});T.useEffect(()=>{s({name:"",description:"",type:"string",required:!1,default:"",instructions:""})},[n]),T.useEffect(()=>()=>{s({name:"",description:"",type:"string",required:!1,default:"",instructions:""})},[]);const i=()=>{r.name&&(t([...e,{...r}]),s({name:"",description:"",type:"string",required:!1,default:"",instructions:""}))},a=o=>{t(e.filter((l,c)=>c!==o))};return f.jsx("div",{className:"space-y-4",children:f.jsxs("div",{children:[f.jsx(It,{className:"text-base font-medium",children:"Variables"}),f.jsxs("div",{className:"space-y-3 mt-2",children:[e.map((o,l)=>f.jsxs("div",{className:"p-3 border rounded-lg space-y-2",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("h4",{className:"font-medium",children:o.name}),f.jsx(ft,{variant:"ghost",size:"sm",onClick:()=>a(l),children:f.jsx(qi,{className:"h-4 w-4"})})]}),f.jsx("p",{className:"text-sm text-muted-foreground",children:o.description}),f.jsxs("div",{className:"flex gap-2 text-xs",children:[f.jsx(is,{variant:o.required?"default":"secondary",children:o.required?"Required":"Optional"}),f.jsx(is,{variant:"outline",children:o.type}),o.default&&f.jsxs(is,{variant:"outline",children:["Default: ",o.default]})]})]},`${o.name}-${l}`)),f.jsxs("div",{className:"p-3 border-2 border-dashed rounded-lg space-y-3",children:[f.jsx(It,{children:"Add New Variable"}),f.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[f.jsxs("div",{children:[f.jsx(It,{children:"Name"}),f.jsx(_n,{value:r.name,onChange:o=>s(l=>({...l,name:o.target.value})),placeholder:"Variable name"})]}),f.jsxs("div",{children:[f.jsx(It,{children:"Type"}),f.jsxs(np,{value:r.type,onValueChange:o=>s(l=>({...l,type:o})),children:[f.jsx(sp,{children:f.jsx(rp,{})}),f.jsxs(ip,{children:[f.jsx(To,{value:"string",children:"String"}),f.jsx(To,{value:"number",children:"Number"}),f.jsx(To,{value:"boolean",children:"Boolean"}),f.jsx(To,{value:"array",children:"Array"})]})]},`new-variable-type-${n||"new"}`)]})]}),f.jsxs("div",{children:[f.jsx(It,{children:"Description"}),f.jsx(_n,{value:r.description,onChange:o=>s(l=>({...l,description:o.target.value})),placeholder:"Describe this variable"})]}),f.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[f.jsxs("div",{children:[f.jsx(It,{children:"Default Value"}),f.jsx(_n,{value:r.default,onChange:o=>s(l=>({...l,default:o.target.value})),placeholder:"Default value (optional)"})]}),f.jsxs("div",{className:"flex items-center space-x-2 pt-6",children:[f.jsx(Xl,{checked:r.required,onCheckedChange:o=>s(l=>({...l,required:!!o}))}),f.jsx(It,{children:"Required"})]})]}),f.jsxs(ft,{type:"button",onClick:i,className:"w-full",children:[f.jsx(Ru,{className:"h-4 w-4 mr-2"}),"Add Variable"]})]})]})]})})},Mct=({selectedFollowUps:e,onFollowUpsChange:t,followUpOptions:n,templateId:r})=>{const[s,i]=T.useState(!1),[a,o]=T.useState(""),l=T.useRef(null),c=n.filter(m=>m.id!==r&&!e.includes(m.id)),u=c.filter(m=>m.name.toLowerCase().includes(a.toLowerCase())||m.description.toLowerCase().includes(a.toLowerCase())),d=m=>{m&&!e.includes(m)&&(t([...e,m]),o(""),i(!1))};T.useEffect(()=>{const m=y=>{l.current&&!l.current.contains(y.target)&&i(!1)};return document.addEventListener("mousedown",m),()=>{document.removeEventListener("mousedown",m)}},[]);const h=m=>{t(e.filter(y=>y!==m))};return f.jsx("div",{className:"space-y-4",children:f.jsxs("div",{children:[f.jsx(It,{className:"text-base font-medium",children:"Follow-up Templates"}),f.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Select templates that can be suggested as follow-ups after this template is used."}),f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{className:"space-y-2",children:[f.jsx(It,{className:"text-sm font-medium",children:"Selected Follow-ups:"}),e.length===0?f.jsx("p",{className:"text-sm text-muted-foreground",children:"No follow-ups selected yet."}):f.jsx("div",{className:"flex flex-wrap gap-2",children:e.map(m=>{const y=n.find(b=>b.id===m);return y?f.jsxs(is,{variant:"secondary",className:"flex items-center gap-1",children:[y.name,f.jsx(ft,{variant:"ghost",size:"sm",className:"h-4 w-4 p-0 hover:bg-destructive hover:text-destructive-foreground",onClick:()=>h(m),children:f.jsx(qi,{className:"h-3 w-3"})})]},m):f.jsxs(is,{variant:"destructive",className:"flex items-center gap-1",children:["Unknown Template (",m,")",f.jsx(ft,{variant:"ghost",size:"sm",className:"h-4 w-4 p-0 hover:bg-destructive hover:text-destructive-foreground",onClick:()=>h(m),children:f.jsx(qi,{className:"h-3 w-3"})})]},m)})})]}),c.length>0&&f.jsxs("div",{className:"relative",ref:l,children:[f.jsx(It,{className:"text-sm",children:"Add Follow-up Template:"}),f.jsxs("div",{className:"relative",children:[f.jsxs("div",{className:"flex h-9 w-full items-center justify-between rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm cursor-pointer hover:bg-accent",onClick:()=>i(!s),children:[f.jsx("span",{className:"text-muted-foreground",children:a||"Select a template to add as follow-up"}),f.jsx(Jl,{className:"h-4 w-4 opacity-50"})]}),s&&f.jsxs("div",{className:"absolute top-full left-0 right-0 z-50 mt-1 max-h-60 overflow-auto rounded-md border bg-popover text-popover-foreground shadow-md",children:[f.jsx("div",{className:"p-2",children:f.jsx(_n,{placeholder:"Search templates...",value:a,onChange:m=>o(m.target.value),className:"h-8"})}),f.jsx("div",{className:"max-h-48 overflow-auto",children:u.length===0?f.jsx("div",{className:"px-2 py-1.5 text-sm text-muted-foreground",children:"No templates found."}):u.map(m=>f.jsxs("div",{className:"relative flex cursor-pointer select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none hover:bg-accent hover:text-accent-foreground",onClick:()=>d(m.id),children:[m.name," - ",m.description]},m.id))})]})]})]}),c.length===0&&e.length===0&&f.jsx("p",{className:"text-sm text-muted-foreground",children:"No templates available for follow-ups. Create more templates first."}),c.length===0&&e.length>0&&f.jsx("p",{className:"text-sm text-muted-foreground",children:"All available templates have been selected as follow-ups."})]})]})})},Ict=()=>{const e=Ke({name:$e().min(1,"Name is required"),description:$e(),variables:on(Ke({name:$e().min(1,"Variable name is required"),description:$e(),type:bl(["string","number","boolean","array"]),required:br(),default:$e().optional(),instructions:$e().optional()})),prompt:$e().min(1,"Prompt content is required"),tags:on($e()),tools:on($e()),rules:on($e()),followUps:on($e())});return async({value:t})=>{try{await e.parseAsync(t)}catch(n){return n instanceof Mc?n.formErrors.fieldErrors:{root:"Validation failed"}}}},E0=({template:e,onSubmit:t,onSuccess:n,type:r,showFollowUps:s=!1,showMaxSteps:i=!1,followUpOptions:a=[],additionalActions:o})=>{const[l,c]=T.useState(null),{rules:u,tags:d,tagRuleLinks:h,loadRulesAndTags:m}=ple(yn(w=>({rules:w.rules,tags:w.tags,tagRuleLinks:w.tagRuleLinks,loadRulesAndTags:w.loadRulesAndTags})));T.useEffect(()=>{m()},[m]);const y=ri({defaultValues:{name:(e==null?void 0:e.name)||"",description:(e==null?void 0:e.description)||"",variables:(e==null?void 0:e.variables)||[],prompt:(e==null?void 0:e.prompt)||"",tags:(e==null?void 0:e.tags)||[],tools:(e==null?void 0:e.tools)||[],rules:(e==null?void 0:e.rules)||[],followUps:(e==null?void 0:e.followUps)||[]},validators:{onChangeAsync:Ict(),onChangeAsyncDebounceMs:500},onSubmit:async({value:w})=>{t(w),n()}}),b=w=>{const S=h.filter(C=>C.tagId===w).map(C=>C.ruleId);return u.filter(C=>S.includes(C.id))},v=()=>{switch(r){case"agent":return"Agent";case"task":return"Task";default:return"Template"}},x=()=>{switch(r){case"agent":return"Agent Prompt";case"task":return"Task Prompt";default:return"Prompt Template"}};return f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"font-medium",children:e?`Edit ${v()}`:`New ${v()}`}),f.jsx("p",{className:"text-sm text-muted-foreground",children:e?`Update your ${r}`:`Create a new ${r}${r==="prompt"?" template with variables":""}`})]}),f.jsxs("form",{onSubmit:w=>{w.preventDefault(),w.stopPropagation(),y.handleSubmit()},className:"space-y-6",children:[f.jsxs("div",{className:"space-y-4",children:[f.jsx(y.Field,{name:"name",children:w=>f.jsxs("div",{children:[f.jsxs(It,{htmlFor:w.name,children:[v()," Name"]}),f.jsx(_n,{id:w.name,value:w.state.value,onChange:S=>w.handleChange(S.target.value),onBlur:w.handleBlur,placeholder:`Enter ${r} name`}),w.state.meta.errors&&w.state.meta.errors.length>0&&f.jsx("p",{className:"text-xs text-destructive mt-1",children:w.state.meta.errors[0]||"Invalid input"})]})}),f.jsx(y.Field,{name:"description",children:w=>f.jsxs("div",{children:[f.jsx(It,{htmlFor:w.name,children:"Description"}),f.jsx(Bo,{id:w.name,value:w.state.value,onChange:S=>w.handleChange(S.target.value),onBlur:w.handleBlur,placeholder:`Describe what this ${r} does`,rows:3})]})}),f.jsx(y.Field,{name:"prompt",children:w=>f.jsxs("div",{children:[f.jsx(It,{htmlFor:w.name,children:x()}),f.jsx(Bo,{id:w.name,value:w.state.value,onChange:S=>w.handleChange(S.target.value),onBlur:w.handleBlur,placeholder:`Enter your ${r} prompt using {{ variable_name }} syntax`,rows:6,className:"font-mono"}),f.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["Use double curly braces to reference variables:"," ","{{ variable_name }}"]}),w.state.meta.errors&&w.state.meta.errors.length>0&&f.jsx("p",{className:"text-xs text-destructive mt-1",children:w.state.meta.errors[0]||"Invalid input"})]})})]}),f.jsx(Nct,{variables:y.getFieldValue("variables"),onVariablesChange:w=>y.setFieldValue("variables",w),templateId:e==null?void 0:e.id}),s&&f.jsx(y.Field,{name:"followUps",children:w=>f.jsx(Mct,{selectedFollowUps:w.state.value||[],onFollowUpsChange:S=>w.handleChange(S),followUpOptions:a,templateId:e==null?void 0:e.id})}),f.jsx("div",{className:"space-y-4",children:f.jsxs("div",{children:[f.jsx(It,{className:"text-base font-medium",children:"Auto-select Tools"}),f.jsxs("p",{className:"text-sm text-muted-foreground mb-4",children:["Choose tools that will be automatically enabled when this ",r,"is applied."]}),f.jsx(y.Field,{name:"tools",children:w=>f.jsx(Rct,{selectedTools:w.state.value,onToolsChange:S=>w.handleChange(S),className:"p-0 max-w-none",maxSteps:l,onMaxStepsChange:c,showMaxSteps:i})})]})}),f.jsx("div",{className:"space-y-4",children:f.jsxs("div",{children:[f.jsx(It,{className:"text-base font-medium",children:"Auto-select Rules & Tags"}),f.jsxs("p",{className:"text-sm text-muted-foreground mb-4",children:["Choose rules and tags that will be automatically enabled when this",r," is applied."]}),f.jsx(Zue,{activeTagIds:new Set(y.getFieldValue("tags")),activeRuleIds:new Set(y.getFieldValue("rules")),onToggleTag:(w,S)=>{const C=y.getFieldValue("tags");S?y.setFieldValue("tags",[...C,w]):y.setFieldValue("tags",C.filter(k=>k!==w))},onToggleRule:(w,S)=>{const C=y.getFieldValue("rules");S?y.setFieldValue("rules",[...C,w]):y.setFieldValue("rules",C.filter(k=>k!==w))},allRules:u,allTags:d,getRulesForTag:b})]})}),f.jsxs("div",{className:"flex gap-3 pt-4 border-t",children:[f.jsxs(ft,{type:"submit",className:"flex-1",children:[f.jsx(Qd,{className:"h-4 w-4 mr-2"}),e?`Update ${v()}`:`Create ${v()}`]}),o]})]})]})},RP=({templates:e,onEdit:t,onDelete:n,type:r,emptyMessage:s,additionalActions:i,getTaskCount:a})=>{const o=()=>{switch(r){case"agent":return"Agents";case"task":return"Tasks";default:return"Templates"}},l=()=>{switch(r){case"agent":return"Manage your AI agents and their associated tasks";case"task":return"Manage tasks for this agent";default:return"Manage your reusable prompt templates with dynamic variables"}},c=()=>{if(s)return s;switch(r){case"agent":return"No Agents Yet";case"task":return"No Tasks Yet";default:return"No Templates Yet"}},u=()=>{switch(r){case"agent":return'Use the "New Agent" tab to create your first agent';case"task":return"Create tasks to define what this agent can do";default:return'Use the "New Template" tab to create your first template'}};return f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"font-medium",children:o()}),f.jsx("p",{className:"text-sm text-muted-foreground",children:l()})]}),e.length===0?f.jsxs("div",{className:"text-center py-12 border-2 border-dashed rounded-lg",children:[f.jsx("h4",{className:"font-medium text-muted-foreground",children:c()}),f.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:u()})]}):f.jsxs(lf,{children:[f.jsx(fp,{children:f.jsxs(Es,{children:[f.jsx(Tr,{children:"Name"}),f.jsx(Tr,{children:"Description"}),f.jsx(Tr,{children:"Variables"}),r==="agent"&&f.jsx(Tr,{children:"Tasks"}),(r==="prompt"||r==="task")&&f.jsx(Tr,{children:"Follow-ups"}),f.jsx(Tr,{children:"Tools"}),f.jsx(Tr,{children:"Rules/Tags"}),f.jsx(Tr,{className:"text-right",children:"Actions"})]})}),f.jsx(cf,{children:e.map(d=>{var h,m,y,b;return f.jsxs(Es,{children:[f.jsx(On,{className:"font-medium",children:d.name}),f.jsx(On,{className:"max-w-xs truncate",children:d.description}),f.jsx(On,{children:f.jsx(is,{variant:"secondary",children:d.variables.length})}),r==="agent"&&f.jsx(On,{children:f.jsx(is,{variant:"secondary",children:a?a(d.id):0})}),(r==="prompt"||r==="task")&&f.jsx(On,{children:f.jsx(is,{variant:"secondary",children:((h=d.followUps)==null?void 0:h.length)||0})}),f.jsx(On,{children:f.jsx(is,{variant:"secondary",children:((m=d.tools)==null?void 0:m.length)||0})}),f.jsx(On,{children:f.jsxs("div",{className:"flex gap-1",children:[f.jsxs(is,{variant:"secondary",children:[((y=d.tags)==null?void 0:y.length)||0," tags"]}),f.jsxs(is,{variant:"secondary",children:[((b=d.rules)==null?void 0:b.length)||0," rules"]})]})}),f.jsx(On,{className:"text-right",children:f.jsxs("div",{className:"flex gap-2 justify-end",children:[i&&i(d),f.jsx(ft,{variant:"ghost",size:"sm",onClick:()=>t(d),title:`Edit ${r}`,children:f.jsx(dh,{className:"h-4 w-4"})}),f.jsx(ft,{variant:"ghost",size:"sm",onClick:()=>n(d.id),title:`Delete ${r}`,children:f.jsx(Ao,{className:"h-4 w-4"})})]})})]},d.id)})})]})]})},jct=()=>{const[e,t]=T.useState("templates"),[n,r]=T.useState(),{loadPromptTemplates:s,addPromptTemplate:i,updatePromptTemplate:a,deletePromptTemplate:o,getTemplatesByType:l}=Om(yn(v=>({loadPromptTemplates:v.loadPromptTemplates,addPromptTemplate:v.addPromptTemplate,updatePromptTemplate:v.updatePromptTemplate,deletePromptTemplate:v.deletePromptTemplate,getTemplatesByType:v.getTemplatesByType}))),c=l("prompt");T.useEffect(()=>{s()},[s]);const u=async v=>{await i({...v,type:"prompt",isPublic:!1})},d=async v=>{n&&await a(n.id,v)},h=async v=>{confirm("Are you sure you want to delete this template?")&&await o(v)},m=v=>{r(v),t("edit")},y=()=>{t("templates"),r(void 0)},b=[{value:"templates",label:"Templates",content:f.jsx(RP,{templates:c,onEdit:m,onDelete:h,type:"prompt"})},{value:"new",label:"New Template",content:f.jsx(E0,{onSubmit:u,onSuccess:y,type:"prompt",showFollowUps:!0,followUpOptions:c},"new-template-form")}];return n&&b.push({value:"edit",label:`Edit: ${n.name}`,content:f.jsx(E0,{template:n,onSubmit:d,onSuccess:y,type:"prompt",showFollowUps:!0,followUpOptions:c},`edit-template-form-${n.id}`)}),f.jsx(sc,{tabs:b,initialValue:e,onValueChange:t,defaultValue:"templates",contentContainerClassName:"pb-2 sm:pb-6 pr-1 sm:pr-2 -mr-1 sm:-mr-2",scrollable:!1})},Pct=()=>{const[e,t]=T.useState("agents"),[n,r]=T.useState(),[s,i]=T.useState(),[a,o]=T.useState(),{loadPromptTemplates:l,addPromptTemplate:c,updatePromptTemplate:u,deletePromptTemplate:d,getAgents:h,getTasksForAgent:m}=Om(yn(D=>({loadPromptTemplates:D.loadPromptTemplates,addPromptTemplate:D.addPromptTemplate,updatePromptTemplate:D.updatePromptTemplate,deletePromptTemplate:D.deletePromptTemplate,getAgents:D.getAgents,getTasksForAgent:D.getTasksForAgent})));T.useEffect(()=>{l()},[l]);const y=h(),b=s?m(s.id):[],v=async D=>{await c({...D,type:"agent",isPublic:!1})},x=async D=>{n&&await u(n.id,D)},w=async D=>{if(confirm("Are you sure you want to delete this agent and all its tasks?")){const Z=m(D);for(const U of Z)await d(U.id);await d(D)}},S=async D=>{s&&await c({...D,type:"task",parentId:s.id,isPublic:!1})},C=async D=>{!a||!s||await u(a.id,{...D,parentId:s.id})},k=async D=>{confirm("Are you sure you want to delete this task?")&&await d(D)},A=D=>{r(D),t("edit-agent")},R=D=>{i(D),t("manage-tasks")},N=D=>{o(D),t("edit-task")},I=()=>{o(void 0),t("new-task")},P=()=>{t("agents"),r(void 0),i(void 0),o(void 0)},L=()=>{t("agents"),i(void 0),o(void 0)},O=()=>{t("manage-tasks"),o(void 0)},V=[{value:"agents",label:"Agents",content:f.jsx(RP,{templates:y,onEdit:A,onDelete:w,type:"agent",getTaskCount:D=>m(D).length,additionalActions:D=>f.jsxs(ft,{variant:"ghost",size:"sm",onClick:()=>R(D),title:"Manage Tasks",children:[f.jsx(dh,{className:"h-4 w-4"}),"Tasks"]})})},{value:"new-agent",label:"New Agent",content:f.jsx(E0,{onSubmit:v,onSuccess:P,type:"agent",showFollowUps:!1,showMaxSteps:!0},"new-agent-form")}];return n&&V.push({value:"edit-agent",label:`Edit: ${n.name}`,content:f.jsx(E0,{template:n,onSubmit:x,onSuccess:P,type:"agent",showFollowUps:!1,showMaxSteps:!0,additionalActions:f.jsxs(ft,{type:"button",variant:"outline",onClick:()=>R(n),className:"flex items-center gap-2",children:[f.jsx(dh,{className:"h-4 w-4"}),"Tasks (",m(n.id).length,")"]})},`edit-agent-form-${n.id}`)}),s&&V.push({value:"manage-tasks",label:`Tasks: ${s.name}`,content:f.jsxs("div",{className:"space-y-4",children:[f.jsx("div",{className:"flex items-center gap-2",children:f.jsx(ft,{variant:"outline",onClick:L,children:"← Back to Agents"})}),f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsxs("h3",{className:"font-medium",children:["Tasks for ",s.name]}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Manage tasks for this agent"})]}),f.jsxs(ft,{onClick:I,children:[f.jsx(Ru,{className:"h-4 w-4 mr-2"}),"New Task"]})]}),f.jsx(RP,{templates:b,onEdit:N,onDelete:k,type:"task",emptyMessage:"No Tasks Yet"})]})}),s&&e==="new-task"&&V.push({value:"new-task",label:"New Task",content:f.jsxs("div",{className:"space-y-4",children:[f.jsx("div",{className:"flex items-center gap-2",children:f.jsx(ft,{variant:"outline",onClick:O,children:"← Back to Tasks"})}),f.jsx(E0,{onSubmit:S,onSuccess:O,type:"task",showFollowUps:!0,followUpOptions:b,showMaxSteps:!0},`new-task-form-${s.id}`)]})}),a&&s&&V.push({value:"edit-task",label:`Edit: ${a.name}`,content:f.jsxs("div",{className:"space-y-4",children:[f.jsx("div",{className:"flex items-center gap-2",children:f.jsx(ft,{variant:"outline",onClick:O,children:"← Back to Tasks"})}),f.jsx(E0,{template:a,onSubmit:C,onSuccess:O,type:"task",showFollowUps:!0,followUpOptions:b.filter(D=>D.id!==a.id),showMaxSteps:!0},`edit-task-form-${a.id}`)]})}),f.jsx(sc,{tabs:V,initialValue:e,onValueChange:t,defaultValue:"agents",contentContainerClassName:"pb-2 sm:pb-6 pr-1 sm:pr-2 -mr-1 sm:-mr-2",scrollable:!1})},Oct=Ke({name:$e().min(1,"Name is required"),url:$e().url("Must be a valid URL"),description:$e(),headers:$e(),enabled:br()}),Dct=Ke({retryAttempts:Tt().min(0,"Min 0 attempts").max(10,"Max 10 attempts"),retryDelay:Tt().min(500,"Min 500ms").max(3e4,"Max 30000ms"),connectionTimeout:Tt().min(1e3,"Min 1000ms").max(6e4,"Max 60000ms"),maxResponseSize:Tt().min(1e3,"Min 1KB").max(1e7,"Max 10MB")});function Sc({field:e}){return f.jsx(f.Fragment,{children:e.state.meta.isTouched&&e.state.meta.errors.length>0?f.jsx("em",{className:"text-xs text-destructive mt-1 block",children:e.state.meta.errors.join(", ")}):null})}function Fct(){const{bridgeConfig:e,setBridgeConfig:t}=rl(yn(s=>({bridgeConfig:s.bridgeConfig,setBridgeConfig:s.setBridgeConfig}))),n=ri({defaultValues:{url:e.url||"",host:e.host||"",port:e.port||void 0},onSubmit:async({value:s})=>{t({url:s.url||void 0,host:s.host||void 0,port:s.port})}});T.useEffect(()=>{n.reset({url:e.url||"",host:e.host||"",port:e.port||void 0})},[e,n]);const r=()=>{window.confirm("Reset bridge configuration to defaults?")&&t({})};return f.jsxs("form",{onSubmit:s=>{s.preventDefault(),s.stopPropagation(),n.handleSubmit()},className:"space-y-6",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"font-medium",children:"Dynamic MCP Bridge Configuration"}),f.jsxs("p",{className:"text-sm text-muted-foreground",children:["Configure where LiteChat looks for the dynamic MCP bridge service (required for stdio:// servers). Start the bridge with: ",f.jsx("code",{className:"bg-muted px-1 rounded",children:"npm run mcp-proxy"})]})]}),f.jsxs(cl,{children:[f.jsxs(ul,{children:[f.jsxs(dl,{className:"text-base flex items-center",children:[f.jsx(nC,{className:"mr-2 h-4 w-4"}),"Bridge Location"]}),f.jsx(Bd,{children:"Specify where your dynamic MCP bridge is running (default: localhost:3001)"})]}),f.jsxs(fl,{className:"space-y-4",children:[f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[f.jsx(n.Field,{name:"url",children:s=>f.jsxs("div",{className:"space-y-2",children:[f.jsx(It,{htmlFor:s.name,children:"Full Bridge URL (highest priority)"}),f.jsx(_n,{id:s.name,value:s.state.value,onChange:i=>s.handleChange(i.target.value),onBlur:s.handleBlur,placeholder:"http://192.168.1.100:3001"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Complete URL where the dynamic MCP bridge is running"}),f.jsx(Sc,{field:s})]})}),f.jsxs("div",{className:"space-y-2",children:[f.jsx(It,{children:"Or configure Host + Port"}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx(n.Field,{name:"host",children:s=>f.jsxs("div",{className:"flex-1",children:[f.jsx(_n,{value:s.state.value,onChange:i=>s.handleChange(i.target.value),onBlur:s.handleBlur,placeholder:"localhost"}),f.jsx(Sc,{field:s})]})}),f.jsx(n.Field,{name:"port",children:s=>f.jsxs("div",{className:"w-20",children:[f.jsx(_n,{type:"number",value:s.state.value||"",onChange:i=>s.handleChange(parseInt(i.target.value)||void 0),onBlur:s.handleBlur,placeholder:"3001"}),f.jsx(Sc,{field:s})]})})]}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Host and port (uses HTTP by default)"})]})]}),f.jsxs("div",{className:"text-sm text-muted-foreground bg-muted/50 p-3 rounded-md",children:[f.jsx("p",{className:"font-medium mb-1",children:"Bridge Detection Priority:"}),f.jsxs("ol",{className:"list-decimal list-inside space-y-1 text-xs",children:[f.jsx("li",{children:"Full URL (if specified above)"}),f.jsx("li",{children:"Host + Port combination (if specified above)"}),f.jsx("li",{children:"Auto-detection fallback: localhost:3001"})]}),f.jsx("p",{className:"mt-2 text-xs",children:"Leave empty for auto-detection. For remote bridge, use full URL or configure host binding."})]})]})]}),f.jsxs(cl,{children:[f.jsx(ul,{children:f.jsx(dl,{className:"text-base",children:"Bridge Setup Instructions"})}),f.jsx(fl,{className:"space-y-3",children:f.jsxs("div",{className:"text-sm space-y-2",children:[f.jsx("p",{className:"font-medium",children:"To use stdio MCP servers, install and run the bridge:"}),f.jsxs("div",{className:"bg-muted p-3 rounded font-mono text-xs",children:[f.jsx("p",{children:"# Start the bridge (from LiteChat project directory)"}),f.jsx("p",{children:"node bin/mcp-bridge.js"}),f.jsx("p",{}),f.jsx("p",{children:"# Or with custom settings"}),f.jsx("p",{children:"node bin/mcp-bridge.js --host 0.0.0.0 --port 3001"})]})]})})]}),f.jsx("div",{className:"flex items-center justify-between pt-3 border-t",children:f.jsx(n.Subscribe,{children:s=>f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(ft,{type:"submit",size:"sm",disabled:!s.canSubmit||s.isSubmitting||s.isValidating||!s.isValid,children:s.isSubmitting?"Saving...":s.isValidating?"Validating...":"Save Bridge Config"}),f.jsxs(ft,{variant:"outline",size:"sm",onClick:r,type:"button",children:[f.jsx(l1,{className:"mr-2 h-4 w-4"}),"Reset"]})]})})})]})}function Lct(){const{retryAttempts:e,retryDelay:t,connectionTimeout:n,maxResponseSize:r,setRetryAttempts:s,setRetryDelay:i,setConnectionTimeout:a,setMaxResponseSize:o}=rl(yn(u=>({retryAttempts:u.retryAttempts,retryDelay:u.retryDelay,connectionTimeout:u.connectionTimeout,maxResponseSize:u.maxResponseSize,setRetryAttempts:u.setRetryAttempts,setRetryDelay:u.setRetryDelay,setConnectionTimeout:u.setConnectionTimeout,setMaxResponseSize:u.setMaxResponseSize}))),l=ri({defaultValues:{retryAttempts:e,retryDelay:t,connectionTimeout:n,maxResponseSize:r},validators:{onChangeAsync:Dct,onChangeAsyncDebounceMs:500},onSubmit:async({value:u})=>{s(u.retryAttempts),i(u.retryDelay),a(u.connectionTimeout),o(u.maxResponseSize)}});T.useEffect(()=>{l.reset({retryAttempts:e,retryDelay:t,connectionTimeout:n,maxResponseSize:r})},[e,t,n,r,l]);const c=()=>{window.confirm("Reset connection settings to defaults?")&&(s(3),i(2e3),a(1e4),o(128e3))};return f.jsxs("form",{onSubmit:u=>{u.preventDefault(),u.stopPropagation(),l.handleSubmit()},className:"space-y-6",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"font-medium",children:"Connection Settings"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Configure retry behavior and timeouts for MCP server connections"})]}),f.jsxs(cl,{children:[f.jsxs(ul,{children:[f.jsx(dl,{className:"text-base",children:"Retry Configuration"}),f.jsx(Bd,{children:"How LiteChat handles failed connections"})]}),f.jsx(fl,{className:"space-y-4",children:f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[f.jsx(l.Field,{name:"retryAttempts",children:u=>f.jsxs("div",{className:"space-y-2",children:[f.jsx(It,{htmlFor:u.name,children:"Retry Attempts"}),f.jsx(_n,{id:u.name,type:"number",min:"0",max:"10",value:u.state.value,onChange:d=>u.handleChange(parseInt(d.target.value)||0),onBlur:u.handleBlur,placeholder:"3"}),f.jsx(Sc,{field:u}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Number of retry attempts (0-10)"})]})}),f.jsx(l.Field,{name:"retryDelay",children:u=>f.jsxs("div",{className:"space-y-2",children:[f.jsx(It,{htmlFor:u.name,children:"Retry Delay (ms)"}),f.jsx(_n,{id:u.name,type:"number",min:"500",max:"30000",step:"500",value:u.state.value,onChange:d=>u.handleChange(parseInt(d.target.value)||2e3),onBlur:u.handleBlur,placeholder:"2000"}),f.jsx(Sc,{field:u}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Initial delay between retries (500-30000ms)"})]})}),f.jsx(l.Field,{name:"connectionTimeout",children:u=>f.jsxs("div",{className:"space-y-2",children:[f.jsx(It,{htmlFor:u.name,children:"Connection Timeout (ms)"}),f.jsx(_n,{id:u.name,type:"number",min:"1000",max:"60000",step:"1000",value:u.state.value,onChange:d=>u.handleChange(parseInt(d.target.value)||1e4),onBlur:u.handleBlur,placeholder:"10000"}),f.jsx(Sc,{field:u}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Connection timeout (1000-60000ms)"})]})}),f.jsx(l.Field,{name:"maxResponseSize",children:u=>f.jsxs("div",{className:"space-y-2",children:[f.jsx(It,{htmlFor:u.name,children:"Max Response Size (bytes)"}),f.jsx(_n,{id:u.name,type:"number",min:"1000",max:"10000000",step:"1000",value:u.state.value,onChange:d=>u.handleChange(parseInt(d.target.value)||128e3),onBlur:u.handleBlur,placeholder:"128000"}),f.jsx(Sc,{field:u}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Max tool response size (1KB-10MB)"})]})})]})})]}),f.jsxs(cl,{children:[f.jsx(ul,{children:f.jsx(dl,{className:"text-base",children:"How It Works"})}),f.jsx(fl,{children:f.jsx("div",{className:"text-sm text-muted-foreground bg-muted/50 p-3 rounded-md",children:f.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[f.jsx("li",{children:"Failed connections will be retried automatically with exponential backoff"}),f.jsx("li",{children:"Toast notifications will show connection status and retry progress"}),f.jsx("li",{children:"Servers that fail all retry attempts will be marked as disconnected"}),f.jsx("li",{children:"You can manually retry connections from the server cards in the Servers tab"}),f.jsxs("li",{children:[f.jsx("strong",{children:"Max Response Size:"})," Tool responses larger than this limit will be automatically truncated to prevent API errors"]})]})})})]}),f.jsx("div",{className:"flex items-center justify-between pt-3 border-t",children:f.jsx(l.Subscribe,{children:u=>f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(ft,{type:"submit",size:"sm",disabled:!u.canSubmit||u.isSubmitting||u.isValidating||!u.isValid,children:u.isSubmitting?"Saving...":u.isValidating?"Validating...":"Save Connection Settings"}),f.jsxs(ft,{variant:"outline",size:"sm",onClick:c,type:"button",children:[f.jsx(l1,{className:"mr-2 h-4 w-4"}),"Reset"]})]})})})]})}function LW({server:e,onSubmit:t,onCancel:n}){const r=ri({defaultValues:{name:(e==null?void 0:e.name)||"",url:(e==null?void 0:e.url)||"",description:(e==null?void 0:e.description)||"",headers:e!=null&&e.headers?JSON.stringify(e.headers,null,2):"",enabled:(e==null?void 0:e.enabled)??!0},validators:{onChangeAsync:Oct,onChangeAsyncDebounceMs:500},onSubmit:async({value:s})=>{t(s)}});return T.useEffect(()=>{r.reset({name:(e==null?void 0:e.name)||"",url:(e==null?void 0:e.url)||"",description:(e==null?void 0:e.description)||"",headers:e!=null&&e.headers?JSON.stringify(e.headers,null,2):"",enabled:(e==null?void 0:e.enabled)??!0})},[e,r]),f.jsxs("form",{onSubmit:s=>{s.preventDefault(),s.stopPropagation(),r.handleSubmit()},className:"space-y-6",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"text-lg font-medium",children:e?"Edit MCP Server":"Add New MCP Server"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:e?"Modify the server configuration below.":"Configure a new MCP server to connect to."})]}),f.jsxs(cl,{children:[f.jsx(ul,{children:f.jsxs(dl,{className:"text-base flex items-center",children:[f.jsx(G0,{className:"mr-2 h-4 w-4"}),"Server Details"]})}),f.jsxs(fl,{className:"space-y-4",children:[f.jsx(r.Field,{name:"name",children:s=>f.jsxs("div",{className:"space-y-2",children:[f.jsx(It,{htmlFor:s.name,children:"Server Name"}),f.jsx(_n,{id:s.name,value:s.state.value,onChange:i=>s.handleChange(i.target.value),onBlur:s.handleBlur,placeholder:"My MCP Server"}),f.jsx(Sc,{field:s})]})}),f.jsx(r.Field,{name:"url",children:s=>f.jsxs("div",{className:"space-y-2",children:[f.jsx(It,{htmlFor:s.name,children:"Server URL"}),f.jsx(_n,{id:s.name,value:s.state.value,onChange:i=>s.handleChange(i.target.value),onBlur:s.handleBlur,placeholder:"https://api.example.com/mcp or stdio://npx?args=-y,@modelcontextprotocol/server-filesystem,."}),f.jsx(Sc,{field:s}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"HTTP/HTTPS URLs for remote servers, or stdio://command?args=arg1,arg2 for dynamic bridge servers"})]})}),f.jsx(r.Field,{name:"description",children:s=>f.jsxs("div",{className:"space-y-2",children:[f.jsx(It,{htmlFor:s.name,children:"Description (Optional)"}),f.jsx(Bo,{id:s.name,value:s.state.value,onChange:i=>s.handleChange(i.target.value),onBlur:s.handleBlur,placeholder:"Brief description of this server's purpose",rows:2}),f.jsx(Sc,{field:s})]})}),f.jsx(r.Field,{name:"headers",children:s=>f.jsxs("div",{className:"space-y-2",children:[f.jsx(It,{htmlFor:s.name,children:"Authentication Headers (Optional)"}),f.jsx(Bo,{id:s.name,value:s.state.value,onChange:i=>s.handleChange(i.target.value),onBlur:s.handleBlur,placeholder:'{"Authorization": "Bearer your-token-here"}',rows:3}),f.jsx(Sc,{field:s}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"JSON object with authentication headers (not applicable for stdio servers)"})]})}),f.jsx(r.Field,{name:"enabled",children:s=>f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(Io,{id:s.name,checked:s.state.value,onCheckedChange:s.handleChange}),f.jsx(It,{htmlFor:s.name,children:"Enable this server"})]})})]}),f.jsxs(dVe,{className:"flex gap-2",children:[f.jsx(r.Subscribe,{selector:s=>[s.canSubmit,s.isSubmitting],children:([s,i])=>f.jsx(ft,{type:"submit",disabled:!s||i,children:i?e?"Updating...":"Adding...":e?"Update Server":"Add Server"})}),f.jsx(ft,{type:"button",variant:"outline",onClick:n,children:"Cancel"})]})]})]})}function Bct({onNewServer:e,onEditServer:t}){const{servers:n,deleteServer:r,updateServer:s}=rl(yn(o=>({servers:o.servers,deleteServer:o.deleteServer,updateServer:o.updateServer}))),i=o=>{window.confirm("Are you sure you want to delete this MCP server?")&&r(o)},a=o=>{s(o.id,{enabled:!o.enabled})};return f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"font-medium",children:"MCP Servers"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Manage your Model Context Protocol servers"})]}),f.jsxs(ft,{onClick:e,children:[f.jsx(Ru,{className:"mr-2 h-4 w-4"}),"Add Server"]})]}),n.length===0?f.jsxs("div",{className:"text-center py-12 border-2 border-dashed rounded-lg",children:[f.jsx(G0,{className:"h-12 w-12 text-muted-foreground mb-4 mx-auto"}),f.jsx("h4",{className:"font-medium text-muted-foreground",children:"No MCP Servers"}),f.jsx("p",{className:"text-sm text-muted-foreground mt-1 mb-4",children:"Add HTTP-based MCP servers to extend LiteChat with additional tools and capabilities"}),f.jsxs(ft,{onClick:e,children:[f.jsx(Ru,{className:"mr-2 h-4 w-4"}),"Add Your First Server"]})]}):f.jsxs(lf,{children:[f.jsx(fp,{children:f.jsxs(Es,{children:[f.jsx(Tr,{children:"Name"}),f.jsx(Tr,{children:"URL"}),f.jsx(Tr,{children:"Status"}),f.jsx(Tr,{children:"Description"}),f.jsx(Tr,{className:"text-right",children:"Actions"})]})}),f.jsx(cf,{children:n.map(o=>f.jsxs(Es,{children:[f.jsx(On,{className:"font-medium",children:o.name}),f.jsx(On,{className:"max-w-xs truncate font-mono text-xs",children:o.url}),f.jsx(On,{children:f.jsx(is,{variant:o.enabled?"default":"secondary",children:o.enabled?f.jsxs(f.Fragment,{children:[f.jsx(Rpe,{className:"mr-1 h-3 w-3"}),"Enabled"]}):f.jsxs(f.Fragment,{children:[f.jsx(Dpe,{className:"mr-1 h-3 w-3"}),"Disabled"]})})}),f.jsx(On,{className:"max-w-xs truncate",children:o.description||"—"}),f.jsx(On,{className:"text-right",children:f.jsxs("div",{className:"flex gap-2 justify-end",children:[f.jsx(Io,{checked:o.enabled,onCheckedChange:()=>a(o),className:"scale-75"}),f.jsx(ft,{variant:"ghost",size:"sm",onClick:()=>t(o),children:f.jsx(dh,{className:"h-4 w-4"})}),f.jsx(ft,{variant:"ghost",size:"sm",onClick:()=>i(o.id),children:f.jsx(Oge,{className:"h-4 w-4"})})]})})]},o.id))})]})]})}const $ct=()=>{const[e,t]=T.useState("servers"),[n,r]=T.useState(),{addServer:s,updateServer:i}=rl(yn(h=>({addServer:h.addServer,updateServer:h.updateServer}))),a=async h=>{try{const m=h.headers?JSON.parse(h.headers):void 0;s({name:h.name,url:h.url,description:h.description,headers:m,enabled:h.enabled}),t("servers")}catch(m){console.error("Invalid headers JSON:",m),je.error("Invalid JSON in headers field")}},o=async h=>{if(n)try{const m=h.headers?JSON.parse(h.headers):void 0;i(n.id,{name:h.name,url:h.url,description:h.description,headers:m,enabled:h.enabled}),t("servers"),r(void 0)}catch(m){console.error("Invalid headers JSON:",m),je.error("Invalid JSON in headers field")}},l=()=>{r(void 0),t("new")},c=h=>{r(h),t("edit")},u=()=>{t("servers"),r(void 0)},d=[{value:"servers",label:"Servers",content:f.jsx(Bct,{onNewServer:l,onEditServer:c})},{value:"bridge",label:"Bridge Config",content:f.jsx(Fct,{})},{value:"connection",label:"Connection",content:f.jsx(Lct,{})},{value:"new",label:"Add Server",content:f.jsx(LW,{onSubmit:a,onCancel:u},"new-server-form")}];return n&&d.push({value:"edit",label:`Edit: ${n.name}`,content:f.jsx(LW,{server:n,onSubmit:o,onCancel:u},`edit-server-form-${n.id}`)}),f.jsx(sc,{tabs:d,initialValue:e,onValueChange:t,defaultValue:"servers",contentContainerClassName:"pb-2 sm:pb-6 pr-1 sm:pr-2 -mr-1 sm:-mr-2",scrollable:!1})},zct=()=>{const{resetAssistantSettings:e}=yr(yn(r=>({resetAssistantSettings:r.resetAssistantSettings}))),t=()=>{window.confirm("Are you sure you want to reset all Assistant settings (Prompt, Parameters, Tools, Auto-Title) to their defaults?")&&e()},n=T.useMemo(()=>[{value:"prompt",label:"System Prompt",content:f.jsx(wct,{})},{value:"parameters",label:"Parameters",content:f.jsx(Sct,{})},{value:"tools",label:"Tools",content:f.jsx(Ect,{})},{value:"mcp",label:"MCP",content:f.jsx($ct,{})},{value:"titles",label:"Auto-Titles",content:f.jsx(Act,{})},{value:"prompts",label:"Prompts",content:f.jsx(jct,{})},{value:"agents",label:"Agents",content:f.jsx(Pct,{})}],[]);return f.jsxs("div",{className:"space-y-4 p-1 h-full flex flex-col",children:[f.jsx(sc,{tabs:n,defaultValue:"prompt",className:"flex-grow",listClassName:"bg-muted/50 rounded-md",contentContainerClassName:"mt-3",scrollable:!1}),f.jsx(Xd,{className:"mt-auto"}),f.jsx("div",{className:"flex justify-end pt-3 flex-shrink-0",children:f.jsxs(ft,{variant:"outline",size:"sm",onClick:t,children:[f.jsx(l1,{className:"mr-2 h-4 w-4"}),"Reset All Assistant Settings"]})})]})},Uct=We.memo(zct);class qct{constructor(){me(this,"id","core-settings-assistant");me(this,"unregisterCallback",null);me(this,"modApiRef",null);me(this,"eventUnsubscribers",[]);me(this,"isVisible",!1)}async initialize(t){this.modApiRef=t,this.isVisible=yr.getState().enableAdvancedSettings;const n=t.on(sn.enableAdvancedSettingsChanged,r=>{typeof r=="object"&&r&&"enabled"in r&&this.isVisible!==r.enabled&&(this.isVisible=r.enabled,this.reregisterTab())});this.eventUnsubscribers.push(n)}reregisterTab(){this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.modApiRef&&this.register(this.modApiRef)}register(t){this.modApiRef=t,this.isVisible?this.unregisterCallback||(this.unregisterCallback=t.registerSettingsTab({id:"assistant",title:"Assistant",component:Uct,order:40})):this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null)}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const Vct=Ke({importSettings:br(),importApiKeys:br(),importProviderConfigs:br(),importProjects:br(),importConversations:br(),importRulesAndTags:br(),importMods:br(),importSyncRepos:br()}),Wct=Ke({importSettings:br(),importApiKeys:br(),importProviderConfigs:br(),importProjects:br(),importConversations:br(),importRulesAndTags:br(),importMods:br(),importSyncRepos:br()}),Hct=()=>{const{importConversation:e,exportAllConversations:t}=qn(yn(N=>({importConversation:N.importConversation,exportAllConversations:N.exportAllConversations}))),n=T.useRef(null),r=T.useRef(null),[s,i]=T.useState(!1),[a,o]=T.useState(!1),[l,c]=T.useState(!1),[u,d]=T.useState(!1),[h,m]=T.useState(!1),y=ri({defaultValues:{importSettings:!0,importApiKeys:!0,importProviderConfigs:!0,importProjects:!0,importConversations:!0,importRulesAndTags:!0,importMods:!0,importSyncRepos:!0},validators:{onChange:Vct}}),b=ri({defaultValues:{importSettings:!0,importApiKeys:!0,importProviderConfigs:!0,importProjects:!0,importConversations:!0,importRulesAndTags:!0,importMods:!0,importSyncRepos:!0},validators:{onChange:Wct}}),v=()=>{var N;(N=n.current)==null||N.click()},x=()=>{var N;(N=r.current)==null||N.click()},w=T.useCallback(async N=>{var P;const I=(P=N.target.files)==null?void 0:P[0];if(I){i(!0);try{await e(I)}catch(L){console.error("Import failed (from component):",L)}finally{n.current&&(n.current.value=""),i(!1)}}},[e]),S=T.useCallback(async N=>{var P;const I=(P=N.target.files)==null?void 0:P[0];if(I){if(!window.confirm("Importing this file will OVERWRITE existing data for the selected categories. Are you sure you want to proceed?")){r.current&&(r.current.value="");return}m(!0);try{await v0.importFullConfiguration(I,y.state.values)}catch(L){console.error("Full import failed (from component):",L)}finally{r.current&&(r.current.value=""),m(!1)}}},[y]),C=T.useCallback(async()=>{o(!0);try{await t()}catch(N){console.error("Export all failed (from component):",N)}finally{o(!1)}},[t]),k=T.useCallback(async()=>{d(!0);try{await v0.exportFullConfiguration(b.state.values)}catch(N){console.error("Full export failed (from component):",N)}finally{d(!1)}},[b]),A=T.useCallback(async()=>{if(window.confirm(`🚨 ARE YOU ABSOLUTELY SURE? 🚨

This will permanently delete ALL conversations, messages, mods, settings, providers, and stored API keys from your browser. This action cannot be undone.`)&&window.confirm(`SECOND CONFIRMATION:

Really delete everything? Consider exporting first.`)){c(!0);try{await Et.clearAllData(),je.success("All local data cleared. Reloading the application..."),setTimeout(()=>window.location.reload(),1500)}catch(N){const I="Failed to clear all data";console.error(I,N),je.error(`${I}: ${N instanceof Error?N.message:String(N)}`),c(!1)}}},[]),R=(N,I,P,L,O,V)=>{const D=`${V}-${I}-checkbox`;return f.jsx(N.Field,{name:I,children:Z=>f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(Xl,{id:D,checked:Z.state.value,onCheckedChange:U=>Z.handleChange(!!U),disabled:O}),f.jsxs(It,{htmlFor:D,className:"text-sm font-normal flex items-center gap-1.5",children:[f.jsx(L,{className:"h-4 w-4 text-muted-foreground"})," ",P]})]})},I)};return f.jsxs("div",{className:"space-y-4 p-1",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"text-lg font-medium mb-2",children:"Single Conversation"}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[f.jsxs("div",{className:"border p-3 rounded-md space-y-2",children:[f.jsx(It,{className:"font-semibold",children:"Import Conversation"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Import a previously exported single conversation (.json file)."}),f.jsx("input",{type:"file",ref:n,onChange:w,accept:".json",className:"hidden",id:"import-file-input",disabled:s}),f.jsxs(ft,{onClick:v,variant:"outline",size:"sm",disabled:s,children:[s?f.jsx(Qn,{className:"mr-2 h-4 w-4 animate-spin"}):f.jsx(yH,{className:"mr-2 h-4 w-4"}),s?"Importing...":"Select File..."]})]}),f.jsxs("div",{className:"border p-3 rounded-md space-y-2",children:[f.jsx(It,{className:"font-semibold",children:"Export All Conversations"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Export all conversations and messages into a single JSON file."}),f.jsxs(ft,{onClick:C,variant:"outline",size:"sm",disabled:a,children:[a?f.jsx(Qn,{className:"mr-2 h-4 w-4 animate-spin"}):f.jsx(xu,{className:"mr-2 h-4 w-4"}),a?"Exporting...":"Export All Chats"]})]})]})]}),f.jsx(Xd,{}),f.jsxs("div",{children:[f.jsx("h3",{className:"text-lg font-medium mb-2",children:"Full Configuration Backup"}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[f.jsxs("div",{className:"border p-3 rounded-md space-y-3",children:[f.jsx(It,{className:"font-semibold",children:"Import Full Configuration"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Import settings, providers, keys, projects, conversations, etc., from a backup file. Select which data types to restore."}),f.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-2 pt-2",children:[R(y,"importSettings","Settings",nC,h,"import"),R(y,"importApiKeys","API Keys",Bx,h,"import"),R(y,"importProviderConfigs","Providers",G0,h,"import"),R(y,"importProjects","Projects",bB,h,"import"),R(y,"importConversations","Conversations",V3,h,"import"),R(y,"importRulesAndTags","Rules & Tags",W3,h,"import"),R(y,"importMods","Mods",wB,h,"import"),R(y,"importSyncRepos","Sync Repos",Nc,h,"import")]}),f.jsx("input",{type:"file",ref:r,onChange:S,accept:".json",className:"hidden",id:"full-import-file-input",disabled:h}),f.jsxs(ft,{onClick:x,variant:"outline",size:"sm",disabled:h,children:[h?f.jsx(Qn,{className:"mr-2 h-4 w-4 animate-spin"}):f.jsx(ume,{className:"mr-2 h-4 w-4"}),h?"Importing...":"Select Backup File..."]})]}),f.jsxs("div",{className:"border p-3 rounded-md space-y-3",children:[f.jsx(It,{className:"font-semibold",children:"Export Full Configuration"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Export all settings, providers, keys, projects, conversations, rules, tags, mods, etc., into a single backup file. Select which data types to include."}),f.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-2 pt-2",children:[R(b,"importSettings","Settings",nC,u,"export"),R(b,"importApiKeys","API Keys",Bx,u,"export"),R(b,"importProviderConfigs","Providers",G0,u,"export"),R(b,"importProjects","Projects",bB,u,"export"),R(b,"importConversations","Conversations",V3,u,"export"),R(b,"importRulesAndTags","Rules & Tags",W3,u,"export"),R(b,"importMods","Mods",wB,u,"export"),R(b,"importSyncRepos","Sync Repos",Nc,u,"export")]}),f.jsxs(ft,{onClick:k,variant:"secondary",size:"sm",disabled:u,children:[u?f.jsx(Qn,{className:"mr-2 h-4 w-4 animate-spin"}):f.jsx(nme,{className:"mr-2 h-4 w-4"}),u?"Exporting...":"Export Configuration"]})]})]})]}),f.jsx(Xd,{}),f.jsxs("div",{className:"border-t pt-6 border-destructive/50",children:[f.jsx("h3",{className:"text-lg font-medium text-destructive mb-2",children:"Danger Zone"}),f.jsx("p",{className:"text-sm text-destructive/90 mb-3",children:"Be very careful with these actions. Data loss may be permanent."}),f.jsxs(ft,{onClick:A,variant:"destructive",disabled:l,children:[l?f.jsx(Qn,{className:"mr-2 h-4 w-4 animate-spin"}):f.jsx(Ao,{className:"mr-2 h-4 w-4"}),l?"Clearing Data...":"Clear All Local Data (Conversations, Keys, Settings, etc.)"]})]})]})},Gct=We.memo(Hct);class Kct{constructor(){me(this,"id","core-settings-data");me(this,"unregisterCallback",null)}async initialize(t){}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerSettingsTab({id:"data",title:"Data",component:Gct,order:70})}destroy(){this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),console.log(`[${this.id}] Destroyed.`)}}const Yct=()=>{const{loadedMods:e,addDbMod:t,updateDbMod:n,deleteDbMod:r,dbMods:s,isLoading:i}=Oh(yn(A=>({loadedMods:A.loadedMods,addDbMod:A.addDbMod,updateDbMod:A.updateDbMod,deleteDbMod:A.deleteDbMod,dbMods:A.dbMods,isLoading:A.isLoading}))),[a,o]=T.useState(""),[l,c]=T.useState(""),[u,d]=T.useState(""),[h,m]=T.useState(!1),[y,b]=T.useState({}),[v,x]=T.useState({}),w=T.useCallback(async()=>{if(!a.trim()){je.error("Mod name cannot be empty.");return}if(!l.trim()&&!u.trim()){je.error("Either Mod URL or Script Content must be provided.");return}if(l.trim()&&u.trim()){je.error("Provide either a Mod URL or Script Content, not both.");return}m(!0);try{const A={name:a.trim(),sourceUrl:l.trim()||null,scriptContent:u.trim()||null,enabled:!0,loadOrder:((s==null?void 0:s.length)??1)*10};await t(A),o(""),c(""),d(""),je.info("Mod added. Reload required for changes to take effect.")}catch(A){console.error("Failed to add mod (from component):",A)}finally{m(!1)}},[a,l,u,t,s==null?void 0:s.length]),S=T.useCallback(async A=>{b(R=>({...R,[A.id]:!0}));try{await n(A.id,{enabled:!A.enabled}),je.info(`Mod "${A.name}" ${A.enabled?"disabled":"enabled"}. Reload required for changes to take effect.`)}catch(R){console.error("Failed to update mod (from component):",R)}finally{b(R=>({...R,[A.id]:!1}))}},[n]),C=T.useCallback(async A=>{if(window.confirm(`Are you sure you want to delete the mod "${A.name}"? This cannot be undone.`)){x(R=>({...R,[A.id]:!0}));try{await r(A.id),je.info("Mod deleted. Reload required for changes to take effect.")}catch(R){console.error("Failed to delete mod (from component):",R)}finally{x(R=>({...R,[A.id]:!1}))}}},[r]),k=T.useCallback(A=>{const R=e.find(I=>I.id===A);if(R)if(R.error){const I=R.error instanceof Error?R.error.message:String(R.error);return{status:"Error",error:R.error,tooltip:I}}else return{status:"Loaded"};const N=(s||[]).find(I=>I.id===A);return N?N.enabled?{status:"Load Pending (Reload Required)"}:{status:"Disabled"}:{status:"Unknown"}},[e,s]);return f.jsxs("div",{className:"space-y-6 p-1",children:[f.jsxs(Nue,{variant:"destructive",className:"border-destructive/50",children:[f.jsx(LP,{className:"h-4 w-4"}),f.jsx(Mue,{children:"Security Warning"}),f.jsx(Iue,{children:"Running mods from untrusted sources can compromise your security and privacy. Mods execute arbitrary JavaScript code within LiteChat and can potentially access sensitive data like API keys stored in the browser or interact with external services. Only install mods you trust. LiteChat is not responsible for any damage caused by mods."})]}),f.jsxs("div",{className:"space-y-4 rounded-md border p-4",children:[f.jsx("h3",{className:"text-lg font-medium",children:"Add New Mod"}),f.jsxs("div",{className:"space-y-2",children:[f.jsx(It,{htmlFor:"mod-name",children:"Mod Name"}),f.jsx(_n,{id:"mod-name",value:a,onChange:A=>o(A.target.value),placeholder:"My Awesome Mod",disabled:h})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx(It,{htmlFor:"mod-url",children:"Source URL (Optional)"}),f.jsx(_n,{id:"mod-url",type:"url",value:l,onChange:A=>c(A.target.value),placeholder:"https://example.com/my-mod.js",disabled:h||!!u.trim()})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx(It,{htmlFor:"mod-script",children:"Script Content (Optional)"}),f.jsx(Bo,{id:"mod-script",value:u,onChange:A=>d(A.target.value),placeholder:`/* Paste your mod script here */
// Example: modApi.log('log', 'My Mod Loaded!');`,className:"min-h-[100px] font-mono text-xs",disabled:h||!!l.trim()})]}),f.jsxs(ft,{onClick:w,disabled:h,children:[h&&f.jsx(Qn,{className:"mr-2 h-4 w-4 animate-spin"}),h?"Adding...":"Add Mod"]})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx("h3",{className:"text-lg font-medium",children:"Installed Mods"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Enable or disable mods below. A page reload is required for changes to fully take effect."}),f.jsx("div",{className:"rounded-md border",children:f.jsx(xr,{delayDuration:100,children:f.jsxs(lf,{children:[f.jsx(fp,{children:f.jsxs(Es,{children:[f.jsx(Tr,{children:"Name"}),f.jsx(Tr,{children:"Source"}),f.jsx(Tr,{children:"Status"}),f.jsx(Tr,{className:"text-center",children:"Enabled"}),f.jsx(Tr,{className:"text-right",children:"Actions"})]})}),f.jsx(cf,{children:i?f.jsxs(f.Fragment,{children:[f.jsx(Es,{children:f.jsx(On,{colSpan:5,children:f.jsx(Wr,{className:"h-10 w-full"})})}),f.jsx(Es,{children:f.jsx(On,{colSpan:5,children:f.jsx(Wr,{className:"h-10 w-full"})})})]}):(s||[]).length===0?f.jsx(Es,{children:f.jsx(On,{colSpan:5,className:"h-24 text-center",children:"No mods installed yet."})}):(s||[]).map(A=>{const{status:R,error:N,tooltip:I}=k(A.id),P=A.sourceUrl?new URL(A.sourceUrl).hostname:"Direct Script",L=y[A.id],O=v[A.id],V=L||O,D=R==="Error";return f.jsxs(Es,{children:[f.jsx(On,{className:"font-medium",children:A.name}),f.jsx(On,{className:"text-muted-foreground",children:P}),f.jsxs(On,{children:[f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx("span",{className:D?"text-destructive font-semibold cursor-help":"",children:R})}),I&&f.jsx(Sr,{className:"max-w-xs break-words",children:f.jsx("p",{children:I})})]}),D&&N&&f.jsx("p",{className:"text-xs text-destructive truncate",children:N instanceof Error?N.message:String(N)})]}),f.jsxs(On,{className:"text-center",children:[f.jsx(Io,{checked:A.enabled??!1,onCheckedChange:()=>S(A),disabled:V,"aria-label":`Enable ${A.name}`}),L&&f.jsx(Qn,{className:"h-4 w-4 animate-spin inline-block ml-2"})]}),f.jsx(On,{className:"text-right",children:f.jsx(ft,{variant:"ghost",size:"icon",onClick:()=>C(A),disabled:V,"aria-label":`Delete ${A.name}`,className:"text-destructive hover:text-destructive/80",children:O?f.jsx(Qn,{className:"h-4 w-4 animate-spin"}):f.jsx(Ao,{className:"h-4 w-4"})})})]},A.id)})})]})})})]})]})},Zct=We.memo(Yct);class Xct{constructor(){me(this,"id","core-settings-mods");me(this,"unregisterCallback",null)}async initialize(t){}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerSettingsTab({id:"mods",title:"Mods",component:Zct,order:80})}destroy(){this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),console.log(`[${this.id}] Destroyed.`)}}const Jct=({interactionId:e,contentToCopy:t,disabled:n})=>{const[r]=T.useState(!1),s=T.useCallback(async i=>{if(i.stopPropagation(),n||!t){je.info("No content to copy or action disabled.");return}Pe.emit(vc.copyInteractionResponseRequest,{interactionId:e})},[e,t,n]);return f.jsx(Dn,{tooltipText:"Copy",onClick:s,"aria-label":"Copy content",disabled:n||!t,icon:r?f.jsx(so,{className:"text-green-500"}):f.jsx(dE,{}),className:"h-5 w-5"})};class Qct{constructor(){me(this,"id","core-canvas-copy-action")}async initialize(t){}register(t){t.registerCanvasControl({id:this.id,type:"interaction",targetSlot:"header-actions",renderer:n=>n.interactionId?We.createElement(Jct,{interactionId:n.interactionId,contentToCopy:n.responseContent??"",disabled:!n.responseContent||n.responseContent.trim()===""}):(console.warn("CopyActionControlModule: interactionId is missing in context for an interaction control."),null)})}destroy(t){}}const eut=({interactionId:e,disabled:t})=>{const n=r=>{if(r.stopPropagation(),t){je.info("Regeneration is currently disabled.");return}Pe.emit(vc.regenerateInteractionRequest,{interactionId:e})};return f.jsx(Dn,{tooltipText:"Regenerate",onClick:n,"aria-label":"Regenerate Response",disabled:t,icon:f.jsx(gm,{}),className:"h-5 w-5 md:h-6 md:w-6"})};class tut{constructor(){me(this,"id","core-canvas-regenerate-action")}async initialize(t){}register(t){t.registerCanvasControl({id:this.id,type:"interaction",targetSlot:"actions",renderer:n=>{if(!n.interactionId||!n.interaction)return null;const r=n.interaction,s=$n.getState(),i=s.status,a=s.interactions.filter(u=>u.conversationId===r.conversationId&&u.parentId===null&&(u.type==="message.user_assistant"||u.type==="message.assistant_regen"));a.sort((u,d)=>u.index-d.index);const o=a.length>0?a[a.length-1]:null,c=(o==null?void 0:o.id)===r.id&&(r.status==="COMPLETED"||r.status==="ERROR")&&i!=="streaming";return We.createElement(eut,{interactionId:r.id,disabled:!c})}})}destroy(t){}}const nut=({module:e,interactionId:t,disabled:n})=>{const[r,s]=T.useState(!1),[,i]=T.useState({});T.useEffect(()=>{if(e)return e.setNotifyCallback(()=>i({})),()=>e.setNotifyCallback(null)},[e]);const a=l=>{if(!l){s(!1);return}s(!1),Pe.emit(vc.regenerateInteractionWithModelRequest,{interactionId:t,modelId:l})},o=l=>{if(l.stopPropagation(),n){je.info("Regeneration is currently disabled.");return}s(!r)};return r?f.jsx("div",{className:"relative",children:f.jsx(K5,{models:e.globallyEnabledModels,value:null,onChange:a,isLoading:e.isLoadingProviders})}):f.jsx(Dn,{tooltipText:"Regenerate with Model",onClick:o,"aria-label":"Regenerate Response with Model Selection",disabled:n,icon:f.jsx(Lme,{}),className:"h-5 w-5 md:h-6 md:w-6"})};class rut{constructor(){me(this,"id","core-canvas-regenerate-with-model-action");me(this,"eventUnsubscribers",[]);me(this,"notifyComponentUpdate",null);me(this,"globallyEnabledModels",[]);me(this,"isLoadingProviders",!0)}async initialize(t){const n=Nr.getState();this.isLoadingProviders=n.isLoading,this.globallyEnabledModels=n.getGloballyEnabledModelDefinitions();const r=t.on(dr.globallyEnabledModelsUpdated,a=>{var c;let o=!1;JSON.stringify(this.globallyEnabledModels)!==JSON.stringify(a.models)&&(this.globallyEnabledModels=a.models,o=!0);const l=Nr.getState().isLoading;this.isLoadingProviders!==l&&(this.isLoadingProviders=l,o=!0),o&&((c=this.notifyComponentUpdate)==null||c.call(this))}),s=t.on(dr.initialDataLoaded,()=>{var c;const a=Nr.getState();let o=!1;this.isLoadingProviders!==a.isLoading&&(this.isLoadingProviders=a.isLoading,o=!0);const l=a.getGloballyEnabledModelDefinitions();JSON.stringify(this.globallyEnabledModels)!==JSON.stringify(l)&&(this.globallyEnabledModels=l,o=!0),o&&((c=this.notifyComponentUpdate)==null||c.call(this))}),i=t.on(Zn.statusChanged,()=>{var a;(a=this.notifyComponentUpdate)==null||a.call(this)});this.eventUnsubscribers.push(r,s,i)}setNotifyCallback(t){this.notifyComponentUpdate=t}register(t){t.registerCanvasControl({id:this.id,type:"interaction",targetSlot:"actions",renderer:n=>{if(!n.interactionId||!n.interaction)return null;const r=n.interaction,s=$n.getState(),i=s.status,a=s.interactions.filter(u=>u.conversationId===r.conversationId&&u.parentId===null&&(u.type==="message.user_assistant"||u.type==="message.assistant_regen"));a.sort((u,d)=>u.index-d.index);const o=a.length>0?a[a.length-1]:null,c=(o==null?void 0:o.id)===r.id&&(r.status==="COMPLETED"||r.status==="ERROR")&&i!=="streaming";return We.createElement(nut,{module:this,interactionId:r.id,disabled:!c})}})}async cleanup(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.notifyComponentUpdate=null}async destroy(){await this.cleanup()}}const sut=({interactionId:e,currentRating:t})=>{const n=s=>{const i=s===t?null:s;Pe.emit(Zn.rateInteractionRequest,{interactionId:e,rating:i})},r=Array.from({length:11},(s,i)=>i-5);return f.jsx("div",{className:"flex items-center gap-1",children:r.map(s=>{let i="";s===-5?i="Terrible":s===-4?i="Very Bad":s===-3?i="Bad":s===-2?i="Poor":s===-1?i="Below Average":s===0?i="Neutral":s===1?i="Above Average":s===2?i="Good":s===3?i="Very Good":s===4?i="Excellent":s===5&&(i="Perfect");let a="text-muted-foreground",o="hover:text-foreground",l="";s<0?(o="hover:text-red-500",t===s&&(a="text-red-500",l="fill-red-500")):s===0?(o="hover:text-gray-500",t===s&&(a="text-gray-500",l="fill-gray-500")):(o="hover:text-green-500",t===s&&(a="text-green-500",l="fill-green-500"));const c=t===s?"bg-muted":"";return f.jsx(Dn,{tooltipText:i,onClick:()=>n(s),"aria-label":`Rate response as ${i}`,icon:f.jsx(Rge,{className:Ze(l,t===s?"fill-current":"fill-none")}),variant:"ghost",className:Ze("h-4 w-4 md:h-5 md:w-5 p-0",a,o,c)},s)})})};class iut{constructor(){me(this,"id","core-canvas-rating-action")}async initialize(t){}register(t){t.registerCanvasControl({id:this.id,type:"interaction",targetSlot:"actions",renderer:n=>!n.interactionId||!n.interaction?null:We.createElement(sut,{interactionId:n.interactionId,currentRating:n.interaction.rating})})}destroy(t){}}const aut=({interactionId:e,response:t,disabled:n})=>{const[r,s]=T.useState(!1),[i,a]=T.useState(""),o=u=>{if(u.stopPropagation(),n){je.info("Response editing is currently disabled.");return}a(t||""),s(!0)},l=()=>{if(i.trim()===""){je.error("Response cannot be empty");return}Pe.emit(vc.editResponseRequest,{interactionId:e,newContent:i.trim()}),s(!1),je.success("Response edited successfully")},c=()=>{s(!1),a("")};return f.jsxs(f.Fragment,{children:[f.jsx(Dn,{tooltipText:"Edit Response",onClick:o,"aria-label":"Edit Assistant Response",disabled:n,icon:f.jsx(mH,{}),className:"h-5 max-w-7xl md:h-6 md:max-w-6xl"}),f.jsx(lp,{open:r,onOpenChange:s,children:f.jsxs(cp,{className:"!w-[80vw] !h-[85vh] !max-w-none flex flex-col",children:[f.jsx(up,{children:f.jsx(dp,{children:"Edit Assistant Response"})}),f.jsx("div",{className:"flex-1 space-y-4 overflow-hidden",children:f.jsxs("div",{className:"space-y-2 h-full",children:[f.jsx(It,{htmlFor:"response-edit",children:"Response Content"}),f.jsx(Bo,{id:"response-edit",value:i,onChange:u=>a(u.target.value),placeholder:"Edit the assistant's response...",className:"min-h-[60vh] h-full resize-none text-sm leading-relaxed"})]})}),f.jsxs(pb,{className:"flex-shrink-0",children:[f.jsx(ft,{variant:"outline",onClick:c,children:"Cancel"}),f.jsx(ft,{onClick:l,children:"Save Changes"})]})]})})]})};class out{constructor(){me(this,"id","core-canvas-edit-response-action");me(this,"eventUnsubscribers",[])}async initialize(t){const n=t.on(vc.editResponseRequest,async r=>{await this.handleResponseEdit(r.interactionId,r.newContent)});this.eventUnsubscribers.push(n)}async handleResponseEdit(t,n){var r;try{const s=$n.getState(),i=s.interactions.find(y=>y.id===t);if(!i)throw new Error("Original interaction not found");if(i.status!=="COMPLETED")throw new Error("Can only edit completed interactions");const a=Vi(),o={...i,id:a,response:n,parentId:null,index:i.index,metadata:{...i.metadata,editedResponse:!0,editedFromId:i.id},endedAt:new Date};s._addInteractionToState(o);const l=s.interactions.filter(y=>y.parentId===i.id),c=[];let u=i;for(;u;){c.push(u);const y=(r=u.metadata)==null?void 0:r.editedFromId;y?u=s.interactions.find(b=>b.id===y):u=void 0}const d=c.sort((y,b)=>{var w,S;const v=((w=y.startedAt)==null?void 0:w.getTime())??0,x=((S=b.startedAt)==null?void 0:S.getTime())??0;return v-x}),h=d.map(async(y,b)=>{const v={parentId:a,index:b,metadata:{...y.metadata,originalVersion:b===0}};return console.log(`[EditResponseControlModule] Updating version ${y.id} to be child of ${a} with childIndex ${b}`),s._updateInteractionInState(y.id,v),Et.saveInteraction({...y,...v})}),m=l.map(async y=>{const b={parentId:a,index:d.length+y.index};return s._updateInteractionInState(y.id,b),Et.saveInteraction({...y,...b})});await Promise.all([Et.saveInteraction(o),...h,...m]),console.log(`[EditResponseControlModule] Response edited successfully. Original: ${t}, Edited: ${a}`)}catch(s){throw console.error("[EditResponseControlModule] Failed to edit response:",s),s}}register(t){t.registerCanvasControl({id:this.id,type:"interaction",targetSlot:"actions",renderer:n=>{if(!n.interactionId||!n.interaction)return null;const r=n.interaction,i=$n.getState().status,a=r.status==="COMPLETED"&&r.response&&typeof r.response=="string"&&i!=="streaming"&&(r.type==="message.user_assistant"||r.type==="message.assistant_regen");return a?We.createElement(aut,{interactionId:r.id,response:r.response,disabled:!a}):null}})}async cleanup(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[]}async destroy(){await this.cleanup()}}const lut=({context:e})=>{const t=()=>{je.info(`Example Canvas Action Clicked! Interaction ID: ${e.interactionId}`)};return f.jsxs(ft,{variant:"outline",size:"sm",onClick:t,className:"h-6 px-2 text-xs",children:[f.jsx(_ge,{className:"h-3 w-3 mr-1"})," Example Action"]})};class cut{constructor(){me(this,"id","example-canvas-control-module")}async initialize(t){}register(t){t.registerCanvasControl({id:"example-canvas-action",type:"interaction",targetSlot:"actions",renderer:n=>We.createElement(lut,{context:n})})}destroy(t){}}const uut=({isFolded:e,toggleFold:t,canFold:n})=>{if(!n)return null;const r=s=>{s.stopPropagation(),t()};return f.jsx(Dn,{tooltipText:e?"Unfold":"Fold",onClick:r,"aria-label":e?"Unfold response":"Fold response",icon:e?f.jsx(Jl,{}):f.jsx(Lh,{}),iconClassName:"h-3.5 w-3.5",className:"h-5 w-5"})};class dut{constructor(){me(this,"id","core-canvas-fold-interaction")}async initialize(t){}register(t){t.registerCanvasControl({id:this.id,type:"interaction",targetSlot:"header-actions",renderer:n=>!n.toggleFold||n.isFolded===void 0?null:We.createElement(uut,{isFolded:n.isFolded,toggleFold:n.toggleFold,canFold:!0})})}destroy(t){}}const fut=({context:e})=>{const t=cT(e.responseContent||""),n=T.useMemo(()=>{const s=[];return t.forEach(i=>{if(typeof i=="object"&&i.type==="code"){const a=i;a.filepath&&a.filepath.trim()&&s.push({filepath:a.filepath,code:a.code,lang:a.lang})}}),s},[t]),r=T.useCallback(async()=>{var s;if(n.length===0){je.info("No code blocks with filepaths found to download");return}try{const i=new eD,a=new Set;n.forEach(({filepath:h,code:m})=>{const y=h.replace(/^[\/\\]+/,"").replace(/\\/g,"/"),b=y.split("/");if(b.length>1)for(let w=1;w<b.length;w++){const S=b.slice(0,w).join("/");a.has(S)||(i.folder(S),a.add(S))}let v=y,x=1;for(;i.file(v);){const w=y.lastIndexOf(".");if(w>0){const S=y.substring(0,w),C=y.substring(w);v=`${S}_${x}${C}`}else v=`${y}_${x}`;x++}i.file(v,m)});const o=await i.generateAsync({type:"blob",compression:"DEFLATE",compressionOptions:{level:6}}),l=URL.createObjectURL(o),c=document.createElement("a");c.href=l;const u=new Date().toISOString().slice(0,19).replace(/[:.]/g,"-"),d=((s=e.interactionId)==null?void 0:s.slice(0,8))||"unknown";c.download=`codeblocks_${d}_${u}.zip`,document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL(l),je.success(`Downloaded ${n.length} code files as ZIP`)}catch(i){console.error("ZIP download failed:",i),je.error("Failed to create ZIP file")}},[n,e.interactionId]);return n.length===0?null:f.jsx(Dn,{tooltipText:`Download ${n.length} code files as ZIP`,onClick:r,"aria-label":"Download code blocks as ZIP file",icon:f.jsx(aH,{}),iconClassName:"h-4 w-4",className:"h-6 w-6 text-muted-foreground hover:text-foreground"})};class hut{constructor(){me(this,"id","core-interaction-zip-download")}async initialize(t){}register(t){t.registerCanvasControl({id:this.id,type:"interaction",targetSlot:"header-actions",renderer:n=>!n.interactionId||!n.responseContent?null:We.createElement(fut,{context:n})})}destroy(t){}}const put=({interactionId:e,codeBlockId:t,language:n,codeToCopy:r,disabled:s})=>{const[i,a]=T.useState(!1),o=T.useCallback(async l=>{l.stopPropagation(),!(s||!r)&&(Pe.emit(vc.copyCodeBlockRequest,{interactionId:e,codeBlockId:t,language:n,content:r}),a(!0),setTimeout(()=>a(!1),1500))},[e,t,n,r,s]);return f.jsx(Dn,{tooltipText:"Copy Code",onClick:o,"aria-label":"Copy code block",disabled:s||!r,icon:i?f.jsx(so,{className:"text-green-500"}):f.jsx(dE,{}),className:"h-6 w-6 text-muted-foreground hover:text-foreground"})};class mut{constructor(){me(this,"id","core-codeblock-copy")}async initialize(t){}register(t){t.registerCanvasControl({id:this.id,type:"codeblock",targetSlot:"codeblock-header-actions",renderer:n=>We.createElement(put,{interactionId:n.interactionId,codeBlockId:n.codeBlockId,language:n.codeBlockLang,codeToCopy:n.codeBlockContent??"",disabled:!n.codeBlockContent||n.codeBlockContent.trim()===""})})}destroy(t){}}const gut=({isFolded:e,toggleFold:t})=>{const n=r=>{r.stopPropagation(),t()};return f.jsx(Dn,{tooltipText:e?"Unfold Code":"Fold Code",onClick:n,"aria-label":e?"Unfold code block":"Fold code block",icon:f.jsx(cE,{}),iconClassName:"h-3.5 w-3.5",className:"h-6 w-6 text-muted-foreground hover:text-foreground"})};class yut{constructor(){me(this,"id","core-codeblock-fold")}async initialize(t){}register(t){t.registerCanvasControl({id:this.id,type:"codeblock",targetSlot:"codeblock-header-actions",renderer:n=>n.toggleFold===void 0||n.isFolded===void 0?null:We.createElement(gut,{isFolded:n.isFolded,toggleFold:n.toggleFold})})}destroy(t){}}const but=({interactionId:e,codeBlockId:t,language:n,codeToDownload:r,filepath:s,disabled:i})=>{const a=T.useCallback(l=>{if(l.stopPropagation(),!(i||!r))try{let c;if(s){const m=s.split("/");c=m[m.length-1]}else c=`code${vut(n)}`;const u=new Blob([r],{type:"text/plain"}),d=URL.createObjectURL(u),h=document.createElement("a");h.href=d,h.download=c,document.body.appendChild(h),h.click(),document.body.removeChild(h),URL.revokeObjectURL(d),je.success(`Downloaded ${c}`)}catch(c){console.error("Download failed:",c),je.error("Failed to download file")}},[e,t,n,r,s,i]);return s||r&&r.trim().length>5e3?f.jsx(Dn,{tooltipText:"Download File",onClick:a,"aria-label":"Download code as file",disabled:i||!r,icon:f.jsx(xu,{}),iconClassName:"h-3.5 w-3.5",className:"h-6 w-6 text-muted-foreground hover:text-foreground"}):null};function vut(e){return e&&{javascript:".js",js:".js",typescript:".ts",ts:".ts",tsx:".tsx",jsx:".jsx",python:".py",py:".py",java:".java",c:".c",cpp:".cpp",cxx:".cxx",cc:".cc","c++":".cpp",csharp:".cs",cs:".cs",php:".php",ruby:".rb",rb:".rb",go:".go",rust:".rs",rs:".rs",swift:".swift",kotlin:".kt",kt:".kt",scala:".scala",html:".html",css:".css",scss:".scss",sass:".sass",less:".less",json:".json",xml:".xml",yaml:".yaml",yml:".yml",toml:".toml",ini:".ini",conf:".conf",config:".config",sh:".sh",bash:".sh",zsh:".zsh",fish:".fish",powershell:".ps1",ps1:".ps1",bat:".bat",cmd:".cmd",sql:".sql",r:".r",matlab:".m",octave:".m",lua:".lua",perl:".pl",vim:".vim",dockerfile:"Dockerfile",makefile:"Makefile",markdown:".md",md:".md",tex:".tex",latex:".tex"}[e.toLowerCase()]||".txt"}class xut{constructor(){me(this,"id","core-codeblock-download")}async initialize(t){}register(t){t.registerCanvasControl({id:this.id,type:"codeblock",targetSlot:"codeblock-header-actions",renderer:n=>We.createElement(but,{interactionId:n.interactionId,codeBlockId:n.codeBlockId,language:n.codeBlockLang,codeToDownload:n.codeBlockContent??"",filepath:n.codeBlockFilepath,disabled:!n.codeBlockContent||n.codeBlockContent.trim()===""})})}destroy(t){}}const wut=({toolCall:e})=>{const[t,n]=T.useState(!0),r=()=>n(i=>!i),s=T.useMemo(()=>{try{return JSON.stringify(e.args,null,2)}catch{return String(e.args)}},[e.args]);return f.jsxs("div",{className:"my-2 p-2 border border-amber-500/30 bg-amber-500/10 rounded-md text-xs",children:[f.jsxs("div",{className:"flex items-center justify-between mb-1",children:[f.jsxs("span",{className:"font-semibold text-amber-700 dark:text-amber-300",children:["Tool Call: ",f.jsx("code",{className:"font-mono",children:e.toolName})]}),f.jsx(Dn,{tooltipText:t?"Show Args":"Hide Args",onClick:r,"aria-label":t?"Show arguments":"Hide arguments",icon:t?f.jsx(Jl,{}):f.jsx(Lh,{}),iconClassName:"h-3 w-3",className:"h-5 w-5 text-muted-foreground"})]}),!t&&f.jsx(zy,{lang:"json",code:s})]})},_ut=({toolResult:e})=>{const[t,n]=T.useState(!0),r=()=>n(a=>!a),s=T.useMemo(()=>{try{return typeof e.result=="object"&&e.result!==null&&e.result._isError===!0?`Error: ${e.result.error}`:JSON.stringify(e.result,null,2)}catch{return String(e.result)}},[e.result]),i=typeof e.result=="object"&&e.result!==null&&e.result._isError===!0;return f.jsxs("div",{className:Ze("my-2 p-2 border rounded-md text-xs",i?"border-destructive/30 bg-destructive/10":"border-green-500/30 bg-green-500/10"),children:[f.jsxs("div",{className:"flex items-center justify-between mb-1",children:[f.jsxs("span",{className:Ze("font-semibold",i?"text-destructive":"text-green-700 dark:text-green-300"),children:["Tool Result: ",f.jsx("code",{className:"font-mono",children:e.toolName})]}),f.jsx(Dn,{tooltipText:t?"Show Result":"Hide Result",onClick:r,"aria-label":t?"Show result":"Hide result",icon:t?f.jsx(Jl,{}):f.jsx(Lh,{}),iconClassName:"h-3 w-3",className:"h-5 w-5 text-muted-foreground"})]}),!t&&f.jsx(zy,{lang:i?"text":"json",code:s})]})},Sut=({interactionId:e,toolCall:t,toolResult:n})=>f.jsxs("div",{className:"tool-call-step my-1","data-interaction-id":e,"data-tool-call-id":t.toolCallId,children:[f.jsx(wut,{toolCall:t}),n&&f.jsx(_ut,{toolResult:n})]});class Cut{constructor(){me(this,"id","core-tool-call-step-display")}async initialize(t){}register(t){t.registerCanvasControl({id:this.id,type:"tool-call-step",targetSlot:"tool-call-content",renderer:n=>!n.interactionId||!n.toolCall?(console.warn("[ToolCallStepControlModule] Missing interactionId or toolCall in context"),null):We.createElement(Sut,{interactionId:n.interactionId,toolCall:n.toolCall,toolResult:n.toolResult})})}destroy(t){}}const kut=[Zst,lot,mot,bct,qct,Kct,Xct,_Qe,Tet,ket,xst,wst,Kst,Rst,Mst,jst,Jst,ett,rrt,Hst,Sst,Brt,Zet,Est,eit,Xat,sot,vrt,wrt,Art,Prt,Ort,Qct,dut,hut,tut,rut,out,iut,mut,yut,xut,cut,Cut];function Eut(){return f.jsxs(bQe,{children:[f.jsx(gQe,{}),f.jsx(mQe,{}),f.jsx("div",{className:"h-screen bg-background text-foreground flex flex-col",children:f.jsx("main",{className:"flex-grow overflow-hidden",children:f.jsx(cQe,{controls:kut})})})]})}a0e();dhe.createRoot(document.getElementById("root")).render(f.jsx(We.StrictMode,{children:f.jsx(Eut,{})}));export{mDe as $,xx as A,SIe as B,m3e as C,s6 as D,Mo as E,CX as F,dFe as G,SLe as H,xU as I,Sje as J,MIe as K,wy as L,Gut as M,TT as N,SD as O,d7 as P,vDe as Q,B2 as R,uFe as S,q1 as T,r3e as U,U1 as V,wn as W,zn as X,PX as Y,nFe as Z,ie as _,c3e as a,KMe as a$,VD as a0,Qut as a1,ndt as a2,e0 as a3,L7 as a4,F7 as a5,sdt as a6,rdt as a7,tdt as a8,Xut as a9,J5e as aA,V6e as aB,W5e as aC,YD as aD,AU as aE,n8e as aF,gDe as aG,_a as aH,gT as aI,Gje as aJ,Hje as aK,Xm as aL,Q5e as aM,Cee as aN,_T as aO,ET as aP,Tk as aQ,Eee as aR,See as aS,R5e as aT,ko as aU,UPe as aV,BD as aW,MQ as aX,H1 as aY,PQ as aZ,Zut as a_,Jut as aa,adt as ab,edt as ac,idt as ad,R8e as ae,Ane as af,fdt as ag,kje as ah,Wi as ai,Jh as aj,DD as ak,nte as al,eg as am,Iee as an,lr as ao,Ou as ap,y0 as aq,xLe as ar,ddt as as,hdt as at,cdt as au,Mn as av,udt as aw,nLe as ax,J8e as ay,X8e as az,l3e as b,$D as b0,sh as b1,M7 as b2,YPe as b3,Tw as b4,X5e as b5,V5e as b6,M6e as b7,ZD as b8,k5e as b9,Ai as bA,Zr as bB,tFe as ba,K1 as bb,sb as bc,Ck as bd,D5e as be,VLe as bf,G1 as bg,Ek as bh,N5e as bi,yee as bj,P6e as bk,O6e as bl,Hp as bm,Q7 as bn,D6e as bo,XD as bp,j6e as bq,B6e as br,ib as bs,Xh as bt,K7 as bu,JD as bv,vee as bw,E4 as bx,eFe as by,kT as bz,os as c,Kr as d,jX as e,xa as f,d3e as g,Kd as h,Tm as i,Xje as j,rb as k,zt as l,Pee as m,Kut as n,mdt as o,f3e as p,h3e as q,pdt as r,u3e as s,Cje as t,pu as u,K8e as v,pFe as w,odt as x,o3e as y,Yut as z};
